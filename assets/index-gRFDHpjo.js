const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/projects.repo-DGCcIdqJ.js","assets/three-fiber-NHxOwByN.js","assets/three-core-CnIHn6i7.js","assets/router-CXwZahw9.js","assets/store-Sc3twQ3t.js","assets/index.es-Cctor2Sd.js","assets/ARViewer-Ca8LErvX.js","assets/ARViewer-DrQocUNP.css"])))=>i.map(i=>d[i]);
var Eq=Object.defineProperty;var Fq=(n,e,t)=>e in n?Eq(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Br=(n,e,t)=>Fq(n,typeof e!="symbol"?e+"":e,t);import{_ as rl,r as H,j as c,p as kq,h as fh,C as XU,n as Iq,P as Dq,O as jq,R as ci,T as ii,o as Pq,q as Nq,c as J_,B as Lq,E as Mq,H as jm,m as mm,g as Vp,F as Rq,v as Uq,w as Oq,x as Hq,y as Wq,z as YU,A as zq}from"./three-fiber-NHxOwByN.js";import{R as Km,a as ph,b as e5,u as tF,c as Qq,B as $q,d as Vq,e as Fa,N as qv}from"./router-CXwZahw9.js";import{c as w1}from"./store-Sc3twQ3t.js";import{h as jS,M as Zv,O as Gq,e as sd,d as lo,t as KU,X as Xq,y as Ms,b as Yq,a$ as _h,av as qm,Y as Kq,ao as qq,b0 as qU,aQ as Zq,az as gl,D as Na,J as pB,ay as t5,al as A0,at as Lu,q as jI,a as YA,aU as ku,a0 as Jq,a1 as PI,T as eZ,$ as tZ,_ as ZU,b1 as nZ,k as sm,ax as iZ}from"./three-core-CnIHn6i7.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();const rZ=()=>{};var NI={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JU=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},sZ=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],a=n[t++],l=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},eO={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,a=o?n[r+1]:0,l=r+2<n.length,h=l?n[r+2]:0,u=s>>2,d=(s&3)<<4|a>>4;let A=(a&15)<<2|h>>6,f=h&63;l||(f=64,o||(A=64)),i.push(t[u],t[d],t[A],t[f])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(JU(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):sZ(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;const h=r<n.length?t[n.charAt(r)]:64;++r;const d=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||a==null||h==null||d==null)throw new oZ;const A=s<<2|a>>4;if(i.push(A),h!==64){const f=a<<4&240|h>>2;if(i.push(f),d!==64){const p=h<<6&192|d;i.push(p)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class oZ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const aZ=function(n){const e=JU(n);return eO.encodeByteArray(e,!0)},CC=function(n){return aZ(n).replace(/\./g,"")},tO=function(n){try{return eO.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lZ(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cZ=()=>lZ().__FIREBASE_DEFAULTS__,hZ=()=>{if(typeof process>"u"||typeof NI>"u")return;const n=NI.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},uZ=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&tO(n[1]);return e&&JSON.parse(e)},n5=()=>{try{return rZ()||cZ()||hZ()||uZ()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},nO=n=>{var e,t;return(t=(e=n5())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},iO=n=>{const e=nO(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},rO=()=>{var n;return(n=n5())===null||n===void 0?void 0:n.config},sO=n=>{var e;return(e=n5())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dZ{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gp(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function nF(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oO(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[CC(JSON.stringify(t)),CC(JSON.stringify(o)),""].join(".")}const Py={};function AZ(){const n={prod:[],emulator:[]};for(const e of Object.keys(Py))Py[e]?n.emulator.push(e):n.prod.push(e);return n}function fZ(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let LI=!1;function iF(n,e){if(typeof window>"u"||typeof document>"u"||!Gp(window.location.host)||Py[n]===e||Py[n]||LI)return;Py[n]=e;function t(A){return`__firebase__banner__${A}`}const i="__firebase__banner",s=AZ().prod.length>0;function o(){const A=document.getElementById(i);A&&A.remove()}function a(A){A.style.display="flex",A.style.background="#7faaf0",A.style.position="fixed",A.style.bottom="5px",A.style.left="5px",A.style.padding=".5em",A.style.borderRadius="5px",A.style.alignItems="center"}function l(A,f){A.setAttribute("width","24"),A.setAttribute("id",f),A.setAttribute("height","24"),A.setAttribute("viewBox","0 0 24 24"),A.setAttribute("fill","none"),A.style.marginLeft="-6px"}function h(){const A=document.createElement("span");return A.style.cursor="pointer",A.style.marginLeft="16px",A.style.fontSize="24px",A.innerHTML=" &times;",A.onclick=()=>{LI=!0,o()},A}function u(A,f){A.setAttribute("id",f),A.innerText="Learn more",A.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",A.setAttribute("target","__blank"),A.style.paddingLeft="5px",A.style.textDecoration="underline"}function d(){const A=fZ(i),f=t("text"),p=document.getElementById(f)||document.createElement("span"),g=t("learnmore"),v=document.getElementById(g)||document.createElement("a"),w=t("preprendIcon"),m=document.getElementById(w)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(A.created){const y=A.element;a(y),u(v,g);const x=h();l(m,w),y.append(m,p,v,x),document.body.appendChild(y)}s?(p.innerText="Preview backend disconnected.",m.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(m.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,p.innerText="Preview backend running in this workspace."),p.setAttribute("id",f)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $c(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function pZ(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test($c())}function gZ(){var n;const e=(n=n5())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function mZ(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function yZ(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function wZ(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function vZ(){const n=$c();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function xZ(){return!gZ()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function bZ(){try{return typeof indexedDB=="object"}catch{return!1}}function CZ(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var s;e(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _Z="FirebaseError";class Ed extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=_Z,Object.setPrototypeOf(this,Ed.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ev.prototype.create)}}class ev{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?SZ(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Ed(r,a,i)}}function SZ(n,e){return n.replace(TZ,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const TZ=/\{\$([^}]+)}/g;function BZ(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function kp(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(MI(s)&&MI(o)){if(!kp(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function MI(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tv(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function hy(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[r,s]=i.split("=");e[decodeURIComponent(r)]=decodeURIComponent(s)}}),e}function uy(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function EZ(n,e){const t=new FZ(n,e);return t.subscribe.bind(t)}class FZ{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");kZ(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=PS),r.error===void 0&&(r.error=PS),r.complete===void 0&&(r.complete=PS);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function kZ(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function PS(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uo(n){return n&&n._delegate?n._delegate:n}class Ip{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cg="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IZ{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new dZ;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(jZ(e))try{this.getOrInitializeService({instanceIdentifier:Cg})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Cg){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Cg){return this.instances.has(e)}getOptions(e=Cg){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(e,t){var i;const r=this.normalizeInstanceIdentifier(t),s=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;s.add(e),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:DZ(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Cg){return this.component?this.component.multipleInstances?e:Cg:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function DZ(n){return n===Cg?void 0:n}function jZ(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PZ{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new IZ(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Is;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Is||(Is={}));const NZ={debug:Is.DEBUG,verbose:Is.VERBOSE,info:Is.INFO,warn:Is.WARN,error:Is.ERROR,silent:Is.SILENT},LZ=Is.INFO,MZ={[Is.DEBUG]:"log",[Is.VERBOSE]:"log",[Is.INFO]:"info",[Is.WARN]:"warn",[Is.ERROR]:"error"},RZ=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=MZ[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let rF=class{constructor(e){this.name=e,this._logLevel=LZ,this._logHandler=RZ,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Is))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?NZ[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Is.DEBUG,...e),this._logHandler(this,Is.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Is.VERBOSE,...e),this._logHandler(this,Is.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Is.INFO,...e),this._logHandler(this,Is.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Is.WARN,...e),this._logHandler(this,Is.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Is.ERROR,...e),this._logHandler(this,Is.ERROR,...e)}};const UZ=(n,e)=>e.some(t=>n instanceof t);let RI,UI;function OZ(){return RI||(RI=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function HZ(){return UI||(UI=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const aO=new WeakMap,gB=new WeakMap,lO=new WeakMap,NS=new WeakMap,sF=new WeakMap;function WZ(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(_p(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&aO.set(t,n)}).catch(()=>{}),sF.set(e,n),e}function zZ(n){if(gB.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});gB.set(n,e)}let mB={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return gB.get(n);if(e==="objectStoreNames")return n.objectStoreNames||lO.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return _p(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function QZ(n){mB=n(mB)}function $Z(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(LS(this),e,...t);return lO.set(i,e.sort?e.sort():[e]),_p(i)}:HZ().includes(n)?function(...e){return n.apply(LS(this),e),_p(aO.get(this))}:function(...e){return _p(n.apply(LS(this),e))}}function VZ(n){return typeof n=="function"?$Z(n):(n instanceof IDBTransaction&&zZ(n),UZ(n,OZ())?new Proxy(n,mB):n)}function _p(n){if(n instanceof IDBRequest)return WZ(n);if(NS.has(n))return NS.get(n);const e=VZ(n);return e!==n&&(NS.set(n,e),sF.set(e,n)),e}const LS=n=>sF.get(n);function GZ(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),a=_p(o);return i&&o.addEventListener("upgradeneeded",l=>{i(_p(o.result),l.oldVersion,l.newVersion,_p(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),r&&l.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),a}const XZ=["get","getKey","getAll","getAllKeys","count"],YZ=["put","add","delete","clear"],MS=new Map;function OI(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(MS.get(e))return MS.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=YZ.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||XZ.includes(t)))return;const s=async function(o,...a){const l=this.transaction(o,r?"readwrite":"readonly");let h=l.store;return i&&(h=h.index(a.shift())),(await Promise.all([h[t](...a),r&&l.done]))[0]};return MS.set(e,s),s}QZ(n=>({...n,get:(e,t,i)=>OI(e,t)||n.get(e,t,i),has:(e,t)=>!!OI(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KZ{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(qZ(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function qZ(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const yB="@firebase/app",HI="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mf=new rF("@firebase/app"),ZZ="@firebase/app-compat",JZ="@firebase/analytics-compat",eJ="@firebase/analytics",tJ="@firebase/app-check-compat",nJ="@firebase/app-check",iJ="@firebase/auth",rJ="@firebase/auth-compat",sJ="@firebase/database",oJ="@firebase/data-connect",aJ="@firebase/database-compat",lJ="@firebase/functions",cJ="@firebase/functions-compat",hJ="@firebase/installations",uJ="@firebase/installations-compat",dJ="@firebase/messaging",AJ="@firebase/messaging-compat",fJ="@firebase/performance",pJ="@firebase/performance-compat",gJ="@firebase/remote-config",mJ="@firebase/remote-config-compat",yJ="@firebase/storage",wJ="@firebase/storage-compat",vJ="@firebase/firestore",xJ="@firebase/ai",bJ="@firebase/firestore-compat",CJ="firebase",_J="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wB="[DEFAULT]",SJ={[yB]:"fire-core",[ZZ]:"fire-core-compat",[eJ]:"fire-analytics",[JZ]:"fire-analytics-compat",[nJ]:"fire-app-check",[tJ]:"fire-app-check-compat",[iJ]:"fire-auth",[rJ]:"fire-auth-compat",[sJ]:"fire-rtdb",[oJ]:"fire-data-connect",[aJ]:"fire-rtdb-compat",[lJ]:"fire-fn",[cJ]:"fire-fn-compat",[hJ]:"fire-iid",[uJ]:"fire-iid-compat",[dJ]:"fire-fcm",[AJ]:"fire-fcm-compat",[fJ]:"fire-perf",[pJ]:"fire-perf-compat",[gJ]:"fire-rc",[mJ]:"fire-rc-compat",[yJ]:"fire-gcs",[wJ]:"fire-gcs-compat",[vJ]:"fire-fst",[bJ]:"fire-fst-compat",[xJ]:"fire-vertex","fire-js":"fire-js",[CJ]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _C=new Map,TJ=new Map,vB=new Map;function WI(n,e){try{n.container.addComponent(e)}catch(t){mf.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Jg(n){const e=n.name;if(vB.has(e))return mf.debug(`There were multiple attempts to register component ${e}.`),!1;vB.set(e,n);for(const t of _C.values())WI(t,n);for(const t of TJ.values())WI(t,n);return!0}function i5(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function ah(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BJ={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Sp=new ev("app","Firebase",BJ);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EJ{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Ip("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Sp.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f0=_J;function cO(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:wB,automaticDataCollectionEnabled:!0},e),r=i.name;if(typeof r!="string"||!r)throw Sp.create("bad-app-name",{appName:String(r)});if(t||(t=rO()),!t)throw Sp.create("no-options");const s=_C.get(r);if(s){if(kp(t,s.options)&&kp(i,s.config))return s;throw Sp.create("duplicate-app",{appName:r})}const o=new PZ(r);for(const l of vB.values())o.addComponent(l);const a=new EJ(t,i,o);return _C.set(r,a),a}function oF(n=wB){const e=_C.get(n);if(!e&&n===wB&&rO())return cO();if(!e)throw Sp.create("no-app",{appName:n});return e}function oA(n,e,t){var i;let r=(i=SJ[n])!==null&&i!==void 0?i:n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),mf.warn(a.join(" "));return}Jg(new Ip(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FJ="firebase-heartbeat-database",kJ=1,ww="firebase-heartbeat-store";let RS=null;function hO(){return RS||(RS=GZ(FJ,kJ,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ww)}catch(t){console.warn(t)}}}}).catch(n=>{throw Sp.create("idb-open",{originalErrorMessage:n.message})})),RS}async function IJ(n){try{const t=(await hO()).transaction(ww),i=await t.objectStore(ww).get(uO(n));return await t.done,i}catch(e){if(e instanceof Ed)mf.warn(e.message);else{const t=Sp.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});mf.warn(t.message)}}}async function zI(n,e){try{const i=(await hO()).transaction(ww,"readwrite");await i.objectStore(ww).put(e,uO(n)),await i.done}catch(t){if(t instanceof Ed)mf.warn(t.message);else{const i=Sp.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});mf.warn(i.message)}}}function uO(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DJ=1024,jJ=30;class PJ{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new LJ(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=QI();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats.length>jJ){const o=MJ(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){mf.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=QI(),{heartbeatsToSend:i,unsentEntries:r}=NJ(this._heartbeatsCache.heartbeats),s=CC(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return mf.warn(t),""}}}function QI(){return new Date().toISOString().substring(0,10)}function NJ(n,e=DJ){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),$I(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),$I(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class LJ{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return bZ()?CZ().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await IJ(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return zI(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return zI(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function $I(n){return CC(JSON.stringify({version:2,heartbeats:n})).length}function MJ(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RJ(n){Jg(new Ip("platform-logger",e=>new KZ(e),"PRIVATE")),Jg(new Ip("heartbeat",e=>new PJ(e),"PRIVATE")),oA(yB,HI,n),oA(yB,HI,"esm2017"),oA("fire-js","")}RJ("");function aF(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t}function dO(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const AO=dO,fO=new ev("auth","Firebase",dO());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SC=new rF("@firebase/auth");function UJ(n,...e){SC.logLevel<=Is.WARN&&SC.warn(`Auth (${f0}): ${n}`,...e)}function Vb(n,...e){SC.logLevel<=Is.ERROR&&SC.error(`Auth (${f0}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mu(n,...e){throw cF(n,...e)}function md(n,...e){return cF(n,...e)}function lF(n,e,t){const i=Object.assign(Object.assign({},AO()),{[e]:t});return new ev("auth","Firebase",i).create(e,{appName:n.name})}function aA(n){return lF(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function pO(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&Mu(n,"argument-error"),lF(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function cF(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return fO.create(n,...e)}function Sr(n,e,...t){if(!n)throw cF(e,...t)}function of(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Vb(e),new Error(e)}function yf(n,e){n||of(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xB(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function OJ(){return VI()==="http:"||VI()==="https:"}function VI(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HJ(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(OJ()||yZ()||"connection"in navigator)?navigator.onLine:!0}function WJ(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{constructor(e,t){this.shortDelay=e,this.longDelay=t,yf(t>e,"Short delay should be less than long delay!"),this.isMobile=pZ()||wZ()}get(){return HJ()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hF(n,e){yf(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gO{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;of("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;of("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;of("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zJ={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QJ=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],$J=new nv(3e4,6e4);function Xp(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function kf(n,e,t,i,r={}){return mO(n,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const a=tv(Object.assign({key:n.config.apiKey},o)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const h=Object.assign({method:e,headers:l},s);return mZ()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Gp(n.emulatorConfig.host)&&(h.credentials="include"),gO.fetch()(await yO(n,n.config.apiHost,t,a),h)})}async function mO(n,e,t){n._canInitEmulator=!1;const i=Object.assign(Object.assign({},zJ),e);try{const r=new GJ(n),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Jv(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,h]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Jv(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Jv(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw Jv(n,"user-disabled",o);const u=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw lF(n,u,h);Mu(n,u)}}catch(r){if(r instanceof Ed)throw r;Mu(n,"network-request-failed",{message:String(r)})}}async function iv(n,e,t,i,r={}){const s=await kf(n,e,t,i,r);return"mfaPendingCredential"in s&&Mu(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function yO(n,e,t,i){const r=`${e}${t}?${i}`,s=n,o=s.config.emulator?hF(n.config,r):`${n.config.apiScheme}://${r}`;return QJ.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}function VJ(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class GJ{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(md(this.auth,"network-request-failed")),$J.get())})}}function Jv(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=md(n,e,i);return r.customData._tokenResponse=t,r}function GI(n){return n!==void 0&&n.enterprise!==void 0}class XJ{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return VJ(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function YJ(n,e){return kf(n,"GET","/v2/recaptchaConfig",Xp(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KJ(n,e){return kf(n,"POST","/v1/accounts:delete",e)}async function TC(n,e){return kf(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ny(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function wO(n,e=!1){const t=Uo(n),i=await t.getIdToken(e),r=uF(i);Sr(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:Ny(US(r.auth_time)),issuedAtTime:Ny(US(r.iat)),expirationTime:Ny(US(r.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function US(n){return Number(n)*1e3}function uF(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Vb("JWT malformed, contained fewer than 3 sections"),null;try{const r=tO(t);return r?JSON.parse(r):(Vb("Failed to decode base64 JWT payload"),null)}catch(r){return Vb("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function XI(n){const e=uF(n);return Sr(e,"internal-error"),Sr(typeof e.exp<"u","internal-error"),Sr(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zm(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Ed&&qJ(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function qJ({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZJ{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const r=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bB{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ny(this.lastLoginAt),this.creationTime=Ny(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BC(n){var e;const t=n.auth,i=await n.getIdToken(),r=await Zm(n,TC(t,{idToken:i}));Sr(r==null?void 0:r.users.length,t,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?xO(s.providerUserInfo):[],a=JJ(n.providerData,o),l=n.isAnonymous,h=!(n.email&&s.passwordHash)&&!(a!=null&&a.length),u=l?h:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new bB(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(n,d)}async function vO(n){const e=Uo(n);await BC(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function JJ(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function xO(n){return n.map(e=>{var{providerId:t}=e,i=aF(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eee(n,e){const t=await mO(n,{},async()=>{const i=tv({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=await yO(n,r,"/v1/token",`key=${s}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:i};return n.emulatorConfig&&Gp(n.emulatorConfig.host)&&(l.credentials="include"),gO.fetch()(o,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function tee(n,e){return kf(n,"POST","/v2/accounts:revokeToken",Xp(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pm{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Sr(e.idToken,"internal-error"),Sr(typeof e.idToken<"u","internal-error"),Sr(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):XI(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Sr(e.length!==0,"internal-error");const t=XI(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Sr(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:s}=await eee(e,t);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new Pm;return i&&(Sr(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(Sr(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(Sr(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Pm,this.toJSON())}_performRefresh(){return of("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zf(n,e){Sr(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class dd{constructor(e){var{uid:t,auth:i,stsTokenManager:r}=e,s=aF(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ZJ(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new bB(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Zm(this,this.stsTokenManager.getToken(this.auth,e));return Sr(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return wO(this,e)}reload(){return vO(this)}_assign(e){this!==e&&(Sr(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new dd(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Sr(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await BC(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ah(this.auth.app))return Promise.reject(aA(this.auth));const e=await this.getIdToken();return await Zm(this,KJ(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,r,s,o,a,l,h,u;const d=(i=t.displayName)!==null&&i!==void 0?i:void 0,A=(r=t.email)!==null&&r!==void 0?r:void 0,f=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,p=(o=t.photoURL)!==null&&o!==void 0?o:void 0,g=(a=t.tenantId)!==null&&a!==void 0?a:void 0,v=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,w=(h=t.createdAt)!==null&&h!==void 0?h:void 0,m=(u=t.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:y,emailVerified:x,isAnonymous:S,providerData:I,stsTokenManager:j}=t;Sr(y&&j,e,"internal-error");const C=Pm.fromJSON(this.name,j);Sr(typeof y=="string",e,"internal-error"),zf(d,e.name),zf(A,e.name),Sr(typeof x=="boolean",e,"internal-error"),Sr(typeof S=="boolean",e,"internal-error"),zf(f,e.name),zf(p,e.name),zf(g,e.name),zf(v,e.name),zf(w,e.name),zf(m,e.name);const b=new dd({uid:y,auth:e,email:A,emailVerified:x,displayName:d,isAnonymous:S,photoURL:p,phoneNumber:f,tenantId:g,stsTokenManager:C,createdAt:w,lastLoginAt:m});return I&&Array.isArray(I)&&(b.providerData=I.map(D=>Object.assign({},D))),v&&(b._redirectEventId=v),b}static async _fromIdTokenResponse(e,t,i=!1){const r=new Pm;r.updateFromServerResponse(t);const s=new dd({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await BC(s),s}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];Sr(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?xO(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!(s!=null&&s.length),a=new Pm;a.updateFromIdToken(i);const l=new dd({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new bB(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,h),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YI=new Map;function af(n){yf(n instanceof Function,"Expected a class definition");let e=YI.get(n);return e?(yf(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,YI.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bO{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}bO.type="NONE";const CB=bO;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gb(n,e,t){return`firebase:${n}:${e}:${t}`}class Nm{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=Gb(this.userKey,r.apiKey,s),this.fullPersistenceKey=Gb("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await TC(this.auth,{idToken:e}).catch(()=>{});return t?dd._fromGetAccountInfoResponse(this.auth,t,e):null}return dd._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Nm(af(CB),e,i);const r=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||af(CB);const o=Gb(i,e.config.apiKey,e.name);let a=null;for(const h of t)try{const u=await h._get(o);if(u){let d;if(typeof u=="string"){const A=await TC(e,{idToken:u}).catch(()=>{});if(!A)break;d=await dd._fromGetAccountInfoResponse(e,A,u)}else d=dd._fromJSON(e,u);h!==s&&(a=d),s=h;break}}catch{}const l=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Nm(s,e,i):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new Nm(s,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KI(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(TO(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(CO(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(EO(e))return"Blackberry";if(FO(e))return"Webos";if(_O(e))return"Safari";if((e.includes("chrome/")||SO(e))&&!e.includes("edge/"))return"Chrome";if(BO(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function CO(n=$c()){return/firefox\//i.test(n)}function _O(n=$c()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function SO(n=$c()){return/crios\//i.test(n)}function TO(n=$c()){return/iemobile/i.test(n)}function BO(n=$c()){return/android/i.test(n)}function EO(n=$c()){return/blackberry/i.test(n)}function FO(n=$c()){return/webos/i.test(n)}function dF(n=$c()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function nee(n=$c()){var e;return dF(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function iee(){return vZ()&&document.documentMode===10}function kO(n=$c()){return dF(n)||BO(n)||FO(n)||EO(n)||/windows phone/i.test(n)||TO(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IO(n,e=[]){let t;switch(n){case"Browser":t=KI($c());break;case"Worker":t=`${KI($c())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${f0}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ree{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function see(n,e={}){return kf(n,"GET","/v2/passwordPolicy",Xp(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oee=6;class aee{constructor(e){var t,i,r,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:oee,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,r,s,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(i=l.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(r=l.containsLowercaseLetter)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lee{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new qI(this),this.idTokenSubscription=new qI(this),this.beforeStateQueue=new ree(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=fO,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=af(t)),this._initializationPromise=this.queue(async()=>{var i,r,s;if(!this._deleted&&(this.persistenceManager=await Nm.create(this,e),(i=this._resolvePersistenceManagerAvailable)===null||i===void 0||i.call(this),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await TC(this,{idToken:e}),i=await dd._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(ah(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let r=i,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Sr(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await BC(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=WJ()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ah(this.app))return Promise.reject(aA(this));const t=e?Uo(e):null;return t&&Sr(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Sr(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ah(this.app)?Promise.reject(aA(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ah(this.app)?Promise.reject(aA(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(af(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await see(this),t=new aee(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ev("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await tee(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&af(e)||this._popupRedirectResolver;Sr(t,this,"argument-error"),this.redirectPersistenceManager=await Nm.create(this,[af(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Sr(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,i,r);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Sr(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=IO(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const i=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());i&&(t["X-Firebase-Client"]=i);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if(ah(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&UJ(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function xA(n){return Uo(n)}class qI{constructor(e){this.auth=e,this.observer=null,this.addObserver=EZ(t=>this.observer=t)}get next(){return Sr(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let r5={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function cee(n){r5=n}function DO(n){return r5.loadJS(n)}function hee(){return r5.recaptchaEnterpriseScript}function uee(){return r5.gapiScript}function dee(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class Aee{constructor(){this.enterprise=new fee}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class fee{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const pee="recaptcha-enterprise",jO="NO_RECAPTCHA";class gee{constructor(e){this.type=pee,this.auth=xA(e)}async verify(e="verify",t=!1){async function i(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{YJ(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const h=new XJ(l);return s.tenantId==null?s._agentRecaptchaConfig=h:s._tenantRecaptchaConfigs[s.tenantId]=h,o(h.siteKey)}}).catch(l=>{a(l)})})}function r(s,o,a){const l=window.grecaptcha;GI(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(h=>{o(h)}).catch(()=>{o(jO)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Aee().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{i(this.auth).then(a=>{if(!t&&GI(window.grecaptcha))r(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=hee();l.length!==0&&(l+=a),DO(l).then(()=>{r(a,s,o)}).catch(h=>{o(h)})}}).catch(a=>{o(a)})})}}async function ZI(n,e,t,i=!1,r=!1){const s=new gee(n);let o;if(r)o=jO;else try{o=await s.verify(t)}catch{o=await s.verify(t,!0)}const a=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,h=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:h,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return i?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function _B(n,e,t,i,r){var s;if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await ZI(n,e,t,t==="getOobCode");return i(n,o)}else return i(n,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await ZI(n,e,t,t==="getOobCode");return i(n,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PO(n,e){const t=i5(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(kp(s,e??{}))return r;Mu(r,"already-initialized")}return t.initialize({options:e})}function mee(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(af);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function NO(n,e,t){const i=xA(n);Sr(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,s=LO(e),{host:o,port:a}=yee(e),l=a===null?"":`:${a}`,h={url:`${s}//${o}${l}/`},u=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){Sr(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Sr(kp(h,i.config.emulator)&&kp(u,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=u,i.settings.appVerificationDisabledForTesting=!0,Gp(o)?(nF(`${s}//${o}${l}`),iF("Auth",!0)):wee()}function LO(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function yee(n){const e=LO(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:JI(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:JI(o)}}}function JI(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function wee(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s5{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return of("not implemented")}_getIdTokenResponse(e){return of("not implemented")}_linkToIdToken(e,t){return of("not implemented")}_getReauthenticationResolver(e){return of("not implemented")}}async function vee(n,e){return kf(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xee(n,e){return iv(n,"POST","/v1/accounts:signInWithPassword",Xp(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bee(n,e){return iv(n,"POST","/v1/accounts:signInWithEmailLink",Xp(n,e))}async function Cee(n,e){return iv(n,"POST","/v1/accounts:signInWithEmailLink",Xp(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jm extends s5{constructor(e,t,i,r=null){super("password",i),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Jm(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Jm(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return _B(e,t,"signInWithPassword",xee);case"emailLink":return bee(e,{email:this._email,oobCode:this._password});default:Mu(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return _B(e,i,"signUpPassword",vee);case"emailLink":return Cee(e,{idToken:t,email:this._email,oobCode:this._password});default:Mu(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lm(n,e){return iv(n,"POST","/v1/accounts:signInWithIdp",Xp(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _ee="http://localhost";class Dp extends s5{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Dp(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Mu("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r}=t,s=aF(t,["providerId","signInMethod"]);if(!i||!r)return null;const o=new Dp(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Lm(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Lm(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Lm(e,t)}buildRequest(){const e={requestUri:_ee,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=tv(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function See(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Tee(n){const e=hy(uy(n)).link,t=e?hy(uy(e)).deep_link_id:null,i=hy(uy(n)).deep_link_id;return(i?hy(uy(i)).link:null)||i||t||e||n}class o5{constructor(e){var t,i,r,s,o,a;const l=hy(uy(e)),h=(t=l.apiKey)!==null&&t!==void 0?t:null,u=(i=l.oobCode)!==null&&i!==void 0?i:null,d=See((r=l.mode)!==null&&r!==void 0?r:null);Sr(h&&u&&d,"argument-error"),this.apiKey=h,this.operation=d,this.code=u,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=l.lang)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const t=Tee(e);try{return new o5(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p0{constructor(){this.providerId=p0.PROVIDER_ID}static credential(e,t){return Jm._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=o5.parseLink(t);return Sr(i,"argument-error"),Jm._fromEmailAndCode(e,i.code,i.tenantId)}}p0.PROVIDER_ID="password";p0.EMAIL_PASSWORD_SIGN_IN_METHOD="password";p0.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a5{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rv extends a5{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf extends rv{constructor(){super("facebook.com")}static credential(e){return Dp._fromParams({providerId:tf.PROVIDER_ID,signInMethod:tf.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return tf.credentialFromTaggedObject(e)}static credentialFromError(e){return tf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return tf.credential(e.oauthAccessToken)}catch{return null}}}tf.FACEBOOK_SIGN_IN_METHOD="facebook.com";tf.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eA extends rv{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Dp._fromParams({providerId:eA.PROVIDER_ID,signInMethod:eA.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return eA.credentialFromTaggedObject(e)}static credentialFromError(e){return eA.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return eA.credential(t,i)}catch{return null}}}eA.GOOGLE_SIGN_IN_METHOD="google.com";eA.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf extends rv{constructor(){super("github.com")}static credential(e){return Dp._fromParams({providerId:nf.PROVIDER_ID,signInMethod:nf.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return nf.credentialFromTaggedObject(e)}static credentialFromError(e){return nf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return nf.credential(e.oauthAccessToken)}catch{return null}}}nf.GITHUB_SIGN_IN_METHOD="github.com";nf.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf extends rv{constructor(){super("twitter.com")}static credential(e,t){return Dp._fromParams({providerId:rf.PROVIDER_ID,signInMethod:rf.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return rf.credentialFromTaggedObject(e)}static credentialFromError(e){return rf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return rf.credential(t,i)}catch{return null}}}rf.TWITTER_SIGN_IN_METHOD="twitter.com";rf.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bee(n,e){return iv(n,"POST","/v1/accounts:signUp",Xp(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e0{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const s=await dd._fromIdTokenResponse(e,i,r),o=eD(i);return new e0({user:s,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=eD(i);return new e0({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function eD(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EC extends Ed{constructor(e,t,i,r){var s;super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,EC.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new EC(e,t,i,r)}}function MO(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?EC._fromErrorAndOperation(n,s,e,i):s})}async function Eee(n,e,t=!1){const i=await Zm(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return e0._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fee(n,e,t=!1){const{auth:i}=n;if(ah(i.app))return Promise.reject(aA(i));const r="reauthenticate";try{const s=await Zm(n,MO(i,r,e,n),t);Sr(s.idToken,i,"internal-error");const o=uF(s.idToken);Sr(o,i,"internal-error");const{sub:a}=o;return Sr(n.uid===a,i,"user-mismatch"),e0._forOperation(n,r,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Mu(i,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RO(n,e,t=!1){if(ah(n.app))return Promise.reject(aA(n));const i="signIn",r=await MO(n,i,e),s=await e0._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(s.user),s}async function UO(n,e){return RO(xA(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OO(n){const e=xA(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function HO(n,e,t){if(ah(n.app))return Promise.reject(aA(n));const i=xA(n),o=await _B(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Bee).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&OO(n),l}),a=await e0._fromIdTokenResponse(i,"signIn",o);return await i._updateCurrentUser(a.user),a}function WO(n,e,t){return ah(n.app)?Promise.reject(aA(n)):UO(Uo(n),p0.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&OO(n),i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kee(n,e){return kf(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l5(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const i=Uo(n),s={idToken:await i.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await Zm(i,kee(i.auth,s));i.displayName=o.displayName||null,i.photoURL=o.photoUrl||null;const a=i.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=i.displayName,a.photoURL=i.photoURL),await i._updateTokensIfNecessary(o)}function zO(n,e,t,i){return Uo(n).onIdTokenChanged(e,t,i)}function QO(n,e,t){return Uo(n).beforeAuthStateChanged(e,t)}function AF(n,e,t,i){return Uo(n).onAuthStateChanged(e,t,i)}function $O(n){return Uo(n).signOut()}const FC="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VO{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(FC,"1"),this.storage.removeItem(FC),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iee=1e3,Dee=10;class GO extends VO{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=kO(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);iee()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,Dee):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},Iee)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}GO.type="LOCAL";const XO=GO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YO extends VO{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}YO.type="SESSION";const fF=YO;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jee(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c5{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new c5(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const a=Array.from(o).map(async h=>h(t.origin,s)),l=await jee(a);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}c5.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pF(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pee{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const h=pF("",20);r.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(d){const A=d;if(A.data.eventId===h)switch(A.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(A.data.response);break;default:clearTimeout(u),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lA(){return window}function Nee(n){lA().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KO(){return typeof lA().WorkerGlobalScope<"u"&&typeof lA().importScripts=="function"}async function Lee(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Mee(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Ree(){return KO()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qO="firebaseLocalStorageDb",Uee=1,kC="firebaseLocalStorage",ZO="fbase_key";class sv{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function h5(n,e){return n.transaction([kC],e?"readwrite":"readonly").objectStore(kC)}function Oee(){const n=indexedDB.deleteDatabase(qO);return new sv(n).toPromise()}function SB(){const n=indexedDB.open(qO,Uee);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(kC,{keyPath:ZO})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(kC)?e(i):(i.close(),await Oee(),e(await SB()))})})}async function tD(n,e,t){const i=h5(n,!0).put({[ZO]:e,value:t});return new sv(i).toPromise()}async function Hee(n,e){const t=h5(n,!1).get(e),i=await new sv(t).toPromise();return i===void 0?null:i.value}function nD(n,e){const t=h5(n,!0).delete(e);return new sv(t).toPromise()}const Wee=800,zee=3;class JO{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await SB(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>zee)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return KO()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=c5._getInstance(Ree()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await Lee(),!this.activeServiceWorker)return;this.sender=new Pee(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((e=i[0])===null||e===void 0)&&e.fulfilled&&!((t=i[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Mee()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await SB();return await tD(e,FC,"1"),await nD(e,FC),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>tD(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>Hee(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>nD(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=h5(r,!1).getAll();return new sv(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Wee)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}JO.type="LOCAL";const eH=JO;new nv(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gF(n,e){return e?af(e):(Sr(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mF extends s5{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Lm(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Lm(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Lm(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Qee(n){return RO(n.auth,new mF(n),n.bypassAuthState)}function $ee(n){const{auth:e,user:t}=n;return Sr(t,e,"internal-error"),Fee(t,new mF(n),n.bypassAuthState)}async function Vee(n){const{auth:e,user:t}=n;return Sr(t,e,"internal-error"),Eee(t,new mF(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tH{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Qee;case"linkViaPopup":case"linkViaRedirect":return Vee;case"reauthViaPopup":case"reauthViaRedirect":return $ee;default:Mu(this.auth,"internal-error")}}resolve(e){yf(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){yf(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gee=new nv(2e3,1e4);async function nH(n,e,t){if(ah(n.app))return Promise.reject(md(n,"operation-not-supported-in-this-environment"));const i=xA(n);pO(n,e,a5);const r=gF(i,t);return new Dg(i,"signInViaPopup",e,r).executeNotNull()}class Dg extends tH{constructor(e,t,i,r,s){super(e,t,r,s),this.provider=i,this.authWindow=null,this.pollId=null,Dg.currentPopupAction&&Dg.currentPopupAction.cancel(),Dg.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Sr(e,this.auth,"internal-error"),e}async onExecution(){yf(this.filter.length===1,"Popup operations only handle one event");const e=pF();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(md(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(md(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Dg.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if(!((i=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(md(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Gee.get())};e()}}Dg.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xee="pendingRedirect",Xb=new Map;class Yee extends tH{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Xb.get(this.auth._key());if(!e){try{const i=await Kee(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Xb.set(this.auth._key(),e)}return this.bypassAuthState||Xb.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Kee(n,e){const t=rH(e),i=iH(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}async function qee(n,e){return iH(n)._set(rH(e),"true")}function Zee(n,e){Xb.set(n._key(),e)}function iH(n){return af(n._redirectPersistence)}function rH(n){return Gb(Xee,n.config.apiKey,n.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jee(n,e,t){return ete(n,e,t)}async function ete(n,e,t){if(ah(n.app))return Promise.reject(aA(n));const i=xA(n);pO(n,e,a5),await i._initializationPromise;const r=gF(i,t);return await qee(r,i),r._openRedirect(i,e,"signInViaRedirect")}async function sH(n,e){return await xA(n)._initializationPromise,oH(n,e,!1)}async function oH(n,e,t=!1){if(ah(n.app))return Promise.reject(aA(n));const i=xA(n),r=gF(i,e),o=await new Yee(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tte=600*1e3;class nte{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!ite(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!aH(e)){const r=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(md(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=tte&&this.cachedEventUids.clear(),this.cachedEventUids.has(iD(e))}saveEventToCache(e){this.cachedEventUids.add(iD(e)),this.lastProcessedEventTime=Date.now()}}function iD(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function aH({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function ite(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return aH(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rte(n,e={}){return kf(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ste=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ote=/^https?/;async function ate(n){if(n.config.emulator)return;const{authorizedDomains:e}=await rte(n);for(const t of e)try{if(lte(t))return}catch{}Mu(n,"unauthorized-domain")}function lte(n){const e=xB(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!ote.test(t))return!1;if(ste.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cte=new nv(3e4,6e4);function rD(){const n=lA().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function hte(n){return new Promise((e,t)=>{var i,r,s;function o(){rD(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{rD(),t(md(n,"network-request-failed"))},timeout:cte.get()})}if(!((r=(i=lA().gapi)===null||i===void 0?void 0:i.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((s=lA().gapi)===null||s===void 0)&&s.load)o();else{const a=dee("iframefcb");return lA()[a]=()=>{gapi.load?o():t(md(n,"network-request-failed"))},DO(`${uee()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw Yb=null,e})}let Yb=null;function ute(n){return Yb=Yb||hte(n),Yb}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dte=new nv(5e3,15e3),Ate="__/auth/iframe",fte="emulator/auth/iframe",pte={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},gte=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function mte(n){const e=n.config;Sr(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?hF(e,fte):`https://${n.config.authDomain}/${Ate}`,i={apiKey:e.apiKey,appName:n.name,v:f0},r=gte.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${tv(i).slice(1)}`}async function yte(n){const e=await ute(n),t=lA().gapi;return Sr(t,n,"internal-error"),e.open({where:document.body,url:mte(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:pte,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=md(n,"network-request-failed"),a=lA().setTimeout(()=>{s(o)},dte.get());function l(){lA().clearTimeout(a),r(i)}i.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wte={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},vte=500,xte=600,bte="_blank",Cte="http://localhost";class sD{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function _te(n,e,t,i=vte,r=xte){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const l=Object.assign(Object.assign({},wte),{width:i.toString(),height:r.toString(),top:s,left:o}),h=$c().toLowerCase();t&&(a=SO(h)?bte:t),CO(h)&&(e=e||Cte,l.scrollbars="yes");const u=Object.entries(l).reduce((A,[f,p])=>`${A}${f}=${p},`,"");if(nee(h)&&a!=="_self")return Ste(e||"",a),new sD(null);const d=window.open(e||"",a,u);Sr(d,n,"popup-blocked");try{d.focus()}catch{}return new sD(d)}function Ste(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tte="__/auth/handler",Bte="emulator/auth/handler",Ete=encodeURIComponent("fac");async function oD(n,e,t,i,r,s){Sr(n.config.authDomain,n,"auth-domain-config-required"),Sr(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:f0,eventId:r};if(e instanceof a5){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",BZ(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,d]of Object.entries({}))o[u]=d}if(e instanceof rv){const u=e.getScopes().filter(d=>d!=="");u.length>0&&(o.scopes=u.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await n._getAppCheckToken(),h=l?`#${Ete}=${encodeURIComponent(l)}`:"";return`${Fte(n)}?${tv(a).slice(1)}${h}`}function Fte({config:n}){return n.emulator?hF(n,Bte):`https://${n.authDomain}/${Tte}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OS="webStorageSupport";class kte{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=fF,this._completeRedirectFn=oH,this._overrideRedirectResult=Zee}async _openPopup(e,t,i,r){var s;yf((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await oD(e,t,i,xB(),r);return _te(e,o,pF())}async _openRedirect(e,t,i,r){await this._originValidation(e);const s=await oD(e,t,i,xB(),r);return Nee(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(yf(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await yte(e),i=new nte(e);return t.register("authEvent",r=>(Sr(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(OS,{type:OS},r=>{var s;const o=(s=r==null?void 0:r[0])===null||s===void 0?void 0:s[OS];o!==void 0&&t(!!o),Mu(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=ate(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return kO()||_O()||dF()}}const lH=kte;var aD="@firebase/auth",lD="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ite{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Sr(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dte(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function jte(n){Jg(new Ip("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;Sr(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:IO(n)},h=new lee(i,r,s,l);return mee(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Jg(new Ip("auth-internal",e=>{const t=xA(e.getProvider("auth").getImmediate());return(i=>new Ite(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),oA(aD,lD,Dte(n)),oA(aD,lD,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pte=300,Nte=sO("authIdTokenMaxAge")||Pte;let cD=null;const Lte=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>Nte)return;const r=t==null?void 0:t.token;cD!==r&&(cD=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function cH(n=oF()){const e=i5(n,"auth");if(e.isInitialized())return e.getImmediate();const t=PO(n,{popupRedirectResolver:lH,persistence:[eH,XO,fF]}),i=sO("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=Lte(s.toString());QO(t,o,()=>o(t.currentUser)),zO(t,a=>o(a))}}const r=nO("auth");return r&&NO(t,`http://${r}`),t}function Mte(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}cee({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const s=md("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",Mte().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});jte("Browser");const hH=Object.freeze(Object.defineProperty({__proto__:null,ActionCodeURL:o5,AuthCredential:s5,EmailAuthCredential:Jm,EmailAuthProvider:p0,FacebookAuthProvider:tf,GithubAuthProvider:nf,GoogleAuthProvider:eA,OAuthCredential:Dp,TwitterAuthProvider:rf,beforeAuthStateChanged:QO,browserLocalPersistence:XO,browserPopupRedirectResolver:lH,browserSessionPersistence:fF,connectAuthEmulator:NO,createUserWithEmailAndPassword:HO,getAuth:cH,getIdTokenResult:wO,getRedirectResult:sH,inMemoryPersistence:CB,indexedDBLocalPersistence:eH,initializeAuth:PO,onAuthStateChanged:AF,onIdTokenChanged:zO,prodErrorMap:AO,reload:vO,signInWithCredential:UO,signInWithEmailAndPassword:WO,signInWithPopup:nH,signInWithRedirect:Jee,signOut:$O,updateProfile:l5},Symbol.toStringTag,{value:"Module"}));var Rte="firebase",Ute="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */oA(Rte,Ute,"app");var hD=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Tp,uH;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(j,C){function b(){}b.prototype=C.prototype,j.D=C.prototype,j.prototype=new b,j.prototype.constructor=j,j.C=function(D,T,k){for(var B=Array(arguments.length-2),E=2;E<arguments.length;E++)B[E-2]=arguments[E];return C.prototype[T].apply(D,B)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(j,C,b){b||(b=0);var D=Array(16);if(typeof C=="string")for(var T=0;16>T;++T)D[T]=C.charCodeAt(b++)|C.charCodeAt(b++)<<8|C.charCodeAt(b++)<<16|C.charCodeAt(b++)<<24;else for(T=0;16>T;++T)D[T]=C[b++]|C[b++]<<8|C[b++]<<16|C[b++]<<24;C=j.g[0],b=j.g[1],T=j.g[2];var k=j.g[3],B=C+(k^b&(T^k))+D[0]+3614090360&4294967295;C=b+(B<<7&4294967295|B>>>25),B=k+(T^C&(b^T))+D[1]+3905402710&4294967295,k=C+(B<<12&4294967295|B>>>20),B=T+(b^k&(C^b))+D[2]+606105819&4294967295,T=k+(B<<17&4294967295|B>>>15),B=b+(C^T&(k^C))+D[3]+3250441966&4294967295,b=T+(B<<22&4294967295|B>>>10),B=C+(k^b&(T^k))+D[4]+4118548399&4294967295,C=b+(B<<7&4294967295|B>>>25),B=k+(T^C&(b^T))+D[5]+1200080426&4294967295,k=C+(B<<12&4294967295|B>>>20),B=T+(b^k&(C^b))+D[6]+2821735955&4294967295,T=k+(B<<17&4294967295|B>>>15),B=b+(C^T&(k^C))+D[7]+4249261313&4294967295,b=T+(B<<22&4294967295|B>>>10),B=C+(k^b&(T^k))+D[8]+1770035416&4294967295,C=b+(B<<7&4294967295|B>>>25),B=k+(T^C&(b^T))+D[9]+2336552879&4294967295,k=C+(B<<12&4294967295|B>>>20),B=T+(b^k&(C^b))+D[10]+4294925233&4294967295,T=k+(B<<17&4294967295|B>>>15),B=b+(C^T&(k^C))+D[11]+2304563134&4294967295,b=T+(B<<22&4294967295|B>>>10),B=C+(k^b&(T^k))+D[12]+1804603682&4294967295,C=b+(B<<7&4294967295|B>>>25),B=k+(T^C&(b^T))+D[13]+4254626195&4294967295,k=C+(B<<12&4294967295|B>>>20),B=T+(b^k&(C^b))+D[14]+2792965006&4294967295,T=k+(B<<17&4294967295|B>>>15),B=b+(C^T&(k^C))+D[15]+1236535329&4294967295,b=T+(B<<22&4294967295|B>>>10),B=C+(T^k&(b^T))+D[1]+4129170786&4294967295,C=b+(B<<5&4294967295|B>>>27),B=k+(b^T&(C^b))+D[6]+3225465664&4294967295,k=C+(B<<9&4294967295|B>>>23),B=T+(C^b&(k^C))+D[11]+643717713&4294967295,T=k+(B<<14&4294967295|B>>>18),B=b+(k^C&(T^k))+D[0]+3921069994&4294967295,b=T+(B<<20&4294967295|B>>>12),B=C+(T^k&(b^T))+D[5]+3593408605&4294967295,C=b+(B<<5&4294967295|B>>>27),B=k+(b^T&(C^b))+D[10]+38016083&4294967295,k=C+(B<<9&4294967295|B>>>23),B=T+(C^b&(k^C))+D[15]+3634488961&4294967295,T=k+(B<<14&4294967295|B>>>18),B=b+(k^C&(T^k))+D[4]+3889429448&4294967295,b=T+(B<<20&4294967295|B>>>12),B=C+(T^k&(b^T))+D[9]+568446438&4294967295,C=b+(B<<5&4294967295|B>>>27),B=k+(b^T&(C^b))+D[14]+3275163606&4294967295,k=C+(B<<9&4294967295|B>>>23),B=T+(C^b&(k^C))+D[3]+4107603335&4294967295,T=k+(B<<14&4294967295|B>>>18),B=b+(k^C&(T^k))+D[8]+1163531501&4294967295,b=T+(B<<20&4294967295|B>>>12),B=C+(T^k&(b^T))+D[13]+2850285829&4294967295,C=b+(B<<5&4294967295|B>>>27),B=k+(b^T&(C^b))+D[2]+4243563512&4294967295,k=C+(B<<9&4294967295|B>>>23),B=T+(C^b&(k^C))+D[7]+1735328473&4294967295,T=k+(B<<14&4294967295|B>>>18),B=b+(k^C&(T^k))+D[12]+2368359562&4294967295,b=T+(B<<20&4294967295|B>>>12),B=C+(b^T^k)+D[5]+4294588738&4294967295,C=b+(B<<4&4294967295|B>>>28),B=k+(C^b^T)+D[8]+2272392833&4294967295,k=C+(B<<11&4294967295|B>>>21),B=T+(k^C^b)+D[11]+1839030562&4294967295,T=k+(B<<16&4294967295|B>>>16),B=b+(T^k^C)+D[14]+4259657740&4294967295,b=T+(B<<23&4294967295|B>>>9),B=C+(b^T^k)+D[1]+2763975236&4294967295,C=b+(B<<4&4294967295|B>>>28),B=k+(C^b^T)+D[4]+1272893353&4294967295,k=C+(B<<11&4294967295|B>>>21),B=T+(k^C^b)+D[7]+4139469664&4294967295,T=k+(B<<16&4294967295|B>>>16),B=b+(T^k^C)+D[10]+3200236656&4294967295,b=T+(B<<23&4294967295|B>>>9),B=C+(b^T^k)+D[13]+681279174&4294967295,C=b+(B<<4&4294967295|B>>>28),B=k+(C^b^T)+D[0]+3936430074&4294967295,k=C+(B<<11&4294967295|B>>>21),B=T+(k^C^b)+D[3]+3572445317&4294967295,T=k+(B<<16&4294967295|B>>>16),B=b+(T^k^C)+D[6]+76029189&4294967295,b=T+(B<<23&4294967295|B>>>9),B=C+(b^T^k)+D[9]+3654602809&4294967295,C=b+(B<<4&4294967295|B>>>28),B=k+(C^b^T)+D[12]+3873151461&4294967295,k=C+(B<<11&4294967295|B>>>21),B=T+(k^C^b)+D[15]+530742520&4294967295,T=k+(B<<16&4294967295|B>>>16),B=b+(T^k^C)+D[2]+3299628645&4294967295,b=T+(B<<23&4294967295|B>>>9),B=C+(T^(b|~k))+D[0]+4096336452&4294967295,C=b+(B<<6&4294967295|B>>>26),B=k+(b^(C|~T))+D[7]+1126891415&4294967295,k=C+(B<<10&4294967295|B>>>22),B=T+(C^(k|~b))+D[14]+2878612391&4294967295,T=k+(B<<15&4294967295|B>>>17),B=b+(k^(T|~C))+D[5]+4237533241&4294967295,b=T+(B<<21&4294967295|B>>>11),B=C+(T^(b|~k))+D[12]+1700485571&4294967295,C=b+(B<<6&4294967295|B>>>26),B=k+(b^(C|~T))+D[3]+2399980690&4294967295,k=C+(B<<10&4294967295|B>>>22),B=T+(C^(k|~b))+D[10]+4293915773&4294967295,T=k+(B<<15&4294967295|B>>>17),B=b+(k^(T|~C))+D[1]+2240044497&4294967295,b=T+(B<<21&4294967295|B>>>11),B=C+(T^(b|~k))+D[8]+1873313359&4294967295,C=b+(B<<6&4294967295|B>>>26),B=k+(b^(C|~T))+D[15]+4264355552&4294967295,k=C+(B<<10&4294967295|B>>>22),B=T+(C^(k|~b))+D[6]+2734768916&4294967295,T=k+(B<<15&4294967295|B>>>17),B=b+(k^(T|~C))+D[13]+1309151649&4294967295,b=T+(B<<21&4294967295|B>>>11),B=C+(T^(b|~k))+D[4]+4149444226&4294967295,C=b+(B<<6&4294967295|B>>>26),B=k+(b^(C|~T))+D[11]+3174756917&4294967295,k=C+(B<<10&4294967295|B>>>22),B=T+(C^(k|~b))+D[2]+718787259&4294967295,T=k+(B<<15&4294967295|B>>>17),B=b+(k^(T|~C))+D[9]+3951481745&4294967295,j.g[0]=j.g[0]+C&4294967295,j.g[1]=j.g[1]+(T+(B<<21&4294967295|B>>>11))&4294967295,j.g[2]=j.g[2]+T&4294967295,j.g[3]=j.g[3]+k&4294967295}i.prototype.u=function(j,C){C===void 0&&(C=j.length);for(var b=C-this.blockSize,D=this.B,T=this.h,k=0;k<C;){if(T==0)for(;k<=b;)r(this,j,k),k+=this.blockSize;if(typeof j=="string"){for(;k<C;)if(D[T++]=j.charCodeAt(k++),T==this.blockSize){r(this,D),T=0;break}}else for(;k<C;)if(D[T++]=j[k++],T==this.blockSize){r(this,D),T=0;break}}this.h=T,this.o+=C},i.prototype.v=function(){var j=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);j[0]=128;for(var C=1;C<j.length-8;++C)j[C]=0;var b=8*this.o;for(C=j.length-8;C<j.length;++C)j[C]=b&255,b/=256;for(this.u(j),j=Array(16),C=b=0;4>C;++C)for(var D=0;32>D;D+=8)j[b++]=this.g[C]>>>D&255;return j};function s(j,C){var b=a;return Object.prototype.hasOwnProperty.call(b,j)?b[j]:b[j]=C(j)}function o(j,C){this.h=C;for(var b=[],D=!0,T=j.length-1;0<=T;T--){var k=j[T]|0;D&&k==C||(b[T]=k,D=!1)}this.g=b}var a={};function l(j){return-128<=j&&128>j?s(j,function(C){return new o([C|0],0>C?-1:0)}):new o([j|0],0>j?-1:0)}function h(j){if(isNaN(j)||!isFinite(j))return d;if(0>j)return v(h(-j));for(var C=[],b=1,D=0;j>=b;D++)C[D]=j/b|0,b*=4294967296;return new o(C,0)}function u(j,C){if(j.length==0)throw Error("number format error: empty string");if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(j.charAt(0)=="-")return v(u(j.substring(1),C));if(0<=j.indexOf("-"))throw Error('number format error: interior "-" character');for(var b=h(Math.pow(C,8)),D=d,T=0;T<j.length;T+=8){var k=Math.min(8,j.length-T),B=parseInt(j.substring(T,T+k),C);8>k?(k=h(Math.pow(C,k)),D=D.j(k).add(h(B))):(D=D.j(b),D=D.add(h(B)))}return D}var d=l(0),A=l(1),f=l(16777216);n=o.prototype,n.m=function(){if(g(this))return-v(this).m();for(var j=0,C=1,b=0;b<this.g.length;b++){var D=this.i(b);j+=(0<=D?D:4294967296+D)*C,C*=4294967296}return j},n.toString=function(j){if(j=j||10,2>j||36<j)throw Error("radix out of range: "+j);if(p(this))return"0";if(g(this))return"-"+v(this).toString(j);for(var C=h(Math.pow(j,6)),b=this,D="";;){var T=x(b,C).g;b=w(b,T.j(C));var k=((0<b.g.length?b.g[0]:b.h)>>>0).toString(j);if(b=T,p(b))return k+D;for(;6>k.length;)k="0"+k;D=k+D}},n.i=function(j){return 0>j?0:j<this.g.length?this.g[j]:this.h};function p(j){if(j.h!=0)return!1;for(var C=0;C<j.g.length;C++)if(j.g[C]!=0)return!1;return!0}function g(j){return j.h==-1}n.l=function(j){return j=w(this,j),g(j)?-1:p(j)?0:1};function v(j){for(var C=j.g.length,b=[],D=0;D<C;D++)b[D]=~j.g[D];return new o(b,~j.h).add(A)}n.abs=function(){return g(this)?v(this):this},n.add=function(j){for(var C=Math.max(this.g.length,j.g.length),b=[],D=0,T=0;T<=C;T++){var k=D+(this.i(T)&65535)+(j.i(T)&65535),B=(k>>>16)+(this.i(T)>>>16)+(j.i(T)>>>16);D=B>>>16,k&=65535,B&=65535,b[T]=B<<16|k}return new o(b,b[b.length-1]&-2147483648?-1:0)};function w(j,C){return j.add(v(C))}n.j=function(j){if(p(this)||p(j))return d;if(g(this))return g(j)?v(this).j(v(j)):v(v(this).j(j));if(g(j))return v(this.j(v(j)));if(0>this.l(f)&&0>j.l(f))return h(this.m()*j.m());for(var C=this.g.length+j.g.length,b=[],D=0;D<2*C;D++)b[D]=0;for(D=0;D<this.g.length;D++)for(var T=0;T<j.g.length;T++){var k=this.i(D)>>>16,B=this.i(D)&65535,E=j.i(T)>>>16,z=j.i(T)&65535;b[2*D+2*T]+=B*z,m(b,2*D+2*T),b[2*D+2*T+1]+=k*z,m(b,2*D+2*T+1),b[2*D+2*T+1]+=B*E,m(b,2*D+2*T+1),b[2*D+2*T+2]+=k*E,m(b,2*D+2*T+2)}for(D=0;D<C;D++)b[D]=b[2*D+1]<<16|b[2*D];for(D=C;D<2*C;D++)b[D]=0;return new o(b,0)};function m(j,C){for(;(j[C]&65535)!=j[C];)j[C+1]+=j[C]>>>16,j[C]&=65535,C++}function y(j,C){this.g=j,this.h=C}function x(j,C){if(p(C))throw Error("division by zero");if(p(j))return new y(d,d);if(g(j))return C=x(v(j),C),new y(v(C.g),v(C.h));if(g(C))return C=x(j,v(C)),new y(v(C.g),C.h);if(30<j.g.length){if(g(j)||g(C))throw Error("slowDivide_ only works with positive integers.");for(var b=A,D=C;0>=D.l(j);)b=S(b),D=S(D);var T=I(b,1),k=I(D,1);for(D=I(D,2),b=I(b,2);!p(D);){var B=k.add(D);0>=B.l(j)&&(T=T.add(b),k=B),D=I(D,1),b=I(b,1)}return C=w(j,T.j(C)),new y(T,C)}for(T=d;0<=j.l(C);){for(b=Math.max(1,Math.floor(j.m()/C.m())),D=Math.ceil(Math.log(b)/Math.LN2),D=48>=D?1:Math.pow(2,D-48),k=h(b),B=k.j(C);g(B)||0<B.l(j);)b-=D,k=h(b),B=k.j(C);p(k)&&(k=A),T=T.add(k),j=w(j,B)}return new y(T,j)}n.A=function(j){return x(this,j).h},n.and=function(j){for(var C=Math.max(this.g.length,j.g.length),b=[],D=0;D<C;D++)b[D]=this.i(D)&j.i(D);return new o(b,this.h&j.h)},n.or=function(j){for(var C=Math.max(this.g.length,j.g.length),b=[],D=0;D<C;D++)b[D]=this.i(D)|j.i(D);return new o(b,this.h|j.h)},n.xor=function(j){for(var C=Math.max(this.g.length,j.g.length),b=[],D=0;D<C;D++)b[D]=this.i(D)^j.i(D);return new o(b,this.h^j.h)};function S(j){for(var C=j.g.length+1,b=[],D=0;D<C;D++)b[D]=j.i(D)<<1|j.i(D-1)>>>31;return new o(b,j.h)}function I(j,C){var b=C>>5;C%=32;for(var D=j.g.length-b,T=[],k=0;k<D;k++)T[k]=0<C?j.i(k+b)>>>C|j.i(k+b+1)<<32-C:j.i(k+b);return new o(T,j.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,uH=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=u,Tp=o}).apply(typeof hD<"u"?hD:typeof self<"u"?self:typeof window<"u"?window:{});var ex=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var dH,dy,AH,Kb,TB,fH,pH,gH;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(N,ce,we){return N==Array.prototype||N==Object.prototype||(N[ce]=we.value),N};function t(N){N=[typeof globalThis=="object"&&globalThis,N,typeof window=="object"&&window,typeof self=="object"&&self,typeof ex=="object"&&ex];for(var ce=0;ce<N.length;++ce){var we=N[ce];if(we&&we.Math==Math)return we}throw Error("Cannot find global object")}var i=t(this);function r(N,ce){if(ce)e:{var we=i;N=N.split(".");for(var Pe=0;Pe<N.length-1;Pe++){var Nt=N[Pe];if(!(Nt in we))break e;we=we[Nt]}N=N[N.length-1],Pe=we[N],ce=ce(Pe),ce!=Pe&&ce!=null&&e(we,N,{configurable:!0,writable:!0,value:ce})}}function s(N,ce){N instanceof String&&(N+="");var we=0,Pe=!1,Nt={next:function(){if(!Pe&&we<N.length){var tn=we++;return{value:ce(tn,N[tn]),done:!1}}return Pe=!0,{done:!0,value:void 0}}};return Nt[Symbol.iterator]=function(){return Nt},Nt}r("Array.prototype.values",function(N){return N||function(){return s(this,function(ce,we){return we})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(N){var ce=typeof N;return ce=ce!="object"?ce:N?Array.isArray(N)?"array":ce:"null",ce=="array"||ce=="object"&&typeof N.length=="number"}function h(N){var ce=typeof N;return ce=="object"&&N!=null||ce=="function"}function u(N,ce,we){return N.call.apply(N.bind,arguments)}function d(N,ce,we){if(!N)throw Error();if(2<arguments.length){var Pe=Array.prototype.slice.call(arguments,2);return function(){var Nt=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Nt,Pe),N.apply(ce,Nt)}}return function(){return N.apply(ce,arguments)}}function A(N,ce,we){return A=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:d,A.apply(null,arguments)}function f(N,ce){var we=Array.prototype.slice.call(arguments,1);return function(){var Pe=we.slice();return Pe.push.apply(Pe,arguments),N.apply(this,Pe)}}function p(N,ce){function we(){}we.prototype=ce.prototype,N.aa=ce.prototype,N.prototype=new we,N.prototype.constructor=N,N.Qb=function(Pe,Nt,tn){for(var Un=Array(arguments.length-2),is=2;is<arguments.length;is++)Un[is-2]=arguments[is];return ce.prototype[Nt].apply(Pe,Un)}}function g(N){const ce=N.length;if(0<ce){const we=Array(ce);for(let Pe=0;Pe<ce;Pe++)we[Pe]=N[Pe];return we}return[]}function v(N,ce){for(let we=1;we<arguments.length;we++){const Pe=arguments[we];if(l(Pe)){const Nt=N.length||0,tn=Pe.length||0;N.length=Nt+tn;for(let Un=0;Un<tn;Un++)N[Nt+Un]=Pe[Un]}else N.push(Pe)}}class w{constructor(ce,we){this.i=ce,this.j=we,this.h=0,this.g=null}get(){let ce;return 0<this.h?(this.h--,ce=this.g,this.g=ce.next,ce.next=null):ce=this.i(),ce}}function m(N){return/^[\s\xa0]*$/.test(N)}function y(){var N=a.navigator;return N&&(N=N.userAgent)?N:""}function x(N){return x[" "](N),N}x[" "]=function(){};var S=y().indexOf("Gecko")!=-1&&!(y().toLowerCase().indexOf("webkit")!=-1&&y().indexOf("Edge")==-1)&&!(y().indexOf("Trident")!=-1||y().indexOf("MSIE")!=-1)&&y().indexOf("Edge")==-1;function I(N,ce,we){for(const Pe in N)ce.call(we,N[Pe],Pe,N)}function j(N,ce){for(const we in N)ce.call(void 0,N[we],we,N)}function C(N){const ce={};for(const we in N)ce[we]=N[we];return ce}const b="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(N,ce){let we,Pe;for(let Nt=1;Nt<arguments.length;Nt++){Pe=arguments[Nt];for(we in Pe)N[we]=Pe[we];for(let tn=0;tn<b.length;tn++)we=b[tn],Object.prototype.hasOwnProperty.call(Pe,we)&&(N[we]=Pe[we])}}function T(N){var ce=1;N=N.split(":");const we=[];for(;0<ce&&N.length;)we.push(N.shift()),ce--;return N.length&&we.push(N.join(":")),we}function k(N){a.setTimeout(()=>{throw N},0)}function B(){var N=J;let ce=null;return N.g&&(ce=N.g,N.g=N.g.next,N.g||(N.h=null),ce.next=null),ce}class E{constructor(){this.h=this.g=null}add(ce,we){const Pe=z.get();Pe.set(ce,we),this.h?this.h.next=Pe:this.g=Pe,this.h=Pe}}var z=new w(()=>new te,N=>N.reset());class te{constructor(){this.next=this.g=this.h=null}set(ce,we){this.h=ce,this.g=we,this.next=null}reset(){this.next=this.g=this.h=null}}let L,O=!1,J=new E,$=()=>{const N=a.Promise.resolve(void 0);L=()=>{N.then(U)}};var U=()=>{for(var N;N=B();){try{N.h.call(N.g)}catch(we){k(we)}var ce=z;ce.j(N),100>ce.h&&(ce.h++,N.next=ce.g,ce.g=N)}O=!1};function Y(){this.s=this.s,this.C=this.C}Y.prototype.s=!1,Y.prototype.ma=function(){this.s||(this.s=!0,this.N())},Y.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function K(N,ce){this.type=N,this.g=this.target=ce,this.defaultPrevented=!1}K.prototype.h=function(){this.defaultPrevented=!0};var V=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var N=!1,ce=Object.defineProperty({},"passive",{get:function(){N=!0}});try{const we=()=>{};a.addEventListener("test",we,ce),a.removeEventListener("test",we,ce)}catch{}return N})();function Q(N,ce){if(K.call(this,N?N.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,N){var we=this.type=N.type,Pe=N.changedTouches&&N.changedTouches.length?N.changedTouches[0]:null;if(this.target=N.target||N.srcElement,this.g=ce,ce=N.relatedTarget){if(S){e:{try{x(ce.nodeName);var Nt=!0;break e}catch{}Nt=!1}Nt||(ce=null)}}else we=="mouseover"?ce=N.fromElement:we=="mouseout"&&(ce=N.toElement);this.relatedTarget=ce,Pe?(this.clientX=Pe.clientX!==void 0?Pe.clientX:Pe.pageX,this.clientY=Pe.clientY!==void 0?Pe.clientY:Pe.pageY,this.screenX=Pe.screenX||0,this.screenY=Pe.screenY||0):(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0),this.button=N.button,this.key=N.key||"",this.ctrlKey=N.ctrlKey,this.altKey=N.altKey,this.shiftKey=N.shiftKey,this.metaKey=N.metaKey,this.pointerId=N.pointerId||0,this.pointerType=typeof N.pointerType=="string"?N.pointerType:X[N.pointerType]||"",this.state=N.state,this.i=N,N.defaultPrevented&&Q.aa.h.call(this)}}p(Q,K);var X={2:"touch",3:"pen",4:"mouse"};Q.prototype.h=function(){Q.aa.h.call(this);var N=this.i;N.preventDefault?N.preventDefault():N.returnValue=!1};var W="closure_listenable_"+(1e6*Math.random()|0),se=0;function q(N,ce,we,Pe,Nt){this.listener=N,this.proxy=null,this.src=ce,this.type=we,this.capture=!!Pe,this.ha=Nt,this.key=++se,this.da=this.fa=!1}function de(N){N.da=!0,N.listener=null,N.proxy=null,N.src=null,N.ha=null}function Ce(N){this.src=N,this.g={},this.h=0}Ce.prototype.add=function(N,ce,we,Pe,Nt){var tn=N.toString();N=this.g[tn],N||(N=this.g[tn]=[],this.h++);var Un=fe(N,ce,Pe,Nt);return-1<Un?(ce=N[Un],we||(ce.fa=!1)):(ce=new q(ce,this.src,tn,!!Pe,Nt),ce.fa=we,N.push(ce)),ce};function Se(N,ce){var we=ce.type;if(we in N.g){var Pe=N.g[we],Nt=Array.prototype.indexOf.call(Pe,ce,void 0),tn;(tn=0<=Nt)&&Array.prototype.splice.call(Pe,Nt,1),tn&&(de(ce),N.g[we].length==0&&(delete N.g[we],N.h--))}}function fe(N,ce,we,Pe){for(var Nt=0;Nt<N.length;++Nt){var tn=N[Nt];if(!tn.da&&tn.listener==ce&&tn.capture==!!we&&tn.ha==Pe)return Nt}return-1}var M="closure_lm_"+(1e6*Math.random()|0),Z={};function Ae(N,ce,we,Pe,Nt){if(Array.isArray(ce)){for(var tn=0;tn<ce.length;tn++)Ae(N,ce[tn],we,Pe,Nt);return null}return we=De(we),N&&N[W]?N.K(ce,we,h(Pe)?!!Pe.capture:!1,Nt):ie(N,ce,we,!1,Pe,Nt)}function ie(N,ce,we,Pe,Nt,tn){if(!ce)throw Error("Invalid event type");var Un=h(Nt)?!!Nt.capture:!!Nt,is=Be(N);if(is||(N[M]=is=new Ce(N)),we=is.add(ce,we,Pe,Un,tn),we.proxy)return we;if(Pe=ee(),we.proxy=Pe,Pe.src=N,Pe.listener=we,N.addEventListener)V||(Nt=Un),Nt===void 0&&(Nt=!1),N.addEventListener(ce.toString(),Pe,Nt);else if(N.attachEvent)N.attachEvent(_e(ce.toString()),Pe);else if(N.addListener&&N.removeListener)N.addListener(Pe);else throw Error("addEventListener and attachEvent are unavailable.");return we}function ee(){function N(we){return ce.call(N.src,N.listener,we)}const ce=ue;return N}function ae(N,ce,we,Pe,Nt){if(Array.isArray(ce))for(var tn=0;tn<ce.length;tn++)ae(N,ce[tn],we,Pe,Nt);else Pe=h(Pe)?!!Pe.capture:!!Pe,we=De(we),N&&N[W]?(N=N.i,ce=String(ce).toString(),ce in N.g&&(tn=N.g[ce],we=fe(tn,we,Pe,Nt),-1<we&&(de(tn[we]),Array.prototype.splice.call(tn,we,1),tn.length==0&&(delete N.g[ce],N.h--)))):N&&(N=Be(N))&&(ce=N.g[ce.toString()],N=-1,ce&&(N=fe(ce,we,Pe,Nt)),(we=-1<N?ce[N]:null)&&me(we))}function me(N){if(typeof N!="number"&&N&&!N.da){var ce=N.src;if(ce&&ce[W])Se(ce.i,N);else{var we=N.type,Pe=N.proxy;ce.removeEventListener?ce.removeEventListener(we,Pe,N.capture):ce.detachEvent?ce.detachEvent(_e(we),Pe):ce.addListener&&ce.removeListener&&ce.removeListener(Pe),(we=Be(ce))?(Se(we,N),we.h==0&&(we.src=null,ce[M]=null)):de(N)}}}function _e(N){return N in Z?Z[N]:Z[N]="on"+N}function ue(N,ce){if(N.da)N=!0;else{ce=new Q(ce,this);var we=N.listener,Pe=N.ha||N.src;N.fa&&me(N),N=we.call(Pe,ce)}return N}function Be(N){return N=N[M],N instanceof Ce?N:null}var it="__closure_events_fn_"+(1e9*Math.random()>>>0);function De(N){return typeof N=="function"?N:(N[it]||(N[it]=function(ce){return N.handleEvent(ce)}),N[it])}function qe(){Y.call(this),this.i=new Ce(this),this.M=this,this.F=null}p(qe,Y),qe.prototype[W]=!0,qe.prototype.removeEventListener=function(N,ce,we,Pe){ae(this,N,ce,we,Pe)};function Je(N,ce){var we,Pe=N.F;if(Pe)for(we=[];Pe;Pe=Pe.F)we.push(Pe);if(N=N.M,Pe=ce.type||ce,typeof ce=="string")ce=new K(ce,N);else if(ce instanceof K)ce.target=ce.target||N;else{var Nt=ce;ce=new K(Pe,N),D(ce,Nt)}if(Nt=!0,we)for(var tn=we.length-1;0<=tn;tn--){var Un=ce.g=we[tn];Nt=Me(Un,Pe,!0,ce)&&Nt}if(Un=ce.g=N,Nt=Me(Un,Pe,!0,ce)&&Nt,Nt=Me(Un,Pe,!1,ce)&&Nt,we)for(tn=0;tn<we.length;tn++)Un=ce.g=we[tn],Nt=Me(Un,Pe,!1,ce)&&Nt}qe.prototype.N=function(){if(qe.aa.N.call(this),this.i){var N=this.i,ce;for(ce in N.g){for(var we=N.g[ce],Pe=0;Pe<we.length;Pe++)de(we[Pe]);delete N.g[ce],N.h--}}this.F=null},qe.prototype.K=function(N,ce,we,Pe){return this.i.add(String(N),ce,!1,we,Pe)},qe.prototype.L=function(N,ce,we,Pe){return this.i.add(String(N),ce,!0,we,Pe)};function Me(N,ce,we,Pe){if(ce=N.i.g[String(ce)],!ce)return!0;ce=ce.concat();for(var Nt=!0,tn=0;tn<ce.length;++tn){var Un=ce[tn];if(Un&&!Un.da&&Un.capture==we){var is=Un.listener,ro=Un.ha||Un.src;Un.fa&&Se(N.i,Un),Nt=is.call(ro,Pe)!==!1&&Nt}}return Nt&&!Pe.defaultPrevented}function et(N,ce,we){if(typeof N=="function")we&&(N=A(N,we));else if(N&&typeof N.handleEvent=="function")N=A(N.handleEvent,N);else throw Error("Invalid listener argument");return 2147483647<Number(ce)?-1:a.setTimeout(N,ce||0)}function He(N){N.g=et(()=>{N.g=null,N.i&&(N.i=!1,He(N))},N.l);const ce=N.h;N.h=null,N.m.apply(null,ce)}class ze extends Y{constructor(ce,we){super(),this.m=ce,this.l=we,this.h=null,this.i=!1,this.g=null}j(ce){this.h=arguments,this.g?this.i=!0:He(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Oe(N){Y.call(this),this.h=N,this.g={}}p(Oe,Y);var ke=[];function je(N){I(N.g,function(ce,we){this.g.hasOwnProperty(we)&&me(ce)},N),N.g={}}Oe.prototype.N=function(){Oe.aa.N.call(this),je(this)},Oe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var rt=a.JSON.stringify,_t=a.JSON.parse,Ee=class{stringify(N){return a.JSON.stringify(N,void 0)}parse(N){return a.JSON.parse(N,void 0)}};function Le(){}Le.prototype.h=null;function ye(N){return N.h||(N.h=N.i())}function Ze(){}var nt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function st(){K.call(this,"d")}p(st,K);function At(){K.call(this,"c")}p(At,K);var ft={},Xt=null;function Yt(){return Xt=Xt||new qe}ft.La="serverreachability";function Zt(N){K.call(this,ft.La,N)}p(Zt,K);function sn(N){const ce=Yt();Je(ce,new Zt(ce))}ft.STAT_EVENT="statevent";function vt(N,ce){K.call(this,ft.STAT_EVENT,N),this.stat=ce}p(vt,K);function Ye(N){const ce=Yt();Je(ce,new vt(ce,N))}ft.Ma="timingevent";function Gt(N,ce){K.call(this,ft.Ma,N),this.size=ce}p(Gt,K);function Wt(N,ce){if(typeof N!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){N()},ce)}function Vt(){this.g=!0}Vt.prototype.xa=function(){this.g=!1};function Jt(N,ce,we,Pe,Nt,tn){N.info(function(){if(N.g)if(tn)for(var Un="",is=tn.split("&"),ro=0;ro<is.length;ro++){var $r=is[ro].split("=");if(1<$r.length){var rs=$r[0];$r=$r[1];var Bs=rs.split("_");Un=2<=Bs.length&&Bs[1]=="type"?Un+(rs+"="+$r+"&"):Un+(rs+"=redacted&")}}else Un=null;else Un=tn;return"XMLHTTP REQ ("+Pe+") [attempt "+Nt+"]: "+ce+`
`+we+`
`+Un})}function It(N,ce,we,Pe,Nt,tn,Un){N.info(function(){return"XMLHTTP RESP ("+Pe+") [ attempt "+Nt+"]: "+ce+`
`+we+`
`+tn+" "+Un})}function Ut(N,ce,we,Pe){N.info(function(){return"XMLHTTP TEXT ("+ce+"): "+Sn(N,we)+(Pe?" "+Pe:"")})}function un(N,ce){N.info(function(){return"TIMEOUT: "+ce})}Vt.prototype.info=function(){};function Sn(N,ce){if(!N.g)return ce;if(!ce)return null;try{var we=JSON.parse(ce);if(we){for(N=0;N<we.length;N++)if(Array.isArray(we[N])){var Pe=we[N];if(!(2>Pe.length)){var Nt=Pe[1];if(Array.isArray(Nt)&&!(1>Nt.length)){var tn=Nt[0];if(tn!="noop"&&tn!="stop"&&tn!="close")for(var Un=1;Un<Nt.length;Un++)Nt[Un]=""}}}}return rt(we)}catch{return ce}}var jt={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},fn={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Zn;function Hn(){}p(Hn,Le),Hn.prototype.g=function(){return new XMLHttpRequest},Hn.prototype.i=function(){return{}},Zn=new Hn;function ti(N,ce,we,Pe){this.j=N,this.i=ce,this.l=we,this.R=Pe||1,this.U=new Oe(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ri}function ri(){this.i=null,this.g="",this.h=!1}var bi={},Ni={};function ui(N,ce,we){N.L=1,N.v=li(Ri(ce)),N.m=we,N.P=!0,si(N,null)}function si(N,ce){N.F=Date.now(),xr(N),N.A=Ri(N.v);var we=N.A,Pe=N.R;Array.isArray(Pe)||(Pe=[String(Pe)]),Ge(we.i,"t",Pe),N.C=0,we=N.j.J,N.h=new ri,N.g=or(N.j,we?ce:null,!N.m),0<N.O&&(N.M=new ze(A(N.Y,N,N.g),N.O)),ce=N.U,we=N.g,Pe=N.ca;var Nt="readystatechange";Array.isArray(Nt)||(Nt&&(ke[0]=Nt.toString()),Nt=ke);for(var tn=0;tn<Nt.length;tn++){var Un=Ae(we,Nt[tn],Pe||ce.handleEvent,!1,ce.h||ce);if(!Un)break;ce.g[Un.key]=Un}ce=N.H?C(N.H):{},N.m?(N.u||(N.u="POST"),ce["Content-Type"]="application/x-www-form-urlencoded",N.g.ea(N.A,N.u,N.m,ce)):(N.u="GET",N.g.ea(N.A,N.u,null,ce)),sn(),Jt(N.i,N.u,N.A,N.l,N.R,N.m)}ti.prototype.ca=function(N){N=N.target;const ce=this.M;ce&&zi(N)==3?ce.j():this.Y(N)},ti.prototype.Y=function(N){try{if(N==this.g)e:{const Bs=zi(this.g);var ce=this.g.Ba();const _l=this.g.Z();if(!(3>Bs)&&(Bs!=3||this.g&&(this.h.h||this.g.oa()||Ir(this.g)))){this.J||Bs!=4||ce==7||(ce==8||0>=_l?sn(3):sn(2)),vn(this);var we=this.g.Z();this.X=we;t:if(Li(this)){var Pe=Ir(this.g);N="";var Nt=Pe.length,tn=zi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ve(this),wi(this);var Un="";break t}this.h.i=new a.TextDecoder}for(ce=0;ce<Nt;ce++)this.h.h=!0,N+=this.h.i.decode(Pe[ce],{stream:!(tn&&ce==Nt-1)});Pe.length=0,this.h.g+=N,this.C=0,Un=this.h.g}else Un=this.g.oa();if(this.o=we==200,It(this.i,this.u,this.A,this.l,this.R,Bs,we),this.o){if(this.T&&!this.K){t:{if(this.g){var is,ro=this.g;if((is=ro.g?ro.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!m(is)){var $r=is;break t}}$r=null}if(we=$r)Ut(this.i,this.l,we,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ct(this,we);else{this.o=!1,this.s=3,Ye(12),Ve(this),wi(this);break e}}if(this.P){we=!0;let Bo;for(;!this.J&&this.C<Un.length;)if(Bo=Tr(this,Un),Bo==Ni){Bs==4&&(this.s=4,Ye(14),we=!1),Ut(this.i,this.l,null,"[Incomplete Response]");break}else if(Bo==bi){this.s=4,Ye(15),Ut(this.i,this.l,Un,"[Invalid Chunk]"),we=!1;break}else Ut(this.i,this.l,Bo,null),ct(this,Bo);if(Li(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Bs!=4||Un.length!=0||this.h.h||(this.s=1,Ye(16),we=!1),this.o=this.o&&we,!we)Ut(this.i,this.l,Un,"[Invalid Chunked Response]"),Ve(this),wi(this);else if(0<Un.length&&!this.W){this.W=!0;var rs=this.j;rs.g==this&&rs.ba&&!rs.M&&(rs.j.info("Great, no buffering proxy detected. Bytes received: "+Un.length),Rn(rs),rs.M=!0,Ye(11))}}else Ut(this.i,this.l,Un,null),ct(this,Un);Bs==4&&Ve(this),this.o&&!this.J&&(Bs==4?qr(this.j,this):(this.o=!1,xr(this)))}else Hr(this.g),we==400&&0<Un.indexOf("Unknown SID")?(this.s=3,Ye(12)):(this.s=0,Ye(13)),Ve(this),wi(this)}}}catch{}finally{}};function Li(N){return N.g?N.u=="GET"&&N.L!=2&&N.j.Ca:!1}function Tr(N,ce){var we=N.C,Pe=ce.indexOf(`
`,we);return Pe==-1?Ni:(we=Number(ce.substring(we,Pe)),isNaN(we)?bi:(Pe+=1,Pe+we>ce.length?Ni:(ce=ce.slice(Pe,Pe+we),N.C=Pe+we,ce)))}ti.prototype.cancel=function(){this.J=!0,Ve(this)};function xr(N){N.S=Date.now()+N.I,br(N,N.I)}function br(N,ce){if(N.B!=null)throw Error("WatchDog timer not null");N.B=Wt(A(N.ba,N),ce)}function vn(N){N.B&&(a.clearTimeout(N.B),N.B=null)}ti.prototype.ba=function(){this.B=null;const N=Date.now();0<=N-this.S?(un(this.i,this.A),this.L!=2&&(sn(),Ye(17)),Ve(this),this.s=2,wi(this)):br(this,this.S-N)};function wi(N){N.j.G==0||N.J||qr(N.j,N)}function Ve(N){vn(N);var ce=N.M;ce&&typeof ce.ma=="function"&&ce.ma(),N.M=null,je(N.U),N.g&&(ce=N.g,N.g=null,ce.abort(),ce.ma())}function ct(N,ce){try{var we=N.j;if(we.G!=0&&(we.g==N||gn(we.h,N))){if(!N.K&&gn(we.h,N)&&we.G==3){try{var Pe=we.Da.g.parse(ce)}catch{Pe=null}if(Array.isArray(Pe)&&Pe.length==3){var Nt=Pe;if(Nt[0]==0){e:if(!we.u){if(we.g)if(we.g.F+3e3<N.F)dr(we),Ue(we);else break e;ni(we),Ye(18)}}else we.za=Nt[1],0<we.za-we.T&&37500>Nt[2]&&we.F&&we.v==0&&!we.C&&(we.C=Wt(A(we.Za,we),6e3));if(1>=zt(we.h)&&we.ca){try{we.ca()}catch{}we.ca=void 0}}else Cr(we,11)}else if((N.K||we.g==N)&&dr(we),!m(ce))for(Nt=we.Da.g.parse(ce),ce=0;ce<Nt.length;ce++){let $r=Nt[ce];if(we.T=$r[0],$r=$r[1],we.G==2)if($r[0]=="c"){we.K=$r[1],we.ia=$r[2];const rs=$r[3];rs!=null&&(we.la=rs,we.j.info("VER="+we.la));const Bs=$r[4];Bs!=null&&(we.Aa=Bs,we.j.info("SVER="+we.Aa));const _l=$r[5];_l!=null&&typeof _l=="number"&&0<_l&&(Pe=1.5*_l,we.L=Pe,we.j.info("backChannelRequestTimeoutMs_="+Pe)),Pe=we;const Bo=N.g;if(Bo){const Ao=Bo.g?Bo.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ao){var tn=Pe.h;tn.g||Ao.indexOf("spdy")==-1&&Ao.indexOf("quic")==-1&&Ao.indexOf("h2")==-1||(tn.j=tn.l,tn.g=new Set,tn.h&&(Jn(tn,tn.h),tn.h=null))}if(Pe.D){const Ha=Bo.g?Bo.g.getResponseHeader("X-HTTP-Session-Id"):null;Ha&&(Pe.ya=Ha,ln(Pe.I,Pe.D,Ha))}}we.G=3,we.l&&we.l.ua(),we.ba&&(we.R=Date.now()-N.F,we.j.info("Handshake RTT: "+we.R+"ms")),Pe=we;var Un=N;if(Pe.qa=Qr(Pe,Pe.J?Pe.ia:null,Pe.W),Un.K){Qn(Pe.h,Un);var is=Un,ro=Pe.L;ro&&(is.I=ro),is.B&&(vn(is),xr(is)),Pe.g=Un}else ai(Pe);0<we.i.length&&yt(we)}else $r[0]!="stop"&&$r[0]!="close"||Cr(we,7);else we.G==3&&($r[0]=="stop"||$r[0]=="close"?$r[0]=="stop"?Cr(we,7):be(we):$r[0]!="noop"&&we.l&&we.l.ta($r),we.v=0)}}sn(4)}catch{}}var mt=class{constructor(N,ce){this.g=N,this.map=ce}};function An(N){this.l=N||10,a.PerformanceNavigationTiming?(N=a.performance.getEntriesByType("navigation"),N=0<N.length&&(N[0].nextHopProtocol=="hq"||N[0].nextHopProtocol=="h2")):N=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=N?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function nn(N){return N.h?!0:N.g?N.g.size>=N.j:!1}function zt(N){return N.h?1:N.g?N.g.size:0}function gn(N,ce){return N.h?N.h==ce:N.g?N.g.has(ce):!1}function Jn(N,ce){N.g?N.g.add(ce):N.h=ce}function Qn(N,ce){N.h&&N.h==ce?N.h=null:N.g&&N.g.has(ce)&&N.g.delete(ce)}An.prototype.cancel=function(){if(this.i=pn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const N of this.g.values())N.cancel();this.g.clear()}};function pn(N){if(N.h!=null)return N.i.concat(N.h.D);if(N.g!=null&&N.g.size!==0){let ce=N.i;for(const we of N.g.values())ce=ce.concat(we.D);return ce}return g(N.i)}function Ln(N){if(N.V&&typeof N.V=="function")return N.V();if(typeof Map<"u"&&N instanceof Map||typeof Set<"u"&&N instanceof Set)return Array.from(N.values());if(typeof N=="string")return N.split("");if(l(N)){for(var ce=[],we=N.length,Pe=0;Pe<we;Pe++)ce.push(N[Pe]);return ce}ce=[],we=0;for(Pe in N)ce[we++]=N[Pe];return ce}function Dn(N){if(N.na&&typeof N.na=="function")return N.na();if(!N.V||typeof N.V!="function"){if(typeof Map<"u"&&N instanceof Map)return Array.from(N.keys());if(!(typeof Set<"u"&&N instanceof Set)){if(l(N)||typeof N=="string"){var ce=[];N=N.length;for(var we=0;we<N;we++)ce.push(we);return ce}ce=[],we=0;for(const Pe in N)ce[we++]=Pe;return ce}}}function ei(N,ce){if(N.forEach&&typeof N.forEach=="function")N.forEach(ce,void 0);else if(l(N)||typeof N=="string")Array.prototype.forEach.call(N,ce,void 0);else for(var we=Dn(N),Pe=Ln(N),Nt=Pe.length,tn=0;tn<Nt;tn++)ce.call(void 0,Pe[tn],we&&we[tn],N)}var xi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Yi(N,ce){if(N){N=N.split("&");for(var we=0;we<N.length;we++){var Pe=N[we].indexOf("="),Nt=null;if(0<=Pe){var tn=N[we].substring(0,Pe);Nt=N[we].substring(Pe+1)}else tn=N[we];ce(tn,Nt?decodeURIComponent(Nt.replace(/\+/g," ")):"")}}}function Bn(N){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,N instanceof Bn){this.h=N.h,xt(this,N.j),this.o=N.o,this.g=N.g,Bt(this,N.s),this.l=N.l;var ce=N.i,we=new Mn;we.i=ce.i,ce.g&&(we.g=new Map(ce.g),we.h=ce.h),on(this,we),this.m=N.m}else N&&(ce=String(N).match(xi))?(this.h=!1,xt(this,ce[1]||"",!0),this.o=hi(ce[2]||""),this.g=hi(ce[3]||"",!0),Bt(this,ce[4]),this.l=hi(ce[5]||"",!0),on(this,ce[6]||"",!0),this.m=hi(ce[7]||"")):(this.h=!1,this.i=new Mn(null,this.h))}Bn.prototype.toString=function(){var N=[],ce=this.j;ce&&N.push(Ii(ce,zr,!0),":");var we=this.g;return(we||ce=="file")&&(N.push("//"),(ce=this.o)&&N.push(Ii(ce,zr,!0),"@"),N.push(encodeURIComponent(String(we)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),we=this.s,we!=null&&N.push(":",String(we))),(we=this.l)&&(this.g&&we.charAt(0)!="/"&&N.push("/"),N.push(Ii(we,we.charAt(0)=="/"?io:Us,!0))),(we=this.i.toString())&&N.push("?",we),(we=this.m)&&N.push("#",Ii(we,Ts)),N.join("")};function Ri(N){return new Bn(N)}function xt(N,ce,we){N.j=we?hi(ce,!0):ce,N.j&&(N.j=N.j.replace(/:$/,""))}function Bt(N,ce){if(ce){if(ce=Number(ce),isNaN(ce)||0>ce)throw Error("Bad port number "+ce);N.s=ce}else N.s=null}function on(N,ce,we){ce instanceof Mn?(N.i=ce,Pt(N.i,N.h)):(we||(ce=Ii(ce,ws)),N.i=new Mn(ce,N.h))}function ln(N,ce,we){N.i.set(ce,we)}function li(N){return ln(N,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),N}function hi(N,ce){return N?ce?decodeURI(N.replace(/%25/g,"%2525")):decodeURIComponent(N):""}function Ii(N,ce,we){return typeof N=="string"?(N=encodeURI(N).replace(ce,kr),we&&(N=N.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),N):null}function kr(N){return N=N.charCodeAt(0),"%"+(N>>4&15).toString(16)+(N&15).toString(16)}var zr=/[#\/\?@]/g,Us=/[#\?:]/g,io=/[#\?]/g,ws=/[#\?@]/g,Ts=/#/g;function Mn(N,ce){this.h=this.g=null,this.i=N||null,this.j=!!ce}function ve(N){N.g||(N.g=new Map,N.h=0,N.i&&Yi(N.i,function(ce,we){N.add(decodeURIComponent(ce.replace(/\+/g," ")),we)}))}n=Mn.prototype,n.add=function(N,ce){ve(this),this.i=null,N=pt(this,N);var we=this.g.get(N);return we||this.g.set(N,we=[]),we.push(ce),this.h+=1,this};function Re(N,ce){ve(N),ce=pt(N,ce),N.g.has(ce)&&(N.i=null,N.h-=N.g.get(ce).length,N.g.delete(ce))}function Ke(N,ce){return ve(N),ce=pt(N,ce),N.g.has(ce)}n.forEach=function(N,ce){ve(this),this.g.forEach(function(we,Pe){we.forEach(function(Nt){N.call(ce,Nt,Pe,this)},this)},this)},n.na=function(){ve(this);const N=Array.from(this.g.values()),ce=Array.from(this.g.keys()),we=[];for(let Pe=0;Pe<ce.length;Pe++){const Nt=N[Pe];for(let tn=0;tn<Nt.length;tn++)we.push(ce[Pe])}return we},n.V=function(N){ve(this);let ce=[];if(typeof N=="string")Ke(this,N)&&(ce=ce.concat(this.g.get(pt(this,N))));else{N=Array.from(this.g.values());for(let we=0;we<N.length;we++)ce=ce.concat(N[we])}return ce},n.set=function(N,ce){return ve(this),this.i=null,N=pt(this,N),Ke(this,N)&&(this.h-=this.g.get(N).length),this.g.set(N,[ce]),this.h+=1,this},n.get=function(N,ce){return N?(N=this.V(N),0<N.length?String(N[0]):ce):ce};function Ge(N,ce,we){Re(N,ce),0<we.length&&(N.i=null,N.g.set(pt(N,ce),g(we)),N.h+=we.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const N=[],ce=Array.from(this.g.keys());for(var we=0;we<ce.length;we++){var Pe=ce[we];const tn=encodeURIComponent(String(Pe)),Un=this.V(Pe);for(Pe=0;Pe<Un.length;Pe++){var Nt=tn;Un[Pe]!==""&&(Nt+="="+encodeURIComponent(String(Un[Pe]))),N.push(Nt)}}return this.i=N.join("&")};function pt(N,ce){return ce=String(ce),N.j&&(ce=ce.toLowerCase()),ce}function Pt(N,ce){ce&&!N.j&&(ve(N),N.i=null,N.g.forEach(function(we,Pe){var Nt=Pe.toLowerCase();Pe!=Nt&&(Re(this,Pe),Ge(this,Nt,we))},N)),N.j=ce}function pe(N,ce){const we=new Vt;if(a.Image){const Pe=new Image;Pe.onload=f(at,we,"TestLoadImage: loaded",!0,ce,Pe),Pe.onerror=f(at,we,"TestLoadImage: error",!1,ce,Pe),Pe.onabort=f(at,we,"TestLoadImage: abort",!1,ce,Pe),Pe.ontimeout=f(at,we,"TestLoadImage: timeout",!1,ce,Pe),a.setTimeout(function(){Pe.ontimeout&&Pe.ontimeout()},1e4),Pe.src=N}else ce(!1)}function xe(N,ce){const we=new Vt,Pe=new AbortController,Nt=setTimeout(()=>{Pe.abort(),at(we,"TestPingServer: timeout",!1,ce)},1e4);fetch(N,{signal:Pe.signal}).then(tn=>{clearTimeout(Nt),tn.ok?at(we,"TestPingServer: ok",!0,ce):at(we,"TestPingServer: server error",!1,ce)}).catch(()=>{clearTimeout(Nt),at(we,"TestPingServer: error",!1,ce)})}function at(N,ce,we,Pe,Nt){try{Nt&&(Nt.onload=null,Nt.onerror=null,Nt.onabort=null,Nt.ontimeout=null),Pe(we)}catch{}}function dt(){this.g=new Ee}function Qt(N,ce,we){const Pe=we||"";try{ei(N,function(Nt,tn){let Un=Nt;h(Nt)&&(Un=rt(Nt)),ce.push(Pe+tn+"="+encodeURIComponent(Un))})}catch(Nt){throw ce.push(Pe+"type="+encodeURIComponent("_badmap")),Nt}}function wn(N){this.l=N.Ub||null,this.j=N.eb||!1}p(wn,Le),wn.prototype.g=function(){return new gt(this.l,this.j)},wn.prototype.i=(function(N){return function(){return N}})({});function gt(N,ce){qe.call(this),this.D=N,this.o=ce,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}p(gt,qe),n=gt.prototype,n.open=function(N,ce){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=N,this.A=ce,this.readyState=1,ht(this)},n.send=function(N){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const ce={headers:this.u,method:this.B,credentials:this.m,cache:void 0};N&&(ce.body=N),(this.D||a).fetch(new Request(this.A,ce)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Yn(this)),this.readyState=0},n.Sa=function(N){if(this.g&&(this.l=N,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=N.headers,this.readyState=2,ht(this)),this.g&&(this.readyState=3,ht(this),this.g)))if(this.responseType==="arraybuffer")N.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in N){if(this.j=N.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Vn(this)}else N.text().then(this.Ra.bind(this),this.ga.bind(this))};function Vn(N){N.j.read().then(N.Pa.bind(N)).catch(N.ga.bind(N))}n.Pa=function(N){if(this.g){if(this.o&&N.value)this.response.push(N.value);else if(!this.o){var ce=N.value?N.value:new Uint8Array(0);(ce=this.v.decode(ce,{stream:!N.done}))&&(this.response=this.responseText+=ce)}N.done?Yn(this):ht(this),this.readyState==3&&Vn(this)}},n.Ra=function(N){this.g&&(this.response=this.responseText=N,Yn(this))},n.Qa=function(N){this.g&&(this.response=N,Yn(this))},n.ga=function(){this.g&&Yn(this)};function Yn(N){N.readyState=4,N.l=null,N.j=null,N.v=null,ht(N)}n.setRequestHeader=function(N,ce){this.u.append(N,ce)},n.getResponseHeader=function(N){return this.h&&this.h.get(N.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const N=[],ce=this.h.entries();for(var we=ce.next();!we.done;)we=we.value,N.push(we[0]+": "+we[1]),we=ce.next();return N.join(`\r
`)};function ht(N){N.onreadystatechange&&N.onreadystatechange.call(N)}Object.defineProperty(gt.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(N){this.m=N?"include":"same-origin"}});function Ot(N){let ce="";return I(N,function(we,Pe){ce+=Pe,ce+=":",ce+=we,ce+=`\r
`}),ce}function In(N,ce,we){e:{for(Pe in we){var Pe=!1;break e}Pe=!0}Pe||(we=Ot(we),typeof N=="string"?we!=null&&encodeURIComponent(String(we)):ln(N,ce,we))}function Wn(N){qe.call(this),this.headers=new Map,this.o=N||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}p(Wn,qe);var xn=/^https?$/i,Gn=["POST","PUT"];n=Wn.prototype,n.Ha=function(N){this.J=N},n.ea=function(N,ce,we,Pe){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+N);ce=ce?ce.toUpperCase():"GET",this.D=N,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Zn.g(),this.v=this.o?ye(this.o):ye(Zn),this.g.onreadystatechange=A(this.Ea,this);try{this.B=!0,this.g.open(ce,String(N),!0),this.B=!1}catch(tn){fi(this,tn);return}if(N=we||"",we=new Map(this.headers),Pe)if(Object.getPrototypeOf(Pe)===Object.prototype)for(var Nt in Pe)we.set(Nt,Pe[Nt]);else if(typeof Pe.keys=="function"&&typeof Pe.get=="function")for(const tn of Pe.keys())we.set(tn,Pe.get(tn));else throw Error("Unknown input type for opt_headers: "+String(Pe));Pe=Array.from(we.keys()).find(tn=>tn.toLowerCase()=="content-type"),Nt=a.FormData&&N instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Gn,ce,void 0))||Pe||Nt||we.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[tn,Un]of we)this.g.setRequestHeader(tn,Un);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Qi(this),this.u=!0,this.g.send(N),this.u=!1}catch(tn){fi(this,tn)}};function fi(N,ce){N.h=!1,N.g&&(N.j=!0,N.g.abort(),N.j=!1),N.l=ce,N.m=5,Ki(N),Ci(N)}function Ki(N){N.A||(N.A=!0,Je(N,"complete"),Je(N,"error"))}n.abort=function(N){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=N||7,Je(this,"complete"),Je(this,"abort"),Ci(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ci(this,!0)),Wn.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Ji(this):this.bb())},n.bb=function(){Ji(this)};function Ji(N){if(N.h&&typeof o<"u"&&(!N.v[1]||zi(N)!=4||N.Z()!=2)){if(N.u&&zi(N)==4)et(N.Ea,0,N);else if(Je(N,"readystatechange"),zi(N)==4){N.h=!1;try{const Un=N.Z();e:switch(Un){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var ce=!0;break e;default:ce=!1}var we;if(!(we=ce)){var Pe;if(Pe=Un===0){var Nt=String(N.D).match(xi)[1]||null;!Nt&&a.self&&a.self.location&&(Nt=a.self.location.protocol.slice(0,-1)),Pe=!xn.test(Nt?Nt.toLowerCase():"")}we=Pe}if(we)Je(N,"complete"),Je(N,"success");else{N.m=6;try{var tn=2<zi(N)?N.g.statusText:""}catch{tn=""}N.l=tn+" ["+N.Z()+"]",Ki(N)}}finally{Ci(N)}}}}function Ci(N,ce){if(N.g){Qi(N);const we=N.g,Pe=N.v[0]?()=>{}:null;N.g=null,N.v=null,ce||Je(N,"ready");try{we.onreadystatechange=Pe}catch{}}}function Qi(N){N.I&&(a.clearTimeout(N.I),N.I=null)}n.isActive=function(){return!!this.g};function zi(N){return N.g?N.g.readyState:0}n.Z=function(){try{return 2<zi(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(N){if(this.g){var ce=this.g.responseText;return N&&ce.indexOf(N)==0&&(ce=ce.substring(N.length)),_t(ce)}};function Ir(N){try{if(!N.g)return null;if("response"in N.g)return N.g.response;switch(N.H){case"":case"text":return N.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in N.g)return N.g.mozResponseArrayBuffer}return null}catch{return null}}function Hr(N){const ce={};N=(N.g&&2<=zi(N)&&N.g.getAllResponseHeaders()||"").split(`\r
`);for(let Pe=0;Pe<N.length;Pe++){if(m(N[Pe]))continue;var we=T(N[Pe]);const Nt=we[0];if(we=we[1],typeof we!="string")continue;we=we.trim();const tn=ce[Nt]||[];ce[Nt]=tn,tn.push(we)}j(ce,function(Pe){return Pe.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Si(N,ce,we){return we&&we.internalChannelParams&&we.internalChannelParams[N]||ce}function re(N){this.Aa=0,this.i=[],this.j=new Vt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Si("failFast",!1,N),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Si("baseRetryDelayMs",5e3,N),this.cb=Si("retryDelaySeedMs",1e4,N),this.Wa=Si("forwardChannelMaxRetries",2,N),this.wa=Si("forwardChannelRequestTimeoutMs",2e4,N),this.pa=N&&N.xmlHttpFactory||void 0,this.Xa=N&&N.Tb||void 0,this.Ca=N&&N.useFetchStreams||!1,this.L=void 0,this.J=N&&N.supportsCrossDomainXhr||!1,this.K="",this.h=new An(N&&N.concurrentRequestLimit),this.Da=new dt,this.P=N&&N.fastHandshake||!1,this.O=N&&N.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=N&&N.Rb||!1,N&&N.xa&&this.j.xa(),N&&N.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&N&&N.detectBufferingProxy||!1,this.ja=void 0,N&&N.longPollingTimeout&&0<N.longPollingTimeout&&(this.ja=N.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=re.prototype,n.la=8,n.G=1,n.connect=function(N,ce,we,Pe){Ye(0),this.W=N,this.H=ce||{},we&&Pe!==void 0&&(this.H.OSID=we,this.H.OAID=Pe),this.F=this.X,this.I=Qr(this,null,this.W),yt(this)};function be(N){if(ut(N),N.G==3){var ce=N.U++,we=Ri(N.I);if(ln(we,"SID",N.K),ln(we,"RID",ce),ln(we,"TYPE","terminate"),Tn(N,we),ce=new ti(N,N.j,ce),ce.L=2,ce.v=li(Ri(we)),we=!1,a.navigator&&a.navigator.sendBeacon)try{we=a.navigator.sendBeacon(ce.v.toString(),"")}catch{}!we&&a.Image&&(new Image().src=ce.v,we=!0),we||(ce.g=or(ce.j,null),ce.g.ea(ce.v)),ce.F=Date.now(),xr(ce)}cs(N)}function Ue(N){N.g&&(Rn(N),N.g.cancel(),N.g=null)}function ut(N){Ue(N),N.u&&(a.clearTimeout(N.u),N.u=null),dr(N),N.h.cancel(),N.s&&(typeof N.s=="number"&&a.clearTimeout(N.s),N.s=null)}function yt(N){if(!nn(N.h)&&!N.s){N.s=!0;var ce=N.Ga;L||$(),O||(L(),O=!0),J.add(ce,N),N.B=0}}function en(N,ce){return zt(N.h)>=N.h.j-(N.s?1:0)?!1:N.s?(N.i=ce.D.concat(N.i),!0):N.G==1||N.G==2||N.B>=(N.Va?0:N.Wa)?!1:(N.s=Wt(A(N.Ga,N,ce),vs(N,N.B)),N.B++,!0)}n.Ga=function(N){if(this.s)if(this.s=null,this.G==1){if(!N){this.U=Math.floor(1e5*Math.random()),N=this.U++;const Nt=new ti(this,this.j,N);let tn=this.o;if(this.S&&(tn?(tn=C(tn),D(tn,this.S)):tn=this.S),this.m!==null||this.O||(Nt.H=tn,tn=null),this.P)e:{for(var ce=0,we=0;we<this.i.length;we++){t:{var Pe=this.i[we];if("__data__"in Pe.map&&(Pe=Pe.map.__data__,typeof Pe=="string")){Pe=Pe.length;break t}Pe=void 0}if(Pe===void 0)break;if(ce+=Pe,4096<ce){ce=we;break e}if(ce===4096||we===this.i.length-1){ce=we+1;break e}}ce=1e3}else ce=1e3;ce=$n(this,Nt,ce),we=Ri(this.I),ln(we,"RID",N),ln(we,"CVER",22),this.D&&ln(we,"X-HTTP-Session-Id",this.D),Tn(this,we),tn&&(this.O?ce="headers="+encodeURIComponent(String(Ot(tn)))+"&"+ce:this.m&&In(we,this.m,tn)),Jn(this.h,Nt),this.Ua&&ln(we,"TYPE","init"),this.P?(ln(we,"$req",ce),ln(we,"SID","null"),Nt.T=!0,ui(Nt,we,null)):ui(Nt,we,ce),this.G=2}}else this.G==3&&(N?cn(this,N):this.i.length==0||nn(this.h)||cn(this))};function cn(N,ce){var we;ce?we=ce.l:we=N.U++;const Pe=Ri(N.I);ln(Pe,"SID",N.K),ln(Pe,"RID",we),ln(Pe,"AID",N.T),Tn(N,Pe),N.m&&N.o&&In(Pe,N.m,N.o),we=new ti(N,N.j,we,N.B+1),N.m===null&&(we.H=N.o),ce&&(N.i=ce.D.concat(N.i)),ce=$n(N,we,1e3),we.I=Math.round(.5*N.wa)+Math.round(.5*N.wa*Math.random()),Jn(N.h,we),ui(we,Pe,ce)}function Tn(N,ce){N.H&&I(N.H,function(we,Pe){ln(ce,Pe,we)}),N.l&&ei({},function(we,Pe){ln(ce,Pe,we)})}function $n(N,ce,we){we=Math.min(N.i.length,we);var Pe=N.l?A(N.l.Na,N.l,N):null;e:{var Nt=N.i;let tn=-1;for(;;){const Un=["count="+we];tn==-1?0<we?(tn=Nt[0].g,Un.push("ofs="+tn)):tn=0:Un.push("ofs="+tn);let is=!0;for(let ro=0;ro<we;ro++){let $r=Nt[ro].g;const rs=Nt[ro].map;if($r-=tn,0>$r)tn=Math.max(0,Nt[ro].g-100),is=!1;else try{Qt(rs,Un,"req"+$r+"_")}catch{Pe&&Pe(rs)}}if(is){Pe=Un.join("&");break e}}}return N=N.i.splice(0,we),ce.D=N,Pe}function ai(N){if(!N.g&&!N.u){N.Y=1;var ce=N.Fa;L||$(),O||(L(),O=!0),J.add(ce,N),N.v=0}}function ni(N){return N.g||N.u||3<=N.v?!1:(N.Y++,N.u=Wt(A(N.Fa,N),vs(N,N.v)),N.v++,!0)}n.Fa=function(){if(this.u=null,sr(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var N=2*this.R;this.j.info("BP detection timer enabled: "+N),this.A=Wt(A(this.ab,this),N)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ye(10),Ue(this),sr(this))};function Rn(N){N.A!=null&&(a.clearTimeout(N.A),N.A=null)}function sr(N){N.g=new ti(N,N.j,"rpc",N.Y),N.m===null&&(N.g.H=N.o),N.g.O=0;var ce=Ri(N.qa);ln(ce,"RID","rpc"),ln(ce,"SID",N.K),ln(ce,"AID",N.T),ln(ce,"CI",N.F?"0":"1"),!N.F&&N.ja&&ln(ce,"TO",N.ja),ln(ce,"TYPE","xmlhttp"),Tn(N,ce),N.m&&N.o&&In(ce,N.m,N.o),N.L&&(N.g.I=N.L);var we=N.g;N=N.ia,we.L=1,we.v=li(Ri(ce)),we.m=null,we.P=!0,si(we,N)}n.Za=function(){this.C!=null&&(this.C=null,Ue(this),ni(this),Ye(19))};function dr(N){N.C!=null&&(a.clearTimeout(N.C),N.C=null)}function qr(N,ce){var we=null;if(N.g==ce){dr(N),Rn(N),N.g=null;var Pe=2}else if(gn(N.h,ce))we=ce.D,Qn(N.h,ce),Pe=1;else return;if(N.G!=0){if(ce.o)if(Pe==1){we=ce.m?ce.m.length:0,ce=Date.now()-ce.F;var Nt=N.B;Pe=Yt(),Je(Pe,new Gt(Pe,we)),yt(N)}else ai(N);else if(Nt=ce.s,Nt==3||Nt==0&&0<ce.X||!(Pe==1&&en(N,ce)||Pe==2&&ni(N)))switch(we&&0<we.length&&(ce=N.h,ce.i=ce.i.concat(we)),Nt){case 1:Cr(N,5);break;case 4:Cr(N,10);break;case 3:Cr(N,6);break;default:Cr(N,2)}}}function vs(N,ce){let we=N.Ta+Math.floor(Math.random()*N.cb);return N.isActive()||(we*=2),we*ce}function Cr(N,ce){if(N.j.info("Error code "+ce),ce==2){var we=A(N.fb,N),Pe=N.Xa;const Nt=!Pe;Pe=new Bn(Pe||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||xt(Pe,"https"),li(Pe),Nt?pe(Pe.toString(),we):xe(Pe.toString(),we)}else Ye(2);N.G=0,N.l&&N.l.sa(ce),cs(N),ut(N)}n.fb=function(N){N?(this.j.info("Successfully pinged google.com"),Ye(2)):(this.j.info("Failed to ping google.com"),Ye(1))};function cs(N){if(N.G=0,N.ka=[],N.l){const ce=pn(N.h);(ce.length!=0||N.i.length!=0)&&(v(N.ka,ce),v(N.ka,N.i),N.h.i.length=0,g(N.i),N.i.length=0),N.l.ra()}}function Qr(N,ce,we){var Pe=we instanceof Bn?Ri(we):new Bn(we);if(Pe.g!="")ce&&(Pe.g=ce+"."+Pe.g),Bt(Pe,Pe.s);else{var Nt=a.location;Pe=Nt.protocol,ce=ce?ce+"."+Nt.hostname:Nt.hostname,Nt=+Nt.port;var tn=new Bn(null);Pe&&xt(tn,Pe),ce&&(tn.g=ce),Nt&&Bt(tn,Nt),we&&(tn.l=we),Pe=tn}return we=N.D,ce=N.ya,we&&ce&&ln(Pe,we,ce),ln(Pe,"VER",N.la),Tn(N,Pe),Pe}function or(N,ce,we){if(ce&&!N.J)throw Error("Can't create secondary domain capable XhrIo object.");return ce=N.Ca&&!N.pa?new Wn(new wn({eb:we})):new Wn(N.pa),ce.Ha(N.J),ce}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function hs(){}n=hs.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function us(){}us.prototype.g=function(N,ce){return new Oo(N,ce)};function Oo(N,ce){qe.call(this),this.g=new re(ce),this.l=N,this.h=ce&&ce.messageUrlParams||null,N=ce&&ce.messageHeaders||null,ce&&ce.clientProtocolHeaderRequired&&(N?N["X-Client-Protocol"]="webchannel":N={"X-Client-Protocol":"webchannel"}),this.g.o=N,N=ce&&ce.initMessageHeaders||null,ce&&ce.messageContentType&&(N?N["X-WebChannel-Content-Type"]=ce.messageContentType:N={"X-WebChannel-Content-Type":ce.messageContentType}),ce&&ce.va&&(N?N["X-WebChannel-Client-Profile"]=ce.va:N={"X-WebChannel-Client-Profile":ce.va}),this.g.S=N,(N=ce&&ce.Sb)&&!m(N)&&(this.g.m=N),this.v=ce&&ce.supportsCrossDomainXhr||!1,this.u=ce&&ce.sendRawJson||!1,(ce=ce&&ce.httpSessionIdParam)&&!m(ce)&&(this.g.D=ce,N=this.h,N!==null&&ce in N&&(N=this.h,ce in N&&delete N[ce])),this.j=new xa(this)}p(Oo,qe),Oo.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Oo.prototype.close=function(){be(this.g)},Oo.prototype.o=function(N){var ce=this.g;if(typeof N=="string"){var we={};we.__data__=N,N=we}else this.u&&(we={},we.__data__=rt(N),N=we);ce.i.push(new mt(ce.Ya++,N)),ce.G==3&&yt(ce)},Oo.prototype.N=function(){this.g.l=null,delete this.j,be(this.g),delete this.g,Oo.aa.N.call(this)};function va(N){st.call(this),N.__headers__&&(this.headers=N.__headers__,this.statusCode=N.__status__,delete N.__headers__,delete N.__status__);var ce=N.__sm__;if(ce){e:{for(const we in ce){N=we;break e}N=void 0}(this.i=N)&&(N=this.i,ce=ce!==null&&N in ce?ce[N]:void 0),this.data=ce}else this.data=N}p(va,st);function Lh(){At.call(this),this.status=1}p(Lh,At);function xa(N){this.g=N}p(xa,hs),xa.prototype.ua=function(){Je(this.g,"a")},xa.prototype.ta=function(N){Je(this.g,new va(N))},xa.prototype.sa=function(N){Je(this.g,new Lh)},xa.prototype.ra=function(){Je(this.g,"b")},us.prototype.createWebChannel=us.prototype.g,Oo.prototype.send=Oo.prototype.o,Oo.prototype.open=Oo.prototype.m,Oo.prototype.close=Oo.prototype.close,gH=function(){return new us},pH=function(){return Yt()},fH=ft,TB={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},jt.NO_ERROR=0,jt.TIMEOUT=8,jt.HTTP_ERROR=6,Kb=jt,fn.COMPLETE="complete",AH=fn,Ze.EventType=nt,nt.OPEN="a",nt.CLOSE="b",nt.ERROR="c",nt.MESSAGE="d",qe.prototype.listen=qe.prototype.K,dy=Ze,Wn.prototype.listenOnce=Wn.prototype.L,Wn.prototype.getLastError=Wn.prototype.Ka,Wn.prototype.getLastErrorCode=Wn.prototype.Ba,Wn.prototype.getStatus=Wn.prototype.Z,Wn.prototype.getResponseJson=Wn.prototype.Oa,Wn.prototype.getResponseText=Wn.prototype.oa,Wn.prototype.send=Wn.prototype.ea,Wn.prototype.setWithCredentials=Wn.prototype.Ha,dH=Wn}).apply(typeof ex<"u"?ex:typeof self<"u"?self:typeof window<"u"?window:{});const uD="@firebase/firestore",dD="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uc=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Uc.UNAUTHENTICATED=new Uc(null),Uc.GOOGLE_CREDENTIALS=new Uc("google-credentials-uid"),Uc.FIRST_PARTY=new Uc("first-party-uid"),Uc.MOCK_USER=new Uc("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let v1="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t0=new rF("@firebase/firestore");function om(){return t0.logLevel}function Pi(n,...e){if(t0.logLevel<=Is.DEBUG){const t=e.map(yF);t0.debug(`Firestore (${v1}): ${n}`,...t)}}function wf(n,...e){if(t0.logLevel<=Is.ERROR){const t=e.map(yF);t0.error(`Firestore (${v1}): ${n}`,...t)}}function vf(n,...e){if(t0.logLevel<=Is.WARN){const t=e.map(yF);t0.warn(`Firestore (${v1}): ${n}`,...t)}}function yF(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gr(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,mH(n,i,t)}function mH(n,e,t){let i=`FIRESTORE (${v1}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw wf(i),new Error(i)}function $s(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||mH(e,r,i)}function Or(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _n={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class vi extends Ed{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cA{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yH{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class wH{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Uc.UNAUTHENTICATED)))}shutdown(){}}class Ote{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Hte{constructor(e){this.t=e,this.currentUser=Uc.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){$s(this.o===void 0,42304);let i=this.i;const r=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve();let s=new cA;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new cA,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const l=s;e.enqueueRetryable((async()=>{await l.promise,await r(this.currentUser)}))},a=l=>{Pi("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((l=>a(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(Pi("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new cA)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(Pi("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?($s(typeof i.accessToken=="string",31837,{l:i}),new yH(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return $s(e===null||typeof e=="string",2055,{h:e}),new Uc(e)}}class Wte{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Uc.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class zte{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new Wte(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Uc.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class AD{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Qte{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ah(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){$s(this.o===void 0,3512);const i=s=>{s.error!=null&&Pi("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,Pi("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>i(s)))};const r=s=>{Pi("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>r(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):Pi("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new AD(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?($s(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new AD(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $te(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vH(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u5{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=$te(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%62))}return i}}function ps(n,e){return n<e?-1:n>e?1:0}function BB(n,e){let t=0;for(;t<n.length&&t<e.length;){const i=n.codePointAt(t),r=e.codePointAt(t);if(i!==r){if(i<128&&r<128)return ps(i,r);{const s=vH(),o=Vte(s.encode(fD(n,t)),s.encode(fD(e,t)));return o!==0?o:ps(i,r)}}t+=i>65535?2:1}return ps(n.length,e.length)}function fD(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function Vte(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return ps(n[t],e[t]);return ps(n.length,e.length)}function e1(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pD="__name__";class Yd{constructor(e,t,i){t===void 0?t=0:t>e.length&&gr(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&gr(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Yd.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Yd?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=Yd.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return ps(e.length,t.length)}static compareSegments(e,t){const i=Yd.isNumericId(e),r=Yd.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?Yd.extractNumericId(e).compare(Yd.extractNumericId(t)):BB(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Tp.fromString(e.substring(4,e.length-2))}}class mo extends Yd{construct(e,t,i){return new mo(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new vi(_n.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new mo(t)}static emptyPath(){return new mo([])}}const Gte=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Kl extends Yd{construct(e,t,i){return new Kl(e,t,i)}static isValidIdentifier(e){return Gte.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Kl.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===pD}static keyField(){return new Kl([pD])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(i.length===0)throw new vi(_n.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new vi(_n.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new vi(_n.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=l,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(i+=a,r++):(s(),r++)}if(s(),o)throw new vi(_n.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Kl(t)}static emptyPath(){return new Kl([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{constructor(e){this.path=e}static fromPath(e){return new lr(mo.fromString(e))}static fromName(e){return new lr(mo.fromString(e).popFirst(5))}static empty(){return new lr(mo.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&mo.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return mo.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new lr(new mo(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wF(n,e,t){if(!t)throw new vi(_n.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function xH(n,e,t,i){if(e===!0&&i===!0)throw new vi(_n.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function gD(n){if(!lr.isDocumentKey(n))throw new vi(_n.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function mD(n){if(lr.isDocumentKey(n))throw new vi(_n.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function bH(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function d5(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":gr(12329,{type:typeof n})}function cl(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new vi(_n.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=d5(n);throw new vi(_n.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vl(n,e){const t={typeString:n};return e&&(t.value=e),t}function ov(n,e){if(!bH(n))throw new vi(_n.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,s="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const o=n[i];if(r&&typeof o!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${i}' field to equal '${s.value}'`;break}}if(t)throw new vi(_n.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yD=-62135596800,wD=1e6;class yo{static now(){return yo.fromMillis(Date.now())}static fromDate(e){return yo.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*wD);return new yo(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new vi(_n.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new vi(_n.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<yD)throw new vi(_n.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new vi(_n.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/wD}_compareTo(e){return this.seconds===e.seconds?ps(this.nanoseconds,e.nanoseconds):ps(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:yo._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ov(e,yo._jsonSchema))return new yo(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-yD;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}yo._jsonSchemaVersion="firestore/timestamp/1.0",yo._jsonSchema={type:vl("string",yo._jsonSchemaVersion),seconds:vl("number"),nanoseconds:vl("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{static fromTimestamp(e){return new _r(e)}static min(){return new _r(new yo(0,0))}static max(){return new _r(new yo(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vw=-1;function Xte(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=_r.fromTimestamp(i===1e9?new yo(t+1,0):new yo(t,i));return new jp(r,lr.empty(),e)}function Yte(n){return new jp(n.readTime,n.key,vw)}class jp{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new jp(_r.min(),lr.empty(),vw)}static max(){return new jp(_r.max(),lr.empty(),vw)}}function Kte(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=lr.comparator(n.documentKey,e.documentKey),t!==0?t:ps(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qte="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Zte{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x1(n){if(n.code!==_n.FAILED_PRECONDITION||n.message!==qte)throw n;Pi("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&gr(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Pn(((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Pn?t:Pn.resolve(t)}catch(t){return Pn.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Pn.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Pn.reject(t)}static resolve(e){return new Pn(((t,i)=>{t(e)}))}static reject(e){return new Pn(((t,i)=>{i(e)}))}static waitFor(e){return new Pn(((t,i)=>{let r=0,s=0,o=!1;e.forEach((a=>{++r,a.next((()=>{++s,o&&s===r&&t()}),(l=>i(l)))})),o=!0,s===r&&t()}))}static or(e){let t=Pn.resolve(!1);for(const i of e)t=t.next((r=>r?Pn.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,s)=>{i.push(t.call(this,r,s))})),this.waitFor(i)}static mapArray(e,t){return new Pn(((i,r)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const h=l;t(e[h]).next((u=>{o[h]=u,++a,a===s&&i(o)}),(u=>r(u)))}}))}static doWhile(e,t){return new Pn(((i,r)=>{const s=()=>{e()===!0?t().next((()=>{s()}),r):i()};s()}))}}function Jte(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function b1(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A5{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this._e(i),this.ae=i=>t.writeSequenceNumber(i))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}A5.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vF=-1;function av(n){return n==null}function IC(n){return n===0&&1/n==-1/0}function ene(n){return typeof n=="number"&&Number.isInteger(n)&&!IC(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CH="";function tne(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=vD(e)),e=nne(n.get(t),e);return vD(e)}function nne(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="";break;case CH:t+="";break;default:t+=s}}return t}function vD(n){return n+CH+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xD(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Yp(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function _H(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(e,t){this.comparator=e,this.root=t||gc.EMPTY}insert(e,t){return new wa(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,gc.BLACK,null,null))}remove(e){return new wa(this.comparator,this.root.remove(e,this.comparator).copy(null,null,gc.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new tx(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new tx(this.root,e,this.comparator,!1)}getReverseIterator(){return new tx(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new tx(this.root,e,this.comparator,!0)}}class tx{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class gc{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??gc.RED,this.left=r??gc.EMPTY,this.right=s??gc.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new gc(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return gc.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return gc.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,gc.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,gc.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw gr(43730,{key:this.key,value:this.value});if(this.right.isRed())throw gr(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw gr(27949);return e+(this.isRed()?0:1)}}gc.EMPTY=null,gc.RED=!0,gc.BLACK=!1;gc.EMPTY=new class{constructor(){this.size=0}get key(){throw gr(57766)}get value(){throw gr(16141)}get color(){throw gr(16727)}get left(){throw gr(29726)}get right(){throw gr(36894)}copy(e,t,i,r,s){return this}insert(e,t,i){return new gc(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(e){this.comparator=e,this.data=new wa(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new bD(this.data.getIterator())}getIteratorFrom(e){return new bD(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Dl)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Dl(this.comparator);return t.data=e,t}}class bD{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(e){this.fields=e,e.sort(Kl.comparator)}static empty(){return new Xh([])}unionWith(e){let t=new Dl(Kl.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Xh(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return e1(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SH extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jl{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new SH("Invalid base64 string: "+s):s}})(e);return new Jl(t)}static fromUint8Array(e){const t=(function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s})(e);return new Jl(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ps(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Jl.EMPTY_BYTE_STRING=new Jl("");const ine=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Pp(n){if($s(!!n,39018),typeof n=="string"){let e=0;const t=ine.exec(n);if($s(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:nl(n.seconds),nanos:nl(n.nanos)}}function nl(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Np(n){return typeof n=="string"?Jl.fromBase64String(n):Jl.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TH="server_timestamp",BH="__type__",EH="__previous_value__",FH="__local_write_time__";function xF(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[BH])===null||t===void 0?void 0:t.stringValue)===TH}function f5(n){const e=n.mapValue.fields[EH];return xF(e)?f5(e):e}function xw(n){const e=Pp(n.mapValue.fields[FH].timestampValue);return new yo(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rne{constructor(e,t,i,r,s,o,a,l,h,u){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=h,this.isUsingEmulator=u}}const DC="(default)";class t1{constructor(e,t){this.projectId=e,this.database=t||DC}static empty(){return new t1("","")}get isDefaultDatabase(){return this.database===DC}isEqual(e){return e instanceof t1&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kH="__type__",sne="__max__",nx={mapValue:{}},IH="__vector__",jC="value";function Lp(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?xF(n)?4:ane(n)?9007199254740991:one(n)?10:11:gr(28295,{value:n})}function gA(n,e){if(n===e)return!0;const t=Lp(n);if(t!==Lp(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return xw(n).isEqual(xw(e));case 3:return(function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=Pp(r.timestampValue),a=Pp(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,s){return Np(r.bytesValue).isEqual(Np(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,s){return nl(r.geoPointValue.latitude)===nl(s.geoPointValue.latitude)&&nl(r.geoPointValue.longitude)===nl(s.geoPointValue.longitude)})(n,e);case 2:return(function(r,s){if("integerValue"in r&&"integerValue"in s)return nl(r.integerValue)===nl(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=nl(r.doubleValue),a=nl(s.doubleValue);return o===a?IC(o)===IC(a):isNaN(o)&&isNaN(a)}return!1})(n,e);case 9:return e1(n.arrayValue.values||[],e.arrayValue.values||[],gA);case 10:case 11:return(function(r,s){const o=r.mapValue.fields||{},a=s.mapValue.fields||{};if(xD(o)!==xD(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!gA(o[l],a[l])))return!1;return!0})(n,e);default:return gr(52216,{left:n})}}function bw(n,e){return(n.values||[]).find((t=>gA(t,e)))!==void 0}function n1(n,e){if(n===e)return 0;const t=Lp(n),i=Lp(e);if(t!==i)return ps(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return ps(n.booleanValue,e.booleanValue);case 2:return(function(s,o){const a=nl(s.integerValue||s.doubleValue),l=nl(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1})(n,e);case 3:return CD(n.timestampValue,e.timestampValue);case 4:return CD(xw(n),xw(e));case 5:return BB(n.stringValue,e.stringValue);case 6:return(function(s,o){const a=Np(s),l=Np(o);return a.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){const a=s.split("/"),l=o.split("/");for(let h=0;h<a.length&&h<l.length;h++){const u=ps(a[h],l[h]);if(u!==0)return u}return ps(a.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){const a=ps(nl(s.latitude),nl(o.latitude));return a!==0?a:ps(nl(s.longitude),nl(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return _D(n.arrayValue,e.arrayValue);case 10:return(function(s,o){var a,l,h,u;const d=s.fields||{},A=o.fields||{},f=(a=d[jC])===null||a===void 0?void 0:a.arrayValue,p=(l=A[jC])===null||l===void 0?void 0:l.arrayValue,g=ps(((h=f==null?void 0:f.values)===null||h===void 0?void 0:h.length)||0,((u=p==null?void 0:p.values)===null||u===void 0?void 0:u.length)||0);return g!==0?g:_D(f,p)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===nx.mapValue&&o===nx.mapValue)return 0;if(s===nx.mapValue)return 1;if(o===nx.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),h=o.fields||{},u=Object.keys(h);l.sort(),u.sort();for(let d=0;d<l.length&&d<u.length;++d){const A=BB(l[d],u[d]);if(A!==0)return A;const f=n1(a[l[d]],h[u[d]]);if(f!==0)return f}return ps(l.length,u.length)})(n.mapValue,e.mapValue);default:throw gr(23264,{le:t})}}function CD(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ps(n,e);const t=Pp(n),i=Pp(e),r=ps(t.seconds,i.seconds);return r!==0?r:ps(t.nanos,i.nanos)}function _D(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const s=n1(t[r],i[r]);if(s)return s}return ps(t.length,i.length)}function i1(n){return EB(n)}function EB(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=Pp(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Np(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return lr.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const s of t.values||[])r?r=!1:i+=",",i+=EB(s);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${EB(t.fields[o])}`;return r+"}"})(n.mapValue):gr(61005,{value:n})}function qb(n){switch(Lp(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=f5(n);return e?16+qb(e):16;case 5:return 2*n.stringValue.length;case 6:return Np(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((r,s)=>r+qb(s)),0)})(n.arrayValue);case 10:case 11:return(function(i){let r=0;return Yp(i.fields,((s,o)=>{r+=s.length+qb(o)})),r})(n.mapValue);default:throw gr(13486,{value:n})}}function SD(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function FB(n){return!!n&&"integerValue"in n}function bF(n){return!!n&&"arrayValue"in n}function TD(n){return!!n&&"nullValue"in n}function BD(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Zb(n){return!!n&&"mapValue"in n}function one(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[kH])===null||t===void 0?void 0:t.stringValue)===IH}function Ly(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Yp(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=Ly(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ly(n.arrayValue.values[t]);return e}return Object.assign({},n)}function ane(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===sne}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh{constructor(e){this.value=e}static empty(){return new lh({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Zb(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ly(t)}setAll(e){let t=Kl.emptyPath(),i={},r=[];e.forEach(((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,i,r),i={},r=[],t=a.popLast()}o?i[a.lastSegment()]=Ly(o):r.push(a.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());Zb(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return gA(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];Zb(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Yp(t,((r,s)=>e[r]=s));for(const r of i)delete e[r]}clone(){return new lh(Ly(this.value))}}function DH(n){const e=[];return Yp(n.fields,((t,i)=>{const r=new Kl([t]);if(Zb(i)){const s=DH(i.mapValue).fields;if(s.length===0)e.push(r);else for(const o of s)e.push(r.child(o))}else e.push(r)})),new Xh(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yl{constructor(e,t,i,r,s,o,a){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Yl(e,0,_r.min(),_r.min(),_r.min(),lh.empty(),0)}static newFoundDocument(e,t,i,r){return new Yl(e,1,t,_r.min(),i,r,0)}static newNoDocument(e,t){return new Yl(e,2,t,_r.min(),_r.min(),lh.empty(),0)}static newUnknownDocument(e,t){return new Yl(e,3,t,_r.min(),_r.min(),lh.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(_r.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=lh.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=lh.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=_r.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Yl&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Yl(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{constructor(e,t){this.position=e,this.inclusive=t}}function ED(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(s.field.isKeyField()?i=lr.comparator(lr.fromName(o.referenceValue),t.key):i=n1(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function FD(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!gA(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cw{constructor(e,t="asc"){this.field=e,this.dir=t}}function lne(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jH{}class wl extends jH{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new hne(e,t,i):t==="array-contains"?new Ane(e,i):t==="in"?new fne(e,i):t==="not-in"?new pne(e,i):t==="array-contains-any"?new gne(e,i):new wl(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new une(e,i):new dne(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(n1(t,this.value)):t!==null&&Lp(this.value)===Lp(t)&&this.matchesComparison(n1(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return gr(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class xd extends jH{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new xd(e,t)}matches(e){return PH(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function PH(n){return n.op==="and"}function NH(n){return cne(n)&&PH(n)}function cne(n){for(const e of n.filters)if(e instanceof xd)return!1;return!0}function kB(n){if(n instanceof wl)return n.field.canonicalString()+n.op.toString()+i1(n.value);if(NH(n))return n.filters.map((e=>kB(e))).join(",");{const e=n.filters.map((t=>kB(t))).join(",");return`${n.op}(${e})`}}function LH(n,e){return n instanceof wl?(function(i,r){return r instanceof wl&&i.op===r.op&&i.field.isEqual(r.field)&&gA(i.value,r.value)})(n,e):n instanceof xd?(function(i,r){return r instanceof xd&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((s,o,a)=>s&&LH(o,r.filters[a])),!0):!1})(n,e):void gr(19439)}function MH(n){return n instanceof wl?(function(t){return`${t.field.canonicalString()} ${t.op} ${i1(t.value)}`})(n):n instanceof xd?(function(t){return t.op.toString()+" {"+t.getFilters().map(MH).join(" ,")+"}"})(n):"Filter"}class hne extends wl{constructor(e,t,i){super(e,t,i),this.key=lr.fromName(i.referenceValue)}matches(e){const t=lr.comparator(e.key,this.key);return this.matchesComparison(t)}}class une extends wl{constructor(e,t){super(e,"in",t),this.keys=RH("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class dne extends wl{constructor(e,t){super(e,"not-in",t),this.keys=RH("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function RH(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((i=>lr.fromName(i.referenceValue)))}class Ane extends wl{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return bF(t)&&bw(t.arrayValue,this.value)}}class fne extends wl{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&bw(this.value.arrayValue,t)}}class pne extends wl{constructor(e,t){super(e,"not-in",t)}matches(e){if(bw(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!bw(this.value.arrayValue,t)}}class gne extends wl{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!bF(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>bw(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mne{constructor(e,t=null,i=[],r=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.Pe=null}}function kD(n,e=null,t=[],i=[],r=null,s=null,o=null){return new mne(n,e,t,i,r,s,o)}function CF(n){const e=Or(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>kB(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(s){return s.field.canonicalString()+s.dir})(i))).join(","),av(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>i1(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>i1(i))).join(",")),e.Pe=t}return e.Pe}function _F(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!lne(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!LH(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!FD(n.startAt,e.startAt)&&FD(n.endAt,e.endAt)}function IB(n){return lr.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g0{constructor(e,t=null,i=[],r=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function yne(n,e,t,i,r,s,o,a){return new g0(n,e,t,i,r,s,o,a)}function p5(n){return new g0(n)}function ID(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function UH(n){return n.collectionGroup!==null}function My(n){const e=Or(n);if(e.Te===null){e.Te=[];const t=new Set;for(const s of e.explicitOrderBy)e.Te.push(s),t.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Dl(Kl.comparator);return o.filters.forEach((l=>{l.getFlattenedFilters().forEach((h=>{h.isInequality()&&(a=a.add(h.field))}))})),a})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Te.push(new Cw(s,i))})),t.has(Kl.keyField().canonicalString())||e.Te.push(new Cw(Kl.keyField(),i))}return e.Te}function hA(n){const e=Or(n);return e.Ie||(e.Ie=wne(e,My(n))),e.Ie}function wne(n,e){if(n.limitType==="F")return kD(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const s=r.dir==="desc"?"asc":"desc";return new Cw(r.field,s)}));const t=n.endAt?new PC(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new PC(n.startAt.position,n.startAt.inclusive):null;return kD(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function DB(n,e){const t=n.filters.concat([e]);return new g0(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function jB(n,e,t){return new g0(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function g5(n,e){return _F(hA(n),hA(e))&&n.limitType===e.limitType}function OH(n){return`${CF(hA(n))}|lt:${n.limitType}`}function am(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>MH(r))).join(", ")}]`),av(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>i1(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>i1(r))).join(",")),`Target(${i})`})(hA(n))}; limitType=${n.limitType})`}function m5(n,e){return e.isFoundDocument()&&(function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):lr.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)})(n,e)&&(function(i,r){for(const s of My(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(o,a,l){const h=ED(o,a,l);return o.inclusive?h<=0:h<0})(i.startAt,My(i),r)||i.endAt&&!(function(o,a,l){const h=ED(o,a,l);return o.inclusive?h>=0:h>0})(i.endAt,My(i),r))})(n,e)}function vne(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function HH(n){return(e,t)=>{let i=!1;for(const r of My(n)){const s=xne(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function xne(n,e,t){const i=n.field.isKeyField()?lr.comparator(e.key,t.key):(function(s,o,a){const l=o.data.field(s),h=a.data.field(s);return l!==null&&h!==null?n1(l,h):gr(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return gr(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m0{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Yp(this.inner,((t,i)=>{for(const[r,s]of i)e(r,s)}))}isEmpty(){return _H(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bne=new wa(lr.comparator);function xf(){return bne}const WH=new wa(lr.comparator);function Ay(...n){let e=WH;for(const t of n)e=e.insert(t.key,t);return e}function zH(n){let e=WH;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function jg(){return Ry()}function QH(){return Ry()}function Ry(){return new m0((n=>n.toString()),((n,e)=>n.isEqual(e)))}const Cne=new wa(lr.comparator),_ne=new Dl(lr.comparator);function Ds(...n){let e=_ne;for(const t of n)e=e.add(t);return e}const Sne=new Dl(ps);function Tne(){return Sne}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SF(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:IC(e)?"-0":e}}function $H(n){return{integerValue:""+n}}function Bne(n,e){return ene(e)?$H(e):SF(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y5{constructor(){this._=void 0}}function Ene(n,e,t){return n instanceof _w?(function(r,s){const o={fields:{[BH]:{stringValue:TH},[FH]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&xF(s)&&(s=f5(s)),s&&(o.fields[EH]=s),{mapValue:o}})(t,e):n instanceof r1?GH(n,e):n instanceof Sw?XH(n,e):(function(r,s){const o=VH(r,s),a=DD(o)+DD(r.Ee);return FB(o)&&FB(r.Ee)?$H(a):SF(r.serializer,a)})(n,e)}function Fne(n,e,t){return n instanceof r1?GH(n,e):n instanceof Sw?XH(n,e):t}function VH(n,e){return n instanceof NC?(function(i){return FB(i)||(function(s){return!!s&&"doubleValue"in s})(i)})(e)?e:{integerValue:0}:null}class _w extends y5{}class r1 extends y5{constructor(e){super(),this.elements=e}}function GH(n,e){const t=YH(e);for(const i of n.elements)t.some((r=>gA(r,i)))||t.push(i);return{arrayValue:{values:t}}}class Sw extends y5{constructor(e){super(),this.elements=e}}function XH(n,e){let t=YH(e);for(const i of n.elements)t=t.filter((r=>!gA(r,i)));return{arrayValue:{values:t}}}class NC extends y5{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function DD(n){return nl(n.integerValue||n.doubleValue)}function YH(n){return bF(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KH{constructor(e,t){this.field=e,this.transform=t}}function kne(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof r1&&r instanceof r1||i instanceof Sw&&r instanceof Sw?e1(i.elements,r.elements,gA):i instanceof NC&&r instanceof NC?gA(i.Ee,r.Ee):i instanceof _w&&r instanceof _w})(n.transform,e.transform)}class Ine{constructor(e,t){this.version=e,this.transformResults=t}}class yc{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new yc}static exists(e){return new yc(void 0,e)}static updateTime(e){return new yc(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Jb(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class w5{}function qH(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new v5(n.key,yc.none()):new lv(n.key,n.data,yc.none());{const t=n.data,i=lh.empty();let r=new Dl(Kl.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Kp(n.key,i,new Xh(r.toArray()),yc.none())}}function Dne(n,e,t){n instanceof lv?(function(r,s,o){const a=r.value.clone(),l=PD(r.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()})(n,e,t):n instanceof Kp?(function(r,s,o){if(!Jb(r.precondition,s))return void s.convertToUnknownDocument(o.version);const a=PD(r.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(ZH(r)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(n,e,t):(function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function Uy(n,e,t,i){return n instanceof lv?(function(s,o,a,l){if(!Jb(s.precondition,o))return a;const h=s.value.clone(),u=ND(s.fieldTransforms,l,o);return h.setAll(u),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,e,t,i):n instanceof Kp?(function(s,o,a,l){if(!Jb(s.precondition,o))return a;const h=ND(s.fieldTransforms,l,o),u=o.data;return u.setAll(ZH(s)),u.setAll(h),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((d=>d.field)))})(n,e,t,i):(function(s,o,a){return Jb(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a})(n,e,t)}function jne(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),s=VH(i.transform,r||null);s!=null&&(t===null&&(t=lh.empty()),t.set(i.field,s))}return t||null}function jD(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&e1(i,r,((s,o)=>kne(s,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class lv extends w5{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Kp extends w5{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function ZH(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function PD(n,e,t){const i=new Map;$s(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,Fne(o,a,t[r]))}return i}function ND(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,Ene(s,o,e))}return i}class v5 extends w5{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class JH extends w5{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pne{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&Dne(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Uy(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Uy(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=QH();return this.mutations.forEach((r=>{const s=e.get(r.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(r.key)?null:a;const l=qH(o,a);l!==null&&i.set(r.key,l),o.isValidDocument()||o.convertToNoDocument(_r.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Ds())}isEqual(e){return this.batchId===e.batchId&&e1(this.mutations,e.mutations,((t,i)=>jD(t,i)))&&e1(this.baseMutations,e.baseMutations,((t,i)=>jD(t,i)))}}class TF{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){$s(e.mutations.length===i.length,58842,{Ve:e.mutations.length,me:i.length});let r=(function(){return Cne})();const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new TF(e,t,i,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nne{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lne{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fl,Ws;function eW(n){switch(n){case _n.OK:return gr(64938);case _n.CANCELLED:case _n.UNKNOWN:case _n.DEADLINE_EXCEEDED:case _n.RESOURCE_EXHAUSTED:case _n.INTERNAL:case _n.UNAVAILABLE:case _n.UNAUTHENTICATED:return!1;case _n.INVALID_ARGUMENT:case _n.NOT_FOUND:case _n.ALREADY_EXISTS:case _n.PERMISSION_DENIED:case _n.FAILED_PRECONDITION:case _n.ABORTED:case _n.OUT_OF_RANGE:case _n.UNIMPLEMENTED:case _n.DATA_LOSS:return!0;default:return gr(15467,{code:n})}}function tW(n){if(n===void 0)return wf("GRPC error has no .code"),_n.UNKNOWN;switch(n){case fl.OK:return _n.OK;case fl.CANCELLED:return _n.CANCELLED;case fl.UNKNOWN:return _n.UNKNOWN;case fl.DEADLINE_EXCEEDED:return _n.DEADLINE_EXCEEDED;case fl.RESOURCE_EXHAUSTED:return _n.RESOURCE_EXHAUSTED;case fl.INTERNAL:return _n.INTERNAL;case fl.UNAVAILABLE:return _n.UNAVAILABLE;case fl.UNAUTHENTICATED:return _n.UNAUTHENTICATED;case fl.INVALID_ARGUMENT:return _n.INVALID_ARGUMENT;case fl.NOT_FOUND:return _n.NOT_FOUND;case fl.ALREADY_EXISTS:return _n.ALREADY_EXISTS;case fl.PERMISSION_DENIED:return _n.PERMISSION_DENIED;case fl.FAILED_PRECONDITION:return _n.FAILED_PRECONDITION;case fl.ABORTED:return _n.ABORTED;case fl.OUT_OF_RANGE:return _n.OUT_OF_RANGE;case fl.UNIMPLEMENTED:return _n.UNIMPLEMENTED;case fl.DATA_LOSS:return _n.DATA_LOSS;default:return gr(39323,{code:n})}}(Ws=fl||(fl={}))[Ws.OK=0]="OK",Ws[Ws.CANCELLED=1]="CANCELLED",Ws[Ws.UNKNOWN=2]="UNKNOWN",Ws[Ws.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ws[Ws.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ws[Ws.NOT_FOUND=5]="NOT_FOUND",Ws[Ws.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ws[Ws.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ws[Ws.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ws[Ws.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ws[Ws.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ws[Ws.ABORTED=10]="ABORTED",Ws[Ws.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ws[Ws.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ws[Ws.INTERNAL=13]="INTERNAL",Ws[Ws.UNAVAILABLE=14]="UNAVAILABLE",Ws[Ws.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mne=new Tp([4294967295,4294967295],0);function LD(n){const e=vH().encode(n),t=new uH;return t.update(e),new Uint8Array(t.digest())}function MD(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Tp([t,i],0),new Tp([r,s],0)]}class BF{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new fy(`Invalid padding: ${t}`);if(i<0)throw new fy(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new fy(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new fy(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=Tp.fromNumber(this.fe)}pe(e,t,i){let r=e.add(t.multiply(Tp.fromNumber(i)));return r.compare(Mne)===1&&(r=new Tp([r.getBits(0),r.getBits(1)],0)),r.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=LD(e),[i,r]=MD(t);for(let s=0;s<this.hashCount;s++){const o=this.pe(i,r,s);if(!this.ye(o))return!1}return!0}static create(e,t,i){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new BF(s,r,t);return i.forEach((a=>o.insert(a))),o}insert(e){if(this.fe===0)return;const t=LD(e),[i,r]=MD(t);for(let s=0;s<this.hashCount;s++){const o=this.pe(i,r,s);this.we(o)}}we(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class fy extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x5{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,cv.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new x5(_r.min(),r,new wa(ps),xf(),Ds())}}class cv{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new cv(i,t,Ds(),Ds(),Ds())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC{constructor(e,t,i,r){this.Se=e,this.removedTargetIds=t,this.key=i,this.be=r}}class nW{constructor(e,t){this.targetId=e,this.De=t}}class iW{constructor(e,t,i=Jl.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class RD{constructor(){this.ve=0,this.Ce=UD(),this.Fe=Jl.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=Ds(),t=Ds(),i=Ds();return this.Ce.forEach(((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:gr(38017,{changeType:s})}})),new cv(this.Fe,this.Me,e,t,i)}ke(){this.xe=!1,this.Ce=UD()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,$s(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class Rne{constructor(e){this.We=e,this.Ge=new Map,this.ze=xf(),this.je=ix(),this.Je=ix(),this.He=new wa(ps)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,(t=>{const i=this.tt(t);switch(e.state){case 0:this.nt(t)&&i.Be(e.resumeToken);break;case 1:i.Ue(),i.Oe||i.ke(),i.Be(e.resumeToken);break;case 2:i.Ue(),i.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(i.Ke(),i.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),i.Be(e.resumeToken));break;default:gr(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach(((i,r)=>{this.nt(r)&&t(r)}))}it(e){const t=e.targetId,i=e.De.count,r=this.st(t);if(r){const s=r.target;if(IB(s))if(i===0){const o=new lr(s.path);this.Xe(t,o,Yl.newNoDocument(o,_r.min()))}else $s(i===1,20013,{expectedCount:i});else{const o=this.ot(t);if(o!==i){const a=this._t(e),l=a?this.ut(a,e,o):1;if(l!==0){this.rt(t);const h=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,h)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=t;let o,a;try{o=Np(i).toUint8Array()}catch(l){if(l instanceof SH)return vf("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new BF(o,r,s)}catch(l){return vf(l instanceof fy?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.fe===0?null:a}ut(e,t,i){return t.De.count===i-this.ht(e,t.targetId)?0:2}ht(e,t){const i=this.We.getRemoteKeysForTarget(t);let r=0;return i.forEach((s=>{const o=this.We.lt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Xe(t,s,null),r++)})),r}Pt(e){const t=new Map;this.Ge.forEach(((s,o)=>{const a=this.st(o);if(a){if(s.current&&IB(a.target)){const l=new lr(a.target.path);this.Tt(l).has(o)||this.It(o,l)||this.Xe(o,l,Yl.newNoDocument(l,e))}s.Ne&&(t.set(o,s.Le()),s.ke())}}));let i=Ds();this.Je.forEach(((s,o)=>{let a=!0;o.forEachWhile((l=>{const h=this.st(l);return!h||h.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)})),a&&(i=i.add(s))})),this.ze.forEach(((s,o)=>o.setReadTime(e)));const r=new x5(e,t,this.He,this.ze,i);return this.ze=xf(),this.je=ix(),this.Je=ix(),this.He=new wa(ps),r}Ze(e,t){if(!this.nt(e))return;const i=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,i),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,i){if(!this.nt(e))return;const r=this.tt(e);this.It(e,t)?r.qe(t,1):r.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),i&&(this.ze=this.ze.insert(t,i))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new RD,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new Dl(ps),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new Dl(ps),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||Pi("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new RD),this.We.getRemoteKeysForTarget(e).forEach((t=>{this.Xe(e,t,null)}))}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function ix(){return new wa(lr.comparator)}function UD(){return new wa(lr.comparator)}const Une={asc:"ASCENDING",desc:"DESCENDING"},One={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Hne={and:"AND",or:"OR"};class Wne{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function PB(n,e){return n.useProto3Json||av(e)?e:{value:e}}function LC(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function rW(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function zne(n,e){return LC(n,e.toTimestamp())}function qh(n){return $s(!!n,49232),_r.fromTimestamp((function(t){const i=Pp(t);return new yo(i.seconds,i.nanos)})(n))}function EF(n,e){return NB(n,e).canonicalString()}function NB(n,e){const t=(function(r){return new mo(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function sW(n){const e=mo.fromString(n);return $s(uW(e),10190,{key:e.toString()}),e}function MC(n,e){return EF(n.databaseId,e.path)}function Oy(n,e){const t=sW(e);if(t.get(1)!==n.databaseId.projectId)throw new vi(_n.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new vi(_n.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new lr(aW(t))}function oW(n,e){return EF(n.databaseId,e)}function Qne(n){const e=sW(n);return e.length===4?mo.emptyPath():aW(e)}function LB(n){return new mo(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function aW(n){return $s(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function OD(n,e,t){return{name:MC(n,e),fields:t.value.mapValue.fields}}function $ne(n,e){return"found"in e?(function(i,r){$s(!!r.found,43571),r.found.name,r.found.updateTime;const s=Oy(i,r.found.name),o=qh(r.found.updateTime),a=r.found.createTime?qh(r.found.createTime):_r.min(),l=new lh({mapValue:{fields:r.found.fields}});return Yl.newFoundDocument(s,o,a,l)})(n,e):"missing"in e?(function(i,r){$s(!!r.missing,3894),$s(!!r.readTime,22933);const s=Oy(i,r.missing),o=qh(r.readTime);return Yl.newNoDocument(s,o)})(n,e):gr(7234,{result:e})}function Vne(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:gr(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=(function(h,u){return h.useProto3Json?($s(u===void 0||typeof u=="string",58123),Jl.fromBase64String(u||"")):($s(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),Jl.fromUint8Array(u||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&(function(h){const u=h.code===void 0?_n.UNKNOWN:tW(h.code);return new vi(u,h.message||"")})(o);t=new iW(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=Oy(n,i.document.name),s=qh(i.document.updateTime),o=i.document.createTime?qh(i.document.createTime):_r.min(),a=new lh({mapValue:{fields:i.document.fields}}),l=Yl.newFoundDocument(r,s,o,a),h=i.targetIds||[],u=i.removedTargetIds||[];t=new eC(h,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=Oy(n,i.document),s=i.readTime?qh(i.readTime):_r.min(),o=Yl.newNoDocument(r,s),a=i.removedTargetIds||[];t=new eC([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=Oy(n,i.document),s=i.removedTargetIds||[];t=new eC([],s,r,null)}else{if(!("filter"in e))return gr(11601,{At:e});{e.filter;const i=e.filter;i.targetId;const{count:r=0,unchangedNames:s}=i,o=new Lne(r,s),a=i.targetId;t=new nW(a,o)}}return t}function lW(n,e){let t;if(e instanceof lv)t={update:OD(n,e.key,e.value)};else if(e instanceof v5)t={delete:MC(n,e.key)};else if(e instanceof Kp)t={update:OD(n,e.key,e.data),updateMask:tie(e.fieldMask)};else{if(!(e instanceof JH))return gr(16599,{Rt:e.type});t={verify:MC(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(s,o){const a=o.transform;if(a instanceof _w)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof r1)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Sw)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof NC)return{fieldPath:o.field.canonicalString(),increment:a.Ee};throw gr(20930,{transform:o.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,s){return s.updateTime!==void 0?{updateTime:zne(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:gr(27497)})(n,e.precondition)),t}function Gne(n,e){return n&&n.length>0?($s(e!==void 0,14353),n.map((t=>(function(r,s){let o=r.updateTime?qh(r.updateTime):qh(s);return o.isEqual(_r.min())&&(o=qh(s)),new Ine(o,r.transformResults||[])})(t,e)))):[]}function Xne(n,e){return{documents:[oW(n,e.path)]}}function Yne(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=oW(n,r);const s=(function(h){if(h.length!==0)return hW(xd.create(h,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const o=(function(h){if(h.length!==0)return h.map((u=>(function(A){return{field:lm(A.field),direction:Zne(A.dir)}})(u)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=PB(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{Vt:t,parent:r}}function Kne(n){let e=Qne(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){$s(i===1,65062);const u=t.from[0];u.allDescendants?r=u.collectionId:e=e.child(u.collectionId)}let s=[];t.where&&(s=(function(d){const A=cW(d);return A instanceof xd&&NH(A)?A.getFilters():[A]})(t.where));let o=[];t.orderBy&&(o=(function(d){return d.map((A=>(function(p){return new Cw(cm(p.field),(function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(p.direction))})(A)))})(t.orderBy));let a=null;t.limit&&(a=(function(d){let A;return A=typeof d=="object"?d.value:d,av(A)?null:A})(t.limit));let l=null;t.startAt&&(l=(function(d){const A=!!d.before,f=d.values||[];return new PC(f,A)})(t.startAt));let h=null;return t.endAt&&(h=(function(d){const A=!d.before,f=d.values||[];return new PC(f,A)})(t.endAt)),yne(e,r,o,s,a,"F",l,h)}function qne(n,e){const t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return gr(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function cW(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=cm(t.unaryFilter.field);return wl.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=cm(t.unaryFilter.field);return wl.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=cm(t.unaryFilter.field);return wl.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=cm(t.unaryFilter.field);return wl.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return gr(61313);default:return gr(60726)}})(n):n.fieldFilter!==void 0?(function(t){return wl.create(cm(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return gr(58110);default:return gr(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return xd.create(t.compositeFilter.filters.map((i=>cW(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return gr(1026)}})(t.compositeFilter.op))})(n):gr(30097,{filter:n})}function Zne(n){return Une[n]}function Jne(n){return One[n]}function eie(n){return Hne[n]}function lm(n){return{fieldPath:n.canonicalString()}}function cm(n){return Kl.fromServerFormat(n.fieldPath)}function hW(n){return n instanceof wl?(function(t){if(t.op==="=="){if(BD(t.value))return{unaryFilter:{field:lm(t.field),op:"IS_NAN"}};if(TD(t.value))return{unaryFilter:{field:lm(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(BD(t.value))return{unaryFilter:{field:lm(t.field),op:"IS_NOT_NAN"}};if(TD(t.value))return{unaryFilter:{field:lm(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:lm(t.field),op:Jne(t.op),value:t.value}}})(n):n instanceof xd?(function(t){const i=t.getFilters().map((r=>hW(r)));return i.length===1?i[0]:{compositeFilter:{op:eie(t.op),filters:i}}})(n):gr(54877,{filter:n})}function tie(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function uW(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp{constructor(e,t,i,r,s=_r.min(),o=_r.min(),a=Jl.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new pp(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new pp(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new pp(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new pp(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nie{constructor(e){this.gt=e}}function iie(n){const e=Kne({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?jB(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rie{constructor(){this.Dn=new sie}addToCollectionParentIndex(e,t){return this.Dn.add(t),Pn.resolve()}getCollectionParents(e,t){return Pn.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return Pn.resolve()}deleteFieldIndex(e,t){return Pn.resolve()}deleteAllFieldIndexes(e){return Pn.resolve()}createTargetIndexes(e,t){return Pn.resolve()}getDocumentsMatchingTarget(e,t){return Pn.resolve(null)}getIndexType(e,t){return Pn.resolve(0)}getFieldIndexes(e,t){return Pn.resolve([])}getNextCollectionGroupToUpdate(e){return Pn.resolve(null)}getMinOffset(e,t){return Pn.resolve(jp.min())}getMinOffsetFromCollectionGroup(e,t){return Pn.resolve(jp.min())}updateCollectionGroup(e,t,i){return Pn.resolve()}updateIndexEntries(e,t){return Pn.resolve()}}class sie{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new Dl(mo.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new Dl(mo.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HD={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},dW=41943040;class Eh{static withCacheSize(e){return new Eh(e,Eh.DEFAULT_COLLECTION_PERCENTILE,Eh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Eh.DEFAULT_COLLECTION_PERCENTILE=10,Eh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Eh.DEFAULT=new Eh(dW,Eh.DEFAULT_COLLECTION_PERCENTILE,Eh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Eh.DISABLED=new Eh(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new s1(0)}static ur(){return new s1(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WD="LruGarbageCollector",oie=1048576;function zD([n,e],[t,i]){const r=ps(n,t);return r===0?ps(e,i):r}class aie{constructor(e){this.Tr=e,this.buffer=new Dl(zD),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();zD(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class lie{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){Pi(WD,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){b1(t)?Pi(WD,"Ignoring IndexedDB error during garbage collection: ",t):await x1(t)}await this.Rr(3e5)}))}}class cie{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Pn.resolve(A5.ue);const i=new aie(t);return this.Vr.forEachTarget(e,(r=>i.Er(r.sequenceNumber))).next((()=>this.Vr.gr(e,(r=>i.Er(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Pi("LruGarbageCollector","Garbage collection skipped; disabled"),Pn.resolve(HD)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Pi("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),HD):this.pr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let i,r,s,o,a,l,h;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((d=>(d>this.params.maximumSequenceNumbersToCollect?(Pi("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),r=this.params.maximumSequenceNumbersToCollect):r=d,o=Date.now(),this.nthSequenceNumber(e,r)))).next((d=>(i=d,a=Date.now(),this.removeTargets(e,i,t)))).next((d=>(s=d,l=Date.now(),this.removeOrphanedDocuments(e,i)))).next((d=>(h=Date.now(),om()<=Is.DEBUG&&Pi("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${d} documents in `+(h-l)+`ms
Total Duration: ${h-u}ms`),Pn.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:d}))))}}function hie(n,e){return new cie(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uie{constructor(){this.changes=new m0((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Yl.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Pn.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class die{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aie{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&Uy(i.mutation,r,Xh.empty(),yo.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Ds()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Ds()){const r=jg();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((s=>{let o=Ay();return s.forEach(((a,l)=>{o=o.insert(a,l.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const i=jg();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Ds())))}populateOverlays(e,t,i){const r=[];return i.forEach((s=>{t.has(s)||r.push(s)})),this.documentOverlayCache.getOverlays(e,r).next((s=>{s.forEach(((o,a)=>{t.set(o,a)}))}))}computeViews(e,t,i,r){let s=xf();const o=Ry(),a=(function(){return Ry()})();return t.forEach(((l,h)=>{const u=i.get(h.key);r.has(h.key)&&(u===void 0||u.mutation instanceof Kp)?s=s.insert(h.key,h):u!==void 0?(o.set(h.key,u.mutation.getFieldMask()),Uy(u.mutation,h,u.mutation.getFieldMask(),yo.now())):o.set(h.key,Xh.empty())})),this.recalculateAndSaveOverlays(e,s).next((l=>(l.forEach(((h,u)=>o.set(h,u))),t.forEach(((h,u)=>{var d;return a.set(h,new die(u,(d=o.get(h))!==null&&d!==void 0?d:null))})),a)))}recalculateAndSaveOverlays(e,t){const i=Ry();let r=new wa(((o,a)=>o-a)),s=Ds();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const a of o)a.keys().forEach((l=>{const h=t.get(l);if(h===null)return;let u=i.get(l)||Xh.empty();u=a.applyToLocalView(h,u),i.set(l,u);const d=(r.get(a.batchId)||Ds()).add(l);r=r.insert(a.batchId,d)}))})).next((()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),h=l.key,u=l.value,d=QH();u.forEach((A=>{if(!s.has(A)){const f=qH(t.get(A),i.get(A));f!==null&&d.set(A,f),s=s.add(A)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,d))}return Pn.waitFor(o)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return(function(o){return lr.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):UH(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):Pn.resolve(jg());let a=vw,l=s;return o.next((h=>Pn.forEach(h,((u,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(u)?Pn.resolve():this.remoteDocumentCache.getEntry(e,u).next((A=>{l=l.insert(u,A)}))))).next((()=>this.populateOverlays(e,h,s))).next((()=>this.computeViews(e,l,h,Ds()))).next((u=>({batchId:a,changes:zH(u)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new lr(t)).next((i=>{let r=Ay();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const s=t.collectionGroup;let o=Ay();return this.indexManager.getCollectionParents(e,s).next((a=>Pn.forEach(a,(l=>{const h=(function(d,A){return new g0(A,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)})(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,i,r).next((u=>{u.forEach(((d,A)=>{o=o.insert(d,A)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r)))).next((o=>{s.forEach(((l,h)=>{const u=h.getKey();o.get(u)===null&&(o=o.insert(u,Yl.newInvalidDocument(u)))}));let a=Ay();return o.forEach(((l,h)=>{const u=s.get(l);u!==void 0&&Uy(u.mutation,h,Xh.empty(),yo.now()),m5(t,h)&&(a=a.insert(l,h))})),a}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fie{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return Pn.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:qh(r.createTime)}})(t)),Pn.resolve()}getNamedQuery(e,t){return Pn.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(r){return{name:r.name,query:iie(r.bundledQuery),readTime:qh(r.readTime)}})(t)),Pn.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pie{constructor(){this.overlays=new wa(lr.comparator),this.kr=new Map}getOverlay(e,t){return Pn.resolve(this.overlays.get(t))}getOverlays(e,t){const i=jg();return Pn.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,s)=>{this.wt(e,t,s)})),Pn.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.kr.get(i);return r!==void 0&&(r.forEach((s=>this.overlays=this.overlays.remove(s))),this.kr.delete(i)),Pn.resolve()}getOverlaysForCollection(e,t,i){const r=jg(),s=t.length+1,o=new lr(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,h=l.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&l.largestBatchId>i&&r.set(l.getKey(),l)}return Pn.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new wa(((h,u)=>h-u));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>i){let u=s.get(h.largestBatchId);u===null&&(u=jg(),s=s.insert(h.largestBatchId,u)),u.set(h.getKey(),h)}}const a=jg(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((h,u)=>a.set(h,u))),!(a.size()>=r)););return Pn.resolve(a)}wt(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.kr.get(r.largestBatchId).delete(i.key);this.kr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new Nne(t,i));let s=this.kr.get(t);s===void 0&&(s=Ds(),this.kr.set(t,s)),this.kr.set(t,s.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gie{constructor(){this.sessionToken=Jl.EMPTY_BYTE_STRING}getSessionToken(e){return Pn.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Pn.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FF{constructor(){this.qr=new Dl($l.Qr),this.$r=new Dl($l.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const i=new $l(e,t);this.qr=this.qr.add(i),this.$r=this.$r.add(i)}Kr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new $l(e,t))}Gr(e,t){e.forEach((i=>this.removeReference(i,t)))}zr(e){const t=new lr(new mo([])),i=new $l(t,e),r=new $l(t,e+1),s=[];return this.$r.forEachInRange([i,r],(o=>{this.Wr(o),s.push(o.key)})),s}jr(){this.qr.forEach((e=>this.Wr(e)))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new lr(new mo([])),i=new $l(t,e),r=new $l(t,e+1);let s=Ds();return this.$r.forEachInRange([i,r],(o=>{s=s.add(o.key)})),s}containsKey(e){const t=new $l(e,0),i=this.qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class $l{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return lr.comparator(e.key,t.key)||ps(e.Hr,t.Hr)}static Ur(e,t){return ps(e.Hr,t.Hr)||lr.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mie{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new Dl($l.Qr)}checkEmpty(e){return Pn.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const s=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Pne(s,t,i,r);this.mutationQueue.push(o);for(const a of r)this.Yr=this.Yr.add(new $l(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return Pn.resolve(o)}lookupMutationBatch(e,t){return Pn.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.Xr(i),s=r<0?0:r;return Pn.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Pn.resolve(this.mutationQueue.length===0?vF:this.er-1)}getAllMutationBatches(e){return Pn.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new $l(t,0),r=new $l(t,Number.POSITIVE_INFINITY),s=[];return this.Yr.forEachInRange([i,r],(o=>{const a=this.Zr(o.Hr);s.push(a)})),Pn.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Dl(ps);return t.forEach((r=>{const s=new $l(r,0),o=new $l(r,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([s,o],(a=>{i=i.add(a.Hr)}))})),Pn.resolve(this.ei(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;lr.isDocumentKey(s)||(s=s.child(""));const o=new $l(new lr(s),0);let a=new Dl(ps);return this.Yr.forEachWhile((l=>{const h=l.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(a=a.add(l.Hr)),!0)}),o),Pn.resolve(this.ei(a))}ei(e){const t=[];return e.forEach((i=>{const r=this.Zr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){$s(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Yr;return Pn.forEach(t.mutations,(r=>{const s=new $l(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Yr=i}))}rr(e){}containsKey(e,t){const i=new $l(t,0),r=this.Yr.firstAfterOrEqual(i);return Pn.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Pn.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yie{constructor(e){this.ni=e,this.docs=(function(){return new wa(lr.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.ni(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Pn.resolve(i?i.document.mutableCopy():Yl.newInvalidDocument(t))}getEntries(e,t){let i=xf();return t.forEach((r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Yl.newInvalidDocument(r))})),Pn.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=xf();const o=t.path,a=new lr(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:h,value:{document:u}}=l.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||Kte(Yte(u),i)<=0||(r.has(u.key)||m5(t,u))&&(s=s.insert(u.key,u.mutableCopy()))}return Pn.resolve(s)}getAllFromCollectionGroup(e,t,i,r){gr(9500)}ri(e,t){return Pn.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new wie(this)}getSize(e){return Pn.resolve(this.size)}}class wie extends uie{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Or.addEntry(e,r)):this.Or.removeEntry(i)})),Pn.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vie{constructor(e){this.persistence=e,this.ii=new m0((t=>CF(t)),_F),this.lastRemoteSnapshotVersion=_r.min(),this.highestTargetId=0,this.si=0,this.oi=new FF,this.targetCount=0,this._i=s1.ar()}forEachTarget(e,t){return this.ii.forEach(((i,r)=>t(r))),Pn.resolve()}getLastRemoteSnapshotVersion(e){return Pn.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Pn.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),Pn.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.si&&(this.si=t),Pn.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new s1(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,Pn.resolve()}updateTargetData(e,t){return this.hr(t),Pn.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,Pn.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.ii.forEach(((o,a)=>{a.sequenceNumber<=t&&i.get(a.targetId)===null&&(this.ii.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)})),Pn.waitFor(s).next((()=>r))}getTargetCount(e){return Pn.resolve(this.targetCount)}getTargetData(e,t){const i=this.ii.get(t)||null;return Pn.resolve(i)}addMatchingKeys(e,t,i){return this.oi.Kr(t,i),Pn.resolve()}removeMatchingKeys(e,t,i){this.oi.Gr(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach((o=>{s.push(r.markPotentiallyOrphaned(e,o))})),Pn.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),Pn.resolve()}getMatchingKeysForTargetId(e,t){const i=this.oi.Jr(t);return Pn.resolve(i)}containsKey(e,t){return Pn.resolve(this.oi.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AW{constructor(e,t){this.ai={},this.overlays={},this.ui=new A5(0),this.ci=!1,this.ci=!0,this.li=new gie,this.referenceDelegate=e(this),this.hi=new vie(this),this.indexManager=new rie,this.remoteDocumentCache=(function(r){return new yie(r)})((i=>this.referenceDelegate.Pi(i))),this.serializer=new nie(t),this.Ti=new fie(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new pie,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ai[e.toKey()];return i||(i=new mie(t,this.referenceDelegate),this.ai[e.toKey()]=i),i}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,i){Pi("MemoryPersistence","Starting transaction:",e);const r=new xie(this.ui.next());return this.referenceDelegate.Ii(),i(r).next((s=>this.referenceDelegate.di(r).next((()=>s)))).toPromise().then((s=>(r.raiseOnCommittedEvent(),s)))}Ei(e,t){return Pn.or(Object.values(this.ai).map((i=>()=>i.containsKey(e,t))))}}class xie extends Zte{constructor(e){super(),this.currentSequenceNumber=e}}class kF{constructor(e){this.persistence=e,this.Ai=new FF,this.Ri=null}static Vi(e){return new kF(e)}get mi(){if(this.Ri)return this.Ri;throw gr(60996)}addReference(e,t,i){return this.Ai.addReference(i,t),this.mi.delete(i.toString()),Pn.resolve()}removeReference(e,t,i){return this.Ai.removeReference(i,t),this.mi.add(i.toString()),Pn.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),Pn.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach((r=>this.mi.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((s=>this.mi.add(s.toString())))})).next((()=>i.removeTargetData(e,t)))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Pn.forEach(this.mi,(i=>{const r=lr.fromPath(i);return this.fi(e,r).next((s=>{s||t.removeEntry(r,_r.min())}))})).next((()=>(this.Ri=null,t.apply(e))))}updateLimboDocument(e,t){return this.fi(e,t).next((i=>{i?this.mi.delete(t.toString()):this.mi.add(t.toString())}))}Pi(e){return 0}fi(e,t){return Pn.or([()=>Pn.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class RC{constructor(e,t){this.persistence=e,this.gi=new m0((i=>tne(i.path)),((i,r)=>i.isEqual(r))),this.garbageCollector=hie(this,t)}static Vi(e,t){return new RC(e,t)}Ii(){}di(e){return Pn.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}yr(e){let t=0;return this.gr(e,(i=>{t++})).next((()=>t))}gr(e,t){return Pn.forEach(this.gi,((i,r)=>this.Sr(e,i,r).next((s=>s?Pn.resolve():t(r)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.ri(e,(o=>this.Sr(e,o,t).next((a=>{a||(i++,s.removeEntry(o,_r.min()))})))).next((()=>s.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),Pn.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.gi.set(i,e.currentSequenceNumber),Pn.resolve()}removeReference(e,t,i){return this.gi.set(i,e.currentSequenceNumber),Pn.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),Pn.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=qb(e.data.value)),t}Sr(e,t,i){return Pn.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.gi.get(t);return Pn.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IF{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Is=i,this.ds=r}static Es(e,t){let i=Ds(),r=Ds();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new IF(e,t.fromCache,i,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bie{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cie{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return xZ()?8:Jte($c())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,i,r){const s={result:null};return this.ps(e,t).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ys(e,t,r,i).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new bie;return this.ws(e,t,o).next((a=>{if(s.result=a,this.Rs)return this.Ss(e,t,o,a.size)}))})).next((()=>s.result))}Ss(e,t,i,r){return i.documentReadCount<this.Vs?(om()<=Is.DEBUG&&Pi("QueryEngine","SDK will not create cache indexes for query:",am(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Pn.resolve()):(om()<=Is.DEBUG&&Pi("QueryEngine","Query:",am(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.fs*r?(om()<=Is.DEBUG&&Pi("QueryEngine","The SDK decides to create cache indexes for query:",am(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,hA(t))):Pn.resolve())}ps(e,t){if(ID(t))return Pn.resolve(null);let i=hA(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=jB(t,null,"F"),i=hA(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((s=>{const o=Ds(...s);return this.gs.getDocuments(e,o).next((a=>this.indexManager.getMinOffset(e,i).next((l=>{const h=this.bs(t,a);return this.Ds(t,h,o,l.readTime)?this.ps(e,jB(t,null,"F")):this.vs(e,h,t,l)}))))})))))}ys(e,t,i,r){return ID(t)||r.isEqual(_r.min())?Pn.resolve(null):this.gs.getDocuments(e,i).next((s=>{const o=this.bs(t,s);return this.Ds(t,o,i,r)?Pn.resolve(null):(om()<=Is.DEBUG&&Pi("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),am(t)),this.vs(e,o,t,Xte(r,vw)).next((a=>a)))}))}bs(e,t){let i=new Dl(HH(e));return t.forEach(((r,s)=>{m5(e,s)&&(i=i.add(s))})),i}Ds(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}ws(e,t,i){return om()<=Is.DEBUG&&Pi("QueryEngine","Using full collection scan to execute query:",am(t)),this.gs.getDocumentsMatchingQuery(e,t,jp.min(),i)}vs(e,t,i,r){return this.gs.getDocumentsMatchingQuery(e,i,r).next((s=>(t.forEach((o=>{s=s.insert(o.key,o)})),s)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DF="LocalStore",_ie=3e8;class Sie{constructor(e,t,i,r){this.persistence=e,this.Cs=t,this.serializer=r,this.Fs=new wa(ps),this.Ms=new m0((s=>CF(s)),_F),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(i)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Aie(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Fs)))}}function Tie(n,e,t,i){return new Sie(n,e,t,i)}async function fW(n,e){const t=Or(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((s=>(r=s,t.Ns(e),t.mutationQueue.getAllMutationBatches(i)))).next((s=>{const o=[],a=[];let l=Ds();for(const h of r){o.push(h.batchId);for(const u of h.mutations)l=l.add(u.key)}for(const h of s){a.push(h.batchId);for(const u of h.mutations)l=l.add(u.key)}return t.localDocuments.getDocuments(i,l).next((h=>({Bs:h,removedBatchIds:o,addedBatchIds:a})))}))}))}function Bie(n,e){const t=Or(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),s=t.Os.newChangeBuffer({trackRemovals:!0});return(function(a,l,h,u){const d=h.batch,A=d.keys();let f=Pn.resolve();return A.forEach((p=>{f=f.next((()=>u.getEntry(l,p))).next((g=>{const v=h.docVersions.get(p);$s(v!==null,48541),g.version.compareTo(v)<0&&(d.applyToRemoteDocument(g,h),g.isValidDocument()&&(g.setReadTime(h.commitVersion),u.addEntry(g)))}))})),f.next((()=>a.mutationQueue.removeMutationBatch(l,d)))})(t,i,e,s).next((()=>s.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(a){let l=Ds();for(let h=0;h<a.mutationResults.length;++h)a.mutationResults[h].transformResults.length>0&&(l=l.add(a.batch.mutations[h].key));return l})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function pW(n){const e=Or(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.hi.getLastRemoteSnapshotVersion(t)))}function Eie(n,e){const t=Or(n),i=e.snapshotVersion;let r=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const o=t.Os.newChangeBuffer({trackRemovals:!0});r=t.Fs;const a=[];e.targetChanges.forEach(((u,d)=>{const A=r.get(d);if(!A)return;a.push(t.hi.removeMatchingKeys(s,u.removedDocuments,d).next((()=>t.hi.addMatchingKeys(s,u.addedDocuments,d))));let f=A.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?f=f.withResumeToken(Jl.EMPTY_BYTE_STRING,_r.min()).withLastLimboFreeSnapshotVersion(_r.min()):u.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(u.resumeToken,i)),r=r.insert(d,f),(function(g,v,w){return g.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=_ie?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0})(A,f,u)&&a.push(t.hi.updateTargetData(s,f))}));let l=xf(),h=Ds();if(e.documentUpdates.forEach((u=>{e.resolvedLimboDocuments.has(u)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,u))})),a.push(Fie(s,o,e.documentUpdates).next((u=>{l=u.Ls,h=u.ks}))),!i.isEqual(_r.min())){const u=t.hi.getLastRemoteSnapshotVersion(s).next((d=>t.hi.setTargetsMetadata(s,s.currentSequenceNumber,i)));a.push(u)}return Pn.waitFor(a).next((()=>o.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,l,h))).next((()=>l))})).then((s=>(t.Fs=r,s)))}function Fie(n,e,t){let i=Ds(),r=Ds();return t.forEach((s=>i=i.add(s))),e.getEntries(n,i).next((s=>{let o=xf();return t.forEach(((a,l)=>{const h=s.get(a);l.isFoundDocument()!==h.isFoundDocument()&&(r=r.add(a)),l.isNoDocument()&&l.version.isEqual(_r.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!h.isValidDocument()||l.version.compareTo(h.version)>0||l.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):Pi(DF,"Ignoring outdated watch update for ",a,". Current version:",h.version," Watch version:",l.version)})),{Ls:o,ks:r}}))}function kie(n,e){const t=Or(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=vF),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function Iie(n,e){const t=Or(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let r;return t.hi.getTargetData(i,e).next((s=>s?(r=s,Pn.resolve(r)):t.hi.allocateTargetId(i).next((o=>(r=new pp(e,o,"TargetPurposeListen",i.currentSequenceNumber),t.hi.addTargetData(i,r).next((()=>r)))))))})).then((i=>{const r=t.Fs.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(i.targetId,i),t.Ms.set(e,i.targetId)),i}))}async function MB(n,e,t){const i=Or(n),r=i.Fs.get(e),s=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",s,(o=>i.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(!b1(o))throw o;Pi(DF,`Failed to update sequence numbers for target ${e}: ${o}`)}i.Fs=i.Fs.remove(e),i.Ms.delete(r.target)}function QD(n,e,t){const i=Or(n);let r=_r.min(),s=Ds();return i.persistence.runTransaction("Execute query","readwrite",(o=>(function(l,h,u){const d=Or(l),A=d.Ms.get(u);return A!==void 0?Pn.resolve(d.Fs.get(A)):d.hi.getTargetData(h,u)})(i,o,hA(e)).next((a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.hi.getMatchingKeysForTargetId(o,a.targetId).next((l=>{s=l}))})).next((()=>i.Cs.getDocumentsMatchingQuery(o,e,t?r:_r.min(),t?s:Ds()))).next((a=>(Die(i,vne(e),a),{documents:a,qs:s})))))}function Die(n,e,t){let i=n.xs.get(e)||_r.min();t.forEach(((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)})),n.xs.set(e,i)}class $D{constructor(){this.activeTargetIds=Tne()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class jie{constructor(){this.Fo=new $D,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,i){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new $D,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pie{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VD="ConnectivityMonitor";class GD{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){Pi(VD,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){Pi(VD,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rx=null;function RB(){return rx===null?rx=(function(){return 268435456+Math.round(2147483648*Math.random())})():rx++,"0x"+rx.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HS="RestConnection",Nie={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Lie{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${i}/databases/${r}`,this.Ko=this.databaseId.database===DC?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Wo(e,t,i,r,s){const o=RB(),a=this.Go(e,t.toUriEncodedString());Pi(HS,`Sending RPC '${e}' ${o}:`,a,i);const l={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(l,r,s);const{host:h}=new URL(a),u=Gp(h);return this.jo(e,a,l,i,u).then((d=>(Pi(HS,`Received RPC '${e}' ${o}: `,d),d)),(d=>{throw vf(HS,`RPC '${e}' ${o} failed with error: `,d,"url: ",a,"request:",i),d}))}Jo(e,t,i,r,s,o){return this.Wo(e,t,i,r,s)}zo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+v1})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,s)=>e[s]=r)),i&&i.headers.forEach(((r,s)=>e[s]=r))}Go(e,t){const i=Nie[e];return`${this.$o}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mie{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ic="WebChannelConnection";class Rie extends Lie{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,i,r,s){const o=RB();return new Promise(((a,l)=>{const h=new dH;h.setWithCredentials(!0),h.listenOnce(AH.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case Kb.NO_ERROR:const d=h.getResponseJson();Pi(Ic,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(d)),a(d);break;case Kb.TIMEOUT:Pi(Ic,`RPC '${e}' ${o} timed out`),l(new vi(_n.DEADLINE_EXCEEDED,"Request time out"));break;case Kb.HTTP_ERROR:const A=h.getStatus();if(Pi(Ic,`RPC '${e}' ${o} failed with status:`,A,"response text:",h.getResponseText()),A>0){let f=h.getResponseJson();Array.isArray(f)&&(f=f[0]);const p=f==null?void 0:f.error;if(p&&p.status&&p.message){const g=(function(w){const m=w.toLowerCase().replace(/_/g,"-");return Object.values(_n).indexOf(m)>=0?m:_n.UNKNOWN})(p.status);l(new vi(g,p.message))}else l(new vi(_n.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new vi(_n.UNAVAILABLE,"Connection failed."));break;default:gr(9055,{c_:e,streamId:o,l_:h.getLastErrorCode(),h_:h.getLastError()})}}finally{Pi(Ic,`RPC '${e}' ${o} completed.`)}}));const u=JSON.stringify(r);Pi(Ic,`RPC '${e}' ${o} sending request:`,r),h.send(t,"POST",u,i,15)}))}P_(e,t,i){const r=RB(),s=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=gH(),a=pH(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(l.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(l.useFetchStreams=!0),this.zo(l.initMessageHeaders,t,i),l.encodeInitMessageHeaders=!0;const u=s.join("");Pi(Ic,`Creating RPC '${e}' stream ${r}: ${u}`,l);const d=o.createWebChannel(u,l);this.T_(d);let A=!1,f=!1;const p=new Mie({Ho:v=>{f?Pi(Ic,`Not sending because RPC '${e}' stream ${r} is closed:`,v):(A||(Pi(Ic,`Opening RPC '${e}' stream ${r} transport.`),d.open(),A=!0),Pi(Ic,`RPC '${e}' stream ${r} sending:`,v),d.send(v))},Yo:()=>d.close()}),g=(v,w,m)=>{v.listen(w,(y=>{try{m(y)}catch(x){setTimeout((()=>{throw x}),0)}}))};return g(d,dy.EventType.OPEN,(()=>{f||(Pi(Ic,`RPC '${e}' stream ${r} transport opened.`),p.s_())})),g(d,dy.EventType.CLOSE,(()=>{f||(f=!0,Pi(Ic,`RPC '${e}' stream ${r} transport closed`),p.__(),this.I_(d))})),g(d,dy.EventType.ERROR,(v=>{f||(f=!0,vf(Ic,`RPC '${e}' stream ${r} transport errored. Name:`,v.name,"Message:",v.message),p.__(new vi(_n.UNAVAILABLE,"The operation could not be completed")))})),g(d,dy.EventType.MESSAGE,(v=>{var w;if(!f){const m=v.data[0];$s(!!m,16349);const y=m,x=(y==null?void 0:y.error)||((w=y[0])===null||w===void 0?void 0:w.error);if(x){Pi(Ic,`RPC '${e}' stream ${r} received error:`,x);const S=x.status;let I=(function(b){const D=fl[b];if(D!==void 0)return tW(D)})(S),j=x.message;I===void 0&&(I=_n.INTERNAL,j="Unknown error status: "+S+" with message "+x.message),f=!0,p.__(new vi(I,j)),d.close()}else Pi(Ic,`RPC '${e}' stream ${r} received:`,m),p.a_(m)}})),g(a,fH.STAT_EVENT,(v=>{v.stat===TB.PROXY?Pi(Ic,`RPC '${e}' stream ${r} detected buffering proxy`):v.stat===TB.NOPROXY&&Pi(Ic,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{p.o_()}),0),p}terminate(){this.u_.forEach((e=>e.close())),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter((t=>t===e))}}function WS(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b5(n){return new Wne(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jF{constructor(e,t,i=1e3,r=1.5,s=6e4){this.Fi=e,this.timerId=t,this.d_=i,this.E_=r,this.A_=s,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),i=Math.max(0,Date.now()-this.m_),r=Math.max(0,t-i);r>0&&Pi("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,r,(()=>(this.m_=Date.now(),e()))),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XD="PersistentStream";class gW{constructor(e,t,i,r,s,o,a,l){this.Fi=e,this.w_=i,this.S_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new jF(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,(()=>this.L_())))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===_n.RESOURCE_EXHAUSTED?(wf(t.toString()),wf("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===_n.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.b_===t&&this.W_(i,r)}),(i=>{e((()=>{const r=new vi(_n.UNKNOWN,"Fetching auth token failed: "+i.message);return this.G_(r)}))}))}W_(e,t){const i=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.e_((()=>{i((()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,(()=>(this.x_()&&(this.state=3),Promise.resolve()))),this.listener.e_())))})),this.stream.n_((r=>{i((()=>this.G_(r)))})),this.stream.onMessage((r=>{i((()=>++this.C_==1?this.j_(r):this.onNext(r)))}))}O_(){this.state=5,this.F_.g_((async()=>{this.state=0,this.start()}))}G_(e){return Pi(XD,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget((()=>this.b_===e?t():(Pi(XD,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Uie extends gW{constructor(e,t,i,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=Vne(this.serializer,e),i=(function(s){if(!("targetChange"in s))return _r.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?_r.min():o.readTime?qh(o.readTime):_r.min()})(e);return this.listener.J_(t,i)}H_(e){const t={};t.database=LB(this.serializer),t.addTarget=(function(s,o){let a;const l=o.target;if(a=IB(l)?{documents:Xne(s,l)}:{query:Yne(s,l).Vt},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=rW(s,o.resumeToken);const h=PB(s,o.expectedCount);h!==null&&(a.expectedCount=h)}else if(o.snapshotVersion.compareTo(_r.min())>0){a.readTime=LC(s,o.snapshotVersion.toTimestamp());const h=PB(s,o.expectedCount);h!==null&&(a.expectedCount=h)}return a})(this.serializer,e);const i=qne(this.serializer,e);i&&(t.labels=i),this.k_(t)}Y_(e){const t={};t.database=LB(this.serializer),t.removeTarget=e,this.k_(t)}}class Oie extends gW{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return $s(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,$s(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){$s(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=Gne(e.writeResults,e.commitTime),i=qh(e.commitTime);return this.listener.ta(i,t)}na(){const e={};e.database=LB(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>lW(this.serializer,i)))};this.k_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hie{}class Wie extends Hie{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ra=!1}ia(){if(this.ra)throw new vi(_n.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,r){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Wo(e,NB(t,i),r,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===_n.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new vi(_n.UNKNOWN,s.toString())}))}Jo(e,t,i,r,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,a])=>this.connection.Jo(e,NB(t,i),r,o,a,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===_n.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new vi(_n.UNKNOWN,o.toString())}))}terminate(){this.ra=!0,this.connection.terminate()}}class zie{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve()))))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(wf(t),this._a=!1):Pi("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n0="RemoteStore";class Qie{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=s,this.Ea.xo((o=>{i.enqueueAndForget((async()=>{y0(this)&&(Pi(n0,"Restarting streams for network reachability change."),await(async function(l){const h=Or(l);h.Ia.add(4),await hv(h),h.Aa.set("Unknown"),h.Ia.delete(4),await C5(h)})(this))}))})),this.Aa=new zie(i,r)}}async function C5(n){if(y0(n))for(const e of n.da)await e(!0)}async function hv(n){for(const e of n.da)await e(!1)}function mW(n,e){const t=Or(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),MF(t)?LF(t):C1(t).x_()&&NF(t,e))}function PF(n,e){const t=Or(n),i=C1(t);t.Ta.delete(e),i.x_()&&yW(t,e),t.Ta.size===0&&(i.x_()?i.B_():y0(t)&&t.Aa.set("Unknown"))}function NF(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(_r.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}C1(n).H_(e)}function yW(n,e){n.Ra.$e(e),C1(n).Y_(e)}function LF(n){n.Ra=new Rne({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),C1(n).start(),n.Aa.aa()}function MF(n){return y0(n)&&!C1(n).M_()&&n.Ta.size>0}function y0(n){return Or(n).Ia.size===0}function wW(n){n.Ra=void 0}async function $ie(n){n.Aa.set("Online")}async function Vie(n){n.Ta.forEach(((e,t)=>{NF(n,e)}))}async function Gie(n,e){wW(n),MF(n)?(n.Aa.la(e),LF(n)):n.Aa.set("Unknown")}async function Xie(n,e,t){if(n.Aa.set("Online"),e instanceof iW&&e.state===2&&e.cause)try{await(async function(r,s){const o=s.cause;for(const a of s.targetIds)r.Ta.has(a)&&(await r.remoteSyncer.rejectListen(a,o),r.Ta.delete(a),r.Ra.removeTarget(a))})(n,e)}catch(i){Pi(n0,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await UC(n,i)}else if(e instanceof eC?n.Ra.Ye(e):e instanceof nW?n.Ra.it(e):n.Ra.et(e),!t.isEqual(_r.min()))try{const i=await pW(n.localStore);t.compareTo(i)>=0&&await(function(s,o){const a=s.Ra.Pt(o);return a.targetChanges.forEach(((l,h)=>{if(l.resumeToken.approximateByteSize()>0){const u=s.Ta.get(h);u&&s.Ta.set(h,u.withResumeToken(l.resumeToken,o))}})),a.targetMismatches.forEach(((l,h)=>{const u=s.Ta.get(l);if(!u)return;s.Ta.set(l,u.withResumeToken(Jl.EMPTY_BYTE_STRING,u.snapshotVersion)),yW(s,l);const d=new pp(u.target,l,h,u.sequenceNumber);NF(s,d)})),s.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(i){Pi(n0,"Failed to raise snapshot:",i),await UC(n,i)}}async function UC(n,e,t){if(!b1(e))throw e;n.Ia.add(1),await hv(n),n.Aa.set("Offline"),t||(t=()=>pW(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Pi(n0,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await C5(n)}))}function vW(n,e){return e().catch((t=>UC(n,t,e)))}async function _5(n){const e=Or(n),t=Mp(e);let i=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:vF;for(;Yie(e);)try{const r=await kie(e.localStore,i);if(r===null){e.Pa.length===0&&t.B_();break}i=r.batchId,Kie(e,r)}catch(r){await UC(e,r)}xW(e)&&bW(e)}function Yie(n){return y0(n)&&n.Pa.length<10}function Kie(n,e){n.Pa.push(e);const t=Mp(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function xW(n){return y0(n)&&!Mp(n).M_()&&n.Pa.length>0}function bW(n){Mp(n).start()}async function qie(n){Mp(n).na()}async function Zie(n){const e=Mp(n);for(const t of n.Pa)e.X_(t.mutations)}async function Jie(n,e,t){const i=n.Pa.shift(),r=TF.from(i,e,t);await vW(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await _5(n)}async function ere(n,e){e&&Mp(n).Z_&&await(async function(i,r){if((function(o){return eW(o)&&o!==_n.ABORTED})(r.code)){const s=i.Pa.shift();Mp(i).N_(),await vW(i,(()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r))),await _5(i)}})(n,e),xW(n)&&bW(n)}async function YD(n,e){const t=Or(n);t.asyncQueue.verifyOperationInProgress(),Pi(n0,"RemoteStore received new credentials");const i=y0(t);t.Ia.add(3),await hv(t),i&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await C5(t)}async function tre(n,e){const t=Or(n);e?(t.Ia.delete(2),await C5(t)):e||(t.Ia.add(2),await hv(t),t.Aa.set("Unknown"))}function C1(n){return n.Va||(n.Va=(function(t,i,r){const s=Or(t);return s.ia(),new Uie(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Zo:$ie.bind(null,n),e_:Vie.bind(null,n),n_:Gie.bind(null,n),J_:Xie.bind(null,n)}),n.da.push((async e=>{e?(n.Va.N_(),MF(n)?LF(n):n.Aa.set("Unknown")):(await n.Va.stop(),wW(n))}))),n.Va}function Mp(n){return n.ma||(n.ma=(function(t,i,r){const s=Or(t);return s.ia(),new Oie(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:qie.bind(null,n),n_:ere.bind(null,n),ea:Zie.bind(null,n),ta:Jie.bind(null,n)}),n.da.push((async e=>{e?(n.ma.N_(),await _5(n)):(await n.ma.stop(),n.Pa.length>0&&(Pi(n0,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RF{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new cA,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,a=new RF(e,t,o,r,s);return a.start(i),a}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new vi(_n.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function UF(n,e){if(wf("AsyncQueue",`${e}: ${n}`),b1(n))return new vi(_n.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mm{static emptySet(e){return new Mm(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||lr.comparator(t.key,i.key):(t,i)=>lr.comparator(t.key,i.key),this.keyedMap=Ay(),this.sortedSet=new wa(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Mm)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Mm;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{constructor(){this.fa=new wa(lr.comparator)}track(e){const t=e.doc.key,i=this.fa.get(t);i?e.type!==0&&i.type===3?this.fa=this.fa.insert(t,e):e.type===3&&i.type!==1?this.fa=this.fa.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.fa=this.fa.remove(t):e.type===1&&i.type===2?this.fa=this.fa.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):gr(63341,{At:e,ga:i}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal(((t,i)=>{e.push(i)})),e}}class o1{constructor(e,t,i,r,s,o,a,l,h){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=h}static fromInitialDocuments(e,t,i,r,s){const o=[];return t.forEach((a=>{o.push({type:0,doc:a})})),new o1(e,t,Mm.emptySet(t),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&g5(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nre{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some((e=>e.ba()))}}class ire{constructor(){this.queries=qD(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,i){const r=Or(t),s=r.queries;r.queries=qD(),s.forEach(((o,a)=>{for(const l of a.wa)l.onError(i)}))})(this,new vi(_n.ABORTED,"Firestore shutting down"))}}function qD(){return new m0((n=>OH(n)),g5)}async function OF(n,e){const t=Or(n);let i=3;const r=e.query;let s=t.queries.get(r);s?!s.Sa()&&e.ba()&&(i=2):(s=new nre,i=e.ba()?0:1);try{switch(i){case 0:s.ya=await t.onListen(r,!0);break;case 1:s.ya=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(o){const a=UF(o,`Initialization of query '${am(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,s),s.wa.push(e),e.va(t.onlineState),s.ya&&e.Ca(s.ya)&&WF(t)}async function HF(n,e){const t=Or(n),i=e.query;let r=3;const s=t.queries.get(i);if(s){const o=s.wa.indexOf(e);o>=0&&(s.wa.splice(o,1),s.wa.length===0?r=e.ba()?0:1:!s.Sa()&&e.ba()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function rre(n,e){const t=Or(n);let i=!1;for(const r of e){const s=r.query,o=t.queries.get(s);if(o){for(const a of o.wa)a.Ca(r)&&(i=!0);o.ya=r}}i&&WF(t)}function sre(n,e,t){const i=Or(n),r=i.queries.get(e);if(r)for(const s of r.wa)s.onError(t);i.queries.delete(e)}function WF(n){n.Da.forEach((e=>{e.next()}))}var UB,ZD;(ZD=UB||(UB={})).Fa="default",ZD.Cache="cache";class zF{constructor(e,t,i){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=i||{}}Ca(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)r.type!==3&&i.push(r);e=new o1(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const i=t!=="Offline";return(!this.options.ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=o1.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==UB.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CW{constructor(e){this.key=e}}class _W{constructor(e){this.key=e}}class ore{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=Ds(),this.mutatedKeys=Ds(),this.Xa=HH(e),this.eu=new Mm(this.Xa)}get tu(){return this.Ha}nu(e,t){const i=t?t.ru:new KD,r=t?t.eu:this.eu;let s=t?t.mutatedKeys:this.mutatedKeys,o=r,a=!1;const l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,h=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((u,d)=>{const A=r.get(u),f=m5(this.query,d)?d:null,p=!!A&&this.mutatedKeys.has(A.key),g=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let v=!1;A&&f?A.data.isEqual(f.data)?p!==g&&(i.track({type:3,doc:f}),v=!0):this.iu(A,f)||(i.track({type:2,doc:f}),v=!0,(l&&this.Xa(f,l)>0||h&&this.Xa(f,h)<0)&&(a=!0)):!A&&f?(i.track({type:0,doc:f}),v=!0):A&&!f&&(i.track({type:1,doc:A}),v=!0,(l||h)&&(a=!0)),v&&(f?(o=o.add(f),s=g?s.add(u):s.delete(u)):(o=o.delete(u),s=s.delete(u)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),i.track({type:1,doc:u})}return{eu:o,ru:i,Ds:a,mutatedKeys:s}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){const s=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const o=e.ru.pa();o.sort(((u,d)=>(function(f,p){const g=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return gr(20277,{At:v})}};return g(f)-g(p)})(u.type,d.type)||this.Xa(u.doc,d.doc))),this.su(i),r=r!=null&&r;const a=t&&!r?this.ou():[],l=this.Za.size===0&&this.current&&!r?1:0,h=l!==this.Ya;return this.Ya=l,o.length!==0||h?{snapshot:new o1(this.query,e.eu,s,o,e.mutatedKeys,l===0,h,!1,!!i&&i.resumeToken.approximateByteSize()>0),_u:a}:{_u:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new KD,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach((t=>this.Ha=this.Ha.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ha=this.Ha.delete(t))),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=Ds(),this.eu.forEach((i=>{this.au(i.key)&&(this.Za=this.Za.add(i.key))}));const t=[];return e.forEach((i=>{this.Za.has(i)||t.push(new _W(i))})),this.Za.forEach((i=>{e.has(i)||t.push(new CW(i))})),t}uu(e){this.Ha=e.qs,this.Za=Ds();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return o1.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const QF="SyncEngine";class are{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class lre{constructor(e){this.key=e,this.lu=!1}}class cre{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.hu={},this.Pu=new m0((a=>OH(a)),g5),this.Tu=new Map,this.Iu=new Set,this.du=new wa(lr.comparator),this.Eu=new Map,this.Au=new FF,this.Ru={},this.Vu=new Map,this.mu=s1.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function hre(n,e,t=!0){const i=kW(n);let r;const s=i.Pu.get(e);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.cu()):r=await SW(i,e,t,!0),r}async function ure(n,e){const t=kW(n);await SW(t,e,!0,!1)}async function SW(n,e,t,i){const r=await Iie(n.localStore,hA(e)),s=r.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t);let a;return i&&(a=await dre(n,e,s,o==="current",r.resumeToken)),n.isPrimaryClient&&t&&mW(n.remoteStore,r),a}async function dre(n,e,t,i,r){n.gu=(d,A,f)=>(async function(g,v,w,m){let y=v.view.nu(w);y.Ds&&(y=await QD(g.localStore,v.query,!1).then((({documents:j})=>v.view.nu(j,y))));const x=m&&m.targetChanges.get(v.targetId),S=m&&m.targetMismatches.get(v.targetId)!=null,I=v.view.applyChanges(y,g.isPrimaryClient,x,S);return ej(g,v.targetId,I._u),I.snapshot})(n,d,A,f);const s=await QD(n.localStore,e,!0),o=new ore(e,s.qs),a=o.nu(s.documents),l=cv.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),h=o.applyChanges(a,n.isPrimaryClient,l);ej(n,t,h._u);const u=new are(e,t,o);return n.Pu.set(e,u),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),h.snapshot}async function Are(n,e,t){const i=Or(n),r=i.Pu.get(e),s=i.Tu.get(r.targetId);if(s.length>1)return i.Tu.set(r.targetId,s.filter((o=>!g5(o,e)))),void i.Pu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await MB(i.localStore,r.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(r.targetId),t&&PF(i.remoteStore,r.targetId),OB(i,r.targetId)})).catch(x1)):(OB(i,r.targetId),await MB(i.localStore,r.targetId,!0))}async function fre(n,e){const t=Or(n),i=t.Pu.get(e),r=t.Tu.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),PF(t.remoteStore,i.targetId))}async function pre(n,e,t){const i=bre(n);try{const r=await(function(o,a){const l=Or(o),h=yo.now(),u=a.reduce(((f,p)=>f.add(p.key)),Ds());let d,A;return l.persistence.runTransaction("Locally write mutations","readwrite",(f=>{let p=xf(),g=Ds();return l.Os.getEntries(f,u).next((v=>{p=v,p.forEach(((w,m)=>{m.isValidDocument()||(g=g.add(w))}))})).next((()=>l.localDocuments.getOverlayedDocuments(f,p))).next((v=>{d=v;const w=[];for(const m of a){const y=jne(m,d.get(m.key).overlayedDocument);y!=null&&w.push(new Kp(m.key,y,DH(y.value.mapValue),yc.exists(!0)))}return l.mutationQueue.addMutationBatch(f,h,w,a)})).next((v=>{A=v;const w=v.applyToLocalDocumentSet(d,g);return l.documentOverlayCache.saveOverlays(f,v.batchId,w)}))})).then((()=>({batchId:A.batchId,changes:zH(d)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),(function(o,a,l){let h=o.Ru[o.currentUser.toKey()];h||(h=new wa(ps)),h=h.insert(a,l),o.Ru[o.currentUser.toKey()]=h})(i,r.batchId,t),await uv(i,r.changes),await _5(i.remoteStore)}catch(r){const s=UF(r,"Failed to persist write");t.reject(s)}}async function TW(n,e){const t=Or(n);try{const i=await Eie(t.localStore,e);e.targetChanges.forEach(((r,s)=>{const o=t.Eu.get(s);o&&($s(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.lu=!0:r.modifiedDocuments.size>0?$s(o.lu,14607):r.removedDocuments.size>0&&($s(o.lu,42227),o.lu=!1))})),await uv(t,i,e)}catch(i){await x1(i)}}function JD(n,e,t){const i=Or(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Pu.forEach(((s,o)=>{const a=o.view.va(e);a.snapshot&&r.push(a.snapshot)})),(function(o,a){const l=Or(o);l.onlineState=a;let h=!1;l.queries.forEach(((u,d)=>{for(const A of d.wa)A.va(a)&&(h=!0)})),h&&WF(l)})(i.eventManager,e),r.length&&i.hu.J_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function gre(n,e,t){const i=Or(n);i.sharedClientState.updateQueryState(e,"rejected",t);const r=i.Eu.get(e),s=r&&r.key;if(s){let o=new wa(lr.comparator);o=o.insert(s,Yl.newNoDocument(s,_r.min()));const a=Ds().add(s),l=new x5(_r.min(),new Map,new wa(ps),o,a);await TW(i,l),i.du=i.du.remove(s),i.Eu.delete(e),$F(i)}else await MB(i.localStore,e,!1).then((()=>OB(i,e,t))).catch(x1)}async function mre(n,e){const t=Or(n),i=e.batch.batchId;try{const r=await Bie(t.localStore,e);EW(t,i,null),BW(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await uv(t,r)}catch(r){await x1(r)}}async function yre(n,e,t){const i=Or(n);try{const r=await(function(o,a){const l=Or(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let u;return l.mutationQueue.lookupMutationBatch(h,a).next((d=>($s(d!==null,37113),u=d.keys(),l.mutationQueue.removeMutationBatch(h,d)))).next((()=>l.mutationQueue.performConsistencyCheck(h))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(h,u,a))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,u))).next((()=>l.localDocuments.getDocuments(h,u)))}))})(i.localStore,e);EW(i,e,t),BW(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await uv(i,r)}catch(r){await x1(r)}}function BW(n,e){(n.Vu.get(e)||[]).forEach((t=>{t.resolve()})),n.Vu.delete(e)}function EW(n,e,t){const i=Or(n);let r=i.Ru[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Ru[i.currentUser.toKey()]=r}}function OB(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Tu.get(e))n.Pu.delete(i),t&&n.hu.pu(i,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach((i=>{n.Au.containsKey(i)||FW(n,i)}))}function FW(n,e){n.Iu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(PF(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),$F(n))}function ej(n,e,t){for(const i of t)i instanceof CW?(n.Au.addReference(i.key,e),wre(n,i)):i instanceof _W?(Pi(QF,"Document no longer in limbo: "+i.key),n.Au.removeReference(i.key,e),n.Au.containsKey(i.key)||FW(n,i.key)):gr(19791,{yu:i})}function wre(n,e){const t=e.key,i=t.path.canonicalString();n.du.get(t)||n.Iu.has(i)||(Pi(QF,"New document in limbo: "+t),n.Iu.add(i),$F(n))}function $F(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Iu.values().next().value;n.Iu.delete(e);const t=new lr(mo.fromString(e)),i=n.mu.next();n.Eu.set(i,new lre(t)),n.du=n.du.insert(t,i),mW(n.remoteStore,new pp(hA(p5(t.path)),i,"TargetPurposeLimboResolution",A5.ue))}}async function uv(n,e,t){const i=Or(n),r=[],s=[],o=[];i.Pu.isEmpty()||(i.Pu.forEach(((a,l)=>{o.push(i.gu(l,e,t).then((h=>{var u;if((h||t)&&i.isPrimaryClient){const d=h?!h.fromCache:(u=t==null?void 0:t.targetChanges.get(l.targetId))===null||u===void 0?void 0:u.current;i.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(h){r.push(h);const d=IF.Es(l.targetId,h);s.push(d)}})))})),await Promise.all(o),i.hu.J_(r),await(async function(l,h){const u=Or(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",(d=>Pn.forEach(h,(A=>Pn.forEach(A.Is,(f=>u.persistence.referenceDelegate.addReference(d,A.targetId,f))).next((()=>Pn.forEach(A.ds,(f=>u.persistence.referenceDelegate.removeReference(d,A.targetId,f)))))))))}catch(d){if(!b1(d))throw d;Pi(DF,"Failed to update sequence numbers: "+d)}for(const d of h){const A=d.targetId;if(!d.fromCache){const f=u.Fs.get(A),p=f.snapshotVersion,g=f.withLastLimboFreeSnapshotVersion(p);u.Fs=u.Fs.insert(A,g)}}})(i.localStore,s))}async function vre(n,e){const t=Or(n);if(!t.currentUser.isEqual(e)){Pi(QF,"User change. New user:",e.toKey());const i=await fW(t.localStore,e);t.currentUser=e,(function(s,o){s.Vu.forEach((a=>{a.forEach((l=>{l.reject(new vi(_n.CANCELLED,o))}))})),s.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await uv(t,i.Bs)}}function xre(n,e){const t=Or(n),i=t.Eu.get(e);if(i&&i.lu)return Ds().add(i.key);{let r=Ds();const s=t.Tu.get(e);if(!s)return r;for(const o of s){const a=t.Pu.get(o);r=r.unionWith(a.view.tu)}return r}}function kW(n){const e=Or(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=TW.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=xre.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=gre.bind(null,e),e.hu.J_=rre.bind(null,e.eventManager),e.hu.pu=sre.bind(null,e.eventManager),e}function bre(n){const e=Or(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=mre.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=yre.bind(null,e),e}class OC{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=b5(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return Tie(this.persistence,new Cie,e.initialUser,this.serializer)}Du(e){return new AW(kF.Vi,this.serializer)}bu(e){return new jie}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}OC.provider={build:()=>new OC};class Cre extends OC{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){$s(this.persistence.referenceDelegate instanceof RC,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new lie(i,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?Eh.withCacheSize(this.cacheSizeBytes):Eh.DEFAULT;return new AW((i=>RC.Vi(i,t)),this.serializer)}}class HB{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>JD(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=vre.bind(null,this.syncEngine),await tre(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new ire})()}createDatastore(e){const t=b5(e.databaseInfo.databaseId),i=(function(s){return new Rie(s)})(e.databaseInfo);return(function(s,o,a,l){return new Wie(s,o,a,l)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,s,o,a){return new Qie(i,r,s,o,a)})(this.localStore,this.datastore,e.asyncQueue,(t=>JD(this.syncEngine,t,0)),(function(){return GD.C()?new GD:new Pie})())}createSyncEngine(e,t){return(function(r,s,o,a,l,h,u){const d=new cre(r,s,o,a,l,h);return u&&(d.fu=!0),d})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(r){const s=Or(r);Pi(n0,"RemoteStore shutting down."),s.Ia.add(5),await hv(s),s.Ea.shutdown(),s.Aa.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}HB.provider={build:()=>new HB};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VF{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):wf("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _re{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new vi(_n.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(r,s){const o=Or(r),a={documents:s.map((d=>MC(o.serializer,d)))},l=await o.Jo("BatchGetDocuments",o.serializer.databaseId,mo.emptyPath(),a,s.length),h=new Map;l.forEach((d=>{const A=$ne(o.serializer,d);h.set(A.key.toString(),A)}));const u=[];return s.forEach((d=>{const A=h.get(d.toString());$s(!!A,55234,{key:d}),u.push(A)})),u})(this.datastore,e);return t.forEach((i=>this.recordVersion(i))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new v5(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,i)=>{const r=lr.fromPath(i);this.mutations.push(new JH(r,this.precondition(r)))})),await(async function(i,r){const s=Or(i),o={writes:r.map((a=>lW(s.serializer,a)))};await s.Wo("Commit",s.serializer.databaseId,mo.emptyPath(),o)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw gr(50498,{Wu:e.constructor.name});t=_r.min()}const i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new vi(_n.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(_r.min())?yc.exists(!1):yc.updateTime(t):yc.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(_r.min()))throw new vi(_n.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return yc.updateTime(t)}return yc.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sre{constructor(e,t,i,r,s){this.asyncQueue=e,this.datastore=t,this.options=i,this.updateFunction=r,this.deferred=s,this.Gu=i.maxAttempts,this.F_=new jF(this.asyncQueue,"transaction_retry")}zu(){this.Gu-=1,this.ju()}ju(){this.F_.g_((async()=>{const e=new _re(this.datastore),t=this.Ju(e);t&&t.then((i=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(i)})).catch((r=>{this.Hu(r)}))))})).catch((i=>{this.Hu(i)}))}))}Ju(e){try{const t=this.updateFunction(e);return!av(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Hu(e){this.Gu>0&&this.Yu(e)?(this.Gu-=1,this.asyncQueue.enqueueAndForget((()=>(this.ju(),Promise.resolve())))):this.deferred.reject(e)}Yu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!eW(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rp="FirestoreClient";class Tre{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=Uc.UNAUTHENTICATED,this.clientId=u5.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,(async o=>{Pi(Rp,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,(o=>(Pi(Rp,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new cA;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=UF(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function zS(n,e){n.asyncQueue.verifyOperationInProgress(),Pi(Rp,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async r=>{i.isEqual(r)||(await fW(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener((()=>{vf("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then((()=>{Pi("Terminating Firestore due to IndexedDb database deletion completed successfully")})).catch((r=>{vf("Terminating Firestore due to IndexedDb database deletion failed",r)}))})),n._offlineComponents=e}async function tj(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Bre(n);Pi(Rp,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>YD(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,r)=>YD(e.remoteStore,r))),n._onlineComponents=e}async function Bre(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Pi(Rp,"Using user provided OfflineComponentProvider");try{await zS(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===_n.FAILED_PRECONDITION||r.code===_n.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;vf("Error using user provided cache. Falling back to memory cache: "+t),await zS(n,new OC)}}else Pi(Rp,"Using default OfflineComponentProvider"),await zS(n,new Cre(void 0));return n._offlineComponents}async function GF(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Pi(Rp,"Using user provided OnlineComponentProvider"),await tj(n,n._uninitializedComponentsProvider._online)):(Pi(Rp,"Using default OnlineComponentProvider"),await tj(n,new HB))),n._onlineComponents}function Ere(n){return GF(n).then((e=>e.syncEngine))}function Fre(n){return GF(n).then((e=>e.datastore))}async function HC(n){const e=await GF(n),t=e.eventManager;return t.onListen=hre.bind(null,e.syncEngine),t.onUnlisten=Are.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=ure.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=fre.bind(null,e.syncEngine),t}function IW(n,e,t={}){const i=new cA;return n.asyncQueue.enqueueAndForget((async()=>(function(s,o,a,l,h){const u=new VF({next:A=>{u.Ou(),o.enqueueAndForget((()=>HF(s,d)));const f=A.docs.has(a);!f&&A.fromCache?h.reject(new vi(_n.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&A.fromCache&&l&&l.source==="server"?h.reject(new vi(_n.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(A)},error:A=>h.reject(A)}),d=new zF(p5(a.path),u,{includeMetadataChanges:!0,ka:!0});return OF(s,d)})(await HC(n),n.asyncQueue,e,t,i))),i.promise}function DW(n,e,t={}){const i=new cA;return n.asyncQueue.enqueueAndForget((async()=>(function(s,o,a,l,h){const u=new VF({next:A=>{u.Ou(),o.enqueueAndForget((()=>HF(s,d))),A.fromCache&&l.source==="server"?h.reject(new vi(_n.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(A)},error:A=>h.reject(A)}),d=new zF(a,u,{includeMetadataChanges:!0,ka:!0});return OF(s,d)})(await HC(n),n.asyncQueue,e,t,i))),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jW(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nj=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PW="firestore.googleapis.com",ij=!0;class rj{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new vi(_n.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=PW,this.ssl=ij}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:ij;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=dW;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<oie)throw new vi(_n.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}xH("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=jW((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new vi(_n.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new vi(_n.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new vi(_n.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class dv{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new rj({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new vi(_n.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new vi(_n.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new rj(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new wH;switch(i.type){case"firstParty":return new zte(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new vi(_n.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=nj.get(t);i&&(Pi("ComponentProvider","Removing Datastore"),nj.delete(t),i.terminate())})(this),Promise.resolve()}}function NW(n,e,t,i={}){var r;n=cl(n,dv);const s=Gp(e),o=n._getSettings(),a=Object.assign(Object.assign({},o),{emulatorOptions:n._getEmulatorOptions()}),l=`${e}:${t}`;s&&(nF(`https://${l}`),iF("Firestore",!0)),o.host!==PW&&o.host!==l&&vf("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h=Object.assign(Object.assign({},o),{host:l,ssl:s,emulatorOptions:i});if(!kp(h,a)&&(n._setSettings(h),i.mockUserToken)){let u,d;if(typeof i.mockUserToken=="string")u=i.mockUserToken,d=Uc.MOCK_USER;else{u=oO(i.mockUserToken,(r=n._app)===null||r===void 0?void 0:r.options.projectId);const A=i.mockUserToken.sub||i.mockUserToken.user_id;if(!A)throw new vi(_n.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Uc(A)}n._authCredentials=new Ote(new yH(u,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Fd(this.firestore,e,this._query)}}class na{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new uf(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new na(this.firestore,e,this._key)}toJSON(){return{type:na._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(ov(t,na._jsonSchema))return new na(e,i||null,new lr(mo.fromString(t.referencePath)))}}na._jsonSchemaVersion="firestore/documentReference/1.0",na._jsonSchema={type:vl("string",na._jsonSchemaVersion),referencePath:vl("string")};class uf extends Fd{constructor(e,t,i){super(e,t,p5(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new na(this.firestore,null,new lr(e))}withConverter(e){return new uf(this.firestore,e,this._path)}}function jl(n,e,...t){if(n=Uo(n),wF("collection","path",e),n instanceof dv){const i=mo.fromString(e,...t);return mD(i),new uf(n,null,i)}{if(!(n instanceof na||n instanceof uf))throw new vi(_n.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(mo.fromString(e,...t));return mD(i),new uf(n.firestore,null,i)}}function LW(n,e){if(n=cl(n,dv),wF("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new vi(_n.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Fd(n,null,(function(i){return new g0(mo.emptyPath(),i)})(e))}function ts(n,e,...t){if(n=Uo(n),arguments.length===1&&(e=u5.newId()),wF("doc","path",e),n instanceof dv){const i=mo.fromString(e,...t);return gD(i),new na(n,null,new lr(i))}{if(!(n instanceof na||n instanceof uf))throw new vi(_n.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(mo.fromString(e,...t));return gD(i),new na(n.firestore,n instanceof uf?n.converter:null,new lr(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sj="AsyncQueue";class oj{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new jF(this,"async_queue_retry"),this.oc=()=>{const i=WS();i&&Pi(sj,"Visibility state changed to "+i.visibilityState),this.F_.y_()},this._c=e;const t=WS();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=WS();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise((()=>{}));const t=new cA;return this.uc((()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Zu.push(e),this.cc())))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!b1(e))throw e;Pi(sj,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_((()=>this.cc()))}}uc(e){const t=this._c.then((()=>(this.nc=!0,e().catch((i=>{throw this.tc=i,this.nc=!1,wf("INTERNAL UNHANDLED ERROR: ",aj(i)),i})).then((i=>(this.nc=!1,i))))));return this._c=t,t}enqueueAfterDelay(e,t,i){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const r=RF.createAndSchedule(this,e,t,i,(s=>this.lc(s)));return this.ec.push(r),r}ac(){this.tc&&gr(47125,{hc:aj(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then((()=>{this.ec.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()}))}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function aj(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lj(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const r=t;for(const s of i)if(s in r&&typeof r[s]=="function")return!0;return!1})(n,["next","error","complete"])}class eu extends dv{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new oj,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new oj(e),this._firestoreClient=void 0,await e}}}function MW(n,e){const t=typeof n=="object"?n:oF(),i=typeof n=="string"?n:DC,r=i5(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=iO("firestore");s&&NW(r,...s)}return r}function qp(n){if(n._terminated)throw new vi(_n.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||kre(n),n._firestoreClient}function kre(n){var e,t,i;const r=n._freezeSettings(),s=(function(a,l,h,u){return new rne(a,l,h,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,jW(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,r);n._componentsProvider||!((t=r.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=r.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),n._firestoreClient=new Tre(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&(function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh{constructor(e){this._byteString=e}static fromBase64String(e){try{return new kh(Jl.fromBase64String(e))}catch(t){throw new vi(_n.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new kh(Jl.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:kh._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ov(e,kh._jsonSchema))return kh.fromBase64String(e.bytes)}}kh._jsonSchemaVersion="firestore/bytes/1.0",kh._jsonSchema={type:vl("string",kh._jsonSchemaVersion),bytes:vl("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _1{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new vi(_n.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Kl(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S1{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new vi(_n.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new vi(_n.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ps(this._lat,e._lat)||ps(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:yd._jsonSchemaVersion}}static fromJSON(e){if(ov(e,yd._jsonSchema))return new yd(e.latitude,e.longitude)}}yd._jsonSchemaVersion="firestore/geoPoint/1.0",yd._jsonSchema={type:vl("string",yd._jsonSchemaVersion),latitude:vl("number"),longitude:vl("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:wd._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ov(e,wd._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new wd(e.vectorValues);throw new vi(_n.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}wd._jsonSchemaVersion="firestore/vectorValue/1.0",wd._jsonSchema={type:vl("string",wd._jsonSchemaVersion),vectorValues:vl("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ire=/^__.*__$/;class Dre{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Kp(e,this.data,this.fieldMask,t,this.fieldTransforms):new lv(e,this.data,t,this.fieldTransforms)}}class RW{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Kp(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function UW(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw gr(40011,{Ec:n})}}class S5{constructor(e,t,i,r,s,o){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.Ac(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new S5(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.Rc({path:i,mc:!1});return r.fc(e),r}gc(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.Rc({path:i,mc:!1});return r.Ac(),r}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return WC(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(UW(this.Ec)&&Ire.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class jre{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||b5(e)}Dc(e,t,i,r=!1){return new S5({Ec:e,methodName:t,bc:i,path:Kl.emptyPath(),mc:!1,Sc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Av(n){const e=n._freezeSettings(),t=b5(n._databaseId);return new jre(n._databaseId,!!e.ignoreUndefinedProperties,t)}function XF(n,e,t,i,r,s={}){const o=n.Dc(s.merge||s.mergeFields?2:0,e,t,r);qF("Data must be an object, but it was:",o,i);const a=WW(i,o);let l,h;if(s.merge)l=new Xh(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){const u=[];for(const d of s.mergeFields){const A=WB(e,d,t);if(!o.contains(A))throw new vi(_n.INVALID_ARGUMENT,`Field '${A}' is specified in your field mask but missing from your input data.`);QW(u,A)||u.push(A)}l=new Xh(u),h=o.fieldTransforms.filter((d=>l.covers(d.field)))}else l=null,h=o.fieldTransforms;return new Dre(new lh(a),l,h)}class T5 extends S1{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof T5}}function Pre(n,e,t){return new S5({Ec:3,bc:e.settings.bc,methodName:n._methodName,mc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class YF extends S1{_toFieldTransform(e){return new KH(e.path,new _w)}isEqual(e){return e instanceof YF}}class KF extends S1{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=Pre(this,e,!0),i=this.vc.map((s=>T1(s,t))),r=new r1(i);return new KH(e.path,r)}isEqual(e){return e instanceof KF&&kp(this.vc,e.vc)}}function OW(n,e,t,i){const r=n.Dc(1,e,t);qF("Data must be an object, but it was:",r,i);const s=[],o=lh.empty();Yp(i,((l,h)=>{const u=ZF(e,l,t);h=Uo(h);const d=r.gc(u);if(h instanceof T5)s.push(u);else{const A=T1(h,d);A!=null&&(s.push(u),o.set(u,A))}}));const a=new Xh(s);return new RW(o,a,r.fieldTransforms)}function HW(n,e,t,i,r,s){const o=n.Dc(1,e,t),a=[WB(e,i,t)],l=[r];if(s.length%2!=0)throw new vi(_n.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let A=0;A<s.length;A+=2)a.push(WB(e,s[A])),l.push(s[A+1]);const h=[],u=lh.empty();for(let A=a.length-1;A>=0;--A)if(!QW(h,a[A])){const f=a[A];let p=l[A];p=Uo(p);const g=o.gc(f);if(p instanceof T5)h.push(f);else{const v=T1(p,g);v!=null&&(h.push(f),u.set(f,v))}}const d=new Xh(h);return new RW(u,d,o.fieldTransforms)}function Nre(n,e,t,i=!1){return T1(t,n.Dc(i?4:3,e))}function T1(n,e){if(zW(n=Uo(n)))return qF("Unsupported field value:",e,n),WW(n,e);if(n instanceof S1)return(function(i,r){if(!UW(r.Ec))throw r.wc(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.wc(`${i._methodName}() is not currently supported inside arrays`);const s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(i,r){const s=[];let o=0;for(const a of i){let l=T1(a,r.yc(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}})(n,e)}return(function(i,r){if((i=Uo(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return Bne(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const s=yo.fromDate(i);return{timestampValue:LC(r.serializer,s)}}if(i instanceof yo){const s=new yo(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:LC(r.serializer,s)}}if(i instanceof yd)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof kh)return{bytesValue:rW(r.serializer,i._byteString)};if(i instanceof na){const s=r.databaseId,o=i.firestore._databaseId;if(!o.isEqual(s))throw r.wc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:EF(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof wd)return(function(o,a){return{mapValue:{fields:{[kH]:{stringValue:IH},[jC]:{arrayValue:{values:o.toArray().map((h=>{if(typeof h!="number")throw a.wc("VectorValues must only contain numeric values.");return SF(a.serializer,h)}))}}}}}})(i,r);throw r.wc(`Unsupported field value: ${d5(i)}`)})(n,e)}function WW(n,e){const t={};return _H(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Yp(n,((i,r)=>{const s=T1(r,e.Vc(i));s!=null&&(t[i]=s)})),{mapValue:{fields:t}}}function zW(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof yo||n instanceof yd||n instanceof kh||n instanceof na||n instanceof S1||n instanceof wd)}function qF(n,e,t){if(!zW(t)||!bH(t)){const i=d5(t);throw i==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+i)}}function WB(n,e,t){if((e=Uo(e))instanceof _1)return e._internalPath;if(typeof e=="string")return ZF(n,e);throw WC("Field path arguments must be of type string or ",n,!1,void 0,t)}const Lre=new RegExp("[~\\*/\\[\\]]");function ZF(n,e,t){if(e.search(Lre)>=0)throw WC(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new _1(...e.split("."))._internalPath}catch{throw WC(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function WC(n,e,t,i,r){const s=i&&!i.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${i}`),o&&(l+=` in document ${r}`),l+=")"),new vi(_n.INVALID_ARGUMENT,a+n+l)}function QW(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zC{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new na(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Mre(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(B5("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Mre extends zC{data(){return super.data()}}function B5(n,e){return typeof e=="string"?ZF(n,e):e instanceof _1?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $W(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new vi(_n.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class JF{}class ek extends JF{}function ru(n,e,...t){let i=[];e instanceof JF&&i.push(e),i=i.concat(t),(function(s){const o=s.filter((l=>l instanceof E5)).length,a=s.filter((l=>l instanceof fv)).length;if(o>1||o>0&&a>0)throw new vi(_n.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const r of i)n=r._apply(n);return n}class fv extends ek{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new fv(e,t,i)}_apply(e){const t=this._parse(e);return VW(e._query,t),new Fd(e.firestore,e.converter,DB(e._query,t))}_parse(e){const t=Av(e.firestore);return(function(s,o,a,l,h,u,d){let A;if(h.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new vi(_n.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){hj(d,u);const p=[];for(const g of d)p.push(cj(l,s,g));A={arrayValue:{values:p}}}else A=cj(l,s,d)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||hj(d,u),A=Nre(a,o,d,u==="in"||u==="not-in");return wl.create(h,u,A)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function xl(n,e,t){const i=e,r=B5("where",n);return fv._create(r,i,t)}class E5 extends JF{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new E5(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:xd.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(r,s){let o=r;const a=s.getFlattenedFilters();for(const l of a)VW(o,l),o=DB(o,l)})(e._query,t),new Fd(e.firestore,e.converter,DB(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class F5 extends ek{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new F5(e,t)}_apply(e){const t=(function(r,s,o){if(r.startAt!==null)throw new vi(_n.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new vi(_n.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Cw(s,o)})(e._query,this._field,this._direction);return new Fd(e.firestore,e.converter,(function(r,s){const o=r.explicitOrderBy.concat([s]);return new g0(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)})(e._query,t))}}function w0(n,e="asc"){const t=e,i=B5("orderBy",n);return F5._create(i,t)}function cj(n,e,t){if(typeof(t=Uo(t))=="string"){if(t==="")throw new vi(_n.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!UH(e)&&t.indexOf("/")!==-1)throw new vi(_n.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(mo.fromString(t));if(!lr.isDocumentKey(i))throw new vi(_n.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return SD(n,new lr(i))}if(t instanceof na)return SD(n,t._key);throw new vi(_n.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${d5(t)}.`)}function hj(n,e){if(!Array.isArray(n)||n.length===0)throw new vi(_n.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function VW(n,e){const t=(function(r,s){for(const o of r)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new vi(_n.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new vi(_n.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class tk{convertValue(e,t="none"){switch(Lp(e)){case 0:return null;case 1:return e.booleanValue;case 2:return nl(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Np(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw gr(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Yp(e,((r,s)=>{i[r]=this.convertValue(s,t)})),i}convertVectorValue(e){var t,i,r;const s=(r=(i=(t=e.fields)===null||t===void 0?void 0:t[jC].arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.map((o=>nl(o.doubleValue)));return new wd(s)}convertGeoPoint(e){return new yd(nl(e.latitude),nl(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=f5(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(xw(e));default:return null}}convertTimestamp(e){const t=Pp(e);return new yo(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=mo.fromString(e);$s(uW(i),9688,{name:e});const r=new t1(i.get(1),i.get(3)),s=new lr(i.popFirst(5));return r.isEqual(t)||wf(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nk(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class Rre extends tk{constructor(e){super(),this.firestore=e}convertBytes(e){return new kh(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new na(this.firestore,null,t)}}class Pg{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class df extends zC{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Hy(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(B5("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new vi(_n.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=df._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}df._jsonSchemaVersion="firestore/documentSnapshot/1.0",df._jsonSchema={type:vl("string",df._jsonSchemaVersion),bundleSource:vl("string","DocumentSnapshot"),bundleName:vl("string"),bundle:vl("string")};class Hy extends df{data(e={}){return super.data(e)}}class Af{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Pg(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Hy(this._firestore,this._userDataWriter,i.key,i,new Pg(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new vi(_n.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map((a=>{const l=new Hy(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Pg(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((a=>s||a.type!==3)).map((a=>{const l=new Hy(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Pg(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,u=-1;return a.type!==0&&(h=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:Ure(a.type),doc:l,oldIndex:h,newIndex:u}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new vi(_n.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Af._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=u5.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Ure(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return gr(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ru(n){n=cl(n,na);const e=cl(n.firestore,eu);return IW(qp(e),n._key).then((t=>rk(e,n,t)))}Af._jsonSchemaVersion="firestore/querySnapshot/1.0",Af._jsonSchema={type:vl("string",Af._jsonSchemaVersion),bundleSource:vl("string","QuerySnapshot"),bundleName:vl("string"),bundle:vl("string")};class pv extends tk{constructor(e){super(),this.firestore=e}convertBytes(e){return new kh(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new na(this.firestore,null,t)}}function vc(n){n=cl(n,na);const e=cl(n.firestore,eu);return IW(qp(e),n._key,{source:"server"}).then((t=>rk(e,n,t)))}function kd(n){n=cl(n,Fd);const e=cl(n.firestore,eu),t=qp(e),i=new pv(e);return $W(n._query),DW(t,n._query).then((r=>new Af(e,i,n,r)))}function GW(n){n=cl(n,Fd);const e=cl(n.firestore,eu),t=qp(e),i=new pv(e);return DW(t,n._query,{source:"server"}).then((r=>new Af(e,i,n,r)))}function i0(n,e,t){n=cl(n,na);const i=cl(n.firestore,eu),r=nk(n.converter,e,t);return mv(i,[XF(Av(i),"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,yc.none())])}function ql(n,e,t,...i){n=cl(n,na);const r=cl(n.firestore,eu),s=Av(r);let o;return o=typeof(e=Uo(e))=="string"||e instanceof _1?HW(s,"updateDoc",n._key,e,t,i):OW(s,"updateDoc",n._key,e),mv(r,[o.toMutation(n._key,yc.exists(!0))])}function QC(n){return mv(cl(n.firestore,eu),[new v5(n._key,yc.none())])}function gv(n,e){const t=cl(n.firestore,eu),i=ts(n),r=nk(n.converter,e);return mv(t,[XF(Av(n.firestore),"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,yc.exists(!1))]).then((()=>i))}function ik(n,...e){var t,i,r;n=Uo(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||lj(e[o])||(s=e[o++]);const a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(lj(e[o])){const d=e[o];e[o]=(t=d.next)===null||t===void 0?void 0:t.bind(d),e[o+1]=(i=d.error)===null||i===void 0?void 0:i.bind(d),e[o+2]=(r=d.complete)===null||r===void 0?void 0:r.bind(d)}let l,h,u;if(n instanceof na)h=cl(n.firestore,eu),u=p5(n._key.path),l={next:d=>{e[o]&&e[o](rk(h,n,d))},error:e[o+1],complete:e[o+2]};else{const d=cl(n,Fd);h=cl(d.firestore,eu),u=d._query;const A=new pv(h);l={next:f=>{e[o]&&e[o](new Af(h,A,d,f))},error:e[o+1],complete:e[o+2]},$W(n._query)}return(function(A,f,p,g){const v=new VF(g),w=new zF(f,v,p);return A.asyncQueue.enqueueAndForget((async()=>OF(await HC(A),w))),()=>{v.Ou(),A.asyncQueue.enqueueAndForget((async()=>HF(await HC(A),w)))}})(qp(h),u,a,l)}function mv(n,e){return(function(i,r){const s=new cA;return i.asyncQueue.enqueueAndForget((async()=>pre(await Ere(i),r,s))),s.promise})(qp(n),e)}function rk(n,e,t){const i=t.docs.get(e._key),r=new pv(n);return new df(n,r,e._key,i,new Pg(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ore={maxAttempts:5};function py(n,e){if((n=Uo(n)).firestore!==e)throw new vi(_n.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hre{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Av(e)}get(e){const t=py(e,this._firestore),i=new Rre(this._firestore);return this._transaction.lookup([t._key]).then((r=>{if(!r||r.length!==1)return gr(24041);const s=r[0];if(s.isFoundDocument())return new zC(this._firestore,i,s.key,s,t.converter);if(s.isNoDocument())return new zC(this._firestore,i,t._key,null,t.converter);throw gr(18433,{doc:s})}))}set(e,t,i){const r=py(e,this._firestore),s=nk(r.converter,t,i),o=XF(this._dataReader,"Transaction.set",r._key,s,r.converter!==null,i);return this._transaction.set(r._key,o),this}update(e,t,i,...r){const s=py(e,this._firestore);let o;return o=typeof(t=Uo(t))=="string"||t instanceof _1?HW(this._dataReader,"Transaction.update",s._key,t,i,r):OW(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,o),this}delete(e){const t=py(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XW extends Hre{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=py(e,this._firestore),i=new pv(this._firestore);return super.get(e).then((r=>new df(this._firestore,i,t._key,r._document,new Pg(!1,!1),t.converter)))}}function YW(n,e,t){n=cl(n,eu);const i=Object.assign(Object.assign({},Ore),t);return(function(s){if(s.maxAttempts<1)throw new vi(_n.INVALID_ARGUMENT,"Max attempts must be at least 1")})(i),(function(s,o,a){const l=new cA;return s.asyncQueue.enqueueAndForget((async()=>{const h=await Fre(s);new Sre(s.asyncQueue,h,a,o,l).zu()})),l.promise})(qp(n),(r=>e(new XW(n,r))),i)}function Lo(){return new YF("serverTimestamp")}function KW(...n){return new KF("arrayUnion",n)}(function(e,t=!0){(function(r){v1=r})(f0),Jg(new Ip("firestore",((i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),a=new eu(new Hte(i.getProvider("auth-internal")),new Qte(o,i.getProvider("app-check-internal")),(function(h,u){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new vi(_n.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new t1(h.options.projectId,u)})(o,r),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a}),"PUBLIC").setMultipleInstances(!0)),oA(uD,dD,e),oA(uD,dD,"esm2017")})();const Wre=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:tk,Bytes:kh,CollectionReference:uf,DocumentReference:na,DocumentSnapshot:df,FieldPath:_1,FieldValue:S1,Firestore:eu,FirestoreError:vi,GeoPoint:yd,Query:Fd,QueryCompositeFilterConstraint:E5,QueryConstraint:ek,QueryDocumentSnapshot:Hy,QueryFieldFilterConstraint:fv,QueryOrderByConstraint:F5,QuerySnapshot:Af,SnapshotMetadata:Pg,Timestamp:yo,Transaction:XW,VectorValue:wd,_AutoId:u5,_ByteString:Jl,_DatabaseId:t1,_DocumentKey:lr,_EmptyAuthCredentialsProvider:wH,_FieldPath:Kl,_cast:cl,_logWarn:vf,_validateIsNotUsedTogether:xH,addDoc:gv,arrayUnion:KW,collection:jl,collectionGroup:LW,connectFirestoreEmulator:NW,deleteDoc:QC,doc:ts,ensureFirestoreConfigured:qp,executeWrite:mv,getDoc:Ru,getDocFromServer:vc,getDocs:kd,getDocsFromServer:GW,getFirestore:MW,onSnapshot:ik,orderBy:w0,query:ru,runTransaction:YW,serverTimestamp:Lo,setDoc:i0,updateDoc:ql,where:xl},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qW="firebasestorage.googleapis.com",ZW="storageBucket",zre=120*1e3,Qre=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra extends Ed{constructor(e,t,i=0){super(QS(e),`Firebase Storage: ${t} (${QS(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ra.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return QS(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ma;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ma||(Ma={}));function QS(n){return"storage/"+n}function sk(){const n="An unknown error occurred, please check the error payload for server response.";return new Ra(Ma.UNKNOWN,n)}function $re(n){return new Ra(Ma.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function Vre(n){return new Ra(Ma.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Gre(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Ra(Ma.UNAUTHENTICATED,n)}function Xre(){return new Ra(Ma.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Yre(n){return new Ra(Ma.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function Kre(){return new Ra(Ma.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function qre(){return new Ra(Ma.CANCELED,"User canceled the upload/download.")}function Zre(n){return new Ra(Ma.INVALID_URL,"Invalid URL '"+n+"'.")}function Jre(n){return new Ra(Ma.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function ese(){return new Ra(Ma.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+ZW+"' property when initializing the app?")}function tse(){return new Ra(Ma.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function nse(){return new Ra(Ma.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function ise(n){return new Ra(Ma.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function zB(n){return new Ra(Ma.INVALID_ARGUMENT,n)}function JW(){return new Ra(Ma.APP_DELETED,"The Firebase app was deleted.")}function rse(n){return new Ra(Ma.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Wy(n,e){return new Ra(Ma.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function J1(n){throw new Ra(Ma.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=Yh.makeFromUrl(e,t)}catch{return new Yh(e,"")}if(i.path==="")return i;throw Jre(e)}static makeFromUrl(e,t){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(x){x.path.charAt(x.path.length-1)==="/"&&(x.path_=x.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),l={bucket:1,path:3};function h(x){x.path_=decodeURIComponent(x.path)}const u="v[A-Za-z0-9_]+",d=t.replace(/[.]/g,"\\."),A="(/([^?#]*).*)?$",f=new RegExp(`^https?://${d}/${u}/b/${r}/o${A}`,"i"),p={bucket:1,path:3},g=t===qW?"(?:storage.googleapis.com|storage.cloud.google.com)":t,v="([^?#]*)",w=new RegExp(`^https?://${g}/${r}/${v}`,"i"),y=[{regex:a,indices:l,postModify:s},{regex:f,indices:p,postModify:h},{regex:w,indices:{bucket:1,path:2},postModify:h}];for(let x=0;x<y.length;x++){const S=y[x],I=S.regex.exec(e);if(I){const j=I[S.indices.bucket];let C=I[S.indices.path];C||(C=""),i=new Yh(j,C),S.postModify(i);break}}if(i==null)throw Zre(e);return i}}class sse{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ose(n,e,t){let i=1,r=null,s=null,o=!1,a=0;function l(){return a===2}let h=!1;function u(...v){h||(h=!0,e.apply(null,v))}function d(v){r=setTimeout(()=>{r=null,n(f,l())},v)}function A(){s&&clearTimeout(s)}function f(v,...w){if(h){A();return}if(v){A(),u.call(null,v,...w);return}if(l()||o){A(),u.call(null,v,...w);return}i<64&&(i*=2);let y;a===1?(a=2,y=0):y=(i+Math.random())*1e3,d(y)}let p=!1;function g(v){p||(p=!0,A(),!h&&(r!==null?(v||(a=2),clearTimeout(r),d(0)):v||(a=1)))}return d(0),s=setTimeout(()=>{o=!0,g(!0)},t),g}function ase(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lse(n){return n!==void 0}function cse(n){return typeof n=="object"&&!Array.isArray(n)}function ok(n){return typeof n=="string"||n instanceof String}function uj(n){return ak()&&n instanceof Blob}function ak(){return typeof Blob<"u"}function dj(n,e,t,i){if(i<e)throw zB(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw zB(`Invalid value for '${n}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k5(n,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function ez(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const r=e(i)+"="+e(n[i]);t=t+r+"&"}return t=t.slice(0,-1),t}var Wg;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Wg||(Wg={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hse(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||r||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class use{constructor(e,t,i,r,s,o,a,l,h,u,d,A=!0,f=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=h,this.progressCallback_=u,this.connectionFactory_=d,this.retry=A,this.isUsingEmulator=f,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,g)=>{this.resolve_=p,this.reject_=g,this.start_()})}start_(){const e=(i,r)=>{if(r){i(!1,new sx(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const l=a.loaded,h=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,h)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===Wg.NO_ERROR,l=s.getStatus();if(!a||hse(l,this.additionalRetryCodes_)&&this.retry){const u=s.getErrorCode()===Wg.ABORT;i(!1,new sx(!1,null,u));return}const h=this.successCodes_.indexOf(l)!==-1;i(!0,new sx(h,s))})},t=(i,r)=>{const s=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());lse(l)?s(l):s()}catch(l){o(l)}else if(a!==null){const l=sk();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(r.canceled){const l=this.appDelete_?JW():qre();o(l)}else{const l=Kre();o(l)}};this.canceled_?t(!1,new sx(!1,null,!0)):this.backoffId_=ose(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&ase(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class sx{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function dse(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function Ase(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function fse(n,e){e&&(n["X-Firebase-GMPID"]=e)}function pse(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function gse(n,e,t,i,r,s,o=!0,a=!1){const l=ez(n.urlParams),h=n.url+l,u=Object.assign({},n.headers);return fse(u,e),dse(u,t),Ase(u,s),pse(u,i),new use(h,n.method,u,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mse(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function yse(...n){const e=mse();if(e!==void 0){const t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}else{if(ak())return new Blob(n);throw new Ra(Ma.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function wse(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vse(n){if(typeof atob>"u")throw ise("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nA={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class $S{constructor(e,t){this.data=e,this.contentType=t||null}}function xse(n,e){switch(n){case nA.RAW:return new $S(tz(e));case nA.BASE64:case nA.BASE64URL:return new $S(nz(n,e));case nA.DATA_URL:return new $S(Cse(e),_se(e))}throw sk()}function tz(n){const e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const s=i,o=n.charCodeAt(++t);i=65536|(s&1023)<<10|o&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function bse(n){let e;try{e=decodeURIComponent(n)}catch{throw Wy(nA.DATA_URL,"Malformed data URL.")}return tz(e)}function nz(n,e){switch(n){case nA.BASE64:{const r=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(r||s)throw Wy(n,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case nA.BASE64URL:{const r=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(r||s)throw Wy(n,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=vse(e)}catch(r){throw r.message.includes("polyfill")?r:Wy(n,"Invalid character found")}const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i}class iz{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw Wy(nA.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=Sse(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function Cse(n){const e=new iz(n);return e.base64?nz(nA.BASE64,e.rest):bse(e.rest)}function _se(n){return new iz(n).contentType}function Sse(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(e,t){let i=0,r="";uj(e)?(this.data_=e,i=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(uj(this.data_)){const i=this.data_,r=wse(i,e,t);return r===null?null:new hp(r)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new hp(i,!0)}}static getBlob(...e){if(ak()){const t=e.map(i=>i instanceof hp?i.data_:i);return new hp(yse.apply(null,t))}else{const t=e.map(o=>ok(o)?xse(nA.RAW,o).data:o.data_);let i=0;t.forEach(o=>{i+=o.byteLength});const r=new Uint8Array(i);let s=0;return t.forEach(o=>{for(let a=0;a<o.length;a++)r[s++]=o[a]}),new hp(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rz(n){let e;try{e=JSON.parse(n)}catch{return null}return cse(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tse(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function Bse(n,e){const t=e.split("/").filter(i=>i.length>0).join("/");return n.length===0?t:n+"/"+t}function sz(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ese(n,e){return e}class Jc{constructor(e,t,i,r){this.server=e,this.local=t||e,this.writable=!!i,this.xform=r||Ese}}let ox=null;function Fse(n){return!ok(n)||n.length<2?n:sz(n)}function oz(){if(ox)return ox;const n=[];n.push(new Jc("bucket")),n.push(new Jc("generation")),n.push(new Jc("metageneration")),n.push(new Jc("name","fullPath",!0));function e(s,o){return Fse(o)}const t=new Jc("name");t.xform=e,n.push(t);function i(s,o){return o!==void 0?Number(o):o}const r=new Jc("size");return r.xform=i,n.push(r),n.push(new Jc("timeCreated")),n.push(new Jc("updated")),n.push(new Jc("md5Hash",null,!0)),n.push(new Jc("cacheControl",null,!0)),n.push(new Jc("contentDisposition",null,!0)),n.push(new Jc("contentEncoding",null,!0)),n.push(new Jc("contentLanguage",null,!0)),n.push(new Jc("contentType",null,!0)),n.push(new Jc("metadata","customMetadata",!0)),ox=n,ox}function kse(n,e){function t(){const i=n.bucket,r=n.fullPath,s=new Yh(i,r);return e._makeStorageReference(s)}Object.defineProperty(n,"ref",{get:t})}function Ise(n,e,t){const i={};i.type="file";const r=t.length;for(let s=0;s<r;s++){const o=t[s];i[o.local]=o.xform(i,e[o.server])}return kse(i,n),i}function az(n,e,t){const i=rz(e);return i===null?null:Ise(n,i,t)}function Dse(n,e,t,i){const r=rz(e);if(r===null||!ok(r.downloadTokens))return null;const s=r.downloadTokens;if(s.length===0)return null;const o=encodeURIComponent;return s.split(",").map(h=>{const u=n.bucket,d=n.fullPath,A="/b/"+o(u)+"/o/"+o(d),f=k5(A,t,i),p=ez({alt:"media",token:h});return f+p})[0]}function jse(n,e){const t={},i=e.length;for(let r=0;r<i;r++){const s=e[r];s.writable&&(t[s.server]=n[s.local])}return JSON.stringify(t)}class lk{constructor(e,t,i,r){this.url=e,this.method=t,this.handler=i,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lz(n){if(!n)throw sk()}function Pse(n,e){function t(i,r){const s=az(n,r,e);return lz(s!==null),s}return t}function Nse(n,e){function t(i,r){const s=az(n,r,e);return lz(s!==null),Dse(s,r,n.host,n._protocol)}return t}function cz(n){function e(t,i){let r;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?r=Xre():r=Gre():t.getStatus()===402?r=Vre(n.bucket):t.getStatus()===403?r=Yre(n.path):r=i,r.status=t.getStatus(),r.serverResponse=i.serverResponse,r}return e}function hz(n){const e=cz(n);function t(i,r){let s=e(i,r);return i.getStatus()===404&&(s=$re(n.path)),s.serverResponse=r.serverResponse,s}return t}function Lse(n,e,t){const i=e.fullServerUrl(),r=k5(i,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,a=new lk(r,s,Nse(n,t),o);return a.errorHandler=hz(e),a}function Mse(n,e){const t=e.fullServerUrl(),i=k5(t,n.host,n._protocol),r="DELETE",s=n.maxOperationRetryTime;function o(l,h){}const a=new lk(i,r,o,s);return a.successCodes=[200,204],a.errorHandler=hz(e),a}function Rse(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function Use(n,e,t){const i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=Rse(null,e)),i}function Ose(n,e,t,i,r){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let y="";for(let x=0;x<2;x++)y=y+Math.random().toString().slice(2);return y}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const h=Use(e,i,r),u=jse(h,t),d="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+l+`\r
Content-Type: `+h.contentType+`\r
\r
`,A=`\r
--`+l+"--",f=hp.getBlob(d,i,A);if(f===null)throw tse();const p={name:h.fullPath},g=k5(s,n.host,n._protocol),v="POST",w=n.maxUploadRetryTime,m=new lk(g,v,Pse(n,t),w);return m.urlParams=p,m.headers=o,m.body=f.uploadData(),m.errorHandler=cz(e),m}class Hse{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Wg.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Wg.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Wg.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,r,s){if(this.sent_)throw J1("cannot .send() more than once");if(Gp(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),s!==void 0)for(const o in s)s.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,s[o].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw J1("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw J1("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw J1("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw J1("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class Wse extends Hse{initXhr(){this.xhr_.responseType="text"}}function ck(){return new Wse}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r0{constructor(e,t){this._service=e,t instanceof Yh?this._location=t:this._location=Yh.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new r0(e,t)}get root(){const e=new Yh(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return sz(this._location.path)}get storage(){return this._service}get parent(){const e=Tse(this._location.path);if(e===null)return null;const t=new Yh(this._location.bucket,e);return new r0(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw rse(e)}}function zse(n,e,t){n._throwIfRoot("uploadBytes");const i=Ose(n.storage,n._location,oz(),new hp(e,!0),t);return n.storage.makeRequestWithTokens(i,ck).then(r=>({metadata:r,ref:n}))}function Qse(n){n._throwIfRoot("getDownloadURL");const e=Lse(n.storage,n._location,oz());return n.storage.makeRequestWithTokens(e,ck).then(t=>{if(t===null)throw nse();return t})}function $se(n){n._throwIfRoot("deleteObject");const e=Mse(n.storage,n._location);return n.storage.makeRequestWithTokens(e,ck)}function Vse(n,e){const t=Bse(n._location.path,e),i=new Yh(n._location.bucket,t);return new r0(n.storage,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gse(n){return/^[A-Za-z]+:\/\//.test(n)}function Xse(n,e){return new r0(n,e)}function uz(n,e){if(n instanceof hk){const t=n;if(t._bucket==null)throw ese();const i=new r0(t,t._bucket);return e!=null?uz(i,e):i}else return e!==void 0?Vse(n,e):n}function Yse(n,e){if(e&&Gse(e)){if(n instanceof hk)return Xse(n,e);throw zB("To use ref(service, url), the first argument must be a Storage instance.")}else return uz(n,e)}function Aj(n,e){const t=e==null?void 0:e[ZW];return t==null?null:Yh.makeFromBucketSpec(t,n)}function Kse(n,e,t,i={}){n.host=`${e}:${t}`;const r=Gp(e);r&&(nF(`https://${n.host}/b`),iF("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:s}=i;s&&(n._overrideAuthToken=typeof s=="string"?s:oO(s,n.app.options.projectId))}class hk{constructor(e,t,i,r,s,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=qW,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=zre,this._maxUploadRetryTime=Qre,this._requests=new Set,r!=null?this._bucket=Yh.makeFromBucketSpec(r,this._host):this._bucket=Aj(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Yh.makeFromBucketSpec(this._url,e):this._bucket=Aj(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){dj("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){dj("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(ah(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new r0(this,e)}_makeRequest(e,t,i,r,s=!0){if(this._deleted)return new sse(JW());{const o=gse(e,this._appId,i,r,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,r).getPromise()}}const fj="@firebase/storage",pj="0.13.14";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dz="storage";function Az(n,e,t){return n=Uo(n),zse(n,e,t)}function fz(n){return n=Uo(n),Qse(n)}function pz(n){return n=Uo(n),$se(n)}function $C(n,e){return n=Uo(n),Yse(n,e)}function qse(n=oF(),e){n=Uo(n);const i=i5(n,dz).getImmediate({identifier:e}),r=iO("storage");return r&&Zse(i,...r),i}function Zse(n,e,t,i={}){Kse(n,e,t,i)}function Jse(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new hk(t,i,r,e,f0)}function eoe(){Jg(new Ip(dz,Jse,"PUBLIC").setMultipleInstances(!0)),oA(fj,pj,""),oA(fj,pj,"esm2017")}eoe();const _g={apiKey:"your_api_key_here".trim(),authDomain:"your_auth_domain_here".trim(),projectId:"your_project_id_here".trim(),storageBucket:"your_storage_bucket_here".trim(),messagingSenderId:"your_messaging_sender_id_here".trim(),appId:"your_app_id_here".trim()};console.log("🔥 Firebase Config Status:",{apiKey:_g.apiKey?"✅ Set":"❌ Missing",authDomain:_g.authDomain||"❌ Missing",projectId:_g.projectId||"❌ Missing",storageBucket:_g.storageBucket||"❌ Missing",messagingSenderId:_g.messagingSenderId?"✅ Set":"❌ Missing",appId:_g.appId?"✅ Set":"❌ Missing",environment:"production",currentDomain:typeof window<"u"?window.location.hostname:"N/A"});const uk=cO(_g),bd=cH(uk),rr=MW(uk),Tw=qse(uk),gz=Object.freeze(Object.defineProperty({__proto__:null,auth:bd,db:rr,storage:Tw},Symbol.toStringTag,{value:"Module"})),zc={teamScope:!0,dualWrite:!0,newReadsFirst:!0,nestedDesigns:!0},Bw=new eA;Bw.setCustomParameters({prompt:"select_account",auth_type:"rerequest",access_type:"offline"});Bw.addScope("profile");Bw.addScope("email");const B1=async(n,e)=>{try{const t=await WO(bd,n,e);return zc.teamScope&&await I5(t.user),{user:t.user,error:null}}catch(t){return{user:null,error:t.message}}},E1=async()=>{try{if(console.log("🔐 구글 로그인 시도"),console.log("🔐 현재 도메인:",window.location.hostname),console.log("🔐 Auth Domain:","your_auth_domain_here"),console.log("🔐 환경:","production"),/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)){const{signInWithRedirect:e}=await rl(async()=>{const{signInWithRedirect:t}=await Promise.resolve().then(()=>hH);return{signInWithRedirect:t}},void 0);return await e(bd,Bw),{user:null,error:null}}else{const e=await nH(bd,Bw);return zc.teamScope&&await I5(e.user),{user:e.user,error:null}}}catch(n){const e=n;console.error("🔥 구글 로그인 에러 발생"),console.error("🔥 에러 코드:",e.code),console.error("🔥 에러 메시지:",e.message),console.error("🔥 전체 에러:",n);let t=e.message;switch(e.code){case"auth/popup-closed-by-user":t="로그인이 취소되었습니다.";break;case"auth/popup-blocked":t="팝업이 차단되었습니다. 팝업을 허용해주세요.";break;case"auth/cancelled-popup-request":t="로그인 요청이 취소되었습니다.";break;case"auth/account-exists-with-different-credential":t="이미 다른 방법으로 가입된 이메일입니다.";break;case"auth/unauthorized-domain":t=`인증되지 않은 도메인입니다. 현재 도메인: ${window.location.hostname}`,console.error("🔥 Firebase 인증 도메인 오류"),console.error("🔥 현재 도메인:",window.location.hostname),console.error("🔥 현재 URL:",window.location.href),console.error("🔥 Auth Domain 설정:","your_auth_domain_here"),console.error("🔥 Firebase Console > Authentication > Settings > Authorized domains에 추가 필요");break;default:t="구글 로그인 중 오류가 발생했습니다."}return{user:null,error:t}}},F1=async(n,e,t)=>{try{const i=await HO(bd,n,e);return t&&i.user&&await l5(i.user,{displayName:t}),zc.teamScope&&await I5(i.user),{user:i.user,error:null}}catch(i){return{user:null,error:i.message}}},mz=async()=>{try{return await $O(bd),{error:null}}catch(n){return{error:n.message}}},yz=n=>AF(bd,n),Wr=()=>new Promise(n=>{const e=AF(bd,t=>{e(),n(t)})}),wz=async()=>{try{const n=await sH(bd);return n!=null&&n.user?(console.log("🔐 리다이렉트 로그인 성공:",n.user.email),zc.teamScope&&await I5(n.user),{user:n.user,error:null}):{user:null,error:null}}catch(n){const e=n;return console.error("리다이렉트 처리 오류:",e),{user:null,error:e.message}}};async function I5(n){try{const{doc:e,getDoc:t,setDoc:i,serverTimestamp:r,Timestamp:s}=await rl(async()=>{const{doc:d,getDoc:A,setDoc:f,serverTimestamp:p,Timestamp:g}=await Promise.resolve().then(()=>Wre);return{doc:d,getDoc:A,setDoc:f,serverTimestamp:p,Timestamp:g}},void 0),{db:o}=await rl(async()=>{const{db:d}=await Promise.resolve().then(()=>gz);return{db:d}},void 0),a=`personal_${n.uid}`,l=e(o,"teams",a);if((await t(l)).exists())return;const u={name:`${(n.email||"User").split("@")[0]}'s Workspace`,description:"Personal workspace",ownerId:n.uid,members:[{userId:n.uid,email:n.email||"",displayName:n.displayName||"",photoURL:n.photoURL||"",role:"owner",joinedAt:s.now(),status:"active"}],settings:{isPublic:!1,allowInvitations:!0,defaultRole:"viewer",maxMembers:50},createdAt:r(),updatedAt:r()};await i(l,u),n.email&&localStorage.setItem("userEmail",n.email),console.log("✅ Personal team created:",a)}catch(e){console.error("Failed to create personal team:",e)}}const toe=Object.freeze(Object.defineProperty({__proto__:null,getCurrentUserAsync:Wr,handleRedirectResult:wz,onAuthStateChange:yz,signInWithEmail:B1,signInWithGoogle:E1,signOutUser:mz,signUpWithEmail:F1},Symbol.toStringTag,{value:"Module"})),vz=H.createContext(void 0),noe=({children:n})=>{const[e,t]=H.useState(null),[i,r]=H.useState(!0);H.useEffect(()=>{try{const o=yz(l=>{t(l),r(!1),l?(console.log("🔐 사용자 로그인:",l.email),localStorage.setItem("userId",l.uid),localStorage.getItem("activeTeamId")||localStorage.setItem("activeTeamId",`personal_${l.uid}`)):(console.log("🔐 사용자 로그아웃"),localStorage.removeItem("userId"),localStorage.removeItem("activeTeamId"))}),a=setTimeout(()=>{r(l=>l&&(console.warn("⚠️ Firebase 인증 상태 확인 타임아웃 - 로딩 강제 종료"),!1))},5e3);return()=>{o(),clearTimeout(a)}}catch(o){console.error("❌ Firebase 인증 설정 에러:",o),r(!1)}},[]);const s={user:e,loading:i,isAuthenticated:!!e};return c.jsx(vz.Provider,{value:s,children:n})},Vc=()=>{const n=H.useContext(vz);if(n===void 0)throw new Error("useAuth는 AuthProvider 내에서 사용해야 합니다.");return n};function ioe(n){const e=n.replace("#",""),t=parseInt(e.substring(0,2),16)/255,i=parseInt(e.substring(2,4),16)/255,r=parseInt(e.substring(4,6),16)/255,s=Math.max(t,i,r),o=Math.min(t,i,r);let a=0,l=0;const h=(s+o)/2;if(s!==o){const u=s-o;switch(l=h>.5?u/(2-s-o):u/(s+o),s){case t:a=((i-r)/u+(i<r?6:0))/6;break;case i:a=((r-t)/u+2)/6;break;case r:a=((t-i)/u+4)/6;break}}return{h:Math.round(a*360),s:Math.round(l*100),l:Math.round(h*100)}}function roe(n){let e=n.match(/hsl\((\d+)\s+(\d+)%\s+(\d+)%\)/);return e||(e=n.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/)),e?{h:parseInt(e[1]),s:parseInt(e[2]),l:parseInt(e[3])}:null}function xz(n){let e,t,i;if(n.startsWith("hsl")){const s=roe(n);if(!s){console.warn("Invalid HSL color:",n);return}({h:e,s:t,l:i}=s)}else({h:e,s:t,l:i}=ioe(n));const r=document.documentElement;r.style.setProperty("--theme",`${e} ${t}% ${i}%`),r.style.setProperty("--theme-50",`${e} ${t}% ${Math.min(98,i+48)}%`),r.style.setProperty("--theme-100",`${e} ${t}% ${Math.min(95,i+40)}%`),r.style.setProperty("--theme-200",`${e} ${t}% ${Math.min(90,i+30)}%`),r.style.setProperty("--theme-300",`${e} ${t}% ${Math.min(80,i+20)}%`),r.style.setProperty("--theme-400",`${e} ${t}% ${Math.min(70,i+10)}%`),r.style.setProperty("--theme-500",`${e} ${t}% ${i}%`),r.style.setProperty("--theme-600",`${e} ${Math.max(10,t-5)}% ${Math.max(20,i-10)}%`),r.style.setProperty("--theme-700",`${e} ${Math.max(10,t-10)}% ${Math.max(15,i-20)}%`),r.style.setProperty("--theme-800",`${e} ${Math.max(10,t-15)}% ${Math.max(10,i-30)}%`),r.style.setProperty("--theme-900",`${e} ${Math.max(10,t-20)}% ${Math.max(5,i-40)}%`),localStorage.setItem("themeColor",n)}function bz(){return localStorage.getItem("themeColor")||"#7C5CFF"}function dk(){const n=bz();xz(n)}function $h(){const n=bz();return n.startsWith("#")?n:"#7C5CFF"}const Cz=H.createContext(void 0),gj="app-theme-config",soe={mode:"light",color:"blue"},ooe=({children:n})=>{const e=()=>{try{const a=localStorage.getItem(gj);if(a)return JSON.parse(a)}catch(a){console.warn("테마 설정 로드 실패:",a)}return soe},[t,i]=H.useState(()=>{const a=e();return typeof window<"u"&&document.documentElement&&mj(a),a});H.useEffect(()=>{try{localStorage.setItem(gj,JSON.stringify(t)),mj(t)}catch(a){console.warn("테마 설정 저장 실패:",a)}},[t]);const r=a=>{i(l=>({...l,mode:a}))},s=a=>{i(h=>({...h,color:a}));const l={green:"#10b981",blue:"#3b82f6",purple:"#8b5cf6",vivid:"#a25378",red:"#D2042D",pink:"#ec4899",indigo:"#6366f1",teal:"#14b8a6",yellow:"#eab308",gray:"#6b7280",cyan:"#06b6d4",lime:"#84cc16",black:"#1a1a1a",wine:"#845EC2",gold:"#d97706",navy:"#1e3a8a",emerald:"#059669",violet:"#C128D7",mint:"#0CBA80",neon:"#18CF23",rust:"#FF7438",white:"#D65DB1",plum:"#790963",brown:"#5A2B1D",darkgray:"#2C3844",maroon:"#3F0D0D",turquoise:"#003A7A",slate:"#2E3A47",copper:"#AD4F34",forest:"#1B3924",olive:"#4C462C"};l[a]&&xz(l[a])},o=()=>{r(t.mode==="light"?"dark":"light")};return c.jsx(Cz.Provider,{value:{theme:t,setThemeMode:r,setThemeColor:s,toggleMode:o},children:n})},Ua=()=>{const n=H.useContext(Cz);if(!n)throw new Error("useTheme must be used within a ThemeProvider");return n},mj=n=>{console.log("🎨 테마 적용 중:",n);const e=document.documentElement;e.setAttribute("data-theme",n.mode),document.body.classList.remove(...Array.from(document.body.classList).filter(o=>o.startsWith("theme-")));const t={green:{primary:"#10b981",primaryHover:"#059669",primaryLight:n.mode==="dark"?"rgba(16, 185, 129, 0.2)":"#d1fae5",primaryDark:"#047857"},blue:{primary:"#3b82f6",primaryHover:"#2563eb",primaryLight:n.mode==="dark"?"rgba(59, 130, 246, 0.2)":"#dbeafe",primaryDark:"#1d4ed8"},purple:{primary:"#8b5cf6",primaryHover:"#7c3aed",primaryLight:n.mode==="dark"?"rgba(139, 92, 246, 0.2)":"#ede9fe",primaryDark:"#6d28d9"},vivid:{primary:"#a25378",primaryHover:"#82425f",primaryLight:n.mode==="dark"?"rgba(162, 83, 120, 0.2)":"#f4e7ee",primaryDark:"#613247"},red:{primary:"#D2042D",primaryHover:"#A80324",primaryLight:n.mode==="dark"?"rgba(210, 4, 45, 0.2)":"#ffe0e6",primaryDark:"#7E021B"},pink:{primary:"#ec4899",primaryHover:"#db2777",primaryLight:n.mode==="dark"?"rgba(236, 72, 153, 0.2)":"#fce7f3",primaryDark:"#be185d"},indigo:{primary:"#6366f1",primaryHover:"#4f46e5",primaryLight:n.mode==="dark"?"rgba(99, 102, 241, 0.2)":"#e0e7ff",primaryDark:"#3730a3"},teal:{primary:"#14b8a6",primaryHover:"#0d9488",primaryLight:n.mode==="dark"?"rgba(20, 184, 166, 0.2)":"#ccfbf1",primaryDark:"#0f766e"},yellow:{primary:"#eab308",primaryHover:"#ca8a04",primaryLight:n.mode==="dark"?"rgba(234, 179, 8, 0.2)":"#fef3c7",primaryDark:"#a16207"},gray:{primary:"#6b7280",primaryHover:"#4b5563",primaryLight:n.mode==="dark"?"rgba(107, 114, 128, 0.2)":"#f3f4f6",primaryDark:"#374151"},cyan:{primary:"#06b6d4",primaryHover:"#0891b2",primaryLight:n.mode==="dark"?"rgba(6, 182, 212, 0.2)":"#cffafe",primaryDark:"#0e7490"},lime:{primary:"#84cc16",primaryHover:"#65a30d",primaryLight:n.mode==="dark"?"rgba(132, 204, 22, 0.2)":"#ecfccb",primaryDark:"#4d7c0f"},black:{primary:"#1a1a1a",primaryHover:"#000000",primaryLight:n.mode==="dark"?"rgba(26, 26, 26, 0.2)":"#f5f5f5",primaryDark:"#000000"},wine:{primary:"#845EC2",primaryHover:"#744EB2",primaryLight:n.mode==="dark"?"rgba(132, 94, 194, 0.2)":"#e6dcf5",primaryDark:"#643EA2"},gold:{primary:"#d97706",primaryHover:"#b45309",primaryLight:n.mode==="dark"?"rgba(217, 119, 6, 0.2)":"#fef3c7",primaryDark:"#92400e"},navy:{primary:"#1e3a8a",primaryHover:"#1e40af",primaryLight:n.mode==="dark"?"rgba(30, 58, 138, 0.2)":"#dbeafe",primaryDark:"#1e1b4b"},emerald:{primary:"#059669",primaryHover:"#047857",primaryLight:n.mode==="dark"?"rgba(5, 150, 105, 0.2)":"#d1fae5",primaryDark:"#064e3b"},violet:{primary:"#C128D7",primaryHover:"#A020B8",primaryLight:n.mode==="dark"?"rgba(193, 40, 215, 0.2)":"#f3e8ff",primaryDark:"#7B1FA2"},mint:{primary:"#0CBA80",primaryHover:"#0AA66B",primaryLight:n.mode==="dark"?"rgba(12, 186, 128, 0.2)":"#ecfdf5",primaryDark:"#065F46"},neon:{primary:"#18CF23",primaryHover:"#15B820",primaryLight:n.mode==="dark"?"rgba(24, 207, 35, 0.2)":"#f0fdf4",primaryDark:"#166534"},rust:{primary:"#FF7438",primaryHover:"#FF5722",primaryLight:n.mode==="dark"?"rgba(255, 116, 56, 0.2)":"#ffe4db",primaryDark:"#E64A19"},white:{primary:"#D65DB1",primaryHover:"#C44DA0",primaryLight:n.mode==="dark"?"rgba(214, 93, 177, 0.2)":"#f5d4ed",primaryDark:"#B84D91"},plum:{primary:"#790963",primaryHover:"#5f074e",primaryLight:n.mode==="dark"?"rgba(121, 9, 99, 0.2)":"#f7e6f3",primaryDark:"#47053b"},brown:{primary:"#5A2B1D",primaryHover:"#4A2318",primaryLight:n.mode==="dark"?"rgba(90, 43, 29, 0.2)":"#f5e6e0",primaryDark:"#3E1810"},darkgray:{primary:"#2C3844",primaryHover:"#232D37",primaryLight:n.mode==="dark"?"rgba(44, 56, 68, 0.2)":"#e8eaed",primaryDark:"#1A2027"},maroon:{primary:"#3F0D0D",primaryHover:"#330A0A",primaryLight:n.mode==="dark"?"rgba(63, 13, 13, 0.2)":"#fce4e4",primaryDark:"#260707"},turquoise:{primary:"#003A7A",primaryHover:"#002F63",primaryLight:n.mode==="dark"?"rgba(0, 58, 122, 0.2)":"#e0e9f4",primaryDark:"#00254C"},slate:{primary:"#2E3A47",primaryHover:"#252F3A",primaryLight:n.mode==="dark"?"rgba(46, 58, 71, 0.2)":"#e9ebee",primaryDark:"#1C242D"},copper:{primary:"#AD4F34",primaryHover:"#954329",primaryLight:n.mode==="dark"?"rgba(173, 79, 52, 0.2)":"#fbe8e3",primaryDark:"#7D3820"},forest:{primary:"#1B3924",primaryHover:"#152D1D",primaryLight:n.mode==="dark"?"rgba(27, 57, 36, 0.2)":"#e3ebe6",primaryDark:"#0F2116"},olive:{primary:"#4C462C",primaryHover:"#3D3A23",primaryLight:n.mode==="dark"?"rgba(76, 70, 44, 0.2)":"#eeece4",primaryDark:"#2E2B1A"}},i={light:{background:"#ffffff",backgroundSecondary:"#f9fafb",surface:"#ffffff",text:"#111827",textSecondary:"#6b7280",textMuted:"#9ca3af",border:"#e5e7eb",borderHover:"#d1d5db",shadow:"rgba(0, 0, 0, 0.1)",overlay:"rgba(0, 0, 0, 0.5)"},dark:{background:"#121212",backgroundSecondary:"#121212",surface:"#121212",text:"#ffffff",textSecondary:"#cccccc",textMuted:"#999999",border:"#333333",borderHover:"#555555",shadow:"rgba(0, 0, 0, 0.5)",overlay:"rgba(0, 0, 0, 0.8)"}},r=t[n.color],s=i[n.mode];e.style.setProperty("--theme-mode",n.mode),e.style.setProperty("--theme-color",n.color),e.style.setProperty("--theme-primary",r.primary),e.style.setProperty("--theme-primary-hover",r.primaryHover),e.style.setProperty("--theme-primary-light",r.primaryLight),e.style.setProperty("--theme-primary-dark",r.primaryDark),e.style.setProperty("--theme-background",s.background),e.style.setProperty("--theme-background-secondary",s.backgroundSecondary),e.style.setProperty("--theme-surface",s.surface),e.style.setProperty("--theme-text",s.text),e.style.setProperty("--theme-text-secondary",s.textSecondary),e.style.setProperty("--theme-text-muted",s.textMuted),e.style.setProperty("--theme-border",s.border),e.style.setProperty("--theme-border-hover",s.borderHover),e.style.setProperty("--theme-shadow",s.shadow),e.style.setProperty("--theme-overlay",s.overlay),e.style.setProperty("--theme-danger","#ef4444"),e.style.setProperty("--theme-danger-hover","#dc2626"),e.style.setProperty("--theme-danger-light",n.mode==="dark"?"rgba(239, 68, 68, 0.2)":"#fee2e2"),e.style.setProperty("--theme-info","#3b82f6"),e.style.setProperty("--theme-info-hover","#2563eb"),e.style.setProperty("--theme-info-light",n.mode==="dark"?"rgba(59, 130, 246, 0.2)":"#eff6ff"),e.style.setProperty("--theme-warning","#f59e0b"),e.style.setProperty("--theme-warning-hover","#d97706"),e.style.setProperty("--theme-warning-light",n.mode==="dark"?"rgba(245, 158, 11, 0.2)":"#fef3c7"),e.style.setProperty("--theme-success",r.primary),e.style.setProperty("--theme-success-hover",r.primaryHover),e.style.setProperty("--theme-success-light",r.primaryLight),n.mode==="dark"?e.style.setProperty("--popup-shadow",`0 20px 50px rgba(0, 0, 0, 0.8), 0 10px 20px ${r.primaryLight}`):e.style.setProperty("--popup-shadow","0 20px 50px rgba(0, 0, 0, 0.3), 0 10px 20px rgba(0, 0, 0, 0.15)"),document.body.className=document.body.className.replace(/theme-\w+-\w+/g,""),document.body.classList.add(`theme-${n.mode}-${n.color}`),document.body.style.backgroundColor=s.background,document.body.style.color=s.text,console.log("🎨 테마 적용 완료:",{mode:n.mode,color:n.color,background:s.background,text:s.text,primary:r.primary}),setTimeout(()=>{const o=getComputedStyle(e).getPropertyValue("--theme-background").trim(),a=getComputedStyle(e).getPropertyValue("--theme-text").trim(),l=getComputedStyle(e).getPropertyValue("--theme-primary").trim();console.log("🔍 CSS 변수 적용 확인:",{expected:{background:s.background,text:s.text,primary:r.primary},applied:{background:o,text:a,primary:l},success:o===s.background&&a===s.text}),o!==s.background&&(console.error("❌ 배경색 적용 실패!",{expected:s.background,actual:o}),e.style.setProperty("--theme-background",s.background),document.body.style.backgroundColor=s.background),a!==s.text&&(console.error("❌ 텍스트 색상 적용 실패!",{expected:s.text,actual:a}),e.style.setProperty("--theme-text",s.text),document.body.style.color=s.text)},100),setTimeout(()=>{const o=document.querySelectorAll('[class*="navItem"]');console.log(`🔧 네비게이션 항목 ${o.length}개 발견, 테마 강제 적용 중...`),o.forEach(a=>{const l=a;l.classList.contains("active")?(l.style.setProperty("color",r.primary,"important"),l.style.setProperty("background-color",r.primaryLight,"important")):(l.style.setProperty("color",s.textSecondary,"important"),l.style.setProperty("background-color","transparent","important"))}),console.log("✅ 네비게이션 테마 적용 완료")},200),aoe(r.primary,n.mode)},aoe=(n,e)=>{const t=document.createElement("canvas");t.width=32,t.height=32;const i=t.getContext("2d");if(!i)return;i.fillStyle=n;const r=2,s=2,o=28,a=28,l=4;i.beginPath(),i.moveTo(r+l,s),i.arcTo(r+o,s,r+o,s+a,l),i.arcTo(r+o,s+a,r,s+a,l),i.arcTo(r,s+a,r,s,l),i.arcTo(r,s,r+o,s,l),i.closePath(),i.fill(),e==="dark"&&(i.strokeStyle="rgba(255, 255, 255, 0.3)",i.lineWidth=1,i.stroke()),i.fillStyle="#ffffff",i.font="bold 18px Arial, sans-serif",i.textAlign="center",i.textBaseline="middle",i.fillText("m",16,17);const h=document.querySelector("link[rel~='icon']"),u=document.querySelector("link[rel='icon'][type='image/svg+xml']");h&&h.type==="image/x-icon"&&h.remove(),u&&u.remove();const d=document.createElement("link");d.type="image/x-icon",d.rel="icon",d.href=t.toDataURL(),document.head.appendChild(d)},loe="_overlay_1oxoj_1",coe="_modal_1oxoj_24",hoe="_header_1oxoj_45",uoe="_title_1oxoj_50",doe="_content_1oxoj_57",Aoe="_message_1oxoj_61",foe="_footer_1oxoj_69",poe="_confirmButton_1oxoj_77",goe="_cancelButton_1oxoj_131",Vl={overlay:loe,modal:coe,header:hoe,title:uoe,content:doe,message:Aoe,footer:foe,confirmButton:poe,cancelButton:goe},_z=({isOpen:n,message:e,onClose:t,title:i="알림",onConfirm:r,onCancel:s,showCancel:o=!1})=>{if(!n)return null;const a=()=>{r&&r(),t()},l=()=>{s&&s(),t()};return c.jsx("div",{className:Vl.overlay,onClick:o?l:t,children:c.jsxs("div",{className:Vl.modal,onClick:h=>h.stopPropagation(),children:[c.jsx("div",{className:Vl.header,children:c.jsx("h3",{className:Vl.title,children:i})}),c.jsx("div",{className:Vl.content,children:c.jsx("p",{className:Vl.message,children:e})}),c.jsxs("div",{className:Vl.footer,children:[o&&c.jsx("button",{className:Vl.cancelButton,onClick:l,children:"취소"}),c.jsx("button",{className:Vl.confirmButton,onClick:a,children:"확인"})]})]})})},Sz=H.createContext(void 0),moe=()=>{const n=H.useContext(Sz);if(!n)throw new Error("useAlert must be used within AlertProvider");return n},yoe=({children:n})=>{const[e,t]=H.useState(!1),[i,r]=H.useState(""),[s,o]=H.useState("알림"),[a,l]=H.useState(),[h,u]=H.useState(),[d,A]=H.useState(!1),f=H.useCallback((g,v)=>{r(g),o((v==null?void 0:v.title)||"알림"),l(()=>v==null?void 0:v.onConfirm),u(()=>v==null?void 0:v.onCancel),A((v==null?void 0:v.showCancel)||!1),t(!0)},[]),p=H.useCallback(()=>{t(!1),l(void 0),u(void 0),A(!1)},[]);return c.jsxs(Sz.Provider,{value:{showAlert:f,hideAlert:p},children:[n,(()=>{const g=document.getElementById("modal-root");return!g||!e?null:Km.createPortal(c.jsx(_z,{isOpen:e,message:i,title:s,onClose:p,onConfirm:a,onCancel:h,showCancel:d}),g)})()]})},woe=({isOpen:n,message:e,onConfirm:t,onCancel:i,title:r="확인",confirmText:s="확인",cancelText:o="취소"})=>n?c.jsx("div",{className:Vl.overlay,onClick:i,children:c.jsxs("div",{className:Vl.modal,onClick:a=>a.stopPropagation(),children:[c.jsx("div",{className:Vl.header,children:c.jsx("h3",{className:Vl.title,children:r})}),c.jsx("div",{className:Vl.content,children:c.jsx("p",{className:Vl.message,children:e})}),c.jsxs("div",{className:Vl.footer,children:[c.jsx("button",{className:Vl.cancelButton,onClick:i,children:o}),c.jsx("button",{className:Vl.confirmButton,onClick:t,children:s})]})]})}):null,voe=()=>{const[n,e]=H.useState(!1),[t,i]=H.useState(""),[r,s]=H.useState("확인"),[o,a]=H.useState("확인"),[l,h]=H.useState("취소"),[u,d]=H.useState(null),A=H.useCallback((v,w)=>new Promise(m=>{i(v),s((w==null?void 0:w.title)||"확인"),a((w==null?void 0:w.confirmText)||"확인"),h((w==null?void 0:w.cancelText)||"취소"),e(!0),d(()=>m)}),[]),f=H.useCallback(()=>{e(!1),u&&(u(!0),d(null))},[u]),p=H.useCallback(()=>{e(!1),u&&(u(!1),d(null))},[u]);return{showConfirm:A,ConfirmComponent:()=>{const v=document.getElementById("modal-root");return v?Km.createPortal(c.jsx(woe,{isOpen:n,message:t,title:r,confirmText:o,cancelText:l,onConfirm:f,onCancel:p}),v):null}}},VS={projectId:null,projectTitle:null,basicInfo:{title:"",location:""},isDirty:!1},Pl=w1()(n=>({...VS,setProjectId:e=>n({projectId:e}),setProjectTitle:e=>n({projectTitle:e}),setBasicInfo:e=>n(t=>({basicInfo:{...t.basicInfo,...e},isDirty:!0})),resetBasicInfo:()=>n({basicInfo:VS.basicInfo,isDirty:!1}),resetAll:()=>n({...VS,isDirty:!1}),markAsSaved:()=>n({isDirty:!1})})),xoe=580,yj=10,mi=18,Tz=n=>{var r;if(!n||typeof n.width!="number"||typeof n.height!="number"||typeof n.depth!="number")return{width:3600,height:2400,depth:1500};const e=n.width||3600,t=n.hasFloorFinish?(n.height||2400)-(((r=n.floorFinish)==null?void 0:r.height)||0):n.height||2400,i=n.depth||1500;return{width:e,height:t,depth:i}},Kr=n=>{var d,A,f,p,g,v,w,m,y,x;if(!n)return{width:0,height:0,depth:0,startX:0,startY:0,startZ:0};const e=ga(n),t=Bz(n),i=Ez(n),r=ym(n);let s;if(n.surroundType==="no-surround"){const S=((d=n.gapConfig)==null?void 0:d.left)||0,I=((A=n.gapConfig)==null?void 0:A.right)||0;n.installType==="builtin"||n.installType==="built-in"?s=n.width-S-I:n.installType==="semistanding"||n.installType==="semi-standing"?(f=n.wallConfig)!=null&&f.left&&!((p=n.wallConfig)!=null&&p.right)?s=n.width-S-18:!((g=n.wallConfig)!=null&&g.left)&&((v=n.wallConfig)!=null&&v.right)?s=n.width-18-I:s=n.width-S-18:s=n.width-36}else s=n.width-e.left-e.right;let o=n.height;const a=((w=n.baseConfig)==null?void 0:w.type)==="stand"&&((m=n.baseConfig)==null?void 0:m.placementType)==="float";if(n.hasFloorFinish&&!a&&(o-=t),o-=i,o-=r,n.zone==="dropped"&&((y=n.droppedCeiling)!=null&&y.enabled)){const S=n.droppedCeiling.dropHeight||200;o-=S}const l=n.depth||1500;let h;n.surroundType==="no-surround"?n.installType==="builtin"||n.installType==="built-in"?h=0:n.gapConfig?h=n.gapConfig.left:h=0:h=e.left;let u;return a?u=((x=n.baseConfig)==null?void 0:x.floatHeight)||0:u=r+t,{width:s,height:o,depth:l,startX:h,startY:u,startZ:0}},boe=n=>n?n.depth||1500:xoe,Coe=n=>{if(!n||n.length===0)return 600;let e=600;return n.forEach(t=>{t.customDepth&&t.customDepth>e?e=t.customDepth:t.moduleId&&t.moduleId.includes("styler")&&(e=Math.max(e,660))}),e},Bz=n=>!n.hasFloorFinish||!n.floorFinish?0:n.floorFinish.height,ga=n=>{if(!n)return{left:0,right:0,leftMm:0,rightMm:0};const{installType:e,wallConfig:t,frameSize:i,surroundType:r}=n;if(r==="no-surround"){let u=0,d=0;return console.log("🔍🔍🔍 노서라운드 frameSize 체크 (IMPORTANT):",{frameSize:i,"frameSize?.left":i==null?void 0:i.left,"frameSize?.right":i==null?void 0:i.right,"frameSize가 50인가?":(i==null?void 0:i.left)===50||(i==null?void 0:i.right)===50,installType:e,wallConfig:t,문제:"frameSize가 50이면 잘못된 값임!"}),i&&(i.left>0||i.right>0)&&console.error("🚨🚨🚨 [calculateFrameThickness] 노서라운드인데 frameSize가 0이 아님! 무시하고 0으로 처리합니다.",{frameSize:i,surroundType:r,installType:e}),e==="builtin"||e==="built-in"?(u=0,d=0):e==="semistanding"||e==="semi-standing"?t!=null&&t.left?(u=0,d=mi):(u=mi,d=0):e==="freestanding"&&(u=mi,d=mi),console.log("🔍 노서라운드 프레임 계산 결과:",{frameSize:i,leftThickness:u,rightThickness:d,installType:e,surroundType:r,wallConfig:t,벽위치:t!=null&&t.left?"좌측":t!=null&&t.right?"우측":"없음",엔드패널위치:t!=null&&t.left?"우측":"좌측"}),{left:u,right:d,leftMm:u,rightMm:d}}let s=0,o=0;const a=50,l=(i==null?void 0:i.left)!==void 0?i.left:a,h=(i==null?void 0:i.right)!==void 0?i.right:a;switch(e){case"builtin":case"built-in":s=l,o=h;break;case"semistanding":case"semi-standing":t!=null&&t.left&&!(t!=null&&t.right)?(s=l,o=mi):!(t!=null&&t.left)&&(t!=null&&t.right)?(s=mi,o=h):(s=l,o=mi);break;case"freestanding":case"free-standing":s=mi,o=mi;break;default:s=l,o=h}return{left:s,right:o,leftMm:s,rightMm:o}},_oe=n=>{var t,i,r,s;if(!n)return{width:0,widthMm:0};let e;if(n.surroundType==="no-surround")if(n.installType==="builtin"||n.installType==="built-in")e=n.width;else if(n.installType==="freestanding"||n.installType==="free-standing")e=n.width-36;else if(n.installType==="semistanding"||n.installType==="semi-standing"){const o=n.wallConfig;!(o!=null&&o.left)&&!(o!=null&&o.right)?e=n.width-36:o!=null&&o.left?o!=null&&o.right?e=n.width-(((r=n.gapConfig)==null?void 0:r.left)||0)-(((s=n.gapConfig)==null?void 0:s.right)||0):e=n.width-(((i=n.gapConfig)==null?void 0:i.left)||0)-18:e=n.width-18-(((t=n.gapConfig)==null?void 0:t.right)||0)}else n.gapConfig?e=n.width-(n.gapConfig.left+n.gapConfig.right):e=n.width;else{const o=ga(n);e=n.width-o.leftMm-o.rightMm}return{width:e,widthMm:e}},ym=n=>{var e,t,i,r,s,o;if(console.log("📐 calculateBaseFrameHeight 호출:",{spaceInfo_exists:!!n,baseConfig_type:(e=n==null?void 0:n.baseConfig)==null?void 0:e.type,baseConfig_placementType:(t=n==null?void 0:n.baseConfig)==null?void 0:t.placementType,baseConfig_height:(i=n==null?void 0:n.baseConfig)==null?void 0:i.height,hasFloorFinish:n==null?void 0:n.hasFloorFinish,floorFinish:n==null?void 0:n.floorFinish}),!n)return 0;if(((r=n.baseConfig)==null?void 0:r.type)==="stand"&&((s=n.baseConfig)==null?void 0:s.placementType)==="float")return console.log("📐 calculateBaseFrameHeight - 띄워서 배치: 하부 프레임 없음"),0;if(((o=n.baseConfig)==null?void 0:o.type)==="floor"){const a=n.baseConfig.height||65;if(n.hasFloorFinish&&n.floorFinish){const l=n.floorFinish.height||0,h=Math.max(0,a-l);return console.log("📐 calculateBaseFrameHeight - 바닥마감재 적용:",{baseHeight:a,floorFinishHeight:l,adjustedHeight:h,계산식:`${a} - ${l} = ${h}`}),h}return console.log("📐 calculateBaseFrameHeight - 바닥마감재 없음, 원래 높이 반환:",a),a}return 0},Ez=n=>{var e;return n&&((e=n.frameSize)==null?void 0:e.top)||yj};class Xr{static mmToThreeUnits(e){return e*.01}static calculateInternalWidth(e){var r,s,o,a,l,h;const t=ga(e),i=e.width;if(e.surroundType==="no-surround"){let u=0,d=0;const A=((r=e.gapConfig)==null?void 0:r.left)||0,f=((s=e.gapConfig)==null?void 0:s.right)||0;e.installType==="builtin"||e.installType==="built-in"?(u=A,d=f):e.installType==="semistanding"||e.installType==="semi-standing"?(o=e.wallConfig)!=null&&o.left&&!((a=e.wallConfig)!=null&&a.right)?(u=A,d=mi):!((l=e.wallConfig)!=null&&l.left)&&((h=e.wallConfig)!=null&&h.right)?(u=mi,d=f):(u=A,d=mi):(u=mi,d=mi);const p=i-(u+d);return console.log("🔬 [SpaceCalculator] 내경 계산 (no-surround):",{installType:e.installType,totalWidth:i,leftReduction:u,rightReduction:d,internalWidth:p,calculation:`${i} - ${u} - ${d} = ${p}`}),p}else{const u=i-t.left-t.right;return console.log("🔬 [SpaceCalculator] 내경 계산 (surround):",{totalWidth:i,frameLeft:t.left,frameRight:t.right,internalWidth:u,calculation:`${i} - ${t.left} - ${t.right} = ${u}`}),u}}static getColumnCountLimits(e){const o=Math.ceil(e/600),a=Math.floor(e/400),l=e<=600,h=e<=1200;return{minColumns:o,maxColumns:a,canUseSingle:l,canUseDual:h,columnWidthWillBe:u=>Math.floor(e/u)}}static validateColumnCount(e,t){const i=Xr.getColumnCountLimits(t),r=Math.floor(t/e);return{isValid:e>=i.minColumns&&e<=i.maxColumns&&r>=400&&r<=600,columnWidth:r,limits:i}}static getDefaultColumnCount(e){return e<=600?1:Math.ceil(e/600)}static calculateDroppedZoneInternalWidth(e){var r;if(!((r=e.droppedCeiling)!=null&&r.enabled))return null;const t=e.droppedCeiling.width||900,i=e.droppedCeiling.position==="left";if(console.log("🔥🔥🔥 calculateDroppedZoneInternalWidth 호출됨:",{droppedWidth:t,isLeftDropped:i,surroundType:e.surroundType,installType:e.installType,wallConfig:e.wallConfig,gapConfig:e.gapConfig}),e.surroundType==="no-surround"){let s=0,o=0;const{wallConfig:a,gapConfig:l,installType:h}=e;i?(h==="builtin"||h==="built-in"||(h==="semistanding"||h==="semi-standing")&&a!=null&&a.left?s=(l==null?void 0:l.left)||0:s=mi,o=0):(s=0,h==="builtin"||h==="built-in"||(h==="semistanding"||h==="semi-standing")&&a!=null&&a.right?o=(l==null?void 0:l.right)||0:o=mi);const u=t-s-o;return console.log("🔥🔥🔥 Dropped Zone 내경 계산 결과:",{droppedWidth:t,leftReduction:s,rightReduction:o,result:u,계산식:`${t} - ${s} - ${o} = ${u}`}),u}else{const s=ga(e);return i?t-s.left:t-s.right}}static calculateNormalZoneInternalWidth(e){var s;if(!((s=e.droppedCeiling)!=null&&s.enabled))return Xr.calculateInternalWidth(e);const t=e.droppedCeiling.width||900,i=e.width-t,r=e.droppedCeiling.position==="left";if(console.log("🔥🔥🔥 calculateNormalZoneInternalWidth 호출됨:",{normalWidth:i,isLeftDropped:r,surroundType:e.surroundType,installType:e.installType,wallConfig:e.wallConfig,gapConfig:e.gapConfig}),e.surroundType==="no-surround"){let o=0,a=0;const{wallConfig:l,gapConfig:h,installType:u}=e;r?(o=0,u==="builtin"||u==="built-in"||(u==="semistanding"||u==="semi-standing")&&l!=null&&l.right?a=(h==null?void 0:h.right)||0:a=mi):(u==="builtin"||u==="built-in"||(u==="semistanding"||u==="semi-standing")&&l!=null&&l.left?o=(h==null?void 0:h.left)||0:o=mi,a=0);const d=i-o-a;return console.log("🔥🔥🔥 Normal Zone 내경 계산 결과:",{normalWidth:i,leftReduction:o,rightReduction:a,result:d,계산식:`${i} - ${o} - ${a} = ${d}`}),d}else{const o=ga(e);return r?i-o.right:i-o.left}}static threeUnitsToMm(e){return e*100}}class ar{static calculateSpaceIndexing(e){var m,y,x,S,I,j,C,b,D,T,k,B,E,z,te,L,O,J,$,U,Y;if(console.log("🎯🎯🎯 [calculateSpaceIndexing] 호출됨 (CRITICAL):",{surroundType:e==null?void 0:e.surroundType,installType:e==null?void 0:e.installType,gapConfig:e==null?void 0:e.gapConfig,frameSize:e==null?void 0:e.frameSize,"frameSize.left":(m=e==null?void 0:e.frameSize)==null?void 0:m.left,"frameSize.right":(y=e==null?void 0:e.frameSize)==null?void 0:y.right,customColumnCount:e==null?void 0:e.customColumnCount,mainDoorCount:e==null?void 0:e.mainDoorCount,width:e==null?void 0:e.width,timestamp:new Date().toISOString()}),(e==null?void 0:e.surroundType)==="no-surround"&&(e!=null&&e.frameSize)&&(e.frameSize.left>0||e.frameSize.right>0)&&(console.error("🚨🚨🚨 [ColumnIndexer] 노서라운드 모드인데 frameSize가 0이 아님! 강제로 0으로 수정합니다.",{"원래 frameSize":e.frameSize,surroundType:e.surroundType,installType:e.installType,설명:"노서라운드 모드에서는 frameSize가 모두 0이어야 합니다!"}),e={...e,frameSize:{left:0,right:0,top:0}}),!e)return{columnCount:0,columnPositions:[],threeUnitPositions:[],columnBoundaries:[],threeUnitBoundaries:[],dualColumnPositions:[],threeUnitDualPositions:[],columnWidth:0,internalWidth:0,internalStartX:0,threeUnitColumnWidth:0};if((x=e.droppedCeiling)!=null&&x.enabled){const K=e.width,V=Xr.calculateInternalWidth(e),Q=ga(e);let X;if(e.surroundType==="no-surround"){let ae=0;if(e.installType==="builtin"||e.installType==="built-in"){const me=((S=e.gapConfig)==null?void 0:S.left)||0;ae=me,console.log("🔍 [ColumnIndexer] builtin+no-surround 초기 위치 계산 (단내림 영역):",{surroundType:e.surroundType,installType:e.installType,gapConfig:e.gapConfig,leftReduction:me,reason:"builtin+no-surround는 이격거리 적용"})}else(e.installType==="semistanding"||e.installType==="semi-standing")&&(I=e.wallConfig)!=null&&I.left?ae=((j=e.gapConfig)==null?void 0:j.left)||0:ae=mi;X=-(K/2)+ae}else X=-(K/2)+Q.left;let W;(C=e.droppedCeiling)!=null&&C.enabled&&e.mainDoorCount!==void 0&&e.mainDoorCount>0?(W=e.mainDoorCount,console.log("🎯 단내림 활성화 상태에서 mainDoorCount 사용:",W)):e.customColumnCount?W=e.customColumnCount:W=Xr.getDefaultColumnCount(V);const se=Math.floor(V/W),q=[],de=[];for(let ae=0;ae<=W;ae++)q.push(X+ae*se);for(let ae=0;ae<W;ae++)de.push(X+ae*se+se/2);const Ce=de.map(ae=>Xr.mmToThreeUnits(ae)),Se=q.map(ae=>Xr.mmToThreeUnits(ae)),fe=Math.floor(V/W),M=V%W,Z=[];for(let ae=0;ae<W;ae++)Z.push(ae<M?fe+1:fe);const Ae=[],ie=[];for(let ae=0;ae<W-1;ae++){let me;if(Z&&Z[ae]!==void 0){let _e=0;for(let ue=0;ue<=ae;ue++)_e+=Z[ue];me=_e}else me=q[ae];Ae.push(me),ie.push(Xr.mmToThreeUnits(me))}const ee=ar.calculateZoneSlotInfo(e,e.customColumnCount);if(ee.normal){ee.normal.threeUnitPositions=[],ee.normal.threeUnitDualPositions=[],console.log("🚨🚨🚨 Normal Zone 슬롯 위치 계산 시작:",{startX:ee.normal.startX,width:ee.normal.width,columnCount:ee.normal.columnCount,slotWidths:ee.normal.slotWidths,spaceInfo:{installType:e.installType,wallConfig:e.wallConfig,gapConfig:e.gapConfig}});let ae=ee.normal.startX;for(let me=0;me<ee.normal.columnCount;me++){const _e=((b=ee.normal.slotWidths)==null?void 0:b[me])||ee.normal.columnWidth,ue=ae+_e/2;ee.normal.threeUnitPositions.push(Xr.mmToThreeUnits(ue)),console.log(`🎯 Normal Zone Slot ${me}:`,{startX:ae,width:_e,centerX:ue,threeUnits:Xr.mmToThreeUnits(ue)}),ae+=_e}for(let me=0;me<ee.normal.columnCount-1;me++){const _e=ee.normal.threeUnitPositions[me],ue=ee.normal.threeUnitPositions[me+1],Be=(_e+ue)/2;ee.normal.threeUnitDualPositions.push(Be)}}if(ee.dropped){ee.dropped.threeUnitPositions=[],ee.dropped.threeUnitDualPositions=[],console.log("🚨🚨🚨 Dropped Zone 슬롯 위치 계산 시작:",{startX:ee.dropped.startX,width:ee.dropped.width,columnCount:ee.dropped.columnCount,slotWidths:ee.dropped.slotWidths,spaceInfo:{installType:e.installType,wallConfig:e.wallConfig,gapConfig:e.gapConfig,droppedCeilingPosition:(D=e.droppedCeiling)==null?void 0:D.position}});let ae=ee.dropped.startX;for(let me=0;me<ee.dropped.columnCount;me++){const _e=((T=ee.dropped.slotWidths)==null?void 0:T[me])||ee.dropped.columnWidth,ue=ae+_e/2;ee.dropped.threeUnitPositions.push(Xr.mmToThreeUnits(ue)),console.log(`🎯 Dropped Zone Slot ${me}:`,{startX:ae,width:_e,centerX:ue,threeUnits:Xr.mmToThreeUnits(ue)}),ae+=_e}for(let me=0;me<ee.dropped.columnCount-1;me++){const _e=ee.dropped.threeUnitPositions[me],ue=ee.dropped.threeUnitPositions[me+1],Be=(_e+ue)/2;ee.dropped.threeUnitDualPositions.push(Be)}}return{columnCount:W,columnPositions:de,threeUnitPositions:Ce,columnBoundaries:q,threeUnitBoundaries:Se,dualColumnPositions:Ae,threeUnitDualPositions:ie,columnWidth:se,slotWidths:Z,internalWidth:V,internalStartX:X,threeUnitColumnWidth:Xr.mmToThreeUnits(se),zones:ee}}const t=ga(e),i=e.width,r=Xr.calculateInternalWidth(e);let s;e.mainDoorCount!==void 0&&e.mainDoorCount>0?s=e.mainDoorCount:e.customColumnCount?s=e.customColumnCount:s=Xr.getDefaultColumnCount(r);const o=e.surroundType==="no-surround",a=[];if(o&&e.installType==="freestanding"){const K=Math.floor(i/s),V=i%s;for(let Q=0;Q<s;Q++){let X=Q<V?K+1:K;(Q===0||Q===s-1)&&(X=X-mi),a.push(X)}console.log("🔧 노서라운드 벽없음 슬롯 계산:",{"전체 공간 너비":i,"컬럼 수":s,"기본 슬롯 너비":K,"슬롯 너비 배열":a,예시:`${a[0]} / ${a[1]||"..."} / ... / ${a[a.length-1]}`})}else if(o&&(e.installType==="semistanding"||e.installType==="semi-standing")){const K=Math.floor(i/s),V=i%s;for(let Q=0;Q<s;Q++){let X=K;Q<V&&(X+=1),(!((k=e.wallConfig)!=null&&k.left)&&Q===0||!((B=e.wallConfig)!=null&&B.right)&&Q===s-1)&&(X-=mi),a.push(X)}console.log("🔧 노서라운드 한쪽벽 슬롯 계산 (커버도어 방식):",{"전체 공간 너비":i,"컬럼 수":s,"기본 슬롯 너비":K,"슬롯 너비 배열":a,"벽 위치":(E=e.wallConfig)!=null&&E.left?"좌측":"우측","첫 슬롯":a[0],"마지막 슬롯":a[a.length-1],"엔드패널 위치":(z=e.wallConfig)!=null&&z.left?(te=e.wallConfig)!=null&&te.right?"없음":"우측":"좌측"})}else{const K=Math.floor(r/s),V=r%s;console.log("🔍 [ColumnIndexer] 슬롯 너비 계산 (builtin+no-surround or surround):",{surroundType:e.surroundType,installType:e.installType,totalWidth:i,internalWidth:r,columnCount:s,baseWidth:K,remainder:V});for(let Q=0;Q<s;Q++)a.push(Q<V?K+1:K)}const l=Math.floor(r/s),h=0;let u;if(e.surroundType==="no-surround"){let K=0;if(e.installType==="builtin"||e.installType==="built-in"){const V=((L=e.gapConfig)==null?void 0:L.left)||0;K=V,console.log("🔍 [ColumnIndexer] builtin+no-surround 위치 계산:",{surroundType:e.surroundType,installType:e.installType,gapConfig:e.gapConfig,leftReduction:V,reason:"builtin+no-surround는 이격거리 적용"})}else(e.installType==="semistanding"||e.installType==="semi-standing")&&(O=e.wallConfig)!=null&&O.left?K=((J=e.gapConfig)==null?void 0:J.left)||0:K=mi;u=-(i/2)+K+h}else u=-(i/2)+t.left+h;const d=[];let A;o&&e.installType==="freestanding"?A=-(i/2)+mi:o&&(e.installType==="semistanding"||e.installType==="semi-standing")?($=e.wallConfig)!=null&&$.left?A=-(i/2):A=-(i/2)+mi:A=u,d.push(A);for(let K=0;K<s;K++)A+=a[K],d.push(A);const f=[];for(let K=0;K<s;K++){const V=d[K],Q=d[K+1],X=(V+Q)/2;f.push(X)}const p=f.map(K=>Xr.mmToThreeUnits(K)),g=d.map(K=>Xr.mmToThreeUnits(K));s===7&&console.log("🚨🚨🚨 컬럼 수 7 - 슬롯 위치 계산 상세:",{columnCount:s,internalWidth:r,internalStartX:u,columnWidth:l,slotWidths:a,columnPositions:f,columnBoundaries:d,threeUnitPositions:p,"첫번째 슬롯":{index:0,mmCenter:f[0],threeUnitsCenter:p[0],width:a[0]},"마지막 슬롯":{index:s-1,mmCenter:f[s-1],threeUnitsCenter:p[s-1],width:a[s-1]},"전체 폭":i,내경:r}),e.surroundType==="no-surround"&&e.gapConfig&&console.log(`🎯 [가구위치] 노서라운드 모드 - 좌측이격거리${e.gapConfig.left}mm, 우측이격거리${e.gapConfig.right}mm:`,{totalWidth:i,internalWidth:r,internalStartX:u,첫번째슬롯위치:(U=p[0])==null?void 0:U.toFixed(3),마지막슬롯위치:(Y=p[p.length-1])==null?void 0:Y.toFixed(3)});const v=[],w=[];for(let K=0;K<s-1;K++){const V=d[K],Q=d[K+2],X=(V+Q)/2;v.push(X),w.push(Xr.mmToThreeUnits(X)),o&&(K===0||K===s-2)&&console.log(`🎯 듀얼 가구 위치 계산 [슬롯 ${K}-${K+1}]:`,{leftSlotWidth:a[K],rightSlotWidth:a[K+1],leftSlotStart:V,rightSlotEnd:Q,totalWidth:Q-V,dualCenterPosition:X,설명:"두 슬롯 전체 영역의 중심"})}return{columnCount:s,columnPositions:f,threeUnitPositions:p,columnBoundaries:d,threeUnitBoundaries:g,dualColumnPositions:v,threeUnitDualPositions:w,columnWidth:l,slotWidths:a,internalWidth:r,internalStartX:u,threeUnitColumnWidth:Xr.mmToThreeUnits(l)}}static findClosestColumnIndex(e,t){const{threeUnitPositions:i,threeUnitBoundaries:r,columnCount:s}=t,o=r[0],a=r[s];if(e.x<o)return 0;if(e.x>a)return s-1;for(let d=0;d<s;d++){const A=r[d],f=r[d+1];if(e.x>=A&&e.x<=f)return d}let l=0,h=Number.MAX_VALUE;return i.map((d,A)=>{const f=Math.abs(e.x-d);return{index:A,columnX:d,distance:f}}).forEach(({index:d,distance:A})=>{A<h&&(h=A,l=d)}),l}static findSlotIndexFromPosition(e,t,i=!1){return i&&t.threeUnitDualPositions?t.threeUnitDualPositions.findIndex(s=>Math.abs(s-e.x)<.1):t.threeUnitPositions.findIndex(s=>Math.abs(s-e.x)<.1)}static calculateZoneSlotInfo(e,t){var L,O,J,$,U,Y,K,V,Q,X,W,se,q,de,Ce,Se,fe,M,Z;console.log("🔍🔍 [calculateZoneSlotInfo] 함수 시작:",{surroundType:e.surroundType,installType:e.installType,droppedCeilingEnabled:(L=e.droppedCeiling)==null?void 0:L.enabled,droppedCeilingPosition:(O=e.droppedCeiling)==null?void 0:O.position,droppedCeilingWidth:(J=e.droppedCeiling)==null?void 0:J.width,frameSize:e.frameSize,customColumnCount:t}),(e==null?void 0:e.surroundType)==="no-surround"&&(e!=null&&e.frameSize)&&(e.frameSize.left>0||e.frameSize.right>0)&&(console.error("🚨🚨🚨 [calculateZoneSlotInfo] 노서라운드 모드인데 frameSize가 0이 아님! 강제로 0으로 수정합니다.",{"원래 frameSize":e.frameSize,surroundType:e.surroundType,installType:e.installType,설명:"노서라운드 모드에서는 frameSize가 모두 0이어야 합니다!"}),e={...e,frameSize:{left:0,right:0,top:0}});const i=ga(e),r=600;if(!(e.droppedCeiling&&e.droppedCeiling.enabled===!0&&e.droppedCeiling.width&&e.droppedCeiling.width>0)){const Ae=Xr.calculateInternalWidth(e);let ie;e.mainDoorCount!==void 0&&e.mainDoorCount>0?ie=e.mainDoorCount:t?ie=t:ie=Xr.getDefaultColumnCount(Ae);const ee=Math.ceil(Ae/r);ie<ee&&(ie=ee,console.warn(`슬롯 너비 제한: ${ee}개 이상의 슬롯이 필요합니다.`));const ae=Math.floor(Ae/ie);let me=Ae;if(e.surroundType==="no-surround"){if(e.installType==="freestanding")me=e.width-mi*2;else if(e.installType==="semistanding"||e.installType==="semi-standing")me=e.width,($=e.wallConfig)!=null&&$.left||(me-=mi),(U=e.wallConfig)!=null&&U.right||(me-=mi);else if(e.installType==="builtin"||e.installType==="built-in"){const De=((Y=e.gapConfig)==null?void 0:Y.left)||0,qe=((K=e.gapConfig)==null?void 0:K.right)||0;me=e.width-De-qe}}let _e,ue=0;if(e.surroundType==="no-surround")if(e.installType==="builtin"||e.installType==="built-in")ue=((V=e.gapConfig)==null?void 0:V.left)||0,_e=-(e.width/2)+ue;else if(e.installType==="semistanding"||e.installType==="semi-standing")if((Q=e.wallConfig)!=null&&Q.left){const De=((X=e.gapConfig)==null?void 0:X.left)||0;ue=De,_e=-(e.width/2)+De}else ue=mi,_e=-(e.width/2)+mi;else ue=mi,_e=-(e.width/2)+mi;else _e=-(e.width/2)+i.left;console.log("🔍 calculateZoneSlotInfo 시작점 계산:",{surroundType:e.surroundType,installType:e.installType,wallConfig:e.wallConfig,gapConfig:e.gapConfig,leftReduction:ue,internalStartX:_e,actualInternalWidth:me,전체너비:e.width});const Be=[];if(e.surroundType==="no-surround"&&e.installType==="freestanding"){const De=Math.floor(me/ie),qe=me%ie;for(let Je=0;Je<ie;Je++){let Me=Je<qe?De+1:De;Be.push(Me)}}else if(e.surroundType==="no-surround"&&(e.installType==="semistanding"||e.installType==="semi-standing")){const De=Math.floor(me/ie),qe=me%ie;for(let Je=0;Je<ie;Je++){let Me=De;Je<qe&&(Me+=1),Be.push(Me)}}else{const De=Math.floor(Ae/ie),qe=Ae%ie;for(let Je=0;Je<ie;Je++)Be.push(Je<qe?De+1:De)}console.log("🔍 calculateZoneSlotInfo (단내림 없음):",{surroundType:e.surroundType,installType:e.installType,totalWidth:e.width,internalWidth:Ae,actualInternalWidth:me,internalStartX:_e,columnCount:ie,columnWidth:ae,slotWidths:Be,"첫 슬롯 너비":Be[0],"마지막 슬롯 너비":Be[Be.length-1],"슬롯 너비 합계":Be.reduce((De,qe)=>De+qe,0)});const it={normal:{startX:_e,width:me,columnCount:ie,columnWidth:ae,slotWidths:Be},dropped:null};return console.log("🔍🔍 [calculateZoneSlotInfo] 단내림 없음 - 반환값:",{hasNormal:!!it.normal,hasDropped:!!it.dropped,result:it}),it}const o=e.width,a=e.droppedCeiling.width||ea.WIDTH,l=e.droppedCeiling.position||"right";console.log("🔍🔍 [calculateZoneSlotInfo] 단내림 활성화 처리:",{totalWidth:o,droppedWidth:a,droppedPosition:l,droppedCeilingData:e.droppedCeiling,surroundType:e.surroundType,installType:e.installType}),Xr.calculateInternalWidth(e);let h;if(e.surroundType==="no-surround")if(e.installType==="builtin"||e.installType==="built-in"){const Ae=((W=e.gapConfig)==null?void 0:W.left)||0;h=-(o/2)+Ae}else if(e.installType==="semistanding"||e.installType==="semi-standing")if((se=e.wallConfig)!=null&&se.left){const Ae=((q=e.gapConfig)==null?void 0:q.left)||0;h=-(o/2)+Ae}else h=-(o/2)+mi;else h=-(o/2)+mi;else h=-(o/2)+i.left;const u=o-a,d=a,A=Xr.calculateDroppedZoneInternalWidth(e);let p=Xr.calculateNormalZoneInternalWidth(e),g=A||0,v,w;if(console.log("🎯 [calculateZoneSlotInfo] SpaceCalculator 영역별 내경 계산:",{"단내림 영역 내경":g,"일반 영역 내경":p,spaceInfo:{surroundType:e.surroundType,installType:e.installType,wallConfig:e.wallConfig,gapConfig:e.gapConfig}}),l==="left")if(e.surroundType==="surround")w=h,v=w+(d-i.left),console.log("🔍 서라운드 왼쪽 단내림 경계 계산:",{"단내림 끝":w+g,"메인 시작":v,갭:v-(w+g),"프레임 두께":i,"spaceInfo.gapConfig":e.gapConfig,"spaceInfo.wallConfig":e.wallConfig,"spaceInfo.installType":e.installType});else{let Ae=0;e.installType==="builtin"||e.installType==="built-in"?Ae=((de=e.gapConfig)==null?void 0:de.left)||0:(e.installType==="semistanding"||e.installType==="semi-standing")&&(Ce=e.wallConfig)!=null&&Ce.left?Ae=((Se=e.gapConfig)==null?void 0:Se.left)||0:Ae=mi,w=-(o/2)+Ae,v=-(o/2)+d,console.log("🔍 노서라운드 왼쪽 단내림 경계 계산:",{"단내림 영역":{외부너비:d,내부너비:g,reduction:Ae,시작X:w,끝X:w+g,"벽 위치":-(o/2),"벽에서 슬롯까지":Ae},"일반 영역":{외부너비:u,내부너비:p,시작X:v,끝X:v+p,"영역간 갭":v-(w+g)},전체:{totalWidth:o,wallConfig:e.wallConfig,gapConfig:e.gapConfig,installType:e.installType}})}else if(e.surroundType==="surround")v=h,w=v+(u-i.left),console.log("🔍 서라운드 오른쪽 단내림 경계 계산:",{"메인 끝":v+p,"단내림 시작":w,갭:w-(v+p),"프레임 두께":i,"spaceInfo.gapConfig":e.gapConfig,"spaceInfo.wallConfig":e.wallConfig,"spaceInfo.installType":e.installType});else{let Ae=0;e.installType==="builtin"||e.installType==="built-in"?Ae=((fe=e.gapConfig)==null?void 0:fe.left)||0:(e.installType==="semistanding"||e.installType==="semi-standing")&&(M=e.wallConfig)!=null&&M.left?Ae=((Z=e.gapConfig)==null?void 0:Z.left)||0:Ae=mi,v=-(o/2)+Ae,w=-(o/2)+u,console.log("🔍 노서라운드 오른쪽 단내림 경계 계산:",{"일반 영역":{외부너비:u,내부너비:p,reduction:Ae,시작X:v,끝X:v+p},"단내림 영역":{외부너비:d,내부너비:g,시작X:w,끝X:w+g,"영역간 갭":w-(v+p)},전체:{totalWidth:o,wallConfig:e.wallConfig,gapConfig:e.gapConfig,installType:e.installType}})}let m,y;e.mainDoorCount!==void 0&&e.mainDoorCount>0?m=e.mainDoorCount:t?m=t:m=Xr.getDefaultColumnCount(p);const x=Math.ceil(p/r);m<x&&(m=x,console.warn(`메인 영역 슬롯 너비 제한: ${x}개 이상의 슬롯이 필요합니다.`)),e.droppedCeilingDoorCount!==void 0&&e.droppedCeilingDoorCount>0?y=e.droppedCeilingDoorCount:(y=Xr.getDefaultColumnCount(g),console.log("🎯 단내림 컬럼 수 (자동계산):",y,"from width:",g));const S=Math.ceil(g/r);y<S&&(y=S,console.warn(`단내림 영역 슬롯 너비 제한: ${S}개 이상의 슬롯이 필요합니다.`));const I=Math.floor(p/m),j=p%m,C=Math.floor(g/y),b=g%y,D=[],T=[];if(e.surroundType==="no-surround"&&(e.installType==="builtin"||e.installType==="built-in"||e.installType==="semistanding"||e.installType==="semi-standing"||e.installType==="freestanding")){const Ae=Math.floor(p/m),ie=p%m;for(let me=0;me<m;me++){let _e=me<ie?Ae+1:Ae;D.push(_e)}const ee=Math.floor(g/y),ae=g%y;console.log("🚨🚨🚨 단내림 영역 슬롯 너비 계산:",{droppedAreaInternalWidth:g,droppedColumnCount:y,droppedBaseSlotWidth:ee,droppedOuterRemainder:ae,계산식:`floor(${g} / ${y}) = ${ee}, remainder = ${ae}`});for(let me=0;me<y;me++){let _e=me<ae?ee+1:ee;T.push(_e)}console.log("🔧 노서라운드 슬롯 너비 (엔드패널 중복 차감 제거):",{installType:e.installType,wallConfig:e.wallConfig,droppedPosition:l,normalAreaInternalWidth:p,normalSlotWidths:D,droppedAreaInternalWidth:g,droppedSlotWidths:T,설명:"내부 너비 계산 시 이미 엔드패널 두께를 뺐으므로 슬롯 너비에서 추가로 빼지 않음"})}else{for(let Ae=0;Ae<m;Ae++)D.push(Ae<j?I+1:I);for(let Ae=0;Ae<y;Ae++)T.push(Ae<b?C+1:C)}const k=I,B=C,E=v+p,z=w+g;console.log("🎯 단내림 경계 상세 분석:",{서라운드타입:e.surroundType,단내림위치:l,메인구간:{시작X:v,끝X:E,내부너비:p,슬롯너비:k,슬롯개수:m},단내림구간:{시작X:w,끝X:z,내부너비:g,슬롯너비:B,슬롯개수:y},경계갭:l==="right"?w-E:v-z,예상갭:0}),k>r&&console.error(`⚠️ 메인 영역 슬롯 너비가 600mm를 초과합니다: ${k}mm`),B>r&&console.error(`⚠️ 단내림 영역 슬롯 너비가 600mm를 초과합니다: ${B}mm`),console.log("🎯 [calculateZoneSlotInfo] 최종 계산 결과:",{메인구간:{외부너비:u,내부너비:p,슬롯개수:m,슬롯너비:k,시작위치:v,끝위치:v+p},단내림구간:{외부너비:d,내부너비:g,슬롯개수:y,슬롯너비:B,시작위치:w,끝위치:w+g},프레임정보:{왼쪽프레임:i.left,오른쪽프레임:i.right,서라운드타입:e.surroundType,단내림위치:l},갭확인:{"메인끝-단내림시작":l==="right"?w-(v+p):v-(w+g),예상값:0},설정값:{mainDoorCount:e.mainDoorCount,droppedCeilingDoorCount:e.droppedCeilingDoorCount,customColumnCount:t}});const te={normal:{startX:v,width:p,columnCount:m,columnWidth:k,slotWidths:D},dropped:{startX:w,width:g,columnCount:y,columnWidth:B,slotWidths:T}};return e.surroundType==="no-surround"&&console.log("🚨🚨🚨 슬롯 계산 최종 결과 (노서라운드 체크):",{installType:e.installType,wallConfig:e.wallConfig,gapConfig:e.gapConfig,droppedPosition:l,"단내림 영역":{"시작 X":w,너비:g,"끝 X":w+g},"일반 영역":{"시작 X":v,너비:p,"끝 X":v+p},"전체 공간":{"총 너비":o,"왼쪽 끝":-(o/2),"오른쪽 끝":o/2}}),console.log("🔍🔍 [calculateZoneSlotInfo] 최종 반환값:",{hasNormal:!!te.normal,hasDropped:!!te.dropped,normal:te.normal,dropped:te.dropped}),te}static getColumnLimits(e){const r=Math.max(1,Math.ceil(e/600)),s=Math.max(1,Math.floor(e/400));return r>s?{minColumns:1,maxColumns:1}:(console.log("🔧 getColumnLimits 계산:",{internalWidth:e,minColumns:r,maxColumns:s,"최소 슬롯 크기 (최대 컬럼수일 때)":Math.floor(e/s),"최대 슬롯 크기 (최소 컬럼수일 때)":Math.floor(e/r)}),{minColumns:r,maxColumns:s})}static findZoneAndSlotFromPosition(e,t,i){var a;if(!((a=t.droppedCeiling)!=null&&a.enabled))return{zone:"normal",slotIndex:this.findClosestColumnIndex({x:Xr.mmToThreeUnits(e.x)},i)};const r=this.calculateZoneSlotInfo(t,t.customColumnCount);if(!r.dropped)return null;const s=r.dropped.startX+r.dropped.width,o=r.normal.startX+r.normal.width;if(e.x>=r.dropped.startX&&e.x<=s){const l=e.x-r.dropped.startX,h=Math.floor(l/r.dropped.columnWidth);return{zone:"dropped",slotIndex:Math.min(h,r.dropped.columnCount-1)}}if(e.x>=r.normal.startX&&e.x<=o){const l=e.x-r.normal.startX,h=Math.floor(l/r.normal.columnWidth);return{zone:"normal",slotIndex:Math.min(h,r.normal.columnCount-1)}}return null}}const pr=ar.calculateSpaceIndexing;ar.findClosestColumnIndex;const Soe=Xr.calculateInternalWidth,Toe=ar.findSlotIndexFromPosition,Bi={BASIC_THICKNESS:18,DEFAULT_DEPTH:600,TYPE1_DRAWER_HEIGHT:600,TYPE2_BOTTOM_HEIGHT:1025,TYPE4_DRAWER_HEIGHT:1e3,DRAWER_HEIGHTS_2TIER:[255,255],DRAWER_HEIGHTS_4TIER:[255,255,176,176],DRAWER_GAP:24,STYLER_WIDTH:694,PANTSHANGER_WIDTH:564,SAFETY_SHELF_POSITION:2050,SAFETY_SHELF_THRESHOLD:2300,COLORS:{TYPE1:"#8D6E63",TYPE2:"#303F9F",TYPE4:"#0097A7",STYLER:"#4CAF50",PANTSHANGER:"#9C27B0"}},Up=(n,e,t=Bi.SAFETY_SHELF_POSITION,i=Bi.SAFETY_SHELF_THRESHOLD)=>{if(e<=i)return n;let r=0;return n.map(s=>{const o=r,a=r+s.height;if(r+=s.height,s.type==="hanging"&&t>=o&&t<a){const l=t-o;return{...s,count:1,shelfPositions:[l]}}return s})},Cl=(n,e,t,i,r,s,o,a,l)=>({id:n,name:e,category:l||"full",dimensions:{width:t,height:i,depth:r},color:s,description:o,isDynamic:!0,hasDoor:!0,widthOptions:[t],type:"box",defaultDepth:a||Bi.DEFAULT_DEPTH,modelConfig:{basicThickness:Bi.BASIC_THICKNESS,hasOpenFront:!0}}),Boe=(n,e)=>{const t=Bi.TYPE1_DRAWER_HEIGHT,i=e-t,r=[{type:"drawer",heightType:"absolute",height:t,count:2,drawerHeights:Bi.DRAWER_HEIGHTS_2TIER,gapHeight:Bi.DRAWER_GAP},{type:"hanging",heightType:"absolute",height:i}],s=Up(r,e),o=Cl(`single-2drawer-hanging-${n}`,`2단서랍+옷장 ${n}mm`,n,e,Bi.DEFAULT_DEPTH,Bi.COLORS.TYPE1,e>Bi.SAFETY_SHELF_THRESHOLD?"하단 2단 서랍장 + 상단 옷장 (안전선반 포함)":"하단 2단 서랍장 + 상단 옷장",Bi.DEFAULT_DEPTH);return{...o,modelConfig:{...o.modelConfig,sections:s}}},Eoe=(n,e)=>{const t=Bi.TYPE2_BOTTOM_HEIGHT,i=e-t,s=Up([{type:"hanging",heightType:"absolute",height:t,shelfPositions:[]},{type:"hanging",heightType:"absolute",height:i}],e),o=Cl(`single-2hanging-${n}`,`2단 옷장 ${n}mm`,n,e,Bi.DEFAULT_DEPTH,Bi.COLORS.TYPE2,e>Bi.SAFETY_SHELF_THRESHOLD?"하단 짧은옷장 + 상단 긴옷장 (안전선반 포함)":"하단 짧은옷장 + 상단 긴옷장");return{...o,modelConfig:{...o.modelConfig,sections:s}}},Foe=(n,e)=>{const t=Bi.TYPE4_DRAWER_HEIGHT,i=e-t,r=[{type:"drawer",heightType:"absolute",height:t,count:4,drawerHeights:Bi.DRAWER_HEIGHTS_4TIER,gapHeight:Bi.DRAWER_GAP},{type:"hanging",heightType:"absolute",height:i}],s=Up(r,e),o=Cl(`single-4drawer-hanging-${n}`,`4단서랍+옷장 ${n}mm`,n,e,Bi.DEFAULT_DEPTH,Bi.COLORS.TYPE4,e>Bi.SAFETY_SHELF_THRESHOLD?"4단 서랍장 + 옷장 복합형 (안전선반 포함)":"4단 서랍장 + 옷장 복합형");return{...o,modelConfig:{...o.modelConfig,sections:s}}},koe=(n,e,t)=>{const i=Bi.TYPE1_DRAWER_HEIGHT,r=e-i,s=[{type:"drawer",heightType:"absolute",height:i,count:2,drawerHeights:Bi.DRAWER_HEIGHTS_2TIER,gapHeight:Bi.DRAWER_GAP},{type:"hanging",heightType:"absolute",height:r}],o=Up(s,e),a=Cl(`dual-2drawer-hanging-${n}`,`듀얼 2단서랍+옷장 ${n}mm`,n,e,Bi.DEFAULT_DEPTH,Bi.COLORS.TYPE1,e>Bi.SAFETY_SHELF_THRESHOLD?"듀얼 하단 2단 서랍장 + 상단 옷장 (안전선반 포함)":"듀얼 하단 2단 서랍장 + 상단 옷장");return{...a,slotWidths:t,modelConfig:{...a.modelConfig,sections:o}}},Ioe=(n,e,t)=>{const i=Bi.TYPE2_BOTTOM_HEIGHT,r=e-i,o=Up([{type:"hanging",heightType:"absolute",height:i,shelfPositions:[]},{type:"hanging",heightType:"absolute",height:r}],e),a=Cl(`dual-2hanging-${n}`,`듀얼 2단 옷장 ${n}mm`,n,e,Bi.DEFAULT_DEPTH,Bi.COLORS.TYPE2,e>Bi.SAFETY_SHELF_THRESHOLD?"듀얼 하단 짧은옷장 + 상단 긴옷장 (안전선반 포함)":"듀얼 하단 짧은옷장 + 상단 긴옷장");return{...a,slotWidths:t,modelConfig:{...a.modelConfig,sections:o}}},Doe=(n,e,t)=>{const i=Bi.TYPE4_DRAWER_HEIGHT,r=e-i,s=[{type:"drawer",heightType:"absolute",height:i,count:4,drawerHeights:Bi.DRAWER_HEIGHTS_4TIER,gapHeight:Bi.DRAWER_GAP},{type:"hanging",heightType:"absolute",height:r}],o=Up(s,e),a=Cl(`dual-4drawer-hanging-${n}`,`듀얼 4단서랍+옷장 ${n}mm`,n,e,Bi.DEFAULT_DEPTH,Bi.COLORS.TYPE4,e>Bi.SAFETY_SHELF_THRESHOLD?"듀얼 4단 서랍장 + 옷장 복합형 (안전선반 포함)":"듀얼 4단 서랍장 + 옷장 복합형");return{...a,slotWidths:t,modelConfig:{...a.modelConfig,sections:o}}},joe=(n,e,t)=>{const i=Bi.TYPE1_DRAWER_HEIGHT,r=e-i,s=[{type:"drawer",heightType:"absolute",height:i,count:2,drawerHeights:Bi.DRAWER_HEIGHTS_2TIER,gapHeight:Bi.DRAWER_GAP},{type:"hanging",heightType:"absolute",height:r}],a=[{type:"hanging",heightType:"absolute",height:i+r}],l=Up(s,e),h=Up(a,e),u=Cl(`dual-2drawer-styler-${n}`,`듀얼 서랍+스타일러 ${n}mm`,n,e,600,Bi.COLORS.STYLER,e>Bi.SAFETY_SHELF_THRESHOLD?"좌측 서랍+옷장 + 우측 스타일러장 (안전선반 포함)":"좌측 서랍+옷장 + 우측 스타일러장",600);return{...u,slotWidths:t,modelConfig:{...u.modelConfig,rightAbsoluteWidth:Bi.STYLER_WIDTH,rightAbsoluteDepth:660,hasSharedMiddlePanel:!1,leftSections:l,rightSections:h}}},Poe=(n,e,t)=>{const i=Bi.TYPE4_DRAWER_HEIGHT,r=e-i,s=Cl(`dual-4drawer-pantshanger-${n}`,`듀얼 서랍+바지걸이 ${n}mm`,n,e,Bi.DEFAULT_DEPTH,Bi.COLORS.PANTSHANGER,e>Bi.SAFETY_SHELF_THRESHOLD?"좌측 4단서랍+옷장 + 우측 바지걸이+옷장 (통합 안전선반)":"좌측 4단서랍+옷장 + 우측 바지걸이+옷장");return{...s,slotWidths:t,modelConfig:{...s.modelConfig,rightAbsoluteWidth:Bi.PANTSHANGER_WIDTH,hasSharedMiddlePanel:!0,middlePanelHeight:i,hasSharedSafetyShelf:e>Bi.SAFETY_SHELF_THRESHOLD,safetyShelfHeight:Bi.SAFETY_SHELF_POSITION,leftSections:[{type:"drawer",heightType:"absolute",height:i,count:4,drawerHeights:Bi.DRAWER_HEIGHTS_4TIER,gapHeight:Bi.DRAWER_GAP},{type:"hanging",heightType:"absolute",height:r}],rightSections:[{type:"hanging",heightType:"absolute",height:i},{type:"hanging",heightType:"absolute",height:r}]}}},Noe=n=>{const e=Cl(`upper-cabinet-shelf-${n}`,`상부장 선반형 ${n}mm`,n,600,Bi.DEFAULT_DEPTH,"#e8f5e9","상부장 선반 2단형",Bi.DEFAULT_DEPTH,"upper");return{...e,hasDoor:!0,modelConfig:{...e.modelConfig,sections:[{type:"shelf",heightType:"percentage",height:100,count:2}]}}},Loe=n=>{const e=Cl(`upper-cabinet-2tier-${n}`,`상부장 2단형 ${n}mm`,n,600,Bi.DEFAULT_DEPTH,"#e3f2fd","상부장 2단형 (중간 선반 1개)",Bi.DEFAULT_DEPTH,"upper");return{...e,modelConfig:{...e.modelConfig,sections:[{type:"shelf",heightType:"percentage",height:100,count:1}]}}},Moe=n=>{const e=Cl(`upper-cabinet-open-${n}`,`상부장 오픈형 ${n}mm`,n,600,Bi.DEFAULT_DEPTH,"#fff3e0","상부장 오픈형",Bi.DEFAULT_DEPTH,"upper");return{...e,modelConfig:{...e.modelConfig,sections:[{type:"open",heightType:"percentage",height:100}]}}},Roe=n=>{const e=Cl(`upper-cabinet-mixed-${n}`,`상부장 혼합형 ${n}mm`,n,600,Bi.DEFAULT_DEPTH,"#f3e5f5","상부장 혼합형 (오픈+선반)",Bi.DEFAULT_DEPTH,"upper");return{...e,modelConfig:{...e.modelConfig,sections:[{type:"shelf",heightType:"percentage",height:50,count:1},{type:"open",heightType:"percentage",height:50}]}}},Uoe=n=>{const e=Cl(`lower-cabinet-basic-${n}`,`하부장 ${n}mm`,n,1e3,600,"#fff3e0",`하부장 기본형 W${n}xH1000xD600`,600,"lower");return{...e,isDynamic:!0,defaultDepth:600,modelConfig:{...e.modelConfig,basicThickness:Bi.BASIC_THICKNESS,hasOpenFront:!1,sections:[{type:"shelf",heightType:"percentage",height:100,count:2}]}}},Ooe=n=>{const e=Cl(`lower-cabinet-2tier-${n}`,`하부장 2단형 ${n}mm`,n,1e3,600,"#fce4ec","하부장 2단형 (중간 선반 1개)",600,"lower");return{...e,isDynamic:!0,defaultDepth:600,modelConfig:{...e.modelConfig,basicThickness:Bi.BASIC_THICKNESS,hasOpenFront:!1,sections:[{type:"shelf",heightType:"percentage",height:100,count:1}]}}},Hoe=n=>{const e=Cl(`dual-upper-cabinet-shelf-${n}`,`듀얼 상부장 선반형 ${n}mm`,n,600,Bi.DEFAULT_DEPTH,"#c8e6c9","듀얼 상부장 선반 2단형",Bi.DEFAULT_DEPTH,"upper");return{...e,modelConfig:{...e.modelConfig,leftSections:[{type:"shelf",heightType:"percentage",height:100,count:2}],rightSections:[{type:"shelf",heightType:"percentage",height:100,count:2}]}}},Woe=n=>{const e=Cl(`dual-upper-cabinet-2tier-${n}`,`듀얼 상부장 2단형 ${n}mm`,n,600,Bi.DEFAULT_DEPTH,"#bbdefb","듀얼 상부장 2단형 (중간 선반 1개)",Bi.DEFAULT_DEPTH,"upper");return{...e,modelConfig:{...e.modelConfig,leftSections:[{type:"shelf",heightType:"percentage",height:100,count:1}],rightSections:[{type:"shelf",heightType:"percentage",height:100,count:1}]}}},zoe=n=>{const e=Cl(`dual-upper-cabinet-open-${n}`,`듀얼 상부장 오픈형 ${n}mm`,n,600,Bi.DEFAULT_DEPTH,"#ffe0b2","듀얼 상부장 오픈형",Bi.DEFAULT_DEPTH,"upper");return{...e,modelConfig:{...e.modelConfig,leftSections:[{type:"open",heightType:"percentage",height:100}],rightSections:[{type:"open",heightType:"percentage",height:100}]}}},Qoe=n=>{const e=Cl(`dual-upper-cabinet-mixed-${n}`,`듀얼 상부장 혼합형 ${n}mm`,n,600,Bi.DEFAULT_DEPTH,"#e1bee7","듀얼 상부장 혼합형 (오픈+선반)",Bi.DEFAULT_DEPTH,"upper");return{...e,modelConfig:{...e.modelConfig,leftSections:[{type:"shelf",heightType:"percentage",height:50,count:1},{type:"open",heightType:"percentage",height:50}],rightSections:[{type:"shelf",heightType:"percentage",height:50,count:1},{type:"open",heightType:"percentage",height:50}]}}},$oe=n=>{const e=Cl(`dual-lower-cabinet-basic-${n}`,`듀얼 하부장 ${n}mm`,n,1e3,600,"#ffcc80",`듀얼 하부장 기본형 W${n}xH1000xD600`,600,"lower");return{...e,isDynamic:!0,defaultDepth:600,modelConfig:{...e.modelConfig,basicThickness:Bi.BASIC_THICKNESS,hasOpenFront:!1,leftSections:[{type:"shelf",heightType:"percentage",height:100,count:2}],rightSections:[{type:"shelf",heightType:"percentage",height:100,count:2}]}}},Voe=n=>{const e=Cl(`dual-lower-cabinet-2tier-${n}`,`듀얼 하부장 2단형 ${n}mm`,n,1e3,600,"#f8bbd0","듀얼 하부장 2단형 (중간 선반 1개)",600,"lower");return{...e,isDynamic:!0,defaultDepth:600,modelConfig:{...e.modelConfig,basicThickness:Bi.BASIC_THICKNESS,hasOpenFront:!1,leftSections:[{type:"shelf",heightType:"percentage",height:100,count:1}],rightSections:[{type:"shelf",heightType:"percentage",height:100,count:1}]}}},Goe=(n,e)=>{var p,g,v,w,m;let{height:t}=n;if(console.log("🔍 generateShelvingModules - 내부 공간 높이:",{internalSpaceHeight:n.height,maxHeight:t,spaceInfo:{height:e==null?void 0:e.height,baseConfig:e==null?void 0:e.baseConfig,hasFloorFinish:e==null?void 0:e.hasFloorFinish,floorFinishHeight:(p=e==null?void 0:e.floorFinish)==null?void 0:p.height}}),((g=e==null?void 0:e.baseConfig)==null?void 0:g.type)==="stand"&&e.baseConfig.placementType==="float"){const y=e.baseConfig.floatHeight||0;t=t-y}let i;e?i=e:(console.warn("⚠️ [generateShelvingModules] No spaceInfo provided, using defaults"),i={width:n.width,height:2400,depth:600,customColumnCount:Math.max(1,Math.floor(n.width/600)),columnMode:"custom",baseConfig:{type:"wall",placementType:"floor",floatHeight:0},materialConfig:{interior:"#FFFFFF",doorColor:"#E0E0E0"}});let r,s,o,a=null;if(i&&"_tempSlotWidths"in i&&i._tempSlotWidths)o=i._tempSlotWidths,r=o[0],s=o.length,console.log("🎯 [generateShelvingModules] _tempSlotWidths 사용:",{slotWidths:o,columnWidth:r,columnCount:s});else if(a=ar.calculateZoneSlotInfo(i,i.customColumnCount),(v=i.droppedCeiling)!=null&&v.enabled&&i.zone){const y=i.zone;console.log("🎯 [generateShelvingModules] Zone 정보 확인:",{zone:y,droppedCeilingEnabled:(w=i.droppedCeiling)==null?void 0:w.enabled,zoneSlotInfo:{dropped:a.dropped?{columnWidth:a.dropped.columnWidth,columnCount:a.dropped.columnCount,slotWidths:a.dropped.slotWidths}:null,normal:a.normal?{columnWidth:a.normal.columnWidth,columnCount:a.normal.columnCount,slotWidths:a.normal.slotWidths}:null}}),y==="dropped"&&a.dropped?(r=a.dropped.columnWidth,s=a.dropped.columnCount,o=a.dropped.slotWidths,console.log("✅ [generateShelvingModules] 단내림 영역 사용:",{columnWidth:r,columnCount:s,slotWidths:o,zone:"dropped",internalSpaceWidth:n.width,internalSpaceHeight:n.height})):y==="normal"&&a.normal?(r=a.normal.columnWidth,s=a.normal.columnCount,o=a.normal.slotWidths,console.log("✅ [generateShelvingModules] 메인 영역 사용:",{columnWidth:r,columnCount:s,slotWidths:o,zone:"normal",internalSpaceWidth:n.width,internalSpaceHeight:n.height})):(console.warn("⚠️ [generateShelvingModules] Zone 정보는 있지만 해당 zone이 없음, fallback 사용:",{zone:y,availableZones:{dropped:!!a.dropped,normal:!!a.normal}}),r=a.normal.columnWidth,s=a.normal.columnCount,o=a.normal.slotWidths)}else r=a.normal.columnWidth,s=a.normal.columnCount,o=a.normal.slotWidths,console.log("✅ [generateShelvingModules] 일반 계산 사용:",{columnWidth:r,columnCount:s,slotWidths:o,zone:"none",internalSpaceWidth:n.width,internalSpaceHeight:n.height});console.log("🎯 [generateShelvingModules] 계산 결과:",{zone:i.zone,columnWidth:r,columnCount:s,slotWidths:o,zoneSlotInfo:a,droppedCeilingEnabled:(m=i.droppedCeiling)==null?void 0:m.enabled,internalSpaceWidth:n.width,"슬롯별 너비":o||"없음","슬롯 너비 합계":o?o.reduce((y,x)=>y+x,0):0}),r>=680&&r<=720&&console.error("🚨🚨🚨 [generateShelvingModules] 700mm column calculated!",{spaceInfo:e,internalSpace:n,columnWidth:r,columnCount:s,zoneSlotInfo:a});const l=[];console.log("🎯 슬롯 너비 정보:",{zone:i.zone,columnWidth:r,columnCount:s,slotWidths:o,uniqueWidths:o?[...new Set(o)]:[]}),l.push(Boe(r,t)),l.push(Eoe(r,t)),l.push(Foe(r,t));let h;o&&o.length>=2?h=o[0]+o[1]:h=r*2,console.log("🎯🔥 듀얼 가구 생성 체크:",{dualWidth:h,"슬롯 너비 배열":o,"첫번째 슬롯":o?o[0]:null,"두번째 슬롯":o?o[1]:null,"듀얼 너비 계산":o&&o.length>=2?`${o[0]} + ${o[1]} = ${h}`:`${r} × 2 = ${h}`,internalSpaceWidth:n.width,willCreateDual:h<=n.width,zone:i.zone});const u=i.zone==="dropped";if(h<=n.width||u){const y=o&&o.length>=2?[o[0],o[1]]:[Math.floor(h/2),Math.ceil(h/2)];console.log("🔥🔥🔥 듀얼 가구 슬롯 너비 정보:",{dualWidth:h,dualSlotWidths:y,"첫번째 슬롯":y[0],"두번째 슬롯":y[1],합계:y[0]+y[1]}),l.push(koe(h,t,y)),l.push(Ioe(h,t,y)),l.push(Doe(h,t,y)),l.push(joe(h,t,y)),l.push(Poe(h,t,y)),l.push(Hoe(h)),l.push(Woe(h)),l.push(zoe(h)),l.push(Qoe(h)),l.push($oe(h)),l.push(Voe(h))}const d=Noe(r);console.log("🔨 상부장 1 생성:",{id:d.id,name:d.name,category:d.category,dimensions:d.dimensions,internalSpaceHeight:n.height,zone:i.zone}),l.push(d),l.push(Moe(r)),l.push(Roe(r)),l.push(Loe(r));const A=Uoe(r);console.log("🔨 하부장 생성:",{id:A.id,name:A.name,category:A.category,dimensions:A.dimensions,internalSpaceHeight:n.height,zone:i.zone}),l.push(A);const f=Ooe(r);return console.log("🔨 하부장 2단형 생성:",{id:f.id,name:f.name,category:f.category,dimensions:f.dimensions,internalSpaceHeight:n.height,zone:i.zone}),l.push(f),console.log("📊 generateShelvingModules 최종 결과:",{totalModulesCount:l.length,categories:[...new Set(l.map(y=>y.category))],upperCount:l.filter(y=>y.category==="upper").length,lowerCount:l.filter(y=>y.category==="lower").length,fullCount:l.filter(y=>y.category==="full").length}),l},Ak=(n,e)=>[...Goe(n,e)],Fz=[],GS=(n,e,t)=>{console.log("🚨 [getModulesByCategory] Called with:",{category:n,internalSpace:e,spaceInfo:t?{width:t.width,customColumnCount:t.customColumnCount,columnMode:t.columnMode}:null});const i=Ak(e,t),r=Fz,s=[...i,...r],o=s.filter(a=>a.category===n);return console.log("📦 [getModulesByCategory] 모듈 필터링 결과:",{category:n,allModulesCount:s.length,filteredCount:o.length,upperModules:s.filter(a=>a.category==="upper").map(a=>({id:a.id,name:a.name,category:a.category})),lowerModules:s.filter(a=>a.category==="lower").map(a=>({id:a.id,name:a.name,category:a.category})),allCategories:[...new Set(s.map(a=>a.category))],dynamicModulesCount:i.length,staticModulesCount:r.length}),o},Zi=(n,e,t)=>{var o;const i=n.replace(/-\d+$/,""),r=n.match(/-(\d+)$/),s=r?parseInt(r[1]):null;if(console.log("🔍 [getModuleById] 모듈 검색:",{id:n,baseType:i,requestedWidth:s,hasInternalSpace:!!e}),e){let a=t;if(s&&t)if(i.includes("dual-")){const d=Math.floor(s/2);a={...t,_tempSlotWidths:[d,s-d]}}else a={...t,_tempSlotWidths:[s]};t&&t.zone&&(a={...a,zone:t.zone},console.log("🔧 [getModuleById] Zone 정보 유지:",{zone:t.zone,modifiedSpaceInfo:{zone:a.zone,droppedCeilingEnabled:(o=a.droppedCeiling)==null?void 0:o.enabled}}));const l=Ak(e,a);console.log("🔍 [getModuleById] 생성된 모듈 확인:",{searchingId:n,generatedCount:l.length,generatedIds:l.map(u=>u.id),upperModules:l.filter(u=>u.category==="upper").map(u=>u.id),lowerModules:l.filter(u=>u.category==="lower").map(u=>u.id),zone:a.zone,internalSpaceHeight:e.height});const h=l.find(u=>u.id===n);if(h)return console.log("✅ [getModuleById] 모듈 찾음:",{id:h.id,category:h.category,width:h.dimensions.width}),h;console.warn("⚠️ [getModuleById] 모듈을 찾을 수 없음:",{searchingId:n,availableIds:l.map(u=>u.id).slice(0,10)})}return Fz.find(a=>a.id===n)},wj=(n,e,t,i)=>{const u=n.depth;let d;u>=500?d="deep":u===300?d="medium":d="shallow",console.log("🔍 analyzeColumnDepthPlacement 상세:",{columnId:n.id,columnDepth:u,DEPTH_THRESHOLD:500,columnType:d,isShallow:u<500,isColumnC:u===300});const A=n.position[0]-n.width*.01/2,f=n.position[0]+n.width*.01/2,p=Math.max(0,(A-t)*100),g=Math.max(0,(i-f)*100),v=730-u,w=u<500&&v>=200&&(p>=150||g>=150),m=u<150&&v>=580&&(p>=150||g>=150),y=p>=150&&g>=150;let x="single";return y&&(x="split-weighted"),console.log("🏛️ 기둥 깊이 기반 배치 분석:",{columnId:n.id,columnDepth:u,columnType:d,adjustedDepth:v,canPlaceSingle:w,canPlaceDual:m,canSplit:y,leftWidth:p.toFixed(1)+"mm",rightWidth:g.toFixed(1)+"mm",recommendedLayout:x}),{columnType:d,depthAdjustment:{canPlaceSingle:w,canPlaceDual:m,adjustedDepth:v,minDepthMet:v>=200},splitPlacement:{canSplit:y,leftWidth:p,rightWidth:g,recommendedLayout:x}}},Ih=n=>{var r,s,o,a,l,h;const e=pr(n),t=n.columns||[],i=[];if((r=n.droppedCeiling)!=null&&r.enabled){const d=pr(n).zones||ar.calculateZoneSlotInfo(n,n.customColumnCount);if(!d||!d.normal)return console.error("❌ Zone 정보를 가져올 수 없습니다"),i;const A=(((s=d.normal)==null?void 0:s.columnCount)||0)+(((o=d.dropped)==null?void 0:o.columnCount)||0),f=((a=n.droppedCeiling)==null?void 0:a.position)||"right",p=((l=d.dropped)==null?void 0:l.columnCount)||0,g=((h=d.normal)==null?void 0:h.columnCount)||0;for(let v=0;v<A;v++){let w,m,y;if(f==="left"?v<p?(w="dropped",m=v,y=d.dropped):(w="normal",m=v-p,y=d.normal):v<g?(w="normal",m=v,y=d.normal):(w="dropped",m=v-g,y=d.dropped),!y||!y.threeUnitPositions||m>=y.columnCount){const W=(y==null?void 0:y.columnWidth)||e.columnWidth;i.push({slotIndex:v,hasColumn:!1,columnPosition:"edge",availableWidth:W,doorWidth:W-3,needsMullion:!1});continue}const x=y.threeUnitPositions[m],S=y.columnWidth*.01,I=x-S/2,j=x+S/2,C=t.find(W=>{const se=W.position[0]-W.width*.01/2,q=W.position[0]+W.width*.01/2;return se<j&&q>I});if(!C){i.push({slotIndex:v,hasColumn:!1,columnPosition:"edge",availableWidth:y.columnWidth,doorWidth:y.columnWidth-3,needsMullion:!1});continue}const b=C.position[0]-C.width*.01/2,D=C.position[0]+C.width*.01/2,T=(b-I)*100,k=(j-D)*100,E=(()=>{const W=C.width,se=y.columnWidth,q=2;if(console.log("🏛️ 기둥 침범 방향 분석:",{slotIndex:v,zone:w,columnLeftX:b.toFixed(3),columnRightX:D.toFixed(3),slotStartX:I.toFixed(3),slotEndX:j.toFixed(3),leftGap:T.toFixed(1)+"mm",rightGap:k.toFixed(1)+"mm",columnWidthMm:W,slotWidthMm:se}),W>=se-q)return console.log("🏛️ 기둥이 슬롯을 완전히 차지함"),{availableWidth:0,intrusionDirection:"center",furniturePosition:"center",adjustedWidth:0};if(T<=k){const de=Math.max(0,k-q);return console.log("🏛️ 기둥이 왼쪽 영역 침범 → 오른쪽 공간 사용:",{leftGap:T.toFixed(1)+"mm",rightGap:k.toFixed(1)+"mm",rightSpace:de.toFixed(1)+"mm"}),{availableWidth:de,intrusionDirection:"from-left",furniturePosition:"right-aligned",adjustedWidth:de}}else{const de=Math.max(0,T-q);return console.log("🏛️ 기둥이 오른쪽 영역 침범 → 왼쪽 공간 사용:",{leftGap:T.toFixed(1)+"mm",rightGap:k.toFixed(1)+"mm",leftSpace:de.toFixed(1)+"mm"}),{availableWidth:de,intrusionDirection:"from-right",furniturePosition:"left-aligned",adjustedWidth:de}}})(),z=E.availableWidth,te=T>10&&k>10&&z>0;let L;te&&(L=T>k?"right":"left");let O;O="edge";let J=E.adjustedWidth;try{const W=y.columnWidth*.01,se=y.threeUnitPositions[m],q={left:se-W/2,right:se+W/2,center:se},de={slotIndex:v,hasColumn:!0,column:C,columnPosition:O,availableWidth:z,intrusionDirection:E.intrusionDirection,furniturePosition:E.furniturePosition,adjustedWidth:E.adjustedWidth};J=Ad(de,q,n).renderWidth,console.log("🔍 실제 배치 크기 미리 계산:",{slotIndex:v,zone:w,originalAdjustedWidth:E.adjustedWidth,actualRenderWidth:J,improvement:J>E.adjustedWidth?"개선됨":"동일/악화"})}catch(W){console.warn("⚠️ 실제 배치 크기 미리 계산 실패:",W)}let $,U,Y,K,V=!1,Q;const X=wj(C,y.columnWidth,I,j);if($=X.columnType,$==="medium"){U="width-adjustment",V=!1;const W=C.position[0]-C.width*.01/2,se=C.position[0]+C.width*.01/2,q=y.columnWidth*.01,de=y.threeUnitPositions[m],Ce=de-q/2,Se=de+q/2,fe=(W-Ce)*100,M=(Se-se)*100;if(E.intrusionDirection==="from-left"){const Z=se+M*.001/2;Q={left:{availableWidth:0,center:W},right:{availableWidth:M,center:Z}}}else if(E.intrusionDirection==="from-right"){const Z=Ce+fe*.001/2;Q={left:{availableWidth:fe,center:Z},right:{availableWidth:0,center:se}}}console.log("🔵 기둥 C 감지 - 폭 조정 방식 및 서브슬롯 생성:",{slotIndex:v,zone:w,columnDepth:C.depth,columnType:"C (300mm)",columnProcessingMethod:"width-adjustment",availableWidth:E.availableWidth,adjustedWidth:E.adjustedWidth,침범방향:E.intrusionDirection,subSlots:Q?{left:{width:Q.left.availableWidth+"mm",center:Q.left.center.toFixed(3)},right:{width:Q.right.availableWidth+"mm",center:Q.right.center.toFixed(3)}}:void 0})}else $==="shallow"?(U="depth-adjustment",Y=X.depthAdjustment,K=X.splitPlacement):U="width-adjustment";console.log("🔍 기둥 처리 방식 결정:",{slotIndex:v,zone:w,columnDepth:C.depth,columnType:$,columnProcessingMethod:U,allowMultipleFurniture:V}),console.log("🏛️ 슬롯 분석 완료:",{slotIndex:v,zone:w,hasColumn:!0,columnPosition:O,availableWidth:E.availableWidth,actualRenderWidth:J,배치가능여부:J>=150?"✅ 배치 가능":"❌ 배치 불가",intrusionDirection:E.intrusionDirection,furniturePosition:E.furniturePosition,adjustedWidth:E.adjustedWidth,doorWidth:y.columnWidth-3,columnType:$,hasDepthAnalysis:$!==void 0}),i.push({slotIndex:v,hasColumn:!0,column:C,columnPosition:O,availableWidth:z,doorWidth:y.columnWidth-3,needsMullion:te,mullionSide:L,intrusionDirection:E.intrusionDirection,furniturePosition:E.furniturePosition,adjustedWidth:J,columnType:$,columnProcessingMethod:U,depthAdjustment:Y,splitPlacement:K,allowMultipleFurniture:V,subSlots:Q})}return i}else for(let u=0;u<e.columnCount;u++){const d=e.threeUnitPositions[u]-e.columnWidth*.01/2,A=e.threeUnitPositions[u]+e.columnWidth*.01/2,f=t.find(te=>{const L=te.position[0]-te.width*.01/2,O=te.position[0]+te.width*.01/2;return L<A&&O>d});if(!f){i.push({slotIndex:u,hasColumn:!1,columnPosition:"edge",availableWidth:e.columnWidth,doorWidth:e.columnWidth-3,needsMullion:!1});continue}const p=f.position[0]-f.width*.01/2,g=f.position[0]+f.width*.01/2,v=(p-d)*100,w=(A-g)*100,y=(()=>{const te=f.width,L=e.columnWidth,O=2;if(console.log("🏛️ 기둥 침범 방향 분석:",{slotIndex:u,columnLeftX:p.toFixed(3),columnRightX:g.toFixed(3),slotStartX:d.toFixed(3),slotEndX:A.toFixed(3),leftGap:v.toFixed(1)+"mm",rightGap:w.toFixed(1)+"mm",columnWidthMm:te,slotWidthMm:L}),te>=L-O)return console.log("🏛️ 기둥이 슬롯을 완전히 차지함"),{availableWidth:0,intrusionDirection:"center",furniturePosition:"center",adjustedWidth:0};if(v<=w){const J=Math.max(0,w-O);return console.log("🏛️ 기둥이 왼쪽 영역 침범 → 오른쪽 공간 사용:",{leftGap:v.toFixed(1)+"mm",rightGap:w.toFixed(1)+"mm",rightSpace:J.toFixed(1)+"mm"}),{availableWidth:J,intrusionDirection:"from-left",furniturePosition:"right-aligned",adjustedWidth:J}}else{const J=Math.max(0,v-O);return console.log("🏛️ 기둥이 오른쪽 영역 침범 → 왼쪽 공간 사용:",{leftGap:v.toFixed(1)+"mm",rightGap:w.toFixed(1)+"mm",leftSpace:J.toFixed(1)+"mm"}),{availableWidth:J,intrusionDirection:"from-right",furniturePosition:"left-aligned",adjustedWidth:J}}})(),x=y.availableWidth,S=v>10&&w>10&&x>0;let I;S&&(I=v>w?"right":"left");let j;j="edge";let C=y.adjustedWidth;try{const te=e.columnWidth*.01,L=e.threeUnitPositions[u],O={left:L-te/2,right:L+te/2,center:L},J={slotIndex:u,hasColumn:!0,column:f,columnPosition:j,availableWidth:x,intrusionDirection:y.intrusionDirection,furniturePosition:y.furniturePosition,adjustedWidth:y.adjustedWidth};C=Ad(J,O,n).renderWidth,console.log("🔍 실제 배치 크기 미리 계산:",{slotIndex:u,originalAdjustedWidth:y.adjustedWidth,actualRenderWidth:C,improvement:C>y.adjustedWidth?"개선됨":"동일/악화"})}catch(te){console.warn("⚠️ 실제 배치 크기 미리 계산 실패:",te)}let b,D,T,k,B=!1,E;const z=wj(f,e.columnWidth,d,A);if(b=z.columnType,b==="medium"){D="width-adjustment",B=!1;const te=f.position[0]-f.width*.01/2,L=f.position[0]+f.width*.01/2,O=e.columnWidth*.01,J=e.threeUnitPositions[u],$=J-O/2,U=J+O/2,Y=(te-$)*100,K=(U-L)*100;if(y.intrusionDirection==="from-left"){const V=L+K*.001/2;E={left:{availableWidth:0,center:te},right:{availableWidth:K,center:V}}}else if(y.intrusionDirection==="from-right"){const V=$+Y*.001/2;E={left:{availableWidth:Y,center:V},right:{availableWidth:0,center:L}}}console.log("🔵 기둥 C 감지 - 폭 조정 방식 및 서브슬롯 생성:",{slotIndex:u,columnDepth:f.depth,columnType:"C (300mm)",columnProcessingMethod:"width-adjustment",availableWidth:y.availableWidth,adjustedWidth:y.adjustedWidth,침범방향:y.intrusionDirection,subSlots:E?{left:{width:E.left.availableWidth+"mm",center:E.left.center.toFixed(3)},right:{width:E.right.availableWidth+"mm",center:E.right.center.toFixed(3)}}:void 0})}else b==="shallow"?(D="depth-adjustment",T=z.depthAdjustment,k=z.splitPlacement):D="width-adjustment";console.log("🔍 기둥 처리 방식 결정:",{slotIndex:u,columnDepth:f.depth,columnType:b,columnProcessingMethod:D,allowMultipleFurniture:B}),console.log("🏛️ 슬롯 분석 완료:",{slotIndex:u,hasColumn:!0,columnPosition:j,availableWidth:y.availableWidth,actualRenderWidth:C,배치가능여부:C>=150?"✅ 배치 가능":"❌ 배치 불가",intrusionDirection:y.intrusionDirection,furniturePosition:y.furniturePosition,adjustedWidth:y.adjustedWidth,doorWidth:e.columnWidth-3,columnType:b,hasDepthAnalysis:b!==void 0}),i.push({slotIndex:u,hasColumn:!0,column:f,columnPosition:j,availableWidth:x,doorWidth:e.columnWidth-3,needsMullion:S,mullionSide:I,intrusionDirection:y.intrusionDirection,furniturePosition:y.furniturePosition,adjustedWidth:C,columnType:b,columnProcessingMethod:D,depthAdjustment:T,splitPlacement:k,allowMultipleFurniture:B,subSlots:E})}return i},Xoe=(n,e)=>{const i=pr(e).columnWidth*2;return Math.abs(n-i)<50},Yoe=(n,e,t)=>{if(!e.hasColumn)return{shouldConvert:!1};if(!Xoe(n.dimensions.width,t))return{shouldConvert:!1};const r=300;if(e.availableWidth<r)return console.log("⚠️ 듀얼 → 싱글 변환 불가: 공간 부족",{availableWidth:e.availableWidth,minRequiredWidth:r,slotIndex:e.slotIndex}),{shouldConvert:!1};const s={...n,id:n.id.replace("dual-","single-"),name:n.name.replace("듀얼","싱글"),dimensions:{...n.dimensions,width:e.availableWidth}},o=[e.slotIndex];return console.log("🔄 듀얼 → 싱글 변환:",{originalId:n.id,convertedId:s.id,originalWidth:n.dimensions.width,convertedWidth:s.dimensions.width,availableWidth:e.availableWidth,slotIndex:e.slotIndex,occupiedSlots:o,remainingSlotEmpty:e.slotIndex+1}),{shouldConvert:!0,convertedModuleData:s,occupiedSlots:o}},Koe=(n,e,t=!1)=>{if(!n.hasColumn)return!0;if(t)return console.log("🚫 기둥 침범 슬롯에는 듀얼 캐비넷 배치 불가:",{slotIndex:n.slotIndex,reason:"기둥 침범 시 싱글 캐비넷만 배치 가능"}),!1;const i=150,r=n.adjustedWidth||n.availableWidth,s=r>=i;return console.log("🏛️ 기둥 슬롯 배치 가능 여부 확인 (실제 크기 기준):",{slotIndex:n.slotIndex,hasColumn:n.hasColumn,availableWidth:n.availableWidth,adjustedWidth:n.adjustedWidth,actualRenderWidth:r,minRequiredWidth:i,originalFurnitureWidth:e,isDualFurniture:t,intrusionDirection:n.intrusionDirection,furniturePosition:n.furniturePosition,canPlace:s,reason:s?"✅ 배치 가능 (싱글 캐비넷만, 실제 크기 기준)":t?"🚫 듀얼 캐비넷 배치 금지":`❌ 실제 배치 크기(${r}mm)가 최소 필요 너비(${i}mm)보다 작음`}),s},kz=n=>{if(!n.hasColumn)return"right";let e="right";switch(n.intrusionDirection){case"from-left":e="right";break;case"from-right":e="left";break;case"center":n.furniturePosition==="left-aligned"?e="left":n.furniturePosition==="right-aligned"&&(e="right");break;default:e="right"}return console.log("🚪 힌지 방향 계산:",{slotIndex:n.slotIndex,hasColumn:n.hasColumn,intrusionDirection:n.intrusionDirection,furniturePosition:n.furniturePosition,calculatedHinge:e,logic:n.intrusionDirection==="from-left"?"기둥이 왼쪽 침범 → 오른쪽 캐비넷 → 힌지 오른쪽(가구쪽) → 도어는 왼쪽(기둥쪽)으로 열림":n.intrusionDirection==="from-right"?"기둥이 오른쪽 침범 → 왼쪽 캐비넷 → 힌지 왼쪽(가구쪽) → 도어는 오른쪽(기둥쪽)으로 열림":n.intrusionDirection==="center"?`중앙 침범 → ${n.furniturePosition} → 힌지 ${e}(가구쪽) → 도어는 기둥쪽으로 열림`:"기본값"}),e},Ad=(n,e,t)=>{if(t.zone==="dropped"&&console.log("🔧 [calculateFurnitureBounds] 단내림 영역 - 기둥 처리 로직 적용"),!n.hasColumn||!n.column){const m=e.right-e.left;return{left:e.left,right:e.right,center:e.center,width:m*100,renderWidth:m*100}}const i=n.column,r=i.position[0]-i.width*.01/2,s=i.position[0]+i.width*.01/2,o=.002;let a=e.left,l=e.right,h;const u=.005;switch(n.intrusionDirection){case"from-left":a=Math.max(s+o,e.left),l=e.right,a<=s+u&&(a=s+u,console.log("⚠️ 기둥 침범 방지를 위한 추가 마진 적용:",{columnRightX:s.toFixed(3),safetyMargin:u.toFixed(3),adjustedLeft:a.toFixed(3)})),a=Math.max(a,e.left),l=Math.min(l,e.right);const m=l-a;m<.05&&(console.log("🚨 기둥 침범으로 인해 가구 크기가 너무 작아 배치 불가:",{currentWidth:(m*100).toFixed(1)+"mm",columnPosition:s.toFixed(3)}),a=e.left,l=e.left+.05),a<s+o&&(console.log("🚨 최종 기둥 충돌 감지! 강제 조정"),a=s+o,l-a<.05&&(console.log("🚨 가구 크기가 너무 작아 배치 불가능"),a=e.left,l=e.left+.05)),h=(l-a)*100,console.log("🏗️ 왼쪽 침범 - 기둥 충돌 방지 적용:",{columnPosition:s.toFixed(3),finalLeft:a.toFixed(3),finalRight:l.toFixed(3),gap:((a-s)*100).toFixed(1)+"mm",기둥충돌방지:a>s?"✅ 안전":"❌ 위험",newWidth:h.toFixed(1)+"mm",slotIndex:n.slotIndex});break;case"from-right":a=e.left,l=Math.min(r-o,e.right),l>=r-u&&(l=r-u,console.log("⚠️ 기둥 침범 방지를 위한 추가 마진 적용:",{columnLeftX:r.toFixed(3),safetyMargin:u.toFixed(3),adjustedRight:l.toFixed(3)})),a=Math.max(a,e.left),l=Math.min(l,e.right);const y=l-a;y<.05&&(console.log("🚨 기둥 침범으로 인해 가구 크기가 너무 작아 배치 불가:",{currentWidth:(y*100).toFixed(1)+"mm",columnPosition:r.toFixed(3)}),l=e.right,a=e.right-.05),l>r-o&&(console.log("🚨 최종 기둥 충돌 감지! 강제 조정"),l=r-o,l-a<.05&&(console.log("🚨 가구 크기가 너무 작아 배치 불가능"),l=e.right,a=e.right-.05)),h=(l-a)*100,console.log("🏗️ 오른쪽 침범 - 기둥 충돌 방지 적용:",{columnPosition:r.toFixed(3),finalLeft:a.toFixed(3),finalRight:l.toFixed(3),gap:((r-l)*100).toFixed(1)+"mm",기둥충돌방지:l<r?"✅ 안전":"❌ 위험",newWidth:h.toFixed(1)+"mm",slotIndex:n.slotIndex});break;case"center":if(n.furniturePosition==="left-aligned"){a=e.left,l=Math.min(r-o,e.right),l=Math.min(l,e.right);const x=l-a;x<.05&&(console.log("🚨 중앙 침범으로 인해 가구 크기가 너무 작아 배치 불가:",{currentWidth:(x*100).toFixed(1)+"mm"}),a=e.left,l=e.left+.05)}else if(n.furniturePosition==="right-aligned"){a=Math.max(s+o,e.left),l=e.right,a=Math.max(a,e.left);const x=l-a;x<.05&&(console.log("🚨 중앙 침범으로 인해 가구 크기가 너무 작아 배치 불가:",{currentWidth:(x*100).toFixed(1)+"mm"}),l=e.right,a=e.right-.05)}else a=e.left,l=e.right;h=(l-a)*100,console.log("🏗️ 중앙 침범 - 슬롯 경계 제한 적용:",{position:n.furniturePosition,finalLeft:a,finalRight:l,slotBoundaryRespected:a>=e.left&&l<=e.right,newWidth:h,slotIndex:n.slotIndex});break;default:h=(e.right-e.left)*100}switch(n.intrusionDirection){case"from-left":l=e.right,a=Math.max(a,e.left);break;case"from-right":a=e.left,l=Math.min(l,e.right);break;default:a=Math.max(a,e.left),l=Math.min(l,e.right)}let d=(a+l)/2;const A=(l-a)/2,f=e.left+A,p=e.right-A;d=Math.max(f,Math.min(p,d)),a=d-A,l=d+A;const g=(l-a)*100;let v=g;n.hasColumn?(v=g,console.log("🔧 기둥 침범 시 가구 크기 조정:",{originalWidth:(e.right-e.left)*100,adjustedWidth:v,intrusionDirection:n.intrusionDirection,columnType:n.columnType})):v=Math.max(g,150);let w=!1;if(n.columnType==="medium"&&n.column&&n.column.depth===300){const m=(e.right-e.left)*100,y=m-g;y>=150&&(w=!0,console.log("🟣 Column C 150mm 이상 침범 감지:",{slotWidth:m.toFixed(1)+"mm",availableWidth:g.toFixed(1)+"mm",intrusionAmount:y.toFixed(1)+"mm",depthAdjustmentNeeded:!0}))}return console.log("🏗️ 최종 가구 경계 (방향성 유지):",{intrusionDirection:n.intrusionDirection,slotBounds:{left:e.left.toFixed(3),right:e.right.toFixed(3),center:e.center.toFixed(3)},furnitureBounds:{left:a.toFixed(3),right:l.toFixed(3),center:d.toFixed(3)},width:v,columnType:n.columnType,depthAdjustmentNeeded:w,logic:n.intrusionDirection==="from-left"?"왼쪽 침범 → 오른쪽 경계 고정, 왼쪽만 조정":n.intrusionDirection==="from-right"?"오른쪽 침범 → 왼쪽 경계 고정, 오른쪽만 조정":"일반 케이스 → 양쪽 조정"}),{left:a,right:l,center:d,width:g,renderWidth:v,depthAdjustmentNeeded:w}},pi=w1((n,e)=>({placedModules:[],selectedLibraryModuleId:null,selectedPlacedModuleId:null,selectedFurnitureId:null,isFurniturePlacementMode:!1,editMode:!1,editingModuleId:null,currentDragData:null,addModule:t=>{console.log("🟢🟢🟢 [Store] addModule 함수 진입!!!",{id:t.id,moduleId:t.moduleId,slotIndex:t.slotIndex,isDualSlot:t.isDualSlot,position:t.position});const r=e().placedModules,s=t.slotIndex,o=t.zone,a=t.isDualSlot;let l=s;if(l==null){console.warn("⚠️ [Store] slotIndex가 undefined! position으로부터 계산 시도:",{position:t.position,zone:o});const v=hr.getState().spaceInfo,w=pr(v);if(w&&w.threeUnitPositions){let m=1/0,y=0;for(let x=0;x<w.threeUnitPositions.length;x++){const S=Math.abs(t.position.x-w.threeUnitPositions[x]);S<m&&(m=S,y=x)}l=y,console.log("📍 [Store] position으로부터 slotIndex 계산:",{positionX:t.position.x,calculatedSlotIndex:l,minDistance:m})}}const h=hr.getState().spaceInfo,u=pr(h);let d=u.columnWidth;if(u.zones){if(o==="dropped"&&u.zones.dropped){if(u.zones.dropped.slotWidths&&l!==void 0?d=u.zones.dropped.slotWidths[l]||u.zones.dropped.columnWidth:d=u.zones.dropped.columnWidth,a&&u.zones.dropped.slotWidths){const v=u.zones.dropped.slotWidths[l+1]||u.zones.dropped.columnWidth;d+=v}}else if(o==="normal"&&u.zones.normal&&(u.zones.normal.slotWidths&&l!==void 0?d=u.zones.normal.slotWidths[l]||u.zones.normal.columnWidth:d=u.zones.normal.columnWidth,a&&u.zones.normal.slotWidths)){const v=u.zones.normal.slotWidths[l+1]||u.zones.normal.columnWidth;d+=v}}else u.slotWidths&&l!==void 0?(d=u.slotWidths[l]||u.columnWidth,a&&u.slotWidths[l+1]?d+=u.slotWidths[l+1]:a&&(d+=u.columnWidth)):a&&(d=u.columnWidth*2);t.customWidth||(t.customWidth=Math.round(d)),console.log("📏 [Store] 슬롯 너비 계산:",{moduleId:t.moduleId,zone:o,slotIndex:l,isDualSlot:a,calculatedWidth:Math.round(d),customWidth:t.customWidth}),console.log("🔍 [Store] 충돌 검사 시작:",{새가구:{id:t.id,slotIndex:l,isDualSlot:a,zone:o,점유슬롯:a?[l,l+1]:[l]},기존가구수:r.length});const A=t.moduleId.includes("upper-cabinet"),f=t.moduleId.includes("lower-cabinet");if(console.log("🔍 [Store] 새 가구 카테고리:",{moduleId:t.moduleId,isUpper:A,isLower:f}),r.some(v=>{let w=v.slotIndex;if(w==null){const S=hr.getState().spaceInfo,I=pr(S);if(I&&I.threeUnitPositions){let j=1/0,C=0;for(let b=0;b<I.threeUnitPositions.length;b++){const D=Math.abs(v.position.x-I.threeUnitPositions[b]);D<j&&(j=D,C=b)}w=C}}if(o!==void 0&&v.zone!==void 0&&o!==v.zone)return!1;let m=!1;if(a?m=w===l||w===l+1||v.isDualSlot&&(w+1===l||w+1===l+1):m=w===l||v.isDualSlot&&w+1===l,!m)return!1;const y=v.moduleId.includes("upper-cabinet"),x=v.moduleId.includes("lower-cabinet");return A&&x||f&&y?(console.log("✅ [Store] 상부장/하부장 공존 허용:",{새가구:{id:t.id,moduleId:t.moduleId,isUpper:A,isLower:f},기존가구:{id:v.id,moduleId:v.moduleId,isUpper:y,isLower:x}}),!1):(console.log("❌ [Store] 가구 충돌 감지:",{새가구:{id:t.id,slotIndex:l,isDualSlot:a,isUpper:A,isLower:f},기존가구:{id:v.id,slotIndex:w,isDualSlot:v.isDualSlot,isUpper:y,isLower:x}}),!0)})){console.error("🚫🚫🚫 [Store] 슬롯 충돌로 가구 추가 거부!",{moduleId:t.moduleId,slotIndex:l,zone:o});return}const g={...t,slotIndex:l};n(v=>{const w=[...v.placedModules,g];return console.log("✅ [Store] 가구 추가 완료:",w.map(m=>({id:m.id,moduleId:m.moduleId,slotIndex:m.slotIndex,isDualSlot:m.isDualSlot}))),{placedModules:w}})},removeModule:t=>{n(i=>({placedModules:i.placedModules.filter(r=>r.id!==t)}))},moveModule:(t,i)=>{const r=e(),s=r.placedModules.find(A=>A.id===t);if(!s){console.error("이동할 가구를 찾을 수 없습니다:",t);return}const o=hr.getState().spaceInfo,a=pr(o);let l=s.slotIndex;if(a&&a.threeUnitPositions){let A=1/0,f=0;for(let p=0;p<a.threeUnitPositions.length;p++){const g=Math.abs(i.x-a.threeUnitPositions[p]);g<A&&(A=g,f=p)}l=f}const h=s.moduleId.includes("upper-cabinet"),u=s.moduleId.includes("lower-cabinet");if(r.placedModules.some(A=>{if(A.id===t)return!1;let f=A.slotIndex;if(f==null&&a&&a.threeUnitPositions){let w=1/0,m=0;for(let y=0;y<a.threeUnitPositions.length;y++){const x=Math.abs(A.position.x-a.threeUnitPositions[y]);x<w&&(w=x,m=y)}f=m}if(s.zone!==void 0&&A.zone!==void 0&&s.zone!==A.zone)return!1;let p=!1;if(s.isDualSlot?p=f===l||f===l+1||A.isDualSlot&&(f+1===l||f+1===l+1):p=f===l||A.isDualSlot&&f+1===l,!p)return!1;const g=A.moduleId.includes("upper-cabinet"),v=A.moduleId.includes("lower-cabinet");return h&&v||u&&g?(console.log("✅ [moveModule] 상하부장 공존 허용"),!1):!0})){console.error("🚫 이동 위치에 이미 가구가 있습니다!");return}n(A=>({placedModules:A.placedModules.map(f=>f.id===t?{...f,position:i,slotIndex:l}:f)}))},updatePlacedModule:(t,i)=>{if(console.log("📦 updatePlacedModule 호출:",{id:t,updates:i,hasPosition:!!i.position,position:i.position,hasSlotIndex:i.slotIndex!==void 0}),i.position||i.slotIndex!==void 0){const r=e(),s=r.placedModules.find(a=>a.id===t);if(!s){console.error("업데이트할 가구를 찾을 수 없습니다:",t);return}let o=i.slotIndex;if(o===void 0&&i.position){const a=hr.getState().spaceInfo,l=pr(a);if(l&&l.threeUnitPositions){let h=1/0,u=0;for(let d=0;d<l.threeUnitPositions.length;d++){const A=Math.abs(i.position.x-l.threeUnitPositions[d]);A<h&&(h=A,u=d)}o=u}}if(o!==void 0&&o!==s.slotIndex){const a={...s,...i};if(r.placedModules.some(h=>{if(h.id===t)return!1;let u=h.slotIndex;if(u==null){const A=hr.getState().spaceInfo,f=pr(A);if(f&&f.threeUnitPositions){let p=1/0,g=0;for(let v=0;v<f.threeUnitPositions.length;v++){const w=Math.abs(h.position.x-f.threeUnitPositions[v]);w<p&&(p=w,g=v)}u=g}}const d=a.zone;if(d!==void 0&&h.zone!==void 0&&d!==h.zone)return!1;if(a.isDualSlot){if(u===o||u===o+1||h.isDualSlot&&(u+1===o||u+1===o+1)){const f=a.moduleId.includes("upper-cabinet"),p=a.moduleId.includes("lower-cabinet"),g=h.moduleId.includes("upper-cabinet"),v=h.moduleId.includes("lower-cabinet");return!(f&&v||p&&g)}return!1}else{if(u===o||h.isDualSlot&&u+1===o){const f=a.moduleId.includes("upper-cabinet"),p=a.moduleId.includes("lower-cabinet"),g=h.moduleId.includes("upper-cabinet"),v=h.moduleId.includes("lower-cabinet");return!(f&&v||p&&g)}return!1}})){console.error("🚫 업데이트 위치에 이미 가구가 있습니다!");return}i={...i,slotIndex:o}}}n(r=>({placedModules:r.placedModules.map(s=>s.id===t?{...s,...i}:s)}))},clearAllModules:()=>{const t=e().placedModules;console.log("🔴 [FURNITURE STORE] clearAllModules 호출:",{previousCount:t.length,previousModules:t.map(i=>({id:i.id,name:i.name,slotIndex:i.slotIndex}))}),console.trace("🔴 [TRACE] clearAllModules 호출 스택"),n({placedModules:[]})},setPlacedModules:t=>{const i=e().placedModules,r=typeof t=="function"?t(i):t;console.log("🔴 [FURNITURE STORE] setPlacedModules 호출:",{previousCount:i.length,newCount:r.length,isFunction:typeof t=="function",newModules:r.map(s=>({id:s.id,name:s.name,slotIndex:s.slotIndex})),previousModules:i.map(s=>({id:s.id,name:s.name,slotIndex:s.slotIndex}))}),console.trace("🔴 [TRACE] setPlacedModules 호출 스택"),n({placedModules:r})},setSelectedLibraryModuleId:t=>{n({selectedLibraryModuleId:t})},setSelectedPlacedModuleId:t=>{n({selectedPlacedModuleId:t})},setSelectedFurnitureId:t=>{n({selectedFurnitureId:t})},clearAllSelections:()=>{n({selectedLibraryModuleId:null,selectedPlacedModuleId:null,selectedFurnitureId:null})},setFurniturePlacementMode:t=>{n({isFurniturePlacementMode:t})},setEditMode:t=>{n({editMode:t})},setEditingModuleId:t=>{n({editingModuleId:t})},exitEditMode:()=>{n({editMode:!1,editingModuleId:null})},setCurrentDragData:t=>{n({currentDragData:t})},clearDragData:()=>{n({currentDragData:null})},isDirty:!1,setIsDirty:t=>n({isDirty:t}),resetAll:()=>{const t=e().placedModules;console.log("🔴 [FURNITURE STORE] resetAll 호출:",{previousCount:t.length,previousModules:t.map(i=>({id:i.id,name:i.name,slotIndex:i.slotIndex}))}),console.trace("🔴 [TRACE] resetAll 호출 스택"),n({placedModules:[],selectedLibraryModuleId:null,selectedPlacedModuleId:null,selectedFurnitureId:null,isFurniturePlacementMode:!1,editMode:!1,editingModuleId:null,currentDragData:null,isDirty:!1})},markAsSaved:()=>n({isDirty:!1}),setAllDoors:t=>{console.log("🚪 setAllDoors 호출:",{hasDoor:t,currentModulesCount:e().placedModules.length,currentModules:e().placedModules.map(i=>({id:i.id,hasDoor:i.hasDoor}))}),n(i=>{const r=i.placedModules.map(s=>({...s,hasDoor:t}));return console.log("🚪 setAllDoors 완료:",{updatedModulesCount:r.length,updatedModules:r.map(s=>({id:s.id,hasDoor:s.hasDoor}))}),{placedModules:r}})},updateFurnitureForColumns:t=>{n(i=>{var u,d;console.log("🔧 updateFurnitureForColumns 호출 - 기둥 관련 업데이트만 수행");let r=0;if((u=t.droppedCeiling)!=null&&u.enabled){const A=t.mainDoorCount||t.customColumnCount||3,f=t.droppedCeilingDoorCount||1;r=A+f}else r=t.customColumnCount||3;const s=Ih(t),o=pr(t),a=[],h=i.placedModules.map(A=>{var y,x,S,I,j,C,b,D,T;if(A.slotIndex===void 0)return A;let f=r-1;if(A.zone&&((y=t.droppedCeiling)!=null&&y.enabled)&&(A.zone==="dropped"?f=(t.droppedCeilingDoorCount||1)-1:f=(t.mainDoorCount||t.customColumnCount||3)-1),A.slotIndex>f)return console.log(`🚫 가구 ${A.id} 제거 예정 - 컬럼 수 초과 (슬롯 ${A.slotIndex} > 최대 ${f})`),a.includes(A.id)||a.push(A.id),A;const p=A.isDualSlot||((x=A.moduleId)==null?void 0:x.includes("dual-"));if(p&&A.slotIndex+1>f)return console.log(`🚫 듀얼 가구 ${A.id} 제거 예정 - 두 번째 슬롯이 컬럼 수 초과`),a.includes(A.id)||a.push(A.id),A;let g=A.slotIndex;if(A.zone&&((S=t.droppedCeiling)!=null&&S.enabled)){const k=ar.calculateZoneSlotInfo(t,t.customColumnCount);A.zone==="dropped"&&k.dropped&&(g=k.normal.columnCount+A.slotIndex)}const v=s[g];if(!v)return console.log(`🚫 가구 ${A.id} 제거 예정 - 슬롯 정보 없음 (globalSlotIndex: ${g})`),a.includes(A.id)||a.push(A.id),A;let w=null;if(p&&(w=s[g+1],!w))return console.log(`🚫 듀얼 가구 ${A.id} 제거 예정 - 두 번째 슬롯 없음`),a.includes(A.id)||a.push(A.id),A;if(console.log(`🔧 가구 ${A.id} (슬롯 ${A.slotIndex} → ${g}):`,{isDualFurniture:p,hasColumn:v==null?void 0:v.hasColumn,availableWidth:v==null?void 0:v.availableWidth,adjustedWidth:v==null?void 0:v.adjustedWidth,intrusionDirection:v==null?void 0:v.intrusionDirection,secondSlotHasColumn:w==null?void 0:w.hasColumn}),p&&(v!=null&&v.hasColumn||w!=null&&w.hasColumn))return console.log(`🚫 듀얼 가구 ${A.id} 제거 예정 - 기둥 침범`),a.includes(A.id)||a.push(A.id),A;let m=o.columnWidth;if(A.zone&&o.zones){const k=A.zone==="dropped"?o.zones.dropped:o.zones.normal;k&&k.slotWidths&&A.slotIndex!==void 0?(m=k.slotWidths[A.slotIndex]||k.columnWidth,p&&k.slotWidths[A.slotIndex+1]?m+=k.slotWidths[A.slotIndex+1]:p&&(m+=k.columnWidth)):k&&(m=p?k.columnWidth*2:k.columnWidth)}else o.slotWidths&&A.slotIndex!==void 0?(m=o.slotWidths[A.slotIndex]||o.columnWidth,p&&o.slotWidths[A.slotIndex+1]?m+=o.slotWidths[A.slotIndex+1]:p&&(m+=o.columnWidth)):p&&(m=o.columnWidth*2);if(!p&&(v!=null&&v.hasColumn)){const k=v.adjustedWidth||v.availableWidth;console.log(`✅ 가구 ${A.id} adjustedWidth 설정: ${k}mm, customWidth: ${Math.round(m)}mm`);const B=pr(t);let E=A.position.x;if(A.zone&&((I=t.droppedCeiling)!=null&&I.enabled)){const J=ar.calculateZoneSlotInfo(t,t.customColumnCount),$=A.zone==="dropped"&&J.dropped?J.dropped:J.normal;if(A.slotIndex!==void 0&&A.slotIndex<$.columnCount){const U=A.zone==="dropped"&&((j=B.zones)!=null&&j.dropped)?B.zones.dropped:A.zone==="normal"&&((C=B.zones)!=null&&C.normal)?B.zones.normal:B;U.threeUnitPositions&&U.threeUnitPositions[A.slotIndex]!==void 0&&(E=U.threeUnitPositions[A.slotIndex])}}else A.slotIndex!==void 0&&B.threeUnitPositions&&B.threeUnitPositions[A.slotIndex]!==void 0&&(E=B.threeUnitPositions[A.slotIndex]);const z=B.columnWidth*.01,te={left:E-z/2,right:E+z/2,center:E},O=(v?Ad(v,te,t):te).center;return{...A,adjustedWidth:k,customWidth:Math.round(m),position:{...A.position,x:O}}}else{if(A.adjustedWidth!==void 0){console.log(`❌ 가구 ${A.id} adjustedWidth 제거 및 위치 복원, customWidth: ${Math.round(m)}mm`);const k=pr(t);let B=A.position.x;if(A.zone&&((b=t.droppedCeiling)!=null&&b.enabled)){const E=ar.calculateZoneSlotInfo(t,t.customColumnCount),z=A.zone==="dropped"&&E.dropped?E.dropped:E.normal;if(A.slotIndex!==void 0&&A.slotIndex<z.columnCount){const te=A.zone==="dropped"&&((D=k.zones)!=null&&D.dropped)?k.zones.dropped:A.zone==="normal"&&((T=k.zones)!=null&&T.normal)?k.zones.normal:k;te.threeUnitPositions&&te.threeUnitPositions[A.slotIndex]!==void 0&&(B=te.threeUnitPositions[A.slotIndex])}}else A.slotIndex!==void 0&&k.threeUnitPositions&&k.threeUnitPositions[A.slotIndex]!==void 0&&(B=k.threeUnitPositions[A.slotIndex]);return{...A,adjustedWidth:void 0,customWidth:Math.round(m),position:{...A.position,x:B}}}return{...A,adjustedWidth:void 0,customWidth:Math.round(m)}}}).filter(A=>!a.includes(A.id));return console.log("🔧 기둥 변경에 따른 가구 업데이트 완료:",{columnCount:((d=t.columns)==null?void 0:d.length)||0,removedDualFurniture:a,updatedFurniture:h.filter(A=>A.adjustedWidth!==void 0).map(A=>({id:A.id,slotIndex:A.slotIndex,adjustedWidth:A.adjustedWidth}))}),a.length>0&&console.log(`⚠️ ${a.length}개의 가구가 제거되었습니다:`,{removedModules:a,reasons:"컬럼 수 초과 또는 기둥 침범"}),{placedModules:h}})},updateFurnitureYPositions:t=>{n(i=>{var u,d,A;console.log("📍 updateFurnitureYPositions 호출:",{placementType:(u=t.baseConfig)==null?void 0:u.placementType,floatHeight:(d=t.baseConfig)==null?void 0:d.floatHeight,furnitureCount:i.placedModules.length});const r=f=>f*.01,s=t.hasFloorFinish&&t.floorFinish?t.floorFinish.height:0,o=((A=t.baseConfig)==null?void 0:A.height)||0;let a;if(!t.baseConfig||t.baseConfig.type==="floor")a=r(s+o);else if(t.baseConfig.type==="stand")if(t.baseConfig.placementType==="float"){const f=t.baseConfig.floatHeight||0;a=r(s+f)}else a=r(s);else a=0;const l=Kr(t),h=i.placedModules.map(f=>{var y,x,S,I,j,C,b,D,T;const p=Zi(f.moduleId,l,t);if(!p)return f;const g=p.category==="upper"||f.moduleId.includes("upper-cabinet"),v=p.category==="lower"||f.moduleId.includes("lower-cabinet"),w=p.category==="full"||f.moduleId.includes("tall-cabinet");let m=f.position.y;if(g){const k=p.dimensions.height;let B=l.height;if(f.zone==="dropped"&&((y=t.droppedCeiling)!=null&&y.enabled)){const z=t.droppedCeiling.dropHeight||200;B=l.height-z}const E=((x=t.baseConfig)==null?void 0:x.type)==="floor"?((S=t.baseConfig)==null?void 0:S.height)||65:0;m=r(B+E-k/2)}else if(v){const k=p.dimensions.height;m=a+r(k/2),console.log("📦 하부장 Y 위치 재계산:",{moduleId:f.moduleId,이전Y:f.position.y,새Y:m,furnitureStartY:a,furnitureStartY_mm:a*100,furnitureHeightMm:k,placementType:(I=t.baseConfig)==null?void 0:I.placementType,floatHeight:(j=t.baseConfig)==null?void 0:j.floatHeight})}else if(w){const k=p.dimensions.height;m=a+r(k/2),console.log("🏢 키큰장 Y 위치 재계산:",{moduleId:f.moduleId,이전Y:f.position.y,새Y:m,furnitureStartY:a,furnitureStartY_mm:a*100,furnitureHeightMm:k,placementType:(C=t.baseConfig)==null?void 0:C.placementType,floatHeight:(b=t.baseConfig)==null?void 0:b.floatHeight})}return{...f,position:{...f.position,y:m},_lastYUpdate:Date.now(),_placementType:(D=t.baseConfig)==null?void 0:D.placementType,_floatHeight:(T=t.baseConfig)==null?void 0:T.floatHeight}});return console.log("📍 Y 위치 업데이트 완료 - 가구 위치 재계산 및 리렌더링"),{placedModules:h}})}})),od={WIDTH:3600,HEIGHT:2400,DEPTH:1500},qA={LEFT:50,RIGHT:50,TOP:10},VC={HEIGHT:65,FLOOR_FINISH_HEIGHT:9},wm={INTERIOR_COLOR:"#FFFFFF",DOOR_COLOR:"#E0E0E0"},ea={WIDTH:1300,DROP_HEIGHT:200,POSITION:"right"},Oc={WIDTH:{MIN:1200,MAX:8e3},HEIGHT:{MIN:2010,MAX:2410}},fg={DEPTH:{MIN:130,MAX:780,DEFAULT_FALLBACK:580}},qoe={width:od.WIDTH,height:od.HEIGHT,depth:od.DEPTH,installType:"builtin",wallConfig:{left:!0,right:!0},hasFloorFinish:!1,floorFinish:{height:VC.FLOOR_FINISH_HEIGHT},surroundType:"surround",frameSize:{left:qA.LEFT,right:qA.RIGHT,top:qA.TOP},gapConfig:{left:2,right:2},baseConfig:{type:"floor",height:VC.HEIGHT,placementType:"ground",floatHeight:200},materialConfig:{interiorColor:wm.INTERIOR_COLOR,doorColor:wm.DOOR_COLOR},droppedCeiling:{enabled:!1,position:ea.POSITION,width:ea.WIDTH,dropHeight:ea.DROP_HEIGHT},mainDoorCount:0,droppedCeilingDoorCount:0},XS={isDirty:!1,spaceInfo:qoe},hr=w1()(n=>({...XS,setSpaceInfo:e=>{n(t=>{var u,d,A,f,p,g,v,w,m,y,x,S,I,j,C,b;const i={...e};i.installType==="built-in"&&(i.installType="builtin"),i.surroundType==="no-surround"&&(i.frameSize={left:0,right:0,top:10},console.log("🔴🔴🔴 [CRITICAL] SpaceConfigStore - 노서라운드 모드 frameSize 설정 (상부는 10mm 유지)")),(i.surroundType||t.spaceInfo.surroundType)==="no-surround"&&t.spaceInfo.frameSize&&(t.spaceInfo.frameSize.left>0||t.spaceInfo.frameSize.right>0)&&(i.frameSize={left:0,right:0,top:10},console.log("🔴🔴🔴 [CRITICAL] 기존 상태도 노서라운드인데 frameSize가 잘못됨! 강제 수정 (상부는 10mm 유지)")),(u=i.droppedCeiling)!=null&&u.enabled&&(!i.droppedCeiling.width||!i.droppedCeiling.dropHeight)&&(i.droppedCeiling={...i.droppedCeiling,width:i.droppedCeiling.width||ea.WIDTH,dropHeight:i.droppedCeiling.dropHeight||ea.DROP_HEIGHT});const s={spaceInfo:{...t.spaceInfo,...i},isDirty:!0};i.wallConfig&&console.log("🏪 SpaceConfigStore - wallConfig 업데이트:",{이전:t.spaceInfo.wallConfig,새로운:i.wallConfig,최종:s.spaceInfo.wallConfig});const o=i.customColumnCount!==void 0&&i.customColumnCount!==t.spaceInfo.customColumnCount||i.mainDoorCount!==void 0&&i.mainDoorCount!==t.spaceInfo.mainDoorCount||i.droppedCeilingDoorCount!==void 0&&i.droppedCeilingDoorCount!==t.spaceInfo.droppedCeilingDoorCount||i.width!==void 0&&i.width!==t.spaceInfo.width||i.surroundType!==void 0&&i.surroundType!==t.spaceInfo.surroundType||i.frameSize!==void 0,a=((d=i.baseConfig)==null?void 0:d.placementType)!==void 0&&((A=i.baseConfig)==null?void 0:A.placementType)!==((f=t.spaceInfo.baseConfig)==null?void 0:f.placementType)||((p=i.baseConfig)==null?void 0:p.floatHeight)!==void 0&&((g=i.baseConfig)==null?void 0:g.floatHeight)!==((v=t.spaceInfo.baseConfig)==null?void 0:v.floatHeight),l=((w=i.droppedCeiling)==null?void 0:w.enabled)!==void 0&&((m=i.droppedCeiling)==null?void 0:m.enabled)!==((y=t.spaceInfo.droppedCeiling)==null?void 0:y.enabled)||((x=i.droppedCeiling)==null?void 0:x.width)!==void 0&&((S=i.droppedCeiling)==null?void 0:S.width)!==((I=t.spaceInfo.droppedCeiling)==null?void 0:I.width)||((j=i.droppedCeiling)==null?void 0:j.dropHeight)!==void 0&&((C=i.droppedCeiling)==null?void 0:C.dropHeight)!==((b=t.spaceInfo.droppedCeiling)==null?void 0:b.dropHeight);return(a||l||i.baseConfig!==void 0&&JSON.stringify(i.baseConfig)!==JSON.stringify(t.spaceInfo.baseConfig)||i.frameSize!==void 0&&JSON.stringify(i.frameSize)!==JSON.stringify(t.spaceInfo.frameSize)||i.surroundType!==void 0&&i.surroundType!==t.spaceInfo.surroundType||i.installType!==void 0&&i.installType!==t.spaceInfo.installType)&&(console.log("🎯 가구 업데이트 필요 - 설정 변경 감지:",{placementChanged:a,droppedCeilingChanged:l,baseConfig:i.baseConfig!==void 0,frameSize:i.frameSize!==void 0,surroundType:i.surroundType!==void 0,installType:i.installType!==void 0}),setTimeout(()=>{const{updateFurnitureYPositions:D}=pi.getState();D(s.spaceInfo)},0)),o&&(console.log("📐 컬럼 수 변경 감지:",{이전:{customColumnCount:t.spaceInfo.customColumnCount,mainDoorCount:t.spaceInfo.mainDoorCount,droppedCeilingDoorCount:t.spaceInfo.droppedCeilingDoorCount},새로운:{customColumnCount:i.customColumnCount,mainDoorCount:i.mainDoorCount,droppedCeilingDoorCount:i.droppedCeilingDoorCount}}),setTimeout(()=>{const{updateFurnitureForColumns:D}=pi.getState();D(s.spaceInfo)},0)),s})},resetSpaceInfo:()=>n(e=>{let t=XS.spaceInfo;return t.surroundType==="no-surround"&&(t={...t,frameSize:{left:0,right:0,top:10}},console.log("🔴🔴🔴 [CRITICAL] resetSpaceInfo - 노서라운드 모드 frameSize 설정 (상부는 10mm 유지)")),{spaceInfo:t,isDirty:!0}}),resetMaterialConfig:()=>n(e=>({spaceInfo:{...e.spaceInfo,materialConfig:{...e.spaceInfo.materialConfig}},isDirty:!0})),setColumns:e=>n(t=>({spaceInfo:{...t.spaceInfo,columns:e},isDirty:!0})),addColumn:e=>n(t=>{const o=t.spaceInfo.columns||[];for(const l of o){if(!l.position||!e.position)continue;if(Math.abs(l.position[0]-e.position[0])<2.999)return t}const a={spaceInfo:{...t.spaceInfo,columns:[...o,e]},isDirty:!0};return setTimeout(()=>{const{updateFurnitureForColumns:l}=pi.getState();l(a.spaceInfo)},0),a}),removeColumn:e=>n(t=>{const i={spaceInfo:{...t.spaceInfo,columns:(t.spaceInfo.columns||[]).filter(r=>r.id!==e)},isDirty:!0};return setTimeout(()=>{const{updateFurnitureForColumns:r}=pi.getState();r(i.spaceInfo)},0),i}),updateColumn:(e,t)=>n(i=>{if(t.position){const l=(i.spaceInfo.columns||[]).filter(h=>h.id!==e);for(const h of l){if(!h.position)continue;if(Math.abs(h.position[0]-t.position[0])<2.999)return i}}const r={spaceInfo:{...i.spaceInfo,columns:(i.spaceInfo.columns||[]).map(s=>s.id===e?{...s,...t}:s)},isDirty:!0};return setTimeout(()=>{const{updateFurnitureForColumns:s}=pi.getState();s(r.spaceInfo)},0),r}),setWalls:e=>n(t=>({spaceInfo:{...t.spaceInfo,walls:e},isDirty:!0})),addWall:e=>n(t=>({spaceInfo:{...t.spaceInfo,walls:[...t.spaceInfo.walls||[],e]},isDirty:!0})),removeWall:e=>n(t=>({spaceInfo:{...t.spaceInfo,walls:(t.spaceInfo.walls||[]).filter(i=>i.id!==e)},isDirty:!0})),updateWall:(e,t)=>n(i=>({spaceInfo:{...i.spaceInfo,walls:(i.spaceInfo.walls||[]).map(r=>r.id===e?{...r,...t}:r)},isDirty:!0})),setPanelBs:e=>n(t=>({spaceInfo:{...t.spaceInfo,panelBs:e},isDirty:!0})),addPanelB:e=>n(t=>({spaceInfo:{...t.spaceInfo,panelBs:[...t.spaceInfo.panelBs||[],e]},isDirty:!0})),removePanelB:e=>n(t=>({spaceInfo:{...t.spaceInfo,panelBs:(t.spaceInfo.panelBs||[]).filter(i=>i.id!==e)},isDirty:!0})),updatePanelB:(e,t)=>n(i=>({spaceInfo:{...i.spaceInfo,panelBs:(i.spaceInfo.panelBs||[]).map(r=>r.id===e?{...r,...t}:r)},isDirty:!0})),resetAll:()=>n({...XS,isDirty:!1}),markAsSaved:()=>n({isDirty:!1})})),Zoe=H.createContext(null),Joe=({children:n})=>{const e=ph(),{showConfirm:t,ConfirmComponent:i}=voe(),r=Pl(A=>A.isDirty),s=hr(A=>A.isDirty),o=pi(A=>A.isDirty),a=Pl(A=>A.resetAll),l=hr(A=>A.resetAll),h=pi(A=>A.resetAll),u=r||s||o,d=H.useCallback(async(A,f)=>{if(f!=null&&f.force){e(A);return}u?await t(`저장하지 않은 변경사항이 있습니다.
정말로 페이지를 떠나시겠습니까?`,{title:"변경사항 저장 안 됨",confirmText:"떠나기",cancelText:"머무르기"})&&(a(),l(),h(),e(A)):e(A)},[u,t,e,a,l,h]);return c.jsxs(Zoe.Provider,{value:{navigate:d},children:[c.jsx(i,{}),n]})};class QB extends Error{constructor(e,t,i,r=500){super(t),this.code=e,this.userMessage=t,this.technicalMessage=i,this.statusCode=r,this.name="AppError"}}const eae={"auth/user-not-found":"사용자를 찾을 수 없습니다.","auth/wrong-password":"비밀번호가 올바르지 않습니다.","auth/email-already-in-use":"이미 사용 중인 이메일입니다.","auth/weak-password":"비밀번호가 너무 약합니다.","auth/invalid-email":"올바르지 않은 이메일 형식입니다.","auth/user-disabled":"비활성화된 계정입니다.","auth/operation-not-allowed":"허용되지 않은 작업입니다.","auth/requires-recent-login":"최근 로그인이 필요합니다.","auth/network-request-failed":"네트워크 연결을 확인해주세요.","auth/too-many-requests":"너무 많은 요청이 발생했습니다. 잠시 후 다시 시도해주세요.","permission-denied":"접근 권한이 없습니다.","not-found":"요청한 리소스를 찾을 수 없습니다.","already-exists":"이미 존재하는 데이터입니다.","resource-exhausted":"요청 한도를 초과했습니다.","failed-precondition":"사전 조건을 충족하지 못했습니다.",aborted:"작업이 중단되었습니다.","out-of-range":"유효하지 않은 범위입니다.",unimplemented:"구현되지 않은 기능입니다.",internal:"내부 서버 오류가 발생했습니다.",unavailable:"서비스를 일시적으로 사용할 수 없습니다.","data-loss":"데이터 손실이 발생했습니다.",unauthenticated:"로그인이 필요합니다.",cancelled:"작업이 취소되었습니다.","deadline-exceeded":"요청 시간이 초과되었습니다.","invalid-argument":"잘못된 인수가 제공되었습니다.","team/member-limit-exceeded":"팀 멤버 수 제한을 초과했습니다.","team/invitation-expired":"초대가 만료되었습니다.","team/already-member":"이미 팀 멤버입니다.","project/max-limit-exceeded":"프로젝트 생성 한도를 초과했습니다.","project/invalid-share-permission":"올바르지 않은 공유 권한입니다.","storage/upload-failed":"파일 업로드에 실패했습니다.","storage/file-too-large":"파일 크기가 너무 큽니다."},tae=n=>{console.error("🔥 Firebase Error:",n);let e="unknown",t="Unknown error";if(n instanceof Ed)e=n.code,t=n.message;else if(n.code)e=n.code,t=n.message;else{if(n instanceof QB)return n;n instanceof Error&&(t=n.message,e="app/generic-error")}const i=eae[e]||"알 수 없는 오류가 발생했습니다. 문제가 지속되면 관리자에게 문의해주세요.";return nae(e,i,t,n),new QB(e,i,t)},nae=(n,e,t,i)=>{const r={timestamp:new Date().toISOString(),code:n,userMessage:e,technicalMessage:t,stack:i==null?void 0:i.stack,userAgent:navigator.userAgent,url:window.location.href,userId:null};console.error("📊 Error logged:",r)},ax=(n,e,t)=>new QB(n,e,t,400),a1="teams",Ew="teamInvitations",iae=async(n,e,t)=>{try{console.log("🔑 Firebase 팀 생성 시작:",{name:n,description:e});const i=await Wr();if(!i)throw ax("auth/unauthenticated","로그인이 필요합니다.");if(!n.trim()||n.length<2)throw ax("team/invalid-name","팀 이름은 2글자 이상이어야 합니다.");if(n.length>50)throw ax("team/invalid-name","팀 이름은 50글자를 초과할 수 없습니다.");console.log("✅ 사용자 인증 성공:",{uid:i.uid,email:i.email});const r=await YW(rr,async s=>{const o=ru(jl(rr,a1),xl("ownerId","==",i.uid));if((await kd(o)).size>=10)throw ax("team/limit-exceeded","최대 10개의 팀만 생성할 수 있습니다.");const l={isPublic:!1,allowInvitations:!0,defaultRole:"viewer",maxMembers:50,...t},h={userId:i.uid,email:i.email||"",displayName:i.displayName,photoURL:i.photoURL,role:"owner",joinedAt:yo.fromDate(new Date),status:"active"},u=ts(jl(rr,a1)),d={name:n.trim(),description:e==null?void 0:e.trim(),ownerId:i.uid,members:[h],settings:l,createdAt:Lo(),updatedAt:Lo()};s.set(u,d);const A=ts(jl(rr,"activityLogs"));return s.set(A,{userId:i.uid,resourceType:"team",resourceId:u.id,action:"create",metadata:{teamName:n.trim()},timestamp:Lo()}),u.id});return console.log("✅ 팀 생성 완료:",{teamId:r}),{teamId:r,error:null}}catch(i){return console.error("❌ 팀 생성 에러:",i),{teamId:null,error:tae(i).userMessage}}},Iz=async()=>{try{console.log("🔍 사용자 팀 목록 조회 시작...");const n=await Wr();if(!n)return console.error("❌ 사용자 인증 실패"),{teams:[],error:"로그인이 필요합니다."};console.log("✅ 사용자 인증 성공:",{uid:n.uid,email:n.email});const e=await kd(jl(rr,a1)),t=[];return console.log(`📄 총 ${e.size}개의 팀 문서 발견`),e.forEach(i=>{var o,a;const r=i.data();console.log("🔍 팀 문서 확인:",{id:i.id,name:r.name,membersCount:(o=r.members)==null?void 0:o.length});const s=(a=r.members)==null?void 0:a.some(l=>l.userId===n.uid);if(console.log(`👤 멤버 확인 (${r.name}):`,{isMember:s,userId:n.uid}),s){console.log("✅ 사용자가 속한 팀 발견:",r.name);const l=r.members.map(h=>h.userId===n.uid?{...h,displayName:n.displayName||h.displayName,photoURL:n.photoURL||h.photoURL,email:n.email||h.email}:h);t.push({id:i.id,...r,members:l})}}),console.log(`📊 사용자가 속한 팀 개수: ${t.length}`),t.sort((i,r)=>{var a,l;const s=((a=i.updatedAt)==null?void 0:a.seconds)||0;return(((l=r.updatedAt)==null?void 0:l.seconds)||0)-s}),{teams:t,error:null}}catch(n){return console.error("팀 목록 가져오기 에러:",n),{teams:[],error:"팀 목록을 가져오는 중 오류가 발생했습니다."}}},GC=async n=>{try{const e=await Wr();if(!e)return{team:null,error:"로그인이 필요합니다."};const t=ts(rr,a1,n),i=await Ru(t);if(!i.exists())return{team:null,error:"팀을 찾을 수 없습니다."};const r=i.data(),s=r.members.map(l=>l.userId===e.uid?{...l,displayName:e.displayName||l.displayName,photoURL:e.photoURL||l.photoURL,email:e.email||l.email}:l),o={id:i.id,...r,members:s};return o.members.some(l=>l.userId===e.uid)?{team:o,error:null}:{team:null,error:"팀에 접근할 권한이 없습니다."}}catch(e){return console.error("팀 정보 가져오기 에러:",e),{team:null,error:"팀 정보를 가져오는 중 오류가 발생했습니다."}}},rae=async(n,e,t)=>{try{const i=await Wr();if(!i)return{invitationId:null,error:"로그인이 필요합니다."};const{team:r,error:s}=await GC(n);if(s||!r)return{invitationId:null,error:s||"팀을 찾을 수 없습니다."};const o=r.members.find(p=>p.userId===i.uid);if(!o||o.role!=="owner"&&o.role!=="admin")return{invitationId:null,error:"팀 멤버를 초대할 권한이 없습니다."};if(r.members.some(p=>p.email===e))return{invitationId:null,error:"이미 팀 멤버입니다."};const l=ru(jl(rr,Ew),xl("teamId","==",n),xl("inviteeEmail","==",e),xl("status","==","pending"));if(!(await kd(l)).empty)return{invitationId:null,error:"이미 보류 중인 초대가 있습니다."};const u=cae(),d=new Date;d.setDate(d.getDate()+7);const A={teamId:n,teamName:r.name,inviterUserId:i.uid,inviterEmail:i.email||"",inviterDisplayName:i.displayName,inviteeEmail:e,role:t,status:"pending",createdAt:Lo(),expiresAt:yo.fromDate(d),token:u};return{invitationId:(await gv(jl(rr,Ew),A)).id,error:null}}catch(i){return console.error("팀 멤버 초대 에러:",i),{invitationId:null,error:"팀 멤버 초대 중 오류가 발생했습니다."}}},sae=async(n,e)=>{try{const t=await Wr();if(!t)return{error:"로그인이 필요합니다."};const i=ts(rr,Ew,n),r=await Ru(i);if(!r.exists())return{error:"초대를 찾을 수 없습니다."};const s=r.data();if(s.token!==e)return{error:"유효하지 않은 초대입니다."};if(s.expiresAt.toDate()<new Date)return{error:"만료된 초대입니다."};if(s.inviteeEmail!==t.email)return{error:"초대받은 이메일과 로그인한 계정이 다릅니다."};if(s.status!=="pending")return{error:"이미 처리된 초대입니다."};const o=ts(rr,a1,s.teamId),a={userId:t.uid,email:t.email||"",displayName:t.displayName,photoURL:t.photoURL,role:s.role,joinedAt:yo.fromDate(new Date),status:"active",invitedBy:s.inviterUserId};return await ql(o,{members:KW(a),updatedAt:Lo()}),await ql(i,{status:"accepted"}),{error:null}}catch(t){return console.error("팀 초대 수락 에러:",t),{error:"팀 초대 수락 중 오류가 발생했습니다."}}},oae=async(n,e)=>{try{const t=await Wr();if(!t)return{error:"로그인이 필요합니다."};const{team:i,error:r}=await GC(n);if(r||!i)return{error:r||"팀을 찾을 수 없습니다."};const s=i.members.find(l=>l.userId===t.uid);if(!s||s.role!=="owner"&&s.role!=="admin")return{error:"팀을 수정할 권한이 없습니다."};const o={updatedAt:Lo()};e.name&&(o.name=e.name),e.description!==void 0&&(o.description=e.description),e.settings&&(o.settings={...i.settings,...e.settings});const a=ts(rr,a1,n);return await ql(a,o),{error:null}}catch(t){return console.error("팀 업데이트 에러:",t),{error:"팀 업데이트 중 오류가 발생했습니다."}}},aae=async()=>{try{const n=await Wr();if(!n)return{invitations:[],error:"로그인이 필요합니다."};const e=ru(jl(rr,Ew),xl("inviteeEmail","==",n.email),xl("status","==","pending"),w0("createdAt","desc")),t=await kd(e),i=[];return t.forEach(r=>{const s=r.data();s.expiresAt.toDate()>new Date&&i.push({id:r.id,...s})}),{invitations:i,error:null}}catch(n){return console.error("팀 초대 목록 가져오기 에러:",n),{invitations:[],error:"팀 초대 목록을 가져오는 중 오류가 발생했습니다."}}},lae=async(n,e)=>{try{const t=await Wr();if(!t)return{error:"로그인이 필요합니다."};const i=ts(rr,Ew,n),r=await Ru(i);if(!r.exists())return{error:"초대를 찾을 수 없습니다."};const s=r.data();return s.token!==e?{error:"유효하지 않은 초대입니다."}:s.inviteeEmail!==t.email?{error:"초대받은 이메일과 로그인한 계정이 다릅니다."}:s.status!=="pending"?{error:"이미 처리된 초대입니다."}:(await ql(i,{status:"declined"}),{error:null})}catch(t){return console.error("팀 초대 거절 에러:",t),{error:"팀 초대 거절 중 오류가 발생했습니다."}}};function cae(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}const hae=H.createContext(void 0);function uae({children:n}){const[e,t]=H.useState(null),[i,r]=H.useState([]),[s,o]=H.useState(null),[a,l]=H.useState(!0),[h,u]=H.useState(null);H.useEffect(()=>{d()},[h]),H.useEffect(()=>{Wr().then(g=>{u(g)})},[]);const d=async()=>{try{l(!0);const g=await Wr();if(!g){r([]),t(null),o(null);return}const{teams:v,error:w}=await Iz();if(w){console.error("Failed to load teams:",w);return}if(r(v),v.length>0&&!e){const y=v.find(S=>S.id===`personal_${g.uid}`)||v[0];t(y);const x=y.members.find(S=>S.userId===g.uid);o((x==null?void 0:x.role)||null),localStorage.setItem("activeTeamId",y.id)}}catch(g){console.error("Error loading teams:",g)}finally{l(!1)}},p={activeTeam:e,userTeams:i,userRole:s,isLoading:a,switchTeam:async g=>{const v=i.find(w=>w.id===g);if(v){t(v);const w=await Wr();if(w){const m=v.members.find(y=>y.userId===w.uid);o((m==null?void 0:m.role)||null)}localStorage.setItem("activeTeamId",g)}},refreshTeams:async()=>{await d()}};return c.jsx(hae.Provider,{value:p,children:n})}const dae="_errorContainer_y0a2k_1",Aae="_errorCard_y0a2k_13",fae="_errorIcon_y0a2k_22",pae="_errorTitle_y0a2k_27",gae="_errorMessage_y0a2k_34",mae="_reloadButton_y0a2k_41",U0={errorContainer:dae,errorCard:Aae,errorIcon:fae,errorTitle:pae,errorMessage:gae,reloadButton:mae};let yae=class extends H.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("🚨 ErrorBoundary caught an error:",e,t)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:c.jsx("div",{className:U0.errorContainer,children:c.jsxs("div",{className:U0.errorCard,children:[c.jsx("h1",{className:U0.errorIcon,children:"⚠️"}),c.jsx("h2",{className:U0.errorTitle,children:"문제가 발생했습니다"}),c.jsx("p",{className:U0.errorMessage,children:"예상치 못한 오류가 발생했습니다. 페이지를 새로고침하거나 잠시 후 다시 시도해주세요."}),c.jsx("button",{onClick:()=>window.location.reload(),className:U0.reloadButton,children:"페이지 새로고침"}),!1]})}):this.props.children}};const wae="_container_1sceu_2",vae="_spinner_1sceu_13",xae="_spinnerRing_1sceu_19",bae="_spin_1sceu_13",Cae="_small_1sceu_30",_ae="_medium_1sceu_36",Sae="_large_1sceu_42",Tae="_dots_1sceu_49",Bae="_dot_1sceu_49",Eae="_bounce_1sceu_1",Fae="_message_1sceu_76",kae="_fullscreen_1sceu_106",Iae="_gradientBg_1sceu_120",Dae="_gradientShift_1sceu_1",Au={container:wae,spinner:vae,spinnerRing:xae,spin:bae,small:Cae,medium:_ae,large:Sae,dots:Tae,dot:Bae,bounce:Eae,message:Fae,fullscreen:kae,gradientBg:Iae,gradientShift:Dae},jae=(n,e,t,i)=>{var s,o,a,l;const r=[t,{code:e,...i||{}}];if((o=(s=n==null?void 0:n.services)==null?void 0:s.logger)!=null&&o.forward)return n.services.logger.forward(r,"warn","react-i18next::",!0);zg(r[0])&&(r[0]=`react-i18next:: ${r[0]}`),(l=(a=n==null?void 0:n.services)==null?void 0:a.logger)!=null&&l.warn?n.services.logger.warn(...r):console!=null&&console.warn&&console.warn(...r)},vj={},$B=(n,e,t,i)=>{zg(t)&&vj[t]||(zg(t)&&(vj[t]=new Date),jae(n,e,t,i))},Dz=(n,e)=>()=>{if(n.isInitialized)e();else{const t=()=>{setTimeout(()=>{n.off("initialized",t)},0),e()};n.on("initialized",t)}},VB=(n,e,t)=>{n.loadNamespaces(e,Dz(n,t))},xj=(n,e,t,i)=>{if(zg(t)&&(t=[t]),n.options.preload&&n.options.preload.indexOf(e)>-1)return VB(n,t,i);t.forEach(r=>{n.options.ns.indexOf(r)<0&&n.options.ns.push(r)}),n.loadLanguages(e,Dz(n,i))},Pae=(n,e,t={})=>!e.languages||!e.languages.length?($B(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(n,{lng:t.lng,precheck:(i,r)=>{if(t.bindI18n&&t.bindI18n.indexOf("languageChanging")>-1&&i.services.backendConnector.backend&&i.isLanguageChangingTo&&!r(i.isLanguageChangingTo,n))return!1}}),zg=n=>typeof n=="string",Nae=n=>typeof n=="object"&&n!==null,Lae=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,Mae={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},Rae=n=>Mae[n],Uae=n=>n.replace(Lae,Rae);let GB={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:Uae};const Oae=(n={})=>{GB={...GB,...n}},Hae=()=>GB;let jz;const Wae=n=>{jz=n},zae=()=>jz,Qae={type:"3rdParty",init(n){Oae(n.options.react),Wae(n)}},$ae=H.createContext();class Vae{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(t=>{this.usedNamespaces[t]||(this.usedNamespaces[t]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const Gae=(n,e)=>{const t=H.useRef();return H.useEffect(()=>{t.current=n},[n,e]),t.current},Pz=(n,e,t,i)=>n.getFixedT(e,t,i),Xae=(n,e,t,i)=>H.useCallback(Pz(n,e,t,i),[n,e,t,i]),yv=(n,e={})=>{var x,S,I,j;const{i18n:t}=e,{i18n:i,defaultNS:r}=H.useContext($ae)||{},s=t||i||zae();if(s&&!s.reportNamespaces&&(s.reportNamespaces=new Vae),!s){$B(s,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const C=(D,T)=>zg(T)?T:Nae(T)&&zg(T.defaultValue)?T.defaultValue:Array.isArray(D)?D[D.length-1]:D,b=[C,{},!1];return b.t=C,b.i18n={},b.ready=!1,b}(x=s.options.react)!=null&&x.wait&&$B(s,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const o={...Hae(),...s.options.react,...e},{useSuspense:a,keyPrefix:l}=o;let h=r||((S=s.options)==null?void 0:S.defaultNS);h=zg(h)?[h]:h||["translation"],(j=(I=s.reportNamespaces).addUsedNamespaces)==null||j.call(I,h);const u=(s.isInitialized||s.initializedStoreOnce)&&h.every(C=>Pae(C,s,o)),d=Xae(s,e.lng||null,o.nsMode==="fallback"?h:h[0],l),A=()=>d,f=()=>Pz(s,e.lng||null,o.nsMode==="fallback"?h:h[0],l),[p,g]=H.useState(A);let v=h.join();e.lng&&(v=`${e.lng}${v}`);const w=Gae(v),m=H.useRef(!0);H.useEffect(()=>{const{bindI18n:C,bindI18nStore:b}=o;m.current=!0,!u&&!a&&(e.lng?xj(s,e.lng,h,()=>{m.current&&g(f)}):VB(s,h,()=>{m.current&&g(f)})),u&&w&&w!==v&&m.current&&g(f);const D=()=>{m.current&&g(f)};return C&&(s==null||s.on(C,D)),b&&(s==null||s.store.on(b,D)),()=>{m.current=!1,s&&C&&(C==null||C.split(" ").forEach(T=>s.off(T,D))),b&&s&&b.split(" ").forEach(T=>s.store.off(T,D))}},[s,v]),H.useEffect(()=>{m.current&&u&&g(A)},[s,l,u]);const y=[p,s,u];if(y.t=p,y.i18n=s,y.ready=u,u||!u&&!a)return y;throw new Promise(C=>{e.lng?xj(s,e.lng,h,()=>C()):VB(s,h,()=>C())})},ia=()=>{const{t:n,i18n:e,ready:t}=yv(),[i,r]=H.useState(e.language);return H.useEffect(()=>{const a=l=>{r(l),window.dispatchEvent(new CustomEvent("languageChange",{detail:l}))};return e.on("languageChanged",a),()=>{e.off("languageChanged",a)}},[e]),{t:n,i18n:e,ready:t,currentLanguage:i,changeLanguage:async a=>{await e.changeLanguage(a),localStorage.setItem("app-language",a)},availableLanguages:[{code:"ko",name:"한국어"},{code:"en",name:"English"},{code:"ja",name:"日本語"},{code:"zh",name:"中文"}]}},k1=({message:n,size:e="medium",type:t="spinner",fullscreen:i=!1})=>{const{t:r}=ia(),{theme:s}=Ua(),o=n||r("common.loading"),a=i?`${Au.container} ${Au.fullscreen} ${Au.gradientBg}`:Au.container;return c.jsxs("div",{className:a,"data-theme-color":s.color,children:[t==="spinner"?c.jsx("div",{className:`${Au.spinner} ${Au[e]}`,children:c.jsx("div",{className:Au.spinnerRing})}):c.jsxs("div",{className:Au.dots,children:[c.jsx("div",{className:Au.dot}),c.jsx("div",{className:Au.dot}),c.jsx("div",{className:Au.dot})]}),o&&c.jsx("p",{className:Au.message,children:o})]})},Yae="projects";const XB=n=>{if(n==null)return n;if(Array.isArray(n))return n.map(e=>XB(e));if(typeof n=="object"&&n.constructor===Object){const e={};for(const t in n)if(n.hasOwnProperty(t)){const i=n[t];i!==void 0&&(e[t]=XB(i))}return e}return n},Kae=async(n,e,t)=>{try{if(console.log("🔍 createProject 호출됨, projectData:",n),!n||!n.basicInfo)return console.error("❌ basicInfo가 없습니다:",n),{success:!1,error:"basicInfo가 필요합니다."};const i=await Wr();if(!i)return{success:!1,error:"로그인이 필요합니다."};const r=Lo(),s={userId:i.uid,title:n.basicInfo.title,createdAt:r,updatedAt:r,basicInfo:{...n.basicInfo,createdAt:r,updatedAt:r},spaceConfig:n.spaceConfig,customLayout:n.customLayout,metadata:{status:"draft",priority:"medium",tags:[],isFavorite:!1},stats:{designFileCount:0,furnitureCount:0,completionRate:0,lastOpenedAt:r},furniture:{placedModules:[]}},o=XB(s);console.log("🧹 undefined 값 제거 후 데이터:",o);const a=await gv(jl(rr,Yae),o);let l;return e&&!(t!=null&&t.skipThumbnail)||t!=null&&t.skipThumbnail,console.log("✅ 프로젝트 생성 완료:",{id:a.id,title:n.basicInfo.title,thumbnailUrl:l}),{success:!0,data:a.id}}catch(i){return console.error("❌ 프로젝트 생성 실패:",i),{success:!1,error:i instanceof Error?i.message:"프로젝트 생성 중 오류가 발생했습니다."}}};const qae="_container_ksj7q_1",Zae="_fullWidth_ksj7q_7",Jae="_label_ksj7q_11",ele="_inputWrapper_ksj7q_17",tle="_input_ksj7q_17",nle="_small_ksj7q_51",ile="_medium_ksj7q_57",rle="_large_ksj7q_63",sle="_error_ksj7q_70",ole="_errorMessage_ksj7q_80",ale="_leftIcon_ksj7q_87",lle="_rightIcon_ksj7q_87",cle="_hasLeftIcon_ksj7q_107",hle="_hasRightIcon_ksj7q_111",fu={container:qae,fullWidth:Zae,label:Jae,inputWrapper:ele,input:tle,small:nle,medium:ile,large:rle,error:sle,errorMessage:ole,leftIcon:ale,rightIcon:lle,hasLeftIcon:cle,hasRightIcon:hle},zy=({size:n="medium",error:e,label:t,leftIcon:i,rightIcon:r,className:s="",fullWidth:o=!1,...a})=>{const l=[fu.container,o&&fu.fullWidth,s].filter(Boolean).join(" "),h=[fu.input,fu[n],e&&fu.error,i&&fu.hasLeftIcon,r&&fu.hasRightIcon].filter(Boolean).join(" ");return c.jsxs("div",{className:l,children:[t&&c.jsx("label",{className:fu.label,children:t}),c.jsxs("div",{className:fu.inputWrapper,children:[i&&c.jsx("span",{className:fu.leftIcon,children:i}),c.jsx("input",{className:h,...a}),r&&c.jsx("span",{className:fu.rightIcon,children:r})]}),e&&c.jsx("span",{className:fu.errorMessage,children:e})]})},ule="_container_2e54x_2",dle="_loadingOverlay_2e54x_17",Ale="_modalContent_2e54x_32",fle="_header_2e54x_55",ple="_closeButton_2e54x_62",gle="_content_2e54x_99",mle="_leftSection_2e54x_105",yle="_iconContainer_2e54x_115",wle="_stepIcon_2e54x_122",vle="_stepIconSvg_2e54x_126",xle="_iconBackground_2e54x_130",ble="_iconPaper_2e54x_134",Cle="_iconAccent_2e54x_138",_le="_stepInfo_2e54x_142",Sle="_stepNumber_2e54x_146",Tle="_rightSection_2e54x_153",Ble="_formSection_2e54x_159",Ele="_form_2e54x_159",Fle="_inputGroup_2e54x_172",kle="_fieldLabel_2e54x_178",Ile="_checkIcon_2e54x_188",Dle="_inputWrapper_2e54x_195",jle="_dropdownToggle_2e54x_201",Ple="_dropdown_2e54x_201",Nle="_dropdownOption_2e54x_236",Lle="_footer_2e54x_264",Mle="_nextButton_2e54x_275",Cs={container:ule,loadingOverlay:dle,modalContent:Ale,header:fle,closeButton:ple,content:gle,leftSection:mle,iconContainer:yle,stepIcon:wle,stepIconSvg:vle,iconBackground:xle,iconPaper:ble,iconAccent:Cle,stepInfo:_le,stepNumber:Sle,rightSection:Tle,formSection:Ble,form:Ele,inputGroup:Fle,fieldLabel:kle,checkIcon:Ile,inputWrapper:Dle,dropdownToggle:jle,dropdown:Ple,dropdownOption:Nle,footer:Lle,nextButton:Mle},Rle=({onNext:n,onClose:e,projectId:t,projectTitle:i})=>{var B;const r=Pl(),{basicInfo:s,setBasicInfo:o,projectId:a,setProjectId:l,projectTitle:h}=r,u=H.useRef(null),d=H.useRef(null);H.useEffect(()=>{u.current||(u.current=a||t||null),d.current||(d.current=h||i||null)},[]),H.useEffect(()=>{a&&(u.current=a),h&&(d.current=h)},[a,h]);const A=H.useMemo(()=>u.current||a||t||null,[a,t,u.current]),f=H.useMemo(()=>d.current||h||i||null,[h,i,d.current]);H.useEffect(()=>{console.log("🔥 Step1BasicInfo 마운트/업데이트:",{propsProjectId:t,storeProjectId:a,refProjectId:u.current,finalProjectId:A,storeProjectTitle:h,refProjectTitle:d.current,finalProjectTitle:f,basicInfo:s})});const{spaceInfo:p,setSpaceInfo:g}=hr(),[v,w]=H.useState(!1),m=H.useRef(null),[y,x]=H.useState(p.hasFloorFinish||!1),[S,I]=H.useState(((B=p.floorFinish)==null?void 0:B.height)||10),[j,C]=H.useState(!1),b=["안방","거실","아이방","옷방","창고"],D=s.title&&s.title.trim()&&s.location&&s.location.trim(),T=E=>{o({...s,...E})};H.useEffect(()=>{const E=z=>{m.current&&!m.current.contains(z.target)&&w(!1)};return document.addEventListener("mousedown",E),()=>{document.removeEventListener("mousedown",E)}},[]);const k=E=>{T({location:E}),w(!1)};return c.jsxs("div",{className:Cs.container,"data-theme":"light",style:{colorScheme:"light"},children:[j&&c.jsx("div",{className:Cs.loadingOverlay,children:c.jsx(k1,{message:"프로젝트 생성 중...",size:"large",type:"spinner"})}),c.jsxs("div",{className:Cs.modalContent,children:[c.jsxs("div",{className:Cs.header,children:[c.jsx("button",{className:Cs.closeButton,"aria-label":"닫기",onClick:e,children:"×"}),c.jsx("div",{children:c.jsxs("h1",{children:["STEP. 1 디자인 정보",A&&f&&c.jsxs("span",{style:{marginLeft:"20px",fontSize:"0.8em",color:"#666"},children:["프로젝트: ",f]})]})})]}),c.jsxs("div",{className:Cs.content,children:[c.jsx("div",{className:Cs.leftSection,children:c.jsxs("div",{className:Cs.iconContainer,children:[c.jsx("div",{className:Cs.stepIcon,children:c.jsxs("svg",{width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",className:Cs.stepIconSvg,children:[c.jsx("circle",{cx:"60",cy:"60",r:"60",className:Cs.iconBackground}),c.jsx("rect",{x:"30",y:"35",width:"60",height:"50",rx:"4",className:Cs.iconPaper}),c.jsx("rect",{x:"35",y:"45",width:"30",height:"2",className:Cs.iconAccent}),c.jsx("rect",{x:"35",y:"50",width:"40",height:"2",className:Cs.iconAccent}),c.jsx("rect",{x:"35",y:"55",width:"25",height:"2",className:Cs.iconAccent}),c.jsx("rect",{x:"35",y:"65",width:"35",height:"2",className:Cs.iconAccent}),c.jsx("rect",{x:"35",y:"70",width:"20",height:"2",className:Cs.iconAccent}),c.jsx("circle",{cx:"75",cy:"65",r:"8",className:Cs.iconAccent}),c.jsx("path",{d:"M71 65l2 2 4-4",stroke:"white",strokeWidth:"2",fill:"none"}),c.jsx("rect",{x:"82",y:"40",width:"8",height:"25",rx:"1",className:Cs.iconPaper}),c.jsx("rect",{x:"84",y:"35",width:"4",height:"8",rx:"2",className:Cs.iconPaper})]})}),c.jsx("div",{className:Cs.stepInfo,children:c.jsx("span",{className:Cs.stepNumber,children:"1 단계 / 3"})})]})}),c.jsx("div",{className:Cs.rightSection,children:c.jsxs("div",{className:Cs.formSection,children:[c.jsx("h2",{children:"정보"}),c.jsxs("div",{className:Cs.form,children:[c.jsxs("div",{className:Cs.inputGroup,children:[c.jsxs("label",{className:Cs.fieldLabel,children:[s.title&&s.title.trim()&&c.jsx("span",{className:Cs.checkIcon,children:"✓"}),A?"디자인파일 명":"프로젝트 제목"]}),c.jsx(zy,{placeholder:A?"디자인파일 명을 입력해주세요":"프로젝트 제목을 입력해주세요",value:s.title||"",onChange:E=>T({title:E.target.value}),fullWidth:!0,size:"medium"})]}),c.jsxs("div",{className:Cs.inputGroup,children:[c.jsxs("label",{className:Cs.fieldLabel,children:[s.location&&s.location.trim()&&c.jsx("span",{className:Cs.checkIcon,children:"✓"}),"설치 위치"]}),c.jsxs("div",{className:Cs.inputWrapper,ref:m,children:[c.jsx(zy,{placeholder:"설치 위치를 선택하거나 입력해주세요",value:s.location||"",onChange:E=>T({location:E.target.value}),onFocus:()=>w(!0),fullWidth:!0,size:"medium"}),c.jsx("button",{type:"button",className:Cs.dropdownToggle,onClick:()=>w(!v),children:c.jsx("svg",{width:"12",height:"8",viewBox:"0 0 12 8",fill:"none",children:c.jsx("path",{d:"M1 1.5L6 6.5L11 1.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),v&&c.jsx("div",{className:Cs.dropdown,children:b.map(E=>c.jsx("button",{className:Cs.dropdownOption,onClick:()=>k(E),children:E},E))})]})]})]})]})})]}),c.jsx("div",{className:Cs.footer,children:c.jsx("button",{className:Cs.nextButton,onClick:async()=>{if(console.log("🔥 다음 단계 버튼 클릭, projectId:",A),A)console.log("✅ projectId가 있어서 다음 단계로 이동:",A),n();else{console.log("⚠️ projectId가 없어서 새 프로젝트 생성 시도"),C(!0);try{const E=await Wr();if(!E){alert("로그인이 필요합니다."),C(!1);return}const z=Lo(),te={userId:E.uid,basicInfo:{title:s.title,location:s.location,description:s.description||"",unitType:s.unitType||"household",category:s.category||"residential",createdAt:z,updatedAt:z,version:"1.0.0"},spaceConfig:p,customLayout:{wall:{type:"wall",completed:!1},rack:{thickness:"2mm",completed:!1,options:{isComposite:!1}},motor:{type:"none",completed:!1},ventilation:{type:"none",completed:!1},exhaust:{type:"none",completed:!1}}},L=await Kae(te);L.success&&L.data?(l(L.data),console.log("프로젝트 생성 완료:",L.data),n()):alert(`프로젝트 생성 실패: ${L.error||"알 수 없는 오류"}`)}catch(E){console.error("프로젝트 생성 오류:",E),alert("프로젝트 생성 중 오류가 발생했습니다.")}finally{C(!1)}}},disabled:!D||j,children:j?"저장 중...":"다음 단계"})})]})]})};function Nz(n){return`teams/${n}/designs`}const Ule=(n,e,t)=>ts(rr,`teams/${n}/projects/${e}/designs/${t}`),Lz={projects:"projects",designs:"designs",designFiles:"designFiles",folders:"folders"};async function YB(){try{const{getCurrentUserAsync:t}=await rl(async()=>{const{getCurrentUserAsync:r}=await Promise.resolve().then(()=>toe);return{getCurrentUserAsync:r}},void 0),i=await t();if(i!=null&&i.uid)return`personal_${i.uid}`}catch{console.log("Firebase Auth 확인 실패, fallback 사용")}const n=localStorage.getItem("activeTeamId");if(n)return n;const e=localStorage.getItem("userId");return e?`personal_${e}`:null}const Ole=Object.freeze(Object.defineProperty({__proto__:null,LEGACY_COLLECTIONS:Lz,getActiveTeamId:YB,getTeamDesignsPath:Nz,projectDesignDoc:Ule},Symbol.toStringTag,{value:"Module"}));async function Hle(n,e,t){try{console.log("📂 [listDesignFiles] 시작:",{projectId:n,userId:e,teamId:t,FLAGS:zc,activeTeamId:t||await YB()});const i=[],r=t||await YB();console.log("📂 Trying legacy path: designFiles collection");const s=ru(jl(rr,Lz.designFiles),xl("projectId","==",n),w0("updatedAt","desc")),o=await kd(s);return console.log("📂 Legacy snapshot empty?",o.empty,"size:",o.size),o.forEach(a=>{var h,u,d,A,f,p,g;const l=a.data();console.log("📂 Found design in legacy:",{id:a.id,name:l.name,projectId:l.projectId,furniture:((u=(h=l.furniture)==null?void 0:h.placedModules)==null?void 0:u.length)||0}),i.push({id:a.id,name:l.name,projectId:l.projectId,folderId:l.folderId,updatedAt:l.updatedAt,spaceSize:{width:((d=l.spaceConfig)==null?void 0:d.width)||0,height:((A=l.spaceConfig)==null?void 0:A.height)||0,depth:((f=l.spaceConfig)==null?void 0:f.depth)||0},furnitureCount:((g=(p=l.furniture)==null?void 0:p.placedModules)==null?void 0:g.length)||0,thumbnail:l.thumbnail,spaceConfig:l.spaceConfig,furniture:l.furniture})}),console.log("🎨 Found designs in legacy:",i.length),{designs:i,error:null}}catch(i){return console.error("Error listing design files:",i),{designs:[],error:i instanceof Error?i.message:"Failed to list designs"}}}async function Mz(n,e){try{const t=Nz(n),i=ts(rr,t,e),r=await Ru(i);return r.exists()&&r.data().current_version_id||null}catch(t){return console.error("Error getting current version ID:",t),null}}const Cd="projects";async function Qg(){const n=localStorage.getItem("activeTeamId");if(n)return n;const e=await Wr();return e?`personal_${e.uid}`:null}const XC=async n=>{try{const e=await Wr();if(!e)return{id:null,error:"로그인이 필요합니다."};const t=await Qg(),i={userId:e.uid,teamId:t||`personal_${e.uid}`,title:n.title,createdAt:Lo(),updatedAt:Lo(),version:"1.0.0",stats:{designFileCount:0,lastOpenedAt:Lo(),furnitureCount:0},spaceConfig:n.spaceConfig||{width:3600,height:2400,depth:1500,installType:"builtin",surroundType:"surround",baseConfig:{type:"floor",height:65,placementType:"ground"},hasFloorFinish:!1,floorFinish:null,wallConfig:{left:!0,right:!0,top:!0},materialConfig:{interiorColor:"#FFFFFF",doorColor:"#E0E0E0"},columns:[],frameSize:{upper:50,base:50,left:50,right:50},gapConfig:{left:2,right:2}},furniture:{placedModules:[]}},r=await gv(jl(rr,Cd),i);if(console.log("✅ 프로젝트 생성 - Legacy path:",`${Cd}/${r.id}`),zc.dualWrite&&zc.teamScope&&t)try{const s=`teams/${t}/projects`;await i0(ts(rr,s,r.id),i,{merge:!0}),console.log("✅ Dual-write to team path:",`${s}/${r.id}`)}catch(s){console.warn("⚠️ Team path dual-write failed (non-critical):",s)}return{id:r.id,error:null}}catch(e){return console.error("프로젝트 생성 에러:",e),{id:null,error:"프로젝트 생성 중 오류가 발생했습니다."}}},fk=async n=>{var e,t,i,r;try{console.log("💾 createDesignFile 함수 호출됨:",{name:n.name,projectId:n.projectId,hasSpaceConfig:!!n.spaceConfig,hasFurniture:!!n.furniture,furnitureCount:((t=(e=n.furniture)==null?void 0:e.placedModules)==null?void 0:t.length)||0});const s=await Wr();if(!s)return console.error("🚫 사용자 인증 실패"),{id:null,error:"로그인이 필요합니다."};console.log("👤 현재 사용자:",s.uid);const o=await Qg(),a=Lo(),l={...n.spaceConfig,mainDoorCount:n.spaceConfig.mainDoorCount??0,droppedCeilingDoorCount:n.spaceConfig.droppedCeilingDoorCount??0},h={name:n.name,projectId:n.projectId,spaceConfig:l,furniture:n.furniture,userId:s.uid,teamId:o||"",createdAt:a,updatedAt:a};n.thumbnail!==void 0&&n.thumbnail!==null&&(h.thumbnail=n.thumbnail);const u=n.folderId?{...h,folderId:n.folderId}:h;console.log("📋 최종 Firestore 저장 데이터:",{...u,furnitureModulesCount:((r=(i=u.furniture)==null?void 0:i.placedModules)==null?void 0:r.length)||0,spaceConfigKeys:u.spaceConfig?Object.keys(u.spaceConfig):[]});let d,A;if(d=await gv(jl(rr,"designFiles"),u),A=d.id,console.log("✅ Legacy path 저장 성공:",`designFiles/${A}`),zc.dualWrite&&o)try{if(zc.teamScope){const f=`teams/${o}/designs`;await i0(ts(rr,f,A),u,{merge:!0}),console.log("✅ Dual-write to team path:",`${f}/${A}`)}if(zc.nestedDesigns&&n.projectId){const{projectDesignDoc:f}=await rl(async()=>{const{projectDesignDoc:p}=await Promise.resolve().then(()=>Ole);return{projectDesignDoc:p}},void 0);await i0(f(o,n.projectId,A),u,{merge:!0}),console.log("✅ Dual-write to nested project path:",`teams/${o}/projects/${n.projectId}/designs/${A}`)}}catch(f){console.warn("⚠️ Dual-write failed (non-critical):",f)}return await Rz(n.projectId),{id:A,error:null}}catch(s){return console.error("❌ 디자인파일 생성 에러:",s),{id:null,error:s instanceof Error?s.message:"디자인파일 생성 중 오류가 발생했습니다."}}},D5=async n=>{var e,t;try{console.log("🔍 [getDesignFiles] 시작:",{projectId:n});const i=await Wr();if(!i)return{designFiles:[],error:"로그인이 필요합니다."};const r=await Qg();console.log("🔍 [getDesignFiles] 팀 ID:",r);const s=await Hle(n,i.uid,r||void 0);return console.log("🔍 [getDesignFiles] repo 결과:",{hasError:!!s.error,designCount:((e=s.designs)==null?void 0:e.length)||0,designs:(t=s.designs)==null?void 0:t.map(o=>({id:o.id,name:o.name,projectId:o.projectId}))}),s.error?(console.error("디자인파일 목록 가져오기 에러:",s.error),{designFiles:[],error:s.error}):(s.designs.sort((o,a)=>{var u,d;const l=((u=o.updatedAt)==null?void 0:u.seconds)||0;return(((d=a.updatedAt)==null?void 0:d.seconds)||0)-l}),console.log("🔍 [getDesignFiles] 최종 결과:",{count:s.designs.length,firstDesign:s.designs[0]}),{designFiles:s.designs,error:null})}catch(i){return console.error("디자인파일 목록 가져오기 에러:",i),{designFiles:[],error:"디자인파일 목록을 가져오는 중 오류가 발생했습니다."}}},Rz=async n=>{try{const{designFiles:e}=await D5(n),t=ts(rr,Cd,n);await ql(t,{"stats.designFileCount":e.length,"stats.lastOpenedAt":Lo(),updatedAt:Lo()})}catch(e){console.error("프로젝트 통계 업데이트 에러:",e)}},Qy=async n=>{try{const e=await Wr();if(!e)return{project:null,error:"로그인이 필요합니다."};const t=ts(rr,Cd,n),i=await vc(t);if(!i.exists())return{project:null,error:"프로젝트를 찾을 수 없습니다."};const r=i.data();return r.userId!==e.uid?{project:null,error:"프로젝트에 접근할 권한이 없습니다."}:{project:{id:i.id,...r},error:null}}catch(e){return console.error("프로젝트 불러오기 에러:",e),{project:null,error:"프로젝트 불러오기 중 오류가 발생했습니다."}}},Uz=async n=>{var e,t;try{const i=await Wr();if(!i)return{project:null,error:"로그인이 필요합니다."};const r=ts(rr,Cd,n),s=await vc(r);if(!s.exists())return{project:null,error:"프로젝트를 찾을 수 없습니다."};const o=s.data();if(o.userId!==i.uid)return{project:null,error:"프로젝트에 접근할 권한이 없습니다."};const a={id:s.id,...o,spaceConfig:o.spaceConfig||null,furniture:o.furniture||{placedModules:[]},stats:o.stats||{furnitureCount:0}};return console.log("🔍 Firebase 프로젝트 조회:",{id:a.id,hasSpaceConfig:!!a.spaceConfig,furnitureCount:((t=(e=a.furniture)==null?void 0:e.placedModules)==null?void 0:t.length)||0}),{project:a,error:null}}catch(i){return console.error("프로젝트 불러오기 에러:",i),{project:null,error:"프로젝트 불러오기 중 오류가 발생했습니다."}}},Oz=async(n,e,t)=>{var i;try{const r=await Wr();if(!r)return{error:"로그인이 필요합니다."};const s=ts(rr,Cd,n),o=await vc(s);if(!o.exists()||o.data().userId!==r.uid)return{error:"프로젝트에 접근할 권한이 없습니다."};const a={updatedAt:Lo(),...e.title&&{title:e.title},...e.projectData&&{projectData:e.projectData},...e.spaceConfig&&{spaceConfig:e.spaceConfig},...e.furniture&&{furniture:e.furniture,"stats.furnitureCount":e.furniture.placedModules.length},...t&&{thumbnail:t}};e.spaceConfig&&(console.log("🔥 Firebase 저장 - spaceConfig 입력:",e.spaceConfig),console.log("🔥 Firebase 저장 - materialConfig 입력:",e.spaceConfig.materialConfig)),console.log("🔥 Firebase 저장 - 최종 updateData:",a),await ql(s,a);const l=await Ru(s);if(l.exists()){const h=l.data();console.log("🔥 Firebase 저장 후 확인 - spaceConfig:",h.spaceConfig),console.log("🔥 Firebase 저장 후 확인 - materialConfig:",(i=h.spaceConfig)==null?void 0:i.materialConfig)}return{error:null}}catch(r){return console.error("프로젝트 업데이트 에러:",r),{error:"프로젝트 업데이트 중 오류가 발생했습니다."}}},KB=async n=>{try{const e=await Wr();if(!e)return{error:"로그인이 필요합니다."};const t=[];let i=null;if(zc.teamScope){const h=await Qg();if(h){const u=ts(rr,`teams/${h}/projects`,n),d=await vc(u);d.exists()&&(t.push(u),i=d.data(),console.log("팀 스코프에서 프로젝트 찾음:",`teams/${h}/projects/${n}`))}}const r=ts(rr,Cd,n),s=await vc(r);if(s.exists()&&(t.push(r),i||(i=s.data()),console.log("Legacy 경로에서 프로젝트 찾음:",`projects/${n}`)),t.length===0||!i)return console.error("프로젝트를 찾을 수 없음:",n),{error:"프로젝트를 찾을 수 없습니다."};if(i.userId!==e.uid)return console.error("프로젝트 삭제 권한 없음:",{projectUserId:i.userId,currentUserId:e.uid,projectId:n}),{error:"프로젝트 삭제 권한이 없습니다."};const o=ru(jl(rr,"designFiles"),xl("projectId","==",n)),a=await GW(o);if(a.size>0){const h=a.docs.map(u=>QC(u.ref));await Promise.all(h),console.log(`디자인파일 ${a.size}개 삭제 완료`)}const l=t.map(h=>QC(h));return await Promise.all(l),console.log(`프로젝트 삭제 완료 (${t.length}개 경로에서 삭제):`,n),console.log(`프로젝트 삭제 완료: ${n}`),{error:null}}catch(e){return console.error("프로젝트 삭제 에러:",e),{error:"프로젝트 삭제 중 오류가 발생했습니다."}}},Hz=async(n,e)=>{var t,i,r,s,o,a;try{if(console.log("🔥 [updateDesignFile] 시작:",{designFileId:n,hasName:!!e.name,hasSpaceConfig:!!e.spaceConfig,hasFurniture:!!e.furniture,hasThumbnail:!!e.thumbnail,furnitureCount:((i=(t=e.furniture)==null?void 0:t.placedModules)==null?void 0:i.length)||0}),!await Wr())return console.error("🔥 [updateDesignFile] 사용자 인증 실패"),{error:"로그인이 필요합니다."};let h=null,u=null,d=null,A=null,f=null;const p=ts(rr,"designFiles",n),g=await vc(p);if(g.exists()&&(h=p,u=g,d=g.data(),f=d.projectId,A="legacy",console.log("🔥 Legacy path에서 디자인 찾음:",{designFileId:n,projectId:f})),!h){const y=await Qg();if(zc.teamScope&&y){const x=ts(rr,`teams/${y}/designs`,n),S=await vc(x);S.exists()&&(h=x,u=S,d=S.data(),f=d.projectId,A="team-scoped",console.log("🔥 Team-scoped path에서 디자인 찾음:",{designFileId:n,teamId:y,projectId:f}))}}if(!h&&zc.nestedDesigns&&f){const y=await Qg();if(y){const x=ts(rr,`teams/${y}/projects/${f}/designs`,n),S=await vc(x);S.exists()&&(h=x,u=S,d=S.data(),A="nested",console.log("🔥 Nested path에서 디자인 찾음:",{designFileId:n,teamId:y,projectId:f}))}}if(!h||!d)return console.error("🔥 [updateDesignFile] 디자인파일을 찾을 수 없음:",n),{error:"디자인파일을 찾을 수 없습니다."};const v=e.spaceConfig?{...e.spaceConfig,mainDoorCount:e.spaceConfig.mainDoorCount??0,droppedCeilingDoorCount:e.spaceConfig.droppedCeilingDoorCount??0}:void 0,w={updatedAt:Lo(),...e.name&&{name:e.name},...v&&{spaceConfig:v},...e.furniture&&{furniture:e.furniture},...e.thumbnail&&{thumbnail:e.thumbnail}};if(console.log("🔥 [updateDesignFile] 업데이트 데이터:",{foundPath:A,hasUpdatedAt:!!w.updatedAt,keys:Object.keys(w),furnitureModulesCount:((s=(r=w.furniture)==null?void 0:r.placedModules)==null?void 0:s.length)||0}),await ql(h,w),zc.dualWrite){const y=await Qg();if(A!=="legacy")try{const x=ts(rr,"designFiles",n);await ql(x,w),console.log("🔥 Dual-write to legacy path 완료")}catch(x){console.warn("Legacy path dual-write 실패 (문서가 없을 수 있음):",x)}if(A!=="team-scoped"&&zc.teamScope&&y)try{const x=ts(rr,`teams/${y}/designs`,n);await ql(x,w),console.log("🔥 Dual-write to team-scoped path 완료")}catch(x){console.warn("Team-scoped path dual-write 실패 (문서가 없을 수 있음):",x)}if(A!=="nested"&&zc.nestedDesigns&&y&&f)try{const x=ts(rr,`teams/${y}/projects/${f}/designs`,n);await ql(x,w),console.log("🔥 Dual-write to nested path 완료")}catch(x){console.warn("Nested path dual-write 실패 (문서가 없을 수 있음):",x)}}console.log("🔥 [updateDesignFile] 저장 직후 확인 시작");const m=await vc(h);if(m.exists()){const y=m.data();console.log("🔥 [updateDesignFile] 저장 직후 확인:",{savedFurnitureCount:((a=(o=y.furniture)==null?void 0:o.placedModules)==null?void 0:a.length)||0,savedUpdatedAt:y.updatedAt,savedSpaceConfigKeys:y.spaceConfig?Object.keys(y.spaceConfig):[]})}if(e.thumbnail&&f)try{const y=ts(rr,Cd,f);await ql(y,{thumbnail:e.thumbnail,updatedAt:Lo()}),console.log(`프로젝트 썸네일도 업데이트됨: ${f}`)}catch(y){console.warn("프로젝트 썸네일 업데이트 실패:",y)}return console.log(`디자인파일 업데이트 완료: ${n}`),{error:null}}catch(l){return console.error("디자인파일 업데이트 에러:",l),{error:"디자인파일 업데이트 중 오류가 발생했습니다."}}},pk=async(n,e)=>{try{const t=await Wr();if(!t)return{error:"로그인이 필요합니다."};const i=ts(rr,"designFiles",n),r=ts(rr,Cd,e),s=await vc(r);return!s.exists()||s.data().userId!==t.uid?{error:"이 디자인파일을 삭제할 권한이 없습니다."}:(await QC(i),await Rz(e),console.log(`디자인파일 삭제 완료: ${n}`),{error:null})}catch(t){return console.error("디자인파일 삭제 에러:",t),{error:"디자인파일 삭제 중 오류가 발생했습니다."}}},gk=async n=>{const{listProjects:e}=await rl(async()=>{const{listProjects:i}=await import("./projects.repo-DGCcIdqJ.js");return{listProjects:i}},__vite__mapDeps([0,1,2,3,4]));let t=n;if(!t){const i=await Wr();if(!i)return{projects:[],error:"로그인이 필요합니다."};t=i.uid}return e(t)},Wz=async n=>{var e,t,i,r,s,o,a,l,h,u;try{console.log("🔥 [Firebase] getDesignFileById 호출:",n);const d=await Wr();if(!d)return console.log("🔥 [Firebase] 사용자 인증 실패"),{designFile:null,error:"로그인이 필요합니다."};const A=ts(rr,"designFiles",n);console.log("🔥 [Firebase] Firestore 문서 조회 중... (서버에서 직접)");const f=await vc(A);if(console.log("🔥 [Firebase] 문서 존재 여부:",f.exists()),!f.exists())return console.log("🔥 [Firebase] 디자인 파일이 존재하지 않음"),{designFile:null,error:"디자인 파일을 찾을 수 없습니다."};const p=f.data();console.log("🔥 [Firebase] 디자인 파일 원본 데이터:",p),console.log("🔥 [Firebase] 디자인 파일 가구 데이터:",{hasData:!!p,projectId:p==null?void 0:p.projectId,hasFurniture:!!(p!=null&&p.furniture),furnitureData:p==null?void 0:p.furniture,placedModules:(e=p==null?void 0:p.furniture)==null?void 0:e.placedModules,furnitureCount:((i=(t=p==null?void 0:p.furniture)==null?void 0:t.placedModules)==null?void 0:i.length)||0});const g=ts(rr,Cd,p.projectId),v=await vc(g);if(v.exists()){if(v.data().userId!==d.uid)return{designFile:null,error:"디자인 파일에 접근할 권한이 없습니다."}}else{console.log("🔥 [Firebase] 프로젝트가 존재하지 않음:",p.projectId);const m=ru(LW(rr,"projects"),xl("__name__","==",p.projectId)),y=await kd(m);if(y.empty)return{designFile:null,error:"프로젝트를 찾을 수 없습니다."};const x=y.docs[0],S=x.data(),I=(r=x.ref.parent.parent)==null?void 0:r.id;if(I){const j=ts(rr,"teams",I),C=await vc(j);if(C.exists()&&!((s=C.data().members)==null?void 0:s.some(T=>T.userId===d.uid||T.email===d.email)))return{designFile:null,error:"디자인 파일에 접근할 권한이 없습니다."}}}console.log("🪑 [Firebase] 가구 데이터 처리 전:",{rawFurniture:p.furniture,hasFurniture:!!p.furniture,hasPlacedModules:!!((o=p.furniture)!=null&&o.placedModules),placedModulesCount:((l=(a=p.furniture)==null?void 0:a.placedModules)==null?void 0:l.length)||0});const w={id:f.id,name:p.name,projectId:p.projectId,folderId:p.folderId,spaceConfig:p.spaceConfig,furniture:p.furniture||{placedModules:[]},thumbnail:p.thumbnail,createdAt:p.createdAt,updatedAt:p.updatedAt};return console.log("🔍 디자인 파일 조회 완료:",{id:w.id,name:w.name,furniture:w.furniture,placedModulesCount:((u=(h=w.furniture)==null?void 0:h.placedModules)==null?void 0:u.length)||0}),{designFile:w,error:null}}catch(d){return console.error("디자인 파일 조회 에러:",d),{designFile:null,error:"디자인 파일을 불러오는 중 오류가 발생했습니다."}}},zz=async n=>{var e,t,i,r,s;try{console.log("🔥 [Firebase] getDesignFileByIdPublic 호출 (공유 링크):",n);const o=ts(rr,"designFiles",n);console.log("🔥 [Firebase] Firestore 문서 조회 중... (서버에서 직접)"),console.log("🔥 [Firebase] 문서 참조 경로:",o.path);const a=await vc(o);if(console.log("🔥 [Firebase] 문서 스냅샷:",a),console.log("🔥 [Firebase] 문서 존재 여부:",a.exists()),!a.exists())return console.log("🔥 [Firebase] 디자인 파일이 존재하지 않음"),{designFile:null,error:"디자인 파일을 찾을 수 없습니다."};const l=a.data();console.log("🔥 [Firebase] 디자인 파일 원본 데이터 (공유):",l),console.log("🔥 [Firebase] 디자인 파일 가구 데이터 (공유):",{hasData:!!l,projectId:l==null?void 0:l.projectId,hasFurniture:!!(l!=null&&l.furniture),furnitureData:l==null?void 0:l.furniture,placedModules:(e=l==null?void 0:l.furniture)==null?void 0:e.placedModules,furnitureCount:((i=(t=l==null?void 0:l.furniture)==null?void 0:t.placedModules)==null?void 0:i.length)||0});const h={id:a.id,name:l.name,projectId:l.projectId,folderId:l.folderId,spaceConfig:l.spaceConfig,furniture:l.furniture||{placedModules:[]},thumbnail:l.thumbnail,createdAt:l.createdAt,updatedAt:l.updatedAt};return console.log("🔍 디자인 파일 조회 완료 (공유):",{id:h.id,name:h.name,furniture:h.furniture,placedModulesCount:((s=(r=h.furniture)==null?void 0:r.placedModules)==null?void 0:s.length)||0}),{designFile:h,error:null}}catch(o){return console.error("🔥 디자인 파일 조회 에러 (공유):",o),console.error("🔥 에러 코드:",o==null?void 0:o.code),console.error("🔥 에러 메시지:",o==null?void 0:o.message),(o==null?void 0:o.code)==="permission-denied"?{designFile:null,error:"Firebase 보안 규칙에 의해 접근이 거부되었습니다. Firestore 규칙을 확인하세요."}:{designFile:null,error:`디자인 파일을 불러오는 중 오류가 발생했습니다: ${(o==null?void 0:o.message)||o}`}}},Qz=async n=>{var e,t;try{console.log("🔥 [Firebase] getProjectByIdPublic 호출 (공유 링크):",n);const i=ts(rr,Cd,n);console.log("🔥 [Firebase] 프로젝트 문서 참조 경로:",i.path);const r=await vc(i);if(console.log("🔥 [Firebase] 프로젝트 문서 스냅샷:",r),console.log("🔥 [Firebase] 프로젝트 문서 존재 여부:",r.exists()),!r.exists())return console.log("🔥 [Firebase] 프로젝트가 존재하지 않음 (공유)"),{project:null,error:"프로젝트를 찾을 수 없습니다."};const s=r.data(),o={id:r.id,...s,spaceConfig:s.spaceConfig||null,furniture:s.furniture||{placedModules:[]},stats:s.stats||{furnitureCount:0}};return console.log("🔍 Firebase 프로젝트 조회 (공유):",{id:o.id,hasSpaceConfig:!!o.spaceConfig,furnitureCount:((t=(e=o.furniture)==null?void 0:e.placedModules)==null?void 0:t.length)||0}),{project:o,error:null}}catch(i){return console.error("🔥 프로젝트 불러오기 에러 (공유):",i),console.error("🔥 에러 코드:",i==null?void 0:i.code),console.error("🔥 에러 메시지:",i==null?void 0:i.message),(i==null?void 0:i.code)==="permission-denied"?{project:null,error:"Firebase 보안 규칙에 의해 접근이 거부되었습니다. Firestore 규칙을 확인하세요."}:{project:null,error:`프로젝트를 불러오는 중 오류가 발생했습니다: ${(i==null?void 0:i.message)||i}`}}},$y=async(n,e)=>{try{const t=await Wr();if(!t)return{error:"로그인이 필요합니다."};const i=ts(rr,"projectFolders",`${t.uid}_${n}`);return await i0(i,{userId:t.uid,projectId:n,folders:e,updatedAt:Lo()}),{error:null}}catch(t){return console.error("폴더 데이터 저장 에러:",t),{error:"폴더 데이터 저장 중 오류가 발생했습니다."}}},mk=async n=>{try{const e=await Wr();if(!e)return{folders:[],error:"로그인이 필요합니다."};const t=ts(rr,"projectFolders",`${e.uid}_${n}`),i=await vc(t);return i.exists()?{folders:i.data().folders||[],error:null}:{folders:[],error:null}}catch(e){return console.error("폴더 데이터 불러오기 에러:",e),{folders:[],error:"폴더 데이터 불러오기 중 오류가 발생했습니다."}}},ZA=Object.freeze(Object.defineProperty({__proto__:null,createDesignFile:fk,createProject:XC,deleteDesignFile:pk,deleteProject:KB,getDesignFileById:Wz,getDesignFileByIdPublic:zz,getDesignFiles:D5,getProject:Qy,getProjectById:Uz,getProjectByIdPublic:Qz,getUserProjects:gk,loadFolderData:mk,saveFolderData:$y,updateDesignFile:Hz,updateProject:Oz},Symbol.toStringTag,{value:"Module"})),$z=()=>{const n=document.querySelectorAll("canvas");for(const e of n)if((e.getContext("webgl")||e.getContext("webgl2"))&&e.offsetWidth>100&&e.offsetHeight>100)return e;return null},Vz=(n,e={})=>{try{const{width:t=300,height:i=200,quality:r=.8}=e;if(n.width===0||n.height===0)return console.warn("캔버스 크기가 0입니다."),null;const s=document.createElement("canvas"),o=s.getContext("2d");return o?(s.width=t,s.height=i,o.fillStyle="#f5f5f5",o.fillRect(0,0,t,i),o.drawImage(n,0,0,n.width,n.height,0,0,t,i),s.toDataURL("image/png",r)):(console.error("임시 캔버스 컨텍스트를 생성할 수 없습니다."),null)}catch(t){return console.error("썸네일 캡처 실패:",t),null}},Wle=async()=>{var i,r;const n=$z();if(!n)return console.warn("3D 캔버스를 찾을 수 없어 썸네일을 생성할 수 없습니다."),null;if(n.offsetWidth===0||n.offsetHeight===0)return console.warn("캔버스가 보이지 않는 상태입니다."),null;console.log("📸 정면 뷰 썸네일 캡처 시작...");const e=(i=document.querySelector("[data-view-mode]"))==null?void 0:i.getAttribute("data-view-mode"),t=(r=document.querySelector("[data-view-direction]"))==null?void 0:r.getAttribute("data-view-direction");try{const s=document.querySelector('[data-view-mode="2D"]'),o=document.querySelector('[data-view-direction="front"]');s&&(s.click(),console.log("🔄 2D 모드로 전환")),o&&(o.click(),console.log("🔄 정면 뷰로 전환")),await new Promise(l=>setTimeout(l,200));const a=Vz(n,{width:300,height:200,quality:.8});if(a&&a.length>1e3)return console.log("📸 정면 뷰 썸네일 캡처 성공"),a}catch(s){console.error("정면 뷰 썸네일 캡처 실패:",s)}finally{if(e&&e!=="2D"){const s=document.querySelector(`[data-view-mode="${e}"]`);s&&(s.click(),console.log("🔄 원래 뷰 모드로 복원"))}if(t&&t!=="front"){const s=document.querySelector(`[data-view-direction="${t}"]`);s&&(s.click(),console.log("🔄 원래 뷰 방향으로 복원"))}}return null},YS=async()=>{const n=window.__uiStore;let e=!0,t=!0;if(n){const i=n.getState();e=i.showDimensions,t=i.showDimensionsText,n.getState().setShowDimensions(!1),n.getState().setShowDimensionsText(!1),console.log("📸 썸네일 캡처를 위해 치수 및 슬롯 가이드 숨김")}try{const i=await Wle();if(i)return i;const r=$z();if(!r)return console.warn("3D 캔버스를 찾을 수 없어 썸네일을 생성할 수 없습니다."),null;if(r.offsetWidth===0||r.offsetHeight===0)return console.warn("캔버스가 보이지 않는 상태입니다."),null;console.log("📸 3D 캔버스 썸네일 캡처 시작...",{canvasSize:`${r.width}x${r.height}`,displaySize:`${r.offsetWidth}x${r.offsetHeight}`}),await new Promise(s=>setTimeout(s,500));for(let s=1;s<=3;s++)try{const o=Vz(r,{width:300,height:200,quality:.7});if(o&&o.length>1e3)return console.log(`📸 썸네일 캡처 성공 (${s}번째 시도)`),o;s<3&&await new Promise(a=>setTimeout(a,100))}catch(o){console.warn(`썸네일 캡처 시도 ${s} 실패:`,o)}return console.warn("모든 썸네일 캡처 시도 실패"),null}finally{n&&(n.getState().setShowDimensions(e),n.getState().setShowDimensionsText(t),console.log("📸 치수 및 슬롯 가이드 원래 상태로 복원"))}},tC=(n,e)=>{const t=document.createElement("canvas"),i=t.getContext("2d");if(!i)return"";t.width=300,t.height=200;const r=i.createLinearGradient(0,0,300,200);r.addColorStop(0,"#f3e8d6"),r.addColorStop(1,"#d4b896"),i.fillStyle=r,i.fillRect(0,0,300,200),i.fillStyle="#8B4513",i.font="bold 16px Arial",i.textAlign="center";const s=Math.round(n.width),o=Math.round(n.height),a=Math.round(n.depth);return i.fillText(`${s} × ${o} × ${a}mm`,150,80),i.font="14px Arial",i.fillText(`가구 ${e}개`,150,120),i.fillStyle=getComputedStyle(document.documentElement).getPropertyValue("--theme-primary").trim()||"#10b981",i.fillRect(10,10,40,20),i.fillStyle="white",i.font="bold 12px Arial",i.textAlign="left",i.fillText("V5.0",15,24),t.toDataURL("image/png",.8)},zle=()=>({room:{floor:{color:"#e2e8f0",roughness:.5},walls:{color:"#f8fafc",roughness:.3}},furniture:{color:"#64748b",roughness:.2}}),Gz=H.createContext(null),qB=({spaceInfo:n,svgSize:e,renderMode:t="wireframe",viewMode:i="3D",activeZone:r=void 0,children:s})=>{const o=zle(),a=Tz(n),l={spaceInfo:n,canvasSize:e,styles:o,renderMode:t,viewMode:i,roomDimensions:a,activeZone:r};return c.jsx(Gz.Provider,{value:l,children:s})},bj={viewMode:"3D",view2DDirection:"front",doorsOpen:!1,showDimensions:!0,showDimensionsText:!0,showGuides:!0,showAxis:!0,showAll:!0,showFurniture:!0,renderMode:"solid",activePopup:{type:null,id:null},highlightedFrame:null,isColumnCreationMode:!1,selectedColumnId:null,isWallCreationMode:!1,selectedWallId:null,isPanelBCreationMode:!1,selectedPanelBId:null,isFurnitureDragging:!1,isDraggingColumn:!1,isSlotDragging:!1,activeDroppedCeilingTab:"main",highlightedCompartment:null,selectedModuleForPlacement:null,hoveredSlotForPlacement:null,indirectLightEnabled:!1,indirectLightIntensity:.8,indirectLightColor:"#ffffff"},Qle=()=>{try{const n=localStorage.getItem("app-theme-config");if(n)return JSON.parse(n).mode||"light"}catch(n){console.warn("테마 설정 로드 실패:",n)}return"light"},Wi=w1()(kq((n,e)=>{const t=Qle();return console.log("🔄 UIStore 초기화 - 앱 테마:",t),{...bj,view2DTheme:t,setViewMode:i=>n({viewMode:i}),setActiveDroppedCeilingTab:i=>n({activeDroppedCeilingTab:i}),setView2DDirection:i=>n({view2DDirection:i}),toggleDoors:()=>n(i=>({doorsOpen:!i.doorsOpen})),toggleDimensions:()=>n(i=>(console.log("🎯 toggleDimensions - 이전 상태:",i.showDimensions,"새 상태:",!i.showDimensions),{showDimensions:!i.showDimensions})),toggleDimensionsText:()=>n(i=>({showDimensionsText:!i.showDimensionsText})),toggleGuides:()=>n(i=>({showGuides:!i.showGuides})),toggleAxis:()=>n(i=>({showAxis:!i.showAxis})),toggleIndirectLight:()=>n(i=>({indirectLightEnabled:!i.indirectLightEnabled})),toggleView2DTheme:()=>n(i=>({view2DTheme:i.view2DTheme==="dark"?"light":"dark"})),toggleAll:()=>n(i=>({showAll:!i.showAll})),setShowDimensions:i=>n({showDimensions:i}),setShowDimensionsText:i=>n({showDimensionsText:i}),setShowGuides:i=>n({showGuides:i}),setShowAxis:i=>n({showAxis:i}),setShowAll:i=>n({showAll:i}),setShowFurniture:i=>n({showFurniture:i}),setRenderMode:i=>n({renderMode:i}),setView2DTheme:i=>n({view2DTheme:i}),openFurniturePopup:i=>n({activePopup:{type:"furniture",id:i}}),openFurnitureEditPopup:i=>{console.log("🔹 openFurnitureEditPopup 호출:",{moduleId:i,현재상태:e().highlightedCompartment}),n({activePopup:{type:"furnitureEdit",id:i},highlightedCompartment:i})},openColumnPopup:i=>n({activePopup:{type:"column",id:i}}),openColumnEditModal:i=>n({activePopup:{type:"columnEdit",id:i},selectedColumnId:i}),openWallPopup:i=>n({activePopup:{type:"wall",id:i}}),openWallEditModal:i=>n({activePopup:{type:"wallEdit",id:i},selectedWallId:i}),openPanelBPopup:i=>n({activePopup:{type:"panelB",id:i}}),openPanelBEditModal:i=>n({activePopup:{type:"panelBEdit",id:i},selectedPanelBId:i}),closeAllPopups:()=>n({activePopup:{type:null,id:null},highlightedCompartment:null}),setHighlightedFrame:i=>n({highlightedFrame:i}),setColumnCreationMode:i=>n({isColumnCreationMode:i}),setSelectedColumnId:i=>n({selectedColumnId:i}),setWallCreationMode:i=>n({isWallCreationMode:i}),setSelectedWallId:i=>n({selectedWallId:i}),setPanelBCreationMode:i=>n({isPanelBCreationMode:i}),setSelectedPanelBId:i=>n({selectedPanelBId:i}),setFurnitureDragging:i=>n({isFurnitureDragging:i}),setIsDraggingColumn:i=>n({isDraggingColumn:i}),setIsSlotDragging:i=>n({isSlotDragging:i}),setHighlightedCompartment:i=>n({highlightedCompartment:i}),setSelectedModuleForPlacement:i=>n({selectedModuleForPlacement:i}),setHoveredSlotForPlacement:i=>n({hoveredSlotForPlacement:i}),setIndirectLightEnabled:i=>n({indirectLightEnabled:i}),setIndirectLightIntensity:i=>n({indirectLightIntensity:i}),setIndirectLightColor:i=>n({indirectLightColor:i}),resetUI:()=>n(bj)}},{name:"ui-store",partialize:n=>({viewMode:n.viewMode,view2DDirection:n.view2DDirection,showDimensions:n.showDimensions})})),Xz=H.createContext(null),Cj=({children:n,viewMode:e})=>{const t=Ua(),{view2DTheme:i}=Wi(),r=H.useMemo(()=>e==="2D"?{theme:{mode:i}}:t,[e,i,t]);return c.jsx(Xz.Provider,{value:r,children:n})},Id=()=>{const n=H.useContext(Xz);return n||Ua()},$le=H.createContext(null),KS={didCatch:!1,error:null};class Vle extends H.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=KS}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){const{error:e}=this.state;if(e!==null){for(var t,i,r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];(t=(i=this.props).onReset)===null||t===void 0||t.call(i,{args:s,reason:"imperative-api"}),this.setState(KS)}}componentDidCatch(e,t){var i,r;(i=(r=this.props).onError)===null||i===void 0||i.call(r,e,t)}componentDidUpdate(e,t){const{didCatch:i}=this.state,{resetKeys:r}=this.props;if(i&&t.error!==null&&Gle(e.resetKeys,r)){var s,o;(s=(o=this.props).onReset)===null||s===void 0||s.call(o,{next:r,prev:e.resetKeys,reason:"keys"}),this.setState(KS)}}render(){const{children:e,fallbackRender:t,FallbackComponent:i,fallback:r}=this.props,{didCatch:s,error:o}=this.state;let a=e;if(s){const l={error:o,resetErrorBoundary:this.resetErrorBoundary};if(typeof t=="function")a=t(l);else if(i)a=H.createElement(i,l);else if(r!==void 0)a=r;else throw o}return H.createElement($le.Provider,{value:{didCatch:s,error:o,resetErrorBoundary:this.resetErrorBoundary}},a)}}function Gle(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return n.length!==e.length||n.some((t,i)=>!Object.is(t,e[i]))}const Yz=.01,Xle={BASE_FOV:50,SMALL_WIDTH_THRESHOLD:1e3,MEDIUM_WIDTH_THRESHOLD:1500,LARGE_WIDTH_THRESHOLD:2e3,SMALL_ADJUSTMENT:5,MEDIUM_ADJUSTMENT:0,LARGE_ADJUSTMENT:-5,XLARGE_ADJUSTMENT:-10},Yle=n=>{const{BASE_FOV:e,SMALL_WIDTH_THRESHOLD:t,MEDIUM_WIDTH_THRESHOLD:i,LARGE_WIDTH_THRESHOLD:r,SMALL_ADJUSTMENT:s,MEDIUM_ADJUSTMENT:o,LARGE_ADJUSTMENT:a,XLARGE_ADJUSTMENT:l}=Xle;return n<=t?e+s:n<=i?e+o:n<=r?e+a:e+l},mc=n=>n*Yz,qS=n=>n/Yz,Th=(n,e,t,i=0)=>{const r=Math.sqrt(n*n+e*e+t*t),s=1.2,a=50*Math.PI/180,h=Math.max(n,e,t)/2/Math.tan(a/2),u=r/2/Math.tan(a/2),d=Math.max(h,u),A=mc(d*s);return Math.max(8,Math.min(150,A))},Kz=n=>[0,mc(n*.5),0],Kle=(n="3D",e=[0,5,10],t,i,r,s)=>{const{spaceInfo:o}=hr(),{placedModules:a}=pi();return H.useMemo(()=>{const h=n==="2D",u=e,d=i||Kz(o.height),A=Yle(o.width),f=Th(o.width,o.height,o.depth||600,a.length),p=s?.5:1,g=1200/f*p,v=window.innerWidth/window.innerHeight;return{position:u,target:d,up:r||[0,1,0],fov:A,is2DMode:h,spaceWidth:o.width,spaceHeight:o.height,viewportLeft:-1,viewportRight:1,viewportTop:1,viewportBottom:-1,canvasAspectRatio:v,zoom:g}},[n,t,o.height,o.width,o.depth,e,i,r,a.length,s])},Bh={NEAR_PLANE:.1,FAR_PLANE:1e3,MIN_DISTANCE:5,MAX_DISTANCE:200,POLAR_ANGLE_MIN:Math.PI/2-Math.PI/18,POLAR_ANGLE_MAX:Math.PI/2+Math.PI/18,AZIMUTH_ANGLE_MIN:-Math.PI/6,AZIMUTH_ANGLE_MAX:Math.PI/6},_j={BACKGROUND_COLOR:"#ffffff"},qle=(n,e="3D",t,i)=>{const r=H.useMemo(()=>{if(!t||!i)return{minDistance:Bh.MIN_DISTANCE,maxDistance:Bh.MAX_DISTANCE};const o=Math.max(t,i),a=f=>f*.01,l=e==="2D",h=l?Bh.MIN_DISTANCE*.5:Bh.MIN_DISTANCE,d=a(o*(l?3:8)),A=Math.max(l?Bh.MAX_DISTANCE*.6:Bh.MAX_DISTANCE,d);return{minDistance:h,maxDistance:A}},[t,i,e]);return H.useMemo(()=>{const o=e==="2D";return{enabled:!0,target:n,minPolarAngle:o?void 0:Bh.POLAR_ANGLE_MIN,maxPolarAngle:o?void 0:Bh.POLAR_ANGLE_MAX,minAzimuthAngle:o?void 0:Bh.AZIMUTH_ANGLE_MIN,maxAzimuthAngle:o?void 0:Bh.AZIMUTH_ANGLE_MAX,enablePan:!0,enableZoom:!0,enableRotate:!o,minDistance:r.minDistance,maxDistance:r.maxDistance,rotateSpeed:.5,enableDamping:!0,dampingFactor:.05,mouseButtons:{LEFT:o?void 0:Zv.ROTATE,MIDDLE:o?Zv.PAN:Zv.ROTATE,RIGHT:Zv.PAN},touches:{ONE:o?jS.PAN:jS.ROTATE,TWO:jS.DOLLY_PAN}}},[n,e,r])},Zle=({minDistance:n,maxDistance:e,viewMode:t,zoomSpeed:i=1})=>{const{camera:r,gl:s,scene:o}=fh(),a=H.useRef(r);return H.useEffect(()=>{a.current=r},[r]),H.useEffect(()=>{if(t!=="2D")return;const l=s.domElement;if(!l)return;const h=u=>{u.preventDefault(),u.stopPropagation();const d=a.current;if(!d||!(d instanceof Gq))return;const A=l.getBoundingClientRect(),f=u.clientX-A.left,p=u.clientY-A.top,g=d.zoom,v=u.deltaY;let w;if(v<0?w=g*1.1:w=g*.9,w=Math.max(.95,w),w!==g){const m=new sd;m.x=f/A.width*2-1,m.y=-(p/A.height*2-1);const y=new lo,x=(d.right-d.left)/g,S=(d.top-d.bottom)/g;y.x=m.x*x/2,y.y=m.y*S/2,d.zoom=w;const I=new lo,j=(d.right-d.left)/w,C=(d.top-d.bottom)/w;I.x=m.x*j/2,I.y=m.y*C/2;const b=y.x-I.x,D=y.y-I.y;d.left+=b,d.right+=b,d.top+=D,d.bottom+=D}else d.zoom=w;d.updateProjectionMatrix(),s.render(o,d)};return l.addEventListener("wheel",h,{passive:!1}),()=>{l.removeEventListener("wheel",h)}},[s,o,n,e,t,i,r]),null},Jle=()=>{const[n,e]=H.useState(()=>({isMobile:window.innerWidth<768,isTablet:window.innerWidth>=768&&window.innerWidth<1024,isDesktop:window.innerWidth>=1024,isPortrait:window.innerHeight>window.innerWidth,isTouchDevice:"ontouchstart"in window||navigator.maxTouchPoints>0,screenWidth:window.innerWidth,screenHeight:window.innerHeight}));return H.useEffect(()=>{const t=()=>{e({isMobile:window.innerWidth<768,isTablet:window.innerWidth>=768&&window.innerWidth<1024,isDesktop:window.innerWidth>=1024,isPortrait:window.innerHeight>window.innerWidth,isTouchDevice:"ontouchstart"in window||navigator.maxTouchPoints>0,screenWidth:window.innerWidth,screenHeight:window.innerHeight})};return window.addEventListener("resize",t),window.addEventListener("orientationchange",t),()=>{window.removeEventListener("resize",t),window.removeEventListener("orientationchange",t)}},[]),n},Sj=n=>{const e=["map","normalMap","bumpMap","displacementMap","specularMap","emissiveMap","metalnessMap","roughnessMap","aoMap","envMap"],t=n;e.forEach(i=>{const r=t[i];r instanceof Xq&&r.dispose()}),n.dispose()},ece=()=>{const{gl:n,scene:e}=fh();return H.useEffect(()=>{const t=n,i=e;return()=>{i.traverse(r=>{r instanceof KU&&(r.geometry&&r.geometry.dispose(),r.material&&(Array.isArray(r.material)?r.material.forEach(s=>{Sj(s)}):Sj(r.material)))});try{t.setRenderTarget(null)}catch{}}},[]),null},tce=({viewMode:n})=>{const{scene:e,gl:t}=fh(),{theme:i}=Id();return H.useEffect(()=>{const r=n==="2D"&&i.mode==="dark"?"#121212":"#ffffff";e.background=new Ms(r),t.setClearColor(new Ms(r),1),console.log("🎨 배경색 업데이트:",{viewMode:n,themeMode:i.mode,backgroundColor:r})},[e,t,n,i.mode]),null},nce=(n,e={})=>{const{camera:t,gl:i}=fh(),{enabled:r=!0,enableRotate:s=!0,enableZoom:o=!0,enablePan:a=!0,trackpadMode:l=!0,sensitivity:h=1,zoomSensitivity:u=1,panSensitivity:d=1,enableKeyboard:A=!0,keyboardSpeed:f=.1}=e;H.useRef(0),H.useRef(1),H.useRef(0);const p=H.useRef(!1),g=H.useRef(!1),v=H.useRef(new Set),w=H.useRef(0),m=H.useRef(!1);return H.useEffect(()=>{(()=>{const x=navigator.platform.toUpperCase().indexOf("MAC")>=0,S="ontouchstart"in window;g.current=x&&S&&!("ontouchend"in window)})()},[]),H.useEffect(()=>{if(!A||!n.current)return;const y=S=>{var j;if(!r||p.current)return;const I=S.key.toLowerCase();if(v.current.add(I),I===" "){S.preventDefault(),(j=n.current)==null||j.reset();return}},x=S=>{const I=S.key.toLowerCase();v.current.delete(I)};return window.addEventListener("keydown",y),window.addEventListener("keyup",x),()=>{window.removeEventListener("keydown",y),window.removeEventListener("keyup",x)}},[A,r,n]),H.useEffect(()=>{if(!A||!n.current)return;const y=()=>{if(!r||p.current||!n.current)return;const S=f;v.current.has("w")&&n.current.pan(0,-S,0),v.current.has("s")&&n.current.pan(0,S,0),v.current.has("a")&&n.current.pan(-S,0,0),v.current.has("d")&&n.current.pan(S,0,0),v.current.has("q")&&n.current.rotateLeft(S*.1),v.current.has("e")&&n.current.rotateLeft(-S*.1),v.current.has("r")&&n.current.rotateUp(S*.1),v.current.has("f")&&n.current.rotateUp(-S*.1),v.current.has("z")&&n.current.dollyIn(1.05),v.current.has("x")&&n.current.dollyOut(1.05),n.current.update(),requestAnimationFrame(y)},x=requestAnimationFrame(y);return()=>{cancelAnimationFrame(x)}},[A,r,f,n]),H.useEffect(()=>{if(!r||!n.current)return;const y=i.domElement;let x=[],S=[];const I=b=>{p.current||(b.preventDefault(),x=Array.from(b.touches),S=x.map(D=>({x:D.clientX,y:D.clientY})),w.current=b.touches.length,console.log("🖐️ 터치 시작:",{touchCount:b.touches.length,positions:S}),b.touches.length===2&&(m.current=!0))},j=b=>{if(p.current||!n.current)return;b.preventDefault();const D=Array.from(b.touches);if(b.touches.length===1&&w.current===1){const T=D[0],k=S[0];if(k){const B=T.clientX-k.x,E=T.clientY-k.y,z=h*.01;n.current.rotateLeft(B*z*Math.PI/180),n.current.rotateUp(E*z*Math.PI/180),n.current.update(),console.log("🔄 한 손가락 회전:",{deltaX:B.toFixed(2),deltaY:E.toFixed(2),rotateSpeed:z.toFixed(4)})}S[0]={x:T.clientX,y:T.clientY}}else if(b.touches.length===2&&w.current===2){const T=D[0],k=D[1],B=S[0],E=S[1];if(B&&E){const z=Math.sqrt(Math.pow(T.clientX-k.clientX,2)+Math.pow(T.clientY-k.clientY,2)),te=Math.sqrt(Math.pow(B.x-E.x,2)+Math.pow(B.y-E.y,2)),L=Math.abs(z-te),J=(z+te)/2*.1;if(L>J){const $=z/te,U=Math.pow($,u);n.current.dollyIn(U),console.log("🔍 두 손가락 줌:",{currentDistance:z.toFixed(2),lastDistance:te.toFixed(2),zoomScale:$.toFixed(3),adjustedZoomScale:U.toFixed(3)})}else{const $=(T.clientX+k.clientX)/2,U=(T.clientY+k.clientY)/2,Y=(B.x+E.x)/2,K=(B.y+E.y)/2,V=$-Y,Q=U-K,X=d*.01;n.current.pan(-V*X,-Q*X,0),console.log("📱 두 손가락 팬:",{deltaX:V.toFixed(2),deltaY:Q.toFixed(2),panSpeed:X.toFixed(4)})}n.current.update()}S[0]={x:T.clientX,y:T.clientY},S[1]={x:k.clientX,y:k.clientY}}},C=b=>{p.current||(b.preventDefault(),console.log("🖐️ 터치 종료:",{remainingTouches:b.touches.length}),w.current=0,m.current=!1,x=[],S=[])};return y.addEventListener("touchstart",I,{passive:!1}),y.addEventListener("touchmove",j,{passive:!1}),y.addEventListener("touchend",C,{passive:!1}),console.log("🎮 터치 컨트롤 활성화됨"),()=>{y.removeEventListener("touchstart",I),y.removeEventListener("touchmove",j),y.removeEventListener("touchend",C),console.log("🎮 터치 컨트롤 비활성화됨")}},[r,h,u,d,n,i.domElement]),H.useEffect(()=>{const y=()=>{p.current=!0},x=()=>{p.current=!1};return window.addEventListener("furniture-drag-start",y),window.addEventListener("furniture-drag-end",x),()=>{window.removeEventListener("furniture-drag-start",y),window.removeEventListener("furniture-drag-end",x)}},[]),n},ice=({controlsRef:n,enabled:e})=>(nce(n,{enabled:e,enableRotate:!0,enableZoom:!0,enablePan:!0}),null),hm=({children:n,cameraPosition:e,cameraTarget:t,cameraUp:i,viewMode:r="3D",view2DDirection:s="front",renderMode:o="wireframe",isSplitView:a=!1})=>{var L,O,J,$;const{theme:l}=Id(),{view2DTheme:h,isFurnitureDragging:u,isDraggingColumn:d,isSlotDragging:A}=Wi(),{spaceInfo:f}=hr(),{isTouchDevice:p,isMobile:g,isTablet:v}=Jle(),w=H.useCallback(()=>r==="2D"?h==="dark"?"#000000":"#ffffff":_j.BACKGROUND_COLOR,[r,h]),[m,y]=H.useState(!1),[x,S]=H.useState(()=>`canvas-${Date.now()}-${Math.random().toString(36).substr(2,9)}`),[I,j]=H.useState(!1),C=H.useRef(null),b=H.useRef(null),D=H.useRef(null),T=H.useRef(null),k=H.useRef({position0:null,target0:null,zoom0:null,position2D:null,target2D:null,zoom2D:null});H.useEffect(()=>{r==="2D"&&(k.current.position2D=null,k.current.target2D=null,k.current.zoom2D=null),S(`canvas-${Date.now()}-${Math.random().toString(36).substr(2,9)}`)},[l,r,s,h]),H.useEffect(()=>{f!=null&&f.droppedCeiling&&(console.log("🔄 ThreeCanvas - 단내림 설정 변경 감지, 캔버스 강제 업데이트"),S(`canvas-${Date.now()}-${Math.random().toString(36).substr(2,9)}`))},[(L=f==null?void 0:f.droppedCeiling)==null?void 0:L.enabled,(O=f==null?void 0:f.droppedCeiling)==null?void 0:O.position,(J=f==null?void 0:f.droppedCeiling)==null?void 0:J.width,($=f==null?void 0:f.droppedCeiling)==null?void 0:$.dropHeight]);const B=Kle(r,e,s,t,i,a),E=qle(B.target,r,B.spaceWidth,B.spaceHeight);H.useEffect(()=>{b.current&&r==="3D"?(b.current.shadowMap.enabled=!0,b.current.shadowMap.needsUpdate=!0):b.current&&r==="2D"&&(b.current.shadowMap.enabled=!1)},[r]),H.useEffect(()=>{if(b.current){const U=w();b.current.setClearColor(new Ms(U),1);const Y=C.current;if(Y){const K=Y.__r3f;K!=null&&K.scene&&(K.scene.background=new Ms(U))}}},[l.mode,r,h,w]);const z=H.useCallback(()=>{if(console.log("Cleaning up WebGL resources..."),b.current){try{b.current.dispose()}catch(U){console.warn("Error disposing renderer:",U)}b.current=null}C.current=null},[]);H.useEffect(()=>(y(!0),()=>{if(y(!1),z(),window.__canvasDragHandlers){const{canvas:U,dragOver:Y,drop:K}=window.__canvasDragHandlers;U&&Y&&K&&(console.log("🧹 Removing canvas drag event handlers"),U.removeEventListener("dragover",Y),U.removeEventListener("drop",K),delete window.__canvasDragHandlers)}}),[z]),H.useEffect(()=>{const U=()=>{if(console.log("🎯 가구/기둥 드래그 시작 - 카메라 회전 비활성화"),T.current){const V=T.current;V.enabled=!1,V.enablePan=!1,V.enableZoom=!1,V.enableRotate=!1,V.update(),console.log("🎯 카메라 컨트롤 비활성화 완료")}},Y=()=>{if(console.log("🎯 가구/기둥 드래그 종료 - OrbitControls 회전 활성화"),T.current){const V=T.current;V.enabled=!0,V.enablePan=!0,V.enableZoom=!0,V.enableRotate=r==="3D",V.update(),console.log("🎯 카메라 컨트롤 재활성화 완료")}},K=()=>{if(console.log("🎯 가구 배치 완료"),T.current){const V=T.current;V.enabled=!0,V.enablePan=!0,V.enableZoom=!0,V.enableRotate=r==="3D",V.update(),console.log("🎯 카메라 컨트롤 재활성화 완료")}};return window.addEventListener("furniture-drag-start",U),window.addEventListener("furniture-drag-end",Y),window.addEventListener("furniture-placement-complete",K),()=>{window.removeEventListener("furniture-drag-start",U),window.removeEventListener("furniture-drag-end",Y),window.removeEventListener("furniture-placement-complete",K)}},[B,e,t,r]);const te=H.useCallback(()=>{if(T.current&&r==="3D"){const U=T.current;if(k.current.position0&&k.current.target0&&k.current.zoom0!==null)console.log("🎯 3D 카메라 저장된 초기 상태로 리셋:",{position:k.current.position0.toArray(),target:k.current.target0.toArray(),zoom:k.current.zoom0}),U.target0.copy(k.current.target0),U.position0.copy(k.current.position0),U.zoom0=k.current.zoom0,U.reset();else{const Y=(f==null?void 0:f.height)||2400,K=50,V=0,Q=Y/200;console.log("🎯 3D 카메라 기본 위치로 리셋:",{centerX:V,centerY:Q,distance:K,spaceHeight:Y}),U.object.position.set(0,Q,K),U.target.set(0,Q,0),U.object.up.set(0,1,0),U.object.lookAt(U.target),U.update(),U.saveState()}console.log("🎯 3D 카메라 리셋 완료")}else if(T.current&&r==="2D"){const U=T.current;if(k.current.position2D&&k.current.target2D&&k.current.zoom2D!==null)console.log("🎯 2D 카메라 저장된 초기 상태로 리셋:",{position:k.current.position2D.toArray(),target:k.current.target2D.toArray(),zoom:k.current.zoom2D}),U.target0.copy(k.current.target2D),U.position0.copy(k.current.position2D),U.zoom0=k.current.zoom2D,U.reset(),console.log("🎯 2D 카메라 초기 상태 리셋 완료");else{const Y=B.position,K=B.target,V=B.up||[0,1,0],Q=B.zoom||1;console.log("🎯 2D 카메라 기본값으로 리셋 (저장된 상태 없음)"),U.object.position.set(...Y),U.target.set(...K),U.object.up.set(...V),U.object.zoom=Q,U.object.updateProjectionMatrix(),U.object.lookAt(U.target),U.update(),U.saveState()}}},[B,e,t,i,r,f]);return H.useEffect(()=>{const U=Y=>{(Y.code==="Space"||Y.keyCode===32)&&(Y.preventDefault(),te())};return window.addEventListener("keydown",U),()=>{window.removeEventListener("keydown",U)}},[te]),H.useEffect(()=>{const U=()=>{console.log("🎯 3D 모드에서 기둥 드래그 시작 - 카메라 리셋"),te()},Y=()=>{console.log("🎯 기둥 드래그 종료")};return window.addEventListener("reset-camera-for-column",U),window.addEventListener("column-drag-end",Y),()=>{window.removeEventListener("reset-camera-for-column",U),window.removeEventListener("column-drag-end",Y)}},[te]),H.useEffect(()=>{if(!D.current||r!=="2D")return;const U=D.current,Y=Q=>{if(Q.button===1){Q.preventDefault();const X=U.querySelector("canvas");X&&(X.style.cursor="grab",console.log("🖱️ 2D 모드: 휠 버튼 누름 - grab 커서"))}},K=Q=>{if(Q.buttons===4){const X=U.querySelector("canvas");X&&(X.style.cursor="grabbing")}},V=Q=>{if(Q.button===1){const X=U.querySelector("canvas");X&&(X.style.cursor="auto",console.log("🖱️ 2D 모드: 휠 버튼 해제 - 기본 커서"))}};return U.addEventListener("mousedown",Y,!0),U.addEventListener("mousemove",K,!0),U.addEventListener("mouseup",V,!0),window.addEventListener("mouseup",V,!0),()=>{U.removeEventListener("mousedown",Y,!0),U.removeEventListener("mousemove",K,!0),U.removeEventListener("mouseup",V,!0),window.removeEventListener("mouseup",V,!0)}},[r]),H.useEffect(()=>{if(!D.current||r!=="2D")return;const U=K=>{if(K.ctrlKey||K.metaKey){K.preventDefault();const V=K.deltaY*.1,Q=new WheelEvent("wheel",{deltaY:V,deltaX:K.deltaX,deltaMode:K.deltaMode,ctrlKey:K.ctrlKey,shiftKey:K.shiftKey,altKey:K.altKey,metaKey:K.metaKey,bubbles:!0,cancelable:!0});if(C.current){const X=C.current.querySelector("canvas");X&&X.dispatchEvent(Q)}return!1}},Y=D.current;return Y.addEventListener("wheel",U,{passive:!1,capture:!0}),()=>{Y.removeEventListener("wheel",U,{capture:!0})}},[r]),H.useEffect(()=>{if(!T.current||r==="3D")return;const U=T.current,Y=200,K=U.object?U.object.position.distanceTo(U.target):10,V=()=>{const Q=U.target;Q.x=Math.max(-Y,Math.min(Y,Q.x)),Q.y=Math.max(-Y,Math.min(Y,Q.y)),Q.z=Math.max(-Y,Math.min(Y,Q.z));const X=U.object;if(X){const W=X.position.distanceTo(Q),se=X.position.clone().sub(Q).normalize(),q=K*2;W>q&&X.position.copy(Q.clone().add(se.multiplyScalar(q)));const de=K*.1;W<de&&X.position.copy(Q.clone().add(se.multiplyScalar(de)))}};return U.addEventListener("change",V),()=>{U&&U.removeEventListener("change",V)}},[r,m]),m?c.jsx(Vle,{fallback:c.jsx("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",background:w()},children:c.jsx("p",{children:"3D viewer error. Please refresh the page."})}),onError:U=>{console.error("Canvas ErrorBoundary caught:",U)},children:c.jsx("div",{ref:D,style:{width:"100%",height:"100%",position:"absolute",top:0,left:0,right:0,bottom:0,touchAction:"none"},children:c.jsxs(XU,{shadows:r==="3D",style:{background:r==="2D"&&l.mode==="dark"?"#121212":r==="2D"?"#ffffff":_j.BACKGROUND_COLOR,cursor:"default",touchAction:"none"},dpr:[1,2],frameloop:"always",gl:{powerPreference:"high-performance",antialias:!0,alpha:!1,stencil:!0,depth:!0,preserveDrawingBuffer:!0,failIfMajorPerformanceCaveat:!1,logarithmicDepthBuffer:!0,precision:"highp"},onCreated:({gl:U,scene:Y})=>{try{console.log("🎨 Canvas 생성 시작:",{canvasKey:x,viewMode:r}),b.current&&b.current!==U&&(console.log("🧹 기존 renderer 정리"),b.current.dispose()),C.current=U.domElement,b.current=U;const K=U.domElement,V=W=>{var q;W.preventDefault(),console.log("🎨 Canvas dragOver 이벤트 감지:",{clientX:W.clientX,clientY:W.clientY,dataTransfer:(q=W.dataTransfer)==null?void 0:q.types});const se=new CustomEvent("canvas-dragover",{detail:{clientX:W.clientX,clientY:W.clientY,originalEvent:W}});window.dispatchEvent(se)},Q=W=>{var Se,fe,M;W.preventDefault(),console.log("🎨 Canvas drop 이벤트 감지:",{clientX:W.clientX,clientY:W.clientY,dataTransfer:(Se=W.dataTransfer)==null?void 0:Se.types,getData:(fe=W.dataTransfer)==null?void 0:fe.getData("application/json")});const se=K.getBoundingClientRect(),q=(W.clientX-se.left)/se.width*2-1,de=window.__currentSpaceInfo;let Ce;if((M=de==null?void 0:de.droppedCeiling)!=null&&M.enabled){const Z=de.width,Ae=de.droppedCeiling.width||800,ie=de.droppedCeiling.position||"right",ee=q*(Z/2);ie==="left"?Ce=ee<-Z/2+Ae?"dropped":"normal":Ce=ee>Z/2-Ae?"dropped":"normal",console.log("🎯 ActiveZone 결정:",{droppedPosition:ie,worldX:ee,totalWidth:Z,droppedWidth:Ae,activeZone:Ce})}if(typeof window.handleSlotDrop=="function"){console.log("🎯 Canvas에서 직접 handleSlotDrop 호출 with activeZone:",Ce);const Z=window.handleSlotDrop(W,K,Ce);if(console.log("🎯 handleSlotDrop 결과:",Z),!Z){console.log("📤 handleSlotDrop이 false 반환, 부모로 이벤트 전파 시도");const Ae=K.closest('[data-viewer-container="true"]');if(Ae){const ie=new DragEvent("drop",{bubbles:!0,cancelable:!0,dataTransfer:W.dataTransfer,clientX:W.clientX,clientY:W.clientY,screenX:W.screenX,screenY:W.screenY});Ae.dispatchEvent(ie)}}}else console.error("❌ window.handleSlotDrop이 정의되지 않음!")};K.addEventListener("dragover",V),K.addEventListener("drop",Q),window.__canvasDragHandlers={canvas:K,dragOver:V,drop:Q},U.setPixelRatio(Math.min(window.devicePixelRatio,2)),U.shadowMap.enabled=r==="3D",r==="3D"&&(U.shadowMap.type=Yq,U.shadowMap.autoUpdate=!0,U.shadowMap.needsUpdate=!0);const X=w();U.setClearColor(new Ms(X),1),Y&&(Y.background=new Ms(X),Y.fog=null),j(!0),console.log("✅ Canvas 생성 완료:",{canvasKey:x,viewMode:r})}catch(K){console.error("❌ Canvas 생성 중 오류:",K),j(!1)}},children:[c.jsxs(H.Suspense,{fallback:null,children:[c.jsx(ece,{}),c.jsx(tce,{viewMode:r})]}),r==="2D"&&c.jsx(Zle,{minDistance:E.minDistance,maxDistance:E.maxDistance,viewMode:r,zoomSpeed:1}),B.is2DMode?c.jsx(Iq,{makeDefault:!0,position:B.position,zoom:B.zoom,near:Bh.NEAR_PLANE,far:Bh.FAR_PLANE,up:B.up||[0,1,0],onUpdate:U=>{B.up&&U.up.set(...B.up),U.lookAt(...B.target)}}):c.jsx(Dq,{makeDefault:!0,position:B.position,fov:B.fov,near:Bh.NEAR_PLANE,far:Bh.FAR_PLANE,onUpdate:U=>U.lookAt(...B.target)}),c.jsx(jq,{ref:U=>{T.current=U,U&&(r==="2D"&&!k.current.position2D?setTimeout(()=>{U&&U.object&&(console.log("📸 2D 모드 초기 상태 저장",{position:U.object.position.toArray(),target:U.target.toArray(),zoom:U.object.zoom}),k.current.position2D=U.object.position.clone(),k.current.target2D=U.target.clone(),k.current.zoom2D=U.object.zoom)},100):r==="3D"&&!k.current.position0&&setTimeout(()=>{U&&U.object&&(console.log("📸 3D 모드 초기 상태 저장",{position:U.object.position.toArray(),target:U.target.toArray(),zoom:U.object.zoom}),k.current.position0=U.object.position.clone(),k.current.target0=U.target.clone(),k.current.zoom0=U.object.zoom)},100))},enabled:E.enabled&&!u&&!d&&!A,target:E.target,minPolarAngle:E.minPolarAngle,maxPolarAngle:E.maxPolarAngle,minAzimuthAngle:E.minAzimuthAngle,maxAzimuthAngle:E.maxAzimuthAngle,enablePan:E.enablePan&&!u&&!d&&!A,enableZoom:E.enableZoom&&!u&&!d&&!A,enableRotate:E.enableRotate&&!u&&!d&&!A,minDistance:E.minDistance,maxDistance:E.maxDistance,mouseButtons:E.mouseButtons,touches:E.touches,panSpeed:.8,rotateSpeed:.3,zoomSpeed:r==="2D"?.15:1.2,enableDamping:!0,dampingFactor:r==="2D"?.1:.04,screenSpacePanning:!0,zoomToCursor:!0,makeDefault:!0}),c.jsx(ice,{controlsRef:T,enabled:!u&&!d&&!A}),n]},x)})}):c.jsx("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",background:w()},children:c.jsx("p",{children:"Loading 3D viewer..."})})},yk=()=>{const{theme:n}=Ua();return{colors:H.useMemo(()=>{const t=i=>getComputedStyle(document.documentElement).getPropertyValue(i).trim()||"";return{primary:t("--theme-primary"),primaryHover:t("--theme-primary-hover"),primaryLight:t("--theme-primary-light"),primaryDark:t("--theme-primary-dark"),background:t("--theme-background"),backgroundSecondary:t("--theme-background-secondary"),surface:t("--theme-surface"),text:t("--theme-text"),textSecondary:t("--theme-text-secondary"),border:t("--theme-border"),error:t("--theme-error"),errorLight:t("--theme-error-light"),warning:t("--theme-warning"),warningLight:t("--theme-warning-light"),success:t("--theme-success"),successLight:t("--theme-success-light"),info:t("--theme-info"),infoLight:t("--theme-info-light")}},[n]),theme:n}},qz={name:"cabinet texture1",rgb:[.12,.12,.12],toneMapped:!1,envMapIntensity:0,emissive:0,roughness:.8},uA=n=>(n==null?void 0:n.toLowerCase().includes(qz.name))??!1,l1=n=>{const e=qz;n.color.setRGB(...e.rgb),n.toneMapped=e.toneMapped,n.envMapIntensity=e.envMapIntensity,n.emissive.setHex(e.emissive),n.roughness=e.roughness,n.needsUpdate=!0},gp=n=>{var a;if(!((a=n.droppedCeiling)!=null&&a.enabled))return null;const{position:e}=n.droppedCeiling,t=n.droppedCeiling.width||ea.WIDTH,i=n.droppedCeiling.dropHeight||200,r=e==="left";let s,o=t;if(n.surroundType==="no-surround"){const{wallConfig:l}=n;r?(s=-(n.width/2),o=t):(s=-(n.width/2)+(n.width-t),o=t)}else r?s=-(n.width/2):s=-(n.width/2)+(n.width-t),o=t;return{startX:s,endX:s+o,width:o,height:n.height-i}},up=n=>{var a,l,h,u,d,A,f,p,g,v;if(!((a=n.droppedCeiling)!=null&&a.enabled)){let w=0,m=0;if(n.surroundType==="no-surround"){const{wallConfig:S}=n;n.installType==="builtin"||n.installType==="built-in"?(w=((l=n.gapConfig)==null?void 0:l.left)||0,m=((h=n.gapConfig)==null?void 0:h.right)||0):n.installType==="semistanding"||n.installType==="semi-standing"?S!=null&&S.left&&!(S!=null&&S.right)?(w=((u=n.gapConfig)==null?void 0:u.left)||0,m=18):!(S!=null&&S.left)&&(S!=null&&S.right)?(w=18,m=((d=n.gapConfig)==null?void 0:d.right)||0):(w=((A=n.gapConfig)==null?void 0:A.left)||0,m=18):(w=18,m=18)}const y=-(n.width/2)+w,x=n.width-w-m;return{startX:y,endX:y+x,width:x,height:n.height}}const{position:t}=n.droppedCeiling,i=n.droppedCeiling.width||ea.WIDTH,r=t==="left";let s,o;if(n.surroundType==="no-surround"){const{wallConfig:w}=n;if(r){s=-(n.width/2)+i;let m=0;n.installType==="builtin"||n.installType==="built-in"?m=((f=n.gapConfig)==null?void 0:f.right)||0:(n.installType==="semistanding"||n.installType==="semi-standing")&&w!=null&&w.right?m=((p=n.gapConfig)==null?void 0:p.right)||0:m=18,o=n.width-i-m}else{let m=0;n.installType==="builtin"||n.installType==="built-in"?m=((g=n.gapConfig)==null?void 0:g.left)||0:(n.installType==="semistanding"||n.installType==="semi-standing")&&w!=null&&w.left?m=((v=n.gapConfig)==null?void 0:v.left)||0:m=18,s=-(n.width/2)+m,o=n.width-i-m}}else r?(s=-(n.width/2)+i,o=n.width-i):(s=-(n.width/2),o=n.width-i);return{startX:s,endX:s+o,width:o,height:n.height}};class Gd{static createCanvas(e=256,t=256){const i=document.createElement("canvas");i.width=e,i.height=t;const r=i.getContext("2d");return{canvas:i,context:r}}static createVerticalGradient(e,t,i){const r=e.createLinearGradient(0,0,0,t);return i.forEach(({position:s,color:o})=>{r.addColorStop(s,o)}),r}static createHorizontalGradient(e,t,i){const r=e.createLinearGradient(0,0,t,0);return i.forEach(({position:s,color:o})=>{r.addColorStop(s,o)}),r}static createWallGradientTexture(){const{canvas:e,context:t}=this.createCanvas(),i=this.createVerticalGradient(t,256,[{position:0,color:"#e0e0e0"},{position:.3,color:"#d8d8d8"},{position:.7,color:"#d0d0d0"},{position:1,color:"#c8c8c8"}]);return t.fillStyle=i,t.fillRect(0,0,256,256),new _h(e)}static createOuterWallGradientTexture(){const{canvas:e,context:t}=this.createCanvas(),i=this.createVerticalGradient(t,256,[{position:0,color:"#f8f8f8"},{position:.3,color:"#f4f4f4"},{position:.7,color:"#f0f0f0"},{position:1,color:"#ececec"}]);return t.fillStyle=i,t.fillRect(0,0,256,256),new _h(e)}static createColumnGradientTexture(){const{canvas:e,context:t}=this.createCanvas(),i=this.createVerticalGradient(t,256,[{position:0,color:"#d8d8d8"},{position:.3,color:"#d0d0d0"},{position:.7,color:"#c8c8c8"},{position:1,color:"#c0c0c0"}]);return t.fillStyle=i,t.fillRect(0,0,256,256),new _h(e)}static createFloorGradientTexture(){const{canvas:e,context:t}=this.createCanvas(),i=this.createHorizontalGradient(t,256,[{position:0,color:"#ffffff"},{position:.2,color:"#ffffff"},{position:.3,color:"#dddddd"},{position:.6,color:"#aaaaaa"},{position:1,color:"#888888"}]);return t.fillStyle=i,t.fillRect(0,0,256,256),new _h(e)}static createDepthBasedWallGradientTexture(){const{canvas:e,context:t}=this.createCanvas(1024,512),i=this.createHorizontalGradient(t,1024,[{position:0,color:"#555555"},{position:.1,color:"#777777"},{position:.25,color:"#999999"},{position:.4,color:"#bbbbbb"},{position:.6,color:"#dddddd"},{position:.8,color:"#eeeeee"},{position:.95,color:"#f8f8f8"},{position:1,color:"#fafafa"}]);return t.fillStyle=i,t.fillRect(0,0,1024,512),new _h(e)}static createDepthTransparencyTexture(){const{canvas:e,context:t}=this.createCanvas(512,256),i=this.createHorizontalGradient(t,512,[{position:0,color:"rgba(100, 100, 100, 1.0)"},{position:.3,color:"rgba(120, 120, 120, 0.8)"},{position:.5,color:"rgba(150, 150, 150, 0.6)"},{position:.7,color:"rgba(180, 180, 180, 0.4)"},{position:.85,color:"rgba(220, 220, 220, 0.2)"},{position:1,color:"rgba(250, 250, 250, 0.0)"}]);return t.fillStyle=i,t.fillRect(0,0,512,256),new _h(e)}static createLeftWallDepthTransparencyTexture(){const{canvas:e,context:t}=this.createCanvas(512,256),i=this.createHorizontalGradient(t,512,[{position:0,color:"#ffffff"},{position:.3,color:"#e0e0e0"},{position:.6,color:"#999999"},{position:.8,color:"#666666"},{position:1,color:"#444444"}]);return t.fillStyle=i,t.fillRect(0,0,512,256),new _h(e)}static createTopWallDepthTransparencyTexture(){const{canvas:e,context:t}=this.createCanvas(512,256),i=this.createVerticalGradient(t,256,[{position:0,color:"#ffffff"},{position:.3,color:"#e0e0e0"},{position:.6,color:"#999999"},{position:.8,color:"#666666"},{position:1,color:"#444444"}]);return t.fillStyle=i,t.fillRect(0,0,512,256),new _h(e)}static createRightWallDepthTransparencyTexture(){const{canvas:e,context:t}=this.createCanvas(512,256),i=this.createHorizontalGradient(t,512,[{position:0,color:"#ffffff"},{position:.3,color:"#e0e0e0"},{position:.6,color:"#999999"},{position:.8,color:"#666666"},{position:1,color:"#444444"}]);return t.fillStyle=i,t.fillRect(0,0,512,256),new _h(e)}static createSideFrameGradientTexture(){const{canvas:e,context:t}=this.createCanvas(),i=this.createVerticalGradient(t,256,[{position:0,color:"#f0f0f0"},{position:.2,color:"#e8e8e8"},{position:.5,color:"#e0e0e0"},{position:.8,color:"#d8d8d8"},{position:1,color:"#d0d0d0"}]);return t.fillStyle=i,t.fillRect(0,0,256,256),new _h(e)}static createFrontToBackGradientTexture(){const{canvas:e,context:t}=this.createCanvas(),i=this.createHorizontalGradient(t,256,[{position:0,color:"#e8e8e8"},{position:.3,color:"#e0e0e0"},{position:.7,color:"#d8d8d8"},{position:1,color:"#d0d0d0"}]);return t.fillStyle=i,t.fillRect(0,0,256,256),new _h(e)}static createHorizontalGradientTexture(){const{canvas:e,context:t}=this.createCanvas(),i=this.createHorizontalGradient(t,256,[{position:0,color:"#f0f0f0"},{position:.25,color:"#e8e8e8"},{position:.5,color:"#e0e0e0"},{position:.75,color:"#d8d8d8"},{position:1,color:"#d0d0d0"}]);return t.fillStyle=i,t.fillRect(0,0,256,256),new _h(e)}static createLeftHorizontalGradientTexture(){const{canvas:e,context:t}=this.createCanvas(),i=this.createHorizontalGradient(t,256,[{position:0,color:"#d0d0d0"},{position:.25,color:"#d8d8d8"},{position:.5,color:"#e0e0e0"},{position:.75,color:"#e8e8e8"},{position:1,color:"#f0f0f0"}]);return t.fillStyle=i,t.fillRect(0,0,256,256),new _h(e)}}class Da{static getCachedMaterial(e,t){return this.materialCache.has(e)||this.materialCache.set(e,t()),this.materialCache.get(e)}static optimizeTexture(e){e.wrapS=qm,e.wrapT=qm,e.magFilter=Kq,e.minFilter=qq,e.generateMipmaps=!0}static createBasicMaterial(e,t={}){return this.optimizeTexture(e),new qU({map:e,transparent:t.transparent||!1,opacity:t.opacity||1,side:t.side||Zq,fog:t.fog!==void 0?t.fog:!1,...t.alphaTest&&{alphaTest:t.alphaTest},...t.emissive&&{emissive:t.emissive}})}static createWallMaterial(e="#e0e0e0"){return this.getCachedMaterial(`wall_${e}`,()=>{const t=Gd.createWallGradientTexture();return new gl({map:t,color:e,roughness:.9,metalness:0,side:Na,envMapIntensity:.3,bumpScale:.02,transparent:!1,opacity:1,polygonOffset:!0,polygonOffsetFactor:2,polygonOffsetUnits:2})})}static createOuterWallMaterial(){return this.getCachedMaterial("outerWall",()=>{const e=Gd.createOuterWallGradientTexture();return new gl({map:e,color:"#f8f8f8",roughness:.85,metalness:0,side:Na,envMapIntensity:.2,transparent:!1,opacity:1,polygonOffset:!0,polygonOffsetFactor:3,polygonOffsetUnits:3})})}static createFloorMaterial(){return this.getCachedMaterial("floor",()=>{const e=Gd.createFloorGradientTexture();return this.createBasicMaterial(e)})}static createDepthBasedWallMaterial(){return this.getCachedMaterial("depthWall",()=>{const e=Gd.createDepthBasedWallGradientTexture();return new gl({map:e,transparent:!0,opacity:.95,side:Na,fog:!1,roughness:.8,metalness:0})})}static createDepthTransparencyMaterial(){return this.getCachedMaterial("depthTransparency",()=>{const e=Gd.createDepthTransparencyTexture();return this.createBasicMaterial(e,{transparent:!0,opacity:1,side:Na,fog:!1,alphaTest:.01,emissive:new Ms(.2,.2,.2)})})}static createDirectionalTransparencyMaterial(e){let t;switch(e){case"left":t=Gd.createLeftWallDepthTransparencyTexture();break;case"top":t=Gd.createTopWallDepthTransparencyTexture();break;case"right":t=Gd.createRightWallDepthTransparencyTexture();break;default:t=Gd.createDepthTransparencyTexture()}return this.optimizeTexture(t),new gl({map:t,transparent:!1,opacity:1,side:Na,fog:!1,roughness:.8,metalness:0})}static createFlatMaterial(e="#ffffff"){return this.getCachedMaterial(`flat-${e}`,()=>new pB({color:new Ms(e),transparent:!1,fog:!1}))}static createEdgeLineMaterial(e="#000000"){return this.getCachedMaterial(`edge-${e}`,()=>new t5({color:new Ms(e),linewidth:1}))}static createSolidFrameMaterial(e="#d0d0d0",t){const i=new Ms(e),r=new gl({color:i,transparent:!1,metalness:0,roughness:.4,envMapIntensity:.6,emissive:i.clone().multiplyScalar(.015),polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1});return t&&new A0().load(t,o=>{o.wrapS=Lu,o.wrapT=Lu,o.repeat.set(1,1),r.map=o,r.needsUpdate=!0}),r}static createSolidWallMaterial(e="#e8e8e8"){return this.getCachedMaterial(`solidWall-${e}`,()=>new gl({color:new Ms(e),roughness:.8,metalness:0,side:Na,transparent:!1,opacity:1}))}static createShaderGradientWallMaterial(e="horizontal"){const t=`
      varying vec2 vUv;
      varying vec3 vPosition;
      
      void main() {
        vUv = uv;
        vPosition = position;
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
      }
    `,i=`
        uniform vec3 colorStart;
        uniform vec3 colorEnd;
        uniform float direction;
        uniform float reverse;
        
        varying vec2 vUv;
        varying vec3 vPosition;
        
        void main() {
          float gradientFactor;
          
          if (direction < 0.5) {
            // 수평 그라데이션 (0.0 = 왼쪽/앞쪽, 1.0 = 오른쪽/뒤쪽)
            gradientFactor = vUv.x;
          } else {
            // 수직 그라데이션 (0.0 = 아래/앞쪽, 1.0 = 위/뒤쪽)
            gradientFactor = vUv.y;
          }
          
          // reverse가 1.0이면 그라데이션 방향 반전
          if (reverse > 0.5) {
            gradientFactor = 1.0 - gradientFactor;
          }
          
          vec3 color = mix(colorStart, colorEnd, gradientFactor);
          gl_FragColor = vec4(color, 1.0);
        }
      `,r=e==="horizontal-reverse"||e==="vertical-reverse",s=e==="vertical"||e==="vertical-reverse"?1:0;return new jI({vertexShader:t,fragmentShader:i,uniforms:{colorStart:{value:new Ms("#ffffff")},colorEnd:{value:new Ms("#c0c0c0")},direction:{value:s},reverse:{value:r?1:0}},side:Na,transparent:!1})}static createCornerShaderMaterial(){const e=`
      varying vec2 vUv;
      varying vec3 vPosition;
      varying vec3 vNormal;
      
      void main() {
        vUv = uv;
        vPosition = position;
        vNormal = normalMatrix * normal;
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
      }
    `,t=`
      uniform vec3 centerColor;
      uniform vec3 edgeColor;
      uniform float intensity;
      
      varying vec2 vUv;
      varying vec3 vPosition;
      varying vec3 vNormal;
      
      void main() {
        // UV 좌표를 이용한 거리 계산 (중앙에서 가장자리로)
        vec2 center = vec2(0.5, 0.5);
        float distanceFromCenter = distance(vUv, center);
        
        // 0.0 (중앙)에서 0.707 (코너)까지의 거리를 0-1로 정규화
        float normalizedDistance = min(distanceFromCenter / 0.707, 1.0);
        
        // 강도 조절
        float gradientFactor = pow(normalizedDistance, intensity);
        
        vec3 color = mix(centerColor, edgeColor, gradientFactor);
        gl_FragColor = vec4(color, 1.0);
      }
    `;return new jI({vertexShader:e,fragmentShader:t,uniforms:{centerColor:{value:new Ms("#ffffff")},edgeColor:{value:new Ms("#dddddd")},intensity:{value:1.5}},side:Na,transparent:!1})}static createEdgeShadowMaterial(){return new pB({color:"#888888",transparent:!0,opacity:.3,side:Na})}static clearCache(){this.materialCache.forEach(e=>{e.dispose()}),this.materialCache.clear()}static getGlobalEdgeLineMaterial(){return this.globalEdgeLineMaterial||(this.globalEdgeLineMaterial=this.createEdgeLineMaterial("#000000")),this.globalEdgeLineMaterial}}Br(Da,"materialCache",new Map),Br(Da,"globalEdgeLineMaterial",null);const cr=()=>{const n=H.useContext(Gz);if(!n)throw new Error("useSpace3DView must be used within a Space3DViewProvider");return n},Tj={internalWidth:0,columnCount:0,columnWidth:0,internalHeight:0,internalDepth:0,columnPositions:[],threeUnitPositions:[],columnBoundaries:[],dualColumnPositions:[],isCalculated:!1,lastCalculatedSpaceInfo:null},v0=w1(n=>({...Tj,recalculateFromSpaceInfo:e=>{try{const t={...e,width:Math.max(600,e.width),height:Math.max(1e3,e.height)},i=Soe(t),r=pr(t),s=Kr(t),o=r.zones?{normal:r.zones.normal?{width:r.zones.normal.width,columnCount:r.zones.normal.columnCount,columnWidth:r.zones.normal.columnWidth}:void 0,dropped:r.zones.dropped?{width:r.zones.dropped.width,columnCount:r.zones.dropped.columnCount,columnWidth:r.zones.dropped.columnWidth}:void 0}:void 0;n({internalWidth:i,columnCount:r.columnCount,columnWidth:r.columnWidth,internalHeight:s.height,internalDepth:s.depth,columnPositions:r.columnPositions,threeUnitPositions:r.threeUnitPositions,columnBoundaries:r.columnBoundaries,dualColumnPositions:r.dualColumnPositions,zones:o,isCalculated:!0,lastCalculatedSpaceInfo:t})}catch(t){console.error("❌ [derivedSpaceStore 계산 오류]",t),console.error("파생 상태 계산 중 오류 발생:",t),n({internalWidth:Math.max(0,e.width-100),columnCount:1,columnWidth:Math.max(400,e.width-100),internalHeight:Math.max(0,e.height-200),internalDepth:580,columnPositions:[0],threeUnitPositions:[0],columnBoundaries:[0,Math.max(400,e.width-100)],dualColumnPositions:[],isCalculated:!0,lastCalculatedSpaceInfo:e})}},reset:()=>{n(Tj)}})),e2=(n,e,t,i,r,s,o)=>{var a,l,h;try{const u=t.getBoundingClientRect(),d=new sd;d.x=(n-u.left)/u.width*2-1,d.y=-((e-u.top)/u.height)*2+1,console.log("🎯 [slotRaycast] Starting raycast detection:",{clientX:n,clientY:e,normalizedMouse:{x:d.x,y:d.y},activeZone:o,droppedCeilingEnabled:(a=s==null?void 0:s.droppedCeiling)==null?void 0:a.enabled});const A=new YA;A.setFromCamera(d,i);const f=[];let p=0,g=0,v=0,w=0;r.traverse(I=>{var j,C,b,D,T,k,B,E,z,te;if(p++,I.userData&&(g++,(I.userData.isSlotCollider||I.userData.type==="slot-collider")&&console.log("🔍 Found slot collider candidate:",{name:I.name,userData:I.userData,type:I.type,visible:I.visible,position:I.position,parent:(j=I.parent)==null?void 0:j.name})),((C=I.userData)==null?void 0:C.type)==="slot-collider"||(b=I.userData)!=null&&b.isSlotCollider){if(((D=I.userData)==null?void 0:D.zone)==="dropped"?v++:((T=I.userData)==null?void 0:T.zone)==="normal"&&w++,o&&((k=I.userData)==null?void 0:k.zone)!==o){console.log("⏭️ Skipping collider due to zone mismatch:",{colliderZone:(B=I.userData)==null?void 0:B.zone,activeZone:o,name:I.name,slotIndex:(E=I.userData)==null?void 0:E.slotIndex});return}f.push(I),console.log("✅ Added collider to list:",{name:I.name,zone:(z=I.userData)==null?void 0:z.zone,slotIndex:(te=I.userData)==null?void 0:te.slotIndex,position:I.position})}}),console.log("🎯 Slot collider search result:",{totalSceneObjects:p,objectsWithUserData:g,slotCollidersFound:f.length,droppedZoneColliders:v,normalZoneColliders:w,activeZone:o,selectedColliders:f.map(I=>{var j,C;return{name:I.name,zone:(j=I.userData)==null?void 0:j.zone,slotIndex:(C=I.userData)==null?void 0:C.slotIndex}})}),console.log("🔍 Attempting raycast with:",{numColliders:f.length,mouse:d,cameraPosition:i.position});const m=A.ray,y=m.origin,x=m.direction;console.log("🎯 Ray details:",{origin:{x:y.x,y:y.y,z:y.z},direction:{x:x.x,y:x.y,z:x.z},cameraPosition:{x:i.position.x,y:i.position.y,z:i.position.z}});const S=A.intersectObjects(f,!1);if(console.log("📊 Raycast results:",{numIntersections:S.length,intersections:S.map(I=>{var j,C;return{object:I.object.name,distance:I.distance,point:I.point,userData:I.object.userData,zone:(j=I.object.userData)==null?void 0:j.zone,slotIndex:(C=I.object.userData)==null?void 0:C.slotIndex}})}),S.length>0){const I=S[0].object,j=(l=I.userData)==null?void 0:l.slotIndex;if(typeof j=="number"&&j>=0)return console.log("🎯 Raycast found slot:",{slotIndex:j,zone:(h=I.userData)==null?void 0:h.zone,activeZone:o,objectName:I.name}),j;console.log("⚠️ Invalid slot index:",{slotIndex:j,userData:I.userData})}else console.log("❌ No intersections found with colliders");return null}catch(u){return console.error("Slot raycast detection error:",u),null}},rce=(n,e,t,i,r,s,o)=>{var a,l;try{const h=t.getBoundingClientRect(),u=new sd((n-h.left)/h.width*2-1,-((e-h.top)/h.height)*2+1),d=new YA;d.setFromCamera(u,i);const A=[];r.traverse(p=>{var g,v,w;(((g=p.userData)==null?void 0:g.type)==="slot-collider"||(v=p.userData)!=null&&v.isSlotCollider)&&(o&&((w=p.userData)==null||w.zone),A.push(p))});const f=d.intersectObjects(A);if(f.length>0){const p=f[0].object,g=(a=p.userData)==null?void 0:a.slotIndex,v=((l=p.userData)==null?void 0:l.zone)||null;if(typeof g=="number"&&g>=0)return{slotIndex:g,zone:v}}return{slotIndex:null,zone:null}}catch(h){return console.error("Slot raycast detection (with zone) error:",h),{slotIndex:null,zone:null}}},sce=(n,e)=>n.includes("dual-"),oce=n=>{const e=Kr(n),t=pr(n),i=r=>r*.01;return{width:i(t.columnWidth)-1,height:i(e.height),depth:i(e.depth)+1}},ace=n=>{var r;const e=s=>s*.01,t=n.hasFloorFinish&&n.floorFinish?n.floorFinish.height:0,i=((r=n.baseConfig)==null?void 0:r.height)||0;if(!n.baseConfig||n.baseConfig.type==="floor")return e(t+i);if(n.baseConfig.type==="stand")if(n.baseConfig.placementType==="float"){const s=n.baseConfig.floatHeight||0;return e(t+s)}else return e(t);else return e(t)},Bj=(n,e,t,i)=>{var o,a;console.log("🎯 [calculateFurniturePosition] 시작:",{slotIndex:n,moduleId:e,surroundType:t.surroundType,installType:t.installType,gapConfig:t.gapConfig,zone:i,timestamp:new Date().toISOString()});const r=pr(t),s=sce(e);if(t.surroundType==="no-surround"&&(t.installType==="builtin"||t.installType==="built-in")&&console.log("🎯 [calculateFurniturePosition] 빌트인+노서라운드 위치 상세:",{slotIndex:n,moduleId:e,isDual:s,indexingType:r.threeUnitPositions?"getThreeUnitPositions":"calculateSpaceIndexing",threeUnitPositions:r.threeUnitPositions,slotWidths:r.slotWidths,selectedPosition:(o=r.threeUnitPositions)==null?void 0:o[n]}),(a=t.droppedCeiling)!=null&&a.enabled&&i&&r.zones){const l=i==="normal"?r.zones.normal:r.zones.dropped;if(!l||!l.threeUnitPositions)return null;if(s&&n<l.threeUnitPositions.length-1){if(l.threeUnitDualPositions&&l.threeUnitDualPositions[n]!==void 0)return l.threeUnitDualPositions[n];{const h=l.threeUnitPositions[n],u=l.threeUnitPositions[n+1];return(h+u)/2}}else return l.threeUnitPositions[n]}if(s){if(r.threeUnitDualPositions&&r.threeUnitDualPositions[n]!==void 0)return r.threeUnitDualPositions[n];if(n<r.threeUnitPositions.length-1){const l=r.threeUnitPositions[n],h=r.threeUnitPositions[n+1];return(l+h)/2}else return console.error("Dual position not available for slot:",n),null}else return r.threeUnitPositions[n]},lce=({spaceInfo:n})=>{const e=pi(C=>C.placedModules);pi(C=>C.moveModule);const t=pi(C=>C.updatePlacedModule),i=pi(C=>C.setFurniturePlacementMode),{setFurnitureDragging:r,activeDroppedCeilingTab:s,viewMode:o,setViewMode:a}=Wi(),[l,h]=H.useState(null),[u,d]=H.useState(0),A=H.useRef(!1),{camera:f,scene:p,gl:g,invalidate:v,controls:w}=fh(),m=Kr(n),y=H.useCallback(()=>{v()},[v]),x=H.useCallback((C,b,D,T,k)=>{console.log("🔍🔍 detectFurnitureCollisions 호출:",{movingModuleId:C,newSlotIndex:b,targetZone:T,treatAsDual:k});const B=e.find(U=>U.id===C);if(!B)return[];const E=Zi(B.moduleId,m,n);if(!E)return[];const z=pr(n),te=z.columnWidth,L=typeof k=="boolean"?k:B.moduleId.includes("dual-")||(B.isDualSlot!==void 0?B.isDualSlot:Math.abs(E.dimensions.width-te*2)<50);let O=[];if(L?(O=[b,b+1],console.log("🔄 듀얼 가구 이동:",{moduleId:B.moduleId,타겟슬롯:O,isDualSlot:B.isDualSlot})):O=[b],D&&D.hasColumn)return console.log("🎯 기둥 슬롯 - 충돌 감지 제외"),[];const J=[];return(T?e.filter(U=>U.zone===T):B.zone?e.filter(U=>U.zone===B.zone):e).forEach(U=>{if(U.id===C)return;const Y=Zi(U.moduleId,m,n);if(!Y)return;const K=U.moduleId.includes("dual-")||(U.isDualSlot!==void 0?U.isDualSlot:Math.abs(Y.dimensions.width-te*2)<50);let V=[],Q=U.slotIndex;if(Q==null){if(!U.position||U.position.x===void 0){console.log("⚠️ 가구 위치 정보 없음, 충돌 검사 스킵:",U.id);return}const W=K&&z.threeUnitDualPositions?Object.values(z.threeUnitDualPositions):z.threeUnitPositions;let se=1/0,q=-1;if(W.forEach((de,Ce)=>{const Se=Math.abs(de-U.position.x);Se<se&&(se=Se,q=Ce)}),se<.1)Q=q,console.log("⚠️ 슬롯 위치 추정:",{moduleId:U.id,estimatedSlot:Q,distance:se});else{const de=Math.floor((U.position.x+m.width*.005)/(z.columnWidth*.01));if(de>=0&&de<z.columnCount)Q=de,console.log("⚠️ 대략적 슬롯 추정:",de);else{console.log("⚠️ 슬롯 추정 실패, 충돌 검사 스킵:",U.id);return}}}if(Q!=null&&Q>=0)K?V=[Q,Q+1]:V=[Q];else{console.log("⚠️ 유효한 슬롯 없음, 충돌 검사 스킵:",U.id);return}if(O.some(W=>V.includes(W))){const W=Zi(B.moduleId,m,n),se=(W==null?void 0:W.category)==="upper"||B.moduleId.includes("upper-cabinet"),q=(W==null?void 0:W.category)==="lower"||B.moduleId.includes("lower-cabinet"),de=Y.category==="upper"||U.moduleId.includes("upper-cabinet"),Ce=Y.category==="lower"||U.moduleId.includes("lower-cabinet");if(console.log("🔍🔍🔍 이동 충돌 검사 상세:",{movingModule:{id:C,moduleId:B.moduleId,category:W==null?void 0:W.category,isUpper:se,isLower:q},existingModule:{id:U.id,moduleId:U.moduleId,category:Y.category,isUpper:de,isLower:Ce}}),se&&Ce||q&&de){console.log("✅✅✅ 상부장/하부장 공존 가능! 충돌 없음:",{moving:{id:C,category:se?"upper":"lower"},existing:{id:U.id,category:de?"upper":"lower"}});return}console.log("💥 충돌 감지:",{이동하는가구:{id:C,isDual:L,targetSlots:O,category:se?"upper":q?"lower":"normal"},기존가구:{id:U.id,isDual:K,occupiedSlots:V,category:de?"upper":Ce?"lower":"normal"}}),J.push(U.id)}}),console.log("🔍🔍 detectFurnitureCollisions 결과:",{충돌개수:J.length,충돌모듈들:J}),J},[e,m,n]),S=(C,b)=>{if(console.log("🖱️ 드래그 시작:",b,"button:",C.button),C.button!==0)return;if(C.stopPropagation(),o==="3D"&&w){const T=f.position.distanceTo(w.target),k=w.target.y;f.position.set(0,k,T),f.lookAt(0,k,0),w.target.set(0,k,0),w.update(),console.log("📐 가구 드래그 시작 - 정면 방향만 조정:",{targetY:k,distance:T,description:"줌 레벨과 높이 유지, 방향만 정면으로"})}h(b),A.current=!0,r(!0),window.dispatchEvent(new CustomEvent("furniture-drag-start")),i(!0),y();const D=C.target;D&&D.setPointerCapture&&D.setPointerCapture(C.pointerId),document.body.style.cursor="grabbing"},I=C=>{var B,E,z,te,L,O,J,$,U,Y,K,V,Q,X,W,se,q,de,Ce,Se,fe,M,Z,Ae,ie;if(!A.current||!l)return;console.log("🖱️ 드래그 중:",l);const b=C.nativeEvent.target,D=e.find(ee=>ee.id===l);if(!D)return;const{slotIndex:T,zone:k}=rce(C.nativeEvent.clientX,C.nativeEvent.clientY,b,f,p);if(T!==null){if((B=n.droppedCeiling)!=null&&B.enabled&&k){const nt=ar.calculateZoneSlotInfo(n,n.customColumnCount),st=D.isDualSlot!==void 0?D.isDualSlot:!1;if(k==="normal"){const At=st?nt.normal.columnCount-1:nt.normal.columnCount;if(T>=At){console.log("❌ 메인구간 가구: 유효하지 않은 슬롯 인덱스",{isDual:st,slotIndex:T,maxSlotForDual:At,columnCount:nt.normal.columnCount});return}}else if(k==="dropped"&&nt.dropped){const At=st?nt.dropped.columnCount-1:nt.dropped.columnCount;if(T>=At){console.log("❌ 단내림구간 가구: 유효하지 않은 슬롯 인덱스",{isDual:st,slotIndex:T,maxSlotForDual:At,columnCount:nt.dropped.columnCount});return}}console.log("✅ 영역별 가구 이동 검증 통과:",{zone:k,slotIndex:T,maxSlots:k==="dropped"?(E=nt.dropped)==null?void 0:E.columnCount:nt.normal.columnCount})}let ee,ae,me,_e=k||void 0;if((z=n.droppedCeiling)!=null&&z.enabled&&k){const nt=ar.calculateZoneSlotInfo(n,n.customColumnCount),st=k==="dropped"&&nt.dropped?nt.dropped:nt.normal,At=((te=n.droppedCeiling)==null?void 0:te.width)||DEFAULT_DROPPED_CEILING_VALUES.WIDTH;let ft;D.zone==="dropped"?ft=At:ft=n.width-At;const Xt={...n,width:ft,zone:D.zone},Yt=Kr(Xt);if(ee=Zi(D.moduleId,Yt,Xt),!ee)return;ae={columnCount:st.columnCount,columnWidth:st.columnWidth,threeUnitPositions:[],threeUnitDualPositions:{},threeUnitBoundaries:[]},me=D.moduleId.includes("dual-")||(D.isDualSlot!==void 0?D.isDualSlot:Math.abs(ee.dimensions.width-st.columnWidth*2)<50);let Zt;if(D.zone==="dropped"&&k==="normal"&&me){const sn=nt.normal.columnCount;T<sn-1?Zt=!0:Zt=!1,typeof Zt=="boolean"&&(me=Zt)}}else{if(ee=Zi(D.moduleId,m,n),!ee)return;ae=pr(n);const nt=ae.columnWidth;me=D.moduleId.includes("dual-")||(D.isDualSlot!==void 0?D.isDualSlot:Math.abs(ee.dimensions.width-nt*2)<50)}let ue;if((L=n.droppedCeiling)!=null&&L.enabled&&D.zone){const nt=ar.calculateZoneSlotInfo(n,n.customColumnCount),st=D.zone==="dropped"&&nt.dropped?nt.dropped:nt.normal,At=pr(n),ft=T;if(k==="dropped"&&((O=At.zones)!=null&&O.dropped)){const Xt=At.zones.dropped.threeUnitPositions;if(me&&ft<Xt.length-1)if(At.zones.dropped.threeUnitDualPositions&&At.zones.dropped.threeUnitDualPositions[ft]!==void 0)ue=At.zones.dropped.threeUnitDualPositions[ft];else{const Yt=Xt[ft],Zt=Xt[ft+1];ue=(Yt+Zt)/2}else ue=Xt[ft];console.log("🎯 단내림 영역 위치 계산:",{zoneSlotIndex:ft,isDual:me,droppedPositions:Xt,finalX:ue})}else if(k==="normal"&&((J=At.zones)!=null&&J.normal)){const Xt=At.zones.normal.threeUnitPositions;if(me&&ft<Xt.length-1)if(At.zones.normal.threeUnitDualPositions&&At.zones.normal.threeUnitDualPositions[ft]!==void 0)ue=At.zones.normal.threeUnitDualPositions[ft];else{const Yt=Xt[ft],Zt=Xt[ft+1];ue=(Yt+Zt)/2}else ue=Xt[ft];console.log("🎯 메인 영역 위치 계산:",{zoneSlotIndex:ft,isDual:me,normalPositions:Xt,finalX:ue})}else{const Xt=st.startX+ft*st.columnWidth+st.columnWidth/2;if(me&&ft<st.columnCount-1){const Yt=st.startX+(ft+1)*st.columnWidth+st.columnWidth/2;ue=(Xt+Yt)/2*.01}else ue=Xt*.01}}else if(me)if(ae.threeUnitDualPositions&&ae.threeUnitDualPositions[T]!==void 0)ue=ae.threeUnitDualPositions[T];else return;else ue=ae.threeUnitPositions[T];let Be=T;if(($=n.droppedCeiling)!=null&&$.enabled&&k){const nt=ar.calculateZoneSlotInfo(n,n.customColumnCount);k==="dropped"&&nt.dropped&&(Be=nt.normal.columnCount+T)}let De=Ih(n)[Be];if(De&&De.hasColumn){if(me){console.log("❌ 듀얼 가구는 기둥 슬롯에 배치 불가");return}const nt=De.adjustedWidth||De.availableWidth;if(nt<150){console.log("❌ 기둥 슬롯에 공간 부족:",nt,"mm");return}}const qe=_e?T:Be;me&&console.log("🎯 듀얼 가구 이동 시도:",{moduleId:D.moduleId,fromSlot:D.slotIndex,toSlot:qe,occupiedSlots:[qe,qe+1],zone:D.zone});let Je=me,Me=x(l,qe,De,_e,Je);if(Me.length>0)if((U=n.droppedCeiling)!=null&&U.enabled&&D.zone==="dropped"&&k==="normal"&&me){console.log("🔁 듀얼 충돌 발생, 싱글로 전환하여 재시도"),Je=!1;const nt=pr(n);if((Y=nt.zones)!=null&&Y.normal){const ft=nt.zones.normal.threeUnitPositions;T<ft.length&&(ue=ft[T])}const At=Ih(n)[T];if(Me=x(l,T,At,"normal",!1),Me.length>0){console.log("❌ 싱글 전환 후에도 충돌. 이동 취소",Me);return}me=!1,_e="normal",De=At}else{console.log("❌ 충돌 감지: 다른 가구가 이미 배치되어 있음",Me);return}let et,He,ze=D.position.y;const Oe=nt=>nt*.01,ke=n.hasFloorFinish&&n.floorFinish?n.floorFinish.height:0,je=((K=n.baseConfig)==null?void 0:K.height)||0;let rt;if(!n.baseConfig||n.baseConfig.type==="floor")rt=Oe(ke+je);else if(n.baseConfig.type==="stand")if(n.baseConfig.placementType==="float"){const nt=n.baseConfig.floatHeight||0;rt=Oe(ke+nt)}else rt=Oe(ke);else rt=0;const _t=ee.category==="upper"||D.moduleId.includes("upper-cabinet")||((V=ee.id)==null?void 0:V.includes("upper-cabinet")),Ee=ee.category==="lower"||D.moduleId.includes("lower-cabinet")||((Q=ee.id)==null?void 0:Q.includes("lower-cabinet"));if(_t){const nt=ee.dimensions.height;let st=m.height;if(k==="dropped"&&((X=n.droppedCeiling)!=null&&X.enabled)){const ft=n.droppedCeiling.dropHeight||200;st=m.height-ft,console.log("🔻 단내림 구간 상부장 높이 계산:",{originalHeight:m.height,dropHeight:ft,effectiveCeilingHeight:st,detectedZone:k})}const At=((W=n.baseConfig)==null?void 0:W.type)==="floor"?((se=n.baseConfig)==null?void 0:se.height)||65:0;ze=Oe(st+At-nt/2),console.log("🔝 드래그 중 상부장 Y 위치 계산:",{moduleId:ee.id,currentModuleId:D.moduleId,category:ee.category,isUpperCabinet:_t,detectedZone:k,effectiveCeilingHeight:st,internalHeightMm:m.height,baseFrameHeightMm:At,furnitureHeightMm:nt,calculatedY:ze,previousY:D.position.y,설명:k==="dropped"?"단내림 구간 - 낮은 천장":"일반 구간 - 정상 천장"})}else{const nt=ee.dimensions.height;if(ze=rt+Oe(nt/2),Ee){const st=((q=n.baseConfig)==null?void 0:q.type)==="stand"&&((de=n.baseConfig)==null?void 0:de.placementType)==="float";console.log("📦 드래그 중 하부장 Y 위치 계산:",{moduleId:ee.id,currentModuleId:D.moduleId,category:ee.category,isLowerCabinet:Ee,isFloatPlacement:st,floatHeight_mm:((Ce=n.baseConfig)==null?void 0:Ce.floatHeight)||0,floorFinishHeightMm:ke,furnitureStartY:rt,furnitureStartY_mm:rt*100,furnitureHeightMm:nt,calculatedY:ze,calculatedY_mm:ze*100,previousY:D.position.y,설명:st?"띄워서 배치 모드":"일반 배치 모드"})}}const Le={x:ue,y:ze,z:D.position.z};if(De&&De.hasColumn&&De.column){const nt=De.column.depth;if(De.intrusionDirection){const st=ae.columnWidth*.01,At={left:ue-st/2,right:ue+st/2,center:ue},ft=Ad(De,At,n);De.intrusionDirection==="from-left"?(Le.x=ft.center,console.log("🔀 왼쪽 침범 - 위치 조정:",{originalX:ue,adjustedX:Le.x,bounds:ft})):De.intrusionDirection==="from-right"?(Le.x=ft.center,console.log("🔁 오른쪽 침범 - 위치 조정:",{originalX:ue,adjustedX:Le.x,bounds:ft})):De.intrusionDirection==="center"&&(Le.x=ft.center,console.log("🟡 중앙 침범 - 위치 조정:",{originalX:ue,adjustedX:Le.x,bounds:ft})),He=ft.renderWidth,(ft.depthAdjustmentNeeded||nt===300&&ft.renderWidth===ae.columnWidth)&&(et=730-nt,console.log("🟣 Column C 깊이 조정:",et,"mm"))}if(nt<=150&&!He){const st=ae.columnWidth*.01,At={left:ue-st/2,right:ue+st/2,center:ue},ft=Ad(De,At,n);He=ft.renderWidth,Le.x=ft.center,et=void 0,console.log("🟢 Column A 처리: 폭 조정만",{adjustedWidth:He,adjustedX:Le.x})}}let ye=D.moduleId;if((Se=n.droppedCeiling)!=null&&Se.enabled&&D.zone==="dropped"&&(k==="normal"||_e==="normal")&&!me){const nt=pr(n),st=((Z=(M=(fe=nt.zones)==null?void 0:fe.normal)==null?void 0:M.slotWidths)==null?void 0:Z[T])||((ie=(Ae=nt.zones)==null?void 0:Ae.normal)==null?void 0:ie.columnWidth)||nt.columnWidth;ye=D.moduleId.replace(/^dual-/,"single-").replace(/-(\d+)$/,`-${st}`)}const Ze=T;t(l,{moduleId:ye,position:Le,customDepth:et,adjustedWidth:He,slotIndex:Ze,isDualSlot:(()=>{var st;const nt=D.moduleId.includes("dual-");return(st=n.droppedCeiling)!=null&&st.enabled&&D.zone==="dropped"&&k==="normal"&&!me&&nt?!1:nt||me})(),zone:k||D.zone,customWidth:(()=>{var st,At,ft,Xt,Yt;if(De&&De.hasColumn)return;if(k&&((st=n.droppedCeiling)!=null&&st.enabled)){const Zt=pr(n);if(k==="dropped"&&((ft=(At=Zt.zones)==null?void 0:At.dropped)!=null&&ft.slotWidths)){const Ye=Zt.zones.dropped.slotWidths;if(me&&Ze<Ye.length-1)return Ye[Ze]+Ye[Ze+1];if(Ye[Ze]!==void 0)return Ye[Ze]}else if(k==="normal"&&((Yt=(Xt=Zt.zones)==null?void 0:Xt.normal)!=null&&Yt.slotWidths)){const Ye=Zt.zones.normal.slotWidths;if(me&&Ze<Ye.length-1)return Ye[Ze]+Ye[Ze+1];if(Ye[Ze]!==void 0)return Ye[Ze]}const sn=ar.calculateZoneSlotInfo(n,n.customColumnCount);return(k==="dropped"&&sn.dropped?sn.dropped:sn.normal).columnWidth}const nt=pr(n);if(nt.slotWidths){if(me&&T<nt.slotWidths.length-1)return nt.slotWidths[T]+nt.slotWidths[T+1];if(nt.slotWidths[T]!==void 0)return nt.slotWidths[T]}return nt.columnWidth})()}),v(),g&&g.shadowMap&&(g.shadowMap.needsUpdate=!0)}},j=()=>{A.current&&(A.current=!1,h(null),i(!1),window.dispatchEvent(new CustomEvent("furniture-drag-end")),y(),setTimeout(()=>{r(!1),y()},100),g&&g.shadowMap&&(g.shadowMap.needsUpdate=!0),document.body.style.cursor="default")};return{draggingModuleId:l,isDragging:A.current,handlePointerDown:S,handlePointerMove:I,handlePointerUp:j,forceRender:u}},cce=()=>{const n=pi(u=>u.editMode),e=pi(u=>u.editingModuleId),t=pi(u=>u.setEditMode),i=pi(u=>u.setEditingModuleId),r=pi(u=>u.removeModule),{openFurnitureEditPopup:s}=Wi(),[o,a]=H.useState(!1),l=H.useRef(!1);return{dragMode:o,setDragMode:a,editMode:n,setEditMode:t,editingModuleId:e,setEditingModuleId:i,handleFurnitureClick:(u,d)=>{console.log("🖱️ handleFurnitureClick 호출:",{placedModuleId:d,isDragging:l.current,dragMode:o}),!l.current&&(u.stopPropagation(),o?(r(d),a(!1)):(console.log("🎯 openFurnitureEditPopup 호출 직전:",d),s(d)))},isDragging:l}},dp=(n,e,t,i,r,s,o)=>{console.log("🔍 isSlotAvailable 시작:",{targetSlot:n,isDualFurniture:e,moduleId:r,총가구수:t.length,placedModules:t.map(A=>({id:A.id,moduleId:A.moduleId,slotIndex:A.slotIndex,position:A.position})),excludeModuleId:s,targetZone:o});const a=pr(i),l=Kr(i);if(n<0||e&&n>=a.columnCount-1||!e&&n>=a.columnCount)return!1;const h=Ih(i),u=e?[n,n+1]:[n];for(const A of u){const f=h[A];if(!f){console.log(`⚠️ 슬롯 ${A}의 정보를 찾을 수 없음 (columnSlots 길이: ${h.length})`);continue}if(f.hasColumn){if(f.columnType==="medium"&&f.allowMultipleFurniture)return e?!(t.filter(g=>g.slotIndex===A&&g.id!==s).length>=2):!(t.filter(g=>g.slotIndex===A&&g.id!==s).length>=2);if(e)return!1}}if(u.some(A=>{const f=h[A];return(f==null?void 0:f.hasColumn)&&(f==null?void 0:f.columnType)==="medium"&&(f==null?void 0:f.allowMultipleFurniture)})){const A=u[0],f=t.filter(p=>p.slotIndex===A&&p.id!==s);return console.log("🔵 Column C 슬롯 가용성 확인:",{slotIndex:A,기존가구수:f.length,isDualFurniture:e,배치가능:f.length<3}),f.length<3}else{if(u.some(A=>{var f;return(f=h[A])==null?void 0:f.hasColumn}))return!0;console.log("🔍 일반 슬롯 충돌 검사 시작:",{targetSlots:u,isDualFurniture:e,moduleId:r,기존가구수:t.length,기존가구정보:t.map(A=>({id:A.id,moduleId:A.moduleId,slotIndex:A.slotIndex,isDualSlot:A.isDualSlot,position:A.position}))});for(const A of t){if(s&&A.id===s)continue;const f=Zi(A.moduleId,l,i);if(!f)continue;const p=Zi(r,l,i),g=(p==null?void 0:p.category)==="upper"||r.includes("upper-cabinet"),v=(p==null?void 0:p.category)==="lower"||r.includes("lower-cabinet"),w=f.category==="upper"||A.moduleId.includes("upper-cabinet"),m=f.category==="lower"||A.moduleId.includes("lower-cabinet"),y=r.includes("single-"),x=A.moduleId.includes("single-");if(y&&x)console.log("🔍 싱글캐비닛끼리 충돌 검사");else if(g&&m||v&&w){console.log("✅ 상부장/하부장 공존 가능 (슬롯 가용성 검사):",{new:{moduleId:r,category:g?"upper":"lower"},existing:{id:A.id,category:w?"upper":"lower"},targetSlots:u});continue}const S=A.moduleId.includes("dual-")||(A.isDualSlot!==void 0?A.isDualSlot:Math.abs(f.dimensions.width-a.columnWidth*2)<50);let I=A.slotIndex;if(I==null){if(!A.position||A.position.x===void 0){console.log("⚠️ 기존 가구의 위치 정보 없음:",A.id);continue}const j=S&&a.threeUnitDualPositions?Object.values(a.threeUnitDualPositions):a.threeUnitPositions;let C=1/0,b=-1;if(j.forEach((D,T)=>{const k=Math.abs(D-A.position.x);k<C&&(C=k,b=T)}),C<.1)I=b;else{console.log("⚠️ 기존 가구의 슬롯 위치를 찾을 수 없음:",{id:A.id,moduleId:A.moduleId,position:A.position,isDual:S,minDistance:C,closestSlot:b});const D=Math.floor((A.position.x+l.width*.005)/(a.columnWidth*.01));if(D>=0&&D<a.columnCount)I=D,console.log("⚠️ 추정 슬롯 사용:",D);else continue}}if(I!=null&&I>=0){const j=S?[I,I+1]:[I];if(u.some(b=>j.includes(b)))return console.log("🚫 슬롯 충돌 감지!",{충돌위치:u.filter(b=>j.includes(b)),타겟슬롯:u,기존가구:{id:A.id,moduleId:A.moduleId,슬롯:I,듀얼:S,차지슬롯:j,isUpper:A.moduleId.includes("upper-cabinet"),isLower:A.moduleId.includes("lower-cabinet")},새가구:{moduleId:r,듀얼:e,타겟슬롯:u,isUpper:r.includes("upper-cabinet"),isLower:r.includes("lower-cabinet")}}),!1}}}return!0},lx=(n,e,t,i,r,s,o,a)=>{const l=pr(r),h=e==="left"?-1:1,u=l.columnCount-(t?1:0),d=h;for(let A=n+d;e==="right"?A<=u:A>=0;A+=d)if(dp(A,t,i,r,s,o,a))return A;return null},ZS=(n,e)=>{const t=pr(e);Kr(e);const i=new Array(t.columnCount).fill("[ ]"),r={};for(let o=0;o<t.columnCount;o++)r[o]={modules:[],isDual:[]};n.forEach((o,a)=>{const l=o.isDualSlot!==void 0?o.isDualSlot:!1,h=o.slotIndex!==void 0?o.slotIndex:-1;if(h>=0){const u=String.fromCharCode(65+a);l?(r[h].modules.push(u),r[h].isDual.push(!0),h+1<t.columnCount&&(r[h+1].modules.push(u),r[h+1].isDual.push(!0)),i[h]=`[${u}`,h+1<t.columnCount&&(i[h+1]=`${u}]`)):(r[h].modules.push(u),r[h].isDual.push(!1),i[h]=`[${u}]`)}});const s=[];Object.entries(r).forEach(([o,a])=>{a.modules.length>1&&s.push(parseInt(o))}),console.log("📊 전체 슬롯 점유 상태:",{총슬롯수:t.columnCount,배치된가구수:n.length,듀얼가구수:n.filter(o=>o.isDualSlot).length,싱글가구수:n.filter(o=>!o.isDualSlot).length,점유맵:i.join(" "),문제슬롯:s,슬롯상세:r}),s.length>0&&console.error("⚠️ 슬롯 충돌 발견!",s.map(o=>({슬롯번호:o,가구들:r[o].modules,듀얼여부:r[o].isDual})))},hce=({spaceInfo:n})=>{const e=pi(f=>f.placedModules),t=pi(f=>f.removeModule),i=pi(f=>f.moveModule),r=pi(f=>f.updatePlacedModule),s=pi(f=>f.editMode),o=pi(f=>f.editingModuleId),a=pi(f=>f.selectedPlacedModuleId),l=pi(f=>f.setEditMode),h=pi(f=>f.setEditingModuleId),{activePopup:u}=Wi(),d=Kr(n),A=pr(n);H.useEffect(()=>{const f=p=>{const g=o||(u.type==="furnitureEdit"?u.id:null);if(s&&o||u.type==="furnitureEdit"&&u.id){const v=e.find(S=>S.id===g);if(!v)return;const w=Zi(v.moduleId,d,n);if(!w)return;const m=A.columnWidth,y=Math.abs(w.dimensions.width-m*2)<50;let x=-1;if(y?A.threeUnitDualPositions&&(x=A.threeUnitDualPositions.findIndex(S=>Math.abs(S-v.position.x)<.1)):x=A.threeUnitPositions.findIndex(S=>Math.abs(S-v.position.x)<.1),x===-1)return;switch(p.key){case"Delete":case"Backspace":s&&o&&(t(g),l(!1),h(null)),p.preventDefault();break;case"ArrowLeft":{console.log("⬅️ 왼쪽 키 이동 시도:",{currentSlotIndex:x,isDualFurniture:y,moduleId:v.moduleId,excludeModuleId:g,zone:v.zone});const S=lx(x,"left",y,e,n,v.moduleId,g,v.zone);if(console.log("🔍 다음 슬롯 찾기 결과:",S),S!==null){let I;y&&A.threeUnitDualPositions?I=A.threeUnitDualPositions[S]:I=A.threeUnitPositions[S];const C=Ih(n)[S];let b;const D={x:I,y:v.position.y,z:v.position.z};let T=v.customDepth;if(C&&C.hasColumn&&C.column){const E=C.column.depth,z=A.columnWidth*.01,te={left:I-z/2,right:I+z/2,center:I},L=Ad(C,te,n);b=L.renderWidth,D.x=L.center,(L.depthAdjustmentNeeded||E===300&&L.renderWidth===A.columnWidth)&&(T=730-E,console.log("🟣 Column C 깊이 조정:",T,"mm")),console.log("⌨️ 키보드 이동 - 기둥 슬롯 크기 조정:",{slotIndex:S,columnDepth:E,originalWidth:w.dimensions.width,adjustedWidth:b,adjustedPosition:D})}const k=(()=>{if(y&&A.slotWidths&&A.slotWidths[S]!==void 0&&S<A.slotWidths.length-1)return A.slotWidths[S]+A.slotWidths[S+1]})(),B={position:D,slotIndex:S,customDepth:T,adjustedWidth:b,zone:v.zone};k!==void 0&&(B.customWidth=k),r(g,B)}p.preventDefault();break}case"ArrowRight":{console.log("➡️ 오른쪽 키 이동 시도:",{currentSlotIndex:x,isDualFurniture:y,moduleId:v.moduleId,excludeModuleId:g,zone:v.zone});const S=lx(x,"right",y,e,n,v.moduleId,g,v.zone);if(console.log("🔍 다음 슬롯 찾기 결과:",S),S!==null){let I;y&&A.threeUnitDualPositions?I=A.threeUnitDualPositions[S]:I=A.threeUnitPositions[S];const C=Ih(n)[S];let b;const D={x:I,y:v.position.y,z:v.position.z};let T=v.customDepth;if(C&&C.hasColumn&&C.column){const E=C.column.depth,z=A.columnWidth*.01,te={left:I-z/2,right:I+z/2,center:I},L=Ad(C,te,n);b=L.renderWidth,D.x=L.center,(L.depthAdjustmentNeeded||E===300&&L.renderWidth===A.columnWidth)&&(T=730-E,console.log("🟣 Column C 깊이 조정:",T,"mm")),console.log("⌨️ 키보드 이동 - 기둥 슬롯 크기 조정:",{slotIndex:S,columnDepth:E,originalWidth:w.dimensions.width,adjustedWidth:b,adjustedPosition:D})}const k=(()=>{if(y&&A.slotWidths&&A.slotWidths[S]!==void 0&&S<A.slotWidths.length-1)return A.slotWidths[S]+A.slotWidths[S+1]})(),B={position:D,slotIndex:S,customDepth:T,adjustedWidth:b,zone:v.zone};k!==void 0&&(B.customWidth=k),r(g,B)}p.preventDefault();break}case"Escape":l(!1),h(null),p.preventDefault();break;case"Enter":l(!1),h(null),p.preventDefault();break}}else if(a){const v=e.find(S=>S.id===a);if(!v)return;const w=Zi(v.moduleId,d,n);if(!w)return;const m=A.columnWidth,y=Math.abs(w.dimensions.width-m*2)<50;let x=-1;switch(y?A.threeUnitDualPositions&&(x=A.threeUnitDualPositions.findIndex(S=>Math.abs(S-v.position.x)<.1)):x=A.threeUnitPositions.findIndex(S=>Math.abs(S-v.position.x)<.1),x===-1&&(x=v.slotIndex||0),p.key){case"Delete":case"Backspace":t(a),p.preventDefault();break;case"ArrowLeft":{const S=lx(x,"left",y,e,n,v.moduleId,a,v.zone);if(S!==null){let I;y&&A.threeUnitDualPositions?I=A.threeUnitDualPositions[S]:I=A.threeUnitPositions[S];const C=Ih(n)[S];let b;const D={x:I,y:v.position.y,z:v.position.z};let T=v.customDepth;if(C&&C.hasColumn&&C.column){const E=C.column.depth,z=A.columnWidth*.01,te={left:I-z/2,right:I+z/2,center:I},L=Ad(C,te,n);b=L.renderWidth,D.x=L.center,(L.depthAdjustmentNeeded||E===300&&L.renderWidth===A.columnWidth)&&(T=730-E,console.log("🟣 Column C 깊이 조정:",T,"mm")),console.log("⌨️ 키보드 이동 - 기둥 슬롯 크기 조정:",{slotIndex:S,columnDepth:E,originalWidth:w.dimensions.width,adjustedWidth:b,adjustedPosition:D})}const k=(()=>{if(y&&A.slotWidths&&A.slotWidths[S]!==void 0&&S<A.slotWidths.length-1)return A.slotWidths[S]+A.slotWidths[S+1]})(),B={position:D,slotIndex:S,customDepth:T,adjustedWidth:b,zone:v.zone};k!==void 0&&(B.customWidth=k),r(a,B)}p.preventDefault();break}case"ArrowRight":{const S=lx(x,"right",y,e,n,v.moduleId,a,v.zone);if(S!==null){let I;y&&A.threeUnitDualPositions?I=A.threeUnitDualPositions[S]:I=A.threeUnitPositions[S];const C=Ih(n)[S];let b;const D={x:I,y:v.position.y,z:v.position.z};let T=v.customDepth;if(C&&C.hasColumn&&C.column){const E=C.column.depth,z=A.columnWidth*.01,te={left:I-z/2,right:I+z/2,center:I},L=Ad(C,te,n);b=L.renderWidth,D.x=L.center,(L.depthAdjustmentNeeded||E===300&&L.renderWidth===A.columnWidth)&&(T=730-E,console.log("🟣 Column C 깊이 조정:",T,"mm")),console.log("⌨️ 키보드 이동 - 기둥 슬롯 크기 조정:",{slotIndex:S,columnDepth:E,originalWidth:w.dimensions.width,adjustedWidth:b,adjustedPosition:D})}const k=(()=>{if(y&&A.slotWidths&&A.slotWidths[S]!==void 0&&S<A.slotWidths.length-1)return A.slotWidths[S]+A.slotWidths[S+1]})(),B={position:D,slotIndex:S,customDepth:T,adjustedWidth:b,zone:v.zone};k!==void 0&&(B.customWidth=k),r(a,B)}p.preventDefault();break}}}};return document.addEventListener("keydown",f),()=>{document.removeEventListener("keydown",f)}},[s,o,a,e,A,t,i,r,d,n,l,h])},uce=9,MA=n=>n*.01,Dd=(n,e={})=>{var J;const{color:t,internalHeight:i,customDepth:r,isDragging:s=!1,isEditMode:o=!1,adjustedWidth:a,slotWidths:l,isHighlighted:h=!1}=e,{spaceInfo:u}=hr(),d=u.materialConfig||{interiorColor:"#FFFFFF",doorColor:"#E0E0E0"},A=n.modelConfig||{basicThickness:18,hasOpenFront:!0,hasShelf:!1,shelfCount:0},f=MA(A.basicThickness||18),p=MA(uce);let g;const v=n.id.includes("dual");a!==void 0&&a>0?(g=a,console.log("🔧🔧🔧 useBaseFurniture - 조정된 너비 사용:",{moduleId:n.id,isDualFurniture:v,원래너비:n.dimensions.width,받은adjustedWidth:a,사용할actualWidthMm:g,차이:n.dimensions.width-g,description:"엔드패널 또는 기둥 조정된 너비","⚠️":"이 값이 실제 렌더링에 사용됨"})):v&&l&&l.length>=2&&a===void 0?(g=l[0]+l[1],console.log("🔧 듀얼 가구 너비 계산 (slotWidths 합산):",{slot1:l[0],slot2:l[1],total:g,note:"adjustedWidth가 없으므로 slotWidths 사용"})):!v&&l&&l.length>0&&a===void 0?(g=l[0],console.log("🔧 싱글 가구 너비 (slotWidth 사용):",g)):g=n.dimensions.width;const w=MA(g),m=MA(i||n.dimensions.height),y=r||n.dimensions.depth,x=MA(y),S=()=>{if(typeof window<"u"){const U=getComputedStyle(document.documentElement).getPropertyValue("--theme-primary").trim();if(U)return U}return"#10b981"};console.log("🔧 useBaseFurniture 폭 결정:",{moduleId:n.id,isDualFurniture:v,originalWidth:n.dimensions.width+"mm",adjustedWidth:a?a+"mm":"undefined",slotWidths:l?l.map($=>$+"mm").join(" + "):"undefined",actualWidthMm:g+"mm",finalWidth:w.toFixed(3)+" (Three.js units)",logic:v&&l?"slotWidths 합산":a!==void 0?"조정된 폭 사용":"원래 폭 사용",isDragging:s,isEditMode:o,호출스택:(J=new Error().stack)==null?void 0:J.split(`
`).slice(1,4).join(" → ")});const I=w-f*2,j=m-f*2,C=x-MA(8),b=MA(4),{renderMode:D,viewMode:T}=cr(),{theme:k}=Ua(),B=s?S():t||(d.interiorColor===d.doorColor?d.doorColor:d.interiorColor);h&&console.log("🌟 useBaseFurniture - 가구 강조 상태:",{moduleId:n.id,isHighlighted:h,isDragging:s,색상:B});const E=H.useMemo(()=>{const $=new gl({color:new Ms("#FFFFFF"),metalness:0,roughness:.6,envMapIntensity:0,emissive:new Ms(0)});return console.log("🎨 useBaseFurniture 재질 생성 (한 번만)"),$},[]);H.useEffect(()=>{E&&(s?(E.color.set(S()),E.map=null,E.emissive.set(new Ms(S())),E.emissiveIntensity=.2):h?(E.emissive.set(new Ms(0)),E.emissiveIntensity=0,E.map||E.color.set(B)):(E.emissive.set(new Ms(0)),E.emissiveIntensity=0,E.map||E.color.set(B)),E.transparent=D==="wireframe"||T==="2D"&&D==="solid"||s||h,E.opacity=D==="wireframe"?.3:T==="2D"&&D==="solid"?.5:s?.6:h?.5:1,E.needsUpdate=!0)},[E,B,D,T,s,o,h]),H.useEffect(()=>{if(s||o){E&&(E.map=null,E.needsUpdate=!0);return}const $=d.interiorTexture;if(console.log("🎨 useBaseFurniture 텍스처 적용 시작:",{textureUrl:$,hasMaterial:!!E,furnitureColor:B,isDragging:s,materialConfig:d,isCabinetTexture1:$?uA($):!1}),$&&E){uA($)&&(console.log("🎨 Cabinet Texture1 즉시 어둡게 적용 중..."),l1(E),console.log("✅ Cabinet Texture1 즉시 색상 적용 완료 (공통 설정 사용):",{color:E.color.getHexString(),toneMapped:E.toneMapped,roughness:E.roughness}),E.needsUpdate=!0);const U=new A0,Y=$.startsWith("http")?$:`${window.location.origin}${$}`;console.log("🔄 텍스처 로딩 시작:",{원본URL:$,전체URL:Y,현재위치:window.location.href}),U.load($,K=>{if(s||o){K.dispose();return}console.log("✅ 텍스처 로딩 성공:",{url:$,image:K.image,size:K.image?`${K.image.width}x${K.image.height}`:"unknown"}),K.wrapS=Lu,K.wrapT=Lu,K.repeat.set(1,1),E.map=K,uA($)||(E.color.setHex(16777215),E.toneMapped=!0,E.roughness=.6),E.needsUpdate=!0,requestAnimationFrame(()=>{var V,Q;E.needsUpdate=!0,console.log("🔄 서랍/선반 텍스처 강제 업데이트 완료:",{hasMap:!!E.map,mapImage:(Q=(V=E.map)==null?void 0:V.image)==null?void 0:Q.src,color:E.color.getHexString(),toneMapped:E.toneMapped,roughness:E.roughness})})},void 0,K=>{console.error("❌ 텍스처 로딩 실패:",$,K)})}else E&&(console.log("🧹 텍스처 제거, 색상만 사용"),E.map&&(E.map.dispose(),E.map=null),E.color.set(B),E.toneMapped=!0,E.roughness=.6,E.needsUpdate=!0)},[d.interiorTexture,E,B,s,o]);const z=t||d.doorColor,te=($,U)=>{switch($.heightType||"percentage"){case"absolute":{const K=MA($.height);return Math.min(K,U)}case"percentage":default:return U*($.height/100)}};return{material:E,doorColor:z,width:w,height:m,depth:x,innerWidth:I,innerHeight:j,actualDepthMm:y,actualWidthMm:g,basicThickness:f,backPanelThickness:p,adjustedDepthForShelves:C,shelfZOffset:b,calculateSectionHeight:te,isMultiSectionFurniture:()=>{const{sections:$}=A;return!!($&&$.length>=2)},getSectionHeights:()=>{const{sections:$}=A;if(!$||$.length===0)return[];const U=m-f*2,K=$.filter(Q=>Q.heightType==="absolute").reduce((Q,X)=>Q+te(X,U),0),V=U-K;return $.map(Q=>Q.heightType==="absolute"?te(Q,U):te(Q,V))},mmToThreeUnits:MA,modelConfig:A}},_i=({args:n,position:e,material:t,renderMode:i="solid",isDragging:r=!1,isEditMode:s=!1,hideEdges:o=!1,isBackPanel:a=!1,isEndPanel:l=!1,onClick:h,onPointerOver:u,onPointerOut:d})=>{const{viewMode:A}=cr(),{view2DDirection:f}=Wi(),{gl:p}=fh(),{theme:g}=Id(),{view2DTheme:v}=Wi(),w=ci.useMemo(()=>new gl({color:"#E0E0E0",roughness:.8,metalness:.1}),[]);ci.useEffect(()=>()=>{t||w.dispose()},[t,w]);const m=t||w,y=ci.useMemo(()=>{if(A==="2D"&&i==="solid"&&m instanceof gl){const S=m.clone();return S.transparent=!0,S.opacity=.1,S.depthWrite=!1,S.needsUpdate=!0,S}if(r&&m instanceof gl){const S=m.clone();S.transparent=!0,S.opacity=.6;const I=()=>{if(typeof window<"u"){const C=getComputedStyle(document.documentElement).getPropertyValue("--theme-primary").trim();if(C)return C}return"#10b981"};return S.color=new Ms(I()),S.needsUpdate=!0,S}return m},[m,r,s,A,i]),x=ci.useMemo(()=>{if(m instanceof gl){const S=m.color;if(Math.abs(S.r-.12)<.01&&Math.abs(S.g-.12)<.01&&Math.abs(S.b-.12)<.01)return"#"+new Ms(.12,.12,.12).getHexString()}return A==="3D"?"#505050":i==="wireframe"?v==="dark"?"#FF4500":"#000000":v==="dark"?"#FF4500":"#444444"},[A,i,v,f,m]);return ci.useEffect(()=>{A==="2D"&&i==="solid"&&console.log("🎨 BoxWithEdges 2D 솔리드 모드:",{edgeColor:x,view2DTheme:v,transparent:A==="3D",opacity:A==="3D"?.9:1,position:e})},[A,i,x,v,e]),c.jsxs("group",{position:e,children:[c.jsxs("mesh",{receiveShadow:A==="3D"&&i==="solid",castShadow:A==="3D"&&i==="solid",onClick:h,onPointerOver:u,onPointerOut:d,children:[c.jsx("boxGeometry",{args:n}),i==="wireframe"?c.jsx("meshBasicMaterial",{transparent:!0,opacity:0}):c.jsx("primitive",{object:y,attach:"material"},y.uuid)]}),!o&&c.jsxs("lineSegments",{children:[c.jsx("edgesGeometry",{args:[new ku(...n)]}),c.jsx("lineBasicMaterial",{color:x,transparent:A==="3D"||a&&A==="2D"&&f==="front",opacity:a&&A==="2D"&&f==="front"?.1:A==="3D"?.9:1,depthTest:A==="3D",depthWrite:!1,polygonOffset:A==="3D",polygonOffsetFactor:A==="3D"?-10:0,polygonOffsetUnits:A==="3D"?-10:0,linewidth:A==="2D"?2:1})]})]})},I1=({width:n,height:e,depth:t,innerWidth:i,innerHeight:r,basicThickness:s,backPanelThickness:o,adjustedDepthForShelves:a,shelfZOffset:l,material:h,isMultiSectionFurniture:u,getSectionHeights:d,mmToThreeUnits:A,isDragging:f=!1,isEditMode:p=!1,isHighlighted:g=!1,hasBackPanel:v=!0,children:w})=>{const{renderMode:m,viewMode:y}=cr(),{gl:x}=fh(),{theme:S}=Ua(),{view2DDirection:I}=Wi();return console.log("🔍🔍🔍 BaseFurnitureShell 실제 렌더링:",{width:n*100+"mm",innerWidth:i*100+"mm",basicThickness:s*100+"mm",계산식:`${n*100} - ${s*100*2} = ${i*100}`,최종가구너비:(i+s*2)*100+"mm",왼쪽패널X:(-i/2-s/2)*100+"mm",오른쪽패널X:(i/2+s/2)*100+"mm","⚠️":"이 값으로 실제 3D 렌더링됨",측면패널_좌:`x: ${(-i/2-s/2)*100}mm`,측면패널_우:`x: ${(i/2+s/2)*100}mm`,전체너비:`${(i/2+s/2-(-i/2-s/2))*100}mm`,isDragging:f,isEditMode:p,renderMode:m,viewMode:y}),c.jsxs("group",{children:[c.jsxs(c.Fragment,{children:[c.jsx(_i,{args:[s,e,t],position:[-i/2-s/2,0,0],material:h,renderMode:m,isDragging:f}),c.jsx(_i,{args:[s,e,t],position:[i/2+s/2,0,0],material:h,renderMode:m,isDragging:f}),u()&&d().length>1&&c.jsx(c.Fragment,{children:d().map((j,C)=>{if(C>=d().length-1)return null;let b=-e/2+s;for(let T=0;T<=C;T++)b+=d()[T];const D=b-s/2;return c.jsx(_i,{args:[i,s,a-s],position:[0,D,s/2+l],material:h,renderMode:m,isDragging:f},`divider-${C}`)})})]}),c.jsx(_i,{args:[i,s,t],position:[0,e/2-s/2,0],material:h,renderMode:m,isDragging:f}),c.jsx(_i,{args:[i,s,t],position:[0,-e/2+s/2,0],material:h,renderMode:m,isDragging:f}),v&&c.jsx(_i,{args:[i+A(10),r+A(10),o],position:[0,0,-t/2+o/2+A(17)],material:h,renderMode:m,isDragging:f,isBackPanel:!0}),w]})},lt=({points:n,color:e="#000000",lineWidth:t=1,dashed:i=!1,dashSize:r=1,gapSize:s=1,opacity:o=1,transparent:a=!1,renderOrder:l=0,depthTest:h=!0})=>{const u=H.useMemo(()=>{const A=new Jq,f=new Float32Array(n.length*3);if(n.forEach((p,g)=>{p instanceof lo?(f[g*3]=p.x,f[g*3+1]=p.y,f[g*3+2]=p.z):Array.isArray(p)&&(f[g*3]=p[0]||0,f[g*3+1]=p[1]||0,f[g*3+2]=p[2]||0)}),A.setAttribute("position",new PI(f,3)),i&&n.length>1){const p=new Float32Array(n.length);p[0]=0;for(let g=1;g<n.length;g++){const v=n[g-1],w=n[g];let m;if(v instanceof lo&&w instanceof lo)m=Math.sqrt(Math.pow(w.x-v.x,2)+Math.pow(w.y-v.y,2)+Math.pow(w.z-v.z,2));else if(Array.isArray(v)&&Array.isArray(w)){const y=v[0]||0,x=v[1]||0,S=v[2]||0,I=w[0]||0,j=w[1]||0,C=w[2]||0;m=Math.sqrt(Math.pow(I-y,2)+Math.pow(j-x,2)+Math.pow(C-S,2))}else m=0;p[g]=p[g-1]+m}A.setAttribute("lineDistance",new PI(p,1))}return A},[n,i]),d=H.useMemo(()=>i?c.jsx("lineDashedMaterial",{color:e,dashSize:r,gapSize:s,opacity:o,transparent:a,depthTest:h}):c.jsx("lineBasicMaterial",{color:e,opacity:o,transparent:a,depthTest:h}),[e,i,r,s,o,a,h]);return c.jsx("line",{geometry:u,renderOrder:l,children:d})},vm=({shelfCount:n,innerWidth:e,innerHeight:t,depth:i,basicThickness:r,material:s,yOffset:o=0,zOffset:a=0,shelfPositions:l,isTopFinishPanel:h,renderMode:u,furnitureId:d,showTopFrameDimension:A=!1})=>{const f=Wi(D=>D.showDimensions),p=Wi(D=>D.view2DDirection),g=Wi(D=>D.view2DTheme),v=Wi(D=>D.highlightedCompartment),w=Wi(D=>D.setHighlightedCompartment),{theme:m}=Id(),{viewMode:y}=cr(),x=D=>D/100,S=()=>getComputedStyle(document.documentElement).getPropertyValue("--theme-primary").trim()||"#10b981",I=y==="3D"?S():g==="dark"?"#ffffff":S(),j=I,C=y==="3D"?.45:.32;if(n<=0)return null;if(h&&n===1){const D=t/2-r/2;return c.jsx("group",{position:[0,o,0],children:c.jsx(_i,{args:[e,r,i-r],position:[0,D,r/2+a],material:s,renderMode:u})})}if(l&&l.length===n)return c.jsxs("group",{position:[0,o,0],children:[l.map((D,T)=>{const k=-t/2+x(D);return c.jsx(_i,{args:[e,r,i-r],position:[0,k,r/2+a],material:s,renderMode:u},`shelf-${T}`)}),f&&!h&&!(y==="2D"&&p==="top")&&c.jsx("group",{children:(()=>{const D=[];let T=!0,k=0;if(l.length>0){const J=l[0]-r/.01/2;if(k=J,l.length===1&&l[0]>t/.01*.9&&k<100&&(T=!1),T){const $=x(J),U=-t/2+$/2;console.log("🔴 절대위치모드 - 첫 번째 칸:",{shelfPositions_0:l[0],basicThickness:r,basicThickness_mm:r*100,firstShelfBottomMm:J,height:$,height_mm:$*100,표시될값:Math.round($*100)}),D.push({height:$,centerY:U})}}for(let J=0;J<l.length-1;J++){const $=l[J]+r/.01/2,Y=l[J+1]-r/.01/2-$,K=x(Y),V=-t/2+x($+Y/2);D.push({height:K,centerY:V})}const B=d&&d.includes("dual-2drawer-styler")&&t>2e3;if(l.length>0&&!(l.length===1&&l[0]>t/.01*.9)&&!B){const $=l[l.length-1]+r/.01/2,Y=t/.01-r/.01*2-$,K=x(Y),V=-t/2+x($+Y/2);D.push({height:K,centerY:V})}const E=[];l.forEach((J,$)=>{const U=-t/2+x(J),Y=U+r/2,K=U-r/2;E.push(c.jsxs("group",{children:[y==="3D"&&c.jsx(ii,{position:[-e/2*.3-.8+.01,U-.01,(d&&d.includes("-right-section")?3.01:i/2+.1)-.01],fontSize:C,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:998,children:Math.round((r>0?r:.18)*100)}),c.jsx(ii,{position:[y==="3D"?-e/2*.3-.8:-e/2*.3-.5,U,y==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r/2+a+.5],fontSize:C,color:I,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,children:Math.round((r>0?r:.18)*100)}),c.jsx(lt,{points:[[-e/2*.3,Y,y==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r/2+a+.5],[-e/2*.3,K,y==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r/2+a+.5]],color:I,lineWidth:1,dashed:!1}),c.jsxs("mesh",{position:[-e/2*.3,Y,y==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r/2+a+.5],children:[c.jsx("sphereGeometry",{args:[.05,8,8]}),c.jsx("meshBasicMaterial",{color:I})]}),c.jsxs("mesh",{position:[-e/2*.3,K,y==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r/2+a+.5],children:[c.jsx("sphereGeometry",{args:[.05,8,8]}),c.jsx("meshBasicMaterial",{color:I})]})]},`shelf-thickness-${$}`))});const te=d&&d.includes("-right-section")?t/2-r/2+r:t/2-r*1.5,L=te+r/2,O=te-r/2;return A&&E.push(c.jsxs("group",{children:[y==="3D"&&c.jsx(ii,{position:[-e/2*.3-.8+.01,te-.01,i/2+.1-.01],fontSize:C,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:998,children:Math.round((r>0?r:.18)*100)}),c.jsx(ii,{position:[y==="3D"?-e/2*.3-.8:-e/2*.3-.5,te,y==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r/2+a+.5],fontSize:C,color:I,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],children:Math.round((r>0?r:.18)*100)}),c.jsx(lt,{points:[[-e/2*.3,L,y==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r/2+a+.5],[-e/2*.3,O,y==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r/2+a+.5]],color:I,lineWidth:1,dashed:!1}),c.jsxs("mesh",{position:[-e/2*.3,L,y==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r/2+a+.5],children:[c.jsx("sphereGeometry",{args:[.05,8,8]}),c.jsx("meshBasicMaterial",{color:I})]}),c.jsxs("mesh",{position:[-e/2*.3,O,y==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r/2+a+.5],children:[c.jsx("sphereGeometry",{args:[.05,8,8]}),c.jsx("meshBasicMaterial",{color:I})]})]},"top-frame-thickness")),T?c.jsxs(c.Fragment,{children:[D.map((J,$)=>{if(d&&d.includes("-right-section")&&D.length>2&&$===D.length-1)return null;let Y,K;if($===0)K=-t/2,Y=-t/2+x(l[0])-r/2;else if($===D.length-1&&l.length>0){const X=l[l.length-1];K=-t/2+x(X)+r/2;const W=t/.01-r/.01*2;Y=-t/2+x(W)}else{const X=l[$-1],W=l[$];K=-t/2+x(X)+r/2,Y=-t/2+x(W)-r/2}const V=d?`${d}-${$}`:null,Q=V&&v===V;return c.jsxs("group",{children:[y==="3D"&&c.jsx(ii,{position:[-e/2*.3-.8+.01,J.centerY-.01,(d&&d.includes("-right-section")?3.01:i/2+.1)-.01],fontSize:C,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:998,children:Math.round(J.height*100)}),c.jsx(ii,{position:[y==="3D"?-e/2*.3-.8:-e/2*.3-.5,J.centerY,y==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r+a+.2],fontSize:C,color:Q?"#FFD700":j,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,onClick:X=>{X.stopPropagation(),V&&w(v===V?null:V)},onPointerOver:X=>{X.stopPropagation(),document.body.style.cursor="pointer"},onPointerOut:X=>{X.stopPropagation(),document.body.style.cursor="auto"},children:Math.round(J.height*100)}),c.jsx(lt,{points:[[-e/2*.3,Y,y==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r+a+.15],[-e/2*.3,K,y==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r+a+.15]],color:Q?"#FFD700":I,lineWidth:Q?2:1,dashed:!1}),c.jsxs("mesh",{position:[-e/2*.3,Y,y==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r+a+.15],children:[c.jsx("sphereGeometry",{args:[.05,8,8]}),c.jsx("meshBasicMaterial",{color:Q?"#FFD700":I})]}),c.jsxs("mesh",{position:[-e/2*.3,K,y==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r+a+.15],children:[c.jsx("sphereGeometry",{args:[.05,8,8]}),c.jsx("meshBasicMaterial",{color:Q?"#FFD700":I})]})]},`dimension-${$}`)}),E]}):null})()})]});const b=t/(n+1);return c.jsxs("group",{position:[0,o,0],children:[Array.from({length:n},(D,T)=>{const k=-t/2+b*(T+1);return c.jsx(_i,{args:[e,r,i-r],position:[0,k,r/2+a],material:s,renderMode:u},`shelf-${T}`)}),f&&!(y==="2D"&&p==="top")&&c.jsx("group",{children:Array.from({length:n+1},(D,T)=>{let k,B,E;if(T===0)B=-t/2,k=-t/2+b-B,E=B+k/2;else if(T===n){const J=-t/2+b*n;B=J,k=t/2-J,E=B+k/2}else{const J=-t/2+b*T,$=-t/2+b*(T+1);B=J,k=$-J,E=B+k/2}const z=Math.round(k*100);console.log("🟢 균등분할모드 - 칸 높이:",{i:T,innerHeight:t,innerHeight_mm:t*100,shelfSpacing:b,shelfSpacing_mm:b*100,compartmentHeight:k,compartmentHeight_mm:k*100,compartmentHeightMm:z,표시될값:z});const te=B+k,L=d?`${d}-${T}`:null,O=L&&v===L;return c.jsxs("group",{children:[y==="3D"&&c.jsx(ii,{position:[-e/2*.3-.8+.01,E-.01,i/2+.1-.01],fontSize:C,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:998,children:z}),c.jsx(ii,{position:[y==="3D"?-e/2*.3-.8:0,E,y==="3D"?i/2+.1:r+a+.2],fontSize:C,color:O?"#FFD700":j,anchorX:"center",anchorY:"middle",rotation:[0,0,y==="3D"?Math.PI/2:-Math.PI/2],onClick:J=>{J.stopPropagation(),L&&w(v===L?null:L)},onPointerOver:J=>{J.stopPropagation(),document.body.style.cursor="pointer"},onPointerOut:J=>{J.stopPropagation(),document.body.style.cursor="auto"},children:z}),c.jsx(lt,{points:[[-e/2*.8,te,r+a+.1],[e/2*.8,te,r+a+.1]],color:O?"#FFD700":I,lineWidth:O?2:1,dashed:!0,dashSize:.02,gapSize:.01}),c.jsx(lt,{points:[[-e/2*.8,B,r+a+.1],[e/2*.8,B,r+a+.1]],color:O?"#FFD700":I,lineWidth:O?2:1,dashed:!0,dashSize:.02,gapSize:.01}),c.jsx(lt,{points:[[0,te,r+a+.15],[0,B,r+a+.15]],color:O?"#FFD700":I,lineWidth:O?2:1})]},`dimension-${T}`)})})]})},wk=({drawerCount:n,innerWidth:e,innerHeight:t,depth:i,basicThickness:r,yOffset:s=0,drawerHeights:o,gapHeight:a=0,material:l,renderMode:h})=>{const u=Wi(x=>x.showDimensions),d=Wi(x=>x.view2DDirection),{viewMode:A}=cr();A==="3D"&&(getComputedStyle(document.documentElement).getPropertyValue("--theme-primary").trim()||"#10b981");const p=A==="3D"?.45:.32;if(n<=0)return null;const g=x=>x*.01,v=g(0),m=g(18),y=(x,S,I,j,C,b=!1)=>{const[D,T,k]=j,B=I-g(47),E=B-m,z=k-m/2;return c.jsxs("group",{children:[c.jsx(_i,{args:[x-g(76)-g(26),g(5),E-g(26)],position:[D,T-S/2+r+g(15)+g(5)/2,z],material:l,renderMode:h}),c.jsx(_i,{args:[x-g(76),S-g(30),r],position:[D,T,z+E/2-r/2],material:l,renderMode:h}),c.jsx(_i,{args:[x-g(76),S-g(30),r],position:[D,T,z-E/2+r/2],material:l,renderMode:h}),c.jsx(_i,{args:[r,S-g(30),E-r*2],position:[D-x/2+r/2+g(38),T,z],material:l,renderMode:h}),c.jsx(_i,{args:[r,S-g(30),E-r*2],position:[D+x/2-r/2-g(38),T,z],material:l,renderMode:h}),c.jsx(_i,{args:[x,S,m],position:[D,T,k+B/2-m/2],material:l,renderMode:h}),u&&!(A==="2D"&&d==="top")&&c.jsxs("group",{children:[b&&A==="2D"&&c.jsx(lt,{points:[[D-g(30),T+S/2+g(a||23.6)-g(30),k+B/2+.1],[D,T+S/2+g(a||23.6),k+B/2+.1],[D+g(30),T+S/2+g(a||23.6)-g(30),k+B/2+.1],[D-g(30),T+S/2+g(a||23.6)-g(30),k+B/2+.1]],color:"#FF0000",lineWidth:1,dashed:!1}),c.jsxs("group",{children:[A==="3D"&&c.jsxs(ii,{position:[D+.01,T-.01,A==="3D"?i/2+.1-.01:k+B/2+.1],fontSize:p,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",renderOrder:998,children:["D",Math.round((B-m)*100)]}),c.jsxs(ii,{position:[D,T,A==="3D"?i/2+.1:k+B/2+.1],fontSize:p,color:"#008B8B",anchorX:"center",anchorY:"middle",renderOrder:999,depthTest:!1,children:["D",Math.round((B-m)*100)]})]})]})]},C)};if(o&&o.length===n&&a>0){let x=-t/2;return x+=g(a),c.jsx("group",{position:[0,s,v],children:o.map((S,I)=>{const j=x+g(S)/2,C=y(e-g(24),g(S)-r/2,i-r,[0,j,r/2],`custom-drawer-${I}`,I===o.length-1);return x+=g(S+a),C})})}else{const x=t/n;return c.jsx("group",{position:[0,s,v],children:Array.from({length:n},(S,I)=>{const j=-t/2+(I+.5)*x;return y(e-g(24),x-r/2,i-r,[0,j,r/2],`drawer-${I}`,I===n-1)})})}},Zh=({modelConfig:n,height:e,innerWidth:t,depth:i,adjustedDepthForShelves:r,basicThickness:s,shelfZOffset:o,material:a,renderMode:l,calculateSectionHeight:h,furnitureId:u})=>{const d=Wi(y=>y.showDimensions),A=Wi(y=>y.view2DDirection),{viewMode:f}=cr(),p=Id(),g=()=>getComputedStyle(document.documentElement).getPropertyValue("--theme-primary").trim()||"#10b981",v=f==="3D"?g():p.theme.mode==="dark"?"#ffffff":g(),w=f==="3D"?.45:.32,m=()=>{const{sections:y}=n;if(!y||y.length===0)return null;const x=e-s*2,I=y.filter(D=>D.heightType==="absolute").reduce((D,T)=>D+h(T,x),0),j=x-I,C=y.map(D=>({...D,calculatedHeight:D.heightType==="absolute"?h(D,x):h(D,j)}));let b=-e/2+s;return C.map((D,T)=>{const k=D.calculatedHeight,B=b+k/2;T===0&&console.log("🔍 첫 번째 섹션 정보:",{index:T,type:D.type,height:k,showDimensions:d,viewMode:f,view2DDirection:A,condition:D.type==="drawer"||D.type==="open"||D.type==="hanging"}),(D.type==="open"||D.type==="drawer")&&console.log(`📏 Section ${T} (${D.type}):`,{calculatedHeight:k,calculatedHeightMm:Math.round(k*100),totalHeight:e,totalHeightMm:Math.round(e*100),availableHeight:e-s*2,availableHeightMm:Math.round((e-s*2)*100)});let E=null;switch(D.type){case"shelf":D.count&&D.count>0&&(E=c.jsx(vm,{shelfCount:D.count,innerWidth:t,innerHeight:k,depth:r,basicThickness:s,material:a,yOffset:B,zOffset:o,shelfPositions:D.shelfPositions,isTopFinishPanel:D.isTopFinishPanel,showTopFrameDimension:T===0,renderMode:l,furnitureId:u}));break;case"hanging":E=c.jsx(vm,{shelfCount:D.shelfPositions?D.shelfPositions.length:0,innerWidth:t,innerHeight:k,depth:r,basicThickness:s,material:a,yOffset:B,zOffset:o,shelfPositions:D.shelfPositions,isTopFinishPanel:D.isTopFinishPanel,showTopFrameDimension:T===0,renderMode:l,furnitureId:u,sectionType:D.type,sectionInternalHeight:D.internalHeight,isLastSection:T===C.length-1});break;case"drawer":D.count&&D.count>0&&(E=c.jsx(wk,{drawerCount:D.count,innerWidth:t,innerHeight:k,depth:i,basicThickness:s,yOffset:B,drawerHeights:D.drawerHeights,gapHeight:D.gapHeight,material:a,renderMode:l}));break}const z=T<C.length-1,te=b+k+s/2-s;return b+=k,c.jsxs("group",{children:[E,d&&!(f==="2D"&&A==="top")&&(D.type==="drawer"||D.type==="hanging"&&(!D.shelfPositions||D.shelfPositions.length===0))&&c.jsx("group",{children:(()=>{let L,O,J;if(D.type==="hanging"||D.type==="drawer"){const U=B-k/2,Y=B+k/2;T===0?L=-e/2+s:(L=U+s,D.type==="hanging"&&(!D.shelfPositions||D.shelfPositions.length===0)&&(L=U)),D.type==="hanging"&&console.log("🔍 Hanging 섹션 치수 계산:",{index:T,sectionType:D.type,hasShelfPositions:!!(D.shelfPositions&&D.shelfPositions.length>0),shelfPositions:D.shelfPositions,sectionBottomY:U,sectionTopY:Y,bottomY:L,basicThickness:s,basicThickness_mm:s*100,height:e,calculatedHeight:D.calculatedHeight,sectionHeight:k}),T===C.length-1?O=e/2-s:O=Y-s,J=(O-L)/.01}else L=B-k/2,O=B+k/2,J=k/.01;const $=(O+L)/2;return c.jsxs(c.Fragment,{children:[f==="3D"&&c.jsx(ii,{position:[-t/2*.3-.8+.01,$-.01,i/2+.1-.01],fontSize:w,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:998,children:Math.round(J)}),c.jsx(ii,{position:[f==="3D"?-t/2*.3-.8:-t/2*.3-.5,$,f==="3D"?i/2+.1:s+.2],fontSize:w,color:v,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,depthTest:!1,children:Math.round(J)}),c.jsx(lt,{points:[[-t/2*.3,O,f==="3D"?i/2+.1:s+.15],[-t/2*.3,L,f==="3D"?i/2+.1:s+.15]],color:v,lineWidth:1,dashed:!1}),c.jsxs("mesh",{position:[-t/2*.3,O,f==="3D"?i/2+.1:s+.15],children:[c.jsx("sphereGeometry",{args:[.05,8,8]}),c.jsx("meshBasicMaterial",{color:v})]}),c.jsxs("mesh",{position:[-t/2*.3,L,f==="3D"?i/2+.1:s+.15],children:[c.jsx("sphereGeometry",{args:[.05,8,8]}),c.jsx("meshBasicMaterial",{color:v})]})]})})()}),d&&!(f==="2D"&&A==="top")&&T===0&&c.jsxs("group",{children:[f==="3D"&&c.jsx(ii,{position:[-t/2*.3-.8+.01,-e/2+s/2-.01,i/2+.1-.01],fontSize:w,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:998,children:Math.round((s>0?s:.18)*100)}),c.jsx(ii,{position:[f==="3D"?-t/2*.3-.8:-t/2*.3-.5,-e/2+s/2,f==="3D"?i/2+.1:s/2+.8],fontSize:w,color:v,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,depthTest:!1,children:Math.round((s>0?s:.18)*100)}),c.jsx(lt,{points:[[-t/2*.3,-e/2,f==="3D"?i/2+.1:s/2+.5],[-t/2*.3,-e/2+s,f==="3D"?i/2+.1:s/2+.5]],color:v,lineWidth:1,dashed:!1}),c.jsxs("mesh",{position:[-t/2*.3,-e/2,f==="3D"?i/2+.1:s/2+.5],children:[c.jsx("sphereGeometry",{args:[.05,8,8]}),c.jsx("meshBasicMaterial",{color:v})]}),c.jsxs("mesh",{position:[-t/2*.3,-e/2+s,f==="3D"?i/2+.1:s/2+.5],children:[c.jsx("sphereGeometry",{args:[.05,8,8]}),c.jsx("meshBasicMaterial",{color:v})]})]}),d&&!(f==="2D"&&A==="top")&&z&&c.jsxs("group",{children:[f==="3D"&&c.jsx(ii,{position:[-t/2*.3-.8+.01,te-.01,i/2+.1-.01],fontSize:w,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:998,children:Math.round((s>0?s:.18)*100)}),c.jsx(ii,{position:[f==="3D"?-t/2*.3-.8:-t/2*.3-.5,te,f==="3D"?i/2+.1:s/2+.5],fontSize:w,color:v,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,depthTest:!1,children:Math.round((s>0?s:.18)*100)}),c.jsx(lt,{points:[[-t/2*.3,te+s/2,f==="3D"?i/2+.1:s/2+.5],[-t/2*.3,te-s/2,f==="3D"?i/2+.1:s/2+.5]],color:v,lineWidth:1,dashed:!1}),c.jsxs("mesh",{position:[-t/2*.3,te+s/2,f==="3D"?i/2+.1:s/2+.5],children:[c.jsx("sphereGeometry",{args:[.05,8,8]}),c.jsx("meshBasicMaterial",{color:v})]}),c.jsxs("mesh",{position:[-t/2*.3,te-s/2,f==="3D"?i/2+.1:s/2+.5],children:[c.jsx("sphereGeometry",{args:[.05,8,8]}),c.jsx("meshBasicMaterial",{color:v})]})]}),d&&!(f==="2D"&&A==="top")&&T===C.length-1&&c.jsxs("group",{children:[f==="3D"&&c.jsx(ii,{position:[-t/2*.3-.8+.01,e/2-s/2-.01,i/2+.1-.01],fontSize:w,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:998,children:Math.round((s>0?s:.18)*100)}),c.jsx(ii,{position:[f==="3D"?-t/2*.3-.8:-t/2*.3-.5,e/2-s/2,f==="3D"?i/2+.1:s/2+.8],fontSize:w,color:v,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,depthTest:!1,children:Math.round((s>0?s:.18)*100)}),c.jsx(lt,{points:[[-t/2*.3,e/2,f==="3D"?i/2+.1:s/2+.5],[-t/2*.3,e/2-s,f==="3D"?i/2+.1:s/2+.5]],color:v,lineWidth:1,dashed:!1}),c.jsxs("mesh",{position:[-t/2*.3,e/2,f==="3D"?i/2+.1:s/2+.5],children:[c.jsx("sphereGeometry",{args:[.05,8,8]}),c.jsx("meshBasicMaterial",{color:v})]}),c.jsxs("mesh",{position:[-t/2*.3,e/2-s,f==="3D"?i/2+.1:s/2+.5],children:[c.jsx("sphereGeometry",{args:[.05,8,8]}),c.jsx("meshBasicMaterial",{color:v})]})]})]},`section-${T}`)})};return c.jsx(c.Fragment,{children:m()})};var vk=vv(),Yr=n=>wv(n,vk),xk=vv();Yr.write=n=>wv(n,xk);var j5=vv();Yr.onStart=n=>wv(n,j5);var bk=vv();Yr.onFrame=n=>wv(n,bk);var Ck=vv();Yr.onFinish=n=>wv(n,Ck);var Rm=[];Yr.setTimeout=(n,e)=>{const t=Yr.now()+e,i=()=>{const s=Rm.findIndex(o=>o.cancel==i);~s&&Rm.splice(s,1),yp-=~s?1:0},r={time:t,handler:n,cancel:i};return Rm.splice(Zz(t),0,r),yp+=1,Jz(),r};var Zz=n=>~(~Rm.findIndex(e=>e.time>n)||~Rm.length);Yr.cancel=n=>{j5.delete(n),bk.delete(n),Ck.delete(n),vk.delete(n),xk.delete(n)};Yr.sync=n=>{ZB=!0,Yr.batchedUpdates(n),ZB=!1};Yr.throttle=n=>{let e;function t(){try{n(...e)}finally{e=null}}function i(...r){e=r,Yr.onStart(t)}return i.handler=n,i.cancel=()=>{j5.delete(t),e=null},i};var _k=typeof window<"u"?window.requestAnimationFrame:(()=>{});Yr.use=n=>_k=n;Yr.now=typeof performance<"u"?()=>performance.now():Date.now;Yr.batchedUpdates=n=>n();Yr.catch=console.error;Yr.frameLoop="always";Yr.advance=()=>{Yr.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):tQ()};var mp=-1,yp=0,ZB=!1;function wv(n,e){ZB?(e.delete(n),n(0)):(e.add(n),Jz())}function Jz(){mp<0&&(mp=0,Yr.frameLoop!=="demand"&&_k(eQ))}function dce(){mp=-1}function eQ(){~mp&&(_k(eQ),Yr.batchedUpdates(tQ))}function tQ(){const n=mp;mp=Yr.now();const e=Zz(mp);if(e&&(nQ(Rm.splice(0,e),t=>t.handler()),yp-=e),!yp){dce();return}j5.flush(),vk.flush(n?Math.min(64,mp-n):16.667),bk.flush(),xk.flush(),Ck.flush()}function vv(){let n=new Set,e=n;return{add(t){yp+=e==n&&!n.has(t)?1:0,n.add(t)},delete(t){return yp-=e==n&&n.has(t)?1:0,n.delete(t)},flush(t){e.size&&(n=new Set,yp-=e.size,nQ(e,i=>i(t)&&n.add(i)),yp+=n.size,e=n)}}}function nQ(n,e){n.forEach(t=>{try{e(t)}catch(i){Yr.catch(i)}})}var Ace=Object.defineProperty,fce=(n,e)=>{for(var t in e)Ace(n,t,{get:e[t],enumerable:!0})},_d={};fce(_d,{assign:()=>gce,colors:()=>Bp,createStringInterpolator:()=>Tk,skipAnimation:()=>rQ,to:()=>iQ,willAdvance:()=>Bk});function JB(){}var pce=(n,e,t)=>Object.defineProperty(n,e,{value:t,writable:!0,configurable:!0}),yi={arr:Array.isArray,obj:n=>!!n&&n.constructor.name==="Object",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",und:n=>n===void 0};function KA(n,e){if(yi.arr(n)){if(!yi.arr(e)||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}return n===e}var ho=(n,e)=>n.forEach(e);function bf(n,e,t){if(yi.arr(n)){for(let i=0;i<n.length;i++)e.call(t,n[i],`${i}`);return}for(const i in n)n.hasOwnProperty(i)&&e.call(t,n[i],i)}var Iu=n=>yi.und(n)?[]:yi.arr(n)?n:[n];function Vy(n,e){if(n.size){const t=Array.from(n);n.clear(),ho(t,e)}}var gy=(n,...e)=>Vy(n,t=>t(...e)),Sk=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),Tk,iQ,Bp=null,rQ=!1,Bk=JB,gce=n=>{n.to&&(iQ=n.to),n.now&&(Yr.now=n.now),n.colors!==void 0&&(Bp=n.colors),n.skipAnimation!=null&&(rQ=n.skipAnimation),n.createStringInterpolator&&(Tk=n.createStringInterpolator),n.requestAnimationFrame&&Yr.use(n.requestAnimationFrame),n.batchedUpdates&&(Yr.batchedUpdates=n.batchedUpdates),n.willAdvance&&(Bk=n.willAdvance),n.frameLoop&&(Yr.frameLoop=n.frameLoop)},Gy=new Set,Tu=[],JS=[],YC=0,P5={get idle(){return!Gy.size&&!Tu.length},start(n){YC>n.priority?(Gy.add(n),Yr.onStart(mce)):(sQ(n),Yr(eE))},advance:eE,sort(n){if(YC)Yr.onFrame(()=>P5.sort(n));else{const e=Tu.indexOf(n);~e&&(Tu.splice(e,1),oQ(n))}},clear(){Tu=[],Gy.clear()}};function mce(){Gy.forEach(sQ),Gy.clear(),Yr(eE)}function sQ(n){Tu.includes(n)||oQ(n)}function oQ(n){Tu.splice(yce(Tu,e=>e.priority>n.priority),0,n)}function eE(n){const e=JS;for(let t=0;t<Tu.length;t++){const i=Tu[t];YC=i.priority,i.idle||(Bk(i),i.advance(n),i.idle||e.push(i))}return YC=0,JS=Tu,JS.length=0,Tu=e,Tu.length>0}function yce(n,e){const t=n.findIndex(e);return t<0?n.length:t}var wce={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},fd="[-+]?\\d*\\.?\\d+",KC=fd+"%";function N5(...n){return"\\(\\s*("+n.join(")\\s*,\\s*(")+")\\s*\\)"}var vce=new RegExp("rgb"+N5(fd,fd,fd)),xce=new RegExp("rgba"+N5(fd,fd,fd,fd)),bce=new RegExp("hsl"+N5(fd,KC,KC)),Cce=new RegExp("hsla"+N5(fd,KC,KC,fd)),_ce=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Sce=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Tce=/^#([0-9a-fA-F]{6})$/,Bce=/^#([0-9a-fA-F]{8})$/;function Ece(n){let e;return typeof n=="number"?n>>>0===n&&n>=0&&n<=4294967295?n:null:(e=Tce.exec(n))?parseInt(e[1]+"ff",16)>>>0:Bp&&Bp[n]!==void 0?Bp[n]:(e=vce.exec(n))?(O0(e[1])<<24|O0(e[2])<<16|O0(e[3])<<8|255)>>>0:(e=xce.exec(n))?(O0(e[1])<<24|O0(e[2])<<16|O0(e[3])<<8|kj(e[4]))>>>0:(e=_ce.exec(n))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+"ff",16)>>>0:(e=Bce.exec(n))?parseInt(e[1],16)>>>0:(e=Sce.exec(n))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+e[4]+e[4],16)>>>0:(e=bce.exec(n))?(Ej(Fj(e[1]),cx(e[2]),cx(e[3]))|255)>>>0:(e=Cce.exec(n))?(Ej(Fj(e[1]),cx(e[2]),cx(e[3]))|kj(e[4]))>>>0:null}function e3(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function Ej(n,e,t){const i=t<.5?t*(1+e):t+e-t*e,r=2*t-i,s=e3(r,i,n+1/3),o=e3(r,i,n),a=e3(r,i,n-1/3);return Math.round(s*255)<<24|Math.round(o*255)<<16|Math.round(a*255)<<8}function O0(n){const e=parseInt(n,10);return e<0?0:e>255?255:e}function Fj(n){return(parseFloat(n)%360+360)%360/360}function kj(n){const e=parseFloat(n);return e<0?0:e>1?255:Math.round(e*255)}function cx(n){const e=parseFloat(n);return e<0?0:e>100?1:e/100}function Ij(n){let e=Ece(n);if(e===null)return n;e=e||0;const t=(e&4278190080)>>>24,i=(e&16711680)>>>16,r=(e&65280)>>>8,s=(e&255)/255;return`rgba(${t}, ${i}, ${r}, ${s})`}var Fw=(n,e,t)=>{if(yi.fun(n))return n;if(yi.arr(n))return Fw({range:n,output:e,extrapolate:t});if(yi.str(n.output[0]))return Tk(n);const i=n,r=i.output,s=i.range||[0,1],o=i.extrapolateLeft||i.extrapolate||"extend",a=i.extrapolateRight||i.extrapolate||"extend",l=i.easing||(h=>h);return h=>{const u=kce(h,s);return Fce(h,s[u],s[u+1],r[u],r[u+1],l,o,a,i.map)}};function Fce(n,e,t,i,r,s,o,a,l){let h=l?l(n):n;if(h<e){if(o==="identity")return h;o==="clamp"&&(h=e)}if(h>t){if(a==="identity")return h;a==="clamp"&&(h=t)}return i===r?i:e===t?n<=e?i:r:(e===-1/0?h=-h:t===1/0?h=h-e:h=(h-e)/(t-e),h=s(h),i===-1/0?h=-h:r===1/0?h=h+i:h=h*(r-i)+i,h)}function kce(n,e){for(var t=1;t<e.length-1&&!(e[t]>=n);++t);return t-1}var Ice={linear:n=>n},kw=Symbol.for("FluidValue.get"),c1=Symbol.for("FluidValue.observers"),qd=n=>!!(n&&n[kw]),Cu=n=>n&&n[kw]?n[kw]():n,Dj=n=>n[c1]||null;function Dce(n,e){n.eventObserved?n.eventObserved(e):n(e)}function qC(n,e){const t=n[c1];t&&t.forEach(i=>{Dce(i,e)})}var jce=class{constructor(n){if(!n&&!(n=this.get))throw Error("Unknown getter");Pce(this,n)}},Pce=(n,e)=>aQ(n,kw,e);function xv(n,e){if(n[kw]){let t=n[c1];t||aQ(n,c1,t=new Set),t.has(e)||(t.add(e),n.observerAdded&&n.observerAdded(t.size,e))}return e}function ZC(n,e){const t=n[c1];if(t&&t.has(e)){const i=t.size-1;i?t.delete(e):n[c1]=null,n.observerRemoved&&n.observerRemoved(i,e)}}var aQ=(n,e,t)=>Object.defineProperty(n,e,{value:t,writable:!0,configurable:!0}),nC=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,Nce=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,jj=new RegExp(`(${nC.source})(%|[a-z]+)`,"i"),Lce=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,L5=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,lQ=n=>{const[e,t]=Mce(n);if(!e||Sk())return n;const i=window.getComputedStyle(document.documentElement).getPropertyValue(e);if(i)return i.trim();if(t&&t.startsWith("--")){const r=window.getComputedStyle(document.documentElement).getPropertyValue(t);return r||n}else{if(t&&L5.test(t))return lQ(t);if(t)return t}return n},Mce=n=>{const e=L5.exec(n);if(!e)return[,];const[,t,i]=e;return[t,i]},t3,Rce=(n,e,t,i,r)=>`rgba(${Math.round(e)}, ${Math.round(t)}, ${Math.round(i)}, ${r})`,cQ=n=>{t3||(t3=Bp?new RegExp(`(${Object.keys(Bp).join("|")})(?!\\w)`,"g"):/^\b$/);const e=n.output.map(s=>Cu(s).replace(L5,lQ).replace(Nce,Ij).replace(t3,Ij)),t=e.map(s=>s.match(nC).map(Number)),r=t[0].map((s,o)=>t.map(a=>{if(!(o in a))throw Error('The arity of each "output" value must be equal');return a[o]})).map(s=>Fw({...n,output:s}));return s=>{var l;const o=!jj.test(e[0])&&((l=e.find(h=>jj.test(h)))==null?void 0:l.replace(nC,""));let a=0;return e[0].replace(nC,()=>`${r[a++](s)}${o||""}`).replace(Lce,Rce)}},Ek="react-spring: ",hQ=n=>{const e=n;let t=!1;if(typeof e!="function")throw new TypeError(`${Ek}once requires a function parameter`);return(...i)=>{t||(e(...i),t=!0)}},Uce=hQ(console.warn);function Oce(){Uce(`${Ek}The "interpolate" function is deprecated in v9 (use "to" instead)`)}var Hce=hQ(console.warn);function Wce(){Hce(`${Ek}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`)}function M5(n){return yi.str(n)&&(n[0]=="#"||/\d/.test(n)||!Sk()&&L5.test(n)||n in(Bp||{}))}var Fk=Sk()?H.useEffect:H.useLayoutEffect,zce=()=>{const n=H.useRef(!1);return Fk(()=>(n.current=!0,()=>{n.current=!1}),[]),n};function uQ(){const n=H.useState()[1],e=zce();return()=>{e.current&&n(Math.random())}}var dQ=n=>H.useEffect(n,Qce),Qce=[];function Pj(n){const e=H.useRef(void 0);return H.useEffect(()=>{e.current=n}),e.current}var Iw=Symbol.for("Animated:node"),$ce=n=>!!n&&n[Iw]===n,Kd=n=>n&&n[Iw],kk=(n,e)=>pce(n,Iw,e),R5=n=>n&&n[Iw]&&n[Iw].getPayload(),AQ=class{constructor(){kk(this,this)}getPayload(){return this.payload||[]}},U5=class fQ extends AQ{constructor(e){super(),this._value=e,this.done=!0,this.durationProgress=0,yi.num(this._value)&&(this.lastPosition=this._value)}static create(e){return new fQ(e)}getPayload(){return[this]}getValue(){return this._value}setValue(e,t){return yi.num(e)&&(this.lastPosition=e,t&&(e=Math.round(e/t)*t,this.done&&(this.lastPosition=e))),this._value===e?!1:(this._value=e,!0)}reset(){const{done:e}=this;this.done=!1,yi.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,e&&(this.lastVelocity=null),this.v0=null)}},JC=class pQ extends U5{constructor(e){super(0),this._string=null,this._toString=Fw({output:[e,e]})}static create(e){return new pQ(e)}getValue(){const e=this._string;return e??(this._string=this._toString(this._value))}setValue(e){if(yi.str(e)){if(e==this._string)return!1;this._string=e,this._value=1}else if(super.setValue(e))this._string=null;else return!1;return!0}reset(e){e&&(this._toString=Fw({output:[this.getValue(),e]})),this._value=0,super.reset()}},e_={dependencies:null},Ik=class extends AQ{constructor(n){super(),this.source=n,this.setValue(n)}getValue(n){const e={};return bf(this.source,(t,i)=>{$ce(t)?e[i]=t.getValue(n):qd(t)?e[i]=Cu(t):n||(e[i]=t)}),e}setValue(n){this.source=n,this.payload=this._makePayload(n)}reset(){this.payload&&ho(this.payload,n=>n.reset())}_makePayload(n){if(n){const e=new Set;return bf(n,this._addToPayload,e),Array.from(e)}}_addToPayload(n){e_.dependencies&&qd(n)&&e_.dependencies.add(n);const e=R5(n);e&&ho(e,t=>this.add(t))}},Vce=class gQ extends Ik{constructor(e){super(e)}static create(e){return new gQ(e)}getValue(){return this.source.map(e=>e.getValue())}setValue(e){const t=this.getPayload();return e.length==t.length?t.map((i,r)=>i.setValue(e[r])).some(Boolean):(super.setValue(e.map(Gce)),!0)}};function Gce(n){return(M5(n)?JC:U5).create(n)}function tE(n){const e=Kd(n);return e?e.constructor:yi.arr(n)?Vce:M5(n)?JC:U5}var Nj=(n,e)=>{const t=!yi.fun(n)||n.prototype&&n.prototype.isReactComponent;return H.forwardRef((i,r)=>{const s=H.useRef(null),o=t&&H.useCallback(p=>{s.current=Kce(r,p)},[r]),[a,l]=Yce(i,e),h=uQ(),u=()=>{const p=s.current;if(t&&!p)return;(p?e.applyAnimatedValues(p,a.getValue(!0)):!1)===!1&&h()},d=new Xce(u,l),A=H.useRef(void 0);Fk(()=>(A.current=d,ho(l,p=>xv(p,d)),()=>{A.current&&(ho(A.current.deps,p=>ZC(p,A.current)),Yr.cancel(A.current.update))})),H.useEffect(u,[]),dQ(()=>()=>{const p=A.current;ho(p.deps,g=>ZC(g,p))});const f=e.getComponentProps(a.getValue());return H.createElement(n,{...f,ref:o})})},Xce=class{constructor(n,e){this.update=n,this.deps=e}eventObserved(n){n.type=="change"&&Yr.write(this.update)}};function Yce(n,e){const t=new Set;return e_.dependencies=t,n.style&&(n={...n,style:e.createAnimatedStyle(n.style)}),n=new Ik(n),e_.dependencies=null,[n,t]}function Kce(n,e){return n&&(yi.fun(n)?n(e):n.current=e),e}var Lj=Symbol.for("AnimatedComponent"),qce=(n,{applyAnimatedValues:e=()=>!1,createAnimatedStyle:t=r=>new Ik(r),getComponentProps:i=r=>r}={})=>{const r={applyAnimatedValues:e,createAnimatedStyle:t,getComponentProps:i},s=o=>{const a=Mj(o)||"Anonymous";return yi.str(o)?o=s[o]||(s[o]=Nj(o,r)):o=o[Lj]||(o[Lj]=Nj(o,r)),o.displayName=`Animated(${a})`,o};return bf(n,(o,a)=>{yi.arr(n)&&(a=Mj(o)),s[a]=s(o)}),{animated:s}},Mj=n=>yi.str(n)?n:n&&yi.str(n.displayName)?n.displayName:yi.fun(n)&&n.name||null;function Bg(n,...e){return yi.fun(n)?n(...e):n}var Xy=(n,e)=>n===!0||!!(e&&n&&(yi.fun(n)?n(e):Iu(n).includes(e))),mQ=(n,e)=>yi.obj(n)?e&&n[e]:n,yQ=(n,e)=>n.default===!0?n[e]:n.default?n.default[e]:void 0,Zce=n=>n,Dk=(n,e=Zce)=>{let t=Jce;n.default&&n.default!==!0&&(n=n.default,t=Object.keys(n));const i={};for(const r of t){const s=e(n[r],r);yi.und(s)||(i[r]=s)}return i},Jce=["config","onProps","onStart","onChange","onPause","onResume","onRest"],ehe={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function the(n){const e={};let t=0;if(bf(n,(i,r)=>{ehe[r]||(e[r]=i,t++)}),t)return e}function wQ(n){const e=the(n);if(e){const t={to:e};return bf(n,(i,r)=>r in e||(t[r]=i)),t}return{...n}}function Dw(n){return n=Cu(n),yi.arr(n)?n.map(Dw):M5(n)?_d.createStringInterpolator({range:[0,1],output:[n,n]})(1):n}function nhe(n){for(const e in n)return!0;return!1}function nE(n){return yi.fun(n)||yi.arr(n)&&yi.obj(n[0])}function ihe(n,e){var t;(t=n.ref)==null||t.delete(n),e==null||e.delete(n)}function rhe(n,e){var t;e&&n.ref!==e&&((t=n.ref)==null||t.delete(n),e.add(n),n.ref=e)}var she={default:{tension:170,friction:26}},iE={...she.default,mass:1,damping:1,easing:Ice.linear,clamp:!1},ohe=class{constructor(){this.velocity=0,Object.assign(this,iE)}};function ahe(n,e,t){t&&(t={...t},Rj(t,e),e={...t,...e}),Rj(n,e),Object.assign(n,e);for(const o in iE)n[o]==null&&(n[o]=iE[o]);let{frequency:i,damping:r}=n;const{mass:s}=n;return yi.und(i)||(i<.01&&(i=.01),r<0&&(r=0),n.tension=Math.pow(2*Math.PI/i,2)*s,n.friction=4*Math.PI*r*s/i),n}function Rj(n,e){if(!yi.und(e.decay))n.duration=void 0;else{const t=!yi.und(e.tension)||!yi.und(e.friction);(t||!yi.und(e.frequency)||!yi.und(e.damping)||!yi.und(e.mass))&&(n.duration=void 0,n.decay=void 0),t&&(n.frequency=void 0)}}var Uj=[],lhe=class{constructor(){this.changed=!1,this.values=Uj,this.toValues=null,this.fromValues=Uj,this.config=new ohe,this.immediate=!1}};function vQ(n,{key:e,props:t,defaultProps:i,state:r,actions:s}){return new Promise((o,a)=>{let l,h,u=Xy(t.cancel??(i==null?void 0:i.cancel),e);if(u)f();else{yi.und(t.pause)||(r.paused=Xy(t.pause,e));let p=i==null?void 0:i.pause;p!==!0&&(p=r.paused||Xy(p,e)),l=Bg(t.delay||0,e),p?(r.resumeQueue.add(A),s.pause()):(s.resume(),A())}function d(){r.resumeQueue.add(A),r.timeouts.delete(h),h.cancel(),l=h.time-Yr.now()}function A(){l>0&&!_d.skipAnimation?(r.delayed=!0,h=Yr.setTimeout(f,l),r.pauseQueue.add(d),r.timeouts.add(h)):f()}function f(){r.delayed&&(r.delayed=!1),r.pauseQueue.delete(d),r.timeouts.delete(h),n<=(r.cancelId||0)&&(u=!0);try{s.start({...t,callId:n,cancel:u},o)}catch(p){a(p)}}})}var jk=(n,e)=>e.length==1?e[0]:e.some(t=>t.cancelled)?Um(n.get()):e.every(t=>t.noop)?xQ(n.get()):ad(n.get(),e.every(t=>t.finished)),xQ=n=>({value:n,noop:!0,finished:!0,cancelled:!1}),ad=(n,e,t=!1)=>({value:n,finished:e,cancelled:t}),Um=n=>({value:n,cancelled:!0,finished:!1});function bQ(n,e,t,i){const{callId:r,parentId:s,onRest:o}=e,{asyncTo:a,promise:l}=t;return!s&&n===a&&!e.reset?l:t.promise=(async()=>{t.asyncId=r,t.asyncTo=n;const h=Dk(e,(v,w)=>w==="onRest"?void 0:v);let u,d;const A=new Promise((v,w)=>(u=v,d=w)),f=v=>{const w=r<=(t.cancelId||0)&&Um(i)||r!==t.asyncId&&ad(i,!1);if(w)throw v.result=w,d(v),v},p=(v,w)=>{const m=new Oj,y=new Hj;return(async()=>{if(_d.skipAnimation)throw jw(t),y.result=ad(i,!1),d(y),y;f(m);const x=yi.obj(v)?{...v}:{...w,to:v};x.parentId=r,bf(h,(I,j)=>{yi.und(x[j])&&(x[j]=I)});const S=await i.start(x);return f(m),t.paused&&await new Promise(I=>{t.resumeQueue.add(I)}),S})()};let g;if(_d.skipAnimation)return jw(t),ad(i,!1);try{let v;yi.arr(n)?v=(async w=>{for(const m of w)await p(m)})(n):v=Promise.resolve(n(p,i.stop.bind(i))),await Promise.all([v.then(u),A]),g=ad(i.get(),!0,!1)}catch(v){if(v instanceof Oj)g=v.result;else if(v instanceof Hj)g=v.result;else throw v}finally{r==t.asyncId&&(t.asyncId=s,t.asyncTo=s?a:void 0,t.promise=s?l:void 0)}return yi.fun(o)&&Yr.batchedUpdates(()=>{o(g,i,i.item)}),g})()}function jw(n,e){Vy(n.timeouts,t=>t.cancel()),n.pauseQueue.clear(),n.resumeQueue.clear(),n.asyncId=n.asyncTo=n.promise=void 0,e&&(n.cancelId=e)}var Oj=class extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise.")}},Hj=class extends Error{constructor(){super("SkipAnimationSignal")}},rE=n=>n instanceof Pk,che=1,Pk=class extends jce{constructor(){super(...arguments),this.id=che++,this._priority=0}get priority(){return this._priority}set priority(n){this._priority!=n&&(this._priority=n,this._onPriorityChange(n))}get(){const n=Kd(this);return n&&n.getValue()}to(...n){return _d.to(this,n)}interpolate(...n){return Oce(),_d.to(this,n)}toJSON(){return this.get()}observerAdded(n){n==1&&this._attach()}observerRemoved(n){n==0&&this._detach()}_attach(){}_detach(){}_onChange(n,e=!1){qC(this,{type:"change",parent:this,value:n,idle:e})}_onPriorityChange(n){this.idle||P5.sort(this),qC(this,{type:"priority",parent:this,priority:n})}},s0=Symbol.for("SpringPhase"),CQ=1,sE=2,oE=4,n3=n=>(n[s0]&CQ)>0,Qf=n=>(n[s0]&sE)>0,t2=n=>(n[s0]&oE)>0,Wj=(n,e)=>e?n[s0]|=sE|CQ:n[s0]&=~sE,zj=(n,e)=>e?n[s0]|=oE:n[s0]&=~oE,hhe=class extends Pk{constructor(n,e){if(super(),this.animation=new lhe,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!yi.und(n)||!yi.und(e)){const t=yi.obj(n)?{...n}:{...e,from:n};yi.und(t.default)&&(t.default=!0),this.start(t)}}get idle(){return!(Qf(this)||this._state.asyncTo)||t2(this)}get goal(){return Cu(this.animation.to)}get velocity(){const n=Kd(this);return n instanceof U5?n.lastVelocity||0:n.getPayload().map(e=>e.lastVelocity||0)}get hasAnimated(){return n3(this)}get isAnimating(){return Qf(this)}get isPaused(){return t2(this)}get isDelayed(){return this._state.delayed}advance(n){let e=!0,t=!1;const i=this.animation;let{toValues:r}=i;const{config:s}=i,o=R5(i.to);!o&&qd(i.to)&&(r=Iu(Cu(i.to))),i.values.forEach((h,u)=>{if(h.done)return;const d=h.constructor==JC?1:o?o[u].lastPosition:r[u];let A=i.immediate,f=d;if(!A){if(f=h.lastPosition,s.tension<=0){h.done=!0;return}let p=h.elapsedTime+=n;const g=i.fromValues[u],v=h.v0!=null?h.v0:h.v0=yi.arr(s.velocity)?s.velocity[u]:s.velocity;let w;const m=s.precision||(g==d?.005:Math.min(1,Math.abs(d-g)*.001));if(yi.und(s.duration))if(s.decay){const y=s.decay===!0?.998:s.decay,x=Math.exp(-(1-y)*p);f=g+v/(1-y)*(1-x),A=Math.abs(h.lastPosition-f)<=m,w=v*x}else{w=h.lastVelocity==null?v:h.lastVelocity;const y=s.restVelocity||m/10,x=s.clamp?0:s.bounce,S=!yi.und(x),I=g==d?h.v0>0:g<d;let j,C=!1;const b=1,D=Math.ceil(n/b);for(let T=0;T<D&&(j=Math.abs(w)>y,!(!j&&(A=Math.abs(d-f)<=m,A)));++T){S&&(C=f==d||f>d==I,C&&(w=-w*x,f=d));const k=-s.tension*1e-6*(f-d),B=-s.friction*.001*w,E=(k+B)/s.mass;w=w+E*b,f=f+w*b}}else{let y=1;s.duration>0&&(this._memoizedDuration!==s.duration&&(this._memoizedDuration=s.duration,h.durationProgress>0&&(h.elapsedTime=s.duration*h.durationProgress,p=h.elapsedTime+=n)),y=(s.progress||0)+p/this._memoizedDuration,y=y>1?1:y<0?0:y,h.durationProgress=y),f=g+s.easing(y)*(d-g),w=(f-h.lastPosition)/n,A=y==1}h.lastVelocity=w,Number.isNaN(f)&&(console.warn("Got NaN while animating:",this),A=!0)}o&&!o[u].done&&(A=!1),A?h.done=!0:e=!1,h.setValue(f,s.round)&&(t=!0)});const a=Kd(this),l=a.getValue();if(e){const h=Cu(i.to);(l!==h||t)&&!s.decay?(a.setValue(h),this._onChange(h)):t&&s.decay&&this._onChange(l),this._stop()}else t&&this._onChange(l)}set(n){return Yr.batchedUpdates(()=>{this._stop(),this._focus(n),this._set(n)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(Qf(this)){const{to:n,config:e}=this.animation;Yr.batchedUpdates(()=>{this._onStart(),e.decay||this._set(n,!1),this._stop()})}return this}update(n){return(this.queue||(this.queue=[])).push(n),this}start(n,e){let t;return yi.und(n)?(t=this.queue||[],this.queue=[]):t=[yi.obj(n)?n:{...e,to:n}],Promise.all(t.map(i=>this._update(i))).then(i=>jk(this,i))}stop(n){const{to:e}=this.animation;return this._focus(this.get()),jw(this._state,n&&this._lastCallId),Yr.batchedUpdates(()=>this._stop(e,n)),this}reset(){this._update({reset:!0})}eventObserved(n){n.type=="change"?this._start():n.type=="priority"&&(this.priority=n.priority+1)}_prepareNode(n){const e=this.key||"";let{to:t,from:i}=n;t=yi.obj(t)?t[e]:t,(t==null||nE(t))&&(t=void 0),i=yi.obj(i)?i[e]:i,i==null&&(i=void 0);const r={to:t,from:i};return n3(this)||(n.reverse&&([t,i]=[i,t]),i=Cu(i),yi.und(i)?Kd(this)||this._set(t):this._set(i)),r}_update({...n},e){const{key:t,defaultProps:i}=this;n.default&&Object.assign(i,Dk(n,(o,a)=>/^on/.test(a)?mQ(o,t):o)),$j(this,n,"onProps"),i2(this,"onProps",n,this);const r=this._prepareNode(n);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");const s=this._state;return vQ(++this._lastCallId,{key:t,props:n,defaultProps:i,state:s,actions:{pause:()=>{t2(this)||(zj(this,!0),gy(s.pauseQueue),i2(this,"onPause",ad(this,n2(this,this.animation.to)),this))},resume:()=>{t2(this)&&(zj(this,!1),Qf(this)&&this._resume(),gy(s.resumeQueue),i2(this,"onResume",ad(this,n2(this,this.animation.to)),this))},start:this._merge.bind(this,r)}}).then(o=>{if(n.loop&&o.finished&&!(e&&o.noop)){const a=_Q(n);if(a)return this._update(a,!0)}return o})}_merge(n,e,t){if(e.cancel)return this.stop(!0),t(Um(this));const i=!yi.und(n.to),r=!yi.und(n.from);if(i||r)if(e.callId>this._lastToId)this._lastToId=e.callId;else return t(Um(this));const{key:s,defaultProps:o,animation:a}=this,{to:l,from:h}=a;let{to:u=l,from:d=h}=n;r&&!i&&(!e.default||yi.und(u))&&(u=d),e.reverse&&([u,d]=[d,u]);const A=!KA(d,h);A&&(a.from=d),d=Cu(d);const f=!KA(u,l);f&&this._focus(u);const p=nE(e.to),{config:g}=a,{decay:v,velocity:w}=g;(i||r)&&(g.velocity=0),e.config&&!p&&ahe(g,Bg(e.config,s),e.config!==o.config?Bg(o.config,s):void 0);let m=Kd(this);if(!m||yi.und(u))return t(ad(this,!0));const y=yi.und(e.reset)?r&&!e.default:!yi.und(d)&&Xy(e.reset,s),x=y?d:this.get(),S=Dw(u),I=yi.num(S)||yi.arr(S)||M5(S),j=!p&&(!I||Xy(o.immediate||e.immediate,s));if(f){const T=tE(u);if(T!==m.constructor)if(j)m=this._set(S);else throw Error(`Cannot animate between ${m.constructor.name} and ${T.name}, as the "to" prop suggests`)}const C=m.constructor;let b=qd(u),D=!1;if(!b){const T=y||!n3(this)&&A;(f||T)&&(D=KA(Dw(x),S),b=!D),(!KA(a.immediate,j)&&!j||!KA(g.decay,v)||!KA(g.velocity,w))&&(b=!0)}if(D&&Qf(this)&&(a.changed&&!y?b=!0:b||this._stop(l)),!p&&((b||qd(l))&&(a.values=m.getPayload(),a.toValues=qd(u)?null:C==JC?[1]:Iu(S)),a.immediate!=j&&(a.immediate=j,!j&&!y&&this._set(l)),b)){const{onRest:T}=a;ho(dhe,B=>$j(this,e,B));const k=ad(this,n2(this,l));gy(this._pendingCalls,k),this._pendingCalls.add(t),a.changed&&Yr.batchedUpdates(()=>{var B;a.changed=!y,T==null||T(k,this),y?Bg(o.onRest,k):(B=a.onStart)==null||B.call(a,k,this)})}y&&this._set(x),p?t(bQ(e.to,e,this._state,this)):b?this._start():Qf(this)&&!f?this._pendingCalls.add(t):t(xQ(x))}_focus(n){const e=this.animation;n!==e.to&&(Dj(this)&&this._detach(),e.to=n,Dj(this)&&this._attach())}_attach(){let n=0;const{to:e}=this.animation;qd(e)&&(xv(e,this),rE(e)&&(n=e.priority+1)),this.priority=n}_detach(){const{to:n}=this.animation;qd(n)&&ZC(n,this)}_set(n,e=!0){const t=Cu(n);if(!yi.und(t)){const i=Kd(this);if(!i||!KA(t,i.getValue())){const r=tE(t);!i||i.constructor!=r?kk(this,r.create(t)):i.setValue(t),i&&Yr.batchedUpdates(()=>{this._onChange(t,e)})}}return Kd(this)}_onStart(){const n=this.animation;n.changed||(n.changed=!0,i2(this,"onStart",ad(this,n2(this,n.to)),this))}_onChange(n,e){e||(this._onStart(),Bg(this.animation.onChange,n,this)),Bg(this.defaultProps.onChange,n,this),super._onChange(n,e)}_start(){const n=this.animation;Kd(this).reset(Cu(n.to)),n.immediate||(n.fromValues=n.values.map(e=>e.lastPosition)),Qf(this)||(Wj(this,!0),t2(this)||this._resume())}_resume(){_d.skipAnimation?this.finish():P5.start(this)}_stop(n,e){if(Qf(this)){Wj(this,!1);const t=this.animation;ho(t.values,r=>{r.done=!0}),t.toValues&&(t.onChange=t.onPause=t.onResume=void 0),qC(this,{type:"idle",parent:this});const i=e?Um(this.get()):ad(this.get(),n2(this,n??t.to));gy(this._pendingCalls,i),t.changed&&(t.changed=!1,i2(this,"onRest",i,this))}}};function n2(n,e){const t=Dw(e),i=Dw(n.get());return KA(i,t)}function _Q(n,e=n.loop,t=n.to){const i=Bg(e);if(i){const r=i!==!0&&wQ(i),s=(r||n).reverse,o=!r||r.reset;return Pw({...n,loop:e,default:!1,pause:void 0,to:!s||nE(t)?t:void 0,from:o?n.from:void 0,reset:o,...r})}}function Pw(n){const{to:e,from:t}=n=wQ(n),i=new Set;return yi.obj(e)&&Qj(e,i),yi.obj(t)&&Qj(t,i),n.keys=i.size?Array.from(i):null,n}function uhe(n){const e=Pw(n);return yi.und(e.default)&&(e.default=Dk(e)),e}function Qj(n,e){bf(n,(t,i)=>t!=null&&e.add(i))}var dhe=["onStart","onRest","onChange","onPause","onResume"];function $j(n,e,t){n.animation[t]=e[t]!==yQ(e,t)?mQ(e[t],n.key):void 0}function i2(n,e,...t){var i,r,s,o;(r=(i=n.animation)[e])==null||r.call(i,...t),(o=(s=n.defaultProps)[e])==null||o.call(s,...t)}var Ahe=["onStart","onChange","onRest"],fhe=1,phe=class{constructor(n,e){this.id=fhe++,this.springs={},this.queue=[],this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),e&&(this._flush=e),n&&this.start({default:!0,...n})}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(n=>n.idle&&!n.isDelayed&&!n.isPaused)}get item(){return this._item}set item(n){this._item=n}get(){const n={};return this.each((e,t)=>n[t]=e.get()),n}set(n){for(const e in n){const t=n[e];yi.und(t)||this.springs[e].set(t)}}update(n){return n&&this.queue.push(Pw(n)),this}start(n){let{queue:e}=this;return n?e=Iu(n).map(Pw):this.queue=[],this._flush?this._flush(this,e):(FQ(this,e),aE(this,e))}stop(n,e){if(n!==!!n&&(e=n),e){const t=this.springs;ho(Iu(e),i=>t[i].stop(!!n))}else jw(this._state,this._lastAsyncId),this.each(t=>t.stop(!!n));return this}pause(n){if(yi.und(n))this.start({pause:!0});else{const e=this.springs;ho(Iu(n),t=>e[t].pause())}return this}resume(n){if(yi.und(n))this.start({pause:!1});else{const e=this.springs;ho(Iu(n),t=>e[t].resume())}return this}each(n){bf(this.springs,n)}_onFrame(){const{onStart:n,onChange:e,onRest:t}=this._events,i=this._active.size>0,r=this._changed.size>0;(i&&!this._started||r&&!this._started)&&(this._started=!0,Vy(n,([a,l])=>{l.value=this.get(),a(l,this,this._item)}));const s=!i&&this._started,o=r||s&&t.size?this.get():null;r&&e.size&&Vy(e,([a,l])=>{l.value=o,a(l,this,this._item)}),s&&(this._started=!1,Vy(t,([a,l])=>{l.value=o,a(l,this,this._item)}))}eventObserved(n){if(n.type=="change")this._changed.add(n.parent),n.idle||this._active.add(n.parent);else if(n.type=="idle")this._active.delete(n.parent);else return;Yr.onFrame(this._onFrame)}};function aE(n,e){return Promise.all(e.map(t=>SQ(n,t))).then(t=>jk(n,t))}async function SQ(n,e,t){const{keys:i,to:r,from:s,loop:o,onRest:a,onResolve:l}=e,h=yi.obj(e.default)&&e.default;o&&(e.loop=!1),r===!1&&(e.to=null),s===!1&&(e.from=null);const u=yi.arr(r)||yi.fun(r)?r:void 0;u?(e.to=void 0,e.onRest=void 0,h&&(h.onRest=void 0)):ho(Ahe,g=>{const v=e[g];if(yi.fun(v)){const w=n._events[g];e[g]=({finished:m,cancelled:y})=>{const x=w.get(v);x?(m||(x.finished=!1),y&&(x.cancelled=!0)):w.set(v,{value:null,finished:m||!1,cancelled:y||!1})},h&&(h[g]=e[g])}});const d=n._state;e.pause===!d.paused?(d.paused=e.pause,gy(e.pause?d.pauseQueue:d.resumeQueue)):d.paused&&(e.pause=!0);const A=(i||Object.keys(n.springs)).map(g=>n.springs[g].start(e)),f=e.cancel===!0||yQ(e,"cancel")===!0;(u||f&&d.asyncId)&&A.push(vQ(++n._lastAsyncId,{props:e,state:d,actions:{pause:JB,resume:JB,start(g,v){f?(jw(d,n._lastAsyncId),v(Um(n))):(g.onRest=a,v(bQ(u,g,d,n)))}}})),d.paused&&await new Promise(g=>{d.resumeQueue.add(g)});const p=jk(n,await Promise.all(A));if(o&&p.finished&&!(t&&p.noop)){const g=_Q(e,o,r);if(g)return FQ(n,[g]),SQ(n,g,!0)}return l&&Yr.batchedUpdates(()=>l(p,n,n.item)),p}function Vj(n,e){const t={...n.springs};return e&&ho(Iu(e),i=>{yi.und(i.keys)&&(i=Pw(i)),yi.obj(i.to)||(i={...i,to:void 0}),EQ(t,i,r=>BQ(r))}),TQ(n,t),t}function TQ(n,e){bf(e,(t,i)=>{n.springs[i]||(n.springs[i]=t,xv(t,n))})}function BQ(n,e){const t=new hhe;return t.key=n,e&&xv(t,e),t}function EQ(n,e,t){e.keys&&ho(e.keys,i=>{(n[i]||(n[i]=t(i)))._prepareNode(e)})}function FQ(n,e){ho(e,t=>{EQ(n.springs,t,i=>BQ(i,n))})}var ghe=H.createContext({pause:!1,immediate:!1}),mhe=()=>{const n=[],e=function(i){Wce();const r=[];return ho(n,(s,o)=>{if(yi.und(i))r.push(s.start());else{const a=t(i,s,o);a&&r.push(s.start(a))}}),r};e.current=n,e.add=function(i){n.includes(i)||n.push(i)},e.delete=function(i){const r=n.indexOf(i);~r&&n.splice(r,1)},e.pause=function(){return ho(n,i=>i.pause(...arguments)),this},e.resume=function(){return ho(n,i=>i.resume(...arguments)),this},e.set=function(i){ho(n,(r,s)=>{const o=yi.fun(i)?i(s,r):i;o&&r.set(o)})},e.start=function(i){const r=[];return ho(n,(s,o)=>{if(yi.und(i))r.push(s.start());else{const a=this._getProps(i,s,o);a&&r.push(s.start(a))}}),r},e.stop=function(){return ho(n,i=>i.stop(...arguments)),this},e.update=function(i){return ho(n,(r,s)=>r.update(this._getProps(i,r,s))),this};const t=function(i,r,s){return yi.fun(i)?i(s,r):i};return e._getProps=t,e};function yhe(n,e,t){const i=yi.fun(e)&&e;i&&!t&&(t=[]);const r=H.useMemo(()=>i||arguments.length==3?mhe():void 0,[]),s=H.useRef(0),o=uQ(),a=H.useMemo(()=>({ctrls:[],queue:[],flush(w,m){const y=Vj(w,m);return s.current>0&&!a.queue.length&&!Object.keys(y).some(S=>!w.springs[S])?aE(w,m):new Promise(S=>{TQ(w,y),a.queue.push(()=>{S(aE(w,m))}),o()})}}),[]),l=H.useRef([...a.ctrls]),h=H.useRef([]),u=Pj(n)||0;H.useMemo(()=>{ho(l.current.slice(n,u),w=>{ihe(w,r),w.stop(!0)}),l.current.length=n,d(u,n)},[n]),H.useMemo(()=>{d(0,Math.min(u,n))},t);function d(w,m){for(let y=w;y<m;y++){const x=l.current[y]||(l.current[y]=new phe(null,a.flush)),S=i?i(y,x):e[y];S&&(h.current[y]=uhe(S))}}const A=l.current.map((w,m)=>Vj(w,h.current[m])),f=H.useContext(ghe),p=Pj(f),g=f!==p&&nhe(f);Fk(()=>{s.current++,a.ctrls=l.current;const{queue:w}=a;w.length&&(a.queue=[],ho(w,m=>m())),ho(l.current,(m,y)=>{r==null||r.add(m),g&&m.start({default:f});const x=h.current[y];x&&(rhe(m,x.ref),m.ref?m.queue.push(x):m.start(x))})}),dQ(()=>()=>{ho(a.ctrls,w=>w.stop(!0))});const v=A.map(w=>({...w}));return r?[v,r]:v}function hx(n,e){const t=yi.fun(n),[[i],r]=yhe(1,t?n:[n],t?[]:e);return t||arguments.length==2?[i,r]:i}var whe=class extends Pk{constructor(n,e){super(),this.source=n,this.idle=!0,this._active=new Set,this.calc=Fw(...e);const t=this._get(),i=tE(t);kk(this,i.create(t))}advance(n){const e=this._get(),t=this.get();KA(e,t)||(Kd(this).setValue(e),this._onChange(e,this.idle)),!this.idle&&Gj(this._active)&&i3(this)}_get(){const n=yi.arr(this.source)?this.source.map(Cu):Iu(Cu(this.source));return this.calc(...n)}_start(){this.idle&&!Gj(this._active)&&(this.idle=!1,ho(R5(this),n=>{n.done=!1}),_d.skipAnimation?(Yr.batchedUpdates(()=>this.advance()),i3(this)):P5.start(this))}_attach(){let n=1;ho(Iu(this.source),e=>{qd(e)&&xv(e,this),rE(e)&&(e.idle||this._active.add(e),n=Math.max(n,e.priority+1))}),this.priority=n,this._start()}_detach(){ho(Iu(this.source),n=>{qd(n)&&ZC(n,this)}),this._active.clear(),i3(this)}eventObserved(n){n.type=="change"?n.idle?this.advance():(this._active.add(n.parent),this._start()):n.type=="idle"?this._active.delete(n.parent):n.type=="priority"&&(this.priority=Iu(this.source).reduce((e,t)=>Math.max(e,(rE(t)?t.priority:0)+1),0))}};function vhe(n){return n.idle!==!1}function Gj(n){return!n.size||Array.from(n).every(vhe)}function i3(n){n.idle||(n.idle=!0,ho(R5(n),e=>{e.done=!0}),qC(n,{type:"idle",parent:n}))}_d.assign({createStringInterpolator:cQ,to:(n,e)=>new whe(n,e)});var xhe=["primitive"].concat(Object.keys(eZ).filter(n=>/^[A-Z]/.test(n)).map(n=>n[0].toLowerCase()+n.slice(1)));_d.assign({createStringInterpolator:cQ,colors:wce,frameLoop:"demand"});Pq(()=>{Yr.advance()});var bhe=qce(xhe,{applyAnimatedValues:Nq}),r3=bhe.animated;const s3=({args:n,position:e,material:t,renderMode:i,isDragging:r=!1,isEditMode:s=!1,onClick:o,onPointerOver:a,onPointerOut:l})=>{const{theme:h}=Id(),{view2DTheme:u}=Wi(),d=H.useMemo(()=>new ku(...n),[n]),A=H.useMemo(()=>new tZ(d),[d]),{viewMode:f}=cr(),{gl:p}=fh(),g=t;return H.useEffect(()=>{},[t]),c.jsxs("group",{position:e,children:[c.jsx("mesh",{geometry:d,material:g,receiveShadow:f==="3D"&&i==="solid"&&!s,castShadow:f==="3D"&&i==="solid"&&!s,renderOrder:s?999:0,onClick:o,onPointerOver:a,onPointerOut:l}),c.jsx("lineSegments",{geometry:A,renderOrder:s?1e3:900,children:c.jsx("lineBasicMaterial",{color:f==="2D"?"#00FF00":i==="wireframe"?"#808080":"#505050",linewidth:f==="2D"?3:1})})]})},tu=({moduleWidth:n,moduleDepth:e,hingePosition:t="right",spaceInfo:i,color:r,doorXOffset:s=0,originalSlotWidth:o,slotCenterX:a,moduleData:l,isDragging:h=!1,isEditMode:u=!1,slotWidths:d,slotIndex:A})=>{var Le,ye,Ze,nt,st,At,ft,Xt,Yt,Zt,sn,vt,Ye,Gt,Wt,Vt,Jt,It,Ut,un,Sn,jt,fn,Zn,Hn,ti,ri,bi,Ni,ui,si,Li,Tr,xr,br,vn,wi,Ve,ct,mt,An,nn,zt,gn,Jn,Qn,pn,Ln,Dn,ei,xi,Yi,Bn,Ri,xt,Bt,on,ln,li,hi,Ii,kr,zr,Us,io,ws,Ts,Mn,ve,Re,Ke,Ge,pt,Pt,pe,xe,at,dt,Qt,wn,gt,Vn,Yn;const{spaceInfo:f}=hr(),{doorsOpen:p,view2DDirection:g}=Wi(),{columnCount:v}=v0(),{renderMode:w,viewMode:m}=cr(),{gl:y}=fh(),S=(i||f).materialConfig||{interiorColor:"#FFFFFF",doorColor:"#E0E0E0"};let I=r||S.doorColor;if(typeof I=="string"&&(/^#([0-9a-fA-F]{8})$/.test(I)&&(I="#"+I.slice(1,7)),/^rgba\(/.test(I))){const ht=I.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);ht&&(I=`#${(+ht[1]).toString(16).padStart(2,"0")}${(+ht[2]).toString(16).padStart(2,"0")}${(+ht[3]).toString(16).padStart(2,"0")}`)}const C=pi(ht=>ht.selectedPlacedModuleId)===(l==null?void 0:l.id),{theme:b}=Id(),D=()=>{if(typeof window<"u"){const Ot=getComputedStyle(document.documentElement).getPropertyValue("--theme-primary").trim();if(Ot)return Ot}return"#10b981"},T=H.useCallback(()=>new gl({color:new Ms("#E0E0E0"),metalness:0,roughness:.6,envMapIntensity:0,emissive:new Ms(0)}),[]),k=H.useMemo(()=>T(),[T]),B=H.useMemo(()=>T(),[T]),E=H.useMemo(()=>T(),[T]);H.useEffect(()=>{[k,B,E].forEach(Ot=>{Ot&&(h||u?Ot.color.set(D()):Ot.map||Ot.color.set(C?D():I),u?(Ot.transparent=!0,Ot.opacity=.15,Ot.color.set(D()),Ot.map=null,Ot.depthWrite=!1,Ot.depthTest=!0,Ot.side=Na,Ot.emissive=new Ms(D()),Ot.emissiveIntensity=.1):h?(Ot.transparent=!0,Ot.opacity=.3,Ot.color.set(D()),Ot.map=null,Ot.depthWrite=!1,Ot.side=Na):m==="2D"&&w==="solid"?(Ot.transparent=!0,Ot.opacity=0,Ot.depthWrite=!1):w==="wireframe"?(Ot.wireframe=!1,Ot.transparent=!0,Ot.opacity=0,Ot.depthWrite=!1,Ot.side=Na):C?(Ot.transparent=!0,Ot.opacity=.5,Ot.depthWrite=!0):(Ot.transparent=!1,Ot.opacity=1,Ot.depthWrite=!0),Ot.needsUpdate=!0)})},[I,C,h,u,m,w,k,B,E]);const z=H.useCallback((ht,Ot,In)=>{Ot&&ht?(uA(Ot)&&l1(ht),new A0().load(Ot,xn=>{var Gn,fi;xn.wrapS=Lu,xn.wrapT=Lu,xn.repeat.set(1,1),ht.map=xn,uA(Ot)?l1(ht):(ht.color.setHex(16777215),ht.toneMapped=!0,ht.roughness=.6),ht.needsUpdate=!0,console.log(`🚪 ${In} 텍스처 로드 완료:`,{hasMap:!!ht.map,mapImage:(fi=(Gn=ht.map)==null?void 0:Gn.image)==null?void 0:fi.src,color:ht.color.getHexString(),toneMapped:ht.toneMapped,roughness:ht.roughness,isCabinetTexture1:uA(Ot)}),requestAnimationFrame(()=>{ht.needsUpdate=!0})},void 0,xn=>{console.error(`❌ ${In} 도어 텍스처 로딩 실패:`,Ot,xn)})):ht&&(ht.map&&(ht.map.dispose(),ht.map=null),ht.color.set(I),ht.toneMapped=!0,ht.roughness=.6,ht.needsUpdate=!0)},[I]);H.useEffect(()=>{const ht=S.doorTexture;console.log("🚪 DoorModule 텍스처 적용 시작:",{textureUrl:ht,hasDoorMaterial:!!k,hasLeftDoorMaterial:!!B,hasRightDoorMaterial:!!E,doorColor:I,isDragging:h,materialConfig:S}),!h&&!u&&w!=="wireframe"&&(k&&z(k,ht,"싱글"),B&&z(B,ht,"왼쪽"),E&&z(E,ht,"오른쪽"))},[S.doorTexture,S,z,k,B,E,h,u,w]);const te=i.zone,L=te==="dropped"&&((Le=i.droppedCeiling)==null?void 0:Le.enabled);console.log("🚨🚨🚨 DoorModule 받은 spaceInfo:",{moduleId:l==null?void 0:l.id,zone:te,isDroppedZone:L,droppedCeilingEnabled:(ye=i.droppedCeiling)==null?void 0:ye.enabled,baseConfig:i.baseConfig,placementType:(Ze=i.baseConfig)==null?void 0:Ze.placementType,floatHeight:(nt=i.baseConfig)==null?void 0:nt.floatHeight,spaceHeight:i.height});let O=pr(i);if(L&&((st=i.droppedCeiling)!=null&&st.enabled)){const ht=ar.calculateZoneSlotInfo(i,i.customColumnCount);ht&&ht.dropped&&(O={...O,columnWidth:ht.dropped.columnWidth||O.columnWidth,columnCount:ht.dropped.columnCount||O.columnCount},console.log("🚨 단내림 구간 indexing 수정:",{zone:te,originalColumnWidth:pr(i).columnWidth,droppedColumnWidth:ht.dropped.columnWidth,droppedColumnCount:ht.dropped.columnCount}))}let J=o||n||O.columnWidth;console.log("🚪📏 도어 너비 계산:",{originalSlotWidth:o,moduleWidth:n,indexingColumnWidth:O.columnWidth,actualDoorWidth:J,설명:o?"커버도어 (원래 슬롯 너비)":"일반 도어"}),i.surroundType==="no-surround"&&(o||(J=O.columnWidth,console.log("🚪 노서라운드 도어 너비 계산 (fallback):",{전체너비:i.width,columnCount:O.columnCount,columnWidth:O.columnWidth,actualDoorWidth:J,zone:i.zone,isDroppedZone:L})));const $=l!=null&&l.isDynamic&&((At=l==null?void 0:l.id)!=null&&At.includes("dual"))?!0:Math.abs(n-O.columnWidth*2)<50;console.log("🚪 DoorModule 렌더링:",{moduleWidth:n,originalSlotWidth:o,actualDoorWidth:J,isDualFurniture:$,indexingColumnWidth:O.columnWidth,slotCenterX:a,moduleDataId:l==null?void 0:l.id,isDynamic:l==null?void 0:l.isDynamic,spaceInfoZone:i.zone,droppedCeilingEnabled:(ft=i.droppedCeiling)==null?void 0:ft.enabled,baseConfig:i.baseConfig,placementType:(Xt=i.baseConfig)==null?void 0:Xt.placementType,floatHeight:(Yt=i.baseConfig)==null?void 0:Yt.floatHeight});const U=ht=>ht*.01,K=U(20);let V=i.height,Q=0,X,W;const se=10;((Zt=i.baseConfig)==null?void 0:Zt.placementType)==="float"&&(Q=i.baseConfig.floatHeight||0,console.log("🔴🔴🔴 floatHeight 설정:",{baseConfig_type:(sn=i.baseConfig)==null?void 0:sn.type,placementType:(vt=i.baseConfig)==null?void 0:vt.placementType,floatHeight:Q,moduleId:l==null?void 0:l.id,isDualLowerCabinet:(Ye=l==null?void 0:l.id)==null?void 0:Ye.includes("dual-lower-cabinet")}));const q=(l==null?void 0:l.category)==="upper"||((Gt=l==null?void 0:l.id)==null?void 0:Gt.includes("upper-cabinet")),de=(l==null?void 0:l.category)==="lower"||((Wt=l==null?void 0:l.id)==null?void 0:Wt.includes("lower-cabinet"))||((Vt=l==null?void 0:l.id)==null?void 0:Vt.includes("dual-lower-cabinet")),Ce=((Jt=l==null?void 0:l.id)==null?void 0:Jt.includes("tall"))||((It=l==null?void 0:l.id)==null?void 0:It.includes("pantry"))||((Ut=l==null?void 0:l.id)==null?void 0:Ut.includes("wardrobe"))||((un=l==null?void 0:l.id)==null?void 0:un.includes("2drawer-hanging"))||(l==null?void 0:l.category)==="tall"||(l==null?void 0:l.category)==="full"&&((Sn=l==null?void 0:l.dimensions)==null?void 0:Sn.height)>=2e3,Se=(jt=l==null?void 0:l.id)==null?void 0:jt.includes("2drawer-hanging");if(console.log("🔍 키큰장 체크:",{moduleId:l==null?void 0:l.id,category:l==null?void 0:l.category,height:(fn=l==null?void 0:l.dimensions)==null?void 0:fn.height,isTallCabinet:Ce,is2DrawerHanging:Se,includes_tall:(Zn=l==null?void 0:l.id)==null?void 0:Zn.includes("tall"),includes_pantry:(Hn=l==null?void 0:l.id)==null?void 0:Hn.includes("pantry"),includes_wardrobe:(ti=l==null?void 0:l.id)==null?void 0:ti.includes("wardrobe"),category_tall:(l==null?void 0:l.category)==="tall",is_full_and_tall:(l==null?void 0:l.category)==="full"&&((ri=l==null?void 0:l.dimensions)==null?void 0:ri.height)>=2e3}),Se&&console.log("🚨🚨🚨 2단서랍+옷장 감지!!!",{moduleId:l==null?void 0:l.id,category:l==null?void 0:l.category,dimensions:l==null?void 0:l.dimensions,isTallCabinet:Ce,floatHeight:Q,spaceInfo:{height:i.height,baseConfig:i.baseConfig},doorHeightAdjusted:W,actualDoorHeight:X,furnitureHeight:(bi=l==null?void 0:l.dimensions)==null?void 0:bi.height}),q||de)X=((Ni=l==null?void 0:l.dimensions)==null?void 0:Ni.height)||(q?600:1e3),q&&i.zone==="dropped"&&((ui=i.droppedCeiling)!=null&&ui.enabled)&&console.log("🚪📏 단내림 상부장 도어 높이:",{originalHeight:((si=l==null?void 0:l.dimensions)==null?void 0:si.height)||600,actualDoorHeight:X,zone:i.zone,설명:"단내림 구간에서도 상부장 자체 높이는 동일, Y 위치만 낮아짐"}),W=X,console.log("🚪📏 상하부장 도어 높이:",{category:l==null?void 0:l.category,furnitureHeight:X,doorHeight:X,type:q?"상부장":"하부장"});else{if(i.zone==="dropped"&&((Li=i.droppedCeiling)!=null&&Li.enabled)&&((Tr=i.surround)!=null&&Tr.use)){const Ot=i.droppedCeiling.dropHeight||200;V=i.height-Ot,console.log("🚪📏 단내림+서라운드 키큰장 도어 높이 조정:",{originalHeight:i.height,dropHeight:Ot,adjustedHeight:V,zone:i.zone,isTallCabinet:Ce,surroundUse:(xr=i.surround)==null?void 0:xr.use})}else if(i.zone==="dropped"&&((br=i.droppedCeiling)!=null&&br.enabled)&&!((vn=i.surround)!=null&&vn.use)){const Ot=i.droppedCeiling.dropHeight||200;V=i.height-Ot,console.log("🚪📏 단내림 도어 높이 조정:",{originalHeight:i.height,dropHeight:Ot,adjustedHeight:V,zone:i.zone})}const ht=i.hasFloorFinish&&((wi=i.floorFinish)==null?void 0:wi.height)||0;X=V-ht,W=X}let fe,M=W;if(Ce){const ht=((Ve=l==null?void 0:l.dimensions)==null?void 0:Ve.height)||2400,Ot=i.zone,In=Ot==="dropped"&&((ct=i.droppedCeiling)==null?void 0:ct.enabled),Wn=In?((mt=i.droppedCeiling)==null?void 0:mt.dropHeight)||200:0;console.log("🔴🔴🔴 키큰장 도어 계산 시작:",{moduleId:l==null?void 0:l.id,zone:Ot,isDroppedZone:In,dropHeight:Wn,floatHeight:Q,furnitureHeight:ht,spaceHeight:i.height}),console.log("✅ 키큰장 블록 진입!",{moduleId:l==null?void 0:l.id,floatHeight:Q,actualDoorHeight:X,doorHeightAdjusted:W,moduleHeight:(An=l==null?void 0:l.dimensions)==null?void 0:An.height,spaceHeight:i.height,hasTopFrame:se,zone:Ot,isDroppedZone:In,dropHeight:Wn,surroundUse:(nn=i.surround)==null?void 0:nn.use});const Gn=In&&((zt=i.surround)==null?void 0:zt.use)?se:5,fi=((gn=i.baseConfig)==null?void 0:gn.type)==="floor"?((Jn=i.baseConfig)==null?void 0:Jn.height)||65:0;if(console.log("🔴 키큰장 가구 높이 확인:",{moduleDataHeight:(Qn=l==null?void 0:l.dimensions)==null?void 0:Qn.height,furnitureHeight:ht,actualDoorHeight:X,spaceInfoHeight:i.height,zone:Ot,isDroppedZone:In,dropHeight:Wn,설명:"키큰장은 단내림 구간에서도 높이 동일"}),In){const Ki=i.height-Wn;if(Q>0){const Ji=Ki-Gn,Ci=Ji-ht,Qi=(Ji+Ci)/2,zi=Ji+5,Ir=Ci+185;M=ht-200+15;const Hr=(zi+Ir)/2;fe=U(Hr-Qi),console.log("🔍 단내림 + 띄움 배치 키큰장 도어 계산:",{zone:"dropped",dropHeight:Wn,droppedCeilingHeight:Ki,띄움높이:Q,가구높이:ht,공간높이:i.height,도어높이:M,높이계산:`가구높이(${ht}) - 200mm + 확장(15) = ${M}`,furnitureTopAbsolute:Ji,furnitureBottomAbsolute:Ci,furnitureCenterAbsolute:Qi,doorTopAbsolute:zi,doorBottomAbsolute:Ir,doorCenterAbsolute:Hr,doorYPosition_units:fe,doorYPosition_mm:fe/.01,설명:"도어 상단: 가구상단-5mm, 도어 하단: 바닥+floatHeight+25mm"})}else{const Ji=Ki-10,Ci=fi,Qi=Ji-Ci,zi=(Ji+Ci)/2,Ir=Ji,Hr=20;M=Ir-Hr;const Si=(Ir+Hr)/2,re=-Gn;fe=(Si-zi+re)*.01,console.log("🔍 단내림 + 받침대 배치 키큰장 도어 계산:",{zone:"dropped",dropHeight:Wn,droppedCeilingHeight:Ki,받침대높이:fi,원래가구높이:ht,실제가구높이:Qi,도어높이:M,doorTopAbsolute:Ir,doorBottomAbsolute:Hr,furnitureTopAbsolute:Ji,furnitureBottomAbsolute:Ci,furnitureCenterAbsolute:zi,doorCenterAbsolute:Si,doorYPosition_units:fe,doorYPosition_mm:fe/.01,설명:"단내림 구간: 도어 높이는 단내림 천장 높이에 맞춤"})}}else if(Q>0){console.log("✅ 키큰장 + 띄움 배치 모드!",{floatHeight:Q,furnitureHeight:ht});const Ki=X-Gn,Ji=Q;M=Ki-Ji;const zi=(X+Q)/2,Ir=(Ki+Ji)/2;fe=(Ir-zi-5)*.01,console.log("🔍 띄움 배치 키큰장 도어 계산:",{띄움높이:Q,가구높이:ht,actualDoorHeight:X,도어높이:M,doorYPosition_units:fe,doorYPosition_mm:fe/.01,is2DrawerHanging:Se,설명:"가구는 천장-10mm, 도어는 천장-5mm 위치해야 함"}),Se&&console.log("🚨🚨🚨 2단서랍+옷장 도어 계산 상세:",{doorTopAbsolute:Ki,doorBottomAbsolute:Ji,finalDoorHeight:M,furnitureCenterAbsolute:zi,doorCenterAbsolute:Ir,doorYPosition:fe,doorYPosition_mm:fe/.01,계산과정:{"도어중심-가구중심":Ir-zi,"5mm조정":-5,최종:Ir-zi-5}})}else{const Ki=((pn=i.baseConfig)==null?void 0:pn.type)==="floor"?((Ln=i.baseConfig)==null?void 0:Ln.height)||65:0,Ji=X-Gn,Ci=25;M=Ji-Ci;const Ir=(X+Ki)/2;fe=((Ji+Ci)/2-Ir-5)*.01,console.log("🔍 받침대 배치 키큰장 도어 계산:",{받침대높이:Ki,가구높이:ht,actualDoorHeight:X,도어높이:M,doorYPosition_units:fe,설명:"가구는 천장-10mm, 도어는 천장-5mm 위치해야 함"})}console.log("🚪📏 키큰장 도어 최종 계산:",{type:"키큰장",zone:Ot,isDroppedZone:In,dropHeight:Wn,가구높이_mm:ht,전체공간높이_mm:X,띄움높이_mm:Q,최종도어높이_mm:M,doorYPosition_units:fe,doorYPosition_mm:fe/.01,설명:In?"단내림: 도어 높이는 단내림 천장에 맞춤":"일반: 전체 높이 사용",note:Q>0?"띄움 배치: 가구 기준 상대 위치":"일반 배치: 가구 기준 상대 위치"})}else if(q){const In=((Dn=l==null?void 0:l.dimensions)==null?void 0:Dn.height)||600;M=In+5+18;const Wn=i.zone,xn=Wn==="dropped"&&((ei=i.droppedCeiling)==null?void 0:ei.enabled),fi=((xi=i.baseConfig)==null?void 0:xi.placementType)==="float"&&((Yi=i.baseConfig)==null?void 0:Yi.floatHeight)||0;xn&&fi>0?(fe=U(-6.5+-10),console.log("🚪📍 단내림 + 띄워서 배치 상부장 도어 위치:",{type:"단내림 + 띄워서 배치 상부장",zone:Wn,floatHeight:fi,가구높이:In,도어높이:M,기본오프셋:-6.5,추가오프셋:-10,총오프셋:-6.5+-10,doorYPosition_units:fe,doorYPosition_mm:fe/.01,설명:"도어는 가구 기준 상대 위치 사용 (가구 Y 위치는 FurnitureItem에서 처리)"})):xn?(fe=U(-6.5+-10),console.log("🚪📍 단내림 상부장 도어 위치 계산:",{type:"단내림 상부장",zone:Wn,가구높이:In,도어높이:M,기본오프셋:-6.5,추가오프셋:-10,총오프셋:-6.5+-10,doorYPosition_units:fe,doorYPosition_mm:fe/.01,설명:"도어는 가구 기준 상대 위치 사용 (가구가 이미 내려왔으므로 추가 이동 불필요)"})):(fe=U(-6.5+-10),console.log("🚪📍 상부장 도어 위치 계산:",{type:"상부장",가구높이:In,위확장:5,아래확장:18,도어높이:M,가구상단_mm:In/2,가구하단_mm:-In/2,기본오프셋_mm:-6.5,추가오프셋_mm:-10,최종오프셋_mm:-6.5+-10,doorYPosition_units:fe,doorYPosition_mm:fe/.01,계산식:`${-6.5} + -10 = ${-6.5+-10}`,note:`도어 중심이 가구 중심보다 ${16.5}mm 아래로 이동`}))}else if(de){console.log("🔴🔴🔴 하부장 조건 진입!!!",{floatHeight:Q,isLowerCabinet:de,moduleId:l==null?void 0:l.id,isDualLowerCabinet:(Bn=l==null?void 0:l.id)==null?void 0:Bn.includes("dual-lower-cabinet"),moduleCategory:l==null?void 0:l.category,baseConfig:i.baseConfig,placementType:(Ri=i.baseConfig)==null?void 0:Ri.placementType,baseConfigType:(xt=i.baseConfig)==null?void 0:xt.type,slotWidths:d});const ht=((Bt=l==null?void 0:l.dimensions)==null?void 0:Bt.height)||1e3,Ot=18;let In=0;console.log("🔴🔴🔴 floatHeight 체크:",{floatHeight:Q,floatHeight_greaterThanZero:Q>0,typeOfFloatHeight:typeof Q,baseConfig:i.baseConfig,moduleId:l==null?void 0:l.id}),Q>0?(console.log("🔴🔴🔴 IF 블록 진입 - 띄움 배치 (듀얼 하부장 포함)"),M=ht+Ot,fe=0,console.log("🔴🔴🔴 하부장 띄움 배치:",{floatHeight:Q,furnitureHeight:ht,finalDoorHeight:M,doorYPosition:fe,doorYPosition_mm:fe/.01,위확장:Ot,도어높이계산:`${ht} + ${Ot} = ${M}`,가구상단:ht/2,가구하단:-ht/2,도어상단:fe/.01+M/2,도어하단:fe/.01-M/2,도어하단_vs_가구하단:fe/.01-M/2- -ht/2,설명:"띄움 배치시 도어 위 18mm만 확장, 하단은 가구와 일치해야 함"})):(console.log("🔴🔴🔴 ELSE 블록 진입 - 일반 배치"),In=40,M=ht+Ot+In,fe=U((In-Ot)/2-32),console.log("🔴🔴🔴 일반 배치 doorYPosition 계산:",{lowerExtension:In,upperExtension:Ot,계산:(In-Ot)/2-32,doorYPosition:fe,doorYPosition_mm:fe/.01})),console.log("🚪📍 하부장 도어 위치:",{type:"하부장",floatHeight:Q,띄움배치여부:Q>0,가구높이:ht,위확장:Ot,아래확장:In,도어높이:M,doorYPosition:fe,doorYPosition_mm:fe/.01,가구하단_mm:-ht/2,도어하단_mm:fe/.01-M/2,차이:fe/.01-M/2- -ht/2,note:Q>0?"띄워서 배치: 위 18mm만 확장":"일반 배치: 위 18mm, 아래 40mm 확장"}),console.log("🚪📍 하부장 도어 최종:",{type:"하부장",doorYPosition:fe,doorYPosition_mm:fe/.01,adjustedHeight:W,받침대:((on=i.baseConfig)==null?void 0:on.type)==="floor",note:"키큰장 도어와 동일한 Y 위치 사용"})}else if(!de&&!q&&!Ce)if(((ln=i.baseConfig)==null?void 0:ln.type)==="floor"){const ht=((li=i.frameSize)==null?void 0:li.top)||50,Ot=i.baseConfig.height||65;fe=((i.hasFloorFinish&&((hi=i.floorFinish)==null?void 0:hi.height)||0)>0,U(ht)/2-U(Ot)/2)}else(Ii=i.frameSize)!=null&&Ii.top,fe=0,Q>0&&(fe=U(-7.5),console.log("🚪📍 띄워서 배치 도어 위치 조정:",{floatHeight:Q,doorYPosition:fe,doorYPosition_mm:-7.5,note:"도어 아래로 15mm 확장을 위해 7.5mm 아래로 이동"}));i.zone==="dropped"&&((kr=i.droppedCeiling)!=null&&kr.enabled)&&console.log("🚪📍 단내림 도어 위치:",{doorYPosition:fe,doorHeight:X-30,zone:"dropped",note:"하단이 메인구간과 정렬됨"}),i.surroundType==="no-surround"&&((zr=i.wallConfig)!=null&&zr.left),i.surroundType==="no-surround"&&((Us=i.wallConfig)!=null&&Us.right);const Z=18,Ae=U(q||de||Ce?M:M-30);console.log("🚪📐 도어 높이 최종 적용:",{moduleId:l==null?void 0:l.id,category:l==null?void 0:l.category,isUpperCabinet:q,isLowerCabinet:de,isTallCabinet:Ce,is2DrawerHanging:Se,floatHeight_mm:Q,finalDoorHeight_mm:M,doorHeight_mm:de||Ce?M:M-30,doorHeight_three_units:Ae,doorHeight_three_to_mm:Ae/.01,doorYPosition_units:fe,doorYPosition_mm:fe/.01,적용타입:Ce?"키큰장":q?"상부장":de?"하부장":"일반"}),Se&&console.log("🚨🚨🚨 2단서랍+옷장 최종 도어 값:",{moduleId:l==null?void 0:l.id,doorHeight_mm:Ae/.01,doorYPosition_mm:fe/.01,floatHeight:Q,finalDoorHeight:M,도어상단_절대위치_mm:fe/.01+Ae/.01/2,도어하단_절대위치_mm:fe/.01-Ae/.01/2,설명:"이 값들이 다른 키큰장과 동일해야 함"});const ie=U(20)+U(2),ee=U(e)+ie,me=18/2,_e=U(me);H.useEffect(()=>{u&&console.log("🚪🔓 도어 편집 모드 활성화:",{isEditMode:u,doorsOpen:p,shouldOpen:p||u,moduleId:l==null?void 0:l.id})},[u,p,l==null?void 0:l.id]);const ue=H.useMemo(()=>p||u,[p,u]),[Be,it]=H.useState(!1);H.useEffect(()=>{if(p!==void 0){it(!0);const ht=setTimeout(()=>{it(!1)},1200);return()=>clearTimeout(ht)}},[p]),J_(()=>{Be&&y&&"invalidate"in y&&y.invalidate()});const De=ht=>{ht.stopPropagation(),console.log("🚪 도어 클릭 이벤트 발생:",{moduleId:l==null?void 0:l.id,doorsOpen:p,isEditMode:u,eventType:ht.type,target:ht.target,currentDoorsOpen:p,willBeOpen:!p});const{toggleDoors:Ot}=Wi.getState();Ot(),y&&"invalidate"in y&&y.invalidate(),setTimeout(()=>{const In=Wi.getState().doorsOpen;console.log("🚪 도어 상태 토글 완료, 새로운 상태:",In)},100)},qe=ht=>{ht.stopPropagation(),document.body.style.cursor="pointer"},Je=ht=>{ht.stopPropagation(),document.body.style.cursor="auto"},Me=hx({rotation:ue?-4*Math.PI/9:0,config:{tension:90,friction:16,clamp:!0}}),et=hx({rotation:ue?4*Math.PI/9:0,config:{tension:90,friction:16,clamp:!0}}),He=hx({rotation:ue?-4*Math.PI/9:0,config:{tension:90,friction:16,clamp:!0}}),ze=hx({rotation:ue?4*Math.PI/9:0,config:{tension:90,friction:16,clamp:!0}});let Oe=a!==void 0?a:0,ke=0;console.log("🚪 도어 초기 위치:",{slotCenterX:a,doorGroupX:Oe,isDualFurniture:$,slotIndex:A,columnCount:v,surroundType:i.surroundType,moduleId:l==null?void 0:l.id}),a!=null&&a!==0?console.log("🚪 도어 오프셋 적용:",{slotIndex:A,slotCenterX_오프셋:a,doorGroupX:Oe,설명:"도어를 가구 중심에서 오프셋만큼 이동"}):console.log("🚪 도어 위치 기본값 사용 (가구 중심):",{slotIndex:A,doorGroupX:0});const rt=(()=>{const ht=i.columns||[];if(ht.length===0)return console.log("🚪 기둥이 없음"),{isNearColumn:!1,columnSide:null};let Ot=0;if(i.surroundType==="no-surround"&&A!==void 0){const fi=A===0&&J<O.columnWidth,Ki=A===v-1&&J<O.columnWidth;fi?Ot=-18/2:Ki&&(Ot=18/2)}const In=(a||0)+U(Ot),Wn=In-U(J/2),xn=In+U(J/2);console.log("🚪 도어 위치 체크:",{doorCenterX:In,doorLeftEdge:Wn,doorRightEdge:xn,actualDoorWidth:J,slotCenterX:a,positionAdjustment:Ot,surroundType:i.surroundType,note:Ot!==0?"노서라운드 보정 적용됨":"보정 없음"});for(const Gn of ht){const fi=U(Gn.position[0]-i.width/2),Ki=U(Gn.width),Ji=fi-Ki/2,Ci=fi+Ki/2,Qi=U(100),zi=Math.abs(Wn-Ci),Ir=Math.abs(xn-Ji);if(console.log("🚪 기둥 거리 체크:",{columnPosition:Gn.position,columnX:fi,columnWidth:Gn.width,columnLeftEdge:Ji,columnRightEdge:Ci,leftDistance:zi/.01,rightDistance:Ir/.01,threshold:Qi/.01}),zi<Qi)return console.log("🚪 왼쪽에 기둥 감지"),{isNearColumn:!0,columnSide:"left"};if(Ir<Qi)return console.log("🚪 오른쪽에 기둥 감지"),{isNearColumn:!0,columnSide:"right"}}return console.log("🚪 기둥 인접하지 않음"),{isNearColumn:!1,columnSide:null}})();let _t=t;const Ee=(l==null?void 0:l.type)==="door"||((io=l==null?void 0:l.id)==null?void 0:io.toLowerCase().includes("door"))||((ws=l==null?void 0:l.moduleId)==null?void 0:ws.toLowerCase().includes("door"));if(rt.isNearColumn&&Ee){const ht=i.zone==="dropped"&&((Ts=i.droppedCeiling)==null?void 0:Ts.enabled)&&i.surroundType==="no-surround";ht?_t=rt.columnSide==="left"?"left":"right":_t=rt.columnSide==="left"?"right":"left",console.log("🚪 기둥 인접 도어 힌지 자동 조정:",{originalHinge:t,adjustedHinge:_t,columnSide:rt.columnSide,doorCenterX:a,moduleData:l,isDoorModule:Ee,isDroppedNoSurround:ht,zone:i.zone,surroundType:i.surroundType,note:ht?"단내림+노서라운드: 힌지는 기둥 쪽에 위치":"일반: 힌지는 기둥 반대쪽에 위치"})}else console.log("🚪 힌지 조정 안함:",{isNearColumn:rt.isNearColumn,columnSide:rt.columnSide,isDoorModule:Ee,moduleData:l});if($){let ht=J,Ot,In,Wn=!1,xn=!1,Gn=0,fi=0;if(L&&(!d||d.length<2))console.log("🚨 단내림 구간 듀얼장 도어 너비 계산 - slotWidths 없음, 기본값 사용",{zone:te,slotWidths:d,indexingColumnWidth:O.columnWidth,actualDoorWidth:J,moduleWidth:n}),Gn=O.columnWidth,fi=O.columnWidth,ht=Gn+fi,i.surroundType!=="no-surround"?(Ot=(ht-6)/2,In=(ht-6)/2):(Ot=(ht-3-2*1.5)/2,In=(ht-3-2*1.5)/2);else if(i.surroundType==="no-surround"){Gn=(d==null?void 0:d[0])||O.columnWidth,fi=(d==null?void 0:d[1])||O.columnWidth,console.log("🔴 노서라운드 듀얼 도어 초기 너비:",{slotWidths:d,slot1Width:Gn,slot2Width:fi,indexingColumnWidth:O.columnWidth,slotIndex:A,columnCount:O.columnCount}),d&&d.length>=2&&(i.installType==="freestanding"?A===0?(Gn=d[0]+Z,fi=d[1]):A+2>=O.columnCount?(Gn=d[0],fi=d[1]+Z):(Gn=d[0],fi=d[1]):i.installType==="semistanding"?(Mn=i.wallConfig)!=null&&Mn.left&&!((ve=i.wallConfig)!=null&&ve.right)?A+2>=O.columnCount?(Gn=d[0],fi=d[1]+Z):(Gn=d[0],fi=d[1]):(Re=i.wallConfig)!=null&&Re.right&&!((Ke=i.wallConfig)!=null&&Ke.left)&&A===0?(Gn=d[0]+Z,fi=d[1]):(Gn=d[0],fi=d[1]):(Gn=d[0],fi=d[1])),ht=Gn+fi,i.installType==="freestanding"?(Wn=A===0&&(d==null?void 0:d[0])<O.columnWidth,xn=d&&d.length>=2&&d[1]<O.columnWidth&&A+2>=O.columnCount,Wn?ke=-9:xn&&(ke=9)):i.installType==="semistanding"?(Ge=i.wallConfig)!=null&&Ge.left&&!((pt=i.wallConfig)!=null&&pt.right)?(Wn=!1,xn=A+2>=O.columnCount&&d&&d.length>=2&&d[1]<O.columnWidth,xn&&(ke=9)):(Pt=i.wallConfig)!=null&&Pt.right&&!((pe=i.wallConfig)!=null&&pe.left)?(Wn=A===0&&(d==null?void 0:d[0])<O.columnWidth,xn=!1,Wn&&(ke=-9)):(Wn=!1,xn=!1,ke=0):(Wn=!1,xn=!1,ke=0),console.log("🚪 듀얼 엔드패널 상태:",{isFirstSlotWithEndPanel:Wn,isLastSlotWithEndPanel:xn,doorAdjustment:ke,note:"엔드패널 위치로 보정"});const Ue=3,ut=1.5;d&&d.length>=2&&Gn>0&&fi>0?(Ot=Gn-ut-Ue/2,In=fi-ut-Ue/2,console.log("🔴 노서라운드 듀얼 도어 개별 너비 계산:",{slot1Width:Gn,slot2Width:fi,leftDoorWidth:Ot,rightDoorWidth:In,noSurroundDoorGap:Ue,noSurroundEdgeGap:ut,method:"slotWidths 기반"})):(Ot=(ht-Ue-2*ut)/2,In=(ht-Ue-2*ut)/2,console.log("🔴 노서라운드 듀얼 도어 균등 분할:",{totalWidth:ht,leftDoorWidth:Ot,rightDoorWidth:In,method:"균등 분할"}))}else{d&&d.length>=2&&(Gn=d[0],fi=d[1],ht=Gn+fi);const Ue=6;Ot=(ht-Ue)/2,In=(ht-Ue)/2}const Ki=i.surroundType==="no-surround"?3:6,Ji=(i.surroundType==="no-surround",1.5);console.log("🚪 듀얼 도어:",{totalWidth:ht,leftDoorWidth:Ot,rightDoorWidth:In,doorGap:Ki,edgeGap:Ji,doorAdjustment:ke,slotIndex:A,columnCount:v,isFirstSlotWithEndPanel:Wn,isLastSlotWithEndPanel:xn,slotWidths:d,slot1Width:Gn,slot2Width:fi,surroundType:i.surroundType});const Ci=U(Ot),Qi=U(In);let zi,Ir;zi=-ht/2+Ji+Ot/2,Ir=ht/2-Ji-In/2;const Hr=U(zi),Si=U(Ir),re=Hr+(-Ci/2+_e),be=Si+(Qi/2-_e);return i.surroundType==="no-surround"&&ke!==0&&(a===0||a===void 0?(Oe+=U(ke),console.log("🚪 듀얼 도어 위치 보정 적용:",{slotIndex:A,slotCenterX:a,doorAdjustment:ke,doorGroupX:Oe,isFirstSlot:A===0,isLastSlot:A+2>=O.columnCount,note:"DoorModule에서 보정"})):console.log("🚪 듀얼 도어 위치 보정 건너뜀:",{slotIndex:A,slotCenterX:a,doorAdjustment:ke,isFirstSlot:A===0,isLastSlot:A+2>=O.columnCount,note:"FurnitureItem에서 이미 보정됨"})),console.log("🚪 듀얼 도어 위치:",{totalWidth:ht,slotWidths:d,slotIndex:A,columnCount:v,isLastSlot:A+2>=v,leftDoorWidth:Ot,rightDoorWidth:In,doorAdjustment:ke,doorGroupX:Oe,doorGroupX_mm:Oe/.01,mode:d?"개별 슬롯 너비":"균등분할 (fallback)",leftXOffset:Hr.toFixed(3),rightXOffset:Si.toFixed(3),leftHingeX:re.toFixed(3),rightHingeX:be.toFixed(3)}),c.jsxs("group",{position:[Oe,0,0],children:[" ",c.jsx("group",{position:[re,fe,ee/2],children:c.jsx(r3.group,{"rotation-y":He.rotation,children:c.jsxs("group",{position:[Ci/2-_e,.1,0],children:[c.jsx(s3,{args:[Ci,Ae,K],position:[0,0,0],material:B,renderMode:w,isDragging:h,isEditMode:u,onClick:De,onPointerOver:qe,onPointerOut:Je}),m==="2D"&&g==="front"&&c.jsx("group",{position:[0,0,K/2+.001],children:(()=>{const Ue=[Ci/2,-Ae/2,0],ut=[-Ci/2,0,0],yt=[],en=ut[0]-Ue[0],cn=ut[1]-Ue[1],Tn=Math.sqrt(en*en+cn*cn),$n=2.4,ai=.9,ni=.9;let Rn=0,sr=!0;for(;Rn<Tn;){if(sr){let or=$n;Rn+$n+ni>=Tn&&(or=Tn-Rn);const hs=Rn/Tn,us=(Rn+or)/Tn;if(yt.push(c.jsx(lt,{points:[[Ue[0]+en*hs,Ue[1]+cn*hs,0],[Ue[0]+en*us,Ue[1]+cn*us,0]],color:"#00FF00",lineWidth:.5,transparent:!0,opacity:.6,renderOrder:1002,depthTest:!1},`seg1-long-${Rn}`)),Rn+or>=Tn)break;Rn+=or+ni}else{let or=ai;Rn+ai+ni>=Tn&&(or=Tn-Rn);const hs=Rn/Tn,us=(Rn+or)/Tn;if(yt.push(c.jsx(lt,{points:[[Ue[0]+en*hs,Ue[1]+cn*hs,0],[Ue[0]+en*us,Ue[1]+cn*us,0]],color:"#00FF00",lineWidth:.5,transparent:!0,opacity:.6,renderOrder:1002,depthTest:!1},`seg1-short-${Rn}`)),Rn+or>=Tn)break;Rn+=or+ni}sr=!sr}const dr=[-Ci/2,0,0],qr=[Ci/2,Ae/2,0],vs=[],Cr=qr[0]-dr[0],cs=qr[1]-dr[1],Qr=Math.sqrt(Cr*Cr+cs*cs);for(Rn=0,sr=!0;Rn<Qr;){if(sr){let or=$n;Rn+$n+ni>=Qr&&(or=Qr-Rn);const hs=Rn/Qr,us=(Rn+or)/Qr;if(vs.push(c.jsx(lt,{points:[[dr[0]+Cr*hs,dr[1]+cs*hs,0],[dr[0]+Cr*us,dr[1]+cs*us,0]],color:"#00FF00",lineWidth:.5,transparent:!0,opacity:.6,renderOrder:1002,depthTest:!1},`seg2-long-${Rn}`)),Rn+or>=Qr)break;Rn+=or+ni}else{let or=ai;Rn+ai+ni>=Qr&&(or=Qr-Rn);const hs=Rn/Qr,us=(Rn+or)/Qr;if(vs.push(c.jsx(lt,{points:[[dr[0]+Cr*hs,dr[1]+cs*hs,0],[dr[0]+Cr*us,dr[1]+cs*us,0]],color:"#00FF00",lineWidth:.5,transparent:!0,opacity:.6,renderOrder:1002,depthTest:!1},`seg2-short-${Rn}`)),Rn+or>=Qr)break;Rn+=or+ni}sr=!sr}return[...yt,...vs]})()})]})})}),c.jsx("group",{position:[be,fe,ee/2],children:c.jsx(r3.group,{"rotation-y":ze.rotation,children:c.jsxs("group",{position:[-Qi/2+_e,.1,0],children:[c.jsx(s3,{args:[Qi,Ae,K],position:[0,0,0],material:E,renderMode:w,isDragging:h,isEditMode:u,onClick:De,onPointerOver:qe,onPointerOut:Je}),m==="2D"&&g==="front"&&c.jsx("group",{position:[0,0,K/2+.001],children:(()=>{const Ue=[-Qi/2,-Ae/2,0],ut=[Qi/2,0,0],yt=[],en=ut[0]-Ue[0],cn=ut[1]-Ue[1],Tn=Math.sqrt(en*en+cn*cn),$n=2.4,ai=.9,ni=.9;let Rn=0,sr=!0;for(;Rn<Tn;){if(sr){let or=$n;Rn+$n+ni>=Tn&&(or=Tn-Rn);const hs=Rn/Tn,us=(Rn+or)/Tn;if(yt.push(c.jsx(lt,{points:[[Ue[0]+en*hs,Ue[1]+cn*hs,0],[Ue[0]+en*us,Ue[1]+cn*us,0]],color:"#00FF00",lineWidth:.5,transparent:!0,opacity:.6,renderOrder:1002,depthTest:!1},`seg1-long-${Rn}`)),Rn+or>=Tn)break;Rn+=or+ni}else{let or=ai;Rn+ai+ni>=Tn&&(or=Tn-Rn);const hs=Rn/Tn,us=(Rn+or)/Tn;if(yt.push(c.jsx(lt,{points:[[Ue[0]+en*hs,Ue[1]+cn*hs,0],[Ue[0]+en*us,Ue[1]+cn*us,0]],color:"#00FF00",lineWidth:.5,transparent:!0,opacity:.6,renderOrder:1002,depthTest:!1},`seg1-short-${Rn}`)),Rn+or>=Tn)break;Rn+=or+ni}sr=!sr}const dr=[Qi/2,0,0],qr=[-Qi/2,Ae/2,0],vs=[],Cr=qr[0]-dr[0],cs=qr[1]-dr[1],Qr=Math.sqrt(Cr*Cr+cs*cs);for(Rn=0,sr=!0;Rn<Qr;){if(sr){let or=$n;Rn+$n+ni>=Qr&&(or=Qr-Rn);const hs=Rn/Qr,us=(Rn+or)/Qr;if(vs.push(c.jsx(lt,{points:[[dr[0]+Cr*hs,dr[1]+cs*hs,0],[dr[0]+Cr*us,dr[1]+cs*us,0]],color:"#00FF00",lineWidth:.5,transparent:!0,opacity:.6,renderOrder:1002,depthTest:!1},`seg2-long-${Rn}`)),Rn+or>=Qr)break;Rn+=or+ni}else{let or=ai;Rn+ai+ni>=Qr&&(or=Qr-Rn);const hs=Rn/Qr,us=(Rn+or)/Qr;if(vs.push(c.jsx(lt,{points:[[dr[0]+Cr*hs,dr[1]+cs*hs,0],[dr[0]+Cr*us,dr[1]+cs*us,0]],color:"#00FF00",lineWidth:.5,transparent:!0,opacity:.6,renderOrder:1002,depthTest:!1},`seg2-short-${Rn}`)),Rn+or>=Qr)break;Rn+=or+ni}sr=!sr}return[...yt,...vs]})()})]})})})]})}else{let ht;if(ht=J-3,console.log("🚪 싱글 도어 너비 최종 계산:",{originalSlotWidth:o,actualDoorWidth:J,doorWidth:ht,indexingColumnWidth:O.columnWidth,surroundType:i.surroundType,installType:i.installType,slotIndex:A,설명:"모든 도어 - 3mm 갭 적용"}),i.surroundType==="no-surround"&&o){const Gn=o>(n||0)+10;if(console.log("🔍🔍🔍 엔드패널 포함 여부 판단:",{originalSlotWidth:o,moduleWidth:n,difference:o-(n||0),hasEndPanelIncluded:Gn,slotIndex:A,surroundType:i.surroundType,installType:i.installType}),Gn){let fi=!1,Ki=!1;if(A!==void 0){let Ji=O.columnCount,Ci=A;if((xe=i.droppedCeiling)!=null&&xe.enabled){const Qi=ar.calculateZoneSlotInfo(i,i.customColumnCount),zi=i.droppedCeiling.position||"right",Ir=i.zone;Ir==="dropped"&&Qi.dropped?(Ji=Qi.dropped.columnCount,zi==="right"&&Qi.normal?Ci=A-Qi.normal.columnCount:Ci=A,i.installType==="freestanding"?zi==="right"?Ki=Ci===Ji-1:fi=Ci===0:(i.installType==="semistanding"||i.installType==="semi-standing")&&(!((at=i.wallConfig)!=null&&at.right)&&zi==="right"?Ki=Ci===Ji-1:!((dt=i.wallConfig)!=null&&dt.left)&&zi==="left"&&(fi=Ci===0))):(Ir==="normal"||!Ir)&&(zi==="left"&&Qi.dropped&&(Ci=A-Qi.dropped.columnCount),i.installType==="freestanding"?zi==="right"?fi=Ci===0:Ki=Ci===Ji-1:(i.installType==="semistanding"||i.installType==="semi-standing")&&(!((Qt=i.wallConfig)!=null&&Qt.left)&&zi==="right"?fi=Ci===0:!((wn=i.wallConfig)!=null&&wn.right)&&zi==="left"&&(Ki=Ci===Ji-1)))}else i.installType==="freestanding"?(fi=A===0,Ki=A===Ji-1):(i.installType==="semistanding"||i.installType==="semi-standing")&&((gt=i.wallConfig)!=null&&gt.left||(fi=A===0),(Vn=i.wallConfig)!=null&&Vn.right||(Ki=A===Ji-1))}fi?(ke=-9,console.log("🎯 커버도어 왼쪽 엔드패널 - 9mm 왼쪽 이동:",{slotIndex:A,doorAdjustment:ke,originalSlotWidth:o,moduleWidth:n,설명:"왼쪽 엔드패널로 인한 오프셋을 보정"})):Ki&&(ke=9,console.log("🎯 커버도어 오른쪽 엔드패널 - 9mm 오른쪽 이동:",{slotIndex:A,doorAdjustment:ke,originalSlotWidth:o,moduleWidth:n,설명:"오른쪽 엔드패널로 인한 오프셋을 보정"}))}}const Ot=U(ht);i.surroundType==="no-surround"&&ke!==0&&(a===0||a===void 0?(Oe+=U(ke),console.log("🚪 싱글 도어 위치 보정 적용:",{slotIndex:A,slotCenterX:a,doorAdjustment:ke,doorGroupX:Oe,note:"DoorModule에서 보정"})):console.log("🚪 싱글 도어 위치 보정 건너뜀:",{slotIndex:A,slotCenterX:a,doorAdjustment:ke,note:"FurnitureItem에서 이미 보정됨"})),console.log("🚪 싱글 도어 크기:",{actualDoorWidth:J,doorWidth:ht,originalSlotWidth:o,slotIndex:A,columnCount:v,isFirstSlot:A===0,isLastSlot:A===v-1,doorAdjustment:ke,doorGroupX:Oe,surroundType:i.surroundType,fallbackColumnWidth:O.columnWidth,moduleDataId:l==null?void 0:l.id});const In=_t==="left"?-Ot/2+_e:Ot/2-_e,Wn=-In,xn=Oe+U(ke);return console.log("🎯🎯🎯 싱글 도어 최종 위치 계산:",{doorGroupX:Oe,doorAdjustment:ke,doorAdjustment_units:U(ke),hingeAxisOffset:In,finalDoorX:xn,originalSlotWidth:o,moduleWidth:n,slotIndex:A,surroundType:i.surroundType,installType:i.installType,droppedCeilingEnabled:(Yn=i.droppedCeiling)==null?void 0:Yn.enabled,zone:i.zone}),c.jsx("group",{position:[xn+In,fe,ee/2],children:c.jsx(r3.group,{"rotation-y":_t==="left"?Me.rotation:et.rotation,children:c.jsxs("group",{position:[Wn,.1,0],children:[c.jsx(s3,{args:[Ot,Ae,K],position:[0,0,0],material:k,renderMode:w,isDragging:h,isEditMode:u,onClick:De,onPointerOver:qe,onPointerOut:Je}),m==="2D"&&g==="front"&&c.jsx("group",{position:[0,0,K/2+.001],children:(()=>{const Gn=[_t==="left"?Ot/2:-Ot/2,-Ae/2,0],fi=[_t==="left"?-Ot/2:Ot/2,0,0],Ki=[],Ji=fi[0]-Gn[0],Ci=fi[1]-Gn[1],Qi=Math.sqrt(Ji*Ji+Ci*Ci),zi=2.4,Ir=.9,Hr=.9;let Si=0,re=!0;for(;Si<Qi;){if(re){let Tn=zi;Si+zi+Hr>=Qi&&(Tn=Qi-Si);const $n=Si/Qi,ai=(Si+Tn)/Qi;if(Ki.push(c.jsx(lt,{points:[[Gn[0]+Ji*$n,Gn[1]+Ci*$n,0],[Gn[0]+Ji*ai,Gn[1]+Ci*ai,0]],color:"#00FF00",lineWidth:.5,transparent:!0,opacity:.6,renderOrder:1002,depthTest:!1},`seg1-long-${Si}`)),Si+Tn>=Qi)break;Si+=Tn+Hr}else{let Tn=Ir;Si+Ir+Hr>=Qi&&(Tn=Qi-Si);const $n=Si/Qi,ai=(Si+Tn)/Qi;if(Ki.push(c.jsx(lt,{points:[[Gn[0]+Ji*$n,Gn[1]+Ci*$n,0],[Gn[0]+Ji*ai,Gn[1]+Ci*ai,0]],color:"#00FF00",lineWidth:.5,transparent:!0,opacity:.6,renderOrder:1002,depthTest:!1},`seg1-short-${Si}`)),Si+Tn>=Qi)break;Si+=Tn+Hr}re=!re}const be=[_t==="left"?-Ot/2:Ot/2,0,0],Ue=[_t==="left"?Ot/2:-Ot/2,Ae/2,0],ut=[],yt=Ue[0]-be[0],en=Ue[1]-be[1],cn=Math.sqrt(yt*yt+en*en);for(Si=0,re=!0;Si<cn;){if(re){let Tn=zi;Si+zi+Hr>=cn&&(Tn=cn-Si);const $n=Si/cn,ai=(Si+Tn)/cn;if(ut.push(c.jsx(lt,{points:[[be[0]+yt*$n,be[1]+en*$n,0],[be[0]+yt*ai,be[1]+en*ai,0]],color:"#00FF00",lineWidth:.5,transparent:!0,opacity:.6,renderOrder:1002,depthTest:!1},`seg2-long-${Si}`)),Si+Tn>=cn)break;Si+=Tn+Hr}else{let Tn=Ir;Si+Ir+Hr>=cn&&(Tn=cn-Si);const $n=Si/cn,ai=(Si+Tn)/cn;if(ut.push(c.jsx(lt,{points:[[be[0]+yt*$n,be[1]+en*$n,0],[be[0]+yt*ai,be[1]+en*ai,0]],color:"#00FF00",lineWidth:.5,transparent:!0,opacity:.6,renderOrder:1002,depthTest:!1},`seg2-short-${Si}`)),Si+Tn>=cn)break;Si+=Tn+Hr}re=!re}return[...Ki,...ut]})()})]})})})}},Che=({moduleData:n,color:e,internalHeight:t,hasDoor:i,customDepth:r,hingePosition:s="right",spaceInfo:o,isDragging:a=!1,isEditMode:l=!1,doorWidth:h,adjustedWidth:u,originalSlotWidth:d,slotIndex:A,slotInfo:f,slotCenterX:p,showFurniture:g=!0,isHighlighted:v=!1,furnitureId:w})=>{var D,T;const{indirectLightEnabled:m,indirectLightIntensity:y}=Wi(),x=Dd(n,{color:e,internalHeight:t,customDepth:r,isDragging:a,isEditMode:l,adjustedWidth:u,isHighlighted:v}),{renderMode:S}=cr(),I=(D=o==null?void 0:o.baseConfig)==null?void 0:D.placementType,j=I==="float",C=((T=o==null?void 0:o.baseConfig)==null?void 0:T.floatHeight)||0,b=!1;return console.log("🔥 SingleType1 간접조명 체크:",{moduleId:n.id,placementType:I,isFloating:j,floatHeight:C,isDragging:a,indirectLightEnabled:m,showIndirectLight:b}),c.jsxs(c.Fragment,{children:[b,g&&c.jsx(I1,{...x,isDragging:a,isEditMode:l,isHighlighted:v,children:!a&&c.jsx(Zh,{modelConfig:x.modelConfig,height:x.height,innerWidth:x.innerWidth,depth:x.depth,adjustedDepthForShelves:x.adjustedDepthForShelves,basicThickness:x.basicThickness,shelfZOffset:x.shelfZOffset,material:x.material,calculateSectionHeight:x.calculateSectionHeight,renderMode:S,furnitureId:n.id})}),i&&o&&!(f&&f.hasColumn&&(f.columnType==="deep"||u!==void 0))&&c.jsx(tu,{moduleWidth:h||n.dimensions.width,moduleDepth:x.actualDepthMm,hingePosition:s,spaceInfo:o,color:x.doorColor,isDragging:a,isEditMode:l,moduleData:n,originalSlotWidth:d||h,slotIndex:A,slotCenterX:p})]})},$f=({args:n,position:e,material:t,renderMode:i="solid",isDragging:r=!1,isEditMode:s=!1,hideEdges:o=!1,isBackPanel:a=!1})=>{const{viewMode:l}=cr(),{view2DDirection:h,view2DTheme:u,indirectLightEnabled:d,indirectLightIntensity:A}=Wi(),{gl:f}=fh(),{theme:p}=Ua(),g=ci.useMemo(()=>{if(r&&t instanceof gl){const v=t.clone();v.transparent=!0,v.opacity=.6;const w=()=>{if(typeof window<"u"){const y=getComputedStyle(document.documentElement).getPropertyValue("--theme-primary").trim();if(y)return y}return"#10b981"};return v.color=new Ms(w()),v.needsUpdate=!0,v}return t},[t,r,s]);return c.jsxs("group",{position:e,children:[c.jsxs("mesh",{receiveShadow:l==="3D"&&i==="solid",castShadow:l==="3D"&&i==="solid",children:[c.jsx("boxGeometry",{args:n}),i==="wireframe"?c.jsx("meshBasicMaterial",{transparent:!0,opacity:0}):c.jsx("primitive",{object:g,attach:"material"})]}),!o&&c.jsxs("lineSegments",{children:[c.jsx("edgesGeometry",{args:[new ku(...n)]}),c.jsx("lineBasicMaterial",{color:l==="3D"?"#505050":i==="wireframe"?u==="dark"?"#FF4500":"#000000":u==="dark"?"#FF4500":"#444444",transparent:l==="3D"||a&&l==="2D"&&h==="front",opacity:a&&l==="2D"&&h==="front"?.1:l==="3D"?.9:1,depthTest:l==="3D",depthWrite:!1,polygonOffset:l==="3D",polygonOffsetFactor:l==="3D"?-10:0,polygonOffsetUnits:l==="3D"?-10:0,linewidth:l==="2D"?2:1})]})]})},_he=({moduleData:n,color:e,internalHeight:t,hasDoor:i,customDepth:r,hingePosition:s="right",spaceInfo:o,isDragging:a=!1,isEditMode:l=!1,doorWidth:h,originalSlotWidth:u,slotIndex:d,slotCenterX:A,adjustedWidth:f,slotInfo:p,showFurniture:g=!0,furnitureId:v})=>{var Y,K;const w=Dd(n,{color:e,internalHeight:t,customDepth:r,isDragging:a,isEditMode:l,adjustedWidth:f}),{width:m,height:y,depth:x,innerWidth:S,innerHeight:I,basicThickness:j,backPanelThickness:C,adjustedDepthForShelves:b,shelfZOffset:D,material:T,mmToThreeUnits:k,isMultiSectionFurniture:B,getSectionHeights:E}=w,{renderMode:z,viewMode:te}=cr();(Y=o==null?void 0:o.baseConfig)==null||Y.placementType,(K=o==null?void 0:o.baseConfig)!=null&&K.floatHeight;const L=!1,{view2DDirection:O,indirectLightEnabled:J,indirectLightIntensity:$}=Wi(),{theme:U}=Ua();return c.jsxs(c.Fragment,{children:[L,g&&c.jsxs("group",{children:[B()?c.jsx(c.Fragment,{children:E().map((V,Q)=>{let X=-y/2+j;for(let se=0;se<Q;se++)X+=E()[se];const W=X+V/2-j;return c.jsxs(ci.Fragment,{children:[c.jsx($f,{args:[j,V,x],position:[-m/2+j/2,W,0],material:T,renderMode:z,isDragging:a,isEditMode:l}),c.jsx($f,{args:[j,V,x],position:[m/2-j/2,W,0],material:T,renderMode:z,isDragging:a,isEditMode:l}),Q<E().length-1&&c.jsx($f,{args:[S,j,b-j],position:[0,W+V/2+j/2,j/2+D],material:T,renderMode:z,isDragging:a,isEditMode:l})]},`side-panels-${Q}`)})}):c.jsxs(c.Fragment,{children:[c.jsx($f,{args:[j,y,x],position:[-m/2+j/2,0,0],material:T,renderMode:z,isDragging:a,isEditMode:l}),c.jsx($f,{args:[j,y,x],position:[m/2-j/2,0,0],material:T,renderMode:z,isDragging:a,isEditMode:l})]}),c.jsx($f,{args:[S,j,x],position:[0,y/2-j/2,0],material:T,renderMode:z,isDragging:a,isEditMode:l}),c.jsx($f,{args:[S,j,x],position:[0,-y/2+j/2,0],material:T,renderMode:z,isDragging:a,isEditMode:l}),c.jsx($f,{args:[S+k(10),I+k(10),C],position:[0,0,-x/2+C/2+k(17)],material:T,renderMode:z,isDragging:a,isEditMode:l,hideEdges:!1,isBackPanel:!0}),!a&&c.jsx(Zh,{modelConfig:w.modelConfig,height:w.height,innerWidth:w.innerWidth,depth:w.depth,adjustedDepthForShelves:w.adjustedDepthForShelves,basicThickness:w.basicThickness,shelfZOffset:w.shelfZOffset,material:w.material,calculateSectionHeight:w.calculateSectionHeight,renderMode:z})]}),i&&o&&!(p&&p.hasColumn&&(p.columnType==="deep"||f!==void 0))&&c.jsx(tu,{moduleWidth:h||n.dimensions.width,moduleDepth:w.actualDepthMm,hingePosition:s,spaceInfo:o,color:w.doorColor,isDragging:a,isEditMode:l,moduleData:n,originalSlotWidth:u,slotCenterX:A||0,slotIndex:d})]})},She=({moduleData:n,color:e,internalHeight:t,hasDoor:i,customDepth:r,hingePosition:s="right",spaceInfo:o,isDragging:a=!1,isEditMode:l=!1,doorWidth:h,originalSlotWidth:u,slotIndex:d,slotCenterX:A,adjustedWidth:f,slotInfo:p,showFurniture:g=!0})=>{var x,S;const{indirectLightEnabled:v,indirectLightIntensity:w}=Wi(),m=Dd(n,{color:e,internalHeight:t,customDepth:r,isDragging:a,isEditMode:l,adjustedWidth:f}),{renderMode:y}=cr();return(x=o==null?void 0:o.baseConfig)==null||x.placementType,(S=o==null?void 0:o.baseConfig)!=null&&S.floatHeight,c.jsxs(c.Fragment,{children:[g&&c.jsx(I1,{...m,isDragging:a,isEditMode:l,children:!a&&c.jsx(Zh,{modelConfig:m.modelConfig,height:m.height,innerWidth:m.innerWidth,depth:m.depth,adjustedDepthForShelves:m.adjustedDepthForShelves,basicThickness:m.basicThickness,shelfZOffset:m.shelfZOffset,material:m.material,calculateSectionHeight:m.calculateSectionHeight,renderMode:y})}),i&&o&&!(p&&p.hasColumn&&(p.columnType==="deep"||f!==void 0))&&c.jsx(tu,{moduleWidth:h||n.dimensions.width,moduleDepth:m.actualDepthMm,hingePosition:s,spaceInfo:o,color:m.doorColor,isDragging:a,isEditMode:l,moduleData:n,originalSlotWidth:u,slotCenterX:A||0,slotIndex:d})]})},The=({moduleData:n,color:e,internalHeight:t,hasDoor:i,customDepth:r,hingePosition:s="right",spaceInfo:o,isDragging:a=!1,isEditMode:l=!1,doorWidth:h,doorXOffset:u=0,originalSlotWidth:d,slotIndex:A,slotCenterX:f,slotWidths:p,showFurniture:g=!0,adjacentCabinets:v,adjustedWidth:w})=>{var b,D;const{indirectLightEnabled:m,indirectLightIntensity:y}=Wi(),x=Dd(n,{color:e,internalHeight:t,customDepth:r,isDragging:a,isEditMode:l,adjustedWidth:w,slotWidths:p}),{renderMode:S}=cr(),I=((b=o==null?void 0:o.baseConfig)==null?void 0:b.placementType)==="float",j=((D=o==null?void 0:o.baseConfig)==null?void 0:D.floatHeight)||0,C=!1;return console.log("🔥 DualType1 간접조명 체크:",{moduleId:n.id,isFloating:I,floatHeight:j,isDragging:a,indirectLightEnabled:m,showIndirectLight:C}),c.jsxs(c.Fragment,{children:[C,g&&c.jsx(I1,{...x,isDragging:a,isEditMode:l,leftEndPanelMaterial:x.leftEndPanelMaterial,rightEndPanelMaterial:x.rightEndPanelMaterial,children:!a&&c.jsx(Zh,{modelConfig:x.modelConfig,height:x.height,innerWidth:x.innerWidth,depth:x.depth,adjustedDepthForShelves:x.adjustedDepthForShelves,basicThickness:x.basicThickness,shelfZOffset:x.shelfZOffset,material:x.material,calculateSectionHeight:x.calculateSectionHeight,renderMode:S,furnitureId:n.id})}),i&&o&&c.jsx(tu,{moduleWidth:h||n.dimensions.width,moduleDepth:x.actualDepthMm,hingePosition:s,spaceInfo:o,color:x.doorColor,moduleData:n,originalSlotWidth:d,slotCenterX:f,slotWidths:p,isDragging:a,isEditMode:l,slotIndex:A})]})},Bhe=({moduleData:n,color:e,internalHeight:t,hasDoor:i,customDepth:r,hingePosition:s="right",spaceInfo:o,isDragging:a=!1,isEditMode:l=!1,doorWidth:h,originalSlotWidth:u,slotIndex:d,slotCenterX:A,slotWidths:f,showFurniture:p=!0,adjacentCabinets:g,adjustedWidth:v})=>{var Y,K;const{indirectLightEnabled:w,indirectLightIntensity:m}=Wi(),y=Dd(n,{color:e,internalHeight:t,customDepth:r,isDragging:a,isEditMode:l,adjustedWidth:v,slotWidths:f}),{width:x,height:S,depth:I,innerWidth:j,innerHeight:C,basicThickness:b,backPanelThickness:D,adjustedDepthForShelves:T,shelfZOffset:k,material:B,mmToThreeUnits:E,isMultiSectionFurniture:z,getSectionHeights:te}=y,{renderMode:L,viewMode:O}=cr(),{view2DDirection:J}=Wi(),{theme:$}=Ua();return(Y=o==null?void 0:o.baseConfig)==null||Y.placementType,(K=o==null?void 0:o.baseConfig)!=null&&K.floatHeight,c.jsxs(c.Fragment,{children:[!1,p&&c.jsxs("group",{children:[z()?c.jsx(c.Fragment,{children:te().map((V,Q)=>{let X=-S/2+b;for(let se=0;se<Q;se++)X+=te()[se];const W=X+V/2-b;return c.jsxs(ci.Fragment,{children:[c.jsx(_i,{args:[b,V,I],position:[-x/2+b/2,W,0],material:B,renderMode:L,isDragging:a,isEditMode:l}),c.jsx(_i,{args:[b,V,I],position:[x/2-b/2,W,0],material:B,renderMode:L,isDragging:a,isEditMode:l}),Q<te().length-1&&c.jsx(_i,{args:[j,b,T-b],position:[0,W+V/2+b/2,b/2+k],material:B,renderMode:L,isDragging:a})]},`side-panels-${Q}`)})}):c.jsxs(c.Fragment,{children:[c.jsx(_i,{args:[b,S,I],position:[-x/2+b/2,0,0],material:B,renderMode:L,isDragging:a}),c.jsx(_i,{args:[b,S,I],position:[x/2-b/2,0,0],material:B,renderMode:L,isDragging:a})]}),c.jsx(_i,{args:[j,b,I],position:[0,S/2-b/2,0],material:B,renderMode:L,isDragging:a}),c.jsx(_i,{args:[j,b,I],position:[0,-S/2+b/2,0],material:B,renderMode:L,isDragging:a}),c.jsx(_i,{args:[j+E(10),C+E(10),D],position:[0,0,-I/2+D/2+E(17)],material:B,renderMode:L,isDragging:a,isBackPanel:!0}),!a&&c.jsx(Zh,{modelConfig:y.modelConfig,height:y.height,innerWidth:y.innerWidth,depth:y.depth,adjustedDepthForShelves:y.adjustedDepthForShelves,basicThickness:y.basicThickness,shelfZOffset:y.shelfZOffset,material:y.material,calculateSectionHeight:y.calculateSectionHeight,renderMode:L})]}),i&&o&&c.jsx(tu,{moduleWidth:h||n.dimensions.width,moduleDepth:y.actualDepthMm,hingePosition:s,spaceInfo:o,color:y.doorColor,moduleData:n,originalSlotWidth:u,slotCenterX:A,slotWidths:f,isDragging:a,isEditMode:l,slotIndex:d})]})},Ehe=({moduleData:n,color:e,internalHeight:t,hasDoor:i,customDepth:r,hingePosition:s="right",spaceInfo:o,isDragging:a=!1,isEditMode:l=!1,doorWidth:h,originalSlotWidth:u,slotIndex:d,slotCenterX:A,slotWidths:f,showFurniture:p=!0,adjacentCabinets:g,adjustedWidth:v})=>{var Y,K;const w=Dd(n,{color:e,internalHeight:t,customDepth:r,isDragging:a,isEditMode:l,adjustedWidth:v,slotWidths:f}),{width:m,height:y,depth:x,innerWidth:S,innerHeight:I,basicThickness:j,backPanelThickness:C,adjustedDepthForShelves:b,shelfZOffset:D,material:T,mmToThreeUnits:k,isMultiSectionFurniture:B,getSectionHeights:E}=w,{renderMode:z}=cr(),{viewMode:te,view2DDirection:L,indirectLightEnabled:O,indirectLightIntensity:J}=Wi(),{theme:$}=Ua();return(Y=o==null?void 0:o.baseConfig)==null||Y.placementType,(K=o==null?void 0:o.baseConfig)!=null&&K.floatHeight,c.jsxs(c.Fragment,{children:[!1,p&&c.jsxs("group",{children:[B()?c.jsx(c.Fragment,{children:E().map((V,Q)=>{let X=-y/2+j;for(let se=0;se<Q;se++)X+=E()[se];const W=X+V/2-j;return c.jsxs(ci.Fragment,{children:[c.jsx(_i,{args:[j,V,x],position:[-m/2+j/2,W,0],material:T,renderMode:z,isDragging:a,isEditMode:l}),c.jsx(_i,{args:[j,V,x],position:[m/2-j/2,W,0],material:T,renderMode:z,isDragging:a,isEditMode:l}),Q<E().length-1&&c.jsx(_i,{args:[S,j,b-j],position:[0,W+V/2+j/2,j/2+D],material:T,renderMode:z,isDragging:a,isEditMode:l})]},`side-panels-${Q}`)})}):c.jsxs(c.Fragment,{children:[c.jsx(_i,{args:[j,y,x],position:[-m/2+j/2,0,0],material:T,renderMode:z,isDragging:a,isEditMode:l}),c.jsx(_i,{args:[j,y,x],position:[m/2-j/2,0,0],material:T,renderMode:z,isDragging:a,isEditMode:l})]}),c.jsx(_i,{args:[S,j,x],position:[0,y/2-j/2,0],material:T,renderMode:z,isDragging:a,isEditMode:l}),c.jsx(_i,{args:[S,j,x],position:[0,-y/2+j/2,0],material:T,renderMode:z,isDragging:a,isEditMode:l}),c.jsx(_i,{args:[S+k(10),I+k(10),C],position:[0,0,-x/2+C/2+k(17)],material:T,renderMode:z,isDragging:a,hideEdges:!1,isBackPanel:!0}),!a&&c.jsx(Zh,{modelConfig:w.modelConfig,height:w.height,innerWidth:w.innerWidth,depth:w.depth,adjustedDepthForShelves:w.adjustedDepthForShelves,basicThickness:w.basicThickness,shelfZOffset:w.shelfZOffset,material:w.material,calculateSectionHeight:w.calculateSectionHeight,renderMode:z})]}),i&&o&&c.jsx(tu,{moduleWidth:h||n.dimensions.width,moduleDepth:w.actualDepthMm,hingePosition:s,spaceInfo:o,color:w.doorColor,moduleData:n,originalSlotWidth:u,slotCenterX:A,slotWidths:f,isDragging:a,isEditMode:l,slotIndex:d})]})},Fhe=({moduleData:n,color:e,internalHeight:t,hasDoor:i,customDepth:r,hingePosition:s="right",spaceInfo:o,isDragging:a=!1,isEditMode:l=!1,doorWidth:h,originalSlotWidth:u,slotIndex:d,slotCenterX:A,slotWidths:f,showFurniture:p=!0,adjacentCabinets:g,adjustedWidth:v})=>{var _e,ue;const w=Dd(n,{color:e,internalHeight:t,customDepth:r,isDragging:a,isEditMode:l,adjustedWidth:v,slotWidths:f}),{width:m,height:y,innerWidth:x,innerHeight:S,basicThickness:I,backPanelThickness:j,material:C,calculateSectionHeight:b,mmToThreeUnits:D,modelConfig:T}=w,{viewMode:k,view2DDirection:B,showDimensions:E,indirectLightEnabled:z,indirectLightIntensity:te}=Wi(),{theme:L}=Ua(),{renderMode:O}=cr(),J=(_e=o==null?void 0:o.baseConfig)==null?void 0:_e.placementType,$=J==="float",U=((ue=o==null?void 0:o.baseConfig)==null?void 0:ue.floatHeight)||0,Y=k==="2D"||k!=="3D",K=!1,Q=-w.height/2-.5;console.log("🔥 DualType5 간접조명 계산:",{moduleId:n.id,hasSpaceInfo:!!o,baseConfig:o==null?void 0:o.baseConfig,placementType:J,isFloating:$,floatHeight:U,isDragging:a,indirectLightEnabled:z,is2DMode:Y,showIndirectLight:K,lightY:Q});const W=k==="3D"?getComputedStyle(document.documentElement).getPropertyValue("--theme-primary").trim()||"#10b981":"#4CAF50",se=k==="3D"?.45:.32,q=T.rightAbsoluteWidth;let de,Ce,Se,fe;q?(Ce=D(q),de=x-Ce-I,Se=-(Ce+I)/2,fe=(de+I)/2):(de=x/2,Ce=x/2,Se=-x/4,fe=x/4);const M=T.rightAbsoluteDepth;let Z,Ae,ie,ee;M?(ie=r||600,Z=D(ie),ee=M,Ae=D(ee)):(ie=ee=r||600,Z=Ae=D(ie));const ae=()=>{const Be=T.leftSections||[];if(Be.length===0)return[y-I*2];const it=y-I*2,qe=Be.filter(Me=>Me.heightType==="absolute").reduce((Me,et)=>Me+b(et,it),0),Je=it-qe;return Be.map(Me=>Me.heightType==="absolute"?b(Me,it):b(Me,Je))},me=()=>{const Be=T.leftSections||[],it=T.rightSections||[];if(Be.length===0&&it.length===0)return null;const De=Z-I,qe=I/2,Je=D(642),Me=D(18)/2+(Z-Ae)/2,et=()=>{if(Be.length===0)return null;const ze=y-I*2,ke=Be.filter(Ee=>Ee.heightType==="absolute").reduce((Ee,Le)=>Ee+b(Le,ze),0),je=ze-ke,rt=Be.map(Ee=>({...Ee,calculatedHeight:Ee.heightType==="absolute"?b(Ee,ze):b(Ee,je)}));let _t=-y/2+I;return rt.map((Ee,Le)=>{const ye=Ee.calculatedHeight,Ze=_t+ye/2;let nt=null;switch(Ee.type){case"shelf":Ee.count&&Ee.count>0&&(nt=c.jsx(vm,{shelfCount:Ee.count,innerWidth:de,innerHeight:ye,depth:De,basicThickness:I,material:C,yOffset:Ze,zOffset:qe,shelfPositions:Ee.shelfPositions,isTopFinishPanel:Ee.isTopFinishPanel,renderMode:cr().renderMode,furnitureId:n.id}));break;case"hanging":Ee.count&&Ee.count>0?nt=c.jsx(vm,{shelfCount:Ee.count,innerWidth:de,innerHeight:ye,depth:De,basicThickness:I,material:C,yOffset:Ze,zOffset:qe,shelfPositions:Ee.shelfPositions,isTopFinishPanel:Ee.isTopFinishPanel,renderMode:cr().renderMode,furnitureId:n.id}):nt=null;break;case"drawer":Ee.count&&Ee.count>0&&(nt=c.jsx(wk,{drawerCount:Ee.count,innerWidth:de,innerHeight:ye,depth:Z,basicThickness:I,yOffset:Ze,drawerHeights:Ee.drawerHeights,gapHeight:Ee.gapHeight,material:C,renderMode:cr().renderMode}));break}let st=null;return Le<rt.length-1&&(st=c.jsx(_i,{args:[de,I,De-I],position:[0,Ze+ye/2-I/2,I/2+qe],material:C,renderMode:cr().renderMode,isDragging:a,isEditMode:l})),_t+=ye,c.jsxs("group",{children:[nt,st,E&&!(k==="2D"&&B==="top")&&c.jsxs(c.Fragment,{children:[Le<rt.length-1&&c.jsxs("group",{children:[k==="3D"&&c.jsx(ii,{position:[-de/2*.3-.8+.01,Ze+ye/2-I/2-.01,De/2+.1-.01],fontSize:se,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:998,children:Math.round(I*100)}),c.jsx(ii,{position:[k==="3D"?-de/2*.3-.8:-de/2*.3-.5,Ze+ye/2-I/2,k==="3D"?De/2+.1:I/2+qe+.5],fontSize:se,color:W,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,children:Math.round(I*100)}),c.jsx(lt,{points:[[-de/2*.3,Ze+ye/2-I,k==="3D"?De/2+.1:I/2+qe+.5],[-de/2*.3,Ze+ye/2,k==="3D"?De/2+.1:I/2+qe+.5]],color:W,lineWidth:1}),c.jsxs("mesh",{position:[-de/2*.3,Ze+ye/2-I,k==="3D"?De/2+.1:I/2+qe+.5],children:[c.jsx("sphereGeometry",{args:[.03,8,8]}),c.jsx("meshBasicMaterial",{color:W})]}),c.jsxs("mesh",{position:[-de/2*.3,Ze+ye/2,k==="3D"?De/2+.1:I/2+qe+.5],children:[c.jsx("sphereGeometry",{args:[.03,8,8]}),c.jsx("meshBasicMaterial",{color:W})]})]}),(Ee.type==="drawer"||Ee.type==="hanging"||Ee.type==="shelf")&&c.jsxs("group",{children:[k==="3D"&&c.jsx(ii,{position:[-de/2*.3-.8+.01,Ze-.01,De/2+.1-.01],fontSize:.45,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:998,children:Math.round(ye*100)}),c.jsx(ii,{position:[k==="3D"?-de/2*.3-.8:-de/2*.3-.5,Ze,k==="3D"?De/2+.1:I/2+qe+.5],fontSize:k==="3D"?.45:.32,color:W,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,children:Math.round(ye*100)}),c.jsx(lt,{points:[[-de/2*.3,Ze-ye/2,k==="3D"?De/2+.1:I/2+qe+.5],[-de/2*.3,Ze+ye/2-I,k==="3D"?De/2+.1:I/2+qe+.5]],color:W,lineWidth:1}),c.jsxs("mesh",{position:[-de/2*.3,Ze-ye/2,k==="3D"?De/2+.1:I/2+qe+.5],children:[c.jsx("sphereGeometry",{args:[.03,8,8]}),c.jsx("meshBasicMaterial",{color:W})]}),c.jsxs("mesh",{position:[-de/2*.3,Ze+ye/2-I,k==="3D"?De/2+.1:I/2+qe+.5],children:[c.jsx("sphereGeometry",{args:[.03,8,8]}),c.jsx("meshBasicMaterial",{color:W})]})]}),Le===0&&Ee.type==="drawer"&&c.jsxs("group",{children:[k==="3D"&&c.jsx(ii,{position:[-de/2*.3-.8+.01,-y/2+I/2-.01,De/2+.1-.01],fontSize:se,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:998,children:Math.round(I*100)}),c.jsx(ii,{position:[k==="3D"?-de/2*.3-.8:-de/2*.3-.5,-y/2+I/2,k==="3D"?De/2+.1:I/2+qe+.5],fontSize:se,color:W,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,children:Math.round(I*100)}),c.jsx(lt,{points:[[-de/2*.3,-y/2,k==="3D"?De/2+.1:I/2+qe+.5],[-de/2*.3,-y/2+I,k==="3D"?De/2+.1:I/2+qe+.5]],color:W,lineWidth:1}),c.jsxs("mesh",{position:[-de/2*.3,-y/2,k==="3D"?De/2+.1:I/2+qe+.5],children:[c.jsx("sphereGeometry",{args:[.03,8,8]}),c.jsx("meshBasicMaterial",{color:W})]}),c.jsxs("mesh",{position:[-de/2*.3,-y/2+I,k==="3D"?De/2+.1:I/2+qe+.5],children:[c.jsx("sphereGeometry",{args:[.03,8,8]}),c.jsx("meshBasicMaterial",{color:W})]})]})]})]},`left-section-${Le}`)})},He=()=>{if(it.length===0)return null;const ze=y-I*2,ke=it.filter(Ee=>Ee.heightType==="absolute").reduce((Ee,Le)=>Ee+b(Le,ze),0),je=ze-ke,rt=it.map(Ee=>({...Ee,calculatedHeight:Ee.heightType==="absolute"?b(Ee,ze):b(Ee,je)}));let _t=-y/2+I;return rt.map((Ee,Le)=>{const ye=Ee.calculatedHeight,Ze=_t+ye/2;let nt=null;switch(Ee.type){case"hanging":if(Ee.count&&Ee.count>0){const st=`${n.id}-right-section`;nt=c.jsx(vm,{shelfCount:Ee.count,innerWidth:Ce,innerHeight:ye,depth:Je,basicThickness:I,material:C,yOffset:Ze,zOffset:Me,shelfPositions:Ee.shelfPositions,isTopFinishPanel:Ee.isTopFinishPanel,renderMode:cr().renderMode,furnitureId:st})}else nt=null;break;case"shelf":Ee.count&&Ee.count>0&&(nt=c.jsx(vm,{shelfCount:Ee.count,innerWidth:Ce,innerHeight:ye,depth:Je,basicThickness:I,material:C,yOffset:Ze,zOffset:Me,shelfPositions:Ee.shelfPositions,isTopFinishPanel:Ee.isTopFinishPanel,renderMode:cr().renderMode,furnitureId:n.id}));break}return _t+=ye,c.jsxs("group",{children:[nt,E&&!(k==="2D"&&B==="top")&&c.jsxs("group",{children:[k==="3D"&&c.jsx(ii,{position:[-Ce/2*.3-.8+.01,-y/2+I/2-.01,3.01-.01],fontSize:se,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:998,children:Math.round(I*100)}),c.jsx(ii,{position:[k==="3D"?-Ce/2*.3-.8:-Ce/2*.3-.5,-y/2+I/2,k==="3D"?3.01:I/2+Me+.5],fontSize:se,color:W,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,children:Math.round(I*100)}),c.jsx(lt,{points:[[-Ce/2*.3,-y/2,k==="3D"?3.01:I/2+Me+.5],[-Ce/2*.3,-y/2+I,k==="3D"?3.01:I/2+Me+.5]],color:W,lineWidth:1}),c.jsxs("mesh",{position:[-Ce/2*.3,-y/2,k==="3D"?3.01:I/2+Me+.5],children:[c.jsx("sphereGeometry",{args:[.03,8,8]}),c.jsx("meshBasicMaterial",{color:W})]}),c.jsxs("mesh",{position:[-Ce/2*.3,-y/2+I,k==="3D"?3.01:I/2+Me+.5],children:[c.jsx("sphereGeometry",{args:[.03,8,8]}),c.jsx("meshBasicMaterial",{color:W})]}),Le===0&&c.jsxs(c.Fragment,{children:[c.jsx(lt,{points:[[-Ce/2,Ze+ye/2-I-1,k==="3D"?Je/2-.5:Me-.5],[Ce/2,Ze+ye/2-I-1,k==="3D"?Je/2-.5:Me-.5]],color:W,lineWidth:1}),k==="3D"&&c.jsx(ii,{position:[0+.01,Ze+ye/2-I-1.2-.01,Je/2-.5-.01],fontSize:se,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"top",renderOrder:998,children:Math.round(Ce*100)}),c.jsx(ii,{position:[0,Ze+ye/2-I-1.2,k==="3D"?Je/2-.5:Me-.5],fontSize:se,color:W,anchorX:"center",anchorY:"top",renderOrder:999,children:Math.round(Ce*100)}),c.jsxs("mesh",{position:[-Ce/2,Ze+ye/2-I-1,k==="3D"?Je/2-.5:Me-.5],children:[c.jsx("sphereGeometry",{args:[.03,8,8]}),c.jsx("meshBasicMaterial",{color:W})]}),c.jsxs("mesh",{position:[Ce/2,Ze+ye/2-I-1,k==="3D"?Je/2-.5:Me-.5],children:[c.jsx("sphereGeometry",{args:[.03,8,8]}),c.jsx("meshBasicMaterial",{color:W})]})]})]})]},`right-section-${Le}`)})};return c.jsxs(c.Fragment,{children:[K,c.jsx("group",{position:[Se,0,0],children:et()}),c.jsx("group",{position:[fe,0,0],children:He()}),ae().map((ze,Oe)=>{let ke=-y/2+I;for(let Ee=0;Ee<Oe;Ee++)ke+=ae()[Ee];const je=ke+ze/2-I,rt=Math.max(Z,Ae),_t=Z>Ae?0:(Z-Ae)/2;return c.jsx(_i,{args:[I,ze,rt],position:[(de-Ce)/2,je,_t],material:C,renderMode:cr().renderMode,isDragging:a,isEditMode:l},`middle-panel-${Oe}`)})]})};return c.jsxs(c.Fragment,{children:[K,p&&c.jsxs(c.Fragment,{children:[ae().map((Be,it)=>{let De=-y/2+I;for(let Je=0;Je<it;Je++)De+=ae()[Je];const qe=De+Be/2-I;return c.jsx(_i,{args:[I,Be,Z],position:[-m/2+I/2,qe,0],material:C,renderMode:cr().renderMode,isDragging:a,isEditMode:l},`left-side-panel-${it}`)}),c.jsx(_i,{args:[I,y,Ae],position:[m/2-I/2,0,(Z-Ae)/2],material:C,renderMode:cr().renderMode,isDragging:a,isEditMode:l}),c.jsxs(c.Fragment,{children:[c.jsx(_i,{args:[de,I,Z],position:[Se,y/2-I/2,0],material:C,renderMode:cr().renderMode,isDragging:a,isEditMode:l}),c.jsx(_i,{args:[Ce,I,Ae],position:[fe,y/2-I/2,(Z-Ae)/2],material:C,renderMode:cr().renderMode,isDragging:a,isEditMode:l})]}),c.jsxs(c.Fragment,{children:[c.jsx(_i,{args:[de,I,Z],position:[Se,-y/2+I/2,0],material:C,renderMode:cr().renderMode,isDragging:a,isEditMode:l}),c.jsx(_i,{args:[Ce,I,Ae],position:[fe,-y/2+I/2,(Z-Ae)/2],material:C,renderMode:cr().renderMode,isDragging:a,isEditMode:l})]}),c.jsxs(c.Fragment,{children:[c.jsx(_i,{args:[de+D(10),S+D(10),j],position:[Se,0,-Z/2+j/2+D(17)],material:C,renderMode:cr().renderMode,isDragging:a,isEditMode:l,hideEdges:!1,isBackPanel:!0}),c.jsx(_i,{args:[Ce+D(10),S+D(10),j],position:[fe,0,-Ae/2+j/2+D(17)+(Z-Ae)/2],material:C,renderMode:cr().renderMode,isDragging:a,isEditMode:l,hideEdges:!1,isBackPanel:!0})]}),!a&&me()]}),i&&o&&c.jsx(tu,{moduleWidth:h||n.dimensions.width,moduleDepth:w.actualDepthMm,hingePosition:s,spaceInfo:o,color:w.doorColor,moduleData:n,originalSlotWidth:u,slotCenterX:A,slotWidths:f,isDragging:a,isEditMode:l,slotIndex:d})]})},khe=({moduleData:n,color:e,internalHeight:t,hasDoor:i,customDepth:r,hingePosition:s="right",spaceInfo:o,isDragging:a=!1,isEditMode:l=!1,doorWidth:h,originalSlotWidth:u,slotIndex:d,slotCenterX:A,slotWidths:f,showFurniture:p=!0,adjacentCabinets:g,adjustedWidth:v})=>{var w,m;try{const y=Dd(n,{color:e,internalHeight:t,customDepth:r,isDragging:a,isEditMode:l,adjustedWidth:v,slotWidths:f,adjacentCabinets:g}),{width:x,height:S,depth:I,innerWidth:j,innerHeight:C,basicThickness:b,backPanelThickness:D,adjustedDepthForShelves:T,shelfZOffset:k,material:B,calculateSectionHeight:E,mmToThreeUnits:z,modelConfig:te}=y,L=Be=>Be*100,{viewMode:O,view2DDirection:J,showDimensions:$,indirectLightEnabled:U,indirectLightIntensity:Y}=Wi(),{theme:K}=Ua(),V=(w=o==null?void 0:o.baseConfig)==null?void 0:w.placementType,Q=V==="float",X=((m=o==null?void 0:o.baseConfig)==null?void 0:m.floatHeight)||0,W=O==="2D"||O!=="3D",se=!1,de=-y.height/2-.5;console.log("🔥 DualType6 간접조명 계산:",{moduleId:n.id,hasSpaceInfo:!!o,baseConfig:o==null?void 0:o.baseConfig,placementType:V,isFloating:Q,floatHeight:X,isDragging:a,indirectLightEnabled:U,is2DMode:W,showIndirectLight:se,lightY:de});const Se=O==="3D"?getComputedStyle(document.documentElement).getPropertyValue("--theme-primary").trim()||"#10b981":"#4CAF50",fe=O==="3D"?.45:.32;let M,Z,Ae,ie;if(te.rightAbsoluteWidth){const Be=n.dimensions.width,it=te.rightAbsoluteWidth/(Be-36);Z=j*it,M=j-Z-b,Ae=-(Z+b)/2,ie=(M+b)/2}else M=j/2,Z=j/2,Ae=-j/4,ie=j/4;console.log("🔍 DualType6 좌우 분할 계산:",{moduleId:n.id,width:x,innerWidth:j,leftWidth:M,rightWidth:Z,leftXOffset:Ae,rightXOffset:ie,modelConfig:{rightAbsoluteWidth:te.rightAbsoluteWidth,hasSharedMiddlePanel:te.hasSharedMiddlePanel,leftSections:te.leftSections,rightSections:te.rightSections}});const ee=te.hasSharedMiddlePanel||!1,ae=te.middlePanelHeight||0,me=te.hasSharedSafetyShelf||!1,_e=te.safetyShelfHeight||0,ue=()=>{const Be=te.leftSections||[],it=te.rightSections||[];if(Be.length===0&&it.length===0)return null;const De=()=>{if(Be.length===0)return null;const Je=S-b*2,et=Be.filter(ke=>ke.heightType==="absolute").reduce((ke,je)=>ke+E(je,Je),0),He=Je-et,ze=Be.map(ke=>({...ke,calculatedHeight:ke.heightType==="absolute"?E(ke,Je):E(ke,He)}));let Oe=-S/2+b;return ze.map((ke,je)=>{const rt=ke.calculatedHeight,_t=Oe+rt/2;let Ee=null;switch(ke.type){case"drawer":ke.count&&ke.count>0&&(Ee=c.jsx(wk,{drawerCount:ke.count,innerWidth:M,innerHeight:rt,depth:I,basicThickness:b,yOffset:_t,drawerHeights:ke.drawerHeights,gapHeight:ke.gapHeight,material:B,renderMode:cr().renderMode}));break;case"hanging":Ee=null;break}return Oe+=rt,c.jsxs("group",{children:[Ee,$&&(ke.type==="drawer"||ke.type==="hanging")&&c.jsxs("group",{children:[ke.type==="drawer"?c.jsxs(c.Fragment,{children:[O==="3D"&&c.jsx(ii,{position:[-M/2*.3-.8+.01,(_t-rt/2+(-S/2+b+z(ae-9)-b/2))/2-.01,T/2+.1-.01],fontSize:fe,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:998,children:Math.round(L(-S/2+b+z(ae-9)-b/2-(_t-rt/2)))}),c.jsx(ii,{position:[O==="3D"?-M/2*.3-.8:-M/2*.3-.5,(_t-rt/2+(-S/2+b+z(ae-9)-b/2))/2,O==="3D"?T/2+.1:b/2+k+.5],fontSize:fe,color:Se,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,depthTest:!1,children:Math.round(L(-S/2+b+z(ae-9)-b/2-(_t-rt/2)))}),c.jsx(lt,{points:[[-M/2*.3,_t-rt/2,O==="3D"?T/2+.1:b/2+k+.5],[-M/2*.3,-S/2+b+z(ae-9)-b/2,O==="3D"?T/2+.1:b/2+k+.5]],color:Se,lineWidth:1}),c.jsxs("mesh",{position:[-M/2*.3,_t-rt/2,O==="3D"?T/2+.1:b/2+k+.5],children:[c.jsx("sphereGeometry",{args:[.02,8,8]}),c.jsx("meshBasicMaterial",{color:Se})]}),c.jsxs("mesh",{position:[-M/2*.3,-S/2+b+z(ae-9)-b/2,O==="3D"?T/2+.1:b/2+k+.5],children:[c.jsx("sphereGeometry",{args:[.02,8,8]}),c.jsx("meshBasicMaterial",{color:Se})]})]}):ke.type==="hanging"&&je===1?c.jsx(c.Fragment,{children:me?c.jsxs(c.Fragment,{children:[c.jsx(ii,{position:[-M/2*.3-.5,(-S/2+b+z(ae-9)+b/2+(-S/2+b+z(_e)-b/2))/2,O==="3D"?T/2+.1:b/2+k+.5],fontSize:fe,color:Se,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,depthTest:!1,children:Math.round(L(-S/2+b+z(_e)-b/2-(-S/2+b+z(ae-9)+b/2)))}),c.jsx(lt,{points:[[-M/2*.3,-S/2+b+z(ae-9)+b/2,O==="3D"?T/2+.1:b/2+k+.5],[-M/2*.3,-S/2+b+z(_e)-b/2,O==="3D"?T/2+.1:b/2+k+.5]],color:Se,lineWidth:1}),c.jsxs("mesh",{position:[-M/2*.3,-S/2+b+z(ae-9)+b/2,O==="3D"?T/2+.1:b/2+k+.5],children:[c.jsx("sphereGeometry",{args:[.02,8,8]}),c.jsx("meshBasicMaterial",{color:Se})]}),c.jsxs("mesh",{position:[-M/2*.3,-S/2+b+z(_e)-b/2,O==="3D"?T/2+.1:b/2+k+.5],children:[c.jsx("sphereGeometry",{args:[.02,8,8]}),c.jsx("meshBasicMaterial",{color:Se})]}),c.jsx(ii,{position:[-M/2*.3-.5,(-S/2+b+z(_e)+b/2+(S/2-b))/2,O==="3D"?T/2+.1:b/2+k+.5],fontSize:fe,color:Se,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,depthTest:!1,children:Math.round(L(S/2-b-(-S/2+b+z(_e)+b/2)))}),c.jsx(lt,{points:[[-M/2*.3,-S/2+b+z(_e)+b/2,O==="3D"?T/2+.1:b/2+k+.5],[-M/2*.3,S/2-b,O==="3D"?T/2+.1:b/2+k+.5]],color:Se,lineWidth:1}),c.jsxs("mesh",{position:[-M/2*.3,-S/2+b+z(_e)+b/2,O==="3D"?T/2+.1:b/2+k+.5],children:[c.jsx("sphereGeometry",{args:[.02,8,8]}),c.jsx("meshBasicMaterial",{color:Se})]}),c.jsxs("mesh",{position:[-M/2*.3,S/2-b,O==="3D"?T/2+.1:b/2+k+.5],children:[c.jsx("sphereGeometry",{args:[.02,8,8]}),c.jsx("meshBasicMaterial",{color:Se})]})]}):c.jsxs(c.Fragment,{children:[c.jsx(ii,{position:[-M/2*.3-.5,_t,O==="3D"?T/2+.1:b/2+k+.5],fontSize:fe,color:Se,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,depthTest:!1,children:Math.round(L(S/2-b-(-S/2+b+z(ae-9)+b/2)))}),c.jsx(lt,{points:[[-M/2*.3,-S/2+b+z(ae-9)+b/2,O==="3D"?T/2+.1:b/2+k+.5],[-M/2*.3,S/2-b,O==="3D"?T/2+.1:b/2+k+.5]],color:Se,lineWidth:1}),c.jsxs("mesh",{position:[-M/2*.3,-S/2+b+z(ae-9)+b/2,O==="3D"?T/2+.1:b/2+k+.5],children:[c.jsx("sphereGeometry",{args:[.02,8,8]}),c.jsx("meshBasicMaterial",{color:Se})]}),c.jsxs("mesh",{position:[-M/2*.3,S/2-b,O==="3D"?T/2+.1:b/2+k+.5],children:[c.jsx("sphereGeometry",{args:[.02,8,8]}),c.jsx("meshBasicMaterial",{color:Se})]})]})}):null,je===0&&c.jsxs("group",{children:[c.jsx(ii,{position:[-M/2*.3-.5,-S/2+b/2,O==="3D"?T/2+.1:b/2+k+.5],fontSize:fe,color:Se,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,depthTest:!1,children:Math.round(L(b))}),c.jsx(lt,{points:[[-M/2*.3,-S/2,O==="3D"?T/2+.1:b/2+k+.5],[-M/2*.3,-S/2+b,O==="3D"?T/2+.1:b/2+k+.5]],color:Se,lineWidth:1}),c.jsxs("mesh",{position:[-M/2*.3,-S/2,O==="3D"?T/2+.1:b/2+k+.5],children:[c.jsx("sphereGeometry",{args:[.02,8,8]}),c.jsx("meshBasicMaterial",{color:Se})]}),c.jsxs("mesh",{position:[-M/2*.3,-S/2+b,O==="3D"?T/2+.1:b/2+k+.5],children:[c.jsx("sphereGeometry",{args:[.02,8,8]}),c.jsx("meshBasicMaterial",{color:Se})]})]})]})]},`left-section-${je}`)})},qe=()=>{if(it.length===0)return null;const Je=S-b*2,et=it.filter(Oe=>Oe.heightType==="absolute").reduce((Oe,ke)=>Oe+E(ke,Je),0),He=Je-et;return it.map(Oe=>({...Oe,calculatedHeight:Oe.heightType==="absolute"?E(Oe,Je):E(Oe,He)})).map((Oe,ke)=>{let je=null;switch(Oe.type){case"hanging":je=null;break}return c.jsx("group",{children:je},`right-section-${ke}`)})};return c.jsxs(c.Fragment,{children:[c.jsx("group",{position:[Ae,0,0],children:De()}),c.jsx("group",{position:[ie,0,0],children:qe()}),ee&&ae>0&&c.jsx(_i,{args:[b,z(ae),T-b],position:[(M-Z)/2,-S/2+b+z(ae)/2-z(18),b/2+k],material:B,renderMode:cr().renderMode,isDragging:a,isEditMode:l}),ee&&ae>0&&c.jsxs(c.Fragment,{children:[c.jsx(_i,{args:[j,b,T-b],position:[0,-S/2+b+z(ae-9),b/2+k],material:B,renderMode:cr().renderMode,isDragging:a,isEditMode:l}),$&&c.jsxs("group",{children:[c.jsx(ii,{position:[-M/2*.3-.5,-S/2+b+z(ae-9),O==="3D"?T/2+.1:b/2+k+.5],fontSize:fe,color:Se,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,depthTest:!1,children:Math.round(b/.01)}),c.jsx(lt,{points:[[-M/2*.3,-S/2+b+z(ae-9)-b/2,O==="3D"?T/2+.1:b/2+k+.5],[-M/2*.3,-S/2+b+z(ae-9)+b/2,O==="3D"?T/2+.1:b/2+k+.5]],color:Se,lineWidth:1}),c.jsxs("mesh",{position:[-M/2*.3,-S/2+b+z(ae-9)-b/2,O==="3D"?T/2+.1:b/2+k+.5],children:[c.jsx("sphereGeometry",{args:[.02,8,8]}),c.jsx("meshBasicMaterial",{color:Se})]}),c.jsxs("mesh",{position:[-M/2*.3,-S/2+b+z(ae-9)+b/2,O==="3D"?T/2+.1:b/2+k+.5],children:[c.jsx("sphereGeometry",{args:[.02,8,8]}),c.jsx("meshBasicMaterial",{color:Se})]})]})]}),me&&_e>0&&c.jsxs(c.Fragment,{children:[c.jsx(_i,{args:[j,b,T-b],position:[0,-S/2+b+z(_e),b/2+k],material:B,renderMode:cr().renderMode,isDragging:a,isEditMode:l}),$&&c.jsxs("group",{children:[c.jsx(ii,{position:[-M/2*.3-.5,-S/2+b+z(_e),O==="3D"?T/2+.1:b/2+k+.5],fontSize:fe,color:Se,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,depthTest:!1,children:Math.round(b/.01)}),c.jsx(lt,{points:[[-M/2*.3,-S/2+b+z(_e)-b/2,O==="3D"?T/2+.1:b/2+k+.5],[-M/2*.3,-S/2+b+z(_e)+b/2,O==="3D"?T/2+.1:b/2+k+.5]],color:Se,lineWidth:1}),c.jsxs("mesh",{position:[-M/2*.3,-S/2+b+z(_e)-b/2,O==="3D"?T/2+.1:b/2+k+.5],children:[c.jsx("sphereGeometry",{args:[.02,8,8]}),c.jsx("meshBasicMaterial",{color:Se})]}),c.jsxs("mesh",{position:[-M/2*.3,-S/2+b+z(_e)+b/2,O==="3D"?T/2+.1:b/2+k+.5],children:[c.jsx("sphereGeometry",{args:[.02,8,8]}),c.jsx("meshBasicMaterial",{color:Se})]})]})]}),$&&c.jsxs("group",{children:[c.jsx(ii,{position:[-M/2*.3-.5,S/2-b/2,O==="3D"?T/2+.1:b/2+k+.5],fontSize:fe,color:Se,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,depthTest:!1,children:Math.round(b/.01)}),c.jsx(lt,{points:[[-M/2*.3,S/2,O==="3D"?T/2+.1:b/2+k+.5],[-M/2*.3,S/2-b,O==="3D"?T/2+.1:b/2+k+.5]],color:Se,lineWidth:1}),c.jsxs("mesh",{position:[-M/2*.3,S/2,O==="3D"?T/2+.1:b/2+k+.5],children:[c.jsx("sphereGeometry",{args:[.02,8,8]}),c.jsx("meshBasicMaterial",{color:Se})]}),c.jsxs("mesh",{position:[-M/2*.3,S/2-b,O==="3D"?T/2+.1:b/2+k+.5],children:[c.jsx("sphereGeometry",{args:[.02,8,8]}),c.jsx("meshBasicMaterial",{color:Se})]})]})]})};return console.log("🚨 DualType6 렌더링 시작:",{moduleId:n.id,showFurniture:p,isDragging:a,baseFurniture:{width:y.width,height:y.height,depth:y.depth,material:y.material}}),c.jsxs(c.Fragment,{children:[se&&c.jsx(IndirectLight,{width:y.innerWidth*1.5,depth:y.depth*1.5,intensity:Y||.8,position:[0,de,0]}),p&&c.jsxs("group",{children:[console.log("🔍 DualType6 기본 구조 렌더링:",{width:x,height:S,depth:I,innerWidth:j,innerHeight:C,basicThickness:b,leftPanelPosition:-x/2+b/2,rightPanelPosition:x/2-b/2}),c.jsx(_i,{args:[b,S,I],position:[-x/2+b/2,0,0],material:B,renderMode:cr().renderMode,isDragging:a,isEditMode:l}),c.jsx(_i,{args:[b,S,I],position:[x/2-b/2,0,0],material:B,renderMode:cr().renderMode,isDragging:a,isEditMode:l}),c.jsx(_i,{args:[j,b,I],position:[0,S/2-b/2,0],material:B,renderMode:cr().renderMode,isDragging:a,isEditMode:l}),c.jsxs(c.Fragment,{children:[c.jsx(_i,{args:[M,b,I],position:[Ae,-S/2+b/2,0],material:B,renderMode:cr().renderMode,isDragging:a}),c.jsx(_i,{args:[Z,b,I],position:[ie,-S/2+b/2,0],material:B,renderMode:cr().renderMode,isDragging:a}),$&&ee&&ae>0&&c.jsxs("group",{children:[c.jsx(lt,{points:[[(M-Z)/2+b/2,(-S/2+b+(-S/2+b+z(ae-9)))/2,O==="3D"?k+T/2:k],[x/2-b,(-S/2+b+(-S/2+b+z(ae-9)))/2,O==="3D"?k+T/2:k]],color:Se,lineWidth:1}),c.jsx(ii,{position:[((M-Z)/2+b/2+x/2-b)/2,(-S/2+b+(-S/2+b+z(ae-9)))/2-.2,O==="3D"?k+T/2:k],fontSize:fe,color:Se,anchorX:"center",anchorY:"top",renderOrder:999,depthTest:!1,children:Math.round(L(Z))}),c.jsxs("mesh",{position:[(M-Z)/2+b/2,(-S/2+b+(-S/2+b+z(ae-9)))/2,O==="3D"?k+T/2:k],children:[c.jsx("sphereGeometry",{args:[.03,8,8]}),c.jsx("meshBasicMaterial",{color:Se})]}),c.jsxs("mesh",{position:[x/2-b,(-S/2+b+(-S/2+b+z(ae-9)))/2,O==="3D"?k+T/2:k],children:[c.jsx("sphereGeometry",{args:[.03,8,8]}),c.jsx("meshBasicMaterial",{color:Se})]})]})]}),c.jsx(_i,{args:[j+z(10),C+z(10),D],position:[0,0,-I/2+D/2+z(17)],material:B,renderMode:cr().renderMode,isDragging:a,isEditMode:l,isBackPanel:!0}),!a&&ue()]}),i&&o&&c.jsx(tu,{moduleWidth:h||n.dimensions.width,moduleDepth:y.actualDepthMm,hingePosition:s,spaceInfo:o,color:y.doorColor,moduleData:n,originalSlotWidth:u,slotCenterX:A,slotWidths:f,isDragging:a,isEditMode:l,slotIndex:d})]})}catch(y){return console.error("🚨 DualType6 렌더링 에러:",y),console.error("스택 트레이스:",y.stack),console.error("모듈 데이터:",n),console.error("Props:",{color:e,internalHeight:t,hasDoor:i,customDepth:r,isDragging:a,isEditMode:l,showFurniture:p,slotWidths:f}),c.jsx("group",{})}},Nk=({width:n,height:e,depth:t,position:i,spaceInfo:r,doorColor:s,renderMode:o="solid"})=>{var u,d;const[a,l]=H.useState(!1),h=H.useMemo(()=>{var p,g;const A=new gl({color:s,metalness:0,roughness:.6,transparent:o==="wireframe",opacity:o==="wireframe"?.3:1,wireframe:o==="wireframe"}),f=((p=r==null?void 0:r.materialConfig)==null?void 0:p.interiorTexture)||((g=r==null?void 0:r.materialConfig)==null?void 0:g.doorTexture);return f&&(uA(f)&&l1(A),new A0().load(f,w=>{w.wrapS=Lu,w.wrapT=Lu,w.repeat.set(1,1),A.map=w,A.needsUpdate=!0,l(!0)},void 0,w=>{console.error("마감재 텍스처 로드 실패:",w)})),A},[s,o,(u=r==null?void 0:r.materialConfig)==null?void 0:u.interiorTexture,(d=r==null?void 0:r.materialConfig)==null?void 0:d.doorTexture]);return H.useEffect(()=>()=>{h.map&&h.map.dispose(),h.dispose()},[h]),c.jsx(_i,{args:[n,e,t],position:i,material:h,renderMode:o,hideEdges:!1})},Ihe=({moduleData:n,color:e,isDragging:t=!1,isEditMode:i=!1,internalHeight:r,hasDoor:s=!1,hasBackPanel:o=!0,customDepth:a,hingePosition:l="right",spaceInfo:h,doorWidth:u,doorXOffset:d=0,originalSlotWidth:A,slotIndex:f,slotCenterX:p,adjustedWidth:g,slotWidths:v,showFurniture:w=!0})=>{const{renderMode:m,viewMode:y}=cr(),x=Dd(n,{color:e,internalHeight:r,customDepth:a,isDragging:t,isEditMode:i,adjustedWidth:g});return c.jsxs(c.Fragment,{children:[w&&c.jsxs(c.Fragment,{children:[c.jsx(I1,{...x,isDragging:t,isEditMode:i,hasBackPanel:o,children:!t&&c.jsx(c.Fragment,{children:x.modelConfig.leftSections&&x.modelConfig.rightSections?c.jsxs(c.Fragment,{children:[c.jsx("group",{position:[-(x.innerWidth/2-x.basicThickness/2)/2-x.basicThickness/2,0,0],children:c.jsx(Zh,{modelConfig:{sections:x.modelConfig.leftSections},height:x.height,innerWidth:x.innerWidth/2-x.basicThickness/2,depth:x.depth,adjustedDepthForShelves:x.adjustedDepthForShelves,basicThickness:x.basicThickness,shelfZOffset:x.shelfZOffset,material:x.material,calculateSectionHeight:x.calculateSectionHeight,renderMode:m})}),c.jsx(_i,{args:[x.basicThickness,x.height-x.basicThickness*2,x.adjustedDepthForShelves],position:[0,0,x.shelfZOffset],material:x.material,renderMode:m}),c.jsx("group",{position:[(x.innerWidth/2-x.basicThickness/2)/2+x.basicThickness/2,0,0],children:c.jsx(Zh,{modelConfig:{sections:x.modelConfig.rightSections},height:x.height,innerWidth:x.innerWidth/2-x.basicThickness/2,depth:x.depth,adjustedDepthForShelves:x.adjustedDepthForShelves,basicThickness:x.basicThickness,shelfZOffset:x.shelfZOffset,material:x.material,calculateSectionHeight:x.calculateSectionHeight,renderMode:m})})]}):c.jsx(Zh,{modelConfig:x.modelConfig,height:x.height,innerWidth:x.innerWidth,depth:x.depth,adjustedDepthForShelves:x.adjustedDepthForShelves,basicThickness:x.basicThickness,shelfZOffset:x.shelfZOffset,material:x.material,calculateSectionHeight:x.calculateSectionHeight,renderMode:m})})}),!t&&c.jsx(Nk,{width:x.width,height:.18,depth:x.depth-.4,position:[0,-(x.height/2)-.09,.2],spaceInfo:h,doorColor:x.doorColor,renderMode:m})]}),s&&h&&c.jsx(tu,{moduleWidth:u||n.dimensions.width,moduleDepth:x.actualDepthMm,hingePosition:l,spaceInfo:h,color:x.doorColor,originalSlotWidth:A,slotCenterX:p,moduleData:n,isDragging:t,isEditMode:i,slotWidths:v,slotIndex:f})]})},Dhe=({moduleData:n,color:e,isDragging:t=!1,isEditMode:i=!1,internalHeight:r,hasDoor:s=!1,hasBackPanel:o=!0,customDepth:a,hingePosition:l="right",spaceInfo:h,doorWidth:u,doorXOffset:d=0,originalSlotWidth:A,slotIndex:f,slotCenterX:p,adjustedWidth:g,slotWidths:v,showFurniture:w=!0})=>{var E,z;const{renderMode:m,viewMode:y}=cr(),{indirectLightEnabled:x,indirectLightIntensity:S}=Wi(),I=Dd(n,{color:e,internalHeight:r,customDepth:a,isDragging:t,isEditMode:i,adjustedWidth:g}),C=((E=h==null?void 0:h.baseConfig)==null?void 0:E.placementType)==="float",b=((z=h==null?void 0:h.baseConfig)==null?void 0:z.floatHeight)||0,D=!1,T=I.height,k=0,B=k-T/2;return console.log("🏗️ 하부장 띄움 배치 조정:",{isFloating:C,floatHeight:b,originalHeight:I.height,adjustedHeight:T,cabinetYPosition:k,furnitureBottomY:B}),c.jsxs(c.Fragment,{children:[D,w&&c.jsx(c.Fragment,{children:c.jsxs("group",{position:[0,k,0],children:[c.jsx(I1,{...I,height:T,isDragging:t,isEditMode:i,hasBackPanel:o,children:!t&&c.jsx(c.Fragment,{children:I.modelConfig.leftSections&&I.modelConfig.rightSections?c.jsxs(c.Fragment,{children:[c.jsx("group",{position:[-(I.innerWidth/2-I.basicThickness/2)/2-I.basicThickness/2,0,0],children:c.jsx(Zh,{modelConfig:{sections:I.modelConfig.leftSections},height:T,innerWidth:I.innerWidth/2-I.basicThickness/2,depth:I.depth,adjustedDepthForShelves:I.adjustedDepthForShelves,basicThickness:I.basicThickness,shelfZOffset:I.shelfZOffset,material:I.material,calculateSectionHeight:I.calculateSectionHeight,renderMode:m})}),c.jsx(_i,{args:[I.basicThickness,T-I.basicThickness*2,I.adjustedDepthForShelves],position:[0,0,I.shelfZOffset],material:I.material,renderMode:m}),c.jsx("group",{position:[(I.innerWidth/2-I.basicThickness/2)/2+I.basicThickness/2,0,0],children:c.jsx(Zh,{modelConfig:{sections:I.modelConfig.rightSections},height:T,innerWidth:I.innerWidth/2-I.basicThickness/2,depth:I.depth,adjustedDepthForShelves:I.adjustedDepthForShelves,basicThickness:I.basicThickness,shelfZOffset:I.shelfZOffset,material:I.material,calculateSectionHeight:I.calculateSectionHeight,renderMode:m})})]}):c.jsx(Zh,{modelConfig:I.modelConfig,height:T,innerWidth:I.innerWidth,depth:I.depth,adjustedDepthForShelves:I.adjustedDepthForShelves,basicThickness:I.basicThickness,shelfZOffset:I.shelfZOffset,material:I.material,calculateSectionHeight:I.calculateSectionHeight,renderMode:m})})}),!t&&c.jsx(Nk,{width:I.width,height:.18,depth:I.depth,position:[0,T/2+.09,0],spaceInfo:h,doorColor:I.doorColor,renderMode:m})]})}),s&&h&&c.jsx(tu,{moduleWidth:u||n.dimensions.width,moduleDepth:I.actualDepthMm,hingePosition:l,spaceInfo:h,color:I.doorColor,originalSlotWidth:A,slotCenterX:p,moduleData:n,isDragging:t,isEditMode:i,slotWidths:v,slotIndex:f})]})},kQ=({moduleData:n,color:e,isDragging:t=!1,isEditMode:i=!1,internalHeight:r,hasDoor:s=!1,hasBackPanel:o=!0,customDepth:a,hingePosition:l="right",spaceInfo:h,doorWidth:u,doorXOffset:d=0,originalSlotWidth:A,slotCenterX:f,adjustedWidth:p,slotWidths:g,slotIndex:v,viewMode:w,renderMode:m,furnitureId:y,showFurniture:x=!0,isHighlighted:S=!1,adjacentCabinets:I,onPointerDown:j,onPointerMove:C,onPointerUp:b,onPointerOver:D,onPointerOut:T,onDoubleClick:k})=>{var L,O,J,$,U,Y,K,V;hr();const{indirectLightEnabled:B,indirectLightIntensity:E,indirectLightColor:z}=Wi();pi(Q=>Q.placedModules);const te=Dd(n,{color:e,internalHeight:r,customDepth:a,isDragging:t,isEditMode:i,adjustedWidth:p,isHighlighted:S});return n.id.includes("dual-4drawer-hanging")?c.jsx(c.Fragment,{children:c.jsx(Ehe,{moduleData:n,color:e,isDragging:t,isEditMode:i,internalHeight:r,hasDoor:s,customDepth:a,hingePosition:l,spaceInfo:h,doorWidth:u,doorXOffset:0,originalSlotWidth:A,slotCenterX:f,adjustedWidth:p,slotWidths:g,slotIndex:v,showFurniture:x,onPointerDown:j,onPointerMove:C,onPointerUp:b,onPointerOver:D,onPointerOut:T,onDoubleClick:k,furnitureId:y})}):n.id.includes("dual-2drawer-hanging")?c.jsx(c.Fragment,{children:c.jsx(The,{moduleData:n,color:e,isDragging:t,isEditMode:i,internalHeight:r,hasDoor:s,customDepth:a,hingePosition:l,spaceInfo:h,doorWidth:u,doorXOffset:0,originalSlotWidth:A,slotCenterX:f,adjustedWidth:p,slotWidths:g,slotIndex:v,showFurniture:x,onPointerDown:j,onPointerMove:C,onPointerUp:b,onPointerOver:D,onPointerOut:T,onDoubleClick:k,furnitureId:y})}):n.id.includes("dual-2hanging")?c.jsx(c.Fragment,{children:c.jsx(Bhe,{moduleData:n,color:e,isDragging:t,isEditMode:i,internalHeight:r,hasDoor:s,customDepth:a,hingePosition:l,spaceInfo:h,doorWidth:u,doorXOffset:0,originalSlotWidth:A,slotCenterX:f,adjustedWidth:p,slotWidths:g,slotIndex:v,showFurniture:x,onPointerDown:j,onPointerMove:C,onPointerUp:b,onPointerOver:D,onPointerOut:T,onDoubleClick:k,furnitureId:y})}):n.id.includes("single-4drawer-hanging")?c.jsx(c.Fragment,{children:c.jsx(She,{moduleData:n,color:e,isDragging:t,isEditMode:i,internalHeight:r,hasDoor:s,customDepth:a,hingePosition:l,spaceInfo:h,doorWidth:u,doorXOffset:0,originalSlotWidth:A,slotCenterX:f,adjustedWidth:p,slotIndex:v,showFurniture:x,furnitureId:y})}):n.id.includes("single-2drawer-hanging")?c.jsx(c.Fragment,{children:c.jsx(Che,{moduleData:n,color:e,isDragging:t,isEditMode:i,internalHeight:r,hasDoor:s,customDepth:a,hingePosition:l,spaceInfo:h,doorWidth:u,doorXOffset:0,originalSlotWidth:A,slotCenterX:f,adjustedWidth:p,slotIndex:v,showFurniture:x,isHighlighted:S,furnitureId:y})}):n.id.includes("single-2hanging")?c.jsx(c.Fragment,{children:c.jsx(_he,{moduleData:n,color:e,isDragging:t,isEditMode:i,internalHeight:r,hasDoor:s,customDepth:a,hingePosition:l,spaceInfo:h,doorWidth:u,doorXOffset:0,originalSlotWidth:A,slotCenterX:f,adjustedWidth:p,slotIndex:v,showFurniture:x,furnitureId:y})}):n.id.includes("dual-2drawer-styler")?(console.log("🔍 BoxModule: 스타일러장 렌더링 시작",{moduleId:n.id,showFurniture:x,isDragging:t,isEditMode:i,spaceInfo:{hasSpaceInfo:!!h,placementType:(L=h==null?void 0:h.baseConfig)==null?void 0:L.placementType,floatHeight:(O=h==null?void 0:h.baseConfig)==null?void 0:O.floatHeight}}),c.jsx(c.Fragment,{children:c.jsx(Fhe,{moduleData:n,color:e,isDragging:t,isEditMode:i,internalHeight:r,hasDoor:s,customDepth:a,hingePosition:l,spaceInfo:h,doorWidth:u,doorXOffset:0,originalSlotWidth:A,slotCenterX:f,adjustedWidth:p,slotWidths:g,slotIndex:v,showFurniture:x,onPointerDown:j,onPointerMove:C,onPointerUp:b,onPointerOver:D,onPointerOut:T,onDoubleClick:k,furnitureId:y})})):n.id.includes("dual-4drawer-pantshanger")?(console.log("🔍 BoxModule: 바지걸이장 렌더링 시작",{moduleId:n.id,showFurniture:x,isDragging:t,isEditMode:i,spaceInfo:{hasSpaceInfo:!!h,placementType:(J=h==null?void 0:h.baseConfig)==null?void 0:J.placementType,floatHeight:($=h==null?void 0:h.baseConfig)==null?void 0:$.floatHeight}}),c.jsx(c.Fragment,{children:c.jsx(khe,{moduleData:n,color:e,isDragging:t,isEditMode:i,internalHeight:r,hasDoor:s,customDepth:a,hingePosition:l,spaceInfo:h,doorWidth:u,doorXOffset:0,originalSlotWidth:A,slotCenterX:f,adjustedWidth:p,slotWidths:g,slotIndex:v,showFurniture:x,onPointerDown:j,onPointerMove:C,onPointerUp:b,onPointerOver:D,onPointerOut:T,onDoubleClick:k,furnitureId:y})})):n.id.includes("upper-cabinet-")||n.id.includes("dual-upper-cabinet-")?c.jsx(c.Fragment,{children:c.jsx(Ihe,{moduleData:n,color:e,isDragging:t,isEditMode:i,internalHeight:r,hasDoor:s,hasBackPanel:o,customDepth:a,hingePosition:l,spaceInfo:h,doorWidth:u,doorXOffset:0,originalSlotWidth:A,slotCenterX:f,adjustedWidth:p,slotWidths:g,slotIndex:v,showFurniture:x},`upper-${(U=h==null?void 0:h.baseConfig)==null?void 0:U.placementType}-${((Y=h==null?void 0:h.baseConfig)==null?void 0:Y.floatHeight)||0}`)}):n.id.includes("lower-cabinet-")||n.id.includes("dual-lower-cabinet-")?c.jsx(c.Fragment,{children:c.jsx(Dhe,{moduleData:n,color:e,isDragging:t,isEditMode:i,internalHeight:r,hasDoor:s,hasBackPanel:o,customDepth:a,hingePosition:l,spaceInfo:h,doorWidth:u,doorXOffset:0,originalSlotWidth:A,slotCenterX:f,adjustedWidth:p,slotWidths:g,slotIndex:v,showFurniture:x},`lower-${(K=h==null?void 0:h.baseConfig)==null?void 0:K.placementType}-${((V=h==null?void 0:h.baseConfig)==null?void 0:V.floatHeight)||0}`)}):c.jsxs(c.Fragment,{children:[x&&c.jsx(I1,{...te,isDragging:t,isEditMode:i,isHighlighted:S,children:!t&&c.jsx(Zh,{modelConfig:te.modelConfig,height:te.height,innerWidth:te.innerWidth,depth:te.depth,adjustedDepthForShelves:te.adjustedDepthForShelves,basicThickness:te.basicThickness,shelfZOffset:te.shelfZOffset,material:te.material,calculateSectionHeight:te.calculateSectionHeight,renderMode:m||cr().renderMode,furnitureId:y})}),(console.log("🚪 BoxModule 도어 체크:",{moduleId:n.id,hasDoor:s,spaceInfo:!!h,showFurniture:x,viewMode:cr().viewMode,willRenderDoor:s&&h}),s&&h?c.jsx(tu,{moduleWidth:u||n.dimensions.width,moduleDepth:te.actualDepthMm,hingePosition:l,spaceInfo:h,color:te.doorColor,doorXOffset:d,originalSlotWidth:A,slotCenterX:f,slotWidths:g,slotIndex:v,moduleData:n,isDragging:t,isEditMode:i}):null)]})},um=({size:n=16,color:e="currentColor",className:t})=>c.jsx("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:c.jsx("path",{d:"M10 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-8l-2-2z",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),Vh=({size:n=16,color:e="currentColor",className:t})=>c.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[c.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("circle",{cx:"12",cy:"7",r:"4",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),lE=({size:n=16,color:e="currentColor",className:t})=>c.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[c.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("polyline",{points:"12,6 12,12 16,14",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),jhe=({size:n=16,color:e="currentColor",className:t})=>c.jsx("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:c.jsx("polygon",{points:"12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),Yy=({size:n=16,color:e="currentColor",className:t})=>c.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[c.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("circle",{cx:"9",cy:"7",r:"4",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),xm=({size:n=16,color:e="currentColor",className:t})=>c.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[c.jsx("polyline",{points:"3,6 5,6 21,6",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2m3 0v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6h14z",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),Phe=({size:n=16,color:e="currentColor",className:t})=>c.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[c.jsx("circle",{cx:"13.5",cy:"6.5",r:".5",fill:e}),c.jsx("circle",{cx:"17.5",cy:"10.5",r:".5",fill:e}),c.jsx("circle",{cx:"8.5",cy:"7.5",r:".5",fill:e}),c.jsx("circle",{cx:"6.5",cy:"12.5",r:".5",fill:e}),c.jsx("path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),Xj=({size:n=16,color:e="currentColor",className:t})=>c.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[c.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("circle",{cx:"12",cy:"12",r:"3",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),Ky=({size:n=16,color:e="currentColor",className:t})=>c.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[c.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),IQ=({size:n=16,color:e="currentColor",className:t})=>c.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[c.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),Lk=({size:n=16,color:e="currentColor",className:t})=>c.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[c.jsx("circle",{cx:"12",cy:"12",r:"3",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),Eg=({size:n=16,color:e="currentColor",className:t})=>c.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[c.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),Nhe=({size:n=16,color:e="currentColor",className:t})=>c.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[c.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("polyline",{points:"16,17 21,12 16,7",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),Lhe=({size:n=16,color:e="currentColor",className:t})=>c.jsx("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:c.jsx("polyline",{points:"6,9 12,15 18,9",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),Mhe=({size:n=16,color:e="currentColor",className:t})=>c.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[c.jsx("circle",{cx:"11",cy:"11",r:"8",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("path",{d:"M21 21l-4.35-4.35",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),Rhe=({size:n=16,color:e="currentColor",className:t})=>c.jsx("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:c.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),DQ=({size:n=16,color:e="currentColor",className:t})=>c.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[c.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),bm=({size:n=16,color:e="currentColor",className:t})=>c.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[c.jsx("circle",{cx:"18",cy:"5",r:"3",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("circle",{cx:"6",cy:"12",r:"3",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("circle",{cx:"18",cy:"19",r:"3",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),Yj=({size:n=16,color:e="currentColor",className:t})=>c.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[c.jsx("circle",{cx:"12",cy:"12",r:"5",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),Kj=({size:n=16,color:e="currentColor",className:t})=>c.jsx("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:c.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),o3=({size:n=16,color:e="currentColor",className:t})=>c.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[c.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("polyline",{points:"17,21 17,13 7,13 7,21",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("polyline",{points:"7,3 7,8 15,8",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),Uhe=({size:n=16,color:e="currentColor",className:t})=>c.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[c.jsx("rect",{x:"3",y:"4",width:"18",height:"15",rx:"2",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("rect",{x:"7",y:"8",width:"10",height:"2",rx:"1",fill:e}),c.jsx("rect",{x:"7",y:"12",width:"6",height:"1.5",rx:"0.75",fill:e})]}),Ohe=({size:n=16,color:e="currentColor",className:t})=>c.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[c.jsx("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("polyline",{points:"22,6 12,13 2,6",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),Hhe=({size:n=16,color:e="currentColor",className:t})=>c.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[c.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),Whe=({size:n=16,color:e="currentColor",className:t})=>c.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[c.jsx("path",{d:"M23 17a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("circle",{cx:"12",cy:"13",r:"4",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),zhe=({size:n=16,color:e="currentColor",className:t})=>c.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[c.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),jQ=({size:n=16,color:e="currentColor",className:t})=>c.jsx("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:c.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),PQ=({size:n=16,color:e="currentColor",className:t})=>c.jsx("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:c.jsx("path",{d:"M4 14h6m0 0v6m0-6l-7 7m17-11h-6m0 0V4m0 6l7-7",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),Qhe=({size:n=16,color:e="currentColor",className:t})=>c.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[c.jsx("rect",{x:"7",y:"3",width:"4",height:"18",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("rect",{x:"13",y:"3",width:"4",height:"18",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("line",{x1:"3",y1:"21",x2:"21",y2:"21",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]});function $he(n){const{isDragging:e=!1,isEditMode:t=!1,isDragMode:i=!1,viewMode:r="3D",view2DTheme:s="light",renderMode:o="solid"}=n;return e?$h():t?"#ff5500":i?"#ff0000":r==="2D"&&o==="wireframe"?"#ff5500":r==="2D"&&s==="dark"?"#ff6600":"#cccccc"}const Vhe=(n,e,t,i)=>{const r=pi(A=>A.updatePlacedModule),[s,o]=H.useState({isResizing:!1,startPoint:null,startWidth:n.customWidth||150,startDepth:n.customDepth||600,direction:null}),a=.01,l=H.useRef(null),h=H.useCallback(A=>{if(!e)return;A.stopPropagation();const f=A.point.clone();o({isResizing:!0,startPoint:f,startWidth:n.customWidth||150,startDepth:n.customDepth||600,direction:null}),l.current=null,window.dispatchEvent(new CustomEvent("furniture-drag-start")),document.body.style.cursor="crosshair"},[e,n.customWidth,n.customDepth]),u=H.useCallback(A=>{if(!s.isResizing||!s.startPoint)return;const f=A.point.clone(),p=f.x-s.startPoint.x,g=f.z-s.startPoint.z;if(!l.current){(Math.abs(p)>a||Math.abs(g)>a)&&(l.current=Math.abs(p)>Math.abs(g)?"horizontal":"vertical",o(v=>({...v,direction:l.current})));return}if(l.current==="horizontal"){const v=p*1e3;let w=s.startWidth+v;w=Math.max(150,Math.min(i,w)),r(n.id,{customWidth:Math.round(w)}),console.log("🔄 가구 너비 조절:",{deltaX:p.toFixed(3),startWidth:s.startWidth,newWidth:Math.round(w)})}else if(l.current==="vertical"){const v=-g*1e3;let w=s.startDepth+v;const m=Math.max(200,600-t);w=Math.max(m,Math.min(600,w));const x=w-(n.customDepth||600),S=n.position.z-x*.001/2;r(n.id,{customDepth:Math.round(w),position:{...n.position,z:S}}),console.log("🔄 가구 깊이 조절:",{deltaZ:g.toFixed(3),startDepth:s.startDepth,newDepth:Math.round(w),newZ:S.toFixed(3)})}},[s,n,t,r]),d=H.useCallback(()=>{s.isResizing&&(o({isResizing:!1,startPoint:null,startWidth:n.customWidth||150,startDepth:n.customDepth||600,direction:null}),l.current=null,document.body.style.cursor="default",window.dispatchEvent(new CustomEvent("furniture-drag-end")),console.log("✅ 크기 조절 완료:",{finalWidth:n.customWidth,finalDepth:n.customDepth}))},[s.isResizing,n]);return{isResizing:s.isResizing,resizeDirection:s.direction,handlePointerDown:h,handlePointerMove:u,handlePointerUp:d}},qj=({width:n,height:e,depth:t,position:i,spaceInfo:r,renderMode:s="solid"})=>{var h,u,d;const[o,a]=H.useState(!1),l=H.useMemo(()=>{var p,g,v;const A=new gl({color:((p=r.materialConfig)==null?void 0:p.doorColor)||"#E0E0E0",metalness:.1,roughness:.8}),f=((g=r.materialConfig)==null?void 0:g.interiorTexture)||((v=r.materialConfig)==null?void 0:v.doorTexture);return f&&(uA(f)&&l1(A),new A0().load(f,m=>{m.wrapS=Lu,m.wrapT=Lu,m.repeat.set(1,1),A.map=m,A.needsUpdate=!0,a(!0)},void 0,m=>{console.error("엔드패널 텍스처 로드 실패:",m)})),A},[(h=r.materialConfig)==null?void 0:h.doorColor,(u=r.materialConfig)==null?void 0:u.interiorTexture,(d=r.materialConfig)==null?void 0:d.doorTexture]);return H.useEffect(()=>()=>{l.map&&l.map.dispose(),l.dispose()},[l]),c.jsx(_i,{isEndPanel:!0,args:[n,e,t],position:i,material:l,renderMode:s})},eh=18,Ghe=(n,e,t)=>{var f,p,g,v,w;const i=Zi(n.moduleId,Kr(t),t);if(!i)return{hasAdjacentUpperLower:!1,adjacentSide:null};const r=(f=n.moduleId)==null?void 0:f.includes("dual-");if(console.log("🔍 checkAdjacentUpperLowerToFull 시작:",{moduleId:n.moduleId,category:i.category,isDualCabinet:r,slotIndex:n.slotIndex}),i.category!=="full"&&!r)return console.log("❌ 키큰장/듀얼이 아니므로 처리 안함"),{hasAdjacentUpperLower:!1,adjacentSide:null};const s=n.slotIndex;if(s===void 0)return{hasAdjacentUpperLower:!1,adjacentSide:null};const o=r||n.isDualSlot;let a=n.zone;(p=t.droppedCeiling)!=null&&p.enabled&&a&&console.log("🏗️ Zone 확인:",{currentModule:n.moduleId,currentSlotIndex:s,currentZone:a,droppedPosition:t.droppedCeiling.position||"right"});let l=e.find(m=>m.slotIndex===s-1),h=o?e.find(m=>m.slotIndex===s+2):e.find(m=>m.slotIndex===s+1);if(a&&((g=t.droppedCeiling)!=null&&g.enabled)){if(l){const m=l.zone;m!==a&&(console.log("🚫 왼쪽 모듈이 다른 zone에 있음 - 인접하지 않음:",{current:n.moduleId,currentZone:a,leftModule:l.moduleId,leftZone:m,leftSlotIndex:l.slotIndex}),l=void 0)}if(h){const m=h.zone;m!==a&&(console.log("🚫 오른쪽 모듈이 다른 zone에 있음 - 인접하지 않음:",{current:n.moduleId,currentZone:a,rightModule:h.moduleId,rightZone:m,rightSlotIndex:h.slotIndex}),h=void 0)}}let u=!1,d=!1;if(l){const m=Zi(l.moduleId,Kr(t),t),y=m&&(m.category==="upper"||m.category==="lower");((v=l.moduleId)==null?void 0:v.includes("dual-"))&&y&&l.isDualSlot?l.slotIndex+1===s-1&&(console.log("🔍 키큰장 왼쪽에 듀얼상하부장 감지 (듀얼의 오른쪽 슬롯):",{current:n.moduleId,leftModule:l.moduleId,isDual:o}),u=!0):y&&(console.log("🔍 듀얼/키큰장 왼쪽에 상하부장 감지:",{current:n.moduleId,leftModule:l.moduleId,isDual:o}),u=!0)}if(!u){const m=e.find(y=>y.isDualSlot&&y.slotIndex===s-2);if(m){const y=Zi(m.moduleId,Kr(t),t);y&&(y.category==="upper"||y.category==="lower")&&(console.log("🔍 키큰장 왼쪽에 듀얼상하부장 감지:",{current:n.moduleId,leftDualModule:m.moduleId}),u=!0)}}if(h){const m=Zi(h.moduleId,Kr(t),t),y=m&&(m.category==="upper"||m.category==="lower"),x=((w=h.moduleId)==null?void 0:w.includes("dual-"))&&y;y&&(console.log("🔍 듀얼/키큰장 오른쪽에 상하부장 감지:",{current:n.moduleId,rightModule:h.moduleId,isDual:o,currentSlotIndex:s,rightCheckSlot:o?s+2:s+1,isRightDualUpperLower:x}),d=!0)}const A=u&&d?{hasAdjacentUpperLower:!0,adjacentSide:"both"}:u?{hasAdjacentUpperLower:!0,adjacentSide:"left"}:d?{hasAdjacentUpperLower:!0,adjacentSide:"right"}:{hasAdjacentUpperLower:!1,adjacentSide:null};return o&&console.log("🎯 듀얼 가구 인접 체크 결과:",{currentModule:n.moduleId,currentSlotIndex:s,hasLeftAdjacent:u,hasRightAdjacent:d,adjacentSide:A.adjacentSide,leftCheckSlot:s-1,rightCheckSlot:s+2,leftAdjacentModule:l==null?void 0:l.moduleId,rightAdjacentModule:h==null?void 0:h.moduleId,allModulesSlots:e.map(m=>({id:m.moduleId,slot:m.slotIndex}))}),A},Xhe=({placedModule:n,placedModules:e,spaceInfo:t,furnitureStartY:i,isDragMode:r,isEditMode:s,isDraggingThis:o,viewMode:a,view2DDirection:l,renderMode:h,onPointerDown:u,onPointerMove:d,onPointerUp:A,onDoubleClick:f,showFurniture:p=!0,isReadOnly:g=!1})=>{var Yt,Zt,sn,vt,Ye,Gt,Wt,Vt,Jt,It,Ut,un,Sn,jt,fn,Zn,Hn,ti,ri,bi,Ni,ui,si,Li,Tr,xr,br,vn,wi,Ve,ct,mt,An,nn,zt,gn,Jn,Qn,pn,Ln,Dn,ei,xi,Yi,Bn,Ri;ci.useEffect(()=>{var xt,Bt;(n.moduleId.includes("dual-4drawer-pantshanger")||n.moduleId.includes("dual-2drawer-styler"))&&console.log("🎯 FurnitureItem - furnitureStartY 변경 감지:",{moduleId:n.moduleId,furnitureStartY:i,baseConfig:t==null?void 0:t.baseConfig,placementType:(xt=t==null?void 0:t.baseConfig)==null?void 0:xt.placementType,floatHeight:(Bt=t==null?void 0:t.baseConfig)==null?void 0:Bt.floatHeight})},[i,(Yt=t==null?void 0:t.baseConfig)==null?void 0:Yt.placementType,(Zt=t==null?void 0:t.baseConfig)==null?void 0:Zt.floatHeight,n.moduleId]);const[v,w]=ci.useState(!1);ci.useEffect(()=>{var Bt,on,ln,li;w(!0);const xt=setTimeout(()=>w(!1),0);return console.log("🔄 단내림/띄움 설정 변경 감지:",{zone:n.zone,droppedCeilingEnabled:(Bt=t.droppedCeiling)==null?void 0:Bt.enabled,dropHeight:(on=t.droppedCeiling)==null?void 0:on.dropHeight,placementType:(ln=t.baseConfig)==null?void 0:ln.placementType,floatHeight:(li=t.baseConfig)==null?void 0:li.floatHeight,furnitureStartY:i}),()=>clearTimeout(xt)},[(sn=t.droppedCeiling)==null?void 0:sn.enabled,(vt=t.droppedCeiling)==null?void 0:vt.dropHeight,(Ye=t.droppedCeiling)==null?void 0:Ye.position,(Gt=t.droppedCeiling)==null?void 0:Gt.width,(Wt=t.baseConfig)==null?void 0:Wt.placementType,(Vt=t.baseConfig)==null?void 0:Vt.floatHeight,(Jt=t.baseConfig)==null?void 0:Jt.type,(It=t.gapConfig)==null?void 0:It.left,(Ut=t.gapConfig)==null?void 0:Ut.right,n.zone,i]);const{gl:m,invalidate:y,scene:x,camera:S}=fh(),{isFurnitureDragging:I,showDimensions:j,view2DTheme:C,highlightedCompartment:b}=Wi(),{updatePlacedModule:D}=pi(),[T,k]=ci.useState(!1),B=b===n.id;ci.useEffect(()=>{B&&console.log("🔆 가구 강조됨:",{moduleId:n.id,highlightedCompartment:b,isHighlighted:B})},[B,n.id,b]),ci.useEffect(()=>{y(),m&&m.shadowMap&&(m.shadowMap.needsUpdate=!0,setTimeout(()=>{m.shadowMap.needsUpdate=!0,y()},100),setTimeout(()=>{m.shadowMap.needsUpdate=!0,y()},300))},[n.position.x,n.position.y,n.position.z,n.id,y,m]);const[E,z]=ci.useState(!1),te=()=>getComputedStyle(document.documentElement).getPropertyValue("--theme-primary").trim()||"#10b981";let L=Kr(t),O=t;if((un=t.droppedCeiling)!=null&&un.enabled&&n.zone){const xt=ar.calculateZoneSlotInfo(t,t.customColumnCount),Bt=n.zone==="dropped"&&xt.dropped?xt.dropped:xt.normal,on=((Sn=t.droppedCeiling)==null?void 0:Sn.width)||DEFAULT_DROPPED_CEILING_VALUES.WIDTH;let ln;n.zone==="dropped"?ln=on:ln=t.width-on,O={...t,width:ln,zone:n.zone},L=Kr(O),L.startX=Bt.startX,n.zone==="dropped"&&console.log("🏗️ [FurnitureItem] 단내림 구간 내경 공간:",{zone:n.zone,internalHeight:L.height,dropHeight:((jt=t.droppedCeiling)==null?void 0:jt.dropHeight)||200,customHeight:n.customHeight})}console.log("🔍 [FurnitureItem] getModuleById 호출:",{moduleId:n.moduleId,customWidth:n.customWidth,zone:n.zone,internalSpace:L,surroundType:t.surroundType,moduleIdEndsWithCustomWidth:n.moduleId.endsWith(`-${n.customWidth}`)});let J=n.moduleId;n.adjustedWidth?console.log("🔧 [FurnitureItem] 기둥 침범 - 원본 모듈 사용, 폭은 렌더링 시 조정:",{moduleId:n.moduleId,adjustedWidth:n.adjustedWidth,renderWidth:n.adjustedWidth}):n.customWidth&&!n.adjustedWidth?(fn=t.droppedCeiling)!=null&&fn.enabled?t.surroundType==="surround"?(J=`${n.moduleId.replace(/-\d+$/,"")}-${n.customWidth}`,console.log("🔧 [FurnitureItem] 서라운드 모드 - customWidth로 ModuleID 생성 (단내림 있음):",{original:n.moduleId,customWidth:n.customWidth,newTargetModuleId:J,surroundType:t.surroundType})):(console.error("❌ [FurnitureItem] 노서라운드 모드에서 customWidth가 설정됨 - 이는 버그입니다 (단내림 있음):",{moduleId:n.moduleId,customWidth:n.customWidth,surroundType:t.surroundType}),J=n.moduleId):(J=`${n.moduleId.replace(/-\d+$/,"")}-${n.customWidth}`,console.log("🔧 [FurnitureItem] 8월28일 로직 - customWidth로 ModuleID 생성 (단내림 없음):",{original:n.moduleId,customWidth:n.customWidth,newTargetModuleId:J,surroundType:t.surroundType,droppedCeilingEnabled:!1})):console.log("🔍 [FurnitureItem] 원본 모듈 ID 사용:",{moduleId:n.moduleId,customWidth:n.customWidth,adjustedWidth:n.adjustedWidth,surroundType:t.surroundType,reason:n.customWidth?"unknown":"노서라운드 또는 기본 모듈"});const $=Zi(J,L,O);ci.useEffect(()=>{$?z(!1):(console.error("❌ [FurnitureItem] 모듈을 찾을 수 없음:",{targetModuleId:J,originalModuleId:n.moduleId,adjustedWidth:n.adjustedWidth,customWidth:n.customWidth}),z(!0))},[$,J,n.moduleId,n.adjustedWidth,n.customWidth]),$&&console.log("✅ [FurnitureItem] 찾은 모듈:",{targetModuleId:J,originalModuleId:n.moduleId,moduleId:$.id,moduleWidth:$.dimensions.width,moduleHeight:$.dimensions.height,customWidth:n.customWidth,expectedWidth:n.customWidth||$.dimensions.width,placedModuleId:n.moduleId,idContainsWidth:n.moduleId.match(/-(\d+)$/),zone:n.zone,internalSpaceHeight:L.height});const U=xt=>xt*.01,Y=ci.useMemo(()=>{var Bt,on;const xt=Ih(t);return(Bt=t.droppedCeiling)!=null&&Bt.enabled&&console.log("🔍 [FurnitureItem] analyzeColumnSlots 결과 (단내림):",{totalSlots:xt.length,allSlots:xt.map((ln,li)=>({globalIndex:li,slotIndex:ln.slotIndex,hasColumn:ln.hasColumn,columnType:ln.columnType,availableWidth:ln.availableWidth})),slotsWithColumns:xt.filter(ln=>ln.hasColumn).map(ln=>({index:ln.slotIndex,columnType:ln.columnType,availableWidth:ln.availableWidth})),columns:(on=t.columns)==null?void 0:on.map(ln=>({id:ln.id,position:ln.position,width:ln.width})),moduleInfo:{moduleId:n.moduleId,zone:n.zone,localSlotIndex:n.slotIndex}}),xt},[t,t.columns,n.id,n.slotIndex]);let K=n.slotIndex;if((Zn=t.droppedCeiling)!=null&&Zn.enabled&&n.zone){const xt=ar.calculateZoneSlotInfo(t,t.customColumnCount);t.droppedCeiling.position==="left"?n.zone==="normal"&&(K=n.slotIndex+xt.dropped.columnCount):n.zone==="dropped"&&(K=n.slotIndex+xt.normal.columnCount),console.log("🔍 [FurnitureItem] globalSlotIndex 계산:",{zone:n.zone,localIndex:n.slotIndex,globalIndex:K,droppedPosition:t.droppedCeiling.position,normalCount:xt.normal.columnCount,droppedCount:xt.dropped.columnCount})}let V;if((Hn=t.droppedCeiling)!=null&&Hn.enabled&&n.zone){const xt=ar.calculateZoneSlotInfo(t,t.customColumnCount),Bt=n.zone==="dropped"&&xt.dropped?xt.dropped:xt.normal,on=Array(Bt.columnCount).fill(Bt.columnWidth);if(Y){let hi=0;t.droppedCeiling.position==="left"?n.zone==="dropped"?hi=0:hi=xt.dropped.columnCount:n.zone==="dropped"?hi=xt.normal.columnCount:hi=0,console.log("🔍 [FurnitureItem] 단내림 기둥 조정 체크:",{zone:n.zone,slotIndex:n.slotIndex,startIdx:hi,targetZoneColumnCount:Bt.columnCount,droppedPosition:t.droppedCeiling.position,columnSlotsLength:Object.keys(Y).length});for(let Ii=0;Ii<Bt.columnCount;Ii++){const kr=hi+Ii,zr=Y[kr];if(zr&&zr.hasColumn){const Us=on[Ii];on[Ii]=zr.availableWidth||Bt.columnWidth,console.log("🔧 [FurnitureItem] 슬롯 너비 조정:",{localIdx:Ii,globalIdx:kr,hasColumn:!0,columnType:zr.columnType,originalWidth:Us,adjustedWidth:on[Ii],availableWidth:zr.availableWidth})}}}const ln=[];let li=Bt.startX/1e3;for(let hi=0;hi<Bt.columnCount;hi++){const Ii=((ti=Bt.slotWidths)==null?void 0:ti[hi])||Bt.columnWidth,kr=li+Ii/1e3/2;ln.push(kr),li+=Ii/1e3}V={columnCount:Bt.columnCount,columnWidth:Bt.columnWidth,slotWidths:Bt.slotWidths||on,threeUnitPositions:ln,threeUnitDualPositions:{},threeUnitBoundaries:[]}}else V=pr(O);const Q=K!==void 0?Y.find(xt=>xt.slotIndex===K):void 0;K!==void 0&&console.log("🎯 [FurnitureItem] slotInfo 찾기:",{moduleId:n.moduleId,zone:n.zone,localSlotIndex:n.slotIndex,globalSlotIndex:K,columnSlotsLength:Y.length,columnSlotsIndices:Y.map(xt=>xt.slotIndex),slotInfo:Q?{slotIndex:Q.slotIndex,hasColumn:Q.hasColumn,columnType:Q.columnType,availableWidth:Q.availableWidth}:"undefined - slotInfo를 찾을 수 없음",hasDroppedCeiling:(ri=t.droppedCeiling)==null?void 0:ri.enabled,surroundType:t.surroundType});const X=(Q==null?void 0:Q.columnType)==="medium"||!1,W=($==null?void 0:$.dimensions.width)||600;let se=!1;(bi=t.droppedCeiling)!=null&&bi.enabled&&console.log("🚨 [FurnitureItem] 단내림 슬롯 상세 정보:",{moduleId:n.moduleId,zone:n.zone,localSlotIndex:n.slotIndex,globalSlotIndex:K,slotInfo:Q?{hasColumn:Q.hasColumn,columnType:Q.columnType,availableWidth:Q.availableWidth,adjustedWidth:Q.adjustedWidth}:"undefined",placedModuleData:{adjustedWidth:n.adjustedWidth,customWidth:n.customWidth,moduleWidth:$==null?void 0:$.dimensions.width},hasColumnEvidence:se,doorWillRender:{hasDoor:n.hasDoor??!0,hasColumn:Q==null?void 0:Q.hasColumn,coverDoorCondition:!I&&!o&&(n.hasDoor??!0)&&se,normalDoorCondition:!se,willRenderCoverDoor:!I&&!o&&(n.hasDoor??!0)&&se},indexingSlotWidths:V.slotWidths,willShrink:(Q==null?void 0:Q.hasColumn)&&(Q==null?void 0:Q.availableWidth)<(((Ni=V.slotWidths)==null?void 0:Ni[n.slotIndex])||V.columnWidth)});let q=$;if(!I&&Q&&Q.hasColumn&&!X&&$){const xt=Yoe($,Q,t);xt.shouldConvert&&xt.convertedModuleData&&(q=xt.convertedModuleData)}!I&&X&&$&&$.id.includes("dual-")&&(q={...$,id:$.id.replace("dual-","single-"),name:$.name.replace("듀얼","싱글"),dimensions:{...$.dimensions,width:Q!=null&&Q.subSlots?n.subSlotPosition==="left"?Q.subSlots.left.availableWidth:Q.subSlots.right.availableWidth:V.columnWidth/2}});const de=n.isDualSlot!==void 0?n.isDualSlot:(q==null?void 0:q.id.includes("dual-"))||!1,Ce=q?Ghe(n,e,t):{hasAdjacentUpperLower:!1,adjacentSide:null},Se=Ce.hasAdjacentUpperLower,fe=Ce.adjacentSide;de&&q&&console.log("🔍 듀얼 가구 인접 체크:",{moduleId:n.moduleId,slotIndex:n.slotIndex,isDualFurniture:de,category:q.category,adjacentCheck:Ce,needsEndPanelAdjustment:Se});let M=(q==null?void 0:q.dimensions.width)||600;n.adjustedWidth!==void 0&&n.adjustedWidth!==null?(M=n.adjustedWidth,console.log("📐 adjustedWidth 사용 (기둥 침범):",M)):Q&&Q.hasColumn&&Q.availableWidth?(M=Q.availableWidth,console.log("📐 기둥 슬롯 - availableWidth 사용:",{width:M,slotIndex:K,zone:n.zone,hasDroppedCeiling:(ui=t.droppedCeiling)==null?void 0:ui.enabled})):V.slotWidths&&n.slotIndex!==void 0&&V.slotWidths[n.slotIndex]!==void 0?de&&n.slotIndex<V.slotWidths.length-1?(M=V.slotWidths[n.slotIndex]+V.slotWidths[n.slotIndex+1],console.log("📐 듀얼 캐비넷 - 슬롯 너비 사용:",M,"(두 슬롯 합계)")):(M=V.slotWidths[n.slotIndex],console.log("📐 싱글 캐비넷 - 슬롯 너비 사용:",M)):n.customWidth!==void 0&&n.customWidth!==null?(M=n.customWidth,console.log("📐 customWidth 사용:",M)):console.log("📐 기본 너비 사용:",M);const Z=((si=t.droppedCeiling)==null?void 0:si.enabled)&&n.zone==="dropped",Ae=t.columns&&t.columns.length>0&&t.columns.some(xt=>{const Bt=n.position.x,on=xt.position[0];return Math.abs(Bt-on)<10});if(se=Q&&Q.hasColumn===!0||n.adjustedWidth!==void 0&&n.adjustedWidth!==null&&n.adjustedWidth<W||n.customWidth!==void 0&&n.customWidth!==null&&n.customWidth<W,(Li=t.droppedCeiling)!=null&&Li.enabled&&console.log("🚪 [단내림 커버도어 조건]:",{moduleId:n.moduleId,zone:n.zone,globalSlotIndex:K,slotInfoFound:!!Q,hasColumn:Q==null?void 0:Q.hasColumn,adjustedWidth:n.adjustedWidth,customWidth:n.customWidth,originalModuleWidth:W,hasColumnEvidence:se,columnSlotsLength:Y.length,columnSlots:Y.map(xt=>({slotIndex:xt.slotIndex,hasColumn:xt.hasColumn}))}),se&&console.log("🔍 [기둥 감지됨]:",{moduleId:n.moduleId,zone:n.zone,slotIndex:n.slotIndex,hasColumnEvidence:se,furnitureWidthMm:M,originalModuleWidth:W,widthReduced:M<W,reasons:{slotInfoHasColumn:Q==null?void 0:Q.hasColumn,hasAdjustedWidth:n.adjustedWidth!==void 0&&n.adjustedWidth!==null,customWidthSmaller:n.customWidth!==void 0&&n.customWidth<W,availableWidthSmaller:(Q==null?void 0:Q.availableWidth)&&Q.availableWidth<(V.columnWidth||W),renderWidthSmaller:M<W,isInDroppedZone:Z&&M<600,hasColumnInPosition:Ae}}),Se&&(q==null?void 0:q.category)!=="upper"&&(q==null?void 0:q.category)!=="lower"){const xt=M;if(de){const Bt=fe==="both"?eh*2:eh;M-=Bt;const on=V.slotWidths&&n.slotIndex!==void 0?V.slotWidths[n.slotIndex]+(n.slotIndex<V.slotWidths.length-1?V.slotWidths[n.slotIndex+1]:0):0;console.log("🔧🔧🔧 듀얼장 - 상하부장 인접으로 너비 조정:",{moduleId:n.moduleId,slotIndex:n.slotIndex,category:q==null?void 0:q.category,isDualFurniture:de,originalWidth:xt,adjustedWidth:M,slotBoundary:on,"⚠️ 슬롯초과여부":M>on?`초과! ${M-on}mm`:"정상",endPanelSide:fe,reduction:Bt,needsEndPanelAdjustment:Se,adjacentCheck:Ce,description:fe==="both"?"듀얼장 양쪽에 상하부장 - 36mm 축소 (양쪽 18mm씩)":`듀얼장 ${fe}쪽에 상하부장 - 18mm 축소 (양쪽 9mm씩) + 반대쪽으로 9mm 이동`,"⚠️ 중요":"듀얼장은 양쪽에서 균등하게 줄어들고 반대쪽으로 이동"})}else{const Bt=fe==="both"?eh*2:eh;M-=Bt,console.log("🔧 키큰장 - 상하부장 인접으로 너비 조정:",{moduleId:n.moduleId,category:q==null?void 0:q.category,isDualFurniture:de,originalWidth:xt,adjustedWidth:M,endPanelSide:fe,reduction:Bt,description:fe==="both"?"키큰장 + 양쪽 엔드패널(36mm) = 슬롯 전체 너비":"키큰장 + 엔드패널(18mm) = 슬롯 전체 너비"})}}if(V.slotWidths&&n.slotIndex!==void 0){const xt=de&&n.slotIndex<V.slotWidths.length-1?V.slotWidths[n.slotIndex]+V.slotWidths[n.slotIndex+1]:V.slotWidths[n.slotIndex];console.log("📏 FurnitureItem 크기 비교:",{moduleId:n.moduleId,slotIndex:n.slotIndex,"slotGuideWidth(mm)":xt,"furnitureWidth(mm)":M,"difference(mm)":Math.abs(xt-M),"difference(Three.js)":Math.abs(xt-M)*.01,customWidth:n.customWidth,adjustedWidth:n.adjustedWidth,moduleWidth:(q==null?void 0:q.dimensions.width)||600,isDualSlot:de,widthSource:n.customWidth!==void 0&&n.customWidth!==null?"customWidth":n.adjustedWidth!==void 0&&n.adjustedWidth!==null?"adjustedWidth":"moduleDefault"})}let ie=!1;if(n.zone&&((Tr=t.droppedCeiling)!=null&&Tr.enabled)){const xt=ar.calculateZoneSlotInfo(t,t.customColumnCount),Bt=n.zone==="dropped"&&xt.dropped?xt.dropped:xt.normal;ie=de?n.slotIndex+2>=Bt.columnCount:n.slotIndex===Bt.columnCount-1}else ie=de?n.slotIndex+2>=V.columnCount:n.slotIndex===V.columnCount-1;let ee;if(n.zone&&((xr=t.droppedCeiling)!=null&&xr.enabled)){const xt=ar.calculateZoneSlotInfo(t,t.customColumnCount),Bt=n.zone==="dropped"&&xt.dropped?xt.dropped:xt.normal;let on=n.slotIndex;if(n.zone==="dropped"&&t.droppedCeiling.position==="right"?on=n.slotIndex-xt.normal.columnCount:n.zone==="normal"&&t.droppedCeiling.position==="left"&&(on=n.slotIndex-xt.dropped.columnCount),Bt.slotWidths&&on!==void 0&&on>=0&&Bt.slotWidths[on]!==void 0){if(de&&on<Bt.slotWidths.length-1)ee=Bt.slotWidths[on]+Bt.slotWidths[on+1];else if(ee=Bt.slotWidths[on],t.surroundType==="no-surround"&&!de){const li=((br=t.droppedCeiling)==null?void 0:br.position)||"right";let hi=!1,Ii=!1;t.installType==="freestanding"?n.zone==="dropped"?li==="right"?Ii=on===Bt.columnCount-1:hi=on===0:li==="right"?hi=on===0:Ii=on===Bt.columnCount-1:(t.installType==="semistanding"||t.installType==="semi-standing")&&((vn=t.wallConfig)!=null&&vn.left||(n.zone==="dropped"?hi=li==="left"&&on===0:hi=li==="right"&&on===0),(wi=t.wallConfig)!=null&&wi.right||(n.zone==="dropped"?Ii=li==="right"&&on===Bt.columnCount-1:Ii=li==="left"&&on===Bt.columnCount-1)),(hi||Ii)&&(ee+=18,console.log("🔧 노서라운드 zone 구간 - 엔드패널 슬롯 도어 크기 복원:",{zone:n.zone,slotIndex:n.slotIndex,localSlotIndex:on,droppedPosition:li,isLeftEndPanel:hi,isRightEndPanel:Ii,원래크기:ee-18,복원크기:ee,단내림여부:(Ve=t.droppedCeiling)==null?void 0:Ve.enabled}))}}else ee=(q==null?void 0:q.dimensions.width)||600}else if(V.slotWidths&&n.slotIndex!==void 0&&V.slotWidths[n.slotIndex]!==void 0){if(de&&n.slotIndex<V.slotWidths.length-1)ee=V.slotWidths[n.slotIndex]+V.slotWidths[n.slotIndex+1];else if(ee=V.slotWidths[n.slotIndex],t.surroundType==="no-surround"&&!de){const Bt=V.columnCount;t.installType==="freestanding"?(n.slotIndex===0||n.slotIndex===Bt-1)&&(ee+=18,console.log("🔧 노서라운드 일반 구간 - 엔드패널 슬롯 도어 크기 복원:",{slotIndex:n.slotIndex,원래크기:ee-18,복원크기:ee,단내림여부:(ct=t.droppedCeiling)==null?void 0:ct.enabled})):(t.installType==="semistanding"||t.installType==="semi-standing")&&(!((mt=t.wallConfig)!=null&&mt.left)&&n.slotIndex===0||!((An=t.wallConfig)!=null&&An.right)&&n.slotIndex===Bt-1)&&(ee+=18)}}else ee=(q==null?void 0:q.dimensions.width)||600;console.log("📏 원래 슬롯 너비 계산:",{moduleId:n.moduleId,zone:n.zone,isDualFurniture:de,originalSlotWidthMm:ee,droppedCeilingEnabled:(nn=t.droppedCeiling)==null?void 0:nn.enabled,노서라운드:t.surroundType==="no-surround",슬롯인덱스:n.slotIndex,가구실제너비:q==null?void 0:q.dimensions.width});const ae=0;console.log("🔍 노서라운드 조정 전 상태:",{moduleId:n.moduleId,slotIndex:n.slotIndex,furnitureWidthMm:M,hasCustomWidth:n.customWidth!==void 0&&n.customWidth!==null,customWidth:n.customWidth,surroundType:t.surroundType,installType:t.installType,columnCount:V.columnCount,isLastSlot:ie,placedModulePosition:n.position});const me=(()=>{var on,ln,li,hi,Ii,kr,zr;if(t.surroundType!=="no-surround"||n.slotIndex===void 0)return!1;let xt=n.slotIndex===0,Bt=ie;if((on=t.droppedCeiling)!=null&&on.enabled&&n.zone){const Us=ar.calculateZoneSlotInfo(t,t.customColumnCount),io=(((ln=Us.normal)==null?void 0:ln.columnCount)||0)+(((li=Us.dropped)==null?void 0:li.columnCount)||0);let ws=n.slotIndex;t.droppedCeiling.position==="right"?n.zone==="dropped"&&(ws=(((hi=Us.normal)==null?void 0:hi.columnCount)||0)+n.slotIndex):t.droppedCeiling.position==="left"&&n.zone==="normal"&&(ws=(((Ii=Us.dropped)==null?void 0:Ii.columnCount)||0)+n.slotIndex),xt=ws===0,Bt=ws===io-1}return t.installType==="freestanding"?xt||Bt:t.installType==="semistanding"||t.installType==="semi-standing"?(kr=t.wallConfig)!=null&&kr.left?Bt:(zr=t.wallConfig)!=null&&zr.right?xt:!1:!1})();console.log("🎯 가구 너비 결정:",{moduleId:n.id,placedModuleId:n.moduleId,slotIndex:n.slotIndex,zone:n.zone,isDualFurniture:de,customWidth:n.customWidth,adjustedWidth:n.adjustedWidth,moduleWidth:(q==null?void 0:q.dimensions.width)||600,finalWidth:M,평균슬롯너비:V.columnWidth,실제슬롯너비배열:V.slotWidths,실제슬롯너비:(zt=V.slotWidths)==null?void 0:zt[n.slotIndex],계산방법:n.customWidth?`customWidth 사용 (${n.customWidth}mm)`:V.slotWidths&&n.slotIndex!==void 0&&V.slotWidths[n.slotIndex]?`slotWidths 사용 (${V.slotWidths[n.slotIndex]}mm)`:n.adjustedWidth?`adjustedWidth 사용 (${n.adjustedWidth}mm)`:`기본 모듈 너비 사용 (${(q==null?void 0:q.dimensions.width)||600}mm)`});let _e=n.position;if(n.zone&&((gn=t.droppedCeiling)!=null&&gn.enabled)&&!I){const xt=ar.calculateZoneSlotInfo(t,t.customColumnCount),Bt=n.zone==="dropped"&&xt.dropped?xt.dropped:xt.normal;let on=n.slotIndex;if(n.zone==="dropped"&&t.droppedCeiling.position==="right"?on=n.slotIndex-xt.normal.columnCount:n.zone==="normal"&&t.droppedCeiling.position==="left"&&(on=n.slotIndex-xt.dropped.columnCount),Bt.threeUnitPositions&&on!==void 0&&on>=0){const ln=de&&on<Bt.threeUnitPositions.length-1?(Bt.threeUnitPositions[on]+Bt.threeUnitPositions[on+1])/2:Bt.threeUnitPositions[on];_e={...n.position,x:ln},console.log("🌟 단내림 + 노서라운드 위치 보정:",{moduleId:n.id,zone:n.zone,slotIndex:n.slotIndex,localSlotIndex:on,originalX:n.position.x,correctedX:ln,isDualFurniture:de})}}else ie&&!I&&(_e={...n.position});const ue=(q==null?void 0:q.dimensions.depth)||600,Be=(q==null?void 0:q.dimensions.height)||2200;n.zone==="dropped"&&console.log("📏 단내림 구간 가구 높이 (초기):",{moduleId:n.id,customHeight:n.customHeight,moduleHeight:(q==null?void 0:q.dimensions.height)||2200,internalSpaceHeight:L.height,finalHeight:Be,zone:n.zone});const it=n.customDepth||(ue!==((q==null?void 0:q.dimensions.depth)||600)?ue:(q==null?void 0:q.dimensions.depth)||600),De=U(it),qe=U(M),Je=U(Be);X&&Q&&console.log("🟪 FurnitureItem Column C 깊이 확인:",{moduleId:n.id,placedModuleCustomDepth:n.customDepth,adjustedDepthMm:ue,actualModuleDepth:(q==null?void 0:q.dimensions.depth)||600,finalActualDepthMm:it,slotIndex:n.slotIndex,isSplit:n.isSplit,spaceType:(Jn=n.columnSlotInfo)==null?void 0:Jn.spaceType});const et=U(20),He=1500,ze=600,Oe=U(He),ke=U(ze),_t=-Oe/2+(Oe-ke)/2+ke/2-et-De/2;ue!==((q==null?void 0:q.dimensions.depth)||600)&&(Q!=null&&Q.hasColumn)&&console.log("🎯 기둥 C - 깊이만 조정, 위치 유지:",{columnDepthMm:((Qn=Q.column)==null?void 0:Qn.depth)||0,originalDepthMm:(q==null?void 0:q.dimensions.depth)||600,adjustedDepthMm:ue,furnitureZ:_t,설명:"가구 위치는 그대로, 깊이만 줄어듦"}),Q!=null&&Q.hasColumn&&Q.columnProcessingMethod==="depth-adjustment"&&Q.column&&console.log("🔵 기둥 C - 가구 깊이만 조정 (위치는 고정):",{columnDepthMm:Q.column.depth,originalDepthMm:(q==null?void 0:q.dimensions.depth)||600,adjustedDepthMm:ue,actualDepthMm:it,furnitureZ:_t,설명:"가구는 항상 같은 위치에서 시작하고 깊이만 줄어듭니다"});const Ee=o?"#66ff66":void 0;let Le=n.hingePosition||"right";if(!I&&Q&&Q.hasColumn)Le=kz(Q),console.log("🚪 기둥 침범에 따른 힌지 방향 조정:",{slotIndex:Q.slotIndex,intrusionDirection:Q.intrusionDirection,furniturePosition:Q.furniturePosition,originalHinge:n.hingePosition||"right",optimalHinge:Le});else if(t.surroundType==="no-surround"&&n.slotIndex!==void 0){const xt=n.slotIndex===0;let Bt=!1;if((pn=t.droppedCeiling)!=null&&pn.enabled&&V.zones){const on=n.zone||"normal",ln=on==="dropped"&&V.zones.dropped?V.zones.dropped:V.zones.normal;Bt=de?n.slotIndex+2>=ln.columnCount:n.slotIndex===ln.columnCount-1,console.log("🎯 단내림 마지막 슬롯 판단:",{zone:on,slotIndex:n.slotIndex,zoneColumnCount:ln.columnCount,isLastSlot:Bt,isDualFurniture:de})}else Bt=de?n.slotIndex+2>=V.columnCount:n.slotIndex===V.columnCount-1;t.installType==="freestanding"?xt?(Le="right",console.log("🚪 노서라운드 첫번째 슬롯 힌지: right (왼쪽 엔드패널 커버)")):Bt&&(Le="left",console.log("🚪 노서라운드 마지막 슬롯 힌지: left (오른쪽 엔드패널 커버)")):(t.installType==="semistanding"||t.installType==="semi-standing")&&(xt&&!((Ln=t.wallConfig)!=null&&Ln.left)?Le="right":Bt&&!((Dn=t.wallConfig)!=null&&Dn.right)&&(Le="left"))}const ye=X&&((ei=n.columnSlotInfo)==null?void 0:ei.spaceType)==="front",Ze=Vhe(n,ye,((xi=Q==null?void 0:Q.column)==null?void 0:xi.depth)||300,V.columnWidth),nt=xt=>{ye&&!r?Ze.handlePointerDown(xt):u(xt,n.id)},st=xt=>{Ze.isResizing?Ze.handlePointerMove(xt):d(xt)},At=()=>{Ze.isResizing?Ze.handlePointerUp():A()};H.useEffect(()=>{(($==null?void 0:$.category)==="upper"||(q==null?void 0:q.category)==="upper")&&console.log("🔴🔴🔴 상부장 위치 정보:",{id:n.id,moduleId:n.moduleId,category:($==null?void 0:$.category)||(q==null?void 0:q.category),저장된_Y위치:n.position.y,저장된_Y위치_mm:n.position.y/.01,adjustedPosition_Y:_e.y,실제_렌더링될_Y:"furnitureYPosition 값 사용",문제:"저장된 Y 위치가 잘못되었을 가능성"}),console.log("📍 FurnitureItem 위치 변경:",{id:n.id,placedModulePosition:n.position,adjustedPosition:_e,positionDifference:{x:_e.x-n.position.x,y:_e.y-n.position.y,z:_e.z-n.position.z}})},[n.position.x,n.position.y,n.position.z,_e.x,_e.y,_e.z,n.id,$==null?void 0:$.category,q==null?void 0:q.category]);const ft=ci.useMemo(()=>{var on,ln,li,hi,Ii,kr,zr,Us,io,ws,Ts,Mn,ve,Re,Ke,Ge,pt,Pt,pe,xe;if(($==null?void 0:$.category)==="upper"||(q==null?void 0:q.category)==="upper"){let Qt=t.height;n.zone==="dropped"&&((on=t.droppedCeiling)!=null&&on.enabled)&&(Qt=Qt-(t.droppedCeiling.dropHeight||200),console.log("🔻 단내림 구간 상부장 - 낮아진 천장 적용:",{originalHeight:t.height,dropHeight:t.droppedCeiling.dropHeight,adjustedHeight:Qt,zone:n.zone})),t.surroundType,Qt=Qt-10;const wn=((ln=q==null?void 0:q.dimensions)==null?void 0:ln.height)||((li=$==null?void 0:$.dimensions)==null?void 0:li.height)||600,gt=U(Qt-wn/2);return console.log("🔝 상부장 Y 위치 (상부 프레임 하단):",{moduleId:n.moduleId,spaceHeight:t.height,surroundType:t.surroundType,frameThickness:t.surroundType!=="no-surround"?10:0,totalHeightMm:Qt,furnitureHeightMm:wn,계산식:`${Qt} - ${wn/2} = ${Qt-wn/2}`,yPos:gt,yPos_mm:gt*100,상부장_상단_mm:gt*100+wn/2,상부장_하단_mm:gt*100-wn/2,savedY:n.position.y,savedY_mm:n.position.y*100,차이_mm:(n.position.y-gt)*100,isDragging:o||I,baseConfig:t==null?void 0:t.baseConfig,zone:n.zone,설명:t.surroundType!=="no-surround"?"상부장은 상부 프레임 하단에 맞닿음":"노서라운드 - 상부장은 공간 최상단에 맞닿음"}),gt}if(n.position.y!==0&&!o&&!v)return console.log("🎯 저장된 Y 위치 사용:",{moduleId:n.moduleId,category:($==null?void 0:$.category)||(q==null?void 0:q.category),savedY:n.position.y,savedY_mm:n.position.y*100}),n.position.y;if(($==null?void 0:$.category)==="full"||(q==null?void 0:q.category)==="full"){const dt=Kr(t).height;let Qt=Math.min((q==null?void 0:q.dimensions.height)||2200,dt),wn;if(n.zone==="dropped"&&((hi=t.droppedCeiling)!=null&&hi.enabled)){const Yn=(t.hasFloorFinish&&t.floorFinish?t.floorFinish.height:0)*.01;if(!t.baseConfig||t.baseConfig.type==="floor"){const ht=((Ii=t.baseConfig)==null?void 0:Ii.height)||0;wn=Yn+ht*.01}else if(t.baseConfig.type==="stand"&&t.baseConfig.placementType==="float"){const ht=t.baseConfig.floatHeight||0;wn=Yn+ht*.01}else wn=Yn}else wn=i;let gt;if(n.zone==="dropped"&&((kr=t.droppedCeiling)!=null&&kr.enabled)&&((zr=t.surround)!=null&&zr.use)){const Vn=t.height,Yn=Vn-10,ht=Yn,Ot=ht-Qt/2;gt=U(Ot),console.log("🔴 단내림+서라운드 키큰장 Y 위치 조정:",{원래높이:(q==null?void 0:q.dimensions.height)||2200,내경높이:dt,가구높이:Qt,천장높이:Vn,상부프레임하단:Yn,키큰장상단:ht,키큰장중심:Ot,중심Y_Three:gt,중심Y_mm:gt/.01,상단Y_mm:gt/.01+Qt/2,하단Y_mm:gt/.01-Qt/2,설명:"키큰장 상단이 상부프레임 하단(천장-10mm)에 닿도록"})}else gt=wn+Je/2,console.log("🏢 키큰장(full) Y 위치 계산:",{moduleId:(q==null?void 0:q.id)||"unknown",category:(q==null?void 0:q.category)||"full",zone:n.zone,furnitureStartY:i,furnitureHeightMm:Qt,internalHeightMm:dt,originalHeight:q==null?void 0:q.dimensions.height,yPos_Three단위:gt,yPos_mm:gt/.01,상부끝_mm:gt/.01+Qt/2,내경높이:dt,baseConfig:t==null?void 0:t.baseConfig,placementType:(Us=t==null?void 0:t.baseConfig)==null?void 0:Us.placementType,floatHeight:(io=t==null?void 0:t.baseConfig)==null?void 0:io.floatHeight,설명:"키큰장은 바닥부터 상부 프레임 하단까지"});return gt}else if(($==null?void 0:$.category)==="upper"||(q==null?void 0:q.category)==="upper"){let Qt=t.height;t.surroundType,Qt=Qt-10,n.zone==="dropped"&&((ws=t.droppedCeiling)!=null&&ws.enabled)&&console.log("🎯 단내림 구간 상부장 - 낮아진 천장에 고정:",{zone:n.zone,baseHeight:t.height,dropHeight:((Ts=t.droppedCeiling)==null?void 0:Ts.dropHeight)||200,adjustedCeilingHeight:Qt,설명:"상부장은 단내림 구간의 낮아진 천장에 고정"});const wn=(q==null?void 0:q.dimensions.height)||600,gt=U(Qt-wn/2);return console.log("🔝🔝🔝 상부장 Y 위치 계산 (FurnitureItem):",{moduleId:(q==null?void 0:q.id)||"unknown",category:($==null?void 0:$.category)||(q==null?void 0:q.category)||"unknown",zone:n.zone,droppedCeilingEnabled:(Mn=t.droppedCeiling)==null?void 0:Mn.enabled,spaceHeight:t.height,totalHeightMm:Qt,furnitureHeightMm:wn,계산식:`${Qt} - ${wn/2} = ${Qt-wn/2}`,yPos_Three단위:gt,yPos_mm:gt/.01,상부장_상단_mm:gt/.01+wn/2,상부장_하단_mm:gt/.01-wn/2,천장높이:t.height,상부프레임두께:t.surroundType!=="no-surround"?10:0,isDragging:o,baseConfig:t==null?void 0:t.baseConfig,설명:"상부장은 항상 천장(상부 프레임 하단)에 고정"}),o&&console.log("🔝 상부장 드래그 중 Y 위치:",{moduleId:(q==null?void 0:q.id)||"unknown",category:($==null?void 0:$.category)||(q==null?void 0:q.category)||"unknown",internalHeightMm,furnitureHeightMm:wn,totalY:gt,isDragging:o,baseConfig:t==null?void 0:t.baseConfig,설명:"상부장은 천장 기준 (바닥재 높이 제외)"}),gt}let Bt;if(n.zone==="dropped"&&((ve=t.droppedCeiling)!=null&&ve.enabled)){const at=t.hasFloorFinish&&t.floorFinish?t.floorFinish.height:0,dt=at*.01;if(!t.baseConfig||t.baseConfig.type==="floor"){const Qt=((Re=t.baseConfig)==null?void 0:Re.height)||0;Bt=dt+Qt*.01+Je/2,console.log("🔴 단내림구간 - 받침대 배치:",{zone:"dropped",baseFrameHeightMm:Qt,floorFinishHeightMm:at,yPos:Bt,yPos_mm:Bt*100})}else if(t.baseConfig.type==="stand"&&t.baseConfig.placementType==="float"){const Qt=t.baseConfig.floatHeight||0;Bt=dt+Qt*.01+Je/2,console.log("🔴 단내림구간 - 띄워서 배치:",{zone:"dropped",floatHeightMm:Qt,floorFinishHeightMm:at,yPos:Bt,yPos_mm:Bt*100,baseConfig:t.baseConfig})}else Bt=dt+Je/2,console.log("🔴 단내림구간 - 바닥 배치:",{zone:"dropped",floorFinishHeightMm:at,yPos:Bt,yPos_mm:Bt*100,baseConfig:t.baseConfig})}else Bt=i+Je/2;if((q==null?void 0:q.category)==="lower"||(Ke=q==null?void 0:q.id)!=null&&Ke.includes("lower-cabinet")){const at=((Ge=t==null?void 0:t.baseConfig)==null?void 0:Ge.type)==="stand"&&((pt=t==null?void 0:t.baseConfig)==null?void 0:pt.placementType)==="float";console.log("📦 하부장 Y 위치 계산 상세:",{moduleId:(q==null?void 0:q.id)||"unknown",category:(q==null?void 0:q.category)||"lower",baseConfig_type:(Pt=t==null?void 0:t.baseConfig)==null?void 0:Pt.type,placementType:(pe=t==null?void 0:t.baseConfig)==null?void 0:pe.placementType,isFloatPlacement:at,floatHeight_mm:((xe=t==null?void 0:t.baseConfig)==null?void 0:xe.floatHeight)||0,furnitureStartY:i,furnitureStartY_mm:i*100,height:Je,height_mm:Je*100,furnitureHeightMm_original:Be,yPos:Bt,yPos_mm:Bt*100,하부장_하단_mm:(Bt-Je/2)*100,하부장_상단_mm:(Bt+Je/2)*100,계산식:`furnitureStartY(${(i*100).toFixed(1)}mm) + height/2(${(Je/2*100).toFixed(1)}mm) = ${(Bt*100).toFixed(1)}mm`,설명:at?"띄워서 배치 - 하부장이 띄움 높이 위에 배치됨":"일반 배치"})}return Bt},[n.position.y,i,Je,q==null?void 0:q.id,q==null?void 0:q.category,$==null?void 0:$.category,t,(Yi=t==null?void 0:t.baseConfig)==null?void 0:Yi.placementType,(Bn=t==null?void 0:t.baseConfig)==null?void 0:Bn.floatHeight,o]),Xt=(()=>{var hi,Ii,kr,zr,Us;if(n.zone&&((hi=t.droppedCeiling)!=null&&hi.enabled)){const io=ar.calculateZoneSlotInfo(t,t.customColumnCount),ws=n.zone==="dropped"&&io.dropped?io.dropped:io.normal;let Ts=n.slotIndex;if(n.zone==="dropped"&&t.droppedCeiling.position==="right"?Ts=n.slotIndex-io.normal.columnCount:n.zone==="normal"&&t.droppedCeiling.position==="left"&&(Ts=n.slotIndex-io.dropped.columnCount),ws.threeUnitPositions&&Ts!==void 0&&Ts>=0){let Mn=0;if(Mn=0,me){const Ke=ee-M;n.slotIndex===0&&(t.installType==="freestanding"||t.installType==="semistanding"&&((Ii=t.wallConfig)!=null&&Ii.right))?Mn-=U(Ke/2):ie&&(t.installType==="freestanding"||t.installType==="semistanding"&&((kr=t.wallConfig)!=null&&kr.left))&&(Mn+=U(Ke/2))}return console.log("🚪 단내림 구간 도어 X 위치 계산:",{moduleId:n.moduleId,zone:n.zone,globalSlotIndex:n.slotIndex,localSlotIndex:Ts,adjustedPositionX:_e.x,doorOffset:Mn,isDualFurniture:de,targetZone:{startX:ws.startX,columnCount:ws.columnCount},설명:"단내림 구간에서는 도어가 가구 중심에 위치 (오프셋 0)"}),Mn}}if(!me)return 0;const Bt=ee,on=M,ln=Bt-on;let li=0;return n.slotIndex===0&&(t.installType==="freestanding"||t.installType==="semistanding"&&((zr=t.wallConfig)!=null&&zr.right))?li=-U(ln/2):ie&&(t.installType==="freestanding"||t.installType==="semistanding"&&((Us=t.wallConfig)!=null&&Us.left))&&(li=U(ln/2)),console.log("🚪 노서라운드 엔드패널 도어 위치 계산:",{슬롯인덱스:n.slotIndex,가구위치:_e.x,가구너비:on,도어너비:Bt,도어오프셋:li,설명:"도어가 가구 중심에서 상대적으로 이동하여 엔드패널 커버"}),li})();return E||!$?null:c.jsxs("group",{children:[c.jsxs("group",{position:[_e.x+ae,ft,_t],rotation:[0,n.rotation*Math.PI/180,0],onClick:xt=>{xt.stopPropagation()},onDoubleClick:xt=>{console.log("🎯 FurnitureItem onDoubleClick 이벤트 발생:",n.id),f(xt,n.id)},onPointerDown:nt,onPointerMove:st,onPointerUp:At,onPointerOver:()=>{ye&&!r?document.body.style.cursor=Ze.isResizing?"crosshair":"move":document.body.style.cursor=r?"grab":o?"grabbing":"grab",k(!0)},onPointerOut:()=>{Ze.isResizing||(document.body.style.cursor="default"),k(!1)},children:[t.surroundType==="no-surround"&&t.gapConfig&&n.position&&(()=>{var xt;return console.log(`🪑 [가구위치] 이격거리${t.gapConfig.left}mm: X=${((xt=n.position.x)==null?void 0:xt.toFixed(3))||"0.000"}, 원래폭=${$==null?void 0:$.dimensions.width}mm, 실제폭=${M}mm`),null})(),($==null?void 0:$.type)==="box"?c.jsxs(c.Fragment,{children:[c.jsx("group",{position:[Se&&fe&&(q==null?void 0:q.category)!=="upper"&&(q==null?void 0:q.category)!=="lower"?fe==="both"?0:fe==="left"?U(eh/2):-U(eh/2):0,0,0],children:c.jsx(kQ,{moduleData:q,isDragging:o,color:Ee,internalHeight:Be,viewMode:a,renderMode:h,showFurniture:p,isHighlighted:B,hasDoor:I||o||Se||se?!1:n.hasDoor??!0,hasBackPanel:n.hasBackPanel,customDepth:it,hingePosition:Le,adjustedWidth:M,spaceInfo:(()=>{var xt,Bt;return console.log("🚨 FurnitureItem -> BoxModule spaceInfo 전달:",{moduleId:(q==null?void 0:q.id)||"unknown",hasSpaceInfo:!!O,baseConfig:O==null?void 0:O.baseConfig,placementType:(xt=O==null?void 0:O.baseConfig)==null?void 0:xt.placementType,floatHeight:(Bt=O==null?void 0:O.baseConfig)==null?void 0:Bt.floatHeight}),O})(),doorWidth:(console.log("🚪🚪🚪 도어 너비 설정 (듀얼 체크):",{moduleId:n.moduleId,slotIndex:n.slotIndex,zone:n.zone,isDualFurniture:de,isDualSlot:n.isDualSlot,doorWidth:ee,furnitureWidthMm:M,customWidth:n.customWidth,adjustedWidth:n.adjustedWidth,needsEndPanelAdjustment:Se,endPanelSide:fe,surroundType:t.surroundType,설명:de?"듀얼 상부장 - 두 슬롯 너비 합":"싱글 상부장"}),ee),doorXOffset:0,onDoubleClick:xt=>f(xt,n.id),originalSlotWidth:ee,slotCenterX:Xt,adjustedWidth:(console.log("📦📦📦 BoxModule에 전달되는 adjustedWidth:",{moduleId:n.moduleId,isDualFurniture:de,needsEndPanelAdjustment:Se,endPanelSide:fe,furnitureWidthMm:M,전달값:M,"⚠️":Se?"엔드패널 조정됨":"조정 없음"}),M),slotIndex:n.slotIndex,slotInfo:Q,adjacentCabinets:{hasAdjacentUpperLower:Se,adjacentSide:fe},slotWidths:(()=>{var xt;if(de){let Bt;if(n.zone&&((xt=t.droppedCeiling)!=null&&xt.enabled)){const on=ar.calculateZoneSlotInfo(t,t.customColumnCount),ln=n.zone==="dropped"&&on.dropped?on.dropped:on.normal;let li=n.slotIndex;n.zone==="dropped"&&t.droppedCeiling.position==="right"?li=n.slotIndex-on.normal.columnCount:n.zone==="normal"&&t.droppedCeiling.position==="left"&&(li=n.slotIndex-on.dropped.columnCount),ln.slotWidths&&li>=0&&li<ln.slotWidths.length-1&&(Bt=[ln.slotWidths[li],ln.slotWidths[li+1]])}else V.slotWidths&&n.slotIndex<V.slotWidths.length-1&&(Bt=[V.slotWidths[n.slotIndex],V.slotWidths[n.slotIndex+1]]);return Bt}})()})}),(()=>{const xt=(()=>{var ln,li,hi;if(n.zone&&((ln=t.droppedCeiling)!=null&&ln.enabled)&&V.zones){const Ii=n.zone==="dropped"&&V.zones.dropped?V.zones.dropped:V.zones.normal;return((li=Ii.slotWidths)==null?void 0:li[n.slotIndex])||Ii.columnWidth}return((hi=V.slotWidths)==null?void 0:hi[n.slotIndex])||V.columnWidth})(),Bt=U(xt),on=U(M);return console.log("🎨 BoxModule 너비 비교:",{moduleId:n.id,slotIndex:n.slotIndex,zone:n.zone,슬롯너비_mm:xt,가구너비_mm:M,차이_mm:xt-M,슬롯너비_three:Bt.toFixed(4),가구너비_three:on.toFixed(4),차이_three:(Bt-on).toFixed(4),customWidth:n.customWidth,adjustedWidth:n.adjustedWidth,계산방법:V.slotWidths&&n.slotIndex!==void 0&&V.slotWidths[n.slotIndex]?"slotWidths 배열 사용":n.customWidth?"customWidth 사용":n.adjustedWidth?"adjustedWidth 사용":"기본 모듈 너비 사용"}),null})(),Se&&fe&&(q==null?void 0:q.category)!=="upper"&&(q==null?void 0:q.category)!=="lower"&&(()=>{const xt=U(M),Bt=[],on=fe==="both"?0:fe==="left"?U(eh/2):-U(eh/2);if(fe==="both"||fe==="left"){const ln=on-xt/2-U(eh)/2;Bt.push(c.jsx(qj,{width:U(eh),height:Je,depth:De,position:[ln,0,0],spaceInfo:t,renderMode:h},"left-panel")),console.log("🔧 왼쪽 엔드패널 렌더링:",{moduleId:n.id,leftPanelX:ln,furnitureOffset:on,reducedFurnitureWidth:M})}if(fe==="both"||fe==="right"){const ln=on+xt/2+U(eh)/2;Bt.push(c.jsx(qj,{width:U(eh),height:Je,depth:De,position:[ln,0,0],spaceInfo:t,renderMode:h},"right-panel")),console.log("🔧 오른쪽 엔드패널 렌더링:",{moduleId:n.id,rightPanelX:ln,furnitureOffset:on,reducedFurnitureWidth:M})}return console.log("🔧 엔드패널 렌더링 완료:",{moduleId:n.id,side:fe,panelCount:Bt.length,furnitureOffset:on,isDualFurniture:de,reducedFurnitureWidth:M,endPanelThickness:eh}),Bt})(),Se&&(n.hasDoor??!1)&&!I&&!o&&!(Q&&Q.hasColumn)&&(()=>{console.log("🚪 엔드패널 도어 별도 렌더링:",{moduleId:n.id,needsEndPanelAdjustment:Se,hasDoor:n.hasDoor});const xt=fe==="both"?M+eh*2:M+eh;return c.jsx(tu,{moduleWidth:xt,moduleDepth:it,hingePosition:Le,spaceInfo:O,color:void 0,doorXOffset:0,originalSlotWidth:ee,slotCenterX:Xt,moduleData:q,isDragging:o,isEditMode:s,slotIndex:n.slotIndex})})()]}):c.jsxs(c.Fragment,{children:[c.jsx(Lq,{args:[qe,Je,De],children:c.jsx("meshPhysicalMaterial",{color:Ee,clearcoat:.1,clearcoatRoughness:.8,metalness:0,roughness:.7,reflectivity:.2,transparent:o||s,opacity:o||s?.8:1})}),c.jsx(Mq,{color:Ze.isResizing?"#ff6600":$he({isDragging:o,isEditMode:s,isDragMode:r,viewMode:a,view2DTheme:C,renderMode:h}),threshold:1,scale:1.001,linewidth:Ze.isResizing?3:1}),s&&c.jsx("primitive",{object:(()=>{const xt=document.createElement("canvas"),Bt=xt.getContext("2d");xt.width=256,xt.height=128,Bt.fillStyle="rgba(255, 140, 0, 0.9)",Bt.fillRect(0,0,256,128),Bt.fillStyle="#ffffff",Bt.font="16px Arial",Bt.textAlign="center",Bt.fillText("편집 모드",128,25),Bt.font="12px Arial",Bt.fillText("더블클릭으로 진입",128,40),Bt.fillText("드래그: 이동",128,55),Bt.fillText("←→: 이동",128,70),Bt.fillText("Del: 삭제",128,85),Bt.fillText("Esc: 해제",128,100);const on=new _h(xt),ln=new pB({map:on,transparent:!0,depthTest:!1}),li=new ZU(3,1.5),hi=new KU(li,ln);return hi.position.set(0,Je+2,0),hi.renderOrder=1002,hi})()})]}),ye&&T&&!r&&!Ze.isResizing&&c.jsx(jm,{position:[0,Je/2+.5,De/2+.1],center:!0,style:{userSelect:"none",pointerEvents:"none",zIndex:1e3},children:c.jsx("div",{style:{background:"rgba(255, 102, 0, 0.9)",color:"white",padding:"6px 12px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",whiteSpace:"nowrap",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},children:"↔️ 드래그하여 크기 조절"})}),Ze.isResizing&&Ze.resizeDirection&&c.jsx(jm,{position:[0,0,De/2+.1],center:!0,style:{userSelect:"none",pointerEvents:"none",zIndex:1e3},children:c.jsx("div",{style:{background:"rgba(255, 102, 0, 0.9)",color:"white",padding:"6px 12px",borderRadius:"4px",fontSize:"14px",fontWeight:"bold",whiteSpace:"nowrap",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},children:Ze.resizeDirection==="horizontal"?"↔️ 너비 조절":"↕️ 깊이 조절"})})]}),(()=>{var Bt;const xt=!I&&!o&&(n.hasDoor??!0)&&se&&t;return console.log("🚪 [커버도어 체크]:",{moduleId:n.moduleId,zone:n.zone,localSlotIndex:n.slotIndex,globalSlotIndex:K,hasDroppedCeiling:(Bt=t==null?void 0:t.droppedCeiling)==null?void 0:Bt.enabled,shouldRenderCoverDoor:xt,slotInfo:Q?{exists:!0,hasColumn:Q.hasColumn,columnType:Q.columnType,availableWidth:Q.availableWidth}:"slotInfo is undefined",placedModule:{adjustedWidth:n.adjustedWidth,customWidth:n.customWidth,originalModuleWidth:W,hasDoor:n.hasDoor},conditions:{notDragging:!I&&!o,hasDoor:n.hasDoor??!0,hasColumn:Q==null?void 0:Q.hasColumn,hasAdjustedWidth:n.adjustedWidth!==void 0&&n.adjustedWidth!==null,hasColumnEvidence:se,hasSpaceInfo:!!t},finalResult:xt?"✅ 커버도어 렌더링됨":"❌ 커버도어 렌더링 안됨"}),xt})()&&(console.log("🚪🚨 커버도어 렌더링 조건 체크 INSIDE:",{hasDoor:n.hasDoor,showFurniture:p,viewMode:a,isFurnitureDragging:I,isDraggingThis:o,isEditMode:s,hasColumn:Q==null?void 0:Q.hasColumn,columnType:Q==null?void 0:Q.columnType,isDeepColumn:(Q==null?void 0:Q.columnType)==="deep",hasAdjustedWidth:n.adjustedWidth!==void 0&&n.adjustedWidth!==null,adjustedWidth:n.adjustedWidth,originalSlotWidthMm:ee,furnitureWidthMm:M,원래슬롯중심:n.position.x,가구조정위치:_e==null?void 0:_e.x,차이:ee-M,BoxModule도어:Q&&Q.hasColumn?!1:n.hasDoor??!1,is2DHiddenFurniture:!p&&a==="2D",커버도어렌더링:!0}),!0)&&c.jsxs("group",{position:[(()=>{var xt;if(n.zone&&((xt=t.droppedCeiling)!=null&&xt.enabled)){const on=pr(t).zones||ar.calculateZoneSlotInfo(t,t.customColumnCount),ln=n.zone==="dropped"&&on.dropped?on.dropped:on.normal,li=n.slotIndex,hi=ln.slotCenters||ln.threeUnitPositions;if(hi&&li!==void 0&&li>=0&&li<hi.length)if(de&&li<hi.length-1){const Ii=ln.slotCenters?Xr.mmToThreeUnits(hi[li]):hi[li],kr=ln.slotCenters?Xr.mmToThreeUnits(hi[li+1]):hi[li+1];return(Ii+kr)/2}else return ln.slotCenters?Xr.mmToThreeUnits(hi[li]):hi[li]}if(V.threeUnitPositions&&n.slotIndex!==void 0)if(de&&n.slotIndex<V.threeUnitPositions.length-1){const Bt=V.threeUnitPositions[n.slotIndex],on=V.threeUnitPositions[n.slotIndex+1];return(Bt+on)/2}else return V.threeUnitPositions[n.slotIndex];return n.position.x})(),ft,_t+.02],rotation:[0,n.rotation*Math.PI/180,0],children:[console.log("🚪🚪 커버도어 렌더링 중:",{원래슬롯중심:n.position.x,가구위치:_e.x,도어X위치:(()=>{var xt;if(n.zone&&((xt=t.droppedCeiling)!=null&&xt.enabled)){const on=pr(t).zones||ar.calculateZoneSlotInfo(t,t.customColumnCount),ln=n.zone==="dropped"&&on.dropped?on.dropped:on.normal,li=n.slotIndex,hi=ln.slotCenters||ln.threeUnitPositions;if(hi&&li!==void 0&&li>=0&&li<hi.length)if(de&&li<hi.length-1){const Ii=ln.slotCenters?Xr.mmToThreeUnits(hi[li]):hi[li],kr=ln.slotCenters?Xr.mmToThreeUnits(hi[li+1]):hi[li+1];return(Ii+kr)/2}else return ln.slotCenters?Xr.mmToThreeUnits(hi[li]):hi[li]}if(V.threeUnitPositions&&n.slotIndex!==void 0)if(de&&n.slotIndex<V.threeUnitPositions.length-1){const Bt=V.threeUnitPositions[n.slotIndex],on=V.threeUnitPositions[n.slotIndex+1];return(Bt+on)/2}else return V.threeUnitPositions[n.slotIndex];return n.position.x})(),너비:ee,가구너비:M,차이:ee-M,슬롯인덱스:n.slotIndex,zone:n.zone,단내림활성화:(Ri=t.droppedCeiling)==null?void 0:Ri.enabled}),c.jsx(tu,{moduleWidth:ee,moduleDepth:it,hingePosition:Le,spaceInfo:O,color:Ee,doorXOffset:0,originalSlotWidth:ee,slotCenterX:0,moduleData:q,slotIndex:n.slotIndex,isDragging:o,isEditMode:s,slotWidths:(()=>{var xt;if(de){if(n.zone&&((xt=t.droppedCeiling)!=null&&xt.enabled)){const Bt=ar.calculateZoneSlotInfo(t,t.customColumnCount),on=n.zone==="dropped"&&Bt.dropped?Bt.dropped:Bt.normal;let ln=n.slotIndex;if(n.zone==="dropped"&&t.droppedCeiling.position==="right"?ln=n.slotIndex-Bt.normal.columnCount:n.zone==="normal"&&t.droppedCeiling.position==="left"&&(ln=n.slotIndex-Bt.dropped.columnCount),on.slotWidths&&ln>=0&&ln<on.slotWidths.length-1)return[on.slotWidths[ln],on.slotWidths[ln+1]]}else if(V.slotWidths&&n.slotIndex<V.slotWidths.length-1)return[V.slotWidths[n.slotIndex],V.slotWidths[n.slotIndex+1]]}})()})]}),!g&&j&&a==="3D"&&c.jsx(jm,{position:[_e.x+ae,(()=>{if((q==null?void 0:q.category)==="upper"){const xt=(q==null?void 0:q.dimensions.height)||800;return U(L.height-xt)-2.5}return i-1.8})(),_t+De/2+.5],center:!0,style:{userSelect:"none",pointerEvents:"auto",zIndex:100,background:"transparent"},children:c.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px"},children:c.jsx("div",{style:{cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",width:"32px",height:"32px",border:`2px solid ${te()}`,borderRadius:"50%",backgroundColor:"#ffffff",transition:"all 0.2s ease",opacity:T?1:.8,transform:T?"scale(1.1)":"scale(1)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},onClick:xt=>{if(xt.stopPropagation(),s){const Bt=Wi.getState().closeAllPopups;Bt()}else f(xt,n.id)},onPointerDown:xt=>xt.stopPropagation(),onMouseEnter:()=>k(!0),onMouseLeave:()=>k(!1),title:"가구 속성 편집",children:c.jsx(Ky,{color:te(),size:18})})})})]})},r2=n=>n*.01,Yhe=.11,Khe=({placedModules:n,spaceInfo:e})=>{var o;const t=H.useMemo(()=>Kr(e),[e]),{renderMode:i}=cr(),r=H.useMemo(()=>{const a={};n.forEach(u=>{const d=Zi(u.moduleId,t,e);if(!d)return;const A=d.category==="upper"||u.moduleId.includes("upper-cabinet"),f=d.category==="lower"||u.moduleId.includes("lower-cabinet");if(!A&&!f)return;const p=u.slotIndex??-1;if(!(p<0)){if(a[p]||(a[p]={}),A){if(a[p].upper=u,u.hasGapBackPanel&&(a[p].hasPanel=!0),u.isDualSlot){const g=p+1;a[g]||(a[g]={}),a[g].upper=u,u.hasGapBackPanel&&(a[g].hasPanel=!0)}}else if(f&&(a[p].lower=u,u.hasGapBackPanel&&(a[p].hasPanel=!0),u.isDualSlot)){const g=p+1;a[g]||(a[g]={}),a[g].lower=u,u.hasGapBackPanel&&(a[g].hasPanel=!0)}}});const l=[],h=new Set;return Object.entries(a).forEach(([u,d])=>{if(d.upper&&d.lower&&d.hasPanel){const A=parseInt(u),f=`${d.upper.id}-${d.lower.id}`;if(h.has(f))return;h.add(f);const p=Zi(d.upper.moduleId,t,e),g=Zi(d.lower.moduleId,t,e);if(!p||!g)return;const v=p.dimensions.height,w=g.dimensions.height,m=d.lower.position.y*100,y=m+w/2+18,x=d.upper.position.y*100,S=x-v/2-18,I=S-y;if(console.log("🎨 백패널 높이 계산 (실제 위치 기반):",{slotIndex:A,lowerModule:d.lower.moduleId,upperModule:d.upper.moduleId,lowerPosition_Y:d.lower.position.y,upperPosition_Y:d.upper.position.y,lowerCenterY_mm:m,upperCenterY_mm:x,lowerHeight:w,upperHeight:v,lowerTopY:y,upperBottomY:S,gapHeight:I,설명:"저장된 가구 위치를 직접 사용하여 백패널 위치 계산"}),I>0){const j=d.upper.adjustedWidth||d.upper.customWidth||p.dimensions.width,C=d.upper.customDepth||p.dimensions.depth;l.push({slotIndex:A,x:d.upper.position.x,y:r2(y+I/2+9),z:d.upper.position.z,width:r2(j),height:r2(I+18),depth:r2(18),furnitureDepth:r2(C)})}}}),l},[n,e,t]),s=((o=e.materialConfig)==null?void 0:o.doorColor)||"#E0E0E0";return c.jsx(c.Fragment,{children:r.map((a,l)=>c.jsx(Nk,{width:a.width,height:a.height,depth:a.depth,position:[a.x,a.y,a.z-a.furnitureDepth-Yhe],spaceInfo:e,doorColor:s,renderMode:i},`back-panel-${a.slotIndex}-${l}`))})},ux=({width:n,depth:e,intensity:t,position:i})=>{const{viewMode:r}=cr(),[s,o]=H.useState(null),[a,l]=H.useState(!1);return r==="2D"?(console.log("🚫 2D 모드라서 간접조명 렌더링 안함"),null):(H.useEffect(()=>{console.log("🔍 IndirectLight 컴포넌트 마운트됨",{width:n,depth:e,intensity:t,position:i});const h=new Image;return h.onload=()=>{console.log("✅ 이미지 로드 성공 (HTML Image):",h.width,"x",h.height),new A0().load("/images/lighting/light3000k.png",A=>{console.log("✅ Three.js 텍스처 로드 성공"),A.wrapS=qm,A.wrapT=qm,A.repeat.set(1,1),A.needsUpdate=!0,o(A)},A=>{console.log("⏳ 텍스처 로딩 중...",A)},A=>{console.error("❌ Three.js 텍스처 로드 실패:",A),l(!0)})},h.onerror=u=>{console.error("❌ HTML 이미지 로드 실패:",u),l(!0)},h.src="/images/lighting/light3000k.png",()=>{s&&s.dispose()}},[]),console.log("🎨 IndirectLight 렌더링 위치:",{hasTexture:!!s,loadError:a,width:n,depth:e,intensity:t,position:i,y위치:i[1]}),s?c.jsx("group",{position:i,children:c.jsxs("mesh",{rotation:[Math.PI,0,0],renderOrder:-1,frustumCulled:!1,children:[c.jsx("planeGeometry",{args:[n,e]}),c.jsx("meshBasicMaterial",{map:s,color:new Ms(1,.6,.2),transparent:!0,opacity:t*.5,side:Na,depthWrite:!1,depthTest:!0,blending:nZ})]})}):null)},Vf=n=>n*.01,Zj=({placedModules:n,spaceInfo:e})=>{const t=H.useMemo(()=>Kr(e),[e]),{viewMode:i}=cr(),{indirectLightEnabled:r,indirectLightIntensity:s}=Wi(),o=(u,d,A)=>{if(u.length===0)return[];const f=[...u].sort((v,w)=>{const m=v.slotIndex??-1,y=w.slotIndex??-1;return m-y}),p=[];let g=null;return f.forEach(v=>{const w=Zi(v.moduleId,t,e);if(!w)return;const m=v.adjustedWidth||v.customWidth||w.dimensions.width,y=v.customDepth||w.dimensions.depth;(v.moduleId.includes("tall")||v.moduleId.includes("pantry")||v.moduleId.includes("wardrobe"))&&console.log("🔦 키큰장 폭 계산:",{moduleId:v.moduleId,adjustedWidth:v.adjustedWidth,customWidth:v.customWidth,dimensionsWidth:w.dimensions.width,finalWidth:m});const x=Vf(m/2),S=v.position.x-x,I=v.position.x+x,j=Vf(y);!g||Math.abs(g.endX-S)>.01?(g={startX:S,endX:I,y:d,z:v.position.z,depth:j,height:A},p.push(g)):g.endX=I}),p},{upperCabinetGroups:a,floatingGroups:l}=H.useMemo(()=>{var w,m,y,x,S;const u=((w=e==null?void 0:e.baseConfig)==null?void 0:w.placementType)==="float"&&(((m=e==null?void 0:e.baseConfig)==null?void 0:m.floatHeight)||0)>0,d=((y=e==null?void 0:e.baseConfig)==null?void 0:y.floatHeight)||0,A=n.filter(I=>{const j=Zi(I.moduleId,t,e);return j&&(j.category==="upper"||I.moduleId.includes("upper-cabinet"))}),f=u?n.filter(I=>{const j=Zi(I.moduleId,t,e);return j&&!(j.category==="upper"||I.moduleId.includes("upper-cabinet"))}):[],p=A.map(I=>{const j=Zi(I.moduleId,t,e),C=I.customHeight||j.dimensions.height,b=820,D=t.height-C,k=b+(u?d:0),B=D-k,E=Vf(B)*2,z=Vf(k+B*.8);return{cabinet:I,lightY:z,lightHeight:E}}),g=p.length>0?o(p.map(I=>I.cabinet),((x=p[0])==null?void 0:x.lightY)||0,((S=p[0])==null?void 0:S.lightHeight)||0):[];console.log("🔦 띄움 배치 조명 생성:",{isFloatingMode:u,floatHeight:d,floatHeightInThreeUnits:Vf(d),lightY:Vf(d/2),floatingModulesCount:f.length});const v=u&&f.length>0?o(f,Vf(d/2),Vf(d)*2):[];return{upperCabinetGroups:g,floatingGroups:v}},[n,e,t]);return i==="2D"||i!=="3D"||!r?null:c.jsxs(c.Fragment,{children:[a.map((u,d)=>{const f=(u.endX-u.startX)*1.2,p=(u.startX+u.endX)/2;return c.jsxs(ci.Fragment,{children:[c.jsx(ux,{width:f,depth:u.height,intensity:s||.8,position:[p,u.y,u.z-u.depth/2-2.5]}),c.jsx(ux,{width:f,depth:u.height,intensity:s||.8,position:[p,u.y,u.z+u.depth/2-3]})]},`upper-cabinet-light-${d}`)}),l.map((u,d)=>{const A=u.endX-u.startX,f=A*1.2,p=(u.startX+u.endX)/2;return console.log("🔦 띄워서 배치 조명 상세:",{baseWidth:A,width:f,height:u.height,heightInMM:u.height/.01,y:u.y,z:u.z,depth:u.depth}),c.jsxs(ci.Fragment,{children:[c.jsx(ux,{width:f,depth:u.height,intensity:s||.8,position:[p,u.y,u.z-u.depth/2-2.5]}),c.jsx(ux,{width:f,depth:u.height,intensity:s||.8,position:[p,u.y,u.z+u.depth/2-3]})]},`floating-light-${d}`)})]})},Jj=({viewMode:n,view2DDirection:e,renderMode:t,placedModules:i,activeZone:r,showFurniture:s=!0,isReadOnly:o=!1})=>{var x,S,I;const{spaceInfo:a}=hr();ci.useEffect(()=>{var j,C;console.log("🎯 PlacedFurnitureContainer - spaceInfo 변경:",{baseConfig:a==null?void 0:a.baseConfig,placementType:(j=a==null?void 0:a.baseConfig)==null?void 0:j.placementType,floatHeight:(C=a==null?void 0:a.baseConfig)==null?void 0:C.floatHeight})},[(x=a==null?void 0:a.baseConfig)==null?void 0:x.placementType,(S=a==null?void 0:a.baseConfig)==null?void 0:S.floatHeight]);const l=pi(j=>j.placedModules),h=i||l,{activePopup:u}=Wi();ci.useEffect(()=>{console.log("🎯 PlacedFurnitureContainer - activeZone 변경:",{activeZone:r,placedModulesCount:h.length,placedModules:h.map(j=>({id:j.id,moduleId:j.moduleId,zone:j.zone,customWidth:j.customWidth,isDualSlot:j.isDualSlot}))})},[r]),ci.useEffect(()=>{console.log("📦📦📦 PlacedFurnitureContainer - placedModules 변경:",{count:h.length,modules:h.map(j=>({id:j.id,moduleId:j.moduleId,position:j.position,slotIndex:j.slotIndex,zone:j.zone}))})},[h]);const d=j=>j*.01,A=a.hasFloorFinish&&a.floorFinish?a.floorFinish.height:0,f=((I=a.baseConfig)==null?void 0:I.height)||0;let p;if(!a.baseConfig||a.baseConfig.type==="floor")p=d(A+f);else if(a.baseConfig.type==="stand")if(a.baseConfig.placementType==="float"){const j=a.baseConfig.floatHeight||0;p=d(A+j),console.log("🔥 띄워서 배치 Y 위치 계산:",{placementType:a.baseConfig.placementType,floorFinishHeightMm:A,floatHeightMm:j,totalHeightMm:A+j,furnitureStartY:p})}else p=d(A);else p=0;console.log("📍📍📍 PlacedFurnitureContainer - furnitureStartY 계산:",{baseConfig:a.baseConfig,floorFinishHeightMm:A,baseFrameHeightMm:f,furnitureStartY:p,furnitureStartY_mm:p/.01,설명:"하부장 시작 Y 위치"});const g=!!i;console.log("🎮 PlacedFurnitureContainer 모드:",{isViewerOnly:g,propPlacedModules:!!i,propPlacedModulesLength:i==null?void 0:i.length});const v=cce(),w=lce({spaceInfo:a});hce({spaceInfo:a});const m=g?{dragMode:!1,handleFurnitureClick:()=>{}}:v,y=g?{handlePointerDown:()=>{},handlePointerMove:()=>{},handlePointerUp:()=>{},draggingModuleId:null}:w;return c.jsxs("group",{children:[a&&c.jsx(Zj,{placedModules:h,spaceInfo:a}),a&&c.jsx(Khe,{placedModules:h,spaceInfo:a}),n==="3D"&&a&&c.jsx(Zj,{placedModules:h,spaceInfo:a}),h.map(j=>{var T;const C=m.dragMode,b=u.type==="furnitureEdit"&&u.id===j.id,D=y.draggingModuleId===j.id;return c.jsx(Xhe,{placedModule:j,placedModules:h,spaceInfo:a,furnitureStartY:p,isDragMode:C,isEditMode:b,isDraggingThis:D,viewMode:n,view2DDirection:e,renderMode:t,onPointerDown:y.handlePointerDown,onPointerMove:y.handlePointerMove,onPointerUp:y.handlePointerUp,onDoubleClick:m.handleFurnitureClick,showFurniture:s,isReadOnly:o},`${j.id}-${JSON.stringify(a.baseConfig)}-${JSON.stringify(a.droppedCeiling)}-${j.zone}-${JSON.stringify(a.frameSize)}-${a.surroundType}-${a.installType}-${((T=a.columns)==null?void 0:T.map(k=>`${k.id}-${k.position[0]}`).join("-"))||"no-columns"}-${j._lastYUpdate||0}`)})]})},kt=n=>n*.01,Gi=18,eP=(n,e)=>{if(n.surroundType!=="no-surround")return 0;const t=n.gapConfig||{left:20,right:20},i=n.wallConfig||{left:!0,right:!0};return n.installType==="builtin"||n.installType==="built-in"?e==="left"?t.left||2:t.right||2:n.installType==="semistanding"||n.installType==="semi-standing"?e==="left"?i.left?0:Gi:i.right?0:Gi:Gi},Gf=n=>20,qhe=({spaceInfo:n,floorColor:e="#B89B87",viewMode:t="3D",view2DDirection:i,materialConfig:r,showAll:s=!0,showFurniture:o=!0,showFrame:a=!0,placedModules:l,showDimensions:h,isStep2:u,renderMode:d,activeZone:A,isReadOnly:f=!1})=>{var st,At,ft,Xt,Yt,Zt,sn,vt;const p=ci.useRef(`room-${Date.now()}-${Math.random()}`).current;if(!n||typeof n.width!="number"||typeof n.height!="number")return null;const{theme:g}=Id(),v=pi(Ye=>Ye.placedModules),w=l||v;console.log("🔵 Room Component - Placed Modules:",{placedModules:l,placedModulesFromStore:v,actualPlacedModules:w});const{colors:m}=yk(),{renderMode:y}=cr(),x=d||y,{highlightedFrame:S,activeDroppedCeilingTab:I,view2DTheme:j}=Wi();H.useMemo(()=>new qU({color:e,transparent:!0,opacity:.85,side:Na,depthWrite:!1}),[e]);const C=H.useMemo(()=>{var jt,fn,Zn;console.log("🔍 Room Component - spaceInfo:",{roomId:p,surroundType:n.surroundType,installType:n.installType,frameSize:n.frameSize,showFrame:a,"showFrame prop value":a,timestamp:new Date().toISOString()});const{width:Ye,height:Gt}=Tz(n),Wt=Bz(n),Vt=boe(n),Jt=Coe(l),It=ga(n);console.log("🔥 calculateDimensionsAndFrames 내부 - frameThicknessMm 계산 직후:",{frameThicknessMm:It,wallConfig:n.wallConfig,installType:n.installType,surroundType:n.surroundType});const Ut=_oe(n),un=Ez(n),Sn=ym(n);return console.log("🔴🔴🔴 baseFrameHeightMm 계산 결과:",{baseFrameHeightMm:Sn,"spaceInfo.baseConfig":n.baseConfig,단내림:(jt=n.droppedCeiling)==null?void 0:jt.enabled,"기둥 개수":((fn=n.columns)==null?void 0:fn.length)||0}),console.log("🔍 Room - 프레임 계산 결과:",{surroundType:n.surroundType,installType:n.installType,wallConfig:n.wallConfig,frameThicknessMm:It,topBottomFrameHeightMm:un,baseFrameHeightMm:Sn,baseFrameMm:Ut,isNoSurround:n.surroundType==="no-surround",isBuiltin:n.installType==="builtin"||n.installType==="built-in",isSemistanding:n.installType==="semistanding"||n.installType==="semi-standing",shouldHideAllFrames:n.surroundType==="no-surround","예상 프레임":n.surroundType==="no-surround"&&(n.installType==="semistanding"||n.installType==="semi-standing")?(Zn=n.wallConfig)!=null&&Zn.left?"좌측: 0mm (벽있음), 우측: 18mm (엔드패널)":"좌측: 18mm (엔드패널), 우측: 0mm (벽있음)":"서라운드 또는 다른 타입"}),console.log("🔥 calculateDimensionsAndFrames - 변환 직전:",{"frameThicknessMm.left":It.left,"frameThicknessMm.right":It.right,"mmToThreeUnits(frameThicknessMm.left)":kt(It.left),"mmToThreeUnits(frameThicknessMm.right)":kt(It.right)}),{width:kt(Ye),height:kt(Gt),panelDepth:kt(Vt),furnitureDepth:kt(Jt),floorFinishHeight:kt(Wt),frameThickness:{left:kt(It.left),right:kt(It.right)},baseFrame:{width:kt(Ut.width)},topBottomFrameHeight:kt(un),baseFrameHeight:kt(Sn),widthMm:Ye,heightMm:Gt,panelDepthMm:Vt,furnitureDepthMm:Jt,floorFinishHeightMm:Wt,frameThicknessMm:It,baseFrameMm:Ut,topBottomFrameHeightMm:un,baseFrameHeightMm:Sn}},[n.width,n.height,n.depth,n.installType,n.surroundType,n.baseConfig,n.floorFinish,n.frameSize,n.wallConfig,l]),{width:b,height:D,panelDepth:T,furnitureDepth:k,floorFinishHeight:B,frameThickness:E,baseFrame:z,topBottomFrameHeight:te,baseFrameHeight:L,widthMm:O,heightMm:J,panelDepthMm:$,furnitureDepthMm:U,floorFinishHeightMm:Y,frameThicknessMm:K,baseFrameMm:V,topBottomFrameHeightMm:Q,baseFrameHeightMm:X}=C;console.log("🎯 Room - dimensions 디버깅:",{frameThicknessMm:K,frameThickness:E,wallConfig:n.wallConfig,installType:n.installType,surroundType:n.surroundType,계산된_엔드패널:{좌측mm:K.left,우측mm:K.right,좌측Three:E.left,우측Three:E.right}}),H.useMemo(()=>{var fn,Zn;const Ye=n.columns||[],Gt=Ye.some(Hn=>Hn.depth>=730);if(Ye.length===0||!Gt)return null;let Wt,Vt;if(n.surroundType==="no-surround"){const Hn=pr(n),{threeUnitBoundaries:ti}=Hn,ri=ti[0],bi=ti[ti.length-1],Ni=kt(Gi);let ui=ri,si=bi;n.installType==="freestanding"?(ui=ri+Ni,si=bi-Ni):(n.installType==="semistanding"||n.installType==="semi-standing")&&((fn=n.wallConfig)!=null&&fn.left?si=bi-Ni:(Zn=n.wallConfig)!=null&&Zn.right&&(ui=ri+Ni)),Wt=si-ui,Vt=(ui+si)/2}else Wt=z.width,Vt=-b/2+E.left+Wt/2;const Jt=[],It=Vt-Wt/2,Ut=Vt+Wt/2,un=[...Ye].sort((Hn,ti)=>Hn.position[0]-ti.position[0]);let Sn=It;un.forEach(Hn=>{const ti=Hn.width*.01,ri=Hn.position[0]-ti/2,bi=Hn.position[0]+ti/2;if(ri<Ut&&bi>It&&Hn.depth>=730){const Ni=Math.max(0,ri-Sn);Ni>0&&Jt.push({width:Ni,x:Sn+Ni/2}),Sn=bi}});const jt=Math.max(0,Ut-Sn);return jt>0&&Jt.push({width:jt,x:Sn+jt/2}),Jt.length>0?Jt:null},[n.columns,n.surroundType,n.width,(st=n.gapConfig)==null?void 0:st.left,(At=n.gapConfig)==null?void 0:At.right,z.width,E.left,b]);const W=H.useCallback(Ye=>{const Gt=t==="2D"&&j==="dark"?"#F0F0F0":"#E0E0E0",Wt=t==="2D"&&j==="dark"&&n.surroundType==="no-surround"&&(Ye==="left"||Ye==="right"||Ye==="base"||Ye==="top"),Vt=Wt?"#00FF00":(r==null?void 0:r.doorColor)||Gt;let Jt=!1;t==="2D"&&Ye==="base"&&(j==="dark"&&n.surroundType==="no-surround"||(Jt=!0));const It=Ye&&S===Ye;console.log(`🎨 Creating frame material for ${Ye}:`,{frameType:Ye,frameColor:Vt,isGreenFrame:Wt,doorTexture:r==null?void 0:r.doorTexture,isHighlighted:It,viewMode:t,view2DTheme:j,surroundType:n.surroundType,isNoSurroundDarkMode:t==="2D"&&j==="dark"&&n.surroundType==="no-surround",shouldBeGreen:Wt,baseFrameTransparent:Jt});const Ut=x==="wireframe"?"#FFFF00":"#FF0000",un=x==="wireframe"?4473856:2228224,Sn=.6,jt=x==="wireframe"&&Wt?"#00FF00":Vt,fn=new gl({color:new Ms(It?Ut:jt),metalness:0,roughness:.6,envMapIntensity:0,emissive:new Ms(It?un:Wt?65280:0),emissiveIntensity:It?1:Wt?.3:0,transparent:x==="wireframe"||t==="2D"&&x==="solid"||It||Jt,opacity:Jt?0:x==="wireframe"?It?Sn:Wt?.8:0:t==="2D"&&x==="solid"?.8:It?.6:1});return!It&&!Wt&&(r!=null&&r.doorTexture)&&(uA(r.doorTexture)&&(console.log("🔧 프레임 Cabinet Texture1 즉시 어둡게 적용 중..."),l1(fn),console.log("✅ 프레임 Cabinet Texture1 즉시 색상 적용 완료 (공통 설정 사용)")),new A0().load(r.doorTexture,Hn=>{console.log("🔧 프레임 텍스처 로딩 성공:",r.doorTexture),Hn.wrapS=Lu,Hn.wrapT=Lu,Hn.repeat.set(1,1),fn.map=Hn,uA(r.doorTexture)||(fn.color.setHex(16777215),fn.toneMapped=!0,fn.roughness=.6),fn.needsUpdate=!0},void 0,Hn=>{console.error("❌ 프레임 텍스처 로딩 실패:",r.doorTexture,Hn)})),fn},[r==null?void 0:r.doorColor,r==null?void 0:r.doorTexture,x,t,j,S,n.frameSize,n.baseConfig,n.droppedCeiling,n.surroundType]),se=JSON.stringify(n.columns??[]),[q,de]=H.useState(),[Ce,Se]=H.useState(),[fe,M]=H.useState(),[Z,Ae]=H.useState(),[ie,ee]=H.useState(),[ae,me]=H.useState(),[_e,ue]=H.useState();H.useEffect(()=>{const Ye=W("base");return de(Ye),()=>Ye.dispose()},[W,se,t,j,r==null?void 0:r.doorColor,r==null?void 0:r.doorTexture,S,n.droppedCeiling,n.surroundType]),H.useEffect(()=>{const Ye=W("left");return Se(Ye),()=>Ye.dispose()},[W,se,t,j,r==null?void 0:r.doorColor,r==null?void 0:r.doorTexture,S,n.droppedCeiling,n.surroundType]),H.useEffect(()=>{const Ye=W("left");return M(Ye),()=>Ye.dispose()},[W,se,t,j,r==null?void 0:r.doorColor,r==null?void 0:r.doorTexture,S,n.droppedCeiling,n.surroundType]),H.useEffect(()=>{const Ye=W("right");return Ae(Ye),()=>Ye.dispose()},[W,se,t,j,r==null?void 0:r.doorColor,r==null?void 0:r.doorTexture,S,n.droppedCeiling,n.surroundType]),H.useEffect(()=>{const Ye=W("right");return ee(Ye),()=>Ye.dispose()},[W,se,t,j,r==null?void 0:r.doorColor,r==null?void 0:r.doorTexture,S,n.droppedCeiling,n.surroundType]),H.useEffect(()=>{const Ye=W("top");return me(Ye),()=>Ye.dispose()},[W,se,t,j,r==null?void 0:r.doorColor,r==null?void 0:r.doorTexture,S,n.droppedCeiling,n.surroundType]),H.useEffect(()=>{const Ye=W("top");return ue(Ye),()=>Ye.dispose()},[W,se,t,j,r==null?void 0:r.doorColor,r==null?void 0:r.doorTexture,S,n.droppedCeiling,n.surroundType]),H.useMemo(()=>Da.createWallMaterial(),[]),H.useMemo(()=>Da.createWallMaterial(),[]),H.useMemo(()=>Da.createWallMaterial(),[]);const Be=-b/2,it=-T/2,De=it+(T-k)/2,qe=0,Je=kt(1200),Me=T+Je,et=it,He=z.width;z.width,n.surroundType==="no-surround"||Be+E.left+He/2;const ze=n.hasFloorFinish&&B>0?B:0,Oe=((ft=n.baseConfig)==null?void 0:ft.type)==="stand"&&((Xt=n.baseConfig)==null?void 0:Xt.placementType)==="float"?kt(n.baseConfig.floatHeight||0):0,ke=((Yt=n.droppedCeiling)!=null&&Yt.enabled,D-Oe),je=ze+D-te/2,_t=ze+Oe+ke/2,{wallConfig:Ee={left:!0,right:!0}}=n;console.log("🏠 Room - 노서라운드 프레임 체크:",{installType:n.installType,surroundType:n.surroundType,isNoSurround:n.surroundType==="no-surround",isBuiltin:n.installType==="builtin",isSemistanding:n.installType==="semistanding",wallConfig:Ee,frameThicknessMm:K,frameThickness:E,leftPanel:E.left>0?`${K.left}mm`:"none",rightPanel:E.right>0?`${K.right}mm`:"none",shouldHaveEndPanelLeft:n.surroundType==="no-surround"&&n.installType==="semistanding"&&!(Ee!=null&&Ee.left),shouldHaveEndPanelRight:n.surroundType==="no-surround"&&n.installType==="semistanding"&&!(Ee!=null&&Ee.right)});const Le=Kr(n),ye=-kt(Le.depth/2),nt=De+k/2-ye;return(n.installType==="freestanding"||n.installType==="semistanding"&&(!(Ee!=null&&Ee.left)||!(Ee!=null&&Ee.right)))&&console.log("🔍 엔드패널 깊이 비교:",{서라운드_깊이mm:nt/.01,노서라운드_깊이mm:(nt-kt(Gi))/.01,차이mm:Gi,slotFloorDepth:nt,노서라운드깊이:nt-kt(20)}),c.jsxs("group",{position:[0,0,qe],children:[console.log("🔍 Room viewMode 체크:",t,typeof t),t!=="2D"&&c.jsxs(c.Fragment,{children:[console.log("🔍 왼쪽 벽 installType 체크:",{installType:n.installType,wallConfig:Ee,wallConfigLeft:Ee==null?void 0:Ee.left,condition:n.installType==="builtin"||n.installType==="built-in"||n.installType==="semistanding"&&(Ee==null?void 0:Ee.left)}),(n.installType==="builtin"||n.installType==="built-in"||n.installType==="semistanding"&&(Ee==null?void 0:Ee.left))&&(()=>{var Jt,It;const Ye=(Jt=n.droppedCeiling)==null?void 0:Jt.enabled,Gt=((It=n.droppedCeiling)==null?void 0:It.position)==="left",Wt=Ye&&n.droppedCeiling?n.droppedCeiling.dropHeight||200:0,Vt=kt(Wt);if(console.log("🔍 왼쪽 벽 단내림 조건 체크:",{"spaceInfo.droppedCeiling":n.droppedCeiling,hasDroppedCeiling:Ye,isLeftDropped:Gt,dropHeight:Wt,condition:Ye&&Gt,"spaceInfo.height":n.height,"droppedHeight(mm)":n.height-Wt,"height(Three.js)":D/.01,"droppedHeight(Three.js)":(n.height-Wt)*.01}),Ye&&Gt){const Ut=D-Vt,un=ze+Ut/2;return console.log("🔴 왼쪽 단내림 벽 렌더링:",{"전체 높이":D/.01,"단내림 높이차":Vt/.01,"단내림 벽 높이":Ut/.01,panelStartY:ze,droppedCenterY:un}),c.jsxs("mesh",{position:[-b/2-.001,un,et+Me/2],rotation:[0,Math.PI/2,0],children:[c.jsx("planeGeometry",{args:[Me,Ut]}),c.jsx("primitive",{object:Da.createShaderGradientWallMaterial("horizontal")})]})}return!Ye||!Gt?c.jsxs("mesh",{position:[-b/2-.001,ze+D/2,et+Me/2],rotation:[0,Math.PI/2,0],children:[c.jsx("planeGeometry",{args:[Me,D]}),c.jsx("primitive",{object:Da.createShaderGradientWallMaterial("horizontal")})]}):null})(),(n.installType==="builtin"||n.installType==="built-in"||n.installType==="semistanding"&&(Ee==null?void 0:Ee.right))&&(()=>{var Jt,It;const Ye=(Jt=n.droppedCeiling)==null?void 0:Jt.enabled,Gt=((It=n.droppedCeiling)==null?void 0:It.position)==="right",Wt=Ye&&n.droppedCeiling?n.droppedCeiling.dropHeight||200:0,Vt=kt(Wt);if(console.log("🔍 오른쪽 벽 단내림 조건 체크:",{"spaceInfo.droppedCeiling":n.droppedCeiling,hasDroppedCeiling:Ye,isRightDropped:Gt,dropHeight:Wt,condition:Ye&&Gt,viewMode:t,"벽 렌더링 조건":t==="3D"||t==="3d"}),Ye&&Gt){const Ut=D-Vt,un=ze+Ut/2;return console.log("🔵 오른쪽 단내림 벽 렌더링:",{"전체 높이":D/.01,"단내림 높이차":Vt/.01,"단내림 벽 높이":Ut/.01,panelStartY:ze,droppedCenterY:un}),c.jsxs("mesh",{position:[b/2+.001,un,et+Me/2],rotation:[0,-Math.PI/2,0],children:[c.jsx("planeGeometry",{args:[Me,Ut]}),c.jsx("primitive",{object:Da.createShaderGradientWallMaterial("horizontal-reverse")})]})}return!Ye||!Gt?c.jsxs("mesh",{position:[b/2+.001,ze+D/2,et+Me/2],rotation:[0,-Math.PI/2,0],children:[c.jsx("planeGeometry",{args:[Me,D]}),c.jsx("primitive",{object:Da.createShaderGradientWallMaterial("horizontal-reverse")})]}):null})(),t!=="2D"&&(()=>{var Zn,Hn,ti;const Ye=(Zn=n.droppedCeiling)==null?void 0:Zn.enabled,Gt=Ye&&n.droppedCeiling?kt(n.droppedCeiling.width||DEFAULT_DROPPED_CEILING_VALUES.WIDTH):0,Wt=((Hn=n.droppedCeiling)==null?void 0:Hn.position)==="left",Vt=Ye&&n.droppedCeiling?n.droppedCeiling.dropHeight||200:0,Jt=kt(Vt);if(!Ye)return c.jsxs("mesh",{position:[Be+b/2,ze+D+.001,et+Me/2],rotation:[Math.PI/2,0,0],children:[c.jsx("planeGeometry",{args:[b,Me]}),c.jsx("primitive",{object:Da.createShaderGradientWallMaterial("vertical-reverse")})]});let It=0,Ut=0;if(n.surroundType==="surround"){const ri=ga(n);It=ri.left,Ut=ri.right}else n.installType==="builtin"?(It=2,Ut=2):n.installType==="semistanding"?(ti=n.wallConfig)!=null&&ti.left?(It=2,Ut=Gi):(It=Gi,Ut=2):(It=20,Ut=20);let un,Sn;Wt?(un=Gt,Sn=b-Gt):(Sn=b-Gt,un=Gt);const jt=Wt?Be+un/2:Be+Sn+un/2,fn=Wt?Be+un+Sn/2:Be+Sn/2;return console.log("🔥 천장 분할 계산:",{hasDroppedCeiling:Ye,surroundType:n.surroundType,installType:n.installType,wallConfig:n.wallConfig,leftReduction:It,rightReduction:Ut,droppedWidth:Gt/.01,droppedAreaWidth:un/.01,normalAreaWidth:Sn/.01,droppedAreaX:jt,normalAreaX:fn,droppedCeilingHeight:Jt/.01,totalWidth:b/.01,calculatedTotal:(un+Sn+kt(It)+kt(Ut))/.01}),c.jsxs(c.Fragment,{children:[c.jsxs("mesh",{position:[jt,ze+D-Jt+.001,et+Me/2],rotation:[Math.PI/2,0,0],children:[c.jsx("planeGeometry",{args:[un,Me]}),c.jsx("primitive",{object:Da.createShaderGradientWallMaterial("vertical-reverse")})]}),c.jsxs("mesh",{position:[fn,ze+D+.001,et+Me/2],rotation:[Math.PI/2,0,0],children:[c.jsx("planeGeometry",{args:[Sn,Me]}),c.jsx("primitive",{object:Da.createShaderGradientWallMaterial("vertical-reverse")})]})]})})(),t!=="2D"&&c.jsxs("mesh",{position:[Be+b/2,ze-.001,et+Me/2],rotation:[-Math.PI/2,0,0],children:[c.jsx("planeGeometry",{args:[b,Me]}),c.jsx("primitive",{object:Da.createShaderGradientWallMaterial("vertical")})]}),[],console.log("🔍 백패널 렌더링 조건:",{viewMode:t,view2DDirection:i,is2DFront:t==="2D"&&i==="front",position:[Be+b/2,ze+D/2,it-.01]}),c.jsxs("mesh",{position:[Be+b/2,ze+D/2,et+Me/2],children:[c.jsx("planeGeometry",{args:[b,Me]}),c.jsx("meshStandardMaterial",{color:"#ffffff",transparent:!0,opacity:0,side:Na})]}),c.jsxs("mesh",{position:[-b/2,ze+D/2,it+T/2],rotation:[0,0,0],children:[c.jsx("planeGeometry",{args:[.02,D]}),c.jsx("primitive",{object:Da.createEdgeShadowMaterial()})]}),c.jsxs("mesh",{position:[b/2,ze+D/2,it+T/2],rotation:[0,0,0],children:[c.jsx("planeGeometry",{args:[.02,D]}),c.jsx("primitive",{object:Da.createEdgeShadowMaterial()})]}),c.jsxs("mesh",{position:[Be+b/2,ze+D,it+T/2],rotation:[0,0,Math.PI/2],children:[c.jsx("planeGeometry",{args:[.02,b]}),c.jsx("primitive",{object:Da.createEdgeShadowMaterial()})]}),c.jsxs("mesh",{position:[Be+b/2,ze,it+T/2],rotation:[0,0,Math.PI/2],children:[c.jsx("planeGeometry",{args:[.02,b]}),c.jsx("primitive",{object:Da.createEdgeShadowMaterial()})]}),c.jsxs("mesh",{position:[-b/2,ze+D,et+Me/2],rotation:[Math.PI/2,0,0],children:[c.jsx("planeGeometry",{args:[.02,Me]}),c.jsx("primitive",{object:Da.createEdgeShadowMaterial()})]}),c.jsxs("mesh",{position:[b/2,ze+D,et+Me/2],rotation:[Math.PI/2,0,0],children:[c.jsx("planeGeometry",{args:[.02,Me]}),c.jsx("primitive",{object:Da.createEdgeShadowMaterial()})]}),c.jsxs("mesh",{position:[-b/2,ze,et+Me/2],rotation:[Math.PI/2,0,0],children:[c.jsx("planeGeometry",{args:[.02,Me]}),c.jsx("primitive",{object:Da.createEdgeShadowMaterial()})]}),c.jsxs("mesh",{position:[b/2,ze,et+Me/2],rotation:[Math.PI/2,0,0],children:[c.jsx("planeGeometry",{args:[.02,Me]}),c.jsx("primitive",{object:Da.createEdgeShadowMaterial()})]}),((Zt=n.droppedCeiling)==null?void 0:Zt.enabled)&&(()=>{const Ye=n.droppedCeiling.position==="left",Gt=kt(n.droppedCeiling.dropHeight||200),Wt=ar.calculateZoneSlotInfo(n,n.customColumnCount);return c.jsxs("mesh",{position:[kt(Ye?Wt.normal.startX:Wt.dropped.startX),ze+D-Gt/2,et+Me/2],rotation:[0,Math.PI/2,0],children:[c.jsx("planeGeometry",{args:[Me,Gt]}),c.jsx("primitive",{object:Da.createShaderGradientWallMaterial("horizontal")})]})})()]}),n.hasFloorFinish&&B>0&&!(t==="2D"&&i==="top")&&c.jsx(_i,{args:[b,B,T],position:[Be+b/2,B/2,0],material:new gl({color:e,transparent:!1,side:Na,roughness:.8,metalness:.1,depthWrite:!0,polygonOffset:!0,polygonOffsetFactor:-1,polygonOffsetUnits:-1}),renderMode:x}),s&&!(t==="2D"&&i==="front")&&(()=>{var vn,wi;const Ye=Kr(n),Gt=Ve=>Ve*.01,Vt=-Gt(Ye.depth/2),Jt=ar.calculateZoneSlotInfo(n,n.customColumnCount),It=Gt(Jt.normal.startX),Ut=Gt(Jt.normal.startX+Jt.normal.width),un=Ut-It,Sn=(It+Ut)/2,jt=k,fn=De,Hn=De+k/2-Vt-Gt(Gi),ti=n.columns||[],ri=Gt(Ye.startY)+(((vn=n.baseConfig)==null?void 0:vn.type)==="stand"&&((wi=n.baseConfig)==null?void 0:wi.placementType)==="float"?Oe:0);console.log("🎯 Floor mesh Y calculation:",{internalSpace_startY:Ye.startY,baseFrameHeightMm:X,floorFinishHeightMm:Y,floatHeight:Oe,floorY:ri,baseConfig:n.baseConfig,panelStartY:ze});const bi=ti.some(Ve=>Ve.depth>=730);if(ti.length===0||!bi)return c.jsxs("mesh",{position:[Sn,ri+.001,fn],rotation:[0,0,0],renderOrder:100,frustumCulled:!1,children:[c.jsx("boxGeometry",{args:[un,.01,jt]}),c.jsx("meshBasicMaterial",{color:"#10b981",transparent:!0,opacity:.1,side:Na,depthWrite:!1,depthTest:!0})]});const Ni=[],ui=It,si=Ut,Li=Sn,Tr=[...ti].sort((Ve,ct)=>Ve.position[0]-ct.position[0]);let xr=ui;Tr.forEach((Ve,ct)=>{const mt=Ve.width*.01,An=Ve.position[0]-mt/2,nn=Ve.position[0]+mt/2;if(An<si&&nn>ui&&Ve.depth>=730){const zt=Math.max(0,An-xr);zt>0&&Ni.push({width:zt,x:xr+zt/2}),xr=nn}});const br=Math.max(0,si-xr);return br>0&&Ni.push({width:br,x:xr+br/2}),Ni.length===0?c.jsxs("mesh",{position:[Li,ri,Vt+Hn/2],rotation:[-Math.PI/2,0,0],castShadow:!1,receiveShadow:!1,frustumCulled:!1,children:[c.jsx("planeGeometry",{args:[un,Hn]}),c.jsx("meshStandardMaterial",{color:m.primary,transparent:!0,opacity:.4,side:Na})]}):null})(),n.surroundType==="no-surround"&&(n.installType==="builtin"||n.installType==="built-in")&&console.log("🔍 프레임 렌더링 체크:",{showFrame:a,frameThicknessLeft:E.left,frameThicknessRight:E.right,leftCondition:a&&E.left>0,rightCondition:a&&E.right>0}),console.log("🔍 왼쪽 프레임/엔드패널 렌더링 체크:",{showFrame:a,frameThicknessLeft:E.left,frameThicknessLeftMm:K.left,condition:a&&E.left>0,surroundType:n.surroundType,installType:n.installType,wallConfigLeft:Ee==null?void 0:Ee.left,wallConfigRight:Ee==null?void 0:Ee.right,예상:Ee!=null&&Ee.left?"왼쪽에 프레임 없음":"왼쪽에 엔드패널 있어야 함"}),console.log("🚨 왼쪽 엔드패널 렌더링 직전 체크:",{frameThicknessLeft:E.left,frameThicknessLeftMm:K.left,"frameThickness.left > 0":E.left>0,showFrame:a,"showFrame && frameThickness.left > 0":a&&E.left>0}),a&&E.left>0&&i!=="left"&&i!=="right"&&(()=>{var Vt,Jt;const Ye=(Vt=n.droppedCeiling)==null?void 0:Vt.enabled,Gt=((Jt=n.droppedCeiling)==null?void 0:Jt.position)==="left",Wt=Ye&&n.droppedCeiling?n.droppedCeiling.dropHeight||200:0;if(Ye&&Gt){const It=ke-kt(Wt),Ut=ze+Oe+It/2;return c.jsx(c.Fragment,{children:c.jsx(_i,{isEndPanel:!(Ee!=null&&Ee.left),args:[E.left,It,n.surroundType==="no-surround"?Ee!=null&&Ee.left?kt(Gi):De+k/2-kt(20)-ye:(n.installType==="semistanding"||n.installType==="semi-standing")&&!(Ee!=null&&Ee.left)||n.installType==="freestanding"||n.installType==="free-standing"?nt:kt(Gi)],position:[Be+E.left/2,Ut,n.surroundType==="no-surround"?Ee!=null&&Ee.left?De+k/2-kt(Gi)/2:ye+(De+k/2-kt(20)-ye)/2:(n.installType==="semistanding"||n.installType==="semi-standing")&&!(Ee!=null&&Ee.left)||n.installType==="freestanding"||n.installType==="free-standing"?ye+nt/2:De+k/2-kt(Gi)/2],material:Ce,renderMode:x,view2DTheme:j})})}return console.log("🔍 왼쪽 엔드패널 렌더링 디버그:",{frameThicknessLeft:E.left,wallConfigLeft:Ee==null?void 0:Ee.left,surroundType:n.surroundType,installType:n.installType,깊이:Ee!=null&&Ee.left?"프레임(18mm)":"엔드패널(전체깊이-18mm)",위치:Ee!=null&&Ee.left?"프레임위치":"엔드패널위치"}),c.jsx(_i,{isEndPanel:!(Ee!=null&&Ee.left),args:[E.left,ke,n.surroundType==="no-surround"?Ee!=null&&Ee.left?kt(Gi):De+k/2-kt(20)-ye:(n.installType==="semistanding"||n.installType==="semi-standing")&&!(Ee!=null&&Ee.left)||n.installType==="freestanding"||n.installType==="free-standing"?nt:kt(Gi)],position:[Be+E.left/2,_t,n.surroundType==="no-surround"?Ee!=null&&Ee.left?De+k/2-kt(Gi)/2:ye+(De+k/2-kt(20)-ye)/2:(n.installType==="semistanding"||n.installType==="semi-standing")&&!(Ee!=null&&Ee.left)||n.installType==="freestanding"||n.installType==="free-standing"?ye+nt/2:De+k/2-kt(Gi)/2],material:Ce,renderMode:x,view2DTheme:j,onClick:It=>{It.stopPropagation(),console.log("🎯 좌측 프레임 클릭",{showFrame:a,frameThicknessLeft:E.left,view2DDirection:i,wallConfigLeft:Ee==null?void 0:Ee.left})}})})(),a&&E.right>0&&i!=="left"&&i!=="right"&&(()=>{var Vt,Jt;const Ye=(Vt=n.droppedCeiling)==null?void 0:Vt.enabled,Gt=Ye&&((Jt=n.droppedCeiling)==null?void 0:Jt.position)==="right",Wt=Ye&&n.droppedCeiling?n.droppedCeiling.dropHeight||200:0;if(Ye&&Gt){const It=ke-kt(Wt),Ut=ze+Oe+It/2;return c.jsx(c.Fragment,{children:c.jsx(_i,{isEndPanel:!(Ee!=null&&Ee.right),args:[E.right,It,n.surroundType==="no-surround"?Ee!=null&&Ee.right?kt(Gi):De+k/2-kt(20)-ye:(n.installType==="semistanding"||n.installType==="semi-standing")&&!(Ee!=null&&Ee.right)||n.installType==="freestanding"||n.installType==="free-standing"?nt:kt(Gi)],position:[Be+b-E.right/2,Ut,n.surroundType==="no-surround"?Ee!=null&&Ee.right?De+k/2-kt(Gi)/2:ye+(De+k/2-kt(20)-ye)/2:(n.installType==="semistanding"||n.installType==="semi-standing")&&!(Ee!=null&&Ee.right)||n.installType==="freestanding"||n.installType==="free-standing"?ye+nt/2:De+k/2-kt(Gi)/2],material:Z,renderMode:x})})}return c.jsx(_i,{isEndPanel:!(Ee!=null&&Ee.right),args:[E.right,ke,n.surroundType==="no-surround"?Ee!=null&&Ee.right?kt(Gi):De+k/2-kt(20)-ye:(n.installType==="semistanding"||n.installType==="semi-standing")&&!(Ee!=null&&Ee.right)||n.installType==="freestanding"||n.installType==="free-standing"?nt:kt(Gi)],position:[Be+b-E.right/2,_t,n.surroundType==="no-surround"?Ee!=null&&Ee.right?De+k/2-kt(Gi)/2:ye+(De+k/2-kt(20)-ye)/2:(n.installType==="semistanding"||n.installType==="semi-standing")&&!(Ee!=null&&Ee.right)||n.installType==="freestanding"||n.installType==="free-standing"?ye+nt/2:De+k/2-kt(Gi)/2],material:Z,renderMode:x,onClick:It=>{It.stopPropagation(),console.log("🎯 우측 프레임 클릭",{showFrame:a,frameThicknessRight:E.right,view2DDirection:i,wallConfigRight:Ee==null?void 0:Ee.right})}})})(),a&&Q>0&&c.jsx(c.Fragment,{children:(()=>{var Tr,xr,br,vn,wi,Ve;const Ye=n.columns||[],Gt=(Tr=n.droppedCeiling)==null?void 0:Tr.enabled;let Wt=0,Vt=!1;if(Gt&&n.droppedCeiling){Wt=kt(n.droppedCeiling.width||DEFAULT_DROPPED_CEILING_VALUES.WIDTH);const ct=n.droppedCeiling.dropHeight||200;kt(n.height-ct),Vt=n.droppedCeiling.position==="left"}let Jt,It;if(Gt){const ct=up(n);Jt=kt(ct.startX),It=kt(ct.endX)}else{const mt=ar.calculateZoneSlotInfo(n,n.customColumnCount).normal;Jt=kt(mt.startX),It=kt(mt.startX+mt.width)}const Ut=It-Jt,un=(Jt+It)/2,Sn=Ye.some(ct=>ct.depth>=730);if((Ye.length===0||!Sn)&&!Gt)return c.jsx(_i,{args:[Ut,te,kt(Gi)],position:[un,je,De+k/2-kt(Gi)/2-kt(Gf())],material:ae,renderMode:x});if(Gt&&Sn){const ct=[],mt=[],An=up(n),nn=gp(n),zt=kt(An.startX),gn=kt(An.endX),Jn=kt(nn.startX),Qn=kt(nn.endX),pn=Ye.filter(Bn=>{const Ri=Bn.position[0],xt=Vt?Qn:Jn;return(Vt?Ri>=xt:Ri<xt)&&Bn.depth>=730}).sort((Bn,Ri)=>Bn.position[0]-Ri.position[0]),Ln=Ye.filter(Bn=>{const Ri=Bn.position[0],xt=Vt?Qn:Jn;return(Vt?Ri<xt:Ri>xt)&&Bn.depth>=730}).sort((Bn,Ri)=>Bn.position[0]-Ri.position[0]);let Dn=zt;pn.forEach(Bn=>{const Ri=Bn.width*.01,xt=Bn.position[0]-Ri/2,Bt=Bn.position[0]+Ri/2;if(xt<gn&&Bt>zt){const on=Math.max(0,xt-Dn);on>0&&ct.push({width:on,x:Dn+on/2,zone:"normal"}),Dn=Bt}});const ei=Math.max(0,gn-Dn);ei>0&&ct.push({width:ei,x:Dn+ei/2,zone:"normal"}),Dn=Jn,Ln.forEach(Bn=>{const Ri=Bn.width*.01,xt=Bn.position[0]-Ri/2,Bt=Bn.position[0]+Ri/2;if(xt<Qn&&Bt>Jn){const on=Math.max(0,xt-Dn);on>0&&mt.push({width:on,x:Dn+on/2,zone:"dropped"}),Dn=Bt}});const xi=Math.max(0,Qn-Dn);xi>0&&mt.push({width:xi,x:Dn+xi/2,zone:"dropped"});const Yi=[...ct,...mt];return console.log("🔥 단내림+기둥 프레임 세그먼트:",{normalSegments:ct.map(Bn=>({x:Bn.x/.01,width:Bn.width/.01,zone:Bn.zone})),droppedSegments:mt.map(Bn=>({x:Bn.x/.01,width:Bn.width/.01,zone:Bn.zone}))}),Yi.map((Bn,Ri)=>{let xt=je;return Bn.zone==="dropped"&&(xt=je-kt(n.droppedCeiling.dropHeight)),c.jsx(_i,{args:[Bn.width,te,kt(Gi)],position:[Bn.x,xt,De+k/2-kt(Gi)/2-kt(Gf())],material:ae,renderMode:x},`top-frame-segment-${Ri}`)})}if(Gt&&!Sn){const ct=up(n),mt=gp(n);kt(Math.min(ct.startX,mt.startX)),kt(Math.max(ct.endX,mt.endX)),kt(Vt?mt.endX:mt.startX);let An,nn,zt=0,gn=0;if(n.surroundType==="surround"){const Bt=ga(n);zt=Bt.left,gn=Bt.right}else n.installType==="builtin"?(zt=eP(n,"left"),gn=eP(n,"right")):n.installType==="semistanding"?(xr=n.wallConfig)!=null&&xr.left?(zt=0,gn=Gi):((br=n.wallConfig)!=null&&br.right,zt=Gi,gn=0):(zt=Gi,gn=Gi);const Jn=kt(mt.width),Qn=kt(ct.width);Vt?(An=Jn,nn=Qn,An-=kt(zt),nn-=kt(gn)):(nn=Qn,An=Jn,nn-=kt(zt),An-=kt(gn));const pn=kt(ct.startX),Ln=kt(mt.startX),Dn=ar.calculateZoneSlotInfo(n,n.customColumnCount),ei=kt(Dn.dropped.startX),xi=kt(Dn.dropped.width),Yi=kt(Dn.normal.startX),Bn=kt(Dn.normal.width);let Ri=ei+xi/2,xt=Yi+Bn/2;return An=xi,nn=Bn,console.log("🔥 상부 프레임 너비 상세 계산:",{전체너비mm:b/.01,frameWidth_mm:Ut/.01,droppedWidth_mm:Wt/.01,leftReduction:zt,rightReduction:gn,메인구간프레임너비_mm:nn/.01,단내림구간프레임너비_mm:An/.01,단내림위치:Vt?"왼쪽":"오른쪽",위치정보:{normalStartX_mm:pn/.01,droppedStartX_mm:Ln/.01,경계점_mm:(Vt?pn:Ln)/.01},계산검증:{"단내림+메인":(An+nn)/.01,전체내부너비:(kt(n.width)-kt(zt+gn))/.01}}),console.log("🎨🎨 상부프레임 렌더링 (단내림 있음):",{topFrameMaterial:!!ae,materialType:ae==null?void 0:ae.type,materialColor:ae&&"color"in ae?(vn=ae.color)==null?void 0:vn.getHexString():"none",단내림:(wi=n.droppedCeiling)==null?void 0:wi.enabled,기둥개수:Ye.length}),c.jsxs(c.Fragment,{children:[xi>0&&c.jsx(_i,{args:[xi,te,kt(Gi)],position:[Ri,je-kt(n.droppedCeiling.dropHeight),De+k/2-kt(Gi)/2-kt(Gf())],material:ae,renderMode:x}),Bn>0&&c.jsx(_i,{args:[Bn,te,kt(Gi)],position:[xt,je,De+k/2-kt(Gi)/2-kt(Gf())],material:ae,renderMode:x})]})}const jt=[];let fn,Zn,Hn,ti,ri,bi;if(Gt){const ct=up(n),mt=gp(n);Hn=kt(ct.startX),ti=kt(ct.endX),ri=kt(mt.startX),bi=kt(mt.endX),fn=Math.min(Hn,ri),Zn=Math.max(ti,bi)}else fn=un-Ut/2,Zn=un+Ut/2;const Ni=[...Ye].sort((ct,mt)=>ct.position[0]-mt.position[0]);let ui=fn;Ni.forEach((ct,mt)=>{const An=ct.width*.01,nn=ct.position[0]-An/2,zt=ct.position[0]+An/2;if(Gt){const gn=ct.position[0],Jn=Vt?bi:ri,Qn=Vt?gn<Jn:gn>Jn;if(Qn&&ui>=Hn&&ui<ti||!Qn&&ui>=ri&&ui<bi)return}if(nn<Zn&&zt>fn&&ct.depth>=730){const gn=Math.max(0,nn-ui);gn>0&&jt.push({width:gn,x:ui+gn/2}),ui=zt}});const si=Math.max(0,It-ui);if(si>0&&jt.push({width:si,x:ui+si/2}),jt.length===0){console.log("🎨🎨 상부프레임 렌더링 (기본):",{topFrameMaterial:!!ae,materialType:ae==null?void 0:ae.type,materialColor:ae&&"color"in ae?(Ve=ae.color)==null?void 0:Ve.getHexString():"none"});const ct=ar.calculateZoneSlotInfo(n,n.customColumnCount),mt=kt(ct.normal.startX),An=kt(ct.normal.width),nn=mt+An/2;return c.jsx(_i,{args:[An,te,kt(Gi)],position:[nn,je,De+k/2-kt(Gi)/2-kt(Gf())],material:ae,renderMode:x})}let Li=jt;return Gt&&(console.log("🔥 프레임 세그먼트 분리 전:",{frameSegments:jt.map(ct=>({x:ct.x/.01,width:ct.width/.01,left:(ct.x-ct.width/2)/.01,right:(ct.x+ct.width/2)/.01})),normalBounds:{start:Hn/.01,end:ti/.01},droppedBounds:{start:ri/.01,end:bi/.01},boundary:(Vt?bi:ri)/.01}),Li=[],jt.forEach(ct=>{const mt=ct.x-ct.width/2,An=ct.x+ct.width/2,nn=Vt?bi:ri;if(Vt)if(An<=nn)Li.push({...ct,zone:"dropped"});else if(mt>=nn)Li.push({...ct,zone:"normal"});else{const zt=nn-mt,gn=An-nn;zt>0&&Li.push({width:zt,x:mt+zt/2,zone:"dropped"}),gn>0&&Li.push({width:gn,x:nn+gn/2,zone:"normal"})}else if(An<=nn)Li.push({...ct,zone:"normal"});else if(mt>=nn)Li.push({...ct,zone:"dropped"});else{const zt=nn-mt,gn=An-nn;zt>0&&Li.push({width:zt,x:mt+zt/2,zone:"normal"}),gn>0&&Li.push({width:gn,x:nn+gn/2,zone:"dropped"})}}),console.log("🔥 프레임 세그먼트 분리 후:",{finalSegments:Li.map(ct=>({x:ct.x/.01,width:ct.width/.01,left:(ct.x-ct.width/2)/.01,right:(ct.x+ct.width/2)/.01,zone:ct.zone}))})),Li.map((ct,mt)=>{console.log(`🎨 Top frame segment ${mt} - 분절된 상부 프레임 재질:`,{hasTopFrameMaterial:!!ae,materialReady:ae!==void 0,materialType:ae==null?void 0:ae.type,materialColor:ae&&"color"in ae?ae.color.getHexString():"none",materialTexture:ae&&"map"in ae?!!ae.map:!1,doorColor:r==null?void 0:r.doorColor,doorTexture:r==null?void 0:r.doorTexture,segmentWidth:ct.width,segmentX:ct.x,segmentZone:ct.zone});let An=je;return Gt&&n.droppedCeiling&&ct.zone&&ct.zone==="dropped"&&(An=je-kt(n.droppedCeiling.dropHeight)),c.jsx(_i,{args:[ct.width,te,kt(Gi)],position:[ct.x,An,De+k/2-kt(Gi)/2-kt(Gf())],material:ae,renderMode:x},`top-frame-segment-${mt}`)})})()}),!1,a&&n.surroundType!=="no-surround"&&((sn=n.frameSize)==null?void 0:sn.left)>=20&&i!=="left"&&i!=="right"&&(n.installType==="builtin"||n.installType==="built-in"||n.installType==="semistanding"&&(Ee==null?void 0:Ee.left))&&(()=>{var Zn,Hn,ti,ri,bi,Ni;const Ye=w==null?void 0:w.filter(ui=>{var si,Li,Tr,xr,br,vn;return((si=ui.moduleId)==null?void 0:si.toLowerCase().includes("upper-cabinet"))||((Li=ui.moduleId)==null?void 0:Li.toLowerCase().includes("lower-cabinet"))||((Tr=ui.moduleId)==null?void 0:Tr.toLowerCase().includes("upper_cabinet"))||((xr=ui.moduleId)==null?void 0:xr.toLowerCase().includes("lower_cabinet"))||((br=ui.moduleId)==null?void 0:br.toLowerCase().includes("uppercabinet"))||((vn=ui.moduleId)==null?void 0:vn.toLowerCase().includes("lowercabinet"))}).sort((ui,si)=>{var Li,Tr;return(((Li=ui.position)==null?void 0:Li.x)||0)-(((Tr=si.position)==null?void 0:Tr.x)||0)})[0],Gt=Be+E.left,Wt=(Ye==null?void 0:Ye.isDualSlot)||((Zn=Ye==null?void 0:Ye.moduleId)==null?void 0:Zn.includes("dual-"));let Vt=0;if(Ye)if(Ye.adjustedWidth)Vt=kt(Ye.adjustedWidth);else if(Ye.moduleWidth)Vt=kt(Ye.moduleWidth);else{const ui=(Hn=Ye.moduleId)==null?void 0:Hn.match(/(\d+)$/),si=ui?parseInt(ui[1]):600;Vt=kt(si)}const Jt=Ye?(((ti=Ye.position)==null?void 0:ti.x)||0)-Vt/2:0,It=!!(Ye&&Math.abs(Jt-Gt)<.2);console.log("🔍🔍🔍 LEFT Subframe Debug:",{actualPlacedModules:w==null?void 0:w.length,leftmostCabinet:Ye,isLeftDual:Wt,cabinetWidth:Vt,leftFrameRightEdge:Gt,cabinetLeftEdge:Jt,distance:Ye?Math.abs(Jt-Gt):null,hasLeftCabinet:It,moduleId:Ye==null?void 0:Ye.moduleId});const Ut=It?602:40;console.log("🔥🔥🔥 LEFT Subframe Final Depth:",{hasLeftCabinet:It,leftFrameDepth:Ut,leftFrameDepthMm:It?602:40,leftFrameDepthInThreeUnits:kt(Ut),actualDepthBeingUsed:Ut});const un=((ri=n.droppedCeiling)==null?void 0:ri.enabled)??!1,Sn=((bi=n.droppedCeiling)==null?void 0:bi.position)??"right",jt=((Ni=n.droppedCeiling)==null?void 0:Ni.dropHeight)??200;if(un&&Sn==="left"){const ui=ke-kt(jt),si=ze+Oe+ui/2,Li=It?De-kt(Gi)/2-kt(29)+kt(19):De+k/2-kt(Gi)/2-kt(29);return c.jsx("group",{position:[Be+E.left-kt(10)+kt(1),si,Li],rotation:[0,Math.PI/2,0],children:c.jsx(_i,{args:[kt(Ut),ui,kt(Gi)],position:[0,0,0],material:fe,renderMode:x})})}const fn=It?De-kt(Gi)/2-kt(29)+kt(19):De+k/2-kt(Gi)/2-kt(29);return c.jsxs("group",{position:[Be+E.left-kt(10)+kt(1),_t,fn],rotation:[0,Math.PI/2,0],children:[console.log("🔴🔴 LEFT BoxWithEdges rendering with depth:",{leftFrameDepth:Ut,hasLeftCabinet:It,depthInThreeUnits:kt(Ut),depthInMm:Ut}),c.jsx(_i,{args:[kt(Ut),ke,kt(Gi)],position:[0,0,0],material:fe,renderMode:x})]})})(),a&&n.surroundType!=="no-surround"&&((vt=n.frameSize)==null?void 0:vt.right)>=20&&i!=="left"&&i!=="right"&&(n.installType==="builtin"||n.installType==="built-in"||n.installType==="semistanding"&&(Ee==null?void 0:Ee.right))&&(()=>{var Zn,Hn,ti,ri,bi,Ni;const Ye=w==null?void 0:w.filter(ui=>{var si,Li,Tr,xr,br,vn;return((si=ui.moduleId)==null?void 0:si.toLowerCase().includes("upper-cabinet"))||((Li=ui.moduleId)==null?void 0:Li.toLowerCase().includes("lower-cabinet"))||((Tr=ui.moduleId)==null?void 0:Tr.toLowerCase().includes("upper_cabinet"))||((xr=ui.moduleId)==null?void 0:xr.toLowerCase().includes("lower_cabinet"))||((br=ui.moduleId)==null?void 0:br.toLowerCase().includes("uppercabinet"))||((vn=ui.moduleId)==null?void 0:vn.toLowerCase().includes("lowercabinet"))}).sort((ui,si)=>{var Li,Tr;return(((Li=si.position)==null?void 0:Li.x)||0)-(((Tr=ui.position)==null?void 0:Tr.x)||0)})[0],Gt=Be+b-E.right,Wt=(Ye==null?void 0:Ye.isDualSlot)||((Zn=Ye==null?void 0:Ye.moduleId)==null?void 0:Zn.includes("dual-"));let Vt=0;if(Ye)if(Ye.adjustedWidth)Vt=kt(Ye.adjustedWidth);else if(Ye.moduleWidth)Vt=kt(Ye.moduleWidth);else{const ui=(Hn=Ye.moduleId)==null?void 0:Hn.match(/(\d+)$/),si=ui?parseInt(ui[1]):600;Vt=kt(si)}const Jt=Ye?(((ti=Ye.position)==null?void 0:ti.x)||0)+Vt/2:0,It=!!(Ye&&Math.abs(Jt-Gt)<.2);console.log("🔍🔍🔍 RIGHT Subframe Debug:",{actualPlacedModules:w==null?void 0:w.length,rightmostCabinet:Ye,isRightDual:Wt,rightCabinetWidth:Vt,rightFrameLeftEdge:Gt,cabinetRightEdge:Jt,distance:Ye?Math.abs(Jt-Gt):null,hasRightCabinet:It,moduleId:Ye==null?void 0:Ye.moduleId});const Ut=It?602:40;console.log("🔥🔥🔥 RIGHT Subframe Final Depth:",{hasRightCabinet:It,rightFrameDepth:Ut,rightFrameDepthMm:It?602:40,rightFrameDepthInThreeUnits:kt(Ut),actualDepthBeingUsed:Ut});const un=((ri=n.droppedCeiling)==null?void 0:ri.enabled)??!1,Sn=((bi=n.droppedCeiling)==null?void 0:bi.position)??"right",jt=((Ni=n.droppedCeiling)==null?void 0:Ni.dropHeight)??200;if(un&&Sn==="right"){const ui=ke-kt(jt),si=ze+Oe+ui/2,Li=It?De-kt(Gi)/2-kt(29)+kt(19):De+k/2-kt(Gi)/2-kt(29);return c.jsx("group",{position:[Be+b-E.right+kt(10)-kt(1),si,Li],rotation:[0,Math.PI/2,0],children:c.jsx(_i,{args:[kt(Ut),ui,kt(Gi)],position:[0,0,0],material:ie,renderMode:x})})}const fn=It?De-kt(Gi)/2-kt(29)+kt(19):De+k/2-kt(Gi)/2-kt(29);return c.jsxs("group",{position:[Be+b-E.right+kt(10)-kt(1),_t,fn],rotation:[0,Math.PI/2,0],children:[console.log("🔴🔴 RIGHT BoxWithEdges rendering with depth:",{rightFrameDepth:Ut,hasRightCabinet:It,depthInThreeUnits:kt(Ut),depthInMm:Ut}),c.jsx(_i,{args:[kt(Ut),ke,kt(Gi)],position:[0,0,0],material:ie,renderMode:x})]})})(),(()=>{var Vt,Jt,It,Ut,un,Sn;const Ye=((Vt=n.baseConfig)==null?void 0:Vt.type)==="stand"&&((Jt=n.baseConfig)==null?void 0:Jt.placementType)==="float",Gt=a&&X>0&&!Ye;console.log("🚨🚨🚨 하부프레임 렌더링 조건 확인:",{showFrame:a,baseFrameHeightMm:X,isFloatingStand:Ye,"baseConfig.type":(It=n.baseConfig)==null?void 0:It.type,"baseConfig.placementType":(Ut=n.baseConfig)==null?void 0:Ut.placementType,shouldRenderBaseFrame:Gt,단내림:(un=n.droppedCeiling)==null?void 0:un.enabled,"기둥 개수":((Sn=n.columns)==null?void 0:Sn.length)||0,baseFrame:z,"spaceInfo.baseConfig":n.baseConfig});const Wt=X>0?L:kt(65);return Gt?c.jsx(c.Fragment,{children:(()=>{var Ni,ui,si,Li,Tr,xr,br,vn,wi;const jt=n.columns||[];let fn=z.width,Zn=0,Hn=0;if(n.surroundType==="surround")fn=z.width,Hn=Be+E.left,Zn=Hn+fn/2;else if(n.surroundType==="no-surround"){const Ve=n.wallConfig;if(n.installType==="builtin"||n.installType==="built-in"){const ct=((Ni=n.gapConfig)==null?void 0:Ni.left)||2,mt=((ui=n.gapConfig)==null?void 0:ui.right)||2;Hn=Be+kt(ct),fn=b-kt(ct+mt),Zn=Hn+fn/2}else if(n.installType==="semistanding"||n.installType==="semi-standing")if(Ve!=null&&Ve.left&&!(Ve!=null&&Ve.right))Hn=Be,fn=b-kt(18),Zn=Hn+fn/2;else if(!(Ve!=null&&Ve.left)&&(Ve!=null&&Ve.right))Hn=Be+kt(18),fn=b-kt(18),Zn=Hn+fn/2;else{const ct=((si=n.gapConfig)==null?void 0:si.left)||2,mt=((Li=n.gapConfig)==null?void 0:Li.right)||2;Hn=Be+kt(ct),fn=b-kt(ct+mt),Zn=Hn+fn/2}else Hn=Be+kt(18),fn=b-kt(36),Zn=Hn+fn/2}const ti=jt.some(Ve=>Ve.depth>=730);if(console.log("🔧 [하부프레임 윗면] 기둥 분절 확인:",{columnsCount:jt.length,hasDeepColumns:ti,columnDepths:jt.map(Ve=>Ve.depth),hasDroppedCeiling:(Tr=n.droppedCeiling)==null?void 0:Tr.enabled,frameWidth:fn,frameX:Zn,surroundType:n.surroundType}),jt.length===0||!ti)return console.log("✅✅✅ 하부프레임 실제 렌더링 중!",{frameWidth:fn,frameWidthMm:fn/.01,frameX:Zn,frameXMm:Zn/.01,spaceInfoWidth:n.width,installType:n.installType,surroundType:n.surroundType,gapConfig:n.gapConfig,actualBaseFrameHeight:Wt,panelStartY:ze,위치Y:ze+Wt/2,단내림:(xr=n.droppedCeiling)==null?void 0:xr.enabled,기둥개수:jt.length,baseFrameMaterial:!!q,materialType:q==null?void 0:q.type,materialColor:q&&"color"in q?(br=q.color)==null?void 0:br.getHexString():"none"}),c.jsx(_i,{args:[fn,Wt,kt(Gi)],position:[Zn,ze+Wt/2,De+k/2-kt(Gi)/2-kt(Gf())],material:q,renderMode:x});const ri=(vn=n.droppedCeiling)==null?void 0:vn.enabled,bi=((wi=n.droppedCeiling)==null?void 0:wi.position)==="left";if(ri&&ti){const Ve=[],ct=up(n),mt=gp(n);kt(ct.startX),kt(ct.endX);const An=kt(mt.startX),nn=kt(mt.endX),zt=[...jt].filter(pn=>pn.depth>=730).sort((pn,Ln)=>pn.position[0]-Ln.position[0]);let gn=Zn-fn/2;const Jn=Zn+fn/2;zt.forEach(pn=>{const Ln=pn.width*.01,Dn=pn.position[0]-Ln/2,ei=pn.position[0]+Ln/2;if(Dn<Jn&&ei>gn){const xi=Math.max(0,Dn-gn);if(xi>0){const Yi=gn+xi/2,Bn=bi?nn:An,Ri=bi?Yi<Bn?"dropped":"normal":Yi<Bn?"normal":"dropped";Ve.push({width:xi,x:gn+xi/2,zone:Ri})}gn=ei}});const Qn=Math.max(0,Jn-gn);if(Qn>0){const pn=gn+Qn/2,Ln=bi?nn:An,Dn=bi?pn<Ln?"dropped":"normal":pn<Ln?"normal":"dropped";Ve.push({width:Qn,x:gn+Qn/2,zone:Dn})}return console.log("🔥 [하부프레임] 단내림 구간 세그먼트 생성:",{allSegments:Ve.map(pn=>({x:pn.x/.01,width:pn.width/.01,zone:pn.zone})),columnsCount:zt.length}),Ve.map((pn,Ln)=>{var Dn;return console.log(`🎨🎨 하부프레임 세그먼트 ${Ln} (단내림+기둥):`,{baseFrameMaterial:!!q,materialType:q==null?void 0:q.type,materialColor:q&&"color"in q?(Dn=q.color)==null?void 0:Dn.getHexString():"none",zone:pn.zone,width:pn.width/.01}),c.jsx(_i,{args:[pn.width,Wt,kt(Gi)],position:[pn.x,ze+Wt/2,De+k/2-kt(Gi)/2-kt(Gi)],material:q,renderMode:x},`base-frame-segment-${Ln}`)})}if(!ri&&ti){const Ve=[],ct=Zn-fn/2,mt=Zn+fn/2,An=[...jt].sort((gn,Jn)=>gn.position[0]-Jn.position[0]);let nn=ct;An.forEach((gn,Jn)=>{const Qn=gn.width*.01,pn=gn.position[0]-Qn/2,Ln=gn.position[0]+Qn/2;if(pn<mt&&Ln>ct&&gn.depth>=730){const Dn=Math.max(0,pn-nn);Dn>0&&Ve.push({width:Dn,x:nn+Dn/2}),nn=Ln}});const zt=Math.max(0,mt-nn);return zt>0&&Ve.push({width:zt,x:nn+zt/2}),Ve.length===0?c.jsx(_i,{args:[fn,Wt,kt(Gi)],position:[Zn,ze+Wt/2,De+k/2-kt(Gi)/2-kt(Gf())],material:q,renderMode:x}):Ve.map((gn,Jn)=>(console.log(`🎨 Base frame segment ${Jn} - 분절된 하부 프레임 재질:`,{hasBaseFrameMaterial:!!q,materialReady:q!==void 0,materialType:q==null?void 0:q.type,materialColor:q&&"color"in q?q.color.getHexString():"none",materialTexture:q&&"map"in q?!!q.map:!1,doorColor:r==null?void 0:r.doorColor,doorTexture:r==null?void 0:r.doorTexture,segmentWidth:gn.width,segmentX:gn.x}),c.jsx(_i,{args:[gn.width,Wt,kt(Gi)],position:[gn.x,ze+Wt/2,De+k/2-kt(Gi)/2-kt(Gi)],material:q,renderMode:x},`base-frame-segment-${Jn}`)))}return null})()}):(console.log("❌❌❌ 하부프레임 렌더링 스킵됨 (띄워서 배치 또는 받침대 없음)"),null)})(),o&&(l&&l.length>0?c.jsx(c.Fragment,{children:(()=>{var Gt;const Ye=A&&((Gt=n.droppedCeiling)!=null&&Gt.enabled)?l.filter(Wt=>Wt.zone===A):l;return console.log("🔥 Room - PlacedFurnitureContainer 렌더링 (뷰어 모드):",{viewMode:t,renderMode:x,activeZone:A,originalCount:(l==null?void 0:l.length)||0,filteredCount:(Ye==null?void 0:Ye.length)||0,placedModules:Ye,showFurniture:o}),c.jsx(Jj,{viewMode:t,view2DDirection:i,renderMode:x,placedModules:Ye,showFurniture:t==="3D"?!0:o,isReadOnly:f})})()}):c.jsxs(c.Fragment,{children:[console.log("🔥 Room - PlacedFurnitureContainer 렌더링 (에디터 모드):",{viewMode:t,renderMode:x,view2DDirection:i,activeZone:A,showFurniture:o}),c.jsx(Jj,{viewMode:t,view2DDirection:i,renderMode:x,activeZone:A,showFurniture:t==="3D"?!0:o,isReadOnly:f})]}))]})},Mk=ci.memo(qhe,(n,e)=>{if(n.viewMode!==e.viewMode||n.view2DDirection!==e.view2DDirection||n.renderMode!==e.renderMode||n.showAll!==e.showAll||n.showFurniture!==e.showFurniture||n.floorColor!==e.floorColor||n.showFrame!==e.showFrame||n.showDimensions!==e.showDimensions||n.isStep2!==e.isStep2||n.activeZone!==e.activeZone)return!1;const t=n.spaceInfo,i=e.spaceInfo;if(t.width!==i.width||t.height!==i.height||t.depth!==i.depth||t.leftSurround!==i.leftSurround||t.rightSurround!==i.rightSurround||t.hasWallFinish!==i.hasWallFinish||t.wallFinishThickness!==i.wallFinishThickness||t.hasFloorFinish!==i.hasFloorFinish||t.floorFinishThickness!==i.floorFinishThickness||t.surroundType!==i.surroundType||JSON.stringify(t.frameSize)!==JSON.stringify(i.frameSize)||JSON.stringify(t.materialConfig)!==JSON.stringify(i.materialConfig)||JSON.stringify(n.materialConfig)!==JSON.stringify(e.materialConfig)||JSON.stringify(t.baseConfig)!==JSON.stringify(i.baseConfig)||t.installType!==i.installType||JSON.stringify(t.wallConfig)!==JSON.stringify(i.wallConfig)||JSON.stringify(t.gapConfig)!==JSON.stringify(i.gapConfig))return!1;const r=n.placedModules||[],s=e.placedModules||[];if(r.length!==s.length)return!1;const o=t.columns||[],a=i.columns||[];if(o.length!==a.length)return!1;for(let l=0;l<o.length;l++){const h=o[l],u=a.find(d=>d.id===h.id);if(!u||Math.abs(h.position[0]-u.position[0])>.01||Math.abs(h.position[2]-u.position[2])>.01||h.width!==u.width||h.depth!==u.depth||h.height!==u.height)return!1}return!0}),Zhe=({position:n,id:e,width:t=300,height:i=2400,depth:r=730,color:s="#E0E0E0",renderMode:o="solid",onPositionChange:a,onRemove:l,spaceInfo:h,hasBackPanelFinish:u=!1,onZoneCross:d})=>{var Se;const A=H.useRef(null),[f,p]=H.useState(!1),g=H.useRef(!1),[v,w]=H.useState(!1),[m,y]=H.useState(null),[x,S]=H.useState(0),[I,j]=H.useState(!1),C=H.useRef(null),b=H.useRef(null),D=H.useRef(null),T=H.useRef(n),k=H.useRef(0),{viewMode:B}=cr(),E=hr(),{selectedColumnId:z,setSelectedColumnId:te,openColumnEditModal:L,openColumnPopup:O,activePopup:J,view2DDirection:$,setIsDraggingColumn:U,viewMode:Y}=Wi();(Se=E.spaceInfo.columns)==null||Se.find(fe=>fe.id===e),H.useEffect(()=>{T.current=n},[n,t,i,r]);const K=J.type==="columnEdit"&&J.id===e,V=fe=>{var Ae;if(!((Ae=E.spaceInfo.droppedCeiling)!=null&&Ae.enabled))return"normal";const M=ar.calculateZoneSlotInfo(E.spaceInfo,E.spaceInfo.customColumnCount);if(!M||!M.normal||!M.dropped)return null;const Z=fe*100;if(E.spaceInfo.droppedCeiling.position==="left"){if(Z>=M.dropped.startX&&Z<=M.dropped.startX+M.dropped.width)return"dropped";if(Z>=M.normal.startX&&Z<=M.normal.startX+M.normal.width)return"normal"}else{if(Z>=M.normal.startX&&Z<=M.normal.startX+M.normal.width)return"normal";if(Z>=M.dropped.startX&&Z<=M.dropped.startX+M.dropped.width)return"dropped"}return null},Q=(fe,M)=>{const Z=ar.calculateZoneSlotInfo(E.spaceInfo,E.spaceInfo.customColumnCount);if(!Z||!Z[fe])return 0;const Ae=Z[fe],ie=t/2,ee=10;return fe==="dropped"?M==="left"?(Ae.startX+ee+ie)*.01:(Ae.startX+Ae.width-ee-ie)*.01:M==="left"?(Ae.startX+ie)*.01:(Ae.startX+Ae.width-ie)*.01},X=ci.useMemo(()=>{const fe=Gd.createWallGradientTexture();fe.wrapS=qm,fe.wrapT=qm;const M=K?"#4CAF50":new Ms(1,1,1);return new gl({map:fe,color:M,metalness:.1,roughness:.7})},[K]),W=ci.useMemo(()=>{let fe="#333333";return K?fe="#4CAF50":f&&(fe="#ff6b6b"),new t5({color:new Ms(fe),linewidth:1})},[f,K]),se=fe=>{fe.stopPropagation(),fe.nativeEvent.stopPropagation(),fe.nativeEvent.preventDefault(),!(f||I||Date.now()-x>200)&&(te(e),O(e))},q=fe=>{fe.stopPropagation(),fe.nativeEvent.stopPropagation(),fe.nativeEvent.preventDefault(),!(f||I)&&(te(e),L(e))},de=fe=>{var De;fe.stopPropagation(),fe.nativeEvent.stopPropagation();const M=T.current?T.current[0]:n[0],Z=V(M);console.log("🎯 기둥 포인터 다운:",e,"현재 구역:",Z,"위치:",M,"props position:",n[0],"temp position:",(De=T.current)==null?void 0:De[0]),S(Date.now()),j(!1),y(fe.point);const Ae=fe.nativeEvent.clientX,ie=5,ee=16,ae=((h==null?void 0:h.width)||3e3)*.005,me=t*.005,_e=-ae+me,ue=ae-me;C.current||(C.current=document.querySelector("canvas"));const Be=qe=>{var Ze;const Je=qe.clientX;if(Math.abs(Je-Ae)>ie&&!g.current){const nt=T.current?T.current[0]:n[0],st=V(nt);console.log("🚀 기둥 드래그 시작:",e,"구역:",st,"시작 위치:",nt),j(!0),p(!0),g.current=!0,U(!0),Y==="3D"&&window.dispatchEvent(new CustomEvent("reset-camera-for-column")),window.dispatchEvent(new CustomEvent("furniture-drag-start"))}if(!g.current)return;const et=Date.now();if(et-k.current<ee||(k.current=et,!C.current))return;b.current||(b.current=C.current.getBoundingClientRect());const He=b.current,ke=((qe.clientX-He.left)/He.width*2-1)*ae;let je=Math.max(_e,Math.min(ue,ke));const rt=V(je);console.log("📍 드래그 중 위치:",je,"구역:",rt);const _t=E.spaceInfo.columns||[],Ee=t*.01,Le=Ee*.3,ye=.001;for(const nt of _t){if(nt.id===e||!nt.position)continue;const st=nt.position[0],At=st-Ee/2,ft=st+Ee/2,Xt=je-Ee/2,Yt=je+Ee/2;if(Xt<ft+ye&&Yt>At-ye)je>st?je=st+Ee:je=st-Ee;else{const Zt=Math.abs(je-(st-Ee)),sn=Math.abs(je-(st+Ee));Zt<Le?je=st-Ee:sn<Le&&(je=st+Ee)}}if(je=Math.max(_e,Math.min(ue,je)),(Ze=E.spaceInfo.droppedCeiling)!=null&&Ze.enabled){const nt=T.current[0],st=V(nt),At=V(je);if(st&&At&&st!==At){let ft;At==="dropped"?E.spaceInfo.droppedCeiling.position==="left"?ft="right":ft="left":E.spaceInfo.droppedCeiling.position==="left"?ft="left":ft="right";const Xt=Q(At,ft);d&&d({fromZone:st,toZone:At,boundaryPosition:ft,targetPosition:[Xt,n[1],n[2]]}),it();return}}T.current=[je,n[1],n[2]],a&&!isNaN(je)&&(D.current&&cancelAnimationFrame(D.current),D.current=requestAnimationFrame(()=>{a(e,T.current),D.current=null}))},it=()=>{g.current&&(U(!1),window.dispatchEvent(new CustomEvent("column-drag-end")),window.dispatchEvent(new CustomEvent("furniture-drag-end"))),p(!1),g.current=!1,y(null),j(!1),document.removeEventListener("pointermove",Be),document.removeEventListener("pointerup",it),b.current=null,D.current&&(cancelAnimationFrame(D.current),D.current=null)};document.addEventListener("pointermove",Be,{passive:!0}),document.addEventListener("pointerup",it)},Ce=fe=>{fe.stopPropagation(),fe.nativeEvent.stopPropagation(),fe.nativeEvent.preventDefault(),window.confirm("기둥을 삭제하시겠습니까?")&&(l==null||l(e))};return c.jsx(c.Fragment,{children:c.jsx("group",{position:n,children:B==="2D"?c.jsxs("group",{position:[0,i*.01/2,0],children:[c.jsxs("mesh",{onClick:se,onDoubleClick:q,onPointerDown:de,onPointerEnter:()=>w(!0),onPointerLeave:()=>w(!1),onContextMenu:Ce,userData:{isColumn:!0,columnId:e},children:[c.jsx("boxGeometry",{args:[t*.01,i*.01,r*.01]}),c.jsx("meshBasicMaterial",{transparent:!0,opacity:0})]}),c.jsxs("mesh",{children:[c.jsx("boxGeometry",{args:[t*.01,i*.01,r*.01]}),c.jsx("meshBasicMaterial",{color:K?"#e8f5e8":"#f0f0f0",transparent:!0,opacity:.6})]}),c.jsxs("lineSegments",{children:[c.jsx("edgesGeometry",{args:[new ku(t*.01,i*.01,r*.01)]}),c.jsx("lineBasicMaterial",{color:K?"#4CAF50":"#999999"})]}),(()=>{const fe=K?"#4CAF50":"#cccccc",M=.25,Z=t*.01,Ae=i*.01,ie=r*.01,ee=[];switch($){case"front":for(let ae=-Math.ceil(Z/M);ae<=Math.ceil(Ae/M);ae++){const me=-Ae/2+ae*M,_e=me+Z,ue=Math.max(-Ae/2,Math.min(Ae/2,me)),Be=Math.max(-Ae/2,Math.min(Ae/2,_e));if(ue<Be){const it=-Z/2+(ue-me),De=-Z/2+(Be-me);ee.push(c.jsxs("line",{children:[c.jsx("bufferGeometry",{children:c.jsx("bufferAttribute",{attach:"attributes-position",count:2,array:new Float32Array([Math.max(-Z/2,Math.min(Z/2,it)),ue,ie/2+.001,Math.max(-Z/2,Math.min(Z/2,De)),Be,ie/2+.001]),itemSize:3})}),c.jsx("lineBasicMaterial",{color:fe})]},`front-diag-${ae}`))}}break;case"top":for(let ae=-Math.ceil(Z/M);ae<=Math.ceil(ie/M);ae++){const me=-ie/2+ae*M,_e=me+Z,ue=Math.max(-ie/2,Math.min(ie/2,me)),Be=Math.max(-ie/2,Math.min(ie/2,_e));if(ue<Be){const it=-Z/2+(ue-me),De=-Z/2+(Be-me);ee.push(c.jsxs("line",{children:[c.jsx("bufferGeometry",{children:c.jsx("bufferAttribute",{attach:"attributes-position",count:2,array:new Float32Array([Math.max(-Z/2,Math.min(Z/2,it)),.001,ue,Math.max(-Z/2,Math.min(Z/2,De)),.001,Be]),itemSize:3})}),c.jsx("lineBasicMaterial",{color:fe})]},`top-diag-${ae}`))}}break;case"left":case"right":for(let ae=-Math.ceil(Ae/M);ae<=Math.ceil(ie/M);ae++){const me=-ie/2+ae*M,_e=me+Ae,ue=Math.max(-ie/2,Math.min(ie/2,me)),Be=Math.max(-ie/2,Math.min(ie/2,_e));if(ue<Be){const it=-Ae/2+(ue-me),De=-Ae/2+(Be-me);ee.push(c.jsxs("line",{children:[c.jsx("bufferGeometry",{children:c.jsx("bufferAttribute",{attach:"attributes-position",count:2,array:new Float32Array([.001,Math.max(-Ae/2,Math.min(Ae/2,it)),ue,.001,Math.max(-Ae/2,Math.min(Ae/2,De)),Be]),itemSize:3})}),c.jsx("lineBasicMaterial",{color:fe})]},`side-diag-${ae}`))}}break}return ee})()]}):o==="wireframe"?c.jsxs("group",{position:[0,i*.01/2,0],children:[c.jsxs("mesh",{onClick:se,onDoubleClick:q,onPointerDown:de,onPointerEnter:()=>w(!0),onPointerLeave:()=>w(!1),onContextMenu:Ce,userData:{isColumn:!0,columnId:e},children:[c.jsx("boxGeometry",{args:[t*.01,i*.01,r*.01]}),c.jsx("meshBasicMaterial",{transparent:!0,opacity:0})]}),c.jsxs("lineSegments",{children:[c.jsx("edgesGeometry",{args:[new ku(t*.01,i*.01,r*.01)]}),c.jsx("primitive",{object:W})]}),c.jsxs("line",{children:[c.jsx("bufferGeometry",{children:c.jsx("bufferAttribute",{attach:"attributes-position",count:2,array:new Float32Array([-(t*.01)/2,-(i*.01)/2,r*.01/2,t*.01/2,i*.01/2,r*.01/2]),itemSize:3})}),c.jsx("lineBasicMaterial",{color:K?"#4CAF50":f?"#ff6b6b":"#333333"})]}),c.jsxs("line",{children:[c.jsx("bufferGeometry",{children:c.jsx("bufferAttribute",{attach:"attributes-position",count:2,array:new Float32Array([t*.01/2,-(i*.01)/2,r*.01/2,-(t*.01)/2,i*.01/2,r*.01/2]),itemSize:3})}),c.jsx("lineBasicMaterial",{color:K?"#4CAF50":f?"#ff6b6b":"#333333"})]})]}):c.jsxs(c.Fragment,{children:[c.jsxs("group",{position:[0,i*.01/2,0],children:[c.jsx("mesh",{ref:A,material:X,receiveShadow:B==="3D",castShadow:B==="3D",onClick:se,onDoubleClick:q,onPointerDown:de,onPointerEnter:()=>w(!0),onPointerLeave:()=>w(!1),onContextMenu:Ce,userData:{isColumn:!0,columnId:e},children:c.jsx("boxGeometry",{args:[t*.01,i*.01,r*.01]})}),c.jsxs("lineSegments",{children:[c.jsx("edgesGeometry",{args:[new ku(t*.01,i*.01,r*.01)]}),c.jsx("lineBasicMaterial",{color:K?"#4CAF50":f?"#ff6b6b":"#666666",linewidth:1})]})]}),u&&c.jsxs("group",{position:[0,i*.01/2,-(r*.01)/2-.009],children:[c.jsxs("mesh",{receiveShadow:B==="3D",castShadow:B==="3D",children:[c.jsx("boxGeometry",{args:[t*.01,i*.01,.018]})," ",c.jsx("meshStandardMaterial",{color:"#F5F5DC",roughness:.6,metalness:0})]}),c.jsxs("lineSegments",{children:[c.jsx("edgesGeometry",{args:[new ku(t*.01,i*.01,.018)]}),c.jsx("lineBasicMaterial",{color:"#999999",linewidth:1})]})]})]})})})},Jhe=ci.memo(Zhe,(n,e)=>{var t,i,r,s,o,a;return n.position[0]===e.position[0]&&n.position[1]===e.position[1]&&n.position[2]===e.position[2]&&n.width===e.width&&n.height===e.height&&n.depth===e.depth&&n.color===e.color&&n.id===e.id&&n.renderMode===e.renderMode&&n.hasBackPanelFinish===e.hasBackPanelFinish&&((t=n.spaceInfo)==null?void 0:t.width)===((i=e.spaceInfo)==null?void 0:i.width)&&((r=n.spaceInfo)==null?void 0:r.depth)===((s=e.spaceInfo)==null?void 0:s.depth)&&((o=n.spaceInfo)==null?void 0:o.height)===((a=e.spaceInfo)==null?void 0:a.height)}),eue="_overlay_w2xcx_1",tue="_popup_w2xcx_24",nue="_header_w2xcx_44",iue="_content_w2xcx_56",rue="_actions_w2xcx_72",sue="_cancelButton_w2xcx_80",oue="_confirmButton_w2xcx_81",pg={overlay:eue,popup:tue,header:nue,content:iue,actions:rue,cancelButton:sue,confirmButton:oue},aue=({isOpen:n,onConfirm:e,onCancel:t,fromZone:i,toZone:r,boundaryPosition:s})=>n?c.jsx("div",{className:pg.overlay,children:c.jsxs("div",{className:pg.popup,children:[c.jsx("div",{className:pg.header,children:c.jsx("h3",{children:"기둥 이동 확인"})}),c.jsxs("div",{className:pg.content,children:[c.jsxs("p",{children:["기둥이 ",i==="normal"?"일반 구간":"단내림 구간","에서"," ",r==="normal"?"일반 구간":"단내림 구간","으로 이동하려고 합니다."]}),c.jsxs("p",{children:["기둥을 ",r==="dropped"?"단내림":"일반"," 구간의"," ",s==="left"?"왼쪽":"오른쪽"," 경계에 배치하시겠습니까?"]})]}),c.jsxs("div",{className:pg.actions,children:[c.jsx("button",{className:pg.cancelButton,onClick:t,children:"취소"}),c.jsx("button",{className:pg.confirmButton,onClick:e,children:"이동"})]})]})}):null,NQ=n=>{const[e,t]=H.useState(!1),[i,r]=H.useState(null),s=l=>{r(l),t(!0)},o=()=>{i&&n.onPositionChange&&n.onPositionChange(n.id,i.targetPosition),t(!1),r(null)},a=()=>{t(!1),r(null)};return ci.useEffect(()=>{if(e&&i){const l=document.createElement("div");return document.body.appendChild(l),Km.render(c.jsx(aue,{isOpen:e,onConfirm:o,onCancel:a,fromZone:i.fromZone,toZone:i.toZone,boundaryPosition:i.boundaryPosition}),l),()=>{Km.unmountComponentAtNode(l),document.body.removeChild(l)}}},[e,i]),c.jsx(Jhe,{...n,onZoneCross:s})},lue=({position:n,id:e,width:t=120,height:i=2400,depth:r=730,color:s="#E0E0E0",renderMode:o="solid",onPositionChange:a,onRemove:l,spaceInfo:h})=>{var J;console.log("🎯 WallAsset 렌더링:",{id:e,height:i,position:n});const u=H.useRef(null),[d,A]=H.useState(!1),[f,p]=H.useState(!1),[g,v]=H.useState(null),[w,m]=H.useState(0),[y,x]=H.useState(!1),{viewMode:S}=cr(),I=hr(),{selectedWallId:j,setSelectedWallId:C,openWallEditModal:b,openWallPopup:D,activePopup:T}=Wi();(J=I.spaceInfo.walls)==null||J.find($=>$.id===e);const k=T.type==="wallEdit"&&T.id===e,B=ci.useMemo(()=>{const $=k?"#4CAF50":s;return new gl({color:new Ms($),metalness:.1,roughness:.7,transparent:!0,opacity:d?.7:1})},[s,d,k]),E=ci.useMemo(()=>{let $="#333333";return k?$="#4CAF50":d&&($="#ff6b6b"),new t5({color:new Ms($),linewidth:1})},[d,k]),z=$=>{if($.stopPropagation(),console.log("🎯 가벽 클릭 이벤트 발생:",e),d||y){console.log("🎯 드래그 중이거나 움직임이 있었으므로 클릭 무시");return}const U=Date.now()-w;if(U>200){console.log("🎯 클릭 시간이 너무 길어서 무시:",U);return}console.log("🎯 가벽 클릭 - 가벽 선택 및 팝업 열기:",e),console.log("🎯 현재 selectedWallId:",j),C(e),D(e),console.log("✅ setSelectedWallId 및 openWallPopup 호출됨:",e),console.log("✅ 변경 후 selectedWallId:",e)},te=$=>{if($.stopPropagation(),console.log("🎯 가벽 더블클릭 이벤트 발생:",e),d||y){console.log("🎯 드래그 중이거나 움직임이 있었으므로 더블클릭 무시");return}console.log("🎯 가벽 더블 클릭 - 가벽 선택 및 편집 모달 열기:",e),console.log("🎯 현재 selectedWallId:",j),C(e),b(e),console.log("✅ setSelectedWallId 및 openWallEditModal 호출됨:",e),console.log("✅ 변경 후 selectedWallId:",e)},L=$=>{$.stopPropagation(),console.log("🎯 가벽 포인터 다운:",e),m(Date.now()),x(!1),v($.point);const U=$.nativeEvent.clientX,Y=5,K=Q=>{const X=Q.clientX,W=Math.abs(X-U);W>Y&&!y&&(console.log("🎯 가벽 드래그 시작 감지:",W),x(!0),A(!0),window.dispatchEvent(new CustomEvent("furniture-drag-start")));const se=document.querySelector("canvas");if(!se)return;const q=se.getBoundingClientRect(),Ce=(Q.clientX-q.left)/q.width*2-1,Se=((h==null?void 0:h.width)||3e3)*.01,fe=Ce*(Se/2),M=((h==null?void 0:h.depth)||1500)*.01,Z=r*.01,Ae=-(M/2)+Z/2,ie=[Math.max(-Se/2+t*.01/2,Math.min(Se/2-t*.01/2,fe)),n[1],Ae];console.log("🎯 가벽 드래그 위치 업데이트:",{id:e,oldPosition:n,newPosition:ie,spaceWidth:Se,worldX:fe,moveDistance:W}),a&&!isNaN(ie[0])&&!isNaN(ie[1])&&!isNaN(ie[2])&&a(e,ie)},V=()=>{console.log("🎯 가벽 포인터 업:",e,"hasMoved:",y),y&&window.dispatchEvent(new CustomEvent("furniture-drag-end")),A(!1),v(null),x(!1),document.removeEventListener("pointermove",K),document.removeEventListener("pointerup",V)};document.addEventListener("pointermove",K),document.addEventListener("pointerup",V)},O=$=>{$.stopPropagation(),console.log("🎯 가벽 우클릭 - 삭제 확인"),window.confirm("가벽을 삭제하시겠습니까?")&&(l==null||l(e))};return c.jsx("group",{position:n,children:o==="wireframe"?c.jsxs("group",{position:[0,i*.01/2,0],children:[c.jsxs("mesh",{onClick:z,onDoubleClick:te,onPointerDown:L,onPointerEnter:()=>p(!0),onPointerLeave:()=>p(!1),onContextMenu:O,userData:{isWall:!0,wallId:e},children:[c.jsx("boxGeometry",{args:[t*.01,i*.01,r*.01]}),c.jsx("meshBasicMaterial",{transparent:!0,opacity:0})]}),c.jsxs("lineSegments",{children:[c.jsx("edgesGeometry",{args:[new ku(t*.01,i*.01,r*.01)]}),c.jsx("primitive",{object:E})]}),S==="2D"&&c.jsxs(c.Fragment,{children:[c.jsxs("line",{children:[c.jsx("bufferGeometry",{children:c.jsx("bufferAttribute",{attach:"attributes-position",count:2,array:new Float32Array([-(t*.01)/2,-(i*.01)/2,r*.01/2,t*.01/2,i*.01/2,r*.01/2]),itemSize:3})}),c.jsx("lineBasicMaterial",{color:k?"#4CAF50":d?"#ff6b6b":"#333333"})]}),c.jsxs("line",{children:[c.jsx("bufferGeometry",{children:c.jsx("bufferAttribute",{attach:"attributes-position",count:2,array:new Float32Array([t*.01/2,-(i*.01)/2,r*.01/2,-(t*.01)/2,i*.01/2,r*.01/2]),itemSize:3})}),c.jsx("lineBasicMaterial",{color:k?"#4CAF50":d?"#ff6b6b":"#333333"})]})]})]}):c.jsx("mesh",{ref:u,material:B,receiveShadow:S==="3D",castShadow:S==="3D",onClick:z,onDoubleClick:te,onPointerDown:L,onPointerEnter:()=>p(!0),onPointerLeave:()=>p(!1),onContextMenu:O,position:[0,i*.01/2,0],userData:{isWall:!0,wallId:e},children:c.jsx("boxGeometry",{args:[t*.01,i*.01,r*.01]})})})},cue=({column:n,spaceInfo:e,onPositionChange:t,onColumnUpdate:i,showLabels:r=!0})=>{const{viewMode:s}=cr(),{theme:o}=Ua(),[a,l]=H.useState(null),[h,u]=H.useState(""),d=H.useRef(null),A=Wi(E=>E.showDimensions),f=(E,z)=>typeof window<"u"&&getComputedStyle(document.documentElement).getPropertyValue(E).trim()||z,p=s==="3D"?{primary:"#10b981",background:"#ffffff",border:"#10b981",hoverBg:"#d1fae5"}:{primary:f("--theme-primary","#10b981"),background:f("--theme-surface","#ffffff"),text:f("--theme-text","#111827"),border:f("--theme-primary","#10b981"),hoverBg:f("--theme-primary-light","#d1fae5"),textSecondary:f("--theme-text-secondary","#6b7280")},g={width:"100%",padding:"8px 12px",border:`2px solid ${p.border}`,borderRadius:"6px",fontSize:"16px",textAlign:"center",fontFamily:"system-ui, -apple-system, sans-serif",fontWeight:"600",outline:"none",backgroundColor:"#ffffff",color:"#000000",WebkitTextFillColor:"#000000",opacity:1};s==="3D"||o==null||o.mode;const w=hr(E=>{var z;return(z=E.spaceInfo.columns)==null?void 0:z.find(te=>te.id===n.id)})||n;if(H.useEffect(()=>{a&&d.current&&setTimeout(()=>{var E,z;(E=d.current)==null||E.focus(),(z=d.current)==null||z.select()},100)},[a]),(o==null?void 0:o.mode)==="dark"||document.body.classList.contains("theme-dark"),H.useEffect(()=>{const E=document.querySelector('[data-column-distance-styles="true"]');E&&E.remove();const z=document.createElement("style");return z.textContent=`
      /* 기둥 거리 입력 필드 - 특정 클래스로 제한 */
      .column-distance-label-input {
        color: #000000 !important;
        background-color: #ffffff !important;
        -webkit-text-fill-color: #000000 !important;
        opacity: 1 !important;
        caret-color: #000000 !important;
      }
      /* 상태별 스타일 */
      .column-distance-label-input:focus,
      .column-distance-label-input:hover,
      .column-distance-label-input:active,
      .column-distance-label-input:disabled {
        color: #000000 !important;
        background-color: #ffffff !important;
        -webkit-text-fill-color: #000000 !important;
      }
    `,document.head.appendChild(z),z.setAttribute("data-column-distance-styles","true"),()=>{z.parentNode&&document.head.removeChild(z)}},[]),!r||!A)return null;const m=((e==null?void 0:e.width)||3600)*.01,y=((e==null?void 0:e.depth)||1500)*.01,x=w.width*.01,S=w.depth*.01,I=w.height*.01,j=Math.round((m/2+w.position[0]-x/2)*100),C=Math.round((m/2-w.position[0]-x/2)*100);Math.round((y/2+w.position[2]-S/2)*100),Math.round((y/2-w.position[2]-S/2)*100);const b=(E,z)=>{if(!t||z<10||z>((e==null?void 0:e.width)||3600)/2)return;const te=m,L=x;let O=w.position[0];E==="left"?O=-(te/2)+z*.01+L/2:E==="right"&&(O=te/2-z*.01-L/2);const J=[O,0,w.position[2]];t(w.id,J)},D=E=>{i&&(E<800||E>3e3||i(w.id,{width:E}))},T=(E,z)=>{z&&z.stopPropagation(),l(E),E==="left"?u(Math.max(0,j).toString()):E==="right"?u(Math.max(0,C).toString()):E==="width"?u(w.width.toString()):E==="height"&&u(w.height.toString())},k=()=>{const E=parseInt(h)||0;a==="left"?b("left",E):a==="right"?b("right",E):a==="width"&&D(E),l(null),u("")},B=()=>{l(null),u("")};return c.jsxs("group",{children:[c.jsxs("group",{children:[c.jsxs("mesh",{position:[(-m/2+w.position[0]-x/2)/2,I/2,w.position[2]+(s==="2D"?.1:0)],children:[c.jsx("boxGeometry",{args:[Math.abs(w.position[0]-x/2- -m/2),.02,.02]}),c.jsx("meshBasicMaterial",{color:p.primary,transparent:!0,opacity:.8})]}),c.jsxs("mesh",{position:[-m/2,I/2,w.position[2]+(s==="2D"?.1:0)],children:[c.jsx("coneGeometry",{args:[.05,.2,3]}),c.jsx("meshBasicMaterial",{color:p.primary})]}),c.jsxs("mesh",{position:[w.position[0]-x/2,I/2,w.position[2]+(s==="2D"?.1:0)],rotation:[0,0,Math.PI],children:[c.jsx("coneGeometry",{args:[.05,.2,3]}),c.jsx("meshBasicMaterial",{color:p.primary})]}),c.jsx("group",{position:[(-m/2+w.position[0]-x/2)/2,I/2+.3,w.position[2]+(s==="2D"?.1:0)],children:a==="left"?c.jsx(jm,{transform:!0,distanceFactor:10,position:[0,0,.1],style:{pointerEvents:"auto"},children:c.jsxs("div",{className:"column-distance-input",style:{background:"#ffffff",border:"2px solid #10b981",borderRadius:"8px",padding:"12px 16px",minWidth:"140px",boxShadow:"0 4px 20px rgba(16,185,129,0.3)",fontSize:"14px",fontFamily:"system-ui, -apple-system, sans-serif",color:"#000000"},onClick:E=>E.stopPropagation(),onMouseDown:E=>E.stopPropagation(),children:[c.jsx("div",{style:{color:"#10b981",fontSize:"12px",marginBottom:"8px",fontWeight:"600"},children:"왼쪽 간격 (mm)"}),c.jsx("input",{ref:d,type:"number",className:"column-distance-label-input",value:h,onChange:E=>u(E.target.value),onKeyDown:E=>{E.stopPropagation(),E.key==="Enter"&&k(),E.key==="Escape"&&B()},onClick:E=>E.stopPropagation(),onFocus:E=>E.stopPropagation(),onMouseDown:E=>E.stopPropagation(),style:{width:"100%",padding:"8px 12px",border:"2px solid #10b981",borderRadius:"6px",fontSize:"16px",textAlign:"center",fontFamily:"system-ui, -apple-system, sans-serif",fontWeight:"600",outline:"none",backgroundColor:"#ffffff",color:"#000000",WebkitTextFillColor:"#000000",opacity:1,WebkitAppearance:"none",MozAppearance:"textfield"},onBlur:()=>k(),autoFocus:!0,min:"0",step:"10"})]})}):c.jsxs(c.Fragment,{children:[c.jsxs("mesh",{position:[0,0,-.01],onClick:E=>{E.stopPropagation(),T("left",E)},onPointerOver:E=>{document.body.style.cursor="pointer"},onPointerOut:E=>{document.body.style.cursor="default"},children:[c.jsx("planeGeometry",{args:[2.8,1.2]}),c.jsx("meshBasicMaterial",{color:p.hoverBg,transparent:!0,opacity:.9})]}),c.jsxs("mesh",{position:[0,0,-.005],onClick:E=>{E.stopPropagation(),T("left",E)},children:[c.jsx("planeGeometry",{args:[2.6,1]}),c.jsx("meshBasicMaterial",{color:p.background,transparent:!0,opacity:.95})]}),c.jsx(ii,{position:[0,0,.2],fontSize:.8,color:"#000000",anchorX:"center",anchorY:"middle",outlineWidth:.1,outlineColor:"#ffffff",onClick:E=>{E.stopPropagation(),T("left",E)},onPointerOver:()=>{document.body.style.cursor="pointer"},onPointerOut:()=>{document.body.style.cursor="default"},children:Math.max(0,j)})]})})]}),c.jsxs("group",{children:[c.jsxs("mesh",{position:[(m/2+w.position[0]+x/2)/2,I/2,w.position[2]+(s==="2D"?.1:0)],children:[c.jsx("boxGeometry",{args:[Math.abs(m/2-(w.position[0]+x/2)),.02,.02]}),c.jsx("meshBasicMaterial",{color:p.primary,transparent:!0,opacity:.8})]}),c.jsxs("mesh",{position:[m/2,I/2,w.position[2]+(s==="2D"?.1:0)],rotation:[0,0,Math.PI],children:[c.jsx("coneGeometry",{args:[.05,.2,3]}),c.jsx("meshBasicMaterial",{color:p.primary})]}),c.jsxs("mesh",{position:[w.position[0]+x/2,I/2,w.position[2]+(s==="2D"?.1:0)],children:[c.jsx("coneGeometry",{args:[.05,.2,3]}),c.jsx("meshBasicMaterial",{color:p.primary})]}),c.jsx("group",{position:[(m/2+w.position[0]+x/2)/2,I/2+.3,w.position[2]+(s==="2D"?.1:0)],children:a==="right"?c.jsx(jm,{transform:!0,distanceFactor:10,position:[0,0,.1],style:{pointerEvents:"auto"},children:c.jsxs("div",{className:"column-distance-input",style:{background:"#ffffff",border:"2px solid #10b981",borderRadius:"8px",padding:"12px 16px",minWidth:"140px",boxShadow:"0 4px 20px rgba(16,185,129,0.3)",fontSize:"14px",fontFamily:"system-ui, -apple-system, sans-serif",color:"#000000"},onClick:E=>E.stopPropagation(),onMouseDown:E=>E.stopPropagation(),children:[c.jsx("div",{style:{color:"#10b981",fontSize:"12px",marginBottom:"8px",fontWeight:"600"},children:"오른쪽 간격 (mm)"}),c.jsx("input",{ref:d,type:"number",className:"column-distance-label-input",value:h,onChange:E=>u(E.target.value),onKeyDown:E=>{E.stopPropagation(),E.key==="Enter"&&k(),E.key==="Escape"&&B()},onClick:E=>E.stopPropagation(),onFocus:E=>E.stopPropagation(),onMouseDown:E=>E.stopPropagation(),style:{width:"100%",padding:"8px 12px",border:"2px solid #10b981",borderRadius:"6px",fontSize:"16px",textAlign:"center",fontFamily:"system-ui, -apple-system, sans-serif",fontWeight:"600",outline:"none",backgroundColor:"#ffffff",color:"#000000",WebkitTextFillColor:"#000000",opacity:1,WebkitAppearance:"none",MozAppearance:"textfield"},onBlur:()=>k(),autoFocus:!0,min:"0",step:"10"})]})}):c.jsxs(c.Fragment,{children:[c.jsxs("mesh",{position:[0,0,-.01],onClick:E=>{E.stopPropagation(),T("right",E)},onPointerOver:E=>{document.body.style.cursor="pointer"},onPointerOut:E=>{document.body.style.cursor="default"},children:[c.jsx("planeGeometry",{args:[2.8,1.2]}),c.jsx("meshBasicMaterial",{color:p.hoverBg,transparent:!0,opacity:.9})]}),c.jsxs("mesh",{position:[0,0,-.005],onClick:E=>{E.stopPropagation(),T("right",E)},children:[c.jsx("planeGeometry",{args:[2.6,1]}),c.jsx("meshBasicMaterial",{color:p.background,transparent:!0,opacity:.95})]}),c.jsx(ii,{position:[0,0,.2],fontSize:.8,color:"#000000",anchorX:"center",anchorY:"middle",outlineWidth:.1,outlineColor:"#ffffff",onClick:E=>{E.stopPropagation(),T("right",E)},onPointerOver:()=>{document.body.style.cursor="pointer"},onPointerOut:()=>{document.body.style.cursor="default"},children:Math.max(0,C)})]})})]}),s==="3D"&&c.jsx("group",{position:[w.position[0],I+.8,w.position[2]],children:a==="width"?c.jsx(jm,{transform:!0,distanceFactor:10,position:[0,0,.1],style:{pointerEvents:"auto"},children:c.jsxs("div",{className:"column-distance-input",style:{background:"#ffffff",border:"2px solid #10b981",borderRadius:"8px",padding:"12px 16px",minWidth:"140px",boxShadow:"0 4px 20px rgba(16,185,129,0.3)",fontSize:"14px",fontFamily:"system-ui, -apple-system, sans-serif",color:"#000000"},onClick:E=>E.stopPropagation(),onMouseDown:E=>E.stopPropagation(),children:[c.jsx("div",{style:{color:"#10b981",fontSize:"12px",marginBottom:"8px",fontWeight:"600"},children:"기둥 폭 (mm)"}),c.jsx("input",{ref:d,type:"number",className:"column-distance-label-input",value:h,onChange:E=>u(E.target.value),onKeyDown:E=>{E.stopPropagation(),E.key==="Enter"&&k(),E.key==="Escape"&&B()},onClick:E=>E.stopPropagation(),onFocus:E=>E.stopPropagation(),onMouseDown:E=>E.stopPropagation(),style:g,onBlur:()=>k(),autoFocus:!0,min:"800",max:"3000",step:"200"})]})}):c.jsxs(c.Fragment,{children:[c.jsxs("mesh",{position:[0,0,-.01],onClick:E=>{E.stopPropagation(),T("width",E)},onPointerOver:E=>{document.body.style.cursor="pointer"},onPointerOut:E=>{document.body.style.cursor="default"},children:[c.jsx("planeGeometry",{args:[2.8,1.2]}),c.jsx("meshBasicMaterial",{color:p.hoverBg,transparent:!0,opacity:.9})]}),c.jsxs("mesh",{position:[0,0,-.005],onClick:E=>{E.stopPropagation(),T("width",E)},children:[c.jsx("planeGeometry",{args:[2.6,1]}),c.jsx("meshBasicMaterial",{color:p.background,transparent:!0,opacity:.95})]}),c.jsx(ii,{position:[0,0,.2],fontSize:.8,color:"#000000",anchorX:"center",anchorY:"middle",outlineWidth:.1,outlineColor:"#ffffff",onClick:E=>{E.stopPropagation(),T("width",E)},onPointerOver:()=>{document.body.style.cursor="pointer"},onPointerOut:()=>{document.body.style.cursor="default"},children:w.width})]})}),A&&c.jsxs("group",{position:[w.position[0],I/2,w.position[2]+S/2+.1],children:[c.jsxs(ii,{fontSize:.4,color:"#000000",anchorX:"center",anchorY:"middle",rotation:[0,0,0],children:["D ",w.depth]}),c.jsxs("mesh",{position:[0,0,-.01],children:[c.jsx("planeGeometry",{args:[3,1]}),c.jsx("meshBasicMaterial",{color:p.background,transparent:!0,opacity:.95})]}),c.jsxs("mesh",{position:[0,0,-.005],children:[c.jsx("planeGeometry",{args:[3.2,1.2]}),c.jsx("meshBasicMaterial",{color:(o==null?void 0:o.mode)==="dark"?"#555555":"#cccccc",transparent:!0,opacity:.8})]})]}),s==="2D"&&A?c.jsxs("group",{position:[w.position[0],I+.8,w.position[2]],children:[c.jsx(ii,{fontSize:.5,color:"#000000",anchorX:"center",anchorY:"middle",rotation:[0,0,0],children:w.width}),c.jsxs("mesh",{position:[0,0,-.01],children:[c.jsx("planeGeometry",{args:[2.6,.9]}),c.jsx("meshBasicMaterial",{color:p.background,transparent:!0,opacity:.95})]}),c.jsxs("mesh",{position:[0,0,-.005],children:[c.jsx("planeGeometry",{args:[2.8,1.1]}),c.jsx("meshBasicMaterial",{color:p.primary,transparent:!0,opacity:.3})]})]}):null]})},LQ=ci.memo(cue),hue=({spaceInfo:n})=>{const[e,t]=H.useState(!1),[i,r]=H.useState(null),[s,o]=H.useState(null),[a,l]=H.useState({x:0,y:0}),[h,u]=H.useState([0,0,0]),{viewMode:d}=cr(),{indexing:A}=v0();if(H.useEffect(()=>{const x=C=>{var D;const b=(D=C.dataTransfer)==null?void 0:D.getData("application/json");if(b)try{const T=JSON.parse(b);T.type==="column"&&(t(!0),r(T),console.log("🏗️ 기둥 드래그 시작:",T))}catch(T){console.error("드래그 데이터 파싱 오류:",T)}},S=C=>{if(!e||!i)return;C.preventDefault(),l({x:C.clientX,y:C.clientY});const b=document.querySelector("canvas");if(!b)return;const D=b.getBoundingClientRect();if(C.clientX>=D.left&&C.clientX<=D.right&&C.clientY>=D.top&&C.clientY<=D.bottom){const k=b.getBoundingClientRect(),B=(C.clientX-k.left-k.width/2)/100;u([B,h[1],h[2]]),o(null)}else o(null)},I=()=>{t(!1),r(null),o(null),console.log("🏗️ 기둥 드래그 종료")},j=C=>{I()};return document.addEventListener("dragstart",x),document.addEventListener("dragover",S),document.addEventListener("dragend",I),document.addEventListener("drop",j),()=>{document.removeEventListener("dragstart",x),document.removeEventListener("dragover",S),document.removeEventListener("dragend",I),document.removeEventListener("drop",j)}},[e,i,n]),!e||!i||s===null||!(A!=null&&A.threeUnitPositions))return null;const f=A.threeUnitPositions[s],p=(n.depth||1500)*.01,g=(i.width||300)*.01,v=(i.height||2400)*.01,w=(i.depth||730)*.01,m=[f,0,-(p/2)+w/2],y=()=>{switch(i.material){case"concrete":return"#888888";case"steel":return"#B0B0B0";case"wood":return"#D2691E";default:return i.color||"#888888"}};return c.jsxs("group",{children:[c.jsxs("mesh",{position:m,children:[c.jsx("boxGeometry",{args:[g,v,w]}),c.jsx("meshBasicMaterial",{color:y(),transparent:!0,opacity:.4,wireframe:!1})]}),c.jsxs("lineSegments",{position:m,children:[c.jsx("edgesGeometry",{args:[new ku(g,v,w)]}),c.jsx("lineBasicMaterial",{color:"#4CAF50",linewidth:3})]}),c.jsxs("mesh",{position:[f,.01,0],rotation:[-Math.PI/2,0,0],children:[c.jsx("planeGeometry",{args:[g+.2,p]}),c.jsx("meshBasicMaterial",{color:"#4CAF50",transparent:!0,opacity:.2,side:Na})]}),c.jsxs("lineSegments",{position:[f,.02,0],children:[c.jsx("edgesGeometry",{args:[new ZU(g+.2,p)]}),c.jsx("lineBasicMaterial",{color:"#4CAF50",linewidth:2})]}),d==="3D"&&c.jsxs("group",{position:[f,v+1,-(p/2)+.5],children:[c.jsxs("mesh",{children:[c.jsx("planeGeometry",{args:[2,.6]}),c.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:.9})]}),c.jsxs("mesh",{position:[0,0,.01],children:[c.jsx("planeGeometry",{args:[1.8,.4]}),c.jsx("meshBasicMaterial",{color:"#4CAF50"})]})]})]})},uue=({position:n,id:e,width:t=600,height:i=18,depth:r=730,color:s="#8B4513",renderMode:o="solid",onPositionChange:a,onRemove:l,spaceInfo:h})=>{var se;const u=H.useRef(null),[d,A]=H.useState(!1),f=H.useRef(!1),[p,g]=H.useState(!1),[v,w]=H.useState(null),[m,y]=H.useState(0),[x,S]=H.useState(!1),I=H.useRef(null),j=H.useRef(null),C=H.useRef(null),b=H.useRef(n),D=H.useRef(0),{viewMode:T}=cr(),k=hr(),{selectedPanelBId:B,setSelectedPanelBId:E,openPanelBEditModal:z,openPanelBPopup:te,activePopup:L,view2DDirection:O,setFurnitureDragging:J}=Wi();(se=k.spaceInfo.panelBs)==null||se.find(q=>q.id===e);const{invalidate:$}=useThree();H.useEffect(()=>{d||($(),b.current=n)},[n,t,i,r,d,$]);const U=L.type==="panelBEdit"&&L.id===e,Y=ci.useMemo(()=>{const q=U?"#4CAF50":s;return new gl({color:new Ms(q),metalness:.1,roughness:.7,transparent:!0,opacity:1})},[s,U]),K=ci.useMemo(()=>{let q="#333333";return U?q="#4CAF50":d&&(q="#ff6b6b"),new t5({color:new Ms(q),linewidth:1})},[d,U]),V=q=>{q.stopPropagation(),!(d||x||Date.now()-m>200)&&(E(e),te(e))},Q=q=>{q.stopPropagation(),!(d||x)&&(E(e),z(e))},X=q=>{q.stopPropagation(),y(Date.now()),S(!1),w(q.point);const de=q.nativeEvent.clientX,Ce=5,Se=16,fe=((h==null?void 0:h.width)||3e3)*.005,M=t*.005,Z=-fe+M,Ae=fe-M;I.current||(I.current=document.querySelector("canvas"));const ie=ae=>{const me=ae.clientX;if(Math.abs(me-de)>Ce&&!f.current&&(S(!0),A(!0),f.current=!0,J(!0),window.dispatchEvent(new CustomEvent("furniture-drag-start"))),!f.current)return;const ue=Date.now();if(ue-D.current<Se||(D.current=ue,!I.current))return;j.current||(j.current=I.current.getBoundingClientRect());const Be=j.current,qe=((ae.clientX-Be.left)/Be.width*2-1)*fe,Je=Math.max(Z,Math.min(Ae,qe));b.current=[Je,n[1],n[2]],a&&!isNaN(Je)&&(C.current&&cancelAnimationFrame(C.current),C.current=requestAnimationFrame(()=>{a(e,b.current),C.current=null}))},ee=()=>{f.current&&(J(!1),window.dispatchEvent(new CustomEvent("furniture-drag-end"))),A(!1),f.current=!1,w(null),S(!1),document.removeEventListener("pointermove",ie),document.removeEventListener("pointerup",ee),j.current=null,C.current&&(cancelAnimationFrame(C.current),C.current=null)};document.addEventListener("pointermove",ie,{passive:!0}),document.addEventListener("pointerup",ee)},W=q=>{q.stopPropagation(),window.confirm("패널B를 삭제하시겠습니까?")&&(l==null||l(e))};return c.jsx("group",{position:n,children:T==="2D"?c.jsxs("group",{position:[0,i*.01/2,0],children:[c.jsxs("mesh",{onClick:V,onDoubleClick:Q,onPointerDown:X,onPointerEnter:()=>g(!0),onPointerLeave:()=>g(!1),onContextMenu:W,userData:{isPanelB:!0,panelBId:e},children:[c.jsx("boxGeometry",{args:[t*.01,i*.01,r*.01]}),c.jsx("meshBasicMaterial",{transparent:!0,opacity:0})]}),c.jsxs("mesh",{children:[c.jsx("boxGeometry",{args:[t*.01,i*.01,r*.01]}),c.jsx("meshBasicMaterial",{color:U?"#c8e6c9":"#f5deb3",transparent:!0,opacity:.8})]}),c.jsxs("lineSegments",{children:[c.jsx("edgesGeometry",{args:[new ku(t*.01,i*.01,r*.01)]}),c.jsx("lineBasicMaterial",{color:U?"#4CAF50":"#8B4513"})]}),(()=>{const q=U?"#4CAF50":"#8B4513",de=t*.01,Ce=i*.01,Se=r*.01,fe=[];switch(O){case"front":for(let M=0;M<3;M++){const Z=-de/2+(M+1)*de/4;fe.push(c.jsxs("line",{children:[c.jsx("bufferGeometry",{children:c.jsx("bufferAttribute",{attach:"attributes-position",count:2,array:new Float32Array([Z,-Ce/2,Se/2+.001,Z,Ce/2,Se/2+.001]),itemSize:3})}),c.jsx("lineBasicMaterial",{color:q})]},`front-line-${M}`))}break;case"top":for(let M=0;M<3;M++){const Z=-de/2+(M+1)*de/4;fe.push(c.jsxs("line",{children:[c.jsx("bufferGeometry",{children:c.jsx("bufferAttribute",{attach:"attributes-position",count:2,array:new Float32Array([Z,Ce/2+.001,-Se/2,Z,Ce/2+.001,Se/2]),itemSize:3})}),c.jsx("lineBasicMaterial",{color:q})]},`top-line-${M}`))}break;case"left":case"right":for(let M=0;M<3;M++){const Z=-Se/2+(M+1)*Se/4;fe.push(c.jsxs("line",{children:[c.jsx("bufferGeometry",{children:c.jsx("bufferAttribute",{attach:"attributes-position",count:2,array:new Float32Array([de/2+.001,-Ce/2,Z,de/2+.001,Ce/2,Z]),itemSize:3})}),c.jsx("lineBasicMaterial",{color:q})]},`side-line-${M}`))}break}return fe})()]}):o==="wireframe"?c.jsxs("group",{position:[0,i*.01/2,0],children:[c.jsxs("mesh",{onClick:V,onDoubleClick:Q,onPointerDown:X,onPointerEnter:()=>g(!0),onPointerLeave:()=>g(!1),onContextMenu:W,userData:{isPanelB:!0,panelBId:e},children:[c.jsx("boxGeometry",{args:[t*.01,i*.01,r*.01]}),c.jsx("meshBasicMaterial",{transparent:!0,opacity:0})]}),c.jsxs("lineSegments",{children:[c.jsx("edgesGeometry",{args:[new ku(t*.01,i*.01,r*.01)]}),c.jsx("primitive",{object:K})]})]}):c.jsx("mesh",{ref:u,material:Y,receiveShadow:T==="3D",castShadow:T==="3D",onClick:V,onDoubleClick:Q,onPointerDown:X,onPointerEnter:()=>g(!0),onPointerLeave:()=>g(!1),onContextMenu:W,position:[0,i*.01/2,0],userData:{isPanelB:!0,panelBId:e},scale:d?[.95,.95,.95]:[1,1,1],children:c.jsx("boxGeometry",{args:[t*.01,i*.01,r*.01]})})})},due=ci.memo(uue,(n,e)=>{var t,i,r,s,o,a;return n.position[0]===e.position[0]&&n.position[1]===e.position[1]&&n.position[2]===e.position[2]&&n.width===e.width&&n.height===e.height&&n.depth===e.depth&&n.color===e.color&&n.id===e.id&&n.renderMode===e.renderMode&&((t=n.spaceInfo)==null?void 0:t.width)===((i=e.spaceInfo)==null?void 0:i.width)&&((r=n.spaceInfo)==null?void 0:r.depth)===((s=e.spaceInfo)==null?void 0:s.depth)&&((o=n.spaceInfo)==null?void 0:o.height)===((a=e.spaceInfo)==null?void 0:a.height)}),Aue=({spaceInfo:n})=>{const{isPanelBCreationMode:e}=Wi(),{addPanelB:t}=hr(),{indexing:i}=v0(),{viewMode:r}=cr(),{camera:s,raycaster:o,gl:a}=fh(),[l,h]=H.useState(null),[u,d]=H.useState(!1);if(H.useEffect(()=>{if(!e||!a.domElement)return;const v=m=>{const x=a.domElement.getBoundingClientRect(),S=(m.clientX-x.left)/x.width*2-1,I=-((m.clientY-x.top)/x.height)*2+1;o.setFromCamera(new sd(S,I),s);const j=new sm(new lo(0,1,0),-0),C=new lo;if(o.ray.intersectPlane(j,C),C){const b=((n==null?void 0:n.width)||3e3)*.01,D=((n==null?void 0:n.depth)||1500)*.01,T=730*.01,k=600*.01,B=-(D/2)+T/2,E=Math.max(-b/2+k/2,Math.min(b/2-k/2,C.x));h([E,0,B]),d(!0)}},w=()=>{d(!1),h(null)};return canvas.addEventListener("mousemove",v),canvas.addEventListener("mouseleave",w),()=>{canvas.removeEventListener("mousemove",v),canvas.removeEventListener("mouseleave",w)}},[e,s,o,a,n]),!e)return null;const A=()=>{if(!(n!=null&&n.width))return[];const v=n.width*.001,w=[],m=4;for(let y=1;y<m;y++){const x=-v/2+v/m*y;w.push(x)}return w},f=v=>{const w=v||l;if(!w)return;const m={id:`panelB-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,position:w,width:600,height:18,depth:730,color:"#8B4513",material:"wood",orientation:"horizontal"};console.log("🪵 새 패널B 생성:",m),t(m)},p=v=>{v.stopPropagation(),l&&f()},g=A();return g.length===0?null:c.jsxs("group",{children:[c.jsxs("mesh",{position:[0,0,0],onPointerMove:v=>v.stopPropagation(),onClick:p,children:[c.jsx("boxGeometry",{args:[((n==null?void 0:n.width)||3e3)*.01,.01,((n==null?void 0:n.depth)||1500)*.01]}),c.jsx("meshBasicMaterial",{transparent:!0,opacity:0})]}),l&&u&&c.jsxs("group",{position:l,children:[c.jsxs("mesh",{position:[0,.009,0],children:[c.jsx("boxGeometry",{args:[600*.01,18*.01,730*.01]}),c.jsx("meshStandardMaterial",{color:"#f59e0b",transparent:!0,opacity:.5,emissive:"#f59e0b",emissiveIntensity:.2})]}),c.jsxs("lineSegments",{position:[0,.009,0],children:[c.jsx("edgesGeometry",{args:[new ku(600*.01,18*.01,730*.01)]}),c.jsx("lineBasicMaterial",{color:"#f59e0b",linewidth:2})]}),c.jsxs("mesh",{position:[0,.01,0],rotation:[-Math.PI/2,0,0],children:[c.jsx("circleGeometry",{args:[.5,32]}),c.jsx("meshBasicMaterial",{color:"#f59e0b",transparent:!0,opacity:.8})]})]}),g.map((v,w)=>c.jsxs("group",{position:[v,0,0],children:[c.jsxs("mesh",{position:[0,.5,0],onClick:m=>{m.stopPropagation(),console.log("🎯 + 아이콘 클릭됨 (패널B):",v);const y=-((n==null?void 0:n.depth)||1500)*.01/2+730*.01/2;f([v,0,y])},children:[c.jsx("boxGeometry",{args:[1,1,1]}),c.jsx("meshBasicMaterial",{color:"#f59e0b",transparent:!0,opacity:.2,wireframe:!1})]}),c.jsxs("mesh",{position:[0,.5,.1],onClick:m=>{m.stopPropagation(),console.log("🎯 + 배경 클릭됨 (패널B):",v);const y=-((n==null?void 0:n.depth)||1500)*.01/2+730*.01/2;f([v,0,y])},children:[c.jsx("planeGeometry",{args:[.8,.8]}),c.jsx("meshBasicMaterial",{color:"#f59e0b",transparent:!0,opacity:.8,side:2})]}),c.jsx(ii,{position:[0,.5,.11],fontSize:.5,color:"#ffffff",anchorX:"center",anchorY:"middle",onClick:m=>{m.stopPropagation(),console.log("🎯 + 텍스트 클릭됨 (패널B):",v);const y=-((n==null?void 0:n.depth)||1500)*.01/2+730*.01/2;f([v,0,y])},children:"+"}),c.jsxs("mesh",{position:[0,.05,0],rotation:[-Math.PI/2,0,0],onClick:m=>{m.stopPropagation(),console.log("🎯 바닥 원 클릭됨 (패널B):",v);const y=-((n==null?void 0:n.depth)||1500)*.01/2+730*.01/2;f([v,0,y])},children:[c.jsx("circleGeometry",{args:[.4,32]}),c.jsx("meshBasicMaterial",{color:"#dc2626",transparent:!0,opacity:.7,side:2})]}),c.jsxs("mesh",{position:[0,.25,0],onClick:m=>{m.stopPropagation(),console.log("🎯 가이드 라인 클릭됨 (패널B):",v);const y=-((n==null?void 0:n.depth)||1500)*.01/2+730*.01/2;f([v,0,y])},children:[c.jsx("boxGeometry",{args:[.05,.5,.05]}),c.jsx("meshBasicMaterial",{color:"#f59e0b",transparent:!0,opacity:.8})]})]},`panelB-marker-${w}`))]})},a3=({columnIndex:n,columnWidth:e,position:t,internalSpace:i,customHeight:r})=>{const s=r?r*.01:i.height*.01,o=e*.01,a=i.depth*.01;return c.jsx("mesh",{position:[t.x,t.y+s/2,t.z],userData:{columnIndex:n,isDropTarget:!0},visible:!1,children:c.jsx("boxGeometry",{args:[o,s,a]})})},MQ=({viewMode:n,view2DDirection:e})=>{var de,Ce,Se,fe,M,Z,Ae,ie;const{spaceInfo:t}=hr(),{viewMode:i,showDimensions:r,view2DDirection:s,activeDroppedCeilingTab:o,setActiveDroppedCeilingTab:a,view2DTheme:l}=Wi(),{placedModules:h}=pi(),u=n||i,d=e||s,{theme:A}=Id();H.useEffect(()=>{console.log("🔍 현재 activeDroppedCeilingTab:",o)},[o]);const f=((de=t.droppedCeiling)==null?void 0:de.enabled)||!1,p=Kr(t),g=pr(t),{columnCount:v,threeUnitBoundaries:w}=g,m=f&&t.droppedCeiling?t.height-t.droppedCeiling.dropHeight:t.height,x=(()=>{var _e,ue;if(!f)return p.height;const ee=t.hasFloorFinish&&t.floorFinish?t.floorFinish.height:0,ae=((_e=t.baseConfig)==null?void 0:_e.height)||0,me=((ue=t.frameSize)==null?void 0:ue.top)||0;return m-ee-ae-me})(),S=f&&t.droppedCeiling?t.droppedCeiling.width:0,I=((Ce=t.droppedCeiling)==null?void 0:Ce.position)==="left",j=((Se=t.frameSize)==null?void 0:Se.top)||0;console.log("🏗️ 단내림 정보:",{hasDroppedCeiling:f,droppedTotalHeight:m,droppedInternalHeight:x,"internalSpace.height":p.height,"internalSpace.startY":p.startY,"spaceInfo.height":t.height,"spaceInfo.droppedCeiling?.dropHeight":(fe=t.droppedCeiling)==null?void 0:fe.dropHeight,topFrameHeight:j,"계산된 droppedInternalHeight":x,"예상 천장 위치 (droppedTotalHeight - topFrameHeight)":m-j,droppedWidth:S,isLeftDropped:I});const C=ci.useMemo(()=>{const ee=ar.calculateZoneSlotInfo(t,t.customColumnCount),ae=pr(t);return console.log("🔍 ColumnGuides - 슬롯 정보 비교:",{전체인덱싱:{내경시작X:ae.internalStartX,내경너비:ae.internalWidth,슬롯너비:ae.columnWidth},영역별정보:{메인:{시작X:ee.normal.startX,너비:ee.normal.width,끝X:ee.normal.startX+ee.normal.width,슬롯너비:ee.normal.columnWidth,slotWidths:ee.normal.slotWidths,"🎯 Three.js 단위":{시작X_three:ee.normal.startX*.01,끝X_three:(ee.normal.startX+ee.normal.width)*.01,중심X_three:(ee.normal.startX+ee.normal.width/2)*.01}},단내림:ee.dropped?{시작X:ee.dropped.startX,너비:ee.dropped.width,끝X:ee.dropped.startX+ee.dropped.width,슬롯너비:ee.dropped.columnWidth,slotWidths:ee.dropped.slotWidths}:null},갭체크:ee.dropped?{"메인끝-단내림시작":ee.dropped.startX-(ee.normal.startX+ee.normal.width)}:null,"spaceInfo.surroundType":t.surroundType,"spaceInfo.installType":t.installType}),ee},[t,t.customColumnCount,t.mainDoorCount,t.droppedCeilingDoorCount]);if(ci.useEffect(()=>{var ee;console.log("🎯 ColumnGuides - 슬롯 정보 업데이트:",{customColumnCount:t.customColumnCount,mainDoorCount:t.mainDoorCount,droppedCeilingDoorCount:t.droppedCeilingDoorCount,hasDroppedCeiling:(ee=t.droppedCeiling)==null?void 0:ee.enabled,zoneSlotInfo:{normal:C.normal?{columnCount:C.normal.columnCount,columnWidth:C.normal.columnWidth,width:C.normal.width}:null,dropped:C.dropped?{columnCount:C.dropped.columnCount,columnWidth:C.dropped.columnWidth,width:C.dropped.width}:null}})},[t.customColumnCount,t.mainDoorCount,t.droppedCeilingDoorCount,t.droppedCeiling,C]),v<=1&&!f)return null;const b=ee=>ee*.01;((M=t.baseConfig)==null?void 0:M.type)==="stand"&&((Z=t.baseConfig)==null||Z.placementType);const D=t.hasFloorFinish&&t.floorFinish?t.floorFinish.height:0,T=((Ae=t.baseConfig)==null?void 0:Ae.height)||0,k=(D+T)*.01,z=((ee,ae)=>typeof window<"u"&&getComputedStyle(document.documentElement).getPropertyValue(ee).trim()||ae)("--theme-primary","#10b981"),te=u==="2D"?.3:.5,L=b(p.startY),O=b(t.height-j),J=f?b(m-j):O;console.log("📏 높이 계산:",{"전체 높이 (mm)":t.height,"단차 (mm)":(ie=t.droppedCeiling)==null?void 0:ie.dropHeight,"단내림 전체 높이 (mm)":m,"상부프레임 (mm)":j,"단내림 천장 위치 (mm)":m-j,"Three.js 단위":{floorY:L,ceilingY:O,droppedCeilingY:J,furnitureStartY:k}}),f&&(I?w[0]+b(S):w[w.length-1]-b(S));const $=t.depth||1500,U=600,V=-b($)/2+(b($)-b(U))/2+b(U)/2,Q=-b(p.depth/2),X=V-b(18);ga(t);const W=(ee,ae)=>h.some(me=>ae==="dropped"&&me.isDroppedZone||ae==="normal"&&!me.isDroppedZone||ae==="full"?me.columnIndex===ee:!1),se=(ee,ae,me,_e,ue,Be,it)=>{var je;console.log("📐 renderSlotGuides 호출됨:",{zoneType:Be,startX:ee,width:ae,endX:ee+ae,columnCount:me,columnWidth:_e,ceilingY:ue,floorY:L,backZ:Q,frontZ:X,"spaceInfo.mainDoorCount":t.mainDoorCount,"spaceInfo.customColumnCount":t.customColumnCount,hasDroppedCeiling:f,"spaceInfo.surroundType":t.surroundType,"spaceInfo.installType":t.installType,"spaceInfo.wallConfig":t.wallConfig,slotWidths:it});const De=[],qe=u==="2D"&&l==="dark"?"#FFFFFF":z,Je=te,Me=.7,et=[];let He=ee;if(et.push(b(He)),it&&it.length===me){console.log("📏 slotWidths 사용하여 경계 계산:",{startX:ee,slotWidths:it,totalWidth:it.reduce((rt,_t)=>rt+_t,0)});for(let rt=0;rt<me;rt++)He+=it[rt],et.push(b(He))}else{console.log("📏 균등 분할로 경계 계산:",{startX:ee,width:ae,columnCount:me,columnWidth:_e});for(let rt=1;rt<=me;rt++)rt===me?et.push(b(ee+ae)):et.push(b(ee+rt*_e))}console.log("📏 최종 경계:",{firstBoundary:et[0],lastBoundary:et[et.length-1],totalBoundaries:et.length,expectedEndX:b(ee+ae),actualEndX:et[et.length-1],"엔드패널 체크":{surroundType:t.surroundType,installType:t.installType,wallConfig:t.wallConfig,"우측 엔드패널 있음":t.surroundType==="no-surround"&&(t.installType==="semistanding"||t.installType==="semi-standing")&&!((je=t.wallConfig)!=null&&je.right)}});const ze=[];for(let rt=0;rt<me;rt++){const _t=et[rt],Ee=et[rt+1],Le=(_t+Ee)/2;ze.push(Le)}console.log(`📏 ${Be} 영역 경계:`,{startX_mm:ee,endX_mm:ee+ae,width_mm:ae,boundaries_three:[et[0],et[et.length-1]],expectedEndX_three:b(ee+ae),actualEndX_three:et[et.length-1],반올림오차_mm:ae-_e*me,마지막슬롯너비_mm:me>0?ee+ae-(ee+(me-1)*_e):0});const Oe=b(p.startX),ke=b(p.startX+p.width);if(et.length>=2){const rt=b(ee),_t=b(ee+ae);console.log(`📐 ${Be} 수평 가이드 범위:`,{시작X_mm:ee,끝X_mm:ee+ae,시작X_three:rt,끝X_three:_t,내경시작_three:Oe,내경끝_three:ke,프레임정보:t.frameSize});const Ee=rt,Le=_t;if(De.push(c.jsx(lt,{points:[new lo(Ee,L,Q),new lo(Le,L,Q)],color:qe,lineWidth:Je,dashed:!0,dashSize:.15,gapSize:.15,opacity:Me,transparent:!0},`${Be}-floor-horizontal`)),u==="3D"||u==="2D"&&d==="top"){const ye=X-Q,Ze=(X+Q)/2;for(let nt=0;nt<me;nt++){if(W(nt,Be))continue;const st=et[nt],At=et[nt+1],ft=At-st,Xt=(st+At)/2;De.push(c.jsxs("mesh",{position:[Xt,L+.001,Ze],renderOrder:-1,frustumCulled:!1,children:[c.jsx("boxGeometry",{args:[ft,.002,ye]}),c.jsx("meshBasicMaterial",{color:z,transparent:!0,opacity:u==="2D"?.05:.1,side:Na,depthWrite:!1,depthTest:!0})]},`${Be}-floor-mesh-${nt}`))}}if(De.push(c.jsx(lt,{points:[new lo(Ee,ue,Q),new lo(Le,ue,Q)],color:qe,lineWidth:Je,dashed:!0,dashSize:.15,gapSize:.15,opacity:Me,transparent:!0},`${Be}-ceiling-horizontal`)),u==="3D"){const ye=X-Q,Ze=(X+Q)/2;for(let nt=0;nt<me;nt++){if(W(nt,Be))continue;const st=et[nt],At=et[nt+1],ft=At-st,Xt=(st+At)/2;De.push(c.jsxs("mesh",{position:[Xt,ue-.001,Ze],renderOrder:-1,frustumCulled:!1,children:[c.jsx("boxGeometry",{args:[ft,.002,ye]}),c.jsx("meshBasicMaterial",{color:z,transparent:!0,opacity:.1,side:Na,depthWrite:!1,depthTest:!0})]},`${Be}-ceiling-mesh-${nt}`))}}if(u==="3D"||u==="2D"&&d==="front"){const ye=ue-L,Ze=(L+ue)/2;for(let nt=0;nt<me;nt++){if(W(nt,Be))continue;const st=et[nt],At=et[nt+1],ft=At-st,Xt=(st+At)/2;De.push(c.jsxs("mesh",{position:[Xt,Ze,Q+.001],renderOrder:-1,frustumCulled:!1,children:[c.jsx("boxGeometry",{args:[ft,ye,.002]}),c.jsx("meshBasicMaterial",{color:z,transparent:!0,opacity:u==="2D"?.05:.1,side:Na,depthWrite:!1,depthTest:!0})]},`${Be}-back-wall-mesh-${nt}`))}}}return et.forEach((rt,_t)=>{if(u==="2D"&&d==="top"){const Ee=Be==="dropped"?(L+ue)/2:L+b(p.height/2);De.push(c.jsx(lt,{points:[new lo(rt,Ee,Q),new lo(rt,Ee,X)],color:qe,lineWidth:Je,dashed:!0,dashSize:.2,gapSize:.1,opacity:Me,transparent:!0},`${Be}-horizontal-guide-top-${_t}`))}else De.push(c.jsx(lt,{points:[new lo(rt,L,Q),new lo(rt,ue,Q)],color:qe,lineWidth:Je,dashed:!0,dashSize:.2,gapSize:.1,opacity:Me,transparent:!0},`${Be}-vertical-guide-${_t}`)),u==="3D"&&(De.push(c.jsx(lt,{points:[new lo(rt,L,Q),new lo(rt,L,X)],color:qe,lineWidth:Je,dashed:!0,dashSize:.2,gapSize:.1,opacity:Me,transparent:!0},`${Be}-z-guide-floor-${_t}`)),De.push(c.jsx(lt,{points:[new lo(rt,ue,Q),new lo(rt,ue,X)],color:qe,lineWidth:Je,dashed:!0,dashSize:.2,gapSize:.1,opacity:Me,transparent:!0},`${Be}-z-guide-ceiling-${_t}`)))}),r&&ze.forEach((rt,_t)=>{const Ee=it&&it[_t]?it[_t]:_e;let Le,ye;if(u==="2D"&&d==="top"){const Ze=(X+Q)/2;Le=[rt,L+.1,Ze],ye=[-Math.PI/2,0,0]}else{const Ze=L+b(p.height/2),nt=Q+.5;Le=[rt,Ze,nt],ye=[0,0,0]}De.push(c.jsxs(ii,{position:Le,fontSize:.5,color:qe,anchorX:"center",anchorY:"middle",rotation:ye,children:[Math.round(Ee),"mm"]},`${Be}-slot-size-${_t}`))}),console.log(`📐 ${Be} 영역 가이드 개수:`,De.length),console.log("🔴 guides 배열 내용:",De.map(rt=>rt.key)),De};console.log("🏗️ ColumnGuides 렌더링:",{hasDroppedCeiling:f,activeDroppedCeilingTab:o,"zoneSlotInfo.dropped":C.dropped,"zoneSlotInfo.normal":C.normal,showDimensions:r,viewMode:u,"spaceInfo.mainDoorCount":t.mainDoorCount,"spaceInfo.customColumnCount":t.customColumnCount,columnCount:v});const q=()=>null;return c.jsxs("group",{children:[f&&C.dropped?c.jsxs(c.Fragment,{children:[se(C.normal.startX,C.normal.width,C.normal.columnCount,C.normal.columnWidth,O,"main",C.normal.slotWidths),se(C.dropped.startX,C.dropped.width,C.dropped.columnCount,C.dropped.columnWidth,J,"dropped",C.dropped.slotWidths),(u==="3D"||u==="2D"&&d!=="top")&&c.jsxs(c.Fragment,{children:[q(C.normal.startX,C.normal.width),(u==="3D"||u==="2D"&&d==="top")&&q(C.normal.startX,C.normal.width),q(C.dropped.startX,C.dropped.width),(u==="3D"||u==="2D"&&d==="top")&&q(C.dropped.startX,C.dropped.width)]})]}):c.jsxs(c.Fragment,{children:[se(C.normal.startX,C.normal.width,C.normal.columnCount,C.normal.columnWidth,O,"full",C.normal.slotWidths),(u==="3D"||u==="2D"&&d!=="top")&&c.jsxs(c.Fragment,{children:[q(C.normal.startX,C.normal.width),(u==="3D"||u==="2D"&&d==="top")&&q(C.normal.startX,C.normal.width)]})]}),f&&C.dropped?c.jsxs(c.Fragment,{children:[o==="main"&&Array.from({length:C.normal.columnCount},(ee,ae)=>{var ue;let me;if(C.normal.slotWidths){let Be=C.normal.startX;for(let qe=0;qe<ae;qe++)Be+=C.normal.slotWidths[qe];const it=Be,De=it+C.normal.slotWidths[ae];me=(it+De)/2}else me=C.normal.startX+ae*C.normal.columnWidth+C.normal.columnWidth/2;const _e=((ue=C.normal.slotWidths)==null?void 0:ue[ae])||C.normal.columnWidth;return c.jsx(a3,{columnIndex:ae,columnWidth:_e,position:{x:b(me),y:k,z:0},internalSpace:p},`main-column-${ae}`)}),o==="dropped"&&Array.from({length:C.dropped.columnCount},(ee,ae)=>{var ue;let me;if(C.dropped.slotWidths){let Be=C.dropped.startX;for(let qe=0;qe<ae;qe++)Be+=C.dropped.slotWidths[qe];const it=Be,De=it+C.dropped.slotWidths[ae];me=(it+De)/2}else me=C.dropped.startX+ae*C.dropped.columnWidth+C.dropped.columnWidth/2;const _e=((ue=C.dropped.slotWidths)==null?void 0:ue[ae])||C.dropped.columnWidth;return c.jsx(a3,{columnIndex:ae,columnWidth:_e,position:{x:b(me),y:k,z:0},internalSpace:p,customHeight:x},`dropped-column-${ae}`)})]}):Array.from({length:C.normal.columnCount},(ee,ae)=>{var ue;let me;if(C.normal.slotWidths){let Be=C.normal.startX;for(let qe=0;qe<ae;qe++)Be+=C.normal.slotWidths[qe];const it=Be,De=it+C.normal.slotWidths[ae];me=(it+De)/2}else me=C.normal.startX+ae*C.normal.columnWidth+C.normal.columnWidth/2;const _e=((ue=C.normal.slotWidths)==null?void 0:ue[ae])||C.normal.columnWidth;return c.jsx(a3,{columnIndex:ae,columnWidth:_e,position:{x:b(me),y:k,z:0},internalSpace:p},`column-${ae}`)})]})},RQ=({viewDirection:n,showDimensions:e,showFurniture:t=!0,isStep2:i})=>{var ee,ae,me,_e,ue,Be,it,De,qe;const{spaceInfo:r}=hr(),{placedModules:s}=pi(),{view2DDirection:o,showDimensions:a,showDimensionsText:l,view2DTheme:h}=Wi(),u=e!==void 0?e:a;console.log("🎯 CleanCAD2D 전체 렌더링:",{showDimensionsProp:e,showDimensionsFromStore:a,showDimensions:u,viewDirection:n,isStep2:i,surroundType:r.surroundType,installType:r.installType,wallConfig:r.wallConfig,좌우치수표시조건:!i});const{updateColumn:d}=hr(),A=H.useRef(null),{theme:f}=Id(),{colors:p}=yk(),[g,v]=H.useState(null),[w,m]=H.useState(null),[y,x]=H.useState(""),S=H.useRef(null);H.useEffect(()=>{if(g&&w&&S.current){const Je=setTimeout(()=>{S.current&&(S.current.focus(),S.current.select(),S.current.click())},200);return()=>clearTimeout(Je)}},[g,w]);const I=n||o,j=(Je,Me)=>typeof window<"u"&&getComputedStyle(document.documentElement).getPropertyValue(Je).trim()||Me,C=j("--theme-primary","#10b981"),b=I==="3D"?"#666666":h==="dark"?"#ffffff":"#000000",D=I==="3D"?"#666666":h==="dark"?"#ffffff":"#000000",T=I==="3D"?"#cccccc":h==="dark"?"#888888":"#666666";I==="3D"||j("--theme-border","#e5e7eb");const k=C,B=Je=>Je*.01;B(r.width);const E=B(r.height),z=ci.useMemo(()=>s.length===0?null:s.map((Je,Me)=>{var Wt,Vt,Jt;const et=Zi(Je.moduleId,{width:r.width,height:r.height,depth:r.depth},r);if(!et)return null;const He=((Wt=r.droppedCeiling)==null?void 0:Wt.enabled)||!1,ze=((Vt=r.droppedCeiling)==null?void 0:Vt.width)||0,Oe=((Jt=r.droppedCeiling)==null?void 0:Jt.position)||"right",ke=Ih(r),je=Je.slotIndex!==void 0?ke[Je.slotIndex]:void 0;pr(r);const rt=Je.customWidth||Je.adjustedWidth||et.dimensions.width,_t=Je.position.x,Ee=Je.customDepth||et.dimensions.depth,Le=Je.customDepth&&Je.customDepth!==et.dimensions.depth,ye=_t,Ze=E/2,nt=ye-rt/2,st=ye+rt/2,At=Oe==="left"?-(r.width*.01)/2:r.width*.01/2-ze*.01,ft=Oe==="left"?-(r.width*.01)/2+ze*.01:r.width*.01/2,Zt=et.name&&et.name.includes("스페이서")&&rt===36;let sn=0,vt=0;if(je&&je.wallPositions)sn=Math.abs(nt*100-je.wallPositions.left),vt=Math.abs(je.wallPositions.right-st*100);else{const It=nt*100,Ut=st*100;sn=Math.abs(It- -r.width/2),vt=Math.abs(r.width/2-Ut)}let Ye=0,Gt=0;if(He){const It=Oe==="left"?ft:At;Oe==="left"?Ye=Math.abs((nt-It)*100):Gt=Math.abs((It-st)*100)}return{module:Je,moduleData:et,actualWidth:rt,actualDepth:Ee,hasCustomDepth:Le,moduleX:ye,moduleY:Ze,moduleLeft:nt,moduleRight:st,nearestLeftDistance:sn,nearestRightDistance:vt,leftBoundaryDistance:Ye,rightBoundaryDistance:Gt,isSpacerHandled:Zt,hasStepDown:He,stepDownPosition:Oe}}).filter(Boolean),[s,I,r,E,JSON.stringify(s.map(Je=>({id:Je.id,adjustedWidth:Je.adjustedWidth,customWidth:Je.customWidth,position:Je.position})))]);H.useEffect(()=>{A.current&&(A.current.renderOrder=999999,A.current.traverse(Je=>{"material"in Je&&Je.material&&(Je.renderOrder=999999,Je.material instanceof iZ&&(Je.material.depthTest=!1,Je.material.depthWrite=!1,Je.material.needsUpdate=!0))}))},[I,u,s.length,JSON.stringify(s.map(Je=>({id:Je.id,moduleId:Je.moduleId,customDepth:Je.customDepth,position:Je.position}))),JSON.stringify((ee=r.columns)==null?void 0:ee.map(Je=>({id:Je.id,position:Je.position,width:Je.width,height:Je.height,depth:Je.depth})))]);const te=.4,L=.5,O=.35,J=pr(r),{threeUnitBoundaries:$,columnCount:U}=J,Y=s.length>0,K=I==="3D",V=(ae=r.droppedCeiling)==null?void 0:ae.enabled,Q=E+B(V?Y?K?430:360:K?350:280:Y?K?350:280:K?270:200),X=-B(K?250:200),W=-B(r.width/2),se=r.frameSize||(r.surroundType==="no-surround"?{left:0,right:0,top:10}:{left:50,right:50,top:50});console.log("🔍 CleanCAD2D Debug:",{spaceWidth:r.width,droppedCeilingEnabled:(me=r.droppedCeiling)==null?void 0:me.enabled,droppedCeilingWidth:(_e=r.droppedCeiling)==null?void 0:_e.width,droppedCeilingPosition:(ue=r.droppedCeiling)==null?void 0:ue.position,frameSize:se,leftOffset:W,normalBoundsWidth:r.width-(((Be=r.droppedCeiling)==null?void 0:Be.width)||0),droppedBoundsWidth:((it=r.droppedCeiling)==null?void 0:it.width)||0});const q=(Je,Me,et=.015)=>{const He=new lo(Me[0]-Je[0],Me[1]-Je[1],Me[2]-Je[2]).normalize(),ze=new lo(-He.y,He.x,0).multiplyScalar(et);return[[Je[0]+He.x*et+ze.x,Je[1]+He.y*et+ze.y,Je[2]],Je,[Je[0]+He.x*et-ze.x,Je[1]+He.y*et-ze.y,Je[2]]]},de=()=>{if(!u||!l)return null;switch(I){case"3D":case"front":return fe();case"left":return M();case"right":return Z();case"top":return Ae();default:return fe()}},Se=K?0:0,fe=()=>{var Je,Me,et;return c.jsx("group",{position:[0,0,Se],renderOrder:9999,children:c.jsxs(c.Fragment,{children:[c.jsxs("group",{children:[c.jsx(lt,{points:[[W,Q,.002],[B(r.width)+W,Q,.002]],color:b,lineWidth:1}),c.jsx(lt,{points:q([W,Q,.002],[W+.05,Q,.002]),color:b,lineWidth:1}),c.jsx(lt,{points:q([B(r.width)+W,Q,.002],[B(r.width)+W-.05,Q,.002]),color:b,lineWidth:1}),(l||i)&&c.jsx(ii,{position:[B(r.width)/2+W,Q+B(40),.01],fontSize:L,color:D,anchorX:"center",anchorY:"middle",children:r.width}),c.jsx(lt,{points:[[W,0,.001],[W,Q+B(40),.001]],color:b,lineWidth:1}),c.jsx(lt,{points:[[B(r.width)+W,0,.001],[B(r.width)+W,Q+B(40),.001]],color:b,lineWidth:1})]}),((Je=r.droppedCeiling)==null?void 0:Je.enabled)&&I!=="top"&&c.jsx("group",{children:(()=>{up(r),gp(r);const He=Q-B(120),ze=ga(r),Oe=r.width-r.droppedCeiling.width,ke=r.droppedCeiling.width,je=r.droppedCeiling.position==="left"?W+B(ke):W,rt=r.droppedCeiling.position==="left"?W+B(r.width):W+B(Oe),_t=r.droppedCeiling.position==="left"?W:W+B(Oe),Ee=r.droppedCeiling.position==="left"?W+B(ke):W+B(r.width);return c.jsxs(c.Fragment,{children:[c.jsx(lt,{points:[[je,He,.002],[rt,He,.002]],color:b,lineWidth:1}),c.jsx(lt,{points:q([je,He,.002],[je+.05,He,.002]),color:b,lineWidth:1}),c.jsx(lt,{points:q([rt,He,.002],[rt-.05,He,.002]),color:b,lineWidth:1}),(l||i)&&c.jsx(ii,{position:[(je+rt)/2,He+B(30),.01],fontSize:O,color:D,anchorX:"center",anchorY:"middle",children:(()=>{var Ze,nt,st;let Le=ze.left,ye=ze.right;return r.surroundType==="no-surround"&&(r.installType==="builtin"?(Le=2,ye=2):r.installType==="semistanding"?(Ze=r.wallConfig)!=null&&Ze.left?(Le=((nt=r.gapConfig)==null?void 0:nt.left)||2,ye=mi):(Le=mi,ye=((st=r.gapConfig)==null?void 0:st.right)||2):r.installType==="freestanding"&&(Le=mi,ye=mi)),r.droppedCeiling.position==="left"?r.width-r.droppedCeiling.width-ye:r.width-r.droppedCeiling.width-Le})()}),c.jsx(lt,{points:[[_t,He,.002],[Ee,He,.002]],color:b,lineWidth:1}),c.jsx(lt,{points:q([_t,He,.002],[_t+.05,He,.002]),color:b,lineWidth:1}),c.jsx(lt,{points:q([Ee,He,.002],[Ee-.05,He,.002]),color:b,lineWidth:1}),(l||i)&&c.jsx(ii,{position:[(_t+Ee)/2,He+B(30),.01],fontSize:O,color:D,anchorX:"center",anchorY:"middle",children:(()=>{var Ze,nt,st,At,ft;let Le=ze.left,ye=ze.right;return r.surroundType==="no-surround"&&(r.installType==="builtin"?(Le=((Ze=r.gapConfig)==null?void 0:Ze.left)||2,ye=((nt=r.gapConfig)==null?void 0:nt.right)||2):r.installType==="semistanding"?(st=r.wallConfig)!=null&&st.left?(Le=((At=r.gapConfig)==null?void 0:At.left)||2,ye=mi):(Le=mi,ye=((ft=r.gapConfig)==null?void 0:ft.right)||2):r.installType==="freestanding"&&(Le=mi,ye=mi)),r.droppedCeiling.position==="left"?r.droppedCeiling.width-Le:r.droppedCeiling.width-ye})()}),c.jsx(lt,{points:[[je,He-B(40),.001],[je,He+B(10),.001]],color:T,lineWidth:1}),c.jsx(lt,{points:[[rt,He-B(40),.001],[rt,He+B(10),.001]],color:T,lineWidth:1}),c.jsx(lt,{points:[[_t,He-B(40),.001],[_t,He+B(10),.001]],color:T,lineWidth:1}),c.jsx(lt,{points:[[Ee,He-B(40),.001],[Ee,He+B(10),.001]],color:T,lineWidth:1})]})})()}),!i&&r.surroundType==="no-surround"&&(()=>{var ke,je,rt,_t,Ee;const He=((ke=r.wallConfig)==null?void 0:ke.left)&&((je=r.wallConfig)==null?void 0:je.right);let ze,Oe;if(He)ze=((rt=r.gapConfig)==null?void 0:rt.left)||2,Oe=`${ze}`;else{const Le=ga(r);if((_t=r.wallConfig)!=null&&_t.left&&!((Ee=r.wallConfig)!=null&&Ee.right))return null;ze=Le.left>0?Le.left:mi,Oe=`${ze}`}return c.jsxs("group",{children:[c.jsx(lt,{points:[[W,Q-B(120),.002],[W+B(ze),Q-B(120),.002]],color:b,lineWidth:2}),c.jsx(lt,{points:q([W,Q-B(120),.002],[W+.02,Q-B(120),.002]),color:b,lineWidth:2}),c.jsx(lt,{points:q([W+B(ze),Q-B(120),.002],[W+B(ze)-.02,Q-B(120),.002]),color:b,lineWidth:2}),l&&c.jsx(ii,{position:[W+B(ze)/2,Q-B(90),.01],fontSize:te,color:b,anchorX:"center",anchorY:"middle",children:Oe}),c.jsx(lt,{points:[[W,E,.001],[W,Q-B(100),.001]],color:D,lineWidth:.5}),c.jsx(lt,{points:[[W+B(ze),E,.001],[W+B(ze),Q-B(100),.001]],color:D,lineWidth:.5})]})})(),!i&&r.surroundType==="surround"&&c.jsxs("group",{children:[c.jsx(lt,{points:[[W,Q-B(120),.002],[W+B(se.left),Q-B(120),.002]],color:b,lineWidth:.5}),c.jsx(lt,{points:q([W,Q-B(120),.002],[W+.02,Q-B(120),.002]),color:b,lineWidth:.5}),c.jsx(lt,{points:q([W+B(se.left),Q-B(120),.002],[W+B(se.left)-.02,Q-B(120),.002]),color:b,lineWidth:.5}),c.jsx(ii,{position:[W+B(se.left)/2,Q-B(90),.01],fontSize:te,color:D,anchorX:"center",anchorY:"middle",children:se.left}),c.jsx(lt,{points:[[W,E,.001],[W,Q-B(100),.001]],color:b,lineWidth:.5}),c.jsx(lt,{points:[[W+B(se.left),E,.001],[W+B(se.left),Q-B(100),.001]],color:b,lineWidth:.5})]}),!i&&r.surroundType==="no-surround"&&(()=>{var ke,je,rt,_t,Ee;const He=((ke=r.wallConfig)==null?void 0:ke.left)&&((je=r.wallConfig)==null?void 0:je.right);let ze,Oe;if(He)ze=((rt=r.gapConfig)==null?void 0:rt.right)||2,Oe=`${ze}`;else{const Le=ga(r);if((_t=r.wallConfig)!=null&&_t.right&&!((Ee=r.wallConfig)!=null&&Ee.left))return null;ze=Le.right>0?Le.right:mi,Oe=`${ze}`}return c.jsxs("group",{children:[c.jsx(lt,{points:[[B(r.width)+W-B(ze),Q-B(120),.002],[B(r.width)+W,Q-B(120),.002]],color:D,lineWidth:2}),c.jsx(lt,{points:q([B(r.width)+W-B(ze),Q-B(120),.002],[B(r.width)+W-B(ze)+.02,Q-B(120),.002]),color:D,lineWidth:2}),c.jsx(lt,{points:q([B(r.width)+W,Q-B(120),.002],[B(r.width)+W-.02,Q-B(120),.002]),color:D,lineWidth:2}),c.jsx(ii,{position:[B(r.width)+W-B(ze)/2,Q-B(90),.01],fontSize:te,color:b,anchorX:"center",anchorY:"middle",children:Oe}),c.jsx(lt,{points:[[B(r.width)+W-B(ze),E,.001],[B(r.width)+W-B(ze),Q-B(100),.001]],color:D,lineWidth:.5}),c.jsx(lt,{points:[[B(r.width)+W,E,.001],[B(r.width)+W,Q-B(100),.001]],color:D,lineWidth:.5})]})})(),!i&&r.surroundType==="surround"&&c.jsxs("group",{children:[c.jsx(lt,{points:[[B(r.width)+W-B(se.right),Q-B(120),.002],[B(r.width)+W,Q-B(120),.002]],color:b,lineWidth:.5}),c.jsx(lt,{points:q([B(r.width)+W-B(se.right),Q-B(120),.002],[B(r.width)+W-B(se.right)+.02,Q-B(120),.002]),color:b,lineWidth:.5}),c.jsx(lt,{points:q([B(r.width)+W,Q-B(120),.002],[B(r.width)+W-.02,Q-B(120),.002]),color:b,lineWidth:.5}),c.jsx(ii,{position:[B(r.width)+W-B(se.right)/2,Q-B(90),.01],fontSize:te,color:D,anchorX:"center",anchorY:"middle",children:se.right}),c.jsx(lt,{points:[[B(r.width)+W-B(se.right),E,.001],[B(r.width)+W-B(se.right),Q-B(100),.001]],color:b,lineWidth:.5}),c.jsx(lt,{points:[[B(r.width)+W,E,.001],[B(r.width)+W,Q-B(100),.001]],color:b,lineWidth:.5})]}),!1,c.jsxs("group",{children:[(Me=r.droppedCeiling)!=null&&Me.enabled?c.jsx(c.Fragment,{children:r.droppedCeiling.position==="left"?c.jsxs(c.Fragment,{children:[c.jsx(lt,{points:[[X+W,B(r.height-r.droppedCeiling.dropHeight),.002],[X+W,E,.002]],color:b,lineWidth:1}),c.jsx(lt,{points:q([X+W,B(r.height-r.droppedCeiling.dropHeight),.002],[X+W,B(r.height-r.droppedCeiling.dropHeight)+.05,.002]),color:b,lineWidth:1}),c.jsx(lt,{points:q([X+W,E,.002],[X+W,E-.05,.002]),color:b,lineWidth:1}),c.jsx(ii,{position:[X+W-B(60),B(r.height-r.droppedCeiling.dropHeight/2),.01],fontSize:L,color:D,anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:r.droppedCeiling.dropHeight})]}):c.jsxs(c.Fragment,{children:[c.jsx(lt,{points:[[X+W,0,.002],[X+W,E,.002]],color:b,lineWidth:1}),c.jsx(lt,{points:q([X+W,0,.002],[X+W,.05,.002]),color:b,lineWidth:1}),c.jsx(lt,{points:q([X+W,E,.002],[X+W,E-.05,.002]),color:b,lineWidth:1}),c.jsx(ii,{position:[X+W-B(60),E/2,.01],fontSize:L,color:D,anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:r.height})]})}):c.jsxs(c.Fragment,{children:[c.jsx(lt,{points:[[X+W,0,.002],[X+W,E,.002]],color:b,lineWidth:1}),c.jsx(lt,{points:q([X+W,0,.002],[X+W,.05,.002]),color:b,lineWidth:1}),c.jsx(lt,{points:q([X+W,E,.002],[X+W,E-.05,.002]),color:b,lineWidth:1}),c.jsx(ii,{position:[X+W-B(60),E/2,.01],fontSize:L,color:D,anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:r.height})]}),c.jsx(lt,{points:[[W,0,.001],[X+W-B(20),0,.001]],color:b,lineWidth:1}),c.jsx(lt,{points:[[W,E,.001],[X+W-B(20),E,.001]],color:b,lineWidth:1})]}),!i&&c.jsx("group",{children:(()=>{var At,ft,Xt,Yt;const He=B(r.width)+W+B(K?120:200),ze=((At=r.baseConfig)==null?void 0:At.type)==="stand"&&((ft=r.baseConfig)==null?void 0:ft.placementType)==="float",Oe=ze&&((Xt=r.baseConfig)==null?void 0:Xt.floatHeight)||0,ke=se.top,je=ym(r),rt=r.hasFloorFinish?((Yt=r.floorFinish)==null?void 0:Yt.height)||10:0,_t=r.height-ke-je-Oe-rt,Ee=B(Oe),Le=B(Oe+rt),ye=B(Oe+rt+je),Ze=B(Oe+rt+je+_t);let nt=Ze;s.length>0&&s.forEach(Zt=>{const sn=Zi(Zt.moduleId);if(sn){const vt=sn.dimensions.height,Gt=B(Oe+rt+je)+B(vt);Gt>nt&&(nt=Gt)}});const st=s.length>0?nt:E;return c.jsxs(c.Fragment,{children:[ze&&Oe>0&&c.jsxs("group",{children:[c.jsx(lt,{points:[[He+B(100),0,.002],[He+B(100),B(Oe),.002]],color:D,lineWidth:2}),c.jsx(lt,{points:q([He+B(100),0,.002],[He+B(100),-.03,.002]),color:D,lineWidth:2}),c.jsx(lt,{points:q([He+B(100),B(Oe),.002],[He+B(100),B(Oe)+.03,.002]),color:D,lineWidth:2}),c.jsxs(ii,{position:[He+B(100)+B(30),B(Oe/2),.01],fontSize:te*.9,color:D,anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:["띄움 ",Oe]}),c.jsx(lt,{points:[[-B(1800),0,.002],[B(r.width)-B(1800),0,.002]],color:D,lineWidth:.5,dashed:!0,dashSize:.01,gapSize:.005}),c.jsx(lt,{points:[[-B(1800),B(Oe),.002],[B(r.width)-B(1800),B(Oe),.002]],color:D,lineWidth:.5,dashed:!0,dashSize:.01,gapSize:.005})]}),rt>0&&o!=="top"&&!ze&&c.jsxs("group",{children:[c.jsx(lt,{points:[[He,Ee,.002],[He,Le,.002]],color:b,lineWidth:.5}),c.jsx(lt,{points:q([He,Ee,.002],[He,Ee+.03,.002]),color:b,lineWidth:.5}),c.jsx(lt,{points:q([He,Le,.002],[He,Le-.03,.002]),color:b,lineWidth:.5}),c.jsx(ii,{position:[He+B(K?30:60),B(Oe+rt/2),.01],fontSize:je>0?te*.8:te,color:"rgba(255, 0, 0, 0.7)",anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:rt})]}),je>0&&c.jsxs("group",{children:[c.jsx(lt,{points:[[He,Le,.002],[He,ye,.002]],color:b,lineWidth:.5}),c.jsx(lt,{points:q([He,Le,.002],[He,Le+.03,.002]),color:b,lineWidth:.5}),c.jsx(lt,{points:q([He,ye,.002],[He,ye-.03,.002]),color:b,lineWidth:.5}),c.jsx(ii,{position:[He+B(K?30:60),B(Oe+rt+je/2),.01],fontSize:rt>0?te*.8:te,color:D,anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:je})]}),c.jsxs("group",{children:[c.jsx(lt,{points:[[He,ye,.002],[He,Ze,.002]],color:b,lineWidth:.5}),c.jsx(lt,{points:q([He,ye,.002],[He,ye+.03,.002]),color:b,lineWidth:.5}),c.jsx(lt,{points:q([He,Ze,.002],[He,Ze-.03,.002]),color:b,lineWidth:.5}),c.jsx(ii,{position:[He+B(K?30:60),B(Oe+rt+je+_t/2),.01],fontSize:te,color:D,anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:_t})]}),c.jsxs("group",{children:[c.jsx(lt,{points:[[He,Ze,.002],[He,st,.002]],color:r.surroundType==="no-surround"?D:k,lineWidth:r.surroundType==="no-surround"?2:1}),c.jsx(lt,{points:q([He,Ze,.002],[He,Ze+.03,.002]),color:r.surroundType==="no-surround"?D:k,lineWidth:r.surroundType==="no-surround"?2:1}),c.jsx(lt,{points:q([He,st,.002],[He,st-.03,.002]),color:r.surroundType==="no-surround"?D:k,lineWidth:r.surroundType==="no-surround"?2:1}),c.jsx(ii,{position:[He+B(K?30:60),B(r.height-ke/2),.01],fontSize:te,color:K?r.surroundType==="no-surround"?p.primary:"black":"white",anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:ke})]}),c.jsx(lt,{points:[[B(r.width)+W,Ee,.001],[He+B(K?10:20),Ee,.001]],color:b,lineWidth:.5}),rt>0&&!ze&&c.jsx(lt,{points:[[B(r.width)+W,Le,.001],[He+B(K?10:20),Le,.001]],color:b,lineWidth:.5}),je>0&&c.jsx(lt,{points:[[B(r.width)+W,ye,.001],[He+B(K?10:20),ye,.001]],color:b,lineWidth:.5}),c.jsx(lt,{points:[[B(r.width)+W,Ze,.001],[He+B(K?10:20),Ze,.001]],color:b,lineWidth:.5}),c.jsx(lt,{points:[[B(r.width)+W,st,.001],[He+B(K?10:20),st,.001]],color:b,lineWidth:.5})]})})()}),t&&z&&z.map((He,ze)=>{var un,Sn,jt,fn,Zn,Hn,ti,ri,bi,Ni;if(!He)return null;const Oe=((un=r.baseConfig)==null?void 0:un.type)==="stand"&&((Sn=r.baseConfig)==null?void 0:Sn.placementType)==="float",ke=Oe?B(((jt=r.baseConfig)==null?void 0:jt.floatHeight)||0):0;console.log("📐 가구 치수 렌더링 체크:",{index:ze,moduleId:He.module.moduleId,showFurniture:t,showDimensions:u,isFloating:Oe,floatHeight:ke,actualWidth:He.actualWidth});const{module:je,moduleData:rt,actualWidth:_t,actualDepth:Ee,hasCustomDepth:Le,moduleX:ye,moduleY:Ze,moduleLeft:nt,moduleRight:st,nearestLeftDistance:At,nearestRightDistance:ft,leftBoundaryDistance:Xt,rightBoundaryDistance:Yt,isSpacerHandled:Zt,hasStepDown:sn,stepDownPosition:vt}=He,Ye=ye,Gt=((fn=r.droppedCeiling)==null?void 0:fn.width)||0,Wt=B(_t),Vt=Ye-Wt/2,Jt=Ye+Wt/2,It=Q-B(120),Ut=rt.id.includes("dual");return Ut?(Zn=rt.modelConfig)!=null&&Zn.leftSections||(Hn=rt.modelConfig)!=null&&Hn.sections:(ti=rt.modelConfig)!=null&&ti.sections,Ut&&((ri=rt.modelConfig)!=null&&ri.rightSections||(bi=rt.modelConfig)!=null&&bi.sections),Ut&&(Ni=rt.modelConfig)!=null&&Ni.rightAbsoluteWidth&&rt.modelConfig.rightAbsoluteWidth/rt.dimensions.width,B(sn&&vt==="right"?r.width-Gt:r.width),B(rt.dimensions.height),c.jsxs("group",{renderOrder:999999,children:[c.jsx(lt,{points:[[Vt,It,.002],[Jt,It,.002]],color:b,lineWidth:.5,renderOrder:999999}),c.jsx(lt,{points:q([Vt,It,.002],[Vt+.02,It,.002],.01),color:b,lineWidth:.5,renderOrder:999999}),c.jsx(lt,{points:q([Jt,It,.002],[Jt-.02,It,.002],.01),color:b,lineWidth:.5,renderOrder:999999}),c.jsx(ii,{position:[Ye,It-B(30),.01],fontSize:te,color:b,anchorX:"center",anchorY:"middle",renderOrder:999999,children:Math.round(_t)}),c.jsxs(c.Fragment,{children:[c.jsx(lt,{points:[[Vt,E,.002],[Vt,It+B(10),.002]],color:b,lineWidth:1,renderOrder:999999}),c.jsx(lt,{points:[[Jt,E,.002],[Jt,It+B(10),.002]],color:b,lineWidth:1,renderOrder:999999})]})]},`module-guide-${ze}`)}),r.columns&&r.columns.length>0&&I!=="top"&&r.columns.map((He,ze)=>{const Oe=He.width*.01,ke=He.position[0]-Oe/2,je=He.position[0]+Oe/2,rt=Q-B(120);return c.jsxs("group",{children:[c.jsx(lt,{points:[[ke,rt,.002],[je,rt,.002]],color:"#FF0000",lineWidth:.5,renderOrder:999999}),c.jsx(lt,{points:q([ke,rt,.002],[ke+.02,rt,.002],.01),color:"#FF0000",lineWidth:.5,renderOrder:999999}),c.jsx(lt,{points:q([je,rt,.002],[je-.02,rt,.002],.01),color:"#FF0000",lineWidth:.5,renderOrder:999999}),c.jsx(ii,{position:[He.position[0],rt-B(30),.01],fontSize:te,color:"#FF0000",anchorX:"center",anchorY:"middle",renderOrder:999999,children:Math.round(He.width)}),c.jsx(lt,{points:[[ke,E,.002],[ke,rt+B(10),.002]],color:"#FF0000",lineWidth:1,renderOrder:999999}),c.jsx(lt,{points:[[je,E,.002],[je,rt+B(10),.002]],color:"#FF0000",lineWidth:1,renderOrder:999999})]},`column-dim-${He.id}`)}),((et=r.droppedCeiling)==null?void 0:et.enabled)&&I==="top"&&c.jsx("group",{children:(()=>{const He=B(r.width),ze=B(r.depth),Oe=-He/2,ke=-ze/2,je=ke-B(Y?300:250),rt=ga(r),_t=r.width-r.droppedCeiling.width,Ee=r.droppedCeiling.width,Le=r.droppedCeiling.position==="left"?Oe+B(Ee):Oe,ye=r.droppedCeiling.position==="left"?Oe+He:Oe+B(_t),Ze=r.droppedCeiling.position==="left"?Oe:Oe+B(_t),nt=r.droppedCeiling.position==="left"?Oe+B(Ee):Oe+He;return c.jsxs(c.Fragment,{children:[c.jsx(lt,{points:[[Le,E,je],[ye,E,je]],color:b,lineWidth:.5}),c.jsx(lt,{points:q([Le,E,je],[Le+.05,E,je]),color:b,lineWidth:.5}),c.jsx(lt,{points:q([ye,E,je],[ye-.05,E,je]),color:b,lineWidth:.5}),(l||i)&&c.jsx(ii,{position:[(Le+ye)/2,E+.1,je-B(30)],fontSize:O,color:D,anchorX:"center",anchorY:"middle",rotation:[-Math.PI/2,0,0],children:(()=>{var ft,Xt,Yt;let st=rt.left,At=rt.right;return r.surroundType==="no-surround"&&(r.installType==="builtin"?(st=2,At=2):r.installType==="semistanding"?(ft=r.wallConfig)!=null&&ft.left?(st=((Xt=r.gapConfig)==null?void 0:Xt.left)||2,At=mi):(st=mi,At=((Yt=r.gapConfig)==null?void 0:Yt.right)||2):r.installType==="freestanding"&&(st=mi,At=mi)),r.droppedCeiling.position==="left"?r.width-r.droppedCeiling.width-At:r.width-r.droppedCeiling.width-st})()}),c.jsx(lt,{points:[[Ze,E,je],[nt,E,je]],color:b,lineWidth:.5}),c.jsx(lt,{points:q([Ze,E,je],[Ze+.05,E,je]),color:b,lineWidth:.5}),c.jsx(lt,{points:q([nt,E,je],[nt-.05,E,je]),color:b,lineWidth:.5}),(l||i)&&c.jsx(ii,{position:[(Ze+nt)/2,E+.1,je-B(30)],fontSize:O,color:D,anchorX:"center",anchorY:"middle",rotation:[-Math.PI/2,0,0],children:(()=>{var ft,Xt,Yt,Zt,sn;let st=rt.left,At=rt.right;return r.surroundType==="no-surround"&&(r.installType==="builtin"?(st=((ft=r.gapConfig)==null?void 0:ft.left)||2,At=((Xt=r.gapConfig)==null?void 0:Xt.right)||2):r.installType==="semistanding"?(Yt=r.wallConfig)!=null&&Yt.left?(st=((Zt=r.gapConfig)==null?void 0:Zt.left)||2,At=mi):(st=mi,At=((sn=r.gapConfig)==null?void 0:sn.right)||2):r.installType==="freestanding"&&(st=mi,At=mi)),r.droppedCeiling.position==="left"?r.droppedCeiling.width-st:r.droppedCeiling.width-At})()}),c.jsx(lt,{points:[[r.droppedCeiling.position==="left"?nt:ye,E,ke],[r.droppedCeiling.position==="left"?nt:ye,E,je-B(20)]],color:T,lineWidth:.5,dashed:!0}),c.jsx(lt,{points:[[r.droppedCeiling.position==="left"?ye:Le,E,ke],[r.droppedCeiling.position==="left"?ye:Le,E,je-B(20)]],color:b,lineWidth:.5}),c.jsx(lt,{points:[[r.droppedCeiling.position==="left"?Ze:nt,E,ke],[r.droppedCeiling.position==="left"?Ze:nt,E,je-B(20)]],color:b,lineWidth:.5})]})})()})]})})},M=()=>{var Ee;if(n!=="left")return null;const Je=r.depth||600,Me=600,et=B(Je),He=B(Me),ze=-et/2,Oe=ze+(et-He)/2,ke=B(r.width),je=B(r.height),rt=r.frameSize||(r.surroundType==="no-surround"?{top:10}:{top:50}),_t=-B(150);return c.jsxs("group",{children:[c.jsxs("group",{children:[c.jsx(lt,{points:[[_t,0,ze-B(120)],[_t,je,ze-B(120)]],color:b,lineWidth:1}),c.jsx(lt,{points:q([_t,0,ze-B(120)],[_t,.05,ze-B(120)]),color:b,lineWidth:1}),c.jsx(lt,{points:q([_t,je,ze-B(120)],[_t,je-.05,ze-B(120)]),color:b,lineWidth:1}),l&&c.jsx(ii,{position:[_t-B(40),je/2,ze-B(120)],fontSize:L,color:D,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],children:r.height}),c.jsx(lt,{points:[[0,0,ze],[0,0,ze-B(100)]],color:b,lineWidth:1}),c.jsx(lt,{points:[[0,je,ze],[0,je,ze-B(100)]],color:b,lineWidth:1})]}),s.length>0&&c.jsx("group",{children:(()=>{var Ye,Gt,Wt;const Le=ze+et+B(80),ye=((Ye=r.baseConfig)==null?void 0:Ye.type)==="stand"&&((Gt=r.baseConfig)==null?void 0:Gt.placementType)==="float",Ze=rt.top,nt=ym(r),st=r.hasFloorFinish?((Wt=r.floorFinish)==null?void 0:Wt.height)||10:0,At=r.height-Ze-nt-st,ft=0,Xt=B(st),Yt=B(st+nt),Zt=B(nt+At);let sn=Zt;s.length>0&&s.forEach(Vt=>{const Jt=Zi(Vt.moduleId);if(Jt){const It=Jt.dimensions.height,un=B(nt)+B(It);un>sn&&(sn=un)}});const vt=s.length>0?sn:je;return c.jsxs(c.Fragment,{children:[st>0&&!ye&&c.jsxs("group",{children:[c.jsx(lt,{points:[[0,ft,Le],[0,Xt,Le]],color:b,lineWidth:.5}),c.jsx(lt,{points:q([0,ft,Le],[0,.03,Le]),color:b,lineWidth:.5}),c.jsx(lt,{points:q([0,Xt,Le],[0,Xt-.03,Le]),color:b,lineWidth:.5}),c.jsx(ii,{position:[0,B(st/2),Le+B(60)],fontSize:te,color:D,anchorX:"center",anchorY:"middle",rotation:[0,-Math.PI/2,-Math.PI/2],children:st})]}),nt>0&&c.jsxs("group",{children:[c.jsx(lt,{points:[[0,Xt,Le],[0,Yt,Le]],color:b,lineWidth:.5}),c.jsx(lt,{points:q([0,ft,Le],[0,.03,Le]),color:b,lineWidth:.5}),c.jsx(lt,{points:q([0,Yt,Le],[0,Yt-.03,Le]),color:b,lineWidth:.5}),c.jsx(ii,{position:[0,B(nt/2),Le+B(60)],fontSize:te,color:D,anchorX:"center",anchorY:"middle",rotation:[0,-Math.PI/2,-Math.PI/2],children:nt})]}),c.jsxs("group",{children:[c.jsx(lt,{points:[[0,Yt,Le],[0,Zt,Le]],color:b,lineWidth:.5}),c.jsx(lt,{points:q([0,Yt,Le],[0,Yt+.03,Le]),color:b,lineWidth:.5}),c.jsx(lt,{points:q([0,Zt,Le],[0,Zt-.03,Le]),color:b,lineWidth:.5}),c.jsx(ii,{position:[0,Yt+B(At/2),Le+B(60)],fontSize:te,color:D,anchorX:"center",anchorY:"middle",rotation:[0,-Math.PI/2,-Math.PI/2],children:At})]}),c.jsxs("group",{children:[c.jsx(lt,{points:[[0,Zt,Le],[0,vt,Le]],color:r.surroundType==="no-surround"?D:k,lineWidth:r.surroundType==="no-surround"?2:1}),c.jsx(lt,{points:q([0,Zt,Le],[0,Zt+.03,Le]),color:r.surroundType==="no-surround"?D:k,lineWidth:r.surroundType==="no-surround"?2:1}),c.jsx(lt,{points:q([0,vt,Le],[0,vt-.03,Le]),color:r.surroundType==="no-surround"?D:k,lineWidth:r.surroundType==="no-surround"?2:1}),c.jsx(ii,{position:[0,Zt+B(Ze/2),Le+B(60)],fontSize:te,color:D,anchorX:"center",anchorY:"middle",rotation:[0,-Math.PI/2,-Math.PI/2],children:Ze})]}),c.jsx(lt,{points:[[0,ft,ze],[0,ft,Le-B(20)]],color:b,lineWidth:.5}),nt>0&&c.jsx(lt,{points:[[0,Yt,ze],[0,Yt,Le-B(20)]],color:b,lineWidth:.5}),c.jsx(lt,{points:[[0,Zt,ze],[0,Zt,Le-B(20)]],color:b,lineWidth:.5}),c.jsx(lt,{points:[[0,vt,ze],[0,vt,Le-B(20)]],color:b,lineWidth:.5})]})})()}),s.length>0&&s.filter(Le=>I==="left"||Le.position.x<0).map((Le,ye)=>{const Ze=Zi(Le.moduleId,{width:r.width,height:r.height,depth:r.depth},r);if(!Ze)return null;const nt=Le.customDepth||Ze.dimensions.depth,st=B(nt),At=B(20),ft=Oe+He/2-At-st/2,Xt=ft-st/2,Yt=ft+st/2,Zt=E+B(200),sn=Le.position.x;return c.jsxs("group",{children:[c.jsx(lt,{points:[[sn,Zt,Xt],[sn,Zt,Yt]],color:b,lineWidth:.5}),c.jsx(lt,{points:q([sn,Zt,Xt],[sn,Zt,Xt+.02],.01),color:b,lineWidth:.5}),c.jsx(lt,{points:q([sn,Zt,Yt],[sn,Zt,Yt-.02],.01),color:b,lineWidth:.5}),l&&c.jsx(ii,{position:[sn,Zt+B(40),(Xt+Yt)/2],fontSize:te,color:D,anchorX:"center",anchorY:"middle",rotation:[0,-Math.PI/2,0],children:nt}),c.jsxs(c.Fragment,{children:[c.jsx(lt,{points:[[sn,je,Xt],[sn,Zt+B(50),Xt]],color:b,lineWidth:.5}),c.jsx(lt,{points:[[sn,je,Yt],[sn,Zt+B(50),Yt]],color:b,lineWidth:.5})]})]},`left-module-dim-${ye}`)}),c.jsxs("group",{children:[c.jsx(lt,{points:[[-ke/2,je+B(100),0],[ke/2,je+B(100),0]],color:b,lineWidth:1}),c.jsx(lt,{points:q([-ke/2,je+B(100),0],[-ke/2+.05,je+B(100),0]),color:b,lineWidth:1}),c.jsx(lt,{points:q([ke/2,je+B(100),0],[ke/2-.05,je+B(100),0]),color:b,lineWidth:1}),c.jsx(ii,{position:[0,je+B(140),0],fontSize:L,color:D,anchorX:"center",anchorY:"middle",children:r.width}),c.jsx(lt,{points:[[-ke/2,0,0],[-ke/2,je+B(120),0]],color:b,lineWidth:1}),c.jsx(lt,{points:[[ke/2,0,0],[ke/2,je+B(120),0]],color:b,lineWidth:1})]}),((Ee=r.droppedCeiling)==null?void 0:Ee.enabled)&&c.jsx("group",{children:(()=>{const Le=up(r),ye=gp(r),Ze=je+B(50),nt=r.droppedCeiling.position==="left"?-ke/2+B(ye.width):-ke/2,st=r.droppedCeiling.position==="left"?ke/2:-ke/2+B(Le.width),At=r.droppedCeiling.position==="left"?-ke/2:-ke/2+B(Le.width),ft=r.droppedCeiling.position==="left"?-ke/2+B(ye.width):ke/2;return c.jsxs(c.Fragment,{children:[c.jsx(lt,{points:[[nt,Ze,0],[st,Ze,0]],color:b,lineWidth:1}),c.jsx(lt,{points:q([nt,Ze,0],[nt+.05,Ze,0]),color:b,lineWidth:1}),c.jsx(lt,{points:q([st,Ze,0],[st-.05,Ze,0]),color:b,lineWidth:1}),c.jsx(ii,{position:[(nt+st)/2,Ze+B(30),0],fontSize:O,color:D,anchorX:"center",anchorY:"middle",children:(()=>{var sn,vt,Ye;const Xt=ga(r);console.log("🔍 좌측뷰 메인구간 프레임 계산:",{surroundType:r.surroundType,installType:r.installType,wallConfig:r.wallConfig,frameThickness:Xt,droppedPosition:r.droppedCeiling.position});let Yt=Xt.left,Zt=Xt.right;return r.surroundType==="no-surround"&&(r.installType==="builtin"?(Yt=2,Zt=2):r.installType==="semistanding"?(sn=r.wallConfig)!=null&&sn.left?(Yt=((vt=r.gapConfig)==null?void 0:vt.left)||2,Zt=mi):(Yt=mi,Zt=((Ye=r.gapConfig)==null?void 0:Ye.right)||2):r.installType==="freestanding"&&(Yt=mi,Zt=mi)),r.droppedCeiling.position==="left"?r.width-r.droppedCeiling.width-Zt:r.width-r.droppedCeiling.width-Yt})()}),c.jsx(lt,{points:[[At,Ze,0],[ft,Ze,0]],color:b,lineWidth:1}),c.jsx(lt,{points:q([At,Ze,0],[At+.05,Ze,0]),color:b,lineWidth:1}),c.jsx(lt,{points:q([ft,Ze,0],[ft-.05,Ze,0]),color:b,lineWidth:1}),c.jsx(ii,{position:[(At+ft)/2,Ze+B(30),0],fontSize:O,color:D,anchorX:"center",anchorY:"middle",children:(()=>{var sn,vt,Ye;const Xt=ga(r);let Yt=Xt.left,Zt=Xt.right;return r.surroundType==="no-surround"&&(r.installType==="builtin"?(Yt=2,Zt=2):r.installType==="semistanding"?(sn=r.wallConfig)!=null&&sn.left?(Yt=((vt=r.gapConfig)==null?void 0:vt.left)||2,Zt=mi):(Yt=mi,Zt=((Ye=r.gapConfig)==null?void 0:Ye.right)||2):r.installType==="freestanding"&&(Yt=mi,Zt=mi)),r.droppedCeiling.position==="left"?r.droppedCeiling.width-Yt:r.droppedCeiling.width-Zt})()}),c.jsx(lt,{points:[[r.droppedCeiling.position==="left"?-ke/2+B(ye.width):-ke/2+B(Le.width),0,0],[r.droppedCeiling.position==="left"?-ke/2+B(ye.width):-ke/2+B(Le.width),Ze-B(20),0]],color:T,lineWidth:1,dashed:!0})]})})()})]})},Z=()=>{var Le,ye;if(n!=="right")return null;const Je=r.depth||600,Me=B(r.width),et=B(r.depth),He=B(r.height),ze=B(Je),Oe=-ze/2,ke=B(r.width),je=B(r.height),rt=r.frameSize||(r.surroundType==="no-surround"?{top:10}:{top:50}),_t=je+B(Y?280:200),Ee=ke+B(200);return c.jsxs("group",{children:[c.jsxs("group",{children:[c.jsx(lt,{points:[[Ee,_t,Oe],[Ee,_t,Oe+ze]],color:b,lineWidth:1}),c.jsx(lt,{points:q([Ee,_t,Oe],[Ee,_t,Oe+.05]),color:b,lineWidth:1}),c.jsx(lt,{points:q([Ee,_t,Oe+ze],[Ee,_t,Oe+ze-.05]),color:b,lineWidth:1}),(l||i)&&c.jsx(ii,{position:[Ee+B(60),_t,Oe+ze/2],fontSize:L,color:D,anchorX:"center",anchorY:"middle",rotation:[0,-Math.PI/2,0],children:r.depth}),c.jsx(lt,{points:[[ke,0,Oe],[Ee+B(20),0,Oe]],color:b,lineWidth:1}),c.jsx(lt,{points:[[ke,je,Oe],[Ee+B(20),je,Oe]],color:b,lineWidth:1}),c.jsx(lt,{points:[[ke,0,Oe+ze],[Ee+B(20),0,Oe+ze]],color:b,lineWidth:1}),c.jsx(lt,{points:[[ke,je,Oe+ze],[Ee+B(20),je,Oe+ze]],color:b,lineWidth:1})]}),c.jsxs("group",{children:[(Le=r.droppedCeiling)!=null&&Le.enabled?c.jsx(c.Fragment,{children:r.droppedCeiling.position==="right"?c.jsxs(c.Fragment,{children:[c.jsx(lt,{points:[[Ee,B(r.height-r.droppedCeiling.dropHeight),Oe-B(200)],[Ee,je,Oe-B(200)]],color:b,lineWidth:1}),c.jsx(lt,{points:q([Ee,B(r.height-r.droppedCeiling.dropHeight),Oe-B(200)],[Ee,B(r.height-r.droppedCeiling.dropHeight)+.05,Oe-B(200)]),color:b,lineWidth:1}),c.jsx(lt,{points:q([Ee,je,Oe-B(200)],[Ee,je-.05,Oe-B(200)]),color:b,lineWidth:1}),(l||i)&&c.jsx(ii,{position:[Ee+B(60),B(r.height-r.droppedCeiling.dropHeight/2),Oe-B(200)],fontSize:L,color:D,anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:r.droppedCeiling.dropHeight})]}):c.jsxs(c.Fragment,{children:[c.jsx(lt,{points:[[Ee,0,Oe-B(200)],[Ee,je,Oe-B(200)]],color:b,lineWidth:1}),c.jsx(lt,{points:q([Ee,0,Oe-B(200)],[Ee,.05,Oe-B(200)]),color:b,lineWidth:1}),c.jsx(lt,{points:q([Ee,je,Oe-B(200)],[Ee,je-.05,Oe-B(200)]),color:b,lineWidth:1}),(l||i)&&c.jsx(ii,{position:[Ee+B(60),je/2,Oe-B(200)],fontSize:L,color:D,anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:r.height})]})}):c.jsxs(c.Fragment,{children:[c.jsx(lt,{points:[[Ee,0,Oe-B(200)],[Ee,je,Oe-B(200)]],color:b,lineWidth:1}),c.jsx(lt,{points:q([Ee,0,Oe-B(200)],[Ee,.05,Oe-B(200)]),color:b,lineWidth:1}),c.jsx(lt,{points:q([Ee,je,Oe-B(200)],[Ee,je-.05,Oe-B(200)]),color:b,lineWidth:1}),(l||i)&&c.jsx(ii,{position:[Ee+B(60),je/2,Oe-B(200)],fontSize:L,color:D,anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:r.height})]}),c.jsx(lt,{points:[[ke,0,Oe],[ke,0,Oe-B(180)]],color:b,lineWidth:1}),c.jsx(lt,{points:[[ke,je,Oe],[ke,je,Oe-B(180)]],color:b,lineWidth:1}),((ye=r.droppedCeiling)==null?void 0:ye.enabled)&&c.jsx(lt,{points:[[ke,B(r.height-r.droppedCeiling.dropHeight),Oe],[ke,B(r.height-r.droppedCeiling.dropHeight),Oe-B(180)]],color:b,lineWidth:1})]}),c.jsx("group",{children:(()=>{const Ze=Oe+ze+B(120),nt=rt.top,st=ym(r),At=r.height-nt-st,ft=0,Xt=B(st),Yt=B(st+At);let Zt=Yt;s.length>0&&s.forEach(vt=>{const Ye=Zi(vt.moduleId);if(Ye){const Gt=Ye.dimensions.height,Vt=B(st)+B(Gt);Vt>Zt&&(Zt=Vt)}});const sn=s.length>0?Zt:He;return c.jsxs(c.Fragment,{children:[st>0&&c.jsxs("group",{children:[c.jsx(lt,{points:[[Me,ft,Ze],[Me,Xt,Ze]],color:b,lineWidth:.5}),c.jsx(lt,{points:q([Me,ft,Ze],[Me,.03,Ze]),color:b,lineWidth:.5}),c.jsx(lt,{points:q([Me,Xt,Ze],[Me,Xt-.03,Ze]),color:b,lineWidth:.5}),c.jsx(ii,{position:[Me,B(st/2),Ze+B(60)],fontSize:te,color:D,anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:st})]}),c.jsxs("group",{children:[c.jsx(lt,{points:[[Me,Xt,Ze],[Me,Yt,Ze]],color:b,lineWidth:.5}),c.jsx(lt,{points:q([Me,Xt,Ze],[Me,Xt+.03,Ze]),color:b,lineWidth:.5}),c.jsx(lt,{points:q([Me,Yt,Ze],[Me,Yt-.03,Ze]),color:b,lineWidth:.5}),c.jsx(ii,{position:[Me,B(st+At/2),Ze+B(60)],fontSize:te,color:D,anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:At})]}),c.jsxs("group",{children:[c.jsx(lt,{points:[[Me,Yt,Ze],[Me,sn,Ze]],color:r.surroundType==="no-surround"?D:k,lineWidth:r.surroundType==="no-surround"?2:1}),c.jsx(lt,{points:q([Me,Yt,Ze],[Me,Yt+.03,Ze]),color:r.surroundType==="no-surround"?D:k,lineWidth:r.surroundType==="no-surround"?2:1}),c.jsx(lt,{points:q([Me,sn,Ze],[Me,sn-.03,Ze]),color:r.surroundType==="no-surround"?D:k,lineWidth:r.surroundType==="no-surround"?2:1}),c.jsx(ii,{position:[Me,B(r.height-nt/2),Ze+B(60)],fontSize:te,color:D,anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:nt})]}),c.jsx(lt,{points:[[Me,ft,Oe],[Me,ft,Ze+B(20)]],color:b,lineWidth:.5}),st>0&&c.jsx(lt,{points:[[Me,Xt,Oe],[Me,Xt,Ze+B(20)]],color:b,lineWidth:.5}),c.jsx(lt,{points:[[Me,Yt,Oe],[Me,Yt,Ze+B(20)]],color:b,lineWidth:.5}),c.jsx(lt,{points:[[Me,sn,Oe+et],[Me,sn,Ze+B(20)]],color:b,lineWidth:.5})]})})()}),t&&s.length>0&&s.map((Ze,nt)=>{const st=Zi(Ze.moduleId,{width:r.width,height:r.height,depth:r.depth},r);if(!st)return null;const At=Ze.customDepth||st.dimensions.depth,ft=B(At),Xt=_t-B(120);return c.jsxs("group",{children:[c.jsx(lt,{points:[[Me,Xt,Oe],[Me,Xt,Oe+ft]],color:b,lineWidth:.5}),c.jsx(lt,{points:q([Me,Xt,Oe],[Me,Xt,Oe+.02],.01),color:b,lineWidth:.5}),c.jsx(lt,{points:q([Me,Xt,Oe+ft],[Me,Xt,Oe+ft-.02],.01),color:b,lineWidth:.5}),c.jsx(ii,{position:[Me,Xt-B(30),Oe+ft/2],fontSize:te,color:b,anchorX:"center",anchorY:"middle",children:At}),c.jsxs(c.Fragment,{children:[c.jsx(lt,{points:[[Me,He,Oe],[Me,Xt+B(30),Oe]],color:b,lineWidth:.5}),c.jsx(lt,{points:[[Me,He,Oe+ft],[Me,Xt+B(30),Oe+ft]],color:b,lineWidth:.5})]})]},`right-module-dim-${nt}`)})]})},Ae=()=>{var Oe;const Je=B(r.width),Me=B(r.depth),et=r.frameSize||(r.surroundType==="no-surround"?{left:0,right:0}:{left:50,right:50}),He=-Je/2,ze=-Me/2;return ym(r),Je-(r.surroundType==="no-surround"?0:B(et.left)+B(et.right)),c.jsx("group",{children:n!=="left"&&c.jsxs(c.Fragment,{children:[c.jsx("group",{children:(()=>{const ke=ze-B(Y?200:150);return c.jsxs(c.Fragment,{children:[c.jsx(lt,{points:[[He,E,ke],[He+Je,E,ke]],color:b,lineWidth:.5}),c.jsx(lt,{points:q([He,E,ke],[He+.05,E,ke]),color:b,lineWidth:.5}),c.jsx(lt,{points:q([He+Je,E,ke],[He+Je-.05,E,ke]),color:b,lineWidth:.5}),c.jsx(ii,{position:[0,E+.1,ke-B(40)],fontSize:L,color:D,anchorX:"center",anchorY:"middle",rotation:[-Math.PI/2,0,0],children:r.width}),(()=>{const _t=B(1500),Ee=B(600),ye=ze+(_t-Ee)/2+Ee/2;return c.jsxs(c.Fragment,{children:[c.jsx(lt,{points:[[He,E,ye],[He,E,ke-B(20)]],color:b,lineWidth:.5}),c.jsx(lt,{points:[[He+Je,E,ye],[He+Je,E,ke-B(20)]],color:b,lineWidth:.5})]})})()]})})()}),c.jsx("group",{children:(()=>{var je,rt,_t,Ee,Le;const ke=ze-B(Y?120:80);if(r.surroundType==="no-surround"){const ye=((je=r.wallConfig)==null?void 0:je.left)&&((rt=r.wallConfig)==null?void 0:rt.right);let Ze,nt;if(ye)Ze=((_t=r.gapConfig)==null?void 0:_t.left)||2,nt=`${Ze}`;else{const st=ga(r);if((Ee=r.wallConfig)!=null&&Ee.left&&!((Le=r.wallConfig)!=null&&Le.right))return null;Ze=st.left>0?st.left:mi,nt=`${Ze}`}return c.jsxs(c.Fragment,{children:[c.jsx(lt,{points:[[He,E,ke],[He+B(Ze),E,ke]],color:b,lineWidth:.5}),c.jsx(lt,{points:q([He,E,ke],[He+.02,E,ke]),color:b,lineWidth:.5}),c.jsx(lt,{points:q([He+B(Ze),E,ke],[He+B(Ze)-.02,E,ke]),color:b,lineWidth:.5}),c.jsx(ii,{position:[He+B(Ze)/2,E+.1,ke-B(30)],fontSize:te,color:b,anchorX:"center",anchorY:"middle",rotation:[-Math.PI/2,0,0],children:nt})]})}else{const ye=ga(r);if(ye.left===0)return null;const Ze=ye.left;return c.jsxs(c.Fragment,{children:[c.jsx(lt,{points:[[He,E,ke],[He+B(Ze),E,ke]],color:b,lineWidth:.5}),c.jsx(lt,{points:q([He,E,ke],[He+.02,E,ke]),color:b,lineWidth:.5}),c.jsx(lt,{points:q([He+B(Ze),E,ke],[He+B(Ze)-.02,E,ke]),color:b,lineWidth:.5}),c.jsx(ii,{position:[He+B(Ze/2),E+.1,ke-B(30)],fontSize:te,color:D,anchorX:"center",anchorY:"middle",rotation:[-Math.PI/2,0,0],children:Ze})]})}})()}),c.jsx("group",{children:(()=>{var je,rt,_t,Ee,Le;const ke=ze-B(Y?120:80);if(r.surroundType==="no-surround"){const ye=((je=r.wallConfig)==null?void 0:je.left)&&((rt=r.wallConfig)==null?void 0:rt.right);let Ze,nt;if(ye)Ze=((_t=r.gapConfig)==null?void 0:_t.right)||2,nt=`${Ze}`;else{const st=ga(r);if((Ee=r.wallConfig)!=null&&Ee.right&&!((Le=r.wallConfig)!=null&&Le.left))return null;Ze=st.right>0?st.right:mi,nt=`${Ze}`}return c.jsxs(c.Fragment,{children:[c.jsx(lt,{points:[[He+Je-B(Ze),E,ke],[He+Je,E,ke]],color:b,lineWidth:.5}),c.jsx(lt,{points:q([He+Je-B(Ze),E,ke],[He+Je-B(Ze)+.02,E,ke]),color:b,lineWidth:.5}),c.jsx(lt,{points:q([He+Je,E,ke],[He+Je-.02,E,ke]),color:b,lineWidth:.5}),c.jsx(ii,{position:[He+Je-B(Ze/2),E+.1,ke-B(30)],fontSize:te,color:b,anchorX:"center",anchorY:"middle",rotation:[-Math.PI/2,0,0],children:nt})]})}else{const ye=ga(r);if(ye.right===0)return null;const Ze=ye.right;return c.jsxs(c.Fragment,{children:[c.jsx(lt,{points:[[He+Je-B(Ze),E,ke],[He+Je,E,ke]],color:b,lineWidth:.5}),c.jsx(lt,{points:q([He+Je-B(Ze),E,ke],[He+Je-B(Ze)+.02,E,ke]),color:b,lineWidth:.5}),c.jsx(lt,{points:q([He+Je,E,ke],[He+Je-.02,E,ke]),color:b,lineWidth:.5}),c.jsx(ii,{position:[He+Je-B(Ze/2),E+.1,ke-B(30)],fontSize:te,color:D,anchorX:"center",anchorY:"middle",rotation:[-Math.PI/2,0,0],children:Ze})]})}})()}),((Oe=r.droppedCeiling)==null?void 0:Oe.enabled)&&c.jsx("group",{children:(()=>{const ke=up(r),je=gp(r),rt=ze-B(280),_t=ga(r),Ee=r.width-r.droppedCeiling.width,Le=r.droppedCeiling.width,ye=r.droppedCeiling.position==="left"?He+B(Le):He,Ze=r.droppedCeiling.position==="left"?He+Je:He+B(Ee),nt=r.droppedCeiling.position==="left"?He:He+B(Ee),st=r.droppedCeiling.position==="left"?He+B(Le):He+Je;return c.jsxs(c.Fragment,{children:[c.jsx(lt,{points:[[ye,E,rt],[Ze,E,rt]],color:b,lineWidth:.5}),c.jsx(lt,{points:q([ye,E,rt],[ye+.05,E,rt]),color:b,lineWidth:.5}),c.jsx(lt,{points:q([Ze,E,rt],[Ze-.05,E,rt]),color:b,lineWidth:.5}),c.jsx(ii,{position:[(ye+Ze)/2,E+.1,rt-B(40)],fontSize:O,color:D,anchorX:"center",anchorY:"middle",rotation:[-Math.PI/2,0,0],children:(()=>{var Xt,Yt,Zt;let At=_t.left,ft=_t.right;return r.surroundType==="no-surround"&&(r.installType==="builtin"?(At=2,ft=2):r.installType==="semistanding"?(Xt=r.wallConfig)!=null&&Xt.left?(At=((Yt=r.gapConfig)==null?void 0:Yt.left)||2,ft=mi):(At=mi,ft=((Zt=r.gapConfig)==null?void 0:Zt.right)||2):r.installType==="freestanding"&&(At=mi,ft=mi)),r.droppedCeiling.position==="left"?r.width-r.droppedCeiling.width-ft:r.width-r.droppedCeiling.width-At})()}),c.jsx(lt,{points:[[nt,E,rt],[st,E,rt]],color:b,lineWidth:.5}),c.jsx(lt,{points:q([nt,E,rt],[nt+.05,E,rt]),color:b,lineWidth:.5}),c.jsx(lt,{points:q([st,E,rt],[st-.05,E,rt]),color:b,lineWidth:.5}),c.jsx(ii,{position:[(nt+st)/2,E+.1,rt-B(40)],fontSize:O,color:D,anchorX:"center",anchorY:"middle",rotation:[-Math.PI/2,0,0],children:(()=>{var Xt,Yt,Zt,sn,vt;let At=_t.left,ft=_t.right;return r.surroundType==="no-surround"&&(r.installType==="builtin"?(At=((Xt=r.gapConfig)==null?void 0:Xt.left)||2,ft=((Yt=r.gapConfig)==null?void 0:Yt.right)||2):r.installType==="semistanding"?(Zt=r.wallConfig)!=null&&Zt.left?(At=((sn=r.gapConfig)==null?void 0:sn.left)||2,ft=mi):(At=mi,ft=((vt=r.gapConfig)==null?void 0:vt.right)||2):r.installType==="freestanding"&&(At=mi,ft=mi)),r.droppedCeiling.position==="left"?r.droppedCeiling.width-At:r.droppedCeiling.width-ft})()}),c.jsx(lt,{points:[[r.droppedCeiling.position==="left"?He+B(je.width):He+B(ke.width),E,ze],[r.droppedCeiling.position==="left"?He+B(je.width):He+B(ke.width),E,rt+B(20)]],color:T,lineWidth:.5,dashed:!0}),c.jsx(lt,{points:[[ye,E,ze-B(100)],[ye,E,rt-B(10)]],color:T,lineWidth:.5}),c.jsx(lt,{points:[[Ze,E,ze-B(100)],[Ze,E,rt-B(10)]],color:T,lineWidth:.5}),c.jsx(lt,{points:[[nt,E,ze-B(100)],[nt,E,rt-B(10)]],color:T,lineWidth:.5}),c.jsx(lt,{points:[[st,E,ze-B(100)],[st,E,rt-B(10)]],color:T,lineWidth:.5})]})})()}),c.jsx("group",{children:c.jsx(lt,{points:[[He,E,ze],[He+Je,E,ze]],color:T,lineWidth:1})}),s.length>0&&(()=>{let ke=1/0,je=-1/0,rt=He,_t=!1;if(s.forEach(ye=>{if(ye.position.x>=0)return;const Ze=Zi(ye.moduleId,{width:r.width,height:r.height,depth:r.depth},r);if(!Ze||!Ze.dimensions)return;const nt=ye.customDepth||Ze.dimensions.depth,st=Ze.dimensions.width,At=Ze.id.includes("dual-2drawer-styler"),ft=B(st),Xt=ye.position.x+ft/2,Yt=1500,Zt=600,sn=20,vt=B(Yt),Ye=B(Zt),Gt=B(sn);let Wt,Vt;if(At){const Jt=nt,It=660,Ut=B(Jt),un=B(It),jt=-vt/2+(vt-Ye)/2,fn=jt+Ye/2-Gt-Ut/2,Zn=fn-Ut/2,Hn=fn+Ut/2,ti=(Ut-un)/2,ri=jt+Ye/2-Gt-un/2+ti,bi=ri-un/2,Ni=ri+un/2;Wt=Math.min(Zn,bi),Vt=Math.max(Hn,Ni)}else{const Jt=B(nt),un=-vt/2+(vt-Ye)/2+Ye/2-Gt-Jt/2;Wt=un-Jt/2,Vt=un+Jt/2}_t=!0,Wt<ke&&(ke=Wt,rt=Xt),Vt>je&&(je=Vt)}),!_t||ke===1/0||je===-1/0)return null;const Ee=Math.round((je-ke)/.01),Le=He-B(200);return c.jsxs("group",{children:[c.jsx(lt,{points:[[Le,E,ke],[Le,E,je]],color:b,lineWidth:.5}),c.jsx(lt,{points:q([Le,E,ke],[Le,E,ke+.02],.01),color:b,lineWidth:.5}),c.jsx(lt,{points:q([Le,E,je],[Le,E,je-.02],.01),color:b,lineWidth:.5}),c.jsx(ii,{position:[Le-B(40),E+.1,(ke+je)/2],fontSize:te,color:b,anchorX:"center",anchorY:"middle",rotation:[-Math.PI/2,0,0],children:Ee}),c.jsx(lt,{points:[[rt,E,ke],[Le,E,ke]],color:b,lineWidth:.5}),c.jsx(lt,{points:[[rt,E,je],[Le,E,je]],color:b,lineWidth:.5})]},"cabinet-depth-dimension")})(),s.length>0&&(()=>{let ke=1/0,je=-1/0,rt=He,_t=!1;if(s.forEach(ye=>{if(ye.position.x<0)return;const Ze=Zi(ye.moduleId,{width:r.width,height:r.height,depth:r.depth},r);if(!Ze||!Ze.dimensions)return;const nt=ye.customDepth||Ze.dimensions.depth,st=Ze.dimensions.width,At=Ze.id.includes("dual-2drawer-styler"),ft=B(st),Xt=ye.position.x-ft/2,Yt=1500,Zt=600,sn=20,vt=B(Yt),Ye=B(Zt),Gt=B(sn);let Wt,Vt;if(At){const It=B(660),jt=-vt/2+(vt-Ye)/2+(Ye-It)/2+It/2-Gt-It/2;Wt=jt-It/2,Vt=jt+It/2}else{const Jt=B(nt),un=-vt/2+(vt-Ye)/2+Ye/2-Gt-Jt/2;Wt=un-Jt/2,Vt=un+Jt/2}_t=!0,Wt<ke&&(ke=Wt,rt=Xt),Vt>je&&(je=Vt)}),!_t||ke===1/0||je===-1/0)return null;const Ee=Math.round((je-ke)/.01),Le=He+Je+B(200);return c.jsxs("group",{children:[c.jsx(lt,{points:[[Le,E,ke],[Le,E,je]],color:b,lineWidth:.5}),c.jsx(lt,{points:q([Le,E,ke],[Le,E,ke+.02],.01),color:b,lineWidth:.5}),c.jsx(lt,{points:q([Le,E,je],[Le,E,je-.02],.01),color:b,lineWidth:.5}),c.jsx(ii,{position:[Le+B(40),E+.1,(ke+je)/2],fontSize:te,color:b,anchorX:"center",anchorY:"middle",rotation:[-Math.PI/2,0,0],children:Ee}),c.jsx(lt,{points:[[rt,E,ke],[Le,E,ke]],color:b,lineWidth:.5}),c.jsx(lt,{points:[[rt,E,je],[Le,E,je]],color:b,lineWidth:.5})]},"right-cabinet-depth-dimension")})(),!1,t&&s.length>0&&s.map((ke,je)=>{var At,ft,Xt;const rt=Zi(ke.moduleId,{width:r.width,height:r.height,depth:r.depth},r);if(!rt)return null;const _t=ke.customWidth||ke.adjustedWidth||rt.dimensions.width,Ee=B(_t),Le=((At=ke.adjustedPosition)==null?void 0:At.x)||ke.position.x;if(rt.id.includes("dual")&&r.surroundType==="no-surround"){const Yt=pr(r),Zt=ke.slotIndex===0,sn=ke.slotIndex===Yt.columnCount-2;r.installType==="freestanding"||r.installType==="semistanding"&&((ft=r.wallConfig)!=null&&ft.left&&sn||(Xt=r.wallConfig)!=null&&Xt.right)}const Ze=Le-Ee/2,nt=Le+Ee/2,st=ze-B(Y?120:80);return c.jsxs("group",{children:[c.jsx(lt,{points:[[Ze,E,st],[nt,E,st]],color:b,lineWidth:.5}),c.jsx(lt,{points:q([Ze,E,st],[Ze+.02,E,st],.01),color:b,lineWidth:.5}),c.jsx(lt,{points:q([nt,E,st],[nt-.02,E,st],.01),color:b,lineWidth:.5}),c.jsx(ii,{position:[Le,E+.1,st-B(30)],fontSize:te,color:b,anchorX:"center",anchorY:"middle",rotation:[-Math.PI/2,0,0],children:Math.round(_t)}),(()=>{var un,Sn;const Yt=(rt==null?void 0:rt.id.includes("dual"))||!1,Zt=(un=rt==null?void 0:rt.modelConfig)==null?void 0:un.rightAbsoluteDepth,sn=Yt&&Zt,vt=1500,Ye=600,Gt=20,Wt=ke.customDepth||((Sn=rt==null?void 0:rt.dimensions)==null?void 0:Sn.depth)||580,Vt=B(vt),Jt=B(Ye),It=B(Gt),Ut=ze+(Vt-Jt)/2;if(sn){const jt=Wt,fn=Zt,Zn=B(jt),Hn=B(fn),ti=Ut+Jt/2-It-Zn/2+Zn/2,ri=Ut+Jt/2-It-Hn/2+Hn/2+(Zn-Hn)/2;return c.jsxs(c.Fragment,{children:[c.jsx(lt,{points:[[Ze,E,ti],[Ze,E,st-B(15)]],color:b,lineWidth:.5}),c.jsx(lt,{points:[[nt,E,ri],[nt,E,st-B(15)]],color:b,lineWidth:.5})]})}else{const jt=B(Wt),fn=Ut+Jt/2-It-jt/2+jt/2;return c.jsxs(c.Fragment,{children:[c.jsx(lt,{points:[[Ze,E,fn],[Ze,E,st-B(15)]],color:b,lineWidth:.5}),c.jsx(lt,{points:[[nt,E,fn],[nt,E,st-B(15)]],color:b,lineWidth:.5})]})}})()]},`top-module-dim-${je}`)}),r.columns&&r.columns.length>0&&r.columns.map((ke,je)=>{const rt=ke.width*.01,_t=ke.position[0]-rt/2,Ee=ke.position[0]+rt/2,Le=ze-B(Y?120:80);return c.jsxs("group",{children:[c.jsx(lt,{points:[[_t,E,Le],[Ee,E,Le]],color:"#FF0000",lineWidth:.5}),c.jsx(lt,{points:q([_t,E,Le],[_t+.02,E,Le],.01),color:"#FF0000",lineWidth:.5}),c.jsx(lt,{points:q([Ee,E,Le],[Ee-.02,E,Le],.01),color:"#FF0000",lineWidth:.5}),c.jsx(ii,{position:[ke.position[0],E+.1,Le-B(30)],fontSize:te,color:"#FF0000",anchorX:"center",anchorY:"middle",rotation:[-Math.PI/2,0,0],children:Math.round(ke.width)}),c.jsx(lt,{points:[[_t,E,ze],[_t,E,Le-B(50)]],color:b,lineWidth:.5}),c.jsx(lt,{points:[[Ee,E,ze],[Ee,E,Le-B(50)]],color:b,lineWidth:.5})]},`top-column-dim-${ke.id}`)}),!1,!1]})})},ie=()=>null;return console.log("🎨 CleanCAD2D 최종 렌더링:",{currentViewDirection:I,showDimensions:u,hasColumns:!!r.columns,columnCount:(De=r.columns)==null?void 0:De.length,shouldRenderColumns:I==="front"}),c.jsxs("group",{ref:A,renderOrder:999999,children:[de(),ie(),((qe=r.droppedCeiling)==null?void 0:qe.enabled)&&I==="front"&&!1]})},UQ=({viewMode:n,view2DDirection:e="front",enabled:t=!0,showAxis:i=!0})=>{const{camera:r}=fh(),s=H.useRef(null),{theme:o}=Id(),{view2DTheme:a}=Wi();H.useMemo(()=>{const x=r.position.length();let S,I,j;return S=1,I=.1,x<5?j=x*30:x<15?j=x*25:x<40?j=x*20:j=x*15,{major:S,minor:I,size:Math.max(j,1e3)}},[r.position]);const l=H.useMemo(()=>{if(n==="2D")return{rotation:[0,0,0],position:[0,0,0]};switch(e){case"front":return{rotation:[0,0,0],position:[0,0,0]};case"left":return{rotation:[0,Math.PI/2,0],position:[0,0,0]};case"right":return{rotation:[0,-Math.PI/2,0],position:[0,0,0]};case"top":return{rotation:[-Math.PI/2,0,0],position:[0,0,.01]};default:return{rotation:[0,0,0],position:[0,0,0]}}},[e,n]),h=H.useMemo(()=>({minor:o.mode==="dark"?"#444444":"#dddddd",major:o.mode==="dark"?"#555555":"#bbbbbb",origin:o.mode==="dark"?"#888888":"#666666"}),[o.mode]),{majorLines:u,minorLines:d,axis1Lines:A,axis2Lines:f,axis1Color:p,axis2Color:g}=H.useMemo(()=>{if(n==="3D")return{majorLines:null,minorLines:null,axis1Lines:null,axis2Lines:null,axis1Color:16711680,axis2Color:255};const x=200,S=1,I=.1;console.log("🔲 CADGrid 렌더링:",{theme:o.mode,viewMode:n,view2DDirection:e,enabled:t,major:S,minor:I,size:x,gridColors:{minor:h.minor,major:h.major,origin:h.origin},majorPointsLength:"generating...",minorPointsLength:"generating..."});const j=[],C=[];switch(e){case"front":for(let B=-x;B<=x;B+=S)j.push(B,-x,0,B,x,0),j.push(-x,B,0,x,B,0);for(let B=-x;B<=x;B+=I)Math.abs(B%S)<.001||(C.push(B,-x,0,B,x,0),C.push(-x,B,0,x,B,0));break;case"top":for(let B=-x;B<=x;B+=S)j.push(B,0,-x,B,0,x),j.push(-x,0,B,x,0,B);for(let B=-x;B<=x;B+=I)Math.abs(B%S)<.001||(C.push(B,0,-x,B,0,x),C.push(-x,0,B,x,0,B));break;case"left":case"right":for(let B=-x;B<=x;B+=S)j.push(0,B,-x,0,B,x),j.push(0,-x,B,0,x,B);for(let B=-x;B<=x;B+=I)Math.abs(B%S)<.001||(C.push(0,B,-x,0,B,x),C.push(0,-x,B,0,x,B));break;default:for(let B=-x;B<=x;B+=S)j.push(B,-x,0,B,x,0),j.push(-x,B,0,x,B,0);for(let B=-x;B<=x;B+=I)Math.abs(B%S)<.001||(C.push(B,-x,0,B,x,0),C.push(-x,B,0,x,B,0));break}let b=[],D=[],T=16711680,k=255;switch(e){case"front":b=[-x,0,0,x,0,0],D=[0,-x,0,0,x,0],T=16711680,k=255;break;case"top":b=[-x,0,0,x,0,0],D=[0,0,-x,0,0,x],T=16711680,k=65280;break;case"left":b=[0,0,-x,0,0,x],D=[0,-x,0,0,x,0],T=65280,k=255;break;case"right":b=[0,0,-x,0,0,x],D=[0,-x,0,0,x,0],T=65280,k=255;break;default:b=[-x,0,0,x,0,0],D=[0,-x,0,0,x,0],T=16711680,k=255;break}return console.log("🔲 그리드 라인 생성 완료:",{majorCount:j.length/6,minorCount:C.length/6}),{majorLines:new Float32Array(j),minorLines:new Float32Array(C),axis1Lines:new Float32Array(b),axis2Lines:new Float32Array(D),axis1Color:T,axis2Color:k}},[t,n,e,h]),v=H.useRef(null),w=H.useRef(null),[m,y]=H.useState(!1);return J_(()=>{if(!t||n==="3D"||!s.current)return;s.current.visible=!0,s.current.renderOrder=-1e3;const x=n==="2D"&&"zoom"in r?100/r.zoom:r.position.length(),S=200;let I=100;if(n==="2D"&&"zoom"in r){const b=r,D=(b.top-b.bottom)/b.zoom,T=(b.right-b.left)/b.zoom;I=Math.max(D,T)}const j=S/I;let C=1;j<.8?C=0:x<=10?C=1:x<=30?C=1-(x-10)/20*.6:x<=60?C=.4-(x-30)/30*.3:C=0,C=Math.max(C,0),v.current&&(v.current.opacity=.3*C,v.current.needsUpdate=!0),w.current&&(w.current.opacity=.5*C,w.current.needsUpdate=!0),Math.random()<.001&&console.log("🔲 Grid opacity:",{distance:x,opacity:C,minorOpacity:.3*C,majorOpacity:.5*C,zoom:"zoom"in r?r.zoom:"N/A",gridSize:S,viewportSize:I,gridToViewportRatio:j})}),n==="3D"||!A||!f?null:n==="2D"?c.jsxs(c.Fragment,{children:[t&&u&&d&&c.jsxs("group",{ref:s,position:l.position,rotation:l.rotation,children:[c.jsxs("lineSegments",{renderOrder:-999,children:[c.jsx("bufferGeometry",{children:c.jsx("bufferAttribute",{args:[d,3],attach:"attributes-position",count:d.length/3,array:d,itemSize:3})}),c.jsx("lineBasicMaterial",{ref:v,color:h.minor,opacity:.3,transparent:!0,depthTest:!1,depthWrite:!1})]}),c.jsxs("lineSegments",{renderOrder:-998,children:[c.jsx("bufferGeometry",{children:c.jsx("bufferAttribute",{args:[u,3],attach:"attributes-position",count:u.length/3,array:u,itemSize:3})}),c.jsx("lineBasicMaterial",{ref:w,color:h.major,opacity:.5,transparent:!0,depthTest:!1,depthWrite:!1})]})]}),i&&c.jsxs("group",{position:[0,0,0],rotation:[0,0,0],children:[c.jsxs("lineSegments",{renderOrder:-997,children:[c.jsx("bufferGeometry",{children:c.jsx("bufferAttribute",{args:[A,3],attach:"attributes-position",count:A.length/3,array:A,itemSize:3})}),c.jsx("lineBasicMaterial",{color:p,opacity:.6,transparent:!0,depthTest:!1,depthWrite:!1})]}),c.jsxs("lineSegments",{renderOrder:-996,children:[c.jsx("bufferGeometry",{children:c.jsx("bufferAttribute",{args:[f,3],attach:"attributes-position",count:f.length/3,array:f,itemSize:3})}),c.jsx("lineBasicMaterial",{color:g,opacity:.6,transparent:!0,depthTest:!1,depthWrite:!1})]}),c.jsxs("mesh",{position:[0,0,.01],renderOrder:-995,children:[c.jsx("sphereGeometry",{args:[.05]}),c.jsx("meshBasicMaterial",{color:h.origin,opacity:.8,transparent:!0})]})]})]}):c.jsxs("group",{ref:s,position:l.position,rotation:l.rotation,children:[c.jsxs("lineSegments",{renderOrder:-999,children:[c.jsx("bufferGeometry",{children:c.jsx("bufferAttribute",{args:[d,3],attach:"attributes-position",count:d.length/3,array:d,itemSize:3})}),c.jsx("lineBasicMaterial",{color:n==="2D"&&a==="dark"?"#444444":"#dddddd",opacity:.3,transparent:!0,depthTest:!1,depthWrite:!1})]}),c.jsxs("lineSegments",{renderOrder:-998,children:[c.jsx("bufferGeometry",{children:c.jsx("bufferAttribute",{args:[u,3],attach:"attributes-position",count:u.length/3,array:u,itemSize:3})}),c.jsx("lineBasicMaterial",{color:n==="2D"&&a==="dark"?"#555555":"#bbbbbb",opacity:.4,transparent:!0,depthTest:!1,depthWrite:!1})]}),c.jsxs("lineSegments",{renderOrder:-997,children:[c.jsx("bufferGeometry",{children:c.jsx("bufferAttribute",{args:[A,3],attach:"attributes-position",count:A.length/3,array:A,itemSize:3})}),c.jsx("lineBasicMaterial",{color:p,opacity:.6,transparent:!0,depthTest:!1,depthWrite:!1})]}),c.jsxs("lineSegments",{renderOrder:-996,children:[c.jsx("bufferGeometry",{children:c.jsx("bufferAttribute",{args:[f,3],attach:"attributes-position",count:f.length/3,array:f,itemSize:3})}),c.jsx("lineBasicMaterial",{color:g,opacity:.6,transparent:!0,depthTest:!1,depthWrite:!1})]}),c.jsxs("mesh",{position:[0,0,.01],renderOrder:-995,children:[c.jsx("sphereGeometry",{args:[.05]}),c.jsx("meshBasicMaterial",{color:h.origin})]})]})},fue=({spaceInfo:n})=>{var d;if(!((d=n.droppedCeiling)!=null&&d.enabled))return null;const e=gp(n);if(!e)return null;const{position:t}=n.droppedCeiling,i=n.depth||600,r=n.droppedCeiling.dropHeight||200;console.log("🏗️ DroppedCeilingSpace 디버그:",{bounds:e,position:t,dropHeight:r,depth:i,spaceHeight:n.height});const s=mc(e.startX),o=mc(e.width),a=mc(e.height),l=mc(r),h=mc(i),u=mc(n.height);return isNaN(o)||isNaN(a)||isNaN(h)||isNaN(l)||isNaN(s)||isNaN(u)?(console.error("🚨 DroppedCeilingSpace - NaN 값 감지:",{threeStartX:s,threeWidth:o,threeHeight:a,threeDropHeight:l,threeDepth:h,threeSpaceHeight:u,bounds:e,dropHeight:r,depth:i}),null):c.jsx("group",{})},pue=ci.memo(fue),OQ=({spaceInfo:n,showAll:e=!0,showDimensions:t=!0,viewMode:i})=>{var z,te,L,O,J;const r=pi($=>$.placedModules),s=pi($=>$.addModule),o=pi($=>$.removeModule),a=pi($=>$.currentDragData),l=pi($=>$.setCurrentDragData);pi($=>$.setFurniturePlacementMode);const{showAlert:h}=moe(),{camera:u,scene:d}=fh(),{viewMode:A}=cr(),{view2DDirection:f}=Wi(),p=i||A;console.log("🔴🔴🔴 SlotDropZonesSimple - 렌더링 상태:",{viewModeProp:i,contextViewMode:A,finalViewMode:p,is3D:p==="3D",showAll:e,showDimensions:t,droppedCeilingEnabled:(z=n==null?void 0:n.droppedCeiling)==null?void 0:z.enabled,timestamp:new Date().toISOString()});const{theme:g}=Ua(),[v,w]=H.useState(null),[m,y]=H.useState(null);if(H.useEffect(()=>(window.__currentSpaceInfo=n,()=>{delete window.__currentSpaceInfo}),[n]),!n)return console.error("❌ No spaceInfo provided to SlotDropZonesSimple"),null;if(console.log("🔍 SlotDropZonesSimple - spaceInfo:",{width:n.width,height:n.height,depth:n.depth,surroundType:n.surroundType,gapConfig:n.gapConfig,customColumnCount:n.customColumnCount,columnMode:n.columnMode}),!n.width||!n.height||!n.depth)return console.error("❌ Invalid spaceInfo dimensions:",{width:n.width,height:n.height,depth:n.depth}),c.jsx("group",{});const x=Kr(n),S=pr(n);if(console.log("🔍 SlotDropZonesSimple - calculated values:",{internalSpace:x,indexing:{columnCount:S==null?void 0:S.columnCount,columnWidth:S==null?void 0:S.columnWidth,threeUnitPositionsLength:(te=S==null?void 0:S.threeUnitPositions)==null?void 0:te.length,slotWidths:S==null?void 0:S.slotWidths}}),!S||!S.threeUnitPositions||!Array.isArray(S.threeUnitPositions))return console.error("❌ Invalid indexing data:",{indexing:S,hasIndexing:!!S,hasThreeUnitPositions:!!(S!=null&&S.threeUnitPositions),isArray:Array.isArray(S==null?void 0:S.threeUnitPositions),spaceInfo:n}),c.jsx("group",{});const I=oce(n),j=ace(n);n.baseConfig&&console.log("🔧 베이스프레임 및 슬롯 위치 정보:",{baseType:n.baseConfig.type,baseHeight:n.baseConfig.height,placementType:n.baseConfig.placementType,floatHeight:n.baseConfig.floatHeight,slotStartY:j,slotHeight:I.height,슬롯중심Y:j+I.height/2,floorFinishHeight:n.hasFloorFinish?(L=n.floorFinish)==null?void 0:L.height:0});const C=$=>$*.01,b=H.useRef(),D=H.useCallback(($,U,Y)=>{var Yt,Zt,sn,vt,Ye,Gt,Wt,Vt,Jt,It,Ut,un,Sn,jt,fn,Zn,Hn,ti,ri,bi,Ni,ui,si,Li,Tr,xr,br,vn,wi,Ve,ct,mt,An,nn,zt,gn,Jn,Qn,pn,Ln,Dn,ei,xi,Yi,Bn,Ri,xt,Bt,on,ln,li,hi,Ii,kr,zr,Us,io,ws,Ts,Mn,ve,Re,Ke,Ge,pt,Pt,pe,xe,at,dt,Qt,wn,gt,Vn,Yn,ht,Ot,In,Wn,xn,Gn,fi,Ki,Ji,Ci,Qi,zi,Ir,Hr,Si,re,be,Ue,ut,yt,en,cn,Tn,$n,ai,ni,Rn,sr,dr,qr,vs,Cr,cs,Qr,or,hs,us,Oo,va,Lh,xa,N,ce,we,Pe,Nt,tn,Un,is,ro,$r,rs,Bs,_l,Bo,Ao,Ha,Wa,dl,za,ba,Xc,Ou,Qa,Vs,Hu,Cc,Ll,su,gh,Ca,Yc,tc,$a,_c,Kc,Sl,nc,Ar,Os,wo,vo,ic,Mh,Va,Ks,Vo,ra,Ld,Wu,zu,rg,_a,TA,BA,EA,Sc;console.log("🚀🚀🚀 [handleSlotDrop] 함수 시작:",{dragEvent:!!$,activeZone:Y,droppedCeilingEnabled:(Yt=n.droppedCeiling)==null?void 0:Yt.enabled,dragEventType:$==null?void 0:$.type,canvasElement:!!U,canvasTagName:U==null?void 0:U.tagName,clientX:$==null?void 0:$.clientX,clientY:$==null?void 0:$.clientY});const K=pi.getState(),V=K.currentDragData,Q=K.placedModules;let X=hr.getState().spaceInfo;console.log("🔴🔴🔴 [CRITICAL] handleSlotDrop 시점의 상태:",{"dragData에 spaceInfo 있음?":!!(V!=null&&V.spaceInfo),surroundType:X.surroundType,frameSize:X.frameSize,"frameSize가 50인가?":((Zt=X.frameSize)==null?void 0:Zt.left)===50||((sn=X.frameSize)==null?void 0:sn.right)===50,문제:X.surroundType==="no-surround"&&(((vt=X.frameSize)==null?void 0:vt.left)===50||((Ye=X.frameSize)==null?void 0:Ye.right)===50)?"🔴🔴🔴 노서라운드인데 frameSize가 50임!!!":"정상"}),X.surroundType==="no-surround"&&X.frameSize&&(X.frameSize.left>0||X.frameSize.right>0)&&(console.error("🔴🔴🔴 [CRITICAL] 노서라운드 모드인데 frameSize가 0이 아님! 강제로 0으로 수정합니다."),X={...X,frameSize:{left:0,right:0,top:0}}),Kr(X);const W=pr(X);console.log("🔴🔴🔴 [CRITICAL] frameSize 수정 후 indexing:",{"첫슬롯 위치":(Gt=W.threeUnitPositions)==null?void 0:Gt[0],"마지막슬롯 위치":(Wt=W.threeUnitPositions)==null?void 0:Wt[W.threeUnitPositions.length-1],internalStartX:W.internalStartX,internalWidth:W.internalWidth}),console.log("🎯🎯🎯 [핵심] handleSlotDrop 호출됨!",{hasLatestDragData:!!V,latestDragData:V,moduleCategory:((Vt=V==null?void 0:V.moduleData)==null?void 0:Vt.category)||"unknown",moduleType:(Jt=V==null?void 0:V.moduleData)==null?void 0:Jt.type,isUpperCabinet:((It=V==null?void 0:V.moduleData)==null?void 0:It.category)==="upper",droppedCeilingEnabled:(Ut=X.droppedCeiling)==null?void 0:Ut.enabled,surroundType:X.surroundType,frameSize:X.frameSize,installType:X.installType,gapConfig:X.gapConfig,droppedCeilingWidth:(un=X.droppedCeiling)==null?void 0:un.width,hasIndexingZones:!!(S!=null&&S.zones)});const se=U.getBoundingClientRect(),q=($.clientX-se.left)/se.width*2-1,de=-(($.clientY-se.top)/se.height)*2+1;let Ce;const Se=X.droppedCeiling&&X.droppedCeiling.enabled===!0;if(console.log("🔍 [SlotDropZonesSimple] 단내림 체크:",{hasDroppedCeiling:Se,droppedCeiling:X.droppedCeiling,enabled:(Sn=X.droppedCeiling)==null?void 0:Sn.enabled,width:(jt=X.droppedCeiling)==null?void 0:jt.width,position:(fn=X.droppedCeiling)==null?void 0:fn.position}),Se)try{console.log("🔍 [SlotDropZonesSimple] calculateZoneSlotInfo 호출 전:",{surroundType:X.surroundType,installType:X.installType,droppedCeiling:X.droppedCeiling,customColumnCount:X.customColumnCount});const Tt=ar.calculateZoneSlotInfo(X,X.customColumnCount);if(console.log("🔍 [SlotDropZonesSimple] calculateZoneSlotInfo 결과:",{zoneInfo:Tt,hasDropped:!!(Tt!=null&&Tt.dropped),hasNormal:!!(Tt!=null&&Tt.normal)}),Tt&&Tt.normal&&Tt.dropped){const Kn=C(Tt.dropped.startX+Tt.dropped.width),os=C(Tt.normal.startX);if(!u)return console.warn("Camera not available for raycasting"),!1;const En=new YA;En.setFromCamera(new sd(q,de),u);const ur=C(x.startY),xs=new sm(new lo(0,1,0),-ur),an=new lo;En.ray.intersectPlane(xs,an)?(X.droppedCeiling.position==="left"?Ce=an.x<Kn?"dropped":"normal":Ce=an.x>=os?"dropped":"normal",console.log("🎯 자동 영역 판단:",{mouseX:q,mouseY:de,worldX:an.x,droppedEndX:Kn,normalStartX:os,droppedPosition:X.droppedCeiling.position,detectedZone:Ce,zoneInfo:{normal:{columnCount:(Zn=Tt.normal)==null?void 0:Zn.columnCount,startX:(Hn=Tt.normal)==null?void 0:Hn.startX,width:(ti=Tt.normal)==null?void 0:ti.width},dropped:{columnCount:(ri=Tt.dropped)==null?void 0:ri.columnCount,startX:(bi=Tt.dropped)==null?void 0:bi.startX,width:(Ni=Tt.dropped)==null?void 0:Ni.width}}})):(Ce="normal",console.log("⚠️ 평면과의 교차점을 찾지 못함, 기본값 사용:",Ce))}else console.error("⚠️ Zone info is null or incomplete:",{zoneInfo:Tt,spaceInfo:{surroundType:X.surroundType,installType:X.installType,droppedCeiling:X.droppedCeiling}}),Ce="normal"}catch(Tt){console.error("❌ 자동 영역 판단 중 오류:",Tt),Ce="normal"}let fe=null;try{const Tt=(ui=$.dataTransfer)==null?void 0:ui.getData("application/json");console.log("📋 Drag data string from dataTransfer:",{hasDataTransfer:!!$.dataTransfer,types:(si=$.dataTransfer)==null?void 0:si.types,effectAllowed:(Li=$.dataTransfer)==null?void 0:Li.effectAllowed,dropEffect:(Tr=$.dataTransfer)==null?void 0:Tr.dropEffect,dataString:Tt,dataStringLength:Tt==null?void 0:Tt.length}),Tt&&(fe=JSON.parse(Tt),console.log("✅ Successfully parsed drag data from dataTransfer:",fe))}catch(Tt){console.error("Error parsing drag data:",Tt)}if(fe||(console.log("⚠️ No drag data from event dataTransfer, using store data instead"),fe=V,console.log("🔄 Using latest drag data from store:",{hasData:!!fe,type:fe==null?void 0:fe.type,moduleId:(xr=fe==null?void 0:fe.moduleData)==null?void 0:xr.id,moduleCategory:(br=fe==null?void 0:fe.moduleData)==null?void 0:br.category})),console.log("📦 Final effective drag data:",fe),!fe||fe.type!=="furniture")return console.log("❌ Invalid drag data:",{dragData:fe,type:fe==null?void 0:fe.type}),!1;if((vn=fe.moduleData)!=null&&vn.needsWarning)return console.log("⚠️ 슬롯 사이즈 부족 - 배치 불가"),!1;if((wi=X.droppedCeiling)!=null&&wi.enabled&&!Ce){console.warn("⚠️ 단내림이 활성화되어 있지만 zoneToUse가 설정되지 않음. 레이캐스트로 zone 감지 시도");const Tt=U.getBoundingClientRect(),Kn=($.clientX-Tt.left)/Tt.width*2-1,os=-(($.clientY-Tt.top)/Tt.height)*2+1;if(u&&d){const En=new YA;En.setFromCamera(new sd(Kn,os),u);const ur=d.children.flatMap(an=>an.children||[an]).filter(an=>{var as;return(as=an.userData)==null?void 0:as.isSlotCollider}),xs=En.intersectObjects(ur,!0);if(xs.length>0){const an=xs[0].object,as=an==null?void 0:an.userData;Ce=(as==null?void 0:as.zone)||"normal",console.log("✅ Zone 감지 성공 (레이캐스트):",{detectedZone:Ce,colliderData:as,distance:xs[0].distance})}else{const an=ar.calculateZoneSlotInfo(X,X.customColumnCount);if(an.dropped&&an.normal){const as=((Ve=X.droppedCeiling)==null?void 0:Ve.position)||"right";if(as==="left"){const ha=C(an.dropped.startX+an.dropped.width);Ce=Kn<ha?"dropped":"normal"}else{const ha=C(an.normal.startX+an.normal.width);Ce=Kn<ha?"normal":"dropped"}console.log("✅ Zone 감지 성공 (마우스 X 위치):",{detectedZone:Ce,mouseX:Kn,droppedPosition:as})}else console.log('⚠️ Zone 감지 실패, 기본값 "normal" 설정'),Ce="normal"}}else console.log('⚠️ Camera 또는 Scene 없음, 기본값 "normal" 설정'),Ce="normal"}console.log("🚨🚨🚨 단내림 영역별 처리 시작:",{droppedCeilingEnabled:(ct=X.droppedCeiling)==null?void 0:ct.enabled,zoneToUse:Ce,zoneToUseType:typeof Ce,조건충족:!!((mt=X.droppedCeiling)!=null&&mt.enabled&&Ce),dragData:{moduleId:fe==null?void 0:fe.moduleId,moduleData:fe==null?void 0:fe.moduleData}});const M=ar.calculateZoneSlotInfo(X,X.customColumnCount);if((An=X.droppedCeiling)!=null&&An.enabled&&Ce){console.log("✅ 단내림 영역별 처리 진입!",{zone:En,droppedCeiling:X.droppedCeiling,zoneInfo:M});let Tt,Kn;if(En==="dropped"&&M.dropped){const Kt=((nn=X.droppedCeiling)==null?void 0:nn.width)||ea.WIDTH,Cn={...X,width:Kt,customColumnCount:M.dropped.columnCount,frameSize:X.surroundType==="no-surround"?{}:X.frameSize};console.log("🚨 [SlotDropZonesSimple] 단내림 영역 spaceInfo:",{surroundType:Cn.surroundType,installType:Cn.installType,width:Cn.width,customColumnCount:Cn.customColumnCount});const On=((zt=X.droppedCeiling)==null?void 0:zt.dropHeight)||200;Kn={width:M.dropped.width,height:X.height-On,depth:X.depth,startX:M.dropped.startX,startY:0,startZ:-(X.depth/2)},console.log("🔧 [SlotDropZonesSimple] 단내림 영역 내경 (zoneInfo 사용):",{width:Kn.width,startX:Kn.startX,originalHeight:X.height,dropHeight:On,adjustedHeight:Kn.height,zone:"dropped"}),Tt={columnCount:M.dropped.columnCount,columnWidth:M.dropped.columnWidth,slotWidths:M.dropped.slotWidths||Array(M.dropped.columnCount).fill(M.dropped.columnWidth),threeUnitPositions:[],threeUnitDualPositions:[],threeUnitBoundaries:[]}}else Kn={width:M.normal.width,height:X.height,depth:X.depth,startX:M.normal.startX,startY:0,startZ:-(X.depth/2)},console.log("🔧 [SlotDropZonesSimple] 메인 영역 내경 (zoneInfo 사용):",{width:Kn.width,startX:Kn.startX,height:Kn.height,zone:"normal"}),Tt={columnCount:M.normal.columnCount,columnWidth:M.normal.columnWidth,slotWidths:M.normal.slotWidths||Array(M.normal.columnCount).fill(M.normal.columnWidth),threeUnitPositions:[],threeUnitDualPositions:[],threeUnitBoundaries:[]};console.log("🎯 Before getSlotIndexFromRaycast:",{clientX:$.clientX,clientY:$.clientY,hasCanvas:!!U,hasCamera:!!u,hasScene:!!d,spaceInfo:{width:X.width,height:X.height,baseConfig:X.baseConfig,droppedCeiling:X.droppedCeiling}});let os,En;(gn=X.droppedCeiling)!=null&&gn.enabled&&(os=void 0);let ur=e2($.clientX,$.clientY,U,u,d,X,os);console.log("🎯 첫 번째 시도 결과:",{slotIndex:ur,detectedZone:os,droppedCeilingEnabled:(Jn=X.droppedCeiling)==null?void 0:Jn.enabled}),ur===null&&os&&(console.log("⚠️ Zone 지정 실패, 전체 영역에서 다시 검색"),ur=e2($.clientX,$.clientY,U,u,d,X),console.log("🎯 두 번째 시도 결과 (zone 없이):",ur)),console.log("🎯 After getSlotIndexFromRaycast:",{slotIndex:ur,isNull:ur===null,type:typeof ur,detectedZone:os,zoneToUse:En,droppedCeilingEnabled:(Qn=X.droppedCeiling)==null?void 0:Qn.enabled});let xs;if(ur!==null&&((pn=X.droppedCeiling)!=null&&pn.enabled)&&d){const Kt=[];d.traverse(On=>{var ir;(ir=On.userData)!=null&&ir.isSlotCollider&&Kt.push(On)});const Cn=Kt.filter(On=>On.userData.slotIndex===ur);if(console.log("🔍 All colliders and matching ones:",{totalColliders:Kt.length,allCollidersInfo:Kt.map(On=>({slotIndex:On.userData.slotIndex,zone:On.userData.zone,position:On.position.x})),slotIndex:ur,matchingColliders:Cn.map(On=>({zone:On.userData.zone,position:On.position.x}))}),Cn.length>0){const On=U.getBoundingClientRect(),ir=($.clientX-On.left)/On.width*2-1;if(!u)return console.warn("Camera not available for raycasting in drag handler"),!1;const Ui=new YA;Ui.setFromCamera(new sd(ir,0),u);const fo=C(x.startY),Go=new sm(new lo(0,1,0),-fo),Ya=new lo;if(Ui.ray.intersectPlane(Go,Ya)){let Sa=Cn[0],sc=Math.abs(Ya.x-Sa.position.x);for(const Vu of Cn){const Lf=Math.abs(Ya.x-Vu.position.x);Lf<sc&&(sc=Lf,Sa=Vu)}xs=Sa.userData.zone,console.log("🎯 Detected collider zone:",{colliderZone:xs,mouseX:Ya.x,colliderX:Sa.position.x,distance:sc})}}}if(console.log("🎰 Slot index from raycast (dropped zone):",{slotIndex:ur,zoneToUse:En,colliderZone:xs,zoneMismatch:xs&&En!==xs,droppedInfo:X.droppedCeiling,zoneInfo:{normal:{columnCount:(Ln=M.normal)==null?void 0:Ln.columnCount,startX:(Dn=M.normal)==null?void 0:Dn.startX,width:(ei=M.normal)==null?void 0:ei.width},dropped:{columnCount:(xi=M.dropped)==null?void 0:xi.columnCount,startX:(Yi=M.dropped)==null?void 0:Yi.startX,width:(Bn=M.dropped)==null?void 0:Bn.width}},validationCheck:{isDroppedZone:En==="dropped",droppedExists:!!M.dropped,slotIndexVsColumnCount:`${ur} >= ${(Ri=M.dropped)==null?void 0:Ri.columnCount}`,willFail:En==="dropped"&&(!M.dropped||ur>=M.dropped.columnCount)}}),xs)En?En!==xs&&(console.warn("⚠️ Zone mismatch detected!",{detectedZone:En,colliderZone:xs,slotIndex:ur}),En=xs,console.log("🔧 Corrected zone to match collider:",En)):(En=xs,console.log("🎯 Zone set from collider:",En));else if((xt=X.droppedCeiling)!=null&&xt.enabled&&!En){const Kt=U.getBoundingClientRect(),Cn=($.clientX-Kt.left)/Kt.width*2-1,On=ar.calculateZoneSlotInfo(X,X.customColumnCount);if(On&&On.normal&&On.dropped){const ir=((Bt=X.droppedCeiling)==null?void 0:Bt.position)||"right";if(!u)console.warn("Camera not available for zone detection"),En="normal";else{const Ui=new YA;Ui.setFromCamera(new sd(Cn,0),u);const fo=C(x.startY),Go=new sm(new lo(0,1,0),-fo),Ya=new lo;if(Ui.ray.intersectPlane(Go,Ya)){const Sa=Ya.x;if(ir==="left"){const sc=C(On.dropped.startX+On.dropped.width);En=Sa<sc?"dropped":"normal"}else{const sc=C(On.normal.startX+On.normal.width);En=Sa<sc?"normal":"dropped"}console.log("🎯 Zone detected from mouse position:",{zoneToUse:En,worldX:Sa,droppedPosition:ir})}else En="normal",console.log("🎯 Using default zone (normal) - raycasting failed")}}else En="normal",console.log("🎯 Using default zone (normal) - no zone info")}if(!((on=X.droppedCeiling)!=null&&on.enabled)&&!En&&(En="normal",console.log("🎯 No dropped ceiling, using normal zone")),En||(En="normal",console.log("⚠️ Zone still undefined, defaulting to normal")),ur===null)if(console.log("❌ No slot index found (dropped zone)"),(ln=X.droppedCeiling)!=null&&ln.enabled&&En&&M[En]){const Kt=M[En],Cn=U.getBoundingClientRect(),On=($.clientX-Cn.left)/Cn.width*2-1;if(!u)return console.warn("Camera not available for raycasting in handle drop"),!1;const ir=new YA;ir.setFromCamera(new sd(On,0),u);const Ui=C(x.startY),fo=new sm(new lo(0,1,0),-Ui),Go=new lo;if(ir.ray.intersectPlane(fo,Go)){const Ya=C(Kt.startX),Sa=C(Kt.startX+Kt.width);if(Go.x>=Ya&&Go.x<=Sa){const sc=Go.x-Ya,Vu=C(Kt.columnWidth);ur=Math.floor(sc/Vu),ur=Math.max(0,Math.min(ur,Kt.columnCount-1)),console.log("🔧 Fallback slot index calculation:",{zoneToUse:En,mouseWorldX:Go.x,zoneStartX:Ya,zoneEndX:Sa,relativeX:sc,columnWidth:Vu,calculatedSlotIndex:ur})}else return console.error("❌ Mouse position outside target zone"),!1}else return console.error("❌ Failed to calculate world position"),!1}else return!1;const an=ur;if(En==="dropped"&&!M.dropped){if(console.warn("⚠️ Dropped zone info is null, switching to normal zone"),En="normal",!M.normal)return console.error("❌ Both zone infos are null"),!1}else if(En==="normal"&&!M.normal&&(console.warn("⚠️ Normal zone info is null, switching to dropped zone"),En="dropped",!M.dropped))return console.error("❌ Both zone infos are null"),!1;const as=En==="dropped"?M.dropped:M.normal;if(as&&ur>=as.columnCount){console.warn("⚠️ Slot index out of range, correcting:",{zone:En,slotIndex:ur,columnCount:as.columnCount,validRange:`0-${as.columnCount-1}`,allZoneInfo:{normal:{columnCount:(li=M.normal)==null?void 0:li.columnCount,startX:(hi=M.normal)==null?void 0:hi.startX},dropped:{columnCount:(Ii=M.dropped)==null?void 0:Ii.columnCount,startX:(kr=M.dropped)==null?void 0:kr.startX}}});const Kt=[];d&&d.traverse(On=>{var ir;(ir=On.userData)!=null&&ir.isSlotCollider&&Kt.push(On)}),console.log("🔍 Re-checking colliders for debugging:",{totalColliders:Kt.length,droppedZoneColliders:Kt.filter(On=>On.userData.zone==="dropped").map(On=>({slotIndex:On.userData.slotIndex,position:On.position.x})),normalZoneColliders:Kt.filter(On=>On.userData.zone==="normal").map(On=>({slotIndex:On.userData.slotIndex,position:On.position.x}))});const Cn=Math.max(0,Math.min(ur,as.columnCount-1));console.log("🔧 Correcting slot index to valid range:",ur,"->",Cn),ur=Cn}ur<0&&(console.error("❌ Invalid negative slot index:",ur),ur=0);const ha=((zr=X.droppedCeiling)==null?void 0:zr.width)||ea.WIDTH;(Us=X.droppedCeiling)!=null&&Us.position;let Tc;En==="dropped"?Tc=ha:Tc=X.width-ha;const Ml=En==="dropped"?M.dropped:M.normal;if(!Ml)return console.error("❌ Target zone is null:",{zoneToUse:En,zoneInfo:M}),!1;const Dr={...X,zone:En,width:Tc,frameSize:X.frameSize};console.log("🔧 [SlotDropZonesSimple] zoneSpaceInfo 생성:",{zone:En,droppedCeilingEnabled:(io=Dr.droppedCeiling)==null?void 0:io.enabled,zoneSpaceInfo:{width:Dr.width,zone:Dr.zone,droppedCeiling:Dr.droppedCeiling}});const mr=Kr(Dr);if(console.log("🔴🔴🔴 [CRITICAL DEBUG] zoneSpaceInfo at drop:",{zone:En,surroundType:Dr.surroundType,frameSize:Dr.frameSize,width:Dr.width,internalSpace:mr}),En==="dropped"){const Kt=((ws=X.droppedCeiling)==null?void 0:ws.dropHeight)||200;mr.height=Math.max(mr.height-Kt,100)}console.log("🔧 [SlotDropZonesSimple] 영역별 내경 공간 재계산:",{zone:En,originalInternalSpace:Kn,recalculatedInternalSpace:mr,droppedCeilingEnabled:(Ts=X.droppedCeiling)==null?void 0:Ts.enabled,dropHeight:(Mn=X.droppedCeiling)==null?void 0:Mn.dropHeight,isHeightReducedForDropped:En==="dropped"});const Ps=Ak(mr,Dr);console.log("🎯 단내림 구간 모듈 생성 결과:",{zoneToUse:En,moduleCount:Ps.length,zoneInternalSpace:Kn,zoneSpaceInfo:{width:Dr.width,zone:Dr.zone,customColumnCount:Dr.customColumnCount},firstModule:Ps[0],upperModules:Ps.filter(Kt=>Kt.category==="upper").map(Kt=>({id:Kt.id,name:Kt.name,width:Kt.dimensions.width,height:Kt.dimensions.height})),lowerModules:Ps.filter(Kt=>Kt.category==="lower").map(Kt=>({id:Kt.id,name:Kt.name,width:Kt.dimensions.width,height:Kt.dimensions.height}))}),console.log("🔴🔴🔴 [CRITICAL] 드래그 데이터 문제 확인:",{문제:"드래그 시작 시점의 moduleData는 옛날 공간 설정 기준",드래그데이터의_모듈ID:(ve=V==null?void 0:V.moduleData)==null?void 0:ve.id,드래그데이터의_너비:(Ke=(Re=V==null?void 0:V.moduleData)==null?void 0:Re.dimensions)==null?void 0:Ke.width,현재공간설정:{surroundType:X.surroundType,installType:X.installType,customColumnCount:X.customColumnCount,mainDoorCount:X.mainDoorCount,columnWidth:W.columnWidth}});const xo=((Ge=V==null?void 0:V.moduleData)==null?void 0:Ge.id)||fe.moduleData.id,ou=xo.lastIndexOf("-"),FA=xo.substring(ou+1);let Ga;/^\d+$/.test(FA)?Ga=xo.substring(0,ou):Ga=xo,console.log("🔧 모듈 타입 추출:",{원본ID:xo,마지막부분:FA,숫자여부:/^\d+$/.test(FA),추출된타입:Ga});let jr=xo.startsWith("dual-"),Xa;if(console.log("🔍 [노서라운드 디버깅] targetWidth 계산 시작:",{surroundType:X.surroundType,droppedCeilingEnabled:(pt=X.droppedCeiling)==null?void 0:pt.enabled,zoneSlotIndex:an,zoneIndexing:{columnCount:Tt.columnCount,columnWidth:Tt.columnWidth,slotWidths:Tt.slotWidths},isDual:jr}),jr&&Tt.slotWidths&&an<Tt.slotWidths.length-1)Xa=Tt.slotWidths[an]+Tt.slotWidths[an+1],console.log("🔍 [노서라운드 디버깅] 듀얼 가구 targetWidth:",Xa);else if(Tt.slotWidths&&Tt.slotWidths[an]!==void 0)Xa=Tt.slotWidths[an],console.log("🔍 [노서라운드 디버깅] 싱글 가구 targetWidth (slotWidths 사용):",Xa);else{const Kt=Tt.columnWidth;Xa=jr?Kt*2:Kt,console.log("🔍 [노서라운드 디버깅] Fallback targetWidth (columnWidth 사용):",Xa)}let ua;(Pt=X.droppedCeiling)!=null&&Pt.enabled?X.surroundType==="no-surround"?(ua=fe.moduleData.id,console.log("🔧 [노서라운드] 원본 모듈 ID 사용 (단내림 있음):",ua)):(ua=`${Ga}-${Xa}`,console.log("🔧 [서라운드] 슬롯 너비 기반 ID 생성 (단내림 있음):",ua)):X.surroundType==="no-surround"?(ua=fe.moduleData.id,console.log("🔧 [노서라운드] 원본 모듈 ID 사용 (단내림 없음):",ua)):(ua=`${Ga}-${Xa}`,console.log("🔧 [서라운드] 슬롯 너비 기반 ID 생성 (단내림 없음):",ua)),console.log("🔍 가구 검색:",{원본ID:fe.moduleData.id,원본카테고리:fe.moduleData.category,기본타입:Ga,목표너비:Xa,찾는ID:ua,isDual:jr,생성된모듈수:Ps.length,생성된모듈들:Ps.map(Kt=>({id:Kt.id,category:Kt.category,width:Kt.dimensions.width}))});let kn;const Qu=fe.moduleData.category==="upper"||fe.moduleData.category==="lower";if(console.log("🔍 모듈 검색 시작:",{targetModuleId:ua,originalModuleId:fe.moduleData.id,originalCategory:fe.moduleData.category,moduleBaseType:Ga,zone:En,isUpperOrLower:Qu}),Qu&&En==="dropped"?(console.log("📦 단내림 영역 상하부장 모듈 생성 - 전체 내경 기준:",{targetModuleId:ua,category:fe.moduleData.category,fullInternalSpaceHeight:x.height,zoneInternalSpaceHeight:mr.height,zone:En}),kn=Zi(ua,x,Dr),console.log("🔴🔴🔴 단내림 구간 상부장 모듈 검색 결과:",{targetModuleId:ua,moduleFound:!!kn,moduleCategory:kn==null?void 0:kn.category,moduleHeight:(pe=kn==null?void 0:kn.dimensions)==null?void 0:pe.height,internalSpaceUsed:x,zoneSpaceInfo:Dr})):kn=Zi(ua,mr,Dr),kn||(console.warn("⚠️ 영역 기준 모듈 미존재. 전역 기준으로 재시도:",{targetModuleId:ua,zone:En,category:fe.moduleData.category,isUpperOrLower:Qu,moduleBaseType:Ga}),kn=Zi(ua,x,n),console.log("🔴 전역 기준 재시도 결과:",{moduleFound:!!kn,moduleCategory:kn==null?void 0:kn.category,moduleId:kn==null?void 0:kn.id})),!kn){console.error("🔴🔴🔴 [CRITICAL] 모듈을 찾을 수 없음. 기본 타입으로 생성 시도:",{targetModuleId:ua,moduleBaseType:Ga,원래_드래그모듈:xo,문제:"드래그 데이터는 옛날 공간 설정 기준이므로 사용 금지"});let Kt;if(fe.moduleData.category==="upper"?Kt=`upper-cabinet-shelf-${Xa}`:fe.moduleData.category==="lower"?Kt=`lower-cabinet-basic-${Xa}`:Kt=jr?`dual-open-${Xa}`:`single-open-${Xa}`,console.log("🔧 Fallback 모듈 ID 생성:",{originalCategory:fe.moduleData.category,fallbackModuleId:Kt,targetWidth:Xa}),kn=Zi(Kt,mr,Dr),!kn)return console.error("❌ 기본 타입 모듈도 생성 실패. 배치 취소"),!1}if(console.log("📦 최종 모듈 데이터:",{moduleId:kn==null?void 0:kn.id,moduleCategory:kn==null?void 0:kn.category,moduleName:kn==null?void 0:kn.name,moduleHeight:(xe=kn==null?void 0:kn.dimensions)==null?void 0:xe.height,isDragDataUsed:kn===fe.moduleData,dragDataCategory:(at=fe.moduleData)==null?void 0:at.category,originalDragModuleId:(dt=fe.moduleData)==null?void 0:dt.id,isUpperCabinet:(kn==null?void 0:kn.category)==="upper",isLowerCabinet:(kn==null?void 0:kn.category)==="lower",targetModuleId:qc,moduleBaseType:Ga}),!kn)return console.error("❌ 모듈 데이터가 없습니다!"),!1;if(kn.category||console.error("❌ 모듈에 카테고리 정보가 없습니다!",{moduleId:kn.id,moduleData:kn}),jr&&an+1>=Ml.columnCount){console.log("🚫 듀얼 가구가 영역 경계를 넘어감:",{zone:En,zoneSlotIndex:an,targetZoneColumnCount:Ml.columnCount,필요한슬롯:[an,an+1],영역범위:`0 ~ ${Ml.columnCount-1}`}),console.log("🔁 듀얼 → 싱글 자동 전환 (경계)");const Kt=((Qt=Tt.slotWidths)==null?void 0:Qt[an])||Tt.columnWidth,Cn=`${Ga}-${Kt}`,On=Zi(Cn,mr,Dr)||Zi(Cn,x,n);if(!On)return console.error("❌ 싱글 전환도 실패. 배치 취소"),!1;kn=On,jr=!1}const mh=(wn=n.droppedCeiling)!=null&&wn.enabled?Q.filter(Kt=>{var On;let Cn=Kt.zone;if(!Cn&&Kt.slotIndex!==void 0)if(((On=n.droppedCeiling)==null?void 0:On.position)==="left")Kt.slotIndex<M.dropped.columnCount?Cn="dropped":Cn="normal";else{const ir=M.normal.columnCount;Kt.slotIndex<ir?Cn="normal":Cn="dropped"}return Cn=Cn||"normal",Cn===En}):Q;console.log("📊 현재 슬롯 점유 상태:",{zone:En,zoneSlotIndex:an,isDual:jr,targetModuleId:qc,surroundType:X.surroundType,droppedCeilingEnabled:(gt=X.droppedCeiling)==null?void 0:gt.enabled,targetZoneInfo:as?{columnCount:as.columnCount,startX:as.startX,width:as.width}:null,existingModules:mh.map(Kt=>({id:Kt.id,moduleId:Kt.moduleId,slotIndex:Kt.slotIndex,isDualSlot:Kt.isDualSlot,zone:Kt.zone,occupiedSlots:Kt.isDualSlot?[Kt.slotIndex,Kt.slotIndex+1]:[Kt.slotIndex]}))});let Md=mh.some(Kt=>{var On,ir;let Cn=Kt.slotIndex;if((On=n.droppedCeiling)!=null&&On.enabled&&(((ir=n.droppedCeiling)==null?void 0:ir.position)==="left"?En==="dropped"?Cn=Kt.slotIndex:Cn=Kt.slotIndex-M.dropped.columnCount:En==="normal"?Cn=Kt.slotIndex:Cn=Kt.slotIndex-M.normal.columnCount),jr){let Ui=!1;if(Kt.isDualSlot){const fo=an,Go=an+1,Ya=Cn,Sa=Cn+1;Ui=!(Go<Ya||fo>Sa)}else Ui=Cn===an||Cn===an+1;return Ui&&console.log("🚫 듀얼 가구 슬롯 충돌:",{배치하려는가구:{slotIndex:an,isDual:!0,occupiedSlots:[an,an+1],moduleId:qc},기존가구:{id:Kt.id,moduleId:Kt.moduleId,slotIndex:Kt.slotIndex,zoneSlotIndex:Cn,isDualSlot:Kt.isDualSlot,occupiedSlots:Kt.isDualSlot?[Cn,Cn+1]:[Cn]},충돌조건:{newStart,newEnd,existingStart,existingEnd,겹침여부:!(newEnd<existingStart||newStart>existingEnd)}}),Ui}else{const Ui=Cn===an||Kt.isDualSlot&&(Cn===an||Cn+1===an);return Ui&&console.log("🚫 싱글 가구 슬롯 충돌:",{배치하려는가구:{slotIndex:an,isDual:!1,occupiedSlots:[an],moduleId:qc},기존가구:{id:Kt.id,moduleId:Kt.moduleId,slotIndex:Kt.slotIndex,zoneSlotIndex:Cn,isDualSlot:Kt.isDualSlot,occupiedSlots:Kt.isDualSlot?[Cn,Cn+1]:[Cn]},충돌조건:{싱글위치:an,기존위치:Kt.slotIndex,기존이듀얼:Kt.isDualSlot,충돌검사:`${an} == ${Cn} OR (듀얼 && (${Cn} == ${an} OR ${Cn+1} == ${an}))`}}),Ui}});if(Md)if(console.log("🚨 슬롯 충돌 감지됨! 단내림 구간 디버깅:",{zone:En,droppedCeilingEnabled:(Vn=n.droppedCeiling)==null?void 0:Vn.enabled,zoneSlotIndex:an,zoneExistingModules:mh.map(Kt=>({id:Kt.id,moduleId:Kt.moduleId,slotIndex:Kt.slotIndex,zone:Kt.zone||"normal"})),targetModuleZone:En,충돌원인:"같은 zone의 같은 슬롯에 이미 가구가 있음"}),jr){console.log("🔁 듀얼 충돌 → 싱글로 재시도");const Kt=((Yn=Tt.slotWidths)==null?void 0:Yn[an])||Tt.columnWidth,Cn=`${Ga}-${Kt}`;if(kn=Zi(Cn,mr,Dr)||Zi(Cn,x,n)||fe.moduleData,jr=!1,Md=mh.some(On=>On.slotIndex===an||On.isDualSlot&&(On.slotIndex===an||On.slotIndex+1===an)),Md)return console.log("❌ 싱글 전환 후에도 충돌. 배치 불가",{zone:En,zoneSlotIndex:an,existingModulesInSlot:mh.filter(On=>On.slotIndex===an)}),!1}else return console.log("❌ 슬롯 충돌로 배치 불가",{zone:En,zoneSlotIndex:an,existingModulesInSlot:mh.filter(Kt=>Kt.slotIndex===an)}),!1;let Eo;const ls=pr(X);if(console.log("🚨🚨 fullIndexing.zones 확인:",{hasZones:!!ls.zones,hasNormal:!!((ht=ls.zones)!=null&&ht.normal),hasDropped:!!((Ot=ls.zones)!=null&&Ot.dropped),normalInfo:(In=ls.zones)!=null&&In.normal?{startX:ls.zones.normal.startX,width:ls.zones.normal.width,columnCount:ls.zones.normal.columnCount,threeUnitPositions:ls.zones.normal.threeUnitPositions,threeUnitDualPositions:ls.zones.normal.threeUnitDualPositions}:null,droppedInfo:(Wn=ls.zones)!=null&&Wn.dropped?{startX:ls.zones.dropped.startX,width:ls.zones.dropped.width,columnCount:ls.zones.dropped.columnCount,threeUnitPositions:ls.zones.dropped.threeUnitPositions,threeUnitDualPositions:ls.zones.dropped.threeUnitDualPositions}:null,zoneToUse:En,zoneSlotIndex:an,isDual:jr,spaceInfo:{surroundType:X.surroundType,installType:X.installType,droppedCeiling:X.droppedCeiling}}),En||((xn=X.droppedCeiling)!=null&&xn.enabled?xs?(En=xs,console.log("✅ Zone auto-detected from collider (late detection):",En)):(En="normal",console.log("✅ Zone set to default (normal) for dropped ceiling case")):(En="normal",console.log("✅ No dropped ceiling, zone set to normal"))),console.log("🎯 FINAL zoneToUse before conditions:",{zoneToUse:En,hasDroppedCeiling:(Gn=X.droppedCeiling)==null?void 0:Gn.enabled,fullIndexingZones:ls!=null&&ls.zones?Object.keys(ls.zones):null}),En==="dropped"&&((fi=ls.zones)!=null&&fi.dropped)){const Kt=ls.zones.dropped.threeUnitPositions;if(!Kt||Kt.length===0){console.log("⚠️ zones.dropped.threeUnitPositions가 없습니다. 직접 계산합니다.");const Cn=M.dropped.startX,On=[];let ir=Cn;for(let Ui=0;Ui<M.dropped.columnCount;Ui++){const fo=((Ki=M.dropped.slotWidths)==null?void 0:Ki[Ui])||M.dropped.columnWidth,Go=ir+fo/2;On.push(C(Go)),ir+=fo}if(console.log("📍 직접 계산한 dropped positions:",{startX:Cn,positions:On,columnCount:M.dropped.columnCount}),jr&&an<On.length-1){const Ui=On[an],fo=On[an+1];Eo=(Ui+fo)/2}else Eo=On[an]||0}else if(jr&&an<Kt.length-1)if(ls.zones.dropped.threeUnitDualPositions&&ls.zones.dropped.threeUnitDualPositions[an]!==void 0)Eo=ls.zones.dropped.threeUnitDualPositions[an];else{const Cn=Kt[an],On=Kt[an+1];Eo=(Cn+On)/2}else Eo=Kt[an];console.log("🎯 단내림 영역 위치 계산:",{zoneSlotIndex:an,isDual:jr,droppedPositions:Kt,dualPositions:ls.zones.dropped.threeUnitDualPositions,selectedDualPosition:jr?(Ji=ls.zones.dropped.threeUnitDualPositions)==null?void 0:Ji[an]:null,finalX:Eo,gapConfig:n.gapConfig,zoneInfo:{columnCount:ls.zones.dropped.columnCount,startX:ls.zones.dropped.internalStartX}})}else if((Ci=ls.zones)!=null&&Ci.normal){const Kt=ls.zones.normal.threeUnitPositions;if(!Kt||Kt.length===0){console.error("⚠️ zones.normal.threeUnitPositions가 없습니다. 직접 계산합니다.");const Cn=M.normal.startX,On=[];let ir=Cn;for(let Ui=0;Ui<M.normal.columnCount;Ui++){const fo=((Qi=M.normal.slotWidths)==null?void 0:Qi[Ui])||M.normal.columnWidth,Go=ir+fo/2;On.push(C(Go)),ir+=fo}if(console.log("📍 직접 계산한 normal positions:",{startX:Cn,startX_three:C(Cn),positions:On,columnCount:M.normal.columnCount,surroundType:n.surroundType,installType:n.installType}),jr&&an<On.length-1){const Ui=On[an],fo=On[an+1];Eo=(Ui+fo)/2}else Eo=On[an]||0}else if(jr&&an<Kt.length-1)if(ls.zones.normal.threeUnitDualPositions&&ls.zones.normal.threeUnitDualPositions[an]!==void 0)Eo=ls.zones.normal.threeUnitDualPositions[an];else{const Cn=Kt[an],On=Kt[an+1];Eo=(Cn+On)/2}else Eo=Kt[an];console.log("🎯 메인 영역 위치 계산:",{zoneSlotIndex:an,isDual:jr,normalPositions:Kt,dualPositions:ls.zones.normal.threeUnitDualPositions,selectedDualPosition:jr?(zi=ls.zones.normal.threeUnitDualPositions)==null?void 0:zi[an]:null,finalX:Eo,gapConfig:n.gapConfig,zoneInfo:{columnCount:ls.zones.normal.columnCount,startX:ls.zones.normal.internalStartX}})}else{console.warn("⚠️ fullIndexing.zones가 없습니다. zoneInfo에서 직접 계산합니다.");const Kt=En==="dropped"?M.dropped:M.normal,Cn=Kt.startX,On=[];let ir=Cn;for(let Ui=0;Ui<Kt.columnCount;Ui++){const fo=((Ir=Kt.slotWidths)==null?void 0:Ir[Ui])||Kt.columnWidth,Go=ir+fo/2;On.push(C(Go)),ir+=fo}if(console.log("📍 fallback - 직접 계산한 positions:",{zone:En,startX:Cn,positions:On,columnCount:Kt.columnCount}),jr&&an<On.length-1)if(S.threeUnitDualPositions&&S.threeUnitDualPositions[an]!==void 0)Eo=S.threeUnitDualPositions[an];else{const Ui=On[an],fo=On[an+1];Eo=(Ui+fo)/2}else Eo=On[an]}const sg=En==="dropped"?`dropped-${Date.now()}-${Math.random().toString(36).substr(2,9)}`:`placed-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,V1=(kn==null?void 0:kn.defaultDepth)||Math.min(Math.floor(n.depth*.9),580),Rd=Tt.slotWidths&&Tt.slotWidths[an]!==void 0?Tt.slotWidths[an]:Tt.columnWidth,kA=Ih(n);let Rl=an;(Hr=n.droppedCeiling)!=null&&Hr.enabled&&((Si=n.droppedCeiling)!=null&&Si.position)&&(n.droppedCeiling.position==="right"&&En==="dropped"?Rl=an+M.normal.columnCount:n.droppedCeiling.position==="left"&&En==="normal"&&(Rl=an+M.dropped.columnCount));const bs=kA[Rl];console.log("🏛️ 기둥 분석 및 슬롯 인덱스 변환:",{zoneToUse:En,zoneSlotIndex:an,globalSlotIndex:Rl,droppedCeilingPosition:(re=n.droppedCeiling)==null?void 0:re.position,normalColumnCount:M.normal.columnCount,droppedColumnCount:M.dropped.columnCount,zoneSlotIndex:an,slotIndex:ur,globalSlotIndex:Rl,columnSlotsLength:kA.length,slotInfo:bs?{hasColumn:bs.hasColumn,availableWidth:bs.availableWidth,adjustedWidth:bs.adjustedWidth}:null});let qs,$u,Tl=Eo,F0,rc=!1,Rh,Uh=0;if(jr){const Kt=kA[Rl],Cn=kA[Rl+1];if(console.log("🏛️ 듀얼 가구 슬롯 기둥 확인:",{slot1:{index:Rl,hasColumn:(Kt==null?void 0:Kt.hasColumn)||!1,columnType:Kt==null?void 0:Kt.columnType,availableWidth:(Kt==null?void 0:Kt.availableWidth)||as.columnWidth},slot2:{index:Rl+1,hasColumn:(Cn==null?void 0:Cn.hasColumn)||!1,columnType:Cn==null?void 0:Cn.columnType,availableWidth:(Cn==null?void 0:Cn.availableWidth)||as.columnWidth}}),Kt!=null&&Kt.hasColumn||Cn!=null&&Cn.hasColumn){rc=!0;const On=En==="dropped"?M.dropped:M.normal,ir=Kt!=null&&Kt.hasColumn?Kt.availableWidth:On.columnWidth,Ui=Cn!=null&&Cn.hasColumn?Cn.availableWidth:On.columnWidth;Uh=ir+Ui,Kt!=null&&Kt.hasColumn&&Kt.columnType!=="medium"?Rh=Kt.columnType:Cn!=null&&Cn.hasColumn&&Cn.columnType!=="medium"?Rh=Cn.columnType:Rh="medium",console.log("🏛️ 듀얼 가구 기둥 처리:",{totalAvailableWidth:Uh,originalWidth:kn.dimensions.width,columnType:Rh,willAdjust:Rh!=="medium"})}}if(bs&&bs.hasColumn||rc){if(jr){if(Uh<300)return console.log("🚫 듀얼 가구 배치 불가:",{이유:"기둥 침범으로 인한 공간 부족",totalAvailableWidth:Uh,최소필요너비:300}),!1}else if(console.log("🏛️ 싱글 가구 - 기둥 침범 슬롯 감지:",{slotIndex:ur,hasColumn:!0,availableWidth:bs.availableWidth,adjustedWidth:bs.adjustedWidth,intrusionDirection:bs.intrusionDirection,furniturePosition:bs.furniturePosition,columnType:bs.columnType}),!Koe(bs,kn.dimensions.width,jr))return console.log("🚫 기둥 침범으로 인해 배치 불가:",{이유:"공간 부족"}),!1;if(F0=jr?Rh:bs.columnType,jr)qs=Uh,$u=Uh,console.log("🔧 듀얼 가구 - 기둥 A 침범으로 폭 즉시 조정:",{원래폭:kn.dimensions.width,조정된폭:qs,columnType:F0});else{const Cn=(En==="dropped"?M.dropped:M.normal).columnWidth*.01,On={left:Eo-Cn/2,right:Eo+Cn/2,center:Eo},ir=Ad(bs,On,n);qs=ir.renderWidth,$u=ir.renderWidth,Tl=ir.center,console.log("🔧 싱글 가구 - 기둥 A 침범으로 폭 즉시 조정:",{원래폭:Rd,조정된폭:qs,위치조정:{원래X:Eo,조정된X:Tl},columnType:bs.columnType})}}else{if(X.surroundType==="no-surround")qs=void 0,console.log("🔧 [노서라운드] customWidth 설정 안함 (기둥 없음):",{surroundType:X.surroundType,isDual:jr,zoneSlotIndex:an,moduleId:kn.id,moduleWidth:kn.dimensions.width,reason:"노서라운드에서는 원본 모듈 크기 사용"});else if(!((be=n.droppedCeiling)!=null&&be.enabled))jr&&Tt.slotWidths&&Tt.slotWidths[an]!==void 0?qs=Tt.slotWidths[an]+(Tt.slotWidths[an+1]||Tt.slotWidths[an]):Tt.slotWidths&&Tt.slotWidths[an]!==void 0?qs=Tt.slotWidths[an]:qs=Rd,console.log("🔧 [서라운드] customWidth 계산 (단내림 없음):",{surroundType:X.surroundType,isDual:jr,zoneSlotIndex:an,slotWidths:Tt.slotWidths,customWidth:qs,actualSlotWidth:Rd});else{if(jr&&Tt.slotWidths&&Tt.slotWidths[an]!==void 0){const Kt=Tt.slotWidths[an],Cn=Tt.slotWidths[an+1]||Kt;qs=Kt+Cn}else Tt.slotWidths&&Tt.slotWidths[an]!==void 0?qs=Tt.slotWidths[an]:qs=Rd;console.log("🔧 [단내림] customWidth 계산:",{zone:En,surroundType:n.surroundType,isDual:jr,zoneSlotIndex:an,slotWidths:Tt.slotWidths,customWidth:qs,actualSlotWidth:Rd}),X.surroundType==="no-surround"&&(qs=void 0,console.log("🔧 [노서라운드] customWidth 설정 안함:",{surroundType:n.surroundType,isDual:jr,zoneSlotIndex:an,moduleId:kn.id,reason:"노서라운드에서는 원본 모듈 사용"}))}$u=void 0}console.log("🎯 가구 배치 정보:",{zone:En,슬롯인덱스:an,슬롯너비:Rd,모듈너비:kn.dimensions.width,customWidth:qs,adjustedWidth:$u,차이:Math.abs(kn.dimensions.width-qs),위치X:Tl,위치X_mm:Tl*100,기둥침범:(bs==null?void 0:bs.hasColumn)||!1,마지막슬롯여부:an===as.columnCount-1,영역시작X_mm:as.startX,영역끝X_mm:as.startX+as.width,가구왼쪽끝_mm:Tl*100-qs/2,가구오른쪽끝_mm:Tl*100+qs/2,slotWidths:Tt.slotWidths,zoneInfo:{normal:M.normal,dropped:M.dropped}});const og=fe.moduleData.id.replace(/-\d+$/,""),qc=n.surroundType==="no-surround"?kn.id:`${og}-${qs}`;console.log("🎯 모듈 ID 생성:",{surroundType:n.surroundType,originalDragId:fe.moduleData.id,foundModuleId:kn.id,baseType:og,customWidth:qs,targetModuleId:qc,isDual:jr,slotIndex:an,occupiedSlots:jr?[an,an+1]:[an]});const k0=bs&&bs.hasColumn?kz(bs):"right",yh=V1,da=(Ue=fe.moduleData)==null?void 0:Ue.category,Bc=(kn==null?void 0:kn.category)==="upper"||da==="upper",Nf=(kn==null?void 0:kn.category)==="lower"||da==="lower",ag=(kn==null?void 0:kn.category)==="full"||da==="full";console.log("🔴🔴🔴 [Y Position Calculation] Category Check:",{moduleId:kn==null?void 0:kn.id,category:kn==null?void 0:kn.category,dragCategory:da,isUpperCabinetZone:Bc,isLowerCabinetZone:Nf,isFullCabinetZone:ag,moduleHeight:(ut=kn==null?void 0:kn.dimensions)==null?void 0:ut.height});let Aa=0;if(ag){let Cn=n.hasFloorFinish&&n.floorFinish?n.floorFinish.height:0;((yt=n.baseConfig)==null?void 0:yt.type)==="floor"?Cn+=((en=n.baseConfig)==null?void 0:en.height)||65:((cn=n.baseConfig)==null?void 0:cn.placementType)==="float"&&(Cn+=((Tn=n.baseConfig)==null?void 0:Tn.floatHeight)||0);let On=(($n=kn==null?void 0:kn.dimensions)==null?void 0:$n.height)||2200;if(En==="dropped"&&((ai=n.droppedCeiling)!=null&&ai.enabled)){const ir=((ni=n.droppedCeiling)==null?void 0:ni.dropHeight)||200,Ui=n.height-ir;On=Math.min(On,Ui-Cn)}Aa=(Cn+On/2)/100,console.log("🏢 키큰장 초기 배치 Y 위치 계산:",{zone:En,baseFrameHeightMm:Cn,furnitureHeightMm:On,furnitureYZone:Aa,placementType:(Rn=n.baseConfig)==null?void 0:Rn.placementType,isDroppedZone:En==="dropped",설명:En==="dropped"?"단내림 구간 - 높이 조정됨":"키큰장은 바닥부터 시작"})}else if(Bc){(En==="dropped"&&Kn?Kn:x).height;const Cn=((sr=kn==null?void 0:kn.dimensions)==null?void 0:sr.height)||600,On=10,ir=10;let Ui;if(En==="dropped"&&((dr=n.droppedCeiling)!=null&&dr.enabled)){const fo=((qr=n.droppedCeiling)==null?void 0:qr.dropHeight)||200;Ui=n.height-fo}else Ui=n.height;n.surroundType!=="no-surround"?Ui=Ui-On-ir:Ui=Ui-ir,Aa=(Ui-Cn/2)/100,console.log("🔝 상부장 초기 배치 Y 위치 계산:",{zone:En,isDroppedZone:En==="dropped",droppedCeilingEnabled:(vs=n.droppedCeiling)==null?void 0:vs.enabled,dropHeight:((Cr=n.droppedCeiling)==null?void 0:Cr.dropHeight)||0,originalHeight:n.height,totalHeightMm:Ui,furnitureHeightMm:Cn,furnitureYZone:Aa,furnitureYZone_mm:Aa*100,계산과정:{"1_원래높이":n.height,"2_단내림높이차감":En==="dropped"&&((cs=n.droppedCeiling)==null?void 0:cs.dropHeight)||0,"3_최종높이":Ui,"4_가구높이절반":Cn/2,"5_최종Y위치_mm":Ui-Cn/2,"6_최종Y위치_m":Aa},설명:En==="dropped"?"단내림 구간 - 낮아진 천장 기준":"일반 구간 - 원래 천장 기준"})}else if(Nf){let Cn=n.hasFloorFinish&&n.floorFinish?n.floorFinish.height:0;((Qr=n.baseConfig)==null?void 0:Qr.type)==="floor"?Cn+=((or=n.baseConfig)==null?void 0:or.height)||65:((hs=n.baseConfig)==null?void 0:hs.placementType)==="float"&&(Cn+=((us=n.baseConfig)==null?void 0:us.floatHeight)||0);const On=((Oo=kn==null?void 0:kn.dimensions)==null?void 0:Oo.height)||1e3;Aa=(Cn+On/2)/100}else{console.log("⚠️ 기본 가구 Y 위치 계산 (카테고리 없음):",{moduleCategory:kn==null?void 0:kn.category,moduleId:kn==null?void 0:kn.id});let Cn=n.hasFloorFinish&&n.floorFinish?n.floorFinish.height:0;((va=n.baseConfig)==null?void 0:va.type)==="floor"?Cn+=((Lh=n.baseConfig)==null?void 0:Lh.height)||65:((xa=n.baseConfig)==null?void 0:xa.placementType)==="float"&&(Cn+=((N=n.baseConfig)==null?void 0:N.floatHeight)||0);const On=((ce=kn==null?void 0:kn.dimensions)==null?void 0:ce.height)||600;Aa=(Cn+On/2)/100}console.log("🔴🔴🔴 [CRITICAL] Final furniture position:",{moduleId:qc,furnitureX:Tl,furnitureX_mm:Tl*100,furnitureYZone:Aa,furnitureYZone_mm:Aa*100,zone:En,slotIndex:an,surroundType:n.surroundType,frameSize:n.frameSize,zoneStartX:En==="dropped"?(we=M.dropped)==null?void 0:we.startX:(Pe=M.normal)==null?void 0:Pe.startX,moduleCategory:kn==null?void 0:kn.category,dragCategory:(Nt=fe.moduleData)==null?void 0:Nt.category,isUpperCabinet:(kn==null?void 0:kn.category)==="upper"||((tn=fe.moduleData)==null?void 0:tn.category)==="upper",willBeAddedToStore:!0});const Zr={id:sg,moduleId:qc,position:{x:Tl,y:Aa,z:0},rotation:0,hasDoor:!1,customDepth:yh,slotIndex:Rl,isDualSlot:jr,isValidInCurrentSpace:!0,adjustedWidth:bs!=null&&bs.hasColumn||rc?$u:void 0,hingePosition:k0,zone:En,customWidth:(Un=n.droppedCeiling)!=null&&Un.enabled&&n.surroundType==="no-surround"?void 0:qs,customHeight:En==="dropped"&&Kn?Kn.height:void 0};if(bs&&bs.hasColumn&&(Zr.columnSlotInfo={hasColumn:!0,columnId:(is=bs.column)==null?void 0:is.id,columnPosition:bs.columnPosition,availableWidth:bs.availableWidth,adjustedWidth:bs.adjustedWidth,intrusionDirection:bs.intrusionDirection,furniturePosition:bs.furniturePosition},console.log("🔧 기둥 침범 가구 최종 설정:",{moduleId:Zr.moduleId,adjustedWidth:Zr.adjustedWidth,customWidth:Zr.customWidth,columnSlotInfo:Zr.columnSlotInfo})),n.surroundType==="no-surround"&&jr){console.log("🔍 노서라운드 듀얼 가구 배치 체크:",{isDualFurniture:jr,moduleId:qc,globalSlotIndex:Rl,zoneSlotIndex:an,columnCount:S.columnCount});const Kt=Rl===0,Cn=Rl>=S.columnCount-2,On=Kt&&(n.installType==="freestanding"||n.installType==="semistanding"&&((ro=n.wallConfig)==null?void 0:ro.right)),ir=Cn&&(n.installType==="freestanding"||n.installType==="semistanding"&&(($r=n.wallConfig)==null?void 0:$r.left));console.log("🔍 엔드패널 체크:",{hasLeftEndPanel:On,hasRightEndPanel:ir,isFirstSlot:Kt,isLastSlot:Cn,installType:n.installType,wallConfig:n.wallConfig}),(On||ir)&&console.log("✅ 엔드패널 구간 듀얼 가구 배치 허용")}console.log("✅ 가구 배치 완료:",{zone:En,moduleId:qc,slotIndex:an,isDualSlot:jr,isDualFromModuleId:qc.startsWith("dual-"),occupiedSlots:jr?[an,an+1]:[an],position:{x:Tl},position_mm:{x:Tl*100},finalX:Eo,finalX_mm:Eo*100,customWidth:qs,zoneInfo:En==="dropped"?M.dropped:M.normal,newModule:{id:Zr.id,moduleId:Zr.moduleId,isDualSlot:Zr.isDualSlot,slotIndex:Zr.slotIndex,position:Zr.position,zone:Zr.zone}}),console.log("🚨🚨 최종 newModule 상세:",{...Zr,position_mm:{x:Zr.position.x*100,y:Zr.position.y*100,z:Zr.position.z*100}}),console.log("🔴🔴🔴 상부장 추가 직전:",{isUpperCabinet:Zr.category==="upper",moduleCategory:Zr.category,moduleId:Zr.moduleId,position:Zr.position,dimensions:Zr.dimensions}),console.log("🚀 [BEFORE addModule] 상부장 추가 직전:",{moduleId:Zr.moduleId,category:kn==null?void 0:kn.category,dragCategory:(rs=fe.moduleData)==null?void 0:rs.category,position:Zr.position,slotIndex:Zr.slotIndex,zone:Zr.zone});const I0=s(Zr);return console.log("✅ [AFTER addModule] 가구 배치 결과:",{success:I0,moduleId:Zr.moduleId,position:Zr.position,wasUpperCabinet:(kn==null?void 0:kn.category)==="upper"||((Bs=fe.moduleData)==null?void 0:Bs.category)==="upper"}),a&&l(null),setTimeout(()=>{ZS(Q,X)},100),window.dispatchEvent(new CustomEvent("furniture-placement-complete")),!0}else if(Ce==="normal"&&((_l=fullIndexing.zones)!=null&&_l.normal)){const Tt=fullIndexing.zones.normal.threeUnitPositions;if(!Tt||Tt.length===0)return console.log("⚠️ zones.normal.threeUnitPositions가 없습니다. 직접 계산합니다."),!1;let Kn;if(Ae&&zoneSlotIndex<Tt.length-1){const Tc=Tt[zoneSlotIndex],Ml=Tt[zoneSlotIndex+1];Kn=(Tc+Ml)/2}else Kn=Tt[zoneSlotIndex];const os=Kn;let En=0;const ur=(ue==null?void 0:ue.category)||((Bo=fe.moduleData)==null?void 0:Bo.category),xs=ur==="upper",an=ur==="lower";if(xs){let Dr=n.height;n.surroundType!=="no-surround"?Dr=Dr-10-10:Dr=Dr-10;const mr=((Ao=ue==null?void 0:ue.dimensions)==null?void 0:Ao.height)||600;En=(Dr-mr/2)/100}else if(an){const Tc=((Ha=n.baseConfig)==null?void 0:Ha.height)||0,Ml=n.hasFloorFinish&&n.floorFinish?n.floorFinish.height:0,Dr=Tc+Ml,mr=((Wa=ue==null?void 0:ue.dimensions)==null?void 0:Wa.height)||600;En=(Dr+mr/2)/100}else En=C(recalculatedZoneInternalSpace.height/2);const ha={id:`module-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,moduleId:_e,position:{x:os,y:En,z:0},rotation:{x:0,y:0,z:0},scale:{x:1,y:1,z:1},slotIndex:zoneSlotIndex,isDualSlot:Ae,zone:"normal",columnSlotInfo:{slotIndex:zoneSlotIndex,columnCount:fullIndexing.zones.normal.columnCount,columnWidth:fullIndexing.zones.normal.columnWidth,isDual:Ae,spaceType:"main",totalWidth:X.width,actualWidth:((dl=ue==null?void 0:ue.dimensions)==null?void 0:dl.width)||((ba=(za=fe.moduleData)==null?void 0:za.dimensions)==null?void 0:ba.width)},hasDoor:!1};return console.log("✅ 메인 영역에 가구 배치:",ha),s(ha),a&&l(null),setTimeout(()=>{ZS(Q,X)},100),window.dispatchEvent(new CustomEvent("furniture-placement-complete")),!0}else if(console.log("🚨🚨🚨 else 블록 진입! zone 미결정 케이스:",{droppedCeilingEnabled:(Xc=n.droppedCeiling)==null?void 0:Xc.enabled,zoneToUse:Ce,spaceInfo:X.droppedCeiling}),(Ou=X.droppedCeiling)!=null&&Ou.enabled){if(console.log("✅ 단내림 활성화 확인, zone 자동 결정 시도"),Ce="normal",!u){console.warn("Camera not available for raycasting in handle drag");return}new YA().setFromCamera(new sd(q,de),u);let Kn=Z;Kn==null&&(Kn=e2($.clientX,$.clientY,U,u,d)),console.log("🎯 감지된 슬롯 인덱스:",Kn);const os=ar.calculateZoneSlotInfo(X,X.customColumnCount);os&&Kn!==null&&(X.droppedCeiling.position==="left"?Kn<os.dropped.columnCount?Ce="dropped":Ce="normal":Kn<os.normal.columnCount?Ce="normal":Ce="dropped",console.log("🎯 Zone 자동 결정 완료:",{zoneToUse:Ce,slotIndex:Kn,droppedPosition:X.droppedCeiling.position,normalCount:os.normal.columnCount,droppedCount:os.dropped.columnCount})),Ce||(console.log("⚠️ Zone을 결정할 수 없음, 기본값 normal 사용"),Ce="normal"),console.log("✅ 최종 zone 결정:",Ce);const ur=(Qa=(d?d.children.filter(Dr=>{var mr;return((mr=Dr.userData)==null?void 0:mr.isSlotCollider)&&Dr.visible}).sort((Dr,mr)=>{var Ps,xo;return(((Ps=Dr.userData)==null?void 0:Ps.slotIndex)||0)-(((xo=mr.userData)==null?void 0:xo.slotIndex)||0)}):[]).find(Dr=>{var mr,Ps;return((mr=Dr.userData)==null?void 0:mr.slotIndex)===Z&&((Ps=Dr.userData)==null?void 0:Ps.isSlotCollider)}))==null?void 0:Qa.userData,xs=(ue==null?void 0:ue.category)==="upper",an=(ue==null?void 0:ue.category)==="lower",as=(ue==null?void 0:ue.category)==="full";let ha=0;if(as){let mr=X.hasFloorFinish&&X.floorFinish?X.floorFinish.height:0;((Vs=X.baseConfig)==null?void 0:Vs.type)==="floor"?mr+=((Hu=X.baseConfig)==null?void 0:Hu.height)||65:((Cc=X.baseConfig)==null?void 0:Cc.placementType)==="float"&&(mr+=((Ll=X.baseConfig)==null?void 0:Ll.floatHeight)||0);const Ps=((su=ue==null?void 0:ue.dimensions)==null?void 0:su.height)||2200;ha=(mr+Ps/2)/100}else if(xs){const Dr=((gh=ue==null?void 0:ue.dimensions)==null?void 0:gh.height)||600,mr=10,Ps=10;let xo=X.height;console.log("🔴 상부장 Y 위치 계산:",{moduleCategory:ue==null?void 0:ue.category,moduleId:ue==null?void 0:ue.id,furnitureHeightMm:Dr,totalHeightMm:xo,surroundType:X.surroundType}),X.surroundType!=="no-surround"?xo=xo-mr-Ps:xo=xo-Ps,ha=(xo-Dr/2)/100,console.log("🔴 상부장 최종 Y 위치:",{totalHeightMm:xo,furnitureYClick:ha,furnitureYClickMm:ha*100})}else if(an){let mr=X.hasFloorFinish&&X.floorFinish?X.floorFinish.height:0;((Ca=X.baseConfig)==null?void 0:Ca.type)==="floor"?mr+=((Yc=X.baseConfig)==null?void 0:Yc.height)||65:((tc=X.baseConfig)==null?void 0:tc.placementType)==="float"&&(mr+=(($a=X.baseConfig)==null?void 0:$a.floatHeight)||0);const Ps=((_c=ue==null?void 0:ue.dimensions)==null?void 0:_c.height)||1e3;ha=(mr+Ps/2)/100}const Tc=(ur==null?void 0:ur.zone)||"normal",Ml={id:it,moduleId:ue.id,position:{x:Be,y:ha,z:0},rotation:0,slotIndex:Z,depth:De,isDualSlot:Ae,isValidInCurrentSpace:!0,adjustedWidth:ue.dimensions.width,hingePosition:"right",customWidth:(Kc=n.droppedCeiling)!=null&&Kc.enabled&&n.surroundType==="no-surround"?void 0:Me,zone:Tc};return s(Ml),a&&l(null),window.dispatchEvent(new CustomEvent("furniture-placement-complete")),!0}const Z=e2($.clientX,$.clientY,U,u,d,n);if(console.log("🎰 Slot index from raycast (non-dropped):",Z),Z===null)return console.log("❌ No slot index found (non-dropped)"),!1;const Ae=fe.moduleData.id.startsWith("dual-");if(console.log("📊 메인 구간 슬롯 점유 상태 (drop):",{zone:"main",targetSlot:Z,isDualDragging:Ae,targetSlots:Ae?[Z,Z+1]:[Z],existingModules:Q.filter(Tt=>!Tt.zone||Tt.zone==="normal").map(Tt=>({id:Tt.id,moduleId:Tt.moduleId,slotIndex:Tt.slotIndex,isDualSlot:Tt.isDualSlot,occupiedSlots:Tt.isDualSlot?[Tt.slotIndex,Tt.slotIndex+1]:[Tt.slotIndex]}))}),n.surroundType==="no-surround"&&Ae){const Tt=pr(n);console.log("🔍 노서라운드 듀얼 가구 배치 체크 (non-dropped):",{isDualFurniture:Ae,moduleId:fe.moduleData.id,slotIndex:Z,columnCount:Tt.columnCount});const Kn=Z===0,os=Z>=Tt.columnCount-2,En=Kn&&(n.installType==="freestanding"||n.installType==="semistanding"&&((Sl=n.wallConfig)==null?void 0:Sl.right)),ur=os&&(n.installType==="freestanding"||n.installType==="semistanding"&&((nc=n.wallConfig)==null?void 0:nc.left));console.log("🔍 엔드패널 체크 (non-dropped):",{hasLeftEndPanel:En,hasRightEndPanel:ur,isFirstSlot:Kn,isLastSlot:os,installType:n.installType,wallConfig:n.wallConfig}),(En||ur)&&console.log("✅ 엔드패널 구간 듀얼 가구 배치 허용 (non-dropped)")}if(console.log("🔍 SlotDropZonesSimple - 슬롯 가용성 검사 전:",{slotIndex:Z,isDual:Ae,moduleId:fe.moduleData.id,latestPlacedModulesCount:Q.length,latestPlacedModules:Q.map(Tt=>({id:Tt.id,moduleId:Tt.moduleId,slotIndex:Tt.slotIndex,position:Tt.position}))}),!dp(Z,Ae,Q,X,fe.moduleData.id))return console.log("❌ 메인 구간 슬롯 충돌로 배치 불가"),!1;let ie=n;n.mainDoorCount&&n.mainDoorCount>0?(ie={...n,mainDoorCount:n.mainDoorCount,columnMode:"custom",frameSize:n.surroundType==="no-surround"?{left:0,right:0,top:0}:n.frameSize},console.log("🎯 [SlotDropZones] 분할창 모듈 생성:",{mainDoorCount:n.mainDoorCount,customColumnCount:n.customColumnCount,internalWidth:x.width,adjustedSpaceInfo:ie})):ie={...n,frameSize:n.surroundType==="no-surround"?{left:0,right:0,top:0}:n.frameSize};const ee=pr(ie),ae=ee.slotWidths&&ee.slotWidths[Z]!==void 0?ee.slotWidths[Z]:ee.columnWidth,me=fe.moduleData.id.replace(/-\d+$/,"");let _e;(Ar=n.droppedCeiling)!=null&&Ar.enabled?n.surroundType==="no-surround"?(_e=fe.moduleData.id,console.log("🔧 [노서라운드] 원본 모듈 ID 사용 (단내림 있음):",_e)):(_e=`${me}-${ae}`,console.log("🔧 [서라운드] 슬롯 너비 기반 ID 생성 (단내림 있음):",_e)):(_e=`${me}-${ae}`,console.log("🔧 [8월28일 로직] 슬롯 너비 기반 ID 생성 (단내림 없음):",_e)),console.log("🎯 [SlotDropZones] Non-dropped module lookup:",{originalId:fe.moduleData.id,baseType:me,targetWidth:ae,targetModuleId:_e,slotIndex:Z,slotWidths:ee.slotWidths});let ue=Zi(_e,x,ie);if(!ue)return console.error("❌ [SlotDropZones] Module not found:",_e),!1;let Be=Bj(Z,_e,n,Ce);if(Be===null)return!1;console.log("🚨🚨🚨 가구 배치 위치 계산 결과:",{가구타입:Ae?"듀얼":"싱글",슬롯인덱스:Z,계산된위치_X:Be,spaceInfo:{width:n.width,surroundType:n.surroundType,installType:n.installType,customColumnCount:n.customColumnCount,mainDoorCount:n.mainDoorCount,frameSize:n.frameSize,gapConfig:n.gapConfig},indexing:{columnCount:S.columnCount,columnWidth:S.columnWidth,slotWidths:S.slotWidths,threeUnitPositions:S.threeUnitPositions,threeUnitDualPositions:S.threeUnitDualPositions},targetModuleId:_e,내경너비:x.width}),Ae&&console.log("🎯 Dual furniture position debug:",{slotIndex:Z,columnCount:S.columnCount,threeUnitDualPositions:S.threeUnitDualPositions,finalX:Be,expectedPosition:(Os=S.threeUnitDualPositions)==null?void 0:Os[Z]});const it=`placed-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,De=(ue==null?void 0:ue.defaultDepth)||Math.min(Math.floor(n.depth*.9),580),qe=S,Je=qe.slotWidths&&qe.slotWidths[Z]!==void 0?qe.slotWidths[Z]:qe.columnWidth;let Me,et=_e;if(Ae&&qe.slotWidths&&qe.slotWidths[Z]!==void 0){const Tt=qe.slotWidths[Z],Kn=qe.slotWidths[Z+1]||Tt;Me=Tt+Kn,et=`${me}-${Me}`,console.log("🎯 [SlotDropZones] Dual furniture width calculation:",{slotIndex:Z,slot1Width:Tt,slot2Width:Kn,totalWidth:Me,dualTargetModuleId:et,originalTargetModuleId:_e})}else qe.slotWidths&&qe.slotWidths[Z]!==void 0?Me=qe.slotWidths[Z]:Me=Je;if(Ae&&et!==_e){const Tt=Zi(et,x,ie);if(Tt){if(ue=Tt,console.log("✅ [SlotDropZones] Found dual module with exact width:",et),Be=Bj(Z,et,n,Ce),Be===null)return console.error("❌ [SlotDropZones] Failed to calculate dual furniture position"),!1}else console.warn("⚠️ [SlotDropZones] Dual module not found with exact width, using single slot module:",et)}console.log("🎯 가구 배치 시 customWidth 설정:",{slotIndex:Z,isDual:Ae,targetIndexing:{columnWidth:qe.columnWidth,slotWidths:qe.slotWidths},actualSlotWidth:Je,customWidth:Me,moduleWidth:ue.dimensions.width,평균너비:qe.columnWidth,내경너비:x.width,슬롯수:qe.columnCount,finalModuleId:Ae?et:_e});const He=Ih(n);let ze=Me,Oe=Be,ke=ue.dimensions.width,je=null;if(Ae){const Tt=He[Z],Kn=He[Z+1];if(console.log("🏛️ 듀얼 가구 기둥 침범 확인:",{slot1:{index:Z,hasColumn:(Tt==null?void 0:Tt.hasColumn)||!1,columnType:Tt==null?void 0:Tt.columnType,availableWidth:Tt==null?void 0:Tt.availableWidth},slot2:{index:Z+1,hasColumn:(Kn==null?void 0:Kn.hasColumn)||!1,columnType:Kn==null?void 0:Kn.columnType,availableWidth:Kn==null?void 0:Kn.availableWidth}}),(Tt==null?void 0:Tt.hasColumn)||!1||(Kn==null?void 0:Kn.hasColumn)||!1)if((Tt==null?void 0:Tt.columnType)==="deep"||(Kn==null?void 0:Kn.columnType)==="deep"){const ur=(Tt==null?void 0:Tt.availableWidth)||qe.columnWidth,xs=(Kn==null?void 0:Kn.availableWidth)||qe.columnWidth,an=ur+xs;ze=an,ke=an,console.log("🔧 듀얼 가구 기둥 A 침범 - 폭 조정:",{원래폭:Me,조정된폭:ze,slot1Available:ur,slot2Available:xs,totalAvailable:an})}else console.log("🔧 듀얼 가구 기둥 C 선배치 - 원본 크기 유지")}else if(je=He[Z],je&&je.hasColumn){console.log("🏛️ 싱글 가구 - 기둥 침범 슬롯 감지:",{slotIndex:Z,hasColumn:!0,availableWidth:je.availableWidth,adjustedWidth:je.adjustedWidth,columnType:je.columnType,column:je.column,intrusionDirection:je.intrusionDirection,furniturePosition:je.furniturePosition});{const Tt=qe.columnWidth*.01,Kn={left:Be-Tt/2,right:Be+Tt/2,center:Be},os=Ad(je,Kn,n);ze=os.renderWidth,ke=os.renderWidth,Oe=os.center,console.log("🔧 기둥 A 침범 - 가구 폭 즉시 조정:",{원래폭:Me,조정된폭:ze,원래위치:Be,조정된위치:Oe,furnitureBounds:os})}}const rt=(ue==null?void 0:ue.category)==="upper",_t=(ue==null?void 0:ue.category)==="lower",Ee=(ue==null?void 0:ue.category)==="full";let Le=0;if(Ee){let Kn=n.hasFloorFinish&&n.floorFinish?n.floorFinish.height:0;((wo=n.baseConfig)==null?void 0:wo.type)==="floor"?Kn+=((vo=n.baseConfig)==null?void 0:vo.height)||65:((ic=n.baseConfig)==null?void 0:ic.placementType)==="float"&&(Kn+=((Mh=n.baseConfig)==null?void 0:Mh.floatHeight)||0);const os=((Va=ue==null?void 0:ue.dimensions)==null?void 0:Va.height)||2200;Le=(Kn+os/2)/100,console.log("🏢 키큰장 드래그 Y 위치 계산:",{category:ue.category,startHeightMm:Kn,furnitureHeightMm:os,furnitureY:Le,baseConfig:n.baseConfig,placementType:(Ks=n.baseConfig)==null?void 0:Ks.placementType,floatHeight:(Vo=n.baseConfig)==null?void 0:Vo.floatHeight,설명:"키큰장은 바닥/띄움 높이부터 시작"})}else if(rt){const Tt=x.height,Kn=((ra=ue==null?void 0:ue.dimensions)==null?void 0:ra.height)||600;Le=(Tt-Kn/2)/100,console.log("🔍 상부장 Y 위치 계산:",{category:ue.category,internalHeightMm:Tt,furnitureHeightMm:Kn,furnitureY:Le,설명:"상부장은 천장 고정 (받침대/띄워서 배치와 무관)"})}else if(_t){let Kn=n.hasFloorFinish&&n.floorFinish?n.floorFinish.height:0;((Ld=n.baseConfig)==null?void 0:Ld.type)==="floor"?Kn+=((Wu=n.baseConfig)==null?void 0:Wu.height)||65:((zu=n.baseConfig)==null?void 0:zu.placementType)==="float"&&(Kn+=((rg=n.baseConfig)==null?void 0:rg.floatHeight)||0);const os=((_a=ue==null?void 0:ue.dimensions)==null?void 0:_a.height)||1e3;Le=(Kn+os/2)/100,console.log("🔍 하부장 Y 위치 계산:",{category:ue.category,startHeightMm:Kn,furnitureHeightMm:os,furnitureY:Le,baseConfig:n.baseConfig,placementType:(TA=n.baseConfig)==null?void 0:TA.placementType,floatHeight:(BA=n.baseConfig)==null?void 0:BA.floatHeight})}const ye={id:it,moduleId:Ae?et:_e,position:{x:Oe,y:Le,z:0},rotation:0,hasDoor:!1,customDepth:De,slotIndex:Z,isDualSlot:Ae,isValidInCurrentSpace:!0,adjustedWidth:je!=null&&je.hasColumn?ke:void 0,hingePosition:"right",customWidth:(EA=n.droppedCeiling)!=null&&EA.enabled&&n.surroundType==="no-surround"?void 0:ze,zone:Ce};je&&je.hasColumn&&(ye.columnSlotInfo={hasColumn:!0,columnId:(Sc=je.column)==null?void 0:Sc.id,columnPosition:je.columnPosition,availableWidth:je.availableWidth,adjustedWidth:je.adjustedWidth,intrusionDirection:je.intrusionDirection,furniturePosition:je.furniturePosition}),console.log("🎯 가구 배치 완료:",{id:it,moduleId:ye.moduleId,isDual:Ae,isDualSlot:ye.isDualSlot,slotIndex:Z,occupiedSlots:Ae?[Z,Z+1]:[Z],zone:Ce,position:Oe,width:ue.dimensions.width,customWidth:Me}),console.log("🎯 최종 가구 데이터:",{moduleId:ye.moduleId,customWidth:ye.customWidth,adjustedWidth:ye.adjustedWidth,slotInfo:je?{hasColumn:je.hasColumn,columnType:je.columnType,availableWidth:je.availableWidth}:null,position:ye.position,"조정된 너비 사용 여부":ye.adjustedWidth!==void 0}),console.log("📋 배치 전 가구 목록:",Q.map(Tt=>({id:Tt.id.slice(-2),slotIndex:Tt.slotIndex,isDualSlot:Tt.isDualSlot,zone:Tt.zone,moduleId:Tt.moduleId})));const Ze=[],nt=Ae?[Z,Z+1]:[Z];Q.forEach(Tt=>{if((Tt.zone||"normal")!==(Ce||"normal"))return;const En=Tt.isDualSlot?[Tt.slotIndex,Tt.slotIndex+1]:[Tt.slotIndex];if(nt.some(xs=>En.includes(xs))){const xs=Zi(Tt.moduleId,x,ie),an=ue.category,as=xs==null?void 0:xs.category;console.log("🔍 충돌 감지 - 카테고리 확인:",{newModule:{id:ye.id,moduleId:ye.moduleId,category:an,slotIndex:Z},existingModule:{id:Tt.id,moduleId:Tt.moduleId,category:as,slotIndex:Tt.slotIndex}}),an==="upper"&&as==="lower"||an==="lower"&&as==="upper"?console.log("✅✅✅ 상하부장 공존 가능! 충돌 없음:",{newCategory:an,existingCategory:as,slot:Z}):(console.log("🚨 충돌 감지됨! 기존 가구 제거:",{existingModuleId:Tt.id,existingCategory:as,newCategory:an}),Ze.push(Tt.id))}}),Ze.length>0&&(console.log("🗑️ 충돌한 가구 제거:",Ze),Ze.forEach(Tt=>{o(Tt)})),s(ye),setTimeout(()=>{const Tt=pi.getState().placedModules;console.log("🟢 가구 추가 후 Store 상태:",{beforeCount:Q.length,afterCount:Tt.length,newModule:{id:ye.id,moduleId:ye.moduleId,slotIndex:ye.slotIndex},afterModules:Tt.map(Kn=>({id:Kn.id,moduleId:Kn.moduleId,slotIndex:Kn.slotIndex}))})},100);const st=[...Q,ye],At="normal",ft=new Array(qe.columnCount).fill("[ ]"),Xt=st.filter(Tt=>{var Kn;return(Kn=n.droppedCeiling)!=null&&Kn.enabled?(Tt.zone||"normal")===At:!0});return console.log(`🔍 ${At} 영역 가구 목록:`,Xt.map(Tt=>({id:Tt.id.slice(-2),moduleId:Tt.moduleId,slotIndex:Tt.slotIndex,isDualSlot:Tt.isDualSlot,zone:Tt.zone}))),Xt.forEach(Tt=>{Tt.isDualSlot&&Tt.slotIndex!==void 0?(ft[Tt.slotIndex]=`[${Tt.id.slice(-2)}`,Tt.slotIndex+1<ft.length&&(ft[Tt.slotIndex+1]=`${Tt.id.slice(-2)}]`)):Tt.slotIndex!==void 0&&(ft[Tt.slotIndex]=`[${Tt.id.slice(-2)}]`)}),console.log(`📊 ${At} 영역 슬롯 점유 상태 (총 ${qe.columnCount}개):`,ft.join("")),a&&l(null),setTimeout(()=>{ZS(Q,X)},100),window.dispatchEvent(new CustomEvent("furniture-placement-complete")),!0},[u,d,s,l,h]);H.useEffect(()=>{b.current=D},[D]),H.useEffect(()=>(console.log("🎯 SlotDropZonesSimple - registering window.handleSlotDrop",{componentMounted:!0,timestamp:new Date().toISOString()}),window.handleSlotDrop&&(console.log("⚠️ Removing existing window.handleSlotDrop"),delete window.handleSlotDrop),window.handleSlotDrop=($,U,Y)=>{var K,V,Q;if(console.log("🎯🎯🎯 window.handleSlotDrop called - using ref.current",{hasRef:!!b.current,dragEvent:!!$,dragEventType:$==null?void 0:$.type,canvasElement:!!U,activeZone:Y,droppedCeilingEnabled:(K=n.droppedCeiling)==null?void 0:K.enabled,dataTransfer:(V=$==null?void 0:$.dataTransfer)==null?void 0:V.getData("application/json")}),(Q=n.droppedCeiling)!=null&&Q.enabled&&!Y&&console.log("⚠️ 단내림이 있는데 activeZone이 없음 - 기본값 설정 필요"),b.current){const X=b.current($,U,Y);return console.log("🎯🎯🎯 window.handleSlotDrop result:",X),X}else return console.error("❌❌❌ handleSlotDropRef.current is null"),!1},console.log("✅ window.handleSlotDrop registered:",typeof window.handleSlotDrop),()=>{console.log("🎯 SlotDropZonesSimple - unregistering window.handleSlotDrop"),delete window.handleSlotDrop}),[]),H.useEffect(()=>{if(!a)return;const $=V=>{var q;V.preventDefault();const Q=document.querySelector("canvas");if(!Q)return;const X=e2(V.clientX,V.clientY,Q,u,d,n);if(X===null){w(null),y(null);return}let W=null;if((q=n.droppedCeiling)!=null&&q.enabled){const de=Q.getBoundingClientRect(),Ce=(V.clientX-de.left)/de.width*2-1,Se=-((V.clientY-de.top)/de.height)*2+1;if(!u)return console.warn("Camera not available for raycasting in window.handleSlotDrop"),!1;const fe=new YA;fe.setFromCamera(new sd(Ce,Se),u);const M=d.children.flatMap(Ae=>Ae.children||[Ae]).filter(Ae=>{var ie;return(ie=Ae.userData)==null?void 0:ie.isSlotCollider}),Z=fe.intersectObjects(M,!0);if(Z.length>0){const Ae=Z[0].object,ie=Ae==null?void 0:Ae.userData;W=(ie==null?void 0:ie.zone)||"normal",console.log("🔍 Zone 감지 (레이캐스트):",{slotIndex:X,detectedZone:W,colliderData:ie,distance:Z[0].distance})}else{const Ae=ar.calculateZoneSlotInfo(n,n.customColumnCount);if(Ae.dropped&&Ae.normal){const ie=C(Ae.dropped.startX+Ae.dropped.width),ee=C(Ae.normal.startX),ae=new sm(new lo(0,1,0),0),me=new lo;fe.ray.intersectPlane(ae,me)?n.droppedCeiling.position==="left"?W=me.x<ie?"dropped":"normal":W=me.x>=ee?"dropped":"normal":W="normal"}else W="normal"}}else W="normal",console.log("🔍 단내림 없음 - normal zone 설정:",{slotIndex:X,detectedZone:W,hoveredSlotIndex:v,hoveredZone:m});const se=a;if(se){const de=se.moduleData.id.startsWith("dual-");(()=>{var Se;if((Se=n.droppedCeiling)!=null&&Se.enabled&&W){const fe=ar.calculateZoneSlotInfo(n,n.customColumnCount),M=W==="dropped"&&fe.dropped?fe.dropped:fe.normal;if(de&&X+1>=M.columnCount)return console.log("🚫 Hover: 듀얼 가구가 영역 경계를 넘어감:",{zone:W,slotIndex:X,targetZoneColumnCount:M.columnCount,필요한슬롯:[X,X+1],영역범위:`0 ~ ${M.columnCount-1}`}),!1;const Z=r.filter(ie=>ie.zone===W);return console.log("🏗️ 단내림 구간 슬롯 점유 상태 (hover):",{zone:W,currentSlot:X,isDualDragging:de,targetSlots:de?[X,X+1]:[X],existingModules:Z.map(ie=>({id:ie.id,slotIndex:ie.slotIndex,isDualSlot:ie.isDualSlot,occupiedSlots:ie.isDualSlot?[ie.slotIndex,ie.slotIndex+1]:[ie.slotIndex],zone:ie.zone}))}),!Z.some(ie=>{if(de)if(ie.isDualSlot){const ee=ie.slotIndex===X||ie.slotIndex===X+1||ie.slotIndex===X-1||ie.slotIndex+1===X;return ee&&console.log("🚫 Hover: 듀얼-듀얼 충돌:",{드래그중:{slotIndex:X,isDual:!0,slots:[X,X+1]},기존가구:{id:ie.id,slotIndex:ie.slotIndex,isDualSlot:ie.isDualSlot,moduleId:ie.moduleId,slots:[ie.slotIndex,ie.slotIndex+1]}}),ee}else{const ee=ie.slotIndex===X||ie.slotIndex===X+1;return ee&&console.log("🚫 Hover: 듀얼-싱글 충돌:",{드래그중:{slotIndex:X,isDual:!0,slots:[X,X+1]},기존가구:{id:ie.id,slotIndex:ie.slotIndex,isDualSlot:ie.isDualSlot,moduleId:ie.moduleId,slots:[ie.slotIndex]}}),ee}else{const ee=ie.slotIndex===X||ie.isDualSlot&&(ie.slotIndex===X||ie.slotIndex+1===X);return ee&&console.log("🚫 Hover: 싱글 충돌:",{드래그중:{slotIndex:X,isDual:!1,slots:[X]},기존가구:{id:ie.id,slotIndex:ie.slotIndex,isDualSlot:ie.isDualSlot,moduleId:ie.moduleId,slots:ie.isDualSlot?[ie.slotIndex,ie.slotIndex+1]:[ie.slotIndex]}}),ee}})}else return dp(X,de,r,n,se.moduleData.id)})()?(w(X),y(W)):(w(null),y(null))}else w(X),y(W)},U=()=>{w(null)};let Y=[];const K=()=>{const V=document.querySelector("canvas");if(!V){console.log("❌ Canvas를 찾을 수 없음, 재시도..."),setTimeout(K,100);return}if(!a){console.log("📦 현재 드래그 데이터 없음");return}console.log("✅ Canvas 발견! 드래그 이벤트 리스너 추가");const Q=W=>{W.preventDefault(),console.log("🎯 Canvas dragover 이벤트!",{clientX:W.clientX,clientY:W.clientY}),$(W)},X=W=>{console.log("👋 Canvas dragleave 이벤트!"),U()};V.addEventListener("dragover",Q),V.addEventListener("dragleave",X),Y.push(()=>{V.removeEventListener("dragover",Q),V.removeEventListener("dragleave",X)})};return K(),()=>{Y.forEach(V=>V())}},[a,u,d,n,r]);const T=((O=n.droppedCeiling)==null?void 0:O.enabled)||!1,k=T?ar.calculateZoneSlotInfo(n,n.customColumnCount):null,E=(()=>{var Y,K,V,Q,X,W,se,q,de,Ce,Se,fe,M;if(!T||!(k!=null&&k.dropped))return console.log("🎯 getZoneSlotPositions - returning default positions (no dropped ceiling):",{hasDroppedCeiling:T,hasDroppedInfo:!!(k!=null&&k.dropped),defaultPositions:S.threeUnitPositions,indexingExists:!!S,threeUnitPositionsExists:!!(S!=null&&S.threeUnitPositions),isArray:Array.isArray(S==null?void 0:S.threeUnitPositions),positionCount:(Y=S.threeUnitPositions)==null?void 0:Y.length}),S.threeUnitPositions?S.threeUnitPositions.map((Z,Ae)=>({position:Z,zone:"normal",index:Ae})):[];console.log("🎯 getZoneSlotPositions - creating colliders for both zones");const $=pr(n);console.log("🔍 fullIndexing 결과:",{hasZones:!!$.zones,hasNormal:!!((K=$.zones)!=null&&K.normal),hasDropped:!!((V=$.zones)!=null&&V.dropped),normalPositions:(X=(Q=$.zones)==null?void 0:Q.normal)==null?void 0:X.threeUnitPositions,droppedPositions:(se=(W=$.zones)==null?void 0:W.dropped)==null?void 0:se.threeUnitPositions});const U=[];if((de=(q=$.zones)==null?void 0:q.normal)!=null&&de.threeUnitPositions){console.log("🔍 Normal zone positions:",$.zones.normal.threeUnitPositions);const Z=Math.min(...$.zones.normal.threeUnitPositions),Ae=Math.max(...$.zones.normal.threeUnitPositions);console.log("📏 Normal zone range:",{min:Z,max:Ae}),U.push(...$.zones.normal.threeUnitPositions.map((ie,ee)=>({position:ie,zone:"normal",index:ee})))}if((Se=(Ce=$.zones)==null?void 0:Ce.dropped)!=null&&Se.threeUnitPositions){console.log("🔍 Dropped zone positions:",$.zones.dropped.threeUnitPositions);const Z=Math.min(...$.zones.dropped.threeUnitPositions),Ae=Math.max(...$.zones.dropped.threeUnitPositions);if(console.log("📏 Dropped zone range:",{min:Z,max:Ae}),console.log("🎯 Dropped zone actual bounds:",{startX:$.zones.dropped.startX,endX:$.zones.dropped.startX+$.zones.dropped.width,width:$.zones.dropped.width,columnCount:$.zones.dropped.columnCount,position:(fe=n.droppedCeiling)==null?void 0:fe.position}),U.push(...$.zones.dropped.threeUnitPositions.map((ie,ee)=>({position:ie,zone:"dropped",index:ee}))),(M=$.zones.normal)!=null&&M.threeUnitPositions){const ie=Math.min(...$.zones.normal.threeUnitPositions),ee=Math.max(...$.zones.normal.threeUnitPositions);(Z>=ie&&Z<=ee||Ae>=ie&&Ae<=ee)&&console.error("❌ Zone overlap detected!",{normal:{min:ie,max:ee},dropped:{min:Z,max:Ae}})}}return console.log("🎯 All positions for colliders:",U),U})();return Array.isArray(E)?(console.log("🎯 SlotDropZonesSimple - rendering colliders:",{zoneSlotPositionsLength:E.length,hasDroppedCeiling:T,viewMode:p,droppedCeilingEnabled:(J=n.droppedCeiling)==null?void 0:J.enabled,zoneSlotPositions:E,indexing:S,hasIndexingPositions:!!(S!=null&&S.threeUnitPositions)}),H.useEffect(()=>{console.log("🔍 씬 체크 - 슬롯 콜라이더 확인:");let $=0;d.traverse(U=>{var Y;(Y=U.userData)!=null&&Y.isSlotCollider&&($++,console.log("✅ 콜라이더 발견:",{name:U.name,zone:U.userData.zone,slotIndex:U.userData.slotIndex,position:U.position}))}),console.log("🔍 총 콜라이더 수:",$)},[d,E]),c.jsxs("group",{children:[console.log("🎯 렌더링 슬롯 콜라이더 수:",E.length),console.log("🎯 슬롯 콜라이더 상세 정보:",E),E.map(($,U)=>{var Ae,ie,ee;const Y=typeof $=="object"&&$!==null,K=Y?$.position:$,V=Y?$.zone:"normal",Q=Y?$.index:U,X=I.depth,W=0;let se=I.width;if(T&&k){const ae=V,me=ae==="dropped"&&k.dropped?k.dropped.slotWidths:k.normal.slotWidths;if(me&&Q<me.length)se=C(me[Q]);else{const _e=ae==="dropped"&&k.dropped?k.dropped.columnWidth:k.normal.columnWidth;se=C(_e)}}else S.slotWidths&&Q<S.slotWidths.length&&(se=C(S.slotWidths[Q]));const de=((Ae=n.baseConfig)==null?void 0:Ae.placementType)==="float"?C(((ie=n.baseConfig)==null?void 0:ie.floatHeight)||0):0,Ce=C(x.startY)+de;let fe=C(x.startY)+C(x.height)-Ce;if(T&&V==="dropped"){const ae=x.height-(((ee=n.droppedCeiling)==null?void 0:ee.dropHeight)||0);fe=C(x.startY)+C(ae)-Ce}const Z=Ce+fe/2;return V==="dropped"?console.log(`🔴 [DROPPED] Slot Collider ${Q} 생성:`,{zone:V,index:Q,position:{x:K,y:Z,z:W},size:{width:se,height:fe,depth:X},userData:{slotIndex:Q,isSlotCollider:!0,type:"slot-collider",zone:V},zoneInfo:k!=null&&k.dropped?{startX:k.dropped.startX,width:k.dropped.width,columnCount:k.dropped.columnCount}:null}):Q===0&&console.log("🟢 [NORMAL] First Slot Collider 생성:",{zone:V,index:Q,position:{x:K,y:Z,z:W},zoneInfo:k!=null&&k.normal?{startX:k.normal.startX,width:k.normal.width,columnCount:k.normal.columnCount}:null}),c.jsxs("mesh",{name:`SlotCollider-${V}-${Q}`,position:[K,Z,W],userData:{slotIndex:Q,isSlotCollider:!0,type:"slot-collider",zone:V||"normal",globalSlotIndex:V==="dropped"&&(k!=null&&k.dropped)?Q+k.normal.columnCount:Q},visible:!0,children:[c.jsx("boxGeometry",{args:[se,fe,X]}),c.jsx("meshBasicMaterial",{transparent:!0,opacity:0})]},`slot-collider-${V}-${Q}`)}),v!==null&&a&&E.map(($,U)=>{var Je,Me,et,He,ze,Oe,ke,je,rt,_t,Ee,Le,ye,Ze,nt,st,At,ft,Xt,Yt;const Y=typeof $=="object"&&$!==null,K=Y?$.position:$,V=Y?$.zone:"normal",Q=Y?$.index:U,X=a;let W=!1;X&&(W=X.moduleData.id.startsWith("dual-"));let se=!1;if(v!==null&&X){const Zt=Y?Q:U,sn=!m||m===V,vt=T&&!m;se=Zt===v&&(vt||sn),console.log("🎯 고스트 렌더링 체크:",{hoveredSlotIndex:v,hoveredZone:m,slotIndex:U,slotLocalIndex:Q,slotZone:V,compareIndex:Zt,isZoneData:Y,zoneMatches:sn,shouldIgnoreZone:vt,shouldRenderGhost:se,hasDroppedCeiling:T,activeModuleData:{id:X.moduleData.id,isDual:W}})}if(!se||!X)return null;let q,de=X.moduleData.id,Ce=x;const Se=V;if(console.log("🔥 고스트 생성 디버그:",{slotIndex:U,slotLocalIndex:Q,hoveredSlotIndex:v,hoveredZone:m,slotZone:V,effectiveZone:Se,shouldRenderGhost:se,hasDroppedCeiling:T,hasZoneSlotInfo:!!k}),T&&Se&&k){const Zt=((Je=n.droppedCeiling)==null?void 0:Je.width)||ea.WIDTH;let sn;if(Se==="dropped"){const Vt=n.height-(((Me=n.droppedCeiling)==null?void 0:Me.dropHeight)||0);sn={...n,width:Zt,height:Vt,zone:"dropped"},console.log("🔧 [Ghost Preview] 단내림 영역 zoneSpaceInfo 생성:",{zone:"dropped",width:Zt,height:Vt,droppedCeilingEnabled:(et=sn.droppedCeiling)==null?void 0:et.enabled})}else sn={...n,width:n.width-Zt,zone:"normal"},console.log("🔧 [Ghost Preview] 메인 영역 zoneSpaceInfo 생성:",{zone:"normal",width:n.width-Zt,droppedCeilingEnabled:(He=sn.droppedCeiling)==null?void 0:He.enabled});Ce=Kr(sn),console.log("🎯 [Ghost Preview] Zone 내부 공간 계산:",{effectiveZone:Se,zoneSpaceInfo:{width:sn.width,height:sn.height,zone:sn.zone},zoneInternalSpace:Ce,originalHeight:n.height,droppedCeilingDropHeight:(ze=n.droppedCeiling)==null?void 0:ze.dropHeight});const vt=X.moduleData.id.replace(/-\d+$/,""),Ye=Se==="dropped"&&k.dropped?k.dropped:k.normal;let Gt;const Wt=Q;if(W&&Wt<Ye.columnCount-1){const Vt=((Oe=Ye.slotWidths)==null?void 0:Oe[Wt])||Ye.columnWidth,Jt=((ke=Ye.slotWidths)==null?void 0:ke[Wt+1])||Ye.columnWidth;Gt=Vt+Jt}else Gt=((je=Ye.slotWidths)==null?void 0:je[Wt])||Ye.columnWidth;de=`${vt}-${Gt}`,console.log("🎯 [Ghost Preview] 모듈 ID 생성:",{baseType:vt,targetWidth:Gt,targetModuleId:de,originalId:X.moduleData.id,effectiveZone:Se,localIndex:Wt}),q=Zi(de,Ce,sn),console.log("🔍 [Ghost Preview] 단내림 구간 미리보기 모듈 조회:",{effectiveZone:Se,baseType:vt,targetWidth:Gt,targetModuleId:de,moduleFound:!!q,moduleHeight:q==null?void 0:q.dimensions.height,hoveredSlotIndex:v,localIndex:Wt,slotLocalIndex:Q,targetZone:{columnCount:Ye.columnCount,columnWidth:Ye.columnWidth,slotWidths:Ye.slotWidths},zoneSpaceInfo:{width:sn.width,height:sn.height,zone:sn.zone},zoneInternalSpace:{width:Ce.width,height:Ce.height,depth:Ce.depth},originalSpaceHeight:n.height,droppedCeilingDropHeight:(rt=n.droppedCeiling)==null?void 0:rt.dropHeight})}else q=Zi(X.moduleData.id,x,n);q||(console.error("❌ [Ghost Preview] 미리보기 모듈을 찾을 수 없음:",{targetModuleId:de,effectiveZone:Se,zoneInternalSpace:Ce,baseType,targetWidth,originalModuleId:X.moduleData.id}),q=X.moduleData);let fe=K;if(T&&Se&&k){const Zt=Se==="dropped"&&k.dropped?k.dropped:k.normal,sn=C(Zt.startX),vt=C(Zt.columnWidth),Ye=Q;if(W&&Ye<Zt.columnCount-1){let Gt,Wt;if(Ye===Zt.columnCount-2){Gt=sn+Ye*vt+vt/2;const Vt=sn+(Ye+1)*vt,Jt=sn+C(Zt.width);Wt=(Vt+Jt)/2}else Gt=sn+Ye*vt+vt/2,Wt=sn+(Ye+1)*vt+vt/2;fe=(Gt+Wt)/2}else if(Ye===Zt.columnCount-1){const Gt=sn+Ye*vt,Wt=sn+C(Zt.width);fe=(Gt+Wt)/2}else fe=sn+Ye*vt+vt/2}else W&&U===v?S.threeUnitDualPositions&&S.threeUnitDualPositions[U]!==void 0&&(fe=S.threeUnitDualPositions[U]):fe=K,console.log("🎯 [Normal Ghost] 일반 구간 고스트 위치:",{isDual:W,slotIndex:U,hoveredSlotIndex:v,previewX:fe,slotX:K,threeUnitDualPositions:S.threeUnitDualPositions,dualPosition:(_t=S.threeUnitDualPositions)==null?void 0:_t[U]});const M=(q==null?void 0:q.defaultDepth)||Math.min(Math.floor(n.depth*.9),580),Z=((Ee=q==null?void 0:q.dimensions)==null?void 0:Ee.height)||600,Ae=Z*.01,ie=(q==null?void 0:q.category)==="upper"||((Le=q==null?void 0:q.id)==null?void 0:Le.includes("upper-cabinet"));(q==null?void 0:q.category)==="lower"||((ye=q==null?void 0:q.id)==null||ye.includes("lower-cabinet"));let ee;if(ie){let vt;if(Se==="dropped"&&((Ze=n.droppedCeiling)!=null&&Ze.enabled)){const Gt=((nt=n.droppedCeiling)==null?void 0:nt.dropHeight)||200;vt=n.height-Gt}else vt=n.height;n.surroundType!=="no-surround"?vt=vt-10-10:vt=vt-10;const Ye=((st=q==null?void 0:q.dimensions)==null?void 0:st.height)||600;ee=(vt-Ye/2)/100,console.log("👻 [Ghost Preview] 상부장 Y 위치:",{slotStartY:j,totalHeightMm:vt,furnitureHeightMm:Ye,furnitureY:ee,category:q.category,effectiveZone:Se,surroundType:n.surroundType,설명:"상부장은 천장 고정 (프레임과 간격 고려)"})}else ee=j+Ae/2;console.log("👻 [Ghost Preview] 가구 높이 계산:",{effectiveZone:Se,moduleDataHeight:(At=q==null?void 0:q.dimensions)==null?void 0:At.height,moduleDataId:q.id,zoneInternalSpaceHeight:Ce==null?void 0:Ce.height,furnitureHeightMm:Z,furnitureHeight:Ae,furnitureY:ee,slotStartY:j,expectedY:j+Ae/2,originalSpaceHeight:n.height,droppedCeilingDropHeight:(ft=n.droppedCeiling)==null?void 0:ft.dropHeight,isDroppedZone:Se==="dropped"});const ae=C(20),me=C(1500),_e=C(600),Be=-me/2+(me-_e)/2,it=C(M),De=Be+_e/2-ae-it/2,qe=T&&Se==="dropped"&&k?{...n,width:((Xt=n.droppedCeiling)==null?void 0:Xt.width)||ea.WIDTH,height:n.height-(((Yt=n.droppedCeiling)==null?void 0:Yt.dropHeight)||0),zone:"dropped"}:n;return c.jsx("group",{position:[fe,ee,De],children:c.jsx(kQ,{moduleData:q,color:g.color,isDragging:!0,hasDoor:!1,customDepth:M,spaceInfo:qe})},`furniture-preview-${U}`)})]})):(console.error("❌ getZoneSlotPositions returned non-array:",E),c.jsx("group",{}))},gue=({spaceInfo:n})=>{var m,y;pi(x=>x.isFurniturePlacementMode);const e=pi(x=>x.placedModules),{theme:t}=Ua(),i=Kr(n),r=x=>x*.01,o=-(n.width/2)+i.startX+i.width/2,a=r(o),l=n.hasFloorFinish&&n.floorFinish?n.floorFinish.height:0,h=((m=n.baseConfig)==null?void 0:m.height)||0;let u;if(!n.baseConfig||n.baseConfig.type==="floor")u=r(l+h);else if(n.baseConfig.type==="stand")if(n.baseConfig.placementType==="float"){const x=n.baseConfig.floatHeight||0;u=r(l+x)}else u=r(l);else u=r(l);const d=r(i.width),A=r(i.depth-200-20),f=r(-10),p=e.some(x=>x.hasDoor),g=H.useMemo(()=>{if(typeof window<"u"){const S=getComputedStyle(document.documentElement).getPropertyValue("--theme-primary").trim();if(S)return S}return"#10b981"},[t.color]),v=pr(n);if(((y=n.droppedCeiling)==null?void 0:y.enabled)&&v.zones&&v.zones){const x=[];if(v.zones.normal){const S=v.zones.normal.startX+v.zones.normal.width/2,I=r(v.zones.normal.width);x.push(c.jsx("group",{position:[r(S),u-.1,f],children:!p&&c.jsxs("mesh",{rotation:[-Math.PI/2,0,0],children:[c.jsx("planeGeometry",{args:[I,A]}),c.jsx("meshBasicMaterial",{color:g,transparent:!0,opacity:.05,side:2})]})},"normal-zone"))}if(v.zones.dropped){const S=v.zones.dropped.startX+v.zones.dropped.width/2,I=r(v.zones.dropped.width);x.push(c.jsx("group",{position:[r(S),u-.1,f],children:!p&&c.jsxs("mesh",{rotation:[-Math.PI/2,0,0],children:[c.jsx("planeGeometry",{args:[I,A]}),c.jsx("meshBasicMaterial",{color:g,transparent:!0,opacity:.05,side:2})]})},"dropped-zone"))}return c.jsx(c.Fragment,{children:x})}return c.jsx("group",{position:[a,u-.1,f],children:!p&&c.jsxs("mesh",{rotation:[-Math.PI/2,0,0],children:[c.jsx("planeGeometry",{args:[d,A]}),c.jsx("meshBasicMaterial",{color:g,transparent:!0,opacity:.05,side:2})]},`slot-mesh-${t.color}-${t.mode}`)})},mue=()=>null;function yue(n,e){const t=H.useRef(0),i=H.useRef(null),r=H.useRef(null);return H.useCallback((...s)=>{const a=Date.now()-t.current,l=()=>{t.current=Date.now(),n(...s)};a>=e?(r.current&&cancelAnimationFrame(r.current),r.current=requestAnimationFrame(l)):(i.current&&clearTimeout(i.current),i.current=setTimeout(()=>{r.current&&cancelAnimationFrame(r.current),r.current=requestAnimationFrame(l)},e-a))},[n,e])}const wue="_toolbar_11bqk_1",vue="_toolbarButton_11bqk_11",xue="_active_11bqk_45",l3={toolbar:wue,toolbarButton:vue,active:xue},bue=({viewMode:n})=>{var a,l;const{indirectLightEnabled:e,toggleIndirectLight:t}=Wi(),i=pi(h=>h.placedModules),r=hr(h=>h.spaceInfo),s=((a=r==null?void 0:r.baseConfig)==null?void 0:a.placementType)==="float"&&(((l=r==null?void 0:r.baseConfig)==null?void 0:l.floatHeight)||0)>0,o=i.some(h=>h.moduleId.includes("upper-cabinet")||h.moduleId.includes("upper"));return n!=="3D"||!o&&!s?null:c.jsx("div",{className:l3.toolbar,children:c.jsx("div",{className:`${l3.toolbarButton} ${e?l3.active:""}`,onClick:t,title:e?"간접조명 끄기":"간접조명 켜기",role:"button",tabIndex:0,children:c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:e?c.jsxs(c.Fragment,{children:[c.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"0",strokeWidth:"1.5"}),c.jsx("line",{x1:"19",y1:"5",x2:"20.5",y2:"3.5",strokeWidth:"1.5"}),c.jsx("line",{x1:"22",y1:"12",x2:"24",y2:"12",strokeWidth:"1.5"}),c.jsx("line",{x1:"19",y1:"19",x2:"20.5",y2:"20.5",strokeWidth:"1.5"}),c.jsx("line",{x1:"12",y1:"22",x2:"12",y2:"24",strokeWidth:"1.5"}),c.jsx("line",{x1:"5",y1:"19",x2:"3.5",y2:"20.5",strokeWidth:"1.5"}),c.jsx("line",{x1:"2",y1:"12",x2:"0",y2:"12",strokeWidth:"1.5"}),c.jsx("line",{x1:"5",y1:"5",x2:"3.5",y2:"3.5",strokeWidth:"1.5"}),c.jsx("rect",{x:"10",y:"4",width:"4",height:"3",fill:"currentColor",fillOpacity:"0.3"}),c.jsx("line",{x1:"10",y1:"5",x2:"14",y2:"5",strokeWidth:"0.5"}),c.jsx("line",{x1:"10",y1:"6",x2:"14",y2:"6",strokeWidth:"0.5"}),c.jsx("circle",{cx:"12",cy:"12",r:"6",fill:"currentColor",fillOpacity:"0.3"}),c.jsx("circle",{cx:"12",cy:"12",r:"6"}),c.jsx("path",{d:"M10 12 L12 14 L14 12 L12 10 Z",stroke:"currentColor",strokeWidth:"0.5",fill:"none"})]}):c.jsxs(c.Fragment,{children:[c.jsx("rect",{x:"10",y:"4",width:"4",height:"3",fill:"currentColor",fillOpacity:"0.3"}),c.jsx("line",{x1:"10",y1:"5",x2:"14",y2:"5",strokeWidth:"0.5"}),c.jsx("line",{x1:"10",y1:"6",x2:"14",y2:"6",strokeWidth:"0.5"}),c.jsx("circle",{cx:"12",cy:"12",r:"6",fill:"currentColor",fillOpacity:"0.3"}),c.jsx("circle",{cx:"12",cy:"12",r:"6"})]})})})})},Cue=n=>{var fe;const{spaceInfo:e,svgSize:t,viewMode:i="3D",setViewMode:r,renderMode:s="wireframe",showAll:o=!0,showFurniture:a=!0,showFrame:l=!0,showDimensions:h,isEmbedded:u,isStep2:d,activeZone:A}=n;console.log("🌐 Space3DView - viewMode:",i),console.log("🌐 Space3DView - props:",n),e5();const{spaceInfo:f,updateColumn:p,removeColumn:g,updateWall:v,removeWall:w,addWall:m,removePanelB:y,updatePanelB:x}=hr(),{placedModules:S,updateFurnitureForColumns:I}=pi(),{view2DDirection:j,showDimensions:C,showGuides:b,showAxis:D,activePopup:T,setView2DDirection:k,setViewMode:B,isColumnCreationMode:E,isWallCreationMode:z,isPanelBCreationMode:te,view2DTheme:L}=Wi(),{colors:O}=yk(),{theme:J}=Ua(),$=yue((M,Z)=>{p(M,Z)},8),U=f.materialConfig||{interiorColor:"#FFFFFF",doorColor:"#FFFFFF"};H.useEffect(()=>{var M,Z;e&&(console.log("🔄 Space3DView - 기둥 상태 변경 감지:",{columnsCount:((M=e.columns)==null?void 0:M.length)||0,columnsData:(Z=e.columns)==null?void 0:Z.map(Ae=>({id:Ae.id,position:Ae.position,depth:Ae.depth}))}),I(e))},[e==null?void 0:e.columns]);const Y=H.useMemo(()=>{if(!e)return[0,10,20];const{width:M,height:Z,depth:Ae=600}=e,ie=Th(M,Z,Ae,S.length),ee=0,ae=mc(Z*.5),me=0,_e=[ee,ae,ie];if(i==="3D")return _e;switch(j){case"front":return[ee,ae,ie];case"left":return[-Th(Ae,Z,M,S.length),ae,me];case"right":return[Th(Ae,Z,M,S.length),ae,me];case"top":const it=Th(M,Ae,Z,S.length);return[ee,ae+it,me];case"all":return _e;default:return _e}},[e==null?void 0:e.width,e==null?void 0:e.height,e==null?void 0:e.depth,i,j,S.length]),K=M=>{var ie;console.log("🔴🔴🔴 [CRITICAL] Space3DView handleDrop 호출됨!",{windowHandleSlotDrop:typeof window.handleSlotDrop,currentTarget:M.currentTarget.tagName,dataTransfer:M.dataTransfer.getData("application/json"),clientX:M.clientX,clientY:M.clientY,eventType:M.type}),M.preventDefault(),M.stopPropagation();const Z=M.currentTarget.querySelector("canvas");if(console.log("🔍 [Space3DView] Canvas 검색:",{currentTarget:M.currentTarget,tagName:M.currentTarget.tagName,className:M.currentTarget.className,children:M.currentTarget.children.length,canvas:!!Z,allCanvases:document.querySelectorAll("canvas").length}),!Z){console.log("❌ [Space3DView] Canvas 요소를 찾을 수 없음 - 대체 방법 시도");const ee=document.querySelectorAll("canvas");if(ee.length>0){const ae=ee[0];console.log("✅ [Space3DView] 대체 Canvas 발견:",ae);const me=M.dataTransfer.getData("application/json");if(me)try{const _e=JSON.parse(me);if(_e.type!=="column"&&_e.type!=="wall"&&_e.type!=="panelB"){const ue=window.handleSlotDrop;typeof ue=="function"&&(console.log("🎯 대체 Canvas로 handleSlotDrop 호출"),ue(M.nativeEvent,ae,A))}}catch(_e){console.error("대체 처리 중 에러:",_e)}}return}const Ae=M.dataTransfer.getData("application/json");if(console.log("🎯 [Space3DView] Drag data:",Ae),!Ae){console.log("❌ [Space3DView] Drag data가 없음");return}try{const ee=JSON.parse(Ae);if(console.log("🎯 [Space3DView] Parsed drag data:",ee),ee.type==="column"){V(M,ee);return}if(ee.type==="wall"){Q(M,ee);return}if(ee.type==="panelB"){X(M,ee);return}const ae=window.handleSlotDrop;if(console.log("🎯 Space3DView - window.handleSlotDrop 확인:",{hasHandleSlotDrop:!!ae,typeofHandleSlotDrop:typeof ae,activeZone:A,windowKeys:Object.keys(window).filter(me=>me.includes("handle")),furnitureStoreState:pi.getState().currentDragData}),typeof ae=="function"){console.log("🎯 Space3DView handleDrop - activeZone:",A);try{const me=ae(M.nativeEvent,Z,A);console.log("🎯 Space3DView handleDrop - result:",me)}catch(me){console.error("❌ handleSlotDrop 실행 중 에러:",me),console.error("에러 스택:",me.stack)}}else{console.error("❌ window.handleSlotDrop이 없습니다! 기본 가구 배치 처리를 시도합니다.");const me=Z.getBoundingClientRect(),_e=(M.clientX-me.left)/me.width*2-1,ue=-((M.clientY-me.top)/me.height)*2+1;console.log("🎯 간단한 가구 배치 시도:",{mouseX:_e,mouseY:ue,moduleData:ee.moduleData});const Be=pi.getState().placedModules,it=pi.getState().addModule;let De=hr.getState().spaceInfo;De.surroundType==="no-surround"&&De.frameSize&&(De.frameSize.left>0||De.frameSize.right>0)&&(console.error("🔴🔴🔴 [CRITICAL] Space3DView 폴백 - 노서라운드인데 frameSize가 잘못됨! 강제 수정!"),De={...De,frameSize:{left:0,right:0,top:0}});const qe=pr(De);let Je=-1;for(let Me=0;Me<qe.columnCount;Me++)if(!Be.some(He=>He.slotIndex===Me)){Je=Me;break}if(Je>=0){const Me=((ie=qe.slotWidths)==null?void 0:ie[Je])||qe.columnWidth,et={id:`placed-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,moduleId:ee.moduleData.id,position:{x:qe.threeUnitPositions[Je],y:0,z:0},rotation:0,hasDoor:!1,customDepth:Math.min(580,De.depth*.9),slotIndex:Je,isDualSlot:ee.moduleData.id.startsWith("dual-"),isValidInCurrentSpace:!0,adjustedWidth:ee.moduleData.dimensions.width,hingePosition:"right",customWidth:Me};it(et),console.log("✅ 폴백 가구 배치 성공:",et)}}}catch(ee){console.error("드롭 데이터 파싱 오류:",ee),console.error("에러 스택:",ee.stack)}},V=(M,Z)=>{const Ae=M.currentTarget.getBoundingClientRect(),ie=(M.clientX-Ae.left-Ae.width/2)/100,ee=((e==null?void 0:e.depth)||1500)*.01,ae=(Z.depth||730)*.01,me=-(ee/2)+ae/2,_e={id:`column-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,position:[ie,0,me],width:Z.width||300,height:Z.height||(e==null?void 0:e.height)||2400,depth:Z.depth||730,color:Z.color||"#888888",material:Z.material||"concrete"};console.log("🏗️ 기둥 드롭 배치:",{centerX:ie,zPosition:me,spaceDepthM:ee,columnDepthM:ae,column:_e});const{addColumn:ue}=hr.getState();ue(_e)},Q=(M,Z)=>{const Ae=M.currentTarget.getBoundingClientRect(),ie=(M.clientX-Ae.left-Ae.width/2)/100,ee=((e==null?void 0:e.depth)||1500)*.01,ae=(Z.depth||730)*.01,me=-(ee/2)+ae/2,_e={id:`wall-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,position:[ie,0,me],width:Z.width||120,height:Z.height||(e==null?void 0:e.height)||2400,depth:Z.depth||730,color:Z.color||"#888888",material:Z.material||"concrete"};console.log("🧱 가벽 드롭 배치:",{centerX:ie,zPosition:me,spaceDepthM:ee,wallDepthM:ae,wall:_e}),m(_e)},X=(M,Z)=>{const Ae=M.currentTarget.getBoundingClientRect(),ie=(M.clientX-Ae.left-Ae.width/2)/100,ee=((e==null?void 0:e.depth)||1500)*.01,ae=(Z.depth||730)*.01,me=-(ee/2)+ae/2,_e={id:`panelB-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,position:[ie,0,me],width:Z.width||600,height:18,depth:Z.depth||730,color:Z.color||"#8B4513",material:Z.material||"wood",orientation:"horizontal"};console.log("🪵 패널B 드롭 배치:",{centerX:ie,zPosition:me,spaceDepthM:ee,panelDepthM:ae,panelB:_e});const{addPanelB:ue}=hr.getState();ue(_e)},W=M=>{console.log("🎯 [DRAG] Space3DView handleDragOver 호출됨!",{clientX:M.clientX,clientY:M.clientY,eventType:M.type}),M.preventDefault()};H.useEffect(()=>()=>{(()=>{document.querySelectorAll("canvas").forEach(Ae=>{const ie=Ae.getContext("2d");ie&&ie.clearRect(0,0,Ae.width,Ae.height);const ee=Ae.getContext("webgl")||Ae.getContext("webgl2");if(ee&&!ee.isContextLost())try{const ae=ee.getExtension("WEBGL_lose_context");ae&&ae.loseContext()}catch(ae){console.log("WebGL context cleanup error:",ae)}})})()},[]);const se=H.useMemo(()=>{if(!e||S.length===0)return null;let M=1/0,Z=-1/0,Ae=1/0,ie=-1/0,ee=1/0,ae=-1/0;S.forEach(Be=>{const it=Zi(Be.moduleId);if(!it)return;const De=mc(Be.customWidth||it.width),qe=mc(Be.customHeight||it.height),Je=mc(Be.customDepth||it.depth),Me=Be.position.x,et=Be.position.y,He=Be.position.z;M=Math.min(M,Me-De/2),Z=Math.max(Z,Me+De/2),Ae=Math.min(Ae,et),ie=Math.max(ie,et+qe),ee=Math.min(ee,He-Je/2),ae=Math.max(ae,He+Je/2)});const me=mc(e.width),_e=mc(e.height),ue=mc(e.depth||1500);return M=Math.min(M,-me/2),Z=Math.max(Z,me/2),Ae=0,ie=Math.max(ie,_e),ee=Math.min(ee,-ue/2),ae=Math.max(ae,ue/2),{center:{x:(M+Z)/2,y:(Ae+ie)/2,z:(ee+ae)/2},size:{width:Z-M,height:ie-Ae,depth:ae-ee}}},[e,S]),q=M=>{const Z=se,Ae=(e==null?void 0:e.width)||3e3,ie=(e==null?void 0:e.height)||2400,ee=(e==null?void 0:e.depth)||1500;if(!Z){const De={x:0,y:mc(ie*.5),z:0};let qe,Je,Me=[0,1,0];switch(M){case"front":qe=Th(Ae,ie,ee,S.length),Je=[De.x,De.y,De.z+qe],Me=[0,1,0];break;case"top":qe=Th(Ae,ee,ie,S.length),Je=[De.x,De.y+qe,De.z],Me=[0,0,-1];break;case"left":qe=Th(ee,ie,Ae,S.length),Je=[De.x-qe,De.y,De.z],Me=[0,1,0];break;case"right":qe=Th(ee,ie,Ae,S.length),Je=[De.x+qe,De.y,De.z],Me=[0,1,0];break}return{position:Je,target:[De.x,De.y,De.z],up:Me}}const ae=Z.center,me=Z.size,_e={width:qS(me.width),height:qS(me.height),depth:qS(me.depth)};let ue,Be,it=[0,1,0];switch(M){case"front":ue=Th(_e.width,_e.height,_e.depth,S.length),Be=[ae.x,ae.y,ae.z+ue],it=[0,1,0];break;case"top":ue=Th(_e.width,_e.depth,_e.height,S.length),Be=[ae.x,ae.y+ue,ae.z],it=[0,0,-1];break;case"left":ue=Th(_e.depth,_e.height,_e.width,S.length),Be=[ae.x-ue,ae.y,ae.z],it=[0,1,0];break;case"right":ue=Th(_e.depth,_e.height,_e.width,S.length),Be=[ae.x+ue,ae.y,ae.z],it=[0,1,0];break}return{position:Be,target:[ae.x,ae.y,ae.z],up:it}},[de,Ce]=ci.useState(null),Se=M=>{k(M),B("2D")};return i==="2D"&&j==="all"?c.jsx(Cj,{viewMode:i,children:c.jsx(qB,{spaceInfo:e,svgSize:t,renderMode:s,viewMode:i,activeZone:A,children:c.jsxs("div",{style:{width:"100%",height:"100%",minHeight:"400px",position:"relative",display:"grid",gridTemplateColumns:"1fr 1fr",gridTemplateRows:"1fr 1fr",gap:"0",backgroundColor:O.primary||"#4CAF50",overflow:"hidden"},children:[c.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"1px",backgroundColor:J.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.15)",zIndex:10,transform:"translateY(-50%)"}}),c.jsx("div",{style:{position:"absolute",top:0,bottom:0,left:"50%",width:"1px",backgroundColor:J.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.15)",zIndex:10,transform:"translateX(-50%)"}}),c.jsxs("div",{onClick:()=>Ce(de==="front"?null:"front"),style:{position:"relative",overflow:"hidden",backgroundColor:"#121212",border:de==="front"?`3px solid ${$h()}`:"1px solid transparent",transition:"border 0.3s ease",boxSizing:"border-box",cursor:"pointer"},children:[c.jsx(hm,{cameraPosition:q("front").position,cameraTarget:q("front").target,cameraUp:q("front").up,viewMode:"2D",view2DDirection:"front",renderMode:s,isSplitView:!0,children:c.jsx(dx,{viewDirection:"front",spaceInfo:e,materialConfig:U,showAll:o,showFrame:l,showFurniture:a,viewMode:"2D",renderMode:s,activeZone:A,showDimensions:C,showGuides:b,showAxis:D,isStep2:d})}),c.jsx("div",{style:{position:"absolute",top:"8px",left:"8px",backgroundColor:"rgba(18,18,18,0.7)",color:"#fff",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",backdropFilter:"blur(4px)",border:"1px solid rgba(255,255,255,0.1)"},children:"front"}),c.jsx("button",{onClick:()=>Se("front"),style:{position:"absolute",top:"8px",right:"8px",backgroundColor:"rgba(18,18,18,0.7)",color:"#fff",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"4px",padding:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(4px)",transition:"all 0.2s ease"},onMouseEnter:M=>{M.currentTarget.style.backgroundColor="rgba(255,255,255,0.1)",M.currentTarget.style.borderColor="rgba(255,255,255,0.4)"},onMouseLeave:M=>{M.currentTarget.style.backgroundColor="rgba(18,18,18,0.7)",M.currentTarget.style.borderColor="rgba(255,255,255,0.2)"},title:"전체화면으로 보기",children:c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:c.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})})})]}),c.jsxs("div",{onClick:()=>Ce(de==="top"?null:"top"),style:{position:"relative",overflow:"hidden",backgroundColor:"#121212",border:de==="top"?`3px solid ${$h()}`:"1px solid transparent",transition:"border 0.3s ease",boxSizing:"border-box",cursor:"pointer"},children:[c.jsx(hm,{cameraPosition:q("top").position,cameraTarget:q("top").target,cameraUp:q("top").up,viewMode:"2D",view2DDirection:"top",renderMode:s,isSplitView:!0,children:c.jsx(dx,{viewDirection:"top",spaceInfo:e,materialConfig:U,showAll:o,showFrame:l,showFurniture:a,viewMode:"2D",renderMode:s,activeZone:A,showDimensions:C,showGuides:b,showAxis:D,isStep2:d})}),c.jsx("div",{style:{position:"absolute",top:"8px",left:"8px",backgroundColor:"rgba(18,18,18,0.7)",color:"#fff",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",backdropFilter:"blur(4px)",border:"1px solid rgba(255,255,255,0.1)"},children:"top"}),c.jsx("button",{onClick:()=>Se("top"),style:{position:"absolute",top:"8px",right:"8px",backgroundColor:"rgba(18,18,18,0.7)",color:"#fff",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"4px",padding:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(4px)",transition:"all 0.2s ease"},onMouseEnter:M=>{M.currentTarget.style.backgroundColor="rgba(255,255,255,0.1)",M.currentTarget.style.borderColor="rgba(255,255,255,0.4)"},onMouseLeave:M=>{M.currentTarget.style.backgroundColor="rgba(18,18,18,0.7)",M.currentTarget.style.borderColor="rgba(255,255,255,0.2)"},title:"전체화면으로 보기",children:c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:c.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})})})]}),c.jsxs("div",{onClick:()=>Ce(de==="left"?null:"left"),style:{position:"relative",overflow:"hidden",backgroundColor:"#121212",border:de==="left"?`3px solid ${$h()}`:"1px solid transparent",transition:"border 0.3s ease",boxSizing:"border-box",cursor:"pointer"},children:[c.jsx(hm,{cameraPosition:q("left").position,cameraTarget:q("left").target,cameraUp:q("left").up,viewMode:"2D",view2DDirection:"left",renderMode:s,isSplitView:!0,children:c.jsx(dx,{viewDirection:"left",spaceInfo:e,materialConfig:U,showAll:o,showFrame:l,showFurniture:a,viewMode:"2D",renderMode:s,activeZone:A,showDimensions:C,showGuides:b,showAxis:D,isStep2:d})}),c.jsx("div",{style:{position:"absolute",top:"8px",left:"8px",backgroundColor:"rgba(18,18,18,0.7)",color:"#fff",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",backdropFilter:"blur(4px)",border:"1px solid rgba(255,255,255,0.1)"},children:"left"}),c.jsx("button",{onClick:()=>Se("left"),style:{position:"absolute",top:"8px",right:"8px",backgroundColor:"rgba(18,18,18,0.7)",color:"#fff",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"4px",padding:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(4px)",transition:"all 0.2s ease"},onMouseEnter:M=>{M.currentTarget.style.backgroundColor="rgba(255,255,255,0.1)",M.currentTarget.style.borderColor="rgba(255,255,255,0.4)"},onMouseLeave:M=>{M.currentTarget.style.backgroundColor="rgba(18,18,18,0.7)",M.currentTarget.style.borderColor="rgba(255,255,255,0.2)"},title:"전체화면으로 보기",children:c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:c.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})})})]}),c.jsxs("div",{onClick:()=>Ce(de==="right"?null:"right"),style:{position:"relative",overflow:"hidden",backgroundColor:"#121212",border:de==="right"?`3px solid ${$h()}`:"1px solid transparent",transition:"border 0.3s ease",boxSizing:"border-box",cursor:"pointer"},children:[c.jsx(hm,{cameraPosition:q("right").position,cameraTarget:q("right").target,cameraUp:q("right").up,viewMode:"2D",view2DDirection:"right",renderMode:s,isSplitView:!0,children:c.jsx(dx,{viewDirection:"right",spaceInfo:e,materialConfig:U,showAll:o,showFrame:l,showFurniture:a,viewMode:"2D",renderMode:s,activeZone:A,showDimensions:C,showGuides:b,showAxis:D,isStep2:d})}),c.jsx("div",{style:{position:"absolute",top:"8px",left:"8px",backgroundColor:"rgba(18,18,18,0.7)",color:"#fff",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",backdropFilter:"blur(4px)",border:"1px solid rgba(255,255,255,0.1)"},children:"right"}),c.jsx("button",{onClick:()=>Se("right"),style:{position:"absolute",top:"8px",right:"8px",backgroundColor:"rgba(18,18,18,0.7)",color:"#fff",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"4px",padding:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(4px)",transition:"all 0.2s ease"},onMouseEnter:M=>{M.currentTarget.style.backgroundColor="rgba(255,255,255,0.1)",M.currentTarget.style.borderColor="rgba(255,255,255,0.4)"},onMouseLeave:M=>{M.currentTarget.style.backgroundColor="rgba(18,18,18,0.7)",M.currentTarget.style.borderColor="rgba(255,255,255,0.2)"},title:"전체화면으로 보기",children:c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:c.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})})})]})]})})}):c.jsx(Cj,{viewMode:i,children:c.jsx(qB,{spaceInfo:e,svgSize:t,renderMode:s,viewMode:i,activeZone:A,children:c.jsxs("div",{style:{width:"100%",height:"100%",minHeight:"400px",position:"relative"},onDrop:K,onDragOver:W,"data-viewer-container":"true",children:[c.jsx(bue,{viewMode:i}),c.jsx(hm,{cameraPosition:Y,cameraTarget:Kz((e==null?void 0:e.height)||2400),viewMode:i,view2DDirection:j,renderMode:s,children:c.jsxs(ci.Suspense,{fallback:null,children:[c.jsx(UQ,{viewMode:i,view2DDirection:j,enabled:C&&b,showAxis:C&&D}),c.jsx("directionalLight",{position:[5,15,20],intensity:2.5,color:"#ffffff",castShadow:i==="3D","shadow-mapSize-width":4096,"shadow-mapSize-height":4096,"shadow-camera-far":50,"shadow-camera-left":-25,"shadow-camera-right":25,"shadow-camera-top":25,"shadow-camera-bottom":-25,"shadow-bias":-5e-4,"shadow-radius":12,"shadow-normalBias":.02}),c.jsx("directionalLight",{position:[-8,10,15],intensity:.6,color:"#ffffff"}),c.jsx("directionalLight",{position:[8,10,15],intensity:.6,color:"#ffffff"}),c.jsx("ambientLight",{intensity:i==="2D"?.8:.5,color:"#ffffff"}),c.jsx(Mk,{spaceInfo:e,viewMode:i,view2DDirection:j,renderMode:s,materialConfig:U,showAll:o,showFurniture:a,showFrame:l,showDimensions:C,showGuides:b,isStep2:d,activeZone:A}),c.jsx(pue,{spaceInfo:e}),((e==null?void 0:e.columns)||[]).map(M=>{var Ae;let Z=M.height||e.height||2400;if((Ae=e.droppedCeiling)!=null&&Ae.enabled){const ie=e.width,ee=e.droppedCeiling.width||ea.WIDTH,ae=e.droppedCeiling.position||"right",me=e.droppedCeiling.dropHeight||200,_e=M.position[0]*100,ue=0,Be=ue-ie/2,it=ue+ie/2;let De,qe;ae==="left"?(De=Be,qe=Be+ee):(De=it-ee,qe=it),_e>=De&&_e<=qe&&(Z=M.height-me)}return c.jsxs(ci.Fragment,{children:[c.jsx(NQ,{id:M.id,position:M.position,width:M.width,height:Z,depth:M.depth,color:M.color,hasBackPanelFinish:M.hasBackPanelFinish,spaceInfo:e,renderMode:s,onPositionChange:(ie,ee)=>{$(ie,{position:ee})},onRemove:ie=>{g(ie)}}),T.type==="columnEdit"&&T.id===M.id&&c.jsx(LQ,{column:M,spaceInfo:e,onPositionChange:(ie,ee)=>{$(ie,{position:ee})},onColumnUpdate:(ie,ee)=>{p(ie,ee)},showLabels:!0})]},M.id)}),((e==null?void 0:e.walls)||[]).map(M=>{var Ae;let Z=M.height;if((Ae=e.droppedCeiling)!=null&&Ae.enabled){const ie=e.width,ee=e.droppedCeiling.width||ea.WIDTH,ae=e.droppedCeiling.position||"right",me=e.droppedCeiling.dropHeight||200,_e=M.position[0]*100,ue=0,Be=ue-ie/2,it=ue+ie/2;let De,qe;ae==="left"?(De=Be,qe=Be+ee):(De=it-ee,qe=it),console.log("🏗️ 가벽 단내림 체크:",{wallId:M.id,wallXMm:_e,droppedStartX:De,droppedEndX:qe,isInDroppedArea:_e>=De&&_e<=qe,originalHeight:M.height,dropHeight:me,wallHeight:Z}),_e>=De&&_e<=qe&&(Z=M.height-me,console.log("🏗️ 가벽 높이 조정됨:",{wallId:M.id,originalHeight:M.height,adjustedHeight:Z}))}return c.jsx(lue,{id:M.id,position:M.position,width:M.width,height:Z,depth:M.depth,color:M.color,spaceInfo:e,renderMode:s,onPositionChange:(ie,ee)=>{v(ie,{position:ee})},onRemove:ie=>{w(ie)}},M.id)}),(fe=e==null?void 0:e.panelBs)==null?void 0:fe.map(M=>c.jsx(due,{id:M.id,position:M.position,width:M.width,height:M.height,depth:M.depth,color:M.color,renderMode:i==="3D"?"solid":"wireframe",onPositionChange:(Z,Ae)=>x(Z,{position:Ae}),onRemove:y,spaceInfo:e},M.id)),te&&i==="3D"&&c.jsx(Aue,{spaceInfo:e}),c.jsx(hue,{spaceInfo:e}),C&&o&&c.jsx(MQ,{viewMode:i}),c.jsx(RQ,{viewDirection:i==="3D"?"3D":j,showDimensions:C,showFurniture:a,isStep2:d}),c.jsx(OQ,{spaceInfo:e,showAll:o,showDimensions:C,viewMode:i}),c.jsx(mue,{})]})}),i==="2D"&&j!=="all"&&c.jsx("button",{onClick:()=>{k("all")},style:{position:"absolute",top:"10px",right:"10px",width:"36px",height:"36px",backgroundColor:L==="dark"?"rgba(18,18,18,0.7)":"rgba(255,255,255,0.9)",border:`1px solid ${L==="dark"?"rgba(255,255,255,0.2)":"rgba(0,0,0,0.2)"}`,borderRadius:"4px",color:L==="dark"?"#ffffff":"#000000",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease",zIndex:20,padding:"0",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},onMouseEnter:M=>{M.currentTarget.style.backgroundColor=L==="dark"?"rgba(18,18,18,0.9)":"rgba(255,255,255,1)",M.currentTarget.style.borderColor=L==="dark"?"rgba(255,255,255,0.4)":"rgba(0,0,0,0.4)",M.currentTarget.style.transform="scale(1.05)"},onMouseLeave:M=>{M.currentTarget.style.backgroundColor=L==="dark"?"rgba(18,18,18,0.7)":"rgba(255,255,255,0.9)",M.currentTarget.style.borderColor=L==="dark"?"rgba(255,255,255,0.2)":"rgba(0,0,0,0.2)",M.currentTarget.style.transform="scale(1)"},title:"4분할 뷰로 보기",children:c.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[c.jsx("rect",{x:"3",y:"3",width:"8",height:"8"}),c.jsx("rect",{x:"13",y:"3",width:"8",height:"8"}),c.jsx("rect",{x:"3",y:"13",width:"8",height:"8"}),c.jsx("rect",{x:"13",y:"13",width:"8",height:"8"})]})})]})})})},dx=({viewDirection:n,spaceInfo:e,materialConfig:t,showAll:i,showFrame:r,showDimensions:s,showGuides:o,showAxis:a,showFurniture:l=!0,isStep2:h,throttledUpdateColumn:u,activeZone:d,viewMode:A="2D",renderMode:f="wireframe"})=>{const{placedModules:p}=pi(),{updateColumn:g,removeColumn:v,updateWall:w,removeWall:m}=hr(),{activePopup:y}=Wi(),x=u||g;return c.jsxs(ci.Suspense,{fallback:null,children:[c.jsx(UQ,{viewMode:"2D",view2DDirection:n,enabled:s&&o,showAxis:s&&a}),c.jsx("directionalLight",{position:[5,15,20],intensity:2.5,color:"#ffffff"}),c.jsx("directionalLight",{position:[-8,10,15],intensity:.6,color:"#ffffff"}),c.jsx("directionalLight",{position:[8,10,15],intensity:.6,color:"#ffffff"}),c.jsx("ambientLight",{intensity:.8,color:"#ffffff"}),((e==null?void 0:e.columns)||[]).map(S=>c.jsxs(ci.Fragment,{children:[c.jsx(NQ,{id:S.id,position:S.position,width:S.width,height:S.height||e.height||2400,depth:S.depth,color:S.color,hasBackPanelFinish:S.hasBackPanelFinish,spaceInfo:e,renderMode:"solid",onPositionChange:(I,j)=>{x(I,{position:j})},onRemove:I=>{v(I)}}),y.type==="columnEdit"&&y.id===S.id&&c.jsx(LQ,{column:S,spaceInfo:e,onPositionChange:(I,j)=>{x(I,{position:j})},onColumnUpdate:(I,j)=>{x(I,j)},showLabels:!0})]},S.id)),s&&i&&c.jsx(MQ,{viewMode:A,view2DDirection:n}),c.jsx(RQ,{viewDirection:n,showDimensions:s,showFurniture:l,isStep2:h}),n!=="top"&&c.jsx(gue,{spaceInfo:e}),c.jsx(OQ,{spaceInfo:e,showAll:i,showDimensions:s,viewMode:A}),console.log("🎯 QuadrantContent - Room 렌더링:",{viewDirection:n,spaceInfo:!!e,showFrame:r,placedModulesCount:(p==null?void 0:p.length)||0}),c.jsx(Mk,{spaceInfo:e,viewMode:"2D",view2DDirection:n,renderMode:f,showDimensions:s,showAll:i,showFurniture:l,isStep2:h,showFrame:r,materialConfig:t,placedModules:p,activeZone:d})]})},O5=ci.memo(Cue),_ue="_container_y1ww6_2",Sue="_section_y1ww6_9",Tue="_label_y1ww6_43",Bue="_disabledMessage_y1ww6_50",Eue="_inputLabel_y1ww6_60",Fue="_inputWrapper_y1ww6_119",kue="_inputWithUnit_y1ww6_125",Iue="_input_y1ww6_60",Due="_inputWithUnitField_y1ww6_148",jue="_unit_y1ww6_152",Pue="_inputError_y1ww6_161",Nue="_errorMessage_y1ww6_166",Lue="_toggleButtonGroup_y1ww6_218",Mue="_toggleButton_y1ww6_218",Rue="_toggleButtonActive_y1ww6_254",Uue="_disabledLabel_y1ww6_356",Oue="_disabledText_y1ww6_361",ki={container:_ue,section:Sue,label:Tue,disabledMessage:Bue,inputLabel:Eue,inputWrapper:Fue,inputWithUnit:kue,input:Iue,inputWithUnitField:Due,unit:jue,inputError:Pue,errorMessage:Nue,toggleButtonGroup:Lue,toggleButton:Mue,toggleButtonActive:Rue,disabledLabel:Uue,disabledText:Oue},HQ=({spaceInfo:n,onUpdate:e,disabled:t=!1})=>{const[i,r]=H.useState(),[s,o]=H.useState(!1),a=(n==null?void 0:n.width)||od.WIDTH,[l,h]=H.useState(a.toString());H.useEffect(()=>{h(a.toString())},[a]);const u=f=>{(f===""||/^\d+$/.test(f))&&h(f)},d=()=>{const f=l;if(f===""){h(a.toString());return}const p=parseInt(f),g=Oc.WIDTH.MIN,v=Oc.WIDTH.MAX;p<g?r(`최소 ${g}mm 이상이어야 합니다`):p>v?r(`최대 ${v}mm 이하여야 합니다`):(r(""),e({width:p}))},A=f=>{if(f.key==="Enter")d();else if(f.key==="ArrowUp"||f.key==="ArrowDown"){f.preventDefault();const p=parseInt(l)||a,g=Oc.WIDTH.MIN,v=Oc.WIDTH.MAX;let w;f.key==="ArrowUp"?w=Math.min(p+1,v):w=Math.max(p-1,g),w!==p&&(h(w.toString()),r(""),e({width:w}))}};return c.jsxs("div",{className:ki.inputWrapper,style:{position:"relative"},children:[s&&c.jsxs("label",{className:`${ki.inputLabel} ${t?ki.disabledLabel:""}`,style:{position:"absolute",bottom:"-20px",fontSize:"11px",color:"#5b21b6",zIndex:10},children:[Oc.WIDTH.MIN,"~",Oc.WIDTH.MAX,"mm",t&&c.jsx("span",{className:ki.disabledText,children:" (수정불가)"})]}),c.jsxs("div",{className:ki.inputWithUnit,children:[c.jsx("input",{type:"text",value:l,onChange:f=>u(f.target.value),onFocus:()=>o(!0),onBlur:()=>{o(!1),d()},onKeyDown:A,className:`${ki.input} ${ki.inputWithUnitField} ${i?ki.inputError:""}`,placeholder:`${Oc.WIDTH.MIN}-${Oc.WIDTH.MAX}`,disabled:t}),c.jsx("span",{className:ki.unit,children:"mm"})]}),i&&c.jsx("div",{className:ki.errorMessage,children:i})]})},WQ=({spaceInfo:n,onUpdate:e})=>{const[t,i]=H.useState(),[r,s]=H.useState(!1),o=(n==null?void 0:n.height)||od.HEIGHT,[a,l]=H.useState(o.toString());H.useEffect(()=>{l(o.toString())},[o]);const h=A=>{(A===""||/^\d+$/.test(A))&&l(A)},u=()=>{const A=a;if(A===""){l(o.toString());return}const f=parseInt(A),p=Oc.HEIGHT.MIN,g=Oc.HEIGHT.MAX;f<p?i(`최소 ${p}mm 이상이어야 합니다`):f>g?i(`최대 ${g}mm 이하여야 합니다`):(i(""),e({height:f}))},d=A=>{if(A.key==="Enter")u();else if(A.key==="ArrowUp"||A.key==="ArrowDown"){A.preventDefault();const f=parseInt(a)||o,p=Oc.HEIGHT.MIN,g=Oc.HEIGHT.MAX;let v;A.key==="ArrowUp"?v=Math.min(f+1,g):v=Math.max(f-1,p),v!==f&&(l(v.toString()),i(""),e({height:v}))}};return c.jsxs("div",{className:ki.inputWrapper,style:{position:"relative"},children:[r&&c.jsxs("label",{className:ki.inputLabel,style:{position:"absolute",bottom:"-20px",fontSize:"11px",color:"#5b21b6",zIndex:10},children:[Oc.HEIGHT.MIN,"~",Oc.HEIGHT.MAX,"mm"]}),c.jsxs("div",{className:ki.inputWithUnit,children:[c.jsx("input",{type:"text",value:a,onChange:A=>h(A.target.value),onFocus:()=>s(!0),onBlur:()=>{s(!1),u()},onKeyDown:d,className:`${ki.input} ${ki.inputWithUnitField} ${t?ki.inputError:""}`,placeholder:`${Oc.HEIGHT.MIN}-${Oc.HEIGHT.MAX}`}),c.jsx("span",{className:ki.unit,children:"mm"})]}),t&&c.jsx("div",{className:ki.errorMessage,children:t})]})},Hue="_container_jwj2m_2",Wue="_loadingOverlay_jwj2m_17",zue="_modalContent_jwj2m_32",Que="_header_jwj2m_55",$ue="_closeButton_jwj2m_62",Vue="_content_jwj2m_93",Gue="_leftSection_jwj2m_100",Xue="_toggleButton_jwj2m_122",Yue="_active_jwj2m_134",Kue="_editorViewer_jwj2m_144",que="_rightSection_jwj2m_157",Zue="_formContent_jwj2m_167",Jue="_divider_jwj2m_177",ede="_compactSection_jwj2m_184",tde="_compactLabel_jwj2m_190",nde="_sizeLabel_jwj2m_197",ide="_toggleButtonsWide_jwj2m_215",rde="_rangeInput_jwj2m_247",sde="_rangeValue_jwj2m_274",ode="_sizeInputs_jwj2m_371",ade="_numberInput_jwj2m_464",lde="_footer_jwj2m_488",cde="_previousButton_jwj2m_499",hde="_confirmButton_jwj2m_516",ude="_disabled_jwj2m_531",dde="_labelText_jwj2m_607",Ade="_unitText_jwj2m_613",fde="_inputField_jwj2m_618",pde="_wideInputField_jwj2m_631",jn={container:Hue,loadingOverlay:Wue,modalContent:zue,header:Que,closeButton:$ue,content:Vue,leftSection:Gue,toggleButton:Xue,active:Yue,editorViewer:Kue,rightSection:que,formContent:Zue,divider:Jue,compactSection:ede,compactLabel:tde,sizeLabel:nde,toggleButtonsWide:ide,rangeInput:rde,rangeValue:sde,sizeInputs:ode,numberInput:ade,footer:lde,previousButton:cde,confirmButton:hde,disabled:ude,labelText:dde,unitText:Ade,inputField:fde,wideInputField:pde},gde=({onPrevious:n,onClose:e,projectId:t,projectTitle:i})=>{var C,b,D,T,k,B,E,z,te,L,O,J,$,U,Y,K,V,Q,X,W,se,q,de,Ce,Se,fe,M,Z,Ae,ie;const{t:r}=yv(),s=ph(),[o,a]=H.useState(!1),l="3D",[h,u]=H.useState(0),{basicInfo:d,projectId:A,projectTitle:f}=Pl(),p=H.useRef(null),g=H.useRef(null);H.useEffect(()=>{p.current||(p.current=A||t||null),g.current||(g.current=f||i||null)},[]),H.useEffect(()=>{A&&(p.current=A),f&&(g.current=f)},[A,f]);const v=H.useMemo(()=>p.current||A||t||null,[A,t,p.current]),w=H.useMemo(()=>g.current||f||i||null,[f,i,g.current]);console.log("🔥 Step2 projectId/Title 확인:",{storeProjectId:A,propsProjectId:t,finalProjectId:v,storeProjectTitle:f,propsProjectTitle:i,finalProjectTitle:w});const{spaceInfo:m,setSpaceInfo:y}=hr(),{placedModules:x}=pi();H.useEffect(()=>{var ae,me;const ee={};m.surroundType||(ee.surroundType="no-surround",ee.frameSize={left:0,right:0,top:10},ee.gapConfig={left:m.installType==="builtin"||m.installType==="semistanding"&&((ae=m.wallConfig)!=null&&ae.left)?2:20,right:m.installType==="builtin"||m.installType==="semistanding"&&((me=m.wallConfig)!=null&&me.right)?2:20},ee.baseConfig={type:"floor",height:65,placementType:"ground"}),!m.customColumnCount&&!m.mainDoorCount&&(ee.customColumnCount=3),Object.keys(ee).length>0&&y({...m,...ee})},[]);const S=m.width>0&&m.height>0,I=ee=>{y({...m,...ee}),u(ae=>ae+1)};H.useEffect(()=>{u(ee=>ee+1)},[m.width,m.height,m.installType,(C=m.wallConfig)==null?void 0:C.left,(b=m.wallConfig)==null?void 0:b.right,m.surroundType,(D=m.gapConfig)==null?void 0:D.left,(T=m.gapConfig)==null?void 0:T.right]);const j=async()=>{if(!d.title||!d.location||!S){alert("모든 필수 정보를 입력해주세요.");return}a(!0);try{const ee=await Wr();if(!ee)throw new Error("사용자 정보를 찾을 수 없습니다.");const ae=Lo(),me={userId:ee.uid,basicInfo:{title:d.title,location:d.location,description:d.description||"",unitType:d.unitType||"household",category:d.category||"residential",createdAt:ae,updatedAt:ae,version:"1.0.0"},spaceConfig:m,customLayout:{wall:{type:m.surroundType==="surround"?"wall":"nowall",completed:!0},rack:{thickness:"2mm",completed:!1,options:{isComposite:!1}},motor:{type:"none",completed:!1},ventilation:{type:"none",completed:!1},exhaust:{type:"none",completed:!1}}},_e=v;if(!_e)throw new Error("프로젝트를 먼저 선택해주세요.");if(console.log("📋 기존 프로젝트에 디자인 파일 생성, 프로젝트 ID:",_e),_e){const ue=d.title||"새로운 디자인",Be=tC(m,x.length),it=await fk({name:ue,projectId:_e,spaceConfig:m,furniture:{placedModules:[]},thumbnail:Be});if(it.id){try{const De=new BroadcastChannel("project-updates");De.postMessage({type:"DESIGN_FILE_UPDATED",action:"design_created",projectId:_e,designFileId:it.id}),De.close()}catch(De){console.warn("BroadcastChannel 전송 실패 (무시 가능):",De)}e&&e(),setTimeout(()=>{s(`/configurator?projectId=${_e}&designFileId=${it.id}`,{replace:!0})},100)}else throw new Error(it.error||"디자인 파일 생성 실패")}}catch(ee){console.error("프로젝트 생성 오류:",ee),alert(`프로젝트 생성 중 오류가 발생했습니다: ${ee instanceof Error?ee.message:"알 수 없는 오류"}`)}finally{a(!1)}};return c.jsxs("div",{className:jn.container,"data-theme":"light",style:{colorScheme:"light"},children:[o&&c.jsx("div",{className:jn.loadingOverlay,children:c.jsx(k1,{message:"Loading",size:"large",type:"spinner"})}),c.jsxs("div",{className:jn.modalContent,children:[c.jsxs("div",{className:jn.header,children:[c.jsx("button",{className:jn.closeButton,"aria-label":"닫기",onClick:e,children:"×"}),c.jsx("div",{children:c.jsxs("h1",{children:["STEP. 2 공간 설정",w&&c.jsxs("span",{style:{marginLeft:"20px",fontSize:"0.8em",color:"#666"},children:["프로젝트: ",w," / 디자인: ",d.title||"새 디자인"," / ",d.location||"위치 미정"]})]})})]}),c.jsxs("div",{className:jn.content,children:[c.jsx("div",{className:jn.leftSection,children:c.jsx("div",{className:jn.editorViewer,children:c.jsx(O5,{spaceInfo:m,viewMode:l,renderMode:"solid",showAll:!0,showDimensions:!0,showFrame:!0,isEmbedded:!0,isStep2:!0,setViewMode:()=>{}},`${h}-${(k=m.wallConfig)!=null&&k.left?"L":"R"}-${(B=m.gapConfig)==null?void 0:B.left}-${(E=m.gapConfig)==null?void 0:E.right}`)})}),c.jsx("div",{className:jn.rightSection,children:c.jsxs("div",{className:jn.formContent,children:[c.jsxs("div",{className:jn.compactSection,children:[c.jsx("label",{className:jn.compactLabel,children:r("space.installType")}),c.jsxs("div",{className:jn.toggleButtonsWide,children:[c.jsx("button",{className:`${jn.toggleButton} ${m.installType==="builtin"?jn.active:""}`,onClick:()=>{const ee={installType:"builtin"};ee.wallConfig={left:!0,right:!0},ee.gapConfig={left:2,right:2},I(ee)},title:r("space.builtinDesc"),children:r("space.builtin")}),c.jsx("button",{className:`${jn.toggleButton} ${m.installType==="semistanding"?jn.active:""}`,onClick:()=>{const ee={installType:"semistanding"};ee.wallConfig={left:!0,right:!1},ee.gapConfig={left:2,right:20},I(ee)},title:r("space.semistandingDesc"),children:r("space.semistanding")}),c.jsx("button",{className:`${jn.toggleButton} ${m.installType==="freestanding"?jn.active:""}`,onClick:()=>{const ee={installType:"freestanding"};ee.wallConfig={left:!1,right:!1},ee.gapConfig={left:20,right:20},I(ee)},title:r("space.freestandingDesc"),children:r("space.freestanding")})]})]}),m.installType==="semistanding"&&c.jsxs("div",{className:jn.compactSection,children:[c.jsx("label",{className:jn.compactLabel,children:r("space.wallPosition")}),c.jsxs("div",{className:jn.toggleButtonsWide,children:[c.jsx("button",{className:`${jn.toggleButton} ${(z=m.wallConfig)!=null&&z.left?jn.active:""}`,onClick:()=>I({wallConfig:{left:!0,right:!1},gapConfig:{left:2,right:20}}),children:r("furniture.left")}),c.jsx("button",{className:`${jn.toggleButton} ${(te=m.wallConfig)!=null&&te.right?jn.active:""}`,onClick:()=>I({wallConfig:{left:!1,right:!0},gapConfig:{left:20,right:2}}),children:r("furniture.right")})]})]}),c.jsxs("div",{className:jn.compactSection,children:[c.jsx("label",{className:jn.compactLabel,children:r("space.title")}),c.jsxs("div",{className:jn.sizeInputs,children:[c.jsx("span",{className:jn.sizeLabel,children:"W"}),c.jsx(HQ,{spaceInfo:m,onUpdate:I}),c.jsx("span",{className:jn.sizeLabel,children:"H"}),c.jsx(WQ,{spaceInfo:m,onUpdate:I})]})]}),c.jsxs("div",{className:jn.compactSection,children:[c.jsx("label",{className:jn.compactLabel,children:r("space.droppedCeiling")}),c.jsxs("div",{className:jn.toggleButtonsWide,children:[c.jsx("button",{className:`${jn.toggleButton} ${(L=m.droppedCeiling)!=null&&L.enabled?"":jn.active}`,onClick:()=>I({droppedCeiling:{...m.droppedCeiling,enabled:!1}}),children:r("common.none")}),c.jsx("button",{className:`${jn.toggleButton} ${(O=m.droppedCeiling)!=null&&O.enabled?jn.active:""}`,onClick:()=>{var ee,ae,me;return I({droppedCeiling:{enabled:!0,position:((ee=m.droppedCeiling)==null?void 0:ee.position)||"left",width:((ae=m.droppedCeiling)==null?void 0:ae.width)||DEFAULT_DROPPED_CEILING_VALUES.WIDTH,dropHeight:((me=m.droppedCeiling)==null?void 0:me.dropHeight)||300}})},children:r("common.enabled")})]})]}),((J=m.droppedCeiling)==null?void 0:J.enabled)&&c.jsxs("div",{className:jn.compactSection,children:[c.jsx("label",{className:jn.compactLabel,children:r("placement.placementType")}),c.jsxs("div",{className:jn.toggleButtonsWide,children:[c.jsx("button",{className:`${jn.toggleButton} ${(($=m.droppedCeiling)==null?void 0:$.position)==="left"?jn.active:""}`,onClick:()=>I({droppedCeiling:{...m.droppedCeiling,position:"left"}}),children:r("furniture.left")}),c.jsx("button",{className:`${jn.toggleButton} ${((U=m.droppedCeiling)==null?void 0:U.position)==="right"?jn.active:""}`,onClick:()=>I({droppedCeiling:{...m.droppedCeiling,position:"right"}}),children:r("furniture.right")})]})]}),c.jsxs("div",{className:jn.compactSection,children:[c.jsx("label",{className:jn.compactLabel,children:((Y=m.droppedCeiling)!=null&&Y.enabled,r("space.columnCount"))}),(()=>{var Be,it,De;const ee=Kr(m);let ae=ee.width;if((Be=m.droppedCeiling)!=null&&Be.enabled){const qe=m.droppedCeiling.width||DEFAULT_DROPPED_CEILING_VALUES.WIDTH;ae=ee.width-qe}const me=ar.getColumnLimits(ae);me.maxColumns;const _e=(it=m.droppedCeiling)!=null&&it.enabled?m.mainDoorCount||m.customColumnCount||me.minColumns:m.customColumnCount||me.minColumns,ue=Math.max(me.minColumns,Math.min(me.maxColumns,_e));return ue!==_e&&((De=m.droppedCeiling)!=null&&De.enabled?I({mainDoorCount:ue}):I({customColumnCount:ue})),c.jsxs(c.Fragment,{children:[c.jsx("input",{type:"range",min:me.minColumns,max:me.maxColumns,value:ue,onChange:qe=>{var Me;const Je=parseInt(qe.target.value);(Me=m.droppedCeiling)!=null&&Me.enabled?I({mainDoorCount:Je}):I({customColumnCount:Je})},className:jn.rangeInput}),c.jsx("span",{className:jn.rangeValue,children:ue})]})})()]}),((K=m.droppedCeiling)==null?void 0:K.enabled)&&c.jsxs("div",{className:jn.compactSection,children:[c.jsx("label",{className:jn.compactLabel,children:r("space.droppedColumnCount")}),(()=>{const ee=m.droppedCeiling.width||DEFAULT_DROPPED_CEILING_VALUES.WIDTH,ae=m.surroundType==="surround"?50:0,me=ee-ae,_e=ar.getColumnLimits(me),ue=m.droppedCeilingDoorCount||_e.minColumns,Be=Math.max(_e.minColumns,Math.min(_e.maxColumns,ue));return c.jsxs(c.Fragment,{children:[c.jsx("input",{type:"range",min:_e.minColumns,max:_e.maxColumns,value:Be,onChange:it=>I({droppedCeilingDoorCount:parseInt(it.target.value)}),className:jn.rangeInput}),c.jsx("span",{className:jn.rangeValue,children:Be})]})})()]}),c.jsx("div",{className:jn.divider}),c.jsxs("div",{className:jn.compactSection,children:[c.jsx("label",{className:jn.compactLabel,children:"프레임 설정"}),c.jsxs("div",{className:jn.toggleButtonsWide,children:[c.jsx("button",{className:`${jn.toggleButton} ${m.surroundType==="surround"?jn.active:""}`,onClick:()=>I({surroundType:"surround",frameSize:m.frameSize||{left:50,right:50,top:10}}),children:r("space.surround")}),c.jsx("button",{className:`${jn.toggleButton} ${m.surroundType==="no-surround"?jn.active:""}`,onClick:()=>{var ee,ae;return I({surroundType:"no-surround",frameSize:{left:0,right:0,top:10},gapConfig:{left:m.installType==="builtin"||m.installType==="semistanding"&&((ee=m.wallConfig)!=null&&ee.left)?2:20,right:m.installType==="builtin"||m.installType==="semistanding"&&((ae=m.wallConfig)!=null&&ae.right)?2:20}})},children:r("space.noSurround")})]})]}),m.surroundType==="surround"&&c.jsxs("div",{className:jn.compactSection,children:[c.jsx("label",{className:jn.compactLabel,children:"프레임 두께"}),c.jsx("div",{className:jn.sizeInputs,children:c.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:[c.jsx("span",{className:jn.labelText,children:"좌"}),c.jsx("input",{type:"number",className:jn.numberInput,value:((V=m.frameSize)==null?void 0:V.left)||50,onChange:ee=>I({frameSize:{...m.frameSize,left:parseInt(ee.target.value)||50}}),min:"40",max:"100"}),c.jsx("span",{className:jn.labelText,children:"우"}),c.jsx("input",{type:"number",className:jn.numberInput,value:((Q=m.frameSize)==null?void 0:Q.right)||50,onChange:ee=>I({frameSize:{...m.frameSize,right:parseInt(ee.target.value)||50}}),min:"40",max:"100"}),c.jsx("span",{className:jn.labelText,children:"상"}),c.jsx("input",{type:"number",className:jn.numberInput,value:((X=m.frameSize)==null?void 0:X.top)||10,onChange:ee=>I({frameSize:{...m.frameSize,top:parseInt(ee.target.value)||10}}),min:"10",max:"200"}),c.jsx("span",{className:jn.unitText,children:"mm"})]})})]}),m.surroundType==="no-surround"&&c.jsxs("div",{className:jn.compactSection,children:[c.jsx("label",{className:jn.compactLabel,children:"이격거리"}),c.jsx("div",{className:jn.sizeInputs,children:c.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:[c.jsx("span",{className:jn.labelText,children:"좌"}),c.jsx("input",{type:"number",className:jn.inputField,value:((W=m.gapConfig)==null?void 0:W.left)||2,onChange:ee=>I({gapConfig:{...m.gapConfig,left:parseInt(ee.target.value)||2}}),min:"2",max:"50",disabled:m.installType==="builtin"||m.installType==="semistanding"&&((se=m.wallConfig)==null?void 0:se.left)}),c.jsx("span",{className:jn.labelText,children:"우"}),c.jsx("input",{type:"number",className:jn.inputField,value:((q=m.gapConfig)==null?void 0:q.right)||2,onChange:ee=>I({gapConfig:{...m.gapConfig,right:parseInt(ee.target.value)||2}}),min:"2",max:"50",disabled:m.installType==="builtin"||m.installType==="semistanding"&&((de=m.wallConfig)==null?void 0:de.right)}),c.jsx("span",{className:jn.unitText,children:"mm"})]})})]}),c.jsxs("div",{className:jn.compactSection,children:[c.jsx("label",{className:jn.compactLabel,children:"배치 설정"}),c.jsxs("div",{className:jn.toggleButtonsWide,children:[c.jsx("button",{className:`${jn.toggleButton} ${((Ce=m.baseConfig)==null?void 0:Ce.type)==="floor"||!m.baseConfig?jn.active:""}`,onClick:()=>{var ee;return I({baseConfig:{...m.baseConfig,type:"floor",height:((ee=m.baseConfig)==null?void 0:ee.height)||65,placementType:"ground"}})},children:"바닥에 배치"}),c.jsx("button",{className:`${jn.toggleButton} ${((Se=m.baseConfig)==null?void 0:Se.type)==="stand"?jn.active:""}`,onClick:()=>{var ee;return I({baseConfig:{...m.baseConfig,type:"stand",placementType:"float",floatHeight:((ee=m.baseConfig)==null?void 0:ee.floatHeight)||200}})},children:"띄워서 배치"})]})]}),(((fe=m.baseConfig)==null?void 0:fe.type)==="floor"||!m.baseConfig)&&c.jsxs("div",{className:jn.compactSection,children:[c.jsx("label",{className:jn.compactLabel,children:"높이"}),c.jsxs("div",{className:jn.sizeInputs,children:[c.jsx("input",{type:"number",className:jn.wideInputField,value:((M=m.baseConfig)==null?void 0:M.height)||65,onChange:ee=>I({baseConfig:{...m.baseConfig,type:"floor",height:parseInt(ee.target.value)||65}}),min:"50",max:"500"}),c.jsx("span",{className:jn.unitText,children:"mm"})]})]}),((Z=m.baseConfig)==null?void 0:Z.type)==="stand"&&c.jsxs("div",{className:jn.compactSection,children:[c.jsx("label",{className:jn.compactLabel,children:"높이"}),c.jsxs("div",{className:jn.sizeInputs,children:[c.jsx("input",{type:"number",className:jn.wideInputField,value:((Ae=m.baseConfig)==null?void 0:Ae.floatHeight)||200,onChange:ee=>I({baseConfig:{...m.baseConfig,type:"stand",placementType:"float",floatHeight:parseInt(ee.target.value)||200}}),min:"100",max:"500"}),c.jsx("span",{className:jn.unitText,children:"mm"})]})]}),c.jsxs("div",{className:jn.compactSection,children:[c.jsx("label",{className:jn.compactLabel,children:"바닥 마감재"}),c.jsxs("div",{className:jn.toggleButtonsWide,children:[c.jsx("button",{className:`${jn.toggleButton} ${m.hasFloorFinish?jn.active:""}`,onClick:()=>I({hasFloorFinish:!0,floorFinish:m.floorFinish||{height:10}}),children:r("common.enabled")}),c.jsx("button",{className:`${jn.toggleButton} ${m.hasFloorFinish?"":jn.active}`,onClick:()=>I({hasFloorFinish:!1}),children:r("common.none")})]})]}),m.hasFloorFinish&&c.jsxs("div",{className:jn.compactSection,children:[c.jsx("label",{className:jn.compactLabel,children:"마감재 두께"}),c.jsxs("div",{className:jn.sizeInputs,children:[c.jsx("input",{type:"number",className:jn.wideInputField,value:((ie=m.floorFinish)==null?void 0:ie.height)||10,onChange:ee=>I({floorFinish:{height:parseInt(ee.target.value)||10}}),min:"5",max:"50"}),c.jsx("span",{className:jn.unitText,children:"mm"})]})]})]})})]}),c.jsxs("div",{className:jn.footer,children:[c.jsx("button",{className:jn.previousButton,onClick:n,children:"이전"}),c.jsx("button",{className:`${jn.confirmButton} ${S?"":jn.disabled}`,onClick:j,disabled:!S||o,children:"시작하기"})]})]})]})},mde="_stepContainer_39rqh_2",yde={stepContainer:mde},wde=({onClose:n,projectId:e,projectTitle:t})=>{const[i,r]=H.useState(1),[s,o]=tF(),{projectId:a}=Pl();H.useEffect(()=>{a&&i===2&&(s.set("projectId",a),o(s))},[a,i]);const l=()=>{i<2&&r(A=>A+1)},h=()=>{i>1&&r(A=>A-1)},u=()=>{n&&n()},d=()=>{switch(i){case 1:return c.jsx(Rle,{onNext:l,onClose:u,projectId:e,projectTitle:t});case 2:return c.jsx(gde,{onPrevious:h,onClose:u,projectId:a||e,projectTitle:t});default:return null}};return c.jsx("div",{className:yde.stepContainer,children:d()})},vde="_loadingScreen_153kc_229",xde="_loadingSubtext_153kc_243",tP={loadingScreen:vde,loadingSubtext:xde},cE=({onClose:n,projectId:e,projectTitle:t})=>{const i=ph(),[r]=tF(),[s,o]=H.useState(!1),{setBasicInfo:a,resetAll:l}=Pl(),{setSpaceInfo:h,resetAll:u}=hr(),{clearAllModules:d,setPlacedModules:A}=pi(),f=async g=>{o(!0);try{const{project:v,error:w}=await Qy(g);if(w){console.error("프로젝트 로드 에러:",w),alert("프로젝트를 불러오는데 실패했습니다: "+w),i("/dashboard");return}v&&(a(v.projectData),h(v.spaceConfig),A(v.furniture.placedModules),console.log("✅ 프로젝트 로드 성공:",v.title))}catch(v){console.error("프로젝트 로드 실패:",v),alert("프로젝트 로드 중 오류가 발생했습니다."),i("/dashboard")}finally{o(!1)}};if(H.useEffect(()=>{const g=r.get("projectId");g?f(g):(l(),u(),d())},[]),s)return c.jsxs("div",{className:tP.loadingScreen,children:[c.jsx(k1,{message:"프로젝트를 불러오는 중...",size:"large",type:"spinner"}),c.jsx("p",{className:tP.loadingSubtext,children:"잠시만 기다려주세요."})]});const p=()=>{n?n():i("/dashboard")};return c.jsx("div",{"data-theme":"light",style:{colorScheme:"light"},children:c.jsx(wde,{onClose:p,projectId:e,projectTitle:t})})},bde=({setPlacedModules:n})=>{const[e,t]=H.useState(!1);H.useCallback((r,s)=>{console.log("🚨🚨🚨 [SPACE ADAPTER] updateFurnitureForNewSpace 호출됨 - 설치타입 변경:",{oldInstallType:r.installType,newInstallType:s.installType,oldSurroundType:r.surroundType,newSurroundType:s.surroundType,oldWidth:r.width,newWidth:s.width,oldColumnCount:r.customColumnCount,newColumnCount:s.customColumnCount,중요:"컬럼수가 동일해도 설치타입 변경시 내부 공간이 달라짐"}),console.trace("🚨 [TRACE] updateFurnitureForNewSpace 호출 스택"),n(o=>{var p,g,v,w,m,y;if(console.log("🚨🚨🚨 [SPACE ADAPTER] setPlacedModules 시작:",{currentModulesCount:o.length,currentModules:o.map(x=>({id:x.id,moduleId:x.moduleId,slotIndex:x.slotIndex,position:x.position,isValidInCurrentSpace:x.isValidInCurrentSpace}))}),o.length===0)return o;const a=pr(r),l=pr(s);console.log("🔍 슬롯 위치 재계산 (공간 설정 변경):",{설치타입:`${r.installType} → ${s.installType}`,서라운드:`${r.surroundType} → ${s.surroundType}`,슬롯개수:`${a.columnCount} → ${l.columnCount}`,내경너비:`${a.internalWidth}mm → ${l.internalWidth}mm`,슬롯너비:`${a.columnWidth}mm → ${l.columnWidth}mm`,첫슬롯위치:(p=a.threeUnitPositions)!=null&&p[0]&&((g=l.threeUnitPositions)!=null&&g[0])?`${a.threeUnitPositions[0].toFixed(3)} → ${l.threeUnitPositions[0].toFixed(3)} (차이: ${((l.threeUnitPositions[0]-a.threeUnitPositions[0])*1e3).toFixed(1)}mm)`:"N/A",마지막슬롯위치:a.threeUnitPositions&&l.threeUnitPositions?`${(v=a.threeUnitPositions[a.threeUnitPositions.length-1])==null?void 0:v.toFixed(3)} → ${(w=l.threeUnitPositions[l.threeUnitPositions.length-1])==null?void 0:w.toFixed(3)} (차이: ${((l.threeUnitPositions[l.threeUnitPositions.length-1]-a.threeUnitPositions[a.threeUnitPositions.length-1])*1e3).toFixed(1)}mm)`:"N/A"}),r.installType==="semistanding"&&s.installType==="semistanding"&&r.width===s.width&&((m=r.wallConfig)==null?void 0:m.left)!==((y=s.wallConfig)==null?void 0:y.left)&&a.columnWidth===l.columnWidth&&console.log("🔄 세미스탠딩 벽 위치만 변경됨 - 가구 너비는 유지하되 위치는 재계산 필요"),console.log("🔍 인덱싱 변화 상세:",{oldColumnCount:a.columnCount,newColumnCount:l.columnCount,컬럼수동일:a.columnCount===l.columnCount,oldColumnWidth:a.columnWidth,newColumnWidth:l.columnWidth,컬럼너비동일:a.columnWidth===l.columnWidth,설치타입변경:`${r.installType} → ${s.installType}`,중요:"컬럼수가 동일해도 내부 위치는 변경될 수 있음"});const u=[];console.log("🔴🔴🔴 가구 업데이트 전 상태:",{설치타입변경:`${r.installType} → ${s.installType}`,전체가구수:o.length,각가구정보:o.map(x=>{var S;return{id:x.id,moduleId:x.moduleId,slotIndex:x.slotIndex,position:(S=x.position)==null?void 0:S.x,isValid:x.isValidInCurrentSpace}})});const d=[...o].sort((x,S)=>{const I=x.slotIndex??0;return(S.slotIndex??0)-I});console.log("🔄 가구 정렬 완료:",{originalOrder:o.map(x=>({id:x.id,slot:x.slotIndex})),sortedOrder:d.map(x=>({id:x.id,slot:x.slotIndex})),설명:"우측 가구부터 처리하여 공간 축소시 좌측으로 압축"});const A=a.threeUnitPositions.length,f=l.threeUnitPositions.length;return d.forEach((x,S)=>{var j,C,b,D,T,k,B,E,z,te,L;let I=x.zone;if(!I&&x.position&&x.position.x!==void 0){const O=x.position.x*1e3;if((j=r.droppedCeiling)!=null&&j.enabled&&a.zones){const J=ar.findZoneAndSlotFromPosition({x:O},r,a);J&&(I=J.zone,console.log("🔍 기존 가구 zone 추론:",{moduleId:x.moduleId,position:x.position.x,추론된zone:I}))}I||(I="normal")}if(console.log(`
🔴🔴🔴 [가구 ${S+1}/${d.length}] 처리 시작 🔴🔴🔴`,{id:x.id,moduleId:x.moduleId,현재슬롯:x.slotIndex,현재위치X:(C=x.position)==null?void 0:C.x,zone:I,originalZone:x.zone,hasZone:!!x.zone,droppedCeilingEnabled:(b=s.droppedCeiling)==null?void 0:b.enabled,willProcessAsZone:!!(I&&((D=s.droppedCeiling)!=null&&D.enabled)),isDualSlot:x.isDualSlot,설치타입:`${r.installType} → ${s.installType}`}),x.zone=I,x.zone&&x.zone!=="normal"&&((T=s.droppedCeiling)!=null&&T.enabled)){console.log("🔍 Zone 가구 처리 시작:",{moduleId:x.moduleId,zone:x.zone,customWidth:x.customWidth,isDualSlot:x.isDualSlot});const O=ar.calculateZoneSlotInfo(s,s.customColumnCount);!O.dropped&&x.zone==="dropped"&&(console.log("⚠️ 단내림 제거됨 - 가구를 일반 영역으로 이동:",x.moduleId),x.zone="normal");const J=x.zone==="dropped"&&O.dropped?O.dropped:O.normal,$={...s,width:J.width,customColumnCount:J.columnCount},U={...Kr(s),width:J.width,startX:J.startX};if(!Zi(x.moduleId,U,$))console.error("❌ ZONE 가구: moduleData 없음 - 가구 보존",{moduleId:x.moduleId,zone:x.zone}),u.push({...x,isValidInCurrentSpace:!0});else{let K=x.slotIndex||0;K>=J.columnCount&&(console.log("⚠️ Zone 가구 슬롯 범위 초과:",{moduleId:x.moduleId,zone:x.zone,원래슬롯:K,최대슬롯:J.columnCount-1}),K=J.columnCount-1),console.log("🎯 Zone 가구 슬롯 유지:",{moduleId:x.moduleId,zone:x.zone,원래슬롯:x.slotIndex,새슬롯:K});const V=x.moduleId.startsWith("dual-"),Q=J.startX+K*J.columnWidth+(V?J.columnWidth:J.columnWidth/2),X=x.moduleId.replace(/-\d+$/,""),W=`${X}-${J.columnWidth*(V?2:1)}`;console.log("🔄 Zone 가구 업데이트:",{originalModuleId:x.moduleId,baseType:X,isDual:V,zone:x.zone,targetZone:J,slotIndex:K,newX:Q*.01,newModuleId:W,oldWidth:x.customWidth||x.adjustedWidth,newWidth:J.columnWidth*(V?2:1),targetZoneSlotWidths:J.slotWidths}),u.push({...x,moduleId:W,position:{...x.position,x:Q*.01},isValidInCurrentSpace:!0,adjustedWidth:void 0,customWidth:void 0,isDualSlot:V}),console.log("✅ ZONE 가구 처리 완료",{moduleId:x.id,새슬롯:K,새위치:Q*.01})}}else{console.log("📦 일반 가구 처리 시작:",{moduleId:x.moduleId,slotIndex:x.slotIndex});const O=Kr(r),J=Zi(x.moduleId,O,r);let $=x.slotIndex;if($===void 0&&J){const Se=Math.abs(J.dimensions.width-a.columnWidth*2)<50;$=Toe(x.position,a,Se)}($===void 0||$<0)&&(console.log("⚠️ 슬롯 인덱스 없음 - 첫 번째 슬롯으로 이동:",x.moduleId),$=0);let U=$;U>=f&&(console.log("⚠️ 슬롯 범위 초과 - 마지막 슬롯으로:",{원래슬롯:$,새슬롯수:f}),U=f-1),console.log("🎯 슬롯 유지:",{원래슬롯:$,새슬롯:U,슬롯수변경:`${A} → ${f}`}),$=U;let Y=x.moduleId,K=!1;const V=[/^dual-([^-]+(?:-[^-]+)*)-(\d+)$/];for(const Se of V){const fe=x.moduleId.match(Se);if(fe){const M=parseInt(fe[2]);if(Math.abs(M-a.columnWidth*2)<50){Y=x.moduleId.replace(Se,`dual-$1-${l.columnWidth*2}`),K=!0;break}}}if(!K){const Se=[/^single-([^-]+(?:-[^-]+)*)-(\d+)$/];let fe=!1;for(const M of Se)if(x.moduleId.match(M)){Y=x.moduleId.replace(M,`single-$1-${l.columnWidth}`),fe=!0;break}fe||(Y=`single-open-${l.columnWidth}`)}console.log("📍 슬롯 검증:",{moduleId:x.moduleId,slotIndex:$,newColumnCount:l.columnCount,유효함:$<l.columnCount,isDualModule:K}),$>=l.columnCount&&l.columnCount>0&&(console.error("⚠️ 버그: 가장 가까운 슬롯이 범위를 벗어남!",{slotIndex:$,maxIndex:l.columnCount-1}),$=l.columnCount-1);let Q=l.columnCount;if(x.zone&&((k=s.droppedCeiling)!=null&&k.enabled)){const Se=ar.calculateZoneSlotInfo(s,s.customColumnCount);x.zone==="dropped"&&Se.dropped?Q=Se.dropped.columnCount:x.zone==="normal"&&(Q=Se.normal.columnCount)}K&&$+1>=Q&&(Y=Y.replace(/^dual-/,"single-").replace(/-(\d+)$/,`-${l.columnWidth}`),K=!1),console.log("✅ 충돌 검사 스킵 - 슬롯 인덱스 유지:",{moduleId:x.moduleId,slotIndex:$,isDualModule:K});let X,W="normal",se;if((B=s.droppedCeiling)!=null&&B.enabled&&l.zones)if(l.threeUnitPositions&&$<l.threeUnitPositions.length){const Se=l.threeUnitPositions[$]*1e3,fe=ar.findZoneAndSlotFromPosition({x:Se},s,l);if(fe){W=fe.zone;const M=W==="dropped"&&l.zones.dropped?l.zones.dropped:l.zones.normal;X=(M.startX+fe.slotIndex*M.columnWidth+M.columnWidth/2)*.001,W==="dropped"&&(se=M.columnWidth)}else K&&l.threeUnitDualPositions?$<l.threeUnitDualPositions.length?X=l.threeUnitDualPositions[$]:X=l.threeUnitDualPositions[l.threeUnitDualPositions.length-1]||0:l.threeUnitPositions?X=l.threeUnitPositions[$]||l.threeUnitPositions[l.threeUnitPositions.length-1]||0:X=0}else console.warn("⚠️ 단내림 영역에서 슬롯 인덱스 범위 초과:",{slotIndex:$,availableSlots:((E=l.threeUnitPositions)==null?void 0:E.length)||0}),K&&l.threeUnitDualPositions&&l.threeUnitDualPositions.length>0?X=l.threeUnitDualPositions[l.threeUnitDualPositions.length-1]:l.threeUnitPositions&&l.threeUnitPositions.length>0?X=l.threeUnitPositions[l.threeUnitPositions.length-1]:X=0;else if(K&&l.threeUnitDualPositions){if($<l.threeUnitDualPositions.length?X=l.threeUnitDualPositions[$]:(console.warn("⚠️ 듀얼 가구 슬롯 인덱스 범위 초과:",{slotIndex:$,availableDualSlots:l.threeUnitDualPositions.length,using:"last dual position"}),X=l.threeUnitDualPositions[l.threeUnitDualPositions.length-1]||0),s.surroundType==="no-surround"){const Se=$===l.columnCount-2;$===0&&(s.installType==="freestanding"||s.installType==="semistanding"&&((z=s.wallConfig)!=null&&z.right))?console.log("🔄 듀얼 가구 첫번째 슬롯 (공간 변경) - FurnitureItem에서 엔드패널 조정 예정"):Se&&(s.installType==="freestanding"||s.installType==="semistanding"&&((te=s.wallConfig)!=null&&te.left))&&console.log("🔄 듀얼 가구 마지막 슬롯 (공간 변경) - FurnitureItem에서 엔드패널 조정 예정")}console.log("🔄 듀얼 가구 위치 (공간 변경):",{slotIndex:$,newX:X,surroundType:s.surroundType,installType:s.installType,wallConfig:s.wallConfig,설명:"기본 경계 위치 사용 (FurnitureItem에서 엔드패널 조정 적용)"})}else l.threeUnitPositions?$<l.threeUnitPositions.length?X=l.threeUnitPositions[$]:(console.warn("⚠️ 싱글 가구 슬롯 인덱스 범위 초과:",{slotIndex:$,availableSlots:l.threeUnitPositions.length,using:"last position"}),X=l.threeUnitPositions[l.threeUnitPositions.length-1]||0):(console.error("❌ 위치 배열이 없음:",{slotIndex:$,hasThreeUnitPositions:!!l.threeUnitPositions,hasThreeUnitDualPositions:!!l.threeUnitDualPositions}),X=0);let q;s.surroundType==="surround"&&(l.slotWidths&&l.slotWidths[$]!==void 0?K&&$+1<l.slotWidths.length?q=l.slotWidths[$]+l.slotWidths[$+1]:q=l.slotWidths[$]:W==="dropped"&&se&&(q=se));const Ce=Math.abs(X-x.position.x)*1e3;Ce>1&&console.log(`🔄 [${x.moduleId}] 위치 변경 감지:`,{슬롯:$,"이전 위치 (Three.js)":x.position.x.toFixed(4),"새 위치 (Three.js)":X.toFixed(4),"차이 (mm)":Ce.toFixed(1),설치타입:`${r.installType} → ${s.installType}`,서라운드:`${r.surroundType} → ${s.surroundType}`,isDualModule:K,슬롯너비:(L=l.slotWidths)==null?void 0:L[$],커스텀너비:q}),u.push({...x,moduleId:Y,position:{...x.position,x:X},slotIndex:$,isDualSlot:Y.includes("dual"),isValidInCurrentSpace:!0,zone:W,customWidth:q,adjustedWidth:void 0}),console.log("✅ 일반 가구 처리 완료",{moduleId:x.id,원래슬롯:x.slotIndex,새슬롯:$,새위치X:X.toFixed(4),업데이트된가구수:u.length})}}),console.log(`
🔥🔥🔥🔥🔥 [SPACE ADAPTER] 업데이트 완료 - 가구 보존 확인 🔥🔥🔥🔥🔥`,{원래가구수:o.length,업데이트된가구수:u.length,가구손실:o.length-u.length,문제:o.length!==u.length?"⚠️ 가구가 사라졌음!":"✅ 모든 가구 보존됨",업데이트된가구:u.map(x=>{var S;return{id:x.id,moduleId:x.moduleId,slotIndex:x.slotIndex,positionX:(S=x.position)==null?void 0:S.x,isValid:x.isValidInCurrentSpace,zone:x.zone}}),사라진가구:o.filter(x=>!u.find(S=>S.id===x.id)).map(x=>({id:x.id,moduleId:x.moduleId,slotIndex:x.slotIndex,이유:"return으로 인한 스킵"}))}),o.length!==u.length&&console.error("🔥🔥🔥 가구가 사라졌습니다! 이것은 버그입니다!",{사라진개수:o.length-u.length}),u})},[n]);const i=H.useCallback((r,s)=>(console.log("🔄 updateFurnitureForNewSpace 호출 - 위치만 업데이트"),n(o=>{if(o.length===0)return o;const a=pr(s);return o.map(l=>{if(l.slotIndex===void 0)return l;let h=l.slotIndex;h>=a.columnCount&&(h=Math.max(0,a.columnCount-1));let u=l.position.x;return a.threeUnitPositions&&h<a.threeUnitPositions.length&&(u=a.threeUnitPositions[h]),{...l,position:{...l.position,x:u},slotIndex:h,isValidInCurrentSpace:!0,customWidth:void 0,adjustedWidth:void 0}})})),[n]);return{spaceChangeMode:e,setSpaceChangeMode:t,updateFurnitureForNewSpace:i}};function Cde(n){const e=Math.sqrt(Math.pow(n,2)+Math.pow(n,2))/2;return-(n-Math.sqrt(Math.pow(n,2)-Math.pow(e,2)))/e}function bt(n,e,t){return{x:n??0,y:e??0,z:t??0}}function la(n,e){return{x:n??0,y:e??0}}let mA=class iC{static next(){return(++iC.seed).toString(16).toUpperCase()}static peek(){return(iC.seed+1).toString(16).toUpperCase()}static clear(){iC.seed=0}};mA.seed=0;let _de=class{constructor(){this.handle=mA.next()}dxfy(e){e.type("ENDBLK"),e.handle(this.handle),e.push(330,this.ownerObjectHandle),e.subclassMarker("AcDbEntity"),e.layerName("0"),e.subclassMarker("AcDbBlockEnd")}};const Ax=(n,e)=>({tl:n,br:e});let ya=class hE{static centerRadiusBBox(e,t){return Ax(bt(e.x-t,e.y+t),bt(e.x+t,e.y-t))}static pointBBox(e){return Ax(bt(e.x-100,e.y+100),bt(e.x+100,e.y-100))}static lineBBox(e,t){const i=e.x>t.x?e.x:t.x,r=e.x<t.x?e.x:t.x,s=e.y>t.y?e.y:t.y,o=e.y<t.y?e.y:t.y,a=e.z>t.z?e.z:t.z,l=e.z<t.z?e.z:t.z;return Ax(bt(r,s,l),bt(i,o,a))}static verticesBBox(e){let t=-1/0,i=-1/0,r=1/0,s=1/0;for(let o=0;o<e.length;o++){const{x:a,y:l}=e[o];t<a&&(t=a),i<l&&(i=l),r>a&&(r=a),s>l&&(s=l)}return Ax(bt(r,i),bt(t,s))}static boundingBox(e){if(e.length===0)return hE.pointBBox(bt());const t=[];for(let i=0;i<e.length;i++){const r=e[i];t.push(r.tl,r.br)}return hE.verticesBBox(t)}static boundingBoxCenter(e){return bt(e.tl.x+(e.br.x-e.tl.x)/2,e.br.y+(e.tl.y-e.br.y)/2,0)}static boundingBoxHeight(e){return e.tl.y-e.br.y}};var t_,uE,dE;(function(n){n[n.None=0]="None",n[n.Frozen=1]="Frozen",n[n.FrozenInNewViewports=2]="FrozenInNewViewports",n[n.Locked=4]="Locked",n[n.XRefDependent=16]="XRefDependent",n[n.XRefResolved=32]="XRefResolved"})(t_||(t_={})),(function(n){n[n.None=0]="None",n[n.DescribeShape=1]="DescribeShape",n[n.VerticalText=4]="VerticalText",n[n.XRefDependent=16]="XRefDependent",n[n.XRefResolved=32]="XRefResolved"})(uE||(uE={})),(function(n){n[n.None=0]="None",n[n.PaperSpace=1]="PaperSpace",n[n.XRefDependent=16]="XRefDependent",n[n.XRefResolved=32]="XRefResolved"})(dE||(dE={}));let Zp=class{constructor(e){this.type=e,this.handle=mA.next()}dxfy(e){e.type(this.type),e.handle(this.handle),e.push(330,this.ownerObjectHandle),e.subclassMarker("AcDbSymbolTableRecord")}},Om=class extends Zp{constructor(e,t,i,r){super("LAYER"),this.name=e,this.colorNumber=t,this.lineType=i,this.flags=r??t_.None}dxfy(e){super.dxfy(e),e.subclassMarker("AcDbLayerTableRecord"),e.name(this.name),e.push(70,this.flags),e.colorNumber(this.colorNumber),e.push(420,this.trueColor),e.lineType(this.lineType),e.push(370,0),e.push(390,0),e.push(347,this.materialObject)}};Om.layerZeroName="0";const Sde=[[["00","00","00"],0,["0","0","0"]],[["FF","00","00"],1,["255","0","0"]],[["FF","FF","00"],2,["255","255","0"]],[["00","FF","00"],3,["0","255","0"]],[["00","FF","FF"],4,["0","255","255"]],[["00","00","FF"],5,["0","0","255"]],[["FF","00","FF"],6,["255","0","255"]],[["FF","FF","FF"],7,["255","255","255"]],[["41","41","41"],8,["65","65","65"]],[["80","80","80"],9,["128","128","128"]],[["FF","00","00"],10,["255","0","0"]],[["FF","AA","AA"],11,["255","170","170"]],[["BD","00","00"],12,["189","0","0"]],[["BD","7E","7E"],13,["189","126","126"]],[["81","00","00"],14,["129","0","0"]],[["81","56","56"],15,["129","86","86"]],[["68","00","00"],16,["104","0","0"]],[["68","45","45"],17,["104","69","69"]],[["4F","00","00"],18,["79","0","0"]],[["4F","35","35"],19,["79","53","53"]],[["FF","3F","00"],20,["255","63","0"]],[["FF","BF","AA"],21,["255","191","170"]],[["BD","2E","00"],22,["189","46","0"]],[["BD","8D","7E"],23,["189","141","126"]],[["81","1F","00"],24,["129","31","0"]],[["81","60","56"],25,["129","96","86"]],[["68","19","00"],26,["104","25","0"]],[["68","4E","45"],27,["104","78","69"]],[["4F","13","00"],28,["79","19","0"]],[["4F","3B","35"],29,["79","59","53"]],[["FF","7F","00"],30,["255","127","0"]],[["FF","D4","AA"],31,["255","212","170"]],[["BD","5E","00"],32,["189","94","0"]],[["BD","9D","7E"],33,["189","157","126"]],[["81","40","00"],34,["129","64","0"]],[["81","6B","56"],35,["129","107","86"]],[["68","34","00"],36,["104","52","0"]],[["68","56","45"],37,["104","86","69"]],[["4F","27","00"],38,["79","39","0"]],[["4F","42","35"],39,["79","66","53"]],[["FF","BF","00"],40,["255","191","0"]],[["FF","EA","AA"],41,["255","234","170"]],[["BD","8D","00"],42,["189","141","0"]],[["BD","AD","7E"],43,["189","173","126"]],[["81","60","00"],44,["129","96","0"]],[["81","76","56"],45,["129","118","86"]],[["68","4E","00"],46,["104","78","0"]],[["68","5F","45"],47,["104","95","69"]],[["4F","3B","00"],48,["79","59","0"]],[["4F","49","35"],49,["79","73","53"]],[["FF","FF","00"],50,["255","255","0"]],[["FF","FF","AA"],51,["255","255","170"]],[["BD","BD","00"],52,["189","189","0"]],[["BD","BD","7E"],53,["189","189","126"]],[["81","81","00"],54,["129","129","0"]],[["81","81","56"],55,["129","129","86"]],[["68","68","00"],56,["104","104","0"]],[["68","68","45"],57,["104","104","69"]],[["4F","4F","00"],58,["79","79","0"]],[["4F","4F","35"],59,["79","79","53"]],[["BF","FF","00"],60,["191","255","0"]],[["EA","FF","AA"],61,["234","255","170"]],[["8D","BD","00"],62,["141","189","0"]],[["AD","BD","7E"],63,["173","189","126"]],[["60","81","00"],64,["96","129","0"]],[["76","81","56"],65,["118","129","86"]],[["4E","68","00"],66,["78","104","0"]],[["5F","68","45"],67,["95","104","69"]],[["3B","4F","00"],68,["59","79","0"]],[["49","4F","35"],69,["73","79","53"]],[["7F","FF","00"],70,["127","255","0"]],[["D4","FF","AA"],71,["212","255","170"]],[["5E","BD","00"],72,["94","189","0"]],[["9D","BD","7E"],73,["157","189","126"]],[["40","81","00"],74,["64","129","0"]],[["6B","81","56"],75,["107","129","86"]],[["34","68","00"],76,["52","104","0"]],[["56","68","45"],77,["86","104","69"]],[["27","4F","00"],78,["39","79","0"]],[["42","4F","35"],79,["66","79","53"]],[["3F","FF","00"],80,["63","255","0"]],[["BF","FF","AA"],81,["191","255","170"]],[["2E","BD","00"],82,["46","189","0"]],[["8D","BD","7E"],83,["141","189","126"]],[["1F","81","00"],84,["31","129","0"]],[["60","81","56"],85,["96","129","86"]],[["19","68","00"],86,["25","104","0"]],[["4E","68","45"],87,["78","104","69"]],[["13","4F","00"],88,["19","79","0"]],[["3B","4F","35"],89,["59","79","53"]],[["00","FF","00"],90,["0","255","0"]],[["AA","FF","AA"],91,["170","255","170"]],[["00","BD","00"],92,["0","189","0"]],[["7E","BD","7E"],93,["126","189","126"]],[["00","81","00"],94,["0","129","0"]],[["56","81","56"],95,["86","129","86"]],[["00","68","00"],96,["0","104","0"]],[["45","68","45"],97,["69","104","69"]],[["00","4F","00"],98,["0","79","0"]],[["35","4F","35"],99,["53","79","53"]],[["00","FF","3F"],100,["0","255","63"]],[["AA","FF","BF"],101,["170","255","191"]],[["00","BD","2E"],102,["0","189","46"]],[["7E","BD","8D"],103,["126","189","141"]],[["00","81","1F"],104,["0","129","31"]],[["56","81","60"],105,["86","129","96"]],[["00","68","19"],106,["0","104","25"]],[["45","68","4E"],107,["69","104","78"]],[["00","4F","13"],108,["0","79","19"]],[["35","4F","3B"],109,["53","79","59"]],[["00","FF","7F"],110,["0","255","127"]],[["AA","FF","D4"],111,["170","255","212"]],[["00","BD","5E"],112,["0","189","94"]],[["7E","BD","9D"],113,["126","189","157"]],[["00","81","40"],114,["0","129","64"]],[["56","81","6B"],115,["86","129","107"]],[["00","68","34"],116,["0","104","52"]],[["45","68","56"],117,["69","104","86"]],[["00","4F","27"],118,["0","79","39"]],[["35","4F","42"],119,["53","79","66"]],[["00","FF","BF"],120,["0","255","191"]],[["AA","FF","EA"],121,["170","255","234"]],[["00","BD","8D"],122,["0","189","141"]],[["7E","BD","AD"],123,["126","189","173"]],[["00","81","60"],124,["0","129","96"]],[["56","81","76"],125,["86","129","118"]],[["00","68","4E"],126,["0","104","78"]],[["45","68","5F"],127,["69","104","95"]],[["00","4F","3B"],128,["0","79","59"]],[["35","4F","49"],129,["53","79","73"]],[["00","FF","FF"],130,["0","255","255"]],[["AA","FF","FF"],131,["170","255","255"]],[["00","BD","BD"],132,["0","189","189"]],[["7E","BD","BD"],133,["126","189","189"]],[["00","81","81"],134,["0","129","129"]],[["56","81","81"],135,["86","129","129"]],[["00","68","68"],136,["0","104","104"]],[["45","68","68"],137,["69","104","104"]],[["00","4F","4F"],138,["0","79","79"]],[["35","4F","4F"],139,["53","79","79"]],[["00","BF","FF"],140,["0","191","255"]],[["AA","EA","FF"],141,["170","234","255"]],[["00","8D","BD"],142,["0","141","189"]],[["7E","AD","BD"],143,["126","173","189"]],[["00","60","81"],144,["0","96","129"]],[["56","76","81"],145,["86","118","129"]],[["00","4E","68"],146,["0","78","104"]],[["45","5F","68"],147,["69","95","104"]],[["00","3B","4F"],148,["0","59","79"]],[["35","49","4F"],149,["53","73","79"]],[["00","7F","FF"],150,["0","127","255"]],[["AA","D4","FF"],151,["170","212","255"]],[["00","5E","BD"],152,["0","94","189"]],[["7E","9D","BD"],153,["126","157","189"]],[["00","40","81"],154,["0","64","129"]],[["56","6B","81"],155,["86","107","129"]],[["00","34","68"],156,["0","52","104"]],[["45","56","68"],157,["69","86","104"]],[["00","27","4F"],158,["0","39","79"]],[["35","42","4F"],159,["53","66","79"]],[["00","3F","FF"],160,["0","63","255"]],[["AA","BF","FF"],161,["170","191","255"]],[["00","2E","BD"],162,["0","46","189"]],[["7E","8D","BD"],163,["126","141","189"]],[["00","1F","81"],164,["0","31","129"]],[["56","60","81"],165,["86","96","129"]],[["00","19","68"],166,["0","25","104"]],[["45","4E","68"],167,["69","78","104"]],[["00","13","4F"],168,["0","19","79"]],[["35","3B","4F"],169,["53","59","79"]],[["00","00","FF"],170,["0","0","255"]],[["AA","AA","FF"],171,["170","170","255"]],[["00","00","BD"],172,["0","0","189"]],[["7E","7E","BD"],173,["126","126","189"]],[["00","00","81"],174,["0","0","129"]],[["56","56","81"],175,["86","86","129"]],[["00","00","68"],176,["0","0","104"]],[["45","45","68"],177,["69","69","104"]],[["00","00","4F"],178,["0","0","79"]],[["35","35","4F"],179,["53","53","79"]],[["3F","00","FF"],180,["63","0","255"]],[["BF","AA","FF"],181,["191","170","255"]],[["2E","00","BD"],182,["46","0","189"]],[["8D","7E","BD"],183,["141","126","189"]],[["1F","00","81"],184,["31","0","129"]],[["60","56","81"],185,["96","86","129"]],[["19","00","68"],186,["25","0","104"]],[["4E","45","68"],187,["78","69","104"]],[["13","00","4F"],188,["19","0","79"]],[["3B","35","4F"],189,["59","53","79"]],[["7F","00","FF"],190,["127","0","255"]],[["D4","AA","FF"],191,["212","170","255"]],[["5E","00","BD"],192,["94","0","189"]],[["9D","7E","BD"],193,["157","126","189"]],[["40","00","81"],194,["64","0","129"]],[["6B","56","81"],195,["107","86","129"]],[["34","00","68"],196,["52","0","104"]],[["56","45","68"],197,["86","69","104"]],[["27","00","4F"],198,["39","0","79"]],[["42","35","4F"],199,["66","53","79"]],[["BF","00","FF"],200,["191","0","255"]],[["EA","AA","FF"],201,["234","170","255"]],[["8D","00","BD"],202,["141","0","189"]],[["AD","7E","BD"],203,["173","126","189"]],[["60","00","81"],204,["96","0","129"]],[["76","56","81"],205,["118","86","129"]],[["4E","00","68"],206,["78","0","104"]],[["5F","45","68"],207,["95","69","104"]],[["3B","00","4F"],208,["59","0","79"]],[["49","35","4F"],209,["73","53","79"]],[["FF","00","FF"],210,["255","0","255"]],[["FF","AA","FF"],211,["255","170","255"]],[["BD","00","BD"],212,["189","0","189"]],[["BD","7E","BD"],213,["189","126","189"]],[["81","00","81"],214,["129","0","129"]],[["81","56","81"],215,["129","86","129"]],[["68","00","68"],216,["104","0","104"]],[["68","45","68"],217,["104","69","104"]],[["4F","00","4F"],218,["79","0","79"]],[["4F","35","4F"],219,["79","53","79"]],[["FF","00","BF"],220,["255","0","191"]],[["FF","AA","EA"],221,["255","170","234"]],[["BD","00","8D"],222,["189","0","141"]],[["BD","7E","AD"],223,["189","126","173"]],[["81","00","60"],224,["129","0","96"]],[["81","56","76"],225,["129","86","118"]],[["68","00","4E"],226,["104","0","78"]],[["68","45","5F"],227,["104","69","95"]],[["4F","00","3B"],228,["79","0","59"]],[["4F","35","49"],229,["79","53","73"]],[["FF","00","7F"],230,["255","0","127"]],[["FF","AA","D4"],231,["255","170","212"]],[["BD","00","5E"],232,["189","0","94"]],[["BD","7E","9D"],233,["189","126","157"]],[["81","00","40"],234,["129","0","64"]],[["81","56","6B"],235,["129","86","107"]],[["68","00","34"],236,["104","0","52"]],[["68","45","56"],237,["104","69","86"]],[["4F","00","27"],238,["79","0","39"]],[["4F","35","42"],239,["79","53","66"]],[["FF","00","3F"],240,["255","0","63"]],[["FF","AA","BF"],241,["255","170","191"]],[["BD","00","2E"],242,["189","0","46"]],[["BD","7E","8D"],243,["189","126","141"]],[["81","00","1F"],244,["129","0","31"]],[["81","56","60"],245,["129","86","96"]],[["68","00","19"],246,["104","0","25"]],[["68","45","4E"],247,["104","69","78"]],[["4F","00","13"],248,["79","0","19"]],[["4F","35","3B"],249,["79","53","59"]],[["33","33","33"],250,["51","51","51"]],[["50","50","50"],251,["80","80","80"]],[["69","69","69"],252,["105","105","105"]],[["82","82","82"],253,["130","130","130"]],[["BE","BE","BE"],254,["190","190","190"]],[["FF","FF","FF"],255,["255","255","255"]]];function nP(n){let e="";const t=Sde.find((i=>{const[,r]=i;return r===n}));if(t){const[i]=t,[r,s,o]=i;e=`${r}${s}${o}`}return e}let Tde=class{constructor(e){this.name=e,this.tags=[]}add(e,t){this.tags.push({code:e,value:t})}dxfy(e){e.push(102,`{${this.name}`);for(const t of this.tags)e.push(t.code,t.value);e.push(102,"}")}},Bde=class{constructor(){this.lines=[]}push(e,t){t!=null&&this.lines.push(e,t)}stringify(){return this.lines.join(`
`)}start(e){this.push(0,"SECTION"),this.push(2,e)}end(){this.push(0,"ENDSEC")}variableName(e){this.push(9,e)}type(e){this.push(0,e)}primaryText(e){this.push(1,e)}name(e,t=2){this.push(t,e)}handle(e){this.push(5,e)}lineType(e){this.push(6,e)}textStyle(e){this.push(7,e)}layerName(e){this.push(8,e)}point2d(e,t=0){this.push(10+t,e==null?void 0:e.x),this.push(20+t,e==null?void 0:e.y)}point3d(e,t=0){this.point2d(e,t),this.push(30+t,e==null?void 0:e.z)}elevation(e){this.push(38,e)}thickness(e){this.push(39,e)}visibilty(e){e!=null&&this.push(60,e?0:1)}colorNumber(e){this.push(62,e)}subclassMarker(e){this.push(100,e)}};var AE,n_,i_,Co;function _o(n,e,t,i){if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(n):i?i.value:e.get(n)}function my(n,e,t,i,r){if(typeof e=="function"?n!==e||!0:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(n,t),t}function fa(n,e){return{code:n,value:e}}function iP(n,e=255){const t=[],i=[];for(let r=0;r<n.length;r++){const s=n[r];i.length===e||r===n.length-1?(t.push(i.join("")),i.length=0):i.push(s)}return t}(function(n){n[n.Red=1]="Red",n[n.Green=3]="Green",n[n.Cyan=4]="Cyan",n[n.Blue=5]="Blue",n[n.Magenta=6]="Magenta",n[n.White=7]="White",n[n.Black=0]="Black",n[n.Yellow=2]="Yellow"})(AE||(AE={})),(function(n){n[n.Unitless=0]="Unitless",n[n.Inches=1]="Inches",n[n.Feet=2]="Feet",n[n.Miles=3]="Miles",n[n.Millimeters=4]="Millimeters",n[n.Centimeters=5]="Centimeters",n[n.Meters=6]="Meters",n[n.Kilometers=7]="Kilometers",n[n.Microinches=8]="Microinches",n[n.Mils=9]="Mils",n[n.Yards=10]="Yards",n[n.Angstroms=11]="Angstroms",n[n.Nanometers=12]="Nanometers",n[n.Microns=13]="Microns",n[n.Decimeters=14]="Decimeters",n[n.Decameters=15]="Decameters",n[n.Hectometers=16]="Hectometers",n[n.Gigameters=17]="Gigameters",n[n.AstronomicalUnits=18]="AstronomicalUnits",n[n.LightYears=19]="LightYears",n[n.Parsecs=20]="Parsecs",n[n.USSurveyFeet=21]="USSurveyFeet",n[n.USSurveyInch=22]="USSurveyInch",n[n.USSurveyYard=23]="USSurveyYard",n[n.USSurveyMile=24]="USSurveyMile"})(n_||(n_={})),(function(n){n.Continuous="Continuous"})(i_||(i_={})),typeof SuppressedError=="function"&&SuppressedError;let Ede=class{constructor(e){Co.set(this,void 0),this.name=e,my(this,Co,[])}clear(){_o(this,Co,"f").length=0}string(e){iP(e).forEach((t=>_o(this,Co,"f").push(fa(1e3,t))))}beginList(){_o(this,Co,"f").push(fa(1002,"{"))}endList(){_o(this,Co,"f").push(fa(1002,"}"))}layerName(e){_o(this,Co,"f").push(fa(1003,e))}binaryData(e){iP(e).forEach((t=>_o(this,Co,"f").push(fa(1004,t))))}databaseHandle(e){_o(this,Co,"f").push(fa(1005,e))}point(e){_o(this,Co,"f").push(fa(1010,e.x)),_o(this,Co,"f").push(fa(1020,e.y)),_o(this,Co,"f").push(fa(1030,e.z))}position(e){_o(this,Co,"f").push(fa(1011,e.x)),_o(this,Co,"f").push(fa(1021,e.y)),_o(this,Co,"f").push(fa(1031,e.z))}displacement(e){_o(this,Co,"f").push(fa(1012,e.x)),_o(this,Co,"f").push(fa(1022,e.y)),_o(this,Co,"f").push(fa(1032,e.z))}direction(e){_o(this,Co,"f").push(fa(1013,e.x)),_o(this,Co,"f").push(fa(1023,e.y)),_o(this,Co,"f").push(fa(1033,e.z))}real(e){_o(this,Co,"f").push(fa(1040,e))}distance(e){_o(this,Co,"f").push(fa(1041,e))}scale(e){_o(this,Co,"f").push(fa(1042,e))}integer(e){_o(this,Co,"f").push(fa(1070,e))}long(e){_o(this,Co,"f").push(fa(1071,e))}dxfy(e){e.push(1001,this.name),e.push(1002,"{"),_o(this,Co,"f").forEach((t=>e.push(t.code,t.value))),e.push(1002,"}")}};Co=new WeakMap;let gi=class{set angle(e){this.patternsData.forEach((t=>t.lineAngle=e))}constructor(e){this.name=e,this.patternsData=[],this.scale=1}dxfy(e){e.push(78,this.patternsData.length);for(const t of this.patternsData){e.push(53,t.lineAngle),e.push(43,t.x),e.push(44,t.y),e.push(45,t.offsetX*this.scale),e.push(46,t.offsetY*this.scale),e.push(79,t.dashLengthItems.length);for(const i of t.dashLengthItems)e.push(49,i*this.scale)}}add(e){this.patternsData.push(e)}};const Ai=new Map,c3=new gi("ANGLE");c3.add({lineAngle:0,x:0,y:0,offsetX:.275,offsetY:.2,dashLengthItems:[-.075]}),c3.add({lineAngle:90,x:0,y:0,offsetX:.275,offsetY:.2,dashLengthItems:[-.075]}),Ai.set("ANGLE",c3);const rP=new gi("ANSI31");rP.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:1.25,dashLengthItems:[]}),Ai.set("ANSI31",rP);const sP=new gi("ANSI32");sP.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),Ai.set("ANSI32",sP);const h3=new gi("ANSI33");h3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:9.525,dashLengthItems:[]}),h3.add({lineAngle:45,x:4.49013,y:0,offsetX:0,offsetY:9.525,dashLengthItems:[]}),Ai.set("ANSI33",h3);const u3=new gi("ANSI34");u3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[]}),u3.add({lineAngle:45,x:4.49013,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[3.175,-1.5875]}),Ai.set("ANSI34",u3);const s2=new gi("ANSI35");s2.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:19.05,dashLengthItems:[]}),s2.add({lineAngle:45,x:4.49013,y:0,offsetX:0,offsetY:19.05,dashLengthItems:[]}),s2.add({lineAngle:45,x:8.98026,y:0,offsetX:0,offsetY:19.05,dashLengthItems:[]}),s2.add({lineAngle:45,x:13.4704,y:0,offsetX:0,offsetY:19.05,dashLengthItems:[]}),Ai.set("ANSI35",s2);const d3=new gi("ANSI36");d3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[]}),d3.add({lineAngle:45,x:4.49013,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[7.9375,-1.5875,0,-1.5875]}),Ai.set("ANSI36",d3);const oP=new gi("ANSI37");oP.add({lineAngle:45,x:0,y:0,offsetX:5.55625,offsetY:3.175,dashLengthItems:[7.9375,-1.5875,0,-1.5875]}),Ai.set("ANSI37",oP);const A3=new gi("ANSI38");A3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),A3.add({lineAngle:135,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),Ai.set("ANSI38",A3);const f3=new gi("AR_B816");f3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),f3.add({lineAngle:135,x:0,y:0,offsetX:6.35,offsetY:3.175,dashLengthItems:[7.9375,-4.7625]}),Ai.set("AR_B816",f3);const p3=new gi("AR_B816C");p3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:203.2,dashLengthItems:[]}),p3.add({lineAngle:90,x:0,y:0,offsetX:203.2,offsetY:203.2,dashLengthItems:[203.2,-203.2]}),Ai.set("AR_B816C",p3);const o2=new gi("AR_B88");o2.add({lineAngle:0,x:0,y:0,offsetX:203.2,offsetY:203.2,dashLengthItems:[396.875,-9.525]}),o2.add({lineAngle:0,x:-203.2,y:9.525,offsetX:203.2,offsetY:203.2,dashLengthItems:[396.875,-9.525]}),o2.add({lineAngle:90,x:0,y:0,offsetX:203.2,offsetY:203.2,dashLengthItems:[-212.725,193.675]}),o2.add({lineAngle:90,x:-9.525,y:0,offsetX:203.2,offsetY:203.2,dashLengthItems:[-212.725,193.675]}),Ai.set("AR_B88",o2);const g3=new gi("AR_BRELM");g3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:203.2,dashLengthItems:[]}),g3.add({lineAngle:90,x:0,y:0,offsetX:203.2,offsetY:101.6,dashLengthItems:[203.2,-203.2]}),Ai.set("AR_BRELM",g3);const RA=new gi("AR_BRSTD");RA.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:135.484,dashLengthItems:[193.675,-9.525]}),RA.add({lineAngle:0,x:0,y:57.15,offsetX:0,offsetY:135.484,dashLengthItems:[193.675,-9.525]}),RA.add({lineAngle:0,x:50.8,y:67.7418,offsetX:0,offsetY:135.484,dashLengthItems:[92.075,-9.525]}),RA.add({lineAngle:0,x:50.8,y:124.892,offsetX:0,offsetY:135.484,dashLengthItems:[92.075,-9.525]}),RA.add({lineAngle:90,x:0,y:0,offsetX:0,offsetY:203.2,dashLengthItems:[57.15,-78.334]}),RA.add({lineAngle:90,x:-9.525,y:0,offsetX:0,offsetY:203.2,dashLengthItems:[57.15,-78.334]}),RA.add({lineAngle:90,x:50.8,y:67.7418,offsetX:0,offsetY:101.6,dashLengthItems:[57.15,-78.334]}),RA.add({lineAngle:90,x:41.275,y:67.7418,offsetX:0,offsetY:101.6,dashLengthItems:[57.15,-78.334]}),Ai.set("AR_BRSTD",RA);const m3=new gi("AR_CONC");m3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:67.7418,dashLengthItems:[]}),m3.add({lineAngle:90,x:0,y:0,offsetX:67.7418,offsetY:101.6,dashLengthItems:[67.7418,-67.7418]}),Ai.set("AR_CONC",m3);const bh=new gi("AR_HBONE");bh.add({lineAngle:50,x:0,y:0,offsetX:104.896,offsetY:-149.807,dashLengthItems:[19.05,-209.55]}),bh.add({lineAngle:355,x:0,y:0,offsetX:-51.76101082,offsetY:187.25814969,dashLengthItems:[15.24,-167.64058417]}),bh.add({lineAngle:100.4514447,x:15.182007,y:-1.3282535,offsetX:145.5569059,offsetY:-176.270089,dashLengthItems:[16.1900088,-178.0902446]}),bh.add({lineAngle:46.1842,x:0,y:50.8,offsetX:157.343,offsetY:-224.71,dashLengthItems:[28.575,-314.325]}),bh.add({lineAngle:96.63555761,x:22.5899,y:47.2965,offsetX:218.33577212,offsetY:-264.40480444,dashLengthItems:[24.28502314,-267.13560816]}),bh.add({lineAngle:351.18415117,x:0,y:50.8,offsetX:196.67912063,offsetY:280.88740361,dashLengthItems:[22.85996707,-251.45973192]}),bh.add({lineAngle:21,x:25.4,y:38.1,offsetX:104.89565868,offsetY:-149.80652586,dashLengthItems:[19.05,-209.55]}),bh.add({lineAngle:326,x:25.4,y:38.1,offsetX:-51.7604,offsetY:187.258,dashLengthItems:[15.24,-167.64]}),bh.add({lineAngle:71.451445,x:38.0345326,y:29.5779001,offsetX:145.5567546,offsetY:-176.2700748,dashLengthItems:[16.1900088,-178.0899376]}),bh.add({lineAngle:37.5,x:0,y:0,offsetX:53.9242,offsetY:65.2018,dashLengthItems:[0,-165.608,0,-170.18,0,-168.275]}),bh.add({lineAngle:7.5,x:0,y:0,offsetX:79.3242,offsetY:90.6018,dashLengthItems:[0,-97.028,0,-161.798,0,-64.135]}),bh.add({lineAngle:-32.5,x:-56.642,y:0,offsetX:117.434,offsetY:68.0212,dashLengthItems:[0,-63.5,0,-198.12,0,-262.89]}),bh.add({lineAngle:-42.5,x:-82.042,y:0,offsetX:92.0344,offsetY:118.821,dashLengthItems:[0,-82.55,0,-131.572,0,-186.69]}),Ai.set("AR_HBONE",bh);const y3=new gi("AR_PARQ1");y3.add({lineAngle:45,x:0,y:0,offsetX:101.6,offsetY:101.6,dashLengthItems:[304.8,-101.6]}),y3.add({lineAngle:135,x:71.842,y:71.842,offsetX:101.6,offsetY:-101.6,dashLengthItems:[304.8,-101.6]}),Ai.set("AR_PARQ1",y3);const th=new gi("AR_RROOF");th.add({lineAngle:90,x:0,y:0,offsetX:304.8,offsetY:304.8,dashLengthItems:[304.8,-304.8]}),th.add({lineAngle:90,x:50.8,y:0,offsetX:304.8,offsetY:304.8,dashLengthItems:[304.8,-304.8]}),th.add({lineAngle:90,x:101.6,y:0,offsetX:304.8,offsetY:304.8,dashLengthItems:[304.8,-304.8]}),th.add({lineAngle:90,x:152.4,y:0,offsetX:304.8,offsetY:304.8,dashLengthItems:[304.8,-304.8]}),th.add({lineAngle:90,x:203.2,y:0,offsetX:304.8,offsetY:304.8,dashLengthItems:[304.8,-304.8]}),th.add({lineAngle:90,x:254,y:0,offsetX:304.8,offsetY:304.8,dashLengthItems:[304.8,-304.8]}),th.add({lineAngle:90,x:304.8,y:0,offsetX:304.8,offsetY:304.8,dashLengthItems:[304.8,-304.8]}),th.add({lineAngle:0,x:0,y:304.8,offsetX:304.8,offsetY:-304.8,dashLengthItems:[304.8,-304.8]}),th.add({lineAngle:0,x:0,y:355.6,offsetX:304.8,offsetY:-304.8,dashLengthItems:[304.8,-304.8]}),th.add({lineAngle:0,x:0,y:406.4,offsetX:304.8,offsetY:-304.8,dashLengthItems:[304.8,-304.8]}),th.add({lineAngle:0,x:0,y:457.2,offsetX:304.8,offsetY:-304.8,dashLengthItems:[304.8,-304.8]}),th.add({lineAngle:0,x:0,y:508,offsetX:304.8,offsetY:-304.8,dashLengthItems:[304.8,-304.8]}),th.add({lineAngle:0,x:0,y:558.8,offsetX:304.8,offsetY:-304.8,dashLengthItems:[304.8,-304.8]}),th.add({lineAngle:0,x:0,y:609.6,offsetX:304.8,offsetY:-304.8,dashLengthItems:[304.8,-304.8]}),Ai.set("AR_RROOF",th);const fx=new gi("AR_RSHKE");fx.add({lineAngle:0,x:0,y:0,offsetX:55.88,offsetY:25.4,dashLengthItems:[381,-50.8,127,-25.4]}),fx.add({lineAngle:0,x:33.782,y:12.7,offsetX:-25.4,offsetY:33.782,dashLengthItems:[76.2,-8.382,152.4,-19.05]}),fx.add({lineAngle:0,x:12.7,y:21.59,offsetX:132.08,offsetY:17.018,dashLengthItems:[203.2,-35.56,101.6,-25.4]}),Ai.set("AR_RSHKE",fx);const Hd=new gi("AR_SAND");Hd.add({lineAngle:0,x:0,y:0,offsetX:647.7,offsetY:304.8,dashLengthItems:[152.4,-127,177.8,-76.2,228.6,-101.6]}),Hd.add({lineAngle:0,x:152.4,y:12.7,offsetX:647.7,offsetY:304.8,dashLengthItems:[127,-482.6,101.6,-152.4]}),Hd.add({lineAngle:0,x:457.2,y:-19.05,offsetX:647.7,offsetY:304.8,dashLengthItems:[76.2,-787.4]}),Hd.add({lineAngle:90,x:0,y:0,offsetX:304.8,offsetY:215.9,dashLengthItems:[292.1,-927.1]}),Hd.add({lineAngle:90,x:152.4,y:0,offsetX:304.8,offsetY:215.9,dashLengthItems:[285.75,-933.45]}),Hd.add({lineAngle:90,x:279.4,y:0,offsetX:304.8,offsetY:215.9,dashLengthItems:[266.7,-952.5]}),Hd.add({lineAngle:90,x:457.2,y:-19.05,offsetX:304.8,offsetY:215.9,dashLengthItems:[292.1,-927.1]}),Hd.add({lineAngle:90,x:533.4,y:-19.05,offsetX:304.8,offsetY:215.9,dashLengthItems:[292.1,-927.1]}),Hd.add({lineAngle:90,x:762,y:0,offsetX:304.8,offsetY:215.9,dashLengthItems:[279.4,-939.8]}),Ai.set("AR_SAND",Hd);const a2=new gi("BOX");a2.add({lineAngle:37.5,x:0,y:0,offsetX:28.5242,offsetY:39.8018,dashLengthItems:[0,-38.608,0,-43.18,0,-41.275]}),a2.add({lineAngle:7.5,x:0,y:0,offsetX:53.9242,offsetY:65.2018,dashLengthItems:[0,-20.828,0,-34.798,0,-13.335]}),a2.add({lineAngle:-32.5,x:-31.242,y:0,offsetX:66.6344,offsetY:42.6212,dashLengthItems:[0,-12.7,0,-45.72,0,-59.69]}),a2.add({lineAngle:-42.5,x:-31.242,y:0,offsetX:41.2344,offsetY:68.0212,dashLengthItems:[0,-6.35,0,-29.972,0,-34.29]}),Ai.set("BOX",a2);const UA=new gi("BRASS");UA.add({lineAngle:90,x:0,y:0,offsetX:0,offsetY:25.4,dashLengthItems:[]}),UA.add({lineAngle:90,x:6.35,y:0,offsetX:0,offsetY:25.4,dashLengthItems:[]}),UA.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:25.4,dashLengthItems:[-6.35,6.35]}),UA.add({lineAngle:0,x:0,y:6.35,offsetX:0,offsetY:25.4,dashLengthItems:[-6.35,6.35]}),UA.add({lineAngle:0,x:0,y:12.7,offsetX:0,offsetY:25.4,dashLengthItems:[6.35,-6.35]}),UA.add({lineAngle:0,x:0,y:19.05,offsetX:0,offsetY:25.4,dashLengthItems:[6.35,-6.35]}),UA.add({lineAngle:90,x:12.7,y:0,offsetX:0,offsetY:25.4,dashLengthItems:[6.35,-6.35]}),UA.add({lineAngle:90,x:19.05,y:0,offsetX:0,offsetY:25.4,dashLengthItems:[6.35,-6.35]}),Ai.set("BRASS",UA);const w3=new gi("BRICK");w3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[]}),w3.add({lineAngle:0,x:0,y:3.175,offsetX:0,offsetY:6.35,dashLengthItems:[3.175,-1.5875]}),Ai.set("BRICK",w3);const px=new gi("BRSTONE");px.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[]}),px.add({lineAngle:90,x:0,y:0,offsetX:0,offsetY:12.7,dashLengthItems:[6.35,-6.35]}),px.add({lineAngle:90,x:6.35,y:0,offsetX:0,offsetY:12.7,dashLengthItems:[-6.35,6.35]}),Ai.set("BRSTONE",px);const OA=new gi("CLAY");OA.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:8.382,dashLengthItems:[]}),OA.add({lineAngle:90,x:22.86,y:0,offsetX:8.382,offsetY:12.7,dashLengthItems:[8.382,-8.382]}),OA.add({lineAngle:90,x:20.32,y:0,offsetX:8.382,offsetY:12.7,dashLengthItems:[8.382,-8.382]}),OA.add({lineAngle:0,x:22.86,y:1.397,offsetX:12.7,offsetY:8.382,dashLengthItems:[-22.86,2.54]}),OA.add({lineAngle:0,x:22.86,y:2.794,offsetX:12.7,offsetY:8.382,dashLengthItems:[-22.86,2.54]}),OA.add({lineAngle:0,x:22.86,y:4.191,offsetX:12.7,offsetY:8.382,dashLengthItems:[-22.86,2.54]}),OA.add({lineAngle:0,x:22.86,y:5.588,offsetX:12.7,offsetY:8.382,dashLengthItems:[-22.86,2.54]}),OA.add({lineAngle:0,x:22.86,y:6.985,offsetX:12.7,offsetY:8.382,dashLengthItems:[-22.86,2.54]}),Ai.set("CLAY",OA);const l2=new gi("CORK");l2.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:4.7625,dashLengthItems:[]}),l2.add({lineAngle:0,x:0,y:.79375,offsetX:0,offsetY:4.7625,dashLengthItems:[]}),l2.add({lineAngle:0,x:0,y:1.5875,offsetX:0,offsetY:4.7625,dashLengthItems:[]}),l2.add({lineAngle:0,x:0,y:3.175,offsetX:0,offsetY:4.7625,dashLengthItems:[4.7625,-3.175]}),Ai.set("CORK",l2);const c2=new gi("CROSS");c2.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),c2.add({lineAngle:135,x:1.5875,y:-1.5875,offsetX:0,offsetY:8.98026,dashLengthItems:[4.49013,-4.49013]}),c2.add({lineAngle:135,x:2.38125,y:-1.5875,offsetX:0,offsetY:8.98026,dashLengthItems:[4.49013,-4.49013]}),c2.add({lineAngle:135,x:3.175,y:-1.5875,offsetX:0,offsetY:8.98026,dashLengthItems:[4.49013,-4.49013]}),Ai.set("CROSS",c2);const v3=new gi("DASH");v3.add({lineAngle:0,x:0,y:0,offsetX:6.35,offsetY:6.35,dashLengthItems:[3.175,-9.525]}),v3.add({lineAngle:90,x:1.5875,y:-1.5875,offsetX:6.35,offsetY:6.35,dashLengthItems:[3.175,-9.525]}),Ai.set("DASH",v3);const aP=new gi("DOLMIT");aP.add({lineAngle:0,x:0,y:0,offsetX:3.175,offsetY:3.175,dashLengthItems:[3.175,-3.175]}),Ai.set("DOLMIT",aP);const x3=new gi("DOTS");x3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[]}),x3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:17.9605,dashLengthItems:[8.980256121069154,-17.960512242138307]}),Ai.set("DOTS",x3);const lP=new gi("EARTH");lP.add({lineAngle:0,x:0,y:0,offsetX:.79375,offsetY:1.5875,dashLengthItems:[0,-1.5875]}),Ai.set("EARTH",lP);const gg=new gi("ESCHER");gg.add({lineAngle:0,x:0,y:0,offsetX:6.35,offsetY:6.35,dashLengthItems:[6.35,-6.35]}),gg.add({lineAngle:0,x:0,y:2.38125,offsetX:6.35,offsetY:6.35,dashLengthItems:[6.35,-6.35]}),gg.add({lineAngle:0,x:0,y:4.7625,offsetX:6.35,offsetY:6.35,dashLengthItems:[6.35,-6.35]}),gg.add({lineAngle:90,x:.79375,y:5.55625,offsetX:6.35,offsetY:6.35,dashLengthItems:[6.35,-6.35]}),gg.add({lineAngle:90,x:3.175,y:5.55625,offsetX:6.35,offsetY:6.35,dashLengthItems:[6.35,-6.35]}),gg.add({lineAngle:90,x:5.55625,y:5.55625,offsetX:6.35,offsetY:6.35,dashLengthItems:[6.35,-6.35]}),Ai.set("ESCHER",gg);const ka=new gi("FLEX");ka.add({lineAngle:60,x:0,y:0,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[27.94,-2.54]}),ka.add({lineAngle:180,x:0,y:0,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[27.94,-2.54]}),ka.add({lineAngle:300,x:0,y:0,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[27.94,-2.54]}),ka.add({lineAngle:60,x:2.54,y:0,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),ka.add({lineAngle:300,x:2.54,y:0,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),ka.add({lineAngle:60,x:-1.27,y:2.199704516,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),ka.add({lineAngle:180,x:-1.27,y:2.199704516,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),ka.add({lineAngle:300,x:-1.27,y:-2.199704516,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),ka.add({lineAngle:180,x:-1.27,y:-2.199704516,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),ka.add({lineAngle:60,x:-10.16,y:0,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),ka.add({lineAngle:300,x:-10.16,y:0,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),ka.add({lineAngle:60,x:5.08,y:-8.7988180894,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),ka.add({lineAngle:180,x:5.08,y:-8.7988180894,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),ka.add({lineAngle:300,x:5.08,y:8.7988180894,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),ka.add({lineAngle:180,x:5.08,y:8.7988180894,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),ka.add({lineAngle:0,x:5.08,y:4.3994090574,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[17.78,-12.7]}),ka.add({lineAngle:0,x:5.08,y:-4.3994090574,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[17.78,-12.7]}),ka.add({lineAngle:120,x:1.27,y:6.5991135734,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[17.78,-12.7]}),ka.add({lineAngle:120,x:-6.35,y:2.199704516,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[17.78,-12.7]}),ka.add({lineAngle:240,x:-6.35,y:-2.199704516,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[17.78,-12.7]}),ka.add({lineAngle:240,x:1.27,y:-6.5991135734,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[17.78,-12.7]}),Ai.set("FLEX",ka);const b3=new gi("GOST_GLASS");b3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[6.35,-6.35]}),b3.add({lineAngle:45,x:6.35,y:0,offsetX:4.490128053,offsetY:4.490128053,dashLengthItems:[1.5875,-5.8052561314,1.5875,-8.9802561314]}),Ai.set("GOST_GLASS",b3);const gx=new gi("GOST_WOOD");gx.add({lineAngle:45,x:0,y:0,offsetX:6,offsetY:-6,dashLengthItems:[5,-7]}),gx.add({lineAngle:45,x:2.12132,y:0,offsetX:6,offsetY:-6,dashLengthItems:[2,-10]}),gx.add({lineAngle:45,x:0,y:2.12132,offsetX:6,offsetY:-6,dashLengthItems:[2,-10]}),Ai.set("GOST_WOOD",gx);const mx=new gi("GOST_GROUND");mx.add({lineAngle:90,x:0,y:0,offsetX:0,offsetY:-6,dashLengthItems:[10,-2]}),mx.add({lineAngle:90,x:2,y:-2,offsetX:0,offsetY:-6,dashLengthItems:[6,-1.5,3,-1.5]}),mx.add({lineAngle:90,x:4,y:-5,offsetX:0,offsetY:-6,dashLengthItems:[10,-2]}),Ai.set("GOST_GROUND",mx);const yx=new gi("GRASS");yx.add({lineAngle:45,x:0,y:0,offsetX:10,offsetY:-10,dashLengthItems:[20]}),yx.add({lineAngle:45,x:3,y:0,offsetX:10,offsetY:-10,dashLengthItems:[20]}),yx.add({lineAngle:45,x:6,y:0,offsetX:10,offsetY:-10,dashLengthItems:[20]}),Ai.set("GRASS",yx);const wx=new gi("GRATE");wx.add({lineAngle:90,x:0,y:0,offsetX:17.96051224,offsetY:17.96051224,dashLengthItems:[4.7625,-31.15852448]}),wx.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:25.4,dashLengthItems:[4.7625,-20.6375]}),wx.add({lineAngle:135,x:0,y:0,offsetX:0,offsetY:25.4,dashLengthItems:[4.7625,-20.6375]}),Ai.set("GRATE",wx);const C3=new gi("GRAVEL");C3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:.79375,dashLengthItems:[]}),C3.add({lineAngle:90,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),Ai.set("GRAVEL",C3);const ss=new gi("HEX");ss.add({lineAngle:228.0127875,x:18.288,y:25.4,offsetX:305.85067529778,offsetY:1.88796713245,dashLengthItems:[3.4172144,-338.30483639565]}),ss.add({lineAngle:184.969741,x:16.002,y:22.86,offsetX:-305.8545235377,offsetY:1.10019612724,dashLengthItems:[5.8640472,-580.54048893524]}),ss.add({lineAngle:132.5104471,x:10.16,y:22.352,offsetX:-377.59492241548,offsetY:1.56030959675,dashLengthItems:[4.1348152,-409.347227941]}),ss.add({lineAngle:267.273689,x:.254,y:16.002,offsetX:-508.63316875916,offsetY:1.20815479432,dashLengthItems:[5.3400452,-528.66437425738]}),ss.add({lineAngle:292.83365418,x:0,y:10.668,offsetX:-330.19770134945,offsetY:1.23208097566,dashLengthItems:[5.236337,-518.39807745344]}),ss.add({lineAngle:357.273689,x:2.032,y:5.842,offsetX:-508.63316875916,offsetY:1.20815479432,dashLengthItems:[5.3400452,-528.66437425738]}),ss.add({lineAngle:37.69424047,x:7.366,y:5.588,offsetX:-416.58997273292,offsetY:.91357450169,dashLengthItems:[7.0619366,-699.13115314247]}),ss.add({lineAngle:72.25532837,x:12.954,y:9.906,offsetX:586.40373773403,offsetY:.96766293399,dashLengthItems:[6.6671952,-660.05256601905]}),ss.add({lineAngle:121.42956562,x:14.986,y:16.256,offsetX:387.71230339293,offsetY:1.2040754753,dashLengthItems:[5.35813,-530.45545698712]}),ss.add({lineAngle:175.2363583,x:12.192,y:20.828,offsetX:-280.5442400419,offsetY:2.10935518695,dashLengthItems:[6.1171328,-299.7393695]}),ss.add({lineAngle:222.3974378,x:6.096,y:21.336,offsetX:413.48123885686,offsetY:.81554484621,dashLengthItems:[7.9107792,-783.16772512177]}),ss.add({lineAngle:138.81407483,x:25.4,y:15.748,offsetX:234.164238558,offsetY:2.38943100688,dashLengthItems:[2.7000454,-267.30565824344]}),ss.add({lineAngle:171.4692344,x:23.368,y:17.526,offsetX:-334.082478726,offsetY:1.25594916784,dashLengthItems:[5.1368198,-508.5463899704]}),ss.add({lineAngle:225,x:18.288,y:18.288,offsetX:17.96051224214,offsetY:17.96051224214,dashLengthItems:[3.5920934,-32.32893108428]}),ss.add({lineAngle:203.19859051,x:16.51,y:21.336,offsetX:-136.74251918,offsetY:3.33518339548,dashLengthItems:[1.9344132,-191.50622368894]}),ss.add({lineAngle:291.80140949,x:14.732,y:20.574,offsetX:-80.18324702488,offsetY:4.71666158921,dashLengthItems:[2.7356562,-134.0475299]}),ss.add({lineAngle:30.96375653,x:15.748,y:18.034,offsetX:91.47734531502,offsetY:4.35606406258,dashLengthItems:[4.4431966,-143.6629815291]}),ss.add({lineAngle:161.56505118,x:19.558,y:20.32,offsetX:-56.2252967978,offsetY:8.03218525675,dashLengthItems:[3.2128714,-77.10898116828]}),ss.add({lineAngle:16.389540334,x:0,y:20.574,offsetX:265.17991128726,offsetY:1.43340492604,dashLengthItems:[4.50088,-445.58826672539]}),ss.add({lineAngle:70.34617594,x:4.318,y:21.844,offsetX:-297.29446803469,offsetY:1.70858889651,dashLengthItems:[3.7759894,-373.822156782]}),ss.add({lineAngle:293.19859051,x:19.558,y:25.4,offsetX:-136.7425191801,offsetY:3.33518339548,dashLengthItems:[3.868801,-189.57183588894]}),ss.add({lineAngle:343.61045967,x:21.082,y:21.844,offsetX:-265.17991128725,offsetY:1.433404926,dashLengthItems:[4.50088,-445.5882667254]}),ss.add({lineAngle:339.44395478,x:0,y:4.826,offsetX:-136.75087638398,offsetY:2.97284513779,dashLengthItems:[4.340352,-212.67734313106]}),ss.add({lineAngle:294.7751406,x:4.064,y:3.302,offsetX:-306.90424056705,offsetY:1.77401295215,dashLengthItems:[3.6367212,-360.0359338072]}),ss.add({lineAngle:66.80140949,x:19.812,y:0,offsetX:136.74251918012,offsetY:3.33518339452,dashLengthItems:[3.868801,-189.57183588894]}),ss.add({lineAngle:17.35402464,x:21.336,y:3.556,offsetX:-345.47402804977,offsetY:1.51523696536,dashLengthItems:[4.2578274,-421.523759802]}),ss.add({lineAngle:69.44395478,x:7.366,y:0,offsetX:-136.75087638396,offsetY:2.97284513874,dashLengthItems:[2.170176,-214.84751913106]}),ss.add({lineAngle:101.309932474,x:18.288,y:0,offsetX:104.60834648271,offsetY:4.98134983255,dashLengthItems:[1.295146,-128.21994964526]}),ss.add({lineAngle:165.963756532,x:18.034,y:1.27,offsetX:-80.085263387,offsetY:6.16040487582,dashLengthItems:[5.236337,-99.49054589069]}),ss.add({lineAngle:186.00900596,x:12.954,y:2.54,offsetX:-255.26337856879,offsetY:1.32949676118,dashLengthItems:[4.85267,-480.41364863337]}),ss.add({lineAngle:303.69006753,x:15.748,y:15.748,offsetX:-56.35753993648,offsetY:7.0446924921,dashLengthItems:[3.6632388,-87.9177635968]}),ss.add({lineAngle:353.15722659,x:17.78,y:12.7,offsetX:434.77679606606,offsetY:1.0087628707,dashLengthItems:[6.3955676,-633.16009065031]}),ss.add({lineAngle:60.9453959,x:24.13,y:11.938,offsetX:-204.76648550216,offsetY:2.46706609031,dashLengthItems:[2.6150824,-258.8939231811]}),ss.add({lineAngle:90,x:25.4,y:14.224,offsetX:25.4,offsetY:25.4,dashLengthItems:[1.524,-23.876]}),ss.add({lineAngle:120.25643716,x:12.446,y:3.302,offsetX:-204.77318477297,offsetY:1.8283320086,dashLengthItems:[3.5286696,-349.339407732]}),ss.add({lineAngle:48.0127875,x:10.668,y:6.35,offsetX:305.85067529778,offsetY:1.88796713138,dashLengthItems:[6.8344288,-334.88762199565]}),ss.add({lineAngle:0,x:15.24,y:11.43,offsetX:25.4,offsetY:25.4,dashLengthItems:[6.604,-18.796]}),ss.add({lineAngle:325.3048465,x:21.844,y:11.43,offsetX:310.04235091354,offsetY:-1.6064370526,dashLengthItems:[4.0160956,-397.5931672414]}),ss.add({lineAngle:254.0546041,x:25.146,y:9.144,offsetX:104.6687497289,offsetY:3.48895832444,dashLengthItems:[3.6982908,-181.21650038772]}),ss.add({lineAngle:207.64597536,x:24.13,y:5.588,offsetX:545.36007557253,offsetY:1.07143433066,dashLengthItems:[6.021451,-596.12464422938]}),ss.add({lineAngle:175.42607874,x:18.796,y:2.794,offsetX:331.1739336186,offsetY:1.01276432357,dashLengthItems:[6.3702946,-630.6584645624]}),Ai.set("HEX",ss);const vx=new gi("HONEY");vx.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5.4992613154,dashLengthItems:[3.175,-6.35]}),vx.add({lineAngle:120,x:0,y:0,offsetX:0,offsetY:5.4992613154,dashLengthItems:[3.175,-6.35]}),vx.add({lineAngle:60,x:3.175,y:0,offsetX:0,offsetY:5.4992613154,dashLengthItems:[3.175,-6.35]}),Ai.set("HONEY",vx);const xx=new gi("HOUND");xx.add({lineAngle:0,x:0,y:0,offsetX:4.7625,offsetY:2.749630645,dashLengthItems:[3.175,-6.35]}),xx.add({lineAngle:120,x:0,y:0,offsetX:4.7625,offsetY:2.749630645,dashLengthItems:[3.175,-6.35]}),xx.add({lineAngle:60,x:0,y:0,offsetX:4.7625,offsetY:2.749630645,dashLengthItems:[-6.35,3.175]}),Ai.set("HOUND",xx);const _3=new gi("INSUL");_3.add({lineAngle:0,x:0,y:0,offsetX:6.35,offsetY:1.5875,dashLengthItems:[25.4,-12.7]}),_3.add({lineAngle:90,x:0,y:0,offsetX:-6.35,offsetY:1.5875,dashLengthItems:[25.4,-12.7]}),Ai.set("INSUL",_3);const bx=new gi("ACAD_ISO02W100");bx.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:9.525,dashLengthItems:[]}),bx.add({lineAngle:0,x:0,y:3.175,offsetX:0,offsetY:9.525,dashLengthItems:[3.175,-3.175]}),bx.add({lineAngle:0,x:0,y:6.35,offsetX:0,offsetY:9.525,dashLengthItems:[3.175,-3.175]}),Ai.set("ACAD_ISO02W100",bx);const cP=new gi("ACAD_ISO03W100");cP.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[12,-3]}),Ai.set("ACAD_ISO03W100",cP);const hP=new gi("ACAD_ISO04W100");hP.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[12,-18]}),Ai.set("ACAD_ISO04W100",hP);const uP=new gi("ACAD_ISO05W100");uP.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[24,-3,.5,-3]}),Ai.set("ACAD_ISO05W100",uP);const dP=new gi("ACAD_ISO06W100");dP.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[24,-3,.5,-3,.5,-3]}),Ai.set("ACAD_ISO06W100",dP);const S3=new gi("ACAD_ISO07W100");S3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[24,-3,.5,-3,.5,-6.5]}),S3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[-34,.5,-3]}),Ai.set("ACAD_ISO07W100",S3);const AP=new gi("ACAD_ISO08W100");AP.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[.5,-3]}),Ai.set("ACAD_ISO08W100",AP);const fP=new gi("ACAD_ISO09W100");fP.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[24,-3,6,-3]}),Ai.set("ACAD_ISO09W100",fP);const pP=new gi("ACAD_ISO10W100");pP.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[24,-3,6,-3,6,-3]}),Ai.set("ACAD_ISO10W100",pP);const gP=new gi("ACAD_ISO11W100");gP.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[12,-3,.5,-3]}),Ai.set("ACAD_ISO11W100",gP);const mP=new gi("ACAD_ISO12W100");mP.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[12,-3,12,-3,.5,-3]}),Ai.set("ACAD_ISO12W100",mP);const yP=new gi("ACAD_ISO13W100");yP.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[12,-3,.5,-3,.5,-3]}),Ai.set("ACAD_ISO13W100",yP);const T3=new gi("ACAD_ISO14W100");T3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[12,-3,12,-3,.5,-6.5]}),T3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[-33.5,.5,-3]}),Ai.set("ACAD_ISO14W100",T3);const B3=new gi("ACAD_ISO15W100");B3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[12,-3,.5,-3,.5,-6.5]}),B3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[-22,.5,-3]}),Ai.set("ACAD_ISO15W100",B3);const E3=new gi("JIS_LC_20");E3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[12,-3,12,-3,.5,-10]}),E3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[-33.5,.5,-3,.5,-3]}),Ai.set("JIS_LC_20",E3);const F3=new gi("JIS_LC_20A");F3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:20,dashLengthItems:[]}),F3.add({lineAngle:45,x:.4,y:0,offsetX:0,offsetY:20,dashLengthItems:[]}),Ai.set("JIS_LC_20A",F3);const k3=new gi("JIS_LC_8");k3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:20,dashLengthItems:[]}),k3.add({lineAngle:45,x:1,y:0,offsetX:0,offsetY:20,dashLengthItems:[]}),Ai.set("JIS_LC_8",k3);const I3=new gi("JIS_LC_8A");I3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:7.8,dashLengthItems:[]}),I3.add({lineAngle:45,x:.4,y:0,offsetX:0,offsetY:7.8,dashLengthItems:[]}),Ai.set("JIS_LC_8A",I3);const D3=new gi("JIS_RC_10");D3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:7.8,dashLengthItems:[]}),D3.add({lineAngle:45,x:1,y:0,offsetX:0,offsetY:7.8,dashLengthItems:[]}),Ai.set("JIS_RC_10",D3);const Cx=new gi("JIS_RC_15");Cx.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:10,dashLengthItems:[]}),Cx.add({lineAngle:45,x:.725,y:0,offsetX:0,offsetY:10,dashLengthItems:[]}),Cx.add({lineAngle:45,x:1.45,y:0,offsetX:0,offsetY:10,dashLengthItems:[]}),Ai.set("JIS_RC_15",Cx);const _x=new gi("JIS_RC_18");_x.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:15,dashLengthItems:[]}),_x.add({lineAngle:45,x:.725,y:0,offsetX:0,offsetY:15,dashLengthItems:[]}),_x.add({lineAngle:45,x:1.45,y:0,offsetX:0,offsetY:15,dashLengthItems:[]}),Ai.set("JIS_RC_18",_x);const Sx=new gi("JIS_RC_30");Sx.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:18,dashLengthItems:[]}),Sx.add({lineAngle:45,x:1,y:0,offsetX:0,offsetY:18,dashLengthItems:[]}),Sx.add({lineAngle:45,x:2,y:0,offsetX:0,offsetY:18,dashLengthItems:[]}),Ai.set("JIS_RC_30",Sx);const Tx=new gi("JIS_STN_1E");Tx.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:30,dashLengthItems:[]}),Tx.add({lineAngle:45,x:1,y:0,offsetX:0,offsetY:30,dashLengthItems:[]}),Tx.add({lineAngle:45,x:2,y:0,offsetX:0,offsetY:30,dashLengthItems:[]}),Ai.set("JIS_STN_1E",Tx);const j3=new gi("JIS_STN_2_5");j3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:1,dashLengthItems:[]}),j3.add({lineAngle:45,x:.705,y:0,offsetX:0,offsetY:1,dashLengthItems:[1,-.5]}),Ai.set("JIS_STN_2_5",j3);const P3=new gi("JIS_WOOD");P3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:2.5,dashLengthItems:[]}),P3.add({lineAngle:45,x:1.765,y:0,offsetX:0,offsetY:2.5,dashLengthItems:[1.2,-.5]}),Ai.set("JIS_WOOD",P3);const wP=new gi("LINE");wP.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:.70710678,dashLengthItems:[]}),Ai.set("LINE",wP);const vP=new gi("MUDST");vP.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),Ai.set("MUDST",vP);const xP=new gi("NET");xP.add({lineAngle:0,x:0,y:0,offsetX:12.7,offsetY:6.35,dashLengthItems:[6.35,-6.35,0,-6.35,0,-6.35]}),Ai.set("NET",xP);const N3=new gi("NET3");N3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),N3.add({lineAngle:90,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),Ai.set("NET3",N3);const Bx=new gi("PLAST");Bx.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),Bx.add({lineAngle:60,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),Bx.add({lineAngle:120,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),Ai.set("PLAST",Bx);const Ex=new gi("PLASTI");Ex.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[]}),Ex.add({lineAngle:0,x:0,y:.79375,offsetX:0,offsetY:6.35,dashLengthItems:[]}),Ex.add({lineAngle:0,x:0,y:1.5875,offsetX:0,offsetY:6.35,dashLengthItems:[]}),Ai.set("PLASTI",Ex);const h2=new gi("SACNCR");h2.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[]}),h2.add({lineAngle:0,x:0,y:.79375,offsetX:0,offsetY:6.35,dashLengthItems:[]}),h2.add({lineAngle:0,x:0,y:1.5875,offsetX:0,offsetY:6.35,dashLengthItems:[]}),h2.add({lineAngle:0,x:0,y:3.96875,offsetX:0,offsetY:6.35,dashLengthItems:[]}),Ai.set("SACNCR",h2);const L3=new gi("SQUARE");L3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:2.38125,dashLengthItems:[]}),L3.add({lineAngle:45,x:1.6838,y:0,offsetX:0,offsetY:2.38125,dashLengthItems:[0,-2.38125]}),Ai.set("SQUARE",L3);const M3=new gi("STARS");M3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[3.175,-3.175]}),M3.add({lineAngle:90,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[3.175,-3.175]}),Ai.set("STARS",M3);const Fx=new gi("STEEL");Fx.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5.4992613154,dashLengthItems:[3.175,-3.175]}),Fx.add({lineAngle:60,x:0,y:0,offsetX:0,offsetY:5.4992613154,dashLengthItems:[3.175,-3.175]}),Fx.add({lineAngle:120,x:1.5875,y:2.7496306704,offsetX:0,offsetY:5.4992613154,dashLengthItems:[3.175,-3.175]}),Ai.set("STEEL",Fx);const R3=new gi("SWAMP");R3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),R3.add({lineAngle:45,x:0,y:1.5875,offsetX:0,offsetY:3.175,dashLengthItems:[]}),Ai.set("SWAMP",R3);const mg=new gi("TRANS");mg.add({lineAngle:0,x:0,y:0,offsetX:12.7,offsetY:21.9970452362,dashLengthItems:[3.175,-22.225]}),mg.add({lineAngle:90,x:1.5875,y:0,offsetX:21.9970452362,offsetY:12.7,dashLengthItems:[1.5875,-42.4065904724]}),mg.add({lineAngle:90,x:1.984375,y:0,offsetX:21.9970452362,offsetY:12.7,dashLengthItems:[1.27,-42.7240904724]}),mg.add({lineAngle:90,x:1.190625,y:0,offsetX:21.9970452362,offsetY:12.7,dashLengthItems:[1.27,-42.7240904724]}),mg.add({lineAngle:60,x:2.38125,y:0,offsetX:12.7,offsetY:21.9970452362,dashLengthItems:[1.016,-24.384]}),mg.add({lineAngle:120,x:.79375,y:0,offsetX:12.7,offsetY:21.9970452362,dashLengthItems:[1.016,-24.384]}),Ai.set("TRANS",mg);const U3=new gi("TRIANG");U3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[]}),U3.add({lineAngle:0,x:0,y:3.175,offsetX:0,offsetY:6.35,dashLengthItems:[3.175,-3.175]}),Ai.set("TRIANG",U3);const kx=new gi("ZIGZAG");kx.add({lineAngle:60,x:0,y:0,offsetX:4.7625,offsetY:8.2488919604,dashLengthItems:[4.7625,-4.7625]}),kx.add({lineAngle:120,x:0,y:0,offsetX:4.7625,offsetY:8.2488919604,dashLengthItems:[4.7625,-4.7625]}),kx.add({lineAngle:0,x:-2.38125,y:4.1244459802,offsetX:4.7625,offsetY:8.2488919604,dashLengthItems:[4.7625,-4.7625]}),Ai.set("ZIGZAG",kx);let bP=class zQ{static fromHex(e){return e.startsWith("#")&&(e=e.replace("#","")),parseInt(e,16)}static fromRGB(e,t,i){const r=[e,t,i].reduce(((s,o)=>{const a=o.toString(16);return`${s}${a.length===1?"0"+a:a}`}),"0x00");return zQ.fromHex(r)}},hl=class{constructor(e,t,i){this.type=e,this.subclassMarker=t,this.layerName=i==null?void 0:i.layerName,this.handle=mA.next(),this.trueColor=i==null?void 0:i.trueColor,this.inPaperSpace=!1,this.colorNumber=i==null?void 0:i.colorNumber,this.visible=i==null?void 0:i.visible,this.lineType=i==null?void 0:i.lineType,this.lineTypeScale=i==null?void 0:i.lineTypeScale,this.extrusion=i==null?void 0:i.extrusion,this.xdatas=[]}boundingBox(){return ya.pointBBox(bt())}addXData(e){const t=new Ede(e);return this.xdatas.push(t),t}dxfy(e){var t,i,r;e.type(this.type),e.handle(this.handle),e.push(330,this.ownerBlockRecord),e.subclassMarker("AcDbEntity"),this.inPaperSpace&&e.push(67,Number(this.inPaperSpace)),e.push(420,this.trueColor),e.layerName(this.layerName||Om.layerZeroName),e.lineType(this.lineType),e.colorNumber(this.colorNumber),e.push(48,this.lineTypeScale),e.visibilty(this.visible),e.subclassMarker(this.subclassMarker),this.type!=="HATCH"&&(e.push(210,(t=this.extrusion)===null||t===void 0?void 0:t.x),e.push(220,(i=this.extrusion)===null||i===void 0?void 0:i.y),e.push(230,(r=this.extrusion)===null||r===void 0?void 0:r.z)),this.dxfyChild(e),this.xdatas.forEach((s=>s.dxfy(e)))}};var Cf,fE,CP;(function(n){n[n.Default=0]="Default",n[n.Aligned=1]="Aligned",n[n.Angular=2]="Angular",n[n.Diameter=3]="Diameter",n[n.Radius=4]="Radius",n[n.Angular3Point=5]="Angular3Point",n[n.Ordinate=6]="Ordinate",n[n.ReferencedByThis=32]="ReferencedByThis",n[n.OrdinateType=64]="OrdinateType"})(Cf||(Cf={})),(function(n){n[n.TopLeft=1]="TopLeft",n[n.TopCenter=2]="TopCenter",n[n.TopRight=3]="TopRight",n[n.MiddleLeft=4]="MiddleLeft",n[n.MiddleCenter=5]="MiddleCenter",n[n.MiddleRight=6]="MiddleRight",n[n.BottomLeft=7]="BottomLeft",n[n.BottomCenter=8]="BottomCenter",n[n.BottomRight=9]="BottomRight"})(fE||(fE={})),(function(n){n[n.AtLeast=1]="AtLeast",n[n.Exact=2]="Exact"})(CP||(CP={}));let D1=class extends hl{constructor(e){super("DIMENSION","AcDbDimension",e),this.blockName=e==null?void 0:e.blockName,this.definitionPoint=e==null?void 0:e.definitionPoint,this.middlePoint=e==null?void 0:e.middlePoint,this.dimensionType=Cf.Default,this.attachmentPoint=(e==null?void 0:e.attachmentPoint)||fE.MiddleCenter,this.textLineSpacingStyle=e==null?void 0:e.textLineSpacingStyle,this.textLineSpacingFactor=e==null?void 0:e.textLineSpacingFactor,this.ActualMeasurement=e==null?void 0:e.ActualMeasurement,this.text=e==null?void 0:e.text,this.rotation=e==null?void 0:e.rotation,this.horizontalDirection=e==null?void 0:e.horizontalDirection,this.styleName=e==null?void 0:e.styleName}dxfyChild(e){e.push(2,this.blockName),e.point3d(this.definitionPoint),e.point3d(this.middlePoint,1),e.push(70,this.dimensionType),e.push(71,this.attachmentPoint),e.push(72,this.textLineSpacingStyle),e.push(41,this.textLineSpacingFactor),e.push(42,this.ActualMeasurement),e.push(1,this.text),e.push(53,this.rotation==="auto"?this.rotate():this.rotation),e.push(51,this.horizontalDirection),e.push(3,this.styleName)}};const r_=/[<>/\\":;?*|=`]/g;function yy(n){return n*Math.PI/180}function Fde(n,e){const t=(function(i,r){return Math.sqrt(Math.pow(i.x-r.x,2)+Math.pow(i.y-r.y,2))})(n,e);return t===0?t:180*Math.asin(Math.abs(n.y-e.y)/t)/Math.PI}let kde=class extends D1{constructor(e,t,i){super(i),this.dimensionType=Cf.Aligned,this.insertionPoint=i==null?void 0:i.insertionPoint,this.fisrtPoint=e,this.secondPoint=t,this.offset(i==null?void 0:i.offset)}offset(e){if(e==null)return;const[t,i]=(function(s,o){const a=s.x-o.x;let l=0;return a!==0&&(l=(s.y-o.y)/a),[l,s.y-l*s.x]})(this.fisrtPoint,this.secondPoint),r=(function(s,o){const[a,l]=o;return l-s*Math.sqrt(a*a+1)})(e,[t,i]);this.definitionPoint=(function(s,o){const[a,l]=s,h=a??-1/a,u=o.y-h*o.x,d=h-a;let A=l-u;return d!==0&&(A=(l-u)/d),bt(A,a*A+l,o.z)})([t,r],this.fisrtPoint)}rotate(){return Fde(this.fisrtPoint,this.secondPoint)}dxfyChild(e){super.dxfyChild(e),e.subclassMarker("AcDbAlignedDimension"),e.point3d(this.insertionPoint,2),e.point3d(this.fisrtPoint,3),e.point3d(this.secondPoint,4)}},Ide=class extends D1{constructor(e,t,i,r){super(r),this.first=e,this.second=t,this.location=i,this.dimensionType=Cf.Angular}rotate(){return 0}_update(){this.definitionPoint=this.second.end}dxfyChild(e){this._update(),super.dxfyChild(e),e.subclassMarker("AcDb2LineAngularDimension"),e.point3d(this.first.start,3),e.point3d(this.first.end,4),e.point3d(this.second.start,5),e.point3d(this.location,6)}},Dde=class extends D1{constructor(e,t,i,r){super(r),this.center=e,this.first=t,this.second=i,this.dimensionType=Cf.Angular3Point}rotate(){return 0}dxfyChild(e){super.dxfyChild(e),e.subclassMarker("AcDb3PointAngularDimension"),e.point3d(this.first,3),e.point3d(this.second,4),e.point3d(this.center,5)}},jde=class extends D1{constructor(e,t,i){super(i),this.dimensionType=Cf.Diameter,this.first=e,this.definitionPoint=t,this.leaderLength=i==null?void 0:i.leaderLength}rotate(){return 0}dxfyChild(e){super.dxfyChild(e),e.subclassMarker("AcDbDiametricDimension"),e.point3d(this.first,5),e.push(40,this.leaderLength)}},Pde=class extends D1{constructor(e,t,i){var r;super(i),this.dimensionType=Cf.Default,this.insertionPoint=i==null?void 0:i.insertionPoint,this.fisrtPoint=e,this.secondPoint=t,this.angle=(r=i==null?void 0:i.angle)!==null&&r!==void 0?r:0,this.linearType=i==null?void 0:i.linearType,this.offset(i==null?void 0:i.offset)}offset(e){if(e==null)return;const t=yy(this.angle),i=this.fisrtPoint.x+e*Math.floor(Math.sin(t)),r=this.fisrtPoint.y+e*Math.floor(Math.cos(t));this.definitionPoint=bt(i,r,0)}rotate(){return this.angle}dxfyChild(e){super.dxfyChild(e),e.subclassMarker("AcDbAlignedDimension"),e.point3d(this.insertionPoint,2),e.point3d(this.fisrtPoint,3),e.point3d(this.secondPoint,4),e.push(50,this.angle),e.push(52,this.linearType),e.subclassMarker("AcDbRotatedDimension")}},Nde=class extends D1{constructor(e,t,i){super(i),this.dimensionType=Cf.Radius,this.first=e,this.definitionPoint=t,this.leaderLength=i==null?void 0:i.leaderLength}rotate(){return 0}dxfyChild(e){super.dxfyChild(e),e.subclassMarker("AcDbRadialDimension"),e.point3d(this.first,5),e.push(40,this.leaderLength)}},Lde=class extends hl{get start(){return bt(this.center.x+this.radius*Math.cos(yy(this.startAngle)),this.center.y+this.radius*Math.sin(yy(this.startAngle)))}get end(){return bt(this.center.x+this.radius*Math.cos(yy(this.endAngle)),this.center.y+this.radius*Math.sin(yy(this.endAngle)))}constructor(e,t,i,r,s){super("ARC","AcDbCircle",s),this.center=e,this.radius=t,this.startAngle=i,this.endAngle=r}boundingBox(){return ya.centerRadiusBBox(this.center,this.radius)}dxfyChild(e){e.point3d(this.center),e.push(40,this.radius),e.subclassMarker("AcDbArc"),e.push(50,this.startAngle),e.push(51,this.endAngle)}},Mde=class extends hl{constructor(e,t,i,r,s){super("ATTDEF","AcDbText",s),this.position=e,this.height=t,this.value=r,this.tag=i,this.textStyle="STANDARD",this.rotation=s==null?void 0:s.rotation,this.obliqueAngle=s==null?void 0:s.obliqueAngle,this.generationFlags=s==null?void 0:s.generationFlags,this.horizontalAlignment=s==null?void 0:s.horizontalAlignment,this.verticalAlignment=s==null?void 0:s.verticalAlignment,this.secondAlignmentPoint=s==null?void 0:s.secondAlignmentPoint,this.relativeXScaleFactor=s==null?void 0:s.relativeXScaleFactor}boundingBox(){return ya.pointBBox(this.position)}dxfyChild(e){e.point3d(this.position),e.push(40,this.height),e.primaryText(this.value),e.push(50,this.rotation),e.push(41,this.relativeXScaleFactor),e.push(51,this.obliqueAngle),e.textStyle(this.textStyle),e.push(71,this.generationFlags),e.push(72,this.horizontalAlignment),this.secondAlignmentPoint&&(e.push(11,this.secondAlignmentPoint.x),e.push(21,this.secondAlignmentPoint.y),e.push(31,this.secondAlignmentPoint.z)),e.push(73,this.verticalAlignment),e.subclassMarker("AcDbAttributeDefinition"),e.push(280,0),e.push(3,""),e.push(2,this.tag),e.push(70,0)}},Rde=class extends hl{constructor(e,t,i,r,s){super("ATTRIB","AcDbText",s),this.position=e,this.height=t,this.value=r,this.tag=i,this.textStyle="STANDARD",this.rotation=s==null?void 0:s.rotation,this.obliqueAngle=s==null?void 0:s.obliqueAngle,this.generationFlags=s==null?void 0:s.generationFlags,this.horizontalAlignment=s==null?void 0:s.horizontalAlignment,this.verticalAlignment=s==null?void 0:s.verticalAlignment,this.secondAlignmentPoint=s==null?void 0:s.secondAlignmentPoint,this.relativeXScaleFactor=s==null?void 0:s.relativeXScaleFactor}boundingBox(){return ya.pointBBox(this.position)}dxfyChild(e){e.point3d(this.position),e.push(40,this.height),e.primaryText(this.value),e.push(50,this.rotation),e.push(41,this.relativeXScaleFactor),e.push(51,this.obliqueAngle),e.textStyle(this.textStyle),e.push(71,this.generationFlags),e.push(72,this.horizontalAlignment),e.point3d(this.secondAlignmentPoint,1),e.push(73,this.verticalAlignment),e.subclassMarker("AcDbAttribute"),e.push(280,0),e.push(2,this.tag),e.push(70,0)}},Ude=class extends hl{constructor(e,t,i){super("CIRCLE","AcDbCircle",i),this.center=e,this.radius=t}boundingBox(){return ya.centerRadiusBBox(this.center,this.radius)}dxfyChild(e){e.point3d(this.center),e.push(40,this.radius)}},Ode=class extends hl{constructor(e,t,i,r,s,o){super("ELLIPSE","AcDbEllipse",o),this.center=e,this.endPointOfMajorAxis=t,this.ratioOfMinorAxisToMajorAxis=i,this.startParameter=r,this.endParameter=s}boundingBox(){const e=this.center.x,t=this.center.y,i=this.endPointOfMajorAxis.x,r=this.endPointOfMajorAxis.y,s=Math.sqrt(Math.pow(e-(e+i),2)+Math.pow(t-(t+r),2));return ya.centerRadiusBBox(this.center,s)}dxfyChild(e){e.point3d(this.center),e.point3d(this.endPointOfMajorAxis,1),e.push(40,this.ratioOfMinorAxisToMajorAxis),e.push(41,this.startParameter),e.push(42,this.endParameter)}};var vu,s_,pE,_P,qy,gE,mE,yE,GA,o_,Zy,wE,vE,xE,bE,a_,SP,TP,BP,l_,CE,_E,SE,EP,FP,kP,IP,DP,jP,PP,TE,BE,c_,EE;(function(n){n[n.None=0]="None",n[n.First=1]="First",n[n.Second=2]="Second",n[n.Third=4]="Third",n[n.Fourth=8]="Fourth"})(vu||(vu={}));let Hde=class extends hl{constructor(e,t,i,r,s){super("3DFACE","AcDbFace",s),this.firstCorner=e,this.secondCorner=t,this.thirdCorner=i,this.fourthCorner=r,this.invisibleEdges=(s==null?void 0:s.invisibleEdges)||vu.None}setFirstEdgeVisible(e){this.setEdgeVisible(vu.First,e)}setSecondEdgeVisible(e){this.setEdgeVisible(vu.Second,e)}setThirdEdgeVisible(e){this.setEdgeVisible(vu.Third,e)}setFourthEdgeVisible(e){this.setEdgeVisible(vu.Fourth,e)}setEdgesVisible(e){this.invisibleEdges=e?vu.None:vu.First|vu.Second|vu.Third|vu.Fourth}setEdgeVisible(e,t){t?this.invisibleEdges|=e:this.invisibleEdges===(this.invisibleEdges|e)&&(this.invisibleEdges^=e)}boundingBox(){return ya.verticesBBox([this.firstCorner,this.secondCorner,this.thirdCorner,this.fourthCorner])}dxfyChild(e){e.point3d(this.firstCorner),e.point3d(this.secondCorner,1),e.point3d(this.thirdCorner,2),e.point3d(this.fourthCorner,3),e.push(70,this.invisibleEdges)}};(function(n){n.SOLID="SOLID",n.ANGLE="ANGLE",n.ANSI31="ANSI31",n.ANSI32="ANSI32",n.ANSI33="ANSI33",n.ANSI34="ANSI34",n.ANSI35="ANSI35",n.ANSI36="ANSI36",n.ANSI37="ANSI37",n.ANSI38="ANSI38",n.AR_B816="AR_B816",n.AR_B816C="AR_B816C",n.AR_B88="AR_B88",n.AR_BRELM="AR_BRELM",n.AR_BRSTD="AR_BRSTD",n.AR_CONC="AR_CONC",n.AR_HBONE="AR_HBONE",n.AR_PARQ1="AR_PARQ1",n.AR_RROOF="AR_RROOF",n.AR_RSHKE="AR_RSHKE",n.AR_SAND="AR_SAND",n.BOX="BOX",n.BRASS="BRASS",n.BRICK="BRICK",n.BRSTONE="BRSTONE",n.CLAY="CLAY",n.CORK="CORK",n.CROSS="CROSS",n.DASH="DASH",n.DOLMIT="DOLMIT",n.DOTS="DOTS",n.EARTH="EARTH",n.ESCHER="ESCHER",n.FLEX="FLEX",n.GOST_GLASS="GOST_GLASS",n.GOST_WOOD="GOST_WOOD",n.GOST_GROUND="GOST_GROUND",n.GRASS="GRASS",n.GRATE="GRATE",n.GRAVEL="GRAVEL",n.HEX="HEX",n.HONEY="HONEY",n.HOUND="HOUND",n.INSUL="INSUL",n.ACAD_ISO02W100="ACAD_ISO02W100",n.ACAD_ISO03W100="ACAD_ISO03W100",n.ACAD_ISO04W100="ACAD_ISO04W100",n.ACAD_ISO05W100="ACAD_ISO05W100",n.ACAD_ISO06W100="ACAD_ISO06W100",n.ACAD_ISO07W100="ACAD_ISO07W100",n.ACAD_ISO08W100="ACAD_ISO08W100",n.ACAD_ISO09W100="ACAD_ISO09W100",n.ACAD_ISO10W100="ACAD_ISO10W100",n.ACAD_ISO11W100="ACAD_ISO11W100",n.ACAD_ISO12W100="ACAD_ISO12W100",n.ACAD_ISO13W100="ACAD_ISO13W100",n.ACAD_ISO14W100="ACAD_ISO14W100",n.ACAD_ISO15W100="ACAD_ISO15W100",n.JIS_LC_20="JIS_LC_20",n.JIS_LC_20A="JIS_LC_20A",n.JIS_LC_8="JIS_LC_8",n.JIS_LC_8A="JIS_LC_8A",n.JIS_RC_10="JIS_RC_10",n.JIS_RC_15="JIS_RC_15",n.JIS_RC_18="JIS_RC_18",n.JIS_RC_30="JIS_RC_30",n.JIS_STN_1E="JIS_STN_1E",n.JIS_STN_2_5="JIS_STN_2_5",n.JIS_WOOD="JIS_WOOD",n.LINE="LINE",n.MUDST="MUDST",n.NET="NET",n.NET3="NET3",n.PLAST="PLAST",n.PLASTI="PLASTI",n.SACNCR="SACNCR",n.SQUARE="SQUARE",n.STARS="STARS",n.STEEL="STEEL",n.SWAMP="SWAMP",n.TRANS="TRANS",n.TRIANG="TRIANG",n.ZIGZAG="ZIGZAG"})(s_||(s_={})),(function(n){n[n.UserDefined=0]="UserDefined",n[n.Predifined=1]="Predifined",n[n.Custom=2]="Custom"})(pE||(pE={}));(function(n){n[n.Default=0]="Default",n[n.External=1]="External",n[n.Polyline=2]="Polyline",n[n.Derived=4]="Derived",n[n.Textbox=8]="Textbox",n[n.Outermost=16]="Outermost"})(_P||(_P={}));(function(n){n[n.SolidFill=1]="SolidFill",n[n.PatternFill=0]="PatternFill"})(qy||(qy={})),(function(n){n[n.NonAssociative=0]="NonAssociative",n[n.Associative=1]="Associative"})(gE||(gE={})),(function(n){n[n.Normal=0]="Normal",n[n.Outer=1]="Outer",n[n.Ignore=2]="Ignore"})(mE||(mE={})),(function(n){n.LINEAR="LINEAR",n.CYLINDER="CYLINDER",n.INVCYLINDER="INVCYLINDER",n.SPHERICAL="SPHERICAL",n.HEMISPHERICAL="HEMISPHERICAL",n.CURVED="CURVED",n.INVSPHERICAL="SPHERICAL",n.INVHEMISPHERICAL="INVHEMISPHERICAL",n.INVCURVED="INVCURVED"})(yE||(yE={}));let Wde=class extends hl{get patternName(){let e=s_.SOLID;return this.isPattern(this.fill)&&(e=this.fill.name),e}get solidFillFlag(){return this.patternName===s_.SOLID?qy.SolidFill:qy.PatternFill}constructor(e,t,i){super("HATCH","AcDbHatch",i),this.fill=t,this.elevation=(i==null?void 0:i.elevation)||0,this.extrusion=(i==null?void 0:i.extrusion)||bt(0,0,1),this.boundaryPath=e}pattern(e,t){var i;const r=t.name,s=(i=t.angle)!==null&&i!==void 0?i:0,o=t.scale||1,a=t.double||!1;e.push(52,s),e.push(41,o),e.push(77,Number(a));const l=Ai.get(r);l&&(l.scale=o,s!==0&&(l.angle=s),l.dxfy(e))}gradient(e,t){var i,r,s;const o=t.firstColor,a=(i=t.secondColor)!==null&&i!==void 0?i:7,l=(r=t.angle)!==null&&r!==void 0?r:0,h=t.definition||0,u=(s=t.tint)!==null&&s!==void 0?s:1,d=t.type||yE.LINEAR;e.push(450,1),e.push(451,0),e.push(460,l),e.push(461,h),e.push(452,t.secondColor?0:1),e.push(462,u),e.push(453,2),e.push(463,0),e.push(63,o),e.push(421,bP.fromHex(nP(o))),e.push(463,1),e.push(63,a),e.push(421,bP.fromHex(nP(a))),e.push(470,d)}isPattern(e){return"name"in e}boundingBox(){return ya.pointBBox(bt(0,0))}dxfyChild(e){var t,i,r;e.point3d(bt(0,0,this.elevation)),e.push(210,(t=this.extrusion)===null||t===void 0?void 0:t.x),e.push(220,(i=this.extrusion)===null||i===void 0?void 0:i.y),e.push(230,(r=this.extrusion)===null||r===void 0?void 0:r.z),e.name(this.patternName),e.push(70,this.solidFillFlag),e.push(71,gE.NonAssociative),e.push(91,this.boundaryPath.length),this.boundaryPath.dxfy(e),e.push(75,mE.Outer),e.push(76,pE.Predifined),this.isPattern(this.fill)?(this.solidFillFlag===qy.PatternFill&&this.pattern(e,this.fill),e.push(47,1),e.push(98,0)):(e.push(47,1),e.push(98,0),this.gradient(e,this.fill))}};(function(n){n[n.ShowImage=1]="ShowImage",n[n.ShowImageWhenNotAlignedWithScreen=2]="ShowImageWhenNotAlignedWithScreen",n[n.UseClippingBoundary=4]="UseClippingBoundary",n[n.TransparencyIsOn=8]="TransparencyIsOn"})(o_||(o_={})),(function(n){n[n.Rectangular=1]="Rectangular",n[n.Polygonal=2]="Polygonal"})(Zy||(Zy={})),(function(n){n[n.Off=0]="Off",n[n.On=1]="On"})(wE||(wE={})),(function(n){n[n.Outside=0]="Outside",n[n.Inside=1]="Inside"})(vE||(vE={}));let zde=class extends hl{constructor(e,t){super("IMAGE","AcDbRasterImage",t),GA.set(this,void 0),this.width=e.width,this.height=e.height,this.scale=e.scale,this.rotation=e.rotation,this.insertionPoint=e.insertionPoint,this.ratio=this.scale/this.width,this.imageDefHandle=e.imageDefHandle,this.imageDisplayFlags=(t==null?void 0:t.imageDisplayFlags)||o_.ShowImage|o_.ShowImageWhenNotAlignedWithScreen,this.clippingStateFlag=(t==null?void 0:t.clippingStateFlag)||wE.On,this.clipModeFlag=(t==null?void 0:t.clipModeFlag)||vE.Inside,this.clippingType=(t==null?void 0:t.clippingType)||Zy.Rectangular,this.brightness=(t==null?void 0:t.brightness)||50,this.contrast=(t==null?void 0:t.brightness)||50,this.fade=(t==null?void 0:t.fade)||0,my(this,GA,[]),this.classVersion=(t==null?void 0:t.classVersion)||0,this.resetClipping()}setClipBoundaryVerticies(e,t){if(t===Zy.Rectangular){if(e.length!=2)throw new Error("The number of vertices should be 2 in rectangular clipping !");my(this,GA,e)}else{if(!(e.length>=3))throw new Error("The number of vertices should be >= 3 in polygonal clipping !");my(this,GA,e)}my(this,GA,[]),_o(this,GA,"f").push(...e)}resetClipping(){const e=[la(-.5,-.5),la(this.width-.5,this.height-.5)];this.setClipBoundaryVerticies(e,Zy.Rectangular)}_vector(){return la(this.ratio*Math.cos(this.rotation*Math.PI/180),this.ratio*Math.sin(this.rotation*Math.PI/180))}_uVector(){const e=this._vector();return bt(e.x,-e.y,0)}_vVector(){const e=this._vector();return bt(e.y,e.x,0)}boundingBox(){const e=this.scale,t=this.width/this.height*this.scale,i=Math.sqrt(Math.pow(e,2)+Math.pow(t,2));return ya.centerRadiusBBox(this.insertionPoint,i)}dxfyChild(e){e.push(90,this.classVersion),e.point3d(this.insertionPoint),e.point3d(this._uVector(),1),e.point3d(this._vVector(),2),e.push(13,this.width),e.push(23,this.height),e.push(340,this.imageDefHandle),e.push(70,this.imageDisplayFlags),e.push(280,this.clippingStateFlag),e.push(281,this.brightness),e.push(282,this.contrast),e.push(283,this.fade),e.push(360,this.imageDefReactorHandle),e.push(71,this.clippingType),e.push(91,_o(this,GA,"f").length),_o(this,GA,"f").forEach((t=>e.point2d(t,4))),e.push(290,this.clipModeFlag)}};GA=new WeakMap;let Qde=class extends hl{constructor(e,t,i){var r,s,o,a,l,h;super("INSERT","AcDbBlockReference",i),this.blockName=e,this.insertionPoint=t,this.scaleFactor=(i==null?void 0:i.scaleFactor)||bt(1,1,1),this.rotationAngle=(r=i==null?void 0:i.rotationAngle)!==null&&r!==void 0?r:0,this.columnCount=(s=i==null?void 0:i.columnCount)!==null&&s!==void 0?s:1,this.rowCount=(o=i==null?void 0:i.rowCount)!==null&&o!==void 0?o:1,this.columnSpacing=(a=i==null?void 0:i.columnSpacing)!==null&&a!==void 0?a:0,this.rowSpacing=(l=i==null?void 0:i.rowSpacing)!==null&&l!==void 0?l:0,this.attributesFollowFlag=(h=i==null?void 0:i.rowSpacing)!==null&&h!==void 0?h:0}boundingBox(){return ya.pointBBox(this.insertionPoint)}dxfyChild(e){e.name(this.blockName),e.point3d(this.insertionPoint),e.push(41,this.scaleFactor.x),e.push(42,this.scaleFactor.y),e.push(43,this.scaleFactor.z),e.push(50,this.rotationAngle),e.push(66,this.attributesFollowFlag),e.push(70,this.columnCount),e.push(71,this.rowCount),e.push(44,this.columnSpacing),e.push(45,this.rowSpacing)}};(function(n){n[n.Disabed=0]="Disabed",n[n.Enabled=1]="Enabled"})(xE||(xE={})),(function(n){n[n.StraightLine=0]="StraightLine",n[n.Spline=1]="Spline"})(bE||(bE={}));let $de=class extends hl{constructor(e,t){var i,r;super("LEADER","AcDbLeader",t),this.vertices=e,this.flag=(i=t==null?void 0:t.flag)!==null&&i!==void 0?i:xE.Enabled,this.leaderPathType=(r=t==null?void 0:t.leaderPathType)!==null&&r!==void 0?r:bE.StraightLine,this.dimensionStyleName=(t==null?void 0:t.dimensionStyleName)||"Standard"}boundingBox(){return ya.verticesBBox(this.vertices)}dxfyChild(e){e.push(3,this.dimensionStyleName),e.push(71,this.flag),e.push(72,this.leaderPathType),e.push(76,this.vertices.length),this.vertices.forEach((t=>e.point3d(t)))}},Vde=class extends hl{constructor(e,t,i){super("LINE","AcDbLine",i),this.startPoint=e,this.endPoint=t}boundingBox(){return ya.lineBBox(this.startPoint,this.endPoint)}dxfyChild(e){e.point3d(this.startPoint),e.point3d(this.endPoint,1)}};(function(n){n[n.None=0]="None",n[n.Closed=1]="Closed",n[n.Plinegen=128]="Plinegen"})(a_||(a_={}));let Gde=class extends hl{constructor(e,t){super("LWPOLYLINE","AcDbPolyline",t),this.vertices=e,this.flags=(t==null?void 0:t.flags)||a_.None,this.constantWidth=(t==null?void 0:t.constantWidth)||0,this.elevation=(t==null?void 0:t.elevation)||0,this.thickness=(t==null?void 0:t.thickness)||0}boundingBox(){return ya.verticesBBox(this.vertices.map((e=>bt(e.point.x,e.point.y,0))))}dxfyChild(e){var t,i,r;e.push(90,this.vertices.length),e.push(70,this.flags||0),this.vertices.find((s=>{var o,a;return((o=s.startingWidth)!==null&&o!==void 0?o:0)>0&&((a=s.endWidth)!==null&&a!==void 0?a:0)>0}))||e.push(43,this.constantWidth),e.elevation(this.elevation),e.thickness(this.thickness);for(const s of this.vertices)e.point2d(s.point),e.push(40,s.startingWidth),e.push(41,s.endWidth),e.push(42,s.bulge);e.push(210,(t=this.extrusion)===null||t===void 0?void 0:t.x),e.push(220,(i=this.extrusion)===null||i===void 0?void 0:i.y),e.push(230,(r=this.extrusion)===null||r===void 0?void 0:r.z)}};(function(n){n[n.TopLeft=1]="TopLeft",n[n.TopCenter=2]="TopCenter",n[n.TopRight=3]="TopRight",n[n.MiddleLeft=4]="MiddleLeft",n[n.MiddleCenter=5]="MiddleCenter",n[n.MiddleRight=6]="MiddleRight",n[n.BottomLeft=7]="BottomLeft",n[n.BottomCenter=8]="BottomCenter",n[n.BottomRight=9]="BottomRight"})(SP||(SP={})),(function(n){n[n.LeftToRight=1]="LeftToRight",n[n.TopToBottom=3]="TopToBottom",n[n.ByStyle=5]="ByStyle"})(TP||(TP={})),(function(n){n[n.AtLeast=1]="AtLeast",n[n.Exact=2]="Exact"})(BP||(BP={}));let Xde=class extends hl{constructor(e,t,i,r){super("MTEXT","AcDbMText",r),this.position=e,this.height=t,this.value=i,this.textStyle="STANDARD",this.rotation=r==null?void 0:r.rotation,this.attachmentPoint=r==null?void 0:r.attachmentPoint,this.drawingDirection=r==null?void 0:r.drawingDirection,this.lineSpacingStyle=r==null?void 0:r.lineSpacingStyle,this.width=r==null?void 0:r.width}boundingBox(){return ya.pointBBox(this.position)}dxfyChild(e){e.point3d(this.position),e.push(40,this.height),e.push(41,this.width),e.push(71,this.attachmentPoint),e.push(72,this.drawingDirection),e.push(73,this.lineSpacingStyle),e.primaryText(this.value),e.push(50,this.rotation),e.textStyle(this.textStyle)}},Yde=class extends hl{constructor(e,t,i,r){super("POINT","AcDbPoint",r),this.x=e,this.y=t,this.z=i}boundingBox(){return ya.pointBBox(bt(this.x,this.y,this.z))}dxfyChild(e){e.point3d(bt(this.x,this.y,this.z))}};(function(n){n[n.None=0]="None",n[n.ExtraVertex=1]="ExtraVertex",n[n.CurveFit=2]="CurveFit",n[n.NotUsed=4]="NotUsed",n[n.SplineVertex=8]="SplineVertex",n[n.SplineFrame=16]="SplineFrame",n[n.Polyline3dVertex=32]="Polyline3dVertex",n[n.Polygon3dMesh=64]="Polygon3dMesh",n[n.PolyfaceMeshVertex=128]="PolyfaceMeshVertex"})(l_||(l_={}));let Kde=class extends hl{constructor(e,t){var i;super("VERTEX","AcDbVertex",t),this.point=e,this.flags=(i=t==null?void 0:t.flags)!==null&&i!==void 0?i:l_.None,t&&("startingWidth"in t&&(this.startingWidth=t.startingWidth),"endWidth"in t&&(this.endWidth=t.endWidth),"bulge"in t&&(this.bulge=t.bulge))}boundingBox(){return ya.pointBBox(this.point)}dxfyChild(e){e.subclassMarker("AcDb3dPolylineVertex"),e.point3d(this.point),e.push(40,this.startingWidth),e.push(41,this.endWidth),e.push(42,this.bulge),e.push(70,this.flags)}},QQ=class extends hl{dxfyChild(e){}constructor(){super("SEQEND")}};(function(n){n[n.None=0]="None",n[n.Closed=1]="Closed",n[n.CurveFit=2]="CurveFit",n[n.SplineFit=4]="SplineFit",n[n.Polyline3D=8]="Polyline3D",n[n.PolygonMesh3D=16]="PolygonMesh3D",n[n.PolygonMeshClosed=32]="PolygonMeshClosed",n[n.PolyfaceMesh=64]="PolyfaceMesh",n[n.LinetypeGenerated=128]="LinetypeGenerated"})(CE||(CE={})),(function(n){n[n.NoSmooth=0]="NoSmooth",n[n.QuadraticBSpline=5]="QuadraticBSpline",n[n.CubicBSpline=6]="CubicBSpline",n[n.Bezier=8]="Bezier"})(_E||(_E={}));let qde=class extends hl{constructor(e,t){var i,r,s,o,a,l,h,u,d,A;super("POLYLINE","AcDb3dPolyline",t),this._seqend=new QQ,this.vertices=[],this.thickness=(i=t==null?void 0:t.thickness)!==null&&i!==void 0?i:0,this.elevation=(r=t==null?void 0:t.elevation)!==null&&r!==void 0?r:0,this.flags=(s=t==null?void 0:t.flags)!==null&&s!==void 0?s:CE.None,this.defaultStartWidth=(o=t==null?void 0:t.defaultStartWidth)!==null&&o!==void 0?o:0,this.defaultEndWidth=(a=t==null?void 0:t.defaultEndWidth)!==null&&a!==void 0?a:0,this.polygonMeshM=(l=t==null?void 0:t.polygonMeshM)!==null&&l!==void 0?l:0,this.polygonMeshN=(h=t==null?void 0:t.polygonMeshN)!==null&&h!==void 0?h:0,this.smoothSurfaceM=(u=t==null?void 0:t.smoothSurfaceM)!==null&&u!==void 0?u:0,this.smoothSurfaceN=(d=t==null?void 0:t.smoothSurfaceN)!==null&&d!==void 0?d:0,this.surfaceType=(A=t==null?void 0:t.surfaceType)!==null&&A!==void 0?A:_E.NoSmooth,e.forEach((f=>this.vertices.push(new Kde(f.point,{startingWidth:f.startingWidth,endWidth:f.endWidth,bulge:f.bulge,flags:l_.Polyline3dVertex}))))}boundingBox(){return ya.verticesBBox(this.vertices.map((e=>e.point)))}dxfyChild(e){e.push(66,1),e.point3d(bt(0,0,this.elevation)),e.push(39,this.thickness),e.push(70,this.flags),e.push(40,this.defaultStartWidth),e.push(41,this.defaultEndWidth),e.push(71,this.polygonMeshM),e.push(72,this.polygonMeshN),e.push(73,this.smoothSurfaceM),e.push(74,this.smoothSurfaceN),e.push(75,this.surfaceType),this.vertices.forEach((t=>t.dxfy(e))),this._seqend.dxfy(e)}};(function(n){n[n.Closed=1]="Closed",n[n.Periodic=2]="Periodic",n[n.Rational=4]="Rational",n[n.Planar=8]="Planar",n[n.Linear=16]="Linear"})(SE||(SE={}));let Zde=class extends hl{constructor(e,t){var i,r;super("SPLINE","AcDbSpline",t),this.controlPoints=e.controlPoints,this.degreeCurve=(i=e.degreeCurve)!==null&&i!==void 0?i:3,this.flags=(r=e.flags)!==null&&r!==void 0?r:SE.Planar,this.knots=e.knots||[],this.weights=e.weights||[],this.fitPoints=e.fitPoints||[];const s=this.controlPoints.length,o=this.degreeCurve,a=o+1,l=this.fitPoints.length;if(s<a)throw new Error(`Number of control points should be >= ${a}.`);if(l!==0&&l<2)throw new Error("Number of fit points should be >= 2.");const h=o+s+1;if(this.knots.length===0){let u=0;for(let d=0;d<h;d++)d<=o||d>=s+1?this.knots.push(u):this.knots.push(++u)}if(this.knots.length!==h)throw new Error(`Number of knots should be ${h}.`)}boundingBox(){return ya.verticesBBox([...this.controlPoints,...this.fitPoints])}dxfyChild(e){e.push(70,this.flags),e.push(71,this.degreeCurve),e.push(72,this.knots.length),e.push(73,this.controlPoints.length),e.push(74,this.fitPoints.length),e.push(42,"0.0000001"),e.push(43,"0.0000001"),e.push(42,"0.0000000001"),this.knots.forEach((t=>e.push(40,t))),this.weights.forEach((t=>e.push(41,t))),this.controlPoints.forEach((t=>e.point3d(t))),this.fitPoints.forEach((t=>e.point3d(t,1)))}};(function(n){n[n.Text=1]="Text",n[n.Block=2]="Block"})(EP||(EP={})),(function(n){n[n.False=0]="False",n[n.True=1]="True"})(FP||(FP={})),(function(n){n[n.False=0]="False",n[n.True=1]="True"})(kP||(kP={})),(function(n){n[n.TopLeft=1]="TopLeft",n[n.TopCenter=2]="TopCenter",n[n.TopRight=3]="TopRight",n[n.MiddleLeft=4]="MiddleLeft",n[n.MiddleCenter=5]="MiddleCenter",n[n.MiddleRight=6]="MiddleRight",n[n.BottomLeft=7]="BottomLeft",n[n.BottomCenter=8]="BottomCenter",n[n.BottomRight=9]="BottomRight"})(IP||(IP={}));let Jde=class extends hl{constructor(e,t,i,r,s,o,a){super("ACAD_TABLE","AcDbBlockReference",a),this.blockName=e,this.position=t,this.numberOfRows=i,this.numberOfColumn=r,this.rowsHeight=s,this.columnsHeight=o,this.horizontalDirectionVector=(a==null?void 0:a.horizontalDirectionVector)||bt(1),this.cells=a==null?void 0:a.cell}boundingBox(){return ya.pointBBox(this.position)}dxfyChild(e){var t,i,r,s;e.name(this.blockName),e.point3d(this.position),e.subclassMarker("AcDbTable"),e.point3d(this.horizontalDirectionVector,1),e.push(91,this.numberOfRows),e.push(92,this.numberOfColumn);for(let o=0;o<this.numberOfRows;o++)e.push(141,(i=(t=this.rowsHeight[o])!==null&&t!==void 0?t:this.rowsHeight[0])!==null&&i!==void 0?i:1);for(let o=0;o<this.numberOfColumn;o++)e.push(142,(s=(r=this.columnsHeight[o])!==null&&r!==void 0?r:this.columnsHeight[0])!==null&&s!==void 0?s:1);this.cells.forEach((o=>o.dxfy(e)))}};(function(n){n[n.None=0]="None",n[n.Backward=2]="Backward",n[n.UpsideDown=4]="UpsideDown"})(DP||(DP={})),(function(n){n[n.Left=0]="Left",n[n.Center=1]="Center",n[n.Right=2]="Right",n[n.Aligned=3]="Aligned",n[n.Middle=4]="Middle",n[n.Fit=5]="Fit"})(jP||(jP={})),(function(n){n[n.BaseLine=0]="BaseLine",n[n.Bottom=1]="Bottom",n[n.Middle=2]="Middle",n[n.Top=3]="Top"})(PP||(PP={}));let eAe=class extends hl{constructor(e,t,i,r){super("TEXT","AcDbText",r),this.position=e,this.height=t,this.value=i,this.textStyle="STANDARD",this.rotation=r==null?void 0:r.rotation,this.obliqueAngle=r==null?void 0:r.obliqueAngle,this.generationFlags=r==null?void 0:r.generationFlags,this.horizontalAlignment=r==null?void 0:r.horizontalAlignment,this.verticalAlignment=r==null?void 0:r.verticalAlignment,this.secondAlignmentPoint=r==null?void 0:r.secondAlignmentPoint,this.relativeXScaleFactor=r==null?void 0:r.relativeXScaleFactor}boundingBox(){return ya.pointBBox(this.position)}dxfyChild(e){e.point3d(this.position),e.push(40,this.height),e.primaryText(this.value),e.push(50,this.rotation),e.push(41,this.relativeXScaleFactor),e.push(51,this.obliqueAngle),e.textStyle(this.textStyle),e.push(71,this.generationFlags),e.push(72,this.horizontalAlignment),e.point3d(this.secondAlignmentPoint,1),e.subclassMarker("AcDbText"),e.push(73,this.verticalAlignment)}},tAe=class{constructor(e,t,i){this.entities=[],this.handle=mA.next(),this.objects=e,this.blockRecord=t,this.layerName=i}dxfy(e){for(const t of this.entities)t.dxfy(e)}addHatch(e,t,i){const r=new Wde(e,t,i);return this.addEntity(r)}addEntity(e){return e.ownerBlockRecord=this.blockRecord.handle,this.blockRecord.isPaperSpace&&(e.inPaperSpace=!0),e.layerName==null&&(e.layerName=this.layerName),this.entities.push(e),e}addAttrib(e,t,i,r,s,o){s.attributesFollowFlag=1;const a=this.addEntity(new Rde(e,t,i,r,o));return this.addEntity(new QQ).ownerBlockRecord=s.handle,a}addAttdef(e,t,i,r,s){return this.addEntity(new Mde(e,t,i,r,s))}addAlignedDim(e,t,i){return this.addEntity(new kde(e,t,i))}addDiameterDim(e,t,i){return this.addEntity(new jde(e,t,i))}addRadialDim(e,t,i){return this.addEntity(new Nde(e,t,i))}addLinearDim(e,t,i){return this.addEntity(new Pde(e,t,i))}addAngularLinesDim(e,t,i,r){return this.addEntity(new Ide(e,t,i,r))}addAngularPointsDim(e,t,i,r){return this.addEntity(new Dde(e,t,i,r))}addLine(e,t,i){return this.addEntity(new Vde(e,t,i))}addLeader(e,t){return this.addEntity(new $de(e,t))}addLWPolyline(e,t){return this.addEntity(new Gde(e,t))}addRectangle(e,t,i){const r=[],s=e.x,o=e.y,a=t.x,l=t.y;if((i==null?void 0:i.fillet)!==void 0&&(i==null?void 0:i.chamfer)!==void 0)throw new Error("You cannot define both fillet and chamfer!");if((i==null?void 0:i.fillet)!==void 0){const h=i==null?void 0:i.fillet,u=Cde(h);r.push({point:la(s,o-h),bulge:u}),r.push({point:la(s+h,o)}),r.push({point:la(a-h,o),bulge:u}),r.push({point:la(a,o-h)}),r.push({point:la(a,l+h),bulge:u}),r.push({point:la(a-h,l)}),r.push({point:la(s+h,l),bulge:u}),r.push({point:la(s,l+h)})}else if((i==null?void 0:i.chamfer)!==void 0){const h=i==null?void 0:i.chamfer.first,u=(i==null?void 0:i.chamfer.second)||h;r.push({point:la(s,o-h)}),r.push({point:la(s+u,o)}),r.push({point:la(a-h,o)}),r.push({point:la(a,o-u)}),r.push({point:la(a,l+h)}),r.push({point:la(a-u,l)}),r.push({point:la(s+h,l)}),r.push({point:la(s,l+u)})}else r.push({point:la(s,o)}),r.push({point:la(a,o)}),r.push({point:la(a,l)}),r.push({point:la(s,l)});return this.addLWPolyline(r,Object.assign(Object.assign({},i),{flags:a_.Closed}))}addImage(e,t,i,r,s,o,a,l){const h=this.objects.addImageDef(e);h.width=r,h.height=s;const u=new zde({height:s,width:r,scale:o,rotation:a,insertionPoint:i,imageDefHandle:h.handle},l),d=this.objects.addImageDefReactor(u.handle);u.imageDefReactorHandle=d.handle,this.addEntity(u);const A=this.objects.addDictionary();return A.addEntryObject(t,h.handle),h.ownerObjecthandle=A.handle,this.objects.root.addEntryObject("ACAD_IMAGE_DICT",A.handle),h.acadImageDictHandle=A.handle,h.addImageDefReactorHandle(d.handle),u}addPolyline3D(e,t){return this.addEntity(new qde(e,t))}addPoint(e,t,i,r){return this.addEntity(new Yde(e,t,i,r))}addCircle(e,t,i){return this.addEntity(new Ude(e,t,i))}addArc(e,t,i,r,s){return this.addEntity(new Lde(e,t,i,r,s))}addSpline(e,t){return this.addEntity(new Zde(e,t))}addEllipse(e,t,i,r,s,o){const a=new Ode(e,t,i,r,s,o);return this.addEntity(a),a}add3dFace(e,t,i,r,s){return this.addEntity(new Hde(e,t,i,r,s))}addText(e,t,i,r){return this.addEntity(new eAe(e,t,i,r))}addMText(e,t,i,r){return this.addEntity(new Xde(e,t,i,r))}addInsert(e,t,i){return this.addEntity(new Qde(e,t,i||{}))}addTable(e,t,i,r,s,o,a){return this.addEntity(new Jde(e,t,i,r,s,o,a))}boundingBox(){const e=[];for(let t=0;t<this.entities.length;t++)e.push(this.entities[t].boundingBox());return ya.boundingBox(e)}centerView(){return ya.boundingBoxCenter(this.boundingBox())}viewHeight(){return ya.boundingBoxHeight(this.boundingBox())}};(function(n){n[n.None=0]="None",n[n.AnonymousBlock=1]="AnonymousBlock",n[n.HasNonConstantAttribute=2]="HasNonConstantAttribute",n[n.XRef=4]="XRef",n[n.XRefOverlay=8]="XRefOverlay",n[n.ExternallyDependent=16]="ExternallyDependent",n[n.ResolvedXRef=32]="ResolvedXRef",n[n.ReferencedXRef=64]="ReferencedXRef"})(TE||(TE={}));let nAe=class extends tAe{get isPaperSpace(){return this.name.startsWith("*Paper_Space")}get isModelSpace(){return this.name.startsWith("*Model_Space")}get isModelOrPaperSpace(){return this.isModelSpace||this.isPaperSpace}constructor(e,t,i){super(i,t,"0"),this.name=e,this.flags=TE.None,this.endBlk=new _de,this.ownerObjectHandle=t.handle,this.basePoint=bt(0,0,0),this.xrefPathName=""}setLayerName(e){this.layerName=e}dxfy(e){e.type("BLOCK"),e.handle(this.handle),e.push(330,this.ownerObjectHandle),e.subclassMarker("AcDbEntity"),e.layerName(this.layerName),e.subclassMarker("AcDbBlockBegin"),e.name(this.name),e.push(70,this.flags),e.point3d(this.basePoint),e.name(this.name,3),e.push(1,this.xrefPathName),this.isModelSpace||this.name==="*Paper_Space"||super.dxfy(e),this.endBlk.dxfy(e)}},iAe=class{constructor(e,t){this.blocks=[],this.paperSpaceSeed=0,this.tables=e,this.objects=t,this.modelSpace=this.addBlock("*Model_Space",t,!1),this.paperSpace=this.addBlock("*Paper_Space",t,!1)}addBlock(e,t,i=!0){i&&(e=e.replace(r_,""));const r=this.tables.addBlockRecord(e),s=new nAe(e,r,t);return this.blocks.push(s),s}addPaperSpace(){const e="*Paper_Space"+this.paperSpaceSeed++;return this.addBlock(e,this.objects,!1)}dxfy(e){e.start("BLOCKS"),this.blocks.forEach((t=>t.dxfy(e))),e.end()}},rAe=class{dxfy(e){e.start("CLASSES"),e.end()}},sAe=class{constructor(e){this.blocks=e,this.modelSpace=e.modelSpace,this.paperSpace=e.paperSpace}setLayerName(e){this.modelSpace.setLayerName(e)}dxfy(e){e.start("ENTITIES"),this.paperSpace.entities.forEach((t=>t.dxfy(e))),this.modelSpace.entities.forEach((t=>t.dxfy(e))),e.end()}},oAe=class{constructor(e,t){this.values=t,this.name=e}dxfy(e){e.variableName(this.name),Object.entries(this.values).forEach((t=>{const[i,r]=t;e.push(parseInt(i),r)}))}},aAe=class{constructor(){this.variables=[]}setVariable(e,t){const i=this.variables.find((r=>r.name===e));i?i.values=t:this.variables.push(new oAe(e,t))}dxfy(e){e.start("HEADER"),this.variables.forEach((t=>t.dxfy(e))),e.end()}},Rk=class{constructor(e){this.type=e,this.ownerObjecthandle="0",this.handle=mA.next()}dxfy(e){e.type(this.type),e.handle(this.handle),e.push(330,this.ownerObjecthandle)}},NP=class extends Rk{constructor(){super("DICTIONARY"),this.entries=[],this.duplicateRecordCloningFlag=0}addEntryObject(e,t){this.entries.push({name:e,entryObjectHandle:t})}dxfy(e){super.dxfy(e),e.subclassMarker("AcDbDictionary"),e.push(280,this.hardOwnerFlag),e.push(281,this.duplicateRecordCloningFlag);for(const t of this.entries)e.push(3,t.name),e.push(350,t.entryObjectHandle)}};(function(n){n[n.NoUnits=0]="NoUnits",n[n.Centimeters=2]="Centimeters",n[n.Inch=5]="Inch"})(BE||(BE={}));let lAe=class extends Rk{constructor(e){super("IMAGEDEF"),this.path=e,this.acadImageDictHandle="",this.imageReactorHandles=[],this.width=1,this.height=1,this.widthPixelSize=1,this.heightPixelSize=1,this.loaded=!0,this.resolutionUnits=BE.NoUnits}addImageDefReactorHandle(e){this.imageReactorHandles.push(e)}dxfy(e){super.dxfy(e);const t=new Tde("ACAD_REACTORS");t.add(330,this.acadImageDictHandle);for(const i of this.imageReactorHandles)t.add(330,i);t.dxfy(e),e.subclassMarker("AcDbRasterImageDef"),e.push(1,this.path),e.point2d(la(this.width,this.height)),e.push(11,this.widthPixelSize),e.push(21,this.heightPixelSize),e.push(280,Number(this.loaded)),e.push(281,this.resolutionUnits)}},cAe=class extends Rk{constructor(e){super("IMAGEDEF_REACTOR"),this.imageHandle=e,this.classVersion=2}dxfy(e){super.dxfy(e),e.subclassMarker("AcDbRasterImageDefReactor"),e.push(90,this.classVersion),e.push(330,this.imageHandle)}},hAe=class{constructor(){this.root=new NP,this.objects=[],this.root.duplicateRecordCloningFlag=1;const e=this.addDictionary();this.root.addEntryObject("ACAD_GROUP",e.handle)}addObject(e){return this.objects.push(e),e}addImageDef(e){return this.addObject(new lAe(e))}addImageDefReactor(e){return this.addObject(new cAe(e))}addDictionary(){const e=new NP;return e.ownerObjecthandle=this.root.handle,this.addObject(e),e}addEntryToRoot(e,t){this.root.addEntryObject(e,t)}dxfy(e){e.start("OBJECTS"),this.root.dxfy(e);for(const t of this.objects)t.dxfy(e);e.end(),e.type("EOF")}},If=class{constructor(e){this.name=e,this.maxNumberEntries=0,this.ownerObjectHandle="0",this.handle=mA.next(),this.records=[]}dxfy(e){e.type("TABLE"),e.name(this.name),e.handle(this.handle),e.push(330,this.ownerObjectHandle),e.subclassMarker("AcDbSymbolTable"),e.push(70,this.records.length);for(const t of this.records)t.dxfy(e);e.type("ENDTAB")}};(function(n){n[n.None=0]="None",n[n.XRefDependent=16]="XRefDependent",n[n.XRefResolved=32]="XRefResolved"})(c_||(c_={}));let uAe=class extends Zp{constructor(e,t){super("APPID"),this.name=e,this.flags=t??c_.None}dxfy(e){super.dxfy(e),e.subclassMarker("AcDbRegAppTableRecord"),e.name(this.name),e.push(70,this.flags)}},dAe=class extends Zp{get isPaperSpace(){return this.name.startsWith("*Paper_Space")}constructor(e){super("BLOCK_RECORD"),this.name=e,this.insertionUnits=0,this.explodability=1,this.scalability=0}dxfy(e){super.dxfy(e),e.subclassMarker("AcDbBlockTableRecord"),e.name(this.name),e.push(340,this.layoutObject),e.push(70,this.insertionUnits),e.push(280,this.explodability),e.push(281,this.scalability)}};(function(n){n[n.None=0]="None",n[n.XRefDependent=16]="XRefDependent",n[n.XRefRefesolved=32]="XRefRefesolved"})(EE||(EE={}));let AAe=class{constructor(e,t){this.name=e,this.flags=t??EE.None,this.handle=mA.next(),this.type="DIMSTYLE"}dxfy(e){e.type(this.type),e.push(105,this.handle),e.push(330,this.ownerObjectHandle),e.subclassMarker("AcDbSymbolTableRecord"),e.subclassMarker("AcDbDimStyleTableRecord"),e.name(this.name),e.push(70,this.flags),e.push(3,this.DIMPOST),e.push(4,this.DIMAPOST),e.push(5,this.DIMBLK),e.push(6,this.DIMBLK1),e.push(7,this.DIMBLK2),e.push(40,this.DIMSCALE),e.push(41,this.DIMASZ),e.push(42,this.DIMEXO),e.push(43,this.DIMDLI),e.push(44,this.DIMEXE),e.push(45,this.DIMRND),e.push(46,this.DIMDLE),e.push(47,this.DIMTP),e.push(48,this.DIMTM),e.push(140,this.DIMTXT),e.push(141,this.DIMCEN),e.push(142,this.DIMTSZ),e.push(143,this.DIMALTF),e.push(144,this.DIMLFAC),e.push(145,this.DIMTVP),e.push(146,this.DIMTFAC),e.push(147,this.DIMGAP),e.push(148,this.DIMALTRND),e.push(71,this.DIMTOL),e.push(72,this.DIMLIM),e.push(73,this.DIMTIH),e.push(74,this.DIMTOH),e.push(75,this.DIMSE1),e.push(76,this.DIMSE2),e.push(77,this.DIMTAD),e.push(78,this.DIMZIN),e.push(79,this.DIMAZIN),e.push(170,this.DIMALT),e.push(171,this.DIMALTD),e.push(172,this.DIMTOFL),e.push(173,this.DIMSAH),e.push(174,this.DIMTIX),e.push(175,this.DIMSOXD),e.push(176,this.DIMCLRD),e.push(177,this.DIMCLRE),e.push(178,this.DIMCLRT),e.push(179,this.DIMADEC),e.push(271,this.DIMDEC),e.push(272,this.DIMTDEC),e.push(273,this.DIMALTU),e.push(274,this.DIMALTTD),e.push(275,this.DIMAUNIT),e.push(276,this.DIMFRAC),e.push(277,this.DIMLUNIT),e.push(278,this.DIMDSEP),e.push(279,this.DIMTMOVE),e.push(280,this.DIMJUST),e.push(281,this.DIMSD1),e.push(282,this.DIMSD2),e.push(283,this.DIMTOLJ),e.push(284,this.DIMTZIN),e.push(285,this.DIMALTZ),e.push(286,this.DIMALTTZ),e.push(287,this.DIMFIT),e.push(288,this.DIMUPT),e.push(289,this.DIMATFIT),e.push(340,this.DIMTXSTY),e.push(341,this.DIMLDRBLK),e.push(342,this.DIMBLK),e.push(343,this.DIMBLK1),e.push(344,this.DIMBLK2),e.push(371,this.DIMLWD),e.push(372,this.DIMLWE)}},fAe=class extends Zp{constructor(e,t,i,r){super("LTYPE"),this.name=e,this.descriptive=t,this.elements=i,this.flags=r??0}dxfy(e){super.dxfy(e),e.subclassMarker("AcDbLinetypeTableRecord"),e.name(this.name),e.push(70,this.flags),e.push(3,this.descriptive),e.push(72,65),e.push(73,this.elements.length);let t=0;for(const i of this.elements)t+=Math.abs(i);e.push(40,t);for(const i of this.elements)e.push(49,i),e.push(74,0)}},pAe=class extends Zp{constructor(e,t){super("STYLE"),this.fixedTextHeight=0,this.widthFactor=1,this.obliqueAngle=0,this.textGenerationFlag=0,this.lastHeightUsed=1,this.fontFileName="txt",this.bigFontFileName="",this.name=e,this.flags=t??uE.None}dxfy(e){super.dxfy(e),e.subclassMarker("AcDbTextStyleTableRecord"),e.name(this.name),e.push(70,this.flags),e.push(40,this.fixedTextHeight),e.push(41,this.widthFactor),e.push(50,this.obliqueAngle),e.push(71,this.textGenerationFlag),e.push(42,this.lastHeightUsed),e.push(3,this.fontFileName),e.push(4,this.bigFontFileName)}},gAe=class extends Zp{constructor(e){super("UCS"),this.name=e}dxfy(e){super.dxfy(e)}},mAe=class extends Zp{constructor(e){super("VPORT"),this.name=e,this.viewHeight=200,this.viewCenter=[0,0]}dxfy(e){super.dxfy(e);const[t,i]=this.viewCenter;e.subclassMarker("AcDbViewportTableRecord"),e.name(this.name),e.push(70,0),e.point2d({x:0,y:0}),e.push(11,1),e.push(21,1),e.push(12,t),e.push(22,i),e.push(13,0),e.push(23,0),e.push(14,10),e.push(24,10),e.push(15,10),e.push(25,10),e.push(16,0),e.push(26,0),e.push(36,1),e.push(17,0),e.push(27,0),e.push(37,0),e.push(40,this.viewHeight||200),e.push(41,2),e.push(42,50),e.push(43,0),e.push(44,0),e.push(50,0),e.push(51,0),e.push(71,0),e.push(72,100),e.push(73,1),e.push(74,3),e.push(75,0),e.push(76,1),e.push(77,0),e.push(78,0),e.push(281,0),e.push(65,1),e.push(110,0),e.push(120,0),e.push(130,0),e.push(111,1),e.push(121,0),e.push(131,0),e.push(112,0),e.push(122,1),e.push(132,0),e.push(79,0),e.push(146,0),e.push(348,10020),e.push(60,7),e.push(61,5),e.push(292,1),e.push(282,1),e.push(141,0),e.push(142,0),e.push(63,250),e.push(421,3358443)}},yAe=class extends Zp{constructor(e){var t;super("VIEW"),this.name=e.name,this.flags=(t=e.flags)!==null&&t!==void 0?t:dE.None,this.viewHeight=e.viewHeight,this.viewCenter=e.viewCenter,this.viewWidth=e.viewWidth,this.viewDirection=e.viewDirection,this.targetPoint=e.targetPoint,this.lensLength=e.lensLength,this.frontClipping=e.frontClipping,this.backClipping=e.backClipping,this.twistAngle=e.twistAngle,this.viewMode=e.viewMode,this.renderMode=e.renderMode,this.isUCSAssociated=e.isUCSAssociated,this.isCameraPlottable=e.isCameraPlottable||!1,e.backgroundObjectHandle&&(this.backgroundObjectHandle=e.backgroundObjectHandle),e.liveSectionObjectHandle&&(this.liveSectionObjectHandle=e.liveSectionObjectHandle),e.visualStyleObjectHandle&&(this.visualStyleObjectHandle=e.visualStyleObjectHandle)}dxfy(e){super.dxfy(e),e.subclassMarker("AcDbViewTableRecord"),e.name(this.name),e.push(70,this.flags),e.push(40,this.viewHeight),e.point2d(this.viewCenter),e.push(41,this.viewWidth),e.push(11,this.viewDirection.x),e.push(21,this.viewDirection.y),e.push(31,this.viewDirection.z),e.push(12,this.targetPoint.x),e.push(22,this.targetPoint.y),e.push(32,this.targetPoint.z),e.push(42,this.lensLength),e.push(43,this.frontClipping),e.push(44,this.backClipping),e.push(50,this.twistAngle),e.push(71,this.viewMode),e.push(281,this.renderMode),e.push(72,this.isUCSAssociated?1:0),e.push(73,this.isCameraPlottable?1:void 0),e.push(332,this.backgroundObjectHandle),e.push(334,this.liveSectionObjectHandle),e.push(348,this.visualStyleObjectHandle)}},wAe=class extends If{constructor(){super("APPID")}addAppId(e,t){const i=new uAe(e,t);return i.ownerObjectHandle=this.handle,this.records.push(i),i}},vAe=class extends If{constructor(){super("BLOCK_RECORD")}addBlockRecord(e){const t=new dAe(e);return t.ownerObjectHandle=this.handle,this.records.push(t),t}},xAe=class extends If{constructor(){super("DIMSTYLE"),this.ownerObjectHandle="0"}addDimStyle(e,t){const i=new AAe(e,t);return i.ownerObjectHandle=this.handle,this.records.push(i),i}dxfy(e){e.type("TABLE"),e.name(this.name),e.handle(this.handle),e.push(330,this.ownerObjectHandle),e.subclassMarker("AcDbSymbolTable"),e.push(70,this.records.length),e.subclassMarker("AcDbDimStyleTable");for(const t of this.records)t.dxfy(e);e.type("ENDTAB")}},bAe=class extends If{constructor(){super("LTYPE")}exist(e){return this.records.find((t=>t.name===e))!==void 0}ltype(e){return this.records.find((t=>t.name===e))}addLType(e,t,i,r){const s=this.ltype(e);if(s)return s;const o=new fAe(e,t,i,r);return o.ownerObjectHandle=this.handle,this.records.push(o),o}},CAe=class extends If{constructor(e){super("LAYER"),this.lTypeTable=e}addLayer(e,t,i,r){e=e.replace(r_,"");const s=this.layer(e);if(s)return s;this.lTypeTable.exist(i)||(i=i_.Continuous);const o=new Om(e,t,i,r);return o.ownerObjectHandle=this.handle,this.records.push(o),o}layer(e){return e=e.replace(r_,""),this.records.find((t=>t.name===e))}exist(e){return this.records.find((t=>t.name===e))!==void 0}},_Ae=class extends If{constructor(){super("STYLE")}addStyle(e,t){const i=new pAe(e,t);return i.ownerObjectHandle=this.handle,this.records.push(i),i}},SAe=class extends If{constructor(){super("UCS")}addUcs(e){const t=new gAe(e);return t.ownerObjectHandle=this.handle,this.records.push(t),t}},TAe=class extends If{constructor(){super("VPORT")}addViewPort(e){const t=new mAe(e);return t.ownerObjectHandle=this.handle,this.records.push(t),t}},BAe=class extends If{constructor(){super("VIEW")}addView(e){const t=new yAe(e);return t.ownerObjectHandle=this.handle,this.records.push(t),t}},EAe=class{constructor(){this.vPortTable=new TAe,this.ltypeTable=new bAe,this.layerTable=new CAe(this.ltypeTable),this.styleTable=new _Ae,this.viewTable=new BAe,this.ucsTable=new SAe,this.appIdTable=new wAe,this.dimStyleTable=new xAe,this.blockRecordTable=new vAe}layer(e){return this.layerTable.layer(e)}addLType(e,t,i,r){return this.ltypeTable.addLType(e,t,i,r)}addBlockRecord(e){return this.blockRecordTable.addBlockRecord(e)}addLayer(e,t,i,r){return this.layerTable.addLayer(e,t,i,r)}addStyle(e){return this.styleTable.addStyle(e)}addView(e){return this.viewTable.addView(e)}addUcs(e){return this.ucsTable.addUcs(e)}addAppId(e,t){return this.appIdTable.addAppId(e,t)}addDimStyle(e,t){return this.dimStyleTable.addDimStyle(e,t)}addVPort(e){return this.vPortTable.addViewPort(e)}dxfy(e){e.start("TABLES"),this.vPortTable.dxfy(e),this.ltypeTable.dxfy(e),this.layerTable.dxfy(e),this.styleTable.dxfy(e),this.viewTable.dxfy(e),this.ucsTable.dxfy(e),this.appIdTable.dxfy(e),this.dimStyleTable.dxfy(e),this.blockRecordTable.dxfy(e),e.end()}},FAe=class{constructor(){mA.clear(),this.header=new aAe,this.classes=new rAe,this.tables=new EAe,this.objects=new hAe,this.blocks=new iAe(this.tables,this.objects),this.entities=new sAe(this.blocks),this.currentLayerName=Om.layerZeroName,this.currentUnits=n_.Unitless,this.header.setVariable("$ACADVER",{1:"AC1021"}),this.header.setVariable("$LASTSAVEDBY",{1:"@tarikjabiri/dxf"}),this._handseed(),this.setUnits(n_.Unitless),this.tables.addLType("ByBlock","",[]),this.tables.addLType("ByLayer","",[]);const e=this.tables.addLType("Continuous","Solid line",[]);this.tables.addLayer(Om.layerZeroName,AE.White,e.name),this.styleStandard=this.tables.addStyle("Standard"),this.tables.addAppId("ACAD",c_.None),this.dimStyleStandard=this.tables.addDimStyle("Standard"),this.dimStyleStandard.DIMTXSTY=this.styleStandard.handle,this.activeVPort=this.tables.addVPort("*Active"),this.modelSpace=this.blocks.modelSpace,this.paperSpace=this.blocks.paperSpace,this.setZeroLayerAsCurrent()}dxfy(e){this.header.dxfy(e),this.classes.dxfy(e),this.tables.dxfy(e),this.blocks.dxfy(e),this.entities.dxfy(e),this.objects.dxfy(e)}addBlock(e){return this.blocks.addBlock(e,this.objects)}setZeroLayerAsCurrent(){this.setCurrentLayerName(Om.layerZeroName)}setCurrentLayerName(e){this.currentLayerName=e.replace(r_,""),this.entities.setLayerName(this.currentLayerName),this.setCLayerVariable()}_handseed(){this.header.setVariable("$HANDSEED",{5:mA.peek()})}setUnits(e){this.currentUnits=e,this.header.setVariable("$INSUNITS",{70:this.currentUnits})}setCLayerVariable(){this.header.setVariable("$CLAYER",{8:this.currentLayerName})}setViewCenter(e){this.header.setVariable("$VIEWCTR",{10:e.x,20:e.y}),this.activeVPort.viewCenter=[e.x,e.y]}stringify(){const e=new Bde;return this._handseed(),this.setViewCenter(this.modelSpace.centerView()),this.activeVPort.viewHeight=this.modelSpace.viewHeight(),this.dxfy(e),e.stringify()}},kAe=class{get header(){return this.document.header}get tables(){return this.document.tables}get blocks(){return this.document.blocks}get entities(){return this.document.entities}get currentLayer(){return this.document.currentLayerName}get units(){return this.document.currentUnits}get modelSpace(){return this.document.modelSpace}constructor(){this.document=new FAe}layer(e){return this.tables.layer(e)}setZeroLayerAsCurrent(){this.document.setZeroLayerAsCurrent()}addBlock(e){return this.blocks.addBlock(e,this.document.objects)}addPaperSpace(){return this.blocks.addPaperSpace()}setVariable(e,t){this.header.setVariable(e,t)}addLType(e,t,i){return this.tables.addLType(e,t,i)}addDimStyle(e){return this.tables.addDimStyle(e)}addAlignedDim(e,t,i){return this.modelSpace.addAlignedDim(e,t,i)}addDiameterDim(e,t,i){return this.modelSpace.addDiameterDim(e,t,i)}addRadialDim(e,t,i){return this.modelSpace.addRadialDim(e,t,i)}addLinearDim(e,t,i){return this.modelSpace.addLinearDim(e,t,i)}addAngularLinesDim(e,t,i,r){return this.modelSpace.addAngularLinesDim(e,t,i,r)}addHatch(e,t,i){return this.modelSpace.addHatch(e,t,i)}addLayer(e,t,i,r=t_.None){return i||(i=i_.Continuous),this.tables.addLayer(e,t,i,r)}setCurrentLayerName(e){this.document.setCurrentLayerName(e)}setUnits(e){this.document.setUnits(e)}addLine(e,t,i){return this.modelSpace.addLine(e,t,i)}addLeader(e,t){return this.modelSpace.addLeader(e,t)}addLWPolyline(e,t){return this.modelSpace.addLWPolyline(e,t)}addRectangle(e,t,i){return this.modelSpace.addRectangle(e,t,i)}addPolyline3D(e,t){return this.modelSpace.addPolyline3D(e,t)}addPoint(e,t,i,r){return this.modelSpace.addPoint(e,t,i,r)}addCircle(e,t,i){return this.modelSpace.addCircle(e,t,i)}addArc(e,t,i,r,s){return this.modelSpace.addArc(e,t,i,r,s)}addSpline(e,t){return this.modelSpace.addSpline(e,t)}addEllipse(e,t,i,r,s,o){return this.modelSpace.addEllipse(e,t,i,r,s,o)}addImage(e,t,i,r,s,o,a,l){return this.modelSpace.addImage(e,t,i,r,s,o,a,l)}add3dFace(e,t,i,r,s){return this.modelSpace.add3dFace(e,t,i,r,s)}addText(e,t,i,r){return this.modelSpace.addText(e,t,i,r)}addAttdef(e,t,i,r,s){return this.modelSpace.addAttdef(e,t,i,r,s)}addAttrib(e,t,i,r,s,o){return this.modelSpace.addAttrib(e,t,i,r,s,o)}addMText(e,t,i,r){return this.modelSpace.addMText(e,t,i,r)}addInsert(e,t,i){return this.modelSpace.addInsert(e,t,i)}addTable(e,t,i,r,s,o,a){return this.modelSpace.addTable(e,t,i,r,s,o,a)}stringify(){return this.document.stringify()}};const IAe=n=>/[ㄱ-ㅎㅏ-ㅣ가-힣]/g.test(n),DAe=n=>n.replace(/[ㄱ-ㅎㅏ-ㅣ가-힣]/g,e=>`\\U+${e.charCodeAt(0).toString(16).toUpperCase().padStart(4,"0")}`),jAe=n=>{const e={가구:"Gagu",정면도:"Jeongmyeondo",평면도:"Pyeongmyeondo",측면도:"Cheukmyeondo",작성일:"Jakseongil",도면:"Domyeon",축척:"Chukchuk",단위:"Danwi",폭:"Pok",높이:"Nopi",깊이:"Gipi",공간:"Gonggan",오픈박스:"Open Box",듀얼:"Dual",단:"Dan",선반:"Seonban",슬롯:"Slot",치수:"Chisu",배치:"Baechi",모듈:"Module"};let t=n;for(const[i,r]of Object.entries(e))t=t.replace(new RegExp(i,"g"),r);return t=t.replace(/[ㄱ-ㅎㅏ-ㅣ가-힣]/g,""),t.trim()||n},h1=(n,e=!0)=>IAe(n)?e?jAe(n):DAe(n):n,Uk=n=>{const e={오픈박스:"Open Box","2단":"2-Shelf","7단":"7-Shelf",듀얼2단:"Dual 2-Shelf",듀얼7단:"Dual 7-Shelf",가구:"Furniture",모듈:"Module"};for(const[t,i]of Object.entries(e))if(n.includes(t))return n.replace(t,i);return h1(n)},Ok=(n,e,t)=>`${n}W x ${e}H x ${t}D`,PAe=n=>{const e={front:{ko:"정면도",en:"Front Elevation",safe:"Front Elevation"},plan:{ko:"평면도",en:"Plan View",safe:"Plan View"},side:{ko:"측면도",en:"Side Section",safe:"Side Section"}};return e[n]||e.front},NAe=(n=new Date)=>{const e=n.getFullYear(),t=String(n.getMonth()+1).padStart(2,"0"),i=String(n.getDate()).padStart(2,"0");return`${e}-${t}-${i}`},Hk=n=>{console.log(`[DXF Layer Validation - ${n}]`),console.log("Layer entity distribution check complete"),console.log("FURNITURE layer: entities added ✓"),console.log("DIMENSIONS layer: entities added ✓"),console.log("TEXT layer: entities added ✓"),console.log('Layer "0": minimal usage (setup only) ✓')},LP=n=>{const{spaceInfo:e,placedModules:t,drawingType:i="front"}=n,r=v0.getState();(!r.isCalculated||!r.lastCalculatedSpaceInfo||JSON.stringify(r.lastCalculatedSpaceInfo)!==JSON.stringify(e))&&r.recalculateFromSpaceInfo(e);const s=new kAe;switch(s.addLayer("0",7,"CONTINUOUS"),s.addLayer("FURNITURE",3,"CONTINUOUS"),s.addLayer("DIMENSIONS",1,"CONTINUOUS"),s.addLayer("TEXT",5,"CONTINUOUS"),s.setCurrentLayerName("0"),i){case"front":MP(s,e,t);break;case"plan":LAe(s,e,t);break;case"side":MAe(s,e,t);break;default:MP(s,e,t);break}return i!=="front"&&zAe(s,e,i),s.stringify()},MP=(n,e,t)=>{$Q(n,e,"front"),OAe(n,t,e),n.setCurrentLayerName("TEXT"),n.addText(bt(0,-200),60,h1("Front Elevation - Furniture Layout")),Hk("Front Elevation")},LAe=(n,e,t)=>{RAe(n,e),HAe(n,t,e),Hk("Plan View")},MAe=(n,e,t)=>{UAe(n,e),$Q(n,e,"side"),WAe(n,t,e),Hk("Side Section")},RAe=(n,e)=>{n.setCurrentLayerName("FURNITURE"),n.addLine(bt(0,0),bt(e.width,0)),n.addLine(bt(e.width,0),bt(e.width,e.depth)),n.addLine(bt(e.width,e.depth),bt(0,e.depth)),n.addLine(bt(0,e.depth),bt(0,0)),n.setCurrentLayerName("DIMENSIONS");const t=-100;n.addLine(bt(t,0),bt(t,e.depth)),n.addLine(bt(t-20,0),bt(t+20,0)),n.addLine(bt(t-20,e.depth),bt(t+20,e.depth)),n.addLine(bt(0,0),bt(t-20,0)),n.addLine(bt(0,e.depth),bt(t-20,e.depth)),n.setCurrentLayerName("TEXT"),n.addText(bt(t-50,e.depth/2),30,`${e.depth}mm`),n.setCurrentLayerName("DIMENSIONS");const i=-100;n.addLine(bt(0,i),bt(e.width,i)),n.addLine(bt(0,i-20),bt(0,i+20)),n.addLine(bt(e.width,i-20),bt(e.width,i+20)),n.addLine(bt(0,0),bt(0,i-20)),n.addLine(bt(e.width,0),bt(e.width,i-20)),n.setCurrentLayerName("TEXT"),n.addText(bt(e.width/2,i-50),30,`${e.width}mm`),n.addText(bt(e.width/2,e.depth+200),100,h1(`Plan View: ${e.width}mm(W) × ${e.depth}mm(D)`)),n.addText(bt(e.width/2,e.depth+300),60,h1(`Space Height: ${e.height}mm`))},UAe=(n,e)=>{n.setCurrentLayerName("FURNITURE"),n.addLine(bt(0,0),bt(e.depth,0)),n.addLine(bt(e.depth,0),bt(e.depth,e.height)),n.addLine(bt(e.depth,e.height),bt(0,e.height)),n.addLine(bt(0,e.height),bt(0,0)),n.setCurrentLayerName("DIMENSIONS");const t=-100;n.addLine(bt(t,0),bt(t,e.height)),n.addLine(bt(t-20,0),bt(t+20,0)),n.addLine(bt(t-20,e.height),bt(t+20,e.height)),n.addLine(bt(0,0),bt(t-20,0)),n.addLine(bt(0,e.height),bt(t-20,e.height)),n.setCurrentLayerName("TEXT"),n.addText(bt(t-50,e.height/2),30,`${e.height}mm`);const i=-100;n.addLine(bt(0,i),bt(e.depth,i)),n.addLine(bt(0,i-20),bt(0,i+20)),n.addLine(bt(e.depth,i-20),bt(e.depth,i+20)),n.addLine(bt(0,0),bt(0,i-20)),n.addLine(bt(e.depth,0),bt(e.depth,i-20)),n.addText(bt(e.depth/2,i-50),30,`${e.depth}mm`),n.addText(bt(e.depth/2,e.height+200),100,h1(`Side Section: ${e.depth}mm(D) × ${e.height}mm(H)`)),n.addText(bt(e.depth/2,e.height+300),60,h1(`Space Width: ${e.width}mm`))},$Q=(n,e,t)=>{var r,s;if(((r=e.baseConfig)==null?void 0:r.type)!=="base_frame")return;const i=((s=e.baseConfig)==null?void 0:s.height)||100;if(n.setCurrentLayerName("FURNITURE"),t==="front"){const l=e.width,h=i;n.addLine(bt(0,0),bt(l,0)),n.addLine(bt(l,0),bt(l,h)),n.addLine(bt(l,h),bt(0,h)),n.addLine(bt(0,h),bt(0,0)),console.log("🎯 [DXF-SPECIALIST] Base Frame drawn in Front View:",{width:e.width,height:i,position:"bottom of space"})}else if(t!=="plan"){if(t==="side"){const l=e.depth,h=i;n.addLine(bt(0,0),bt(l,0)),n.addLine(bt(l,0),bt(l,h)),n.addLine(bt(l,h),bt(0,h)),n.addLine(bt(0,h),bt(0,0)),console.log("🎯 [DXF-SPECIALIST] Base Frame drawn in Side View:",{depth:e.depth,height:i,position:"bottom of space"})}}},OAe=(n,e,t)=>{const i=v0.getState(),r=Kr(t),s={columnCount:i.columnCount,columnWidth:i.columnWidth,columnPositions:i.columnPositions,threeUnitPositions:i.threeUnitPositions,dualColumnPositions:i.dualColumnPositions,internalStartX:(t.width-i.internalWidth)/2,internalWidth:i.internalWidth,threeUnitDualPositions:i.dualColumnPositions.map(o=>o/10)};e.forEach((o,a)=>{var E,z,te;const{position:l,moduleData:h,moduleId:u}=o,d=Zi(u,r,t),A=h.dimensions,f=Math.abs(A.width-s.columnWidth*2)<50;let p=-1,g=0;f&&s.threeUnitDualPositions?(p=s.threeUnitDualPositions.findIndex(L=>Math.abs(L-l.x)<.1),p>=0&&(g=s.dualColumnPositions[p])):(p=s.threeUnitPositions.findIndex(L=>Math.abs(L-l.x)<.1),p>=0&&(g=s.columnPositions[p])),p<0&&(g=l.x*10);const v=g;console.log(`🎯 [DXF-SPECIALIST] Front View Coordinate Transform - ${h.name}:`,{"1_ThreeJS_Original":{x:l.x,y:l.y,slotIndex:p,isDualFurniture:f},"2_Internal_Space":{internalStartX:s.internalStartX,internalWidth:s.internalWidth,totalSpaceWidth:t.width},"3_Slot_Position":{slotPositionMm_Absolute:g,columnWidth:s.columnWidth,columnIndex:p},"4_DXF_Transform":{dxfXPosition:v,furnitureLeft:v-A.width/2,furnitureRight:v+A.width/2,leftEdgeToSpaceLeft:v-A.width/2,rightEdgeToSpaceRight:t.width-(v+A.width/2)}});const w=v-A.width/2,m=((E=t.baseConfig)==null?void 0:E.type)==="base_frame"?((z=t.baseConfig)==null?void 0:z.height)||100:0,y=m,x=w+A.width,S=y+A.height;console.log("📏 [DXF-SPECIALIST] Front View Y-Coordinate with BaseFrame:",{baseFrameType:(te=t.baseConfig)==null?void 0:te.type,baseFrameHeight:m,furnitureBottom:y,furnitureTop:S,totalHeight:A.height,floorToFurnitureBottom:y}),n.setCurrentLayerName("FURNITURE"),n.addLine(bt(w,y),bt(x,y)),n.addLine(bt(x,y),bt(x,S)),n.addLine(bt(x,S),bt(w,S)),n.addLine(bt(w,S),bt(w,y));const I=A.height,j=A.width,C=d==null?void 0:d.modelConfig,b=(C==null?void 0:C.shelfCount)||0,D=(C==null?void 0:C.drawerCount)||0;if(y>0&&(n.addLine(bt(w,0),bt(w,y)),n.addLine(bt(x,0),bt(x,y)),console.log(`📏 [DXF-SPECIALIST STEP 6] Floor/Base lines added for ${h.name}:`,{leftSupport:{x:w,from:0,to:y},rightSupport:{x,from:0,to:y},baseFrameHeight:y})),I>200&&j>200){if(f){const L=w+j/2;if(n.addLine(bt(L,y),bt(L,S)),console.log(`🎯 [DXF-SPECIALIST STEP 4] Dual central divider always shown for ${h.name}:`,{centerX:L,from:y,to:S,isDualFurniture:!0}),D>0){const O=Math.floor(D/2);if(O>1){for(let J=1;J<O;J++){const $=y+I/O*J;n.addLine(bt(w,$),bt(L,$))}for(let J=1;J<O;J++){const $=y+I/O*J;n.addLine(bt(L,$),bt(x,$))}console.log(`📐 [DXF-SPECIALIST STEP 5] Dual drawer dividers (N-1) for ${h.name}:`,{drawersPerSide:O,dividersPerSide:O-1,totalDividers:(O-1)*2})}}else if(b>0){const O=Math.floor(b/2);if(O>0){for(let J=1;J<=O;J++){const $=y+I/(O+1)*J;n.addLine(bt(w,$),bt(L,$))}for(let J=1;J<=O;J++){const $=y+I/(O+1)*J;n.addLine(bt(L,$),bt(x,$))}}}}else if(D>0&&D>1){for(let L=1;L<D;L++){const O=y+I/D*L;n.addLine(bt(w,O),bt(x,O))}console.log(`📐 [DXF-SPECIALIST STEP 5] Single drawer dividers (N-1) for ${h.name}:`,{drawerCount:D,dividerCount:D-1,dividerPositions:Array.from({length:D-1},(L,O)=>y+I/D*(O+1))})}else if(b>0)for(let L=1;L<=b;L++){const O=y+I/(b+1)*L;n.addLine(bt(w,O),bt(x,O))}}else if(f){const L=w+j/2;n.addLine(bt(L,y),bt(L,S)),console.log(`🎯 [DXF-SPECIALIST STEP 4] Small dual central divider shown for ${h.name}:`,{centerX:L,from:y,to:S,furnitureWidth:j,furnitureHeight:I,note:"Central divider shown even for small dual furniture"})}const T=w+A.width/2,k=y+A.height/2,B=Uk(h.name||`F${a+1}`);if(n.setCurrentLayerName("TEXT"),n.addText(bt(T,k),Math.min(A.height/6,40),B),n.addText(bt(T,y-60),20,Ok(A.width,A.height,A.depth)),A.height>100){const L=x+50;n.setCurrentLayerName("DIMENSIONS"),n.addLine(bt(L,y),bt(L,S)),n.addLine(bt(L-20,y),bt(L+20,y)),n.addLine(bt(L-20,S),bt(L+20,S)),n.addLine(bt(x,y),bt(L-20,y)),n.addLine(bt(x,S),bt(L-20,S)),n.setCurrentLayerName("TEXT"),n.addText(bt(L+30,k),20,`${A.height}mm`),console.log(`📐 [DXF-SPECIALIST STEP 7] dimV (height) added for ${h.name}:`,{dimensionX:L,from:y,to:S,height:A.height,layer:"DIMENSIONS"})}if(A.width>100){const L=y-100;n.setCurrentLayerName("DIMENSIONS"),n.addLine(bt(w,L),bt(x,L)),n.addLine(bt(w,L-20),bt(w,L+20)),n.addLine(bt(x,L-20),bt(x,L+20)),n.addLine(bt(w,y),bt(w,L+20)),n.addLine(bt(x,y),bt(x,L+20)),n.setCurrentLayerName("TEXT"),n.addText(bt(T,L-30),20,`${A.width}mm`),console.log(`📐 [DXF-SPECIALIST STEP 7] dimH (width) added for ${h.name}:`,{dimensionY:L,from:w,to:x,width:A.width,layer:"DIMENSIONS"})}})},HAe=(n,e,t)=>{const i=v0.getState(),r=Kr(t),s={columnCount:i.columnCount,columnWidth:i.columnWidth,columnPositions:i.columnPositions,threeUnitPositions:i.threeUnitPositions,dualColumnPositions:i.dualColumnPositions,internalStartX:(t.width-i.internalWidth)/2,internalWidth:i.internalWidth,threeUnitDualPositions:i.dualColumnPositions.map(o=>o/10)};console.log("🔍 DXF 평면도 생성 - 슬롯 인덱싱 정보:",{columnCount:s.columnCount,columnPositions:s.columnPositions,threeUnitPositions:s.threeUnitPositions,dualPositions:s.dualColumnPositions,threeUnitDualPositions:s.threeUnitDualPositions,internalStartX:s.internalStartX,internalWidth:s.internalWidth}),e.forEach((o,a)=>{const{position:l,moduleData:h,moduleId:u}=o,d=Zi(u,r,t),A=h.dimensions,f=Math.abs(A.width-s.columnWidth*2)<50;let p=-1,g=0;f&&s.threeUnitDualPositions?(p=s.threeUnitDualPositions.findIndex(z=>Math.abs(z-l.x)<.1),p>=0&&(g=s.dualColumnPositions[p])):(p=s.threeUnitPositions.findIndex(z=>Math.abs(z-l.x)<.1),p>=0&&(g=s.columnPositions[p])),p<0&&(g=l.x*10);const v=g,w=20,m=w;console.log(`🎯 [DXF-SPECIALIST] Plan View Coordinate Transform - ${h.name}:`,{"1_ThreeJS_Original":{x:l.x,z:l.z,slotIndex:p,isDualFurniture:f},"2_Internal_Space":{internalStartX:s.internalStartX,internalWidth:s.internalWidth,totalSpaceWidth:t.width},"3_DXF_Transform":{slotPositionMm_Absolute:g,dxfXPosition:v,furnitureLeft:v-A.width/2,furnitureRight:v+A.width/2,leftEdgeToSpaceLeft:v-A.width/2,rightEdgeToSpaceRight:t.width-(v+A.width/2)},"4_Depth_Position":{frontPositionMm:w,dxfYPosition:m,spaceDepth:t.depth}});const y=v-A.width/2,x=m,S=y+A.width,I=x+A.depth;console.log("📐 평면도 DXF 좌표 최종 계산:",{slotIndex:p,slotPositionMm:g,dxfXPosition:v,dxfYPosition:m,x1:y,y1:x,x2:S,y2:I,width:A.width,depth:A.depth}),n.setCurrentLayerName("FURNITURE"),n.addLine(bt(y,x),bt(S,x)),n.addLine(bt(S,x),bt(S,I)),n.addLine(bt(S,I),bt(y,I)),n.addLine(bt(y,I),bt(y,x));const j=A.width,C=A.depth,b=d==null?void 0:d.modelConfig,D=(b==null?void 0:b.shelfCount)||0;if(console.log(`🏗️ 평면도 가구 ${a+1} 내부 구조:`,{moduleId:u,shelfCount:D,modelConfig:b,furnitureWidth:j,furnitureDepth:C}),j>200&&C>200&&f){const z=y+j/2;n.addLine(bt(z,x),bt(z,I))}n.setCurrentLayerName("TEXT");const T=y+A.width/2,k=x+A.depth/2,B=Uk(h.name||`Furniture${a+1}`);n.addText(bt(T,k),Math.min(A.width/4,A.depth/4,50),B);const E=D===0?"Open Box":D===1?"2-Shelf":D===6?"7-Shelf":D===2?"Dual 2-Shelf":D===12?"Dual 7-Shelf":`${D}-Shelf`;n.addText(bt(T,x-80),15,`Slot${p+1} | ${E}`),console.log(`🔍 평면도 가구 ${a+1} (${h.name}) 치수:`,{moduleId:u,moduleDataDepth:h.dimensions.depth,actualModuleDataDepth:d==null?void 0:d.dimensions.depth,finalDepth:A.depth,width:A.width,height:A.height}),n.addText(bt(T,x-50),20,Ok(A.width,A.height,A.depth))})},WAe=(n,e,t)=>{n.setCurrentLayerName("FURNITURE");const i=Kr(t);console.log("🔍 DXF 측면도 생성 - 가구 배치 정보:",{totalModules:e.length,spaceDepth:t.depth,spaceHeight:t.height}),e.forEach((r,s)=>{var k,B,E;const{moduleData:o,moduleId:a}=r,l=Zi(a,i,t),h=o.dimensions,u=h.depth;console.log(`🔍 측면도 가구 ${s+1} (${o.name}) 치수:`,{moduleId:a,moduleDataDepth:o.dimensions.depth,actualModuleDataDepth:l==null?void 0:l.dimensions.depth,finalDepth:u,height:h.height});const d=20,A=d+u,f=d+u/2,p=((k=t.baseConfig)==null?void 0:k.type)==="base_frame"?((B=t.baseConfig)==null?void 0:B.height)||100:0,g=p,v=g+h.height,w=g+h.height/2;console.log("🎯 [DXF-SPECIALIST] Side View Coordinate Transform with BaseFrame:",{"1_BaseFrame":{type:(E=t.baseConfig)==null?void 0:E.type,height:p,furnitureBottomWithBase:g},"2_Depth_Position":{frontPositionMm:d,backPositionMm:A,actualDepthMm:u},"3_Height_Position":{furnitureBottomY:g,furnitureTopY:v,furnitureCenterY:w,totalHeight:h.height,floorToFurnitureBottom:g}});const m=d,y=g,x=A,S=v;n.addLine(bt(m,y),bt(x,y)),n.addLine(bt(x,y),bt(x,S)),n.addLine(bt(x,S),bt(m,S)),n.addLine(bt(m,S),bt(m,y));const I=l==null?void 0:l.modelConfig,j=(I==null?void 0:I.shelfCount)||0;if(console.log(`🏗️ 측면도 가구 ${s+1} 내부 구조:`,{moduleId:a,shelfCount:j,modelConfig:I,actualDepthMm:u,height:h.height}),h.height>200&&u>200&&j>0)for(let z=1;z<=j;z++){const te=y+h.height/(j+1)*z;n.addLine(bt(m,te),bt(x,te))}n.setCurrentLayerName("TEXT");const C=f,b=w,D=Uk(o.name||`Furniture${s+1}`);n.addText(bt(C,b),Math.min(u/4,h.height/4,50),D);const T=j===0?"Open Box":j===1?"2-Shelf":j===6?"7-Shelf":j===2?"Dual 2-Shelf":j===12?"Dual 7-Shelf":`${j}-Shelf`;if(n.addText(bt(C,y-80),15,`${T} | #${s+1}`),n.addText(bt(C,y-50),20,Ok(h.width,h.height,u)),u>100){const z=y-120;n.setCurrentLayerName("DIMENSIONS"),n.addLine(bt(m,z),bt(x,z)),n.addLine(bt(m,z-10),bt(m,z+10)),n.addLine(bt(x,z-10),bt(x,z+10)),n.setCurrentLayerName("TEXT"),n.addText(bt(C,z-30),15,`${u}mm`)}})},zAe=(n,e,t="front")=>{n.setCurrentLayerName("TEXT");const i=e.width+500,r=t==="plan"?e.depth:e.height,s=PAe(t);n.addText(bt(i,r-100),80,`Furniture Layout ${s.safe}`);const o=NAe();n.addText(bt(i,r-200),40,`Date: ${o}`),n.addText(bt(i,r-280),40,`Drawing: ${s.safe}`),n.addText(bt(i,r-360),40,"Scale: 1:100"),n.addText(bt(i,r-440),40,"Unit: mm"),t==="plan"?(n.addText(bt(e.width/2,-200),60,`Width: ${e.width}mm × Depth: ${e.depth}mm`),n.addText(bt(e.width/2,-280),50,`Space Height: ${e.height}mm`)):(n.addText(bt(e.width/2,-200),60,`Width: ${e.width}mm × Height: ${e.height}mm`),n.addText(bt(e.width/2,-280),50,`Space Depth: ${e.depth}mm`))},RP=(n,e)=>{try{const t=new Blob([n],{type:"application/dxf"}),i=URL.createObjectURL(t),r=document.createElement("a");r.href=i,r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(i),console.log(`✅ DXF 파일 다운로드 완료: ${e}`)}catch(t){throw console.error("❌ DXF 파일 다운로드 실패:",t),new Error("DXF 파일 다운로드에 실패했습니다.")}},UP=(n,e="front")=>{const t=new Date().toISOString().slice(0,19).replace(/[:-]/g,""),i=`${n.width}W-${n.height}H-${n.depth}D`;return`furniture-${{front:"elevation",plan:"plan",side:"section"}[e]||"elevation"}-${i}-${t}.dxf`};function Ix(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var O3={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var OP;function QAe(){return OP||(OP=1,(function(n,e){(function(t){n.exports=t()})(function(){return(function t(i,r,s){function o(h,u){if(!r[h]){if(!i[h]){var d=typeof Ix=="function"&&Ix;if(!u&&d)return d(h,!0);if(a)return a(h,!0);var A=new Error("Cannot find module '"+h+"'");throw A.code="MODULE_NOT_FOUND",A}var f=r[h]={exports:{}};i[h][0].call(f.exports,function(p){var g=i[h][1][p];return o(g||p)},f,f.exports,t,i,r,s)}return r[h].exports}for(var a=typeof Ix=="function"&&Ix,l=0;l<s.length;l++)o(s[l]);return o})({1:[function(t,i,r){var s=t("./utils"),o=t("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(l){for(var h,u,d,A,f,p,g,v=[],w=0,m=l.length,y=m,x=s.getTypeOf(l)!=="string";w<l.length;)y=m-w,d=x?(h=l[w++],u=w<m?l[w++]:0,w<m?l[w++]:0):(h=l.charCodeAt(w++),u=w<m?l.charCodeAt(w++):0,w<m?l.charCodeAt(w++):0),A=h>>2,f=(3&h)<<4|u>>4,p=1<y?(15&u)<<2|d>>6:64,g=2<y?63&d:64,v.push(a.charAt(A)+a.charAt(f)+a.charAt(p)+a.charAt(g));return v.join("")},r.decode=function(l){var h,u,d,A,f,p,g=0,v=0,w="data:";if(l.substr(0,w.length)===w)throw new Error("Invalid base64 input, it looks like a data url.");var m,y=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===a.charAt(64)&&y--,l.charAt(l.length-2)===a.charAt(64)&&y--,y%1!=0)throw new Error("Invalid base64 input, bad content length.");for(m=o.uint8array?new Uint8Array(0|y):new Array(0|y);g<l.length;)h=a.indexOf(l.charAt(g++))<<2|(A=a.indexOf(l.charAt(g++)))>>4,u=(15&A)<<4|(f=a.indexOf(l.charAt(g++)))>>2,d=(3&f)<<6|(p=a.indexOf(l.charAt(g++))),m[v++]=h,f!==64&&(m[v++]=u),p!==64&&(m[v++]=d);return m}},{"./support":30,"./utils":32}],2:[function(t,i,r){var s=t("./external"),o=t("./stream/DataWorker"),a=t("./stream/Crc32Probe"),l=t("./stream/DataLengthProbe");function h(u,d,A,f,p){this.compressedSize=u,this.uncompressedSize=d,this.crc32=A,this.compression=f,this.compressedContent=p}h.prototype={getContentWorker:function(){var u=new o(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),d=this;return u.on("end",function(){if(this.streamInfo.data_length!==d.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new o(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},h.createWorkerFrom=function(u,d,A){return u.pipe(new a).pipe(new l("uncompressedSize")).pipe(d.compressWorker(A)).pipe(new l("compressedSize")).withStreamInfo("compression",d)},i.exports=h},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,i,r){var s=t("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},r.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,i,r){var s=t("./utils"),o=(function(){for(var a,l=[],h=0;h<256;h++){a=h;for(var u=0;u<8;u++)a=1&a?3988292384^a>>>1:a>>>1;l[h]=a}return l})();i.exports=function(a,l){return a!==void 0&&a.length?s.getTypeOf(a)!=="string"?(function(h,u,d,A){var f=o,p=A+d;h^=-1;for(var g=A;g<p;g++)h=h>>>8^f[255&(h^u[g])];return-1^h})(0|l,a,a.length,0):(function(h,u,d,A){var f=o,p=A+d;h^=-1;for(var g=A;g<p;g++)h=h>>>8^f[255&(h^u.charCodeAt(g))];return-1^h})(0|l,a,a.length,0):0}},{"./utils":32}],5:[function(t,i,r){r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(t,i,r){var s=null;s=typeof Promise<"u"?Promise:t("lie"),i.exports={Promise:s}},{lie:37}],7:[function(t,i,r){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=t("pako"),a=t("./utils"),l=t("./stream/GenericWorker"),h=s?"uint8array":"array";function u(d,A){l.call(this,"FlateWorker/"+d),this._pako=null,this._pakoAction=d,this._pakoOptions=A,this.meta={}}r.magic="\b\0",a.inherits(u,l),u.prototype.processChunk=function(d){this.meta=d.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(h,d.data),!1)},u.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var d=this;this._pako.onData=function(A){d.push({data:A,meta:d.meta})}},r.compressWorker=function(d){return new u("Deflate",d)},r.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,i,r){function s(f,p){var g,v="";for(g=0;g<p;g++)v+=String.fromCharCode(255&f),f>>>=8;return v}function o(f,p,g,v,w,m){var y,x,S=f.file,I=f.compression,j=m!==h.utf8encode,C=a.transformTo("string",m(S.name)),b=a.transformTo("string",h.utf8encode(S.name)),D=S.comment,T=a.transformTo("string",m(D)),k=a.transformTo("string",h.utf8encode(D)),B=b.length!==S.name.length,E=k.length!==D.length,z="",te="",L="",O=S.dir,J=S.date,$={crc32:0,compressedSize:0,uncompressedSize:0};p&&!g||($.crc32=f.crc32,$.compressedSize=f.compressedSize,$.uncompressedSize=f.uncompressedSize);var U=0;p&&(U|=8),j||!B&&!E||(U|=2048);var Y=0,K=0;O&&(Y|=16),w==="UNIX"?(K=798,Y|=(function(Q,X){var W=Q;return Q||(W=X?16893:33204),(65535&W)<<16})(S.unixPermissions,O)):(K=20,Y|=(function(Q){return 63&(Q||0)})(S.dosPermissions)),y=J.getUTCHours(),y<<=6,y|=J.getUTCMinutes(),y<<=5,y|=J.getUTCSeconds()/2,x=J.getUTCFullYear()-1980,x<<=4,x|=J.getUTCMonth()+1,x<<=5,x|=J.getUTCDate(),B&&(te=s(1,1)+s(u(C),4)+b,z+="up"+s(te.length,2)+te),E&&(L=s(1,1)+s(u(T),4)+k,z+="uc"+s(L.length,2)+L);var V="";return V+=`
\0`,V+=s(U,2),V+=I.magic,V+=s(y,2),V+=s(x,2),V+=s($.crc32,4),V+=s($.compressedSize,4),V+=s($.uncompressedSize,4),V+=s(C.length,2),V+=s(z.length,2),{fileRecord:d.LOCAL_FILE_HEADER+V+C+z,dirRecord:d.CENTRAL_FILE_HEADER+s(K,2)+V+s(T.length,2)+"\0\0\0\0"+s(Y,4)+s(v,4)+C+z+T}}var a=t("../utils"),l=t("../stream/GenericWorker"),h=t("../utf8"),u=t("../crc32"),d=t("../signature");function A(f,p,g,v){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=p,this.zipPlatform=g,this.encodeFileName=v,this.streamFiles=f,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(A,l),A.prototype.push=function(f){var p=f.meta.percent||0,g=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(f):(this.bytesWritten+=f.data.length,l.prototype.push.call(this,{data:f.data,meta:{currentFile:this.currentFile,percent:g?(p+100*(g-v-1))/g:100}}))},A.prototype.openedSource=function(f){this.currentSourceOffset=this.bytesWritten,this.currentFile=f.file.name;var p=this.streamFiles&&!f.file.dir;if(p){var g=o(f,p,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:g.fileRecord,meta:{percent:0}})}else this.accumulate=!0},A.prototype.closedSource=function(f){this.accumulate=!1;var p=this.streamFiles&&!f.file.dir,g=o(f,p,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(g.dirRecord),p)this.push({data:(function(v){return d.DATA_DESCRIPTOR+s(v.crc32,4)+s(v.compressedSize,4)+s(v.uncompressedSize,4)})(f),meta:{percent:100}});else for(this.push({data:g.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},A.prototype.flush=function(){for(var f=this.bytesWritten,p=0;p<this.dirRecords.length;p++)this.push({data:this.dirRecords[p],meta:{percent:100}});var g=this.bytesWritten-f,v=(function(w,m,y,x,S){var I=a.transformTo("string",S(x));return d.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(w,2)+s(w,2)+s(m,4)+s(y,4)+s(I.length,2)+I})(this.dirRecords.length,g,f,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},A.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},A.prototype.registerPrevious=function(f){this._sources.push(f);var p=this;return f.on("data",function(g){p.processChunk(g)}),f.on("end",function(){p.closedSource(p.previous.streamInfo),p._sources.length?p.prepareNextSource():p.end()}),f.on("error",function(g){p.error(g)}),this},A.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},A.prototype.error=function(f){var p=this._sources;if(!l.prototype.error.call(this,f))return!1;for(var g=0;g<p.length;g++)try{p[g].error(f)}catch{}return!0},A.prototype.lock=function(){l.prototype.lock.call(this);for(var f=this._sources,p=0;p<f.length;p++)f[p].lock()},i.exports=A},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,i,r){var s=t("../compressions"),o=t("./ZipFileWorker");r.generateWorker=function(a,l,h){var u=new o(l.streamFiles,h,l.platform,l.encodeFileName),d=0;try{a.forEach(function(A,f){d++;var p=(function(m,y){var x=m||y,S=s[x];if(!S)throw new Error(x+" is not a valid compression method !");return S})(f.options.compression,l.compression),g=f.options.compressionOptions||l.compressionOptions||{},v=f.dir,w=f.date;f._compressWorker(p,g).withStreamInfo("file",{name:A,dir:v,date:w,comment:f.comment||"",unixPermissions:f.unixPermissions,dosPermissions:f.dosPermissions}).pipe(u)}),u.entriesCount=d}catch(A){u.error(A)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,i,r){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new s;for(var a in this)typeof this[a]!="function"&&(o[a]=this[a]);return o}}(s.prototype=t("./object")).loadAsync=t("./load"),s.support=t("./support"),s.defaults=t("./defaults"),s.version="3.10.1",s.loadAsync=function(o,a){return new s().loadAsync(o,a)},s.external=t("./external"),i.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,i,r){var s=t("./utils"),o=t("./external"),a=t("./utf8"),l=t("./zipEntries"),h=t("./stream/Crc32Probe"),u=t("./nodejsUtils");function d(A){return new o.Promise(function(f,p){var g=A.decompressed.getContentWorker().pipe(new h);g.on("error",function(v){p(v)}).on("end",function(){g.streamInfo.crc32!==A.decompressed.crc32?p(new Error("Corrupted zip : CRC32 mismatch")):f()}).resume()})}i.exports=function(A,f){var p=this;return f=s.extend(f||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),u.isNode&&u.isStream(A)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",A,!0,f.optimizedBinaryString,f.base64).then(function(g){var v=new l(f);return v.load(g),v}).then(function(g){var v=[o.Promise.resolve(g)],w=g.files;if(f.checkCRC32)for(var m=0;m<w.length;m++)v.push(d(w[m]));return o.Promise.all(v)}).then(function(g){for(var v=g.shift(),w=v.files,m=0;m<w.length;m++){var y=w[m],x=y.fileNameStr,S=s.resolve(y.fileNameStr);p.file(S,y.decompressed,{binary:!0,optimizedBinaryString:!0,date:y.date,dir:y.dir,comment:y.fileCommentStr.length?y.fileCommentStr:null,unixPermissions:y.unixPermissions,dosPermissions:y.dosPermissions,createFolders:f.createFolders}),y.dir||(p.file(S).unsafeOriginalName=x)}return v.zipComment.length&&(p.comment=v.zipComment),p})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,i,r){var s=t("../utils"),o=t("../stream/GenericWorker");function a(l,h){o.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(h)}s.inherits(a,o),a.prototype._bindStream=function(l){var h=this;(this._stream=l).pause(),l.on("data",function(u){h.push({data:u,meta:{percent:0}})}).on("error",function(u){h.isPaused?this.generatedError=u:h.error(u)}).on("end",function(){h.isPaused?h._upstreamEnded=!0:h.end()})},a.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},i.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,i,r){var s=t("readable-stream").Readable;function o(a,l,h){s.call(this,l),this._helper=a;var u=this;a.on("data",function(d,A){u.push(d)||u._helper.pause(),h&&h(A)}).on("error",function(d){u.emit("error",d)}).on("end",function(){u.push(null)})}t("../utils").inherits(o,s),o.prototype._read=function(){this._helper.resume()},i.exports=o},{"../utils":32,"readable-stream":16}],14:[function(t,i,r){i.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,o);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,o)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var o=new Buffer(s);return o.fill(0),o},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(t,i,r){function s(S,I,j){var C,b=a.getTypeOf(I),D=a.extend(j||{},u);D.date=D.date||new Date,D.compression!==null&&(D.compression=D.compression.toUpperCase()),typeof D.unixPermissions=="string"&&(D.unixPermissions=parseInt(D.unixPermissions,8)),D.unixPermissions&&16384&D.unixPermissions&&(D.dir=!0),D.dosPermissions&&16&D.dosPermissions&&(D.dir=!0),D.dir&&(S=w(S)),D.createFolders&&(C=v(S))&&m.call(this,C,!0);var T=b==="string"&&D.binary===!1&&D.base64===!1;j&&j.binary!==void 0||(D.binary=!T),(I instanceof d&&I.uncompressedSize===0||D.dir||!I||I.length===0)&&(D.base64=!1,D.binary=!0,I="",D.compression="STORE",b="string");var k=null;k=I instanceof d||I instanceof l?I:p.isNode&&p.isStream(I)?new g(S,I):a.prepareContent(S,I,D.binary,D.optimizedBinaryString,D.base64);var B=new A(S,k,D);this.files[S]=B}var o=t("./utf8"),a=t("./utils"),l=t("./stream/GenericWorker"),h=t("./stream/StreamHelper"),u=t("./defaults"),d=t("./compressedObject"),A=t("./zipObject"),f=t("./generate"),p=t("./nodejsUtils"),g=t("./nodejs/NodejsStreamInputAdapter"),v=function(S){S.slice(-1)==="/"&&(S=S.substring(0,S.length-1));var I=S.lastIndexOf("/");return 0<I?S.substring(0,I):""},w=function(S){return S.slice(-1)!=="/"&&(S+="/"),S},m=function(S,I){return I=I!==void 0?I:u.createFolders,S=w(S),this.files[S]||s.call(this,S,null,{dir:!0,createFolders:I}),this.files[S]};function y(S){return Object.prototype.toString.call(S)==="[object RegExp]"}var x={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(S){var I,j,C;for(I in this.files)C=this.files[I],(j=I.slice(this.root.length,I.length))&&I.slice(0,this.root.length)===this.root&&S(j,C)},filter:function(S){var I=[];return this.forEach(function(j,C){S(j,C)&&I.push(C)}),I},file:function(S,I,j){if(arguments.length!==1)return S=this.root+S,s.call(this,S,I,j),this;if(y(S)){var C=S;return this.filter(function(D,T){return!T.dir&&C.test(D)})}var b=this.files[this.root+S];return b&&!b.dir?b:null},folder:function(S){if(!S)return this;if(y(S))return this.filter(function(b,D){return D.dir&&S.test(b)});var I=this.root+S,j=m.call(this,I),C=this.clone();return C.root=j.name,C},remove:function(S){S=this.root+S;var I=this.files[S];if(I||(S.slice(-1)!=="/"&&(S+="/"),I=this.files[S]),I&&!I.dir)delete this.files[S];else for(var j=this.filter(function(b,D){return D.name.slice(0,S.length)===S}),C=0;C<j.length;C++)delete this.files[j[C].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(S){var I,j={};try{if((j=a.extend(S||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=j.type.toLowerCase(),j.compression=j.compression.toUpperCase(),j.type==="binarystring"&&(j.type="string"),!j.type)throw new Error("No output type specified.");a.checkSupport(j.type),j.platform!=="darwin"&&j.platform!=="freebsd"&&j.platform!=="linux"&&j.platform!=="sunos"||(j.platform="UNIX"),j.platform==="win32"&&(j.platform="DOS");var C=j.comment||this.comment||"";I=f.generateWorker(this,j,C)}catch(b){(I=new l("error")).error(b)}return new h(I,j.type||"string",j.mimeType)},generateAsync:function(S,I){return this.generateInternalStream(S).accumulate(I)},generateNodeStream:function(S,I){return(S=S||{}).type||(S.type="nodebuffer"),this.generateInternalStream(S).toNodejsStream(I)}};i.exports=x},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,i,r){i.exports=t("stream")},{stream:void 0}],17:[function(t,i,r){var s=t("./DataReader");function o(a){s.call(this,a);for(var l=0;l<this.data.length;l++)a[l]=255&a[l]}t("../utils").inherits(o,s),o.prototype.byteAt=function(a){return this.data[this.zero+a]},o.prototype.lastIndexOfSignature=function(a){for(var l=a.charCodeAt(0),h=a.charCodeAt(1),u=a.charCodeAt(2),d=a.charCodeAt(3),A=this.length-4;0<=A;--A)if(this.data[A]===l&&this.data[A+1]===h&&this.data[A+2]===u&&this.data[A+3]===d)return A-this.zero;return-1},o.prototype.readAndCheckSignature=function(a){var l=a.charCodeAt(0),h=a.charCodeAt(1),u=a.charCodeAt(2),d=a.charCodeAt(3),A=this.readData(4);return l===A[0]&&h===A[1]&&u===A[2]&&d===A[3]},o.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},i.exports=o},{"../utils":32,"./DataReader":18}],18:[function(t,i,r){var s=t("../utils");function o(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var l,h=0;for(this.checkOffset(a),l=this.index+a-1;l>=this.index;l--)h=(h<<8)+this.byteAt(l);return this.index+=a,h},readString:function(a){return s.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},i.exports=o},{"../utils":32}],19:[function(t,i,r){var s=t("./Uint8ArrayReader");function o(a){s.call(this,a)}t("../utils").inherits(o,s),o.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},i.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,i,r){var s=t("./DataReader");function o(a){s.call(this,a)}t("../utils").inherits(o,s),o.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},o.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},o.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},o.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},i.exports=o},{"../utils":32,"./DataReader":18}],21:[function(t,i,r){var s=t("./ArrayReader");function o(a){s.call(this,a)}t("../utils").inherits(o,s),o.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},i.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(t,i,r){var s=t("../utils"),o=t("../support"),a=t("./ArrayReader"),l=t("./StringReader"),h=t("./NodeBufferReader"),u=t("./Uint8ArrayReader");i.exports=function(d){var A=s.getTypeOf(d);return s.checkSupport(A),A!=="string"||o.uint8array?A==="nodebuffer"?new h(d):o.uint8array?new u(s.transformTo("uint8array",d)):new a(s.transformTo("array",d)):new l(d)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,i,r){r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,i,r){var s=t("./GenericWorker"),o=t("../utils");function a(l){s.call(this,"ConvertWorker to "+l),this.destType=l}o.inherits(a,s),a.prototype.processChunk=function(l){this.push({data:o.transformTo(this.destType,l.data),meta:l.meta})},i.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(t,i,r){var s=t("./GenericWorker"),o=t("../crc32");function a(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(a,s),a.prototype.processChunk=function(l){this.streamInfo.crc32=o(l.data,this.streamInfo.crc32||0),this.push(l)},i.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,i,r){var s=t("../utils"),o=t("./GenericWorker");function a(l){o.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}s.inherits(a,o),a.prototype.processChunk=function(l){if(l){var h=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=h+l.data.length}o.prototype.processChunk.call(this,l)},i.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(t,i,r){var s=t("../utils"),o=t("./GenericWorker");function a(l){o.call(this,"DataWorker");var h=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(u){h.dataIsReady=!0,h.data=u,h.max=u&&u.length||0,h.type=s.getTypeOf(u),h.isPaused||h._tickAndRepeat()},function(u){h.error(u)})}s.inherits(a,o),a.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,h=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,h);break;case"uint8array":l=this.data.subarray(this.index,h);break;case"array":case"nodebuffer":l=this.data.slice(this.index,h)}return this.index=h,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(t,i,r){function s(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,a){return this._listeners[o].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,a){if(this._listeners[o])for(var l=0;l<this._listeners[o].length;l++)this._listeners[o][l].call(this,a)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var a=this;return o.on("data",function(l){a.processChunk(l)}),o.on("end",function(){a.end()}),o.on("error",function(l){a.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,a){return this.extraStreamInfo[o]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},i.exports=s},{}],29:[function(t,i,r){var s=t("../utils"),o=t("./ConvertWorker"),a=t("./GenericWorker"),l=t("../base64"),h=t("../support"),u=t("../external"),d=null;if(h.nodestream)try{d=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function A(p,g){return new u.Promise(function(v,w){var m=[],y=p._internalType,x=p._outputType,S=p._mimeType;p.on("data",function(I,j){m.push(I),g&&g(j)}).on("error",function(I){m=[],w(I)}).on("end",function(){try{var I=(function(j,C,b){switch(j){case"blob":return s.newBlob(s.transformTo("arraybuffer",C),b);case"base64":return l.encode(C);default:return s.transformTo(j,C)}})(x,(function(j,C){var b,D=0,T=null,k=0;for(b=0;b<C.length;b++)k+=C[b].length;switch(j){case"string":return C.join("");case"array":return Array.prototype.concat.apply([],C);case"uint8array":for(T=new Uint8Array(k),b=0;b<C.length;b++)T.set(C[b],D),D+=C[b].length;return T;case"nodebuffer":return Buffer.concat(C);default:throw new Error("concat : unsupported type '"+j+"'")}})(y,m),S);v(I)}catch(j){w(j)}m=[]}).resume()})}function f(p,g,v){var w=g;switch(g){case"blob":case"arraybuffer":w="uint8array";break;case"base64":w="string"}try{this._internalType=w,this._outputType=g,this._mimeType=v,s.checkSupport(w),this._worker=p.pipe(new o(w)),p.lock()}catch(m){this._worker=new a("error"),this._worker.error(m)}}f.prototype={accumulate:function(p){return A(this,p)},on:function(p,g){var v=this;return p==="data"?this._worker.on(p,function(w){g.call(v,w.data,w.meta)}):this._worker.on(p,function(){s.delay(g,arguments,v)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(p){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new d(this,{objectMode:this._outputType!=="nodebuffer"},p)}},i.exports=f},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,i,r){if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",r.nodebuffer=typeof Buffer<"u",r.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")r.blob=!1;else{var s=new ArrayBuffer(0);try{r.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(s),r.blob=o.getBlob("application/zip").size===0}catch{r.blob=!1}}}try{r.nodestream=!!t("readable-stream").Readable}catch{r.nodestream=!1}},{"readable-stream":16}],31:[function(t,i,r){for(var s=t("./utils"),o=t("./support"),a=t("./nodejsUtils"),l=t("./stream/GenericWorker"),h=new Array(256),u=0;u<256;u++)h[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;h[254]=h[254]=1;function d(){l.call(this,"utf-8 decode"),this.leftOver=null}function A(){l.call(this,"utf-8 encode")}r.utf8encode=function(f){return o.nodebuffer?a.newBufferFrom(f,"utf-8"):(function(p){var g,v,w,m,y,x=p.length,S=0;for(m=0;m<x;m++)(64512&(v=p.charCodeAt(m)))==55296&&m+1<x&&(64512&(w=p.charCodeAt(m+1)))==56320&&(v=65536+(v-55296<<10)+(w-56320),m++),S+=v<128?1:v<2048?2:v<65536?3:4;for(g=o.uint8array?new Uint8Array(S):new Array(S),m=y=0;y<S;m++)(64512&(v=p.charCodeAt(m)))==55296&&m+1<x&&(64512&(w=p.charCodeAt(m+1)))==56320&&(v=65536+(v-55296<<10)+(w-56320),m++),v<128?g[y++]=v:(v<2048?g[y++]=192|v>>>6:(v<65536?g[y++]=224|v>>>12:(g[y++]=240|v>>>18,g[y++]=128|v>>>12&63),g[y++]=128|v>>>6&63),g[y++]=128|63&v);return g})(f)},r.utf8decode=function(f){return o.nodebuffer?s.transformTo("nodebuffer",f).toString("utf-8"):(function(p){var g,v,w,m,y=p.length,x=new Array(2*y);for(g=v=0;g<y;)if((w=p[g++])<128)x[v++]=w;else if(4<(m=h[w]))x[v++]=65533,g+=m-1;else{for(w&=m===2?31:m===3?15:7;1<m&&g<y;)w=w<<6|63&p[g++],m--;1<m?x[v++]=65533:w<65536?x[v++]=w:(w-=65536,x[v++]=55296|w>>10&1023,x[v++]=56320|1023&w)}return x.length!==v&&(x.subarray?x=x.subarray(0,v):x.length=v),s.applyFromCharCode(x)})(f=s.transformTo(o.uint8array?"uint8array":"array",f))},s.inherits(d,l),d.prototype.processChunk=function(f){var p=s.transformTo(o.uint8array?"uint8array":"array",f.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var g=p;(p=new Uint8Array(g.length+this.leftOver.length)).set(this.leftOver,0),p.set(g,this.leftOver.length)}else p=this.leftOver.concat(p);this.leftOver=null}var v=(function(m,y){var x;for((y=y||m.length)>m.length&&(y=m.length),x=y-1;0<=x&&(192&m[x])==128;)x--;return x<0||x===0?y:x+h[m[x]]>y?x:y})(p),w=p;v!==p.length&&(o.uint8array?(w=p.subarray(0,v),this.leftOver=p.subarray(v,p.length)):(w=p.slice(0,v),this.leftOver=p.slice(v,p.length))),this.push({data:r.utf8decode(w),meta:f.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=d,s.inherits(A,l),A.prototype.processChunk=function(f){this.push({data:r.utf8encode(f.data),meta:f.meta})},r.Utf8EncodeWorker=A},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,i,r){var s=t("./support"),o=t("./base64"),a=t("./nodejsUtils"),l=t("./external");function h(g){return g}function u(g,v){for(var w=0;w<g.length;++w)v[w]=255&g.charCodeAt(w);return v}t("setimmediate"),r.newBlob=function(g,v){r.checkSupport("blob");try{return new Blob([g],{type:v})}catch{try{var w=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return w.append(g),w.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};var d={stringifyByChunk:function(g,v,w){var m=[],y=0,x=g.length;if(x<=w)return String.fromCharCode.apply(null,g);for(;y<x;)v==="array"||v==="nodebuffer"?m.push(String.fromCharCode.apply(null,g.slice(y,Math.min(y+w,x)))):m.push(String.fromCharCode.apply(null,g.subarray(y,Math.min(y+w,x)))),y+=w;return m.join("")},stringifyByChar:function(g){for(var v="",w=0;w<g.length;w++)v+=String.fromCharCode(g[w]);return v},applyCanBeUsed:{uint8array:(function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}})()}};function A(g){var v=65536,w=r.getTypeOf(g),m=!0;if(w==="uint8array"?m=d.applyCanBeUsed.uint8array:w==="nodebuffer"&&(m=d.applyCanBeUsed.nodebuffer),m)for(;1<v;)try{return d.stringifyByChunk(g,w,v)}catch{v=Math.floor(v/2)}return d.stringifyByChar(g)}function f(g,v){for(var w=0;w<g.length;w++)v[w]=g[w];return v}r.applyFromCharCode=A;var p={};p.string={string:h,array:function(g){return u(g,new Array(g.length))},arraybuffer:function(g){return p.string.uint8array(g).buffer},uint8array:function(g){return u(g,new Uint8Array(g.length))},nodebuffer:function(g){return u(g,a.allocBuffer(g.length))}},p.array={string:A,array:h,arraybuffer:function(g){return new Uint8Array(g).buffer},uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return a.newBufferFrom(g)}},p.arraybuffer={string:function(g){return A(new Uint8Array(g))},array:function(g){return f(new Uint8Array(g),new Array(g.byteLength))},arraybuffer:h,uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return a.newBufferFrom(new Uint8Array(g))}},p.uint8array={string:A,array:function(g){return f(g,new Array(g.length))},arraybuffer:function(g){return g.buffer},uint8array:h,nodebuffer:function(g){return a.newBufferFrom(g)}},p.nodebuffer={string:A,array:function(g){return f(g,new Array(g.length))},arraybuffer:function(g){return p.nodebuffer.uint8array(g).buffer},uint8array:function(g){return f(g,new Uint8Array(g.length))},nodebuffer:h},r.transformTo=function(g,v){if(v=v||"",!g)return v;r.checkSupport(g);var w=r.getTypeOf(v);return p[w][g](v)},r.resolve=function(g){for(var v=g.split("/"),w=[],m=0;m<v.length;m++){var y=v[m];y==="."||y===""&&m!==0&&m!==v.length-1||(y===".."?w.pop():w.push(y))}return w.join("/")},r.getTypeOf=function(g){return typeof g=="string"?"string":Object.prototype.toString.call(g)==="[object Array]"?"array":s.nodebuffer&&a.isBuffer(g)?"nodebuffer":s.uint8array&&g instanceof Uint8Array?"uint8array":s.arraybuffer&&g instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(g){if(!s[g.toLowerCase()])throw new Error(g+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(g){var v,w,m="";for(w=0;w<(g||"").length;w++)m+="\\x"+((v=g.charCodeAt(w))<16?"0":"")+v.toString(16).toUpperCase();return m},r.delay=function(g,v,w){setImmediate(function(){g.apply(w||null,v||[])})},r.inherits=function(g,v){function w(){}w.prototype=v.prototype,g.prototype=new w},r.extend=function(){var g,v,w={};for(g=0;g<arguments.length;g++)for(v in arguments[g])Object.prototype.hasOwnProperty.call(arguments[g],v)&&w[v]===void 0&&(w[v]=arguments[g][v]);return w},r.prepareContent=function(g,v,w,m,y){return l.Promise.resolve(v).then(function(x){return s.blob&&(x instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(x))!==-1)&&typeof FileReader<"u"?new l.Promise(function(S,I){var j=new FileReader;j.onload=function(C){S(C.target.result)},j.onerror=function(C){I(C.target.error)},j.readAsArrayBuffer(x)}):x}).then(function(x){var S=r.getTypeOf(x);return S?(S==="arraybuffer"?x=r.transformTo("uint8array",x):S==="string"&&(y?x=o.decode(x):w&&m!==!0&&(x=(function(I){return u(I,s.uint8array?new Uint8Array(I.length):new Array(I.length))})(x))),x):l.Promise.reject(new Error("Can't read the data of '"+g+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,i,r){var s=t("./reader/readerFor"),o=t("./utils"),a=t("./signature"),l=t("./zipEntry"),h=t("./support");function u(d){this.files=[],this.loadOptions=d}u.prototype={checkSignature:function(d){if(!this.reader.readAndCheckSignature(d)){this.reader.index-=4;var A=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(A)+", expected "+o.pretty(d)+")")}},isSignature:function(d,A){var f=this.reader.index;this.reader.setIndex(d);var p=this.reader.readString(4)===A;return this.reader.setIndex(f),p},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var d=this.reader.readData(this.zipCommentLength),A=h.uint8array?"uint8array":"array",f=o.transformTo(A,d);this.zipComment=this.loadOptions.decodeFileName(f)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var d,A,f,p=this.zip64EndOfCentralSize-44;0<p;)d=this.reader.readInt(2),A=this.reader.readInt(4),f=this.reader.readData(A),this.zip64ExtensibleData[d]={id:d,length:A,value:f}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var d,A;for(d=0;d<this.files.length;d++)A=this.files[d],this.reader.setIndex(A.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),A.readLocalPart(this.reader),A.handleUTF8(),A.processAttributes()},readCentralDir:function(){var d;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(d=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(d);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var d=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(d<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(d);var A=d;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(d=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(d),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var f=this.centralDirOffset+this.centralDirSize;this.zip64&&(f+=20,f+=12+this.zip64EndOfCentralSize);var p=A-f;if(0<p)this.isSignature(A,a.CENTRAL_FILE_HEADER)||(this.reader.zero=p);else if(p<0)throw new Error("Corrupted zip: missing "+Math.abs(p)+" bytes.")},prepareReader:function(d){this.reader=s(d)},load:function(d){this.prepareReader(d),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,i,r){var s=t("./reader/readerFor"),o=t("./utils"),a=t("./compressedObject"),l=t("./crc32"),h=t("./utf8"),u=t("./compressions"),d=t("./support");function A(f,p){this.options=f,this.loadOptions=p}A.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(f){var p,g;if(f.skip(22),this.fileNameLength=f.readInt(2),g=f.readInt(2),this.fileName=f.readData(this.fileNameLength),f.skip(g),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((p=(function(v){for(var w in u)if(Object.prototype.hasOwnProperty.call(u,w)&&u[w].magic===v)return u[w];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,p,f.readData(this.compressedSize))},readCentralPart:function(f){this.versionMadeBy=f.readInt(2),f.skip(2),this.bitFlag=f.readInt(2),this.compressionMethod=f.readString(2),this.date=f.readDate(),this.crc32=f.readInt(4),this.compressedSize=f.readInt(4),this.uncompressedSize=f.readInt(4);var p=f.readInt(2);if(this.extraFieldsLength=f.readInt(2),this.fileCommentLength=f.readInt(2),this.diskNumberStart=f.readInt(2),this.internalFileAttributes=f.readInt(2),this.externalFileAttributes=f.readInt(4),this.localHeaderOffset=f.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");f.skip(p),this.readExtraFields(f),this.parseZIP64ExtraField(f),this.fileComment=f.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var f=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),f==0&&(this.dosPermissions=63&this.externalFileAttributes),f==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var f=s(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=f.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=f.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=f.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=f.readInt(4))}},readExtraFields:function(f){var p,g,v,w=f.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});f.index+4<w;)p=f.readInt(2),g=f.readInt(2),v=f.readData(g),this.extraFields[p]={id:p,length:g,value:v};f.setIndex(w)},handleUTF8:function(){var f=d.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=h.utf8decode(this.fileName),this.fileCommentStr=h.utf8decode(this.fileComment);else{var p=this.findExtraFieldUnicodePath();if(p!==null)this.fileNameStr=p;else{var g=o.transformTo(f,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(g)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var w=o.transformTo(f,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(w)}}},findExtraFieldUnicodePath:function(){var f=this.extraFields[28789];if(f){var p=s(f.value);return p.readInt(1)!==1||l(this.fileName)!==p.readInt(4)?null:h.utf8decode(p.readData(f.length-5))}return null},findExtraFieldUnicodeComment:function(){var f=this.extraFields[25461];if(f){var p=s(f.value);return p.readInt(1)!==1||l(this.fileComment)!==p.readInt(4)?null:h.utf8decode(p.readData(f.length-5))}return null}},i.exports=A},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,i,r){function s(p,g,v){this.name=p,this.dir=v.dir,this.date=v.date,this.comment=v.comment,this.unixPermissions=v.unixPermissions,this.dosPermissions=v.dosPermissions,this._data=g,this._dataBinary=v.binary,this.options={compression:v.compression,compressionOptions:v.compressionOptions}}var o=t("./stream/StreamHelper"),a=t("./stream/DataWorker"),l=t("./utf8"),h=t("./compressedObject"),u=t("./stream/GenericWorker");s.prototype={internalStream:function(p){var g=null,v="string";try{if(!p)throw new Error("No output type specified.");var w=(v=p.toLowerCase())==="string"||v==="text";v!=="binarystring"&&v!=="text"||(v="string"),g=this._decompressWorker();var m=!this._dataBinary;m&&!w&&(g=g.pipe(new l.Utf8EncodeWorker)),!m&&w&&(g=g.pipe(new l.Utf8DecodeWorker))}catch(y){(g=new u("error")).error(y)}return new o(g,v,"")},async:function(p,g){return this.internalStream(p).accumulate(g)},nodeStream:function(p,g){return this.internalStream(p||"nodebuffer").toNodejsStream(g)},_compressWorker:function(p,g){if(this._data instanceof h&&this._data.compression.magic===p.magic)return this._data.getCompressedWorker();var v=this._decompressWorker();return this._dataBinary||(v=v.pipe(new l.Utf8EncodeWorker)),h.createWorkerFrom(v,p,g)},_decompressWorker:function(){return this._data instanceof h?this._data.getContentWorker():this._data instanceof u?this._data:new a(this._data)}};for(var d=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],A=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},f=0;f<d.length;f++)s.prototype[d[f]]=A;i.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,i,r){(function(s){var o,a,l=s.MutationObserver||s.WebKitMutationObserver;if(l){var h=0,u=new l(p),d=s.document.createTextNode("");u.observe(d,{characterData:!0}),o=function(){d.data=h=++h%2}}else if(s.setImmediate||s.MessageChannel===void 0)o="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var g=s.document.createElement("script");g.onreadystatechange=function(){p(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},s.document.documentElement.appendChild(g)}:function(){setTimeout(p,0)};else{var A=new s.MessageChannel;A.port1.onmessage=p,o=function(){A.port2.postMessage(0)}}var f=[];function p(){var g,v;a=!0;for(var w=f.length;w;){for(v=f,f=[],g=-1;++g<w;)v[g]();w=f.length}a=!1}i.exports=function(g){f.push(g)!==1||a||o()}}).call(this,typeof mm<"u"?mm:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,i,r){var s=t("immediate");function o(){}var a={},l=["REJECTED"],h=["FULFILLED"],u=["PENDING"];function d(w){if(typeof w!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,w!==o&&g(this,w)}function A(w,m,y){this.promise=w,typeof m=="function"&&(this.onFulfilled=m,this.callFulfilled=this.otherCallFulfilled),typeof y=="function"&&(this.onRejected=y,this.callRejected=this.otherCallRejected)}function f(w,m,y){s(function(){var x;try{x=m(y)}catch(S){return a.reject(w,S)}x===w?a.reject(w,new TypeError("Cannot resolve promise with itself")):a.resolve(w,x)})}function p(w){var m=w&&w.then;if(w&&(typeof w=="object"||typeof w=="function")&&typeof m=="function")return function(){m.apply(w,arguments)}}function g(w,m){var y=!1;function x(j){y||(y=!0,a.reject(w,j))}function S(j){y||(y=!0,a.resolve(w,j))}var I=v(function(){m(S,x)});I.status==="error"&&x(I.value)}function v(w,m){var y={};try{y.value=w(m),y.status="success"}catch(x){y.status="error",y.value=x}return y}(i.exports=d).prototype.finally=function(w){if(typeof w!="function")return this;var m=this.constructor;return this.then(function(y){return m.resolve(w()).then(function(){return y})},function(y){return m.resolve(w()).then(function(){throw y})})},d.prototype.catch=function(w){return this.then(null,w)},d.prototype.then=function(w,m){if(typeof w!="function"&&this.state===h||typeof m!="function"&&this.state===l)return this;var y=new this.constructor(o);return this.state!==u?f(y,this.state===h?w:m,this.outcome):this.queue.push(new A(y,w,m)),y},A.prototype.callFulfilled=function(w){a.resolve(this.promise,w)},A.prototype.otherCallFulfilled=function(w){f(this.promise,this.onFulfilled,w)},A.prototype.callRejected=function(w){a.reject(this.promise,w)},A.prototype.otherCallRejected=function(w){f(this.promise,this.onRejected,w)},a.resolve=function(w,m){var y=v(p,m);if(y.status==="error")return a.reject(w,y.value);var x=y.value;if(x)g(w,x);else{w.state=h,w.outcome=m;for(var S=-1,I=w.queue.length;++S<I;)w.queue[S].callFulfilled(m)}return w},a.reject=function(w,m){w.state=l,w.outcome=m;for(var y=-1,x=w.queue.length;++y<x;)w.queue[y].callRejected(m);return w},d.resolve=function(w){return w instanceof this?w:a.resolve(new this(o),w)},d.reject=function(w){var m=new this(o);return a.reject(m,w)},d.all=function(w){var m=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var y=w.length,x=!1;if(!y)return this.resolve([]);for(var S=new Array(y),I=0,j=-1,C=new this(o);++j<y;)b(w[j],j);return C;function b(D,T){m.resolve(D).then(function(k){S[T]=k,++I!==y||x||(x=!0,a.resolve(C,S))},function(k){x||(x=!0,a.reject(C,k))})}},d.race=function(w){var m=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var y=w.length,x=!1;if(!y)return this.resolve([]);for(var S=-1,I=new this(o);++S<y;)j=w[S],m.resolve(j).then(function(C){x||(x=!0,a.resolve(I,C))},function(C){x||(x=!0,a.reject(I,C))});var j;return I}},{immediate:36}],38:[function(t,i,r){var s={};(0,t("./lib/utils/common").assign)(s,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),i.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,i,r){var s=t("./zlib/deflate"),o=t("./utils/common"),a=t("./utils/strings"),l=t("./zlib/messages"),h=t("./zlib/zstream"),u=Object.prototype.toString,d=0,A=-1,f=0,p=8;function g(w){if(!(this instanceof g))return new g(w);this.options=o.assign({level:A,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:f,to:""},w||{});var m=this.options;m.raw&&0<m.windowBits?m.windowBits=-m.windowBits:m.gzip&&0<m.windowBits&&m.windowBits<16&&(m.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var y=s.deflateInit2(this.strm,m.level,m.method,m.windowBits,m.memLevel,m.strategy);if(y!==d)throw new Error(l[y]);if(m.header&&s.deflateSetHeader(this.strm,m.header),m.dictionary){var x;if(x=typeof m.dictionary=="string"?a.string2buf(m.dictionary):u.call(m.dictionary)==="[object ArrayBuffer]"?new Uint8Array(m.dictionary):m.dictionary,(y=s.deflateSetDictionary(this.strm,x))!==d)throw new Error(l[y]);this._dict_set=!0}}function v(w,m){var y=new g(m);if(y.push(w,!0),y.err)throw y.msg||l[y.err];return y.result}g.prototype.push=function(w,m){var y,x,S=this.strm,I=this.options.chunkSize;if(this.ended)return!1;x=m===~~m?m:m===!0?4:0,typeof w=="string"?S.input=a.string2buf(w):u.call(w)==="[object ArrayBuffer]"?S.input=new Uint8Array(w):S.input=w,S.next_in=0,S.avail_in=S.input.length;do{if(S.avail_out===0&&(S.output=new o.Buf8(I),S.next_out=0,S.avail_out=I),(y=s.deflate(S,x))!==1&&y!==d)return this.onEnd(y),!(this.ended=!0);S.avail_out!==0&&(S.avail_in!==0||x!==4&&x!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(o.shrinkBuf(S.output,S.next_out))):this.onData(o.shrinkBuf(S.output,S.next_out)))}while((0<S.avail_in||S.avail_out===0)&&y!==1);return x===4?(y=s.deflateEnd(this.strm),this.onEnd(y),this.ended=!0,y===d):x!==2||(this.onEnd(d),!(S.avail_out=0))},g.prototype.onData=function(w){this.chunks.push(w)},g.prototype.onEnd=function(w){w===d&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=w,this.msg=this.strm.msg},r.Deflate=g,r.deflate=v,r.deflateRaw=function(w,m){return(m=m||{}).raw=!0,v(w,m)},r.gzip=function(w,m){return(m=m||{}).gzip=!0,v(w,m)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,i,r){var s=t("./zlib/inflate"),o=t("./utils/common"),a=t("./utils/strings"),l=t("./zlib/constants"),h=t("./zlib/messages"),u=t("./zlib/zstream"),d=t("./zlib/gzheader"),A=Object.prototype.toString;function f(g){if(!(this instanceof f))return new f(g);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},g||{});var v=this.options;v.raw&&0<=v.windowBits&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),!(0<=v.windowBits&&v.windowBits<16)||g&&g.windowBits||(v.windowBits+=32),15<v.windowBits&&v.windowBits<48&&(15&v.windowBits)==0&&(v.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var w=s.inflateInit2(this.strm,v.windowBits);if(w!==l.Z_OK)throw new Error(h[w]);this.header=new d,s.inflateGetHeader(this.strm,this.header)}function p(g,v){var w=new f(v);if(w.push(g,!0),w.err)throw w.msg||h[w.err];return w.result}f.prototype.push=function(g,v){var w,m,y,x,S,I,j=this.strm,C=this.options.chunkSize,b=this.options.dictionary,D=!1;if(this.ended)return!1;m=v===~~v?v:v===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof g=="string"?j.input=a.binstring2buf(g):A.call(g)==="[object ArrayBuffer]"?j.input=new Uint8Array(g):j.input=g,j.next_in=0,j.avail_in=j.input.length;do{if(j.avail_out===0&&(j.output=new o.Buf8(C),j.next_out=0,j.avail_out=C),(w=s.inflate(j,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&b&&(I=typeof b=="string"?a.string2buf(b):A.call(b)==="[object ArrayBuffer]"?new Uint8Array(b):b,w=s.inflateSetDictionary(this.strm,I)),w===l.Z_BUF_ERROR&&D===!0&&(w=l.Z_OK,D=!1),w!==l.Z_STREAM_END&&w!==l.Z_OK)return this.onEnd(w),!(this.ended=!0);j.next_out&&(j.avail_out!==0&&w!==l.Z_STREAM_END&&(j.avail_in!==0||m!==l.Z_FINISH&&m!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(y=a.utf8border(j.output,j.next_out),x=j.next_out-y,S=a.buf2string(j.output,y),j.next_out=x,j.avail_out=C-x,x&&o.arraySet(j.output,j.output,y,x,0),this.onData(S)):this.onData(o.shrinkBuf(j.output,j.next_out)))),j.avail_in===0&&j.avail_out===0&&(D=!0)}while((0<j.avail_in||j.avail_out===0)&&w!==l.Z_STREAM_END);return w===l.Z_STREAM_END&&(m=l.Z_FINISH),m===l.Z_FINISH?(w=s.inflateEnd(this.strm),this.onEnd(w),this.ended=!0,w===l.Z_OK):m!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(j.avail_out=0))},f.prototype.onData=function(g){this.chunks.push(g)},f.prototype.onEnd=function(g){g===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},r.Inflate=f,r.inflate=p,r.inflateRaw=function(g,v){return(v=v||{}).raw=!0,p(g,v)},r.ungzip=p},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,i,r){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";r.assign=function(l){for(var h=Array.prototype.slice.call(arguments,1);h.length;){var u=h.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var d in u)u.hasOwnProperty(d)&&(l[d]=u[d])}}return l},r.shrinkBuf=function(l,h){return l.length===h?l:l.subarray?l.subarray(0,h):(l.length=h,l)};var o={arraySet:function(l,h,u,d,A){if(h.subarray&&l.subarray)l.set(h.subarray(u,u+d),A);else for(var f=0;f<d;f++)l[A+f]=h[u+f]},flattenChunks:function(l){var h,u,d,A,f,p;for(h=d=0,u=l.length;h<u;h++)d+=l[h].length;for(p=new Uint8Array(d),h=A=0,u=l.length;h<u;h++)f=l[h],p.set(f,A),A+=f.length;return p}},a={arraySet:function(l,h,u,d,A){for(var f=0;f<d;f++)l[A+f]=h[u+f]},flattenChunks:function(l){return[].concat.apply([],l)}};r.setTyped=function(l){l?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,o)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,a))},r.setTyped(s)},{}],42:[function(t,i,r){var s=t("./common"),o=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var l=new s.Buf8(256),h=0;h<256;h++)l[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;function u(d,A){if(A<65537&&(d.subarray&&a||!d.subarray&&o))return String.fromCharCode.apply(null,s.shrinkBuf(d,A));for(var f="",p=0;p<A;p++)f+=String.fromCharCode(d[p]);return f}l[254]=l[254]=1,r.string2buf=function(d){var A,f,p,g,v,w=d.length,m=0;for(g=0;g<w;g++)(64512&(f=d.charCodeAt(g)))==55296&&g+1<w&&(64512&(p=d.charCodeAt(g+1)))==56320&&(f=65536+(f-55296<<10)+(p-56320),g++),m+=f<128?1:f<2048?2:f<65536?3:4;for(A=new s.Buf8(m),g=v=0;v<m;g++)(64512&(f=d.charCodeAt(g)))==55296&&g+1<w&&(64512&(p=d.charCodeAt(g+1)))==56320&&(f=65536+(f-55296<<10)+(p-56320),g++),f<128?A[v++]=f:(f<2048?A[v++]=192|f>>>6:(f<65536?A[v++]=224|f>>>12:(A[v++]=240|f>>>18,A[v++]=128|f>>>12&63),A[v++]=128|f>>>6&63),A[v++]=128|63&f);return A},r.buf2binstring=function(d){return u(d,d.length)},r.binstring2buf=function(d){for(var A=new s.Buf8(d.length),f=0,p=A.length;f<p;f++)A[f]=d.charCodeAt(f);return A},r.buf2string=function(d,A){var f,p,g,v,w=A||d.length,m=new Array(2*w);for(f=p=0;f<w;)if((g=d[f++])<128)m[p++]=g;else if(4<(v=l[g]))m[p++]=65533,f+=v-1;else{for(g&=v===2?31:v===3?15:7;1<v&&f<w;)g=g<<6|63&d[f++],v--;1<v?m[p++]=65533:g<65536?m[p++]=g:(g-=65536,m[p++]=55296|g>>10&1023,m[p++]=56320|1023&g)}return u(m,p)},r.utf8border=function(d,A){var f;for((A=A||d.length)>d.length&&(A=d.length),f=A-1;0<=f&&(192&d[f])==128;)f--;return f<0||f===0?A:f+l[d[f]]>A?f:A}},{"./common":41}],43:[function(t,i,r){i.exports=function(s,o,a,l){for(var h=65535&s|0,u=s>>>16&65535|0,d=0;a!==0;){for(a-=d=2e3<a?2e3:a;u=u+(h=h+o[l++]|0)|0,--d;);h%=65521,u%=65521}return h|u<<16|0}},{}],44:[function(t,i,r){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,i,r){var s=(function(){for(var o,a=[],l=0;l<256;l++){o=l;for(var h=0;h<8;h++)o=1&o?3988292384^o>>>1:o>>>1;a[l]=o}return a})();i.exports=function(o,a,l,h){var u=s,d=h+l;o^=-1;for(var A=h;A<d;A++)o=o>>>8^u[255&(o^a[A])];return-1^o}},{}],46:[function(t,i,r){var s,o=t("../utils/common"),a=t("./trees"),l=t("./adler32"),h=t("./crc32"),u=t("./messages"),d=0,A=4,f=0,p=-2,g=-1,v=4,w=2,m=8,y=9,x=286,S=30,I=19,j=2*x+1,C=15,b=3,D=258,T=D+b+1,k=42,B=113,E=1,z=2,te=3,L=4;function O(M,Z){return M.msg=u[Z],Z}function J(M){return(M<<1)-(4<M?9:0)}function $(M){for(var Z=M.length;0<=--Z;)M[Z]=0}function U(M){var Z=M.state,Ae=Z.pending;Ae>M.avail_out&&(Ae=M.avail_out),Ae!==0&&(o.arraySet(M.output,Z.pending_buf,Z.pending_out,Ae,M.next_out),M.next_out+=Ae,Z.pending_out+=Ae,M.total_out+=Ae,M.avail_out-=Ae,Z.pending-=Ae,Z.pending===0&&(Z.pending_out=0))}function Y(M,Z){a._tr_flush_block(M,0<=M.block_start?M.block_start:-1,M.strstart-M.block_start,Z),M.block_start=M.strstart,U(M.strm)}function K(M,Z){M.pending_buf[M.pending++]=Z}function V(M,Z){M.pending_buf[M.pending++]=Z>>>8&255,M.pending_buf[M.pending++]=255&Z}function Q(M,Z){var Ae,ie,ee=M.max_chain_length,ae=M.strstart,me=M.prev_length,_e=M.nice_match,ue=M.strstart>M.w_size-T?M.strstart-(M.w_size-T):0,Be=M.window,it=M.w_mask,De=M.prev,qe=M.strstart+D,Je=Be[ae+me-1],Me=Be[ae+me];M.prev_length>=M.good_match&&(ee>>=2),_e>M.lookahead&&(_e=M.lookahead);do if(Be[(Ae=Z)+me]===Me&&Be[Ae+me-1]===Je&&Be[Ae]===Be[ae]&&Be[++Ae]===Be[ae+1]){ae+=2,Ae++;do;while(Be[++ae]===Be[++Ae]&&Be[++ae]===Be[++Ae]&&Be[++ae]===Be[++Ae]&&Be[++ae]===Be[++Ae]&&Be[++ae]===Be[++Ae]&&Be[++ae]===Be[++Ae]&&Be[++ae]===Be[++Ae]&&Be[++ae]===Be[++Ae]&&ae<qe);if(ie=D-(qe-ae),ae=qe-D,me<ie){if(M.match_start=Z,_e<=(me=ie))break;Je=Be[ae+me-1],Me=Be[ae+me]}}while((Z=De[Z&it])>ue&&--ee!=0);return me<=M.lookahead?me:M.lookahead}function X(M){var Z,Ae,ie,ee,ae,me,_e,ue,Be,it,De=M.w_size;do{if(ee=M.window_size-M.lookahead-M.strstart,M.strstart>=De+(De-T)){for(o.arraySet(M.window,M.window,De,De,0),M.match_start-=De,M.strstart-=De,M.block_start-=De,Z=Ae=M.hash_size;ie=M.head[--Z],M.head[Z]=De<=ie?ie-De:0,--Ae;);for(Z=Ae=De;ie=M.prev[--Z],M.prev[Z]=De<=ie?ie-De:0,--Ae;);ee+=De}if(M.strm.avail_in===0)break;if(me=M.strm,_e=M.window,ue=M.strstart+M.lookahead,Be=ee,it=void 0,it=me.avail_in,Be<it&&(it=Be),Ae=it===0?0:(me.avail_in-=it,o.arraySet(_e,me.input,me.next_in,it,ue),me.state.wrap===1?me.adler=l(me.adler,_e,it,ue):me.state.wrap===2&&(me.adler=h(me.adler,_e,it,ue)),me.next_in+=it,me.total_in+=it,it),M.lookahead+=Ae,M.lookahead+M.insert>=b)for(ae=M.strstart-M.insert,M.ins_h=M.window[ae],M.ins_h=(M.ins_h<<M.hash_shift^M.window[ae+1])&M.hash_mask;M.insert&&(M.ins_h=(M.ins_h<<M.hash_shift^M.window[ae+b-1])&M.hash_mask,M.prev[ae&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=ae,ae++,M.insert--,!(M.lookahead+M.insert<b)););}while(M.lookahead<T&&M.strm.avail_in!==0)}function W(M,Z){for(var Ae,ie;;){if(M.lookahead<T){if(X(M),M.lookahead<T&&Z===d)return E;if(M.lookahead===0)break}if(Ae=0,M.lookahead>=b&&(M.ins_h=(M.ins_h<<M.hash_shift^M.window[M.strstart+b-1])&M.hash_mask,Ae=M.prev[M.strstart&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=M.strstart),Ae!==0&&M.strstart-Ae<=M.w_size-T&&(M.match_length=Q(M,Ae)),M.match_length>=b)if(ie=a._tr_tally(M,M.strstart-M.match_start,M.match_length-b),M.lookahead-=M.match_length,M.match_length<=M.max_lazy_match&&M.lookahead>=b){for(M.match_length--;M.strstart++,M.ins_h=(M.ins_h<<M.hash_shift^M.window[M.strstart+b-1])&M.hash_mask,Ae=M.prev[M.strstart&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=M.strstart,--M.match_length!=0;);M.strstart++}else M.strstart+=M.match_length,M.match_length=0,M.ins_h=M.window[M.strstart],M.ins_h=(M.ins_h<<M.hash_shift^M.window[M.strstart+1])&M.hash_mask;else ie=a._tr_tally(M,0,M.window[M.strstart]),M.lookahead--,M.strstart++;if(ie&&(Y(M,!1),M.strm.avail_out===0))return E}return M.insert=M.strstart<b-1?M.strstart:b-1,Z===A?(Y(M,!0),M.strm.avail_out===0?te:L):M.last_lit&&(Y(M,!1),M.strm.avail_out===0)?E:z}function se(M,Z){for(var Ae,ie,ee;;){if(M.lookahead<T){if(X(M),M.lookahead<T&&Z===d)return E;if(M.lookahead===0)break}if(Ae=0,M.lookahead>=b&&(M.ins_h=(M.ins_h<<M.hash_shift^M.window[M.strstart+b-1])&M.hash_mask,Ae=M.prev[M.strstart&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=M.strstart),M.prev_length=M.match_length,M.prev_match=M.match_start,M.match_length=b-1,Ae!==0&&M.prev_length<M.max_lazy_match&&M.strstart-Ae<=M.w_size-T&&(M.match_length=Q(M,Ae),M.match_length<=5&&(M.strategy===1||M.match_length===b&&4096<M.strstart-M.match_start)&&(M.match_length=b-1)),M.prev_length>=b&&M.match_length<=M.prev_length){for(ee=M.strstart+M.lookahead-b,ie=a._tr_tally(M,M.strstart-1-M.prev_match,M.prev_length-b),M.lookahead-=M.prev_length-1,M.prev_length-=2;++M.strstart<=ee&&(M.ins_h=(M.ins_h<<M.hash_shift^M.window[M.strstart+b-1])&M.hash_mask,Ae=M.prev[M.strstart&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=M.strstart),--M.prev_length!=0;);if(M.match_available=0,M.match_length=b-1,M.strstart++,ie&&(Y(M,!1),M.strm.avail_out===0))return E}else if(M.match_available){if((ie=a._tr_tally(M,0,M.window[M.strstart-1]))&&Y(M,!1),M.strstart++,M.lookahead--,M.strm.avail_out===0)return E}else M.match_available=1,M.strstart++,M.lookahead--}return M.match_available&&(ie=a._tr_tally(M,0,M.window[M.strstart-1]),M.match_available=0),M.insert=M.strstart<b-1?M.strstart:b-1,Z===A?(Y(M,!0),M.strm.avail_out===0?te:L):M.last_lit&&(Y(M,!1),M.strm.avail_out===0)?E:z}function q(M,Z,Ae,ie,ee){this.good_length=M,this.max_lazy=Z,this.nice_length=Ae,this.max_chain=ie,this.func=ee}function de(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=m,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*j),this.dyn_dtree=new o.Buf16(2*(2*S+1)),this.bl_tree=new o.Buf16(2*(2*I+1)),$(this.dyn_ltree),$(this.dyn_dtree),$(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(C+1),this.heap=new o.Buf16(2*x+1),$(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*x+1),$(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Ce(M){var Z;return M&&M.state?(M.total_in=M.total_out=0,M.data_type=w,(Z=M.state).pending=0,Z.pending_out=0,Z.wrap<0&&(Z.wrap=-Z.wrap),Z.status=Z.wrap?k:B,M.adler=Z.wrap===2?0:1,Z.last_flush=d,a._tr_init(Z),f):O(M,p)}function Se(M){var Z=Ce(M);return Z===f&&(function(Ae){Ae.window_size=2*Ae.w_size,$(Ae.head),Ae.max_lazy_match=s[Ae.level].max_lazy,Ae.good_match=s[Ae.level].good_length,Ae.nice_match=s[Ae.level].nice_length,Ae.max_chain_length=s[Ae.level].max_chain,Ae.strstart=0,Ae.block_start=0,Ae.lookahead=0,Ae.insert=0,Ae.match_length=Ae.prev_length=b-1,Ae.match_available=0,Ae.ins_h=0})(M.state),Z}function fe(M,Z,Ae,ie,ee,ae){if(!M)return p;var me=1;if(Z===g&&(Z=6),ie<0?(me=0,ie=-ie):15<ie&&(me=2,ie-=16),ee<1||y<ee||Ae!==m||ie<8||15<ie||Z<0||9<Z||ae<0||v<ae)return O(M,p);ie===8&&(ie=9);var _e=new de;return(M.state=_e).strm=M,_e.wrap=me,_e.gzhead=null,_e.w_bits=ie,_e.w_size=1<<_e.w_bits,_e.w_mask=_e.w_size-1,_e.hash_bits=ee+7,_e.hash_size=1<<_e.hash_bits,_e.hash_mask=_e.hash_size-1,_e.hash_shift=~~((_e.hash_bits+b-1)/b),_e.window=new o.Buf8(2*_e.w_size),_e.head=new o.Buf16(_e.hash_size),_e.prev=new o.Buf16(_e.w_size),_e.lit_bufsize=1<<ee+6,_e.pending_buf_size=4*_e.lit_bufsize,_e.pending_buf=new o.Buf8(_e.pending_buf_size),_e.d_buf=1*_e.lit_bufsize,_e.l_buf=3*_e.lit_bufsize,_e.level=Z,_e.strategy=ae,_e.method=Ae,Se(M)}s=[new q(0,0,0,0,function(M,Z){var Ae=65535;for(Ae>M.pending_buf_size-5&&(Ae=M.pending_buf_size-5);;){if(M.lookahead<=1){if(X(M),M.lookahead===0&&Z===d)return E;if(M.lookahead===0)break}M.strstart+=M.lookahead,M.lookahead=0;var ie=M.block_start+Ae;if((M.strstart===0||M.strstart>=ie)&&(M.lookahead=M.strstart-ie,M.strstart=ie,Y(M,!1),M.strm.avail_out===0)||M.strstart-M.block_start>=M.w_size-T&&(Y(M,!1),M.strm.avail_out===0))return E}return M.insert=0,Z===A?(Y(M,!0),M.strm.avail_out===0?te:L):(M.strstart>M.block_start&&(Y(M,!1),M.strm.avail_out),E)}),new q(4,4,8,4,W),new q(4,5,16,8,W),new q(4,6,32,32,W),new q(4,4,16,16,se),new q(8,16,32,32,se),new q(8,16,128,128,se),new q(8,32,128,256,se),new q(32,128,258,1024,se),new q(32,258,258,4096,se)],r.deflateInit=function(M,Z){return fe(M,Z,m,15,8,0)},r.deflateInit2=fe,r.deflateReset=Se,r.deflateResetKeep=Ce,r.deflateSetHeader=function(M,Z){return M&&M.state?M.state.wrap!==2?p:(M.state.gzhead=Z,f):p},r.deflate=function(M,Z){var Ae,ie,ee,ae;if(!M||!M.state||5<Z||Z<0)return M?O(M,p):p;if(ie=M.state,!M.output||!M.input&&M.avail_in!==0||ie.status===666&&Z!==A)return O(M,M.avail_out===0?-5:p);if(ie.strm=M,Ae=ie.last_flush,ie.last_flush=Z,ie.status===k)if(ie.wrap===2)M.adler=0,K(ie,31),K(ie,139),K(ie,8),ie.gzhead?(K(ie,(ie.gzhead.text?1:0)+(ie.gzhead.hcrc?2:0)+(ie.gzhead.extra?4:0)+(ie.gzhead.name?8:0)+(ie.gzhead.comment?16:0)),K(ie,255&ie.gzhead.time),K(ie,ie.gzhead.time>>8&255),K(ie,ie.gzhead.time>>16&255),K(ie,ie.gzhead.time>>24&255),K(ie,ie.level===9?2:2<=ie.strategy||ie.level<2?4:0),K(ie,255&ie.gzhead.os),ie.gzhead.extra&&ie.gzhead.extra.length&&(K(ie,255&ie.gzhead.extra.length),K(ie,ie.gzhead.extra.length>>8&255)),ie.gzhead.hcrc&&(M.adler=h(M.adler,ie.pending_buf,ie.pending,0)),ie.gzindex=0,ie.status=69):(K(ie,0),K(ie,0),K(ie,0),K(ie,0),K(ie,0),K(ie,ie.level===9?2:2<=ie.strategy||ie.level<2?4:0),K(ie,3),ie.status=B);else{var me=m+(ie.w_bits-8<<4)<<8;me|=(2<=ie.strategy||ie.level<2?0:ie.level<6?1:ie.level===6?2:3)<<6,ie.strstart!==0&&(me|=32),me+=31-me%31,ie.status=B,V(ie,me),ie.strstart!==0&&(V(ie,M.adler>>>16),V(ie,65535&M.adler)),M.adler=1}if(ie.status===69)if(ie.gzhead.extra){for(ee=ie.pending;ie.gzindex<(65535&ie.gzhead.extra.length)&&(ie.pending!==ie.pending_buf_size||(ie.gzhead.hcrc&&ie.pending>ee&&(M.adler=h(M.adler,ie.pending_buf,ie.pending-ee,ee)),U(M),ee=ie.pending,ie.pending!==ie.pending_buf_size));)K(ie,255&ie.gzhead.extra[ie.gzindex]),ie.gzindex++;ie.gzhead.hcrc&&ie.pending>ee&&(M.adler=h(M.adler,ie.pending_buf,ie.pending-ee,ee)),ie.gzindex===ie.gzhead.extra.length&&(ie.gzindex=0,ie.status=73)}else ie.status=73;if(ie.status===73)if(ie.gzhead.name){ee=ie.pending;do{if(ie.pending===ie.pending_buf_size&&(ie.gzhead.hcrc&&ie.pending>ee&&(M.adler=h(M.adler,ie.pending_buf,ie.pending-ee,ee)),U(M),ee=ie.pending,ie.pending===ie.pending_buf_size)){ae=1;break}ae=ie.gzindex<ie.gzhead.name.length?255&ie.gzhead.name.charCodeAt(ie.gzindex++):0,K(ie,ae)}while(ae!==0);ie.gzhead.hcrc&&ie.pending>ee&&(M.adler=h(M.adler,ie.pending_buf,ie.pending-ee,ee)),ae===0&&(ie.gzindex=0,ie.status=91)}else ie.status=91;if(ie.status===91)if(ie.gzhead.comment){ee=ie.pending;do{if(ie.pending===ie.pending_buf_size&&(ie.gzhead.hcrc&&ie.pending>ee&&(M.adler=h(M.adler,ie.pending_buf,ie.pending-ee,ee)),U(M),ee=ie.pending,ie.pending===ie.pending_buf_size)){ae=1;break}ae=ie.gzindex<ie.gzhead.comment.length?255&ie.gzhead.comment.charCodeAt(ie.gzindex++):0,K(ie,ae)}while(ae!==0);ie.gzhead.hcrc&&ie.pending>ee&&(M.adler=h(M.adler,ie.pending_buf,ie.pending-ee,ee)),ae===0&&(ie.status=103)}else ie.status=103;if(ie.status===103&&(ie.gzhead.hcrc?(ie.pending+2>ie.pending_buf_size&&U(M),ie.pending+2<=ie.pending_buf_size&&(K(ie,255&M.adler),K(ie,M.adler>>8&255),M.adler=0,ie.status=B)):ie.status=B),ie.pending!==0){if(U(M),M.avail_out===0)return ie.last_flush=-1,f}else if(M.avail_in===0&&J(Z)<=J(Ae)&&Z!==A)return O(M,-5);if(ie.status===666&&M.avail_in!==0)return O(M,-5);if(M.avail_in!==0||ie.lookahead!==0||Z!==d&&ie.status!==666){var _e=ie.strategy===2?(function(ue,Be){for(var it;;){if(ue.lookahead===0&&(X(ue),ue.lookahead===0)){if(Be===d)return E;break}if(ue.match_length=0,it=a._tr_tally(ue,0,ue.window[ue.strstart]),ue.lookahead--,ue.strstart++,it&&(Y(ue,!1),ue.strm.avail_out===0))return E}return ue.insert=0,Be===A?(Y(ue,!0),ue.strm.avail_out===0?te:L):ue.last_lit&&(Y(ue,!1),ue.strm.avail_out===0)?E:z})(ie,Z):ie.strategy===3?(function(ue,Be){for(var it,De,qe,Je,Me=ue.window;;){if(ue.lookahead<=D){if(X(ue),ue.lookahead<=D&&Be===d)return E;if(ue.lookahead===0)break}if(ue.match_length=0,ue.lookahead>=b&&0<ue.strstart&&(De=Me[qe=ue.strstart-1])===Me[++qe]&&De===Me[++qe]&&De===Me[++qe]){Je=ue.strstart+D;do;while(De===Me[++qe]&&De===Me[++qe]&&De===Me[++qe]&&De===Me[++qe]&&De===Me[++qe]&&De===Me[++qe]&&De===Me[++qe]&&De===Me[++qe]&&qe<Je);ue.match_length=D-(Je-qe),ue.match_length>ue.lookahead&&(ue.match_length=ue.lookahead)}if(ue.match_length>=b?(it=a._tr_tally(ue,1,ue.match_length-b),ue.lookahead-=ue.match_length,ue.strstart+=ue.match_length,ue.match_length=0):(it=a._tr_tally(ue,0,ue.window[ue.strstart]),ue.lookahead--,ue.strstart++),it&&(Y(ue,!1),ue.strm.avail_out===0))return E}return ue.insert=0,Be===A?(Y(ue,!0),ue.strm.avail_out===0?te:L):ue.last_lit&&(Y(ue,!1),ue.strm.avail_out===0)?E:z})(ie,Z):s[ie.level].func(ie,Z);if(_e!==te&&_e!==L||(ie.status=666),_e===E||_e===te)return M.avail_out===0&&(ie.last_flush=-1),f;if(_e===z&&(Z===1?a._tr_align(ie):Z!==5&&(a._tr_stored_block(ie,0,0,!1),Z===3&&($(ie.head),ie.lookahead===0&&(ie.strstart=0,ie.block_start=0,ie.insert=0))),U(M),M.avail_out===0))return ie.last_flush=-1,f}return Z!==A?f:ie.wrap<=0?1:(ie.wrap===2?(K(ie,255&M.adler),K(ie,M.adler>>8&255),K(ie,M.adler>>16&255),K(ie,M.adler>>24&255),K(ie,255&M.total_in),K(ie,M.total_in>>8&255),K(ie,M.total_in>>16&255),K(ie,M.total_in>>24&255)):(V(ie,M.adler>>>16),V(ie,65535&M.adler)),U(M),0<ie.wrap&&(ie.wrap=-ie.wrap),ie.pending!==0?f:1)},r.deflateEnd=function(M){var Z;return M&&M.state?(Z=M.state.status)!==k&&Z!==69&&Z!==73&&Z!==91&&Z!==103&&Z!==B&&Z!==666?O(M,p):(M.state=null,Z===B?O(M,-3):f):p},r.deflateSetDictionary=function(M,Z){var Ae,ie,ee,ae,me,_e,ue,Be,it=Z.length;if(!M||!M.state||(ae=(Ae=M.state).wrap)===2||ae===1&&Ae.status!==k||Ae.lookahead)return p;for(ae===1&&(M.adler=l(M.adler,Z,it,0)),Ae.wrap=0,it>=Ae.w_size&&(ae===0&&($(Ae.head),Ae.strstart=0,Ae.block_start=0,Ae.insert=0),Be=new o.Buf8(Ae.w_size),o.arraySet(Be,Z,it-Ae.w_size,Ae.w_size,0),Z=Be,it=Ae.w_size),me=M.avail_in,_e=M.next_in,ue=M.input,M.avail_in=it,M.next_in=0,M.input=Z,X(Ae);Ae.lookahead>=b;){for(ie=Ae.strstart,ee=Ae.lookahead-(b-1);Ae.ins_h=(Ae.ins_h<<Ae.hash_shift^Ae.window[ie+b-1])&Ae.hash_mask,Ae.prev[ie&Ae.w_mask]=Ae.head[Ae.ins_h],Ae.head[Ae.ins_h]=ie,ie++,--ee;);Ae.strstart=ie,Ae.lookahead=b-1,X(Ae)}return Ae.strstart+=Ae.lookahead,Ae.block_start=Ae.strstart,Ae.insert=Ae.lookahead,Ae.lookahead=0,Ae.match_length=Ae.prev_length=b-1,Ae.match_available=0,M.next_in=_e,M.input=ue,M.avail_in=me,Ae.wrap=ae,f},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,i,r){i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,i,r){i.exports=function(s,o){var a,l,h,u,d,A,f,p,g,v,w,m,y,x,S,I,j,C,b,D,T,k,B,E,z;a=s.state,l=s.next_in,E=s.input,h=l+(s.avail_in-5),u=s.next_out,z=s.output,d=u-(o-s.avail_out),A=u+(s.avail_out-257),f=a.dmax,p=a.wsize,g=a.whave,v=a.wnext,w=a.window,m=a.hold,y=a.bits,x=a.lencode,S=a.distcode,I=(1<<a.lenbits)-1,j=(1<<a.distbits)-1;e:do{y<15&&(m+=E[l++]<<y,y+=8,m+=E[l++]<<y,y+=8),C=x[m&I];t:for(;;){if(m>>>=b=C>>>24,y-=b,(b=C>>>16&255)===0)z[u++]=65535&C;else{if(!(16&b)){if((64&b)==0){C=x[(65535&C)+(m&(1<<b)-1)];continue t}if(32&b){a.mode=12;break e}s.msg="invalid literal/length code",a.mode=30;break e}D=65535&C,(b&=15)&&(y<b&&(m+=E[l++]<<y,y+=8),D+=m&(1<<b)-1,m>>>=b,y-=b),y<15&&(m+=E[l++]<<y,y+=8,m+=E[l++]<<y,y+=8),C=S[m&j];n:for(;;){if(m>>>=b=C>>>24,y-=b,!(16&(b=C>>>16&255))){if((64&b)==0){C=S[(65535&C)+(m&(1<<b)-1)];continue n}s.msg="invalid distance code",a.mode=30;break e}if(T=65535&C,y<(b&=15)&&(m+=E[l++]<<y,(y+=8)<b&&(m+=E[l++]<<y,y+=8)),f<(T+=m&(1<<b)-1)){s.msg="invalid distance too far back",a.mode=30;break e}if(m>>>=b,y-=b,(b=u-d)<T){if(g<(b=T-b)&&a.sane){s.msg="invalid distance too far back",a.mode=30;break e}if(B=w,(k=0)===v){if(k+=p-b,b<D){for(D-=b;z[u++]=w[k++],--b;);k=u-T,B=z}}else if(v<b){if(k+=p+v-b,(b-=v)<D){for(D-=b;z[u++]=w[k++],--b;);if(k=0,v<D){for(D-=b=v;z[u++]=w[k++],--b;);k=u-T,B=z}}}else if(k+=v-b,b<D){for(D-=b;z[u++]=w[k++],--b;);k=u-T,B=z}for(;2<D;)z[u++]=B[k++],z[u++]=B[k++],z[u++]=B[k++],D-=3;D&&(z[u++]=B[k++],1<D&&(z[u++]=B[k++]))}else{for(k=u-T;z[u++]=z[k++],z[u++]=z[k++],z[u++]=z[k++],2<(D-=3););D&&(z[u++]=z[k++],1<D&&(z[u++]=z[k++]))}break}}break}}while(l<h&&u<A);l-=D=y>>3,m&=(1<<(y-=D<<3))-1,s.next_in=l,s.next_out=u,s.avail_in=l<h?h-l+5:5-(l-h),s.avail_out=u<A?A-u+257:257-(u-A),a.hold=m,a.bits=y}},{}],49:[function(t,i,r){var s=t("../utils/common"),o=t("./adler32"),a=t("./crc32"),l=t("./inffast"),h=t("./inftrees"),u=1,d=2,A=0,f=-2,p=1,g=852,v=592;function w(k){return(k>>>24&255)+(k>>>8&65280)+((65280&k)<<8)+((255&k)<<24)}function m(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function y(k){var B;return k&&k.state?(B=k.state,k.total_in=k.total_out=B.total=0,k.msg="",B.wrap&&(k.adler=1&B.wrap),B.mode=p,B.last=0,B.havedict=0,B.dmax=32768,B.head=null,B.hold=0,B.bits=0,B.lencode=B.lendyn=new s.Buf32(g),B.distcode=B.distdyn=new s.Buf32(v),B.sane=1,B.back=-1,A):f}function x(k){var B;return k&&k.state?((B=k.state).wsize=0,B.whave=0,B.wnext=0,y(k)):f}function S(k,B){var E,z;return k&&k.state?(z=k.state,B<0?(E=0,B=-B):(E=1+(B>>4),B<48&&(B&=15)),B&&(B<8||15<B)?f:(z.window!==null&&z.wbits!==B&&(z.window=null),z.wrap=E,z.wbits=B,x(k))):f}function I(k,B){var E,z;return k?(z=new m,(k.state=z).window=null,(E=S(k,B))!==A&&(k.state=null),E):f}var j,C,b=!0;function D(k){if(b){var B;for(j=new s.Buf32(512),C=new s.Buf32(32),B=0;B<144;)k.lens[B++]=8;for(;B<256;)k.lens[B++]=9;for(;B<280;)k.lens[B++]=7;for(;B<288;)k.lens[B++]=8;for(h(u,k.lens,0,288,j,0,k.work,{bits:9}),B=0;B<32;)k.lens[B++]=5;h(d,k.lens,0,32,C,0,k.work,{bits:5}),b=!1}k.lencode=j,k.lenbits=9,k.distcode=C,k.distbits=5}function T(k,B,E,z){var te,L=k.state;return L.window===null&&(L.wsize=1<<L.wbits,L.wnext=0,L.whave=0,L.window=new s.Buf8(L.wsize)),z>=L.wsize?(s.arraySet(L.window,B,E-L.wsize,L.wsize,0),L.wnext=0,L.whave=L.wsize):(z<(te=L.wsize-L.wnext)&&(te=z),s.arraySet(L.window,B,E-z,te,L.wnext),(z-=te)?(s.arraySet(L.window,B,E-z,z,0),L.wnext=z,L.whave=L.wsize):(L.wnext+=te,L.wnext===L.wsize&&(L.wnext=0),L.whave<L.wsize&&(L.whave+=te))),0}r.inflateReset=x,r.inflateReset2=S,r.inflateResetKeep=y,r.inflateInit=function(k){return I(k,15)},r.inflateInit2=I,r.inflate=function(k,B){var E,z,te,L,O,J,$,U,Y,K,V,Q,X,W,se,q,de,Ce,Se,fe,M,Z,Ae,ie,ee=0,ae=new s.Buf8(4),me=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!k||!k.state||!k.output||!k.input&&k.avail_in!==0)return f;(E=k.state).mode===12&&(E.mode=13),O=k.next_out,te=k.output,$=k.avail_out,L=k.next_in,z=k.input,J=k.avail_in,U=E.hold,Y=E.bits,K=J,V=$,Z=A;e:for(;;)switch(E.mode){case p:if(E.wrap===0){E.mode=13;break}for(;Y<16;){if(J===0)break e;J--,U+=z[L++]<<Y,Y+=8}if(2&E.wrap&&U===35615){ae[E.check=0]=255&U,ae[1]=U>>>8&255,E.check=a(E.check,ae,2,0),Y=U=0,E.mode=2;break}if(E.flags=0,E.head&&(E.head.done=!1),!(1&E.wrap)||(((255&U)<<8)+(U>>8))%31){k.msg="incorrect header check",E.mode=30;break}if((15&U)!=8){k.msg="unknown compression method",E.mode=30;break}if(Y-=4,M=8+(15&(U>>>=4)),E.wbits===0)E.wbits=M;else if(M>E.wbits){k.msg="invalid window size",E.mode=30;break}E.dmax=1<<M,k.adler=E.check=1,E.mode=512&U?10:12,Y=U=0;break;case 2:for(;Y<16;){if(J===0)break e;J--,U+=z[L++]<<Y,Y+=8}if(E.flags=U,(255&E.flags)!=8){k.msg="unknown compression method",E.mode=30;break}if(57344&E.flags){k.msg="unknown header flags set",E.mode=30;break}E.head&&(E.head.text=U>>8&1),512&E.flags&&(ae[0]=255&U,ae[1]=U>>>8&255,E.check=a(E.check,ae,2,0)),Y=U=0,E.mode=3;case 3:for(;Y<32;){if(J===0)break e;J--,U+=z[L++]<<Y,Y+=8}E.head&&(E.head.time=U),512&E.flags&&(ae[0]=255&U,ae[1]=U>>>8&255,ae[2]=U>>>16&255,ae[3]=U>>>24&255,E.check=a(E.check,ae,4,0)),Y=U=0,E.mode=4;case 4:for(;Y<16;){if(J===0)break e;J--,U+=z[L++]<<Y,Y+=8}E.head&&(E.head.xflags=255&U,E.head.os=U>>8),512&E.flags&&(ae[0]=255&U,ae[1]=U>>>8&255,E.check=a(E.check,ae,2,0)),Y=U=0,E.mode=5;case 5:if(1024&E.flags){for(;Y<16;){if(J===0)break e;J--,U+=z[L++]<<Y,Y+=8}E.length=U,E.head&&(E.head.extra_len=U),512&E.flags&&(ae[0]=255&U,ae[1]=U>>>8&255,E.check=a(E.check,ae,2,0)),Y=U=0}else E.head&&(E.head.extra=null);E.mode=6;case 6:if(1024&E.flags&&(J<(Q=E.length)&&(Q=J),Q&&(E.head&&(M=E.head.extra_len-E.length,E.head.extra||(E.head.extra=new Array(E.head.extra_len)),s.arraySet(E.head.extra,z,L,Q,M)),512&E.flags&&(E.check=a(E.check,z,Q,L)),J-=Q,L+=Q,E.length-=Q),E.length))break e;E.length=0,E.mode=7;case 7:if(2048&E.flags){if(J===0)break e;for(Q=0;M=z[L+Q++],E.head&&M&&E.length<65536&&(E.head.name+=String.fromCharCode(M)),M&&Q<J;);if(512&E.flags&&(E.check=a(E.check,z,Q,L)),J-=Q,L+=Q,M)break e}else E.head&&(E.head.name=null);E.length=0,E.mode=8;case 8:if(4096&E.flags){if(J===0)break e;for(Q=0;M=z[L+Q++],E.head&&M&&E.length<65536&&(E.head.comment+=String.fromCharCode(M)),M&&Q<J;);if(512&E.flags&&(E.check=a(E.check,z,Q,L)),J-=Q,L+=Q,M)break e}else E.head&&(E.head.comment=null);E.mode=9;case 9:if(512&E.flags){for(;Y<16;){if(J===0)break e;J--,U+=z[L++]<<Y,Y+=8}if(U!==(65535&E.check)){k.msg="header crc mismatch",E.mode=30;break}Y=U=0}E.head&&(E.head.hcrc=E.flags>>9&1,E.head.done=!0),k.adler=E.check=0,E.mode=12;break;case 10:for(;Y<32;){if(J===0)break e;J--,U+=z[L++]<<Y,Y+=8}k.adler=E.check=w(U),Y=U=0,E.mode=11;case 11:if(E.havedict===0)return k.next_out=O,k.avail_out=$,k.next_in=L,k.avail_in=J,E.hold=U,E.bits=Y,2;k.adler=E.check=1,E.mode=12;case 12:if(B===5||B===6)break e;case 13:if(E.last){U>>>=7&Y,Y-=7&Y,E.mode=27;break}for(;Y<3;){if(J===0)break e;J--,U+=z[L++]<<Y,Y+=8}switch(E.last=1&U,Y-=1,3&(U>>>=1)){case 0:E.mode=14;break;case 1:if(D(E),E.mode=20,B!==6)break;U>>>=2,Y-=2;break e;case 2:E.mode=17;break;case 3:k.msg="invalid block type",E.mode=30}U>>>=2,Y-=2;break;case 14:for(U>>>=7&Y,Y-=7&Y;Y<32;){if(J===0)break e;J--,U+=z[L++]<<Y,Y+=8}if((65535&U)!=(U>>>16^65535)){k.msg="invalid stored block lengths",E.mode=30;break}if(E.length=65535&U,Y=U=0,E.mode=15,B===6)break e;case 15:E.mode=16;case 16:if(Q=E.length){if(J<Q&&(Q=J),$<Q&&(Q=$),Q===0)break e;s.arraySet(te,z,L,Q,O),J-=Q,L+=Q,$-=Q,O+=Q,E.length-=Q;break}E.mode=12;break;case 17:for(;Y<14;){if(J===0)break e;J--,U+=z[L++]<<Y,Y+=8}if(E.nlen=257+(31&U),U>>>=5,Y-=5,E.ndist=1+(31&U),U>>>=5,Y-=5,E.ncode=4+(15&U),U>>>=4,Y-=4,286<E.nlen||30<E.ndist){k.msg="too many length or distance symbols",E.mode=30;break}E.have=0,E.mode=18;case 18:for(;E.have<E.ncode;){for(;Y<3;){if(J===0)break e;J--,U+=z[L++]<<Y,Y+=8}E.lens[me[E.have++]]=7&U,U>>>=3,Y-=3}for(;E.have<19;)E.lens[me[E.have++]]=0;if(E.lencode=E.lendyn,E.lenbits=7,Ae={bits:E.lenbits},Z=h(0,E.lens,0,19,E.lencode,0,E.work,Ae),E.lenbits=Ae.bits,Z){k.msg="invalid code lengths set",E.mode=30;break}E.have=0,E.mode=19;case 19:for(;E.have<E.nlen+E.ndist;){for(;q=(ee=E.lencode[U&(1<<E.lenbits)-1])>>>16&255,de=65535&ee,!((se=ee>>>24)<=Y);){if(J===0)break e;J--,U+=z[L++]<<Y,Y+=8}if(de<16)U>>>=se,Y-=se,E.lens[E.have++]=de;else{if(de===16){for(ie=se+2;Y<ie;){if(J===0)break e;J--,U+=z[L++]<<Y,Y+=8}if(U>>>=se,Y-=se,E.have===0){k.msg="invalid bit length repeat",E.mode=30;break}M=E.lens[E.have-1],Q=3+(3&U),U>>>=2,Y-=2}else if(de===17){for(ie=se+3;Y<ie;){if(J===0)break e;J--,U+=z[L++]<<Y,Y+=8}Y-=se,M=0,Q=3+(7&(U>>>=se)),U>>>=3,Y-=3}else{for(ie=se+7;Y<ie;){if(J===0)break e;J--,U+=z[L++]<<Y,Y+=8}Y-=se,M=0,Q=11+(127&(U>>>=se)),U>>>=7,Y-=7}if(E.have+Q>E.nlen+E.ndist){k.msg="invalid bit length repeat",E.mode=30;break}for(;Q--;)E.lens[E.have++]=M}}if(E.mode===30)break;if(E.lens[256]===0){k.msg="invalid code -- missing end-of-block",E.mode=30;break}if(E.lenbits=9,Ae={bits:E.lenbits},Z=h(u,E.lens,0,E.nlen,E.lencode,0,E.work,Ae),E.lenbits=Ae.bits,Z){k.msg="invalid literal/lengths set",E.mode=30;break}if(E.distbits=6,E.distcode=E.distdyn,Ae={bits:E.distbits},Z=h(d,E.lens,E.nlen,E.ndist,E.distcode,0,E.work,Ae),E.distbits=Ae.bits,Z){k.msg="invalid distances set",E.mode=30;break}if(E.mode=20,B===6)break e;case 20:E.mode=21;case 21:if(6<=J&&258<=$){k.next_out=O,k.avail_out=$,k.next_in=L,k.avail_in=J,E.hold=U,E.bits=Y,l(k,V),O=k.next_out,te=k.output,$=k.avail_out,L=k.next_in,z=k.input,J=k.avail_in,U=E.hold,Y=E.bits,E.mode===12&&(E.back=-1);break}for(E.back=0;q=(ee=E.lencode[U&(1<<E.lenbits)-1])>>>16&255,de=65535&ee,!((se=ee>>>24)<=Y);){if(J===0)break e;J--,U+=z[L++]<<Y,Y+=8}if(q&&(240&q)==0){for(Ce=se,Se=q,fe=de;q=(ee=E.lencode[fe+((U&(1<<Ce+Se)-1)>>Ce)])>>>16&255,de=65535&ee,!(Ce+(se=ee>>>24)<=Y);){if(J===0)break e;J--,U+=z[L++]<<Y,Y+=8}U>>>=Ce,Y-=Ce,E.back+=Ce}if(U>>>=se,Y-=se,E.back+=se,E.length=de,q===0){E.mode=26;break}if(32&q){E.back=-1,E.mode=12;break}if(64&q){k.msg="invalid literal/length code",E.mode=30;break}E.extra=15&q,E.mode=22;case 22:if(E.extra){for(ie=E.extra;Y<ie;){if(J===0)break e;J--,U+=z[L++]<<Y,Y+=8}E.length+=U&(1<<E.extra)-1,U>>>=E.extra,Y-=E.extra,E.back+=E.extra}E.was=E.length,E.mode=23;case 23:for(;q=(ee=E.distcode[U&(1<<E.distbits)-1])>>>16&255,de=65535&ee,!((se=ee>>>24)<=Y);){if(J===0)break e;J--,U+=z[L++]<<Y,Y+=8}if((240&q)==0){for(Ce=se,Se=q,fe=de;q=(ee=E.distcode[fe+((U&(1<<Ce+Se)-1)>>Ce)])>>>16&255,de=65535&ee,!(Ce+(se=ee>>>24)<=Y);){if(J===0)break e;J--,U+=z[L++]<<Y,Y+=8}U>>>=Ce,Y-=Ce,E.back+=Ce}if(U>>>=se,Y-=se,E.back+=se,64&q){k.msg="invalid distance code",E.mode=30;break}E.offset=de,E.extra=15&q,E.mode=24;case 24:if(E.extra){for(ie=E.extra;Y<ie;){if(J===0)break e;J--,U+=z[L++]<<Y,Y+=8}E.offset+=U&(1<<E.extra)-1,U>>>=E.extra,Y-=E.extra,E.back+=E.extra}if(E.offset>E.dmax){k.msg="invalid distance too far back",E.mode=30;break}E.mode=25;case 25:if($===0)break e;if(Q=V-$,E.offset>Q){if((Q=E.offset-Q)>E.whave&&E.sane){k.msg="invalid distance too far back",E.mode=30;break}X=Q>E.wnext?(Q-=E.wnext,E.wsize-Q):E.wnext-Q,Q>E.length&&(Q=E.length),W=E.window}else W=te,X=O-E.offset,Q=E.length;for($<Q&&(Q=$),$-=Q,E.length-=Q;te[O++]=W[X++],--Q;);E.length===0&&(E.mode=21);break;case 26:if($===0)break e;te[O++]=E.length,$--,E.mode=21;break;case 27:if(E.wrap){for(;Y<32;){if(J===0)break e;J--,U|=z[L++]<<Y,Y+=8}if(V-=$,k.total_out+=V,E.total+=V,V&&(k.adler=E.check=E.flags?a(E.check,te,V,O-V):o(E.check,te,V,O-V)),V=$,(E.flags?U:w(U))!==E.check){k.msg="incorrect data check",E.mode=30;break}Y=U=0}E.mode=28;case 28:if(E.wrap&&E.flags){for(;Y<32;){if(J===0)break e;J--,U+=z[L++]<<Y,Y+=8}if(U!==(4294967295&E.total)){k.msg="incorrect length check",E.mode=30;break}Y=U=0}E.mode=29;case 29:Z=1;break e;case 30:Z=-3;break e;case 31:return-4;case 32:default:return f}return k.next_out=O,k.avail_out=$,k.next_in=L,k.avail_in=J,E.hold=U,E.bits=Y,(E.wsize||V!==k.avail_out&&E.mode<30&&(E.mode<27||B!==4))&&T(k,k.output,k.next_out,V-k.avail_out)?(E.mode=31,-4):(K-=k.avail_in,V-=k.avail_out,k.total_in+=K,k.total_out+=V,E.total+=V,E.wrap&&V&&(k.adler=E.check=E.flags?a(E.check,te,V,k.next_out-V):o(E.check,te,V,k.next_out-V)),k.data_type=E.bits+(E.last?64:0)+(E.mode===12?128:0)+(E.mode===20||E.mode===15?256:0),(K==0&&V===0||B===4)&&Z===A&&(Z=-5),Z)},r.inflateEnd=function(k){if(!k||!k.state)return f;var B=k.state;return B.window&&(B.window=null),k.state=null,A},r.inflateGetHeader=function(k,B){var E;return k&&k.state?(2&(E=k.state).wrap)==0?f:((E.head=B).done=!1,A):f},r.inflateSetDictionary=function(k,B){var E,z=B.length;return k&&k.state?(E=k.state).wrap!==0&&E.mode!==11?f:E.mode===11&&o(1,B,z,0)!==E.check?-3:T(k,B,z,z)?(E.mode=31,-4):(E.havedict=1,A):f},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,i,r){var s=t("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],h=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(u,d,A,f,p,g,v,w){var m,y,x,S,I,j,C,b,D,T=w.bits,k=0,B=0,E=0,z=0,te=0,L=0,O=0,J=0,$=0,U=0,Y=null,K=0,V=new s.Buf16(16),Q=new s.Buf16(16),X=null,W=0;for(k=0;k<=15;k++)V[k]=0;for(B=0;B<f;B++)V[d[A+B]]++;for(te=T,z=15;1<=z&&V[z]===0;z--);if(z<te&&(te=z),z===0)return p[g++]=20971520,p[g++]=20971520,w.bits=1,0;for(E=1;E<z&&V[E]===0;E++);for(te<E&&(te=E),k=J=1;k<=15;k++)if(J<<=1,(J-=V[k])<0)return-1;if(0<J&&(u===0||z!==1))return-1;for(Q[1]=0,k=1;k<15;k++)Q[k+1]=Q[k]+V[k];for(B=0;B<f;B++)d[A+B]!==0&&(v[Q[d[A+B]]++]=B);if(j=u===0?(Y=X=v,19):u===1?(Y=o,K-=257,X=a,W-=257,256):(Y=l,X=h,-1),k=E,I=g,O=B=U=0,x=-1,S=($=1<<(L=te))-1,u===1&&852<$||u===2&&592<$)return 1;for(;;){for(C=k-O,D=v[B]<j?(b=0,v[B]):v[B]>j?(b=X[W+v[B]],Y[K+v[B]]):(b=96,0),m=1<<k-O,E=y=1<<L;p[I+(U>>O)+(y-=m)]=C<<24|b<<16|D|0,y!==0;);for(m=1<<k-1;U&m;)m>>=1;if(m!==0?(U&=m-1,U+=m):U=0,B++,--V[k]==0){if(k===z)break;k=d[A+v[B]]}if(te<k&&(U&S)!==x){for(O===0&&(O=te),I+=E,J=1<<(L=k-O);L+O<z&&!((J-=V[L+O])<=0);)L++,J<<=1;if($+=1<<L,u===1&&852<$||u===2&&592<$)return 1;p[x=U&S]=te<<24|L<<16|I-g|0}}return U!==0&&(p[I+U]=k-O<<24|64<<16|0),w.bits=te,0}},{"../utils/common":41}],51:[function(t,i,r){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,i,r){var s=t("../utils/common"),o=0,a=1;function l(ee){for(var ae=ee.length;0<=--ae;)ee[ae]=0}var h=0,u=29,d=256,A=d+1+u,f=30,p=19,g=2*A+1,v=15,w=16,m=7,y=256,x=16,S=17,I=18,j=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],C=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],b=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],T=new Array(2*(A+2));l(T);var k=new Array(2*f);l(k);var B=new Array(512);l(B);var E=new Array(256);l(E);var z=new Array(u);l(z);var te,L,O,J=new Array(f);function $(ee,ae,me,_e,ue){this.static_tree=ee,this.extra_bits=ae,this.extra_base=me,this.elems=_e,this.max_length=ue,this.has_stree=ee&&ee.length}function U(ee,ae){this.dyn_tree=ee,this.max_code=0,this.stat_desc=ae}function Y(ee){return ee<256?B[ee]:B[256+(ee>>>7)]}function K(ee,ae){ee.pending_buf[ee.pending++]=255&ae,ee.pending_buf[ee.pending++]=ae>>>8&255}function V(ee,ae,me){ee.bi_valid>w-me?(ee.bi_buf|=ae<<ee.bi_valid&65535,K(ee,ee.bi_buf),ee.bi_buf=ae>>w-ee.bi_valid,ee.bi_valid+=me-w):(ee.bi_buf|=ae<<ee.bi_valid&65535,ee.bi_valid+=me)}function Q(ee,ae,me){V(ee,me[2*ae],me[2*ae+1])}function X(ee,ae){for(var me=0;me|=1&ee,ee>>>=1,me<<=1,0<--ae;);return me>>>1}function W(ee,ae,me){var _e,ue,Be=new Array(v+1),it=0;for(_e=1;_e<=v;_e++)Be[_e]=it=it+me[_e-1]<<1;for(ue=0;ue<=ae;ue++){var De=ee[2*ue+1];De!==0&&(ee[2*ue]=X(Be[De]++,De))}}function se(ee){var ae;for(ae=0;ae<A;ae++)ee.dyn_ltree[2*ae]=0;for(ae=0;ae<f;ae++)ee.dyn_dtree[2*ae]=0;for(ae=0;ae<p;ae++)ee.bl_tree[2*ae]=0;ee.dyn_ltree[2*y]=1,ee.opt_len=ee.static_len=0,ee.last_lit=ee.matches=0}function q(ee){8<ee.bi_valid?K(ee,ee.bi_buf):0<ee.bi_valid&&(ee.pending_buf[ee.pending++]=ee.bi_buf),ee.bi_buf=0,ee.bi_valid=0}function de(ee,ae,me,_e){var ue=2*ae,Be=2*me;return ee[ue]<ee[Be]||ee[ue]===ee[Be]&&_e[ae]<=_e[me]}function Ce(ee,ae,me){for(var _e=ee.heap[me],ue=me<<1;ue<=ee.heap_len&&(ue<ee.heap_len&&de(ae,ee.heap[ue+1],ee.heap[ue],ee.depth)&&ue++,!de(ae,_e,ee.heap[ue],ee.depth));)ee.heap[me]=ee.heap[ue],me=ue,ue<<=1;ee.heap[me]=_e}function Se(ee,ae,me){var _e,ue,Be,it,De=0;if(ee.last_lit!==0)for(;_e=ee.pending_buf[ee.d_buf+2*De]<<8|ee.pending_buf[ee.d_buf+2*De+1],ue=ee.pending_buf[ee.l_buf+De],De++,_e===0?Q(ee,ue,ae):(Q(ee,(Be=E[ue])+d+1,ae),(it=j[Be])!==0&&V(ee,ue-=z[Be],it),Q(ee,Be=Y(--_e),me),(it=C[Be])!==0&&V(ee,_e-=J[Be],it)),De<ee.last_lit;);Q(ee,y,ae)}function fe(ee,ae){var me,_e,ue,Be=ae.dyn_tree,it=ae.stat_desc.static_tree,De=ae.stat_desc.has_stree,qe=ae.stat_desc.elems,Je=-1;for(ee.heap_len=0,ee.heap_max=g,me=0;me<qe;me++)Be[2*me]!==0?(ee.heap[++ee.heap_len]=Je=me,ee.depth[me]=0):Be[2*me+1]=0;for(;ee.heap_len<2;)Be[2*(ue=ee.heap[++ee.heap_len]=Je<2?++Je:0)]=1,ee.depth[ue]=0,ee.opt_len--,De&&(ee.static_len-=it[2*ue+1]);for(ae.max_code=Je,me=ee.heap_len>>1;1<=me;me--)Ce(ee,Be,me);for(ue=qe;me=ee.heap[1],ee.heap[1]=ee.heap[ee.heap_len--],Ce(ee,Be,1),_e=ee.heap[1],ee.heap[--ee.heap_max]=me,ee.heap[--ee.heap_max]=_e,Be[2*ue]=Be[2*me]+Be[2*_e],ee.depth[ue]=(ee.depth[me]>=ee.depth[_e]?ee.depth[me]:ee.depth[_e])+1,Be[2*me+1]=Be[2*_e+1]=ue,ee.heap[1]=ue++,Ce(ee,Be,1),2<=ee.heap_len;);ee.heap[--ee.heap_max]=ee.heap[1],(function(Me,et){var He,ze,Oe,ke,je,rt,_t=et.dyn_tree,Ee=et.max_code,Le=et.stat_desc.static_tree,ye=et.stat_desc.has_stree,Ze=et.stat_desc.extra_bits,nt=et.stat_desc.extra_base,st=et.stat_desc.max_length,At=0;for(ke=0;ke<=v;ke++)Me.bl_count[ke]=0;for(_t[2*Me.heap[Me.heap_max]+1]=0,He=Me.heap_max+1;He<g;He++)st<(ke=_t[2*_t[2*(ze=Me.heap[He])+1]+1]+1)&&(ke=st,At++),_t[2*ze+1]=ke,Ee<ze||(Me.bl_count[ke]++,je=0,nt<=ze&&(je=Ze[ze-nt]),rt=_t[2*ze],Me.opt_len+=rt*(ke+je),ye&&(Me.static_len+=rt*(Le[2*ze+1]+je)));if(At!==0){do{for(ke=st-1;Me.bl_count[ke]===0;)ke--;Me.bl_count[ke]--,Me.bl_count[ke+1]+=2,Me.bl_count[st]--,At-=2}while(0<At);for(ke=st;ke!==0;ke--)for(ze=Me.bl_count[ke];ze!==0;)Ee<(Oe=Me.heap[--He])||(_t[2*Oe+1]!==ke&&(Me.opt_len+=(ke-_t[2*Oe+1])*_t[2*Oe],_t[2*Oe+1]=ke),ze--)}})(ee,ae),W(Be,Je,ee.bl_count)}function M(ee,ae,me){var _e,ue,Be=-1,it=ae[1],De=0,qe=7,Je=4;for(it===0&&(qe=138,Je=3),ae[2*(me+1)+1]=65535,_e=0;_e<=me;_e++)ue=it,it=ae[2*(_e+1)+1],++De<qe&&ue===it||(De<Je?ee.bl_tree[2*ue]+=De:ue!==0?(ue!==Be&&ee.bl_tree[2*ue]++,ee.bl_tree[2*x]++):De<=10?ee.bl_tree[2*S]++:ee.bl_tree[2*I]++,Be=ue,Je=(De=0)===it?(qe=138,3):ue===it?(qe=6,3):(qe=7,4))}function Z(ee,ae,me){var _e,ue,Be=-1,it=ae[1],De=0,qe=7,Je=4;for(it===0&&(qe=138,Je=3),_e=0;_e<=me;_e++)if(ue=it,it=ae[2*(_e+1)+1],!(++De<qe&&ue===it)){if(De<Je)for(;Q(ee,ue,ee.bl_tree),--De!=0;);else ue!==0?(ue!==Be&&(Q(ee,ue,ee.bl_tree),De--),Q(ee,x,ee.bl_tree),V(ee,De-3,2)):De<=10?(Q(ee,S,ee.bl_tree),V(ee,De-3,3)):(Q(ee,I,ee.bl_tree),V(ee,De-11,7));Be=ue,Je=(De=0)===it?(qe=138,3):ue===it?(qe=6,3):(qe=7,4)}}l(J);var Ae=!1;function ie(ee,ae,me,_e){V(ee,(h<<1)+(_e?1:0),3),(function(ue,Be,it,De){q(ue),K(ue,it),K(ue,~it),s.arraySet(ue.pending_buf,ue.window,Be,it,ue.pending),ue.pending+=it})(ee,ae,me)}r._tr_init=function(ee){Ae||((function(){var ae,me,_e,ue,Be,it=new Array(v+1);for(ue=_e=0;ue<u-1;ue++)for(z[ue]=_e,ae=0;ae<1<<j[ue];ae++)E[_e++]=ue;for(E[_e-1]=ue,ue=Be=0;ue<16;ue++)for(J[ue]=Be,ae=0;ae<1<<C[ue];ae++)B[Be++]=ue;for(Be>>=7;ue<f;ue++)for(J[ue]=Be<<7,ae=0;ae<1<<C[ue]-7;ae++)B[256+Be++]=ue;for(me=0;me<=v;me++)it[me]=0;for(ae=0;ae<=143;)T[2*ae+1]=8,ae++,it[8]++;for(;ae<=255;)T[2*ae+1]=9,ae++,it[9]++;for(;ae<=279;)T[2*ae+1]=7,ae++,it[7]++;for(;ae<=287;)T[2*ae+1]=8,ae++,it[8]++;for(W(T,A+1,it),ae=0;ae<f;ae++)k[2*ae+1]=5,k[2*ae]=X(ae,5);te=new $(T,j,d+1,A,v),L=new $(k,C,0,f,v),O=new $(new Array(0),b,0,p,m)})(),Ae=!0),ee.l_desc=new U(ee.dyn_ltree,te),ee.d_desc=new U(ee.dyn_dtree,L),ee.bl_desc=new U(ee.bl_tree,O),ee.bi_buf=0,ee.bi_valid=0,se(ee)},r._tr_stored_block=ie,r._tr_flush_block=function(ee,ae,me,_e){var ue,Be,it=0;0<ee.level?(ee.strm.data_type===2&&(ee.strm.data_type=(function(De){var qe,Je=4093624447;for(qe=0;qe<=31;qe++,Je>>>=1)if(1&Je&&De.dyn_ltree[2*qe]!==0)return o;if(De.dyn_ltree[18]!==0||De.dyn_ltree[20]!==0||De.dyn_ltree[26]!==0)return a;for(qe=32;qe<d;qe++)if(De.dyn_ltree[2*qe]!==0)return a;return o})(ee)),fe(ee,ee.l_desc),fe(ee,ee.d_desc),it=(function(De){var qe;for(M(De,De.dyn_ltree,De.l_desc.max_code),M(De,De.dyn_dtree,De.d_desc.max_code),fe(De,De.bl_desc),qe=p-1;3<=qe&&De.bl_tree[2*D[qe]+1]===0;qe--);return De.opt_len+=3*(qe+1)+5+5+4,qe})(ee),ue=ee.opt_len+3+7>>>3,(Be=ee.static_len+3+7>>>3)<=ue&&(ue=Be)):ue=Be=me+5,me+4<=ue&&ae!==-1?ie(ee,ae,me,_e):ee.strategy===4||Be===ue?(V(ee,2+(_e?1:0),3),Se(ee,T,k)):(V(ee,4+(_e?1:0),3),(function(De,qe,Je,Me){var et;for(V(De,qe-257,5),V(De,Je-1,5),V(De,Me-4,4),et=0;et<Me;et++)V(De,De.bl_tree[2*D[et]+1],3);Z(De,De.dyn_ltree,qe-1),Z(De,De.dyn_dtree,Je-1)})(ee,ee.l_desc.max_code+1,ee.d_desc.max_code+1,it+1),Se(ee,ee.dyn_ltree,ee.dyn_dtree)),se(ee),_e&&q(ee)},r._tr_tally=function(ee,ae,me){return ee.pending_buf[ee.d_buf+2*ee.last_lit]=ae>>>8&255,ee.pending_buf[ee.d_buf+2*ee.last_lit+1]=255&ae,ee.pending_buf[ee.l_buf+ee.last_lit]=255&me,ee.last_lit++,ae===0?ee.dyn_ltree[2*me]++:(ee.matches++,ae--,ee.dyn_ltree[2*(E[me]+d+1)]++,ee.dyn_dtree[2*Y(ae)]++),ee.last_lit===ee.lit_bufsize-1},r._tr_align=function(ee){V(ee,2,3),Q(ee,y,T),(function(ae){ae.bi_valid===16?(K(ae,ae.bi_buf),ae.bi_buf=0,ae.bi_valid=0):8<=ae.bi_valid&&(ae.pending_buf[ae.pending++]=255&ae.bi_buf,ae.bi_buf>>=8,ae.bi_valid-=8)})(ee)}},{"../utils/common":41}],53:[function(t,i,r){i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,i,r){(function(s){(function(o,a){if(!o.setImmediate){var l,h,u,d,A=1,f={},p=!1,g=o.document,v=Object.getPrototypeOf&&Object.getPrototypeOf(o);v=v&&v.setTimeout?v:o,l={}.toString.call(o.process)==="[object process]"?function(x){process.nextTick(function(){m(x)})}:(function(){if(o.postMessage&&!o.importScripts){var x=!0,S=o.onmessage;return o.onmessage=function(){x=!1},o.postMessage("","*"),o.onmessage=S,x}})()?(d="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",y,!1):o.attachEvent("onmessage",y),function(x){o.postMessage(d+x,"*")}):o.MessageChannel?((u=new MessageChannel).port1.onmessage=function(x){m(x.data)},function(x){u.port2.postMessage(x)}):g&&"onreadystatechange"in g.createElement("script")?(h=g.documentElement,function(x){var S=g.createElement("script");S.onreadystatechange=function(){m(x),S.onreadystatechange=null,h.removeChild(S),S=null},h.appendChild(S)}):function(x){setTimeout(m,0,x)},v.setImmediate=function(x){typeof x!="function"&&(x=new Function(""+x));for(var S=new Array(arguments.length-1),I=0;I<S.length;I++)S[I]=arguments[I+1];var j={callback:x,args:S};return f[A]=j,l(A),A++},v.clearImmediate=w}function w(x){delete f[x]}function m(x){if(p)setTimeout(m,0,x);else{var S=f[x];if(S){p=!0;try{(function(I){var j=I.callback,C=I.args;switch(C.length){case 0:j();break;case 1:j(C[0]);break;case 2:j(C[0],C[1]);break;case 3:j(C[0],C[1],C[2]);break;default:j.apply(a,C)}})(S)}finally{w(x),p=!1}}}}function y(x){x.source===o&&typeof x.data=="string"&&x.data.indexOf(d)===0&&m(+x.data.slice(d.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof mm<"u"?mm:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(O3)),O3.exports}var $Ae=QAe();const VQ=Vp($Ae);async function VAe({teamId:n,designId:e,versionId:t,buffer:i,ext:r,userId:s}){const o=crypto.randomUUID(),a=`teams/${n}/designs/${e}/versions/${t}/${o}.${r}`,l=$C(Tw,a);await Az(l,new Uint8Array(i));const h=await fz(l);return await i0(ts(rr,`teams/${n}/assets/${o}`),{owner_type:"version",owner_id:t,type:r,path:a,url:h,teamId:n,designId:e,created_by:s,created_at:Lo()}),{assetId:o,url:h,path:a}}async function GQ(n,e,t,i,r){try{const s=bd.currentUser;if(!s)return console.error("No authenticated user for export"),null;const o=await n.arrayBuffer(),a=await VAe({teamId:t,designId:i,versionId:r,buffer:o,ext:e,userId:s.uid});return console.log(`✅ Export saved to Storage: ${a.path}`),console.log(`✅ Asset registered: ${a.assetId}`),a}catch(s){return console.error("Failed to process export:",s),null}}function H3(n,e){let t,i=!1;n instanceof Blob?(t=URL.createObjectURL(n),i=!0):t=n;const r=document.createElement("a");r.href=t,r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r),i&&URL.revokeObjectURL(t)}async function GAe(n,e,t,i,r,s){try{const o=await GQ(n,t,i,r,s);o&&o.url?(console.log(`📥 Downloading from Storage: ${o.url}`),H3(o.url,e)):(console.log("⚠️ Storage save failed, using direct download"),H3(n,e))}catch(o){console.error("Export failed:",o),H3(n,e)}}async function XAe(n,e){try{console.log("🧪 테스트 시작: Export Asset Upload");const t=await Mz(n,e)||"test_version_001";console.log("📌 Version ID:",t);const i=`Test PDF Export
Team: ${n}
Design: ${e}
Version: ${t}
Timestamp: ${new Date().toISOString()}`,r=new Blob([i],{type:"application/pdf"}),s=await GQ(r,"pdf",n,e,t);s?(console.log("✅ Storage 업로드 성공!"),console.log("📁 Storage 경로:",s.path),console.log("🔗 다운로드 URL:",s.url),console.log("📄 Asset ID:",s.assetId),console.log(""),console.log("Firestore 확인:"),console.log(`teams/${n}/assets/${s.assetId}`)):console.error("❌ Storage 업로드 실패")}catch(t){console.error("❌ 테스트 실패:",t)}}typeof window<"u"&&(window.testExportAsset=XAe);const XQ=()=>{const n=H.useCallback(async(r,s,o="front")=>{try{console.log(`🔧 DXF ${o} 도면 내보내기 시작...`),console.log("📊 입력 데이터:",{spaceInfo:{width:r.width,height:r.height,depth:r.depth,surroundType:r.surroundType,customColumnCount:r.customColumnCount},placedModulesCount:s.length,drawingType:o,placedModules:s.map(A=>({id:A.id,moduleId:A.moduleId,position:A.position,slotIndex:A.slotIndex,isDualSlot:A.isDualSlot,customDepth:A.customDepth}))});const a=Kr(r),l={spaceInfo:r,drawingType:o,placedModules:s.map(A=>{const f=Zi(A.moduleId,a,r);return console.log(`🔍 가구 ${A.id} DXF 내보내기 치수 확인:`,{moduleId:A.moduleId,customDepth:A.customDepth,originalDepth:f==null?void 0:f.dimensions.depth,customWidth:A.customWidth,adjustedWidth:A.adjustedWidth,originalWidth:f==null?void 0:f.dimensions.width,finalWidth:A.customWidth||A.adjustedWidth||(f==null?void 0:f.dimensions.width)}),{id:A.id,moduleId:A.moduleId,position:{x:A.position.x,y:A.position.y,z:A.position.z},moduleData:{name:(f==null?void 0:f.name)||`모듈-${A.moduleId}`,dimensions:{width:A.customWidth||A.adjustedWidth||(f==null?void 0:f.dimensions.width)||400,height:(f==null?void 0:f.dimensions.height)||400,depth:A.customDepth||(f==null?void 0:f.dimensions.depth)||300}},rotation:A.rotation,slotIndex:A.slotIndex,isDualSlot:A.isDualSlot,adjustedWidth:A.adjustedWidth,customWidth:A.customWidth}})};console.log("🔄 변환된 DXF 데이터:",l);const h=LP(l),u=UP(r,o);try{const A=bd.currentUser;if(A){const f=`personal_${A.uid}`,p="current_design",g=await Mz(f,p)||"v_"+Date.now(),v=new Blob([h],{type:"application/dxf"});await GAe(v,u,"dxf",f,p,g),console.log(`✅ DXF ${o} Storage 업로드 성공!`)}else RP(h,u)}catch(A){console.error("Storage 업로드 실패, 로컬 다운로드로 폴백:",A),RP(h,u)}return console.log(`✅ DXF ${o} 도면 내보내기 완료!`),{success:!0,filename:u,message:`DXF ${{front:"정면도",plan:"평면도",side:"측면도"}[o]} 파일이 성공적으로 생성되었습니다.`}}catch(a){return console.error(`❌ DXF ${o} 도면 내보내기 실패:`,a),{success:!1,error:a instanceof Error?a.message:"알 수 없는 오류가 발생했습니다.",message:`DXF ${o} 도면 파일 생성에 실패했습니다.`}}},[]),e=H.useCallback((r,s)=>!(!r||r.width<=0||r.depth<=0),[]),t=H.useCallback((r,s)=>{if(!r)return"공간 정보가 없습니다.";if(r.width<=0||r.depth<=0)return"공간 크기를 설정해주세요.";const o=s.length;return o===0?"공간 도면만 생성됩니다.":`${o}개 가구가 포함된 도면이 생성됩니다.`},[]),i=H.useCallback(async(r,s,o)=>{try{console.log("🔧 DXF ZIP 내보내기 시작..."),console.log("📊 선택된 도면:",o);const a=new VQ,l=Kr(r);for(const m of o){console.log(`📄 ${m} 도면 생성 중...`);const y={spaceInfo:r,drawingType:m,placedModules:s.map(I=>{const j=Zi(I.moduleId,l,r);return{id:I.id,moduleId:I.moduleId,position:{x:I.position.x,y:I.position.y,z:I.position.z},moduleData:{name:(j==null?void 0:j.name)||`모듈-${I.moduleId}`,dimensions:{width:(j==null?void 0:j.dimensions.width)||400,height:(j==null?void 0:j.dimensions.height)||400,depth:I.customDepth||(j==null?void 0:j.dimensions.depth)||300}},rotation:I.rotation,slotIndex:I.slotIndex,isDualSlot:I.isDualSlot}})},x=LP(y),S=UP(r,m);a.file(S,x),console.log(`✅ ${m} 도면 추가 완료: ${S}`)}const h=`가구 배치 도면 (DXF)
========================

생성일: ${new Date().toLocaleDateString("ko-KR")}
공간 크기: ${r.width}mm × ${r.height}mm × ${r.depth}mm

포함된 도면:
${o.map(m=>({front:"- 정면도 (Front Elevation)",plan:"- 평면도 (Plan View)",side:"- 측면도 (Side Section)"})[m]||`- ${m}`).join(`
`)}

가구 개수: ${s.length}개

도면 정보:
- 축척: 1:100
- 단위: mm (밀리미터)
- CAD 호환: AutoCAD DXF 형식

참고사항:
- 모든 치수는 밀리미터(mm) 단위입니다.
- 가구 배치는 실제 공간 치수를 기준으로 합니다.
- DXF 파일은 대부분의 CAD 프로그램에서 열 수 있습니다.
`;a.file("README.txt",h);const u=await a.generateAsync({type:"blob"}),d=new Date().toISOString().slice(0,19).replace(/[:-]/g,""),f=`furniture-drawings-${`${r.width}W-${r.height}H-${r.depth}D`}-${d}.zip`,p=URL.createObjectURL(u),g=document.createElement("a");g.href=p,g.download=f,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(p),console.log(`✅ DXF ZIP 파일 다운로드 완료: ${f}`);const v={front:"정면도",plan:"평면도",side:"측면도"},w=o.map(m=>v[m]).join(", ");return{success:!0,filename:f,message:`DXF 도면 ${o.length}개 (${w})가 ZIP 파일로 생성되었습니다.`}}catch(a){return console.error("❌ DXF ZIP 내보내기 실패:",a),{success:!1,error:a instanceof Error?a.message:"알 수 없는 오류가 발생했습니다.",message:"DXF ZIP 파일 생성에 실패했습니다."}}},[]);return{exportToDXF:n,exportToZIP:i,canExportDXF:e,getExportStatusMessage:t}};function go(n){"@babel/helpers - typeof";return go=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},go(n)}var Sd=Uint8Array,Kh=Uint16Array,Wk=Int32Array,zk=new Sd([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Qk=new Sd([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),HP=new Sd([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),YQ=function(n,e){for(var t=new Kh(31),i=0;i<31;++i)t[i]=e+=1<<n[i-1];for(var r=new Wk(t[30]),i=1;i<30;++i)for(var s=t[i];s<t[i+1];++s)r[s]=s-t[i]<<5|i;return{b:t,r}},KQ=YQ(zk,2),YAe=KQ.b,FE=KQ.r;YAe[28]=258,FE[258]=28;var KAe=YQ(Qk,0),WP=KAe.r,kE=new Kh(32768);for(var ta=0;ta<32768;++ta){var Xf=(ta&43690)>>1|(ta&21845)<<1;Xf=(Xf&52428)>>2|(Xf&13107)<<2,Xf=(Xf&61680)>>4|(Xf&3855)<<4,kE[ta]=((Xf&65280)>>8|(Xf&255)<<8)>>1}var Jy=(function(n,e,t){for(var i=n.length,r=0,s=new Kh(e);r<i;++r)n[r]&&++s[n[r]-1];var o=new Kh(e);for(r=1;r<e;++r)o[r]=o[r-1]+s[r-1]<<1;var a;if(t){a=new Kh(1<<e);var l=15-e;for(r=0;r<i;++r)if(n[r])for(var h=r<<4|n[r],u=e-n[r],d=o[n[r]-1]++<<u,A=d|(1<<u)-1;d<=A;++d)a[kE[d]>>l]=h}else for(a=new Kh(i),r=0;r<i;++r)n[r]&&(a[r]=kE[o[n[r]-1]++]>>15-n[r]);return a}),o0=new Sd(288);for(var ta=0;ta<144;++ta)o0[ta]=8;for(var ta=144;ta<256;++ta)o0[ta]=9;for(var ta=256;ta<280;++ta)o0[ta]=7;for(var ta=280;ta<288;++ta)o0[ta]=8;var h_=new Sd(32);for(var ta=0;ta<32;++ta)h_[ta]=5;var qAe=Jy(o0,9,0),ZAe=Jy(h_,5,0),qQ=function(n){return(n+7)/8|0},JAe=function(n,e,t){return(t==null||t>n.length)&&(t=n.length),new Sd(n.subarray(e,t))},HA=function(n,e,t){t<<=e&7;var i=e/8|0;n[i]|=t,n[i+1]|=t>>8},u2=function(n,e,t){t<<=e&7;var i=e/8|0;n[i]|=t,n[i+1]|=t>>8,n[i+2]|=t>>16},W3=function(n,e){for(var t=[],i=0;i<n.length;++i)n[i]&&t.push({s:i,f:n[i]});var r=t.length,s=t.slice();if(!r)return{t:JQ,l:0};if(r==1){var o=new Sd(t[0].s+1);return o[t[0].s]=1,{t:o,l:1}}t.sort(function(S,I){return S.f-I.f}),t.push({s:-1,f:25001});var a=t[0],l=t[1],h=0,u=1,d=2;for(t[0]={s:-1,f:a.f+l.f,l:a,r:l};u!=r-1;)a=t[t[h].f<t[d].f?h++:d++],l=t[h!=u&&t[h].f<t[d].f?h++:d++],t[u++]={s:-1,f:a.f+l.f,l:a,r:l};for(var A=s[0].s,i=1;i<r;++i)s[i].s>A&&(A=s[i].s);var f=new Kh(A+1),p=IE(t[u-1],f,0);if(p>e){var i=0,g=0,v=p-e,w=1<<v;for(s.sort(function(I,j){return f[j.s]-f[I.s]||I.f-j.f});i<r;++i){var m=s[i].s;if(f[m]>e)g+=w-(1<<p-f[m]),f[m]=e;else break}for(g>>=v;g>0;){var y=s[i].s;f[y]<e?g-=1<<e-f[y]++-1:++i}for(;i>=0&&g;--i){var x=s[i].s;f[x]==e&&(--f[x],++g)}p=e}return{t:new Sd(f),l:p}},IE=function(n,e,t){return n.s==-1?Math.max(IE(n.l,e,t+1),IE(n.r,e,t+1)):e[n.s]=t},zP=function(n){for(var e=n.length;e&&!n[--e];);for(var t=new Kh(++e),i=0,r=n[0],s=1,o=function(l){t[i++]=l},a=1;a<=e;++a)if(n[a]==r&&a!=e)++s;else{if(!r&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(r),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(r);s=1,r=n[a]}return{c:t.subarray(0,i),n:e}},d2=function(n,e){for(var t=0,i=0;i<e.length;++i)t+=n[i]*e[i];return t},ZQ=function(n,e,t){var i=t.length,r=qQ(e+2);n[r]=i&255,n[r+1]=i>>8,n[r+2]=n[r]^255,n[r+3]=n[r+1]^255;for(var s=0;s<i;++s)n[r+s+4]=t[s];return(r+4+i)*8},QP=function(n,e,t,i,r,s,o,a,l,h,u){HA(e,u++,t),++r[256];for(var d=W3(r,15),A=d.t,f=d.l,p=W3(s,15),g=p.t,v=p.l,w=zP(A),m=w.c,y=w.n,x=zP(g),S=x.c,I=x.n,j=new Kh(19),C=0;C<m.length;++C)++j[m[C]&31];for(var C=0;C<S.length;++C)++j[S[C]&31];for(var b=W3(j,7),D=b.t,T=b.l,k=19;k>4&&!D[HP[k-1]];--k);var B=h+5<<3,E=d2(r,o0)+d2(s,h_)+o,z=d2(r,A)+d2(s,g)+o+14+3*k+d2(j,D)+2*j[16]+3*j[17]+7*j[18];if(l>=0&&B<=E&&B<=z)return ZQ(e,u,n.subarray(l,l+h));var te,L,O,J;if(HA(e,u,1+(z<E)),u+=2,z<E){te=Jy(A,f,0),L=A,O=Jy(g,v,0),J=g;var $=Jy(D,T,0);HA(e,u,y-257),HA(e,u+5,I-1),HA(e,u+10,k-4),u+=14;for(var C=0;C<k;++C)HA(e,u+3*C,D[HP[C]]);u+=3*k;for(var U=[m,S],Y=0;Y<2;++Y)for(var K=U[Y],C=0;C<K.length;++C){var V=K[C]&31;HA(e,u,$[V]),u+=D[V],V>15&&(HA(e,u,K[C]>>5&127),u+=K[C]>>12)}}else te=qAe,L=o0,O=ZAe,J=h_;for(var C=0;C<a;++C){var Q=i[C];if(Q>255){var V=Q>>18&31;u2(e,u,te[V+257]),u+=L[V+257],V>7&&(HA(e,u,Q>>23&31),u+=zk[V]);var X=Q&31;u2(e,u,O[X]),u+=J[X],X>3&&(u2(e,u,Q>>5&8191),u+=Qk[X])}else u2(e,u,te[Q]),u+=L[Q]}return u2(e,u,te[256]),u+L[256]},efe=new Wk([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),JQ=new Sd(0),tfe=function(n,e,t,i,r,s){var o=s.z||n.length,a=new Sd(i+o+5*(1+Math.ceil(o/7e3))+r),l=a.subarray(i,a.length-r),h=s.l,u=(s.r||0)&7;if(e){u&&(l[0]=s.r>>3);for(var d=efe[e-1],A=d>>13,f=d&8191,p=(1<<t)-1,g=s.p||new Kh(32768),v=s.h||new Kh(p+1),w=Math.ceil(t/3),m=2*w,y=function(M){return(n[M]^n[M+1]<<w^n[M+2]<<m)&p},x=new Wk(25e3),S=new Kh(288),I=new Kh(32),j=0,C=0,b=s.i||0,D=0,T=s.w||0,k=0;b+2<o;++b){var B=y(b),E=b&32767,z=v[B];if(g[E]=z,v[B]=E,T<=b){var te=o-b;if((j>7e3||D>24576)&&(te>423||!h)){u=QP(n,l,0,x,S,I,C,D,k,b-k,u),D=j=C=0,k=b;for(var L=0;L<286;++L)S[L]=0;for(var L=0;L<30;++L)I[L]=0}var O=2,J=0,$=f,U=E-z&32767;if(te>2&&B==y(b-U))for(var Y=Math.min(A,te)-1,K=Math.min(32767,b),V=Math.min(258,te);U<=K&&--$&&E!=z;){if(n[b+O]==n[b+O-U]){for(var Q=0;Q<V&&n[b+Q]==n[b+Q-U];++Q);if(Q>O){if(O=Q,J=U,Q>Y)break;for(var X=Math.min(U,Q-2),W=0,L=0;L<X;++L){var se=b-U+L&32767,q=g[se],de=se-q&32767;de>W&&(W=de,z=se)}}}E=z,z=g[E],U+=E-z&32767}if(J){x[D++]=268435456|FE[O]<<18|WP[J];var Ce=FE[O]&31,Se=WP[J]&31;C+=zk[Ce]+Qk[Se],++S[257+Ce],++I[Se],T=b+O,++j}else x[D++]=n[b],++S[n[b]]}}for(b=Math.max(b,T);b<o;++b)x[D++]=n[b],++S[n[b]];u=QP(n,l,h,x,S,I,C,D,k,b-k,u),h||(s.r=u&7|l[u/8|0]<<3,u-=7,s.h=v,s.p=g,s.i=b,s.w=T)}else{for(var b=s.w||0;b<o+h;b+=65535){var fe=b+65535;fe>=o&&(l[u/8|0]=h,fe=o),u=ZQ(l,u+1,n.subarray(b,fe))}s.i=o}return JAe(a,0,i+qQ(u)+r)},e$=function(){var n=1,e=0;return{p:function(t){for(var i=n,r=e,s=t.length|0,o=0;o!=s;){for(var a=Math.min(o+2655,s);o<a;++o)r+=i+=t[o];i=(i&65535)+15*(i>>16),r=(r&65535)+15*(r>>16)}n=i,e=r},d:function(){return n%=65521,e%=65521,(n&255)<<24|(n&65280)<<8|(e&255)<<8|e>>8}}},nfe=function(n,e,t,i,r){if(!r&&(r={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),o=new Sd(s.length+n.length);o.set(s),o.set(n,s.length),n=o,r.w=s.length}return tfe(n,e.level==null?6:e.level,e.mem==null?r.l?Math.ceil(Math.max(8,Math.min(13,Math.log(n.length)))*1.5):20:12+e.mem,t,i,r)},t$=function(n,e,t){for(;t;++e)n[e]=t,t>>>=8},ife=function(n,e){var t=e.level,i=t==0?0:t<6?1:t==9?3:2;if(n[0]=120,n[1]=i<<6|(e.dictionary&&32),n[1]|=31-(n[0]<<8|n[1])%31,e.dictionary){var r=e$();r.p(e.dictionary),t$(n,2,r.d())}};function DE(n,e){e||(e={});var t=e$();t.p(n);var i=nfe(n,e,e.dictionary?6:2,4);return ife(i,e),t$(i,i.length-4,t.d()),i}var rfe=typeof TextDecoder<"u"&&new TextDecoder,sfe=0;try{rfe.decode(JQ,{stream:!0}),sfe=1}catch{}function ofe(n){if(Array.isArray(n))return n}function afe(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,o,a=[],l=!0,h=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(l=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(u){h=!0,r=u}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(h)throw r}}return a}}function $P(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function lfe(n,e){if(n){if(typeof n=="string")return $P(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?$P(n,e):void 0}}function cfe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VP(n,e){return ofe(n)||afe(n,e)||lfe(n,e)||cfe()}function GP(n,e="utf8"){return new TextDecoder(e).decode(n)}const hfe=new TextEncoder;function ufe(n){return hfe.encode(n)}const dfe=1024*8,Afe=(()=>{const n=new Uint8Array(4),e=new Uint32Array(n.buffer);return!((e[0]=1)&n[0])})(),z3={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class $k{constructor(e=dfe,t={}){Br(this,"buffer");Br(this,"byteLength");Br(this,"byteOffset");Br(this,"length");Br(this,"offset");Br(this,"lastWrittenByte");Br(this,"littleEndian");Br(this,"_data");Br(this,"_mark");Br(this,"_marks");let i=!1;typeof e=="number"?e=new ArrayBuffer(e):(i=!0,this.lastWrittenByte=e.byteLength);const r=t.offset?t.offset>>>0:0,s=e.byteLength-r;let o=r;(ArrayBuffer.isView(e)||e instanceof $k)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+r),e=e.buffer),i?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=e,this.length=s,this.byteLength=s,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,s),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const i=(this.offset+e)*2,r=new Uint8Array(i);r.set(new Uint8Array(this.buffer)),this.buffer=r.buffer,this.length=i,this.byteLength=i,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,t){const i=z3[t].BYTES_PER_ELEMENT*e,r=this.byteOffset+this.offset,s=this.buffer.slice(r,r+i);if(this.littleEndian===Afe&&t!=="uint8"&&t!=="int8"){const a=new Uint8Array(this.buffer.slice(r,r+i));a.reverse();const l=new z3[t](a.buffer);return this.offset+=i,l.reverse(),l}const o=new z3[t](s);return this.offset+=i,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let t="";for(let i=0;i<e;i++)t+=this.readChar();return t}readUtf8(e=1){return GP(this.readBytes(e))}decodeText(e=1,t="utf8"){return GP(this.readBytes(e),t)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(e){return this.writeBytes(ufe(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function j1(n){let e=n.length;for(;--e>=0;)n[e]=0}const ffe=3,pfe=258,n$=29,gfe=256,mfe=gfe+1+n$,i$=30,yfe=512,wfe=new Array((mfe+2)*2);j1(wfe);const vfe=new Array(i$*2);j1(vfe);const xfe=new Array(yfe);j1(xfe);const bfe=new Array(pfe-ffe+1);j1(bfe);const Cfe=new Array(n$);j1(Cfe);const _fe=new Array(i$);j1(_fe);const Sfe=(n,e,t,i)=>{let r=n&65535|0,s=n>>>16&65535|0,o=0;for(;t!==0;){o=t>2e3?2e3:t,t-=o;do r=r+e[i++]|0,s=s+r|0;while(--o);r%=65521,s%=65521}return r|s<<16|0};var jE=Sfe;const Tfe=()=>{let n,e=[];for(var t=0;t<256;t++){n=t;for(var i=0;i<8;i++)n=n&1?3988292384^n>>>1:n>>>1;e[t]=n}return e},Bfe=new Uint32Array(Tfe()),Efe=(n,e,t,i)=>{const r=Bfe,s=i+t;n^=-1;for(let o=i;o<s;o++)n=n>>>8^r[(n^e[o])&255];return n^-1};var Wd=Efe,PE={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},r$={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const Ffe=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var kfe=function(n){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const i in t)Ffe(t,i)&&(n[i]=t[i])}}return n},Ife=n=>{let e=0;for(let i=0,r=n.length;i<r;i++)e+=n[i].length;const t=new Uint8Array(e);for(let i=0,r=0,s=n.length;i<s;i++){let o=n[i];t.set(o,r),r+=o.length}return t},s$={assign:kfe,flattenChunks:Ife};let o$=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o$=!1}const Nw=new Uint8Array(256);for(let n=0;n<256;n++)Nw[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;Nw[254]=Nw[254]=1;var Dfe=n=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(n);let e,t,i,r,s,o=n.length,a=0;for(r=0;r<o;r++)t=n.charCodeAt(r),(t&64512)===55296&&r+1<o&&(i=n.charCodeAt(r+1),(i&64512)===56320&&(t=65536+(t-55296<<10)+(i-56320),r++)),a+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(a),s=0,r=0;s<a;r++)t=n.charCodeAt(r),(t&64512)===55296&&r+1<o&&(i=n.charCodeAt(r+1),(i&64512)===56320&&(t=65536+(t-55296<<10)+(i-56320),r++)),t<128?e[s++]=t:t<2048?(e[s++]=192|t>>>6,e[s++]=128|t&63):t<65536?(e[s++]=224|t>>>12,e[s++]=128|t>>>6&63,e[s++]=128|t&63):(e[s++]=240|t>>>18,e[s++]=128|t>>>12&63,e[s++]=128|t>>>6&63,e[s++]=128|t&63);return e};const jfe=(n,e)=>{if(e<65534&&n.subarray&&o$)return String.fromCharCode.apply(null,n.length===e?n:n.subarray(0,e));let t="";for(let i=0;i<e;i++)t+=String.fromCharCode(n[i]);return t};var Pfe=(n,e)=>{const t=e||n.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(n.subarray(0,e));let i,r;const s=new Array(t*2);for(r=0,i=0;i<t;){let o=n[i++];if(o<128){s[r++]=o;continue}let a=Nw[o];if(a>4){s[r++]=65533,i+=a-1;continue}for(o&=a===2?31:a===3?15:7;a>1&&i<t;)o=o<<6|n[i++]&63,a--;if(a>1){s[r++]=65533;continue}o<65536?s[r++]=o:(o-=65536,s[r++]=55296|o>>10&1023,s[r++]=56320|o&1023)}return jfe(s,r)},Nfe=(n,e)=>{e=e||n.length,e>n.length&&(e=n.length);let t=e-1;for(;t>=0&&(n[t]&192)===128;)t--;return t<0||t===0?e:t+Nw[n[t]]>e?t:e},NE={string2buf:Dfe,buf2string:Pfe,utf8border:Nfe};function Lfe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Mfe=Lfe;const Dx=16209,Rfe=16191;var Ufe=function(e,t){let i,r,s,o,a,l,h,u,d,A,f,p,g,v,w,m,y,x,S,I,j,C,b,D;const T=e.state;i=e.next_in,b=e.input,r=i+(e.avail_in-5),s=e.next_out,D=e.output,o=s-(t-e.avail_out),a=s+(e.avail_out-257),l=T.dmax,h=T.wsize,u=T.whave,d=T.wnext,A=T.window,f=T.hold,p=T.bits,g=T.lencode,v=T.distcode,w=(1<<T.lenbits)-1,m=(1<<T.distbits)-1;e:do{p<15&&(f+=b[i++]<<p,p+=8,f+=b[i++]<<p,p+=8),y=g[f&w];t:for(;;){if(x=y>>>24,f>>>=x,p-=x,x=y>>>16&255,x===0)D[s++]=y&65535;else if(x&16){S=y&65535,x&=15,x&&(p<x&&(f+=b[i++]<<p,p+=8),S+=f&(1<<x)-1,f>>>=x,p-=x),p<15&&(f+=b[i++]<<p,p+=8,f+=b[i++]<<p,p+=8),y=v[f&m];n:for(;;){if(x=y>>>24,f>>>=x,p-=x,x=y>>>16&255,x&16){if(I=y&65535,x&=15,p<x&&(f+=b[i++]<<p,p+=8,p<x&&(f+=b[i++]<<p,p+=8)),I+=f&(1<<x)-1,I>l){e.msg="invalid distance too far back",T.mode=Dx;break e}if(f>>>=x,p-=x,x=s-o,I>x){if(x=I-x,x>u&&T.sane){e.msg="invalid distance too far back",T.mode=Dx;break e}if(j=0,C=A,d===0){if(j+=h-x,x<S){S-=x;do D[s++]=A[j++];while(--x);j=s-I,C=D}}else if(d<x){if(j+=h+d-x,x-=d,x<S){S-=x;do D[s++]=A[j++];while(--x);if(j=0,d<S){x=d,S-=x;do D[s++]=A[j++];while(--x);j=s-I,C=D}}}else if(j+=d-x,x<S){S-=x;do D[s++]=A[j++];while(--x);j=s-I,C=D}for(;S>2;)D[s++]=C[j++],D[s++]=C[j++],D[s++]=C[j++],S-=3;S&&(D[s++]=C[j++],S>1&&(D[s++]=C[j++]))}else{j=s-I;do D[s++]=D[j++],D[s++]=D[j++],D[s++]=D[j++],S-=3;while(S>2);S&&(D[s++]=D[j++],S>1&&(D[s++]=D[j++]))}}else if((x&64)===0){y=v[(y&65535)+(f&(1<<x)-1)];continue n}else{e.msg="invalid distance code",T.mode=Dx;break e}break}}else if((x&64)===0){y=g[(y&65535)+(f&(1<<x)-1)];continue t}else if(x&32){T.mode=Rfe;break e}else{e.msg="invalid literal/length code",T.mode=Dx;break e}break}}while(i<r&&s<a);S=p>>3,i-=S,p-=S<<3,f&=(1<<p)-1,e.next_in=i,e.next_out=s,e.avail_in=i<r?5+(r-i):5-(i-r),e.avail_out=s<a?257+(a-s):257-(s-a),T.hold=f,T.bits=p};const H0=15,XP=852,YP=592,KP=0,Q3=1,qP=2,Ofe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Hfe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Wfe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),zfe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Qfe=(n,e,t,i,r,s,o,a)=>{const l=a.bits;let h=0,u=0,d=0,A=0,f=0,p=0,g=0,v=0,w=0,m=0,y,x,S,I,j,C=null,b;const D=new Uint16Array(H0+1),T=new Uint16Array(H0+1);let k=null,B,E,z;for(h=0;h<=H0;h++)D[h]=0;for(u=0;u<i;u++)D[e[t+u]]++;for(f=l,A=H0;A>=1&&D[A]===0;A--);if(f>A&&(f=A),A===0)return r[s++]=1<<24|64<<16|0,r[s++]=1<<24|64<<16|0,a.bits=1,0;for(d=1;d<A&&D[d]===0;d++);for(f<d&&(f=d),v=1,h=1;h<=H0;h++)if(v<<=1,v-=D[h],v<0)return-1;if(v>0&&(n===KP||A!==1))return-1;for(T[1]=0,h=1;h<H0;h++)T[h+1]=T[h]+D[h];for(u=0;u<i;u++)e[t+u]!==0&&(o[T[e[t+u]]++]=u);if(n===KP?(C=k=o,b=20):n===Q3?(C=Ofe,k=Hfe,b=257):(C=Wfe,k=zfe,b=0),m=0,u=0,h=d,j=s,p=f,g=0,S=-1,w=1<<f,I=w-1,n===Q3&&w>XP||n===qP&&w>YP)return 1;for(;;){B=h-g,o[u]+1<b?(E=0,z=o[u]):o[u]>=b?(E=k[o[u]-b],z=C[o[u]-b]):(E=96,z=0),y=1<<h-g,x=1<<p,d=x;do x-=y,r[j+(m>>g)+x]=B<<24|E<<16|z|0;while(x!==0);for(y=1<<h-1;m&y;)y>>=1;if(y!==0?(m&=y-1,m+=y):m=0,u++,--D[h]===0){if(h===A)break;h=e[t+o[u]]}if(h>f&&(m&I)!==S){for(g===0&&(g=f),j+=d,p=h-g,v=1<<p;p+g<A&&(v-=D[p+g],!(v<=0));)p++,v<<=1;if(w+=1<<p,n===Q3&&w>XP||n===qP&&w>YP)return 1;S=m&I,r[S]=f<<24|p<<16|j-s|0}}return m!==0&&(r[j+m]=h-g<<24|64<<16|0),a.bits=f,0};var ew=Qfe;const $fe=0,a$=1,l$=2,{Z_FINISH:ZP,Z_BLOCK:Vfe,Z_TREES:jx,Z_OK:a0,Z_STREAM_END:Gfe,Z_NEED_DICT:Xfe,Z_STREAM_ERROR:Uu,Z_DATA_ERROR:c$,Z_MEM_ERROR:h$,Z_BUF_ERROR:Yfe,Z_DEFLATED:JP}=r$,H5=16180,eN=16181,tN=16182,nN=16183,iN=16184,rN=16185,sN=16186,oN=16187,aN=16188,lN=16189,u_=16190,WA=16191,$3=16192,cN=16193,V3=16194,hN=16195,uN=16196,dN=16197,AN=16198,Px=16199,Nx=16200,fN=16201,pN=16202,gN=16203,mN=16204,yN=16205,G3=16206,wN=16207,vN=16208,oa=16209,u$=16210,d$=16211,Kfe=852,qfe=592,Zfe=15,Jfe=Zfe,xN=n=>(n>>>24&255)+(n>>>8&65280)+((n&65280)<<8)+((n&255)<<24);function epe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const x0=n=>{if(!n)return 1;const e=n.state;return!e||e.strm!==n||e.mode<H5||e.mode>d$?1:0},A$=n=>{if(x0(n))return Uu;const e=n.state;return n.total_in=n.total_out=e.total=0,n.msg="",e.wrap&&(n.adler=e.wrap&1),e.mode=H5,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(Kfe),e.distcode=e.distdyn=new Int32Array(qfe),e.sane=1,e.back=-1,a0},f$=n=>{if(x0(n))return Uu;const e=n.state;return e.wsize=0,e.whave=0,e.wnext=0,A$(n)},p$=(n,e)=>{let t;if(x0(n))return Uu;const i=n.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Uu:(i.window!==null&&i.wbits!==e&&(i.window=null),i.wrap=t,i.wbits=e,f$(n))},g$=(n,e)=>{if(!n)return Uu;const t=new epe;n.state=t,t.strm=n,t.window=null,t.mode=H5;const i=p$(n,e);return i!==a0&&(n.state=null),i},tpe=n=>g$(n,Jfe);let bN=!0,X3,Y3;const npe=n=>{if(bN){X3=new Int32Array(512),Y3=new Int32Array(32);let e=0;for(;e<144;)n.lens[e++]=8;for(;e<256;)n.lens[e++]=9;for(;e<280;)n.lens[e++]=7;for(;e<288;)n.lens[e++]=8;for(ew(a$,n.lens,0,288,X3,0,n.work,{bits:9}),e=0;e<32;)n.lens[e++]=5;ew(l$,n.lens,0,32,Y3,0,n.work,{bits:5}),bN=!1}n.lencode=X3,n.lenbits=9,n.distcode=Y3,n.distbits=5},m$=(n,e,t,i)=>{let r;const s=n.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(e.subarray(t-s.wsize,t),0),s.wnext=0,s.whave=s.wsize):(r=s.wsize-s.wnext,r>i&&(r=i),s.window.set(e.subarray(t-i,t-i+r),s.wnext),i-=r,i?(s.window.set(e.subarray(t-i,t),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0},ipe=(n,e)=>{let t,i,r,s,o,a,l,h,u,d,A,f,p,g,v=0,w,m,y,x,S,I,j,C;const b=new Uint8Array(4);let D,T;const k=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(x0(n)||!n.output||!n.input&&n.avail_in!==0)return Uu;t=n.state,t.mode===WA&&(t.mode=$3),o=n.next_out,r=n.output,l=n.avail_out,s=n.next_in,i=n.input,a=n.avail_in,h=t.hold,u=t.bits,d=a,A=l,C=a0;e:for(;;)switch(t.mode){case H5:if(t.wrap===0){t.mode=$3;break}for(;u<16;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}if(t.wrap&2&&h===35615){t.wbits===0&&(t.wbits=15),t.check=0,b[0]=h&255,b[1]=h>>>8&255,t.check=Wd(t.check,b,2,0),h=0,u=0,t.mode=eN;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((h&255)<<8)+(h>>8))%31){n.msg="incorrect header check",t.mode=oa;break}if((h&15)!==JP){n.msg="unknown compression method",t.mode=oa;break}if(h>>>=4,u-=4,j=(h&15)+8,t.wbits===0&&(t.wbits=j),j>15||j>t.wbits){n.msg="invalid window size",t.mode=oa;break}t.dmax=1<<t.wbits,t.flags=0,n.adler=t.check=1,t.mode=h&512?lN:WA,h=0,u=0;break;case eN:for(;u<16;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}if(t.flags=h,(t.flags&255)!==JP){n.msg="unknown compression method",t.mode=oa;break}if(t.flags&57344){n.msg="unknown header flags set",t.mode=oa;break}t.head&&(t.head.text=h>>8&1),t.flags&512&&t.wrap&4&&(b[0]=h&255,b[1]=h>>>8&255,t.check=Wd(t.check,b,2,0)),h=0,u=0,t.mode=tN;case tN:for(;u<32;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}t.head&&(t.head.time=h),t.flags&512&&t.wrap&4&&(b[0]=h&255,b[1]=h>>>8&255,b[2]=h>>>16&255,b[3]=h>>>24&255,t.check=Wd(t.check,b,4,0)),h=0,u=0,t.mode=nN;case nN:for(;u<16;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}t.head&&(t.head.xflags=h&255,t.head.os=h>>8),t.flags&512&&t.wrap&4&&(b[0]=h&255,b[1]=h>>>8&255,t.check=Wd(t.check,b,2,0)),h=0,u=0,t.mode=iN;case iN:if(t.flags&1024){for(;u<16;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}t.length=h,t.head&&(t.head.extra_len=h),t.flags&512&&t.wrap&4&&(b[0]=h&255,b[1]=h>>>8&255,t.check=Wd(t.check,b,2,0)),h=0,u=0}else t.head&&(t.head.extra=null);t.mode=rN;case rN:if(t.flags&1024&&(f=t.length,f>a&&(f=a),f&&(t.head&&(j=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(i.subarray(s,s+f),j)),t.flags&512&&t.wrap&4&&(t.check=Wd(t.check,i,f,s)),a-=f,s+=f,t.length-=f),t.length))break e;t.length=0,t.mode=sN;case sN:if(t.flags&2048){if(a===0)break e;f=0;do j=i[s+f++],t.head&&j&&t.length<65536&&(t.head.name+=String.fromCharCode(j));while(j&&f<a);if(t.flags&512&&t.wrap&4&&(t.check=Wd(t.check,i,f,s)),a-=f,s+=f,j)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=oN;case oN:if(t.flags&4096){if(a===0)break e;f=0;do j=i[s+f++],t.head&&j&&t.length<65536&&(t.head.comment+=String.fromCharCode(j));while(j&&f<a);if(t.flags&512&&t.wrap&4&&(t.check=Wd(t.check,i,f,s)),a-=f,s+=f,j)break e}else t.head&&(t.head.comment=null);t.mode=aN;case aN:if(t.flags&512){for(;u<16;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}if(t.wrap&4&&h!==(t.check&65535)){n.msg="header crc mismatch",t.mode=oa;break}h=0,u=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),n.adler=t.check=0,t.mode=WA;break;case lN:for(;u<32;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}n.adler=t.check=xN(h),h=0,u=0,t.mode=u_;case u_:if(t.havedict===0)return n.next_out=o,n.avail_out=l,n.next_in=s,n.avail_in=a,t.hold=h,t.bits=u,Xfe;n.adler=t.check=1,t.mode=WA;case WA:if(e===Vfe||e===jx)break e;case $3:if(t.last){h>>>=u&7,u-=u&7,t.mode=G3;break}for(;u<3;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}switch(t.last=h&1,h>>>=1,u-=1,h&3){case 0:t.mode=cN;break;case 1:if(npe(t),t.mode=Px,e===jx){h>>>=2,u-=2;break e}break;case 2:t.mode=uN;break;case 3:n.msg="invalid block type",t.mode=oa}h>>>=2,u-=2;break;case cN:for(h>>>=u&7,u-=u&7;u<32;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}if((h&65535)!==(h>>>16^65535)){n.msg="invalid stored block lengths",t.mode=oa;break}if(t.length=h&65535,h=0,u=0,t.mode=V3,e===jx)break e;case V3:t.mode=hN;case hN:if(f=t.length,f){if(f>a&&(f=a),f>l&&(f=l),f===0)break e;r.set(i.subarray(s,s+f),o),a-=f,s+=f,l-=f,o+=f,t.length-=f;break}t.mode=WA;break;case uN:for(;u<14;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}if(t.nlen=(h&31)+257,h>>>=5,u-=5,t.ndist=(h&31)+1,h>>>=5,u-=5,t.ncode=(h&15)+4,h>>>=4,u-=4,t.nlen>286||t.ndist>30){n.msg="too many length or distance symbols",t.mode=oa;break}t.have=0,t.mode=dN;case dN:for(;t.have<t.ncode;){for(;u<3;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}t.lens[k[t.have++]]=h&7,h>>>=3,u-=3}for(;t.have<19;)t.lens[k[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,D={bits:t.lenbits},C=ew($fe,t.lens,0,19,t.lencode,0,t.work,D),t.lenbits=D.bits,C){n.msg="invalid code lengths set",t.mode=oa;break}t.have=0,t.mode=AN;case AN:for(;t.have<t.nlen+t.ndist;){for(;v=t.lencode[h&(1<<t.lenbits)-1],w=v>>>24,m=v>>>16&255,y=v&65535,!(w<=u);){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}if(y<16)h>>>=w,u-=w,t.lens[t.have++]=y;else{if(y===16){for(T=w+2;u<T;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}if(h>>>=w,u-=w,t.have===0){n.msg="invalid bit length repeat",t.mode=oa;break}j=t.lens[t.have-1],f=3+(h&3),h>>>=2,u-=2}else if(y===17){for(T=w+3;u<T;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}h>>>=w,u-=w,j=0,f=3+(h&7),h>>>=3,u-=3}else{for(T=w+7;u<T;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}h>>>=w,u-=w,j=0,f=11+(h&127),h>>>=7,u-=7}if(t.have+f>t.nlen+t.ndist){n.msg="invalid bit length repeat",t.mode=oa;break}for(;f--;)t.lens[t.have++]=j}}if(t.mode===oa)break;if(t.lens[256]===0){n.msg="invalid code -- missing end-of-block",t.mode=oa;break}if(t.lenbits=9,D={bits:t.lenbits},C=ew(a$,t.lens,0,t.nlen,t.lencode,0,t.work,D),t.lenbits=D.bits,C){n.msg="invalid literal/lengths set",t.mode=oa;break}if(t.distbits=6,t.distcode=t.distdyn,D={bits:t.distbits},C=ew(l$,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,D),t.distbits=D.bits,C){n.msg="invalid distances set",t.mode=oa;break}if(t.mode=Px,e===jx)break e;case Px:t.mode=Nx;case Nx:if(a>=6&&l>=258){n.next_out=o,n.avail_out=l,n.next_in=s,n.avail_in=a,t.hold=h,t.bits=u,Ufe(n,A),o=n.next_out,r=n.output,l=n.avail_out,s=n.next_in,i=n.input,a=n.avail_in,h=t.hold,u=t.bits,t.mode===WA&&(t.back=-1);break}for(t.back=0;v=t.lencode[h&(1<<t.lenbits)-1],w=v>>>24,m=v>>>16&255,y=v&65535,!(w<=u);){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}if(m&&(m&240)===0){for(x=w,S=m,I=y;v=t.lencode[I+((h&(1<<x+S)-1)>>x)],w=v>>>24,m=v>>>16&255,y=v&65535,!(x+w<=u);){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}h>>>=x,u-=x,t.back+=x}if(h>>>=w,u-=w,t.back+=w,t.length=y,m===0){t.mode=yN;break}if(m&32){t.back=-1,t.mode=WA;break}if(m&64){n.msg="invalid literal/length code",t.mode=oa;break}t.extra=m&15,t.mode=fN;case fN:if(t.extra){for(T=t.extra;u<T;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}t.length+=h&(1<<t.extra)-1,h>>>=t.extra,u-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=pN;case pN:for(;v=t.distcode[h&(1<<t.distbits)-1],w=v>>>24,m=v>>>16&255,y=v&65535,!(w<=u);){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}if((m&240)===0){for(x=w,S=m,I=y;v=t.distcode[I+((h&(1<<x+S)-1)>>x)],w=v>>>24,m=v>>>16&255,y=v&65535,!(x+w<=u);){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}h>>>=x,u-=x,t.back+=x}if(h>>>=w,u-=w,t.back+=w,m&64){n.msg="invalid distance code",t.mode=oa;break}t.offset=y,t.extra=m&15,t.mode=gN;case gN:if(t.extra){for(T=t.extra;u<T;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}t.offset+=h&(1<<t.extra)-1,h>>>=t.extra,u-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){n.msg="invalid distance too far back",t.mode=oa;break}t.mode=mN;case mN:if(l===0)break e;if(f=A-l,t.offset>f){if(f=t.offset-f,f>t.whave&&t.sane){n.msg="invalid distance too far back",t.mode=oa;break}f>t.wnext?(f-=t.wnext,p=t.wsize-f):p=t.wnext-f,f>t.length&&(f=t.length),g=t.window}else g=r,p=o-t.offset,f=t.length;f>l&&(f=l),l-=f,t.length-=f;do r[o++]=g[p++];while(--f);t.length===0&&(t.mode=Nx);break;case yN:if(l===0)break e;r[o++]=t.length,l--,t.mode=Nx;break;case G3:if(t.wrap){for(;u<32;){if(a===0)break e;a--,h|=i[s++]<<u,u+=8}if(A-=l,n.total_out+=A,t.total+=A,t.wrap&4&&A&&(n.adler=t.check=t.flags?Wd(t.check,r,A,o-A):jE(t.check,r,A,o-A)),A=l,t.wrap&4&&(t.flags?h:xN(h))!==t.check){n.msg="incorrect data check",t.mode=oa;break}h=0,u=0}t.mode=wN;case wN:if(t.wrap&&t.flags){for(;u<32;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}if(t.wrap&4&&h!==(t.total&4294967295)){n.msg="incorrect length check",t.mode=oa;break}h=0,u=0}t.mode=vN;case vN:C=Gfe;break e;case oa:C=c$;break e;case u$:return h$;case d$:default:return Uu}return n.next_out=o,n.avail_out=l,n.next_in=s,n.avail_in=a,t.hold=h,t.bits=u,(t.wsize||A!==n.avail_out&&t.mode<oa&&(t.mode<G3||e!==ZP))&&m$(n,n.output,n.next_out,A-n.avail_out),d-=n.avail_in,A-=n.avail_out,n.total_in+=d,n.total_out+=A,t.total+=A,t.wrap&4&&A&&(n.adler=t.check=t.flags?Wd(t.check,r,A,n.next_out-A):jE(t.check,r,A,n.next_out-A)),n.data_type=t.bits+(t.last?64:0)+(t.mode===WA?128:0)+(t.mode===Px||t.mode===V3?256:0),(d===0&&A===0||e===ZP)&&C===a0&&(C=Yfe),C},rpe=n=>{if(x0(n))return Uu;let e=n.state;return e.window&&(e.window=null),n.state=null,a0},spe=(n,e)=>{if(x0(n))return Uu;const t=n.state;return(t.wrap&2)===0?Uu:(t.head=e,e.done=!1,a0)},ope=(n,e)=>{const t=e.length;let i,r,s;return x0(n)||(i=n.state,i.wrap!==0&&i.mode!==u_)?Uu:i.mode===u_&&(r=1,r=jE(r,e,t,0),r!==i.check)?c$:(s=m$(n,e,t,t),s?(i.mode=u$,h$):(i.havedict=1,a0))};var ape=f$,lpe=p$,cpe=A$,hpe=tpe,upe=g$,dpe=ipe,Ape=rpe,fpe=spe,ppe=ope,gpe="pako inflate (from Nodeca project)",JA={inflateReset:ape,inflateReset2:lpe,inflateResetKeep:cpe,inflateInit:hpe,inflateInit2:upe,inflate:dpe,inflateEnd:Ape,inflateGetHeader:fpe,inflateSetDictionary:ppe,inflateInfo:gpe};function mpe(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var ype=mpe;const y$=Object.prototype.toString,{Z_NO_FLUSH:wpe,Z_FINISH:vpe,Z_OK:Lw,Z_STREAM_END:K3,Z_NEED_DICT:q3,Z_STREAM_ERROR:xpe,Z_DATA_ERROR:CN,Z_MEM_ERROR:bpe}=r$;function bv(n){this.options=s$.assign({chunkSize:1024*64,windowBits:15,to:""},n||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(n&&n.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Mfe,this.strm.avail_out=0;let t=JA.inflateInit2(this.strm,e.windowBits);if(t!==Lw)throw new Error(PE[t]);if(this.header=new ype,JA.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=NE.string2buf(e.dictionary):y$.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=JA.inflateSetDictionary(this.strm,e.dictionary),t!==Lw)))throw new Error(PE[t])}bv.prototype.push=function(n,e){const t=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let s,o,a;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?vpe:wpe,y$.call(n)==="[object ArrayBuffer]"?t.input=new Uint8Array(n):t.input=n,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(i),t.next_out=0,t.avail_out=i),s=JA.inflate(t,o),s===q3&&r&&(s=JA.inflateSetDictionary(t,r),s===Lw?s=JA.inflate(t,o):s===CN&&(s=q3));t.avail_in>0&&s===K3&&t.state.wrap>0&&n[t.next_in]!==0;)JA.inflateReset(t),s=JA.inflate(t,o);switch(s){case xpe:case CN:case q3:case bpe:return this.onEnd(s),this.ended=!0,!1}if(a=t.avail_out,t.next_out&&(t.avail_out===0||s===K3))if(this.options.to==="string"){let l=NE.utf8border(t.output,t.next_out),h=t.next_out-l,u=NE.buf2string(t.output,l);t.next_out=h,t.avail_out=i-h,h&&t.output.set(t.output.subarray(l,l+h),0),this.onData(u)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(s===Lw&&a===0)){if(s===K3)return s=JA.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};bv.prototype.onData=function(n){this.chunks.push(n)};bv.prototype.onEnd=function(n){n===Lw&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s$.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function Cpe(n,e){const t=new bv(e);if(t.push(n),t.err)throw t.msg||PE[t.err];return t.result}var _pe=bv,Spe=Cpe,Tpe={Inflate:_pe,inflate:Spe};const{Inflate:Bpe,inflate:Epe}=Tpe;var _N=Bpe,Fpe=Epe;const w$=[];for(let n=0;n<256;n++){let e=n;for(let t=0;t<8;t++)e&1?e=3988292384^e>>>1:e=e>>>1;w$[n]=e}const SN=4294967295;function kpe(n,e,t){let i=n;for(let r=0;r<t;r++)i=w$[(i^e[r])&255]^i>>>8;return i}function Ipe(n,e){return(kpe(SN,n,e)^SN)>>>0}function TN(n,e,t){const i=n.readUint32(),r=Ipe(new Uint8Array(n.buffer,n.byteOffset+n.offset-e-4,e),e);if(r!==i)throw new Error(`CRC mismatch for chunk ${t}. Expected ${i}, found ${r}`)}function v$(n,e,t){for(let i=0;i<t;i++)e[i]=n[i]}function x$(n,e,t,i){let r=0;for(;r<i;r++)e[r]=n[r];for(;r<t;r++)e[r]=n[r]+e[r-i]&255}function b$(n,e,t,i){let r=0;if(t.length===0)for(;r<i;r++)e[r]=n[r];else for(;r<i;r++)e[r]=n[r]+t[r]&255}function C$(n,e,t,i,r){let s=0;if(t.length===0){for(;s<r;s++)e[s]=n[s];for(;s<i;s++)e[s]=n[s]+(e[s-r]>>1)&255}else{for(;s<r;s++)e[s]=n[s]+(t[s]>>1)&255;for(;s<i;s++)e[s]=n[s]+(e[s-r]+t[s]>>1)&255}}function _$(n,e,t,i,r){let s=0;if(t.length===0){for(;s<r;s++)e[s]=n[s];for(;s<i;s++)e[s]=n[s]+e[s-r]&255}else{for(;s<r;s++)e[s]=n[s]+t[s]&255;for(;s<i;s++)e[s]=n[s]+Dpe(e[s-r],t[s],t[s-r])&255}}function Dpe(n,e,t){const i=n+e-t,r=Math.abs(i-n),s=Math.abs(i-e),o=Math.abs(i-t);return r<=s&&r<=o?n:s<=o?e:t}function jpe(n,e,t,i,r,s){switch(n){case 0:v$(e,t,r);break;case 1:x$(e,t,r,s);break;case 2:b$(e,t,i,r);break;case 3:C$(e,t,i,r,s);break;case 4:_$(e,t,i,r,s);break;default:throw new Error(`Unsupported filter: ${n}`)}}const Ppe=new Uint16Array([255]),Npe=new Uint8Array(Ppe.buffer),Lpe=Npe[0]===255;function Mpe(n){const{data:e,width:t,height:i,channels:r,depth:s}=n,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],a=Math.ceil(s/8)*r,l=new Uint8Array(i*t*a);let h=0;for(let u=0;u<7;u++){const d=o[u],A=Math.ceil((t-d.x)/d.xStep),f=Math.ceil((i-d.y)/d.yStep);if(A<=0||f<=0)continue;const p=A*a,g=new Uint8Array(p);for(let v=0;v<f;v++){const w=e[h++],m=e.subarray(h,h+p);h+=p;const y=new Uint8Array(p);jpe(w,m,y,g,p,a),g.set(y);for(let x=0;x<A;x++){const S=d.x+x*d.xStep,I=d.y+v*d.yStep;if(!(S>=t||I>=i))for(let j=0;j<a;j++)l[(I*t+S)*a+j]=y[x*a+j]}}}if(s===16){const u=new Uint16Array(l.buffer);if(Lpe)for(let d=0;d<u.length;d++)u[d]=Rpe(u[d]);return u}else return l}function Rpe(n){return(n&255)<<8|n>>8&255}const Upe=new Uint16Array([255]),Ope=new Uint8Array(Upe.buffer),Hpe=Ope[0]===255,Wpe=new Uint8Array(0);function BN(n){const{data:e,width:t,height:i,channels:r,depth:s}=n,o=Math.ceil(s/8)*r,a=Math.ceil(s/8*r*t),l=new Uint8Array(i*a);let h=Wpe,u=0,d,A;for(let f=0;f<i;f++){switch(d=e.subarray(u+1,u+1+a),A=l.subarray(f*a,(f+1)*a),e[u]){case 0:v$(d,A,a);break;case 1:x$(d,A,a,o);break;case 2:b$(d,A,h,a);break;case 3:C$(d,A,h,a,o);break;case 4:_$(d,A,h,a,o);break;default:throw new Error(`Unsupported filter: ${e[u]}`)}h=A,u+=a+1}if(s===16){const f=new Uint16Array(l.buffer);if(Hpe)for(let p=0;p<f.length;p++)f[p]=zpe(f[p]);return f}else return l}function zpe(n){return(n&255)<<8|n>>8&255}const rC=Uint8Array.of(137,80,78,71,13,10,26,10);function EN(n){if(!Qpe(n.readBytes(rC.length)))throw new Error("wrong PNG signature")}function Qpe(n){if(n.length<rC.length)return!1;for(let e=0;e<rC.length;e++)if(n[e]!==rC[e])return!1;return!0}const $pe="tEXt",Vpe=0,S$=new TextDecoder("latin1");function Gpe(n){if(Ype(n),n.length===0||n.length>79)throw new Error("keyword length must be between 1 and 79")}const Xpe=/^[\u0000-\u00FF]*$/;function Ype(n){if(!Xpe.test(n))throw new Error("invalid latin1 text")}function Kpe(n,e,t){const i=T$(e);n[i]=qpe(e,t-i.length-1)}function T$(n){for(n.mark();n.readByte()!==Vpe;);const e=n.offset;n.reset();const t=S$.decode(n.readBytes(e-n.offset-1));return n.skip(1),Gpe(t),t}function qpe(n,e){return S$.decode(n.readBytes(e))}const Hh={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Z3={UNKNOWN:-1,DEFLATE:0},FN={UNKNOWN:-1,ADAPTIVE:0},J3={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Lx={NONE:0,BACKGROUND:1,PREVIOUS:2},e4={SOURCE:0,OVER:1};class Zpe extends $k{constructor(t,i={}){super(t);Br(this,"_checkCrc");Br(this,"_inflator");Br(this,"_png");Br(this,"_apng");Br(this,"_end");Br(this,"_hasPalette");Br(this,"_palette");Br(this,"_hasTransparency");Br(this,"_transparency");Br(this,"_compressionMethod");Br(this,"_filterMethod");Br(this,"_interlaceMethod");Br(this,"_colorType");Br(this,"_isAnimated");Br(this,"_numberOfFrames");Br(this,"_numberOfPlays");Br(this,"_frames");Br(this,"_writingDataChunks");const{checkCrc:r=!1}=i;this._checkCrc=r,this._inflator=new _N,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Z3.UNKNOWN,this._filterMethod=FN.UNKNOWN,this._interlaceMethod=J3.UNKNOWN,this._colorType=Hh.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(EN(this);!this._end;){const t=this.readUint32(),i=this.readChars(4);this.decodeChunk(t,i)}return this.decodeImage(),this._png}decodeApng(){for(EN(this);!this._end;){const t=this.readUint32(),i=this.readChars(4);this.decodeApngChunk(t,i)}return this.decodeApngImage(),this._apng}decodeChunk(t,i){const r=this.offset;switch(i){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(t);break;case"IDAT":this.decodeIDAT(t);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(t);break;case"iCCP":this.decodeiCCP(t);break;case $pe:Kpe(this._png.text,this,t);break;case"pHYs":this.decodepHYs();break;default:this.skip(t);break}if(this.offset-r!==t)throw new Error(`Length mismatch while decoding chunk ${i}`);this._checkCrc?TN(this,t+4,i):this.skip(4)}decodeApngChunk(t,i){const r=this.offset;switch(i!=="fdAT"&&i!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),i){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(t);break;default:this.decodeChunk(t,i),this.offset=r+t;break}if(this.offset-r!==t)throw new Error(`Length mismatch while decoding chunk ${i}`);this._checkCrc?TN(this,t+4,i):this.skip(4)}decodeIHDR(){const t=this._png;t.width=this.readUint32(),t.height=this.readUint32(),t.depth=Jpe(this.readUint8());const i=this.readUint8();this._colorType=i;let r;switch(i){case Hh.GREYSCALE:r=1;break;case Hh.TRUECOLOUR:r=3;break;case Hh.INDEXED_COLOUR:r=1;break;case Hh.GREYSCALE_ALPHA:r=2;break;case Hh.TRUECOLOUR_ALPHA:r=4;break;case Hh.UNKNOWN:default:throw new Error(`Unknown color type: ${i}`)}if(this._png.channels=r,this._compressionMethod=this.readUint8(),this._compressionMethod!==Z3.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const t={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(t)}decodePLTE(t){if(t%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${t}`);const i=t/3;this._hasPalette=!0;const r=[];this._palette=r;for(let s=0;s<i;s++)r.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(t){this._writingDataChunks=!0;const i=t,r=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,r,i)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodeFDAT(t){this._writingDataChunks=!0;let i=t,r=this.offset+this.byteOffset;if(r+=4,i-=4,this._inflator.push(new Uint8Array(this.buffer,r,i)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodetRNS(t){switch(this._colorType){case Hh.GREYSCALE:case Hh.TRUECOLOUR:{if(t%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${t}`);if(t/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${t/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(t/2);for(let i=0;i<t/2;i++)this._transparency[i]=this.readUint16();break}case Hh.INDEXED_COLOUR:{if(t>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${t} vs ${this._palette.length})`);let i=0;for(;i<t;i++){const r=this.readByte();this._palette[i].push(r)}for(;i<this._palette.length;i++)this._palette[i].push(255);break}case Hh.UNKNOWN:case Hh.GREYSCALE_ALPHA:case Hh.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(t){const i=T$(this),r=this.readUint8();if(r!==Z3.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${r}`);const s=this.readBytes(t-i.length-2);this._png.iccEmbeddedProfile={name:i,profile:Fpe(s)}}decodepHYs(){const t=this.readUint32(),i=this.readUint32(),r=this.readByte();this._png.resolution={x:t,y:i,unit:r}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let t=0;t<this._numberOfFrames;t++){const i={sequenceNumber:this._frames[t].sequenceNumber,delayNumber:this._frames[t].delayNumber,delayDenominator:this._frames[t].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},r=this._frames.at(t);if(r){if(r.data=BN({data:r.data,width:r.width,height:r.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),t===0||r.xOffset===0&&r.yOffset===0&&r.width===this._png.width&&r.height===this._png.height)i.data=r.data;else{const s=this._apng.frames.at(t-1);this.disposeFrame(r,s,i),this.addFrameDataToCanvas(i,r)}this._apng.frames.push(i)}}return this._apng}disposeFrame(t,i,r){switch(t.disposeOp){case Lx.NONE:break;case Lx.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let o=0;o<this._png.width;o++){const a=(s*t.width+o)*this._png.channels;for(let l=0;l<this._png.channels;l++)r.data[a+l]=0}break;case Lx.PREVIOUS:r.data.set(i.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(t,i){const r=1<<this._png.depth,s=(o,a)=>{const l=((o+i.yOffset)*this._png.width+i.xOffset+a)*this._png.channels,h=(o*i.width+a)*this._png.channels;return{index:l,frameIndex:h}};switch(i.blendOp){case e4.SOURCE:for(let o=0;o<i.height;o++)for(let a=0;a<i.width;a++){const{index:l,frameIndex:h}=s(o,a);for(let u=0;u<this._png.channels;u++)t.data[l+u]=i.data[h+u]}break;case e4.OVER:for(let o=0;o<i.height;o++)for(let a=0;a<i.width;a++){const{index:l,frameIndex:h}=s(o,a);for(let u=0;u<this._png.channels;u++){const d=i.data[h+this._png.channels-1]/r,A=u%(this._png.channels-1)===0?1:i.data[h+u],f=Math.floor(d*A+(1-d)*t.data[l+u]);t.data[l+u]+=f}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var i;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const t=this._isAnimated?((i=this._frames)==null?void 0:i.at(0)).data:this._inflator.result;if(this._filterMethod!==FN.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===J3.NO_INTERLACE)this._png.data=BN({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===J3.ADAM7)this._png.data=Mpe({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const t=this._inflator.result,i=this._frames.at(-1);i?i.data=t:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Lx.NONE,blendOp:e4.SOURCE,data:t}),this._inflator=new _N,this._writingDataChunks=!1}}function Jpe(n){if(n!==1&&n!==2&&n!==4&&n!==8&&n!==16)throw new Error(`invalid bit depth: ${n}`);return n}var kN;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.METRE=1]="METRE"})(kN||(kN={}));function ege(n,e){return new Zpe(n,e).decode()}var Lr=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function t4(){Lr.console&&typeof Lr.console.log=="function"&&Lr.console.log.apply(Lr.console,arguments)}var Po={log:t4,warn:function(n){Lr.console&&(typeof Lr.console.warn=="function"?Lr.console.warn.apply(Lr.console,arguments):t4.call(null,arguments))},error:function(n){Lr.console&&(typeof Lr.console.error=="function"?Lr.console.error.apply(Lr.console,arguments):t4(n))}};function n4(n,e,t){var i=new XMLHttpRequest;i.open("GET",n),i.responseType="blob",i.onload=function(){Sg(i.response,e,t)},i.onerror=function(){Po.error("could not download file")},i.send()}function IN(n){var e=new XMLHttpRequest;e.open("HEAD",n,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Mx(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(e)}}var Sg=Lr.saveAs||((typeof window>"u"?"undefined":go(window))!=="object"||window!==Lr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(n,e,t){var i=Lr.URL||Lr.webkitURL,r=document.createElement("a");e=e||n.name||"download",r.download=e,r.rel="noopener",typeof n=="string"?(r.href=n,r.origin!==location.origin?IN(r.href)?n4(n,e,t):Mx(r,r.target="_blank"):Mx(r)):(r.href=i.createObjectURL(n),setTimeout(function(){i.revokeObjectURL(r.href)},4e4),setTimeout(function(){Mx(r)},0))}:"msSaveOrOpenBlob"in navigator?function(n,e,t){if(e=e||n.name||"download",typeof n=="string")if(IN(n))n4(n,e,t);else{var i=document.createElement("a");i.href=n,i.target="_blank",setTimeout(function(){Mx(i)})}else navigator.msSaveOrOpenBlob((function(r,s){return s===void 0?s={autoBom:!1}:go(s)!=="object"&&(Po.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob(["\uFEFF",r],{type:r.type}):r})(n,t),e)}:function(n,e,t,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),typeof n=="string")return n4(n,e,t);var r=n.type==="application/octet-stream",s=/constructor/i.test(Lr.HTMLElement)||Lr.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||r&&s)&&(typeof FileReader>"u"?"undefined":go(FileReader))==="object"){var a=new FileReader;a.onloadend=function(){var u=a.result;u=o?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=u:location=u,i=null},a.readAsDataURL(n)}else{var l=Lr.URL||Lr.webkitURL,h=l.createObjectURL(n);i?i.location=h:location.href=h,i=null,setTimeout(function(){l.revokeObjectURL(h)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function B$(n){var e;n=n||"",this.ok=!1,n.charAt(0)=="#"&&(n=n.substr(1,6)),n={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[n=(n=n.replace(/ /g,"")).toLowerCase()]||n;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],i=0;i<t.length;i++){var r=t[i].re,s=t[i].process,o=r.exec(n);o&&(e=s(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var a=this.r.toString(16),l=this.g.toString(16),h=this.b.toString(16);return a.length==1&&(a="0"+a),l.length==1&&(l="0"+l),h.length==1&&(h="0"+h),"#"+a+l+h}}var sC=Lr.atob.bind(Lr),DN=Lr.btoa.bind(Lr);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function i4(n,e){var t=n[0],i=n[1],r=n[2],s=n[3];t=Dc(t,i,r,s,e[0],7,-680876936),s=Dc(s,t,i,r,e[1],12,-389564586),r=Dc(r,s,t,i,e[2],17,606105819),i=Dc(i,r,s,t,e[3],22,-1044525330),t=Dc(t,i,r,s,e[4],7,-176418897),s=Dc(s,t,i,r,e[5],12,1200080426),r=Dc(r,s,t,i,e[6],17,-1473231341),i=Dc(i,r,s,t,e[7],22,-45705983),t=Dc(t,i,r,s,e[8],7,1770035416),s=Dc(s,t,i,r,e[9],12,-1958414417),r=Dc(r,s,t,i,e[10],17,-42063),i=Dc(i,r,s,t,e[11],22,-1990404162),t=Dc(t,i,r,s,e[12],7,1804603682),s=Dc(s,t,i,r,e[13],12,-40341101),r=Dc(r,s,t,i,e[14],17,-1502002290),t=jc(t,i=Dc(i,r,s,t,e[15],22,1236535329),r,s,e[1],5,-165796510),s=jc(s,t,i,r,e[6],9,-1069501632),r=jc(r,s,t,i,e[11],14,643717713),i=jc(i,r,s,t,e[0],20,-373897302),t=jc(t,i,r,s,e[5],5,-701558691),s=jc(s,t,i,r,e[10],9,38016083),r=jc(r,s,t,i,e[15],14,-660478335),i=jc(i,r,s,t,e[4],20,-405537848),t=jc(t,i,r,s,e[9],5,568446438),s=jc(s,t,i,r,e[14],9,-1019803690),r=jc(r,s,t,i,e[3],14,-187363961),i=jc(i,r,s,t,e[8],20,1163531501),t=jc(t,i,r,s,e[13],5,-1444681467),s=jc(s,t,i,r,e[2],9,-51403784),r=jc(r,s,t,i,e[7],14,1735328473),t=Pc(t,i=jc(i,r,s,t,e[12],20,-1926607734),r,s,e[5],4,-378558),s=Pc(s,t,i,r,e[8],11,-2022574463),r=Pc(r,s,t,i,e[11],16,1839030562),i=Pc(i,r,s,t,e[14],23,-35309556),t=Pc(t,i,r,s,e[1],4,-1530992060),s=Pc(s,t,i,r,e[4],11,1272893353),r=Pc(r,s,t,i,e[7],16,-155497632),i=Pc(i,r,s,t,e[10],23,-1094730640),t=Pc(t,i,r,s,e[13],4,681279174),s=Pc(s,t,i,r,e[0],11,-358537222),r=Pc(r,s,t,i,e[3],16,-722521979),i=Pc(i,r,s,t,e[6],23,76029189),t=Pc(t,i,r,s,e[9],4,-640364487),s=Pc(s,t,i,r,e[12],11,-421815835),r=Pc(r,s,t,i,e[15],16,530742520),t=Nc(t,i=Pc(i,r,s,t,e[2],23,-995338651),r,s,e[0],6,-198630844),s=Nc(s,t,i,r,e[7],10,1126891415),r=Nc(r,s,t,i,e[14],15,-1416354905),i=Nc(i,r,s,t,e[5],21,-57434055),t=Nc(t,i,r,s,e[12],6,1700485571),s=Nc(s,t,i,r,e[3],10,-1894986606),r=Nc(r,s,t,i,e[10],15,-1051523),i=Nc(i,r,s,t,e[1],21,-2054922799),t=Nc(t,i,r,s,e[8],6,1873313359),s=Nc(s,t,i,r,e[15],10,-30611744),r=Nc(r,s,t,i,e[6],15,-1560198380),i=Nc(i,r,s,t,e[13],21,1309151649),t=Nc(t,i,r,s,e[4],6,-145523070),s=Nc(s,t,i,r,e[11],10,-1120210379),r=Nc(r,s,t,i,e[2],15,718787259),i=Nc(i,r,s,t,e[9],21,-343485551),n[0]=wp(t,n[0]),n[1]=wp(i,n[1]),n[2]=wp(r,n[2]),n[3]=wp(s,n[3])}function W5(n,e,t,i,r,s){return e=wp(wp(e,n),wp(i,s)),wp(e<<r|e>>>32-r,t)}function Dc(n,e,t,i,r,s,o){return W5(e&t|~e&i,n,e,r,s,o)}function jc(n,e,t,i,r,s,o){return W5(e&i|t&~i,n,e,r,s,o)}function Pc(n,e,t,i,r,s,o){return W5(e^t^i,n,e,r,s,o)}function Nc(n,e,t,i,r,s,o){return W5(t^(e|~i),n,e,r,s,o)}function E$(n){var e,t=n.length,i=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=n.length;e+=64)i4(i,tge(n.substring(e-64,e)));n=n.substring(e-64);var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<n.length;e++)r[e>>2]|=n.charCodeAt(e)<<(e%4<<3);if(r[e>>2]|=128<<(e%4<<3),e>55)for(i4(i,r),e=0;e<16;e++)r[e]=0;return r[14]=8*t,i4(i,r),i}function tge(n){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=n.charCodeAt(e)+(n.charCodeAt(e+1)<<8)+(n.charCodeAt(e+2)<<16)+(n.charCodeAt(e+3)<<24);return t}var jN="0123456789abcdef".split("");function nge(n){for(var e="",t=0;t<4;t++)e+=jN[n>>8*t+4&15]+jN[n>>8*t&15];return e}function ige(n){return String.fromCharCode(255&n,(65280&n)>>8,(16711680&n)>>16,(4278190080&n)>>24)}function LE(n){return E$(n).map(ige).join("")}var rge=(function(n){for(var e=0;e<n.length;e++)n[e]=nge(n[e]);return n.join("")})(E$("hello"))!="5d41402abc4b2a76b9719d911017c592";function wp(n,e){if(rge){var t=(65535&n)+(65535&e);return(n>>16)+(e>>16)+(t>>16)<<16|65535&t}return n+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function ME(n,e){var t,i,r,s;if(n!==t){for(var o=(r=n,s=1+(256/n.length|0),new Array(s+1).join(r)),a=[],l=0;l<256;l++)a[l]=l;var h=0;for(l=0;l<256;l++){var u=a[l];h=(h+u+o.charCodeAt(l))%256,a[l]=a[h],a[h]=u}t=n,i=a}else a=i;var d=e.length,A=0,f=0,p="";for(l=0;l<d;l++)f=(f+(u=a[A=(A+1)%256]))%256,a[A]=a[f],a[f]=u,o=a[(a[A]+a[f])%256],p+=String.fromCharCode(e.charCodeAt(l)^o);return p}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var PN={print:4,modify:8,copy:16,"annot-forms":32};function dm(n,e,t,i){this.v=1,this.r=2;var r=192;n.forEach(function(a){if(PN.perm!==void 0)throw new Error("Invalid permission: "+a);r+=PN[a]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var s=(e+this.padding).substr(0,32),o=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^r)),this.encryptionKey=LE(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(i)).substr(0,5),this.U=ME(this.encryptionKey,this.padding)}function Am(n){if(/[^\u0000-\u00ff]/.test(n))throw new Error("Invalid PDF Name Object: "+n+", Only accept ASCII characters.");for(var e="",t=n.length,i=0;i<t;i++){var r=n.charCodeAt(i);e+=r<33||r===35||r===37||r===40||r===41||r===47||r===60||r===62||r===91||r===93||r===123||r===125||r>126?"#"+("0"+r.toString(16)).slice(-2):n[i]}return e}function NN(n){if(go(n)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,i,r){if(r=r||!1,typeof t!="string"||typeof i!="function"||typeof r!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var s=Math.random().toString(35);return e[t][s]=[i,!!r],s},this.unsubscribe=function(t){for(var i in e)if(e[i][t])return delete e[i][t],Object.keys(e[i]).length===0&&delete e[i],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var i=Array.prototype.slice.call(arguments,1),r=[];for(var s in e[t]){var o=e[t][s];try{o[0].apply(n,i)}catch(a){Lr.console&&Po.error("jsPDF PubSub Error",a.message,a)}o[1]&&r.push(s)}r.length&&r.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function l0(n){if(!(this instanceof l0))return new l0(n);var e="opacity,stroke-opacity".split(",");for(var t in n)n.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=n[t]);this.id="",this.objectNumber=-1}function F$(n,e){this.gState=n,this.matrix=e,this.id="",this.objectNumber=-1}function Ap(n,e,t,i,r){if(!(this instanceof Ap))return new Ap(n,e,t,i,r);this.type=n==="axial"?2:3,this.coords=e,this.colors=t,F$.call(this,i,r)}function Ng(n,e,t,i,r){if(!(this instanceof Ng))return new Ng(n,e,t,i,r);this.boundingBox=n,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,F$.call(this,i,r)}function qi(n){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",i=arguments[1],r=arguments[2],s=arguments[3],o=[],a=1,l=16,h="S",u=null;go(n=n||{})==="object"&&(t=n.orientation,i=n.unit||i,r=n.format||r,s=n.compress||n.compressPdf||s,(u=n.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),a=typeof n.userUnit=="number"?Math.abs(n.userUnit):1,n.precision!==void 0&&(e=n.precision),n.floatPrecision!==void 0&&(l=n.floatPrecision),h=n.defaultPathOperation||"S"),o=n.filters||(s===!0?["FlateEncode"]:o),i=i||"mm",t=(""+(t||"P")).toLowerCase();var d=n.putOnlyUsedFonts||!1,A={},f={internal:{},__private__:{}};f.__private__.PubSub=NN;var p="1.3",g=f.__private__.getPdfVersion=function(){return p};f.__private__.setPdfVersion=function(re){p=re};var v={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return v};var w=f.__private__.getPageFormat=function(re){return v[re]};r=r||"a4";var m="compat",y="advanced",x=m;function S(){this.saveGraphicsState(),Z(new vt(He,0,0,-He,0,Hr()*He).toString()+" cm"),this.setFontSize(this.getFontSize()/He),h="n",x=y}function I(){this.restoreGraphicsState(),h="S",x=m}var j=f.__private__.combineFontStyleAndFontWeight=function(re,be){if(re=="bold"&&be=="normal"||re=="bold"&&be==400||re=="normal"&&be=="italic"||re=="bold"&&be=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return be&&(re=be==400||be==="normal"?re==="italic"?"italic":"normal":be!=700&&be!=="bold"||re!=="normal"?(be==700?"bold":be)+""+re:"bold"),re};f.advancedAPI=function(re){var be=x===m;return be&&S.call(this),typeof re!="function"||(re(this),be&&I.call(this)),this},f.compatAPI=function(re){var be=x===y;return be&&I.call(this),typeof re!="function"||(re(this),be&&S.call(this)),this},f.isAdvancedAPI=function(){return x===y};var C,b=function(re){if(x!==y)throw new Error(re+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},D=f.roundToPrecision=f.__private__.roundToPrecision=function(re,be){var Ue=e||be;if(isNaN(re)||isNaN(Ue))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return re.toFixed(Ue).replace(/0+$/,"")};C=f.hpf=f.__private__.hpf=typeof l=="number"?function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.hpf");return D(re,l)}:l==="smart"?function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.hpf");return D(re,re>-1&&re<1?16:5)}:function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.hpf");return D(re,16)};var T=f.f2=f.__private__.f2=function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.f2");return D(re,2)},k=f.__private__.f3=function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.f3");return D(re,3)},B=f.scale=f.__private__.scale=function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.scale");return x===m?re*He:x===y?re:void 0},E=function(re){return B((function(be){return x===m?Hr()-be:x===y?be:void 0})(re))};f.__private__.setPrecision=f.setPrecision=function(re){typeof parseInt(re,10)=="number"&&(e=parseInt(re,10))};var z,te="00000000000000000000000000000000",L=f.__private__.getFileId=function(){return te},O=f.__private__.setFileId=function(re){return te=re!==void 0&&/^[a-fA-F0-9]{32}$/.test(re)?re.toUpperCase():te.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(Bn=new dm(u.userPermissions,u.userPassword,u.ownerPassword,te)),te};f.setFileId=function(re){return O(re),this},f.getFileId=function(){return L()};var J=f.__private__.convertDateToPDFDate=function(re){var be=re.getTimezoneOffset(),Ue=be<0?"+":"-",ut=Math.floor(Math.abs(be/60)),yt=Math.abs(be%60),en=[Ue,V(ut),"'",V(yt),"'"].join("");return["D:",re.getFullYear(),V(re.getMonth()+1),V(re.getDate()),V(re.getHours()),V(re.getMinutes()),V(re.getSeconds()),en].join("")},$=f.__private__.convertPDFDateToDate=function(re){var be=parseInt(re.substr(2,4),10),Ue=parseInt(re.substr(6,2),10)-1,ut=parseInt(re.substr(8,2),10),yt=parseInt(re.substr(10,2),10),en=parseInt(re.substr(12,2),10),cn=parseInt(re.substr(14,2),10);return new Date(be,Ue,ut,yt,en,cn,0)},U=f.__private__.setCreationDate=function(re){var be;if(re===void 0&&(re=new Date),re instanceof Date)be=J(re);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(re))throw new Error("Invalid argument passed to jsPDF.setCreationDate");be=re}return z=be},Y=f.__private__.getCreationDate=function(re){var be=z;return re==="jsDate"&&(be=$(z)),be};f.setCreationDate=function(re){return U(re),this},f.getCreationDate=function(re){return Y(re)};var K,V=f.__private__.padd2=function(re){return("0"+parseInt(re)).slice(-2)},Q=f.__private__.padd2Hex=function(re){return("00"+(re=re.toString())).substr(re.length)},X=0,W=[],se=[],q=0,de=[],Ce=[],Se=!1,fe=se;f.__private__.setCustomOutputDestination=function(re){Se=!0,fe=re};var M=function(re){Se||(fe=re)};f.__private__.resetCustomOutputDestination=function(){Se=!1,fe=se};var Z=f.__private__.out=function(re){return re=re.toString(),q+=re.length+1,fe.push(re),fe},Ae=f.__private__.write=function(re){return Z(arguments.length===1?re.toString():Array.prototype.join.call(arguments," "))},ie=f.__private__.getArrayBuffer=function(re){for(var be=re.length,Ue=new ArrayBuffer(be),ut=new Uint8Array(Ue);be--;)ut[be]=re.charCodeAt(be);return Ue},ee=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return ee};var ae=n.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(re){return ae=x===y?re/He:re,this};var me,_e=f.__private__.getFontSize=f.getFontSize=function(){return x===m?ae:ae*He},ue=n.R2L||!1;f.__private__.setR2L=f.setR2L=function(re){return ue=re,this},f.__private__.getR2L=f.getR2L=function(){return ue};var Be,it=f.__private__.setZoomMode=function(re){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(re))me=re;else if(isNaN(re)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(re)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+re+'" is not recognized.');me=re}else me=parseInt(re,10)};f.__private__.getZoomMode=function(){return me};var De,qe=f.__private__.setPageMode=function(re){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(re)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+re+'" is not recognized.');Be=re};f.__private__.getPageMode=function(){return Be};var Je=f.__private__.setLayoutMode=function(re){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(re)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+re+'" is not recognized.');De=re};f.__private__.getLayoutMode=function(){return De},f.__private__.setDisplayMode=f.setDisplayMode=function(re,be,Ue){return it(re),Je(be),qe(Ue),this};var Me={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(re){if(Object.keys(Me).indexOf(re)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Me[re]},f.__private__.getDocumentProperties=function(){return Me},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(re){for(var be in Me)Me.hasOwnProperty(be)&&re[be]&&(Me[be]=re[be]);return this},f.__private__.setDocumentProperty=function(re,be){if(Object.keys(Me).indexOf(re)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Me[re]=be};var et,He,ze,Oe,ke,je={},rt={},_t=[],Ee={},Le={},ye={},Ze={},nt=null,st=0,At=[],ft=new NN(f),Xt=n.hotfixes||[],Yt={},Zt={},sn=[],vt=function re(be,Ue,ut,yt,en,cn){if(!(this instanceof re))return new re(be,Ue,ut,yt,en,cn);isNaN(be)&&(be=1),isNaN(Ue)&&(Ue=0),isNaN(ut)&&(ut=0),isNaN(yt)&&(yt=1),isNaN(en)&&(en=0),isNaN(cn)&&(cn=0),this._matrix=[be,Ue,ut,yt,en,cn]};Object.defineProperty(vt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(re){this._matrix[0]=re}}),Object.defineProperty(vt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(re){this._matrix[1]=re}}),Object.defineProperty(vt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(re){this._matrix[2]=re}}),Object.defineProperty(vt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(re){this._matrix[3]=re}}),Object.defineProperty(vt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(re){this._matrix[4]=re}}),Object.defineProperty(vt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(re){this._matrix[5]=re}}),Object.defineProperty(vt.prototype,"a",{get:function(){return this._matrix[0]},set:function(re){this._matrix[0]=re}}),Object.defineProperty(vt.prototype,"b",{get:function(){return this._matrix[1]},set:function(re){this._matrix[1]=re}}),Object.defineProperty(vt.prototype,"c",{get:function(){return this._matrix[2]},set:function(re){this._matrix[2]=re}}),Object.defineProperty(vt.prototype,"d",{get:function(){return this._matrix[3]},set:function(re){this._matrix[3]=re}}),Object.defineProperty(vt.prototype,"e",{get:function(){return this._matrix[4]},set:function(re){this._matrix[4]=re}}),Object.defineProperty(vt.prototype,"f",{get:function(){return this._matrix[5]},set:function(re){this._matrix[5]=re}}),Object.defineProperty(vt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(vt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(vt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(vt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),vt.prototype.join=function(re){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(C).join(re)},vt.prototype.multiply=function(re){var be=re.sx*this.sx+re.shy*this.shx,Ue=re.sx*this.shy+re.shy*this.sy,ut=re.shx*this.sx+re.sy*this.shx,yt=re.shx*this.shy+re.sy*this.sy,en=re.tx*this.sx+re.ty*this.shx+this.tx,cn=re.tx*this.shy+re.ty*this.sy+this.ty;return new vt(be,Ue,ut,yt,en,cn)},vt.prototype.decompose=function(){var re=this.sx,be=this.shy,Ue=this.shx,ut=this.sy,yt=this.tx,en=this.ty,cn=Math.sqrt(re*re+be*be),Tn=(re/=cn)*Ue+(be/=cn)*ut;Ue-=re*Tn,ut-=be*Tn;var $n=Math.sqrt(Ue*Ue+ut*ut);return Tn/=$n,re*(ut/=$n)<be*(Ue/=$n)&&(re=-re,be=-be,Tn=-Tn,cn=-cn),{scale:new vt(cn,0,0,$n,0,0),translate:new vt(1,0,0,1,yt,en),rotate:new vt(re,be,-be,re,0,0),skew:new vt(1,0,Tn,1,0,0)}},vt.prototype.toString=function(re){return this.join(" ")},vt.prototype.inversed=function(){var re=this.sx,be=this.shy,Ue=this.shx,ut=this.sy,yt=this.tx,en=this.ty,cn=1/(re*ut-be*Ue),Tn=ut*cn,$n=-be*cn,ai=-Ue*cn,ni=re*cn;return new vt(Tn,$n,ai,ni,-Tn*yt-ai*en,-$n*yt-ni*en)},vt.prototype.applyToPoint=function(re){var be=re.x*this.sx+re.y*this.shx+this.tx,Ue=re.x*this.shy+re.y*this.sy+this.ty;return new fi(be,Ue)},vt.prototype.applyToRectangle=function(re){var be=this.applyToPoint(re),Ue=this.applyToPoint(new fi(re.x+re.w,re.y+re.h));return new Ki(be.x,be.y,Ue.x-be.x,Ue.y-be.y)},vt.prototype.clone=function(){var re=this.sx,be=this.shy,Ue=this.shx,ut=this.sy,yt=this.tx,en=this.ty;return new vt(re,be,Ue,ut,yt,en)},f.Matrix=vt;var Ye=f.matrixMult=function(re,be){return be.multiply(re)},Gt=new vt(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=Gt;var Wt=function(re,be){if(!Le[re]){var Ue=(be instanceof Ap?"Sh":"P")+(Object.keys(Ee).length+1).toString(10);be.id=Ue,Le[re]=Ue,Ee[Ue]=be,ft.publish("addPattern",be)}};f.ShadingPattern=Ap,f.TilingPattern=Ng,f.addShadingPattern=function(re,be){return b("addShadingPattern()"),Wt(re,be),this},f.beginTilingPattern=function(re){b("beginTilingPattern()"),Ci(re.boundingBox[0],re.boundingBox[1],re.boundingBox[2]-re.boundingBox[0],re.boundingBox[3]-re.boundingBox[1],re.matrix)},f.endTilingPattern=function(re,be){b("endTilingPattern()"),be.stream=Ce[K].join(`
`),Wt(re,be),ft.publish("endTilingPattern",be),sn.pop().restore()};var Vt,Jt=f.__private__.newObject=function(){var re=It();return Ut(re,!0),re},It=f.__private__.newObjectDeferred=function(){return X++,W[X]=function(){return q},X},Ut=function(re,be){return be=typeof be=="boolean"&&be,W[re]=q,be&&Z(re+" 0 obj"),re},un=f.__private__.newAdditionalObject=function(){var re={objId:It(),content:""};return de.push(re),re},Sn=It(),jt=It(),fn=f.__private__.decodeColorString=function(re){var be=re.split(" ");if(be.length!==2||be[1]!=="g"&&be[1]!=="G")be.length!==5||be[4]!=="k"&&be[4]!=="K"||(be=[(1-be[0])*(1-be[3]),(1-be[1])*(1-be[3]),(1-be[2])*(1-be[3]),"r"]);else{var Ue=parseFloat(be[0]);be=[Ue,Ue,Ue,"r"]}for(var ut="#",yt=0;yt<3;yt++)ut+=("0"+Math.floor(255*parseFloat(be[yt])).toString(16)).slice(-2);return ut},Zn=f.__private__.encodeColorString=function(re){var be;typeof re=="string"&&(re={ch1:re});var Ue=re.ch1,ut=re.ch2,yt=re.ch3,en=re.ch4,cn=re.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Ue=="string"&&Ue.charAt(0)!=="#"){var Tn=new B$(Ue);if(Tn.ok)Ue=Tn.toHex();else if(!/^\d*\.?\d*$/.test(Ue))throw new Error('Invalid color "'+Ue+'" passed to jsPDF.encodeColorString.')}if(typeof Ue=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Ue)&&(Ue="#"+Ue[1]+Ue[1]+Ue[2]+Ue[2]+Ue[3]+Ue[3]),typeof Ue=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Ue)){var $n=parseInt(Ue.substr(1),16);Ue=$n>>16&255,ut=$n>>8&255,yt=255&$n}if(ut===void 0||en===void 0&&Ue===ut&&ut===yt)be=typeof Ue=="string"?Ue+" "+cn[0]:re.precision===2?T(Ue/255)+" "+cn[0]:k(Ue/255)+" "+cn[0];else if(en===void 0||go(en)==="object"){if(en&&!isNaN(en.a)&&en.a===0)return["1.","1.","1.",cn[1]].join(" ");be=typeof Ue=="string"?[Ue,ut,yt,cn[1]].join(" "):re.precision===2?[T(Ue/255),T(ut/255),T(yt/255),cn[1]].join(" "):[k(Ue/255),k(ut/255),k(yt/255),cn[1]].join(" ")}else be=typeof Ue=="string"?[Ue,ut,yt,en,cn[2]].join(" "):re.precision===2?[T(Ue),T(ut),T(yt),T(en),cn[2]].join(" "):[k(Ue),k(ut),k(yt),k(en),cn[2]].join(" ");return be},Hn=f.__private__.getFilters=function(){return o},ti=f.__private__.putStream=function(re){var be=(re=re||{}).data||"",Ue=re.filters||Hn(),ut=re.alreadyAppliedFilters||[],yt=re.addLength1||!1,en=be.length,cn=re.objectId,Tn=function(vs){return vs};if(u!==null&&cn===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(Tn=Bn.encryptor(cn,0));var $n={};Ue===!0&&(Ue=["FlateEncode"]);var ai=re.additionalKeyValues||[],ni=($n=qi.API.processDataByFilters!==void 0?qi.API.processDataByFilters(be,Ue):{data:be,reverseChain:[]}).reverseChain+(Array.isArray(ut)?ut.join(" "):ut.toString());if($n.data.length!==0&&(ai.push({key:"Length",value:$n.data.length}),yt===!0&&ai.push({key:"Length1",value:en})),ni.length!=0)if(ni.split("/").length-1==1)ai.push({key:"Filter",value:ni});else{ai.push({key:"Filter",value:"["+ni+"]"});for(var Rn=0;Rn<ai.length;Rn+=1)if(ai[Rn].key==="DecodeParms"){for(var sr=[],dr=0;dr<$n.reverseChain.split("/").length-1;dr+=1)sr.push("null");sr.push(ai[Rn].value),ai[Rn].value="["+sr.join(" ")+"]"}}Z("<<");for(var qr=0;qr<ai.length;qr++)Z("/"+ai[qr].key+" "+ai[qr].value);Z(">>"),$n.data.length!==0&&(Z("stream"),Z(Tn($n.data)),Z("endstream"))},ri=f.__private__.putPage=function(re){var be=re.number,Ue=re.data,ut=re.objId,yt=re.contentsObjId;Ut(ut,!0),Z("<</Type /Page"),Z("/Parent "+re.rootDictionaryObjId+" 0 R"),Z("/Resources "+re.resourceDictionaryObjId+" 0 R"),Z("/MediaBox ["+parseFloat(C(re.mediaBox.bottomLeftX))+" "+parseFloat(C(re.mediaBox.bottomLeftY))+" "+C(re.mediaBox.topRightX)+" "+C(re.mediaBox.topRightY)+"]"),re.cropBox!==null&&Z("/CropBox ["+C(re.cropBox.bottomLeftX)+" "+C(re.cropBox.bottomLeftY)+" "+C(re.cropBox.topRightX)+" "+C(re.cropBox.topRightY)+"]"),re.bleedBox!==null&&Z("/BleedBox ["+C(re.bleedBox.bottomLeftX)+" "+C(re.bleedBox.bottomLeftY)+" "+C(re.bleedBox.topRightX)+" "+C(re.bleedBox.topRightY)+"]"),re.trimBox!==null&&Z("/TrimBox ["+C(re.trimBox.bottomLeftX)+" "+C(re.trimBox.bottomLeftY)+" "+C(re.trimBox.topRightX)+" "+C(re.trimBox.topRightY)+"]"),re.artBox!==null&&Z("/ArtBox ["+C(re.artBox.bottomLeftX)+" "+C(re.artBox.bottomLeftY)+" "+C(re.artBox.topRightX)+" "+C(re.artBox.topRightY)+"]"),typeof re.userUnit=="number"&&re.userUnit!==1&&Z("/UserUnit "+re.userUnit),ft.publish("putPage",{objId:ut,pageContext:At[be],pageNumber:be,page:Ue}),Z("/Contents "+yt+" 0 R"),Z(">>"),Z("endobj");var en=Ue.join(`
`);return x===y&&(en+=`
Q`),Ut(yt,!0),ti({data:en,filters:Hn(),objectId:yt}),Z("endobj"),ut},bi=f.__private__.putPages=function(){var re,be,Ue=[];for(re=1;re<=st;re++)At[re].objId=It(),At[re].contentsObjId=It();for(re=1;re<=st;re++)Ue.push(ri({number:re,data:Ce[re],objId:At[re].objId,contentsObjId:At[re].contentsObjId,mediaBox:At[re].mediaBox,cropBox:At[re].cropBox,bleedBox:At[re].bleedBox,trimBox:At[re].trimBox,artBox:At[re].artBox,userUnit:At[re].userUnit,rootDictionaryObjId:Sn,resourceDictionaryObjId:jt}));Ut(Sn,!0),Z("<</Type /Pages");var ut="/Kids [";for(be=0;be<st;be++)ut+=Ue[be]+" 0 R ";Z(ut+"]"),Z("/Count "+st),Z(">>"),Z("endobj"),ft.publish("postPutPages")},Ni=function(re){ft.publish("putFont",{font:re,out:Z,newObject:Jt,putStream:ti}),re.isAlreadyPutted!==!0&&(re.objectNumber=Jt(),Z("<<"),Z("/Type /Font"),Z("/BaseFont /"+Am(re.postScriptName)),Z("/Subtype /Type1"),typeof re.encoding=="string"&&Z("/Encoding /"+re.encoding),Z("/FirstChar 32"),Z("/LastChar 255"),Z(">>"),Z("endobj"))},ui=function(re){re.objectNumber=Jt();var be=[];be.push({key:"Type",value:"/XObject"}),be.push({key:"Subtype",value:"/Form"}),be.push({key:"BBox",value:"["+[C(re.x),C(re.y),C(re.x+re.width),C(re.y+re.height)].join(" ")+"]"}),be.push({key:"Matrix",value:"["+re.matrix.toString()+"]"});var Ue=re.pages[1].join(`
`);ti({data:Ue,additionalKeyValues:be,objectId:re.objectNumber}),Z("endobj")},si=function(re,be){be||(be=21);var Ue=Jt(),ut=(function(cn,Tn){var $n,ai=[],ni=1/(Tn-1);for($n=0;$n<1;$n+=ni)ai.push($n);if(ai.push(1),cn[0].offset!=0){var Rn={offset:0,color:cn[0].color};cn.unshift(Rn)}if(cn[cn.length-1].offset!=1){var sr={offset:1,color:cn[cn.length-1].color};cn.push(sr)}for(var dr="",qr=0,vs=0;vs<ai.length;vs++){for($n=ai[vs];$n>cn[qr+1].offset;)qr++;var Cr=cn[qr].offset,cs=($n-Cr)/(cn[qr+1].offset-Cr),Qr=cn[qr].color,or=cn[qr+1].color;dr+=Q(Math.round((1-cs)*Qr[0]+cs*or[0]).toString(16))+Q(Math.round((1-cs)*Qr[1]+cs*or[1]).toString(16))+Q(Math.round((1-cs)*Qr[2]+cs*or[2]).toString(16))}return dr.trim()})(re.colors,be),yt=[];yt.push({key:"FunctionType",value:"0"}),yt.push({key:"Domain",value:"[0.0 1.0]"}),yt.push({key:"Size",value:"["+be+"]"}),yt.push({key:"BitsPerSample",value:"8"}),yt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),yt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ti({data:ut,additionalKeyValues:yt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Ue}),Z("endobj"),re.objectNumber=Jt(),Z("<< /ShadingType "+re.type),Z("/ColorSpace /DeviceRGB");var en="/Coords ["+C(parseFloat(re.coords[0]))+" "+C(parseFloat(re.coords[1]))+" ";re.type===2?en+=C(parseFloat(re.coords[2]))+" "+C(parseFloat(re.coords[3])):en+=C(parseFloat(re.coords[2]))+" "+C(parseFloat(re.coords[3]))+" "+C(parseFloat(re.coords[4]))+" "+C(parseFloat(re.coords[5])),Z(en+="]"),re.matrix&&Z("/Matrix ["+re.matrix.toString()+"]"),Z("/Function "+Ue+" 0 R"),Z("/Extend [true true]"),Z(">>"),Z("endobj")},Li=function(re,be){var Ue=It(),ut=Jt();be.push({resourcesOid:Ue,objectOid:ut}),re.objectNumber=ut;var yt=[];yt.push({key:"Type",value:"/Pattern"}),yt.push({key:"PatternType",value:"1"}),yt.push({key:"PaintType",value:"1"}),yt.push({key:"TilingType",value:"1"}),yt.push({key:"BBox",value:"["+re.boundingBox.map(C).join(" ")+"]"}),yt.push({key:"XStep",value:C(re.xStep)}),yt.push({key:"YStep",value:C(re.yStep)}),yt.push({key:"Resources",value:Ue+" 0 R"}),re.matrix&&yt.push({key:"Matrix",value:"["+re.matrix.toString()+"]"}),ti({data:re.stream,additionalKeyValues:yt,objectId:re.objectNumber}),Z("endobj")},Tr=function(re){for(var be in re.objectNumber=Jt(),Z("<<"),re)switch(be){case"opacity":Z("/ca "+T(re[be]));break;case"stroke-opacity":Z("/CA "+T(re[be]))}Z(">>"),Z("endobj")},xr=function(re){Ut(re.resourcesOid,!0),Z("<<"),Z("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var be in Z("/Font <<"),je)je.hasOwnProperty(be)&&(d===!1||d===!0&&A.hasOwnProperty(be))&&Z("/"+be+" "+je[be].objectNumber+" 0 R");Z(">>")})(),(function(){if(Object.keys(Ee).length>0){for(var be in Z("/Shading <<"),Ee)Ee.hasOwnProperty(be)&&Ee[be]instanceof Ap&&Ee[be].objectNumber>=0&&Z("/"+be+" "+Ee[be].objectNumber+" 0 R");ft.publish("putShadingPatternDict"),Z(">>")}})(),(function(be){if(Object.keys(Ee).length>0){for(var Ue in Z("/Pattern <<"),Ee)Ee.hasOwnProperty(Ue)&&Ee[Ue]instanceof f.TilingPattern&&Ee[Ue].objectNumber>=0&&Ee[Ue].objectNumber<be&&Z("/"+Ue+" "+Ee[Ue].objectNumber+" 0 R");ft.publish("putTilingPatternDict"),Z(">>")}})(re.objectOid),(function(){if(Object.keys(ye).length>0){var be;for(be in Z("/ExtGState <<"),ye)ye.hasOwnProperty(be)&&ye[be].objectNumber>=0&&Z("/"+be+" "+ye[be].objectNumber+" 0 R");ft.publish("putGStateDict"),Z(">>")}})(),(function(){for(var be in Z("/XObject <<"),Yt)Yt.hasOwnProperty(be)&&Yt[be].objectNumber>=0&&Z("/"+be+" "+Yt[be].objectNumber+" 0 R");ft.publish("putXobjectDict"),Z(">>")})(),Z(">>"),Z("endobj")},br=function(re){rt[re.fontName]=rt[re.fontName]||{},rt[re.fontName][re.fontStyle]=re.id},vn=function(re,be,Ue,ut,yt){var en={id:"F"+(Object.keys(je).length+1).toString(10),postScriptName:re,fontName:be,fontStyle:Ue,encoding:ut,isStandardFont:yt||!1,metadata:{}};return ft.publish("addFont",{font:en,instance:this}),je[en.id]=en,br(en),en.id},wi=f.__private__.pdfEscape=f.pdfEscape=function(re,be){return(function(Ue,ut){var yt,en,cn,Tn,$n,ai,ni,Rn,sr;if(cn=(ut=ut||{}).sourceEncoding||"Unicode",$n=ut.outputEncoding,(ut.autoencode||$n)&&je[et].metadata&&je[et].metadata[cn]&&je[et].metadata[cn].encoding&&(Tn=je[et].metadata[cn].encoding,!$n&&je[et].encoding&&($n=je[et].encoding),!$n&&Tn.codePages&&($n=Tn.codePages[0]),typeof $n=="string"&&($n=Tn[$n]),$n)){for(ni=!1,ai=[],yt=0,en=Ue.length;yt<en;yt++)(Rn=$n[Ue.charCodeAt(yt)])?ai.push(String.fromCharCode(Rn)):ai.push(Ue[yt]),ai[yt].charCodeAt(0)>>8&&(ni=!0);Ue=ai.join("")}for(yt=Ue.length;ni===void 0&&yt!==0;)Ue.charCodeAt(yt-1)>>8&&(ni=!0),yt--;if(!ni)return Ue;for(ai=ut.noBOM?[]:[254,255],yt=0,en=Ue.length;yt<en;yt++){if((sr=(Rn=Ue.charCodeAt(yt))>>8)>>8)throw new Error("Character at position "+yt+" of string '"+Ue+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");ai.push(sr),ai.push(Rn-(sr<<8))}return String.fromCharCode.apply(void 0,ai)})(re,be).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ve=f.__private__.beginPage=function(re){Ce[++st]=[],At[st]={objId:0,contentsObjId:0,userUnit:Number(a),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(re[0]),topRightY:Number(re[1])}},An(st),M(Ce[K])},ct=function(re,be){var Ue,ut,yt;switch(t=be||t,typeof re=="string"&&(Ue=w(re.toLowerCase()),Array.isArray(Ue)&&(ut=Ue[0],yt=Ue[1])),Array.isArray(re)&&(ut=re[0]*He,yt=re[1]*He),isNaN(ut)&&(ut=r[0],yt=r[1]),(ut>14400||yt>14400)&&(Po.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ut=Math.min(14400,ut),yt=Math.min(14400,yt)),r=[ut,yt],t.substr(0,1)){case"l":yt>ut&&(r=[yt,ut]);break;case"p":ut>yt&&(r=[yt,ut])}Ve(r),pt(Ke),Z(gt),Wn!==0&&Z(Wn+" J"),xn!==0&&Z(xn+" j"),ft.publish("addPage",{pageNumber:st})},mt=function(re){re>0&&re<=st&&(Ce.splice(re,1),At.splice(re,1),st--,K>st&&(K=st),this.setPage(K))},An=function(re){re>0&&re<=st&&(K=re)},nn=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return Ce.length-1},zt=function(re,be,Ue){var ut,yt=void 0;return Ue=Ue||{},re=re!==void 0?re:je[et].fontName,be=be!==void 0?be:je[et].fontStyle,ut=re.toLowerCase(),rt[ut]!==void 0&&rt[ut][be]!==void 0?yt=rt[ut][be]:rt[re]!==void 0&&rt[re][be]!==void 0?yt=rt[re][be]:Ue.disableWarning===!1&&Po.warn("Unable to look up font label for font '"+re+"', '"+be+"'. Refer to getFontList() for available fonts."),yt||Ue.noFallback||(yt=rt.times[be])==null&&(yt=rt.times.normal),yt},gn=f.__private__.putInfo=function(){var re=Jt(),be=function(ut){return ut};for(var Ue in u!==null&&(be=Bn.encryptor(re,0)),Z("<<"),Z("/Producer ("+wi(be("jsPDF "+qi.version))+")"),Me)Me.hasOwnProperty(Ue)&&Me[Ue]&&Z("/"+Ue.substr(0,1).toUpperCase()+Ue.substr(1)+" ("+wi(be(Me[Ue]))+")");Z("/CreationDate ("+wi(be(z))+")"),Z(">>"),Z("endobj")},Jn=f.__private__.putCatalog=function(re){var be=(re=re||{}).rootDictionaryObjId||Sn;switch(Jt(),Z("<<"),Z("/Type /Catalog"),Z("/Pages "+be+" 0 R"),me||(me="fullwidth"),me){case"fullwidth":Z("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Z("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Z("/OpenAction [3 0 R /Fit]");break;case"original":Z("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Ue=""+me;Ue.substr(Ue.length-1)==="%"&&(me=parseInt(me)/100),typeof me=="number"&&Z("/OpenAction [3 0 R /XYZ null null "+T(me)+"]")}switch(De||(De="continuous"),De){case"continuous":Z("/PageLayout /OneColumn");break;case"single":Z("/PageLayout /SinglePage");break;case"two":case"twoleft":Z("/PageLayout /TwoColumnLeft");break;case"tworight":Z("/PageLayout /TwoColumnRight")}Be&&Z("/PageMode /"+Be),ft.publish("putCatalog"),Z(">>"),Z("endobj")},Qn=f.__private__.putTrailer=function(){Z("trailer"),Z("<<"),Z("/Size "+(X+1)),Z("/Root "+X+" 0 R"),Z("/Info "+(X-1)+" 0 R"),u!==null&&Z("/Encrypt "+Bn.oid+" 0 R"),Z("/ID [ <"+te+"> <"+te+"> ]"),Z(">>")},pn=f.__private__.putHeader=function(){Z("%PDF-"+p),Z("%ºß¬à")},Ln=f.__private__.putXRef=function(){var re="0000000000";Z("xref"),Z("0 "+(X+1)),Z("0000000000 65535 f ");for(var be=1;be<=X;be++)typeof W[be]=="function"?Z((re+W[be]()).slice(-10)+" 00000 n "):W[be]!==void 0?Z((re+W[be]).slice(-10)+" 00000 n "):Z("0000000000 00000 n ")},Dn=f.__private__.buildDocument=function(){var re;X=0,q=0,se=[],W=[],de=[],Sn=It(),jt=It(),M(se),ft.publish("buildDocument"),pn(),bi(),(function(){ft.publish("putAdditionalObjects");for(var Ue=0;Ue<de.length;Ue++){var ut=de[Ue];Ut(ut.objId,!0),Z(ut.content),Z("endobj")}ft.publish("postPutAdditionalObjects")})(),re=[],(function(){for(var Ue in je)je.hasOwnProperty(Ue)&&(d===!1||d===!0&&A.hasOwnProperty(Ue))&&Ni(je[Ue])})(),(function(){var Ue;for(Ue in ye)ye.hasOwnProperty(Ue)&&Tr(ye[Ue])})(),(function(){for(var Ue in Yt)Yt.hasOwnProperty(Ue)&&ui(Yt[Ue])})(),(function(Ue){var ut;for(ut in Ee)Ee.hasOwnProperty(ut)&&(Ee[ut]instanceof Ap?si(Ee[ut]):Ee[ut]instanceof Ng&&Li(Ee[ut],Ue))})(re),ft.publish("putResources"),re.forEach(xr),xr({resourcesOid:jt,objectOid:Number.MAX_SAFE_INTEGER}),ft.publish("postPutResources"),u!==null&&(Bn.oid=Jt(),Z("<<"),Z("/Filter /Standard"),Z("/V "+Bn.v),Z("/R "+Bn.r),Z("/U <"+Bn.toHexString(Bn.U)+">"),Z("/O <"+Bn.toHexString(Bn.O)+">"),Z("/P "+Bn.P),Z(">>"),Z("endobj")),gn(),Jn();var be=q;return Ln(),Qn(),Z("startxref"),Z(""+be),Z("%%EOF"),M(Ce[K]),se.join(`
`)},ei=f.__private__.getBlob=function(re){return new Blob([ie(re)],{type:"application/pdf"})},xi=f.output=f.__private__.output=(Vt=function(re,be){switch(typeof(be=be||{})=="string"?be={filename:be}:be.filename=be.filename||"generated.pdf",re){case void 0:return Dn();case"save":f.save(be.filename);break;case"arraybuffer":return ie(Dn());case"blob":return ei(Dn());case"bloburi":case"bloburl":if(Lr.URL!==void 0&&typeof Lr.URL.createObjectURL=="function")return Lr.URL&&Lr.URL.createObjectURL(ei(Dn()))||void 0;Po.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Ue="",ut=Dn();try{Ue=DN(ut)}catch{Ue=DN(unescape(encodeURIComponent(ut)))}return"data:application/pdf;filename="+be.filename+";base64,"+Ue;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Lr)==="[object Window]"){var yt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",en=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';be.pdfObjectUrl&&(yt=be.pdfObjectUrl,en="");var cn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+yt+'"'+en+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(be)+");<\/script></body></html>",Tn=Lr.open();return Tn!==null&&Tn.document.write(cn),Tn}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Lr)==="[object Window]"){var $n='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(be.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+be.filename+'" width="500px" height="400px" /></body></html>',ai=Lr.open();if(ai!==null){ai.document.write($n);var ni=this;ai.document.documentElement.querySelector("#pdfViewer").onload=function(){ai.document.title=be.filename,ai.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(ni.output("bloburl"))}}return ai}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Lr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Rn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",be)+'"></iframe></body></html>',sr=Lr.open();if(sr!==null&&(sr.document.write(Rn),sr.document.title=be.filename),sr||typeof safari>"u")return sr;break;case"datauri":case"dataurl":return Lr.document.location.href=this.output("datauristring",be);default:return null}},Vt.foo=function(){try{return Vt.apply(this,arguments)}catch(Ue){var re=Ue.stack||"";~re.indexOf(" at ")&&(re=re.split(" at ")[1]);var be="Error in function "+re.split(`
`)[0].split("<")[0]+": "+Ue.message;if(!Lr.console)throw new Error(be);Lr.console.error(be,Ue),Lr.alert&&alert(be)}},Vt.foo.bar=Vt,Vt.foo),Yi=function(re){return Array.isArray(Xt)===!0&&Xt.indexOf(re)>-1};switch(i){case"pt":He=1;break;case"mm":He=72/25.4;break;case"cm":He=72/2.54;break;case"in":He=72;break;case"px":He=Yi("px_scaling")==1?.75:96/72;break;case"pc":case"em":He=12;break;case"ex":He=6;break;default:if(typeof i!="number")throw new Error("Invalid unit: "+i);He=i}var Bn=null;U(),O();var Ri=f.__private__.getPageInfo=f.getPageInfo=function(re){if(isNaN(re)||re%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:At[re].objId,pageNumber:re,pageContext:At[re]}},xt=f.__private__.getPageInfoByObjId=function(re){if(isNaN(re)||re%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var be in At)if(At[be].objId===re)break;return Ri(be)},Bt=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:At[K].objId,pageNumber:K,pageContext:At[K]}};f.addPage=function(){return ct.apply(this,arguments),this},f.setPage=function(){return An.apply(this,arguments),M.call(this,Ce[K]),this},f.insertPage=function(re){return this.addPage(),this.movePage(K,re),this},f.movePage=function(re,be){var Ue,ut;if(re>be){Ue=Ce[re],ut=At[re];for(var yt=re;yt>be;yt--)Ce[yt]=Ce[yt-1],At[yt]=At[yt-1];Ce[be]=Ue,At[be]=ut,this.setPage(be)}else if(re<be){Ue=Ce[re],ut=At[re];for(var en=re;en<be;en++)Ce[en]=Ce[en+1],At[en]=At[en+1];Ce[be]=Ue,At[be]=ut,this.setPage(be)}return this},f.deletePage=function(){return mt.apply(this,arguments),this},f.__private__.text=f.text=function(re,be,Ue,ut,yt){var en,cn,Tn,$n,ai,ni,Rn,sr,dr,qr=(ut=ut||{}).scope||this;if(typeof re=="number"&&typeof be=="number"&&(typeof Ue=="string"||Array.isArray(Ue))){var vs=Ue;Ue=be,be=re,re=vs}if(arguments[3]instanceof vt==0?(Tn=arguments[4],$n=arguments[5],go(Rn=arguments[3])==="object"&&Rn!==null||(typeof Tn=="string"&&($n=Tn,Tn=null),typeof Rn=="string"&&($n=Rn,Rn=null),typeof Rn=="number"&&(Tn=Rn,Rn=null),ut={flags:Rn,angle:Tn,align:$n})):(b("The transform parameter of text() with a Matrix value"),dr=yt),isNaN(be)||isNaN(Ue)||re==null)throw new Error("Invalid arguments passed to jsPDF.text");if(re.length===0)return qr;var Cr,cs="",Qr=typeof ut.lineHeightFactor=="number"?ut.lineHeightFactor:Re,or=qr.internal.scaleFactor;function hs(Ar){return Ar=Ar.split("	").join(Array(ut.TabLen||9).join(" ")),wi(Ar,Rn)}function us(Ar){for(var Os,wo=Ar.concat(),vo=[],ic=wo.length;ic--;)typeof(Os=wo.shift())=="string"?vo.push(Os):Array.isArray(Ar)&&(Os.length===1||Os[1]===void 0&&Os[2]===void 0)?vo.push(Os[0]):vo.push([Os[0],Os[1],Os[2]]);return vo}function Oo(Ar,Os){var wo;if(typeof Ar=="string")wo=Os(Ar)[0];else if(Array.isArray(Ar)){for(var vo,ic,Mh=Ar.concat(),Va=[],Ks=Mh.length;Ks--;)typeof(vo=Mh.shift())=="string"?Va.push(Os(vo)[0]):Array.isArray(vo)&&typeof vo[0]=="string"&&(ic=Os(vo[0],vo[1],vo[2]),Va.push([ic[0],ic[1],ic[2]]));wo=Va}return wo}var va=!1,Lh=!0;if(typeof re=="string")va=!0;else if(Array.isArray(re)){var xa=re.concat();cn=[];for(var N,ce=xa.length;ce--;)(typeof(N=xa.shift())!="string"||Array.isArray(N)&&typeof N[0]!="string")&&(Lh=!1);va=Lh}if(va===!1)throw new Error('Type of text must be string or Array. "'+re+'" is not recognized.');typeof re=="string"&&(re=re.match(/[\r?\n]/)?re.split(/\r\n|\r|\n/g):[re]);var we=ae/qr.internal.scaleFactor,Pe=we*(Qr-1);switch(ut.baseline){case"bottom":Ue-=Pe;break;case"top":Ue+=we-Pe;break;case"hanging":Ue+=we-2*Pe;break;case"middle":Ue+=we/2-Pe}if((ni=ut.maxWidth||0)>0&&(typeof re=="string"?re=qr.splitTextToSize(re,ni):Object.prototype.toString.call(re)==="[object Array]"&&(re=re.reduce(function(Ar,Os){return Ar.concat(qr.splitTextToSize(Os,ni))},[]))),en={text:re,x:be,y:Ue,options:ut,mutex:{pdfEscape:wi,activeFontKey:et,fonts:je,activeFontSize:ae}},ft.publish("preProcessText",en),re=en.text,Tn=(ut=en.options).angle,dr instanceof vt==0&&Tn&&typeof Tn=="number"){Tn*=Math.PI/180,ut.rotationDirection===0&&(Tn=-Tn),x===y&&(Tn=-Tn);var Nt=Math.cos(Tn),tn=Math.sin(Tn);dr=new vt(Nt,tn,-tn,Nt,0,0)}else Tn&&Tn instanceof vt&&(dr=Tn);x!==y||dr||(dr=Gt),(ai=ut.charSpace||Ot)!==void 0&&(cs+=C(B(ai))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(sr=ut.horizontalScale)!==void 0&&(cs+=C(100*sr)+` Tz
`),ut.lang;var Un=-1,is=ut.renderingMode!==void 0?ut.renderingMode:ut.stroke,ro=qr.internal.getCurrentPageInfo().pageContext;switch(is){case 0:case!1:case"fill":Un=0;break;case 1:case!0:case"stroke":Un=1;break;case 2:case"fillThenStroke":Un=2;break;case 3:case"invisible":Un=3;break;case 4:case"fillAndAddForClipping":Un=4;break;case 5:case"strokeAndAddPathForClipping":Un=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Un=6;break;case 7:case"addToPathForClipping":Un=7}var $r=ro.usedRenderingMode!==void 0?ro.usedRenderingMode:-1;Un!==-1?cs+=Un+` Tr
`:$r!==-1&&(cs+=`0 Tr
`),Un!==-1&&(ro.usedRenderingMode=Un),$n=ut.align||"left";var rs,Bs=ae*Qr,_l=qr.internal.pageSize.getWidth(),Bo=je[et];ai=ut.charSpace||Ot,ni=ut.maxWidth||0,Rn=Object.assign({autoencode:!0,noBOM:!0},ut.flags);var Ao=[],Ha=function(Ar){return qr.getStringUnitWidth(Ar,{font:Bo,charSpace:ai,fontSize:ae,doKerning:!1})*ae/or};if(Object.prototype.toString.call(re)==="[object Array]"){var Wa;cn=us(re),$n!=="left"&&(rs=cn.map(Ha));var dl,za=0;if($n==="right"){be-=rs[0],re=[],ce=cn.length;for(var ba=0;ba<ce;ba++)ba===0?(dl=at(be),Wa=dt(Ue)):(dl=B(za-rs[ba]),Wa=-Bs),re.push([cn[ba],dl,Wa]),za=rs[ba]}else if($n==="center"){be-=rs[0]/2,re=[],ce=cn.length;for(var Xc=0;Xc<ce;Xc++)Xc===0?(dl=at(be),Wa=dt(Ue)):(dl=B((za-rs[Xc])/2),Wa=-Bs),re.push([cn[Xc],dl,Wa]),za=rs[Xc]}else if($n==="left"){re=[],ce=cn.length;for(var Ou=0;Ou<ce;Ou++)re.push(cn[Ou])}else if($n==="justify"&&Bo.encoding==="Identity-H"){re=[],ce=cn.length,ni=ni!==0?ni:_l;for(var Qa=0,Vs=0;Vs<ce;Vs++)if(Wa=Vs===0?dt(Ue):-Bs,dl=Vs===0?at(be):Qa,Vs<ce-1){var Hu=B((ni-rs[Vs])/(cn[Vs].split(" ").length-1)),Cc=cn[Vs].split(" ");re.push([Cc[0]+" ",dl,Wa]),Qa=0;for(var Ll=1;Ll<Cc.length;Ll++){var su=(Ha(Cc[Ll-1]+" "+Cc[Ll])-Ha(Cc[Ll]))*or+Hu;Ll==Cc.length-1?re.push([Cc[Ll],su,0]):re.push([Cc[Ll]+" ",su,0]),Qa-=su}}else re.push([cn[Vs],dl,Wa]);re.push(["",Qa,0])}else{if($n!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(re=[],ce=cn.length,ni=ni!==0?ni:_l,Vs=0;Vs<ce;Vs++)Wa=Vs===0?dt(Ue):-Bs,dl=Vs===0?at(be):0,Vs<ce-1?Ao.push(C(B((ni-rs[Vs])/(cn[Vs].split(" ").length-1)))):Ao.push(0),re.push([cn[Vs],dl,Wa])}}(typeof ut.R2L=="boolean"?ut.R2L:ue)===!0&&(re=Oo(re,function(Ar,Os,wo){return[Ar.split("").reverse().join(""),Os,wo]})),en={text:re,x:be,y:Ue,options:ut,mutex:{pdfEscape:wi,activeFontKey:et,fonts:je,activeFontSize:ae}},ft.publish("postProcessText",en),re=en.text,Cr=en.mutex.isHex||!1;var gh=je[et].encoding;gh!=="WinAnsiEncoding"&&gh!=="StandardEncoding"||(re=Oo(re,function(Ar,Os,wo){return[hs(Ar),Os,wo]})),cn=us(re),re=[];for(var Ca,Yc,tc,$a=Array.isArray(cn[0])?1:0,_c="",Kc=function(Ar,Os,wo){var vo="";return wo instanceof vt?(wo=typeof ut.angle=="number"?Ye(wo,new vt(1,0,0,1,Ar,Os)):Ye(new vt(1,0,0,1,Ar,Os),wo),x===y&&(wo=Ye(new vt(1,0,0,-1,0,0),wo)),vo=wo.join(" ")+` Tm
`):vo=C(Ar)+" "+C(Os)+` Td
`,vo},Sl=0;Sl<cn.length;Sl++){switch(_c="",$a){case 1:tc=(Cr?"<":"(")+cn[Sl][0]+(Cr?">":")"),Ca=parseFloat(cn[Sl][1]),Yc=parseFloat(cn[Sl][2]);break;case 0:tc=(Cr?"<":"(")+cn[Sl]+(Cr?">":")"),Ca=at(be),Yc=dt(Ue)}Ao!==void 0&&Ao[Sl]!==void 0&&(_c=Ao[Sl]+` Tw
`),Sl===0?re.push(_c+Kc(Ca,Yc,dr)+tc):$a===0?re.push(_c+tc):$a===1&&re.push(_c+Kc(Ca,Yc,dr)+tc)}re=$a===0?re.join(` Tj
T* `):re.join(` Tj
`),re+=` Tj
`;var nc=`BT
/`;return nc+=et+" "+ae+` Tf
`,nc+=C(ae*Qr)+` TL
`,nc+=Yn+`
`,nc+=cs,nc+=re,Z(nc+="ET"),A[et]=!0,qr};var on=f.__private__.clip=f.clip=function(re){return Z(re==="evenodd"?"W*":"W"),this};f.clipEvenOdd=function(){return on("evenodd")},f.__private__.discardPath=f.discardPath=function(){return Z("n"),this};var ln=f.__private__.isValidStyle=function(re){var be=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(re)!==-1&&(be=!0),be};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(re){return ln(re)&&(h=re),this};var li=f.__private__.getStyle=f.getStyle=function(re){var be=h;switch(re){case"D":case"S":be="S";break;case"F":be="f";break;case"FD":case"DF":be="B";break;case"f":case"f*":case"B":case"B*":be=re}return be},hi=f.close=function(){return Z("h"),this};f.stroke=function(){return Z("S"),this},f.fill=function(re){return Ii("f",re),this},f.fillEvenOdd=function(re){return Ii("f*",re),this},f.fillStroke=function(re){return Ii("B",re),this},f.fillStrokeEvenOdd=function(re){return Ii("B*",re),this};var Ii=function(re,be){go(be)==="object"?Us(be,re):Z(re)},kr=function(re){re===null||x===y&&re===void 0||(re=li(re),Z(re))};function zr(re,be,Ue,ut,yt){var en=new Ng(be||this.boundingBox,Ue||this.xStep,ut||this.yStep,this.gState,yt||this.matrix);en.stream=this.stream;var cn=re+"$$"+this.cloneIndex+++"$$";return Wt(cn,en),en}var Us=function(re,be){var Ue=Le[re.key],ut=Ee[Ue];if(ut instanceof Ap)Z("q"),Z(io(be)),ut.gState&&f.setGState(ut.gState),Z(re.matrix.toString()+" cm"),Z("/"+Ue+" sh"),Z("Q");else if(ut instanceof Ng){var yt=new vt(1,0,0,-1,0,Hr());re.matrix&&(yt=yt.multiply(re.matrix||Gt),Ue=zr.call(ut,re.key,re.boundingBox,re.xStep,re.yStep,yt).id),Z("q"),Z("/Pattern cs"),Z("/"+Ue+" scn"),ut.gState&&f.setGState(ut.gState),Z(be),Z("Q")}},io=function(re){switch(re){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},ws=f.moveTo=function(re,be){return Z(C(B(re))+" "+C(E(be))+" m"),this},Ts=f.lineTo=function(re,be){return Z(C(B(re))+" "+C(E(be))+" l"),this},Mn=f.curveTo=function(re,be,Ue,ut,yt,en){return Z([C(B(re)),C(E(be)),C(B(Ue)),C(E(ut)),C(B(yt)),C(E(en)),"c"].join(" ")),this};f.__private__.line=f.line=function(re,be,Ue,ut,yt){if(isNaN(re)||isNaN(be)||isNaN(Ue)||isNaN(ut)||!ln(yt))throw new Error("Invalid arguments passed to jsPDF.line");return x===m?this.lines([[Ue-re,ut-be]],re,be,[1,1],yt||"S"):this.lines([[Ue-re,ut-be]],re,be,[1,1]).stroke()},f.__private__.lines=f.lines=function(re,be,Ue,ut,yt,en){var cn,Tn,$n,ai,ni,Rn,sr,dr,qr,vs,Cr,cs;if(typeof re=="number"&&(cs=Ue,Ue=be,be=re,re=cs),ut=ut||[1,1],en=en||!1,isNaN(be)||isNaN(Ue)||!Array.isArray(re)||!Array.isArray(ut)||!ln(yt)||typeof en!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(ws(be,Ue),cn=ut[0],Tn=ut[1],ai=re.length,vs=be,Cr=Ue,$n=0;$n<ai;$n++)(ni=re[$n]).length===2?(vs=ni[0]*cn+vs,Cr=ni[1]*Tn+Cr,Ts(vs,Cr)):(Rn=ni[0]*cn+vs,sr=ni[1]*Tn+Cr,dr=ni[2]*cn+vs,qr=ni[3]*Tn+Cr,vs=ni[4]*cn+vs,Cr=ni[5]*Tn+Cr,Mn(Rn,sr,dr,qr,vs,Cr));return en&&hi(),kr(yt),this},f.path=function(re){for(var be=0;be<re.length;be++){var Ue=re[be],ut=Ue.c;switch(Ue.op){case"m":ws(ut[0],ut[1]);break;case"l":Ts(ut[0],ut[1]);break;case"c":Mn.apply(this,ut);break;case"h":hi()}}return this},f.__private__.rect=f.rect=function(re,be,Ue,ut,yt){if(isNaN(re)||isNaN(be)||isNaN(Ue)||isNaN(ut)||!ln(yt))throw new Error("Invalid arguments passed to jsPDF.rect");return x===m&&(ut=-ut),Z([C(B(re)),C(E(be)),C(B(Ue)),C(B(ut)),"re"].join(" ")),kr(yt),this},f.__private__.triangle=f.triangle=function(re,be,Ue,ut,yt,en,cn){if(isNaN(re)||isNaN(be)||isNaN(Ue)||isNaN(ut)||isNaN(yt)||isNaN(en)||!ln(cn))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Ue-re,ut-be],[yt-Ue,en-ut],[re-yt,be-en]],re,be,[1,1],cn,!0),this},f.__private__.roundedRect=f.roundedRect=function(re,be,Ue,ut,yt,en,cn){if(isNaN(re)||isNaN(be)||isNaN(Ue)||isNaN(ut)||isNaN(yt)||isNaN(en)||!ln(cn))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Tn=4/3*(Math.SQRT2-1);return yt=Math.min(yt,.5*Ue),en=Math.min(en,.5*ut),this.lines([[Ue-2*yt,0],[yt*Tn,0,yt,en-en*Tn,yt,en],[0,ut-2*en],[0,en*Tn,-yt*Tn,en,-yt,en],[2*yt-Ue,0],[-yt*Tn,0,-yt,-en*Tn,-yt,-en],[0,2*en-ut],[0,-en*Tn,yt*Tn,-en,yt,-en]],re+yt,be,[1,1],cn,!0),this},f.__private__.ellipse=f.ellipse=function(re,be,Ue,ut,yt){if(isNaN(re)||isNaN(be)||isNaN(Ue)||isNaN(ut)||!ln(yt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var en=4/3*(Math.SQRT2-1)*Ue,cn=4/3*(Math.SQRT2-1)*ut;return ws(re+Ue,be),Mn(re+Ue,be-cn,re+en,be-ut,re,be-ut),Mn(re-en,be-ut,re-Ue,be-cn,re-Ue,be),Mn(re-Ue,be+cn,re-en,be+ut,re,be+ut),Mn(re+en,be+ut,re+Ue,be+cn,re+Ue,be),kr(yt),this},f.__private__.circle=f.circle=function(re,be,Ue,ut){if(isNaN(re)||isNaN(be)||isNaN(Ue)||!ln(ut))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(re,be,Ue,Ue,ut)},f.setFont=function(re,be,Ue){return Ue&&(be=j(be,Ue)),et=zt(re,be,{disableWarning:!1}),this};var ve=f.__private__.getFont=f.getFont=function(){return je[zt.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var re,be,Ue={};for(re in rt)if(rt.hasOwnProperty(re))for(be in Ue[re]=[],rt[re])rt[re].hasOwnProperty(be)&&Ue[re].push(be);return Ue},f.addFont=function(re,be,Ue,ut,yt){var en=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&en.indexOf(arguments[3])!==-1?yt=arguments[3]:arguments[3]&&en.indexOf(arguments[3])==-1&&(Ue=j(Ue,ut)),vn.call(this,re,be,Ue,yt=yt||"Identity-H")};var Re,Ke=n.lineWidth||.200025,Ge=f.__private__.getLineWidth=f.getLineWidth=function(){return Ke},pt=f.__private__.setLineWidth=f.setLineWidth=function(re){return Ke=re,Z(C(B(re))+" w"),this};f.__private__.setLineDash=qi.API.setLineDash=qi.API.setLineDashPattern=function(re,be){if(re=re||[],be=be||0,isNaN(be)||!Array.isArray(re))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return re=re.map(function(Ue){return C(B(Ue))}).join(" "),be=C(B(be)),Z("["+re+"] "+be+" d"),this};var Pt=f.__private__.getLineHeight=f.getLineHeight=function(){return ae*Re};f.__private__.getLineHeight=f.getLineHeight=function(){return ae*Re};var pe=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(re){return typeof(re=re||1.15)=="number"&&(Re=re),this},xe=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return Re};pe(n.lineHeight);var at=f.__private__.getHorizontalCoordinate=function(re){return B(re)},dt=f.__private__.getVerticalCoordinate=function(re){return x===y?re:At[K].mediaBox.topRightY-At[K].mediaBox.bottomLeftY-B(re)},Qt=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(re){return C(at(re))},wn=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(re){return C(dt(re))},gt=n.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return fn(gt)},f.__private__.setStrokeColor=f.setDrawColor=function(re,be,Ue,ut){return gt=Zn({ch1:re,ch2:be,ch3:Ue,ch4:ut,pdfColorType:"draw",precision:2}),Z(gt),this};var Vn=n.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return fn(Vn)},f.__private__.setFillColor=f.setFillColor=function(re,be,Ue,ut){return Vn=Zn({ch1:re,ch2:be,ch3:Ue,ch4:ut,pdfColorType:"fill",precision:2}),Z(Vn),this};var Yn=n.textColor||"0 g",ht=f.__private__.getTextColor=f.getTextColor=function(){return fn(Yn)};f.__private__.setTextColor=f.setTextColor=function(re,be,Ue,ut){return Yn=Zn({ch1:re,ch2:be,ch3:Ue,ch4:ut,pdfColorType:"text",precision:3}),this};var Ot=n.charSpace,In=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat(Ot||0)};f.__private__.setCharSpace=f.setCharSpace=function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Ot=re,this};var Wn=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(re){var be=f.CapJoinStyles[re];if(be===void 0)throw new Error("Line cap style of '"+re+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Wn=be,Z(be+" J"),this};var xn=0;f.__private__.setLineJoin=f.setLineJoin=function(re){var be=f.CapJoinStyles[re];if(be===void 0)throw new Error("Line join style of '"+re+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return xn=be,Z(be+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(re){if(re=re||0,isNaN(re))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Z(C(B(re))+" M"),this},f.GState=l0,f.setGState=function(re){(re=typeof re=="string"?ye[Ze[re]]:Gn(null,re)).equals(nt)||(Z("/"+re.id+" gs"),nt=re)};var Gn=function(re,be){if(!re||!Ze[re]){var Ue=!1;for(var ut in ye)if(ye.hasOwnProperty(ut)&&ye[ut].equals(be)){Ue=!0;break}if(Ue)be=ye[ut];else{var yt="GS"+(Object.keys(ye).length+1).toString(10);ye[yt]=be,be.id=yt}return re&&(Ze[re]=be.id),ft.publish("addGState",be),be}};f.addGState=function(re,be){return Gn(re,be),this},f.saveGraphicsState=function(){return Z("q"),_t.push({key:et,size:ae,color:Yn}),this},f.restoreGraphicsState=function(){Z("Q");var re=_t.pop();return et=re.key,ae=re.size,Yn=re.color,nt=null,this},f.setCurrentTransformationMatrix=function(re){return Z(re.toString()+" cm"),this},f.comment=function(re){return Z("#"+re),this};var fi=function(re,be){var Ue=re||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Ue},set:function(en){isNaN(en)||(Ue=parseFloat(en))}});var ut=be||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ut},set:function(en){isNaN(en)||(ut=parseFloat(en))}});var yt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return yt},set:function(en){yt=en.toString()}}),this},Ki=function(re,be,Ue,ut){fi.call(this,re,be),this.type="rect";var yt=Ue||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return yt},set:function(cn){isNaN(cn)||(yt=parseFloat(cn))}});var en=ut||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return en},set:function(cn){isNaN(cn)||(en=parseFloat(cn))}}),this},Ji=function(){this.page=st,this.currentPage=K,this.pages=Ce.slice(0),this.pagesContext=At.slice(0),this.x=ze,this.y=Oe,this.matrix=ke,this.width=zi(K),this.height=Hr(K),this.outputDestination=fe,this.id="",this.objectNumber=-1};Ji.prototype.restore=function(){st=this.page,K=this.currentPage,At=this.pagesContext,Ce=this.pages,ze=this.x,Oe=this.y,ke=this.matrix,Ir(K,this.width),Si(K,this.height),fe=this.outputDestination};var Ci=function(re,be,Ue,ut,yt){sn.push(new Ji),st=K=0,Ce=[],ze=re,Oe=be,ke=yt,Ve([Ue,ut])};for(var Qi in f.beginFormObject=function(re,be,Ue,ut,yt){return Ci(re,be,Ue,ut,yt),this},f.endFormObject=function(re){return(function(be){if(Zt[be])sn.pop().restore();else{var Ue=new Ji,ut="Xo"+(Object.keys(Yt).length+1).toString(10);Ue.id=ut,Zt[be]=ut,Yt[ut]=Ue,ft.publish("addFormObject",Ue),sn.pop().restore()}})(re),this},f.doFormObject=function(re,be){var Ue=Yt[Zt[re]];return Z("q"),Z(be.toString()+" cm"),Z("/"+Ue.id+" Do"),Z("Q"),this},f.getFormObject=function(re){var be=Yt[Zt[re]];return{x:be.x,y:be.y,width:be.width,height:be.height,matrix:be.matrix}},f.save=function(re,be){return re=re||"generated.pdf",(be=be||{}).returnPromise=be.returnPromise||!1,be.returnPromise===!1?(Sg(ei(Dn()),re),typeof Sg.unload=="function"&&Lr.setTimeout&&setTimeout(Sg.unload,911),this):new Promise(function(Ue,ut){try{var yt=Sg(ei(Dn()),re);typeof Sg.unload=="function"&&Lr.setTimeout&&setTimeout(Sg.unload,911),Ue(yt)}catch(en){ut(en.message)}})},qi.API)qi.API.hasOwnProperty(Qi)&&(Qi==="events"&&qi.API.events.length?(function(re,be){var Ue,ut,yt;for(yt=be.length-1;yt!==-1;yt--)Ue=be[yt][0],ut=be[yt][1],re.subscribe.apply(re,[Ue].concat(typeof ut=="function"?[ut]:ut))})(ft,qi.API.events):f[Qi]=qi.API[Qi]);var zi=f.getPageWidth=function(re){return(At[re=re||K].mediaBox.topRightX-At[re].mediaBox.bottomLeftX)/He},Ir=f.setPageWidth=function(re,be){At[re].mediaBox.topRightX=be*He+At[re].mediaBox.bottomLeftX},Hr=f.getPageHeight=function(re){return(At[re=re||K].mediaBox.topRightY-At[re].mediaBox.bottomLeftY)/He},Si=f.setPageHeight=function(re,be){At[re].mediaBox.topRightY=be*He+At[re].mediaBox.bottomLeftY};return f.internal={pdfEscape:wi,getStyle:li,getFont:ve,getFontSize:_e,getCharSpace:In,getTextColor:ht,getLineHeight:Pt,getLineHeightFactor:xe,getLineWidth:Ge,write:Ae,getHorizontalCoordinate:at,getVerticalCoordinate:dt,getCoordinateString:Qt,getVerticalCoordinateString:wn,collections:{},newObject:Jt,newAdditionalObject:un,newObjectDeferred:It,newObjectDeferredBegin:Ut,getFilters:Hn,putStream:ti,events:ft,scaleFactor:He,pageSize:{getWidth:function(){return zi(K)},setWidth:function(re){Ir(K,re)},getHeight:function(){return Hr(K)},setHeight:function(re){Si(K,re)}},encryptionOptions:u,encryption:Bn,getEncryptor:function(re){return u!==null?Bn.encryptor(re,0):function(be){return be}},output:xi,getNumberOfPages:nn,pages:Ce,out:Z,f2:T,f3:k,getPageInfo:Ri,getPageInfoByObjId:xt,getCurrentPageInfo:Bt,getPDFVersion:g,Point:fi,Rectangle:Ki,Matrix:vt,hasHotfix:Yi},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return zi(K)},set:function(re){Ir(K,re)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return Hr(K)},set:function(re){Si(K,re)},enumerable:!0,configurable:!0}),(function(re){for(var be=0,Ue=ee.length;be<Ue;be++){var ut=vn.call(this,re[be][0],re[be][1],re[be][2],ee[be][3],!0);d===!1&&(A[ut]=!0);var yt=re[be][0].split("-");br({id:ut,fontName:yt[0],fontStyle:yt[1]||""})}ft.publish("addFonts",{fonts:je,dictionary:rt})}).call(f,ee),et="F1",ct(r,t),ft.publish("initialized"),f}dm.prototype.lsbFirstWord=function(n){return String.fromCharCode(255&n,n>>8&255,n>>16&255,n>>24&255)},dm.prototype.toHexString=function(n){return n.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},dm.prototype.hexToBytes=function(n){for(var e=[],t=0;t<n.length;t+=2)e.push(String.fromCharCode(parseInt(n.substr(t,2),16)));return e.join("")},dm.prototype.processOwnerPassword=function(n,e){return ME(LE(e).substr(0,5),n)},dm.prototype.encryptor=function(n,e){var t=LE(this.encryptionKey+String.fromCharCode(255&n,n>>8&255,n>>16&255,255&e,e>>8&255)).substr(0,10);return function(i){return ME(t,i)}},l0.prototype.equals=function(n){var e,t="id,objectNumber,equals";if(!n||go(n)!==go(this))return!1;var i=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!n.hasOwnProperty(e)||this[e]!==n[e])return!1;i++}for(e in n)n.hasOwnProperty(e)&&t.indexOf(e)<0&&i--;return i===0},qi.API={events:[]},qi.version="3.0.2";var ja=qi.API,Vk=1,b0=function(n){return n.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},W0=function(n){return n.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Gr=function(n){return n.toFixed(2)},Yf=function(n){return n.toFixed(5)};ja.__acroform__={};var Nh=function(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n},LN=function(n){return n*Vk},Xd=function(n){var e=new I$,t=Xi.internal.getHeight(n)||0,i=Xi.internal.getWidth(n)||0;return e.BBox=[0,0,Number(Gr(i)),Number(Gr(t))],e},sge=ja.__acroform__.setBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return n|1<<e},oge=ja.__acroform__.clearBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return n&~(1<<e)},age=ja.__acroform__.getBit=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return n&1<<e?1:0},sl=ja.__acroform__.getBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return age(n,e-1)},ol=ja.__acroform__.setBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return sge(n,e-1)},al=ja.__acroform__.clearBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return oge(n,e-1)},lge=ja.__acroform__.calculateCoordinates=function(n,e){var t=e.internal.getHorizontalCoordinate,i=e.internal.getVerticalCoordinate,r=n[0],s=n[1],o=n[2],a=n[3],l={};return l.lowerLeft_X=t(r)||0,l.lowerLeft_Y=i(s+a)||0,l.upperRight_X=t(r+o)||0,l.upperRight_Y=i(s)||0,[Number(Gr(l.lowerLeft_X)),Number(Gr(l.lowerLeft_Y)),Number(Gr(l.upperRight_X)),Number(Gr(l.upperRight_Y))]},cge=function(n){if(n.appearanceStreamContent)return n.appearanceStreamContent;if(n.V||n.DV){var e=[],t=n._V||n.DV,i=RE(n,t),r=n.scope.internal.getFont(n.fontName,n.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(n.scope.__private__.encodeColorString(n.color)),e.push("/"+r+" "+Gr(i.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(i.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=Xd(n);return s.scope=n.scope,s.stream=e.join(`
`),s}},RE=function(n,e){var t=n.fontSize===0?n.maxFontSize:n.fontSize,i={text:"",fontSize:""},r=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");r=n.multiline?r.map(function(T){return T.split(`
`)}):r.map(function(T){return[T]});var s=t,o=Xi.internal.getHeight(n)||0;o=o<0?-o:o;var a=Xi.internal.getWidth(n)||0;a=a<0?-a:a;var l=function(T,k,B){if(T+1<r.length){var E=k+" "+r[T+1][0];return Rx(E,n,B).width<=a-4}return!1};s++;e:for(;s>0;){e="",s--;var h,u,d=Rx("3",n,s).height,A=n.multiline?o-s:(o-d)/2,f=A+=2,p=0,g=0,v=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+Rx(e,n,s=12).width+", FieldWidth:"+a+`
`;break}for(var w="",m=0,y=0;y<r.length;y++)if(r.hasOwnProperty(y)){var x=!1;if(r[y].length!==1&&v!==r[y].length-1){if((d+2)*(m+2)+2>o)continue e;w+=r[y][v],x=!0,g=y,y--}else{w=(w+=r[y][v]+" ").substr(w.length-1)==" "?w.substr(0,w.length-1):w;var S=parseInt(y),I=l(S,w,s),j=y>=r.length-1;if(I&&!j){w+=" ",v=0;continue}if(I||j){if(j)g=S;else if(n.multiline&&(d+2)*(m+2)+2>o)continue e}else{if(!n.multiline||(d+2)*(m+2)+2>o)continue e;g=S}}for(var C="",b=p;b<=g;b++){var D=r[b];if(n.multiline){if(b===g){C+=D[v]+" ",v=(v+1)%D.length;continue}if(b===p){C+=D[D.length-1]+" ";continue}}C+=D[0]+" "}switch(C=C.substr(C.length-1)==" "?C.substr(0,C.length-1):C,u=Rx(C,n,s).width,n.textAlign){case"right":h=a-u-2;break;case"center":h=(a-u)/2;break;default:h=2}e+=Gr(h)+" "+Gr(f)+` Td
`,e+="("+b0(C)+`) Tj
`,e+=-Gr(h)+` 0 Td
`,f=-(s+2),u=0,p=x?g:g+1,m++,w=""}break}return i.text=e,i.fontSize=s,i},Rx=function(n,e,t){var i=e.scope.internal.getFont(e.fontName,e.fontStyle),r=e.scope.getStringUnitWidth(n,{font:i,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:i,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:r}},hge={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},uge=function(n,e){var t={type:"reference",object:n};e.internal.getPageInfo(n.page).pageContext.annotations.find(function(i){return i.type===t.type&&i.object===t.object})===void 0&&e.internal.getPageInfo(n.page).pageContext.annotations.push(t)},dge=function(n,e){if(e.scope=n,n.internal!==void 0&&(n.internal.acroformPlugin===void 0||n.internal.acroformPlugin.isInitialized===!1)){if(jd.FieldNum=0,n.internal.acroformPlugin=JSON.parse(JSON.stringify(hge)),n.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Vk=n.internal.scaleFactor,n.internal.acroformPlugin.acroFormDictionaryRoot=new D$,n.internal.acroformPlugin.acroFormDictionaryRoot.scope=n,n.internal.acroformPlugin.acroFormDictionaryRoot._eventID=n.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(n)}),n.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var i=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var r in i)if(i.hasOwnProperty(r)){var s=i[r];s.objId=void 0,s.hasAnnotation&&uge(s,t)}})(n)}),n.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(n)}),n.internal.events.subscribe("postPutPages",function(t){(function(i,r){var s=!i;for(var o in i||(r.internal.newObjectDeferredBegin(r.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),r.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),i=i||r.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(i.hasOwnProperty(o)){var a=i[o],l=[],h=a.Rect;if(a.Rect&&(a.Rect=lge(a.Rect,r)),r.internal.newObjectDeferredBegin(a.objId,!0),a.DA=Xi.createDefaultAppearanceStream(a),go(a)==="object"&&typeof a.getKeyValueListForStream=="function"&&(l=a.getKeyValueListForStream()),a.Rect=h,a.hasAppearanceStream&&!a.appearanceStreamContent){var u=cge(a);l.push({key:"AP",value:"<</N "+u+">>"}),r.internal.acroformPlugin.xForms.push(u)}if(a.appearanceStreamContent){var d="";for(var A in a.appearanceStreamContent)if(a.appearanceStreamContent.hasOwnProperty(A)){var f=a.appearanceStreamContent[A];if(d+="/"+A+" ",d+="<<",Object.keys(f).length>=1||Array.isArray(f)){for(var o in f)if(f.hasOwnProperty(o)){var p=f[o];typeof p=="function"&&(p=p.call(r,a)),d+="/"+o+" "+p+" ",r.internal.acroformPlugin.xForms.indexOf(p)>=0||r.internal.acroformPlugin.xForms.push(p)}}else typeof(p=f)=="function"&&(p=p.call(r,a)),d+="/"+o+" "+p,r.internal.acroformPlugin.xForms.indexOf(p)>=0||r.internal.acroformPlugin.xForms.push(p);d+=">>"}l.push({key:"AP",value:`<<
`+d+">>"})}r.internal.putStream({additionalKeyValues:l,objectId:a.objId}),r.internal.out("endobj")}s&&(function(g,v){for(var w in g)if(g.hasOwnProperty(w)){var m=w,y=g[w];v.internal.newObjectDeferredBegin(y.objId,!0),go(y)==="object"&&typeof y.putStream=="function"&&y.putStream(),delete g[m]}})(r.internal.acroformPlugin.xForms,r)})(t,n)}),n.internal.acroformPlugin.isInitialized=!0}},k$=ja.__acroform__.arrayToPdfArray=function(n,e,t){var i=function(o){return o};if(Array.isArray(n)){for(var r="[",s=0;s<n.length;s++)switch(s!==0&&(r+=" "),go(n[s])){case"boolean":case"number":case"object":r+=n[s].toString();break;case"string":n[s].substr(0,1)!=="/"?(e!==void 0&&t&&(i=t.internal.getEncryptor(e)),r+="("+b0(i(n[s].toString()))+")"):r+=n[s].toString()}return r+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},r4=function(n,e,t){var i=function(r){return r};return e!==void 0&&t&&(i=t.internal.getEncryptor(e)),(n=n||"").toString(),"("+b0(i(n))+")"},iA=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(n){this._objId=n}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};iA.prototype.toString=function(){return this.objId+" 0 R"},iA.prototype.putStream=function(){var n=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:n,objectId:this.objId}),this.scope.internal.out("endobj")},iA.prototype.getKeyValueListForStream=function(){var n=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var i=e[t],r=this[i];r&&(Array.isArray(r)?n.push({key:i,value:k$(r,this.objId,this.scope)}):r instanceof iA?(r.scope=this.scope,n.push({key:i,value:r.objId+" 0 R"})):typeof r!="function"&&n.push({key:i,value:r}))}return n};var I$=function(){iA.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var n,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){n=t.trim()},get:function(){return n||null}})};Nh(I$,iA);var D$=function(){iA.call(this);var n,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(n){var t=function(i){return i};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+b0(t(n))+")"}},set:function(t){n=t}})};Nh(D$,iA);var jd=function n(){iA.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute F supplied.');e=w}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!sl(e,3)},set:function(w){w?this.F=ol(e,3):this.F=al(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute Ff supplied.');t=w}});var i=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(i.length!==0)return i},set:function(w){i=w!==void 0?w:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[0])?0:i[0]},set:function(w){i[0]=w}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[1])?0:i[1]},set:function(w){i[1]=w}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[2])?0:i[2]},set:function(w){i[2]=w}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[3])?0:i[3]},set:function(w){i[3]=w}});var r="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return r},set:function(w){switch(w){case"/Btn":case"/Tx":case"/Ch":case"/Sig":r=w;break;default:throw new Error('Invalid value "'+w+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof d_)return;s="FieldObject"+n.FieldNum++}var w=function(m){return m};return this.scope&&(w=this.scope.internal.getEncryptor(this.objId)),"("+b0(w(s))+")"},set:function(w){s=w.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(w){s=w}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(w){o=w}});var a="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return a},set:function(w){a=w}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(w){l=w}});var h=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return h===void 0?50/Vk:h},set:function(w){h=w}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(w){u=w}});var d="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!d||this instanceof d_||this instanceof $g))return r4(d,this.objId,this.scope)},set:function(w){w=w.toString(),d=w}});var A=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(A)return this instanceof Gl==0?r4(A,this.objId,this.scope):A},set:function(w){w=w.toString(),A=this instanceof Gl==0?w.substr(0,1)==="("?W0(w.substr(1,w.length-2)):W0(w):w}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Gl==1?W0(A.substr(1,A.length-1)):A},set:function(w){w=w.toString(),A=this instanceof Gl==1?"/"+w:w}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(w){this.V=w}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof Gl==0?r4(f,this.objId,this.scope):f},set:function(w){w=w.toString(),f=this instanceof Gl==0?w.substr(0,1)==="("?W0(w.substr(1,w.length-2)):W0(w):w}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Gl==1?W0(f.substr(1,f.length-1)):f},set:function(w){w=w.toString(),f=this instanceof Gl==1?"/"+w:w}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var p,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(w){w=!!w,g=w}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(p)return p},set:function(w){p=w}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!sl(this.Ff,1)},set:function(w){w?this.Ff=ol(this.Ff,1):this.Ff=al(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!sl(this.Ff,2)},set:function(w){w?this.Ff=ol(this.Ff,2):this.Ff=al(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!sl(this.Ff,3)},set:function(w){w?this.Ff=ol(this.Ff,3):this.Ff=al(this.Ff,3)}});var v=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(v!==null)return v},set:function(w){if([0,1,2].indexOf(w)===-1)throw new Error('Invalid value "'+w+'" for attribute Q supplied.');v=w}}),Object.defineProperty(this,"textAlign",{get:function(){var w;switch(v){case 0:default:w="left";break;case 1:w="center";break;case 2:w="right"}return w},configurable:!0,enumerable:!0,set:function(w){switch(w){case"right":case 2:v=2;break;case"center":case 1:v=1;break;default:v=0}}})};Nh(jd,iA);var Hm=function(){jd.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var n=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return n},set:function(t){n=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return k$(e,this.objId,this.scope)},set:function(t){var i,r;r=[],typeof(i=t)=="string"&&(r=(function(s,o,a){a||(a=1);for(var l,h=[];l=o.exec(s);)h.push(l[a]);return h})(i,/\((.*?)\)/g)),e=r}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,i){for(i=i||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),i!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!sl(this.Ff,18)},set:function(t){t?this.Ff=ol(this.Ff,18):this.Ff=al(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!sl(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=ol(this.Ff,19):this.Ff=al(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!sl(this.Ff,20)},set:function(t){t?(this.Ff=ol(this.Ff,20),e.sort()):this.Ff=al(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!sl(this.Ff,22)},set:function(t){t?this.Ff=ol(this.Ff,22):this.Ff=al(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!sl(this.Ff,23)},set:function(t){t?this.Ff=ol(this.Ff,23):this.Ff=al(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!sl(this.Ff,27)},set:function(t){t?this.Ff=ol(this.Ff,27):this.Ff=al(this.Ff,27)}}),this.hasAppearanceStream=!1};Nh(Hm,jd);var Wm=function(){Hm.call(this),this.fontName="helvetica",this.combo=!1};Nh(Wm,Hm);var zm=function(){Wm.call(this),this.combo=!0};Nh(zm,Wm);var oC=function(){zm.call(this),this.edit=!0};Nh(oC,zm);var Gl=function(){jd.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!sl(this.Ff,15)},set:function(t){t?this.Ff=ol(this.Ff,15):this.Ff=al(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!sl(this.Ff,16)},set:function(t){t?this.Ff=ol(this.Ff,16):this.Ff=al(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!sl(this.Ff,17)},set:function(t){t?this.Ff=ol(this.Ff,17):this.Ff=al(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!sl(this.Ff,26)},set:function(t){t?this.Ff=ol(this.Ff,26):this.Ff=al(this.Ff,26)}});var n,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(s){return s};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var i,r=[];for(i in r.push("<<"),e)r.push("/"+i+" ("+b0(t(e[i]))+")");return r.push(">>"),r.join(`
`)}},set:function(t){go(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(t){n="/"+t}})};Nh(Gl,jd);var aC=function(){Gl.call(this),this.pushButton=!0};Nh(aC,Gl);var Qm=function(){Gl.call(this),this.radio=!0,this.pushButton=!1;var n=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e!==void 0?e:[]}})};Nh(Qm,Gl);var d_=function(){var n,e;jd.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return n},set:function(r){n=r}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(r){e=r}});var t,i={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(a){return a};this.scope&&(r=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),i)o.push("/"+s+" ("+b0(r(i[s]))+")");return o.push(">>"),o.join(`
`)},set:function(r){go(r)==="object"&&(i=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return i.CA||""},set:function(r){typeof r=="string"&&(i.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Xi.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Nh(d_,jd),Qm.prototype.setAppearance=function(n){if(!("createAppearanceStream"in n)||!("getCA"in n))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=n.createAppearanceStream(t.optionName),t.caption=n.getCA()}},Qm.prototype.createOption=function(n){var e=new d_;return e.Parent=this,e.optionName=n,this.Kids.push(e),Age.call(this.scope,e),e};var lC=function(){Gl.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Xi.CheckBox.createAppearanceStream()};Nh(lC,Gl);var $g=function(){jd.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!sl(this.Ff,13)},set:function(e){e?this.Ff=ol(this.Ff,13):this.Ff=al(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!sl(this.Ff,21)},set:function(e){e?this.Ff=ol(this.Ff,21):this.Ff=al(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!sl(this.Ff,23)},set:function(e){e?this.Ff=ol(this.Ff,23):this.Ff=al(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!sl(this.Ff,24)},set:function(e){e?this.Ff=ol(this.Ff,24):this.Ff=al(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!sl(this.Ff,25)},set:function(e){e?this.Ff=ol(this.Ff,25):this.Ff=al(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!sl(this.Ff,26)},set:function(e){e?this.Ff=ol(this.Ff,26):this.Ff=al(this.Ff,26)}});var n=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return n},set:function(e){Number.isInteger(e)&&(n=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Nh($g,jd);var cC=function(){$g.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!sl(this.Ff,14)},set:function(n){n?this.Ff=ol(this.Ff,14):this.Ff=al(this.Ff,14)}}),this.password=!0};Nh(cC,$g);var Xi={CheckBox:{createAppearanceStream:function(){return{N:{On:Xi.CheckBox.YesNormal},D:{On:Xi.CheckBox.YesPushDown,Off:Xi.CheckBox.OffPushDown}}},YesPushDown:function(n){var e=Xd(n);e.scope=n.scope;var t=[],i=n.scope.internal.getFont(n.fontName,n.fontStyle).id,r=n.scope.__private__.encodeColorString(n.color),s=RE(n,n.caption);return t.push("0.749023 g"),t.push("0 0 "+Gr(Xi.internal.getWidth(n))+" "+Gr(Xi.internal.getHeight(n))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+i+" "+Gr(s.fontSize)+" Tf "+r),t.push("BT"),t.push(s.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(n){var e=Xd(n);e.scope=n.scope;var t=n.scope.internal.getFont(n.fontName,n.fontStyle).id,i=n.scope.__private__.encodeColorString(n.color),r=[],s=Xi.internal.getHeight(n),o=Xi.internal.getWidth(n),a=RE(n,n.caption);return r.push("1 g"),r.push("0 0 "+Gr(o)+" "+Gr(s)+" re"),r.push("f"),r.push("q"),r.push("0 0 1 rg"),r.push("0 0 "+Gr(o-1)+" "+Gr(s-1)+" re"),r.push("W"),r.push("n"),r.push("0 g"),r.push("BT"),r.push("/"+t+" "+Gr(a.fontSize)+" Tf "+i),r.push(a.text),r.push("ET"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(n){var e=Xd(n);e.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Gr(Xi.internal.getWidth(n))+" "+Gr(Xi.internal.getHeight(n))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(n){var e={D:{Off:Xi.RadioButton.Circle.OffPushDown},N:{}};return e.N[n]=Xi.RadioButton.Circle.YesNormal,e.D[n]=Xi.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(n){var e=Xd(n);e.scope=n.scope;var t=[],i=Xi.internal.getWidth(n)<=Xi.internal.getHeight(n)?Xi.internal.getWidth(n)/4:Xi.internal.getHeight(n)/4;i=Number((.9*i).toFixed(5));var r=Xi.internal.Bezier_C,s=Number((i*r).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+Yf(Xi.internal.getWidth(n)/2)+" "+Yf(Xi.internal.getHeight(n)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),t.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),t.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),t.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(n){var e=Xd(n);e.scope=n.scope;var t=[],i=Xi.internal.getWidth(n)<=Xi.internal.getHeight(n)?Xi.internal.getWidth(n)/4:Xi.internal.getHeight(n)/4;i=Number((.9*i).toFixed(5));var r=Number((2*i).toFixed(5)),s=Number((r*Xi.internal.Bezier_C).toFixed(5)),o=Number((i*Xi.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Yf(Xi.internal.getWidth(n)/2)+" "+Yf(Xi.internal.getHeight(n)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),t.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),t.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),t.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+Yf(Xi.internal.getWidth(n)/2)+" "+Yf(Xi.internal.getHeight(n)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),t.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),t.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),t.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(n){var e=Xd(n);e.scope=n.scope;var t=[],i=Xi.internal.getWidth(n)<=Xi.internal.getHeight(n)?Xi.internal.getWidth(n)/4:Xi.internal.getHeight(n)/4;i=Number((.9*i).toFixed(5));var r=Number((2*i).toFixed(5)),s=Number((r*Xi.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Yf(Xi.internal.getWidth(n)/2)+" "+Yf(Xi.internal.getHeight(n)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),t.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),t.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),t.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(n){var e={D:{Off:Xi.RadioButton.Cross.OffPushDown},N:{}};return e.N[n]=Xi.RadioButton.Cross.YesNormal,e.D[n]=Xi.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(n){var e=Xd(n);e.scope=n.scope;var t=[],i=Xi.internal.calculateCross(n);return t.push("q"),t.push("1 1 "+Gr(Xi.internal.getWidth(n)-2)+" "+Gr(Xi.internal.getHeight(n)-2)+" re"),t.push("W"),t.push("n"),t.push(Gr(i.x1.x)+" "+Gr(i.x1.y)+" m"),t.push(Gr(i.x2.x)+" "+Gr(i.x2.y)+" l"),t.push(Gr(i.x4.x)+" "+Gr(i.x4.y)+" m"),t.push(Gr(i.x3.x)+" "+Gr(i.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(n){var e=Xd(n);e.scope=n.scope;var t=Xi.internal.calculateCross(n),i=[];return i.push("0.749023 g"),i.push("0 0 "+Gr(Xi.internal.getWidth(n))+" "+Gr(Xi.internal.getHeight(n))+" re"),i.push("f"),i.push("q"),i.push("1 1 "+Gr(Xi.internal.getWidth(n)-2)+" "+Gr(Xi.internal.getHeight(n)-2)+" re"),i.push("W"),i.push("n"),i.push(Gr(t.x1.x)+" "+Gr(t.x1.y)+" m"),i.push(Gr(t.x2.x)+" "+Gr(t.x2.y)+" l"),i.push(Gr(t.x4.x)+" "+Gr(t.x4.y)+" m"),i.push(Gr(t.x3.x)+" "+Gr(t.x3.y)+" l"),i.push("s"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(n){var e=Xd(n);e.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Gr(Xi.internal.getWidth(n))+" "+Gr(Xi.internal.getHeight(n))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(n){var e=n.scope.internal.getFont(n.fontName,n.fontStyle).id,t=n.scope.__private__.encodeColorString(n.color);return"/"+e+" "+n.fontSize+" Tf "+t}};Xi.internal={Bezier_C:.551915024494,calculateCross:function(n){var e=Xi.internal.getWidth(n),t=Xi.internal.getHeight(n),i=Math.min(e,t);return{x1:{x:(e-i)/2,y:(t-i)/2+i},x2:{x:(e-i)/2+i,y:(t-i)/2},x3:{x:(e-i)/2,y:(t-i)/2},x4:{x:(e-i)/2+i,y:(t-i)/2+i}}}},Xi.internal.getWidth=function(n){var e=0;return go(n)==="object"&&(e=LN(n.Rect[2])),e},Xi.internal.getHeight=function(n){var e=0;return go(n)==="object"&&(e=LN(n.Rect[3])),e};var Age=ja.addField=function(n){if(dge(this,n),!(n instanceof jd))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=n).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),n.page=n.scope.internal.getCurrentPageInfo().pageNumber,this};ja.AcroFormChoiceField=Hm,ja.AcroFormListBox=Wm,ja.AcroFormComboBox=zm,ja.AcroFormEditBox=oC,ja.AcroFormButton=Gl,ja.AcroFormPushButton=aC,ja.AcroFormRadioButton=Qm,ja.AcroFormCheckBox=lC,ja.AcroFormTextField=$g,ja.AcroFormPasswordField=cC,ja.AcroFormAppearance=Xi,ja.AcroForm={ChoiceField:Hm,ListBox:Wm,ComboBox:zm,EditBox:oC,Button:Gl,PushButton:aC,RadioButton:Qm,CheckBox:lC,TextField:$g,PasswordField:cC,Appearance:Xi},qi.AcroForm={ChoiceField:Hm,ListBox:Wm,ComboBox:zm,EditBox:oC,Button:Gl,PushButton:aC,RadioButton:Qm,CheckBox:lC,TextField:$g,PasswordField:cC,Appearance:Xi};qi.AcroForm;function j$(n){return n.reduce(function(e,t,i){return e[t]=i,e},{})}(function(n){var e="addImage_";n.__addimage__={};var t="UNKNOWN",i={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=n.__addimage__.getImageFileTypeByImageData=function(T,k){var B,E,z,te,L,O=t;if((k=k||t)==="RGBA"||T.data!==void 0&&T.data instanceof Uint8ClampedArray&&"height"in T&&"width"in T)return"RGBA";if(I(T))for(L in i)for(z=i[L],B=0;B<z.length;B+=1){for(te=!0,E=0;E<z[B].length;E+=1)if(z[B][E]!==void 0&&z[B][E]!==T[E]){te=!1;break}if(te===!0){O=L;break}}else for(L in i)for(z=i[L],B=0;B<z.length;B+=1){for(te=!0,E=0;E<z[B].length;E+=1)if(z[B][E]!==void 0&&z[B][E]!==T.charCodeAt(E)){te=!1;break}if(te===!0){O=L;break}}return O===t&&k!==t&&(O=k),O},s=function T(k){for(var B=this.internal.write,E=this.internal.putStream,z=(0,this.internal.getFilters)();z.indexOf("FlateEncode")!==-1;)z.splice(z.indexOf("FlateEncode"),1);k.objectId=this.internal.newObject();var te=[];if(te.push({key:"Type",value:"/XObject"}),te.push({key:"Subtype",value:"/Image"}),te.push({key:"Width",value:k.width}),te.push({key:"Height",value:k.height}),k.colorSpace===w.INDEXED?te.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(k.palette.length/3-1)+" "+("sMask"in k&&k.sMask!==void 0?k.objectId+2:k.objectId+1)+" 0 R]"}):(te.push({key:"ColorSpace",value:"/"+k.colorSpace}),k.colorSpace===w.DEVICE_CMYK&&te.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),te.push({key:"BitsPerComponent",value:k.bitsPerComponent}),"decodeParameters"in k&&k.decodeParameters!==void 0&&te.push({key:"DecodeParms",value:"<<"+k.decodeParameters+">>"}),"transparency"in k&&Array.isArray(k.transparency)){for(var L="",O=0,J=k.transparency.length;O<J;O++)L+=k.transparency[O]+" "+k.transparency[O]+" ";te.push({key:"Mask",value:"["+L+"]"})}k.sMask!==void 0&&te.push({key:"SMask",value:k.objectId+1+" 0 R"});var $=k.filter!==void 0?["/"+k.filter]:void 0;if(E({data:k.data,additionalKeyValues:te,alreadyAppliedFilters:$,objectId:k.objectId}),B("endobj"),"sMask"in k&&k.sMask!==void 0){var U=(k.predictor!=null?"/Predictor "+k.predictor:"")+" /Colors 1 /BitsPerComponent 8 /Columns "+k.width,Y={width:k.width,height:k.height,colorSpace:"DeviceGray",bitsPerComponent:k.bitsPerComponent,decodeParameters:U,data:k.sMask};"filter"in k&&(Y.filter=k.filter),T.call(this,Y)}if(k.colorSpace===w.INDEXED){var K=this.internal.newObject();E({data:C(new Uint8Array(k.palette)),objectId:K}),B("endobj")}},o=function(){var T=this.internal.collections[e+"images"];for(var k in T)s.call(this,T[k])},a=function(){var T,k=this.internal.collections[e+"images"],B=this.internal.write;for(var E in k)B("/I"+(T=k[E]).index,T.objectId,"0","R")},l=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",a))},h=function(){var T=this.internal.collections[e+"images"];return l.call(this),T},u=function(){return Object.keys(this.internal.collections[e+"images"]).length},d=function(T){return typeof n["process"+T.toUpperCase()]=="function"},A=function(T){return go(T)==="object"&&T.nodeType===1},f=function(T,k){if(T.nodeName==="IMG"&&T.hasAttribute("src")){var B=""+T.getAttribute("src");if(B.indexOf("data:image/")===0)return sC(unescape(B).split("base64,").pop());var E=n.loadFile(B,!0);if(E!==void 0)return E}if(T.nodeName==="CANVAS"){if(T.width===0||T.height===0)throw new Error("Given canvas must have data. Canvas width: "+T.width+", height: "+T.height);var z;switch(k){case"PNG":z="image/png";break;case"WEBP":z="image/webp";break;default:z="image/jpeg"}return sC(T.toDataURL(z,1).split("base64,").pop())}},p=function(T){var k=this.internal.collections[e+"images"];if(k){for(var B in k)if(T===k[B].alias)return k[B]}},g=function(T,k,B){return T||k||(T=-96,k=-96),T<0&&(T=-1*B.width*72/T/this.internal.scaleFactor),k<0&&(k=-1*B.height*72/k/this.internal.scaleFactor),T===0&&(T=k*B.width/B.height),k===0&&(k=T*B.height/B.width),[T,k]},v=function(T,k,B,E,z,te){var L=g.call(this,B,E,z),O=this.internal.getCoordinateString,J=this.internal.getVerticalCoordinateString,$=h.call(this);if(B=L[0],E=L[1],$[z.index]=z,te){te*=Math.PI/180;var U=Math.cos(te),Y=Math.sin(te),K=function(Q){return Q.toFixed(4)},V=[K(U),K(Y),K(-1*Y),K(U),0,0,"cm"]}this.internal.write("q"),te?(this.internal.write([1,"0","0",1,O(T),J(k+E),"cm"].join(" ")),this.internal.write(V.join(" ")),this.internal.write([O(B),"0","0",O(E),"0","0","cm"].join(" "))):this.internal.write([O(B),"0","0",O(E),O(T),J(k+E),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+z.index+" Do"),this.internal.write("Q")},w=n.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};n.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var m=n.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},y=n.__addimage__.sHashCode=function(T){var k,B,E=0;if(typeof T=="string")for(B=T.length,k=0;k<B;k++)E=(E<<5)-E+T.charCodeAt(k),E|=0;else if(I(T))for(B=T.byteLength/2,k=0;k<B;k++)E=(E<<5)-E+T[k],E|=0;return E},x=n.__addimage__.validateStringAsBase64=function(T){(T=T||"").toString().trim();var k=!0;return T.length===0&&(k=!1),T.length%4!=0&&(k=!1),/^[A-Za-z0-9+/]+$/.test(T.substr(0,T.length-2))===!1&&(k=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(T.substr(-2))===!1&&(k=!1),k},S=n.__addimage__.extractImageFromDataUrl=function(T){if(T==null||!(T=T.trim()).startsWith("data:"))return null;var k=T.indexOf(",");return k<0?null:T.substring(0,k).trim().endsWith("base64")?T.substring(k+1):null};n.__addimage__.isArrayBuffer=function(T){return T instanceof ArrayBuffer};var I=n.__addimage__.isArrayBufferView=function(T){return T instanceof Int8Array||T instanceof Uint8Array||T instanceof Uint8ClampedArray||T instanceof Int16Array||T instanceof Uint16Array||T instanceof Int32Array||T instanceof Uint32Array||T instanceof Float32Array||T instanceof Float64Array},j=n.__addimage__.binaryStringToUint8Array=function(T){for(var k=T.length,B=new Uint8Array(k),E=0;E<k;E++)B[E]=T.charCodeAt(E);return B},C=n.__addimage__.arrayBufferToBinaryString=function(T){for(var k="",B=I(T)?T:new Uint8Array(T),E=0;E<B.length;E+=8192)k+=String.fromCharCode.apply(null,B.subarray(E,E+8192));return k};n.addImage=function(){var T,k,B,E,z,te,L,O,J;if(typeof arguments[1]=="number"?(k=t,B=arguments[1],E=arguments[2],z=arguments[3],te=arguments[4],L=arguments[5],O=arguments[6],J=arguments[7]):(k=arguments[1],B=arguments[2],E=arguments[3],z=arguments[4],te=arguments[5],L=arguments[6],O=arguments[7],J=arguments[8]),go(T=arguments[0])==="object"&&!A(T)&&"imageData"in T){var $=T;T=$.imageData,k=$.format||k||t,B=$.x||B||0,E=$.y||E||0,z=$.w||$.width||z,te=$.h||$.height||te,L=$.alias||L,O=$.compression||O,J=$.rotation||$.angle||J}var U=this.internal.getFilters();if(O===void 0&&U.indexOf("FlateEncode")!==-1&&(O="SLOW"),isNaN(B)||isNaN(E))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var Y=b.call(this,T,k,L,O);return v.call(this,B,E,z,te,Y,J),this};var b=function(T,k,B,E){var z,te,L;if(typeof T=="string"&&r(T)===t){T=unescape(T);var O=D(T,!1);(O!==""||(O=n.loadFile(T,!0))!==void 0)&&(T=O)}if(A(T)&&(T=f(T,k)),k=r(T,k),!d(k))throw new Error("addImage does not support files of type '"+k+"', please ensure that a plugin for '"+k+"' support is added.");if(((L=B)==null||L.length===0)&&(B=(function(J){return typeof J=="string"||I(J)?y(J):I(J.data)?y(J.data):null})(T)),(z=p.call(this,B))||(T instanceof Uint8Array||k==="RGBA"||(te=T,T=j(T)),z=this["process"+k.toUpperCase()](T,u.call(this),B,(function(J){return J&&typeof J=="string"&&(J=J.toUpperCase()),J in n.image_compression?J:m.NONE})(E),te)),!z)throw new Error("An unknown error occurred whilst processing the image.");return z},D=n.__addimage__.convertBase64ToBinaryString=function(T,k){k=typeof k!="boolean"||k;var B,E="";if(typeof T=="string"){var z;B=(z=S(T))!==null&&z!==void 0?z:T;try{E=sC(B)}catch(te){if(k)throw x(B)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+te.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return E};n.getImageProperties=function(T){var k,B,E="";if(A(T)&&(T=f(T)),typeof T=="string"&&r(T)===t&&((E=D(T,!1))===""&&(E=n.loadFile(T)||""),T=E),B=r(T),!d(B))throw new Error("addImage does not support files of type '"+B+"', please ensure that a plugin for '"+B+"' support is added.");if(T instanceof Uint8Array||(T=j(T)),!(k=this["process"+B.toUpperCase()](T)))throw new Error("An unknown error occurred whilst processing the image");return k.fileType=B,k}})(qi.API),(function(n){var e=function(t){if(t!==void 0&&t!="")return!0};qi.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),n.events.push(["putPage",function(t){for(var i,r,s,o=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(t.objId),h=t.pageContext.annotations,u=!1,d=0;d<h.length&&!u;d++)switch((i=h[d]).type){case"link":(e(i.options.url)||e(i.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var A=0;A<h.length;A++){i=h[A];var f=this.internal.pdfEscape,p=this.internal.getEncryptor(t.objId);switch(i.type){case"reference":this.internal.write(" "+i.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),v=this.internal.newAdditionalObject(),w=this.internal.getEncryptor(g.objId),m=i.title||"Note";s="<</Type /Annot /Subtype /Text "+(r="/Rect ["+o(i.bounds.x)+" "+a(i.bounds.y+i.bounds.h)+" "+o(i.bounds.x+i.bounds.w)+" "+a(i.bounds.y)+"] ")+"/Contents ("+f(w(i.contents))+")",s+=" /Popup "+v.objId+" 0 R",s+=" /P "+l.objId+" 0 R",s+=" /T ("+f(w(m))+") >>",g.content=s;var y=g.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(r="/Rect ["+o(i.bounds.x+30)+" "+a(i.bounds.y+i.bounds.h)+" "+o(i.bounds.x+i.bounds.w+30)+" "+a(i.bounds.y)+"] ")+" /Parent "+y,i.open&&(s+=" /Open true"),s+=" >>",v.content=s,this.internal.write(g.objId,"0 R",v.objId,"0 R");break;case"freetext":r="/Rect ["+o(i.bounds.x)+" "+a(i.bounds.y)+" "+o(i.bounds.x+i.bounds.w)+" "+a(i.bounds.y+i.bounds.h)+"] ";var x=i.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+r+"/Contents ("+f(p(i.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+x+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(i.options.name){var S=this.annotations._nameMap[i.options.name];i.options.pageNumber=S.page,i.options.top=S.y}else i.options.top||(i.options.top=0);if(r="/Rect ["+i.finalBounds.x+" "+i.finalBounds.y+" "+i.finalBounds.w+" "+i.finalBounds.h+"] ",s="",i.options.url)s="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /A <</S /URI /URI ("+f(p(i.options.url))+") >>";else if(i.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(i.options.pageNumber).objId+" 0 R",i.options.magFactor=i.options.magFactor||"XYZ",i.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+i.options.top+"]";break;case"FitV":i.options.left=i.options.left||0,s+=" /FitV "+i.options.left+"]";break;default:var I=a(i.options.top);i.options.left=i.options.left||0,i.options.zoom===void 0&&(i.options.zoom=0),s+=" /XYZ "+i.options.left+" "+I+" "+i.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),n.createAnnotation=function(t){var i=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":i.pageContext.annotations.push(t)}},n.link=function(t,i,r,s,o){var a=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,h=this.internal.getVerticalCoordinateString;a.pageContext.annotations.push({finalBounds:{x:l(t),y:h(i),w:l(t+r),h:h(i+s)},options:o,type:"link"})},n.textWithLink=function(t,i,r,s){var o,a,l=this.getTextWidth(t),h=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){a=s.maxWidth;var u=this.splitTextToSize(t,a).length;o=Math.ceil(h*u)}else a=l,o=h;return this.text(t,i,r,s),r+=.2*h,s.align==="center"&&(i-=l/2),s.align==="right"&&(i-=l),this.link(i,r-h,a,o,s),l},n.getTextWidth=function(t){var i=this.internal.getFontSize();return this.getStringUnitWidth(t)*i/this.internal.scaleFactor}})(qi.API),(function(n){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},i={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},r=[1570,1571,1573,1575];n.__arabicParser__={};var s=n.__arabicParser__.isInArabicSubstitutionA=function(g){return e[g.charCodeAt(0)]!==void 0},o=n.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},a=n.__arabicParser__.isArabicEndLetter=function(g){return o(g)&&s(g)&&e[g.charCodeAt(0)].length<=2},l=n.__arabicParser__.isArabicAlfLetter=function(g){return o(g)&&r.indexOf(g.charCodeAt(0))>=0};n.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return o(g)&&s(g)&&e[g.charCodeAt(0)].length>=1};var h=n.__arabicParser__.arabicLetterHasFinalForm=function(g){return o(g)&&s(g)&&e[g.charCodeAt(0)].length>=2};n.__arabicParser__.arabicLetterHasInitialForm=function(g){return o(g)&&s(g)&&e[g.charCodeAt(0)].length>=3};var u=n.__arabicParser__.arabicLetterHasMedialForm=function(g){return o(g)&&s(g)&&e[g.charCodeAt(0)].length==4},d=n.__arabicParser__.resolveLigatures=function(g){var v=0,w=t,m="",y=0;for(v=0;v<g.length;v+=1)w[g.charCodeAt(v)]!==void 0?(y++,typeof(w=w[g.charCodeAt(v)])=="number"&&(m+=String.fromCharCode(w),w=t,y=0),v===g.length-1&&(w=t,m+=g.charAt(v-(y-1)),v-=y-1,y=0)):(w=t,m+=g.charAt(v-y),v-=y,y=0);return m};n.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&i[g.charCodeAt(0)]!==void 0};var A=n.__arabicParser__.getCorrectForm=function(g,v,w){return o(g)?s(g)===!1?-1:!h(g)||!o(v)&&!o(w)||!o(w)&&a(v)||a(g)&&!o(v)||a(g)&&l(v)||a(g)&&a(v)?0:u(g)&&o(v)&&!a(v)&&o(w)&&h(w)?3:a(g)||!o(w)?1:2:-1},f=function(g){var v=0,w=0,m=0,y="",x="",S="",I=(g=g||"").split("\\s+"),j=[];for(v=0;v<I.length;v+=1){for(j.push(""),w=0;w<I[v].length;w+=1)y=I[v][w],x=I[v][w-1],S=I[v][w+1],o(y)?(m=A(y,x,S),j[v]+=m!==-1?String.fromCharCode(e[y.charCodeAt(0)][m]):y):j[v]+=y;j[v]=d(j[v])}return j.join(" ")},p=n.__arabicParser__.processArabic=n.processArabic=function(){var g,v=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,w=[];if(Array.isArray(v)){var m=0;for(w=[],m=0;m<v.length;m+=1)Array.isArray(v[m])?w.push([f(v[m][0]),v[m][1],v[m][2]]):w.push([f(v[m])]);g=w}else g=f(v);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};n.events.push(["preProcessText",p])})(qi.API),qi.API.autoPrint=function(n){var e;return(n=n||{}).variant=n.variant||"non-conform",n.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(n){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(a){t=a}});var i=150;Object.defineProperty(this,"width",{get:function(){return i},set:function(a){i=isNaN(a)||Number.isInteger(a)===!1||a<0?150:a,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=i+1)}});var r=300;Object.defineProperty(this,"height",{get:function(){return r},set:function(a){r=isNaN(a)||Number.isInteger(a)===!1||a<0?300:a,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=r+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(a){s=a}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(a){o=a}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,i){var r;if((t=t||"2d")!=="2d")return null;for(r in i)this.pdf.context2d.hasOwnProperty(r)&&(this.pdf.context2d[r]=i[r]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},n.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(qi.API),(function(n){var e={left:0,top:0,bottom:0,right:0},t=!1,i=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),r.call(this))},r=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(g){l=g}});var h=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var d=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var A=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return A},set:function(g){A=g}});var f=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var p=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return p},set:function(g){p=g}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},n.setHeaderFunction=function(l){return i.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},n.getTextDimensions=function(l,h){i.call(this);var u=(h=h||{}).fontSize||this.getFontSize(),d=h.font||this.getFont(),A=h.scaleFactor||this.internal.scaleFactor,f=0,p=0,g=0,v=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var w=h.maxWidth;w>0?typeof l=="string"?l=this.splitTextToSize(l,w):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(y,x){return y.concat(v.splitTextToSize(x,w))},[])):l=Array.isArray(l)?l:[l];for(var m=0;m<l.length;m++)f<(g=this.getStringUnitWidth(l[m],{font:d})*u)&&(f=g);return f!==0&&(p=l.length),{w:f/=A,h:Math.max((p*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/A,0)}},n.cellAddPage=function(){i.call(this),this.addPage();var l=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=n.cell=function(){var l;l=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),i.call(this);var h=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,d=this.internal.__cell__.margins||e,A=this.internal.__cell__.tableHeaderRow,f=this.internal.__cell__.printHeaders;return h.lineNumber!==void 0&&(h.lineNumber===l.lineNumber?(l.x=(h.x||0)+(h.width||0),l.y=h.y||0):h.y+h.height+l.height+d.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=d.top,f&&A&&(this.printHeaderRow(l.lineNumber,!0),l.y+=A[0].height)):l.y=h.y+h.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,t===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-u,l.y+u,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+u,{align:"center",baseline:"top",maxWidth:l.width-u-u}):this.text(l.text,l.x+u,l.y+u,{align:"left",baseline:"top",maxWidth:l.width-u-u})),this.internal.__cell__.lastCell=l,this};n.table=function(l,h,u,d,A){if(i.call(this),!u)throw new Error("No data for PDF table.");var f,p,g,v,w=[],m=[],y=[],x={},S={},I=[],j=[],C=(A=A||{}).autoSize||!1,b=A.printHeaders!==!1,D=A.css&&A.css["font-size"]!==void 0?16*A.css["font-size"]:A.fontSize||12,T=A.margins||Object.assign({width:this.getPageWidth()},e),k=typeof A.padding=="number"?A.padding:3,B=A.headerBackgroundColor||"#c8c8c8",E=A.headerTextColor||"#000";if(r.call(this),this.internal.__cell__.printHeaders=b,this.internal.__cell__.margins=T,this.internal.__cell__.table_font_size=D,this.internal.__cell__.padding=k,this.internal.__cell__.headerBackgroundColor=B,this.internal.__cell__.headerTextColor=E,this.setFontSize(D),d==null)m=w=Object.keys(u[0]),y=w.map(function(){return"left"});else if(Array.isArray(d)&&go(d[0])==="object")for(w=d.map(function($){return $.name}),m=d.map(function($){return $.prompt||$.name||""}),y=d.map(function($){return $.align||"left"}),f=0;f<d.length;f+=1)S[d[f].name]=.7499990551181103*d[f].width;else Array.isArray(d)&&typeof d[0]=="string"&&(m=w=d,y=w.map(function(){return"left"}));if(C||Array.isArray(d)&&typeof d[0]=="string")for(f=0;f<w.length;f+=1){for(x[v=w[f]]=u.map(function($){return $[v]}),this.setFont(void 0,"bold"),I.push(this.getTextDimensions(m[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),p=x[v],this.setFont(void 0,"normal"),g=0;g<p.length;g+=1)I.push(this.getTextDimensions(p[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);S[v]=Math.max.apply(null,I)+k+k,I=[]}if(b){var z={};for(f=0;f<w.length;f+=1)z[w[f]]={},z[w[f]].text=m[f],z[w[f]].align=y[f];var te=a.call(this,z,S);j=w.map(function($){return new s(l,h,S[$],te,z[$].text,void 0,z[$].align)}),this.setTableHeaderRow(j),this.printHeaderRow(1,!1)}var L=d.reduce(function($,U){return $[U.name]=U.align,$},{});for(f=0;f<u.length;f+=1){"rowStart"in A&&A.rowStart instanceof Function&&A.rowStart({row:f,data:u[f]},this);var O=a.call(this,u[f],S);for(g=0;g<w.length;g+=1){var J=u[f][w[g]];"cellStart"in A&&A.cellStart instanceof Function&&A.cellStart({row:f,col:g,data:J},this),o.call(this,new s(l,h,S[w[g]],O,J,f+2,L[w[g]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=h,this};var a=function(l,h){var u=this.internal.__cell__.padding,d=this.internal.__cell__.table_font_size,A=this.internal.scaleFactor;return Object.keys(l).map(function(f){var p=l[f];return this.splitTextToSize(p.hasOwnProperty("text")?p.text:p,h[f]-u-u)},this).map(function(f){return this.getLineHeightFactor()*f.length*d/A+u+u},this).reduce(function(f,p){return Math.max(f,p)},0)};n.setTableHeaderRow=function(l){i.call(this),this.internal.__cell__.tableHeaderRow=l},n.printHeaderRow=function(l,h){if(i.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var d=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(d[0],d[1],d[2],d[3],void 0,-1)}this.setFont(void 0,"bold");for(var A=[],f=0;f<this.internal.__cell__.tableHeaderRow.length;f+=1){u=this.internal.__cell__.tableHeaderRow[f].clone(),h&&(u.y=this.internal.__cell__.margins.top||0,A.push(u)),u.lineNumber=l;var p=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,u),this.setTextColor(p)}A.length>0&&this.setTableHeaderRow(A),this.setFont(void 0,"normal"),t=!1}})(qi.API);var P$={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},N$=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],UE=j$(N$),L$=[100,200,300,400,500,600,700,800,900],fge=j$(L$);function s4(n){var e=n.family.replace(/"|'/g,"").toLowerCase(),t=(function(s){return P$[s=s||"normal"]?s:"normal"})(n.style),i=(function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400})(n.weight),r=(function(s){return typeof UE[s=s||"normal"]=="number"?s:"normal"})(n.stretch);return{family:e,style:t,weight:i,stretch:r,src:n.src||[],ref:n.ref||{name:e,style:[r,t,i].join(" ")}}}function MN(n,e,t,i){var r;for(r=t;r>=0&&r<e.length;r+=i)if(n[e[r]])return n[e[r]];for(r=t;r>=0&&r<e.length;r-=i)if(n[e[r]])return n[e[r]]}var pge={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},RN={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function UN(n){return[n.stretch,n.style,n.weight,n.family].join(" ")}function ON(n){return n.trimLeft()}function gge(n,e){for(var t=0;t<n.length;){if(n.charAt(t)===e)return[n.substring(0,t),n.substring(t+1)];t+=1}return null}function mge(n){var e=n.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],n.substring(e[0].length)]}var Ux,HN,WN,z0,Ox,zN,QN,$N,o4=["times"];function VN(n,e,t,i){var r=4,s=XN;switch(i){case qi.API.image_compression.FAST:r=1,s=GN;break;case qi.API.image_compression.MEDIUM:r=6,s=YN;break;case qi.API.image_compression.SLOW:r=9,s=KN}n=(function(a,l,h,u){for(var d,A=a.length/l,f=new Uint8Array(a.length+A),p=[yge,GN,XN,YN,KN],g=0;g<A;g+=1){var v=g*l,w=a.subarray(v,v+l);if(u)f.set(u(w,h,d),v+g);else{for(var m=p.length,y=[],x=0;x<m;x+=1)y[x]=p[x](w,h,d);var S=vge(y.concat());f.set(y[S],v+g)}d=w}return f})(n,e,t,s);var o=DE(n,{level:r});return qi.API.__addimage__.arrayBufferToBinaryString(o)}function yge(n){var e=Array.apply([],n);return e.unshift(0),e}function GN(n,e){var t=n.length,i=[];i[0]=1;for(var r=0;r<t;r+=1){var s=n[r-e]||0;i[r+1]=n[r]-s+256&255}return i}function XN(n,e,t){var i=n.length,r=[];r[0]=2;for(var s=0;s<i;s+=1){var o=t&&t[s]||0;r[s+1]=n[s]-o+256&255}return r}function YN(n,e,t){var i=n.length,r=[];r[0]=3;for(var s=0;s<i;s+=1){var o=n[s-e]||0,a=t&&t[s]||0;r[s+1]=n[s]+256-(o+a>>>1)&255}return r}function KN(n,e,t){var i=n.length,r=[];r[0]=4;for(var s=0;s<i;s+=1){var o=wge(n[s-e]||0,t&&t[s]||0,t&&t[s-e]||0);r[s+1]=n[s]-o+256&255}return r}function wge(n,e,t){if(n===e&&e===t)return n;var i=Math.abs(e-t),r=Math.abs(n-t),s=Math.abs(n+e-t-t);return i<=r&&i<=s?n:r<=s?e:t}function vge(n){var e=n.map(function(t){return t.reduce(function(i,r){return i+Math.abs(r)},0)});return e.indexOf(Math.min.apply(null,e))}function a4(n,e,t){var i=e*t,r=Math.floor(i/8),s=16-(i-8*r+t),o=(1<<t)-1;return M$(n,r)>>s&o}function qN(n,e,t,i){var r=t*i,s=Math.floor(r/8),o=16-(r-8*s+i),a=(1<<i)-1,l=(e&a)<<o;(function(h,u,d){if(u+1<h.byteLength)h.setUint16(u,d,!1);else{var A=d>>8&255;h.setUint8(u,A)}})(n,s,M$(n,s)&~(a<<o)&65535|l)}function M$(n,e){return e+1<n.byteLength?n.getUint16(e,!1):n.getUint8(e)<<8}function xge(n){var e=0;if(n[e++]!==71||n[e++]!==73||n[e++]!==70||n[e++]!==56||(n[e++]+1&253)!=56||n[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=n[e++]|n[e++]<<8,i=n[e++]|n[e++]<<8,r=n[e++],s=r>>7,o=1<<1+(7&r);n[e++],n[e++];var a=null,l=null;s&&(a=e,l=o,e+=3*o);var h=!0,u=[],d=0,A=null,f=0,p=null;for(this.width=t,this.height=i;h&&e<n.length;)switch(n[e++]){case 33:switch(n[e++]){case 255:if(n[e]!==11||n[e+1]==78&&n[e+2]==69&&n[e+3]==84&&n[e+4]==83&&n[e+5]==67&&n[e+6]==65&&n[e+7]==80&&n[e+8]==69&&n[e+9]==50&&n[e+10]==46&&n[e+11]==48&&n[e+12]==3&&n[e+13]==1&&n[e+16]==0)e+=14,p=n[e++]|n[e++]<<8,e++;else for(e+=12;;){if(!((T=n[e++])>=0))throw Error("Invalid block size");if(T===0)break;e+=T}break;case 249:if(n[e++]!==4||n[e+4]!==0)throw new Error("Invalid graphics extension block.");var g=n[e++];d=n[e++]|n[e++]<<8,A=n[e++],1&g||(A=null),f=g>>2&7,e++;break;case 254:for(;;){if(!((T=n[e++])>=0))throw Error("Invalid block size");if(T===0)break;e+=T}break;default:throw new Error("Unknown graphic control label: 0x"+n[e-1].toString(16))}break;case 44:var v=n[e++]|n[e++]<<8,w=n[e++]|n[e++]<<8,m=n[e++]|n[e++]<<8,y=n[e++]|n[e++]<<8,x=n[e++],S=x>>6&1,I=1<<1+(7&x),j=a,C=l,b=!1;x>>7&&(b=!0,j=e,C=I,e+=3*I);var D=e;for(e++;;){var T;if(!((T=n[e++])>=0))throw Error("Invalid block size");if(T===0)break;e+=T}u.push({x:v,y:w,width:m,height:y,has_local_palette:b,palette_offset:j,palette_size:C,data_offset:D,data_length:e-D,transparent_index:A,interlaced:!!S,delay:d,disposal:f});break;case 59:h=!1;break;default:throw new Error("Unknown gif block: 0x"+n[e-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return p},this.frameInfo=function(k){if(k<0||k>=u.length)throw new Error("Frame index out of range.");return u[k]},this.decodeAndBlitFrameBGRA=function(k,B){var E=this.frameInfo(k),z=E.width*E.height,te=new Uint8Array(z);ZN(n,E.data_offset,te,z);var L=E.palette_offset,O=E.transparent_index;O===null&&(O=256);var J=E.width,$=t-J,U=J,Y=4*(E.y*t+E.x),K=4*((E.y+E.height)*t+E.x),V=Y,Q=4*$;E.interlaced===!0&&(Q+=4*t*7);for(var X=8,W=0,se=te.length;W<se;++W){var q=te[W];if(U===0&&(U=J,(V+=Q)>=K&&(Q=4*$+4*t*(X-1),V=Y+(J+$)*(X<<1),X>>=1)),q===O)V+=4;else{var de=n[L+3*q],Ce=n[L+3*q+1],Se=n[L+3*q+2];B[V++]=Se,B[V++]=Ce,B[V++]=de,B[V++]=255}--U}},this.decodeAndBlitFrameRGBA=function(k,B){var E=this.frameInfo(k),z=E.width*E.height,te=new Uint8Array(z);ZN(n,E.data_offset,te,z);var L=E.palette_offset,O=E.transparent_index;O===null&&(O=256);var J=E.width,$=t-J,U=J,Y=4*(E.y*t+E.x),K=4*((E.y+E.height)*t+E.x),V=Y,Q=4*$;E.interlaced===!0&&(Q+=4*t*7);for(var X=8,W=0,se=te.length;W<se;++W){var q=te[W];if(U===0&&(U=J,(V+=Q)>=K&&(Q=4*$+4*t*(X-1),V=Y+(J+$)*(X<<1),X>>=1)),q===O)V+=4;else{var de=n[L+3*q],Ce=n[L+3*q+1],Se=n[L+3*q+2];B[V++]=de,B[V++]=Ce,B[V++]=Se,B[V++]=255}--U}}}function ZN(n,e,t,i){for(var r=n[e++],s=1<<r,o=s+1,a=o+1,l=r+1,h=(1<<l)-1,u=0,d=0,A=0,f=n[e++],p=new Int32Array(4096),g=null;;){for(;u<16&&f!==0;)d|=n[e++]<<u,u+=8,f===1?f=n[e++]:--f;if(u<l)break;var v=d&h;if(d>>=l,u-=l,v!==s){if(v===o)break;for(var w=v<a?v:g,m=0,y=w;y>s;)y=p[y]>>8,++m;var x=y;if(A+m+(w!==v?1:0)>i)return void Po.log("Warning, gif stream longer than expected.");t[A++]=x;var S=A+=m;for(w!==v&&(t[A++]=x),y=w;m--;)y=p[y],t[--S]=255&y,y>>=8;g!==null&&a<4096&&(p[a++]=g<<8|x,a>=h+1&&l<12&&(++l,h=h<<1|1)),g=v}else a=o+1,h=(1<<(l=r+1))-1,g=null}return A!==i&&Po.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function l4(n){var e,t,i,r,s,o=Math.floor,a=new Array(64),l=new Array(64),h=new Array(64),u=new Array(64),d=new Array(65535),A=new Array(65535),f=new Array(64),p=new Array(64),g=[],v=0,w=7,m=new Array(64),y=new Array(64),x=new Array(64),S=new Array(256),I=new Array(2048),j=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],C=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],b=[0,1,2,3,4,5,6,7,8,9,10,11],D=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],T=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],k=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],B=[0,1,2,3,4,5,6,7,8,9,10,11],E=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],z=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function te(Y,K){for(var V=0,Q=0,X=new Array,W=1;W<=16;W++){for(var se=1;se<=Y[W];se++)X[K[Q]]=[],X[K[Q]][0]=V,X[K[Q]][1]=W,Q++,V++;V*=2}return X}function L(Y){for(var K=Y[0],V=Y[1]-1;V>=0;)K&1<<V&&(v|=1<<w),V--,--w<0&&(v==255?(O(255),O(0)):O(v),w=7,v=0)}function O(Y){g.push(Y)}function J(Y){O(Y>>8&255),O(255&Y)}function $(Y,K,V,Q,X){for(var W,se=X[0],q=X[240],de=(function(ae,me){var _e,ue,Be,it,De,qe,Je,Me,et,He,ze=0;for(et=0;et<8;++et){_e=ae[ze],ue=ae[ze+1],Be=ae[ze+2],it=ae[ze+3],De=ae[ze+4],qe=ae[ze+5],Je=ae[ze+6];var Oe=_e+(Me=ae[ze+7]),ke=_e-Me,je=ue+Je,rt=ue-Je,_t=Be+qe,Ee=Be-qe,Le=it+De,ye=it-De,Ze=Oe+Le,nt=Oe-Le,st=je+_t,At=je-_t;ae[ze]=Ze+st,ae[ze+4]=Ze-st;var ft=.707106781*(At+nt);ae[ze+2]=nt+ft,ae[ze+6]=nt-ft;var Xt=.382683433*((Ze=ye+Ee)-(At=rt+ke)),Yt=.5411961*Ze+Xt,Zt=1.306562965*At+Xt,sn=.707106781*(st=Ee+rt),vt=ke+sn,Ye=ke-sn;ae[ze+5]=Ye+Yt,ae[ze+3]=Ye-Yt,ae[ze+1]=vt+Zt,ae[ze+7]=vt-Zt,ze+=8}for(ze=0,et=0;et<8;++et){_e=ae[ze],ue=ae[ze+8],Be=ae[ze+16],it=ae[ze+24],De=ae[ze+32],qe=ae[ze+40],Je=ae[ze+48];var Gt=_e+(Me=ae[ze+56]),Wt=_e-Me,Vt=ue+Je,Jt=ue-Je,It=Be+qe,Ut=Be-qe,un=it+De,Sn=it-De,jt=Gt+un,fn=Gt-un,Zn=Vt+It,Hn=Vt-It;ae[ze]=jt+Zn,ae[ze+32]=jt-Zn;var ti=.707106781*(Hn+fn);ae[ze+16]=fn+ti,ae[ze+48]=fn-ti;var ri=.382683433*((jt=Sn+Ut)-(Hn=Jt+Wt)),bi=.5411961*jt+ri,Ni=1.306562965*Hn+ri,ui=.707106781*(Zn=Ut+Jt),si=Wt+ui,Li=Wt-ui;ae[ze+40]=Li+bi,ae[ze+24]=Li-bi,ae[ze+8]=si+Ni,ae[ze+56]=si-Ni,ze++}for(et=0;et<64;++et)He=ae[et]*me[et],f[et]=He>0?He+.5|0:He-.5|0;return f})(Y,K),Ce=0;Ce<64;++Ce)p[j[Ce]]=de[Ce];var Se=p[0]-V;V=p[0],Se==0?L(Q[0]):(L(Q[A[W=32767+Se]]),L(d[W]));for(var fe=63;fe>0&&p[fe]==0;)fe--;if(fe==0)return L(se),V;for(var M,Z=1;Z<=fe;){for(var Ae=Z;p[Z]==0&&Z<=fe;)++Z;var ie=Z-Ae;if(ie>=16){M=ie>>4;for(var ee=1;ee<=M;++ee)L(q);ie&=15}W=32767+p[Z],L(X[(ie<<4)+A[W]]),L(d[W]),Z++}return fe!=63&&L(se),V}function U(Y){Y=Math.min(Math.max(Y,1),100),s!=Y&&((function(K){for(var V=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Q=0;Q<64;Q++){var X=o((V[Q]*K+50)/100);X=Math.min(Math.max(X,1),255),a[j[Q]]=X}for(var W=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],se=0;se<64;se++){var q=o((W[se]*K+50)/100);q=Math.min(Math.max(q,1),255),l[j[se]]=q}for(var de=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ce=0,Se=0;Se<8;Se++)for(var fe=0;fe<8;fe++)h[Ce]=1/(a[j[Ce]]*de[Se]*de[fe]*8),u[Ce]=1/(l[j[Ce]]*de[Se]*de[fe]*8),Ce++})(Y<50?Math.floor(5e3/Y):Math.floor(200-2*Y)),s=Y)}this.encode=function(Y,K){K&&U(K),g=new Array,v=0,w=7,J(65496),J(65504),J(16),O(74),O(70),O(73),O(70),O(0),O(1),O(1),O(0),J(1),J(1),O(0),O(0),(function(){J(65499),J(132),O(0);for(var ue=0;ue<64;ue++)O(a[ue]);O(1);for(var Be=0;Be<64;Be++)O(l[Be])})(),(function(ue,Be){J(65472),J(17),O(8),J(Be),J(ue),O(3),O(1),O(17),O(0),O(2),O(17),O(1),O(3),O(17),O(1)})(Y.width,Y.height),(function(){J(65476),J(418),O(0);for(var ue=0;ue<16;ue++)O(C[ue+1]);for(var Be=0;Be<=11;Be++)O(b[Be]);O(16);for(var it=0;it<16;it++)O(D[it+1]);for(var De=0;De<=161;De++)O(T[De]);O(1);for(var qe=0;qe<16;qe++)O(k[qe+1]);for(var Je=0;Je<=11;Je++)O(B[Je]);O(17);for(var Me=0;Me<16;Me++)O(E[Me+1]);for(var et=0;et<=161;et++)O(z[et])})(),J(65498),J(12),O(3),O(1),O(0),O(2),O(17),O(3),O(17),O(0),O(63),O(0);var V=0,Q=0,X=0;v=0,w=7,this.encode.displayName="_encode_";for(var W,se,q,de,Ce,Se,fe,M,Z,Ae=Y.data,ie=Y.width,ee=Y.height,ae=4*ie,me=0;me<ee;){for(W=0;W<ae;){for(Ce=ae*me+W,fe=-1,M=0,Z=0;Z<64;Z++)Se=Ce+(M=Z>>3)*ae+(fe=4*(7&Z)),me+M>=ee&&(Se-=ae*(me+1+M-ee)),W+fe>=ae&&(Se-=W+fe-ae+4),se=Ae[Se++],q=Ae[Se++],de=Ae[Se++],m[Z]=(I[se]+I[q+256|0]+I[de+512|0]>>16)-128,y[Z]=(I[se+768|0]+I[q+1024|0]+I[de+1280|0]>>16)-128,x[Z]=(I[se+1280|0]+I[q+1536|0]+I[de+1792|0]>>16)-128;V=$(m,h,V,e,i),Q=$(y,u,Q,t,r),X=$(x,u,X,t,r),W+=32}me+=8}if(w>=0){var _e=[];_e[1]=w+1,_e[0]=(1<<w+1)-1,L(_e)}return J(65497),new Uint8Array(g)},n=n||50,(function(){for(var Y=String.fromCharCode,K=0;K<256;K++)S[K]=Y(K)})(),e=te(C,b),t=te(k,B),i=te(D,T),r=te(E,z),(function(){for(var Y=1,K=2,V=1;V<=15;V++){for(var Q=Y;Q<K;Q++)A[32767+Q]=V,d[32767+Q]=[],d[32767+Q][1]=V,d[32767+Q][0]=Q;for(var X=-(K-1);X<=-Y;X++)A[32767+X]=V,d[32767+X]=[],d[32767+X][1]=V,d[32767+X][0]=K-1+X;Y<<=1,K<<=1}})(),(function(){for(var Y=0;Y<256;Y++)I[Y]=19595*Y,I[Y+256|0]=38470*Y,I[Y+512|0]=7471*Y+32768,I[Y+768|0]=-11059*Y,I[Y+1024|0]=-21709*Y,I[Y+1280|0]=32768*Y+8421375,I[Y+1536|0]=-27439*Y,I[Y+1792|0]=-5329*Y})(),U(n)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Ju(n,e){if(this.pos=0,this.buffer=n,this.datav=new DataView(n.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function JN(n){function e(b){if(!b)throw Error("assert :P")}function t(b,D,T){for(var k=0;4>k;k++)if(b[D+k]!=T.charCodeAt(k))return!0;return!1}function i(b,D,T,k,B){for(var E=0;E<B;E++)b[D+E]=T[k+E]}function r(b,D,T,k){for(var B=0;B<k;B++)b[D+B]=T}function s(b){return new Int32Array(b)}function o(b,D){for(var T=[],k=0;k<b;k++)T.push(new D);return T}function a(b,D){var T=[];return(function k(B,E,z){for(var te=z[E],L=0;L<te&&(B.push(z.length>E+1?[]:new D),!(z.length<E+1));L++)k(B[L],E+1,z)})(T,0,b),T}var l=function(){var b=this;function D(P,G){for(var le=1<<G-1>>>0;P&le;)le>>>=1;return le?(P&le-1)+le:P}function T(P,G,le,he,Te){e(!(he%le));do P[G+(he-=le)]=Te;while(0<he)}function k(P,G,le,he,Te){if(e(2328>=Te),512>=Te)var Fe=s(512);else if((Fe=s(Te))==null)return 0;return(function(Ie,Ne,We,tt,wt,$t){var Xe,Et,Ht=Ne,mn=1<<We,Lt=s(16),bn=s(16);for(e(wt!=0),e(tt!=null),e(Ie!=null),e(0<We),Et=0;Et<wt;++Et){if(15<tt[Et])return 0;++Lt[tt[Et]]}if(Lt[0]==wt)return 0;for(bn[1]=0,Xe=1;15>Xe;++Xe){if(Lt[Xe]>1<<Xe)return 0;bn[Xe+1]=bn[Xe]+Lt[Xe]}for(Et=0;Et<wt;++Et)Xe=tt[Et],0<tt[Et]&&($t[bn[Xe]++]=Et);if(bn[15]==1)return(tt=new B).g=0,tt.value=$t[0],T(Ie,Ht,1,mn,tt),mn;var Ft,zn=-1,Nn=mn-1,tr=0,Oi=1,Pr=1,Hi=1<<We;for(Et=0,Xe=1,wt=2;Xe<=We;++Xe,wt<<=1){if(Oi+=Pr<<=1,0>(Pr-=Lt[Xe]))return 0;for(;0<Lt[Xe];--Lt[Xe])(tt=new B).g=Xe,tt.value=$t[Et++],T(Ie,Ht+tr,wt,Hi,tt),tr=D(tr,Xe)}for(Xe=We+1,wt=2;15>=Xe;++Xe,wt<<=1){if(Oi+=Pr<<=1,0>(Pr-=Lt[Xe]))return 0;for(;0<Lt[Xe];--Lt[Xe]){if(tt=new B,(tr&Nn)!=zn){for(Ht+=Hi,Ft=1<<(zn=Xe)-We;15>zn&&!(0>=(Ft-=Lt[zn]));)++zn,Ft<<=1;mn+=Hi=1<<(Ft=zn-We),Ie[Ne+(zn=tr&Nn)].g=Ft+We,Ie[Ne+zn].value=Ht-Ne-zn}tt.g=Xe-We,tt.value=$t[Et++],T(Ie,Ht+(tr>>We),wt,Hi,tt),tr=D(tr,Xe)}}return Oi!=2*bn[15]-1?0:mn})(P,G,le,he,Te,Fe)}function B(){this.value=this.g=0}function E(){this.value=this.g=0}function z(){this.G=o(5,B),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(ba,E)}function te(P,G,le,he){e(P!=null),e(G!=null),e(2147483648>he),P.Ca=254,P.I=0,P.b=-8,P.Ka=0,P.oa=G,P.pa=le,P.Jd=G,P.Yc=le+he,P.Zc=4<=he?le+he-4+1:le,se(P)}function L(P,G){for(var le=0;0<G--;)le|=de(P,128)<<G;return le}function O(P,G){var le=L(P,G);return q(P)?-le:le}function J(P,G,le,he){var Te,Fe=0;for(e(P!=null),e(G!=null),e(4294967288>he),P.Sb=he,P.Ra=0,P.u=0,P.h=0,4<he&&(he=4),Te=0;Te<he;++Te)Fe+=G[le+Te]<<8*Te;P.Ra=Fe,P.bb=he,P.oa=G,P.pa=le}function $(P){for(;8<=P.u&&P.bb<P.Sb;)P.Ra>>>=8,P.Ra+=P.oa[P.pa+P.bb]<<Qa-8>>>0,++P.bb,P.u-=8;Q(P)&&(P.h=1,P.u=0)}function U(P,G){if(e(0<=G),!P.h&&G<=Ou){var le=V(P)&Xc[G];return P.u+=G,$(P),le}return P.h=1,P.u=0}function Y(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function K(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function V(P){return P.Ra>>>(P.u&Qa-1)>>>0}function Q(P){return e(P.bb<=P.Sb),P.h||P.bb==P.Sb&&P.u>Qa}function X(P,G){P.u=G,P.h=Q(P)}function W(P){P.u>=Vs&&(e(P.u>=Vs),$(P))}function se(P){e(P!=null&&P.oa!=null),P.pa<P.Zc?(P.I=(P.oa[P.pa++]|P.I<<8)>>>0,P.b+=8):(e(P!=null&&P.oa!=null),P.pa<P.Yc?(P.b+=8,P.I=P.oa[P.pa++]|P.I<<8):P.Ka?P.b=0:(P.I<<=8,P.b+=8,P.Ka=1))}function q(P){return L(P,1)}function de(P,G){var le=P.Ca;0>P.b&&se(P);var he=P.b,Te=le*G>>>8,Fe=(P.I>>>he>Te)+0;for(Fe?(le-=Te,P.I-=Te+1<<he>>>0):le=Te+1,he=le,Te=0;256<=he;)Te+=8,he>>=8;return he=7^Te+Hu[he],P.b-=he,P.Ca=(le<<he)-1,Fe}function Ce(P,G,le){P[G+0]=le>>24&255,P[G+1]=le>>16&255,P[G+2]=le>>8&255,P[G+3]=255&le}function Se(P,G){return P[G+0]|P[G+1]<<8}function fe(P,G){return Se(P,G)|P[G+2]<<16}function M(P,G){return Se(P,G)|Se(P,G+2)<<16}function Z(P,G){var le=1<<G;return e(P!=null),e(0<G),P.X=s(le),P.X==null?0:(P.Mb=32-G,P.Xa=G,1)}function Ae(P,G){e(P!=null),e(G!=null),e(P.Xa==G.Xa),i(G.X,0,P.X,0,1<<G.Xa)}function ie(){this.X=[],this.Xa=this.Mb=0}function ee(P,G,le,he){e(le!=null),e(he!=null);var Te=le[0],Fe=he[0];return Te==0&&(Te=(P*Fe+G/2)/G),Fe==0&&(Fe=(G*Te+P/2)/P),0>=Te||0>=Fe?0:(le[0]=Te,he[0]=Fe,1)}function ae(P,G){return P+(1<<G)-1>>>G}function me(P,G){return((4278255360&P)+(4278255360&G)>>>0&4278255360)+((16711935&P)+(16711935&G)>>>0&16711935)>>>0}function _e(P,G){b[G]=function(le,he,Te,Fe,Ie,Ne,We){var tt;for(tt=0;tt<Ie;++tt){var wt=b[P](Ne[We+tt-1],Te,Fe+tt);Ne[We+tt]=me(le[he+tt],wt)}}}function ue(){this.ud=this.hd=this.jd=0}function Be(P,G){return((4278124286&(P^G))>>>1)+(P&G)>>>0}function it(P){return 0<=P&&256>P?P:0>P?0:255<P?255:void 0}function De(P,G){return it(P+(P-G+.5>>1))}function qe(P,G,le){return Math.abs(G-le)-Math.abs(P-le)}function Je(P,G,le,he,Te,Fe,Ie){for(he=Fe[Ie-1],le=0;le<Te;++le)Fe[Ie+le]=he=me(P[G+le],he)}function Me(P,G,le,he,Te){var Fe;for(Fe=0;Fe<le;++Fe){var Ie=P[G+Fe],Ne=Ie>>8&255,We=16711935&(We=(We=16711935&Ie)+((Ne<<16)+Ne));he[Te+Fe]=(4278255360&Ie)+We>>>0}}function et(P,G){G.jd=255&P,G.hd=P>>8&255,G.ud=P>>16&255}function He(P,G,le,he,Te,Fe){var Ie;for(Ie=0;Ie<he;++Ie){var Ne=G[le+Ie],We=Ne>>>8,tt=Ne,wt=255&(wt=(wt=Ne>>>16)+((P.jd<<24>>24)*(We<<24>>24)>>>5));tt=255&(tt=(tt+=(P.hd<<24>>24)*(We<<24>>24)>>>5)+((P.ud<<24>>24)*(wt<<24>>24)>>>5)),Te[Fe+Ie]=(4278255360&Ne)+(wt<<16)+tt}}function ze(P,G,le,he,Te){b[G]=function(Fe,Ie,Ne,We,tt,wt,$t,Xe,Et){for(We=$t;We<Xe;++We)for($t=0;$t<Et;++$t)tt[wt++]=Te(Ne[he(Fe[Ie++])])},b[P]=function(Fe,Ie,Ne,We,tt,wt,$t){var Xe=8>>Fe.b,Et=Fe.Ea,Ht=Fe.K[0],mn=Fe.w;if(8>Xe)for(Fe=(1<<Fe.b)-1,mn=(1<<Xe)-1;Ie<Ne;++Ie){var Lt,bn=0;for(Lt=0;Lt<Et;++Lt)Lt&Fe||(bn=he(We[tt++])),wt[$t++]=Te(Ht[bn&mn]),bn>>=Xe}else b["VP8LMapColor"+le](We,tt,Ht,mn,wt,$t,Ie,Ne,Et)}}function Oe(P,G,le,he,Te){for(le=G+le;G<le;){var Fe=P[G++];he[Te++]=Fe>>16&255,he[Te++]=Fe>>8&255,he[Te++]=255&Fe}}function ke(P,G,le,he,Te){for(le=G+le;G<le;){var Fe=P[G++];he[Te++]=Fe>>16&255,he[Te++]=Fe>>8&255,he[Te++]=255&Fe,he[Te++]=Fe>>24&255}}function je(P,G,le,he,Te){for(le=G+le;G<le;){var Fe=(Ie=P[G++])>>16&240|Ie>>12&15,Ie=240&Ie|Ie>>28&15;he[Te++]=Fe,he[Te++]=Ie}}function rt(P,G,le,he,Te){for(le=G+le;G<le;){var Fe=(Ie=P[G++])>>16&248|Ie>>13&7,Ie=Ie>>5&224|Ie>>3&31;he[Te++]=Fe,he[Te++]=Ie}}function _t(P,G,le,he,Te){for(le=G+le;G<le;){var Fe=P[G++];he[Te++]=255&Fe,he[Te++]=Fe>>8&255,he[Te++]=Fe>>16&255}}function Ee(P,G,le,he,Te,Fe){if(Fe==0)for(le=G+le;G<le;)Ce(he,((Fe=P[G++])[0]>>24|Fe[1]>>8&65280|Fe[2]<<8&16711680|Fe[3]<<24)>>>0),Te+=32;else i(he,Te,P,G,le)}function Le(P,G){b[G][0]=b[P+"0"],b[G][1]=b[P+"1"],b[G][2]=b[P+"2"],b[G][3]=b[P+"3"],b[G][4]=b[P+"4"],b[G][5]=b[P+"5"],b[G][6]=b[P+"6"],b[G][7]=b[P+"7"],b[G][8]=b[P+"8"],b[G][9]=b[P+"9"],b[G][10]=b[P+"10"],b[G][11]=b[P+"11"],b[G][12]=b[P+"12"],b[G][13]=b[P+"13"],b[G][14]=b[P+"0"],b[G][15]=b[P+"0"]}function ye(P){return P==kn||P==Qu||P==mh||P==Md}function Ze(){this.eb=[],this.size=this.A=this.fb=0}function nt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function st(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Ze,this.f.kb=new nt,this.sd=null}function At(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function ft(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Xt(P){return alert("todo:WebPSamplerProcessPlane"),P.T}function Yt(P,G){var le=P.T,he=G.ba.f.RGBA,Te=he.eb,Fe=he.fb+P.ka*he.A,Ie=Zr[G.ba.S],Ne=P.y,We=P.O,tt=P.f,wt=P.N,$t=P.ea,Xe=P.W,Et=G.cc,Ht=G.dc,mn=G.Mc,Lt=G.Nc,bn=P.ka,Ft=P.ka+P.T,zn=P.U,Nn=zn+1>>1;for(bn==0?Ie(Ne,We,null,null,tt,wt,$t,Xe,tt,wt,$t,Xe,Te,Fe,null,null,zn):(Ie(G.ec,G.fc,Ne,We,Et,Ht,mn,Lt,tt,wt,$t,Xe,Te,Fe-he.A,Te,Fe,zn),++le);bn+2<Ft;bn+=2)Et=tt,Ht=wt,mn=$t,Lt=Xe,wt+=P.Rc,Xe+=P.Rc,Fe+=2*he.A,Ie(Ne,(We+=2*P.fa)-P.fa,Ne,We,Et,Ht,mn,Lt,tt,wt,$t,Xe,Te,Fe-he.A,Te,Fe,zn);return We+=P.fa,P.j+Ft<P.o?(i(G.ec,G.fc,Ne,We,zn),i(G.cc,G.dc,tt,wt,Nn),i(G.Mc,G.Nc,$t,Xe,Nn),le--):1&Ft||Ie(Ne,We,null,null,tt,wt,$t,Xe,tt,wt,$t,Xe,Te,Fe+he.A,null,null,zn),le}function Zt(P,G,le){var he=P.F,Te=[P.J];if(he!=null){var Fe=P.U,Ie=G.ba.S,Ne=Ie==jr||Ie==mh;G=G.ba.f.RGBA;var We=[0],tt=P.ka;We[0]=P.T,P.Kb&&(tt==0?--We[0]:(--tt,Te[0]-=P.width),P.j+P.ka+P.T==P.o&&(We[0]=P.o-P.j-tt));var wt=G.eb;tt=G.fb+tt*G.A,P=En(he,Te[0],P.width,Fe,We,wt,tt+(Ne?0:3),G.A),e(le==We),P&&ye(Ie)&&Kn(wt,tt,Ne,Fe,We,G.A)}return 0}function sn(P){var G=P.ma,le=G.ba.S,he=11>le,Te=le==ou||le==Ga||le==jr||le==Xa||le==12||ye(le);if(G.memory=null,G.Ib=null,G.Jb=null,G.Nd=null,!Wa(G.Oa,P,Te?11:12))return 0;if(Te&&ye(le)&&Lh(),P.da)alert("todo:use_scaling");else{if(he){if(G.Ib=Xt,P.Kb){if(le=P.U+1>>1,G.memory=s(P.U+2*le),G.memory==null)return 0;G.ec=G.memory,G.fc=0,G.cc=G.ec,G.dc=G.fc+P.U,G.Mc=G.cc,G.Nc=G.dc+le,G.Ib=Yt,Lh()}}else alert("todo:EmitYUV");Te&&(G.Jb=Zt,he&&Oo())}if(he&&!Lf){for(P=0;256>P;++P)G1[P]=89858*(P-128)+Ya>>Go,X1[P]=-22014*(P-128)+Ya,Wv[P]=-45773*(P-128),Hv[P]=113618*(P-128)+Ya>>Go;for(P=Sa;P<sc;++P)G=76283*(P-16)+Ya>>Go,Y1[P-Sa]=rs(G,255),zv[P-Sa]=rs(G+8>>4,15);Lf=1}return 1}function vt(P){var G=P.ma,le=P.U,he=P.T;return e(!(1&P.ka)),0>=le||0>=he?0:(le=G.Ib(P,G),G.Jb!=null&&G.Jb(P,G,le),G.Dc+=le,1)}function Ye(P){P.ma.memory=null}function Gt(P,G,le,he){return U(P,8)!=47?0:(G[0]=U(P,14)+1,le[0]=U(P,14)+1,he[0]=U(P,1),U(P,3)!=0?0:!P.h)}function Wt(P,G){if(4>P)return P+1;var le=P-2>>1;return(2+(1&P)<<le)+U(G,le)+1}function Vt(P,G){return 120<G?G-120:1<=(le=((le=kA[G-1])>>4)*P+(8-(15&le)))?le:1;var le}function Jt(P,G,le){var he=V(le),Te=P[G+=255&he].g-8;return 0<Te&&(X(le,le.u+8),he=V(le),G+=P[G].value,G+=he&(1<<Te)-1),X(le,le.u+P[G].g),P[G].value}function It(P,G,le){return le.g+=P.g,le.value+=P.value<<G>>>0,e(8>=le.g),P.g}function Ut(P,G,le){var he=P.xc;return e((G=he==0?0:P.vc[P.md*(le>>he)+(G>>he)])<P.Wb),P.Ya[G]}function un(P,G,le,he){var Te=P.ab,Fe=P.c*G,Ie=P.C;G=Ie+G;var Ne=le,We=he;for(he=P.Ta,le=P.Ua;0<Te--;){var tt=P.gc[Te],wt=Ie,$t=G,Xe=Ne,Et=We,Ht=(We=he,Ne=le,tt.Ea);switch(e(wt<$t),e($t<=tt.nc),tt.hc){case 2:su(Xe,Et,($t-wt)*Ht,We,Ne);break;case 0:var mn=wt,Lt=$t,bn=We,Ft=Ne,zn=(Hi=tt).Ea;mn==0&&(Cc(Xe,Et,null,null,1,bn,Ft),Je(Xe,Et+1,0,0,zn-1,bn,Ft+1),Et+=zn,Ft+=zn,++mn);for(var Nn=1<<Hi.b,tr=Nn-1,Oi=ae(zn,Hi.b),Pr=Hi.K,Hi=Hi.w+(mn>>Hi.b)*Oi;mn<Lt;){var fs=Pr,Ta=Hi,Vr=1;for(Ll(Xe,Et,bn,Ft-zn,1,bn,Ft);Vr<zn;){var $i=(Vr&~tr)+Nn;$i>zn&&($i=zn),(0,$a[fs[Ta++]>>8&15])(Xe,Et+ +Vr,bn,Ft+Vr-zn,$i-Vr,bn,Ft+Vr),Vr=$i}Et+=zn,Ft+=zn,++mn&tr||(Hi+=Oi)}$t!=tt.nc&&i(We,Ne-Ht,We,Ne+($t-wt-1)*Ht,Ht);break;case 1:for(Ht=Xe,Lt=Et,zn=(Xe=tt.Ea)-(Ft=Xe&~(bn=(Et=1<<tt.b)-1)),mn=ae(Xe,tt.b),Nn=tt.K,tt=tt.w+(wt>>tt.b)*mn;wt<$t;){for(tr=Nn,Oi=tt,Pr=new ue,Hi=Lt+Ft,fs=Lt+Xe;Lt<Hi;)et(tr[Oi++],Pr),_c(Pr,Ht,Lt,Et,We,Ne),Lt+=Et,Ne+=Et;Lt<fs&&(et(tr[Oi++],Pr),_c(Pr,Ht,Lt,zn,We,Ne),Lt+=zn,Ne+=zn),++wt&bn||(tt+=mn)}break;case 3:if(Xe==We&&Et==Ne&&0<tt.b){for(Lt=We,Xe=Ht=Ne+($t-wt)*Ht-(Ft=($t-wt)*ae(tt.Ea,tt.b)),Et=We,bn=Ne,mn=[],Ft=(zn=Ft)-1;0<=Ft;--Ft)mn[Ft]=Et[bn+Ft];for(Ft=zn-1;0<=Ft;--Ft)Lt[Xe+Ft]=mn[Ft];gh(tt,wt,$t,We,Ht,We,Ne)}else gh(tt,wt,$t,Xe,Et,We,Ne)}Ne=he,We=le}We!=le&&i(he,le,Ne,We,Fe)}function Sn(P,G){var le=P.V,he=P.Ba+P.c*P.C,Te=G-P.C;if(e(G<=P.l.o),e(16>=Te),0<Te){var Fe=P.l,Ie=P.Ta,Ne=P.Ua,We=Fe.width;if(un(P,Te,le,he),Te=Ne=[Ne],e((le=P.C)<(he=G)),e(Fe.v<Fe.va),he>Fe.o&&(he=Fe.o),le<Fe.j){var tt=Fe.j-le;le=Fe.j,Te[0]+=tt*We}if(le>=he?le=0:(Te[0]+=4*Fe.v,Fe.ka=le-Fe.j,Fe.U=Fe.va-Fe.v,Fe.T=he-le,le=1),le){if(Ne=Ne[0],11>(le=P.ca).S){var wt=le.f.RGBA,$t=(he=le.S,Te=Fe.U,Fe=Fe.T,tt=wt.eb,wt.A),Xe=Fe;for(wt=wt.fb+P.Ma*wt.A;0<Xe--;){var Et=Ie,Ht=Ne,mn=Te,Lt=tt,bn=wt;switch(he){case xo:Kc(Et,Ht,mn,Lt,bn);break;case ou:Sl(Et,Ht,mn,Lt,bn);break;case kn:Sl(Et,Ht,mn,Lt,bn),Kn(Lt,bn,0,mn,1,0);break;case FA:Os(Et,Ht,mn,Lt,bn);break;case Ga:Ee(Et,Ht,mn,Lt,bn,1);break;case Qu:Ee(Et,Ht,mn,Lt,bn,1),Kn(Lt,bn,0,mn,1,0);break;case jr:Ee(Et,Ht,mn,Lt,bn,0);break;case mh:Ee(Et,Ht,mn,Lt,bn,0),Kn(Lt,bn,1,mn,1,0);break;case Xa:nc(Et,Ht,mn,Lt,bn);break;case Md:nc(Et,Ht,mn,Lt,bn),os(Lt,bn,mn,1,0);break;case ua:Ar(Et,Ht,mn,Lt,bn);break;default:e(0)}Ne+=We,wt+=$t}P.Ma+=Fe}else alert("todo:EmitRescaledRowsYUVA");e(P.Ma<=le.height)}}P.C=G,e(P.C<=P.i)}function jt(P){var G;if(0<P.ua)return 0;for(G=0;G<P.Wb;++G){var le=P.Ya[G].G,he=P.Ya[G].H;if(0<le[1][he[1]+0].g||0<le[2][he[2]+0].g||0<le[3][he[3]+0].g)return 0}return 1}function fn(P,G,le,he,Te,Fe){if(P.Z!=0){var Ie=P.qd,Ne=P.rd;for(e(Aa[P.Z]!=null);G<le;++G)Aa[P.Z](Ie,Ne,he,Te,he,Te,Fe),Ie=he,Ne=Te,Te+=Fe;P.qd=Ie,P.rd=Ne}}function Zn(P,G){var le=P.l.ma,he=le.Z==0||le.Z==1?P.l.j:P.C;if(he=P.C<he?he:P.C,e(G<=P.l.o),G>he){var Te=P.l.width,Fe=le.ca,Ie=le.tb+Te*he,Ne=P.V,We=P.Ba+P.c*he,tt=P.gc;e(P.ab==1),e(tt[0].hc==3),Yc(tt[0],he,G,Ne,We,Fe,Ie),fn(le,he,G,Fe,Ie,Te)}P.C=P.Ma=G}function Hn(P,G,le,he,Te,Fe,Ie){var Ne=P.$/he,We=P.$%he,tt=P.m,wt=P.s,$t=le+P.$,Xe=$t;Te=le+he*Te;var Et=le+he*Fe,Ht=280+wt.ua,mn=P.Pb?Ne:16777216,Lt=0<wt.ua?wt.Wa:null,bn=wt.wc,Ft=$t<Et?Ut(wt,We,Ne):null;e(P.C<Fe),e(Et<=Te);var zn=!1;e:for(;;){for(;zn||$t<Et;){var Nn=0;if(Ne>=mn){var tr=$t-le;e((mn=P).Pb),mn.wd=mn.m,mn.xd=tr,0<mn.s.ua&&Ae(mn.s.Wa,mn.s.vb),mn=Ne+bs}if(We&bn||(Ft=Ut(wt,We,Ne)),e(Ft!=null),Ft.Qb&&(G[$t]=Ft.qb,zn=!0),!zn)if(W(tt),Ft.jc){Nn=tt,tr=G;var Oi=$t,Pr=Ft.pd[V(Nn)&ba-1];e(Ft.jc),256>Pr.g?(X(Nn,Nn.u+Pr.g),tr[Oi]=Pr.value,Nn=0):(X(Nn,Nn.u+Pr.g-256),e(256<=Pr.value),Nn=Pr.value),Nn==0&&(zn=!0)}else Nn=Jt(Ft.G[0],Ft.H[0],tt);if(tt.h)break;if(zn||256>Nn){if(!zn)if(Ft.nd)G[$t]=(Ft.qb|Nn<<8)>>>0;else{if(W(tt),zn=Jt(Ft.G[1],Ft.H[1],tt),W(tt),tr=Jt(Ft.G[2],Ft.H[2],tt),Oi=Jt(Ft.G[3],Ft.H[3],tt),tt.h)break;G[$t]=(Oi<<24|zn<<16|Nn<<8|tr)>>>0}if(zn=!1,++$t,++We>=he&&(We=0,++Ne,Ie!=null&&Ne<=Fe&&!(Ne%16)&&Ie(P,Ne),Lt!=null))for(;Xe<$t;)Nn=G[Xe++],Lt.X[(506832829*Nn&4294967295)>>>Lt.Mb]=Nn}else if(280>Nn){if(Nn=Wt(Nn-256,tt),tr=Jt(Ft.G[4],Ft.H[4],tt),W(tt),tr=Vt(he,tr=Wt(tr,tt)),tt.h)break;if($t-le<tr||Te-$t<Nn)break e;for(Oi=0;Oi<Nn;++Oi)G[$t+Oi]=G[$t+Oi-tr];for($t+=Nn,We+=Nn;We>=he;)We-=he,++Ne,Ie!=null&&Ne<=Fe&&!(Ne%16)&&Ie(P,Ne);if(e($t<=Te),We&bn&&(Ft=Ut(wt,We,Ne)),Lt!=null)for(;Xe<$t;)Nn=G[Xe++],Lt.X[(506832829*Nn&4294967295)>>>Lt.Mb]=Nn}else{if(!(Nn<Ht))break e;for(zn=Nn-280,e(Lt!=null);Xe<$t;)Nn=G[Xe++],Lt.X[(506832829*Nn&4294967295)>>>Lt.Mb]=Nn;Nn=$t,e(!(zn>>>(tr=Lt).Xa)),G[Nn]=tr.X[zn],zn=!0}zn||e(tt.h==Q(tt))}if(P.Pb&&tt.h&&$t<Te)e(P.m.h),P.a=5,P.m=P.wd,P.$=P.xd,0<P.s.ua&&Ae(P.s.vb,P.s.Wa);else{if(tt.h)break e;Ie!=null&&Ie(P,Ne>Fe?Fe:Ne),P.a=0,P.$=$t-le}return 1}return P.a=3,0}function ti(P){e(P!=null),P.vc=null,P.yc=null,P.Ya=null;var G=P.Wa;G!=null&&(G.X=null),P.vb=null,e(P!=null)}function ri(){var P=new sr;return P==null?null:(P.a=0,P.xb=ag,Le("Predictor","VP8LPredictors"),Le("Predictor","VP8LPredictors_C"),Le("PredictorAdd","VP8LPredictorsAdd"),Le("PredictorAdd","VP8LPredictorsAdd_C"),su=Me,_c=He,Kc=Oe,Sl=ke,nc=je,Ar=rt,Os=_t,b.VP8LMapColor32b=Ca,b.VP8LMapColor8b=tc,P)}function bi(P,G,le,he,Te){var Fe=1,Ie=[P],Ne=[G],We=he.m,tt=he.s,wt=null,$t=0;e:for(;;){if(le)for(;Fe&&U(We,1);){var Xe=Ie,Et=Ne,Ht=he,mn=1,Lt=Ht.m,bn=Ht.gc[Ht.ab],Ft=U(Lt,2);if(Ht.Oc&1<<Ft)Fe=0;else{switch(Ht.Oc|=1<<Ft,bn.hc=Ft,bn.Ea=Xe[0],bn.nc=Et[0],bn.K=[null],++Ht.ab,e(4>=Ht.ab),Ft){case 0:case 1:bn.b=U(Lt,3)+2,mn=bi(ae(bn.Ea,bn.b),ae(bn.nc,bn.b),0,Ht,bn.K),bn.K=bn.K[0];break;case 3:var zn,Nn=U(Lt,8)+1,tr=16<Nn?0:4<Nn?1:2<Nn?2:3;if(Xe[0]=ae(bn.Ea,tr),bn.b=tr,zn=mn=bi(Nn,1,0,Ht,bn.K)){var Oi,Pr=Nn,Hi=bn,fs=1<<(8>>Hi.b),Ta=s(fs);if(Ta==null)zn=0;else{var Vr=Hi.K[0],$i=Hi.w;for(Ta[0]=Hi.K[0][0],Oi=1;Oi<1*Pr;++Oi)Ta[Oi]=me(Vr[$i+Oi],Ta[Oi-1]);for(;Oi<4*fs;++Oi)Ta[Oi]=0;Hi.K[0]=null,Hi.K[0]=Ta,zn=1}}mn=zn;break;case 2:break;default:e(0)}Fe=mn}}if(Ie=Ie[0],Ne=Ne[0],Fe&&U(We,1)&&!(Fe=1<=($t=U(We,4))&&11>=$t)){he.a=3;break e}var di;if(di=Fe)t:{var Xo,nr,Mr,Es=he,Ka=Ie,Ul=Ne,Hs=$t,Bl=le,Ho=Es.m,qa=Es.s,Fs=[null],Zs=1,Yo=0,Js=Rl[Hs];n:for(;;){if(Bl&&U(Ho,1)){var Ba=U(Ho,3)+2,Ec=ae(Ka,Ba),Wo=ae(Ul,Ba),El=Ec*Wo;if(!bi(Ec,Wo,0,Es,Fs))break n;for(Fs=Fs[0],qa.xc=Ba,Xo=0;Xo<El;++Xo){var eo=Fs[Xo]>>8&65535;Fs[Xo]=eo,eo>=Zs&&(Zs=eo+1)}}if(Ho.h)break n;for(nr=0;5>nr;++nr){var Ko=sg[nr];!nr&&0<Hs&&(Ko+=1<<Hs),Yo<Ko&&(Yo=Ko)}var oc=o(Zs*Js,B),Fl=Zs,ac=o(Fl,z);if(ac==null)var Fc=null;else e(65536>=Fl),Fc=ac;var Ol=s(Yo);if(Fc==null||Ol==null||oc==null){Es.a=1;break n}var Zc=oc;for(Xo=Mr=0;Xo<Zs;++Xo){var so=Fc[Xo],lc=so.G,Gs=so.H,Rr=0,bo=1,ms=0;for(nr=0;5>nr;++nr){Ko=sg[nr],lc[nr]=Zc,Gs[nr]=Mr,!nr&&0<Hs&&(Ko+=1<<Hs);r:{var Ea,cc=Ko,Gu=Es,qo=Ol,lg=Zc,DA=Mr,Mf=0,au=Gu.m,cg=U(au,1);if(r(qo,0,0,cc),cg){var kc=U(au,1)+1,K1=U(au,1),P0=U(au,K1==0?1:8);qo[P0]=1,kc==2&&(qo[P0=U(au,8)]=1);var wh=1}else{var jA=s(19),hg=U(au,4)+4;if(19<hg){Gu.a=3;var Rf=0;break r}for(Ea=0;Ea<hg;++Ea)jA[Rd[Ea]]=U(au,3);var lu=void 0,Ud=void 0,Xu=Gu,N0=jA,Od=cc,L0=qo,Uf=0,Oh=Xu.m,kl=8,Yu=o(128,B);i:for(;k(Yu,0,7,N0,19);){if(U(Oh,1)){var vh=2+2*U(Oh,3);if((lu=2+U(Oh,vh))>Od)break i}else lu=Od;for(Ud=0;Ud<Od&&lu--;){W(Oh);var hc=Yu[0+(127&V(Oh))];X(Oh,Oh.u+hc.g);var PA=hc.value;if(16>PA)L0[Ud++]=PA,PA!=0&&(kl=PA);else{var q1=PA==16,M0=PA-16,FS=ls[M0],Ku=U(Oh,Eo[M0])+FS;if(Ud+Ku>Od)break i;for(var $v=q1?kl:0;0<Ku--;)L0[Ud++]=$v}}Uf=1;break i}Uf||(Xu.a=3),wh=Uf}(wh=wh&&!au.h)&&(Mf=k(lg,DA,8,qo,cc)),wh&&Mf!=0?Rf=Mf:(Gu.a=3,Rf=0)}if(Rf==0)break n;if(bo&&V1[nr]==1&&(bo=Zc[Mr].g==0),Rr+=Zc[Mr].g,Mr+=Rf,3>=nr){var Of,ug=Ol[0];for(Of=1;Of<Ko;++Of)Ol[Of]>ug&&(ug=Ol[Of]);ms+=ug}}if(so.nd=bo,so.Qb=0,bo&&(so.qb=(lc[3][Gs[3]+0].value<<24|lc[1][Gs[1]+0].value<<16|lc[2][Gs[2]+0].value)>>>0,Rr==0&&256>lc[0][Gs[0]+0].value&&(so.Qb=1,so.qb+=lc[0][Gs[0]+0].value<<8)),so.jc=!so.Qb&&6>ms,so.jc){var cu,hu=so;for(cu=0;cu<ba;++cu){var qu=cu,uu=hu.pd[qu],NA=hu.G[0][hu.H[0]+qu];256<=NA.value?(uu.g=NA.g+256,uu.value=NA.value):(uu.g=0,uu.value=0,qu>>=It(NA,8,uu),qu>>=It(hu.G[1][hu.H[1]+qu],16,uu),qu>>=It(hu.G[2][hu.H[2]+qu],0,uu),It(hu.G[3][hu.H[3]+qu],24,uu))}}}qa.vc=Fs,qa.Wb=Zs,qa.Ya=Fc,qa.yc=oc,di=1;break t}di=0}if(!(Fe=di)){he.a=3;break e}if(0<$t){if(tt.ua=1<<$t,!Z(tt.Wa,$t)){he.a=1,Fe=0;break e}}else tt.ua=0;var Z1=he,Vv=Ie,Gv=Ne,R0=Z1.s,Zu=R0.xc;if(Z1.c=Vv,Z1.i=Gv,R0.md=ae(Vv,Zu),R0.wc=Zu==0?-1:(1<<Zu)-1,le){he.xb=Nf;break e}if((wt=s(Ie*Ne))==null){he.a=1,Fe=0;break e}Fe=(Fe=Hn(he,wt,0,Ie,Ne,Ne,null))&&!We.h;break e}return Fe?(Te!=null?Te[0]=wt:(e(wt==null),e(le)),he.$=0,le||ti(tt)):ti(tt),Fe}function Ni(P,G){var le=P.c*P.i,he=le+G+16*G;return e(P.c<=G),P.V=s(he),P.V==null?(P.Ta=null,P.Ua=0,P.a=1,0):(P.Ta=P.V,P.Ua=P.Ba+le+G,1)}function ui(P,G){var le=P.C,he=G-le,Te=P.V,Fe=P.Ba+P.c*le;for(e(G<=P.l.o);0<he;){var Ie=16<he?16:he,Ne=P.l.ma,We=P.l.width,tt=We*Ie,wt=Ne.ca,$t=Ne.tb+We*le,Xe=P.Ta,Et=P.Ua;un(P,Ie,Te,Fe),ur(Xe,Et,wt,$t,tt),fn(Ne,le,le+Ie,wt,$t,We),he-=Ie,Te+=Ie*P.c,le+=Ie}e(le==G),P.C=P.Ma=G}function si(){this.ub=this.yd=this.td=this.Rb=0}function Li(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Tr(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function xr(){this.Yb=(function(){var P=[];return(function G(le,he,Te){for(var Fe=Te[he],Ie=0;Ie<Fe&&(le.push(Te.length>he+1?[]:0),!(Te.length<he+1));Ie++)G(le[Ie],he+1,Te)})(P,0,[3,11]),P})()}function br(){this.jb=s(3),this.Wc=a([4,8],xr),this.Xc=a([4,17],xr)}function vn(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function wi(){this.ld=this.La=this.dd=this.tc=0}function Ve(){this.Na=this.la=0}function ct(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function mt(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function An(){this.uc=this.M=this.Nb=0,this.wa=Array(new wi),this.Y=0,this.ya=Array(new mt),this.aa=0,this.l=new gn}function nn(){this.y=s(16),this.f=s(8),this.ea=s(8)}function zt(){this.cb=this.a=0,this.sc="",this.m=new Y,this.Od=new si,this.Kc=new Li,this.ed=new vn,this.Qa=new Tr,this.Ic=this.$c=this.Aa=0,this.D=new An,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,Y),this.ia=0,this.pb=o(4,ct),this.Pa=new br,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new nn),this.Hd=0,this.rb=Array(new Ve),this.sb=0,this.wa=Array(new wi),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new mt),this.L=this.aa=0,this.gd=a([4,2],wi),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function gn(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Jn(){var P=new zt;return P!=null&&(P.a=0,P.sc="OK",P.cb=0,P.Xb=0,Tl||(Tl=Dn)),P}function Qn(P,G,le){return P.a==0&&(P.a=G,P.sc=le,P.cb=0),0}function pn(P,G,le){return 3<=le&&P[G+0]==157&&P[G+1]==1&&P[G+2]==42}function Ln(P,G){if(P==null)return 0;if(P.a=0,P.sc="OK",G==null)return Qn(P,2,"null VP8Io passed to VP8GetHeaders()");var le=G.data,he=G.w,Te=G.ha;if(4>Te)return Qn(P,7,"Truncated header.");var Fe=le[he+0]|le[he+1]<<8|le[he+2]<<16,Ie=P.Od;if(Ie.Rb=!(1&Fe),Ie.td=Fe>>1&7,Ie.yd=Fe>>4&1,Ie.ub=Fe>>5,3<Ie.td)return Qn(P,3,"Incorrect keyframe parameters.");if(!Ie.yd)return Qn(P,4,"Frame not displayable.");he+=3,Te-=3;var Ne=P.Kc;if(Ie.Rb){if(7>Te)return Qn(P,7,"cannot parse picture header");if(!pn(le,he,Te))return Qn(P,3,"Bad code word");Ne.c=16383&(le[he+4]<<8|le[he+3]),Ne.Td=le[he+4]>>6,Ne.i=16383&(le[he+6]<<8|le[he+5]),Ne.Ud=le[he+6]>>6,he+=7,Te-=7,P.za=Ne.c+15>>4,P.Ub=Ne.i+15>>4,G.width=Ne.c,G.height=Ne.i,G.Da=0,G.j=0,G.v=0,G.va=G.width,G.o=G.height,G.da=0,G.ib=G.width,G.hb=G.height,G.U=G.width,G.T=G.height,r((Fe=P.Pa).jb,0,255,Fe.jb.length),e((Fe=P.Qa)!=null),Fe.Cb=0,Fe.Bb=0,Fe.Fb=1,r(Fe.Zb,0,0,Fe.Zb.length),r(Fe.Lb,0,0,Fe.Lb)}if(Ie.ub>Te)return Qn(P,7,"bad partition length");te(Fe=P.m,le,he,Ie.ub),he+=Ie.ub,Te-=Ie.ub,Ie.Rb&&(Ne.Ld=q(Fe),Ne.Kd=q(Fe)),Ne=P.Qa;var We,tt=P.Pa;if(e(Fe!=null),e(Ne!=null),Ne.Cb=q(Fe),Ne.Cb){if(Ne.Bb=q(Fe),q(Fe)){for(Ne.Fb=q(Fe),We=0;4>We;++We)Ne.Zb[We]=q(Fe)?O(Fe,7):0;for(We=0;4>We;++We)Ne.Lb[We]=q(Fe)?O(Fe,6):0}if(Ne.Bb)for(We=0;3>We;++We)tt.jb[We]=q(Fe)?L(Fe,8):255}else Ne.Bb=0;if(Fe.Ka)return Qn(P,3,"cannot parse segment header");if((Ne=P.ed).zd=q(Fe),Ne.Tb=L(Fe,6),Ne.wb=L(Fe,3),Ne.Pc=q(Fe),Ne.Pc&&q(Fe)){for(tt=0;4>tt;++tt)q(Fe)&&(Ne.vd[tt]=O(Fe,6));for(tt=0;4>tt;++tt)q(Fe)&&(Ne.od[tt]=O(Fe,6))}if(P.L=Ne.Tb==0?0:Ne.zd?1:2,Fe.Ka)return Qn(P,3,"cannot parse filter header");var wt=Te;if(Te=We=he,he=We+wt,Ne=wt,P.Xb=(1<<L(P.m,2))-1,wt<3*(tt=P.Xb))le=7;else{for(We+=3*tt,Ne-=3*tt,wt=0;wt<tt;++wt){var $t=le[Te+0]|le[Te+1]<<8|le[Te+2]<<16;$t>Ne&&($t=Ne),te(P.Jc[+wt],le,We,$t),We+=$t,Ne-=$t,Te+=3}te(P.Jc[+tt],le,We,Ne),le=We<he?0:5}if(le!=0)return Qn(P,le,"cannot parse partitions");for(le=L(We=P.m,7),Te=q(We)?O(We,4):0,he=q(We)?O(We,4):0,Ne=q(We)?O(We,4):0,tt=q(We)?O(We,4):0,We=q(We)?O(We,4):0,wt=P.Qa,$t=0;4>$t;++$t){if(wt.Cb){var Xe=wt.Zb[$t];wt.Fb||(Xe+=le)}else{if(0<$t){P.pb[$t]=P.pb[0];continue}Xe=le}var Et=P.pb[$t];Et.Sc[0]=qs[rs(Xe+Te,127)],Et.Sc[1]=$u[rs(Xe+0,127)],Et.Eb[0]=2*qs[rs(Xe+he,127)],Et.Eb[1]=101581*$u[rs(Xe+Ne,127)]>>16,8>Et.Eb[1]&&(Et.Eb[1]=8),Et.Qc[0]=qs[rs(Xe+tt,117)],Et.Qc[1]=$u[rs(Xe+We,127)],Et.lc=Xe+We}if(!Ie.Rb)return Qn(P,4,"Not a key frame.");for(q(Fe),Ie=P.Pa,le=0;4>le;++le){for(Te=0;8>Te;++Te)for(he=0;3>he;++he)for(Ne=0;11>Ne;++Ne)tt=de(Fe,qc[le][Te][he][Ne])?L(Fe,8):Uh[le][Te][he][Ne],Ie.Wc[le][Te].Yb[he][Ne]=tt;for(Te=0;17>Te;++Te)Ie.Xc[le][Te]=Ie.Wc[le][k0[Te]]}return P.kc=q(Fe),P.kc&&(P.Bd=L(Fe,8)),P.cb=1}function Dn(P,G,le,he,Te,Fe,Ie){var Ne=G[Te].Yb[le];for(le=0;16>Te;++Te){if(!de(P,Ne[le+0]))return Te;for(;!de(P,Ne[le+1]);)if(Ne=G[++Te].Yb[0],le=0,Te==16)return 16;var We=G[Te+1].Yb;if(de(P,Ne[le+2])){var tt=P,wt=0;if(de(tt,(Xe=Ne)[($t=le)+3]))if(de(tt,Xe[$t+6])){for(Ne=0,$t=2*(wt=de(tt,Xe[$t+8]))+(Xe=de(tt,Xe[$t+9+wt])),wt=0,Xe=F0[$t];Xe[Ne];++Ne)wt+=wt+de(tt,Xe[Ne]);wt+=3+(8<<$t)}else de(tt,Xe[$t+7])?(wt=7+2*de(tt,165),wt+=de(tt,145)):wt=5+de(tt,159);else wt=de(tt,Xe[$t+4])?3+de(tt,Xe[$t+5]):2;Ne=We[2]}else wt=1,Ne=We[1];We=Ie+rc[Te],0>(tt=P).b&&se(tt);var $t,Xe=tt.b,Et=($t=tt.Ca>>1)-(tt.I>>Xe)>>31;--tt.b,tt.Ca+=Et,tt.Ca|=1,tt.I-=($t+1&Et)<<Xe,Fe[We]=((wt^Et)-Et)*he[(0<Te)+0]}return 16}function ei(P){var G=P.rb[P.sb-1];G.la=0,G.Na=0,r(P.zc,0,0,P.zc.length),P.ja=0}function xi(P,G,le,he,Te){Te=P[G+le+32*he]+(Te>>3),P[G+le+32*he]=-256&Te?0>Te?0:255:Te}function Yi(P,G,le,he,Te,Fe){xi(P,G,0,le,he+Te),xi(P,G,1,le,he+Fe),xi(P,G,2,le,he-Fe),xi(P,G,3,le,he-Te)}function Bn(P){return(20091*P>>16)+P}function Ri(P,G,le,he){var Te,Fe=0,Ie=s(16);for(Te=0;4>Te;++Te){var Ne=P[G+0]+P[G+8],We=P[G+0]-P[G+8],tt=(35468*P[G+4]>>16)-Bn(P[G+12]),wt=Bn(P[G+4])+(35468*P[G+12]>>16);Ie[Fe+0]=Ne+wt,Ie[Fe+1]=We+tt,Ie[Fe+2]=We-tt,Ie[Fe+3]=Ne-wt,Fe+=4,G++}for(Te=Fe=0;4>Te;++Te)Ne=(P=Ie[Fe+0]+4)+Ie[Fe+8],We=P-Ie[Fe+8],tt=(35468*Ie[Fe+4]>>16)-Bn(Ie[Fe+12]),xi(le,he,0,0,Ne+(wt=Bn(Ie[Fe+4])+(35468*Ie[Fe+12]>>16))),xi(le,he,1,0,We+tt),xi(le,he,2,0,We-tt),xi(le,he,3,0,Ne-wt),Fe++,he+=32}function xt(P,G,le,he){var Te=P[G+0]+4,Fe=35468*P[G+4]>>16,Ie=Bn(P[G+4]),Ne=35468*P[G+1]>>16;Yi(le,he,0,Te+Ie,P=Bn(P[G+1]),Ne),Yi(le,he,1,Te+Fe,P,Ne),Yi(le,he,2,Te-Fe,P,Ne),Yi(le,he,3,Te-Ie,P,Ne)}function Bt(P,G,le,he,Te){Ri(P,G,le,he),Te&&Ri(P,G+16,le,he+4)}function on(P,G,le,he){vo(P,G+0,le,he,1),vo(P,G+32,le,he+128,1)}function ln(P,G,le,he){var Te;for(P=P[G+0]+4,Te=0;4>Te;++Te)for(G=0;4>G;++G)xi(le,he,G,Te,P)}function li(P,G,le,he){P[G+0]&&Va(P,G+0,le,he),P[G+16]&&Va(P,G+16,le,he+4),P[G+32]&&Va(P,G+32,le,he+128),P[G+48]&&Va(P,G+48,le,he+128+4)}function hi(P,G,le,he){var Te,Fe=s(16);for(Te=0;4>Te;++Te){var Ie=P[G+0+Te]+P[G+12+Te],Ne=P[G+4+Te]+P[G+8+Te],We=P[G+4+Te]-P[G+8+Te],tt=P[G+0+Te]-P[G+12+Te];Fe[0+Te]=Ie+Ne,Fe[8+Te]=Ie-Ne,Fe[4+Te]=tt+We,Fe[12+Te]=tt-We}for(Te=0;4>Te;++Te)Ie=(P=Fe[0+4*Te]+3)+Fe[3+4*Te],Ne=Fe[1+4*Te]+Fe[2+4*Te],We=Fe[1+4*Te]-Fe[2+4*Te],tt=P-Fe[3+4*Te],le[he+0]=Ie+Ne>>3,le[he+16]=tt+We>>3,le[he+32]=Ie-Ne>>3,le[he+48]=tt-We>>3,he+=64}function Ii(P,G,le){var he,Te=G-32,Fe=mr,Ie=255-P[Te-1];for(he=0;he<le;++he){var Ne,We=Fe,tt=Ie+P[G-1];for(Ne=0;Ne<le;++Ne)P[G+Ne]=We[tt+P[Te+Ne]];G+=32}}function kr(P,G){Ii(P,G,4)}function zr(P,G){Ii(P,G,8)}function Us(P,G){Ii(P,G,16)}function io(P,G){var le;for(le=0;16>le;++le)i(P,G+32*le,P,G-32,16)}function ws(P,G){var le;for(le=16;0<le;--le)r(P,G,P[G-1],16),G+=32}function Ts(P,G,le){var he;for(he=0;16>he;++he)r(G,le+32*he,P,16)}function Mn(P,G){var le,he=16;for(le=0;16>le;++le)he+=P[G-1+32*le]+P[G+le-32];Ts(he>>5,P,G)}function ve(P,G){var le,he=8;for(le=0;16>le;++le)he+=P[G-1+32*le];Ts(he>>4,P,G)}function Re(P,G){var le,he=8;for(le=0;16>le;++le)he+=P[G+le-32];Ts(he>>4,P,G)}function Ke(P,G){Ts(128,P,G)}function Ge(P,G,le){return P+2*G+le+2>>2}function pt(P,G){var le,he=G-32;for(he=new Uint8Array([Ge(P[he-1],P[he+0],P[he+1]),Ge(P[he+0],P[he+1],P[he+2]),Ge(P[he+1],P[he+2],P[he+3]),Ge(P[he+2],P[he+3],P[he+4])]),le=0;4>le;++le)i(P,G+32*le,he,0,he.length)}function Pt(P,G){var le=P[G-1],he=P[G-1+32],Te=P[G-1+64],Fe=P[G-1+96];Ce(P,G+0,16843009*Ge(P[G-1-32],le,he)),Ce(P,G+32,16843009*Ge(le,he,Te)),Ce(P,G+64,16843009*Ge(he,Te,Fe)),Ce(P,G+96,16843009*Ge(Te,Fe,Fe))}function pe(P,G){var le,he=4;for(le=0;4>le;++le)he+=P[G+le-32]+P[G-1+32*le];for(he>>=3,le=0;4>le;++le)r(P,G+32*le,he,4)}function xe(P,G){var le=P[G-1+0],he=P[G-1+32],Te=P[G-1+64],Fe=P[G-1-32],Ie=P[G+0-32],Ne=P[G+1-32],We=P[G+2-32],tt=P[G+3-32];P[G+0+96]=Ge(he,Te,P[G-1+96]),P[G+1+96]=P[G+0+64]=Ge(le,he,Te),P[G+2+96]=P[G+1+64]=P[G+0+32]=Ge(Fe,le,he),P[G+3+96]=P[G+2+64]=P[G+1+32]=P[G+0+0]=Ge(Ie,Fe,le),P[G+3+64]=P[G+2+32]=P[G+1+0]=Ge(Ne,Ie,Fe),P[G+3+32]=P[G+2+0]=Ge(We,Ne,Ie),P[G+3+0]=Ge(tt,We,Ne)}function at(P,G){var le=P[G+1-32],he=P[G+2-32],Te=P[G+3-32],Fe=P[G+4-32],Ie=P[G+5-32],Ne=P[G+6-32],We=P[G+7-32];P[G+0+0]=Ge(P[G+0-32],le,he),P[G+1+0]=P[G+0+32]=Ge(le,he,Te),P[G+2+0]=P[G+1+32]=P[G+0+64]=Ge(he,Te,Fe),P[G+3+0]=P[G+2+32]=P[G+1+64]=P[G+0+96]=Ge(Te,Fe,Ie),P[G+3+32]=P[G+2+64]=P[G+1+96]=Ge(Fe,Ie,Ne),P[G+3+64]=P[G+2+96]=Ge(Ie,Ne,We),P[G+3+96]=Ge(Ne,We,We)}function dt(P,G){var le=P[G-1+0],he=P[G-1+32],Te=P[G-1+64],Fe=P[G-1-32],Ie=P[G+0-32],Ne=P[G+1-32],We=P[G+2-32],tt=P[G+3-32];P[G+0+0]=P[G+1+64]=Fe+Ie+1>>1,P[G+1+0]=P[G+2+64]=Ie+Ne+1>>1,P[G+2+0]=P[G+3+64]=Ne+We+1>>1,P[G+3+0]=We+tt+1>>1,P[G+0+96]=Ge(Te,he,le),P[G+0+64]=Ge(he,le,Fe),P[G+0+32]=P[G+1+96]=Ge(le,Fe,Ie),P[G+1+32]=P[G+2+96]=Ge(Fe,Ie,Ne),P[G+2+32]=P[G+3+96]=Ge(Ie,Ne,We),P[G+3+32]=Ge(Ne,We,tt)}function Qt(P,G){var le=P[G+0-32],he=P[G+1-32],Te=P[G+2-32],Fe=P[G+3-32],Ie=P[G+4-32],Ne=P[G+5-32],We=P[G+6-32],tt=P[G+7-32];P[G+0+0]=le+he+1>>1,P[G+1+0]=P[G+0+64]=he+Te+1>>1,P[G+2+0]=P[G+1+64]=Te+Fe+1>>1,P[G+3+0]=P[G+2+64]=Fe+Ie+1>>1,P[G+0+32]=Ge(le,he,Te),P[G+1+32]=P[G+0+96]=Ge(he,Te,Fe),P[G+2+32]=P[G+1+96]=Ge(Te,Fe,Ie),P[G+3+32]=P[G+2+96]=Ge(Fe,Ie,Ne),P[G+3+64]=Ge(Ie,Ne,We),P[G+3+96]=Ge(Ne,We,tt)}function wn(P,G){var le=P[G-1+0],he=P[G-1+32],Te=P[G-1+64],Fe=P[G-1+96];P[G+0+0]=le+he+1>>1,P[G+2+0]=P[G+0+32]=he+Te+1>>1,P[G+2+32]=P[G+0+64]=Te+Fe+1>>1,P[G+1+0]=Ge(le,he,Te),P[G+3+0]=P[G+1+32]=Ge(he,Te,Fe),P[G+3+32]=P[G+1+64]=Ge(Te,Fe,Fe),P[G+3+64]=P[G+2+64]=P[G+0+96]=P[G+1+96]=P[G+2+96]=P[G+3+96]=Fe}function gt(P,G){var le=P[G-1+0],he=P[G-1+32],Te=P[G-1+64],Fe=P[G-1+96],Ie=P[G-1-32],Ne=P[G+0-32],We=P[G+1-32],tt=P[G+2-32];P[G+0+0]=P[G+2+32]=le+Ie+1>>1,P[G+0+32]=P[G+2+64]=he+le+1>>1,P[G+0+64]=P[G+2+96]=Te+he+1>>1,P[G+0+96]=Fe+Te+1>>1,P[G+3+0]=Ge(Ne,We,tt),P[G+2+0]=Ge(Ie,Ne,We),P[G+1+0]=P[G+3+32]=Ge(le,Ie,Ne),P[G+1+32]=P[G+3+64]=Ge(he,le,Ie),P[G+1+64]=P[G+3+96]=Ge(Te,he,le),P[G+1+96]=Ge(Fe,Te,he)}function Vn(P,G){var le;for(le=0;8>le;++le)i(P,G+32*le,P,G-32,8)}function Yn(P,G){var le;for(le=0;8>le;++le)r(P,G,P[G-1],8),G+=32}function ht(P,G,le){var he;for(he=0;8>he;++he)r(G,le+32*he,P,8)}function Ot(P,G){var le,he=8;for(le=0;8>le;++le)he+=P[G+le-32]+P[G-1+32*le];ht(he>>4,P,G)}function In(P,G){var le,he=4;for(le=0;8>le;++le)he+=P[G+le-32];ht(he>>3,P,G)}function Wn(P,G){var le,he=4;for(le=0;8>le;++le)he+=P[G-1+32*le];ht(he>>3,P,G)}function xn(P,G){ht(128,P,G)}function Gn(P,G,le){var he=P[G-le],Te=P[G+0],Fe=3*(Te-he)+Ml[1020+P[G-2*le]-P[G+le]],Ie=Dr[112+(Fe+4>>3)];P[G-le]=mr[255+he+Dr[112+(Fe+3>>3)]],P[G+0]=mr[255+Te-Ie]}function fi(P,G,le,he){var Te=P[G+0],Fe=P[G+le];return Ps[255+P[G-2*le]-P[G-le]]>he||Ps[255+Fe-Te]>he}function Ki(P,G,le,he){return 4*Ps[255+P[G-le]-P[G+0]]+Ps[255+P[G-2*le]-P[G+le]]<=he}function Ji(P,G,le,he,Te){var Fe=P[G-3*le],Ie=P[G-2*le],Ne=P[G-le],We=P[G+0],tt=P[G+le],wt=P[G+2*le],$t=P[G+3*le];return 4*Ps[255+Ne-We]+Ps[255+Ie-tt]>he?0:Ps[255+P[G-4*le]-Fe]<=Te&&Ps[255+Fe-Ie]<=Te&&Ps[255+Ie-Ne]<=Te&&Ps[255+$t-wt]<=Te&&Ps[255+wt-tt]<=Te&&Ps[255+tt-We]<=Te}function Ci(P,G,le,he){var Te=2*he+1;for(he=0;16>he;++he)Ki(P,G+he,le,Te)&&Gn(P,G+he,le)}function Qi(P,G,le,he){var Te=2*he+1;for(he=0;16>he;++he)Ki(P,G+he*le,1,Te)&&Gn(P,G+he*le,1)}function zi(P,G,le,he){var Te;for(Te=3;0<Te;--Te)Ci(P,G+=4*le,le,he)}function Ir(P,G,le,he){var Te;for(Te=3;0<Te;--Te)Qi(P,G+=4,le,he)}function Hr(P,G,le,he,Te,Fe,Ie,Ne){for(Fe=2*Fe+1;0<Te--;){if(Ji(P,G,le,Fe,Ie))if(fi(P,G,le,Ne))Gn(P,G,le);else{var We=P,tt=G,wt=le,$t=We[tt-2*wt],Xe=We[tt-wt],Et=We[tt+0],Ht=We[tt+wt],mn=We[tt+2*wt],Lt=27*(Ft=Ml[1020+3*(Et-Xe)+Ml[1020+$t-Ht]])+63>>7,bn=18*Ft+63>>7,Ft=9*Ft+63>>7;We[tt-3*wt]=mr[255+We[tt-3*wt]+Ft],We[tt-2*wt]=mr[255+$t+bn],We[tt-wt]=mr[255+Xe+Lt],We[tt+0]=mr[255+Et-Lt],We[tt+wt]=mr[255+Ht-bn],We[tt+2*wt]=mr[255+mn-Ft]}G+=he}}function Si(P,G,le,he,Te,Fe,Ie,Ne){for(Fe=2*Fe+1;0<Te--;){if(Ji(P,G,le,Fe,Ie))if(fi(P,G,le,Ne))Gn(P,G,le);else{var We=P,tt=G,wt=le,$t=We[tt-wt],Xe=We[tt+0],Et=We[tt+wt],Ht=Dr[112+(4+(mn=3*(Xe-$t))>>3)],mn=Dr[112+(mn+3>>3)],Lt=Ht+1>>1;We[tt-2*wt]=mr[255+We[tt-2*wt]+Lt],We[tt-wt]=mr[255+$t+mn],We[tt+0]=mr[255+Xe-Ht],We[tt+wt]=mr[255+Et-Lt]}G+=he}}function re(P,G,le,he,Te,Fe){Hr(P,G,le,1,16,he,Te,Fe)}function be(P,G,le,he,Te,Fe){Hr(P,G,1,le,16,he,Te,Fe)}function Ue(P,G,le,he,Te,Fe){var Ie;for(Ie=3;0<Ie;--Ie)Si(P,G+=4*le,le,1,16,he,Te,Fe)}function ut(P,G,le,he,Te,Fe){var Ie;for(Ie=3;0<Ie;--Ie)Si(P,G+=4,1,le,16,he,Te,Fe)}function yt(P,G,le,he,Te,Fe,Ie,Ne){Hr(P,G,Te,1,8,Fe,Ie,Ne),Hr(le,he,Te,1,8,Fe,Ie,Ne)}function en(P,G,le,he,Te,Fe,Ie,Ne){Hr(P,G,1,Te,8,Fe,Ie,Ne),Hr(le,he,1,Te,8,Fe,Ie,Ne)}function cn(P,G,le,he,Te,Fe,Ie,Ne){Si(P,G+4*Te,Te,1,8,Fe,Ie,Ne),Si(le,he+4*Te,Te,1,8,Fe,Ie,Ne)}function Tn(P,G,le,he,Te,Fe,Ie,Ne){Si(P,G+4,1,Te,8,Fe,Ie,Ne),Si(le,he+4,1,Te,8,Fe,Ie,Ne)}function $n(){this.ba=new st,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new ft,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function ai(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function ni(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Rn(){this.ua=0,this.Wa=new ie,this.vb=new ie,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new z,this.yc=new B}function sr(){this.xb=this.a=0,this.l=new gn,this.ca=new st,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new K,this.Pb=0,this.wd=new K,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Rn,this.ab=0,this.gc=o(4,ni),this.Oc=0}function dr(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new gn,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function qr(P,G,le,he,Te,Fe,Ie){for(P=P==null?0:P[G+0],G=0;G<Ie;++G)Te[Fe+G]=P+le[he+G]&255,P=Te[Fe+G]}function vs(P,G,le,he,Te,Fe,Ie){var Ne;if(P==null)qr(null,null,le,he,Te,Fe,Ie);else for(Ne=0;Ne<Ie;++Ne)Te[Fe+Ne]=P[G+Ne]+le[he+Ne]&255}function Cr(P,G,le,he,Te,Fe,Ie){if(P==null)qr(null,null,le,he,Te,Fe,Ie);else{var Ne,We=P[G+0],tt=We,wt=We;for(Ne=0;Ne<Ie;++Ne)tt=wt+(We=P[G+Ne])-tt,wt=le[he+Ne]+(-256&tt?0>tt?0:255:tt)&255,tt=We,Te[Fe+Ne]=wt}}function cs(P,G,le,he){var Te=G.width,Fe=G.o;if(e(P!=null&&G!=null),0>le||0>=he||le+he>Fe)return null;if(!P.Cc){if(P.ga==null){var Ie;if(P.ga=new dr,(Ie=P.ga==null)||(Ie=G.width*G.o,e(P.Gb.length==0),P.Gb=s(Ie),P.Uc=0,P.Gb==null?Ie=0:(P.mb=P.Gb,P.nb=P.Uc,P.rc=null,Ie=1),Ie=!Ie),!Ie){Ie=P.ga;var Ne=P.Fa,We=P.P,tt=P.qc,wt=P.mb,$t=P.nb,Xe=We+1,Et=tt-1,Ht=Ie.l;if(e(Ne!=null&&wt!=null&&G!=null),Aa[0]=null,Aa[1]=qr,Aa[2]=vs,Aa[3]=Cr,Ie.ca=wt,Ie.tb=$t,Ie.c=G.width,Ie.i=G.height,e(0<Ie.c&&0<Ie.i),1>=tt)G=0;else if(Ie.$a=3&Ne[We+0],Ie.Z=Ne[We+0]>>2&3,Ie.Lc=Ne[We+0]>>4&3,We=Ne[We+0]>>6&3,0>Ie.$a||1<Ie.$a||4<=Ie.Z||1<Ie.Lc||We)G=0;else if(Ht.put=vt,Ht.ac=sn,Ht.bc=Ye,Ht.ma=Ie,Ht.width=G.width,Ht.height=G.height,Ht.Da=G.Da,Ht.v=G.v,Ht.va=G.va,Ht.j=G.j,Ht.o=G.o,Ie.$a)e:{e(Ie.$a==1),G=ri();t:for(;;){if(G==null){G=0;break e}if(e(Ie!=null),Ie.mc=G,G.c=Ie.c,G.i=Ie.i,G.l=Ie.l,G.l.ma=Ie,G.l.width=Ie.c,G.l.height=Ie.i,G.a=0,J(G.m,Ne,Xe,Et),!bi(Ie.c,Ie.i,1,G,null)||(G.ab==1&&G.gc[0].hc==3&&jt(G.s)?(Ie.ic=1,Ne=G.c*G.i,G.Ta=null,G.Ua=0,G.V=s(Ne),G.Ba=0,G.V==null?(G.a=1,G=0):G=1):(Ie.ic=0,G=Ni(G,Ie.c)),!G))break t;G=1;break e}Ie.mc=null,G=0}else G=Et>=Ie.c*Ie.i;Ie=!G}if(Ie)return null;P.ga.Lc!=1?P.Ga=0:he=Fe-le}e(P.ga!=null),e(le+he<=Fe);e:{if(G=(Ne=P.ga).c,Fe=Ne.l.o,Ne.$a==0){if(Xe=P.rc,Et=P.Vc,Ht=P.Fa,We=P.P+1+le*G,tt=P.mb,wt=P.nb+le*G,e(We<=P.P+P.qc),Ne.Z!=0)for(e(Aa[Ne.Z]!=null),Ie=0;Ie<he;++Ie)Aa[Ne.Z](Xe,Et,Ht,We,tt,wt,G),Xe=tt,Et=wt,wt+=G,We+=G;else for(Ie=0;Ie<he;++Ie)i(tt,wt,Ht,We,G),Xe=tt,Et=wt,wt+=G,We+=G;P.rc=Xe,P.Vc=Et}else{if(e(Ne.mc!=null),G=le+he,e((Ie=Ne.mc)!=null),e(G<=Ie.i),Ie.C>=G)G=1;else if(Ne.ic||Oo(),Ne.ic){Ne=Ie.V,Xe=Ie.Ba,Et=Ie.c;var mn=Ie.i,Lt=(Ht=1,We=Ie.$/Et,tt=Ie.$%Et,wt=Ie.m,$t=Ie.s,Ie.$),bn=Et*mn,Ft=Et*G,zn=$t.wc,Nn=Lt<Ft?Ut($t,tt,We):null;e(Lt<=bn),e(G<=mn),e(jt($t));t:for(;;){for(;!wt.h&&Lt<Ft;){if(tt&zn||(Nn=Ut($t,tt,We)),e(Nn!=null),W(wt),256>(mn=Jt(Nn.G[0],Nn.H[0],wt)))Ne[Xe+Lt]=mn,++Lt,++tt>=Et&&(tt=0,++We<=G&&!(We%16)&&Zn(Ie,We));else{if(!(280>mn)){Ht=0;break t}mn=Wt(mn-256,wt);var tr,Oi=Jt(Nn.G[4],Nn.H[4],wt);if(W(wt),!(Lt>=(Oi=Vt(Et,Oi=Wt(Oi,wt)))&&bn-Lt>=mn)){Ht=0;break t}for(tr=0;tr<mn;++tr)Ne[Xe+Lt+tr]=Ne[Xe+Lt+tr-Oi];for(Lt+=mn,tt+=mn;tt>=Et;)tt-=Et,++We<=G&&!(We%16)&&Zn(Ie,We);Lt<Ft&&tt&zn&&(Nn=Ut($t,tt,We))}e(wt.h==Q(wt))}Zn(Ie,We>G?G:We);break t}!Ht||wt.h&&Lt<bn?(Ht=0,Ie.a=wt.h?5:3):Ie.$=Lt,G=Ht}else G=Hn(Ie,Ie.V,Ie.Ba,Ie.c,Ie.i,G,ui);if(!G){he=0;break e}}le+he>=Fe&&(P.Cc=1),he=1}if(!he)return null;if(P.Cc&&((he=P.ga)!=null&&(he.mc=null),P.ga=null,0<P.Ga))return alert("todo:WebPDequantizeLevels"),null}return P.nb+le*Te}function Qr(P,G,le,he,Te,Fe){for(;0<Te--;){var Ie,Ne=P,We=G+(le?1:0),tt=P,wt=G+(le?0:3);for(Ie=0;Ie<he;++Ie){var $t=tt[wt+4*Ie];$t!=255&&($t*=32897,Ne[We+4*Ie+0]=Ne[We+4*Ie+0]*$t>>23,Ne[We+4*Ie+1]=Ne[We+4*Ie+1]*$t>>23,Ne[We+4*Ie+2]=Ne[We+4*Ie+2]*$t>>23)}G+=Fe}}function or(P,G,le,he,Te){for(;0<he--;){var Fe;for(Fe=0;Fe<le;++Fe){var Ie=P[G+2*Fe+0],Ne=15&(tt=P[G+2*Fe+1]),We=4369*Ne,tt=(240&tt|tt>>4)*We>>16;P[G+2*Fe+0]=(240&Ie|Ie>>4)*We>>16&240|(15&Ie|Ie<<4)*We>>16>>4&15,P[G+2*Fe+1]=240&tt|Ne}G+=Te}}function hs(P,G,le,he,Te,Fe,Ie,Ne){var We,tt,wt=255;for(tt=0;tt<Te;++tt){for(We=0;We<he;++We){var $t=P[G+We];Fe[Ie+4*We]=$t,wt&=$t}G+=le,Ie+=Ne}return wt!=255}function us(P,G,le,he,Te){var Fe;for(Fe=0;Fe<Te;++Fe)le[he+Fe]=P[G+Fe]>>8}function Oo(){Kn=Qr,os=or,En=hs,ur=us}function va(P,G,le){b[P]=function(he,Te,Fe,Ie,Ne,We,tt,wt,$t,Xe,Et,Ht,mn,Lt,bn,Ft,zn){var Nn,tr=zn-1>>1,Oi=Ne[We+0]|tt[wt+0]<<16,Pr=$t[Xe+0]|Et[Ht+0]<<16;e(he!=null);var Hi=3*Oi+Pr+131074>>2;for(G(he[Te+0],255&Hi,Hi>>16,mn,Lt),Fe!=null&&(Hi=3*Pr+Oi+131074>>2,G(Fe[Ie+0],255&Hi,Hi>>16,bn,Ft)),Nn=1;Nn<=tr;++Nn){var fs=Ne[We+Nn]|tt[wt+Nn]<<16,Ta=$t[Xe+Nn]|Et[Ht+Nn]<<16,Vr=Oi+fs+Pr+Ta+524296,$i=Vr+2*(fs+Pr)>>3;Hi=$i+Oi>>1,Oi=(Vr=Vr+2*(Oi+Ta)>>3)+fs>>1,G(he[Te+2*Nn-1],255&Hi,Hi>>16,mn,Lt+(2*Nn-1)*le),G(he[Te+2*Nn-0],255&Oi,Oi>>16,mn,Lt+(2*Nn-0)*le),Fe!=null&&(Hi=Vr+Pr>>1,Oi=$i+Ta>>1,G(Fe[Ie+2*Nn-1],255&Hi,Hi>>16,bn,Ft+(2*Nn-1)*le),G(Fe[Ie+2*Nn+0],255&Oi,Oi>>16,bn,Ft+(2*Nn+0)*le)),Oi=fs,Pr=Ta}1&zn||(Hi=3*Oi+Pr+131074>>2,G(he[Te+zn-1],255&Hi,Hi>>16,mn,Lt+(zn-1)*le),Fe!=null&&(Hi=3*Pr+Oi+131074>>2,G(Fe[Ie+zn-1],255&Hi,Hi>>16,bn,Ft+(zn-1)*le)))}}function Lh(){Zr[xo]=I0,Zr[ou]=Cn,Zr[FA]=Kt,Zr[Ga]=On,Zr[jr]=ir,Zr[Xa]=Ui,Zr[ua]=fo,Zr[kn]=Cn,Zr[Qu]=On,Zr[mh]=ir,Zr[Md]=Ui}function xa(P){return P&-16384?0>P?0:255:P>>Vu}function N(P,G){return xa((19077*P>>8)+(26149*G>>8)-14234)}function ce(P,G,le){return xa((19077*P>>8)-(6419*G>>8)-(13320*le>>8)+8708)}function we(P,G){return xa((19077*P>>8)+(33050*G>>8)-17685)}function Pe(P,G,le,he,Te){he[Te+0]=N(P,le),he[Te+1]=ce(P,G,le),he[Te+2]=we(P,G)}function Nt(P,G,le,he,Te){he[Te+0]=we(P,G),he[Te+1]=ce(P,G,le),he[Te+2]=N(P,le)}function tn(P,G,le,he,Te){var Fe=ce(P,G,le);G=Fe<<3&224|we(P,G)>>3,he[Te+0]=248&N(P,le)|Fe>>5,he[Te+1]=G}function Un(P,G,le,he,Te){var Fe=240&we(P,G)|15;he[Te+0]=240&N(P,le)|ce(P,G,le)>>4,he[Te+1]=Fe}function is(P,G,le,he,Te){he[Te+0]=255,Pe(P,G,le,he,Te+1)}function ro(P,G,le,he,Te){Nt(P,G,le,he,Te),he[Te+3]=255}function $r(P,G,le,he,Te){Pe(P,G,le,he,Te),he[Te+3]=255}function rs(P,G){return 0>P?0:P>G?G:P}function Bs(P,G,le){b[P]=function(he,Te,Fe,Ie,Ne,We,tt,wt,$t){for(var Xe=wt+(-2&$t)*le;wt!=Xe;)G(he[Te+0],Fe[Ie+0],Ne[We+0],tt,wt),G(he[Te+1],Fe[Ie+0],Ne[We+0],tt,wt+le),Te+=2,++Ie,++We,wt+=2*le;1&$t&&G(he[Te+0],Fe[Ie+0],Ne[We+0],tt,wt)}}function _l(P,G,le){return le==0?P==0?G==0?6:5:G==0?4:0:le}function Bo(P,G,le,he,Te){switch(P>>>30){case 3:vo(G,le,he,Te,0);break;case 2:ic(G,le,he,Te);break;case 1:Va(G,le,he,Te)}}function Ao(P,G){var le,he,Te=G.M,Fe=G.Nb,Ie=P.oc,Ne=P.pc+40,We=P.oc,tt=P.pc+584,wt=P.oc,$t=P.pc+600;for(le=0;16>le;++le)Ie[Ne+32*le-1]=129;for(le=0;8>le;++le)We[tt+32*le-1]=129,wt[$t+32*le-1]=129;for(0<Te?Ie[Ne-1-32]=We[tt-1-32]=wt[$t-1-32]=129:(r(Ie,Ne-32-1,127,21),r(We,tt-32-1,127,9),r(wt,$t-32-1,127,9)),he=0;he<P.za;++he){var Xe=G.ya[G.aa+he];if(0<he){for(le=-1;16>le;++le)i(Ie,Ne+32*le-4,Ie,Ne+32*le+12,4);for(le=-1;8>le;++le)i(We,tt+32*le-4,We,tt+32*le+4,4),i(wt,$t+32*le-4,wt,$t+32*le+4,4)}var Et=P.Gd,Ht=P.Hd+he,mn=Xe.ad,Lt=Xe.Hc;if(0<Te&&(i(Ie,Ne-32,Et[Ht].y,0,16),i(We,tt-32,Et[Ht].f,0,8),i(wt,$t-32,Et[Ht].ea,0,8)),Xe.Za){var bn=Ie,Ft=Ne-32+16;for(0<Te&&(he>=P.za-1?r(bn,Ft,Et[Ht].y[15],4):i(bn,Ft,Et[Ht+1].y,0,4)),le=0;4>le;le++)bn[Ft+128+le]=bn[Ft+256+le]=bn[Ft+384+le]=bn[Ft+0+le];for(le=0;16>le;++le,Lt<<=2)bn=Ie,Ft=Ne+D0[le],da[Xe.Ob[le]](bn,Ft),Bo(Lt,mn,16*+le,bn,Ft)}else if(bn=_l(he,Te,Xe.Ob[0]),yh[bn](Ie,Ne),Lt!=0)for(le=0;16>le;++le,Lt<<=2)Bo(Lt,mn,16*+le,Ie,Ne+D0[le]);for(le=Xe.Gc,bn=_l(he,Te,Xe.Dd),Bc[bn](We,tt),Bc[bn](wt,$t),Lt=mn,bn=We,Ft=tt,255&(Xe=0|le)&&(170&Xe?Mh(Lt,256,bn,Ft):Ks(Lt,256,bn,Ft)),Xe=wt,Lt=$t,255&(le>>=8)&&(170&le?Mh(mn,320,Xe,Lt):Ks(mn,320,Xe,Lt)),Te<P.Ub-1&&(i(Et[Ht].y,0,Ie,Ne+480,16),i(Et[Ht].f,0,We,tt+224,8),i(Et[Ht].ea,0,wt,$t+224,8)),le=8*Fe*P.B,Et=P.sa,Ht=P.ta+16*he+16*Fe*P.R,mn=P.qa,Xe=P.ra+8*he+le,Lt=P.Ha,bn=P.Ia+8*he+le,le=0;16>le;++le)i(Et,Ht+le*P.R,Ie,Ne+32*le,16);for(le=0;8>le;++le)i(mn,Xe+le*P.B,We,tt+32*le,8),i(Lt,bn+le*P.B,wt,$t+32*le,8)}}function Ha(P,G,le,he,Te,Fe,Ie,Ne,We){var tt=[0],wt=[0],$t=0,Xe=We!=null?We.kd:0,Et=We??new ai;if(P==null||12>le)return 7;Et.data=P,Et.w=G,Et.ha=le,G=[G],le=[le],Et.gb=[Et.gb];e:{var Ht=G,mn=le,Lt=Et.gb;if(e(P!=null),e(mn!=null),e(Lt!=null),Lt[0]=0,12<=mn[0]&&!t(P,Ht[0],"RIFF")){if(t(P,Ht[0]+8,"WEBP")){Lt=3;break e}var bn=M(P,Ht[0]+4);if(12>bn||4294967286<bn){Lt=3;break e}if(Xe&&bn>mn[0]-8){Lt=7;break e}Lt[0]=bn,Ht[0]+=12,mn[0]-=12}Lt=0}if(Lt!=0)return Lt;for(bn=0<Et.gb[0],le=le[0];;){e:{var Ft=P;mn=G,Lt=le;var zn=tt,Nn=wt,tr=Ht=[0];if((Hi=$t=[$t])[0]=0,8>Lt[0])Lt=7;else{if(!t(Ft,mn[0],"VP8X")){if(M(Ft,mn[0]+4)!=10){Lt=3;break e}if(18>Lt[0]){Lt=7;break e}var Oi=M(Ft,mn[0]+8),Pr=1+fe(Ft,mn[0]+12);if(2147483648<=Pr*(Ft=1+fe(Ft,mn[0]+15))){Lt=3;break e}tr!=null&&(tr[0]=Oi),zn!=null&&(zn[0]=Pr),Nn!=null&&(Nn[0]=Ft),mn[0]+=18,Lt[0]-=18,Hi[0]=1}Lt=0}}if($t=$t[0],Ht=Ht[0],Lt!=0)return Lt;if(mn=!!(2&Ht),!bn&&$t)return 3;if(Fe!=null&&(Fe[0]=!!(16&Ht)),Ie!=null&&(Ie[0]=mn),Ne!=null&&(Ne[0]=0),Ie=tt[0],Ht=wt[0],$t&&mn&&We==null){Lt=0;break}if(4>le){Lt=7;break}if(bn&&$t||!bn&&!$t&&!t(P,G[0],"ALPH")){le=[le],Et.na=[Et.na],Et.P=[Et.P],Et.Sa=[Et.Sa];e:{Oi=P,Lt=G,bn=le;var Hi=Et.gb;zn=Et.na,Nn=Et.P,tr=Et.Sa,Pr=22,e(Oi!=null),e(bn!=null),Ft=Lt[0];var fs=bn[0];for(e(zn!=null),e(tr!=null),zn[0]=null,Nn[0]=null,tr[0]=0;;){if(Lt[0]=Ft,bn[0]=fs,8>fs){Lt=7;break e}var Ta=M(Oi,Ft+4);if(4294967286<Ta){Lt=3;break e}var Vr=8+Ta+1&-2;if(Pr+=Vr,0<Hi&&Pr>Hi){Lt=3;break e}if(!t(Oi,Ft,"VP8 ")||!t(Oi,Ft,"VP8L")){Lt=0;break e}if(fs[0]<Vr){Lt=7;break e}t(Oi,Ft,"ALPH")||(zn[0]=Oi,Nn[0]=Ft+8,tr[0]=Ta),Ft+=Vr,fs-=Vr}}if(le=le[0],Et.na=Et.na[0],Et.P=Et.P[0],Et.Sa=Et.Sa[0],Lt!=0)break}le=[le],Et.Ja=[Et.Ja],Et.xa=[Et.xa];e:if(Hi=P,Lt=G,bn=le,zn=Et.gb[0],Nn=Et.Ja,tr=Et.xa,Oi=Lt[0],Ft=!t(Hi,Oi,"VP8 "),Pr=!t(Hi,Oi,"VP8L"),e(Hi!=null),e(bn!=null),e(Nn!=null),e(tr!=null),8>bn[0])Lt=7;else{if(Ft||Pr){if(Hi=M(Hi,Oi+4),12<=zn&&Hi>zn-12){Lt=3;break e}if(Xe&&Hi>bn[0]-8){Lt=7;break e}Nn[0]=Hi,Lt[0]+=8,bn[0]-=8,tr[0]=Pr}else tr[0]=5<=bn[0]&&Hi[Oi+0]==47&&!(Hi[Oi+4]>>5),Nn[0]=bn[0];Lt=0}if(le=le[0],Et.Ja=Et.Ja[0],Et.xa=Et.xa[0],G=G[0],Lt!=0)break;if(4294967286<Et.Ja)return 3;if(Ne==null||mn||(Ne[0]=Et.xa?2:1),Ie=[Ie],Ht=[Ht],Et.xa){if(5>le){Lt=7;break}Ne=Ie,Xe=Ht,mn=Fe,P==null||5>le?P=0:5<=le&&P[G+0]==47&&!(P[G+4]>>5)?(bn=[0],Hi=[0],zn=[0],J(Nn=new K,P,G,le),Gt(Nn,bn,Hi,zn)?(Ne!=null&&(Ne[0]=bn[0]),Xe!=null&&(Xe[0]=Hi[0]),mn!=null&&(mn[0]=zn[0]),P=1):P=0):P=0}else{if(10>le){Lt=7;break}Ne=Ht,P==null||10>le||!pn(P,G+3,le-3)?P=0:(Xe=P[G+0]|P[G+1]<<8|P[G+2]<<16,mn=16383&(P[G+7]<<8|P[G+6]),P=16383&(P[G+9]<<8|P[G+8]),1&Xe||3<(Xe>>1&7)||!(Xe>>4&1)||Xe>>5>=Et.Ja||!mn||!P?P=0:(Ie&&(Ie[0]=mn),Ne&&(Ne[0]=P),P=1))}if(!P||(Ie=Ie[0],Ht=Ht[0],$t&&(tt[0]!=Ie||wt[0]!=Ht)))return 3;We!=null&&(We[0]=Et,We.offset=G-We.w,e(4294967286>G-We.w),e(We.offset==We.ha-le));break}return Lt==0||Lt==7&&$t&&We==null?(Fe!=null&&(Fe[0]|=Et.na!=null&&0<Et.na.length),he!=null&&(he[0]=Ie),Te!=null&&(Te[0]=Ht),0):Lt}function Wa(P,G,le){var he=G.width,Te=G.height,Fe=0,Ie=0,Ne=he,We=Te;if(G.Da=P!=null&&0<P.Da,G.Da&&(Ne=P.cd,We=P.bd,Fe=P.v,Ie=P.j,11>le||(Fe&=-2,Ie&=-2),0>Fe||0>Ie||0>=Ne||0>=We||Fe+Ne>he||Ie+We>Te))return 0;if(G.v=Fe,G.j=Ie,G.va=Fe+Ne,G.o=Ie+We,G.U=Ne,G.T=We,G.da=P!=null&&0<P.da,G.da){if(!ee(Ne,We,le=[P.ib],Fe=[P.hb]))return 0;G.ib=le[0],G.hb=Fe[0]}return G.ob=P!=null&&P.ob,G.Kb=P==null||!P.Sd,G.da&&(G.ob=G.ib<3*he/4&&G.hb<3*Te/4,G.Kb=0),1}function dl(P){if(P==null)return 2;if(11>P.S){var G=P.f.RGBA;G.fb+=(P.height-1)*G.A,G.A=-G.A}else G=P.f.kb,P=P.height,G.O+=(P-1)*G.fa,G.fa=-G.fa,G.N+=(P-1>>1)*G.Ab,G.Ab=-G.Ab,G.W+=(P-1>>1)*G.Db,G.Db=-G.Db,G.F!=null&&(G.J+=(P-1)*G.lb,G.lb=-G.lb);return 0}function za(P,G,le,he){if(he==null||0>=P||0>=G)return 2;if(le!=null){if(le.Da){var Te=le.cd,Fe=le.bd,Ie=-2&le.v,Ne=-2&le.j;if(0>Ie||0>Ne||0>=Te||0>=Fe||Ie+Te>P||Ne+Fe>G)return 2;P=Te,G=Fe}if(le.da){if(!ee(P,G,Te=[le.ib],Fe=[le.hb]))return 2;P=Te[0],G=Fe[0]}}he.width=P,he.height=G;e:{var We=he.width,tt=he.height;if(P=he.S,0>=We||0>=tt||!(P>=xo&&13>P))P=2;else{if(0>=he.Rd&&he.sd==null){Ie=Fe=Te=G=0;var wt=(Ne=We*j0[P])*tt;if(11>P||(Fe=(tt+1)/2*(G=(We+1)/2),P==12&&(Ie=(Te=We)*tt)),(tt=s(wt+2*Fe+Ie))==null){P=1;break e}he.sd=tt,11>P?((We=he.f.RGBA).eb=tt,We.fb=0,We.A=Ne,We.size=wt):((We=he.f.kb).y=tt,We.O=0,We.fa=Ne,We.Fd=wt,We.f=tt,We.N=0+wt,We.Ab=G,We.Cd=Fe,We.ea=tt,We.W=0+wt+Fe,We.Db=G,We.Ed=Fe,P==12&&(We.F=tt,We.J=0+wt+2*Fe),We.Tc=Ie,We.lb=Te)}if(G=1,Te=he.S,Fe=he.width,Ie=he.height,Te>=xo&&13>Te)if(11>Te)P=he.f.RGBA,G&=(Ne=Math.abs(P.A))*(Ie-1)+Fe<=P.size,G&=Ne>=Fe*j0[Te],G&=P.eb!=null;else{P=he.f.kb,Ne=(Fe+1)/2,wt=(Ie+1)/2,We=Math.abs(P.fa),tt=Math.abs(P.Ab);var $t=Math.abs(P.Db),Xe=Math.abs(P.lb),Et=Xe*(Ie-1)+Fe;G&=We*(Ie-1)+Fe<=P.Fd,G&=tt*(wt-1)+Ne<=P.Cd,G=(G&=$t*(wt-1)+Ne<=P.Ed)&We>=Fe&tt>=Ne&$t>=Ne,G&=P.y!=null,G&=P.f!=null,G&=P.ea!=null,Te==12&&(G&=Xe>=Fe,G&=Et<=P.Tc,G&=P.F!=null)}else G=0;P=G?0:2}}return P!=0||le!=null&&le.fd&&(P=dl(he)),P}var ba=64,Xc=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ou=24,Qa=32,Vs=8,Hu=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];_e("Predictor0","PredictorAdd0"),b.Predictor0=function(){return 4278190080},b.Predictor1=function(P){return P},b.Predictor2=function(P,G,le){return G[le+0]},b.Predictor3=function(P,G,le){return G[le+1]},b.Predictor4=function(P,G,le){return G[le-1]},b.Predictor5=function(P,G,le){return Be(Be(P,G[le+1]),G[le+0])},b.Predictor6=function(P,G,le){return Be(P,G[le-1])},b.Predictor7=function(P,G,le){return Be(P,G[le+0])},b.Predictor8=function(P,G,le){return Be(G[le-1],G[le+0])},b.Predictor9=function(P,G,le){return Be(G[le+0],G[le+1])},b.Predictor10=function(P,G,le){return Be(Be(P,G[le-1]),Be(G[le+0],G[le+1]))},b.Predictor11=function(P,G,le){var he=G[le+0];return 0>=qe(he>>24&255,P>>24&255,(G=G[le-1])>>24&255)+qe(he>>16&255,P>>16&255,G>>16&255)+qe(he>>8&255,P>>8&255,G>>8&255)+qe(255&he,255&P,255&G)?he:P},b.Predictor12=function(P,G,le){var he=G[le+0];return(it((P>>24&255)+(he>>24&255)-((G=G[le-1])>>24&255))<<24|it((P>>16&255)+(he>>16&255)-(G>>16&255))<<16|it((P>>8&255)+(he>>8&255)-(G>>8&255))<<8|it((255&P)+(255&he)-(255&G)))>>>0},b.Predictor13=function(P,G,le){var he=G[le-1];return(De((P=Be(P,G[le+0]))>>24&255,he>>24&255)<<24|De(P>>16&255,he>>16&255)<<16|De(P>>8&255,he>>8&255)<<8|De(255&P,255&he))>>>0};var Cc=b.PredictorAdd0;b.PredictorAdd1=Je,_e("Predictor2","PredictorAdd2"),_e("Predictor3","PredictorAdd3"),_e("Predictor4","PredictorAdd4"),_e("Predictor5","PredictorAdd5"),_e("Predictor6","PredictorAdd6"),_e("Predictor7","PredictorAdd7"),_e("Predictor8","PredictorAdd8"),_e("Predictor9","PredictorAdd9"),_e("Predictor10","PredictorAdd10"),_e("Predictor11","PredictorAdd11"),_e("Predictor12","PredictorAdd12"),_e("Predictor13","PredictorAdd13");var Ll=b.PredictorAdd2;ze("ColorIndexInverseTransform","MapARGB","32b",function(P){return P>>8&255},function(P){return P}),ze("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(P){return P},function(P){return P>>8&255});var su,gh=b.ColorIndexInverseTransform,Ca=b.MapARGB,Yc=b.VP8LColorIndexInverseTransformAlpha,tc=b.MapAlpha,$a=b.VP8LPredictorsAdd=[];$a.length=16,(b.VP8LPredictors=[]).length=16,(b.VP8LPredictorsAdd_C=[]).length=16,(b.VP8LPredictors_C=[]).length=16;var _c,Kc,Sl,nc,Ar,Os,wo,vo,ic,Mh,Va,Ks,Vo,ra,Ld,Wu,zu,rg,_a,TA,BA,EA,Sc,Tt,Kn,os,En,ur,xs=s(511),an=s(2041),as=s(225),ha=s(767),Tc=0,Ml=an,Dr=as,mr=ha,Ps=xs,xo=0,ou=1,FA=2,Ga=3,jr=4,Xa=5,ua=6,kn=7,Qu=8,mh=9,Md=10,Eo=[2,3,7],ls=[3,3,11],sg=[280,256,256,256,40],V1=[0,1,1,1,0],Rd=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],kA=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Rl=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],bs=8,qs=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],$u=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Tl=null,F0=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],rc=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Rh=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Uh=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],og=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],qc=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],k0=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],yh=[],da=[],Bc=[],Nf=1,ag=2,Aa=[],Zr=[];va("UpsampleRgbLinePair",Pe,3),va("UpsampleBgrLinePair",Nt,3),va("UpsampleRgbaLinePair",$r,4),va("UpsampleBgraLinePair",ro,4),va("UpsampleArgbLinePair",is,4),va("UpsampleRgba4444LinePair",Un,2),va("UpsampleRgb565LinePair",tn,2);var I0=b.UpsampleRgbLinePair,Kt=b.UpsampleBgrLinePair,Cn=b.UpsampleRgbaLinePair,On=b.UpsampleBgraLinePair,ir=b.UpsampleArgbLinePair,Ui=b.UpsampleRgba4444LinePair,fo=b.UpsampleRgb565LinePair,Go=16,Ya=1<<Go-1,Sa=-227,sc=482,Vu=6,Lf=0,G1=s(256),Hv=s(256),Wv=s(256),X1=s(256),Y1=s(sc-Sa),zv=s(sc-Sa);Bs("YuvToRgbRow",Pe,3),Bs("YuvToBgrRow",Nt,3),Bs("YuvToRgbaRow",$r,4),Bs("YuvToBgraRow",ro,4),Bs("YuvToArgbRow",is,4),Bs("YuvToRgba4444Row",Un,2),Bs("YuvToRgb565Row",tn,2);var D0=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],IA=[0,2,8],ES=[8,7,6,4,4,2,2,2,1,1,1,1],Qv=1;this.WebPDecodeRGBA=function(P,G,le,he,Te){var Fe=ou,Ie=new $n,Ne=new st;Ie.ba=Ne,Ne.S=Fe,Ne.width=[Ne.width],Ne.height=[Ne.height];var We=Ne.width,tt=Ne.height,wt=new At;if(wt==null||P==null)var $t=2;else e(wt!=null),$t=Ha(P,G,le,wt.width,wt.height,wt.Pd,wt.Qd,wt.format,null);if($t!=0?We=0:(We!=null&&(We[0]=wt.width[0]),tt!=null&&(tt[0]=wt.height[0]),We=1),We){Ne.width=Ne.width[0],Ne.height=Ne.height[0],he!=null&&(he[0]=Ne.width),Te!=null&&(Te[0]=Ne.height);e:{if(he=new gn,(Te=new ai).data=P,Te.w=G,Te.ha=le,Te.kd=1,G=[0],e(Te!=null),((P=Ha(Te.data,Te.w,Te.ha,null,null,null,G,null,Te))==0||P==7)&&G[0]&&(P=4),(G=P)==0){if(e(Ie!=null),he.data=Te.data,he.w=Te.w+Te.offset,he.ha=Te.ha-Te.offset,he.put=vt,he.ac=sn,he.bc=Ye,he.ma=Ie,Te.xa){if((P=ri())==null){Ie=1;break e}if((function(Xe,Et){var Ht=[0],mn=[0],Lt=[0];t:for(;;){if(Xe==null)return 0;if(Et==null)return Xe.a=2,0;if(Xe.l=Et,Xe.a=0,J(Xe.m,Et.data,Et.w,Et.ha),!Gt(Xe.m,Ht,mn,Lt)){Xe.a=3;break t}if(Xe.xb=ag,Et.width=Ht[0],Et.height=mn[0],!bi(Ht[0],mn[0],1,Xe,null))break t;return 1}return e(Xe.a!=0),0})(P,he)){if(he=(G=za(he.width,he.height,Ie.Oa,Ie.ba))==0){t:{he=P;n:for(;;){if(he==null){he=0;break t}if(e(he.s.yc!=null),e(he.s.Ya!=null),e(0<he.s.Wb),e((le=he.l)!=null),e((Te=le.ma)!=null),he.xb!=0){if(he.ca=Te.ba,he.tb=Te.tb,e(he.ca!=null),!Wa(Te.Oa,le,Ga)){he.a=2;break n}if(!Ni(he,le.width)||le.da)break n;if((le.da||ye(he.ca.S))&&Oo(),11>he.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),he.ca.f.kb.F!=null&&Oo()),he.Pb&&0<he.s.ua&&he.s.vb.X==null&&!Z(he.s.vb,he.s.Wa.Xa)){he.a=1;break n}he.xb=0}if(!Hn(he,he.V,he.Ba,he.c,he.i,le.o,Sn))break n;Te.Dc=he.Ma,he=1;break t}e(he.a!=0),he=0}he=!he}he&&(G=P.a)}else G=P.a}else{if((P=new Jn)==null){Ie=1;break e}if(P.Fa=Te.na,P.P=Te.P,P.qc=Te.Sa,Ln(P,he)){if((G=za(he.width,he.height,Ie.Oa,Ie.ba))==0){if(P.Aa=0,le=Ie.Oa,e((Te=P)!=null),le!=null){if(0<(We=0>(We=le.Md)?0:100<We?255:255*We/100)){for(tt=wt=0;4>tt;++tt)12>($t=Te.pb[tt]).lc&&($t.ia=We*ES[0>$t.lc?0:$t.lc]>>3),wt|=$t.ia;wt&&(alert("todo:VP8InitRandom"),Te.ia=1)}Te.Ga=le.Id,100<Te.Ga?Te.Ga=100:0>Te.Ga&&(Te.Ga=0)}(function(Xe,Et){if(Xe==null)return 0;if(Et==null)return Qn(Xe,2,"NULL VP8Io parameter in VP8Decode().");if(!Xe.cb&&!Ln(Xe,Et))return 0;if(e(Xe.cb),Et.ac==null||Et.ac(Et)){Et.ob&&(Xe.L=0);var Ht=IA[Xe.L];if(Xe.L==2?(Xe.yb=0,Xe.zb=0):(Xe.yb=Et.v-Ht>>4,Xe.zb=Et.j-Ht>>4,0>Xe.yb&&(Xe.yb=0),0>Xe.zb&&(Xe.zb=0)),Xe.Va=Et.o+15+Ht>>4,Xe.Hb=Et.va+15+Ht>>4,Xe.Hb>Xe.za&&(Xe.Hb=Xe.za),Xe.Va>Xe.Ub&&(Xe.Va=Xe.Ub),0<Xe.L){var mn=Xe.ed;for(Ht=0;4>Ht;++Ht){var Lt;if(Xe.Qa.Cb){var bn=Xe.Qa.Lb[Ht];Xe.Qa.Fb||(bn+=mn.Tb)}else bn=mn.Tb;for(Lt=0;1>=Lt;++Lt){var Ft=Xe.gd[Ht][Lt],zn=bn;if(mn.Pc&&(zn+=mn.vd[0],Lt&&(zn+=mn.od[0])),0<(zn=0>zn?0:63<zn?63:zn)){var Nn=zn;0<mn.wb&&(Nn=4<mn.wb?Nn>>2:Nn>>1)>9-mn.wb&&(Nn=9-mn.wb),1>Nn&&(Nn=1),Ft.dd=Nn,Ft.tc=2*zn+Nn,Ft.ld=40<=zn?2:15<=zn?1:0}else Ft.tc=0;Ft.La=Lt}}}Ht=0}else Qn(Xe,6,"Frame setup failed"),Ht=Xe.a;if(Ht=Ht==0){if(Ht){Xe.$c=0,0<Xe.Aa||(Xe.Ic=Qv);t:{Ht=Xe.Ic,mn=4*(Nn=Xe.za);var tr=32*Nn,Oi=Nn+1,Pr=0<Xe.L?Nn*(0<Xe.Aa?2:1):0,Hi=(Xe.Aa==2?2:1)*Nn;if((Ft=mn+832+(Lt=3*(16*Ht+IA[Xe.L])/2*tr)+(bn=Xe.Fa!=null&&0<Xe.Fa.length?Xe.Kc.c*Xe.Kc.i:0))!=Ft)Ht=0;else{if(Ft>Xe.Vb){if(Xe.Vb=0,Xe.Ec=s(Ft),Xe.Fc=0,Xe.Ec==null){Ht=Qn(Xe,1,"no memory during frame initialization.");break t}Xe.Vb=Ft}Ft=Xe.Ec,zn=Xe.Fc,Xe.Ac=Ft,Xe.Bc=zn,zn+=mn,Xe.Gd=o(tr,nn),Xe.Hd=0,Xe.rb=o(Oi+1,Ve),Xe.sb=1,Xe.wa=Pr?o(Pr,wi):null,Xe.Y=0,Xe.D.Nb=0,Xe.D.wa=Xe.wa,Xe.D.Y=Xe.Y,0<Xe.Aa&&(Xe.D.Y+=Nn),e(!0),Xe.oc=Ft,Xe.pc=zn,zn+=832,Xe.ya=o(Hi,mt),Xe.aa=0,Xe.D.ya=Xe.ya,Xe.D.aa=Xe.aa,Xe.Aa==2&&(Xe.D.aa+=Nn),Xe.R=16*Nn,Xe.B=8*Nn,Nn=(tr=IA[Xe.L])*Xe.R,tr=tr/2*Xe.B,Xe.sa=Ft,Xe.ta=zn+Nn,Xe.qa=Xe.sa,Xe.ra=Xe.ta+16*Ht*Xe.R+tr,Xe.Ha=Xe.qa,Xe.Ia=Xe.ra+8*Ht*Xe.B+tr,Xe.$c=0,zn+=Lt,Xe.mb=bn?Ft:null,Xe.nb=bn?zn:null,e(zn+bn<=Xe.Fc+Xe.Vb),ei(Xe),r(Xe.Ac,Xe.Bc,0,mn),Ht=1}}if(Ht){if(Et.ka=0,Et.y=Xe.sa,Et.O=Xe.ta,Et.f=Xe.qa,Et.N=Xe.ra,Et.ea=Xe.Ha,Et.Vd=Xe.Ia,Et.fa=Xe.R,Et.Rc=Xe.B,Et.F=null,Et.J=0,!Tc){for(Ht=-255;255>=Ht;++Ht)xs[255+Ht]=0>Ht?-Ht:Ht;for(Ht=-1020;1020>=Ht;++Ht)an[1020+Ht]=-128>Ht?-128:127<Ht?127:Ht;for(Ht=-112;112>=Ht;++Ht)as[112+Ht]=-16>Ht?-16:15<Ht?15:Ht;for(Ht=-255;510>=Ht;++Ht)ha[255+Ht]=0>Ht?0:255<Ht?255:Ht;Tc=1}wo=hi,vo=Bt,Mh=on,Va=ln,Ks=li,ic=xt,Vo=re,ra=be,Ld=yt,Wu=en,zu=Ue,rg=ut,_a=cn,TA=Tn,BA=Ci,EA=Qi,Sc=zi,Tt=Ir,da[0]=pe,da[1]=kr,da[2]=pt,da[3]=Pt,da[4]=xe,da[5]=dt,da[6]=at,da[7]=Qt,da[8]=gt,da[9]=wn,yh[0]=Mn,yh[1]=Us,yh[2]=io,yh[3]=ws,yh[4]=ve,yh[5]=Re,yh[6]=Ke,Bc[0]=Ot,Bc[1]=zr,Bc[2]=Vn,Bc[3]=Yn,Bc[4]=Wn,Bc[5]=In,Bc[6]=xn,Ht=1}else Ht=0}Ht&&(Ht=(function(fs,Ta){for(fs.M=0;fs.M<fs.Va;++fs.M){var Vr,$i=fs.Jc[fs.M&fs.Xb],di=fs.m,Xo=fs;for(Vr=0;Vr<Xo.za;++Vr){var nr=di,Mr=Xo,Es=Mr.Ac,Ka=Mr.Bc+4*Vr,Ul=Mr.zc,Hs=Mr.ya[Mr.aa+Vr];if(Mr.Qa.Bb?Hs.$b=de(nr,Mr.Pa.jb[0])?2+de(nr,Mr.Pa.jb[2]):de(nr,Mr.Pa.jb[1]):Hs.$b=0,Mr.kc&&(Hs.Ad=de(nr,Mr.Bd)),Hs.Za=!de(nr,145)+0,Hs.Za){var Bl=Hs.Ob,Ho=0;for(Mr=0;4>Mr;++Mr){var qa,Fs=Ul[0+Mr];for(qa=0;4>qa;++qa){Fs=og[Es[Ka+qa]][Fs];for(var Zs=Rh[de(nr,Fs[0])];0<Zs;)Zs=Rh[2*Zs+de(nr,Fs[Zs])];Fs=-Zs,Es[Ka+qa]=Fs}i(Bl,Ho,Es,Ka,4),Ho+=4,Ul[0+Mr]=Fs}}else Fs=de(nr,156)?de(nr,128)?1:3:de(nr,163)?2:0,Hs.Ob[0]=Fs,r(Es,Ka,Fs,4),r(Ul,0,Fs,4);Hs.Dd=de(nr,142)?de(nr,114)?de(nr,183)?1:3:2:0}if(Xo.m.Ka)return Qn(fs,7,"Premature end-of-partition0 encountered.");for(;fs.ja<fs.za;++fs.ja){if(Xo=$i,nr=(di=fs).rb[di.sb-1],Es=di.rb[di.sb+di.ja],Vr=di.ya[di.aa+di.ja],Ka=di.kc?Vr.Ad:0)nr.la=Es.la=0,Vr.Za||(nr.Na=Es.Na=0),Vr.Hc=0,Vr.Gc=0,Vr.ia=0;else{var Yo,Js;if(nr=Es,Es=Xo,Ka=di.Pa.Xc,Ul=di.ya[di.aa+di.ja],Hs=di.pb[Ul.$b],Mr=Ul.ad,Bl=0,Ho=di.rb[di.sb-1],Fs=qa=0,r(Mr,Bl,0,384),Ul.Za)var Ba=0,Ec=Ka[3];else{Zs=s(16);var Wo=nr.Na+Ho.Na;if(Wo=Tl(Es,Ka[1],Wo,Hs.Eb,0,Zs,0),nr.Na=Ho.Na=(0<Wo)+0,1<Wo)wo(Zs,0,Mr,Bl);else{var El=Zs[0]+3>>3;for(Zs=0;256>Zs;Zs+=16)Mr[Bl+Zs]=El}Ba=1,Ec=Ka[0]}var eo=15&nr.la,Ko=15&Ho.la;for(Zs=0;4>Zs;++Zs){var oc=1&Ko;for(El=Js=0;4>El;++El)eo=eo>>1|(oc=(Wo=Tl(Es,Ec,Wo=oc+(1&eo),Hs.Sc,Ba,Mr,Bl))>Ba)<<7,Js=Js<<2|(3<Wo?3:1<Wo?2:Mr[Bl+0]!=0),Bl+=16;eo>>=4,Ko=Ko>>1|oc<<7,qa=(qa<<8|Js)>>>0}for(Ec=eo,Ba=Ko>>4,Yo=0;4>Yo;Yo+=2){for(Js=0,eo=nr.la>>4+Yo,Ko=Ho.la>>4+Yo,Zs=0;2>Zs;++Zs){for(oc=1&Ko,El=0;2>El;++El)Wo=oc+(1&eo),eo=eo>>1|(oc=0<(Wo=Tl(Es,Ka[2],Wo,Hs.Qc,0,Mr,Bl)))<<3,Js=Js<<2|(3<Wo?3:1<Wo?2:Mr[Bl+0]!=0),Bl+=16;eo>>=2,Ko=Ko>>1|oc<<5}Fs|=Js<<4*Yo,Ec|=eo<<4<<Yo,Ba|=(240&Ko)<<Yo}nr.la=Ec,Ho.la=Ba,Ul.Hc=qa,Ul.Gc=Fs,Ul.ia=43690&Fs?0:Hs.ia,Ka=!(qa|Fs)}if(0<di.L&&(di.wa[di.Y+di.ja]=di.gd[Vr.$b][Vr.Za],di.wa[di.Y+di.ja].La|=!Ka),Xo.Ka)return Qn(fs,7,"Premature end-of-file encountered.")}if(ei(fs),di=Ta,Xo=1,Vr=($i=fs).D,nr=0<$i.L&&$i.M>=$i.zb&&$i.M<=$i.Va,$i.Aa==0)t:{if(Vr.M=$i.M,Vr.uc=nr,Ao($i,Vr),Xo=1,Vr=(Js=$i.D).Nb,nr=(Fs=IA[$i.L])*$i.R,Es=Fs/2*$i.B,Zs=16*Vr*$i.R,El=8*Vr*$i.B,Ka=$i.sa,Ul=$i.ta-nr+Zs,Hs=$i.qa,Mr=$i.ra-Es+El,Bl=$i.Ha,Ho=$i.Ia-Es+El,Ko=(eo=Js.M)==0,qa=eo>=$i.Va-1,$i.Aa==2&&Ao($i,Js),Js.uc)for(oc=(Wo=$i).D.M,e(Wo.D.uc),Js=Wo.yb;Js<Wo.Hb;++Js){Ba=Js,Ec=oc;var Fl=(ac=(ms=Wo).D).Nb;Yo=ms.R;var ac=ac.wa[ac.Y+Ba],Fc=ms.sa,Ol=ms.ta+16*Fl*Yo+16*Ba,Zc=ac.dd,so=ac.tc;if(so!=0)if(e(3<=so),ms.L==1)0<Ba&&EA(Fc,Ol,Yo,so+4),ac.La&&Tt(Fc,Ol,Yo,so),0<Ec&&BA(Fc,Ol,Yo,so+4),ac.La&&Sc(Fc,Ol,Yo,so);else{var lc=ms.B,Gs=ms.qa,Rr=ms.ra+8*Fl*lc+8*Ba,bo=ms.Ha,ms=ms.Ia+8*Fl*lc+8*Ba;Fl=ac.ld,0<Ba&&(ra(Fc,Ol,Yo,so+4,Zc,Fl),Wu(Gs,Rr,bo,ms,lc,so+4,Zc,Fl)),ac.La&&(rg(Fc,Ol,Yo,so,Zc,Fl),TA(Gs,Rr,bo,ms,lc,so,Zc,Fl)),0<Ec&&(Vo(Fc,Ol,Yo,so+4,Zc,Fl),Ld(Gs,Rr,bo,ms,lc,so+4,Zc,Fl)),ac.La&&(zu(Fc,Ol,Yo,so,Zc,Fl),_a(Gs,Rr,bo,ms,lc,so,Zc,Fl))}}if($i.ia&&alert("todo:DitherRow"),di.put!=null){if(Js=16*eo,eo=16*(eo+1),Ko?(di.y=$i.sa,di.O=$i.ta+Zs,di.f=$i.qa,di.N=$i.ra+El,di.ea=$i.Ha,di.W=$i.Ia+El):(Js-=Fs,di.y=Ka,di.O=Ul,di.f=Hs,di.N=Mr,di.ea=Bl,di.W=Ho),qa||(eo-=Fs),eo>di.o&&(eo=di.o),di.F=null,di.J=null,$i.Fa!=null&&0<$i.Fa.length&&Js<eo&&(di.J=cs($i,di,Js,eo-Js),di.F=$i.mb,di.F==null&&di.F.length==0)){Xo=Qn($i,3,"Could not decode alpha data.");break t}Js<di.j&&(Fs=di.j-Js,Js=di.j,e(!(1&Fs)),di.O+=$i.R*Fs,di.N+=$i.B*(Fs>>1),di.W+=$i.B*(Fs>>1),di.F!=null&&(di.J+=di.width*Fs)),Js<eo&&(di.O+=di.v,di.N+=di.v>>1,di.W+=di.v>>1,di.F!=null&&(di.J+=di.v),di.ka=Js-di.j,di.U=di.va-di.v,di.T=eo-Js,Xo=di.put(di))}Vr+1!=$i.Ic||qa||(i($i.sa,$i.ta-nr,Ka,Ul+16*$i.R,nr),i($i.qa,$i.ra-Es,Hs,Mr+8*$i.B,Es),i($i.Ha,$i.Ia-Es,Bl,Ho+8*$i.B,Es))}if(!Xo)return Qn(fs,6,"Output aborted.")}return 1})(Xe,Et)),Et.bc!=null&&Et.bc(Et),Ht&=1}return Ht?(Xe.cb=0,Ht):0})(P,he)||(G=P.a)}}else G=P.a}G==0&&Ie.Oa!=null&&Ie.Oa.fd&&(G=dl(Ie.ba))}Ie=G}Fe=Ie!=0?null:11>Fe?Ne.f.RGBA.eb:Ne.f.kb.y}else Fe=null;return Fe};var j0=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function h(b,D){for(var T="",k=0;k<4;k++)T+=String.fromCharCode(b[D++]);return T}function u(b,D){return b[D+0]|b[D+1]<<8}function d(b,D){return(b[D+0]|b[D+1]<<8|b[D+2]<<16)>>>0}function A(b,D){return(b[D+0]|b[D+1]<<8|b[D+2]<<16|b[D+3]<<24)>>>0}new l;var f=[0],p=[0],g=[],v=new l,w=n,m=(function(b,D){var T={},k=0,B=!1,E=0,z=0;if(T.frames=[],!(function(Y,K){for(var V=0;V<4;V++)if(Y[K+V]!="RIFF".charCodeAt(V))return!0;return!1})(b,D)){for(A(b,D+=4),D+=8;D<b.length;){var te=h(b,D),L=A(b,D+=4);D+=4;var O=L+(1&L);switch(te){case"VP8 ":case"VP8L":T.frames[k]===void 0&&(T.frames[k]={}),(U=T.frames[k]).src_off=B?z:D-8,U.src_size=E+L+8,k++,B&&(B=!1,E=0,z=0);break;case"VP8X":(U=T.header={}).feature_flags=b[D];var J=D+4;U.canvas_width=1+d(b,J),J+=3,U.canvas_height=1+d(b,J),J+=3;break;case"ALPH":B=!0,E=O+8,z=D-8;break;case"ANIM":(U=T.header).bgcolor=A(b,D),J=D+4,U.loop_count=u(b,J),J+=2;break;case"ANMF":var $,U;(U=T.frames[k]={}).offset_x=2*d(b,D),D+=3,U.offset_y=2*d(b,D),D+=3,U.width=1+d(b,D),D+=3,U.height=1+d(b,D),D+=3,U.duration=d(b,D),D+=3,$=b[D++],U.dispose=1&$,U.blend=$>>1&1}te!="ANMF"&&(D+=O)}return T}})(w,0);m.response=w,m.rgbaoutput=!0,m.dataurl=!1;var y=m.header?m.header:null,x=m.frames?m.frames:null;if(y){y.loop_counter=y.loop_count,f=[y.canvas_height],p=[y.canvas_width];for(var S=0;S<x.length&&x[S].blend!=0;S++);}var I=x[0],j=v.WebPDecodeRGBA(w,I.src_off,I.src_size,p,f);I.rgba=j,I.imgwidth=p[0],I.imgheight=f[0];for(var C=0;C<p[0]*f[0]*4;C++)g[C]=j[C];return this.width=p,this.height=f,this.data=g,this}(function(n){var e,t,i,r,s,o,a,l,h,u=function(Y){return Y=Y||{},this.isStrokeTransparent=Y.isStrokeTransparent||!1,this.strokeOpacity=Y.strokeOpacity||1,this.strokeStyle=Y.strokeStyle||"#000000",this.fillStyle=Y.fillStyle||"#000000",this.isFillTransparent=Y.isFillTransparent||!1,this.fillOpacity=Y.fillOpacity||1,this.font=Y.font||"10px sans-serif",this.textBaseline=Y.textBaseline||"alphabetic",this.textAlign=Y.textAlign||"left",this.lineWidth=Y.lineWidth||1,this.lineJoin=Y.lineJoin||"miter",this.lineCap=Y.lineCap||"butt",this.path=Y.path||[],this.transform=Y.transform!==void 0?Y.transform.clone():new l,this.globalCompositeOperation=Y.globalCompositeOperation||"normal",this.globalAlpha=Y.globalAlpha||1,this.clip_path=Y.clip_path||[],this.currentPoint=Y.currentPoint||new o,this.miterLimit=Y.miterLimit||10,this.lastPoint=Y.lastPoint||new o,this.lineDashOffset=Y.lineDashOffset||0,this.lineDash=Y.lineDash||[],this.margin=Y.margin||[0,0,0,0],this.prevPageLastElemOffset=Y.prevPageLastElemOffset||0,this.ignoreClearRect=typeof Y.ignoreClearRect!="boolean"||Y.ignoreClearRect,this};n.events.push(["initialized",function(){this.context2d=new d(this),e=this.internal.f2,t=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString,r=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,a=this.internal.Rectangle,l=this.internal.Matrix,h=new u}]);var d=function(Y){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var K=Y;Object.defineProperty(this,"pdf",{get:function(){return K}});var V=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return V},set:function(M){V=!!M}});var Q=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Q},set:function(M){Q=!!M}});var X=0;Object.defineProperty(this,"posX",{get:function(){return X},set:function(M){isNaN(M)||(X=M)}});var W=0;Object.defineProperty(this,"posY",{get:function(){return W},set:function(M){isNaN(M)||(W=M)}}),Object.defineProperty(this,"margin",{get:function(){return h.margin},set:function(M){var Z;typeof M=="number"?Z=[M,M,M,M]:((Z=new Array(4))[0]=M[0],Z[1]=M.length>=2?M[1]:Z[0],Z[2]=M.length>=3?M[2]:Z[0],Z[3]=M.length>=4?M[3]:Z[1]),h.margin=Z}});var se=!1;Object.defineProperty(this,"autoPaging",{get:function(){return se},set:function(M){se=M}});var q=0;Object.defineProperty(this,"lastBreak",{get:function(){return q},set:function(M){q=M}});var de=[];Object.defineProperty(this,"pageBreaks",{get:function(){return de},set:function(M){de=M}}),Object.defineProperty(this,"ctx",{get:function(){return h},set:function(M){M instanceof u&&(h=M)}}),Object.defineProperty(this,"path",{get:function(){return h.path},set:function(M){h.path=M}});var Ce=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ce},set:function(M){Ce=M}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(M){var Z;Z=A(M),this.ctx.fillStyle=Z.style,this.ctx.isFillTransparent=Z.a===0,this.ctx.fillOpacity=Z.a,this.pdf.setFillColor(Z.r,Z.g,Z.b,{a:Z.a}),this.pdf.setTextColor(Z.r,Z.g,Z.b,{a:Z.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(M){var Z=A(M);this.ctx.strokeStyle=Z.style,this.ctx.isStrokeTransparent=Z.a===0,this.ctx.strokeOpacity=Z.a,Z.a===0?this.pdf.setDrawColor(255,255,255):(Z.a,this.pdf.setDrawColor(Z.r,Z.g,Z.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(M){["butt","round","square"].indexOf(M)!==-1&&(this.ctx.lineCap=M,this.pdf.setLineCap(M))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(M){isNaN(M)||(this.ctx.lineWidth=M,this.pdf.setLineWidth(M))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(M){["bevel","round","miter"].indexOf(M)!==-1&&(this.ctx.lineJoin=M,this.pdf.setLineJoin(M))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(M){isNaN(M)||(this.ctx.miterLimit=M,this.pdf.setMiterLimit(M))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(M){this.ctx.textBaseline=M}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(M){["right","end","center","left","start"].indexOf(M)!==-1&&(this.ctx.textAlign=M)}});var Se=null,fe=null;Object.defineProperty(this,"fontFaces",{get:function(){return fe},set:function(M){Se=null,fe=M}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(M){var Z;if(this.ctx.font=M,(Z=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(M))!==null){var Ae=Z[1];Z[2];var ie=Z[3],ee=Z[4];Z[5];var ae=Z[6],me=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ee)[2];ee=Math.floor(me==="px"?parseFloat(ee)*this.pdf.internal.scaleFactor:me==="em"?parseFloat(ee)*this.pdf.getFontSize():parseFloat(ee)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ee);var _e=(function(He){var ze,Oe,ke=[],je=He.trim();if(je==="")return o4;if(je in RN)return[RN[je]];for(;je!=="";){switch(Oe=null,ze=(je=ON(je)).charAt(0)){case'"':case"'":Oe=gge(je.substring(1),ze);break;default:Oe=mge(je)}if(Oe===null||(ke.push(Oe[0]),(je=ON(Oe[1]))!==""&&je.charAt(0)!==","))return o4;je=je.replace(/^,/,"")}return ke})(ae);if(this.fontFaces){var ue=(function(He,ze){if(Se===null){var Oe=(function(ke){var je=[];return Object.keys(ke).forEach(function(rt){ke[rt].forEach(function(_t){var Ee=null;switch(_t){case"bold":Ee={family:rt,weight:"bold"};break;case"italic":Ee={family:rt,style:"italic"};break;case"bolditalic":Ee={family:rt,weight:"bold",style:"italic"};break;case"":case"normal":Ee={family:rt}}Ee!==null&&(Ee.ref={name:rt,style:_t},je.push(Ee))})}),je})(He.getFontList());Se=(function(ke){for(var je={},rt=0;rt<ke.length;++rt){var _t=s4(ke[rt]),Ee=_t.family,Le=_t.stretch,ye=_t.style,Ze=_t.weight;je[Ee]=je[Ee]||{},je[Ee][Le]=je[Ee][Le]||{},je[Ee][Le][ye]=je[Ee][Le][ye]||{},je[Ee][Le][ye][Ze]=_t}return je})(Oe.concat(ze))}return Se})(this.pdf,this.fontFaces),Be=_e.map(function(He){return{family:He,stretch:"normal",weight:ie,style:Ae}}),it=(function(He,ze,Oe){for(var ke=(Oe=Oe||{}).defaultFontFamily||"times",je=Object.assign({},pge,Oe.genericFontFamilies||{}),rt=null,_t=null,Ee=0;Ee<ze.length;++Ee)if(je[(rt=s4(ze[Ee])).family]&&(rt.family=je[rt.family]),He.hasOwnProperty(rt.family)){_t=He[rt.family];break}if(!(_t=_t||He[ke]))throw new Error("Could not find a font-family for the rule '"+UN(rt)+"' and default family '"+ke+"'.");if(_t=(function(Le,ye){if(ye[Le])return ye[Le];var Ze=UE[Le],nt=Ze<=UE.normal?-1:1,st=MN(ye,N$,Ze,nt);if(!st)throw new Error("Could not find a matching font-stretch value for "+Le);return st})(rt.stretch,_t),_t=(function(Le,ye){if(ye[Le])return ye[Le];for(var Ze=P$[Le],nt=0;nt<Ze.length;++nt)if(ye[Ze[nt]])return ye[Ze[nt]];throw new Error("Could not find a matching font-style for "+Le)})(rt.style,_t),!(_t=(function(Le,ye){if(ye[Le])return ye[Le];if(Le===400&&ye[500])return ye[500];if(Le===500&&ye[400])return ye[400];var Ze=fge[Le],nt=MN(ye,L$,Ze,Le<400?-1:1);if(!nt)throw new Error("Could not find a matching font-weight for value "+Le);return nt})(rt.weight,_t)))throw new Error("Failed to resolve a font for the rule '"+UN(rt)+"'.");return _t})(ue,Be);this.pdf.setFont(it.ref.name,it.ref.style)}else{var De="";(ie==="bold"||parseInt(ie,10)>=700||Ae==="bold")&&(De="bold"),Ae==="italic"&&(De+="italic"),De.length===0&&(De="normal");for(var qe="",Je={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Me=0;Me<_e.length;Me++){if(this.pdf.internal.getFont(_e[Me],De,{noFallback:!0,disableWarning:!0})!==void 0){qe=_e[Me];break}if(De==="bolditalic"&&this.pdf.internal.getFont(_e[Me],"bold",{noFallback:!0,disableWarning:!0})!==void 0)qe=_e[Me],De="bold";else if(this.pdf.internal.getFont(_e[Me],"normal",{noFallback:!0,disableWarning:!0})!==void 0){qe=_e[Me],De="normal";break}}if(qe===""){for(var et=0;et<_e.length;et++)if(Je[_e[et]]){qe=Je[_e[et]];break}}qe=qe===""?"Times":qe,this.pdf.setFont(qe,De)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(M){this.ctx.globalCompositeOperation=M}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(M){this.ctx.globalAlpha=M}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(M){this.ctx.lineDashOffset=M,U.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(M){this.ctx.lineDash=M,U.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(M){this.ctx.ignoreClearRect=!!M}})};d.prototype.setLineDash=function(Y){this.lineDash=Y},d.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},d.prototype.fill=function(){x.call(this,"fill",!1)},d.prototype.stroke=function(){x.call(this,"stroke",!1)},d.prototype.beginPath=function(){this.path=[{type:"begin"}]},d.prototype.moveTo=function(Y,K){if(isNaN(Y)||isNaN(K))throw Po.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var V=this.ctx.transform.applyToPoint(new o(Y,K));this.path.push({type:"mt",x:V.x,y:V.y}),this.ctx.lastPoint=new o(Y,K)},d.prototype.closePath=function(){var Y=new o(0,0),K=0;for(K=this.path.length-1;K!==-1;K--)if(this.path[K].type==="begin"&&go(this.path[K+1])==="object"&&typeof this.path[K+1].x=="number"){Y=new o(this.path[K+1].x,this.path[K+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(Y.x,Y.y)},d.prototype.lineTo=function(Y,K){if(isNaN(Y)||isNaN(K))throw Po.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var V=this.ctx.transform.applyToPoint(new o(Y,K));this.path.push({type:"lt",x:V.x,y:V.y}),this.ctx.lastPoint=new o(V.x,V.y)},d.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),x.call(this,null,!0)},d.prototype.quadraticCurveTo=function(Y,K,V,Q){if(isNaN(V)||isNaN(Q)||isNaN(Y)||isNaN(K))throw Po.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var X=this.ctx.transform.applyToPoint(new o(V,Q)),W=this.ctx.transform.applyToPoint(new o(Y,K));this.path.push({type:"qct",x1:W.x,y1:W.y,x:X.x,y:X.y}),this.ctx.lastPoint=new o(X.x,X.y)},d.prototype.bezierCurveTo=function(Y,K,V,Q,X,W){if(isNaN(X)||isNaN(W)||isNaN(Y)||isNaN(K)||isNaN(V)||isNaN(Q))throw Po.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var se=this.ctx.transform.applyToPoint(new o(X,W)),q=this.ctx.transform.applyToPoint(new o(Y,K)),de=this.ctx.transform.applyToPoint(new o(V,Q));this.path.push({type:"bct",x1:q.x,y1:q.y,x2:de.x,y2:de.y,x:se.x,y:se.y}),this.ctx.lastPoint=new o(se.x,se.y)},d.prototype.arc=function(Y,K,V,Q,X,W){if(isNaN(Y)||isNaN(K)||isNaN(V)||isNaN(Q)||isNaN(X))throw Po.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(W=!!W,!this.ctx.transform.isIdentity){var se=this.ctx.transform.applyToPoint(new o(Y,K));Y=se.x,K=se.y;var q=this.ctx.transform.applyToPoint(new o(0,V)),de=this.ctx.transform.applyToPoint(new o(0,0));V=Math.sqrt(Math.pow(q.x-de.x,2)+Math.pow(q.y-de.y,2))}Math.abs(X-Q)>=2*Math.PI&&(Q=0,X=2*Math.PI),this.path.push({type:"arc",x:Y,y:K,radius:V,startAngle:Q,endAngle:X,counterclockwise:W})},d.prototype.arcTo=function(Y,K,V,Q,X){throw new Error("arcTo not implemented.")},d.prototype.rect=function(Y,K,V,Q){if(isNaN(Y)||isNaN(K)||isNaN(V)||isNaN(Q))throw Po.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(Y,K),this.lineTo(Y+V,K),this.lineTo(Y+V,K+Q),this.lineTo(Y,K+Q),this.lineTo(Y,K),this.lineTo(Y+V,K),this.lineTo(Y,K)},d.prototype.fillRect=function(Y,K,V,Q){if(isNaN(Y)||isNaN(K)||isNaN(V)||isNaN(Q))throw Po.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var X={};this.lineCap!=="butt"&&(X.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(X.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(Y,K,V,Q),this.fill(),X.hasOwnProperty("lineCap")&&(this.lineCap=X.lineCap),X.hasOwnProperty("lineJoin")&&(this.lineJoin=X.lineJoin)}},d.prototype.strokeRect=function(Y,K,V,Q){if(isNaN(Y)||isNaN(K)||isNaN(V)||isNaN(Q))throw Po.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");p.call(this)||(this.beginPath(),this.rect(Y,K,V,Q),this.stroke())},d.prototype.clearRect=function(Y,K,V,Q){if(isNaN(Y)||isNaN(K)||isNaN(V)||isNaN(Q))throw Po.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(Y,K,V,Q))},d.prototype.save=function(Y){Y=typeof Y!="boolean"||Y;for(var K=this.pdf.internal.getCurrentPageInfo().pageNumber,V=0;V<this.pdf.internal.getNumberOfPages();V++)this.pdf.setPage(V+1),this.pdf.internal.out("q");if(this.pdf.setPage(K),Y){this.ctx.fontSize=this.pdf.internal.getFontSize();var Q=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Q}},d.prototype.restore=function(Y){Y=typeof Y!="boolean"||Y;for(var K=this.pdf.internal.getCurrentPageInfo().pageNumber,V=0;V<this.pdf.internal.getNumberOfPages();V++)this.pdf.setPage(V+1),this.pdf.internal.out("Q");this.pdf.setPage(K),Y&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},d.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var A=function(Y){var K,V,Q,X;if(Y.isCanvasGradient===!0&&(Y=Y.getColor()),!Y)return{r:0,g:0,b:0,a:0,style:Y};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(Y))K=0,V=0,Q=0,X=0;else{var W=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(Y);if(W!==null)K=parseInt(W[1]),V=parseInt(W[2]),Q=parseInt(W[3]),X=1;else if((W=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(Y))!==null)K=parseInt(W[1]),V=parseInt(W[2]),Q=parseInt(W[3]),X=parseFloat(W[4]);else{if(X=1,typeof Y=="string"&&Y.charAt(0)!=="#"){var se=new B$(Y);Y=se.ok?se.toHex():"#000000"}Y.length===4?(K=Y.substring(1,2),K+=K,V=Y.substring(2,3),V+=V,Q=Y.substring(3,4),Q+=Q):(K=Y.substring(1,3),V=Y.substring(3,5),Q=Y.substring(5,7)),K=parseInt(K,16),V=parseInt(V,16),Q=parseInt(Q,16)}}return{r:K,g:V,b:Q,a:X,style:Y}},f=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},p=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};d.prototype.fillText=function(Y,K,V,Q){if(isNaN(K)||isNaN(V)||typeof Y!="string")throw Po.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Q=isNaN(Q)?void 0:Q,!f.call(this)){var X=O(this.ctx.transform.rotation),W=this.ctx.transform.scaleX;k.call(this,{text:Y,x:K,y:V,scale:W,angle:X,align:this.textAlign,maxWidth:Q})}},d.prototype.strokeText=function(Y,K,V,Q){if(isNaN(K)||isNaN(V)||typeof Y!="string")throw Po.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!p.call(this)){Q=isNaN(Q)?void 0:Q;var X=O(this.ctx.transform.rotation),W=this.ctx.transform.scaleX;k.call(this,{text:Y,x:K,y:V,scale:W,renderingMode:"stroke",angle:X,align:this.textAlign,maxWidth:Q})}},d.prototype.measureText=function(Y){if(typeof Y!="string")throw Po.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var K=this.pdf,V=this.pdf.internal.scaleFactor,Q=K.internal.getFontSize(),X=K.getStringUnitWidth(Y)*Q/K.internal.scaleFactor;return new function(W){var se=(W=W||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return se}}),this}({width:X*=Math.round(96*V/72*1e4)/1e4})},d.prototype.scale=function(Y,K){if(isNaN(Y)||isNaN(K))throw Po.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var V=new l(Y,0,0,K,0,0);this.ctx.transform=this.ctx.transform.multiply(V)},d.prototype.rotate=function(Y){if(isNaN(Y))throw Po.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var K=new l(Math.cos(Y),Math.sin(Y),-Math.sin(Y),Math.cos(Y),0,0);this.ctx.transform=this.ctx.transform.multiply(K)},d.prototype.translate=function(Y,K){if(isNaN(Y)||isNaN(K))throw Po.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var V=new l(1,0,0,1,Y,K);this.ctx.transform=this.ctx.transform.multiply(V)},d.prototype.transform=function(Y,K,V,Q,X,W){if(isNaN(Y)||isNaN(K)||isNaN(V)||isNaN(Q)||isNaN(X)||isNaN(W))throw Po.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var se=new l(Y,K,V,Q,X,W);this.ctx.transform=this.ctx.transform.multiply(se)},d.prototype.setTransform=function(Y,K,V,Q,X,W){Y=isNaN(Y)?1:Y,K=isNaN(K)?0:K,V=isNaN(V)?0:V,Q=isNaN(Q)?1:Q,X=isNaN(X)?0:X,W=isNaN(W)?0:W,this.ctx.transform=new l(Y,K,V,Q,X,W)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};d.prototype.drawImage=function(Y,K,V,Q,X,W,se,q,de){var Ce=this.pdf.getImageProperties(Y),Se=1,fe=1,M=1,Z=1;Q!==void 0&&q!==void 0&&(M=q/Q,Z=de/X,Se=Ce.width/Q*q/Q,fe=Ce.height/X*de/X),W===void 0&&(W=K,se=V,K=0,V=0),Q!==void 0&&q===void 0&&(q=Q,de=X),Q===void 0&&q===void 0&&(q=Ce.width,de=Ce.height);for(var Ae,ie=this.ctx.transform.decompose(),ee=O(ie.rotate.shx),ae=new l,me=(ae=(ae=(ae=ae.multiply(ie.translate)).multiply(ie.skew)).multiply(ie.scale)).applyToRectangle(new a(W-K*M,se-V*Z,Q*Se,X*fe)),_e=v.call(this,me),ue=[],Be=0;Be<_e.length;Be+=1)ue.indexOf(_e[Be])===-1&&ue.push(_e[Be]);if(y(ue),this.autoPaging)for(var it=ue[0],De=ue[ue.length-1],qe=it;qe<De+1;qe++){this.pdf.setPage(qe);var Je=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Me=qe===1?this.posY+this.margin[0]:this.margin[0],et=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],He=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ze=qe===1?0:et+(qe-2)*He;if(this.ctx.clip_path.length!==0){var Oe=this.path;Ae=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=m(Ae,this.posX+this.margin[3],-ze+Me+this.ctx.prevPageLastElemOffset),S.call(this,"fill",!0),this.path=Oe}var ke=JSON.parse(JSON.stringify(me));ke=m([ke],this.posX+this.margin[3],-ze+Me+this.ctx.prevPageLastElemOffset)[0];var je=(qe>it||qe<De)&&g.call(this);je&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Je,He,null).clip().discardPath()),this.pdf.addImage(Y,"JPEG",ke.x,ke.y,ke.w,ke.h,null,null,ee),je&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(Y,"JPEG",me.x,me.y,me.w,me.h,null,null,ee)};var v=function(Y,K,V){var Q=[];K=K||this.pdf.internal.pageSize.width,V=V||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var X=this.posY+this.ctx.prevPageLastElemOffset;switch(Y.type){default:case"mt":case"lt":Q.push(Math.floor((Y.y+X)/V)+1);break;case"arc":Q.push(Math.floor((Y.y+X-Y.radius)/V)+1),Q.push(Math.floor((Y.y+X+Y.radius)/V)+1);break;case"qct":var W=J(this.ctx.lastPoint.x,this.ctx.lastPoint.y,Y.x1,Y.y1,Y.x,Y.y);Q.push(Math.floor((W.y+X)/V)+1),Q.push(Math.floor((W.y+W.h+X)/V)+1);break;case"bct":var se=$(this.ctx.lastPoint.x,this.ctx.lastPoint.y,Y.x1,Y.y1,Y.x2,Y.y2,Y.x,Y.y);Q.push(Math.floor((se.y+X)/V)+1),Q.push(Math.floor((se.y+se.h+X)/V)+1);break;case"rect":Q.push(Math.floor((Y.y+X)/V)+1),Q.push(Math.floor((Y.y+Y.h+X)/V)+1)}for(var q=0;q<Q.length;q+=1)for(;this.pdf.internal.getNumberOfPages()<Q[q];)w.call(this);return Q},w=function(){var Y=this.fillStyle,K=this.strokeStyle,V=this.font,Q=this.lineCap,X=this.lineWidth,W=this.lineJoin;this.pdf.addPage(),this.fillStyle=Y,this.strokeStyle=K,this.font=V,this.lineCap=Q,this.lineWidth=X,this.lineJoin=W},m=function(Y,K,V){for(var Q=0;Q<Y.length;Q++)switch(Y[Q].type){case"bct":Y[Q].x2+=K,Y[Q].y2+=V;case"qct":Y[Q].x1+=K,Y[Q].y1+=V;default:Y[Q].x+=K,Y[Q].y+=V}return Y},y=function(Y){return Y.sort(function(K,V){return K-V})},x=function(Y,K){for(var V,Q,X=this.fillStyle,W=this.strokeStyle,se=this.lineCap,q=this.lineWidth,de=Math.abs(q*this.ctx.transform.scaleX),Ce=this.lineJoin,Se=JSON.parse(JSON.stringify(this.path)),fe=JSON.parse(JSON.stringify(this.path)),M=[],Z=0;Z<fe.length;Z++)if(fe[Z].x!==void 0)for(var Ae=v.call(this,fe[Z]),ie=0;ie<Ae.length;ie+=1)M.indexOf(Ae[ie])===-1&&M.push(Ae[ie]);for(var ee=0;ee<M.length;ee++)for(;this.pdf.internal.getNumberOfPages()<M[ee];)w.call(this);if(y(M),this.autoPaging)for(var ae=M[0],me=M[M.length-1],_e=ae;_e<me+1;_e++){this.pdf.setPage(_e),this.fillStyle=X,this.strokeStyle=W,this.lineCap=se,this.lineWidth=de,this.lineJoin=Ce;var ue=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Be=_e===1?this.posY+this.margin[0]:this.margin[0],it=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],De=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],qe=_e===1?0:it+(_e-2)*De;if(this.ctx.clip_path.length!==0){var Je=this.path;V=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=m(V,this.posX+this.margin[3],-qe+Be+this.ctx.prevPageLastElemOffset),S.call(this,Y,!0),this.path=Je}if(Q=JSON.parse(JSON.stringify(Se)),this.path=m(Q,this.posX+this.margin[3],-qe+Be+this.ctx.prevPageLastElemOffset),K===!1||_e===0){var Me=(_e>ae||_e<me)&&g.call(this);Me&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ue,De,null).clip().discardPath()),S.call(this,Y,K),Me&&this.pdf.restoreGraphicsState()}this.lineWidth=q}else this.lineWidth=de,S.call(this,Y,K),this.lineWidth=q;this.path=Se},S=function(Y,K){if((Y!=="stroke"||K||!p.call(this))&&(Y==="stroke"||K||!f.call(this))){for(var V,Q,X=[],W=this.path,se=0;se<W.length;se++){var q=W[se];switch(q.type){case"begin":X.push({begin:!0});break;case"close":X.push({close:!0});break;case"mt":X.push({start:q,deltas:[],abs:[]});break;case"lt":var de=X.length;if(W[se-1]&&!isNaN(W[se-1].x)&&(V=[q.x-W[se-1].x,q.y-W[se-1].y],de>0)){for(;de>=0;de--)if(X[de-1].close!==!0&&X[de-1].begin!==!0){X[de-1].deltas.push(V),X[de-1].abs.push(q);break}}break;case"bct":V=[q.x1-W[se-1].x,q.y1-W[se-1].y,q.x2-W[se-1].x,q.y2-W[se-1].y,q.x-W[se-1].x,q.y-W[se-1].y],X[X.length-1].deltas.push(V);break;case"qct":var Ce=W[se-1].x+2/3*(q.x1-W[se-1].x),Se=W[se-1].y+2/3*(q.y1-W[se-1].y),fe=q.x+2/3*(q.x1-q.x),M=q.y+2/3*(q.y1-q.y),Z=q.x,Ae=q.y;V=[Ce-W[se-1].x,Se-W[se-1].y,fe-W[se-1].x,M-W[se-1].y,Z-W[se-1].x,Ae-W[se-1].y],X[X.length-1].deltas.push(V);break;case"arc":X.push({deltas:[],abs:[],arc:!0}),Array.isArray(X[X.length-1].abs)&&X[X.length-1].abs.push(q)}}Q=K?null:Y==="stroke"?"stroke":"fill";for(var ie=!1,ee=0;ee<X.length;ee++)if(X[ee].arc)for(var ae=X[ee].abs,me=0;me<ae.length;me++){var _e=ae[me];_e.type==="arc"?C.call(this,_e.x,_e.y,_e.radius,_e.startAngle,_e.endAngle,_e.counterclockwise,void 0,K,!ie):B.call(this,_e.x,_e.y),ie=!0}else if(X[ee].close===!0)this.pdf.internal.out("h"),ie=!1;else if(X[ee].begin!==!0){var ue=X[ee].start.x,Be=X[ee].start.y;E.call(this,X[ee].deltas,ue,Be),ie=!0}Q&&b.call(this,Q),K&&D.call(this)}},I=function(Y){var K=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,V=K*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return Y-V;case"top":return Y+K-V;case"hanging":return Y+K-2*V;case"middle":return Y+K/2-V;default:return Y}},j=function(Y){return Y+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};d.prototype.createLinearGradient=function(){var Y=function(){};return Y.colorStops=[],Y.addColorStop=function(K,V){this.colorStops.push([K,V])},Y.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},Y.isCanvasGradient=!0,Y},d.prototype.createPattern=function(){return this.createLinearGradient()},d.prototype.createRadialGradient=function(){return this.createLinearGradient()};var C=function(Y,K,V,Q,X,W,se,q,de){for(var Ce=te.call(this,V,Q,X,W),Se=0;Se<Ce.length;Se++){var fe=Ce[Se];Se===0&&(de?T.call(this,fe.x1+Y,fe.y1+K):B.call(this,fe.x1+Y,fe.y1+K)),z.call(this,Y,K,fe.x2,fe.y2,fe.x3,fe.y3,fe.x4,fe.y4)}q?D.call(this):b.call(this,se)},b=function(Y){switch(Y){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},D=function(){this.pdf.clip(),this.pdf.discardPath()},T=function(Y,K){this.pdf.internal.out(t(Y)+" "+i(K)+" m")},k=function(Y){var K;switch(Y.align){case"right":case"end":K="right";break;case"center":K="center";break;default:K="left"}var V=this.pdf.getTextDimensions(Y.text),Q=I.call(this,Y.y),X=j.call(this,Q)-V.h,W=this.ctx.transform.applyToPoint(new o(Y.x,Q)),se=this.ctx.transform.decompose(),q=new l;q=(q=(q=q.multiply(se.translate)).multiply(se.skew)).multiply(se.scale);for(var de,Ce,Se,fe=this.ctx.transform.applyToRectangle(new a(Y.x,Q,V.w,V.h)),M=q.applyToRectangle(new a(Y.x,X,V.w,V.h)),Z=v.call(this,M),Ae=[],ie=0;ie<Z.length;ie+=1)Ae.indexOf(Z[ie])===-1&&Ae.push(Z[ie]);if(y(Ae),this.autoPaging)for(var ee=Ae[0],ae=Ae[Ae.length-1],me=ee;me<ae+1;me++){this.pdf.setPage(me);var _e=me===1?this.posY+this.margin[0]:this.margin[0],ue=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Be=this.pdf.internal.pageSize.height-this.margin[2],it=Be-this.margin[0],De=this.pdf.internal.pageSize.width-this.margin[1],qe=De-this.margin[3],Je=me===1?0:ue+(me-2)*it;if(this.ctx.clip_path.length!==0){var Me=this.path;de=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=m(de,this.posX+this.margin[3],-1*Je+_e),S.call(this,"fill",!0),this.path=Me}var et=m([JSON.parse(JSON.stringify(M))],this.posX+this.margin[3],-Je+_e+this.ctx.prevPageLastElemOffset)[0];Y.scale>=.01&&(Ce=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ce*Y.scale),Se=this.lineWidth,this.lineWidth=Se*Y.scale);var He=this.autoPaging!=="text";if(He||et.y+et.h<=Be){if(He||et.y>=_e&&et.x<=De){var ze=He?Y.text:this.pdf.splitTextToSize(Y.text,Y.maxWidth||De-et.x)[0],Oe=m([JSON.parse(JSON.stringify(fe))],this.posX+this.margin[3],-Je+_e+this.ctx.prevPageLastElemOffset)[0],ke=He&&(me>ee||me<ae)&&g.call(this);ke&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],qe,it,null).clip().discardPath()),this.pdf.text(ze,Oe.x,Oe.y,{angle:Y.angle,align:K,renderingMode:Y.renderingMode}),ke&&this.pdf.restoreGraphicsState()}}else et.y<Be&&(this.ctx.prevPageLastElemOffset+=Be-et.y);Y.scale>=.01&&(this.pdf.setFontSize(Ce),this.lineWidth=Se)}else Y.scale>=.01&&(Ce=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ce*Y.scale),Se=this.lineWidth,this.lineWidth=Se*Y.scale),this.pdf.text(Y.text,W.x+this.posX,W.y+this.posY,{angle:Y.angle,align:K,renderingMode:Y.renderingMode,maxWidth:Y.maxWidth}),Y.scale>=.01&&(this.pdf.setFontSize(Ce),this.lineWidth=Se)},B=function(Y,K,V,Q){V=V||0,Q=Q||0,this.pdf.internal.out(t(Y+V)+" "+i(K+Q)+" l")},E=function(Y,K,V){return this.pdf.lines(Y,K,V,null,null)},z=function(Y,K,V,Q,X,W,se,q){this.pdf.internal.out([e(r(V+Y)),e(s(Q+K)),e(r(X+Y)),e(s(W+K)),e(r(se+Y)),e(s(q+K)),"c"].join(" "))},te=function(Y,K,V,Q){for(var X=2*Math.PI,W=Math.PI/2;K>V;)K-=X;var se=Math.abs(V-K);se<X&&Q&&(se=X-se);for(var q=[],de=Q?-1:1,Ce=K;se>1e-5;){var Se=Ce+de*Math.min(se,W);q.push(L.call(this,Y,Ce,Se)),se-=Math.abs(Se-Ce),Ce=Se}return q},L=function(Y,K,V){var Q=(V-K)/2,X=Y*Math.cos(Q),W=Y*Math.sin(Q),se=X,q=-W,de=se*se+q*q,Ce=de+se*X+q*W,Se=4/3*(Math.sqrt(2*de*Ce)-Ce)/(se*W-q*X),fe=se-Se*q,M=q+Se*se,Z=fe,Ae=-M,ie=Q+K,ee=Math.cos(ie),ae=Math.sin(ie);return{x1:Y*Math.cos(K),y1:Y*Math.sin(K),x2:fe*ee-M*ae,y2:fe*ae+M*ee,x3:Z*ee-Ae*ae,y3:Z*ae+Ae*ee,x4:Y*Math.cos(V),y4:Y*Math.sin(V)}},O=function(Y){return 180*Y/Math.PI},J=function(Y,K,V,Q,X,W){var se=Y+.5*(V-Y),q=K+.5*(Q-K),de=X+.5*(V-X),Ce=W+.5*(Q-W),Se=Math.min(Y,X,se,de),fe=Math.max(Y,X,se,de),M=Math.min(K,W,q,Ce),Z=Math.max(K,W,q,Ce);return new a(Se,M,fe-Se,Z-M)},$=function(Y,K,V,Q,X,W,se,q){var de,Ce,Se,fe,M,Z,Ae,ie,ee,ae,me,_e,ue,Be,it=V-Y,De=Q-K,qe=X-V,Je=W-Q,Me=se-X,et=q-W;for(Ce=0;Ce<41;Ce++)ee=(Ae=(Se=Y+(de=Ce/40)*it)+de*((M=V+de*qe)-Se))+de*(M+de*(X+de*Me-M)-Ae),ae=(ie=(fe=K+de*De)+de*((Z=Q+de*Je)-fe))+de*(Z+de*(W+de*et-Z)-ie),Ce==0?(me=ee,_e=ae,ue=ee,Be=ae):(me=Math.min(me,ee),_e=Math.min(_e,ae),ue=Math.max(ue,ee),Be=Math.max(Be,ae));return new a(Math.round(me),Math.round(_e),Math.round(ue-me),Math.round(Be-_e))},U=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var Y,K,V=(Y=this.ctx.lineDash,K=this.ctx.lineDashOffset,JSON.stringify({lineDash:Y,lineDashOffset:K}));this.prevLineDash!==V&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=V)}}})(qi.API),(function(n){var e=function(o){var a,l,h,u,d,A,f,p,g,v;for(l=[],h=0,u=(o+=a="\0\0\0\0".slice(o.length%4||4)).length;u>h;h+=4)(d=(o.charCodeAt(h)<<24)+(o.charCodeAt(h+1)<<16)+(o.charCodeAt(h+2)<<8)+o.charCodeAt(h+3))!==0?(A=(d=((d=((d=((d=(d-(v=d%85))/85)-(g=d%85))/85)-(p=d%85))/85)-(f=d%85))/85)%85,l.push(A+33,f+33,p+33,g+33,v+33)):l.push(122);return(function(w,m){for(var y=m;y>0;y--)w.pop()})(l,a.length),String.fromCharCode.apply(String,l)+"~>"},t=function(o){var a,l,h,u,d,A=String,f="length",p=255,g="charCodeAt",v="slice",w="replace";for(o[v](-2),o=o[v](0,-2)[w](/\s/g,"")[w]("z","!!!!!"),h=[],u=0,d=(o+=a="uuuuu"[v](o[f]%5||5))[f];d>u;u+=5)l=52200625*(o[g](u)-33)+614125*(o[g](u+1)-33)+7225*(o[g](u+2)-33)+85*(o[g](u+3)-33)+(o[g](u+4)-33),h.push(p&l>>24,p&l>>16,p&l>>8,p&l);return(function(m,y){for(var x=y;x>0;x--)m.pop()})(h,a[f]),A.fromCharCode.apply(A,h)},i=function(o){return o.split("").map(function(a){return("0"+a.charCodeAt().toString(16)).slice(-2)}).join("")+">"},r=function(o){var a=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),a.test(o)===!1)return"";for(var l="",h=0;h<o.length;h+=2)l+=String.fromCharCode("0x"+(o[h]+o[h+1]));return l},s=function(o){for(var a=new Uint8Array(o.length),l=o.length;l--;)a[l]=o.charCodeAt(l);return(a=DE(a)).reduce(function(h,u){return h+String.fromCharCode(u)},"")};n.processDataByFilters=function(o,a){var l=0,h=o||"",u=[];for(typeof(a=a||[])=="string"&&(a=[a]),l=0;l<a.length;l+=1)switch(a[l]){case"ASCII85Decode":case"/ASCII85Decode":h=t(h),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":h=e(h),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":h=r(h),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":h=i(h),u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":h=s(h),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+a[l]+'" is not implemented')}return{data:h,reverseChain:u.reverse().join(" ")}}})(qi.API),(function(n){n.loadFile=function(e,t,i){return(function(r,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var a=void 0;try{a=(function(l,h,u){var d=new XMLHttpRequest,A=0,f=function(p){var g=p.length,v=[],w=String.fromCharCode;for(A=0;A<g;A+=1)v.push(w(255&p.charCodeAt(A)));return v.join("")};if(d.open("GET",l,!h),d.overrideMimeType("text/plain; charset=x-user-defined"),h===!1&&(d.onload=function(){d.status===200?u(f(this.responseText)):u(void 0)}),d.send(null),h&&d.status===200)return f(d.responseText)})(r,s,o)}catch{}return a})(e,t,i)},n.loadImageFile=n.loadFile})(qi.API),(function(n){function e(){return(Lr.html2canvas?Promise.resolve(Lr.html2canvas):rl(()=>Promise.resolve().then(()=>awe),void 0)).catch(function(a){return Promise.reject(new Error("Could not load html2canvas: "+a))}).then(function(a){return a.default?a.default:a})}function t(){return(Lr.DOMPurify?Promise.resolve(Lr.DOMPurify):rl(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load dompurify: "+a))}).then(function(a){return a.default?a.default:a})}var i=function(a){var l=go(a);return l==="undefined"?"undefined":l==="string"||a instanceof String?"string":l==="number"||a instanceof Number?"number":l==="function"||a instanceof Function?"function":a&&a.constructor===Array?"array":a&&a.nodeType===1?"element":l==="object"?"object":"unknown"},r=function(a,l){var h=document.createElement(a);for(var u in l.className&&(h.className=l.className),l.innerHTML&&l.dompurify&&(h.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)h.style[u]=l.style[u];return h},s=function a(l,h){for(var u=l.nodeType===3?document.createTextNode(l.nodeValue):l.cloneNode(!1),d=l.firstChild;d;d=d.nextSibling)h!==!0&&d.nodeType===1&&d.nodeName==="SCRIPT"||u.appendChild(a(d,h));return l.nodeType===1&&(l.nodeName==="CANVAS"?(u.width=l.width,u.height=l.height,u.getContext("2d").drawImage(l,0,0)):l.nodeName!=="TEXTAREA"&&l.nodeName!=="SELECT"||(u.value=l.value),u.addEventListener("load",function(){u.scrollTop=l.scrollTop,u.scrollLeft=l.scrollLeft},!0)),u},o=function a(l){var h=Object.assign(a.convert(Promise.resolve()),JSON.parse(JSON.stringify(a.template))),u=a.convert(Promise.resolve(),h);return(u=u.setProgress(1,a,1,[a])).set(l)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(a,l){return a.__proto__=l||o.prototype,a},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(a,l){return this.then(function(){switch(l=l||(function(h){switch(i(h)){case"string":return"string";case"element":return h.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(a),l){case"string":return this.then(t).then(function(h){return this.set({src:r("div",{innerHTML:a,dompurify:h})})});case"element":return this.set({src:a});case"canvas":return this.set({canvas:a});case"img":return this.set({img:a});default:return this.error("Unknown source type.")}})},o.prototype.to=function(a){switch(a){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var a={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(a.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=r("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=r("div",{className:"html2pdf__container",style:a}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(r("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(e).then(function(l){var h=Object.assign({},this.opt.html2canvas);return delete h.onrendered,l(this.prop.container,h)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(e).then(function(l){var h=this.opt.jsPDF,u=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,A=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete A.onrendered,h.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,h.context2d.posX=this.opt.x,h.context2d.posY=this.opt.y,h.context2d.margin=this.opt.margin,h.context2d.fontFaces=u,u)for(var f=0;f<u.length;++f){var p=u[f],g=p.src.find(function(v){return v.format==="truetype"});g&&h.addFont(g.url,p.ref.name,p.ref.style)}return A.windowHeight=A.windowHeight||0,A.windowHeight=A.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):A.windowHeight,h.context2d.save(!0),l(this.prop.container,A)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var a=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=a})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(a,l,h){return(h=h||"pdf").toLowerCase()==="img"||h.toLowerCase()==="image"?this.outputImg(a,l):this.outputPdf(a,l)},o.prototype.outputPdf=function(a,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(a,l)})},o.prototype.outputImg=function(a){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(a){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+a+'" is not supported.'}})},o.prototype.save=function(a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(a?{filename:a}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(a){if(i(a)!=="object")return this;var l=Object.keys(a||{}).map(function(h){if(h in o.template.prop)return function(){this.prop[h]=a[h]};switch(h){case"margin":return this.setMargin.bind(this,a.margin);case"jsPDF":return function(){return this.opt.jsPDF=a.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,a.pageSize);default:return function(){this.opt[h]=a[h]}}},this);return this.then(function(){return this.thenList(l)})},o.prototype.get=function(a,l){return this.then(function(){var h=a in o.template.prop?this.prop[a]:this.opt[a];return l?l(h):h})},o.prototype.setMargin=function(a){return this.then(function(){switch(i(a)){case"number":a=[a,a,a,a];case"array":if(a.length===2&&(a=[a[0],a[1],a[0],a[1]]),a.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=a}).then(this.setPageSize)},o.prototype.setPageSize=function(a){function l(h,u){return Math.floor(h*u/72*96)}return this.then(function(){(a=a||qi.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(a.inner={width:a.width-this.opt.margin[1]-this.opt.margin[3],height:a.height-this.opt.margin[0]-this.opt.margin[2]},a.inner.px={width:l(a.inner.width,a.k),height:l(a.inner.height,a.k)},a.inner.ratio=a.inner.height/a.inner.width),this.prop.pageSize=a})},o.prototype.setProgress=function(a,l,h,u){return a!=null&&(this.progress.val=a),l!=null&&(this.progress.state=l),h!=null&&(this.progress.n=h),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(a,l,h,u){return this.setProgress(a?this.progress.val+a:null,l||null,h?this.progress.n+h:null,u?this.progress.stack.concat(u):null)},o.prototype.then=function(a,l){var h=this;return this.thenCore(a,l,function(u,d){return h.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(A){return h.updateProgress(null,u),A}).then(u,d).then(function(A){return h.updateProgress(1),A})})},o.prototype.thenCore=function(a,l,h){h=h||Promise.prototype.then;var u=this;a&&(a=a.bind(u)),l&&(l=l.bind(u));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?u:o.convert(Object.assign({},u),Promise.prototype),A=h.call(d,a,l);return o.convert(A,u.__proto__)},o.prototype.thenExternal=function(a,l){return Promise.prototype.then.call(this,a,l)},o.prototype.thenList=function(a){var l=this;return a.forEach(function(h){l=l.thenCore(h)}),l},o.prototype.catch=function(a){a&&(a=a.bind(this));var l=Promise.prototype.catch.call(this,a);return o.convert(l,this)},o.prototype.catchExternal=function(a){return Promise.prototype.catch.call(this,a)},o.prototype.error=function(a){return this.then(function(){throw new Error(a)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,qi.getPageSize=function(a,l,h){if(go(a)==="object"){var u=a;a=u.orientation,l=u.unit||l,h=u.format||h}l=l||"mm",h=h||"a4",a=(""+(a||"P")).toLowerCase();var d,A=(""+h).toLowerCase(),f={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+l}var p,g=0,v=0;if(f.hasOwnProperty(A))g=f[A][1]/d,v=f[A][0]/d;else try{g=h[1],v=h[0]}catch{throw new Error("Invalid format: "+h)}if(a==="p"||a==="portrait")a="p",v>g&&(p=v,v=g,g=p);else{if(a!=="l"&&a!=="landscape")throw"Invalid orientation: "+a;a="l",g>v&&(p=v,v=g,g=p)}return{width:v,height:g,unit:l,k:d,orientation:a}},n.html=function(a,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(s4):null;var h=new o(l);return l.worker?h:h.from(a).doCallback()}})(qi.API),qi.API.addJS=function(n){return WN=n,this.internal.events.subscribe("postPutResources",function(){Ux=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Ux+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),HN=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+WN+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Ux!==void 0&&HN!==void 0&&this.internal.out("/Names <</JavaScript "+Ux+" 0 R>>")}),this},(function(n){var e;n.events.push(["postPutResources",function(){var t=this,i=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=t.outline.render().split(/\r\n/),s=0;s<r.length;s++){var o=r[s],a=i.exec(o);if(a!=null){var l=a[1];t.internal.newObjectDeferredBegin(l,!1)}t.internal.write(o)}if(this.outline.createNamedDestinations){var h=this.internal.pages.length,u=[];for(s=0;s<h;s++){var d=t.internal.newObject();u.push(d);var A=t.internal.getPageInfo(s+1);t.internal.write("<< /D["+A.objId+" 0 R /XYZ null null null]>> endobj")}var f=t.internal.newObject();for(t.internal.write("<< /Names [ "),s=0;s<u.length;s++)t.internal.write("(page_"+(s+1)+")"+u[s]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+f+" 0 R"),t.internal.write(">>","endobj")}}]),n.events.push(["putCatalog",function(){var t=this;t.outline.root.children.length>0&&(t.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&t.internal.write("/Names "+e+" 0 R"))}]),n.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(i,r,s){var o={title:r,options:s,children:[]};return i==null&&(i=this.root),i.children.push(o),o},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(i){i.id=t.internal.newObjectDeferred();for(var r=0;r<i.children.length;r++)this.genIds_r(i.children[r])},t.outline.renderRoot=function(i){this.objStart(i),this.line("/Type /Outlines"),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1]))),this.line("/Count "+this.count_r({count:0},i)),this.objEnd()},t.outline.renderItems=function(i){for(var r=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<i.children.length;s++){var o=i.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(i)),s>0&&this.line("/Prev "+this.makeRef(i.children[s-1])),s<i.children.length-1&&this.line("/Next "+this.makeRef(i.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var a=this.count=this.count_r({count:0},o);if(a>0&&this.line("/Count "+a),o.options&&o.options.pageNumber){var l=t.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+r(0)+" 0]")}this.objEnd()}for(var h=0;h<i.children.length;h++)this.renderItems(i.children[h])},t.outline.line=function(i){this.ctx.val+=i+`\r
`},t.outline.makeRef=function(i){return i.id+" 0 R"},t.outline.makeString=function(i){return"("+t.internal.pdfEscape(i)+")"},t.outline.objStart=function(i){this.ctx.val+=`\r
`+i.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(i,r){for(var s=0;s<r.children.length;s++)i.count++,this.count_r(i,r.children[s]);return i.count}}])})(qi.API),(function(n){var e=[192,193,194,195,196,197,198,199];n.processJPEG=function(t,i,r,s,o,a){var l,h=this.decode.DCT_DECODE,u=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=o||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,l=(function(d){for(var A,f=256*d.charCodeAt(4)+d.charCodeAt(5),p=d.length,g={width:0,height:0,numcomponents:1},v=4;v<p;v+=2){if(v+=f,e.indexOf(d.charCodeAt(v+1))!==-1){A=256*d.charCodeAt(v+5)+d.charCodeAt(v+6),g={width:256*d.charCodeAt(v+7)+d.charCodeAt(v+8),height:A,numcomponents:d.charCodeAt(v+9)};break}f=256*d.charCodeAt(v+2)+d.charCodeAt(v+3)}return g})(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t),l.numcomponents){case 1:a=this.color_spaces.DEVICE_GRAY;break;case 4:a=this.color_spaces.DEVICE_CMYK;break;case 3:a=this.color_spaces.DEVICE_RGB}u={data:t,width:l.width,height:l.height,colorSpace:a,bitsPerComponent:8,filter:h,index:i,alias:r}}return u}})(qi.API),qi.API.processPNG=function(n,e,t,i){if(this.__addimage__.isArrayBuffer(n)&&(n=new Uint8Array(n)),this.__addimage__.isArrayBufferView(n)){var r,s=ege(n,{checkCrc:!0}),o=s.width,a=s.height,l=s.channels,h=s.palette,u=s.depth;r=h&&l===1?(function(j){for(var C=j.width,b=j.height,D=j.data,T=j.palette,k=j.depth,B=!1,E=[],z=[],te=void 0,L=!1,O=0,J=0;J<T.length;J++){var $=VP(T[J],4),U=$[0],Y=$[1],K=$[2],V=$[3];E.push(U,Y,K),V!=null&&(V===0?(O++,z.length<1&&z.push(J)):V<255&&(L=!0))}if(L||O>1){B=!0,z=void 0;var Q=C*b;te=new Uint8Array(Q);for(var X=new DataView(D.buffer),W=0;W<Q;W++){var se=a4(X,W,k),q=VP(T[se],4)[3];te[W]=q}}return{colorSpace:"Indexed",colorsPerPixel:1,colorBytes:D,alphaBytes:te,needSMask:B,palette:E,mask:z}})(s):l===2||l===4?(function(j){for(var C=j.data,b=j.width,D=j.height,T=j.channels,k=j.depth,B=T===2?"DeviceGray":"DeviceRGB",E=T-1,z=b*D,te=E,L=z*te,O=1*z,J=Math.ceil(L*k/8),$=Math.ceil(O*k/8),U=new Uint8Array(J),Y=new Uint8Array($),K=new DataView(C.buffer),V=new DataView(U.buffer),Q=new DataView(Y.buffer),X=!1,W=0;W<z;W++){for(var se=W*T,q=0;q<te;q++)qN(V,a4(K,se+q,k),W*te+q,k);var de=a4(K,se+te,k);de<(1<<k)-1&&(X=!0),qN(Q,de,1*W,k)}return{colorSpace:B,colorsPerPixel:E,colorBytes:U,alphaBytes:Y,needSMask:X}})(s):(function(j){var C=j.data,b=j.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:b,colorsPerPixel:b==="DeviceGray"?1:3,colorBytes:C instanceof Uint8Array?C:new Uint8Array(C.buffer),needSMask:!1}})(s);var d,A,f,p=r,g=p.colorSpace,v=p.colorsPerPixel,w=p.colorBytes,m=p.alphaBytes,y=p.needSMask,x=p.palette,S=p.mask,I=null;return i!==qi.API.image_compression.NONE&&typeof DE=="function"?(I=(function(j){var C;switch(j){case qi.API.image_compression.FAST:C=11;break;case qi.API.image_compression.MEDIUM:C=13;break;case qi.API.image_compression.SLOW:C=14;break;default:C=12}return C})(i),d=this.decode.FLATE_DECODE,A="/Predictor ".concat(I," "),n=VN(w,o*v,v,i),y&&(f=VN(m,o,1,i))):(d=void 0,A="",n=w,y&&(f=m)),A+="/Colors ".concat(v," /BitsPerComponent ").concat(u," /Columns ").concat(o),(this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n))&&(n=this.__addimage__.arrayBufferToBinaryString(n)),(f&&this.__addimage__.isArrayBuffer(f)||this.__addimage__.isArrayBufferView(f))&&(f=this.__addimage__.arrayBufferToBinaryString(f)),{alias:t,data:n,index:e,filter:d,decodeParameters:A,transparency:S,palette:x,sMask:f,predictor:I,width:o,height:a,bitsPerComponent:u,colorSpace:g}}},(function(n){n.processGIF89A=function(e,t,i,r){var s=new xge(e),o=s.width,a=s.height,l=[];s.decodeAndBlitFrameRGBA(0,l);var h={data:l,width:o,height:a},u=new l4(100).encode(h,100);return n.processJPEG.call(this,u,t,i,r)},n.processGIF87A=n.processGIF89A})(qi.API),Ju.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var n=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(n);for(var e=0;e<n;e++){var t=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:r,green:i,blue:t,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Ju.prototype.parseBGR=function(){this.pos=this.offset;try{var n="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[n]()}catch(t){Po.log("bit decode error:"+t)}},Ju.prototype.bit1=function(){var n,e=Math.ceil(this.width/8),t=e%4;for(n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,r=0;r<e;r++)for(var s=this.datav.getUint8(this.pos++,!0),o=i*this.width*4+8*r*4,a=0;a<8&&8*r+a<this.width;a++){var l=this.palette[s>>7-a&1];this.data[o+4*a]=l.blue,this.data[o+4*a+1]=l.green,this.data[o+4*a+2]=l.red,this.data[o+4*a+3]=255}t!==0&&(this.pos+=4-t)}},Ju.prototype.bit4=function(){for(var n=Math.ceil(this.width/2),e=n%4,t=this.height-1;t>=0;t--){for(var i=this.bottom_up?t:this.height-1-t,r=0;r<n;r++){var s=this.datav.getUint8(this.pos++,!0),o=i*this.width*4+2*r*4,a=s>>4,l=15&s,h=this.palette[a];if(this.data[o]=h.blue,this.data[o+1]=h.green,this.data[o+2]=h.red,this.data[o+3]=255,2*r+1>=this.width)break;h=this.palette[l],this.data[o+4]=h.blue,this.data[o+4+1]=h.green,this.data[o+4+2]=h.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},Ju.prototype.bit8=function(){for(var n=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,i=0;i<this.width;i++){var r=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*i;if(r<this.palette.length){var o=this.palette[r];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}n!==0&&(this.pos+=4-n)}},Ju.prototype.bit15=function(){for(var n=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var i=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&e)/e*255|0,a=(s>>5&e)/e*255|0,l=(s>>10&e)/e*255|0,h=s>>15?255:0,u=i*this.width*4+4*r;this.data[u]=l,this.data[u+1]=a,this.data[u+2]=o,this.data[u+3]=h}this.pos+=n}},Ju.prototype.bit16=function(){for(var n=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),i=this.height-1;i>=0;i--){for(var r=this.bottom_up?i:this.height-1-i,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(o&e)/e*255|0,l=(o>>5&t)/t*255|0,h=(o>>11)/e*255|0,u=r*this.width*4+4*s;this.data[u]=h,this.data[u+1]=l,this.data[u+2]=a,this.data[u+3]=255}this.pos+=n}},Ju.prototype.bit24=function(){for(var n=this.height-1;n>=0;n--){for(var e=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var i=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*t;this.data[o]=s,this.data[o+1]=r,this.data[o+2]=i,this.data[o+3]=255}this.pos+=this.width%4}},Ju.prototype.bit32=function(){for(var n=this.height-1;n>=0;n--)for(var e=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var i=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*t;this.data[a]=s,this.data[a+1]=r,this.data[a+2]=i,this.data[a+3]=o}},Ju.prototype.getData=function(){return this.data},(function(n){n.processBMP=function(e,t,i,r){var s=new Ju(e,!1),o=s.width,a=s.height,l={data:s.getData(),width:o,height:a},h=new l4(100).encode(l,100);return n.processJPEG.call(this,h,t,i,r)}})(qi.API),JN.prototype.getData=function(){return this.data},(function(n){n.processWEBP=function(e,t,i,r){var s=new JN(e),o=s.width,a=s.height,l={data:s.getData(),width:o,height:a},h=new l4(100).encode(l,100);return n.processJPEG.call(this,h,t,i,r)}})(qi.API),qi.API.processRGBA=function(n,e,t){for(var i=n.data,r=i.length,s=new Uint8Array(r/4*3),o=new Uint8Array(r/4),a=0,l=0,h=0;h<r;h+=4){var u=i[h],d=i[h+1],A=i[h+2],f=i[h+3];s[a++]=u,s[a++]=d,s[a++]=A,o[l++]=f}var p=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:p,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:n.width,height:n.height}},qi.API.setLanguage=function(n){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[n]!==void 0&&(this.internal.languageSettings.languageCode=n,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},z0=qi.API,Ox=z0.getCharWidthsArray=function(n,e){var t,i,r=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),a=e.widths?e.widths:r.metadata.Unicode.widths,l=a.fof?a.fof:1,h=e.kerning?e.kerning:r.metadata.Unicode.kerning,u=h.fof?h.fof:1,d=e.doKerning!==!1,A=0,f=n.length,p=0,g=a[0]||l,v=[];for(t=0;t<f;t++)i=n.charCodeAt(t),typeof r.metadata.widthOfString=="function"?v.push((r.metadata.widthOfGlyph(r.metadata.characterToGlyph(i))+o*(1e3/s)||0)/1e3):(A=d&&go(h[i])==="object"&&!isNaN(parseInt(h[i][p],10))?h[i][p]/u:0,v.push((a[i]||g)/l+A)),p=i;return v},zN=z0.getStringUnitWidth=function(n,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),i=e.font||this.internal.getFont(),r=e.charSpace||this.internal.getCharSpace();return z0.processArabic&&(n=z0.processArabic(n)),typeof i.metadata.widthOfString=="function"?i.metadata.widthOfString(n,t,r)/t:Ox.apply(this,arguments).reduce(function(s,o){return s+o},0)},QN=function(n,e,t,i){for(var r=[],s=0,o=n.length,a=0;s!==o&&a+e[s]<t;)a+=e[s],s++;r.push(n.slice(0,s));var l=s;for(a=0;s!==o;)a+e[s]>i&&(r.push(n.slice(l,s)),a=0,l=s),a+=e[s],s++;return l!==s&&r.push(n.slice(l,s)),r},$N=function(n,e,t){t||(t={});var i,r,s,o,a,l,h,u=[],d=[u],A=t.textIndent||0,f=0,p=0,g=n.split(" "),v=Ox.apply(this,[" ",t])[0];if(l=t.lineIndent===-1?g[0].length+2:t.lineIndent||0){var w=Array(l).join(" "),m=[];g.map(function(x){(x=x.split(/\s*\n/)).length>1?m=m.concat(x.map(function(S,I){return(I&&S.length?`
`:"")+S})):m.push(x[0])}),g=m,l=zN.apply(this,[w,t])}for(s=0,o=g.length;s<o;s++){var y=0;if(i=g[s],l&&i[0]==`
`&&(i=i.substr(1),y=1),A+f+(p=(r=Ox.apply(this,[i,t])).reduce(function(x,S){return x+S},0))>e||y){if(p>e){for(a=QN.apply(this,[i,r,e-(A+f),e]),u.push(a.shift()),u=[a.pop()];a.length;)d.push([a.shift()]);p=r.slice(i.length-(u[0]?u[0].length:0)).reduce(function(x,S){return x+S},0)}else u=[i];d.push(u),A=p+l,f=v}else u.push(i),A+=f+p,f=v}return h=l?function(x,S){return(S?w:"")+x.join(" ")}:function(x){return x.join(" ")},d.map(h)},z0.splitTextToSize=function(n,e,t){var i,r=(t=t||{}).fontSize||this.internal.getFontSize(),s=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var d=this.internal.getFont(u.fontName,u.fontStyle),A="Unicode";return d.metadata[A]?{widths:d.metadata[A].widths||{0:1},kerning:d.metadata[A].kerning||{}}:{font:d.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);i=Array.isArray(n)?n:String(n).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/r;s.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/r:0,s.lineIndent=t.lineIndent;var a,l,h=[];for(a=0,l=i.length;a<l;a++)h=h.concat($N.apply(this,[i[a],o,s]));return h},(function(n){n.__fontmetrics__=n.__fontmetrics__||{};for(var e="0123456789abcdef",t="klmnopqrstuvwxyz",i={},r={},s=0;s<16;s++)i[t[s]]=e[s],r[e[s]]=t[s];var o=function(A){return"0x"+parseInt(A,10).toString(16)},a=n.__fontmetrics__.compress=function(A){var f,p,g,v,w=["{"];for(var m in A){if(f=A[m],isNaN(parseInt(m,10))?p="'"+m+"'":(m=parseInt(m,10),p=(p=o(m).slice(2)).slice(0,-1)+r[p.slice(-1)]),typeof f=="number")f<0?(g=o(f).slice(3),v="-"):(g=o(f).slice(2),v=""),g=v+g.slice(0,-1)+r[g.slice(-1)];else{if(go(f)!=="object")throw new Error("Don't know what to do with value type "+go(f)+".");g=a(f)}w.push(p+g)}return w.push("}"),w.join("")},l=n.__fontmetrics__.uncompress=function(A){if(typeof A!="string")throw new Error("Invalid argument passed to uncompress.");for(var f,p,g,v,w={},m=1,y=w,x=[],S="",I="",j=A.length-1,C=1;C<j;C+=1)(v=A[C])=="'"?f?(g=f.join(""),f=void 0):f=[]:f?f.push(v):v=="{"?(x.push([y,g]),y={},g=void 0):v=="}"?((p=x.pop())[0][p[1]]=y,g=void 0,y=p[0]):v=="-"?m=-1:g===void 0?i.hasOwnProperty(v)?(S+=i[v],g=parseInt(S,16)*m,m=1,S=""):S+=v:i.hasOwnProperty(v)?(I+=i[v],y[g]=parseInt(I,16)*m,m=1,g=void 0,I=""):I+=v;return w},h={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:h,"Courier-Bold":h,"Courier-BoldOblique":h,"Courier-Oblique":h,Helvetica:h,"Helvetica-Bold":h,"Helvetica-BoldOblique":h,"Helvetica-Oblique":h,"Times-Roman":h,"Times-Bold":h,"Times-BoldItalic":h,"Times-Italic":h}},d={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};n.events.push(["addFont",function(A){var f=A.font,p=d.Unicode[f.postScriptName];p&&(f.metadata.Unicode={},f.metadata.Unicode.widths=p.widths,f.metadata.Unicode.kerning=p.kerning);var g=u.Unicode[f.postScriptName];g&&(f.metadata.Unicode.encoding=g,f.encoding=g.codePages[0])}])})(qi.API),(function(n){var e=function(t){for(var i=t.length,r=new Uint8Array(i),s=0;s<i;s++)r[s]=t.charCodeAt(s);return r};n.API.events.push(["addFont",function(t){var i=void 0,r=t.font,s=t.instance;if(!r.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");if(typeof(i=s.existsFileInVFS(r.postScriptName)===!1?s.loadFile(r.postScriptName):s.getFileFromVFS(r.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");(function(o,a){a=/^\x00\x01\x00\x00/.test(a)?e(a):e(sC(a)),o.metadata=n.API.TTFFont.open(a),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(r,i)}}])})(qi),qi.API.addSvgAsImage=function(n,e,t,i,r,s,o,a){if(isNaN(e)||isNaN(t))throw Po.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(r))throw Po.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var l=document.createElement("canvas");l.width=i,l.height=r;var h=l.getContext("2d");h.fillStyle="#fff",h.fillRect(0,0,l.width,l.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},d=this;return(Lr.canvg?Promise.resolve(Lr.canvg):rl(()=>import("./index.es-Cctor2Sd.js"),__vite__mapDeps([5,1,2,3,4]))).catch(function(A){return Promise.reject(new Error("Could not load canvg: "+A))}).then(function(A){return A.default?A.default:A}).then(function(A){return A.fromString(h,n,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(A){return A.render(u)}).then(function(){d.addImage(l.toDataURL("image/jpeg",1),e,t,i,r,o,a)})},qi.API.putTotalPages=function(n){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(n,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(n,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var i=1;i<=this.internal.getNumberOfPages();i++)for(var r=0;r<this.internal.pages[i].length;r++)this.internal.pages[i][r]=this.internal.pages[i][r].replace(e,t);return this},qi.API.viewerPreferences=function(n,e){var t;n=n||{},e=e||!1;var i,r,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},a=Object.keys(o),l=[],h=0,u=0,d=0;function A(p,g){var v,w=!1;for(v=0;v<p.length;v+=1)p[v]===g&&(w=!0);return w}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,n==="reset"||e===!0){var f=a.length;for(d=0;d<f;d+=1)t[a[d]].value=t[a[d]].defaultValue,t[a[d]].explicitSet=!1}if(go(n)==="object"){for(r in n)if(s=n[r],A(a,r)&&s!==void 0){if(t[r].type==="boolean"&&typeof s=="boolean")t[r].value=s;else if(t[r].type==="name"&&A(t[r].valueSet,s))t[r].value=s;else if(t[r].type==="integer"&&Number.isInteger(s))t[r].value=s;else if(t[r].type==="array"){for(h=0;h<s.length;h+=1)if(i=!0,s[h].length===1&&typeof s[h][0]=="number")l.push(String(s[h]-1));else if(s[h].length>1){for(u=0;u<s[h].length;u+=1)typeof s[h][u]!="number"&&(i=!1);i===!0&&l.push([s[h][0]-1,s[h][1]-1].join(" "))}t[r].value="["+l.join(" ")+"]"}else t[r].value=t[r].defaultValue;t[r].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var p,g=[];for(p in t)t[p].explicitSet===!0&&(t[p].type==="name"?g.push("/"+p+" /"+t[p].value):g.push("/"+p+" "+t[p].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},(function(n){var e=function(){var i='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',r=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(i)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),a=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),h=s.length+o.length+a.length+r.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+h+" >>"),this.internal.write("stream"),this.internal.write(r+s+o+a+l),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};n.addMetadata=function(i,r){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:i,namespaceuri:r||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}})(qi.API),(function(n){var e=n.API,t=e.pdfEscape16=function(s,o){for(var a,l=o.metadata.Unicode.widths,h=["","0","00","000","0000"],u=[""],d=0,A=s.length;d<A;++d){if(a=o.metadata.characterToGlyph(s.charCodeAt(d)),o.metadata.glyIdsUsed.push(a),o.metadata.toUnicode[a]=s.charCodeAt(d),l.indexOf(a)==-1&&(l.push(a),l.push([parseInt(o.metadata.widthOfGlyph(a),10)])),a=="0")return u.join("");a=a.toString(16),u.push(h[4-a.length],a)}return u.join("")},i=function(s){var o,a,l,h,u,d,A;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],d=0,A=(a=Object.keys(s).sort(function(f,p){return f-p})).length;d<A;d++)o=a[d],l.length>=100&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(h=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),l.push("<"+o+"><"+h+">"));return l.length&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),u+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(o){var a=o.font,l=o.out,h=o.newObject,u=o.putStream;if(a.metadata instanceof n.API.TTFFont&&a.encoding==="Identity-H"){for(var d=a.metadata.Unicode.widths,A=a.metadata.subset.encode(a.metadata.glyIdsUsed,1),f="",p=0;p<A.length;p++)f+=String.fromCharCode(A[p]);var g=h();u({data:f,addLength1:!0,objectId:g}),l("endobj");var v=h();u({data:i(a.metadata.toUnicode),addLength1:!0,objectId:v}),l("endobj");var w=h();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+Am(a.fontName)),l("/FontFile2 "+g+" 0 R"),l("/FontBBox "+n.API.PDFObject.convert(a.metadata.bbox)),l("/Flags "+a.metadata.flags),l("/StemV "+a.metadata.stemV),l("/ItalicAngle "+a.metadata.italicAngle),l("/Ascent "+a.metadata.ascender),l("/Descent "+a.metadata.decender),l("/CapHeight "+a.metadata.capHeight),l(">>"),l("endobj");var m=h();l("<<"),l("/Type /Font"),l("/BaseFont /"+Am(a.fontName)),l("/FontDescriptor "+w+" 0 R"),l("/W "+n.API.PDFObject.convert(d)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+a.encoding+")"),l(">>"),l(">>"),l("endobj"),a.objectNumber=h(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+v+" 0 R"),l("/BaseFont /"+Am(a.fontName)),l("/Encoding /"+a.encoding),l("/DescendantFonts ["+m+" 0 R]"),l(">>"),l("endobj"),a.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(o){var a=o.font,l=o.out,h=o.newObject,u=o.putStream;if(a.metadata instanceof n.API.TTFFont&&a.encoding==="WinAnsiEncoding"){for(var d=a.metadata.rawData,A="",f=0;f<d.length;f++)A+=String.fromCharCode(d[f]);var p=h();u({data:A,addLength1:!0,objectId:p}),l("endobj");var g=h();u({data:i(a.metadata.toUnicode),addLength1:!0,objectId:g}),l("endobj");var v=h();l("<<"),l("/Descent "+a.metadata.decender),l("/CapHeight "+a.metadata.capHeight),l("/StemV "+a.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+p+" 0 R"),l("/Flags 96"),l("/FontBBox "+n.API.PDFObject.convert(a.metadata.bbox)),l("/FontName /"+Am(a.fontName)),l("/ItalicAngle "+a.metadata.italicAngle),l("/Ascent "+a.metadata.ascender),l(">>"),l("endobj"),a.objectNumber=h();for(var w=0;w<a.metadata.hmtx.widths.length;w++)a.metadata.hmtx.widths[w]=parseInt(a.metadata.hmtx.widths[w]*(1e3/a.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+Am(a.fontName)+"/FontDescriptor "+v+" 0 R/Encoding/"+a.encoding+" /FirstChar 29 /LastChar 255 /Widths "+n.API.PDFObject.convert(a.metadata.hmtx.widths)+">>"),l("endobj"),a.isAlreadyPutted=!0}})(s)}]);var r=function(s){var o,a=s.text||"",l=s.x,h=s.y,u=s.options||{},d=s.mutex||{},A=d.pdfEscape,f=d.activeFontKey,p=d.fonts,g=f,v="",w=0,m="",y=p[g].encoding;if(p[g].encoding!=="Identity-H")return{text:a,x:l,y:h,options:u,mutex:d};for(m=a,g=f,Array.isArray(a)&&(m=a[0]),w=0;w<m.length;w+=1)p[g].metadata.hasOwnProperty("cmap")&&(o=p[g].metadata.cmap.unicode.codeMap[m[w].charCodeAt(0)]),o||m[w].charCodeAt(0)<256&&p[g].metadata.hasOwnProperty("Unicode")?v+=m[w]:v+="";var x="";return parseInt(g.slice(1))<14||y==="WinAnsiEncoding"?x=A(v,g).split("").map(function(S){return S.charCodeAt(0).toString(16)}).join(""):y==="Identity-H"&&(x=t(v,p[g])),d.isHex=!0,{text:x,x:l,y:h,options:u,mutex:d}};e.events.push(["postProcessText",function(s){var o=s.text||"",a=[],l={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var h=0;for(h=0;h<o.length;h+=1)Array.isArray(o[h])&&o[h].length===3?a.push([r(Object.assign({},l,{text:o[h][0]})).text,o[h][1],o[h][2]]):a.push(r(Object.assign({},l,{text:o[h]})).text);s.text=a}else s.text=r(Object.assign({},l,{text:o})).text}])})(qi),(function(n){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};n.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},n.addFileToVFS=function(t,i){return e.call(this),this.internal.vFS[t]=i,this},n.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}})(qi.API),(function(n){n.__bidiEngine__=n.prototype.__bidiEngine__=function(i){var r,s,o,a,l,h,u,d=e,A=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],f=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],p={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},v=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],w=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),m=!1,y=0;this.__bidiEngine__={};var x=function(T){var k=T.charCodeAt(),B=k>>8,E=g[B];return E!==void 0?d[256*E+(255&k)]:B===252||B===253?"AL":w.test(B)?"L":B===8?"R":"N"},S=function(T){for(var k,B=0;B<T.length;B++){if((k=x(T.charAt(B)))==="L")return!1;if(k==="R")return!0}return!1},I=function(T,k,B,E){var z,te,L,O,J=k[E];switch(J){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":m=!1;break;case"N":case"AN":break;case"EN":m&&(J="AN");break;case"AL":m=!0,J="R";break;case"WS":case"BN":J="N";break;case"CS":E<1||E+1>=k.length||(z=B[E-1])!=="EN"&&z!=="AN"||(te=k[E+1])!=="EN"&&te!=="AN"?J="N":m&&(te="AN"),J=te===z?te:"N";break;case"ES":J=(z=E>0?B[E-1]:"B")==="EN"&&E+1<k.length&&k[E+1]==="EN"?"EN":"N";break;case"ET":if(E>0&&B[E-1]==="EN"){J="EN";break}if(m){J="N";break}for(L=E+1,O=k.length;L<O&&k[L]==="ET";)L++;J=L<O&&k[L]==="EN"?"EN":"N";break;case"NSM":if(o&&!a){for(O=k.length,L=E+1;L<O&&k[L]==="NSM";)L++;if(L<O){var $=T[E],U=$>=1425&&$<=2303||$===64286;if(z=k[L],U&&(z==="R"||z==="AL")){J="R";break}}}J=E<1||(z=k[E-1])==="B"?"N":B[E-1];break;case"B":m=!1,r=!0,J=y;break;case"S":s=!0,J="N"}return J},j=function(T,k,B){var E=T.split("");return B&&C(E,B,{hiLevel:y}),E.reverse(),k&&k.reverse(),E.join("")},C=function(T,k,B){var E,z,te,L,O,J=-1,$=T.length,U=0,Y=[],K=y?f:A,V=[];for(m=!1,r=!1,s=!1,z=0;z<$;z++)V[z]=x(T[z]);for(te=0;te<$;te++){if(O=U,Y[te]=I(T,V,Y,te),E=240&(U=K[O][p[Y[te]]]),U&=15,k[te]=L=K[U][5],E>0)if(E===16){for(z=J;z<te;z++)k[z]=1;J=-1}else J=-1;if(K[U][6])J===-1&&(J=te);else if(J>-1){for(z=J;z<te;z++)k[z]=L;J=-1}V[te]==="B"&&(k[te]=0),B.hiLevel|=L}s&&(function(Q,X,W){for(var se=0;se<W;se++)if(Q[se]==="S"){X[se]=y;for(var q=se-1;q>=0&&Q[q]==="WS";q--)X[q]=y}})(V,k,$)},b=function(T,k,B,E,z){if(!(z.hiLevel<T)){if(T===1&&y===1&&!r)return k.reverse(),void(B&&B.reverse());for(var te,L,O,J,$=k.length,U=0;U<$;){if(E[U]>=T){for(O=U+1;O<$&&E[O]>=T;)O++;for(J=U,L=O-1;J<L;J++,L--)te=k[J],k[J]=k[L],k[L]=te,B&&(te=B[J],B[J]=B[L],B[L]=te);U=O}U++}}},D=function(T,k,B){var E=T.split(""),z={hiLevel:y};return B||(B=[]),C(E,B,z),(function(te,L,O){if(O.hiLevel!==0&&u)for(var J,$=0;$<te.length;$++)L[$]===1&&(J=v.indexOf(te[$]))>=0&&(te[$]=v[J+1])})(E,B,z),b(2,E,k,B,z),b(1,E,k,B,z),E.join("")};return this.__bidiEngine__.doBidiReorder=function(T,k,B){if((function(z,te){if(te)for(var L=0;L<z.length;L++)te[L]=L;a===void 0&&(a=S(z)),h===void 0&&(h=S(z))})(T,k),o||!l||h)if(o&&l&&a^h)y=a?1:0,T=j(T,k,B);else if(!o&&l&&h)y=a?1:0,T=D(T,k,B),T=j(T,k);else if(!o||a||l||h){if(o&&!l&&a^h)T=j(T,k),a?(y=0,T=D(T,k,B)):(y=1,T=D(T,k,B),T=j(T,k));else if(o&&a&&!l&&h)y=1,T=D(T,k,B),T=j(T,k);else if(!o&&!l&&a^h){var E=u;a?(y=1,T=D(T,k,B),y=0,u=!1,T=D(T,k,B),u=E):(y=0,T=D(T,k,B),T=j(T,k),y=1,u=!1,T=D(T,k,B),u=E,T=j(T,k))}}else y=0,T=D(T,k,B);else y=a?1:0,T=D(T,k,B);return T},this.__bidiEngine__.setOptions=function(T){T&&(o=T.isInputVisual,l=T.isOutputVisual,a=T.isInputRtl,h=T.isOutputRtl,u=T.isSymmetricSwapping)},this.__bidiEngine__.setOptions(i),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new n.__bidiEngine__({isInputVisual:!0});n.API.events.push(["postProcessText",function(i){var r=i.text;i.x,i.y;var s=i.options||{};i.mutex,s.lang;var o=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,t.setOptions(s),Object.prototype.toString.call(r)==="[object Array]"){var a=0;for(o=[],a=0;a<r.length;a+=1)Object.prototype.toString.call(r[a])==="[object Array]"?o.push([t.doBidiReorder(r[a][0]),r[a][1],r[a][2]]):o.push([t.doBidiReorder(r[a])]);i.text=o}else i.text=t.doBidiReorder(r);t.setOptions({isInputVisual:!0})}])})(qi),qi.API.TTFFont=(function(){function n(e){var t;if(this.rawData=e,t=this.contents=new Op(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new Lge(this),this.registerTTF()}return n.open=function(e){return new n(e)},n.prototype.parse=function(){return this.directory=new bge(this.contents),this.head=new _ge(this),this.name=new Fge(this),this.cmap=new R$(this),this.toUnicode={},this.hhea=new Sge(this),this.maxp=new kge(this),this.hmtx=new Ige(this),this.post=new Bge(this),this.os2=new Tge(this),this.loca=new Nge(this),this.glyf=new Dge(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},n.prototype.registerTTF=function(){var e,t,i,r,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,a,l,h;for(h=[],o=0,a=(l=this.bbox).length;o<a;o++)e=l[o],h.push(Math.round(e*this.scaleFactor));return h}).call(this),this.stemV=0,this.post.exists?(i=255&(r=this.post.italic_angle),32768&(t=r>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+i)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},n.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},n.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},n.prototype.widthOfString=function(e,t,i){var r,s,o,a;for(o=0,s=0,a=(e=""+e).length;0<=a?s<a:s>a;s=0<=a?++s:--s)r=e.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(r))+i*(1e3/t)||0;return o*(t/1e3)},n.prototype.lineHeight=function(e,t){var i;return t==null&&(t=!1),i=t?this.lineGap:0,(this.ascender+i-this.decender)/1e3*e},n})();var Pd,Op=(function(){function n(e){this.data=e??[],this.pos=0,this.length=this.data.length}return n.prototype.readByte=function(){return this.data[this.pos++]},n.prototype.writeByte=function(e){return this.data[this.pos++]=e},n.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},n.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},n.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},n.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},n.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},n.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},n.prototype.readString=function(e){var t,i;for(i=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)i[t]=String.fromCharCode(this.readByte());return i.join("")},n.prototype.writeString=function(e){var t,i,r;for(r=[],t=0,i=e.length;0<=i?t<i:t>i;t=0<=i?++t:--t)r.push(this.writeByte(e.charCodeAt(t)));return r},n.prototype.readShort=function(){return this.readInt16()},n.prototype.writeShort=function(e){return this.writeInt16(e)},n.prototype.readLongLong=function(){var e,t,i,r,s,o,a,l;return e=this.readByte(),t=this.readByte(),i=this.readByte(),r=this.readByte(),s=this.readByte(),o=this.readByte(),a=this.readByte(),l=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^i)+4294967296*(255^r)+16777216*(255^s)+65536*(255^o)+256*(255^a)+(255^l)+1):72057594037927940*e+281474976710656*t+1099511627776*i+4294967296*r+16777216*s+65536*o+256*a+l},n.prototype.writeLongLong=function(e){var t,i;return t=Math.floor(e/4294967296),i=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(i>>24&255),this.writeByte(i>>16&255),this.writeByte(i>>8&255),this.writeByte(255&i)},n.prototype.readInt=function(){return this.readInt32()},n.prototype.writeInt=function(e){return this.writeInt32(e)},n.prototype.read=function(e){var t,i;for(t=[],i=0;0<=e?i<e:i>e;i=0<=e?++i:--i)t.push(this.readByte());return t},n.prototype.write=function(e){var t,i,r,s;for(s=[],i=0,r=e.length;i<r;i++)t=e[i],s.push(this.writeByte(t));return s},n})(),bge=(function(){var n;function e(t){var i,r,s;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},r=0,s=this.tableCount;0<=s?r<s:r>s;r=0<=s?++r:--r)i={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[i.tag]=i}return e.prototype.encode=function(t){var i,r,s,o,a,l,h,u,d,A,f,p,g;for(g in f=Object.keys(t).length,l=Math.log(2),d=16*Math.floor(Math.log(f)/l),o=Math.floor(d/l),u=16*f-d,(r=new Op).writeInt(this.scalarType),r.writeShort(f),r.writeShort(d),r.writeShort(o),r.writeShort(u),s=16*f,h=r.pos+s,a=null,p=[],t)for(A=t[g],r.writeString(g),r.writeInt(n(A)),r.writeInt(h),r.writeInt(A.length),p=p.concat(A),g==="head"&&(a=h),h+=A.length;h%4;)p.push(0),h++;return r.write(p),i=2981146554-n(r.data),r.pos=a+8,r.writeUInt32(i),r.data},n=function(t){var i,r,s,o;for(t=U$.call(t);t.length%4;)t.push(0);for(s=new Op(t),r=0,i=0,o=t.length;i<o;i=i+=4)r+=s.readUInt32();return 4294967295&r},e})(),Cge={}.hasOwnProperty,bA=function(n,e){for(var t in e)Cge.call(e,t)&&(n[t]=e[t]);function i(){this.constructor=n}return i.prototype=e.prototype,n.prototype=new i,n.__super__=e.prototype,n};Pd=(function(){function n(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return n.prototype.parse=function(){},n.prototype.encode=function(){},n.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},n})();var _ge=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bA(n,Pd),n.prototype.tag="head",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},n.prototype.encode=function(e){var t;return(t=new Op).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},n})(),eL=(function(){function n(e,t){var i,r,s,o,a,l,h,u,d,A,f,p,g,v,w,m,y;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),d=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=e.readByte();break;case 4:for(f=e.readUInt16(),A=f/2,e.pos+=6,s=(function(){var x,S;for(S=[],l=x=0;0<=A?x<A:x>A;l=0<=A?++x:--x)S.push(e.readUInt16());return S})(),e.pos+=2,g=(function(){var x,S;for(S=[],l=x=0;0<=A?x<A:x>A;l=0<=A?++x:--x)S.push(e.readUInt16());return S})(),h=(function(){var x,S;for(S=[],l=x=0;0<=A?x<A:x>A;l=0<=A?++x:--x)S.push(e.readUInt16());return S})(),u=(function(){var x,S;for(S=[],l=x=0;0<=A?x<A:x>A;l=0<=A?++x:--x)S.push(e.readUInt16());return S})(),r=(this.length-e.pos+this.offset)/2,a=(function(){var x,S;for(S=[],l=x=0;0<=r?x<r:x>r;l=0<=r?++x:--x)S.push(e.readUInt16());return S})(),l=w=0,y=s.length;w<y;l=++w)for(v=s[l],i=m=p=g[l];p<=v?m<=v:m>=v;i=p<=v?++m:--m)u[l]===0?o=i+h[l]:(o=a[u[l]/2+(i-p)-(A-l)]||0)!==0&&(o+=h[l]),this.codeMap[i]=65535&o}e.pos=d}return n.encode=function(e,t){var i,r,s,o,a,l,h,u,d,A,f,p,g,v,w,m,y,x,S,I,j,C,b,D,T,k,B,E,z,te,L,O,J,$,U,Y,K,V,Q,X,W,se,q,de,Ce,Se;switch(E=new Op,o=Object.keys(e).sort(function(fe,M){return fe-M}),t){case"macroman":for(g=0,v=(function(){var fe=[];for(p=0;p<256;++p)fe.push(0);return fe})(),m={0:0},s={},z=0,J=o.length;z<J;z++)m[q=e[r=o[z]]]==null&&(m[q]=++g),s[r]={old:e[r],new:m[e[r]]},v[r]=m[e[r]];return E.writeUInt16(1),E.writeUInt16(0),E.writeUInt32(12),E.writeUInt16(0),E.writeUInt16(262),E.writeUInt16(0),E.write(v),{charMap:s,subtable:E.data,maxGlyphID:g+1};case"unicode":for(k=[],d=[],y=0,m={},i={},w=h=null,te=0,$=o.length;te<$;te++)m[S=e[r=o[te]]]==null&&(m[S]=++y),i[r]={old:S,new:m[S]},a=m[S]-r,w!=null&&a===h||(w&&d.push(w),k.push(r),h=a),w=r;for(w&&d.push(w),d.push(65535),k.push(65535),D=2*(b=k.length),C=2*Math.pow(Math.log(b)/Math.LN2,2),A=Math.log(C/2)/Math.LN2,j=2*b-C,l=[],I=[],f=[],p=L=0,U=k.length;L<U;p=++L){if(T=k[p],u=d[p],T===65535){l.push(0),I.push(0);break}if(T-(B=i[T].new)>=32768)for(l.push(0),I.push(2*(f.length+b-p)),r=O=T;T<=u?O<=u:O>=u;r=T<=u?++O:--O)f.push(i[r].new);else l.push(B-T),I.push(0)}for(E.writeUInt16(3),E.writeUInt16(1),E.writeUInt32(12),E.writeUInt16(4),E.writeUInt16(16+8*b+2*f.length),E.writeUInt16(0),E.writeUInt16(D),E.writeUInt16(C),E.writeUInt16(A),E.writeUInt16(j),W=0,Y=d.length;W<Y;W++)r=d[W],E.writeUInt16(r);for(E.writeUInt16(0),se=0,K=k.length;se<K;se++)r=k[se],E.writeUInt16(r);for(de=0,V=l.length;de<V;de++)a=l[de],E.writeUInt16(a);for(Ce=0,Q=I.length;Ce<Q;Ce++)x=I[Ce],E.writeUInt16(x);for(Se=0,X=f.length;Se<X;Se++)g=f[Se],E.writeUInt16(g);return{charMap:i,subtable:E.data,maxGlyphID:y+1}}},n})(),R$=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bA(n,Pd),n.prototype.tag="cmap",n.prototype.parse=function(e){var t,i,r;for(e.pos=this.offset,this.version=e.readUInt16(),r=e.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=r?i<r:i>r;i=0<=r?++i:--i)t=new eL(e,this.offset),this.tables.push(t),t.isUnicode&&this.unicode==null&&(this.unicode=t);return!0},n.encode=function(e,t){var i,r;return t==null&&(t="macroman"),i=eL.encode(e,t),(r=new Op).writeUInt16(0),r.writeUInt16(1),i.table=r.data.concat(i.subtable),i},n})(),Sge=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bA(n,Pd),n.prototype.tag="hhea",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},n})(),Tge=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bA(n,Pd),n.prototype.tag="OS/2",n.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var t,i;for(i=[],t=0;t<10;++t)i.push(e.readByte());return i})(),this.charRange=(function(){var t,i;for(i=[],t=0;t<4;++t)i.push(e.readInt());return i})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var t,i;for(i=[],t=0;t<2;t=++t)i.push(e.readInt());return i})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},n})(),Bge=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bA(n,Pd),n.prototype.tag="post",n.prototype.parse=function(e){var t,i,r;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(i=e.readUInt16(),this.glyphNameIndex=[],s=0;0<=i?s<i:s>i;s=0<=i?++s:--s)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],r=[];e.pos<this.offset+this.length;)t=e.readByte(),r.push(this.names.push(e.readString(t)));return r;case 151552:return i=e.readUInt16(),this.offsets=e.read(i);case 262144:return this.map=(function(){var o,a,l;for(l=[],s=o=0,a=this.file.maxp.numGlyphs;0<=a?o<a:o>a;s=0<=a?++o:--o)l.push(e.readUInt32());return l}).call(this)}},n})(),Ege=function(n,e){this.raw=n,this.length=n.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},Fge=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bA(n,Pd),n.prototype.tag="name",n.prototype.parse=function(e){var t,i,r,s,o,a,l,h,u,d,A;for(e.pos=this.offset,e.readShort(),t=e.readShort(),a=e.readShort(),i=[],s=0;0<=t?s<t:s>t;s=0<=t?++s:--s)i.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+a+e.readShort()});for(l={},s=u=0,d=i.length;u<d;s=++u)r=i[s],e.pos=r.offset,h=e.readString(r.length),o=new Ege(h,r),l[A=r.nameID]==null&&(l[A]=[]),l[r.nameID].push(o);this.strings=l,this.copyright=l[0],this.fontFamily=l[1],this.fontSubfamily=l[2],this.uniqueSubfamily=l[3],this.fontName=l[4],this.version=l[5];try{this.postscriptName=l[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=l[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=l[7],this.manufacturer=l[8],this.designer=l[9],this.description=l[10],this.vendorUrl=l[11],this.designerUrl=l[12],this.license=l[13],this.licenseUrl=l[14],this.preferredFamily=l[15],this.preferredSubfamily=l[17],this.compatibleFull=l[18],this.sampleText=l[19]},n})(),kge=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bA(n,Pd),n.prototype.tag="maxp",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},n})(),Ige=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bA(n,Pd),n.prototype.tag="hmtx",n.prototype.parse=function(e){var t,i,r,s,o,a,l;for(e.pos=this.offset,this.metrics=[],t=0,a=this.file.hhea.numberOfMetrics;0<=a?t<a:t>a;t=0<=a?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(r=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var h,u;for(u=[],t=h=0;0<=r?h<r:h>r;t=0<=r?++h:--h)u.push(e.readInt16());return u})(),this.widths=(function(){var h,u,d,A;for(A=[],h=0,u=(d=this.metrics).length;h<u;h++)s=d[h],A.push(s.advance);return A}).call(this),i=this.widths[this.widths.length-1],l=[],t=o=0;0<=r?o<r:o>r;t=0<=r?++o:--o)l.push(this.widths.push(i));return l},n.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},n})(),U$=[].slice,Dge=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bA(n,Pd),n.prototype.tag="glyf",n.prototype.parse=function(){return this.cache={}},n.prototype.glyphFor=function(e){var t,i,r,s,o,a,l,h,u,d;return e in this.cache?this.cache[e]:(s=this.file.loca,t=this.file.contents,i=s.indexOf(e),(r=s.lengthOf(e))===0?this.cache[e]=null:(t.pos=this.offset+i,o=(a=new Op(t.read(r))).readShort(),h=a.readShort(),d=a.readShort(),l=a.readShort(),u=a.readShort(),this.cache[e]=o===-1?new Pge(a,h,d,l,u):new jge(a,o,h,d,l,u),this.cache[e]))},n.prototype.encode=function(e,t,i){var r,s,o,a,l;for(o=[],s=[],a=0,l=t.length;a<l;a++)r=e[t[a]],s.push(o.length),r&&(o=o.concat(r.encode(i)));return s.push(o.length),{table:o,offsets:s}},n})(),jge=(function(){function n(e,t,i,r,s,o){this.raw=e,this.numberOfContours=t,this.xMin=i,this.yMin=r,this.xMax=s,this.yMax=o,this.compound=!1}return n.prototype.encode=function(){return this.raw.data},n})(),Pge=(function(){function n(e,t,i,r,s){var o,a;for(this.raw=e,this.xMin=t,this.yMin=i,this.xMax=r,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;a=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&a;)o.pos+=1&a?4:2,128&a?o.pos+=8:64&a?o.pos+=4:8&a&&(o.pos+=2)}return n.prototype.encode=function(){var e,t,i;for(t=new Op(U$.call(this.raw.data)),e=0,i=this.glyphIDs.length;e<i;++e)t.pos=this.glyphOffsets[e];return t.data},n})(),Nge=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return bA(n,Pd),n.prototype.tag="loca",n.prototype.parse=function(e){var t,i;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=t===0?(function(){var r,s;for(s=[],i=0,r=this.length;i<r;i+=2)s.push(2*e.readUInt16());return s}).call(this):(function(){var r,s;for(s=[],i=0,r=this.length;i<r;i+=4)s.push(e.readUInt32());return s}).call(this)},n.prototype.indexOf=function(e){return this.offsets[e]},n.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},n.prototype.encode=function(e,t){for(var i=new Uint32Array(this.offsets.length),r=0,s=0,o=0;o<i.length;++o)if(i[o]=r,s<t.length&&t[s]==o){++s,i[o]=r;var a=this.offsets[o],l=this.offsets[o+1]-a;l>0&&(r+=l)}for(var h=new Array(4*i.length),u=0;u<i.length;++u)h[4*u+3]=255&i[u],h[4*u+2]=(65280&i[u])>>8,h[4*u+1]=(16711680&i[u])>>16,h[4*u]=(4278190080&i[u])>>24;return h},n})(),Lge=(function(){function n(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return n.prototype.generateCmap=function(){var e,t,i,r,s;for(t in r=this.font.cmap.tables[0].codeMap,e={},s=this.subset)i=s[t],e[t]=r[i];return e},n.prototype.glyphsFor=function(e){var t,i,r,s,o,a,l;for(r={},o=0,a=e.length;o<a;o++)r[s=e[o]]=this.font.glyf.glyphFor(s);for(s in t=[],r)(i=r[s])!=null&&i.compound&&t.push.apply(t,i.glyphIDs);if(t.length>0)for(s in l=this.glyphsFor(t))i=l[s],r[s]=i;return r},n.prototype.encode=function(e,t){var i,r,s,o,a,l,h,u,d,A,f,p,g,v,w;for(r in i=R$.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),f={0:0},w=i.charMap)f[(l=w[r]).old]=l.new;for(p in A=i.maxGlyphID,o)p in f||(f[p]=A++);return u=(function(m){var y,x;for(y in x={},m)x[m[y]]=y;return x})(f),d=Object.keys(u).sort(function(m,y){return m-y}),g=(function(){var m,y,x;for(x=[],m=0,y=d.length;m<y;m++)a=d[m],x.push(u[a]);return x})(),s=this.font.glyf.encode(o,g,f),h=this.font.loca.encode(s.offsets,g),v={cmap:this.font.cmap.raw(),glyf:s.table,loca:h,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(v["OS/2"]=this.font.os2.raw()),this.font.directory.encode(v)},n})();qi.API.PDFObject=(function(){var n;function e(){}return n=function(t,i){return(Array(i+1).join("0")+t).slice(-i)},e.convert=function(t){var i,r,s,o;if(Array.isArray(t))return"["+(function(){var a,l,h;for(h=[],a=0,l=t.length;a<l;a++)i=t[a],h.push(e.convert(i));return h})().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t!=null&&t.isString)return"("+t+")";if(t instanceof Date)return"(D:"+n(t.getUTCFullYear(),4)+n(t.getUTCMonth(),2)+n(t.getUTCDate(),2)+n(t.getUTCHours(),2)+n(t.getUTCMinutes(),2)+n(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(r in s=["<<"],t)o=t[r],s.push("/"+r+" "+e.convert(o));return s.push(">>"),s.join(`
`)}return""+t},e})();/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var OE=function(n,e){return OE=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},OE(n,e)};function Nd(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");OE(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var HE=function(){return HE=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++){t=arguments[i];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},HE.apply(this,arguments)};function ih(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{h(i.next(u))}catch(d){o(d)}}function l(u){try{h(i.throw(u))}catch(d){o(d)}}function h(u){u.done?s(u.value):r(u.value).then(a,l)}h((i=i.apply(n,[])).next())})}function Rc(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,r,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(h){return function(u){return l([h,u])}}function l(h){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,r&&(s=h[0]&2?r.return:h[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,h[1])).done)return s;switch(r=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return t.label++,{value:h[1],done:!1};case 5:t.label++,r=h[1],h=[0];continue;case 7:h=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){t=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){t.label=h[1];break}if(h[0]===6&&t.label<s[1]){t.label=s[1],s=h;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(h);break}s[2]&&t.ops.pop(),t.trys.pop();continue}h=e.call(n,t)}catch(u){h=[6,u],r=0}finally{i=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function Hx(n,e,t){if(arguments.length===2)for(var i=0,r=e.length,s;i<r;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return n.concat(s||e)}var _f=(function(){function n(e,t,i,r){this.left=e,this.top=t,this.width=i,this.height=r}return n.prototype.add=function(e,t,i,r){return new n(this.left+e,this.top+t,this.width+i,this.height+r)},n.fromClientRect=function(e,t){return new n(t.left+e.windowBounds.left,t.top+e.windowBounds.top,t.width,t.height)},n.fromDOMRectList=function(e,t){var i=Array.from(t).find(function(r){return r.width!==0});return i?new n(i.left+e.windowBounds.left,i.top+e.windowBounds.top,i.width,i.height):n.EMPTY},n.EMPTY=new n(0,0,0,0),n})(),z5=function(n,e){return _f.fromClientRect(n,e.getBoundingClientRect())},Mge=function(n){var e=n.body,t=n.documentElement;if(!e||!t)throw new Error("Unable to get document size");var i=Math.max(Math.max(e.scrollWidth,t.scrollWidth),Math.max(e.offsetWidth,t.offsetWidth),Math.max(e.clientWidth,t.clientWidth)),r=Math.max(Math.max(e.scrollHeight,t.scrollHeight),Math.max(e.offsetHeight,t.offsetHeight),Math.max(e.clientHeight,t.clientHeight));return new _f(0,0,i,r)},Q5=function(n){for(var e=[],t=0,i=n.length;t<i;){var r=n.charCodeAt(t++);if(r>=55296&&r<=56319&&t<i){var s=n.charCodeAt(t++);(s&64512)===56320?e.push(((r&1023)<<10)+(s&1023)+65536):(e.push(r),t--)}else e.push(r)}return e},tl=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,n);var t=n.length;if(!t)return"";for(var i=[],r=-1,s="";++r<t;){var o=n[r];o<=65535?i.push(o):(o-=65536,i.push((o>>10)+55296,o%1024+56320)),(r+1===t||i.length>16384)&&(s+=String.fromCharCode.apply(String,i),i.length=0)}return s},tL="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Rge=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Wx=0;Wx<tL.length;Wx++)Rge[tL.charCodeAt(Wx)]=Wx;var nL="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",wy=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var zx=0;zx<nL.length;zx++)wy[nL.charCodeAt(zx)]=zx;var Uge=function(n){var e=n.length*.75,t=n.length,i,r=0,s,o,a,l;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);var h=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),u=Array.isArray(h)?h:new Uint8Array(h);for(i=0;i<t;i+=4)s=wy[n.charCodeAt(i)],o=wy[n.charCodeAt(i+1)],a=wy[n.charCodeAt(i+2)],l=wy[n.charCodeAt(i+3)],u[r++]=s<<2|o>>4,u[r++]=(o&15)<<4|a>>2,u[r++]=(a&3)<<6|l&63;return h},Oge=function(n){for(var e=n.length,t=[],i=0;i<e;i+=2)t.push(n[i+1]<<8|n[i]);return t},Hge=function(n){for(var e=n.length,t=[],i=0;i<e;i+=4)t.push(n[i+3]<<24|n[i+2]<<16|n[i+1]<<8|n[i]);return t},Vg=5,Gk=11,c4=2,Wge=Gk-Vg,O$=65536>>Vg,zge=1<<Vg,h4=zge-1,Qge=1024>>Vg,$ge=O$+Qge,Vge=$ge,Gge=32,Xge=Vge+Gge,Yge=65536>>Gk,Kge=1<<Wge,qge=Kge-1,iL=function(n,e,t){return n.slice?n.slice(e,t):new Uint16Array(Array.prototype.slice.call(n,e,t))},Zge=function(n,e,t){return n.slice?n.slice(e,t):new Uint32Array(Array.prototype.slice.call(n,e,t))},Jge=function(n,e){var t=Uge(n),i=Array.isArray(t)?Hge(t):new Uint32Array(t),r=Array.isArray(t)?Oge(t):new Uint16Array(t),s=24,o=iL(r,s/2,i[4]/2),a=i[5]===2?iL(r,(s+i[4])/2):Zge(i,Math.ceil((s+i[4])/4));return new e0e(i[0],i[1],i[2],i[3],o,a)},e0e=(function(){function n(e,t,i,r,s,o){this.initialValue=e,this.errorValue=t,this.highStart=i,this.highValueIndex=r,this.index=s,this.data=o}return n.prototype.get=function(e){var t;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=this.index[e>>Vg],t=(t<<c4)+(e&h4),this.data[t];if(e<=65535)return t=this.index[O$+(e-55296>>Vg)],t=(t<<c4)+(e&h4),this.data[t];if(e<this.highStart)return t=Xge-Yge+(e>>Gk),t=this.index[t],t+=e>>Vg&qge,t=this.index[t],t=(t<<c4)+(e&h4),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},n})(),rL="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t0e=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Qx=0;Qx<rL.length;Qx++)t0e[rL.charCodeAt(Qx)]=Qx;var n0e="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",sL=50,i0e=1,H$=2,W$=3,r0e=4,s0e=5,oL=7,z$=8,aL=9,vp=10,WE=11,lL=12,zE=13,o0e=14,vy=15,QE=16,$x=17,A2=18,a0e=19,cL=20,$E=21,f2=22,u4=23,Q0=24,Qh=25,xy=26,by=27,$0=28,l0e=29,Fg=30,c0e=31,Vx=32,Gx=33,VE=34,GE=35,XE=36,Mw=37,YE=38,hC=39,uC=40,d4=41,Q$=42,h0e=43,u0e=[9001,65288],$$="!",ks="×",Xx="÷",KE=Jge(n0e),zA=[Fg,XE],qE=[i0e,H$,W$,s0e],V$=[vp,z$],hL=[by,xy],d0e=qE.concat(V$),uL=[YE,hC,uC,VE,GE],A0e=[vy,zE],f0e=function(n,e){e===void 0&&(e="strict");var t=[],i=[],r=[];return n.forEach(function(s,o){var a=KE.get(s);if(a>sL?(r.push(!0),a-=sL):r.push(!1),["normal","auto","loose"].indexOf(e)!==-1&&[8208,8211,12316,12448].indexOf(s)!==-1)return i.push(o),t.push(QE);if(a===r0e||a===WE){if(o===0)return i.push(o),t.push(Fg);var l=t[o-1];return d0e.indexOf(l)===-1?(i.push(i[o-1]),t.push(l)):(i.push(o),t.push(Fg))}if(i.push(o),a===c0e)return t.push(e==="strict"?$E:Mw);if(a===Q$||a===l0e)return t.push(Fg);if(a===h0e)return s>=131072&&s<=196605||s>=196608&&s<=262141?t.push(Mw):t.push(Fg);t.push(a)}),[i,t,r]},A4=function(n,e,t,i){var r=i[t];if(Array.isArray(n)?n.indexOf(r)!==-1:n===r)for(var s=t;s<=i.length;){s++;var o=i[s];if(o===e)return!0;if(o!==vp)break}if(r===vp)for(var s=t;s>0;){s--;var a=i[s];if(Array.isArray(n)?n.indexOf(a)!==-1:n===a)for(var l=t;l<=i.length;){l++;var o=i[l];if(o===e)return!0;if(o!==vp)break}if(a!==vp)break}return!1},dL=function(n,e){for(var t=n;t>=0;){var i=e[t];if(i===vp)t--;else return i}return 0},p0e=function(n,e,t,i,r){if(t[i]===0)return ks;var s=i-1;if(Array.isArray(r)&&r[s]===!0)return ks;var o=s-1,a=s+1,l=e[s],h=o>=0?e[o]:0,u=e[a];if(l===H$&&u===W$)return ks;if(qE.indexOf(l)!==-1)return $$;if(qE.indexOf(u)!==-1||V$.indexOf(u)!==-1)return ks;if(dL(s,e)===z$)return Xx;if(KE.get(n[s])===WE||(l===Vx||l===Gx)&&KE.get(n[a])===WE||l===oL||u===oL||l===aL||[vp,zE,vy].indexOf(l)===-1&&u===aL||[$x,A2,a0e,Q0,$0].indexOf(u)!==-1||dL(s,e)===f2||A4(u4,f2,s,e)||A4([$x,A2],$E,s,e)||A4(lL,lL,s,e))return ks;if(l===vp)return Xx;if(l===u4||u===u4)return ks;if(u===QE||l===QE)return Xx;if([zE,vy,$E].indexOf(u)!==-1||l===o0e||h===XE&&A0e.indexOf(l)!==-1||l===$0&&u===XE||u===cL||zA.indexOf(u)!==-1&&l===Qh||zA.indexOf(l)!==-1&&u===Qh||l===by&&[Mw,Vx,Gx].indexOf(u)!==-1||[Mw,Vx,Gx].indexOf(l)!==-1&&u===xy||zA.indexOf(l)!==-1&&hL.indexOf(u)!==-1||hL.indexOf(l)!==-1&&zA.indexOf(u)!==-1||[by,xy].indexOf(l)!==-1&&(u===Qh||[f2,vy].indexOf(u)!==-1&&e[a+1]===Qh)||[f2,vy].indexOf(l)!==-1&&u===Qh||l===Qh&&[Qh,$0,Q0].indexOf(u)!==-1)return ks;if([Qh,$0,Q0,$x,A2].indexOf(u)!==-1)for(var d=s;d>=0;){var A=e[d];if(A===Qh)return ks;if([$0,Q0].indexOf(A)!==-1)d--;else break}if([by,xy].indexOf(u)!==-1)for(var d=[$x,A2].indexOf(l)!==-1?o:s;d>=0;){var A=e[d];if(A===Qh)return ks;if([$0,Q0].indexOf(A)!==-1)d--;else break}if(YE===l&&[YE,hC,VE,GE].indexOf(u)!==-1||[hC,VE].indexOf(l)!==-1&&[hC,uC].indexOf(u)!==-1||[uC,GE].indexOf(l)!==-1&&u===uC||uL.indexOf(l)!==-1&&[cL,xy].indexOf(u)!==-1||uL.indexOf(u)!==-1&&l===by||zA.indexOf(l)!==-1&&zA.indexOf(u)!==-1||l===Q0&&zA.indexOf(u)!==-1||zA.concat(Qh).indexOf(l)!==-1&&u===f2&&u0e.indexOf(n[a])===-1||zA.concat(Qh).indexOf(u)!==-1&&l===A2)return ks;if(l===d4&&u===d4){for(var f=t[s],p=1;f>0&&(f--,e[f]===d4);)p++;if(p%2!==0)return ks}return l===Vx&&u===Gx?ks:Xx},g0e=function(n,e){e||(e={lineBreak:"normal",wordBreak:"normal"});var t=f0e(n,e.lineBreak),i=t[0],r=t[1],s=t[2];(e.wordBreak==="break-all"||e.wordBreak==="break-word")&&(r=r.map(function(a){return[Qh,Fg,Q$].indexOf(a)!==-1?Mw:a}));var o=e.wordBreak==="keep-all"?s.map(function(a,l){return a&&n[l]>=19968&&n[l]<=40959}):void 0;return[i,r,o]},m0e=(function(){function n(e,t,i,r){this.codePoints=e,this.required=t===$$,this.start=i,this.end=r}return n.prototype.slice=function(){return tl.apply(void 0,this.codePoints.slice(this.start,this.end))},n})(),y0e=function(n,e){var t=Q5(n),i=g0e(t,e),r=i[0],s=i[1],o=i[2],a=t.length,l=0,h=0;return{next:function(){if(h>=a)return{done:!0,value:null};for(var u=ks;h<a&&(u=p0e(t,s,r,++h,o))===ks;);if(u!==ks||h===a){var d=new m0e(t,u,l,h);return l=h,{value:d,done:!1}}return{done:!0,value:null}}}},w0e=1,v0e=2,Cv=4,AL=8,A_=10,fL=47,tw=92,x0e=9,b0e=32,Yx=34,p2=61,C0e=35,_0e=36,S0e=37,Kx=39,qx=40,g2=41,T0e=95,Fh=45,B0e=33,E0e=60,F0e=62,k0e=64,I0e=91,D0e=93,j0e=61,P0e=123,Zx=63,N0e=125,pL=124,L0e=126,M0e=128,gL=65533,f4=42,Lg=43,R0e=44,U0e=58,O0e=59,Rw=46,H0e=0,W0e=8,z0e=11,Q0e=14,$0e=31,V0e=127,zd=-1,G$=48,X$=97,Y$=101,G0e=102,X0e=117,Y0e=122,K$=65,q$=69,Z$=70,K0e=85,q0e=90,Wc=function(n){return n>=G$&&n<=57},Z0e=function(n){return n>=55296&&n<=57343},V0=function(n){return Wc(n)||n>=K$&&n<=Z$||n>=X$&&n<=G0e},J0e=function(n){return n>=X$&&n<=Y0e},eme=function(n){return n>=K$&&n<=q0e},tme=function(n){return J0e(n)||eme(n)},nme=function(n){return n>=M0e},Jx=function(n){return n===A_||n===x0e||n===b0e},f_=function(n){return tme(n)||nme(n)||n===T0e},mL=function(n){return f_(n)||Wc(n)||n===Fh},ime=function(n){return n>=H0e&&n<=W0e||n===z0e||n>=Q0e&&n<=$0e||n===V0e},lp=function(n,e){return n!==tw?!1:e!==A_},eb=function(n,e,t){return n===Fh?f_(e)||lp(e,t):f_(n)?!0:!!(n===tw&&lp(n,e))},p4=function(n,e,t){return n===Lg||n===Fh?Wc(e)?!0:e===Rw&&Wc(t):Wc(n===Rw?e:n)},rme=function(n){var e=0,t=1;(n[e]===Lg||n[e]===Fh)&&(n[e]===Fh&&(t=-1),e++);for(var i=[];Wc(n[e]);)i.push(n[e++]);var r=i.length?parseInt(tl.apply(void 0,i),10):0;n[e]===Rw&&e++;for(var s=[];Wc(n[e]);)s.push(n[e++]);var o=s.length,a=o?parseInt(tl.apply(void 0,s),10):0;(n[e]===q$||n[e]===Y$)&&e++;var l=1;(n[e]===Lg||n[e]===Fh)&&(n[e]===Fh&&(l=-1),e++);for(var h=[];Wc(n[e]);)h.push(n[e++]);var u=h.length?parseInt(tl.apply(void 0,h),10):0;return t*(r+a*Math.pow(10,-o))*Math.pow(10,l*u)},sme={type:2},ome={type:3},ame={type:4},lme={type:13},cme={type:8},hme={type:21},ume={type:9},dme={type:10},Ame={type:11},fme={type:12},pme={type:14},tb={type:23},gme={type:1},mme={type:25},yme={type:24},wme={type:26},vme={type:27},xme={type:28},bme={type:29},Cme={type:31},ZE={type:32},J$=(function(){function n(){this._value=[]}return n.prototype.write=function(e){this._value=this._value.concat(Q5(e))},n.prototype.read=function(){for(var e=[],t=this.consumeToken();t!==ZE;)e.push(t),t=this.consumeToken();return e},n.prototype.consumeToken=function(){var e=this.consumeCodePoint();switch(e){case Yx:return this.consumeStringToken(Yx);case C0e:var t=this.peekCodePoint(0),i=this.peekCodePoint(1),r=this.peekCodePoint(2);if(mL(t)||lp(i,r)){var s=eb(t,i,r)?v0e:w0e,o=this.consumeName();return{type:5,value:o,flags:s}}break;case _0e:if(this.peekCodePoint(0)===p2)return this.consumeCodePoint(),lme;break;case Kx:return this.consumeStringToken(Kx);case qx:return sme;case g2:return ome;case f4:if(this.peekCodePoint(0)===p2)return this.consumeCodePoint(),pme;break;case Lg:if(p4(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case R0e:return ame;case Fh:var a=e,l=this.peekCodePoint(0),h=this.peekCodePoint(1);if(p4(a,l,h))return this.reconsumeCodePoint(e),this.consumeNumericToken();if(eb(a,l,h))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();if(l===Fh&&h===F0e)return this.consumeCodePoint(),this.consumeCodePoint(),yme;break;case Rw:if(p4(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case fL:if(this.peekCodePoint(0)===f4)for(this.consumeCodePoint();;){var u=this.consumeCodePoint();if(u===f4&&(u=this.consumeCodePoint(),u===fL))return this.consumeToken();if(u===zd)return this.consumeToken()}break;case U0e:return wme;case O0e:return vme;case E0e:if(this.peekCodePoint(0)===B0e&&this.peekCodePoint(1)===Fh&&this.peekCodePoint(2)===Fh)return this.consumeCodePoint(),this.consumeCodePoint(),mme;break;case k0e:var d=this.peekCodePoint(0),A=this.peekCodePoint(1),f=this.peekCodePoint(2);if(eb(d,A,f)){var o=this.consumeName();return{type:7,value:o}}break;case I0e:return xme;case tw:if(lp(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();break;case D0e:return bme;case j0e:if(this.peekCodePoint(0)===p2)return this.consumeCodePoint(),cme;break;case P0e:return Ame;case N0e:return fme;case X0e:case K0e:var p=this.peekCodePoint(0),g=this.peekCodePoint(1);return p===Lg&&(V0(g)||g===Zx)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(e),this.consumeIdentLikeToken();case pL:if(this.peekCodePoint(0)===p2)return this.consumeCodePoint(),ume;if(this.peekCodePoint(0)===pL)return this.consumeCodePoint(),hme;break;case L0e:if(this.peekCodePoint(0)===p2)return this.consumeCodePoint(),dme;break;case zd:return ZE}return Jx(e)?(this.consumeWhiteSpace(),Cme):Wc(e)?(this.reconsumeCodePoint(e),this.consumeNumericToken()):f_(e)?(this.reconsumeCodePoint(e),this.consumeIdentLikeToken()):{type:6,value:tl(e)}},n.prototype.consumeCodePoint=function(){var e=this._value.shift();return typeof e>"u"?-1:e},n.prototype.reconsumeCodePoint=function(e){this._value.unshift(e)},n.prototype.peekCodePoint=function(e){return e>=this._value.length?-1:this._value[e]},n.prototype.consumeUnicodeRangeToken=function(){for(var e=[],t=this.consumeCodePoint();V0(t)&&e.length<6;)e.push(t),t=this.consumeCodePoint();for(var i=!1;t===Zx&&e.length<6;)e.push(t),t=this.consumeCodePoint(),i=!0;if(i){var r=parseInt(tl.apply(void 0,e.map(function(l){return l===Zx?G$:l})),16),s=parseInt(tl.apply(void 0,e.map(function(l){return l===Zx?Z$:l})),16);return{type:30,start:r,end:s}}var o=parseInt(tl.apply(void 0,e),16);if(this.peekCodePoint(0)===Fh&&V0(this.peekCodePoint(1))){this.consumeCodePoint(),t=this.consumeCodePoint();for(var a=[];V0(t)&&a.length<6;)a.push(t),t=this.consumeCodePoint();var s=parseInt(tl.apply(void 0,a),16);return{type:30,start:o,end:s}}else return{type:30,start:o,end:o}},n.prototype.consumeIdentLikeToken=function(){var e=this.consumeName();return e.toLowerCase()==="url"&&this.peekCodePoint(0)===qx?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===qx?(this.consumeCodePoint(),{type:19,value:e}):{type:20,value:e}},n.prototype.consumeUrlToken=function(){var e=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===zd)return{type:22,value:""};var t=this.peekCodePoint(0);if(t===Kx||t===Yx){var i=this.consumeStringToken(this.consumeCodePoint());return i.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===zd||this.peekCodePoint(0)===g2)?(this.consumeCodePoint(),{type:22,value:i.value}):(this.consumeBadUrlRemnants(),tb)}for(;;){var r=this.consumeCodePoint();if(r===zd||r===g2)return{type:22,value:tl.apply(void 0,e)};if(Jx(r))return this.consumeWhiteSpace(),this.peekCodePoint(0)===zd||this.peekCodePoint(0)===g2?(this.consumeCodePoint(),{type:22,value:tl.apply(void 0,e)}):(this.consumeBadUrlRemnants(),tb);if(r===Yx||r===Kx||r===qx||ime(r))return this.consumeBadUrlRemnants(),tb;if(r===tw)if(lp(r,this.peekCodePoint(0)))e.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),tb;else e.push(r)}},n.prototype.consumeWhiteSpace=function(){for(;Jx(this.peekCodePoint(0));)this.consumeCodePoint()},n.prototype.consumeBadUrlRemnants=function(){for(;;){var e=this.consumeCodePoint();if(e===g2||e===zd)return;lp(e,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},n.prototype.consumeStringSlice=function(e){for(var t=5e4,i="";e>0;){var r=Math.min(t,e);i+=tl.apply(void 0,this._value.splice(0,r)),e-=r}return this._value.shift(),i},n.prototype.consumeStringToken=function(e){var t="",i=0;do{var r=this._value[i];if(r===zd||r===void 0||r===e)return t+=this.consumeStringSlice(i),{type:0,value:t};if(r===A_)return this._value.splice(0,i),gme;if(r===tw){var s=this._value[i+1];s!==zd&&s!==void 0&&(s===A_?(t+=this.consumeStringSlice(i),i=-1,this._value.shift()):lp(r,s)&&(t+=this.consumeStringSlice(i),t+=tl(this.consumeEscapedCodePoint()),i=-1))}i++}while(!0)},n.prototype.consumeNumber=function(){var e=[],t=Cv,i=this.peekCodePoint(0);for((i===Lg||i===Fh)&&e.push(this.consumeCodePoint());Wc(this.peekCodePoint(0));)e.push(this.consumeCodePoint());i=this.peekCodePoint(0);var r=this.peekCodePoint(1);if(i===Rw&&Wc(r))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),t=AL;Wc(this.peekCodePoint(0));)e.push(this.consumeCodePoint());i=this.peekCodePoint(0),r=this.peekCodePoint(1);var s=this.peekCodePoint(2);if((i===q$||i===Y$)&&((r===Lg||r===Fh)&&Wc(s)||Wc(r)))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),t=AL;Wc(this.peekCodePoint(0));)e.push(this.consumeCodePoint());return[rme(e),t]},n.prototype.consumeNumericToken=function(){var e=this.consumeNumber(),t=e[0],i=e[1],r=this.peekCodePoint(0),s=this.peekCodePoint(1),o=this.peekCodePoint(2);if(eb(r,s,o)){var a=this.consumeName();return{type:15,number:t,flags:i,unit:a}}return r===S0e?(this.consumeCodePoint(),{type:16,number:t,flags:i}):{type:17,number:t,flags:i}},n.prototype.consumeEscapedCodePoint=function(){var e=this.consumeCodePoint();if(V0(e)){for(var t=tl(e);V0(this.peekCodePoint(0))&&t.length<6;)t+=tl(this.consumeCodePoint());Jx(this.peekCodePoint(0))&&this.consumeCodePoint();var i=parseInt(t,16);return i===0||Z0e(i)||i>1114111?gL:i}return e===zd?gL:e},n.prototype.consumeName=function(){for(var e="";;){var t=this.consumeCodePoint();if(mL(t))e+=tl(t);else if(lp(t,this.peekCodePoint(0)))e+=tl(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(t),e}},n})(),eV=(function(){function n(e){this._tokens=e}return n.create=function(e){var t=new J$;return t.write(e),new n(t.read())},n.parseValue=function(e){return n.create(e).parseComponentValue()},n.parseValues=function(e){return n.create(e).parseComponentValues()},n.prototype.parseComponentValue=function(){for(var e=this.consumeToken();e.type===31;)e=this.consumeToken();if(e.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(e);var t=this.consumeComponentValue();do e=this.consumeToken();while(e.type===31);if(e.type===32)return t;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},n.prototype.parseComponentValues=function(){for(var e=[];;){var t=this.consumeComponentValue();if(t.type===32)return e;e.push(t),e.push()}},n.prototype.consumeComponentValue=function(){var e=this.consumeToken();switch(e.type){case 11:case 28:case 2:return this.consumeSimpleBlock(e.type);case 19:return this.consumeFunction(e)}return e},n.prototype.consumeSimpleBlock=function(e){for(var t={type:e,values:[]},i=this.consumeToken();;){if(i.type===32||Sme(i,e))return t;this.reconsumeToken(i),t.values.push(this.consumeComponentValue()),i=this.consumeToken()}},n.prototype.consumeFunction=function(e){for(var t={name:e.value,values:[],type:18};;){var i=this.consumeToken();if(i.type===32||i.type===3)return t;this.reconsumeToken(i),t.values.push(this.consumeComponentValue())}},n.prototype.consumeToken=function(){var e=this._tokens.shift();return typeof e>"u"?ZE:e},n.prototype.reconsumeToken=function(e){this._tokens.unshift(e)},n})(),_v=function(n){return n.type===15},P1=function(n){return n.type===17},So=function(n){return n.type===20},_me=function(n){return n.type===0},JE=function(n,e){return So(n)&&n.value===e},tV=function(n){return n.type!==31},u1=function(n){return n.type!==31&&n.type!==4},CA=function(n){var e=[],t=[];return n.forEach(function(i){if(i.type===4){if(t.length===0)throw new Error("Error parsing function args, zero tokens for arg");e.push(t),t=[];return}i.type!==31&&t.push(i)}),t.length&&e.push(t),e},Sme=function(n,e){return e===11&&n.type===12||e===28&&n.type===29?!0:e===2&&n.type===3},Hp=function(n){return n.type===17||n.type===15},ml=function(n){return n.type===16||Hp(n)},nV=function(n){return n.length>1?[n[0],n[1]]:[n[0]]},xc={type:17,number:0,flags:Cv},Xk={type:16,number:50,flags:Cv},xp={type:16,number:100,flags:Cv},Cy=function(n,e,t){var i=n[0],r=n[1];return[Qo(i,e),Qo(typeof r<"u"?r:i,t)]},Qo=function(n,e){if(n.type===16)return n.number/100*e;if(_v(n))switch(n.unit){case"rem":case"em":return 16*n.number;case"px":default:return n.number}return n.number},iV="deg",rV="grad",sV="rad",oV="turn",$5={name:"angle",parse:function(n,e){if(e.type===15)switch(e.unit){case iV:return Math.PI*e.number/180;case rV:return Math.PI/200*e.number;case sV:return e.number;case oV:return Math.PI*2*e.number}throw new Error("Unsupported angle type")}},aV=function(n){return n.type===15&&(n.unit===iV||n.unit===rV||n.unit===sV||n.unit===oV)},lV=function(n){var e=n.filter(So).map(function(t){return t.value}).join(" ");switch(e){case"to bottom right":case"to right bottom":case"left top":case"top left":return[xc,xc];case"to top":case"bottom":return Du(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[xc,xp];case"to right":case"left":return Du(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[xp,xp];case"to bottom":case"top":return Du(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[xp,xc];case"to left":case"right":return Du(270)}return 0},Du=function(n){return Math.PI*n/180},Ep={name:"color",parse:function(n,e){if(e.type===18){var t=Tme[e.name];if(typeof t>"u")throw new Error('Attempting to parse an unsupported color function "'+e.name+'"');return t(n,e.values)}if(e.type===5){if(e.value.length===3){var i=e.value.substring(0,1),r=e.value.substring(1,2),s=e.value.substring(2,3);return bp(parseInt(i+i,16),parseInt(r+r,16),parseInt(s+s,16),1)}if(e.value.length===4){var i=e.value.substring(0,1),r=e.value.substring(1,2),s=e.value.substring(2,3),o=e.value.substring(3,4);return bp(parseInt(i+i,16),parseInt(r+r,16),parseInt(s+s,16),parseInt(o+o,16)/255)}if(e.value.length===6){var i=e.value.substring(0,2),r=e.value.substring(2,4),s=e.value.substring(4,6);return bp(parseInt(i,16),parseInt(r,16),parseInt(s,16),1)}if(e.value.length===8){var i=e.value.substring(0,2),r=e.value.substring(2,4),s=e.value.substring(4,6),o=e.value.substring(6,8);return bp(parseInt(i,16),parseInt(r,16),parseInt(s,16),parseInt(o,16)/255)}}if(e.type===20){var a=ff[e.value.toUpperCase()];if(typeof a<"u")return a}return ff.TRANSPARENT}},Fp=function(n){return(255&n)===0},Wl=function(n){var e=255&n,t=255&n>>8,i=255&n>>16,r=255&n>>24;return e<255?"rgba("+r+","+i+","+t+","+e/255+")":"rgb("+r+","+i+","+t+")"},bp=function(n,e,t,i){return(n<<24|e<<16|t<<8|Math.round(i*255)<<0)>>>0},yL=function(n,e){if(n.type===17)return n.number;if(n.type===16){var t=e===3?1:255;return e===3?n.number/100*t:Math.round(n.number/100*t)}return 0},wL=function(n,e){var t=e.filter(u1);if(t.length===3){var i=t.map(yL),r=i[0],s=i[1],o=i[2];return bp(r,s,o,1)}if(t.length===4){var a=t.map(yL),r=a[0],s=a[1],o=a[2],l=a[3];return bp(r,s,o,l)}return 0};function g4(n,e,t){return t<0&&(t+=1),t>=1&&(t-=1),t<1/6?(e-n)*t*6+n:t<1/2?e:t<2/3?(e-n)*6*(2/3-t)+n:n}var vL=function(n,e){var t=e.filter(u1),i=t[0],r=t[1],s=t[2],o=t[3],a=(i.type===17?Du(i.number):$5.parse(n,i))/(Math.PI*2),l=ml(r)?r.number/100:0,h=ml(s)?s.number/100:0,u=typeof o<"u"&&ml(o)?Qo(o,1):1;if(l===0)return bp(h*255,h*255,h*255,1);var d=h<=.5?h*(l+1):h+l-h*l,A=h*2-d,f=g4(A,d,a+1/3),p=g4(A,d,a),g=g4(A,d,a-1/3);return bp(f*255,p*255,g*255,u)},Tme={hsl:vL,hsla:vL,rgb:wL,rgba:wL},nw=function(n,e){return Ep.parse(n,eV.create(e).parseComponentValue())},ff={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},Bme={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(n,e){return e.map(function(t){if(So(t))switch(t.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},Eme={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},V5=function(n,e){var t=Ep.parse(n,e[0]),i=e[1];return i&&ml(i)?{color:t,stop:i}:{color:t,stop:null}},xL=function(n,e){var t=n[0],i=n[n.length-1];t.stop===null&&(t.stop=xc),i.stop===null&&(i.stop=xp);for(var r=[],s=0,o=0;o<n.length;o++){var a=n[o].stop;if(a!==null){var l=Qo(a,e);l>s?r.push(l):r.push(s),s=l}else r.push(null)}for(var h=null,o=0;o<r.length;o++){var u=r[o];if(u===null)h===null&&(h=o);else if(h!==null){for(var d=o-h,A=r[h-1],f=(u-A)/(d+1),p=1;p<=d;p++)r[h+p-1]=f*p;h=null}}return n.map(function(g,v){var w=g.color;return{color:w,stop:Math.max(Math.min(1,r[v]/e),0)}})},Fme=function(n,e,t){var i=e/2,r=t/2,s=Qo(n[0],e)-i,o=r-Qo(n[1],t);return(Math.atan2(o,s)+Math.PI*2)%(Math.PI*2)},kme=function(n,e,t){var i=typeof n=="number"?n:Fme(n,e,t),r=Math.abs(e*Math.sin(i))+Math.abs(t*Math.cos(i)),s=e/2,o=t/2,a=r/2,l=Math.sin(i-Math.PI/2)*a,h=Math.cos(i-Math.PI/2)*a;return[r,s-h,s+h,o-l,o+l]},nd=function(n,e){return Math.sqrt(n*n+e*e)},bL=function(n,e,t,i,r){var s=[[0,0],[0,e],[n,0],[n,e]];return s.reduce(function(o,a){var l=a[0],h=a[1],u=nd(t-l,i-h);return(r?u<o.optimumDistance:u>o.optimumDistance)?{optimumCorner:a,optimumDistance:u}:o},{optimumDistance:r?1/0:-1/0,optimumCorner:null}).optimumCorner},Ime=function(n,e,t,i,r){var s=0,o=0;switch(n.size){case 0:n.shape===0?s=o=Math.min(Math.abs(e),Math.abs(e-i),Math.abs(t),Math.abs(t-r)):n.shape===1&&(s=Math.min(Math.abs(e),Math.abs(e-i)),o=Math.min(Math.abs(t),Math.abs(t-r)));break;case 2:if(n.shape===0)s=o=Math.min(nd(e,t),nd(e,t-r),nd(e-i,t),nd(e-i,t-r));else if(n.shape===1){var a=Math.min(Math.abs(t),Math.abs(t-r))/Math.min(Math.abs(e),Math.abs(e-i)),l=bL(i,r,e,t,!0),h=l[0],u=l[1];s=nd(h-e,(u-t)/a),o=a*s}break;case 1:n.shape===0?s=o=Math.max(Math.abs(e),Math.abs(e-i),Math.abs(t),Math.abs(t-r)):n.shape===1&&(s=Math.max(Math.abs(e),Math.abs(e-i)),o=Math.max(Math.abs(t),Math.abs(t-r)));break;case 3:if(n.shape===0)s=o=Math.max(nd(e,t),nd(e,t-r),nd(e-i,t),nd(e-i,t-r));else if(n.shape===1){var a=Math.max(Math.abs(t),Math.abs(t-r))/Math.max(Math.abs(e),Math.abs(e-i)),d=bL(i,r,e,t,!1),h=d[0],u=d[1];s=nd(h-e,(u-t)/a),o=a*s}break}return Array.isArray(n.size)&&(s=Qo(n.size[0],i),o=n.size.length===2?Qo(n.size[1],r):s),[s,o]},Dme=function(n,e){var t=Du(180),i=[];return CA(e).forEach(function(r,s){if(s===0){var o=r[0];if(o.type===20&&o.value==="to"){t=lV(r);return}else if(aV(o)){t=$5.parse(n,o);return}}var a=V5(n,r);i.push(a)}),{angle:t,stops:i,type:1}},nb=function(n,e){var t=Du(180),i=[];return CA(e).forEach(function(r,s){if(s===0){var o=r[0];if(o.type===20&&["top","left","right","bottom"].indexOf(o.value)!==-1){t=lV(r);return}else if(aV(o)){t=($5.parse(n,o)+Du(270))%Du(360);return}}var a=V5(n,r);i.push(a)}),{angle:t,stops:i,type:1}},jme=function(n,e){var t=Du(180),i=[],r=1,s=0,o=3,a=[];return CA(e).forEach(function(l,h){var u=l[0];if(h===0){if(So(u)&&u.value==="linear"){r=1;return}else if(So(u)&&u.value==="radial"){r=2;return}}if(u.type===18){if(u.name==="from"){var d=Ep.parse(n,u.values[0]);i.push({stop:xc,color:d})}else if(u.name==="to"){var d=Ep.parse(n,u.values[0]);i.push({stop:xp,color:d})}else if(u.name==="color-stop"){var A=u.values.filter(u1);if(A.length===2){var d=Ep.parse(n,A[1]),f=A[0];P1(f)&&i.push({stop:{type:16,number:f.number*100,flags:f.flags},color:d})}}}}),r===1?{angle:(t+Du(180))%Du(360),stops:i,type:r}:{size:o,shape:s,stops:i,position:a,type:r}},cV="closest-side",hV="farthest-side",uV="closest-corner",dV="farthest-corner",AV="circle",fV="ellipse",pV="cover",gV="contain",Pme=function(n,e){var t=0,i=3,r=[],s=[];return CA(e).forEach(function(o,a){var l=!0;if(a===0){var h=!1;l=o.reduce(function(d,A){if(h)if(So(A))switch(A.value){case"center":return s.push(Xk),d;case"top":case"left":return s.push(xc),d;case"right":case"bottom":return s.push(xp),d}else(ml(A)||Hp(A))&&s.push(A);else if(So(A))switch(A.value){case AV:return t=0,!1;case fV:return t=1,!1;case"at":return h=!0,!1;case cV:return i=0,!1;case pV:case hV:return i=1,!1;case gV:case uV:return i=2,!1;case dV:return i=3,!1}else if(Hp(A)||ml(A))return Array.isArray(i)||(i=[]),i.push(A),!1;return d},l)}if(l){var u=V5(n,o);r.push(u)}}),{size:i,shape:t,stops:r,position:s,type:2}},ib=function(n,e){var t=0,i=3,r=[],s=[];return CA(e).forEach(function(o,a){var l=!0;if(a===0?l=o.reduce(function(u,d){if(So(d))switch(d.value){case"center":return s.push(Xk),!1;case"top":case"left":return s.push(xc),!1;case"right":case"bottom":return s.push(xp),!1}else if(ml(d)||Hp(d))return s.push(d),!1;return u},l):a===1&&(l=o.reduce(function(u,d){if(So(d))switch(d.value){case AV:return t=0,!1;case fV:return t=1,!1;case gV:case cV:return i=0,!1;case hV:return i=1,!1;case uV:return i=2,!1;case pV:case dV:return i=3,!1}else if(Hp(d)||ml(d))return Array.isArray(i)||(i=[]),i.push(d),!1;return u},l)),l){var h=V5(n,o);r.push(h)}}),{size:i,shape:t,stops:r,position:s,type:2}},Nme=function(n){return n.type===1},Lme=function(n){return n.type===2},Yk={name:"image",parse:function(n,e){if(e.type===22){var t={url:e.value,type:0};return n.cache.addImage(e.value),t}if(e.type===18){var i=mV[e.name];if(typeof i>"u")throw new Error('Attempting to parse an unsupported image function "'+e.name+'"');return i(n,e.values)}throw new Error("Unsupported image type "+e.type)}};function Mme(n){return!(n.type===20&&n.value==="none")&&(n.type!==18||!!mV[n.name])}var mV={"linear-gradient":Dme,"-moz-linear-gradient":nb,"-ms-linear-gradient":nb,"-o-linear-gradient":nb,"-webkit-linear-gradient":nb,"radial-gradient":Pme,"-moz-radial-gradient":ib,"-ms-radial-gradient":ib,"-o-radial-gradient":ib,"-webkit-radial-gradient":ib,"-webkit-gradient":jme},Rme={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(n,e){if(e.length===0)return[];var t=e[0];return t.type===20&&t.value==="none"?[]:e.filter(function(i){return u1(i)&&Mme(i)}).map(function(i){return Yk.parse(n,i)})}},Ume={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(n,e){return e.map(function(t){if(So(t))switch(t.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},Ome={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(n,e){return CA(e).map(function(t){return t.filter(ml)}).map(nV)}},Hme={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(n,e){return CA(e).map(function(t){return t.filter(So).map(function(i){return i.value}).join(" ")}).map(Wme)}},Wme=function(n){switch(n){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},$m;(function(n){n.AUTO="auto",n.CONTAIN="contain",n.COVER="cover"})($m||($m={}));var zme={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(n,e){return CA(e).map(function(t){return t.filter(Qme)})}},Qme=function(n){return So(n)||ml(n)},G5=function(n){return{name:"border-"+n+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},$me=G5("top"),Vme=G5("right"),Gme=G5("bottom"),Xme=G5("left"),X5=function(n){return{name:"border-radius-"+n,initialValue:"0 0",prefix:!1,type:1,parse:function(e,t){return nV(t.filter(ml))}}},Yme=X5("top-left"),Kme=X5("top-right"),qme=X5("bottom-right"),Zme=X5("bottom-left"),Y5=function(n){return{name:"border-"+n+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(e,t){switch(t){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},Jme=Y5("top"),e1e=Y5("right"),t1e=Y5("bottom"),n1e=Y5("left"),K5=function(n){return{name:"border-"+n+"-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return _v(t)?t.number:0}}},i1e=K5("top"),r1e=K5("right"),s1e=K5("bottom"),o1e=K5("left"),a1e={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},l1e={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(n,e){switch(e){case"rtl":return 1;case"ltr":default:return 0}}},c1e={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(n,e){return e.filter(So).reduce(function(t,i){return t|h1e(i.value)},0)}},h1e=function(n){switch(n){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},u1e={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(n,e){switch(e){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},d1e={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(n,e){return e.type===20&&e.value==="normal"?0:e.type===17||e.type===15?e.number:0}},p_;(function(n){n.NORMAL="normal",n.STRICT="strict"})(p_||(p_={}));var A1e={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(n,e){switch(e){case"strict":return p_.STRICT;case"normal":default:return p_.NORMAL}}},f1e={name:"line-height",initialValue:"normal",prefix:!1,type:4},CL=function(n,e){return So(n)&&n.value==="normal"?1.2*e:n.type===17?e*n.number:ml(n)?Qo(n,e):e},p1e={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(n,e){return e.type===20&&e.value==="none"?null:Yk.parse(n,e)}},g1e={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(n,e){switch(e){case"inside":return 0;case"outside":default:return 1}}},e6={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(n,e){switch(e){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},q5=function(n){return{name:"margin-"+n,initialValue:"0",prefix:!1,type:4}},m1e=q5("top"),y1e=q5("right"),w1e=q5("bottom"),v1e=q5("left"),x1e={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(n,e){return e.filter(So).map(function(t){switch(t.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},b1e={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(n,e){switch(e){case"break-word":return"break-word";case"normal":default:return"normal"}}},Z5=function(n){return{name:"padding-"+n,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},C1e=Z5("top"),_1e=Z5("right"),S1e=Z5("bottom"),T1e=Z5("left"),B1e={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(n,e){switch(e){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},E1e={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(n,e){switch(e){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},F1e={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(n,e){return e.length===1&&JE(e[0],"none")?[]:CA(e).map(function(t){for(var i={color:ff.TRANSPARENT,offsetX:xc,offsetY:xc,blur:xc},r=0,s=0;s<t.length;s++){var o=t[s];Hp(o)?(r===0?i.offsetX=o:r===1?i.offsetY=o:i.blur=o,r++):i.color=Ep.parse(n,o)}return i})}},k1e={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(n,e){switch(e){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},I1e={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(n,e){if(e.type===20&&e.value==="none")return null;if(e.type===18){var t=P1e[e.name];if(typeof t>"u")throw new Error('Attempting to parse an unsupported transform function "'+e.name+'"');return t(e.values)}return null}},D1e=function(n){var e=n.filter(function(t){return t.type===17}).map(function(t){return t.number});return e.length===6?e:null},j1e=function(n){var e=n.filter(function(l){return l.type===17}).map(function(l){return l.number}),t=e[0],i=e[1];e[2],e[3];var r=e[4],s=e[5];e[6],e[7],e[8],e[9],e[10],e[11];var o=e[12],a=e[13];return e[14],e[15],e.length===16?[t,i,r,s,o,a]:null},P1e={matrix:D1e,matrix3d:j1e},_L={type:16,number:50,flags:Cv},N1e=[_L,_L],L1e={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(n,e){var t=e.filter(ml);return t.length!==2?N1e:[t[0],t[1]]}},M1e={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(n,e){switch(e){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},iw;(function(n){n.NORMAL="normal",n.BREAK_ALL="break-all",n.KEEP_ALL="keep-all"})(iw||(iw={}));var R1e={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(n,e){switch(e){case"break-all":return iw.BREAK_ALL;case"keep-all":return iw.KEEP_ALL;case"normal":default:return iw.NORMAL}}},U1e={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(n,e){if(e.type===20)return{auto:!0,order:0};if(P1(e))return{auto:!1,order:e.number};throw new Error("Invalid z-index number parsed")}},yV={name:"time",parse:function(n,e){if(e.type===15)switch(e.unit.toLowerCase()){case"s":return 1e3*e.number;case"ms":return e.number}throw new Error("Unsupported time type")}},O1e={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(n,e){return P1(e)?e.number:1}},H1e={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},W1e={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(n,e){return e.filter(So).map(function(t){switch(t.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(t){return t!==0})}},z1e={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(n,e){var t=[],i=[];return e.forEach(function(r){switch(r.type){case 20:case 0:t.push(r.value);break;case 17:t.push(r.number.toString());break;case 4:i.push(t.join(" ")),t.length=0;break}}),t.length&&i.push(t.join(" ")),i.map(function(r){return r.indexOf(" ")===-1?r:"'"+r+"'"})}},Q1e={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},$1e={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(n,e){if(P1(e))return e.number;if(So(e))switch(e.value){case"bold":return 700;case"normal":default:return 400}return 400}},V1e={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(n,e){return e.filter(So).map(function(t){return t.value})}},G1e={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(n,e){switch(e){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},Il=function(n,e){return(n&e)!==0},X1e={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(n,e){if(e.length===0)return[];var t=e[0];return t.type===20&&t.value==="none"?[]:e}},Y1e={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(n,e){if(e.length===0)return null;var t=e[0];if(t.type===20&&t.value==="none")return null;for(var i=[],r=e.filter(tV),s=0;s<r.length;s++){var o=r[s],a=r[s+1];if(o.type===20){var l=a&&P1(a)?a.number:1;i.push({counter:o.value,increment:l})}}return i}},K1e={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(n,e){if(e.length===0)return[];for(var t=[],i=e.filter(tV),r=0;r<i.length;r++){var s=i[r],o=i[r+1];if(So(s)&&s.value!=="none"){var a=o&&P1(o)?o.number:0;t.push({counter:s.value,reset:a})}}return t}},q1e={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(n,e){return e.filter(_v).map(function(t){return yV.parse(n,t)})}},Z1e={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(n,e){if(e.length===0)return null;var t=e[0];if(t.type===20&&t.value==="none")return null;var i=[],r=e.filter(_me);if(r.length%2!==0)return null;for(var s=0;s<r.length;s+=2){var o=r[s].value,a=r[s+1].value;i.push({open:o,close:a})}return i}},SL=function(n,e,t){if(!n)return"";var i=n[Math.min(e,n.length-1)];return i?t?i.open:i.close:""},J1e={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(n,e){return e.length===1&&JE(e[0],"none")?[]:CA(e).map(function(t){for(var i={color:255,offsetX:xc,offsetY:xc,blur:xc,spread:xc,inset:!1},r=0,s=0;s<t.length;s++){var o=t[s];JE(o,"inset")?i.inset=!0:Hp(o)?(r===0?i.offsetX=o:r===1?i.offsetY=o:r===2?i.blur=o:i.spread=o,r++):i.color=Ep.parse(n,o)}return i})}},e2e={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(n,e){var t=[0,1,2],i=[];return e.filter(So).forEach(function(r){switch(r.value){case"stroke":i.push(1);break;case"fill":i.push(0);break;case"markers":i.push(2);break}}),t.forEach(function(r){i.indexOf(r)===-1&&i.push(r)}),i}},t2e={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},n2e={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(n,e){return _v(e)?e.number:0}},i2e=(function(){function n(e,t){var i,r;this.animationDuration=Di(e,q1e,t.animationDuration),this.backgroundClip=Di(e,Bme,t.backgroundClip),this.backgroundColor=Di(e,Eme,t.backgroundColor),this.backgroundImage=Di(e,Rme,t.backgroundImage),this.backgroundOrigin=Di(e,Ume,t.backgroundOrigin),this.backgroundPosition=Di(e,Ome,t.backgroundPosition),this.backgroundRepeat=Di(e,Hme,t.backgroundRepeat),this.backgroundSize=Di(e,zme,t.backgroundSize),this.borderTopColor=Di(e,$me,t.borderTopColor),this.borderRightColor=Di(e,Vme,t.borderRightColor),this.borderBottomColor=Di(e,Gme,t.borderBottomColor),this.borderLeftColor=Di(e,Xme,t.borderLeftColor),this.borderTopLeftRadius=Di(e,Yme,t.borderTopLeftRadius),this.borderTopRightRadius=Di(e,Kme,t.borderTopRightRadius),this.borderBottomRightRadius=Di(e,qme,t.borderBottomRightRadius),this.borderBottomLeftRadius=Di(e,Zme,t.borderBottomLeftRadius),this.borderTopStyle=Di(e,Jme,t.borderTopStyle),this.borderRightStyle=Di(e,e1e,t.borderRightStyle),this.borderBottomStyle=Di(e,t1e,t.borderBottomStyle),this.borderLeftStyle=Di(e,n1e,t.borderLeftStyle),this.borderTopWidth=Di(e,i1e,t.borderTopWidth),this.borderRightWidth=Di(e,r1e,t.borderRightWidth),this.borderBottomWidth=Di(e,s1e,t.borderBottomWidth),this.borderLeftWidth=Di(e,o1e,t.borderLeftWidth),this.boxShadow=Di(e,J1e,t.boxShadow),this.color=Di(e,a1e,t.color),this.direction=Di(e,l1e,t.direction),this.display=Di(e,c1e,t.display),this.float=Di(e,u1e,t.cssFloat),this.fontFamily=Di(e,z1e,t.fontFamily),this.fontSize=Di(e,Q1e,t.fontSize),this.fontStyle=Di(e,G1e,t.fontStyle),this.fontVariant=Di(e,V1e,t.fontVariant),this.fontWeight=Di(e,$1e,t.fontWeight),this.letterSpacing=Di(e,d1e,t.letterSpacing),this.lineBreak=Di(e,A1e,t.lineBreak),this.lineHeight=Di(e,f1e,t.lineHeight),this.listStyleImage=Di(e,p1e,t.listStyleImage),this.listStylePosition=Di(e,g1e,t.listStylePosition),this.listStyleType=Di(e,e6,t.listStyleType),this.marginTop=Di(e,m1e,t.marginTop),this.marginRight=Di(e,y1e,t.marginRight),this.marginBottom=Di(e,w1e,t.marginBottom),this.marginLeft=Di(e,v1e,t.marginLeft),this.opacity=Di(e,O1e,t.opacity);var s=Di(e,x1e,t.overflow);this.overflowX=s[0],this.overflowY=s[s.length>1?1:0],this.overflowWrap=Di(e,b1e,t.overflowWrap),this.paddingTop=Di(e,C1e,t.paddingTop),this.paddingRight=Di(e,_1e,t.paddingRight),this.paddingBottom=Di(e,S1e,t.paddingBottom),this.paddingLeft=Di(e,T1e,t.paddingLeft),this.paintOrder=Di(e,e2e,t.paintOrder),this.position=Di(e,E1e,t.position),this.textAlign=Di(e,B1e,t.textAlign),this.textDecorationColor=Di(e,H1e,(i=t.textDecorationColor)!==null&&i!==void 0?i:t.color),this.textDecorationLine=Di(e,W1e,(r=t.textDecorationLine)!==null&&r!==void 0?r:t.textDecoration),this.textShadow=Di(e,F1e,t.textShadow),this.textTransform=Di(e,k1e,t.textTransform),this.transform=Di(e,I1e,t.transform),this.transformOrigin=Di(e,L1e,t.transformOrigin),this.visibility=Di(e,M1e,t.visibility),this.webkitTextStrokeColor=Di(e,t2e,t.webkitTextStrokeColor),this.webkitTextStrokeWidth=Di(e,n2e,t.webkitTextStrokeWidth),this.wordBreak=Di(e,R1e,t.wordBreak),this.zIndex=Di(e,U1e,t.zIndex)}return n.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},n.prototype.isTransparent=function(){return Fp(this.backgroundColor)},n.prototype.isTransformed=function(){return this.transform!==null},n.prototype.isPositioned=function(){return this.position!==0},n.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},n.prototype.isFloating=function(){return this.float!==0},n.prototype.isInlineLevel=function(){return Il(this.display,4)||Il(this.display,33554432)||Il(this.display,268435456)||Il(this.display,536870912)||Il(this.display,67108864)||Il(this.display,134217728)},n})(),r2e=(function(){function n(e,t){this.content=Di(e,X1e,t.content),this.quotes=Di(e,Z1e,t.quotes)}return n})(),TL=(function(){function n(e,t){this.counterIncrement=Di(e,Y1e,t.counterIncrement),this.counterReset=Di(e,K1e,t.counterReset)}return n})(),Di=function(n,e,t){var i=new J$,r=t!==null&&typeof t<"u"?t.toString():e.initialValue;i.write(r);var s=new eV(i.read());switch(e.type){case 2:var o=s.parseComponentValue();return e.parse(n,So(o)?o.value:e.initialValue);case 0:return e.parse(n,s.parseComponentValue());case 1:return e.parse(n,s.parseComponentValues());case 4:return s.parseComponentValue();case 3:switch(e.format){case"angle":return $5.parse(n,s.parseComponentValue());case"color":return Ep.parse(n,s.parseComponentValue());case"image":return Yk.parse(n,s.parseComponentValue());case"length":var a=s.parseComponentValue();return Hp(a)?a:xc;case"length-percentage":var l=s.parseComponentValue();return ml(l)?l:xc;case"time":return yV.parse(n,s.parseComponentValue())}break}},s2e="data-html2canvas-debug",o2e=function(n){var e=n.getAttribute(s2e);switch(e){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},t6=function(n,e){var t=o2e(n);return t===1||e===t},_A=(function(){function n(e,t){if(this.context=e,this.textNodes=[],this.elements=[],this.flags=0,t6(t,3))debugger;this.styles=new i2e(e,window.getComputedStyle(t,null)),r6(t)&&(this.styles.animationDuration.some(function(i){return i>0})&&(t.style.animationDuration="0s"),this.styles.transform!==null&&(t.style.transform="none")),this.bounds=z5(this.context,t),t6(t,4)&&(this.flags|=16)}return n})(),a2e="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",BL="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_y=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var rb=0;rb<BL.length;rb++)_y[BL.charCodeAt(rb)]=rb;var l2e=function(n){var e=n.length*.75,t=n.length,i,r=0,s,o,a,l;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);var h=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),u=Array.isArray(h)?h:new Uint8Array(h);for(i=0;i<t;i+=4)s=_y[n.charCodeAt(i)],o=_y[n.charCodeAt(i+1)],a=_y[n.charCodeAt(i+2)],l=_y[n.charCodeAt(i+3)],u[r++]=s<<2|o>>4,u[r++]=(o&15)<<4|a>>2,u[r++]=(a&3)<<6|l&63;return h},c2e=function(n){for(var e=n.length,t=[],i=0;i<e;i+=2)t.push(n[i+1]<<8|n[i]);return t},h2e=function(n){for(var e=n.length,t=[],i=0;i<e;i+=4)t.push(n[i+3]<<24|n[i+2]<<16|n[i+1]<<8|n[i]);return t},Gg=5,Kk=11,m4=2,u2e=Kk-Gg,wV=65536>>Gg,d2e=1<<Gg,y4=d2e-1,A2e=1024>>Gg,f2e=wV+A2e,p2e=f2e,g2e=32,m2e=p2e+g2e,y2e=65536>>Kk,w2e=1<<u2e,v2e=w2e-1,EL=function(n,e,t){return n.slice?n.slice(e,t):new Uint16Array(Array.prototype.slice.call(n,e,t))},x2e=function(n,e,t){return n.slice?n.slice(e,t):new Uint32Array(Array.prototype.slice.call(n,e,t))},b2e=function(n,e){var t=l2e(n),i=Array.isArray(t)?h2e(t):new Uint32Array(t),r=Array.isArray(t)?c2e(t):new Uint16Array(t),s=24,o=EL(r,s/2,i[4]/2),a=i[5]===2?EL(r,(s+i[4])/2):x2e(i,Math.ceil((s+i[4])/4));return new C2e(i[0],i[1],i[2],i[3],o,a)},C2e=(function(){function n(e,t,i,r,s,o){this.initialValue=e,this.errorValue=t,this.highStart=i,this.highValueIndex=r,this.index=s,this.data=o}return n.prototype.get=function(e){var t;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=this.index[e>>Gg],t=(t<<m4)+(e&y4),this.data[t];if(e<=65535)return t=this.index[wV+(e-55296>>Gg)],t=(t<<m4)+(e&y4),this.data[t];if(e<this.highStart)return t=m2e-y2e+(e>>Kk),t=this.index[t],t+=e>>Gg&v2e,t=this.index[t],t=(t<<m4)+(e&y4),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},n})(),FL="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_2e=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var sb=0;sb<FL.length;sb++)_2e[FL.charCodeAt(sb)]=sb;var S2e=1,w4=2,v4=3,kL=4,IL=5,T2e=7,DL=8,x4=9,b4=10,jL=11,PL=12,NL=13,LL=14,C4=15,B2e=function(n){for(var e=[],t=0,i=n.length;t<i;){var r=n.charCodeAt(t++);if(r>=55296&&r<=56319&&t<i){var s=n.charCodeAt(t++);(s&64512)===56320?e.push(((r&1023)<<10)+(s&1023)+65536):(e.push(r),t--)}else e.push(r)}return e},E2e=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,n);var t=n.length;if(!t)return"";for(var i=[],r=-1,s="";++r<t;){var o=n[r];o<=65535?i.push(o):(o-=65536,i.push((o>>10)+55296,o%1024+56320)),(r+1===t||i.length>16384)&&(s+=String.fromCharCode.apply(String,i),i.length=0)}return s},F2e=b2e(a2e),bu="×",_4="÷",k2e=function(n){return F2e.get(n)},I2e=function(n,e,t){var i=t-2,r=e[i],s=e[t-1],o=e[t];if(s===w4&&o===v4)return bu;if(s===w4||s===v4||s===kL||o===w4||o===v4||o===kL)return _4;if(s===DL&&[DL,x4,jL,PL].indexOf(o)!==-1||(s===jL||s===x4)&&(o===x4||o===b4)||(s===PL||s===b4)&&o===b4||o===NL||o===IL||o===T2e||s===S2e)return bu;if(s===NL&&o===LL){for(;r===IL;)r=e[--i];if(r===LL)return bu}if(s===C4&&o===C4){for(var a=0;r===C4;)a++,r=e[--i];if(a%2===0)return bu}return _4},D2e=function(n){var e=B2e(n),t=e.length,i=0,r=0,s=e.map(k2e);return{next:function(){if(i>=t)return{done:!0,value:null};for(var o=bu;i<t&&(o=I2e(e,s,++i))===bu;);if(o!==bu||i===t){var a=E2e.apply(null,e.slice(r,i));return r=i,{value:a,done:!1}}return{done:!0,value:null}}}},j2e=function(n){for(var e=D2e(n),t=[],i;!(i=e.next()).done;)i.value&&t.push(i.value.slice());return t},P2e=function(n){var e=123;if(n.createRange){var t=n.createRange();if(t.getBoundingClientRect){var i=n.createElement("boundtest");i.style.height=e+"px",i.style.display="block",n.body.appendChild(i),t.selectNode(i);var r=t.getBoundingClientRect(),s=Math.round(r.height);if(n.body.removeChild(i),s===e)return!0}}return!1},N2e=function(n){var e=n.createElement("boundtest");e.style.width="50px",e.style.display="block",e.style.fontSize="12px",e.style.letterSpacing="0px",e.style.wordSpacing="0px",n.body.appendChild(e);var t=n.createRange();e.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var i=e.firstChild,r=Q5(i.data).map(function(l){return tl(l)}),s=0,o={},a=r.every(function(l,h){t.setStart(i,s),t.setEnd(i,s+l.length);var u=t.getBoundingClientRect();s+=l.length;var d=u.x>o.x||u.y>o.y;return o=u,h===0?!0:d});return n.body.removeChild(e),a},L2e=function(){return typeof new Image().crossOrigin<"u"},M2e=function(){return typeof new XMLHttpRequest().responseType=="string"},R2e=function(n){var e=new Image,t=n.createElement("canvas"),i=t.getContext("2d");if(!i)return!1;e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{i.drawImage(e,0,0),t.toDataURL()}catch{return!1}return!0},ML=function(n){return n[0]===0&&n[1]===255&&n[2]===0&&n[3]===255},U2e=function(n){var e=n.createElement("canvas"),t=100;e.width=t,e.height=t;var i=e.getContext("2d");if(!i)return Promise.reject(!1);i.fillStyle="rgb(0, 255, 0)",i.fillRect(0,0,t,t);var r=new Image,s=e.toDataURL();r.src=s;var o=n6(t,t,0,0,r);return i.fillStyle="red",i.fillRect(0,0,t,t),RL(o).then(function(a){i.drawImage(a,0,0);var l=i.getImageData(0,0,t,t).data;i.fillStyle="red",i.fillRect(0,0,t,t);var h=n.createElement("div");return h.style.backgroundImage="url("+s+")",h.style.height=t+"px",ML(l)?RL(n6(t,t,0,0,h)):Promise.reject(!1)}).then(function(a){return i.drawImage(a,0,0),ML(i.getImageData(0,0,t,t).data)}).catch(function(){return!1})},n6=function(n,e,t,i,r){var s="http://www.w3.org/2000/svg",o=document.createElementNS(s,"svg"),a=document.createElementNS(s,"foreignObject");return o.setAttributeNS(null,"width",n.toString()),o.setAttributeNS(null,"height",e.toString()),a.setAttributeNS(null,"width","100%"),a.setAttributeNS(null,"height","100%"),a.setAttributeNS(null,"x",t.toString()),a.setAttributeNS(null,"y",i.toString()),a.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(a),a.appendChild(r),o},RL=function(n){return new Promise(function(e,t){var i=new Image;i.onload=function(){return e(i)},i.onerror=t,i.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(n))})},fc={get SUPPORT_RANGE_BOUNDS(){var n=P2e(document);return Object.defineProperty(fc,"SUPPORT_RANGE_BOUNDS",{value:n}),n},get SUPPORT_WORD_BREAKING(){var n=fc.SUPPORT_RANGE_BOUNDS&&N2e(document);return Object.defineProperty(fc,"SUPPORT_WORD_BREAKING",{value:n}),n},get SUPPORT_SVG_DRAWING(){var n=R2e(document);return Object.defineProperty(fc,"SUPPORT_SVG_DRAWING",{value:n}),n},get SUPPORT_FOREIGNOBJECT_DRAWING(){var n=typeof Array.from=="function"&&typeof window.fetch=="function"?U2e(document):Promise.resolve(!1);return Object.defineProperty(fc,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:n}),n},get SUPPORT_CORS_IMAGES(){var n=L2e();return Object.defineProperty(fc,"SUPPORT_CORS_IMAGES",{value:n}),n},get SUPPORT_RESPONSE_TYPE(){var n=M2e();return Object.defineProperty(fc,"SUPPORT_RESPONSE_TYPE",{value:n}),n},get SUPPORT_CORS_XHR(){var n="withCredentials"in new XMLHttpRequest;return Object.defineProperty(fc,"SUPPORT_CORS_XHR",{value:n}),n},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var n=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(fc,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:n}),n}},rw=(function(){function n(e,t){this.text=e,this.bounds=t}return n})(),O2e=function(n,e,t,i){var r=z2e(e,t),s=[],o=0;return r.forEach(function(a){if(t.textDecorationLine.length||a.trim().length>0)if(fc.SUPPORT_RANGE_BOUNDS){var l=UL(i,o,a.length).getClientRects();if(l.length>1){var h=qk(a),u=0;h.forEach(function(A){s.push(new rw(A,_f.fromDOMRectList(n,UL(i,u+o,A.length).getClientRects()))),u+=A.length})}else s.push(new rw(a,_f.fromDOMRectList(n,l)))}else{var d=i.splitText(a.length);s.push(new rw(a,H2e(n,i))),i=d}else fc.SUPPORT_RANGE_BOUNDS||(i=i.splitText(a.length));o+=a.length}),s},H2e=function(n,e){var t=e.ownerDocument;if(t){var i=t.createElement("html2canvaswrapper");i.appendChild(e.cloneNode(!0));var r=e.parentNode;if(r){r.replaceChild(i,e);var s=z5(n,i);return i.firstChild&&r.replaceChild(i.firstChild,i),s}}return _f.EMPTY},UL=function(n,e,t){var i=n.ownerDocument;if(!i)throw new Error("Node has no owner document");var r=i.createRange();return r.setStart(n,e),r.setEnd(n,e+t),r},qk=function(n){if(fc.SUPPORT_NATIVE_TEXT_SEGMENTATION){var e=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(e.segment(n)).map(function(t){return t.segment})}return j2e(n)},W2e=function(n,e){if(fc.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(t.segment(n)).map(function(i){return i.segment})}return $2e(n,e)},z2e=function(n,e){return e.letterSpacing!==0?qk(n):W2e(n,e)},Q2e=[32,160,4961,65792,65793,4153,4241],$2e=function(n,e){for(var t=y0e(n,{lineBreak:e.lineBreak,wordBreak:e.overflowWrap==="break-word"?"break-word":e.wordBreak}),i=[],r,s=function(){if(r.value){var o=r.value.slice(),a=Q5(o),l="";a.forEach(function(h){Q2e.indexOf(h)===-1?l+=tl(h):(l.length&&i.push(l),i.push(tl(h)),l="")}),l.length&&i.push(l)}};!(r=t.next()).done;)s();return i},V2e=(function(){function n(e,t,i){this.text=G2e(t.data,i.textTransform),this.textBounds=O2e(e,this.text,i,t)}return n})(),G2e=function(n,e){switch(e){case 1:return n.toLowerCase();case 3:return n.replace(X2e,Y2e);case 2:return n.toUpperCase();default:return n}},X2e=/(^|\s|:|-|\(|\))([a-z])/g,Y2e=function(n,e,t){return n.length>0?e+t.toUpperCase():n},vV=(function(n){Nd(e,n);function e(t,i){var r=n.call(this,t,i)||this;return r.src=i.currentSrc||i.src,r.intrinsicWidth=i.naturalWidth,r.intrinsicHeight=i.naturalHeight,r.context.cache.addImage(r.src),r}return e})(_A),xV=(function(n){Nd(e,n);function e(t,i){var r=n.call(this,t,i)||this;return r.canvas=i,r.intrinsicWidth=i.width,r.intrinsicHeight=i.height,r}return e})(_A),bV=(function(n){Nd(e,n);function e(t,i){var r=n.call(this,t,i)||this,s=new XMLSerializer,o=z5(t,i);return i.setAttribute("width",o.width+"px"),i.setAttribute("height",o.height+"px"),r.svg="data:image/svg+xml,"+encodeURIComponent(s.serializeToString(i)),r.intrinsicWidth=i.width.baseVal.value,r.intrinsicHeight=i.height.baseVal.value,r.context.cache.addImage(r.svg),r}return e})(_A),CV=(function(n){Nd(e,n);function e(t,i){var r=n.call(this,t,i)||this;return r.value=i.value,r}return e})(_A),i6=(function(n){Nd(e,n);function e(t,i){var r=n.call(this,t,i)||this;return r.start=i.start,r.reversed=typeof i.reversed=="boolean"&&i.reversed===!0,r}return e})(_A),K2e=[{type:15,flags:0,unit:"px",number:3}],q2e=[{type:16,flags:0,number:50}],Z2e=function(n){return n.width>n.height?new _f(n.left+(n.width-n.height)/2,n.top,n.height,n.height):n.width<n.height?new _f(n.left,n.top+(n.height-n.width)/2,n.width,n.width):n},J2e=function(n){var e=n.type===eye?new Array(n.value.length+1).join("•"):n.value;return e.length===0?n.placeholder||"":e},g_="checkbox",m_="radio",eye="password",OL=707406591,Zk=(function(n){Nd(e,n);function e(t,i){var r=n.call(this,t,i)||this;switch(r.type=i.type.toLowerCase(),r.checked=i.checked,r.value=J2e(i),(r.type===g_||r.type===m_)&&(r.styles.backgroundColor=3739148031,r.styles.borderTopColor=r.styles.borderRightColor=r.styles.borderBottomColor=r.styles.borderLeftColor=2779096575,r.styles.borderTopWidth=r.styles.borderRightWidth=r.styles.borderBottomWidth=r.styles.borderLeftWidth=1,r.styles.borderTopStyle=r.styles.borderRightStyle=r.styles.borderBottomStyle=r.styles.borderLeftStyle=1,r.styles.backgroundClip=[0],r.styles.backgroundOrigin=[0],r.bounds=Z2e(r.bounds)),r.type){case g_:r.styles.borderTopRightRadius=r.styles.borderTopLeftRadius=r.styles.borderBottomRightRadius=r.styles.borderBottomLeftRadius=K2e;break;case m_:r.styles.borderTopRightRadius=r.styles.borderTopLeftRadius=r.styles.borderBottomRightRadius=r.styles.borderBottomLeftRadius=q2e;break}return r}return e})(_A),_V=(function(n){Nd(e,n);function e(t,i){var r=n.call(this,t,i)||this,s=i.options[i.selectedIndex||0];return r.value=s&&s.text||"",r}return e})(_A),SV=(function(n){Nd(e,n);function e(t,i){var r=n.call(this,t,i)||this;return r.value=i.value,r}return e})(_A),TV=(function(n){Nd(e,n);function e(t,i){var r=n.call(this,t,i)||this;r.src=i.src,r.width=parseInt(i.width,10)||0,r.height=parseInt(i.height,10)||0,r.backgroundColor=r.styles.backgroundColor;try{if(i.contentWindow&&i.contentWindow.document&&i.contentWindow.document.documentElement){r.tree=EV(t,i.contentWindow.document.documentElement);var s=i.contentWindow.document.documentElement?nw(t,getComputedStyle(i.contentWindow.document.documentElement).backgroundColor):ff.TRANSPARENT,o=i.contentWindow.document.body?nw(t,getComputedStyle(i.contentWindow.document.body).backgroundColor):ff.TRANSPARENT;r.backgroundColor=Fp(s)?Fp(o)?r.styles.backgroundColor:o:s}}catch{}return r}return e})(_A),tye=["OL","UL","MENU"],dC=function(n,e,t,i){for(var r=e.firstChild,s=void 0;r;r=s)if(s=r.nextSibling,FV(r)&&r.data.trim().length>0)t.textNodes.push(new V2e(n,r,t.styles));else if(Cm(r))if(jV(r)&&r.assignedNodes)r.assignedNodes().forEach(function(a){return dC(n,a,t,i)});else{var o=BV(n,r);o.styles.isVisible()&&(nye(r,o,i)?o.flags|=4:iye(o.styles)&&(o.flags|=2),tye.indexOf(r.tagName)!==-1&&(o.flags|=8),t.elements.push(o),r.slot,r.shadowRoot?dC(n,r.shadowRoot,o,i):!y_(r)&&!kV(r)&&!w_(r)&&dC(n,r,o,i))}},BV=function(n,e){return s6(e)?new vV(n,e):IV(e)?new xV(n,e):kV(e)?new bV(n,e):rye(e)?new CV(n,e):sye(e)?new i6(n,e):oye(e)?new Zk(n,e):w_(e)?new _V(n,e):y_(e)?new SV(n,e):DV(e)?new TV(n,e):new _A(n,e)},EV=function(n,e){var t=BV(n,e);return t.flags|=4,dC(n,e,t,t),t},nye=function(n,e,t){return e.styles.isPositionedWithZIndex()||e.styles.opacity<1||e.styles.isTransformed()||Jk(n)&&t.styles.isTransparent()},iye=function(n){return n.isPositioned()||n.isFloating()},FV=function(n){return n.nodeType===Node.TEXT_NODE},Cm=function(n){return n.nodeType===Node.ELEMENT_NODE},r6=function(n){return Cm(n)&&typeof n.style<"u"&&!AC(n)},AC=function(n){return typeof n.className=="object"},rye=function(n){return n.tagName==="LI"},sye=function(n){return n.tagName==="OL"},oye=function(n){return n.tagName==="INPUT"},aye=function(n){return n.tagName==="HTML"},kV=function(n){return n.tagName==="svg"},Jk=function(n){return n.tagName==="BODY"},IV=function(n){return n.tagName==="CANVAS"},HL=function(n){return n.tagName==="VIDEO"},s6=function(n){return n.tagName==="IMG"},DV=function(n){return n.tagName==="IFRAME"},WL=function(n){return n.tagName==="STYLE"},lye=function(n){return n.tagName==="SCRIPT"},y_=function(n){return n.tagName==="TEXTAREA"},w_=function(n){return n.tagName==="SELECT"},jV=function(n){return n.tagName==="SLOT"},zL=function(n){return n.tagName.indexOf("-")>0},cye=(function(){function n(){this.counters={}}return n.prototype.getCounterValue=function(e){var t=this.counters[e];return t&&t.length?t[t.length-1]:1},n.prototype.getCounterValues=function(e){var t=this.counters[e];return t||[]},n.prototype.pop=function(e){var t=this;e.forEach(function(i){return t.counters[i].pop()})},n.prototype.parse=function(e){var t=this,i=e.counterIncrement,r=e.counterReset,s=!0;i!==null&&i.forEach(function(a){var l=t.counters[a.counter];l&&a.increment!==0&&(s=!1,l.length||l.push(1),l[Math.max(0,l.length-1)]+=a.increment)});var o=[];return s&&r.forEach(function(a){var l=t.counters[a.counter];o.push(a.counter),l||(l=t.counters[a.counter]=[]),l.push(a.reset)}),o},n})(),QL={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},$L={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["Ք","Փ","Ւ","Ց","Ր","Տ","Վ","Ս","Ռ","Ջ","Պ","Չ","Ո","Շ","Ն","Յ","Մ","Ճ","Ղ","Ձ","Հ","Կ","Ծ","Խ","Լ","Ի","Ժ","Թ","Ը","Է","Զ","Ե","Դ","Գ","Բ","Ա"]},hye={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["י׳","ט׳","ח׳","ז׳","ו׳","ה׳","ד׳","ג׳","ב׳","א׳","ת","ש","ר","ק","צ","פ","ע","ס","נ","מ","ל","כ","יט","יח","יז","טז","טו","י","ט","ח","ז","ו","ה","ד","ג","ב","א"]},uye={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["ჵ","ჰ","ჯ","ჴ","ხ","ჭ","წ","ძ","ც","ჩ","შ","ყ","ღ","ქ","ფ","ჳ","ტ","ს","რ","ჟ","პ","ო","ჲ","ნ","მ","ლ","კ","ი","თ","ჱ","ზ","ვ","ე","დ","გ","ბ","ა"]},G0=function(n,e,t,i,r,s){return n<e||n>t?Uw(n,r,s.length>0):i.integers.reduce(function(o,a,l){for(;n>=a;)n-=a,o+=i.values[l];return o},"")+s},PV=function(n,e,t,i){var r="";do t||n--,r=i(n)+r,n/=e;while(n*e>=e);return r},Za=function(n,e,t,i,r){var s=t-e+1;return(n<0?"-":"")+(PV(Math.abs(n),s,i,function(o){return tl(Math.floor(o%s)+e)})+r)},yg=function(n,e,t){t===void 0&&(t=". ");var i=e.length;return PV(Math.abs(n),i,!1,function(r){return e[Math.floor(r%i)]})+t},fm=1,sp=2,op=4,Sy=8,QA=function(n,e,t,i,r,s){if(n<-9999||n>9999)return Uw(n,4,r.length>0);var o=Math.abs(n),a=r;if(o===0)return e[0]+a;for(var l=0;o>0&&l<=4;l++){var h=o%10;h===0&&Il(s,fm)&&a!==""?a=e[h]+a:h>1||h===1&&l===0||h===1&&l===1&&Il(s,sp)||h===1&&l===1&&Il(s,op)&&n>100||h===1&&l>1&&Il(s,Sy)?a=e[h]+(l>0?t[l-1]:"")+a:h===1&&l>0&&(a=t[l-1]+a),o=Math.floor(o/10)}return(n<0?i:"")+a},VL="十百千萬",GL="拾佰仟萬",XL="マイナス",S4="마이너스",Uw=function(n,e,t){var i=t?". ":"",r=t?"、":"",s=t?", ":"",o=t?" ":"";switch(e){case 0:return"•"+o;case 1:return"◦"+o;case 2:return"◾"+o;case 5:var a=Za(n,48,57,!0,i);return a.length<4?"0"+a:a;case 4:return yg(n,"〇一二三四五六七八九",r);case 6:return G0(n,1,3999,QL,3,i).toLowerCase();case 7:return G0(n,1,3999,QL,3,i);case 8:return Za(n,945,969,!1,i);case 9:return Za(n,97,122,!1,i);case 10:return Za(n,65,90,!1,i);case 11:return Za(n,1632,1641,!0,i);case 12:case 49:return G0(n,1,9999,$L,3,i);case 35:return G0(n,1,9999,$L,3,i).toLowerCase();case 13:return Za(n,2534,2543,!0,i);case 14:case 30:return Za(n,6112,6121,!0,i);case 15:return yg(n,"子丑寅卯辰巳午未申酉戌亥",r);case 16:return yg(n,"甲乙丙丁戊己庚辛壬癸",r);case 17:case 48:return QA(n,"零一二三四五六七八九",VL,"負",r,sp|op|Sy);case 47:return QA(n,"零壹貳參肆伍陸柒捌玖",GL,"負",r,fm|sp|op|Sy);case 42:return QA(n,"零一二三四五六七八九",VL,"负",r,sp|op|Sy);case 41:return QA(n,"零壹贰叁肆伍陆柒捌玖",GL,"负",r,fm|sp|op|Sy);case 26:return QA(n,"〇一二三四五六七八九","十百千万",XL,r,0);case 25:return QA(n,"零壱弐参四伍六七八九","拾百千万",XL,r,fm|sp|op);case 31:return QA(n,"영일이삼사오육칠팔구","십백천만",S4,s,fm|sp|op);case 33:return QA(n,"零一二三四五六七八九","十百千萬",S4,s,0);case 32:return QA(n,"零壹貳參四五六七八九","拾百千",S4,s,fm|sp|op);case 18:return Za(n,2406,2415,!0,i);case 20:return G0(n,1,19999,uye,3,i);case 21:return Za(n,2790,2799,!0,i);case 22:return Za(n,2662,2671,!0,i);case 22:return G0(n,1,10999,hye,3,i);case 23:return yg(n,"あいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむめもやゆよらりるれろわゐゑをん");case 24:return yg(n,"いろはにほへとちりぬるをわかよたれそつねならむうゐのおくやまけふこえてあさきゆめみしゑひもせす");case 27:return Za(n,3302,3311,!0,i);case 28:return yg(n,"アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヰヱヲン",r);case 29:return yg(n,"イロハニホヘトチリヌルヲワカヨタレソツネナラムウヰノオクヤマケフコエテアサキユメミシヱヒモセス",r);case 34:return Za(n,3792,3801,!0,i);case 37:return Za(n,6160,6169,!0,i);case 38:return Za(n,4160,4169,!0,i);case 39:return Za(n,2918,2927,!0,i);case 40:return Za(n,1776,1785,!0,i);case 43:return Za(n,3046,3055,!0,i);case 44:return Za(n,3174,3183,!0,i);case 45:return Za(n,3664,3673,!0,i);case 46:return Za(n,3872,3881,!0,i);case 3:default:return Za(n,48,57,!0,i)}},NV="data-html2canvas-ignore",YL=(function(){function n(e,t,i){if(this.context=e,this.options=i,this.scrolledElements=[],this.referenceElement=t,this.counters=new cye,this.quoteDepth=0,!t.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(t.ownerDocument.documentElement,!1)}return n.prototype.toIFrame=function(e,t){var i=this,r=dye(e,t);if(!r.contentWindow)return Promise.reject("Unable to find iframe window");var s=e.defaultView.pageXOffset,o=e.defaultView.pageYOffset,a=r.contentWindow,l=a.document,h=pye(r).then(function(){return ih(i,void 0,void 0,function(){var u,d;return Rc(this,function(A){switch(A.label){case 0:return this.scrolledElements.forEach(wye),a&&(a.scrollTo(t.left,t.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(a.scrollY!==t.top||a.scrollX!==t.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(a.scrollX-t.left,a.scrollY-t.top,0,0))),u=this.options.onclone,d=this.clonedReferenceElement,typeof d>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:l.fonts&&l.fonts.ready?[4,l.fonts.ready]:[3,2];case 1:A.sent(),A.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,fye(l)]:[3,4];case 3:A.sent(),A.label=4;case 4:return typeof u=="function"?[2,Promise.resolve().then(function(){return u(l,d)}).then(function(){return r})]:[2,r]}})})});return l.open(),l.write(mye(document.doctype)+"<html></html>"),yye(this.referenceElement.ownerDocument,s,o),l.replaceChild(l.adoptNode(this.documentElement),l.documentElement),l.close(),h},n.prototype.createElementClone=function(e){if(t6(e,2))debugger;if(IV(e))return this.createCanvasClone(e);if(HL(e))return this.createVideoClone(e);if(WL(e))return this.createStyleClone(e);var t=e.cloneNode(!1);return s6(t)&&(s6(e)&&e.currentSrc&&e.currentSrc!==e.src&&(t.src=e.currentSrc,t.srcset=""),t.loading==="lazy"&&(t.loading="eager")),zL(t)?this.createCustomElementClone(t):t},n.prototype.createCustomElementClone=function(e){var t=document.createElement("html2canvascustomelement");return T4(e.style,t),t},n.prototype.createStyleClone=function(e){try{var t=e.sheet;if(t&&t.cssRules){var i=[].slice.call(t.cssRules,0).reduce(function(s,o){return o&&typeof o.cssText=="string"?s+o.cssText:s},""),r=e.cloneNode(!1);return r.textContent=i,r}}catch(s){if(this.context.logger.error("Unable to access cssRules property",s),s.name!=="SecurityError")throw s}return e.cloneNode(!1)},n.prototype.createCanvasClone=function(e){var t;if(this.options.inlineImages&&e.ownerDocument){var i=e.ownerDocument.createElement("img");try{return i.src=e.toDataURL(),i}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",e)}}var r=e.cloneNode(!1);try{r.width=e.width,r.height=e.height;var s=e.getContext("2d"),o=r.getContext("2d");if(o)if(!this.options.allowTaint&&s)o.putImageData(s.getImageData(0,0,e.width,e.height),0,0);else{var a=(t=e.getContext("webgl2"))!==null&&t!==void 0?t:e.getContext("webgl");if(a){var l=a.getContextAttributes();(l==null?void 0:l.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",e)}o.drawImage(e,0,0)}return r}catch{this.context.logger.info("Unable to clone canvas as it is tainted",e)}return r},n.prototype.createVideoClone=function(e){var t=e.ownerDocument.createElement("canvas");t.width=e.offsetWidth,t.height=e.offsetHeight;var i=t.getContext("2d");try{return i&&(i.drawImage(e,0,0,t.width,t.height),this.options.allowTaint||i.getImageData(0,0,t.width,t.height)),t}catch{this.context.logger.info("Unable to clone video as it is tainted",e)}var r=e.ownerDocument.createElement("canvas");return r.width=e.offsetWidth,r.height=e.offsetHeight,r},n.prototype.appendChildNode=function(e,t,i){(!Cm(t)||!lye(t)&&!t.hasAttribute(NV)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(t)))&&(!this.options.copyStyles||!Cm(t)||!WL(t))&&e.appendChild(this.cloneNode(t,i))},n.prototype.cloneChildNodes=function(e,t,i){for(var r=this,s=e.shadowRoot?e.shadowRoot.firstChild:e.firstChild;s;s=s.nextSibling)if(Cm(s)&&jV(s)&&typeof s.assignedNodes=="function"){var o=s.assignedNodes();o.length&&o.forEach(function(a){return r.appendChildNode(t,a,i)})}else this.appendChildNode(t,s,i)},n.prototype.cloneNode=function(e,t){if(FV(e))return document.createTextNode(e.data);if(!e.ownerDocument)return e.cloneNode(!1);var i=e.ownerDocument.defaultView;if(i&&Cm(e)&&(r6(e)||AC(e))){var r=this.createElementClone(e);r.style.transitionProperty="none";var s=i.getComputedStyle(e),o=i.getComputedStyle(e,":before"),a=i.getComputedStyle(e,":after");this.referenceElement===e&&r6(r)&&(this.clonedReferenceElement=r),Jk(r)&&bye(r);var l=this.counters.parse(new TL(this.context,s)),h=this.resolvePseudoContent(e,r,o,sw.BEFORE);zL(e)&&(t=!0),HL(e)||this.cloneChildNodes(e,r,t),h&&r.insertBefore(h,r.firstChild);var u=this.resolvePseudoContent(e,r,a,sw.AFTER);return u&&r.appendChild(u),this.counters.pop(l),(s&&(this.options.copyStyles||AC(e))&&!DV(e)||t)&&T4(s,r),(e.scrollTop!==0||e.scrollLeft!==0)&&this.scrolledElements.push([r,e.scrollLeft,e.scrollTop]),(y_(e)||w_(e))&&(y_(r)||w_(r))&&(r.value=e.value),r}return e.cloneNode(!1)},n.prototype.resolvePseudoContent=function(e,t,i,r){var s=this;if(i){var o=i.content,a=t.ownerDocument;if(!(!a||!o||o==="none"||o==="-moz-alt-content"||i.display==="none")){this.counters.parse(new TL(this.context,i));var l=new r2e(this.context,i),h=a.createElement("html2canvaspseudoelement");T4(i,h),l.content.forEach(function(d){if(d.type===0)h.appendChild(a.createTextNode(d.value));else if(d.type===22){var A=a.createElement("img");A.src=d.value,A.style.opacity="1",h.appendChild(A)}else if(d.type===18){if(d.name==="attr"){var f=d.values.filter(So);f.length&&h.appendChild(a.createTextNode(e.getAttribute(f[0].value)||""))}else if(d.name==="counter"){var p=d.values.filter(u1),g=p[0],v=p[1];if(g&&So(g)){var w=s.counters.getCounterValue(g.value),m=v&&So(v)?e6.parse(s.context,v.value):3;h.appendChild(a.createTextNode(Uw(w,m,!1)))}}else if(d.name==="counters"){var y=d.values.filter(u1),g=y[0],x=y[1],v=y[2];if(g&&So(g)){var S=s.counters.getCounterValues(g.value),I=v&&So(v)?e6.parse(s.context,v.value):3,j=x&&x.type===0?x.value:"",C=S.map(function(T){return Uw(T,I,!1)}).join(j);h.appendChild(a.createTextNode(C))}}}else if(d.type===20)switch(d.value){case"open-quote":h.appendChild(a.createTextNode(SL(l.quotes,s.quoteDepth++,!0)));break;case"close-quote":h.appendChild(a.createTextNode(SL(l.quotes,--s.quoteDepth,!1)));break;default:h.appendChild(a.createTextNode(d.value))}}),h.className=o6+" "+a6;var u=r===sw.BEFORE?" "+o6:" "+a6;return AC(t)?t.className.baseValue+=u:t.className+=u,h}}},n.destroy=function(e){return e.parentNode?(e.parentNode.removeChild(e),!0):!1},n})(),sw;(function(n){n[n.BEFORE=0]="BEFORE",n[n.AFTER=1]="AFTER"})(sw||(sw={}));var dye=function(n,e){var t=n.createElement("iframe");return t.className="html2canvas-container",t.style.visibility="hidden",t.style.position="fixed",t.style.left="-10000px",t.style.top="0px",t.style.border="0",t.width=e.width.toString(),t.height=e.height.toString(),t.scrolling="no",t.setAttribute(NV,"true"),n.body.appendChild(t),t},Aye=function(n){return new Promise(function(e){if(n.complete){e();return}if(!n.src){e();return}n.onload=e,n.onerror=e})},fye=function(n){return Promise.all([].slice.call(n.images,0).map(Aye))},pye=function(n){return new Promise(function(e,t){var i=n.contentWindow;if(!i)return t("No window assigned for iframe");var r=i.document;i.onload=n.onload=function(){i.onload=n.onload=null;var s=setInterval(function(){r.body.childNodes.length>0&&r.readyState==="complete"&&(clearInterval(s),e(n))},50)}})},gye=["all","d","content"],T4=function(n,e){for(var t=n.length-1;t>=0;t--){var i=n.item(t);gye.indexOf(i)===-1&&e.style.setProperty(i,n.getPropertyValue(i))}return e},mye=function(n){var e="";return n&&(e+="<!DOCTYPE ",n.name&&(e+=n.name),n.internalSubset&&(e+=n.internalSubset),n.publicId&&(e+='"'+n.publicId+'"'),n.systemId&&(e+='"'+n.systemId+'"'),e+=">"),e},yye=function(n,e,t){n&&n.defaultView&&(e!==n.defaultView.pageXOffset||t!==n.defaultView.pageYOffset)&&n.defaultView.scrollTo(e,t)},wye=function(n){var e=n[0],t=n[1],i=n[2];e.scrollLeft=t,e.scrollTop=i},vye=":before",xye=":after",o6="___html2canvas___pseudoelement_before",a6="___html2canvas___pseudoelement_after",KL=`{
    content: "" !important;
    display: none !important;
}`,bye=function(n){Cye(n,"."+o6+vye+KL+`
         .`+a6+xye+KL)},Cye=function(n,e){var t=n.ownerDocument;if(t){var i=t.createElement("style");i.textContent=e,n.appendChild(i)}},LV=(function(){function n(){}return n.getOrigin=function(e){var t=n._link;return t?(t.href=e,t.href=t.href,t.protocol+t.hostname+t.port):"about:blank"},n.isSameOrigin=function(e){return n.getOrigin(e)===n._origin},n.setContext=function(e){n._link=e.document.createElement("a"),n._origin=n.getOrigin(e.location.href)},n._origin="about:blank",n})(),_ye=(function(){function n(e,t){this.context=e,this._options=t,this._cache={}}return n.prototype.addImage=function(e){var t=Promise.resolve();return this.has(e)||(E4(e)||Eye(e))&&(this._cache[e]=this.loadImage(e)).catch(function(){}),t},n.prototype.match=function(e){return this._cache[e]},n.prototype.loadImage=function(e){return ih(this,void 0,void 0,function(){var t,i,r,s,o=this;return Rc(this,function(a){switch(a.label){case 0:return t=LV.isSameOrigin(e),i=!B4(e)&&this._options.useCORS===!0&&fc.SUPPORT_CORS_IMAGES&&!t,r=!B4(e)&&!t&&!E4(e)&&typeof this._options.proxy=="string"&&fc.SUPPORT_CORS_XHR&&!i,!t&&this._options.allowTaint===!1&&!B4(e)&&!E4(e)&&!r&&!i?[2]:(s=e,r?[4,this.proxy(s)]:[3,2]);case 1:s=a.sent(),a.label=2;case 2:return this.context.logger.debug("Added image "+e.substring(0,256)),[4,new Promise(function(l,h){var u=new Image;u.onload=function(){return l(u)},u.onerror=h,(Fye(s)||i)&&(u.crossOrigin="anonymous"),u.src=s,u.complete===!0&&setTimeout(function(){return l(u)},500),o._options.imageTimeout>0&&setTimeout(function(){return h("Timed out ("+o._options.imageTimeout+"ms) loading image")},o._options.imageTimeout)})];case 3:return[2,a.sent()]}})})},n.prototype.has=function(e){return typeof this._cache[e]<"u"},n.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},n.prototype.proxy=function(e){var t=this,i=this._options.proxy;if(!i)throw new Error("No proxy defined");var r=e.substring(0,256);return new Promise(function(s,o){var a=fc.SUPPORT_RESPONSE_TYPE?"blob":"text",l=new XMLHttpRequest;l.onload=function(){if(l.status===200)if(a==="text")s(l.response);else{var d=new FileReader;d.addEventListener("load",function(){return s(d.result)},!1),d.addEventListener("error",function(A){return o(A)},!1),d.readAsDataURL(l.response)}else o("Failed to proxy resource "+r+" with status code "+l.status)},l.onerror=o;var h=i.indexOf("?")>-1?"&":"?";if(l.open("GET",""+i+h+"url="+encodeURIComponent(e)+"&responseType="+a),a!=="text"&&l instanceof XMLHttpRequest&&(l.responseType=a),t._options.imageTimeout){var u=t._options.imageTimeout;l.timeout=u,l.ontimeout=function(){return o("Timed out ("+u+"ms) proxying "+r)}}l.send()})},n})(),Sye=/^data:image\/svg\+xml/i,Tye=/^data:image\/.*;base64,/i,Bye=/^data:image\/.*/i,Eye=function(n){return fc.SUPPORT_SVG_DRAWING||!kye(n)},B4=function(n){return Bye.test(n)},Fye=function(n){return Tye.test(n)},E4=function(n){return n.substr(0,4)==="blob"},kye=function(n){return n.substr(-3).toLowerCase()==="svg"||Sye.test(n)},Ti=(function(){function n(e,t){this.type=0,this.x=e,this.y=t}return n.prototype.add=function(e,t){return new n(this.x+e,this.y+t)},n})(),X0=function(n,e,t){return new Ti(n.x+(e.x-n.x)*t,n.y+(e.y-n.y)*t)},ob=(function(){function n(e,t,i,r){this.type=1,this.start=e,this.startControl=t,this.endControl=i,this.end=r}return n.prototype.subdivide=function(e,t){var i=X0(this.start,this.startControl,e),r=X0(this.startControl,this.endControl,e),s=X0(this.endControl,this.end,e),o=X0(i,r,e),a=X0(r,s,e),l=X0(o,a,e);return t?new n(this.start,i,o,l):new n(l,a,s,this.end)},n.prototype.add=function(e,t){return new n(this.start.add(e,t),this.startControl.add(e,t),this.endControl.add(e,t),this.end.add(e,t))},n.prototype.reverse=function(){return new n(this.end,this.endControl,this.startControl,this.start)},n})(),Su=function(n){return n.type===1},Iye=(function(){function n(e){var t=e.styles,i=e.bounds,r=Cy(t.borderTopLeftRadius,i.width,i.height),s=r[0],o=r[1],a=Cy(t.borderTopRightRadius,i.width,i.height),l=a[0],h=a[1],u=Cy(t.borderBottomRightRadius,i.width,i.height),d=u[0],A=u[1],f=Cy(t.borderBottomLeftRadius,i.width,i.height),p=f[0],g=f[1],v=[];v.push((s+l)/i.width),v.push((p+d)/i.width),v.push((o+g)/i.height),v.push((h+A)/i.height);var w=Math.max.apply(Math,v);w>1&&(s/=w,o/=w,l/=w,h/=w,d/=w,A/=w,p/=w,g/=w);var m=i.width-l,y=i.height-A,x=i.width-d,S=i.height-g,I=t.borderTopWidth,j=t.borderRightWidth,C=t.borderBottomWidth,b=t.borderLeftWidth,D=Qo(t.paddingTop,e.bounds.width),T=Qo(t.paddingRight,e.bounds.width),k=Qo(t.paddingBottom,e.bounds.width),B=Qo(t.paddingLeft,e.bounds.width);this.topLeftBorderDoubleOuterBox=s>0||o>0?aa(i.left+b/3,i.top+I/3,s-b/3,o-I/3,co.TOP_LEFT):new Ti(i.left+b/3,i.top+I/3),this.topRightBorderDoubleOuterBox=s>0||o>0?aa(i.left+m,i.top+I/3,l-j/3,h-I/3,co.TOP_RIGHT):new Ti(i.left+i.width-j/3,i.top+I/3),this.bottomRightBorderDoubleOuterBox=d>0||A>0?aa(i.left+x,i.top+y,d-j/3,A-C/3,co.BOTTOM_RIGHT):new Ti(i.left+i.width-j/3,i.top+i.height-C/3),this.bottomLeftBorderDoubleOuterBox=p>0||g>0?aa(i.left+b/3,i.top+S,p-b/3,g-C/3,co.BOTTOM_LEFT):new Ti(i.left+b/3,i.top+i.height-C/3),this.topLeftBorderDoubleInnerBox=s>0||o>0?aa(i.left+b*2/3,i.top+I*2/3,s-b*2/3,o-I*2/3,co.TOP_LEFT):new Ti(i.left+b*2/3,i.top+I*2/3),this.topRightBorderDoubleInnerBox=s>0||o>0?aa(i.left+m,i.top+I*2/3,l-j*2/3,h-I*2/3,co.TOP_RIGHT):new Ti(i.left+i.width-j*2/3,i.top+I*2/3),this.bottomRightBorderDoubleInnerBox=d>0||A>0?aa(i.left+x,i.top+y,d-j*2/3,A-C*2/3,co.BOTTOM_RIGHT):new Ti(i.left+i.width-j*2/3,i.top+i.height-C*2/3),this.bottomLeftBorderDoubleInnerBox=p>0||g>0?aa(i.left+b*2/3,i.top+S,p-b*2/3,g-C*2/3,co.BOTTOM_LEFT):new Ti(i.left+b*2/3,i.top+i.height-C*2/3),this.topLeftBorderStroke=s>0||o>0?aa(i.left+b/2,i.top+I/2,s-b/2,o-I/2,co.TOP_LEFT):new Ti(i.left+b/2,i.top+I/2),this.topRightBorderStroke=s>0||o>0?aa(i.left+m,i.top+I/2,l-j/2,h-I/2,co.TOP_RIGHT):new Ti(i.left+i.width-j/2,i.top+I/2),this.bottomRightBorderStroke=d>0||A>0?aa(i.left+x,i.top+y,d-j/2,A-C/2,co.BOTTOM_RIGHT):new Ti(i.left+i.width-j/2,i.top+i.height-C/2),this.bottomLeftBorderStroke=p>0||g>0?aa(i.left+b/2,i.top+S,p-b/2,g-C/2,co.BOTTOM_LEFT):new Ti(i.left+b/2,i.top+i.height-C/2),this.topLeftBorderBox=s>0||o>0?aa(i.left,i.top,s,o,co.TOP_LEFT):new Ti(i.left,i.top),this.topRightBorderBox=l>0||h>0?aa(i.left+m,i.top,l,h,co.TOP_RIGHT):new Ti(i.left+i.width,i.top),this.bottomRightBorderBox=d>0||A>0?aa(i.left+x,i.top+y,d,A,co.BOTTOM_RIGHT):new Ti(i.left+i.width,i.top+i.height),this.bottomLeftBorderBox=p>0||g>0?aa(i.left,i.top+S,p,g,co.BOTTOM_LEFT):new Ti(i.left,i.top+i.height),this.topLeftPaddingBox=s>0||o>0?aa(i.left+b,i.top+I,Math.max(0,s-b),Math.max(0,o-I),co.TOP_LEFT):new Ti(i.left+b,i.top+I),this.topRightPaddingBox=l>0||h>0?aa(i.left+Math.min(m,i.width-j),i.top+I,m>i.width+j?0:Math.max(0,l-j),Math.max(0,h-I),co.TOP_RIGHT):new Ti(i.left+i.width-j,i.top+I),this.bottomRightPaddingBox=d>0||A>0?aa(i.left+Math.min(x,i.width-b),i.top+Math.min(y,i.height-C),Math.max(0,d-j),Math.max(0,A-C),co.BOTTOM_RIGHT):new Ti(i.left+i.width-j,i.top+i.height-C),this.bottomLeftPaddingBox=p>0||g>0?aa(i.left+b,i.top+Math.min(S,i.height-C),Math.max(0,p-b),Math.max(0,g-C),co.BOTTOM_LEFT):new Ti(i.left+b,i.top+i.height-C),this.topLeftContentBox=s>0||o>0?aa(i.left+b+B,i.top+I+D,Math.max(0,s-(b+B)),Math.max(0,o-(I+D)),co.TOP_LEFT):new Ti(i.left+b+B,i.top+I+D),this.topRightContentBox=l>0||h>0?aa(i.left+Math.min(m,i.width+b+B),i.top+I+D,m>i.width+b+B?0:l-b+B,h-(I+D),co.TOP_RIGHT):new Ti(i.left+i.width-(j+T),i.top+I+D),this.bottomRightContentBox=d>0||A>0?aa(i.left+Math.min(x,i.width-(b+B)),i.top+Math.min(y,i.height+I+D),Math.max(0,d-(j+T)),A-(C+k),co.BOTTOM_RIGHT):new Ti(i.left+i.width-(j+T),i.top+i.height-(C+k)),this.bottomLeftContentBox=p>0||g>0?aa(i.left+b+B,i.top+S,Math.max(0,p-(b+B)),g-(C+k),co.BOTTOM_LEFT):new Ti(i.left+b+B,i.top+i.height-(C+k))}return n})(),co;(function(n){n[n.TOP_LEFT=0]="TOP_LEFT",n[n.TOP_RIGHT=1]="TOP_RIGHT",n[n.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",n[n.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(co||(co={}));var aa=function(n,e,t,i,r){var s=4*((Math.sqrt(2)-1)/3),o=t*s,a=i*s,l=n+t,h=e+i;switch(r){case co.TOP_LEFT:return new ob(new Ti(n,h),new Ti(n,h-a),new Ti(l-o,e),new Ti(l,e));case co.TOP_RIGHT:return new ob(new Ti(n,e),new Ti(n+o,e),new Ti(l,h-a),new Ti(l,h));case co.BOTTOM_RIGHT:return new ob(new Ti(l,e),new Ti(l,e+a),new Ti(n+o,h),new Ti(n,h));case co.BOTTOM_LEFT:default:return new ob(new Ti(l,h),new Ti(l-o,h),new Ti(n,e+a),new Ti(n,e))}},v_=function(n){return[n.topLeftBorderBox,n.topRightBorderBox,n.bottomRightBorderBox,n.bottomLeftBorderBox]},Dye=function(n){return[n.topLeftContentBox,n.topRightContentBox,n.bottomRightContentBox,n.bottomLeftContentBox]},x_=function(n){return[n.topLeftPaddingBox,n.topRightPaddingBox,n.bottomRightPaddingBox,n.bottomLeftPaddingBox]},jye=(function(){function n(e,t,i){this.offsetX=e,this.offsetY=t,this.matrix=i,this.type=0,this.target=6}return n})(),ab=(function(){function n(e,t){this.path=e,this.target=t,this.type=1}return n})(),Pye=(function(){function n(e){this.opacity=e,this.type=2,this.target=6}return n})(),Nye=function(n){return n.type===0},MV=function(n){return n.type===1},Lye=function(n){return n.type===2},qL=function(n,e){return n.length===e.length?n.some(function(t,i){return t===e[i]}):!1},Mye=function(n,e,t,i,r){return n.map(function(s,o){switch(o){case 0:return s.add(e,t);case 1:return s.add(e+i,t);case 2:return s.add(e+i,t+r);case 3:return s.add(e,t+r)}return s})},RV=(function(){function n(e){this.element=e,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return n})(),UV=(function(){function n(e,t){if(this.container=e,this.parent=t,this.effects=[],this.curves=new Iye(this.container),this.container.styles.opacity<1&&this.effects.push(new Pye(this.container.styles.opacity)),this.container.styles.transform!==null){var i=this.container.bounds.left+this.container.styles.transformOrigin[0].number,r=this.container.bounds.top+this.container.styles.transformOrigin[1].number,s=this.container.styles.transform;this.effects.push(new jye(i,r,s))}if(this.container.styles.overflowX!==0){var o=v_(this.curves),a=x_(this.curves);qL(o,a)?this.effects.push(new ab(o,6)):(this.effects.push(new ab(o,2)),this.effects.push(new ab(a,4)))}}return n.prototype.getEffects=function(e){for(var t=[2,3].indexOf(this.container.styles.position)===-1,i=this.parent,r=this.effects.slice(0);i;){var s=i.effects.filter(function(l){return!MV(l)});if(t||i.container.styles.position!==0||!i.parent){if(r.unshift.apply(r,s),t=[2,3].indexOf(i.container.styles.position)===-1,i.container.styles.overflowX!==0){var o=v_(i.curves),a=x_(i.curves);qL(o,a)||r.unshift(new ab(a,6))}}else r.unshift.apply(r,s);i=i.parent}return r.filter(function(l){return Il(l.target,e)})},n})(),l6=function(n,e,t,i){n.container.elements.forEach(function(r){var s=Il(r.flags,4),o=Il(r.flags,2),a=new UV(r,n);Il(r.styles.display,2048)&&i.push(a);var l=Il(r.flags,8)?[]:i;if(s||o){var h=s||r.styles.isPositioned()?t:e,u=new RV(a);if(r.styles.isPositioned()||r.styles.opacity<1||r.styles.isTransformed()){var d=r.styles.zIndex.order;if(d<0){var A=0;h.negativeZIndex.some(function(p,g){return d>p.element.container.styles.zIndex.order?(A=g,!1):A>0}),h.negativeZIndex.splice(A,0,u)}else if(d>0){var f=0;h.positiveZIndex.some(function(p,g){return d>=p.element.container.styles.zIndex.order?(f=g+1,!1):f>0}),h.positiveZIndex.splice(f,0,u)}else h.zeroOrAutoZIndexOrTransformedOrOpacity.push(u)}else r.styles.isFloating()?h.nonPositionedFloats.push(u):h.nonPositionedInlineLevel.push(u);l6(a,u,s?u:t,l)}else r.styles.isInlineLevel()?e.inlineLevel.push(a):e.nonInlineLevel.push(a),l6(a,e,t,l);Il(r.flags,8)&&OV(r,l)})},OV=function(n,e){for(var t=n instanceof i6?n.start:1,i=n instanceof i6?n.reversed:!1,r=0;r<e.length;r++){var s=e[r];s.container instanceof CV&&typeof s.container.value=="number"&&s.container.value!==0&&(t=s.container.value),s.listValue=Uw(t,s.container.styles.listStyleType,!0),t+=i?-1:1}},Rye=function(n){var e=new UV(n,null),t=new RV(e),i=[];return l6(e,t,t,i),OV(e.container,i),t},ZL=function(n,e){switch(e){case 0:return ju(n.topLeftBorderBox,n.topLeftPaddingBox,n.topRightBorderBox,n.topRightPaddingBox);case 1:return ju(n.topRightBorderBox,n.topRightPaddingBox,n.bottomRightBorderBox,n.bottomRightPaddingBox);case 2:return ju(n.bottomRightBorderBox,n.bottomRightPaddingBox,n.bottomLeftBorderBox,n.bottomLeftPaddingBox);case 3:default:return ju(n.bottomLeftBorderBox,n.bottomLeftPaddingBox,n.topLeftBorderBox,n.topLeftPaddingBox)}},Uye=function(n,e){switch(e){case 0:return ju(n.topLeftBorderBox,n.topLeftBorderDoubleOuterBox,n.topRightBorderBox,n.topRightBorderDoubleOuterBox);case 1:return ju(n.topRightBorderBox,n.topRightBorderDoubleOuterBox,n.bottomRightBorderBox,n.bottomRightBorderDoubleOuterBox);case 2:return ju(n.bottomRightBorderBox,n.bottomRightBorderDoubleOuterBox,n.bottomLeftBorderBox,n.bottomLeftBorderDoubleOuterBox);case 3:default:return ju(n.bottomLeftBorderBox,n.bottomLeftBorderDoubleOuterBox,n.topLeftBorderBox,n.topLeftBorderDoubleOuterBox)}},Oye=function(n,e){switch(e){case 0:return ju(n.topLeftBorderDoubleInnerBox,n.topLeftPaddingBox,n.topRightBorderDoubleInnerBox,n.topRightPaddingBox);case 1:return ju(n.topRightBorderDoubleInnerBox,n.topRightPaddingBox,n.bottomRightBorderDoubleInnerBox,n.bottomRightPaddingBox);case 2:return ju(n.bottomRightBorderDoubleInnerBox,n.bottomRightPaddingBox,n.bottomLeftBorderDoubleInnerBox,n.bottomLeftPaddingBox);case 3:default:return ju(n.bottomLeftBorderDoubleInnerBox,n.bottomLeftPaddingBox,n.topLeftBorderDoubleInnerBox,n.topLeftPaddingBox)}},Hye=function(n,e){switch(e){case 0:return lb(n.topLeftBorderStroke,n.topRightBorderStroke);case 1:return lb(n.topRightBorderStroke,n.bottomRightBorderStroke);case 2:return lb(n.bottomRightBorderStroke,n.bottomLeftBorderStroke);case 3:default:return lb(n.bottomLeftBorderStroke,n.topLeftBorderStroke)}},lb=function(n,e){var t=[];return Su(n)?t.push(n.subdivide(.5,!1)):t.push(n),Su(e)?t.push(e.subdivide(.5,!0)):t.push(e),t},ju=function(n,e,t,i){var r=[];return Su(n)?r.push(n.subdivide(.5,!1)):r.push(n),Su(t)?r.push(t.subdivide(.5,!0)):r.push(t),Su(i)?r.push(i.subdivide(.5,!0).reverse()):r.push(i),Su(e)?r.push(e.subdivide(.5,!1).reverse()):r.push(e),r},HV=function(n){var e=n.bounds,t=n.styles;return e.add(t.borderLeftWidth,t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth),-(t.borderTopWidth+t.borderBottomWidth))},b_=function(n){var e=n.styles,t=n.bounds,i=Qo(e.paddingLeft,t.width),r=Qo(e.paddingRight,t.width),s=Qo(e.paddingTop,t.width),o=Qo(e.paddingBottom,t.width);return t.add(i+e.borderLeftWidth,s+e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth+i+r),-(e.borderTopWidth+e.borderBottomWidth+s+o))},Wye=function(n,e){return n===0?e.bounds:n===2?b_(e):HV(e)},zye=function(n,e){return n===0?e.bounds:n===2?b_(e):HV(e)},F4=function(n,e,t){var i=Wye(pm(n.styles.backgroundOrigin,e),n),r=zye(pm(n.styles.backgroundClip,e),n),s=Qye(pm(n.styles.backgroundSize,e),t,i),o=s[0],a=s[1],l=Cy(pm(n.styles.backgroundPosition,e),i.width-o,i.height-a),h=$ye(pm(n.styles.backgroundRepeat,e),l,s,i,r),u=Math.round(i.left+l[0]),d=Math.round(i.top+l[1]);return[h,u,d,o,a]},Y0=function(n){return So(n)&&n.value===$m.AUTO},cb=function(n){return typeof n=="number"},Qye=function(n,e,t){var i=e[0],r=e[1],s=e[2],o=n[0],a=n[1];if(!o)return[0,0];if(ml(o)&&a&&ml(a))return[Qo(o,t.width),Qo(a,t.height)];var l=cb(s);if(So(o)&&(o.value===$m.CONTAIN||o.value===$m.COVER)){if(cb(s)){var h=t.width/t.height;return h<s!=(o.value===$m.COVER)?[t.width,t.width/s]:[t.height*s,t.height]}return[t.width,t.height]}var u=cb(i),d=cb(r),A=u||d;if(Y0(o)&&(!a||Y0(a))){if(u&&d)return[i,r];if(!l&&!A)return[t.width,t.height];if(A&&l){var f=u?i:r*s,p=d?r:i/s;return[f,p]}var g=u?i:t.width,v=d?r:t.height;return[g,v]}if(l){var w=0,m=0;return ml(o)?w=Qo(o,t.width):ml(a)&&(m=Qo(a,t.height)),Y0(o)?w=m*s:(!a||Y0(a))&&(m=w/s),[w,m]}var y=null,x=null;if(ml(o)?y=Qo(o,t.width):a&&ml(a)&&(x=Qo(a,t.height)),y!==null&&(!a||Y0(a))&&(x=u&&d?y/i*r:t.height),x!==null&&Y0(o)&&(y=u&&d?x/r*i:t.width),y!==null&&x!==null)return[y,x];throw new Error("Unable to calculate background-size for element")},pm=function(n,e){var t=n[e];return typeof t>"u"?n[0]:t},$ye=function(n,e,t,i,r){var s=e[0],o=e[1],a=t[0],l=t[1];switch(n){case 2:return[new Ti(Math.round(i.left),Math.round(i.top+o)),new Ti(Math.round(i.left+i.width),Math.round(i.top+o)),new Ti(Math.round(i.left+i.width),Math.round(l+i.top+o)),new Ti(Math.round(i.left),Math.round(l+i.top+o))];case 3:return[new Ti(Math.round(i.left+s),Math.round(i.top)),new Ti(Math.round(i.left+s+a),Math.round(i.top)),new Ti(Math.round(i.left+s+a),Math.round(i.height+i.top)),new Ti(Math.round(i.left+s),Math.round(i.height+i.top))];case 1:return[new Ti(Math.round(i.left+s),Math.round(i.top+o)),new Ti(Math.round(i.left+s+a),Math.round(i.top+o)),new Ti(Math.round(i.left+s+a),Math.round(i.top+o+l)),new Ti(Math.round(i.left+s),Math.round(i.top+o+l))];default:return[new Ti(Math.round(r.left),Math.round(r.top)),new Ti(Math.round(r.left+r.width),Math.round(r.top)),new Ti(Math.round(r.left+r.width),Math.round(r.height+r.top)),new Ti(Math.round(r.left),Math.round(r.height+r.top))]}},Vye="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",JL="Hidden Text",Gye=(function(){function n(e){this._data={},this._document=e}return n.prototype.parseMetrics=function(e,t){var i=this._document.createElement("div"),r=this._document.createElement("img"),s=this._document.createElement("span"),o=this._document.body;i.style.visibility="hidden",i.style.fontFamily=e,i.style.fontSize=t,i.style.margin="0",i.style.padding="0",i.style.whiteSpace="nowrap",o.appendChild(i),r.src=Vye,r.width=1,r.height=1,r.style.margin="0",r.style.padding="0",r.style.verticalAlign="baseline",s.style.fontFamily=e,s.style.fontSize=t,s.style.margin="0",s.style.padding="0",s.appendChild(this._document.createTextNode(JL)),i.appendChild(s),i.appendChild(r);var a=r.offsetTop-s.offsetTop+2;i.removeChild(s),i.appendChild(this._document.createTextNode(JL)),i.style.lineHeight="normal",r.style.verticalAlign="super";var l=r.offsetTop-i.offsetTop+2;return o.removeChild(i),{baseline:a,middle:l}},n.prototype.getMetrics=function(e,t){var i=e+" "+t;return typeof this._data[i]>"u"&&(this._data[i]=this.parseMetrics(e,t)),this._data[i]},n})(),WV=(function(){function n(e,t){this.context=e,this.options=t}return n})(),Xye=1e4,Yye=(function(n){Nd(e,n);function e(t,i){var r=n.call(this,t,i)||this;return r._activeEffects=[],r.canvas=i.canvas?i.canvas:document.createElement("canvas"),r.ctx=r.canvas.getContext("2d"),i.canvas||(r.canvas.width=Math.floor(i.width*i.scale),r.canvas.height=Math.floor(i.height*i.scale),r.canvas.style.width=i.width+"px",r.canvas.style.height=i.height+"px"),r.fontMetrics=new Gye(document),r.ctx.scale(r.options.scale,r.options.scale),r.ctx.translate(-i.x,-i.y),r.ctx.textBaseline="bottom",r._activeEffects=[],r.context.logger.debug("Canvas renderer initialized ("+i.width+"x"+i.height+") with scale "+i.scale),r}return e.prototype.applyEffects=function(t){for(var i=this;this._activeEffects.length;)this.popEffect();t.forEach(function(r){return i.applyEffect(r)})},e.prototype.applyEffect=function(t){this.ctx.save(),Lye(t)&&(this.ctx.globalAlpha=t.opacity),Nye(t)&&(this.ctx.translate(t.offsetX,t.offsetY),this.ctx.transform(t.matrix[0],t.matrix[1],t.matrix[2],t.matrix[3],t.matrix[4],t.matrix[5]),this.ctx.translate(-t.offsetX,-t.offsetY)),MV(t)&&(this.path(t.path),this.ctx.clip()),this._activeEffects.push(t)},e.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},e.prototype.renderStack=function(t){return ih(this,void 0,void 0,function(){var i;return Rc(this,function(r){switch(r.label){case 0:return i=t.element.container.styles,i.isVisible()?[4,this.renderStackContent(t)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})},e.prototype.renderNode=function(t){return ih(this,void 0,void 0,function(){return Rc(this,function(i){switch(i.label){case 0:if(Il(t.container.flags,16))debugger;return t.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(t)]:[3,3];case 1:return i.sent(),[4,this.renderNodeContent(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})},e.prototype.renderTextWithLetterSpacing=function(t,i,r){var s=this;if(i===0)this.ctx.fillText(t.text,t.bounds.left,t.bounds.top+r);else{var o=qk(t.text);o.reduce(function(a,l){return s.ctx.fillText(l,a,t.bounds.top+r),a+s.ctx.measureText(l).width},t.bounds.left)}},e.prototype.createFontStyle=function(t){var i=t.fontVariant.filter(function(o){return o==="normal"||o==="small-caps"}).join(""),r=ewe(t.fontFamily).join(", "),s=_v(t.fontSize)?""+t.fontSize.number+t.fontSize.unit:t.fontSize.number+"px";return[[t.fontStyle,i,t.fontWeight,s,r].join(" "),r,s]},e.prototype.renderTextNode=function(t,i){return ih(this,void 0,void 0,function(){var r,s,o,a,l,h,u,d,A=this;return Rc(this,function(f){return r=this.createFontStyle(i),s=r[0],o=r[1],a=r[2],this.ctx.font=s,this.ctx.direction=i.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",l=this.fontMetrics.getMetrics(o,a),h=l.baseline,u=l.middle,d=i.paintOrder,t.textBounds.forEach(function(p){d.forEach(function(g){switch(g){case 0:A.ctx.fillStyle=Wl(i.color),A.renderTextWithLetterSpacing(p,i.letterSpacing,h);var v=i.textShadow;v.length&&p.text.trim().length&&(v.slice(0).reverse().forEach(function(w){A.ctx.shadowColor=Wl(w.color),A.ctx.shadowOffsetX=w.offsetX.number*A.options.scale,A.ctx.shadowOffsetY=w.offsetY.number*A.options.scale,A.ctx.shadowBlur=w.blur.number,A.renderTextWithLetterSpacing(p,i.letterSpacing,h)}),A.ctx.shadowColor="",A.ctx.shadowOffsetX=0,A.ctx.shadowOffsetY=0,A.ctx.shadowBlur=0),i.textDecorationLine.length&&(A.ctx.fillStyle=Wl(i.textDecorationColor||i.color),i.textDecorationLine.forEach(function(w){switch(w){case 1:A.ctx.fillRect(p.bounds.left,Math.round(p.bounds.top+h),p.bounds.width,1);break;case 2:A.ctx.fillRect(p.bounds.left,Math.round(p.bounds.top),p.bounds.width,1);break;case 3:A.ctx.fillRect(p.bounds.left,Math.ceil(p.bounds.top+u),p.bounds.width,1);break}}));break;case 1:i.webkitTextStrokeWidth&&p.text.trim().length&&(A.ctx.strokeStyle=Wl(i.webkitTextStrokeColor),A.ctx.lineWidth=i.webkitTextStrokeWidth,A.ctx.lineJoin=window.chrome?"miter":"round",A.ctx.strokeText(p.text,p.bounds.left,p.bounds.top+h)),A.ctx.strokeStyle="",A.ctx.lineWidth=0,A.ctx.lineJoin="miter";break}})}),[2]})})},e.prototype.renderReplacedElement=function(t,i,r){if(r&&t.intrinsicWidth>0&&t.intrinsicHeight>0){var s=b_(t),o=x_(i);this.path(o),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(r,0,0,t.intrinsicWidth,t.intrinsicHeight,s.left,s.top,s.width,s.height),this.ctx.restore()}},e.prototype.renderNodeContent=function(t){return ih(this,void 0,void 0,function(){var i,r,s,o,a,l,m,m,h,u,d,A,x,f,p,S,g,v,w,m,y,x,S;return Rc(this,function(I){switch(I.label){case 0:this.applyEffects(t.getEffects(4)),i=t.container,r=t.curves,s=i.styles,o=0,a=i.textNodes,I.label=1;case 1:return o<a.length?(l=a[o],[4,this.renderTextNode(l,s)]):[3,4];case 2:I.sent(),I.label=3;case 3:return o++,[3,1];case 4:if(!(i instanceof vV))return[3,8];I.label=5;case 5:return I.trys.push([5,7,,8]),[4,this.context.cache.match(i.src)];case 6:return m=I.sent(),this.renderReplacedElement(i,r,m),[3,8];case 7:return I.sent(),this.context.logger.error("Error loading image "+i.src),[3,8];case 8:if(i instanceof xV&&this.renderReplacedElement(i,r,i.canvas),!(i instanceof bV))return[3,12];I.label=9;case 9:return I.trys.push([9,11,,12]),[4,this.context.cache.match(i.svg)];case 10:return m=I.sent(),this.renderReplacedElement(i,r,m),[3,12];case 11:return I.sent(),this.context.logger.error("Error loading svg "+i.svg.substring(0,255)),[3,12];case 12:return i instanceof TV&&i.tree?(h=new e(this.context,{scale:this.options.scale,backgroundColor:i.backgroundColor,x:0,y:0,width:i.width,height:i.height}),[4,h.render(i.tree)]):[3,14];case 13:u=I.sent(),i.width&&i.height&&this.ctx.drawImage(u,0,0,i.width,i.height,i.bounds.left,i.bounds.top,i.bounds.width,i.bounds.height),I.label=14;case 14:if(i instanceof Zk&&(d=Math.min(i.bounds.width,i.bounds.height),i.type===g_?i.checked&&(this.ctx.save(),this.path([new Ti(i.bounds.left+d*.39363,i.bounds.top+d*.79),new Ti(i.bounds.left+d*.16,i.bounds.top+d*.5549),new Ti(i.bounds.left+d*.27347,i.bounds.top+d*.44071),new Ti(i.bounds.left+d*.39694,i.bounds.top+d*.5649),new Ti(i.bounds.left+d*.72983,i.bounds.top+d*.23),new Ti(i.bounds.left+d*.84,i.bounds.top+d*.34085),new Ti(i.bounds.left+d*.39363,i.bounds.top+d*.79)]),this.ctx.fillStyle=Wl(OL),this.ctx.fill(),this.ctx.restore()):i.type===m_&&i.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(i.bounds.left+d/2,i.bounds.top+d/2,d/4,0,Math.PI*2,!0),this.ctx.fillStyle=Wl(OL),this.ctx.fill(),this.ctx.restore())),Kye(i)&&i.value.length){switch(A=this.createFontStyle(s),x=A[0],f=A[1],p=this.fontMetrics.getMetrics(x,f).baseline,this.ctx.font=x,this.ctx.fillStyle=Wl(s.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=Zye(i.styles.textAlign),S=b_(i),g=0,i.styles.textAlign){case 1:g+=S.width/2;break;case 2:g+=S.width;break}v=S.add(g,0,0,-S.height/2+1),this.ctx.save(),this.path([new Ti(S.left,S.top),new Ti(S.left+S.width,S.top),new Ti(S.left+S.width,S.top+S.height),new Ti(S.left,S.top+S.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new rw(i.value,v),s.letterSpacing,p),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!Il(i.styles.display,2048))return[3,20];if(i.styles.listStyleImage===null)return[3,19];if(w=i.styles.listStyleImage,w.type!==0)return[3,18];m=void 0,y=w.url,I.label=15;case 15:return I.trys.push([15,17,,18]),[4,this.context.cache.match(y)];case 16:return m=I.sent(),this.ctx.drawImage(m,i.bounds.left-(m.width+10),i.bounds.top),[3,18];case 17:return I.sent(),this.context.logger.error("Error loading list-style-image "+y),[3,18];case 18:return[3,20];case 19:t.listValue&&i.styles.listStyleType!==-1&&(x=this.createFontStyle(s)[0],this.ctx.font=x,this.ctx.fillStyle=Wl(s.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",S=new _f(i.bounds.left,i.bounds.top+Qo(i.styles.paddingTop,i.bounds.width),i.bounds.width,CL(s.lineHeight,s.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new rw(t.listValue,S),s.letterSpacing,CL(s.lineHeight,s.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),I.label=20;case 20:return[2]}})})},e.prototype.renderStackContent=function(t){return ih(this,void 0,void 0,function(){var i,r,w,s,o,w,a,l,w,h,u,w,d,A,w,f,p,w,g,v,w;return Rc(this,function(m){switch(m.label){case 0:if(Il(t.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(t.element)];case 1:m.sent(),i=0,r=t.negativeZIndex,m.label=2;case 2:return i<r.length?(w=r[i],[4,this.renderStack(w)]):[3,5];case 3:m.sent(),m.label=4;case 4:return i++,[3,2];case 5:return[4,this.renderNodeContent(t.element)];case 6:m.sent(),s=0,o=t.nonInlineLevel,m.label=7;case 7:return s<o.length?(w=o[s],[4,this.renderNode(w)]):[3,10];case 8:m.sent(),m.label=9;case 9:return s++,[3,7];case 10:a=0,l=t.nonPositionedFloats,m.label=11;case 11:return a<l.length?(w=l[a],[4,this.renderStack(w)]):[3,14];case 12:m.sent(),m.label=13;case 13:return a++,[3,11];case 14:h=0,u=t.nonPositionedInlineLevel,m.label=15;case 15:return h<u.length?(w=u[h],[4,this.renderStack(w)]):[3,18];case 16:m.sent(),m.label=17;case 17:return h++,[3,15];case 18:d=0,A=t.inlineLevel,m.label=19;case 19:return d<A.length?(w=A[d],[4,this.renderNode(w)]):[3,22];case 20:m.sent(),m.label=21;case 21:return d++,[3,19];case 22:f=0,p=t.zeroOrAutoZIndexOrTransformedOrOpacity,m.label=23;case 23:return f<p.length?(w=p[f],[4,this.renderStack(w)]):[3,26];case 24:m.sent(),m.label=25;case 25:return f++,[3,23];case 26:g=0,v=t.positiveZIndex,m.label=27;case 27:return g<v.length?(w=v[g],[4,this.renderStack(w)]):[3,30];case 28:m.sent(),m.label=29;case 29:return g++,[3,27];case 30:return[2]}})})},e.prototype.mask=function(t){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(t.slice(0).reverse()),this.ctx.closePath()},e.prototype.path=function(t){this.ctx.beginPath(),this.formatPath(t),this.ctx.closePath()},e.prototype.formatPath=function(t){var i=this;t.forEach(function(r,s){var o=Su(r)?r.start:r;s===0?i.ctx.moveTo(o.x,o.y):i.ctx.lineTo(o.x,o.y),Su(r)&&i.ctx.bezierCurveTo(r.startControl.x,r.startControl.y,r.endControl.x,r.endControl.y,r.end.x,r.end.y)})},e.prototype.renderRepeat=function(t,i,r,s){this.path(t),this.ctx.fillStyle=i,this.ctx.translate(r,s),this.ctx.fill(),this.ctx.translate(-r,-s)},e.prototype.resizeImage=function(t,i,r){var s;if(t.width===i&&t.height===r)return t;var o=(s=this.canvas.ownerDocument)!==null&&s!==void 0?s:document,a=o.createElement("canvas");a.width=Math.max(1,i),a.height=Math.max(1,r);var l=a.getContext("2d");return l.drawImage(t,0,0,t.width,t.height,0,0,i,r),a},e.prototype.renderBackgroundImage=function(t){return ih(this,void 0,void 0,function(){var i,r,s,o,a,l;return Rc(this,function(h){switch(h.label){case 0:i=t.styles.backgroundImage.length-1,r=function(u){var d,A,f,D,te,L,B,E,C,p,D,te,L,B,E,g,v,w,m,y,x,S,I,j,C,b,D,T,k,B,E,z,te,L,O,J,$,U,Y,K,V,Q;return Rc(this,function(X){switch(X.label){case 0:if(u.type!==0)return[3,5];d=void 0,A=u.url,X.label=1;case 1:return X.trys.push([1,3,,4]),[4,s.context.cache.match(A)];case 2:return d=X.sent(),[3,4];case 3:return X.sent(),s.context.logger.error("Error loading background-image "+A),[3,4];case 4:return d&&(f=F4(t,i,[d.width,d.height,d.width/d.height]),D=f[0],te=f[1],L=f[2],B=f[3],E=f[4],C=s.ctx.createPattern(s.resizeImage(d,B,E),"repeat"),s.renderRepeat(D,C,te,L)),[3,6];case 5:Nme(u)?(p=F4(t,i,[null,null,null]),D=p[0],te=p[1],L=p[2],B=p[3],E=p[4],g=kme(u.angle,B,E),v=g[0],w=g[1],m=g[2],y=g[3],x=g[4],S=document.createElement("canvas"),S.width=B,S.height=E,I=S.getContext("2d"),j=I.createLinearGradient(w,y,m,x),xL(u.stops,v).forEach(function(W){return j.addColorStop(W.stop,Wl(W.color))}),I.fillStyle=j,I.fillRect(0,0,B,E),B>0&&E>0&&(C=s.ctx.createPattern(S,"repeat"),s.renderRepeat(D,C,te,L))):Lme(u)&&(b=F4(t,i,[null,null,null]),D=b[0],T=b[1],k=b[2],B=b[3],E=b[4],z=u.position.length===0?[Xk]:u.position,te=Qo(z[0],B),L=Qo(z[z.length-1],E),O=Ime(u,te,L,B,E),J=O[0],$=O[1],J>0&&$>0&&(U=s.ctx.createRadialGradient(T+te,k+L,0,T+te,k+L,J),xL(u.stops,J*2).forEach(function(W){return U.addColorStop(W.stop,Wl(W.color))}),s.path(D),s.ctx.fillStyle=U,J!==$?(Y=t.bounds.left+.5*t.bounds.width,K=t.bounds.top+.5*t.bounds.height,V=$/J,Q=1/V,s.ctx.save(),s.ctx.translate(Y,K),s.ctx.transform(1,0,0,V,0,0),s.ctx.translate(-Y,-K),s.ctx.fillRect(T,Q*(k-K)+K,B,E*Q),s.ctx.restore()):s.ctx.fill())),X.label=6;case 6:return i--,[2]}})},s=this,o=0,a=t.styles.backgroundImage.slice(0).reverse(),h.label=1;case 1:return o<a.length?(l=a[o],[5,r(l)]):[3,4];case 2:h.sent(),h.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},e.prototype.renderSolidBorder=function(t,i,r){return ih(this,void 0,void 0,function(){return Rc(this,function(s){return this.path(ZL(r,i)),this.ctx.fillStyle=Wl(t),this.ctx.fill(),[2]})})},e.prototype.renderDoubleBorder=function(t,i,r,s){return ih(this,void 0,void 0,function(){var o,a;return Rc(this,function(l){switch(l.label){case 0:return i<3?[4,this.renderSolidBorder(t,r,s)]:[3,2];case 1:return l.sent(),[2];case 2:return o=Uye(s,r),this.path(o),this.ctx.fillStyle=Wl(t),this.ctx.fill(),a=Oye(s,r),this.path(a),this.ctx.fill(),[2]}})})},e.prototype.renderNodeBackgroundAndBorders=function(t){return ih(this,void 0,void 0,function(){var i,r,s,o,a,l,h,u,d=this;return Rc(this,function(A){switch(A.label){case 0:return this.applyEffects(t.getEffects(2)),i=t.container.styles,r=!Fp(i.backgroundColor)||i.backgroundImage.length,s=[{style:i.borderTopStyle,color:i.borderTopColor,width:i.borderTopWidth},{style:i.borderRightStyle,color:i.borderRightColor,width:i.borderRightWidth},{style:i.borderBottomStyle,color:i.borderBottomColor,width:i.borderBottomWidth},{style:i.borderLeftStyle,color:i.borderLeftColor,width:i.borderLeftWidth}],o=qye(pm(i.backgroundClip,0),t.curves),r||i.boxShadow.length?(this.ctx.save(),this.path(o),this.ctx.clip(),Fp(i.backgroundColor)||(this.ctx.fillStyle=Wl(i.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(t.container)]):[3,2];case 1:A.sent(),this.ctx.restore(),i.boxShadow.slice(0).reverse().forEach(function(f){d.ctx.save();var p=v_(t.curves),g=f.inset?0:Xye,v=Mye(p,-g+(f.inset?1:-1)*f.spread.number,(f.inset?1:-1)*f.spread.number,f.spread.number*(f.inset?-2:2),f.spread.number*(f.inset?-2:2));f.inset?(d.path(p),d.ctx.clip(),d.mask(v)):(d.mask(p),d.ctx.clip(),d.path(v)),d.ctx.shadowOffsetX=f.offsetX.number+g,d.ctx.shadowOffsetY=f.offsetY.number,d.ctx.shadowColor=Wl(f.color),d.ctx.shadowBlur=f.blur.number,d.ctx.fillStyle=f.inset?Wl(f.color):"rgba(0,0,0,1)",d.ctx.fill(),d.ctx.restore()}),A.label=2;case 2:a=0,l=0,h=s,A.label=3;case 3:return l<h.length?(u=h[l],u.style!==0&&!Fp(u.color)&&u.width>0?u.style!==2?[3,5]:[4,this.renderDashedDottedBorder(u.color,u.width,a,t.curves,2)]:[3,11]):[3,13];case 4:return A.sent(),[3,11];case 5:return u.style!==3?[3,7]:[4,this.renderDashedDottedBorder(u.color,u.width,a,t.curves,3)];case 6:return A.sent(),[3,11];case 7:return u.style!==4?[3,9]:[4,this.renderDoubleBorder(u.color,u.width,a,t.curves)];case 8:return A.sent(),[3,11];case 9:return[4,this.renderSolidBorder(u.color,a,t.curves)];case 10:A.sent(),A.label=11;case 11:a++,A.label=12;case 12:return l++,[3,3];case 13:return[2]}})})},e.prototype.renderDashedDottedBorder=function(t,i,r,s,o){return ih(this,void 0,void 0,function(){var a,l,h,u,d,A,f,p,g,v,w,m,y,x,S,I,S,I;return Rc(this,function(j){return this.ctx.save(),a=Hye(s,r),l=ZL(s,r),o===2&&(this.path(l),this.ctx.clip()),Su(l[0])?(h=l[0].start.x,u=l[0].start.y):(h=l[0].x,u=l[0].y),Su(l[1])?(d=l[1].end.x,A=l[1].end.y):(d=l[1].x,A=l[1].y),r===0||r===2?f=Math.abs(h-d):f=Math.abs(u-A),this.ctx.beginPath(),o===3?this.formatPath(a):this.formatPath(l.slice(0,2)),p=i<3?i*3:i*2,g=i<3?i*2:i,o===3&&(p=i,g=i),v=!0,f<=p*2?v=!1:f<=p*2+g?(w=f/(2*p+g),p*=w,g*=w):(m=Math.floor((f+g)/(p+g)),y=(f-m*p)/(m-1),x=(f-(m+1)*p)/m,g=x<=0||Math.abs(g-y)<Math.abs(g-x)?y:x),v&&(o===3?this.ctx.setLineDash([0,p+g]):this.ctx.setLineDash([p,g])),o===3?(this.ctx.lineCap="round",this.ctx.lineWidth=i):this.ctx.lineWidth=i*2+1.1,this.ctx.strokeStyle=Wl(t),this.ctx.stroke(),this.ctx.setLineDash([]),o===2&&(Su(l[0])&&(S=l[3],I=l[0],this.ctx.beginPath(),this.formatPath([new Ti(S.end.x,S.end.y),new Ti(I.start.x,I.start.y)]),this.ctx.stroke()),Su(l[1])&&(S=l[1],I=l[2],this.ctx.beginPath(),this.formatPath([new Ti(S.end.x,S.end.y),new Ti(I.start.x,I.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},e.prototype.render=function(t){return ih(this,void 0,void 0,function(){var i;return Rc(this,function(r){switch(r.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=Wl(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),i=Rye(t),[4,this.renderStack(i)];case 1:return r.sent(),this.applyEffects([]),[2,this.canvas]}})})},e})(WV),Kye=function(n){return n instanceof SV||n instanceof _V?!0:n instanceof Zk&&n.type!==m_&&n.type!==g_},qye=function(n,e){switch(n){case 0:return v_(e);case 2:return Dye(e);case 1:default:return x_(e)}},Zye=function(n){switch(n){case 1:return"center";case 2:return"right";case 0:default:return"left"}},Jye=["-apple-system","system-ui"],ewe=function(n){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?n.filter(function(e){return Jye.indexOf(e)===-1}):n},twe=(function(n){Nd(e,n);function e(t,i){var r=n.call(this,t,i)||this;return r.canvas=i.canvas?i.canvas:document.createElement("canvas"),r.ctx=r.canvas.getContext("2d"),r.options=i,r.canvas.width=Math.floor(i.width*i.scale),r.canvas.height=Math.floor(i.height*i.scale),r.canvas.style.width=i.width+"px",r.canvas.style.height=i.height+"px",r.ctx.scale(r.options.scale,r.options.scale),r.ctx.translate(-i.x,-i.y),r.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+i.width+"x"+i.height+" at "+i.x+","+i.y+") with scale "+i.scale),r}return e.prototype.render=function(t){return ih(this,void 0,void 0,function(){var i,r;return Rc(this,function(s){switch(s.label){case 0:return i=n6(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,t),[4,nwe(i)];case 1:return r=s.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=Wl(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(r,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},e})(WV),nwe=function(n){return new Promise(function(e,t){var i=new Image;i.onload=function(){e(i)},i.onerror=t,i.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(n))})},iwe=(function(){function n(e){var t=e.id,i=e.enabled;this.id=t,this.enabled=i,this.start=Date.now()}return n.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,Hx([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},n.prototype.getTime=function(){return Date.now()-this.start},n.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,Hx([this.id,this.getTime()+"ms"],e))},n.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,Hx([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},n.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,Hx([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},n.instances={},n})(),rwe=(function(){function n(e,t){var i;this.windowBounds=t,this.instanceName="#"+n.instanceCount++,this.logger=new iwe({id:this.instanceName,enabled:e.logging}),this.cache=(i=e.cache)!==null&&i!==void 0?i:new _ye(this,e)}return n.instanceCount=1,n})(),C_=function(n,e){return e===void 0&&(e={}),swe(n,e)};typeof window<"u"&&LV.setContext(window);var swe=function(n,e){return ih(void 0,void 0,void 0,function(){var t,i,r,s,o,a,l,h,u,d,A,f,p,g,v,w,m,y,x,S,j,I,j,C,b,D,T,k,B,E,z,te,L,O,J,$,U,Y,K,V;return Rc(this,function(Q){switch(Q.label){case 0:if(!n||typeof n!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(t=n.ownerDocument,!t)throw new Error("Element is not attached to a Document");if(i=t.defaultView,!i)throw new Error("Document is not attached to a Window");return r={allowTaint:(C=e.allowTaint)!==null&&C!==void 0?C:!1,imageTimeout:(b=e.imageTimeout)!==null&&b!==void 0?b:15e3,proxy:e.proxy,useCORS:(D=e.useCORS)!==null&&D!==void 0?D:!1},s=HE({logging:(T=e.logging)!==null&&T!==void 0?T:!0,cache:e.cache},r),o={windowWidth:(k=e.windowWidth)!==null&&k!==void 0?k:i.innerWidth,windowHeight:(B=e.windowHeight)!==null&&B!==void 0?B:i.innerHeight,scrollX:(E=e.scrollX)!==null&&E!==void 0?E:i.pageXOffset,scrollY:(z=e.scrollY)!==null&&z!==void 0?z:i.pageYOffset},a=new _f(o.scrollX,o.scrollY,o.windowWidth,o.windowHeight),l=new rwe(s,a),h=(te=e.foreignObjectRendering)!==null&&te!==void 0?te:!1,u={allowTaint:(L=e.allowTaint)!==null&&L!==void 0?L:!1,onclone:e.onclone,ignoreElements:e.ignoreElements,inlineImages:h,copyStyles:h},l.logger.debug("Starting document clone with size "+a.width+"x"+a.height+" scrolled to "+-a.left+","+-a.top),d=new YL(l,n,u),A=d.clonedReferenceElement,A?[4,d.toIFrame(t,a)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return f=Q.sent(),p=Jk(A)||aye(A)?Mge(A.ownerDocument):z5(l,A),g=p.width,v=p.height,w=p.left,m=p.top,y=owe(l,A,e.backgroundColor),x={canvas:e.canvas,backgroundColor:y,scale:(J=(O=e.scale)!==null&&O!==void 0?O:i.devicePixelRatio)!==null&&J!==void 0?J:1,x:(($=e.x)!==null&&$!==void 0?$:0)+w,y:((U=e.y)!==null&&U!==void 0?U:0)+m,width:(Y=e.width)!==null&&Y!==void 0?Y:Math.ceil(g),height:(K=e.height)!==null&&K!==void 0?K:Math.ceil(v)},h?(l.logger.debug("Document cloned, using foreign object rendering"),j=new twe(l,x),[4,j.render(A)]):[3,3];case 2:return S=Q.sent(),[3,5];case 3:return l.logger.debug("Document cloned, element located at "+w+","+m+" with size "+g+"x"+v+" using computed rendering"),l.logger.debug("Starting DOM parsing"),I=EV(l,A),y===I.styles.backgroundColor&&(I.styles.backgroundColor=ff.TRANSPARENT),l.logger.debug("Starting renderer for element at "+x.x+","+x.y+" with size "+x.width+"x"+x.height),j=new Yye(l,x),[4,j.render(I)];case 4:S=Q.sent(),Q.label=5;case 5:return(!((V=e.removeContainer)!==null&&V!==void 0)||V)&&(YL.destroy(f)||l.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),l.logger.debug("Finished rendering"),[2,S]}})})},owe=function(n,e,t){var i=e.ownerDocument,r=i.documentElement?nw(n,getComputedStyle(i.documentElement).backgroundColor):ff.TRANSPARENT,s=i.body?nw(n,getComputedStyle(i.body).backgroundColor):ff.TRANSPARENT,o=typeof t=="string"?nw(n,t):t===null?ff.TRANSPARENT:4294967295;return e===i.documentElement?Fp(r)?Fp(s)?o:s:r:o};const awe=Object.freeze(Object.defineProperty({__proto__:null,default:C_},Symbol.toStringTag,{value:"Module"})),lwe=()=>{const n=document.createElement("link");n.href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap",n.rel="stylesheet",document.head.appendChild(n)};lwe();const cwe=async(n,e=12,t="#000000",i="400")=>{const r=document.createElement("canvas"),s=r.getContext("2d");if(!s)throw new Error("Canvas context not available");const o=3;s.font=`${i} ${e}px "Noto Sans KR", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif`;const a=s.measureText(n);return r.width=Math.ceil((a.width+8)*o),r.height=Math.ceil(e*1.8*o),s.scale(o,o),s.imageSmoothingEnabled=!0,s.imageSmoothingQuality="high",s.clearRect(0,0,r.width,r.height),s.font=`${i} ${e}px "Noto Sans KR", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif`,s.fillStyle=t,s.textBaseline="middle",s.textAlign="left",(i==="700"||i==="500")&&(s.letterSpacing="0.5px"),s.fillText(n,4,e*1.8/2),r.toDataURL("image/png",1)},zV=async(n,e,t,i,r)=>{const s=(r==null?void 0:r.fontSize)||12,o=(r==null?void 0:r.color)||"#000000",a=(r==null?void 0:r.fontWeight)||"400";try{const l=await cwe(e,s,o,a),h=new Image;h.src=l,await new Promise(p=>h.onload=p);const u=3,d=h.width/u*.75,A=h.height/u*.75;let f=t;return(r==null?void 0:r.align)==="center"?f=t-d/2:(r==null?void 0:r.align)==="right"&&(f=t-d),n.addImage(l,"PNG",f,i-A*.75,d,A),{width:d,height:A}}catch(l){return console.error("Failed to add Korean text:",l),n.text(e,t,i,r),{width:0,height:0}}},hwe=n=>/[ㄱ-ㅎㅏ-ㅣ가-힣]/g.test(n),wg=async(n,e,t,i,r)=>{if(hwe(e))await zV(n,e,t,i,{...r,fontWeight:(r==null?void 0:r.fontWeight)||((r==null?void 0:r.fontStyle)==="bold"?"700":"400")});else{if(r!=null&&r.fontSize&&n.setFontSize(r.fontSize),r!=null&&r.color){const o=parseInt(r.color.slice(1,3),16),a=parseInt(r.color.slice(3,5),16),l=parseInt(r.color.slice(5,7),16);n.setTextColor(o,a,l)}r!=null&&r.font&&n.setFont(r.font,r.fontStyle||"normal");const s={};r!=null&&r.align&&(s.align=r.align),n.text(e,t,i,s)}},k4=[{id:"3d-front",name:"3D 정면뷰",viewMode:"3D"},{id:"2d-front",name:"2D 정면뷰 (치수)",viewMode:"2D",viewDirection:"front"},{id:"2d-top",name:"2D 상부뷰 (치수)",viewMode:"2D",viewDirection:"top"},{id:"2d-left",name:"2D 좌측뷰 (치수)",viewMode:"2D",viewDirection:"left"},{id:"2d-right",name:"2D 우측뷰 (치수)",viewMode:"2D",viewDirection:"right"}];function QV(){const[n,e]=H.useState(!1),{title:t}=Pl(),{viewMode:i,view2DDirection:r,showGuides:s,showAxis:o,showDimensions:a,showDimensionsText:l,showFurniture:h,renderMode:u,setViewMode:d,setView2DDirection:A,setShowGuides:f,setShowAxis:p,setShowDimensions:g,setShowDimensionsText:v,setShowFurniture:w,setRenderMode:m}=Wi(),y=H.useCallback(async(j,C)=>{const b=k4.find(U=>U.id===j);if(!b)throw new Error("잘못된 뷰 타입입니다.");const D=i,T=r,k=s,B=o,E=a,z=l,te=h,L=u;console.log("📸 PDF 캡처 시작:",{viewType:j,원래설정:{viewMode:D,view2DDirection:T,showGuides:k,showAxis:B,showDimensions:E,showDimensionsText:z,renderMode:L}}),b.viewMode==="3D"?(d("3D"),m(C)):(d("2D"),f(!1),p(!1),g(!0),v(!0),w(!0),m("wireframe"),b.viewDirection&&A(b.viewDirection)),await new Promise(U=>setTimeout(U,1500));let O=null,J=document.querySelector('[data-viewer-container="true"]');if(J&&(O=J.querySelector("canvas")),!O){const U=document.querySelectorAll("canvas");let Y=0;U.forEach(K=>{const V=K.width*K.height;V>Y&&K.width>100&&K.height>100&&(Y=V,O=K)})}if(!O)throw console.error("렌더링 캔버스를 찾을 수 없습니다."),new Error("뷰어 캔버스를 찾을 수 없습니다.");J=J||O.parentElement;let $;if(console.log("Canvas 캡처 시도:",{viewerContainer:!!J,canvas:!!O,canvasWidth:O==null?void 0:O.width,canvasHeight:O==null?void 0:O.height}),O&&(b.viewMode==="3D"||b.viewMode==="2D"))try{if(await new Promise(U=>requestAnimationFrame(U)),$=O.toDataURL("image/png",1),!$||$==="data:,"||$.length<100)throw new Error("Canvas 캡처 결과가 비어있습니다.");console.log("Canvas 직접 캡처 성공:",$.substring(0,50)+"...")}catch(U){console.warn("Canvas 직접 캡처 실패, html2canvas 사용:",U),$=(await C_(J,{backgroundColor:"#ffffff",scale:4,logging:!1,useCORS:!0,allowTaint:!0,onclone:K=>{const V=K.querySelector("canvas");if(V&&O){const Q=V.getContext("2d");Q&&Q.drawImage(O,0,0)}}})).toDataURL("image/png")}else $=(await C_(J,{backgroundColor:"#ffffff",scale:4,logging:!1,useCORS:!0,allowTaint:!0})).toDataURL("image/png");return d(D),D==="2D"&&A(T),f(k),p(B),g(E),v(z),w(te),m(L),console.log("📸 PDF 캡처 완료 - 설정 복원:",{viewMode:D,view2DDirection:T,showGuides:k,showAxis:B,showDimensions:E,showDimensionsText:z,renderMode:L}),await new Promise(U=>setTimeout(U,500)),$},[i,r,s,o,a,l,h,u,d,A,f,p,g,v,w,m]),x=H.useCallback(async(j,C,b,D="solid")=>{e(!0);try{const T=new qi({orientation:"landscape",unit:"mm",format:"a3"}),k=T.internal.pageSize.getWidth(),B=T.internal.pageSize.getHeight(),E=10,z=5,te=40,L=180,O={black:"#000000",gray:"#666666",lightGray:"#CCCCCC",text:"#000000",white:"#FFFFFF"},J=t||"가구 배치 설계도",$=new Date().toLocaleDateString("ko-KR"),U=C.map(K=>{const V=Zi(K.moduleId,j);return{name:(V==null?void 0:V.name)||"알 수 없음",width:K.customWidth||(V==null?void 0:V.width)||0,height:K.customHeight||(V==null?void 0:V.height)||0,depth:K.customDepth||(V==null?void 0:V.depth)||0,position:K.slotPosition||"N/A"}});for(let K=0;K<b.length;K++){const V=b[K],Q=k4.find(q=>q.id===V);if(!Q)continue;K>0&&T.addPage(),T.setDrawColor(0,0,0),T.setLineWidth(.7),T.rect(E,E,k-2*E,B-2*E,"S"),T.setLineWidth(.3),T.rect(E+z,E+z,k-2*(E+z),B-2*(E+z),"S");const X=k-E-z-L,W=B-E-z-te;T.setLineWidth(.5),T.rect(X,W,L,te,"S"),T.line(X+40,W,X+40,W+te),T.line(X,W+20,X+L,W+20),T.line(X+90,W+20,X+90,W+te),T.line(X+140,W+20,X+140,W+te),T.setFont("helvetica","bold"),T.setFontSize(16),T.text("MF",X+20,W+12,{align:"center"}),T.setFontSize(8),T.setFont("helvetica","normal"),T.text("MODULAR",X+20,W+17,{align:"center"}),T.text("FURNITURE",X+20,W+21,{align:"center"}),T.setFontSize(8),T.text("PROJECT:",X+45,W+6),await wg(T,J.toUpperCase(),X+45,W+11,{fontSize:10,color:O.text,fontWeight:"700"}),T.text("CLIENT:",X+45,W+17),await wg(T,"MODULAR FURNITURE SYSTEM",X+65,W+17,{fontSize:8,color:O.text}),T.text("SHEET:",X+5,W+26),T.text(`${K+1} / ${b.length}`,X+20,W+26),T.text("DATE:",X+5,W+32),T.text($,X+20,W+32),T.text("SCALE:",X+5,W+38),T.text("AS SHOWN",X+20,W+38),T.text("SPACE:",X+95,W+26),T.setFont("helvetica","bold"),T.text(`${j.width} × ${j.height} × ${j.depth}`,X+95,W+32),T.setFont("helvetica","normal"),T.text("(W × H × D) mm",X+95,W+36),T.text("VIEW:",X+145,W+26),await wg(T,Q.name,X+145,W+32,{fontSize:9,color:O.text,fontWeight:"500"}),T.text("RENDER:",X+145,W+38),T.text(D.toUpperCase(),X+165,W+38);try{const q=await y(V,D),de=E+z+5,Ce=E+z+5,Se=k-2*(E+z)-10,fe=B-2*(E+z)-te-15,M=W+10;T.setLineWidth(.3),T.rect(de,M,100,25,"S"),T.setFont("helvetica","bold"),T.setFontSize(12),T.text("VIEW TITLE",de+50,M+10,{align:"center"}),T.setFont("helvetica","normal"),T.setFontSize(10),await wg(T,Q.name.toUpperCase(),de+50,M+16,{fontSize:10,color:O.text,align:"center"}),T.setFontSize(8),T.text("SCALE: AS SHOWN",de+50,M+22,{align:"center"}),T.addImage(q,"PNG",de,Ce,Se,fe,void 0,"NONE")}catch(q){console.error(`뷰 캡처 실패 (${V}):`,q);const de=E+z+5,Ce=E+z+5,Se=k-2*(E+z)-10,fe=B-2*(E+z)-te-15;T.setDrawColor(200,200,200),T.setLineWidth(.2),T.line(de,Ce,de+Se,Ce+fe),T.line(de+Se,Ce,de,Ce+fe),T.setTextColor(150,150,150),T.setFont("helvetica","normal"),T.setFontSize(14),await zV(T,"뷰 캡처 실패",k/2,B/2-20,{fontSize:14,color:"#969696",align:"center"}),T.setFontSize(10),T.text("VIEW CAPTURE FAILED",k/2,B/2,{align:"center"})}T.setFont("helvetica","normal"),T.setFontSize(6),T.setTextColor(100,100,100),T.text("GENERAL NOTE: DO NOT SCALE FROM DRAWINGS. USE MARKED DIMENSIONS. TO BE READ WITH ALL OTHER CONSULTANTS DRAWINGS. THE ARCHITECT TO BE NOTIFIED IMMEDIATELY SHOULD ANY DISCREPANCY OCCUR.",k/2,E-2,{align:"center"}),T.setFontSize(8),T.setTextColor(0,0,0),T.text(`${K+1}`,E+z+3,E+z+5),T.text(`${K+1}`,k-E-z-3,E+z+5,{align:"right"}),T.text(`${K+1}`,E+z+3,B-E-z-2)}if(U.length>0){T.addPage(),T.setDrawColor(0,0,0),T.setLineWidth(.7),T.rect(E,E,k-2*E,B-2*E,"S"),T.setLineWidth(.3),T.rect(E+z,E+z,k-2*(E+z),B-2*(E+z),"S");const K=k-E-z-L,V=B-E-z-te;T.setLineWidth(.5),T.rect(K,V,L,te,"S"),T.line(K+40,V,K+40,V+te),T.line(K,V+20,K+L,V+20),T.line(K+90,V+20,K+90,V+te),T.line(K+140,V+20,K+140,V+te),T.setFont("helvetica","bold"),T.setFontSize(16),T.text("MF",K+20,V+12,{align:"center"}),T.setFontSize(8),T.setFont("helvetica","normal"),T.text("MODULAR",K+20,V+17,{align:"center"}),T.text("FURNITURE",K+20,V+21,{align:"center"}),T.setFontSize(8),T.text("PROJECT:",K+45,V+6),await wg(T,J.toUpperCase(),K+45,V+11,{fontSize:10,color:O.text,fontWeight:"700"}),T.text("CLIENT:",K+45,V+17),await wg(T,"MODULAR FURNITURE SYSTEM",K+65,V+17,{fontSize:8,color:O.text}),T.text("SHEET:",K+5,V+26),T.text(`${b.length+1} / ${b.length+1}`,K+20,V+26),T.text("DATE:",K+5,V+32),T.text($,K+20,V+32),T.text("SCALE:",K+5,V+38),T.text("N/A",K+20,V+38),T.text("DRAWING:",K+95,V+26),T.setFont("helvetica","bold"),T.text("FURNITURE",K+95,V+32),T.text("SCHEDULE",K+95,V+36),T.setFont("helvetica","normal"),T.text("TOTAL:",K+145,V+26),T.setFont("helvetica","bold"),T.text(`${U.length} ITEMS`,K+145,V+32),T.setFont("helvetica","normal"),T.setFont("helvetica","normal"),T.setFontSize(6),T.setTextColor(100,100,100),T.text("GENERAL NOTE: DO NOT SCALE FROM DRAWINGS. USE MARKED DIMENSIONS. TO BE READ WITH ALL OTHER CONSULTANTS DRAWINGS. THE ARCHITECT TO BE NOTIFIED IMMEDIATELY SHOULD ANY DISCREPANCY OCCUR.",k/2,E-2,{align:"center"}),T.setFontSize(8),T.setTextColor(0,0,0),T.text(`${b.length+1}`,E+z+3,E+z+5),T.text(`${b.length+1}`,k-E-z-3,E+z+5,{align:"right"}),T.text(`${b.length+1}`,E+z+3,B-E-z-2);const X=E+z+10,W=E+z+20,se=k-2*(E+z)-L-30;let q=W;const de=[30,120,40,40,40,50],Ce=["NO.","FURNITURE NAME","WIDTH","HEIGHT","DEPTH","POSITION"];let Se=X;T.setLineWidth(.5),T.setDrawColor(0,0,0),T.rect(X,q,se,15,"S"),T.setTextColor(0,0,0),T.setFont("helvetica","bold"),T.setFontSize(9);for(let fe=0;fe<Ce.length;fe++)T.text(Ce[fe],Se+de[fe]/2,q+10,{align:"center"}),fe<Ce.length-1&&(T.setLineWidth(.3),T.line(Se+de[fe],q,Se+de[fe],q+15)),Se+=de[fe];q+=15;for(let fe=0;fe<U.length;fe++){const M=U[fe];q>B-30&&(T.addPage(),q=W),Se=X;const Z=12;T.setLineWidth(.3),T.rect(X,q,se,Z,"S"),T.setFont("helvetica","normal"),T.setFontSize(8),T.text((fe+1).toString().padStart(2,"0"),Se+de[0]/2,q+8,{align:"center"}),Se+=de[0],T.line(Se,q,Se,q+Z);const Ae=M.name.toUpperCase(),ie=Ae.length>30?Ae.substring(0,28)+"...":Ae;await wg(T,ie,Se+5,q+8,{fontSize:8,color:O.text}),Se+=de[1],T.line(Se,q,Se,q+Z);const ee=[M.width.toString(),M.height.toString(),M.depth.toString()];for(let ae=0;ae<ee.length;ae++)T.text(ee[ae],Se+de[2+ae]/2,q+8,{align:"center"}),Se+=de[2+ae],ae<ee.length-1&&T.line(Se,q,Se,q+Z);T.line(Se,q,Se,q+Z),T.text(M.position.toString(),Se+de[5]/2,q+8,{align:"center"}),q+=Z}T.setLineWidth(.5),T.line(X,q,X+se,q),T.setFont("helvetica","normal"),T.setFontSize(7),T.setTextColor(100,100,100),T.text("ALL DIMENSIONS IN MILLIMETERS",X,q+10),T.text("VERIFY ALL DIMENSIONS ON SITE",X,q+15),T.text("FURNITURE POSITIONS REFER TO FLOOR PLAN",X,q+20)}const Y=`${J.replace(/[^a-zA-Z0-9가-힣]/g,"_")}_${$.replace(/\./g,"")}.pdf`;try{T.save(Y),console.log("✅ PDF 다운로드 성공!",Y)}catch(K){console.error("PDF 다운로드 실패:",K);const V=T.output("blob"),Q=URL.createObjectURL(V),X=document.createElement("a");X.href=Q,X.download=Y,document.body.appendChild(X),X.click(),document.body.removeChild(X),URL.revokeObjectURL(Q)}return{success:!0,message:"PDF가 성공적으로 생성되었습니다.",filename:Y}}catch(T){return console.error("PDF 생성 중 오류:",T),{success:!1,message:T instanceof Error?T.message:"PDF 생성 중 오류가 발생했습니다."}}finally{e(!1)}},[t,y]),S=H.useCallback((j,C)=>j!==null&&C.length>0,[]),I=H.useCallback((j,C)=>j?C.length===0?"배치된 가구가 없습니다.":"내보낼 준비가 완료되었습니다.":"공간 정보가 없습니다.",[]);return{exportToPDF:x,canExportPDF:S,getExportStatusMessage:I,isExporting:n,VIEW_TYPES:k4}}const uwe="_header_kpiyu_1",dwe="_container_kpiyu_19",Awe="_logoSection_kpiyu_39",fwe="_hamburgerButton_kpiyu_55",pwe="_active_kpiyu_93",gwe="_logo_kpiyu_39",mwe="_projectInfo_kpiyu_195",ywe="_designFileName_kpiyu_221",wwe="_centerActions_kpiyu_277",vwe="_actionButton_kpiyu_297",xwe="_rightActions_kpiyu_411",bwe="_convertButton_kpiyu_427",Cwe="_logoutButton_kpiyu_471",_we="_loginButton_kpiyu_517",Swe="_userProfile_kpiyu_565",Twe="_userProfileName_kpiyu_597",Bwe="_userProfileAvatar_kpiyu_613",Ewe="_profileImage_kpiyu_653",Fwe="_saveSuccess_kpiyu_667",kwe="_saveError_kpiyu_699",Iwe="_fileMenuContainer_kpiyu_755",Dwe="_fileDropdown_kpiyu_795",jwe="_dropdownItem_kpiyu_827",Pwe="_convertButtonContainer_kpiyu_971",Nwe="_dropdownMenu_kpiyu_981",Ns={header:uwe,container:dwe,logoSection:Awe,hamburgerButton:fwe,active:pwe,logo:gwe,projectInfo:mwe,designFileName:ywe,centerActions:wwe,actionButton:vwe,rightActions:xwe,convertButton:bwe,logoutButton:Cwe,loginButton:_we,userProfile:Swe,userProfileName:Twe,userProfileAvatar:Bwe,profileImage:Ewe,saveSuccess:Fwe,saveError:kwe,fileMenuContainer:Iwe,fileDropdown:Dwe,dropdownItem:jwe,convertButtonContainer:Pwe,dropdownMenu:Nwe};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lwe=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Mwe=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),eM=n=>{const e=Mwe(n);return e.charAt(0).toUpperCase()+e.slice(1)},$V=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),Rwe=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Uwe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Owe=H.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...a},l)=>H.createElement("svg",{ref:l,...Uwe,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:$V("lucide",r),...!s&&!Rwe(a)&&{"aria-hidden":"true"},...a},[...o.map(([h,u])=>H.createElement(h,u)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vr=(n,e)=>{const t=H.forwardRef(({className:i,...r},s)=>H.createElement(Owe,{ref:s,iconNode:e,className:$V(`lucide-${Lwe(eM(n))}`,`lucide-${n}`,i),...r}));return t.displayName=eM(n),t};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hwe=[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]],Wwe=vr("arrow-down-to-line",Hwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zwe=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Qwe=vr("arrow-left",zwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $we=[["path",{d:"M17 12H3",key:"8awo09"}],["path",{d:"m11 18 6-6-6-6",key:"8c2y43"}],["path",{d:"M21 5v14",key:"nzette"}]],Vwe=vr("arrow-right-to-line",$we);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gwe=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],e8=vr("arrow-right",Gwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xwe=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],Ywe=vr("award",Xwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kwe=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],qwe=vr("brain",Kwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zwe=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],tM=vr("calendar",Zwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jwe=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],lf=vr("chevron-down",Jwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eve=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],tve=vr("chevron-left",eve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nve=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],__=vr("chevron-right",nve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ive=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],c6=vr("chevron-up",ive);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rve=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],VV=vr("cpu",rve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sve=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],GV=vr("download",sve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ove=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],t8=vr("eye-off",ove);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ave=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],n8=vr("eye",ave);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lve=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],cve=vr("file-down",lve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hve=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],uve=vr("file-text",hve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dve=[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]],Ave=vr("fingerprint",dve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fve=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],pve=vr("grid-3x3",fve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gve=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],mve=vr("house",gve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yve=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],S_=vr("layers",yve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wve=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],i8=vr("loader-circle",wve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vve=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],XV=vr("log-in",vve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xve=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],YV=vr("lock",xve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bve=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],r8=vr("log-out",bve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cve=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],KV=vr("mail",Cve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _ve=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]],Sve=vr("maximize",_ve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tve=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],Bve=vr("menu",Tve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eve=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],Fve=vr("mouse-pointer",Eve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kve=[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]],Ive=vr("move",kve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dve=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],qV=vr("package",Dve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jve=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],ZV=vr("pause",jve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pve=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]],Nve=vr("pen-line",Pve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lve=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],h6=vr("play",Lve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mve=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],JV=vr("plus",Mve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rve=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],Uve=vr("rocket",Rve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ove=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Hve=vr("rotate-cw",Ove);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wve=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],u6=vr("ruler",Wve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zve=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],J5=vr("settings",zve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qve=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],eG=vr("shield",Qve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ve=[["polygon",{points:"19 20 9 12 19 4 19 20",key:"o2sva"}],["line",{x1:"5",x2:"5",y1:"19",y2:"5",key:"1ocqjk"}]],Vve=vr("skip-back",$ve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gve=[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]],Xve=vr("skip-forward",Gve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yve=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],ow=vr("sparkles",Yve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kve=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],qve=vr("star",Kve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zve=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],tG=vr("trash-2",Zve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jve=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],s8=vr("upload",Jve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const exe=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],txe=vr("user-plus",exe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nxe=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],nG=vr("user",nxe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ixe=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],iG=vr("x",ixe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rxe=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],sxe=vr("zap",rxe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oxe=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],rG=vr("zoom-in",oxe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const axe=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],sG=vr("zoom-out",axe),lxe="_overlay_1a2n7_1",cxe="_modal_1a2n7_15",hxe="_header_1a2n7_28",uxe="_title_1a2n7_37",dxe="_closeButton_1a2n7_44",Axe="_content_1a2n7_63",fxe="_shortcuts_1a2n7_69",pxe="_shortcutItem_1a2n7_73",gxe="_key_1a2n7_85",mxe="_action_1a2n7_98",yxe="_tips_1a2n7_104",ed={overlay:lxe,modal:cxe,header:hxe,title:uxe,closeButton:dxe,content:Axe,shortcuts:fxe,shortcutItem:pxe,key:gxe,action:mxe,tips:yxe},wxe=({isOpen:n,onClose:e})=>{const{t}=ia();if(!n)return null;const i=[{key:"마우스 휠버튼 드래그",action:"3D 카메라 회전"},{key:"두 손가락 드래그",action:"화면 이동 (팬)"},{key:"스크롤/두 손가락 핀치",action:"줌 인/아웃"},{key:"Space",action:"카메라 초기 위치로 리셋"},{key:"가구/기둥 드래그 시",action:"자동 정면뷰 전환"},{key:"Delete / Backspace",action:t("help.shortcuts.deleteSelected")},{key:"Esc",action:t("help.shortcuts.exitEditMode")},{key:t("help.shortcuts.arrowKeys"),action:t("help.shortcuts.fineTuneMove")},{key:t("help.shortcuts.doubleClick"),action:t("help.shortcuts.editMode")},{key:t("help.shortcuts.dragDrop"),action:t("help.shortcuts.placeFurniture")}],r=s=>{s.target===s.currentTarget&&e()};return c.jsx("div",{className:ed.overlay,onClick:r,children:c.jsxs("div",{className:ed.modal,children:[c.jsxs("div",{className:ed.header,children:[c.jsx("h3",{className:ed.title,children:t("help.title")}),c.jsx("button",{className:ed.closeButton,onClick:e,children:"✕"})]}),c.jsxs("div",{className:ed.content,children:[c.jsx("div",{className:ed.shortcuts,children:i.map((s,o)=>c.jsxs("div",{className:ed.shortcutItem,children:[c.jsx("span",{className:ed.key,children:s.key}),c.jsx("span",{className:ed.action,children:s.action})]},o))}),c.jsxs("div",{className:ed.tips,children:[c.jsx("h4",{children:t("help.tips.title")}),c.jsxs("ul",{children:[c.jsx("li",{children:t("help.tips.autoPlace")}),c.jsx("li",{children:t("help.tips.editPopup")}),c.jsx("li",{children:t("help.tips.editColumn")}),c.jsx("li",{children:t("help.tips.doorInstall")})]})]})]})]})})},vxe="_sectionTitle_8zdrd_2",xxe="_checkIcon_8zdrd_11",bxe="_active_8zdrd_17",Cxe="_dropdownContainer_8zdrd_23",_xe="_trigger_8zdrd_27",Sxe="_overlay_8zdrd_46",Txe="_dropdown_8zdrd_23",Bxe="_dropdownHeader_8zdrd_69",Exe="_closeButton_8zdrd_85",Fxe="_section_8zdrd_2",kxe="_modeList_8zdrd_112",Ixe="_modeItem_8zdrd_118",Dxe="_modeIcon_8zdrd_139",jxe="_colorList_8zdrd_144",Pxe="_colorItem_8zdrd_151",Nxe="_colorPreview_8zdrd_182",Lxe="_quickToggle_8zdrd_192",Mxe="_sidebarContainer_8zdrd_214",Rxe="_sidebarLabel_8zdrd_219",Uxe="_sidebarSection_8zdrd_226",Oxe="_modeToggleTab_8zdrd_235",Hxe="_modeTabButton_8zdrd_242",Wxe="_modeName_8zdrd_274",zxe="_colorGrid_8zdrd_279",Qxe="_colorButton_8zdrd_286",_s={sectionTitle:vxe,checkIcon:xxe,active:bxe,dropdownContainer:Cxe,trigger:_xe,overlay:Sxe,dropdown:Txe,dropdownHeader:Bxe,closeButton:Exe,section:Fxe,modeList:kxe,modeItem:Ixe,modeIcon:Dxe,colorList:jxe,colorItem:Pxe,colorPreview:Nxe,quickToggle:Lxe,sidebarContainer:Mxe,sidebarLabel:Rxe,sidebarSection:Uxe,modeToggleTab:Oxe,modeTabButton:Hxe,modeName:Wxe,colorGrid:zxe,colorButton:Qxe},$xe=({variant:n="dropdown",showLabel:e=!0})=>{const{theme:t,setThemeMode:i,setThemeColor:r,toggleMode:s}=Ua(),[o,a]=H.useState(!1),{t:l}=ia(),h=[{id:"black",name:"차콜블랙",color:"#1a1a1a"},{id:"gray",name:"다크그레이",color:"#6b7280"},{id:"blue",name:"스카이블루",color:"#3b82f6"},{id:"navy",name:"로얄블루",color:"#1e3a8a"},{id:"indigo",name:"페일블루",color:"#6366f1"},{id:"teal",name:"딥틸",color:"#14b8a6"},{id:"cyan",name:"다크틸",color:"#06b6d4"},{id:"white",name:"라이트그레이",color:"#D65DB1"},{id:"plum",name:"플럼",color:"#790963"},{id:"vivid",name:"비비드",color:"#a25378"},{id:"rust",name:"선셋오렌지",color:"#FF7438"},{id:"brown",name:"다크브라운",color:"#5A2B1D"},{id:"emerald",name:"포레스트그린",color:"#059669"},{id:"darkgray",name:"블루그레이",color:"#2C3844"},{id:"wine",name:"바이올렛",color:"#845EC2"},{id:"purple",name:"딥퍼플",color:"#8b5cf6"},{id:"pink",name:"코랄핑크",color:"#ec4899"},{id:"red",name:"레드",color:"#D2042D"},{id:"maroon",name:"다크레드",color:"#3F0D0D"},{id:"turquoise",name:"터콰이즈",color:"#003A7A"},{id:"slate",name:"슬레이트",color:"#2E3A47"},{id:"copper",name:"코퍼",color:"#AD4F34"},{id:"mint",name:"민트",color:"#0CBA80"},{id:"lime",name:"라임그린",color:"#84cc16"},{id:"green",name:"그린",color:"#10b981"},{id:"forest",name:"다크그린",color:"#314d30"},{id:"olive",name:"올리브",color:"#4C462C"},{id:"yellow",name:"올리브그린",color:"#eab308"}],u=[{id:"light",name:l("settings.lightMode"),icon:c.jsx(Yj,{size:16})},{id:"dark",name:l("settings.darkMode"),icon:c.jsx(Kj,{size:16})}];return n==="sidebar"?c.jsxs("div",{className:_s.sidebarContainer,children:[e&&c.jsx("div",{className:_s.sidebarLabel,children:l("settings.themeSettings")}),c.jsxs("div",{className:_s.sidebarSection,children:[c.jsx("div",{className:_s.sectionTitle,children:l("settings.displayMode")}),c.jsx("div",{className:_s.modeToggleTab,children:u.map(d=>c.jsxs("button",{className:`${_s.modeTabButton} ${t.mode===d.id?_s.active:""}`,onClick:()=>i(d.id),title:d.name,children:[c.jsx("span",{className:_s.modeIcon,children:d.icon}),c.jsx("span",{className:_s.modeName,children:d.name})]},d.id))})]}),c.jsxs("div",{className:_s.sidebarSection,children:[c.jsx("div",{className:_s.sectionTitle,children:l("settings.themeColor")}),c.jsx("div",{className:_s.colorGrid,children:h.map(d=>c.jsx("button",{className:`${_s.colorButton} ${t.color===d.id?_s.active:""}`,onClick:()=>r(d.id),title:d.name,style:{backgroundColor:d.color},children:t.color===d.id&&c.jsx("span",{className:_s.checkIcon,children:"✓"})},d.id))})]})]}):c.jsxs("div",{className:_s.dropdownContainer,children:[c.jsxs("button",{className:_s.trigger,onClick:()=>a(!o),title:l("settings.themeSettings"),children:[c.jsx(Lk,{size:20}),e&&c.jsx("span",{children:l("settings.theme")})]}),o&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:_s.overlay,onClick:()=>a(!1)}),c.jsxs("div",{className:_s.dropdown,children:[c.jsxs("div",{className:_s.dropdownHeader,children:[c.jsx("h3",{children:l("settings.themeSettings")}),c.jsx("button",{className:_s.closeButton,onClick:()=>a(!1),children:"×"})]}),c.jsxs("div",{className:_s.section,children:[c.jsx("div",{className:_s.sectionTitle,children:l("settings.displayMode")}),c.jsx("div",{className:_s.modeList,children:u.map(d=>c.jsxs("button",{className:`${_s.modeItem} ${t.mode===d.id?_s.active:""}`,onClick:()=>{i(d.id),a(!1)},children:[c.jsx("span",{className:_s.modeIcon,children:d.icon}),c.jsx("span",{children:d.name}),t.mode===d.id&&c.jsx("span",{className:_s.checkIcon,children:"✓"})]},d.id))})]}),c.jsxs("div",{className:_s.section,children:[c.jsx("div",{className:_s.sectionTitle,children:l("settings.themeColor")}),c.jsx("div",{className:_s.colorList,children:h.map(d=>c.jsx("button",{className:`${_s.colorItem} ${t.color===d.id?_s.active:""}`,onClick:()=>{r(d.id),a(!1)},title:d.name,children:c.jsx("div",{className:_s.colorPreview,style:{backgroundColor:d.color},children:t.color===d.id&&c.jsx("span",{className:_s.checkIcon,children:"✓"})})},d.id))})]}),c.jsx("div",{className:_s.section,children:c.jsxs("button",{className:_s.quickToggle,onClick:()=>{s(),a(!1)},children:[t.mode==="light"?c.jsx(Kj,{size:16}):c.jsx(Yj,{size:16}),t.mode==="light"?l("settings.darkMode"):l("settings.lightMode")]})})]})]})]})},Vxe="_overlay_1lv4s_2",Gxe="_panel_1lv4s_13",Xxe="_header_1lv4s_37",Yxe="_title_1lv4s_46",Kxe="_closeButton_1lv4s_53",qxe="_content_1lv4s_76",Zxe="_section_1lv4s_82",Jxe="_sectionTitle_1lv4s_91",ebe="_themeContainer_1lv4s_99",tbe="_settingGroup_1lv4s_104",nbe="_settingItem_1lv4s_110",ibe="_settingInfo_1lv4s_116",rbe="_settingLabel_1lv4s_122",sbe="_settingDescription_1lv4s_128",obe="_slider_1lv4s_147",abe="_languageSelect_1lv4s_181",lbe="_shortcutList_1lv4s_210",cbe="_shortcutItem_1lv4s_216",hbe="_shortcutAction_1lv4s_223",ube="_shortcutKey_1lv4s_228",dbe="_infoList_1lv4s_239",Abe="_infoItem_1lv4s_245",fbe="_infoLabel_1lv4s_252",pbe="_infoValue_1lv4s_257",er={overlay:Vxe,panel:Gxe,header:Xxe,title:Yxe,closeButton:Kxe,content:qxe,section:Zxe,sectionTitle:Jxe,themeContainer:ebe,settingGroup:tbe,settingItem:nbe,settingInfo:ibe,settingLabel:rbe,settingDescription:sbe,switch:"_switch_1lv4s_134",slider:obe,languageSelect:abe,shortcutList:lbe,shortcutItem:cbe,shortcutAction:hbe,shortcutKey:ube,infoList:dbe,infoItem:Abe,infoLabel:fbe,infoValue:pbe},o8=({isOpen:n,onClose:e})=>{const{t,currentLanguage:i,changeLanguage:r,availableLanguages:s}=ia();H.useEffect(()=>{const a=()=>{};return window.addEventListener("languageChange",a),()=>{window.removeEventListener("languageChange",a)}},[]);const o=a=>{const l=a.target.value;console.log("🔄 Changing language from",i,"to",l),r(l),setTimeout(()=>{window.location.reload()},100)};return n?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:er.overlay,onClick:e}),c.jsxs("div",{className:er.panel,children:[c.jsxs("div",{className:er.header,children:[c.jsx("h2",{className:er.title,children:t("settings.title")}),c.jsx("button",{className:er.closeButton,onClick:e,children:"×"})]}),c.jsxs("div",{className:er.content,children:[c.jsxs("div",{className:er.section,children:[c.jsx("h3",{className:er.sectionTitle,children:t("settings.theme")}),c.jsx("div",{className:er.themeContainer,children:c.jsx($xe,{variant:"sidebar",showLabel:!1})})]}),c.jsxs("div",{className:er.section,children:[c.jsx("h3",{className:er.sectionTitle,children:t("settings.general")}),c.jsxs("div",{className:er.settingGroup,children:[c.jsxs("div",{className:er.settingItem,children:[c.jsxs("div",{className:er.settingInfo,children:[c.jsx("span",{className:er.settingLabel,children:t("settings.language")}),c.jsx("span",{className:er.settingDescription,children:t("settings.languageDesc")})]}),c.jsx("select",{value:i,onChange:o,className:er.languageSelect,children:s.map(a=>c.jsx("option",{value:a.code,children:a.name},a.code))})]}),c.jsxs("div",{className:er.settingItem,children:[c.jsxs("div",{className:er.settingInfo,children:[c.jsx("span",{className:er.settingLabel,children:t("settings.notifications")}),c.jsx("span",{className:er.settingDescription,children:t("settings.notificationsDesc")})]}),c.jsxs("label",{className:er.switch,children:[c.jsx("input",{type:"checkbox",defaultChecked:!0}),c.jsx("span",{className:er.slider})]})]}),c.jsxs("div",{className:er.settingItem,children:[c.jsxs("div",{className:er.settingInfo,children:[c.jsx("span",{className:er.settingLabel,children:t("settings.autoSave")}),c.jsx("span",{className:er.settingDescription,children:t("settings.autoSaveDesc")})]}),c.jsxs("label",{className:er.switch,children:[c.jsx("input",{type:"checkbox",defaultChecked:!0}),c.jsx("span",{className:er.slider})]})]}),c.jsxs("div",{className:er.settingItem,children:[c.jsxs("div",{className:er.settingInfo,children:[c.jsx("span",{className:er.settingLabel,children:t("settings.gridSnap")}),c.jsx("span",{className:er.settingDescription,children:t("settings.gridSnapDesc")})]}),c.jsxs("label",{className:er.switch,children:[c.jsx("input",{type:"checkbox",defaultChecked:!0}),c.jsx("span",{className:er.slider})]})]})]})]}),c.jsxs("div",{className:er.section,children:[c.jsx("h3",{className:er.sectionTitle,children:t("settings.shortcuts")}),c.jsxs("div",{className:er.shortcutList,children:[c.jsxs("div",{className:er.shortcutItem,children:[c.jsx("span",{className:er.shortcutAction,children:t("common.save")}),c.jsx("kbd",{className:er.shortcutKey,children:"Ctrl + S"})]}),c.jsxs("div",{className:er.shortcutItem,children:[c.jsx("span",{className:er.shortcutAction,children:t("common.undo")}),c.jsx("kbd",{className:er.shortcutKey,children:"Ctrl + Z"})]}),c.jsxs("div",{className:er.shortcutItem,children:[c.jsx("span",{className:er.shortcutAction,children:t("common.redo")}),c.jsx("kbd",{className:er.shortcutKey,children:"Ctrl + Y"})]}),c.jsxs("div",{className:er.shortcutItem,children:[c.jsx("span",{className:er.shortcutAction,children:t("common.copy")}),c.jsx("kbd",{className:er.shortcutKey,children:"Ctrl + C"})]}),c.jsxs("div",{className:er.shortcutItem,children:[c.jsx("span",{className:er.shortcutAction,children:t("common.paste")}),c.jsx("kbd",{className:er.shortcutKey,children:"Ctrl + V"})]})]})]}),c.jsxs("div",{className:er.section,children:[c.jsx("h3",{className:er.sectionTitle,children:t("settings.info")}),c.jsxs("div",{className:er.infoList,children:[c.jsxs("div",{className:er.infoItem,children:[c.jsx("span",{className:er.infoLabel,children:t("settings.version")}),c.jsx("span",{className:er.infoValue,children:"1.0.0"})]}),c.jsxs("div",{className:er.infoItem,children:[c.jsx("span",{className:er.infoLabel,children:t("settings.lastUpdate")}),c.jsx("span",{className:er.infoValue,children:"2024.01.15"})]})]})]})]})]})]}):null},eS=({size:n="medium"})=>{const{theme:e}=Ua(),i={small:{mSize:20,logoFontSize:14,gap:6,mBorderRadius:4},medium:{mSize:32,logoFontSize:18,gap:8,mBorderRadius:6},large:{mSize:40,logoFontSize:24,gap:10,mBorderRadius:8}}[n];return c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:i.gap,cursor:"pointer",transition:"all 0.2s ease"},children:[c.jsx("div",{style:{width:i.mSize,height:i.mSize,backgroundColor:"var(--theme-primary)",borderRadius:i.mBorderRadius,display:"flex",alignItems:"center",justifyContent:"center",color:"#ffffff",fontSize:i.mSize*.6,fontWeight:"bold",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',transition:"all 0.2s ease"},children:"m"}),c.jsx("span",{style:{fontSize:i.logoFontSize,fontWeight:"600",color:"var(--theme-text)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',transition:"color 0.2s ease"},children:"logo"})]})},gbe="_overlay_xweix_1",mbe="_popup_xweix_22",ybe="_header_xweix_50",wbe="_headerContent_xweix_56",vbe="_headerLeft_xweix_62",xbe="_headerAvatar_xweix_69",bbe="_headerAvatarPlaceholder_xweix_78",Cbe="_headerInfo_xweix_90",_be="_headerName_xweix_95",Sbe="_headerEmail_xweix_106",Tbe="_closeButton_xweix_115",Bbe="_content_xweix_135",Ebe="_section_xweix_142",Fbe="_sectionTitle_xweix_148",kbe="_infoSection_xweix_160",Ibe="_infoRow_xweix_166",Dbe="_infoLabel_xweix_181",jbe="_infoValue_xweix_194",Pbe="_menuSection_xweix_201",Nbe="_menuItem_xweix_207",Lbe="_menuLeft_xweix_232",Mbe="_uidSection_xweix_245",Rbe="_uidLabel_xweix_256",Ube="_uid_xweix_245",zs={overlay:gbe,popup:mbe,header:ybe,headerContent:wbe,headerLeft:vbe,headerAvatar:xbe,headerAvatarPlaceholder:bbe,headerInfo:Cbe,headerName:_be,headerEmail:Sbe,closeButton:Tbe,content:Bbe,section:Ebe,sectionTitle:Fbe,infoSection:kbe,infoRow:Ibe,infoLabel:Dbe,infoValue:jbe,menuSection:Pbe,menuItem:Nbe,menuLeft:Lbe,uidSection:Mbe,uidLabel:Rbe,uid:Ube},Obe=({isOpen:n,onClose:e,position:t})=>{var l,h,u,d,A,f;const{user:i}=Vc(),r=ph(),{t:s}=ia();if(!n||!i)return null;const o=p=>p?new Date(p).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"}):"정보 없음",a=p=>{if(!p)return"정보 없음";const g=new Date(p),w=new Date().getTime()-g.getTime(),m=Math.floor(w/6e4),y=Math.floor(w/36e5),x=Math.floor(w/864e5);return m<1?"방금 전":m<60?`${m}분 전`:y<24?`${y}시간 전`:x<7?`${x}일 전`:g.toLocaleDateString("ko-KR")};return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:zs.overlay,onClick:e}),c.jsxs("div",{className:zs.popup,style:{top:t.top,right:t.right},children:[c.jsx("div",{className:zs.header,children:c.jsxs("div",{className:zs.headerContent,children:[c.jsxs("div",{className:zs.headerLeft,children:[i.photoURL?c.jsx("img",{src:i.photoURL,alt:i.displayName||"사용자",className:zs.headerAvatar}):c.jsx("div",{className:zs.headerAvatarPlaceholder,children:c.jsx(nG,{size:20})}),c.jsxs("div",{className:zs.headerInfo,children:[c.jsx("h3",{className:zs.headerName,children:i.displayName||"사용자"}),c.jsx("p",{className:zs.headerEmail,children:i.email})]})]}),c.jsx("button",{className:zs.closeButton,onClick:e,children:c.jsx(iG,{size:20})})]})}),c.jsxs("div",{className:zs.content,children:[c.jsxs("div",{className:zs.section,children:[c.jsx("h4",{className:zs.sectionTitle,children:s("profile.accountInfo")}),c.jsxs("div",{className:zs.infoSection,children:[c.jsxs("div",{className:zs.infoRow,children:[c.jsxs("div",{className:zs.infoLabel,children:[c.jsx(eG,{size:18}),c.jsx("span",{children:s("profile.authMethod")})]}),c.jsx("span",{className:zs.infoValue,children:((h=(l=i.providerData)==null?void 0:l[0])==null?void 0:h.providerId)==="google.com"?s("profile.googleAccount"):((d=(u=i.providerData)==null?void 0:u[0])==null?void 0:d.providerId)==="password"?s("profile.emailAuth"):s("profile.other")})]}),c.jsxs("div",{className:zs.infoRow,children:[c.jsxs("div",{className:zs.infoLabel,children:[c.jsx(tM,{size:18}),c.jsx("span",{children:s("profile.joinDate")})]}),c.jsx("span",{className:zs.infoValue,children:o((A=i.metadata)==null?void 0:A.creationTime)})]}),c.jsxs("div",{className:zs.infoRow,children:[c.jsxs("div",{className:zs.infoLabel,children:[c.jsx(tM,{size:18}),c.jsx("span",{children:s("profile.lastActivity")})]}),c.jsx("span",{className:zs.infoValue,children:a((f=i.metadata)==null?void 0:f.lastSignInTime)})]})]})]}),c.jsxs("div",{className:zs.section,children:[c.jsx("h4",{className:zs.sectionTitle,children:s("profile.quickMenu")}),c.jsxs("div",{className:zs.menuSection,children:[c.jsxs("button",{className:zs.menuItem,children:[c.jsxs("div",{className:zs.menuLeft,children:[c.jsx(J5,{size:18}),c.jsx("span",{children:s("profile.accountSettings")})]}),c.jsx(__,{size:16})]}),c.jsxs("button",{className:zs.menuItem,onClick:async()=>{await mz(),r("/auth")},children:[c.jsxs("div",{className:zs.menuLeft,children:[c.jsx(r8,{size:18}),c.jsx("span",{children:s("common.logout")})]}),c.jsx(__,{size:16})]})]})]}),c.jsxs("div",{className:zs.uidSection,children:[c.jsx("span",{className:zs.uidLabel,children:"User ID"}),c.jsx("code",{className:zs.uid,children:i.uid})]})]})]})]})},Hbe=({title:n,projectName:e,designFileName:t,projectId:i,designFileId:r,onSave:s,onPrevious:o,onNext:a,onHelp:l,onConvert:h,onLogout:u,onProfile:d,saving:A=!1,saveStatus:f="idle",hasDoorsInstalled:p=!1,onDoorInstallationToggle:g,onNewProject:v,onSaveAs:w,onProjectNameChange:m,onDesignFileChange:y,onFileTreeToggle:x,isFileTreeOpen:S,onExportPDF:I})=>{var Ae;const{user:j}=Vc(),C=ph(),{t:b,currentLanguage:D}=ia(),[T,k]=H.useState(!1),[B,E]=H.useState(!1),[z,te]=H.useState(!1),[L,O]=H.useState(!1),[J,$]=H.useState(!1),[U,Y]=H.useState({top:60,right:20}),[K,V]=H.useState(!1),Q=H.useRef(null),X=H.useRef(null),W=H.useRef(null);console.log("🔍 Header 컴포넌트 title:",n),console.log("🔍 Header 컴포넌트 projectName:",e),H.useEffect(()=>()=>{X.current&&clearTimeout(X.current)},[]);const se=()=>{k(!0)},q=()=>{k(!1)},de=()=>{console.log("📁 파일 메뉴 토글:",!B),X.current&&(clearTimeout(X.current),X.current=null),E(!B)},Ce=()=>{X.current&&(clearTimeout(X.current),X.current=null)},Se=()=>{X.current=setTimeout(()=>{E(!1)},300)},fe=()=>{console.log("🆕 Header - 새디자인 버튼 클릭됨"),console.log("🆕 Header - onNewProject 타입:",typeof v),E(!1),v==null||v()},M=()=>{E(!1),w==null||w()},Z=()=>{if(Q.current){const ie=Q.current.getBoundingClientRect();Y({top:ie.bottom+8,right:window.innerWidth-ie.right})}$(!J)};return H.useEffect(()=>{const ie=ee=>{W.current&&!W.current.contains(ee.target)&&V(!1)};return K&&document.addEventListener("mousedown",ie),()=>{document.removeEventListener("mousedown",ie)}},[K]),c.jsxs("header",{className:Ns.header,children:[c.jsxs("div",{className:Ns.container,children:[c.jsxs("div",{className:Ns.logoSection,children:[c.jsx("button",{className:`${Ns.hamburgerButton} ${S?Ns.active:""}`,onClick:x,title:"파일 트리 열기/닫기",children:c.jsx(Bve,{size:20})}),c.jsx("div",{className:Ns.logo,children:c.jsx(eS,{size:"medium"})}),t&&c.jsx("div",{className:Ns.projectInfo,children:c.jsx("div",{className:Ns.designFileName,children:t})})]}),c.jsxs("div",{className:Ns.centerActions,children:[c.jsxs("div",{className:Ns.fileMenuContainer,onMouseEnter:Ce,onMouseLeave:Se,children:[c.jsxs("button",{className:Ns.actionButton,onClick:de,children:[c.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z",stroke:"currentColor",strokeWidth:"2"}),c.jsx("polyline",{points:"14,2 14,8 20,8",stroke:"currentColor",strokeWidth:"2"}),c.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13",stroke:"currentColor",strokeWidth:"2"}),c.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17",stroke:"currentColor",strokeWidth:"2"}),c.jsx("polyline",{points:"10,9 9,9 8,9",stroke:"currentColor",strokeWidth:"2"})]}),b("common.file"),c.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",style:{marginLeft:"4px"},children:c.jsx("polyline",{points:"6,9 12,15 18,9",stroke:"currentColor",strokeWidth:"2"})})]}),B&&c.jsxs("div",{className:Ns.fileDropdown,children:[c.jsxs("button",{className:Ns.dropdownItem,onClick:ie=>{ie.preventDefault(),ie.stopPropagation(),console.log("🆕 Header - 새디자인 버튼 직접 클릭됨"),fe()},children:[c.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z",stroke:"currentColor",strokeWidth:"2"}),c.jsx("polyline",{points:"14,2 14,8 20,8",stroke:"currentColor",strokeWidth:"2"}),c.jsx("line",{x1:"12",y1:"18",x2:"12",y2:"12",stroke:"currentColor",strokeWidth:"2"}),c.jsx("line",{x1:"9",y1:"15",x2:"15",y2:"15",stroke:"currentColor",strokeWidth:"2"})]}),D==="ko"?"새 디자인":b("project.newProject")]}),c.jsxs("button",{className:Ns.dropdownItem,onClick:ie=>{ie.preventDefault(),ie.stopPropagation(),console.log("💾 Header - 다른이름으로 저장 버튼 클릭됨"),M()},children:[c.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",stroke:"currentColor",strokeWidth:"2"}),c.jsx("polyline",{points:"17,21 17,13 7,13 7,21",stroke:"currentColor",strokeWidth:"2"}),c.jsx("polyline",{points:"7,3 7,8 15,8",stroke:"currentColor",strokeWidth:"2"}),c.jsx("path",{d:"M7 16h2v2H7z",stroke:"currentColor",strokeWidth:"1"})]}),b("project.saveAs")]})]})]}),c.jsxs("button",{className:Ns.actionButton,onClick:s,disabled:A,children:[c.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",stroke:"currentColor",strokeWidth:"2"}),c.jsx("polyline",{points:"17,21 17,13 7,13 7,21",stroke:"currentColor",strokeWidth:"2"}),c.jsx("polyline",{points:"7,3 7,8 15,8",stroke:"currentColor",strokeWidth:"2"})]}),b(A?"common.saving":"common.save")]}),o&&c.jsxs("button",{className:Ns.actionButton,onClick:o,children:[c.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:c.jsx("polyline",{points:"15,18 9,12 15,6",stroke:"currentColor",strokeWidth:"2"})}),b("common.back")]}),a&&c.jsxs("button",{className:Ns.actionButton,onClick:a,children:[c.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("path",{d:"M9 11l3 3L22 4",stroke:"currentColor",strokeWidth:"2",fill:"none"}),c.jsx("path",{d:"M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11",stroke:"currentColor",strokeWidth:"2",fill:"none"})]}),b("common.finish")]}),l&&c.jsxs("button",{className:Ns.actionButton,onClick:l,children:[c.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),c.jsx("path",{d:"m9,9a3,3 0 1 1 5.83,1c0,2-3,3-3,3",stroke:"currentColor",strokeWidth:"2"}),c.jsx("circle",{cx:"12",cy:"17",r:"1",fill:"currentColor"})]}),b("common.help")]}),c.jsxs("button",{className:Ns.actionButton,onClick:se,children:[c.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),c.jsx("path",{d:"M12 16v-4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),c.jsx("circle",{cx:"12",cy:"8",r:"0.5",fill:"currentColor",stroke:"currentColor",strokeWidth:"1"})]}),b("help.title")]})]}),c.jsxs("div",{className:Ns.rightActions,children:[c.jsx("button",{className:Ns.actionButton,onClick:()=>O(!0),title:b("settings.title"),children:c.jsx(J5,{size:20})}),I&&c.jsxs("button",{className:Ns.convertButton,onClick:()=>{console.log("내보내기 버튼 클릭됨"),I()},children:[c.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",style:{marginRight:"4px"},children:[c.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",stroke:"currentColor",strokeWidth:"2"}),c.jsx("polyline",{points:"7,10 12,15 17,10",stroke:"currentColor",strokeWidth:"2"}),c.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3",stroke:"currentColor",strokeWidth:"2"})]}),b("export.title")]}),c.jsxs("div",{className:Ns.convertButtonContainer,ref:W,children:[c.jsxs("button",{className:Ns.convertButton,onClick:()=>V(!K),children:[b("common.converting"),c.jsx(lf,{size:16,style:{marginLeft:"4px"}})]}),K&&c.jsxs("div",{className:Ns.dropdownMenu,children:[c.jsxs("button",{className:Ns.dropdownItem,onClick:()=>{console.log("CNC 옵티마이저 버튼 클릭됨");const ie={projectId:i,designFileId:r,basicInfo:Pl.getState().basicInfo,spaceInfo:hr.getState().spaceInfo,placedModules:pi.getState().placedModules,timestamp:Date.now()};sessionStorage.setItem("configurator_state_backup",JSON.stringify(ie)),console.log("💾 Configurator 상태 백업 완료");const ee=new URLSearchParams;i&&ee.set("projectId",i),r&&ee.set("designFileId",r);const ae=ee.toString();C(`/cnc-optimizer${ae?`?${ae}`:""}`,{state:{fromConfigurator:!0}}),V(!1)},children:[c.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",style:{marginRight:"8px"},children:[c.jsx("rect",{x:"3",y:"3",width:"18",height:"18",stroke:"currentColor",strokeWidth:"2"}),c.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9",stroke:"currentColor",strokeWidth:"2"}),c.jsx("line",{x1:"9",y1:"3",x2:"9",y2:"21",stroke:"currentColor",strokeWidth:"2"})]}),b("export.cuttingOptimizer")]}),h&&c.jsxs("button",{className:Ns.dropdownItem,onClick:()=>{h(),V(!1)},children:[c.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",style:{marginRight:"8px"},children:[c.jsx("rect",{x:"3",y:"3",width:"7",height:"7",stroke:"currentColor",strokeWidth:"2"}),c.jsx("rect",{x:"14",y:"3",width:"7",height:"7",stroke:"currentColor",strokeWidth:"2"}),c.jsx("rect",{x:"3",y:"14",width:"7",height:"7",stroke:"currentColor",strokeWidth:"2"}),c.jsx("rect",{x:"14",y:"14",width:"7",height:"7",stroke:"currentColor",strokeWidth:"2"})]}),b("export.drawingEditor")]})]})]}),j?c.jsxs(c.Fragment,{children:[u&&c.jsxs("button",{className:Ns.logoutButton,onClick:u,children:[c.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",stroke:"currentColor",strokeWidth:"2"}),c.jsx("polyline",{points:"16,17 21,12 16,7",stroke:"currentColor",strokeWidth:"2"}),c.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12",stroke:"currentColor",strokeWidth:"2"})]}),D==="ko"?"로그아웃":b("common.logout")]}),c.jsxs("div",{ref:Q,className:Ns.userProfile,onClick:d?Z:void 0,style:{cursor:d?"pointer":"default"},children:[c.jsx("div",{className:Ns.userProfileAvatar,children:j!=null&&j.photoURL&&!z?c.jsx("img",{src:j.photoURL,alt:j.displayName||j.email||"사용자",className:Ns.profileImage,onError:()=>te(!0),onLoad:()=>te(!1)}):c.jsx(nG,{size:16})}),c.jsx("span",{className:Ns.userProfileName,children:(j==null?void 0:j.displayName)||((Ae=j==null?void 0:j.email)==null?void 0:Ae.split("@")[0])||"사용자"})]})]}):c.jsxs("button",{className:Ns.loginButton,onClick:()=>C("/login"),children:[c.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",stroke:"currentColor",strokeWidth:"2"}),c.jsx("polyline",{points:"10 17 15 12 10 7",stroke:"currentColor",strokeWidth:"2"}),c.jsx("line",{x1:"15",y1:"12",x2:"3",y2:"12",stroke:"currentColor",strokeWidth:"2"})]}),D==="ko"?"로그인":b("common.login")]})]})]}),f==="success"&&c.jsxs("div",{className:Ns.saveSuccess,children:["✓ ",b("messages.saveSuccess")]}),f==="error"&&c.jsxs("div",{className:Ns.saveError,children:["✕ ",b("messages.saveFailed")]}),c.jsx(wxe,{isOpen:T,onClose:q}),c.jsx(o8,{isOpen:L,onClose:()=>O(!1)}),c.jsx(Obe,{isOpen:J,onClose:()=>$(!1),position:U})]})},Wbe="_sidebar_zeohw_1",zbe="_open_zeohw_15",Qbe="_tabList_zeohw_19",$be="_tabButton_zeohw_27",Vbe="_active_zeohw_46",Gbe="_tabIcon_zeohw_78",Xbe="_tabLabel_zeohw_100",Ybe="_userSection_zeohw_122",Kbe="_settingsButton_zeohw_161",qbe="_modalOverlay_zeohw_223",Zbe="_modalContent_zeohw_247",Jbe="_modalIcon_zeohw_269",eCe="_modalTitle_zeohw_281",tCe="_modalDescription_zeohw_290",nCe="_modalActions_zeohw_298",iCe="_modalButtonCancel_zeohw_304",rCe="_modalButtonConfirm_zeohw_322",uc={sidebar:Wbe,open:zbe,tabList:Qbe,tabButton:$be,active:Vbe,tabIcon:Gbe,tabLabel:Xbe,userSection:Ybe,settingsButton:Kbe,modalOverlay:qbe,modalContent:Zbe,modalIcon:Jbe,modalTitle:eCe,modalDescription:tCe,modalActions:nCe,modalButtonCancel:iCe,modalButtonConfirm:rCe},sCe=({activeTab:n,onTabClick:e,isOpen:t,onToggle:i,onResetUnsavedChanges:r})=>{const{user:s}=Vc(),{theme:o}=Ua(),a=ph(),{t:l}=ia();Pl(),hr(),pi();const[h,u]=H.useState(null),[d,A]=H.useState(!1),f=H.useCallback(()=>{const y=Pl.getState(),x=hr.getState(),S=pi.getState(),I={project:{basicInfo:y.basicInfo},spaceConfig:{spaceInfo:x.spaceInfo,materialConfig:x.materialConfig,columns:x.columns},furniture:{placedModules:S.placedModules}};u(JSON.parse(JSON.stringify(I)))},[]);H.useEffect(()=>{const y=setTimeout(()=>{f()},500);return()=>clearTimeout(y)},[f]),H.useEffect(()=>{r&&r.current!==void 0&&(r.current=f)},[r]);const p=()=>{if(!h)return!1;const y=Pl.getState(),x=hr.getState(),S=pi.getState(),I={project:{basicInfo:y.basicInfo},spaceConfig:{spaceInfo:x.spaceInfo,materialConfig:x.materialConfig,columns:x.columns},furniture:{placedModules:S.placedModules}};return JSON.stringify(h)!==JSON.stringify(I)},g=()=>{p()?A(!0):a("/dashboard")},w={green:"#10b981",blue:"#3b82f6",purple:"#8b5cf6",vivid:"#a25378",red:"#D2042D",pink:"#ec4899",indigo:"#6366f1",teal:"#14b8a6",yellow:"#eab308",gray:"#6b7280",cyan:"#06b6d4",lime:"#84cc16",black:"#1a1a1a",wine:"#845EC2",gold:"#d97706",navy:"#1e3a8a",emerald:"#059669",violet:"#C128D7",mint:"#0CBA80",neon:"#18CF23",rust:"#FF7438",white:"#D65DB1",plum:"#790963",brown:"#5A2B1D",darkgray:"#2C3844",maroon:"#3F0D0D",turquoise:"#003A7A",slate:"#2E3A47",copper:"#AD4F34",forest:"#1B3924",olive:"#4C462C"}[o.color]||"#10b981",m=[{id:"module",icon:c.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1",stroke:"currentColor",strokeWidth:"2"}),c.jsx("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1",stroke:"currentColor",strokeWidth:"2"}),c.jsx("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1",stroke:"currentColor",strokeWidth:"2"}),c.jsx("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1",stroke:"currentColor",strokeWidth:"2"})]}),label:l("sidebar.module")},{id:"material",icon:c.jsx(Phe,{size:20}),label:l("sidebar.material")},{id:"structure",icon:c.jsx(Qhe,{size:20}),label:l("sidebar.structure")},{id:"etc",icon:c.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("circle",{cx:"5",cy:"12",r:"1",stroke:"currentColor",strokeWidth:"2"}),c.jsx("circle",{cx:"12",cy:"12",r:"1",stroke:"currentColor",strokeWidth:"2"}),c.jsx("circle",{cx:"19",cy:"12",r:"1",stroke:"currentColor",strokeWidth:"2"})]}),label:l("sidebar.etc")}];return c.jsxs("aside",{className:`${uc.sidebar} ${t?uc.open:""}`,children:[c.jsx("div",{className:uc.tabList,children:m.map(y=>c.jsxs("button",{className:`${uc.tabButton} ${n===y.id?uc.active:""}`,onClick:()=>e(y.id),title:y.label,children:[y.icon&&c.jsx("div",{className:uc.tabIcon,children:y.icon}),c.jsx("span",{className:uc.tabLabel,children:y.label})]},y.id))}),c.jsx("div",{className:uc.userSection,children:c.jsx("button",{className:uc.settingsButton,title:l("sidebar.exitToDashboard"),onClick:g,children:c.jsx(r8,{size:24,style:{transform:"scaleX(-1)"},color:w})})}),d&&c.jsx("div",{className:uc.modalOverlay,onClick:()=>A(!1),children:c.jsxs("div",{className:uc.modalContent,onClick:y=>y.stopPropagation(),children:[c.jsx("div",{className:uc.modalIcon,children:c.jsx("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{d:"M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4M16 17l5-5-5-5M21 12H9",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),c.jsx("h3",{className:uc.modalTitle,children:l("messages.unsavedChanges")}),c.jsxs("p",{className:uc.modalDescription,children:[l("messages.exitConfirm"),c.jsx("br",{}),l("messages.loseChanges")]}),c.jsxs("div",{className:uc.modalActions,children:[c.jsx("button",{className:uc.modalButtonCancel,onClick:async()=>{A(!1),r!=null&&r.current&&await r.current(),a("/dashboard")},children:l("messages.exitWithSaving")}),c.jsx("button",{className:uc.modalButtonConfirm,onClick:()=>{A(!1),a("/dashboard")},children:l("messages.exitWithoutSaving")})]})]})})]})},oCe="_viewerControls_127w7_1",aCe="_leftControls_127w7_39",lCe="_toggleGroup_127w7_55",cCe="_toggleLabel_127w7_75",hCe="_clickable_127w7_97",uCe="_on_127w7_139",dCe="_off_127w7_147",ACe="_switchHandle_127w7_155",fCe="_checkboxGroup_127w7_193",pCe="_checkboxLabel_127w7_205",gCe="_checkbox_127w7_193",mCe="_checkmark_127w7_239",yCe="_centerControls_127w7_297",wCe="_rightControls_127w7_313",vCe="_renderModeGroup_127w7_343",xCe="_renderModeButton_127w7_359",bCe="_active_127w7_415",CCe="_viewModeGroup_127w7_437",_Ce="_viewModeButton_127w7_451",SCe="_doorButtonGroup_127w7_573",TCe="_doorButton_127w7_573",BCe="_viewDirectionGroup_127w7_661",ECe="_viewDirectionButton_127w7_675",FCe="_themeToggle_127w7_743",As={viewerControls:oCe,leftControls:aCe,toggleGroup:lCe,toggleLabel:cCe,clickable:hCe,switch:"_switch_127w7_117",on:uCe,off:dCe,switchHandle:ACe,checkboxGroup:fCe,checkboxLabel:pCe,checkbox:gCe,checkmark:mCe,centerControls:yCe,rightControls:wCe,renderModeGroup:vCe,renderModeButton:xCe,active:bCe,viewModeGroup:CCe,viewModeButton:_Ce,doorButtonGroup:SCe,doorButton:TCe,viewDirectionGroup:BCe,viewDirectionButton:ECe,themeToggle:FCe};var K0={},I4,nM;function kCe(){return nM||(nM=1,I4=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),I4}var D4={},Kf={},iM;function C0(){if(iM)return Kf;iM=1;let n;const e=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return Kf.getSymbolSize=function(i){if(!i)throw new Error('"version" cannot be null or undefined');if(i<1||i>40)throw new Error('"version" should be in range from 1 to 40');return i*4+17},Kf.getSymbolTotalCodewords=function(i){return e[i]},Kf.getBCHDigit=function(t){let i=0;for(;t!==0;)i++,t>>>=1;return i},Kf.setToSJISFunction=function(i){if(typeof i!="function")throw new Error('"toSJISFunc" is not a valid function.');n=i},Kf.isKanjiModeEnabled=function(){return typeof n<"u"},Kf.toSJIS=function(i){return n(i)},Kf}var j4={},rM;function a8(){return rM||(rM=1,(function(n){n.L={bit:1},n.M={bit:0},n.Q={bit:3},n.H={bit:2};function e(t){if(typeof t!="string")throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return n.L;case"m":case"medium":return n.M;case"q":case"quartile":return n.Q;case"h":case"high":return n.H;default:throw new Error("Unknown EC Level: "+t)}}n.isValid=function(i){return i&&typeof i.bit<"u"&&i.bit>=0&&i.bit<4},n.from=function(i,r){if(n.isValid(i))return i;try{return e(i)}catch{return r}}})(j4)),j4}var P4,sM;function ICe(){if(sM)return P4;sM=1;function n(){this.buffer=[],this.length=0}return n.prototype={get:function(e){const t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)===1},put:function(e,t){for(let i=0;i<t;i++)this.putBit((e>>>t-i-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},P4=n,P4}var N4,oM;function DCe(){if(oM)return N4;oM=1;function n(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}return n.prototype.set=function(e,t,i,r){const s=e*this.size+t;this.data[s]=i,r&&(this.reservedBit[s]=!0)},n.prototype.get=function(e,t){return this.data[e*this.size+t]},n.prototype.xor=function(e,t,i){this.data[e*this.size+t]^=i},n.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]},N4=n,N4}var L4={},aM;function jCe(){return aM||(aM=1,(function(n){const e=C0().getSymbolSize;n.getRowColCoords=function(i){if(i===1)return[];const r=Math.floor(i/7)+2,s=e(i),o=s===145?26:Math.ceil((s-13)/(2*r-2))*2,a=[s-7];for(let l=1;l<r-1;l++)a[l]=a[l-1]-o;return a.push(6),a.reverse()},n.getPositions=function(i){const r=[],s=n.getRowColCoords(i),o=s.length;for(let a=0;a<o;a++)for(let l=0;l<o;l++)a===0&&l===0||a===0&&l===o-1||a===o-1&&l===0||r.push([s[a],s[l]]);return r}})(L4)),L4}var M4={},lM;function PCe(){if(lM)return M4;lM=1;const n=C0().getSymbolSize,e=7;return M4.getPositions=function(i){const r=n(i);return[[0,0],[r-e,0],[0,r-e]]},M4}var R4={},cM;function NCe(){return cM||(cM=1,(function(n){n.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};n.isValid=function(r){return r!=null&&r!==""&&!isNaN(r)&&r>=0&&r<=7},n.from=function(r){return n.isValid(r)?parseInt(r,10):void 0},n.getPenaltyN1=function(r){const s=r.size;let o=0,a=0,l=0,h=null,u=null;for(let d=0;d<s;d++){a=l=0,h=u=null;for(let A=0;A<s;A++){let f=r.get(d,A);f===h?a++:(a>=5&&(o+=e.N1+(a-5)),h=f,a=1),f=r.get(A,d),f===u?l++:(l>=5&&(o+=e.N1+(l-5)),u=f,l=1)}a>=5&&(o+=e.N1+(a-5)),l>=5&&(o+=e.N1+(l-5))}return o},n.getPenaltyN2=function(r){const s=r.size;let o=0;for(let a=0;a<s-1;a++)for(let l=0;l<s-1;l++){const h=r.get(a,l)+r.get(a,l+1)+r.get(a+1,l)+r.get(a+1,l+1);(h===4||h===0)&&o++}return o*e.N2},n.getPenaltyN3=function(r){const s=r.size;let o=0,a=0,l=0;for(let h=0;h<s;h++){a=l=0;for(let u=0;u<s;u++)a=a<<1&2047|r.get(h,u),u>=10&&(a===1488||a===93)&&o++,l=l<<1&2047|r.get(u,h),u>=10&&(l===1488||l===93)&&o++}return o*e.N3},n.getPenaltyN4=function(r){let s=0;const o=r.data.length;for(let l=0;l<o;l++)s+=r.data[l];return Math.abs(Math.ceil(s*100/o/5)-10)*e.N4};function t(i,r,s){switch(i){case n.Patterns.PATTERN000:return(r+s)%2===0;case n.Patterns.PATTERN001:return r%2===0;case n.Patterns.PATTERN010:return s%3===0;case n.Patterns.PATTERN011:return(r+s)%3===0;case n.Patterns.PATTERN100:return(Math.floor(r/2)+Math.floor(s/3))%2===0;case n.Patterns.PATTERN101:return r*s%2+r*s%3===0;case n.Patterns.PATTERN110:return(r*s%2+r*s%3)%2===0;case n.Patterns.PATTERN111:return(r*s%3+(r+s)%2)%2===0;default:throw new Error("bad maskPattern:"+i)}}n.applyMask=function(r,s){const o=s.size;for(let a=0;a<o;a++)for(let l=0;l<o;l++)s.isReserved(l,a)||s.xor(l,a,t(r,l,a))},n.getBestMask=function(r,s){const o=Object.keys(n.Patterns).length;let a=0,l=1/0;for(let h=0;h<o;h++){s(h),n.applyMask(h,r);const u=n.getPenaltyN1(r)+n.getPenaltyN2(r)+n.getPenaltyN3(r)+n.getPenaltyN4(r);n.applyMask(h,r),u<l&&(l=u,a=h)}return a}})(R4)),R4}var hb={},hM;function oG(){if(hM)return hb;hM=1;const n=a8(),e=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],t=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return hb.getBlocksCount=function(r,s){switch(s){case n.L:return e[(r-1)*4+0];case n.M:return e[(r-1)*4+1];case n.Q:return e[(r-1)*4+2];case n.H:return e[(r-1)*4+3];default:return}},hb.getTotalCodewordsCount=function(r,s){switch(s){case n.L:return t[(r-1)*4+0];case n.M:return t[(r-1)*4+1];case n.Q:return t[(r-1)*4+2];case n.H:return t[(r-1)*4+3];default:return}},hb}var U4={},m2={},uM;function LCe(){if(uM)return m2;uM=1;const n=new Uint8Array(512),e=new Uint8Array(256);return(function(){let i=1;for(let r=0;r<255;r++)n[r]=i,e[i]=r,i<<=1,i&256&&(i^=285);for(let r=255;r<512;r++)n[r]=n[r-255]})(),m2.log=function(i){if(i<1)throw new Error("log("+i+")");return e[i]},m2.exp=function(i){return n[i]},m2.mul=function(i,r){return i===0||r===0?0:n[e[i]+e[r]]},m2}var dM;function MCe(){return dM||(dM=1,(function(n){const e=LCe();n.mul=function(i,r){const s=new Uint8Array(i.length+r.length-1);for(let o=0;o<i.length;o++)for(let a=0;a<r.length;a++)s[o+a]^=e.mul(i[o],r[a]);return s},n.mod=function(i,r){let s=new Uint8Array(i);for(;s.length-r.length>=0;){const o=s[0];for(let l=0;l<r.length;l++)s[l]^=e.mul(r[l],o);let a=0;for(;a<s.length&&s[a]===0;)a++;s=s.slice(a)}return s},n.generateECPolynomial=function(i){let r=new Uint8Array([1]);for(let s=0;s<i;s++)r=n.mul(r,new Uint8Array([1,e.exp(s)]));return r}})(U4)),U4}var O4,AM;function RCe(){if(AM)return O4;AM=1;const n=MCe();function e(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}return e.prototype.initialize=function(i){this.degree=i,this.genPoly=n.generateECPolynomial(this.degree)},e.prototype.encode=function(i){if(!this.genPoly)throw new Error("Encoder not initialized");const r=new Uint8Array(i.length+this.degree);r.set(i);const s=n.mod(r,this.genPoly),o=this.degree-s.length;if(o>0){const a=new Uint8Array(this.degree);return a.set(s,o),a}return s},O4=e,O4}var H4={},W4={},z4={},fM;function aG(){return fM||(fM=1,z4.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40}),z4}var Qd={},pM;function lG(){if(pM)return Qd;pM=1;const n="[0-9]+",e="[A-Z $%*+\\-./:]+";let t="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";t=t.replace(/u/g,"\\u");const i="(?:(?![A-Z0-9 $%*+\\-./:]|"+t+`)(?:.|[\r
]))+`;Qd.KANJI=new RegExp(t,"g"),Qd.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),Qd.BYTE=new RegExp(i,"g"),Qd.NUMERIC=new RegExp(n,"g"),Qd.ALPHANUMERIC=new RegExp(e,"g");const r=new RegExp("^"+t+"$"),s=new RegExp("^"+n+"$"),o=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return Qd.testKanji=function(l){return r.test(l)},Qd.testNumeric=function(l){return s.test(l)},Qd.testAlphanumeric=function(l){return o.test(l)},Qd}var gM;function _0(){return gM||(gM=1,(function(n){const e=aG(),t=lG();n.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},n.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},n.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},n.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},n.MIXED={bit:-1},n.getCharCountIndicator=function(s,o){if(!s.ccBits)throw new Error("Invalid mode: "+s);if(!e.isValid(o))throw new Error("Invalid version: "+o);return o>=1&&o<10?s.ccBits[0]:o<27?s.ccBits[1]:s.ccBits[2]},n.getBestModeForData=function(s){return t.testNumeric(s)?n.NUMERIC:t.testAlphanumeric(s)?n.ALPHANUMERIC:t.testKanji(s)?n.KANJI:n.BYTE},n.toString=function(s){if(s&&s.id)return s.id;throw new Error("Invalid mode")},n.isValid=function(s){return s&&s.bit&&s.ccBits};function i(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"numeric":return n.NUMERIC;case"alphanumeric":return n.ALPHANUMERIC;case"kanji":return n.KANJI;case"byte":return n.BYTE;default:throw new Error("Unknown mode: "+r)}}n.from=function(s,o){if(n.isValid(s))return s;try{return i(s)}catch{return o}}})(W4)),W4}var mM;function UCe(){return mM||(mM=1,(function(n){const e=C0(),t=oG(),i=a8(),r=_0(),s=aG(),o=7973,a=e.getBCHDigit(o);function l(A,f,p){for(let g=1;g<=40;g++)if(f<=n.getCapacity(g,p,A))return g}function h(A,f){return r.getCharCountIndicator(A,f)+4}function u(A,f){let p=0;return A.forEach(function(g){const v=h(g.mode,f);p+=v+g.getBitsLength()}),p}function d(A,f){for(let p=1;p<=40;p++)if(u(A,p)<=n.getCapacity(p,f,r.MIXED))return p}n.from=function(f,p){return s.isValid(f)?parseInt(f,10):p},n.getCapacity=function(f,p,g){if(!s.isValid(f))throw new Error("Invalid QR Code version");typeof g>"u"&&(g=r.BYTE);const v=e.getSymbolTotalCodewords(f),w=t.getTotalCodewordsCount(f,p),m=(v-w)*8;if(g===r.MIXED)return m;const y=m-h(g,f);switch(g){case r.NUMERIC:return Math.floor(y/10*3);case r.ALPHANUMERIC:return Math.floor(y/11*2);case r.KANJI:return Math.floor(y/13);case r.BYTE:default:return Math.floor(y/8)}},n.getBestVersionForData=function(f,p){let g;const v=i.from(p,i.M);if(Array.isArray(f)){if(f.length>1)return d(f,v);if(f.length===0)return 1;g=f[0]}else g=f;return l(g.mode,g.getLength(),v)},n.getEncodedBits=function(f){if(!s.isValid(f)||f<7)throw new Error("Invalid QR Code version");let p=f<<12;for(;e.getBCHDigit(p)-a>=0;)p^=o<<e.getBCHDigit(p)-a;return f<<12|p}})(H4)),H4}var Q4={},yM;function OCe(){if(yM)return Q4;yM=1;const n=C0(),e=1335,t=21522,i=n.getBCHDigit(e);return Q4.getEncodedBits=function(s,o){const a=s.bit<<3|o;let l=a<<10;for(;n.getBCHDigit(l)-i>=0;)l^=e<<n.getBCHDigit(l)-i;return(a<<10|l)^t},Q4}var $4={},V4,wM;function HCe(){if(wM)return V4;wM=1;const n=_0();function e(t){this.mode=n.NUMERIC,this.data=t.toString()}return e.getBitsLength=function(i){return 10*Math.floor(i/3)+(i%3?i%3*3+1:0)},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(i){let r,s,o;for(r=0;r+3<=this.data.length;r+=3)s=this.data.substr(r,3),o=parseInt(s,10),i.put(o,10);const a=this.data.length-r;a>0&&(s=this.data.substr(r),o=parseInt(s,10),i.put(o,a*3+1))},V4=e,V4}var G4,vM;function WCe(){if(vM)return G4;vM=1;const n=_0(),e=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function t(i){this.mode=n.ALPHANUMERIC,this.data=i}return t.getBitsLength=function(r){return 11*Math.floor(r/2)+6*(r%2)},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(r){let s;for(s=0;s+2<=this.data.length;s+=2){let o=e.indexOf(this.data[s])*45;o+=e.indexOf(this.data[s+1]),r.put(o,11)}this.data.length%2&&r.put(e.indexOf(this.data[s]),6)},G4=t,G4}var X4,xM;function zCe(){if(xM)return X4;xM=1;const n=_0();function e(t){this.mode=n.BYTE,typeof t=="string"?this.data=new TextEncoder().encode(t):this.data=new Uint8Array(t)}return e.getBitsLength=function(i){return i*8},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(t){for(let i=0,r=this.data.length;i<r;i++)t.put(this.data[i],8)},X4=e,X4}var Y4,bM;function QCe(){if(bM)return Y4;bM=1;const n=_0(),e=C0();function t(i){this.mode=n.KANJI,this.data=i}return t.getBitsLength=function(r){return r*13},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(i){let r;for(r=0;r<this.data.length;r++){let s=e.toSJIS(this.data[r]);if(s>=33088&&s<=40956)s-=33088;else if(s>=57408&&s<=60351)s-=49472;else throw new Error("Invalid SJIS character: "+this.data[r]+`
Make sure your charset is UTF-8`);s=(s>>>8&255)*192+(s&255),i.put(s,13)}},Y4=t,Y4}var K4={exports:{}},CM;function $Ce(){return CM||(CM=1,(function(n){var e={single_source_shortest_paths:function(t,i,r){var s={},o={};o[i]=0;var a=e.PriorityQueue.make();a.push(i,0);for(var l,h,u,d,A,f,p,g,v;!a.empty();){l=a.pop(),h=l.value,d=l.cost,A=t[h]||{};for(u in A)A.hasOwnProperty(u)&&(f=A[u],p=d+f,g=o[u],v=typeof o[u]>"u",(v||g>p)&&(o[u]=p,a.push(u,p),s[u]=h))}if(typeof r<"u"&&typeof o[r]>"u"){var w=["Could not find a path from ",i," to ",r,"."].join("");throw new Error(w)}return s},extract_shortest_path_from_predecessor_list:function(t,i){for(var r=[],s=i;s;)r.push(s),t[s],s=t[s];return r.reverse(),r},find_path:function(t,i,r){var s=e.single_source_shortest_paths(t,i,r);return e.extract_shortest_path_from_predecessor_list(s,r)},PriorityQueue:{make:function(t){var i=e.PriorityQueue,r={},s;t=t||{};for(s in i)i.hasOwnProperty(s)&&(r[s]=i[s]);return r.queue=[],r.sorter=t.sorter||i.default_sorter,r},default_sorter:function(t,i){return t.cost-i.cost},push:function(t,i){var r={value:t,cost:i};this.queue.push(r),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};n.exports=e})(K4)),K4.exports}var _M;function VCe(){return _M||(_M=1,(function(n){const e=_0(),t=HCe(),i=WCe(),r=zCe(),s=QCe(),o=lG(),a=C0(),l=$Ce();function h(w){return unescape(encodeURIComponent(w)).length}function u(w,m,y){const x=[];let S;for(;(S=w.exec(y))!==null;)x.push({data:S[0],index:S.index,mode:m,length:S[0].length});return x}function d(w){const m=u(o.NUMERIC,e.NUMERIC,w),y=u(o.ALPHANUMERIC,e.ALPHANUMERIC,w);let x,S;return a.isKanjiModeEnabled()?(x=u(o.BYTE,e.BYTE,w),S=u(o.KANJI,e.KANJI,w)):(x=u(o.BYTE_KANJI,e.BYTE,w),S=[]),m.concat(y,x,S).sort(function(j,C){return j.index-C.index}).map(function(j){return{data:j.data,mode:j.mode,length:j.length}})}function A(w,m){switch(m){case e.NUMERIC:return t.getBitsLength(w);case e.ALPHANUMERIC:return i.getBitsLength(w);case e.KANJI:return s.getBitsLength(w);case e.BYTE:return r.getBitsLength(w)}}function f(w){return w.reduce(function(m,y){const x=m.length-1>=0?m[m.length-1]:null;return x&&x.mode===y.mode?(m[m.length-1].data+=y.data,m):(m.push(y),m)},[])}function p(w){const m=[];for(let y=0;y<w.length;y++){const x=w[y];switch(x.mode){case e.NUMERIC:m.push([x,{data:x.data,mode:e.ALPHANUMERIC,length:x.length},{data:x.data,mode:e.BYTE,length:x.length}]);break;case e.ALPHANUMERIC:m.push([x,{data:x.data,mode:e.BYTE,length:x.length}]);break;case e.KANJI:m.push([x,{data:x.data,mode:e.BYTE,length:h(x.data)}]);break;case e.BYTE:m.push([{data:x.data,mode:e.BYTE,length:h(x.data)}])}}return m}function g(w,m){const y={},x={start:{}};let S=["start"];for(let I=0;I<w.length;I++){const j=w[I],C=[];for(let b=0;b<j.length;b++){const D=j[b],T=""+I+b;C.push(T),y[T]={node:D,lastCount:0},x[T]={};for(let k=0;k<S.length;k++){const B=S[k];y[B]&&y[B].node.mode===D.mode?(x[B][T]=A(y[B].lastCount+D.length,D.mode)-A(y[B].lastCount,D.mode),y[B].lastCount+=D.length):(y[B]&&(y[B].lastCount=D.length),x[B][T]=A(D.length,D.mode)+4+e.getCharCountIndicator(D.mode,m))}}S=C}for(let I=0;I<S.length;I++)x[S[I]].end=0;return{map:x,table:y}}function v(w,m){let y;const x=e.getBestModeForData(w);if(y=e.from(m,x),y!==e.BYTE&&y.bit<x.bit)throw new Error('"'+w+'" cannot be encoded with mode '+e.toString(y)+`.
 Suggested mode is: `+e.toString(x));switch(y===e.KANJI&&!a.isKanjiModeEnabled()&&(y=e.BYTE),y){case e.NUMERIC:return new t(w);case e.ALPHANUMERIC:return new i(w);case e.KANJI:return new s(w);case e.BYTE:return new r(w)}}n.fromArray=function(m){return m.reduce(function(y,x){return typeof x=="string"?y.push(v(x,null)):x.data&&y.push(v(x.data,x.mode)),y},[])},n.fromString=function(m,y){const x=d(m,a.isKanjiModeEnabled()),S=p(x),I=g(S,y),j=l.find_path(I.map,"start","end"),C=[];for(let b=1;b<j.length-1;b++)C.push(I.table[j[b]].node);return n.fromArray(f(C))},n.rawSplit=function(m){return n.fromArray(d(m,a.isKanjiModeEnabled()))}})($4)),$4}var SM;function GCe(){if(SM)return D4;SM=1;const n=C0(),e=a8(),t=ICe(),i=DCe(),r=jCe(),s=PCe(),o=NCe(),a=oG(),l=RCe(),h=UCe(),u=OCe(),d=_0(),A=VCe();function f(I,j){const C=I.size,b=s.getPositions(j);for(let D=0;D<b.length;D++){const T=b[D][0],k=b[D][1];for(let B=-1;B<=7;B++)if(!(T+B<=-1||C<=T+B))for(let E=-1;E<=7;E++)k+E<=-1||C<=k+E||(B>=0&&B<=6&&(E===0||E===6)||E>=0&&E<=6&&(B===0||B===6)||B>=2&&B<=4&&E>=2&&E<=4?I.set(T+B,k+E,!0,!0):I.set(T+B,k+E,!1,!0))}}function p(I){const j=I.size;for(let C=8;C<j-8;C++){const b=C%2===0;I.set(C,6,b,!0),I.set(6,C,b,!0)}}function g(I,j){const C=r.getPositions(j);for(let b=0;b<C.length;b++){const D=C[b][0],T=C[b][1];for(let k=-2;k<=2;k++)for(let B=-2;B<=2;B++)k===-2||k===2||B===-2||B===2||k===0&&B===0?I.set(D+k,T+B,!0,!0):I.set(D+k,T+B,!1,!0)}}function v(I,j){const C=I.size,b=h.getEncodedBits(j);let D,T,k;for(let B=0;B<18;B++)D=Math.floor(B/3),T=B%3+C-8-3,k=(b>>B&1)===1,I.set(D,T,k,!0),I.set(T,D,k,!0)}function w(I,j,C){const b=I.size,D=u.getEncodedBits(j,C);let T,k;for(T=0;T<15;T++)k=(D>>T&1)===1,T<6?I.set(T,8,k,!0):T<8?I.set(T+1,8,k,!0):I.set(b-15+T,8,k,!0),T<8?I.set(8,b-T-1,k,!0):T<9?I.set(8,15-T-1+1,k,!0):I.set(8,15-T-1,k,!0);I.set(b-8,8,1,!0)}function m(I,j){const C=I.size;let b=-1,D=C-1,T=7,k=0;for(let B=C-1;B>0;B-=2)for(B===6&&B--;;){for(let E=0;E<2;E++)if(!I.isReserved(D,B-E)){let z=!1;k<j.length&&(z=(j[k]>>>T&1)===1),I.set(D,B-E,z),T--,T===-1&&(k++,T=7)}if(D+=b,D<0||C<=D){D-=b,b=-b;break}}}function y(I,j,C){const b=new t;C.forEach(function(E){b.put(E.mode.bit,4),b.put(E.getLength(),d.getCharCountIndicator(E.mode,I)),E.write(b)});const D=n.getSymbolTotalCodewords(I),T=a.getTotalCodewordsCount(I,j),k=(D-T)*8;for(b.getLengthInBits()+4<=k&&b.put(0,4);b.getLengthInBits()%8!==0;)b.putBit(0);const B=(k-b.getLengthInBits())/8;for(let E=0;E<B;E++)b.put(E%2?17:236,8);return x(b,I,j)}function x(I,j,C){const b=n.getSymbolTotalCodewords(j),D=a.getTotalCodewordsCount(j,C),T=b-D,k=a.getBlocksCount(j,C),B=b%k,E=k-B,z=Math.floor(b/k),te=Math.floor(T/k),L=te+1,O=z-te,J=new l(O);let $=0;const U=new Array(k),Y=new Array(k);let K=0;const V=new Uint8Array(I.buffer);for(let q=0;q<k;q++){const de=q<E?te:L;U[q]=V.slice($,$+de),Y[q]=J.encode(U[q]),$+=de,K=Math.max(K,de)}const Q=new Uint8Array(b);let X=0,W,se;for(W=0;W<K;W++)for(se=0;se<k;se++)W<U[se].length&&(Q[X++]=U[se][W]);for(W=0;W<O;W++)for(se=0;se<k;se++)Q[X++]=Y[se][W];return Q}function S(I,j,C,b){let D;if(Array.isArray(I))D=A.fromArray(I);else if(typeof I=="string"){let z=j;if(!z){const te=A.rawSplit(I);z=h.getBestVersionForData(te,C)}D=A.fromString(I,z||40)}else throw new Error("Invalid data");const T=h.getBestVersionForData(D,C);if(!T)throw new Error("The amount of data is too big to be stored in a QR Code");if(!j)j=T;else if(j<T)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+T+`.
`);const k=y(j,C,D),B=n.getSymbolSize(j),E=new i(B);return f(E,j),p(E),g(E,j),w(E,C,0),j>=7&&v(E,j),m(E,k),isNaN(b)&&(b=o.getBestMask(E,w.bind(null,E,C))),o.applyMask(b,E),w(E,C,b),{modules:E,version:j,errorCorrectionLevel:C,maskPattern:b,segments:D}}return D4.create=function(j,C){if(typeof j>"u"||j==="")throw new Error("No input text");let b=e.M,D,T;return typeof C<"u"&&(b=e.from(C.errorCorrectionLevel,e.M),D=h.from(C.version),T=o.from(C.maskPattern),C.toSJISFunc&&n.setToSJISFunction(C.toSJISFunc)),S(j,D,b,T)},D4}var q4={},Z4={},TM;function cG(){return TM||(TM=1,(function(n){function e(t){if(typeof t=="number"&&(t=t.toString()),typeof t!="string")throw new Error("Color should be defined as hex string");let i=t.slice().replace("#","").split("");if(i.length<3||i.length===5||i.length>8)throw new Error("Invalid hex color: "+t);(i.length===3||i.length===4)&&(i=Array.prototype.concat.apply([],i.map(function(s){return[s,s]}))),i.length===6&&i.push("F","F");const r=parseInt(i.join(""),16);return{r:r>>24&255,g:r>>16&255,b:r>>8&255,a:r&255,hex:"#"+i.slice(0,6).join("")}}n.getOptions=function(i){i||(i={}),i.color||(i.color={});const r=typeof i.margin>"u"||i.margin===null||i.margin<0?4:i.margin,s=i.width&&i.width>=21?i.width:void 0,o=i.scale||4;return{width:s,scale:s?4:o,margin:r,color:{dark:e(i.color.dark||"#000000ff"),light:e(i.color.light||"#ffffffff")},type:i.type,rendererOpts:i.rendererOpts||{}}},n.getScale=function(i,r){return r.width&&r.width>=i+r.margin*2?r.width/(i+r.margin*2):r.scale},n.getImageWidth=function(i,r){const s=n.getScale(i,r);return Math.floor((i+r.margin*2)*s)},n.qrToImageData=function(i,r,s){const o=r.modules.size,a=r.modules.data,l=n.getScale(o,s),h=Math.floor((o+s.margin*2)*l),u=s.margin*l,d=[s.color.light,s.color.dark];for(let A=0;A<h;A++)for(let f=0;f<h;f++){let p=(A*h+f)*4,g=s.color.light;if(A>=u&&f>=u&&A<h-u&&f<h-u){const v=Math.floor((A-u)/l),w=Math.floor((f-u)/l);g=d[a[v*o+w]?1:0]}i[p++]=g.r,i[p++]=g.g,i[p++]=g.b,i[p]=g.a}}})(Z4)),Z4}var BM;function XCe(){return BM||(BM=1,(function(n){const e=cG();function t(r,s,o){r.clearRect(0,0,s.width,s.height),s.style||(s.style={}),s.height=o,s.width=o,s.style.height=o+"px",s.style.width=o+"px"}function i(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}n.render=function(s,o,a){let l=a,h=o;typeof l>"u"&&(!o||!o.getContext)&&(l=o,o=void 0),o||(h=i()),l=e.getOptions(l);const u=e.getImageWidth(s.modules.size,l),d=h.getContext("2d"),A=d.createImageData(u,u);return e.qrToImageData(A.data,s,l),t(d,h,u),d.putImageData(A,0,0),h},n.renderToDataURL=function(s,o,a){let l=a;typeof l>"u"&&(!o||!o.getContext)&&(l=o,o=void 0),l||(l={});const h=n.render(s,o,l),u=l.type||"image/png",d=l.rendererOpts||{};return h.toDataURL(u,d.quality)}})(q4)),q4}var J4={},EM;function YCe(){if(EM)return J4;EM=1;const n=cG();function e(r,s){const o=r.a/255,a=s+'="'+r.hex+'"';return o<1?a+" "+s+'-opacity="'+o.toFixed(2).slice(1)+'"':a}function t(r,s,o){let a=r+s;return typeof o<"u"&&(a+=" "+o),a}function i(r,s,o){let a="",l=0,h=!1,u=0;for(let d=0;d<r.length;d++){const A=Math.floor(d%s),f=Math.floor(d/s);!A&&!h&&(h=!0),r[d]?(u++,d>0&&A>0&&r[d-1]||(a+=h?t("M",A+o,.5+f+o):t("m",l,0),l=0,h=!1),A+1<s&&r[d+1]||(a+=t("h",u),u=0)):l++}return a}return J4.render=function(s,o,a){const l=n.getOptions(o),h=s.modules.size,u=s.modules.data,d=h+l.margin*2,A=l.color.light.a?"<path "+e(l.color.light,"fill")+' d="M0 0h'+d+"v"+d+'H0z"/>':"",f="<path "+e(l.color.dark,"stroke")+' d="'+i(u,h,l.margin)+'"/>',p='viewBox="0 0 '+d+" "+d+'"',v='<svg xmlns="http://www.w3.org/2000/svg" '+(l.width?'width="'+l.width+'" height="'+l.width+'" ':"")+p+' shape-rendering="crispEdges">'+A+f+`</svg>
`;return typeof a=="function"&&a(null,v),v},J4}var FM;function KCe(){if(FM)return K0;FM=1;const n=kCe(),e=GCe(),t=XCe(),i=YCe();function r(s,o,a,l,h){const u=[].slice.call(arguments,1),d=u.length,A=typeof u[d-1]=="function";if(!A&&!n())throw new Error("Callback required as last argument");if(A){if(d<2)throw new Error("Too few arguments provided");d===2?(h=a,a=o,o=l=void 0):d===3&&(o.getContext&&typeof h>"u"?(h=l,l=void 0):(h=l,l=a,a=o,o=void 0))}else{if(d<1)throw new Error("Too few arguments provided");return d===1?(a=o,o=l=void 0):d===2&&!o.getContext&&(l=a,a=o,o=void 0),new Promise(function(f,p){try{const g=e.create(a,l);f(s(g,o,l))}catch(g){p(g)}})}try{const f=e.create(a,l);h(null,s(f,o,l))}catch(f){h(f)}}return K0.create=e.create,K0.toCanvas=r.bind(null,t.render),K0.toDataURL=r.bind(null,t.renderToDataURL),K0.toString=r.bind(null,function(s,o,a){return i.render(s,a)}),K0}var qCe=KCe();const kM=Vp(qCe),ZCe="_overlay_1nd5f_1",JCe="_modal_1nd5f_14",e_e="_header_1nd5f_25",t_e="_closeButton_1nd5f_39",n_e="_content_1nd5f_59",i_e="_loading_1nd5f_63",r_e="_qrContainer_1nd5f_69",s_e="_instructions_1nd5f_92",o_e="_urlSection_1nd5f_113",a_e="_urlInput_1nd5f_119",l_e="_copyButton_1nd5f_130",c_e="_requirements_1nd5f_145",h_e="_error_1nd5f_169",u_e="_retryButton_1nd5f_180",d_e="_warning_1nd5f_196",A_e="_iosNotice_1nd5f_222",Lc={overlay:ZCe,modal:JCe,header:e_e,closeButton:t_e,content:n_e,loading:i_e,qrContainer:r_e,instructions:s_e,urlSection:o_e,urlInput:a_e,copyButton:l_e,requirements:c_e,error:h_e,retryButton:u_e,warning:d_e,iosNotice:A_e},f_e=({onClose:n})=>{const e=H.useRef(null),[t,i]=H.useState(""),[r,s]=H.useState(!0),[o,a]=H.useState(null),[l,h]=H.useState(null),{placedModules:u}=pi(),{spaceInfo:d}=hr(),{projectId:A}=Pl();H.useEffect(()=>{f()},[]);const f=async()=>{try{a(null),s(!0);const g={projectId:A,spaceInfo:{width:d.width,height:d.height,depth:d.depth,materialConfig:d.materialConfig,baseConfig:d.baseConfig,frameSize:d.frameSize,surroundType:d.surroundType},placedModules:u.map(y=>({id:y.id,moduleId:y.moduleId,position:y.position,rotation:y.rotation,slotIndex:y.slotIndex,customDepth:y.customDepth,hasDoor:y.hasDoor,hingePosition:y.hingePosition,adjustedWidth:y.adjustedWidth,adjustedPosition:y.adjustedPosition})),timestamp:Date.now()},v=`ar_${Date.now()}`;localStorage.setItem(`ar_data_${v}`,JSON.stringify(g));const w=window.location.origin,m=`${w}/ar-viewer?id=${v}`;i(m),(w.includes("localhost")||w.includes("127.0.0.1"))&&console.warn("AR requires HTTPS. Use ngrok or deploy to a server with HTTPS.");try{e.current&&(e.current.width=300,e.current.height=300,await kM.toCanvas(e.current,m,{width:300,margin:2,color:{dark:"#000000",light:"#FFFFFF"},errorCorrectionLevel:"M"}),console.log("QR Code generated on canvas for URL:",m));const y=await kM.toDataURL(m,{width:300,margin:2,color:{dark:"#000000",light:"#FFFFFF"},errorCorrectionLevel:"M"});h(y),console.log("QR Code data URL generated")}catch(y){throw console.error("QR code generation error:",y),y}s(!1)}catch(g){console.error("QR 코드 생성 오류:",g),a("QR 코드 생성에 실패했습니다. 다시 시도해주세요."),s(!1)}},p=()=>{navigator.clipboard.writeText(t),alert("URL이 클립보드에 복사되었습니다.")};return Km.createPortal(c.jsx("div",{className:Lc.overlay,children:c.jsxs("div",{className:Lc.modal,children:[c.jsxs("div",{className:Lc.header,children:[c.jsx("h2",{children:"AR 뷰어 QR 코드"}),c.jsx("button",{className:Lc.closeButton,onClick:n,children:"✕"})]}),c.jsx("div",{className:Lc.content,children:r?c.jsx("div",{className:Lc.loading,children:"QR 코드 생성 중..."}):o?c.jsxs("div",{className:Lc.error,children:[c.jsx("p",{children:o}),c.jsx("button",{onClick:f,className:Lc.retryButton,children:"다시 시도"})]}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:Lc.qrContainer,children:l?c.jsx("img",{src:l,alt:"AR QR Code",style:{display:"block",width:"300px",height:"300px"}}):c.jsx("canvas",{ref:e,style:{display:"block",width:"300px",height:"300px"}})}),c.jsxs("div",{className:Lc.instructions,children:[c.jsx("h3",{children:"사용 방법"}),c.jsxs("ol",{children:[c.jsx("li",{children:"모바일 기기의 카메라로 QR 코드를 스캔하세요"}),c.jsx("li",{children:"AR 뷰어가 자동으로 열립니다"}),c.jsx("li",{children:"카메라 권한을 허용하세요"}),c.jsx("li",{children:"평평한 바닥을 찾아 탭하여 가구를 배치하세요"})]}),(t.includes("localhost")||t.includes("127.0.0.1"))&&c.jsxs("div",{className:Lc.warning,children:[c.jsx("strong",{children:"⚠️ 주의:"})," AR 기능은 HTTPS가 필요합니다. 로컬 개발 환경에서는 작동하지 않을 수 있습니다.",c.jsx("br",{}),c.jsx("strong",{children:"해결 방법:"}),c.jsxs("ul",{children:[c.jsx("li",{children:"배포된 서버에서 사용하세요"}),c.jsx("li",{children:"또는 ngrok 등으로 HTTPS 터널을 만드세요"})]})]})]}),c.jsxs("div",{className:Lc.urlSection,children:[c.jsx("input",{type:"text",value:t,readOnly:!0,className:Lc.urlInput}),c.jsx("button",{className:Lc.copyButton,onClick:p,children:"복사"})]}),c.jsxs("div",{className:Lc.requirements,children:[c.jsx("h4",{children:"지원 기기"}),c.jsxs("ul",{children:[c.jsx("li",{children:"iOS: AR Quick Look (USDZ 파일) - 개발 중"}),c.jsx("li",{children:"Android 7+ (Chrome) - WebXR 지원"})]}),c.jsxs("div",{className:Lc.iosNotice,children:[c.jsx("strong",{children:"📱 iOS 사용자 안내:"}),c.jsx("p",{children:"현재 iOS Safari는 WebXR을 지원하지 않습니다."}),c.jsx("p",{children:"대신 3D 뷰어로 가구 배치를 확인하실 수 있습니다."})]})]})]})})]})}),document.body)},p_e=({viewMode:n,onViewModeChange:e,viewDirection:t,onViewDirectionChange:i,renderMode:r,onRenderModeChange:s,showAll:o,onShowAllToggle:a,showDimensions:l,onShowDimensionsToggle:h,showDimensionsText:u,onShowDimensionsTextToggle:d,showGuides:A,onShowGuidesToggle:f,showAxis:p,onShowAxisToggle:g,showFurniture:v,onShowFurnitureToggle:w,doorsOpen:m,onDoorsToggle:y,hasDoorsInstalled:x=!1,onDoorInstallationToggle:S})=>{const{view2DDirection:I,setView2DDirection:j,view2DTheme:C,toggleView2DTheme:b,setView2DTheme:D}=Wi(),{theme:T}=Ua(),[k,B]=H.useState(!1);H.useEffect(()=>{try{const U=localStorage.getItem("ui-store");if(U){const Y=JSON.parse(U);Y.state&&Y.state.view2DTheme!==void 0&&(delete Y.state.view2DTheme,localStorage.setItem("ui-store",JSON.stringify(Y)))}}catch(U){console.warn("localStorage 정리 실패:",U)}const $=T.mode==="dark"?"dark":"light";console.log("ViewerControls mount - theme mode:",T.mode,"setting 2D theme to:",$),D($)},[T,D]);const{t:E}=yv(),z=[{id:"3D",label:"3D"},{id:"2D",label:"2D"}],te=[{id:"front",label:E("viewer.front")},{id:"top",label:E("viewer.top")},{id:"left",label:E("viewer.left")},{id:"right",label:E("viewer.right")}],L=[{id:"all",label:E("viewer.all")},...te],O=[{id:"solid",label:E("viewer.solid")},{id:"wireframe",label:E("viewer.wireframe")}],J=$=>{j($),i($)};return c.jsxs("div",{className:As.viewerControls,children:[c.jsxs("div",{className:As.leftControls,children:[c.jsxs("div",{className:As.toggleGroup,children:[c.jsx("span",{className:`${As.toggleLabel} ${As.clickable}`,onClick:()=>{h()},style:{cursor:"pointer"},children:l?E("viewer.on").toUpperCase():E("viewer.off").toUpperCase()}),c.jsx("button",{className:`${As.switch} ${l?As.on:As.off}`,onClick:()=>{h()},children:c.jsx("div",{className:As.switchHandle})})]}),l&&c.jsxs("div",{className:As.checkboxGroup,children:[n==="2D"&&c.jsxs("label",{className:As.checkboxLabel,children:[c.jsx("input",{type:"checkbox",checked:v,onChange:w,className:As.checkbox}),c.jsx("span",{className:As.checkmark}),E("furniture.title")]}),c.jsxs("label",{className:As.checkboxLabel,children:[c.jsx("input",{type:"checkbox",checked:o,onChange:a,className:As.checkbox}),c.jsx("span",{className:As.checkmark}),E("viewer.column")]}),c.jsxs("label",{className:As.checkboxLabel,children:[c.jsx("input",{type:"checkbox",checked:u,onChange:d,className:As.checkbox}),c.jsx("span",{className:As.checkmark}),E("viewer.dimensions")]}),n==="2D"&&c.jsxs(c.Fragment,{children:[c.jsxs("label",{className:As.checkboxLabel,children:[c.jsx("input",{type:"checkbox",checked:A,onChange:f,className:As.checkbox}),c.jsx("span",{className:As.checkmark}),E("viewer.grid")]}),c.jsxs("label",{className:As.checkboxLabel,children:[c.jsx("input",{type:"checkbox",checked:p,onChange:g,className:As.checkbox}),c.jsx("span",{className:As.checkmark}),E("viewer.axis")]})]})]})]}),c.jsxs("div",{className:As.centerControls,children:[c.jsx("div",{className:As.renderModeGroup,children:O.map($=>c.jsx("button",{className:`${As.renderModeButton} ${r===$.id?As.active:""}`,onClick:()=>s($.id),children:$.label},$.id))}),c.jsx("div",{className:As.viewModeGroup,children:z.map($=>c.jsx("button",{"data-view-mode":$.id,className:`${As.viewModeButton} ${n===$.id?As.active:""}`,onClick:()=>{if(e($.id),$.id==="2D"){r!=="wireframe"&&s("wireframe");const U=T.mode==="dark"?"dark":"light";D(U)}},title:$.id==="3D"?"3D":"2D",children:$.label},$.id))}),S&&c.jsx("div",{className:As.doorButtonGroup,children:c.jsxs("button",{className:`${As.doorButton} ${x?As.active:""}`,onClick:S,children:[c.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",stroke:"currentColor",strokeWidth:"2"}),c.jsx("circle",{cx:"9",cy:"12",r:"1",fill:"currentColor"}),x&&c.jsx("path",{d:"M8 12l2 2 4-4",stroke:"currentColor",strokeWidth:"2",fill:"none"})]}),E("viewer.doorInstallation")]})})]}),c.jsx("div",{className:As.rightControls,children:n==="2D"&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:As.viewDirectionGroup,children:L.map($=>c.jsx("button",{"data-view-direction":$.id,className:`${As.viewDirectionButton} ${I===$.id?As.active:""}`,onClick:()=>J($.id),children:$.label},$.id))}),c.jsx("button",{className:As.themeToggle,onClick:()=>{b()},title:E(C==="dark"?"settings.lightMode":"settings.darkMode"),children:C==="dark"?c.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:c.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}):c.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[c.jsx("circle",{cx:"12",cy:"12",r:"5"}),c.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),c.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),c.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),c.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),c.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),c.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),c.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),c.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]})})]})}),k&&c.jsx(f_e,{onClose:()=>B(!1)})]})},g_e="_active_x73xh_42",m_e="_sliderHandle_x73xh_237",y_e="_doorSlider_x73xh_441",w_e="_sliderTrack_x73xh_446",v_e="_sliderActiveTrack_x73xh_455",x_e="_sliderLabels_x73xh_499",q0={active:g_e,sliderHandle:m_e,doorSlider:y_e,sliderTrack:w_e,sliderActiveTrack:v_e,sliderLabels:x_e},eT=({value:n,onChange:e,width:t})=>{var j,C,b,D;const[i,r]=H.useState(!1),s=ci.useRef(null),{spaceInfo:o}=hr(),a=588,l=()=>{var T;if((T=o.droppedCeiling)!=null&&T.enabled){const k=t-(o.droppedCeiling.width||1300);return console.log("🎯 메인 구간 폭 계산 (DoorSlider):",{totalWidth:t,droppedWidth:o.droppedCeiling.width||1300,mainZoneWidth:k}),k}return t},h=(T,k=!1)=>{var $;if(($=o.droppedCeiling)!=null&&$.enabled){const Y=T-50,K=600,V=400,Q=Math.ceil(Y/K),X=Math.floor(Y/V);return console.log("🎯 슬롯 계산 (단내림 활성화):",{isForDroppedCeiling:k,구간:k?"단내림 구간":"메인 구간",spaceWidth:T,normalAreaInternalWidth:Y,minRequiredSlots:Q,maxPossibleSlots:X,maxSlotWidth:K,minSlotWidth:V}),{min:Math.max(1,Q),max:Math.max(Q,X),ideal:Math.max(Q,Math.round(Y/500))}}const E=T-100,z=400,L=Math.max(1,Math.ceil(E/600)),O=Math.min(20,Math.floor(E/z)),J=Math.round(E/a);return{min:L,max:O,ideal:J}},u=((j=o.droppedCeiling)==null?void 0:j.enabled)&&t===(o.droppedCeiling.width||1300);console.log("🔍 슬라이더 타입 확인:",{width:t,droppedWidth:(C=o.droppedCeiling)==null?void 0:C.width,isDroppedCeilingSlider:u,enabled:(b=o.droppedCeiling)==null?void 0:b.enabled});let d;if(u)d=h(t,!0),console.log("🎯 단내림 구간 도어개수 슬라이더:",{width:t,droppedCeilingWidth:(D=o.droppedCeiling)==null?void 0:D.width,doorRange:d,value:n,isDroppedCeilingSlider:u});else{const T=l();d=h(T,!1),console.log("🎯 메인 구간 도어개수 슬라이더:",{mainZoneWidth:T,doorRange:d,value:n,isDroppedCeilingSlider:u})}const A=d.min,f=d.max,p=Math.max(A,Math.min(f,n)),g=T=>f===A?0:(T-A)/(f-A)*100,v=ci.useCallback(T=>{const k=Math.max(0,Math.min(100,T)),B=Math.round(A+k/100*(f-A));return Math.max(A,Math.min(f,B))},[A,f]),w=T=>{if(T.preventDefault(),r(!0),s.current){const k=s.current.getBoundingClientRect(),B=(T.clientX-k.left)/k.width*100,E=v(B);E!==n&&e(E)}},m=ci.useCallback(T=>{if(!i||!s.current)return;const k=s.current.getBoundingClientRect(),B=(T.clientX-k.left)/k.width*100,E=v(B);E!==n&&e(E)},[i,n,e,v]),y=ci.useCallback(()=>{r(!1)},[]);ci.useEffect(()=>{if(i){const T=B=>m(B),k=()=>y();return document.addEventListener("mousemove",T),document.addEventListener("mouseup",k),document.body.style.userSelect="none",()=>{document.removeEventListener("mousemove",T),document.removeEventListener("mouseup",k),document.body.style.userSelect=""}}},[i,m,y]),ci.useEffect(()=>{p!==n&&e(p)},[p,n]),ci.useEffect(()=>{var B;const T=u?t:l(),k=h(T,u);if((B=o.droppedCeiling)!=null&&B.enabled){const z=T-50,L=Math.ceil(z/600);if(n<L){console.log(`🔧 단내림 활성화 시 메인 구간 도어 개수 자동 조정: ${n} → ${L}`),e(L);return}}if(n<k.min||n>k.max){const E=Math.max(k.min,Math.min(k.max,n));e(E)}},[t,n,o.droppedCeiling]);const S=(()=>{const T=f-A+1;if(console.log("🎯 DoorSlider 라벨 생성:",{minDoors:A,maxDoors:f,doorCount:T,clampedValue:p}),T<=8){const k=[];for(let B=A;B<=f;B++)k.push(B);return console.log("🎯 생성된 라벨:",k),k}else{const k=[],B=Math.ceil(T/7);for(let E=A;E<=f;E+=B)E<=f&&k.push(E);return k.length>0&&k[k.length-1]<f&&k.push(f),console.log("🎯 생성된 라벨:",k),k}})(),I=g(p);return console.log("🎯 DoorSlider 렌더링:",{labels:S,sliderPosition:I,clampedValue:p,minDoors:A,maxDoors:f}),c.jsxs("div",{className:q0.doorSlider,children:[c.jsxs("div",{ref:s,className:q0.sliderTrack,onClick:T=>{const k=T.currentTarget.getBoundingClientRect(),B=(T.clientX-k.left)/k.width*100,E=v(B);e(E)},children:[c.jsx("div",{className:q0.sliderActiveTrack,style:{width:`${I}%`,pointerEvents:"none"}}),c.jsx("div",{className:q0.sliderHandle,style:{left:`${I}%`},onMouseDown:T=>{T.stopPropagation(),w(T)}})]}),c.jsx("div",{className:q0.sliderLabels,children:S.map(T=>c.jsx("span",{className:T===p?q0.active:"",onClick:()=>e(T),children:T},T))})]})},b_e="_dropdown_9t4eg_2",C_e="_trigger_9t4eg_9",__e="_projectName_9t4eg_23",S_e="_arrow_9t4eg_27",T_e="_active_9t4eg_31",B_e="_triggerContent_9t4eg_40",E_e="_rotated_9t4eg_65",F_e="_menu_9t4eg_70",k_e="_menuItem_9t4eg_94",I_e="_itemName_9t4eg_107",D_e="_current_9t4eg_111",j_e="_currentIndicator_9t4eg_131",P_e="_emptyState_9t4eg_146",Wh={dropdown:b_e,trigger:C_e,projectName:__e,arrow:S_e,active:T_e,triggerContent:B_e,rotated:E_e,menu:F_e,menuItem:k_e,itemName:I_e,current:D_e,currentIndicator:j_e,emptyState:P_e},hG=({projects:n,currentProject:e,onProjectSelect:t})=>{const[i,r]=H.useState(!1),s=H.useRef(null),o=[...n].sort((l,h)=>{var A,f;const u=((A=l.updatedAt)==null?void 0:A.seconds)||0;return(((f=h.updatedAt)==null?void 0:f.seconds)||0)-u});H.useEffect(()=>{const l=h=>{s.current&&!s.current.contains(h.target)&&r(!1)};return i&&document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)}},[i]);const a=l=>{t(l),r(!1)};return c.jsxs("div",{className:Wh.dropdown,ref:s,children:[c.jsxs("button",{className:`${Wh.trigger} ${i?Wh.active:""}`,onClick:()=>r(!i),type:"button",children:[c.jsx("div",{className:Wh.triggerContent,children:c.jsx("span",{className:Wh.projectName,children:(e==null?void 0:e.title)||"프로젝트 선택"})}),c.jsx(Lhe,{size:14,className:`${Wh.arrow} ${i?Wh.rotated:""}`})]}),i&&c.jsx("div",{className:Wh.menu,children:o.length>0?o.map(l=>c.jsxs("button",{className:`${Wh.menuItem} ${(e==null?void 0:e.id)===l.id?Wh.current:""}`,onClick:()=>a(l),type:"button",children:[c.jsx("span",{className:Wh.itemName,children:l.title}),(e==null?void 0:e.id)===l.id&&c.jsx("span",{className:Wh.currentIndicator,children:"✓"})]},l.id)):c.jsx("div",{className:Wh.emptyState,children:"프로젝트가 없습니다"})})]})},N_e="_fileTree_1qzs8_1",L_e="_treeHeader_1qzs8_10",M_e="_projectSelectorContainer_1qzs8_16",R_e="_treeContent_1qzs8_20",U_e="_treeItem_1qzs8_63",O_e="_active_1qzs8_80",H_e="_projectChildren_1qzs8_85",W_e="_childItem_1qzs8_89",z_e="_nestedItem_1qzs8_93",Q_e="_folderChildren_1qzs8_97",$_e="_treeItemIcon_1qzs8_101",V_e="_designIcon_1qzs8_119",G_e="_treeItemCount_1qzs8_129",X_e="_treeItemActions_1qzs8_140",Y_e="_treeItemActionBtn_1qzs8_149",K_e="_moreMenuBackdrop_1qzs8_171",q_e="_moreMenu_1qzs8_171",Z_e="_moreMenuItem_1qzs8_191",J_e="_deleteItem_1qzs8_207",e5e="_modalOverlay_1qzs8_216",t5e="_modal_1qzs8_216",n5e="_modalTitle_1qzs8_238",i5e="_modalInput_1qzs8_245",r5e="_modalActions_1qzs8_262",s5e="_modalCancelBtn_1qzs8_269",o5e="_modalCreateBtn_1qzs8_285",a5e="_loginPrompt_1qzs8_307",l5e="_loginPromptIcon_1qzs8_316",c5e="_loginPromptText_1qzs8_321",h5e="_loginPromptButton_1qzs8_327",Er={fileTree:N_e,treeHeader:L_e,projectSelectorContainer:M_e,treeContent:R_e,treeItem:U_e,active:O_e,projectChildren:H_e,childItem:W_e,nestedItem:z_e,folderChildren:Q_e,treeItemIcon:$_e,designIcon:V_e,treeItemCount:G_e,treeItemActions:X_e,treeItemActionBtn:Y_e,moreMenuBackdrop:K_e,moreMenu:q_e,moreMenuItem:Z_e,deleteItem:J_e,modalOverlay:e5e,modal:t5e,modalTitle:n5e,modalInput:i5e,modalActions:r5e,modalCancelBtn:s5e,modalCreateBtn:o5e,loginPrompt:a5e,loginPromptIcon:l5e,loginPromptText:c5e,loginPromptButton:h5e},u5e=({onFileSelect:n,onProjectSelect:e,onClose:t})=>{const i=ph(),{user:r}=Vc(),[s,o]=H.useState([]),[a,l]=H.useState(null),[h,u]=H.useState(null),[d,A]=H.useState({}),[f,p]=H.useState({}),[g,v]=H.useState(new Set),[w,m]=H.useState(new Set),[y,x]=H.useState(null),[S,I]=H.useState(!1),[j,C]=H.useState(""),[b,D]=H.useState(!1);H.useEffect(()=>{(async()=>{if(r){await T();const X=new URLSearchParams(window.location.search).get("projectId");X&&(l(X),v(new Set([X])))}})()},[r]),H.useEffect(()=>{(async()=>{if(a&&s.length>0){const Q=s.find(X=>X.id===a);Q&&(u(Q),await k(a),await B(a))}})()},[a,s,r]);const T=async()=>{if(r)try{const V=await gk(r.uid);if(o(V.projects),V.projects.length>0&&!a){const Q=V.projects[0].id;l(Q),u(V.projects[0]),v(new Set([Q])),console.log("✅ 첫 번째 프로젝트 자동 선택 및 확장:",Q)}}catch(V){console.error("프로젝트 로드 에러:",V)}},k=async V=>{if(r)try{const{folders:Q,error:X}=await mk(V);X?console.error("폴더 데이터 불러오기 에러:",X):A(W=>({...W,[V]:Q||[]}))}catch(Q){console.error("폴더 데이터 불러오기 중 오류:",Q)}},B=async V=>{var Q,X;if(!r){console.warn("⚠️ 사용자가 로그인되지 않음 - 디자인 파일 로드 건너뛰기");return}try{console.log("🔄 디자인 파일 로드 시작:",{projectId:V,userId:r.uid});const W=await D5(V);if(console.log("🔥 디자인 파일 로드 결과:",{projectId:V,designFilesCount:((Q=W.designFiles)==null?void 0:Q.length)||0,designFiles:(X=W.designFiles)==null?void 0:X.map(se=>({id:se.id,name:se.name})),error:W.error}),W.error){console.error("❌ 디자인 파일 로드 에러:",W.error),p(se=>({...se,[V]:[]}));return}if(W.designFiles&&Array.isArray(W.designFiles)){const se=W.designFiles.filter(q=>q&&q.id&&q.name);p(q=>({...q,[V]:se})),console.log("✅ 디자인 파일 state 업데이트 완료:",{count:se.length,files:se.map(q=>q.name)})}else console.log("⚠️ 디자인 파일이 없거나 비어있음"),p(se=>({...se,[V]:[]}))}catch(W){console.error("❌ 디자인 파일 로드 중 예외 발생:",W),p(se=>({...se,[V]:[]}))}},E=async V=>{const Q=new Set(g);Q.has(V)?Q.delete(V):(Q.add(V),te(V),await k(V),await B(V)),v(Q)},z=V=>{const Q=new Set(w);Q.has(V)?Q.delete(V):Q.add(V),m(Q)},te=V=>{l(V);const Q=s.find(X=>X.id===V);Q&&u(Q),e&&e(V)},L=(V,Q,X)=>{console.log("🎯 handleDesignFileClick 호출됨:",{projectId:V,designFileId:Q,designFileName:X,hasOnFileSelect:!!n}),n?(console.log("✅ onFileSelect 함수 호출 시작"),n(V,Q,X)):(console.log("🔀 기본 네비게이션 동작"),i(`/configurator?projectId=${V}&designFileId=${Q}&designFileName=${encodeURIComponent(X)}`)),t&&(console.log("🚪 파일트리 닫기"),t())},O=(V,Q,X,W)=>{V.preventDefault(),V.stopPropagation(),x({visible:!0,x:V.clientX,y:V.clientY,itemId:Q,itemName:X,itemType:W})},J=()=>{x(null)},$=async()=>{if(!(!j.trim()||!a)){D(!0);try{const Q={id:`folder_${Date.now()}`,name:j.trim(),type:"folder",children:[],expanded:!1},X=[...d[a]||[],Q];A(W=>({...W,[a]:X})),await $y(a,X),I(!1),C("")}catch(V){console.error("폴더 생성 에러:",V),alert("폴더 생성에 실패했습니다.")}finally{D(!1)}}},U=()=>{I(!1),C("")},Y=async()=>{var Q;if(!y)return;const V=prompt("새 이름을 입력하세요:",y.itemName);if(!V||V.trim()===y.itemName){J();return}try{if(y.itemType==="folder"&&a){const X=((Q=d[a])==null?void 0:Q.map(W=>W.id===y.itemId?{...W,name:V.trim()}:W))||[];A(W=>({...W,[a]:X})),await $y(a,X)}else y.itemType==="design"&&(await Hz(y.itemId,{name:V.trim()}),a&&await B(a))}catch(X){console.error("이름 변경 에러:",X),alert("이름 변경에 실패했습니다.")}J()},K=async()=>{var Q;if(!y)return;const V=y.itemType==="folder"?`정말로 폴더 "${y.itemName}"을(를) 삭제하시겠습니까?

폴더 내의 모든 파일도 함께 삭제됩니다.`:`정말로 파일 "${y.itemName}"을(를) 삭제하시겠습니까?`;if(window.confirm(V))try{if(y.itemType==="folder"&&a){const X=((Q=d[a])==null?void 0:Q.filter(W=>W.id!==y.itemId))||[];A(W=>({...W,[a]:X})),await $y(a,X)}else y.itemType==="design"&&a&&(await pk(y.itemId,a),await B(a))}catch(X){console.error("삭제 에러:",X),alert("삭제에 실패했습니다.")}J()};return c.jsxs("div",{className:Er.fileTree,children:[c.jsx("div",{className:Er.treeHeader,children:c.jsx("div",{className:Er.projectSelectorContainer,children:c.jsx(hG,{projects:s,currentProject:h,onProjectSelect:V=>te(V.id)})})}),c.jsx("div",{className:Er.treeContent,children:r?r&&s.length>0?c.jsx(c.Fragment,{children:s.map(V=>{var Q,X,W;return c.jsxs("div",{children:[c.jsxs("div",{className:`${Er.treeItem} ${a===V.id?Er.active:""}`,onClick:()=>E(V.id),children:[c.jsxs("div",{className:Er.treeItemIcon,children:[c.jsx("span",{style:{display:"inline-block",width:"16px",height:"16px",fontSize:"12px",lineHeight:"16px",textAlign:"center",color:"var(--theme-text-secondary, #666)",fontFamily:"monospace",userSelect:"none"},children:g.has(V.id)?"▼":"▶"}),c.jsx(Uhe,{size:16,color:"#666"})]}),c.jsx("span",{children:V.title}),c.jsx("div",{className:Er.treeItemActions,children:c.jsx("button",{className:Er.treeItemActionBtn,onClick:se=>{se.stopPropagation(),O(se,V.id,V.title,"project")},children:"⋯"})})]}),g.has(V.id)&&c.jsxs("div",{className:Er.projectChildren,children:[console.log("🔥 프로젝트 확장됨:",{projectId:V.id,designFiles:f[V.id],designFilesCount:((Q=f[V.id])==null?void 0:Q.length)||0,designFilesDetail:(X=f[V.id])==null?void 0:X.map(se=>({id:se.id,name:se.name})),folders:((W=d[V.id])==null?void 0:W.length)||0}),(d[V.id]||[]).map(se=>c.jsxs("div",{children:[c.jsxs("div",{className:`${Er.treeItem} ${Er.childItem}`,onClick:()=>z(se.id),children:[c.jsxs("div",{className:Er.treeItemIcon,children:[c.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",fontSize:"11px",lineHeight:"14px",textAlign:"center",color:"var(--theme-text-secondary, #666)",fontFamily:"monospace",userSelect:"none"},children:w.has(se.id)?"▼":"▶"}),c.jsx(um,{size:16,color:"currentColor"})]}),c.jsx("span",{children:se.name}),c.jsx("span",{className:Er.treeItemCount,children:se.children.length}),c.jsx("div",{className:Er.treeItemActions,children:c.jsx("button",{className:Er.treeItemActionBtn,onClick:q=>{q.stopPropagation(),O(q,se.id,se.name,"folder")},children:"⋯"})})]}),w.has(se.id)&&c.jsx("div",{className:Er.folderChildren,children:se.children.map(q=>c.jsxs("div",{className:`${Er.treeItem} ${Er.childItem} ${Er.nestedItem}`,onClick:()=>L(V.id,q.id,q.name),children:[c.jsx("div",{className:Er.treeItemIcon,children:c.jsx("div",{className:Er.designIcon,children:c.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2.5",children:[c.jsx("path",{d:"M12 19l7-7 3 3-7 7-3-3z"}),c.jsx("path",{d:"M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"}),c.jsx("path",{d:"M2 2l7.586 7.586"}),c.jsx("circle",{cx:"11",cy:"11",r:"2"})]})})}),c.jsx("span",{children:q.name}),c.jsx("div",{className:Er.treeItemActions,children:c.jsx("button",{className:Er.treeItemActionBtn,onClick:de=>{de.stopPropagation(),O(de,q.id,q.name,"design")},children:"⋯"})})]},q.id))})]},se.id)),(f[V.id]||[]).map(se=>c.jsxs("div",{className:`${Er.treeItem} ${Er.childItem}`,onClick:()=>L(V.id,se.id,se.name),children:[c.jsx("div",{className:Er.treeItemIcon,children:c.jsx("div",{className:Er.designIcon,children:c.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2.5",children:[c.jsx("path",{d:"M12 19l7-7 3 3-7 7-3-3z"}),c.jsx("path",{d:"M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"}),c.jsx("path",{d:"M2 2l7.586 7.586"}),c.jsx("circle",{cx:"11",cy:"11",r:"2"})]})})}),c.jsx("span",{children:se.name}),c.jsx("div",{className:Er.treeItemActions,children:c.jsx("button",{className:Er.treeItemActionBtn,onClick:q=>{q.stopPropagation(),O(q,se.id,se.name,"design")},children:"⋯"})})]},se.id))]})]},V.id)})}):r?c.jsx("div",{className:Er.treeItem,children:c.jsx("span",{style:{color:"#999",fontSize:"14px"},children:"프로젝트가 없습니다"})}):c.jsx("div",{className:Er.treeItem,children:c.jsx("span",{style:{color:"#999",fontSize:"14px"},children:"로그인이 필요합니다"})}):c.jsxs("div",{className:Er.loginPrompt,children:[c.jsx("div",{className:Er.loginPromptIcon,children:c.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[c.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),c.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),c.jsx("p",{className:Er.loginPromptText,children:"로그인이 필요합니다"}),c.jsx("button",{className:Er.loginPromptButton,onClick:()=>i("/login"),children:"로그인하기"})]})}),y&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:Er.moreMenuBackdrop,onClick:J}),c.jsxs("div",{className:Er.moreMenu,style:{position:"fixed",top:y.y,left:y.x},children:[c.jsx("div",{className:Er.moreMenuItem,onClick:Y,children:"이름 바꾸기"}),c.jsx("div",{className:`${Er.moreMenuItem} ${Er.deleteItem}`,onClick:K,children:"삭제하기"})]})]}),S&&c.jsx("div",{className:Er.modalOverlay,children:c.jsxs("div",{className:Er.modal,children:[c.jsx("h2",{className:Er.modalTitle,children:"새 폴더 생성"}),c.jsx("input",{type:"text",value:j,onChange:V=>C(V.target.value),placeholder:"폴더 이름을 입력하세요",className:Er.modalInput,onKeyPress:V=>{V.key==="Enter"&&j.trim()&&$()},autoFocus:!0}),c.jsxs("div",{className:Er.modalActions,children:[c.jsx("button",{onClick:U,disabled:b,className:Er.modalCancelBtn,children:"취소"}),c.jsx("button",{onClick:$,disabled:!j.trim()||b,className:Er.modalCreateBtn,children:b?"생성 중...":"생성"})]})]})})]})},d5e="_container_txm1o_1",A5e="_tabMenu_txm1o_8",f5e="_tab_txm1o_8",p5e="_activeTab_txm1o_62",g5e="_thumbnailGrid_txm1o_74",m5e="_thumbnailItem_txm1o_82",y5e="_selected_txm1o_129",w5e="_disabled_txm1o_141",v5e="_thumbnailImage_txm1o_158",x5e="_disabledOverlay_txm1o_174",b5e="_emptyMessage_txm1o_193",rh={container:d5e,tabMenu:A5e,tab:f5e,activeTab:p5e,thumbnailGrid:g5e,thumbnailItem:m5e,selected:y5e,disabled:w5e,thumbnailImage:v5e,disabledOverlay:x5e,emptyMessage:b5e},C5e=()=>{const[n,e]=H.useState(!1),[t,i]=H.useState(""),[r,s]=H.useState("알림"),o=H.useCallback((h,u)=>{i(h),u!=null&&u.title&&s(u.title),e(!0)},[]),a=H.useCallback(()=>{e(!1)},[]);return{showAlert:o,hideAlert:a,AlertComponent:()=>{const h=document.getElementById("modal-root");return h?Km.createPortal(c.jsx(_z,{isOpen:n,message:t,title:r,onClose:a}),h):null}}},yu=n=>{const e=`/images/furniture-thumbnails/${n}`;return console.log(`🖼️ [썸네일 경로] ${n} → ${e}`),e},qf={"single-2drawer-hanging":yu("single-2drawer-hanging.png"),"single-2hanging":yu("single-2hanging.png"),"single-4drawer-hanging":yu("single-4drawer-hanging.png"),"dual-2drawer-hanging":yu("dual-2drawer-hanging.png"),"dual-2hanging":yu("dual-2hanging.png"),"dual-4drawer-hanging":yu("dual-4drawer-hanging.png"),"dual-2drawer-styler":yu("dual-2drawer-styler.png"),"dual-4drawer-pantshanger":yu("dual-4drawer-pantshanger.png"),"upper-cabinet-shelf":yu("upper-cabinet-shelf.png"),"upper-cabinet-open":yu("upper-cabinet-open.png"),"upper-cabinet-mixed":yu("upper-cabinet-mixed.png")},_5e=({module:n,iconPath:e,isValid:t})=>{const{spaceInfo:i}=hr(),r=pi(S=>S.placedModules),s=pi(S=>S.addModule),o=pi(S=>S.setFurniturePlacementMode),a=pi(S=>S.setCurrentDragData),l=pi(S=>S.selectedFurnitureId),h=pi(S=>S.setSelectedFurnitureId),{showAlert:u,AlertComponent:d}=C5e(),{activeDroppedCeilingTab:A,setIsSlotDragging:f}=Wi(),p=ci.useRef(null),g=ci.useRef(!1);ci.useEffect(()=>()=>{p.current&&clearTimeout(p.current)},[]);const v=S=>{var k,B,E,z,te,L,O,J,$,U,Y,K,V;if(!t){S.preventDefault();return}o(!0),f(!0),console.log("🚨🚨🚨 [CRITICAL DEBUG] handleDragStart - spaceInfo 완전 분석:",{width:i.width,surroundType:i.surroundType,installType:i.installType,gapConfig:i.gapConfig,frameSize:i.frameSize,"frameSize.left 값":(k=i.frameSize)==null?void 0:k.left,"frameSize.right 값":(B=i.frameSize)==null?void 0:B.right,"frameSize가 50인가?":((E=i.frameSize)==null?void 0:E.left)===50||((z=i.frameSize)==null?void 0:z.right)===50,문제:i.surroundType==="no-surround"&&(((te=i.frameSize)==null?void 0:te.left)===50||((L=i.frameSize)==null?void 0:L.right)===50)?"🔴🔴🔴 노서라운드인데 frameSize가 50임!!!":"정상",timestamp:new Date().toISOString()});let I=i;i.surroundType==="no-surround"&&i.frameSize&&(i.frameSize.left>0||i.frameSize.right>0)&&(console.error("🔴🔴🔴 [ModuleGallery] 노서라운드인데 frameSize가 잘못됨! 강제 수정!",{"원래 frameSize":i.frameSize}),I={...i,frameSize:{left:0,right:0,top:0}});const j=pr(I);console.log("🚨🚨🚨 [CRITICAL DEBUG] indexing 계산 결과 완전 분석:",{columnWidth:j.columnWidth,slotWidths:j.slotWidths,columnCount:j.columnCount,columnBoundaries:j.columnBoundaries,threeUnitPositions:j.threeUnitPositions,"첫번째 슬롯 위치":(O=j.threeUnitPositions)==null?void 0:O[0],"마지막 슬롯 위치":(J=j.threeUnitPositions)==null?void 0:J[j.columnCount-1],internalWidth:j.internalWidth,internalStartX:j.internalStartX,문제체크:{"첫슬롯이 -15가 아님?":(($=j.threeUnitPositions)==null?void 0:$[0])!==-15,"실제 첫슬롯 위치":(U=j.threeUnitPositions)==null?void 0:U[0],"예상 첫슬롯 위치":-15,차이:(Y=j.threeUnitPositions)!=null&&Y[0]?j.threeUnitPositions[0]- -15:0}}),i.surroundType==="no-surround"&&console.log("🚨🚨🚨 [ModuleGallery] 드래그 시작 - 노서라운드 모드:",{surroundType:i.surroundType,installType:i.installType,columnWidth:j.columnWidth,slotWidths:j.slotWidths,expectedWidth:(K=j.slotWidths)==null?void 0:K[0],spaceWidth:i.width,internalWidth:j.internalWidth});let C="normal";const b={...n.dimensions};let D=n.id;if((V=i.droppedCeiling)!=null&&V.enabled){C=A==="dropped"?"dropped":"normal";const Q=ar.calculateZoneSlotInfo(i,i.customColumnCount);if(C==="dropped"&&Q.dropped){const X=Q.dropped.slotWidths||[],W=Q.dropped.columnWidth;if((n.id.includes("dual-2drawer-styler")||n.id.includes("dual-4drawer-pantshanger"))&&X.length>=2&&X[0]+X[1]<694){u("단내림 구간의 슬롯갯수를 줄여주세요",{title:"배치 불가"}),S.preventDefault();return}if(n.isDynamic){const q=n.dimensions.width>W*1.5;X.length>0?q&&X.length>=2?b.width=X[0]+X[1]:b.width=X[0]:b.width=q?W*2:W,D=`${n.id.replace(/-\d+$/,"")}-${Math.round(b.width)}`}}else if(C==="normal"&&Q.normal){const X=Q.normal.slotWidths||[],W=Q.normal.columnWidth;if((n.id.includes("dual-2drawer-styler")||n.id.includes("dual-4drawer-pantshanger"))&&X.length>=2&&X[0]+X[1]<694){u("메인 구간의 슬롯갯수를 줄여주세요",{title:"배치 불가"}),S.preventDefault();return}if(n.isDynamic){const q=n.dimensions.width>W*1.5;X.length>0?q&&X.length>=2?b.width=X[0]+X[1]:b.width=X[0]:b.width=q?W*2:W,D=`${n.id.replace(/-\d+$/,"")}-${Math.round(b.width)}`}}}else{if(n.id.includes("dual-2drawer-styler")||n.id.includes("dual-4drawer-pantshanger")){if(j.columnCount<2){u("듀얼 가구를 배치하려면 최소 2개의 슬롯이 필요합니다",{title:"배치 불가"}),S.preventDefault();return}if(j.columnWidth*2<694){u("슬롯갯수를 줄여주세요",{title:"배치 불가"}),S.preventDefault();return}}if(n.isDynamic){const X=n.id.startsWith("dual-");let W;i.surroundType==="surround"&&j.slotWidths&&j.slotWidths.length>0?(X&&j.slotWidths.length>=2?W=j.slotWidths[0]+j.slotWidths[1]:W=j.slotWidths[0],console.log("🚨 [ModuleGallery] 서라운드 모드 - slotWidths 사용:",{isDualFurniture:X,targetWidth:W,slotWidths:j.slotWidths}),D=`${n.id.replace(/-\d+$/,"")}-${Math.round(W)}`,b.width=W):i.surroundType==="surround"?(W=X?j.columnWidth*2:j.columnWidth,D=`${n.id.replace(/-\d+$/,"")}-${Math.round(W)}`,b.width=W):console.log("🚨 [ModuleGallery] 노서라운드 모드 - 원본 모듈 사용:",{originalId:n.id,originalWidth:n.dimensions.width})}}const T={type:"furniture",zone:C,moduleData:{id:D,name:n.name,dimensions:b,originalDimensions:n.dimensions,type:n.type||"default",color:n.color,hasDoor:n.hasDoor||!1,isDynamic:n.isDynamic,furnType:n.id.includes("dual-")?"dual":"single",customWidth:b.width},spaceInfo:I};S.dataTransfer.setData("application/json",JSON.stringify(T)),S.dataTransfer.setData("text/plain",n.id),S.dataTransfer.effectAllowed="copy",console.log("🎯 [ModuleGallery] Drag started:",{originalModuleId:n.id,dragModuleId:D,dragData:T,zone:C,adjustedWidth:b.width,isDynamic:n.isDynamic}),a(T)},w=()=>{console.log("🎯 [ModuleGallery] Drag ended"),o(!1),f(!1),setTimeout(()=>{a(null)},100)},m=()=>{if(t){if(g.current){g.current=!1;return}if(p.current){clearTimeout(p.current),p.current=null;return}p.current=setTimeout(()=>{var b;if(p.current=null,g.current){g.current=!1;return}if(l===n.id){h(null),o(!1),a(null);return}pr(i);let S="normal";const I={...n.dimensions};let j=n.id;if((b=i.droppedCeiling)!=null&&b.enabled){S=A==="dropped"?"dropped":"normal";const D=ar.calculateZoneSlotInfo(i,i.customColumnCount);if(S==="dropped"&&D.dropped){const T=D.dropped.slotWidths||[],k=D.dropped.columnWidth;if((n.id.includes("dual-2drawer-styler")||n.id.includes("dual-4drawer-pantshanger"))&&T.length>=2&&T[0]+T[1]<694){u("단내림 구간의 슬롯갯수를 줄여주세요",{title:"배치 불가"});return}if(n.isDynamic){const E=n.dimensions.width>k*1.5;if(T.length>0){if(E&&T.length>=2){const z=T[0]+T[1];j=`${n.id.replace(/-\d+$/,"")}-${Math.round(z)}`,I.width=z}else if(!E&&T.length>0){const z=T[0];j=`${n.id.replace(/-\d+$/,"")}-${Math.round(z)}`,I.width=z}}}}}h(n.id),o(!0);const C={type:"furniture",zone:S,moduleData:{id:j,name:n.name,dimensions:I,originalDimensions:n.dimensions,type:n.type||"default",color:n.color,hasDoor:n.hasDoor||!1,isDynamic:n.isDynamic,furnType:n.id.includes("dual-")?"dual":"single"}};a(C),console.log("🎯 [ModuleGallery] Click & Place activated:",{moduleId:n.id,adjustedId:j,zone:S,data:C})},300)}},y=()=>{var S,I,j,C,b,D,T,k;if(console.log("🚨🚨🚨 [ModuleGallery] Double click event triggered!",{moduleId:n.id,isValid:t}),g.current=!0,!t){console.log("❌ Module is not valid, exiting");return}p.current&&(clearTimeout(p.current),p.current=null),h(null),o(!1),a(null),console.log("🚨 [ModuleGallery] Double click processing:",{moduleId:n.id,moduleWidth:n.dimensions.width,activeZone:A,droppedCeilingEnabled:(S=i.droppedCeiling)==null?void 0:S.enabled,spaceInfo:{width:i.width,customColumnCount:i.customColumnCount,columnMode:i.columnMode}});try{console.log("🔴🔴🔴 [CRITICAL] handleDoubleClick - spaceInfo 상태:",{surroundType:i.surroundType,frameSize:i.frameSize,"frameSize가 50인가?":((I=i.frameSize)==null?void 0:I.left)===50||((j=i.frameSize)==null?void 0:j.right)===50,문제:i.surroundType==="no-surround"&&(((C=i.frameSize)==null?void 0:C.left)===50||((b=i.frameSize)==null?void 0:b.right)===50)?"🔴🔴🔴 노서라운드인데 frameSize가 50임!!!":"정상"});let B=i;i.surroundType==="no-surround"&&i.frameSize&&(i.frameSize.left>0||i.frameSize.right>0)&&(console.error("🔴🔴🔴 [ModuleGallery] 더블클릭 - 노서라운드인데 frameSize가 잘못됨! 강제 수정!",{"원래 frameSize":i.frameSize}),B={...i,frameSize:{left:0,right:0,top:0}});let E;const z=B,te=Kr(B),L=pr(z),O=te;if(console.log("🚨 [ModuleGallery] Using full space:",{fullSpaceInfo:{width:z.width,customColumnCount:z.customColumnCount},indexing:{columnWidth:L.columnWidth,columnCount:L.columnCount}}),n.id.includes("dual-2drawer-styler")||n.id.includes("dual-4drawer-pantshanger")){if(L.columnCount<2){u("듀얼 가구를 배치하려면 최소 2개의 슬롯이 필요합니다",{title:"배치 불가"});return}if(L.columnWidth*2<694){u("슬롯갯수를 줄여주세요",{title:"배치 불가"});return}}const $=n.isDynamic||n.id.includes("single-")||n.id.includes("dual-");let U=n.dimensions.width;if($){const ie=n.id.startsWith("dual-");i.surroundType==="no-surround"&&L.slotWidths&&L.slotWidths.length>0?(ie&&L.slotWidths.length>=2?U=L.slotWidths[0]+L.slotWidths[1]:U=L.slotWidths[0],console.log("🚨 [ModuleGallery] 더블클릭 - 노서라운드 모드 slotWidths 사용:",{isDualFurniture:ie,actualWidth:U,slotWidths:L.slotWidths})):U=ie?L.columnWidth*2:L.columnWidth}console.log("🎯 [ModuleGallery] Dynamic width calculation:",{targetZone:E,originalId:n.id,originalWidth:n.dimensions.width,isDynamicFurniture:$,actualWidth:U,indexingColumnWidth:L.columnWidth}),console.log("🎯 [ModuleGallery] Using original module with dynamic width:",{moduleId:n.id,originalWidth:n.dimensions.width,actualWidth:U,expectedColumnWidth:L.columnWidth});const Y=n.id.startsWith("dual-");console.log("🔍 [ModuleGallery] Checking slot availability:",{totalSlots:L.columnCount,isDualFurniture:Y,placedModulesCount:r.length,placedModules:r.map(ie=>({id:ie.id,slotIndex:ie.slotIndex,zone:ie.zone}))});let K=0,V=0,Q=0,X=0;if((D=i.droppedCeiling)!=null&&D.enabled){const ie=ar.calculateZoneSlotInfo(i,i.customColumnCount);i.droppedCeiling.position==="left"?(K=0,V=ie.dropped.columnCount,Q=ie.dropped.columnCount,X=L.columnCount):(Q=0,X=ie.normal.columnCount,K=ie.normal.columnCount,V=L.columnCount),console.log("🎯 Zone ranges for dual furniture placement:",{droppedCeilingPosition:i.droppedCeiling.position,droppedZone:{start:K,end:V,count:V-K},normalZone:{start:Q,end:X,count:X-Q},zoneInfo:{dropped:{columnCount:ie.dropped.columnCount,width:ie.dropped.width},normal:{columnCount:ie.normal.columnCount,width:ie.normal.width}},totalSlots:L.columnCount,isDualFurniture:Y})}let W=-1;if((T=i.droppedCeiling)!=null&&T.enabled)if(A==="dropped"){console.log("🔍 Step 1: Searching in dropped zone first (tab selected)...",{activeTab:A,droppedZone:{start:K,end:V},normalZone:{start:Q,end:X},placedModulesWithZone:r.map(ee=>({slotIndex:ee.slotIndex,zone:ee.zone||"unknown"}))});for(let ee=K;ee<V;ee++){if(Y){const me=ee+1;if(me>=V){console.log(`🚫 Slot ${ee} and ${me}: dual furniture would exceed dropped zone boundary`);continue}}const ae=dp(ee,Y,r,z,n.id,void 0,"dropped");if(console.log(`🔍 Dropped zone - Slot ${ee}: ${ae?"✅ Available":"❌ Occupied"}`),ae){W=ee;break}}if(W===-1){console.log("🔍 Step 2: Dropped zone full, searching in normal zone...");for(let ee=Q;ee<X;ee++){if(Y){const me=ee+1;if(me>=X){console.log(`🚫 Slot ${ee} and ${me}: dual furniture would exceed normal zone boundary`);continue}}const ae=dp(ee,Y,r,z,n.id,void 0,"normal");if(console.log(`🔍 Normal zone - Slot ${ee}: ${ae?"✅ Available":"❌ Occupied"}`),ae){W=ee;break}}}}else{console.log("🔍 Step 1: Searching in normal zone first...",{activeTab:A,normalZone:{start:Q,end:X},droppedZone:{start:K,end:V},placedModulesWithZone:r.map(ee=>({slotIndex:ee.slotIndex,zone:ee.zone||"unknown"}))});for(let ee=Q;ee<X;ee++){if(Y){const me=ee+1;if(me>=X){console.log(`🚫 Slot ${ee} and ${me}: dual furniture would exceed normal zone boundary`);continue}}const ae=dp(ee,Y,r,z,n.id,void 0,"normal");if(console.log(`🔍 Normal zone - Slot ${ee}: ${ae?"✅ Available":"❌ Occupied"}`),ae){W=ee;break}}if(W===-1){console.log("🔍 Step 2: Normal zone full, searching in dropped zone...",{reason:"Normal zone is full",droppedZone:{start:K,end:V},willSearchSlots:Array.from({length:V-K},(ee,ae)=>K+ae)});for(let ee=K;ee<V;ee++){if(Y){const me=ee+1;if(me>=V){console.log(`🚫 Slot ${ee} and ${me}: dual furniture would exceed dropped zone boundary`);continue}}const ae=dp(ee,Y,r,z,n.id,void 0,"dropped");if(console.log(`🔍 Dropped zone - Slot ${ee}: ${ae?"✅ Available":"❌ Occupied"}`),ae){W=ee;break}}}}else for(let ie=0;ie<L.columnCount;ie++){const ee=dp(ie,Y,r,z,n.id);if(console.log(`🔍 Slot ${ie}: ${ee?"✅ Available":"❌ Occupied"}`),ee){W=ie;break}}if(W===-1&&console.log("🔍 No available slot found for furniture placement"),console.log("🎯 Final availableSlotIndex:",W),W===-1){console.warn("❌ 사용 가능한 슬롯이 없습니다.");return}let se=0;const q=ie=>{if(ie!=null&&ie.defaultDepth)return Math.min(ie.defaultDepth,i.depth);const ee=Math.floor(i.depth*.9);return Math.min(ee,580)},de=`placed-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;let Ce=W,Se=L;if((k=i.droppedCeiling)!=null&&k.enabled){const ie=ar.calculateZoneSlotInfo(i,i.customColumnCount);i.droppedCeiling.position==="left"?ie.dropped&&W<ie.dropped.columnCount?(E="dropped",Ce=W,Se={columnCount:ie.dropped.columnCount,columnWidth:ie.dropped.columnWidth,slotWidths:ie.dropped.slotWidths||Array(ie.dropped.columnCount).fill(ie.dropped.columnWidth),threeUnitPositions:ie.dropped.threeUnitPositions||[],threeUnitDualPositions:ie.dropped.threeUnitDualPositions||[],threeUnitColumnWidth:Xr.mmToThreeUnits(ie.dropped.columnWidth),internalStartX:ie.dropped.startX,zones:{normal:ie.normal,dropped:ie.dropped}}):(E="normal",Ce=W-ie.dropped.columnCount,Se={columnCount:ie.normal.columnCount,columnWidth:ie.normal.columnWidth,slotWidths:ie.normal.slotWidths||Array(ie.normal.columnCount).fill(ie.normal.columnWidth),threeUnitPositions:ie.normal.threeUnitPositions||[],threeUnitDualPositions:ie.normal.threeUnitDualPositions||[],threeUnitColumnWidth:Xr.mmToThreeUnits(ie.normal.columnWidth),internalStartX:ie.normal.startX,zones:{normal:ie.normal,dropped:ie.dropped}}):ie.normal&&W<ie.normal.columnCount?(E="normal",Ce=W,Se={columnCount:ie.normal.columnCount,columnWidth:ie.normal.columnWidth,slotWidths:ie.normal.slotWidths||Array(ie.normal.columnCount).fill(ie.normal.columnWidth),threeUnitPositions:ie.normal.threeUnitPositions||[],threeUnitDualPositions:ie.normal.threeUnitDualPositions||[],threeUnitColumnWidth:Xr.mmToThreeUnits(ie.normal.columnWidth),internalStartX:ie.normal.startX,zones:{normal:ie.normal,dropped:ie.dropped}}):(E="dropped",Ce=W-ie.normal.columnCount,Se={columnCount:ie.dropped.columnCount,columnWidth:ie.dropped.columnWidth,slotWidths:ie.dropped.slotWidths||Array(ie.dropped.columnCount).fill(ie.dropped.columnWidth),threeUnitPositions:ie.dropped.threeUnitPositions||[],threeUnitDualPositions:ie.dropped.threeUnitDualPositions||[],threeUnitColumnWidth:Xr.mmToThreeUnits(ie.dropped.columnWidth),internalStartX:ie.dropped.startX,zones:{normal:ie.normal,dropped:ie.dropped}})}let fe,M=n.id;if(Y&&Se.slotWidths&&Se.slotWidths[Ce]!==void 0?(fe=Se.slotWidths[Ce]+(Se.slotWidths[Ce+1]||Se.slotWidths[Ce]),M=`${n.id.replace(/-\d+$/,"")}-${fe}`):Se.slotWidths&&Se.slotWidths[Ce]!==void 0?(fe=Se.slotWidths[Ce],M=`${n.id.replace(/-\d+$/,"")}-${fe}`):fe=Se.columnWidth,console.log("🎯 [ModuleGallery] Target module ID with exact width:",{originalId:n.id,targetModuleId:M,customWidth:fe,isDualFurniture:Y,zone:E,globalSlotIndex:W,localSlotIndex:Ce,zoneSlotWidths:Se.slotWidths,zoneColumnWidth:Se.columnWidth}),console.log("📍 Position calculation inputs:",{isDualFurniture:Y,localSlotIndex:Ce,zoneInternalStartX:Se.internalStartX,zoneColumnWidth:Se.columnWidth,targetZone:E,availableSlotIndex:W}),Y){const ie=Se.internalStartX+Ce*Se.columnWidth,ee=ie+Se.columnWidth/2,ae=Se.internalStartX+(Ce+1)*Se.columnWidth,me=ae+Se.columnWidth/2,_e=(ee+me)/2;se=Xr.mmToThreeUnits(_e),console.log("📍 Dual furniture position details:",{slot1:{startX:ie,centerX:ee},slot2:{startX:ae,centerX:me},dualCenterX:_e,positionX_three:se})}else{const ie=Se.internalStartX+Ce*Se.columnWidth,ee=ie+Se.columnWidth/2;se=Xr.mmToThreeUnits(ee),console.log("📍 Single furniture position details:",{slotStartX:ie,slotCenterX:ee,positionX_three:se})}console.log("🎯 [ModuleGallery] Position calculation:",{zone:E,positionX:se,positionX_mm:se*100,globalSlotIndex:W,localSlotIndex:Ce,isDualFurniture:Y,surroundType:i.surroundType,installType:i.installType,zoneIndexingInfo:{columnCount:Se.columnCount,columnWidth:Se.columnWidth,internalStartX:Se.internalStartX,internalStartX_three:Xr.mmToThreeUnits(Se.internalStartX),threeUnitPositions:Se.threeUnitPositions}});const Z={id:de,moduleId:M,baseModuleType:n.id.replace(/-\d+$/,""),moduleWidth:n.dimensions.width,position:{x:se,y:0,z:0},rotation:0,hasDoor:!1,customDepth:q(n),slotIndex:W,isDualSlot:Y,isValidInCurrentSpace:!0,hingePosition:"right",zone:E||void 0,customWidth:i.surroundType==="no-surround"?void 0:fe};if(console.log("🚨 [ModuleGallery] New module created:",{moduleId:n.id,originalWidth:n.dimensions.width,customWidth:fe,expectedColumnWidth:L.columnWidth,position:Z.position,zone:E,slotIndex:Ce}),console.log("🎯 [ModuleGallery] About to add module:",{...Z,addModuleFunction:typeof s,addModuleDefined:s!==void 0,currentPlacedModulesCount:r.length}),!s){console.error("❌❌❌ addModule function is not defined!");return}try{console.log("🎯 Calling addModule with:",JSON.stringify(Z)),s(Z),console.log("✅ [ModuleGallery] Module added successfully");const ie=pi.getState().placedModules;console.log("📦 Updated placedModules count:",ie.length),console.log("📦 Updated placedModules:",ie.map(ee=>({id:ee.id,moduleId:ee.moduleId,slotIndex:ee.slotIndex,zone:ee.zone})))}catch(ie){throw console.error("❌ [ModuleGallery] Failed to add module:",ie),ie}const Ae=pi.getState().setSelectedPlacedModuleId;Ae(de),console.log(`✅ 가구 "${n.name}"을 슬롯 ${Ce+1}에 자동 배치했습니다.`,{moduleId:n.id,globalSlotIndex:W,localSlotIndex:Ce,zone:E,position:Z.position,isDual:Y,selectedId:de})}catch(B){console.error("🚨🚨🚨 [ModuleGallery] 가구 자동 배치 중 오류 발생:",B),console.error("Error details:",{moduleId:n.id,activeZone:A,spaceInfo:i,error:B})}finally{setTimeout(()=>{g.current=!1},100)}},x=n.category==="upper"||n.category==="lower";return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:`${rh.thumbnailItem} ${t?"":rh.disabled} ${l===n.id?rh.selected:""}`,draggable:t,onDragStart:v,onDragEnd:w,onClick:m,onDoubleClick:y,title:t?`클릭하여 선택 또는 드래그하여 배치: ${n.name}`:"현재 공간에 배치할 수 없습니다",children:[c.jsx("div",{className:rh.thumbnailImage,children:x?c.jsxs("div",{style:{width:"100%",height:"100%",backgroundColor:n.color||"#8B7355",borderRadius:"4px",border:"2px solid rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative"},children:[c.jsx("div",{style:{fontSize:"24px",opacity:.7},children:n.category==="upper"?"⬆️":"⬇️"}),c.jsx("div",{style:{fontSize:"12px",marginTop:"4px",opacity:.8},children:n.category==="upper"?"상부장":"하부장"})]}):c.jsx("img",{src:e,alt:n.name,onError:S=>{const I=S.target;I.dataset.fallbackAttempted||(I.dataset.fallbackAttempted="true",I.src=yu("single-2drawer-hanging.png"))}})}),!t&&c.jsx("div",{className:rh.disabledOverlay})]}),c.jsx(d,{})]})},S5e=({moduleCategory:n="tall"})=>{var w,m;const{t:e}=ia(),[t,i]=H.useState("all"),{spaceInfo:r}=hr(),{activeDroppedCeilingTab:s}=Wi();console.log("🔍 [ModuleGallery] spaceInfo 상태:",{width:r.width,surroundType:r.surroundType,frameSize:r.frameSize,gapConfig:r.gapConfig,installType:r.installType});let o=r,a=Kr(r);(w=r.droppedCeiling)!=null&&w.enabled&&s==="dropped"&&ar.calculateZoneSlotInfo(r,r.customColumnCount).dropped&&(o={...r,zone:"dropped"},a={width:Xr.calculateDroppedZoneInternalWidth(r)||850,height:r.height-(((m=r.droppedCeiling)==null?void 0:m.dropHeight)||0),depth:Kr(r).depth});const l=pr(o);l.columnWidth;let h=[];n==="upper"?(h=GS("upper",a,o),console.log("🎯 상부장 모듈 로드:",{count:h.length,modules:h.map(y=>({id:y.id,name:y.name,category:y.category}))})):n==="lower"?(h=GS("lower",a,o),console.log("🎯 하부장 모듈 로드:",{count:h.length,modules:h.map(y=>({id:y.id,name:y.name,category:y.category}))})):h=GS("full",a,o);const u=h;console.log("🔍 [ModuleGallery] Debug info:",{activeDroppedCeilingTab:s,originalSpaceInfo:{width:r.width,customColumnCount:r.customColumnCount,columnMode:r.columnMode,droppedCeiling:r.droppedCeiling},zoneSpaceInfo:{width:o.width,customColumnCount:o.customColumnCount,zone:o.zone},internalSpace:a,indexing:{columnWidth:l.columnWidth,columnCount:l.columnCount,slotWidths:l.slotWidths},fullModules:u.map(y=>({id:y.id,width:y.dimensions.width}))}),s==="dropped"&&console.log("🚨🚨🚨 단내림 구간 갤러리:",{zoneSlotWidths:l.slotWidths,zoneColumnWidth:l.columnWidth,expectedWidths:l.slotWidths?[...new Set(l.slotWidths)]:[],actualModuleWidths:u.map(y=>y.dimensions.width).filter((y,x,S)=>S.indexOf(y)===x)});const{singleModules:d,dualModules:A}=H.useMemo(()=>l.columnCount<=1?{singleModules:u,dualModules:[]}:u.reduce((y,x)=>(x.id.includes("dual-")?y.dualModules.push(x):y.singleModules.push(x),y),{singleModules:[],dualModules:[]}),[u,l.columnCount]),f=H.useMemo(()=>{const y=t==="all"?[...d,...A]:t==="single"?d:A;return console.log("🎯 [ModuleGallery] Current modules:",{selectedType:t,moduleCount:y.length,modules:y.map(x=>({id:x.id,width:x.dimensions.width,baseId:x.id.replace(/-\d+$/,"")}))}),y},[t,d,A,n,a,o]),p=y=>{const x=y.replace(/-\d+$/,"");if(x.includes("upper-cabinet")){if(x.includes("shelf"))return qf["upper-cabinet-shelf"]||qf["single-2hanging"];if(x.includes("open"))return qf["upper-cabinet-open"]||qf["single-2hanging"];if(x.includes("mixed"))return qf["upper-cabinet-mixed"]||qf["single-2drawer-hanging"]}return qf[x]||qf["single-2drawer-hanging"]},g=y=>{const x=y.id.includes("dual-");if(s==="dropped"&&x){const S=ar.calculateZoneSlotInfo(r,r.customColumnCount);if(S.dropped)return S.dropped.columnCount>=2&&y.dimensions.height<=a.height&&y.dimensions.depth<=a.depth}return y.dimensions.width<=a.width&&y.dimensions.height<=a.height&&y.dimensions.depth<=a.depth},v=(...y)=>y.filter(Boolean).join(" ");return c.jsxs("div",{className:rh.container,children:[c.jsxs("div",{className:rh.tabMenu,children:[c.jsxs("button",{className:v(rh.tab,t==="all"&&rh.activeTab),onClick:()=>i("all"),children:[e("furniture.all")," (",n==="upperlower"?0:d.length+A.length,")"]}),c.jsxs("button",{className:v(rh.tab,t==="single"&&rh.activeTab),onClick:()=>i("single"),children:[e("furniture.single")," (",n==="upperlower"?0:d.length,")"]}),c.jsxs("button",{className:v(rh.tab,t==="dual"&&rh.activeTab),onClick:()=>i("dual"),children:[e("furniture.dual")," (",n==="upperlower"?0:A.length,")"]})]}),c.jsx("div",{className:rh.thumbnailGrid,children:f.length>0?f.map(y=>{const x=p(y.id),S=g(y);return c.jsx(_5e,{module:y,iconPath:x,isValid:S},y.id)}):c.jsx("div",{className:rh.emptyMessage,children:n==="upperlower"?`${upperLowerTab==="lower"?e("furniture.lowerCabinet"):e("furniture.upperCabinet")} ${e("furniture.moduleNotReady")}`:e("furniture.noModulesAvailable")})})]})},T5e="_overlay_41smn_1",B5e="_panel_41smn_14",E5e="_header_41smn_26",F5e="_title_41smn_35",k5e="_closeButton_41smn_42",I5e="_content_41smn_62",D5e="_moduleInfo_41smn_68",j5e="_modulePreview_41smn_74",P5e="_moduleBox_41smn_86",N5e="_moduleDetails_41smn_93",L5e="_moduleName_41smn_97",M5e="_property_41smn_104",R5e="_propertyLabel_41smn_114",U5e="_propertyValue_41smn_122",O5e="_placeholder_41smn_129",ko={overlay:T5e,panel:B5e,header:E5e,title:F5e,closeButton:k5e,content:I5e,moduleInfo:D5e,modulePreview:j5e,moduleBox:P5e,moduleDetails:N5e,moduleName:L5e,property:M5e,propertyLabel:R5e,propertyValue:U5e,placeholder:O5e},H5e=()=>{const{spaceInfo:n}=hr(),{activePopup:e,closeAllPopups:t}=Wi();if(e.type!=="furniture"||!e.id)return null;const i=Kr(n),r=Zi(e.id,i,n);if(!r)return null;const s=()=>{t()},o=a=>{a.target===a.currentTarget&&s()};return c.jsx("div",{className:ko.overlay,onClick:o,children:c.jsxs("div",{className:ko.panel,children:[c.jsxs("div",{className:ko.header,children:[c.jsx("h3",{className:ko.title}),c.jsx("button",{className:ko.closeButton,onClick:s,children:"✕"})]}),c.jsxs("div",{className:ko.content,children:[c.jsxs("div",{className:ko.moduleInfo,children:[c.jsx("div",{className:ko.modulePreview,children:c.jsx("div",{className:ko.moduleBox,style:{backgroundColor:r.color,aspectRatio:`${r.dimensions.width} / ${r.dimensions.height}`}})}),c.jsxs("div",{className:ko.moduleDetails,children:[c.jsx("h4",{className:ko.moduleName,children:r.name}),c.jsxs("div",{className:ko.property,children:[c.jsx("span",{className:ko.propertyLabel,children:"크기:"}),c.jsxs("span",{className:ko.propertyValue,children:[r.dimensions.width," × ",r.dimensions.height," × ",r.dimensions.depth,"mm"]})]}),c.jsxs("div",{className:ko.property,children:[c.jsx("span",{className:ko.propertyLabel,children:"타입:"}),c.jsx("span",{className:ko.propertyValue,children:r.type||"기본"})]}),c.jsxs("div",{className:ko.property,children:[c.jsx("span",{className:ko.propertyLabel,children:"도어:"}),c.jsx("span",{className:ko.propertyValue,children:r.hasDoor?"있음":"없음"})]}),r.description&&c.jsxs("div",{className:ko.property,children:[c.jsx("span",{className:ko.propertyLabel}),c.jsx("span",{className:ko.propertyValue,children:r.description})]}),r.isDynamic&&c.jsxs("div",{className:ko.property,children:[c.jsx("span",{className:ko.propertyLabel,children:"맞춤형:"}),c.jsx("span",{className:ko.propertyValue,children:"예"})]})]})]}),c.jsx("div",{className:ko.placeholder,children:c.jsx("p",{children:"추가 속성 설정은 곧 추가될 예정입니다."})})]})]})})},uG=(n,e,t,i=!1,r=s=>s)=>{var p,g,v;const s={common:[],upper:[],lower:[],door:[]},o=((p=n.modelConfig)==null?void 0:p.basicThickness)||18,a=9,l=18,h=5,u=n.dimensions.height,d=e-o*2;let A;if(n.id.includes("dual-4drawer-pantshanger")||n.id.includes("dual-2drawer-styler")?A=((g=n.modelConfig)==null?void 0:g.leftSections)||[]:A=((v=n.modelConfig)==null?void 0:v.sections)||[],A&&A.length>0){const w=u-o*2,m=(C,b)=>(C.heightType||"percentage")==="absolute"?Math.min(C.height||0,b):b*((C.height||C.heightRatio||100)/100),x=A.filter(C=>C.heightType==="absolute").reduce((C,b)=>C+m(b,w),0),I=(A.length>1?A.length-1:0)*o,j=w-x-I;A.length>1&&n.id.includes("2hanging")?s.common.push({name:"안전선반 (칸막이)",width:d,depth:t-a-17,thickness:o,material:"PB"}):A.length>1&&s.common.push({name:"중간 칸막이",width:d,depth:t-a-17,thickness:o,material:"PB"}),A.forEach((C,b)=>{let D="",T=null;n.id.includes("2hanging")?b===0?(D="하부장",T=s.lower):(D="상부장",T=s.upper):n.id.includes("dual-4drawer-pantshanger")||n.id.includes("dual-2drawer-styler")?C.type==="drawer"?(D="하부장",T=s.lower):(D="상부장",T=s.upper):C.type==="drawer"?(T=s.lower,D=""):(T=s.upper,D="");const B=A.filter(z=>z.heightType!=="absolute").reduce((z,te)=>z+(te.height||te.heightRatio||100),0);let E;if(C.heightType==="absolute")E=m(C,w);else{const z=(C.height||C.heightRatio||100)/B;E=j*z}if(C.type==="drawer"&&C.count){const z=C.drawerHeights;for(let te=0;te<C.count;te++){const L=te+1;let O;z&&z[te]?O=z[te]:O=Math.floor((E-o*(C.count-1))/C.count),T.push({name:`${D} ${r("furniture.drawer")}${L} ${r("furniture.handlePlate")}`,width:e,height:O,thickness:l,material:"PET"});const J=e-76,$=O-30,U=t-47-l;T.push({name:`${D} ${r("furniture.drawer")}${L} ${r("furniture.frontPanel")}`,width:J,height:$,thickness:o,material:"PB"}),T.push({name:`${D} ${r("furniture.drawer")}${L} ${r("furniture.backPanel")}`,width:J,height:$,thickness:o,material:"PB"}),T.push({name:`${D} ${r("furniture.drawer")}${L} ${r("furniture.leftPanel")}`,depth:U-o*2,height:$,thickness:o,material:"PB"}),T.push({name:`${D} ${r("furniture.drawer")}${L} ${r("furniture.rightPanel")}`,depth:U-o*2,height:$,thickness:o,material:"PB"}),T.push({name:`${D} ${r("furniture.drawer")}${L} ${r("furniture.bottomPanel")}`,width:J-26,depth:U-26,thickness:h,material:"MDF"})}for(let te=1;te<C.count;te++)T.push({name:`${D} ${r("furniture.drawerDivider")} ${te}`,width:d,depth:t-a-17,thickness:o,material:"PB"})}else if(C.type==="hanging")if(C.shelfPositions&&C.shelfPositions.length>0)C.shelfPositions.forEach((z,te)=>{T.push({name:`${D} 선반 ${te+1}`,width:d,depth:t-8,thickness:o,material:"PB"})});else{const z=Math.round(E);T.push({name:`${D} 옷걸이 공간`,description:"내부 높이",height:z,isInfo:!0})}else if(C.type==="shelf"&&C.count)for(let z=1;z<=C.count;z++)T.push({name:`${D} 선반 ${z}`,width:d,depth:t-8,thickness:o,material:"PB"});else if(C.type==="open"){const z=Math.round(E);T.push({name:`${D} 오픈 공간`,description:"내부 높이",height:z,isInfo:!0})}})}if(i)if(n.id.includes("dual")){const m=Math.floor((e-6)/2);s.door.push({name:"좌측 도어",width:m,height:u-4,thickness:o,material:"PET"}),s.door.push({name:"우측 도어",width:m,height:u-4,thickness:o,material:"PET"})}else s.door.push({name:"도어",width:e-4,height:u-4,thickness:o,material:"PET"});const f=[];return s.upper.length>0&&(f.push({name:`=== ${r("furniture.upperSection")} ===`}),f.push(...s.upper)),s.common.length>0&&f.push(...s.common),s.lower.length>0&&(f.push({name:`=== ${r("furniture.lowerSection")} ===`}),f.push(...s.lower)),s.door.length>0&&i&&(f.push({name:`=== ${r("furniture.door")} ===`}),f.push(...s.door)),f},W5e="_overlay_jqqu0_1",z5e="_panel_jqqu0_15",Q5e="_header_jqqu0_38",$5e="_title_jqqu0_48",V5e="_headerButtons_jqqu0_55",G5e="_deleteButton_jqqu0_61",X5e="_content_jqqu0_82",Y5e="_closeButton_jqqu0_118",K5e="_moduleInfo_jqqu0_143",q5e="_modulePreview_jqqu0_152",Z5e="_moduleImage_jqqu0_166",J5e="_detailsButton_jqqu0_174",eSe="_detailsSection_jqqu0_199",tSe="_panelList_jqqu0_207",nSe="_panelSectionHeader_jqqu0_214",iSe="_panelItem_jqqu0_227",rSe="_panelName_jqqu0_240",sSe="_panelSize_jqqu0_246",oSe="_moduleBox_jqqu0_252",aSe="_moduleDetails_jqqu0_259",lSe="_moduleName_jqqu0_263",cSe="_property_jqqu0_270",hSe="_propertyValue_jqqu0_288",uSe="_propertySection_jqqu0_295",dSe="_sectionTitle_jqqu0_303",ASe="_depthInputWrapper_jqqu0_313",fSe="_inputWithUnit_jqqu0_319",pSe="_depthInput_jqqu0_313",gSe="_inputError_jqqu0_356",mSe="_unit_jqqu0_361",ySe="_errorMessage_jqqu0_369",wSe="_depthRange_jqqu0_375",vSe="_doorTabSelector_jqqu0_382",xSe="_doorTab_jqqu0_382",bSe="_activeDoorTab_jqqu0_407",CSe="_hingeTabSelector_jqqu0_426",_Se="_hingeTab_jqqu0_426",SSe="_activeHingeTab_jqqu0_453",TSe="_hingeTabSubtitle_jqqu0_459",BSe="_coverDoorNote_jqqu0_470",ESe="_backPanelDisabledNote_jqqu0_480",FSe="_warningOverlay_jqqu0_492",kSe="_warningModal_jqqu0_506",ISe="_warningIcon_jqqu0_515",DSe="_warningMessage_jqqu0_520",jSe="_warningCloseButton_jqqu0_527",PSe="_hingeSubSection_jqqu0_644",NSe="_subSectionTitle_jqqu0_648",LSe="_confirmButtons_jqqu0_674",MSe="_cancelButton_jqqu0_682",RSe="_confirmButton_jqqu0_674",Xn={overlay:W5e,panel:z5e,header:Q5e,title:$5e,headerButtons:V5e,deleteButton:G5e,content:X5e,closeButton:Y5e,moduleInfo:K5e,modulePreview:q5e,moduleImage:Z5e,detailsButton:J5e,detailsSection:eSe,panelList:tSe,panelSectionHeader:nSe,panelItem:iSe,panelName:rSe,panelSize:sSe,moduleBox:oSe,moduleDetails:aSe,moduleName:lSe,property:cSe,propertyValue:hSe,propertySection:uSe,sectionTitle:dSe,depthInputWrapper:ASe,inputWithUnit:fSe,depthInput:pSe,inputError:gSe,unit:mSe,errorMessage:ySe,depthRange:wSe,doorTabSelector:vSe,doorTab:xSe,activeDoorTab:bSe,hingeTabSelector:CSe,hingeTab:_Se,activeHingeTab:SSe,hingeTabSubtitle:TSe,coverDoorNote:BSe,backPanelDisabledNote:ESe,warningOverlay:FSe,warningModal:kSe,warningIcon:ISe,warningMessage:DSe,warningCloseButton:jSe,hingeSubSection:PSe,subSectionTitle:NSe,confirmButtons:LSe,cancelButton:MSe,confirmButton:RSe},Zf=n=>`/images/furniture-thumbnails/${n}`,IM={"single-2drawer-hanging":Zf("single-2drawer-hanging.png"),"single-2hanging":Zf("single-2hanging.png"),"single-4drawer-hanging":Zf("single-4drawer-hanging.png"),"dual-2drawer-hanging":Zf("dual-2drawer-hanging.png"),"dual-2hanging":Zf("dual-2hanging.png"),"dual-4drawer-hanging":Zf("dual-4drawer-hanging.png"),"dual-2drawer-styler":Zf("dual-2drawer-styler.png"),"dual-4drawer-pantshanger":Zf("dual-4drawer-pantshanger.png")},USe=n=>{const e=n.replace(/-\d+$/,"");return IM[e]||IM["single-2drawer-hanging"]},OSe=()=>{const{t:n}=ia(),[e,t]=H.useState(!1);H.useEffect(()=>{const Z=document.createElement("style");return Z.textContent=`
      /* 모든 테마에서 input 필드는 항상 흰 배경에 검은 텍스트 */
      .furniture-depth-input,
      input.furniture-depth-input,
      .${Xn.depthInput},
      .${Xn.panel} input[type="text"],
      .${Xn.panel} input[type="number"],
      .${Xn.depthInputWrapper} input,
      .${Xn.inputWithUnit} input {
        color: #000000 !important;
        -webkit-text-fill-color: #000000 !important;
        background-color: #ffffff !important;
        opacity: 1 !important;
        caret-color: #000000 !important;
      }
      .furniture-depth-input:focus,
      input.furniture-depth-input:focus,
      .${Xn.depthInput}:focus,
      .${Xn.panel} input[type="text"]:focus,
      .${Xn.panel} input[type="number"]:focus,
      .${Xn.depthInputWrapper} input:focus,
      .${Xn.inputWithUnit} input:focus {
        color: #000000 !important;
        -webkit-text-fill-color: #000000 !important;
        background-color: #ffffff !important;
      }
      /* 모든 상태에서 적용 */
      .${Xn.depthInput}:hover,
      .${Xn.depthInput}:active,
      .${Xn.depthInput}:disabled,
      .${Xn.depthInput}::placeholder {
        color: #000000 !important;
        -webkit-text-fill-color: #000000 !important;
      }
      /* 다크 테마 클래스가 있는 경우 */
      .theme-dark .furniture-depth-input,
      .theme-dark input.furniture-depth-input,
      .theme-dark .${Xn.depthInput},
      .theme-dark .${Xn.panel} input,
      body.theme-dark .${Xn.depthInput},
      html.theme-dark .${Xn.depthInput} {
        color: #000000 !important;
        -webkit-text-fill-color: #000000 !important;
        background-color: #ffffff !important;
      }
    `,document.head.appendChild(Z),Z.setAttribute("data-furniture-panel-styles","true"),()=>{Z.parentNode&&document.head.removeChild(Z)}},[]);const{spaceInfo:i}=hr(),r=pi(Z=>Z.placedModules),s=pi(Z=>Z.updatePlacedModule),o=pi(Z=>Z.removeModule),{activePopup:a,closeAllPopups:l}=Wi(),[h,u]=H.useState(580),[d,A]=H.useState("580"),[f,p]=H.useState(""),[g,v]=H.useState(600),[w,m]=H.useState("600"),[y,x]=H.useState(""),[S,I]=H.useState("right"),[j,C]=H.useState(!1),[b,D]=H.useState(!1),[T,k]=H.useState(!1);H.useEffect(()=>{const Z=Ae=>{if(console.log("🔑 키 입력 감지:",Ae.key,"activePopup.type:",a.type,"showWarning:",T),T){(Ae.key==="Enter"||Ae.key==="Escape")&&(Ae.preventDefault(),k(!1),console.log("✅ 경고창 닫기"));return}if(a.type==="furnitureEdit")if(Ae.key==="Enter"){const ie=document.activeElement;console.log("🎯 액티브 요소:",ie==null?void 0:ie.tagName,ie),(ie==null?void 0:ie.tagName)!=="INPUT"&&(Ae.preventDefault(),console.log("✅ 엔터키로 팝업 닫기"),l())}else Ae.key==="Escape"&&(Ae.preventDefault(),console.log("✅ ESC키로 팝업 닫기"),l())};return document.addEventListener("keydown",Z),console.log("🎯 키 이벤트 리스너 등록"),()=>{document.removeEventListener("keydown",Z),console.log("🎯 키 이벤트 리스너 제거")}},[a.type,T,l]);const B=H.useCallback(Z=>{if(Z!=null&&Z.defaultDepth)return Math.min(Z.defaultDepth,i.depth);const Ae=Math.floor(i.depth*.9);return Math.min(Ae,fg.DEPTH.DEFAULT_FALLBACK)},[i.depth]),E=a.type==="furnitureEdit"&&a.id?r.find(Z=>Z.id===a.id):null,z=ci.useMemo(()=>{if(!E||E.slotIndex===void 0)return!1;const Z=Kr(i),Ae=Zi(E.moduleId,Z,i);if(!Ae)return!1;const ie=Ae.category==="upper"||E.moduleId.includes("upper-cabinet"),ee=Ae.category==="lower"||E.moduleId.includes("lower-cabinet");return!ie&&!ee?!1:r.some(ae=>{if(ae.id===E.id||ae.slotIndex!==E.slotIndex)return!1;const me=Zi(ae.moduleId,Z,i);if(!me)return!1;const _e=me.category==="upper"||ae.moduleId.includes("upper-cabinet"),ue=me.category==="lower"||ae.moduleId.includes("lower-cabinet");return!!(ie&&ue&&ae.hasGapBackPanel||ee&&_e&&ae.hasGapBackPanel)})},[E,r,i]),te=E?(()=>{let Z=E.moduleId;return E.customWidth&&(Z=`${E.moduleId.replace(/-\d+$/,"")}-${E.customWidth}`),Zi(Z,Kr(i),i)})():null,{slotInfo:L,isCoverDoor:O,isColumnC:J}=ci.useMemo(()=>{if(!E||!te)return{slotInfo:null,isCoverDoor:!1,isColumnC:!1};let Z=null;if(E.slotIndex!==void 0)Z=Ih(i)[E.slotIndex];else{const ee=Ih(i),me=pr(i).threeUnitPositions.findIndex(_e=>Math.abs(_e-E.position.x)<.1);me>=0&&(Z=ee[me])}const Ae=(Z==null?void 0:Z.hasColumn)||!1,ie=(Z==null?void 0:Z.columnType)==="medium"&&(Z==null?void 0:Z.allowMultipleFurniture)||!1;return{slotInfo:Z,isCoverDoor:Ae,isColumnC:ie}},[E,te,i]);if(H.useEffect(()=>{if(E&&te){const Z=E.customDepth!==void 0&&E.customDepth!==null?E.customDepth:B(te),Ae=E.customWidth!==void 0&&E.customWidth!==null?E.customWidth:te.dimensions.width;u(Z),A(Z.toString()),v(Ae),m(Ae.toString()),I(E.hingePosition||"right"),C(E.hasDoor??te.hasDoor??!1),D(E.hasGapBackPanel??!1),console.log("🔧 팝업 초기값 설정:",{moduleId:E.moduleId,hasCustomDepth:E.customDepth!==void 0&&E.customDepth!==null,customDepth:E.customDepth,defaultDepth:B(te),finalDepth:Z,hasCustomWidth:E.customWidth!==void 0&&E.customWidth!==null,customWidth:E.customWidth,defaultWidth:te.dimensions.width,finalWidth:Ae})}},[E==null?void 0:E.id,te==null?void 0:te.id]),a.type!=="furnitureEdit"||!a.id)return console.log("📝 PlacedModulePropertiesPanel 렌더링 안 함:",{type:a.type,id:a.id}),null;console.log("📝 PlacedModulePropertiesPanel 렌더링됨:",{type:a.type,id:a.id});const U=!(te?te.id.startsWith("dual-"):!1);if(!E||!te)return null;const Y=()=>{l()},K=()=>{a.id&&(o(a.id),l())},V=Z=>{u(Z),a.id&&s(a.id,{customDepth:Z})},Q=Z=>{var Ae;if(v(Z),a.id){const ie={customWidth:Z,isSplit:!0};E.customDepth!==void 0&&(ie.customDepth=E.customDepth),s(a.id,ie),console.log("📏 가구 너비 조정:",{originalWidth:te.dimensions.width,newWidth:Z,columnPosition:(Ae=L==null?void 0:L.column)==null?void 0:Ae.position,customDepth:E.customDepth})}},X=Z=>{(Z===""||/^\d+$/.test(Z))&&(A(Z),p(""))},W=()=>{const Z=d;if(Z===""){A(h.toString());return}const Ae=parseInt(Z),ie=fg.DEPTH.MIN,ee=Math.min(i.depth,fg.DEPTH.MAX);Ae<ie?p(n("furniture.minValue",{value:ie})):Ae>ee?p(n("furniture.maxValue",{value:ee})):(p(""),V(Ae))},se=Z=>{Z.key==="Enter"&&W()},q=Z=>{(Z===""||/^\d+$/.test(Z))&&(m(Z),x(""))},de=()=>{const Z=w;if(Z===""){m(g.toString());return}const Ae=parseInt(Z),ie=150,ee=te.dimensions.width;Ae<ie?x(n("furniture.minValue",{value:ie})):Ae>ee?x(n("furniture.maxValue",{value:ee})):(x(""),Q(Ae))},Ce=Z=>{Z.key==="Enter"&&de()},Se=Z=>{if(O){k(!0),setTimeout(()=>k(!1),3e3);return}I(Z),a.id&&s(a.id,{hingePosition:Z})},fe=Z=>{if(C(Z),a.id){const Ae=Wi.getState().showDimensions;s(a.id,{hasDoor:Z}),Wi.getState().setShowDimensions(Ae)}},M=Z=>{D(Z),a.id&&s(a.id,{hasGapBackPanel:Z})};return c.jsxs("div",{className:Xn.overlay,children:[c.jsxs("div",{className:Xn.panel,children:[c.jsxs("div",{className:Xn.header,children:[c.jsx("h3",{className:Xn.title,children:n("furniture.editFurniture")}),c.jsx("div",{className:Xn.headerButtons,children:c.jsx("button",{className:Xn.closeButton,onClick:Y,children:"✕"})})]}),c.jsxs("div",{className:Xn.content,children:[c.jsxs("div",{className:Xn.moduleInfo,children:[c.jsx("div",{className:Xn.modulePreview,children:c.jsx("img",{src:USe(te.id),alt:te.name,className:Xn.moduleImage,onError:Z=>{const Ae=Z.target;Ae.style.display="none";const ie=Ae.parentElement;ie&&(ie.innerHTML=`<div 
                      class="${Xn.moduleBox}"
                      style="
                        background-color: ${te.color};
                        aspect-ratio: ${te.dimensions.width} / ${te.dimensions.height}
                      "
                    ></div>`)}})}),c.jsxs("div",{className:Xn.moduleDetails,children:[c.jsx("h4",{className:Xn.moduleName,children:g&&g!==te.dimensions.width?te.name.replace(/\d+mm/,`${g}mm`):te.name}),c.jsx("div",{className:Xn.property,children:c.jsxs("span",{className:Xn.propertyValue,children:[g," × ",te.dimensions.height," × ",h,"mm"]})})]}),c.jsx("button",{className:Xn.detailsButton,onClick:()=>t(!e),children:n("furniture.viewDetails")})]}),e&&c.jsxs("div",{className:Xn.detailsSection,children:[c.jsx("h5",{className:Xn.sectionTitle,children:n("furniture.panelDetails")}),c.jsx("div",{className:Xn.panelList,children:uG(te,g,h,j,n).map((Z,Ae)=>Z.name&&Z.name.startsWith("===")?c.jsx("div",{className:Xn.panelSectionHeader,children:c.jsx("strong",{children:Z.name.replace(/=/g,"").trim()})},Ae):Z.isInfo?c.jsxs("div",{className:Xn.panelItem,children:[c.jsxs("span",{className:Xn.panelName,children:[Z.name,":"]}),c.jsx("span",{className:Xn.panelSize,children:Z.description&&Z.height?`${Z.description} ${Z.height}mm`:Z.description||""})]},Ae):c.jsxs("div",{className:Xn.panelItem,children:[c.jsxs("span",{className:Xn.panelName,children:[Z.name,":"]}),c.jsxs("span",{className:Xn.panelSize,children:[Z.diameter?`Φ${Z.diameter}mm × L${Z.width}mm`:Z.width&&Z.height?`${Z.width} × ${Z.height}mm`:Z.width&&Z.depth?`${Z.width} × ${Z.depth}mm`:Z.height&&Z.depth?`${Z.height} × ${Z.depth}mm`:Z.description?Z.description:`${Z.width||Z.height||Z.depth}mm`,Z.thickness&&!Z.diameter&&` (T:${Z.thickness})`,Z.material&&` [${Z.material}]`]})]},Ae))})]}),J&&c.jsxs("div",{className:Xn.propertySection,children:[c.jsx("h5",{className:Xn.sectionTitle,children:n("furniture.widthSettings")}),c.jsxs("div",{className:Xn.depthInputWrapper,children:[c.jsxs("div",{className:Xn.inputWithUnit,children:[c.jsx("input",{type:"number",value:w,onChange:Z=>q(Z.target.value),onBlur:de,onKeyDown:Ce,className:`${Xn.depthInput} furniture-depth-input ${y?Xn.inputError:""}`,placeholder:`150-${te.dimensions.width}`,style:{color:"#000000",backgroundColor:"#ffffff",WebkitTextFillColor:"#000000",opacity:1}}),c.jsx("span",{className:Xn.unit,children:"mm"})]}),y&&c.jsx("div",{className:Xn.errorMessage,children:y}),c.jsxs("div",{className:Xn.depthRange,children:[n("furniture.range"),": 150mm ~ ",te.dimensions.width,"mm"]})]})]}),c.jsxs("div",{className:Xn.propertySection,children:[c.jsx("h5",{className:Xn.sectionTitle,children:n("furniture.depthSettings")}),c.jsxs("div",{className:Xn.depthInputWrapper,children:[c.jsxs("div",{className:Xn.inputWithUnit,children:[c.jsx("input",{type:"number",value:d,onChange:Z=>X(Z.target.value),onBlur:W,onKeyDown:se,className:`${Xn.depthInput} furniture-depth-input ${f?Xn.inputError:""}`,placeholder:`${fg.DEPTH.MIN}-${fg.DEPTH.MAX}`,style:{color:"#000000",backgroundColor:"#ffffff",WebkitTextFillColor:"#000000",opacity:1}}),c.jsx("span",{className:Xn.unit,children:"mm"})]}),f&&c.jsx("div",{className:Xn.errorMessage,children:f}),c.jsxs("div",{className:Xn.depthRange,children:[n("furniture.range"),": ",fg.DEPTH.MIN,"mm ~ ",Math.min(i.depth,fg.DEPTH.MAX),"mm"]})]})]}),te.hasDoor&&c.jsxs("div",{className:Xn.propertySection,children:[c.jsx("h5",{className:Xn.sectionTitle,children:n("furniture.doorSettings")}),c.jsxs("div",{className:Xn.doorTabSelector,children:[c.jsx("button",{className:`${Xn.doorTab} ${j?"":Xn.activeDoorTab}`,onClick:()=>fe(!1),children:n("common.none")}),c.jsx("button",{className:`${Xn.doorTab} ${j?Xn.activeDoorTab:""}`,onClick:()=>fe(!0),children:n("common.enabled")})]}),j&&U&&c.jsxs("div",{className:Xn.hingeSubSection,children:[c.jsx("h6",{className:Xn.subSectionTitle,children:n("furniture.hingeDirection")}),c.jsxs("div",{className:Xn.hingeTabSelector,children:[c.jsxs("button",{className:`${Xn.hingeTab} ${S==="left"?Xn.activeHingeTab:""}`,onClick:()=>Se("left"),children:[n("furniture.left"),c.jsx("span",{className:Xn.hingeTabSubtitle,children:n("furniture.openToRight")})]}),c.jsxs("button",{className:`${Xn.hingeTab} ${S==="right"?Xn.activeHingeTab:""}`,onClick:()=>Se("right"),children:[n("furniture.right"),c.jsx("span",{className:Xn.hingeTabSubtitle,children:n("furniture.openToLeft")})]})]}),O&&c.jsx("div",{className:Xn.coverDoorNote,children:n("furniture.coverDoorNote")})]})]}),(te.category==="upper"||te.category==="lower")&&c.jsxs("div",{className:Xn.propertySection,children:[c.jsx("h5",{className:Xn.sectionTitle,children:n("furniture.gapBackPanelSettings")}),z?c.jsx("div",{className:Xn.backPanelDisabledNote,children:n("furniture.backPanelAlreadySet",{position:te.category==="upper"?n("furniture.lowerCabinet"):n("furniture.upperCabinet")})}):c.jsxs("div",{className:Xn.doorTabSelector,children:[c.jsx("button",{className:`${Xn.doorTab} ${b?"":Xn.activeDoorTab}`,onClick:()=>M(!1),children:n("common.none")}),c.jsx("button",{className:`${Xn.doorTab} ${b?Xn.activeDoorTab:""}`,onClick:()=>M(!0),children:n("common.enabled")})]})]}),c.jsxs("button",{className:Xn.deleteButton,onClick:K,children:[c.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[c.jsx("polyline",{points:"3 6 5 6 21 6"}),c.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),c.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),c.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),n("common.delete")]}),c.jsxs("div",{className:Xn.confirmButtons,children:[c.jsx("button",{className:Xn.cancelButton,onClick:Y,children:n("common.cancel")}),c.jsx("button",{className:Xn.confirmButton,onClick:Y,children:n("common.confirm")})]})]})]}),T&&c.jsx("div",{className:Xn.warningOverlay,children:c.jsxs("div",{className:Xn.warningModal,children:[c.jsx("div",{className:Xn.warningIcon,children:"⚠️"}),c.jsx("div",{className:Xn.warningMessage,children:n("furniture.coverDoorNote")}),c.jsx("button",{className:Xn.warningCloseButton,onClick:()=>k(!1),children:n("common.confirm")})]})})]})},HSe="_overlay_1uw12_1",WSe="_modal_1uw12_13",zSe="_header_1uw12_28",QSe="_title_1uw12_37",$Se="_closeButton_1uw12_44",VSe="_content_1uw12_64",GSe="_section_1uw12_79",XSe="_sectionTitle_1uw12_87",YSe="_infoGrid_1uw12_94",KSe="_infoItem_1uw12_100",qSe="_label_1uw12_108",ZSe="_value_1uw12_116",JSe="_panelTable_1uw12_125",e3e="_tableHeader_1uw12_131",t3e="_sectionHeader_1uw12_138",n3e="_headerCell_1uw12_148",i3e="_tableBody_1uw12_160",r3e="_tableRow_1uw12_165",s3e="_cell_1uw12_180",ys={overlay:HSe,modal:WSe,header:zSe,title:QSe,closeButton:$Se,content:VSe,section:GSe,sectionTitle:XSe,infoGrid:YSe,infoItem:KSe,label:qSe,value:ZSe,panelTable:JSe,tableHeader:e3e,sectionHeader:t3e,headerCell:n3e,tableBody:i3e,tableRow:r3e,cell:s3e},o3e=({isOpen:n,onClose:e,moduleData:t,placedModule:i})=>{var u;const{t:r}=ia();if(!n||!t||!i)return null;const s=i.customWidth||t.dimensions.width,o=i.customDepth||t.dimensions.depth,a=((u=i.doorConfig)==null?void 0:u.enabled)||!1,l=uG(t,s,o,a,r),h=l.filter(d=>{var A;return!((A=d.name)!=null&&A.startsWith("==="))}).length;return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:ys.overlay,onClick:e}),c.jsxs("div",{className:ys.modal,children:[c.jsxs("div",{className:ys.header,children:[c.jsx("h2",{className:ys.title,children:"가구 상세 정보"}),c.jsx("button",{className:ys.closeButton,onClick:e,children:"×"})]}),c.jsxs("div",{className:ys.content,children:[c.jsxs("div",{className:ys.section,children:[c.jsx("h3",{className:ys.sectionTitle,children:"기본 정보"}),c.jsxs("div",{className:ys.infoGrid,children:[c.jsxs("div",{className:ys.infoItem,children:[c.jsx("span",{className:ys.label,children:"가구명:"}),c.jsx("span",{className:ys.value,children:i.customWidth&&i.customWidth!==t.dimensions.width?t.name.replace(/\d+mm/,`${i.customWidth}mm`):t.name})]}),c.jsxs("div",{className:ys.infoItem,children:[c.jsx("span",{className:ys.label,children:"타입:"}),c.jsx("span",{className:ys.value,children:t.category})]}),c.jsxs("div",{className:ys.infoItem,children:[c.jsx("span",{className:ys.label,children:"크기:"}),c.jsxs("span",{className:ys.value,children:[i.customWidth||t.dimensions.width," ×",t.dimensions.height," ×",i.customDepth||t.dimensions.depth,"mm"]})]}),c.jsxs("div",{className:ys.infoItem,children:[c.jsx("span",{className:ys.label,children:"슬롯 위치:"}),c.jsxs("span",{className:ys.value,children:["슬롯 ",i.slotIndex+1]})]})]})]}),c.jsxs("div",{className:ys.section,children:[c.jsxs("h3",{className:ys.sectionTitle,children:[r("furniture.panelDetails")," (총 ",h,"개)"]}),c.jsxs("div",{className:ys.panelTable,children:[c.jsxs("div",{className:ys.tableHeader,children:[c.jsx("div",{className:ys.headerCell,children:"패널"}),c.jsx("div",{className:ys.headerCell,children:"크기"}),c.jsx("div",{className:ys.headerCell,children:"재질"})]}),c.jsx("div",{className:ys.tableBody,children:l.map((d,A)=>d.name&&d.name.startsWith("===")?c.jsx("div",{className:ys.sectionHeader,children:c.jsx("strong",{children:d.name.replace(/=/g,"").trim()})},A):d.isInfo?c.jsxs("div",{className:ys.tableRow,children:[c.jsx("div",{className:ys.cell,children:d.name}),c.jsx("div",{className:ys.cell,children:d.description&&d.height?`${d.description} ${d.height}mm`:d.description||""}),c.jsx("div",{className:ys.cell,children:"-"})]},A):c.jsxs("div",{className:ys.tableRow,children:[c.jsx("div",{className:ys.cell,children:d.name}),c.jsxs("div",{className:ys.cell,children:[d.diameter?`Φ${d.diameter}mm × L${d.width}mm`:d.width&&d.height?`${d.width} × ${d.height}mm`:d.width&&d.depth?`${d.width} × ${d.depth}mm`:d.height&&d.depth?`${d.height} × ${d.depth}mm`:d.description?d.description:`${d.width||d.height||d.depth}mm`,d.thickness&&!d.diameter&&` (T:${d.thickness})`]}),c.jsx("div",{className:ys.cell,children:d.material||"-"})]},A))})]})]})]})]})]})},a3e="_container_1mds2_1",l3e="_title_1mds2_8",c3e="_emptyMessage_1mds2_12",h3e="_listContainer_1mds2_25",u3e="_itemContainer_1mds2_50",d3e="_selected_1mds2_67",A3e="_name_1mds2_72",f3e="_dimensions_1mds2_73",p3e="_slotInfo_1mds2_74",g3e="_removeButton_1mds2_78",m3e="_previewContainer_1mds2_90",y3e="_preview_1mds2_90",w3e="_infoContainer_1mds2_110",v3e="_actionsContainer_1mds2_137",Mc={container:a3e,title:l3e,emptyMessage:c3e,listContainer:h3e,itemContainer:u3e,selected:d3e,name:A3e,dimensions:f3e,slotInfo:p3e,removeButton:g3e,previewContainer:m3e,preview:y3e,infoContainer:w3e,actionsContainer:v3e},wu=n=>`/images/furniture-thumbnails/${n}`,DM={"single-2drawer-hanging":wu("single-2drawer-hanging.png"),"single-2hanging":wu("single-2hanging.png"),"single-4drawer-hanging":wu("single-4drawer-hanging.png"),"dual-2drawer-hanging":wu("dual-2drawer-hanging.png"),"dual-2hanging":wu("dual-2hanging.png"),"dual-4drawer-hanging":wu("dual-4drawer-hanging.png"),"dual-2drawer-styler":wu("dual-2drawer-styler.png"),"dual-4drawer-pantshanger":wu("dual-4drawer-pantshanger.png"),"upper-cabinet-shelf":wu("upper-cabinet-shelf.png"),"upper-cabinet-open":wu("upper-cabinet-open.png"),"upper-cabinet-mixed":wu("upper-cabinet-mixed.png")},x3e=()=>{const{spaceInfo:n}=hr(),e=pi(A=>A.placedModules),t=pi(A=>A.removeModule),i=pi(A=>A.selectedPlacedModuleId),r=pi(A=>A.setSelectedPlacedModuleId),[s,o]=H.useState(!1),[a,l]=H.useState(null),[h,u]=H.useState(null),d=Kr(n);return e.length===0?c.jsxs("div",{className:Mc.container,children:[c.jsx("h3",{className:Mc.title,children:"배치된 모듈"}),c.jsx("div",{className:Mc.emptyMessage,children:c.jsx("p",{children:"가구를 배치하려면 라이브러리에서 가구를 드래그하여 3D 뷰어에 놓으세요."})})]}):c.jsxs("div",{className:Mc.container,children:[c.jsxs("h3",{className:Mc.title,children:["배치된 모듈 (",e.length,")"]}),c.jsx("div",{className:Mc.listContainer,children:e.map(A=>{console.log("📋 [PlacedModulesList] 배치된 가구:",{id:A.id,moduleId:A.moduleId,customWidth:A.customWidth,slotIndex:A.slotIndex});let f=A.moduleId;A.customWidth&&(f=`${A.moduleId.replace(/-\d+$/,"")}-${A.customWidth}`);const p=Zi(f,d,n);if(!p)return console.error("❌ [PlacedModulesList] 모듈을 찾을 수 없음:",A.moduleId),null;const g=i===A.moduleId,v=A.moduleId.replace(/-\d+$/,""),w=DM[v]||DM["single-2drawer-hanging"],m=()=>{l(p),u(A),o(!0),r(A.moduleId)};return c.jsxs("div",{className:`${Mc.itemContainer} ${g?Mc.selected:""}`,onClick:m,children:[c.jsx("div",{className:Mc.previewContainer,children:c.jsx("img",{src:w,alt:p.name,className:Mc.preview,onError:y=>{const x=y.target;x.src=wu("single-2drawer-hanging.png")}})}),c.jsxs("div",{className:Mc.infoContainer,children:[c.jsx("div",{className:Mc.name,children:A.customWidth&&A.customWidth!==p.dimensions.width?p.name.replace(/\d+mm/,`${A.customWidth}mm`):p.name}),c.jsxs("div",{className:Mc.dimensions,children:[A.customWidth||p.dimensions.width," × ",p.dimensions.height," × ",A.customDepth||p.dimensions.depth,"mm"]}),c.jsxs("div",{className:Mc.slotInfo,children:["슬롯 ",A.slotIndex+1]})]}),c.jsx("div",{className:Mc.actionsContainer,children:c.jsx("button",{className:Mc.removeButton,onClick:y=>{y.stopPropagation(),t(A.id)},title:"가구 제거",children:"×"})})]},A.id)})}),c.jsx(o3e,{isOpen:s,onClose:()=>o(!1),moduleData:a,placedModule:h})]})},b3e="_container_15agz_1",C3e="_tabNavigation_15agz_22",_3e="_tab_15agz_22",S3e="_activeTab_15agz_59",T3e="_tabLabel_15agz_73",B3e="_content_15agz_79",E3e="_tabContent_15agz_85",F3e="_materialWheelContainer_15agz_90",k3e="_materialWheel_15agz_90",I3e="_materialWheelSvg_15agz_102",D3e="_materialSegment_15agz_107",j3e="_colorSection_15agz_119",P3e="_colorSectionTitle_15agz_125",N3e="_colorWheel_15agz_133",L3e="_colorWheelGradient_15agz_146",M3e="_colorWheelCenter_15agz_168",R3e="_hoverPointer_15agz_177",U3e="_colorSelector_15agz_190",O3e="_opacitySection_15agz_201",H3e="_opacityHeader_15agz_205",W3e="_opacityLabel_15agz_211",z3e="_opacityValue_15agz_217",Q3e="_opacitySliderContainer_15agz_223",$3e="_opacitySliderBackground_15agz_228",V3e="_opacitySlider_15agz_223",G3e="_opacityHandle_15agz_246",X3e="_hexSection_15agz_265",Y3e="_hexPreview_15agz_272",K3e="_hexInputContainer_15agz_281",q3e="_hexPrefix_15agz_286",Z3e="_hexInput_15agz_281",J3e="_savedColorsSection_15agz_321",e4e="_savedColorsHeader_15agz_325",t4e="_savedColorsLabel_15agz_332",n4e="_savedColorsHint_15agz_338",i4e="_savedColorsGrid_15agz_343",r4e="_savedColorButton_15agz_353",s4e="_selectedSavedColor_15agz_373",o4e="_selectedSavedColorIndicator_15agz_380",a4e="_savedColorRemove_15agz_393",l4e="_savedColorRemoveButton_15agz_417",c4e="_addColorButton_15agz_438",h4e="_addColorButtonText_15agz_458",Nr={container:b3e,tabNavigation:C3e,tab:_3e,activeTab:S3e,tabLabel:T3e,content:B3e,tabContent:E3e,materialWheelContainer:F3e,materialWheel:k3e,materialWheelSvg:I3e,materialSegment:D3e,colorSection:j3e,colorSectionTitle:P3e,colorWheel:N3e,colorWheelGradient:L3e,colorWheelCenter:M3e,hoverPointer:R3e,colorSelector:U3e,opacitySection:O3e,opacityHeader:H3e,opacityLabel:W3e,opacityValue:z3e,opacitySliderContainer:Q3e,opacitySliderBackground:$3e,opacitySlider:V3e,opacityHandle:G3e,hexSection:X3e,hexPreview:Y3e,hexInputContainer:K3e,hexPrefix:q3e,hexInput:Z3e,savedColorsSection:J3e,savedColorsHeader:e4e,savedColorsLabel:t4e,savedColorsHint:n4e,savedColorsGrid:i4e,savedColorButton:r4e,selectedSavedColor:s4e,selectedSavedColorIndicator:o4e,savedColorRemove:a4e,savedColorRemoveButton:l4e,addColorButton:c4e,addColorButtonText:h4e},tT=(...n)=>n.filter(Boolean).join(" "),jM=[{id:"o1",name:"Cream",color:"#f5f5f0",position:1,isInner:!1},{id:"o2",name:"Light Beige",color:"#d8d3c0",position:2,isInner:!1},{id:"o3",name:"Beige",color:"#d5c6ad",position:3,isInner:!1},{id:"o4",name:"Tan",color:"#c8b89b",position:4,isInner:!1},{id:"o5",name:"Terracotta",color:"#b15f4c",position:5,isInner:!1},{id:"o6",name:"Slate Blue",color:"#6a869c",position:6,isInner:!1},{id:"o7",name:"Light Sage",color:"#b9bea7",position:7,isInner:!1},{id:"o8",name:"Olive",color:"#697a50",position:8,isInner:!1},{id:"o9",name:"Sage",color:"#a3a78c",position:9,isInner:!1},{id:"o10",name:"Charcoal",color:"#4b4b4b",position:10,isInner:!1},{id:"o11",name:"Black",color:"#212121",position:11,isInner:!1},{id:"o12",name:"Dark Gray",color:"#706e6c",position:12,isInner:!1},{id:"o13",name:"Gray",color:"#a4a4a4",position:13,isInner:!1},{id:"o14",name:"MDF",color:"#e9e5dc",position:14,isInner:!1},{id:"o15",name:"Light Gray",color:"#d3d3d3",position:15,isInner:!1},{id:"i1",name:"Dark Walnut",color:"#43302e",position:1,isInner:!0,texture:"wood"},{id:"i2",name:"Black Oak",color:"#211f1c",position:2,isInner:!0,texture:"wood"},{id:"i3",name:"Walnut",color:"#755541",position:3,isInner:!0,texture:"wood"},{id:"i4",name:"Medium Oak",color:"#b28968",position:4,isInner:!0,texture:"wood"},{id:"i5",name:"Natural Oak",color:"#c7ae7f",position:5,isInner:!0,texture:"wood"},{id:"i6",name:"Light Oak",color:"#d4bd94",position:6,isInner:!0,texture:"wood"},{id:"i7",name:"Cherry",color:"#6e4239",position:7,isInner:!0,texture:"wood"},{id:"i8",name:"Cabinet Texture1",color:"#FFFFFF",position:8,isInner:!0,texture:"image",image:"/materials/solid/cabinet texture1.jpeg"}],u4e=()=>{const{t:n}=ia(),[e,t]=H.useState("interior"),[i,r]=H.useState("Light Oak"),[s,o]=H.useState("#FFFFFF"),[a,l]=H.useState(50),[h,u]=H.useState([{id:"1",hex:"#FF5252"},{id:"2",hex:"#7C4DFF"},{id:"3",hex:"#40C4FF"},{id:"4",hex:"#69F0AE"},{id:"5",hex:"#FFFF00"}]),[d,A]=H.useState(!1),[f,p]=H.useState(null),g=H.useRef(null),v=H.useRef(null),w=H.useRef(null),{spaceInfo:m,setSpaceInfo:y}=hr(),x=m.materialConfig||{interiorColor:"#FFFFFF",doorColor:"#E0E0E0"},{doorsOpen:S,toggleDoors:I}=Wi(),C=pi(se=>se.placedModules).some(se=>se.hasDoor);e==="interior"?x.interiorColor:x.doorColor;const b=se=>{const de={...x,[e==="interior"?"interiorColor":"doorColor"]:se};y({materialConfig:de})},D=se=>{se.stopPropagation()},T=se=>{if(g.current){se.stopPropagation();const q=g.current.getBoundingClientRect(),de=q.width/2,Ce=q.height/2,Se=se.clientX-q.left,fe=se.clientY-q.top,M=Se-de,Z=fe-Ce,Ae=Math.sqrt(M*M+Z*Z),ie=Math.min(q.width,q.height)/2;let ee=Se,ae=fe;if(Ae>ie){const Oe=ie/Ae;ee=de+M*Oe,ae=Ce+Z*Oe}const me=ee/q.width*100,_e=ae/q.height*100,ue=ee-de,Be=ae-Ce;let it=Math.atan2(Be,ue)*(180/Math.PI);it<0&&(it+=360);const De=Math.sqrt(ue*ue+Be*Be),qe=Math.min(De/ie,1)*100,Je=10,et=90-Je,He=Je+et*a/100,ze=V(it,qe,He);if(ze!==s){o(ze);const Oe=document.getElementById("color-selector");Oe&&(Oe.style.left=`${me}%`,Oe.style.top=`${_e}%`),p(null),w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{b(ze),w.current=null},300)}}},k=se=>{se.stopPropagation(),A(!0),T(se)},B=se=>{se.stopPropagation(),d&&T(se)},E=se=>{se.stopPropagation(),A(!1)},z=se=>{if(se.stopPropagation(),g.current&&!d){const q=g.current.getBoundingClientRect(),de=q.width/2,Ce=q.height/2,Se=se.clientX-q.left,fe=se.clientY-q.top,M=Se-de,Z=fe-Ce,Ae=Math.sqrt(M*M+Z*Z),ie=Math.min(q.width,q.height)/2;if(Ae<=ie){let ee=Math.atan2(Z,M)*(180/Math.PI);ee<0&&(ee+=360);const ae=Math.min(Ae/ie,1)*100,me=10,ue=90-me,Be=me+ue*a/100,it=V(ee,ae,Be),De=Se/q.width*100,qe=fe/q.height*100;p({color:it,x:De,y:qe})}else p(null)}},te=se=>{se.stopPropagation(),p(null)},L=se=>{const q=parseInt(se.target.value);if(l(q),s){const{h:de,s:Ce}=K(s),Se=10,M=90-Se,Z=Se+M*q/100,Ae=V(de,Ce,Z);o(Ae),b(Ae)}},O=se=>{let q=se.target.value.toUpperCase();if(q.startsWith("#")||(q="#"+q),/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(q)){o(q);const{h:Ce,s:Se,l:fe}=K(q);if(l(Math.round((fe-10)/80*100)),g.current){const M=Math.min(g.current.offsetWidth,g.current.offsetHeight)/2,Z=Se/100*M,Ae=Ce*Math.PI/180,ie=M,ee=M,ae=ie+Z*Math.cos(Ae),me=ee+Z*Math.sin(Ae),_e=ae/(M*2)*100,ue=me/(M*2)*100,Be=document.getElementById("color-selector");Be&&(Be.style.left=`${_e}%`,Be.style.top=`${ue}%`)}b(q)}},J=(se,q,de)=>{if(r(se),(de==null?void 0:de.texture)==="image"&&(de!=null&&de.image))if(se==="Cabinet Texture1"){const Ce={...x,interiorColor:q,doorColor:q,interiorTexture:de.image,doorTexture:de.image};console.log("🎨 Cabinet Texture1 선택 - 도어와 캐비넷 모두 적용:",{interiorTexture:de.image,doorTexture:de.image,color:q}),y({materialConfig:Ce})}else{const Ce=e==="interior"?"interiorTexture":"doorTexture",Se={...x,[e==="interior"?"interiorColor":"doorColor"]:q,[Ce]:de.image};y({materialConfig:Se})}else{const Ce=e==="interior"?"interiorTexture":"doorTexture",Se={...x,[e==="interior"?"interiorColor":"doorColor"]:q,[Ce]:void 0};y({materialConfig:Se})}},$=()=>{const se={id:`${h.length+1}`,hex:s};u([...h,se])},U=se=>{u(h.filter(q=>q.id!==se))},Y=se=>{o(se),b(se)},K=se=>{const q=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(se);if(!q)return{h:0,s:0,l:0};const de=parseInt(q[1],16)/255,Ce=parseInt(q[2],16)/255,Se=parseInt(q[3],16)/255,fe=Math.max(de,Ce,Se),M=Math.min(de,Ce,Se);let Z,Ae,ie=(fe+M)/2;if(fe===M)Z=Ae=0;else{const ee=fe-M;switch(Ae=ie>.5?ee/(2-fe-M):ee/(fe+M),fe){case de:Z=(Ce-Se)/ee+(Ce<Se?6:0);break;case Ce:Z=(Se-de)/ee+2;break;case Se:Z=(de-Ce)/ee+4;break;default:Z=0}Z*=60}return{h:Z,s:Ae*100,l:ie*100}},V=(se,q,de)=>{se=se%360,q=Math.max(0,Math.min(100,q))/100,de=Math.max(0,Math.min(100,de))/100;const Ce=(1-Math.abs(2*de-1))*q,Se=Ce*(1-Math.abs(se/60%2-1)),fe=de-Ce/2;let M,Z,Ae;return se>=0&&se<60?[M,Z,Ae]=[Ce,Se,0]:se>=60&&se<120?[M,Z,Ae]=[Se,Ce,0]:se>=120&&se<180?[M,Z,Ae]=[0,Ce,Se]:se>=180&&se<240?[M,Z,Ae]=[0,Se,Ce]:se>=240&&se<300?[M,Z,Ae]=[Se,0,Ce]:[M,Z,Ae]=[Ce,0,Se],M=Math.round((M+fe)*255),Z=Math.round((Z+fe)*255),Ae=Math.round((Ae+fe)*255),`#${M.toString(16).padStart(2,"0")}${Z.toString(16).padStart(2,"0")}${Ae.toString(16).padStart(2,"0")}`.toUpperCase()},Q=se=>i===se;H.useEffect(()=>{const se=()=>{A(!1)};return window.addEventListener("mouseup",se),()=>{window.removeEventListener("mouseup",se)}},[]);const X=jM.filter(se=>!se.isInner),W=jM.filter(se=>se.isInner);return c.jsxs("div",{className:Nr.container,children:[c.jsxs("div",{className:Nr.tabNavigation,children:[c.jsx("button",{className:tT(Nr.tab,e==="interior"&&Nr.activeTab),onClick:()=>{t("interior"),C&&!S&&I()},children:c.jsx("span",{className:Nr.tabLabel,children:n("material.interior")})}),c.jsx("button",{className:tT(Nr.tab,e==="door"&&Nr.activeTab),onClick:()=>{t("door"),C&&S&&I()},children:c.jsx("span",{className:Nr.tabLabel,children:n("material.door")})})]}),c.jsx("div",{className:Nr.content,children:c.jsxs("div",{className:Nr.tabContent,children:[c.jsx("div",{className:Nr.materialWheelContainer,children:c.jsx("div",{ref:v,className:Nr.materialWheel,onClick:D,children:c.jsxs("svg",{viewBox:"0 0 100 100",className:Nr.materialWheelSvg,onClick:se=>se.stopPropagation(),children:[c.jsxs("defs",{children:[X.map(se=>c.jsx("pattern",{id:`pattern-${se.id}`,patternUnits:"userSpaceOnUse",width:"10",height:"10",patternTransform:"rotate(45)",children:c.jsx("rect",{width:"10",height:"10",fill:se.color})},`pattern-${se.id}`)),W.map(se=>c.jsxs("pattern",{id:`pattern-${se.id}`,patternUnits:"userSpaceOnUse",width:"10",height:"10",patternTransform:"rotate(45)",children:[se.texture==="image"&&se.image?c.jsx("image",{href:se.image,width:"10",height:"10",preserveAspectRatio:"xMidYMid slice"}):c.jsx("rect",{width:"10",height:"10",fill:se.color}),se.texture==="wood"&&c.jsxs(c.Fragment,{children:[c.jsx("line",{x1:"0",y1:"5",x2:"10",y2:"5",stroke:"rgba(0,0,0,0.1)",strokeWidth:"1"}),c.jsx("line",{x1:"5",y1:"0",x2:"5",y2:"10",stroke:"rgba(0,0,0,0.05)",strokeWidth:"0.5"})]})]},`pattern-${se.id}`))]}),X.map((se,q)=>{const de=360/X.length,Ce=q*de-90,Se=Ce+de,fe=Ce*Math.PI/180,M=Se*Math.PI/180,Z=50+45*Math.cos(fe),Ae=50+45*Math.sin(fe),ie=50+45*Math.cos(M),ee=50+45*Math.sin(M),ae=50+30*Math.cos(M),me=50+30*Math.sin(M),_e=50+30*Math.cos(fe),ue=50+30*Math.sin(fe),Be=de>180?1:0;return c.jsx("path",{d:`M ${Z},${Ae} A 45,45 0 ${Be},1 ${ie},${ee} L ${ae},${me} A 30,30 0 ${Be},0 ${_e},${ue} Z`,fill:se.color,stroke:Q(se.name)?"#1abc9c":"white",strokeWidth:Q(se.name)?"2":"0.5",style:{cursor:"pointer"},className:Nr.materialSegment,onClick:it=>{it.stopPropagation(),J(se.name,se.color,se)}},se.id)}),W.map((se,q)=>{const de=360/W.length,Ce=q*de-90,Se=Ce+de,fe=Ce*Math.PI/180,M=Se*Math.PI/180,Z=50+30*Math.cos(fe),Ae=50+30*Math.sin(fe),ie=50+30*Math.cos(M),ee=50+30*Math.sin(M),ae=50,me=50,_e=de>180?1:0;return c.jsx("path",{d:`M ${Z},${Ae} A 30,30 0 ${_e},1 ${ie},${ee} L ${ae},${me} Z`,fill:se.texture==="image"?`url(#pattern-${se.id})`:se.color,stroke:Q(se.name)?"#1abc9c":"white",strokeWidth:Q(se.name)?"2":"0.5",style:{cursor:"pointer"},className:Nr.materialSegment,onClick:ue=>{ue.stopPropagation(),J(se.name,se.color,se)}},se.id)}),c.jsx("circle",{cx:"50",cy:"50",r:"15",fill:"white",stroke:"#e5e5e5",strokeWidth:"1"}),c.jsx("text",{x:"50",y:"50",textAnchor:"middle",dominantBaseline:"middle",fill:"#333",fontSize:"5",fontWeight:"500",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},lengthAdjust:"spacingAndGlyphs",textLength:"26",children:i})]})})}),c.jsxs("div",{className:Nr.colorSection,children:[c.jsx("div",{className:Nr.colorSectionTitle,children:n("material.colorPicker")}),c.jsxs("div",{ref:g,id:"color-wheel",className:Nr.colorWheel,onClick:T,onMouseDown:k,onMouseMove:se=>{B(se),z(se)},onMouseOver:z,onMouseLeave:te,onMouseUp:E,children:[c.jsx("div",{className:Nr.colorWheelGradient}),c.jsx("div",{className:Nr.colorWheelCenter}),f&&!d&&c.jsx("div",{className:Nr.hoverPointer,style:{left:`${f.x}%`,top:`${f.y}%`,backgroundColor:f.color}}),c.jsx("div",{id:"color-selector",className:Nr.colorSelector,style:{left:"75%",top:"65%",backgroundColor:s}})]}),c.jsxs("div",{className:Nr.opacitySection,children:[c.jsxs("div",{className:Nr.opacityHeader,children:[c.jsx("span",{className:Nr.opacityLabel,children:n("material.brightnessAdjust")}),c.jsxs("span",{className:Nr.opacityValue,children:[a,"%"]})]}),c.jsxs("div",{className:Nr.opacitySliderContainer,children:[c.jsx("div",{className:Nr.opacitySliderBackground,style:{background:`linear-gradient(to right, 
                      ${V(K(s).h,K(s).s,10)}, 
                      ${V(K(s).h,K(s).s,50)}, 
                      ${V(K(s).h,K(s).s,90)})`}}),c.jsx("input",{type:"range",min:"0",max:"100",value:a,onChange:L,className:Nr.opacitySlider}),c.jsx("div",{className:Nr.opacityHandle,style:{left:`calc(${a}% - 8px)`}})]})]}),c.jsxs("div",{className:Nr.hexSection,children:[c.jsx("div",{className:Nr.hexPreview,style:{backgroundColor:s}}),c.jsxs("div",{className:Nr.hexInputContainer,children:[c.jsx("span",{className:Nr.hexPrefix,children:"#"}),c.jsx("input",{type:"text",value:s.replace("#",""),onChange:O,className:Nr.hexInput,maxLength:6,placeholder:"RRGGBB"})]})]}),c.jsxs("div",{className:Nr.savedColorsSection,children:[c.jsxs("div",{className:Nr.savedColorsHeader,children:[c.jsx("span",{className:Nr.savedColorsLabel,children:n("material.savedColors")}),c.jsx("span",{className:Nr.savedColorsHint,children:n("material.addColorHint")})]}),c.jsxs("div",{className:Nr.savedColorsGrid,children:[h.map(se=>c.jsxs("div",{className:tT(Nr.savedColorButton,s===se.hex&&Nr.selectedSavedColor),style:{backgroundColor:se.hex},onClick:()=>Y(se.hex),children:[s===se.hex&&c.jsx("div",{className:Nr.selectedSavedColorIndicator}),c.jsx("div",{className:Nr.savedColorRemove,children:c.jsx("button",{className:Nr.savedColorRemoveButton,onClick:q=>{q.stopPropagation(),U(se.id)},children:"×"})})]},se.id)),c.jsx("div",{className:Nr.addColorButton,onClick:$,children:c.jsx("span",{className:Nr.addColorButtonText,children:"+"})})]})]})]})]})})]})},d4e="_columnThumbnailWrapper_1lymg_1",A4e="_columnThumbnail_1lymg_1",f4e="_columnImage_1lymg_35",p4e="_columnLabel_1lymg_52",ub={columnThumbnailWrapper:d4e,columnThumbnail:A4e,columnImage:f4e,columnLabel:p4e},Z0=({width:n=1200,height:e=2400,depth:t=1200,color:i="#888888",material:r="concrete",onDragStart:s,onDoubleClick:o,title:a="기둥"})=>{const l=d=>{const A={type:"column",width:n,height:e,depth:t,color:i,material:r};d.dataTransfer.setData("application/json",JSON.stringify(A)),d.dataTransfer.effectAllowed="copy",s==null||s(d)},h=()=>{const d={type:"column",width:n,height:e,depth:t,color:i,material:r};o==null||o(d)},u=()=>"/images/column.png";return c.jsxs("div",{className:ub.columnThumbnailWrapper,children:[c.jsx("div",{className:ub.columnThumbnail,draggable:!0,onDragStart:l,onDoubleClick:h,title:`${a} - ${r} (${n}×${t}×${e}mm)`,children:c.jsx("img",{src:u(),alt:`${a} - ${r}`,className:ub.columnImage,onError:d=>{console.error("기둥 이미지 로드 실패:",d);const A=d.target;A.style.display="none";const f=A.parentElement;f&&(f.innerHTML=`<div style="display: flex; align-items: center; justify-content: center; width: 100%; height: 100%; background: #f0f0f0; color: #666; font-size: 12px; text-align: center;">${a}</div>`)}})}),c.jsx("div",{className:ub.columnLabel,children:a})]})},g4e="_columnControl_1b5p1_1",m4e="_thumbnailSection_1b5p1_22",y4e="_thumbnailGrid_1b5p1_32",nT={columnControl:g4e,thumbnailSection:m4e,thumbnailGrid:y4e},w4e=({columns:n,onColumnsChange:e})=>{const{t}=ia(),i=hr(),{isColumnCreationMode:r,setColumnCreationMode:s,selectedColumnId:o,setSelectedColumnId:a}=Wi(),l=u=>{console.log("🎯 기둥 썸네일 드래그 시작")},h=u=>{console.log("🎯 기둥 썸네일 더블클릭:",u);const d=i.spaceInfo;if(!d)return;const A=0,f=-(d.depth||1500)*.01/2+u.depth*.01/2,p={id:`column-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,position:[A,0,f],width:u.width,height:u.height||d.height||2400,depth:u.depth,color:u.color||"#888888",material:u.material||"concrete"};console.log("🏗️ 더블클릭으로 새 기둥 생성:",p),e([...n,p])};return n.find(u=>u.id===o),c.jsx("div",{className:nT.columnControl,children:c.jsxs("div",{className:nT.thumbnailSection,children:[c.jsx("h4",{children:t("sidebar.structureTypes")}),c.jsxs("div",{className:nT.thumbnailGrid,children:[c.jsx(Z0,{width:300,height:2400,depth:730,material:"concrete",color:"#888888",onDragStart:l,onDoubleClick:h,title:t("sidebar.columnA")}),c.jsx(Z0,{width:120,height:2400,depth:730,material:"concrete",color:"#888888",onDragStart:l,onDoubleClick:h,title:t("sidebar.columnB")}),c.jsx(Z0,{width:300,height:2400,depth:300,material:"concrete",color:"#888888",onDragStart:l,onDoubleClick:h,title:t("sidebar.columnC")}),c.jsx(Z0,{width:20,height:2400,depth:730,material:"concrete",color:"#888888",onDragStart:l,onDoubleClick:h,title:t("sidebar.panelA")}),c.jsx(Z0,{width:600,height:18,depth:730,material:"wood",color:"#8B4513",onDragStart:l,onDoubleClick:h,title:t("sidebar.panelB")}),c.jsx(Z0,{width:120,height:2400,depth:730,material:"concrete",color:"#E0E0E0",onDragStart:l,onDoubleClick:h,title:t("sidebar.partition")})]})]})})},v4e="_overlay_rytwa_1",x4e="_modal_rytwa_16",b4e="_modalHeader_rytwa_40",C4e="_keyboardHint_rytwa_53",_4e="_closeButton_rytwa_62",S4e="_modalContent_rytwa_81",T4e="_section_rytwa_87",B4e="_infoRow_rytwa_104",E4e="_columnId_rytwa_112",F4e="_inputRow_rytwa_120",k4e="_inputItem_rytwa_125",I4e="_modalFooter_rytwa_154",D4e="_actionButtons_rytwa_162",j4e="_deleteButton_rytwa_167",P4e="_cancelButton_rytwa_186",N4e="_saveButton_rytwa_205",Io={overlay:v4e,modal:x4e,modalHeader:b4e,keyboardHint:C4e,closeButton:_4e,modalContent:S4e,section:T4e,infoRow:B4e,columnId:E4e,inputRow:F4e,inputItem:k4e,modalFooter:I4e,actionButtons:D4e,deleteButton:j4e,cancelButton:P4e,saveButton:N4e},L4e=({columnId:n,isOpen:e,onClose:t})=>{var k;const{t:i}=ia(),{spaceInfo:r,setSpaceInfo:s}=hr(),{setSelectedColumnId:o,activePopup:a,closeAllPopups:l}=Wi(),h=r.columns||[],u=n?h.find(B=>B.id===n):null,d=H.useRef(null),[A,f]=H.useState({});H.useEffect(()=>{u&&e&&(f({width:u.width,height:u.height,depth:u.depth,position:[...u.position]}),d.current={...u})},[u,e]);const p=r.width||3e3,g=u?(((k=A.position)==null?void 0:k[0])||u.position[0])*100:0,v=u?A.width||u.width:0,w=0,m=Math.max(0,p-v),y=Math.max(w,Math.min(g+p/2-v/2,m)),x=Math.max(w,Math.min(p/2-g-v/2,m)),S=B=>{if(!u)return;const z=Math.max(w,Math.min(B,m))+v/2-p/2,te=[...A.position||u.position];te[0]=z/100,f(L=>{const O={...L,position:te};return j({...u,...O}),O})},I=B=>{if(!u)return;const E=Math.max(w,Math.min(B,m)),z=p/2-E-v/2,te=[...A.position||u.position];te[0]=z/100,f(L=>{const O={...L,position:te};return j({...u,...O}),O})};H.useEffect(()=>{if(!e||!u||a.type!=="columnEdit"||a.id!==n)return;const B=E=>{const z=document.activeElement;if(z&&(z.tagName==="INPUT"||z.tagName==="TEXTAREA"))return;const te=E.shiftKey;switch(E.key){case"ArrowUp":case"ArrowDown":{E.preventDefault();const L=te?10:1,O=E.key==="ArrowUp"?L:-L,J=Math.max(w,Math.min(y+O,m));S(J),console.log("⌨️ 좌측갭 키보드 조정:",{key:E.key,shift:te,step:L,oldValue:Math.round(y),newValue:Math.round(J)});break}case"ArrowLeft":case"ArrowRight":{E.preventDefault();const L=te?100:10,O=E.key==="ArrowLeft"?L:-L,J=Math.max(w,Math.min(x+O,m));I(J),console.log("⌨️ 우측갭 키보드 조정:",{key:E.key,shift:te,step:L,oldValue:Math.round(x),newValue:Math.round(J)});break}}};return document.addEventListener("keydown",B),()=>{document.removeEventListener("keydown",B)}},[e,u,a.type,a.id,n,y,x,w,m,S,I]);const j=B=>{if(!u)return;const E=h.map(z=>z.id===u.id?{...z,...B}:z);s({columns:E})};if(!e||!u||a.type!=="columnEdit"||a.id!==n)return null;const C=(B,E)=>{f(z=>{const te={...z,[B]:E};if(B==="depth"){const L=r.depth||1500,O=E,J=-(L/2)+O/2,$=z.position||u.position;te.position=[$[0],$[1],J/100]}return j({...u,...te}),te})},b=()=>{t()},D=()=>{if(d.current){const B=h.map(E=>E.id===u.id?{...d.current}:E);s({columns:B})}f({}),t()},T=()=>{if(window.confirm(i("column.deleteConfirm"))){const B=h.filter(E=>E.id!==u.id);s({columns:B}),o(null),t()}};return c.jsx("div",{className:Io.overlay,children:c.jsxs("div",{className:Io.modal,children:[c.jsxs("div",{className:Io.modalHeader,children:[c.jsx("h3",{className:Io.title,children:i("column.editColumn")}),c.jsx("button",{className:Io.closeButton,onClick:t,children:"✕"})]}),c.jsxs("div",{className:Io.modalContent,children:[c.jsxs("div",{className:Io.section,children:[c.jsx("h4",{className:Io.sectionTitle,children:i("column.basicInfo")}),c.jsxs("div",{className:Io.infoRow,children:[c.jsxs("span",{children:[i("column.columnId"),":"]}),c.jsx("span",{className:Io.columnId,children:u.id.split("-")[1]})]})]}),c.jsxs("div",{className:Io.section,children:[c.jsx("h4",{className:Io.sectionTitle,children:i("column.size")}),c.jsxs("div",{className:Io.inputRow,children:[c.jsxs("div",{className:Io.inputItem,children:[c.jsxs("label",{children:[i("column.width")," (mm)"]}),c.jsx("input",{type:"number",value:A.width||u.width,onChange:B=>C("width",Number(B.target.value)),min:"100",max:"1000",step:"10"})]}),c.jsxs("div",{className:Io.inputItem,children:[c.jsxs("label",{children:[i("column.depth")," (mm)"]}),c.jsx("input",{type:"number",value:A.depth||u.depth,onChange:B=>C("depth",Number(B.target.value)),min:"100",max:"1500",step:"10"})]}),c.jsxs("div",{className:Io.inputItem,children:[c.jsxs("label",{children:[i("column.height")," (mm)"]}),c.jsx("input",{type:"number",value:A.height||u.height,onChange:B=>C("height",Number(B.target.value)),min:"1000",max:"3000",step:"10"})]})]})]}),c.jsxs("div",{className:Io.section,children:[c.jsx("h4",{className:Io.sectionTitle,children:i("column.position")}),c.jsx("div",{className:Io.keyboardHint,children:c.jsxs("small",{children:["💡 ",i("column.keyboardHint")]})}),c.jsxs("div",{className:Io.inputRow,children:[c.jsxs("div",{className:Io.inputItem,children:[c.jsxs("label",{children:[i("column.leftGap")," (mm)"]}),c.jsx("input",{type:"number",value:Math.round(y),onChange:B=>S(Number(B.target.value)),step:"10"})]}),c.jsxs("div",{className:Io.inputItem,children:[c.jsxs("label",{children:[i("column.rightGap")," (mm)"]}),c.jsx("input",{type:"number",value:Math.round(x),onChange:B=>I(Number(B.target.value)),step:"10"})]})]})]})]}),c.jsxs("div",{className:Io.modalFooter,children:[c.jsx("button",{className:Io.deleteButton,onClick:T,children:i("common.delete")}),c.jsxs("div",{className:Io.actionButtons,children:[c.jsx("button",{className:Io.cancelButton,onClick:D,children:i("common.cancel")}),c.jsx("button",{className:Io.saveButton,onClick:b,children:i("common.confirm")})]})]})]})})},M4e="_overlay_14yio_1",R4e="_modal_14yio_14",U4e="_header_14yio_27",O4e="_closeButton_14yio_42",H4e="_content_14yio_59",W4e="_section_14yio_66",z4e="_sectionTitle_14yio_70",Q4e="_sectionHeader_14yio_76",$4e="_formatTabs_14yio_84",V4e="_formatTab_14yio_84",G4e="_active_14yio_122",X4e="_renderModes_14yio_134",Y4e="_renderMode_14yio_134",K4e="_renderModeContent_14yio_171",q4e="_viewList_14yio_189",Z4e="_viewOption_14yio_195",J4e="_selected_14yio_212",eTe="_viewDescription_14yio_231",tTe="_viewDetail_14yio_237",nTe="_downloadButton_14yio_254",wr={overlay:M4e,modal:R4e,header:U4e,closeButton:O4e,content:H4e,section:W4e,sectionTitle:z4e,sectionHeader:Q4e,formatTabs:$4e,formatTab:V4e,active:G4e,renderModes:X4e,renderMode:Y4e,renderModeContent:K4e,viewList:q4e,viewOption:Z4e,selected:J4e,viewDescription:eTe,viewDetail:tTe,downloadButton:nTe},iTe="_overlay_1e78m_1",rTe="_lightTheme_1e78m_13",sTe="_darkTheme_1e78m_17",oTe="_fullContainer_1e78m_21",aTe="_selected_1e78m_96",lTe="_bottomContainer_1e78m_167",cTe="_sidebar_1e78m_174",hTe="_tabButtons_1e78m_182",uTe="_tabButton_1e78m_182",dTe="_active_1e78m_213",ATe="_tabLabel_1e78m_229",fTe="_tabContent_1e78m_235",pTe="_menuTitle_1e78m_241",gTe="_uploadContent_1e78m_249",mTe="_uploadArea_1e78m_253",yTe="_uploadButton_1e78m_261",wTe="_uploadedFilesList_1e78m_301",vTe="_uploadedFilesTitle_1e78m_307",xTe="_filesGrid_1e78m_314",bTe="_fileItem_1e78m_322",CTe="_fileThumbnail_1e78m_341",_Te="_fileIcon_1e78m_360",STe="_fileName_1e78m_373",TTe="_fileActions_1e78m_385",BTe="_fileActionBtn_1e78m_396",ETe="_subTabContainer_1e78m_424",FTe="_subTab_1e78m_424",kTe="_subTabScrollContainer_1e78m_457",ITe="_subTabWrapper_1e78m_465",DTe="_scrollButton_1e78m_506",jTe="_left_1e78m_526",PTe="_right_1e78m_531",NTe="_disabled_1e78m_542",LTe="_canvasContainer_1e78m_549",MTe="_placeholderText_1e78m_620",RTe="_viewGrid_1e78m_625",UTe="_viewMenuItem_1e78m_631",OTe="_viewItemContent_1e78m_655",HTe="_viewItemPlaceholder_1e78m_673",WTe="_viewItemLabel_1e78m_679",zTe="_mainContainer_1e78m_690",QTe="_contentWrapper_1e78m_699",$Te="_header_1e78m_717",VTe="_controls_1e78m_738",GTe="_zoomControls_1e78m_745",XTe="_zoomBtn_1e78m_754",YTe="_zoomValue_1e78m_775",KTe="_zoomPresetDropdown_1e78m_806",qTe="_zoomPresetButton_1e78m_811",ZTe="_zoomPresetMenu_1e78m_829",JTe="_zoomPresetDivider_1e78m_861",eBe="_paperSizeContainer_1e78m_903",tBe="_paperSizeLabel_1e78m_910",nBe="_generateButton_1e78m_955",iBe="_actionButton_1e78m_980",rBe="_themeToggle_1e78m_1009",sBe="_closeButton_1e78m_1037",oBe="_previewContainer_1e78m_1055",aBe="_rulerWrapper_1e78m_1068",lBe="_rulerCorner_1e78m_1079",cBe="_rulerHorizontal_1e78m_1093",hBe="_rulerVertical_1e78m_1111",uBe="_previewContent_1e78m_1128",dBe="_textItemContent_1e78m_1139",ABe="_infoContent_1e78m_1151",fBe="_infoTitle_1e78m_1159",pBe="_infoSpecs_1e78m_1181",gBe="_infoSpecItem_1e78m_1188",mBe="_titleContent_1e78m_1209",yBe="_specsContent_1e78m_1232",wBe="_notesContent_1e78m_1253",vBe="_textInput_1e78m_1274",xBe="_textAreaInput_1e78m_1288",bBe="_drawingArea_1e78m_1399",CBe="_paperSizeDropdown_1e78m_1540",_Be="_paperSizeButton_1e78m_1544",SBe="_paperSizeMenu_1e78m_1566",TBe="_paperDimensions_1e78m_1606",BBe="_orientationButtons_1e78m_1613",EBe="_orientButton_1e78m_1621",FBe="_resizeHandle_1e78m_1723",kBe="_nw_1e78m_1767",IBe="_ne_1e78m_1772",DBe="_sw_1e78m_1777",jBe="_se_1e78m_96",PBe="_n_1e78m_1253",NBe="_w_1e78m_925",LBe="_e_1e78m_1820",MBe="_s_1e78m_96",RBe="_pagePreviewPanel_1e78m_1870",UBe="_addPageCard_1e78m_1870",OBe="_addPageIcon_1e78m_1896",HBe="_addPageText_1e78m_1909",WBe="_pageList_1e78m_1975",zBe="_portraitList_1e78m_1984",QBe="_pageItemWrapper_1e78m_1988",$Be="_portrait_1e78m_1984",VBe="_pageNumber_1e78m_2004",GBe="_pageItem_1e78m_1988",XBe="_pageThumbnail_1e78m_2106",YBe="_pagePreview_1e78m_1870",KBe="_miniView_1e78m_2137",qBe="_emptyPage_1e78m_2144",ZBe="_deletePageBtn_1e78m_2153",JBe="_alignmentGuideVertical_1e78m_2204",eEe="_alignmentGuideHorizontal_1e78m_2216",tEe="_viewerOverlay_1e78m_2229",nEe="_viewerContainer_1e78m_2252",iEe="_viewerHeader_1e78m_2275",rEe="_viewerSubHeader_1e78m_2311",sEe="_leftControls_1e78m_2321",oEe="_centerControls_1e78m_2322",aEe="_rightControls_1e78m_2323",lEe="_toggleGroup_1e78m_2329",cEe="_toggleLabel_1e78m_2335",hEe="_clickable_1e78m_2342",uEe="_on_1e78m_2363",dEe="_switchHandle_1e78m_2367",AEe="_checkboxGroup_1e78m_2382",fEe="_checkboxLabel_1e78m_2387",pEe="_checkbox_1e78m_2382",gEe="_checkmark_1e78m_2406",mEe="_renderModeGroup_1e78m_2452",yEe="_viewModeGroup_1e78m_2453",wEe="_viewDirectionGroup_1e78m_2454",vEe="_renderModeButton_1e78m_2443",xEe="_viewModeButton_1e78m_2441",bEe="_viewDirectionButton_1e78m_2463",CEe="_viewerContent_1e78m_2542",_Ee="_viewerFooter_1e78m_2549",SEe="_captureButton_1e78m_2558",TEe="_cancelButton_1e78m_2576",BEe="_shapeGrid_1e78m_2729",EEe="_shapeItem_1e78m_2756",FEe="_rotateHandle_1e78m_2870",kEe="_pageListContainer_1e78m_2919",IEe="_zoomSlider_1e78m_2996",DEe="_exportButtonWrapper_1e78m_3617",jEe="_exportPopup_1e78m_3621",PEe="_exportPopupHeader_1e78m_3646",NEe="_exportPopupClose_1e78m_3661",LEe="_exportFormatList_1e78m_3681",MEe="_exportFormatItem_1e78m_3685",REe="_exportPopupFooter_1e78m_3727",UEe="_exportButton_1e78m_3617",Qe={overlay:iTe,lightTheme:rTe,darkTheme:sTe,fullContainer:oTe,selected:aTe,bottomContainer:lTe,sidebar:cTe,tabButtons:hTe,tabButton:uTe,active:dTe,tabLabel:ATe,tabContent:fTe,menuTitle:pTe,uploadContent:gTe,uploadArea:mTe,uploadButton:yTe,uploadedFilesList:wTe,uploadedFilesTitle:vTe,filesGrid:xTe,fileItem:bTe,fileThumbnail:CTe,fileIcon:_Te,fileName:STe,fileActions:TTe,fileActionBtn:BTe,subTabContainer:ETe,subTab:FTe,subTabScrollContainer:kTe,subTabWrapper:ITe,scrollButton:DTe,left:jTe,right:PTe,disabled:NTe,canvasContainer:LTe,placeholderText:MTe,viewGrid:RTe,viewMenuItem:UTe,viewItemContent:OTe,viewItemPlaceholder:HTe,viewItemLabel:WTe,mainContainer:zTe,contentWrapper:QTe,header:$Te,controls:VTe,zoomControls:GTe,zoomBtn:XTe,zoomValue:YTe,zoomPresetDropdown:KTe,zoomPresetButton:qTe,zoomPresetMenu:ZTe,zoomPresetDivider:JTe,paperSizeContainer:eBe,paperSizeLabel:tBe,generateButton:nBe,actionButton:iBe,themeToggle:rBe,closeButton:sBe,previewContainer:oBe,rulerWrapper:aBe,rulerCorner:lBe,rulerHorizontal:cBe,rulerVertical:hBe,previewContent:uBe,textItemContent:dBe,infoContent:ABe,infoTitle:fBe,infoSpecs:pBe,infoSpecItem:gBe,titleContent:mBe,specsContent:yBe,notesContent:wBe,textInput:vBe,textAreaInput:xBe,drawingArea:bBe,paperSizeDropdown:CBe,paperSizeButton:_Be,paperSizeMenu:SBe,paperDimensions:TBe,orientationButtons:BBe,orientButton:EBe,resizeHandle:FBe,nw:kBe,ne:IBe,sw:DBe,se:jBe,n:PBe,w:NBe,e:LBe,s:MBe,pagePreviewPanel:RBe,addPageCard:UBe,addPageIcon:OBe,addPageText:HBe,pageList:WBe,portraitList:zBe,pageItemWrapper:QBe,portrait:$Be,pageNumber:VBe,pageItem:GBe,pageThumbnail:XBe,pagePreview:YBe,miniView:KBe,emptyPage:qBe,deletePageBtn:ZBe,alignmentGuideVertical:JBe,alignmentGuideHorizontal:eEe,viewerOverlay:tEe,viewerContainer:nEe,viewerHeader:iEe,viewerSubHeader:rEe,leftControls:sEe,centerControls:oEe,rightControls:aEe,toggleGroup:lEe,toggleLabel:cEe,clickable:hEe,switch:"_switch_1e78m_2351",on:uEe,switchHandle:dEe,checkboxGroup:AEe,checkboxLabel:fEe,checkbox:pEe,checkmark:gEe,renderModeGroup:mEe,viewModeGroup:yEe,viewDirectionGroup:wEe,renderModeButton:vEe,viewModeButton:xEe,viewDirectionButton:bEe,viewerContent:CEe,viewerFooter:_Ee,captureButton:SEe,cancelButton:TEe,shapeGrid:BEe,shapeItem:EEe,rotateHandle:FEe,pageListContainer:kEe,zoomSlider:IEe,exportButtonWrapper:DEe,exportPopup:jEe,exportPopupHeader:PEe,exportPopupClose:NEe,exportFormatList:LEe,exportFormatItem:MEe,exportPopupFooter:REe,exportButton:UEe},OEe=(n,e)=>{const{view2DDirection:t}=n;switch(t){case"front":return PM(n,e);case"top":return HEe(n,e);case"left":return dG(n,e);case"right":return WEe(n,e);default:return PM(n,e)}},PM=(n,e)=>{const{spaceInfo:t,placedModules:i}=n;let r=`<svg width="${e.width}" height="${e.height}" viewBox="0 0 ${e.width} ${e.height}" xmlns="http://www.w3.org/2000/svg">`;r+=`<rect width="${e.width}" height="${e.height}" fill="white"/>`;const s=50,o=e.width-s*2,a=e.height-s*2,l=o/t.width,h=a/t.height,u=Math.min(l,h),d=(e.width-t.width*u)/2,A=(e.height-t.height*u)/2;return r+=`<g transform="translate(${d}, ${A}) scale(${u})">`,r+=`<rect x="0" y="0" width="${t.width}" height="${t.height}" 
          fill="none" stroke="black" stroke-width="${2/u}"/>`,i.forEach((f,p)=>{var k,B,E,z;const g=Zi(f.moduleId,Kr(t),t);if(!g)return;const v=t.width/2+f.position.x*10-g.dimensions.width/2,w=((k=t.baseConfig)==null?void 0:k.type)==="base_frame"?((B=t.baseConfig)==null?void 0:B.height)||100:0,m=t.height-g.dimensions.height-w,y="#333333",x="#f8f8f8",S=1.5/u;r+='<g opacity="1">',r+=`<rect x="${v}" y="${m}" 
            width="${g.dimensions.width}" height="${g.dimensions.height}"
            fill="${x}" stroke="${y}" stroke-width="${S}"/>`;const j=g.modelConfig,C=(j==null?void 0:j.shelfCount)||0,b=Math.abs(g.dimensions.width-800)<50||Math.abs(g.dimensions.width-1e3)<50;if(C>0)if(b){const te=v+g.dimensions.width/2;r+=`<line x1="${te}" y1="${m}" x2="${te}" y2="${m+g.dimensions.height}"
                stroke="${y}" stroke-width="${S}"/>`;const L=Math.floor(C/2);for(let O=1;O<=L;O++){const J=m+g.dimensions.height/(L+1)*O;r+=`<line x1="${v}" y1="${J}" x2="${te}" y2="${J}"
                  stroke="${y}" stroke-width="${S*.7}"/>`,r+=`<line x1="${te}" y1="${J}" x2="${v+g.dimensions.width}" y2="${J}"
                  stroke="${y}" stroke-width="${S*.7}"/>`}}else for(let te=1;te<=C;te++){const L=m+g.dimensions.height/(C+1)*te;r+=`<line x1="${v}" y1="${L}" x2="${v+g.dimensions.width}" y2="${L}"
                  stroke="${y}" stroke-width="${S*.7}"/>`}if((E=j==null?void 0:j.furnitureType)!=null&&E.includes("door"))if(b){const L=(g.dimensions.width-3)/2;r+=`<rect x="${v}" y="${m}" 
                width="${L}" height="${g.dimensions.height}"
                fill="none" stroke="${y}" stroke-width="${S}"/>`,r+=`<rect x="${v+L+3}" y="${m}" 
                width="${L}" height="${g.dimensions.height}"
                fill="none" stroke="${y}" stroke-width="${S}"/>`;const O=m+g.dimensions.height*.5;r+=`<circle cx="${v+L-30}" cy="${O}" r="${10/u}"
                fill="none" stroke="${y}" stroke-width="${S*.5}"/>`,r+=`<circle cx="${v+L+3+30}" cy="${O}" r="${10/u}"
                fill="none" stroke="${y}" stroke-width="${S*.5}"/>`}else{r+=`<rect x="${v}" y="${m}" 
                width="${g.dimensions.width}" height="${g.dimensions.height}"
                fill="none" stroke="${y}" stroke-width="${S}"/>`;const L=m+g.dimensions.height*.5;r+=`<circle cx="${v+30}" cy="${L}" r="${10/u}"
                fill="none" stroke="${y}" stroke-width="${S*.5}"/>`}if((z=j==null?void 0:j.furnitureType)!=null&&z.includes("drawer")){const te=j.drawerCount||1,L=g.dimensions.height/te;for(let O=0;O<te;O++){const J=m+L*O;O>0&&(r+=`<line x1="${v}" y1="${J}" x2="${v+g.dimensions.width}" y2="${J}"
                  stroke="${y}" stroke-width="${S*.7}"/>`);const $=J+L/2,U=v+g.dimensions.width*.3,Y=v+g.dimensions.width*.7;r+=`<line x1="${U}" y1="${$}" x2="${Y}" y2="${$}"
                stroke="${y}" stroke-width="${S*1.5}"/>`}}r+="</g>";const D=v+g.dimensions.width/2,T=m+g.dimensions.height/2;r+=`<text x="${D}" y="${T}" 
            text-anchor="middle" dominant-baseline="middle" 
            font-size="${Math.min(20/u,g.dimensions.height/10)}" 
            fill="#666" opacity="0.7">${g.name}</text>`;{const te=m+g.dimensions.height+30/u;r+=`<line x1="${v}" y1="${te}" x2="${v+g.dimensions.width}" y2="${te}"
              stroke="#666" stroke-width="${.5/u}"/>`,r+=`<text x="${D}" y="${te+15/u}" 
              text-anchor="middle" font-size="${12/u}" fill="#666">
              ${g.dimensions.width}mm</text>`}}),r+="</g>",r+=`<line x1="${d-30}" y1="${A}" x2="${d-30}" y2="${A+t.height*u}"
            stroke="#666" stroke-width="1"/>`,r+=`<text x="${d-40}" y="${A+t.height*u/2}" 
            text-anchor="middle" font-size="14" fill="#666" transform="rotate(-90, ${d-40}, ${A+t.height*u/2})">
            ${t.height}mm</text>`,r+=`<line x1="${d}" y1="${A+t.height*u+30}" 
            x2="${d+t.width*u}" y2="${A+t.height*u+30}"
            stroke="#666" stroke-width="1"/>`,r+=`<text x="${d+t.width*u/2}" y="${A+t.height*u+45}" 
            text-anchor="middle" font-size="14" fill="#666">
            ${t.width}mm</text>`,r+="</svg>",r},HEe=(n,e)=>{const{spaceInfo:t,placedModules:i}=n;let r=`<svg width="${e.width}" height="${e.height}" viewBox="0 0 ${e.width} ${e.height}" xmlns="http://www.w3.org/2000/svg">`;r+=`<rect width="${e.width}" height="${e.height}" fill="white"/>`;const s=50,o=e.width-s*2,a=e.height-s*2,l=o/t.width,h=a/t.depth,u=Math.min(l,h),d=(e.width-t.width*u)/2,A=(e.height-t.depth*u)/2;return r+=`<g transform="translate(${d}, ${A}) scale(${u})">`,r+=`<rect x="0" y="0" width="${t.width}" height="${t.depth}" 
          fill="none" stroke="black" stroke-width="${2/u}"/>`,i.forEach((f,p)=>{var D;const g=Zi(f.moduleId,Kr(t),t);if(!g)return;const v=t.width/2+f.position.x*10-g.dimensions.width/2,w=20,m="#333333",y="#f8f8f8",x=1.5/u;r+='<g opacity="1">',r+=`<rect x="${v}" y="${w}" 
            width="${g.dimensions.width}" height="${g.dimensions.depth}"
            fill="${y}" stroke="${m}" stroke-width="${x}"/>`;const I=g.modelConfig,j=Math.abs(g.dimensions.width-800)<50||Math.abs(g.dimensions.width-1e3)<50;if(j){const T=v+g.dimensions.width/2;r+=`<line x1="${T}" y1="${w}" x2="${T}" y2="${w+g.dimensions.depth}"
              stroke="${m}" stroke-width="${x}"/>`}if((D=I==null?void 0:I.furnitureType)!=null&&D.includes("door")){const T=Math.min(g.dimensions.depth*.8,200);if(j){const k=g.dimensions.width/2,B=v,E=v+k;r+=`<path d="M ${B} ${w+g.dimensions.depth} 
                A ${T} ${T} 0 0 1 ${B+T} ${w+g.dimensions.depth-T}"
                fill="none" stroke="${m}" stroke-width="${x*.5}" stroke-dasharray="5,5"/>`,r+=`<path d="M ${E+k} ${w+g.dimensions.depth} 
                A ${T} ${T} 0 0 0 ${E+k-T} ${w+g.dimensions.depth-T}"
                fill="none" stroke="${m}" stroke-width="${x*.5}" stroke-dasharray="5,5"/>`}else r+=`<path d="M ${v} ${w+g.dimensions.depth} 
                A ${T} ${T} 0 0 1 ${v+T} ${w+g.dimensions.depth-T}"
                fill="none" stroke="${m}" stroke-width="${x*.5}" stroke-dasharray="5,5"/>`}r+="</g>";const C=v+g.dimensions.width/2,b=w+g.dimensions.depth/2;r+=`<text x="${C}" y="${b}" 
            text-anchor="middle" dominant-baseline="middle" 
            font-size="${Math.min(16/u,g.dimensions.depth/5)}" 
            fill="#666" opacity="0.7">${g.name}</text>`}),r+="</g>",r+=`<line x1="${d-30}" y1="${A}" x2="${d-30}" y2="${A+t.depth*u}"
            stroke="#666" stroke-width="1"/>`,r+=`<text x="${d-40}" y="${A+t.depth*u/2}" 
            text-anchor="middle" font-size="14" fill="#666" transform="rotate(-90, ${d-40}, ${A+t.depth*u/2})">
            ${t.depth}mm</text>`,r+=`<line x1="${d}" y1="${A+t.depth*u+30}" 
            x2="${d+t.width*u}" y2="${A+t.depth*u+30}"
            stroke="#666" stroke-width="1"/>`,r+=`<text x="${d+t.width*u/2}" y="${A+t.depth*u+45}" 
            text-anchor="middle" font-size="14" fill="#666">
            ${t.width}mm</text>`,r+="</svg>",r},dG=(n,e)=>{var y,x;const{spaceInfo:t,placedModules:i,showDimensions:r,renderMode:s}=n;let o=`<svg width="${e.width}" height="${e.height}" viewBox="0 0 ${e.width} ${e.height}" xmlns="http://www.w3.org/2000/svg">`;o+=`<rect width="${e.width}" height="${e.height}" fill="white"/>`;const a=50,l=e.width-a*2,h=e.height-a*2,u=l/t.depth,d=h/t.height,A=Math.min(u,d),f=(e.width-t.depth*A)/2,p=(e.height-t.height*A)/2;o+=`<g transform="translate(${f}, ${p}) scale(${A})">`,o+=`<rect x="0" y="0" width="${t.depth}" height="${t.height}" 
          fill="none" stroke="black" stroke-width="${2/A}"/>`;const g=s==="wireframe"?"#ff5500":"#333333",v=s==="wireframe"?"none":"#f8f8f8",w=s==="wireframe"?2/A:1.5/A,m=s==="wireframe"?.8:1;if(i.length>0){const S=i.reduce((j,C)=>j?C.position.x<j.position.x?C:j:C),I=Zi(S.moduleId,Kr(t),t);if(I){const j=((y=t.baseConfig)==null?void 0:y.type)==="base_frame"?((x=t.baseConfig)==null?void 0:x.height)||100:0,C=20,b=t.height-I.dimensions.height-j,D=I.dimensions.depth,T=I.dimensions.height;o+=`<g opacity="${m}">`,o+=`<rect x="${C}" y="${b}" 
              width="${D}" height="${T}"
              fill="${v}" stroke="${g}" stroke-width="${w}"/>`;const k=I.modelConfig,B=(k==null?void 0:k.shelfCount)||0;if(B>0){const te=Math.min(B,7);for(let L=1;L<=te;L++){const O=b+T/(te+1)*L;o+=`<line x1="${C}" y1="${O}" x2="${C+D}" y2="${O}"
                  stroke="${g}" stroke-width="${w*.7}"/>`}}o+="</g>";const E=C+D/2,z=b+T/2;o+=`<text x="${E}" y="${z}" 
              text-anchor="middle" dominant-baseline="middle" 
              font-size="${Math.min(16/A,T/10)}" 
              fill="#666" opacity="0.7">Left Side View</text>`}}return o+="</g>",r&&(o+=`<line x1="${f-30}" y1="${p}" x2="${f-30}" y2="${p+t.height*A}"
            stroke="#666" stroke-width="1"/>`,o+=`<text x="${f-40}" y="${p+t.height*A/2}" 
            text-anchor="middle" font-size="14" fill="#666" transform="rotate(-90, ${f-40}, ${p+t.height*A/2})">
            ${t.height}mm</text>`,o+=`<line x1="${f}" y1="${p+t.height*A+30}" 
            x2="${f+t.depth*A}" y2="${p+t.height*A+30}"
            stroke="#666" stroke-width="1"/>`,o+=`<text x="${f+t.depth*A/2}" y="${p+t.height*A+45}" 
            text-anchor="middle" font-size="14" fill="#666">
            ${t.depth}mm</text>`),o+="</svg>",o},WEe=(n,e)=>dG(n,e);/*! https://mths.be/cssesc v3.0.0 by @mathias */var iT,NM;function zEe(){if(NM)return iT;NM=1;var n={},e=n.hasOwnProperty,t=function(l,h){if(!l)return h;var u={};for(var d in h)u[d]=e.call(l,d)?l[d]:h[d];return u},i=/[ -,\.\/:-@\[-\^`\{-~]/,r=/[ -,\.\/:-@\[\]\^`\{-~]/,s=/(^|\\+)?(\\[A-F0-9]{1,6})\x20(?![a-fA-F0-9\x20])/g,o=function a(l,h){h=t(h,a.options),h.quotes!="single"&&h.quotes!="double"&&(h.quotes="single");for(var u=h.quotes=="double"?'"':"'",d=h.isIdentifier,A=l.charAt(0),f="",p=0,g=l.length;p<g;){var v=l.charAt(p++),w=v.charCodeAt(),m=void 0;if(w<32||w>126){if(w>=55296&&w<=56319&&p<g){var y=l.charCodeAt(p++);(y&64512)==56320?w=((w&1023)<<10)+(y&1023)+65536:p--}m="\\"+w.toString(16).toUpperCase()+" "}else h.escapeEverything?i.test(v)?m="\\"+v:m="\\"+w.toString(16).toUpperCase()+" ":/[\t\n\f\r\x0B]/.test(v)?m="\\"+w.toString(16).toUpperCase()+" ":v=="\\"||!d&&(v=='"'&&u==v||v=="'"&&u==v)||d&&r.test(v)?m="\\"+v:m=v;f+=m}return d&&(/^-[-\d]/.test(f)?f="\\-"+f.slice(1):/\d/.test(A)&&(f="\\3"+A+" "+f.slice(1))),f=f.replace(s,function(x,S,I){return S&&S.length%2?x:(S||"")+I}),!d&&h.wrap?u+f+u:f};return o.options={escapeEverything:!1,isIdentifier:!1,quotes:"single",wrap:!1},o.version="3.0.0",iT=o,iT}var QEe=zEe();const AG=Vp(QEe);var rT,LM;function $Ee(){if(LM)return rT;LM=1;var n=0,e=1,t=2,i=3,r=4,s=5,o=6,a=/[a-z0-9_-]/i,l=/[\s\t]/,h=function(A){for(var f=!0,p=n,g="",v=0,w,m,y=[];;){if(m=A[v],p===n){if(!m&&f)break;if(!m&&!f)throw new Error("Parse error");if(m==='"'||m==="'")w=m,p=e,f=!1;else if(!l.test(m))if(a.test(m))p=i,f=!1,v--;else throw new Error("Parse error")}else if(p===e)if(m)m==="\\"?p=t:m===w?(y.push(g),g="",p=r):g+=m;else throw new Error("Parse Error");else if(p===t)if(m===w||m==="\\")g+=m,p=e;else throw new Error("Parse error");else if(p===i)if(m)a.test(m)?g+=m:m===","?(y.push(g),g="",p=n):l.test(m)?p=s:m==="\\"&&(p=o);else{y.push(g);break}else if(p===o){if(/[0-9a-f]/i.test(m))throw new Error("Parse error");g+=m,p=i}else if(p===s)if(m){if(a.test(m))g+=" "+m,p=i;else if(m===",")y.push(g),g="",p=n;else if(!l.test(m))throw new Error("Parse error")}else{y.push(g);break}else if(p===r)if(m){if(m===",")p=n;else if(!l.test(m))throw new Error("Parse error")}else break;v++}return y},u=/[^a-z0-9_-]/i,d=function(A,f){var p=f&&f.quote||'"';if(p!=='"'&&p!=="'")throw new Error("Quote must be `'` or `\"`");for(var g=new RegExp(p,"g"),v=[],w=0;w<A.length;++w){var m=A[w];u.test(m)&&(m=m.replace(/\\/g,"\\\\").replace(g,"\\"+p),m=p+m+p),v.push(m)}return v.join(", ")};return rT={parse:h,stringify:d},rT}var VEe=$Ee();const GEe=Vp(VEe);var sT,MM;function XEe(){if(MM)return sT;MM=1;var n={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},e=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function t(f){return f===10||f===13||f===8232||f===8233||f===32||f===9||f===11||f===12||f===160||f>=5760&&e.indexOf(f)>=0}function i(f){switch(f|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:case 114:return!0}return!1}function r(f){return(f|32)===97}function s(f){return f>=48&&f<=57}function o(f){return f>=48&&f<=57||f===43||f===45||f===46}function a(f){this.index=0,this.path=f,this.max=f.length,this.result=[],this.param=0,this.err="",this.segmentStart=0,this.data=[]}function l(f){for(;f.index<f.max&&t(f.path.charCodeAt(f.index));)f.index++}function h(f){var p=f.path.charCodeAt(f.index);if(p===48){f.param=0,f.index++;return}if(p===49){f.param=1,f.index++;return}f.err="SvgPath: arc flag can be 0 or 1 only (at pos "+f.index+")"}function u(f){var p=f.index,g=p,v=f.max,w=!1,m=!1,y=!1,x=!1,S;if(g>=v){f.err="SvgPath: missed param (at pos "+g+")";return}if(S=f.path.charCodeAt(g),(S===43||S===45)&&(g++,S=g<v?f.path.charCodeAt(g):0),!s(S)&&S!==46){f.err="SvgPath: param should start with 0..9 or `.` (at pos "+g+")";return}if(S!==46){if(w=S===48,g++,S=g<v?f.path.charCodeAt(g):0,w&&g<v&&S&&s(S)){f.err="SvgPath: numbers started with `0` such as `09` are illegal (at pos "+p+")";return}for(;g<v&&s(f.path.charCodeAt(g));)g++,m=!0;S=g<v?f.path.charCodeAt(g):0}if(S===46){for(x=!0,g++;s(f.path.charCodeAt(g));)g++,y=!0;S=g<v?f.path.charCodeAt(g):0}if(S===101||S===69){if(x&&!m&&!y){f.err="SvgPath: invalid float exponent (at pos "+g+")";return}if(g++,S=g<v?f.path.charCodeAt(g):0,(S===43||S===45)&&g++,g<v&&s(f.path.charCodeAt(g)))for(;g<v&&s(f.path.charCodeAt(g));)g++;else{f.err="SvgPath: invalid float exponent (at pos "+g+")";return}}f.index=g,f.param=parseFloat(f.path.slice(p,g))+0}function d(f){var p,g;p=f.path[f.segmentStart],g=p.toLowerCase();var v=f.data;if(g==="m"&&v.length>2&&(f.result.push([p,v[0],v[1]]),v=v.slice(2),g="l",p=p==="m"?"l":"L"),g==="r")f.result.push([p].concat(v));else for(;v.length>=n[g]&&(f.result.push([p].concat(v.splice(0,n[g]))),!!n[g]););}function A(f){var p=f.max,g,v,w,m,y;if(f.segmentStart=f.index,g=f.path.charCodeAt(f.index),v=r(g),!i(g)){f.err="SvgPath: bad command "+f.path[f.index]+" (at pos "+f.index+")";return}if(m=n[f.path[f.index].toLowerCase()],f.index++,l(f),f.data=[],!m){d(f);return}for(w=!1;;){for(y=m;y>0;y--){if(v&&(y===3||y===4)?h(f):u(f),f.err.length){d(f);return}f.data.push(f.param),l(f),w=!1,f.index<p&&f.path.charCodeAt(f.index)===44&&(f.index++,l(f),w=!0)}if(!w&&(f.index>=f.max||!o(f.path.charCodeAt(f.index))))break}d(f)}return sT=function(p){var g=new a(p),v=g.max;for(l(g);g.index<v&&!g.err.length;)A(g);return g.result.length&&("mM".indexOf(g.result[0][0])<0?(g.err="SvgPath: string should start with `M` or `m`",g.result=[]):g.result[0][0]="M"),{err:g.err,segments:g.result}},sT}var oT,RM;function fG(){if(RM)return oT;RM=1;function n(t,i){return[t[0]*i[0]+t[2]*i[1],t[1]*i[0]+t[3]*i[1],t[0]*i[2]+t[2]*i[3],t[1]*i[2]+t[3]*i[3],t[0]*i[4]+t[2]*i[5]+t[4],t[1]*i[4]+t[3]*i[5]+t[5]]}function e(){if(!(this instanceof e))return new e;this.queue=[],this.cache=null}return e.prototype.matrix=function(t){return t[0]===1&&t[1]===0&&t[2]===0&&t[3]===1&&t[4]===0&&t[5]===0?this:(this.cache=null,this.queue.push(t),this)},e.prototype.translate=function(t,i){return(t!==0||i!==0)&&(this.cache=null,this.queue.push([1,0,0,1,t,i])),this},e.prototype.scale=function(t,i){return(t!==1||i!==1)&&(this.cache=null,this.queue.push([t,0,0,i,0,0])),this},e.prototype.rotate=function(t,i,r){var s,o,a;return t!==0&&(this.translate(i,r),s=t*Math.PI/180,o=Math.cos(s),a=Math.sin(s),this.queue.push([o,a,-a,o,0,0]),this.cache=null,this.translate(-i,-r)),this},e.prototype.skewX=function(t){return t!==0&&(this.cache=null,this.queue.push([1,0,Math.tan(t*Math.PI/180),1,0,0])),this},e.prototype.skewY=function(t){return t!==0&&(this.cache=null,this.queue.push([1,Math.tan(t*Math.PI/180),0,1,0,0])),this},e.prototype.toArray=function(){if(this.cache)return this.cache;if(!this.queue.length)return this.cache=[1,0,0,1,0,0],this.cache;if(this.cache=this.queue[0],this.queue.length===1)return this.cache;for(var t=1;t<this.queue.length;t++)this.cache=n(this.cache,this.queue[t]);return this.cache},e.prototype.calc=function(t,i,r){var s;return this.queue.length?(this.cache||(this.cache=this.toArray()),s=this.cache,[t*s[0]+i*s[2]+(r?0:s[4]),t*s[1]+i*s[3]+(r?0:s[5])]):[t,i]},oT=e,oT}var aT,UM;function YEe(){if(UM)return aT;UM=1;var n=fG(),e={matrix:!0,scale:!0,rotate:!0,translate:!0,skewX:!0,skewY:!0},t=/\s*(matrix|translate|scale|rotate|skewX|skewY)\s*\(\s*(.+?)\s*\)[\s,]*/,i=/[\s,]+/;return aT=function(s){var o=new n,a,l;return s.split(t).forEach(function(h){if(h.length){if(typeof e[h]<"u"){a=h;return}switch(l=h.split(i).map(function(u){return+u||0}),a){case"matrix":l.length===6&&o.matrix(l);return;case"scale":l.length===1?o.scale(l[0],l[0]):l.length===2&&o.scale(l[0],l[1]);return;case"rotate":l.length===1?o.rotate(l[0],0,0):l.length===3&&o.rotate(l[0],l[1],l[2]);return;case"translate":l.length===1?o.translate(l[0],0):l.length===2&&o.translate(l[0],l[1]);return;case"skewX":l.length===1&&o.skewX(l[0]);return;case"skewY":l.length===1&&o.skewY(l[0]);return}}}),o},aT}var lT,OM;function KEe(){if(OM)return lT;OM=1;var n=Math.PI*2;function e(r,s,o,a){var l=r*a-s*o<0?-1:1,h=r*o+s*a;return h>1&&(h=1),h<-1&&(h=-1),l*Math.acos(h)}function t(r,s,o,a,l,h,u,d,A,f){var p=f*(r-o)/2+A*(s-a)/2,g=-A*(r-o)/2+f*(s-a)/2,v=u*u,w=d*d,m=p*p,y=g*g,x=v*w-v*y-w*m;x<0&&(x=0),x/=v*y+w*m,x=Math.sqrt(x)*(l===h?-1:1);var S=x*u/d*g,I=x*-d/u*p,j=f*S-A*I+(r+o)/2,C=A*S+f*I+(s+a)/2,b=(p-S)/u,D=(g-I)/d,T=(-p-S)/u,k=(-g-I)/d,B=e(1,0,b,D),E=e(b,D,T,k);return h===0&&E>0&&(E-=n),h===1&&E<0&&(E+=n),[j,C,B,E]}function i(r,s){var o=1.3333333333333333*Math.tan(s/4),a=Math.cos(r),l=Math.sin(r),h=Math.cos(r+s),u=Math.sin(r+s);return[a,l,a-l*o,l+a*o,h+u*o,u-h*o,h,u]}return lT=function(s,o,a,l,h,u,d,A,f){var p=Math.sin(f*n/360),g=Math.cos(f*n/360),v=g*(s-a)/2+p*(o-l)/2,w=-p*(s-a)/2+g*(o-l)/2;if(v===0&&w===0)return[];if(d===0||A===0)return[];d=Math.abs(d),A=Math.abs(A);var m=v*v/(d*d)+w*w/(A*A);m>1&&(d*=Math.sqrt(m),A*=Math.sqrt(m));var y=t(s,o,a,l,h,u,d,A,p,g),x=[],S=y[2],I=y[3],j=Math.max(Math.ceil(Math.abs(I)/(n/4)),1);I/=j;for(var C=0;C<j;C++)x.push(i(S,I)),S+=I;return x.map(function(b){for(var D=0;D<b.length;D+=2){var T=b[D+0],k=b[D+1];T*=d,k*=A;var B=g*T-p*k,E=p*T+g*k;b[D+0]=B+y[0],b[D+1]=E+y[1]}return b})},lT}var cT,HM;function qEe(){if(HM)return cT;HM=1;var n=1e-10,e=Math.PI/180;function t(i,r,s){if(!(this instanceof t))return new t(i,r,s);this.rx=i,this.ry=r,this.ax=s}return t.prototype.transform=function(i){var r=Math.cos(this.ax*e),s=Math.sin(this.ax*e),o=[this.rx*(i[0]*r+i[2]*s),this.rx*(i[1]*r+i[3]*s),this.ry*(-i[0]*s+i[2]*r),this.ry*(-i[1]*s+i[3]*r)],a=o[0]*o[0]+o[2]*o[2],l=o[1]*o[1]+o[3]*o[3],h=((o[0]-o[3])*(o[0]-o[3])+(o[2]+o[1])*(o[2]+o[1]))*((o[0]+o[3])*(o[0]+o[3])+(o[2]-o[1])*(o[2]-o[1])),u=(a+l)/2;if(h<n*u)return this.rx=this.ry=Math.sqrt(u),this.ax=0,this;var d=o[0]*o[1]+o[2]*o[3];h=Math.sqrt(h);var A=u+h/2,f=u-h/2;return this.ax=Math.abs(d)<n&&Math.abs(A-l)<n?90:Math.atan(Math.abs(d)>Math.abs(A-l)?(A-a)/d:d/(A-l))*180/Math.PI,this.ax>=0?(this.rx=Math.sqrt(A),this.ry=Math.sqrt(f)):(this.ax+=90,this.rx=Math.sqrt(f),this.ry=Math.sqrt(A)),this},t.prototype.isDegenerate=function(){return this.rx<n*this.ry||this.ry<n*this.rx},cT=t,cT}var hT,WM;function ZEe(){if(WM)return hT;WM=1;var n=XEe(),e=YEe(),t=fG(),i=KEe(),r=qEe();function s(o){if(!(this instanceof s))return new s(o);var a=n(o);this.segments=a.segments,this.err=a.err,this.__stack=[]}return s.from=function(o){if(typeof o=="string")return new s(o);if(o instanceof s){var a=new s("");return a.err=o.err,a.segments=o.segments.map(function(l){return l.slice()}),a.__stack=o.__stack.map(function(l){return t().matrix(l.toArray())}),a}throw new Error("SvgPath.from: invalid param type "+o)},s.prototype.__matrix=function(o){var a=this,l;o.queue.length&&this.iterate(function(h,u,d,A){var f,p,g,v;switch(h[0]){case"v":f=o.calc(0,h[1],!0),p=f[0]===0?["v",f[1]]:["l",f[0],f[1]];break;case"V":f=o.calc(d,h[1],!1),p=f[0]===o.calc(d,A,!1)[0]?["V",f[1]]:["L",f[0],f[1]];break;case"h":f=o.calc(h[1],0,!0),p=f[1]===0?["h",f[0]]:["l",f[0],f[1]];break;case"H":f=o.calc(h[1],A,!1),p=f[1]===o.calc(d,A,!1)[1]?["H",f[0]]:["L",f[0],f[1]];break;case"a":case"A":var w=o.toArray(),m=r(h[1],h[2],h[3]).transform(w);if(w[0]*w[3]-w[1]*w[2]<0&&(h[5]=h[5]?"0":"1"),f=o.calc(h[6],h[7],h[0]==="a"),h[0]==="A"&&h[6]===d&&h[7]===A||h[0]==="a"&&h[6]===0&&h[7]===0){p=[h[0]==="a"?"l":"L",f[0],f[1]];break}m.isDegenerate()?p=[h[0]==="a"?"l":"L",f[0],f[1]]:p=[h[0],m.rx,m.ry,m.ax,h[4],h[5],f[0],f[1]];break;case"m":v=u>0,f=o.calc(h[1],h[2],v),p=["m",f[0],f[1]];break;default:for(g=h[0],p=[g],v=g.toLowerCase()===g,l=1;l<h.length;l+=2)f=o.calc(h[l],h[l+1],v),p.push(f[0],f[1])}a.segments[u]=p},!0)},s.prototype.__evaluateStack=function(){var o,a;if(this.__stack.length){if(this.__stack.length===1){this.__matrix(this.__stack[0]),this.__stack=[];return}for(o=t(),a=this.__stack.length;--a>=0;)o.matrix(this.__stack[a].toArray());this.__matrix(o),this.__stack=[]}},s.prototype.toString=function(){var o="",a="",l=!1;this.__evaluateStack();for(var h=0,u=this.segments.length;h<u;h++){var d=this.segments[h],A=d[0];A!==a||A==="m"||A==="M"?(A==="m"&&a==="z"&&(o+=" "),o+=A,l=!1):l=!0;for(var f=1;f<d.length;f++){var p=d[f];f===1?l&&p>=0&&(o+=" "):p>=0&&(o+=" "),o+=p}a=A}return o},s.prototype.translate=function(o,a){return this.__stack.push(t().translate(o,a||0)),this},s.prototype.scale=function(o,a){return this.__stack.push(t().scale(o,!a&&a!==0?o:a)),this},s.prototype.rotate=function(o,a,l){return this.__stack.push(t().rotate(o,a||0,l||0)),this},s.prototype.skewX=function(o){return this.__stack.push(t().skewX(o)),this},s.prototype.skewY=function(o){return this.__stack.push(t().skewY(o)),this},s.prototype.matrix=function(o){return this.__stack.push(t().matrix(o)),this},s.prototype.transform=function(o){return o.trim()?(this.__stack.push(e(o)),this):this},s.prototype.round=function(o){var a=0,l=0,h=0,u=0,d;return o=o||0,this.__evaluateStack(),this.segments.forEach(function(A){var f=A[0].toLowerCase()===A[0];switch(A[0]){case"H":case"h":f&&(A[1]+=h),h=A[1]-A[1].toFixed(o),A[1]=+A[1].toFixed(o);return;case"V":case"v":f&&(A[1]+=u),u=A[1]-A[1].toFixed(o),A[1]=+A[1].toFixed(o);return;case"Z":case"z":h=a,u=l;return;case"M":case"m":f&&(A[1]+=h,A[2]+=u),h=A[1]-A[1].toFixed(o),u=A[2]-A[2].toFixed(o),a=h,l=u,A[1]=+A[1].toFixed(o),A[2]=+A[2].toFixed(o);return;case"A":case"a":f&&(A[6]+=h,A[7]+=u),h=A[6]-A[6].toFixed(o),u=A[7]-A[7].toFixed(o),A[1]=+A[1].toFixed(o),A[2]=+A[2].toFixed(o),A[3]=+A[3].toFixed(o+2),A[6]=+A[6].toFixed(o),A[7]=+A[7].toFixed(o);return;default:d=A.length,f&&(A[d-2]+=h,A[d-1]+=u),h=A[d-2]-A[d-2].toFixed(o),u=A[d-1]-A[d-1].toFixed(o),A.forEach(function(p,g){g&&(A[g]=+A[g].toFixed(o))});return}}),this},s.prototype.iterate=function(o,a){var l=this.segments,h={},u=!1,d=0,A=0,f=0,p=0,g,v,w;if(a||this.__evaluateStack(),l.forEach(function(m,y){var x=o(m,y,d,A);Array.isArray(x)&&(h[y]=x,u=!0);var S=m[0]===m[0].toLowerCase();switch(m[0]){case"m":case"M":d=m[1]+(S?d:0),A=m[2]+(S?A:0),f=d,p=A;return;case"h":case"H":d=m[1]+(S?d:0);return;case"v":case"V":A=m[1]+(S?A:0);return;case"z":case"Z":d=f,A=p;return;default:d=m[m.length-2]+(S?d:0),A=m[m.length-1]+(S?A:0)}}),!u)return this;for(w=[],g=0;g<l.length;g++)if(typeof h[g]<"u")for(v=0;v<h[g].length;v++)w.push(h[g][v]);else w.push(l[g]);return this.segments=w,this},s.prototype.abs=function(){return this.iterate(function(o,a,l,h){var u=o[0],d=u.toUpperCase(),A;if(u!==d)switch(o[0]=d,u){case"v":o[1]+=h;return;case"a":o[6]+=l,o[7]+=h;return;default:for(A=1;A<o.length;A++)o[A]+=A%2?l:h}},!0),this},s.prototype.rel=function(){return this.iterate(function(o,a,l,h){var u=o[0],d=u.toLowerCase(),A;if(u!==d&&!(a===0&&u==="M"))switch(o[0]=d,u){case"V":o[1]-=h;return;case"A":o[6]-=l,o[7]-=h;return;default:for(A=1;A<o.length;A++)o[A]-=A%2?l:h}},!0),this},s.prototype.unarc=function(){return this.iterate(function(o,a,l,h){var u,d,A,f=[],p=o[0];return p!=="A"&&p!=="a"?null:(p==="a"?(d=l+o[6],A=h+o[7]):(d=o[6],A=o[7]),u=i(l,h,d,A,o[4],o[5],o[1],o[2],o[3]),u.length===0?[[o[0]==="a"?"l":"L",o[6],o[7]]]:(u.forEach(function(g){f.push(["C",g[2],g[3],g[4],g[5],g[6],g[7]])}),f))}),this},s.prototype.unshort=function(){var o=this.segments,a,l,h,u,d;return this.iterate(function(A,f,p,g){var v=A[0],w=v.toUpperCase(),m;f&&(w==="T"?(m=v==="t",h=o[f-1],h[0]==="Q"?(a=h[1]-p,l=h[2]-g):h[0]==="q"?(a=h[1]-h[3],l=h[2]-h[4]):(a=0,l=0),u=-a,d=-l,m||(u+=p,d+=g),o[f]=[m?"q":"Q",u,d,A[1],A[2]]):w==="S"&&(m=v==="s",h=o[f-1],h[0]==="C"?(a=h[3]-p,l=h[4]-g):h[0]==="c"?(a=h[3]-h[5],l=h[4]-h[6]):(a=0,l=0),u=-a,d=-l,m||(u+=p,d+=g),o[f]=[m?"c":"C",u,d,A[1],A[2],A[3],A[4]]))}),this},hT=s,hT}var uT,zM;function JEe(){return zM||(zM=1,uT=ZEe()),uT}var e6e=JEe();const t6e=Vp(e6e);var QM=function(n){var e=n,t,i={a:0,b:0,c:0},r=[],s=/(\[[^\]]+\])/g,o=/(#[^\#\s\+>~\.\[:\)]+)/g,a=/(\.[^\s\+>~\.\[:\)]+)/g,l=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,h=/(:(?!not|global|local)[\w-]+\([^\)]*\))/gi,u=/(:(?!not|global|local)[^\s\+>~\.\[:]+)/g,d=/([^\s\+>~\.\[:]+)/g;return t=function(A,f){var p,g,v,w,m,y;if(A.test(e))for(p=e.match(A),g=0,v=p.length;g<v;g+=1)i[f]+=1,w=p[g],m=e.indexOf(w),y=w.length,r.push({selector:n.substr(m,y),type:f,index:m,length:y}),e=e.replace(w,Array(y+1).join(" "))},(function(){var A=function(v){var w,m,y,x;if(v.test(e))for(w=e.match(v),m=0,y=w.length;m<y;m+=1)x=w[m],e=e.replace(x,Array(x.length+1).join("A"))},f=/\\[0-9A-Fa-f]{6}\s?/g,p=/\\[0-9A-Fa-f]{1,5}\s/g,g=/\\./g;A(f),A(p),A(g)})(),(function(){var A=/{[^]*/gm,f,p,g,v;if(A.test(e))for(f=e.match(A),p=0,g=f.length;p<g;p+=1)v=f[p],e=e.replace(v,Array(v.length+1).join(" "))})(),t(s,"b"),t(o,"a"),t(a,"b"),t(l,"c"),t(h,"b"),t(u,"b"),e=e.replace(/[\*\s\+>~]/g," "),e=e.replace(/[#\.]/g," "),e=e.replace(/:not/g,"    "),e=e.replace(/:local/g,"      "),e=e.replace(/:global/g,"       "),e=e.replace(/[\(\)]/g," "),t(d,"c"),r.sort(function(A,f){return A.index-f.index}),{selector:n,specificity:"0,"+i.a.toString()+","+i.b.toString()+","+i.c.toString(),specificityArray:[0,i.a,i.b,i.c],parts:r}},n6e=function(n,e){var t,i,r;if(typeof n=="string"){if(n.indexOf(",")!==-1)throw"Invalid CSS selector";t=QM(n).specificityArray}else if(Array.isArray(n)){if(n.filter(function(s){return typeof s=="number"}).length!==4)throw"Invalid specificity array";t=n}else throw"Invalid CSS selector or specificity array";if(typeof e=="string"){if(e.indexOf(",")!==-1)throw"Invalid CSS selector";i=QM(e).specificityArray}else if(Array.isArray(e)){if(e.filter(function(s){return typeof s=="number"}).length!==4)throw"Invalid specificity array";i=e}else throw"Invalid CSS selector or specificity array";for(r=0;r<4;r+=1){if(t[r]<i[r])return-1;if(t[r]>i[r])return 1}return 0},d6=function(n,e){return d6=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},d6(n,e)};function To(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}d6(n,e),n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var T_=function(){return T_=Object.assign||function(n){for(var e,t=1,i=arguments.length;t<i;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},T_.apply(this,arguments)};function Mo(n,e,t,i){return new(t||(t=Promise))((function(r,s){function o(h){try{l(i.next(h))}catch(u){s(u)}}function a(h){try{l(i.throw(h))}catch(u){s(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof t?u:new t((function(d){d(u)}))).then(o,a)}l((i=i.apply(n,e||[])).next())}))}function Ro(n,e){var t,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(l){return function(h){return(function(u){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,i&&(r=2&u[0]?i.return:u[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,u[1])).done)return r;switch(i=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return o.label++,{value:u[1],done:!1};case 5:o.label++,i=u[1],u=[0];continue;case 7:u=o.ops.pop(),o.trys.pop();continue;default:if(r=o.trys,!((r=r.length>0&&r[r.length-1])||u[0]!==6&&u[0]!==2)){o=0;continue}if(u[0]===3&&(!r||u[1]>r[0]&&u[1]<r[3])){o.label=u[1];break}if(u[0]===6&&o.label<r[1]){o.label=r[1],r=u;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(u);break}r[2]&&o.ops.pop(),o.trys.pop();continue}u=e.call(n,o)}catch(d){u=[6,d],i=0}finally{t=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}})([l,h])}}}var ld=(function(){function n(e){if(this.a=void 0,this.r=0,this.g=0,this.b=0,this.simpleColors={},this.colorDefs=[],this.ok=!1,e){for(var t in e.charAt(0)=="#"&&(e=e.substr(1,6)),e=(e=e.replace(/ /g,"")).toLowerCase(),this.simpleColors={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgrey:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",grey:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightslategrey:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},this.simpleColors)e==t&&(e=this.simpleColors[t]);this.colorDefs=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^rgb\(([0-9.]+)%,\s*([0-9.]+)%,\s*([0-9.]+)%\)$/,example:["rgb(50.5%, 25.75%, 75.5%)","rgb(100%,0%,0%)"],process:function(l){return[Math.round(2.55*parseFloat(l[1])),Math.round(2.55*parseFloat(l[2])),Math.round(2.55*parseFloat(l[3]))]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}];for(var i=0;i<this.colorDefs.length;i++){var r=this.colorDefs[i].re,s=this.colorDefs[i].process,o=r.exec(e);if(o){var a=s(o);this.r=a[0],this.g=a[1],this.b=a[2],this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b}}return n.prototype.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},n.prototype.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+(this.a||"1")+")"},n.prototype.toHex=function(){var e=this.r.toString(16),t=this.g.toString(16),i=this.b.toString(16);return e.length==1&&(e="0"+e),t.length==1&&(t="0"+t),i.length==1&&(i="0"+i),"#"+e+t+i},n.prototype.getHelpXML=function(){for(var e=[],t=0;t<this.colorDefs.length;t++)for(var i=this.colorDefs[t].example,r=0;r<i.length;r++)e[e.length]=i[r];for(var s in this.simpleColors)e[e.length]=s;var o=document.createElement("ul");for(o.setAttribute("id","rgbcolor-examples"),t=0;t<e.length;t++)try{var a=document.createElement("li"),l=new n(e[t]),h=document.createElement("div");h.style.cssText="margin: 3px; border: 1px solid black; background:"+l.toHex()+"; color:"+l.toHex(),h.appendChild(document.createTextNode("test"));var u=document.createTextNode(" "+e[t]+" -> "+l.toRGB()+" -> "+l.toHex());a.appendChild(h),a.appendChild(u),o.appendChild(a)}catch{}return o},n})(),wc=(function(){function n(e){this.color=e}return n.prototype.getFillData=function(e,t){return Mo(this,void 0,void 0,(function(){return Ro(this,(function(i){return[2,void 0]}))}))},n})(),d1=(function(){function n(){this.xmlSpace="",this.fill=null,this.fillOpacity=1,this.fontFamily="",this.fontSize=16,this.fontStyle="",this.fontWeight="",this.opacity=1,this.stroke=null,this.strokeDasharray=null,this.strokeDashoffset=0,this.strokeLinecap="",this.strokeLinejoin="",this.strokeMiterlimit=4,this.strokeOpacity=1,this.strokeWidth=1,this.alignmentBaseline="",this.textAnchor="",this.visibility="",this.color=null,this.contextFill=null,this.contextStroke=null,this.fillRule=null}return n.prototype.clone=function(){var e=new n;return e.xmlSpace=this.xmlSpace,e.fill=this.fill,e.fillOpacity=this.fillOpacity,e.fontFamily=this.fontFamily,e.fontSize=this.fontSize,e.fontStyle=this.fontStyle,e.fontWeight=this.fontWeight,e.opacity=this.opacity,e.stroke=this.stroke,e.strokeDasharray=this.strokeDasharray,e.strokeDashoffset=this.strokeDashoffset,e.strokeLinecap=this.strokeLinecap,e.strokeLinejoin=this.strokeLinejoin,e.strokeMiterlimit=this.strokeMiterlimit,e.strokeOpacity=this.strokeOpacity,e.strokeWidth=this.strokeWidth,e.textAnchor=this.textAnchor,e.alignmentBaseline=this.alignmentBaseline,e.visibility=this.visibility,e.color=this.color,e.fillRule=this.fillRule,e.contextFill=this.contextFill,e.contextStroke=this.contextStroke,e},n.default=function(){var e=new n;return e.xmlSpace="default",e.fill=new wc(new ld("rgb(0, 0, 0)")),e.fillOpacity=1,e.fontFamily="times",e.fontSize=16,e.fontStyle="normal",e.fontWeight="normal",e.opacity=1,e.stroke=null,e.strokeDasharray=null,e.strokeDashoffset=0,e.strokeLinecap="butt",e.strokeLinejoin="miter",e.strokeMiterlimit=4,e.strokeOpacity=1,e.strokeWidth=1,e.alignmentBaseline="baseline",e.textAnchor="start",e.visibility="visible",e.color=new ld("rgb(0, 0, 0)"),e.fillRule="nonzero",e.contextFill=null,e.contextStroke=null,e},n.getContextColors=function(e,t){t===void 0&&(t=!1);var i={};return e.attributeState.contextFill&&(i.contextFill=e.attributeState.contextFill),e.attributeState.contextStroke&&(i.contextStroke=e.attributeState.contextStroke),t&&e.attributeState.color&&(i.color=e.attributeState.color),i},n})(),Jp=(function(){function n(e,t){var i,r,s;this.pdf=e,this.svg2pdfParameters=t.svg2pdfParameters,this.attributeState=t.attributeState?t.attributeState.clone():d1.default(),this.viewport=t.viewport,this.refsHandler=t.refsHandler,this.styleSheets=t.styleSheets,this.textMeasure=t.textMeasure,this.transform=(i=t.transform)!==null&&i!==void 0?i:this.pdf.unitMatrix,this.withinClipPath=(r=t.withinClipPath)!==null&&r!==void 0&&r,this.withinUse=(s=t.withinUse)!==null&&s!==void 0&&s}return n.prototype.clone=function(e){var t,i,r,s;return e===void 0&&(e={}),new n(this.pdf,{svg2pdfParameters:this.svg2pdfParameters,attributeState:e.attributeState?e.attributeState.clone():this.attributeState.clone(),viewport:(t=e.viewport)!==null&&t!==void 0?t:this.viewport,refsHandler:this.refsHandler,styleSheets:this.styleSheets,textMeasure:this.textMeasure,transform:(i=e.transform)!==null&&i!==void 0?i:this.transform,withinClipPath:(r=e.withinClipPath)!==null&&r!==void 0?r:this.withinClipPath,withinUse:(s=e.withinUse)!==null&&s!==void 0?s:this.withinUse})},n})(),pG=(function(){function n(e){this.renderedElements={},this.idMap=e,this.idPrefix=String(n.instanceCounter++)}return n.prototype.getRendered=function(e,t,i){return Mo(this,void 0,void 0,(function(){var r,s;return Ro(this,(function(o){switch(o.label){case 0:return r=this.generateKey(e,t),this.renderedElements.hasOwnProperty(r)?[2,this.renderedElements[e]]:(s=this.get(e),this.renderedElements[r]=s,[4,i(s)]);case 1:return o.sent(),[2,s]}}))}))},n.prototype.get=function(e){return this.idMap[AG(e,{isIdentifier:!0})]},n.prototype.generateKey=function(e,t){var i="";return t&&(i=["color","contextFill","contextStroke"].map((function(r){var s,o;return(o=(s=t[r])===null||s===void 0?void 0:s.toRGBA())!==null&&o!==void 0?o:""})).join("|")),this.idPrefix+"|"+e+"|"+i},n.instanceCounter=0,n})();function $M(n,e){return Math.atan2(e[1]-n[1],e[0]-n[0])}var VM=2/3;function GM(n,e){return[VM*(e[0]-n[0])+n[0],VM*(e[1]-n[1])+n[1]]}function Ty(n){var e=Math.sqrt(n[0]*n[0]+n[1]*n[1]);return[n[0]/e,n[1]/e]}function J0(n,e){return Ty([e[0]-n[0],e[1]-n[1]])}function db(n,e){return[n[0]+e[0],n[1]+e[1]]}function dT(n,e){var t=n[0],i=n[1];return[e.a*t+e.c*i+e.e,e.b*t+e.d*i+e.f]}var A1=(function(){function n(){this.segments=[]}return n.prototype.moveTo=function(e,t){return this.segments.push(new zl(e,t)),this},n.prototype.lineTo=function(e,t){return this.segments.push(new fp(e,t)),this},n.prototype.curveTo=function(e,t,i,r,s,o){return this.segments.push(new Zd(e,t,i,r,s,o)),this},n.prototype.close=function(){return this.segments.push(new A6),this},n.prototype.transform=function(e){this.segments.forEach((function(t){if(t instanceof zl||t instanceof fp||t instanceof Zd){var i=dT([t.x,t.y],e);t.x=i[0],t.y=i[1]}if(t instanceof Zd){var r=dT([t.x1,t.y1],e),s=dT([t.x2,t.y2],e);t.x1=r[0],t.y1=r[1],t.x2=s[0],t.y2=s[1]}}))},n.prototype.draw=function(e){var t=e.pdf;this.segments.forEach((function(i){i instanceof zl?t.moveTo(i.x,i.y):i instanceof fp?t.lineTo(i.x,i.y):i instanceof Zd?t.curveTo(i.x1,i.y1,i.x2,i.y2,i.x,i.y):t.close()}))},n})(),zl=function(n,e){this.x=n,this.y=e},fp=function(n,e){this.x=n,this.y=e},Zd=function(n,e,t,i,r,s){this.x1=n,this.y1=e,this.x2=t,this.y2=i,this.x=r,this.y=s},A6=function(){};function Wp(n,e){return e.split(",").indexOf((n.nodeName||n.tagName).toLowerCase())>=0}function qn(n,e,t,i){var r;i===void 0&&(i=t);var s=(r=n.style)===null||r===void 0?void 0:r.getPropertyValue(i);if(s)return s;var o=e.getPropertyValue(n,i);return o||n.hasAttribute(t)&&n.getAttribute(t)||void 0}function Df(n,e,t){if(qn(n.element,t.styleSheets,"display")==="none")return!1;var i=e,r=qn(n.element,t.styleSheets,"visibility");return r&&(i=r!=="hidden"),i}function eg(n,e,t){var i=Df(n,e,t);return n.element.childNodes.length!==0&&(n.children.forEach((function(r){r.isVisible(i,t)&&(i=!0)})),i)}var i6e=(function(){function n(){this.markers=[]}return n.prototype.addMarker=function(e){this.markers.push(e)},n.prototype.draw=function(e){return Mo(this,void 0,void 0,(function(){var t,i,r,s,o,a,l,h;return Ro(this,(function(u){switch(u.label){case 0:t=0,u.label=1;case 1:return t<this.markers.length?(i=this.markers[t],r=void 0,s=i.angle,o=i.anchor,a=Math.cos(s),l=Math.sin(s),r=e.pdf.Matrix(a,l,-l,a,o[0],o[1]),r=e.pdf.matrixMult(e.pdf.Matrix(e.attributeState.strokeWidth,0,0,e.attributeState.strokeWidth,0,0),r),r=e.pdf.matrixMult(r,e.transform),e.pdf.saveGraphicsState(),h=d1.getContextColors(e),[4,e.refsHandler.getRendered(i.id,h,(function(d){return d.apply(e)}))]):[3,4];case 2:u.sent(),e.pdf.doFormObject(e.refsHandler.generateKey(i.id,h),r),e.pdf.restoreGraphicsState(),u.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},n})(),Jf=function(n,e,t,i){i===void 0&&(i=!1),this.id=n,this.anchor=e,this.angle=t,this.isStartMarker=i},l8=/url\(["']?#([^"']+)["']?\)/,r6e={bottom:"bottom","text-bottom":"bottom",top:"top","text-top":"top",hanging:"hanging",middle:"middle",central:"middle",center:"middle",mathematical:"middle",ideographic:"ideographic",alphabetic:"alphabetic",baseline:"alphabetic"},XM="http://www.w3.org/2000/svg";function ef(n,e){var t;return(t=n&&n.toString().match(/^([\-0-9.]+)em$/))?parseFloat(t[1])*e:(t=n&&n.toString().match(/^([\-0-9.]+)(px|)$/))?parseFloat(t[1]):0}function gG(n){return r6e[n]||"alphabetic"}function Pu(n){for(var e,t=[],i=/[+-]?(?:(?:\d+\.?\d*)|(?:\d*\.?\d+))(?:[eE][+-]?\d+)?/g;e=i.exec(n);)t.push(parseFloat(e[0]));return t}function Vm(n,e){if(n==="transparent"){var t=new ld("rgb(0,0,0)");return t.a=0,t}if(e&&n.toLowerCase()==="currentcolor")return e.color||new ld("rgb(0,0,0)");if(e&&n.toLowerCase()==="context-stroke")return e.contextStroke||new ld("rgb(0,0,0)");if(e&&n.toLowerCase()==="context-fill")return e.contextFill||new ld("rgb(0,0,0)");var i=/\s*rgba\(((?:[^,\)]*,){3}[^,\)]*)\)\s*/.exec(n);if(i){var r=Pu(i[1]),s=new ld("rgb("+r.slice(0,3).join(",")+")");return s.a=r[3],s}return new ld(n)}var cf={"sans-serif":"helvetica",verdana:"helvetica",arial:"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",serif:"times",cursive:"times",fantasy:"times"},AT,s6e=(AT=qi.version.split("."),parseFloat(AT[0])===2&&parseFloat(AT[1])===3);function mG(n,e){return s6e?e==400?n=="italic"?"italic":"normal":e==700&&n!=="italic"?"bold":n+""+e:e==400||e==="normal"?n==="italic"?"italic":"normal":e!=700&&e!=="bold"||n!=="normal"?(e==700?"bold":e)+""+n:"bold"}function c8(n,e){if(qn(e.element,n.styleSheets,"display")==="none")return[0,0,0,0];var t=[];return e.children.forEach((function(i){var r=i.getBoundingBox(n);if(r[0]!==0||r[1]!==0||r[2]!==0||r[3]!==0){var s=i.computeNodeTransform(n);r[0]=r[0]*s.sx+s.tx,r[1]=r[1]*s.sy+s.ty,r[2]=r[2]*s.sx,r[3]=r[3]*s.sy,t=t.length===0?r:[Math.min(t[0],r[0]),Math.min(t[1],r[1]),Math.max(t[0]+t[2],r[0]+r[2])-Math.min(t[0],r[0]),Math.max(t[1]+t[3],r[1]+r[3])-Math.min(t[1],r[1])]}})),t.length===0?[0,0,0,0]:t}function Sv(n,e){var t=parseFloat,i=t(n.getAttribute("x1"))||t(qn(n,e.styleSheets,"x"))||t(qn(n,e.styleSheets,"cx"))-t(qn(n,e.styleSheets,"r"))||0,r=t(n.getAttribute("x2"))||i+t(qn(n,e.styleSheets,"width"))||t(qn(n,e.styleSheets,"cx"))+t(qn(n,e.styleSheets,"r"))||0,s=t(n.getAttribute("y1"))||t(qn(n,e.styleSheets,"y"))||t(qn(n,e.styleSheets,"cy"))-t(qn(n,e.styleSheets,"r"))||0,o=t(n.getAttribute("y2"))||s+t(qn(n,e.styleSheets,"height"))||t(qn(n,e.styleSheets,"cy"))+t(qn(n,e.styleSheets,"r"))||0;return[Math.min(i,r),Math.min(s,o),Math.max(i,r)-Math.min(i,r),Math.max(s,o)-Math.min(s,o)]}function Tv(n,e,t,i,r,s,o,a){a===void 0&&(a=!1);var l,h,u=e[0],d=e[1],A=e[2],f=e[3],p=r/A,g=s/f,v=n.getAttribute("preserveAspectRatio");if(v){var w=v.split(" ");w[0]==="defer"&&(w=w.slice(1)),l=w[0],h=w[1]||"meet"}else l="xMidYMid",h="meet";if(l!=="none"&&(h==="meet"?p=g=Math.min(p,g):h==="slice"&&(p=g=Math.max(p,g))),a)return o.pdf.Matrix(p,0,0,g,0,0);var m=t-u*p,y=i-d*g;l.indexOf("xMid")>=0?m+=(r-A*p)/2:l.indexOf("xMax")>=0&&(m+=r-A*p),l.indexOf("YMid")>=0?y+=(s-f*g)/2:l.indexOf("YMax")>=0&&(y+=s-f*g);var x=o.pdf.Matrix(1,0,0,1,m,y),S=o.pdf.Matrix(p,0,0,g,0,0);return o.pdf.matrixMult(S,x)}function tS(n,e){if(!n||n==="none")return e.pdf.unitMatrix;for(var t,i,r=/^[\s,]*matrix\(([^)]+)\)\s*/,s=/^[\s,]*translate\(([^)]+)\)\s*/,o=/^[\s,]*rotate\(([^)]+)\)\s*/,a=/^[\s,]*scale\(([^)]+)\)\s*/,l=/^[\s,]*skewX\(([^)]+)\)\s*/,h=/^[\s,]*skewY\(([^)]+)\)\s*/,u=e.pdf.unitMatrix;n.length>0&&n.length!==i;){i=n.length;var d=r.exec(n);if(d&&(t=Pu(d[1]),u=e.pdf.matrixMult(e.pdf.Matrix(t[0],t[1],t[2],t[3],t[4],t[5]),u),n=n.substr(d[0].length)),d=o.exec(n)){t=Pu(d[1]);var A=Math.PI*t[0]/180;if(u=e.pdf.matrixMult(e.pdf.Matrix(Math.cos(A),Math.sin(A),-Math.sin(A),Math.cos(A),0,0),u),t[1]||t[2]){var f=e.pdf.Matrix(1,0,0,1,t[1],t[2]),p=e.pdf.Matrix(1,0,0,1,-t[1],-t[2]);u=e.pdf.matrixMult(p,e.pdf.matrixMult(u,f))}n=n.substr(d[0].length)}(d=s.exec(n))&&(t=Pu(d[1]),u=e.pdf.matrixMult(e.pdf.Matrix(1,0,0,1,t[0],t[1]||0),u),n=n.substr(d[0].length)),(d=a.exec(n))&&((t=Pu(d[1]))[1]||(t[1]=t[0]),u=e.pdf.matrixMult(e.pdf.Matrix(t[0],0,0,t[1],0,0),u),n=n.substr(d[0].length)),(d=l.exec(n))&&(t=parseFloat(d[1]),t*=Math.PI/180,u=e.pdf.matrixMult(e.pdf.Matrix(1,0,Math.tan(t),1,0,0),u),n=n.substr(d[0].length)),(d=h.exec(n))&&(t=parseFloat(d[1]),t*=Math.PI/180,u=e.pdf.matrixMult(e.pdf.Matrix(1,Math.tan(t),0,1,0,0),u),n=n.substr(d[0].length))}return u}var h8=(function(){function n(e,t){this.element=e,this.children=t,this.parent=null}return n.prototype.setParent=function(e){this.parent=e},n.prototype.getParent=function(){return this.parent},n.prototype.getBoundingBox=function(e){return qn(this.element,e.styleSheets,"display")==="none"?[0,0,0,0]:this.getBoundingBoxCore(e)},n.prototype.computeNodeTransform=function(e){var t=this.computeNodeTransformCore(e),i=qn(this.element,e.styleSheets,"transform");return i?e.pdf.matrixMult(t,tS(i,e)):t},n})(),Bv=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return To(e,n),e.prototype.render=function(t){return Promise.resolve()},e.prototype.getBoundingBoxCore=function(t){return[]},e.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},e})(h8),yG=(function(n){function e(t,i,r){var s=n.call(this,i,r)||this;return s.pdfGradientType=t,s.contextColor=void 0,s}return To(e,n),e.prototype.apply=function(t){return Mo(this,void 0,void 0,(function(){var i,r,s,o,a,l;return Ro(this,(function(h){return(i=this.element.getAttribute("id"))?(r=this.getStops(t.styleSheets),s=0,o=!1,r.forEach((function(u){var d=u.opacity;d&&d!==1&&(s+=d,o=!0)})),o&&(a=new l0({opacity:s/r.length})),l=new Ap(this.pdfGradientType,this.getCoordinates(),r,a),t.pdf.addShadingPattern(i,l),[2]):[2]}))}))},e.prototype.getStops=function(t){var i=this;if(this.stops)return this.stops;if(this.contextColor===void 0){this.contextColor=null;for(var r=this;r;){var s=qn(r.element,t,"color");if(s){this.contextColor=Vm(s,null);break}r=r.getParent()}}var o=[];return this.children.forEach((function(a){if(a.element.tagName.toLowerCase()==="stop"){var l=qn(a.element,t,"color"),h=Vm(qn(a.element,t,"stop-color")||"",l?{color:Vm(l,null)}:{color:i.contextColor}),u=parseFloat(qn(a.element,t,"stop-opacity")||"1");o.push({offset:e.parseGradientOffset(a.element.getAttribute("offset")||"0"),color:[h.r,h.g,h.b],opacity:u})}})),this.stops=o},e.prototype.getBoundingBoxCore=function(t){return Sv(this.element,t)},e.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},e.prototype.isVisible=function(t,i){return eg(this,t,i)},e.parseGradientOffset=function(t){var i=parseFloat(t);return!isNaN(i)&&t.indexOf("%")>=0?i/100:i},e})(Bv),wG=(function(n){function e(t,i){return n.call(this,"axial",t,i)||this}return To(e,n),e.prototype.getCoordinates=function(){return[parseFloat(this.element.getAttribute("x1")||"0"),parseFloat(this.element.getAttribute("y1")||"0"),parseFloat(this.element.getAttribute("x2")||"1"),parseFloat(this.element.getAttribute("y2")||"0")]},e})(yG),vG=(function(n){function e(t,i){return n.call(this,"radial",t,i)||this}return To(e,n),e.prototype.getCoordinates=function(){var t=this.element.getAttribute("cx"),i=this.element.getAttribute("cy"),r=this.element.getAttribute("fx"),s=this.element.getAttribute("fy");return[parseFloat(r||t||"0.5"),parseFloat(s||i||"0.5"),0,parseFloat(t||"0.5"),parseFloat(i||"0.5"),parseFloat(this.element.getAttribute("r")||"0.5")]},e})(yG),o6e=(function(){function n(e,t){this.key=e,this.gradient=t}return n.prototype.getFillData=function(e,t){return Mo(this,void 0,void 0,(function(){var i,r,s;return Ro(this,(function(o){switch(o.label){case 0:return[4,t.refsHandler.getRendered(this.key,null,(function(a){return a.apply(new Jp(t.pdf,{refsHandler:t.refsHandler,textMeasure:t.textMeasure,styleSheets:t.styleSheets,viewport:t.viewport,svg2pdfParameters:t.svg2pdfParameters}))}))];case 1:return o.sent(),this.gradient.element.hasAttribute("gradientUnits")&&this.gradient.element.getAttribute("gradientUnits").toLowerCase()!=="objectboundingbox"?i=t.pdf.unitMatrix:(r=e.getBoundingBox(t),i=t.pdf.Matrix(r[2],0,0,r[3],r[0],r[1])),s=tS(qn(this.gradient.element,t.styleSheets,"gradientTransform","transform"),t),[2,{key:this.key,matrix:t.pdf.matrixMult(s,i)}]}}))}))},n})(),xG=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return To(e,n),e.prototype.apply=function(t){return Mo(this,void 0,void 0,(function(){var i,r,s,o,a;return Ro(this,(function(l){switch(l.label){case 0:if(!(i=this.element.getAttribute("id")))return[2];r=this.getBoundingBox(t),s=new Ng([r[0],r[1],r[0]+r[2],r[1]+r[3]],r[2],r[3]),t.pdf.beginTilingPattern(s),o=0,a=this.children,l.label=1;case 1:return o<a.length?[4,a[o].render(new Jp(t.pdf,{attributeState:t.attributeState,refsHandler:t.refsHandler,styleSheets:t.styleSheets,viewport:t.viewport,svg2pdfParameters:t.svg2pdfParameters,textMeasure:t.textMeasure}))]:[3,4];case 2:l.sent(),l.label=3;case 3:return o++,[3,1];case 4:return t.pdf.endTilingPattern(i,s),[2]}}))}))},e.prototype.getBoundingBoxCore=function(t){return Sv(this.element,t)},e.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},e.prototype.isVisible=function(t,i){return eg(this,t,i)},e})(Bv),a6e=(function(){function n(e,t){this.key=e,this.pattern=t}return n.prototype.getFillData=function(e,t){return Mo(this,void 0,void 0,(function(){var i,r,s,o,a,l,h,u,d,A,f,p;return Ro(this,(function(g){switch(g.label){case 0:return[4,t.refsHandler.getRendered(this.key,null,(function(v){return v.apply(new Jp(t.pdf,{refsHandler:t.refsHandler,textMeasure:t.textMeasure,styleSheets:t.styleSheets,viewport:t.viewport,svg2pdfParameters:t.svg2pdfParameters}))}))];case 1:return g.sent(),i={key:this.key,boundingBox:void 0,xStep:0,yStep:0,matrix:void 0},s=t.pdf.unitMatrix,this.pattern.element.hasAttribute("patternUnits")&&this.pattern.element.getAttribute("patternUnits").toLowerCase()!=="objectboundingbox"||(r=e.getBoundingBox(t),s=t.pdf.Matrix(1,0,0,1,r[0],r[1]),a=this.pattern.getBoundingBox(t),l=a[0]*r[0]||0,h=a[1]*r[1]||0,u=a[2]*r[2]||0,d=a[3]*r[3]||0,i.boundingBox=[l,h,l+u,h+d],i.xStep=u,i.yStep=d),o=t.pdf.unitMatrix,this.pattern.element.hasAttribute("patternContentUnits")&&this.pattern.element.getAttribute("patternContentUnits").toLowerCase()==="objectboundingbox"&&(r||(r=e.getBoundingBox(t)),o=t.pdf.Matrix(r[2],0,0,r[3],0,0),a=i.boundingBox||this.pattern.getBoundingBox(t),l=a[0]/r[0]||0,h=a[1]/r[1]||0,u=a[2]/r[2]||0,d=a[3]/r[3]||0,i.boundingBox=[l,h,l+u,h+d],i.xStep=u,i.yStep=d),A=t.pdf.unitMatrix,(f=qn(this.pattern.element,t.styleSheets,"patternTransform","transform"))&&(A=tS(f,t)),p=o,p=t.pdf.matrixMult(p,s),p=t.pdf.matrixMult(p,A),p=t.pdf.matrixMult(p,t.transform),i.matrix=p,[2,i]}}))}))},n})();function l6e(n,e){var t=l8.exec(n);if(t){var i=t[1],r=e.refsHandler.get(i);return r&&(r instanceof wG||r instanceof vG)?(function(o,a,l){var h=a.getStops(l.styleSheets);if(h.length===0)return null;if(h.length===1){var u=h[0].color,d=new ld;return d.ok=!0,d.r=u[0],d.g=u[1],d.b=u[2],d.a=h[0].opacity,new wc(d)}return new o6e(o,a)})(i,r,e):r&&r instanceof xG?new a6e(i,r):new wc(new ld("rgb(0, 0, 0)"))}var s=Vm(n,e.attributeState);return s.ok?new wc(s):null}function u8(n,e,t){var i=t||e.element,r=qn(i,n.styleSheets,"color");if(r){var s=Vm(r,n.attributeState);s.ok?n.attributeState.color=s:n.attributeState.color=new ld("rgb(0,0,0)")}var o=qn(i,n.styleSheets,"visibility");o&&(n.attributeState.visibility=o);var a=qn(i,n.styleSheets,"fill");a&&(n.attributeState.fill=l6e(a,n));var l=qn(i,n.styleSheets,"fill-opacity");l&&(n.attributeState.fillOpacity=parseFloat(l));var h=qn(i,n.styleSheets,"stroke-opacity");h&&(n.attributeState.strokeOpacity=parseFloat(h));var u=qn(i,n.styleSheets,"opacity");u&&(n.attributeState.opacity=parseFloat(u));var d=qn(i,n.styleSheets,"stroke-width");d!==void 0&&d!==""&&(n.attributeState.strokeWidth=Math.abs(parseFloat(d)));var A=qn(i,n.styleSheets,"stroke");if(A)if(A==="none")n.attributeState.stroke=null;else{var f=Vm(A,n.attributeState);f.ok&&(n.attributeState.stroke=new wc(f))}A&&n.attributeState.stroke instanceof wc&&(n.attributeState.contextStroke=n.attributeState.stroke.color),a&&n.attributeState.fill instanceof wc&&(n.attributeState.contextFill=n.attributeState.fill.color);var p=qn(i,n.styleSheets,"stroke-linecap");p&&(n.attributeState.strokeLinecap=p);var g=qn(i,n.styleSheets,"stroke-linejoin");g&&(n.attributeState.strokeLinejoin=g);var v=qn(i,n.styleSheets,"stroke-dasharray");if(v){var w=parseInt(qn(i,n.styleSheets,"stroke-dashoffset")||"0");n.attributeState.strokeDasharray=Pu(v),n.attributeState.strokeDashoffset=w}var m=qn(i,n.styleSheets,"stroke-miterlimit");m!==void 0&&m!==""&&(n.attributeState.strokeMiterlimit=parseFloat(m));var y=i.getAttribute("xml:space");y&&(n.attributeState.xmlSpace=y);var x=qn(i,n.styleSheets,"font-weight");x&&(n.attributeState.fontWeight=x);var S=qn(i,n.styleSheets,"font-style");S&&(n.attributeState.fontStyle=S);var I=qn(i,n.styleSheets,"font-family");if(I){var j=GEe.parse(I);n.attributeState.fontFamily=(function(E,z,te){var L=mG(E.fontStyle,E.fontWeight),O=te.pdf.getFontList(),J="";return z.some((function($){var U=O[$];return U&&U.indexOf(L)>=0?(J=$,!0):($=$.toLowerCase(),!!cf.hasOwnProperty($)&&(J=$,!0))}))||(J="times"),J})(n.attributeState,j,n)}var C=qn(i,n.styleSheets,"font-size");if(C){var b=n.pdf.getFontSize();n.attributeState.fontSize=ef(C,b)}var D=qn(i,n.styleSheets,"vertical-align")||qn(i,n.styleSheets,"alignment-baseline");if(D){var T=D.match(/(baseline|text-bottom|alphabetic|ideographic|middle|central|mathematical|text-top|bottom|center|top|hanging)/);T&&(n.attributeState.alignmentBaseline=T[0])}var k=qn(i,n.styleSheets,"text-anchor");k&&(n.attributeState.textAnchor=k);var B=qn(i,n.styleSheets,"fill-rule");B&&(n.attributeState.fillRule=B)}function d8(n,e,t){var i=1,r=1;i*=n.attributeState.fillOpacity,i*=n.attributeState.opacity,n.attributeState.fill instanceof wc&&n.attributeState.fill.color.a!==void 0&&(i*=n.attributeState.fill.color.a),r*=n.attributeState.strokeOpacity,r*=n.attributeState.opacity,n.attributeState.stroke instanceof wc&&n.attributeState.stroke.color.a!==void 0&&(r*=n.attributeState.stroke.color.a);var s,o,a=i<1,l=r<1;if(Wp(t,"use")?(a=!0,l=!0,i*=n.attributeState.fill?1:0,r*=n.attributeState.stroke?1:0):n.withinUse&&(n.attributeState.fill!==e.attributeState.fill?(a=!0,i*=n.attributeState.fill?1:0):a&&!n.attributeState.fill&&(i=0),n.attributeState.stroke!==e.attributeState.stroke?(l=!0,r*=n.attributeState.stroke?1:0):l&&!n.attributeState.stroke&&(r=0)),a||l){var h={};a&&(h.opacity=i),l&&(h["stroke-opacity"]=r),n.pdf.setGState(new l0(h))}if(n.attributeState.fill&&n.attributeState.fill!==e.attributeState.fill&&n.attributeState.fill instanceof wc&&n.attributeState.fill.color.ok&&!Wp(t,"text")&&n.pdf.setFillColor(n.attributeState.fill.color.r,n.attributeState.fill.color.g,n.attributeState.fill.color.b),n.attributeState.strokeWidth!==e.attributeState.strokeWidth&&n.pdf.setLineWidth(n.attributeState.strokeWidth),n.attributeState.stroke!==e.attributeState.stroke&&n.attributeState.stroke instanceof wc&&n.pdf.setDrawColor(n.attributeState.stroke.color.r,n.attributeState.stroke.color.g,n.attributeState.stroke.color.b),n.attributeState.strokeLinecap!==e.attributeState.strokeLinecap&&n.pdf.setLineCap(n.attributeState.strokeLinecap),n.attributeState.strokeLinejoin!==e.attributeState.strokeLinejoin&&n.pdf.setLineJoin(n.attributeState.strokeLinejoin),n.attributeState.strokeDasharray===e.attributeState.strokeDasharray&&n.attributeState.strokeDashoffset===e.attributeState.strokeDashoffset||!n.attributeState.strokeDasharray||n.pdf.setLineDashPattern(n.attributeState.strokeDasharray,n.attributeState.strokeDashoffset),n.attributeState.strokeMiterlimit!==e.attributeState.strokeMiterlimit&&n.pdf.setLineMiterLimit(n.attributeState.strokeMiterlimit),n.attributeState.fontFamily!==e.attributeState.fontFamily&&(s=cf.hasOwnProperty(n.attributeState.fontFamily)?cf[n.attributeState.fontFamily]:n.attributeState.fontFamily),n.attributeState.fill&&n.attributeState.fill!==e.attributeState.fill&&n.attributeState.fill instanceof wc&&n.attributeState.fill.color.ok){var u=n.attributeState.fill.color;n.pdf.setTextColor(u.r,u.g,u.b)}n.attributeState.fontWeight===e.attributeState.fontWeight&&n.attributeState.fontStyle===e.attributeState.fontStyle||(o=mG(n.attributeState.fontStyle,n.attributeState.fontWeight)),s===void 0&&o===void 0||(s===void 0&&(s=cf.hasOwnProperty(n.attributeState.fontFamily)?cf[n.attributeState.fontFamily]:n.attributeState.fontFamily),n.pdf.setFont(s,o)),n.attributeState.fontSize!==e.attributeState.fontSize&&n.pdf.setFontSize(n.attributeState.fontSize*n.pdf.internal.scaleFactor)}function bG(n,e,t){var i=l8.exec(n);if(i){var r=i[1];return t.refsHandler.get(r)||void 0}}function CG(n,e,t){return Mo(this,void 0,void 0,(function(){var i,r;return Ro(this,(function(s){switch(s.label){case 0:return i=t.clone(),e.element.hasAttribute("clipPathUnits")&&e.element.getAttribute("clipPathUnits").toLowerCase()==="objectboundingbox"&&(r=n.getBoundingBox(t),i.transform=t.pdf.matrixMult(t.pdf.Matrix(r[2],0,0,r[3],r[0],r[1]),t.transform)),[4,e.apply(i)];case 1:return s.sent(),[2]}}))}))}var _G=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return To(e,n),e.prototype.render=function(t){return Mo(this,void 0,void 0,(function(){var i,r,s,o;return Ro(this,(function(a){switch(a.label){case 0:return this.isVisible(t.attributeState.visibility!=="hidden",t)?((i=t.clone()).transform=i.pdf.matrixMult(this.computeNodeTransform(i),t.transform),u8(i,this),r=qn(this.element,i.styleSheets,"clip-path"),(s=r&&r!=="none")?(o=bG(r,0,i))?o.isVisible(!0,i)?(i.pdf.saveGraphicsState(),[4,CG(this,o,i)]):[3,2]:[3,4]:[3,5]):[2];case 1:return a.sent(),[3,3];case 2:return[2];case 3:return[3,5];case 4:s=!1,a.label=5;case 5:return i.withinClipPath||i.pdf.saveGraphicsState(),d8(i,t,this.element),[4,this.renderCore(i)];case 6:return a.sent(),i.withinClipPath||i.pdf.restoreGraphicsState(),s&&i.pdf.restoreGraphicsState(),[2]}}))}))},e})(h8),nS=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return To(e,n),e})(_G),Ev=(function(n){function e(t,i,r){var s=n.call(this,i,r)||this;return s.cachedPath=null,s.hasMarkers=t,s}return To(e,n),e.prototype.renderCore=function(t){return Mo(this,void 0,void 0,(function(){var i;return Ro(this,(function(r){switch(r.label){case 0:return(i=this.getCachedPath(t))===null||i.segments.length===0?[2]:(t.withinClipPath?i.transform(t.transform):t.pdf.setCurrentTransformationMatrix(t.transform),i.draw(t),[4,this.fillOrStroke(t)]);case 1:return r.sent(),this.hasMarkers?[4,this.drawMarkers(t,i)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},e.prototype.getCachedPath=function(t){return this.cachedPath||(this.cachedPath=this.getPath(t))},e.prototype.drawMarkers=function(t,i){return Mo(this,void 0,void 0,(function(){return Ro(this,(function(r){switch(r.label){case 0:return[4,this.getMarkers(i,t).draw(t.clone({transform:t.pdf.unitMatrix}))];case 1:return r.sent(),[2]}}))}))},e.prototype.fillOrStroke=function(t){return Mo(this,void 0,void 0,(function(){var i,r,s,o,a;return Ro(this,(function(l){switch(l.label){case 0:return t.withinClipPath?[2]:(i=t.attributeState.fill,r=t.attributeState.stroke&&t.attributeState.strokeWidth!==0,i?[4,i.getFillData(this,t)]:[3,2]);case 1:return o=l.sent(),[3,3];case 2:o=void 0,l.label=3;case 3:return s=o,a=t.attributeState.fillRule==="evenodd",i&&r||t.withinUse?a?t.pdf.fillStrokeEvenOdd(s):t.pdf.fillStroke(s):i?a?t.pdf.fillEvenOdd(s):t.pdf.fill(s):r?t.pdf.stroke():t.pdf.discardPath(),[2]}}))}))},e.prototype.getBoundingBoxCore=function(t){var i=this.getCachedPath(t);if(!i||!i.segments.length)return[0,0,0,0];for(var r=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY,l=0,h=0,u=0;u<i.segments.length;u++){var d=i.segments[u];(d instanceof zl||d instanceof fp||d instanceof Zd)&&(l=d.x,h=d.y),d instanceof Zd?(r=Math.min(r,l,d.x1,d.x2,d.x),o=Math.max(o,l,d.x1,d.x2,d.x),s=Math.min(s,h,d.y1,d.y2,d.y),a=Math.max(a,h,d.y1,d.y2,d.y)):(r=Math.min(r,l),o=Math.max(o,l),s=Math.min(s,h),a=Math.max(a,h))}return[r,s,o-r,a-s]},e.prototype.getMarkers=function(t,i){var r=qn(this.element,i.styleSheets,"marker-start"),s=qn(this.element,i.styleSheets,"marker-mid"),o=qn(this.element,i.styleSheets,"marker-end"),a=new i6e;if(r||s||o){o&&(o=fT(o)),r&&(r=fT(r)),s&&(s=fT(s));for(var l=t.segments,h=[1,0],u=void 0,d=!1,A=[1,0],f=!1,p=function(v){var w=l[v],m=r&&(v===1||!(l[v]instanceof zl)&&l[v-1]instanceof zl);m&&l.forEach((function(C,b){if(!f&&C instanceof A6&&b>v){var D=l[b-1];f=(D instanceof zl||D instanceof fp||D instanceof Zd)&&D}}));var y=o&&(v===l.length-1||!(l[v]instanceof zl)&&l[v+1]instanceof zl),x=s&&v>0&&!(v===1&&l[v-1]instanceof zl),S=l[v-1]||null;if(S instanceof zl||S instanceof fp||S instanceof Zd)if(w instanceof Zd)m&&a.addMarker(new Jf(r,[S.x,S.y],$M(f?[f.x,f.y]:[S.x,S.y],[w.x1,w.y1]),!0)),y&&a.addMarker(new Jf(o,[w.x,w.y],$M([w.x2,w.y2],[w.x,w.y]))),x&&(u=J0([S.x,S.y],[w.x1,w.y1]),u=S instanceof zl?u:Ty(db(h,u)),a.addMarker(new Jf(s,[S.x,S.y],Math.atan2(u[1],u[0])))),h=J0([w.x2,w.y2],[w.x,w.y]);else if(w instanceof zl||w instanceof fp){if(u=J0([S.x,S.y],[w.x,w.y]),m){var I=f?J0([f.x,f.y],[w.x,w.y]):u;a.addMarker(new Jf(r,[S.x,S.y],Math.atan2(I[1],I[0]),!0))}y&&a.addMarker(new Jf(o,[w.x,w.y],Math.atan2(u[1],u[0]))),x&&(I=w instanceof zl?h:S instanceof zl?u:Ty(db(h,u)),a.addMarker(new Jf(s,[S.x,S.y],Math.atan2(I[1],I[0])))),h=u}else w instanceof A6&&(u=J0([S.x,S.y],[d.x,d.y]),x&&(I=S instanceof zl?u:Ty(db(h,u)),a.addMarker(new Jf(s,[S.x,S.y],Math.atan2(I[1],I[0])))),y&&(I=Ty(db(u,A)),a.addMarker(new Jf(o,[d.x,d.y],Math.atan2(I[1],I[0])))),h=u);else{d=w instanceof zl&&w;var j=l[v+1];(j instanceof zl||j instanceof fp||j instanceof Zd)&&(A=J0([d.x,d.y],[j.x,j.y]))}},g=0;g<l.length;g++)p(g)}return a.markers.forEach((function(v){var w=i.refsHandler.get(v.id);if(w){var m=qn(w.element,i.styleSheets,"orient");m!=null&&(v.isStartMarker&&m==="auto-start-reverse"&&(v.angle+=Math.PI),isNaN(Number(m))||(v.angle=parseFloat(m)/180*Math.PI))}})),a},e})(nS);function fT(n){var e=l8.exec(n);return e&&e[1]||void 0}var c6e=(function(n){function e(t,i){return n.call(this,!0,t,i)||this}return To(e,n),e.prototype.getPath=function(t){if(t.withinClipPath||t.attributeState.stroke===null)return null;var i=parseFloat(this.element.getAttribute("x1")||"0"),r=parseFloat(this.element.getAttribute("y1")||"0"),s=parseFloat(this.element.getAttribute("x2")||"0"),o=parseFloat(this.element.getAttribute("y2")||"0");return i||s||r||o?new A1().moveTo(i,r).lineTo(s,o):null},e.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},e.prototype.isVisible=function(t,i){return Df(this,t,i)},e.prototype.fillOrStroke=function(t){return Mo(this,void 0,void 0,(function(){return Ro(this,(function(i){switch(i.label){case 0:return t.attributeState.fill=null,[4,n.prototype.fillOrStroke.call(this,t)];case 1:return i.sent(),[2]}}))}))},e})(Ev),SG=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return To(e,n),e.prototype.apply=function(t){return Mo(this,void 0,void 0,(function(){var i,r,s,o,a;return Ro(this,(function(l){switch(l.label){case 0:return this.isVisible(t.attributeState.visibility!=="hidden",t)?((i=t.clone()).transform=i.pdf.unitMatrix,u8(i,this),r=qn(this.element,i.styleSheets,"clip-path"),r&&r!=="none"&&(s=bG(r,0,i))?s.isVisible(!0,i)?[4,CG(this,s,i)]:[3,2]:[3,3]):[2];case 1:return l.sent(),[3,3];case 2:return[2];case 3:d8(i,t,this.element),o=0,a=this.children,l.label=4;case 4:return o<a.length?[4,a[o].render(i)]:[3,7];case 5:l.sent(),l.label=6;case 6:return o++,[3,4];case 7:return[2]}}))}))},e.prototype.getBoundingBoxCore=function(t){return c8(t,this)},e.prototype.isVisible=function(t,i){return eg(this,t,i)},e.prototype.computeNodeTransformCore=function(t){var i=parseFloat(qn(this.element,t.styleSheets,"x")||"0"),r=parseFloat(qn(this.element,t.styleSheets,"y")||"0"),s=this.element.getAttribute("viewBox");if(s){var o=Pu(s),a=parseFloat(qn(this.element,t.styleSheets,"width")||qn(this.element.ownerSVGElement,t.styleSheets,"width")||s[2]),l=parseFloat(qn(this.element,t.styleSheets,"height")||qn(this.element.ownerSVGElement,t.styleSheets,"height")||s[3]);return Tv(this.element,o,i,r,a,l,t)}return t.pdf.Matrix(1,0,0,1,i,r)},e})(Bv),iS=function(n,e){this.width=n,this.height=e},h6e=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return To(e,n),e.prototype.renderCore=function(t){return Mo(this,void 0,void 0,(function(){var i,r,s,o,a,l,h,u,d,A,f,p,g;return Ro(this,(function(v){switch(v.label){case 0:return i=parseFloat,(r=this.element.getAttribute("href")||this.element.getAttribute("xlink:href"))?(s=r.substring(1),o=t.refsHandler.get(s),a=Wp(o.element,"symbol,svg")&&o.element.hasAttribute("viewBox"),l=i(qn(this.element,t.styleSheets,"x")||"0"),h=i(qn(this.element,t.styleSheets,"y")||"0"),u=void 0,d=void 0,a?(u=i(qn(this.element,t.styleSheets,"width")||qn(o.element,t.styleSheets,"width")||"0"),d=i(qn(this.element,t.styleSheets,"height")||qn(o.element,t.styleSheets,"height")||"0"),l+=i(qn(o.element,t.styleSheets,"x")||"0"),h+=i(qn(o.element,t.styleSheets,"y")||"0"),f=Pu(o.element.getAttribute("viewBox")),A=Tv(o.element,f,l,h,u,d,t)):A=t.pdf.Matrix(1,0,0,1,l,h),p=d1.getContextColors(t,!0),g=new Jp(t.pdf,{refsHandler:t.refsHandler,styleSheets:t.styleSheets,withinUse:!0,viewport:a?new iS(u,d):t.viewport,svg2pdfParameters:t.svg2pdfParameters,textMeasure:t.textMeasure,attributeState:Object.assign(d1.default(),p)}),[4,t.refsHandler.getRendered(s,p,(function(w){return e.renderReferencedNode(w,s,g)}))]):[2];case 1:return v.sent(),t.pdf.saveGraphicsState(),t.pdf.setCurrentTransformationMatrix(t.transform),a&&qn(o.element,t.styleSheets,"overflow")!=="visible"&&(t.pdf.rect(l,h,u,d),t.pdf.clip().discardPath()),t.pdf.doFormObject(t.refsHandler.generateKey(s,p),A),t.pdf.restoreGraphicsState(),[2]}}))}))},e.renderReferencedNode=function(t,i,r){return Mo(this,void 0,void 0,(function(){var s;return Ro(this,(function(o){switch(o.label){case 0:return s=[(s=t.getBoundingBox(r))[0]-.5*s[2],s[1]-.5*s[3],2*s[2],2*s[3]],r.pdf.beginFormObject(s[0],s[1],s[2],s[3],r.pdf.unitMatrix),t instanceof SG?[4,t.apply(r)]:[3,2];case 1:return o.sent(),[3,4];case 2:return[4,t.render(r)];case 3:o.sent(),o.label=4;case 4:return r.pdf.endFormObject(r.refsHandler.generateKey(i,r.attributeState)),[2]}}))}))},e.prototype.getBoundingBoxCore=function(t){return Sv(this.element,t)},e.prototype.isVisible=function(t,i){return Df(this,t,i)},e.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},e})(nS),u6e=(function(n){function e(t,i){return n.call(this,!1,t,i)||this}return To(e,n),e.prototype.getPath=function(t){var i=parseFloat(qn(this.element,t.styleSheets,"width")||"0"),r=parseFloat(qn(this.element,t.styleSheets,"height")||"0");if(!isFinite(i)||i<=0||!isFinite(r)||r<=0)return null;var s=qn(this.element,t.styleSheets,"rx"),o=qn(this.element,t.styleSheets,"ry"),a=Math.min(parseFloat(s||o||"0"),.5*i),l=Math.min(parseFloat(o||s||"0"),.5*r),h=parseFloat(qn(this.element,t.styleSheets,"x")||"0"),u=parseFloat(qn(this.element,t.styleSheets,"y")||"0"),d=4/3*(Math.SQRT2-1);return a===0&&l===0?new A1().moveTo(h,u).lineTo(h+i,u).lineTo(h+i,u+r).lineTo(h,u+r).close():new A1().moveTo(h+=a,u).lineTo(h+=i-2*a,u).curveTo(h+a*d,u,h+a,u+(l-l*d),h+=a,u+=l).lineTo(h,u+=r-2*l).curveTo(h,u+l*d,h-a*d,u+l,h-=a,u+=l).lineTo(h+=2*a-i,u).curveTo(h-a*d,u,h-a,u-l*d,h-=a,u-=l).lineTo(h,u+=2*l-r).curveTo(h,u-l*d,h+a*d,u-l,h+=a,u-=l).close()},e.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},e.prototype.isVisible=function(t,i){return Df(this,t,i)},e})(Ev),TG=(function(n){function e(t,i){return n.call(this,!1,t,i)||this}return To(e,n),e.prototype.getPath=function(t){var i=this.getRx(t),r=this.getRy(t);if(!isFinite(i)||r<=0||!isFinite(r)||r<=0)return null;var s=parseFloat(qn(this.element,t.styleSheets,"cx")||"0"),o=parseFloat(qn(this.element,t.styleSheets,"cy")||"0"),a=4/3*(Math.SQRT2-1)*i,l=4/3*(Math.SQRT2-1)*r;return new A1().moveTo(s+i,o).curveTo(s+i,o-l,s+a,o-r,s,o-r).curveTo(s-a,o-r,s-i,o-l,s-i,o).curveTo(s-i,o+l,s-a,o+r,s,o+r).curveTo(s+a,o+r,s+i,o+l,s+i,o)},e.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},e.prototype.isVisible=function(t,i){return Df(this,t,i)},e})(Ev),d6e=(function(n){function e(t,i){return n.call(this,t,i)||this}return To(e,n),e.prototype.getRx=function(t){return parseFloat(qn(this.element,t.styleSheets,"rx")||"0")},e.prototype.getRy=function(t){return parseFloat(qn(this.element,t.styleSheets,"ry")||"0")},e})(TG);function BG(n){var e="invisible",t=n.stroke&&n.strokeWidth!==0,i=n.fill;return i&&t?e="fillThenStroke":i?e="fill":t&&(e="stroke"),e}function YM(n){return n.replace(/[\n\r]/g,"")}function KM(n){return n.replace(/[\t]/g," ")}function qM(n){return n.replace(/ +/g," ")}function ZM(n,e,t){switch(qn(n,t.styleSheets,"text-transform")){case"uppercase":return e.toUpperCase();case"lowercase":return e.toLowerCase();default:return e}}var pT=(function(){function n(e,t,i,r){this.textNode=e,this.texts=[],this.textNodes=[],this.contexts=[],this.textAnchor=t,this.originX=i,this.originY=r,this.textMeasures=[]}return n.prototype.setX=function(e){this.originX=e},n.prototype.setY=function(e){this.originY=e},n.prototype.add=function(e,t,i){this.texts.push(t),this.textNodes.push(e),this.contexts.push(i)},n.prototype.rightTrimText=function(){for(var e=this.texts.length-1;e>=0;e--)if(this.contexts[e].attributeState.xmlSpace==="default"&&(this.texts[e]=this.texts[e].replace(/\s+$/,"")),this.texts[e].match(/[^\s]/))return!1;return!0},n.prototype.measureText=function(e){for(var t=0;t<this.texts.length;t++)this.textMeasures.push({width:e.textMeasure.measureTextWidth(this.texts[t],this.contexts[t].attributeState),length:this.texts[t].length})},n.prototype.put=function(e,t){var i,r,s,o,a=[],l=[],h=[],u=this.originX,d=this.originY,A=u,f=u;for(i=0;i<this.textNodes.length;i++){r=this.textNodes[i],s=this.contexts[i],o=this.textMeasures[i]||{width:e.textMeasure.measureTextWidth(this.texts[i],this.contexts[i].attributeState),length:this.texts[i].length};var p=u,g=d;if(r.nodeName!=="#text"&&!a.includes(r)){a.push(r);var v=n.resolveRelativePositionAttribute(r,"dx");v!==null&&(p+=ef(v,s.attributeState.fontSize));var w=n.resolveRelativePositionAttribute(r,"dy");w!==null&&(g+=ef(w,s.attributeState.fontSize))}l[i]=p,h[i]=g,u=p+o.width+o.length*t,d=g,A=Math.min(A,p),f=Math.max(f,u)}var m=0;switch(this.textAnchor){case"start":m=0;break;case"middle":m=(f-A)/2;break;case"end":m=f-A}for(i=0;i<this.textNodes.length;i++)if(r=this.textNodes[i],s=this.contexts[i],r.nodeName==="#text"||s.attributeState.visibility!=="hidden"){e.pdf.saveGraphicsState(),d8(s,e,r);var y=s.attributeState.alignmentBaseline,x=BG(s.attributeState);e.pdf.text(this.texts[i],l[i]-m,h[i],{baseline:gG(y),angle:e.transform,renderingMode:x==="fill"?void 0:x,charSpace:t===0?void 0:t}),e.pdf.restoreGraphicsState()}return[u,d]},n.resolveRelativePositionAttribute=function(e,t){for(var i,r=e;r&&Wp(r,"tspan");){if(r.hasAttribute(t))return r.getAttribute(t);if(((i=e.parentElement)===null||i===void 0?void 0:i.firstChild)!==e)break;r=r.parentElement}return null},n})(),A6e=(function(n){function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.boundingBox=[],t}return To(e,n),e.prototype.processTSpans=function(t,i,r,s,o,a){for(var l=r.pdf.getFontSize(),h=r.attributeState.xmlSpace,u=!0,d=!1,A=0;A<i.childNodes.length;A++){var f=i.childNodes[A];if(f.textContent){var p=f.textContent;if(f.nodeName==="#text"){var g=YM(p);g=KM(g),h==="default"&&(g=qM(g),u&&g.match(/^\s/)&&(d=!0),g.match(/[^\s]/)&&(u=!1),a.prevText.match(/\s$/)&&(g=g.replace(/^\s+/,"")));var v=ZM(i,g,r);o.add(i,v,r),a.prevText=p,a.prevContext=r}else if(!Wp(f,"title")){if(Wp(f,"tspan")){var w=f,m=w.getAttribute("x");if(m!==null){var y=ef(m,l);o=new pT(this,qn(w,r.styleSheets,"text-anchor")||r.attributeState.textAnchor,y,0),s.push({type:"y",chunk:o})}var x=w.getAttribute("y");if(x!==null){var S=ef(x,l);o=new pT(this,qn(w,r.styleSheets,"text-anchor")||r.attributeState.textAnchor,0,S),s.push({type:"x",chunk:o})}var I=r.clone();u8(I,t,w),this.processTSpans(t,w,I,s,o,a)}}}}return d},e.prototype.renderCore=function(t){return Mo(this,void 0,void 0,(function(){var i,r,s,o,a,l,h,u,d,A,f,p,g,v,w,m,y,x,S,I,j,C,b;return Ro(this,(function(D){if(t.pdf.saveGraphicsState(),i=0,r=0,s=1,o=t.pdf.getFontSize(),a=ef(this.element.getAttribute("x"),o),l=ef(this.element.getAttribute("y"),o),h=ef(this.element.getAttribute("dx"),o),u=ef(this.element.getAttribute("dy"),o),d=parseFloat(this.element.getAttribute("textLength")||"0"),A=t.attributeState.visibility,this.element.childElementCount===0)f=this.element.textContent||"",p=(function(T,k){return T=KM(T=YM(T)),k.xmlSpace==="default"&&(T=qM(T=T.trim())),T})(f,t.attributeState),g=ZM(this.element,p,t),i=t.textMeasure.getTextOffset(g,t.attributeState),d>0&&(v=t.textMeasure.measureTextWidth(g,t.attributeState),t.attributeState.xmlSpace==="default"&&f.match(/^\s/)&&(s=0),r=(d-v)/(g.length-s)||0),A==="visible"&&(w=t.attributeState.alignmentBaseline,m=BG(t.attributeState),t.pdf.text(g,a+h-i,l+u,{baseline:gG(w),angle:t.transform,renderingMode:m==="fill"?void 0:m,charSpace:r===0?void 0:r}),this.boundingBox=[a+h-i,l+u+.1*o,t.textMeasure.measureTextWidth(g,t.attributeState),o]);else{for(y=[],x=new pT(this,t.attributeState.textAnchor,a+h,l+u),y.push({type:"",chunk:x}),S=this.processTSpans(this,this.element,t,y,x,{prevText:" ",prevContext:t}),s=S?0:1,I=!0,j=y.length-1;j>=0;j--)I&&(I=y[j].chunk.rightTrimText());d>0&&(C=0,b=0,y.forEach((function(T){var k=T.chunk;k.measureText(t),k.textMeasures.forEach((function(B){var E=B.width,z=B.length;C+=E,b+=z}))})),r=(d-C)/(b-s)),y.reduce((function(T,k){var B=k.type,E=k.chunk;return B==="x"?E.setX(T[0]):B==="y"&&E.setY(T[1]),E.put(t,r)}),[0,0])}return t.pdf.restoreGraphicsState(),[2]}))}))},e.prototype.isVisible=function(t,i){return eg(this,t,i)},e.prototype.getBoundingBoxCore=function(t){return this.boundingBox.length>0?this.boundingBox:Sv(this.element,t)},e.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},e})(nS),f6e=(function(n){function e(t,i){return n.call(this,!0,t,i)||this}return To(e,n),e.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},e.prototype.isVisible=function(t,i){return Df(this,t,i)},e.prototype.getPath=function(t){var i,r,s=new t6e(qn(this.element,t.styleSheets,"d")||"").unshort().unarc().abs(),o=new A1;return s.iterate((function(a){switch(a[0]){case"M":o.moveTo(a[1],a[2]);break;case"L":o.lineTo(a[1],a[2]);break;case"H":o.lineTo(a[1],r);break;case"V":o.lineTo(i,a[1]);break;case"C":o.curveTo(a[1],a[2],a[3],a[4],a[5],a[6]);break;case"Q":var l=GM([i,r],[a[1],a[2]]),h=GM([a[3],a[4]],[a[1],a[2]]);o.curveTo(l[0],l[1],h[0],h[1],a[3],a[4]);break;case"Z":o.close()}switch(a[0]){case"M":case"L":i=a[1],r=a[2];break;case"H":i=a[1];break;case"V":r=a[1];break;case"C":i=a[5],r=a[6];break;case"Q":i=a[3],r=a[4]}})),o},e})(Ev),p6e=/^\s*data:(([^/,;]+\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,((?:.|\s)*)$/i,g6e=(function(n){function e(t,i){var r=n.call(this,t,i)||this;return r.imageLoadingPromise=null,r.imageUrl=r.element.getAttribute("xlink:href")||r.element.getAttribute("href"),r.imageUrl&&(r.imageLoadingPromise=e.fetchImageData(r.imageUrl)),r}return To(e,n),e.prototype.renderCore=function(t){return Mo(this,void 0,void 0,(function(){var i,r,s,o,a,l,h,u,d,A,f,p,g,v,w,m,y,x;return Ro(this,(function(S){switch(S.label){case 0:return this.imageLoadingPromise?(t.pdf.setCurrentTransformationMatrix(t.transform),i=parseFloat(qn(this.element,t.styleSheets,"width")||"0"),r=parseFloat(qn(this.element,t.styleSheets,"height")||"0"),s=parseFloat(qn(this.element,t.styleSheets,"x")||"0"),o=parseFloat(qn(this.element,t.styleSheets,"y")||"0"),!isFinite(i)||i<=0||!isFinite(r)||r<=0?[2]:[4,this.imageLoadingPromise]):[2];case 1:return a=S.sent(),l=a.data,(h=a.format).indexOf("svg")!==0?[3,3]:(u=new DOMParser,d=u.parseFromString(l,"image/svg+xml").firstElementChild,(!(A=this.element.getAttribute("preserveAspectRatio"))||A.indexOf("defer")<0||!d.getAttribute("preserveAspectRatio"))&&d.setAttribute("preserveAspectRatio",A||""),d.setAttribute("x",String(s)),d.setAttribute("y",String(o)),d.setAttribute("width",String(i)),d.setAttribute("height",String(r)),[4,A8(d,f={}).render(new Jp(t.pdf,{refsHandler:new pG(f),styleSheets:t.styleSheets,viewport:new iS(i,r),svg2pdfParameters:t.svg2pdfParameters,textMeasure:t.textMeasure}))]);case 2:return S.sent(),[2];case 3:p="data:image/".concat(h,";base64,").concat(btoa(l)),S.label=4;case 4:return S.trys.push([4,6,,7]),[4,e.getImageDimensions(p)];case 5:return g=S.sent(),v=g[0],w=g[1],m=[0,0,v,w],y=Tv(this.element,m,s,o,i,r,t),t.pdf.setCurrentTransformationMatrix(y),t.pdf.addImage(p,"",0,0,v,w),[3,7];case 6:return x=S.sent(),typeof console=="object"&&console.warn&&console.warn("Could not load image ".concat(this.imageUrl,`. 
`).concat(x)),[3,7];case 7:return[2]}}))}))},e.prototype.getBoundingBoxCore=function(t){return Sv(this.element,t)},e.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},e.prototype.isVisible=function(t,i){return Df(this,t,i)},e.fetchImageData=function(t){return Mo(this,void 0,void 0,(function(){var i,r,s,o,a;return Ro(this,(function(l){switch(l.label){case 0:if(!(s=t.match(p6e)))return[3,1];if(o=s[2],(a=o.split("/"))[0]!=="image")throw new Error("Unsupported image URL: ".concat(t));return r=a[1],i=s[5],s[4]==="base64"?(i=i.replace(/\s/g,""),i=atob(i)):i=decodeURIComponent(i),[3,3];case 1:return[4,e.fetchImage(t)];case 2:i=l.sent(),r=t.substring(t.lastIndexOf(".")+1),l.label=3;case 3:return[2,{data:i,format:r}]}}))}))},e.fetchImage=function(t){return new Promise((function(i,r){var s=new XMLHttpRequest;s.open("GET",t,!0),s.responseType="arraybuffer",s.onload=function(){if(s.status!==200)throw new Error("Error ".concat(s.status,": Failed to load image '").concat(t,"'"));for(var o=new Uint8Array(s.response),a="",l=0;l<o.length;l++)a+=String.fromCharCode(o[l]);i(a)},s.onerror=r,s.onabort=r,s.send(null)}))},e.getMimeType=function(t){switch(t=t.toLowerCase()){case"jpg":case"jpeg":return"image/jpeg";default:return"image/".concat(t)}},e.getImageDimensions=function(t){return new Promise((function(i,r){var s=new Image;s.onload=function(){i([s.width,s.height])},s.onerror=r,s.src=t}))},e})(nS),EG=(function(n){function e(t,i,r){var s=n.call(this,!0,i,r)||this;return s.closed=t,s}return To(e,n),e.prototype.getPath=function(t){if(!this.element.hasAttribute("points")||this.element.getAttribute("points")==="")return null;var i=e.parsePointsString(this.element.getAttribute("points")),r=new A1;if(i.length<1)return r;r.moveTo(i[0][0],i[0][1]);for(var s=1;s<i.length;s++)r.lineTo(i[s][0],i[s][1]);return this.closed&&r.close(),r},e.prototype.isVisible=function(t,i){return Df(this,t,i)},e.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},e.parsePointsString=function(t){for(var i=Pu(t),r=[],s=0;s<i.length-1;s+=2){var o=i[s],a=i[s+1];r.push([o,a])}return r},e})(Ev),m6e=(function(n){function e(t,i){return n.call(this,!0,t,i)||this}return To(e,n),e})(EG),y6e=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return To(e,n),e.prototype.render=function(t){return Promise.resolve()},e.prototype.getBoundingBoxCore=function(t){return[0,0,0,0]},e.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},e.prototype.isVisible=function(t,i){return Df(this,t,i)},e})(h8),w6e=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return To(e,n),e.prototype.apply=function(t){return Mo(this,void 0,void 0,(function(){var i,r,s,o,a,l;return Ro(this,(function(h){switch(h.label){case 0:i=this.computeNodeTransform(t),r=this.getBoundingBox(t),t.pdf.beginFormObject(r[0],r[1],r[2],r[3],i),s=d1.getContextColors(t),(function(u){var d=u.attributeState,A=u.pdf,f=1,p=1;f*=d.fillOpacity,f*=d.opacity,d.fill instanceof wc&&d.fill.color.a!==void 0&&(f*=d.fill.color.a),p*=d.strokeOpacity,p*=d.opacity,d.stroke instanceof wc&&d.stroke.color.a!==void 0&&(p*=d.stroke.color.a);var g,v={};if(v.opacity=f,v["stroke-opacity"]=p,A.setGState(new l0(v)),d.fill&&d.fill instanceof wc&&d.fill.color.ok?A.setFillColor(d.fill.color.r,d.fill.color.g,d.fill.color.b):A.setFillColor(0,0,0),A.setLineWidth(d.strokeWidth),d.stroke instanceof wc?A.setDrawColor(d.stroke.color.r,d.stroke.color.g,d.stroke.color.b):A.setDrawColor(0,0,0),A.setLineCap(d.strokeLinecap),A.setLineJoin(d.strokeLinejoin),d.strokeDasharray?A.setLineDashPattern(d.strokeDasharray,d.strokeDashoffset):A.setLineDashPattern([],0),A.setLineMiterLimit(d.strokeMiterlimit),g=cf.hasOwnProperty(d.fontFamily)?cf[d.fontFamily]:d.fontFamily,d.fill&&d.fill instanceof wc&&d.fill.color.ok){var w=d.fill.color;A.setTextColor(w.r,w.g,w.b)}else A.setTextColor(0,0,0);var m="";d.fontWeight==="bold"&&(m="bold"),d.fontStyle==="italic"&&(m+="italic"),m===""&&(m="normal"),g!==void 0||m!==void 0?(g===void 0&&(g=cf.hasOwnProperty(d.fontFamily)?cf[d.fontFamily]:d.fontFamily),A.setFont(g,m)):A.setFont("helvetica",m),A.setFontSize(d.fontSize*A.internal.scaleFactor)})(o=new Jp(t.pdf,{refsHandler:t.refsHandler,styleSheets:t.styleSheets,viewport:t.viewport,svg2pdfParameters:t.svg2pdfParameters,textMeasure:t.textMeasure,attributeState:Object.assign(d1.default(),s)})),a=0,l=this.children,h.label=1;case 1:return a<l.length?[4,l[a].render(o)]:[3,4];case 2:h.sent(),h.label=3;case 3:return a++,[3,1];case 4:return t.pdf.endFormObject(o.refsHandler.generateKey(this.element.getAttribute("id"),s)),[2]}}))}))},e.prototype.getBoundingBoxCore=function(t){var i,r=this.element.getAttribute("viewBox");return r&&(i=Pu(r)),[i&&i[0]||0,i&&i[1]||0,i&&i[2]||parseFloat(this.element.getAttribute("markerWidth")||"3"),i&&i[3]||parseFloat(this.element.getAttribute("markerHeight")||"3")]},e.prototype.computeNodeTransformCore=function(t){var i,r=parseFloat(this.element.getAttribute("refX")||"0"),s=parseFloat(this.element.getAttribute("refY")||"0"),o=this.element.getAttribute("viewBox");if(o){var a=Pu(o);i=Tv(this.element,a,0,0,parseFloat(this.element.getAttribute("markerWidth")||"3"),parseFloat(this.element.getAttribute("markerHeight")||"3"),t,!0),i=t.pdf.matrixMult(t.pdf.Matrix(1,0,0,1,-r,-s),i)}else i=t.pdf.Matrix(1,0,0,1,-r,-s);return i},e.prototype.isVisible=function(t,i){return eg(this,t,i)},e})(Bv),v6e=(function(n){function e(t,i){return n.call(this,t,i)||this}return To(e,n),e.prototype.getR=function(t){var i;return(i=this.r)!==null&&i!==void 0?i:this.r=parseFloat(qn(this.element,t.styleSheets,"r")||"0")},e.prototype.getRx=function(t){return this.getR(t)},e.prototype.getRy=function(t){return this.getR(t)},e})(TG),x6e=(function(n){function e(t,i){return n.call(this,!1,t,i)||this}return To(e,n),e})(EG),FG=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return To(e,n),e.prototype.renderCore=function(t){return Mo(this,void 0,void 0,(function(){var i,r;return Ro(this,(function(s){switch(s.label){case 0:i=0,r=this.children,s.label=1;case 1:return i<r.length?[4,r[i].render(t)]:[3,4];case 2:s.sent(),s.label=3;case 3:return i++,[3,1];case 4:return[2]}}))}))},e.prototype.getBoundingBoxCore=function(t){return c8(t,this)},e})(_G),b6e=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return To(e,n),e.prototype.isVisible=function(t,i){return eg(this,t,i)},e.prototype.render=function(t){return Mo(this,void 0,void 0,(function(){var i,r,s,o,a;return Ro(this,(function(l){switch(l.label){case 0:return this.isVisible(t.attributeState.visibility!=="hidden",t)?(i=this.getX(t),r=this.getY(t),s=this.getWidth(t),o=this.getHeight(t),t.pdf.saveGraphicsState(),a=t.transform,this.element.hasAttribute("transform")&&(a=t.pdf.matrixMult(tS(this.element.getAttribute("transform"),t),a)),t.pdf.setCurrentTransformationMatrix(a),t.withinUse||qn(this.element,t.styleSheets,"overflow")==="visible"||t.pdf.rect(i,r,s,o).clip().discardPath(),[4,n.prototype.render.call(this,t.clone({transform:t.pdf.unitMatrix,viewport:t.withinUse?t.viewport:new iS(s,o)}))]):[2];case 1:return l.sent(),t.pdf.restoreGraphicsState(),[2]}}))}))},e.prototype.computeNodeTransform=function(t){return this.computeNodeTransformCore(t)},e.prototype.computeNodeTransformCore=function(t){if(t.withinUse)return t.pdf.unitMatrix;var i,r=this.getX(t),s=this.getY(t),o=this.getViewBox();if(o){var a=this.getWidth(t),l=this.getHeight(t);i=Tv(this.element,o,r,s,a,l,t)}else i=t.pdf.Matrix(1,0,0,1,r,s);return i},e.prototype.getWidth=function(t){if(this.width!==void 0)return this.width;var i,r,s=t.svg2pdfParameters;if(this.isOutermostSvg(t))if(s.width!=null)i=s.width;else if(r=qn(this.element,t.styleSheets,"width"))i=parseFloat(r);else{var o=this.getViewBox();if(o&&(s.height!=null||qn(this.element,t.styleSheets,"height"))){var a=o[2]/o[3];i=this.getHeight(t)*a}else i=Math.min(300,t.viewport.width,2*t.viewport.height)}else i=(r=qn(this.element,t.styleSheets,"width"))?parseFloat(r):t.viewport.width;return this.width=i},e.prototype.getHeight=function(t){if(this.height!==void 0)return this.height;var i,r,s=t.svg2pdfParameters;if(this.isOutermostSvg(t))if(s.height!=null)i=s.height;else if(r=qn(this.element,t.styleSheets,"height"))i=parseFloat(r);else{var o=this.getViewBox();if(o){var a=o[2]/o[3];i=this.getWidth(t)/a}else i=Math.min(150,t.viewport.width/2,t.viewport.height)}else i=(r=qn(this.element,t.styleSheets,"height"))?parseFloat(r):t.viewport.height;return this.height=i},e.prototype.getX=function(t){if(this.x!==void 0)return this.x;if(this.isOutermostSvg(t))return this.x=0;var i=qn(this.element,t.styleSheets,"x");return this.x=i?parseFloat(i):0},e.prototype.getY=function(t){if(this.y!==void 0)return this.y;if(this.isOutermostSvg(t))return this.y=0;var i=qn(this.element,t.styleSheets,"y");return this.y=i?parseFloat(i):0},e.prototype.getViewBox=function(){if(this.viewBox!==void 0)return this.viewBox;var t=this.element.getAttribute("viewBox");return this.viewBox=t?Pu(t):void 0},e.prototype.isOutermostSvg=function(t){return t.svg2pdfParameters.element===this.element},e})(FG),kG=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return To(e,n),e.prototype.isVisible=function(t,i){return eg(this,t,i)},e.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},e})(FG),C6e=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return To(e,n),e.prototype.renderCore=function(t){return Mo(this,void 0,void 0,(function(){var i,r,s,o;return Ro(this,(function(a){switch(a.label){case 0:return[4,n.prototype.renderCore.call(this,t)];case 1:return a.sent(),(i=qn(this.element,t.styleSheets,"href"))&&(r=this.getBoundingBox(t),s=t.pdf.internal.scaleFactor,o=t.pdf.internal.pageSize.getHeight(),t.pdf.link(s*(r[0]*t.transform.sx+t.transform.tx),o-s*(r[1]*t.transform.sy+t.transform.ty),s*r[2],s*r[3],{url:i})),[2]}}))}))},e})(kG),_6e=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return To(e,n),e.prototype.apply=function(t){return Mo(this,void 0,void 0,(function(){var i,r,s,o,a;return Ro(this,(function(l){switch(l.label){case 0:if(!this.isVisible(!0,t))return[2];i=t.pdf.matrixMult(this.computeNodeTransform(t),t.transform),t.pdf.setCurrentTransformationMatrix(i),r=0,s=this.children,l.label=1;case 1:return r<s.length?[4,s[r].render(new Jp(t.pdf,{refsHandler:t.refsHandler,styleSheets:t.styleSheets,viewport:t.viewport,withinClipPath:!0,svg2pdfParameters:t.svg2pdfParameters,textMeasure:t.textMeasure}))]:[3,4];case 2:l.sent(),l.label=3;case 3:return r++,[3,1];case 4:return o=this.children.length>0&&!!qn(this.children[0].element,t.styleSheets,"clip-rule"),a=o?this.getClipRuleAttr(this.children[0].element,t.styleSheets):this.getClipRuleAttr(this.element,t.styleSheets),t.pdf.clip(a).discardPath(),t.pdf.setCurrentTransformationMatrix(i.inversed()),[2]}}))}))},e.prototype.getBoundingBoxCore=function(t){return c8(t,this)},e.prototype.isVisible=function(t,i){return eg(this,t,i)},e.prototype.getClipRuleAttr=function(t,i){return qn(t,i,"clip-rule")==="evenodd"?"evenodd":void 0},e})(Bv);function A8(n,e){var t,i=[];switch((function(s,o){for(var a=[],l=0;l<s.childNodes.length;l++){var h=s.childNodes[l];h.nodeName.charAt(0)!=="#"&&a.push(h)}for(l=0;l<a.length;l++)o(l,a[l])})(n,(function(s,o){return i.push(A8(o,e))})),n.tagName.toLowerCase()){case"a":t=new C6e(n,i);break;case"g":t=new kG(n,i);break;case"circle":t=new v6e(n,i);break;case"clippath":t=new _6e(n,i);break;case"ellipse":t=new d6e(n,i);break;case"lineargradient":t=new wG(n,i);break;case"image":t=new g6e(n,i);break;case"line":t=new c6e(n,i);break;case"marker":t=new w6e(n,i);break;case"path":t=new f6e(n,i);break;case"pattern":t=new xG(n,i);break;case"polygon":t=new m6e(n,i);break;case"polyline":t=new x6e(n,i);break;case"radialgradient":t=new vG(n,i);break;case"rect":t=new u6e(n,i);break;case"svg":t=new b6e(n,i);break;case"symbol":t=new SG(n,i);break;case"text":t=new A6e(n,i);break;case"use":t=new h6e(n,i);break;default:t=new y6e(n,i)}if(e!=null&&t.element.hasAttribute("id")){var r=AG(t.element.id,{isIdentifier:!0});e[r]=e[r]||t}return t.children.forEach((function(s){return s.setParent(t)})),t}var S6e=(function(){function n(e,t){this.rootSvg=e,this.loadExternalSheets=t,this.styleSheets=[]}return n.prototype.load=function(){return Mo(this,void 0,void 0,(function(){var e;return Ro(this,(function(t){switch(t.label){case 0:return[4,this.collectStyleSheetTexts()];case 1:return e=t.sent(),this.parseCssSheets(e),[2]}}))}))},n.prototype.collectStyleSheetTexts=function(){return Mo(this,void 0,void 0,(function(){var e,t,i,r,s;return Ro(this,(function(o){switch(o.label){case 0:if(e=[],this.loadExternalSheets&&this.rootSvg.ownerDocument)for(r=0;r<this.rootSvg.ownerDocument.childNodes.length;r++)(t=this.rootSvg.ownerDocument.childNodes[r]).nodeName==="xml-stylesheet"&&typeof t.data=="string"&&e.push(n.loadSheet(t.data.match(/href=["'].*?["']/)[0].split("=")[1].slice(1,-1)));for(i=this.rootSvg.querySelectorAll("style,link"),r=0;r<i.length;r++)Wp(s=i[r],"style")?e.push(s.textContent):this.loadExternalSheets&&Wp(s,"link")&&s.getAttribute("rel")==="stylesheet"&&s.hasAttribute("href")&&e.push(n.loadSheet(s.getAttribute("href")));return[4,Promise.all(e)];case 1:return[2,o.sent().filter((function(a){return a!==null}))]}}))}))},n.prototype.parseCssSheets=function(e){for(var t=document.implementation.createHTMLDocument(""),i=0,r=e;i<r.length;i++){var s=r[i],o=t.createElement("style");o.textContent=s,t.body.appendChild(o);var a=o.sheet;if(a instanceof CSSStyleSheet){for(var l=a.cssRules.length-1;l>=0;l--){var h=a.cssRules[l];if(h instanceof CSSStyleRule){var u=h;if(u.selectorText.indexOf(",")>=0){a.deleteRule(l);for(var d=u.cssText.substring(u.selectorText.length),A=n.splitSelectorAtCommas(u.selectorText),f=0;f<A.length;f++)a.insertRule(A[f]+d,l+f)}}else a.deleteRule(l)}this.styleSheets.push(a)}}},n.splitSelectorAtCommas=function(e){for(var t,i=/,|["']/g,r=/[^\\]["]/g,s=/[^\\][']/g,o=[],a="initial",l=-1,h=r,u=0;u<e.length;)switch(a){case"initial":i.lastIndex=u,(t=i.exec(e))?(t[0]===","?(o.push(e.substring(l+1,i.lastIndex-1).trim()),l=i.lastIndex-1):(a="withinQuotes",h=t[0]==='"'?r:s),u=i.lastIndex):(o.push(e.substring(l+1).trim()),u=e.length);break;case"withinQuotes":h.lastIndex=u,(t=h.exec(e))&&(u=h.lastIndex,a="initial")}return o},n.loadSheet=function(e){return new Promise((function(t,i){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="text",r.onload=function(){r.status!==200&&i(new Error("Error ".concat(r.status,": Failed to load '").concat(e,"'"))),t(r.responseText)},r.onerror=i,r.onabort=i,r.send(null)})).catch((function(){return null}))},n.prototype.getPropertyValue=function(e,t){for(var i=[],r=0,s=this.styleSheets;r<s.length;r++)for(var o=s[r],a=0;a<o.cssRules.length;a++){var l=o.cssRules[a];l.style.getPropertyValue(t)&&e.matches(l.selectorText)&&i.push(l)}if(i.length!==0)return i.reduce((function(h,u){return A=u,((f=(d=h).style.getPropertyPriority(t))!==A.style.getPropertyPriority(t)?f==="important"?1:-1:n6e(d.selectorText,A.selectorText))===1?h:u;var d,A,f})).style.getPropertyValue(t)||void 0},n})(),T6e=(function(){function n(){this.measureMethods={}}return n.prototype.getTextOffset=function(e,t){var i=t.textAnchor;if(i==="start")return 0;var r=this.measureTextWidth(e,t),s=0;switch(i){case"end":s=r;break;case"middle":s=r/2}return s},n.prototype.measureTextWidth=function(e,t){if(e.length===0)return 0;var i=t.fontFamily;return this.getMeasureFunction(i).call(this,e,t.fontFamily,t.fontSize+"px",t.fontStyle,t.fontWeight)},n.prototype.getMeasurementTextNode=function(){if(!this.textMeasuringTextElement){this.textMeasuringTextElement=document.createElementNS(XM,"text");var e=document.createElementNS(XM,"svg");e.appendChild(this.textMeasuringTextElement),e.style.setProperty("position","absolute"),e.style.setProperty("visibility","hidden"),document.body.appendChild(e)}return this.textMeasuringTextElement},n.prototype.canvasTextMeasure=function(e,t,i,r,s){var o=document.createElement("canvas").getContext("2d");return o!=null?(o.font=[r,s,i,t].join(" "),o.measureText(e).width):0},n.prototype.svgTextMeasure=function(e,t,i,r,s,o){o===void 0&&(o=this.getMeasurementTextNode());var a=o;return a.setAttribute("font-family",t),a.setAttribute("font-size",i),a.setAttribute("font-style",r),a.setAttribute("font-weight",s),a.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),a.textContent=e,a.getBBox().width},n.prototype.getMeasureFunction=function(e){var t=this.measureMethods[e];if(!t){var i="16px",r="normal",s="normal",o=this.canvasTextMeasure(n.testString,e,i,r,s),a=this.svgTextMeasure(n.testString,e,i,r,s);t=Math.abs(o-a)<n.epsilon?this.canvasTextMeasure:this.svgTextMeasure,this.measureMethods[e]=t}return t},n.prototype.cleanupTextMeasuring=function(){if(this.textMeasuringTextElement){var e=this.textMeasuringTextElement.parentNode;e&&document.body.removeChild(e),this.textMeasuringTextElement=void 0}},n.testString=`abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789!"$%&/()=?'\\+*-_.:,;^}][{#~|<>`,n.epsilon=.1,n})();function B6e(n,e){return Mo(this,arguments,void 0,(function(t,i,r){var s,o,a,l,h,u,d,A,f,p,g,v,w,m;return r===void 0&&(r={}),Ro(this,(function(y){switch(y.label){case 0:return s=(v=r.x)!==null&&v!==void 0?v:0,o=(w=r.y)!==null&&w!==void 0?w:0,a=(m=r.loadExternalStyleSheets)!==null&&m!==void 0&&m,h=new pG(l={}),[4,(u=new S6e(t,a)).load()];case 1:return y.sent(),d=new iS(i.internal.pageSize.getWidth(),i.internal.pageSize.getHeight()),A=T_(T_({},r),{element:t}),f=new T6e,p=new Jp(i,{refsHandler:h,styleSheets:u,viewport:d,svg2pdfParameters:A,textMeasure:f}),i.advancedAPI(),i.saveGraphicsState(),i.setCurrentTransformationMatrix(i.Matrix(1,0,0,1,s,o)),i.setLineWidth(p.attributeState.strokeWidth),g=p.attributeState.fill.color,i.setFillColor(g.r,g.g,g.b),i.setFont(p.attributeState.fontFamily),i.setFontSize(p.attributeState.fontSize*i.internal.scaleFactor),[4,A8(t,l).render(p)];case 2:return y.sent(),i.restoreGraphicsState(),i.compatAPI(),p.textMeasure.cleanupTextMeasuring(),[2,i]}}))}))}qi.API.svg=function(n,e){return e===void 0&&(e={}),B6e(n,this,e)};function St(n,e,t){return(e=(function(i){var r=(function(s,o){if(typeof s!="object"||!s)return s;var a=s[Symbol.toPrimitive];if(a!==void 0){var l=a.call(s,o);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(s)})(i,"string");return typeof r=="symbol"?r:r+""})(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function JM(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable}))),t.push.apply(t,i)}return t}function Ct(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?JM(Object(t),!0).forEach((function(i){St(n,i,t[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):JM(Object(t)).forEach((function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))}))}return n}function ca(n,e){if(n==null)return{};var t,i,r=(function(o,a){if(o==null)return{};var l={};for(var h in o)if({}.hasOwnProperty.call(o,h)){if(a.indexOf(h)>=0)continue;l[h]=o[h]}return l})(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(i=0;i<s.length;i++)t=s[i],e.indexOf(t)>=0||{}.propertyIsEnumerable.call(n,t)&&(r[t]=n[t])}return r}function SA(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}class e7{constructor(){St(this,"browserShadowBlurConstant",1),St(this,"DPI",96),St(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),St(this,"perfLimitSizeTotal",2097152),St(this,"maxCacheSideLimit",4096),St(this,"minCacheSideLimit",256),St(this,"disableStyleCopyPaste",!1),St(this,"enableGLFiltering",!0),St(this,"textureSize",4096),St(this,"forceGLPutImageData",!1),St(this,"cachesBoundsOfCurve",!1),St(this,"fontPaths",{}),St(this,"NUM_FRACTION_DIGITS",4)}}const Ys=new class extends e7{constructor(n){super(),this.configure(n)}configure(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,n)}addFonts(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=Ct(Ct({},this.fontPaths),n)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach((n=>{delete this.fontPaths[n]}))}clearFonts(){this.fontPaths={}}restoreDefaults(n){const e=new e7,t=(n==null?void 0:n.reduce(((i,r)=>(i[r]=e[r],i)),{}))||e;this.configure(t)}},Sf=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];return console[n]("fabric",...t)};class rA extends Error{constructor(e,t){super("fabric: ".concat(e),t)}}class f8 extends rA{constructor(e){super("".concat(e," 'options.signal' is in 'aborted' state"))}}class E6e{}class F6e extends E6e{testPrecision(e,t){const i="precision ".concat(t,` float;
void main(){}`),r=e.createShader(e.FRAGMENT_SHADER);return!!r&&(e.shaderSource(r,i),e.compileShader(r),!!e.getShaderParameter(r,e.COMPILE_STATUS))}queryWebGL(e){const t=e.getContext("webgl");t&&(this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find((i=>this.testPrecision(t,i))),t.getExtension("WEBGL_lose_context").loseContext(),Sf("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(e){return!!this.maxTextureSize&&this.maxTextureSize>=e}}const k6e={};let t7;const yA=()=>t7||(t7={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new F6e,dispose(){},copyPasteData:k6e}),N1=()=>yA().document,L1=()=>yA().window,IG=()=>{var n;return Math.max((n=Ys.devicePixelRatio)!==null&&n!==void 0?n:L1().devicePixelRatio,1)},aw=new class{constructor(){St(this,"charWidthsCache",{}),St(this,"boundsOfCurveCache",{})}getFontCache(n){let{fontFamily:e,fontStyle:t,fontWeight:i}=n;e=e.toLowerCase(),this.charWidthsCache[e]||(this.charWidthsCache[e]={});const r=this.charWidthsCache[e],s="".concat(t.toLowerCase(),"_").concat((i+"").toLowerCase());return r[s]||(r[s]={}),r[s]}clearFontCache(n){(n=(n||"").toLowerCase())?this.charWidthsCache[n]&&delete this.charWidthsCache[n]:this.charWidthsCache={}}limitDimsByArea(n){const{perfLimitSizeTotal:e}=Ys,t=Math.sqrt(e*n);return[Math.floor(t),Math.floor(e/t)]}},f6="6.7.1";function Xg(){}const zp=Math.PI/2,Tf=2*Math.PI,p8=Math.PI/180,dh=Object.freeze([1,0,0,1,0,0]),g8=16,ep=.4477152502,ns="center",uo="left",Ph="top",p6="bottom",il="right",hh="none",m8=/\r?\n/,DG="moving",rS="scaling",jG="rotating",y8="rotate",PG="skewing",Ow="resizing",I6e="modifyPoly",D6e="modifyPath",B_="changed",sS="scale",Ah="scaleX",nu="scaleY",M1="skewX",R1="skewY",bl="fill",uh="stroke",E_="modified",em="json",gT="svg",Mi=new class{constructor(){this[em]=new Map,this[gT]=new Map}has(n){return this[em].has(n)}getClass(n){const e=this[em].get(n);if(!e)throw new rA("No class registered for ".concat(n));return e}setClass(n,e){e?this[em].set(e,n):(this[em].set(n.type,n),this[em].set(n.type.toLowerCase(),n))}getSVGClass(n){return this[gT].get(n)}setSVGClass(n,e){this[gT].set(e??n.type.toLowerCase(),n)}},F_=new class extends Array{remove(n){const e=this.indexOf(n);e>-1&&this.splice(e,1)}cancelAll(){const n=this.splice(0);return n.forEach((e=>e.abort())),n}cancelByCanvas(n){if(!n)return[];const e=this.filter((t=>{var i;return t.target===n||typeof t.target=="object"&&((i=t.target)===null||i===void 0?void 0:i.canvas)===n}));return e.forEach((t=>t.abort())),e}cancelByTarget(n){if(!n)return[];const e=this.filter((t=>t.target===n));return e.forEach((t=>t.abort())),e}};class j6e{constructor(){St(this,"__eventListeners",{})}on(e,t){if(this.__eventListeners||(this.__eventListeners={}),typeof e=="object")return Object.entries(e).forEach((i=>{let[r,s]=i;this.on(r,s)})),()=>this.off(e);if(t){const i=e;return this.__eventListeners[i]||(this.__eventListeners[i]=[]),this.__eventListeners[i].push(t),()=>this.off(i,t)}return()=>!1}once(e,t){if(typeof e=="object"){const i=[];return Object.entries(e).forEach((r=>{let[s,o]=r;i.push(this.once(s,o))})),()=>i.forEach((r=>r()))}if(t){const i=this.on(e,(function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];t.call(this,...s),i()}));return i}return()=>!1}_removeEventListener(e,t){if(this.__eventListeners[e])if(t){const i=this.__eventListeners[e],r=i.indexOf(t);r>-1&&i.splice(r,1)}else this.__eventListeners[e]=[]}off(e,t){if(this.__eventListeners)if(e===void 0)for(const i in this.__eventListeners)this._removeEventListener(i);else typeof e=="object"?Object.entries(e).forEach((i=>{let[r,s]=i;this._removeEventListener(r,s)})):this._removeEventListener(e,t)}fire(e,t){var i;if(!this.__eventListeners)return;const r=(i=this.__eventListeners[e])===null||i===void 0?void 0:i.concat();if(r)for(let s=0;s<r.length;s++)r[s].call(this,t||{})}}const kg=(n,e)=>{const t=n.indexOf(e);return t!==-1&&n.splice(t,1),n},Td=n=>{if(n===0)return 1;switch(Math.abs(n)/zp){case 1:case 3:return 0;case 2:return-1}return Math.cos(n)},Bd=n=>{if(n===0)return 0;const e=n/zp,t=Math.sign(n);switch(e){case 1:return t;case 2:return 0;case 3:return-t}return Math.sin(n)};class qt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof e=="object"?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t)}add(e){return new qt(this.x+e.x,this.y+e.y)}addEquals(e){return this.x+=e.x,this.y+=e.y,this}scalarAdd(e){return new qt(this.x+e,this.y+e)}scalarAddEquals(e){return this.x+=e,this.y+=e,this}subtract(e){return new qt(this.x-e.x,this.y-e.y)}subtractEquals(e){return this.x-=e.x,this.y-=e.y,this}scalarSubtract(e){return new qt(this.x-e,this.y-e)}scalarSubtractEquals(e){return this.x-=e,this.y-=e,this}multiply(e){return new qt(this.x*e.x,this.y*e.y)}scalarMultiply(e){return new qt(this.x*e,this.y*e)}scalarMultiplyEquals(e){return this.x*=e,this.y*=e,this}divide(e){return new qt(this.x/e.x,this.y/e.y)}scalarDivide(e){return new qt(this.x/e,this.y/e)}scalarDivideEquals(e){return this.x/=e,this.y/=e,this}eq(e){return this.x===e.x&&this.y===e.y}lt(e){return this.x<e.x&&this.y<e.y}lte(e){return this.x<=e.x&&this.y<=e.y}gt(e){return this.x>e.x&&this.y>e.y}gte(e){return this.x>=e.x&&this.y>=e.y}lerp(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return t=Math.max(Math.min(1,t),0),new qt(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)}distanceFrom(e){const t=this.x-e.x,i=this.y-e.y;return Math.sqrt(t*t+i*i)}midPointFrom(e){return this.lerp(e)}min(e){return new qt(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new qt(Math.max(this.x,e.x),Math.max(this.y,e.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(e,t){return this.x=e,this.y=t,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setFromPoint(e){return this.x=e.x,this.y=e.y,this}swap(e){const t=this.x,i=this.y;this.x=e.x,this.y=e.y,e.x=t,e.y=i}clone(){return new qt(this.x,this.y)}rotate(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w8;const i=Bd(e),r=Td(e),s=this.subtract(t);return new qt(s.x*r-s.y*i,s.x*i+s.y*r).add(t)}transform(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new qt(e[0]*this.x+e[2]*this.y+(t?0:e[4]),e[1]*this.x+e[3]*this.y+(t?0:e[5]))}}const w8=new qt(0,0),fC=n=>!!n&&Array.isArray(n._objects);function NG(n){class e extends n{constructor(){super(...arguments),St(this,"_objects",[])}_onObjectAdded(i){}_onObjectRemoved(i){}_onStackOrderChanged(i){}add(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];const o=this._objects.push(...r);return r.forEach((a=>this._onObjectAdded(a))),o}insertAt(i){for(var r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];return this._objects.splice(i,0,...s),s.forEach((a=>this._onObjectAdded(a))),this._objects.length}remove(){const i=this._objects,r=[];for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return o.forEach((l=>{const h=i.indexOf(l);h!==-1&&(i.splice(h,1),r.push(l),this._onObjectRemoved(l))})),r}forEachObject(i){this.getObjects().forEach(((r,s,o)=>i(r,s,o)))}getObjects(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return r.length===0?[...this._objects]:this._objects.filter((o=>o.isType(...r)))}item(i){return this._objects[i]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(i,r){return!!this._objects.includes(i)||!!r&&this._objects.some((s=>s instanceof e&&s.contains(i,!0)))}complexity(){return this._objects.reduce(((i,r)=>i+=r.complexity?r.complexity():0),0)}sendObjectToBack(i){return!(!i||i===this._objects[0])&&(kg(this._objects,i),this._objects.unshift(i),this._onStackOrderChanged(i),!0)}bringObjectToFront(i){return!(!i||i===this._objects[this._objects.length-1])&&(kg(this._objects,i),this._objects.push(i),this._onStackOrderChanged(i),!0)}sendObjectBackwards(i,r){if(!i)return!1;const s=this._objects.indexOf(i);if(s!==0){const o=this.findNewLowerIndex(i,s,r);return kg(this._objects,i),this._objects.splice(o,0,i),this._onStackOrderChanged(i),!0}return!1}bringObjectForward(i,r){if(!i)return!1;const s=this._objects.indexOf(i);if(s!==this._objects.length-1){const o=this.findNewUpperIndex(i,s,r);return kg(this._objects,i),this._objects.splice(o,0,i),this._onStackOrderChanged(i),!0}return!1}moveObjectTo(i,r){return i!==this._objects[r]&&(kg(this._objects,i),this._objects.splice(r,0,i),this._onStackOrderChanged(i),!0)}findNewLowerIndex(i,r,s){let o;if(s){o=r;for(let a=r-1;a>=0;--a)if(i.isOverlapping(this._objects[a])){o=a;break}}else o=r-1;return o}findNewUpperIndex(i,r,s){let o;if(s){o=r;for(let a=r+1;a<this._objects.length;++a)if(i.isOverlapping(this._objects[a])){o=a;break}}else o=r+1;return o}collectObjects(i){let{left:r,top:s,width:o,height:a}=i,{includeIntersecting:l=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const h=[],u=new qt(r,s),d=u.add(new qt(o,a));for(let A=this._objects.length-1;A>=0;A--){const f=this._objects[A];f.selectable&&f.visible&&(l&&f.intersectsWithRect(u,d)||f.isContainedWithinRect(u,d)||l&&f.containsPoint(u)||l&&f.containsPoint(d))&&h.push(f)}return h}}return e}class LG extends j6e{_setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(const t in e)this.set(t,e[t])}_setObject(e){for(const t in e)this._set(t,e[t])}set(e,t){return typeof e=="object"?this._setObject(e):this._set(e,t),this}_set(e,t){this[e]=t}toggle(e){const t=this.get(e);return typeof t=="boolean"&&this.set(e,!t),this}get(e){return this[e]}}function lw(n){return L1().requestAnimationFrame(n)}function MG(n){return L1().cancelAnimationFrame(n)}let P6e=0;const Qp=()=>P6e++,wA=()=>{const n=N1().createElement("canvas");if(!n||n.getContext===void 0)throw new rA("Failed to create `canvas` element");return n},RG=()=>N1().createElement("img"),iu=n=>{const e=wA();return e.width=n.width,e.height=n.height,e},v8=(n,e,t)=>n.toDataURL("image/".concat(e),t),x8=(n,e,t)=>new Promise(((i,r)=>{n.toBlob(i,"image/".concat(e),t)})),La=n=>n*p8,vA=n=>n/p8,UG=n=>n.every(((e,t)=>e===dh[t])),Hc=(n,e,t)=>new qt(n).transform(e,t),Dh=n=>{const e=1/(n[0]*n[3]-n[1]*n[2]),t=[e*n[3],-e*n[1],-e*n[2],e*n[0],0,0],{x:i,y:r}=new qt(n[4],n[5]).transform(t,!0);return t[4]=-i,t[5]=-r,t},ll=(n,e,t)=>[n[0]*e[0]+n[2]*e[1],n[1]*e[0]+n[3]*e[1],n[0]*e[2]+n[2]*e[3],n[1]*e[2]+n[3]*e[3],t?0:n[0]*e[4]+n[2]*e[5]+n[4],t?0:n[1]*e[4]+n[3]*e[5]+n[5]],oS=(n,e)=>n.reduceRight(((t,i)=>i&&t?ll(i,t,e):i||t),void 0)||dh.concat(),OG=n=>{let[e,t]=n;return Math.atan2(t,e)},c0=n=>{const e=OG(n),t=Math.pow(n[0],2)+Math.pow(n[1],2),i=Math.sqrt(t),r=(n[0]*n[3]-n[2]*n[1])/i,s=Math.atan2(n[0]*n[2]+n[1]*n[3],t);return{angle:vA(e),scaleX:i,scaleY:r,skewX:vA(s),skewY:0,translateX:n[4]||0,translateY:n[5]||0}},U1=function(n){return[1,0,0,1,n,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function S0(){let{angle:n=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:e=0,y:t=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=La(n),r=Td(i),s=Bd(i);return[r,s,-s,r,e?e-(r*e-s*t):0,t?t-(s*e+r*t):0]}const aS=function(n){return[n,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:n,0,0]},HG=n=>Math.tan(La(n)),b8=n=>[1,0,HG(n),1,0,0],C8=n=>[1,HG(n),0,1,0,0],Fv=n=>{let{scaleX:e=1,scaleY:t=1,flipX:i=!1,flipY:r=!1,skewX:s=0,skewY:o=0}=n,a=aS(i?-e:e,r?-t:t);return s&&(a=ll(a,b8(s),!0)),o&&(a=ll(a,C8(o),!0)),a},WG=n=>{const{translateX:e=0,translateY:t=0,angle:i=0}=n;let r=U1(e,t);i&&(r=ll(r,S0({angle:i})));const s=Fv(n);return UG(s)||(r=ll(r,s)),r},cw=function(n){let{signal:e,crossOrigin:t=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((function(i,r){if(e&&e.aborted)return r(new f8("loadImage"));const s=RG();let o;e&&(o=function(l){s.src="",r(l)},e.addEventListener("abort",o,{once:!0}));const a=function(){s.onload=s.onerror=null,o&&(e==null||e.removeEventListener("abort",o)),i(s)};n?(s.onload=a,s.onerror=function(){o&&(e==null||e.removeEventListener("abort",o)),r(new rA("Error loading ".concat(s.src)))},t&&(s.crossOrigin=t),s.src=n):a()}))},f1=function(n){let{signal:e,reviver:t=Xg}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(((i,r)=>{const s=[];e&&e.addEventListener("abort",r,{once:!0}),Promise.all(n.map((o=>Mi.getClass(o.type).fromObject(o,{signal:e}).then((a=>(t(o,a),s.push(a),a)))))).then(i).catch((o=>{s.forEach((a=>{a.dispose&&a.dispose()})),r(o)})).finally((()=>{e&&e.removeEventListener("abort",r)}))}))},kv=function(n){let{signal:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(((t,i)=>{const r=[];e&&e.addEventListener("abort",i,{once:!0});const s=Object.values(n).map((a=>a&&a.type&&Mi.has(a.type)?f1([a],{signal:e}).then((l=>{let[h]=l;return r.push(h),h})):a)),o=Object.keys(n);Promise.all(s).then((a=>a.reduce(((l,h,u)=>(l[o[u]]=h,l)),{}))).then(t).catch((a=>{r.forEach((l=>{l.dispose&&l.dispose()})),i(a)})).finally((()=>{e&&e.removeEventListener("abort",i)}))}))},T0=function(n){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce(((e,t)=>(t in n&&(e[t]=n[t]),e)),{})},_8=(n,e)=>Object.keys(n).reduce(((t,i)=>(e(n[i],i,n)&&(t[i]=n[i]),t)),{}),No=(n,e)=>parseFloat(Number(n).toFixed(e)),p1=n=>"matrix("+n.map((e=>No(e,Ys.NUM_FRACTION_DIGITS))).join(" ")+")",Bu=n=>!!n&&n.toLive!==void 0,n7=n=>!!n&&typeof n.toObject=="function",i7=n=>!!n&&n.offsetX!==void 0&&"source"in n,Ig=n=>!!n&&"multiSelectionStacking"in n;function zG(n){const e=n&&ud(n);let t=0,i=0;if(!n||!e)return{left:t,top:i};let r=n;const s=e.documentElement,o=e.body||{scrollLeft:0,scrollTop:0};for(;r&&(r.parentNode||r.host)&&(r=r.parentNode||r.host,r===e?(t=o.scrollLeft||s.scrollLeft||0,i=o.scrollTop||s.scrollTop||0):(t+=r.scrollLeft||0,i+=r.scrollTop||0),r.nodeType!==1||r.style.position!=="fixed"););return{left:t,top:i}}const ud=n=>n.ownerDocument||null,QG=n=>{var e;return((e=n.ownerDocument)===null||e===void 0?void 0:e.defaultView)||null},$G=function(n,e,t){let{width:i,height:r}=t,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;n.width=i,n.height=r,s>1&&(n.setAttribute("width",(i*s).toString()),n.setAttribute("height",(r*s).toString()),e.scale(s,s))},g6=(n,e)=>{let{width:t,height:i}=e;t&&(n.style.width=typeof t=="number"?"".concat(t,"px"):t),i&&(n.style.height=typeof i=="number"?"".concat(i,"px"):i)};function r7(n){return n.onselectstart!==void 0&&(n.onselectstart=()=>!1),n.style.userSelect=hh,n}class VG{constructor(e){St(this,"_originalCanvasStyle",void 0),St(this,"lower",void 0);const t=this.createLowerCanvas(e);this.lower={el:t,ctx:t.getContext("2d")}}createLowerCanvas(e){const t=(i=e)&&i.getContext!==void 0?e:e&&N1().getElementById(e)||wA();var i;if(t.hasAttribute("data-fabric"))throw new rA("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=t.style.cssText,t.setAttribute("data-fabric","main"),t.classList.add("lower-canvas"),t}cleanupDOM(e){let{width:t,height:i}=e;const{el:r}=this.lower;r.classList.remove("lower-canvas"),r.removeAttribute("data-fabric"),r.setAttribute("width","".concat(t)),r.setAttribute("height","".concat(i)),r.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(e,t){const{el:i,ctx:r}=this.lower;$G(i,r,e,t)}setCSSDimensions(e){g6(this.lower.el,e)}calcOffset(){return(function(e){var t;const i=e&&ud(e),r={left:0,top:0};if(!i)return r;const s=((t=QG(e))===null||t===void 0?void 0:t.getComputedStyle(e,null))||{};r.left+=parseInt(s.borderLeftWidth,10)||0,r.top+=parseInt(s.borderTopWidth,10)||0,r.left+=parseInt(s.paddingLeft,10)||0,r.top+=parseInt(s.paddingTop,10)||0;let o={left:0,top:0};const a=i.documentElement;e.getBoundingClientRect!==void 0&&(o=e.getBoundingClientRect());const l=zG(e);return{left:o.left+l.left-(a.clientLeft||0)+r.left,top:o.top+l.top-(a.clientTop||0)+r.top}})(this.lower.el)}dispose(){yA().dispose(this.lower.el),delete this.lower}}const N6e={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...dh]};class Iv extends NG(LG){get lowerCanvasEl(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.el}get contextContainer(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.ctx}static getDefaults(){return Iv.ownDefaults}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(t),this.initElements(e),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(e){this.elements=new VG(e)}add(){const e=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}insertAt(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];const s=super.insertAt(e,...i);return i.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),s}remove(){const e=super.remove(...arguments);return e.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}_onObjectAdded(e){e.canvas&&e.canvas!==this&&(Sf("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),e.canvas.remove(e)),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e){e._set("canvas",void 0),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?IG():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(e,t){return this.setDimensions({width:e},t)}setHeight(e,t){return this.setDimensions({height:e},t)}_setDimensionsImpl(e){let{cssOnly:t=!1,backstoreOnly:i=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t){const r=Ct({width:this.width,height:this.height},e);this.elements.setDimensions(r,this.getRetinaScaling()),this.hasLostContext=!0,this.width=r.width,this.height=r.height}i||this.elements.setCSSDimensions(e),this.calcOffset()}setDimensions(e,t){this._setDimensionsImpl(e,t),t&&t.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(e){this.viewportTransform=e,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(e,t){const i=e,r=[...this.viewportTransform],s=Hc(e,Dh(r));r[0]=t,r[3]=t;const o=Hc(s,r);r[4]+=i.x-o.x,r[5]+=i.y-o.y,this.setViewportTransform(r)}setZoom(e){this.zoomToPoint(new qt(0,0),e)}absolutePan(e){const t=[...this.viewportTransform];return t[4]=-e.x,t[5]=-e.y,this.setViewportTransform(t)}relativePan(e){return this.absolutePan(new qt(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(e){e.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=lw((()=>this.renderAndReset())))}calcViewportBoundaries(){const e=this.width,t=this.height,i=Dh(this.viewportTransform),r=Hc({x:0,y:0},i),s=Hc({x:e,y:t},i),o=r.min(s),a=r.max(s);return this.vptCoords={tl:o,tr:new qt(a.x,o.y),bl:new qt(o.x,a.y),br:a}}cancelRequestedRender(){this.nextRenderHandle&&(MG(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(e){}renderCanvas(e,t){if(this.destroyed)return;const i=this.viewportTransform,r=this.clipPath;this.calcViewportBoundaries(),this.clearContext(e),e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.patternQuality="best",this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this._renderObjects(e,t),e.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(e),r&&(r._set("canvas",this),r.shouldCache(),r._transformDone=!0,r.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e,r)),this._renderOverlay(e),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(e),this.fire("after:render",{ctx:e}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(e,t){const i=this.viewportTransform;e.save(),e.transform(...i),e.globalCompositeOperation="destination-in",t.transform(e),e.scale(1/t.zoomX,1/t.zoomY),e.drawImage(t._cacheCanvas,-t.cacheTranslationX,-t.cacheTranslationY),e.restore()}_renderObjects(e,t){for(let i=0,r=t.length;i<r;++i)t[i]&&t[i].render(e)}_renderBackgroundOrOverlay(e,t){const i=this["".concat(t,"Color")],r=this["".concat(t,"Image")],s=this.viewportTransform,o=this["".concat(t,"Vpt")];if(!i&&!r)return;const a=Bu(i);if(i){if(e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=a?i.toLive(e):i,o&&e.transform(...s),a){e.transform(1,0,0,1,i.offsetX||0,i.offsetY||0);const l=i.gradientTransform||i.patternTransform;l&&e.transform(...l)}e.fill(),e.restore()}if(r){e.save();const{skipOffscreen:l}=this;this.skipOffscreen=o,o&&e.transform(...s),r.render(e),this.skipOffscreen=l,e.restore()}}_renderBackground(e){this._renderBackgroundOrOverlay(e,"background")}_renderOverlay(e){this._renderBackgroundOrOverlay(e,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new qt(this.width/2,this.height/2)}centerObjectH(e){return this._centerObject(e,new qt(this.getCenterPoint().x,e.getCenterPoint().y))}centerObjectV(e){return this._centerObject(e,new qt(e.getCenterPoint().x,this.getCenterPoint().y))}centerObject(e){return this._centerObject(e,this.getCenterPoint())}viewportCenterObject(e){return this._centerObject(e,this.getVpCenter())}viewportCenterObjectH(e){return this._centerObject(e,new qt(this.getVpCenter().x,e.getCenterPoint().y))}viewportCenterObjectV(e){return this._centerObject(e,new qt(e.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return Hc(this.getCenterPoint(),Dh(this.viewportTransform))}_centerObject(e,t){e.setXY(t,ns,ns),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(e){return this.toDatalessObject(e)}toObject(e){return this._toObjectMethod("toObject",e)}toJSON(){return this.toObject()}toDatalessObject(e){return this._toObjectMethod("toDatalessObject",e)}_toObjectMethod(e,t){const i=this.clipPath,r=i&&!i.excludeFromExport?this._toObject(i,e,t):null;return Ct(Ct(Ct({version:f6},T0(this,t)),{},{objects:this._objects.filter((s=>!s.excludeFromExport)).map((s=>this._toObject(s,e,t)))},this.__serializeBgOverlay(e,t)),r?{clipPath:r}:null)}_toObject(e,t,i){let r;this.includeDefaultValues||(r=e.includeDefaultValues,e.includeDefaultValues=!1);const s=e[t](i);return this.includeDefaultValues||(e.includeDefaultValues=!!r),s}__serializeBgOverlay(e,t){const i={},r=this.backgroundImage,s=this.overlayImage,o=this.backgroundColor,a=this.overlayColor;return Bu(o)?o.excludeFromExport||(i.background=o.toObject(t)):o&&(i.background=o),Bu(a)?a.excludeFromExport||(i.overlay=a.toObject(t)):a&&(i.overlay=a),r&&!r.excludeFromExport&&(i.backgroundImage=this._toObject(r,e,t)),s&&!s.excludeFromExport&&(i.overlayImage=this._toObject(s,e,t)),i}toSVG(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;e.reviver=t;const i=[];return this._setSVGPreamble(i,e),this._setSVGHeader(i,e),this.clipPath&&i.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(i,"background"),this._setSVGBgOverlayImage(i,"backgroundImage",t),this._setSVGObjects(i,t),this.clipPath&&i.push(`</g>
`),this._setSVGBgOverlayColor(i,"overlay"),this._setSVGBgOverlayImage(i,"overlayImage",t),i.push("</svg>"),i.join("")}_setSVGPreamble(e,t){t.suppressPreamble||e.push('<?xml version="1.0" encoding="',t.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(e,t){const i=t.width||"".concat(this.width),r=t.height||"".concat(this.height),s=Ys.NUM_FRACTION_DIGITS,o=t.viewBox;let a;if(o)a='viewBox="'.concat(o.x," ").concat(o.y," ").concat(o.width," ").concat(o.height,'" ');else if(this.svgViewportTransformation){const l=this.viewportTransform;a='viewBox="'.concat(No(-l[4]/l[0],s)," ").concat(No(-l[5]/l[3],s)," ").concat(No(this.width/l[0],s)," ").concat(No(this.height/l[3],s),'" ')}else a='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',i,'" ','height="',r,'" ',a,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",f6,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(t),`</defs>
`)}createSVGClipPathMarkup(e){const t=this.clipPath;return t?(t.clipPathId="CLIPPATH_".concat(Qp()),'<clipPath id="'.concat(t.clipPathId,`" >
`).concat(t.toClipPathSVG(e.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map((e=>{const t=this["".concat(e,"Color")];if(Bu(t)){const i=this["".concat(e,"Vpt")],r=this.viewportTransform,s={isType:()=>!1,width:this.width/(i?r[0]:1),height:this.height/(i?r[3]:1)};return t.toSVG(s,{additionalTransform:i?p1(r):""})}})).join("")}createSVGFontFacesMarkup(){const e=[],t={},i=Ys.fontPaths;this._objects.forEach((function s(o){e.push(o),fC(o)&&o._objects.forEach(s)})),e.forEach((s=>{if(!(o=s)||typeof o._renderText!="function")return;var o;const{styles:a,fontFamily:l}=s;!t[l]&&i[l]&&(t[l]=!0,a&&Object.values(a).forEach((h=>{Object.values(h).forEach((u=>{let{fontFamily:d=""}=u;!t[d]&&i[d]&&(t[d]=!0)}))})))}));const r=Object.keys(t).map((s=>`		@font-face {
			font-family: '`.concat(s,`';
			src: url('`).concat(i[s],`');
		}
`))).join("");return r?`	<style type="text/css"><![CDATA[
`.concat(r,`]]></style>
`):""}_setSVGObjects(e,t){this.forEachObject((i=>{i.excludeFromExport||this._setSVGObject(e,i,t)}))}_setSVGObject(e,t,i){e.push(t.toSVG(i))}_setSVGBgOverlayImage(e,t,i){const r=this[t];r&&!r.excludeFromExport&&r.toSVG&&e.push(r.toSVG(i))}_setSVGBgOverlayColor(e,t){const i=this["".concat(t,"Color")];if(i)if(Bu(i)){const r=i.repeat||"",s=this.width,o=this.height,a=this["".concat(t,"Vpt")]?p1(Dh(this.viewportTransform)):"";e.push('<rect transform="'.concat(a," translate(").concat(s/2,",").concat(o/2,')" x="').concat(i.offsetX-s/2,'" y="').concat(i.offsetY-o/2,'" width="').concat(r!=="repeat-y"&&r!=="no-repeat"||!i7(i)?s:i.source.width,'" height="').concat(r!=="repeat-x"&&r!=="no-repeat"||!i7(i)?o:i.source.height,'" fill="url(#SVGID_').concat(i.id,`)"></rect>
`))}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',i,'"',`></rect>
`)}loadFromJSON(e,t){let{signal:i}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return Promise.reject(new rA("`json` is undefined"));const r=typeof e=="string"?JSON.parse(e):e,{objects:s=[],backgroundImage:o,background:a,overlayImage:l,overlay:h,clipPath:u}=r,d=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([f1(s,{reviver:t,signal:i}),kv({backgroundImage:o,backgroundColor:a,overlayImage:l,overlayColor:h,clipPath:u},{signal:i})]).then((A=>{let[f,p]=A;return this.clear(),this.add(...f),this.set(r),this.set(p),this.renderOnAddRemove=d,this}))}clone(e){const t=this.toObject(e);return this.cloneWithoutData().loadFromJSON(t)}cloneWithoutData(){const e=iu(this);return new this.constructor(e)}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:t="png",quality:i=1,multiplier:r=1,enableRetinaScaling:s=!1}=e,o=r*(s?this.getRetinaScaling():1);return v8(this.toCanvasElement(o,e),t,i)}toBlob(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:t="png",quality:i=1,multiplier:r=1,enableRetinaScaling:s=!1}=e,o=r*(s?this.getRetinaScaling():1);return x8(this.toCanvasElement(o,e),t,i)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:t,height:i,left:r,top:s,filter:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const a=(t||this.width)*e,l=(i||this.height)*e,h=this.getZoom(),u=this.width,d=this.height,A=this.skipControlsDrawing,f=h*e,p=this.viewportTransform,g=[f,0,0,f,(p[4]-(r||0))*e,(p[5]-(s||0))*e],v=this.enableRetinaScaling,w=iu({width:a,height:l}),m=o?this._objects.filter((y=>o(y))):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=g,this.width=a,this.height=l,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(w.getContext("2d"),m),this.viewportTransform=p,this.width=u,this.height=d,this.calcViewportBoundaries(),this.enableRetinaScaling=v,this.skipControlsDrawing=A,w}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),F_.cancelByCanvas(this),this.disposed=!0,new Promise(((e,t)=>{const i=()=>{this.destroy(),e(!0)};i.kill=t,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?e(!1):this.nextRenderHandle?this.__cleanupTask=i:i()}))}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject((e=>e.dispose())),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}}St(Iv,"ownDefaults",N6e);const L6e=["touchstart","touchmove","touchend"],GG=n=>{const e=zG(n.target),t=(function(i){const r=i.changedTouches;return r&&r[0]?r[0]:i})(n);return new qt(t.clientX+e.left,t.clientY+e.top)},k_=n=>L6e.includes(n.type)||n.pointerType==="touch",s7=n=>{n.preventDefault(),n.stopPropagation()},dA=n=>{let e=0,t=0,i=0,r=0;for(let s=0,o=n.length;s<o;s++){const{x:a,y:l}=n[s];(a>i||!s)&&(i=a),(a<e||!s)&&(e=a),(l>r||!s)&&(r=l),(l<t||!s)&&(t=l)}return{left:e,top:t,width:i-e,height:r-t}},M6e=["translateX","translateY","scaleX","scaleY"],XG=(n,e)=>g1(n,ll(e,n.calcOwnMatrix())),g1=(n,e)=>{const t=c0(e),{translateX:i,translateY:r,scaleX:s,scaleY:o}=t,a=ca(t,M6e),l=new qt(i,r);n.flipX=!1,n.flipY=!1,Object.assign(n,a),n.set({scaleX:s,scaleY:o}),n.setPositionByOrigin(l,ns,ns)},YG=n=>{n.scaleX=1,n.scaleY=1,n.skewX=0,n.skewY=0,n.flipX=!1,n.flipY=!1,n.rotate(0)},S8=n=>({scaleX:n.scaleX,scaleY:n.scaleY,skewX:n.skewX,skewY:n.skewY,angle:n.angle,left:n.left,flipX:n.flipX,flipY:n.flipY,top:n.top}),lS=(n,e,t)=>{const i=n/2,r=e/2,s=[new qt(-i,-r),new qt(i,-r),new qt(-i,r),new qt(i,r)].map((a=>a.transform(t))),o=dA(s);return new qt(o.width,o.height)},Dv=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:dh;return ll(Dh(arguments.length>1&&arguments[1]!==void 0?arguments[1]:dh),n)},Yg=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:dh,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:dh;return n.transform(Dv(e,t))},KG=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:dh,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:dh;return n.transform(Dv(e,t),!0)},m6=(n,e,t)=>{const i=Dv(e,t);return g1(n,ll(i,n.calcOwnMatrix())),i},qG=(n,e)=>{var t;const{transform:{target:i}}=e;(t=i.canvas)===null||t===void 0||t.fire("object:".concat(n),Ct(Ct({},e),{},{target:i})),i.fire(n,e)},R6e={left:-.5,top:-.5,center:0,bottom:.5,right:.5},yl=n=>typeof n=="string"?R6e[n]:n-.5,I_="not-allowed";function ZG(n){return yl(n.originX)===yl(ns)&&yl(n.originY)===yl(ns)}function o7(n){return .5-yl(n)}const vd=(n,e)=>n[e],JG=(n,e,t,i)=>({e:n,transform:e,pointer:new qt(t,i)});function eX(n,e){const t=n.getTotalAngle()+vA(Math.atan2(e.y,e.x))+360;return Math.round(t%360/45)}function T8(n,e,t,i,r){var s;let{target:o,corner:a}=n;const l=o.controls[a],h=((s=o.canvas)===null||s===void 0?void 0:s.getZoom())||1,u=o.padding/h,d=(function(A,f,p,g){const v=A.getRelativeCenterPoint(),w=p!==void 0&&g!==void 0?A.translateToGivenOrigin(v,ns,ns,p,g):new qt(A.left,A.top);return(A.angle?f.rotate(-La(A.angle),v):f).subtract(w)})(o,new qt(i,r),e,t);return d.x>=u&&(d.x-=u),d.x<=-u&&(d.x+=u),d.y>=u&&(d.y-=u),d.y<=u&&(d.y+=u),d.x-=l.offsetX,d.y-=l.offsetY,d}const U6e=(n,e,t,i)=>{const{target:r,offsetX:s,offsetY:o}=e,a=t-s,l=i-o,h=!vd(r,"lockMovementX")&&r.left!==a,u=!vd(r,"lockMovementY")&&r.top!==l;return h&&r.set(uo,a),u&&r.set(Ph,l),(h||u)&&qG(DG,JG(n,e,t,i)),h||u},a7={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},mT=(n,e,t)=>(t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+(e-n)*(2/3-t)*6:n),l7=(n,e,t,i)=>{n/=255,e/=255,t/=255;const r=Math.max(n,e,t),s=Math.min(n,e,t);let o,a;const l=(r+s)/2;if(r===s)o=a=0;else{const h=r-s;switch(a=l>.5?h/(2-r-s):h/(r+s),r){case n:o=(e-t)/h+(e<t?6:0);break;case e:o=(t-n)/h+2;break;case t:o=(n-e)/h+4}o/=6}return[Math.round(360*o),Math.round(100*a),Math.round(100*l),i]},c7=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(n)/(n.endsWith("%")?100:1)},Ab=n=>Math.min(Math.round(n),255).toString(16).toUpperCase().padStart(2,"0"),h7=n=>{let[e,t,i,r=1]=n;const s=Math.round(.3*e+.59*t+.11*i);return[s,s,s,r]};class po{constructor(e){if(St(this,"isUnrecognised",!1),e)if(e instanceof po)this.setSource([...e._source]);else if(Array.isArray(e)){const[t,i,r,s=1]=e;this.setSource([t,i,r,s])}else this.setSource(this._tryParsingColor(e));else this.setSource([0,0,0,1])}_tryParsingColor(e){return(e=e.toLowerCase())in a7&&(e=a7[e]),e==="transparent"?[255,255,255,0]:po.sourceFromHex(e)||po.sourceFromRgb(e)||po.sourceFromHsl(e)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(e){this._source=e}toRgb(){const[e,t,i]=this.getSource();return"rgb(".concat(e,",").concat(t,",").concat(i,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){const[e,t,i]=l7(...this.getSource());return"hsl(".concat(e,",").concat(t,"%,").concat(i,"%)")}toHsla(){const[e,t,i,r]=l7(...this.getSource());return"hsla(".concat(e,",").concat(t,"%,").concat(i,"%,").concat(r,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[e,t,i,r]=this.getSource();return"".concat(Ab(e)).concat(Ab(t)).concat(Ab(i)).concat(Ab(Math.round(255*r)))}getAlpha(){return this.getSource()[3]}setAlpha(e){return this._source[3]=e,this}toGrayscale(){return this.setSource(h7(this.getSource())),this}toBlackWhite(e){const[t,,,i]=h7(this.getSource()),r=t<(e||127)?0:255;return this.setSource([r,r,r,i]),this}overlayWith(e){e instanceof po||(e=new po(e));const t=this.getSource(),i=e.getSource(),[r,s,o]=t.map(((a,l)=>Math.round(.5*a+.5*i[l])));return this.setSource([r,s,o,t[3]]),this}static fromRgb(e){return po.fromRgba(e)}static fromRgba(e){return new po(po.sourceFromRgb(e))}static sourceFromRgb(e){const t=e.match(/^rgba?\(\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d{0,3}(?:\.\d+)?%?)\s*)?\)$/i);if(t){const[i,r,s]=t.slice(1,4).map((o=>{const a=parseFloat(o);return o.endsWith("%")?Math.round(2.55*a):a}));return[i,r,s,c7(t[4])]}}static fromHsl(e){return po.fromHsla(e)}static fromHsla(e){return new po(po.sourceFromHsl(e))}static sourceFromHsl(e){const t=e.match(/^hsla?\(\s*([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d*(?:\.\d+)?%?)\s*)?\)$/i);if(!t)return;const i=(po.parseAngletoDegrees(t[1])%360+360)%360/360,r=parseFloat(t[2])/100,s=parseFloat(t[3])/100;let o,a,l;if(r===0)o=a=l=s;else{const h=s<=.5?s*(r+1):s+r-s*r,u=2*s-h;o=mT(u,h,i+1/3),a=mT(u,h,i),l=mT(u,h,i-1/3)}return[Math.round(255*o),Math.round(255*a),Math.round(255*l),c7(t[4])]}static fromHex(e){return new po(po.sourceFromHex(e))}static sourceFromHex(e){if(e.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const t=e.slice(e.indexOf("#")+1);let i;i=t.length<=4?t.split("").map((l=>l+l)):t.match(/.{2}/g);const[r,s,o,a=255]=i.map((l=>parseInt(l,16)));return[r,s,o,a/255]}}static parseAngletoDegrees(e){const t=e.toLowerCase(),i=parseFloat(t);return t.includes("rad")?vA(i):t.includes("turn")?360*i:i}}const sh=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g8;const t=/\D{0,2}$/.exec(n),i=parseFloat(n),r=Ys.DPI;switch(t==null?void 0:t[0]){case"mm":return i*r/25.4;case"cm":return i*r/2.54;case"in":return i*r;case"pt":return i*r/72;case"pc":return i*r/72*12;case"em":return i*e;default:return i}},B8=n=>{const[e,t]=n.trim().split(" "),[i,r]=(s=e)&&s!==hh?[s.slice(1,4),s.slice(5,8)]:s===hh?[s,s]:["Mid","Mid"];var s;return{meetOrSlice:t||"meet",alignX:i,alignY:r}},Hw=function(n,e){let t,i,r=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(e)if(e.toLive)t="url(#SVGID_".concat(e.id,")");else{const s=new po(e),o=s.getAlpha();t=s.toRgb(),o!==1&&(i=o.toString())}else t="none";return r?"".concat(n,": ").concat(t,"; ").concat(i?"".concat(n,"-opacity: ").concat(i,"; "):""):"".concat(n,'="').concat(t,'" ').concat(i?"".concat(n,'-opacity="').concat(i,'" '):"")};class tX{getSvgStyles(e){const t=this.fillRule?this.fillRule:"nonzero",i=this.strokeWidth?this.strokeWidth:"0",r=this.strokeDashArray?this.strokeDashArray.join(" "):hh,s=this.strokeDashOffset?this.strokeDashOffset:"0",o=this.strokeLineCap?this.strokeLineCap:"butt",a=this.strokeLineJoin?this.strokeLineJoin:"miter",l=this.strokeMiterLimit?this.strokeMiterLimit:"4",h=this.opacity!==void 0?this.opacity:"1",u=this.visible?"":" visibility: hidden;",d=e?"":this.getSvgFilter(),A=Hw(bl,this.fill);return[Hw(uh,this.stroke),"stroke-width: ",i,"; ","stroke-dasharray: ",r,"; ","stroke-linecap: ",o,"; ","stroke-dashoffset: ",s,"; ","stroke-linejoin: ",a,"; ","stroke-miterlimit: ",l,"; ",A,"fill-rule: ",t,"; ","opacity: ",h,";",d,u].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const i=e?this.calcTransformMatrix():this.calcOwnMatrix(),r='transform="'.concat(p1(i));return"".concat(r).concat(t,'" ')}_toSVG(e){return[""]}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})}toClipPathSVG(e){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})}_createBaseClipPathSVGMarkup(e){let{reviver:t,additionalTransform:i=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=[this.getSvgTransform(!0,i),this.getSvgCommons()].join(""),s=e.indexOf("COMMON_PARTS");return e[s]=r,t?t(e.join("")):e.join("")}_createBaseSVGMarkup(e){let{noStyle:t,reviver:i,withShadow:r,additionalTransform:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=t?"":'style="'.concat(this.getSvgStyles(),'" '),a=r?'style="'.concat(this.getSvgFilter(),'" '):"",l=this.clipPath,h=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",u=l&&l.absolutePositioned,d=this.stroke,A=this.fill,f=this.shadow,p=[],g=e.indexOf("COMMON_PARTS");let v;l&&(l.clipPathId="CLIPPATH_".concat(Qp()),v='<clipPath id="'.concat(l.clipPathId,`" >
`).concat(l.toClipPathSVG(i),`</clipPath>
`)),u&&p.push("<g ",a,this.getSvgCommons(),` >
`),p.push("<g ",this.getSvgTransform(!1),u?"":a+this.getSvgCommons(),` >
`);const w=[o,h,t?"":this.addPaintOrder()," ",s?'transform="'.concat(s,'" '):""].join("");return e[g]=w,Bu(A)&&p.push(A.toSVG(this)),Bu(d)&&p.push(d.toSVG(this)),f&&p.push(f.toSVG(this)),l&&p.push(v),p.push(e.join("")),p.push(`</g>
`),u&&p.push(`</g>
`),i?i(p.join("")):p.join("")}addPaintOrder(){return this.paintFirst!==bl?' paint-order="'.concat(this.paintFirst,'" '):""}}function cS(n){return new RegExp("^("+n.join("|")+")\\b","i")}const h0="textDecorationThickness",nX=["fontSize","fontWeight","fontFamily","fontStyle"],iX=["underline","overline","linethrough"],rX=[...nX,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],sX=[...rX,...iX,"textBackgroundColor","direction",h0],O6e=[...nX,...iX,uh,"strokeWidth",bl,"deltaY","textBackgroundColor",h0],H6e={_reNewline:m8,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:uo,fontStyle:"normal",lineHeight:1.16,textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:uo,pathAlign:"baseline",charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.28167,overline:-.81333},_fontSizeMult:1.13,[h0]:66.667},tA="justify",D_="justify-left",hw="justify-right",uw="justify-center";var u7,d7,A7;const pd=String.raw(u7||(u7=SA(["[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?"],["[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?"]))),yT=String.raw(d7||(d7=SA(["(?:s*,?s+|s*,s*)"],["(?:\\s*,?\\s+|\\s*,\\s*)"]))),y6="http://www.w3.org/2000/svg",W6e=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+pd+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+pd+"))?\\s+(.*)"),z6e={cx:uo,x:uo,r:"radius",cy:Ph,y:Ph,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing","text-decoration-thickness":h0},wT="font-size",vT="clip-path",Q6e=cS(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),$6e=cS(["symbol","image","marker","pattern","view","svg"]),f7=cS(["symbol","g","a","svg","clipPath","defs"]),p7=new RegExp(String.raw(A7||(A7=SA(["^s*(",")","(",")","(",")","(",")s*$"],["^\\s*(",")","(",")","(",")","(",")\\s*$"])),pd,yT,pd,yT,pd,yT,pd)),V6e=new qt(1,0),oX=new qt,E8=(n,e)=>n.rotate(e),j_=(n,e)=>new qt(e).subtract(n),P_=n=>n.distanceFrom(oX),N_=(n,e)=>Math.atan2(Gm(n,e),lX(n,e)),aX=n=>N_(V6e,n),hS=n=>n.eq(oX)?n:n.scalarDivide(P_(n)),F8=function(n){let e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return hS(new qt(-n.y,n.x).scalarMultiply(e?1:-1))},Gm=(n,e)=>n.x*e.y-n.y*e.x,lX=(n,e)=>n.x*e.x+n.y*e.y,w6=(n,e,t)=>{if(n.eq(e)||n.eq(t))return!0;const i=Gm(e,t),r=Gm(e,n),s=Gm(t,n);return i>=0?r>=0&&s<=0:!(r<=0&&s>=0)},g7="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",m7=new RegExp("(?:\\s|^)"+g7+g7+"("+pd+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");class pf{constructor(e){const t=typeof e=="string"?pf.parseShadow(e):e;Object.assign(this,pf.ownDefaults,t),this.id=Qp()}static parseShadow(e){const t=e.trim(),[,i=0,r=0,s=0]=(m7.exec(t)||[]).map((o=>parseFloat(o)||0));return{color:(t.replace(m7,"")||"rgb(0,0,0)").trim(),offsetX:i,offsetY:r,blur:s}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(e){const t=E8(new qt(this.offsetX,this.offsetY),La(-e.angle)),i=new po(this.color);let r=40,s=40;return e.width&&e.height&&(r=100*No((Math.abs(t.x)+this.blur)/e.width,Ys.NUM_FRACTION_DIGITS)+20,s=100*No((Math.abs(t.y)+this.blur)/e.height,Ys.NUM_FRACTION_DIGITS)+20),e.flipX&&(t.x*=-1),e.flipY&&(t.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(s,'%" height="').concat(100+2*s,'%" x="-').concat(r,'%" width="').concat(100+2*r,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(No(this.blur?this.blur/2:0,Ys.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(No(t.x,Ys.NUM_FRACTION_DIGITS),'" dy="').concat(No(t.y,Ys.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(i.toRgb(),'" flood-opacity="').concat(i.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){const e={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},t=pf.ownDefaults;return this.includeDefaultValues?e:_8(e,((i,r)=>i!==t[r]))}static async fromObject(e){return new this(e)}}St(pf,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),St(pf,"type","shadow"),Mi.setClass(pf,"shadow");const u0=(n,e,t)=>Math.max(n,Math.min(e,t)),G6e=[Ph,uo,Ah,nu,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",M1,R1],jf=[bl,uh,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],X6e={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:uo,originY:Ph,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:bl,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},xT=(n,e,t,i)=>(n<Math.abs(e)?(n=e,i=t/4):i=e===0&&n===0?t/Tf*Math.asin(1):t/Tf*Math.asin(e/n),{a:n,c:e,p:t,s:i}),y7=(n,e,t,i,r)=>n*Math.pow(2,10*(i-=1))*Math.sin((i*r-e)*Tf/t),cX=(n,e,t,i)=>-t*Math.cos(n/i*zp)+t+e,v6=(n,e,t,i)=>(n/=i)<1/2.75?t*(7.5625*n*n)+e:n<2/2.75?t*(7.5625*(n-=1.5/2.75)*n+.75)+e:n<2.5/2.75?t*(7.5625*(n-=2.25/2.75)*n+.9375)+e:t*(7.5625*(n-=2.625/2.75)*n+.984375)+e,w7=(n,e,t,i)=>t-v6(i-n,0,t,i)+e;var Y6e=Object.freeze({__proto__:null,defaultEasing:cX,easeInBack:function(n,e,t,i){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return t*(n/=i)*n*((r+1)*n-r)+e},easeInBounce:w7,easeInCirc:(n,e,t,i)=>-t*(Math.sqrt(1-(n/=i)*n)-1)+e,easeInCubic:(n,e,t,i)=>t*(n/i)**3+e,easeInElastic:(n,e,t,i)=>{const r=t;let s=0;if(n===0)return e;if((n/=i)===1)return e+t;s||(s=.3*i);const{a:o,s:a,p:l}=xT(r,t,s,1.70158);return-y7(o,a,l,n,i)+e},easeInExpo:(n,e,t,i)=>n===0?e:t*2**(10*(n/i-1))+e,easeInOutBack:function(n,e,t,i){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return(n/=i/2)<1?t/2*(n*n*((1+(r*=1.525))*n-r))+e:t/2*((n-=2)*n*((1+(r*=1.525))*n+r)+2)+e},easeInOutBounce:(n,e,t,i)=>n<i/2?.5*w7(2*n,0,t,i)+e:.5*v6(2*n-i,0,t,i)+.5*t+e,easeInOutCirc:(n,e,t,i)=>(n/=i/2)<1?-t/2*(Math.sqrt(1-n**2)-1)+e:t/2*(Math.sqrt(1-(n-=2)*n)+1)+e,easeInOutCubic:(n,e,t,i)=>(n/=i/2)<1?t/2*n**3+e:t/2*((n-2)**3+2)+e,easeInOutElastic:(n,e,t,i)=>{const r=t;let s=0;if(n===0)return e;if((n/=i/2)===2)return e+t;s||(s=i*(.3*1.5));const{a:o,s:a,p:l,c:h}=xT(r,t,s,1.70158);return n<1?-.5*y7(o,a,l,n,i)+e:o*Math.pow(2,-10*(n-=1))*Math.sin((n*i-a)*Tf/l)*.5+h+e},easeInOutExpo:(n,e,t,i)=>n===0?e:n===i?e+t:(n/=i/2)<1?t/2*2**(10*(n-1))+e:t/2*-(2**(-10*--n)+2)+e,easeInOutQuad:(n,e,t,i)=>(n/=i/2)<1?t/2*n**2+e:-t/2*(--n*(n-2)-1)+e,easeInOutQuart:(n,e,t,i)=>(n/=i/2)<1?t/2*n**4+e:-t/2*((n-=2)*n**3-2)+e,easeInOutQuint:(n,e,t,i)=>(n/=i/2)<1?t/2*n**5+e:t/2*((n-2)**5+2)+e,easeInOutSine:(n,e,t,i)=>-t/2*(Math.cos(Math.PI*n/i)-1)+e,easeInQuad:(n,e,t,i)=>t*(n/=i)*n+e,easeInQuart:(n,e,t,i)=>t*(n/=i)*n**3+e,easeInQuint:(n,e,t,i)=>t*(n/i)**5+e,easeInSine:(n,e,t,i)=>-t*Math.cos(n/i*zp)+t+e,easeOutBack:function(n,e,t,i){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return t*((n=n/i-1)*n*((r+1)*n+r)+1)+e},easeOutBounce:v6,easeOutCirc:(n,e,t,i)=>t*Math.sqrt(1-(n=n/i-1)*n)+e,easeOutCubic:(n,e,t,i)=>t*((n/i-1)**3+1)+e,easeOutElastic:(n,e,t,i)=>{const r=t;let s=0;if(n===0)return e;if((n/=i)===1)return e+t;s||(s=.3*i);const{a:o,s:a,p:l,c:h}=xT(r,t,s,1.70158);return o*2**(-10*n)*Math.sin((n*i-a)*Tf/l)+h+e},easeOutExpo:(n,e,t,i)=>n===i?e+t:t*-(2**(-10*n/i)+1)+e,easeOutQuad:(n,e,t,i)=>-t*(n/=i)*(n-2)+e,easeOutQuart:(n,e,t,i)=>-t*((n=n/i-1)*n**3-1)+e,easeOutQuint:(n,e,t,i)=>t*((n/i-1)**5+1)+e,easeOutSine:(n,e,t,i)=>t*Math.sin(n/i*zp)+e});const K6e=()=>!1;class k8{constructor(e){let{startValue:t,byValue:i,duration:r=500,delay:s=0,easing:o=cX,onStart:a=Xg,onChange:l=Xg,onComplete:h=Xg,abort:u=K6e,target:d}=e;St(this,"_state","pending"),St(this,"durationProgress",0),St(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=r,this.delay=s,this.easing=o,this._onStart=a,this._onChange=l,this._onComplete=h,this._abort=u,this.target=d,this.startValue=t,this.byValue=i,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){const e=t=>{this._state==="pending"&&(this.startTime=t||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout((()=>lw(e)),this.delay):lw(e)}tick(e){const t=(e||+new Date)-this.startTime,i=Math.min(t,this.duration);this.durationProgress=i/this.duration;const{value:r,valueProgress:s}=this.calculate(i);this.value=Object.freeze(r),this.valueProgress=s,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):t>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),lw(this.tick)))}register(){F_.push(this)}unregister(){F_.remove(this)}abort(){this._state="aborted",this.unregister()}}const q6e=["startValue","endValue"];class Z6e extends k8{constructor(e){let{startValue:t=0,endValue:i=100}=e;super(Ct(Ct({},ca(e,q6e)),{},{startValue:t,byValue:i-t}))}calculate(e){const t=this.easing(e,this.startValue,this.byValue,this.duration);return{value:t,valueProgress:Math.abs((t-this.startValue)/this.byValue)}}}const J6e=["startValue","endValue"];class eFe extends k8{constructor(e){let{startValue:t=[0],endValue:i=[100]}=e;super(Ct(Ct({},ca(e,J6e)),{},{startValue:t,byValue:i.map(((r,s)=>r-t[s]))}))}calculate(e){const t=this.startValue.map(((i,r)=>this.easing(e,i,this.byValue[r],this.duration,r)));return{value:t,valueProgress:Math.abs((t[0]-this.startValue[0])/this.byValue[0])}}}const tFe=["startValue","endValue","easing","onChange","onComplete","abort"],nFe=(n,e,t,i)=>e+t*(1-Math.cos(n/i*zp)),bT=n=>n&&((e,t,i)=>n(new po(e).toRgba(),t,i));class iFe extends k8{constructor(e){let{startValue:t,endValue:i,easing:r=nFe,onChange:s,onComplete:o,abort:a}=e,l=ca(e,tFe);const h=new po(t).getSource(),u=new po(i).getSource();super(Ct(Ct({},l),{},{startValue:h,byValue:u.map(((d,A)=>d-h[A])),easing:r,onChange:bT(s),onComplete:bT(o),abort:bT(a)}))}calculate(e){const[t,i,r,s]=this.startValue.map(((a,l)=>this.easing(e,a,this.byValue[l],this.duration,l))),o=[...[t,i,r].map(Math.round),u0(0,s,1)];return{value:o,valueProgress:o.map(((a,l)=>this.byValue[l]!==0?Math.abs((a-this.startValue[l])/this.byValue[l]):0)).find((a=>a!==0))||0}}}function I8(n){const e=(t=>Array.isArray(t.startValue)||Array.isArray(t.endValue))(n)?new eFe(n):new Z6e(n);return e.start(),e}function hX(n){const e=new iFe(n);return e.start(),e}class pa{constructor(e){this.status=e,this.points=[]}includes(e){return this.points.some((t=>t.eq(e)))}append(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return this.points=this.points.concat(t.filter((r=>!this.includes(r)))),this}static isPointContained(e,t,i){let r=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(t.eq(i))return e.eq(t);if(t.x===i.x)return e.x===t.x&&(r||e.y>=Math.min(t.y,i.y)&&e.y<=Math.max(t.y,i.y));if(t.y===i.y)return e.y===t.y&&(r||e.x>=Math.min(t.x,i.x)&&e.x<=Math.max(t.x,i.x));{const s=j_(t,i),o=j_(t,e).divide(s);return r?Math.abs(o.x)===Math.abs(o.y):o.x===o.y&&o.x>=0&&o.x<=1}}static isPointInPolygon(e,t){const i=new qt(e).setX(Math.min(e.x-1,...t.map((s=>s.x))));let r=0;for(let s=0;s<t.length;s++){const o=this.intersectSegmentSegment(t[s],t[(s+1)%t.length],e,i);if(o.includes(e))return!0;r+=+(o.status==="Intersection")}return r%2==1}static intersectLineLine(e,t,i,r){let s=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],o=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];const a=t.x-e.x,l=t.y-e.y,h=r.x-i.x,u=r.y-i.y,d=e.x-i.x,A=e.y-i.y,f=h*A-u*d,p=a*A-l*d,g=u*a-h*l;if(g!==0){const v=f/g,w=p/g;return(s||0<=v&&v<=1)&&(o||0<=w&&w<=1)?new pa("Intersection").append(new qt(e.x+v*a,e.y+v*l)):new pa}if(f===0||p===0){const v=s||o||pa.isPointContained(e,i,r)||pa.isPointContained(t,i,r)||pa.isPointContained(i,e,t)||pa.isPointContained(r,e,t);return new pa(v?"Coincident":void 0)}return new pa("Parallel")}static intersectSegmentLine(e,t,i,r){return pa.intersectLineLine(e,t,i,r,!1,!0)}static intersectSegmentSegment(e,t,i,r){return pa.intersectLineLine(e,t,i,r,!1,!1)}static intersectLinePolygon(e,t,i){let r=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];const s=new pa,o=i.length;for(let a,l,h,u=0;u<o;u++){if(a=i[u],l=i[(u+1)%o],h=pa.intersectLineLine(e,t,a,l,r,!1),h.status==="Coincident")return h;s.append(...h.points)}return s.points.length>0&&(s.status="Intersection"),s}static intersectSegmentPolygon(e,t,i){return pa.intersectLinePolygon(e,t,i,!1)}static intersectPolygonPolygon(e,t){const i=new pa,r=e.length,s=[];for(let o=0;o<r;o++){const a=e[o],l=e[(o+1)%r],h=pa.intersectSegmentPolygon(a,l,t);h.status==="Coincident"?(s.push(h),i.append(a,l)):i.append(...h.points)}return s.length>0&&s.length===e.length?new pa("Coincident"):(i.points.length>0&&(i.status="Intersection"),i)}static intersectPolygonRectangle(e,t,i){const r=t.min(i),s=t.max(i),o=new qt(s.x,r.y),a=new qt(r.x,s.y);return pa.intersectPolygonPolygon(e,[r,o,s,a])}}class rFe extends LG{getX(){return this.getXY().x}setX(e){this.setXY(this.getXY().setX(e))}getY(){return this.getXY().y}setY(e){this.setXY(this.getXY().setY(e))}getRelativeX(){return this.left}setRelativeX(e){this.left=e}getRelativeY(){return this.top}setRelativeY(e){this.top=e}getXY(){const e=this.getRelativeXY();return this.group?Hc(e,this.group.calcTransformMatrix()):e}setXY(e,t,i){this.group&&(e=Hc(e,Dh(this.group.calcTransformMatrix()))),this.setRelativeXY(e,t,i)}getRelativeXY(){return new qt(this.left,this.top)}setRelativeXY(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(e,t,i)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:e,tr:t,br:i,bl:r}=this.aCoords||(this.aCoords=this.calcACoords()),s=[e,t,i,r];if(this.group){const o=this.group.calcTransformMatrix();return s.map((a=>Hc(a,o)))}return s}intersectsWithRect(e,t){return pa.intersectPolygonRectangle(this.getCoords(),e,t).status==="Intersection"}intersectsWithObject(e){const t=pa.intersectPolygonPolygon(this.getCoords(),e.getCoords());return t.status==="Intersection"||t.status==="Coincident"||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)}isContainedWithinObject(e){return this.getCoords().every((t=>e.containsPoint(t)))}isContainedWithinRect(e,t){const{left:i,top:r,width:s,height:o}=this.getBoundingRect();return i>=e.x&&i+s<=t.x&&r>=e.y&&r+o<=t.y}isOverlapping(e){return this.intersectsWithObject(e)||this.isContainedWithinObject(e)||e.isContainedWithinObject(this)}containsPoint(e){return pa.isPointInPolygon(e,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return!!this.getCoords().some((i=>i.x<=t.x&&i.x>=e.x&&i.y<=t.y&&i.y>=e.y))||!!this.intersectsWithRect(e,t)||this.containsPoint(e.midPointFrom(t))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return this.intersectsWithRect(e,t)?!0:this.getCoords().every((i=>(i.x>=t.x||i.x<=e.x)&&(i.y>=t.y||i.y<=e.y)))&&this.containsPoint(e.midPointFrom(t))}getBoundingRect(){return dA(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(e){this._set(Ah,e),this._set(nu,e),this.setCoords()}scaleToWidth(e){const t=this.getBoundingRect().width/this.getScaledWidth();return this.scale(e/this.width/t)}scaleToHeight(e){const t=this.getBoundingRect().height/this.getScaledHeight();return this.scale(e/this.height/t)}getCanvasRetinaScaling(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.getRetinaScaling())||1}getTotalAngle(){return this.group?vA(OG(this.calcTransformMatrix())):this.angle}getViewportTransform(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.viewportTransform)||dh.concat()}calcACoords(){const e=S0({angle:this.angle}),{x:t,y:i}=this.getRelativeCenterPoint(),r=U1(t,i),s=ll(r,e),o=this._getTransformedDimensions(),a=o.x/2,l=o.y/2;return{tl:Hc({x:-a,y:-l},s),tr:Hc({x:a,y:-l},s),bl:Hc({x:-a,y:l},s),br:Hc({x:a,y:l},s)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=[];return!e&&this.group&&(t=this.group.transformMatrixKey(e)),t.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,yl(this.originX),yl(this.originY)),t}calcTransformMatrix(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=this.calcOwnMatrix();if(e||!this.group)return t;const i=this.transformMatrixKey(e),r=this.matrixCache;return r&&r.key.every(((s,o)=>s===i[o]))?r.value:(this.group&&(t=ll(this.group.calcTransformMatrix(!1),t)),this.matrixCache={key:i,value:t},t)}calcOwnMatrix(){const e=this.transformMatrixKey(!0),t=this.ownMatrixCache;if(t&&t.key===e)return t.value;const i=this.getRelativeCenterPoint(),r={angle:this.angle,translateX:i.x,translateY:i.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},s=WG(r);return this.ownMatrixCache={key:e,value:s},s}_getNonTransformedDimensions(){return new qt(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(e){return this._getTransformedDimensions(e).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=Ct({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},e),i=t.strokeWidth;let r=i,s=0;this.strokeUniform&&(r=0,s=i);const o=t.width+r,a=t.height+r;let l;return l=t.skewX===0&&t.skewY===0?new qt(o*t.scaleX,a*t.scaleY):lS(o,a,Fv(t)),l.scalarAdd(s)}translateToGivenOrigin(e,t,i,r,s){let o=e.x,a=e.y;const l=yl(r)-yl(t),h=yl(s)-yl(i);if(l||h){const u=this._getTransformedDimensions();o+=l*u.x,a+=h*u.y}return new qt(o,a)}translateToCenterPoint(e,t,i){if(t===ns&&i===ns)return e;const r=this.translateToGivenOrigin(e,t,i,ns,ns);return this.angle?r.rotate(La(this.angle),e):r}translateToOriginPoint(e,t,i){const r=this.translateToGivenOrigin(e,ns,ns,t,i);return this.angle?r.rotate(La(this.angle),e):r}getCenterPoint(){const e=this.getRelativeCenterPoint();return this.group?Hc(e,this.group.calcTransformMatrix()):e}getRelativeCenterPoint(){return this.translateToCenterPoint(new qt(this.left,this.top),this.originX,this.originY)}getPointByOrigin(e,t){return this.translateToOriginPoint(this.getRelativeCenterPoint(),e,t)}setPositionByOrigin(e,t,i){const r=this.translateToCenterPoint(e,t,i),s=this.translateToOriginPoint(r,this.originX,this.originY);this.set({left:s.x,top:s.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),uo,Ph)}}const sFe=["type"],oFe=["extraParam"];let XA=class pC extends rFe{static getDefaults(){return pC.ownDefaults}get type(){const e=this.constructor.type;return e==="FabricObject"?"object":e.toLowerCase()}set type(e){Sf("warn","Setting type has no effect",e)}constructor(e){super(),St(this,"_cacheContext",null),Object.assign(this,pC.ownDefaults),this.setOptions(e)}_createCacheCanvas(){this._cacheCanvas=wA(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(e){const t=e.width,i=e.height,r=Ys.maxCacheSideLimit,s=Ys.minCacheSideLimit;if(t<=r&&i<=r&&t*i<=Ys.perfLimitSizeTotal)return t<s&&(e.width=s),i<s&&(e.height=s),e;const o=t/i,[a,l]=aw.limitDimsByArea(o),h=u0(s,a,r),u=u0(s,l,r);return t>h&&(e.zoomX/=t/h,e.width=h,e.capped=!0),i>u&&(e.zoomY/=i/u,e.height=u,e.capped=!0),e}_getCacheCanvasDimensions(){const e=this.getTotalObjectScaling(),t=this._getTransformedDimensions({skewX:0,skewY:0}),i=t.x*e.x/this.scaleX,r=t.y*e.y/this.scaleY;return{width:Math.ceil(i+2),height:Math.ceil(r+2),zoomX:e.x,zoomY:e.y,x:i,y:r}}_updateCacheCanvas(){const e=this._cacheCanvas,t=this._cacheContext,{width:i,height:r,zoomX:s,zoomY:o,x:a,y:l}=this._limitCacheSize(this._getCacheCanvasDimensions()),h=i!==e.width||r!==e.height,u=this.zoomX!==s||this.zoomY!==o;if(!e||!t)return!1;if(h||u){i!==e.width||r!==e.height?(e.width=i,e.height=r):(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height));const d=a/2,A=l/2;return this.cacheTranslationX=Math.round(e.width/2-d)+d,this.cacheTranslationY=Math.round(e.height/2-A)+A,t.translate(this.cacheTranslationX,this.cacheTranslationY),t.scale(s,o),this.zoomX=s,this.zoomY=o,!0}return!1}setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(e)}transform(e){const t=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,i=this.calcTransformMatrix(!t);e.transform(i[0],i[1],i[2],i[3],i[4],i[5])}getObjectScaling(){if(!this.group)return new qt(Math.abs(this.scaleX),Math.abs(this.scaleY));const e=c0(this.calcTransformMatrix());return new qt(Math.abs(e.scaleX),Math.abs(e.scaleY))}getTotalObjectScaling(){const e=this.getObjectScaling();if(this.canvas){const t=this.canvas.getZoom(),i=this.getCanvasRetinaScaling();return e.scalarMultiply(t*i)}return e}getObjectOpacity(){let e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e}_constrainScale(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:e===0?1e-4:e}_set(e,t){e!==Ah&&e!==nu||(t=this._constrainScale(t)),e===Ah&&t<0?(this.flipX=!this.flipX,t*=-1):e==="scaleY"&&t<0?(this.flipY=!this.flipY,t*=-1):e!=="shadow"||!t||t instanceof pf||(t=new pf(t));const i=this[e]!==t;return this[e]=t,i&&this.constructor.cacheProperties.includes(e)&&(this.dirty=!0),this.parent&&(this.dirty||i&&this.constructor.stateProperties.includes(e))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.drawObject(e,!1,{}),this.dirty=!1),e.restore())}drawSelectionBackground(e){}renderCache(e){if(e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){const{zoomX:t,zoomY:i,cacheTranslationX:r,cacheTranslationY:s}=this,{width:o,height:a}=this._cacheCanvas;this.drawObject(this._cacheContext,e.forClipping,{zoomX:t,zoomY:i,cacheTranslationX:r,cacheTranslationY:s,width:o,height:a,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===uh&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(e,t,i){e.save(),t.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",e.setTransform(1,0,0,1,0,0),e.drawImage(i,0,0),e.restore()}drawObject(e,t,i){const r=this.fill,s=this.stroke;t?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath,i),this.fill=r,this.stroke=s}createClipPathLayer(e,t){const i=iu(t),r=i.getContext("2d");if(r.translate(t.cacheTranslationX,t.cacheTranslationY),r.scale(t.zoomX,t.zoomY),e._cacheCanvas=i,t.parentClipPaths.forEach((s=>{s.transform(r)})),t.parentClipPaths.push(e),e.absolutePositioned){const s=Dh(this.calcTransformMatrix());r.transform(s[0],s[1],s[2],s[3],s[4],s[5])}return e.transform(r),e.drawObject(r,!0,t),i}_drawClipPath(e,t,i){if(!t)return;t._transformDone=!0;const r=this.createClipPathLayer(t,i);this.drawClipPathOnCache(e,t,r)}drawCacheOnCanvas(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;const t=this._cacheCanvas,i=this._cacheContext;return!(!t||!i||e||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(t&&i&&!e&&(i.save(),i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,t.width,t.height),i.restore()),!0)}_renderBackground(e){if(!this.backgroundColor)return;const t=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-t.x/2,-t.y/2,t.x,t.y),this._removeShadow(e)}_setOpacity(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity}_setStrokeStyles(e,t){const i=t.stroke;i&&(e.lineWidth=t.strokeWidth,e.lineCap=t.strokeLineCap,e.lineDashOffset=t.strokeDashOffset,e.lineJoin=t.strokeLineJoin,e.miterLimit=t.strokeMiterLimit,Bu(i)?i.gradientUnits==="percentage"||i.gradientTransform||i.patternTransform?this._applyPatternForTransformedGradient(e,i):(e.strokeStyle=i.toLive(e),this._applyPatternGradientTransform(e,i)):e.strokeStyle=t.stroke)}_setFillStyles(e,t){let{fill:i}=t;i&&(Bu(i)?(e.fillStyle=i.toLive(e),this._applyPatternGradientTransform(e,i)):e.fillStyle=i)}_setClippingProperties(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"}_setLineDash(e,t){t&&t.length!==0&&e.setLineDash(t)}_setShadow(e){if(!this.shadow)return;const t=this.shadow,i=this.canvas,r=this.getCanvasRetinaScaling(),[s,,,o]=(i==null?void 0:i.viewportTransform)||dh,a=s*r,l=o*r,h=t.nonScaling?new qt(1,1):this.getObjectScaling();e.shadowColor=t.color,e.shadowBlur=t.blur*Ys.browserShadowBlurConstant*(a+l)*(h.x+h.y)/4,e.shadowOffsetX=t.offsetX*a*h.x,e.shadowOffsetY=t.offsetY*l*h.y}_removeShadow(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)}_applyPatternGradientTransform(e,t){if(!Bu(t))return{offsetX:0,offsetY:0};const i=t.gradientTransform||t.patternTransform,r=-this.width/2+t.offsetX||0,s=-this.height/2+t.offsetY||0;return t.gradientUnits==="percentage"?e.transform(this.width,0,0,this.height,r,s):e.transform(1,0,0,1,r,s),i&&e.transform(i[0],i[1],i[2],i[3],i[4],i[5]),{offsetX:r,offsetY:s}}_renderPaintInOrder(e){this.paintFirst===uh?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))}_render(e){}_renderFill(e){this.fill&&(e.save(),this._setFillStyles(e,this),this.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}_renderStroke(e){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform){const t=this.getObjectScaling();e.scale(1/t.x,1/t.y)}this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}}_applyPatternForTransformedGradient(e,t){var i;const r=this._limitCacheSize(this._getCacheCanvasDimensions()),s=this.getCanvasRetinaScaling(),o=r.x/this.scaleX/s,a=r.y/this.scaleY/s,l=iu({width:Math.ceil(o),height:Math.ceil(a)}),h=l.getContext("2d");h&&(h.beginPath(),h.moveTo(0,0),h.lineTo(o,0),h.lineTo(o,a),h.lineTo(0,a),h.closePath(),h.translate(o/2,a/2),h.scale(r.zoomX/this.scaleX/s,r.zoomY/this.scaleY/s),this._applyPatternGradientTransform(h,t),h.fillStyle=t.toLive(e),h.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(s*this.scaleX/r.zoomX,s*this.scaleY/r.zoomY),e.strokeStyle=(i=h.createPattern(l,"no-repeat"))!==null&&i!==void 0?i:"")}_findCenterFromElement(){return new qt(this.left+this.width/2,this.top+this.height/2)}clone(e){const t=this.toObject(e);return this.constructor.fromObject(t)}cloneAsImage(e){const t=this.toCanvasElement(e);return new(Mi.getClass("image"))(t)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=S8(this),i=this.group,r=this.shadow,s=Math.abs,o=e.enableRetinaScaling?IG():1,a=(e.multiplier||1)*o,l=e.canvasProvider||(m=>new Iv(m,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,e.withoutTransform&&YG(this),e.withoutShadow&&(this.shadow=null),e.viewportTransform&&m6(this,this.getViewportTransform()),this.setCoords();const h=wA(),u=this.getBoundingRect(),d=this.shadow,A=new qt;if(d){const m=d.blur,y=d.nonScaling?new qt(1,1):this.getObjectScaling();A.x=2*Math.round(s(d.offsetX)+m)*s(y.x),A.y=2*Math.round(s(d.offsetY)+m)*s(y.y)}const f=u.width+A.x,p=u.height+A.y;h.width=Math.ceil(f),h.height=Math.ceil(p);const g=l(h);e.format==="jpeg"&&(g.backgroundColor="#fff"),this.setPositionByOrigin(new qt(g.width/2,g.height/2),ns,ns);const v=this.canvas;g._objects=[this],this.set("canvas",g),this.setCoords();const w=g.toCanvasElement(a||1,e);return this.set("canvas",v),this.shadow=r,i&&(this.group=i),this.set(t),this.setCoords(),g._objects=[],g.destroy(),w}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return v8(this.toCanvasElement(e),e.format||"png",e.quality||1)}toBlob(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return x8(this.toCanvasElement(e),e.format||"png",e.quality||1)}isType(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.includes(this.constructor.type)||t.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(e){const{centeredRotation:t,originX:i,originY:r}=this;if(t){const{x:s,y:o}=this.getRelativeCenterPoint();this.originX=ns,this.originY=ns,this.left=s,this.top=o}if(this.set("angle",e),t){const{x:s,y:o}=this.translateToOriginPoint(this.getRelativeCenterPoint(),i,r);this.left=s,this.top=o,this.originX=i,this.originY=r}}setOnGroup(){}_setupCompositeOperation(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)}dispose(){F_.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&yA().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(e,t){return Object.entries(e).reduce(((i,r)=>{let[s,o]=r;return i[s]=this._animate(s,o,t),i}),{})}_animate(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=e.split("."),s=this.constructor.colorProperties.includes(r[r.length-1]),{abort:o,startValue:a,onChange:l,onComplete:h}=i,u=Ct(Ct({},i),{},{target:this,startValue:a??r.reduce(((d,A)=>d[A]),this),endValue:t,abort:o==null?void 0:o.bind(this),onChange:(d,A,f)=>{r.reduce(((p,g,v)=>(v===r.length-1&&(p[g]=d),p[g])),this),l&&l(d,A,f)},onComplete:(d,A,f)=>{this.setCoords(),h&&h(d,A,f)}});return s?hX(u):I8(u)}isDescendantOf(e){const{parent:t,group:i}=this;return t===e||i===e||!!t&&t.isDescendantOf(e)||!!i&&i!==t&&i.isDescendantOf(e)}getAncestors(){const e=[];let t=this;do t=t.parent,t&&e.push(t);while(t);return e}findCommonAncestors(e){if(this===e)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const t=this.getAncestors(),i=e.getAncestors();if(t.length===0&&i.length>0&&this===i[i.length-1])return{fork:[],otherFork:[e,...i.slice(0,i.length-1)],common:[this]};for(let r,s=0;s<t.length;s++){if(r=t[s],r===e)return{fork:[this,...t.slice(0,s)],otherFork:[],common:t.slice(s)};for(let o=0;o<i.length;o++){if(this===i[o])return{fork:[],otherFork:[e,...i.slice(0,o)],common:[this,...t]};if(r===i[o])return{fork:[this,...t.slice(0,s)],otherFork:[e,...i.slice(0,o)],common:t.slice(s)}}}return{fork:[this,...t],otherFork:[e,...i],common:[]}}hasCommonAncestors(e){const t=this.findCommonAncestors(e);return t&&!!t.common.length}isInFrontOf(e){if(this===e)return;const t=this.findCommonAncestors(e);if(t.fork.includes(e))return!0;if(t.otherFork.includes(this))return!1;const i=t.common[0]||this.canvas;if(!i)return;const r=t.fork.pop(),s=t.otherFork.pop(),o=i._objects.indexOf(r),a=i._objects.indexOf(s);return o>-1&&o>a}toObject(){const e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(pC.customProperties,this.constructor.customProperties||[]);let t;const i=Ys.NUM_FRACTION_DIGITS,{clipPath:r,fill:s,stroke:o,shadow:a,strokeDashArray:l,left:h,top:u,originX:d,originY:A,width:f,height:p,strokeWidth:g,strokeLineCap:v,strokeDashOffset:w,strokeLineJoin:m,strokeUniform:y,strokeMiterLimit:x,scaleX:S,scaleY:I,angle:j,flipX:C,flipY:b,opacity:D,visible:T,backgroundColor:k,fillRule:B,paintFirst:E,globalCompositeOperation:z,skewX:te,skewY:L}=this;r&&!r.excludeFromExport&&(t=r.toObject(e.concat("inverted","absolutePositioned")));const O=$=>No($,i),J=Ct(Ct({},T0(this,e)),{},{type:this.constructor.type,version:f6,originX:d,originY:A,left:O(h),top:O(u),width:O(f),height:O(p),fill:n7(s)?s.toObject():s,stroke:n7(o)?o.toObject():o,strokeWidth:O(g),strokeDashArray:l&&l.concat(),strokeLineCap:v,strokeDashOffset:w,strokeLineJoin:m,strokeUniform:y,strokeMiterLimit:O(x),scaleX:O(S),scaleY:O(I),angle:O(j),flipX:C,flipY:b,opacity:O(D),shadow:a&&a.toObject(),visible:T,backgroundColor:k,fillRule:B,paintFirst:E,globalCompositeOperation:z,skewX:O(te),skewY:O(L)},t?{clipPath:t}:null);return this.includeDefaultValues?J:this._removeDefaultValues(J)}toDatalessObject(e){return this.toObject(e)}_removeDefaultValues(e){const t=this.constructor.getDefaults(),i=Object.keys(t).length>0?t:Object.getPrototypeOf(this);return _8(e,((r,s)=>{if(s===uo||s===Ph||s==="type")return!0;const o=i[s];return r!==o&&!(Array.isArray(r)&&Array.isArray(o)&&r.length===0&&o.length===0)}))}toString(){return"#<".concat(this.constructor.type,">")}static _fromObject(e){let t=ca(e,sFe),i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:r}=i,s=ca(i,oFe);return kv(t,s).then((o=>r?(delete o[r],new this(t[r],o)):new this(o)))}static fromObject(e,t){return this._fromObject(e,t)}};St(XA,"stateProperties",G6e),St(XA,"cacheProperties",jf),St(XA,"ownDefaults",X6e),St(XA,"type","FabricObject"),St(XA,"colorProperties",[bl,uh,"backgroundColor"]),St(XA,"customProperties",[]),Mi.setClass(XA),Mi.setClass(XA,"object");const O1=(n,e,t)=>(i,r,s,o)=>{const a=e(i,r,s,o);return a&&qG(n,Ct(Ct({},JG(i,r,s,o)),t)),a};function H1(n){return(e,t,i,r)=>{const{target:s,originX:o,originY:a}=t,l=s.getRelativeCenterPoint(),h=s.translateToOriginPoint(l,o,a),u=n(e,t,i,r);return s.setPositionByOrigin(h,t.originX,t.originY),u}}const v7=O1(Ow,H1(((n,e,t,i)=>{const r=T8(e,e.originX,e.originY,t,i);if(yl(e.originX)===yl(ns)||yl(e.originX)===yl(il)&&r.x<0||yl(e.originX)===yl(uo)&&r.x>0){const{target:s}=e,o=s.strokeWidth/(s.strokeUniform?s.scaleX:1),a=ZG(e)?2:1,l=s.width,h=Math.abs(r.x*a/s.scaleX)-o;return s.set("width",Math.max(h,1)),l!==s.width}return!1})));function aFe(n,e,t,i,r){i=i||{};const s=this.sizeX||i.cornerSize||r.cornerSize,o=this.sizeY||i.cornerSize||r.cornerSize,a=i.transparentCorners!==void 0?i.transparentCorners:r.transparentCorners,l=a?uh:bl,h=!a&&(i.cornerStrokeColor||r.cornerStrokeColor);let u,d=e,A=t;n.save(),n.fillStyle=i.cornerColor||r.cornerColor||"",n.strokeStyle=i.cornerStrokeColor||r.cornerStrokeColor||"",s>o?(u=s,n.scale(1,o/s),A=t*s/o):o>s?(u=o,n.scale(s/o,1),d=e*o/s):u=s,n.beginPath(),n.arc(d,A,u/2,0,Tf,!1),n[l](),h&&n.stroke(),n.restore()}function lFe(n,e,t,i,r){i=i||{};const s=this.sizeX||i.cornerSize||r.cornerSize,o=this.sizeY||i.cornerSize||r.cornerSize,a=i.transparentCorners!==void 0?i.transparentCorners:r.transparentCorners,l=a?uh:bl,h=!a&&(i.cornerStrokeColor||r.cornerStrokeColor),u=s/2,d=o/2;n.save(),n.fillStyle=i.cornerColor||r.cornerColor||"",n.strokeStyle=i.cornerStrokeColor||r.cornerStrokeColor||"",n.translate(e,t);const A=r.getTotalAngle();n.rotate(La(A)),n["".concat(l,"Rect")](-u,-d,s,o),h&&n.strokeRect(-u,-d,s,o),n.restore()}class id{constructor(e){St(this,"visible",!0),St(this,"actionName",sS),St(this,"angle",0),St(this,"x",0),St(this,"y",0),St(this,"offsetX",0),St(this,"offsetY",0),St(this,"sizeX",0),St(this,"sizeY",0),St(this,"touchSizeX",0),St(this,"touchSizeY",0),St(this,"cursorStyle","crosshair"),St(this,"withConnection",!1),Object.assign(this,e)}shouldActivate(e,t,i,r){var s;let{tl:o,tr:a,br:l,bl:h}=r;return((s=t.canvas)===null||s===void 0?void 0:s.getActiveObject())===t&&t.isControlVisible(e)&&pa.isPointInPolygon(i,[o,a,l,h])}getActionHandler(e,t,i){return this.actionHandler}getMouseDownHandler(e,t,i){return this.mouseDownHandler}getMouseUpHandler(e,t,i){return this.mouseUpHandler}cursorStyleHandler(e,t,i){return t.cursorStyle}getActionName(e,t,i){return t.actionName}getVisibility(e,t){var i,r;return(i=(r=e._controlsVisibility)===null||r===void 0?void 0:r[t])!==null&&i!==void 0?i:this.visible}setVisibility(e,t,i){this.visible=e}positionHandler(e,t,i,r){return new qt(this.x*e.x+this.offsetX,this.y*e.y+this.offsetY).transform(t)}calcCornerCoords(e,t,i,r,s,o){const a=oS([U1(i,r),S0({angle:e}),aS((s?this.touchSizeX:this.sizeX)||t,(s?this.touchSizeY:this.sizeY)||t)]);return{tl:new qt(-.5,-.5).transform(a),tr:new qt(.5,-.5).transform(a),br:new qt(.5,.5).transform(a),bl:new qt(-.5,.5).transform(a)}}render(e,t,i,r,s){((r=r||{}).cornerStyle||s.cornerStyle)==="circle"?aFe.call(this,e,t,i,r,s):lFe.call(this,e,t,i,r,s)}}const cFe=(n,e,t)=>t.lockRotation?I_:e.cursorStyle,hFe=O1(jG,H1(((n,e,t,i)=>{let{target:r,ex:s,ey:o,theta:a,originX:l,originY:h}=e;const u=r.translateToOriginPoint(r.getRelativeCenterPoint(),l,h);if(vd(r,"lockRotation"))return!1;const d=Math.atan2(o-u.y,s-u.x),A=Math.atan2(i-u.y,t-u.x);let f=vA(A-d+a);if(r.snapAngle&&r.snapAngle>0){const g=r.snapAngle,v=r.snapThreshold||g,w=Math.ceil(f/g)*g,m=Math.floor(f/g)*g;Math.abs(f-m)<v?f=m:Math.abs(f-w)<v&&(f=w)}f<0&&(f=360+f),f%=360;const p=r.angle!==f;return r.angle=f,p})));function uX(n,e){const t=e.canvas,i=n[t.uniScaleKey];return t.uniformScaling&&!i||!t.uniformScaling&&i}function dX(n,e,t){const i=vd(n,"lockScalingX"),r=vd(n,"lockScalingY");if(i&&r||!e&&(i||r)&&t||i&&e==="x"||r&&e==="y")return!0;const{width:s,height:o,strokeWidth:a}=n;return s===0&&a===0&&e!=="y"||o===0&&a===0&&e!=="x"}const uFe=["e","se","s","sw","w","nw","n","ne","e"],By=(n,e,t)=>{const i=uX(n,t);if(dX(t,e.x!==0&&e.y===0?"x":e.x===0&&e.y!==0?"y":"",i))return I_;const r=eX(t,e);return"".concat(uFe[r],"-resize")};function D8(n,e,t,i){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const s=e.target,o=r.by,a=uX(n,s);let l,h,u,d,A,f;if(dX(s,o,a))return!1;if(e.gestureScale)h=e.scaleX*e.gestureScale,u=e.scaleY*e.gestureScale;else{if(l=T8(e,e.originX,e.originY,t,i),A=o!=="y"?Math.sign(l.x||e.signX||1):1,f=o!=="x"?Math.sign(l.y||e.signY||1):1,e.signX||(e.signX=A),e.signY||(e.signY=f),vd(s,"lockScalingFlip")&&(e.signX!==A||e.signY!==f))return!1;if(d=s._getTransformedDimensions(),a&&!o){const v=Math.abs(l.x)+Math.abs(l.y),{original:w}=e,m=v/(Math.abs(d.x*w.scaleX/s.scaleX)+Math.abs(d.y*w.scaleY/s.scaleY));h=w.scaleX*m,u=w.scaleY*m}else h=Math.abs(l.x*s.scaleX/d.x),u=Math.abs(l.y*s.scaleY/d.y);ZG(e)&&(h*=2,u*=2),e.signX!==A&&o!=="y"&&(e.originX=o7(e.originX),h*=-1,e.signX=A),e.signY!==f&&o!=="x"&&(e.originY=o7(e.originY),u*=-1,e.signY=f)}const p=s.scaleX,g=s.scaleY;return o?(o==="x"&&s.set(Ah,h),o==="y"&&s.set(nu,u)):(!vd(s,"lockScalingX")&&s.set(Ah,h),!vd(s,"lockScalingY")&&s.set(nu,u)),p!==s.scaleX||g!==s.scaleY}const fb=O1(rS,H1(((n,e,t,i)=>D8(n,e,t,i)))),dFe=O1(rS,H1(((n,e,t,i)=>D8(n,e,t,i,{by:"x"})))),AFe=O1(rS,H1(((n,e,t,i)=>D8(n,e,t,i,{by:"y"})))),fFe=["target","ex","ey","skewingSide"],CT={x:{counterAxis:"y",scale:Ah,skew:M1,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:nu,skew:R1,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},pFe=["ns","nesw","ew","nwse"],gFe=(n,e,t)=>{if(e.x!==0&&vd(t,"lockSkewingY")||e.y!==0&&vd(t,"lockSkewingX"))return I_;const i=eX(t,e)%4;return"".concat(pFe[i],"-resize")};function AX(n,e,t,i,r){const{target:s}=t,{counterAxis:o,origin:a,lockSkewing:l,skew:h,flip:u}=CT[n];if(vd(s,l))return!1;const{origin:d,flip:A}=CT[o],f=yl(t[d])*(s[A]?-1:1),p=-Math.sign(f)*(s[u]?-1:1),g=.5*-((s[h]===0&&T8(t,ns,ns,i,r)[n]>0||s[h]>0?1:-1)*p)+.5;return O1(PG,H1(((w,m,y,x)=>(function(S,I,j){let{target:C,ex:b,ey:D,skewingSide:T}=I,k=ca(I,fFe);const{skew:B}=CT[S],E=j.subtract(new qt(b,D)).divide(new qt(C.scaleX,C.scaleY))[S],z=C[B],te=k[B],L=Math.tan(La(te)),O=S==="y"?C._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:C._getTransformedDimensions({scaleX:1,scaleY:1}).y,J=2*E*T/Math.max(O,1)+L,$=vA(Math.atan(J));C.set(B,$);const U=z!==C[B];if(U&&S==="y"){const{skewX:Y,scaleX:K}=C,V=C._getTransformedDimensions({skewY:z}),Q=C._getTransformedDimensions(),X=Y!==0?V.x/Q.x:1;X!==1&&C.set(Ah,X*K)}return U})(n,m,new qt(y,x)))))(e,Ct(Ct({},t),{},{[a]:g,skewingSide:p}),i,r)}const mFe=(n,e,t,i)=>AX("x",n,e,t,i),yFe=(n,e,t,i)=>AX("y",n,e,t,i);function uS(n,e){return n[e.canvas.altActionKey]}const pb=(n,e,t)=>{const i=uS(n,t);return e.x===0?i?M1:nu:e.y===0?i?R1:Ah:""},_m=(n,e,t)=>uS(n,t)?gFe(0,e,t):By(n,e,t),x7=(n,e,t,i)=>uS(n,e.target)?yFe(n,e,t,i):dFe(n,e,t,i),b7=(n,e,t,i)=>uS(n,e.target)?mFe(n,e,t,i):AFe(n,e,t,i),fX=()=>({ml:new id({x:-.5,y:0,cursorStyleHandler:_m,actionHandler:x7,getActionName:pb}),mr:new id({x:.5,y:0,cursorStyleHandler:_m,actionHandler:x7,getActionName:pb}),mb:new id({x:0,y:.5,cursorStyleHandler:_m,actionHandler:b7,getActionName:pb}),mt:new id({x:0,y:-.5,cursorStyleHandler:_m,actionHandler:b7,getActionName:pb}),tl:new id({x:-.5,y:-.5,cursorStyleHandler:By,actionHandler:fb}),tr:new id({x:.5,y:-.5,cursorStyleHandler:By,actionHandler:fb}),bl:new id({x:-.5,y:.5,cursorStyleHandler:By,actionHandler:fb}),br:new id({x:.5,y:.5,cursorStyleHandler:By,actionHandler:fb}),mtr:new id({x:0,y:-.5,actionHandler:hFe,cursorStyleHandler:cFe,offsetY:-40,withConnection:!0,actionName:y8})}),wFe=()=>({mr:new id({x:.5,y:0,actionHandler:v7,cursorStyleHandler:_m,actionName:Ow}),ml:new id({x:-.5,y:0,actionHandler:v7,cursorStyleHandler:_m,actionName:Ow})}),vFe=()=>Ct(Ct({},fX()),wFe());class Ww extends XA{static getDefaults(){return Ct(Ct({},super.getDefaults()),Ww.ownDefaults)}constructor(e){super(),Object.assign(this,this.constructor.createControls(),Ww.ownDefaults),this.setOptions(e)}static createControls(){return{controls:fX()}}_updateCacheCanvas(){const e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){const t=e._currentTransform,i=t.target,r=t.action;if(this===i&&r&&r.startsWith(sS))return!1}return super._updateCacheCanvas()}getActiveControl(){const e=this.__corner;return e?{key:e,control:this.controls[e],coord:this.oCoords[e]}:void 0}findControl(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const i=Object.entries(this.oCoords);for(let r=i.length-1;r>=0;r--){const[s,o]=i[r],a=this.controls[s];if(a.shouldActivate(s,this,e,t?o.touchCorner:o.corner))return this.__corner=s,{key:s,control:a,coord:this.oCoords[s]}}}calcOCoords(){const e=this.getViewportTransform(),t=this.getCenterPoint(),i=U1(t.x,t.y),r=S0({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),s=ll(i,r),o=ll(e,s),a=ll(o,[1/e[0],0,0,1/e[3],0,0]),l=this.group?c0(this.calcTransformMatrix()):void 0;l&&(l.scaleX=Math.abs(l.scaleX),l.scaleY=Math.abs(l.scaleY));const h=this._calculateCurrentDimensions(l),u={};return this.forEachControl(((d,A)=>{const f=d.positionHandler(h,a,this,d);u[A]=Object.assign(f,this._calcCornerCoords(d,f))})),u}_calcCornerCoords(e,t){const i=this.getTotalAngle();return{corner:e.calcCornerCoords(i,this.cornerSize,t.x,t.y,!1,this),touchCorner:e.calcCornerCoords(i,this.touchCornerSize,t.x,t.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(e){for(const t in this.controls)e(this.controls[t],t,this)}drawSelectionBackground(e){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;e.save();const t=this.getRelativeCenterPoint(),i=this._calculateCurrentDimensions(),r=this.getViewportTransform();e.translate(t.x,t.y),e.scale(1/r[0],1/r[3]),e.rotate(La(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-i.x/2,-i.y/2,i.x,i.y),e.restore()}strokeBorders(e,t){e.strokeRect(-t.x/2,-t.y/2,t.x,t.y)}_drawBorders(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=Ct({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},i);e.save(),e.strokeStyle=r.borderColor,this._setLineDash(e,r.borderDashArray),this.strokeBorders(e,t),r.hasControls&&this.drawControlsConnectingLines(e,t),e.restore()}_renderControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{hasBorders:i,hasControls:r}=this,s=Ct({hasBorders:i,hasControls:r},t),o=this.getViewportTransform(),a=s.hasBorders,l=s.hasControls,h=ll(o,this.calcTransformMatrix()),u=c0(h);e.save(),e.translate(u.translateX,u.translateY),e.lineWidth=this.borderScaleFactor,this.group===this.parent&&(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(u.angle-=180),e.rotate(La(this.group?u.angle:this.angle)),a&&this.drawBorders(e,u,t),l&&this.drawControls(e,t),e.restore()}drawBorders(e,t,i){let r;if(i&&i.forActiveSelection||this.group){const s=lS(this.width,this.height,Fv(t)),o=this.isStrokeAccountedForInDimensions()?w8:(this.strokeUniform?new qt().scalarAdd(this.canvas?this.canvas.getZoom():1):new qt(t.scaleX,t.scaleY)).scalarMultiply(this.strokeWidth);r=s.add(o).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else r=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(e,r,i)}drawControlsConnectingLines(e,t){let i=!1;e.beginPath(),this.forEachControl(((r,s)=>{r.withConnection&&r.getVisibility(this,s)&&(i=!0,e.moveTo(r.x*t.x,r.y*t.y),e.lineTo(r.x*t.x+r.offsetX,r.y*t.y+r.offsetY))})),i&&e.stroke()}drawControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.save();const i=this.getCanvasRetinaScaling(),{cornerStrokeColor:r,cornerDashArray:s,cornerColor:o}=this,a=Ct({cornerStrokeColor:r,cornerDashArray:s,cornerColor:o},t);e.setTransform(i,0,0,i,0,0),e.strokeStyle=e.fillStyle=a.cornerColor,this.transparentCorners||(e.strokeStyle=a.cornerStrokeColor),this._setLineDash(e,a.cornerDashArray),this.forEachControl(((l,h)=>{if(l.getVisibility(this,h)){const u=this.oCoords[h];l.render(e,u.x,u.y,a,this)}})),e.restore()}isControlVisible(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)}setControlVisible(e,t){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=t}setControlsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(e).forEach((t=>{let[i,r]=t;return this.setControlVisible(i,r)}))}clearContextTop(e){if(!this.canvas)return;const t=this.canvas.contextTop;if(!t)return;const i=this.canvas.viewportTransform;t.save(),t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this.transform(t);const r=this.width+4,s=this.height+4;return t.clearRect(-r/2,-s/2,r,s),e||t.restore(),t}onDeselect(e){return!1}onSelect(e){return!1}shouldStartDragging(e){return!1}onDragStart(e){return!1}canDrop(e){return!1}renderDragSourceEffect(e){}renderDropTargetEffect(e){}}function pX(n,e){return e.forEach((t=>{Object.getOwnPropertyNames(t.prototype).forEach((i=>{i!=="constructor"&&Object.defineProperty(n.prototype,i,Object.getOwnPropertyDescriptor(t.prototype,i)||Object.create(null))}))})),n}St(Ww,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class Qc extends Ww{}pX(Qc,[tX]),Mi.setClass(Qc),Mi.setClass(Qc,"object");const gX=(n,e,t,i)=>{const r=2*(i=Math.round(i))+1,{data:s}=n.getImageData(e-i,t-i,r,r);for(let o=3;o<s.length;o+=4)if(s[o]>0)return!1;return!0};class mX{constructor(e){this.options=e,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new qt(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new qt(1/this.options.scaleX,1/this.options.scaleY):new qt(1,1)}createSideVector(e,t){const i=j_(e,t);return this.options.strokeUniform?i.multiply(this.scale):i}projectOrthogonally(e,t,i){return this.applySkew(e.add(this.calcOrthogonalProjection(e,t,i)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(e){const t=new qt(e);return t.y+=t.x*Math.tan(La(this.options.skewY)),t.x+=t.y*Math.tan(La(this.options.skewX)),t}scaleUnitVector(e,t){return e.multiply(this.strokeUniformScalar).scalarMultiply(t)}}const xFe=new qt;class Xm extends mX{static getOrthogonalRotationFactor(e,t){const i=t?N_(e,t):aX(e);return Math.abs(i)<zp?-1:1}constructor(e,t,i,r){super(r),St(this,"AB",void 0),St(this,"AC",void 0),St(this,"alpha",void 0),St(this,"bisector",void 0),this.A=new qt(e),this.B=new qt(t),this.C=new qt(i),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=N_(this.AB,this.AC),this.bisector=hS(E8(this.AB.eq(xFe)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const r=this.createSideVector(e,t),s=F8(r),o=Xm.getOrthogonalRotationFactor(s,this.bisector);return this.scaleUnitVector(s,i*o)}projectBevel(){const e=[];return(this.alpha%Tf==0?[this.B]:[this.B,this.C]).forEach((t=>{e.push(this.projectOrthogonally(this.A,t)),e.push(this.projectOrthogonally(this.A,t,-this.strokeProjectionMagnitude))})),e}projectMiter(){const e=[],t=Math.abs(this.alpha),i=1/Math.sin(t/2),r=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*i),s=this.options.strokeUniform?P_(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return P_(r)/this.strokeProjectionMagnitude<=s&&e.push(this.applySkew(this.A.add(r))),e.push(...this.projectBevel()),e}projectRoundNoSkew(e,t){const i=[],r=new qt(Xm.getOrthogonalRotationFactor(this.bisector),Xm.getOrthogonalRotationFactor(new qt(this.bisector.y,this.bisector.x)));return[new qt(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(r),new qt(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(r)].forEach((s=>{w6(s,e,t)&&i.push(this.A.add(s))})),i}projectRoundWithSkew(e,t){const i=[],{skewX:r,skewY:s,scaleX:o,scaleY:a,strokeUniform:l}=this.options,h=new qt(Math.tan(La(r)),Math.tan(La(s))),u=this.strokeProjectionMagnitude,d=l?u/a/Math.sqrt(1/a**2+1/o**2*h.y**2):u/Math.sqrt(1+h.y**2),A=new qt(Math.sqrt(Math.max(u**2-d**2,0)),d),f=l?u/Math.sqrt(1+h.x**2*(1/a)**2/(1/o+1/o*h.x*h.y)**2):u/Math.sqrt(1+h.x**2/(1+h.x*h.y)**2),p=new qt(f,Math.sqrt(Math.max(u**2-f**2,0)));return[p,p.scalarMultiply(-1),A,A.scalarMultiply(-1)].map((g=>this.applySkew(l?g.multiply(this.strokeUniformScalar):g))).forEach((g=>{w6(g,e,t)&&i.push(this.applySkew(this.A).add(g))})),i}projectRound(){const e=[];e.push(...this.projectBevel());const t=this.alpha%Tf==0,i=this.applySkew(this.A),r=e[t?0:2].subtract(i),s=e[t?1:0].subtract(i),o=t?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),a=Gm(r,o)>0,l=a?r:s,h=a?s:r;return this.isSkewed()?e.push(...this.projectRoundWithSkew(l,h)):e.push(...this.projectRoundNoSkew(l,h)),e}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map((e=>({originPoint:this.A,projectedPoint:e,angle:this.alpha,bisector:this.bisector})))}}class C7 extends mX{constructor(e,t,i){super(i),this.A=new qt(e),this.T=new qt(t)}calcOrthogonalProjection(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const r=this.createSideVector(e,t);return this.scaleUnitVector(F8(r),i)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const e=[];if(!this.isSkewed()&&this.A.eq(this.T)){const t=new qt(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.applySkew(this.A.add(t)),this.applySkew(this.A.subtract(t)))}else e.push(...new Xm(this.A,this.T,this.T,this.options).projectRound());return e}projectSquare(){const e=[];if(this.A.eq(this.T)){const t=new qt(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.A.add(t),this.A.subtract(t))}else{const t=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),i=this.scaleUnitVector(hS(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),r=this.A.add(i);e.push(r.add(t),r.subtract(t))}return e.map((t=>this.applySkew(t)))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map((e=>({originPoint:this.A,projectedPoint:e})))}}const yX=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const i=[];if(n.length===0)return i;const r=n.reduce(((s,o)=>(s[s.length-1].eq(o)||s.push(new qt(o)),s)),[new qt(n[0])]);if(r.length===1)t=!0;else if(!t){const s=r[0],o=((a,l)=>{for(let h=a.length-1;h>=0;h--)if(l(a[h],h,a))return h;return-1})(r,(a=>!a.eq(s)));r.splice(o+1)}return r.forEach(((s,o,a)=>{let l,h;o===0?(h=a[1],l=t?s:a[a.length-1]):o===a.length-1?(l=a[o-1],h=t?s:a[0]):(l=a[o-1],h=a[o+1]),t&&a.length===1?i.push(...new C7(s,s,e).project()):!t||o!==0&&o!==a.length-1?i.push(...new Xm(s,l,h,e).project()):i.push(...new C7(s,o===0?h:l,e).project())})),i},j8=n=>{const e={};return Object.keys(n).forEach((t=>{e[t]={},Object.keys(n[t]).forEach((i=>{e[t][i]=Ct({},n[t][i])}))})),e},wX=n=>n.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;");let y2;const dS=n=>{if(y2||y2||(y2="Intl"in L1()&&"Segmenter"in Intl&&new Intl.Segmenter(void 0,{granularity:"grapheme"})),y2){const e=y2.segment(n);return Array.from(e).map((t=>{let{segment:i}=t;return i}))}return bFe(n)},bFe=n=>{const e=[];for(let t,i=0;i<n.length;i++)(t=CFe(n,i))!==!1&&e.push(t);return e},CFe=(n,e)=>{const t=n.charCodeAt(e);if(isNaN(t))return"";if(t<55296||t>57343)return n.charAt(e);if(55296<=t&&t<=56319){if(n.length<=e+1)throw"High surrogate without following low surrogate";const r=n.charCodeAt(e+1);if(56320>r||r>57343)throw"High surrogate without following low surrogate";return n.charAt(e)+n.charAt(e+1)}if(e===0)throw"Low surrogate without preceding high surrogate";const i=n.charCodeAt(e-1);if(55296>i||i>56319)throw"Low surrogate without preceding high surrogate";return!1};var _Fe=Object.freeze({__proto__:null,capitalize:function(n){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return"".concat(n.charAt(0).toUpperCase()).concat(e?n.slice(1):n.slice(1).toLowerCase())},escapeXml:wX,graphemeSplit:dS});const AS=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return n.fill!==e.fill||n.stroke!==e.stroke||n.strokeWidth!==e.strokeWidth||n.fontSize!==e.fontSize||n.fontFamily!==e.fontFamily||n.fontWeight!==e.fontWeight||n.fontStyle!==e.fontStyle||n.textDecorationThickness!==e.textDecorationThickness||n.textBackgroundColor!==e.textBackgroundColor||n.deltaY!==e.deltaY||t&&(n.overline!==e.overline||n.underline!==e.underline||n.linethrough!==e.linethrough)},vX=(n,e)=>{const t=e.split(`
`),i=[];let r=-1,s={};n=j8(n);for(let o=0;o<t.length;o++){const a=dS(t[o]);if(n[o])for(let l=0;l<a.length;l++){r++;const h=n[o][l];h&&Object.keys(h).length>0&&(AS(s,h,!0)?i.push({start:r,end:r+1,style:h}):i[i.length-1].end++),s=h||{}}else r+=a.length,s={}}return i},xX=(n,e)=>{if(!Array.isArray(n))return j8(n);const t=e.split(m8),i={};let r=-1,s=0;for(let o=0;o<t.length;o++){const a=dS(t[o]);for(let l=0;l<a.length;l++)r++,n[s]&&n[s].start<=r&&r<n[s].end&&(i[o]=i[o]||{},i[o][l]=Ct({},n[s].style),r===n[s].end-1&&s++)}return i},tg=["display","transform",bl,"fill-opacity","fill-rule","opacity",uh,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function _7(n,e){const t=n.nodeName,i=n.getAttribute("class"),r=n.getAttribute("id"),s="(?![a-zA-Z\\-]+)";let o;if(o=new RegExp("^"+t,"i"),e=e.replace(o,""),r&&e.length&&(o=new RegExp("#"+r+s,"i"),e=e.replace(o,"")),i&&e.length){const a=i.split(" ");for(let l=a.length;l--;)o=new RegExp("\\."+a[l]+s,"i"),e=e.replace(o,"")}return e.length===0}function SFe(n,e){let t=!0;const i=_7(n,e.pop());return i&&e.length&&(t=(function(r,s){let o,a=!0;for(;r.parentElement&&r.parentElement.nodeType===1&&s.length;)a&&(o=s.pop()),a=_7(r=r.parentElement,o);return s.length===0})(n,e)),i&&t&&e.length===0}const TFe=n=>{var e;return(e=z6e[n])!==null&&e!==void 0?e:n},BFe=new RegExp("(".concat(pd,")"),"gi"),EFe=n=>n.replace(BFe," $1 ").replace(/,/gi," ").replace(/\s+/gi," ");var S7,T7,B7,E7,F7,k7,I7;const oh="(".concat(pd,")"),FFe=String.raw(S7||(S7=SA(["(skewX)(",")"],["(skewX)\\(","\\)"])),oh),kFe=String.raw(T7||(T7=SA(["(skewY)(",")"],["(skewY)\\(","\\)"])),oh),IFe=String.raw(B7||(B7=SA(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),oh,oh,oh),DFe=String.raw(E7||(E7=SA(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),oh,oh),jFe=String.raw(F7||(F7=SA(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),oh,oh),PFe=String.raw(k7||(k7=SA(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),oh,oh,oh,oh,oh,oh),P8="(?:".concat(PFe,"|").concat(jFe,"|").concat(IFe,"|").concat(DFe,"|").concat(FFe,"|").concat(kFe,")"),NFe="(?:".concat(P8,"*)"),LFe=String.raw(I7||(I7=SA(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),NFe),MFe=new RegExp(LFe),RFe=new RegExp(P8),UFe=new RegExp(P8,"g");function L_(n){const e=[];if(!(n=EFe(n).replace(/\s*([()])\s*/gi,"$1"))||n&&!MFe.test(n))return[...dh];for(const t of n.matchAll(UFe)){const i=RFe.exec(t[0]);if(!i)continue;let r=dh;const s=i.filter((p=>!!p)),[,o,...a]=s,[l,h,u,d,A,f]=a.map((p=>parseFloat(p)));switch(o){case"translate":r=U1(l,h);break;case y8:r=S0({angle:l},{x:h,y:u});break;case sS:r=aS(l,h);break;case M1:r=b8(l);break;case R1:r=C8(l);break;case"matrix":r=[l,h,u,d,A,f]}e.push(r)}return oS(e)}function OFe(n,e,t,i){const r=Array.isArray(e);let s,o=e;if(n!==bl&&n!==uh||e!==hh){if(n==="strokeUniform")return e==="non-scaling-stroke";if(n==="strokeDashArray")o=e===hh?null:e.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(n==="transformMatrix")o=t&&t.transformMatrix?ll(t.transformMatrix,L_(e)):L_(e);else if(n==="visible")o=e!==hh&&e!=="hidden",t&&t.visible===!1&&(o=!1);else if(n==="opacity")o=parseFloat(e),t&&t.opacity!==void 0&&(o*=t.opacity);else if(n==="textAnchor")o=e==="start"?uo:e==="end"?il:ns;else if(n==="charSpacing"||n===h0)s=sh(e,i)/i*1e3;else if(n==="paintFirst"){const a=e.indexOf(bl),l=e.indexOf(uh);o=bl,(a>-1&&l>-1&&l<a||a===-1&&l>-1)&&(o=uh)}else{if(n==="href"||n==="xlink:href"||n==="font"||n==="id")return e;if(n==="imageSmoothing")return e==="optimizeQuality";s=r?e.map(sh):sh(e,i)}}else o="";return!r&&isNaN(s)?o:s}function HFe(n,e){const t=n.match(W6e);if(!t)return;const i=t[1],r=t[3],s=t[4],o=t[5],a=t[6];i&&(e.fontStyle=i),r&&(e.fontWeight=isNaN(parseFloat(r))?r:parseFloat(r)),s&&(e.fontSize=sh(s)),a&&(e.fontFamily=a),o&&(e.lineHeight=o==="normal"?1:o)}function x6(n,e){n.replace(/;\s*$/,"").split(";").forEach((t=>{if(!t)return;const[i,r]=t.split(":");e[i.trim().toLowerCase()]=r.trim()}))}function WFe(n){const e={},t=n.getAttribute("style");return t&&(typeof t=="string"?x6(t,e):(function(i,r){Object.entries(i).forEach((s=>{let[o,a]=s;a!==void 0&&(r[o.toLowerCase()]=a)}))})(t,e)),e}const zFe={stroke:"strokeOpacity",fill:"fillOpacity"};function Pf(n,e,t){if(!n)return{};let i,r={},s=g8;n.parentNode&&f7.test(n.parentNode.nodeName)&&(r=Pf(n.parentElement,e,t),r.fontSize&&(i=s=sh(r.fontSize)));const o=Ct(Ct(Ct({},e.reduce(((h,u)=>{const d=n.getAttribute(u);return d&&(h[u]=d),h}),{})),(function(h){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d={};for(const A in u)SFe(h,A.split(" "))&&(d=Ct(Ct({},d),u[A]));return d})(n,t)),WFe(n));o[vT]&&n.setAttribute(vT,o[vT]),o[wT]&&(i=sh(o[wT],s),o[wT]="".concat(i));const a={};for(const h in o){const u=TFe(h),d=OFe(u,o[h],r,i);a[u]=d}a&&a.font&&HFe(a.font,a);const l=Ct(Ct({},r),a);return f7.test(n.nodeName)?l:(function(h){const u=Qc.getDefaults();return Object.entries(zFe).forEach((d=>{let[A,f]=d;if(h[f]===void 0||h[A]==="")return;if(h[A]===void 0){if(!u[A])return;h[A]=u[A]}if(h[A].indexOf("url(")===0)return;const p=new po(h[A]);h[A]=p.setAlpha(No(p.getAlpha()*h[f],2)).toRgba()})),h})(l)}const QFe=["left","top","width","height","visible"],bX=["rx","ry"];class Xl extends Qc{static getDefaults(){return Ct(Ct({},super.getDefaults()),Xl.ownDefaults)}constructor(e){super(),Object.assign(this,Xl.ownDefaults),this.setOptions(e),this._initRxRy()}_initRxRy(){const{rx:e,ry:t}=this;e&&!t?this.ry=e:t&&!e&&(this.rx=t)}_render(e){const{width:t,height:i}=this,r=-t/2,s=-i/2,o=this.rx?Math.min(this.rx,t/2):0,a=this.ry?Math.min(this.ry,i/2):0,l=o!==0||a!==0;e.beginPath(),e.moveTo(r+o,s),e.lineTo(r+t-o,s),l&&e.bezierCurveTo(r+t-ep*o,s,r+t,s+ep*a,r+t,s+a),e.lineTo(r+t,s+i-a),l&&e.bezierCurveTo(r+t,s+i-ep*a,r+t-ep*o,s+i,r+t-o,s+i),e.lineTo(r+o,s+i),l&&e.bezierCurveTo(r+ep*o,s+i,r,s+i-ep*a,r,s+i-a),e.lineTo(r,s+a),l&&e.bezierCurveTo(r,s+ep*a,r+ep*o,s,r+o,s),e.closePath(),this._renderPaintInOrder(e)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...bX,...e])}_toSVG(){const{width:e,height:t,rx:i,ry:r}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-e/2,'" y="').concat(-t/2,'" rx="').concat(i,'" ry="').concat(r,'" width="').concat(e,'" height="').concat(t,`" />
`)]}static async fromElement(e,t,i){const r=Pf(e,this.ATTRIBUTE_NAMES,i),{left:s=0,top:o=0,width:a=0,height:l=0,visible:h=!0}=r,u=ca(r,QFe);return new this(Ct(Ct(Ct({},t),u),{},{left:s,top:o,width:a,height:l,visible:!!(h&&a&&l)}))}}St(Xl,"type","Rect"),St(Xl,"cacheProperties",[...jf,...bX]),St(Xl,"ownDefaults",{rx:0,ry:0}),St(Xl,"ATTRIBUTE_NAMES",[...tg,"x","y","rx","ry","width","height"]),Mi.setClass(Xl),Mi.setSVGClass(Xl);const hf="initialization",M_="added",N8="removed",R_="imperative",CX=(n,e)=>{const{strokeUniform:t,strokeWidth:i,width:r,height:s,group:o}=e,a=o&&o!==n?Dv(o.calcTransformMatrix(),n.calcTransformMatrix()):null,l=a?e.getRelativeCenterPoint().transform(a):e.getRelativeCenterPoint(),h=!e.isStrokeAccountedForInDimensions(),u=t&&h?KG(new qt(i,i),void 0,n.calcTransformMatrix()):w8,d=!t&&h?i:0,A=lS(r+d,s+d,oS([a,e.calcOwnMatrix()],!0)).add(u).scalarDivide(2);return[l.subtract(A),l.add(A)]};class fS{calcLayoutResult(e,t){if(this.shouldPerformLayout(e))return this.calcBoundingBox(t,e)}shouldPerformLayout(e){let{type:t,prevStrategy:i,strategy:r}=e;return t===hf||t===R_||!!i&&r!==i}shouldLayoutClipPath(e){let{type:t,target:{clipPath:i}}=e;return t!==hf&&i&&!i.absolutePositioned}getInitialSize(e,t){return t.size}calcBoundingBox(e,t){const{type:i,target:r}=t;if(i===R_&&t.overrides)return t.overrides;if(e.length===0)return;const{left:s,top:o,width:a,height:l}=dA(e.map((d=>CX(r,d))).reduce(((d,A)=>d.concat(A)),[])),h=new qt(a,l),u=new qt(s,o).add(h.scalarDivide(2));if(i===hf){const d=this.getInitialSize(t,{size:h,center:u});return{center:u,relativeCorrection:new qt(0,0),size:d}}return{center:u.transform(r.calcOwnMatrix()),size:h}}}St(fS,"type","strategy");class b6 extends fS{shouldPerformLayout(e){return!0}}St(b6,"type","fit-content"),Mi.setClass(b6);const $Fe=["strategy"],VFe=["target","strategy","bubbles","prevStrategy"],_X="layoutManager";class zw{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new b6;St(this,"strategy",void 0),this.strategy=e,this._subscriptions=new Map}performLayout(e){const t=Ct(Ct({bubbles:!0,strategy:this.strategy},e),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(t);const i=this.getLayoutResult(t);i&&this.commitLayout(t,i),this.onAfterLayout(t,i),this._prevLayoutStrategy=t.strategy}attachHandlers(e,t){const{target:i}=t;return[E_,DG,Ow,jG,rS,PG,B_,I6e,D6e].map((r=>e.on(r,(s=>this.performLayout(r===E_?{type:"object_modified",trigger:r,e:s,target:i}:{type:"object_modifying",trigger:r,e:s,target:i})))))}subscribe(e,t){this.unsubscribe(e,t);const i=this.attachHandlers(e,t);this._subscriptions.set(e,i)}unsubscribe(e,t){(this._subscriptions.get(e)||[]).forEach((i=>i())),this._subscriptions.delete(e)}unsubscribeTargets(e){e.targets.forEach((t=>this.unsubscribe(t,e)))}subscribeTargets(e){e.targets.forEach((t=>this.subscribe(t,e)))}onBeforeLayout(e){const{target:t,type:i}=e,{canvas:r}=t;if(i===hf||i===M_?this.subscribeTargets(e):i===N8&&this.unsubscribeTargets(e),t.fire("layout:before",{context:e}),r&&r.fire("object:layout:before",{target:t,context:e}),i===R_&&e.deep){const s=ca(e,$Fe);t.forEachObject((o=>o.layoutManager&&o.layoutManager.performLayout(Ct(Ct({},s),{},{bubbles:!1,target:o}))))}}getLayoutResult(e){const{target:t,strategy:i,type:r}=e,s=i.calcLayoutResult(e,t.getObjects());if(!s)return;const o=r===hf?new qt:t.getRelativeCenterPoint(),{center:a,correction:l=new qt,relativeCorrection:h=new qt}=s,u=o.subtract(a).add(l).transform(r===hf?dh:Dh(t.calcOwnMatrix()),!0).add(h);return{result:s,prevCenter:o,nextCenter:a,offset:u}}commitLayout(e,t){const{target:i}=e,{result:{size:r},nextCenter:s}=t;var o,a;i.set({width:r.x,height:r.y}),this.layoutObjects(e,t),e.type===hf?i.set({left:(o=e.x)!==null&&o!==void 0?o:s.x+r.x*yl(i.originX),top:(a=e.y)!==null&&a!==void 0?a:s.y+r.y*yl(i.originY)}):(i.setPositionByOrigin(s,ns,ns),i.setCoords(),i.set("dirty",!0))}layoutObjects(e,t){const{target:i}=e;i.forEachObject((r=>{r.group===i&&this.layoutObject(e,t,r)})),e.strategy.shouldLayoutClipPath(e)&&this.layoutObject(e,t,i.clipPath)}layoutObject(e,t,i){let{offset:r}=t;i.set({left:i.left+r.x,top:i.top+r.y})}onAfterLayout(e,t){const{target:i,strategy:r,bubbles:s,prevStrategy:o}=e,a=ca(e,VFe),{canvas:l}=i;i.fire("layout:after",{context:e,result:t}),l&&l.fire("object:layout:after",{context:e,result:t,target:i});const h=i.parent;s&&h!=null&&h.layoutManager&&((a.path||(a.path=[])).push(i),h.layoutManager.performLayout(Ct(Ct({},a),{},{target:h}))),i.set("dirty",!0)}dispose(){const{_subscriptions:e}=this;e.forEach((t=>t.forEach((i=>i())))),e.clear()}toObject(){return{type:_X,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}}Mi.setClass(zw,_X);const GFe=["type","objects","layoutManager"];class XFe extends zw{performLayout(){}}class Jh extends NG(Qc){static getDefaults(){return Ct(Ct({},super.getDefaults()),Jh.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),St(this,"_activeObjects",[]),St(this,"__objectSelectionTracker",void 0),St(this,"__objectSelectionDisposer",void 0),Object.assign(this,Jh.ownDefaults),this.setOptions(t),this.groupInit(e,t)}groupInit(e,t){var i;this._objects=[...e],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject((r=>{this.enterGroup(r,!1)})),this.layoutManager=(i=t.layoutManager)!==null&&i!==void 0?i:new zw,this.layoutManager.performLayout({type:hf,target:this,targets:[...e],x:t.left,y:t.top})}canEnterGroup(e){return e===this||this.isDescendantOf(e)?(Sf("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(e)===-1||(Sf("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(e){return e.filter(((t,i,r)=>this.canEnterGroup(t)&&r.indexOf(t)===i))}add(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const r=this._filterObjectsBeforeEnteringGroup(t),s=super.add(...r);return this._onAfterObjectsChange(M_,r),s}insertAt(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];const s=this._filterObjectsBeforeEnteringGroup(i),o=super.insertAt(e,...s);return this._onAfterObjectsChange(M_,s),o}remove(){const e=super.remove(...arguments);return this._onAfterObjectsChange(N8,e),e}_onObjectAdded(e){this.enterGroup(e,!0),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e,t){this.exitGroup(e,t),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onAfterObjectsChange(e,t){this.layoutManager.performLayout({type:e,targets:t,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(e,t){const i=this[e];return super._set(e,t),e==="canvas"&&i!==t&&(this._objects||[]).forEach((r=>{r._set(e,t)})),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(e,t){let{target:i}=t;const r=this._activeObjects;if(e)r.push(i),this._set("dirty",!0);else if(r.length>0){const s=r.indexOf(i);s>-1&&(r.splice(s,1),this._set("dirty",!0))}}_watchObject(e,t){e&&this._watchObject(!1,t),e?(t.on("selected",this.__objectSelectionTracker),t.on("deselected",this.__objectSelectionDisposer)):(t.off("selected",this.__objectSelectionTracker),t.off("deselected",this.__objectSelectionDisposer))}enterGroup(e,t){e.group&&e.group.remove(e),e._set("parent",this),this._enterGroup(e,t)}_enterGroup(e,t){t&&g1(e,ll(Dh(this.calcTransformMatrix()),e.calcTransformMatrix())),this._shouldSetNestedCoords()&&e.setCoords(),e._set("group",this),e._set("canvas",this.canvas),this._watchObject(!0,e);const i=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();i&&(i===e||e.isDescendantOf(i))&&this._activeObjects.push(e)}exitGroup(e,t){this._exitGroup(e,t),e._set("parent",void 0),e._set("canvas",void 0)}_exitGroup(e,t){e._set("group",void 0),t||(g1(e,ll(this.calcTransformMatrix(),e.calcTransformMatrix())),e.setCoords()),this._watchObject(!1,e);const i=this._activeObjects.length>0?this._activeObjects.indexOf(e):-1;i>-1&&this._activeObjects.splice(i,1)}shouldCache(){const e=Qc.prototype.shouldCache.call(this);if(e){for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return this.ownCaching=!1,!1}return e}willDrawShadow(){if(super.willDrawShadow())return!0;for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(e,t,i){this._renderBackground(e);for(let s=0;s<this._objects.length;s++){var r;const o=this._objects[s];(r=this.canvas)!==null&&r!==void 0&&r.preserveObjectStacking&&o.group!==this?(e.save(),e.transform(...Dh(this.calcTransformMatrix())),o.render(e),e.restore()):o.group===this&&o.render(e)}this._drawClipPath(e,this.clipPath,i)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject((e=>e.setCoords()))}triggerLayout(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(Ct({target:this,type:R_},e))}render(e){this._transformDone=!0,super.render(e),this._transformDone=!1}__serializeObjects(e,t){const i=this.includeDefaultValues;return this._objects.filter((function(r){return!r.excludeFromExport})).map((function(r){const s=r.includeDefaultValues;r.includeDefaultValues=i;const o=r[e||"toObject"](t);return r.includeDefaultValues=s,o}))}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.layoutManager.toObject();return Ct(Ct(Ct({},super.toObject(["subTargetCheck","interactive",...e])),t.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:t}:{}),{},{objects:this.__serializeObjects("toObject",e)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject((e=>{this._watchObject(!1,e),e.dispose()})),super.dispose()}_createSVGBgRect(e){if(!this.backgroundColor)return"";const t=Xl.prototype._toSVG.call(this),i=t.indexOf("COMMON_PARTS");t[i]='for="group" ';const r=t.join("");return e?e(r):r}_toSVG(e){const t=["<g ","COMMON_PARTS",` >
`],i=this._createSVGBgRect(e);i&&t.push("		",i);for(let r=0;r<this._objects.length;r++)t.push("		",this._objects[r].toSVG(e));return t.push(`</g>
`),t}getSvgStyles(){const e=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",t=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),t].join("")}toClipPathSVG(e){const t=[],i=this._createSVGBgRect(e);i&&t.push("	",i);for(let r=0;r<this._objects.length;r++)t.push("	",this._objects[r].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(t,{reviver:e})}static fromObject(e,t){let{type:i,objects:r=[],layoutManager:s}=e,o=ca(e,GFe);return Promise.all([f1(r,t),kv(o,t)]).then((a=>{let[l,h]=a;const u=new this(l,Ct(Ct(Ct({},o),h),{},{layoutManager:new XFe}));if(s){const d=Mi.getClass(s.type),A=Mi.getClass(s.strategy);u.layoutManager=new d(new A)}else u.layoutManager=new zw;return u.layoutManager.subscribeTargets({type:hf,target:u,targets:u.getObjects()}),u.setCoords(),u}))}}St(Jh,"type","Group"),St(Jh,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),Mi.setClass(Jh);const SX=(n,e)=>Math.min(e.width/n.width,e.height/n.height),TX=(n,e)=>Math.max(e.width/n.width,e.height/n.height),C6="\\s*,?\\s*",w2="".concat(C6,"(").concat(pd,")"),YFe="".concat(w2).concat(w2).concat(w2).concat(C6,"([01])").concat(C6,"([01])").concat(w2).concat(w2),KFe={m:"l",M:"L"},qFe=(n,e,t,i,r,s,o,a,l,h,u)=>{const d=Td(n),A=Bd(n),f=Td(e),p=Bd(e),g=t*r*f-i*s*p+o,v=i*r*f+t*s*p+a;return["C",h+l*(-t*r*A-i*s*d),u+l*(-i*r*A+t*s*d),g+l*(t*r*p+i*s*f),v+l*(i*r*p-t*s*f),g,v]},D7=(n,e,t,i)=>{const r=Math.atan2(e,n),s=Math.atan2(i,t);return s>=r?s-r:2*Math.PI-(r-s)};function _6(n,e,t,i,r,s,o,a){let l;if(Ys.cachesBoundsOfCurve&&(l=[...arguments].join(),aw.boundsOfCurveCache[l]))return aw.boundsOfCurveCache[l];const h=Math.sqrt,u=Math.abs,d=[],A=[[0,0],[0,0]];let f=6*n-12*t+6*r,p=-3*n+9*t-9*r+3*o,g=3*t-3*n;for(let x=0;x<2;++x){if(x>0&&(f=6*e-12*i+6*s,p=-3*e+9*i-9*s+3*a,g=3*i-3*e),u(p)<1e-12){if(u(f)<1e-12)continue;const b=-g/f;0<b&&b<1&&d.push(b);continue}const S=f*f-4*g*p;if(S<0)continue;const I=h(S),j=(-f+I)/(2*p);0<j&&j<1&&d.push(j);const C=(-f-I)/(2*p);0<C&&C<1&&d.push(C)}let v=d.length;const w=v,m=EX(n,e,t,i,r,s,o,a);for(;v--;){const{x,y:S}=m(d[v]);A[0][v]=x,A[1][v]=S}A[0][w]=n,A[1][w]=e,A[0][w+1]=o,A[1][w+1]=a;const y=[new qt(Math.min(...A[0]),Math.min(...A[1])),new qt(Math.max(...A[0]),Math.max(...A[1]))];return Ys.cachesBoundsOfCurve&&(aw.boundsOfCurveCache[l]=y),y}const ZFe=(n,e,t)=>{let[i,r,s,o,a,l,h,u]=t;const d=((A,f,p,g,v,w,m)=>{if(p===0||g===0)return[];let y=0,x=0,S=0;const I=Math.PI,j=m*p8,C=Bd(j),b=Td(j),D=.5*(-b*A-C*f),T=.5*(-b*f+C*A),k=p**2,B=g**2,E=T**2,z=D**2,te=k*B-k*E-B*z;let L=Math.abs(p),O=Math.abs(g);if(te<0){const de=Math.sqrt(1-te/(k*B));L*=de,O*=de}else S=(v===w?-1:1)*Math.sqrt(te/(k*E+B*z));const J=S*L*T/O,$=-S*O*D/L,U=b*J-C*$+.5*A,Y=C*J+b*$+.5*f;let K=D7(1,0,(D-J)/L,(T-$)/O),V=D7((D-J)/L,(T-$)/O,(-D-J)/L,(-T-$)/O);w===0&&V>0?V-=2*I:w===1&&V<0&&(V+=2*I);const Q=Math.ceil(Math.abs(V/I*2)),X=[],W=V/Q,se=8/3*Math.sin(W/4)*Math.sin(W/4)/Math.sin(W/2);let q=K+W;for(let de=0;de<Q;de++)X[de]=qFe(K,q,b,C,L,O,U,Y,se,y,x),y=X[de][5],x=X[de][6],K=q,q+=W;return X})(h-n,u-e,r,s,a,l,o);for(let A=0,f=d.length;A<f;A++)d[A][1]+=n,d[A][2]+=e,d[A][3]+=n,d[A][4]+=e,d[A][5]+=n,d[A][6]+=e;return d},BX=n=>{let e=0,t=0,i=0,r=0;const s=[];let o,a=0,l=0;for(const h of n){const u=[...h];let d;switch(u[0]){case"l":u[1]+=e,u[2]+=t;case"L":e=u[1],t=u[2],d=["L",e,t];break;case"h":u[1]+=e;case"H":e=u[1],d=["L",e,t];break;case"v":u[1]+=t;case"V":t=u[1],d=["L",e,t];break;case"m":u[1]+=e,u[2]+=t;case"M":e=u[1],t=u[2],i=u[1],r=u[2],d=["M",e,t];break;case"c":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t,u[5]+=e,u[6]+=t;case"C":a=u[3],l=u[4],e=u[5],t=u[6],d=["C",u[1],u[2],a,l,e,t];break;case"s":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t;case"S":o==="C"?(a=2*e-a,l=2*t-l):(a=e,l=t),e=u[3],t=u[4],d=["C",a,l,u[1],u[2],e,t],a=d[3],l=d[4];break;case"q":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t;case"Q":a=u[1],l=u[2],e=u[3],t=u[4],d=["Q",a,l,e,t];break;case"t":u[1]+=e,u[2]+=t;case"T":o==="Q"?(a=2*e-a,l=2*t-l):(a=e,l=t),e=u[1],t=u[2],d=["Q",a,l,e,t];break;case"a":u[6]+=e,u[7]+=t;case"A":ZFe(e,t,u).forEach((A=>s.push(A))),e=u[6],t=u[7];break;case"z":case"Z":e=i,t=r,d=["Z"]}d?(s.push(d),o=d[0]):o=""}return s},U_=(n,e,t,i)=>Math.sqrt((t-n)**2+(i-e)**2),EX=(n,e,t,i,r,s,o,a)=>l=>{const h=l**3,u=(f=>3*f**2*(1-f))(l),d=(f=>3*f*(1-f)**2)(l),A=(f=>(1-f)**3)(l);return new qt(o*h+r*u+t*d+n*A,a*h+s*u+i*d+e*A)},FX=n=>n**2,kX=n=>2*n*(1-n),IX=n=>(1-n)**2,JFe=(n,e,t,i,r,s,o,a)=>l=>{const h=FX(l),u=kX(l),d=IX(l),A=3*(d*(t-n)+u*(r-t)+h*(o-r)),f=3*(d*(i-e)+u*(s-i)+h*(a-s));return Math.atan2(f,A)},eke=(n,e,t,i,r,s)=>o=>{const a=FX(o),l=kX(o),h=IX(o);return new qt(r*a+t*l+n*h,s*a+i*l+e*h)},tke=(n,e,t,i,r,s)=>o=>{const a=1-o,l=2*(a*(t-n)+o*(r-t)),h=2*(a*(i-e)+o*(s-i));return Math.atan2(h,l)},j7=(n,e,t)=>{let i=new qt(e,t),r=0;for(let s=1;s<=100;s+=1){const o=n(s/100);r+=U_(i.x,i.y,o.x,o.y),i=o}return r},nke=(n,e)=>{let t,i=0,r=0,s={x:n.x,y:n.y},o=Ct({},s),a=.01,l=0;const h=n.iterator,u=n.angleFinder;for(;r<e&&a>1e-4;)o=h(i),l=i,t=U_(s.x,s.y,o.x,o.y),t+r>e?(i-=a,a/=2):(s=o,i+=a,r+=t);return Ct(Ct({},o),{},{angle:u(l)})},L8=n=>{let e,t,i=0,r=0,s=0,o=0,a=0;const l=[];for(const h of n){const u={x:r,y:s,command:h[0],length:0};switch(h[0]){case"M":t=u,t.x=o=r=h[1],t.y=a=s=h[2];break;case"L":t=u,t.length=U_(r,s,h[1],h[2]),r=h[1],s=h[2];break;case"C":e=EX(r,s,h[1],h[2],h[3],h[4],h[5],h[6]),t=u,t.iterator=e,t.angleFinder=JFe(r,s,h[1],h[2],h[3],h[4],h[5],h[6]),t.length=j7(e,r,s),r=h[5],s=h[6];break;case"Q":e=eke(r,s,h[1],h[2],h[3],h[4]),t=u,t.iterator=e,t.angleFinder=tke(r,s,h[1],h[2],h[3],h[4]),t.length=j7(e,r,s),r=h[3],s=h[4];break;case"Z":t=u,t.destX=o,t.destY=a,t.length=U_(r,s,o,a),r=o,s=a}i+=t.length,l.push(t)}return l.push({length:i,x:r,y:s}),l},DX=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:L8(n),i=0;for(;e-t[i].length>0&&i<t.length-2;)e-=t[i].length,i++;const r=t[i],s=e/r.length,o=n[i];switch(r.command){case"M":return{x:r.x,y:r.y,angle:0};case"Z":return Ct(Ct({},new qt(r.x,r.y).lerp(new qt(r.destX,r.destY),s)),{},{angle:Math.atan2(r.destY-r.y,r.destX-r.x)});case"L":return Ct(Ct({},new qt(r.x,r.y).lerp(new qt(o[1],o[2]),s)),{},{angle:Math.atan2(o[2]-r.y,o[1]-r.x)});case"C":case"Q":return nke(r,e)}},ike=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),P7=new RegExp(YFe,"g"),rke=new RegExp(pd,"gi"),ske={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},jX=n=>{var e;const t=[],i=(e=n.match(ike))!==null&&e!==void 0?e:[];for(const r of i){const s=r[0];if(s==="z"||s==="Z"){t.push([s]);continue}const o=ske[s.toLowerCase()];let a=[];if(s==="a"||s==="A"){P7.lastIndex=0;for(let l=null;l=P7.exec(r);)a.push(...l.slice(1))}else a=r.match(rke)||[];for(let l=0;l<a.length;l+=o){const h=new Array(o),u=KFe[s];h[0]=l>0&&u?u:s;for(let d=0;d<o;d++)h[d+1]=parseFloat(a[l+d]);t.push(h)}}return t},oke=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=new qt(n[0]),i=new qt(n[1]),r=1,s=0;const o=[],a=n.length,l=a>2;let h;for(l&&(r=n[2].x<i.x?-1:n[2].x===i.x?0:1,s=n[2].y<i.y?-1:n[2].y===i.y?0:1),o.push(["M",t.x-r*e,t.y-s*e]),h=1;h<a;h++){if(!t.eq(i)){const u=t.midPointFrom(i);o.push(["Q",t.x,t.y,u.x,u.y])}t=n[h],h+1<n.length&&(i=n[h+1])}return l&&(r=t.x>n[h-2].x?1:t.x===n[h-2].x?0:-1,s=t.y>n[h-2].y?1:t.y===n[h-2].y?0:-1),o.push(["L",t.x+r*e,t.y+s*e]),o},PX=(n,e)=>n.map((t=>t.map(((i,r)=>r===0||e===void 0?i:No(i,e))).join(" "))).join(" ");function O_(n,e){const t=n.style;t&&e&&(typeof e=="string"?t.cssText+=";"+e:Object.entries(e).forEach((i=>{let[r,s]=i;return t.setProperty(r,s)})))}const ake=(n,e)=>Math.floor(Math.random()*(e-n+1))+n;function lke(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=e.onComplete||Xg,i=new(L1()).XMLHttpRequest,r=e.signal,s=function(){i.abort()},o=function(){r&&r.removeEventListener("abort",s),i.onerror=i.ontimeout=Xg};if(r&&r.aborted)throw new f8("request");return r&&r.addEventListener("abort",s,{once:!0}),i.onreadystatechange=function(){i.readyState===4&&(o(),t(i),i.onreadystatechange=Xg)},i.onerror=i.ontimeout=o,i.open("get",n,!0),i.send(),i}const gC=(n,e)=>{let t=n._findCenterFromElement();n.transformMatrix&&((i=>{if(i.transformMatrix){const{scaleX:r,scaleY:s,angle:o,skewX:a}=c0(i.transformMatrix);i.flipX=!1,i.flipY=!1,i.set(Ah,r),i.set(nu,s),i.angle=o,i.skewX=a,i.skewY=0}})(n),t=t.transform(n.transformMatrix)),delete n.transformMatrix,e&&(n.scaleX*=e.scaleX,n.scaleY*=e.scaleY,n.cropX=e.cropX,n.cropY=e.cropY,t.x+=e.offsetLeft,t.y+=e.offsetTop,n.width=e.width,n.height=e.height),n.setPositionByOrigin(t,ns,ns)};var cke=Object.freeze({__proto__:null,addTransformToObject:XG,animate:I8,animateColor:hX,applyTransformToObject:g1,calcAngleBetweenVectors:N_,calcDimensionsMatrix:Fv,calcPlaneChangeMatrix:Dv,calcVectorRotation:aX,cancelAnimFrame:MG,capValue:u0,composeMatrix:WG,copyCanvasElement:n=>{var e;const t=iu(n);return(e=t.getContext("2d"))===null||e===void 0||e.drawImage(n,0,0),t},cos:Td,createCanvasElement:wA,createImage:RG,createRotateMatrix:S0,createScaleMatrix:aS,createSkewXMatrix:b8,createSkewYMatrix:C8,createTranslateMatrix:U1,createVector:j_,crossProduct:Gm,degreesToRadians:La,dotProduct:lX,ease:Y6e,enlivenObjectEnlivables:kv,enlivenObjects:f1,findScaleToCover:TX,findScaleToFit:SX,getBoundsOfCurve:_6,getOrthonormalVector:F8,getPathSegmentsInfo:L8,getPointOnPath:DX,getPointer:GG,getRandomInt:ake,getRegularPolygonPath:(n,e)=>{const t=2*Math.PI/n;let i=-zp;n%2==0&&(i+=t/2);const r=new Array(n+1);for(let s=0;s<n;s++){const o=s*t+i,{x:a,y:l}=new qt(Td(o),Bd(o)).scalarMultiply(e);r[s]=[s===0?"M":"L",a,l]}return r[n]=["Z"],r},getSmoothPathFromPoints:oke,getSvgAttributes:n=>{const e=["instantiated_by_use","style","id","class"];switch(n){case"linearGradient":return e.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);case"radialGradient":return e.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);case"stop":return e.concat(["offset","stop-color","stop-opacity"])}return e},getUnitVector:hS,groupSVGElements:(n,e)=>n&&n.length===1?n[0]:new Jh(n,e),hasStyleChanged:AS,invertTransform:Dh,isBetweenVectors:w6,isIdentityMatrix:UG,isTouchEvent:k_,isTransparent:gX,joinPath:PX,loadImage:cw,magnitude:P_,makeBoundingBoxFromPoints:dA,makePathSimpler:BX,matrixToSVG:p1,mergeClipPaths:(n,e)=>{var t;let i=n,r=e;i.inverted&&!r.inverted&&(i=e,r=n),m6(r,(t=r.group)===null||t===void 0?void 0:t.calcTransformMatrix(),i.calcTransformMatrix());const s=i.inverted&&r.inverted;return s&&(i.inverted=r.inverted=!1),new Jh([i],{clipPath:r,inverted:s})},multiplyTransformMatrices:ll,multiplyTransformMatrixArray:oS,parsePath:jX,parsePreserveAspectRatioAttribute:B8,parseUnit:sh,pick:T0,projectStrokeOnPoints:yX,qrDecompose:c0,radiansToDegrees:vA,removeFromArray:kg,removeTransformFromObject:(n,e)=>{const t=Dh(e),i=ll(t,n.calcOwnMatrix());g1(n,i)},removeTransformMatrixForSvgParsing:gC,request:lke,requestAnimFrame:lw,resetObjectTransform:YG,rotatePoint:(n,e,t)=>n.rotate(t,e),rotateVector:E8,saveObjectTransform:S8,sendObjectToPlane:m6,sendPointToPlane:Yg,sendVectorToPlane:KG,setStyle:O_,sin:Bd,sizeAfterTransform:lS,string:_Fe,stylesFromArray:xX,stylesToArray:vX,toBlob:x8,toDataURL:v8,toFixed:No,transformPath:(n,e,t)=>(t&&(e=ll(e,[1,0,0,1,-t.x,-t.y])),n.map((i=>{const r=[...i];for(let s=1;s<i.length-1;s+=2){const{x:o,y:a}=Hc({x:i[s],y:i[s+1]},e);r[s]=o,r[s+1]=a}return r}))),transformPoint:Hc});class hke extends VG{constructor(e){let{allowTouchScrolling:t=!1,containerClass:i=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),St(this,"upper",void 0),St(this,"container",void 0);const{el:r}=this.lower,s=this.createUpperCanvas();this.upper={el:s,ctx:s.getContext("2d")},this.applyCanvasStyle(r,{allowTouchScrolling:t}),this.applyCanvasStyle(s,{allowTouchScrolling:t,styles:{position:"absolute",left:"0",top:"0"}});const o=this.createContainerElement();o.classList.add(i),r.parentNode&&r.parentNode.replaceChild(o,r),o.append(r,s),this.container=o}createUpperCanvas(){const{el:e}=this.lower,t=wA();return t.className=e.className,t.classList.remove("lower-canvas"),t.classList.add("upper-canvas"),t.setAttribute("data-fabric","top"),t.style.cssText=e.style.cssText,t.setAttribute("draggable","true"),t}createContainerElement(){const e=N1().createElement("div");return e.setAttribute("data-fabric","wrapper"),O_(e,{position:"relative"}),r7(e),e}applyCanvasStyle(e,t){const{styles:i,allowTouchScrolling:r}=t;O_(e,Ct(Ct({},i),{},{"touch-action":r?"manipulation":hh})),r7(e)}setDimensions(e,t){super.setDimensions(e,t);const{el:i,ctx:r}=this.upper;$G(i,r,e,t)}setCSSDimensions(e){super.setCSSDimensions(e),g6(this.upper.el,e),g6(this.container,e)}cleanupDOM(e){const t=this.container,{el:i}=this.lower,{el:r}=this.upper;super.cleanupDOM(e),t.removeChild(r),t.removeChild(i),t.parentNode&&t.parentNode.replaceChild(i,t)}dispose(){super.dispose(),yA().dispose(this.upper.el),delete this.upper,delete this.container}}class pS extends Iv{constructor(){super(...arguments),St(this,"targets",[]),St(this,"_hoveredTargets",[]),St(this,"_objectsToRender",void 0),St(this,"_currentTransform",null),St(this,"_groupSelector",null),St(this,"contextTopDirty",!1)}static getDefaults(){return Ct(Ct({},super.getDefaults()),pS.ownDefaults)}get upperCanvasEl(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.el}get contextTop(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.ctx}get wrapperEl(){return this.elements.container}initElements(e){this.elements=new hke(e,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(e){this._objectsToRender=void 0,super._onObjectAdded(e)}_onObjectRemoved(e){this._objectsToRender=void 0,e===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[e]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[e]}),e.fire("deselected",{target:e})),e===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(e)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const e=this._activeObject;return!this.preserveObjectStacking&&e?this._objects.filter((t=>!t.group&&t!==e)).concat(e):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()}renderTop(){const e=this.contextTop;this.clearContext(e),this.renderTopLayer(e),this.fire("after:render",{ctx:e})}setTargetFindTolerance(e){e=Math.round(e),this.targetFindTolerance=e;const t=this.getRetinaScaling(),i=Math.ceil((2*e+1)*t);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=i,this.pixelFindContext.scale(t,t)}isTargetTransparent(e,t,i){const r=this.targetFindTolerance,s=this.pixelFindContext;this.clearContext(s),s.save(),s.translate(-t+r,-i+r),s.transform(...this.viewportTransform);const o=e.selectionBackgroundColor;e.selectionBackgroundColor="",e.render(s),e.selectionBackgroundColor=o,s.restore();const a=Math.round(r*this.getRetinaScaling());return gX(s,a,a,a)}_isSelectionKeyPressed(e){const t=this.selectionKey;return!!t&&(Array.isArray(t)?!!t.find((i=>!!i&&e[i]===!0)):e[t])}_shouldClearSelection(e,t){const i=this.getActiveObjects(),r=this._activeObject;return!!(!t||t&&r&&i.length>1&&i.indexOf(t)===-1&&r!==t&&!this._isSelectionKeyPressed(e)||t&&!t.evented||t&&!t.selectable&&r&&r!==t)}_shouldCenterTransform(e,t,i){if(!e)return;let r;return t===sS||t===Ah||t===nu||t===Ow?r=this.centeredScaling||e.centeredScaling:t===y8&&(r=this.centeredRotation||e.centeredRotation),r?!i:i}_getOriginFromCorner(e,t){const i={x:e.originX,y:e.originY};return t&&(["ml","tl","bl"].includes(t)?i.x=il:["mr","tr","br"].includes(t)&&(i.x=uo),["tl","mt","tr"].includes(t)?i.y=p6:["bl","mb","br"].includes(t)&&(i.y=Ph)),i}_setupCurrentTransform(e,t,i){var r;const s=t.group?Yg(this.getScenePoint(e),void 0,t.group.calcTransformMatrix()):this.getScenePoint(e),{key:o="",control:a}=t.getActiveControl()||{},l=i&&a?(r=a.getActionHandler(e,t,a))===null||r===void 0?void 0:r.bind(a):U6e,h=((f,p,g,v)=>{if(!p||!f)return"drag";const w=v.controls[p];return w.getActionName(g,w,v)})(i,o,e,t),u=e[this.centeredKey],d=this._shouldCenterTransform(t,h,u)?{x:ns,y:ns}:this._getOriginFromCorner(t,o),A={target:t,action:h,actionHandler:l,actionPerformed:!1,corner:o,scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,offsetX:s.x-t.left,offsetY:s.y-t.top,originX:d.x,originY:d.y,ex:s.x,ey:s.y,lastX:s.x,lastY:s.y,theta:La(t.angle),width:t.width,height:t.height,shiftKey:e.shiftKey,altKey:u,original:Ct(Ct({},S8(t)),{},{originX:d.x,originY:d.y})};this._currentTransform=A,this.fire("before:transform",{e,transform:A})}setCursor(e){this.upperCanvasEl.style.cursor=e}_drawSelection(e){const{x:t,y:i,deltaX:r,deltaY:s}=this._groupSelector,o=new qt(t,i).transform(this.viewportTransform),a=new qt(t+r,i+s).transform(this.viewportTransform),l=this.selectionLineWidth/2;let h=Math.min(o.x,a.x),u=Math.min(o.y,a.y),d=Math.max(o.x,a.x),A=Math.max(o.y,a.y);this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(h,u,d-h,A-u)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,h+=l,u+=l,d-=l,A-=l,Qc.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(h,u,d-h,A-u))}findTarget(e){if(this.skipTargetFind)return;const t=this.getViewportPoint(e),i=this._activeObject,r=this.getActiveObjects();if(this.targets=[],i&&r.length>=1){if(i.findControl(t,k_(e))||r.length>1&&this.searchPossibleTargets([i],t))return i;if(i===this.searchPossibleTargets([i],t)){if(this.preserveObjectStacking){const s=this.targets;this.targets=[];const o=this.searchPossibleTargets(this._objects,t);return e[this.altSelectionKey]&&o&&o!==i?(this.targets=s,i):o}return i}}return this.searchPossibleTargets(this._objects,t)}_pointIsInObjectSelectionArea(e,t){let i=e.getCoords();const r=this.getZoom(),s=e.padding/r;if(s){const[o,a,l,h]=i,u=Math.atan2(a.y-o.y,a.x-o.x),d=Td(u)*s,A=Bd(u)*s,f=d+A,p=d-A;i=[new qt(o.x-p,o.y-f),new qt(a.x+f,a.y-p),new qt(l.x+p,l.y+f),new qt(h.x-f,h.y+p)]}return pa.isPointInPolygon(t,i)}_checkTarget(e,t){return!!(e&&e.visible&&e.evented&&this._pointIsInObjectSelectionArea(e,Yg(t,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing||!this.isTargetTransparent(e,t.x,t.y)))}_searchPossibleTargets(e,t){let i=e.length;for(;i--;){const r=e[i];if(this._checkTarget(r,t)){if(fC(r)&&r.subTargetCheck){const s=this._searchPossibleTargets(r._objects,t);s&&this.targets.push(s)}return r}}}searchPossibleTargets(e,t){const i=this._searchPossibleTargets(e,t);if(i&&fC(i)&&i.interactive&&this.targets[0]){const r=this.targets;for(let s=r.length-1;s>0;s--){const o=r[s];if(!fC(o)||!o.interactive)return o}return r[0]}return i}getViewportPoint(e){return this._pointer?this._pointer:this.getPointer(e,!0)}getScenePoint(e){return this._absolutePointer?this._absolutePointer:this.getPointer(e)}getPointer(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const i=this.upperCanvasEl,r=i.getBoundingClientRect();let s=GG(e),o=r.width||0,a=r.height||0;o&&a||(Ph in r&&p6 in r&&(a=Math.abs(r.top-r.bottom)),il in r&&uo in r&&(o=Math.abs(r.right-r.left))),this.calcOffset(),s.x=s.x-this._offset.left,s.y=s.y-this._offset.top,t||(s=Yg(s,void 0,this.viewportTransform));const l=this.getRetinaScaling();l!==1&&(s.x/=l,s.y/=l);const h=o===0||a===0?new qt(1,1):new qt(i.width/o,i.height/a);return s.multiply(h)}_setDimensionsImpl(e,t){this._resetTransformEventData(),super._setDimensionsImpl(e,t),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=wA(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const e=this._activeObject;return Ig(e)?e.getObjects():e?[e]:[]}_fireSelectionEvents(e,t){let i=!1,r=!1;const s=this.getActiveObjects(),o=[],a=[];e.forEach((l=>{s.includes(l)||(i=!0,l.fire("deselected",{e:t,target:l}),a.push(l))})),s.forEach((l=>{e.includes(l)||(i=!0,l.fire("selected",{e:t,target:l}),o.push(l))})),e.length>0&&s.length>0?(r=!0,i&&this.fire("selection:updated",{e:t,selected:o,deselected:a})):s.length>0?(r=!0,this.fire("selection:created",{e:t,selected:o})):e.length>0&&(r=!0,this.fire("selection:cleared",{e:t,deselected:a})),r&&(this._objectsToRender=void 0)}setActiveObject(e,t){const i=this.getActiveObjects(),r=this._setActiveObject(e,t);return this._fireSelectionEvents(i,t),r}_setActiveObject(e,t){const i=this._activeObject;return i!==e&&!(!this._discardActiveObject(t,e)&&this._activeObject)&&!e.onSelect({e:t})&&(this._activeObject=e,Ig(e)&&i!==e&&e.set("canvas",this),e.setCoords(),!0)}_discardActiveObject(e,t){const i=this._activeObject;return!!i&&!i.onDeselect({e,object:t})&&(this._currentTransform&&this._currentTransform.target===i&&this.endCurrentTransform(e),Ig(i)&&i===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(e){const t=this.getActiveObjects(),i=this.getActiveObject();t.length&&this.fire("before:selection:cleared",{e,deselected:[i]});const r=this._discardActiveObject(e);return this._fireSelectionEvents(t,e),r}endCurrentTransform(e){const t=this._currentTransform;this._finalizeCurrentTransform(e),t&&t.target&&(t.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(e){const t=this._currentTransform,i=t.target,r={e,target:i,transform:t,action:t.action};i._scaling&&(i._scaling=!1),i.setCoords(),t.actionPerformed&&(this.fire("object:modified",r),i.fire(E_,r))}setViewportTransform(e){super.setViewportTransform(e);const t=this._activeObject;t&&t.setCoords()}destroy(){const e=this._activeObject;Ig(e)&&(e.removeAll(),e.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(e){const t=this._activeObject;t&&t._renderControls(e)}_toObject(e,t,i){const r=this._realizeGroupTransformOnObject(e),s=super._toObject(e,t,i);return e.set(r),s}_realizeGroupTransformOnObject(e){const{group:t}=e;if(t&&Ig(t)&&this._activeObject===t){const i=T0(e,["angle","flipX","flipY",uo,Ah,nu,M1,R1,Ph]);return XG(e,t.calcOwnMatrix()),i}return{}}_setSVGObject(e,t,i){const r=this._realizeGroupTransformOnObject(t);super._setSVGObject(e,t,i),t.set(r)}}St(pS,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});class uke{constructor(e){St(this,"targets",[]),St(this,"__disposer",void 0);const t=()=>{const{hiddenTextarea:r}=e.getActiveObject()||{};r&&r.focus()},i=e.upperCanvasEl;i.addEventListener("click",t),this.__disposer=()=>i.removeEventListener("click",t)}exitTextEditing(){this.target=void 0,this.targets.forEach((e=>{e.isEditing&&e.exitEditing()}))}add(e){this.targets.push(e)}remove(e){this.unregister(e),kg(this.targets,e)}register(e){this.target=e}unregister(e){e===this.target&&(this.target=void 0)}onMouseMove(e){var t;!((t=this.target)===null||t===void 0)&&t.isEditing&&this.target.updateSelectionOnMouseMove(e)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const dke=["target","oldTarget","fireCanvas","e"],zh={passive:!1},tm=(n,e)=>{const t=n.getViewportPoint(e),i=n.getScenePoint(e);return{viewportPoint:t,scenePoint:i,pointer:t,absolutePointer:i}},tp=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];return n.addEventListener(...t)},pu=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];return n.removeEventListener(...t)},Ake={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class S6 extends pS{constructor(e){super(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),St(this,"_isClick",void 0),St(this,"textEditingManager",new uke(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach((t=>{this[t]=this[t].bind(this)})),this.addOrRemove(tp,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(e,t){const i=this.upperCanvasEl,r=this._getEventPrefix();e(QG(i),"resize",this._onResize),e(i,r+"down",this._onMouseDown),e(i,"".concat(r,"move"),this._onMouseMove,zh),e(i,"".concat(r,"out"),this._onMouseOut),e(i,"".concat(r,"enter"),this._onMouseEnter),e(i,"wheel",this._onMouseWheel),e(i,"contextmenu",this._onContextMenu),e(i,"click",this._onClick),e(i,"dblclick",this._onClick),e(i,"dragstart",this._onDragStart),e(i,"dragend",this._onDragEnd),e(i,"dragover",this._onDragOver),e(i,"dragenter",this._onDragEnter),e(i,"dragleave",this._onDragLeave),e(i,"drop",this._onDrop),this.enablePointerEvents||e(i,"touchstart",this._onTouchStart,zh)}removeListeners(){this.addOrRemove(pu,"remove");const e=this._getEventPrefix(),t=ud(this.upperCanvasEl);pu(t,"".concat(e,"up"),this._onMouseUp),pu(t,"touchend",this._onTouchEnd,zh),pu(t,"".concat(e,"move"),this._onMouseMove,zh),pu(t,"touchmove",this._onMouseMove,zh),clearTimeout(this._willAddMouseDown)}_onMouseWheel(e){this.__onMouseWheel(e)}_onMouseOut(e){const t=this._hoveredTarget,i=Ct({e},tm(this,e));this.fire("mouse:out",Ct(Ct({},i),{},{target:t})),this._hoveredTarget=void 0,t&&t.fire("mouseout",Ct({},i)),this._hoveredTargets.forEach((r=>{this.fire("mouse:out",Ct(Ct({},i),{},{target:r})),r&&r.fire("mouseout",Ct({},i))})),this._hoveredTargets=[]}_onMouseEnter(e){this._currentTransform||this.findTarget(e)||(this.fire("mouse:over",Ct({e},tm(this,e))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(e){this._isClick=!1;const t=this.getActiveObject();if(t&&t.onDragStart(e)){this._dragSource=t;const i={e,target:t};return this.fire("dragstart",i),t.fire("dragstart",i),void tp(this.upperCanvasEl,"drag",this._onDragProgress)}s7(e)}_renderDragEffects(e,t,i){let r=!1;const s=this._dropTarget;s&&s!==t&&s!==i&&(s.clearContextTop(),r=!0),t==null||t.clearContextTop(),i!==t&&(i==null||i.clearContextTop());const o=this.contextTop;o.save(),o.transform(...this.viewportTransform),t&&(o.save(),t.transform(o),t.renderDragSourceEffect(e),o.restore(),r=!0),i&&(o.save(),i.transform(o),i.renderDropTargetEffect(e),o.restore(),r=!0),o.restore(),r&&(this.contextTopDirty=!0)}_onDragEnd(e){const t=!!e.dataTransfer&&e.dataTransfer.dropEffect!==hh,i=t?this._activeObject:void 0,r={e,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:t,dropTarget:i};pu(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",r),this._dragSource&&this._dragSource.fire("dragend",r),delete this._dragSource,this._onMouseUp(e)}_onDragProgress(e){const t={e,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",t),this._dragSource&&this._dragSource.fire("drag",t)}findDragTargets(e){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(e)),targets:[...this.targets]}}_onDragOver(e){const t="dragover",{target:i,targets:r}=this.findDragTargets(e),s=this._dragSource,o={e,target:i,subTargets:r,dragSource:s,canDrop:!1,dropTarget:void 0};let a;this.fire(t,o),this._fireEnterLeaveEvents(i,o),i&&(i.canDrop(e)&&(a=i),i.fire(t,o));for(let l=0;l<r.length;l++){const h=r[l];h.canDrop(e)&&(a=h),h.fire(t,o)}this._renderDragEffects(e,s,a),this._dropTarget=a}_onDragEnter(e){const{target:t,targets:i}=this.findDragTargets(e),r={e,target:t,subTargets:i,dragSource:this._dragSource};this.fire("dragenter",r),this._fireEnterLeaveEvents(t,r)}_onDragLeave(e){const t={e,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",t),this._fireEnterLeaveEvents(void 0,t),this._renderDragEffects(e,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(e){const{target:t,targets:i}=this.findDragTargets(e),r=this._basicEventHandler("drop:before",Ct({e,target:t,subTargets:i,dragSource:this._dragSource},tm(this,e)));r.didDrop=!1,r.dropTarget=void 0,this._basicEventHandler("drop",r),this.fire("drop:after",r)}_onContextMenu(e){const t=this.findTarget(e),i=this.targets||[],r=this._basicEventHandler("contextmenu:before",{e,target:t,subTargets:i});return this.stopContextMenu&&s7(e),this._basicEventHandler("contextmenu",r),!1}_onClick(e){const t=e.detail;t>3||t<2||(this._cacheTransformEventData(e),t==2&&e.type==="dblclick"&&this._handleEvent(e,"dblclick"),t==3&&this._handleEvent(e,"tripleclick"),this._resetTransformEventData())}getPointerId(e){const t=e.changedTouches;return t?t[0]&&t[0].identifier:this.enablePointerEvents?e.pointerId:-1}_isMainEvent(e){return e.isPrimary===!0||e.isPrimary!==!1&&(e.type==="touchend"&&e.touches.length===0||!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(e){let t=!this.allowTouchScrolling;const i=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),(this.isDrawingMode||i&&this._target===i)&&(t=!0),t&&e.preventDefault(),this._resetTransformEventData();const r=this.upperCanvasEl,s=this._getEventPrefix(),o=ud(r);tp(o,"touchend",this._onTouchEnd,zh),t&&tp(o,"touchmove",this._onMouseMove,zh),pu(r,"".concat(s,"down"),this._onMouseDown)}_onMouseDown(e){this.__onMouseDown(e),this._resetTransformEventData();const t=this.upperCanvasEl,i=this._getEventPrefix();pu(t,"".concat(i,"move"),this._onMouseMove,zh);const r=ud(t);tp(r,"".concat(i,"up"),this._onMouseUp),tp(r,"".concat(i,"move"),this._onMouseMove,zh)}_onTouchEnd(e){if(e.touches.length>0)return;this.__onMouseUp(e),this._resetTransformEventData(),delete this.mainTouchId;const t=this._getEventPrefix(),i=ud(this.upperCanvasEl);pu(i,"touchend",this._onTouchEnd,zh),pu(i,"touchmove",this._onMouseMove,zh),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout((()=>{tp(this.upperCanvasEl,"".concat(t,"down"),this._onMouseDown),this._willAddMouseDown=0}),400)}_onMouseUp(e){this.__onMouseUp(e),this._resetTransformEventData();const t=this.upperCanvasEl,i=this._getEventPrefix();if(this._isMainEvent(e)){const r=ud(this.upperCanvasEl);pu(r,"".concat(i,"up"),this._onMouseUp),pu(r,"".concat(i,"move"),this._onMouseMove,zh),tp(t,"".concat(i,"move"),this._onMouseMove,zh)}}_onMouseMove(e){const t=this.getActiveObject();!this.allowTouchScrolling&&(!t||!t.shouldStartDragging(e))&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(e){const t=this.getActiveObject();return!!t!=!!e||t&&e&&t!==e}__onMouseUp(e){var t;this._cacheTransformEventData(e),this._handleEvent(e,"up:before");const i=this._currentTransform,r=this._isClick,s=this._target,{button:o}=e;if(o)return(this.fireMiddleClick&&o===1||this.fireRightClick&&o===2)&&this._handleEvent(e,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(e);if(!this._isMainEvent(e))return;let a,l,h=!1;if(i&&(this._finalizeCurrentTransform(e),h=i.actionPerformed),!r){const u=s===this._activeObject;this.handleSelection(e),h||(h=this._shouldRender(s)||!u&&s===this._activeObject)}if(s){const u=s.findControl(this.getViewportPoint(e),k_(e)),{key:d,control:A}=u||{};if(l=d,s.selectable&&s!==this._activeObject&&s.activeOn==="up")this.setActiveObject(s,e),h=!0;else if(A){const f=A.getMouseUpHandler(e,s,A);f&&(a=this.getScenePoint(e),f.call(A,e,i,a.x,a.y))}s.isMoving=!1}if(i&&(i.target!==s||i.corner!==l)){const u=i.target&&i.target.controls[i.corner],d=u&&u.getMouseUpHandler(e,i.target,u);a=a||this.getScenePoint(e),d&&d.call(u,e,i,a.x,a.y)}this._setCursorFromEvent(e,s),this._handleEvent(e,"up"),this._groupSelector=null,this._currentTransform=null,s&&(s.__corner=void 0),h?this.requestRenderAll():r||(t=this._activeObject)!==null&&t!==void 0&&t.isEditing||this.renderTop()}_basicEventHandler(e,t){const{target:i,subTargets:r=[]}=t;this.fire(e,t),i&&i.fire(e,t);for(let s=0;s<r.length;s++)r[s]!==i&&r[s].fire(e,t);return t}_handleEvent(e,t,i){const r=this._target,s=this.targets||[],o=Ct(Ct(Ct({e,target:r,subTargets:s},tm(this,e)),{},{transform:this._currentTransform},t==="up:before"||t==="up"?{isClick:this._isClick,currentTarget:this.findTarget(e),currentSubTargets:this.targets}:{}),t==="down:before"||t==="down"?i:{});this.fire("mouse:".concat(t),o),r&&r.fire("mouse".concat(t),o);for(let a=0;a<s.length;a++)s[a]!==r&&s[a].fire("mouse".concat(t),o)}_onMouseDownInDrawingMode(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(e),this.requestRenderAll());const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(t,{e,pointer:t}),this._handleEvent(e,"down",{alreadySelected:!1})}_onMouseMoveInDrawingMode(e){if(this._isCurrentlyDrawing){const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(t,{e,pointer:t})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")}_onMouseUpInDrawingMode(e){const t=this.getScenePoint(e);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e,pointer:t}):this._isCurrentlyDrawing=!1,this._handleEvent(e,"up")}__onMouseDown(e){this._isClick=!0,this._cacheTransformEventData(e),this._handleEvent(e,"down:before");let t=this._target,i=!!t&&t===this._activeObject;const{button:r}=e;if(r)return(this.fireMiddleClick&&r===1||this.fireRightClick&&r===2)&&this._handleEvent(e,"down",{alreadySelected:i}),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(e);if(!this._isMainEvent(e)||this._currentTransform)return;let s=this._shouldRender(t),o=!1;if(this.handleMultiSelection(e,t)?(t=this._activeObject,o=!0,s=!0):this._shouldClearSelection(e,t)&&this.discardActiveObject(e),this.selection&&(!t||!t.selectable&&!t.isEditing&&t!==this._activeObject)){const a=this.getScenePoint(e);this._groupSelector={x:a.x,y:a.y,deltaY:0,deltaX:0}}if(i=!!t&&t===this._activeObject,t){t.selectable&&t.activeOn==="down"&&this.setActiveObject(t,e);const a=t.findControl(this.getViewportPoint(e),k_(e));if(t===this._activeObject&&(a||!o)){this._setupCurrentTransform(e,t,i);const l=a?a.control:void 0,h=this.getScenePoint(e),u=l&&l.getMouseDownHandler(e,t,l);u&&u.call(l,e,this._currentTransform,h.x,h.y)}}s&&(this._objectsToRender=void 0),this._handleEvent(e,"down",{alreadySelected:i}),s&&this.requestRenderAll()}_resetTransformEventData(){this._target=this._pointer=this._absolutePointer=void 0}_cacheTransformEventData(e){this._resetTransformEventData(),this._pointer=this.getViewportPoint(e),this._absolutePointer=Yg(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)}__onMouseMove(e){if(this._isClick=!1,this._cacheTransformEventData(e),this._handleEvent(e,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(e);if(!this._isMainEvent(e))return;const t=this._groupSelector;if(t){const i=this.getScenePoint(e);t.deltaX=i.x-t.x,t.deltaY=i.y-t.y,this.renderTop()}else if(this._currentTransform)this._transformObject(e);else{const i=this.findTarget(e);this._setCursorFromEvent(e,i),this._fireOverOutEvents(e,i)}this.textEditingManager.onMouseMove(e),this._handleEvent(e,"move"),this._resetTransformEventData()}_fireOverOutEvents(e,t){const i=this._hoveredTarget,r=this._hoveredTargets,s=this.targets,o=Math.max(r.length,s.length);this.fireSyntheticInOutEvents("mouse",{e,target:t,oldTarget:i,fireCanvas:!0});for(let a=0;a<o;a++)this.fireSyntheticInOutEvents("mouse",{e,target:s[a],oldTarget:r[a]});this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(e,t){const i=this._draggedoverTarget,r=this._hoveredTargets,s=this.targets,o=Math.max(r.length,s.length);this.fireSyntheticInOutEvents("drag",Ct(Ct({},t),{},{target:e,oldTarget:i,fireCanvas:!0}));for(let a=0;a<o;a++)this.fireSyntheticInOutEvents("drag",Ct(Ct({},t),{},{target:s[a],oldTarget:r[a]}));this._draggedoverTarget=e}fireSyntheticInOutEvents(e,t){let{target:i,oldTarget:r,fireCanvas:s,e:o}=t,a=ca(t,dke);const{targetIn:l,targetOut:h,canvasIn:u,canvasOut:d}=Ake[e],A=r!==i;if(r&&A){const f=Ct(Ct({},a),{},{e:o,target:r,nextTarget:i},tm(this,o));s&&this.fire(d,f),r.fire(h,f)}if(i&&A){const f=Ct(Ct({},a),{},{e:o,target:i,previousTarget:r},tm(this,o));s&&this.fire(u,f),i.fire(l,f)}}__onMouseWheel(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()}_transformObject(e){const t=this.getScenePoint(e),i=this._currentTransform,r=i.target,s=r.group?Yg(t,void 0,r.group.calcTransformMatrix()):t;i.shiftKey=e.shiftKey,i.altKey=!!this.centeredKey&&e[this.centeredKey],this._performTransformAction(e,i,s),i.actionPerformed&&this.requestRenderAll()}_performTransformAction(e,t,i){const{action:r,actionHandler:s,target:o}=t,a=!!s&&s(e,t,i.x,i.y);a&&o.setCoords(),r==="drag"&&a&&(t.target.isMoving=!0,this.setCursor(t.target.moveCursor||this.moveCursor)),t.actionPerformed=t.actionPerformed||a}_setCursorFromEvent(e,t){if(!t)return void this.setCursor(this.defaultCursor);let i=t.hoverCursor||this.hoverCursor;const r=Ig(this._activeObject)?this._activeObject:null,s=(!r||t.group!==r)&&t.findControl(this.getViewportPoint(e));if(s){const o=s.control;this.setCursor(o.cursorStyleHandler(e,o,t))}else t.subTargetCheck&&this.targets.concat().reverse().map((o=>{i=o.hoverCursor||i})),this.setCursor(i)}handleMultiSelection(e,t){const i=this._activeObject,r=Ig(i);if(i&&this._isSelectionKeyPressed(e)&&this.selection&&t&&t.selectable&&(i!==t||r)&&(r||!t.isDescendantOf(i)&&!i.isDescendantOf(t))&&!t.onSelect({e})&&!i.getActiveControl()){if(r){const s=i.getObjects();if(t===i){const o=this.getViewportPoint(e);if(!(t=this.searchPossibleTargets(s,o)||this.searchPossibleTargets(this._objects,o))||!t.selectable)return!1}t.group===i?(i.remove(t),this._hoveredTarget=t,this._hoveredTargets=[...this.targets],i.size()===1&&this._setActiveObject(i.item(0),e)):(i.multiSelectAdd(t),this._hoveredTarget=i,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(s,e)}else{i.isEditing&&i.exitEditing();const s=new(Mi.getClass("ActiveSelection"))([],{canvas:this});s.multiSelectAdd(i,t),this._hoveredTarget=s,this._setActiveObject(s,e),this._fireSelectionEvents([i],e)}return!0}return!1}handleSelection(e){if(!this.selection||!this._groupSelector)return!1;const{x:t,y:i,deltaX:r,deltaY:s}=this._groupSelector,o=new qt(t,i),a=o.add(new qt(r,s)),l=o.min(a),h=o.max(a).subtract(l),u=this.collectObjects({left:l.x,top:l.y,width:h.x,height:h.y},{includeIntersecting:!this.selectionFullyContained}),d=o.eq(a)?u[0]?[u[0]]:[]:u.length>1?u.filter((A=>!A.onSelect({e}))).reverse():u;if(d.length===1)this.setActiveObject(d[0],e);else if(d.length>1){const A=Mi.getClass("ActiveSelection");this.setActiveObject(new A(d,{canvas:this}),e)}return this._groupSelector=null,!0}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}const NX={x1:0,y1:0,x2:0,y2:0},fke=Ct(Ct({},NX),{},{r1:0,r2:0}),Sm=(n,e)=>isNaN(n)&&typeof e=="number"?e:n,pke=/^(\d+\.\d+)%|(\d+)%$/;function LX(n){return n&&pke.test(n)}function MX(n,e){const t=typeof n=="number"?n:typeof n=="string"?parseFloat(n)/(LX(n)?100:1):NaN;return u0(0,Sm(t,e),1)}const gke=/\s*;\s*/,mke=/\s*:\s*/;function yke(n,e){let t,i;const r=n.getAttribute("style");if(r){const o=r.split(gke);o[o.length-1]===""&&o.pop();for(let a=o.length;a--;){const[l,h]=o[a].split(mke).map((u=>u.trim()));l==="stop-color"?t=h:l==="stop-opacity"&&(i=h)}}const s=new po(t||n.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:MX(n.getAttribute("offset"),0),color:s.toRgb(),opacity:Sm(parseFloat(i||n.getAttribute("stop-opacity")||""),1)*s.getAlpha()*e}}function wke(n,e){const t=[],i=n.getElementsByTagName("stop"),r=MX(e,1);for(let s=i.length;s--;)t.push(yke(i[s],r));return t}function RX(n){return n.nodeName==="linearGradient"||n.nodeName==="LINEARGRADIENT"?"linear":"radial"}function UX(n){return n.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function td(n,e){return n.getAttribute(e)}function vke(n,e){return(function(t,i){let r,{width:s,height:o,gradientUnits:a}=i;return Object.keys(t).reduce(((l,h)=>{const u=t[h];return u==="Infinity"?r=1:u==="-Infinity"?r=0:(r=typeof u=="string"?parseFloat(u):u,typeof u=="string"&&LX(u)&&(r*=.01,a==="pixels"&&(h!=="x1"&&h!=="x2"&&h!=="r2"||(r*=s),h!=="y1"&&h!=="y2"||(r*=o)))),l[h]=r,l}),{})})(RX(n)==="linear"?(function(t){return{x1:td(t,"x1")||0,y1:td(t,"y1")||0,x2:td(t,"x2")||"100%",y2:td(t,"y2")||0}})(n):(function(t){return{x1:td(t,"fx")||td(t,"cx")||"50%",y1:td(t,"fy")||td(t,"cy")||"50%",r1:0,x2:td(t,"cx")||"50%",y2:td(t,"cy")||"50%",r2:td(t,"r")||"50%"}})(n),Ct(Ct({},e),{},{gradientUnits:UX(n)}))}class Ey{constructor(e){const{type:t="linear",gradientUnits:i="pixels",coords:r={},colorStops:s=[],offsetX:o=0,offsetY:a=0,gradientTransform:l,id:h}=e||{};Object.assign(this,{type:t,gradientUnits:i,coords:Ct(Ct({},t==="radial"?fke:NX),r),colorStops:s,offsetX:o,offsetY:a,gradientTransform:l,id:h?"".concat(h,"_").concat(Qp()):Qp()})}addColorStop(e){for(const t in e){const i=new po(e[t]);this.colorStops.push({offset:parseFloat(t),color:i.toRgb(),opacity:i.getAlpha()})}return this}toObject(e){return Ct(Ct({},T0(this,e)),{},{type:this.type,coords:Ct({},this.coords),colorStops:this.colorStops.map((t=>Ct({},t))),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(e){let{additionalTransform:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=[],r=this.gradientTransform?this.gradientTransform.concat():dh.concat(),s=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",o=this.colorStops.map((d=>Ct({},d))).sort(((d,A)=>d.offset-A.offset));let a=-this.offsetX,l=-this.offsetY;var h;s==="objectBoundingBox"?(a/=e.width,l/=e.height):(a+=e.width/2,l+=e.height/2),(h=e)&&typeof h._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(a-=e.pathOffset.x,l-=e.pathOffset.y),r[4]-=a,r[5]-=l;const u=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(s,'"'),'gradientTransform="'.concat(t?t+" ":"").concat(p1(r),'"'),""].join(" ");if(this.type==="linear"){const{x1:d,y1:A,x2:f,y2:p}=this.coords;i.push("<linearGradient ",u,' x1="',d,'" y1="',A,'" x2="',f,'" y2="',p,`">
`)}else if(this.type==="radial"){const{x1:d,y1:A,x2:f,y2:p,r1:g,r2:v}=this.coords,w=g>v;i.push("<radialGradient ",u,' cx="',w?d:f,'" cy="',w?A:p,'" r="',w?g:v,'" fx="',w?f:d,'" fy="',w?p:A,`">
`),w&&(o.reverse(),o.forEach((y=>{y.offset=1-y.offset})));const m=Math.min(g,v);if(m>0){const y=m/Math.max(g,v);o.forEach((x=>{x.offset+=y*(1-x.offset)}))}}return o.forEach((d=>{let{color:A,offset:f,opacity:p}=d;i.push("<stop ",'offset="',100*f+"%",'" style="stop-color:',A,p!==void 0?";stop-opacity: "+p:";",`"/>
`)})),i.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),i.join("")}toLive(e){const{x1:t,y1:i,x2:r,y2:s,r1:o,r2:a}=this.coords,l=this.type==="linear"?e.createLinearGradient(t,i,r,s):e.createRadialGradient(t,i,o,r,s,a);return this.colorStops.forEach((h=>{let{color:u,opacity:d,offset:A}=h;l.addColorStop(A,d!==void 0?new po(u).setAlpha(d).toRgba():u)})),l}static async fromObject(e){const{colorStops:t,gradientTransform:i}=e;return new this(Ct(Ct({},e),{},{colorStops:t?t.map((r=>Ct({},r))):void 0,gradientTransform:i?[...i]:void 0}))}static fromElement(e,t,i){const r=UX(e),s=t._findCenterFromElement();return new this(Ct({id:e.getAttribute("id")||void 0,type:RX(e),coords:vke(e,{width:i.viewBoxWidth||i.width,height:i.viewBoxHeight||i.height}),colorStops:wke(e,i.opacity),gradientUnits:r,gradientTransform:L_(e.getAttribute("gradientTransform")||"")},r==="pixels"?{offsetX:t.width/2-s.x,offsetY:t.height/2-s.y}:{offsetX:0,offsetY:0}))}}St(Ey,"type","Gradient"),Mi.setClass(Ey,"gradient"),Mi.setClass(Ey,"linear"),Mi.setClass(Ey,"radial");const xke=["type","source","patternTransform"];class _T{get type(){return"pattern"}set type(e){Sf("warn","Setting type has no effect",e)}constructor(e){St(this,"repeat","repeat"),St(this,"offsetX",0),St(this,"offsetY",0),St(this,"crossOrigin",""),this.id=Qp(),Object.assign(this,e)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(e){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?e.createPattern(this.source,this.repeat):null}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const{repeat:t,crossOrigin:i}=this;return Ct(Ct({},T0(this,e)),{},{type:"pattern",source:this.sourceToString(),repeat:t,crossOrigin:i,offsetX:No(this.offsetX,Ys.NUM_FRACTION_DIGITS),offsetY:No(this.offsetY,Ys.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(e){let{width:t,height:i}=e;const{source:r,repeat:s,id:o}=this,a=Sm(this.offsetX/t,0),l=Sm(this.offsetY/i,0),h=s==="repeat-y"||s==="no-repeat"?1+Math.abs(a||0):Sm(r.width/t,0),u=s==="repeat-x"||s==="no-repeat"?1+Math.abs(l||0):Sm(r.height/i,0);return['<pattern id="SVGID_'.concat(o,'" x="').concat(a,'" y="').concat(l,'" width="').concat(h,'" height="').concat(u,'">'),'<image x="0" y="0" width="'.concat(r.width,'" height="').concat(r.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static async fromObject(e,t){let{type:i,source:r,patternTransform:s}=e,o=ca(e,xke);const a=await cw(r,Ct(Ct({},t),{},{crossOrigin:o.crossOrigin}));return new this(Ct(Ct({},o),{},{patternTransform:s&&s.slice(0),source:a}))}}St(_T,"type","Pattern"),Mi.setClass(_T),Mi.setClass(_T,"pattern");const bke=["path","left","top"],Cke=["d"];class sf extends Qc{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:i,left:r,top:s}=t,o=ca(t,bke);super(),Object.assign(this,sf.ownDefaults),this.setOptions(o),this._setPath(e||[],!0),typeof r=="number"&&this.set(uo,r),typeof s=="number"&&this.set(Ph,s)}_setPath(e,t){this.path=BX(Array.isArray(e)?e:jX(e)),this.setBoundingBox(t)}_findCenterFromElement(){const e=this._calcBoundsFromPath();return new qt(e.left+e.width/2,e.top+e.height/2)}_renderPathCommands(e){const t=-this.pathOffset.x,i=-this.pathOffset.y;e.beginPath();for(const r of this.path)switch(r[0]){case"L":e.lineTo(r[1]+t,r[2]+i);break;case"M":e.moveTo(r[1]+t,r[2]+i);break;case"C":e.bezierCurveTo(r[1]+t,r[2]+i,r[3]+t,r[4]+i,r[5]+t,r[6]+i);break;case"Q":e.quadraticCurveTo(r[1]+t,r[2]+i,r[3]+t,r[4]+i);break;case"Z":e.closePath()}}_render(e){this._renderPathCommands(e),this._renderPaintInOrder(e)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Ct(Ct({},super.toObject(e)),{},{path:this.path.map((t=>t.slice()))})}toDatalessObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.toObject(e);return this.sourcePath&&(delete t.path,t.sourcePath=this.sourcePath),t}_toSVG(){const e=PX(this.path,Ys.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(e,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){const e=Ys.NUM_FRACTION_DIGITS;return" translate(".concat(No(-this.pathOffset.x,e),", ").concat(No(-this.pathOffset.y,e),")")}toClipPathSVG(e){const t=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}toSVG(e){const t=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{width:t,height:i,pathOffset:r}=this._calcDimensions();this.set({width:t,height:i,pathOffset:r}),e&&this.setPositionByOrigin(r,ns,ns)}_calcBoundsFromPath(){const e=[];let t=0,i=0,r=0,s=0;for(const o of this.path)switch(o[0]){case"L":r=o[1],s=o[2],e.push({x:t,y:i},{x:r,y:s});break;case"M":r=o[1],s=o[2],t=r,i=s;break;case"C":e.push(..._6(r,s,o[1],o[2],o[3],o[4],o[5],o[6])),r=o[5],s=o[6];break;case"Q":e.push(..._6(r,s,o[1],o[2],o[1],o[2],o[3],o[4])),r=o[3],s=o[4];break;case"Z":r=t,s=i}return dA(e)}_calcDimensions(){const e=this._calcBoundsFromPath();return Ct(Ct({},e),{},{pathOffset:new qt(e.left+e.width/2,e.top+e.height/2)})}static fromObject(e){return this._fromObject(e,{extraParam:"path"})}static async fromElement(e,t,i){const r=Pf(e,this.ATTRIBUTE_NAMES,i),{d:s}=r;return new this(s,Ct(Ct(Ct({},ca(r,Cke)),t),{},{left:void 0,top:void 0}))}}St(sf,"type","Path"),St(sf,"cacheProperties",[...jf,"path","fillRule"]),St(sf,"ATTRIBUTE_NAMES",[...tg,"d"]),Mi.setClass(sf),Mi.setSVGClass(sf);const _ke=["left","top","radius"],OX=["radius","startAngle","endAngle","counterClockwise"];class cd extends Qc{static getDefaults(){return Ct(Ct({},super.getDefaults()),cd.ownDefaults)}constructor(e){super(),Object.assign(this,cd.ownDefaults),this.setOptions(e)}_set(e,t){return super._set(e,t),e==="radius"&&this.setRadius(t),this}_render(e){e.beginPath(),e.arc(0,0,this.radius,La(this.startAngle),La(this.endAngle),this.counterClockwise),this._renderPaintInOrder(e)}getRadiusX(){return this.get("radius")*this.get(Ah)}getRadiusY(){return this.get("radius")*this.get(nu)}setRadius(e){this.radius=e,this.set({width:2*e,height:2*e})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...OX,...e])}_toSVG(){const e=(this.endAngle-this.startAngle)%360;if(e===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{const{radius:t}=this,i=La(this.startAngle),r=La(this.endAngle),s=Td(i)*t,o=Bd(i)*t,a=Td(r)*t,l=Bd(r)*t,h=e>180?1:0,u=this.counterClockwise?0:1;return['<path d="M '.concat(s," ").concat(o," A ").concat(t," ").concat(t," 0 ").concat(h," ").concat(u," ").concat(a," ").concat(l,'" '),"COMMON_PARTS",` />
`]}}static async fromElement(e,t,i){const r=Pf(e,this.ATTRIBUTE_NAMES,i),{left:s=0,top:o=0,radius:a=0}=r;return new this(Ct(Ct({},ca(r,_ke)),{},{radius:a,left:s-a,top:o-a}))}static fromObject(e){return super._fromObject(e)}}St(cd,"type","Circle"),St(cd,"cacheProperties",[...jf,...OX]),St(cd,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),St(cd,"ATTRIBUTE_NAMES",["cx","cy","r",...tg]),Mi.setClass(cd),Mi.setSVGClass(cd);const Ske=["x1","y1","x2","y2"],Tke=["x1","y1","x2","y2"],T6=["x1","x2","y1","y2"];class Ql extends Qc{constructor(){let[e,t,i,r]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,Ql.ownDefaults),this.setOptions(s),this.x1=e,this.x2=i,this.y1=t,this.y2=r,this._setWidthHeight();const{left:o,top:a}=s;typeof o=="number"&&this.set(uo,o),typeof a=="number"&&this.set(Ph,a)}_setWidthHeight(){const{x1:e,y1:t,x2:i,y2:r}=this;this.width=Math.abs(i-e),this.height=Math.abs(r-t);const{left:s,top:o,width:a,height:l}=dA([{x:e,y:t},{x:i,y:r}]),h=new qt(s+a/2,o+l/2);this.setPositionByOrigin(h,ns,ns)}_set(e,t){return super._set(e,t),T6.includes(e)&&this._setWidthHeight(),this}_render(e){e.beginPath();const t=this.calcLinePoints();e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2),e.lineWidth=this.strokeWidth;const i=e.strokeStyle;var r;Bu(this.stroke)?e.strokeStyle=this.stroke.toLive(e):e.strokeStyle=(r=this.stroke)!==null&&r!==void 0?r:e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=i}_findCenterFromElement(){return new qt((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Ct(Ct({},super.toObject(e)),this.calcLinePoints())}_getNonTransformedDimensions(){const e=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e}calcLinePoints(){const{x1:e,x2:t,y1:i,y2:r,width:s,height:o}=this,a=e<=t?-1:1,l=i<=r?-1:1;return{x1:a*s/2,x2:a*-s/2,y1:l*o/2,y2:l*-o/2}}_toSVG(){const{x1:e,x2:t,y1:i,y2:r}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(e,'" y1="').concat(i,'" x2="').concat(t,'" y2="').concat(r,`" />
`)]}static async fromElement(e,t,i){const r=Pf(e,this.ATTRIBUTE_NAMES,i),{x1:s=0,y1:o=0,x2:a=0,y2:l=0}=r;return new this([s,o,a,l],ca(r,Ske))}static fromObject(e){let{x1:t,y1:i,x2:r,y2:s}=e,o=ca(e,Tke);return this._fromObject(Ct(Ct({},o),{},{points:[t,i,r,s]}),{extraParam:"points"})}}St(Ql,"type","Line"),St(Ql,"cacheProperties",[...jf,...T6]),St(Ql,"ATTRIBUTE_NAMES",tg.concat(T6)),Mi.setClass(Ql),Mi.setSVGClass(Ql);class Eu extends Qc{static getDefaults(){return Ct(Ct({},super.getDefaults()),Eu.ownDefaults)}constructor(e){super(),Object.assign(this,Eu.ownDefaults),this.setOptions(e)}_render(e){const t=this.width/2,i=this.height/2;e.beginPath(),e.moveTo(-t,i),e.lineTo(0,-i),e.lineTo(t,i),e.closePath(),this._renderPaintInOrder(e)}_toSVG(){const e=this.width/2,t=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-e," ").concat(t,",0 ").concat(-t,",").concat(e," ").concat(t),'" />']}}St(Eu,"type","Triangle"),St(Eu,"ownDefaults",{width:100,height:100}),Mi.setClass(Eu),Mi.setSVGClass(Eu);const HX=["rx","ry"];class Jd extends Qc{static getDefaults(){return Ct(Ct({},super.getDefaults()),Jd.ownDefaults)}constructor(e){super(),Object.assign(this,Jd.ownDefaults),this.setOptions(e)}_set(e,t){switch(super._set(e,t),e){case"rx":this.rx=t,this.set("width",2*t);break;case"ry":this.ry=t,this.set("height",2*t)}return this}getRx(){return this.get("rx")*this.get(Ah)}getRy(){return this.get("ry")*this.get(nu)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...HX,...e])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,Tf,!1),e.restore(),this._renderPaintInOrder(e)}static async fromElement(e,t,i){const r=Pf(e,this.ATTRIBUTE_NAMES,i);return r.left=(r.left||0)-r.rx,r.top=(r.top||0)-r.ry,new this(r)}}function Bke(n){if(!n)return[];const e=n.replace(/,/g," ").trim().split(/\s+/),t=[];for(let i=0;i<e.length;i+=2)t.push({x:parseFloat(e[i]),y:parseFloat(e[i+1])});return t}St(Jd,"type","Ellipse"),St(Jd,"cacheProperties",[...jf,...HX]),St(Jd,"ownDefaults",{rx:0,ry:0}),St(Jd,"ATTRIBUTE_NAMES",[...tg,"cx","cy","rx","ry"]),Mi.setClass(Jd),Mi.setSVGClass(Jd);const Eke=["left","top"],WX={exactBoundingBox:!1};class _u extends Qc{static getDefaults(){return Ct(Ct({},super.getDefaults()),_u.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),St(this,"strokeDiff",void 0),Object.assign(this,_u.ownDefaults),this.setOptions(t),this.points=e;const{left:i,top:r}=t;this.initialized=!0,this.setBoundingBox(!0),typeof i=="number"&&this.set(uo,i),typeof r=="number"&&this.set(Ph,r)}isOpen(){return!0}_projectStrokeOnPoints(e){return yX(this.points,e,this.isOpen())}_calcDimensions(e){e=Ct({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},e||{});const t=this.exactBoundingBox?this._projectStrokeOnPoints(e).map((h=>h.projectedPoint)):this.points;if(t.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new qt,strokeOffset:new qt,strokeDiff:new qt};const i=dA(t),r=Fv(Ct(Ct({},e),{},{scaleX:1,scaleY:1})),s=dA(this.points.map((h=>Hc(h,r,!0)))),o=new qt(this.scaleX,this.scaleY);let a=i.left+i.width/2,l=i.top+i.height/2;return this.exactBoundingBox&&(a-=l*Math.tan(La(this.skewX)),l-=a*Math.tan(La(this.skewY))),Ct(Ct({},i),{},{pathOffset:new qt(a,l),strokeOffset:new qt(s.left,s.top).subtract(new qt(i.left,i.top)).multiply(o),strokeDiff:new qt(i.width,i.height).subtract(new qt(s.width,s.height)).multiply(o)})}_findCenterFromElement(){const e=dA(this.points);return new qt(e.left+e.width/2,e.top+e.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{left:t,top:i,width:r,height:s,pathOffset:o,strokeOffset:a,strokeDiff:l}=this._calcDimensions();this.set({width:r,height:s,pathOffset:o,strokeOffset:a,strokeDiff:l}),e&&this.setPositionByOrigin(new qt(t+r/2,i+s/2),ns,ns)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new qt(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let o;if(Object.keys(e).some((a=>this.strokeUniform||this.constructor.layoutProperties.includes(a)))){var t,i;const{width:a,height:l}=this._calcDimensions(e);o=new qt((t=e.width)!==null&&t!==void 0?t:a,(i=e.height)!==null&&i!==void 0?i:l)}else{var r,s;o=new qt((r=e.width)!==null&&r!==void 0?r:this.width,(s=e.height)!==null&&s!==void 0?s:this.height)}return o.multiply(new qt(e.scaleX||this.scaleX,e.scaleY||this.scaleY))}return super._getTransformedDimensions(e)}_set(e,t){const i=this.initialized&&this[e]!==t,r=super._set(e,t);return this.exactBoundingBox&&i&&((e===Ah||e===nu)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(e))&&this.setDimensions(),r}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Ct(Ct({},super.toObject(e)),{},{points:this.points.map((t=>{let{x:i,y:r}=t;return{x:i,y:r}}))})}_toSVG(){const e=[],t=this.pathOffset.x,i=this.pathOffset.y,r=Ys.NUM_FRACTION_DIGITS;for(let s=0,o=this.points.length;s<o;s++)e.push(No(this.points[s].x-t,r),",",No(this.points[s].y-i,r)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(e.join(""),`" />
`)]}_render(e){const t=this.points.length,i=this.pathOffset.x,r=this.pathOffset.y;if(t&&!isNaN(this.points[t-1].y)){e.beginPath(),e.moveTo(this.points[0].x-i,this.points[0].y-r);for(let s=0;s<t;s++){const o=this.points[s];e.lineTo(o.x-i,o.y-r)}!this.isOpen()&&e.closePath(),this._renderPaintInOrder(e)}}complexity(){return this.points.length}static async fromElement(e,t,i){return new this(Bke(e.getAttribute("points")),Ct(Ct({},ca(Pf(e,this.ATTRIBUTE_NAMES,i),Eke)),t))}static fromObject(e){return this._fromObject(e,{extraParam:"points"})}}St(_u,"ownDefaults",WX),St(_u,"type","Polyline"),St(_u,"layoutProperties",[M1,R1,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),St(_u,"cacheProperties",[...jf,"points"]),St(_u,"ATTRIBUTE_NAMES",[...tg]),Mi.setClass(_u),Mi.setSVGClass(_u);class Tm extends _u{isOpen(){return!1}}St(Tm,"ownDefaults",WX),St(Tm,"type","Polygon"),Mi.setClass(Tm),Mi.setSVGClass(Tm);class zX extends Qc{isEmptyStyles(e){if(!this.styles||e!==void 0&&!this.styles[e])return!0;const t=e===void 0?this.styles:{line:this.styles[e]};for(const i in t)for(const r in t[i])for(const s in t[i][r])return!1;return!0}styleHas(e,t){if(!this.styles||t!==void 0&&!this.styles[t])return!1;const i=t===void 0?this.styles:{0:this.styles[t]};for(const r in i)for(const s in i[r])if(i[r][s][e]!==void 0)return!0;return!1}cleanStyle(e){if(!this.styles)return!1;const t=this.styles;let i,r,s=0,o=!0,a=0;for(const l in t){i=0;for(const h in t[l]){const u=t[l][h]||{};s++,u[e]!==void 0?(r?u[e]!==r&&(o=!1):r=u[e],u[e]===this[e]&&delete u[e]):o=!1,Object.keys(u).length!==0?i++:delete t[l][h]}i===0&&delete t[l]}for(let l=0;l<this._textLines.length;l++)a+=this._textLines[l].length;o&&s===a&&(this[e]=r,this.removeStyle(e))}removeStyle(e){if(!this.styles)return;const t=this.styles;let i,r,s;for(r in t){for(s in i=t[r],i)delete i[s][e],Object.keys(i[s]).length===0&&delete i[s];Object.keys(i).length===0&&delete t[r]}}_extendStyles(e,t){const{lineIndex:i,charIndex:r}=this.get2DCursorLocation(e);this._getLineStyle(i)||this._setLineStyle(i);const s=_8(Ct(Ct({},this._getStyleDeclaration(i,r)),t),(o=>o!==void 0));this._setStyleDeclaration(i,r,s)}getSelectionStyles(e,t,i){const r=[];for(let s=e;s<(t||e);s++)r.push(this.getStyleAtPosition(s,i));return r}getStyleAtPosition(e,t){const{lineIndex:i,charIndex:r}=this.get2DCursorLocation(e);return t?this.getCompleteStyleDeclaration(i,r):this._getStyleDeclaration(i,r)}setSelectionStyles(e,t,i){for(let r=t;r<(i||t);r++)this._extendStyles(r,e);this._forceClearCache=!0}_getStyleDeclaration(e,t){var i;const r=this.styles&&this.styles[e];return r&&(i=r[t])!==null&&i!==void 0?i:{}}getCompleteStyleDeclaration(e,t){return Ct(Ct({},T0(this,this.constructor._styleProperties)),this._getStyleDeclaration(e,t))}_setStyleDeclaration(e,t,i){this.styles[e][t]=i}_deleteStyleDeclaration(e,t){delete this.styles[e][t]}_getLineStyle(e){return!!this.styles[e]}_setLineStyle(e){this.styles[e]={}}_deleteLineStyle(e){delete this.styles[e]}}St(zX,"_styleProperties",O6e);const Fke=/  +/g,kke=/"/g;function ST(n,e,t,i,r){return"		".concat((function(s,o){let{left:a,top:l,width:h,height:u}=o,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ys.NUM_FRACTION_DIGITS;const A=Hw(bl,s,!1),[f,p,g,v]=[a,l,h,u].map((w=>No(w,d)));return"<rect ".concat(A,' x="').concat(f,'" y="').concat(p,'" width="').concat(g,'" height="').concat(v,'"></rect>')})(n,{left:e,top:t,width:i,height:r}),`
`)}const Ike=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"];let TT;class pc extends zX{static getDefaults(){return Ct(Ct({},super.getDefaults()),pc.ownDefaults)}constructor(e,t){super(),St(this,"__charBounds",[]),Object.assign(this,pc.ownDefaults),this.setOptions(t),this.styles||(this.styles={}),this.text=e,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const e=this.path;e&&(e.segmentsInfo=L8(e.path))}_splitText(){const e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(tA)&&this.enlargeSpaces()}enlargeSpaces(){let e,t,i,r,s,o,a;for(let l=0,h=this._textLines.length;l<h;l++)if((this.textAlign===tA||l!==h-1&&!this.isEndOfWrapping(l))&&(r=0,s=this._textLines[l],t=this.getLineWidth(l),t<this.width&&(a=this.textLines[l].match(this._reSpacesAndTabs)))){i=a.length,e=(this.width-t)/i;for(let u=0;u<=s.length;u++)o=this.__charBounds[l][u],this._reSpaceAndTab.test(s[u])?(o.width+=e,o.kernedWidth+=e,o.left+=r,r+=e):o.left+=r}}isEndOfWrapping(e){return e===this._textLines.length-1}missingNewlineOffset(e){return 1}get2DCursorLocation(e,t){const i=t?this._unwrappedTextLines:this._textLines;let r;for(r=0;r<i.length;r++){if(e<=i[r].length)return{lineIndex:r,charIndex:e};e-=i[r].length+this.missingNewlineOffset(r,t)}return{lineIndex:r-1,charIndex:i[r-1].length<e?i[r-1].length:e}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){const e=super._getCacheCanvasDimensions(),t=this.fontSize;return e.width+=t*e.zoomX,e.height+=t*e.zoomY,e}_render(e){const t=this.path;t&&!t.isNotVisible()&&t._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")}_renderText(e){this.paintFirst===uh?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))}_setTextStyles(e,t,i){if(e.textBaseline="alphabetic",this.path)switch(this.pathAlign){case ns:e.textBaseline="middle";break;case"ascender":e.textBaseline=Ph;break;case"descender":e.textBaseline=p6}e.font=this._getFontDeclaration(t,i)}calcTextWidth(){let e=this.getLineWidth(0);for(let t=1,i=this._textLines.length;t<i;t++){const r=this.getLineWidth(t);r>e&&(e=r)}return e}_renderTextLine(e,t,i,r,s,o){this._renderChars(e,t,i,r,s,o)}_renderTextLinesBackground(e){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const t=e.fillStyle,i=this._getLeftOffset();let r=this._getTopOffset();for(let s=0,o=this._textLines.length;s<o;s++){const a=this.getHeightOfLine(s);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",s)){r+=a;continue}const l=this._textLines[s].length,h=this._getLineLeftOffset(s);let u,d,A=0,f=0,p=this.getValueOfPropertyAt(s,0,"textBackgroundColor");for(let g=0;g<l;g++){const v=this.__charBounds[s][g];d=this.getValueOfPropertyAt(s,g,"textBackgroundColor"),this.path?(e.save(),e.translate(v.renderLeft,v.renderTop),e.rotate(v.angle),e.fillStyle=d,d&&e.fillRect(-v.width/2,-a/this.lineHeight*(1-this._fontSizeFraction),v.width,a/this.lineHeight),e.restore()):d!==p?(u=i+h+f,this.direction==="rtl"&&(u=this.width-u-A),e.fillStyle=p,p&&e.fillRect(u,r,A,a/this.lineHeight),f=v.left,A=v.width,p=d):A+=v.kernedWidth}d&&!this.path&&(u=i+h+f,this.direction==="rtl"&&(u=this.width-u-A),e.fillStyle=d,e.fillRect(u,r,A,a/this.lineHeight)),r+=a}e.fillStyle=t,this._removeShadow(e)}_measureChar(e,t,i,r){const s=aw.getFontCache(t),o=this._getFontDeclaration(t),a=i+e,l=i&&o===this._getFontDeclaration(r),h=t.fontSize/this.CACHE_FONT_SIZE;let u,d,A,f;if(i&&s[i]!==void 0&&(A=s[i]),s[e]!==void 0&&(f=u=s[e]),l&&s[a]!==void 0&&(d=s[a],f=d-A),u===void 0||A===void 0||d===void 0){const p=(function(){return TT||(TT=iu({width:0,height:0}).getContext("2d")),TT})();this._setTextStyles(p,t,!0),u===void 0&&(f=u=p.measureText(e).width,s[e]=u),A===void 0&&l&&i&&(A=p.measureText(i).width,s[i]=A),l&&d===void 0&&(d=p.measureText(a).width,s[a]=d,f=d-A)}return{width:u*h,kernedWidth:f*h}}getHeightOfChar(e,t){return this.getValueOfPropertyAt(e,t,"fontSize")}measureLine(e){const t=this._measureLine(e);return this.charSpacing!==0&&(t.width-=this._getWidthOfCharSpacing()),t.width<0&&(t.width=0),t}_measureLine(e){let t,i,r=0;const s=this.pathSide===il,o=this.path,a=this._textLines[e],l=a.length,h=new Array(l);this.__charBounds[e]=h;for(let u=0;u<l;u++){const d=a[u];i=this._getGraphemeBox(d,e,u,t),h[u]=i,r+=i.kernedWidth,t=d}if(h[l]={left:i?i.left+i.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},o&&o.segmentsInfo){let u=0;const d=o.segmentsInfo[o.segmentsInfo.length-1].length;switch(this.textAlign){case uo:u=s?d-r:0;break;case ns:u=(d-r)/2;break;case il:u=s?0:d-r}u+=this.pathStartOffset*(s?-1:1);for(let A=s?l-1:0;s?A>=0:A<l;s?A--:A++)i=h[A],u>d?u%=d:u<0&&(u+=d),this._setGraphemeOnPath(u,i),u+=i.kernedWidth}return{width:r,numOfSpaces:0}}_setGraphemeOnPath(e,t){const i=e+t.kernedWidth/2,r=this.path,s=DX(r.path,i,r.segmentsInfo);t.renderLeft=s.x-r.pathOffset.x,t.renderTop=s.y-r.pathOffset.y,t.angle=s.angle+(this.pathSide===il?Math.PI:0)}_getGraphemeBox(e,t,i,r,s){const o=this.getCompleteStyleDeclaration(t,i),a=r?this.getCompleteStyleDeclaration(t,i-1):{},l=this._measureChar(e,o,r,a);let h,u=l.kernedWidth,d=l.width;this.charSpacing!==0&&(h=this._getWidthOfCharSpacing(),d+=h,u+=h);const A={width:d,left:0,height:o.fontSize,kernedWidth:u,deltaY:o.deltaY};if(i>0&&!s){const f=this.__charBounds[t][i-1];A.left=f.left+f.width+l.kernedWidth-l.width}return A}getHeightOfLine(e){if(this.__lineHeights[e])return this.__lineHeights[e];let t=this.getHeightOfChar(e,0);for(let i=1,r=this._textLines[e].length;i<r;i++)t=Math.max(this.getHeightOfChar(e,i),t);return this.__lineHeights[e]=t*this.lineHeight*this._fontSizeMult}calcTextHeight(){let e,t=0;for(let i=0,r=this._textLines.length;i<r;i++)e=this.getHeightOfLine(i),t+=i===r-1?e/this.lineHeight:e;return t}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(e,t){e.save();let i=0;const r=this._getLeftOffset(),s=this._getTopOffset();for(let o=0,a=this._textLines.length;o<a;o++){const l=this.getHeightOfLine(o),h=l/this.lineHeight,u=this._getLineLeftOffset(o);this._renderTextLine(t,e,this._textLines[o],r+u,s+i+h,o),i+=l}e.restore()}_renderTextFill(e){(this.fill||this.styleHas(bl))&&this._renderTextCommon(e,"fillText")}_renderTextStroke(e){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())}_renderChars(e,t,i,r,s,o){const a=this.getHeightOfLine(o),l=this.textAlign.includes(tA),h=this.path,u=!l&&this.charSpacing===0&&this.isEmptyStyles(o)&&!h,d=this.direction==="ltr",A=this.direction==="ltr"?1:-1,f=t.direction;let p,g,v,w,m,y="",x=0;if(t.save(),f!==this.direction&&(t.canvas.setAttribute("dir",d?"ltr":"rtl"),t.direction=d?"ltr":"rtl",t.textAlign=d?uo:il),s-=a*this._fontSizeFraction/this.lineHeight,u)return this._renderChar(e,t,o,0,i.join(""),r,s),void t.restore();for(let S=0,I=i.length-1;S<=I;S++)w=S===I||this.charSpacing||h,y+=i[S],v=this.__charBounds[o][S],x===0?(r+=A*(v.kernedWidth-v.width),x+=v.width):x+=v.kernedWidth,l&&!w&&this._reSpaceAndTab.test(i[S])&&(w=!0),w||(p=p||this.getCompleteStyleDeclaration(o,S),g=this.getCompleteStyleDeclaration(o,S+1),w=AS(p,g,!1)),w&&(h?(t.save(),t.translate(v.renderLeft,v.renderTop),t.rotate(v.angle),this._renderChar(e,t,o,S,y,-x/2,0),t.restore()):(m=r,this._renderChar(e,t,o,S,y,m,s)),y="",p=g,r+=A*x,x=0);t.restore()}_applyPatternGradientTransformText(e){const t=this.width+this.strokeWidth,i=this.height+this.strokeWidth,r=iu({width:t,height:i}),s=r.getContext("2d");return r.width=t,r.height=i,s.beginPath(),s.moveTo(0,0),s.lineTo(t,0),s.lineTo(t,i),s.lineTo(0,i),s.closePath(),s.translate(t/2,i/2),s.fillStyle=e.toLive(s),this._applyPatternGradientTransform(s,e),s.fill(),s.createPattern(r,"no-repeat")}handleFiller(e,t,i){let r,s;return Bu(i)?i.gradientUnits==="percentage"||i.gradientTransform||i.patternTransform?(r=-this.width/2,s=-this.height/2,e.translate(r,s),e[t]=this._applyPatternGradientTransformText(i),{offsetX:r,offsetY:s}):(e[t]=i.toLive(e),this._applyPatternGradientTransform(e,i)):(e[t]=i,{offsetX:0,offsetY:0})}_setStrokeStyles(e,t){let{stroke:i,strokeWidth:r}=t;return e.lineWidth=r,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",i)}_setFillStyles(e,t){let{fill:i}=t;return this.handleFiller(e,"fillStyle",i)}_renderChar(e,t,i,r,s,o,a){const l=this._getStyleDeclaration(i,r),h=this.getCompleteStyleDeclaration(i,r),u=e==="fillText"&&h.fill,d=e==="strokeText"&&h.stroke&&h.strokeWidth;if(d||u){if(t.save(),t.font=this._getFontDeclaration(h),l.textBackgroundColor&&this._removeShadow(t),l.deltaY&&(a+=l.deltaY),u){const A=this._setFillStyles(t,h);t.fillText(s,o-A.offsetX,a-A.offsetY)}if(d){const A=this._setStrokeStyles(t,h);t.strokeText(s,o-A.offsetX,a-A.offsetY)}t.restore()}}setSuperscript(e,t){this._setScript(e,t,this.superscript)}setSubscript(e,t){this._setScript(e,t,this.subscript)}_setScript(e,t,i){const r=this.get2DCursorLocation(e,!0),s=this.getValueOfPropertyAt(r.lineIndex,r.charIndex,"fontSize"),o=this.getValueOfPropertyAt(r.lineIndex,r.charIndex,"deltaY"),a={fontSize:s*i.size,deltaY:o+s*i.baseline};this.setSelectionStyles(a,e,t)}_getLineLeftOffset(e){const t=this.getLineWidth(e),i=this.width-t,r=this.textAlign,s=this.direction,o=this.isEndOfWrapping(e);let a=0;return r===tA||r===uw&&!o||r===hw&&!o||r===D_&&!o?0:(r===ns&&(a=i/2),r===il&&(a=i),r===uw&&(a=i/2),r===hw&&(a=i),s==="rtl"&&(r===il||r===tA||r===hw?a=0:r===uo||r===D_?a=-i:r!==ns&&r!==uw||(a=-i/2)),a)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(e){if(this.__lineWidths[e]!==void 0)return this.__lineWidths[e];const{width:t}=this.measureLine(e);return this.__lineWidths[e]=t,t}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(e,t,i){var r;return(r=this._getStyleDeclaration(e,t)[i])!==null&&r!==void 0?r:this[i]}_renderTextDecoration(e,t){if(!this[t]&&!this.styleHas(t))return;let i=this._getTopOffset();const r=this._getLeftOffset(),s=this.path,o=this._getWidthOfCharSpacing(),a=t==="linethrough"?.5:t==="overline"?1:0,l=this.offsets[t];for(let h=0,u=this._textLines.length;h<u;h++){const d=this.getHeightOfLine(h);if(!this[t]&&!this.styleHas(t,h)){i+=d;continue}const A=this._textLines[h],f=d/this.lineHeight,p=this._getLineLeftOffset(h);let g=0,v=0,w=this.getValueOfPropertyAt(h,0,t),m=this.getValueOfPropertyAt(h,0,bl),y=this.getValueOfPropertyAt(h,0,h0),x=w,S=m,I=y;const j=i+f*(1-this._fontSizeFraction);let C=this.getHeightOfChar(h,0),b=this.getValueOfPropertyAt(h,0,"deltaY");for(let k=0,B=A.length;k<B;k++){const E=this.__charBounds[h][k];x=this.getValueOfPropertyAt(h,k,t),S=this.getValueOfPropertyAt(h,k,bl),I=this.getValueOfPropertyAt(h,k,h0);const z=this.getHeightOfChar(h,k),te=this.getValueOfPropertyAt(h,k,"deltaY");if(s&&x&&S){const L=this.fontSize*I/1e3;e.save(),e.fillStyle=m,e.translate(E.renderLeft,E.renderTop),e.rotate(E.angle),e.fillRect(-E.kernedWidth/2,l*z+te-a*L,E.kernedWidth,L),e.restore()}else if((x!==w||S!==m||z!==C||I!==y||te!==b)&&v>0){const L=this.fontSize*y/1e3;let O=r+p+g;this.direction==="rtl"&&(O=this.width-O-v),w&&m&&y&&(e.fillStyle=m,e.fillRect(O,j+l*C+b-a*L,v,L)),g=E.left,v=E.width,w=x,y=I,m=S,C=z,b=te}else v+=E.kernedWidth}let D=r+p+g;this.direction==="rtl"&&(D=this.width-D-v),e.fillStyle=S;const T=this.fontSize*I/1e3;x&&S&&I&&e.fillRect(D,j+l*C+b-a*T,v-o,T),i+=d}this._removeShadow(e)}_getFontDeclaration(){let{fontFamily:e=this.fontFamily,fontStyle:t=this.fontStyle,fontWeight:i=this.fontWeight,fontSize:r=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;const o=e.includes("'")||e.includes('"')||e.includes(",")||pc.genericFonts.includes(e.toLowerCase())?e:'"'.concat(e,'"');return[t,i,"".concat(s?this.CACHE_FONT_SIZE:r,"px"),o].join(" ")}render(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(e)))}graphemeSplit(e){return dS(e)}_splitTextIntoLines(e){const t=e.split(this._reNewline),i=new Array(t.length),r=[`
`];let s=[];for(let o=0;o<t.length;o++)i[o]=this.graphemeSplit(t[o]),s=s.concat(i[o],r);return s.pop(),{_unwrappedLines:i,lines:t,graphemeText:s,graphemeLines:i}}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Ct(Ct({},super.toObject([...sX,...e])),{},{styles:vX(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(e,t){const{textLayoutProperties:i}=this.constructor;super.set(e,t);let r=!1,s=!1;if(typeof e=="object")for(const o in e)o==="path"&&this.setPathInfo(),r=r||i.includes(o),s=s||o==="path";else r=i.includes(e),s=e==="path";return s&&this.setPathInfo(),r&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(e,t,i){const r=Pf(e,pc.ATTRIBUTE_NAMES,i),s=Ct(Ct({},t),r),{textAnchor:o=uo,textDecoration:a="",dx:l=0,dy:h=0,top:u=0,left:d=0,fontSize:A=g8,strokeWidth:f=1}=s,p=ca(s,Ike),g=new this((e.textContent||"").replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),Ct({left:d+l,top:u+h,underline:a.includes("underline"),overline:a.includes("overline"),linethrough:a.includes("line-through"),strokeWidth:0,fontSize:A},p)),v=g.getScaledHeight()/g.height,w=((g.height+g.strokeWidth)*g.lineHeight-g.height)*v,m=g.getScaledHeight()+w;let y=0;return o===ns&&(y=g.getScaledWidth()/2),o===il&&(y=g.getScaledWidth()),g.set({left:g.left-y,top:g.top-(m-g.fontSize*(.07+g._fontSizeFraction))/g.lineHeight,strokeWidth:f}),g}static fromObject(e){return this._fromObject(Ct(Ct({},e),{},{styles:xX(e.styles||{},e.text)}),{extraParam:"text"})}}St(pc,"textLayoutProperties",rX),St(pc,"cacheProperties",[...jf,...sX]),St(pc,"ownDefaults",H6e),St(pc,"type","Text"),St(pc,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),St(pc,"ATTRIBUTE_NAMES",tg.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),pX(pc,[class extends tX{_toSVG(){const n=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(n.textTop,n.textLeft);return this._wrapSVGTextAndBg(e)}toSVG(n){const e=this._createBaseSVGMarkup(this._toSVG(),{reviver:n,noStyle:!0,withShadow:!0}),t=this.path;return t?e+t._createBaseSVGMarkup(t._toSVG(),{reviver:n,withShadow:!0,additionalTransform:p1(this.calcOwnMatrix())}):e}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(n){let{textBgRects:e,textSpans:t}=n;const i=this.getSvgTextDecoration(this);return[e.join(""),'		<text xml:space="preserve" ','font-family="'.concat(this.fontFamily.replace(kke,"'"),'" '),'font-size="'.concat(this.fontSize,'" '),this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",i?'text-decoration="'.concat(i,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",t.join(""),`</text>
`]}_getSVGTextAndBg(n,e){const t=[],i=[];let r,s=n;this.backgroundColor&&i.push(...ST(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let o=0,a=this._textLines.length;o<a;o++)r=this._getLineLeftOffset(o),this.direction==="rtl"&&(r+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",o))&&this._setSVGTextLineBg(i,o,e+r,s),this._setSVGTextLineText(t,o,e+r,s),s+=this.getHeightOfLine(o);return{textSpans:t,textBgRects:i}}_createTextCharSpan(n,e,t,i,r){const s=Ys.NUM_FRACTION_DIGITS,o=this.getSvgSpanStyles(e,n!==n.trim()||!!n.match(Fke)),a=o?'style="'.concat(o,'"'):"",l=e.deltaY,h=l?' dy="'.concat(No(l,s),'" '):"",{angle:u,renderLeft:d,renderTop:A,width:f}=r;let p="";if(d!==void 0){const g=f/2;u&&(p=' rotate="'.concat(No(vA(u),s),'"'));const v=S0({angle:vA(u)});v[4]=d,v[5]=A;const w=new qt(-g,0).transform(v);t=w.x,i=w.y}return'<tspan x="'.concat(No(t,s),'" y="').concat(No(i,s),'" ').concat(h).concat(p).concat(a,">").concat(wX(n),"</tspan>")}_setSVGTextLineText(n,e,t,i){const r=this.getHeightOfLine(e),s=this.textAlign.includes(tA),o=this._textLines[e];let a,l,h,u,d,A="",f=0;i+=r*(1-this._fontSizeFraction)/this.lineHeight;for(let p=0,g=o.length-1;p<=g;p++)d=p===g||this.charSpacing||this.path,A+=o[p],h=this.__charBounds[e][p],f===0?(t+=h.kernedWidth-h.width,f+=h.width):f+=h.kernedWidth,s&&!d&&this._reSpaceAndTab.test(o[p])&&(d=!0),d||(a=a||this.getCompleteStyleDeclaration(e,p),l=this.getCompleteStyleDeclaration(e,p+1),d=AS(a,l,!0)),d&&(u=this._getStyleDeclaration(e,p),n.push(this._createTextCharSpan(A,u,t,i,h)),A="",a=l,this.direction==="rtl"?t-=f:t+=f,f=0)}_setSVGTextLineBg(n,e,t,i){const r=this._textLines[e],s=this.getHeightOfLine(e)/this.lineHeight;let o,a=0,l=0,h=this.getValueOfPropertyAt(e,0,"textBackgroundColor");for(let u=0;u<r.length;u++){const{left:d,width:A,kernedWidth:f}=this.__charBounds[e][u];o=this.getValueOfPropertyAt(e,u,"textBackgroundColor"),o!==h?(h&&n.push(...ST(h,t+l,i,a,s)),l=d,a=A,h=o):a+=f}o&&n.push(...ST(h,t+l,i,a,s))}_getSVGLineTopOffset(n){let e,t=0;for(e=0;e<n;e++)t+=this.getHeightOfLine(e);const i=this.getHeightOfLine(e);return{lineTop:t,offset:(this._fontSizeMult-this._fontSizeFraction)*i/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(n){return"".concat(super.getSvgStyles(n)," text-decoration-thickness: ").concat(No(this.textDecorationThickness*this.getObjectScaling().y/10,Ys.NUM_FRACTION_DIGITS),"%; white-space: pre;")}getSvgSpanStyles(n,e){const{fontFamily:t,strokeWidth:i,stroke:r,fill:s,fontSize:o,fontStyle:a,fontWeight:l,deltaY:h,textDecorationThickness:u,linethrough:d,overline:A,underline:f}=n,p=this.getSvgTextDecoration({underline:f??this.underline,overline:A??this.overline,linethrough:d??this.linethrough}),g=u||this.textDecorationThickness;return[r?Hw(uh,r):"",i?"stroke-width: ".concat(i,"; "):"",t?"font-family: ".concat(t.includes("'")||t.includes('"')?t:"'".concat(t,"'"),"; "):"",o?"font-size: ".concat(o,"px; "):"",a?"font-style: ".concat(a,"; "):"",l?"font-weight: ".concat(l,"; "):"",p?"text-decoration: ".concat(p,"; text-decoration-thickness: ").concat(No(g*this.getObjectScaling().y/10,Ys.NUM_FRACTION_DIGITS),"%; "):"",s?Hw(bl,s):"",h?"baseline-shift: ".concat(-h,"; "):"",e?"white-space: pre; ":""].join("")}getSvgTextDecoration(n){return["overline","underline","line-through"].filter((e=>n[e.replace("-","")])).join(" ")}}]),Mi.setClass(pc),Mi.setSVGClass(pc);class Dke{constructor(e){St(this,"target",void 0),St(this,"__mouseDownInPlace",!1),St(this,"__dragStartFired",!1),St(this,"__isDraggingOver",!1),St(this,"__dragStartSelection",void 0),St(this,"__dragImageDisposer",void 0),St(this,"_dispose",void 0),this.target=e;const t=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{t.forEach((i=>i())),this._dispose=void 0}}isPointerOverSelection(e){const t=this.target,i=t.getSelectionStartFromPointer(e);return t.isEditing&&i>=t.selectionStart&&i<=t.selectionEnd&&t.selectionStart<t.selectionEnd}start(e){return this.__mouseDownInPlace=this.isPointerOverSelection(e)}isActive(){return this.__mouseDownInPlace}end(e){const t=this.isActive();return t&&!this.__dragStartFired&&(this.target.setCursorByClick(e),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,t}getDragStartSelection(){return this.__dragStartSelection}setDragImage(e,t){var i;let{selectionStart:r,selectionEnd:s}=t;const o=this.target,a=o.canvas,l=new qt(o.flipX?-1:1,o.flipY?-1:1),h=o._getCursorBoundaries(r),u=new qt(h.left+h.leftOffset,h.top+h.topOffset).multiply(l).transform(o.calcTransformMatrix()),d=a.getScenePoint(e).subtract(u),A=o.getCanvasRetinaScaling(),f=o.getBoundingRect(),p=u.subtract(new qt(f.left,f.top)),g=a.viewportTransform,v=p.add(d).transform(g,!0),w=o.backgroundColor,m=j8(o.styles);o.backgroundColor="";const y={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};o.setSelectionStyles(y,0,r),o.setSelectionStyles(y,s,o.text.length),o.dirty=!0;const x=o.toCanvasElement({enableRetinaScaling:a.enableRetinaScaling,viewportTransform:!0});o.backgroundColor=w,o.styles=m,o.dirty=!0,O_(x,{position:"fixed",left:"".concat(-x.width,"px"),border:hh,width:"".concat(x.width/A,"px"),height:"".concat(x.height/A,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{x.remove()},ud(e.target||this.target.hiddenTextarea).body.appendChild(x),(i=e.dataTransfer)===null||i===void 0||i.setDragImage(x,v.x,v.y)}onDragStart(e){this.__dragStartFired=!0;const t=this.target,i=this.isActive();if(i&&e.dataTransfer){const r=this.__dragStartSelection={selectionStart:t.selectionStart,selectionEnd:t.selectionEnd},s=t._text.slice(r.selectionStart,r.selectionEnd).join(""),o=Ct({text:t.text,value:s},r);e.dataTransfer.setData("text/plain",s),e.dataTransfer.setData("application/fabric",JSON.stringify({value:s,styles:t.getSelectionStyles(r.selectionStart,r.selectionEnd,!0)})),e.dataTransfer.effectAllowed="copyMove",this.setDragImage(e,o)}return t.abortCursorAnimation(),i}canDrop(e){if(this.target.editable&&!this.target.getActiveControl()&&!e.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const t=this.target.getSelectionStartFromPointer(e),i=this.__dragStartSelection;return t<i.selectionStart||t>i.selectionEnd}return!0}return!1}targetCanDrop(e){return this.target.canDrop(e)}dragEnterHandler(e){let{e:t}=e;const i=this.targetCanDrop(t);!this.__isDraggingOver&&i&&(this.__isDraggingOver=!0)}dragOverHandler(e){const{e:t}=e,i=this.targetCanDrop(t);!this.__isDraggingOver&&i?this.__isDraggingOver=!0:this.__isDraggingOver&&!i&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(t.preventDefault(),e.canDrop=!0,e.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(e){var t;const{e:i}=e,r=i.defaultPrevented;this.__isDraggingOver=!1,i.preventDefault();let s=(t=i.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain");if(s&&!r){const o=this.target,a=o.canvas;let l=o.getSelectionStartFromPointer(i);const{styles:h}=i.dataTransfer.types.includes("application/fabric")?JSON.parse(i.dataTransfer.getData("application/fabric")):{},u=s[Math.max(0,s.length-1)],d=0;if(this.__dragStartSelection){const A=this.__dragStartSelection.selectionStart,f=this.__dragStartSelection.selectionEnd;l>A&&l<=f?l=A:l>f&&(l-=f-A),o.removeChars(A,f),delete this.__dragStartSelection}o._reNewline.test(u)&&(o._reNewline.test(o._text[l])||l===o._text.length)&&(s=s.trimEnd()),e.didDrop=!0,e.dropTarget=o,o.insertChars(s,h,l),a.setActiveObject(o),o.enterEditing(i),o.selectionStart=Math.min(l+d,o._text.length),o.selectionEnd=Math.min(o.selectionStart+s.length,o._text.length),o.hiddenTextarea.value=o.text,o._updateTextarea(),o.hiddenTextarea.focus(),o.fire(B_,{index:l+d,action:"drop"}),a.fire("text:changed",{target:o}),a.contextTopDirty=!0,a.requestRenderAll()}}dragEndHandler(e){let{e:t}=e;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var i;const r=this.target,s=this.target.canvas,{selectionStart:o,selectionEnd:a}=this.__dragStartSelection,l=((i=t.dataTransfer)===null||i===void 0?void 0:i.dropEffect)||hh;l===hh?(r.selectionStart=o,r.selectionEnd=a,r._updateTextarea(),r.hiddenTextarea.focus()):(r.clearContextTop(),l==="move"&&(r.removeChars(o,a),r.selectionStart=r.selectionEnd=o,r.hiddenTextarea&&(r.hiddenTextarea.value=r.text),r._updateTextarea(),r.fire(B_,{index:o,action:"dragend"}),s.fire("text:changed",{target:r}),s.requestRenderAll()),r.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const N7=/[ \n\.,;!\?\-]/;class jke extends pc{constructor(){super(...arguments),St(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(e){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(e)}_animateCursor(e){let{toValue:t,duration:i,delay:r,onComplete:s}=e;return I8({startValue:this._currentCursorOpacity,endValue:t,duration:i,delay:r,onComplete:s,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:o=>{this._currentCursorOpacity=o,this.renderCursorOrSelection()}})}_tick(e){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(e||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var e;(e=this._currentTickCompleteState)===null||e===void 0||e.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(e){this.abortCursorAnimation(),this._tick(e?0:this.cursorDelay)}abortCursorAnimation(){let e=!1;[this._currentTickState,this._currentTickCompleteState].forEach((t=>{t&&!t.isDone()&&(e=!0,t.abort())})),this._currentCursorOpacity=1,e&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some((e=>!e||e.isDone()))&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}cmdAll(){this.selectAll(),this.renderCursorOrSelection()}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(e){let t=0,i=e-1;if(this._reSpace.test(this._text[i]))for(;this._reSpace.test(this._text[i]);)t++,i--;for(;/\S/.test(this._text[i])&&i>-1;)t++,i--;return e-t}findWordBoundaryRight(e){let t=0,i=e;if(this._reSpace.test(this._text[i]))for(;this._reSpace.test(this._text[i]);)t++,i++;for(;/\S/.test(this._text[i])&&i<this._text.length;)t++,i++;return e+t}findLineBoundaryLeft(e){let t=0,i=e-1;for(;!/\n/.test(this._text[i])&&i>-1;)t++,i--;return e-t}findLineBoundaryRight(e){let t=0,i=e;for(;!/\n/.test(this._text[i])&&i<this._text.length;)t++,i++;return e+t}searchWordBoundary(e,t){const i=this._text;let r=e>0&&this._reSpace.test(i[e])&&(t===-1||!m8.test(i[e-1]))?e-1:e,s=i[r];for(;r>0&&r<i.length&&!N7.test(s);)r+=t,s=i[r];return t===-1&&N7.test(s)&&r++,r}selectWord(e){var t;e=(t=e)!==null&&t!==void 0?t:this.selectionStart;const i=this.searchWordBoundary(e,-1),r=Math.max(i,this.searchWordBoundary(e,1));this.selectionStart=i,this.selectionEnd=r,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(e){var t;e=(t=e)!==null&&t!==void 0?t:this.selectionStart;const i=this.findLineBoundaryLeft(e),r=this.findLineBoundaryRight(e);this.selectionStart=i,this.selectionEnd=r,this._fireSelectionChanged(),this._updateTextarea()}enterEditing(e){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",e?{e}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(e){if(this.getActiveControl())return;const t=this.hiddenTextarea;ud(t).activeElement!==t&&t.focus();const i=this.getSelectionStartFromPointer(e),r=this.selectionStart,s=this.selectionEnd;(i===this.__selectionStartOnMouseDown&&r!==s||r!==i&&s!==i)&&(i>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=i):(this.selectionStart=i,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===r&&this.selectionEnd===s||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(e,t,i){const r=i.slice(0,e),s=this.graphemeSplit(r).length;if(e===t)return{selectionStart:s,selectionEnd:s};const o=i.slice(e,t);return{selectionStart:s,selectionEnd:s+this.graphemeSplit(o).length}}fromGraphemeToStringSelection(e,t,i){const r=i.slice(0,e).join("").length;return e===t?{selectionStart:r,selectionEnd:r}:{selectionStart:r,selectionEnd:r+i.slice(e,t).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};const e=this.hiddenTextarea;this.text=e.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();const t=this.fromStringToGraphemeSelection(e.selectionStart,e.selectionEnd,e.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const e=this.inCompositionMode?this.compositionStart:this.selectionStart,t=this._getCursorBoundaries(e),i=this.get2DCursorLocation(e),r=i.lineIndex,s=i.charIndex,o=this.getValueOfPropertyAt(r,s,"fontSize")*this.lineHeight,a=t.leftOffset,l=this.getCanvasRetinaScaling(),h=this.canvas.upperCanvasEl,u=h.width/l,d=h.height/l,A=u-o,f=d-o,p=new qt(t.left+a,t.top+t.topOffset+o).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new qt(h.clientWidth/u,h.clientHeight/d));return p.x<0&&(p.x=0),p.x>A&&(p.x=A),p.y<0&&(p.y=0),p.y>f&&(p.y=f),p.x+=this.canvas._offset.left,p.y+=this.canvas._offset.top,{left:"".concat(p.x,"px"),top:"".concat(p.y,"px"),fontSize:"".concat(o,"px"),charHeight:o}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){const e=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditingImpl(){this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){const e=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),e&&this.fire(E_),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const e in this.styles)this._textLines[e]||delete this.styles[e]}removeStyleFromTo(e,t){const{lineIndex:i,charIndex:r}=this.get2DCursorLocation(e,!0),{lineIndex:s,charIndex:o}=this.get2DCursorLocation(t,!0);if(i!==s){if(this.styles[i])for(let a=r;a<this._unwrappedTextLines[i].length;a++)delete this.styles[i][a];if(this.styles[s])for(let a=o;a<this._unwrappedTextLines[s].length;a++){const l=this.styles[s][a];l&&(this.styles[i]||(this.styles[i]={}),this.styles[i][r+a-o]=l)}for(let a=i+1;a<=s;a++)delete this.styles[a];this.shiftLineStyles(s,i-s)}else if(this.styles[i]){const a=this.styles[i],l=o-r;for(let h=r;h<o;h++)delete a[h];for(const h in this.styles[i]){const u=parseInt(h,10);u>=o&&(a[u-l]=a[h],delete a[h])}}}shiftLineStyles(e,t){const i=Object.assign({},this.styles);for(const r in this.styles){const s=parseInt(r,10);s>e&&(this.styles[s+t]=i[s],i[s-t]||delete this.styles[s])}}insertNewlineStyleObject(e,t,i,r){const s={},o=this._unwrappedTextLines[e].length,a=o===t;let l=!1;i||(i=1),this.shiftLineStyles(e,i);const h=this.styles[e]?this.styles[e][t===0?t:t-1]:void 0;for(const d in this.styles[e]){const A=parseInt(d,10);A>=t&&(l=!0,s[A-t]=this.styles[e][d],a&&t===0||delete this.styles[e][d])}let u=!1;for(l&&!a&&(this.styles[e+i]=s,u=!0),(u||o>t)&&i--;i>0;)r&&r[i-1]?this.styles[e+i]={0:Ct({},r[i-1])}:h?this.styles[e+i]={0:Ct({},h)}:delete this.styles[e+i],i--;this._forceClearCache=!0}insertCharStyleObject(e,t,i,r){this.styles||(this.styles={});const s=this.styles[e],o=s?Ct({},s):{};i||(i=1);for(const l in o){const h=parseInt(l,10);h>=t&&(s[h+i]=o[h],o[h-i]||delete s[h])}if(this._forceClearCache=!0,r){for(;i--;)Object.keys(r[i]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][t+i]=Ct({},r[i]));return}if(!s)return;const a=s[t?t-1:1];for(;a&&i--;)this.styles[e][t+i]=Ct({},a)}insertNewStyleBlock(e,t,i){const r=this.get2DCursorLocation(t,!0),s=[0];let o,a=0;for(let l=0;l<e.length;l++)e[l]===`
`?(a++,s[a]=0):s[a]++;for(s[0]>0&&(this.insertCharStyleObject(r.lineIndex,r.charIndex,s[0],i),i=i&&i.slice(s[0]+1)),a&&this.insertNewlineStyleObject(r.lineIndex,r.charIndex+s[0],a),o=1;o<a;o++)s[o]>0?this.insertCharStyleObject(r.lineIndex+o,0,s[o],i):i&&this.styles[r.lineIndex+o]&&i[0]&&(this.styles[r.lineIndex+o][0]=i[0]),i=i&&i.slice(s[o]+1);s[o]>0&&this.insertCharStyleObject(r.lineIndex+o,0,s[o],i)}removeChars(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e+1;this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(e,t,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:i;r>i&&this.removeStyleFromTo(i,r);const s=this.graphemeSplit(e);this.insertNewStyleBlock(s,i,t),this._text=[...this._text.slice(0,i),...s,...this._text.slice(r)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(e,t,i){i<=e?(t===e?this._selectionDirection=uo:this._selectionDirection===il&&(this._selectionDirection=uo,this.selectionEnd=e),this.selectionStart=i):i>e&&i<t?this._selectionDirection===il?this.selectionEnd=i:this.selectionStart=i:(t===e?this._selectionDirection=il:this._selectionDirection===uo&&(this._selectionDirection=il,this.selectionStart=t),this.selectionEnd=i)}}class Pke extends jke{initHiddenTextarea(){const e=this.canvas&&ud(this.canvas.getElement())||N1(),t=e.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off"}).map((o=>{let[a,l]=o;return t.setAttribute(a,l)}));const{top:i,left:r,fontSize:s}=this._calcTextareaPosition();t.style.cssText="position: absolute; top: ".concat(i,"; left: ").concat(r,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(s,";"),(this.hiddenTextareaContainer||e.body).appendChild(t),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map((o=>{let[a,l]=o;return t.addEventListener(a,this[l].bind(this))})),this.hiddenTextarea=t}blur(){this.abortCursorAnimation()}onKeyDown(e){if(!this.isEditing)return;const t=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(e){const t=this.fromPaste,{value:i,selectionStart:r,selectionEnd:s}=this.hiddenTextarea;if(this.fromPaste=!1,e&&e.stopPropagation(),!this.isEditing)return;const o=()=>{this.updateFromTextArea(),this.fire(B_),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void o();const a=this._splitTextIntoLines(i).graphemeText,l=this._text.length,h=a.length,u=this.selectionStart,d=this.selectionEnd,A=u!==d;let f,p,g,v,w=h-l;const m=this.fromStringToGraphemeSelection(r,s,i),y=u>m.selectionStart;A?(p=this._text.slice(u,d),w+=d-u):h<l&&(p=y?this._text.slice(d+w,d):this._text.slice(u,u-w));const x=a.slice(m.selectionEnd-w,m.selectionEnd);if(p&&p.length&&(x.length&&(f=this.getSelectionStyles(u,u+1,!1),f=x.map((()=>f[0]))),A?(g=u,v=d):y?(g=d-p.length,v=d):(g=d,v=d+p.length),this.removeStyleFromTo(g,v)),x.length){const{copyPasteData:S}=yA();t&&x.join("")===S.copiedText&&!Ys.disableStyleCopyPaste&&(f=S.copiedTextStyle),this.insertNewStyleBlock(x,u,f)}o()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(e){let{target:t}=e;const{selectionStart:i,selectionEnd:r}=t;this.compositionStart=i,this.compositionEnd=r,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:e}=yA();e.copiedText=this.getSelectedText(),Ys.disableStyleCopyPaste?e.copiedTextStyle=void 0:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(e,t){let i,r=this._getLineLeftOffset(e);return t>0&&(i=this.__charBounds[e][t-1],r+=i.left+i.width),r}getDownCursorOffset(e,t){const i=this._getSelectionForOffset(e,t),r=this.get2DCursorLocation(i),s=r.lineIndex;if(s===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-i;const o=r.charIndex,a=this._getWidthBeforeCursor(s,o),l=this._getIndexOnLine(s+1,a);return this._textLines[s].slice(o).length+l+1+this.missingNewlineOffset(s)}_getSelectionForOffset(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart}getUpCursorOffset(e,t){const i=this._getSelectionForOffset(e,t),r=this.get2DCursorLocation(i),s=r.lineIndex;if(s===0||e.metaKey||e.keyCode===33)return-i;const o=r.charIndex,a=this._getWidthBeforeCursor(s,o),l=this._getIndexOnLine(s-1,a),h=this._textLines[s].slice(0,o),u=this.missingNewlineOffset(s-1);return-this._textLines[s-1].length+l-h.length+(1-u)}_getIndexOnLine(e,t){const i=this._textLines[e];let r,s,o=this._getLineLeftOffset(e),a=0;for(let l=0,h=i.length;l<h;l++)if(r=this.__charBounds[e][l].width,o+=r,o>t){s=!0;const u=o-r,d=o,A=Math.abs(u-t);a=Math.abs(d-t)<A?l:l-1;break}return s||(a=i.length-1),a}moveCursorDown(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)}moveCursorUp(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)}_moveCursorUpOrDown(e,t){const i=this["get".concat(e,"CursorOffset")](t,this._selectionDirection===il);if(t.shiftKey?this.moveCursorWithShift(i):this.moveCursorWithoutShift(i),i!==0){const r=this.text.length;this.selectionStart=u0(0,this.selectionStart,r),this.selectionEnd=u0(0,this.selectionEnd,r),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(e){const t=this._selectionDirection===uo?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),e!==0}moveCursorWithoutShift(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0}moveCursorLeft(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)}_move(e,t,i){let r;if(e.altKey)r=this["findWordBoundary".concat(i)](this[t]);else{if(!e.metaKey&&e.keyCode!==35&&e.keyCode!==36)return this[t]+=i==="Left"?-1:1,!0;r=this["findLineBoundary".concat(i)](this[t])}return r!==void 0&&this[t]!==r&&(this[t]=r,!0)}_moveLeft(e,t){return this._move(e,t,"Left")}_moveRight(e,t){return this._move(e,t,"Right")}moveCursorLeftWithoutShift(e){let t=!0;return this._selectionDirection=uo,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t}moveCursorLeftWithShift(e){return this._selectionDirection===il&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=uo,this._moveLeft(e,"selectionStart")):void 0}moveCursorRight(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)}_moveCursorLeftOrRight(e,t){const i="moveCursor".concat(e).concat(t.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[i](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(e){return this._selectionDirection===uo&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=il,this._moveRight(e,"selectionEnd")):void 0}moveCursorRightWithoutShift(e){let t=!0;return this._selectionDirection=il,this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t}}const L7=n=>!!n.button;class Nke extends Pke{constructor(){super(...arguments),St(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("mousetripleclick",this.tripleClickHandler),this.draggableTextDelegate=new Dke(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(e){return this.draggableTextDelegate.onDragStart(e)}canDrop(e){return this.draggableTextDelegate.canDrop(e)}doubleClickHandler(e){this.isEditing&&(this.selectWord(this.getSelectionStartFromPointer(e.e)),this.renderCursorOrSelection())}tripleClickHandler(e){this.isEditing&&(this.selectLine(this.getSelectionStartFromPointer(e.e)),this.renderCursorOrSelection())}_mouseDownHandler(e){let{e:t,alreadySelected:i}=e;this.canvas&&this.editable&&!L7(t)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(t)||(this.canvas.textEditingManager.register(this),i&&(this.inCompositionMode=!1,this.setCursorByClick(t)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()),this.selected||(this.selected=i||this.isEditing)))}mouseUpHandler(e){let{e:t,transform:i}=e;const r=this.draggableTextDelegate.end(t);if(this.canvas){this.canvas.textEditingManager.unregister(this);const s=this.canvas._activeObject;if(s&&s!==this)return}!this.editable||this.group&&!this.group.interactive||i&&i.actionPerformed||L7(t)||r||this.selected&&!this.getActiveControl()&&(this.enterEditing(t),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection())}setCursorByClick(e){const t=this.getSelectionStartFromPointer(e),i=this.selectionStart,r=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(i,r,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(e){const t=this.canvas.getScenePoint(e).transform(Dh(this.calcTransformMatrix())).add(new qt(-this._getLeftOffset(),-this._getTopOffset()));let i=0,r=0,s=0;for(let h=0;h<this._textLines.length&&i<=t.y;h++)i+=this.getHeightOfLine(h),s=h,h>0&&(r+=this._textLines[h-1].length+this.missingNewlineOffset(h-1));let o=Math.abs(this._getLineLeftOffset(s));const a=this._textLines[s].length,l=this.__charBounds[s];for(let h=0;h<a;h++){const u=o+l[h].kernedWidth;if(t.x<=u){Math.abs(t.x-u)<=Math.abs(t.x-o)&&r++;break}o=u,r++}return Math.min(this.flipX?a-r:r,this._text.length)}}const gb="moveCursorUp",mb="moveCursorDown",yb="moveCursorLeft",wb="moveCursorRight",vb="exitEditing",M7=(n,e)=>{const t=e.getRetinaScaling();n.setTransform(t,0,0,t,0,0);const i=e.viewportTransform;n.transform(i[0],i[1],i[2],i[3],i[4],i[5])},Lke=Ct({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:vb,27:vb,33:gb,34:mb,35:wb,36:yb,37:yb,38:gb,39:wb,40:mb},keysMapRtl:{9:vb,27:vb,33:gb,34:mb,35:yb,36:wb,37:wb,38:gb,39:yb,40:mb},ctrlKeysMapDown:{65:"cmdAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1});class gd extends Nke{static getDefaults(){return Ct(Ct({},super.getDefaults()),gd.ownDefaults)}get type(){const e=super.type;return e==="itext"?"i-text":e}constructor(e,t){super(e,Ct(Ct({},gd.ownDefaults),t)),this.initBehavior()}_set(e,t){return this.isEditing&&this._savedProps&&e in this._savedProps?(this._savedProps[e]=t,this):(e==="canvas"&&(this.canvas instanceof S6&&this.canvas.textEditingManager.remove(this),t instanceof S6&&t.textEditingManager.add(this)),super._set(e,t))}setSelectionStart(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)}setSelectionEnd(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)}_updateAndFire(e,t){this[e]!==t&&(this._fireSelectionChanged(),this[e]=t),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,i=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(e,t,i)}setSelectionStyles(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(e,t,i)}get2DCursorLocation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(e,t)}render(e){super.render(e),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(e){const t=this.isEditing;this.isEditing=!1;const i=super.toCanvasElement(e);return this.isEditing=t,i}renderCursorOrSelection(){if(!this.isEditing||!this.canvas)return;const e=this.clearContextTop(!0);if(!e)return;const t=this._getCursorBoundaries(),i=this.findAncestorsWithClipPath(),r=i.length>0;let s,o=e;if(r){s=iu(e.canvas),o=s.getContext("2d"),M7(o,this.canvas);const a=this.calcTransformMatrix();o.transform(a[0],a[1],a[2],a[3],a[4],a[5])}if(this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(o,t):this.renderCursor(o,t),r)for(const a of i){const l=a.clipPath,h=iu(e.canvas),u=h.getContext("2d");if(M7(u,this.canvas),!l.absolutePositioned){const d=a.calcTransformMatrix();u.transform(d[0],d[1],d[2],d[3],d[4],d[5])}l.transform(u),l.drawObject(u,!0,{}),this.drawClipPathOnCache(o,l,h)}r&&(e.setTransform(1,0,0,1,0,0),e.drawImage(s,0,0)),this.canvas.contextTopDirty=!0,e.restore()}findAncestorsWithClipPath(){const e=[];let t=this;for(;t;)t.clipPath&&e.push(t),t=t.parent;return e}_getCursorBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;const i=this._getLeftOffset(),r=this._getTopOffset(),s=this._getCursorBoundariesOffsets(e,t);return{left:i,top:r,leftOffset:s.left,topOffset:s.top}}_getCursorBoundariesOffsets(e,t){return t?this.__getCursorBoundariesOffsets(e):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(e)}__getCursorBoundariesOffsets(e){let t=0,i=0;const{charIndex:r,lineIndex:s}=this.get2DCursorLocation(e);for(let h=0;h<s;h++)t+=this.getHeightOfLine(h);const o=this._getLineLeftOffset(s),a=this.__charBounds[s][r];a&&(i=a.left),this.charSpacing!==0&&r===this._textLines[s].length&&(i-=this._getWidthOfCharSpacing());const l={top:t,left:o+(i>0?i:0)};return this.direction==="rtl"&&(this.textAlign===il||this.textAlign===tA||this.textAlign===hw?l.left*=-1:this.textAlign===uo||this.textAlign===D_?l.left=o-(i>0?i:0):this.textAlign!==ns&&this.textAlign!==uw||(l.left=o-(i>0?i:0))),l}renderCursorAt(e){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(e,!0),e)}renderCursor(e,t){this._renderCursor(e,t,this.selectionStart)}getCursorRenderingData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(e);const i=this.get2DCursorLocation(e),r=i.lineIndex,s=i.charIndex>0?i.charIndex-1:0,o=this.getValueOfPropertyAt(r,s,"fontSize"),a=this.getObjectScaling().x*this.canvas.getZoom(),l=this.cursorWidth/a,h=this.getValueOfPropertyAt(r,s,"deltaY"),u=t.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(r)/this.lineHeight-o*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(r,s,"fill"),opacity:this._currentCursorOpacity,left:t.left+t.leftOffset-l/2,top:u+t.top+h,width:l,height:o}}_renderCursor(e,t,i){const{color:r,opacity:s,left:o,top:a,width:l,height:h}=this.getCursorRenderingData(i,t);e.fillStyle=r,e.globalAlpha=s,e.fillRect(o,a,l,h)}renderSelection(e,t){const i={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(e,i,t)}renderDragSourceEffect(){const e=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,e,this._getCursorBoundaries(e.selectionStart,!0))}renderDropTargetEffect(e){const t=this.getSelectionStartFromPointer(e);this.renderCursorAt(t)}_renderSelection(e,t,i){const r=t.selectionStart,s=t.selectionEnd,o=this.textAlign.includes(tA),a=this.get2DCursorLocation(r),l=this.get2DCursorLocation(s),h=a.lineIndex,u=l.lineIndex,d=a.charIndex<0?0:a.charIndex,A=l.charIndex<0?0:l.charIndex;for(let f=h;f<=u;f++){const p=this._getLineLeftOffset(f)||0;let g=this.getHeightOfLine(f),v=0,w=0,m=0;if(f===h&&(w=this.__charBounds[h][d].left),f>=h&&f<u)m=o&&!this.isEndOfWrapping(f)?this.width:this.getLineWidth(f)||5;else if(f===u)if(A===0)m=this.__charBounds[u][A].left;else{const j=this._getWidthOfCharSpacing();m=this.__charBounds[u][A-1].left+this.__charBounds[u][A-1].width-j}v=g,(this.lineHeight<1||f===u&&this.lineHeight>1)&&(g/=this.lineHeight);let y=i.left+p+w,x=g,S=0;const I=m-w;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",x=1,S=g):e.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===il||this.textAlign===tA||this.textAlign===hw?y=this.width-y-I:this.textAlign===uo||this.textAlign===D_?y=i.left+p-m:this.textAlign!==ns&&this.textAlign!==uw||(y=i.left+p-m)),e.fillRect(y,i.top+i.topOffset+S,I,x),i.topOffset+=v}}getCurrentCharFontSize(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")}getCurrentCharColor(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,bl)}_getCurrentCharIndex(){const e=this.get2DCursorLocation(this.selectionStart,!0),t=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:t}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}}St(gd,"ownDefaults",Lke),St(gd,"type","IText"),Mi.setClass(gd),Mi.setClass(gd,"i-text");class Mg extends gd{static getDefaults(){return Ct(Ct({},super.getDefaults()),Mg.ownDefaults)}constructor(e,t){super(e,Ct(Ct({},Mg.ownDefaults),t))}static createControls(){return{controls:vFe()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(tA)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(e){let t=0,i=0,r=0;const s={};for(let o=0;o<e.graphemeLines.length;o++)e.graphemeText[r]===`
`&&o>0?(i=0,r++,t++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[r])&&o>0&&(i++,r++),s[o]={line:t,offset:i},r+=e.graphemeLines[o].length,i+=e.graphemeLines[o].length;return s}styleHas(e,t){if(this._styleMap&&!this.isWrapping){const i=this._styleMap[t];i&&(t=i.line)}return super.styleHas(e,t)}isEmptyStyles(e){if(!this.styles)return!0;let t,i=0,r=e+1,s=!1;const o=this._styleMap[e],a=this._styleMap[e+1];o&&(e=o.line,i=o.offset),a&&(r=a.line,s=r===e,t=a.offset);const l=e===void 0?this.styles:{line:this.styles[e]};for(const h in l)for(const u in l[h]){const d=parseInt(u,10);if(d>=i&&(!s||d<t))for(const A in l[h][u])return!1}return!0}_getStyleDeclaration(e,t){if(this._styleMap&&!this.isWrapping){const i=this._styleMap[e];if(!i)return{};e=i.line,t=i.offset+t}return super._getStyleDeclaration(e,t)}_setStyleDeclaration(e,t,i){const r=this._styleMap[e];super._setStyleDeclaration(r.line,r.offset+t,i)}_deleteStyleDeclaration(e,t){const i=this._styleMap[e];super._deleteStyleDeclaration(i.line,i.offset+t)}_getLineStyle(e){const t=this._styleMap[e];return!!this.styles[t.line]}_setLineStyle(e){const t=this._styleMap[e];super._setLineStyle(t.line)}_wrapText(e,t){this.isWrapping=!0;const i=this.getGraphemeDataForRender(e),r=[];for(let s=0;s<i.wordsData.length;s++)r.push(...this._wrapLine(s,t,i));return this.isWrapping=!1,r}getGraphemeDataForRender(e){const t=this.splitByGrapheme,i=t?"":" ";let r=0;return{wordsData:e.map(((s,o)=>{let a=0;const l=t?this.graphemeSplit(s):this.wordSplit(s);return l.length===0?[{word:[],width:0}]:l.map((h=>{const u=t?[h]:this.graphemeSplit(h),d=this._measureWord(u,o,a);return r=Math.max(d,r),a+=u.length+i.length,{word:u,width:d}}))})),largestWordWidth:r}}_measureWord(e,t){let i,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=0;for(let o=0,a=e.length;o<a;o++)s+=this._getGraphemeBox(e[o],t,o+r,i,!0).kernedWidth,i=e[o];return s}wordSplit(e){return e.split(this._wordJoiners)}_wrapLine(e,t,i){let{largestWordWidth:r,wordsData:s}=i,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const a=this._getWidthOfCharSpacing(),l=this.splitByGrapheme,h=[],u=l?"":" ";let d=0,A=[],f=0,p=0,g=!0;t-=o;const v=Math.max(t,r,this.dynamicMinWidth),w=s[e];let m;for(f=0,m=0;m<w.length;m++){const{word:y,width:x}=w[m];f+=y.length,d+=p+x-a,d>v&&!g?(h.push(A),A=[],d=x,g=!0):d+=a,g||l||A.push(u),A=A.concat(y),p=l?0:this._measureWord([u],e,f),f++,g=!1}return m&&h.push(A),r+o>this.dynamicMinWidth&&(this.dynamicMinWidth=r-a+o),h}isEndOfWrapping(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line}missingNewlineOffset(e,t){return this.splitByGrapheme&&!t?this.isEndOfWrapping(e)?1:0:1}_splitTextIntoLines(e){const t=super._splitTextIntoLines(e),i=this._wrapText(t.lines,this.width),r=new Array(i.length);for(let s=0;s<i.length;s++)r[s]=i[s].join("");return t.lines=r,t.graphemeLines=i,t}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const e=new Map;for(const t in this._styleMap){const i=parseInt(t,10);if(this._textLines[i]){const r=this._styleMap[t].line;e.set("".concat(r),!0)}}for(const t in this.styles)e.has(t)||delete this.styles[t]}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...e])}}St(Mg,"type","Textbox"),St(Mg,"textLayoutProperties",[...gd.textLayoutProperties,"width"]),St(Mg,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),Mi.setClass(Mg);class R7 extends fS{shouldPerformLayout(e){return!!e.target.clipPath&&super.shouldPerformLayout(e)}shouldLayoutClipPath(){return!1}calcLayoutResult(e,t){const{target:i}=e,{clipPath:r,group:s}=i;if(!r||!this.shouldPerformLayout(e))return;const{width:o,height:a}=dA(CX(i,r)),l=new qt(o,a);if(r.absolutePositioned)return{center:Yg(r.getRelativeCenterPoint(),void 0,s?s.calcTransformMatrix():void 0),size:l};{const h=r.getRelativeCenterPoint().transform(i.calcOwnMatrix(),!0);if(this.shouldPerformLayout(e)){const{center:u=new qt,correction:d=new qt}=this.calcBoundingBox(t,e)||{};return{center:u.add(h),correction:d.subtract(h),size:l}}return{center:i.getRelativeCenterPoint().add(h),size:l}}}}St(R7,"type","clip-path"),Mi.setClass(R7);class U7 extends fS{getInitialSize(e,t){let{target:i}=e,{size:r}=t;return new qt(i.width||r.x,i.height||r.y)}}St(U7,"type","fixed"),Mi.setClass(U7);class Mke extends zw{subscribeTargets(e){const t=e.target;e.targets.reduce(((i,r)=>(r.parent&&i.add(r.parent),i)),new Set).forEach((i=>{i.layoutManager.subscribeTargets({target:i,targets:[t]})}))}unsubscribeTargets(e){const t=e.target,i=t.getObjects();e.targets.reduce(((r,s)=>(s.parent&&r.add(s.parent),r)),new Set).forEach((r=>{!i.some((s=>s.parent===r))&&r.layoutManager.unsubscribeTargets({target:r,targets:[t]})}))}}class Rg extends Jh{static getDefaults(){return Ct(Ct({},super.getDefaults()),Rg.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,Rg.ownDefaults),this.setOptions(t);const{left:i,top:r,layoutManager:s}=t;this.groupInit(e,{left:i,top:r,layoutManager:s??new Mke})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.multiSelectionStacking==="selection-order"?this.add(...t):t.forEach((r=>{const s=this._objects.findIndex((a=>a.isInFrontOf(r))),o=s===-1?this.size():s;this.insertAt(o,r)}))}canEnterGroup(e){return this.getObjects().some((t=>t.isDescendantOf(e)||e.isDescendantOf(t)))?(Sf("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(e)}enterGroup(e,t){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,t)}exitGroup(e,t){this._exitGroup(e,t),e.parent&&e.parent._enterGroup(e,!0)}_onAfterObjectsChange(e,t){super._onAfterObjectsChange(e,t);const i=new Set;t.forEach((r=>{const{parent:s}=r;s&&i.add(s)})),e===N8?i.forEach((r=>{r._onAfterObjectsChange(M_,t)})):i.forEach((r=>{r._set("dirty",!0)}))}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(e,t,i){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const r=Ct(Ct({hasControls:!1},i),{},{forActiveSelection:!0});for(let s=0;s<this._objects.length;s++)this._objects[s]._renderControls(e,r);super._renderControls(e,t),e.restore()}}St(Rg,"type","ActiveSelection"),St(Rg,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),Mi.setClass(Rg),Mi.setClass(Rg,"activeSelection");class Rke{constructor(){St(this,"resources",{})}applyFilters(e,t,i,r,s){const o=s.getContext("2d");if(!o)return;o.drawImage(t,0,0,i,r);const a={sourceWidth:i,sourceHeight:r,imageData:o.getImageData(0,0,i,r),originalEl:t,originalImageData:o.getImageData(0,0,i,r),canvasEl:s,ctx:o,filterBackend:this};e.forEach((h=>{h.applyTo(a)}));const{imageData:l}=a;return l.width===i&&l.height===r||(s.width=l.width,s.height=l.height),o.putImageData(l,0,0),a}}class QX{constructor(){let{tileSize:e=Ys.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};St(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),St(this,"resources",{}),this.tileSize=e,this.setupGLContext(e,e),this.captureGPUInfo()}setupGLContext(e,t){this.dispose(),this.createWebGLCanvas(e,t)}createWebGLCanvas(e,t){const i=iu({width:e,height:t}),r=i.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});r&&(r.clearColor(0,0,0,0),this.canvas=i,this.gl=r)}applyFilters(e,t,i,r,s,o){const a=this.gl,l=s.getContext("2d");if(!a||!l)return;let h;o&&(h=this.getCachedTexture(o,t));const u={originalWidth:t.width||t.naturalWidth||0,originalHeight:t.height||t.naturalHeight||0,sourceWidth:i,sourceHeight:r,destinationWidth:i,destinationHeight:r,context:a,sourceTexture:this.createTexture(a,i,r,h?void 0:t),targetTexture:this.createTexture(a,i,r),originalTexture:h||this.createTexture(a,i,r,h?void 0:t),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:s},d=a.createFramebuffer();return a.bindFramebuffer(a.FRAMEBUFFER,d),e.forEach((A=>{A&&A.applyTo(u)})),(function(A){const f=A.targetCanvas,p=f.width,g=f.height,v=A.destinationWidth,w=A.destinationHeight;p===v&&g===w||(f.width=v,f.height=w)})(u),this.copyGLTo2D(a,u),a.bindTexture(a.TEXTURE_2D,null),a.deleteTexture(u.sourceTexture),a.deleteTexture(u.targetTexture),a.deleteFramebuffer(d),l.setTransform(1,0,0,1,0,0),u}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(e,t,i,r,s){const{NEAREST:o,TEXTURE_2D:a,RGBA:l,UNSIGNED_BYTE:h,CLAMP_TO_EDGE:u,TEXTURE_MAG_FILTER:d,TEXTURE_MIN_FILTER:A,TEXTURE_WRAP_S:f,TEXTURE_WRAP_T:p}=e,g=e.createTexture();return e.bindTexture(a,g),e.texParameteri(a,d,s||o),e.texParameteri(a,A,s||o),e.texParameteri(a,f,u),e.texParameteri(a,p,u),r?e.texImage2D(a,0,l,l,h,r):e.texImage2D(a,0,l,t,i,0,l,h,null),g}getCachedTexture(e,t,i){const{textureCache:r}=this;if(r[e])return r[e];{const s=this.createTexture(this.gl,t.width,t.height,t,i);return s&&(r[e]=s),s}}evictCachesForKey(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])}copyGLTo2D(e,t){const i=e.canvas,r=t.targetCanvas,s=r.getContext("2d");if(!s)return;s.translate(0,r.height),s.scale(1,-1);const o=i.height-r.height;s.drawImage(i,0,o,r.width,r.height,0,0,r.width,r.height)}copyGLTo2DPutImageData(e,t){const i=t.targetCanvas.getContext("2d"),r=t.destinationWidth,s=t.destinationHeight,o=r*s*4;if(!i)return;const a=new Uint8Array(this.imageBuffer,0,o),l=new Uint8ClampedArray(this.imageBuffer,0,o);e.readPixels(0,0,r,s,e.RGBA,e.UNSIGNED_BYTE,a);const h=new ImageData(l,r,s);i.putImageData(h,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const e=this.gl,t={renderer:"",vendor:""};if(!e)return t;const i=e.getExtension("WEBGL_debug_renderer_info");if(i){const r=e.getParameter(i.UNMASKED_RENDERER_WEBGL),s=e.getParameter(i.UNMASKED_VENDOR_WEBGL);r&&(t.renderer=r.toLowerCase()),s&&(t.vendor=s.toLowerCase())}return this.gpuInfo=t,t}}let BT;function Uke(){const{WebGLProbe:n}=yA();return n.queryWebGL(wA()),Ys.enableGLFiltering&&n.isSupported(Ys.textureSize)?new QX({tileSize:Ys.textureSize}):new Rke}function ET(){return!BT&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(BT=Uke()),BT}const Oke=["filters","resizeFilter","src","crossOrigin","type"],$X=["cropX","cropY"];class Gh extends Qc{static getDefaults(){return Ct(Ct({},super.getDefaults()),Gh.ownDefaults)}constructor(e,t){super(),St(this,"_lastScaleX",1),St(this,"_lastScaleY",1),St(this,"_filterScalingX",1),St(this,"_filterScalingY",1),this.filters=[],Object.assign(this,Gh.ownDefaults),this.setOptions(t),this.cacheKey="texture".concat(Qp()),this.setElement(typeof e=="string"?(this.canvas&&ud(this.canvas.getElement())||N1()).getElementById(e):e,t)}getElement(){return this._element}setElement(e){var t;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=e,this._originalElement=e,this._setWidthHeight(i),(t=e.classList)===null||t===void 0||t.add(Gh.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(e){const t=ET(!1);t instanceof QX&&t.evictCachesForKey(e)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach((e=>{const t=this[e];t&&yA().dispose(t),this[e]=void 0}))}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const e=this.getElement();return e?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:0,height:0}}_stroke(e){if(!this.stroke||this.strokeWidth===0)return;const t=this.width/2,i=this.height/2;e.beginPath(),e.moveTo(-t,-i),e.lineTo(t,-i),e.lineTo(t,i),e.lineTo(-t,i),e.lineTo(-t,-i),e.closePath()}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=[];return this.filters.forEach((i=>{i&&t.push(i.toObject())})),Ct(Ct({},super.toObject([...$X,...e])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:t},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const e=[],t=this._element,i=-this.width/2,r=-this.height/2;let s=[],o=[],a="",l="";if(!t)return[];if(this.hasCrop()){const h=Qp();s.push('<clipPath id="imageCrop_'+h+`">
`,'	<rect x="'+i+'" y="'+r+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),a=' clip-path="url(#imageCrop_'+h+')" '}if(this.imageSmoothing||(l=' image-rendering="optimizeSpeed"'),e.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(i-this.cropX,'" y="').concat(r-this.cropY,'" width="').concat(t.width||t.naturalWidth,'" height="').concat(t.height||t.naturalHeight,'"').concat(l).concat(a,`></image>
`)),this.stroke||this.strokeDashArray){const h=this.fill;this.fill=null,o=['	<rect x="'.concat(i,'" y="').concat(r,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=h}return s=this.paintFirst!==bl?s.concat(o,e):s.concat(e,o),s}getSrc(e){const t=e?this._element:this._originalElement;return t?t.toDataURL?t.toDataURL():this.srcFromAttribute?t.getAttribute("src")||"":t.src:this.src||""}getSvgSrc(e){return this.getSrc(e)}setSrc(e){let{crossOrigin:t,signal:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return cw(e,{crossOrigin:t,signal:i}).then((r=>{t!==void 0&&this.set({crossOrigin:t}),this.setElement(r)}))}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){const e=this.resizeFilter,t=this.minimumScaleTrigger,i=this.getTotalObjectScaling(),r=i.x,s=i.y,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||r>t&&s>t)return this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=r,void(this._lastScaleY=s);const a=iu(o),{width:l,height:h}=o;this._element=a,this._lastScaleX=e.scaleX=r,this._lastScaleY=e.scaleY=s,ET().applyFilters([e],o,l,h,this._element),this._filterScalingX=a.width/this._originalElement.width,this._filterScalingY=a.height/this._originalElement.height}applyFilters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(e=e.filter((s=>s&&!s.isNeutralState())),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),e.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const t=this._originalElement,i=t.naturalWidth||t.width,r=t.naturalHeight||t.height;if(this._element===this._originalElement){const s=iu({width:i,height:r});this._element=s,this._filteredEl=s}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,i,r),this._lastScaleX=1,this._lastScaleY=1);ET().applyFilters(e,this._originalElement,i,r,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(e){e.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)}drawCacheOnCanvas(e){e.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(e)}shouldCache(){return this.needsItsOwnCache()}_renderFill(e){const t=this._element;if(!t)return;const i=this._filterScalingX,r=this._filterScalingY,s=this.width,o=this.height,a=Math.max(this.cropX,0),l=Math.max(this.cropY,0),h=t.naturalWidth||t.width,u=t.naturalHeight||t.height,d=a*i,A=l*r,f=Math.min(s*i,h-d),p=Math.min(o*r,u-A),g=-s/2,v=-o/2,w=Math.min(s,h/i-a),m=Math.min(o,u/r-l);t&&e.drawImage(t,d,A,f,p,g,v,w,m)}_needsResize(){const e=this.getTotalObjectScaling();return e.x!==this._lastScaleX||e.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:e,height:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const i=this.getOriginalSize();this.width=e||i.width,this.height=t||i.height}parsePreserveAspectRatioAttribute(){const e=B8(this.preserveAspectRatio||""),t=this.width,i=this.height,r={width:t,height:i};let s,o=this._element.width,a=this._element.height,l=1,h=1,u=0,d=0,A=0,f=0;return!e||e.alignX===hh&&e.alignY===hh?(l=t/o,h=i/a):(e.meetOrSlice==="meet"&&(l=h=SX(this._element,r),s=(t-o*l)/2,e.alignX==="Min"&&(u=-s),e.alignX==="Max"&&(u=s),s=(i-a*h)/2,e.alignY==="Min"&&(d=-s),e.alignY==="Max"&&(d=s)),e.meetOrSlice==="slice"&&(l=h=TX(this._element,r),s=o-t/l,e.alignX==="Mid"&&(A=s/2),e.alignX==="Max"&&(A=s),s=a-i/h,e.alignY==="Mid"&&(f=s/2),e.alignY==="Max"&&(f=s),o=t/l,a=i/h)),{width:o,height:a,scaleX:l,scaleY:h,offsetLeft:u,offsetTop:d,cropX:A,cropY:f}}static fromObject(e,t){let{filters:i,resizeFilter:r,src:s,crossOrigin:o,type:a}=e,l=ca(e,Oke);return Promise.all([cw(s,Ct(Ct({},t),{},{crossOrigin:o})),i&&f1(i,t),r&&f1([r],t),kv(l,t)]).then((h=>{let[u,d=[],[A]=[],f={}]=h;return new this(u,Ct(Ct({},l),{},{src:s,filters:d,resizeFilter:A},f))}))}static fromURL(e){let{crossOrigin:t=null,signal:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return cw(e,{crossOrigin:t,signal:i}).then((s=>new this(s,r)))}static async fromElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;const r=Pf(e,this.ATTRIBUTE_NAMES,i);return this.fromURL(r["xlink:href"]||r.href,t,r).catch((s=>(Sf("log","Unable to parse Image",s),null)))}}function FT(n){if(!$6e.test(n.nodeName))return{};const e=n.getAttribute("viewBox");let t,i,r=1,s=1,o=0,a=0;const l=n.getAttribute("width"),h=n.getAttribute("height"),u=n.getAttribute("x")||0,d=n.getAttribute("y")||0,A=!(e&&p7.test(e)),f=!l||!h||l==="100%"||h==="100%";let p="",g=0,v=0;if(A&&(u||d)&&n.parentNode&&n.parentNode.nodeName!=="#document"&&(p=" translate("+sh(u||"0")+" "+sh(d||"0")+") ",t=(n.getAttribute("transform")||"")+p,n.setAttribute("transform",t),n.removeAttribute("x"),n.removeAttribute("y")),A&&f)return{width:0,height:0};const w={width:0,height:0};if(A)return w.width=sh(l),w.height=sh(h),w;const m=e.match(p7);o=-parseFloat(m[1]),a=-parseFloat(m[2]);const y=parseFloat(m[3]),x=parseFloat(m[4]);w.minX=o,w.minY=a,w.viewBoxWidth=y,w.viewBoxHeight=x,f?(w.width=y,w.height=x):(w.width=sh(l),w.height=sh(h),r=w.width/y,s=w.height/x);const S=B8(n.getAttribute("preserveAspectRatio")||"");if(S.alignX!==hh&&(S.meetOrSlice==="meet"&&(s=r=r>s?s:r),S.meetOrSlice==="slice"&&(s=r=r>s?r:s),g=w.width-y*r,v=w.height-x*r,S.alignX==="Mid"&&(g/=2),S.alignY==="Mid"&&(v/=2),S.alignX==="Min"&&(g=0),S.alignY==="Min"&&(v=0)),r===1&&s===1&&o===0&&a===0&&u===0&&d===0)return w;if((u||d)&&n.parentNode.nodeName!=="#document"&&(p=" translate("+sh(u||"0")+" "+sh(d||"0")+") "),t=p+" matrix("+r+" 0 0 "+s+" "+(o*r+g)+" "+(a*s+v)+") ",n.nodeName==="svg"){for(i=n.ownerDocument.createElementNS(y6,"g");n.firstChild;)i.appendChild(n.firstChild);n.appendChild(i)}else i=n,i.removeAttribute("x"),i.removeAttribute("y"),t=i.getAttribute("transform")+t;return i.setAttribute("transform",t),w}St(Gh,"type","Image"),St(Gh,"cacheProperties",[...jf,...$X]),St(Gh,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),St(Gh,"CSS_CANVAS","canvas-img"),St(Gh,"ATTRIBUTE_NAMES",[...tg,"x","y","width","height","preserveAspectRatio","xlink:href","href","crossOrigin","image-rendering"]),Mi.setClass(Gh),Mi.setSVGClass(Gh);const H_=n=>n.tagName.replace("svg:",""),Hke=cS(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);function VX(n,e){let t,i,r,s,o=[];for(r=0,s=e.length;r<s;r++)t=e[r],i=n.getElementsByTagNameNS("http://www.w3.org/2000/svg",t),o=o.concat(Array.from(i));return o}const Wke=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],kT="xlink:href";function GX(n,e){var t;const i=((t=e.getAttribute(kT))===null||t===void 0?void 0:t.slice(1))||"",r=n.getElementById(i);if(r&&r.getAttribute(kT)&&GX(n,r),r&&(Wke.forEach((s=>{const o=r.getAttribute(s);!e.hasAttribute(s)&&o&&e.setAttribute(s,o)})),!e.children.length)){const s=r.cloneNode(!0);for(;s.firstChild;)e.appendChild(s.firstChild)}e.removeAttribute(kT)}const zke=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"];function Qke(n){const e=n.getElementsByTagName("style"),t={};for(let i=0;i<e.length;i++){const r=(e[i].textContent||"").replace(/\/\*[\s\S]*?\*\//g,"");r.trim()!==""&&r.split("}").filter(((s,o,a)=>a.length>1&&s.trim())).forEach((s=>{if((s.match(/{/g)||[]).length>1&&s.trim().startsWith("@"))return;const o=s.split("{"),a={},l=o[1].trim().split(";").filter((function(h){return h.trim()}));for(let h=0;h<l.length;h++){const u=l[h].split(":"),d=u[0].trim(),A=u[1].trim();a[d]=A}(s=o[0].trim()).split(",").forEach((h=>{(h=h.replace(/^svg/i,"").trim())!==""&&(t[h]=Ct(Ct({},t[h]||{}),a))}))}))}return t}const O7=n=>Mi.getSVGClass(H_(n).toLowerCase());class $ke{constructor(e,t,i,r,s){this.elements=e,this.options=t,this.reviver=i,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=r,this.clipPaths=s,this.gradientDefs=(function(o){const a=VX(o,zke),l={};let h=a.length;for(;h--;){const u=a[h];u.getAttribute("xlink:href")&&GX(o,u);const d=u.getAttribute("id");d&&(l[d]=u)}return l})(r),this.cssRules=Qke(r)}parse(){return Promise.all(this.elements.map((e=>this.createObject(e))))}async createObject(e){const t=O7(e);if(t){const i=await t.fromElement(e,this.options,this.cssRules);return this.resolveGradient(i,e,bl),this.resolveGradient(i,e,uh),i instanceof Gh&&i._originalElement?gC(i,i.parsePreserveAspectRatioAttribute()):gC(i),await this.resolveClipPath(i,e),this.reviver&&this.reviver(e,i),i}return null}extractPropertyDefinition(e,t,i){const r=e[t],s=this.regexUrl;if(!s.test(r))return;s.lastIndex=0;const o=s.exec(r)[1];return s.lastIndex=0,i[o]}resolveGradient(e,t,i){const r=this.extractPropertyDefinition(e,i,this.gradientDefs);if(r){const s=t.getAttribute(i+"-opacity"),o=Ey.fromElement(r,e,Ct(Ct({},this.options),{},{opacity:s}));e.set(i,o)}}async resolveClipPath(e,t,i){const r=this.extractPropertyDefinition(e,"clipPath",this.clipPaths);if(r){const s=Dh(e.calcTransformMatrix()),o=r[0].parentElement;let a=t;for(;!i&&a.parentElement&&a.getAttribute("clip-path")!==e.clipPath;)a=a.parentElement;a.parentElement.appendChild(o);const l=L_("".concat(a.getAttribute("transform")||""," ").concat(o.getAttribute("originalTransform")||""));o.setAttribute("transform","matrix(".concat(l.join(","),")"));const h=await Promise.all(r.map((m=>O7(m).fromElement(m,this.options,this.cssRules).then((y=>(gC(y),y.fillRule=y.clipRule,delete y.clipRule,y)))))),u=h.length===1?h[0]:new Jh(h),d=ll(s,u.calcTransformMatrix());u.clipPath&&await this.resolveClipPath(u,a,o.getAttribute("clip-path")?a:void 0);const{scaleX:A,scaleY:f,angle:p,skewX:g,translateX:v,translateY:w}=c0(d);u.set({flipX:!1,flipY:!1}),u.set({scaleX:A,scaleY:f,angle:p,skewX:g,skewY:0}),u.setPositionByOrigin(new qt(v,w),ns,ns),e.clipPath=u}else delete e.clipPath}}const H7=n=>Q6e.test(H_(n)),W7=()=>({objects:[],elements:[],options:{},allElements:[]});async function Vke(n,e){let{crossOrigin:t,signal:i}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(i&&i.aborted)return Sf("log",new f8("parseSVGDocument")),W7();const r=n.documentElement;(function(u){const d=VX(u,["use","svg:use"]),A=["x","y","xlink:href","href","transform"];for(const f of d){const p=f.attributes,g={};for(const b of p)b.value&&(g[b.name]=b.value);const v=(g["xlink:href"]||g.href||"").slice(1);if(v==="")return;const w=u.getElementById(v);if(w===null)return;let m=w.cloneNode(!0);const y=m.attributes,x={};for(const b of y)b.value&&(x[b.name]=b.value);const{x:S=0,y:I=0,transform:j=""}=g,C="".concat(j," ").concat(x.transform||""," translate(").concat(S,", ").concat(I,")");if(FT(m),/^svg$/i.test(m.nodeName)){const b=m.ownerDocument.createElementNS(y6,"g");Object.entries(x).forEach((D=>{let[T,k]=D;return b.setAttributeNS(y6,T,k)})),b.append(...m.childNodes),m=b}for(const b of p){if(!b)continue;const{name:D,value:T}=b;if(!A.includes(D))if(D==="style"){const k={};x6(T,k),Object.entries(x).forEach((E=>{let[z,te]=E;k[z]=te})),x6(x.style||"",k);const B=Object.entries(k).map((E=>E.join(":"))).join(";");m.setAttribute(D,B)}else!x[D]&&m.setAttribute(D,T)}m.setAttribute("transform",C),m.setAttribute("instantiated_by_use","1"),m.removeAttribute("id"),f.parentNode.replaceChild(m,f)}})(n);const s=Array.from(r.getElementsByTagName("*")),o=Ct(Ct({},FT(r)),{},{crossOrigin:t,signal:i}),a=s.filter((u=>(FT(u),H7(u)&&!(function(d){let A=d;for(;A&&(A=A.parentElement);)if(A&&A.nodeName&&Hke.test(H_(A))&&!A.getAttribute("instantiated_by_use"))return!0;return!1})(u))));if(!a||a&&!a.length)return Ct(Ct({},W7()),{},{options:o,allElements:s});const l={};return s.filter((u=>H_(u)==="clipPath")).forEach((u=>{u.setAttribute("originalTransform",u.getAttribute("transform")||"");const d=u.getAttribute("id");l[d]=Array.from(u.getElementsByTagName("*")).filter((A=>H7(A)))})),{objects:await new $ke(a,o,e,n,l).parse(),elements:a,options:o,allElements:s}}function Gke(n,e,t){return Vke(new(L1()).DOMParser().parseFromString(n.trim(),"text/xml"),e,t)}const gS=n=>n.webgl!==void 0,M8="precision highp float",Xke=`
    `.concat(M8,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),Yke=["type"],Kke=["type"],qke=new RegExp(M8,"g");class Nl{get type(){return this.constructor.type}constructor(){let e=ca(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Yke);Object.assign(this,this.constructor.defaults,e)}getFragmentSource(){return Xke}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:r="highp"}}=yA();r!=="highp"&&(t=t.replace(qke,M8.replace("highp",r)));const s=e.createShader(e.VERTEX_SHADER),o=e.createShader(e.FRAGMENT_SHADER),a=e.createProgram();if(!s||!o||!a)throw new rA("Vertex, fragment shader or program creation error");if(e.shaderSource(s,i),e.compileShader(s),!e.getShaderParameter(s,e.COMPILE_STATUS))throw new rA("Vertex shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(s)));if(e.shaderSource(o,t),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS))throw new rA("Fragment shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(o)));if(e.attachShader(a,s),e.attachShader(a,o),e.linkProgram(a),!e.getProgramParameter(a,e.LINK_STATUS))throw new rA('Shader link error for "'.concat(this.type,'" ').concat(e.getProgramInfoLog(a)));const l=this.getUniformLocations(e,a)||{};return l.uStepW=e.getUniformLocation(a,"uStepW"),l.uStepH=e.getUniformLocation(a,"uStepH"),{program:a,attributeLocations:this.getAttributeLocations(e,a),uniformLocations:l}}getAttributeLocations(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}}getUniformLocations(e,t){const i=this.constructor.uniformLocations,r={};for(let s=0;s<i.length;s++)r[i[s]]=e.getUniformLocation(t,i[s]);return r}sendAttributeData(e,t,i){const r=t.aPosition,s=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,s),e.enableVertexAttribArray(r),e.vertexAttribPointer(r,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,i,e.STATIC_DRAW)}_setupFrameBuffer(e){const t=e.context;if(e.passes>1){const i=e.destinationWidth,r=e.destinationHeight;e.sourceWidth===i&&e.sourceHeight===r||(t.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(t,i,r)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.targetTexture,0)}else t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish()}_swapTextures(e){e.passes--,e.pass++;const t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t}isNeutralState(e){return!1}applyTo(e){gS(e)?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){}getCacheKey(){return this.type}retrieveShader(e){const t=this.getCacheKey();return e.programCache[t]||(e.programCache[t]=this.createProgram(e.context)),e.programCache[t]}applyToWebGL(e){const t=e.context,i=this.retrieveShader(e);e.pass===0&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(i.program),this.sendAttributeData(t,i.attributeLocations,e.aPosition),t.uniform1f(i.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(i.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,i.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(e,t,i){e.activeTexture(i),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)}unbindAdditionalTexture(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}sendUniformData(e,t){}createHelpLayer(e){if(!e.helpLayer){const{sourceWidth:t,sourceHeight:i}=e,r=iu({width:t,height:i});e.helpLayer=r}}toObject(){const e=Object.keys(this.constructor.defaults||{});return Ct({type:this.type},e.reduce(((t,i)=>(t[i]=this[i],t)),{}))}toJSON(){return this.toObject()}static async fromObject(e,t){return new this(ca(e,Kke))}}St(Nl,"type","BaseFilter"),St(Nl,"uniformLocations",[]);const Zke={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `};class xb extends Nl{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(Zke[this.mode],`
        }
      }
      `)}applyTo2d(e){let{imageData:{data:t}}=e;const i=new po(this.color).getSource(),r=this.alpha,s=i[0]*r,o=i[1]*r,a=i[2]*r,l=1-r;for(let h=0;h<t.length;h+=4){const u=t[h],d=t[h+1],A=t[h+2];let f,p,g;switch(this.mode){case"multiply":f=u*s/255,p=d*o/255,g=A*a/255;break;case"screen":f=255-(255-u)*(255-s)/255,p=255-(255-d)*(255-o)/255,g=255-(255-A)*(255-a)/255;break;case"add":f=u+s,p=d+o,g=A+a;break;case"difference":f=Math.abs(u-s),p=Math.abs(d-o),g=Math.abs(A-a);break;case"subtract":f=u-s,p=d-o,g=A-a;break;case"darken":f=Math.min(u,s),p=Math.min(d,o),g=Math.min(A,a);break;case"lighten":f=Math.max(u,s),p=Math.max(d,o),g=Math.max(A,a);break;case"overlay":f=s<128?2*u*s/255:255-2*(255-u)*(255-s)/255,p=o<128?2*d*o/255:255-2*(255-d)*(255-o)/255,g=a<128?2*A*a/255:255-2*(255-A)*(255-a)/255;break;case"exclusion":f=s+u-2*s*u/255,p=o+d-2*o*d/255,g=a+A-2*a*A/255;break;case"tint":f=s+u*l,p=o+d*l,g=a+A*l}t[h]=f,t[h+1]=p,t[h+2]=g}}sendUniformData(e,t){const i=new po(this.color).getSource();i[0]=this.alpha*i[0]/255,i[1]=this.alpha*i[1]/255,i[2]=this.alpha*i[2]/255,i[3]=this.alpha,e.uniform4fv(t.uColor,i)}}St(xb,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),St(xb,"type","BlendColor"),St(xb,"uniformLocations",["uColor"]),Mi.setClass(xb);const Jke={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},e8e=["type","image"];class bb extends Nl{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return Jke[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(e){const t=e.context,i=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(t,i,t.TEXTURE1),super.applyToWebGL(e),this.unbindAdditionalTexture(t,t.TEXTURE1)}createTexture(e,t){return e.getCachedTexture(t.cacheKey,t.getElement())}calculateMatrix(){const e=this.image,{width:t,height:i}=e.getElement();return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/t,-e.top/i,1]}applyTo2d(e){let{imageData:{data:t,width:i,height:r},filterBackend:{resources:s}}=e;const o=this.image;s.blendImage||(s.blendImage=wA());const a=s.blendImage,l=a.getContext("2d");a.width!==i||a.height!==r?(a.width=i,a.height=r):l.clearRect(0,0,i,r),l.setTransform(o.scaleX,0,0,o.scaleY,o.left,o.top),l.drawImage(o.getElement(),0,0,i,r);const h=l.getImageData(0,0,i,r).data;for(let u=0;u<t.length;u+=4){const d=t[u],A=t[u+1],f=t[u+2],p=t[u+3],g=h[u],v=h[u+1],w=h[u+2],m=h[u+3];switch(this.mode){case"multiply":t[u]=d*g/255,t[u+1]=A*v/255,t[u+2]=f*w/255,t[u+3]=p*m/255;break;case"mask":t[u+3]=m}}}sendUniformData(e,t){const i=this.calculateMatrix();e.uniform1i(t.uImage,1),e.uniformMatrix3fv(t.uTransformMatrix,!1,i)}toObject(){return Ct(Ct({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static async fromObject(e,t){let{type:i,image:r}=e,s=ca(e,e8e);return Gh.fromObject(r,t).then((o=>new this(Ct(Ct({},s),{},{image:o}))))}}St(bb,"type","BlendImage"),St(bb,"defaults",{mode:"multiply",alpha:1}),St(bb,"uniformLocations",["uTransformMatrix","uImage"]),Mi.setClass(bb);class Cb extends Nl{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float totalC = 0.0;
      float totalA = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        vec4 sample = texture2D(uTexture, vTexCoord + uDelta * percent);
        float weight = 1.0 - abs(percent);
        float alpha = weight * sample.a;
        color.rgb += sample.rgb * alpha;
        color.a += alpha;
        totalA += weight;
        totalC += alpha;
      }
      gl_FragColor.rgb = color.rgb / totalC;
      gl_FragColor.a = color.a / totalA;
    }
  `}applyTo(e){gS(e)?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){let{imageData:{data:t,width:i,height:r}}=e;this.aspectRatio=i/r,this.horizontal=!0;let s=this.getBlurValue()*i;const o=new Uint8ClampedArray(t),a=15,l=4*i;for(let h=0;h<t.length;h+=4){let u=0,d=0,A=0,f=0,p=0;const g=h-h%l,v=g+l;for(let w=-14;w<a;w++){const m=w/a,y=4*Math.floor(s*m),x=1-Math.abs(m);let S=h+y;S<g?S=g:S>v&&(S=v);const I=t[S+3]*x;u+=t[S]*I,d+=t[S+1]*I,A+=t[S+2]*I,f+=I,p+=x}o[h]=u/f,o[h+1]=d/f,o[h+2]=A/f,o[h+3]=f/p}this.horizontal=!1,s=this.getBlurValue()*r;for(let h=0;h<o.length;h+=4){let u=0,d=0,A=0,f=0,p=0;const g=h%l,v=o.length-l+g;for(let w=-14;w<a;w++){const m=w/a,y=Math.floor(s*m)*l,x=1-Math.abs(m);let S=h+y;S<g?S=g:S>v&&(S=v);const I=o[S+3]*x;u+=o[S]*I,d+=o[S+1]*I,A+=o[S+2]*I,f+=I,p+=x}t[h]=u/f,t[h+1]=d/f,t[h+2]=A/f,t[h+3]=f/p}}sendUniformData(e,t){const i=this.chooseRightDelta();e.uniform2fv(t.uDelta,i)}isNeutralState(){return this.blur===0}getBlurValue(){let e=1;const{horizontal:t,aspectRatio:i}=this;return t?i>1&&(e=1/i):i<1&&(e=i),e*this.blur*.12}chooseRightDelta(){const e=this.getBlurValue();return this.horizontal?[e,0]:[0,e]}}St(Cb,"type","Blur"),St(Cb,"defaults",{blur:0}),St(Cb,"uniformLocations",["uDelta"]),Mi.setClass(Cb);class _b extends Nl{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const i=Math.round(255*this.brightness);for(let r=0;r<t.length;r+=4)t[r]+=i,t[r+1]+=i,t[r+2]+=i}isNeutralState(){return this.brightness===0}sendUniformData(e,t){e.uniform1f(t.uBrightness,this.brightness)}}St(_b,"type","Brightness"),St(_b,"defaults",{brightness:0}),St(_b,"uniformLocations",["uBrightness"]),Mi.setClass(_b);const XX={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0};class Bm extends Nl{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(e){const t=e.imageData.data,i=this.matrix,r=this.colorsOnly;for(let s=0;s<t.length;s+=4){const o=t[s],a=t[s+1],l=t[s+2];if(t[s]=o*i[0]+a*i[1]+l*i[2]+255*i[4],t[s+1]=o*i[5]+a*i[6]+l*i[7]+255*i[9],t[s+2]=o*i[10]+a*i[11]+l*i[12]+255*i[14],!r){const h=t[s+3];t[s]+=h*i[3],t[s+1]+=h*i[8],t[s+2]+=h*i[13],t[s+3]=o*i[15]+a*i[16]+l*i[17]+h*i[18]+255*i[19]}}}sendUniformData(e,t){const i=this.matrix,r=[i[0],i[1],i[2],i[3],i[5],i[6],i[7],i[8],i[10],i[11],i[12],i[13],i[15],i[16],i[17],i[18]],s=[i[4],i[9],i[14],i[19]];e.uniformMatrix4fv(t.uColorMatrix,!1,r),e.uniform4fv(t.uConstants,s)}toObject(){return Ct(Ct({},super.toObject()),{},{matrix:[...this.matrix]})}}function B0(n,e){var t;const i=(St(t=class extends Bm{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",n),St(t,"defaults",{colorsOnly:!1,matrix:e}),t);return Mi.setClass(i,n),i}St(Bm,"type","ColorMatrix"),St(Bm,"defaults",XX),St(Bm,"uniformLocations",["uColorMatrix","uConstants"]),Mi.setClass(Bm);B0("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]);B0("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]);B0("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]);B0("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]);B0("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]);B0("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]);B0("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);class z7 extends Nl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.subFilters=e.subFilters||[]}applyTo(e){gS(e)&&(e.passes+=this.subFilters.length-1),this.subFilters.forEach((t=>{t.applyTo(e)}))}toObject(){return{type:this.type,subFilters:this.subFilters.map((e=>e.toObject()))}}isNeutralState(){return!this.subFilters.some((e=>!e.isNeutralState()))}static fromObject(e,t){return Promise.all((e.subFilters||[]).map((i=>Mi.getClass(i.type).fromObject(i,t)))).then((i=>new this({subFilters:i})))}}St(z7,"type","Composed"),Mi.setClass(z7);class Sb extends Nl{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(e){let{imageData:{data:t}}=e;const i=Math.floor(255*this.contrast),r=259*(i+255)/(255*(259-i));for(let s=0;s<t.length;s+=4)t[s]=r*(t[s]-128)+128,t[s+1]=r*(t[s+1]-128)+128,t[s+2]=r*(t[s+2]-128)+128}sendUniformData(e,t){e.uniform1f(t.uContrast,this.contrast)}}St(Sb,"type","Contrast"),St(Sb,"defaults",{contrast:0}),St(Sb,"uniformLocations",["uContrast"]),Mi.setClass(Sb);const t8e={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `};class Tb extends Nl{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return t8e[this.getCacheKey()]}applyTo2d(e){const t=e.imageData,i=t.data,r=this.matrix,s=Math.round(Math.sqrt(r.length)),o=Math.floor(s/2),a=t.width,l=t.height,h=e.ctx.createImageData(a,l),u=h.data,d=this.opaque?1:0;let A,f,p,g,v,w,m,y,x,S,I,j,C;for(I=0;I<l;I++)for(S=0;S<a;S++){for(v=4*(I*a+S),A=0,f=0,p=0,g=0,C=0;C<s;C++)for(j=0;j<s;j++)m=I+C-o,w=S+j-o,m<0||m>=l||w<0||w>=a||(y=4*(m*a+w),x=r[C*s+j],A+=i[y]*x,f+=i[y+1]*x,p+=i[y+2]*x,d||(g+=i[y+3]*x));u[v]=A,u[v+1]=f,u[v+2]=p,u[v+3]=d?i[v+3]:g}e.imageData=h}sendUniformData(e,t){e.uniform1fv(t.uMatrix,this.matrix)}toObject(){return Ct(Ct({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}}St(Tb,"type","Convolute"),St(Tb,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),St(Tb,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),Mi.setClass(Tb);const YX="Gamma";class Bb extends Nl{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.gamma=e.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(e){let{imageData:{data:t}}=e;const i=this.gamma,r=1/i[0],s=1/i[1],o=1/i[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const a=this.rgbValues;for(let l=0;l<256;l++)a.r[l]=255*Math.pow(l/255,r),a.g[l]=255*Math.pow(l/255,s),a.b[l]=255*Math.pow(l/255,o);for(let l=0;l<t.length;l+=4)t[l]=a.r[t[l]],t[l+1]=a.g[t[l+1]],t[l+2]=a.b[t[l+2]]}sendUniformData(e,t){e.uniform3fv(t.uGamma,this.gamma)}isNeutralState(){const{gamma:e}=this;return e[0]===1&&e[1]===1&&e[2]===1}toObject(){return{type:YX,gamma:this.gamma.concat()}}}St(Bb,"type",YX),St(Bb,"defaults",{gamma:[1,1,1]}),St(Bb,"uniformLocations",["uGamma"]),Mi.setClass(Bb);const n8e={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `};class Eb extends Nl{applyTo2d(e){let{imageData:{data:t}}=e;for(let i,r=0;r<t.length;r+=4){const s=t[r],o=t[r+1],a=t[r+2];switch(this.mode){case"average":i=(s+o+a)/3;break;case"lightness":i=(Math.min(s,o,a)+Math.max(s,o,a))/2;break;case"luminosity":i=.21*s+.72*o+.07*a}t[r+2]=t[r+1]=t[r]=i}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return n8e[this.mode]}sendUniformData(e,t){e.uniform1i(t.uMode,1)}isNeutralState(){return!1}}St(Eb,"type","Grayscale"),St(Eb,"defaults",{mode:"average"}),St(Eb,"uniformLocations",["uMode"]),Mi.setClass(Eb);const i8e=Ct(Ct({},XX),{},{rotation:0});class IT extends Bm{calculateMatrix(){const e=this.rotation*Math.PI,t=Td(e),i=Bd(e),r=1/3,s=Math.sqrt(r)*i,o=1-t;this.matrix=[t+o/3,r*o-s,r*o+s,0,0,r*o+s,t+r*o,r*o-s,0,0,r*o-s,r*o+s,t+r*o,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(e){this.calculateMatrix(),super.applyTo(e)}toObject(){return{type:this.type,rotation:this.rotation}}}St(IT,"type","HueRotation"),St(IT,"defaults",i8e),Mi.setClass(IT);class Fb extends Nl{applyTo2d(e){let{imageData:{data:t}}=e;for(let i=0;i<t.length;i+=4)t[i]=255-t[i],t[i+1]=255-t[i+1],t[i+2]=255-t[i+2],this.alpha&&(t[i+3]=255-t[i+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(e,t){e.uniform1i(t.uInvert,Number(this.invert)),e.uniform1i(t.uAlpha,Number(this.alpha))}}St(Fb,"type","Invert"),St(Fb,"defaults",{alpha:!1,invert:!0}),St(Fb,"uniformLocations",["uInvert","uAlpha"]),Mi.setClass(Fb);class kb extends Nl{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const i=this.noise;for(let r=0;r<t.length;r+=4){const s=(.5-Math.random())*i;t[r]+=s,t[r+1]+=s,t[r+2]+=s}}sendUniformData(e,t){e.uniform1f(t.uNoise,this.noise/255),e.uniform1f(t.uSeed,Math.random())}isNeutralState(){return this.noise===0}}St(kb,"type","Noise"),St(kb,"defaults",{noise:0}),St(kb,"uniformLocations",["uNoise","uSeed"]),Mi.setClass(kb);let Ib=class extends Nl{applyTo2d(e){let{imageData:{data:t,width:i,height:r}}=e;for(let s=0;s<r;s+=this.blocksize)for(let o=0;o<i;o+=this.blocksize){const a=4*s*i+4*o,l=t[a],h=t[a+1],u=t[a+2],d=t[a+3];for(let A=s;A<Math.min(s+this.blocksize,r);A++)for(let f=o;f<Math.min(o+this.blocksize,i);f++){const p=4*A*i+4*f;t[p]=l,t[p+1]=h,t[p+2]=u,t[p+3]=d}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(e,t){e.uniform1f(t.uBlocksize,this.blocksize)}};St(Ib,"type","Pixelate"),St(Ib,"defaults",{blocksize:4}),St(Ib,"uniformLocations",["uBlocksize"]),Mi.setClass(Ib);class Db extends Nl{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(e){let{imageData:{data:t}}=e;const i=255*this.distance,r=new po(this.color).getSource(),s=[r[0]-i,r[1]-i,r[2]-i],o=[r[0]+i,r[1]+i,r[2]+i];for(let a=0;a<t.length;a+=4){const l=t[a],h=t[a+1],u=t[a+2];l>s[0]&&h>s[1]&&u>s[2]&&l<o[0]&&h<o[1]&&u<o[2]&&(t[a+3]=0)}}sendUniformData(e,t){const i=new po(this.color).getSource(),r=this.distance,s=[0+i[0]/255-r,0+i[1]/255-r,0+i[2]/255-r,1],o=[i[0]/255+r,i[1]/255+r,i[2]/255+r,1];e.uniform4fv(t.uLow,s),e.uniform4fv(t.uHigh,o)}}St(Db,"type","RemoveColor"),St(Db,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),St(Db,"uniformLocations",["uLow","uHigh"]),Mi.setClass(Db);class jb extends Nl{sendUniformData(e,t){e.uniform2fv(t.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(t.uTaps,this.taps)}getFilterWindow(){const e=this.tempScale;return Math.ceil(this.lanczosLobes/e)}getCacheKey(){const e=this.getFilterWindow();return"".concat(this.type,"_").concat(e)}getFragmentSource(){const e=this.getFilterWindow();return this.generateShader(e)}getTaps(){const e=this.lanczosCreate(this.lanczosLobes),t=this.tempScale,i=this.getFilterWindow(),r=new Array(i);for(let s=1;s<=i;s++)r[s-1]=e(s*t);return r}generateShader(e){const t=new Array(e);for(let i=1;i<=e;i++)t[i-1]="".concat(i,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(e,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(t.map(((i,r)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(i,") * uTaps[").concat(r,"] + texture2D(uTexture, vTexCoord - ").concat(i,") * uTaps[").concat(r,`];
              sum += 2.0 * uTaps[`).concat(r,`];
            `))).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(e){e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,super.applyTo(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,super.applyTo(e),e.sourceHeight=e.destinationHeight}applyTo(e){gS(e)?this.applyToForWebgl(e):this.applyTo2d(e)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(e){return t=>{if(t>=e||t<=-e)return 0;if(t<11920929e-14&&t>-11920929e-14)return 1;const i=(t*=Math.PI)/e;return Math.sin(t)/t*Math.sin(i)/i}}applyTo2d(e){const t=e.imageData,i=this.scaleX,r=this.scaleY;this.rcpScaleX=1/i,this.rcpScaleY=1/r;const s=t.width,o=t.height,a=Math.round(s*i),l=Math.round(o*r);let h;h=this.resizeType==="sliceHack"?this.sliceByTwo(e,s,o,a,l):this.resizeType==="hermite"?this.hermiteFastResize(e,s,o,a,l):this.resizeType==="bilinear"?this.bilinearFiltering(e,s,o,a,l):this.resizeType==="lanczos"?this.lanczosResize(e,s,o,a,l):new ImageData(a,l),e.imageData=h}sliceByTwo(e,t,i,r,s){const o=e.imageData,a=.5;let l=!1,h=!1,u=t*a,d=i*a;const A=e.filterBackend.resources;let f=0,p=0;const g=t;let v=0;A.sliceByTwo||(A.sliceByTwo=wA());const w=A.sliceByTwo;(w.width<1.5*t||w.height<i)&&(w.width=1.5*t,w.height=i);const m=w.getContext("2d");for(m.clearRect(0,0,1.5*t,i),m.putImageData(o,0,0),r=Math.floor(r),s=Math.floor(s);!l||!h;)t=u,i=d,r<Math.floor(u*a)?u=Math.floor(u*a):(u=r,l=!0),s<Math.floor(d*a)?d=Math.floor(d*a):(d=s,h=!0),m.drawImage(w,f,p,t,i,g,v,u,d),f=g,p=v,v+=d;return m.getImageData(f,p,r,s)}lanczosResize(e,t,i,r,s){const o=e.imageData.data,a=e.ctx.createImageData(r,s),l=a.data,h=this.lanczosCreate(this.lanczosLobes),u=this.rcpScaleX,d=this.rcpScaleY,A=2/this.rcpScaleX,f=2/this.rcpScaleY,p=Math.ceil(u*this.lanczosLobes/2),g=Math.ceil(d*this.lanczosLobes/2),v={},w={x:0,y:0},m={x:0,y:0};return(function y(x){let S,I,j,C,b,D,T,k,B,E,z;for(w.x=(x+.5)*u,m.x=Math.floor(w.x),S=0;S<s;S++){for(w.y=(S+.5)*d,m.y=Math.floor(w.y),b=0,D=0,T=0,k=0,B=0,I=m.x-p;I<=m.x+p;I++)if(!(I<0||I>=t)){E=Math.floor(1e3*Math.abs(I-w.x)),v[E]||(v[E]={});for(let te=m.y-g;te<=m.y+g;te++)te<0||te>=i||(z=Math.floor(1e3*Math.abs(te-w.y)),v[E][z]||(v[E][z]=h(Math.sqrt(Math.pow(E*A,2)+Math.pow(z*f,2))/1e3)),j=v[E][z],j>0&&(C=4*(te*t+I),b+=j,D+=j*o[C],T+=j*o[C+1],k+=j*o[C+2],B+=j*o[C+3]))}C=4*(S*r+x),l[C]=D/b,l[C+1]=T/b,l[C+2]=k/b,l[C+3]=B/b}return++x<r?y(x):a})(0)}bilinearFiltering(e,t,i,r,s){let o,a,l,h,u,d,A,f,p,g,v,w,m,y=0;const x=this.rcpScaleX,S=this.rcpScaleY,I=4*(t-1),j=e.imageData.data,C=e.ctx.createImageData(r,s),b=C.data;for(A=0;A<s;A++)for(f=0;f<r;f++)for(u=Math.floor(x*f),d=Math.floor(S*A),p=x*f-u,g=S*A-d,m=4*(d*t+u),v=0;v<4;v++)o=j[m+v],a=j[m+4+v],l=j[m+I+v],h=j[m+I+4+v],w=o*(1-p)*(1-g)+a*p*(1-g)+l*g*(1-p)+h*p*g,b[y++]=w;return C}hermiteFastResize(e,t,i,r,s){const o=this.rcpScaleX,a=this.rcpScaleY,l=Math.ceil(o/2),h=Math.ceil(a/2),u=e.imageData.data,d=e.ctx.createImageData(r,s),A=d.data;for(let f=0;f<s;f++)for(let p=0;p<r;p++){const g=4*(p+f*r);let v=0,w=0,m=0,y=0,x=0,S=0,I=0;const j=(f+.5)*a;for(let C=Math.floor(f*a);C<(f+1)*a;C++){const b=Math.abs(j-(C+.5))/h,D=(p+.5)*o,T=b*b;for(let k=Math.floor(p*o);k<(p+1)*o;k++){let B=Math.abs(D-(k+.5))/l;const E=Math.sqrt(T+B*B);E>1&&E<-1||(v=2*E*E*E-3*E*E+1,v>0&&(B=4*(k+C*t),I+=v*u[B+3],m+=v,u[B+3]<255&&(v=v*u[B+3]/250),y+=v*u[B],x+=v*u[B+1],S+=v*u[B+2],w+=v))}}A[g]=y/w,A[g+1]=x/w,A[g+2]=S/w,A[g+3]=I/m}return d}}St(jb,"type","Resize"),St(jb,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),St(jb,"uniformLocations",["uDelta","uTaps"]),Mi.setClass(jb);class Pb extends Nl{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const i=-this.saturation;for(let r=0;r<t.length;r+=4){const s=t[r],o=t[r+1],a=t[r+2],l=Math.max(s,o,a);t[r]+=l!==s?(l-s)*i:0,t[r+1]+=l!==o?(l-o)*i:0,t[r+2]+=l!==a?(l-a)*i:0}}sendUniformData(e,t){e.uniform1f(t.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}}St(Pb,"type","Saturation"),St(Pb,"defaults",{saturation:0}),St(Pb,"uniformLocations",["uSaturation"]),Mi.setClass(Pb);class Nb extends Nl{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const i=-this.vibrance;for(let r=0;r<t.length;r+=4){const s=t[r],o=t[r+1],a=t[r+2],l=Math.max(s,o,a),h=(s+o+a)/3,u=2*Math.abs(l-h)/255*i;t[r]+=l!==s?(l-s)*u:0,t[r+1]+=l!==o?(l-o)*u:0,t[r+2]+=l!==a?(l-a)*u:0}}sendUniformData(e,t){e.uniform1f(t.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}}St(Nb,"type","Vibrance"),St(Nb,"defaults",{vibrance:0}),St(Nb,"uniformLocations",["uVibrance"]),Mi.setClass(Nb);class r8e{constructor(e){this._pointer=0,this._eof=!1,this._data=e}next(){if(!this.hasNext())throw this._eof?new Error("Cannot call 'next' after EOF group has been read"):new Error("Unexpected end of input: EOF group not read before end of file. Ended on code "+this._data[this._pointer]);const e={code:parseInt(this._data[this._pointer])};return this._pointer++,e.value=Q7(e.code,this._data[this._pointer].trim()),this._pointer++,e.code===0&&e.value==="EOF"&&(this._eof=!0),this.lastReadGroup=e,e}peek(){if(!this.hasNext())throw this._eof?new Error("Cannot call 'next' after EOF group has been read"):new Error("Unexpected end of input: EOF group not read before end of file. Ended on code "+this._data[this._pointer]);const e={code:parseInt(this._data[this._pointer])};return e.value=Q7(e.code,this._data[this._pointer+1].trim()),e}rewind(e=1){this._pointer=this._pointer-e*2}hasNext(){return!(this._eof||this._pointer>this._data.length-2)}isEOF(){return this._eof}}function Q7(n,e){return n<=9?e:n>=10&&n<=59?parseFloat(e):n>=60&&n<=99?parseInt(e):n>=100&&n<=109?e:n>=110&&n<=149?parseFloat(e):n>=160&&n<=179?parseInt(e):n>=210&&n<=239?parseFloat(e):n>=270&&n<=289?parseInt(e):n>=290&&n<=299?s8e(e):n>=300&&n<=369?e:n>=370&&n<=389?parseInt(e):n>=390&&n<=399?e:n>=400&&n<=409?parseInt(e):n>=410&&n<=419?e:n>=420&&n<=429?parseInt(e):n>=430&&n<=439?e:n>=440&&n<=459?parseInt(e):n>=460&&n<=469?parseFloat(e):n>=470&&n<=481||n===999||n>=1e3&&n<=1009?e:n>=1010&&n<=1059?parseFloat(e):n>=1060&&n<=1071?parseInt(e):(console.log("WARNING: Group code does not have a defined type: %j",{code:n,value:e}),e)}function s8e(n){if(n==="0")return!1;if(n==="1")return!0;throw TypeError("String '"+n+"' cannot be cast to Boolean type")}const KX=[0,16711680,16776960,65280,65535,255,16711935,16777215,8421504,12632256,16711680,16744319,13369344,13395558,10027008,10046540,8323072,8339263,4980736,4990502,16727808,16752511,13382400,13401958,10036736,10051404,8331008,8343359,4985600,4992806,16744192,16760703,13395456,13408614,10046464,10056268,8339200,8347455,4990464,4995366,16760576,16768895,13408512,13415014,10056192,10061132,8347392,8351551,4995328,4997670,16776960,16777087,13421568,13421670,10000384,10000460,8355584,8355647,5000192,5000230,12582656,14679935,10079232,11717734,7510016,8755276,6258432,7307071,3755008,4344870,8388352,12582783,6736896,10079334,5019648,7510092,4161280,6258495,2509824,3755046,4194048,10485631,3394560,8375398,2529280,6264908,2064128,5209919,1264640,3099686,65280,8388479,52224,6736998,38912,5019724,32512,4161343,19456,2509862,65343,8388511,52275,6737023,38950,5019743,32543,4161359,19475,2509871,65407,8388543,52326,6737049,38988,5019762,32575,4161375,19494,2509881,65471,8388575,52377,6737074,39026,5019781,32607,4161391,19513,2509890,65535,8388607,52428,6737100,39064,5019800,32639,4161407,19532,2509900,49151,8380415,39372,6730444,29336,5014936,24447,4157311,14668,2507340,32767,8372223,26316,6724044,19608,5010072,16255,4153215,9804,2505036,16383,8364031,13260,6717388,9880,5005208,8063,4149119,4940,2502476,255,8355839,204,6710988,152,5000344,127,4145023,76,2500172,4129023,10452991,3342540,8349388,2490520,6245528,2031743,5193599,1245260,3089996,8323327,12550143,6684876,10053324,4980888,7490712,4128895,6242175,2490444,3745356,12517631,14647295,10027212,11691724,7471256,8735896,6226047,7290751,3735628,4335180,16711935,16744447,13369548,13395660,9961624,9981080,8323199,8339327,4980812,4990540,16711871,16744415,13369497,13395634,9961586,9981061,8323167,8339311,4980793,4990530,16711807,16744383,13369446,13395609,9961548,9981042,8323135,8339295,4980774,4990521,16711743,16744351,13369395,13395583,9961510,9981023,8323103,8339279,4980755,4990511,3355443,5987163,8684676,11382189,14079702,16777215];function o8e(n){return KX[n]}function Rs(n){const e={};n.rewind();let t=n.next(),i=t.code;if(e.x=t.value,i+=10,t=n.next(),t.code!=i)throw new Error("Expected code for point value to be "+i+" but got "+t.code+".");return e.y=t.value,i+=10,t=n.next(),t.code!=i?(n.rewind(),e):(e.z=t.value,e)}function bc(n,e,t){switch(e.code){case 0:n.type=e.value;break;case 5:n.handle=e.value;break;case 6:n.lineType=e.value;break;case 8:n.layer=e.value;break;case 48:n.lineTypeScale=e.value;break;case 60:n.visible=e.value===0;break;case 62:n.colorIndex=e.value,n.color=o8e(Math.abs(e.value));break;case 67:n.inPaperSpace=e.value!==0;break;case 100:break;case 101:for(;e.code!=0;)e=t.next();t.rewind();break;case 330:n.ownerHandle=e.value;break;case 347:n.materialObjectHandle=e.value;break;case 370:n.lineweight=e.value;break;case 420:n.color=e.value;break;case 1e3:n.extendedData=n.extendedData||{},n.extendedData.customStrings=n.extendedData.customStrings||[],n.extendedData.customStrings.push(e.value);break;case 1001:n.extendedData=n.extendedData||{},n.extendedData.applicationName=e.value;break;default:return!1}return!0}class a8e{constructor(){this.ForEntityName="3DFACE"}parseEntity(e,t){const i={type:t.value,vertices:[]};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 70:i.shape=(t.value&1)===1,i.hasContinuousLinetypePattern=(t.value&128)===128;break;case 10:i.vertices=l8e(e,t),t=e.lastReadGroup;break;default:bc(i,t,e);break}t=e.next()}return i}}function l8e(n,e){var t=[],i=!1,r=!1,s=4;for(let a=0;a<=s;a++){for(var o={};!n.isEOF()&&!(e.code===0||r);){switch(e.code){case 10:case 11:case 12:case 13:if(i){r=!0;continue}o.x=e.value,i=!0;break;case 20:case 21:case 22:case 23:o.y=e.value;break;case 30:case 31:case 32:case 33:o.z=e.value;break;default:return t}e=n.next()}t.push(o),i=!1,r=!1}return n.rewind(),t}let c8e=class{constructor(){this.ForEntityName="ARC"}parseEntity(e,t){const i={type:t.value};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 10:i.center=Rs(e);break;case 40:i.radius=t.value;break;case 50:i.startAngle=Math.PI/180*t.value;break;case 51:i.endAngle=Math.PI/180*t.value,i.angleLength=i.endAngle-i.startAngle;break;case 210:i.extrusionDirectionX=t.value;break;case 220:i.extrusionDirectionY=t.value;break;case 230:i.extrusionDirectionZ=t.value;break;default:bc(i,t,e);break}t=e.next()}return i}};class h8e{constructor(){this.ForEntityName="ATTDEF"}parseEntity(e,t){var i={type:t.value,scale:1,textStyle:"STANDARD"};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 1:i.text=t.value;break;case 2:i.tag=t.value;break;case 3:i.prompt=t.value;break;case 7:i.textStyle=t.value;break;case 10:i.startPoint=Rs(e);break;case 11:i.endPoint=Rs(e);break;case 39:i.thickness=t.value;break;case 40:i.textHeight=t.value;break;case 41:i.scale=t.value;break;case 50:i.rotation=t.value;break;case 51:i.obliqueAngle=t.value;break;case 70:i.invisible=!!(t.value&1),i.constant=!!(t.value&2),i.verificationRequired=!!(t.value&4),i.preset=!!(t.value&8);break;case 71:i.backwards=!!(t.value&2),i.mirrored=!!(t.value&4);break;case 72:i.horizontalJustification=t.value;break;case 73:i.fieldLength=t.value;break;case 74:i.verticalJustification=t.value;break;case 100:break;case 210:i.extrusionDirectionX=t.value;break;case 220:i.extrusionDirectionY=t.value;break;case 230:i.extrusionDirectionZ=t.value;break;default:bc(i,t,e);break}t=e.next()}return i}}let u8e=class{constructor(){this.ForEntityName="CIRCLE"}parseEntity(e,t){const i={type:t.value};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 10:i.center=Rs(e);break;case 40:i.radius=t.value;break;case 50:i.startAngle=Math.PI/180*t.value;break;case 51:const r=Math.PI/180*t.value;r<i.startAngle?i.angleLength=r+2*Math.PI-i.startAngle:i.angleLength=r-i.startAngle,i.endAngle=r;break;default:bc(i,t,e);break}t=e.next()}return i}};class d8e{constructor(){this.ForEntityName="DIMENSION"}parseEntity(e,t){const i={type:t.value};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 2:i.block=t.value;break;case 10:i.anchorPoint=Rs(e);break;case 11:i.middleOfText=Rs(e);break;case 12:i.insertionPoint=Rs(e);break;case 13:i.linearOrAngularPoint1=Rs(e);break;case 14:i.linearOrAngularPoint2=Rs(e);break;case 15:i.diameterOrRadiusPoint=Rs(e);break;case 16:i.arcPoint=Rs(e);break;case 70:i.dimensionType=t.value;break;case 71:i.attachmentPoint=t.value;break;case 42:i.actualMeasurement=t.value;break;case 1:i.text=t.value;break;case 50:i.angle=t.value;break;default:bc(i,t,e);break}t=e.next()}return i}}let A8e=class{constructor(){this.ForEntityName="ELLIPSE"}parseEntity(e,t){const i={type:t.value};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 10:i.center=Rs(e);break;case 11:i.majorAxisEndPoint=Rs(e);break;case 40:i.axisRatio=t.value;break;case 41:i.startAngle=t.value;break;case 42:i.endAngle=t.value;break;case 2:i.name=t.value;break;default:bc(i,t,e);break}t=e.next()}return i}};class f8e{constructor(){this.ForEntityName="INSERT"}parseEntity(e,t){const i={type:t.value};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 2:i.name=t.value;break;case 41:i.xScale=t.value;break;case 42:i.yScale=t.value;break;case 43:i.zScale=t.value;break;case 10:i.position=Rs(e);break;case 50:i.rotation=t.value;break;case 70:i.columnCount=t.value;break;case 71:i.rowCount=t.value;break;case 44:i.columnSpacing=t.value;break;case 45:i.rowSpacing=t.value;break;case 210:i.extrusionDirection=Rs(e);break;default:bc(i,t,e);break}t=e.next()}return i}}let p8e=class{constructor(){this.ForEntityName="LINE"}parseEntity(e,t){const i={type:t.value,vertices:[]};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 10:i.vertices.unshift(Rs(e));break;case 11:i.vertices.push(Rs(e));break;case 210:i.extrusionDirection=Rs(e);break;case 100:break;default:bc(i,t,e);break}t=e.next()}return i}};class g8e{constructor(){this.ForEntityName="LWPOLYLINE"}parseEntity(e,t){const i={type:t.value,vertices:[]};let r=0;for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 38:i.elevation=t.value;break;case 39:i.depth=t.value;break;case 70:i.shape=(t.value&1)===1,i.hasContinuousLinetypePattern=(t.value&128)===128;break;case 90:r=t.value;break;case 10:i.vertices=m8e(r,e);break;case 43:t.value!==0&&(i.width=t.value);break;case 210:i.extrusionDirectionX=t.value;break;case 220:i.extrusionDirectionY=t.value;break;case 230:i.extrusionDirectionZ=t.value;break;default:bc(i,t,e);break}t=e.next()}return i}}function m8e(n,e){if(!n||n<=0)throw Error("n must be greater than 0 verticies");const t=[];let i=!1,r=!1,s=e.lastReadGroup;for(let o=0;o<n;o++){const a={};for(;!e.isEOF()&&!(s.code===0||r);){switch(s.code){case 10:if(i){r=!0;continue}a.x=s.value,i=!0;break;case 20:a.y=s.value;break;case 30:a.z=s.value;break;case 40:a.startWidth=s.value;break;case 41:a.endWidth=s.value;break;case 42:s.value!=0&&(a.bulge=s.value);break;default:return e.rewind(),i&&t.push(a),e.rewind(),t}s=e.next()}t.push(a),i=!1,r=!1}return e.rewind(),t}class y8e{constructor(){this.ForEntityName="MTEXT"}parseEntity(e,t){const i={type:t.value};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 3:i.text?i.text+=t.value:i.text=t.value;break;case 1:i.text?i.text+=t.value:i.text=t.value;break;case 10:i.position=Rs(e);break;case 11:i.directionVector=Rs(e);break;case 40:i.height=t.value;break;case 41:i.width=t.value;break;case 50:i.rotation=t.value;break;case 71:i.attachmentPoint=t.value;break;case 72:i.drawingDirection=t.value;break;default:bc(i,t,e);break}t=e.next()}return i}}class w8e{constructor(){this.ForEntityName="POINT"}parseEntity(e,t){const r={type:t.value};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 10:r.position=Rs(e);break;case 39:r.thickness=t.value;break;case 210:r.extrusionDirection=Rs(e);break;case 100:break;default:bc(r,t,e);break}t=e.next()}return r}}class v8e{constructor(){this.ForEntityName="VERTEX"}parseEntity(e,t){var i={type:t.value};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 10:i.x=t.value;break;case 20:i.y=t.value;break;case 30:i.z=t.value;break;case 40:break;case 41:break;case 42:t.value!=0&&(i.bulge=t.value);break;case 70:i.curveFittingVertex=(t.value&1)!==0,i.curveFitTangent=(t.value&2)!==0,i.splineVertex=(t.value&8)!==0,i.splineControlPoint=(t.value&16)!==0,i.threeDPolylineVertex=(t.value&32)!==0,i.threeDPolylineMesh=(t.value&64)!==0,i.polyfaceMeshVertex=(t.value&128)!==0;break;case 50:break;case 71:i.faceA=t.value;break;case 72:i.faceB=t.value;break;case 73:i.faceC=t.value;break;case 74:i.faceD=t.value;break;default:bc(i,t,e);break}t=e.next()}return i}}class x8e{constructor(){this.ForEntityName="POLYLINE"}parseEntity(e,t){var i={type:t.value,vertices:[]};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 10:break;case 20:break;case 30:break;case 39:i.thickness=t.value;break;case 40:break;case 41:break;case 70:i.shape=(t.value&1)!==0,i.includesCurveFitVertices=(t.value&2)!==0,i.includesSplineFitVertices=(t.value&4)!==0,i.is3dPolyline=(t.value&8)!==0,i.is3dPolygonMesh=(t.value&16)!==0,i.is3dPolygonMeshClosed=(t.value&32)!==0,i.isPolyfaceMesh=(t.value&64)!==0,i.hasContinuousLinetypePattern=(t.value&128)!==0;break;case 71:break;case 72:break;case 73:break;case 74:break;case 75:break;case 210:i.extrusionDirection=Rs(e);break;default:bc(i,t,e);break}t=e.next()}return i.vertices=b8e(e,t),i}}function b8e(n,e){const t=new v8e,i=[];for(;!n.isEOF();)if(e.code===0){if(e.value==="VERTEX")i.push(t.parseEntity(n,e)),e=n.lastReadGroup;else if(e.value==="SEQEND"){C8e(n,e);break}}return i}function C8e(n,e){const t={type:e.value};for(e=n.next();!n.isEOF()&&e.code!=0;)bc(t,e,n),e=n.next();return t}class _8e{constructor(){this.ForEntityName="SOLID"}parseEntity(e,t){const i={type:t.value,points:[]};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 10:i.points[0]=Rs(e);break;case 11:i.points[1]=Rs(e);break;case 12:i.points[2]=Rs(e);break;case 13:i.points[3]=Rs(e);break;case 210:i.extrusionDirection=Rs(e);break;default:bc(i,t,e);break}t=e.next()}return i}}class S8e{constructor(){this.ForEntityName="SPLINE"}parseEntity(e,t){const i={type:t.value};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 10:i.controlPoints||(i.controlPoints=[]),i.controlPoints.push(Rs(e));break;case 11:i.fitPoints||(i.fitPoints=[]),i.fitPoints.push(Rs(e));break;case 12:i.startTangent=Rs(e);break;case 13:i.endTangent=Rs(e);break;case 40:i.knotValues||(i.knotValues=[]),i.knotValues.push(t.value);break;case 70:(t.value&1)!=0&&(i.closed=!0),(t.value&2)!=0&&(i.periodic=!0),(t.value&4)!=0&&(i.rational=!0),(t.value&8)!=0&&(i.planar=!0),(t.value&16)!=0&&(i.planar=!0,i.linear=!0);break;case 71:i.degreeOfSplineCurve=t.value;break;case 72:i.numberOfKnots=t.value;break;case 73:i.numberOfControlPoints=t.value;break;case 74:i.numberOfFitPoints=t.value;break;case 210:i.normalVector=Rs(e);break;default:bc(i,t,e);break}t=e.next()}return i}}let T8e=class{constructor(){this.ForEntityName="TEXT"}parseEntity(e,t){const i={type:t.value};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 10:i.startPoint=Rs(e);break;case 11:i.endPoint=Rs(e);break;case 40:i.textHeight=t.value;break;case 41:i.xScale=t.value;break;case 50:i.rotation=t.value;break;case 1:i.text=t.value;break;case 72:i.halign=t.value;break;case 73:i.valign=t.value;break;default:bc(i,t,e);break}t=e.next()}return i}};var mC={exports:{}},B8e=mC.exports,$7;function E8e(){return $7||($7=1,(function(n){(function(e,t){n.exports?n.exports=t():e.log=t()})(B8e,function(){var e=function(){},t="undefined",i=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"],s={},o=null;function a(g,v){var w=g[v];if(typeof w.bind=="function")return w.bind(g);try{return Function.prototype.bind.call(w,g)}catch{return function(){return Function.prototype.apply.apply(w,[g,arguments])}}}function l(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function h(g){return g==="debug"&&(g="log"),typeof console===t?!1:g==="trace"&&i?l:console[g]!==void 0?a(console,g):console.log!==void 0?a(console,"log"):e}function u(){for(var g=this.getLevel(),v=0;v<r.length;v++){var w=r[v];this[w]=v<g?e:this.methodFactory(w,g,this.name)}if(this.log=this.debug,typeof console===t&&g<this.levels.SILENT)return"No console available for logging"}function d(g){return function(){typeof console!==t&&(u.call(this),this[g].apply(this,arguments))}}function A(g,v,w){return h(g)||d.apply(this,arguments)}function f(g,v){var w=this,m,y,x,S="loglevel";typeof g=="string"?S+=":"+g:typeof g=="symbol"&&(S=void 0);function I(T){var k=(r[T]||"silent").toUpperCase();if(!(typeof window===t||!S)){try{window.localStorage[S]=k;return}catch{}try{window.document.cookie=encodeURIComponent(S)+"="+k+";"}catch{}}}function j(){var T;if(!(typeof window===t||!S)){try{T=window.localStorage[S]}catch{}if(typeof T===t)try{var k=window.document.cookie,B=encodeURIComponent(S),E=k.indexOf(B+"=");E!==-1&&(T=/^([^;]+)/.exec(k.slice(E+B.length+1))[1])}catch{}return w.levels[T]===void 0&&(T=void 0),T}}function C(){if(!(typeof window===t||!S)){try{window.localStorage.removeItem(S)}catch{}try{window.document.cookie=encodeURIComponent(S)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function b(T){var k=T;if(typeof k=="string"&&w.levels[k.toUpperCase()]!==void 0&&(k=w.levels[k.toUpperCase()]),typeof k=="number"&&k>=0&&k<=w.levels.SILENT)return k;throw new TypeError("log.setLevel() called with invalid level: "+T)}w.name=g,w.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},w.methodFactory=v||A,w.getLevel=function(){return x??y??m},w.setLevel=function(T,k){return x=b(T),k!==!1&&I(x),u.call(w)},w.setDefaultLevel=function(T){y=b(T),j()||w.setLevel(T,!1)},w.resetLevel=function(){x=null,C(),u.call(w)},w.enableAll=function(T){w.setLevel(w.levels.TRACE,T)},w.disableAll=function(T){w.setLevel(w.levels.SILENT,T)},w.rebuild=function(){if(o!==w&&(m=b(o.getLevel())),u.call(w),o===w)for(var T in s)s[T].rebuild()},m=b(o?o.getLevel():"WARN");var D=j();D!=null&&(x=b(D)),u.call(w)}o=new f,o.getLogger=function(v){if(typeof v!="symbol"&&typeof v!="string"||v==="")throw new TypeError("You must supply a name when creating a logger.");var w=s[v];return w||(w=s[v]=new f(v,o.methodFactory)),w};var p=typeof window!==t?window.log:void 0;return o.noConflict=function(){return typeof window!==t&&window.log===o&&(window.log=p),o},o.getLoggers=function(){return s},o.default=o,o})})(mC)),mC.exports}var F8e=E8e();const Ls=Vp(F8e);Ls.setLevel("error");function k8e(n){n.registerEntityHandler(a8e),n.registerEntityHandler(c8e),n.registerEntityHandler(h8e),n.registerEntityHandler(u8e),n.registerEntityHandler(d8e),n.registerEntityHandler(A8e),n.registerEntityHandler(f8e),n.registerEntityHandler(p8e),n.registerEntityHandler(g8e),n.registerEntityHandler(y8e),n.registerEntityHandler(w8e),n.registerEntityHandler(x8e),n.registerEntityHandler(_8e),n.registerEntityHandler(S8e),n.registerEntityHandler(T8e)}class I8e{constructor(){this._entityHandlers={},k8e(this)}parse(e){return typeof e=="string"?this._parse(e):(console.error("Cannot read dxf source of type `"+typeof e),null)}registerEntityHandler(e){const t=new e;this._entityHandlers[t.ForEntityName]=t}parseSync(e){return this.parse(e)}parseStream(e){let t="";const i=this;return new Promise((r,s)=>{e.on("data",o=>{t+=o}),e.on("end",()=>{try{r(i._parse(t))}catch(o){s(o)}}),e.on("error",o=>{s(o)})})}_parse(e){const t={};let i=0;const r=e.split(/\r\n|\r|\n/g),s=new r8e(r);if(!s.hasNext())throw Error("Empty file");const o=this;let a;function l(){for(a=s.next();!s.isEOF();)if(a.code===0&&a.value==="SECTION"){if(a=s.next(),a.code!==2){console.error("Unexpected code %s after 0:SECTION",qX(a)),a=s.next();continue}a.value==="HEADER"?(Ls.debug("> HEADER"),t.header=h(),Ls.debug("<")):a.value==="BLOCKS"?(Ls.debug("> BLOCKS"),t.blocks=u(),Ls.debug("<")):a.value==="ENTITIES"?(Ls.debug("> ENTITIES"),t.entities=y(!1),Ls.debug("<")):a.value==="TABLES"?(Ls.debug("> TABLES"),t.tables=A(),Ls.debug("<")):a.value==="EOF"?Ls.debug("EOF"):Ls.warn("Skipping section '%s'",a.value)}else a=s.next()}function h(){let I=null,j=null;const C={};for(a=s.next();;){if($d(a,0,"ENDSEC")){I&&(C[I]=j);break}else a.code===9?(I&&(C[I]=j),I=a.value):a.code===10?j={x:a.value}:a.code===20?j.y=a.value:a.code===30?j.z=a.value:j=a.value;a=s.next()}return a=s.next(),C}function u(){const I={};for(a=s.next();a.value!=="EOF"&&!$d(a,0,"ENDSEC");)if($d(a,0,"BLOCK")){Ls.debug("block {");const j=d();Ls.debug("}"),S(j),j.name?I[j.name]=j:Ls.error('block with handle "'+j.handle+'" is missing a name.')}else vg(a),a=s.next();return I}function d(){const I={};for(a=s.next();a.value!=="EOF";){switch(a.code){case 1:I.xrefPath=a.value,a=s.next();break;case 2:I.name=a.value,a=s.next();break;case 3:I.name2=a.value,a=s.next();break;case 5:I.handle=a.value,a=s.next();break;case 8:I.layer=a.value,a=s.next();break;case 10:I.position=x(a),a=s.next();break;case 67:I.paperSpace=!!(a.value&&a.value==1),a=s.next();break;case 70:a.value!=0&&(I.type=a.value),a=s.next();break;case 100:a=s.next();break;case 330:I.ownerHandle=a.value,a=s.next();break;case 0:if(a.value=="ENDBLK")break;I.entities=y(!0);break;default:vg(a),a=s.next()}if($d(a,0,"ENDBLK")){a=s.next();break}}return I}function A(){const I={};for(a=s.next();a.value!=="EOF"&&!$d(a,0,"ENDSEC");)$d(a,0,"TABLE")?(a=s.next(),m[a.value]?(Ls.debug(a.value+" Table {"),I[m[a.value].tableName]=p(a),Ls.debug("}")):Ls.debug("Unhandled Table "+a.value)):a=s.next();return a=s.next(),I}const f="ENDTAB";function p(I){const j=m[I.value],C={};let b=0;for(a=s.next();!$d(a,0,f);)switch(a.code){case 5:C.handle=a.value,a=s.next();break;case 330:C.ownerHandle=a.value,a=s.next();break;case 100:a.value==="AcDbSymbolTable"||vg(a),a=s.next();break;case 70:b=a.value,a=s.next();break;case 0:a.value===j.dxfSymbolName?C[j.tableRecordsProperty]=j.parseTableRecords():(vg(a),a=s.next());break;default:vg(a),a=s.next()}const D=C[j.tableRecordsProperty];if(D){let T=(()=>{if(D.constructor===Array)return D.length;if(typeof D=="object")return Object.keys(D).length})();b!==T&&Ls.warn("Parsed "+T+" "+j.dxfSymbolName+"'s but expected "+b)}return a=s.next(),C}function g(){const I=[];let j={};for(Ls.debug("ViewPort {"),a=s.next();!$d(a,0,f);)switch(a.code){case 2:j.name=a.value,a=s.next();break;case 10:j.lowerLeftCorner=x(a),a=s.next();break;case 11:j.upperRightCorner=x(a),a=s.next();break;case 12:j.center=x(a),a=s.next();break;case 13:j.snapBasePoint=x(a),a=s.next();break;case 14:j.snapSpacing=x(a),a=s.next();break;case 15:j.gridSpacing=x(a),a=s.next();break;case 16:j.viewDirectionFromTarget=x(a),a=s.next();break;case 17:j.viewTarget=x(a),a=s.next();break;case 42:j.lensLength=a.value,a=s.next();break;case 43:j.frontClippingPlane=a.value,a=s.next();break;case 44:j.backClippingPlane=a.value,a=s.next();break;case 45:j.viewHeight=a.value,a=s.next();break;case 50:j.snapRotationAngle=a.value,a=s.next();break;case 51:j.viewTwistAngle=a.value,a=s.next();break;case 79:j.orthographicType=a.value,a=s.next();break;case 110:j.ucsOrigin=x(a),a=s.next();break;case 111:j.ucsXAxis=x(a),a=s.next();break;case 112:j.ucsYAxis=x(a),a=s.next();break;case 110:j.ucsOrigin=x(a),a=s.next();break;case 281:j.renderMode=a.value,a=s.next();break;case 281:j.defaultLightingType=a.value,a=s.next();break;case 292:j.defaultLightingOn=a.value,a=s.next();break;case 330:j.ownerHandle=a.value,a=s.next();break;case 63:case 421:case 431:j.ambientColor=a.value,a=s.next();break;case 0:a.value==="VPORT"&&(Ls.debug("}"),I.push(j),Ls.debug("ViewPort {"),j={},a=s.next());break;default:vg(a),a=s.next();break}return Ls.debug("}"),I.push(j),I}function v(){const I={};let j={},C=0,b;for(Ls.debug("LType {"),a=s.next();!$d(a,0,"ENDTAB");)switch(a.code){case 2:j.name=a.value,b=a.value,a=s.next();break;case 3:j.description=a.value,a=s.next();break;case 73:C=a.value,C>0&&(j.pattern=[]),a=s.next();break;case 40:j.patternLength=a.value,a=s.next();break;case 49:j.pattern.push(a.value),a=s.next();break;case 0:Ls.debug("}"),C>0&&C!==j.pattern.length&&Ls.warn("lengths do not match on LTYPE pattern"),I[b]=j,j={},Ls.debug("LType {"),a=s.next();break;default:a=s.next()}return Ls.debug("}"),I[b]=j,I}function w(){const I={};let j={},C;for(Ls.debug("Layer {"),a=s.next();!$d(a,0,"ENDTAB");)switch(a.code){case 2:j.name=a.value,C=a.value,a=s.next();break;case 62:j.visible=a.value>=0,j.colorIndex=Math.abs(a.value),j.color=D8e(j.colorIndex),a=s.next();break;case 70:j.frozen=(a.value&1)!=0||(a.value&2)!=0,a=s.next();break;case 0:a.value==="LAYER"&&(Ls.debug("}"),I[C]=j,Ls.debug("Layer {"),j={},C=void 0,a=s.next());break;default:vg(a),a=s.next();break}return Ls.debug("}"),I[C]=j,I}const m={VPORT:{tableRecordsProperty:"viewPorts",tableName:"viewPort",dxfSymbolName:"VPORT",parseTableRecords:g},LTYPE:{tableRecordsProperty:"lineTypes",tableName:"lineType",dxfSymbolName:"LTYPE",parseTableRecords:v},LAYER:{tableRecordsProperty:"layers",tableName:"layer",dxfSymbolName:"LAYER",parseTableRecords:w}};function y(I){const j=[],C=I?"ENDBLK":"ENDSEC";for(I||(a=s.next());;)if(a.code===0){if(a.value===C)break;const b=o._entityHandlers[a.value];if(b!=null){Ls.debug(a.value+" {");const D=b.parseEntity(s,a);a=s.lastReadGroup,Ls.debug("}"),S(D),j.push(D)}else{Ls.warn("Unhandled entity "+a.value),a=s.next();continue}}else a=s.next();return C=="ENDSEC"&&(a=s.next()),j}function x(I){const j={};let C=I.code;if(j.x=I.value,C+=10,I=s.next(),I.code!=C)throw new Error("Expected code for point value to be "+C+" but got "+I.code+".");return j.y=I.value,C+=10,I=s.next(),I.code!=C?(s.rewind(),j):(j.z=I.value,j)}function S(I){if(!I)throw new TypeError("entity cannot be undefined or null");I.handle||(I.handle=i++)}return l(),t}}function $d(n,e,t){return n.code===e&&n.value===t}function vg(n){Ls.debug("unhandled group "+qX(n))}function qX(n){return n.code+":"+n.value}function D8e(n){return KX[n]}const Fy={A5:{width:148,height:210,displayWidth:296,displayHeight:420},A4:{width:210,height:297,displayWidth:420,displayHeight:297*2},A3:{width:297,height:420,displayWidth:297*2,displayHeight:420*2},A2:{width:420,height:594,displayWidth:420*2,displayHeight:594*2},A1:{width:594,height:841,displayWidth:594*2,displayHeight:841*2},A0:{width:841,height:1189,displayWidth:841*2,displayHeight:1189*2}},j8e=(n,e)=>{const t=Fy[n];return e==="landscape"?{width:t.height,height:t.width,displayWidth:t.displayHeight,displayHeight:t.displayWidth}:t},V7=[{id:"top",label:"TOP VIEW"},{id:"front",label:"Front VIEW"},{id:"side",label:"Left VIEW"},{id:"door",label:"Door Front"},{id:"right",label:"Right VIEW"},{id:"base",label:"Base Frame"},{id:"iso",label:"ISO VIEW"},{id:"detail1",label:"Detail 1"},{id:"detail2",label:"Detail 2"},{id:"section",label:"Section A-A"}],DT=[{id:"info",label:"프로젝트 정보"},{id:"title",label:"제목"},{id:"specs",label:"사양"},{id:"notes",label:"메모"}],ZX=({isOpen:n,onClose:e,capturedViews:t})=>{var ws,Ts,Mn;const{t:i}=yv(),[r,s]=H.useState("A3"),[o,a]=H.useState("landscape"),[l,h]=H.useState(!1),u="#ffffff",[d,A]=H.useState(null),[f,p]=H.useState({x:0,y:0}),[g,v]=H.useState([]),[w,m]=H.useState(!1),[y,x]=H.useState(null),[S,I]=H.useState(null),[j,C]=H.useState(null),[b,D]=H.useState(!1),[T,k]=H.useState(null),[B,E]=H.useState({x:0,y:0,width:0,height:0,viewX:0,viewY:0,direction:""}),[z,te]=H.useState({vertical:[],horizontal:[]}),[L,O]=H.useState(!1),[J,$]=H.useState(null),[U,Y]=H.useState({x:0,y:0,angle:0,startAngle:0}),[K,V]=H.useState({vertical:[],horizontal:[]}),[Q,X]=H.useState({type:null,index:-1}),[W,se]=H.useState({type:null,position:0}),[q,de]=H.useState(1),[Ce,Se]=H.useState(0),[fe,M]=H.useState([[]]),[Z,Ae]=H.useState(0),[ie,ee]=H.useState({isOpen:!1,viewId:null,viewType:null}),[ae,me]=H.useState({}),[_e,ue]=H.useState(null),[Be,it]=H.useState("views"),[De,qe]=H.useState([]),[Je,Me]=H.useState(!1),[et,He]=H.useState("vector"),[ze,Oe]=H.useState(!1),[ke,je]=H.useState(!1),[rt,_t]=H.useState(!1),[Ee,Le]=H.useState("pdf"),[ye,Ze]=H.useState(!1),[nt,st]=H.useState("template"),[At,ft]=H.useState("shapes"),[Xt,Yt]=H.useState({canScrollLeft:!1,canScrollRight:!1}),[Zt,sn]=H.useState({canScrollLeft:!1,canScrollRight:!1}),vt=H.useRef(null),Ye=H.useRef(null),Gt=H.useRef(!1),Wt=H.useRef(""),Vt=H.useRef(null),Jt=H.useRef(null),{title:It}=Pl(),{spaceInfo:Ut,materialConfig:un}=hr(),{placedModules:Sn}=pi(),jt=Wi();H.useEffect(()=>{if(t&&Object.keys(t).length>0&&g.length===0){const ve=[];let Re=50,Ke=50;t.top&&(ve.push({id:`top_${Date.now()}`,x:Re,y:Ke,width:150,height:150,scale:1}),Re+=200),t.front&&(ve.push({id:`front_${Date.now()+1}`,x:Re,y:Ke,width:150,height:150,scale:1}),Re+=200),t.side&&(ve.push({id:`side_${Date.now()+2}`,x:Re,y:Ke,width:150,height:150,scale:1}),Ke+=200,Re=50),t.door&&ve.push({id:`door_${Date.now()+3}`,x:Re,y:Ke,width:150,height:150,scale:1}),v(ve)}},[t]);const{viewMode:fn,view2DDirection:Zn,setViewMode:Hn,setView2DDirection:ti,renderMode:ri,setRenderMode:bi,view2DTheme:Ni}=jt,{theme:ui}=Ua(),[si,Li]=H.useState({title:It||"Untitled Project",size:`W${(Ut==null?void 0:Ut.width)||0} × D${(Ut==null?void 0:Ut.depth)||0} × H${(Ut==null?void 0:Ut.height)||0}`,door:((ws=un==null?void 0:un.door)==null?void 0:ws.name)||"18.5T_PET",body:((Ts=un==null?void 0:un.body)==null?void 0:Ts.name)||"18.5T_LPM",notes:""}),Tr=H.useRef(null),xr=H.useRef(null),br=H.useRef(null),vn=H.useMemo(()=>{const ve=j8e(r,o);return console.log("📏 Paper dimensions:",{size:r,orientation:o,width:ve.width+"mm",height:ve.height+"mm",displayWidth:ve.displayWidth+"px",displayHeight:ve.displayHeight+"px"}),ve},[r,o]),wi=H.useMemo(()=>{const ve=window.innerWidth-344-180-60,Re=window.innerHeight-120;return Math.min(ve/vn.displayWidth,Re/vn.displayHeight)*q*.9},[vn,q]),Ve=(ve,Re)=>{Re.preventDefault(),m(!0),x(ve),p({x:100,y:75}),C({x:Re.clientX-100,y:Re.clientY-75})},ct=(ve,Re)=>{Re.stopPropagation();const Ke=g.find(Ge=>Ge.id===ve);Ke&&(console.log("🎯 뷰 클릭됨:",ve,Ke.type),I(ve),console.log("✅ selectedView 설정됨:",ve),A(ve),p({x:Re.clientX-Ke.x*wi,y:Re.clientY-Ke.y*wi}))},mt=(ve,Re)=>{ee({isOpen:!0,viewId:ve,viewType:Re})},An=async()=>{var ve;if(!(!br.current||!ie.viewId)){console.log("🎯 handleCaptureFromViewer 호출",{viewType:ie.viewType,viewId:ie.viewId});try{if(ie.viewType){if(console.log("🎨 뷰를 SVG 벡터로 변환 시작:",ie.viewType),!g.find(Ci=>Ci.id===ie.viewId)){console.error("뷰를 찾을 수 없습니다");return}const at=400,dt=300,Qt=document.createElementNS("http://www.w3.org/2000/svg","svg");Qt.setAttribute("width",String(at)),Qt.setAttribute("height",String(dt)),Qt.setAttribute("viewBox",`0 0 ${at} ${dt}`),Qt.setAttribute("xmlns","http://www.w3.org/2000/svg"),Qt.setAttribute("preserveAspectRatio","xMidYMid meet");const wn=document.createElementNS("http://www.w3.org/2000/svg","rect");wn.setAttribute("width","100%"),wn.setAttribute("height","100%"),wn.setAttribute("fill","#ffffff"),Qt.appendChild(wn);const gt=document.createElementNS("http://www.w3.org/2000/svg","defs"),Vn=document.createElementNS("http://www.w3.org/2000/svg","pattern");Vn.setAttribute("id","grid"),Vn.setAttribute("width","10"),Vn.setAttribute("height","10"),Vn.setAttribute("patternUnits","userSpaceOnUse");const Yn=document.createElementNS("http://www.w3.org/2000/svg","path");Yn.setAttribute("d","M 10 0 L 0 0 0 10"),Yn.setAttribute("fill","none"),Yn.setAttribute("stroke","#e0e0e0"),Yn.setAttribute("stroke-width","0.5"),Vn.appendChild(Yn),gt.appendChild(Vn),Qt.appendChild(gt);const ht=document.createElementNS("http://www.w3.org/2000/svg","rect");ht.setAttribute("width","100%"),ht.setAttribute("height","100%"),ht.setAttribute("fill","url(#grid)"),Qt.appendChild(ht);const Ot=document.createElementNS("http://www.w3.org/2000/svg","g");Ot.setAttribute("transform","translate(50, 50)");const In=document.createElementNS("http://www.w3.org/2000/svg","rect");In.setAttribute("x","0"),In.setAttribute("y","0"),In.setAttribute("width","300"),In.setAttribute("height","200"),In.setAttribute("fill","none"),In.setAttribute("stroke","#000000"),In.setAttribute("stroke-width","2"),Ot.appendChild(In);const Wn=document.createElementNS("http://www.w3.org/2000/svg","line");Wn.setAttribute("x1","100"),Wn.setAttribute("y1","0"),Wn.setAttribute("x2","100"),Wn.setAttribute("y2","200"),Wn.setAttribute("stroke","#000000"),Wn.setAttribute("stroke-width","1.5"),Ot.appendChild(Wn);const xn=document.createElementNS("http://www.w3.org/2000/svg","line");xn.setAttribute("x1","200"),xn.setAttribute("y1","0"),xn.setAttribute("x2","200"),xn.setAttribute("y2","200"),xn.setAttribute("stroke","#000000"),xn.setAttribute("stroke-width","1.5"),Ot.appendChild(xn);const Gn=document.createElementNS("http://www.w3.org/2000/svg","text");Gn.setAttribute("x","150"),Gn.setAttribute("y","-10"),Gn.setAttribute("font-size","12"),Gn.setAttribute("font-family","Arial"),Gn.setAttribute("text-anchor","middle"),Gn.setAttribute("fill","#000000"),Gn.textContent="3000mm",Ot.appendChild(Gn);const fi=document.createElementNS("http://www.w3.org/2000/svg","text");fi.setAttribute("x","-20"),fi.setAttribute("y","100"),fi.setAttribute("font-size","12"),fi.setAttribute("font-family","Arial"),fi.setAttribute("text-anchor","middle"),fi.setAttribute("transform","rotate(-90 -20 100)"),fi.setAttribute("fill","#000000"),fi.textContent="2000mm",Ot.appendChild(fi),Qt.appendChild(Ot);const Ki=new XMLSerializer().serializeToString(Qt),Ji="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(Ki)));console.log("📊 SVG 데이터 생성 완료",{svgDataUrl:Ji.substring(0,100)+"...",viewId:ie.viewId}),v(Ci=>{const Qi=Ci.map(zi=>zi.id===ie.viewId?(console.log("✅ 뷰 업데이트 중:",zi.id),{...zi,imageUrl:Ji,type:"image",hasDrawingData:!1,visible:!0,fileName:"2D Vector View",width:at,height:dt,scale:1}):zi);return console.log("📝 업데이트된 뷰 목록:",Qi),Qi}),setTimeout(()=>{Ae(Ci=>Ci+1),vt.current&&vt.current.renderAll()},100),ee({isOpen:!1,viewId:null,viewType:null}),console.log("✅ 2D 뷰가 SVG 벡터로 성공적으로 변환되었습니다"),alert(`${(ve=ie.viewType)==null?void 0:ve.toUpperCase()} 뷰가 벡터로 변환되었습니다. 뷰카드를 확인하세요.`);return}await new Promise(xe=>setTimeout(xe,500));const Re=br.current.querySelector("canvas");if(!Re){console.error("Canvas not found in viewer container");return}const Ke={scale:3,backgroundColor:"#ffffff",logging:!1,useCORS:!0,allowTaint:!1,onclone:xe=>{const at=xe.querySelector("canvas");if(at&&Re instanceof HTMLCanvasElement){const dt=at.getContext("2d");dt&&dt.drawImage(Re,0,0)}}},pt=(await C_(br.current,Ke)).toDataURL("image/png"),Pt=ie.viewType,pe=ie.viewId;Pt&&pe&&(me(xe=>({...xe,[`${pe}_${Pt}`]:pt})),console.log("View captured successfully:",Pt)),ee({isOpen:!1,viewId:null,viewType:null})}catch(Re){console.error("Error capturing view:",Re)}}},nn=(ve,Re)=>{v(Ke=>Ke.map(Ge=>Ge.id===ve?{...Ge,scale:Math.max(.3,Math.min(3,Ge.scale+Re))}:Ge))},zt=ve=>{v(Re=>Re.filter(Ke=>Ke.id!==ve)),S===ve&&I(null)};H.useEffect(()=>{const ve=Re=>{if((Re.key==="Delete"||Re.key==="Backspace")&&S){const Ke=document.activeElement;(Ke==null?void 0:Ke.tagName)!=="INPUT"&&(Ke==null?void 0:Ke.tagName)!=="TEXTAREA"&&(Re.preventDefault(),zt(S))}};return n&&document.addEventListener("keydown",ve),()=>{document.removeEventListener("keydown",ve)}},[n,S]);const gn=(ve,Re,Ke)=>{Ke.stopPropagation(),Ke.preventDefault();const Ge=g.find(pt=>pt.id===ve);Ge&&(D(!0),k(ve),E({x:Ke.clientX,y:Ke.clientY,width:Ge.width*Ge.scale,height:Ge.height*Ge.scale,viewX:Ge.x,viewY:Ge.y,direction:Re}))},Jn=(ve,Re)=>{var pt;Re.stopPropagation(),Re.preventDefault();const Ke=g.find(Pt=>Pt.id===ve);if(!Ke)return;console.log("🔄 회전 시작:",ve,Ke.type),O(!0),$(ve);const Ge=(pt=Re.currentTarget.parentElement)==null?void 0:pt.getBoundingClientRect();if(Ge){const Pt=Ge.left+Ge.width/2,pe=Ge.top+Ge.height/2,xe=Math.atan2(Re.clientY-pe,Re.clientX-Pt)*(180/Math.PI);console.log("📐 회전 초기값:",{centerX:Pt,centerY:pe,startAngle:xe,currentRotation:Ke.rotation||0}),Y({x:Pt,y:pe,angle:Ke.rotation||0,startAngle:xe})}},Qn=ci.useCallback((ve,Re)=>{const Ke={vertical:[],horizontal:[]},Ge=5;return g.forEach(pt=>{if(pt.id===Re)return;const Pt=pt.x,pe=pt.x+pt.width*pt.scale,xe=pt.y,at=pt.y+pt.height*pt.scale,dt=pt.x+pt.width*pt.scale/2,Qt=pt.y+pt.height*pt.scale/2,wn=ve.x,gt=ve.x+ve.width*ve.scale,Vn=ve.y,Yn=ve.y+ve.height*ve.scale,ht=ve.x+ve.width*ve.scale/2,Ot=ve.y+ve.height*ve.scale/2;Math.abs(wn-Pt)<Ge&&Ke.vertical.push(Pt),Math.abs(wn-pe)<Ge&&Ke.vertical.push(pe),Math.abs(gt-Pt)<Ge&&Ke.vertical.push(Pt),Math.abs(gt-pe)<Ge&&Ke.vertical.push(pe),Math.abs(ht-dt)<Ge&&Ke.vertical.push(dt),Math.abs(Vn-xe)<Ge&&Ke.horizontal.push(xe),Math.abs(Vn-at)<Ge&&Ke.horizontal.push(at),Math.abs(Yn-xe)<Ge&&Ke.horizontal.push(xe),Math.abs(Yn-at)<Ge&&Ke.horizontal.push(at),Math.abs(Ot-Qt)<Ge&&Ke.horizontal.push(Qt)}),Ke},[g]),pn=()=>{const ve=[...fe];ve[Ce]=g,ve.push([]),M(ve);const Re=ve.length-1;Se(Re),v([]),setTimeout(()=>{const Ke=document.querySelector(`.${Qe.pageListContainer}`);Ke&&(Ke.scrollLeft=Ke.scrollWidth)},100)},Ln=ve=>{const Re=[...fe];Re[Ce]=g,M(Re),Se(ve),v(Re[ve]||[])},Dn=ve=>{if(fe.length<=1)return;const Re=fe.filter((Ke,Ge)=>Ge!==ve);M(Re),Ce>=Re.length&&Se(Re.length-1),v(Re[Ce]||[])},ei=[.25,.33,.5,.66,.75,1,1.25,1.5,1.75,2],xi=ve=>{de(Re=>{let Ke=0,Ge=Math.abs(ei[0]-Re);for(let pt=1;pt<ei.length;pt++){const Pt=Math.abs(ei[pt]-Re);Pt<Ge&&(Ge=Pt,Ke=pt)}if(ve>0){for(let pt=Ke;pt<ei.length;pt++)if(ei[pt]>Re+.01)return ei[pt];return ei[ei.length-1]}else{for(let pt=Ke;pt>=0;pt--)if(ei[pt]<Re-.01)return ei[pt];return ei[0]}})},Yi=ci.useCallback(ve=>{if(L&&J){if(!g.find(Pt=>Pt.id===J))return;const Ke=Math.atan2(ve.clientY-U.y,ve.clientX-U.x)*(180/Math.PI),Ge=Ke-U.startAngle;let pt=U.angle+Ge;for(;pt<0;)pt+=360;for(;pt>=360;)pt-=360;ve.shiftKey&&(pt=Math.round(pt/15)*15),console.log("🔄 회전 중:",{viewId:J,currentAngle:Ke,angleDelta:Ge,newRotation:pt,shiftKey:ve.shiftKey}),v(Pt=>Pt.map(pe=>pe.id===J?{...pe,rotation:pt}:pe));return}if(b&&T){requestAnimationFrame(()=>{const Re=g.find(gt=>gt.id===T);if(!Re)return;const Ke=(ve.clientX-B.x)/wi,Ge=(ve.clientY-B.y)/wi,pt=B.width/B.height;let Pt=Re.width*Re.scale,pe=Re.height*Re.scale,xe=Re.x,at=Re.y;const dt=ve.shiftKey;switch(B.direction){case"nw":if(xe=B.viewX+Ke,at=B.viewY+Ge,Pt=B.width-Ke,pe=B.height-Ge,dt){const gt=(Math.abs(Ke)+Math.abs(Ge))/2*(Ke<0?1:-1);Pt=B.width-gt,pe=Pt/pt,xe=B.viewX+gt,at=B.viewY+gt/pt}break;case"n":at=B.viewY+Ge,pe=B.height-Ge;break;case"ne":if(at=B.viewY+Ge,Pt=B.width+Ke,pe=B.height-Ge,dt){const gt=(Math.abs(Ke)+Math.abs(Ge))/2*(Ke>0?1:-1);Pt=B.width+gt,pe=Pt/pt,at=B.viewY-gt/pt}break;case"w":xe=B.viewX+Ke,Pt=B.width-Ke;break;case"e":Pt=B.width+Ke;break;case"sw":if(xe=B.viewX+Ke,Pt=B.width-Ke,pe=B.height+Ge,dt){const gt=(Math.abs(Ke)+Math.abs(Ge))/2*(Ke<0?1:-1);Pt=B.width-gt,pe=Pt/pt,xe=B.viewX+gt}break;case"s":pe=B.height+Ge;break;case"se":if(Pt=B.width+Ke,pe=B.height+Ge,dt){const gt=(Math.abs(Ke)+Math.abs(Ge))/2*(Ke>0?1:-1);Pt=B.width+gt,pe=Pt/pt}break}Pt=Math.max(100,Pt),pe=Math.max(75,pe),xe<0&&(Pt+=xe,xe=0),at<0&&(pe+=at,at=0),xe+Pt>vn.displayWidth&&(Pt=vn.displayWidth-xe),at+pe>vn.displayHeight&&(pe=vn.displayHeight-at);const Qt={...Re,x:xe,y:at,width:Pt/Re.scale,height:pe/Re.scale,scale:Re.scale},wn=Qn(Qt,T);te(wn),v(gt=>gt.map(Vn=>Vn.id===T?{...Re,x:xe,y:at,width:Pt/Re.scale,height:pe/Re.scale}:Vn))});return}if(w&&y){C({x:ve.clientX-f.x,y:ve.clientY-f.y});return}d&&requestAnimationFrame(()=>{const Re=g.find(at=>at.id===d);if(!Re)return;const Ke=(ve.clientX-f.x)/wi,Ge=(ve.clientY-f.y)/wi,pt=Math.max(0,Math.min(vn.displayWidth-Re.width*Re.scale,Ke)),Pt=Math.max(0,Math.min(vn.displayHeight-Re.height*Re.scale,Ge)),pe={...Re,x:pt,y:Pt},xe=Qn(pe,d);te(xe),v(at=>at.map(dt=>dt.id===d?{...dt,x:pt,y:Pt}:dt))})},[L,J,U,b,T,g,B,wi,w,y,f,d,vn,Qn]),Bn=ci.useCallback(ve=>{if(L){O(!1),$(null);return}if(b){D(!1),k(null),te({vertical:[],horizontal:[]});return}if(w&&y&&xr.current){const Re=xr.current.getBoundingClientRect(),Ke=(ve.clientX-Re.left)/wi,Ge=(ve.clientY-Re.top)/wi;if(console.log("🎯 드롭 위치 계산:",{x:Ke,y:Ge,scale:wi,paperDimensions:vn}),Ke>=0&&Ge>=0&&Ke<=vn.displayWidth&&Ge<=vn.displayHeight)if(y.type==="shape"&&vt.current){const pt=vt.current;if(y.shapeType==="rectangle"){const Pt=new Xl({left:Ke-50,top:Ge-50,fill:"#333333",width:100,height:100,selectable:!0,hasControls:!0});pt.add(Pt)}else if(y.shapeType==="circle"){const Pt=new cd({left:Ke-50,top:Ge-50,fill:"#333333",radius:50,selectable:!0,hasControls:!0});pt.add(Pt)}else if(y.shapeType==="triangle"){const Pt=new Eu({left:Ke-50,top:Ge-50,fill:"#333333",width:100,height:100,selectable:!0,hasControls:!0});pt.add(Pt)}else if(y.shapeType==="rounded-rectangle"){const Pt=new Xl({left:Ke-50,top:Ge-50,fill:"#333333",width:100,height:100,rx:10,ry:10,selectable:!0,hasControls:!0});pt.add(Pt)}else if(y.shapeType==="ellipse"){const Pt=new Jd({left:Ke-50,top:Ge-50,fill:"#333333",rx:60,ry:40,selectable:!0,hasControls:!0});pt.add(Pt)}else if(y.shapeType==="pentagon"){const Pt=new Tm([{x:50,y:0},{x:100,y:35},{x:80,y:90},{x:20,y:90},{x:0,y:35}],{left:Ke-50,top:Ge-45,fill:"#333333",selectable:!0,hasControls:!0});pt.add(Pt)}else if(y.shapeType==="hexagon"){const Pt=new Tm([{x:30,y:0},{x:70,y:0},{x:100,y:50},{x:70,y:100},{x:30,y:100},{x:0,y:50}],{left:Ke-50,top:Ge-50,fill:"#333333",selectable:!0,hasControls:!0});pt.add(Pt)}else if(y.shapeType==="star"){const Pt=new sf("M 50,0 L 61,35 L 98,35 L 68,57 L 79,91 L 50,70 L 21,91 L 32,57 L 2,35 L 39,35 z",{left:Ke-50,top:Ge-45,fill:"#333333",selectable:!0,hasControls:!0});pt.add(Pt)}pt.renderAll(),console.log("✅ 도형 추가됨:",y.shapeType)}else if(y.type==="symbol"&&vt.current){const pt=vt.current,Pt=new pc(y.symbol||"",{left:Ke-30,top:Ge-30,fontSize:60,fill:"#333333",selectable:!0,hasControls:!0});pt.add(Pt),pt.renderAll(),console.log("✅ 심볼 추가됨:",y.symbol)}else if(y.type==="uploaded-file"&&y.uploadedFile){const pt=y.uploadedFile;if(pt.type==="image"){const Pt={id:`image_${Date.now()}`,x:Ke-100,y:Ge-75,width:200,height:150,scale:1,rotation:0,type:"image",imageUrl:pt.url,fileName:pt.name};console.log("✅ 이미지 뷰카드 추가:",Pt),v(pe=>[...pe,Pt])}else if(pt.type==="pdf"){const Pt={id:`pdf_${Date.now()}`,x:Ke-100,y:Ge-75,width:200,height:150,scale:1,rotation:0,type:"pdf",fileName:pt.name};console.log("✅ PDF 뷰카드 추가:",Pt),v(pe=>[...pe,Pt])}else if(pt.type==="dxf"){const Pt={id:`dxf_${Date.now()}`,x:Ke-100,y:Ge-75,width:200,height:150,scale:1,rotation:0,type:"dxf",fileName:pt.name};console.log("✅ DXF 뷰카드 추가:",Pt),v(pe=>[...pe,Pt])}}else{const pt={id:`${y.id}_${Date.now()}`,x:Ke-100,y:Ge-75,width:200,height:150,scale:1};console.log("✅ 뷰카드 추가:",pt),v(Pt=>{const pe=[...Pt,pt];return console.log("📊 업데이트된 viewPositions:",pe),pe})}else console.log("❌ 드롭 위치가 경계 밖:",{x:Ke,y:Ge,paperDimensions:vn});m(!1),x(null)}A(null),C(null),te({vertical:[],horizontal:[]})},[L,b,w,y,wi,vn]);H.useEffect(()=>{if(d||w||b||L)return document.addEventListener("mousemove",Yi),document.addEventListener("mouseup",Bn),()=>{document.removeEventListener("mousemove",Yi),document.removeEventListener("mouseup",Bn)}},[d,w,b,L,f,wi,B,U,Yi,Bn]);const Ri=H.useCallback(async()=>{if(!Ye.current)return console.error("캔버스 컨테이너가 없습니다."),!1;if(Gt.current)return console.log("⚠️ Canvas initialization already in progress"),!1;Gt.current=!0,console.log("🔧 Canvas initialization started - orientation:",o);try{if(vt.current){console.log("🗑️ Destroying existing canvas");try{vt.current.clear(),vt.current.dispose()}catch(ht){console.warn("Canvas dispose error (ignored):",ht)}vt.current=null}document.querySelectorAll(".canvas-container").forEach(ht=>{ht.remove()}),document.querySelectorAll("canvas").forEach(ht=>{ht.remove()}),Ye.current.innerHTML="",console.log("✅ Canvas container completely cleared");const Ke=`fabric-canvas-${Date.now()}`;Wt.current=Ke;const Ge=document.getElementById(Ke);Ge&&(console.warn("⚠️ Existing canvas found, removing"),Ge.remove());const pt=document.createElement("canvas");pt.id=Ke,pt.style.position="absolute",pt.style.top="0",pt.style.left="0",Ye.current.appendChild(pt),await new Promise(ht=>setTimeout(ht,20)),Ye.current.querySelectorAll(".canvas-container").forEach(ht=>ht.remove());const pe=new S6(Ke,{width:vn.displayWidth,height:vn.displayHeight,backgroundColor:u,selection:!0,preserveObjectStacking:!0,renderOnAddRemove:!0});vt.current=pe,requestAnimationFrame(()=>{const ht=document.querySelectorAll(".canvas-container");if(console.log(`🔍 Canvas created, found ${ht.length} containers`),ht.length>1){console.log("🚑 Emergency cleanup: Removing duplicate containers");for(let Ot=1;Ot<ht.length;Ot++)ht[Ot].remove()}if(Ye.current){const Ot=Ye.current.querySelectorAll(".canvas-container");if(Ot.length>1){console.log("🚑 Removing inner duplicate containers");for(let In=1;In<Ot.length;In++)Ot[In].remove()}}}),setTimeout(()=>{const ht=document.querySelectorAll(".canvas-container"),Ot=document.querySelectorAll("canvas");if(console.log(`🎯 Final check - containers: ${ht.length}, canvases: ${Ot.length}`),ht.length>1){console.log("🔥 Still duplicated! Force removing all but first");for(let In=1;In<ht.length;In++)ht[In].remove()}},100),console.log("🎯 그리드 생성 시작");const xe=20,at=xe*5;pe.setBackgroundColor("#fafafa",()=>{pe.renderAll()});for(let ht=0;ht<=vn.displayWidth;ht+=xe){const Ot=new Ql([ht,0,ht,vn.displayHeight],{stroke:"#cccccc",strokeWidth:1,selectable:!1,evented:!1,excludeFromExport:!1,hasControls:!1,hasBorders:!1});pe.add(Ot),pe.sendToBack(Ot)}for(let ht=0;ht<=vn.displayHeight;ht+=xe){const Ot=new Ql([0,ht,vn.displayWidth,ht],{stroke:"#cccccc",strokeWidth:1,selectable:!1,evented:!1,excludeFromExport:!1,hasControls:!1,hasBorders:!1});pe.add(Ot),pe.sendToBack(Ot)}for(let ht=0;ht<=vn.displayWidth;ht+=at){const Ot=new Ql([ht,0,ht,vn.displayHeight],{stroke:"#888888",strokeWidth:2,selectable:!1,evented:!1,excludeFromExport:!1,hasControls:!1,hasBorders:!1});pe.add(Ot)}for(let ht=0;ht<=vn.displayHeight;ht+=at){const Ot=new Ql([0,ht,vn.displayWidth,ht],{stroke:"#888888",strokeWidth:2,selectable:!1,evented:!1,excludeFromExport:!1,hasControls:!1,hasBorders:!1});pe.add(Ot)}const dt=vn.displayWidth/2,Qt=vn.displayHeight/2,wn=new Ql([dt,0,dt,vn.displayHeight],{stroke:"#0080ff",strokeWidth:2,strokeDashArray:[10,5],selectable:!1,evented:!1,excludeFromExport:!1,hasControls:!1,hasBorders:!1}),gt=new Ql([0,Qt,vn.displayWidth,Qt],{stroke:"#0080ff",strokeWidth:2,strokeDashArray:[10,5],selectable:!1,evented:!1,excludeFromExport:!1,hasControls:!1,hasBorders:!1});pe.add(wn),pe.add(gt),pe.renderAll(),console.log("✅ 그리드 생성 완료"),pe.on("object:modified",()=>{Ae(ht=>ht+1)}),pe.on("object:added",()=>{Ae(ht=>ht+1)}),pe.on("object:removed",()=>{Ae(ht=>ht+1)});const Vn=ht=>{if((ht.key==="Delete"||ht.key==="Backspace")&&pe){const Ot=pe.getActiveObject();if(Ot){const In=document.activeElement;(In==null?void 0:In.tagName)!=="INPUT"&&(In==null?void 0:In.tagName)!=="TEXTAREA"&&(ht.preventDefault(),pe.remove(Ot),pe.discardActiveObject(),pe.renderAll())}}};document.addEventListener("keydown",Vn),window.handleCanvasKeyDown=Vn,pe.renderAll();const Yn=pe.wrapperEl;return Yn&&(Yn.style.zIndex="10",Yn.style.position="absolute",Yn.style.top="0",Yn.style.left="0"),console.log("Fabric.js 캔버스 초기화 완료",{canvas:pe,width:pe.width,height:pe.height,backgroundColor:pe.backgroundColor,element:pe.getElement(),wrapper:pe.wrapperEl}),console.log("✅ Canvas reinitialized - orientation:",o),!0}catch(ve){return console.error("Fabric.js 캔버스 생성 오류:",ve),!1}finally{Gt.current=!1,console.log("🔓 Canvas initialization flag reset")}},[n,o,vn,u]);H.useEffect(()=>{let ve=null;if(Ye.current&&n&&(ve=new MutationObserver(Ke=>{var pt;const Ge=(pt=Ye.current)==null?void 0:pt.querySelectorAll(".canvas-container");if(Ge&&Ge.length>1){console.log("🚨 MutationObserver: 중복 캔버스 감지!",Ge.length);for(let Pt=1;Pt<Ge.length;Pt++)Ge[Pt].remove()}}),ve.observe(Ye.current,{childList:!0,subtree:!0})),!n){if(vt.current){console.log("모달 닫힘 - 캔버스 정리");try{vt.current.clear(),vt.current.dispose()}catch(Ke){console.error("캔버스 정리 중 오류:",Ke)}vt.current=null}if(Ye.current){const Ke=Ye.current.querySelectorAll(".canvas-container");console.log(`🧹 모달 닫힘 - canvas-container ${Ke.length}개 제거`),Ke.forEach(pt=>pt.remove());const Ge=Ye.current.querySelectorAll("canvas");console.log(`🧹 모달 닫힘 - canvas ${Ge.length}개 제거`),Ge.forEach(pt=>pt.remove())}return}if(n&&Ye.current&&!vt.current){console.log("🚀 캔버스 초기화 시도:",{isOpen:n,hasContainer:!!Ye.current,hasCanvas:!!vt.current}),Ri();let Ke=0;const Ge=setInterval(()=>{if(Ye.current){const pt=Ye.current.querySelectorAll(".canvas-container");if(pt.length>1){console.log(`🔥 Interval: 중복 제거 ${pt.length}개 → 1개`);for(let Pt=1;Pt<pt.length;Pt++)pt[Pt].remove()}}Ke++,Ke>=10&&clearInterval(Ge)},100)}const Re=Ke=>{if(vt.current&&(Ke.key==="Delete"||Ke.key==="Backspace")){const Ge=vt.current.getActiveObjects();Ge.length>0&&(Ge.forEach(pt=>vt.current.remove(pt)),vt.current.discardActiveObject(),vt.current.renderAll())}};return n&&document.addEventListener("keydown",Re),()=>{document.removeEventListener("keydown",Re),window.handleCanvasKeyDown&&(document.removeEventListener("keydown",window.handleCanvasKeyDown),delete window.handleCanvasKeyDown),ve&&(ve.disconnect(),ve=null)}},[n]),H.useEffect(()=>{!n||!vt.current||(console.log("🔄 Paper dimensions 변경 감지"),vt.current.setDimensions({width:vn.displayWidth,height:vn.displayHeight}),vt.current.renderAll())},[vn.displayWidth,vn.displayHeight,n]),H.useEffect(()=>{if(fe[Ce]!==g){const ve=[...fe];ve[Ce]=g,M(ve)}},[g,Ce]),H.useEffect(()=>{const ve=Ke=>{if(W.type){const Ge=document.querySelector(`.${Qe.rulerWrapper}`);if(Ge){Ge.getBoundingClientRect();const pt=document.querySelector(`.${Qe.previewContent}`),Pt=pt==null?void 0:pt.getBoundingClientRect();if(Pt)if(W.type==="vertical"){const pe=(Ke.clientX-Pt.left)/wi;pe>=0&&pe<=vn.displayWidth&&V(xe=>({...xe,vertical:[...xe.vertical,pe]}))}else{const pe=(Ke.clientY-Pt.top)/wi;pe>=0&&pe<=vn.displayHeight&&V(xe=>({...xe,horizontal:[...xe.horizontal,pe]}))}}se({type:null,position:0})}if(Q.type){const Ge=document.querySelector(`.${Qe.previewContent}`),pt=Ge==null?void 0:Ge.getBoundingClientRect();if(pt)if(Q.type==="vertical"){const Pt=(Ke.clientX-pt.left)/wi;Pt>=0&&Pt<=vn.displayWidth&&V(pe=>({...pe,vertical:pe.vertical.map((xe,at)=>at===Q.index?Pt:xe)}))}else{const Pt=(Ke.clientY-pt.top)/wi;Pt>=0&&Pt<=vn.displayHeight&&V(pe=>({...pe,horizontal:pe.horizontal.map((xe,at)=>at===Q.index?Pt:xe)}))}}},Re=()=>{se({type:null,position:0}),X({type:null,index:-1})};if(W.type||Q.type)return document.addEventListener("mousemove",ve),document.addEventListener("mouseup",Re),()=>{document.removeEventListener("mousemove",ve),document.removeEventListener("mouseup",Re)}},[W,Q,wi,vn]);const xt=()=>{if(Vt.current){const{scrollLeft:ve,scrollWidth:Re,clientWidth:Ke}=Vt.current;Yt({canScrollLeft:ve>0,canScrollRight:ve<Re-Ke-1})}if(Jt.current){const{scrollLeft:ve,scrollWidth:Re,clientWidth:Ke}=Jt.current;sn({canScrollLeft:ve>0,canScrollRight:ve<Re-Ke-1})}};H.useEffect(()=>{xt();const ve=()=>{xt()},Re=Vt.current,Ke=Jt.current;return Re&&Re.addEventListener("scroll",ve),Ke&&Ke.addEventListener("scroll",ve),window.addEventListener("resize",xt),()=>{Re&&Re.removeEventListener("scroll",ve),Ke&&Ke.removeEventListener("scroll",ve),window.removeEventListener("resize",xt)}},[]);const Bt=ve=>{if(Jt.current){const Re=ve==="left"?-100:100;Jt.current.scrollBy({left:Re,behavior:"smooth"})}},on=(ve,Re)=>{if(console.log("도형 클릭됨:",Re),!vt.current){console.error("캔버스가 초기화되지 않았습니다.");return}const Ke=vt.current;console.log("캔버스 상태:",{width:Ke.width,height:Ke.height,objects:Ke.getObjects().length,isReady:Ke.getElement()!==null});const Ge=Ke.width/2,pt=Ke.height/2;Gke(ve,(Pt,pe)=>{var dt;if(console.log("SVG 로드됨:",{objects:Pt.length,options:pe}),Pt.length===0){console.error("SVG 객체를 생성할 수 없습니다.");return}const xe=cke.groupSVGElements(Pt,pe);xe.set({left:Ge-40,top:pt-40,scaleX:3.5,scaleY:3.5,fill:"#333333",stroke:"#333333",strokeWidth:0}),console.log("도형 추가 전 객체 수:",Ke.getObjects().length),Ke.add(xe),console.log("도형 추가 후 객체 수:",Ke.getObjects().length),Ke.setActiveObject(xe),Ke.renderAll(),console.log("도형이 캔버스에 추가되었습니다.");const at=Ke.getElement();console.log("캔버스 엘리먼트 상태:",{width:at.width,height:at.height,style:at.style.cssText,parent:(dt=at.parentElement)==null?void 0:dt.className})},Pt=>{console.error("SVG 로드 에러:",Pt)})},ln=ve=>{if(console.log("선 클릭됨:",ve),!vt.current){console.error("캔버스가 초기화되지 않았습니다.");return}const Re=vt.current,Ke=Re.width/2,Ge=Re.height/2;let pt;switch(ve){case"horizontal":pt=new Ql([Ke-100,Ge,Ke+100,Ge],{stroke:"#333333",strokeWidth:2,strokeDashArray:null});break;case"vertical":pt=new Ql([Ke,Ge-100,Ke,Ge+100],{stroke:"#333333",strokeWidth:2,strokeDashArray:null});break;case"diagonal1":pt=new Ql([Ke-100,Ge-100,Ke+100,Ge+100],{stroke:"#333333",strokeWidth:2,strokeDashArray:null});break;case"diagonal2":pt=new Ql([Ke-100,Ge+100,Ke+100,Ge-100],{stroke:"#333333",strokeWidth:2,strokeDashArray:null});break}pt&&(console.log("선 추가 전 객체 수:",Re.getObjects().length),Re.add(pt),console.log("선 추가 후 객체 수:",Re.getObjects().length),Re.setActiveObject(pt),Re.renderAll(),console.log("선이 캔버스에 추가되었습니다."))},li=async ve=>{if(vt.current)try{const Re=await ve.text(),Ge=new I8e().parseSync(Re);if(!Ge){console.error("DXF 파싱 실패");return}const pt=vt.current,Pt=pt.width,pe=pt.height;let xe=1/0,at=1/0,dt=-1/0,Qt=-1/0;Ge.entities&&Ge.entities.forEach(xn=>{xn.type==="LINE"?(xe=Math.min(xe,xn.vertices[0].x,xn.vertices[1].x),at=Math.min(at,xn.vertices[0].y,xn.vertices[1].y),dt=Math.max(dt,xn.vertices[0].x,xn.vertices[1].x),Qt=Math.max(Qt,xn.vertices[0].y,xn.vertices[1].y)):xn.type==="LWPOLYLINE"||xn.type==="POLYLINE"?xn.vertices.forEach(Gn=>{xe=Math.min(xe,Gn.x),at=Math.min(at,Gn.y),dt=Math.max(dt,Gn.x),Qt=Math.max(Qt,Gn.y)}):(xn.type==="CIRCLE"||xn.type==="ARC")&&(xe=Math.min(xe,xn.center.x-xn.radius),at=Math.min(at,xn.center.y-xn.radius),dt=Math.max(dt,xn.center.x+xn.radius),Qt=Math.max(Qt,xn.center.y+xn.radius))});const wn=dt-xe,gt=Qt-at,Vn=Pt*.8/wn,Yn=pe*.8/gt,ht=Math.min(Vn,Yn),Ot=(Pt-wn*ht)/2-xe*ht,In=(pe-gt*ht)/2+Qt*ht,Wn=[];if(Ge.entities&&Ge.entities.forEach(xn=>{if(xn.type==="LINE"){const Gn=new Ql([xn.vertices[0].x*ht+Ot,-xn.vertices[0].y*ht+In,xn.vertices[1].x*ht+Ot,-xn.vertices[1].y*ht+In],{stroke:$h("text",Ni),strokeWidth:1,selectable:!0});Wn.push(Gn)}else if(xn.type==="LWPOLYLINE"||xn.type==="POLYLINE"){const Gn=xn.vertices.map(Ki=>({x:Ki.x*ht+Ot,y:-Ki.y*ht+In})),fi=new _u(Gn,{stroke:$h("text",Ni),strokeWidth:1,fill:"transparent",selectable:!0});Wn.push(fi)}else if(xn.type==="CIRCLE"){const Gn=new cd({left:xn.center.x*ht+Ot-xn.radius*ht,top:-xn.center.y*ht+In-xn.radius*ht,radius:xn.radius*ht,stroke:$h("text",Ni),strokeWidth:1,fill:"transparent",selectable:!0});Wn.push(Gn)}else if(xn.type==="ARC"){const Gn=xn.startAngle||0,fi=xn.endAngle||360,Ki=xn.radius*ht,Ji=xn.center.x*ht+Ot,Ci=-xn.center.y*ht+In,Qi=Gn*Math.PI/180,zi=fi*Math.PI/180,Ir=Math.abs(fi-Gn)>180?1:0,Hr=Ji+Ki*Math.cos(Qi),Si=Ci-Ki*Math.sin(Qi),re=Ji+Ki*Math.cos(zi),be=Ci-Ki*Math.sin(zi),Ue=new sf(`M ${Hr} ${Si} A ${Ki} ${Ki} 0 ${Ir} 0 ${re} ${be}`,{stroke:$h("text",Ni),strokeWidth:1,fill:"transparent",selectable:!0});Wn.push(Ue)}}),Wn.length>0){const xn=new Jh(Wn,{selectable:!0,hasControls:!0,hasBorders:!0});pt.add(xn),pt.setActiveObject(xn),pt.renderAll()}}catch(Re){console.error("DXF 파일 처리 오류:",Re)}},hi=()=>{if(!vt.current)return;const ve=vt.current,Re=ve.width/2,Ke=ve.height/2,Ge=new gd("텍스트를 입력하세요",{left:Re-100,top:Ke,fontFamily:"Arial",fontSize:20,fill:"#333333"});ve.add(Ge),ve.setActiveObject(Ge),Ge.enterEditing(),ve.renderAll()},Ii=ve=>{if(console.log("심볼 클릭됨:",ve),!vt.current){console.error("캔버스가 초기화되지 않았습니다.");return}const Re=vt.current,Ke=Re.width/2,Ge=Re.height/2,pt=new pc(ve,{left:Ke-20,top:Ge-20,fontFamily:"Arial",fontSize:40,fill:"#333333"});console.log("심볼 추가 전 객체 수:",Re.getObjects().length),Re.add(pt),console.log("심볼 추가 후 객체 수:",Re.getObjects().length),Re.setActiveObject(pt),Re.renderAll(),console.log("심볼이 캔버스에 추가되었습니다.")},kr=ve=>{if(console.log("말풍선 클릭됨:",ve),!vt.current){console.error("Fabric.js 캔버스가 초기화되지 않았습니다.");return}const Re=vt.current,Ke=Re.width/2,Ge=Re.height/2,pt=new Jh([],{left:Ke-100,top:Ge-50}),Pt=new Xl({left:0,top:0,width:200,height:100,rx:10,ry:10,fill:"#ffffff",stroke:"#333333",strokeWidth:2});pt.addWithUpdate(Pt);let pe;switch(ve){case"left":pe=new Eu({left:-10,top:40,width:20,height:20,angle:-90,fill:"#ffffff",stroke:"#333333",strokeWidth:2});break;case"right":pe=new Eu({left:190,top:40,width:20,height:20,angle:90,fill:"#ffffff",stroke:"#333333",strokeWidth:2});break;case"top":pe=new Eu({left:90,top:-10,width:20,height:20,angle:0,fill:"#ffffff",stroke:"#333333",strokeWidth:2});break;case"bottom":pe=new Eu({left:90,top:90,width:20,height:20,angle:180,fill:"#ffffff",stroke:"#333333",strokeWidth:2});break}pe&&pt.addWithUpdate(pe);const xe=new gd("텍스트를 입력하세요",{left:10,top:35,fontFamily:"Arial",fontSize:16,fill:"#333333"});pt.addWithUpdate(xe),Re.add(pt),Re.setActiveObject(pt),Re.renderAll(),console.log("말풍선이 추가되었습니다.")},zr=ve=>{if(console.log("프레임 클릭됨:",ve),!vt.current){console.error("Fabric.js 캔버스가 초기화되지 않았습니다.");return}const Re=vt.current,Ke=Re.width/2,Ge=Re.height/2;let pt;switch(ve){case"simple":pt=new Xl({left:Ke-100,top:Ge-75,width:200,height:150,fill:"transparent",stroke:"#333333",strokeWidth:2});break;case"double":const Pt=new Xl({left:0,top:0,width:200,height:150,fill:"transparent",stroke:"#333333",strokeWidth:1}),pe=new Xl({left:10,top:10,width:180,height:130,fill:"transparent",stroke:"#333333",strokeWidth:1});pt=new Jh([Pt,pe],{left:Ke-100,top:Ge-75});break;case"dashed":pt=new Xl({left:Ke-100,top:Ge-75,width:200,height:150,fill:"transparent",stroke:"#333333",strokeWidth:2,strokeDashArray:[8,4]});break;case"rounded":pt=new Xl({left:Ke-100,top:Ge-75,width:200,height:150,rx:10,ry:10,fill:"transparent",stroke:"#333333",strokeWidth:2});break}pt&&(Re.add(pt),Re.setActiveObject(pt),Re.renderAll(),console.log("프레임이 추가되었습니다."))},Us=()=>{vt.current&&(vt.current.discardActiveObject(),vt.current.renderAll())};if(H.useEffect(()=>{const ve=Re=>{const Ke=Re.target,Ge=Tr.current;if(Ge&&Ge.contains(Ke))if(Re.ctrlKey||Re.metaKey){Re.preventDefault();const pt=Re.deltaY>0?-1:1;xi(pt)}else Re.preventDefault()};return document.addEventListener("wheel",ve,{passive:!1,capture:!0}),()=>{document.removeEventListener("wheel",ve,{capture:!0})}},[]),H.useEffect(()=>{const ve=Re=>{Re.target.closest(`.${Qe.zoomPresetDropdown}`)||je(!1)};if(ke)return document.addEventListener("click",ve),()=>{document.removeEventListener("click",ve)}},[ke]),H.useEffect(()=>{const ve=Re=>{Re.target.closest(`.${Qe.exportButtonWrapper}`)||_t(!1)};if(rt)return document.addEventListener("click",ve),()=>{document.removeEventListener("click",ve)}},[rt]),H.useEffect(()=>{const ve=Re=>{Re.target.closest(`.${Qe.paperSizeDropdown}`)||Ze(!1)};if(ye)return document.addEventListener("click",ve),()=>{document.removeEventListener("click",ve)}},[ye]),!n)return null;const io=async()=>{if(Tr.current){h(!0);try{const ve=new qi({orientation:o,unit:"mm",format:[vn.width,vn.height]});ve.setFillColor(u),ve.rect(0,0,vn.width,vn.height,"F");for(const Ke of g){const Ge=Ke.id.split("_")[0],pt=Ke.width*Ke.scale*vn.width/vn.displayWidth,Pt=Ke.height*Ke.scale*vn.height/vn.displayHeight,pe=Ke.x*vn.width/vn.displayWidth,xe=Ke.y*vn.height/vn.displayHeight;try{let at="front";if(Ge==="top")at="top";else if(Ge==="front")at="front";else if(Ge==="side")at="left";else if(Ge==="door")throw new Error("Door view는 벡터 렌더링 미지원");const dt={viewMode:"2D",view2DDirection:at,renderMode:"solid",showDimensions:!0,showGuides:!1,showAxis:!1,showAll:!1,spaceInfo:Ut,placedModules:Sn},Qt=2.83465,wn={x:0,y:0,width:pt*Qt,height:Pt*Qt},gt=OEe(dt,wn);if(gt&&ve.svg){const Vn=new DOMParser().parseFromString(gt,"image/svg+xml").documentElement;ve.svg(Vn,{x:pe,y:xe,width:pt,height:Pt}),console.log(`✅ ${Ge} 뷰가 벡터로 렌더링되었습니다.`)}else throw new Error("SVG 렌더링 실패 또는 svg2pdf 미지원")}catch(at){console.warn("벡터 렌더링 실패, 래스터 이미지로 폴백:",at);let dt=null;if(Ge==="top"?dt=t==null?void 0:t.top:Ge==="front"?dt=t==null?void 0:t.front:Ge==="side"?dt=t==null?void 0:t.side:Ge==="door"&&(dt=t==null?void 0:t.door),dt||(dt=ae[Ke.id]),dt)try{ve.addImage(dt,"PNG",pe,xe,pt,Pt),console.log(`⚠️ ${Ge} 뷰는 래스터 이미지로 렌더링되었습니다.`)}catch(Qt){console.error("이미지 추가 실패:",Qt)}else console.warn("이미지를 찾을 수 없음:",Ge,Ke.id)}}for(const Ke of g){const Ge=Ke.id.split("_")[0];if(DT.some(Pt=>Pt.id===Ge)){const Pt=Ke.x*vn.width/vn.displayWidth,pe=Ke.y*vn.height/vn.displayHeight,xe=Ke.width*Ke.scale*vn.width/vn.displayWidth,at=Ke.height*Ke.scale*vn.height/vn.displayHeight;if(ve.setFillColor("#2a2a2a"),ve.rect(Pt,pe,xe,at,"F"),Ge==="info"){const dt=$h();ve.setTextColor(dt),ve.setFontSize(18),ve.text("INSHOW",Pt+5,pe+10),ve.setTextColor("#ffffff"),ve.setFontSize(14),ve.text(si.title,Pt+5,pe+20),ve.setFontSize(10),ve.setTextColor("#888888"),ve.text("Size:",Pt+5,pe+30),ve.setTextColor(dt),ve.text(si.size,Pt+20,pe+30),ve.setTextColor("#888888"),ve.text("Door:",Pt+5,pe+37),ve.setTextColor(dt),ve.text(si.door,Pt+20,pe+37),ve.setTextColor("#888888"),ve.text("Body:",Pt+5,pe+44),ve.setTextColor(dt),ve.text(si.body,Pt+20,pe+44)}else if(Ge==="title")ve.setTextColor("#ffffff"),ve.setFontSize(16),ve.text(si.title,Pt+5,pe+at/2);else if(Ge==="notes"&&si.notes){ve.setTextColor("#cccccc"),ve.setFontSize(10);const dt=ve.splitTextToSize(si.notes,xe-10);ve.text(dt,Pt+5,pe+10)}}}const Re=`${It||"furniture-design"}_${new Date().toISOString().split("T")[0]}.pdf`;ve.save(Re)}catch(ve){console.error("PDF 생성 실패:",ve),alert("PDF 생성에 실패했습니다.")}finally{h(!1)}}};return n?c.jsxs("div",{className:`${Qe.overlay} ${ui.mode==="dark"?Qe.darkTheme:Qe.lightTheme}`,children:[c.jsxs("div",{className:Qe.fullContainer,children:[c.jsxs("div",{className:Qe.header,children:[c.jsx("h2",{children:"도면 에디터"}),c.jsxs("div",{className:Qe.controls,children:[c.jsxs("div",{className:Qe.zoomControls,children:[c.jsx("button",{className:Qe.zoomBtn,onClick:()=>xi(-1),title:"축소 (Ctrl+-)",children:"−"}),c.jsx("input",{type:"range",min:"25",max:"200",value:q*100,onChange:ve=>{const Re=parseInt(ve.target.value)/100;de(Re)},className:Qe.zoomSlider,title:"확대/축소"}),c.jsxs("span",{className:Qe.zoomValue,children:[(q*100).toFixed(0),"%"]}),c.jsx("button",{className:Qe.zoomBtn,onClick:()=>xi(1),title:"확대 (Ctrl++)",children:"+"}),c.jsxs("div",{className:Qe.zoomPresetDropdown,children:[c.jsx("button",{className:Qe.zoomPresetButton,onClick:()=>je(!ke),title:"화면 크기 프리셋",children:c.jsx(lf,{size:16})}),ke&&c.jsxs("div",{className:Qe.zoomPresetMenu,children:[c.jsx("button",{onClick:()=>{de(.25),je(!1)},children:"25%"}),c.jsx("button",{onClick:()=>{de(.33),je(!1)},children:"33%"}),c.jsx("button",{onClick:()=>{de(.5),je(!1)},children:"50%"}),c.jsx("button",{onClick:()=>{de(.66),je(!1)},children:"66%"}),c.jsx("button",{onClick:()=>{de(.75),je(!1)},children:"75%"}),c.jsx("button",{onClick:()=>{de(1),je(!1)},children:"100%"}),c.jsx("button",{onClick:()=>{de(1.25),je(!1)},children:"125%"}),c.jsx("button",{onClick:()=>{de(1.5),je(!1)},children:"150%"}),c.jsx("button",{onClick:()=>{de(1.75),je(!1)},children:"175%"}),c.jsx("button",{onClick:()=>{de(2),je(!1)},children:"200%"}),c.jsx("div",{className:Qe.zoomPresetDivider}),c.jsx("button",{onClick:()=>{const ve=document.querySelector(`.${Qe.previewContainer}`);if(ve){const Re=ve.clientWidth-80,Ke=ve.clientHeight-80,Ge=vn.displayWidth,pt=vn.displayHeight,Pt=Re/Ge,pe=Ke/pt;de(Math.min(Pt,pe,2))}je(!1)},children:"화면에 맞춤"})]})]})]}),c.jsxs("div",{className:Qe.paperSizeContainer,children:[c.jsx("label",{className:Qe.paperSizeLabel,children:"용지사이즈:"}),c.jsxs("div",{className:Qe.paperSizeDropdown,children:[c.jsxs("button",{className:Qe.paperSizeButton,onClick:()=>Ze(!ye),title:"용지 크기 선택",children:[r,c.jsx(lf,{size:16})]}),ye&&c.jsx("div",{className:Qe.paperSizeMenu,children:["A5","A4","A3","A2","A1","A0"].map(ve=>c.jsxs("button",{className:r===ve?Qe.selected:"",onClick:()=>{s(ve),Ze(!1)},children:[ve,c.jsx("span",{className:Qe.paperDimensions,children:o==="portrait"?`${Fy[ve].width} × ${Fy[ve].height} mm`:`${Fy[ve].height} × ${Fy[ve].width} mm`})]},ve))})]})]}),c.jsxs("div",{className:Qe.orientationButtons,children:[c.jsx("button",{className:`${Qe.orientButton} ${o==="landscape"?Qe.active:""}`,onClick:()=>a("landscape"),title:"가로 방향",children:c.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("rect",{x:"4",y:"7",width:"16",height:"10",rx:"2",stroke:"currentColor",strokeWidth:"2"}),c.jsx("circle",{cx:"20.5",cy:"12",r:"1",fill:"currentColor",opacity:"0.5"})]})}),c.jsx("button",{className:`${Qe.orientButton} ${o==="portrait"?Qe.active:""}`,onClick:()=>a("portrait"),title:"세로 방향",children:c.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("rect",{x:"7",y:"4",width:"10",height:"16",rx:"2",stroke:"currentColor",strokeWidth:"2"}),c.jsx("circle",{cx:"12",cy:"20.5",r:"1",fill:"currentColor",opacity:"0.5"})]})})]}),c.jsx("button",{className:Qe.actionButton,onClick:()=>setShowCanvasEditor(!0),title:"캔버스 에디터",children:c.jsx(Nve,{size:20})}),c.jsx("button",{className:Qe.actionButton,onClick:()=>Me(!0),title:"설정",children:c.jsx(J5,{size:20})}),c.jsxs("div",{className:Qe.exportButtonWrapper,children:[c.jsx("button",{onClick:()=>_t(!rt),className:Qe.generateButton,disabled:l,children:l?"내보내는 중...":c.jsxs(c.Fragment,{children:[c.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginRight:"6px"},children:[c.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),c.jsx("polyline",{points:"7 10 12 15 17 10"}),c.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),"내보내기"]})}),rt&&c.jsxs("div",{className:Qe.exportPopup,children:[c.jsxs("div",{className:Qe.exportPopupHeader,children:[c.jsx("h4",{children:"파일 형식 선택"}),c.jsx("button",{className:Qe.exportPopupClose,onClick:()=>_t(!1),children:"×"})]}),c.jsxs("div",{className:Qe.exportFormatList,children:[c.jsxs("div",{className:`${Qe.exportFormatItem} ${Ee==="pdf"?Qe.selected:""}`,onClick:()=>Le("pdf"),children:[c.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("polyline",{points:"14 2 14 8 20 8",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("path",{d:"M10 12v4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),c.jsx("path",{d:"M10 12h2.5c.8 0 1.5.7 1.5 1.5S13.3 15 12.5 15H10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),c.jsx("span",{children:"PDF 문서"}),c.jsx("small",{children:"벡터 형식, 인쇄 품질"})]}),c.jsxs("div",{className:`${Qe.exportFormatItem} ${Ee==="png"?Qe.selected:""}`,onClick:()=>Le("png"),children:[c.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2",stroke:"currentColor",strokeWidth:"2"}),c.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5",fill:"currentColor"}),c.jsx("polyline",{points:"21 15 16 10 5 21",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),c.jsx("span",{children:"PNG 이미지"}),c.jsx("small",{children:"투명 배경 지원"})]}),c.jsxs("div",{className:`${Qe.exportFormatItem} ${Ee==="jpg"?Qe.selected:""}`,onClick:()=>Le("jpg"),children:[c.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2",stroke:"currentColor",strokeWidth:"2"}),c.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5",fill:"currentColor"}),c.jsx("polyline",{points:"21 15 16 10 5 21",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),c.jsx("span",{children:"JPG 이미지"}),c.jsx("small",{children:"작은 파일 크기"})]}),c.jsxs("div",{className:`${Qe.exportFormatItem} ${Ee==="dxf"?Qe.selected:""}`,onClick:()=>Le("dxf"),children:[c.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("path",{d:"M22 10v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-8",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("path",{d:"M2 10h20",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("path",{d:"M12 4v16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("path",{d:"M7 10V4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("path",{d:"M17 10V4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),c.jsx("span",{children:"DXF 파일"}),c.jsx("small",{children:"CAD 프로그램용"})]})]}),c.jsxs("div",{className:Qe.exportPopupFooter,children:[c.jsx("button",{className:Qe.exportButton,onClick:()=>{_t(!1),Ee==="pdf"?io():alert(`${Ee.toUpperCase()} 형식 내보내기는 준비 중입니다.`)},children:"내보내기"}),c.jsx("button",{className:Qe.cancelButton,onClick:()=>_t(!1),children:"취소"})]})]})]}),c.jsx("button",{onClick:e,className:Qe.closeButton,children:"나가기"})]})]}),c.jsxs("div",{className:Qe.bottomContainer,children:[c.jsxs("div",{className:Qe.sidebar,children:[c.jsxs("div",{className:Qe.tabButtons,children:[c.jsxs("button",{className:`${Qe.tabButton} ${Be==="views"?Qe.active:""}`,onClick:()=>it("views"),title:"레이아웃",children:[c.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",stroke:"currentColor",strokeWidth:"1.5"}),c.jsx("rect",{x:"8",y:"8",width:"4",height:"4",rx:"1",fill:"currentColor"}),c.jsx("rect",{x:"8",y:"14",width:"8",height:"2",rx:"1",fill:"currentColor"})]}),c.jsx("span",{className:Qe.tabLabel,children:"레이아웃"})]}),c.jsxs("button",{className:`${Qe.tabButton} ${Be==="elements"?Qe.active:""}`,onClick:()=>it("elements"),title:"요소",children:[c.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("circle",{cx:"9",cy:"9",r:"5",stroke:"currentColor",strokeWidth:"1.5"}),c.jsx("rect",{x:"12",y:"12",width:"8",height:"8",stroke:"currentColor",strokeWidth:"1.5"})]}),c.jsx("span",{className:Qe.tabLabel,children:"요소"})]}),c.jsxs("button",{className:`${Qe.tabButton} ${Be==="text"?Qe.active:""}`,onClick:()=>it("text"),title:"텍스트",children:[c.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:c.jsx("path",{d:"M4 7V4h16v3M12 4v16m-2 0h4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),c.jsx("span",{className:Qe.tabLabel,children:"텍스트"})]}),c.jsxs("button",{className:`${Qe.tabButton} ${Be==="upload"?Qe.active:""}`,onClick:()=>it("upload"),title:"업로드",children:[c.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("polyline",{points:"17 8 12 3 7 8",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),c.jsx("span",{className:Qe.tabLabel,children:"업로드"})]})]}),c.jsxs("div",{className:Qe.tabContent,children:[Be==="views"&&c.jsxs(c.Fragment,{children:[c.jsx("h3",{className:Qe.menuTitle,children:"레이아웃"}),c.jsxs("div",{className:Qe.subTabContainer,children:[c.jsx("button",{className:`${Qe.subTab} ${nt==="template"?Qe.active:""}`,onClick:()=>st("template"),children:"템플릿"}),c.jsx("button",{className:`${Qe.subTab} ${nt==="2d"?Qe.active:""}`,onClick:()=>st("2d"),children:"2D"}),c.jsx("button",{className:`${Qe.subTab} ${nt==="3d"?Qe.active:""}`,onClick:()=>st("3d"),children:"3D"})]}),nt==="template"&&c.jsx("div",{className:Qe.templateContent,children:c.jsx("p",{className:Qe.placeholderText,children:"템플릿 옵션이 여기에 표시됩니다."})}),nt==="2d"&&c.jsx("div",{className:Qe.viewGrid,children:V7.map(ve=>c.jsxs("div",{className:Qe.viewMenuItem,onMouseDown:Re=>Ve(ve,Re),children:[c.jsx("div",{className:Qe.viewItemContent,children:t[ve.id]?c.jsx("img",{src:t[ve.id],alt:ve.label,draggable:!1}):c.jsx("div",{className:Qe.viewItemPlaceholder,children:ve.label})}),c.jsx("span",{className:Qe.viewItemLabel,children:ve.label})]},ve.id))}),nt==="3d"&&c.jsx("div",{className:Qe.view3dContent,children:c.jsx("p",{className:Qe.placeholderText,children:"3D 뷰 옵션이 여기에 표시됩니다."})})]}),Be==="elements"&&c.jsxs(c.Fragment,{children:[c.jsx("h3",{className:Qe.menuTitle,children:"요소"}),c.jsxs("div",{className:Qe.subTabScrollContainer,children:[c.jsx("button",{className:`${Qe.scrollButton} ${Qe.left} ${Zt.canScrollLeft?"":Qe.disabled}`,onClick:()=>Bt("left"),children:"‹"}),c.jsxs("div",{className:Qe.subTabWrapper,ref:Jt,children:[c.jsx("button",{className:`${Qe.subTab} ${At==="shapes"?Qe.active:""}`,onClick:()=>ft("shapes"),children:"도형"}),c.jsx("button",{className:`${Qe.subTab} ${At==="lines"?Qe.active:""}`,onClick:()=>ft("lines"),children:"선"}),c.jsx("button",{className:`${Qe.subTab} ${At==="symbols"?Qe.active:""}`,onClick:()=>ft("symbols"),children:"기호"}),c.jsx("button",{className:`${Qe.subTab} ${At==="balloons"?Qe.active:""}`,onClick:()=>ft("balloons"),children:"말풍선"}),c.jsx("button",{className:`${Qe.subTab} ${At==="frames"?Qe.active:""}`,onClick:()=>ft("frames"),children:"프레임"})]}),c.jsx("button",{className:`${Qe.scrollButton} ${Qe.right} ${Zt.canScrollRight?"":Qe.disabled}`,onClick:()=>Bt("right"),children:"›"})]}),At==="shapes"&&c.jsxs("div",{className:Qe.shapeGrid,children:[c.jsx("div",{className:Qe.shapeItem,onClick:()=>on('<rect x="2" y="2" width="20" height="20" fill="currentColor" />',"rectangle"),onMouseDown:ve=>{ve.preventDefault();const Re=ve.currentTarget.getBoundingClientRect();x({type:"shape",label:"Rectangle",shapeData:'<rect x="2" y="2" width="20" height="20" fill="currentColor" />',shapeType:"rectangle"}),m(!0),p({x:ve.clientX-Re.left,y:ve.clientY-Re.top}),C({x:ve.clientX-100,y:ve.clientY-75})},draggable:!1,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("rect",{x:"2",y:"2",width:"20",height:"20",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,onClick:()=>on('<rect x="2" y="2" width="20" height="20" rx="4" fill="currentColor" />',"rounded-rectangle"),onMouseDown:ve=>{ve.preventDefault();const Re=ve.currentTarget.getBoundingClientRect();x({type:"shape",label:"Rounded Rectangle",shapeData:'<rect x="2" y="2" width="20" height="20" rx="4" fill="currentColor" />',shapeType:"rounded-rectangle"}),m(!0),p({x:ve.clientX-Re.left,y:ve.clientY-Re.top}),C({x:ve.clientX-100,y:ve.clientY-75})},draggable:!1,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"4",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,onClick:()=>on('<circle cx="12" cy="12" r="10" fill="currentColor" />',"circle"),onMouseDown:ve=>{ve.preventDefault();const Re=ve.currentTarget.getBoundingClientRect();x({type:"shape",label:"Circle",shapeData:'<circle cx="12" cy="12" r="10" fill="currentColor" />',shapeType:"circle"}),m(!0),p({x:ve.clientX-Re.left,y:ve.clientY-Re.top}),C({x:ve.clientX-100,y:ve.clientY-75})},draggable:!1,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,onClick:()=>on('<ellipse cx="12" cy="12" rx="10" ry="6" fill="currentColor" />',"ellipse"),onMouseDown:ve=>{ve.preventDefault();const Re=ve.currentTarget.getBoundingClientRect();x({type:"shape",label:"Ellipse",shapeData:'<ellipse cx="12" cy="12" rx="10" ry="6" fill="currentColor" />',shapeType:"ellipse"}),m(!0),p({x:ve.clientX-Re.left,y:ve.clientY-Re.top}),C({x:ve.clientX-100,y:ve.clientY-75})},draggable:!1,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("ellipse",{cx:"12",cy:"12",rx:"10",ry:"6",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,onClick:()=>on('<polygon points="12,2 22,20 2,20" fill="currentColor" />',"triangle"),onMouseDown:ve=>{ve.preventDefault();const Re=ve.currentTarget.getBoundingClientRect();x({type:"shape",label:"Triangle",shapeData:'<polygon points="12,2 22,20 2,20" fill="currentColor" />',shapeType:"triangle"}),m(!0),p({x:ve.clientX-Re.left,y:ve.clientY-Re.top}),C({x:ve.clientX-100,y:ve.clientY-75})},draggable:!1,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("polygon",{points:"12,2 22,20 2,20",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,onClick:()=>on('<polygon points="2,12 8,6 22,6 22,18 8,18" fill="currentColor" />',"pentagon"),onMouseDown:ve=>{ve.preventDefault();const Re=ve.currentTarget.getBoundingClientRect();x({type:"shape",label:"Pentagon",shapeData:'<polygon points="2,12 8,6 22,6 22,18 8,18" fill="currentColor" />',shapeType:"pentagon"}),m(!0),p({x:ve.clientX-Re.left,y:ve.clientY-Re.top}),C({x:ve.clientX-100,y:ve.clientY-75})},draggable:!1,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("polygon",{points:"2,12 8,6 22,6 22,18 8,18",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,onClick:()=>on('<polygon points="2,12 8,6 16,6 22,12 16,18 8,18" fill="currentColor" />',"hexagon"),onMouseDown:ve=>{ve.preventDefault();const Re=ve.currentTarget.getBoundingClientRect();x({type:"shape",label:"Hexagon",shapeData:'<polygon points="2,12 8,6 16,6 22,12 16,18 8,18" fill="currentColor" />',shapeType:"hexagon"}),m(!0),p({x:ve.clientX-Re.left,y:ve.clientY-Re.top}),C({x:ve.clientX-100,y:ve.clientY-75})},draggable:!1,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("polygon",{points:"2,12 8,6 16,6 22,12 16,18 8,18",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("path",{d:"M12,3 Q7,3 7,8 Q7,10 9,10 Q9,8 11,8 Q11,10 12,10 Q13,10 15,10 Q17,10 17,8 Q17,3 12,3 Q17,3 17,8 Q17,13 12,13 Q7,13 7,8",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("path",{d:"M12,2 A10,10 0 0,1 12,22 A10,10 0 0,1 12,2",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,onClick:()=>on('<polygon points="12,2 15,9 22,9 17,14 19,21 12,17 5,21 7,14 2,9 9,9" fill="currentColor" />',"star"),onMouseDown:ve=>{ve.preventDefault();const Re=ve.currentTarget.getBoundingClientRect();x({type:"shape",label:"Star",shapeData:'<polygon points="12,2 15,9 22,9 17,14 19,21 12,17 5,21 7,14 2,9 9,9" fill="currentColor" />',shapeType:"star"}),m(!0),p({x:ve.clientX-Re.left,y:ve.clientY-Re.top}),C({x:ve.clientX-100,y:ve.clientY-75})},draggable:!1,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("polygon",{points:"12,2 15,9 22,9 17,14 19,21 12,17 5,21 7,14 2,9 9,9",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsxs("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:[c.jsx("ellipse",{cx:"12",cy:"14",rx:"8",ry:"6",fill:"currentColor"}),c.jsx("polygon",{points:"8,18 8,22 10,20",fill:"currentColor"})]})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("path",{d:"M12,4 C7,4 3,8 3,12 C3,16 7,20 12,20 C17,20 21,16 21,12 C21,8 17,4 12,4",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("polygon",{points:"2,12 9,6 22,10 15,16",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("polygon",{points:"12,2 14,10 22,10 16,14 18,22 12,18 6,22 8,14 2,10 10,10",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("polygon",{points:"4,4 20,4 16,20 8,20",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("path",{d:"M6,4 L18,4 Q22,4 22,8 L22,16 Q22,20 18,20 L6,20 Q2,20 2,16 L2,8 Q2,4 6,4",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("polygon",{points:"4,6 20,6 16,18 8,18",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("polygon",{points:"12,2 15,7 20,7 16,11 18,16 12,13 6,16 8,11 4,7 9,7",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("polygon",{points:"12,2 12,22 2,17 22,17",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("polygon",{points:"3,3 21,3 17,12 21,21 3,21 7,12",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("polygon",{points:"2,22 12,2 22,22",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("polygon",{points:"6,2 18,2 22,12 18,22 6,22 2,12",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("rect",{x:"4",y:"4",width:"16",height:"16",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsxs("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:[c.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",fill:"currentColor"}),c.jsx("rect",{x:"8",y:"18",width:"8",height:"4",fill:"currentColor"})]})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("polygon",{points:"12,2 16,8 22,8 18,13 20,20 12,16 4,20 6,13 2,8 8,8",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsxs("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:[c.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"currentColor"}),c.jsx("circle",{cx:"12",cy:"12",r:"6",fill:"white"}),c.jsx("circle",{cx:"12",cy:"12",r:"3",fill:"currentColor"})]})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("polygon",{points:"3,3 9,3 12,6 15,3 21,3 21,9 18,12 21,15 21,21 15,21 12,18 9,21 3,21 3,15 6,12 3,9",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsxs("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:[c.jsx("rect",{x:"10",y:"2",width:"4",height:"20",fill:"currentColor"}),c.jsx("rect",{x:"2",y:"10",width:"20",height:"4",fill:"currentColor"})]})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("polygon",{points:"12,2 17,7 22,12 17,17 12,22 7,17 2,12 7,7",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("polygon",{points:"5,3 19,3 21,12 19,21 5,21 3,12",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("polygon",{points:"2,3 8,3 12,7 16,3 22,3 22,9 18,12 22,15 22,21 16,21 12,17 8,21 2,21 2,15 6,12 2,9",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("polygon",{points:"7,2 17,2 22,12 17,22 7,22 2,12",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsxs("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:[c.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"currentColor"}),c.jsx("path",{d:"M12,2 A10,10 0 0,1 12,22 Z",fill:"white",opacity:"0.3"})]})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("polygon",{points:"12,2 16,6 20,6 20,10 24,12 20,14 20,18 16,18 12,22 8,18 4,18 4,14 0,12 4,10 4,6 8,6",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("polygon",{points:"12,2 22,12 12,22 2,12",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("polygon",{points:"2,12 7,7 12,12 17,7 22,12 17,17 12,12 7,17",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("polygon",{points:"4,2 20,2 22,8 18,22 6,22 2,8",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("polygon",{points:"5,2 12,5 19,2 22,9 19,16 22,22 16,19 12,22 8,19 2,22 5,16 2,9",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsxs("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:[c.jsx("rect",{x:"3",y:"3",width:"18",height:"18",fill:"currentColor"}),c.jsx("rect",{x:"6",y:"6",width:"12",height:"12",fill:"white"}),c.jsx("rect",{x:"9",y:"9",width:"6",height:"6",fill:"currentColor"})]})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("polygon",{points:"12,2 14,9 22,8 17,14 20,21 12,18 4,21 7,14 2,8 10,9",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsxs("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:[c.jsx("polygon",{points:"12,2 16,8 22,12 16,16 12,22 8,16 2,12 8,8",fill:"currentColor"}),c.jsx("polygon",{points:"12,6 14,10 18,12 14,14 12,18 10,14 6,12 10,10",fill:"white"})]})}),c.jsx("div",{className:Qe.shapeItem,children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("polygon",{points:"3,2 21,2 18,12 21,22 3,22 6,12",fill:"currentColor"})})})]}),At==="lines"&&c.jsxs("div",{className:Qe.viewGrid,children:[c.jsx("div",{className:Qe.shapeItem,onClick:()=>ln("horizontal"),children:"━"}),c.jsx("div",{className:Qe.shapeItem,onClick:()=>ln("vertical"),children:"┃"}),c.jsx("div",{className:Qe.shapeItem,onClick:()=>ln("diagonal1"),children:"╱"}),c.jsx("div",{className:Qe.shapeItem,onClick:()=>ln("diagonal2"),children:"╲"})]}),At==="symbols"&&c.jsxs("div",{className:Qe.viewGrid,children:[c.jsx("div",{className:Qe.shapeItem,onClick:()=>Ii("★"),onMouseDown:ve=>{ve.preventDefault();const Re=ve.currentTarget.getBoundingClientRect();x({type:"symbol",label:"★",symbol:"★"}),m(!0),p({x:ve.clientX-Re.left,y:ve.clientY-Re.top}),C({x:ve.clientX-100,y:ve.clientY-75})},draggable:!1,children:"★"}),c.jsx("div",{className:Qe.shapeItem,onClick:()=>Ii("♥"),onMouseDown:ve=>{ve.preventDefault();const Re=ve.currentTarget.getBoundingClientRect();x({type:"symbol",label:"♥",symbol:"♥"}),m(!0),p({x:ve.clientX-Re.left,y:ve.clientY-Re.top}),C({x:ve.clientX-100,y:ve.clientY-75})},draggable:!1,children:"♥"}),c.jsx("div",{className:Qe.shapeItem,onClick:()=>Ii("♦"),onMouseDown:ve=>{ve.preventDefault();const Re=ve.currentTarget.getBoundingClientRect();x({type:"symbol",label:"♦",symbol:"♦"}),m(!0),p({x:ve.clientX-Re.left,y:ve.clientY-Re.top}),C({x:ve.clientX-100,y:ve.clientY-75})},draggable:!1,children:"♦"}),c.jsx("div",{className:Qe.shapeItem,onClick:()=>Ii("♣"),onMouseDown:ve=>{ve.preventDefault();const Re=ve.currentTarget.getBoundingClientRect();x({type:"symbol",label:"♣",symbol:"♣"}),m(!0),p({x:ve.clientX-Re.left,y:ve.clientY-Re.top}),C({x:ve.clientX-100,y:ve.clientY-75})},draggable:!1,children:"♣"})]}),At==="balloons"&&c.jsxs("div",{className:Qe.shapeGrid,children:[c.jsx("div",{className:Qe.shapeItem,onClick:()=>kr("left"),children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("path",{d:"M4,4 L20,4 Q22,4 22,6 L22,14 Q22,16 20,16 L8,16 L4,20 L4,16 Q2,16 2,14 L2,6 Q2,4 4,4",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,onClick:()=>kr("right"),children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("path",{d:"M4,4 L20,4 Q22,4 22,6 L22,14 Q22,16 20,16 L20,20 L16,16 L4,16 Q2,16 2,14 L2,6 Q2,4 4,4",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,onClick:()=>kr("top"),children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("path",{d:"M4,8 L20,8 Q22,8 22,10 L22,18 Q22,20 20,20 L4,20 Q2,20 2,18 L2,10 Q2,8 4,8 M12,8 L8,4 L16,4 Z",fill:"currentColor"})})}),c.jsx("div",{className:Qe.shapeItem,onClick:()=>kr("bottom"),children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("path",{d:"M4,4 L20,4 Q22,4 22,6 L22,14 Q22,16 20,16 L4,16 Q2,16 2,14 L2,6 Q2,4 4,4 M12,16 L8,20 L16,20 Z",fill:"currentColor"})})})]}),At==="frames"&&c.jsxs("div",{className:Qe.shapeGrid,children:[c.jsx("div",{className:Qe.shapeItem,onClick:()=>zr("simple"),children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("rect",{x:"2",y:"2",width:"20",height:"20",fill:"none",stroke:"currentColor",strokeWidth:"2"})})}),c.jsx("div",{className:Qe.shapeItem,onClick:()=>zr("double"),children:c.jsxs("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:[c.jsx("rect",{x:"2",y:"2",width:"20",height:"20",fill:"none",stroke:"currentColor",strokeWidth:"1"}),c.jsx("rect",{x:"4",y:"4",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"1"})]})}),c.jsx("div",{className:Qe.shapeItem,onClick:()=>zr("dashed"),children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("rect",{x:"2",y:"2",width:"20",height:"20",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"4 2"})})}),c.jsx("div",{className:Qe.shapeItem,onClick:()=>zr("rounded"),children:c.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:c.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"4",fill:"none",stroke:"currentColor",strokeWidth:"2"})})})]})]}),Be==="text"&&c.jsxs(c.Fragment,{children:[c.jsx("h3",{className:Qe.menuTitle,children:"텍스트"}),c.jsxs("div",{className:Qe.viewGrid,children:[c.jsxs("div",{className:Qe.viewMenuItem,onClick:hi,style:{cursor:"pointer"},children:[c.jsx("div",{className:Qe.viewItemContent,children:c.jsx("div",{className:Qe.viewItemPlaceholder,children:"T"})}),c.jsx("span",{className:Qe.viewItemLabel,children:"텍스트 추가"})]}),DT.map(ve=>c.jsxs("div",{className:Qe.viewMenuItem,onMouseDown:Re=>Ve(ve,Re),children:[c.jsx("div",{className:Qe.viewItemContent,children:c.jsx("div",{className:Qe.viewItemPlaceholder,children:ve.label})}),c.jsx("span",{className:Qe.viewItemLabel,children:ve.label})]},ve.id))]})]}),Be==="upload"&&c.jsxs(c.Fragment,{children:[c.jsx("h3",{className:Qe.menuTitle,children:"업로드"}),c.jsxs("div",{className:Qe.uploadContent,children:[c.jsxs("div",{className:Qe.uploadArea,children:[c.jsx("input",{type:"file",id:"uploadInput",accept:"image/*,.pdf,.dxf",style:{display:"none"},onChange:async ve=>{var Ke;const Re=(Ke=ve.target.files)==null?void 0:Ke[0];if(Re){const Ge=Re.name.toLowerCase(),pt=`file_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,Pt=async pe=>new Promise(xe=>{if(pe.type.startsWith("image/")){const at=new FileReader;at.onload=dt=>{var wn;const Qt=new Image;Qt.onload=()=>{const gt=document.createElement("canvas"),Vn=gt.getContext("2d"),Yn=100,ht=Math.min(Yn/Qt.width,Yn/Qt.height);gt.width=Qt.width*ht,gt.height=Qt.height*ht,Vn==null||Vn.drawImage(Qt,0,0,gt.width,gt.height),xe(gt.toDataURL("image/jpeg",.7))},Qt.src=(wn=dt.target)==null?void 0:wn.result},at.readAsDataURL(pe)}else xe(void 0)});if(Ge.endsWith(".dxf")){const pe=new FileReader;pe.onload=async xe=>{var Qt;const at=(Qt=xe.target)==null?void 0:Qt.result,dt={id:pt,name:Re.name,type:"dxf",url:at,uploadDate:new Date};qe(wn=>[...wn,dt]),await li(Re)},pe.readAsDataURL(Re)}else if(Ge.endsWith(".pdf")){const pe=new FileReader;pe.onload=xe=>{var Qt;const at=(Qt=xe.target)==null?void 0:Qt.result,dt={id:pt,name:Re.name,type:"pdf",url:at,uploadDate:new Date};qe(wn=>[...wn,dt]),console.log("PDF 파일 추가됨:",Re.name)},pe.readAsDataURL(Re)}else{const pe=new FileReader;pe.onload=async xe=>{var at;if(vt.current&&((at=xe.target)!=null&&at.result)){const dt=xe.target.result,Qt=await Pt(Re),wn={id:pt,name:Re.name,type:"image",thumbnail:Qt,url:dt,uploadDate:new Date};qe(gt=>[...gt,wn]),console.log("✅ 이미지가 업로드됨. 드래그해서 배치하세요.")}},pe.readAsDataURL(Re)}}ve.target.value=""}}),c.jsxs("label",{htmlFor:"uploadInput",className:Qe.uploadButton,children:[c.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[c.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),c.jsx("polyline",{points:"17 8 12 3 7 8"}),c.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),c.jsx("span",{children:"파일 선택"}),c.jsx("small",{children:"이미지, PDF, DXF 파일 지원"})]})]}),De.length>0&&c.jsxs("div",{className:Qe.uploadedFilesList,children:[c.jsx("h4",{className:Qe.uploadedFilesTitle,children:"업로드된 파일"}),c.jsx("div",{className:Qe.filesGrid,children:De.map(ve=>c.jsxs("div",{className:Qe.fileItem,onMouseDown:Re=>{Re.preventDefault(),m(!0);const Ke={id:ve.id,type:"uploaded-file",label:ve.name,uploadedFile:ve};x(Ke);const Ge=(ve.type==="image",75),pt=75;p({x:Ge,y:pt}),C({x:Re.clientX-Ge,y:Re.clientY-pt})},style:{cursor:"grab"},children:[c.jsx("div",{className:Qe.fileThumbnail,children:ve.thumbnail?c.jsx("img",{src:ve.thumbnail,alt:ve.name,draggable:!1}):c.jsx("div",{className:Qe.fileIcon,children:ve.type==="pdf"?c.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[c.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),c.jsx("polyline",{points:"14 2 14 8 20 8"}),c.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),c.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),c.jsx("polyline",{points:"10 9 9 9 8 9"})]}):ve.type==="dxf"?c.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[c.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),c.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),c.jsx("line",{x1:"9",y1:"21",x2:"9",y2:"9"})]}):c.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[c.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),c.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),c.jsx("polyline",{points:"21 15 16 10 5 21"})]})})}),c.jsx("div",{className:Qe.fileName,title:ve.name,children:ve.name.length>15?`${ve.name.substring(0,12)}...`:ve.name}),c.jsxs("div",{className:Qe.fileActions,children:[c.jsx("div",{style:{fontSize:"11px",color:"#666"},children:"드래그해서 배치"}),c.jsx("button",{className:Qe.fileActionBtn,onClick:()=>{qe(Re=>Re.filter(Ke=>Ke.id!==ve.id))},title:"삭제",children:c.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[c.jsx("polyline",{points:"3 6 5 6 21 6"}),c.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]},ve.id))})]})]})]})]})]}),c.jsx("div",{className:Qe.mainContainer,children:c.jsx("div",{className:Qe.contentWrapper,children:c.jsx("div",{className:Qe.previewContainer,children:c.jsxs("div",{className:Qe.rulerWrapper,style:{transform:`scale(${wi})`,transformOrigin:"center center"},children:[c.jsx("div",{className:Qe.rulerCorner,children:c.jsx("span",{style:{fontSize:"8px",color:"var(--theme-text)",opacity:.6},children:"mm"})}),c.jsx("div",{className:Qe.rulerHorizontal,onMouseDown:ve=>{const Re=ve.currentTarget.getBoundingClientRect(),Ke=(ve.clientX-Re.left)/wi;se({type:"vertical",position:Ke})},style:{cursor:"ns-resize",width:vn.displayWidth},children:c.jsx("svg",{width:vn.displayWidth,height:"20",style:{display:"block"},children:Array.from({length:Math.ceil(vn.width/5)+1},(ve,Re)=>{const Ke=Re*5;if(Ke>vn.width)return null;const Ge=Ke*2,pt=Ke%50===0,Pt=Ke%10===0;return c.jsxs("g",{children:[c.jsx("line",{x1:Ge,y1:pt?12:Pt?16:18,x2:Ge,y2:20,stroke:"var(--theme-text)",strokeWidth:pt?1.5:Pt?.8:.3,opacity:pt?1:Pt?.6:.3}),pt&&c.jsx("text",{x:Ge,y:10,fontSize:"9",fill:"var(--theme-text)",textAnchor:"middle",style:{userSelect:"none"},children:Ke})]},Re)})})}),c.jsx("div",{className:Qe.rulerVertical,onMouseDown:ve=>{const Re=ve.currentTarget.getBoundingClientRect(),Ke=(ve.clientY-Re.top)/wi;se({type:"horizontal",position:Ke})},style:{cursor:"ew-resize",height:vn.displayHeight},children:c.jsx("svg",{width:"20",height:vn.displayHeight,style:{display:"block"},children:Array.from({length:Math.ceil(vn.height/5)+1},(ve,Re)=>{const Ke=Re*5;if(Ke>vn.height)return null;const Ge=Ke*2,pt=Ke%50===0,Pt=Ke%10===0;return c.jsxs("g",{children:[c.jsx("line",{x1:pt?12:Pt?16:18,y1:Ge,x2:20,y2:Ge,stroke:"var(--theme-text)",strokeWidth:pt?1.5:Pt?.8:.3,opacity:pt?1:Pt?.6:.3}),pt&&Ke>0&&c.jsx("text",{x:10,y:Ge,fontSize:"9",fill:"var(--theme-text)",textAnchor:"middle",dominantBaseline:"middle",transform:`rotate(-90 10 ${Ge})`,style:{userSelect:"none"},children:Ke})]},Re)})})}),c.jsx("div",{ref:Tr,className:Qe.previewContent,style:{width:`${vn.displayWidth}px`,height:`${vn.displayHeight}px`,backgroundColor:u},children:c.jsx("div",{className:Qe.drawingArea,ref:xr,onClick:ve=>{ve.target===ve.currentTarget&&(I(null),Us())},style:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center"},children:c.jsxs("div",{onClick:ve=>{ve.stopPropagation(),I(null),Us()},style:{position:"relative",width:vn.displayWidth,height:vn.displayHeight,backgroundColor:u,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",overflow:"visible",transformOrigin:"center"},children:[c.jsx("div",{ref:Ye,className:Qe.canvasContainer,"data-portrait":o==="portrait",style:{position:"absolute",top:0,left:0,width:vn.displayWidth,height:vn.displayHeight,zIndex:1,pointerEvents:"auto"}}),z.vertical.map((ve,Re)=>c.jsx("div",{className:Qe.alignmentGuideVertical,style:{left:`${ve}px`}},`v-${Re}`)),z.horizontal.map((ve,Re)=>c.jsx("div",{className:Qe.alignmentGuideHorizontal,style:{top:`${ve}px`}},`h-${Re}`)),K.vertical.map((ve,Re)=>c.jsx("div",{style:{position:"absolute",left:`${ve}px`,top:0,width:"1px",height:"100%",backgroundColor:"#00BFFF",opacity:.8,cursor:"ew-resize",zIndex:9},onMouseDown:Ke=>{Ke.preventDefault(),X({type:"vertical",index:Re})},onDoubleClick:()=>{V(Ke=>({...Ke,vertical:Ke.vertical.filter((Ge,pt)=>pt!==Re)}))}},`guide-v-${Re}`)),K.horizontal.map((ve,Re)=>c.jsx("div",{style:{position:"absolute",left:0,top:`${ve}px`,width:"100%",height:"1px",backgroundColor:"#00BFFF",opacity:.8,cursor:"ns-resize",zIndex:9},onMouseDown:Ke=>{Ke.preventDefault(),X({type:"horizontal",index:Re})},onDoubleClick:()=>{V(Ke=>({...Ke,horizontal:Ke.horizontal.filter((Ge,pt)=>pt!==Re)}))}},`guide-h-${Re}`)),g.length>0&&g.map(ve=>{var Pt;const Re=ve.id.split("_")[0],Ke=V7.find(pe=>pe.id===Re),Ge=t[Re],pt=DT.some(pe=>pe.id===Re);return console.log("🎨 뷰카드 렌더링:",{view:ve,viewType:Re,capturedImage:Ge,isTextItem:pt,type:ve.type,imageUrl:(Pt=ve.imageUrl)==null?void 0:Pt.substring(0,100)}),c.jsxs("div",{style:{position:"absolute",left:ve.x,top:ve.y,width:ve.width*ve.scale,height:ve.height*ve.scale,backgroundColor:Ge?"white":"#f5f5f5",border:S===ve.id?"2px solid #7c3aed":"1px solid #ccc",borderRadius:"4px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",zIndex:10,cursor:"move",overflow:"visible",transform:`rotate(${ve.rotation||0}deg)`,transformOrigin:"center"},onMouseDown:pe=>{pe.stopPropagation(),ct(ve.id,pe)},onClick:pe=>{pe.stopPropagation()},onDoubleClick:()=>!pt&&mt(ve.id,Re),onWheel:pe=>{if(S===ve.id){pe.preventDefault(),pe.stopPropagation();const xe=pe.deltaY>0?-.1:.1;nn(ve.id,xe)}},children:[S===ve.id&&c.jsxs(c.Fragment,{children:[console.log("🔧 리사이즈 핸들 렌더링:",ve.id,ve.type),console.log("🔄 회전 핸들 표시 여부:",S===ve.id),c.jsx("div",{className:Qe.rotateHandle,onMouseDown:pe=>Jn(ve.id,pe),title:"회전 (Shift: 15도 단위)",style:{position:"absolute",top:"-40px",left:"50%",transform:"translateX(-50%)",width:"28px",height:"28px",background:"#7c3aed",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",cursor:"grab",zIndex:100,boxShadow:"0 2px 6px rgba(0, 0, 0, 0.3)"},children:c.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:[c.jsx("path",{d:"M23 4v6h-6"}),c.jsx("path",{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"})]})}),c.jsx("div",{className:`${Qe.resizeHandle} ${Qe.nw}`,onMouseDown:pe=>gn(ve.id,"nw",pe)}),c.jsx("div",{className:`${Qe.resizeHandle} ${Qe.n}`,onMouseDown:pe=>gn(ve.id,"n",pe)}),c.jsx("div",{className:`${Qe.resizeHandle} ${Qe.ne}`,onMouseDown:pe=>gn(ve.id,"ne",pe)}),c.jsx("div",{className:`${Qe.resizeHandle} ${Qe.w}`,onMouseDown:pe=>gn(ve.id,"w",pe)}),c.jsx("div",{className:`${Qe.resizeHandle} ${Qe.e}`,onMouseDown:pe=>gn(ve.id,"e",pe)}),c.jsx("div",{className:`${Qe.resizeHandle} ${Qe.sw}`,onMouseDown:pe=>gn(ve.id,"sw",pe)}),c.jsx("div",{className:`${Qe.resizeHandle} ${Qe.s}`,onMouseDown:pe=>gn(ve.id,"s",pe)}),c.jsx("div",{className:`${Qe.resizeHandle} ${Qe.se}`,onMouseDown:pe=>gn(ve.id,"se",pe)})]}),pt?c.jsxs("div",{className:Qe.textItemContent,children:[Re==="info"&&c.jsxs("div",{className:Qe.infoContent,children:[c.jsx("h3",{className:Qe.infoTitle,children:"INSHOW"}),_e===`${ve.id}_title`?c.jsx("input",{type:"text",value:si.title,onChange:pe=>Li({...si,title:pe.target.value}),onBlur:()=>ue(null),onKeyDown:pe=>pe.key==="Enter"&&ue(null),className:Qe.textInput,autoFocus:!0}):c.jsx("p",{onClick:()=>ue(`${ve.id}_title`),children:si.title}),c.jsxs("div",{className:Qe.infoSpecs,children:[c.jsxs("div",{className:Qe.infoSpecItem,children:[c.jsx("span",{children:"Size:"}),_e===`${ve.id}_size`?c.jsx("input",{type:"text",value:si.size,onChange:pe=>Li({...si,size:pe.target.value}),onBlur:()=>ue(null),onKeyDown:pe=>pe.key==="Enter"&&ue(null),className:Qe.textInput,autoFocus:!0}):c.jsx("span",{onClick:()=>ue(`${ve.id}_size`),children:si.size})]}),c.jsxs("div",{className:Qe.infoSpecItem,children:[c.jsx("span",{children:"Door:"}),_e===`${ve.id}_door`?c.jsx("input",{type:"text",value:si.door,onChange:pe=>Li({...si,door:pe.target.value}),onBlur:()=>ue(null),onKeyDown:pe=>pe.key==="Enter"&&ue(null),className:Qe.textInput,autoFocus:!0}):c.jsx("span",{onClick:()=>ue(`${ve.id}_door`),children:si.door})]}),c.jsxs("div",{className:Qe.infoSpecItem,children:[c.jsx("span",{children:"Body:"}),_e===`${ve.id}_body`?c.jsx("input",{type:"text",value:si.body,onChange:pe=>Li({...si,body:pe.target.value}),onBlur:()=>ue(null),onKeyDown:pe=>pe.key==="Enter"&&ue(null),className:Qe.textInput,autoFocus:!0}):c.jsx("span",{onClick:()=>ue(`${ve.id}_body`),children:si.body})]})]})]}),Re==="title"&&c.jsx("div",{className:Qe.titleContent,children:_e===ve.id?c.jsx("input",{type:"text",value:si.title,onChange:pe=>Li({...si,title:pe.target.value}),onBlur:()=>ue(null),onKeyDown:pe=>pe.key==="Enter"&&ue(null),className:Qe.textInput,autoFocus:!0}):c.jsx("h2",{onClick:()=>ue(ve.id),children:si.title})}),Re==="specs"&&c.jsxs("div",{className:Qe.specsContent,children:[c.jsx("h3",{children:"Specifications"}),c.jsxs("p",{children:["Size: ",si.size]}),c.jsxs("p",{children:["Door: ",si.door]}),c.jsxs("p",{children:["Body: ",si.body]})]}),Re==="notes"&&c.jsx("div",{className:Qe.notesContent,children:_e===ve.id?c.jsx("textarea",{value:si.notes||"",onChange:pe=>Li({...si,notes:pe.target.value}),onBlur:()=>ue(null),className:Qe.textAreaInput,placeholder:"메모를 입력하세요...",autoFocus:!0}):c.jsx("p",{onClick:()=>ue(ve.id),children:si.notes||"메모를 입력하세요..."})})]}):ve.type==="image"?c.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f9f9f9"},children:ve.imageUrl?c.jsx("img",{src:ve.imageUrl,alt:ve.fileName||"Image",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"},draggable:!1,onError:pe=>{console.error("이미지 로드 실패:",ve.imageUrl),console.log("뷰 정보:",ve)},onLoad:()=>{console.log("✅ 이미지 로드 성공:",ve.fileName)}}):c.jsx("div",{style:{color:"#999",fontSize:"14px"},children:"이미지 없음"})}):ve.type==="pdf"?c.jsx("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"#ffffff",overflow:"hidden"},children:ve.imageUrl&&ve.hasDrawingData?c.jsx("img",{src:ve.imageUrl,alt:ve.fileName||"Vector View",style:{width:"100%",height:"100%",objectFit:"contain",pointerEvents:"none"}}):c.jsxs(c.Fragment,{children:[c.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#666",strokeWidth:"1.5",children:[c.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),c.jsx("polyline",{points:"14 2 14 8 20 8"}),c.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),c.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),c.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"8px",textAlign:"center",padding:"0 8px"},children:ve.fileName})]})}):ve.type==="dxf"?c.jsxs("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"#e8f4fd"},children:[c.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#0066cc",strokeWidth:"1.5",children:[c.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),c.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),c.jsx("line",{x1:"9",y1:"21",x2:"9",y2:"9"})]}),c.jsx("div",{style:{fontSize:"12px",color:"#0066cc",marginTop:"8px",textAlign:"center",padding:"0 8px"},children:ve.fileName})]}):c.jsxs("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative"},children:[Ge?c.jsx("img",{src:Ge,alt:Ke==null?void 0:Ke.label,style:{width:"100%",height:"100%",objectFit:"contain",pointerEvents:"none"},draggable:!1}):c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"8px"},children:[c.jsx("div",{style:{fontSize:"24px",color:"#999"},children:Re==="front"?"👀":Re==="side"?"👁️":Re==="top"?"⬆️":Re==="iso"?"🔷":"📐"}),c.jsx("div",{style:{fontSize:"14px",fontWeight:"bold",color:"#666"},children:(Ke==null?void 0:Ke.label)||Re||"VIEW"})]}),Ge&&ve.hideTitle!==!0&&c.jsx("div",{style:{position:"absolute",top:"8px",left:"8px",fontSize:"12px",fontWeight:"bold",color:"#333",backgroundColor:"rgba(255,255,255,0.9)",padding:"4px 8px",borderRadius:"4px",boxShadow:"0 1px 2px rgba(0,0,0,0.1)"},children:(Ke==null?void 0:Ke.label)||Re||"VIEW"})]})]},ve.id)})]})})})]})})})}),c.jsx("div",{className:Qe.pagePreviewPanel,children:c.jsx("div",{className:Qe.pageListContainer,children:c.jsxs("div",{className:`${Qe.pageList} ${o==="portrait"?Qe.portraitList:""}`,children:[c.jsx("div",{className:`${Qe.pageItemWrapper} ${o==="portrait"?Qe.portrait:""}`,children:c.jsxs("div",{className:Qe.addPageCard,onClick:pn,title:"페이지 추가",children:[c.jsx("div",{className:Qe.addPageIcon,children:c.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("line",{x1:"12",y1:"6",x2:"12",y2:"18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),c.jsx("line",{x1:"6",y1:"12",x2:"18",y2:"12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})}),c.jsx("div",{className:Qe.addPageText,children:"페이지 추가"})]})}),fe.map((ve,Re)=>c.jsxs("div",{className:`${Qe.pageItemWrapper} ${o==="portrait"?Qe.portrait:""}`,children:[c.jsxs("div",{className:`${Qe.pageItem} ${Ce===Re?Qe.active:""}`,onClick:()=>Ln(Re),children:[c.jsx("div",{className:Qe.pageNumber,children:Re+1}),c.jsx("div",{className:Qe.pageThumbnail,children:Ce===Re&&vt.current?c.jsx("div",{style:{width:"100%",height:"100%",position:"relative",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:u},children:c.jsx("canvas",{ref:Ke=>{if(Ke&&vt.current){const Ge=Ke.getContext("2d");if(Ge){const pt=o==="portrait"?90:145,Pt=o==="portrait"?110:70,pe=vn.displayWidth/vn.displayHeight,xe=pt/Pt;let at,dt;pe>xe?(at=pt,dt=pt/pe):(dt=Pt,at=Pt*pe),Ke.width=at,Ke.height=dt,Ge.fillStyle=u,Ge.fillRect(0,0,Ke.width,Ke.height),setTimeout(()=>{if(vt.current){const Qt=at/vn.displayWidth,wn=vt.current.toDataURL({format:"png",multiplier:Qt}),gt=new Image;gt.onload=()=>{Ge.clearRect(0,0,Ke.width,Ke.height),Ge.fillStyle=u,Ge.fillRect(0,0,Ke.width,Ke.height),Ge.drawImage(gt,0,0,Ke.width,Ke.height)},gt.src=wn}},100)}}},style:{maxWidth:"100%",maxHeight:"100%",width:"auto",height:"auto"}},`thumbnail-${Re}-${Z}-${o}`)}):ve.length>0?c.jsx("div",{className:Qe.pagePreview,children:ve.slice(0,3).map((Ke,Ge)=>c.jsx("div",{className:Qe.miniView,style:{left:`${Ke.x/vn.displayWidth*100}%`,top:`${Ke.y/vn.displayHeight*100}%`,width:`${Ke.width/vn.displayWidth*100}%`,height:`${Ke.height/vn.displayHeight*100}%`}},Ge))}):c.jsx("div",{className:Qe.emptyPage,children:"빈 페이지"})})]}),fe.length>1&&c.jsx("button",{className:Qe.deletePageBtn,onClick:Ke=>{Ke.stopPropagation(),Dn(Re)},title:"페이지 삭제",children:"×"})]},Re))]})})})]})]}),w&&y&&j&&c.jsx("div",{style:{position:"fixed",left:`${j.x}px`,top:`${j.y}px`,width:y.type==="uploaded-file"?"150px":"200px",height:(y.type==="uploaded-file","150px"),border:`2px dashed ${$h()}`,backgroundColor:`${$h()}20`,pointerEvents:"none",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center",color:$h(),fontSize:"14px",borderRadius:"8px"},children:y.type==="uploaded-file"&&y.uploadedFile?y.uploadedFile.thumbnail?c.jsx("img",{src:y.uploadedFile.thumbnail,alt:y.uploadedFile.name,style:{width:"80%",height:"80%",objectFit:"contain",opacity:.8}}):c.jsxs("div",{style:{textAlign:"center"},children:[y.uploadedFile.type==="pdf"?c.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[c.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),c.jsx("polyline",{points:"14 2 14 8 20 8"})]}):y.uploadedFile.type==="dxf"?c.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[c.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),c.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),c.jsx("line",{x1:"9",y1:"21",x2:"9",y2:"9"})]}):null,c.jsx("div",{style:{marginTop:"8px",fontSize:"12px"},children:y.uploadedFile.name.length>15?`${y.uploadedFile.name.substring(0,12)}...`:y.uploadedFile.name})]}):y.label}),ie.isOpen&&c.jsx("div",{className:`${Qe.viewerOverlay} ${ui.mode==="dark"?Qe.darkTheme:Qe.lightTheme}`,children:c.jsxs("div",{className:Qe.viewerContainer,children:[c.jsxs("div",{className:Qe.viewerHeader,children:[c.jsxs("h3",{children:[i("export.drawingEditor")," - ",(Mn=ie.viewType)==null?void 0:Mn.toUpperCase()]}),c.jsx("button",{className:Qe.closeButton,onClick:()=>ee({isOpen:!1,viewId:null,viewType:null}),children:"✕"})]}),c.jsxs("div",{className:Qe.viewerSubHeader,children:[c.jsxs("div",{className:Qe.leftControls,children:[c.jsxs("div",{className:Qe.toggleGroup,children:[c.jsx("span",{className:`${Qe.toggleLabel} ${Qe.clickable}`,onClick:()=>{if(!jt.showDimensions){jt.setShowDimensions(!0),jt.showAll||jt.setShowAll(!0),jt.showDimensionsText||jt.setShowDimensionsText(!0),jt.showGuides||jt.setShowGuides(!0),jt.showAxis||jt.setShowAxis(!0);return}jt.showAll||jt.showDimensionsText||jt.showGuides||jt.showAxis?(jt.showAll&&jt.setShowAll(!1),jt.showDimensionsText&&jt.setShowDimensionsText(!1),jt.showGuides&&jt.setShowGuides(!1),jt.showAxis&&jt.setShowAxis(!1)):jt.setShowDimensions(!1)},style:{cursor:"pointer"},children:jt.showDimensions?"ON":"OFF"}),c.jsx("button",{className:`${Qe.switch} ${jt.showDimensions?Qe.on:Qe.off}`,onClick:()=>{jt.showDimensions?(jt.setShowDimensions(!1),jt.showAll&&jt.setShowAll(!1),jt.showDimensionsText&&jt.setShowDimensionsText(!1),jt.showGuides&&jt.setShowGuides(!1),jt.showAxis&&jt.setShowAxis(!1)):jt.setShowDimensions(!0)},children:c.jsx("div",{className:Qe.switchHandle})})]}),jt.showDimensions?c.jsxs("div",{className:Qe.checkboxGroup,children:[c.jsxs("label",{className:Qe.checkboxLabel,children:[c.jsx("input",{type:"checkbox",checked:jt.showDimensions&&jt.showAll,onChange:ve=>jt.setShowAll(ve.target.checked),className:Qe.checkbox}),c.jsx("span",{className:Qe.checkmark}),i("viewer.column")]}),c.jsxs("label",{className:Qe.checkboxLabel,children:[c.jsx("input",{type:"checkbox",checked:jt.showDimensions&&jt.showDimensionsText,onChange:ve=>jt.setShowDimensionsText(ve.target.checked),className:Qe.checkbox}),c.jsx("span",{className:Qe.checkmark}),i("viewer.dimensions")]}),c.jsxs("label",{className:Qe.checkboxLabel,children:[c.jsx("input",{type:"checkbox",checked:jt.showDimensions&&jt.showGuides,onChange:ve=>jt.setShowGuides(ve.target.checked),className:Qe.checkbox}),c.jsx("span",{className:Qe.checkmark}),i("viewer.grid")]}),c.jsxs("label",{className:Qe.checkboxLabel,children:[c.jsx("input",{type:"checkbox",checked:jt.showDimensions&&jt.showAxis,onChange:ve=>jt.setShowAxis(ve.target.checked),className:Qe.checkbox}),c.jsx("span",{className:Qe.checkmark}),i("viewer.axis")]})]}):null]}),c.jsxs("div",{className:Qe.centerControls,children:[c.jsxs("div",{className:Qe.renderModeGroup,children:[c.jsx("button",{className:`${Qe.renderModeButton} ${ri==="solid"?Qe.active:""}`,onClick:()=>bi("solid"),children:"Solid"}),c.jsx("button",{className:`${Qe.renderModeButton} ${ri==="wireframe"?Qe.active:""}`,onClick:()=>bi("wireframe"),children:"Wireframe"})]}),c.jsxs("div",{className:Qe.viewModeGroup,children:[c.jsx("button",{className:`${Qe.viewModeButton} ${fn==="3D"?Qe.active:""}`,onClick:()=>Hn("3D"),children:"3D"}),c.jsx("button",{className:`${Qe.viewModeButton} ${fn==="2D"?Qe.active:""}`,onClick:()=>Hn("2D"),children:"2D"})]})]}),c.jsx("div",{className:Qe.rightControls,children:fn==="2D"&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:Qe.viewDirectionGroup,children:["front","top","left","right"].map(ve=>c.jsx("button",{className:`${Qe.viewDirectionButton} ${Zn===ve?Qe.active:""}`,onClick:()=>ti(ve),children:ve},ve))}),c.jsx("button",{className:Qe.themeToggle,onClick:()=>jt.toggleView2DTheme(),title:jt.view2DTheme==="dark"?"라이트 모드로 전환":"다크 모드로 전환",children:jt.view2DTheme==="dark"?c.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[c.jsx("circle",{cx:"12",cy:"12",r:"5"}),c.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),c.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),c.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),c.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),c.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),c.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),c.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),c.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]}):c.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:c.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})})]}),c.jsx("div",{ref:br,className:Qe.viewerContent,children:c.jsx(O5,{spaceInfo:Ut,viewMode:fn,renderMode:ri,showDimensions:jt.showDimensions,showAll:jt.showAll,showFrame:!0,showDimensionsText:jt.showDimensionsText,showGuides:jt.showGuides,showAxis:jt.showAxis})}),c.jsxs("div",{className:Qe.viewerFooter,children:[c.jsx("button",{className:Qe.captureButton,onClick:An,children:"삽입"}),c.jsx("button",{className:Qe.cancelButton,onClick:()=>ee({isOpen:!1,viewId:null,viewType:null}),children:"취소"})]})]})}),c.jsx(o8,{isOpen:Je,onClose:()=>Me(!1)})]}):null},P8e=({isOpen:n,onClose:e})=>{ia();const[t,i]=H.useState(!1),[r,s]=H.useState({}),[o,a]=H.useState(!1),[l,h]=H.useState("pdf"),[u,d]=H.useState("solid"),[A,f]=H.useState({"3d":!0,"2d-top":!0,"2d-front":!1,"2d-left":!1,"2d-right":!1}),[p,g]=H.useState(["front","plan"]),{exportToPDF:v,isExporting:w}=QV(),{exportToZIP:m,canExportDXF:y,isExporting:x}=XQ(),S=hr(T=>T.spaceInfo),I=pi(T=>T.placedModules);if(!n)return null;const j=T=>{f(k=>({...k,[T]:!k[T]}))},C=T=>{g(k=>k.includes(T)?k.filter(B=>B!==T):[...k,T])},b=async()=>{if(console.log("📐 DXF 다운로드 버튼 클릭됨"),!S){alert("공간 정보가 없습니다. 먼저 공간을 설정해주세요.");return}if(p.length===0){alert("최소 하나 이상의 도면을 선택해주세요.");return}if(!y(S,I)){alert("DXF 내보내기를 할 수 없습니다. 가구를 배치해주세요.");return}try{const T=await m(S,I,p);T.success?(console.log("✅ DXF 다운로드 성공:",T.filename),setTimeout(()=>{e()},1e3)):(console.error("❌ DXF 다운로드 실패:",T.message),alert(`DXF 다운로드 실패: ${T.message}`))}catch(T){console.error("❌ DXF 다운로드 예외:",T),alert("DXF 다운로드 중 오류가 발생했습니다.")}},D=async()=>{if(console.log("📄 PDF 다운로드 버튼 클릭됨"),!S){alert("공간 정보가 없습니다. 먼저 공간을 설정해주세요.");return}const T=Object.entries(A).filter(([k,B])=>B).map(([k,B])=>k==="3d"?"3d-front":k);if(T.length===0){alert("최소 하나 이상의 뷰를 선택해주세요.");return}try{const k=await v(S,I,T,u);k.success?(console.log("✅ PDF 다운로드 성공:",k.filename),setTimeout(()=>{e()},1e3)):(console.error("❌ PDF 다운로드 실패:",k.message),alert(`PDF 다운로드 실패: ${k.message}`))}catch(k){console.error("❌ PDF 다운로드 예외:",k),alert("PDF 다운로드 중 오류가 발생했습니다.")}};return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:wr.overlay,onClick:e,children:c.jsxs("div",{className:wr.modal,onClick:T=>T.stopPropagation(),children:[c.jsxs("div",{className:wr.header,children:[c.jsx("h2",{children:"내보내기"}),c.jsx("button",{className:wr.closeButton,onClick:e,children:c.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("path",{d:"M18 6L6 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),c.jsx("path",{d:"M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})})]}),c.jsxs("div",{className:wr.content,children:[c.jsxs("div",{className:wr.section,children:[c.jsx("p",{className:wr.sectionTitle,children:"현재 가구 배치를 도면 또는 PDF로 내보냅니다"}),c.jsxs("div",{className:wr.formatTabs,children:[c.jsx("button",{className:`${wr.formatTab} ${l==="dxf"?wr.active:""}`,onClick:()=>h("dxf"),children:"CAD 도면 (DXF)"}),c.jsx("button",{className:`${wr.formatTab} ${l==="pdf"?wr.active:""}`,onClick:()=>h("pdf"),children:"PDF 문서"})]})]}),l==="dxf"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:wr.section,children:[c.jsx("h3",{className:wr.sectionHeader,children:"포함할 도면 선택"}),c.jsxs("div",{className:wr.viewList,children:[c.jsxs("label",{className:`${wr.viewOption} ${p.includes("front")?wr.selected:""}`,children:[c.jsx("input",{type:"checkbox",checked:p.includes("front"),onChange:()=>C("front")}),c.jsx("span",{children:"정면도"}),c.jsx("span",{className:wr.viewDescription,children:"정면에서 본 도면"})]}),c.jsxs("label",{className:`${wr.viewOption} ${p.includes("plan")?wr.selected:""}`,children:[c.jsx("input",{type:"checkbox",checked:p.includes("plan"),onChange:()=>C("plan")}),c.jsx("span",{children:"평면도"}),c.jsx("span",{className:wr.viewDescription,children:"위에서 본 도면"})]}),c.jsxs("label",{className:`${wr.viewOption} ${p.includes("side")?wr.selected:""}`,children:[c.jsx("input",{type:"checkbox",checked:p.includes("side"),onChange:()=>C("side")}),c.jsx("span",{children:"측면도"}),c.jsx("span",{className:wr.viewDescription,children:"측면에서 본 도면"})]})]})]}),c.jsx("button",{className:wr.downloadButton,onClick:b,disabled:x||p.length===0||!y(S,I),children:x?"처리 중...":`DXF ZIP 다운로드 (${p.length}개 도면)`})]}),l==="pdf"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:wr.section,children:[c.jsx("h3",{className:wr.sectionHeader,children:"렌더링 모드"}),c.jsxs("div",{className:wr.renderModes,children:[c.jsxs("label",{className:`${wr.renderMode} ${u==="solid"?wr.active:""}`,children:[c.jsx("input",{type:"radio",name:"renderMode",value:"solid",checked:u==="solid",onChange:T=>d(T.target.value)}),c.jsxs("div",{className:wr.renderModeContent,children:[c.jsx("h4",{children:"솔리드"}),c.jsx("p",{children:"재질과 색상이 표현됩니다"})]})]}),c.jsxs("label",{className:`${wr.renderMode} ${u==="wireframe"?wr.active:""}`,children:[c.jsx("input",{type:"radio",name:"renderMode",value:"wireframe",checked:u==="wireframe",onChange:T=>d(T.target.value)}),c.jsxs("div",{className:wr.renderModeContent,children:[c.jsx("h4",{children:"와이어프레임"}),c.jsx("p",{children:"구조만 표현됩니다"})]})]})]})]}),c.jsxs("div",{className:wr.section,children:[c.jsx("h3",{className:wr.sectionHeader,children:"포함할 뷰 선택"}),c.jsxs("div",{className:wr.viewList,children:[c.jsxs("label",{className:`${wr.viewOption} ${A["3d"]?wr.selected:""}`,children:[c.jsx("input",{type:"checkbox",checked:A["3d"],onChange:()=>j("3d")}),c.jsx("span",{children:"3D 정면뷰"})]}),c.jsxs("label",{className:`${wr.viewOption} ${A["2d-top"]?wr.selected:""}`,children:[c.jsx("input",{type:"checkbox",checked:A["2d-top"],onChange:()=>j("2d-top")}),c.jsx("span",{children:"2D 평면도 (위에서 본 뷰)"}),c.jsx("button",{className:wr.viewDetail,children:"치수 포함"})]}),c.jsxs("label",{className:`${wr.viewOption} ${A["2d-front"]?wr.selected:""}`,children:[c.jsx("input",{type:"checkbox",checked:A["2d-front"],onChange:()=>j("2d-front")}),c.jsx("span",{children:"2D 정면도 (앞에서 본 뷰)"}),c.jsx("button",{className:wr.viewDetail,children:"치수 포함"})]}),c.jsxs("label",{className:`${wr.viewOption} ${A["2d-left"]?wr.selected:""}`,children:[c.jsx("input",{type:"checkbox",checked:A["2d-left"],onChange:()=>j("2d-left")}),c.jsx("span",{children:"2D 좌측면도 (왼쪽에서 본 뷰)"}),c.jsx("button",{className:wr.viewDetail,children:"치수 포함"})]}),c.jsxs("label",{className:`${wr.viewOption} ${A["2d-right"]?wr.selected:""}`,children:[c.jsx("input",{type:"checkbox",checked:A["2d-right"],onChange:()=>j("2d-right")}),c.jsx("span",{children:"2D 우측면도 (오른쪽에서 본 뷰)"}),c.jsx("button",{className:wr.viewDetail,children:"치수 포함"})]})]})]}),c.jsx("button",{className:wr.downloadButton,onClick:D,disabled:w||Object.values(A).every(T=>!T),children:w?"처리 중...":`PDF 다운로드 (${Object.values(A).filter(T=>T).length}개 뷰)`})]})]})]})}),c.jsx(ZX,{isOpen:t,onClose:()=>{i(!1),e()},capturedViews:r})]})},N8e=({spaceInfo:n,onUpdate:e})=>{const{t}=yv();console.log("🏢 InstallTypeControls - 현재 installType:",n.installType),console.log("🏢 InstallTypeControls - 현재 wallConfig:",n.wallConfig);const i=s=>{var l,h,u;let o={...n.wallConfig};switch(s){case"builtin":o={left:!0,right:!0};break;case"semistanding":o={left:!0,right:!1};break;case"freestanding":o={left:!1,right:!1};break}const a={installType:s,wallConfig:o};n.surroundType==="no-surround"&&(s==="semistanding"||s==="freestanding")&&(a.gapConfig={left:0,right:0}),n.surroundType==="surround"?s==="builtin"?a.frameSize={left:50,right:50,top:((l=n.frameSize)==null?void 0:l.top)||10}:s==="semistanding"?a.frameSize={left:o.left?50:20,right:o.right?50:20,top:((h=n.frameSize)==null?void 0:h.top)||10}:s==="freestanding"&&(a.frameSize={left:20,right:20,top:((u=n.frameSize)==null?void 0:u.top)||10}):n.surroundType==="no-surround"&&(a.frameSize={left:0,right:0,top:10},n.gapConfig,a.gapConfig={left:o.left?2:20,right:o.right?2:20}),console.log("🏢 InstallTypeControls - updating with:",a),e(a)},r=s=>{var l,h;const o={left:s==="left",right:s==="right"},a={wallConfig:o};n.surroundType==="no-surround"&&(o.left&&o.right?a.gapConfig={left:((l=n.gapConfig)==null?void 0:l.left)||2,right:((h=n.gapConfig)==null?void 0:h.right)||2}:a.gapConfig={left:0,right:0},a.frameSize={left:0,right:0,top:10}),console.log("🏢 InstallTypeControls - wallConfig 변경:",{newWallConfig:o,gapConfig:a.gapConfig,surroundType:n.surroundType}),e(a)};return c.jsxs("div",{className:ki.container,children:[c.jsx("div",{className:ki.section,children:c.jsxs("div",{className:ki.toggleButtonGroup,children:[c.jsx("button",{className:`${ki.toggleButton} ${n.installType==="builtin"?ki.toggleButtonActive:""}`,onClick:()=>i("builtin"),title:t("space.builtinDesc"),children:t("space.builtin")}),c.jsx("button",{className:`${ki.toggleButton} ${n.installType==="semistanding"?ki.toggleButtonActive:""}`,onClick:()=>i("semistanding"),title:t("space.semistandingDesc"),children:t("space.semistanding")}),c.jsx("button",{className:`${ki.toggleButton} ${n.installType==="freestanding"?ki.toggleButtonActive:""}`,onClick:()=>i("freestanding"),title:t("space.freestandingDesc"),children:t("space.freestanding")})]})}),n.installType==="semistanding"&&c.jsxs("div",{className:ki.section,children:[c.jsx("span",{className:ki.label,children:t("space.wallPosition")}),c.jsxs("div",{className:ki.toggleButtonGroup,children:[c.jsx("button",{className:`${ki.toggleButton} ${n.wallConfig.left?ki.toggleButtonActive:""}`,onClick:()=>r("left"),children:t("furniture.left")}),c.jsx("button",{className:`${ki.toggleButton} ${n.wallConfig.right?ki.toggleButtonActive:""}`,onClick:()=>r("right"),children:t("furniture.right")})]})]})]})},L8e=({spaceInfo:n,onUpdate:e})=>{var u,d,A,f,p,g;const{t}=ia(),[i,r]=H.useState(((d=(u=n.floorFinish)==null?void 0:u.height)==null?void 0:d.toString())||"9");H.useEffect(()=>{var v,w;r(((w=(v=n.floorFinish)==null?void 0:v.height)==null?void 0:w.toString())||"9")},[(A=n.floorFinish)==null?void 0:A.height]);const s=v=>{if(v)e({hasFloorFinish:!1,floorFinish:void 0});else{const w=parseInt(i)||9;e({hasFloorFinish:!0,floorFinish:{height:w}})}},o=v=>{(v===""||/^\d+$/.test(v))&&r(v)},a=()=>{const v=i;if(v===""){r("9");return}const w=parseInt(v);w>=5&&w<=100?e({hasFloorFinish:!0,floorFinish:{height:w}}):(r("9"),e({hasFloorFinish:!0,floorFinish:{height:9}}))},l=v=>{v.key==="Enter"&&a()};n.hasFloorFinish?n.height-(((f=n.floorFinish)==null?void 0:f.height)||0):n.height;const h=((p=n.baseConfig)==null?void 0:p.placementType)==="float"&&(((g=n.baseConfig)==null?void 0:g.floatHeight)||0)>0;return H.useEffect(()=>{h&&n.hasFloorFinish&&e({hasFloorFinish:!1,floorFinish:void 0})},[h]),h?c.jsx("div",{className:ki.container,children:c.jsx("div",{className:ki.section,children:c.jsx("p",{className:ki.disabledMessage,children:t("space.floorFinishDisabledForFloat")||"띄워서 배치 시 바닥마감재 설정이 비활성화됩니다."})})}):c.jsxs("div",{className:ki.container,children:[c.jsx("div",{className:ki.section,children:c.jsxs("div",{className:ki.toggleButtonGroup,children:[c.jsx("button",{className:`${ki.toggleButton} ${n.hasFloorFinish?ki.toggleButtonActive:""}`,onClick:()=>s(!1),children:t("common.enabled")}),c.jsx("button",{className:`${ki.toggleButton} ${n.hasFloorFinish?"":ki.toggleButtonActive}`,onClick:()=>s(!0),children:t("common.none")})]})}),n.hasFloorFinish&&c.jsxs("div",{className:ki.section,children:[c.jsx("label",{className:ki.label,children:t("space.floorFinishThickness")}),c.jsxs("div",{className:ki.inputWrapper,children:[c.jsx("input",{type:"text",className:ki.input,value:i,onChange:v=>o(v.target.value),onBlur:a,onKeyDown:l,placeholder:"5-100"}),c.jsx("span",{className:ki.unit,children:"mm"})]})]})]})},M8e="_configSection_14zx7_2",R8e="_sectionHeader_14zx7_13",U8e="_sectionDot_14zx7_20",O8e="_sectionTitle_14zx7_38",H8e="_content_14zx7_47",W8e="_gapGrid_14zx7_61",z8e="_gapItem_14zx7_67",Q8e="_gapLabel_14zx7_73",$8e="_gapControl_14zx7_81",V8e="_disabled_14zx7_92",G8e="_controlButton_14zx7_109",X8e="_gapInput_14zx7_110",Al={configSection:M8e,sectionHeader:R8e,sectionDot:U8e,sectionTitle:O8e,content:H8e,gapGrid:W8e,gapItem:z8e,gapLabel:Q8e,gapControl:$8e,disabled:V8e,controlButton:G8e,gapInput:X8e},Y8e=({spaceInfo:n,onUpdate:e})=>{var A,f,p,g,v,w;const{t}=ia(),[i,r]=H.useState(((A=n==null?void 0:n.gapConfig)==null?void 0:A.left)||2),[s,o]=H.useState(((f=n==null?void 0:n.gapConfig)==null?void 0:f.right)||2);if(H.useEffect(()=>{var m,y;r(((m=n==null?void 0:n.gapConfig)==null?void 0:m.left)||2),o(((y=n==null?void 0:n.gapConfig)==null?void 0:y.right)||2)},[n==null?void 0:n.gapConfig]),!n||n.surroundType!=="no-surround")return null;const a=((p=n.wallConfig)==null?void 0:p.left)??!0,l=((g=n.wallConfig)==null?void 0:g.right)??!0;if(!(a&&l))return(((v=n.gapConfig)==null?void 0:v.left)!==0||((w=n.gapConfig)==null?void 0:w.right)!==0)&&e({gapConfig:{left:0,right:0}}),null;const h=(m,y)=>{const x={...n.gapConfig,[m]:y};e({gapConfig:x})},u=(m,y)=>{const x=parseInt(y)||0;m==="left"?r(x):o(x)},d=m=>{const x=Math.max(0,Math.min(50,m==="left"?i:s));m==="left"?r(x):o(x),h(m,x)};return c.jsxs("div",{className:Al.configSection,children:[c.jsxs("div",{className:Al.sectionHeader,children:[c.jsx("span",{className:Al.sectionDot}),c.jsx("h3",{className:Al.sectionTitle,children:t("placement.wallOffset")})]}),c.jsx("div",{className:Al.content,children:c.jsxs("div",{className:Al.gapGrid,children:[c.jsxs("div",{className:Al.gapItem,children:[c.jsxs("label",{className:Al.gapLabel,children:[t("placement.leftGap"),!a&&` (${t("placement.noWall")})`]}),c.jsxs("div",{className:`${Al.gapControl} ${a?"":Al.disabled}`,children:[c.jsx("button",{className:Al.controlButton,disabled:!a,onClick:()=>{if(a){const m=Math.max(0,i-1);r(m),h("left",m)}},children:"−"}),c.jsx("input",{type:"number",value:a?i:0,onChange:m=>a&&u("left",m.target.value),onBlur:()=>a&&d("left"),className:Al.gapInput,min:"0",max:"50",disabled:!a}),c.jsx("button",{className:Al.controlButton,disabled:!a,onClick:()=>{if(a){const m=Math.min(50,i+1);r(m),h("left",m)}},children:"+"})]})]}),c.jsxs("div",{className:Al.gapItem,children:[c.jsxs("label",{className:Al.gapLabel,children:[t("placement.rightGap"),!l&&` (${t("placement.noWall")})`]}),c.jsxs("div",{className:`${Al.gapControl} ${l?"":Al.disabled}`,children:[c.jsx("button",{className:Al.controlButton,disabled:!l,onClick:()=>{if(l){const m=Math.max(0,s-1);o(m),h("right",m)}},children:"−"}),c.jsx("input",{type:"number",value:l?s:0,onChange:m=>l&&u("right",m.target.value),onBlur:()=>l&&d("right"),className:Al.gapInput,min:"0",max:"50",disabled:!l}),c.jsx("button",{className:Al.controlButton,disabled:!l,onClick:()=>{if(l){const m=Math.min(50,s+1);o(m),h("right",m)}},children:"+"})]})]})]})})]})},K8e=({baseConfig:n,onBaseTypeChange:e,disabled:t=!1})=>{const{t:i}=ia(),r=(n==null?void 0:n.type)==="floor"||!n,s=(n==null?void 0:n.type)==="stand";return c.jsx("div",{className:ki.section,children:c.jsxs("div",{className:ki.toggleButtonGroup,children:[c.jsx("button",{className:`${ki.toggleButton} ${r?ki.toggleButtonActive:""}`,onClick:()=>e("floor"),disabled:t,children:i("placement.floor")}),c.jsx("button",{className:`${ki.toggleButton} ${s?ki.toggleButtonActive:""}`,onClick:()=>e("stand"),disabled:t,children:i("placement.float")})]})})},q8e=({baseConfig:n,baseHeight:e,floatHeight:t,onPlacementTypeChange:i,onHeightChange:r,onFloatHeightChange:s,onHeightBlur:o,onFloatHeightBlur:a,onKeyDown:l,onFloatKeyDown:h,disabled:u=!1})=>{const{t:d}=ia(),{setHighlightedFrame:A}=Wi(),f=(n==null?void 0:n.type)==="floor"||!n,p=(n==null?void 0:n.type)==="stand";n==null||n.placementType,n==null||n.placementType;const g=()=>{A("base")},v=()=>{A(null),o()},w=()=>{A(null),a()};return c.jsxs(c.Fragment,{children:[f&&c.jsxs("div",{className:ki.section,children:[c.jsx("span",{className:ki.label,children:d("frame.baseHeight")}),c.jsx("div",{className:ki.inputWrapper,children:c.jsxs("div",{className:ki.inputWithUnit,children:[c.jsx("input",{type:"text",value:e,onChange:m=>{console.log("🔧 PlacementControls - input onChange 호출됨:",m.target.value),r(m.target.value)},onInput:m=>{console.log("🔧 PlacementControls - input onInput 호출됨:",m.currentTarget.value)},onClick:m=>{console.log("🔧 PlacementControls - input onClick 호출됨, disabled:",u)},onFocus:g,onBlur:v,onKeyDown:l,className:`${ki.input} ${ki.inputWithUnitField}`,placeholder:"65",disabled:u}),c.jsx("span",{className:ki.unit,children:"mm"})]})})]}),p&&c.jsxs("div",{className:ki.section,children:[c.jsx("span",{className:ki.label,children:d("frame.floatHeight")}),c.jsx("div",{className:ki.inputWrapper,children:c.jsxs("div",{className:ki.inputWithUnit,children:[c.jsx("input",{type:"text",value:t,onChange:m=>s(m.target.value),onFocus:g,onBlur:w,onKeyDown:h,className:`${ki.input} ${ki.inputWithUnitField}`,placeholder:"60",disabled:u}),c.jsx("span",{className:ki.unit,children:"mm"})]})})]})]})},Z8e=({spaceInfo:n,onUpdate:e,disabled:t=!1})=>{var v;console.log("🔧 BaseControls - disabled 상태:",t);const i=()=>{var m;const w=((m=n.baseConfig)==null?void 0:m.height)||65;if(n.hasFloorFinish&&n.floorFinish){const y=n.floorFinish.height||0;return Math.max(0,w-y)}return w},[r,s]=H.useState(String(i())),[o,a]=H.useState(String(((v=n.baseConfig)==null?void 0:v.floatHeight)||60));H.useEffect(()=>{s(String(i())),n.baseConfig&&a(String(n.baseConfig.floatHeight||60))},[n.baseConfig,n.hasFloorFinish,n.floorFinish]);const l=w=>{const m=n.baseConfig||{type:"floor",height:65};w==="stand"?(a("200"),e({baseConfig:{...m,type:w,placementType:"float",floatHeight:200},hasFloorFinish:!1,floorFinish:void 0})):e({baseConfig:{...m,type:w,placementType:"ground",height:m.height||65}})},h=w=>{const m=n.baseConfig||{type:"stand",height:65};e(w==="float"?{baseConfig:{...m,placementType:w,floatHeight:m.floatHeight||60},hasFloorFinish:!1,floorFinish:void 0}:{baseConfig:{...m,placementType:w}})},u=w=>{var m;if(console.log("🔧 BaseControls - handleHeightChange 호출됨:",w),w===""||/^\d+$/.test(w)){if(console.log("🔧 BaseControls - 입력값 검증 통과:",w),s(w),w==="")return;if(!isNaN(Number(w))){let y=parseInt(w);if(n.hasFloorFinish&&n.floorFinish){const S=n.floorFinish.height||0;y=y+S}const x=n.baseConfig||{type:"floor",height:65};console.log("🔧 BaseControls - store 업데이트:",{표시값:w,저장값:y,바닥마감재:((m=n.floorFinish)==null?void 0:m.height)||0}),e({baseConfig:{...x,height:y}})}}else console.log("🔧 BaseControls - 입력값 검증 실패:",w)},d=w=>{if(w===""||/^\d+$/.test(w)){if(a(w),w==="")return;if(!isNaN(Number(w))){const m=parseInt(w),y=n.baseConfig||{type:"stand",height:0,floatHeight:60};e({baseConfig:{...y,floatHeight:m}})}}},A=()=>{const w=n.baseConfig||{type:"floor",height:65};let m=r;typeof m=="string"&&(m=m===""?65:parseInt(m)),m<50&&(m=50),m>500&&(m=500),s(m);let y=m;if(n.hasFloorFinish&&n.floorFinish){const x=n.floorFinish.height||0;y=m+x}y!==w.height&&e({baseConfig:{...w,height:y}})},f=()=>{const w=n.baseConfig||{type:"stand",height:0,floatHeight:60};let m=o;typeof m=="string"&&(m=m===""?60:parseInt(m)),m<0&&(m=0),m>200&&(m=200),a(m),m!==w.floatHeight&&e({baseConfig:{...w,floatHeight:m}})},p=w=>{w.key==="Enter"&&A()},g=w=>{w.key==="Enter"&&f()};return c.jsxs("div",{className:ki.container,children:[c.jsx(K8e,{baseConfig:n.baseConfig,onBaseTypeChange:l,disabled:t}),c.jsx(q8e,{baseConfig:n.baseConfig,baseHeight:r,floatHeight:o,onPlacementTypeChange:h,onHeightChange:u,onFloatHeightChange:d,onHeightBlur:A,onFloatHeightBlur:f,onKeyDown:p,onFloatKeyDown:g,disabled:t})]})},J8e="_configurator_g3eog_2",eIe="_mainContent_g3eog_12",tIe="_fileTreeOverlay_g3eog_20",nIe="_fileTreePanel_g3eog_32",iIe="_preparingPanel_g3eog_47",rIe="_leftPanelToggle_g3eog_71",sIe="_open_g3eog_93",oIe="_rightPanelContainer_g3eog_103",aIe="_rightPanelToggle_g3eog_114",lIe="_sidebarContent_g3eog_207",cIe="_sidebarPanel_g3eog_229",hIe="_modulePanelContent_g3eog_237",uIe="_moduleCategoryTabs_g3eog_339",dIe="_moduleCategoryTab_g3eog_339",AIe="_active_g3eog_374",fIe="_moduleSection_g3eog_432",pIe="_viewerArea_g3eog_440",gIe="_viewer_g3eog_440",mIe="_viewerDoorToggle_g3eog_465",yIe="_viewerDoorButton_g3eog_479",wIe="_rightPanel_g3eog_103",vIe="_rightPanelHeader_g3eog_572",xIe="_rightPanelTabs_g3eog_577",bIe="_tabGroup_g3eog_586",CIe="_rightPanelTab_g3eog_577",_Ie="_rightPanelContent_g3eog_651",SIe="_spaceControls_g3eog_660",TIe="_configSection_g3eog_667",BIe="_sectionHeader_g3eog_677",EIe="_sectionDot_g3eog_684",FIe="_sectionTitle_g3eog_692",kIe="_inputGroup_g3eog_700",IIe="_inputLabel_g3eog_716",DIe="_loadingContainer_g3eog_979",jIe="_toggleButton_g3eog_1032",PIe="_input_g3eog_700",NIe="_foldToggleIcon_g3eog_1536",LIe="_toggleButtonGroup_g3eog_1560",MIe="_subSetting_g3eog_1622",RIe="_subLabel_g3eog_1628",UIe="_frameGrid_g3eog_1637",OIe="_frameItem_g3eog_1644",HIe="_frameItemLabel_g3eog_1650",WIe="_frameItemInput_g3eog_1658",zIe="_frameButton_g3eog_1669",QIe="_frameNumberInput_g3eog_1693",$Ie="_frameUnit_g3eog_1721",VIe="_toggleButtonActive_g3eog_1858",GIe="_inputWithUnit_g3eog_1919",XIe="_inputWithUnitField_g3eog_1942",YIe="_unit_g3eog_1946",dn={configurator:J8e,mainContent:eIe,fileTreeOverlay:tIe,fileTreePanel:nIe,preparingPanel:iIe,leftPanelToggle:rIe,open:sIe,rightPanelContainer:oIe,rightPanelToggle:aIe,sidebarContent:lIe,sidebarPanel:cIe,modulePanelContent:hIe,moduleCategoryTabs:uIe,moduleCategoryTab:dIe,active:AIe,moduleSection:fIe,viewerArea:pIe,viewer:gIe,viewerDoorToggle:mIe,viewerDoorButton:yIe,rightPanel:wIe,rightPanelHeader:vIe,rightPanelTabs:xIe,tabGroup:bIe,rightPanelTab:CIe,rightPanelContent:_Ie,spaceControls:SIe,configSection:TIe,sectionHeader:BIe,sectionDot:EIe,sectionTitle:FIe,inputGroup:kIe,inputLabel:IIe,loadingContainer:DIe,toggleButton:jIe,input:PIe,foldToggleIcon:NIe,toggleButtonGroup:LIe,subSetting:MIe,subLabel:RIe,frameGrid:UIe,frameItem:OIe,frameItemLabel:HIe,frameItemInput:WIe,frameButton:zIe,frameNumberInput:QIe,frameUnit:$Ie,toggleButtonActive:VIe,inputWithUnit:GIe,inputWithUnitField:XIe,unit:YIe},KIe=()=>{var Tr,xr,br,vn,wi;const{user:n}=Vc(),[e]=tF(),t=ph(),i=e5(),{t:r}=ia(),s=e.get("design")==="new",[o,a]=H.useState(!s),[l,h]=H.useState(!1),[u,d]=H.useState("idle"),[A,f]=H.useState(null),[p,g]=H.useState(null),[v,w]=H.useState(""),[m,y]=H.useState(!1),{setBasicInfo:x,basicInfo:S,setProjectId:I}=Pl(),{setSpaceInfo:j,spaceInfo:C,updateColumn:b}=hr(),{setPlacedModules:D,placedModules:T,setAllDoors:k,clearAllModules:B}=pi(),E=v0(),{updateFurnitureForNewSpace:z}=bde({setPlacedModules:D}),{viewMode:te,setViewMode:L,doorsOpen:O,toggleDoors:J,view2DDirection:$,setView2DDirection:U,showDimensions:Y,toggleDimensions:K,showDimensionsText:V,toggleDimensionsText:Q,setHighlightedFrame:X,selectedColumnId:W,setSelectedColumnId:se,activePopup:q,openColumnEditModal:de,closeAllPopups:Ce,showGuides:Se,toggleGuides:fe,showAxis:M,toggleAxis:Z,activeDroppedCeilingTab:Ae,setActiveDroppedCeilingTab:ie,showFurniture:ee,setShowFurniture:ae,renderMode:me,setRenderMode:_e}=Wi();XQ(),QV();const[ue,Be]=H.useState("module"),[it,De]=H.useState("placement"),[qe,Je]=H.useState(!0),[Me,et]=H.useState(!1),[He,ze]=H.useState("tall"),Oe=H.useRef(null),[ke,je]=H.useState(!0),[rt,_t]=H.useState(!1),Ee=e.get("editor")==="drawing",[Le,ye]=H.useState(Ee),[Ze,nt]=H.useState({}),[st,At]=H.useState(()=>{const Ve={...C};return Ve.installType==="built-in"&&(Ve.installType="builtin"),Ve});H.useEffect(()=>{dk()},[]),H.useEffect(()=>{const Ve=ct=>{var An;const mt=document.activeElement;if(!(mt&&(mt.tagName==="INPUT"||mt.tagName==="TEXTAREA"))){if(ct.key==="d"||ct.key==="D"){ct.preventDefault(),console.log("🚪 D 키로 도어 토글 시도"),J();return}if((ct.ctrlKey||ct.metaKey)&&ct.key==="e"){ct.preventDefault(),W?(console.log("⌨️ 키보드 단축키로 기둥 편집 모달 열기:",W),de(W)):console.log("⚠️ 선택된 기둥이 없습니다.");return}if(q.type==="columnEdit"&&q.id){const nn=(An=C.columns)==null?void 0:An.find(zt=>zt.id===q.id);if(nn&&(ct.key==="ArrowLeft"||ct.key==="ArrowRight")){ct.preventDefault();const zt=nn.position[0],gn=C.width*.01,Jn=nn.width*.01,Qn=ct.shiftKey?.05:.005;let pn=zt;ct.key==="ArrowLeft"?pn=Math.max(-(gn/2)+Jn/2,zt-Qn):ct.key==="ArrowRight"&&(pn=Math.min(gn/2-Jn/2,zt+Qn)),b(q.id,{position:[pn,nn.position[1],nn.position[2]]}),console.log("⌨️ 컬럼 키보드 이동:",{columnId:q.id,direction:ct.key,moveStep:Qn,stepSize:ct.shiftKey?"50mm (빠름)":"5mm (정밀)",oldX:zt,newX:pn})}}}};return document.addEventListener("keydown",Ve),()=>{document.removeEventListener("keydown",Ve)}},[W,de,q,C.columns,C.width,b]),H.useEffect(()=>{L("3D"),U("front")},[L,U]),H.useEffect(()=>{var Ve,ct;C.materialConfig&&console.log("🔍 Configurator - MaterialConfig 변경 감지:",{interiorColor:C.materialConfig.interiorColor,doorColor:C.materialConfig.doorColor,interiorTexture:C.materialConfig.interiorTexture,doorTexture:C.materialConfig.doorTexture,isCabinetTexture1:{interior:(Ve=C.materialConfig.interiorTexture)==null?void 0:Ve.includes("cabinet texture1"),door:(ct=C.materialConfig.doorTexture)==null?void 0:ct.includes("cabinet texture1")}})},[C.materialConfig]);const ft=(Ve,ct)=>{var nn,zt;if(Ve==="left"&&(C.installType==="semistanding"&&!((nn=C.wallConfig)!=null&&nn.left)||C.installType==="freestanding")||Ve==="right"&&(C.installType==="semistanding"&&!((zt=C.wallConfig)!=null&&zt.right)||C.installType==="freestanding"))return;const mt=C.surroundType==="no-surround"?{left:0,right:0,top:0}:{left:50,right:50,top:50},An=C.frameSize||mt;Sn({frameSize:{...An,[Ve]:ct}})},Xt=Ve=>{const mt=Ve-100,An=400,zt=Math.max(1,Math.ceil(mt/600)),gn=Math.min(20,Math.floor(mt/An)),Jn=Math.max(zt,1),Qn=Math.min(gn,20);return Jn>Qn?{min:1,max:1,ideal:1}:{min:Jn,max:Qn,ideal:Math.max(Jn,Math.min(Qn,Math.round(mt/500)))}},Yt=()=>{var zt,gn;let Ve=C.width||4800;(zt=C.droppedCeiling)!=null&&zt.enabled&&(Ve=Ve-(C.droppedCeiling.width||ea.WIDTH));const ct=Xt(Ve);let mt=ct.min;(gn=C.droppedCeiling)!=null&&gn.enabled?C.mainDoorCount?mt=C.mainDoorCount:mt=C.customColumnCount||E.columnCount||ct.min:C.customColumnCount?mt=C.customColumnCount:E.isCalculated&&E.columnCount?mt=E.columnCount:mt=ct.min,mt=Math.max(ct.min,Math.min(ct.max,mt));const An=Ve-100,nn=An/mt;return nn<400?mt=Math.floor(An/400):nn>600&&(mt=Math.ceil(An/600)),Math.max(ct.min,Math.min(ct.max,mt))},Zt=T.some(Ve=>Ve.moduleId.includes("dual-2drawer-styler")||Ve.moduleId.includes("dual-4drawer-pantshanger"));console.log("🔧 Configurator - hasSpecialDualFurniture:",Zt),console.log("🔧 Configurator - placedModules:",T);const sn=T.some(Ve=>Ve.hasDoor),vt=async Ve=>{a(!0);try{const{project:ct,error:mt}=await Qy(Ve);if(mt){console.error("프로젝트 로드 에러:",mt),alert("프로젝트를 불러오는데 실패했습니다: "+mt),t("/");return}if(ct){const An=ct.title||ct.projectData.title||"새 프로젝트";x({title:An,location:ct.projectData.location||""}),console.log("🔍 loadProject에서 설정한 title:",An);const nn={...ct.spaceConfig};if(nn.installType==="built-in"&&(nn.installType="builtin"),!nn.wallConfig)switch(nn.installType){case"builtin":nn.wallConfig={left:!0,right:!0};break;case"semistanding":nn.wallConfig={left:!0,right:!1};break;case"freestanding":nn.wallConfig={left:!1,right:!1};break}j(nn),D(ct.furniture.placedModules),f(Ve),console.log("✅ 프로젝트 로드 성공:",ct.title),console.log("🎨 로드된 materialConfig:",ct.spaceConfig.materialConfig),console.log("🔄 [프로젝트 로드 후] derivedSpaceStore 강제 재계산"),E.recalculateFromSpaceInfo(ct.spaceConfig)}}catch(ct){console.error("프로젝트 로드 실패:",ct),alert("프로젝트 로드 중 오류가 발생했습니다."),t("/")}finally{a(!1)}},Ye=()=>!0,Gt=Ve=>{if(Ve==null)return null;if(Array.isArray(Ve))return Ve.map(Gt);if(typeof Ve=="object"){const ct={};for(const[mt,An]of Object.entries(Ve))An!==void 0&&(ct[mt]=Gt(An));return ct}return Ve},Wt=async()=>{if(console.log("💾 [DEBUG] saveProject 함수 시작"),console.log("💾 [DEBUG] 현재 프로젝트 ID:",A),console.log("💾 [DEBUG] 현재 디자인파일 ID:",p),console.log("💾 [DEBUG] Firebase 설정:",Ye()),console.log("💾 [DEBUG] 사용자 상태:",!!n),console.log("💾 [DEBUG] 사용자 정보:",n?{email:n.email,uid:n.uid}:"null"),!A){console.error("💾 [ERROR] 프로젝트 ID가 없습니다"),alert("저장할 프로젝트가 없습니다. 새 프로젝트를 먼저 생성해주세요.");return}h(!0),d("idle");try{console.log("💾 [DEBUG] 저장할 basicInfo:",S),console.log("💾 [DEBUG] 저장할 spaceInfo 요약:",{width:C.width,height:C.height,materialConfig:C.materialConfig}),console.log("💾 [DEBUG] 저장할 placedModules 개수:",T.length),console.log("💾 [DEBUG] 저장할 placedModules 상세:",T);let Ve;try{Ve=await YS(),Ve||(console.log("💾 [DEBUG] 3D 캔버스 캡처 실패, 기본 썸네일 생성"),Ve=tC(C,T.length)),console.log("💾 [DEBUG] 썸네일 생성 완료")}catch(mt){console.error("💾 [DEBUG] 썸네일 생성 실패:",mt),Ve=null}if(Ye()&&n){console.log("💾 [DEBUG] Firebase 저장 모드 진입");try{if(p){console.log("💾 [DEBUG] 기존 디자인 파일 업데이트");const{updateDesignFile:mt}=await rl(async()=>{const{updateDesignFile:zt}=await Promise.resolve().then(()=>ZA);return{updateDesignFile:zt}},void 0),An={name:v||S.title,spaceConfig:Gt(C),furniture:{placedModules:Gt(T)},thumbnail:Ve};console.log("💾 [DEBUG] updateDesignFile 호출 전 데이터:",{name:An.name,spaceConfigKeys:Object.keys(An.spaceConfig||{}),furnitureCount:An.furniture.placedModules.length,hasThumbnail:!!An.thumbnail});const{error:nn}=await mt(p,An);if(nn)console.error("💾 [ERROR] 디자인 파일 업데이트 실패:",nn),d("error"),alert("디자인 파일 저장에 실패했습니다: "+nn);else{d("success"),console.log("✅ 디자인 파일 저장 성공"),setTimeout(()=>{Oe.current&&(console.log("🔄 Calling reset after successful save"),Oe.current())},100);try{const zt=new BroadcastChannel("project-updates");zt.postMessage({type:"DESIGN_FILE_UPDATED",projectId:A,designFileId:p,timestamp:Date.now()}),console.log("📡 디자인 파일 업데이트 알림 전송"),zt.close()}catch(zt){console.warn("BroadcastChannel 전송 실패 (무시 가능):",zt)}}}else{console.log("💾 [DEBUG] 새 디자인 파일 생성");const{createDesignFile:mt}=await rl(async()=>{const{createDesignFile:zt}=await Promise.resolve().then(()=>ZA);return{createDesignFile:zt}},void 0),{id:An,error:nn}=await mt({name:S.title||"새 디자인",projectId:A,spaceConfig:Gt(C),furniture:{placedModules:Gt(T)},thumbnail:Ve});if(nn)console.error("💾 [ERROR] 디자인 파일 생성 실패:",nn),d("error"),alert("디자인 파일 생성에 실패했습니다: "+nn);else if(An){g(An),w(S.title),d("success"),console.log("✅ 새 디자인 파일 생성 및 저장 성공"),setTimeout(()=>{Oe.current&&(console.log("🔄 Calling reset after successful create"),Oe.current())},100);try{const zt=new BroadcastChannel("project-updates");zt.postMessage({type:"DESIGN_FILE_UPDATED",projectId:A,designFileId:An,timestamp:Date.now()}),console.log("📡 새 디자인 파일 생성 알림 전송"),zt.close()}catch(zt){console.warn("BroadcastChannel 전송 실패 (무시 가능):",zt)}t(`/configurator?projectId=${A}&designFileId=${An}`,{replace:!0})}}try{const mt=new BroadcastChannel("project-updates");mt.postMessage({type:"PROJECT_SAVED",projectId:A,timestamp:Date.now()}),console.log("💾 [DEBUG] BroadcastChannel 알림 전송 완료"),mt.close()}catch(mt){console.warn("💾 [WARN] BroadcastChannel 전송 실패 (무시 가능):",mt)}}catch(mt){console.error("💾 [ERROR] Firebase 저장 중 예외:",mt),d("error"),alert("디자인 파일 저장 중 오류가 발생했습니다: "+mt.message)}setTimeout(()=>d("idle"),3e3)}else console.log("💾 [DEBUG] Firebase 인증 필요"),d("error"),alert("저장하려면 로그인이 필요합니다."),setTimeout(()=>d("idle"),3e3)}catch(Ve){console.error("💾 [ERROR] saveProject 최상위 예외:",Ve),d("error"),alert("프로젝트 저장 중 예상치 못한 오류가 발생했습니다: "+Ve.message)}finally{console.log("💾 [DEBUG] saveProject 완료, 저장 상태 해제"),h(!1)}},Vt=async()=>{if(console.log("🎨 [DEBUG] handleNewDesign 함수 시작"),!A){alert("프로젝트가 선택되지 않았습니다.");return}try{if(p&&(C||T.length>0)){console.log("💾 새 디자인 생성 전 현재 작업 저장 시작"),h(!0),d("idle");try{await Wt(),console.log("✅ 현재 작업 저장 완료"),d("success"),setTimeout(()=>d("idle"),2e3)}catch(mt){if(console.error("❌ 현재 작업 저장 실패:",mt),!confirm("현재 작업을 저장하는데 실패했습니다. 그래도 새 디자인을 생성하시겠습니까?")){h(!1);return}}finally{h(!1)}}const Ve=confirm("새 디자인을 시작하시겠습니까? (현재 작업은 저장되었습니다)");if(console.log("🎨 [DEBUG] 사용자 확인 응답:",Ve),!Ve){console.log("🎨 [DEBUG] 사용자가 취소함");return}const ct={width:od.WIDTH,height:od.HEIGHT,depth:od.DEPTH,frameThickness:20,frameColor:"#E5E5DC",frameColorName:"Beige",subdivisionMode:"none",columns:[],rows:[],showHorizontalLines:!1,surroundType:"surround",installType:"builtin",wallConfig:{left:!0,right:!0},gapConfig:{left:2,right:2},frameSize:{top:qA.TOP,left:qA.LEFT,right:qA.RIGHT},framePosition:"top",baseConfig:{type:"floor",height:VC.HEIGHT,placementType:"ground"},hasFloorFinish:!1,materialConfig:{interiorColor:wm.INTERIOR_COLOR,doorColor:wm.DOOR_COLOR},droppedCeiling:{enabled:!1,position:"right",width:ea.WIDTH,dropHeight:ea.DROP_HEIGHT}};if(Ye()&&n){const mt="제목 없음",An=await fk({name:mt,projectId:A,spaceConfig:ct,furniture:{placedModules:[]}});if(An.error){console.error("🎨 [ERROR] 새 디자인 생성 실패:",An.error),alert("새 디자인 생성에 실패했습니다: "+An.error);return}An.id&&(console.log("🎨 [DEBUG] 새 디자인 생성 성공:",An.id),j(ct),D([]),g(An.id),w(mt),x({...S,title:mt}),E.recalculateFromSpaceInfo(ct),t(`/configurator?projectId=${A}&designFileId=${An.id}`,{replace:!0}),console.log("✅ 새 디자인파일 생성 완료:",An.id),alert("새 디자인이 생성되었습니다!"))}else{const mt="제목 없음";j(ct),D([]),w(mt),x({...S,title:mt}),E.recalculateFromSpaceInfo(ct),alert("새 디자인이 생성되었습니다!")}}catch(Ve){console.error("🎨 [ERROR] 새 디자인 생성 중 오류:",Ve),alert("새 디자인 생성 중 오류가 발생했습니다.")}},Jt=async()=>{console.log("🆕 [DEBUG] handleNewProject 함수 시작");try{const Ve=confirm("현재 작업 내용이 사라집니다. 새 디자인을 시작하시겠습니까?");if(console.log("🆕 [DEBUG] 사용자 확인 응답:",Ve),!Ve){console.log("🆕 [DEBUG] 사용자가 취소함");return}console.log("🆕 [DEBUG] 새 프로젝트 생성 시작"),h(!0);const ct={width:od.WIDTH,height:od.HEIGHT,depth:od.DEPTH,installationType:"builtin",hasFloorFinish:!1,surroundType:"surround",frameSize:{top:qA.TOP,bottom:50,left:qA.LEFT,right:qA.RIGHT},baseConfig:{type:"floor",height:VC.HEIGHT},materialConfig:{interiorColor:wm.INTERIOR_COLOR,doorColor:wm.DOOR_COLOR},columns:[]};console.log("🆕 [DEBUG] 기본 설정 준비됨:",ct);let mt;try{mt=tC(ct,0),console.log("🆕 [DEBUG] 썸네일 생성 성공")}catch(nn){console.error("🆕 [DEBUG] 썸네일 생성 실패:",nn),mt=null}const An=Ye();if(console.log("🆕 [DEBUG] Firebase 설정 확인:",An),console.log("🆕 [DEBUG] 사용자 로그인 상태:",!!n),console.log("🆕 [DEBUG] 사용자 정보:",n?{email:n.email,uid:n.uid}:"null"),An&&n){console.log("🆕 [DEBUG] Firebase 모드로 진행");try{const nn={title:"Untitled",projectData:{title:"Untitled",location:""},spaceConfig:Gt(ct),furniture:{placedModules:[]},...mt&&{thumbnail:mt}};console.log("🆕 [DEBUG] createProject 호출 시작, 정리된 데이터:",nn);const zt=await XC(nn);if(console.log("🆕 [DEBUG] createProject 결과:",zt),zt.error){console.error("🆕 [ERROR] Firebase 프로젝트 생성 실패:",zt.error),alert("새 프로젝트 생성에 실패했습니다: "+zt.error);return}zt.id?(console.log("🆕 [DEBUG] Firebase 프로젝트 생성 성공:",zt.id),x({title:"Untitled",location:""}),j(ct),D([]),f(zt.id),E.recalculateFromSpaceInfo(ct),t(`/configurator?projectId=${zt.id}`,{replace:!0}),console.log('✅ 새 Firebase 프로젝트 "Untitled" 생성 완료:',zt.id),alert("새 프로젝트가 생성되었습니다!")):(console.error("🆕 [ERROR] projectId가 반환되지 않음"),alert("프로젝트 ID를 받지 못했습니다. 다시 시도해주세요."))}catch(nn){console.error("🆕 [ERROR] Firebase 작업 중 예외:",nn),alert("Firebase 연결 중 오류가 발생했습니다: "+nn.message)}}else console.log("🆕 [ERROR] Firebase 인증 필요"),alert("새 프로젝트를 생성하려면 로그인이 필요합니다.")}catch(Ve){console.error("🆕 [ERROR] handleNewProject 최상위 예외:",Ve),alert("새 프로젝트 생성 중 예상치 못한 오류가 발생했습니다: "+Ve.message)}finally{console.log("🆕 [DEBUG] handleNewProject 완료, 저장 상태 해제"),h(!1)}},It=async()=>{const Ve=prompt("새 디자인 파일 이름을 입력하세요:",(v||S.title)+" 사본");if(Ve&&Ve.trim()){h(!0),d("idle");try{let ct=await YS();if(ct||(console.log("📸 3D 캔버스 캡처 실패, 기본 썸네일 생성"),ct=tC(C,T.length)),Ye()&&n){let mt=A;if(!mt){const{id:gn,error:Jn}=await XC({title:S.title||"새 프로젝트"});if(Jn||!gn){console.error("프로젝트 생성 실패:",Jn),d("error"),alert("프로젝트 생성에 실패했습니다: "+Jn);return}mt=gn,f(gn)}const{createDesignFile:An}=await rl(async()=>{const{createDesignFile:gn}=await Promise.resolve().then(()=>ZA);return{createDesignFile:gn}},void 0),{id:nn,error:zt}=await An({name:Ve.trim(),projectId:mt,spaceConfig:Gt(C),furniture:{placedModules:Gt(T)},thumbnail:ct});if(zt){console.error("디자인 파일 복사 저장 실패:",zt),d("error"),alert("다른이름으로 저장에 실패했습니다: "+zt);return}nn&&(g(nn),w(Ve.trim()),x({...S,title:Ve.trim()}),d("success"),setTimeout(()=>{Oe.current&&(console.log("🔄 Calling reset after successful save as"),Oe.current())},100),t(`/configurator?projectId=${mt}&designFileId=${nn}`,{replace:!0}),console.log("✅ 디자인 파일 다른이름으로 저장 성공:",Ve),alert(`"${Ve}" 디자인 파일로 저장되었습니다!`))}else console.log("💾 [ERROR] Firebase 인증 필요"),d("error"),alert("저장하려면 로그인이 필요합니다.");setTimeout(()=>d("idle"),3e3)}catch(ct){console.error("다른이름으로 저장 실패:",ct),d("error"),alert("다른이름으로 저장 중 오류가 발생했습니다.")}finally{h(!1)}}},Ut=async Ve=>{const ct=S.title;if(x({...S,title:Ve}),A){h(!0);try{if(Ye()&&n){const{error:mt}=await Oz(A,{title:Ve,projectData:Gt({...S,title:Ve}),spaceConfig:Gt(C),furniture:{placedModules:Gt(T)}});if(mt){console.error("프로젝트 이름 변경 저장 실패:",mt),x({...S,title:ct}),alert("프로젝트 이름 변경에 실패했습니다: "+mt);return}console.log("✅ 프로젝트 이름 변경 성공:",Ve)}else console.log("💾 [ERROR] Firebase 인증 필요"),x({...S,title:ct}),alert("프로젝트 이름을 변경하려면 로그인이 필요합니다.")}catch(mt){console.error("프로젝트 이름 변경 실패:",mt),x({...S,title:ct}),alert("프로젝트 이름 변경 중 오류가 발생했습니다.")}finally{h(!1)}}};H.useEffect(()=>{const Ve=e.get("designFileName")||e.get("fileName");if(console.log("🔍 URL에서 가져온 designFileName:",Ve),console.log("🔍 현재 basicInfo.title:",S.title),Ve){const ct=decodeURIComponent(Ve);w(ct),console.log("📝 URL 파라미터로 디자인파일명 설정:",ct)}else S.title?(w(S.title),console.log("📝 프로젝트명으로 디자인파일명 설정:",S.title)):(w("새로운 디자인"),console.log("📝 기본값으로 디자인파일명 설정: 새로운 디자인"))},[e,S.title]),H.useEffect(()=>{var Ve;if(!((Ve=C.droppedCeiling)!=null&&Ve.enabled)&&C.customColumnCount){const ct=Kr(C),mt=Xr.getDefaultColumnCount(ct.width);console.log("🔧 [Configurator] Dropped ceiling disabled, checking column count:",{currentColumnCount:C.customColumnCount,defaultColumnCount:mt,internalWidth:ct.width}),C.customColumnCount!==mt&&(console.log("🔧 [Configurator] Resetting column count to default:",mt),j({customColumnCount:mt,mainDoorCount:void 0,droppedCeilingDoorCount:void 0}))}},[(Tr=C.droppedCeiling)==null?void 0:Tr.enabled]),H.useEffect(()=>{const Ve=sessionStorage.getItem("configurator_state_backup");if(Ve)try{const Jn=JSON.parse(Ve);console.log("🔄 Configurator 상태 복원 시작"),x(Jn.basicInfo),j(Jn.spaceInfo),D(Jn.placedModules),f(Jn.projectId),g(Jn.designFileId),I(Jn.projectId),sessionStorage.removeItem("configurator_state_backup"),y(!0),a(!1),console.log("✅ Configurator 상태 복원 완료");return}catch(Jn){console.error("상태 복원 실패:",Jn),sessionStorage.removeItem("configurator_state_backup")}const ct=e.get("projectId")||e.get("id")||e.get("project"),mt=e.get("designFileId"),An=e.get("designFileName"),nn=e.get("mode"),zt=e.get("skipLoad")==="true",gn=e.get("design")==="new";if(ct&&mt){if(console.log("📋 Step2에서 넘어옴 - designFileId:",mt),A===ct&&p===mt&&m){console.log("🔄 동일한 프로젝트/디자인 - 재로드 건너뜀"),a(!1);return}f(ct),I(ct),g(mt),(async()=>{var Qn,pn,Ln,Dn,ei,xi;a(!0);try{const{getDesignFileById:Yi}=await rl(async()=>{const{getDesignFileById:xt}=await Promise.resolve().then(()=>ZA);return{getDesignFileById:xt}},void 0),{designFile:Bn,error:Ri}=await Yi(mt);if(Ri){console.error("디자인 파일 로드 에러:",Ri),alert("디자인 파일을 불러오는데 실패했습니다: "+Ri),t("/dashboard");return}if(Bn){console.log("✅ 디자인 파일 로드 성공:",Bn.name),x({title:Bn.name||"새 디자인",location:""}),w(Bn.name);const xt={...Bn.spaceConfig};xt.installType==="built-in"&&(xt.installType="builtin"),typeof xt.columns=="number"&&(xt.columns=[]),typeof xt.rows=="number"&&(xt.rows=[]),j(xt);const Bt=sessionStorage.getItem("cnc_furniture_backup");if(Bt&&fromCNC)try{const on=JSON.parse(Bt);console.log("✅ CNC 백업 데이터 사용:",on.length,"개"),D(on),sessionStorage.removeItem("cnc_furniture_backup")}catch(on){console.error("백업 데이터 복원 실패:",on),(Qn=Bn.furniture)!=null&&Qn.placedModules?D(Bn.furniture.placedModules):D([])}else console.log("🪑 디자인 파일 가구 데이터 로드:",{hasFurniture:!!Bn.furniture,hasPlacedModules:!!((pn=Bn.furniture)!=null&&pn.placedModules),placedModulesCount:((Dn=(Ln=Bn.furniture)==null?void 0:Ln.placedModules)==null?void 0:Dn.length)||0,placedModules:(ei=Bn.furniture)==null?void 0:ei.placedModules}),(xi=Bn.furniture)!=null&&xi.placedModules?(console.log("🪑 [LOAD] 가구 데이터 설정 중:",Bn.furniture.placedModules),console.trace("🪑 [TRACE] setPlacedModules 호출 스택"),D(Bn.furniture.placedModules),console.log("🪑 [LOAD] 가구 데이터 설정 완료")):(console.log("⚠️ [EMPTY] 가구 데이터가 없어서 빈 배열로 초기화"),console.trace("⚠️ [TRACE] setPlacedModules([]) 호출 스택"),D([]));y(!0),a(!1)}}catch(Yi){console.error("디자인 파일 로드 중 오류:",Yi),alert("디자인 파일 로드 중 오류가 발생했습니다."),a(!1)}})();return}if(ct&&An){console.log("📋 디자인명으로 진입 - designFileName:",An),f(ct),I(ct),w(decodeURIComponent(An)),(async()=>{var Qn,pn,Ln,Dn,ei;a(!0);try{const{getDesignFiles:xi}=await rl(async()=>{const{getDesignFiles:Bt}=await Promise.resolve().then(()=>ZA);return{getDesignFiles:Bt}},void 0),{designFiles:Yi,error:Bn}=await xi(ct);if(Bn){console.error("디자인 파일 목록 로드 에러:",Bn),vt(ct);return}const Ri=decodeURIComponent(An),xt=Yi.find(Bt=>Bt.name===Ri);if(xt){console.log("✅ 디자인 파일 찾음:",xt.id,xt.name),g(xt.id),x({title:xt.name||"새 디자인",location:""});const Bt={...xt.spaceConfig};Bt.installType==="built-in"&&(Bt.installType="builtin"),typeof Bt.columns=="number"&&(Bt.columns=[]),typeof Bt.rows=="number"&&(Bt.rows=[]),j(Bt);const on=sessionStorage.getItem("cnc_furniture_backup");if(on&&fromCNC)try{const ln=JSON.parse(on);console.log("✅ CNC 백업 데이터 사용 (디자인명 로드):",ln.length,"개"),D(ln),sessionStorage.removeItem("cnc_furniture_backup")}catch(ln){console.error("백업 데이터 복원 실패:",ln),(Qn=xt.furniture)!=null&&Qn.placedModules?D(xt.furniture.placedModules):D([])}else console.log("🪑 디자인 파일 가구 데이터 로드:",{hasFurniture:!!xt.furniture,hasPlacedModules:!!((pn=xt.furniture)!=null&&pn.placedModules),placedModulesCount:((Dn=(Ln=xt.furniture)==null?void 0:Ln.placedModules)==null?void 0:Dn.length)||0}),(ei=xt.furniture)!=null&&ei.placedModules?D(xt.furniture.placedModules):D([]);a(!1)}else console.log("⚠️ 디자인 파일을 찾을 수 없음, 프로젝트 로드 시도"),vt(ct)}catch(xi){console.error("디자인 파일 로드 중 오류:",xi),vt(ct)}})();return}ct&&ct!==A?(f(ct),I(ct),zt||gn?(console.log("✅ skipLoad=true 또는 design=new - Step 1-3에서 설정한 데이터 유지"),console.log("🔍 현재 spaceInfo:",C),console.log("🔍 현재 basicInfo:",S),gn?Qy(ct).then(({project:Jn,error:Qn})=>{Jn&&!Qn&&(x({title:Jn.title,location:Jn.location||""}),console.log("📝 새 디자인 - 프로젝트 정보 설정:",Jn.title)),a(!1)}):setTimeout(()=>{a(!1)},500)):nn==="new-design"?(console.log("🎨 기존 프로젝트에 새 디자인 생성:",ct),Qy(ct).then(({project:Jn,error:Qn})=>{Jn&&!Qn&&(console.log("🔍 setBasicInfo 호출 전 basicInfo:",S),console.log("🔍 설정할 프로젝트명:",Jn.title),x({title:Jn.title}),console.log("📝 프로젝트명 설정:",Jn.title)),a(!1)})):vt(ct)):setTimeout(()=>{a(!1)},500)},[e,i.state]),H.useEffect(()=>{const Ve=async()=>{if(!(!A||!n))try{const{loadFolderData:mt}=await rl(async()=>{const{loadFolderData:nn}=await Promise.resolve().then(()=>ZA);return{loadFolderData:nn}},void 0),An=await mt(A);if(An.folders&&An.folders.length>0){for(const nn of An.folders)if(nn.children&&nn.children.length>0){const zt=nn.children[0];if(zt&&zt.name){console.log("📝 폴더에서 찾은 디자인파일명:",zt.name),w(zt.name);return}}}S.title&&v==="새로운 디자인"&&(w(S.title),console.log("📝 폴더에 디자인파일이 없어서 프로젝트명 사용:",S.title))}catch(mt){console.error("폴더 데이터 로드 실패:",mt)}};!(e.get("designFileName")||e.get("fileName"))&&A&&n&&Ve()},[A,n,S.title,v,e]),H.useEffect(()=>{if(JSON.stringify(st)!==JSON.stringify(C)){const Ve={...st},ct={...C};delete Ve.materialConfig,delete ct.materialConfig,(Ve.width!==ct.width||Ve.height!==ct.height||Ve.depth!==ct.depth||Ve.customColumnCount!==ct.customColumnCount||JSON.stringify(Ve.droppedCeiling)!==JSON.stringify(ct.droppedCeiling)||Ve.mainDoorCount!==ct.mainDoorCount||Ve.droppedCeilingDoorCount!==ct.droppedCeilingDoorCount||JSON.stringify(Ve.frameSize)!==JSON.stringify(ct.frameSize)||JSON.stringify(Ve.gapConfig)!==JSON.stringify(ct.gapConfig)||JSON.stringify(Ve.baseConfig)!==JSON.stringify(ct.baseConfig)||Ve.surroundType!==ct.surroundType||Ve.installType!==ct.installType||JSON.stringify(Ve.wallConfig)!==JSON.stringify(ct.wallConfig)||Ve.hasFloorFinish!==ct.hasFloorFinish||JSON.stringify(Ve.floorFinish)!==JSON.stringify(ct.floorFinish))&&(console.log("🔄 공간 구조가 변경되었습니다. 가구 재배치 실행 중...",{width:Ve.width!==ct.width,height:Ve.height!==ct.height,depth:Ve.depth!==ct.depth,customColumnCount:Ve.customColumnCount!==ct.customColumnCount,droppedCeiling:JSON.stringify(Ve.droppedCeiling)!==JSON.stringify(ct.droppedCeiling),mainDoorCount:Ve.mainDoorCount!==ct.mainDoorCount,droppedCeilingDoorCount:Ve.droppedCeilingDoorCount!==ct.droppedCeilingDoorCount,prevDroppedCeiling:Ve.droppedCeiling,currentDroppedCeiling:ct.droppedCeiling}),z(st,C)),At(C)}},[C,st,z]),H.useEffect(()=>{E.isCalculated||(console.log("🔄 derivedSpaceStore 강제 재계산 (컬럼 수 동기화)"),E.recalculateFromSpaceInfo(C))},[C,E]),H.useEffect(()=>(window.handleSpaceInfoUpdate=Sn,()=>{delete window.handleSpaceInfoUpdate}),[]);const un=Ve=>{Be(ue===Ve?null:Ve)},Sn=Ve=>{var An,nn,zt,gn,Jn,Qn;console.log("🔧 handleSpaceInfoUpdate called with:",Ve),console.log("🔧 Current spaceInfo.wallConfig:",C.wallConfig),Ve.mainDoorCount!==void 0&&console.log("🚪 mainDoorCount 업데이트:",{이전값:C.mainDoorCount,새값:Ve.mainDoorCount,단내림활성화:(An=C.droppedCeiling)==null?void 0:An.enabled});const ct=Ve.droppedCeiling!==void 0;ct&&console.log("🔄 단내림 설정 변경 감지:",Ve.droppedCeiling),Ve.surroundType&&console.log("🔧 Configurator - surroundType update:",{previous:C.surroundType,new:Ve.surroundType,willUpdateStore:!0});let mt={...Ve};if(mt.installType==="built-in"&&(mt.installType="builtin"),Ve.surroundType){const pn=mt.installType||C.installType,Ln=mt.wallConfig||C.wallConfig,Dn={...C.frameSize,top:((nn=C.frameSize)==null?void 0:nn.top)||10};if(Ve.surroundType==="surround")switch(pn){case"builtin":Dn.left=50,Dn.right=50;break;case"semistanding":Ln.left&&!Ln.right?(Dn.left=50,Dn.right=18):!Ln.left&&Ln.right&&(Dn.left=18,Dn.right=50);break;case"freestanding":Dn.left=18,Dn.right=18;break}else if(Ve.surroundType==="no-surround"){switch(pn){case"builtin":Dn.left=0,Dn.right=0;break;case"semistanding":Ln.left&&!Ln.right?(Dn.left=0,Dn.right=18):!Ln.left&&Ln.right&&(Dn.left=18,Dn.right=0);break;case"freestanding":Dn.left=18,Dn.right=18;break}mt.gapConfig={left:Ln.left?2:0,right:Ln.right?2:0}}mt.frameSize=Dn,console.log("🔧 서라운드 타입 변경에 따른 프레임 초기화:",{surroundType:Ve.surroundType,installType:pn,frameSize:Dn,gapConfig:mt.gapConfig})}if(Ve.wallConfig&&C.installType==="semistanding"&&C.surroundType==="surround"){const pn={...C.frameSize};Ve.wallConfig.left&&!Ve.wallConfig.right?(pn.left=50,pn.right=18):!Ve.wallConfig.left&&Ve.wallConfig.right&&(pn.left=18,pn.right=50),mt.frameSize=pn,console.log("🔧 세미스탠딩 프레임 자동 업데이트:",pn)}if(Ve.installType){if(Ve.wallConfig)console.log("🔧 InstallTypeControls에서 전달된 wallConfig 사용:",Ve.wallConfig),mt.wallConfig=Ve.wallConfig;else{switch(Ve.installType){case"builtin":mt.wallConfig={left:!0,right:!0};break;case"semistanding":mt.wallConfig={left:!0,right:!1};break;case"freestanding":mt.wallConfig={left:!1,right:!1};break}console.log("🔧 자동 설정된 wallConfig:",mt.wallConfig)}const pn={...C.frameSize},Ln=mt.wallConfig||C.wallConfig;if(C.surroundType==="surround")switch(Ve.installType){case"builtin":pn.left=50,pn.right=50;break;case"semistanding":Ln.left&&!Ln.right?(pn.left=50,pn.right=18):!Ln.left&&Ln.right&&(pn.left=18,pn.right=50);break;case"freestanding":pn.left=18,pn.right=18;break}else if(C.surroundType==="no-surround"){switch(Ve.installType){case"builtin":pn.left=0,pn.right=0;break;case"semistanding":Ln.left&&!Ln.right?(pn.left=0,pn.right=18):!Ln.left&&Ln.right&&(pn.left=18,pn.right=0);break;case"freestanding":pn.left=18,pn.right=18;break}mt.gapConfig={left:Ln.left?2:0,right:Ln.right?2:0}}mt.frameSize=pn,console.log("🔧 설치타입 변경에 따른 wallConfig 및 프레임 자동 업데이트:",{installType:Ve.installType,wallConfig:mt.wallConfig,frameSize:mt.frameSize})}if(Ve.width&&Ve.width!==C.width){const pn=Xt(Ve.width),Ln=C.customColumnCount||Yt(),Dn=Ve.width-100;let ei=Ln;const xi=Dn/Ln;xi<400?ei=Math.floor(Dn/400):xi>600&&(ei=Math.ceil(Dn/600));const Yi=Math.max(pn.min,Math.min(pn.max,ei));mt={...mt,customColumnCount:Yi}}if(Ve.customColumnCount){const pn=mt.width||C.width||4800,Ln=Xt(pn),Dn=pn-100,ei=Dn/Ve.customColumnCount;if(ei<400||ei>600){const xi=Math.max(Ln.min,Math.min(Ln.max,ei<400?Math.floor(Dn/400):Math.ceil(Dn/600)));mt={...mt,customColumnCount:xi}}}if((zt=Ve.droppedCeiling)!=null&&zt.enabled&&!((gn=C.droppedCeiling)!=null&&gn.enabled)){const pn=mt.width||C.width||4800,Ln=Ve.droppedCeiling.width||ea.WIDTH,xi=pn-Ln-50,Yi=600,Bn=Math.ceil(xi/Yi),Ri=Yt(),xt=Math.max(Bn,Ri);console.log(`🔧 단내림 활성화 시 메인 구간 도어 개수 설정: ${Ri} → ${xt}`),mt={...mt,mainDoorCount:xt};const on=Ln-50,ln=Math.max(1,Math.ceil(on/Yi)),li=Math.max(ln,Math.floor(on/400)),hi=ln;console.log(`🔧 단내림 활성화 시 단내림 구간 도어개수 기본값 설정: ${hi}`,{droppedWidth:Ln,droppedInternalWidth:on,droppedMinSlots:ln,droppedMaxSlots:li}),mt={...mt,droppedCeilingDoorCount:hi}}if((Jn=Ve.droppedCeiling)!=null&&Jn.width&&((Qn=C.droppedCeiling)!=null&&Qn.enabled)){const Ln=Ve.droppedCeiling.width-50,xi={min:Math.max(1,Math.ceil(Ln/600)),max:Math.max(1,Math.floor(Ln/400))},Yi=C.droppedCeilingDoorCount||2;if(Yi<xi.min||Yi>xi.max){const Bn=Math.max(xi.min,Math.min(xi.max,Yi));console.log(`🔧 단내림 폭 변경 시 도어개수 자동 조정: ${Yi} → ${Bn}`),mt={...mt,droppedCeilingDoorCount:Bn}}}console.log("🔧 최종 업데이트 적용:",{updates:mt,hasWallConfig:!!mt.wallConfig,wallConfig:mt.wallConfig}),mt.installType!==void 0&&(mt.installType,C.installType),j(mt),ct&&(console.log("🔄 단내림 설정 변경으로 3D 뷰 강제 업데이트"),setTimeout(()=>{L(te)},0))},jt=()=>{console.log("🚪 도어 설치/제거 핸들러 호출:",{hasDoorsInstalled:sn,placedModulesCount:T.length,doorsOpen:O}),sn?(console.log("🚪 도어 제거 시도"),k(!1)):(console.log("🚪 도어 설치 시도"),k(!0),O&&(console.log("🚪 도어가 열려있어서 닫기"),J()))},fn=()=>{t("/dashboard?step=2")},Zn=()=>{window.open("/help","_blank")},Hn=async()=>{console.log("도면 편집기 열기");try{const ct=await YS();ct&&nt({top:ct,front:ct,side:ct,iso:ct})}catch(ct){console.error("뷰 캡처 실패:",ct)}const Ve=new URLSearchParams(e.toString());Ve.set("editor","drawing"),window.history.replaceState(null,"",`${window.location.pathname}?${Ve.toString()}`),ye(!0)},ti=()=>{t("/login")},ri=()=>{console.log("프로필")},bi=()=>{et(!Me)},Ni=()=>{if(console.log("📐 DXF 내보내기 팝업 열기..."),!C){alert("공간 정보가 없습니다. 먼저 공간을 설정해주세요.");return}_t(!0)},ui=()=>{if(console.log("📄 PDF 내보내기 팝업 열기..."),!C){alert("공간 정보가 없습니다. 먼저 공간을 설정해주세요.");return}_t(!0)};H.useEffect(()=>{typeof window<"u"&&(window.testExportDXFZIP=Ni,window.testExportPDF=ui,window.getCurrentSpaceInfo=()=>C,window.getCurrentPlacedModules=()=>T)},[C,T,Ni,ui]);const si=()=>{if(!ue)return null;switch(ue){case"module":return c.jsx("div",{className:dn.sidebarPanel,children:c.jsxs("div",{className:dn.modulePanelContent,children:[c.jsxs("div",{className:dn.moduleCategoryTabs,children:[c.jsx("button",{className:`${dn.moduleCategoryTab} ${He==="tall"?dn.active:""}`,onClick:()=>ze("tall"),children:r("furniture.tallCabinet")}),c.jsx("button",{className:`${dn.moduleCategoryTab} ${He==="upper"?dn.active:""}`,onClick:()=>ze("upper"),children:r("furniture.upperCabinet")}),c.jsx("button",{className:`${dn.moduleCategoryTab} ${He==="lower"?dn.active:""}`,onClick:()=>ze("lower"),children:r("furniture.lowerCabinet")})]}),c.jsx("div",{className:dn.moduleSection,children:c.jsx(S5e,{moduleCategory:He})})]})});case"material":return c.jsx("div",{className:dn.sidebarPanel,children:c.jsx(u4e,{})});case"structure":return c.jsx("div",{className:dn.sidebarPanel,children:c.jsx(w4e,{columns:C.columns||[],onColumnsChange:Ve=>j({columns:Ve})})});case"etc":return c.jsx("div",{className:dn.sidebarPanel,children:c.jsxs("div",{className:dn.preparingPanel,children:[c.jsx("h3",{children:r("sidebar.accessories")}),c.jsx("p",{children:r("sidebar.preparing")})]})});default:return null}},Li=()=>{var Ve,ct,mt,An,nn,zt,gn,Jn,Qn,pn,Ln,Dn,ei,xi,Yi,Bn,Ri,xt,Bt,on,ln,li,hi,Ii,kr,zr,Us,io,ws,Ts;return it==="module"?c.jsx("div",{className:dn.moduleContent,children:c.jsx(x3e,{})}):c.jsxs("div",{className:dn.spaceControls,children:[c.jsxs("div",{className:dn.configSection,children:[c.jsxs("div",{className:dn.sectionHeader,children:[c.jsx("span",{className:dn.sectionDot}),c.jsx("h3",{className:dn.sectionTitle,children:r("space.title")})]}),c.jsxs("div",{style:{display:"flex",gap:"12px"},children:[c.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx("span",{style:{minWidth:"20px",color:"var(--theme-primary)"},children:"W"}),c.jsx("div",{style:{flex:1},children:c.jsx(HQ,{spaceInfo:C,onUpdate:Sn,disabled:Zt})})]}),c.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx("span",{style:{minWidth:"20px",color:"var(--theme-primary)"},children:"H"}),c.jsx("div",{style:{flex:1},children:c.jsx(WQ,{spaceInfo:C,onUpdate:Sn})})]})]})]}),c.jsxs("div",{className:dn.configSection,children:[c.jsxs("div",{className:dn.sectionHeader,children:[c.jsx("span",{className:dn.sectionDot}),c.jsx("h3",{className:dn.sectionTitle,children:r("space.droppedCeiling")})]}),c.jsxs("div",{className:dn.toggleButtonGroup,children:[c.jsx("button",{className:`${dn.toggleButton} ${(Ve=C.droppedCeiling)!=null&&Ve.enabled?"":dn.toggleButtonActive}`,onClick:()=>{Sn({droppedCeiling:{...C.droppedCeiling,enabled:!1},mainDoorCount:void 0,droppedCeilingDoorCount:void 0})},children:r("common.none")}),c.jsx("button",{className:`${dn.toggleButton} ${(ct=C.droppedCeiling)!=null&&ct.enabled?dn.toggleButtonActive:""}`,onClick:()=>{var Mn;if(!((Mn=C.droppedCeiling)!=null&&Mn.enabled)){const ve=C.width||4800,Re=900,Ke=ve-Re,Ge=Xt(Ke),pt=Yt(),Pt=Math.max(Ge.min,Math.min(Ge.max,pt)),xe=Re-50,at=Xr.getDefaultColumnCount(xe);Sn({droppedCeiling:{enabled:!0,width:Re,dropHeight:200,position:"right"},droppedCeilingDoorCount:at,mainDoorCount:Pt})}},children:r("common.enabled")})]}),((mt=C.droppedCeiling)==null?void 0:mt.enabled)&&c.jsxs("div",{style:{marginTop:"16px"},children:[c.jsx("div",{className:dn.inputLabel,style:{marginBottom:"8px"},children:r("placement.droppedCeilingPosition")}),c.jsxs("div",{className:dn.toggleButtonGroup,children:[c.jsx("button",{className:`${dn.toggleButton} ${(((An=C.droppedCeiling)==null?void 0:An.position)||"right")==="left"?dn.toggleButtonActive:""}`,onClick:()=>{Sn({droppedCeiling:{...C.droppedCeiling,enabled:!0,position:"left"}})},children:r("furniture.left")}),c.jsx("button",{className:`${dn.toggleButton} ${(((nn=C.droppedCeiling)==null?void 0:nn.position)||"right")==="right"?dn.toggleButtonActive:""}`,onClick:()=>{Sn({droppedCeiling:{...C.droppedCeiling,enabled:!0,position:"right"}})},children:r("furniture.right")})]})]})]}),((zt=C.droppedCeiling)==null?void 0:zt.enabled)&&c.jsxs("div",{className:dn.configSection,children:[c.jsxs("div",{className:dn.sectionHeader,children:[c.jsx("span",{className:dn.sectionDot}),c.jsx("h3",{className:dn.sectionTitle,children:r("space.mainSectionSize")})]}),c.jsxs("div",{style:{display:"flex",gap:"12px"},children:[c.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx("span",{style:{minWidth:"20px",color:"var(--theme-primary)"},children:"W"}),c.jsxs("div",{className:dn.inputWithUnit,style:{flex:1},children:[c.jsx("input",{type:"text",min:"100",max:(C.width||4800)-100,step:"10",defaultValue:(C.width||4800)-(((gn=C.droppedCeiling)==null?void 0:gn.width)||ea.WIDTH),onKeyDown:Mn=>{Mn.key==="Enter"&&(Mn.preventDefault(),Mn.target.blur())},onBlur:Mn=>{var pe;const ve=Mn.target.value,Re=C.width||4800,Ke=((pe=C.droppedCeiling)==null?void 0:pe.width)||ea.WIDTH,Ge=Re-Ke;if(ve===""||isNaN(parseInt(ve))){Mn.target.value=Ge.toString();return}const pt=parseInt(ve),Pt=Re-pt;Pt<100?(Mn.target.value=(Re-100).toString(),Sn({droppedCeiling:{...C.droppedCeiling,enabled:!0,width:100}})):Pt>Re-100?(Mn.target.value="100",Sn({droppedCeiling:{...C.droppedCeiling,enabled:!0,width:Re-100}})):Sn({droppedCeiling:{...C.droppedCeiling,enabled:!0,width:Pt}})},className:`${dn.input} ${dn.inputWithUnitField}`},`main-width-${(C.width||4800)-(((Jn=C.droppedCeiling)==null?void 0:Jn.width)||ea.WIDTH)}`),c.jsx("span",{className:dn.unit,children:"mm"})]})]}),c.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx("span",{style:{minWidth:"20px",color:"var(--theme-primary)"},children:"H"}),c.jsxs("div",{className:dn.inputWithUnit,style:{flex:1},children:[c.jsx("input",{type:"text",defaultValue:C.height||2400,onChange:Mn=>{Mn.target.value},onBlur:Mn=>{const ve=Mn.target.value;if(ve===""){Mn.target.value=(C.height||2400).toString();return}const Re=parseInt(ve),Ke=1800,Ge=3e3;Re<Ke?(Mn.target.value=Ke.toString(),Sn({height:Ke})):Re>Ge?(Mn.target.value=Ge.toString(),Sn({height:Ge})):Sn({height:Re})},onKeyDown:Mn=>{if(Mn.key==="Enter")Mn.preventDefault(),Mn.target.blur();else if(Mn.key==="ArrowUp"||Mn.key==="ArrowDown"){Mn.preventDefault();const ve=parseInt(Mn.target.value)||C.height||2400,Re=1800,Ke=3e3;let Ge;Mn.key==="ArrowUp"?Ge=Math.min(ve+1,Ke):Ge=Math.max(ve-1,Re),Ge!==ve&&(Mn.target.value=Ge.toString(),Sn({height:Ge}))}},className:`${dn.input} ${dn.inputWithUnitField}`,placeholder:"1800-3000"},`main-height-${C.height||2400}`),c.jsx("span",{className:dn.unit,children:"mm"})]})]})]})]}),((Qn=C.droppedCeiling)==null?void 0:Qn.enabled)&&c.jsxs("div",{className:dn.configSection,children:[c.jsxs("div",{className:dn.sectionHeader,children:[c.jsx("span",{className:dn.sectionDot}),c.jsx("h3",{className:dn.sectionTitle,children:r("space.droppedSectionSize")})]}),c.jsxs("div",{style:{display:"flex",gap:"12px"},children:[c.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx("span",{style:{minWidth:"20px",color:"var(--theme-primary)"},children:"W"}),c.jsxs("div",{className:dn.inputWithUnit,style:{flex:1},children:[c.jsx("input",{type:"text",min:"100",max:(C.width||4800)-100,step:"10",defaultValue:((pn=C.droppedCeiling)==null?void 0:pn.width)||ea.WIDTH,onKeyDown:Mn=>{Mn.key==="Enter"&&(Mn.preventDefault(),Mn.target.blur())},onBlur:Mn=>{var pt;const ve=Mn.target.value,Re=C.width||4800,Ke=((pt=C.droppedCeiling)==null?void 0:pt.width)||ea.WIDTH;if(ve===""||isNaN(parseInt(ve))){Mn.target.value=Ke.toString();return}const Ge=parseInt(ve);Ge<100?(Mn.target.value="100",Sn({droppedCeiling:{...C.droppedCeiling,enabled:!0,width:100}})):Ge>Re-100?(Mn.target.value=(Re-100).toString(),Sn({droppedCeiling:{...C.droppedCeiling,enabled:!0,width:Re-100}})):Sn({droppedCeiling:{...C.droppedCeiling,enabled:!0,width:Ge}})},className:`${dn.input} ${dn.inputWithUnitField}`},`dropped-width-${((Ln=C.droppedCeiling)==null?void 0:Ln.width)||ea.WIDTH}`),c.jsx("span",{className:dn.unit,children:"mm"})]})]}),c.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx("span",{style:{minWidth:"20px",color:"var(--theme-primary)"},children:"H"}),c.jsxs("div",{className:dn.inputWithUnit,style:{flex:1},children:[c.jsx("input",{type:"text",min:"1800",max:"2900",step:"10",defaultValue:(C.height||2400)-(((Dn=C.droppedCeiling)==null?void 0:Dn.dropHeight)||200),onKeyDown:Mn=>{Mn.key==="Enter"&&(Mn.preventDefault(),Mn.target.blur())},onBlur:Mn=>{var Pt;const ve=Mn.target.value,Re=C.height||2400,Ke=Re-(((Pt=C.droppedCeiling)==null?void 0:Pt.dropHeight)||200);if(ve===""||isNaN(parseInt(ve))){Mn.target.value=Ke.toString();return}const Ge=parseInt(ve),pt=Re-Ge;if(pt<100){const pe=Re-100;Mn.target.value=pe.toString(),Sn({droppedCeiling:{...C.droppedCeiling,enabled:!0,dropHeight:100}})}else if(pt>500){const pe=Re-500;Mn.target.value=pe.toString(),Sn({droppedCeiling:{...C.droppedCeiling,enabled:!0,dropHeight:500}})}else Sn({droppedCeiling:{...C.droppedCeiling,enabled:!0,dropHeight:pt}})},className:`${dn.input} ${dn.inputWithUnitField}`},`dropped-height-${(C.height||2400)-(((ei=C.droppedCeiling)==null?void 0:ei.dropHeight)||200)}`),c.jsx("span",{className:dn.unit,children:"mm"})]})]})]})]}),c.jsxs("div",{className:dn.configSection,children:[c.jsxs("div",{className:dn.sectionHeader,children:[c.jsx("span",{className:dn.sectionDot}),c.jsx("h3",{className:dn.sectionTitle,children:r("space.columnCount")})]}),console.log("🔍 레이아웃 섹션 렌더링:",{activeTab:it,단내림활성화:(xi=C.droppedCeiling)==null?void 0:xi.enabled,mainDoorCount:C.mainDoorCount,customColumnCount:C.customColumnCount}),(Yi=C.droppedCeiling)!=null&&Yi.enabled?c.jsxs("div",{children:[c.jsx("div",{className:dn.inputGroup,children:c.jsx(eT,{value:C.mainDoorCount||Yt(),onChange:Mn=>{Sn({mainDoorCount:Mn})},width:C.width||4800})}),c.jsx("div",{className:dn.inputGroup,style:{marginTop:"24px"},children:c.jsx(eT,{value:C.droppedCeilingDoorCount||1,onChange:Mn=>{Sn({droppedCeilingDoorCount:Mn})},width:((Bn=C.droppedCeiling)==null?void 0:Bn.width)||ea.WIDTH})})]}):c.jsx("div",{className:dn.inputGroup,children:c.jsx(eT,{value:Yt(),onChange:Mn=>{Sn({customColumnCount:Mn})},width:C.width||4800})})]}),c.jsxs("div",{className:dn.configSection,children:[c.jsxs("div",{className:dn.sectionHeader,children:[c.jsx("span",{className:dn.sectionDot}),c.jsx("h3",{className:dn.sectionTitle,children:r("space.installType")})]}),c.jsx(N8e,{spaceInfo:C,onUpdate:Sn})]}),c.jsxs("div",{className:dn.configSection,children:[c.jsxs("div",{className:dn.sectionHeader,children:[c.jsx("span",{className:dn.sectionDot}),c.jsx("h3",{className:dn.sectionTitle,children:r("frame.title")})]}),c.jsxs("div",{className:dn.toggleButtonGroup,children:[c.jsx("button",{className:`${dn.toggleButton} ${(C.surroundType||"surround")==="surround"?dn.active:""}`,onClick:()=>Sn({surroundType:"surround"}),children:r("space.surround")}),c.jsx("button",{className:`${dn.toggleButton} ${(C.surroundType||"surround")==="no-surround"?dn.active:""}`,onClick:()=>Sn({surroundType:"no-surround"}),children:r("space.noSurround")})]}),(C.surroundType||"surround")==="surround"&&c.jsxs("div",{className:dn.subSetting,children:[c.jsx("label",{className:dn.subLabel,children:r("frame.frameWidth")}),c.jsxs("div",{className:dn.frameGrid,children:[c.jsxs("div",{className:dn.frameItem,children:[c.jsx("label",{className:dn.frameItemLabel,children:C.installType==="builtin"||C.installType==="semistanding"&&((Ri=C.wallConfig)!=null&&Ri.left)?r("furniture.left"):C.installType==="semistanding"&&!((xt=C.wallConfig)!=null&&xt.left)?`${r("furniture.left")}(${r("frame.endPanel")})`:C.installType==="freestanding"?`${r("furniture.left")}(${r("frame.endPanel")})`:r("furniture.left")}),c.jsxs("div",{className:dn.frameItemInput,children:[c.jsx("button",{className:dn.frameButton,onClick:()=>{var Re;const Mn=((Re=C.frameSize)==null?void 0:Re.left)||50,ve=Math.max(10,Mn-1);ft("left",ve)},disabled:C.installType==="semistanding"&&!((Bt=C.wallConfig)!=null&&Bt.left)||C.installType==="freestanding",children:"−"}),c.jsx("input",{type:"number",min:"10",max:"100",value:((on=C.frameSize)==null?void 0:on.left)||50,onChange:Mn=>{const ve=Math.min(100,Math.max(10,parseInt(Mn.target.value)||50));ft("left",ve)},onFocus:()=>X("left"),onBlur:()=>X(null),className:dn.frameNumberInput,disabled:C.installType==="semistanding"&&!((ln=C.wallConfig)!=null&&ln.left)||C.installType==="freestanding"}),c.jsx("button",{className:dn.frameButton,onClick:()=>{var Re;const Mn=((Re=C.frameSize)==null?void 0:Re.left)||50,ve=Math.min(100,Mn+1);ft("left",ve)},disabled:C.installType==="semistanding"&&!((li=C.wallConfig)!=null&&li.left)||C.installType==="freestanding",children:"+"})]})]}),c.jsxs("div",{className:dn.frameItem,children:[c.jsx("label",{className:dn.frameItemLabel,children:C.installType==="builtin"||C.installType==="semistanding"&&((hi=C.wallConfig)!=null&&hi.right)?r("furniture.right"):C.installType==="semistanding"&&!((Ii=C.wallConfig)!=null&&Ii.right)?`${r("furniture.right")}(${r("frame.endPanel")})`:C.installType==="freestanding"?`${r("furniture.right")}(${r("frame.endPanel")})`:r("furniture.right")}),c.jsxs("div",{className:dn.frameItemInput,children:[c.jsx("button",{className:dn.frameButton,onClick:()=>{var Re;const Mn=((Re=C.frameSize)==null?void 0:Re.right)||50,ve=Math.max(10,Mn-1);ft("right",ve)},disabled:C.installType==="semistanding"&&!((kr=C.wallConfig)!=null&&kr.right)||C.installType==="freestanding",children:"−"}),c.jsx("input",{type:"number",min:"10",max:"100",value:((zr=C.frameSize)==null?void 0:zr.right)||50,onChange:Mn=>{const ve=Math.min(100,Math.max(10,parseInt(Mn.target.value)||50));ft("right",ve)},onFocus:()=>X("right"),onBlur:()=>X(null),className:dn.frameNumberInput,disabled:C.installType==="semistanding"&&!((Us=C.wallConfig)!=null&&Us.right)||C.installType==="freestanding"}),c.jsx("button",{className:dn.frameButton,onClick:()=>{var Re;const Mn=((Re=C.frameSize)==null?void 0:Re.right)||50,ve=Math.min(100,Mn+1);ft("right",ve)},disabled:C.installType==="semistanding"&&!((io=C.wallConfig)!=null&&io.right)||C.installType==="freestanding",children:"+"})]})]}),c.jsxs("div",{className:dn.frameItem,children:[c.jsx("label",{className:dn.frameItemLabel,children:r("viewer.top")}),c.jsxs("div",{className:dn.frameItemInput,children:[c.jsx("button",{className:dn.frameButton,onClick:()=>{var Re;const Mn=((Re=C.frameSize)==null?void 0:Re.top)||50,ve=Math.max(10,Mn-1);ft("top",ve)},children:"−"}),c.jsx("input",{type:"number",min:"10",max:"100",value:((ws=C.frameSize)==null?void 0:ws.top)||50,onChange:Mn=>{const ve=Math.min(100,Math.max(10,parseInt(Mn.target.value)||50));ft("top",ve)},onFocus:()=>X("top"),onBlur:()=>X(null),className:dn.frameNumberInput}),c.jsx("button",{className:dn.frameButton,onClick:()=>{var Re;const Mn=((Re=C.frameSize)==null?void 0:Re.top)||50,ve=Math.min(100,Mn+1);ft("top",ve)},children:"+"})]})]})]}),c.jsxs("div",{className:dn.frameUnit,children:[r("common.unit"),": mm"]})]})]}),c.jsx(Y8e,{spaceInfo:C,onUpdate:Sn}),c.jsxs("div",{className:dn.configSection,children:[c.jsxs("div",{className:dn.sectionHeader,children:[c.jsx("span",{className:dn.sectionDot}),c.jsx("h3",{className:dn.sectionTitle,children:r("placement.title")})]}),c.jsx(Z8e,{spaceInfo:C,onUpdate:Sn,disabled:!1})]}),((Ts=C.baseConfig)==null?void 0:Ts.placementType)!=="float"&&c.jsxs("div",{className:dn.configSection,children:[c.jsxs("div",{className:dn.sectionHeader,children:[c.jsx("span",{className:dn.sectionDot}),c.jsx("h3",{className:dn.sectionTitle,children:r("material.floorFinish")})]}),c.jsx(L8e,{spaceInfo:C,onUpdate:Sn})]})]})};return o?c.jsx("div",{className:dn.loadingContainer,children:c.jsx(k1,{size:"large",type:"spinner"})}):(console.log("🔍 Configurator basicInfo.title:",S.title),console.log("🔍 currentProjectId:",A),console.log("🔍 currentDesignFileName:",v),console.log("🔍 basicInfo.title:",S.title),c.jsxs("div",{className:dn.configurator,children:[c.jsx(Hbe,{title:v||S.title||"새로운 디자인",projectName:S.title||"새로운 프로젝트",designFileName:v,projectId:A,designFileId:p,onSave:Wt,onPrevious:fn,onHelp:Zn,onConvert:Hn,onLogout:ti,onProfile:ri,saving:l,saveStatus:u,hasDoorsInstalled:sn,onNewProject:Vt,onSaveAs:It,onProjectNameChange:Ut,onExportPDF:ui,onFileTreeToggle:bi,isFileTreeOpen:Me}),c.jsxs("div",{className:dn.mainContent,children:[Me&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:dn.fileTreeOverlay,onClick:()=>et(!1)}),c.jsx("div",{className:dn.fileTreePanel,children:c.jsx(u5e,{onFileSelect:async(Ve,ct,mt)=>{if(console.log("🗂️ 파일트리에서 선택된 파일:",{projectId:Ve,designFileId:ct,designFileName:mt}),p&&(C||T.length>0)){console.log("💾 디자인 전환 전 자동 저장 시작"),h(!0),d("idle");try{await Wt(),console.log("✅ 자동 저장 완료")}catch(An){if(console.error("❌ 자동 저장 실패:",An),!confirm("현재 작업을 저장하는데 실패했습니다. 그래도 다른 디자인으로 전환하시겠습니까?")){h(!1);return}}}ct?t(`/configurator?projectId=${Ve}&designFileId=${ct}&designFileName=${encodeURIComponent(mt)}`,{replace:!0}):t(`/configurator?projectId=${Ve}&designFileName=${encodeURIComponent(mt)}`,{replace:!0}),et(!1)},onCreateNew:async()=>{if(console.log("🆕 파일트리에서 새 파일 생성 요청"),p&&(C||T.length>0)){console.log("💾 새 디자인 생성 전 자동 저장 시작"),h(!0),d("idle");try{await Wt(),console.log("✅ 자동 저장 완료")}catch(Ve){if(console.error("❌ 자동 저장 실패:",Ve),!confirm("현재 작업을 저장하는데 실패했습니다. 그래도 새 디자인을 생성하시겠습니까?")){h(!1);return}}}Jt(),et(!1)},onClose:()=>et(!1)})})]}),c.jsx("button",{className:`${dn.leftPanelToggle} ${ue?dn.open:""}`,onClick:()=>Be(ue?null:"module"),title:ue?"사이드바 접기":"사이드바 펼치기",children:c.jsx("span",{className:dn.foldToggleIcon,children:ue?"<":">"})}),c.jsx(sCe,{activeTab:ue,onTabClick:un,isOpen:!!ue,onToggle:()=>Be(ue?null:"module"),onResetUnsavedChanges:Oe}),c.jsx("div",{className:dn.sidebarContent,style:{transform:ue?"translateX(0) scale(1)":"translateX(-100%) scale(0.95)",opacity:ue?1:0,pointerEvents:ue?"auto":"none"},children:si()}),c.jsxs("div",{className:dn.viewerArea,style:{position:"absolute",left:ue?"304px":"64px",right:qe?"320px":"0",top:0,bottom:0,transition:"left 0.3s cubic-bezier(0.4, 0, 0.2, 1), right 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:[c.jsx(p_e,{viewMode:te,onViewModeChange:Ve=>{L(Ve),Ve==="2D"?_e("wireframe"):Ve==="3D"&&_e("solid")},viewDirection:$,onViewDirectionChange:U,renderMode:me,onRenderModeChange:_e,showAll:ke,onShowAllToggle:()=>je(!ke),showDimensions:Y,onShowDimensionsToggle:K,showDimensionsText:V,onShowDimensionsTextToggle:Q,showGuides:Se,onShowGuidesToggle:fe,showAxis:M,onShowAxisToggle:Z,showFurniture:ee,onShowFurnitureToggle:()=>ae(!ee),doorsOpen:O,onDoorsToggle:J,hasDoorsInstalled:sn,onDoorInstallationToggle:jt}),c.jsxs("div",{className:dn.viewer,children:[sn&&c.jsxs("div",{className:dn.viewerDoorToggle,children:[c.jsx("button",{className:`${dn.viewerDoorButton} ${O?"":dn.active}`,onClick:()=>!O||J(),children:r("viewer.doorClose")}),c.jsx("button",{className:`${dn.viewerDoorButton} ${O?dn.active:""}`,onClick:()=>O||J(),children:r("viewer.doorOpen")})]}),c.jsx(O5,{spaceInfo:C,viewMode:te,setViewMode:L,renderMode:me,showAll:ke,showFurniture:ee,showFrame:!0,svgSize:{width:800,height:600},activeZone:void 0},`space3d-${(xr=C.droppedCeiling)==null?void 0:xr.enabled}-${(br=C.droppedCeiling)==null?void 0:br.position}-${(vn=C.droppedCeiling)==null?void 0:vn.width}-${(wi=C.droppedCeiling)==null?void 0:wi.dropHeight}`)]})]}),c.jsx("button",{className:`${dn.rightPanelToggle} ${qe?dn.open:""}`,onClick:()=>Je(!qe),title:qe?"우측 패널 접기":"우측 패널 펼치기",children:c.jsx("span",{className:dn.foldToggleIcon,children:qe?">":"<"})}),c.jsx("div",{className:dn.rightPanelContainer,style:{width:qe?"320px":"0",transition:"width 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:c.jsxs("div",{className:dn.rightPanel,style:{transform:qe?"translateX(0)":"translateX(100%)",opacity:qe?1:0,pointerEvents:qe?"auto":"none"},children:[c.jsx("div",{className:dn.rightPanelHeader,children:c.jsx("div",{className:dn.rightPanelTabs,children:c.jsxs("div",{className:dn.tabGroup,children:[c.jsx("button",{className:`${dn.rightPanelTab} ${it==="placement"?dn.active:""}`,onClick:()=>De("placement"),children:"배치속성"}),c.jsx("button",{className:`${dn.rightPanelTab} ${it==="module"?dn.active:""}`,onClick:()=>De("module"),children:"배치모듈"})]})})}),c.jsx("div",{className:dn.rightPanelContent,children:Li()})]})})]}),c.jsx(H5e,{}),c.jsx(OSe,{}),c.jsx(L4e,{columnId:q.type==="columnEdit"?q.id:null,isOpen:q.type==="columnEdit",onClose:Ce}),c.jsx(P8e,{isOpen:rt,onClose:()=>_t(!1)}),c.jsx(ZX,{isOpen:Le,onClose:()=>{const Ve=new URLSearchParams(e.toString());Ve.delete("editor");const ct=Ve.toString();window.history.replaceState(null,"",`${window.location.pathname}${ct?"?"+ct:""}`),ye(!1)},capturedViews:Ze})]}))},R8=H.createContext({});function jv(n){const e=H.useRef(null);return e.current===null&&(e.current=n()),e.current}const U8=typeof window<"u",O8=U8?H.useLayoutEffect:H.useEffect,mS=H.createContext(null);function H8(n,e){n.indexOf(e)===-1&&n.push(e)}function W8(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const Bf=(n,e,t)=>t>e?e:t<n?n:t;let z8=()=>{};const Ef={},JX=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n);function eY(n){return typeof n=="object"&&n!==null}const tY=n=>/^0[^.\s]+$/u.test(n);function Q8(n){let e;return()=>(e===void 0&&(e=n()),e)}const Nu=n=>n,qIe=(n,e)=>t=>e(n(t)),Pv=(...n)=>n.reduce(qIe),Qw=(n,e,t)=>{const i=e-n;return i===0?1:(t-n)/i};class $8{constructor(){this.subscriptions=[]}add(e){return H8(this.subscriptions,e),()=>W8(this.subscriptions,e)}notify(e,t,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,t,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,t,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const AA=n=>n*1e3,fA=n=>n/1e3;function nY(n,e){return e?n*(1e3/e):0}const iY=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,ZIe=1e-7,JIe=12;function eDe(n,e,t,i,r){let s,o,a=0;do o=e+(t-e)/2,s=iY(o,i,r)-n,s>0?t=o:e=o;while(Math.abs(s)>ZIe&&++a<JIe);return o}function Nv(n,e,t,i){if(n===e&&t===i)return Nu;const r=s=>eDe(s,0,1,n,t);return s=>s===0||s===1?s:iY(r(s),e,i)}const rY=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,sY=n=>e=>1-n(1-e),oY=Nv(.33,1.53,.69,.99),V8=sY(oY),aY=rY(V8),lY=n=>(n*=2)<1?.5*V8(n):.5*(2-Math.pow(2,-10*(n-1))),G8=n=>1-Math.sin(Math.acos(n)),cY=sY(G8),hY=rY(G8),tDe=Nv(.42,0,1,1),nDe=Nv(0,0,.58,1),uY=Nv(.42,0,.58,1),iDe=n=>Array.isArray(n)&&typeof n[0]!="number",dY=n=>Array.isArray(n)&&typeof n[0]=="number",rDe={linear:Nu,easeIn:tDe,easeInOut:uY,easeOut:nDe,circIn:G8,circInOut:hY,circOut:cY,backIn:V8,backInOut:aY,backOut:oY,anticipate:lY},sDe=n=>typeof n=="string",G7=n=>{if(dY(n)){z8(n.length===4);const[e,t,i,r]=n;return Nv(e,t,i,r)}else if(sDe(n))return rDe[n];return n},Lb=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function oDe(n,e){let t=new Set,i=new Set,r=!1,s=!1;const o=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function l(u){o.has(u)&&(h.schedule(u),n()),u(a)}const h={schedule:(u,d=!1,A=!1)=>{const p=A&&r?t:i;return d&&o.add(u),p.has(u)||p.add(u),u},cancel:u=>{i.delete(u),o.delete(u)},process:u=>{if(a=u,r){s=!0;return}r=!0,[t,i]=[i,t],t.forEach(l),t.clear(),r=!1,s&&(s=!1,h.process(u))}};return h}const aDe=40;function AY(n,e){let t=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,o=Lb.reduce((y,x)=>(y[x]=oDe(s),y),{}),{setup:a,read:l,resolveKeyframes:h,preUpdate:u,update:d,preRender:A,render:f,postRender:p}=o,g=()=>{const y=Ef.useManualTiming?r.timestamp:performance.now();t=!1,Ef.useManualTiming||(r.delta=i?1e3/60:Math.max(Math.min(y-r.timestamp,aDe),1)),r.timestamp=y,r.isProcessing=!0,a.process(r),l.process(r),h.process(r),u.process(r),d.process(r),A.process(r),f.process(r),p.process(r),r.isProcessing=!1,t&&e&&(i=!1,n(g))},v=()=>{t=!0,i=!0,r.isProcessing||n(g)};return{schedule:Lb.reduce((y,x)=>{const S=o[x];return y[x]=(I,j=!1,C=!1)=>(t||v(),S.schedule(I,j,C)),y},{}),cancel:y=>{for(let x=0;x<Lb.length;x++)o[Lb[x]].cancel(y)},state:r,steps:o}}const{schedule:$o,cancel:Ff,state:Ac,steps:jT}=AY(typeof requestAnimationFrame<"u"?requestAnimationFrame:Nu,!0);let yC;function lDe(){yC=void 0}const jh={now:()=>(yC===void 0&&jh.set(Ac.isProcessing||Ef.useManualTiming?Ac.timestamp:performance.now()),yC),set:n=>{yC=n,queueMicrotask(lDe)}},fY=n=>e=>typeof e=="string"&&e.startsWith(n),X8=fY("--"),cDe=fY("var(--"),Y8=n=>cDe(n)?hDe.test(n.split("/*")[0].trim()):!1,hDe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,W1={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},$w={...W1,transform:n=>Bf(0,1,n)},Mb={...W1,default:1},dw=n=>Math.round(n*1e5)/1e5,K8=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function uDe(n){return n==null}const dDe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,q8=(n,e)=>t=>!!(typeof t=="string"&&dDe.test(t)&&t.startsWith(n)||e&&!uDe(t)&&Object.prototype.hasOwnProperty.call(t,e)),pY=(n,e,t)=>i=>{if(typeof i!="string")return i;const[r,s,o,a]=i.match(K8);return{[n]:parseFloat(r),[e]:parseFloat(s),[t]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},ADe=n=>Bf(0,255,n),PT={...W1,transform:n=>Math.round(ADe(n))},Ug={test:q8("rgb","red"),parse:pY("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:i=1})=>"rgba("+PT.transform(n)+", "+PT.transform(e)+", "+PT.transform(t)+", "+dw($w.transform(i))+")"};function fDe(n){let e="",t="",i="",r="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),i=n.substring(5,7),r=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),i=n.substring(3,4),r=n.substring(4,5),e+=e,t+=t,i+=i,r+=r),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const B6={test:q8("#"),parse:fDe,transform:Ug.transform},Lv=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),ap=Lv("deg"),pA=Lv("%"),Fr=Lv("px"),pDe=Lv("vh"),gDe=Lv("vw"),X7={...pA,parse:n=>pA.parse(n)/100,transform:n=>pA.transform(n*100)},Em={test:q8("hsl","hue"),parse:pY("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:i=1})=>"hsla("+Math.round(n)+", "+pA.transform(dw(e))+", "+pA.transform(dw(t))+", "+dw($w.transform(i))+")"},pl={test:n=>Ug.test(n)||B6.test(n)||Em.test(n),parse:n=>Ug.test(n)?Ug.parse(n):Em.test(n)?Em.parse(n):B6.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Ug.transform(n):Em.transform(n),getAnimatableNone:n=>{const e=pl.parse(n);return e.alpha=0,pl.transform(e)}},mDe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function yDe(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(K8))==null?void 0:e.length)||0)+(((t=n.match(mDe))==null?void 0:t.length)||0)>0}const gY="number",mY="color",wDe="var",vDe="var(",Y7="${}",xDe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Vw(n){const e=n.toString(),t=[],i={color:[],number:[],var:[]},r=[];let s=0;const a=e.replace(xDe,l=>(pl.test(l)?(i.color.push(s),r.push(mY),t.push(pl.parse(l))):l.startsWith(vDe)?(i.var.push(s),r.push(wDe),t.push(l)):(i.number.push(s),r.push(gY),t.push(parseFloat(l))),++s,Y7)).split(Y7);return{values:t,split:a,indexes:i,types:r}}function yY(n){return Vw(n).values}function wY(n){const{split:e,types:t}=Vw(n),i=e.length;return r=>{let s="";for(let o=0;o<i;o++)if(s+=e[o],r[o]!==void 0){const a=t[o];a===gY?s+=dw(r[o]):a===mY?s+=pl.transform(r[o]):s+=r[o]}return s}}const bDe=n=>typeof n=="number"?0:pl.test(n)?pl.getAnimatableNone(n):n;function CDe(n){const e=yY(n);return wY(n)(e.map(bDe))}const $p={test:yDe,parse:yY,createTransformer:wY,getAnimatableNone:CDe};function NT(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function _De({hue:n,saturation:e,lightness:t,alpha:i}){n/=360,e/=100,t/=100;let r=0,s=0,o=0;if(!e)r=s=o=t;else{const a=t<.5?t*(1+e):t+e-t*e,l=2*t-a;r=NT(l,a,n+1/3),s=NT(l,a,n),o=NT(l,a,n-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}function W_(n,e){return t=>t>0?e:n}const ma=(n,e,t)=>n+(e-n)*t,LT=(n,e,t)=>{const i=n*n,r=t*(e*e-i)+i;return r<0?0:Math.sqrt(r)},SDe=[B6,Ug,Em],TDe=n=>SDe.find(e=>e.test(n));function K7(n){const e=TDe(n);if(!e)return!1;let t=e.parse(n);return e===Em&&(t=_De(t)),t}const q7=(n,e)=>{const t=K7(n),i=K7(e);if(!t||!i)return W_(n,e);const r={...t};return s=>(r.red=LT(t.red,i.red,s),r.green=LT(t.green,i.green,s),r.blue=LT(t.blue,i.blue,s),r.alpha=ma(t.alpha,i.alpha,s),Ug.transform(r))},E6=new Set(["none","hidden"]);function BDe(n,e){return E6.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function EDe(n,e){return t=>ma(n,e,t)}function Z8(n){return typeof n=="number"?EDe:typeof n=="string"?Y8(n)?W_:pl.test(n)?q7:IDe:Array.isArray(n)?vY:typeof n=="object"?pl.test(n)?q7:FDe:W_}function vY(n,e){const t=[...n],i=t.length,r=n.map((s,o)=>Z8(s)(s,e[o]));return s=>{for(let o=0;o<i;o++)t[o]=r[o](s);return t}}function FDe(n,e){const t={...n,...e},i={};for(const r in t)n[r]!==void 0&&e[r]!==void 0&&(i[r]=Z8(n[r])(n[r],e[r]));return r=>{for(const s in i)t[s]=i[s](r);return t}}function kDe(n,e){const t=[],i={color:0,var:0,number:0};for(let r=0;r<e.values.length;r++){const s=e.types[r],o=n.indexes[s][i[s]],a=n.values[o]??0;t[r]=a,i[s]++}return t}const IDe=(n,e)=>{const t=$p.createTransformer(e),i=Vw(n),r=Vw(e);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?E6.has(n)&&!r.values.length||E6.has(e)&&!i.values.length?BDe(n,e):Pv(vY(kDe(i,r),r.values),t):W_(n,e)};function xY(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?ma(n,e,t):Z8(n)(n,e)}const DDe=n=>{const e=({timestamp:t})=>n(t);return{start:(t=!0)=>$o.update(e,t),stop:()=>Ff(e),now:()=>Ac.isProcessing?Ac.timestamp:jh.now()}},bY=(n,e,t=10)=>{let i="";const r=Math.max(Math.round(e/t),2);for(let s=0;s<r;s++)i+=Math.round(n(s/(r-1))*1e4)/1e4+", ";return`linear(${i.substring(0,i.length-2)})`},z_=2e4;function J8(n){let e=0;const t=50;let i=n.next(e);for(;!i.done&&e<z_;)e+=t,i=n.next(e);return e>=z_?1/0:e}function jDe(n,e=100,t){const i=t({...n,keyframes:[0,e]}),r=Math.min(J8(i),z_);return{type:"keyframes",ease:s=>i.next(r*s).value/e,duration:fA(r)}}const PDe=5;function CY(n,e,t){const i=Math.max(e-PDe,0);return nY(t-n(i),e-i)}const Pa={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},MT=.001;function NDe({duration:n=Pa.duration,bounce:e=Pa.bounce,velocity:t=Pa.velocity,mass:i=Pa.mass}){let r,s,o=1-e;o=Bf(Pa.minDamping,Pa.maxDamping,o),n=Bf(Pa.minDuration,Pa.maxDuration,fA(n)),o<1?(r=h=>{const u=h*o,d=u*n,A=u-t,f=F6(h,o),p=Math.exp(-d);return MT-A/f*p},s=h=>{const d=h*o*n,A=d*t+t,f=Math.pow(o,2)*Math.pow(h,2)*n,p=Math.exp(-d),g=F6(Math.pow(h,2),o);return(-r(h)+MT>0?-1:1)*((A-f)*p)/g}):(r=h=>{const u=Math.exp(-h*n),d=(h-t)*n+1;return-MT+u*d},s=h=>{const u=Math.exp(-h*n),d=(t-h)*(n*n);return u*d});const a=5/n,l=MDe(r,s,a);if(n=AA(n),isNaN(l))return{stiffness:Pa.stiffness,damping:Pa.damping,duration:n};{const h=Math.pow(l,2)*i;return{stiffness:h,damping:o*2*Math.sqrt(i*h),duration:n}}}const LDe=12;function MDe(n,e,t){let i=t;for(let r=1;r<LDe;r++)i=i-n(i)/e(i);return i}function F6(n,e){return n*Math.sqrt(1-e*e)}const RDe=["duration","bounce"],UDe=["stiffness","damping","mass"];function Z7(n,e){return e.some(t=>n[t]!==void 0)}function ODe(n){let e={velocity:Pa.velocity,stiffness:Pa.stiffness,damping:Pa.damping,mass:Pa.mass,isResolvedFromDuration:!1,...n};if(!Z7(n,UDe)&&Z7(n,RDe))if(n.visualDuration){const t=n.visualDuration,i=2*Math.PI/(t*1.2),r=i*i,s=2*Bf(.05,1,1-(n.bounce||0))*Math.sqrt(r);e={...e,mass:Pa.mass,stiffness:r,damping:s}}else{const t=NDe(n);e={...e,...t,mass:Pa.mass},e.isResolvedFromDuration=!0}return e}function Q_(n=Pa.visualDuration,e=Pa.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:i,restDelta:r}=t;const s=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],a={done:!1,value:s},{stiffness:l,damping:h,mass:u,duration:d,velocity:A,isResolvedFromDuration:f}=ODe({...t,velocity:-fA(t.velocity||0)}),p=A||0,g=h/(2*Math.sqrt(l*u)),v=o-s,w=fA(Math.sqrt(l/u)),m=Math.abs(v)<5;i||(i=m?Pa.restSpeed.granular:Pa.restSpeed.default),r||(r=m?Pa.restDelta.granular:Pa.restDelta.default);let y;if(g<1){const S=F6(w,g);y=I=>{const j=Math.exp(-g*w*I);return o-j*((p+g*w*v)/S*Math.sin(S*I)+v*Math.cos(S*I))}}else if(g===1)y=S=>o-Math.exp(-w*S)*(v+(p+w*v)*S);else{const S=w*Math.sqrt(g*g-1);y=I=>{const j=Math.exp(-g*w*I),C=Math.min(S*I,300);return o-j*((p+g*w*v)*Math.sinh(C)+S*v*Math.cosh(C))/S}}const x={calculatedDuration:f&&d||null,next:S=>{const I=y(S);if(f)a.done=S>=d;else{let j=S===0?p:0;g<1&&(j=S===0?AA(p):CY(y,S,I));const C=Math.abs(j)<=i,b=Math.abs(o-I)<=r;a.done=C&&b}return a.value=a.done?o:I,a},toString:()=>{const S=Math.min(J8(x),z_),I=bY(j=>x.next(S*j).value,S,30);return S+"ms "+I},toTransition:()=>{}};return x}Q_.applyToOptions=n=>{const e=jDe(n,100,Q_);return n.ease=e.ease,n.duration=AA(e.duration),n.type="keyframes",n};function k6({keyframes:n,velocity:e=0,power:t=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:a,max:l,restDelta:h=.5,restSpeed:u}){const d=n[0],A={done:!1,value:d},f=C=>a!==void 0&&C<a||l!==void 0&&C>l,p=C=>a===void 0?l:l===void 0||Math.abs(a-C)<Math.abs(l-C)?a:l;let g=t*e;const v=d+g,w=o===void 0?v:o(v);w!==v&&(g=w-d);const m=C=>-g*Math.exp(-C/i),y=C=>w+m(C),x=C=>{const b=m(C),D=y(C);A.done=Math.abs(b)<=h,A.value=A.done?w:D};let S,I;const j=C=>{f(A.value)&&(S=C,I=Q_({keyframes:[A.value,p(A.value)],velocity:CY(y,C,A.value),damping:r,stiffness:s,restDelta:h,restSpeed:u}))};return j(0),{calculatedDuration:null,next:C=>{let b=!1;return!I&&S===void 0&&(b=!0,x(C),j(C)),S!==void 0&&C>=S?I.next(C-S):(!b&&x(C),A)}}}function HDe(n,e,t){const i=[],r=t||Ef.mix||xY,s=n.length-1;for(let o=0;o<s;o++){let a=r(n[o],n[o+1]);if(e){const l=Array.isArray(e)?e[o]||Nu:e;a=Pv(l,a)}i.push(a)}return i}function _Y(n,e,{clamp:t=!0,ease:i,mixer:r}={}){const s=n.length;if(z8(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const a=HDe(e,i,r),l=a.length,h=u=>{if(o&&u<n[0])return e[0];let d=0;if(l>1)for(;d<n.length-2&&!(u<n[d+1]);d++);const A=Qw(n[d],n[d+1],u);return a[d](A)};return t?u=>h(Bf(n[0],n[s-1],u)):h}function WDe(n,e){const t=n[n.length-1];for(let i=1;i<=e;i++){const r=Qw(0,e,i);n.push(ma(t,1,r))}}function zDe(n){const e=[0];return WDe(e,n.length-1),e}function QDe(n,e){return n.map(t=>t*e)}function $De(n,e){return n.map(()=>e||uY).splice(0,n.length-1)}function Aw({duration:n=300,keyframes:e,times:t,ease:i="easeInOut"}){const r=iDe(i)?i.map(G7):G7(i),s={done:!1,value:e[0]},o=QDe(t&&t.length===e.length?t:zDe(e),n),a=_Y(o,e,{ease:Array.isArray(r)?r:$De(e,r)});return{calculatedDuration:n,next:l=>(s.value=a(l),s.done=l>=n,s)}}const VDe=n=>n!==null;function eI(n,{repeat:e,repeatType:t="loop"},i,r=1){const s=n.filter(VDe),a=r<0||e&&t!=="loop"&&e%2===1?0:s.length-1;return!a||i===void 0?s[a]:i}const GDe={decay:k6,inertia:k6,tween:Aw,keyframes:Aw,spring:Q_};function SY(n){typeof n.type=="string"&&(n.type=GDe[n.type])}class tI{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const XDe=n=>n/100;class yS extends tI{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var i,r;const{motionValue:t}=this.options;t&&t.updatedAt!==jh.now()&&this.tick(jh.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(r=(i=this.options).onStop)==null||r.call(i))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;SY(e);const{type:t=Aw,repeat:i=0,repeatDelay:r=0,repeatType:s,velocity:o=0}=e;let{keyframes:a}=e;const l=t||Aw;l!==Aw&&typeof a[0]!="number"&&(this.mixKeyframes=Pv(XDe,xY(a[0],a[1])),a=[0,100]);const h=l({...e,keyframes:a});s==="mirror"&&(this.mirroredGenerator=l({...e,keyframes:[...a].reverse(),velocity:-o})),h.calculatedDuration===null&&(h.calculatedDuration=J8(h));const{calculatedDuration:u}=h;this.calculatedDuration=u,this.resolvedDuration=u+r,this.totalDuration=this.resolvedDuration*(i+1)-r,this.generator=h}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){const{generator:i,totalDuration:r,mixKeyframes:s,mirroredGenerator:o,resolvedDuration:a,calculatedDuration:l}=this;if(this.startTime===null)return i.next(0);const{delay:h=0,keyframes:u,repeat:d,repeatType:A,repeatDelay:f,type:p,onUpdate:g,finalKeyframe:v}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-r/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const w=this.currentTime-h*(this.playbackSpeed>=0?1:-1),m=this.playbackSpeed>=0?w<0:w>r;this.currentTime=Math.max(w,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=r);let y=this.currentTime,x=i;if(d){const C=Math.min(this.currentTime,r)/a;let b=Math.floor(C),D=C%1;!D&&C>=1&&(D=1),D===1&&b--,b=Math.min(b,d+1),!!(b%2)&&(A==="reverse"?(D=1-D,f&&(D-=f/a)):A==="mirror"&&(x=o)),y=Bf(0,1,D)*a}const S=m?{done:!1,value:u[0]}:x.next(y);s&&(S.value=s(S.value));let{done:I}=S;!m&&l!==null&&(I=this.playbackSpeed>=0?this.currentTime>=r:this.currentTime<=0);const j=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&I);return j&&p!==k6&&(S.value=eI(u,this.options,v,this.speed)),g&&g(S.value),j&&this.finish(),S}then(e,t){return this.finished.then(e,t)}get duration(){return fA(this.calculatedDuration)}get time(){return fA(this.currentTime)}set time(e){var t;e=AA(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(t=this.driver)==null||t.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(jh.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=fA(this.currentTime))}play(){var r,s;if(this.isStopped)return;const{driver:e=DDe,startTime:t}=this.options;this.driver||(this.driver=e(o=>this.tick(o))),(s=(r=this.options).onPlay)==null||s.call(r);const i=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=i):this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime||(this.startTime=t??i),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(jh.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,t;this.notifyFinished(),this.teardown(),this.state="finished",(t=(e=this.options).onComplete)==null||t.call(e)}cancel(){var e,t;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(t=(e=this.options).onCancel)==null||t.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var t;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(t=this.driver)==null||t.stop(),e.observe(this)}}function YDe(n){for(let e=1;e<n.length;e++)n[e]??(n[e]=n[e-1])}const Og=n=>n*180/Math.PI,I6=n=>{const e=Og(Math.atan2(n[1],n[0]));return D6(e)},KDe={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:n=>(Math.abs(n[0])+Math.abs(n[3]))/2,rotate:I6,rotateZ:I6,skewX:n=>Og(Math.atan(n[1])),skewY:n=>Og(Math.atan(n[2])),skew:n=>(Math.abs(n[1])+Math.abs(n[2]))/2},D6=n=>(n=n%360,n<0&&(n+=360),n),J7=I6,e9=n=>Math.sqrt(n[0]*n[0]+n[1]*n[1]),t9=n=>Math.sqrt(n[4]*n[4]+n[5]*n[5]),qDe={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:e9,scaleY:t9,scale:n=>(e9(n)+t9(n))/2,rotateX:n=>D6(Og(Math.atan2(n[6],n[5]))),rotateY:n=>D6(Og(Math.atan2(-n[2],n[0]))),rotateZ:J7,rotate:J7,skewX:n=>Og(Math.atan(n[4])),skewY:n=>Og(Math.atan(n[1])),skew:n=>(Math.abs(n[1])+Math.abs(n[4]))/2};function j6(n){return n.includes("scale")?1:0}function P6(n,e){if(!n||n==="none")return j6(e);const t=n.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let i,r;if(t)i=qDe,r=t;else{const a=n.match(/^matrix\(([-\d.e\s,]+)\)$/u);i=KDe,r=a}if(!r)return j6(e);const s=i[e],o=r[1].split(",").map(JDe);return typeof s=="function"?s(o):o[s]}const ZDe=(n,e)=>{const{transform:t="none"}=getComputedStyle(n);return P6(t,e)};function JDe(n){return parseFloat(n.trim())}const z1=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Q1=new Set(z1),n9=n=>n===W1||n===Fr,eje=new Set(["x","y","z"]),tje=z1.filter(n=>!eje.has(n));function nje(n){const e=[];return tje.forEach(t=>{const i=n.getValue(t);i!==void 0&&(e.push([t,i.get()]),i.set(t.startsWith("scale")?1:0))}),e}const Kg={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:(n,{transform:e})=>P6(e,"x"),y:(n,{transform:e})=>P6(e,"y")};Kg.translateX=Kg.x;Kg.translateY=Kg.y;const qg=new Set;let N6=!1,L6=!1,M6=!1;function TY(){if(L6){const n=Array.from(qg).filter(i=>i.needsMeasurement),e=new Set(n.map(i=>i.element)),t=new Map;e.forEach(i=>{const r=nje(i);r.length&&(t.set(i,r),i.render())}),n.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const r=t.get(i);r&&r.forEach(([s,o])=>{var a;(a=i.getValue(s))==null||a.set(o)})}),n.forEach(i=>i.measureEndState()),n.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}L6=!1,N6=!1,qg.forEach(n=>n.complete(M6)),qg.clear()}function BY(){qg.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(L6=!0)})}function ije(){M6=!0,BY(),TY(),M6=!1}class nI{constructor(e,t,i,r,s,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=i,this.motionValue=r,this.element=s,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(qg.add(this),N6||(N6=!0,$o.read(BY),$o.resolveKeyframes(TY))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:i,motionValue:r}=this;if(e[0]===null){const s=r==null?void 0:r.get(),o=e[e.length-1];if(s!==void 0)e[0]=s;else if(i&&t){const a=i.readValue(t,o);a!=null&&(e[0]=a)}e[0]===void 0&&(e[0]=o),r&&s===void 0&&r.set(e[0])}YDe(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),qg.delete(this)}cancel(){this.state==="scheduled"&&(qg.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const rje=n=>n.startsWith("--");function sje(n,e,t){rje(e)?n.style.setProperty(e,t):n.style[e]=t}const oje=Q8(()=>window.ScrollTimeline!==void 0),aje={};function lje(n,e){const t=Q8(n);return()=>aje[e]??t()}const EY=lje(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),ky=([n,e,t,i])=>`cubic-bezier(${n}, ${e}, ${t}, ${i})`,i9={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:ky([0,.65,.55,1]),circOut:ky([.55,0,1,.45]),backIn:ky([.31,.01,.66,-.59]),backOut:ky([.33,1.53,.69,.99])};function FY(n,e){if(n)return typeof n=="function"?EY()?bY(n,e):"ease-out":dY(n)?ky(n):Array.isArray(n)?n.map(t=>FY(t,e)||i9.easeOut):i9[n]}function cje(n,e,t,{delay:i=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:a="easeOut",times:l}={},h=void 0){const u={[e]:t};l&&(u.offset=l);const d=FY(a,r);Array.isArray(d)&&(u.easing=d);const A={delay:i,duration:r,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"};return h&&(A.pseudoElement=h),n.animate(u,A)}function kY(n){return typeof n=="function"&&"applyToOptions"in n}function hje({type:n,...e}){return kY(n)&&EY()?n.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class uje extends tI{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:i,keyframes:r,pseudoElement:s,allowFlatten:o=!1,finalKeyframe:a,onComplete:l}=e;this.isPseudoElement=!!s,this.allowFlatten=o,this.options=e,z8(typeof e.type!="string");const h=hje(e);this.animation=cje(t,i,r,h,s),h.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!s){const u=eI(r,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(u):sje(t,i,u),this.animation.cancel()}l==null||l(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,t;(t=(e=this.animation).finish)==null||t.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,t;this.isPseudoElement||(t=(e=this.animation).commitStyles)==null||t.call(e)}get duration(){var t,i;const e=((i=(t=this.animation.effect)==null?void 0:t.getComputedTiming)==null?void 0:i.call(t).duration)||0;return fA(Number(e))}get time(){return fA(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=AA(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){var i;return this.allowFlatten&&((i=this.animation.effect)==null||i.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&oje()?(this.animation.timeline=e,Nu):t(this)}}const IY={anticipate:lY,backInOut:aY,circInOut:hY};function dje(n){return n in IY}function Aje(n){typeof n.ease=="string"&&dje(n.ease)&&(n.ease=IY[n.ease])}const r9=10;class fje extends uje{constructor(e){Aje(e),SY(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:t,onUpdate:i,onComplete:r,element:s,...o}=this.options;if(!t)return;if(e!==void 0){t.set(e);return}const a=new yS({...o,autoplay:!1}),l=AA(this.finishedTime??this.time);t.setWithVelocity(a.sample(l-r9).value,a.sample(l).value,r9),a.stop()}}const s9=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&($p.test(n)||n==="0")&&!n.startsWith("url("));function pje(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function gje(n,e,t,i){const r=n[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],o=s9(r,e),a=s9(s,e);return!o||!a?!1:pje(n)||(t==="spring"||kY(t))&&i}function R6(n){n.duration=0,n.type}const mje=new Set(["opacity","clipPath","filter","transform"]),yje=Q8(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function wje(n){var u;const{motionValue:e,name:t,repeatDelay:i,repeatType:r,damping:s,type:o}=n;if(!(((u=e==null?void 0:e.owner)==null?void 0:u.current)instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:h}=e.owner.getProps();return yje()&&t&&mje.has(t)&&(t!=="transform"||!h)&&!l&&!i&&r!=="mirror"&&s!==0&&o!=="inertia"}const vje=40;class xje extends tI{constructor({autoplay:e=!0,delay:t=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop",keyframes:a,name:l,motionValue:h,element:u,...d}){var p;super(),this.stop=()=>{var g,v;this._animation&&(this._animation.stop(),(g=this.stopTimeline)==null||g.call(this)),(v=this.keyframeResolver)==null||v.cancel()},this.createdAt=jh.now();const A={autoplay:e,delay:t,type:i,repeat:r,repeatDelay:s,repeatType:o,name:l,motionValue:h,element:u,...d},f=(u==null?void 0:u.KeyframeResolver)||nI;this.keyframeResolver=new f(a,(g,v,w)=>this.onKeyframesResolved(g,v,A,!w),l,h,u),(p=this.keyframeResolver)==null||p.scheduleResolve()}onKeyframesResolved(e,t,i,r){this.keyframeResolver=void 0;const{name:s,type:o,velocity:a,delay:l,isHandoff:h,onUpdate:u}=i;this.resolvedAt=jh.now(),gje(e,s,o,a)||((Ef.instantAnimations||!l)&&(u==null||u(eI(e,i,t))),e[0]=e[e.length-1],R6(i),i.repeat=0);const A={startTime:r?this.resolvedAt?this.resolvedAt-this.createdAt>vje?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:t,...i,keyframes:e},f=!h&&wje(A)?new fje({...A,element:A.motionValue.owner.current}):new yS(A);f.finished.then(()=>this.notifyFinished()).catch(Nu),this.pendingTimeline&&(this.stopTimeline=f.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=f}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),ije()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const bje=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Cje(n){const e=bje.exec(n);if(!e)return[,];const[,t,i,r]=e;return[`--${t??i}`,r]}function DY(n,e,t=1){const[i,r]=Cje(n);if(!i)return;const s=window.getComputedStyle(e).getPropertyValue(i);if(s){const o=s.trim();return JX(o)?parseFloat(o):o}return Y8(r)?DY(r,e,t+1):r}function iI(n,e){return(n==null?void 0:n[e])??(n==null?void 0:n.default)??n}const jY=new Set(["width","height","top","left","right","bottom",...z1]),_je={test:n=>n==="auto",parse:n=>n},PY=n=>e=>e.test(n),NY=[W1,Fr,pA,ap,gDe,pDe,_je],o9=n=>NY.find(PY(n));function Sje(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||tY(n):!0}const Tje=new Set(["brightness","contrast","saturate","opacity"]);function Bje(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[i]=t.match(K8)||[];if(!i)return n;const r=t.replace(i,"");let s=Tje.has(e)?1:0;return i!==t&&(s*=100),e+"("+s+r+")"}const Eje=/\b([a-z-]*)\(.*?\)/gu,U6={...$p,getAnimatableNone:n=>{const e=n.match(Eje);return e?e.map(Bje).join(" "):n}},a9={...W1,transform:Math.round},Fje={rotate:ap,rotateX:ap,rotateY:ap,rotateZ:ap,scale:Mb,scaleX:Mb,scaleY:Mb,scaleZ:Mb,skew:ap,skewX:ap,skewY:ap,distance:Fr,translateX:Fr,translateY:Fr,translateZ:Fr,x:Fr,y:Fr,z:Fr,perspective:Fr,transformPerspective:Fr,opacity:$w,originX:X7,originY:X7,originZ:Fr},rI={borderWidth:Fr,borderTopWidth:Fr,borderRightWidth:Fr,borderBottomWidth:Fr,borderLeftWidth:Fr,borderRadius:Fr,radius:Fr,borderTopLeftRadius:Fr,borderTopRightRadius:Fr,borderBottomRightRadius:Fr,borderBottomLeftRadius:Fr,width:Fr,maxWidth:Fr,height:Fr,maxHeight:Fr,top:Fr,right:Fr,bottom:Fr,left:Fr,padding:Fr,paddingTop:Fr,paddingRight:Fr,paddingBottom:Fr,paddingLeft:Fr,margin:Fr,marginTop:Fr,marginRight:Fr,marginBottom:Fr,marginLeft:Fr,backgroundPositionX:Fr,backgroundPositionY:Fr,...Fje,zIndex:a9,fillOpacity:$w,strokeOpacity:$w,numOctaves:a9},kje={...rI,color:pl,backgroundColor:pl,outlineColor:pl,fill:pl,stroke:pl,borderColor:pl,borderTopColor:pl,borderRightColor:pl,borderBottomColor:pl,borderLeftColor:pl,filter:U6,WebkitFilter:U6},LY=n=>kje[n];function MY(n,e){let t=LY(n);return t!==U6&&(t=$p),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const Ije=new Set(["auto","none","0"]);function Dje(n,e,t){let i=0,r;for(;i<n.length&&!r;){const s=n[i];typeof s=="string"&&!Ije.has(s)&&Vw(s).values.length&&(r=n[i]),i++}if(r&&t)for(const s of e)n[s]=MY(t,r)}class jje extends nI{constructor(e,t,i,r,s){super(e,t,i,r,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:i}=this;if(!t||!t.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let h=e[l];if(typeof h=="string"&&(h=h.trim(),Y8(h))){const u=DY(h,t.current);u!==void 0&&(e[l]=u),l===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!jY.has(i)||e.length!==2)return;const[r,s]=e,o=o9(r),a=o9(s);if(o!==a)if(n9(o)&&n9(a))for(let l=0;l<e.length;l++){const h=e[l];typeof h=="string"&&(e[l]=parseFloat(h))}else Kg[i]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,i=[];for(let r=0;r<e.length;r++)(e[r]===null||Sje(e[r]))&&i.push(r);i.length&&Dje(e,i,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Kg[i](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];r!==void 0&&e.getValue(i,r).jump(r,!1)}measureEndState(){var a;const{element:e,name:t,unresolvedKeyframes:i}=this;if(!e||!e.current)return;const r=e.getValue(t);r&&r.jump(this.measuredOrigin,!1);const s=i.length-1,o=i[s];i[s]=Kg[t](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),(a=this.removedTransforms)!=null&&a.length&&this.removedTransforms.forEach(([l,h])=>{e.getValue(l).set(h)}),this.resolveNoneKeyframes()}}function Pje(n,e,t){if(n instanceof EventTarget)return[n];if(typeof n=="string"){let i=document;const r=(t==null?void 0:t[n])??i.querySelectorAll(n);return r?Array.from(r):[]}return Array.from(n)}const RY=(n,e)=>e&&typeof n=="number"?e.transform(n):n;function UY(n){return eY(n)&&"offsetHeight"in n}const l9=30,Nje=n=>!isNaN(parseFloat(n)),fw={current:void 0};class Lje{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=i=>{var s;const r=jh.now();if(this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&((s=this.events.change)==null||s.notify(this.current),this.dependents))for(const o of this.dependents)o.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=jh.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=Nje(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new $8);const i=this.events[e].add(t);return e==="change"?()=>{i(),$o.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,i){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return fw.current&&fw.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const e=jh.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>l9)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,l9);return nY(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,t;(e=this.dependents)==null||e.clear(),(t=this.events.destroy)==null||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function d0(n,e){return new Lje(n,e)}const{schedule:sI}=AY(queueMicrotask,!1),rd={x:!1,y:!1};function OY(){return rd.x||rd.y}function Mje(n){return n==="x"||n==="y"?rd[n]?null:(rd[n]=!0,()=>{rd[n]=!1}):rd.x||rd.y?null:(rd.x=rd.y=!0,()=>{rd.x=rd.y=!1})}function HY(n,e){const t=Pje(n),i=new AbortController,r={passive:!0,...e,signal:i.signal};return[t,r,()=>i.abort()]}function c9(n){return!(n.pointerType==="touch"||OY())}function Rje(n,e,t={}){const[i,r,s]=HY(n,t),o=a=>{if(!c9(a))return;const{target:l}=a,h=e(l,a);if(typeof h!="function"||!l)return;const u=d=>{c9(d)&&(h(d),l.removeEventListener("pointerleave",u))};l.addEventListener("pointerleave",u,r)};return i.forEach(a=>{a.addEventListener("pointerenter",o,r)}),s}const WY=(n,e)=>e?n===e?!0:WY(n,e.parentElement):!1,oI=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,Uje=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Oje(n){return Uje.has(n.tagName)||n.tabIndex!==-1}const wC=new WeakSet;function h9(n){return e=>{e.key==="Enter"&&n(e)}}function RT(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const Hje=(n,e)=>{const t=n.currentTarget;if(!t)return;const i=h9(()=>{if(wC.has(t))return;RT(t,"down");const r=h9(()=>{RT(t,"up")}),s=()=>RT(t,"cancel");t.addEventListener("keyup",r,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",i,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",i),e)};function u9(n){return oI(n)&&!OY()}function Wje(n,e,t={}){const[i,r,s]=HY(n,t),o=a=>{const l=a.currentTarget;if(!u9(a))return;wC.add(l);const h=e(l,a),u=(f,p)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",A),wC.has(l)&&wC.delete(l),u9(f)&&typeof h=="function"&&h(f,{success:p})},d=f=>{u(f,l===window||l===document||t.useGlobalTarget||WY(l,f.target))},A=f=>{u(f,!1)};window.addEventListener("pointerup",d,r),window.addEventListener("pointercancel",A,r)};return i.forEach(a=>{(t.useGlobalTarget?window:a).addEventListener("pointerdown",o,r),UY(a)&&(a.addEventListener("focus",h=>Hje(h,r)),!Oje(a)&&!a.hasAttribute("tabindex")&&(a.tabIndex=0))}),s}function zY(n){return eY(n)&&"ownerSVGElement"in n}function zje(n){return zY(n)&&n.tagName==="svg"}function Qje(...n){const e=!Array.isArray(n[0]),t=e?0:-1,i=n[0+t],r=n[1+t],s=n[2+t],o=n[3+t],a=_Y(r,s,o);return e?a(i):a}const Zl=n=>!!(n&&n.getVelocity);function $je(n,e,t){const i=n.get();let r=null,s=i,o;const a=typeof i=="string"?i.replace(/[\d.-]/g,""):void 0,l=()=>{r&&(r.stop(),r=null)},h=()=>{l(),r=new yS({keyframes:[A9(n.get()),A9(s)],velocity:n.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...t,onUpdate:o})};if(n.attach((u,d)=>(s=u,o=A=>d(d9(A,a)),$o.postRender(h),n.get()),l),Zl(e)){const u=e.on("change",A=>n.set(d9(A,a))),d=n.on("destroy",u);return()=>{u(),d()}}return l}function d9(n,e){return e?n+e:n}function A9(n){return typeof n=="number"?n:parseFloat(n)}const Vje=[...NY,pl,$p],Gje=n=>Vje.find(PY(n)),Mv=H.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class Xje extends H.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const i=t.offsetParent,r=UY(i)&&i.offsetWidth||0,s=this.props.sizeRef.current;s.height=t.offsetHeight||0,s.width=t.offsetWidth||0,s.top=t.offsetTop,s.left=t.offsetLeft,s.right=r-s.width-s.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Yje({children:n,isPresent:e,anchorX:t,root:i}){const r=H.useId(),s=H.useRef(null),o=H.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:a}=H.useContext(Mv);return H.useInsertionEffect(()=>{const{width:l,height:h,top:u,left:d,right:A}=o.current;if(e||!s.current||!l||!h)return;const f=t==="left"?`left: ${d}`:`right: ${A}`;s.current.dataset.motionPopId=r;const p=document.createElement("style");a&&(p.nonce=a);const g=i??document.head;return g.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${l}px !important;
            height: ${h}px !important;
            ${f}px !important;
            top: ${u}px !important;
          }
        `),()=>{g.contains(p)&&g.removeChild(p)}},[e]),c.jsx(Xje,{isPresent:e,childRef:s,sizeRef:o,children:H.cloneElement(n,{ref:s})})}const Kje=({children:n,initial:e,isPresent:t,onExitComplete:i,custom:r,presenceAffectsLayout:s,mode:o,anchorX:a,root:l})=>{const h=jv(qje),u=H.useId();let d=!0,A=H.useMemo(()=>(d=!1,{id:u,initial:e,isPresent:t,custom:r,onExitComplete:f=>{h.set(f,!0);for(const p of h.values())if(!p)return;i&&i()},register:f=>(h.set(f,!1),()=>h.delete(f))}),[t,h,i]);return s&&d&&(A={...A}),H.useMemo(()=>{h.forEach((f,p)=>h.set(p,!1))},[t]),H.useEffect(()=>{!t&&!h.size&&i&&i()},[t]),o==="popLayout"&&(n=c.jsx(Yje,{isPresent:t,anchorX:a,root:l,children:n})),c.jsx(mS.Provider,{value:A,children:n})};function qje(){return new Map}function QY(n=!0){const e=H.useContext(mS);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:i,register:r}=e,s=H.useId();H.useEffect(()=>{if(n)return r(s)},[n]);const o=H.useCallback(()=>n&&i&&i(s),[s,i,n]);return!t&&i?[!1,o]:[!0]}const Rb=n=>n.key||"";function f9(n){const e=[];return H.Children.forEach(n,t=>{H.isValidElement(t)&&e.push(t)}),e}const Gw=({children:n,custom:e,initial:t=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:s="sync",propagate:o=!1,anchorX:a="left",root:l})=>{const[h,u]=QY(o),d=H.useMemo(()=>f9(n),[n]),A=o&&!h?[]:d.map(Rb),f=H.useRef(!0),p=H.useRef(d),g=jv(()=>new Map),[v,w]=H.useState(d),[m,y]=H.useState(d);O8(()=>{f.current=!1,p.current=d;for(let I=0;I<m.length;I++){const j=Rb(m[I]);A.includes(j)?g.delete(j):g.get(j)!==!0&&g.set(j,!1)}},[m,A.length,A.join("-")]);const x=[];if(d!==v){let I=[...d];for(let j=0;j<m.length;j++){const C=m[j],b=Rb(C);A.includes(b)||(I.splice(j,0,C),x.push(C))}return s==="wait"&&x.length&&(I=x),y(f9(I)),w(d),null}const{forceRender:S}=H.useContext(R8);return c.jsx(c.Fragment,{children:m.map(I=>{const j=Rb(I),C=o&&!h?!1:d===m||A.includes(j),b=()=>{if(g.has(j))g.set(j,!0);else return;let D=!0;g.forEach(T=>{T||(D=!1)}),D&&(S==null||S(),y(p.current),o&&(u==null||u()),i&&i())};return c.jsx(Kje,{isPresent:C,initial:!f.current||t?void 0:!1,custom:e,presenceAffectsLayout:r,mode:s,root:l,onExitComplete:C?void 0:b,anchorX:a,children:I},j)})})},$Y=H.createContext({strict:!1}),p9={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},m1={};for(const n in p9)m1[n]={isEnabled:e=>p9[n].some(t=>!!e[t])};function Zje(n){for(const e in n)m1[e]={...m1[e],...n[e]}}const Jje=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function $_(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||Jje.has(n)}let VY=n=>!$_(n);function ePe(n){typeof n=="function"&&(VY=e=>e.startsWith("on")?!$_(e):n(e))}try{ePe(require("@emotion/is-prop-valid").default)}catch{}function tPe(n,e,t){const i={};for(const r in n)r==="values"&&typeof n.values=="object"||(VY(r)||t===!0&&$_(r)||!e&&!$_(r)||n.draggable&&r.startsWith("onDrag"))&&(i[r]=n[r]);return i}const wS=H.createContext({});function vS(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}function Xw(n){return typeof n=="string"||Array.isArray(n)}const aI=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],lI=["initial",...aI];function xS(n){return vS(n.animate)||lI.some(e=>Xw(n[e]))}function GY(n){return!!(xS(n)||n.variants)}function nPe(n,e){if(xS(n)){const{initial:t,animate:i}=n;return{initial:t===!1||Xw(t)?t:void 0,animate:Xw(i)?i:void 0}}return n.inherit!==!1?e:{}}function iPe(n){const{initial:e,animate:t}=nPe(n,H.useContext(wS));return H.useMemo(()=>({initial:e,animate:t}),[g9(e),g9(t)])}function g9(n){return Array.isArray(n)?n.join(" "):n}const Yw={};function rPe(n){for(const e in n)Yw[e]=n[e],X8(e)&&(Yw[e].isCSSVariable=!0)}function XY(n,{layout:e,layoutId:t}){return Q1.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!Yw[n]||n==="opacity")}const sPe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},oPe=z1.length;function aPe(n,e,t){let i="",r=!0;for(let s=0;s<oPe;s++){const o=z1[s],a=n[o];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(o.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||t){const h=RY(a,rI[o]);if(!l){r=!1;const u=sPe[o]||o;i+=`${u}(${h}) `}t&&(e[o]=h)}}return i=i.trim(),t?i=t(e,r?"":i):r&&(i="none"),i}function cI(n,e,t){const{style:i,vars:r,transformOrigin:s}=n;let o=!1,a=!1;for(const l in e){const h=e[l];if(Q1.has(l)){o=!0;continue}else if(X8(l)){r[l]=h;continue}else{const u=RY(h,rI[l]);l.startsWith("origin")?(a=!0,s[l]=u):i[l]=u}}if(e.transform||(o||t?i.transform=aPe(e,n.transform,t):i.transform&&(i.transform="none")),a){const{originX:l="50%",originY:h="50%",originZ:u=0}=s;i.transformOrigin=`${l} ${h} ${u}`}}const hI=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function YY(n,e,t){for(const i in e)!Zl(e[i])&&!XY(i,t)&&(n[i]=e[i])}function lPe({transformTemplate:n},e){return H.useMemo(()=>{const t=hI();return cI(t,e,n),Object.assign({},t.vars,t.style)},[e])}function cPe(n,e){const t=n.style||{},i={};return YY(i,t,n),Object.assign(i,lPe(n,e)),i}function hPe(n,e){const t={},i=cPe(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=i,t}const uPe={offset:"stroke-dashoffset",array:"stroke-dasharray"},dPe={offset:"strokeDashoffset",array:"strokeDasharray"};function APe(n,e,t=1,i=0,r=!0){n.pathLength=1;const s=r?uPe:dPe;n[s.offset]=Fr.transform(-i);const o=Fr.transform(e),a=Fr.transform(t);n[s.array]=`${o} ${a}`}function KY(n,{attrX:e,attrY:t,attrScale:i,pathLength:r,pathSpacing:s=1,pathOffset:o=0,...a},l,h,u){if(cI(n,a,h),l){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:d,style:A}=n;d.transform&&(A.transform=d.transform,delete d.transform),(A.transform||d.transformOrigin)&&(A.transformOrigin=d.transformOrigin??"50% 50%",delete d.transformOrigin),A.transform&&(A.transformBox=(u==null?void 0:u.transformBox)??"fill-box",delete d.transformBox),e!==void 0&&(d.x=e),t!==void 0&&(d.y=t),i!==void 0&&(d.scale=i),r!==void 0&&APe(d,r,s,o,!1)}const qY=()=>({...hI(),attrs:{}}),ZY=n=>typeof n=="string"&&n.toLowerCase()==="svg";function fPe(n,e,t,i){const r=H.useMemo(()=>{const s=qY();return KY(s,e,ZY(i),n.transformTemplate,n.style),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};YY(s,n.style,n),r.style={...s,...r.style}}return r}const pPe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function uI(n){return typeof n!="string"||n.includes("-")?!1:!!(pPe.indexOf(n)>-1||/[A-Z]/u.test(n))}function gPe(n,e,t,{latestValues:i},r,s=!1){const a=(uI(n)?fPe:hPe)(e,i,r,n),l=tPe(e,typeof n=="string",s),h=n!==H.Fragment?{...l,...a,ref:t}:{},{children:u}=e,d=H.useMemo(()=>Zl(u)?u.get():u,[u]);return H.createElement(n,{...h,children:d})}function m9(n){const e=[{},{}];return n==null||n.values.forEach((t,i)=>{e[0][i]=t.get(),e[1][i]=t.getVelocity()}),e}function dI(n,e,t,i){if(typeof e=="function"){const[r,s]=m9(i);e=e(t!==void 0?t:n.custom,r,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[r,s]=m9(i);e=e(t!==void 0?t:n.custom,r,s)}return e}function vC(n){return Zl(n)?n.get():n}function mPe({scrapeMotionValuesFromProps:n,createRenderState:e},t,i,r){return{latestValues:yPe(t,i,r,n),renderState:e()}}function yPe(n,e,t,i){const r={},s=i(n,{});for(const A in s)r[A]=vC(s[A]);let{initial:o,animate:a}=n;const l=xS(n),h=GY(n);e&&h&&!l&&n.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let u=t?t.initial===!1:!1;u=u||o===!1;const d=u?a:o;if(d&&typeof d!="boolean"&&!vS(d)){const A=Array.isArray(d)?d:[d];for(let f=0;f<A.length;f++){const p=dI(n,A[f]);if(p){const{transitionEnd:g,transition:v,...w}=p;for(const m in w){let y=w[m];if(Array.isArray(y)){const x=u?y.length-1:0;y=y[x]}y!==null&&(r[m]=y)}for(const m in g)r[m]=g[m]}}}return r}const JY=n=>(e,t)=>{const i=H.useContext(wS),r=H.useContext(mS),s=()=>mPe(n,e,i,r);return t?s():jv(s)};function AI(n,e,t){var s;const{style:i}=n,r={};for(const o in i)(Zl(i[o])||e.style&&Zl(e.style[o])||XY(o,n)||((s=t==null?void 0:t.getValue(o))==null?void 0:s.liveStyle)!==void 0)&&(r[o]=i[o]);return r}const wPe=JY({scrapeMotionValuesFromProps:AI,createRenderState:hI});function eK(n,e,t){const i=AI(n,e,t);for(const r in n)if(Zl(n[r])||Zl(e[r])){const s=z1.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[s]=n[r]}return i}const vPe=JY({scrapeMotionValuesFromProps:eK,createRenderState:qY}),xPe=Symbol.for("motionComponentSymbol");function Fm(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function bPe(n,e,t){return H.useCallback(i=>{i&&n.onMount&&n.onMount(i),e&&(i?e.mount(i):e.unmount()),t&&(typeof t=="function"?t(i):Fm(t)&&(t.current=i))},[e])}const fI=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),CPe="framerAppearId",tK="data-"+fI(CPe),nK=H.createContext({});function _Pe(n,e,t,i,r){var g,v;const{visualElement:s}=H.useContext(wS),o=H.useContext($Y),a=H.useContext(mS),l=H.useContext(Mv).reducedMotion,h=H.useRef(null);i=i||o.renderer,!h.current&&i&&(h.current=i(n,{visualState:e,parent:s,props:t,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:l}));const u=h.current,d=H.useContext(nK);u&&!u.projection&&r&&(u.type==="html"||u.type==="svg")&&SPe(h.current,t,r,d);const A=H.useRef(!1);H.useInsertionEffect(()=>{u&&A.current&&u.update(t,a)});const f=t[tK],p=H.useRef(!!f&&!((g=window.MotionHandoffIsComplete)!=null&&g.call(window,f))&&((v=window.MotionHasOptimisedAnimation)==null?void 0:v.call(window,f)));return O8(()=>{u&&(A.current=!0,window.MotionIsMounted=!0,u.updateFeatures(),u.scheduleRenderMicrotask(),p.current&&u.animationState&&u.animationState.animateChanges())}),H.useEffect(()=>{u&&(!p.current&&u.animationState&&u.animationState.animateChanges(),p.current&&(queueMicrotask(()=>{var w;(w=window.MotionHandoffMarkAsComplete)==null||w.call(window,f)}),p.current=!1),u.enteringChildren=void 0)}),u}function SPe(n,e,t,i){const{layoutId:r,layout:s,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:h,layoutCrossfade:u}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:iK(n.parent)),n.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:!!o||a&&Fm(a),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:i,crossfade:u,layoutScroll:l,layoutRoot:h})}function iK(n){if(n)return n.options.allowProjection!==!1?n.projection:iK(n.parent)}function UT(n,{forwardMotionProps:e=!1}={},t,i){t&&Zje(t);const r=uI(n)?vPe:wPe;function s(a,l){let h;const u={...H.useContext(Mv),...a,layoutId:TPe(a)},{isStatic:d}=u,A=iPe(a),f=r(a,d);if(!d&&U8){BPe();const p=EPe(u);h=p.MeasureLayout,A.visualElement=_Pe(n,f,u,i,p.ProjectionNode)}return c.jsxs(wS.Provider,{value:A,children:[h&&A.visualElement?c.jsx(h,{visualElement:A.visualElement,...u}):null,gPe(n,a,bPe(f,A.visualElement,l),f,d,e)]})}s.displayName=`motion.${typeof n=="string"?n:`create(${n.displayName??n.name??""})`}`;const o=H.forwardRef(s);return o[xPe]=n,o}function TPe({layoutId:n}){const e=H.useContext(R8).id;return e&&n!==void 0?e+"-"+n:n}function BPe(n,e){H.useContext($Y).strict}function EPe(n){const{drag:e,layout:t}=m1;if(!e&&!t)return{};const i={...e,...t};return{MeasureLayout:e!=null&&e.isEnabled(n)||t!=null&&t.isEnabled(n)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}function FPe(n,e){if(typeof Proxy>"u")return UT;const t=new Map,i=(s,o)=>UT(s,o,n,e),r=(s,o)=>i(s,o);return new Proxy(r,{get:(s,o)=>o==="create"?i:(t.has(o)||t.set(o,UT(o,void 0,n,e)),t.get(o))})}function rK({top:n,left:e,right:t,bottom:i}){return{x:{min:e,max:t},y:{min:n,max:i}}}function kPe({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function IPe(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),i=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:i.y,right:i.x}}function OT(n){return n===void 0||n===1}function O6({scale:n,scaleX:e,scaleY:t}){return!OT(n)||!OT(e)||!OT(t)}function Tg(n){return O6(n)||sK(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function sK(n){return y9(n.x)||y9(n.y)}function y9(n){return n&&n!=="0%"}function V_(n,e,t){const i=n-t,r=e*i;return t+r}function w9(n,e,t,i,r){return r!==void 0&&(n=V_(n,r,i)),V_(n,t,i)+e}function H6(n,e=0,t=1,i,r){n.min=w9(n.min,e,t,i,r),n.max=w9(n.max,e,t,i,r)}function oK(n,{x:e,y:t}){H6(n.x,e.translate,e.scale,e.originPoint),H6(n.y,t.translate,t.scale,t.originPoint)}const v9=.999999999999,x9=1.0000000000001;function DPe(n,e,t,i=!1){const r=t.length;if(!r)return;e.x=e.y=1;let s,o;for(let a=0;a<r;a++){s=t[a],o=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Im(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,oK(n,o)),i&&Tg(s.latestValues)&&Im(n,s.latestValues))}e.x<x9&&e.x>v9&&(e.x=1),e.y<x9&&e.y>v9&&(e.y=1)}function km(n,e){n.min=n.min+e,n.max=n.max+e}function b9(n,e,t,i,r=.5){const s=ma(n.min,n.max,r);H6(n,e,t,s,i)}function Im(n,e){b9(n.x,e.x,e.scaleX,e.scale,e.originX),b9(n.y,e.y,e.scaleY,e.scale,e.originY)}function aK(n,e){return rK(IPe(n.getBoundingClientRect(),e))}function jPe(n,e,t){const i=aK(n,t),{scroll:r}=e;return r&&(km(i.x,r.offset.x),km(i.y,r.offset.y)),i}const C9=()=>({translate:0,scale:1,origin:0,originPoint:0}),Dm=()=>({x:C9(),y:C9()}),_9=()=>({min:0,max:0}),el=()=>({x:_9(),y:_9()}),W6={current:null},lK={current:!1};function PPe(){if(lK.current=!0,!!U8)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>W6.current=n.matches;n.addEventListener("change",e),e()}else W6.current=!1}const NPe=new WeakMap;function LPe(n,e,t){for(const i in e){const r=e[i],s=t[i];if(Zl(r))n.addValue(i,r);else if(Zl(s))n.addValue(i,d0(r,{owner:n}));else if(s!==r)if(n.hasValue(i)){const o=n.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=n.getStaticValue(i);n.addValue(i,d0(o!==void 0?o:r,{owner:n}))}}for(const i in t)e[i]===void 0&&n.removeValue(i);return e}const S9=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class MPe{scrapeMotionValuesFromProps(e,t,i){return{}}constructor({parent:e,props:t,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=nI,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const A=jh.now();this.renderScheduledAt<A&&(this.renderScheduledAt=A,$o.render(this.render,!1,!0))};const{latestValues:l,renderState:h}=o;this.latestValues=l,this.baseTarget={...l},this.initialValues=t.initial?{...l}:{},this.renderState=h,this.parent=e,this.props=t,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=a,this.blockInitialAnimation=!!s,this.isControllingVariants=xS(t),this.isVariantNode=GY(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(t,{},this);for(const A in d){const f=d[A];l[A]!==void 0&&Zl(f)&&f.set(l[A])}}mount(e){var t;this.current=e,NPe.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((i,r)=>this.bindToMotionValue(r,i)),lK.current||PPe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:W6.current,(t=this.parent)==null||t.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),Ff(this.notifyUpdate),Ff(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(e=this.parent)==null||e.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const i=this.features[t];i&&(i.unmount(),i.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=Q1.has(e);i&&this.onBindTransform&&this.onBindTransform();const r=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&$o.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let s;window.MotionCheckAppearSync&&(s=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),s&&s(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in m1){const t=m1[e];if(!t)continue;const{isEnabled:i,Feature:r}=t;if(!this.features[e]&&r&&i(this.props)&&(this.features[e]=new r(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):el()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let i=0;i<S9.length;i++){const r=S9[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s="on"+r,o=e[s];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=LPe(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const i=this.values.get(e);t!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&t!==void 0&&(i=d0(t===null?void 0:t,{owner:this}),this.addValue(e,i)),i}readValue(e,t){let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(JX(i)||tY(i))?i=parseFloat(i):!Gje(i)&&$p.test(t)&&(i=MY(e,t)),this.setBaseTarget(e,Zl(i)?i.get():i)),Zl(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var s;const{initial:t}=this.props;let i;if(typeof t=="string"||typeof t=="object"){const o=dI(this.props,t,(s=this.presenceContext)==null?void 0:s.custom);o&&(i=o[e])}if(t&&i!==void 0)return i;const r=this.getBaseTargetFromProps(this.props,e);return r!==void 0&&!Zl(r)?r:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new $8),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){sI.render(this.render)}}class cK extends MPe{constructor(){super(...arguments),this.KeyframeResolver=jje}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:i}){delete t[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Zl(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function hK(n,{style:e,vars:t},i,r){const s=n.style;let o;for(o in e)s[o]=e[o];r==null||r.applyProjectionStyles(s,i);for(o in t)s.setProperty(o,t[o])}function RPe(n){return window.getComputedStyle(n)}class UPe extends cK{constructor(){super(...arguments),this.type="html",this.renderInstance=hK}readValueFromInstance(e,t){var i;if(Q1.has(t))return(i=this.projection)!=null&&i.isProjecting?j6(t):ZDe(e,t);{const r=RPe(e),s=(X8(t)?r.getPropertyValue(t):r[t])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:t}){return aK(e,t)}build(e,t,i){cI(e,t,i.transformTemplate)}scrapeMotionValuesFromProps(e,t,i){return AI(e,t,i)}}const uK=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function OPe(n,e,t,i){hK(n,e,void 0,i);for(const r in e.attrs)n.setAttribute(uK.has(r)?r:fI(r),e.attrs[r])}class HPe extends cK{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=el}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Q1.has(t)){const i=LY(t);return i&&i.default||0}return t=uK.has(t)?t:fI(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,i){return eK(e,t,i)}build(e,t,i){KY(e,t,this.isSVGTag,i.transformTemplate,i.style)}renderInstance(e,t,i,r){OPe(e,t,i,r)}mount(e){this.isSVGTag=ZY(e.tagName),super.mount(e)}}const WPe=(n,e)=>uI(n)?new HPe(e):new UPe(e,{allowProjection:n!==H.Fragment});function Ym(n,e,t){const i=n.getProps();return dI(i,e,t!==void 0?t:i.custom,n)}const z6=n=>Array.isArray(n);function zPe(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,d0(t))}function QPe(n){return z6(n)?n[n.length-1]||0:n}function $Pe(n,e){const t=Ym(n,e);let{transitionEnd:i={},transition:r={},...s}=t||{};s={...s,...i};for(const o in s){const a=QPe(s[o]);zPe(n,o,a)}}function VPe(n){return!!(Zl(n)&&n.add)}function Q6(n,e){const t=n.getValue("willChange");if(VPe(t))return t.add(e);if(!t&&Ef.WillChange){const i=new Ef.WillChange("auto");n.addValue("willChange",i),i.add(e)}}function dK(n){return n.props[tK]}const GPe=n=>n!==null;function XPe(n,{repeat:e,repeatType:t="loop"},i){const r=n.filter(GPe),s=e&&t!=="loop"&&e%2===1?0:r.length-1;return r[s]}const YPe={type:"spring",stiffness:500,damping:25,restSpeed:10},KPe=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),qPe={type:"keyframes",duration:.8},ZPe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},JPe=(n,{keyframes:e})=>e.length>2?qPe:Q1.has(n)?n.startsWith("scale")?KPe(e[1]):YPe:ZPe;function eNe({when:n,delay:e,delayChildren:t,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:a,from:l,elapsed:h,...u}){return!!Object.keys(u).length}const pI=(n,e,t,i={},r,s)=>o=>{const a=iI(i,n)||{},l=a.delay||i.delay||0;let{elapsed:h=0}=i;h=h-AA(l);const u={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-h,onUpdate:A=>{e.set(A),a.onUpdate&&a.onUpdate(A)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:n,motionValue:e,element:s?void 0:r};eNe(a)||Object.assign(u,JPe(n,u)),u.duration&&(u.duration=AA(u.duration)),u.repeatDelay&&(u.repeatDelay=AA(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let d=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(R6(u),u.delay===0&&(d=!0)),(Ef.instantAnimations||Ef.skipAnimations)&&(d=!0,R6(u),u.delay=0),u.allowFlatten=!a.type&&!a.ease,d&&!s&&e.get()!==void 0){const A=XPe(u.keyframes,a);if(A!==void 0){$o.update(()=>{u.onUpdate(A),u.onComplete()});return}}return a.isSync?new yS(u):new xje(u)};function tNe({protectedKeys:n,needsAnimating:e},t){const i=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,i}function AK(n,e,{delay:t=0,transitionOverride:i,type:r}={}){let{transition:s=n.getDefaultTransition(),transitionEnd:o,...a}=e;i&&(s=i);const l=[],h=r&&n.animationState&&n.animationState.getState()[r];for(const u in a){const d=n.getValue(u,n.latestValues[u]??null),A=a[u];if(A===void 0||h&&tNe(h,u))continue;const f={delay:t,...iI(s||{},u)},p=d.get();if(p!==void 0&&!d.isAnimating&&!Array.isArray(A)&&A===p&&!f.velocity)continue;let g=!1;if(window.MotionHandoffAnimation){const w=dK(n);if(w){const m=window.MotionHandoffAnimation(w,u,$o);m!==null&&(f.startTime=m,g=!0)}}Q6(n,u),d.start(pI(u,d,A,n.shouldReduceMotion&&jY.has(u)?{type:!1}:f,n,g));const v=d.animation;v&&l.push(v)}return o&&Promise.all(l).then(()=>{$o.update(()=>{o&&$Pe(n,o)})}),l}function fK(n,e,t,i=0,r=1){const s=Array.from(n).sort((h,u)=>h.sortNodePosition(u)).indexOf(e),o=n.size,a=(o-1)*i;return typeof t=="function"?t(s,o):r===1?s*i:a-s*i}function $6(n,e,t={}){var l;const i=Ym(n,e,t.type==="exit"?(l=n.presenceContext)==null?void 0:l.custom:void 0);let{transition:r=n.getDefaultTransition()||{}}=i||{};t.transitionOverride&&(r=t.transitionOverride);const s=i?()=>Promise.all(AK(n,i,t)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(h=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:A}=r;return nNe(n,e,h,u,d,A,t)}:()=>Promise.resolve(),{when:a}=r;if(a){const[h,u]=a==="beforeChildren"?[s,o]:[o,s];return h().then(()=>u())}else return Promise.all([s(),o(t.delay)])}function nNe(n,e,t=0,i=0,r=0,s=1,o){const a=[];for(const l of n.variantChildren)l.notify("AnimationStart",e),a.push($6(l,e,{...o,delay:t+(typeof i=="function"?0:i)+fK(n.variantChildren,l,i,r,s)}).then(()=>l.notify("AnimationComplete",e)));return Promise.all(a)}function iNe(n,e,t={}){n.notify("AnimationStart",e);let i;if(Array.isArray(e)){const r=e.map(s=>$6(n,s,t));i=Promise.all(r)}else if(typeof e=="string")i=$6(n,e,t);else{const r=typeof e=="function"?Ym(n,e,t.custom):e;i=Promise.all(AK(n,r,t))}return i.then(()=>{n.notify("AnimationComplete",e)})}function pK(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let i=0;i<t;i++)if(e[i]!==n[i])return!1;return!0}const rNe=lI.length;function gK(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?gK(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<rNe;t++){const i=lI[t],r=n.props[i];(Xw(r)||r===!1)&&(e[i]=r)}return e}const sNe=[...aI].reverse(),oNe=aI.length;function aNe(n){return e=>Promise.all(e.map(({animation:t,options:i})=>iNe(n,t,i)))}function lNe(n){let e=aNe(n),t=T9(),i=!0;const r=l=>(h,u)=>{var A;const d=Ym(n,u,l==="exit"?(A=n.presenceContext)==null?void 0:A.custom:void 0);if(d){const{transition:f,transitionEnd:p,...g}=d;h={...h,...g,...p}}return h};function s(l){e=l(n)}function o(l){const{props:h}=n,u=gK(n.parent)||{},d=[],A=new Set;let f={},p=1/0;for(let v=0;v<oNe;v++){const w=sNe[v],m=t[w],y=h[w]!==void 0?h[w]:u[w],x=Xw(y),S=w===l?m.isActive:null;S===!1&&(p=v);let I=y===u[w]&&y!==h[w]&&x;if(I&&i&&n.manuallyAnimateOnMount&&(I=!1),m.protectedKeys={...f},!m.isActive&&S===null||!y&&!m.prevProp||vS(y)||typeof y=="boolean")continue;const j=cNe(m.prevProp,y);let C=j||w===l&&m.isActive&&!I&&x||v>p&&x,b=!1;const D=Array.isArray(y)?y:[y];let T=D.reduce(r(w),{});S===!1&&(T={});const{prevResolvedValues:k={}}=m,B={...k,...T},E=L=>{C=!0,A.has(L)&&(b=!0,A.delete(L)),m.needsAnimating[L]=!0;const O=n.getValue(L);O&&(O.liveStyle=!1)};for(const L in B){const O=T[L],J=k[L];if(f.hasOwnProperty(L))continue;let $=!1;z6(O)&&z6(J)?$=!pK(O,J):$=O!==J,$?O!=null?E(L):A.add(L):O!==void 0&&A.has(L)?E(L):m.protectedKeys[L]=!0}m.prevProp=y,m.prevResolvedValues=T,m.isActive&&(f={...f,...T}),i&&n.blockInitialAnimation&&(C=!1);const z=I&&j;C&&(!z||b)&&d.push(...D.map(L=>{const O={type:w};if(typeof L=="string"&&i&&!z&&n.manuallyAnimateOnMount&&n.parent){const{parent:J}=n,$=Ym(J,L);if(J.enteringChildren&&$){const{delayChildren:U}=$.transition||{};O.delay=fK(J.enteringChildren,n,U)}}return{animation:L,options:O}}))}if(A.size){const v={};if(typeof h.initial!="boolean"){const w=Ym(n,Array.isArray(h.initial)?h.initial[0]:h.initial);w&&w.transition&&(v.transition=w.transition)}A.forEach(w=>{const m=n.getBaseTarget(w),y=n.getValue(w);y&&(y.liveStyle=!0),v[w]=m??null}),d.push({animation:v})}let g=!!d.length;return i&&(h.initial===!1||h.initial===h.animate)&&!n.manuallyAnimateOnMount&&(g=!1),i=!1,g?e(d):Promise.resolve()}function a(l,h){var d;if(t[l].isActive===h)return Promise.resolve();(d=n.variantChildren)==null||d.forEach(A=>{var f;return(f=A.animationState)==null?void 0:f.setActive(l,h)}),t[l].isActive=h;const u=o(l);for(const A in t)t[A].protectedKeys={};return u}return{animateChanges:o,setActive:a,setAnimateFunction:s,getState:()=>t,reset:()=>{t=T9(),i=!0}}}function cNe(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!pK(e,n):!1}function xg(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function T9(){return{animate:xg(!0),whileInView:xg(),whileHover:xg(),whileTap:xg(),whileDrag:xg(),whileFocus:xg(),exit:xg()}}class ng{constructor(e){this.isMounted=!1,this.node=e}update(){}}class hNe extends ng{constructor(e){super(e),e.animationState||(e.animationState=lNe(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();vS(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let uNe=0;class dNe extends ng{constructor(){super(...arguments),this.id=uNe++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const ANe={animation:{Feature:hNe},exit:{Feature:dNe}};function Kw(n,e,t,i={passive:!0}){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t)}function Rv(n){return{point:{x:n.pageX,y:n.pageY}}}const fNe=n=>e=>oI(e)&&n(e,Rv(e));function pw(n,e,t,i){return Kw(n,e,fNe(t),i)}const mK=1e-4,pNe=1-mK,gNe=1+mK,yK=.01,mNe=0-yK,yNe=0+yK;function ch(n){return n.max-n.min}function wNe(n,e,t){return Math.abs(n-e)<=t}function B9(n,e,t,i=.5){n.origin=i,n.originPoint=ma(e.min,e.max,n.origin),n.scale=ch(t)/ch(e),n.translate=ma(t.min,t.max,n.origin)-n.originPoint,(n.scale>=pNe&&n.scale<=gNe||isNaN(n.scale))&&(n.scale=1),(n.translate>=mNe&&n.translate<=yNe||isNaN(n.translate))&&(n.translate=0)}function gw(n,e,t,i){B9(n.x,e.x,t.x,i?i.originX:void 0),B9(n.y,e.y,t.y,i?i.originY:void 0)}function E9(n,e,t){n.min=t.min+e.min,n.max=n.min+ch(e)}function vNe(n,e,t){E9(n.x,e.x,t.x),E9(n.y,e.y,t.y)}function F9(n,e,t){n.min=e.min-t.min,n.max=n.min+ch(e)}function mw(n,e,t){F9(n.x,e.x,t.x),F9(n.y,e.y,t.y)}function xu(n){return[n("x"),n("y")]}const wK=({current:n})=>n?n.ownerDocument.defaultView:null,k9=(n,e)=>Math.abs(n-e);function xNe(n,e){const t=k9(n.x,e.x),i=k9(n.y,e.y);return Math.sqrt(t**2+i**2)}class vK{constructor(e,t,{transformPagePoint:i,contextWindow:r=window,dragSnapToOrigin:s=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const A=WT(this.lastMoveEventInfo,this.history),f=this.startEvent!==null,p=xNe(A.offset,{x:0,y:0})>=this.distanceThreshold;if(!f&&!p)return;const{point:g}=A,{timestamp:v}=Ac;this.history.push({...g,timestamp:v});const{onStart:w,onMove:m}=this.handlers;f||(w&&w(this.lastMoveEvent,A),this.startEvent=this.lastMoveEvent),m&&m(this.lastMoveEvent,A)},this.handlePointerMove=(A,f)=>{this.lastMoveEvent=A,this.lastMoveEventInfo=HT(f,this.transformPagePoint),$o.update(this.updatePoint,!0)},this.handlePointerUp=(A,f)=>{this.end();const{onEnd:p,onSessionEnd:g,resumeAnimation:v}=this.handlers;if(this.dragSnapToOrigin&&v&&v(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=WT(A.type==="pointercancel"?this.lastMoveEventInfo:HT(f,this.transformPagePoint),this.history);this.startEvent&&p&&p(A,w),g&&g(A,w)},!oI(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=i,this.distanceThreshold=o,this.contextWindow=r||window;const a=Rv(e),l=HT(a,this.transformPagePoint),{point:h}=l,{timestamp:u}=Ac;this.history=[{...h,timestamp:u}];const{onSessionStart:d}=t;d&&d(e,WT(l,this.history)),this.removeListeners=Pv(pw(this.contextWindow,"pointermove",this.handlePointerMove),pw(this.contextWindow,"pointerup",this.handlePointerUp),pw(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Ff(this.updatePoint)}}function HT(n,e){return e?{point:e(n.point)}:n}function I9(n,e){return{x:n.x-e.x,y:n.y-e.y}}function WT({point:n},e){return{point:n,delta:I9(n,xK(e)),offset:I9(n,bNe(e)),velocity:CNe(e,.1)}}function bNe(n){return n[0]}function xK(n){return n[n.length-1]}function CNe(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,i=null;const r=xK(n);for(;t>=0&&(i=n[t],!(r.timestamp-i.timestamp>AA(e)));)t--;if(!i)return{x:0,y:0};const s=fA(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function _Ne(n,{min:e,max:t},i){return e!==void 0&&n<e?n=i?ma(e,n,i.min):Math.max(n,e):t!==void 0&&n>t&&(n=i?ma(t,n,i.max):Math.min(n,t)),n}function D9(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function SNe(n,{top:e,left:t,bottom:i,right:r}){return{x:D9(n.x,t,r),y:D9(n.y,e,i)}}function j9(n,e){let t=e.min-n.min,i=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,i]=[i,t]),{min:t,max:i}}function TNe(n,e){return{x:j9(n.x,e.x),y:j9(n.y,e.y)}}function BNe(n,e){let t=.5;const i=ch(n),r=ch(e);return r>i?t=Qw(e.min,e.max-i,n.min):i>r&&(t=Qw(n.min,n.max-r,e.min)),Bf(0,1,t)}function ENe(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const V6=.35;function FNe(n=V6){return n===!1?n=0:n===!0&&(n=V6),{x:P9(n,"left","right"),y:P9(n,"top","bottom")}}function P9(n,e,t){return{min:N9(n,e),max:N9(n,t)}}function N9(n,e){return typeof n=="number"?n:n[e]||0}const kNe=new WeakMap;class INe{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=el(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:i}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=d=>{const{dragSnapToOrigin:A}=this.getProps();A?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(Rv(d).point)},o=(d,A)=>{const{drag:f,dragPropagation:p,onDragStart:g}=this.getProps();if(f&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Mje(f),!this.openDragLock))return;this.latestPointerEvent=d,this.latestPanInfo=A,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),xu(w=>{let m=this.getAxisMotionValue(w).get()||0;if(pA.test(m)){const{projection:y}=this.visualElement;if(y&&y.layout){const x=y.layout.layoutBox[w];x&&(m=ch(x)*(parseFloat(m)/100))}}this.originPoint[w]=m}),g&&$o.postRender(()=>g(d,A)),Q6(this.visualElement,"transform");const{animationState:v}=this.visualElement;v&&v.setActive("whileDrag",!0)},a=(d,A)=>{this.latestPointerEvent=d,this.latestPanInfo=A;const{dragPropagation:f,dragDirectionLock:p,onDirectionLock:g,onDrag:v}=this.getProps();if(!f&&!this.openDragLock)return;const{offset:w}=A;if(p&&this.currentDirection===null){this.currentDirection=DNe(w),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",A.point,w),this.updateAxis("y",A.point,w),this.visualElement.render(),v&&v(d,A)},l=(d,A)=>{this.latestPointerEvent=d,this.latestPanInfo=A,this.stop(d,A),this.latestPointerEvent=null,this.latestPanInfo=null},h=()=>xu(d=>{var A;return this.getAnimationState(d)==="paused"&&((A=this.getAxisMotionValue(d).animation)==null?void 0:A.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new vK(e,{onSessionStart:s,onStart:o,onMove:a,onSessionEnd:l,resumeAnimation:h},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,distanceThreshold:i,contextWindow:wK(this.visualElement)})}stop(e,t){const i=e||this.latestPointerEvent,r=t||this.latestPanInfo,s=this.isDragging;if(this.cancel(),!s||!r||!i)return;const{velocity:o}=r;this.startAnimation(o);const{onDragEnd:a}=this.getProps();a&&$o.postRender(()=>a(i,r))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,i){const{drag:r}=this.getProps();if(!i||!Ub(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(o=_Ne(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var s;const{dragConstraints:e,dragElastic:t}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(s=this.visualElement.projection)==null?void 0:s.layout,r=this.constraints;e&&Fm(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&i?this.constraints=SNe(i.layoutBox,e):this.constraints=!1,this.elastic=FNe(t),r!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&xu(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=ENe(i.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Fm(e))return!1;const i=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=jPe(i,r.root,this.visualElement.getTransformPagePoint());let o=TNe(r.layout.layoutBox,s);if(t){const a=t(kPe(o));this.hasMutatedConstraints=!!a,a&&(o=rK(a))}return o}startAnimation(e){const{drag:t,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},h=xu(u=>{if(!Ub(u,t,this.currentDirection))return;let d=l&&l[u]||{};o&&(d={min:0,max:0});const A=r?200:1e6,f=r?40:1e7,p={type:"inertia",velocity:i?e[u]:0,bounceStiffness:A,bounceDamping:f,timeConstant:750,restDelta:1,restSpeed:10,...s,...d};return this.startAxisValueAnimation(u,p)});return Promise.all(h).then(a)}startAxisValueAnimation(e,t){const i=this.getAxisMotionValue(e);return Q6(this.visualElement,e),i.start(pI(e,i,0,t,this.visualElement,!1))}stopAnimation(){xu(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){xu(e=>{var t;return(t=this.getAxisMotionValue(e).animation)==null?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)==null?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),r=i[t];return r||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){xu(t=>{const{drag:i}=this.getProps();if(!Ub(t,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(t);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[t];s.set(e[t]-ma(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:i}=this.visualElement;if(!Fm(t)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};xu(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const l=a.get();r[o]=BNe({min:l,max:l},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),xu(o=>{if(!Ub(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:h}=this.constraints[o];a.set(ma(l,h,r[o]))})}addListeners(){if(!this.visualElement.current)return;kNe.set(this.visualElement,this);const e=this.visualElement.current,t=pw(e,"pointerdown",l=>{const{drag:h,dragListener:u=!0}=this.getProps();h&&u&&this.start(l)}),i=()=>{const{dragConstraints:l}=this.getProps();Fm(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),$o.read(i);const o=Kw(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",(({delta:l,hasLayoutChanged:h})=>{this.isDragging&&h&&(xu(u=>{const d=this.getAxisMotionValue(u);d&&(this.originPoint[u]+=l[u].translate,d.set(d.get()+l[u].translate))}),this.visualElement.render())}));return()=>{o(),t(),s(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=V6,dragMomentum:a=!0}=e;return{...e,drag:t,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:a}}}function Ub(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function DNe(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class jNe extends ng{constructor(e){super(e),this.removeGroupControls=Nu,this.removeListeners=Nu,this.controls=new INe(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Nu}unmount(){this.removeGroupControls(),this.removeListeners()}}const L9=n=>(e,t)=>{n&&$o.postRender(()=>n(e,t))};class PNe extends ng{constructor(){super(...arguments),this.removePointerDownListener=Nu}onPointerDown(e){this.session=new vK(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:wK(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:L9(e),onStart:L9(t),onMove:i,onEnd:(s,o)=>{delete this.session,r&&$o.postRender(()=>r(s,o))}}}mount(){this.removePointerDownListener=pw(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const xC={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function M9(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const v2={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(Fr.test(n))n=parseFloat(n);else return n;const t=M9(n,e.target.x),i=M9(n,e.target.y);return`${t}% ${i}%`}},NNe={correct:(n,{treeScale:e,projectionDelta:t})=>{const i=n,r=$p.parse(n);if(r.length>5)return i;const s=$p.createTransformer(n),o=typeof r[0]!="number"?1:0,a=t.x.scale*e.x,l=t.y.scale*e.y;r[0+o]/=a,r[1+o]/=l;const h=ma(a,l,.5);return typeof r[2+o]=="number"&&(r[2+o]/=h),typeof r[3+o]=="number"&&(r[3+o]/=h),s(r)}};let zT=!1;class LNe extends H.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=e;rPe(MNe),s&&(t.group&&t.group.add(s),i&&i.register&&r&&i.register(s),zT&&s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),xC.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:i,drag:r,isPresent:s}=this.props,{projection:o}=i;return o&&(o.isPresent=s,zT=!0,r||e.layoutDependency!==t||t===void 0||e.isPresent!==s?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||$o.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),sI.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i}=this.props,{projection:r}=e;zT=!0,r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function bK(n){const[e,t]=QY(),i=H.useContext(R8);return c.jsx(LNe,{...n,layoutGroup:i,switchLayoutGroup:H.useContext(nK),isPresent:e,safeToRemove:t})}const MNe={borderRadius:{...v2,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:v2,borderTopRightRadius:v2,borderBottomLeftRadius:v2,borderBottomRightRadius:v2,boxShadow:NNe};function RNe(n,e,t){const i=Zl(n)?n:d0(n);return i.start(pI("",i,e,t)),i.animation}const UNe=(n,e)=>n.depth-e.depth;class ONe{constructor(){this.children=[],this.isDirty=!1}add(e){H8(this.children,e),this.isDirty=!0}remove(e){W8(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(UNe),this.isDirty=!1,this.children.forEach(e)}}function HNe(n,e){const t=jh.now(),i=({timestamp:r})=>{const s=r-t;s>=e&&(Ff(i),n(s-e))};return $o.setup(i,!0),()=>Ff(i)}const CK=["TopLeft","TopRight","BottomLeft","BottomRight"],WNe=CK.length,R9=n=>typeof n=="string"?parseFloat(n):n,U9=n=>typeof n=="number"||Fr.test(n);function zNe(n,e,t,i,r,s){r?(n.opacity=ma(0,t.opacity??1,QNe(i)),n.opacityExit=ma(e.opacity??1,0,$Ne(i))):s&&(n.opacity=ma(e.opacity??1,t.opacity??1,i));for(let o=0;o<WNe;o++){const a=`border${CK[o]}Radius`;let l=O9(e,a),h=O9(t,a);if(l===void 0&&h===void 0)continue;l||(l=0),h||(h=0),l===0||h===0||U9(l)===U9(h)?(n[a]=Math.max(ma(R9(l),R9(h),i),0),(pA.test(h)||pA.test(l))&&(n[a]+="%")):n[a]=h}(e.rotate||t.rotate)&&(n.rotate=ma(e.rotate||0,t.rotate||0,i))}function O9(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const QNe=_K(0,.5,cY),$Ne=_K(.5,.95,Nu);function _K(n,e,t){return i=>i<n?0:i>e?1:t(Qw(n,e,i))}function H9(n,e){n.min=e.min,n.max=e.max}function gu(n,e){H9(n.x,e.x),H9(n.y,e.y)}function W9(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function z9(n,e,t,i,r){return n-=e,n=V_(n,1/t,i),r!==void 0&&(n=V_(n,1/r,i)),n}function VNe(n,e=0,t=1,i=.5,r,s=n,o=n){if(pA.test(e)&&(e=parseFloat(e),e=ma(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=ma(s.min,s.max,i);n===s&&(a-=e),n.min=z9(n.min,e,t,a,r),n.max=z9(n.max,e,t,a,r)}function Q9(n,e,[t,i,r],s,o){VNe(n,e[t],e[i],e[r],e.scale,s,o)}const GNe=["x","scaleX","originX"],XNe=["y","scaleY","originY"];function $9(n,e,t,i){Q9(n.x,e,GNe,t?t.x:void 0,i?i.x:void 0),Q9(n.y,e,XNe,t?t.y:void 0,i?i.y:void 0)}function V9(n){return n.translate===0&&n.scale===1}function SK(n){return V9(n.x)&&V9(n.y)}function G9(n,e){return n.min===e.min&&n.max===e.max}function YNe(n,e){return G9(n.x,e.x)&&G9(n.y,e.y)}function X9(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function TK(n,e){return X9(n.x,e.x)&&X9(n.y,e.y)}function Y9(n){return ch(n.x)/ch(n.y)}function K9(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class KNe{constructor(){this.members=[]}add(e){H8(this.members,e),e.scheduleRender()}remove(e){if(W8(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(r=>e===r);if(t===0)return!1;let i;for(let r=t;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(e,t){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,t&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:i}=e;t.onExitComplete&&t.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function qNe(n,e,t){let i="";const r=n.x.translate/e.x,s=n.y.translate/e.y,o=(t==null?void 0:t.z)||0;if((r||s||o)&&(i=`translate3d(${r}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:h,rotate:u,rotateX:d,rotateY:A,skewX:f,skewY:p}=t;h&&(i=`perspective(${h}px) ${i}`),u&&(i+=`rotate(${u}deg) `),d&&(i+=`rotateX(${d}deg) `),A&&(i+=`rotateY(${A}deg) `),f&&(i+=`skewX(${f}deg) `),p&&(i+=`skewY(${p}deg) `)}const a=n.x.scale*e.x,l=n.y.scale*e.y;return(a!==1||l!==1)&&(i+=`scale(${a}, ${l})`),i||"none"}const QT=["","X","Y","Z"],ZNe=1e3;let JNe=0;function $T(n,e,t,i){const{latestValues:r}=e;r[n]&&(t[n]=r[n],e.setStaticValue(n,0),i&&(i[n]=0))}function BK(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=dK(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:r,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",$o,!(r||s))}const{parent:i}=n;i&&!i.hasCheckedOptimisedAppear&&BK(i)}function EK({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},a=e==null?void 0:e()){this.id=JNe++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(nLe),this.nodes.forEach(oLe),this.nodes.forEach(aLe),this.nodes.forEach(iLe)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new ONe)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new $8),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=zY(o)&&!zje(o),this.instance=o;const{layoutId:a,layout:l,visualElement:h}=this.options;if(h&&!h.current&&h.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||a)&&(this.isLayoutDirty=!0),n){let u,d=0;const A=()=>this.root.updateBlockedByResize=!1;$o.read(()=>{d=window.innerWidth}),n(o,()=>{const f=window.innerWidth;f!==d&&(d=f,this.root.updateBlockedByResize=!0,u&&u(),u=HNe(A,250),xC.hasAnimatedSinceResize&&(xC.hasAnimatedSinceResize=!1,this.nodes.forEach(J9)))})}a&&this.root.registerSharedNode(a,this),this.options.animate!==!1&&h&&(a||l)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d,hasRelativeLayoutChanged:A,layout:f})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const p=this.options.transition||h.getDefaultTransition()||dLe,{onLayoutAnimationStart:g,onLayoutAnimationComplete:v}=h.getProps(),w=!this.targetLayout||!TK(this.targetLayout,f),m=!d&&A;if(this.options.layoutRoot||this.resumeFrom||m||d&&(w||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const y={...iI(p,"layout"),onPlay:g,onComplete:v};(h.shouldReduceMotion||this.options.layoutRoot)&&(y.delay=0,y.type=!1),this.startAnimation(y),this.setAnimationOrigin(u,m)}else d||J9(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=f})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Ff(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(lLe),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&BK(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const d=this.path[u];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(q9);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(Z9);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(sLe),this.nodes.forEach(eLe),this.nodes.forEach(tLe)):this.nodes.forEach(Z9),this.clearAllSnapshots();const a=jh.now();Ac.delta=Bf(0,1e3/60,a-Ac.timestamp),Ac.timestamp=a,Ac.isProcessing=!0,jT.update.process(Ac),jT.preRender.process(Ac),jT.render.process(Ac),Ac.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,sI.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(rLe),this.sharedNodes.forEach(cLe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,$o.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){$o.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!ch(this.snapshot.measuredBox.x)&&!ch(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=el(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a&&this.instance){const l=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!SK(this.projectionDelta),l=this.getTransformTemplate(),h=l?l(this.latestValues,""):void 0,u=h!==this.prevTransformTemplateValue;o&&this.instance&&(a||Tg(this.latestValues)||u)&&(r(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),ALe(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var h;const{visualElement:o}=this.options;if(!o)return el();const a=o.measureViewportBox();if(!(((h=this.scroll)==null?void 0:h.wasRoot)||this.path.some(fLe))){const{scroll:u}=this.root;u&&(km(a.x,u.offset.x),km(a.y,u.offset.y))}return a}removeElementScroll(o){var l;const a=el();if(gu(a,o),(l=this.scroll)!=null&&l.wasRoot)return a;for(let h=0;h<this.path.length;h++){const u=this.path[h],{scroll:d,options:A}=u;u!==this.root&&d&&A.layoutScroll&&(d.wasRoot&&gu(a,o),km(a.x,d.offset.x),km(a.y,d.offset.y))}return a}applyTransform(o,a=!1){const l=el();gu(l,o);for(let h=0;h<this.path.length;h++){const u=this.path[h];!a&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Im(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Tg(u.latestValues)&&Im(l,u.latestValues)}return Tg(this.latestValues)&&Im(l,this.latestValues),l}removeTransform(o){const a=el();gu(a,o);for(let l=0;l<this.path.length;l++){const h=this.path[l];if(!h.instance||!Tg(h.latestValues))continue;O6(h.latestValues)&&h.updateSnapshot();const u=el(),d=h.measurePageBox();gu(u,d),$9(a,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,u)}return Tg(this.latestValues)&&$9(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Ac.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var A;const a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==a;if(!(o||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(A=this.parent)!=null&&A.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:d}=this.options;if(!(!this.layout||!(u||d))){if(this.resolvedRelativeTargetAt=Ac.timestamp,!this.targetDelta&&!this.relativeTarget){const f=this.getClosestProjectingParent();f&&f.layout&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=el(),this.relativeTargetOrigin=el(),mw(this.relativeTargetOrigin,this.layout.layoutBox,f.layout.layoutBox),gu(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=el(),this.targetWithTransforms=el()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),vNe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):gu(this.target,this.layout.layoutBox),oK(this.target,this.targetDelta)):gu(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const f=this.getClosestProjectingParent();f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=el(),this.relativeTargetOrigin=el(),mw(this.relativeTargetOrigin,this.target,f.target),gu(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||O6(this.parent.latestValues)||sK(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var p;const o=this.getLead(),a=!!this.resumingFrom||this!==o;let l=!0;if((this.isProjectionDirty||(p=this.parent)!=null&&p.isProjectionDirty)&&(l=!1),a&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===Ac.timestamp&&(l=!1),l)return;const{layout:h,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||u))return;gu(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,A=this.treeScale.y;DPe(this.layoutCorrected,this.treeScale,this.path,a),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=el());const{target:f}=o;if(!f){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(W9(this.prevProjectionDelta.x,this.projectionDelta.x),W9(this.prevProjectionDelta.y,this.projectionDelta.y)),gw(this.projectionDelta,this.layoutCorrected,f,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==A||!K9(this.projectionDelta.x,this.prevProjectionDelta.x)||!K9(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",f))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)==null||a.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Dm(),this.projectionDelta=Dm(),this.projectionDeltaWithTransform=Dm()}setAnimationOrigin(o,a=!1){const l=this.snapshot,h=l?l.latestValues:{},u={...this.latestValues},d=Dm();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const A=el(),f=l?l.source:void 0,p=this.layout?this.layout.source:void 0,g=f!==p,v=this.getStack(),w=!v||v.members.length<=1,m=!!(g&&!w&&this.options.crossfade===!0&&!this.path.some(uLe));this.animationProgress=0;let y;this.mixTargetDelta=x=>{const S=x/1e3;eR(d.x,o.x,S),eR(d.y,o.y,S),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(mw(A,this.layout.layoutBox,this.relativeParent.layout.layoutBox),hLe(this.relativeTarget,this.relativeTargetOrigin,A,S),y&&YNe(this.relativeTarget,y)&&(this.isProjectionDirty=!1),y||(y=el()),gu(y,this.relativeTarget)),g&&(this.animationValues=u,zNe(u,h,this.latestValues,S,m,w)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=S},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){var a,l,h;this.notifyListeners("animationStart"),(a=this.currentAnimation)==null||a.stop(),(h=(l=this.resumingFrom)==null?void 0:l.currentAnimation)==null||h.stop(),this.pendingAnimation&&(Ff(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=$o.update(()=>{xC.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=d0(0)),this.currentAnimation=RNe(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:u=>{this.mixTargetDelta(u),o.onUpdate&&o.onUpdate(u)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(ZNe),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:h,latestValues:u}=o;if(!(!a||!l||!h)){if(this!==o&&this.layout&&h&&FK(this.options.animationType,this.layout.layoutBox,h.layoutBox)){l=this.target||el();const d=ch(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+d;const A=ch(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+A}gu(a,l),Im(a,u),gw(this.projectionDeltaWithTransform,this.layoutCorrected,a,u)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new KNe),this.sharedNodes.get(o).add(a);const h=a.options.initialPromotionConfig;a.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())==null?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())==null?void 0:a.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const h=this.getStack();h&&h.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const h={};l.z&&$T("z",o,h,this.animationValues);for(let u=0;u<QT.length;u++)$T(`rotate${QT[u]}`,o,h,this.animationValues),$T(`skew${QT[u]}`,o,h,this.animationValues);o.render();for(const u in h)o.setStaticValue(u,h[u]),this.animationValues&&(this.animationValues[u]=h[u]);o.scheduleRender()}applyProjectionStyles(o,a){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=vC(a==null?void 0:a.pointerEvents)||"",o.transform=l?l(this.latestValues,""):"none";return}const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=vC(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!Tg(this.latestValues)&&(o.transform=l?l({},""):"none",this.hasProjected=!1);return}o.visibility="";const u=h.animationValues||h.latestValues;this.applyTransformsToTarget();let d=qNe(this.projectionDeltaWithTransform,this.treeScale,u);l&&(d=l(u,d)),o.transform=d;const{x:A,y:f}=this.projectionDelta;o.transformOrigin=`${A.origin*100}% ${f.origin*100}% 0`,h.animationValues?o.opacity=h===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:o.opacity=h===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const p in Yw){if(u[p]===void 0)continue;const{correct:g,applyTo:v,isCSSVariable:w}=Yw[p],m=d==="none"?u[p]:g(u[p],h);if(v){const y=v.length;for(let x=0;x<y;x++)o[v[x]]=m}else w?this.options.visualElement.renderState.vars[p]=m:o[p]=m}this.options.layoutId&&(o.pointerEvents=h===this?vC(a==null?void 0:a.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)==null?void 0:a.stop()}),this.root.nodes.forEach(q9),this.root.sharedNodes.clear()}}}function eLe(n){n.updateLayout()}function tLe(n){var t;const e=((t=n.resumeFrom)==null?void 0:t.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&e&&n.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=n.layout,{animationType:s}=n.options,o=e.source!==n.layout.source;s==="size"?xu(d=>{const A=o?e.measuredBox[d]:e.layoutBox[d],f=ch(A);A.min=i[d].min,A.max=A.min+f}):FK(s,e.layoutBox,i)&&xu(d=>{const A=o?e.measuredBox[d]:e.layoutBox[d],f=ch(i[d]);A.max=A.min+f,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[d].max=n.relativeTarget[d].min+f)});const a=Dm();gw(a,i,e.layoutBox);const l=Dm();o?gw(l,n.applyTransform(r,!0),e.measuredBox):gw(l,i,e.layoutBox);const h=!SK(a);let u=!1;if(!n.resumeFrom){const d=n.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:A,layout:f}=d;if(A&&f){const p=el();mw(p,e.layoutBox,A.layoutBox);const g=el();mw(g,i,f.layoutBox),TK(p,g)||(u=!0),d.options.layoutRoot&&(n.relativeTarget=g,n.relativeTargetOrigin=p,n.relativeParent=d)}}}n.notifyListeners("didUpdate",{layout:i,snapshot:e,delta:l,layoutDelta:a,hasLayoutChanged:h,hasRelativeLayoutChanged:u})}else if(n.isLead()){const{onExitComplete:i}=n.options;i&&i()}n.options.transition=void 0}function nLe(n){n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function iLe(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function rLe(n){n.clearSnapshot()}function q9(n){n.clearMeasurements()}function Z9(n){n.isLayoutDirty=!1}function sLe(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function J9(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function oLe(n){n.resolveTargetDelta()}function aLe(n){n.calcProjection()}function lLe(n){n.resetSkewAndRotation()}function cLe(n){n.removeLeadSnapshot()}function eR(n,e,t){n.translate=ma(e.translate,0,t),n.scale=ma(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function tR(n,e,t,i){n.min=ma(e.min,t.min,i),n.max=ma(e.max,t.max,i)}function hLe(n,e,t,i){tR(n.x,e.x,t.x,i),tR(n.y,e.y,t.y,i)}function uLe(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const dLe={duration:.45,ease:[.4,0,.1,1]},nR=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),iR=nR("applewebkit/")&&!nR("chrome/")?Math.round:Nu;function rR(n){n.min=iR(n.min),n.max=iR(n.max)}function ALe(n){rR(n.x),rR(n.y)}function FK(n,e,t){return n==="position"||n==="preserve-aspect"&&!wNe(Y9(e),Y9(t),.2)}function fLe(n){var e;return n!==n.root&&((e=n.scroll)==null?void 0:e.wasRoot)}const pLe=EK({attachResizeListener:(n,e)=>Kw(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),VT={current:void 0},kK=EK({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!VT.current){const n=new pLe({});n.mount(window),n.setOptions({layoutScroll:!0}),VT.current=n}return VT.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),gLe={pan:{Feature:PNe},drag:{Feature:jNe,ProjectionNode:kK,MeasureLayout:bK}};function sR(n,e,t){const{props:i}=n;n.animationState&&i.whileHover&&n.animationState.setActive("whileHover",t==="Start");const r="onHover"+t,s=i[r];s&&$o.postRender(()=>s(e,Rv(e)))}class mLe extends ng{mount(){const{current:e}=this.node;e&&(this.unmount=Rje(e,(t,i)=>(sR(this.node,i,"Start"),r=>sR(this.node,r,"End"))))}unmount(){}}class yLe extends ng{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Pv(Kw(this.node.current,"focus",()=>this.onFocus()),Kw(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function oR(n,e,t){const{props:i}=n;if(n.current instanceof HTMLButtonElement&&n.current.disabled)return;n.animationState&&i.whileTap&&n.animationState.setActive("whileTap",t==="Start");const r="onTap"+(t==="End"?"":t),s=i[r];s&&$o.postRender(()=>s(e,Rv(e)))}class wLe extends ng{mount(){const{current:e}=this.node;e&&(this.unmount=Wje(e,(t,i)=>(oR(this.node,i,"Start"),(r,{success:s})=>oR(this.node,r,s?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const G6=new WeakMap,GT=new WeakMap,vLe=n=>{const e=G6.get(n.target);e&&e(n)},xLe=n=>{n.forEach(vLe)};function bLe({root:n,...e}){const t=n||document;GT.has(t)||GT.set(t,{});const i=GT.get(t),r=JSON.stringify(e);return i[r]||(i[r]=new IntersectionObserver(xLe,{root:n,...e})),i[r]}function CLe(n,e,t){const i=bLe(e);return G6.set(n,t),i.observe(n),()=>{G6.delete(n),i.unobserve(n)}}const _Le={some:0,all:1};class SLe extends ng{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:i,amount:r="some",once:s}=e,o={root:t?t.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:_Le[r]},a=l=>{const{isIntersecting:h}=l;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:u,onViewportLeave:d}=this.node.getProps(),A=h?u:d;A&&A(l)};return CLe(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(TLe(e,t))&&this.startObserver()}unmount(){}}function TLe({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const BLe={inView:{Feature:SLe},tap:{Feature:wLe},focus:{Feature:yLe},hover:{Feature:mLe}},ELe={layout:{ProjectionNode:kK,MeasureLayout:bK}},FLe={...ANe,...BLe,...gLe,...ELe},fr=FPe(FLe,WPe);function G_(n){const e=jv(()=>d0(n)),{isStatic:t}=H.useContext(Mv);if(t){const[,i]=H.useState(n);H.useEffect(()=>e.on("change",i),[])}return e}function IK(n,e){const t=G_(e()),i=()=>t.set(e());return i(),O8(()=>{const r=()=>$o.preRender(i,!1,!0),s=n.map(o=>o.on("change",r));return()=>{s.forEach(o=>o()),Ff(i)}}),t}function kLe(n){fw.current=[],n();const e=IK(fw.current,n);return fw.current=void 0,e}function Iy(n,e,t,i){if(typeof n=="function")return kLe(n);const r=typeof e=="function"?e:Qje(e,t,i);return Array.isArray(n)?aR(n,r):aR([n],([s])=>r(s))}function aR(n,e){const t=jv(()=>[]);return IK(n,()=>{t.length=0;const i=n.length;for(let r=0;r<i;r++)t[r]=n[r].get();return e(t)})}function lR(n,e={}){const{isStatic:t}=H.useContext(Mv),i=()=>Zl(n)?n.get():n;if(t)return Iy(i);const r=G_(i());return H.useInsertionEffect(()=>$je(r,n,e),[r,JSON.stringify(e)]),r}const bS="projectShares",ILe=async()=>{try{const n=await Wr();if(!n)return{shares:[],error:"로그인이 필요합니다."};const e=ru(jl(rr,bS),xl("ownerId","==",n.uid),xl("isActive","==",!0),w0("createdAt","desc")),t=await kd(e),i=[];return t.forEach(r=>{const s=r.data();i.push({id:r.id,...s})}),{shares:i,error:null}}catch(n){return console.error("공유한 프로젝트 목록 가져오기 에러:",n),{shares:[],error:"공유한 프로젝트 목록을 가져오는 중 오류가 발생했습니다."}}},DLe=async()=>{try{const n=await Wr();if(!n)return{shares:[],error:"로그인이 필요합니다."};const e=ru(jl(rr,bS),xl("sharedWith","==",n.email),xl("isActive","==",!0),w0("createdAt","desc")),t=await kd(e),i=[];return t.forEach(r=>{const s=r.data();i.push({id:r.id,...s})}),{shares:i,error:null}}catch(n){return console.error("공유받은 프로젝트 목록 가져오기 에러:",n),{shares:[],error:"공유받은 프로젝트 목록을 가져오는 중 오류가 발생했습니다."}}},jLe=async n=>{try{const e=await Wr();if(!e)return{error:"로그인이 필요합니다."};const t=ts(rr,bS,n),i=await Ru(t);return i.exists()?i.data().ownerId!==e.uid?{error:"공유를 취소할 권한이 없습니다."}:(await ql(t,{isActive:!1}),{error:null}):{error:"공유를 찾을 수 없습니다."}}catch(e){return console.error("공유 취소 에러:",e),{error:"공유 취소 중 오류가 발생했습니다."}}},PLe=async(n,e)=>{try{const t=await Wr();if(!t)return{error:"로그인이 필요합니다."};const i=ts(rr,bS,n),r=await Ru(i);return r.exists()?r.data().ownerId!==t.uid?{error:"권한을 변경할 수 없습니다."}:(await ql(i,{permission:e}),{error:null}):{error:"공유를 찾을 수 없습니다."}}catch(t){return console.error("공유 권한 변경 에러:",t),{error:"공유 권한 변경 중 오류가 발생했습니다."}}},NLe="_tabContent_14wpp_2",LLe="_tabHeader_14wpp_14",MLe="_tabTitle_14wpp_24",RLe="_tabActions_14wpp_35",ULe="_searchBox_14wpp_42",OLe="_searchInput_14wpp_53",HLe="_filterDropdown_14wpp_62",WLe="_filterSelect_14wpp_68",zLe="_subTabs_14wpp_78",QLe="_subTab_14wpp_78",$Le="_active_14wpp_100",VLe="_profileSections_14wpp_108",GLe="_sectionTab_14wpp_113",XLe="_contentArea_14wpp_139",YLe="_loadingState_14wpp_148",KLe="_spinner_14wpp_157",qLe="_spin_14wpp_157",ZLe="_errorState_14wpp_173",JLe="_errorMessage_14wpp_182",eMe="_retryButton_14wpp_189",tMe="_emptyState_14wpp_207",nMe="_bookmarkGrid_14wpp_239",iMe="_shareGrid_14wpp_240",rMe="_teamsGrid_14wpp_241",sMe="_bookmarkCard_14wpp_248",oMe="_shareCard_14wpp_249",aMe="_teamCard_14wpp_250",lMe="_bookmarkHeader_14wpp_267",cMe="_shareHeader_14wpp_268",hMe="_teamHeader_14wpp_269",uMe="_bookmarkIcon_14wpp_276",dMe="_shareIcon_14wpp_277",AMe="_teamIcon_14wpp_278",fMe="_bookmarkToggle_14wpp_290",pMe="_actionButton_14wpp_291",gMe="_danger_14wpp_311",mMe="_teamActions_14wpp_316",yMe="_bookmarkContent_14wpp_322",wMe="_shareContent_14wpp_323",vMe="_teamContent_14wpp_324",xMe="_bookmarkTitle_14wpp_328",bMe="_shareTitle_14wpp_329",CMe="_teamName_14wpp_330",_Me="_bookmarkMeta_14wpp_338",SMe="_shareMeta_14wpp_339",TMe="_teamMeta_14wpp_340",BMe="_bookmarkType_14wpp_347",EMe="_permissionBadge_14wpp_348",FMe="_roleBadge_14wpp_349",kMe="_personal_14wpp_356",IMe="_editor_14wpp_357",DMe="_owner_14wpp_358",jMe="_admin_14wpp_359",PMe="_shared_14wpp_364",NMe="_viewer_14wpp_365",LMe="_bookmarkDate_14wpp_373",MMe="_shareDate_14wpp_374",RMe="_teamDate_14wpp_375",UMe="_shareUser_14wpp_383",OMe="_memberCount_14wpp_384",HMe="_expiryDate_14wpp_392",WMe="_tabFooter_14wpp_398",zMe="_bookmarkStats_14wpp_406",QMe="_shareStats_14wpp_407",$Me="_filterInfo_14wpp_412",VMe="_createButton_14wpp_418",GMe="_shareButton_14wpp_419",XMe="_createTeamButton_14wpp_420",YMe="_invitationsSection_14wpp_441",KMe="_sectionTitle_14wpp_449",qMe="_invitationsList_14wpp_459",ZMe="_invitationCard_14wpp_465",JMe="_invitationContent_14wpp_475",e7e="_invitationDate_14wpp_487",t7e="_invitationActions_14wpp_495",n7e="_acceptButton_14wpp_500",i7e="_declineButton_14wpp_501",r7e="_profileSection_14wpp_108",s7e="_profileHeader_14wpp_524",o7e="_profileAvatar_14wpp_533",a7e="_profileBasicInfo_14wpp_550",l7e="_profileEmail_14wpp_563",c7e="_profileForm_14wpp_570",h7e="_notificationsSection_14wpp_571",u7e="_privacySection_14wpp_572",d7e="_formGroup_14wpp_576",A7e="_formRow_14wpp_608",f7e="_formActions_14wpp_614",p7e="_saveButton_14wpp_620",g7e="_settingsGroup_14wpp_645",m7e="_settingItem_14wpp_649",y7e="_settingInfo_14wpp_661",w7e="_sectionDescription_14wpp_673",v7e="_slider_14wpp_693",x7e="_modalOverlay_14wpp_726",b7e="_modal_14wpp_726",C7e="_modalHeader_14wpp_750",_7e="_modalContent_14wpp_778",S7e="_modalActions_14wpp_782",T7e="_membersList_14wpp_861",B7e="_memberItem_14wpp_869",E7e="_memberInfo_14wpp_879",F7e="_memberAvatar_14wpp_886",k7e="_memberDetails_14wpp_904",I7e="_memberName_14wpp_909",D7e="_memberEmail_14wpp_916",j7e="_memberRole_14wpp_924",P7e="_profileAvatarContainer_14wpp_929",N7e="_uploadingOverlay_14wpp_934",L7e="_avatarActions_14wpp_956",M7e="_avatarActionButton_14wpp_964",Rt={tabContent:NLe,tabHeader:LLe,tabTitle:MLe,tabActions:RLe,searchBox:ULe,searchInput:OLe,filterDropdown:HLe,filterSelect:WLe,subTabs:zLe,subTab:QLe,active:$Le,profileSections:VLe,sectionTab:GLe,contentArea:XLe,loadingState:YLe,spinner:KLe,spin:qLe,errorState:ZLe,errorMessage:JLe,retryButton:eMe,emptyState:tMe,bookmarkGrid:nMe,shareGrid:iMe,teamsGrid:rMe,bookmarkCard:sMe,shareCard:oMe,teamCard:aMe,bookmarkHeader:lMe,shareHeader:cMe,teamHeader:hMe,bookmarkIcon:uMe,shareIcon:dMe,teamIcon:AMe,bookmarkToggle:fMe,actionButton:pMe,danger:gMe,teamActions:mMe,bookmarkContent:yMe,shareContent:wMe,teamContent:vMe,bookmarkTitle:xMe,shareTitle:bMe,teamName:CMe,bookmarkMeta:_Me,shareMeta:SMe,teamMeta:TMe,bookmarkType:BMe,permissionBadge:EMe,roleBadge:FMe,personal:kMe,editor:IMe,owner:DMe,admin:jMe,shared:PMe,viewer:NMe,bookmarkDate:LMe,shareDate:MMe,teamDate:RMe,shareUser:UMe,memberCount:OMe,expiryDate:HMe,tabFooter:WMe,bookmarkStats:zMe,shareStats:QMe,filterInfo:$Me,createButton:VMe,shareButton:GMe,createTeamButton:XMe,invitationsSection:YMe,sectionTitle:KMe,invitationsList:qMe,invitationCard:ZMe,invitationContent:JMe,invitationDate:e7e,invitationActions:t7e,acceptButton:n7e,declineButton:i7e,profileSection:r7e,profileHeader:s7e,profileAvatar:o7e,profileBasicInfo:a7e,profileEmail:l7e,profileForm:c7e,notificationsSection:h7e,privacySection:u7e,formGroup:d7e,formRow:A7e,formActions:f7e,saveButton:p7e,settingsGroup:g7e,settingItem:m7e,settingInfo:y7e,sectionDescription:w7e,switch:"_switch_14wpp_680",slider:v7e,modalOverlay:x7e,modal:b7e,modalHeader:C7e,modalContent:_7e,modalActions:S7e,membersList:T7e,memberItem:B7e,memberInfo:E7e,memberAvatar:F7e,memberDetails:k7e,memberName:I7e,memberEmail:D7e,memberRole:j7e,profileAvatarContainer:P7e,uploadingOverlay:N7e,avatarActions:L7e,avatarActionButton:M7e},R7e=({onProjectSelect:n})=>{const{user:e}=Vc(),[t,i]=H.useState("shared-by-me"),[r,s]=H.useState([]),[o,a]=H.useState([]),[l,h]=H.useState(!1),[u,d]=H.useState(null),[A,f]=H.useState(!1),[p,g]=H.useState(null),v=async()=>{if(e){h(!0),d(null);try{const[x,S]=await Promise.all([ILe(),DLe()]);x.error?console.warn("내가 공유한 프로젝트 로드 실패:",x.error):s(x.shares),S.error?console.warn("공유 프로젝트 로드 실패:",S.error):a(S.shares)}catch{d("공유 데이터를 불러오는 중 오류가 발생했습니다.")}finally{h(!1)}}};H.useEffect(()=>{v()},[e]);const w=async x=>{if(confirm("정말 공유를 취소하시겠습니까?"))try{const{error:S}=await jLe(x);S?alert(S):v()}catch{alert("공유 취소 중 오류가 발생했습니다.")}},m=async(x,S)=>{try{const{error:I}=await PLe(x,S);I?alert(I):v()}catch{alert("권한 변경 중 오류가 발생했습니다.")}},y=t==="shared-by-me"?r:o;return c.jsxs("div",{className:Rt.tabContent,children:[c.jsxs("div",{className:Rt.tabHeader,children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[c.jsxs("h2",{className:Rt.tabTitle,children:[c.jsx(bm,{size:20}),"공유 프로젝트"]}),c.jsx("div",{className:Rt.shareStats,style:{marginLeft:"auto",marginRight:"16px"},children:c.jsx("span",{children:t==="shared-by-me"?`공유한 프로젝트 ${r.length}개`:`공유받은 프로젝트 ${o.length}개`})})]}),c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[c.jsxs("div",{className:Rt.subTabs,children:[c.jsx("button",{className:`${Rt.subTab} ${t==="shared-by-me"?Rt.active:""}`,onClick:()=>i("shared-by-me"),children:"내가 공유한 프로젝트"}),c.jsx("button",{className:`${Rt.subTab} ${t==="shared-with-me"?Rt.active:""}`,onClick:()=>i("shared-with-me"),children:"공유받은 프로젝트"})]}),t==="shared-by-me"&&c.jsxs("button",{className:Rt.shareButton,onClick:()=>f(!0),children:[c.jsx(bm,{size:16}),"새 공유 만들기"]})]})]}),c.jsxs("div",{className:Rt.contentArea,children:[l&&c.jsxs("div",{className:Rt.loadingState,children:[c.jsx("div",{className:Rt.spinner}),c.jsx("p",{children:"공유 프로젝트를 불러오는 중..."})]}),!l&&y.length===0&&c.jsxs("div",{className:Rt.emptyState,children:[c.jsx(bm,{size:48}),c.jsx("h3",{children:t==="shared-by-me"?"공유한 프로젝트가 없습니다":"공유받은 프로젝트가 없습니다"}),c.jsx("p",{children:t==="shared-by-me"?"프로젝트를 다른 사람과 공유해보세요.":"다른 사람이 공유한 프로젝트가 여기에 표시됩니다."})]}),!l&&y.length>0&&c.jsx("div",{className:Rt.shareGrid,children:y.map(x=>c.jsxs("div",{className:Rt.shareCard,onClick:()=>n==null?void 0:n(x.projectId),children:[c.jsxs("div",{className:Rt.shareHeader,children:[c.jsx("div",{className:Rt.shareIcon,children:c.jsx(bm,{size:20})}),c.jsx("div",{className:Rt.shareActions,children:t==="shared-by-me"&&c.jsxs(c.Fragment,{children:[c.jsx("button",{className:Rt.actionButton,onClick:S=>{if(S.stopPropagation(),x.shareType==="link"&&x.accessToken){const I=`${window.location.origin}/shared/${x.id}?token=${x.accessToken}`;navigator.clipboard.writeText(I),alert("공유 링크가 복사되었습니다!")}},title:"링크 복사",children:c.jsx(DQ,{size:14})}),c.jsx("button",{className:Rt.actionButton,onClick:S=>{S.stopPropagation();const I=x.permission==="viewer"?"editor":"viewer";m(x.id,I)},title:"권한 변경",children:c.jsx(Ky,{size:14})}),c.jsx("button",{className:`${Rt.actionButton} ${Rt.danger}`,onClick:S=>{S.stopPropagation(),w(x.id)},title:"공유 취소",children:c.jsx(xm,{size:14})})]})})]}),c.jsxs("div",{className:Rt.shareContent,children:[c.jsx("h4",{className:Rt.shareTitle,children:x.projectTitle}),c.jsxs("div",{className:Rt.shareMeta,children:[c.jsxs("div",{className:Rt.shareUser,children:[c.jsx(Vh,{size:14}),c.jsx("span",{children:t==="shared-by-me"?x.sharedWith==="public"?"링크 공유":x.sharedWith:x.ownerEmail})]}),c.jsx("div",{className:Rt.sharePermission,children:c.jsx("span",{className:`${Rt.permissionBadge} ${Rt[x.permission]}`,children:x.permission==="viewer"?"보기":"편집"})})]}),c.jsxs("div",{className:Rt.shareDate,children:[c.jsx(lE,{size:12}),c.jsx("span",{children:x.createdAt.toDate().toLocaleDateString()}),x.expiresAt&&c.jsxs("span",{className:Rt.expiryDate,children:["만료: ",x.expiresAt.toDate().toLocaleDateString()]})]})]})]},x.id))})]})]})},U7e=({onTeamSelect:n})=>{const{user:e}=Vc(),[t,i]=H.useState([]),[r,s]=H.useState([]),[o,a]=H.useState(!1),[l,h]=H.useState(null),[u,d]=H.useState(!1),[A,f]=H.useState(!1),[p,g]=H.useState(!1),[v,w]=H.useState(!1),[m,y]=H.useState(null),[x,S]=H.useState(null),[I,j]=H.useState(""),[C,b]=H.useState(""),[D,T]=H.useState(""),[k,B]=H.useState("viewer"),[E,z]=H.useState(""),[te,L]=H.useState(""),O=async()=>{if(e){a(!0),h(null);try{const[W,se]=await Promise.all([Iz(),aae()]);W.error?h(W.error):i(W.teams),se.error?console.error("초대 목록 로드 에러:",se.error):s(se.invitations)}catch{h("팀 데이터를 불러오는 중 오류가 발생했습니다.")}finally{a(!1)}}};H.useEffect(()=>{O()},[e]);const J=async()=>{if(!I.trim()){alert("팀 이름을 입력해주세요.");return}a(!0),h(null);try{console.log("🏗️ 팀 생성 시작:",{name:I,description:C});const{teamId:W,error:se}=await iae(I,C);se?(console.error("❌ 팀 생성 오류:",se),alert(`팀 생성 실패: ${se}`),h(se)):W?(console.log("✅ 팀 생성 성공:",W),alert("팀이 성공적으로 생성되었습니다!"),d(!1),j(""),b(""),setTimeout(()=>{console.log("🔄 팀 목록 새로고침 중..."),O()},1e3)):(console.error("❌ 팀 생성 실패: teamId가 없음"),alert("팀 생성에 실패했습니다. 다시 시도해주세요."))}catch(W){console.error("❌ 팀 생성 예외:",W);const se=W instanceof Error?W.message:"알 수 없는 오류가 발생했습니다.";alert(`팀 생성 중 오류가 발생했습니다: ${se}`),h(se)}finally{a(!1)}},$=async(W,se)=>{try{const{error:q}=await sae(W,se);q?alert(q):O()}catch{alert("초대 수락 중 오류가 발생했습니다.")}},U=async(W,se)=>{try{const{error:q}=await lae(W,se);q?alert(q):O()}catch{alert("초대 거절 중 오류가 발생했습니다.")}},Y=async()=>{if(!(!m||!D.trim()))try{const{invitationId:W,error:se}=await rae(m,D,k);se?alert(se):(f(!1),T(""),B("viewer"),y(null),alert("팀원 초대를 보냈습니다!"))}catch{alert("팀원 초대 중 오류가 발생했습니다.")}},K=async W=>{try{const{team:se,error:q}=await GC(W);if(q||!se){alert(q||"팀 정보를 불러올 수 없습니다.");return}S(se),z(se.name),L(se.description||""),g(!0)}catch{alert("팀 정보를 불러오는 중 오류가 발생했습니다.")}},V=async()=>{if(!(!x||!E.trim()))try{const{error:W}=await oae(x.id,{name:E,description:te});W?alert(W):(g(!1),S(null),O(),alert("팀 정보가 업데이트되었습니다."))}catch{alert("팀 업데이트 중 오류가 발생했습니다.")}},Q=async W=>{try{const{team:se,error:q}=await GC(W);if(q||!se){alert(q||"팀 정보를 불러올 수 없습니다.");return}S(se),w(!0)}catch{alert("팀 정보를 불러오는 중 오류가 발생했습니다.")}},X=W=>{switch(W){case"owner":return"소유자";case"admin":return"관리자";case"editor":return"편집자";case"viewer":return"보기 전용";default:return W}};return c.jsxs("div",{className:Rt.tabContent,children:[c.jsxs("div",{className:Rt.tabHeader,children:[c.jsxs("h2",{className:Rt.tabTitle,children:[c.jsx(Yy,{size:20}),"팀 관리"]}),c.jsxs("button",{className:Rt.createButton,onClick:()=>d(!0),children:[c.jsx(Eg,{size:16}),"새 팀 만들기"]})]}),r.length>0&&c.jsxs("div",{className:Rt.invitationsSection,children:[c.jsxs("h3",{className:Rt.sectionTitle,children:[c.jsx(Ohe,{size:16}),"팀 초대 (",r.length,")"]}),c.jsx("div",{className:Rt.invitationsList,children:r.map(W=>c.jsxs("div",{className:Rt.invitationCard,children:[c.jsxs("div",{className:Rt.invitationContent,children:[c.jsx("h4",{children:W.teamName}),c.jsxs("p",{children:[W.inviterDisplayName||W.inviterEmail,"님이",X(W.role)," 권한으로 초대했습니다."]}),c.jsxs("div",{className:Rt.invitationDate,children:[c.jsx(lE,{size:12}),W.createdAt.toDate().toLocaleDateString()]})]}),c.jsxs("div",{className:Rt.invitationActions,children:[c.jsx("button",{className:Rt.acceptButton,onClick:()=>$(W.id,W.token),children:"수락"}),c.jsx("button",{className:Rt.declineButton,onClick:()=>U(W.id,W.token),children:"거절"})]})]},W.id))})]}),c.jsxs("div",{className:Rt.contentArea,children:[o&&c.jsxs("div",{className:Rt.loadingState,children:[c.jsx("div",{className:Rt.spinner}),c.jsx("p",{children:"팀을 불러오는 중..."})]}),l&&c.jsxs("div",{className:Rt.errorState,children:[c.jsx("p",{className:Rt.errorMessage,children:l}),c.jsx("button",{onClick:O,className:Rt.retryButton,children:"다시 시도"})]}),!o&&!l&&t.length===0&&c.jsxs("div",{className:Rt.emptyState,children:[c.jsx(Yy,{size:48}),c.jsx("h3",{children:"참여한 팀이 없습니다"}),c.jsx("p",{children:"새 팀을 만들거나 팀 초대를 받아보세요."}),c.jsx("button",{className:Rt.createTeamButton,onClick:()=>d(!0),children:"첫 번째 팀 만들기"})]}),!o&&!l&&t.length>0&&c.jsx("div",{className:Rt.teamsGrid,children:t.map(W=>{const se=W.members.find(de=>de.userId===(e==null?void 0:e.uid)),q=W.ownerId===(e==null?void 0:e.uid);return c.jsxs("div",{className:Rt.teamCard,onClick:()=>Q(W.id),children:[c.jsxs("div",{className:Rt.teamHeader,children:[c.jsx("div",{className:Rt.teamIcon,children:c.jsx(Yy,{size:20})}),(q||(se==null?void 0:se.role)==="admin")&&c.jsxs("div",{className:Rt.teamActions,children:[c.jsx("button",{className:Rt.actionButton,onClick:de=>{de.stopPropagation(),y(W.id),f(!0)},title:"팀원 초대",children:c.jsx(Eg,{size:14})}),c.jsx("button",{className:Rt.actionButton,onClick:de=>{de.stopPropagation(),K(W.id)},title:"팀 설정",children:c.jsx(Lk,{size:14})})]})]}),c.jsxs("div",{className:Rt.teamContent,children:[c.jsx("h4",{className:Rt.teamName,children:W.name}),W.description&&c.jsx("p",{className:Rt.teamDescription,children:W.description}),c.jsxs("div",{className:Rt.teamMeta,children:[c.jsxs("div",{className:Rt.memberCount,children:[c.jsx(Vh,{size:14}),c.jsxs("span",{children:[W.members.length,"명"]})]}),c.jsx("div",{className:Rt.userRole,children:c.jsx("span",{className:`${Rt.roleBadge} ${Rt[(se==null?void 0:se.role)||"viewer"]}`,children:X((se==null?void 0:se.role)||"viewer")})})]}),c.jsxs("div",{className:Rt.teamDate,children:[c.jsx(lE,{size:12}),c.jsxs("span",{children:["생성일: ",W.createdAt.toDate().toLocaleDateString()]})]})]})]},W.id)})})]}),u&&c.jsx("div",{className:Rt.modalOverlay,onClick:()=>d(!1),children:c.jsxs("div",{className:Rt.modal,onClick:W=>W.stopPropagation(),children:[c.jsxs("div",{className:Rt.modalHeader,children:[c.jsx("h3",{children:"새 팀 만들기"}),c.jsx("button",{onClick:()=>d(!1),children:"×"})]}),c.jsxs("div",{className:Rt.modalContent,children:[c.jsxs("div",{className:Rt.formGroup,children:[c.jsx("label",{children:"팀 이름"}),c.jsx("input",{type:"text",value:I,onChange:W=>j(W.target.value),placeholder:"팀 이름을 입력하세요"})]}),c.jsxs("div",{className:Rt.formGroup,children:[c.jsx("label",{children:"설명 (선택사항)"}),c.jsx("textarea",{value:C,onChange:W=>b(W.target.value),placeholder:"팀 설명을 입력하세요",rows:3})]})]}),l&&c.jsx("div",{className:Rt.errorMessage,children:l}),c.jsxs("div",{className:Rt.modalActions,children:[c.jsx("button",{onClick:()=>d(!1),disabled:o,children:"취소"}),c.jsx("button",{onClick:J,disabled:!I.trim()||o,children:o?"생성 중...":"팀 만들기"})]})]})}),A&&c.jsx("div",{className:Rt.modalOverlay,onClick:()=>f(!1),children:c.jsxs("div",{className:Rt.modal,onClick:W=>W.stopPropagation(),children:[c.jsxs("div",{className:Rt.modalHeader,children:[c.jsx("h3",{children:"팀원 초대"}),c.jsx("button",{onClick:()=>f(!1),children:"×"})]}),c.jsxs("div",{className:Rt.modalContent,children:[c.jsxs("div",{className:Rt.formGroup,children:[c.jsx("label",{children:"이메일 주소"}),c.jsx("input",{type:"email",value:D,onChange:W=>T(W.target.value),placeholder:"초대할 사용자의 이메일을 입력하세요"})]}),c.jsxs("div",{className:Rt.formGroup,children:[c.jsx("label",{children:"권한"}),c.jsxs("select",{value:k,onChange:W=>B(W.target.value),children:[c.jsx("option",{value:"viewer",children:"보기 전용"}),c.jsx("option",{value:"editor",children:"편집자"}),c.jsx("option",{value:"admin",children:"관리자"})]})]})]}),c.jsxs("div",{className:Rt.modalActions,children:[c.jsx("button",{onClick:()=>f(!1),children:"취소"}),c.jsx("button",{onClick:Y,disabled:!D.trim(),children:"초대 보내기"})]})]})}),p&&x&&c.jsx("div",{className:Rt.modalOverlay,onClick:()=>g(!1),children:c.jsxs("div",{className:Rt.modal,onClick:W=>W.stopPropagation(),children:[c.jsxs("div",{className:Rt.modalHeader,children:[c.jsx("h3",{children:"팀 설정"}),c.jsx("button",{onClick:()=>g(!1),children:"×"})]}),c.jsxs("div",{className:Rt.modalContent,children:[c.jsxs("div",{className:Rt.formGroup,children:[c.jsx("label",{children:"팀 이름"}),c.jsx("input",{type:"text",value:E,onChange:W=>z(W.target.value),placeholder:"팀 이름을 입력하세요"})]}),c.jsxs("div",{className:Rt.formGroup,children:[c.jsx("label",{children:"설명"}),c.jsx("textarea",{value:te,onChange:W=>L(W.target.value),placeholder:"팀 설명을 입력하세요",rows:3})]})]}),c.jsxs("div",{className:Rt.modalActions,children:[c.jsx("button",{onClick:()=>g(!1),children:"취소"}),c.jsx("button",{onClick:V,disabled:!E.trim(),children:"저장"})]})]})}),v&&x&&c.jsx("div",{className:Rt.modalOverlay,onClick:()=>w(!1),children:c.jsxs("div",{className:Rt.modal,onClick:W=>W.stopPropagation(),children:[c.jsxs("div",{className:Rt.modalHeader,children:[c.jsxs("h3",{children:[x.name," 멤버 목록"]}),c.jsx("button",{onClick:()=>w(!1),children:"×"})]}),c.jsx("div",{className:Rt.modalContent,children:c.jsx("div",{className:Rt.membersList,children:x.members.map(W=>c.jsxs("div",{className:Rt.memberItem,children:[c.jsxs("div",{className:Rt.memberInfo,children:[c.jsx("div",{className:Rt.memberAvatar,children:W.photoURL?c.jsx("img",{src:W.photoURL,alt:"프로필"}):c.jsx(Vh,{size:20})}),c.jsxs("div",{className:Rt.memberDetails,children:[c.jsx("div",{className:Rt.memberName,children:W.displayName||W.email}),c.jsx("div",{className:Rt.memberEmail,children:W.email})]})]}),c.jsx("div",{className:Rt.memberRole,children:c.jsx("span",{className:`${Rt.roleBadge} ${Rt[W.role]}`,children:X(W.role)})})]},W.userId))})}),c.jsx("div",{className:Rt.modalActions,children:c.jsx("button",{onClick:()=>w(!1),children:"닫기"})})]})})]})},Uv="userProfiles",DK=async n=>{try{const e=await Wr();if(!e)return{error:"로그인이 필요합니다."};const t=ts(rr,Uv,e.uid),i=await Ru(t),r={uid:e.uid,email:e.email||"",displayName:e.displayName||void 0,photoURL:e.photoURL||void 0,bio:"",company:"",website:"",location:"",teamNotifications:!0,shareNotifications:!0,emailNotifications:!0,isPublicProfile:!1,allowTeamInvitations:!0,createdAt:Lo(),updatedAt:Lo()};if(i.exists()){const s={...n,updatedAt:Lo()};await ql(t,s)}else{const s={...r,...n};await i0(t,s)}return{error:null}}catch(e){return console.error("사용자 프로필 생성/업데이트 에러:",e),{error:"사용자 프로필 처리 중 오류가 발생했습니다."}}},O7e=async n=>{var e;try{let t=n;if(!t){const o=await Wr();if(!o)return{profile:null,error:"로그인이 필요합니다."};t=o.uid}const i=ts(rr,Uv,t),r=await Ru(i);if(!r.exists()){if(!n){const{error:o}=await DK({});if(o)return{profile:null,error:o};const a=await Ru(i);if(a.exists())return{profile:a.data(),error:null}}return{profile:null,error:"사용자 프로필을 찾을 수 없습니다."}}const s=r.data();return n&&((e=await Wr())==null||e.uid),{profile:s,error:null}}catch(t){return console.error("사용자 프로필 가져오기 에러:",t),{profile:null,error:"사용자 프로필을 가져오는 중 오류가 발생했습니다."}}},H7e=async n=>{try{const e=await Wr();if(!e)return{error:"로그인이 필요합니다."};const t=ts(rr,Uv,e.uid);if(!(await Ru(t)).exists())return await DK(n);const r={...n,updatedAt:Lo()};return await ql(t,r),{error:null}}catch(e){return console.error("사용자 프로필 업데이트 에러:",e),{error:"사용자 프로필 업데이트 중 오류가 발생했습니다."}}},W7e=async n=>{try{const e=await Wr();if(!e)return{error:"로그인이 필요합니다."};const t=ts(rr,Uv,e.uid),i={...n,updatedAt:Lo()};return await ql(t,i),{error:null}}catch(e){return console.error("알림 설정 업데이트 에러:",e),{error:"알림 설정 업데이트 중 오류가 발생했습니다."}}},z7e=async n=>{try{const e=await Wr();if(!e)return{error:"로그인이 필요합니다."};const t=ts(rr,Uv,e.uid),i={...n,updatedAt:Lo()};return await ql(t,i),{error:null}}catch(e){return console.error("개인정보 설정 업데이트 에러:",e),{error:"개인정보 설정 업데이트 중 오류가 발생했습니다."}}},Q7e=async n=>{try{const e=await Wr();if(!e)return{photoURL:null,error:"로그인이 필요합니다."};if(!["image/jpeg","image/png","image/gif","image/webp"].includes(n.type))return{photoURL:null,error:"지원되지 않는 파일 형식입니다. (JPEG, PNG, GIF, WebP만 지원)"};const i=5*1024*1024;if(n.size>i)return{photoURL:null,error:"파일 크기가 너무 큽니다. (최대 5MB)"};try{if(e.photoURL){const a=$C(Tw,`profile-images/${e.uid}`);await pz(a)}}catch(a){console.warn("기존 프로필 사진 삭제 실패:",a)}const r=$C(Tw,`profile-images/${e.uid}`),s=await Az(r,n),o=await fz(s.ref);return await l5(e,{photoURL:o}),{photoURL:o,error:null}}catch(e){return console.error("프로필 사진 업로드 에러:",e),{photoURL:null,error:"프로필 사진 업로드 중 오류가 발생했습니다."}}},$7e=async()=>{try{const n=await Wr();if(!n)return{error:"로그인이 필요합니다."};if(n.photoURL){const e=$C(Tw,`profile-images/${n.uid}`);await pz(e)}return await l5(n,{photoURL:null}),{error:null}}catch(n){return console.error("프로필 사진 삭제 에러:",n),{error:"프로필 사진 삭제 중 오류가 발생했습니다."}}},V7e=(n,e=400,t=.8)=>new Promise(i=>{const r=document.createElement("canvas"),s=r.getContext("2d"),o=new Image;o.onload=()=>{const a=Math.min(e/o.width,e/o.height);r.width=o.width*a,r.height=o.height*a,s.drawImage(o,0,0,r.width,r.height),r.toBlob(l=>{if(l){const h=new File([l],n.name,{type:n.type,lastModified:Date.now()});i(h)}else i(n)},n.type,t)},o.src=URL.createObjectURL(n)}),G7e=()=>{const{user:n}=Vc(),[e,t]=H.useState(null),[i,r]=H.useState(!1),[s,o]=H.useState(!1),[a,l]=H.useState(null),[h,u]=H.useState("profile"),[d,A]=H.useState(!1),f=H.useRef(null),[p,g]=H.useState(""),[v,w]=H.useState(""),[m,y]=H.useState(""),[x,S]=H.useState(""),[I,j]=H.useState(""),[C,b]=H.useState(!0),[D,T]=H.useState(!0),[k,B]=H.useState(!0),[E,z]=H.useState(!1),[te,L]=H.useState(!0),O=async()=>{if(n){r(!0),l(null);try{const{profile:Q,error:X}=await O7e();X?l(X):Q&&(t(Q),g(Q.displayName||""),w(Q.bio||""),y(Q.company||""),S(Q.website||""),j(Q.location||""),b(Q.teamNotifications),T(Q.shareNotifications),B(Q.emailNotifications),z(Q.isPublicProfile),L(Q.allowTeamInvitations))}catch{l("프로필을 불러오는 중 오류가 발생했습니다.")}finally{r(!1)}}};H.useEffect(()=>{O()},[n]);const J=async()=>{o(!0);try{const{error:Q}=await H7e({displayName:p.trim()||void 0,bio:v.trim()||void 0,company:m.trim()||void 0,website:x.trim()||void 0,location:I.trim()||void 0});Q?alert(Q):(alert("프로필이 저장되었습니다."),O())}catch{alert("프로필 저장 중 오류가 발생했습니다.")}finally{o(!1)}},$=async()=>{o(!0);try{const{error:Q}=await W7e({teamNotifications:C,shareNotifications:D,emailNotifications:k});alert(Q||"알림 설정이 저장되었습니다.")}catch{alert("알림 설정 저장 중 오류가 발생했습니다.")}finally{o(!1)}},U=async()=>{o(!0);try{const{error:Q}=await z7e({isPublicProfile:E,allowTeamInvitations:te});alert(Q||"개인정보 설정이 저장되었습니다.")}catch{alert("개인정보 설정 저장 중 오류가 발생했습니다.")}finally{o(!1)}},Y=async Q=>{var W;const X=(W=Q.target.files)==null?void 0:W[0];if(X){A(!0);try{const se=await V7e(X,400,.8),{photoURL:q,error:de}=await Q7e(se);de?alert(de):(alert("프로필 사진이 업데이트되었습니다."),O())}catch{alert("프로필 사진 업로드 중 오류가 발생했습니다.")}finally{A(!1),f.current&&(f.current.value="")}}},K=async()=>{if(n!=null&&n.photoURL&&confirm("프로필 사진을 삭제하시겠습니까?")){A(!0);try{const{error:Q}=await $7e();Q?alert(Q):(alert("프로필 사진이 삭제되었습니다."),O())}catch{alert("프로필 사진 삭제 중 오류가 발생했습니다.")}finally{A(!1)}}},V=()=>{var Q;(Q=f.current)==null||Q.click()};return c.jsxs("div",{className:Rt.tabContent,children:[c.jsxs("div",{className:Rt.tabHeader,children:[c.jsxs("h2",{className:Rt.tabTitle,children:[c.jsx(Vh,{size:20}),"내 정보 관리"]}),c.jsxs("div",{className:Rt.profileSections,children:[c.jsxs("button",{className:`${Rt.sectionTab} ${h==="profile"?Rt.active:""}`,onClick:()=>u("profile"),children:[c.jsx(Vh,{size:16}),"프로필"]}),c.jsxs("button",{className:`${Rt.sectionTab} ${h==="notifications"?Rt.active:""}`,onClick:()=>u("notifications"),children:[c.jsx(IQ,{size:16}),"알림"]}),c.jsxs("button",{className:`${Rt.sectionTab} ${h==="privacy"?Rt.active:""}`,onClick:()=>u("privacy"),children:[c.jsx(Hhe,{size:16}),"개인정보"]})]})]}),c.jsxs("div",{className:Rt.contentArea,children:[i&&c.jsxs("div",{className:Rt.loadingState,children:[c.jsx("div",{className:Rt.spinner}),c.jsx("p",{children:"프로필을 불러오는 중..."})]}),a&&c.jsxs("div",{className:Rt.errorState,children:[c.jsx("p",{className:Rt.errorMessage,children:a}),c.jsx("button",{onClick:O,className:Rt.retryButton,children:"다시 시도"})]}),!i&&!a&&c.jsxs(c.Fragment,{children:[h==="profile"&&c.jsxs("div",{className:Rt.profileSection,children:[c.jsxs("div",{className:Rt.profileHeader,children:[c.jsxs("div",{className:Rt.profileAvatarContainer,children:[c.jsxs("div",{className:Rt.profileAvatar,children:[n!=null&&n.photoURL?c.jsx("img",{src:n.photoURL,alt:"프로필"}):c.jsx(Vh,{size:48}),d&&c.jsx("div",{className:Rt.uploadingOverlay,children:c.jsx("div",{className:Rt.spinner})})]}),c.jsxs("div",{className:Rt.avatarActions,children:[c.jsx("button",{className:Rt.avatarActionButton,onClick:V,disabled:d,title:"프로필 사진 변경",children:c.jsx(Whe,{size:16})}),(n==null?void 0:n.photoURL)&&c.jsx("button",{className:Rt.avatarActionButton,onClick:K,disabled:d,title:"프로필 사진 삭제",children:c.jsx(xm,{size:16})})]}),c.jsx("input",{ref:f,type:"file",accept:"image/*",onChange:Y,style:{display:"none"}})]}),c.jsxs("div",{className:Rt.profileBasicInfo,children:[c.jsx("h3",{children:(n==null?void 0:n.displayName)||(n==null?void 0:n.email)}),c.jsx("p",{className:Rt.profileEmail,children:n==null?void 0:n.email})]})]}),c.jsxs("div",{className:Rt.profileForm,children:[c.jsxs("div",{className:Rt.formGroup,children:[c.jsx("label",{children:"표시 이름"}),c.jsx("input",{type:"text",value:p,onChange:Q=>g(Q.target.value),placeholder:"표시 이름을 입력하세요"})]}),c.jsxs("div",{className:Rt.formGroup,children:[c.jsx("label",{children:"소개"}),c.jsx("textarea",{value:v,onChange:Q=>w(Q.target.value),placeholder:"자신을 소개해보세요",rows:3})]}),c.jsxs("div",{className:Rt.formRow,children:[c.jsxs("div",{className:Rt.formGroup,children:[c.jsx("label",{children:"회사/조직"}),c.jsx("input",{type:"text",value:m,onChange:Q=>y(Q.target.value),placeholder:"회사명을 입력하세요"})]}),c.jsxs("div",{className:Rt.formGroup,children:[c.jsx("label",{children:"위치"}),c.jsx("input",{type:"text",value:I,onChange:Q=>j(Q.target.value),placeholder:"위치를 입력하세요"})]})]}),c.jsxs("div",{className:Rt.formGroup,children:[c.jsx("label",{children:"웹사이트"}),c.jsx("input",{type:"url",value:x,onChange:Q=>S(Q.target.value),placeholder:"https://example.com"})]}),c.jsx("div",{className:Rt.formActions,children:c.jsxs("button",{className:Rt.saveButton,onClick:J,disabled:s,children:[c.jsx(o3,{size:16}),s?"저장 중...":"프로필 저장"]})})]})]}),h==="notifications"&&c.jsxs("div",{className:Rt.notificationsSection,children:[c.jsx("h3",{children:"알림 설정"}),c.jsx("p",{className:Rt.sectionDescription,children:"받고 싶은 알림을 선택하세요."}),c.jsxs("div",{className:Rt.settingsGroup,children:[c.jsxs("div",{className:Rt.settingItem,children:[c.jsxs("div",{className:Rt.settingInfo,children:[c.jsx("h4",{children:"팀 관련 알림"}),c.jsx("p",{children:"팀 초대, 멤버 변경 등의 알림을 받습니다."})]}),c.jsxs("label",{className:Rt.switch,children:[c.jsx("input",{type:"checkbox",checked:C,onChange:Q=>b(Q.target.checked)}),c.jsx("span",{className:Rt.slider})]})]}),c.jsxs("div",{className:Rt.settingItem,children:[c.jsxs("div",{className:Rt.settingInfo,children:[c.jsx("h4",{children:"공유 관련 알림"}),c.jsx("p",{children:"프로젝트 공유, 권한 변경 등의 알림을 받습니다."})]}),c.jsxs("label",{className:Rt.switch,children:[c.jsx("input",{type:"checkbox",checked:D,onChange:Q=>T(Q.target.checked)}),c.jsx("span",{className:Rt.slider})]})]}),c.jsxs("div",{className:Rt.settingItem,children:[c.jsxs("div",{className:Rt.settingInfo,children:[c.jsx("h4",{children:"이메일 알림"}),c.jsx("p",{children:"중요한 알림을 이메일로도 받습니다."})]}),c.jsxs("label",{className:Rt.switch,children:[c.jsx("input",{type:"checkbox",checked:k,onChange:Q=>B(Q.target.checked)}),c.jsx("span",{className:Rt.slider})]})]})]}),c.jsx("div",{className:Rt.formActions,children:c.jsxs("button",{className:Rt.saveButton,onClick:$,disabled:s,children:[c.jsx(o3,{size:16}),s?"저장 중...":"알림 설정 저장"]})})]}),h==="privacy"&&c.jsxs("div",{className:Rt.privacySection,children:[c.jsx("h3",{children:"개인정보 설정"}),c.jsx("p",{className:Rt.sectionDescription,children:"프로필 공개 범위와 권한을 설정하세요."}),c.jsxs("div",{className:Rt.settingsGroup,children:[c.jsxs("div",{className:Rt.settingItem,children:[c.jsxs("div",{className:Rt.settingInfo,children:[c.jsx("h4",{children:"공개 프로필"}),c.jsx("p",{children:"다른 사용자가 내 프로필을 볼 수 있습니다."})]}),c.jsxs("label",{className:Rt.switch,children:[c.jsx("input",{type:"checkbox",checked:E,onChange:Q=>z(Q.target.checked)}),c.jsx("span",{className:Rt.slider})]})]}),c.jsxs("div",{className:Rt.settingItem,children:[c.jsxs("div",{className:Rt.settingInfo,children:[c.jsx("h4",{children:"팀 초대 허용"}),c.jsx("p",{children:"다른 사용자가 나를 팀에 초대할 수 있습니다."})]}),c.jsxs("label",{className:Rt.switch,children:[c.jsx("input",{type:"checkbox",checked:te,onChange:Q=>L(Q.target.checked)}),c.jsx("span",{className:Rt.slider})]})]})]}),c.jsx("div",{className:Rt.formActions,children:c.jsxs("button",{className:Rt.saveButton,onClick:U,disabled:s,children:[c.jsx(o3,{size:16}),s?"저장 중...":"개인정보 설정 저장"]})})]})]})]})]})},X7e=async n=>{try{const e=await Wr();if(!e)return null;const t=ru(jl(rr,"projectShares"),xl("sharedWith","==",e.email),xl("isActive","==",!0),w0("createdAt","desc"));return ik(t,r=>{const s=[];r.forEach(o=>{const a=o.data();s.push({id:o.id,...a})}),n(s)},r=>{r.message.includes("index")?(console.info("📌 공유 프로젝트 기능을 위한 Firestore 인덱스가 필요합니다."),console.info("Firebase Console에서 다음 인덱스를 생성해주세요:"),console.info("Collection: projectShares"),console.info("Fields: isActive (Ascending), sharedWith (Ascending), createdAt (Descending)")):console.error("공유 프로젝트 실시간 업데이트 에러:",r),n([])})}catch(e){return console.error("공유 프로젝트 리스너 초기화 에러:",e),null}},Y7e=async n=>{try{const e=await Wr();if(!e)return null;const t=ru(jl(rr,"teamInvitations"),xl("inviteeEmail","==",e.email),xl("status","==","pending"),w0("createdAt","desc"));return ik(t,r=>{const s=[];r.forEach(o=>{const a=o.data();a.expiresAt.toDate()>new Date&&s.push({id:o.id,...a})}),n(s)},r=>{r.message.includes("index")?(console.info("📌 팀 초대 기능을 위한 Firestore 인덱스가 필요합니다."),console.info("Firebase Console에서 다음 인덱스를 생성해주세요:"),console.info("Collection: teamInvitations"),console.info("Fields: inviteeEmail (Ascending), status (Ascending), createdAt (Descending)")):console.error("팀 초대 실시간 업데이트 에러:",r),n([])})}catch(e){return console.error("팀 초대 리스너 초기화 에러:",e),null}},K7e=n=>new Promise(async e=>{try{if(!await Wr()){e([]);return}let i=0,r=0;const s=[],o=await Y7e(l=>{i=l.length,n(i+r)});o&&s.push(o);const a=await X7e(l=>{const h=new Date;h.setDate(h.getDate()-1),r=l.filter(u=>u.createdAt.toDate()>h).length,n(i+r)});a&&s.push(a),e(s)}catch(t){console.error("알림 카운터 리스너 초기화 에러:",t),e([])}}),q7e=n=>{n.forEach(e=>{e&&e()})},Z7e="_notificationBadge_t6jn3_1",J7e="_badge_t6jn3_6",cR={notificationBadge:Z7e,badge:J7e},e9e=({children:n,className:e})=>{const{user:t}=Vc(),[i,r]=H.useState(0);return H.useEffect(()=>{if(!t){r(0);return}let s=[];return(async()=>{try{s=await K7e(l=>{r(l)})}catch(a){console.error("알림 리스너 설정 에러:",a)}})(),()=>{q7e(s)}},[t]),c.jsxs("div",{className:`${cR.notificationBadge} ${e||""}`,children:[n,i>0&&c.jsx("span",{className:cR.badge,children:i>99?"99+":i})]})},jK=({spaceConfig:n,placedModules:e=[],viewMode:t="3D",renderMode:i="solid"})=>{console.log("🔍 Space3DViewerReadOnly 렌더링:",{hasSpaceConfig:!!n,placedModulesCount:e.length,placedModules:e,spaceConfig:n,viewMode:t,renderMode:i});const r=(n==null?void 0:n.materialConfig)||{interiorColor:"#FFFFFF",doorColor:"#E0E0E0"},s=H.useMemo(()=>{if(!n)return[0,10,20];const{width:o,height:a,depth:l=1500}=n,h=Th(o,a,l,e.length),u=0,d=mc(a*.5);return[u,d,h]},[n==null?void 0:n.width,n==null?void 0:n.height,n==null?void 0:n.depth,e.length]);return n?c.jsx(qB,{spaceInfo:n,svgSize:{width:800,height:600},renderMode:i,viewMode:t,children:c.jsx("div",{style:{width:"100%",height:"100%",minHeight:"400px",position:"relative"},children:c.jsx(hm,{cameraPosition:s,viewMode:t,view2DDirection:"front",renderMode:i,children:c.jsxs(ci.Suspense,{fallback:null,children:[c.jsx("directionalLight",{position:[5,15,20],intensity:2.5,color:"#ffffff",castShadow:t==="3D","shadow-mapSize-width":4096,"shadow-mapSize-height":4096,"shadow-camera-far":50,"shadow-camera-left":-25,"shadow-camera-right":25,"shadow-camera-top":25,"shadow-camera-bottom":-25,"shadow-bias":-5e-4,"shadow-radius":12,"shadow-normalBias":.02}),c.jsx("directionalLight",{position:[-8,10,15],intensity:.6,color:"#ffffff"}),c.jsx("ambientLight",{intensity:t==="2D"?.8:.5,color:"#ffffff"}),c.jsx(Mk,{spaceInfo:n,viewMode:t,materialConfig:r,showAll:!1,showFrame:!0,showDimensions:!1,placedModules:e,isReadOnly:!0})]})})})}):c.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"#666"},children:"공간 정보를 불러올 수 없습니다"})},t9e="_modalOverlay_1mzc3_2",n9e="_fullscreen_1mzc3_16",i9e="_modalContent_1mzc3_21",r9e="_fullscreenContent_1mzc3_34",s9e="_modalHeader_1mzc3_43",o9e="_headerLeft_1mzc3_53",a9e="_modalTitle_1mzc3_59",l9e="_projectInfo_1mzc3_66",c9e="_headerCenter_1mzc3_71",h9e="_viewModeToggle_1mzc3_77",u9e="_viewModeButton_1mzc3_85",d9e="_active_1mzc3_98",A9e="_headerActions_1mzc3_108",f9e="_actionButton_1mzc3_114",p9e="_closeButton_1mzc3_115",g9e="_modalBody_1mzc3_141",m9e="_viewerContainer_1mzc3_148",y9e="_loadingState_1mzc3_157",w9e="_spinner_1mzc3_166",v9e="_errorState_1mzc3_187",x9e="_errorMessage_1mzc3_197",b9e="_retryButton_1mzc3_203",C9e="_modalFooter_1mzc3_220",_9e="_projectMeta_1mzc3_229",S9e="_shareButton_1mzc3_254",Do={modalOverlay:t9e,fullscreen:n9e,modalContent:i9e,fullscreenContent:r9e,modalHeader:s9e,headerLeft:o9e,modalTitle:a9e,projectInfo:l9e,headerCenter:c9e,viewModeToggle:h9e,viewModeButton:u9e,active:d9e,headerActions:A9e,actionButton:f9e,closeButton:p9e,modalBody:g9e,viewerContainer:m9e,loadingState:y9e,spinner:w9e,errorState:v9e,errorMessage:x9e,retryButton:b9e,modalFooter:C9e,projectMeta:_9e,shareButton:S9e},T9e=({isOpen:n,onClose:e,projectId:t,designFileId:i,initialViewMode:r="3D"})=>{var m;const[s,o]=H.useState(null),[a,l]=H.useState(!1),[h,u]=H.useState(null),[d,A]=H.useState(!1),[f,p]=H.useState(r);H.useEffect(()=>{n&&t&&g()},[n,t,i]);const g=async()=>{var y,x,S,I,j,C,b,D,T,k,B,E,z;console.log("🔥 ProjectViewerModal - loadProject 시작:",{projectId:t,designFileId:i}),l(!0),u(null);try{if(i){console.log("🔥 디자인 파일 로드 시도:",i);const te=await Wz(i);if(console.log("🔥 디자인 파일 로드 결과:",te),te.designFile){const L={id:te.designFile.projectId,title:te.designFile.name,createdAt:te.designFile.createdAt,updatedAt:te.designFile.updatedAt,furnitureCount:((x=(y=te.designFile.furniture)==null?void 0:y.placedModules)==null?void 0:x.length)||0,spaceSize:{width:((S=te.designFile.spaceConfig)==null?void 0:S.width)||3600,height:((I=te.designFile.spaceConfig)==null?void 0:I.height)||2400,depth:((j=te.designFile.spaceConfig)==null?void 0:j.depth)||1500},thumbnail:te.designFile.thumbnail,folderId:"",spaceInfo:te.designFile.spaceConfig,placedModules:((C=te.designFile.furniture)==null?void 0:C.placedModules)||[]};console.log("디자인 파일 로드:",{designFileId:i,name:te.designFile.name,placedModulesCount:((b=L.placedModules)==null?void 0:b.length)||0,placedModules:L.placedModules,spaceConfig:L.spaceInfo}),o(L)}else u(te.error||"디자인 파일을 찾을 수 없습니다.")}else{const te=await Uz(t);if(te.project){const L={id:te.project.id,title:te.project.title,createdAt:te.project.createdAt,updatedAt:te.project.updatedAt,furnitureCount:((D=te.project.stats)==null?void 0:D.furnitureCount)||0,spaceSize:{width:((T=te.project.spaceConfig)==null?void 0:T.width)||3600,height:((k=te.project.spaceConfig)==null?void 0:k.height)||2400,depth:((B=te.project.spaceConfig)==null?void 0:B.depth)||1500},thumbnail:te.project.thumbnail,folderId:te.project.folderId,spaceInfo:te.project.spaceConfig||{width:3600,height:2400,depth:1500,installType:"builtin",surroundType:"surround",baseConfig:{type:"floor",height:65,placementType:"ground"},hasFloorFinish:!1,floorFinish:null,wallConfig:{left:!0,right:!0,top:!0},materialConfig:{interiorColor:"#FFFFFF",doorColor:"#E0E0E0"},columns:[],frameSize:{upper:50,left:50,right:50},gapConfig:{left:2,right:2}},placedModules:((E=te.project.furniture)==null?void 0:E.placedModules)||[]};console.log("프로젝트 뷰어 데이터 로드:",{title:L.title,placedModulesCount:((z=L.placedModules)==null?void 0:z.length)||0,placedModulesData:L.placedModules,spaceInfo:!!L.spaceInfo,fullProjectData:te.project}),o(L)}else u(te.error||"프로젝트를 찾을 수 없습니다.")}}catch(te){console.error("프로젝트 로드 실패:",te),u("프로젝트를 불러오는 중 오류가 발생했습니다.")}finally{l(!1)}},v=()=>{A(!1),e()},w=()=>{A(!d)};return n?c.jsx(Gw,{children:c.jsx(fr.div,{className:`${Do.modalOverlay} ${d?Do.fullscreen:""}`,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:v,children:c.jsxs(fr.div,{className:`${Do.modalContent} ${d?Do.fullscreenContent:""}`,initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},onClick:y=>y.stopPropagation(),children:[c.jsxs("div",{className:Do.modalHeader,children:[c.jsxs("div",{className:Do.headerLeft,children:[c.jsx("h2",{className:Do.modalTitle,children:a?"프로젝트 로딩 중...":s?s.title:"프로젝트를 찾을 수 없음"}),s&&c.jsxs("span",{className:Do.projectInfo,children:[f," 미리보기"]})]}),c.jsx("div",{className:Do.headerCenter,children:c.jsxs("div",{className:Do.viewModeToggle,children:[c.jsx("button",{className:`${Do.viewModeButton} ${f==="2D"?Do.active:""}`,onClick:()=>p("2D"),children:"2D"}),c.jsx("button",{className:`${Do.viewModeButton} ${f==="3D"?Do.active:""}`,onClick:()=>p("3D"),children:"3D"})]})}),c.jsxs("div",{className:Do.headerActions,children:[c.jsx("button",{className:Do.actionButton,onClick:w,title:d?"창 모드":"전체화면",children:d?c.jsx(PQ,{size:20}):c.jsx(jQ,{size:20})}),c.jsx("button",{className:Do.closeButton,onClick:v,title:"닫기",children:c.jsx(zhe,{size:20})})]})]}),c.jsxs("div",{className:Do.modalBody,children:[a&&c.jsxs("div",{className:Do.loadingState,children:[c.jsx("div",{className:Do.spinner}),c.jsx("p",{children:"프로젝트를 불러오는 중..."})]}),h&&c.jsxs("div",{className:Do.errorState,children:[c.jsx("p",{className:Do.errorMessage,children:h}),c.jsx("button",{onClick:g,className:Do.retryButton,children:"다시 시도"})]}),s&&!a&&!h&&c.jsxs("div",{className:Do.viewerContainer,children:[console.log("🎨 읽기 전용 뷰어 렌더링:",{projectId:t,viewMode:f,hasProject:!!s,hasSpaceInfo:!!s.spaceInfo,spaceInfo:s.spaceInfo,placedModulesCount:((m=s.placedModules)==null?void 0:m.length)||0}),c.jsx(jK,{spaceConfig:s.spaceInfo,placedModules:s.placedModules||[],viewMode:f,renderMode:"solid"},`${t}-${f}`)]})]}),s&&!a&&!h&&c.jsxs("div",{className:Do.modalFooter,children:[c.jsx("div",{className:Do.projectMeta,children:c.jsxs("span",{children:["마지막 수정: ",(()=>{if(s.updatedAt)try{const y=s.updatedAt.seconds?new Date(s.updatedAt.seconds*1e3):new Date(s.updatedAt),S=Math.floor((new Date().getTime()-y.getTime())/(1e3*60*60));return S<1?"방금 전":S<24?`${S}시간 전`:S<168?`${Math.floor(S/24)}일 전`:y.toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})}catch(y){return console.error("날짜 변환 오류:",y),"알 수 없음"}if(s.createdAt)try{return(s.createdAt.seconds?new Date(s.createdAt.seconds*1e3):new Date(s.createdAt)).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})}catch(y){console.error("생성일 변환 오류:",y)}return"알 수 없음"})()]})}),c.jsx("button",{className:Do.shareButton,onClick:()=>{const y=i||t,x=`${window.location.origin}/viewer/${y}`;navigator.clipboard.writeText(x).then(()=>{alert(`공유 링크가 클립보드에 복사되었습니다!
${x}`)}).catch(()=>{prompt("공유 링크를 복사하세요:",x)})},children:"공유하기"})]})]})})}):null};async function hR(n){var e,t,i,r,s,o,a;try{const l=document.createElement("canvas"),h=l.getContext("2d");if(!h)return console.error("Canvas 컨텍스트를 생성할 수 없습니다"),null;const u=400;if(l.width=u,l.height=u,h.fillStyle="#f9fafb",h.fillRect(0,0,u,u),n.spaceInfo||n.spaceSize){const A=((e=n.spaceInfo)==null?void 0:e.width)||((t=n.spaceSize)==null?void 0:t.width)||4e3,f=((i=n.spaceInfo)==null?void 0:i.depth)||((r=n.spaceSize)==null?void 0:r.depth)||3e3,p=((s=n.spaceInfo)==null?void 0:s.height)||((o=n.spaceSize)==null?void 0:o.height)||2400,v=u-40*2,w=Math.min(v/A,v/f),m=A*w,y=f*w,x=(u-m)/2,S=(u-y)/2;h.fillStyle="#e5e7eb",h.fillRect(x,S,m,y),h.strokeStyle="#d1d5db",h.lineWidth=.5;const I=500*w;for(let j=S;j<=S+y;j+=I)h.beginPath(),h.moveTo(x,j),h.lineTo(x+m,j),h.stroke();for(let j=x;j<=x+m;j+=I)h.beginPath(),h.moveTo(j,S),h.lineTo(j,S+y),h.stroke();if(h.strokeStyle="#6b7280",h.lineWidth=2,h.strokeRect(x,S,m,y),n.placedModules&&n.placedModules.length>0?(console.log(`🪑 ${n.placedModules.length}개의 가구를 썸네일에 렌더링합니다`),n.placedModules.forEach(j=>{var C,b;try{const D=(((C=j.position)==null?void 0:C.x)||0)*w+x,T=(((b=j.position)==null?void 0:b.z)||0)*w+S,k=(j.width||600)*w,B=(j.depth||600)*w;h.fillStyle="rgba(0, 0, 0, 0.1)",h.fillRect(D+2,T+2,k,B);const E=B9e(j.type||j.moduleType);h.fillStyle=E,h.fillRect(D,T,k,B),h.strokeStyle="rgba(0, 0, 0, 0.3)",h.lineWidth=1,h.strokeRect(D,T,k,B);const z=h.createLinearGradient(D,T,D,T+B);z.addColorStop(0,"rgba(255, 255, 255, 0.3)"),z.addColorStop(1,"rgba(255, 255, 255, 0)"),h.fillStyle=z,h.fillRect(D,T,k,B*.3)}catch(D){console.error("가구 렌더링 오류:",D,j)}})):(h.fillStyle="#9ca3af",h.font="14px sans-serif",h.textAlign="center",h.textBaseline="middle",h.fillText("빈 공간",u/2,u/2)),n.furnitureCount&&n.furnitureCount>0){h.fillStyle="rgba(16, 185, 129, 0.9)";const j=60,C=24,b=u-j-10,D=10;h.beginPath(),h.roundRect(b,D,j,C,12),h.fill(),h.fillStyle="white",h.font="bold 12px sans-serif",h.textAlign="center",h.textBaseline="middle",h.fillText(`${n.furnitureCount}개`,b+j/2,D+C/2)}}else h.fillStyle="#10b981",h.fillRect(0,0,u,u),h.fillStyle="white",h.font="bold 24px sans-serif",h.textAlign="center",h.textBaseline="middle",h.fillText("디자인",u/2,u/2);const d=l.toDataURL("image/png",.8);return console.log("✅ 썸네일 생성 완료:",{width:l.width,height:l.height,furnitureCount:((a=n.placedModules)==null?void 0:a.length)||0}),d}catch(l){return console.error("썸네일 생성 오류:",l),null}}function B9e(n){const e={wardrobe:"#8b5cf6",shelf:"#3b82f6",drawer:"#f59e0b",desk:"#84cc16",chair:"#ec4899",bed:"#06b6d4",sofa:"#f97316",table:"#6366f1",cabinet:"#10b981",bookshelf:"#0891b2",storage:"#7c3aed",closet:"#dc2626",dresser:"#ca8a04",mirror:"#0284c7",default:"#6b7280"},t=(n==null?void 0:n.toLowerCase())||"default";for(const[i,r]of Object.entries(e))if(t.includes(i))return r;return e.default}typeof CanvasRenderingContext2D<"u"&&!CanvasRenderingContext2D.prototype.roundRect&&(CanvasRenderingContext2D.prototype.roundRect=function(n,e,t,i,r){t<2*r&&(r=t/2),i<2*r&&(r=i/2),this.beginPath(),this.moveTo(n+r,e),this.arcTo(n+t,e,n+t,e+i,r),this.arcTo(n+t,e+i,n,e+i,r),this.arcTo(n,e+i,n,e,r),this.arcTo(n,e,n+t,e,r),this.closePath()});const E9e=()=>{if(typeof document<"u"&&!document.querySelector("#thumbnail-spin-animation")){const n=document.createElement("style");n.id="thumbnail-spin-animation",n.innerHTML=`
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
    `,document.head.appendChild(n)}};typeof window<"u"&&E9e();const uR=({project:n,designFile:e,className:t="",alt:i="프로젝트 썸네일"})=>{var u;const[r,s]=H.useState(""),[o,a]=H.useState(!0),[l,h]=H.useState(!1);return H.useEffect(()=>{let d=!0;return(async()=>{var f,p;try{if(a(!0),h(!1),e&&e.spaceConfig&&e.furniture){if(console.log("🎨 디자인 파일 썸네일 생성 시작:",{hasSpaceConfig:!!e.spaceConfig,hasFurniture:!!e.furniture,furnitureCount:((p=(f=e.furniture)==null?void 0:f.placedModules)==null?void 0:p.length)||0,hasThumbnail:!!e.thumbnail,spaceConfigData:e.spaceConfig,furnitureData:e.furniture}),e.thumbnail){console.log("💾 저장된 디자인 썸네일 사용"),s(e.thumbnail),a(!1);return}const y={...n,spaceInfo:{width:e.spaceConfig.width,height:e.spaceConfig.height,depth:e.spaceConfig.depth,columns:e.spaceConfig.columns||[]},placedModules:e.furniture.placedModules||[]};console.log("🔧 디자인 전용 ProjectSummary 생성:",y);const x=await hR(y);console.log("📸 디자인 썸네일 생성 완료:",{success:!!x,thumbnailLength:(x==null?void 0:x.length)||0,isDataUrl:(x==null?void 0:x.startsWith("data:"))||!1}),d&&(!x||x.length===0?(console.warn("⚠️ 썸네일 생성 실패, fallback 사용"),h(!0)):s(x),a(!1));return}const g=n.updatedAt&&new Date(n.updatedAt.seconds*1e3).getTime()>Date.now()-3e5,v=n.placedModules&&n.placedModules.length>0,w=!n.thumbnail||g&&v;if(n.thumbnail&&!w){s(n.thumbnail),a(!1);return}const m=await hR(n);d&&(s(m),a(!1))}catch(g){console.error("썸네일 로드 실패:",g),d&&(h(!0),a(!1))}})(),()=>{d=!1}},[n.id,n.thumbnail,n.updatedAt,(u=n.placedModules)==null?void 0:u.length,e==null?void 0:e.thumbnail,e==null?void 0:e.updatedAt,e==null?void 0:e.spaceConfig,e==null?void 0:e.furniture]),o?c.jsx("div",{className:`${t} thumbnail-loading`,style:{display:"flex",alignItems:"center",justifyContent:"center",background:"#f3f4f6",color:"#6b7280"},children:c.jsx("div",{style:{width:"20px",height:"20px",border:"2px solid #e5e7eb",borderTop:"2px solid #10b981",borderRadius:"50%",animation:"spin 1s linear infinite"}})}):l||!r?c.jsx("div",{className:`${t} thumbnail-fallback`,style:{display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #10b981, #059669)",color:"white",fontSize:"12px",fontWeight:"600"},children:"디자인"}):c.jsx("img",{src:r,alt:i,className:t,style:{width:"100%",height:"100%",objectFit:"cover"},onError:()=>h(!0)})},F9e="_dashboard_sw8by_1",k9e="_sidebar_sw8by_48",I9e="_logoSection_sw8by_62",D9e="_logo_sw8by_62",j9e="_profileSection_sw8by_121",P9e="_userInfo_sw8by_130",N9e="_userAvatar_sw8by_137",L9e="_userDetails_sw8by_150",M9e="_userName_sw8by_154",R9e="_userEmail_sw8by_161",U9e="_createProjectSection_sw8by_167",O9e="_createProjectBtn_sw8by_171",H9e="_navSection_sw8by_193",W9e="_navItem_sw8by_199",z9e="_active_sw8by_241",Q9e="_navItemIcon_sw8by_253",$9e="_navItemCount_sw8by_265",V9e="_settingsSection_sw8by_287",G9e="_settingsItem_sw8by_293",X9e="_main_sw8by_311",Y9e="_header_sw8by_326",K9e="_headerRight_sw8by_353",q9e="_headerActions_sw8by_362",Z9e="_userProfile_sw8by_374",J9e="_actionButton_sw8by_386",eRe="_userProfileAvatar_sw8by_396",tRe="_userProfileName_sw8by_406",nRe="_headerLeft_sw8by_416",iRe="_breadcrumb_sw8by_422",rRe="_breadcrumbItem_sw8by_431",sRe="_breadcrumbSeparator_sw8by_454",oRe="_searchContainer_sw8by_459",aRe="_searchInput_sw8by_465",lRe="_searchIcon_sw8by_482",cRe="_content_sw8by_565",hRe="_projectTree_sw8by_578",uRe="_collapsed_sw8by_595",dRe="_treeHeader_sw8by_601",ARe="_treeToggleButton_sw8by_612",fRe="_toggleIcon_sw8by_637",pRe="_designArea_sw8by_679",gRe="_projectSelectorContainer_sw8by_690",mRe="_treeContent_sw8by_691",yRe="_dropdownArrow_sw8by_720",wRe="_folderDropdown_sw8by_731",vRe="_expanded_sw8by_742",xRe="_treeItem_sw8by_753",bRe="_treeItemIcon_sw8by_776",CRe="_treeToggleArrow_sw8by_785",_Re="_projectChildren_sw8by_804",SRe="_treeItemCount_sw8by_811",TRe="_createFolderBtn_sw8by_822",BRe="_createFolderIcon_sw8by_844",ERe="_treeItemActions_sw8by_866",FRe="_treeItemActionBtn_sw8by_872",kRe="_designIcon_sw8by_894",IRe="_designGrid_sw8by_914",DRe="_folderView_sw8by_914",jRe="_listView_sw8by_914",PRe="_designCard_sw8by_914",NRe="_folderCard_sw8by_914",LRe="_folderIcon_sw8by_935",MRe="_folderIconSvg_sw8by_951",RRe="_folderDropZone_sw8by_976",URe="_dragOver_sw8by_981",ORe="_folderChildren_sw8by_987",HRe="_childItem_sw8by_994",WRe="_cardCheckbox_sw8by_1017",zRe="_designCardOverlay_sw8by_1086",QRe="_newDesign_sw8by_1108",$Re="_forceHover_sw8by_1109",VRe="_overlayButton_sw8by_1121",GRe="_primary_sw8by_1145",XRe="_moreMenu_sw8by_1155",YRe="_moreMenuBackdrop_sw8by_1168",KRe="_moreMenuItem_sw8by_1178",qRe="_deleteItem_sw8by_1198",ZRe="_pageTitle_sw8by_1236",JRe="_listTableHeader_sw8by_1289",eUe="_headerColumn_sw8by_1303",tUe="_cardInfo_sw8by_1372",nUe="_cardThumbnail_sw8by_1379",iUe="_cardTitle_sw8by_1391",rUe="_cardMeta_sw8by_1412",sUe="_listActionButtons_sw8by_1450",oUe="_listActionBtn_sw8by_1458",aUe="_cardDate_sw8by_1487",lUe="_cardFooter_sw8by_1494",cUe="_cardUser_sw8by_1502",hUe="_cardActionButton_sw8by_1510",uUe="_designThumbnail_sw8by_1593",dUe="_designThumbnailImage_sw8by_1599",AUe="_cardThumbnailContent_sw8by_1667",fUe="_cardThumbnailIcon_sw8by_1676",pUe="_cardThumbnailText_sw8by_1689",gUe="_thumbnailGrid_sw8by_1781",mUe="_thumbnailFolder_sw8by_1799",yUe="_thumbnailFile_sw8by_1800",wUe="_fileIconWrapper_sw8by_1804",vUe="_fileIcon_sw8by_1804",xUe="_thumbnailItem_sw8by_1813",bUe="_thumbnailImage_sw8by_1823",CUe="_thumbnailEmpty_sw8by_1869",_Ue="_emptyThumbnailState_sw8by_1879",SUe="_emptyThumbnailIcon_sw8by_1892",TUe="_emptyThumbnailText_sw8by_1898",BUe="_cardUserAvatar_sw8by_2091",EUe="_cardUserName_sw8by_2103",FUe="_cardBadge_sw8by_2109",kUe="_emptyState_sw8by_2119",IUe="_emptyStateTitle_sw8by_2136",DUe="_emptyStateSubtitle_sw8by_2143",jUe="_emptyStateButton_sw8by_2149",PUe="_modalOverlay_sw8by_2165",NUe="_modal_sw8by_2165",LUe="_modalTitle_sw8by_2188",MUe="_modalInput_sw8by_2196",RUe="_modalActions_sw8by_2214",UUe="_modalCancelBtn_sw8by_2221",OUe="_modalCreateBtn_sw8by_2222",HUe="_contextMenu_sw8by_2262",WUe="_contextMenuItem_sw8by_2273",zUe="_teamModalContent_sw8by_2401",QUe="_teamList_sw8by_2406",$Ue="_teamEmpty_sw8by_2412",VUe="_createTeamBtn_sw8by_2427",GUe="_subHeader_sw8by_2524",XUe="_subHeaderContent_sw8by_2533",YUe="_subHeaderLeft_sw8by_2544",KUe="_subHeaderTitle_sw8by_2550",qUe="_selectionInfo_sw8by_2565",ZUe="_clearSelectionBtn_sw8by_2581",JUe="_subHeaderActions_sw8by_2598",eOe="_viewToggleGroup_sw8by_2607",tOe="_viewToggleButton_sw8by_2615",nOe="_sortButton_sw8by_2645",iOe="_sortDropdownMenu_sw8by_2670",rOe="_sortOption_sw8by_2695",sOe="_emptyTrashBtn_sw8by_2728",oOe="_createDesignBtn_sw8by_2751",aOe="_bulkDeleteButton_sw8by_2773",ot={dashboard:F9e,sidebar:k9e,logoSection:I9e,logo:D9e,profileSection:j9e,userInfo:P9e,userAvatar:N9e,userDetails:L9e,userName:M9e,userEmail:R9e,createProjectSection:U9e,createProjectBtn:O9e,navSection:H9e,navItem:W9e,active:z9e,navItemIcon:Q9e,navItemCount:$9e,settingsSection:V9e,settingsItem:G9e,main:X9e,header:Y9e,headerRight:K9e,headerActions:q9e,userProfile:Z9e,actionButton:J9e,userProfileAvatar:eRe,userProfileName:tRe,headerLeft:nRe,breadcrumb:iRe,breadcrumbItem:rRe,breadcrumbSeparator:sRe,searchContainer:oRe,searchInput:aRe,searchIcon:lRe,content:cRe,projectTree:hRe,collapsed:uRe,treeHeader:dRe,treeToggleButton:ARe,toggleIcon:fRe,designArea:pRe,projectSelectorContainer:gRe,treeContent:mRe,dropdownArrow:yRe,folderDropdown:wRe,expanded:vRe,treeItem:xRe,treeItemIcon:bRe,treeToggleArrow:CRe,projectChildren:_Re,treeItemCount:SRe,createFolderBtn:TRe,createFolderIcon:BRe,treeItemActions:ERe,treeItemActionBtn:FRe,designIcon:kRe,designGrid:IRe,folderView:DRe,listView:jRe,designCard:PRe,folderCard:NRe,folderIcon:LRe,folderIconSvg:MRe,folderDropZone:RRe,dragOver:URe,folderChildren:ORe,childItem:HRe,cardCheckbox:WRe,designCardOverlay:zRe,newDesign:QRe,forceHover:$Re,overlayButton:VRe,primary:GRe,moreMenu:XRe,moreMenuBackdrop:YRe,moreMenuItem:KRe,deleteItem:qRe,pageTitle:ZRe,listTableHeader:JRe,headerColumn:eUe,cardInfo:tUe,cardThumbnail:nUe,cardTitle:iUe,cardMeta:rUe,listActionButtons:sUe,listActionBtn:oUe,cardDate:aUe,cardFooter:lUe,cardUser:cUe,cardActionButton:hUe,designThumbnail:uUe,designThumbnailImage:dUe,cardThumbnailContent:AUe,cardThumbnailIcon:fUe,cardThumbnailText:pUe,thumbnailGrid:gUe,thumbnailFolder:mUe,thumbnailFile:yUe,fileIconWrapper:wUe,fileIcon:vUe,thumbnailItem:xUe,thumbnailImage:bUe,thumbnailEmpty:CUe,emptyThumbnailState:_Ue,emptyThumbnailIcon:SUe,emptyThumbnailText:TUe,cardUserAvatar:BUe,cardUserName:EUe,cardBadge:FUe,emptyState:kUe,emptyStateTitle:IUe,emptyStateSubtitle:DUe,emptyStateButton:jUe,modalOverlay:PUe,modal:NUe,modalTitle:LUe,modalInput:MUe,modalActions:RUe,modalCancelBtn:UUe,modalCreateBtn:OUe,contextMenu:HUe,contextMenuItem:WUe,teamModalContent:zUe,teamList:QUe,teamEmpty:$Ue,createTeamBtn:VUe,subHeader:GUe,subHeaderContent:XUe,subHeaderLeft:YUe,subHeaderTitle:KUe,selectionInfo:qUe,clearSelectionBtn:ZUe,subHeaderActions:JUe,viewToggleGroup:eOe,viewToggleButton:tOe,sortButton:nOe,sortDropdownMenu:iOe,sortOption:rOe,emptyTrashBtn:sOe,createDesignBtn:oOe,bulkDeleteButton:aOe},lOe=({size:n=16})=>c.jsxs("svg",{width:n,height:n,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[c.jsx("rect",{x:"3",y:"4",width:"14",height:"12",rx:"2",stroke:"#6b7280",strokeWidth:"1.5",fill:"none"}),c.jsx("rect",{x:"6",y:"7",width:"8",height:"2",rx:"1",fill:"#6b7280"}),c.jsx("rect",{x:"6",y:"11",width:"5",height:"1.5",rx:"0.75",fill:"#6b7280"})]}),cOe=()=>{var pt,Pt;const n=ph(),e=e5(),{user:t}=Vc();if(H.useEffect(()=>{t||(console.log("🔒 사용자가 로그인되지 않음 - 로그인 페이지로 리다이렉트"),n("/auth",{replace:!0}))},[t,n]),!t)return null;const r=new URLSearchParams(e.search).get("projectId"),[s,o]=H.useState("grid");H.useEffect(()=>{const{markAsSaved:pe}=Pl.getState(),{markAsSaved:xe}=hr.getState(),{markAsSaved:at}=pi.getState();pe(),xe(),at()},[]),H.useEffect(()=>{const pe=ze();ke(pe)},[e.pathname]);const[a,l]=H.useState("date"),[h,u]=H.useState(!1),[d,A]=H.useState(!1),[f,p]=H.useState(!1),[g,v]=H.useState([]),[w,m]=H.useState(!0),[y,x]=H.useState(null),[S,I]=H.useState({}),[j,C]=H.useState(new Set),[b,D]=H.useState(null),[T,k]=H.useState(new Set),[B,E]=H.useState(["전체 프로젝트"]),[z,te]=H.useState(null),[L,O]=H.useState({}),[J,$]=H.useState({isDragging:!1,draggedItem:null,dragOverFolder:null}),[U,Y]=H.useState(null),[K,V]=H.useState(!1),[Q,X]=H.useState(""),[W,se]=H.useState(!1),[q,de]=H.useState(null),[Ce,Se]=H.useState(!1),[fe,M]=H.useState(""),[Z,Ae]=H.useState(!1),[ie,ee]=H.useState(!1),[ae,me]=H.useState(null),[_e,ue]=H.useState(null),[Be,it]=H.useState({isOpen:!1,projectId:"",designFileId:void 0}),[De,qe]=H.useState(!1),[Je,Me]=H.useState(!1),[et,He]=H.useState(!1),ze=()=>{const pe=e.pathname.replace("/dashboard","");return pe===""||pe==="/"?"all":pe.substring(1)},[Oe,ke]=H.useState(ze()),[je,rt]=H.useState(new Set),[_t,Ee]=H.useState(new Set),[Le,ye]=H.useState(new Set),[Ze,nt]=H.useState([]),[st,At]=H.useState([]),[ft,Xt]=H.useState(!1),[Yt,Zt]=H.useState(new Set),[sn,vt]=H.useState(new Map),[Ye,Gt]=H.useState(new Map),[Wt,Vt]=H.useState({}),Jt=H.useCallback(()=>{console.log("🧹 로컬 스토리지 데모 프로젝트 정리 시작");const pe=Object.keys(localStorage);let xe=0;pe.forEach(at=>{(at.includes("demo")||at.includes("Demo")||at.includes("demoProject"))&&(console.log("삭제:",at),localStorage.removeItem(at),xe++)}),console.log(`🧹 총 ${xe}개의 데모 프로젝트 관련 항목 삭제됨`)},[]),It=H.useCallback(async(pe=0)=>{if(!t){console.log("사용자가 로그인되지 않았습니다."),m(!1);return}console.log(`🔄 프로젝트 로드 시도 ${pe+1}/3 - 사용자: ${t.email}`),pe===0&&m(!0),x(null);try{const{projects:xe,error:at}=await gk();if(at){if(pe<2){console.log("⚠️ 프로젝트 로드 실패, 1초 후 재시도..."),setTimeout(()=>{It(pe+1)},1e3);return}x(at),console.error("Firebase 프로젝트 로드 최종 실패:",at),m(!1)}else v(xe),console.log("✅ Firebase 프로젝트 로드 성공:",xe.length,"개"),m(!1)}catch(xe){if(pe<2){console.log("⚠️ 프로젝트 로드 예외 발생, 1초 후 재시도..."),setTimeout(()=>{It(pe+1)},1e3);return}x("프로젝트 목록을 가져오는 중 오류가 발생했습니다."),console.error("Firebase 프로젝트 로드 최종 실패:",xe),m(!1)}},[t]),Ut=H.useCallback(async pe=>{if(t)try{const{folders:xe,error:at}=await mk(pe);at?console.error("폴더 데이터 불러오기 에러:",at):O(dt=>({...dt,[pe]:xe}))}catch(xe){console.error("폴더 데이터 불러오기 중 오류:",xe)}},[t]),un=H.useCallback(async pe=>{if(t){console.log("🚀 디자인 파일 로딩 시작:",{projectId:pe,userId:t.uid}),I(xe=>({...xe,[pe]:!0}));try{const{designFiles:xe,error:at}=await D5(pe);at?console.error("❌ 디자인 파일 불러오기 에러:",at):(console.log("✅ 불러온 디자인 파일들:",{projectId:pe,designFiles:xe,designFilesCount:(xe==null?void 0:xe.length)||0,timestamp:new Date().toISOString()}),Vt(dt=>({...dt,[pe]:xe})))}catch(xe){console.error("❌ 디자인 파일 불러오기 중 오류:",xe)}finally{I(xe=>({...xe,[pe]:!1}))}}},[t]),Sn=H.useCallback(async(pe,xe)=>{if(t)try{const{error:at}=await $y(pe,xe);at&&console.error("폴더 데이터 저장 에러:",at)}catch(at){console.error("폴더 데이터 저장 중 오류:",at)}},[t]);H.useEffect(()=>{Jt(),t?(console.log("🔥 사용자 로그인 감지, 프로젝트 로딩 시작:",t.email),setTimeout(()=>{It()},500)):console.log("⚠️ 사용자 없음, 프로젝트 로딩 건너뜀")},[t,It]),H.useEffect(()=>{g.length>0&&t&&(console.log("🔥 프로젝트 목록 로드 완료, 각 프로젝트의 디자인 파일 로딩 시작"),g.forEach(pe=>{!Wt[pe.id]&&!S[pe.id]&&(console.log(`📁 프로젝트 ${pe.title}의 디자인 파일 로딩`),un(pe.id))}))},[g,t,un]),H.useEffect(()=>{const pe=sessionStorage.getItem("pendingProjectSelect");pe&&g.length>0&&g.some(at=>at.id===pe)&&(console.log("대기 중인 프로젝트 선택:",pe),Jn(pe),sessionStorage.removeItem("pendingProjectSelect"))},[g]),H.useEffect(()=>{if(b&&g.length>0){const pe=g.find(xe=>xe.id===b);pe&&B[1]==="로딩 중..."&&E(["전체 프로젝트",pe.title])}},[b,g,B,Wt]),H.useEffect(()=>{const pe=()=>{t&&(console.log("🔄 윈도우 포커스 - 프로젝트 데이터 새로고침"),It(),b&&(console.log("🔄 윈도우 포커스 - 디자인 파일 새로고침:",b),un(b)))};return window.addEventListener("focus",pe),()=>{window.removeEventListener("focus",pe)}},[t,b,un]),H.useEffect(()=>{if(r&&g.length>0){if(g.some(xe=>xe.id===r)&&b!==r){console.log("🔗 URL에서 프로젝트 ID 감지, 자동 선택:",r),D(r);const xe=g.find(at=>at.id===r);xe&&(E(["전체 프로젝트",xe.title]),Ut(r),un(r))}}else!r&&b&&(console.log("🔗 URL에 projectId가 없음, 전체 프로젝트로 돌아가기"),D(null),E(["전체 프로젝트"]))},[r,g,b]),H.useEffect(()=>{const pe=ze();pe!==Oe&&ke(pe)},[e.pathname]),H.useEffect(()=>{Xt(Oe!=="all")},[Oe]),H.useEffect(()=>{const pe=new BroadcastChannel("project-updates"),xe=at=>{console.log("📡 프로젝트 업데이트 알림 수신:",at.data),(at.data.type==="PROJECT_SAVED"||at.data.type==="PROJECT_CREATED"||at.data.type==="DESIGN_FILE_UPDATED")&&(console.log("🔄 프로젝트 목록 새로고침 중..."),It(),at.data.type==="DESIGN_FILE_UPDATED"&&at.data.projectId?(console.log("🔄 디자인 파일 새로고침:",at.data.projectId),un(at.data.projectId)):b&&(console.log("🔄 선택된 프로젝트의 디자인 파일 새로고침:",b),un(b)))};return pe.addEventListener("message",xe),()=>{pe.removeEventListener("message",xe),pe.close()}},[b,un]),H.useEffect(()=>{if(t){const pe=localStorage.getItem(`bookmarks_${t.uid}`);pe&&rt(new Set(JSON.parse(pe)));const xe=localStorage.getItem(`design_bookmarks_${t.uid}`);xe&&Ee(new Set(JSON.parse(xe)));const at=localStorage.getItem(`folder_bookmarks_${t.uid}`);at&&ye(new Set(JSON.parse(at)));const dt=localStorage.getItem(`trash_${t.uid}`);dt&&At(JSON.parse(dt))}},[t]);const jt=t?g:[],fn=H.useMemo(()=>{if(!b)return null;const pe=jt.find(xe=>xe.id===b);return console.log("🔍 selectedProject 업데이트:",{selectedProjectId:b,found:!!pe,allProjectsCount:jt.length}),pe||null},[b,jt]);console.log("🔍 현재 상태 확인:",{user:!!t,userEmail:t==null?void 0:t.email,firebaseProjectsCount:g.length,allProjectsCount:jt.length,selectedProjectId:b,selectedProject:fn==null?void 0:fn.title,activeMenu:Oe,loading:w}),H.useEffect(()=>{fn&&B[1]==="로딩 중..."&&(console.log("📝 Breadcrumb 업데이트:",fn.title),E(["전체 프로젝트",fn.title]))},[fn,B]);const Zn=pe=>{const xe=new Set(je);xe.has(pe)?xe.delete(pe):(xe.add(pe),n("/dashboard/bookmarks")),rt(xe),t&&localStorage.setItem(`bookmarks_${t.uid}`,JSON.stringify(Array.from(xe)))},Hn=pe=>{const xe=new Set(_t);xe.has(pe)?xe.delete(pe):(xe.add(pe),ke("bookmarks")),Ee(xe),t&&localStorage.setItem(`design_bookmarks_${t.uid}`,JSON.stringify(Array.from(xe)))},ti=pe=>{const xe=new Set(Le);xe.has(pe)?xe.delete(pe):(xe.add(pe),ke("bookmarks")),ye(xe),t&&localStorage.setItem(`folder_bookmarks_${t.uid}`,JSON.stringify(Array.from(xe)))},ri=async pe=>{try{const{error:xe}=await KB(pe.id);if(xe){alert("프로젝트 삭제 실패: "+xe);return}await It();const at={...pe,deletedAt:new Date().toISOString()};if(At(dt=>[...dt,at]),t){const dt=[...st,at];localStorage.setItem(`trash_${t.uid}`,JSON.stringify(dt))}je.has(pe.id)&&Zn(pe.id);try{const dt=new BroadcastChannel("project-updates");dt.postMessage({type:"PROJECT_DELETED",projectId:pe.id}),dt.close()}catch(dt){console.warn("BroadcastChannel 전송 실패 (무시 가능):",dt)}console.log("✅ 프로젝트 삭제 완료:",pe.id)}catch(xe){console.error("프로젝트 삭제 중 오류:",xe),alert("프로젝트 삭제 중 오류가 발생했습니다.")}},bi=pe=>{const xe=st.find(at=>at.id===pe);if(xe){const at=st.filter(wn=>wn.id!==pe);At(at);const{deletedAt:dt,...Qt}=xe;v(wn=>[...wn,Qt]),t&&localStorage.setItem(`trash_${t.uid}`,JSON.stringify(at))}},Ni=()=>{window.confirm("휴지통을 비우시겠습니까? 이 작업은 되돌릴 수 없습니다.")&&(At([]),t&&localStorage.removeItem(`trash_${t.uid}`))},ui=async pe=>{try{const xe=`${window.location.origin}/configurator?projectId=${pe}&shared=true`;navigator.clipboard?(await navigator.clipboard.writeText(xe),alert("공유 링크가 클립보드에 복사되었습니다!")):prompt("공유 링크를 복사하세요:",xe)}catch(xe){console.error("프로젝트 공유 중 오류:",xe),alert("프로젝트 공유 중 오류가 발생했습니다.")}},si=()=>{const pe=new Set(st.map(xe=>xe.id));switch(Oe){case"bookmarks":return jt.filter(xe=>je.has(xe.id)&&!pe.has(xe.id));case"shared":return Ze.filter(xe=>!pe.has(xe.id));case"trash":return st;case"all":default:return jt.filter(xe=>!pe.has(xe.id))}},Li=()=>{const pe=[];return jt.forEach(xe=>{(Wt[xe.id]||[]).forEach(dt=>{_t.has(dt.id)&&pe.push({id:dt.id,type:"design",name:dt.name,project:xe,designFile:dt})})}),pe},Tr=()=>{const pe=[];return jt.forEach(xe=>{(L[xe.id]||[]).forEach(dt=>{Le.has(dt.id)&&pe.push({id:dt.id,type:"folder",name:dt.name,project:xe,children:dt.children})})}),pe},xr=H.useCallback(pe=>{const xe=jt.find(Yn=>Yn.id===pe);if(!xe)return console.log("❌ getProjectItems: 프로젝트를 찾을 수 없습니다:",pe,"allProjects:",jt.length),[];const at=L[pe]||[],dt=[];at.forEach(Yn=>{dt.push({id:Yn.id,type:"folder",name:Yn.name,project:xe})}),at.forEach(Yn=>{Yn.children.forEach(ht=>{dt.push({id:ht.id,type:"design",name:ht.name,project:xe})})});const Qt=at.flatMap(Yn=>Yn.children),wn=new Set(Qt.map(Yn=>Yn.id)),gt=S[pe]||!1,Vn=Wt[pe]||[];return console.log("🔥 getProjectItems - 디자인 파일 상태 확인:",{projectId:pe,projectTitle:xe.title,isDesignFilesLoading:gt,projectDesignFilesKeys:Object.keys(Wt),hasDesignFilesForProject:!!Wt[pe],actualDesignFiles:Vn,actualDesignFilesCount:Vn.length,projectFurnitureCount:xe.furnitureCount,timestamp:new Date().toISOString()}),gt&&Vn.length===0?dt.push({id:"loading",type:"loading",name:"디자인 파일 로딩 중...",project:xe}):Vn.forEach(Yn=>{wn.has(Yn.id)||(console.log("📁 루트 레벨 디자인 파일 추가:",Yn.name),dt.push({id:Yn.id,type:"design",name:Yn.name,project:xe,designFile:Yn}))}),dt},[jt,L,Wt,S]),br=()=>{if(console.log("🔍 getDisplayedItems 호출:",{selectedProjectId:b,currentFolderId:z,viewMode:s,activeMenu:Oe,allProjectsCount:jt.length,allProjects:jt.map(xe=>({id:xe.id,title:xe.title}))}),b){if(!fn)return console.log("❌ 선택된 프로젝트를 찾을 수 없습니다:",b),console.log("현재 allProjects:",jt.map(gt=>({id:gt.id,title:gt.title}))),console.log("firebaseProjects:",g.map(gt=>({id:gt.id,title:gt.title}))),[];console.log("✅ 선택된 프로젝트 찾음:",fn.title);const xe=L[b]||[];if(z){const gt=xe.find(Vn=>Vn.id===z);if(gt){const Vn=[{id:"new-design",type:"new-design",name:"디자인 생성",project:fn,icon:"+"}];return gt.children.forEach(Yn=>{Vn.push({id:Yn.id,type:"design",name:Yn.name,project:fn,icon:""})}),Vn}}console.log("📁 프로젝트 루트 레벨 아이템 생성:",{currentFolderId:z,activeMenu:Oe,selectedProjectId:b,"프로젝트 루트 레벨 조건":{"선택된 프로젝트 있음":!!b,"현재 폴더 없음":z===null,"프로젝트 메뉴":Oe==="project"}});const at=[{id:"new-design",type:"new-design",name:"디자인 생성",project:fn,icon:"+"}];console.log("✅ 디자인 생성 카드 추가됨:",at[0]),xe.forEach(gt=>{at.push({id:gt.id,type:"folder",name:gt.name,project:fn,icon:"📁"})});const dt=xe.flatMap(gt=>gt.children),Qt=new Set(dt.map(gt=>gt.id)),wn=Wt[b]||[];return console.log("🎨 디자인 파일 추가:",{projectId:b,actualDesignFilesCount:wn.length,actualDesignFiles:wn.map(gt=>({id:gt.id,name:gt.name}))}),wn.forEach(gt=>{Qt.has(gt.id)||at.push({id:gt.id,type:"design",name:gt.name,project:fn,designFile:gt,icon:""})}),console.log("📊 최종 아이템 개수:",at.length),at}if(Oe==="bookmarks"){const xe=[],at=si();at.forEach(wn=>{xe.push({id:wn.id,type:"project",name:wn.title,project:wn,icon:""})});const dt=Li();xe.push(...dt);const Qt=Tr();return xe.push(...Qt),console.log("📋 북마크 뷰 - 전체 아이템:",{totalItems:xe.length,projectsCount:at.length,designsCount:dt.length,foldersCount:Qt.length}),xe}const pe=si();return console.log("📋 전체 프로젝트 뷰 - 필터링된 프로젝트들:",{activeMenu:Oe,allProjectsCount:jt.length,filteredProjectsCount:pe.length,filteredProjects:pe.map(xe=>({id:xe.id,title:xe.title}))}),pe.map(xe=>({id:xe.id,type:"project",name:xe.title,project:xe,icon:""}))},vn=H.useMemo(()=>{var xe;const pe=br();return console.log("💡 displayedItems 계산 완료:",{itemsCount:pe.length,selectedProjectId:b,projectDesignFilesKeys:Object.keys(Wt),hasDesignFiles:((xe=Wt[b])==null?void 0:xe.length)>0}),pe},[b,jt,Oe,z,L,Wt]);console.log("💡 displayedItems 최종 결과:",vn);const wi=[...vn].sort((pe,xe)=>{var at,dt;if(a==="date"){const Qt=((at=pe.project)==null?void 0:at.lastModified)||new Date(0);return(((dt=xe.project)==null?void 0:dt.lastModified)||new Date(0)).getTime()-Qt.getTime()}else{const Qt=pe.name.toLowerCase(),wn=xe.name.toLowerCase();return Qt.localeCompare(wn,"ko")}}),Ve=(pe,xe)=>{console.log("🔥 handleOpenViewer 호출:",{projectId:pe,designFileId:xe}),it({isOpen:!0,projectId:pe,designFileId:xe})},ct=()=>{it({isOpen:!1,projectId:"",designFileId:void 0})},mt=pe=>{var at;const xe=wi.find(dt=>dt.id===pe);if(xe&&xe.type==="design"){const dt=((at=xe.designFile)==null?void 0:at.id)||(xe.id.endsWith("-design")?void 0:xe.id);Ve(xe.project.id,dt)}},An=pe=>{o(pe)},nn=pe=>{l(pe)},zt=(pe,xe)=>{Zt(at=>{const dt=new Set(at);return xe?dt.add(pe):dt.delete(pe),dt})},gn=pe=>{const xe=pe.filter(dt=>dt.type!=="new-design").map(dt=>dt.id),at=xe.every(dt=>Yt.has(dt));Zt(at?new Set:new Set(xe))};H.useEffect(()=>{const pe=xe=>{const at=xe.target;!at.closest(`.${ot.sortButton}`)&&!at.closest(`.${ot.sortDropdownMenu}`)&&u(!1)};if(h)return document.addEventListener("click",pe),()=>document.removeEventListener("click",pe)},[h]);const Jn=pe=>{if(b===pe)D(null),E(["전체 프로젝트"]),n("/dashboard");else{const xe=jt.find(at=>at.id===pe);xe?(D(pe),E(["전체 프로젝트",xe.title]),n(`/dashboard?projectId=${pe}`),k(at=>{const dt=new Set(at);return dt.add(pe),dt}),Ut(pe),console.log("🔄 프로젝트 선택 시 디자인 파일 로드:",pe),un(pe)):(console.warn("프로젝트를 찾을 수 없습니다. 일단 선택만 진행합니다:",pe),D(pe),E(["전체 프로젝트","로딩 중..."]),n(`/dashboard?projectId=${pe}`),k(at=>{const dt=new Set(at);return dt.add(pe),dt}),Ut(pe),un(pe))}},Qn=pe=>{if(pe===0)D(null),te(null),E(["전체 프로젝트"]),n("/dashboard");else if(pe===1&&b&&fn)te(null),E(["전체 프로젝트",fn.title]),n(`/dashboard?projectId=${b}`);else if(pe===2&&z)return},pn=()=>{V(!0),X("")},Ln=async()=>{if(!(!Q.trim()||!b)){se(!0);try{const xe={id:`folder_${Date.now()}`,name:Q.trim(),type:"folder",children:[],expanded:!1},at=[...L[b]||[],xe];O(dt=>({...dt,[b]:at})),await Sn(b,at),V(!1),X("")}catch(pe){console.error("폴더 생성 실패:",pe),alert("폴더 생성 중 오류가 발생했습니다.")}finally{se(!1)}}},Dn=pe=>{k(xe=>{const at=new Set(xe);return at.has(pe)?at.delete(pe):(at.add(pe),!Wt[pe]&&!designFilesLoadingStates[pe]&&un(pe)),at})},ei=pe=>{b&&O(xe=>{var at;return{...xe,[b]:((at=xe[b])==null?void 0:at.map(dt=>dt.id===pe?{...dt,expanded:!dt.expanded}:dt))||[]}})},xi=()=>{V(!1),X("")},Yi=(pe,xe,at,dt)=>{pe.preventDefault(),pe.stopPropagation(),console.log("📌 더보기 메뉴 열기:",{itemId:xe,itemName:at,itemType:dt,x:pe.clientX,y:pe.clientY}),Y({visible:!0,x:pe.clientX,y:pe.clientY,itemId:xe,itemName:at,itemType:dt})},Bn=()=>{Y(null)},Ri=async()=>{var xe,at;if(!U)return;const pe=prompt("새 이름을 입력하세요:",U.itemName);if(pe&&pe.trim()){if(U.itemType==="project")try{const{updateProject:dt}=await rl(async()=>{const{updateProject:wn}=await Promise.resolve().then(()=>ZA);return{updateProject:wn}},void 0),Qt=await dt(U.itemId,{title:pe.trim()});if(Qt.error){console.error("프로젝트 이름 변경 실패:",Qt.error),alert("프로젝트 이름 변경에 실패했습니다: "+Qt.error);return}v(wn=>wn.map(gt=>gt.id===U.itemId?{...gt,title:pe.trim()}:gt)),b===U.itemId&&E(wn=>{const gt=[...wn],Vn=gt.findIndex(Yn=>Yn!=="전체 프로젝트");return Vn!==-1&&(gt[Vn]=pe.trim()),gt}),console.log("프로젝트 이름 변경 성공:",U.itemId,"→",pe.trim());try{const wn=new BroadcastChannel("project-updates");wn.postMessage({type:"PROJECT_UPDATED",action:"renamed",projectId:U.itemId,newName:pe.trim()}),wn.close()}catch(wn){console.warn("BroadcastChannel 전송 실패 (무시 가능):",wn)}}catch(dt){console.error("프로젝트 이름 변경 중 오류:",dt),alert("프로젝트 이름 변경 중 오류가 발생했습니다.")}else if(U.itemType==="folder"){const dt=((xe=L[b])==null?void 0:xe.map(Qt=>Qt.id===U.itemId?{...Qt,name:pe.trim()}:Qt))||[];O(Qt=>({...Qt,[b]:dt})),await Sn(b,dt)}else if(U.itemType==="design")try{let dt=!1;if(b){const Qt=L[b]||[];for(const wn of Qt)if(wn.children.some(gt=>gt.id===U.itemId)){dt=!0;break}}if(dt){O(wn=>{var gt;return{...wn,[b]:((gt=wn[b])==null?void 0:gt.map(Vn=>({...Vn,children:Vn.children.map(Yn=>Yn.id===U.itemId?{...Yn,name:pe.trim()}:Yn)})))||[]}});const Qt=((at=L[b])==null?void 0:at.map(wn=>({...wn,children:wn.children.map(gt=>gt.id===U.itemId?{...gt,name:pe.trim()}:gt)})))||[];await Sn(b,Qt)}else{const{updateDesignFile:Qt}=await rl(async()=>{const{updateDesignFile:gt}=await Promise.resolve().then(()=>ZA);return{updateDesignFile:gt}},void 0),wn=await Qt(U.itemId,{name:pe.trim()});if(wn.error){console.error("디자인파일 이름 변경 실패:",wn.error),alert("디자인파일 이름 변경에 실패했습니다: "+wn.error);return}console.log("루트 레벨 디자인파일 이름 변경 성공:",U.itemId,"→",pe.trim()),await It();try{const gt=new BroadcastChannel("project-updates");gt.postMessage({type:"PROJECT_UPDATED",action:"design_renamed",projectId:b,designFileId:U.itemId,newName:pe.trim()}),gt.close()}catch(gt){console.warn("BroadcastChannel 전송 실패 (무시 가능):",gt)}}}catch(dt){console.error("디자인파일 이름 변경 중 오류:",dt),alert("디자인파일 이름 변경 중 오류가 발생했습니다.")}console.log("이름 변경:",U.itemId,"→",pe)}Bn()},xt=async()=>{var xe;if(!U)return;let pe="";if(U.itemType==="project"?pe=`정말로 프로젝트 "${U.itemName}"을(를) 삭제하시겠습니까?

이 작업은 되돌릴 수 없으며, 프로젝트 내의 모든 디자인파일과 폴더도 함께 삭제됩니다.`:U.itemType==="folder"?pe=`정말로 폴더 "${U.itemName}"을(를) 삭제하시겠습니까?

폴더 내의 모든 파일도 함께 삭제됩니다.`:pe=`정말로 파일 "${U.itemName}"을(를) 삭제하시겠습니까?`,window.confirm(pe)){if(U.itemType==="project")try{if(Oe==="trash"){const at=st.find(dt=>dt.id===U.itemId);if(at){const{error:dt}=await KB(at.id);if(dt)alert("프로젝트 삭제 실패: "+dt);else{const Qt=st.filter(wn=>wn.id!==U.itemId);At(Qt),t&&localStorage.setItem(`trash_${t.uid}`,JSON.stringify(Qt)),await It();try{const wn=new BroadcastChannel("project-updates");wn.postMessage({type:"PROJECT_UPDATED",action:"deleted",projectId:U.itemId}),wn.close()}catch(wn){console.warn("BroadcastChannel 전송 실패 (무시 가능):",wn)}}}}}catch(at){console.error("프로젝트 삭제 중 오류:",at),alert("프로젝트 삭제 중 오류가 발생했습니다.")}else if(U.itemType==="folder"){const at=((xe=L[b])==null?void 0:xe.filter(dt=>dt.id!==U.itemId))||[];O(dt=>({...dt,[b]:at})),await Sn(b,at)}else if(U.itemType==="design")try{if(b){const{error:at}=await pk(U.itemId,b);if(at)alert("디자인 파일 삭제 실패: "+at);else{Vt(dt=>{var Qt;return{...dt,[b]:((Qt=dt[b])==null?void 0:Qt.filter(wn=>wn.id!==U.itemId))||[]}});try{const dt=new BroadcastChannel("project-updates");dt.postMessage({type:"DESIGN_FILE_DELETED",projectId:b,designFileId:U.itemId}),dt.close()}catch(dt){console.warn("BroadcastChannel 전송 실패 (무시 가능):",dt)}console.log("✅ 디자인 파일 삭제 완료:",U.itemId)}}}catch(at){console.error("디자인 파일 삭제 중 오류:",at),alert("디자인 파일 삭제 중 오류가 발생했습니다.")}console.log("삭제:",U.itemId)}Bn()},Bt=()=>{U&&(U.itemType==="project"?ui(U.itemId):alert("폴더/파일 공유 기능은 준비 중입니다."),Bn())},on=async()=>{var pe;if(U){if(U.itemType==="project")try{const xe=jt.find(Qt=>Qt.id===U.itemId);if(!xe)return;const{createProject:at}=await rl(async()=>{const{createProject:Qt}=await Promise.resolve().then(()=>ZA);return{createProject:Qt}},void 0),dt=await at({title:`${xe.title} 복사본`});if(dt.error){console.error("프로젝트 복제 실패:",dt.error),alert("프로젝트 복제에 실패했습니다: "+dt.error);return}if(dt.id){console.log("프로젝트 복제 성공:",dt.id),alert("프로젝트가 복제되었습니다."),await It();try{const Qt=new BroadcastChannel("project-updates");Qt.postMessage({type:"PROJECT_CREATED",projectId:dt.id,timestamp:Date.now()}),Qt.close()}catch(Qt){console.warn("BroadcastChannel 전송 실패 (무시 가능):",Qt)}}}catch(xe){console.error("프로젝트 복제 중 오류:",xe),alert("프로젝트 복제 중 오류가 발생했습니다.")}else if(U.itemType==="folder"){const xe=(pe=L[b])==null?void 0:pe.find(at=>at.id===U.itemId);if(xe){const at=`folder_${Date.now()}`,dt={...xe,id:at,name:`${xe.name} 복사본`,children:[]},Qt=[...L[b]||[],dt];O(wn=>({...wn,[b]:Qt})),await Sn(b,Qt)}}console.log("복제하기:",U.itemId),Bn()}},ln=(pe,xe)=>{$({isDragging:!0,draggedItem:xe,dragOverFolder:null}),pe.dataTransfer.effectAllowed="move",pe.dataTransfer.setData("text/plain",JSON.stringify(xe))},li=(pe,xe)=>{pe.preventDefault(),pe.dataTransfer.dropEffect="move",$(at=>({...at,dragOverFolder:xe}))},hi=pe=>{pe.preventDefault(),$(xe=>({...xe,dragOverFolder:null}))},Ii=async(pe,xe)=>{var Qt;if(pe.preventDefault(),!J.draggedItem)return;const at=J.draggedItem,dt=((Qt=L[b])==null?void 0:Qt.map(wn=>wn.id===xe?{...wn,children:[...wn.children,at]}:wn))||[];O(wn=>({...wn,[b]:dt})),await Sn(b,dt),$({isDragging:!1,draggedItem:null,dragOverFolder:null}),console.log(`파일 "${at.name}"을 폴더에 추가했습니다.`)},kr=()=>{$({isDragging:!1,draggedItem:null,dragOverFolder:null})},zr=()=>{de(null)},Us=pe=>{const xe=prompt("새 파일명을 입력하세요:",q==null?void 0:q.fileName);xe&&xe.trim()&&console.log("파일 이름 변경:",pe,"→",xe),zr()},io=pe=>{window.confirm("정말로 이 파일을 삭제하시겠습니까?")&&console.log("파일 삭제:",pe),zr()},ws=()=>{Se(!0),M("")},Ts=async()=>{if(fe.trim()){Ae(!0);try{if(t){console.log("🚀 프로젝트 생성 시작:",{title:fe.trim(),userId:t.uid,userEmail:t.email});const{id:pe,error:xe}=await XC({title:fe.trim()});if(xe){console.error("❌ Firebase 프로젝트 생성 실패:",xe),alert("프로젝트 생성에 실패했습니다: "+xe),Ae(!1);return}if(pe){console.log("✅ Firebase 프로젝트 생성 성공:",{projectId:pe,title:fe.trim(),timestamp:new Date().toISOString()}),Se(!1),M(""),await It(0),setTimeout(()=>{console.log("🎯 새 프로젝트 선택:",pe),Jn(pe)},500);try{const at=new BroadcastChannel("project-updates");at.postMessage({type:"PROJECT_CREATED",projectId:pe,timestamp:Date.now()}),console.log("📡 프로젝트 생성 알림 전송"),at.close()}catch(at){console.warn("BroadcastChannel 전송 실패 (무시 가능):",at)}}}else{alert("프로젝트를 생성하려면 먼저 로그인해주세요."),n("/auth");return}}catch(pe){console.error("프로젝트 생성 실패:",pe),alert("프로젝트 생성 중 오류가 발생했습니다.")}finally{Ae(!1)}}},Mn=()=>{Se(!1),M("")},ve=(pe,xe)=>{if(console.log("🚀 handleCreateDesign 호출됨:",{projectId:pe,projectTitle:xe,user:!!t}),t){if(!pe){alert("프로젝트를 먼저 선택해주세요.");return}const at=jt.find(Vn=>Vn.id===pe),dt=xe||(at==null?void 0:at.title)||"새 프로젝트";console.log("✅ projectId 확인됨, Step1 모달 열기 준비");const{setProjectId:Qt,setProjectTitle:wn,resetBasicInfo:gt}=Pl.getState();Qt(pe),wn(dt),gt(),me(pe),ue(dt),console.log("📝 Step1 모달 열기 with projectId:",pe,"title:",dt),ee(!0)}else alert("로그인이 필요합니다.")},Re=async()=>{ee(!1),me(null),ue(null),b&&await un(b)},Ke=async pe=>{pe.preventDefault(),pe.stopPropagation(),qe(!0)},Ge=async()=>{try{console.log("🔐 Firebase 로그아웃 시작...");const{signOut:pe}=await rl(async()=>{const{signOut:at}=await Promise.resolve().then(()=>hH);return{signOut:at}},void 0),{auth:xe}=await rl(async()=>{const{auth:at}=await Promise.resolve().then(()=>gz);return{auth:at}},void 0);await pe(xe),console.log("✅ Firebase 로그아웃 성공"),n("/auth")}catch(pe){console.error("❌ 로그아웃 실패:",pe),alert("로그아웃 중 오류가 발생했지만 로그인 페이지로 이동합니다."),n("/auth")}};return w?c.jsx("div",{className:ot.dashboard,children:c.jsx("div",{className:ot.emptyState,children:c.jsx("div",{children:"프로젝트 목록을 불러오는 중..."})})}):y?c.jsx("div",{className:ot.dashboard,children:c.jsxs("div",{className:ot.emptyState,children:[c.jsxs("div",{className:ot.emptyStateTitle,children:["오류: ",y]}),c.jsx("button",{onClick:It,className:ot.emptyStateButton,children:"다시 시도"})]})}):c.jsxs("div",{className:ot.dashboard,"data-menu":Oe,children:[c.jsxs("aside",{className:ot.sidebar,children:[c.jsx("div",{className:ot.logoSection,children:c.jsx("div",{className:ot.logo,children:c.jsx(eS,{size:"medium"})})}),c.jsx("div",{className:ot.profileSection,children:c.jsxs("div",{className:ot.userInfo,children:[c.jsx("div",{className:ot.userAvatar,children:t!=null&&t.photoURL&&!d?c.jsx("img",{src:t.photoURL,alt:"프로필",style:{width:"100%",height:"100%",borderRadius:"50%",objectFit:"cover"},onError:()=>A(!0),onLoad:()=>A(!1)}):c.jsx(Vh,{size:16})}),c.jsxs("div",{className:ot.userDetails,children:[c.jsx("div",{className:ot.userName,children:(t==null?void 0:t.displayName)||((pt=t==null?void 0:t.email)==null?void 0:pt.split("@")[0])||"사용자"}),c.jsx("div",{className:ot.userEmail,children:(t==null?void 0:t.email)||"로그인이 필요합니다"})]})]})}),c.jsx("div",{className:ot.createProjectSection,children:c.jsxs("button",{className:ot.createProjectBtn,onClick:ws,children:[c.jsx(Eg,{size:16}),"Create Project"]})}),c.jsxs("nav",{className:ot.navSection,children:[c.jsxs("div",{className:`${ot.navItem} ${Oe==="all"?ot.active:""}`,onClick:()=>{n("/dashboard"),ke("all"),D(null),E(["전체 프로젝트"])},children:[c.jsx("div",{className:ot.navItemIcon,children:c.jsx(um,{size:20})}),c.jsx("span",{children:"전체 프로젝트"}),c.jsx("span",{className:ot.navItemCount,children:jt.length})]}),c.jsxs("div",{className:`${ot.navItem} ${Oe==="shared"?ot.active:""}`,onClick:()=>{n("/dashboard/shared"),D(null),E([])},children:[c.jsx("div",{className:ot.navItemIcon,children:c.jsx(bm,{size:20})}),c.jsx("span",{children:"공유 프로젝트"}),c.jsx("span",{className:ot.navItemCount,children:Ze.length})]}),c.jsxs("div",{className:`${ot.navItem} ${Oe==="profile"?ot.active:""}`,onClick:()=>{n("/dashboard/profile"),E([])},children:[c.jsx("div",{className:ot.navItemIcon,children:c.jsx(Vh,{size:20})}),c.jsx("span",{children:"내 정보 관리"})]}),c.jsxs("div",{className:`${ot.navItem} ${Oe==="team"?ot.active:""}`,onClick:()=>{n("/dashboard/team"),E([])},children:[c.jsx("div",{className:ot.navItemIcon,children:c.jsx(Yy,{size:20})}),c.jsx("span",{children:"팀 관리"})]}),c.jsxs("div",{className:`${ot.navItem} ${Oe==="trash"?ot.active:""}`,onClick:()=>{n("/dashboard/trash"),D(null),E([])},children:[c.jsx("div",{className:ot.navItemIcon,children:c.jsx(xm,{size:20})}),c.jsx("span",{children:"휴지통"}),c.jsx("span",{className:ot.navItemCount,children:st.length})]})]}),c.jsxs("div",{className:ot.settingsSection,children:[c.jsxs("div",{className:ot.settingsItem,onClick:()=>Me(!0),style:{cursor:"pointer"},children:[c.jsx("div",{className:ot.navItemIcon,children:c.jsx(Lk,{size:20})}),c.jsx("span",{children:"설정"})]}),t&&c.jsxs("div",{className:ot.settingsItem,onClick:Ke,children:[c.jsx("div",{className:ot.navItemIcon,children:c.jsx(Nhe,{size:20})}),c.jsx("span",{children:"로그아웃"})]}),!t&&c.jsxs("div",{className:ot.settingsItem,onClick:()=>n("/auth"),children:[c.jsx("div",{className:ot.navItemIcon,children:c.jsx(Vh,{size:20})}),c.jsx("span",{children:"로그인"})]})]})]}),c.jsxs("main",{className:ot.main,children:[c.jsxs("header",{className:ot.header,children:[c.jsx("div",{className:ot.headerLeft}),c.jsxs("div",{className:ot.headerRight,children:[c.jsxs("div",{className:ot.headerActions,children:[c.jsx("button",{className:ot.actionButton,children:c.jsx(Rhe,{size:20})}),c.jsx(e9e,{children:c.jsx("button",{className:ot.actionButton,children:c.jsx(IQ,{size:20})})})]}),c.jsxs("div",{className:ot.userProfile,children:[c.jsx("div",{className:ot.userProfileAvatar,children:t!=null&&t.photoURL&&!f?c.jsx("img",{src:t.photoURL,alt:"프로필",style:{width:"100%",height:"100%",borderRadius:"50%",objectFit:"cover"},onError:()=>p(!0),onLoad:()=>p(!1)}):c.jsx(Vh,{size:14})}),c.jsx("span",{className:ot.userProfileName,children:t?(t==null?void 0:t.displayName)||((Pt=t==null?void 0:t.email)==null?void 0:Pt.split("@")[0])||"사용자":"게스트"})]})]})]}),(Oe==="all"||Oe==="bookmarks"||Oe==="trash"||Oe==="shared")&&c.jsx("div",{className:ot.subHeader,children:c.jsxs("div",{className:ot.subHeaderContent,children:[c.jsxs("div",{className:ot.subHeaderLeft,children:[Oe==="all"&&c.jsx("h1",{className:ot.subHeaderTitle,children:"전체 프로젝트"}),Oe==="trash"&&c.jsx("h1",{className:ot.subHeaderTitle,children:"휴지통"}),Yt.size>0&&c.jsxs("div",{className:ot.selectionInfo,children:[c.jsxs("span",{children:[Yt.size,"개의 항목이 선택됨"]}),c.jsx("button",{className:ot.clearSelectionBtn,onClick:()=>Zt(new Set),children:"선택 해제"})]})]}),c.jsxs("div",{className:ot.subHeaderActions,children:[c.jsxs("div",{className:ot.searchContainer,children:[c.jsx("div",{className:ot.searchIcon,children:c.jsx(Mhe,{size:16})}),c.jsx("input",{type:"text",placeholder:"프로젝트 검색...",className:ot.searchInput})]}),c.jsxs("div",{className:ot.viewToggleGroup,children:[c.jsx("button",{className:`${ot.viewToggleButton} ${s==="grid"?ot.active:""}`,onClick:()=>An("grid"),title:"그리드 보기",children:c.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:[c.jsx("rect",{x:"1",y:"1",width:"6",height:"6",rx:"1"}),c.jsx("rect",{x:"9",y:"1",width:"6",height:"6",rx:"1"}),c.jsx("rect",{x:"1",y:"9",width:"6",height:"6",rx:"1"}),c.jsx("rect",{x:"9",y:"9",width:"6",height:"6",rx:"1"})]})}),c.jsx("button",{className:`${ot.viewToggleButton} ${s==="list"?ot.active:""}`,onClick:()=>An("list"),title:"리스트 보기",children:c.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:[c.jsx("rect",{x:"1",y:"2",width:"14",height:"2",rx:"1"}),c.jsx("rect",{x:"1",y:"7",width:"14",height:"2",rx:"1"}),c.jsx("rect",{x:"1",y:"12",width:"14",height:"2",rx:"1"})]})})]}),c.jsxs("button",{className:ot.sortButton,onClick:()=>u(!h),children:[c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:c.jsx("path",{d:"M3 6h10M5 10h6M7 14h2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",fill:"none"})}),c.jsx("span",{children:a==="date"?"최신순":"이름순"}),c.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor",children:c.jsx("path",{d:"M3 4.5L6 7.5L9 4.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})})]}),h&&c.jsxs("div",{className:ot.sortDropdownMenu,children:[c.jsxs("button",{className:`${ot.sortOption} ${a==="date"?ot.active:""}`,onClick:()=>{nn("date"),u(!1)},children:[c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:c.jsx("path",{d:"M8 3v10M5 10l3 3 3-3",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})}),"최신순"]}),c.jsxs("button",{className:`${ot.sortOption} ${a==="name"?ot.active:""}`,onClick:()=>{nn("name"),u(!1)},children:[c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:c.jsx("path",{d:"M4 6h8M4 10h5M4 14h3",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",fill:"none"})}),"이름순"]})]}),Yt.size>0&&Oe!=="trash"&&c.jsxs("button",{className:ot.bulkDeleteButton,onClick:()=>{window.confirm(`선택한 ${Yt.size}개 항목을 휴지통으로 이동하시겠습니까?`)&&(Yt.forEach(pe=>{const xe=wi.find(at=>at.id===pe);xe&&(xe.type==="project"?ri(xe.project):(xe.type==="design"||xe.type==="folder")&&console.log("삭제할 항목:",xe))}),Zt(new Set))},children:[c.jsx(xm,{size:16}),c.jsxs("span",{children:["휴지통으로 이동 (",Yt.size,")"]})]}),Oe==="trash"&&st.length>0&&c.jsxs("button",{className:ot.emptyTrashBtn,onClick:Ni,children:[c.jsx(xm,{size:16}),c.jsx("span",{children:"휴지통 비우기"})]}),s==="list"&&b&&c.jsxs("button",{className:ot.createDesignBtn,onClick:()=>{ve(b,fn==null?void 0:fn.title)},children:[c.jsx(Eg,{size:14}),c.jsx("span",{children:"디자인 생성"})]})]})]})}),c.jsxs("div",{className:ot.content,children:[Oe==="all"&&jt.length>0&&c.jsxs("aside",{className:`${ot.projectTree} ${ft?ot.collapsed:""}`,children:[c.jsxs("div",{className:ot.treeHeader,children:[c.jsx("button",{className:ot.treeToggleButton,onClick:()=>Xt(!ft),"aria-label":ft?"파일트리 펼치기":"파일트리 접기",children:c.jsx("span",{className:`${ot.toggleIcon} ${ft?ot.collapsed:""}`,children:"◀"})}),c.jsx("div",{className:ot.projectSelectorContainer,children:c.jsx(hG,{projects:jt,currentProject:fn,onProjectSelect:pe=>{console.log("🎯 SimpleDashboard - 프로젝트 선택됨:",pe.id,pe.title),Jn(pe.id)}})})]}),c.jsx("div",{className:ot.treeContent,children:jt.length>0?c.jsx("div",{children:jt.map(pe=>{const xe=T.has(pe.id),at=b===pe.id,dt=L[pe.id]||[],Qt=Wt[pe.id]||[],wn=dt.length>0||Qt.length>0||pe.furnitureCount>0;return c.jsxs("div",{children:[c.jsxs("div",{className:`${ot.treeItem} ${at?ot.active:""}`,onClick:()=>{console.log("🎯 파일트리 프로젝트 클릭:",pe.id,pe.title),Jn(pe.id),te(null)},style:{cursor:"pointer"},children:[wn&&c.jsx("div",{className:`${ot.treeToggleArrow} ${xe?ot.expanded:""}`,onClick:gt=>{gt.stopPropagation(),Dn(pe.id)},children:"▶"}),c.jsx("div",{className:ot.treeItemIcon,children:c.jsx(lOe,{size:16})}),c.jsx("span",{children:pe.title}),(Qt.length>0||pe.furnitureCount>0)&&c.jsx("span",{className:ot.treeItemCount,children:Qt.length||pe.furnitureCount||0}),c.jsx("div",{className:ot.treeItemActions,children:c.jsx("button",{className:ot.treeItemActionBtn,onClick:gt=>{gt.stopPropagation(),Yi(gt,pe.id,pe.title,"project")},children:"⋯"})})]}),xe&&c.jsxs("div",{className:ot.projectChildren,children:[at&&c.jsxs("button",{className:ot.createFolderBtn,onClick:pn,children:[c.jsxs("div",{className:ot.createFolderIcon,children:[c.jsx(um,{size:16}),c.jsx(Eg,{size:12})]}),c.jsx("span",{children:"새로운 폴더"})]}),dt.map(gt=>c.jsxs("div",{children:[c.jsxs("div",{className:ot.treeItem,onClick:()=>{te(gt.id),E(["전체 프로젝트",fn.title,gt.name])},style:{cursor:"pointer"},children:[c.jsx("div",{className:ot.treeItemIcon,onClick:Vn=>{Vn.stopPropagation(),ei(gt.id)},style:{cursor:"pointer"},children:c.jsx(um,{size:16})}),c.jsx("span",{children:gt.name}),gt.children&&gt.children.length>0&&c.jsx("span",{className:ot.treeItemCount,children:gt.children.length}),c.jsx("div",{className:`${ot.dropdownArrow} ${ot.folderDropdown} ${gt.expanded?ot.expanded:""}`,onClick:Vn=>{Vn.stopPropagation(),ei(gt.id)},children:"▼"}),c.jsx("div",{className:ot.treeItemActions,children:c.jsx("button",{className:ot.treeItemActionBtn,onClick:Vn=>{Vn.stopPropagation(),Yi(Vn,gt.id,gt.name,"folder")},children:"⋯"})})]}),gt.expanded&&gt.children&&gt.children.length>0?c.jsx("div",{className:ot.folderChildren,children:gt.children.map(Vn=>c.jsxs("div",{className:`${ot.treeItem} ${ot.childItem}`,onClick:Yn=>{Yn.stopPropagation(),console.log("디자인 파일 클릭됨:",Vn,"폴더 ID:",gt.id,"프로젝트 ID:",b),b!==Vn.projectId&&Vn.projectId&&Jn(Vn.projectId),te(gt.id),E(["전체 프로젝트",fn.title,gt.name]),setTimeout(()=>{const ht=document.querySelectorAll(`.${ot.designCard}`);console.log("모든 디자인 카드:",ht.length);const Ot=Array.from(ht).find(In=>{var Gn;const xn=(Gn=In.querySelector(`.${ot.cardTitle}`))==null?void 0:Gn.textContent;return console.log("카드 제목 확인:",xn,"찾는 디자인:",Vn.name),xn===Vn.name});Ot?(console.log("디자인 카드 찾음:",Ot),Ot.scrollIntoView({behavior:"smooth",block:"center"}),Ot.classList.add(ot.forceHover),setTimeout(()=>{Ot.classList.remove(ot.forceHover)},3e3)):console.log("디자인 카드를 찾을 수 없음:",Vn.name)},300)},style:{cursor:"pointer",userSelect:"none"},onMouseDown:Yn=>Yn.preventDefault(),children:[c.jsx("div",{className:ot.treeItemIcon,children:c.jsx("div",{className:ot.designIcon,children:c.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2.5",children:[c.jsx("path",{d:"M12 19l7-7 3 3-7 7-3-3z"}),c.jsx("path",{d:"M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"}),c.jsx("path",{d:"M2 2l7.586 7.586"}),c.jsx("circle",{cx:"11",cy:"11",r:"2"})]})})}),c.jsx("span",{children:Vn.name}),c.jsx("div",{className:ot.treeItemActions,children:c.jsx("button",{className:ot.treeItemActionBtn,onClick:Yn=>{Yn.stopPropagation(),Yi(Yn,Vn.id,Vn.name,Vn.type==="file"?"design":Vn.type)},children:"⋯"})})]},Vn.id))}):null]},gt.id)),Qt.map(gt=>c.jsxs("div",{className:ot.treeItem,onClick:Vn=>{Vn.stopPropagation(),console.log("디자인 파일 클릭됨:",gt.name),setTimeout(()=>{const Yn=document.querySelectorAll(`.${ot.designCard}`),ht=Array.from(Yn).find(Ot=>{var xn;return((xn=Ot.querySelector(`.${ot.cardTitle}`))==null?void 0:xn.textContent)===gt.name});ht&&(ht.scrollIntoView({behavior:"smooth",block:"center"}),ht.classList.add(ot.forceHover),setTimeout(()=>{ht.classList.remove(ot.forceHover)},3e3))},100)},children:[c.jsx("div",{className:ot.treeItemIcon,children:c.jsx("div",{className:ot.designIcon,children:c.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2.5",children:[c.jsx("path",{d:"M12 19l7-7 3 3-7 7-3-3z"}),c.jsx("path",{d:"M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"}),c.jsx("path",{d:"M2 2l7.586 7.586"}),c.jsx("circle",{cx:"11",cy:"11",r:"2"})]})})}),c.jsx("span",{children:gt.name}),c.jsx("div",{className:ot.treeItemActions,children:c.jsx("button",{className:ot.treeItemActionBtn,onClick:Vn=>{Vn.stopPropagation(),Yi(Vn,gt.id,gt.name,"design")},children:"⋯"})})]},gt.id))]})]},pe.id)})}):t?c.jsx("div",{className:ot.treeItem,children:c.jsx("span",{style:{color:"#999",fontSize:"14px"},children:"프로젝트가 없습니다"})}):c.jsx("div",{className:ot.treeItem,children:c.jsx("span",{style:{color:"#999",fontSize:"14px"},children:"로그인이 필요합니다"})})})]}),c.jsxs("section",{className:ot.designArea,children:[c.jsxs("div",{className:ot.breadcrumb,children:[Oe==="bookmarks"&&c.jsx("h2",{className:ot.pageTitle,children:"북마크"}),Oe==="all"&&B.map((pe,xe)=>c.jsxs(ci.Fragment,{children:[c.jsx("span",{className:`${ot.breadcrumbItem} ${xe===B.length-1?ot.active:""}`,onClick:()=>Qn(xe),children:pe}),xe<B.length-1&&c.jsx("span",{className:ot.breadcrumbSeparator,children:"/"})]},xe))]}),Oe==="shared"&&c.jsx(R7e,{onProjectSelect:pe=>n(`/configurator?projectId=${pe}`)}),Oe==="team"&&c.jsx(U7e,{onTeamSelect:pe=>console.log("팀 선택:",pe)}),Oe==="profile"&&c.jsx(G7e,{}),console.log("🔍 activeMenu 체크:",{activeMenu:Oe,isAllTrashBookmarks:Oe==="all"||Oe==="trash"||Oe==="bookmarks",shouldShowGrid:Oe==="all"||Oe==="trash"||Oe==="bookmarks"}),Oe==="all"||Oe==="trash"||Oe==="bookmarks"?c.jsxs(c.Fragment,{children:[s==="list"&&wi.some(pe=>pe.type!=="new-design")&&c.jsxs("div",{className:ot.listTableHeader,children:[c.jsx("div",{className:ot.headerColumn,children:c.jsx("input",{type:"checkbox",checked:(()=>{const pe=wi.filter(xe=>xe.type!=="new-design");return pe.length>0&&pe.every(xe=>Yt.has(xe.id))})(),onChange:()=>gn(wi)})}),c.jsx("div",{className:ot.headerColumn,children:"제목"}),c.jsx("div",{className:ot.headerColumn,children:"마지막 수정일"}),c.jsx("div",{className:ot.headerColumn,children:"등록자"}),c.jsx("div",{className:ot.headerColumn})]}),c.jsxs("div",{className:`${ot.designGrid} ${s==="list"?ot.listView:""} ${z?ot.folderView:""}`,children:[console.log("🎨 렌더링 시작:",{sortedItemsLength:wi.length,viewMode:s,items:wi.map(pe=>({type:pe.type,name:pe.name})),filteredItems:wi.filter(pe=>!(s==="list"&&pe.type==="new-design")).map(pe=>({type:pe.type,name:pe.name}))}),(()=>{if(w&&wi.length===0)return c.jsx(c.Fragment,{children:[1,2,3,4].map(xe=>c.jsxs(fr.div,{className:ot.designCard,style:{opacity:.3,pointerEvents:"none"},children:[c.jsx("div",{className:ot.designCardThumbnail,style:{background:"#f0f0f0"},children:c.jsx("div",{style:{width:"100%",height:"100%",background:"linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%)",animation:"shimmer 2s infinite"}})}),c.jsxs("div",{className:ot.designCardFooter,children:[c.jsx("div",{style:{width:"60%",height:"16px",background:"#f0f0f0",borderRadius:"4px"}}),c.jsx("div",{style:{width:"30%",height:"12px",background:"#f0f0f0",borderRadius:"4px",marginTop:"4px"}})]})]},`skeleton-${xe}`))});const pe=wi.filter(xe=>s==="list"&&xe.type==="new-design"?(console.log("📝 리스트 뷰에서 new-design 카드 제외"),!1):!0);return console.log("🔍 필터링 후 상태:",{viewMode:s,sortedItemsLength:wi.length,filteredItemsLength:pe.length,sortedItems:wi.map(xe=>({type:xe.type,name:xe.name})),filteredItems:pe.map(xe=>({type:xe.type,name:xe.name}))}),console.log("🚨 렌더링 조건 체크:",{filteredItemsLength:pe.length,filteredItemsEmpty:pe.length===0,willRenderCards:pe.length>0}),pe.length>0?pe.map((xe,at)=>{var dt,Qt,wn;return c.jsxs(fr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:at*.05,ease:[.4,0,.2,1]},whileHover:{y:-4,scale:1.02},whileTap:{scale:.98},className:`${ot.designCard} ${xe.type==="new-design"?ot.newDesign:""} ${xe.type==="folder"?ot.folderCard:""}`,"data-design-id":xe.type==="design"?xe.id:void 0,"data-item-type":xe.type,draggable:xe.type==="design",onDragStart:gt=>{xe.type==="design"&&ln(gt,{id:xe.id,name:xe.name,type:"design",projectId:xe.project.id})},onDragEnd:kr,onClick:gt=>{var Vn,Yn;if(console.log("🖱️ 카드 클릭됨:",{itemType:xe.type,itemName:xe.name,itemId:xe.id,projectId:(Vn=xe.project)==null?void 0:Vn.id,clickEvent:gt.type}),xe.type==="project")console.log("📂 프로젝트 선택"),Jn(xe.project.id);else if(xe.type==="new-design")console.log("➕ 새 디자인 생성"),ve(xe.project.id,xe.project.title);else if(xe.type==="loading")console.log("⏳ 로딩 중...");else if(xe.type==="folder"){console.log("📁 폴더 이동"),te(xe.id);const ht=(Yn=L[b])==null?void 0:Yn.find(Ot=>Ot.id===xe.id);ht&&fn&&E(["전체 프로젝트",fn.title,ht.name])}else xe.type==="design"&&(console.log("🎨 디자인 카드 클릭 - 액션 팝업 표시",{itemId:xe.id,projectId:xe.project.id,itemName:xe.name,hasDesignFile:!!xe.designFile,viewMode:s}),s!=="list"&&(xe.designFile&&xe.designFile.id?n(`/configurator?projectId=${xe.project.id}&designFileId=${xe.designFile.id}`):n(`/configurator?projectId=${xe.project.id}&designFileName=${encodeURIComponent(xe.name)}`)))},children:[xe.type!=="new-design"&&xe.type!=="loading"&&c.jsx("div",{className:ot.cardCheckbox,children:c.jsx("input",{type:"checkbox",checked:Yt.has(xe.id),onChange:gt=>{gt.stopPropagation(),zt(xe.id,gt.target.checked)},onClick:gt=>gt.stopPropagation()})}),xe.type!=="new-design"&&xe.type!=="loading"&&c.jsx("button",{className:ot.cardActionButton,onClick:gt=>{gt.stopPropagation(),xe.type==="folder"?Yi(gt,xe.id,xe.name,"folder"):xe.type==="design"?Yi(gt,xe.id,xe.name,"design"):xe.type==="project"&&Yi(gt,xe.project.id,xe.project.title,"project")},children:"⋯"}),c.jsx("div",{className:`${ot.cardThumbnail} ${xe.type==="new-design"?ot.newDesign:""} ${xe.type==="folder"?ot.folderDropZone:""} ${J.dragOverFolder===xe.id?ot.dragOver:""}`,onDragOver:gt=>{xe.type==="folder"&&li(gt,xe.id)},onDragLeave:hi,onDrop:gt=>{xe.type==="folder"&&Ii(gt,xe.id)},children:xe.type==="new-design"?c.jsxs("div",{className:ot.cardThumbnailContent,children:[c.jsx("div",{className:ot.cardThumbnailIcon,children:c.jsx(Eg,{size:32})}),c.jsx("div",{className:ot.cardThumbnailText,children:xe.name})]}):xe.type==="loading"?c.jsxs("div",{className:ot.cardThumbnailContent,children:[c.jsx("div",{className:ot.cardThumbnailIcon,children:c.jsx("div",{style:{opacity:.5},children:"⏳"})}),c.jsx("div",{className:ot.cardThumbnailText,children:xe.name})]}):xe.type==="folder"?c.jsx("div",{className:ot.folderIcon,children:c.jsxs("svg",{className:ot.folderIconSvg,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[c.jsx("path",{d:"M4 4h6l2 2h8a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2z",fill:"var(--theme-primary, #10b981)"}),c.jsx("path",{d:"M4 6h16v10H4V6z",fill:"var(--theme-primary, #10b981)",fillOpacity:"0.7"})]})}):(()=>{var Yn,ht,Ot;if(xe.type==="design"){const In=Wt[xe.project.id]||[],Wn=xe.designFile||In.find(xn=>xn.name===xe.name||xn.id===xe.id);return console.log("🔍 디자인 카드 썸네일 생성:",{itemName:xe.name,itemId:xe.id,projectId:xe.project.id,designFilesCount:In.length,designFilesData:In.map(xn=>({id:xn.id,name:xn.name,matchesName:xn.name===xe.name,matchesId:xn.id===xe.id})),foundDesignFile:!!Wn,designFileData:Wn?{id:Wn.id,name:Wn.name,hasSpaceConfig:!!Wn.spaceConfig,hasFurniture:!!Wn.furniture,furnitureCount:((ht=(Yn=Wn.furniture)==null?void 0:Yn.placedModules)==null?void 0:ht.length)||0}:null}),c.jsxs("div",{className:ot.designThumbnail,children:[c.jsx(uR,{project:xe.project,designFile:Wn?{thumbnail:Wn.thumbnail,updatedAt:Wn.updatedAt,spaceConfig:Wn.spaceConfig,furniture:Wn.furniture}:void 0,className:ot.designThumbnailImage,alt:xe.name}),s==="grid"&&c.jsxs("div",{className:ot.designCardOverlay,children:[c.jsxs("button",{className:ot.overlayButton,onClick:xn=>{var fi,Ki;xn.stopPropagation(),console.log("🔥 디자인 미리보기 버튼 클릭:",{itemId:xe.id,itemType:xe.type,projectId:xe.project.id,hasDesignFile:!!xe.designFile,designFileId:(fi=xe.designFile)==null?void 0:fi.id,itemData:xe});const Gn=((Ki=xe.designFile)==null?void 0:Ki.id)||(xe.id.endsWith("-design")?void 0:xe.id);Ve(xe.project.id,Gn)},children:[c.jsx(Xj,{size:16}),"디자인 미리보기"]}),c.jsxs("button",{className:`${ot.overlayButton} ${ot.primary}`,onClick:xn=>{xn.stopPropagation(),console.log("🎨 오버레이 버튼 클릭 - 에디터로 이동",{itemId:xe.id,projectId:xe.project.id,itemName:xe.name,hasDesignFile:!!xe.designFile}),xe.designFile&&xe.designFile.id?n(`/configurator?projectId=${xe.project.id}&designFileId=${xe.designFile.id}`):n(`/configurator?projectId=${xe.project.id}&designFileName=${encodeURIComponent(xe.name)}`)},children:[c.jsx(Ky,{size:16}),"에디터로 이동"]})]})]})}console.log("🚀 getProjectItems 호출 전 상태:",{projectId:xe.project.id,projectTitle:xe.project.title,projectDesignFilesState:Wt,hasDesignFiles:!!Wt[xe.project.id],designFilesCount:((Ot=Wt[xe.project.id])==null?void 0:Ot.length)||0});const gt=xr(xe.project.id);if(console.log("🎯 프로젝트 아이템 렌더링 확인:",{projectId:xe.project.id,projectTitle:xe.project.title,projectItemsCount:gt.length,projectItems:gt.map(In=>({id:In.id,type:In.type,name:In.name})),timestamp:new Date().toISOString()}),gt.length===0)return c.jsxs("div",{className:ot.emptyThumbnailState,children:[c.jsx("div",{className:ot.emptyThumbnailIcon,children:c.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[c.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),c.jsx("polyline",{points:"14,2 14,8 20,8"}),c.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),c.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),c.jsx("polyline",{points:"10,9 9,9 8,9"})]})}),c.jsx("div",{className:ot.emptyThumbnailText,children:"생성된 파일이 없습니다"})]});const Vn=gt.slice(0,4);return c.jsxs("div",{className:ot.thumbnailGrid,children:[Vn.map((In,Wn)=>c.jsx("div",{className:ot.thumbnailItem,children:In.type==="folder"?c.jsx("div",{className:ot.thumbnailFolder,children:c.jsx(um,{size:24})}):In.type==="design"&&In.designFile?c.jsx(uR,{project:xe.project,designFile:{thumbnail:In.designFile.thumbnail,updatedAt:In.designFile.updatedAt,spaceConfig:In.designFile.spaceConfig,furniture:In.designFile.furniture},className:ot.thumbnailImage,alt:In.name}):c.jsx("div",{className:ot.thumbnailFile,children:c.jsx("div",{className:ot.fileIconWrapper,children:c.jsx("span",{className:ot.fileIcon,children:"D"})})})},In.id)),Array.from({length:4-Vn.length}).map((In,Wn)=>c.jsx("div",{className:ot.thumbnailEmpty},`empty-${Wn}`))]})})()}),xe.type!=="new-design"&&(xe.type==="folder"?c.jsxs("div",{className:ot.cardInfo,children:[c.jsx("div",{className:ot.cardTitle,children:xe.name}),c.jsx("div",{className:ot.cardMeta,children:c.jsx("div",{className:ot.cardDate,children:(()=>{const gt=xe.project.createdAt||xe.project.updatedAt;return gt&&gt.seconds?new Date(gt.seconds*1e3).toLocaleString("ko-KR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"날짜 정보 없음"})()})}),c.jsxs("div",{className:ot.cardFooter,children:[c.jsxs("div",{className:ot.cardUser,children:[c.jsx("div",{className:ot.cardUserAvatar,children:t!=null&&t.photoURL?c.jsx("img",{src:t.photoURL,alt:"프로필",style:{width:"100%",height:"100%",borderRadius:"50%",objectFit:"cover"}}):c.jsx(Vh,{size:12})}),c.jsx("span",{className:ot.cardUserName,children:(t==null?void 0:t.displayName)||((dt=t==null?void 0:t.email)==null?void 0:dt.split("@")[0])||"이진수"})]}),c.jsx("div",{className:ot.cardBadge,children:(()=>{const Vn=(L[xe.project.id]||[]).find(ht=>ht.id===xe.id);if(!(Vn!=null&&Vn.children))return 0;const Yn=Vn.children.filter(ht=>ht.type==="design"||ht.type==="file"||!ht.type).length;return console.log(`폴더 ${xe.name}의 디자인 파일 개수:`,Yn,Vn.children),Yn})()})]})]}):xe.type==="design"?c.jsxs("div",{className:ot.cardInfo,children:[c.jsxs("div",{className:ot.cardTitle,children:[xe.name,s==="list"&&c.jsxs("div",{className:ot.listActionButtons,children:[c.jsxs("button",{className:ot.listActionBtn,onClick:gt=>{gt.stopPropagation(),mt(xe.id)},title:"미리보기",children:[c.jsx(Xj,{size:16}),c.jsx("span",{children:"미리보기"})]}),c.jsxs("button",{className:ot.listActionBtn,onClick:gt=>{gt.stopPropagation(),xe.designFile&&xe.designFile.id?n(`/configurator?projectId=${xe.project.id}&designFileId=${xe.designFile.id}`):n(`/configurator?projectId=${xe.project.id}&designFileName=${encodeURIComponent(xe.name)}`)},title:"에디터로 이동",children:[c.jsx(Ky,{size:16}),c.jsx("span",{children:"에디터로 이동"})]})]})]}),c.jsx("div",{className:ot.cardMeta,children:c.jsx("div",{className:ot.cardDate,children:(()=>{const gt=xe.project.updatedAt||xe.project.createdAt;return gt&&gt.seconds?new Date(gt.seconds*1e3).toLocaleString("ko-KR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"날짜 정보 없음"})()})}),c.jsx("div",{className:ot.cardFooter,children:c.jsxs("div",{className:ot.cardUser,children:[c.jsx("div",{className:ot.cardUserAvatar,children:t!=null&&t.photoURL?c.jsx("img",{src:t.photoURL,alt:"프로필",style:{width:"100%",height:"100%",borderRadius:"50%",objectFit:"cover"}}):c.jsx(Vh,{size:12})}),c.jsx("span",{className:ot.cardUserName,children:(t==null?void 0:t.displayName)||((Qt=t==null?void 0:t.email)==null?void 0:Qt.split("@")[0])||"이진수"})]})})]}):c.jsxs("div",{className:ot.cardInfo,children:[c.jsx("div",{className:ot.cardTitle,children:xe.name}),c.jsx("div",{className:ot.cardMeta,children:c.jsx("div",{className:ot.cardDate,children:(()=>{const gt=xe.project.createdAt||xe.project.updatedAt;return gt&&gt.seconds?new Date(gt.seconds*1e3).toLocaleString("ko-KR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"날짜 정보 없음"})()})}),c.jsxs("div",{className:ot.cardFooter,children:[c.jsxs("div",{className:ot.cardUser,children:[c.jsx("div",{className:ot.cardUserAvatar,children:t!=null&&t.photoURL?c.jsx("img",{src:t.photoURL,alt:"프로필",style:{width:"100%",height:"100%",borderRadius:"50%",objectFit:"cover"}}):c.jsx(Vh,{size:12})}),c.jsx("span",{className:ot.cardUserName,children:(t==null?void 0:t.displayName)||((wn=t==null?void 0:t.email)==null?void 0:wn.split("@")[0])||"이진수"})]}),c.jsx("div",{className:ot.cardBadge,children:"V5.0"})]})]}))]},xe.id)}):w?null:c.jsx("div",{className:ot.emptyState,children:c.jsx("div",{className:ot.emptyStateTitle,children:"표시할 항목이 없습니다"})})})(),t&&wi.length===0&&!w?c.jsxs("div",{className:ot.emptyState,children:[c.jsxs("div",{className:ot.emptyStateTitle,children:[Oe==="bookmarks"&&"북마크한 프로젝트가 없습니다",Oe==="shared"&&"공유된 프로젝트가 없습니다",Oe==="trash"&&"휴지통이 비어있습니다",Oe==="all"&&"아직 생성된 프로젝트가 없습니다"]}),c.jsxs("div",{className:ot.emptyStateSubtitle,children:[Oe==="bookmarks"&&"프로젝트를 북마크하려면 ⋯ 메뉴를 사용하세요",Oe==="shared"&&"다른 사용자가 공유한 프로젝트가 여기에 표시됩니다",Oe==="trash"&&"삭제된 프로젝트가 여기에 표시됩니다",Oe==="all"&&"새 프로젝트를 생성해보세요"]})]}):null]})]}):null]})]})]}),Ce&&c.jsx("div",{className:ot.modalOverlay,children:c.jsxs("div",{className:ot.modal,children:[c.jsx("h2",{className:ot.modalTitle,children:"새 프로젝트 생성"}),c.jsx("input",{type:"text",value:fe,onChange:pe=>M(pe.target.value),placeholder:"프로젝트 이름을 입력하세요",className:ot.modalInput,onKeyPress:pe=>{pe.key==="Enter"&&fe.trim()&&Ts()},autoFocus:!0}),c.jsxs("div",{className:ot.modalActions,children:[c.jsx("button",{onClick:Mn,disabled:Z,className:ot.modalCancelBtn,children:"취소"}),c.jsx("button",{onClick:Ts,disabled:!fe.trim()||Z,className:ot.modalCreateBtn,children:Z?"생성 중...":"생성"})]})]})}),De&&c.jsx("div",{className:ot.modalOverlay,children:c.jsxs("div",{className:ot.modal,children:[c.jsx("h2",{className:ot.modalTitle,children:"로그아웃 하시겠습니까?"}),c.jsxs("div",{className:ot.modalActions,children:[c.jsx("button",{onClick:()=>qe(!1),className:ot.modalCancelBtn,children:"취소"}),c.jsx("button",{onClick:Ge,className:ot.modalCreateBtn,children:"로그아웃"})]})]})}),q&&c.jsxs(c.Fragment,{children:[c.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:999},onClick:zr}),c.jsxs("div",{className:ot.contextMenu,style:{position:"fixed",top:q.y,left:q.x,zIndex:1e3},children:[c.jsx("div",{className:ot.contextMenuItem,onClick:()=>Us(q.fileId),children:"이름 변경"}),c.jsx("div",{className:ot.contextMenuItem,onClick:()=>io(q.fileId),children:"삭제"})]})]}),console.log("🔍 moreMenu 상태:",U),U&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:ot.moreMenuBackdrop,onClick:Bn}),c.jsxs("div",{className:ot.moreMenu,style:{position:"fixed",top:U.y,left:U.x},children:[c.jsxs("div",{className:ot.moreMenuItem,onClick:Ri,children:[c.jsx(Ky,{size:14}),"이름 바꾸기"]}),c.jsxs("div",{className:ot.moreMenuItem,onClick:on,children:[c.jsx(DQ,{size:14}),"복제하기"]}),c.jsxs("div",{className:ot.moreMenuItem,onClick:Bt,children:[c.jsx(bm,{size:14}),"공유하기"]}),(U.itemType==="project"||U.itemType==="design"||U.itemType==="folder")&&c.jsxs("div",{className:ot.moreMenuItem,onClick:()=>{U.itemType==="project"?Zn(U.itemId):U.itemType==="design"?Hn(U.itemId):U.itemType==="folder"&&ti(U.itemId),Bn()},children:[c.jsx(jhe,{size:14}),U.itemType==="project"?je.has(U.itemId)?"북마크 해제":"북마크 추가":U.itemType==="design"?_t.has(U.itemId)?"북마크 해제":"북마크 추가":Le.has(U.itemId)?"북마크 해제":"북마크 추가"]}),c.jsxs("div",{className:`${ot.moreMenuItem} ${ot.deleteItem}`,onClick:()=>{if(Oe==="trash")window.confirm("정말로 영구 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다.")&&xt();else if(U.itemType==="project"){const pe=jt.find(xe=>xe.id===U.itemId);pe&&(ri(pe),Bn())}else xt()},children:[c.jsx(xm,{size:14}),Oe==="trash"?"영구 삭제":"휴지통으로 이동"]}),Oe==="trash"&&U.itemType==="project"&&c.jsxs("div",{className:ot.moreMenuItem,onClick:()=>{bi(U.itemId),Bn()},children:[c.jsx(um,{size:14}),"복원하기"]})]})]}),K&&c.jsx("div",{className:ot.modalOverlay,children:c.jsxs("div",{className:ot.modal,children:[c.jsx("h2",{className:ot.modalTitle,children:"새 폴더 생성"}),c.jsx("input",{type:"text",value:Q,onChange:pe=>X(pe.target.value),placeholder:"폴더 이름을 입력하세요",className:ot.modalInput,onKeyPress:pe=>{pe.key==="Enter"&&Q.trim()&&Ln()},autoFocus:!0}),c.jsxs("div",{className:ot.modalActions,children:[c.jsx("button",{onClick:xi,disabled:W,className:ot.modalCancelBtn,children:"취소"}),c.jsx("button",{onClick:Ln,disabled:!Q.trim()||W,className:ot.modalCreateBtn,children:W?"생성 중...":"생성"})]})]})}),ie&&ae&&c.jsx("div",{"data-theme":"light",style:{colorScheme:"light"},children:c.jsx(cE,{onClose:Re,projectId:ae,projectTitle:_e||void 0})}),et&&c.jsx("div",{className:ot.modalOverlay,children:c.jsxs("div",{className:ot.modal,children:[c.jsx("h2",{className:ot.modalTitle,children:"팀 관리"}),c.jsx("div",{className:ot.teamModalContent,children:c.jsx("div",{className:ot.teamList,children:c.jsxs("div",{className:ot.teamEmpty,children:[c.jsx(Yy,{size:40}),c.jsx("p",{children:"아직 팀이 없습니다"}),c.jsxs("button",{className:ot.createTeamBtn,onClick:()=>alert("팀 생성 기능은 준비 중입니다."),children:[c.jsx(Eg,{size:16}),"새 팀 만들기"]})]})})}),c.jsx("div",{className:ot.modalActions,children:c.jsx("button",{onClick:()=>He(!1),className:ot.modalCancelBtn,children:"닫기"})})]})}),c.jsx(T9e,{isOpen:Be.isOpen,onClose:ct,projectId:Be.projectId,designFileId:Be.designFileId}),c.jsx(o8,{isOpen:Je,onClose:()=>Me(!1)}),ie&&ae&&c.jsx(cE,{onClose:Re,projectId:ae,projectTitle:_e||void 0})]})},hOe="_viewerPage_1gu6b_2",uOe="_viewerHeader_1gu6b_12",dOe="_headerLeft_1gu6b_23",AOe="_projectTitle_1gu6b_29",fOe="_projectInfo_1gu6b_36",pOe="_headerCenter_1gu6b_41",gOe="_viewModeToggle_1gu6b_47",mOe="_viewModeButton_1gu6b_55",yOe="_active_1gu6b_68",wOe="_headerActions_1gu6b_78",vOe="_actionButton_1gu6b_84",xOe="_shareButton_1gu6b_103",bOe="_viewerContent_1gu6b_124",COe="_viewerFooter_1gu6b_133",_Oe="_projectMeta_1gu6b_142",SOe="_errorState_1gu6b_148",TOe="_errorMessage_1gu6b_158",BOe="_retryButton_1gu6b_164",Ia={viewerPage:hOe,viewerHeader:uOe,headerLeft:dOe,projectTitle:AOe,projectInfo:fOe,headerCenter:pOe,viewModeToggle:gOe,viewModeButton:mOe,active:yOe,headerActions:wOe,actionButton:vOe,shareButton:xOe,viewerContent:bOe,viewerFooter:COe,projectMeta:_Oe,errorState:SOe,errorMessage:TOe,retryButton:BOe},EOe=()=>{var f;const{projectId:n}=Qq(),[e,t]=H.useState(null),[i,r]=H.useState(!0),[s,o]=H.useState(null),[a,l]=H.useState("3D"),[h,u]=H.useState(!1);H.useEffect(()=>{n&&d()},[n]);const d=async()=>{var p,g,v,w,m,y,x,S,I,j,C,b,D;console.log("🔥 ViewerPage - loadProject 시작:",{projectId:n}),r(!0),o(null);try{if(n!=null&&n.startsWith("design_")){console.log("🔥 디자인 파일 로드 시도 (공유 링크):",n);const T=await zz(n);if(console.log("🔥 디자인 파일 로드 결과 (공유 링크):",T),T.designFile){const k={id:T.designFile.projectId,title:T.designFile.name,createdAt:T.designFile.createdAt,updatedAt:T.designFile.updatedAt,furnitureCount:((g=(p=T.designFile.furniture)==null?void 0:p.placedModules)==null?void 0:g.length)||0,spaceSize:{width:((v=T.designFile.spaceConfig)==null?void 0:v.width)||3600,height:((w=T.designFile.spaceConfig)==null?void 0:w.height)||2400,depth:((m=T.designFile.spaceConfig)==null?void 0:m.depth)||1500},thumbnail:T.designFile.thumbnail,folderId:"",spaceInfo:T.designFile.spaceConfig,placedModules:((y=T.designFile.furniture)==null?void 0:y.placedModules)||[]};console.log("🔥 디자인 파일 로드 성공 (가구 포함):",{designFileId:n,name:T.designFile.name,placedModulesCount:((x=k.placedModules)==null?void 0:x.length)||0,placedModules:k.placedModules}),t(k)}else o(T.error||"디자인 파일을 찾을 수 없습니다.")}else{console.log("🔥 프로젝트 로드 시도 (공유 링크):",n);const T=await Qz(n);if(console.log("🔥 프로젝트 로드 결과 (공유 링크):",T),T.project){const k={id:T.project.id,title:T.project.title,createdAt:T.project.createdAt,updatedAt:T.project.updatedAt,furnitureCount:((S=T.project.stats)==null?void 0:S.furnitureCount)||0,spaceSize:{width:((I=T.project.spaceConfig)==null?void 0:I.width)||3600,height:((j=T.project.spaceConfig)==null?void 0:j.height)||2400,depth:((C=T.project.spaceConfig)==null?void 0:C.depth)||1500},thumbnail:T.project.thumbnail,folderId:T.project.folderId,spaceInfo:T.project.spaceConfig||{width:3600,height:2400,depth:1500,installType:"builtin",surroundType:"surround",baseConfig:{type:"floor",height:65,placementType:"ground"},hasFloorFinish:!1,floorFinish:null,wallConfig:{left:!0,right:!0,top:!0},materialConfig:{interiorColor:"#FFFFFF",doorColor:"#E0E0E0"},columns:[],frameSize:{upper:50,left:50,right:50},gapConfig:{left:2,right:2}},placedModules:((b=T.project.furniture)==null?void 0:b.placedModules)||[]};console.log("🔥 프로젝트 로드 성공 (가구 포함):",{title:k.title,placedModulesCount:((D=k.placedModules)==null?void 0:D.length)||0,placedModules:k.placedModules}),t(k)}else o(T.error||"프로젝트를 찾을 수 없습니다.")}}catch(T){console.error("프로젝트 로드 실패:",T),o("프로젝트를 불러오는 중 오류가 발생했습니다.")}finally{r(!1)}},A=()=>{document.fullscreenElement?(document.exitFullscreen(),u(!1)):(document.documentElement.requestFullscreen(),u(!0))};return i?c.jsx(k1,{fullscreen:!0,message:"프로젝트를 불러오는 중..."}):s?c.jsxs("div",{className:Ia.errorState,children:[c.jsx("p",{className:Ia.errorMessage,children:s}),c.jsx("button",{onClick:d,className:Ia.retryButton,children:"다시 시도"})]}):e?c.jsxs("div",{className:Ia.viewerPage,children:[c.jsxs("div",{className:Ia.viewerHeader,children:[c.jsxs("div",{className:Ia.headerLeft,children:[c.jsx("h1",{className:Ia.projectTitle,children:e.title}),c.jsxs("span",{className:Ia.projectInfo,children:[a," 미리보기"]})]}),c.jsx("div",{className:Ia.headerCenter,children:c.jsxs("div",{className:Ia.viewModeToggle,children:[c.jsx("button",{className:`${Ia.viewModeButton} ${a==="2D"?Ia.active:""}`,onClick:()=>l("2D"),children:"2D"}),c.jsx("button",{className:`${Ia.viewModeButton} ${a==="3D"?Ia.active:""}`,onClick:()=>l("3D"),children:"3D"})]})}),c.jsxs("div",{className:Ia.headerActions,children:[c.jsx("button",{className:Ia.actionButton,onClick:A,title:h?"창 모드":"전체화면",children:h?c.jsx(PQ,{size:20}):c.jsx(jQ,{size:20})}),c.jsx("button",{className:Ia.shareButton,onClick:()=>{const p=window.location.href;navigator.clipboard.writeText(p).then(()=>{alert(`공유 링크가 클립보드에 복사되었습니다!
${p}`)}).catch(()=>{prompt("공유 링크를 복사하세요:",p)})},children:"공유하기"})]})]}),c.jsxs("div",{className:Ia.viewerContent,children:[console.log("🔥 ViewerPage 렌더링 - Space3DViewerReadOnly props:",{projectId:n,viewMode:a,hasSpaceConfig:!!e.spaceInfo,placedModulesCount:((f=e.placedModules)==null?void 0:f.length)||0,placedModules:e.placedModules}),c.jsx(jK,{spaceConfig:e.spaceInfo,placedModules:e.placedModules||[],viewMode:a,renderMode:"solid"},`${n}-${a}`)]}),c.jsx("div",{className:Ia.viewerFooter,children:c.jsx("div",{className:Ia.projectMeta,children:c.jsxs("span",{children:["마지막 수정: ",(()=>{if(e.updatedAt)try{const p=e.updatedAt.seconds?new Date(e.updatedAt.seconds*1e3):new Date(e.updatedAt),v=Math.floor((new Date().getTime()-p.getTime())/(1e3*60*60));return v<1?"방금 전":v<24?`${v}시간 전`:v<168?`${Math.floor(v/24)}일 전`:p.toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})}catch(p){return console.error("날짜 변환 오류:",p),"알 수 없음"}if(e.createdAt)try{return(e.createdAt.seconds?new Date(e.createdAt.seconds*1e3):new Date(e.createdAt)).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})}catch(p){console.error("생성일 변환 오류:",p)}return"알 수 없음"})()]})})})]}):c.jsx("div",{className:Ia.errorState,children:c.jsx("p",{className:Ia.errorMessage,children:"프로젝트를 찾을 수 없습니다."})})},FOe="_button_10s4q_1",kOe="_primary_10s4q_22",IOe="_disabled_10s4q_27",DOe="_secondary_10s4q_31",jOe="_danger_10s4q_41",POe="_small_10s4q_51",NOe="_medium_10s4q_56",LOe="_large_10s4q_61",Ob={button:FOe,primary:kOe,disabled:IOe,secondary:DOe,danger:jOe,small:POe,medium:NOe,large:LOe},X6=({variant:n="primary",size:e="medium",children:t,className:i="",disabled:r=!1,...s})=>{const o=[Ob.button,Ob[n],Ob[e],r?Ob.disabled:"",i].filter(Boolean).join(" ");return c.jsx("button",{className:o,disabled:r,...s,children:t})},MOe="_loginForm_1vb50_1",ROe="_container_1vb50_36",UOe="_input_1vb50_63",OOe="_logoSection_1vb50_128",HOe="_logo_1vb50_128",WOe="_logoIcon_1vb50_142",zOe="_logoText_1vb50_156",QOe="_title_1vb50_162",$Oe="_form_1vb50_170",VOe="_inputGroup_1vb50_177",GOe="_label_1vb50_183",XOe="_passwordWrapper_1vb50_213",YOe="_passwordToggle_1vb50_217",KOe="_optionsRow_1vb50_234",qOe="_checkboxLabel_1vb50_241",ZOe="_checkbox_1vb50_241",JOe="_checkboxText_1vb50_260",eHe="_forgotPassword_1vb50_265",tHe="_error_1vb50_282",nHe="_loginButton_1vb50_293",iHe="_divider_1vb50_336",rHe="_snsSection_1vb50_363",sHe="_snsTitle_1vb50_368",oHe="_snsButtons_1vb50_374",aHe="_snsButton_1vb50_374",lHe="_snsIcon_1vb50_417",cHe="_demoButton_1vb50_424",Qs={loginForm:MOe,container:ROe,input:UOe,logoSection:OOe,logo:HOe,logoIcon:WOe,logoText:zOe,title:QOe,form:$Oe,inputGroup:VOe,label:GOe,passwordWrapper:XOe,passwordToggle:YOe,optionsRow:KOe,checkboxLabel:qOe,checkbox:ZOe,checkboxText:JOe,forgotPassword:eHe,error:tHe,loginButton:nHe,divider:iHe,snsSection:rHe,snsTitle:sHe,snsButtons:oHe,snsButton:aHe,snsIcon:lHe,demoButton:cHe},hHe=({onSuccess:n})=>{const e=ph(),{user:t,loading:i}=Vc(),[r,s]=H.useState(""),[o,a]=H.useState(""),[l,h]=H.useState(""),[u,d]=H.useState(!1),[A,f]=H.useState(!1),[p,g]=H.useState(null),[v,w]=H.useState(!1),[m,y]=H.useState(!1);H.useEffect(()=>{const C=document.documentElement,b={background:getComputedStyle(C).getPropertyValue("--theme-background"),text:getComputedStyle(C).getPropertyValue("--theme-text"),surface:getComputedStyle(C).getPropertyValue("--theme-surface"),mode:getComputedStyle(C).getPropertyValue("--theme-mode")};C.style.setProperty("--theme-background","#ffffff","important"),C.style.setProperty("--theme-text","#333333","important"),C.style.setProperty("--theme-surface","#ffffff","important"),C.style.setProperty("--theme-mode","light","important"),Array.from(document.body.classList).filter(z=>z.includes("dark")).forEach(z=>document.body.classList.remove(z));const k=()=>{const z=document.querySelector(`.${Qs.loginForm}`);z&&(z.style.setProperty("--theme-background","#ffffff","important"),z.style.setProperty("--theme-text","#333333","important"),z.style.setProperty("--theme-surface","#ffffff","important"),z.querySelectorAll("input").forEach(L=>{L.style.backgroundColor="white",L.style.color="#333",L.style.setProperty("background-color","white","important"),L.style.setProperty("color","#333","important"),L.style.setProperty("-webkit-text-fill-color","#333","important")}))};k();const B=new MutationObserver(()=>{k()}),E=document.querySelector(`.${Qs.loginForm}`);return E&&B.observe(E,{attributes:!0,attributeFilter:["style","class"],childList:!0,subtree:!0}),()=>{B.disconnect(),C.style.setProperty("--theme-background",b.background),C.style.setProperty("--theme-text",b.text),C.style.setProperty("--theme-surface",b.surface),C.style.setProperty("--theme-mode",b.mode)}},[]),H.useEffect(()=>{if(t&&!i){console.log("✅ 로그인된 상태 감지, 홈페이지로 이동합니다.");const C=setTimeout(()=>{e("/")},1e3);return()=>clearTimeout(C)}},[t,i,e]);const x=async C=>{C.preventDefault(),f(!0),g(null);try{let b;u?b=await F1(r,o,l):b=await B1(r,o),b.error?g(b.error):b.user&&(console.log("✅ 인증 성공:",b.user.email),n==null||n())}catch(b){g("예상치 못한 오류가 발생했습니다."),console.error("인증 에러:",b)}finally{f(!1)}},S=async()=>{f(!0),g(null);try{const C=await E1();C.error?g(C.error):C.user&&(console.log("✅ 구글 로그인 성공:",C.user.email),n==null||n())}catch(C){g("구글 로그인 중 오류가 발생했습니다."),console.error("구글 로그인 에러:",C)}finally{f(!1)}},I=()=>{console.log("🎨 데모 모드로 에디터 접속"),e("/configurator")},j=()=>{console.log("카카오 로그인 (데모)"),I()};return c.jsx("div",{className:Qs.loginForm,children:c.jsxs("div",{className:Qs.container,children:[c.jsx("div",{className:Qs.logoSection,children:c.jsxs("div",{className:Qs.logo,children:[c.jsx("span",{className:Qs.logoIcon,children:"✨"}),c.jsx("span",{className:Qs.logoText,children:"MOHEIM"})]})}),c.jsx("h2",{className:Qs.title,children:"Welcome Back"}),c.jsx("p",{style:{textAlign:"center",color:"#666",fontSize:"14px",marginTop:"-20px",marginBottom:"30px"},children:"로그인하여 계속 진행하세요"}),c.jsxs("form",{onSubmit:x,className:Qs.form,children:[c.jsxs("div",{className:Qs.inputGroup,children:[c.jsx("label",{className:Qs.label,children:"이메일 주소"}),c.jsx("input",{type:"email",placeholder:"your@email.com",value:r,onChange:C=>s(C.target.value),required:!0,className:Qs.input,style:{background:"white",color:"#333"}})]}),c.jsxs("div",{className:Qs.inputGroup,children:[c.jsx("label",{className:Qs.label,children:"비밀번호"}),c.jsxs("div",{className:Qs.passwordWrapper,children:[c.jsx("input",{type:m?"text":"password",placeholder:"비밀번호 입력",value:o,onChange:C=>a(C.target.value),required:!0,className:Qs.input,style:{background:"white",color:"#333"}}),c.jsx("button",{type:"button",className:Qs.passwordToggle,onClick:()=>y(!m),"aria-label":m?"비밀번호 숨기기":"비밀번호 보기",children:m?c.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[c.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),c.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):c.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[c.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),c.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})]})]}),c.jsxs("div",{className:Qs.optionsRow,children:[c.jsxs("label",{className:Qs.checkboxLabel,children:[c.jsx("input",{type:"checkbox",checked:v,onChange:C=>w(C.target.checked),className:Qs.checkbox}),c.jsx("span",{className:Qs.checkboxText,children:"로그인 유지"})]}),c.jsx("button",{type:"button",className:Qs.forgotPassword,children:"비밀번호 찾기 >"})]}),p&&c.jsx("div",{className:Qs.error,children:p}),c.jsx(X6,{type:"submit",disabled:A,className:Qs.loginButton,children:A?"처리 중...":"로그인"})]}),c.jsx("div",{className:Qs.divider,children:c.jsx("span",{children:"또는"})}),c.jsxs("div",{className:Qs.snsSection,children:[c.jsx("p",{className:Qs.snsTitle,children:"SNS 계정으로 3초만에 가입하기"}),c.jsxs("div",{className:Qs.snsButtons,children:[c.jsx("button",{type:"button",className:Qs.snsButton,onClick:j,style:{backgroundColor:"#fee500"},"aria-label":"카카오로 로그인",children:c.jsx("span",{className:Qs.snsIcon,style:{color:"#3c1e1e"},children:"K"})}),c.jsx("button",{type:"button",className:Qs.snsButton,onClick:S,style:{backgroundColor:"#fff",border:"1px solid #dadce0"},"aria-label":"구글로 로그인",children:c.jsxs("svg",{className:Qs.snsIcon,width:"20",height:"20",viewBox:"0 0 24 24",children:[c.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),c.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),c.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),c.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})})]})]}),c.jsx(X6,{onClick:I,className:Qs.demoButton,children:"데모 체험하기"}),c.jsxs("p",{style:{textAlign:"center",marginTop:"20px",color:"#666",fontSize:"14px"},children:["처음이신가요? "," ",c.jsx("a",{href:"#",style:{color:"#667eea",textDecoration:"none",fontWeight:"500"},onClick:C=>{C.preventDefault(),d(!0)},children:"회원가입"})]})]})})},uHe=()=>{const n=ph(),{user:e}=Vc(),[t,i]=H.useState(""),[r,s]=H.useState(""),[o,a]=H.useState(""),[l,h]=H.useState(!1),[u,d]=H.useState(!1),[A,f]=H.useState(null),[p,g]=H.useState(!1),v=async m=>{m.preventDefault(),d(!0),f(null);try{const y=l?await F1(t,r,o):await B1(t,r);y.error?f(y.error):y.user&&n("/")}catch{f("예상치 못한 오류가 발생했습니다.")}finally{d(!1)}},w=async()=>{d(!0),f(null);try{const m=await E1();m.error?f(m.error):m.user&&n("/")}catch{f("구글 로그인 중 오류가 발생했습니다.")}finally{d(!1)}};return c.jsxs("div",{className:"min-h-screen relative flex items-center justify-center overflow-hidden bg-gradient-to-br from-purple-50 via-pink-50 to-blue-50",children:[c.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[c.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-purple-300 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob"}),c.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-pink-300 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-2000"}),c.jsx("div",{className:"absolute top-40 left-40 w-80 h-80 bg-blue-300 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-4000"})]}),c.jsx(fr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"relative z-10 w-full max-w-md p-8 mx-4",children:c.jsxs("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl p-8 border border-white/20",children:[c.jsx(fr.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"flex justify-center mb-8",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-600 to-pink-600 rounded-xl flex items-center justify-center shadow-lg",children:c.jsx(ow,{className:"w-6 h-6 text-white"})}),c.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"MOHEIM"})]})}),c.jsxs(fr.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"text-center mb-8",children:[c.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:l?"계정 만들기":"다시 만나서 반가워요"}),c.jsx("p",{className:"text-gray-600",children:l?"새로운 여정을 시작해보세요":"계속해서 멋진 공간을 만들어보세요"})]}),c.jsxs("form",{onSubmit:v,className:"space-y-6",children:[c.jsx(Gw,{mode:"wait",children:l&&c.jsx(fr.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"relative",children:c.jsx("input",{type:"text",placeholder:"이름",value:o,onChange:m=>a(m.target.value),className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",required:!0})})}),c.jsxs("div",{className:"relative",children:[c.jsx(KV,{className:"absolute left-4 top-3.5 w-5 h-5 text-gray-400"}),c.jsx("input",{type:"email",placeholder:"이메일 주소",value:t,onChange:m=>i(m.target.value),className:"w-full pl-12 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",required:!0})]}),c.jsxs("div",{className:"relative",children:[c.jsx(YV,{className:"absolute left-4 top-3.5 w-5 h-5 text-gray-400"}),c.jsx("input",{type:p?"text":"password",placeholder:"비밀번호",value:r,onChange:m=>s(m.target.value),className:"w-full pl-12 pr-12 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",required:!0}),c.jsx("button",{type:"button",onClick:()=>g(!p),className:"absolute right-4 top-3.5 text-gray-400 hover:text-gray-600 transition-colors",children:p?c.jsx(t8,{className:"w-5 h-5"}):c.jsx(n8,{className:"w-5 h-5"})})]}),c.jsxs("div",{className:"flex items-center justify-between text-sm",children:[c.jsxs("label",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",className:"mr-2 rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),c.jsx("span",{className:"text-gray-600",children:"로그인 상태 유지"})]}),c.jsx("a",{href:"#",className:"text-purple-600 hover:text-purple-700 font-medium",children:"비밀번호 찾기"})]}),c.jsx(Gw,{children:A&&c.jsx(fr.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"p-3 bg-red-50 border border-red-200 rounded-xl text-red-600 text-sm",children:A})}),c.jsx(fr.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:u,className:"w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-3 rounded-xl font-medium shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:u?c.jsx(i8,{className:"w-5 h-5 animate-spin"}):c.jsxs(c.Fragment,{children:[l?c.jsx(txe,{className:"w-5 h-5"}):c.jsx(XV,{className:"w-5 h-5"}),c.jsx("span",{children:l?"가입하기":"로그인"})]})})]}),c.jsxs("div",{className:"relative my-8",children:[c.jsx("div",{className:"absolute inset-0 flex items-center",children:c.jsx("div",{className:"w-full border-t border-gray-200"})}),c.jsx("div",{className:"relative flex justify-center text-sm",children:c.jsx("span",{className:"px-4 bg-white text-gray-500",children:"또는"})})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs(fr.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:w,className:"w-full flex items-center justify-center space-x-3 py-3 border border-gray-200 rounded-xl hover:bg-gray-50 transition-all",children:[c.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[c.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),c.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),c.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),c.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),c.jsx("span",{className:"text-gray-700 font-medium",children:"Google로 계속하기"})]}),c.jsxs(fr.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>n("/configurator"),className:"w-full flex items-center justify-center space-x-3 py-3 border-2 border-purple-200 rounded-xl hover:bg-purple-50 transition-all group",children:[c.jsx(ow,{className:"w-5 h-5 text-purple-600"}),c.jsx("span",{className:"text-purple-600 font-medium",children:"데모 체험하기"}),c.jsx(e8,{className:"w-4 h-4 text-purple-600 group-hover:translate-x-1 transition-transform"})]})]}),c.jsx("div",{className:"mt-8 text-center",children:c.jsxs("p",{className:"text-gray-600",children:[l?"이미 계정이 있으신가요?":"처음 오셨나요?"," ",c.jsx("button",{onClick:()=>h(!l),className:"text-purple-600 hover:text-purple-700 font-medium",children:l?"로그인":"가입하기"})]})})]})}),c.jsx("style",{jsx:!0,children:`
        @keyframes blob {
          0% { transform: translate(0px, 0px) scale(1); }
          33% { transform: translate(30px, -50px) scale(1.1); }
          66% { transform: translate(-20px, 20px) scale(0.9); }
          100% { transform: translate(0px, 0px) scale(1); }
        }
        .animate-blob {
          animation: blob 7s infinite;
        }
        .animation-delay-2000 {
          animation-delay: 2s;
        }
        .animation-delay-4000 {
          animation-delay: 4s;
        }
      `})]})},dHe=({index:n})=>{const e=Math.random()*100,t=Math.random()*100,i=Math.random()*5,r=15+Math.random()*20;return c.jsx(fr.div,{className:"absolute w-1 h-1 bg-gradient-to-br from-purple-400 to-pink-400 rounded-full opacity-40",style:{left:`${e}%`,top:`${t}%`},animate:{y:[-20,-window.innerHeight-20],opacity:[0,1,1,0],scale:[0,1.5,1.5,0]},transition:{duration:r,delay:i,repeat:1/0,ease:"linear"}})},XT=({type:n,delay:e})=>{const t={circle:"rounded-full",hexagon:"clip-path-hexagon",triangle:"clip-path-triangle"};return c.jsx(fr.div,{className:`absolute w-24 h-24 bg-gradient-to-br from-purple-400/10 to-pink-400/10 backdrop-blur-xl ${t[n]}`,initial:{opacity:0,scale:0},animate:{opacity:[.3,.6,.3],scale:[1,1.2,1],rotate:[0,180,360],x:[0,50,0],y:[0,-30,0]},transition:{duration:20,delay:e,repeat:1/0,ease:"easeInOut"},style:{left:`${Math.random()*80}%`,top:`${Math.random()*80}%`}})},AHe=()=>{const n=ph(),{user:e}=Vc(),[t,i]=H.useState(""),[r,s]=H.useState(""),[o,a]=H.useState(""),[l,h]=H.useState(!1),[u,d]=H.useState(!1),[A,f]=H.useState(null),[p,g]=H.useState(!1),[v,w]=H.useState(null),[m,y]=H.useState({x:0,y:0}),x=G_(0),S=G_(0),I={damping:25,stiffness:200},j=lR(x,I),C=lR(S,I),b=Iy(C,[-.5,.5],["17.5deg","-17.5deg"]),D=Iy(j,[-.5,.5],["-17.5deg","17.5deg"]),T=Iy(j,[-.5,.5],["0%","100%"]),k=Iy(C,[-.5,.5],["0%","100%"]);H.useEffect(()=>{const te=L=>{const{clientX:O,clientY:J}=L,{innerWidth:$,innerHeight:U}=window,Y=O/$-.5,K=J/U-.5;x.set(Y),S.set(K),y({x:O,y:J})};return window.addEventListener("mousemove",te),()=>window.removeEventListener("mousemove",te)},[x,S]);const B=async te=>{te.preventDefault(),d(!0),f(null);try{const L=l?await F1(t,r,o):await B1(t,r);L.error?f(L.error):L.user&&n("/")}catch{f("예상치 못한 오류가 발생했습니다.")}finally{d(!1)}},E=async()=>{d(!0),f(null);try{const te=await E1();te.error?f(te.error):te.user&&n("/")}catch{f("구글 로그인 중 오류가 발생했습니다.")}finally{d(!1)}},z=[{icon:c.jsx(sxe,{className:"w-5 h-5"}),text:"초고속 3D 렌더링",color:"from-yellow-400 to-orange-400"},{icon:c.jsx(eG,{className:"w-5 h-5"}),text:"안전한 데이터 보호",color:"from-blue-400 to-cyan-400"},{icon:c.jsx(Ywe,{className:"w-5 h-5"}),text:"프리미엄 디자인 템플릿",color:"from-purple-400 to-pink-400"},{icon:c.jsx(qwe,{className:"w-5 h-5"}),text:"AI 기반 추천 시스템",color:"from-green-400 to-emerald-400"}];return c.jsxs("div",{className:"min-h-screen flex relative overflow-hidden bg-black",children:[c.jsx(fr.div,{className:"absolute inset-0 opacity-50",style:{background:`radial-gradient(circle at ${T}% ${k}%, rgba(168, 85, 247, 0.4) 0%, transparent 50%)`}}),c.jsx("div",{className:"absolute inset-0 overflow-hidden",children:[...Array(50)].map((te,L)=>c.jsx(dHe,{index:L},L))}),c.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[c.jsx(XT,{type:"circle",delay:0}),c.jsx(XT,{type:"hexagon",delay:2}),c.jsx(XT,{type:"triangle",delay:4})]}),c.jsx("div",{className:"flex-1 flex items-center justify-center p-8 relative z-10",children:c.jsxs(fr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},style:{rotateX:b,rotateY:D,transformStyle:"preserve-3d"},className:"relative w-full max-w-md",children:[c.jsx(fr.div,{className:"absolute inset-0 bg-gradient-to-br from-purple-600/20 to-pink-600/20 rounded-3xl blur-xl",animate:{scale:[1,1.1,1],opacity:[.5,.8,.5]},transition:{duration:4,repeat:1/0,ease:"easeInOut"}}),c.jsxs("div",{className:"relative bg-gray-900/40 backdrop-blur-xl rounded-3xl p-8 border border-gray-800/50 shadow-2xl",children:[c.jsxs(fr.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.1,type:"spring",stiffness:200},className:"text-center mb-8",children:[c.jsxs("div",{className:"inline-flex items-center space-x-3 mb-6",children:[c.jsxs(fr.div,{className:"relative",whileHover:{scale:1.1,rotate:360},transition:{duration:.5},children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-500 rounded-2xl flex items-center justify-center shadow-2xl",children:c.jsx(ow,{className:"w-8 h-8 text-white"})}),c.jsx(fr.div,{className:"absolute -top-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-gray-900",animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0}})]}),c.jsx("span",{className:"text-4xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent",children:"MOHEIM"})]}),c.jsx(fr.h1,{className:"text-3xl font-bold text-white mb-2",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:l?"미래를 디자인하세요":"다시 만나서 반가워요"}),c.jsx(fr.p,{className:"text-gray-400",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:l?"AI와 함께하는 인테리어 혁명":"당신만의 공간이 기다리고 있습니다"})]}),c.jsxs("form",{onSubmit:B,className:"space-y-5",children:[c.jsx(Gw,{mode:"wait",children:l&&c.jsx(fr.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:c.jsxs("div",{className:"relative group",children:[c.jsx(Ave,{className:`absolute left-5 top-1/2 transform -translate-y-1/2 w-5 h-5 transition-all duration-300 ${v==="name"?"text-purple-400":"text-gray-500"}`}),c.jsx("input",{type:"text",placeholder:"이름",value:o,onChange:te=>a(te.target.value),onFocus:()=>w("name"),onBlur:()=>w(null),className:"w-full pl-14 pr-5 py-4 bg-gray-800/50 backdrop-blur-sm border border-gray-700 rounded-2xl focus:outline-none focus:border-purple-500 transition-all duration-300 text-white placeholder-gray-500",required:!0}),c.jsx(fr.div,{className:"absolute inset-0 rounded-2xl bg-gradient-to-r from-purple-500/20 to-pink-500/20 opacity-0 group-hover:opacity-100 pointer-events-none",transition:{duration:.3}})]})})}),c.jsxs("div",{className:"relative group",children:[c.jsx(KV,{className:`absolute left-5 top-1/2 transform -translate-y-1/2 w-5 h-5 transition-all duration-300 ${v==="email"||t?"text-purple-400":"text-gray-500"}`}),c.jsx("input",{type:"email",placeholder:" ",value:t,onChange:te=>i(te.target.value),onFocus:()=>w("email"),onBlur:()=>w(null),className:"peer w-full pl-14 pr-5 py-4 bg-gray-800/50 backdrop-blur-sm border border-gray-700 rounded-2xl focus:outline-none focus:border-purple-500 transition-all duration-300 text-white placeholder-transparent",required:!0}),c.jsx("label",{className:"absolute left-14 top-4 text-gray-500 transition-all duration-300 peer-placeholder-shown:top-4 peer-focus:top-1 peer-focus:text-xs peer-focus:text-purple-400 peer-[:not(:placeholder-shown)]:top-1 peer-[:not(:placeholder-shown)]:text-xs pointer-events-none",children:"이메일 주소"}),c.jsx(fr.div,{className:"absolute inset-0 rounded-2xl bg-gradient-to-r from-purple-500/20 to-pink-500/20 opacity-0 group-hover:opacity-100 pointer-events-none",transition:{duration:.3}})]}),c.jsxs("div",{className:"relative group",children:[c.jsx(YV,{className:`absolute left-5 top-1/2 transform -translate-y-1/2 w-5 h-5 transition-all duration-300 ${v==="password"||r?"text-purple-400":"text-gray-500"}`}),c.jsx("input",{type:p?"text":"password",placeholder:" ",value:r,onChange:te=>s(te.target.value),onFocus:()=>w("password"),onBlur:()=>w(null),className:"peer w-full pl-14 pr-14 py-4 bg-gray-800/50 backdrop-blur-sm border border-gray-700 rounded-2xl focus:outline-none focus:border-purple-500 transition-all duration-300 text-white placeholder-transparent",required:!0}),c.jsx("label",{className:"absolute left-14 top-4 text-gray-500 transition-all duration-300 peer-placeholder-shown:top-4 peer-focus:top-1 peer-focus:text-xs peer-focus:text-purple-400 peer-[:not(:placeholder-shown)]:top-1 peer-[:not(:placeholder-shown)]:text-xs pointer-events-none",children:"비밀번호"}),c.jsx(fr.button,{type:"button",onClick:()=>g(!p),className:"absolute right-5 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-purple-400 transition-colors duration-300",whileHover:{scale:1.1},whileTap:{scale:.9},children:p?c.jsx(t8,{className:"w-5 h-5"}):c.jsx(n8,{className:"w-5 h-5"})}),c.jsx(fr.div,{className:"absolute inset-0 rounded-2xl bg-gradient-to-r from-purple-500/20 to-pink-500/20 opacity-0 group-hover:opacity-100 pointer-events-none",transition:{duration:.3}}),r&&c.jsx(fr.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"absolute -bottom-6 left-0 right-0 flex space-x-1",children:[...Array(4)].map((te,L)=>c.jsx("div",{className:`h-1 flex-1 rounded-full transition-all duration-300 ${L<(r.length>12?4:r.length>8?3:r.length>5?2:1)?"bg-gradient-to-r from-purple-500 to-pink-500":"bg-gray-700"}`},L))})]}),c.jsxs("div",{className:"flex items-center justify-between text-sm pt-2",children:[c.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer group",children:[c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"checkbox",className:"sr-only peer"}),c.jsx("div",{className:"w-5 h-5 bg-gray-800 border border-gray-600 rounded-md peer-checked:bg-gradient-to-br peer-checked:from-purple-500 peer-checked:to-pink-500 peer-checked:border-transparent transition-all duration-300",children:c.jsx("svg",{className:"w-3 h-3 text-white absolute top-1 left-1 opacity-0 peer-checked:opacity-100 transition-opacity",fill:"currentColor",viewBox:"0 0 20 20",children:c.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 111.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),c.jsx("span",{className:"text-gray-400 group-hover:text-gray-300 transition-colors select-none",children:"로그인 상태 유지"})]}),c.jsx(fr.a,{href:"#",className:"text-purple-400 hover:text-pink-400 font-medium transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},children:"비밀번호 찾기"})]}),c.jsx(Gw,{children:A&&c.jsxs(fr.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},className:"p-4 bg-red-500/10 backdrop-blur-sm border border-red-500/50 rounded-xl text-red-400 text-sm flex items-center space-x-2",children:[c.jsx("div",{className:"w-5 h-5 bg-red-500/20 rounded-full flex items-center justify-center flex-shrink-0",children:c.jsx("span",{className:"text-red-400 font-bold",children:"!"})}),c.jsx("span",{children:A})]})}),c.jsxs(fr.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:u,className:"relative w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white py-4 rounded-2xl font-semibold text-lg shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed overflow-hidden group",children:[c.jsx(fr.div,{className:"absolute inset-0 bg-gradient-to-r from-pink-500 to-purple-500",animate:{x:["0%","100%","0%"]},transition:{duration:3,repeat:1/0,ease:"linear"},style:{width:"200%"}}),c.jsx("div",{className:"relative flex items-center justify-center space-x-2",children:u?c.jsx(fr.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:c.jsx(i8,{className:"w-5 h-5"})}):c.jsxs(c.Fragment,{children:[l?c.jsx(Uve,{className:"w-5 h-5"}):c.jsx(XV,{className:"w-5 h-5"}),c.jsx("span",{children:l?"시작하기":"로그인"})]})}),c.jsx(fr.div,{className:"absolute inset-0 bg-white/20 rounded-2xl",initial:{scale:0,opacity:1},whileHover:{scale:2,opacity:0},transition:{duration:.5}})]})]}),c.jsxs("div",{className:"relative my-8",children:[c.jsx(fr.div,{className:"absolute inset-0 flex items-center",initial:{scaleX:0},animate:{scaleX:1},transition:{delay:.5,duration:.5},children:c.jsx("div",{className:"w-full border-t border-gray-700"})}),c.jsx("div",{className:"relative flex justify-center text-sm",children:c.jsx("span",{className:"px-4 bg-gray-900/40 backdrop-blur-sm text-gray-500",children:"또는"})})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs(fr.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:E,className:"w-full flex items-center justify-center space-x-3 py-4 bg-white/10 backdrop-blur-sm border border-gray-700 rounded-2xl hover:bg-white/20 hover:border-gray-600 transition-all duration-300 group",children:[c.jsx(fr.div,{whileHover:{rotate:360},transition:{duration:.5},children:c.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[c.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),c.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),c.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),c.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}),c.jsx("span",{className:"text-gray-300 font-medium group-hover:text-white transition-colors",children:"Google로 계속하기"})]}),c.jsxs(fr.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>n("/configurator"),className:"w-full flex items-center justify-center space-x-3 py-4 bg-gradient-to-r from-purple-500/20 to-pink-500/20 backdrop-blur-sm border border-purple-500/50 rounded-2xl hover:from-purple-500/30 hover:to-pink-500/30 transition-all duration-300 group",children:[c.jsx(fr.div,{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl flex items-center justify-center shadow-lg",whileHover:{rotate:[0,-10,10,-10,0]},transition:{duration:.5},children:c.jsx(ow,{className:"w-5 h-5 text-white"})}),c.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-400 font-semibold",children:"데모 체험하기"}),c.jsx(e8,{className:"w-4 h-4 text-purple-400 group-hover:translate-x-1 transition-transform"})]})]}),c.jsx(fr.div,{className:"mt-8 text-center",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},children:c.jsxs("p",{className:"text-gray-400",children:[l?"이미 계정이 있으신가요?":"처음 오셨나요?"," ",c.jsx(fr.button,{onClick:()=>h(!l),className:"text-purple-400 hover:text-pink-400 font-semibold transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},children:l?"로그인":"가입하기"})]})})]})]})}),c.jsxs("div",{className:"hidden lg:flex flex-1 bg-gradient-to-br from-purple-900/50 to-pink-900/50 backdrop-blur-sm items-center justify-center p-12 relative overflow-hidden",children:[c.jsx("div",{className:"absolute inset-0 opacity-20",children:c.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"linear-gradient(rgba(168, 85, 247, 0.3) 1px, transparent 1px), linear-gradient(90deg, rgba(168, 85, 247, 0.3) 1px, transparent 1px)",backgroundSize:"50px 50px",transform:`translate(${m.x*.05}px, ${m.y*.05}px)`}})}),c.jsx(fr.div,{className:"absolute top-20 right-20",animate:{rotateY:[0,360],rotateZ:[0,10,0,-10,0]},transition:{rotateY:{duration:20,repeat:1/0,ease:"linear"},rotateZ:{duration:5,repeat:1/0,ease:"easeInOut"}},style:{transformStyle:"preserve-3d"},children:c.jsx("div",{className:"w-32 h-32 bg-gradient-to-br from-purple-500/30 to-pink-500/30 backdrop-blur-md rounded-2xl flex items-center justify-center",children:c.jsx(ow,{className:"w-16 h-16 text-white/50"})})}),c.jsxs(fr.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.3,duration:.5},className:"relative z-10 max-w-lg",children:[c.jsxs(fr.h2,{className:"text-5xl font-bold text-white mb-6",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4},children:["AI가 만드는",c.jsx("br",{}),c.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-400",children:"완벽한 공간"})]}),c.jsxs(fr.p,{className:"text-xl text-gray-300 mb-12",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.5},children:["최첨단 3D 기술과 인공지능이 결합된",c.jsx("br",{}),"차세대 인테리어 디자인 플랫폼"]}),c.jsx("div",{className:"space-y-6",children:z.map((te,L)=>c.jsxs(fr.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.6+L*.1},whileHover:{x:10,scale:1.05},className:"flex items-center space-x-4 cursor-pointer",children:[c.jsx(fr.div,{className:`w-14 h-14 bg-gradient-to-br ${te.color} rounded-xl flex items-center justify-center shadow-lg`,whileHover:{rotate:360},transition:{duration:.5},children:c.jsx("div",{className:"text-white",children:te.icon})}),c.jsxs("div",{children:[c.jsx("span",{className:"text-white text-lg font-medium",children:te.text}),c.jsx(fr.div,{className:"h-0.5 bg-gradient-to-r from-purple-400 to-pink-400 mt-1",initial:{width:0},whileHover:{width:"100%"},transition:{duration:.3}})]})]},L))}),c.jsx(fr.div,{className:"mt-12 grid grid-cols-3 gap-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1},children:[{value:"10K+",label:"활성 사용자"},{value:"50K+",label:"디자인 완성"},{value:"99%",label:"만족도"}].map((te,L)=>c.jsxs(fr.div,{className:"text-center",whileHover:{scale:1.1},children:[c.jsx(fr.div,{className:"text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-400",initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:1.2+L*.1,type:"spring"},children:te.value}),c.jsx("div",{className:"text-sm text-gray-400 mt-1",children:te.label})]},L))})]}),c.jsx(fr.div,{className:"absolute bottom-20 left-20",animate:{y:[0,-30,0],rotate:[0,180,360]},transition:{duration:10,repeat:1/0,ease:"easeInOut"},children:c.jsx(qve,{className:"w-8 h-8 text-purple-400/50"})})]}),c.jsx("style",{jsx:!0,children:`
        .clip-path-hexagon {
          clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
        }
        .clip-path-triangle {
          clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
        }
      `})]})},fHe=()=>{const n=ph(),{user:e}=Vc(),[t,i]=H.useState(""),[r,s]=H.useState(""),[o,a]=H.useState(""),[l,h]=H.useState(!1),[u,d]=H.useState(!1),[A,f]=H.useState(null),p=async v=>{v.preventDefault(),d(!0),f(null);try{const w=l?await F1(t,r,o):await B1(t,r);w.error?f(w.error):w.user&&n("/")}catch{f("예상치 못한 오류가 발생했습니다.")}finally{d(!1)}},g=async()=>{d(!0),f(null);try{const v=await E1();v.error?f(v.error):v.user&&n("/")}catch{f("구글 로그인 중 오류가 발생했습니다.")}finally{d(!1)}};return c.jsxs("div",{className:"min-h-screen flex",children:[c.jsx("div",{className:"hidden lg:flex flex-1 bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-500 items-center justify-center p-12 text-white",children:c.jsxs("div",{className:"max-w-lg",children:[c.jsxs("div",{className:"flex items-center mb-12",children:[c.jsxs("svg",{className:"w-10 h-10 mr-3",viewBox:"0 0 24 24",fill:"none",children:[c.jsx("path",{d:"M12 2L2 7V12C2 16.5 4.23 20.68 7.62 23.15L12 26L16.38 23.15C19.77 20.68 22 16.5 22 12V7L12 2Z",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),c.jsx("path",{d:"M12 7V12L15 15",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),c.jsx("span",{className:"text-2xl font-bold",children:"MOHEIM"})]}),c.jsx("h1",{className:"text-5xl font-bold mb-6",children:"안녕하세요!"}),c.jsx("h2",{className:"text-3xl font-medium mb-8 text-white/90",children:"혁신적인 가구 디자인 시스템에 오신 것을 환영합니다!"}),c.jsx("p",{className:"text-lg text-white/80 leading-relaxed",children:"MOHEIM은 3D 기술과 AI를 활용하여 당신의 공간을 완벽하게 구현할 수 있는 모든 도구와 기능을 제공합니다. 지금 시작하세요!"})]})}),c.jsx("div",{className:"flex-1 flex items-center justify-center p-8 bg-gray-50",children:c.jsx(fr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full max-w-md",children:c.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl p-10",children:[c.jsx("h2",{className:"text-3xl font-bold text-center text-gray-900 mb-2",children:"돌아오신 것을 환영합니다"}),c.jsx("p",{className:"text-center text-gray-600 mb-8",children:"30일 무료 체험을 시작해보세요."}),c.jsxs("form",{onSubmit:p,className:"space-y-5",children:[l&&c.jsx("div",{children:c.jsx("input",{type:"text",placeholder:"이름",value:o,onChange:v=>a(v.target.value),className:"w-full px-5 py-4 bg-gray-50 border border-gray-200 rounded-2xl focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",required:!0})}),c.jsx("div",{children:c.jsx("input",{type:"email",placeholder:"이메일",value:t,onChange:v=>i(v.target.value),className:"w-full px-5 py-4 bg-gray-50 border border-gray-200 rounded-2xl focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",required:!0})}),c.jsx("div",{children:c.jsx("input",{type:"password",placeholder:"비밀번호",value:r,onChange:v=>s(v.target.value),className:"w-full px-5 py-4 bg-gray-50 border border-gray-200 rounded-2xl focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",required:!0})}),!l&&c.jsx("div",{className:"text-right",children:c.jsx("a",{href:"#",className:"text-purple-600 text-sm hover:text-purple-700 transition-colors",children:"비밀번호를 잊으셨나요?"})}),A&&c.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-xl text-red-600 text-sm",children:A}),c.jsx("button",{type:"submit",disabled:u,className:"w-full py-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-2xl font-semibold text-lg hover:from-purple-700 hover:to-pink-700 transition-all transform hover:scale-[1.02] disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:u?c.jsx(i8,{className:"w-5 h-5 animate-spin"}):l?"가입하기":"로그인"})]}),c.jsxs("div",{className:"relative my-8",children:[c.jsx("div",{className:"absolute inset-0 flex items-center",children:c.jsx("div",{className:"w-full border-t border-gray-200"})}),c.jsx("div",{className:"relative flex justify-center text-sm",children:c.jsx("span",{className:"px-4 bg-white text-gray-400",children:"또는"})})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("button",{onClick:g,className:"w-full flex items-center justify-center space-x-3 py-4 bg-white border border-gray-200 rounded-2xl hover:bg-gray-50 transition-colors",children:[c.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[c.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),c.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),c.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),c.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),c.jsx("span",{className:"text-gray-700 font-medium",children:"Google"})]}),c.jsxs("button",{onClick:()=>n("/configurator"),className:"w-full flex items-center justify-center space-x-3 py-4 bg-white border border-gray-200 rounded-2xl hover:bg-gray-50 transition-colors",children:[c.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{d:"M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55 0-1 .45-1 1v2h3l-.5 3H13v6.95c5.05-.5 9-4.76 9-9.95z"})}),c.jsx("span",{className:"text-gray-700 font-medium",children:"데모 체험하기"})]})]}),c.jsxs("p",{className:"text-center mt-8 text-gray-600",children:["계정이 없으신가요?"," ",c.jsx("button",{onClick:()=>h(!l),className:"text-purple-600 font-semibold hover:text-purple-700 transition-colors",children:l?"로그인":"가입하기"})]})]})})}),c.jsx("div",{className:"lg:hidden fixed inset-0 bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-500 -z-10"})]})};function Hb({position:n,color:e,scale:t=1}){const i=H.useRef(null),{mouse:r}=fh();return J_(s=>{if(!i.current)return;const o=r.x*s.viewport.width/2,a=r.y*s.viewport.height/2;i.current.position.x=n[0]+o*.1,i.current.position.y=n[1]+a*.1,i.current.rotation.x+=.01,i.current.rotation.y+=.01}),c.jsx(Rq,{speed:2,rotationIntensity:.5,floatIntensity:.5,floatingRange:[-.1,.1],children:c.jsxs("mesh",{ref:i,position:n,scale:t,children:[c.jsx("icosahedronGeometry",{args:[1,4]}),c.jsx(Uq,{color:e,speed:5,distort:.3,radius:1,opacity:.8,transparent:!0})]})})}function pHe(){const n=H.useRef(null),e=100,t=ci.useMemo(()=>{const i=new Float32Array(e*3);for(let r=0;r<e;r++)i[r*3]=(Math.random()-.5)*10,i[r*3+1]=(Math.random()-.5)*10,i[r*3+2]=(Math.random()-.5)*10;return i},[]);return J_(i=>{n.current&&(n.current.rotation.x=i.clock.elapsedTime*.05,n.current.rotation.y=i.clock.elapsedTime*.05)}),c.jsxs("points",{ref:n,children:[c.jsx("bufferGeometry",{children:c.jsx("bufferAttribute",{attach:"attributes-position",count:e,array:t,itemSize:3})}),c.jsx("pointsMaterial",{size:.05,color:"#ffffff",opacity:.6,transparent:!0,sizeAttenuation:!0})]})}function gHe(){return c.jsxs(c.Fragment,{children:[c.jsx("ambientLight",{intensity:.5}),c.jsx("pointLight",{position:[10,10,10],intensity:1}),c.jsx("pointLight",{position:[-10,-10,-10],intensity:.5,color:"#764ba2"}),c.jsx(Hb,{position:[-2,2,0],color:"#764ba2",scale:1.5}),c.jsx(Hb,{position:[3,-1,-2],color:"#667eea",scale:1}),c.jsx(Hb,{position:[-3,-2,1],color:"#8b5cf6",scale:.8}),c.jsx(Hb,{position:[2,1,-1],color:"#a78bfa",scale:1.2}),c.jsx(pHe,{}),c.jsx("fog",{attach:"fog",args:["#6B5EFF",5,15]})]})}const mHe=()=>c.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:0},children:c.jsx(XU,{camera:{position:[0,0,5],fov:75},style:{background:"transparent"},children:c.jsx(gHe,{})})}),yHe="_container_91gbt_1",wHe="_leftPanel_91gbt_11",vHe="_leftContent_91gbt_57",xHe="_logo_91gbt_65",bHe="_welcomeTitle_91gbt_80",CHe="_welcomeSubtitle_91gbt_88",_He="_rightPanel_91gbt_105",SHe="_formContainer_91gbt_114",THe="_formTitle_91gbt_124",BHe="_formSubtitle_91gbt_132",EHe="_form_91gbt_114",FHe="_input_91gbt_152",kHe="_forgotPasswordWrapper_91gbt_174",IHe="_forgotPassword_91gbt_174",DHe="_error_91gbt_192",jHe="_loginButton_91gbt_203",PHe="_divider_91gbt_233",NHe="_socialButtons_91gbt_262",LHe="_socialButton_91gbt_262",MHe="_socialIcon_91gbt_297",RHe="_googleButton_91gbt_302",UHe="_signupPrompt_91gbt_308",OHe="_signupLink_91gbt_314",HHe="_demoSection_91gbt_326",WHe="_demoButton_91gbt_330",oo={container:yHe,leftPanel:wHe,leftContent:vHe,logo:xHe,welcomeTitle:bHe,welcomeSubtitle:CHe,rightPanel:_He,formContainer:SHe,formTitle:THe,formSubtitle:BHe,form:EHe,input:FHe,forgotPasswordWrapper:kHe,forgotPassword:IHe,error:DHe,loginButton:jHe,divider:PHe,socialButtons:NHe,socialButton:LHe,socialIcon:MHe,googleButton:RHe,signupPrompt:UHe,signupLink:OHe,demoSection:HHe,demoButton:WHe},dR=({onSuccess:n})=>{const e=ph(),{user:t,loading:i}=Vc(),[r,s]=H.useState(""),[o,a]=H.useState(""),[l,h]=H.useState(""),[u,d]=H.useState(!1),[A,f]=H.useState(!1),[p,g]=H.useState(null),[v,w]=H.useState(!1),[m,y]=H.useState(""),[x,S]=H.useState(!1);console.log("🔍 SplitLoginForm 상태:",{user:t==null?void 0:t.email,authLoading:i,path:window.location.pathname}),H.useEffect(()=>{console.log("🔍 로그인 상태:",{user:t==null?void 0:t.email,authLoading:i})},[t,i]),H.useEffect(()=>{(async()=>{const T=await wz();T.user?(console.log("✅ Google 리다이렉트 로그인 성공"),e("/dashboard")):T.error&&g(T.error)})()},[e]);const I=async D=>{D.preventDefault(),f(!0),g(null);try{let T;u?T=await F1(r,o,l):T=await B1(r,o),T.error?g(T.error):T.user&&(console.log("✅ 인증 성공:",T.user.email),n==null||n(),e("/dashboard"))}catch(T){g("예상치 못한 오류가 발생했습니다."),console.error("인증 에러:",T)}finally{f(!1)}},j=()=>!0,C=async()=>{f(!0),g(null),console.log("🔍 구글 로그인 시도..."),console.log("🔍 Firebase 설정 상태:",j());try{console.log("🔍 signInWithGoogle 호출...");const D=await E1();D.error?(console.error("❌ 구글 로그인 실패:",D.error),g(D.error)):D.user&&(console.log("✅ 구글 로그인 성공:",D.user.email),e("/dashboard"))}catch(D){console.error("❌ 구글 로그인 예외 발생:",D),g("구글 로그인 중 오류가 발생했습니다. 잠시 후 다시 시도해주세요.")}finally{f(!1)}},b=()=>{console.log("Facebook 로그인 (데모)"),e("/configurator")};return c.jsxs("div",{className:oo.container,children:[c.jsx(mHe,{}),c.jsx("div",{className:oo.leftPanel,children:c.jsxs("div",{className:oo.leftContent,children:[c.jsx("div",{className:oo.logo,children:c.jsx(eS,{size:"large"})}),c.jsx("h1",{className:oo.welcomeTitle,children:"Hey, Hello!"}),c.jsx("p",{className:oo.welcomeSubtitle,children:"Join The Waitlist For The Design System!"})]})}),c.jsx("div",{className:oo.rightPanel,children:c.jsxs("div",{className:oo.formContainer,children:[c.jsx("h2",{className:oo.formTitle,children:"Welcome Back"}),c.jsx("p",{className:oo.formSubtitle,children:"Let's get started with your 30 days free trial."}),c.jsxs("form",{onSubmit:I,className:oo.form,children:[u&&c.jsx(zy,{type:"text",placeholder:"Name",value:l,onChange:D=>h(D.target.value),required:!0,className:oo.input}),c.jsx(zy,{type:"email",placeholder:"Username",value:r,onChange:D=>s(D.target.value),required:!0,className:oo.input}),c.jsx(zy,{type:"password",placeholder:"Password",value:o,onChange:D=>a(D.target.value),required:!0,className:oo.input}),!u&&c.jsx("div",{className:oo.forgotPasswordWrapper,children:c.jsx("a",{href:"#",className:oo.forgotPassword,children:"Forgot Password?"})}),p&&c.jsx("div",{className:oo.error,children:p}),c.jsx(X6,{type:"submit",disabled:A,className:oo.loginButton,children:A?"Processing...":"Login"})]}),c.jsx("div",{className:oo.divider,children:c.jsx("span",{children:"OR"})}),c.jsxs("div",{className:oo.socialButtons,children:[c.jsxs("button",{type:"button",className:`${oo.socialButton} ${oo.googleButton}`,onClick:C,disabled:A,children:[c.jsxs("svg",{className:oo.socialIcon,viewBox:"0 0 24 24",children:[c.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),c.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),c.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),c.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),c.jsx("span",{children:"Google"})]}),c.jsxs("button",{type:"button",className:`${oo.socialButton} ${oo.facebookButton}`,onClick:b,disabled:A,children:[c.jsx("svg",{className:oo.socialIcon,viewBox:"0 0 24 24",children:c.jsx("path",{fill:"#1877F2",d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),c.jsx("span",{children:"Facebook"})]})]}),c.jsxs("div",{className:oo.demoSection,children:[c.jsx("div",{className:oo.divider,children:c.jsx("span",{children:"또는"})}),c.jsx("button",{type:"button",className:oo.demoButton,onClick:()=>e("/configurator"),children:"데모체험하기"})]}),c.jsxs("p",{className:oo.signupPrompt,children:[u?"이미 계정이 있으신가요?":"Don't have an account?"," ",c.jsx("a",{href:"#",className:oo.signupLink,onClick:D=>{D.preventDefault(),d(!u),g(null)},children:u?"Login":"Sign Up"})]})]})})]})},zHe=()=>{const[n,e]=H.useState([]),[t,i]=H.useState(!1),[r,s]=H.useState(null),[o,a]=H.useState(null),l=async()=>{i(!0),s(null);try{const d=await Wr();if(!d){s("사용자가 로그인되지 않았습니다.");return}const A=ru(jl(rr,"projects"),xl("userId","==",d.uid)),f=await kd(A),p=[];f.forEach(v=>{const w=v.data();p.push({id:v.id,title:w.title||"Unknown",data:w})}),e(p);const g=p.find(v=>v.title.includes("위시티자이"));g&&a(g)}catch(d){console.error("Firebase 데이터 조회 실패:",d),s("데이터를 불러오는 중 오류가 발생했습니다.")}finally{i(!1)}};H.useEffect(()=>{l()},[]);const h=(d,A,f="")=>{const p=[];return Object.keys(A).forEach(g=>{const v=f?`${f}.${g}`:g,w=d&&d.hasOwnProperty(g),m=w?typeof d[g]:"undefined",y=typeof A[g];p.push({path:v,status:w?"✅ 존재":"❌ 없음",type:m,expected:y}),w&&typeof d[g]=="object"&&d[g]!==null&&typeof A[g]=="object"&&!Array.isArray(A[g])&&p.push(...h(d[g],A[g],v))}),p},u={id:"string",userId:"string",basicInfo:{title:"string",location:"string",createdAt:"object",updatedAt:"object",version:"string",description:"string",customerInfo:{name:"string",phone:"string",email:"string"}},spaceConfig:{dimensions:{width:"number",height:"number",depth:"number"},installType:"string",wallPosition:"string",damper:{agentPosition:"string",size:{width:"number",height:"number"}},floorFinish:{enabled:"boolean",height:"number"}},customLayout:{wall:{type:"string",completed:"boolean"},rack:{thickness:"string",completed:"boolean"},motor:{topHeight:"number",completed:"boolean"},ventilation:{type:"string",completed:"boolean"},exhaust:{height:"number",completed:"boolean",fromFloor:"boolean"}},metadata:{status:"string",priority:"string",tags:"object",isFavorite:"boolean"},stats:{designFileCount:"number",furnitureCount:"number",completionRate:"number"}};return c.jsxs("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"white",zIndex:9999,overflow:"auto",padding:"20px",fontFamily:"monospace"},children:[c.jsx("h1",{children:"🔍 Firebase 데이터 구조 분석"}),c.jsx("button",{onClick:l,disabled:t,children:t?"로딩 중...":"프로젝트 새로고침"}),r&&c.jsxs("div",{style:{color:"red",margin:"10px 0"},children:["❌ ",r]}),c.jsxs("div",{style:{margin:"20px 0"},children:[c.jsxs("h2",{children:["📋 프로젝트 목록 (",n.length,"개)"]}),n.map(d=>c.jsxs("div",{style:{padding:"10px",border:(o==null?void 0:o.id)===d.id?"2px solid blue":"1px solid #ccc",margin:"5px 0",cursor:"pointer"},onClick:()=>a(d),children:[c.jsx("strong",{children:d.title})," (ID: ",d.id,")"]},d.id))]}),o&&c.jsxs("div",{children:[c.jsxs("h2",{children:["🎯 선택된 프로젝트: ",o.title]}),c.jsx("h3",{children:"📄 실제 데이터 구조"}),c.jsx("pre",{style:{background:"#f5f5f5",padding:"10px",overflow:"auto",maxHeight:"300px",fontSize:"12px"},children:JSON.stringify(o.data,null,2)}),c.jsx("h3",{children:"🔍 구조 분석 (새 스키마 vs 실제 데이터)"}),c.jsx("div",{style:{background:"#f9f9f9",padding:"10px"},children:h(o.data,u).map((d,A)=>c.jsxs("div",{style:{padding:"5px 0",borderBottom:"1px solid #eee",fontSize:"14px"},children:[c.jsxs("strong",{children:[d.path,":"]})," ",d.status,c.jsxs("span",{style:{color:"#666",marginLeft:"10px"},children:["실제: ",d.type," | 예상: ",d.expected]})]},A))}),c.jsx("h3",{children:"📊 현재 사용 중인 구조 (기존 스키마)"}),c.jsxs("div",{style:{background:"#fff3cd",padding:"10px"},children:[c.jsx("p",{children:c.jsx("strong",{children:"현재 데이터 필드들:"})}),c.jsx("ul",{children:Object.keys(o.data).map(d=>c.jsxs("li",{children:[c.jsxs("strong",{children:[d,":"]})," ",typeof o.data[d],o.data[d]&&typeof o.data[d]=="object"&&c.jsxs("span",{children:[" (keys: ",Object.keys(o.data[d]).join(", "),")"]})]},d))})]})]}),c.jsxs("div",{style:{marginTop:"20px",padding:"10px",background:"#e7f3ff"},children:[c.jsx("h3",{children:"📝 분석 요약"}),c.jsx("p",{children:"이 디버그 도구는 현재 Firebase에 저장된 실제 데이터 구조와 새로운 TypeScript 인터페이스를 비교합니다."}),c.jsx("p",{children:"빨간색(❌)으로 표시된 필드들은 새 스키마에서 정의되었지만 실제 데이터에는 없는 필드들입니다."})]})]})},QHe="_container_wopq3_3",$He="_projectSelector_wopq3_18",VHe="_projectList_wopq3_33",GHe="_projectButton_wopq3_39",XHe="_selected_wopq3_55",YHe="_projectInfo_wopq3_60",KHe="_projectStats_wopq3_76",qHe="_missingCount_wopq3_81",ZHe="_unexpectedCount_wopq3_90",JHe="_selectedProject_wopq3_99",eWe="_analysisContainer_wopq3_113",tWe="_analysisSection_wopq3_120",nWe="_missingFields_wopq3_131",iWe="_unexpectedFields_wopq3_131",rWe="_noIssues_wopq3_157",sWe="_tabContainer_wopq3_166",oWe="_tabHeader_wopq3_170",aWe="_comparisonContainer_wopq3_186",lWe="_comparisonSection_wopq3_193",cWe="_actualData_wopq3_204",hWe="_expectedData_wopq3_204",uWe="_recommendations_wopq3_223",jo={container:QHe,projectSelector:$He,projectList:VHe,projectButton:GHe,selected:XHe,projectInfo:YHe,projectStats:KHe,missingCount:qHe,unexpectedCount:ZHe,selectedProject:JHe,analysisContainer:eWe,analysisSection:tWe,missingFields:nWe,unexpectedFields:iWe,noIssues:rWe,tabContainer:sWe,tabHeader:oWe,comparisonContainer:aWe,comparisonSection:lWe,actualData:cWe,expectedData:hWe,recommendations:uWe},dWe=()=>{const{user:n}=Vc(),[e,t]=H.useState([]),[i,r]=H.useState(!0),[s,o]=H.useState(null);H.useEffect(()=>{n&&a()},[n]);const a=async()=>{try{r(!0);const f=ru(jl(rr,"projects"),xl("userId","==",n.uid)),p=await kd(f),g=[];for(const w of p.docs){const m=w.data();console.log(`🔍 [Debug] 프로젝트 ${w.id} 원본 데이터:`,m);const y=l(m);g.push({projectId:w.id,title:m.title||"제목 없음",actualData:m,expectedStructure:u(),missingFields:y.missing,unexpectedFields:y.unexpected})}t(g);const v=g.find(w=>w.title.includes("위시티자이")||w.title.includes("위시"));v&&o(v)}catch(f){console.error("프로젝트 데이터 로드 실패:",f)}finally{r(!1)}},l=f=>{const p=u(),g=[],v=[];return h(p,f,"",g),h(f,p,"",v),{missing:g,unexpected:v}},h=(f,p,g,v,w)=>{for(const m in f){const y=g?`${g}.${m}`:m;m in p?typeof f[m]=="object"&&f[m]!==null&&!Array.isArray(f[m])&&h(f[m],p[m]||{},y,v):v.push(y)}},u=()=>({id:"string",userId:"string",basicInfo:{title:"string",location:"string",description:"string (optional)",version:"string",createdAt:"Timestamp",updatedAt:"Timestamp",customerInfo:{name:"string (optional)",phone:"string (optional)",email:"string (optional)"}},spaceConfig:{dimensions:{width:"number",height:"number",depth:"number"},installType:"'builtin' | 'standalone' | 'freestanding'",wallPosition:"'left' | 'right' (for standalone)",damper:{agentPosition:"'none' | 'left' | 'right' | 'both'",size:{width:"number",height:"number"}},floorFinish:{enabled:"boolean",height:"number"}},customLayout:{wall:{type:"'nowall' | 'wall'",completed:"boolean"},rack:{thickness:"'2mm' | '3mm'",completed:"boolean",options:{isComposite:"boolean"}},motor:{topHeight:"number",completed:"boolean"},ventilation:{type:"'no' | 'dry'",completed:"boolean"},exhaust:{height:"number",completed:"boolean",fromFloor:"boolean"}},metadata:{status:"'draft' | 'in_progress' | 'completed' | 'archived'",priority:"'low' | 'medium' | 'high' | 'urgent'",tags:"string[]",isFavorite:"boolean"},stats:{designFileCount:"number",furnitureCount:"number",completionRate:"number",lastOpenedAt:"Timestamp"},thumbnailUrl:"string (optional)"}),d=f=>c.jsxs("div",{className:jo.comparisonContainer,children:[c.jsxs("div",{className:jo.comparisonSection,children:[c.jsx("h3",{children:"🔍 실제 저장된 데이터"}),c.jsx("pre",{className:jo.actualData,children:JSON.stringify(f.actualData,null,2)})]}),c.jsxs("div",{className:jo.comparisonSection,children:[c.jsx("h3",{children:"📋 예상 데이터 구조"}),c.jsx("pre",{className:jo.expectedData,children:JSON.stringify(f.expectedStructure,null,2)})]})]}),A=f=>c.jsxs("div",{className:jo.analysisContainer,children:[c.jsxs("div",{className:jo.analysisSection,children:[c.jsx("h4",{children:"❌ 누락된 필드들"}),f.missingFields.length>0?c.jsx("ul",{className:jo.missingFields,children:f.missingFields.map(p=>c.jsx("li",{children:p},p))}):c.jsx("p",{className:jo.noIssues,children:"누락된 필드가 없습니다!"})]}),c.jsxs("div",{className:jo.analysisSection,children:[c.jsx("h4",{children:"⚠️ 예상치 못한 필드들"}),f.unexpectedFields.length>0?c.jsx("ul",{className:jo.unexpectedFields,children:f.unexpectedFields.map(p=>c.jsx("li",{children:p},p))}):c.jsx("p",{className:jo.noIssues,children:"예상치 못한 필드가 없습니다!"})]})]});return n?i?c.jsx("div",{className:jo.container,children:c.jsx("h1",{children:"🔄 데이터 로딩 중..."})}):c.jsxs("div",{className:jo.container,children:[c.jsx("h1",{children:"🔍 Firebase 프로젝트 데이터 구조 분석"}),c.jsxs("div",{className:jo.projectSelector,children:[c.jsxs("h2",{children:["📁 프로젝트 목록 (",e.length,"개)"]}),c.jsx("div",{className:jo.projectList,children:e.map(f=>c.jsxs("button",{className:`${jo.projectButton} ${(s==null?void 0:s.projectId)===f.projectId?jo.selected:""}`,onClick:()=>o(f),children:[c.jsxs("div",{className:jo.projectInfo,children:[c.jsx("strong",{children:f.title}),c.jsx("small",{children:f.projectId})]}),c.jsxs("div",{className:jo.projectStats,children:[c.jsxs("span",{className:jo.missingCount,children:["누락: ",f.missingFields.length]}),c.jsxs("span",{className:jo.unexpectedCount,children:["추가: ",f.unexpectedFields.length]})]})]},f.projectId))})]}),s&&c.jsxs("div",{className:jo.selectedProject,children:[c.jsxs("h2",{children:["📊 선택된 프로젝트: ",s.title]}),A(s),c.jsx("div",{className:jo.tabContainer,children:c.jsxs("details",{open:!0,children:[c.jsx("summary",{className:jo.tabHeader,children:"📋 데이터 구조 비교"}),d(s)]})}),c.jsxs("div",{className:jo.recommendations,children:[c.jsx("h3",{children:"💡 권장사항"}),c.jsxs("ul",{children:[c.jsxs("li",{children:["새로운 스키마로 마이그레이션하려면 ",c.jsx("code",{children:"projectDataService.ts"}),"를 사용하세요"]}),c.jsx("li",{children:"기존 데이터와의 호환성을 위해 마이그레이션 스크립트를 작성하세요"}),c.jsx("li",{children:"Step1-3 컴포넌트에서 생성한 데이터가 올바른 구조로 저장되는지 확인하세요"})]})]})]})]}):c.jsxs("div",{className:jo.container,children:[c.jsx("h1",{children:"🔐 로그인이 필요합니다"}),c.jsx("p",{children:"Firebase 데이터를 확인하려면 로그인해주세요."})]})},AWe=n=>{const{enableInertia:e=!0,enableHapticFeedback:t=!1,sensitivity:i=1,preventDefault:r=!0}=n,s=H.useRef({startX:0,startY:0,startDistance:0,startAngle:0,lastX:0,lastY:0,touchCount:0,startTime:0,velocity:{x:0,y:0}}),o=H.useRef(0),a=H.useRef(),l=H.useRef(),h=H.useCallback(()=>{t&&"vibrate"in navigator&&navigator.vibrate(10)},[t]),u=v=>{if(v.length<2)return 0;const w=v[0].clientX-v[1].clientX,m=v[0].clientY-v[1].clientY;return Math.sqrt(w*w+m*m)},d=v=>{if(v.length<2)return 0;const w=v[1].clientX-v[0].clientX,m=v[1].clientY-v[0].clientY;return Math.atan2(m,w)*(180/Math.PI)},A=(v,w,m)=>Math.sqrt(v*v+w*w)/m,f=H.useCallback(v=>{r&&v.preventDefault();const w=v.touches;if(s.current.touchCount=w.length,s.current.startTime=Date.now(),w.length===1)s.current.startX=w[0].clientX,s.current.startY=w[0].clientY,s.current.lastX=w[0].clientX,s.current.lastY=w[0].clientY,s.current.velocity={x:0,y:0},n.onLongPress&&(a.current=setTimeout(()=>{var m;h(),(m=n.onLongPress)==null||m.call(n)},500));else if(w.length===2){a.current&&clearTimeout(a.current),s.current.startDistance=u(w);const m=d(w);s.current.startAngle=m}},[n,r,h]),p=H.useCallback(v=>{var m,y,x;r&&v.preventDefault();const w=v.touches;if(a.current&&clearTimeout(a.current),w.length===1&&s.current.touchCount===1){const S=(w[0].clientX-s.current.lastX)*i,I=(w[0].clientY-s.current.lastY)*i,C=Date.now()-s.current.startTime;s.current.velocity={x:S/C,y:I/C},(m=n.onPan)==null||m.call(n,S,I),s.current.lastX=w[0].clientX,s.current.lastY=w[0].clientY}else if(w.length===2){const S=u(w),I=S/s.current.startDistance;(y=n.onPinch)==null||y.call(n,I);const C=d(w)-s.current.startAngle;(x=n.onRotate)==null||x.call(n,C),s.current.startDistance=S}},[n,r,i]),g=H.useCallback(v=>{var m,y,x,S,I,j;r&&v.preventDefault(),a.current&&clearTimeout(a.current);const w=v.changedTouches;if(w.length===1&&s.current.touchCount===1){const C=w[0].clientX-s.current.startX,b=w[0].clientY-s.current.startY,D=Math.sqrt(C*C+b*b),T=Date.now()-s.current.startTime,k=A(C,b,T);if(D<10){const B=Date.now();B-o.current<300?(h(),(m=n.onDoubleTap)==null||m.call(n)):(h(),(y=n.onTap)==null||y.call(n)),o.current=B}else if(D>50){const B=Math.abs(C),E=Math.abs(b);if(B>E){const z=C>0?"right":"left";(x=n.onSwipe)==null||x.call(n,z,k),k>.5&&((S=n.onFlick)==null||S.call(n,z,k))}else{const z=b>0?"down":"up";(I=n.onSwipe)==null||I.call(n,z,k),k>.5&&((j=n.onFlick)==null||j.call(n,z,k))}if(e&&k>.1){const z=Math.min(1e3,k*500),te=Date.now(),L=()=>{var $,U;const J=(Date.now()-te)/z;if(J<1){const Y=1-Math.pow(1-J,3),K=k*(1-Y);B>E?($=n.onPan)==null||$.call(n,K*(C>0?1:-1),0):(U=n.onPan)==null||U.call(n,0,K*(b>0?1:-1)),l.current=requestAnimationFrame(L)}};L()}}}s.current.touchCount=v.touches.length},[n,r,e,h]);H.useEffect(()=>{const v=n.element||document;return v.addEventListener("touchstart",f,{passive:!r}),v.addEventListener("touchmove",p,{passive:!r}),v.addEventListener("touchend",g,{passive:!r}),()=>{v.removeEventListener("touchstart",f),v.removeEventListener("touchmove",p),v.removeEventListener("touchend",g),a.current&&clearTimeout(a.current),l.current&&cancelAnimationFrame(l.current)}},[f,p,g,n.element,r])},fWe=({children:n,onPinch:e,onRotate:t,onPan:i,onSwipe:r,onTap:s,onDoubleTap:o,onLongPress:a,onFlick:l,enableInertia:h=!0,enableHapticFeedback:u=!1,sensitivity:d=1,className:A,style:f})=>{const p=H.useRef(null),[g,v]=H.useState(!1);AWe({element:p.current,onPinch:e,onRotate:t,onPan:(m,y)=>{v(!0),i==null||i(m,y)},onSwipe:r,onTap:()=>{w(),s==null||s()},onDoubleTap:()=>{w(),o==null||o()},onLongPress:()=>{w(),a==null||a()},onFlick:l,enableInertia:h,enableHapticFeedback:u,sensitivity:d,preventDefault:!0});const w=H.useCallback(()=>{u&&"vibrate"in navigator&&navigator.vibrate(10)},[u]);return H.useEffect(()=>{if(g){const m=setTimeout(()=>{v(!1)},100);return()=>clearTimeout(m)}},[g]),c.jsx("div",{ref:p,className:A,style:{...f,touchAction:"none",userSelect:"none",WebkitUserSelect:"none",cursor:g?"grabbing":"grab"},children:n})},pWe="_container_1elqh_1",gWe="_testArea_1elqh_14",mWe="_gestureArea_1elqh_20",yWe="_testTarget_1elqh_33",wWe="_targetContent_1elqh_48",vWe="_infoPanel_1elqh_72",xWe="_currentState_1elqh_79",bWe="_eventLog_1elqh_80",CWe="_logContainer_1elqh_101",_We="_logEntry_1elqh_109",SWe="_noEvents_1elqh_120",TWe="_instructions_1elqh_127",BWe="_instructionGrid_1elqh_140",EWe="_instruction_1elqh_127",nh={container:pWe,testArea:gWe,gestureArea:mWe,testTarget:yWe,targetContent:wWe,infoPanel:vWe,currentState:xWe,eventLog:bWe,logContainer:CWe,logEntry:_We,noEvents:SWe,instructions:TWe,instructionGrid:BWe,instruction:EWe},FWe=()=>{const[n,e]=H.useState([]),[t,i]=H.useState(1),[r,s]=H.useState(0),[o,a]=H.useState({x:0,y:0}),l=(h,u)=>{const A=`${new Date().toLocaleTimeString()}: ${h}${u?` - ${JSON.stringify(u)}`:""}`;e(f=>[A,...f.slice(0,9)])};return c.jsxs("div",{className:nh.container,children:[c.jsx("h1",{children:"터치/터치패드 테스트 페이지"}),c.jsx("div",{className:nh.testArea,children:c.jsx(fWe,{onPinch:h=>{i(h),l("핀치",{scale:h.toFixed(2)})},onRotate:h=>{s(h),l("회전",{angle:h.toFixed(1)})},onPan:(h,u)=>{a(d=>({x:d.x+h,y:d.y+u})),l("팬",{deltaX:h.toFixed(0),deltaY:u.toFixed(0)})},onTap:()=>l("탭"),onDoubleTap:()=>l("더블탭"),onLongPress:()=>l("롱프레스"),onSwipe:(h,u)=>{l("스와이프",{direction:h,velocity:u.toFixed(2)})},onFlick:(h,u)=>{l("플릭",{direction:h,velocity:u.toFixed(2)})},enableHapticFeedback:!0,className:nh.gestureArea,children:c.jsx("div",{className:nh.testTarget,style:{transform:`translate(${o.x}px, ${o.y}px) scale(${t}) rotate(${r}deg)`},children:c.jsxs("div",{className:nh.targetContent,children:[c.jsx("h3",{children:"터치 테스트 영역"}),c.jsx("p",{children:"터치패드로 다양한 제스처를 시도해보세요"}),c.jsxs("ul",{children:[c.jsx("li",{children:"한 손가락 드래그: 이동"}),c.jsx("li",{children:"두 손가락 핀치: 확대/축소"}),c.jsx("li",{children:"두 손가락 회전: 회전"}),c.jsx("li",{children:"탭/더블탭: 선택"}),c.jsx("li",{children:"롱프레스: 컨텍스트 메뉴"})]})]})})})}),c.jsxs("div",{className:nh.infoPanel,children:[c.jsxs("div",{className:nh.currentState,children:[c.jsx("h3",{children:"현재 상태"}),c.jsxs("p",{children:["스케일: ",t.toFixed(2)]}),c.jsxs("p",{children:["회전: ",r.toFixed(1),"°"]}),c.jsxs("p",{children:["위치: (",o.x.toFixed(0),", ",o.y.toFixed(0),")"]})]}),c.jsxs("div",{className:nh.eventLog,children:[c.jsx("h3",{children:"이벤트 로그"}),c.jsxs("div",{className:nh.logContainer,children:[n.map((h,u)=>c.jsx("div",{className:nh.logEntry,children:h},u)),n.length===0&&c.jsx("div",{className:nh.noEvents,children:"아직 이벤트가 없습니다"})]})]})]}),c.jsxs("div",{className:nh.instructions,children:[c.jsx("h3",{children:"테스트 방법"}),c.jsxs("div",{className:nh.instructionGrid,children:[c.jsxs("div",{className:nh.instruction,children:[c.jsx("h4",{children:"터치패드 제스처"}),c.jsxs("ul",{children:[c.jsx("li",{children:"한 손가락 드래그: 마우스 이동"}),c.jsx("li",{children:"두 손가락 스크롤: 수직/수평 스크롤"}),c.jsx("li",{children:"두 손가락 핀치: 확대/축소"}),c.jsx("li",{children:"두 손가락 회전: 회전"})]})]}),c.jsxs("div",{className:nh.instruction,children:[c.jsx("h4",{children:"개발자 도구 시뮬레이션"}),c.jsxs("ol",{children:[c.jsx("li",{children:"F12 또는 Cmd+Option+I로 개발자 도구 열기"}),c.jsx("li",{children:"Device Toolbar 클릭 (📱 아이콘)"}),c.jsx("li",{children:"Responsive 모드 선택"}),c.jsx("li",{children:"More tools → Sensors → Touch 활성화"})]})]})]})]})]})},PK=H.createContext(null);function kWe({children:n}){const[e,t]=H.useState(()=>{const V=localStorage.getItem("cnc_panels"),Q=localStorage.getItem("cnc_user_modified")==="true";if(V&&Q){const X=JSON.parse(V);if(Array.isArray(X)&&X.length>0)return X}return[]}),[i,r]=H.useState(()=>{const V=localStorage.getItem("cnc_stock");return V?JSON.parse(V):[]}),[s,o]=H.useState(()=>localStorage.getItem("cnc_user_modified")==="true"),a=V=>{o(V),localStorage.setItem("cnc_user_modified",V.toString())},l=(V,Q=!1)=>{t(V),localStorage.setItem("cnc_panels",JSON.stringify(V)),Q&&a(!0)},h=V=>{r(V),localStorage.setItem("cnc_stock",JSON.stringify(V))},[u,d]=H.useState(null),[A,f]=H.useState(0),[p,g]=H.useState(()=>{const V=localStorage.getItem("cnc_settings");return V?JSON.parse(V):{unit:"mm",kerf:5,trimTop:5,trimBottom:5,trimLeft:5,trimRight:5,labelsOnPanels:!0,singleSheetOnly:!1,considerMaterial:!0,edgeBanding:!1,considerGrain:!0,alignVerticalCuts:!0,optimizationType:"OPTIMAL_CNC"}}),[v,w]=H.useState([]),[m,y]=H.useState([]),[x,S]=H.useState(),[I,j]=H.useState(),[C,b]=H.useState(),[D,T]=H.useState(!1),[k,B]=H.useState(1),[E,z]=H.useState(0),[te,L]=H.useState({bySheet:{},total:0,unit:"m"}),O=V=>{g(Q=>{const X={...Q,...V};return localStorage.setItem("cnc_settings",JSON.stringify(X)),X})},J=(V,Q)=>{if(d(V||null),S(Q),Q){const X=parseInt(Q)-1;isNaN(X)||f(X)}},$=V=>{j(V)},U=V=>{b(V)},Y=()=>{const V=e.reduce((se,q)=>se+q.width*q.length*q.quantity,0),Q=i.length?i[0].width*i[0].length:0,X=i.reduce((se,q)=>se+q.width*q.length*q.quantity,0);return{partsCount:e.reduce((se,q)=>se+q.quantity,0),partsArea:V,stockArea:X||Q}},K=H.useMemo(()=>({panels:e,stock:i,settings:p,selectedPanelId:u,currentSheetIndex:A,userHasModifiedPanels:s,placements:v,cuts:m,selectedSheetId:x,selectedCutIndex:I,selectedCutId:C,simulating:D,simSpeed:k,simProgress:E,sawStats:te,setPanels:l,setStock:h,setSettings:O,setSelectedPanelId:d,setCurrentSheetIndex:f,setSelectedSheetId:S,setUserHasModifiedPanels:a,setPlacements:w,setCuts:y,selectPanel:J,selectCutIndex:$,selectCutId:U,setSimulating:T,setSimSpeed:B,setSimProgress:z,setSawStats:L,metrics:Y}),[e,i,p,u,A,s,v,m,x,I,C,D,k,E,te]);return c.jsx(PK.Provider,{value:K,children:n})}function E0(){const n=H.useContext(PK);if(!n)throw new Error("useCNCStore must be used within CNCProvider");return n}const IWe=(n,e,t,i=!1)=>{var g,v,w;const r=[];let s=1;const o=((g=n.modelConfig)==null?void 0:g.basicThickness)||18,a=9,l=18,h=15,u=5,d=n.dimensions.height,A=e-o*2,f=d-o*2;let p;if(n.id.includes("dual-4drawer-pantshanger")||n.id.includes("dual-2drawer-styler")?p=((v=n.modelConfig)==null?void 0:v.leftSections)||[]:p=((w=n.modelConfig)==null?void 0:w.sections)||[],p&&p.length>0){const m=d-o*2,y=(b,D)=>(b.heightType||"percentage")==="absolute"?Math.min(b.height||0,D):D*((b.height||b.heightRatio||100)/100),S=p.filter(b=>b.heightType==="absolute").reduce((b,D)=>b+y(D,m),0),j=(p.length>1?p.length-1:0)*o,C=m-S-j;if(p.length>1){const b=n.id.includes("2hanging")?"안전선반":"중간 칸막이";r.push({id:`panel-${s++}`,name:`${n.name} - ${b}`,width:A,height:t-a-17,thickness:o,material:"PB",color:"MW",quantity:1})}p.forEach((b,D)=>{n.id.includes("2hanging")||(n.id.includes("dual-4drawer-pantshanger")||n.id.includes("dual-2drawer-styler")?b.type:b.type==="drawer"||b.type);const T=b.heightType==="absolute"?y(b,m):y(b,C);r.push({id:`panel-${s++}`,name:`${n.name} - 좌측판`,width:t,height:Math.round(T),thickness:o,material:"PB",color:"MW",quantity:1}),r.push({id:`panel-${s++}`,name:`${n.name} - 우측판`,width:t,height:Math.round(T),thickness:o,material:"PB",color:"MW",quantity:1}),D===p.length-1&&r.push({id:`panel-${s++}`,name:`${n.name} - 상판`,width:A,height:t,thickness:o,material:"PB",color:"MW",quantity:1});const k=D===0?0:a+17;if(r.push({id:`panel-${s++}`,name:`${n.name} - 하판`,width:A,height:t-k,thickness:o,material:"PB",color:"MW",quantity:1}),r.push({id:`panel-${s++}`,name:`${n.name} - 뒷판`,width:A+10,height:Math.round(T)+10,thickness:a,material:"MDF",color:"MW",quantity:1}),b.type==="drawer"&&b.count){const B=b.drawerHeights||[];for(let E=0;E<b.count;E++){const z=E+1;let te;B&&B[E]?te=B[E]:te=Math.floor((T-o*(b.count-1))/b.count);const L=e-76,O=te-30,J=t-47-l;r.push({id:`panel-${s++}`,name:`${n.name} - 서랍${z} 손잡이판`,width:e,height:te,thickness:l,material:"PET",color:"MW",quantity:1,grain:"VERTICAL"}),r.push({id:`panel-${s++}`,name:`${n.name} - 서랍${z} 앞판`,width:L,height:O,thickness:h,material:"PB",color:"MW",quantity:1,grain:"VERTICAL"}),r.push({id:`panel-${s++}`,name:`${n.name} - 서랍${z} 뒷판`,width:L,height:O,thickness:h,material:"PB",color:"MW",quantity:1,grain:"VERTICAL"});const $=J-o*2;r.push({id:`panel-${s++}`,name:`${n.name} - 서랍${z} 좌측판`,width:$,height:O,thickness:h,material:"PB",color:"MW",quantity:1,grain:"VERTICAL"}),r.push({id:`panel-${s++}`,name:`${n.name} - 서랍${z} 우측판`,width:$,height:O,thickness:h,material:"PB",color:"MW",quantity:1,grain:"VERTICAL"}),r.push({id:`panel-${s++}`,name:`${n.name} - 서랍${z} 바닥판`,width:L-26,height:J-26,thickness:u,material:"MDF",color:"MW",quantity:1,grain:"VERTICAL"})}for(let E=1;E<b.count;E++)r.push({id:`panel-${s++}`,name:`${n.name} - 서랍 칸막이 ${E}`,width:A,height:t-a-17,thickness:o,material:"PB",color:"MW",quantity:1,grain:"VERTICAL"})}else if(b.type==="hanging")b.shelfPositions&&b.shelfPositions.length>0&&b.shelfPositions.forEach((B,E)=>{r.push({id:`panel-${s++}`,name:`${n.name} - 선반 ${E+1}`,width:A,height:t-8,thickness:o,material:"PB",color:"MW",quantity:1})});else if(b.type==="shelf"&&b.count)for(let B=1;B<=b.count;B++)r.push({id:`panel-${s++}`,name:`${n.name} - 선반 ${B}`,width:A,height:t-8,thickness:o,material:"PB",color:"MW",quantity:1,grain:"VERTICAL"})})}else r.push({id:`panel-${s++}`,name:`${n.name} - 좌측판`,width:t,height:d,thickness:o,material:"PB",color:"MW",quantity:1,grain:"VERTICAL"}),r.push({id:`panel-${s++}`,name:`${n.name} - 우측판`,width:t,height:d,thickness:o,material:"PB",color:"MW",quantity:1,grain:"VERTICAL"}),r.push({id:`panel-${s++}`,name:`${n.name} - 상판`,width:A,height:t,thickness:o,material:"PB",color:"MW",quantity:1,grain:"VERTICAL"}),r.push({id:`panel-${s++}`,name:`${n.name} - 하판`,width:A,height:t,thickness:o,material:"PB",color:"MW",quantity:1,grain:"VERTICAL"}),r.push({id:`panel-${s++}`,name:`${n.name} - 뒷판`,width:A,height:f,thickness:a,material:"MDF",color:"MW",quantity:1,grain:"VERTICAL"});if(i)if(n.id.includes("dual")){const y=Math.floor((e-6)/2);r.push({id:`panel-${s++}`,name:`${n.name} - 좌측 도어`,width:y,height:d-4,thickness:o,material:"PET",color:"MW",quantity:1}),r.push({id:`panel-${s++}`,name:`${n.name} - 우측 도어`,width:y,height:d-4,thickness:o,material:"PET",color:"MW",quantity:1})}else r.push({id:`panel-${s++}`,name:`${n.name} - 도어`,width:e-4,height:d-4,thickness:o,material:"PET",color:"MW",quantity:1});return r};function YT(n,e){switch(e){case"mm":return n;case"cm":return n/10;case"in":return n/25.4;default:return n}}function DWe(n,e){return n>e?{width:e,length:n}:{width:n,length:e}}function jWe(n,e){return e===!1&&!n?"H":n||"NONE"}function PWe(n){return n?n.replace(/[",\n\r]/g," ").replace(/\s+/g," ").trim():""}function NWe(n,e="mm"){const t=n.width||0,i=n.length||n.height||n.depth||0,{width:r,length:s}=DWe(t,i),o=YT(r,e),a=YT(s,e),l=YT(n.thickness||18,e);return{id:n.id,label:PWe(n.label||n.name||`Panel_${n.id}`),width:Math.round(o*10)/10,length:Math.round(a*10)/10,thickness:Math.round(l*10)/10,quantity:n.quantity||1,material:n.material||"PB",grain:jWe(n.grain,n.canRotate),canRotate:n.canRotate!==!1}}function LWe(n,e="mm"){return n.map(t=>NWe(t,e))}function MWe(){const n=pi(l=>l.placedModules),e=hr(l=>l.spaceInfo),[t,i]=H.useState([]),[r,s]=H.useState(!0);H.useEffect(()=>{if(console.log("=== useLivePanelData extracting panels ==="),console.log("placedModules:",n),console.log("placedModules.length:",n.length),console.log("spaceInfo:",e),!Array.isArray(n)){console.error("placedModules is not an array:",typeof n,n);return}(()=>{if(s(!0),!n||n.length===0){console.log("No modules placed, returning empty panels"),i([]),s(!1);return}const h=[],u={width:e.width-36,height:e.height,depth:e.depth};console.log("internalSpace:",u),n.forEach((d,A)=>{const f=d.moduleId||d.moduleType;if(console.log(`Module ${A}: moduleId = ${f}`),!f){console.warn(`Module ${A} has no moduleId`);return}const p=Zi(f,u,e);if(!p){console.warn(`Module ${A}: No module data found for ${f}`);return}console.log(`Module ${A}: Found module data`,p);const g=d.width||p.dimensions.width,v=d.depth||p.dimensions.depth,w=d.hasDoor||!1,m=d.material||"PB",y=d.color||"MW",x=IWe(p,g,v,w);console.log(`Module ${A}: Extracted ${x.length} panels`),x.forEach((S,I)=>{(!S.material||S.material==="PB")&&(S.material=m),S.color=y,S.id=`m${A}_p${I}`}),h.push(...x)}),console.log("Total panels extracted:",h.length),console.log("All panels:",h),i(h),s(!1)})()},[n,e]);const o=H.useMemo(()=>LWe(t,"mm"),[t]),a=H.useMemo(()=>{const l=new Map;return t.forEach(h=>{const u=`${h.material}-${h.color}`,d=l.get(u)||{count:0,area:0},A=h.width*h.height*h.quantity/1e6;l.set(u,{count:d.count+h.quantity,area:d.area+A})}),{totalPanels:t.length,totalQuantity:t.reduce((h,u)=>h+u.quantity,0),totalArea:t.reduce((h,u)=>h+u.width*u.height*u.quantity/1e6,0),materialGroups:Array.from(l.entries()).map(([h,u])=>({key:h,material:h.split("-")[0],color:h.split("-")[1],...u}))}},[t]);return{panels:t,normalizedPanels:o,stats:a,isLoading:r,getPanelsByMaterial:(l,h)=>t.filter(u=>!(l&&u.material!==l||h&&u.color!==h)),getNormalizedPanelsByMaterial:(l,h)=>o.filter(u=>!(l&&u.material!==l||h&&u.color!==h))}}const RWe="_section_1ijfj_1",UWe="_tableContainer_1ijfj_13",OWe="_stockTableContainer_1ijfj_20",HWe="_options_1ijfj_27",WWe="_sectionHeader_1ijfj_35",zWe="_addButton_1ijfj_58",QWe="_table_1ijfj_13",$We="_stockTable_1ijfj_20",VWe="_selected_1ijfj_245",GWe="_newPanel_1ijfj_260",XWe="_input_1ijfj_289",YWe="_inputSmall_1ijfj_317",KWe="_inputTiny_1ijfj_343",qWe="_select_1ijfj_245",ZWe="_dimensions_1ijfj_386",JWe="_deleteButton_1ijfj_395",eze="_grainToggle_1ijfj_515",tze="_empty_1ijfj_542",nze="_optionGroup_1ijfj_578",ize="_inlineNumberInput_1ijfj_613",rze="_inputWrapper_1ijfj_626",sze="_unit_1ijfj_657",oze="_marginGrid_1ijfj_664",aze="_marginRow_1ijfj_674",lze="_numberInputCompact_1ijfj_679",cze="_gapToggleButton_1ijfj_701",hze="_checkboxGrid_1ijfj_734",uze="_checkboxRow_1ijfj_741",dze="_checkboxCompact_1ijfj_746",Aze="_resetLink_1ijfj_845",fze="_link_1ijfj_853",ji={section:RWe,tableContainer:UWe,stockTableContainer:OWe,options:HWe,sectionHeader:WWe,addButton:zWe,table:QWe,stockTable:$We,selected:VWe,newPanel:GWe,input:XWe,inputSmall:YWe,inputTiny:KWe,select:qWe,dimensions:ZWe,deleteButton:JWe,grainToggle:eze,empty:tze,optionGroup:nze,inlineNumberInput:ize,inputWrapper:rze,unit:sze,marginGrid:oze,marginRow:aze,numberInputCompact:lze,gapToggleButton:cze,checkboxGrid:hze,checkboxRow:uze,checkboxCompact:dze,resetLink:Aze,link:fze};function pze(){const{t:n}=ia(),{panels:e,setPanels:t,selectedPanelId:i,setSelectedPanelId:r,setUserHasModifiedPanels:s,settings:o}=E0(),a=H.useRef(null),l=H.useRef(null),h=H.useRef(null),[u,d]=H.useState(null);H.useEffect(()=>{if(i&&l.current&&a.current){const m=a.current,y=l.current,x=y.offsetTop,S=x+y.offsetHeight,I=m.scrollTop,j=I+m.clientHeight;(x<I||S>j)&&y.scrollIntoView({behavior:"smooth",block:"center"})}},[i]),H.useEffect(()=>{u&&setTimeout(()=>{const m=document.querySelector(`tr[data-panel-id="${u}"]`);m&&m.scrollIntoView({behavior:"smooth",block:"center"});const y=document.querySelector(`input[data-panel-id="${u}"][data-field="label"]`);y&&(y.focus(),y.select()),d(null)},100)},[u]),H.useEffect(()=>{const m=a.current;if(!m)return;const y=x=>{if(m.scrollHeight>m.clientHeight){const I=m.scrollTop===0&&x.deltaY<0,j=m.scrollTop+m.clientHeight>=m.scrollHeight-1&&x.deltaY>0;!I&&!j&&(x.preventDefault(),x.stopPropagation());const C=.8;m.scrollTop+=x.deltaY*C}};return m.addEventListener("wheel",y,{passive:!1}),()=>{m.removeEventListener("wheel",y)}},[]);const A=(m,y,x)=>{const S=e.map((I,j)=>j===m?{...I,[y]:y==="quantity"||y==="width"||y==="length"||y==="thickness"?Number(x):x}:I);t(S,!0),s(!0)},f=()=>{const m={id:String(Date.now()),label:"",width:0,length:0,thickness:18,quantity:1,material:"PB",grain:"V"};t([...e,m],!0),s(!0),r(m.id),d(m.id)},p=m=>{const y=e.slice();y.splice(m,1),t(y,!0),s(!0)},g=m=>{r(i===m?null:m)},v=m=>{var S;const y=(S=m.target.files)==null?void 0:S[0];if(!y)return;const x=new FileReader;x.onload=I=>{var C;const j=(C=I.target)==null?void 0:C.result;w(j)},x.readAsText(y),m.target.value=""},w=m=>{var y,x,S;try{const I=m.split(`
`).filter(te=>te.trim()),j=I[0].split(",").map(te=>te.trim().toLowerCase()),C=j.findIndex(te=>te.includes("이름")||te.includes("name")||te.includes("label")||te.includes("품명")),b=j.findIndex(te=>te.includes("가로")||te.includes("width")||te==="w"),D=j.findIndex(te=>te.includes("세로")||te.includes("length")||te.includes("높이")||te==="l"),T=j.findIndex(te=>te.includes("두께")||te.includes("thickness")||te==="t"),k=j.findIndex(te=>te.includes("수량")||te.includes("quantity")||te.includes("qty")),B=j.findIndex(te=>te.includes("재질")||te.includes("material")||te.includes("재료")),E=j.findIndex(te=>te.includes("결")||te.includes("grain")||te.includes("방향")),z=[];for(let te=1;te<I.length;te++){const L=I[te].trim();if(!L)continue;const O=((y=L.match(/(".*?"|[^,]+)/g))==null?void 0:y.map(K=>K.replace(/^"(.*)"$/,"$1").trim()))||[];if(O.length<2)continue;let J=parseFloat(O[b]||"600")||600,$=parseFloat(O[D]||"800")||800;J>$&&([J,$]=[$,J]);const U={id:`csv_${Date.now()}_${te}`,label:O[C]||`Panel_${te}`,width:J,length:$,thickness:parseFloat(O[T]||"18")||18,quantity:parseInt(O[k]||"1")||1,material:((x=O[B])==null?void 0:x.toUpperCase())||"PB",grain:((S=O[E])==null?void 0:S.toUpperCase())==="H"?"H":"V"};["PB","MDF","PET","PLY","HPL","LPM"].includes(U.material)||(U.material="PB"),z.push(U)}z.length>0?e.length===0||confirm(n("cnc.csvReplaceConfirm",{count:e.length}))?(t(z,!0),s(!0),alert(n("cnc.csvImportSuccess",{count:z.length}))):(t([...e,...z],!0),s(!0),alert(n("cnc.csvAddSuccess",{count:z.length}))):alert(n("cnc.csvNoValidData"))}catch{alert(n("cnc.csvReadError"))}};return c.jsxs("div",{className:ji.section,children:[c.jsxs("div",{className:ji.sectionHeader,children:[c.jsx(qV,{size:16}),c.jsxs("h3",{children:[n("cnc.panelList")," (",e.length,")"]}),c.jsxs("div",{style:{display:"flex",gap:"4px"},children:[c.jsxs("button",{className:ji.addButton,onClick:()=>{var m;return(m=h.current)==null?void 0:m.click()},title:"CSV 파일 업로드",children:[c.jsx(s8,{size:14}),"CSV"]}),c.jsxs("button",{className:ji.addButton,onClick:f,children:[c.jsx(JV,{size:14}),n("common.add")]})]}),c.jsx("input",{ref:h,type:"file",accept:".csv",onChange:v,style:{display:"none"}})]}),c.jsx("div",{className:ji.tableContainer,ref:a,children:e.length===0?c.jsx("div",{className:ji.empty,children:n("cnc.noPanelsMessage")}):c.jsxs("table",{className:ji.table,children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{style:{width:"28%",textAlign:"center"},children:n("cnc.name")}),c.jsx("th",{style:{width:"20%",textAlign:"center"},children:n("cnc.dimensions")}),c.jsx("th",{style:{width:"8%",textAlign:"center",paddingLeft:"18px"},children:n("cnc.thickness")}),c.jsx("th",{style:{width:"8%",textAlign:"center",paddingLeft:"20px"},children:n("cnc.quantity")}),c.jsx("th",{style:{width:"21%",textAlign:"center"},children:n("cnc.material")}),c.jsx("th",{style:{width:"8%",textAlign:"center",paddingRight:"3px"},children:n("cnc.grain")}),c.jsx("th",{style:{width:"7%",textAlign:"center"}})]})}),c.jsx("tbody",{children:e.map((m,y)=>{const x=m.label===""&&m.width===0&&m.length===0;return c.jsxs("tr",{ref:i===m.id?l:null,className:`panel-clickable ${i===m.id?ji.selected:""} ${x?ji.newPanel:""}`,onClick:()=>g(m.id),"data-panel-id":m.id,children:[c.jsx("td",{children:c.jsx("input",{value:m.label,onChange:S=>A(y,"label",S.target.value),onClick:S=>S.stopPropagation(),className:ji.input,title:m.label,"data-panel-id":m.id,"data-field":"label",placeholder:n("cnc.panelNamePlaceholder")})}),c.jsx("td",{children:c.jsxs("div",{className:ji.dimensions,children:[c.jsx("input",{type:"number",value:m.length===0?"":m.length,onChange:S=>{const I=Number(S.target.value),j=2440-(o.trimTop||0)-(o.trimBottom||0);I<=j&&A(y,"length",S.target.value)},onClick:S=>S.stopPropagation(),className:ji.inputSmall,placeholder:n("cnc.lengthPlaceholder"),max:2440-(o.trimTop||0)-(o.trimBottom||0),title:`최대 ${2440-(o.trimTop||0)-(o.trimBottom||0)}mm`}),"×",c.jsx("input",{type:"number",value:m.width===0?"":m.width,onChange:S=>{const I=Number(S.target.value),j=1220-(o.trimLeft||0)-(o.trimRight||0);I<=j&&A(y,"width",S.target.value)},onClick:S=>S.stopPropagation(),className:ji.inputSmall,placeholder:n("cnc.widthPlaceholder"),max:1220-(o.trimLeft||0)-(o.trimRight||0),title:`최대 ${1220-(o.trimLeft||0)-(o.trimRight||0)}mm`})]})}),c.jsx("td",{children:c.jsx("input",{type:"number",value:m.thickness,onChange:S=>A(y,"thickness",S.target.value),onClick:S=>S.stopPropagation(),className:ji.inputTiny})}),c.jsx("td",{style:{paddingLeft:"15px"},children:c.jsx("input",{type:"number",value:m.quantity,onChange:S=>A(y,"quantity",S.target.value),onClick:S=>S.stopPropagation(),className:ji.inputTiny})}),c.jsx("td",{style:{paddingLeft:"20px",paddingRight:"2px"},children:c.jsxs("select",{value:m.material,onChange:S=>A(y,"material",S.target.value),onClick:S=>S.stopPropagation(),className:ji.select,children:[c.jsx("option",{value:"PB",children:"PB"}),c.jsx("option",{value:"MDF",children:"MDF"}),c.jsx("option",{value:"PET",children:"PET"}),c.jsx("option",{value:"PLY",children:"PLY"}),c.jsx("option",{value:"HPL",children:"HPL"}),c.jsx("option",{value:"LPM",children:"LPM"})]})}),c.jsx("td",{style:{paddingLeft:"2px"},children:c.jsx("button",{className:ji.grainToggle,onClick:S=>{S.stopPropagation();const I=m.grain==="V"?"H":"V",j=m.width,C=m.length,b=e.map((D,T)=>T===y?{...D,grain:I,width:C,length:j}:D);t(b,!0),s(!0)},title:m.grain==="V"?n("cnc.grainVerticalTooltip"):n("cnc.grainHorizontalTooltip"),children:m.grain==="V"?"↑":"→"})}),c.jsx("td",{style:{padding:"6px 6px 6px 0",textAlign:"center"},children:c.jsx("button",{onClick:S=>{S.stopPropagation(),p(y)},className:ji.deleteButton,children:c.jsx(tG,{size:12})})})]},m.id)})})]})})]})}function gze(n){if(n==null)return"";const e=String(n);return e.includes(",")||e.includes('"')||e.includes(`
`)||e.includes("\r")?`"${e.replace(/"/g,'""')}"`:e}function AR(n){return n.map(gze).join(",")}function NK(n,e){const t=[];return t.push(AR(n)),e.forEach(i=>{t.push(AR(i))}),t.join(`
`)}function LK(n,e){const i=new Blob(["\uFEFF"+n],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(i),s=document.createElement("a");s.href=r,s.download=e,s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s),setTimeout(()=>URL.revokeObjectURL(r),100)}function Fu(n,e="info",t="확인"){return new Promise(i=>{const r=document.querySelector(".popup-overlay");r&&document.body.removeChild(r);const s=document.createElement("div");s.className="popup-overlay",s.style.cssText=`
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.4);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    animation: fadeIn 0.2s ease-out;
  `;const o=document.createElement("div");o.className="popup-notification",o.setAttribute("data-type",e);let a="",l="";switch(e){case"success":a=`<svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="20 6 9 17 4 12"></polyline>
      </svg>`,l="hsl(var(--theme))";break;case"error":a=`<svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>`,l="#ef4444";break;default:a=`<svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="16" x2="12" y2="12"></line>
        <line x1="12" y1="8" x2="12.01" y2="8"></line>
      </svg>`,l="hsl(var(--theme) / 0.8)"}o.style.cssText=`
    background: white;
    padding: 40px;
    border-radius: 20px;
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    font-size: 16px;
    font-weight: 500;
    min-width: 380px;
    max-width: 500px;
    text-align: center;
    animation: scaleIn 0.3s ease-out;
    position: relative;
    border: 1px solid rgba(0, 0, 0, 0.05);
  `,o.innerHTML=`
    <div style="
      width: 64px;
      height: 64px;
      margin: 0 auto 20px;
      background: ${l};
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 14px ${l}40;
    ">
      ${a}
    </div>
    <div style="
      color: #1f2937;
      font-size: 18px;
      font-weight: 600;
      line-height: 1.5;
      margin-bottom: 28px;
    ">${n}</div>
    <button style="
      background: hsl(var(--theme));
      color: white;
      border: none;
      padding: 12px 32px;
      border-radius: 10px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 0 4px 14px hsl(var(--theme) / 0.3);
    " 
    onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px hsl(var(--theme) / 0.4)'" 
    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 14px hsl(var(--theme) / 0.3)'">
      ${t}
    </button>
  `;const h=()=>{s.style.animation="fadeOut 0.2s ease-out",o.style.animation="scaleOut 0.2s ease-out",setTimeout(()=>{document.body.contains(s)&&document.body.removeChild(s),i()},200)};s.onclick=d=>{d.target===s&&h()};const u=o.querySelector("button");if(u&&(u.onclick=h),s.appendChild(o),document.body.appendChild(s),!document.querySelector("#popup-animations")){const d=document.createElement("style");d.id="popup-animations",d.textContent=`
      @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
      }
      @keyframes fadeOut {
        from { opacity: 1; }
        to { opacity: 0; }
      }
      @keyframes scaleIn {
        from { 
          opacity: 0;
          transform: scale(0.8);
        }
        to { 
          opacity: 1;
          transform: scale(1);
        }
      }
      @keyframes scaleOut {
        from { 
          opacity: 1;
          transform: scale(1);
        }
        to { 
          opacity: 0;
          transform: scale(0.8);
        }
      }
    `,document.head.appendChild(d)}e!=="success"&&setTimeout(()=>{document.body.contains(s)&&(s.style.animation="fadeOut 0.2s ease-out",o.style.animation="scaleOut 0.2s ease-out",setTimeout(()=>{document.body.contains(s)&&document.body.removeChild(s),i()},200))},e==="error"?4e3:3e3)})}function mze(){const{t:n}=ia(),{stock:e,setStock:t,settings:i}=E0(),r=H.useRef(null),s=(h,u,d)=>{const A=e.slice();A[h][u]=u==="quantity"||u==="width"||u==="length"||u==="thickness"?Number(d):d,t(A)},o=()=>{const h={label:`Stock_${e.length+1}`,width:1220,length:2440,thickness:18,quantity:10,material:"PB"};t([...e,h])},a=h=>{const u=e.slice();u.splice(h,1),t(u)},l=h=>{var A;const u=(A=h.target.files)==null?void 0:A[0];if(!u)return;const d=new FileReader;d.onload=f=>{var p;try{const v=((p=f.target)==null?void 0:p.result).split(`
`).filter(m=>m.trim());if(v.length<2){Fu(n("cnc.csvNoData"),"error",n("common.confirm"));return}const w=[];for(let m=1;m<v.length;m++){const y=v[m].split(",").map(x=>x.trim());y.length>=5&&w.push({label:y[0]||`Stock_${m}`,length:parseInt(y[1])||2440,width:parseInt(y[2])||1220,thickness:parseInt(y[3])||18,quantity:parseInt(y[4])||10,material:y[5]||"PB"})}w.length>0&&(t([...e,...w]),Fu(n("cnc.stockAddSuccess",{count:w.length}),"success",n("common.confirm")))}catch{Fu(n("cnc.csvReadError"),"error",n("common.confirm"))}},d.readAsText(u),r.current&&(r.current.value="")};return c.jsxs("div",{className:ji.section,children:[c.jsxs("div",{className:ji.sectionHeader,children:[c.jsx(S_,{size:16}),c.jsxs("h3",{children:[n("cnc.stock")," (",e.length,")"]}),c.jsx("input",{ref:r,type:"file",accept:".csv",onChange:l,style:{display:"none"}}),c.jsxs("button",{className:ji.addButton,onClick:()=>{var h;return(h=r.current)==null?void 0:h.click()},children:[c.jsx(s8,{size:14}),"CSV"]}),c.jsxs("button",{className:ji.addButton,onClick:o,children:[c.jsx(JV,{size:14}),n("common.add")]})]}),c.jsx("div",{className:ji.stockTableContainer,children:e.length===0?c.jsx("div",{className:ji.empty,children:n("cnc.noStockMessage")}):c.jsxs("table",{className:`${ji.table} ${ji.stockTable}`,children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{style:{width:"28%",textAlign:"center"},children:n("cnc.name")}),c.jsx("th",{style:{width:"22%",textAlign:"center"},children:n("cnc.dimensions")}),c.jsx("th",{style:{width:"8%",textAlign:"center",paddingLeft:"18px"},children:n("cnc.thickness")}),c.jsx("th",{style:{width:"8%",textAlign:"center",paddingLeft:"20px"},children:n("cnc.quantity")}),c.jsx("th",{style:{width:"21%",textAlign:"center"},children:n("cnc.material")}),c.jsx("th",{style:{width:"7%",textAlign:"center"}})]})}),c.jsx("tbody",{children:e.map((h,u)=>c.jsxs("tr",{children:[c.jsx("td",{children:c.jsx("input",{value:h.label||"",onChange:d=>s(u,"label",d.target.value),className:ji.input,placeholder:n("cnc.stockNamePlaceholder")})}),c.jsx("td",{children:c.jsxs("div",{className:ji.dimensions,children:[c.jsx("input",{type:"number",value:h.length,onChange:d=>{const A=Number(d.target.value),f=2440-(i.trimTop||0)-(i.trimBottom||0);A<=f&&s(u,"length",d.target.value)},className:ji.inputSmall,max:2440-(i.trimTop||0)-(i.trimBottom||0),title:n("cnc.maxValue",{value:2440-(i.trimTop||0)-(i.trimBottom||0)})}),"×",c.jsx("input",{type:"number",value:h.width,onChange:d=>{const A=Number(d.target.value),f=1220-(i.trimLeft||0)-(i.trimRight||0);A<=f&&s(u,"width",d.target.value)},className:ji.inputSmall,max:1220-(i.trimLeft||0)-(i.trimRight||0),title:n("cnc.maxValue",{value:1220-(i.trimLeft||0)-(i.trimRight||0)})})]})}),c.jsx("td",{children:c.jsx("input",{type:"number",value:h.thickness||18,onChange:d=>s(u,"thickness",d.target.value),className:ji.inputTiny,placeholder:"18"})}),c.jsx("td",{style:{paddingLeft:"15px"},children:c.jsx("input",{type:"number",value:h.quantity,onChange:d=>s(u,"quantity",d.target.value),className:ji.inputTiny})}),c.jsx("td",{style:{paddingLeft:"20px",paddingRight:"4px"},children:c.jsxs("select",{value:h.material||"PB",onChange:d=>s(u,"material",d.target.value),className:ji.select,children:[c.jsx("option",{value:"PB",children:"PB"}),c.jsx("option",{value:"MDF",children:"MDF"}),c.jsx("option",{value:"PET",children:"PET"}),c.jsx("option",{value:"PLY",children:"PLY"}),c.jsx("option",{value:"HPL",children:"HPL"}),c.jsx("option",{value:"LPM",children:"LPM"})]})}),c.jsx("td",{style:{padding:"6px 6px 6px 0",textAlign:"center"},children:c.jsx("button",{onClick:()=>a(u),className:ji.deleteButton,children:c.jsx(tG,{size:12})})})]},u))})]})})]})}function yze({onSettingsChange:n}={}){const{t:e}=ia(),{settings:t,setSettings:i}=E0(),[r,s]=H.useState(!1);return c.jsxs("div",{className:ji.section,children:[c.jsxs("div",{className:ji.sectionHeader,children:[c.jsx(J5,{size:16}),c.jsx("h3",{children:e("settings.title")})]}),c.jsxs("div",{className:ji.options,children:[c.jsx("div",{className:ji.optionGroup,children:c.jsxs("label",{className:ji.inlineNumberInput,children:[c.jsx("span",{children:e("cnc.bladeThickness")}),c.jsxs("div",{className:ji.inputWrapper,children:[c.jsx("input",{type:"number",value:t.kerf,onChange:o=>i({kerf:Number(o.target.value)}),onKeyDown:o=>{o.key==="Enter"&&n&&n()},min:"0",max:"10",step:"0.5"}),c.jsx("span",{className:ji.unit,children:"mm"})]})]})}),c.jsxs("button",{className:ji.gapToggleButton,onClick:()=>s(!r),children:[e("cnc.edgeGapSettings"),r?c.jsx(c6,{size:14}):c.jsx(lf,{size:14})]}),r&&c.jsxs("div",{className:ji.marginGrid,children:[c.jsxs("div",{className:ji.marginRow,children:[c.jsxs("label",{className:ji.numberInputCompact,children:[c.jsx("span",{children:e("cnc.top")}),c.jsxs("div",{className:ji.inputWrapper,children:[c.jsx("input",{type:"number",value:t.trimTop??5,onChange:o=>i({trimTop:Number(o.target.value)}),onKeyDown:o=>{o.key==="Enter"&&n&&n()},min:"0",max:"50"}),c.jsx("span",{className:ji.unit,children:"mm"})]})]}),c.jsxs("label",{className:ji.numberInputCompact,children:[c.jsx("span",{children:e("cnc.bottom")}),c.jsxs("div",{className:ji.inputWrapper,children:[c.jsx("input",{type:"number",value:t.trimBottom??5,onChange:o=>i({trimBottom:Number(o.target.value)}),onKeyDown:o=>{o.key==="Enter"&&n&&n()},min:"0",max:"50"}),c.jsx("span",{className:ji.unit,children:"mm"})]})]})]}),c.jsxs("div",{className:ji.marginRow,children:[c.jsxs("label",{className:ji.numberInputCompact,children:[c.jsx("span",{children:e("cnc.left")}),c.jsxs("div",{className:ji.inputWrapper,children:[c.jsx("input",{type:"number",value:t.trimLeft??5,onChange:o=>i({trimLeft:Number(o.target.value)}),onKeyDown:o=>{o.key==="Enter"&&n&&n()},min:"0",max:"50"}),c.jsx("span",{className:ji.unit,children:"mm"})]})]}),c.jsxs("label",{className:ji.numberInputCompact,children:[c.jsx("span",{children:e("cnc.right")}),c.jsxs("div",{className:ji.inputWrapper,children:[c.jsx("input",{type:"number",value:t.trimRight??5,onChange:o=>i({trimRight:Number(o.target.value)}),onKeyDown:o=>{o.key==="Enter"&&n&&n()},min:"0",max:"50"}),c.jsx("span",{className:ji.unit,children:"mm"})]})]})]})]}),c.jsxs("div",{className:ji.checkboxGrid,children:[c.jsxs("div",{className:ji.checkboxRow,children:[c.jsxs("label",{className:ji.checkboxCompact,children:[c.jsx("input",{type:"checkbox",checked:t.considerGrain,onChange:o=>i({considerGrain:o.target.checked})}),c.jsx("span",{children:e("cnc.considerGrain")})]}),c.jsxs("label",{className:ji.checkboxCompact,children:[c.jsx("input",{type:"checkbox",checked:t.considerMaterial,onChange:o=>i({considerMaterial:o.target.checked})}),c.jsx("span",{children:e("cnc.groupByMaterial")})]})]}),c.jsxs("div",{className:ji.checkboxRow,children:[c.jsxs("label",{className:ji.checkboxCompact,children:[c.jsx("input",{type:"checkbox",checked:t.labelsOnPanels,onChange:o=>i({labelsOnPanels:o.target.checked})}),c.jsx("span",{children:e("cnc.showPanelLabels")})]}),c.jsxs("label",{className:ji.checkboxCompact,children:[c.jsx("input",{type:"checkbox",checked:t.edgeBanding,onChange:o=>i({edgeBanding:o.target.checked})}),c.jsx("span",{children:e("cnc.considerEdgeBanding")})]})]}),c.jsxs("div",{className:ji.checkboxRow,children:[c.jsxs("label",{className:ji.checkboxCompact,children:[c.jsx("input",{type:"checkbox",checked:t.singleSheetOnly,onChange:o=>i({singleSheetOnly:o.target.checked})}),c.jsx("span",{children:e("cnc.singleSheetOnly")})]}),c.jsxs("label",{className:ji.checkboxCompact,children:[c.jsx("input",{type:"checkbox",checked:t.alignVerticalCuts!==!1,onChange:o=>i({alignVerticalCuts:o.target.checked})}),c.jsx("span",{children:e("cnc.alignVerticalCuts")})]})]})]}),c.jsx("div",{className:ji.resetLink,children:c.jsx("button",{className:ji.link,onClick:()=>{n&&n()},children:e("common.confirm")})})]})]})}function wze(n,e="project"){if(!n||n.length===0){Fu("No panels to export","error");return}const t=["Label","Qty","Width","Length","Thickness","Material","Grain"],i=n.map(o=>[o.label,o.quantity,o.width,o.length,o.thickness,o.material||"",o.grain==="NONE"?"":o.grain]),r=NK(t,i),s=new Date().toISOString().split("T")[0];LK(r,`${e}_panels_${s}.csv`),Fu(`Exported ${n.length} panels`,"success")}function vze(n,e="project"){if(!n||n.length===0){Fu("No stock sheets to export","error");return}const t=["Label","Qty","Width","Length","Thickness","Material"],i=n.map(o=>[o.label||`${o.material}_Stock`,o.quantity||999,o.width,o.length,o.thickness||18,o.material||""]),r=NK(t,i),s=new Date().toISOString().split("T")[0];LK(r,`${e}_stock_${s}.csv`),Fu(`Exported ${n.length} stock sheets`,"success")}class cp{constructor(e){Br(this,"pdf");Br(this,"pageWidth");Br(this,"pageHeight");Br(this,"margin",20);Br(this,"panelDetails",new Map);Br(this,"furnitureData");this.pdf=new qi({orientation:"landscape",unit:"mm",format:"a3"}),this.pdf.setFont("helvetica"),this.pageWidth=this.pdf.internal.pageSize.getWidth(),this.pageHeight=this.pdf.internal.pageSize.getHeight(),e&&e.forEach(t=>{this.panelDetails.set(t.id,t)})}drawSheet(e,t,i=!0){i&&t>0&&this.pdf.addPage(),this.pdf.setFontSize(16),this.pdf.text(`Cutting Layout - Sheet ${t+1}`,this.margin,this.margin),this.pdf.setFontSize(10),this.pdf.text(`Stock: ${e.stockPanel.width} x ${e.stockPanel.height} mm | Panels: ${e.panels.length} | Efficiency: ${e.efficiency.toFixed(1)}%`,this.margin,this.margin+10);const r=this.pageWidth-this.margin*2,s=this.pageHeight-this.margin*2-20,o=e.stockPanel.height>e.stockPanel.width,a=o?e.stockPanel.height:e.stockPanel.width,l=o?e.stockPanel.width:e.stockPanel.height,h=r/a,u=s/l,d=Math.min(h,u,.2),A=this.margin,f=this.margin+20;this.pdf.setDrawColor(200,200,200),this.pdf.setLineWidth(.5),this.pdf.rect(A,f,a*d,l*d),this.pdf.setDrawColor(100,100,100),this.pdf.setLineWidth(.1);const p=5,g=a*d,v=l*d,w=Math.max(g,v);for(let z=-w;z<w*2;z+=p){const te=A+z,L=f,O=A+z+v,J=f+v,$=Math.max(A,Math.min(A+g,te)),U=te<A?f+(A-te):L,Y=Math.max(A,Math.min(A+g,O)),K=O>A+g?f+v-(O-A-g):J;$<A+g&&Y>A&&this.pdf.line($,U,Y,K)}const m={PB:[232,245,233],MDF:[255,243,224],PLY:[227,242,253],HPL:[243,229,245],LPM:[252,228,236]};e.panels.forEach((z,te)=>{let L,O,J,$;o?(L=A+z.y*d,O=f+(e.stockPanel.width-z.x-z.width)*d,J=z.height*d,$=z.width*d):(L=A+z.x*d,O=f+z.y*d,J=z.width*d,$=z.height*d);const U=m[z.material]||[243,244,246];if(this.pdf.setFillColor(U[0],U[1],U[2]),this.pdf.rect(L,O,J,$,"F"),this.pdf.setDrawColor(100,100,100),this.pdf.setLineWidth(.2),this.pdf.rect(L,O,J,$,"S"),J>15&&$>10){if(this.pdf.setFontSize(6),this.pdf.setTextColor(50,50,50),z.name){const X=/^[\x00-\x7F]*$/.test(z.name)?z.name:`Panel_${z.id}`,W=X.length>20?X.substring(0,17)+"...":X,se=this.pdf.getTextWidth(W);this.pdf.text(W,L+(J-se)/2,O+$/2-2)}this.pdf.setFontSize(7),this.pdf.setTextColor(100,100,100);const Y=`${Math.round(z.width)} × ${Math.round(z.height)}`,K=this.pdf.getTextWidth(Y);this.pdf.text(Y,L+(J-K)/2,O+$/2+(z.name?2:0));const V=Math.round(J/d),Q=Math.round($/d);if(J>10){this.pdf.setFontSize(10),this.pdf.setTextColor(0,0,0);const X=String(V),W=this.pdf.getTextWidth(X);this.pdf.text(X,L+(J-W)/2,O+7)}if($>10){this.pdf.setFontSize(10),this.pdf.setTextColor(0,0,0);const X=String(Q),W=L+7,se=O+$/2;this.pdf.text(X,W,se,{angle:90})}J>25&&(this.pdf.setFontSize(5),this.pdf.setTextColor(150,150,150),this.pdf.text(z.material,L+2,O+$-2))}}),this.pdf.setFontSize(9),this.pdf.setTextColor(100,100,100),this.pdf.text(`${a} mm`,A+a*d/2-10,f-5);const y=`${l} mm`;this.pdf.setFontSize(8),this.pdf.text(y,A-35,f+l*d/2),this.pdf.setFontSize(8),this.pdf.setTextColor(0,0,0);let x=f+l*d+10;const S=e.stockPanel.width*e.stockPanel.height,I=e.panels.reduce((z,te)=>z+te.width*te.height,0),j=S-I;this.pdf.text(`Used Area: ${(I/1e6).toFixed(2)} m² | Waste Area: ${(j/1e6).toFixed(2)} m²`,A,x),x+=10,this.pdf.setFontSize(10),this.pdf.setTextColor(0,0,0),this.pdf.text("Panels in this sheet:",A,x),x+=7,this.pdf.setFontSize(8);const C=new Map;e.panels.forEach(z=>{const te=`${z.name||z.id}_${z.width}_${z.height}_${z.material}`;C.has(te)||C.set(te,{count:0,width:z.width,height:z.height,material:z.material}),C.get(te).count++});const b=x,D=[10,50,20,20,18],T=["Qty","Panel Name","Width","Height","Mat."];this.pdf.setFillColor(240,240,240);const k=D.reduce((z,te)=>z+te,0);this.pdf.rect(A,b-5,k,7,"F"),this.pdf.setFontSize(8),this.pdf.setTextColor(0,0,0);let B=A;T.forEach((z,te)=>{this.pdf.text(z,B+2,b-1),B+=D[te]}),x=b+5;let E=1;Array.from(C.entries()).forEach(([z,te])=>{if(x>this.pageHeight-30)return;const L=z.split("_")[0],O=/^[\x00-\x7F]*$/.test(L)?L:`Panel_${E}`;B=A;const J=[te.count.toString(),O.length>20?O.substring(0,17)+"...":O,Math.round(te.width).toString(),Math.round(te.height).toString(),te.material];E%2===0&&(this.pdf.setFillColor(250,250,250),this.pdf.rect(A,x-3,k,5,"F")),this.pdf.setFontSize(7),this.pdf.setTextColor(0,0,0),J.forEach(($,U)=>{this.pdf.text($,B+2,x),B+=D[U]}),x+=5,E++})}addFurnitureInfoPage(){if(!this.furnitureData)return;this.pdf.addPage(),this.pdf.setFontSize(18),this.pdf.setTextColor(0,0,0),this.pdf.text("Furniture Information",this.margin,this.margin),this.pdf.setFontSize(12);let e=this.margin+15;if(this.pdf.text(`Project: ${this.furnitureData.projectName}`,this.margin,e),e+=8,this.furnitureData.spaceInfo){const r=this.furnitureData.spaceInfo;this.pdf.setFontSize(10),this.pdf.text(`Space: ${r.width} x ${r.height} x ${r.depth} mm`,this.margin,e)}e+=15,this.pdf.setFontSize(14),this.pdf.text("Placed Furniture Modules",this.margin,e),e+=10,this.pdf.setFontSize(10),this.furnitureData.placedModules&&this.furnitureData.placedModules.length>0&&this.furnitureData.placedModules.forEach((r,s)=>{e>this.pageHeight-30&&(this.pdf.addPage(),e=this.margin),this.pdf.setFillColor(250,250,250),this.pdf.rect(this.margin,e-4,200,20,"F"),this.pdf.setTextColor(0,0,0),this.pdf.text(`${s+1}. Module ID: ${r.moduleId}`,this.margin+5,e),e+=5,this.pdf.text(`   Position: X=${r.position.x}, Y=${r.position.y}`,this.margin+5,e),e+=5,r.adjustedWidth&&this.pdf.text(`   Size: ${r.adjustedWidth} mm (adjusted)`,this.margin+5,e),e+=10}),e+=10,e>this.pageHeight-100&&(this.pdf.addPage(),e=this.margin),this.pdf.setFontSize(14),this.pdf.text("3D Furniture View",this.margin,e),e+=10,this.pdf.setFontSize(10),this.pdf.setTextColor(100,100,100),this.pdf.text("Note: For detailed 3D view, please visit the Configurator page",this.margin,e),e+=5,this.pdf.text("The 3D visualization shows the complete furniture arrangement in the space",this.margin,e),e+=10,this.pdf.setDrawColor(200,200,200),this.pdf.setFillColor(245,245,245),this.pdf.rect(this.margin,e,180,100,"FD"),this.pdf.setTextColor(150,150,150),this.pdf.setFontSize(12);const t="View 3D visualization in Configurator",i=this.pdf.getTextWidth(t);this.pdf.text(t,this.margin+(180-i)/2,e+50),this.pdf.setTextColor(0,0,0)}addPanelDetailsPage(e){this.pdf.addPage(),this.pdf.setFontSize(16),this.pdf.setTextColor(0,0,0),this.pdf.text("Panel Details Summary",this.margin,this.margin);const t=new Map;e.forEach((d,A)=>{d.panels.forEach(f=>{const p=`${f.id}_${f.width}_${f.height}`;t.has(p)||t.set(p,{panel:f,totalQty:0,sheets:[]});const g=t.get(p);g.totalQty+=1,g.sheets.includes(A+1)||g.sheets.push(A+1)})});let i=this.margin+15;this.pdf.setFontSize(10),this.pdf.setTextColor(0,0,0);const r=[60,30,30,25,15,30],s=["Panel Name","Width","Height","Material","Qty","Sheet(s)"],o=r.reduce((d,A)=>d+A,0);this.pdf.setFillColor(240,240,240),this.pdf.rect(this.margin,i-5,o,8,"F"),this.pdf.setFontSize(9),this.pdf.setTextColor(0,0,0);let a=this.margin;s.forEach((d,A)=>{this.pdf.text(d,a+2,i),a+=r[A]}),i+=8,this.pdf.setFontSize(8),Array.from(t.values()).sort((d,A)=>d.panel.name.localeCompare(A.panel.name)).forEach((d,A)=>{i>this.pageHeight-30&&(this.pdf.addPage(),i=this.margin,this.pdf.setFillColor(240,240,240),this.pdf.rect(this.margin,i-5,o,8,"F"),this.pdf.setFontSize(9),this.pdf.setTextColor(0,0,0),a=this.margin,s.forEach((g,v)=>{this.pdf.text(g,a+2,i),a+=r[v]}),i+=8,this.pdf.setFontSize(8)),A%2===0&&(this.pdf.setFillColor(250,250,250),this.pdf.rect(this.margin,i-4,o,6,"F")),a=this.margin;const p=[d.panel.name&&/^[\x00-\x7F]*$/.test(d.panel.name)?d.panel.name:`Panel_${d.panel.id}`,Math.round(d.panel.width).toString(),Math.round(d.panel.height).toString(),d.panel.material,d.totalQty.toString(),d.sheets.join(", ")];this.pdf.setFontSize(8),this.pdf.setTextColor(0,0,0),p.forEach((g,v)=>{let w=g;v===0&&g.length>30&&(w=g.substring(0,27)+"..."),this.pdf.text(w,a+2,i),a+=r[v]}),i+=6}),i+=10,i>this.pageHeight-40&&(this.pdf.addPage(),i=this.margin),this.pdf.setFontSize(10),this.pdf.setTextColor(0,0,0),this.pdf.text("Summary",this.margin,i),i+=7,this.pdf.setFontSize(9);const l=Array.from(t.values()).reduce((d,A)=>d+A.totalQty,0),h=e.length,u=e.reduce((d,A)=>d+A.efficiency,0)/e.length;this.pdf.text(`Total Panels: ${l}`,this.margin,i),i+=6,this.pdf.text(`Total Sheets: ${h}`,this.margin,i),i+=6,this.pdf.text(`Average Efficiency: ${u.toFixed(1)}%`,this.margin,i)}drawAllSheetsOnOnePage(e){this.pdf.setFontSize(16),this.pdf.text(`Cutting Layout - Total ${e.length} Sheets`,this.margin,this.margin);const t=Math.ceil(Math.sqrt(e.length)),i=Math.ceil(e.length/t),r=(this.pageWidth-this.margin*2-(t-1)*5)/t,s=(this.pageHeight-this.margin*2-30)/i;e.forEach((l,h)=>{const u=h%t,d=Math.floor(h/t),A=this.margin+u*(r+5),f=this.margin+30+d*(s+5),p=(r-10)/l.stockPanel.width,g=(s-20)/l.stockPanel.height,v=Math.min(p,g,.15);this.pdf.setFontSize(8),this.pdf.setTextColor(0,0,0),this.pdf.text(`Sheet ${h+1}`,A+2,f-2),this.pdf.setFontSize(6),this.pdf.text(`${l.panels.length} panels (${l.efficiency.toFixed(0)}%)`,A+2,f+3);const w=A+5,m=f+8;this.pdf.setDrawColor(200,200,200),this.pdf.setLineWidth(.3),this.pdf.rect(w,m,l.stockPanel.width*v,l.stockPanel.height*v);const y={PB:[232,245,233],PET:[255,248,220],MDF:[255,243,224],PLY:[227,242,253],HPL:[243,229,245],LPM:[252,228,236]};l.panels.forEach(x=>{const S=w+x.x*v,I=m+x.y*v,j=(x.rotated?x.height:x.width)*v,C=(x.rotated?x.width:x.height)*v,b=y[x.material]||[243,244,246];this.pdf.setFillColor(b[0],b[1],b[2]),this.pdf.rect(S,I,j,C,"F"),this.pdf.setDrawColor(150,150,150),this.pdf.setLineWidth(.1),this.pdf.rect(S,I,j,C,"S")}),this.pdf.setFontSize(5),this.pdf.setTextColor(100,100,100),this.pdf.text(`${l.stockPanel.width}x${l.stockPanel.height}`,w+l.stockPanel.width*v/2-8,m+l.stockPanel.height*v+3)});const o=e.reduce((l,h)=>l+h.panels.length,0),a=e.reduce((l,h)=>l+h.efficiency,0)/e.length;this.pdf.setFontSize(9),this.pdf.setTextColor(0,0,0),this.pdf.text(`Total: ${o} panels across ${e.length} sheets | Average efficiency: ${a.toFixed(1)}%`,this.margin,this.pageHeight-10)}addSheets(e){if(console.log(`=== addSheets called with ${e.length} results ===`),!e||e.length===0){console.error("No results provided to addSheets");return}try{this.drawAllSheetsOnOnePage(e),console.log("All sheets drawn on one page")}catch(t){console.error("Error drawing sheets:",t)}if(e.forEach((t,i)=>{console.log(`Adding detailed sheet ${i+1} of ${e.length}`);try{this.pdf.addPage(),this.drawSheet(t,i,!1),console.log(`Detailed sheet ${i+1} added successfully`)}catch(r){console.error(`Error adding detailed sheet ${i+1}:`,r)}}),e.length>0){console.log("Adding panel details page");try{this.addPanelDetailsPage(e),console.log("Panel details page added")}catch(t){console.error("Error adding panel details page:",t)}}console.log(`Total pages in PDF: ${this.pdf.getNumberOfPages()}`)}save(e="cutting_layout.pdf"){this.pdf.save(e)}static exportToPDF(e,t,i){if(console.log("=== PDF Export ==="),console.log("Total sheets to export:",e.length),!e||e.length===0){console.error("No optimization results to export"),alert("최적화 결과가 없습니다.");return}const r=(t==null?void 0:t.panels)||[],s=new cp(Array.isArray(r)?r:[]);s.furnitureData=t,console.log(`Exporting ${e.length} sheets to PDF`),s.addSheets(e),s.save(i)}static createIndividualSheetPDF(e,t,i){const r=new qi({orientation:"landscape",unit:"mm",format:"a3"});r.setFont("helvetica");const s=new cp(i);return s.pdf=r,s.pageWidth=r.internal.pageSize.getWidth(),s.pageHeight=r.internal.pageSize.getHeight(),s.drawSheet(e,t,!1),r}static async exportToZIP(e,t){if(console.log("=== ZIP Export with PDFs ==="),console.log("Total sheets to export:",e.length),!e||e.length===0){console.error("No optimization results to export"),alert("최적화 결과가 없습니다.");return}const i=new VQ,r=new Date().toISOString().slice(0,10);try{console.log("Creating overview PDF with all sheets...");const s=(t==null?void 0:t.panels)||[],o=Array.isArray(s)?s:[],a=new cp(o);a.furnitureData=t,a.addSheets(e);const l=a.pdf.output("blob");i.file(`00_전체_시트_${r}.pdf`,l),console.log("Creating individual sheet PDFs...");for(let f=0;f<e.length;f++)try{const p=e[f],g=f+1;console.log(`Creating PDF for sheet ${g}...`);const w=cp.createIndividualSheetPDF(p,f,o).output("blob"),m=`시트_${String(g).padStart(2,"0")}_${p.stockPanel.material||"PB"}_${p.stockPanel.width}x${p.stockPanel.height}.pdf`;i.file(m,w),console.log(`Added sheet ${g} to ZIP`)}catch(p){console.error(`Error creating sheet ${f+1}:`,p)}if(o&&o.length>0){const f=cp.generatePanelCSV(o);i.file(`패널_목록_${r}.csv`,f)}const h=cp.generateSummary(e,t);i.file(`최적화_요약_${r}.txt`,h),console.log("Generating ZIP file...");const u=await i.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:9}});console.log("ZIP file created, size:",u.size);const d=URL.createObjectURL(u),A=document.createElement("a");A.href=d,A.download=`cutting_layout_${r}.zip`,document.body.appendChild(A),A.click(),document.body.removeChild(A),setTimeout(()=>{URL.revokeObjectURL(d)},100),console.log("ZIP file downloaded successfully")}catch(s){console.error("Error creating ZIP file:",s),s instanceof Error?(console.error("Error message:",s.message),console.error("Error stack:",s.stack),alert(`ZIP 파일 생성 중 오류가 발생했습니다: ${s.message}`)):(console.error("Unknown error:",s),alert("ZIP 파일 생성 중 알 수 없는 오류가 발생했습니다."))}}static generatePanelCSV(e){let t=`ID,이름,가로,세로,두께,재질,수량
`;return e.forEach(i=>{const r=i.label||i.name||`Panel_${i.id}`;t+=`${i.id},"${r}",${i.width},${i.length||i.height},${i.thickness||18},${i.material||"PB"},${i.quantity||1}
`}),t}static generateSummary(e,t){const i=(t==null?void 0:t.projectName)||"Project",r=e.length,s=e.reduce((h,u)=>h+u.panels.length,0),o=e.reduce((h,u)=>h+u.efficiency,0)/e.length,a=e.reduce((h,u)=>h+u.wasteArea,0)/1e6;let l=`========================================
`;return l+=`컷팅 최적화 결과 요약
`,l+=`========================================

`,l+=`프로젝트: ${i}
`,l+=`생성일시: ${new Date().toLocaleString("ko-KR")}

`,l+=`----------------------------------------
`,l+=`전체 통계
`,l+=`----------------------------------------
`,l+=`총 시트 수: ${r}장
`,l+=`총 패널 수: ${s}개
`,l+=`평균 효율: ${o.toFixed(1)}%
`,l+=`총 폐기량: ${a.toFixed(2)} m²

`,l+=`----------------------------------------
`,l+=`시트별 상세
`,l+=`----------------------------------------
`,e.forEach((h,u)=>{l+=`
[시트 ${u+1}]
`,l+=`원자재: ${h.stockPanel.material} ${h.stockPanel.width}x${h.stockPanel.height}mm
`,l+=`패널 수: ${h.panels.length}개
`,l+=`효율: ${h.efficiency.toFixed(1)}%
`,l+=`사용 면적: ${(h.usedArea/1e6).toFixed(2)} m²
`,l+=`폐기 면적: ${(h.wasteArea/1e6).toFixed(2)} m²
`}),l}}class xze{static exportToDXF(e){const t=[];return t.push("0"),t.push("SECTION"),t.push("2"),t.push("HEADER"),t.push("9"),t.push("$ACADVER"),t.push("1"),t.push("AC1009"),t.push("9"),t.push("$INSBASE"),t.push("10"),t.push("0.0"),t.push("20"),t.push("0.0"),t.push("30"),t.push("0.0"),t.push("9"),t.push("$EXTMIN"),t.push("10"),t.push("0.0"),t.push("20"),t.push("0.0"),t.push("30"),t.push("0.0"),t.push("9"),t.push("$EXTMAX"),t.push("10"),t.push("10000.0"),t.push("20"),t.push("5000.0"),t.push("30"),t.push("0.0"),t.push("0"),t.push("ENDSEC"),t.push("0"),t.push("SECTION"),t.push("2"),t.push("TABLES"),t.push("0"),t.push("TABLE"),t.push("2"),t.push("LTYPE"),t.push("70"),t.push("1"),t.push("0"),t.push("LTYPE"),t.push("2"),t.push("CONTINUOUS"),t.push("70"),t.push("64"),t.push("3"),t.push("Solid line"),t.push("72"),t.push("65"),t.push("73"),t.push("0"),t.push("40"),t.push("0.0"),t.push("0"),t.push("ENDTAB"),t.push("0"),t.push("TABLE"),t.push("2"),t.push("LAYER"),t.push("70"),t.push("1"),t.push("0"),t.push("LAYER"),t.push("2"),t.push("0"),t.push("70"),t.push("0"),t.push("62"),t.push("7"),t.push("6"),t.push("CONTINUOUS"),t.push("0"),t.push("ENDTAB"),t.push("0"),t.push("ENDSEC"),t.push("0"),t.push("SECTION"),t.push("2"),t.push("ENTITIES"),e.forEach((i,r)=>{const s=r*(i.stockPanel.width+200),o=0;t.push("0"),t.push("LINE"),t.push("8"),t.push("0"),t.push("62"),t.push("7"),t.push("10"),t.push(String(s)),t.push("20"),t.push(String(o)),t.push("11"),t.push(String(s+i.stockPanel.width)),t.push("21"),t.push(String(o)),t.push("0"),t.push("LINE"),t.push("8"),t.push("0"),t.push("62"),t.push("7"),t.push("10"),t.push(String(s+i.stockPanel.width)),t.push("20"),t.push(String(o)),t.push("11"),t.push(String(s+i.stockPanel.width)),t.push("21"),t.push(String(o+i.stockPanel.height)),t.push("0"),t.push("LINE"),t.push("8"),t.push("0"),t.push("62"),t.push("7"),t.push("10"),t.push(String(s+i.stockPanel.width)),t.push("20"),t.push(String(o+i.stockPanel.height)),t.push("11"),t.push(String(s)),t.push("21"),t.push(String(o+i.stockPanel.height)),t.push("0"),t.push("LINE"),t.push("8"),t.push("0"),t.push("62"),t.push("7"),t.push("10"),t.push(String(s)),t.push("20"),t.push(String(o+i.stockPanel.height)),t.push("11"),t.push(String(s)),t.push("21"),t.push(String(o));const a=50,l=i.stockPanel.width,h=i.stockPanel.height,u=Math.max(l,h),d=i.panels.map(f=>({x:s+f.x,y:o+f.y,width:f.rotated?f.height:f.width,height:f.rotated?f.width:f.height})),A=(f,p)=>{for(const w of d)if(f>=w.x-5-5&&f<=w.x+w.width+5+5&&p>=w.y-5-5&&p<=w.y+w.height+5+5)return!0;return!1};for(let f=-u;f<u*2;f+=a){let p=s+f,g=o+h,v=s+f+h,w=o;if(p<s){const m=s-p;p=s,g=o+h-m}if(g>o+h){const m=g-(o+h);g=o+h,p=p+m}if(v>s+l){const m=v-(s+l);v=s+l,w=o+m}if(w<o){const m=o-w;w=o,v=v-m}if(p>=s&&p<=s+l&&v>=s&&v<=s+l&&g>=o&&g<=o+h&&w>=o&&w<=o+h){let y=p,x=g,S=p,I=g,j=!A(p,g);for(let C=1;C<=100;C++){const b=C/100,D=p+(v-p)*b,T=g+(w-g)*b,k=A(D,T);j&&k?((y!==S||x!==I)&&(t.push("0"),t.push("LINE"),t.push("8"),t.push("0"),t.push("62"),t.push("7"),t.push("10"),t.push(String(S)),t.push("20"),t.push(String(I)),t.push("11"),t.push(String(y)),t.push("21"),t.push(String(x))),j=!1):!j&&!k&&(S=y,I=x,j=!0),y=D,x=T}j&&(y!==S||x!==I)&&(t.push("0"),t.push("LINE"),t.push("8"),t.push("0"),t.push("62"),t.push("7"),t.push("10"),t.push(String(S)),t.push("20"),t.push(String(I)),t.push("11"),t.push(String(v)),t.push("21"),t.push(String(w)))}}i.panels.forEach(f=>{const p=s+f.x,g=o+f.y,v=f.rotated?f.height:f.width,w=f.rotated?f.width:f.height;t.push("0"),t.push("LINE"),t.push("8"),t.push("0"),t.push("62"),t.push("30"),t.push("10"),t.push(String(p)),t.push("20"),t.push(String(g)),t.push("11"),t.push(String(p+v)),t.push("21"),t.push(String(g)),t.push("0"),t.push("LINE"),t.push("8"),t.push("0"),t.push("62"),t.push("30"),t.push("10"),t.push(String(p+v)),t.push("20"),t.push(String(g)),t.push("11"),t.push(String(p+v)),t.push("21"),t.push(String(g+w)),t.push("0"),t.push("LINE"),t.push("8"),t.push("0"),t.push("62"),t.push("30"),t.push("10"),t.push(String(p+v)),t.push("20"),t.push(String(g+w)),t.push("11"),t.push(String(p)),t.push("21"),t.push(String(g+w)),t.push("0"),t.push("LINE"),t.push("8"),t.push("0"),t.push("62"),t.push("30"),t.push("10"),t.push(String(p)),t.push("20"),t.push(String(g+w)),t.push("11"),t.push(String(p)),t.push("21"),t.push(String(g)),t.push("0"),t.push("TEXT"),t.push("8"),t.push("0"),t.push("62"),t.push("7"),t.push("10"),t.push(String(p+v/2)),t.push("20"),t.push(String(g+35)),t.push("30"),t.push("0"),t.push("40"),t.push("25"),t.push("1"),t.push(String(Math.round(v))),t.push("72"),t.push("1"),t.push("11"),t.push(String(p+v/2)),t.push("21"),t.push(String(g+35)),t.push("31"),t.push("0"),t.push("0"),t.push("TEXT"),t.push("8"),t.push("0"),t.push("62"),t.push("7"),t.push("10"),t.push(String(p+35)),t.push("20"),t.push(String(g+w/2)),t.push("30"),t.push("0"),t.push("40"),t.push("25"),t.push("1"),t.push(String(Math.round(w))),t.push("50"),t.push("90"),t.push("72"),t.push("1"),t.push("11"),t.push(String(p+35)),t.push("21"),t.push(String(g+w/2)),t.push("31"),t.push("0")}),t.push("0"),t.push("TEXT"),t.push("8"),t.push("0"),t.push("10"),t.push(String(s+10)),t.push("20"),t.push(String(o-30)),t.push("40"),t.push("15"),t.push("1"),t.push(`Sheet ${r+1}`)}),t.push("0"),t.push("ENDSEC"),t.push("0"),t.push("EOF"),t.join(`\r
`)}}const bze="_exportDropdown_16wb0_1",Cze="_exportMainButton_16wb0_6",_ze="_chevron_16wb0_36",Sze="_open_16wb0_41",Tze="_dropdownMenu_16wb0_45",Bze="_menuHeader_16wb0_70",Eze="_menuItem_16wb0_81",Fze="_menuItemContent_16wb0_118",kze="_menuItemTitle_16wb0_126",Ize="_menuItemDesc_16wb0_135",Dze="_menuDivider_16wb0_147",jze="_recommended_16wb0_153",Pze="_badge_16wb0_167",Jo={exportDropdown:bze,exportMainButton:Cze,chevron:_ze,open:Sze,dropdownMenu:Tze,menuHeader:Bze,menuItem:Eze,menuItemContent:Fze,menuItemTitle:kze,menuItemDesc:Ize,menuDivider:Dze,recommended:jze,badge:Pze};function Nze({optimizationResults:n}){const{panels:e,stock:t}=E0(),i=pi(p=>p.placedModules),r=hr(p=>p.spaceInfo),s=Pl(p=>p.basicInfo),[o,a]=H.useState(!1),l=H.useRef(null);H.useEffect(()=>{const p=g=>{l.current&&!l.current.contains(g.target)&&a(!1)};return document.addEventListener("mousedown",p),()=>{document.removeEventListener("mousedown",p)}},[]);const h=()=>{if(e.length===0){alert("내보낼 패널이 없습니다.");return}wze(e,"project"),a(!1)},u=()=>{if(t.length===0){alert("내보낼 원자재가 없습니다.");return}vze(t,"project"),a(!1)},d=async()=>{if(n.length===0){alert("최적화 결과가 없습니다. 먼저 최적화를 실행하세요.");return}const p=Array.isArray(e)?e:[],g={projectName:(s==null?void 0:s.title)||"Project",spaceInfo:r,placedModules:i,panels:p,needsConfiguratorView:!0};await cp.exportToZIP(n,g),a(!1)},A=()=>{if(n.length===0){alert("최적화 결과가 없습니다. 먼저 최적화를 실행하세요.");return}const p=xze.exportToDXF(n),g=new Blob([p],{type:"application/dxf"}),v=URL.createObjectURL(g),w=document.createElement("a");w.href=v;const m=new Date().toISOString().slice(0,10);w.download=`cutting_layout_${m}.dxf`,w.click(),URL.revokeObjectURL(v),a(!1)},f=e.length>0||t.length>0||n.length>0;return c.jsxs("div",{className:Jo.exportDropdown,ref:l,children:[c.jsxs("button",{className:Jo.exportMainButton,onClick:()=>a(!o),disabled:!f,children:[c.jsx(GV,{size:16}),c.jsx("span",{children:"Export"}),c.jsx(lf,{size:14,className:`${Jo.chevron} ${o?Jo.open:""}`})]}),o&&c.jsxs("div",{className:Jo.dropdownMenu,children:[c.jsx("div",{className:Jo.menuHeader,children:"내보내기 형식 선택"}),c.jsxs("button",{className:Jo.menuItem,onClick:h,disabled:e.length===0,children:[c.jsx(qV,{size:16}),c.jsxs("div",{className:Jo.menuItemContent,children:[c.jsx("span",{className:Jo.menuItemTitle,children:"패널 목록 (CSV)"}),c.jsx("span",{className:Jo.menuItemDesc,children:"패널 치수 및 수량 데이터"})]})]}),c.jsxs("button",{className:Jo.menuItem,onClick:u,disabled:t.length===0,children:[c.jsx(S_,{size:16}),c.jsxs("div",{className:Jo.menuItemContent,children:[c.jsx("span",{className:Jo.menuItemTitle,children:"원자재 목록 (CSV)"}),c.jsx("span",{className:Jo.menuItemDesc,children:"원자재 규격 및 수량"})]})]}),c.jsx("div",{className:Jo.menuDivider}),c.jsxs("button",{className:Jo.menuItem,onClick:A,disabled:n.length===0,children:[c.jsx(cve,{size:16}),c.jsxs("div",{className:Jo.menuItemContent,children:[c.jsx("span",{className:Jo.menuItemTitle,children:"CAD 도면 (DXF)"}),c.jsx("span",{className:Jo.menuItemDesc,children:"AutoCAD 호환 컷팅 레이아웃"})]})]}),c.jsxs("button",{className:`${Jo.menuItem} ${Jo.recommended}`,onClick:d,disabled:n.length===0,children:[c.jsx(uve,{size:16}),c.jsxs("div",{className:Jo.menuItemContent,children:[c.jsx("span",{className:Jo.menuItemTitle,children:"종합 리포트 (ZIP)"}),c.jsx("span",{className:Jo.menuItemDesc,children:"전체 PDF + 개별 시트 PDF + CSV + 요약"})]}),c.jsx("span",{className:Jo.badge,children:"추천"})]})]})]})}function Lze(n,e,t,i,r){const s=[];let o=0,a={width:n,length:e};if(t.y>0&&(s.push({id:`cut-${o}`,order:o++,sheetId:"",axis:"y",pos:t.y-i/2,spanStart:0,spanEnd:n,before:a,result:{width:n,length:e-t.y},kerf:i,label:`가로 재단 y=${t.y}`,source:"derived"}),a={width:n,length:e-t.y}),t.y+t.height<e){const l=t.height+(t.y>0?0:t.y);s.push({id:`cut-${o}`,order:o++,sheetId:"",axis:"y",pos:t.y+t.height+i/2,spanStart:0,spanEnd:n,before:a,result:{width:n,length:l},kerf:i,label:`가로 재단 y=${t.y+t.height}`,source:"derived"}),a={width:n,length:l}}return t.x>0&&(s.push({id:`cut-${o}`,order:o++,sheetId:"",axis:"x",pos:t.x-i/2,spanStart:Math.max(0,t.y-i),spanEnd:Math.min(e,t.y+t.height+i),before:a,result:{width:a.width-t.x,length:a.length},kerf:i,label:`세로 재단 x=${t.x}`,source:"derived"}),a={width:a.width-t.x,length:a.length}),t.x+t.width<n&&s.push({id:`cut-${o}`,order:o++,sheetId:"",axis:"x",pos:t.x+t.width+i/2,spanStart:Math.max(0,t.y-i),spanEnd:Math.min(e,t.y+t.height+i),before:a,result:{width:t.width,length:t.height},yieldsPanelId:r,kerf:i,label:`세로 재단 x=${t.x+t.width}`,source:"derived"}),s.length>0&&r&&(s[s.length-1].yieldsPanelId=r),s}function Mze(n,e,t,i,r){const s=[];let o=0;const a={width:n,length:e};return s.push({id:`cut-${o}`,order:o++,sheetId:"",axis:"y",pos:t.y+t.height,spanStart:t.x,spanEnd:t.x+t.width,before:a,result:{width:t.width,length:t.height},kerf:i,label:`상단: y=${t.y+t.height}`,source:"derived"}),s.push({id:`cut-${o}`,order:o++,sheetId:"",axis:"x",pos:t.x+t.width,spanStart:t.y,spanEnd:t.y+t.height,before:a,result:{width:t.width,length:t.height},kerf:i,label:`우측: x=${t.x+t.width}`,source:"derived"}),s.push({id:`cut-${o}`,order:o++,sheetId:"",axis:"y",pos:t.y,spanStart:t.x,spanEnd:t.x+t.width,before:a,result:{width:t.width,length:t.height},kerf:i,label:`하단: y=${t.y}`,source:"derived"}),s.push({id:`cut-${o}`,order:o++,sheetId:"",axis:"x",pos:t.x,spanStart:t.y,spanEnd:t.y+t.height,before:a,result:{width:t.width,length:t.height},yieldsPanelId:r,kerf:i,label:`좌측: x=${t.x}`,source:"derived"}),s}function MK(n){const{mode:e,sheetW:t,sheetH:i,kerf:r,placement:s,sheetId:o="",panelId:a}=n;let l;return e==="guillotine"?l=Lze(t,i,s,r,a):l=Mze(t,i,s,r,a),l.map(h=>({...h,sheetId:o}))}function Rze(n,e){const{onTick:t,onDone:i,speed:r,cancelRef:s}=e,o=1e3/r;let a=0;const l=()=>{if(s.current||a>=n.length){i();return}t(a),a++,setTimeout(l,o)};l()}const Uze="_container_1q0yl_1",Oze="_canvas_1q0yl_16",Hze="_emptyState_1q0yl_26",Wze="_emptyIcon_1q0yl_35",zze="_headerToolbar_1q0yl_47",Qze="_headerToolButton_1q0yl_55",$ze="_active_1q0yl_78",Vze="_headerDivider_1q0yl_83",Gze="_textSizeControlSmall_1q0yl_90",Xze="_textSizeBtnSmall_1q0yl_100",Yze="_textSmall_1q0yl_123",Kze="_textLarge_1q0yl_129",qze="_zoomLevel_1q0yl_134",Zze="_headerBar_1q0yl_248",Jze="_sheetNavSection_1q0yl_265",eQe="_headerNavButton_1q0yl_272",tQe="_sheetTitle_1q0yl_296",nQe="_simulationControls_1q0yl_377",iQe="_playButton_1q0yl_419",rQe="_speedControl_1q0yl_432",sQe="_cutInfo_1q0yl_454",oQe="_animatedCut_1q0yl_471",Xs={container:Uze,canvas:Oze,emptyState:Hze,emptyIcon:Wze,headerToolbar:zze,headerToolButton:Qze,active:$ze,headerDivider:Vze,textSizeControlSmall:Gze,textSizeBtnSmall:Xze,textSmall:Yze,textLarge:Kze,zoomLevel:qze,headerBar:Zze,sheetNavSection:Jze,headerNavButton:eQe,sheetTitle:tQe,simulationControls:nQe,playButton:iQe,speedControl:rQe,cutInfo:sQe,animatedCut:oQe},aQe=({result:n,highlightedPanelId:e,showLabels:t=!0,onPanelClick:i,allowRotation:r=!0,scale:s,rotation:o,offset:a,onScaleChange:l,onRotationChange:h,onOffsetChange:u,sheetInfo:d,onCurrentSheetIndexChange:A,showCuttingListTab:f=!1,allCutSteps:p=[]})=>{const g=H.useRef(null),v=H.useRef(null);n&&n.stockPanel.height>n.stockPanel.width;const[w,m]=H.useState(1),[y,x]=H.useState(-90),[S,I]=H.useState({x:0,y:0}),j=s??w,C=o??y,b=a??S,D=l||m,T=h||x,k=u||I,[B,E]=H.useState(null),[z,te]=H.useState(!1),[L,O]=H.useState({x:0,y:0}),[J,$]=H.useState(1),[U,Y]=H.useState(!1),[K,V]=H.useState(!0),{settings:Q,setSettings:X,selectedPanelId:W,selectedSheetId:se,placements:q,cuts:de,setCuts:Ce,simulating:Se,setSimulating:fe,simSpeed:M,setSimSpeed:Z,selectedCutIndex:Ae,selectCutIndex:ie,selectedCutId:ee,selectCutId:ae}=E0(),[me,_e]=H.useState([]),[ue,Be]=H.useState(0),it=H.useRef({current:!1});H.useEffect(()=>{if(Se&&!W&&n&&p&&p.length>0){const Le=((d==null?void 0:d.currentIndex)??0)+1,ye=p.filter(Ze=>Ze.sheetNumber===Le);console.log("Setting up simulation:",{currentSheetNumber:Le,totalCuts:ye.length,panelsInSheet:n.panels.length,cutsWithYields:ye.filter(Ze=>Ze.yieldsPanelId).length,panelIds:n.panels.map(Ze=>Ze.id),yieldIds:ye.filter(Ze=>Ze.yieldsPanelId).map(Ze=>Ze.yieldsPanelId)}),console.log("Cut sequence order:"),ye.forEach((Ze,nt)=>{Ze.yieldsPanelId&&console.log(`  Cut ${nt}: yields panel ${Ze.yieldsPanelId}`)}),ye.length>0?(_e(ye),Be(0)):fe(!1)}else if(W&&se&&n){const Le=q.find(ye=>ye.panelId===W&&ye.sheetId===String((d==null?void 0:d.currentIndex)+1||1));if(Le){const ye=MK({mode:Q.optimizationType==="OPTIMAL_CNC"?"free":"guillotine",sheetW:n.stockPanel.width,sheetH:n.stockPanel.height,kerf:Q.kerf||5,placement:{x:Le.x,y:Le.y,width:Le.width,height:Le.height},sheetId:Le.sheetId,panelId:Le.panelId});_e(ye),Be(0)}}else _e([]),Be(0)},[W,se,n,q,Q,d,Se,p]),H.useEffect(()=>{if(Se&&me.length>0){Be(0),it.current&&(it.current.current=!0);const Le={current:!1};it.current=Le,requestAnimationFrame(()=>{console.log("Starting runSimulation with",me.length,"cuts"),Rze(me,{onTick:ye=>{console.log("Simulation tick:",ye,"/",me.length-1),Be(ye),ie(ye)},onDone:()=>{console.log("Simulation completed"),fe(!1)},speed:.5,cancelRef:Le})})}else!Se&&it.current&&(it.current.current=!0);return()=>{it.current.current=!0}},[Se,me,M,ie,fe]),H.useEffect(()=>{const Le=ye=>{ye.key==="Escape"&&(fe(!1),it.current.current=!0)};return window.addEventListener("keydown",Le),()=>window.removeEventListener("keydown",Le)},[fe]);const De=()=>{if(!n||!g.current||!v.current)return;const Le=g.current,ye=Le.getContext("2d");if(!ye)return;const Ze=v.current.getBoundingClientRect(),nt=Ze.width,st=Ze.height,At=d?40:0,ft=st-At,Xt=window.devicePixelRatio||1,Yt=40,Zt=nt-Yt*2,sn=ft-Yt*2,vt=C%180===0?n.stockPanel.width:n.stockPanel.height,Ye=C%180===0?n.stockPanel.height:n.stockPanel.width,Gt=Zt/vt,Wt=sn/Ye,Vt=Math.min(Gt,Wt),Jt=nt,It=ft;Le.width=Jt*Xt,Le.height=It*Xt,Le.style.width=`${Jt}px`,Le.style.height=`${It}px`,ye.scale(Xt,Xt),ye.save(),ye.translate(Jt/2+b.x,It/2+b.y),ye.rotate(C*Math.PI/180),ye.scale(Vt*j,Vt*j);const Ut=-n.stockPanel.width/2,un=-n.stockPanel.height/2;ye.restore();const Sn=ye.createLinearGradient(0,0,0,It);Sn.addColorStop(0,"#fafbfc"),Sn.addColorStop(1,"#f3f4f6"),ye.fillStyle=Sn,ye.fillRect(0,0,Jt,It),ye.save(),ye.translate(Jt/2+b.x,It/2+b.y),ye.rotate(C*Math.PI/180),ye.scale(Vt*j,Vt*j),ye.save(),ye.shadowColor="rgba(0, 0, 0, 0.1)",ye.shadowBlur=20,ye.shadowOffsetY=10,ye.fillStyle="#fff",ye.fillRect(Ut,un,n.stockPanel.width,n.stockPanel.height),ye.restore(),ye.strokeStyle="#d1d5db",ye.lineWidth=2/(Vt*j),ye.strokeRect(Ut,un,n.stockPanel.width,n.stockPanel.height);const jt=window.cncSettings||{},fn=jt.trimTop??10,Zn=jt.trimBottom??10,Hn=jt.trimLeft??10,ti=jt.trimRight??10;if((fn>0||Zn>0||Hn>0||ti>0)&&(ye.save(),ye.fillStyle="rgba(255, 0, 0, 0.05)",ye.strokeStyle="rgba(255, 0, 0, 0.3)",ye.lineWidth=1/(Vt*j),ye.setLineDash([5/(Vt*j),5/(Vt*j)]),fn>0&&(ye.fillRect(Ut,un,n.stockPanel.width,fn),ye.strokeRect(Ut,un,n.stockPanel.width,fn)),Zn>0&&(ye.fillRect(Ut,un+n.stockPanel.height-Zn,n.stockPanel.width,Zn),ye.strokeRect(Ut,un+n.stockPanel.height-Zn,n.stockPanel.width,Zn)),Hn>0&&(ye.fillRect(Ut,un,Hn,n.stockPanel.height),ye.strokeRect(Ut,un,Hn,n.stockPanel.height)),ti>0&&(ye.fillRect(Ut+n.stockPanel.width-ti,un,ti,n.stockPanel.height),ye.strokeRect(Ut+n.stockPanel.width-ti,un,ti,n.stockPanel.height)),ye.restore()),K){ye.save(),ye.fillStyle="#1f2937";const Ve=Math.max(32*J/j,24*J);ye.font=`bold ${Ve}px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif`,ye.textAlign="center";const ct=20/(Vt*j);C===-90?(ye.save(),ye.translate(Ut+n.stockPanel.width/2,un-ct),ye.rotate(Math.PI),ye.textBaseline="top",ye.fillText(`${n.stockPanel.width}mm`,0,0),ye.restore(),ye.save(),ye.translate(Ut-ct,un+n.stockPanel.height/2),ye.rotate(Math.PI/2),ye.textBaseline="middle",ye.fillText(`${n.stockPanel.height}mm`,0,0),ye.restore()):(ye.textBaseline="bottom",ye.fillText(`${n.stockPanel.width}mm`,Ut+n.stockPanel.width/2,un-ct),ye.save(),ye.translate(Ut-ct,un+n.stockPanel.height/2),ye.rotate(-Math.PI/2),ye.textBaseline="middle",ye.fillText(`${n.stockPanel.height}mm`,0,0),ye.restore()),ye.restore()}const ri=getComputedStyle(document.documentElement).getPropertyValue("--theme").trim(),bi={PB:{fill:`hsl(${ri} / 0.08)`,stroke:`hsl(${ri} / 0.5)`},MDF:{fill:"#e8d4b0",stroke:"#8b6239"},PET:{fill:"#d1d5db",stroke:"#6b7280"},PLY:{fill:"#f5e6d3",stroke:"#a68966"},HPL:{fill:`hsl(${ri} / 0.14)`,stroke:`hsl(${ri} / 0.8)`},LPM:{fill:`hsl(${ri} / 0.16)`,stroke:`hsl(${ri} / 0.9)`}};let Ni=0;if(n.panels.forEach((Ve,ct)=>{if(Se){if(me.length===0)return;ct===0&&ue===0&&console.log("Panel ID matching debug:",{panelId:Ve.id,panelIdType:typeof Ve.id,yieldsPanelIds:me.filter(Ln=>Ln.yieldsPanelId).map(Ln=>({id:Ln.yieldsPanelId,type:typeof Ln.yieldsPanelId,cutIndex:me.indexOf(Ln)}))});let pn=-1;for(let Ln=0;Ln<me.length;Ln++){const Dn=me[Ln].yieldsPanelId;if(Dn===Ve.id){pn=Ln;break}if(Dn&&Ve.id&&(Dn.toString()===Ve.id.toString()||Dn.toString().includes(Ve.id.toString())||Ve.id.toString().includes(Dn.toString()))){pn=Ln;break}}if(pn===-1){ct===0&&console.warn("Panel not found in cut sequence:",Ve.id);return}if(ue<pn)return;ue===pn?(ye.globalAlpha=.9,Ni++,ye.shadowColor=`hsl(${ri})`,ye.shadowBlur=30,ye.shadowOffsetX=0,ye.shadowOffsetY=0):Ni++}else Se||Ni++;const mt=Ut+Ve.x,An=un+Ve.y,nn=Ve.rotated?Ve.height:Ve.width,zt=Ve.rotated?Ve.width:Ve.height,gn=e&&Ve.id===e,Jn=B===Ve.id,Qn=bi[Ve.material]||{fill:"#f3f4f6",stroke:"#9ca3af"};if(ye.fillStyle=Qn.fill,ye.fillRect(mt,An,nn,zt),gn?(ye.strokeStyle=`hsl(${ri})`,ye.lineWidth=3/(Vt*j),ye.strokeRect(mt,An,nn,zt),Ve.material!=="MDF"&&(ye.save(),ye.fillStyle=`hsl(${ri} / 0.08)`,ye.fillRect(mt,An,nn,zt),ye.restore())):Jn?(ye.strokeStyle=Ve.material==="MDF"?"#8b6239":`hsl(${ri} / 0.5)`,ye.lineWidth=2/(Vt*j),ye.strokeRect(mt,An,nn,zt)):(ye.strokeStyle=Qn.stroke,ye.lineWidth=1/(Vt*j),ye.strokeRect(mt,An,nn,zt)),Ve.rotated){ye.save(),ye.fillStyle=`hsl(${ri})`,ye.font="bold 12px sans-serif",ye.textAlign="center",ye.textBaseline="middle";const pn=16,Ln=mt+nn-pn-4,Dn=An+4;ye.translate(Ln+pn/2,Dn+pn/2),ye.rotate(Math.PI/4),ye.fillRect(-1,-pn/2,2,pn),ye.fillRect(-pn/2,-1,pn,2),ye.restore()}if(t&&nn>20&&zt>20){if(ye.save(),ye.imageSmoothingEnabled=!0,ye.imageSmoothingQuality="high",Ve.name){ye.save(),ye.fillStyle=Ve.material==="MDF"?"#4a4a4a":"#9ca3af",ye.textAlign="center",ye.textBaseline="middle";const pn=nn*.8,Ln=zt*.4;let ei=Math.min(24,Ln);if(C===-90){ye.save(),ye.translate(mt+nn/2,An+zt/2),ye.rotate(Math.PI/2),ye.font=`bold ${ei}px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif`;let xi=ye.measureText(Ve.name).width;const Yi=zt*.8;for(;xi>Yi&&ei>8;)ei-=1,ye.font=`bold ${ei}px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif`,xi=ye.measureText(Ve.name).width;ye.fillText(Ve.name,0,0),ye.restore()}else{ye.font=`bold ${ei}px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif`;let xi=ye.measureText(Ve.name).width;if(xi>pn&&zt>nn){ye.save(),ye.translate(mt+nn/2,An+zt/2),ye.rotate(-Math.PI/2);const Yi=zt*.8;for(;xi>Yi&&ei>8;)ei-=1,ye.font=`bold ${ei}px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif`,xi=ye.measureText(Ve.name).width;ye.fillText(Ve.name,0,0),ye.restore()}else{for(;xi>pn&&ei>8;)ei-=1,ye.font=`bold ${ei}px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif`,xi=ye.measureText(Ve.name).width;ye.fillText(Ve.name,mt+nn/2,An+zt/2)}}ye.restore()}if(K){ye.save(),ye.fillStyle=Ve.material==="MDF"?"#2c2c2c":"#111827";const Ln=32*J;if(ye.font=`bold ${Ln}px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif`,ye.textAlign="center",ye.textBaseline="middle",nn>50){const Dn=`${Math.round(Ve.width)}`,ei=An+35;C===-90?(ye.save(),ye.translate(mt+nn/2,ei),ye.rotate(Math.PI),ye.fillText(Dn,0,0),ye.restore()):ye.fillText(Dn,mt+nn/2,ei)}if(zt>50){const Dn=`${Math.round(Ve.height)}`,ei=mt+35;ye.save(),ye.translate(ei,An+zt/2),C===-90?ye.rotate(Math.PI/2):ye.rotate(-Math.PI/2),ye.fillText(Dn,0,0),ye.restore()}ye.restore()}ye.restore(),ye.shadowColor="transparent",ye.shadowBlur=0,ye.globalAlpha=1}}),Se&&ue%4===0&&console.log(`Cut ${ue}: ${Ni}/${n.panels.length} panels visible`),Se&&me.length>0&&ue<me.length){const Ve=me[ue];for(let nn=0;nn<ue;nn++){const zt=me[nn];ye.save(),ye.strokeStyle="rgba(255, 0, 0, 0.3)",ye.lineWidth=2/(Vt*j),ye.setLineDash([5,5]),ye.beginPath(),zt.axis==="x"?(ye.moveTo(Ut+zt.pos,un+zt.spanStart),ye.lineTo(Ut+zt.pos,un+zt.spanEnd)):(ye.moveTo(Ut+zt.spanStart,un+zt.pos),ye.lineTo(Ut+zt.spanEnd,un+zt.pos)),ye.stroke(),ye.restore()}ye.save(),ye.strokeStyle="#ff0000",ye.lineWidth=3/(Vt*j),ye.shadowColor="rgba(255, 0, 0, 0.5)",ye.shadowBlur=10;const ct=Date.now()/50%20;ye.setLineDash([10,10]),ye.lineDashOffset=-ct,ye.beginPath(),Ve.axis==="x"?(ye.moveTo(Ut+Ve.pos,un+Ve.spanStart),ye.lineTo(Ut+Ve.pos,un+Ve.spanEnd)):(ye.moveTo(Ut+Ve.spanStart,un+Ve.pos),ye.lineTo(Ut+Ve.spanEnd,un+Ve.pos)),ye.stroke(),ye.save(),ye.fillStyle="#ff0000",ye.font=`bold ${14/(Vt*j)}px sans-serif`,ye.textAlign="center",ye.textBaseline="middle";const mt=Ve.axis==="x"?Ut+Ve.pos:Ut+(Ve.spanStart+Ve.spanEnd)/2,An=Ve.axis==="y"?un+Ve.pos:un+(Ve.spanStart+Ve.spanEnd)/2;ye.fillText(`${Ve.axis==="x"?"↕":"↔"} ${Ve.axis}=${Math.round(Ve.pos)}`,mt,An),ye.restore(),ye.restore()}ye.restore();const ui=n.efficiency.toFixed(1),si=(n.wasteArea/1e6).toFixed(2);ye.save();const Li=70,Tr=24,xr=Jt-Li-10,br=At+10;ye.shadowColor="rgba(0, 0, 0, 0.15)",ye.shadowBlur=8,ye.shadowOffsetX=0,ye.shadowOffsetY=2;const vn=n.efficiency>80?"#10b981":n.efficiency>60?"#f59e0b":"#ef4444";ye.fillStyle=vn,ye.roundRect(xr,br,Li,Tr,8),ye.fill(),ye.shadowColor="transparent",ye.shadowBlur=0,ye.shadowOffsetX=0,ye.shadowOffsetY=0,ye.fillStyle="white",ye.font='bold 12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',ye.textAlign="center",ye.textBaseline="middle",ye.fillText(`${ui}%`,xr+Li/2,br+Tr/2),ye.restore(),ye.save(),ye.textAlign="left",ye.textBaseline="bottom";const wi=`${n.stockPanel.material||"PB"} ${n.stockPanel.thickness||18}T`;ye.font='bold 13px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',ye.fillStyle="#374151",ye.fillText(wi,20,It-40),ye.font='11px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',ye.fillStyle="#6b7280",ye.fillText(`Panels: ${n.panels.length}`,20,It-25),ye.fillText(`Waste: ${si} m²`,20,It-10),ye.restore()};H.useEffect(()=>{const Le=()=>{De()};return window.addEventListener("resize",Le),()=>window.removeEventListener("resize",Le)},[]),H.useEffect(()=>{n&&!o&&x(-90)},[n==null?void 0:n.stockPanel.id]),H.useEffect(()=>{De()},[n,e,B,t,j,b,C,J,K,Se,ue]),H.useEffect(()=>{let Le;const ye=()=>{Se&&(De(),Le=requestAnimationFrame(ye))};return Se&&ye(),()=>{Le&&cancelAnimationFrame(Le)}},[Se]);const qe=Le=>{var sn;Le.preventDefault(),Le.stopPropagation();const ye=(sn=g.current)==null?void 0:sn.getBoundingClientRect();if(!ye)return;const Ze=ye.width,nt=ye.height,st=Le.clientX-ye.left,At=Le.clientY-ye.top,Xt=Le.deltaY*.001,Yt=Math.exp(-Xt),Zt=Math.min(Math.max(.05,j*Yt),10);if(Math.abs(Zt-j)>.001){const vt=(st-Ze/2-b.x)/j,Ye=(At-nt/2-b.y)/j,Gt=st-Ze/2-vt*Zt,Wt=At-nt/2-Ye*Zt;D(Zt),k({x:Gt,y:Wt})}},Je=Le=>{te(!0),O({x:Le.clientX-b.x,y:Le.clientY-b.y})},Me=Le=>{z&&k({x:Le.clientX-L.x,y:Le.clientY-L.y})},et=()=>{te(!1)},He=()=>{T(Le=>Le===0?-90:0),k({x:0,y:0}),D(1)},ze=()=>{D(1),k({x:0,y:0}),T(-90)},Oe=[.1,.25,.5,.75,1,1.25,1.5,2,2.5,3,4,5],ke=()=>{const Le=Oe.findIndex(Ze=>Ze>=j),ye=Math.min(Le+1,Oe.length-1);D(Oe[ye])},je=()=>{const Le=Oe.findIndex(Ze=>Ze>=j),ye=Math.max(Le-1,0);D(Oe[ye])},rt=()=>{const Le=Math.min(J*1.2,3);$(Le)},_t=()=>{const Le=Math.max(J*.8,.3);$(Le)},Ee=Le=>{if(!n||!g.current||!i||z)return;const ye=g.current.getBoundingClientRect(),Ze=Le.clientX-ye.left,nt=Le.clientY-ye.top,st=ye.width,At=ye.height,ft=60,Xt=st-ft*2,Yt=At-ft*2,Zt=C%180===0?n.stockPanel.width:n.stockPanel.height,sn=C%180===0?n.stockPanel.height:n.stockPanel.width,vt=Xt/Zt,Ye=Yt/sn,Wt=Math.min(vt,Ye,1.2)*j,Vt=st/2+b.x,Jt=At/2+b.y,It=C*Math.PI/180,Ut=Math.cos(-It),un=Math.sin(-It),Sn=Ze-Vt,jt=nt-Jt,fn=Sn*Ut-jt*un,Zn=Sn*un+jt*Ut,Hn=fn/Wt+n.stockPanel.width/2,ti=Zn/Wt+n.stockPanel.height/2;let ri=null;for(const bi of n.panels)if(Hn>=bi.x&&Hn<=bi.x+bi.width&&ti>=bi.y&&ti<=bi.y+bi.height){ri=bi.id;break}i(ri)};return c.jsxs("div",{ref:v,className:`${Xs.container} panel-clickable`,children:[n&&c.jsxs("div",{className:Xs.headerBar,children:[c.jsxs("div",{className:Xs.sheetNavSection,children:[c.jsx("button",{className:Xs.headerNavButton,onClick:()=>d&&d.currentIndex>0&&(A==null?void 0:A(d.currentIndex-1)),disabled:!d||d.currentIndex===0,title:"이전 시트",children:c.jsx(tve,{size:16})}),c.jsxs("div",{className:Xs.sheetTitle,children:["Sheet ",d?d.currentIndex+1:1," / ",d?d.totalSheets:1]}),c.jsx("button",{className:Xs.headerNavButton,onClick:()=>d&&d.currentIndex<d.totalSheets-1&&(A==null?void 0:A(d.currentIndex+1)),disabled:!d||d.currentIndex>=d.totalSheets-1,title:"다음 시트",children:c.jsx(__,{size:16})})]}),c.jsxs("div",{className:Xs.headerToolbar,children:[c.jsx("button",{className:Xs.headerToolButton,onClick:je,title:"축소",children:c.jsx(sG,{size:16})}),c.jsxs("span",{className:Xs.zoomLevel,children:[Math.round(j*100),"%"]}),c.jsx("button",{className:Xs.headerToolButton,onClick:ke,title:"확대",children:c.jsx(rG,{size:16})}),c.jsx("div",{className:Xs.headerDivider}),c.jsx("button",{className:Xs.headerToolButton,onClick:ze,title:"초기화",children:c.jsx(mve,{size:16})}),c.jsx("button",{className:Xs.headerToolButton,onClick:He,title:"회전",children:c.jsx(Hve,{size:16})}),c.jsx("button",{className:`${Xs.headerToolButton} ${K?Xs.active:""}`,onClick:()=>V(!K),title:"치수 표시",children:c.jsx(u6,{size:16})}),c.jsx("div",{className:Xs.headerDivider}),c.jsxs("div",{className:Xs.textSizeControlSmall,children:[c.jsxs("button",{className:Xs.textSizeBtnSmall,onClick:_t,title:"글자 크기 줄이기",children:[c.jsx("span",{className:Xs.textLarge,children:"A"}),c.jsx("span",{className:Xs.textSmall,children:"A"})]}),c.jsxs("button",{className:Xs.textSizeBtnSmall,onClick:rt,title:"글자 크기 키우기",children:[c.jsx("span",{className:Xs.textSmall,children:"A"}),c.jsx("span",{className:Xs.textLarge,children:"A"})]})]})]})]}),c.jsx("canvas",{ref:g,className:`${Xs.canvas} panel-clickable`,style:{cursor:z?"grabbing":"grab",top:d?"40px":"0",height:d?"calc(100% - 40px)":"100%"},onClick:Ee,onWheel:qe,onMouseDown:Je,onMouseMove:Me,onMouseUp:et,onMouseLeave:et}),f&&(W&&me.length>0||ee)&&c.jsxs("div",{className:Xs.simulationOverlay,style:{position:"absolute",top:d?"40px":"0",left:0,right:0,bottom:0,pointerEvents:"none",zIndex:10},children:[c.jsxs("svg",{style:{width:"100%",height:"100%",position:"absolute"},children:[!Se&&ee&&(()=>{const ye=p.filter(fn=>fn.sheetNumber===((d==null?void 0:d.currentIndex)||0)+1).find(fn=>fn.id===ee);if(!ye||!n||!v.current)return null;const Ze=v.current.getBoundingClientRect(),nt=Ze.width,st=Ze.height-(d?40:0),At=Math.abs(Math.cos(C*Math.PI/180))*n.stockPanel.width+Math.abs(Math.sin(C*Math.PI/180))*n.stockPanel.height,ft=Math.abs(Math.sin(C*Math.PI/180))*n.stockPanel.width+Math.abs(Math.cos(C*Math.PI/180))*n.stockPanel.height,Xt=nt*.9/At,Yt=st*.9/ft,sn=Math.min(Xt,Yt,1.2)*j,vt=nt/2+b.x,Ye=st/2+b.y,Gt=C*Math.PI/180;let Wt,Vt,Jt,It;ye.axis==="x"?(Wt=ye.pos,Vt=ye.spanStart!=null?ye.spanStart:0,Jt=ye.pos,It=ye.spanEnd!=null?ye.spanEnd:n.stockPanel.height):(Wt=ye.spanStart!=null?ye.spanStart:0,Vt=ye.pos,Jt=ye.spanEnd!=null?ye.spanEnd:n.stockPanel.width,It=ye.pos),Wt=Math.max(0,Math.min(n.stockPanel.width,Wt)),Jt=Math.max(0,Math.min(n.stockPanel.width,Jt)),Vt=Math.max(0,Math.min(n.stockPanel.height,Vt)),It=Math.max(0,Math.min(n.stockPanel.height,It));const Ut=(fn,Zn)=>{const Hn=fn-n.stockPanel.width/2,ti=Zn-n.stockPanel.height/2,ri=Hn*Math.cos(Gt)-ti*Math.sin(Gt),bi=Hn*Math.sin(Gt)+ti*Math.cos(Gt);return{x:vt+ri*sn,y:Ye+bi*sn}},un=Ut(Wt,Vt),Sn=Ut(Jt,It),jt=Math.max(2,(ye.kerf||Q.kerf||5)*sn);return c.jsx("line",{x1:un.x,y1:un.y,x2:Sn.x,y2:Sn.y,stroke:"#FF4D4F",strokeWidth:jt,opacity:1,strokeDasharray:"5,5",className:Xs.animatedCut})})(),me.slice(0,ue+1).map((Le,ye)=>{if(!n||!v.current)return null;const Ze=v.current.getBoundingClientRect(),nt=Ze.width,st=Ze.height-(d?40:0),At=Math.abs(Math.cos(C*Math.PI/180))*n.stockPanel.width+Math.abs(Math.sin(C*Math.PI/180))*n.stockPanel.height,ft=Math.abs(Math.sin(C*Math.PI/180))*n.stockPanel.width+Math.abs(Math.cos(C*Math.PI/180))*n.stockPanel.height,Xt=nt*.9/At,Yt=st*.9/ft,sn=Math.min(Xt,Yt,1.2)*j,vt=nt/2+b.x,Ye=st/2+b.y,Gt=C*Math.PI/180;let Wt,Vt,Jt,It;Le.axis==="x"?(Wt=Le.pos,Vt=Le.spanStart,Jt=Le.pos,It=Le.spanEnd):(Wt=Le.spanStart,Vt=Le.pos,Jt=Le.spanEnd,It=Le.pos);const Ut=(Zn,Hn)=>{const ti=Zn-n.stockPanel.width/2,ri=Hn-n.stockPanel.height/2,bi=ti*Math.cos(Gt)-ri*Math.sin(Gt),Ni=ti*Math.sin(Gt)+ri*Math.cos(Gt);return{x:vt+bi*sn,y:Ye+Ni*sn}},un=Ut(Wt,Vt),Sn=Ut(Jt,It),jt=ye===ue,fn=Math.max(2,(Le.kerf||Q.kerf||5)*sn);return c.jsx("line",{x1:un.x,y1:un.y,x2:Sn.x,y2:Sn.y,stroke:"#FF4D4F",strokeWidth:fn,opacity:jt?1:.35,strokeDasharray:jt?"5,5":"none",className:jt?Xs.animatedCut:""},Le.id)})]}),(()=>{const Le=q.find(Ut=>Ut.panelId===W&&Ut.sheetId===String((d==null?void 0:d.currentIndex)+1||1));if(!Le||!n||!v.current)return null;const ye=v.current.getBoundingClientRect(),Ze=ye.width,nt=ye.height-(d?40:0),st=Math.abs(Math.cos(C*Math.PI/180))*n.stockPanel.width+Math.abs(Math.sin(C*Math.PI/180))*n.stockPanel.height,At=Math.abs(Math.sin(C*Math.PI/180))*n.stockPanel.width+Math.abs(Math.cos(C*Math.PI/180))*n.stockPanel.height,ft=Ze*.9/st,Xt=nt*.9/At,Zt=Math.min(ft,Xt,1.2)*j,sn=Ze/2+b.x,vt=nt/2+b.y,Ye=C*Math.PI/180,Gt=(Ut,un)=>{const Sn=Ut-n.stockPanel.width/2,jt=un-n.stockPanel.height/2,fn=Sn*Math.cos(Ye)-jt*Math.sin(Ye),Zn=Sn*Math.sin(Ye)+jt*Math.cos(Ye);return{x:sn+fn*Zt,y:vt+Zn*Zt}},Wt=Gt(Le.x,Le.y),Vt=Gt(Le.x+Le.width,Le.y),Jt=Gt(Le.x+Le.width,Le.y+Le.height),It=Gt(Le.x,Le.y+Le.height);return c.jsx("svg",{style:{width:"100%",height:"100%",position:"absolute"},children:c.jsx("polygon",{points:`${Wt.x},${Wt.y} ${Vt.x},${Vt.y} ${Jt.x},${Jt.y} ${It.x},${It.y}`,fill:"hsl(var(--theme))",opacity:.15})})})()]}),f&&W&&me.length>0&&c.jsxs("div",{className:Xs.simulationControls,children:[c.jsx("button",{onClick:()=>{Be(Math.max(0,ue-1)),ie(Math.max(0,ue-1))},disabled:ue===0,title:"이전 절단",children:c.jsx(Vve,{size:16})}),c.jsx("button",{onClick:()=>fe(!Se),className:Xs.playButton,title:Se?"일시정지":"재생",children:Se?c.jsx(ZV,{size:18}):c.jsx(h6,{size:18})}),c.jsx("button",{onClick:()=>{Be(Math.min(me.length-1,ue+1)),ie(Math.min(me.length-1,ue+1))},disabled:ue>=me.length-1,title:"다음 절단",children:c.jsx(Xve,{size:16})}),c.jsxs("div",{className:Xs.speedControl,children:[c.jsxs("label",{children:["속도: ",M,"x"]}),c.jsx("input",{type:"range",min:"0.25",max:"3",step:"0.25",value:M,onChange:Le=>Z(parseFloat(Le.target.value))})]}),c.jsxs("div",{className:Xs.cutInfo,children:[ue+1," / ",me.length," 절단"]})]}),!n&&c.jsxs("div",{className:Xs.emptyState,children:[c.jsx("div",{className:Xs.emptyIcon,children:"📐"}),c.jsx("p",{children:"No optimization result to display"})]})]})},lQe="_container_13ybf_1",cQe="_header_13ybf_10",hQe="_headerLeft_13ybf_21",uQe="_projectName_13ybf_37",dQe="_headerRight_13ybf_44",AQe="_exportGroup_13ybf_50",fQe="_divider_13ybf_56",pQe="_calculateButton_13ybf_63",gQe="_highlighted_13ybf_90",mQe="_dropdownContainer_13ybf_114",yQe="_dropdownButton_13ybf_118",wQe="_rotated_13ybf_142",vQe="_dropdownMenu_13ybf_220",xQe="_dropdownItem_13ybf_233",bQe="_active_13ybf_257",CQe="_exitButton_13ybf_263",_Qe="_primary_13ybf_305",SQe="_main_13ybf_325",TQe="_leftSidebar_13ybf_338",BQe="_centerPanel_13ybf_358",EQe="_viewerContainer_13ybf_368",FQe="_keyboardHint_13ybf_376",kQe="_mainViewer_13ybf_411",IQe="_thumbnailBar_13ybf_473",DQe="_thumbnailScroll_13ybf_485",jQe="_sheetNumber_13ybf_541",PQe="_sheetPanels_13ybf_555",NQe="_sheetEfficiency_13ybf_560",LQe="_thumbnailWrapper_13ybf_567",MQe="_thumbnailTitle_13ybf_576",RQe="_thumbnail_13ybf_473",UQe="_activeThumbnail_13ybf_607",OQe="_thumbnailCanvas_13ybf_618",HQe="_optimizeButtonLarge_13ybf_719",WQe="_emptyPreview_13ybf_746",zQe="_rightSidebar_13ybf_776",QQe="_statsCard_13ybf_801",$Qe="_statsCardTitle_13ybf_818",VQe="_foldButton_13ybf_830",GQe="_statsCardHeader_13ybf_850",XQe="_statsNavButton_13ybf_870",YQe="_playButton_13ybf_895",KQe="_playing_13ybf_920",qQe="_rightSidebarContent_13ybf_954",ZQe="_sheetListCard_13ybf_963",JQe="_sheetList_13ybf_963",e$e="_sheetItemContainer_13ybf_1002",t$e="_sheetItem_13ybf_1002",n$e="_expandButton_13ybf_1025",i$e="_sheetListHeader_13ybf_1057",r$e="_tabButtons_13ybf_1065",s$e="_tabButton_13ybf_1065",o$e="_sheetInfo_13ybf_1139",a$e="_panelListContainer_13ybf_1155",l$e="_panelItem_13ybf_1169",c$e="_selectedPanel_13ybf_1188",h$e="_panelName_13ybf_1194",u$e="_panelSize_13ybf_1203",d$e="_cutsList_13ybf_1211",A$e="_cutsTableHeader_13ybf_1218",f$e="_cutsTableBody_13ybf_1235",p$e="_cutsRow_13ybf_1260",g$e="_selected_13ybf_1188",m$e="_cutsCol1_13ybf_1288",y$e="_cutsCol2_13ybf_1294",w$e="_cutsCol3_13ybf_1299",v$e="_cutsCol4_13ybf_1304",x$e="_statsDetail_13ybf_1311",b$e="_statRow_13ybf_1318",C$e="_statValue_13ybf_1336",_$e="_statPercent_13ybf_1350",Fn={container:lQe,header:cQe,headerLeft:hQe,projectName:uQe,headerRight:dQe,exportGroup:AQe,divider:fQe,calculateButton:pQe,highlighted:gQe,dropdownContainer:mQe,dropdownButton:yQe,rotated:wQe,dropdownMenu:vQe,dropdownItem:xQe,active:bQe,exitButton:CQe,primary:_Qe,main:SQe,leftSidebar:TQe,centerPanel:BQe,viewerContainer:EQe,keyboardHint:FQe,mainViewer:kQe,thumbnailBar:IQe,thumbnailScroll:DQe,sheetNumber:jQe,sheetPanels:PQe,sheetEfficiency:NQe,thumbnailWrapper:LQe,thumbnailTitle:MQe,thumbnail:RQe,activeThumbnail:UQe,thumbnailCanvas:OQe,optimizeButtonLarge:HQe,emptyPreview:WQe,rightSidebar:zQe,statsCard:QQe,statsCardTitle:$Qe,foldButton:VQe,statsCardHeader:GQe,statsNavButton:XQe,playButton:YQe,playing:KQe,rightSidebarContent:qQe,sheetListCard:ZQe,sheetList:JQe,sheetItemContainer:e$e,sheetItem:t$e,expandButton:n$e,sheetListHeader:i$e,tabButtons:r$e,tabButton:s$e,sheetInfo:o$e,panelListContainer:a$e,panelItem:l$e,selectedPanel:c$e,panelName:h$e,panelSize:u$e,cutsList:d$e,cutsTableHeader:A$e,cutsTableBody:f$e,cutsRow:p$e,selected:g$e,cutsCol1:m$e,cutsCol2:y$e,cutsCol3:w$e,cutsCol4:v$e,statsDetail:x$e,statRow:b$e,statValue:C$e,statPercent:_$e};function S$e({result:n,index:e,isActive:t,onClick:i}){const r=H.useRef(null);H.useEffect(()=>{const a=r.current;if(!a||!n)return;const l=a.getContext("2d");if(!l)return;const h=n.stockPanel.width,u=n.stockPanel.height,d=u>h,A=d?u:h,f=d?h:u,p=120,g=60,v=Math.min(p/A,g/f),w=window.devicePixelRatio||1;a.width=p*w,a.height=g*w,a.style.width=`${p}px`,a.style.height=`${g}px`,l.scale(w,w),l.imageSmoothingEnabled=!0,l.imageSmoothingQuality="high";const m=l.createLinearGradient(0,0,0,g);m.addColorStop(0,"#ffffff"),m.addColorStop(1,"#fafbfc"),l.fillStyle=m,l.fillRect(0,0,p,g);const y=A*v,x=f*v,S=(p-y)/2,I=(g-x)/2;l.save(),l.shadowColor="rgba(0, 0, 0, 0.08)",l.shadowBlur=4,l.shadowOffsetY=2,l.fillStyle="#ffffff",l.fillRect(S,I,y,x),l.restore(),l.strokeStyle="#e5e7eb",l.lineWidth=1,l.strokeRect(S,I,y,x);const j=getComputedStyle(document.documentElement).getPropertyValue("--theme").trim()||"220 90% 56%";if(n.panels.forEach(C=>{let b,D,T,k;d?(b=S+C.y*v,D=I+(h-C.x-C.width)*v,T=(C.rotated?C.width:C.height)*v,k=(C.rotated?C.height:C.width)*v):(b=S+C.x*v,D=I+C.y*v,T=(C.rotated?C.height:C.width)*v,k=(C.rotated?C.width:C.height)*v);const B={PB:{fill:`hsl(${j} / 0.06)`,stroke:`hsl(${j} / 0.3)`},MDF:{fill:"rgba(212, 165, 116, 0.3)",stroke:"rgba(139, 98, 57, 0.5)"},PET:{fill:"rgba(209, 213, 219, 0.6)",stroke:"rgba(107, 114, 128, 0.6)"},PLY:{fill:"rgba(232, 212, 176, 0.3)",stroke:"rgba(166, 137, 102, 0.5)"},HPL:{fill:`hsl(${j} / 0.12)`,stroke:`hsl(${j} / 0.35)`},LPM:{fill:`hsl(${j} / 0.14)`,stroke:`hsl(${j} / 0.35)`}},E=B[C.material]||B.PB;l.fillStyle=E.fill,l.fillRect(b,D,T,k),l.strokeStyle=E.stroke,l.lineWidth=.5,l.strokeRect(b,D,T,k)}),l.save(),l.fillStyle="#374151",l.font="bold 11px -apple-system, sans-serif",l.textAlign="left",l.textBaseline="top",l.fillText(n.stockPanel.material||"PB",6,6),l.restore(),n.efficiency>0){l.save();const C=n.efficiency.toFixed(0),b=24,D=p-b-6,T=6,k=n.efficiency>80?"#10b981":n.efficiency>60?"#f59e0b":"#ef4444";l.fillStyle=k,l.beginPath(),l.roundRect(D,T,b,16,8),l.fill(),l.fillStyle="white",l.font="bold 10px -apple-system, sans-serif",l.textAlign="center",l.textBaseline="middle",l.fillText(`${C}%`,D+b/2,T+8),l.restore()}},[n]);const s=n.panels.length>0?n.panels[0].thickness:18,o=n.stockPanel.material||"PB";return c.jsxs("div",{className:Fn.thumbnailWrapper,children:[c.jsxs("div",{className:Fn.thumbnailTitle,children:["Sheet ",e+1," - ",o," (",s,"T)"]}),c.jsx("div",{className:`${Fn.thumbnail} ${t?Fn.activeThumbnail:""}`,onClick:i,children:c.jsx("canvas",{ref:r,className:Fn.thumbnailCanvas})})]})}const T$e="_overlay_1put7_1",B$e="_modal_1put7_25",E$e="_aiIconContainer_1put7_51",F$e="_aiIcon_1put7_51",k$e="_pulseRing_1put7_90",I$e="_pulseRing2_1put7_91",D$e="_title_1put7_119",j$e="_dots_1put7_129",P$e="_phase_1put7_137",N$e="_progressContainer_1put7_156",L$e="_progressBar_1put7_161",M$e="_progressFill_1put7_169",R$e="_progressGlow_1put7_192",U$e="_progressText_1put7_215",O$e="_dataStream_1put7_225",H$e="_dataLine_1put7_236",W$e="_dataChar_1put7_259",z$e="_neuralNetwork_1put7_279",Q$e="_networkSvg_1put7_289",$$e="_node_1put7_294",V$e="_connection_1put7_318",zo={overlay:T$e,modal:B$e,aiIconContainer:E$e,aiIcon:F$e,pulseRing:k$e,pulseRing2:I$e,title:D$e,dots:j$e,phase:P$e,progressContainer:N$e,progressBar:L$e,progressFill:M$e,progressGlow:R$e,progressText:U$e,dataStream:O$e,dataLine:H$e,dataChar:W$e,neuralNetwork:z$e,networkSvg:Q$e,node:$$e,connection:V$e},G$e=({isOpen:n,progress:e=0,message:t,duration:i=5e3})=>{const{t:r}=ia(),[s,o]=H.useState(0),[a,l]=H.useState(0),h=[r("cnc.aiPhase1"),r("cnc.aiPhase2"),r("cnc.aiPhase3"),r("cnc.aiPhase4"),r("cnc.aiPhase5")],u=t||r("cnc.aiOptimizing");return H.useEffect(()=>{if(!n)return;const d=setInterval(()=>{o(p=>(p+1)%4)},500),A=Math.max(500,i/h.length),f=setInterval(()=>{l(p=>(p+1)%h.length)},A);return()=>{clearInterval(d),clearInterval(f)}},[n]),n?c.jsx("div",{className:zo.overlay,children:c.jsxs("div",{className:zo.modal,children:[c.jsxs("div",{className:zo.aiIconContainer,children:[c.jsx("div",{className:zo.aiIcon,children:c.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[c.jsx("circle",{cx:"12",cy:"12",r:"10"}),c.jsx("path",{d:"M12 6v6l4 2"})]})}),c.jsx("div",{className:zo.pulseRing}),c.jsx("div",{className:zo.pulseRing2})]}),c.jsxs("h3",{className:zo.title,children:[u,c.jsx("span",{className:zo.dots,children:".".repeat(s)})]}),c.jsx("p",{className:zo.phase,children:h[a]}),c.jsxs("div",{className:zo.progressContainer,children:[c.jsxs("div",{className:zo.progressBar,children:[c.jsx("div",{className:zo.progressFill,style:{width:`${e}%`}}),c.jsx("div",{className:zo.progressGlow})]}),c.jsxs("span",{className:zo.progressText,children:[Math.round(e),"%"]})]}),c.jsx("div",{className:zo.dataStream,children:Array.from({length:5}).map((d,A)=>c.jsx("div",{className:zo.dataLine,style:{animationDelay:`${A*.2}s`},children:Array.from({length:20}).map((f,p)=>c.jsx("span",{className:zo.dataChar,children:Math.random()>.5?"1":"0"},p))},A))}),c.jsx("div",{className:zo.neuralNetwork,children:c.jsxs("svg",{viewBox:"0 0 200 100",className:zo.networkSvg,children:[[20,50,80].map((d,A)=>c.jsx("circle",{cx:"30",cy:d,r:"4",className:zo.node},`input-${A}`)),[15,35,50,65,85].map((d,A)=>c.jsx("circle",{cx:"70",cy:d,r:"4",className:zo.node},`hidden1-${A}`)),[20,40,60,80].map((d,A)=>c.jsx("circle",{cx:"110",cy:d,r:"4",className:zo.node},`hidden2-${A}`)),[35,65].map((d,A)=>c.jsx("circle",{cx:"150",cy:d,r:"4",className:zo.node},`output-${A}`)),[20,50,80].map(d=>[15,35,50,65,85].map(A=>c.jsx("line",{x1:"30",y1:d,x2:"70",y2:A,className:zo.connection},`line1-${d}-${A}`))),[15,35,50,65,85].map(d=>[20,40,60,80].map(A=>c.jsx("line",{x1:"70",y1:d,x2:"110",y2:A,className:zo.connection},`line2-${d}-${A}`))),[20,40,60,80].map(d=>[35,65].map(A=>c.jsx("line",{x1:"110",y1:d,x2:"150",y2:A,className:zo.connection},`line3-${d}-${A}`)))]})})]})}):null},X$e="_overlay_1uars_1",Y$e="_modal_1uars_25",K$e="_header_1uars_46",q$e="_title_1uars_54",Z$e="_closeButton_1uars_61",J$e="_content_1uars_80",eVe="_icon_1uars_85",tVe="_message_1uars_97",nVe="_subMessage_1uars_105",iVe="_footer_1uars_112",rVe="_cancelButton_1uars_120",sVe="_confirmButton_1uars_121",mu={overlay:X$e,modal:Y$e,header:K$e,title:q$e,closeButton:Z$e,content:J$e,icon:eVe,message:tVe,subMessage:nVe,footer:iVe,cancelButton:rVe,confirmButton:sVe},oVe=({isOpen:n,onConfirm:e,onCancel:t})=>{const{t:i}=ia();return n?c.jsx("div",{className:mu.overlay,onClick:t,children:c.jsxs("div",{className:mu.modal,onClick:r=>r.stopPropagation(),children:[c.jsxs("div",{className:mu.header,children:[c.jsx("h3",{className:mu.title,children:i("common.confirm")}),c.jsx("button",{className:mu.closeButton,onClick:t,children:c.jsx(iG,{size:20})})]}),c.jsxs("div",{className:mu.content,children:[c.jsx("div",{className:mu.icon,children:c.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[c.jsx("circle",{cx:"12",cy:"12",r:"10"}),c.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),c.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]})}),c.jsx("p",{className:mu.message,children:i("cnc.exitConfirmMessage")}),c.jsx("p",{className:mu.subMessage,children:i("cnc.unsavedChangesWarning")})]}),c.jsxs("div",{className:mu.footer,children:[c.jsx("button",{className:mu.cancelButton,onClick:t,children:i("common.cancel")}),c.jsx("button",{className:mu.confirmButton,onClick:e,children:i("cnc.exit")})]})]})}):null};class gI{constructor(e,t,i=5){Br(this,"binWidth");Br(this,"binHeight");Br(this,"kerf");Br(this,"strips",[]);Br(this,"bestLayout",null);this.binWidth=e,this.binHeight=t,this.kerf=i}packAll(e,t="auto"){const i=[...e].sort((o,a)=>{const l=o.width*o.height;return a.width*a.height-l});let r,s;if(t==="horizontal")r=this.packWithStrips(i,!0),s=this.calculateEfficiency(r);else if(t==="vertical")r=this.packWithStrips(i,!1),s=this.calculateEfficiency(r);else{const o=this.packWithStrips(i,!0),a=this.calculateEfficiency(o),l=this.packWithStrips(i,!1),h=this.calculateEfficiency(l),u=this.packWithMixedStrategy(i),d=this.calculateEfficiency(u);r=o,s=a,h>s&&(r=l,s=h),d>s&&(r=u,s=d)}return this.strips=r,this.bestLayout={strips:r,efficiency:s},this.getResult()}packWithMixedStrategy(e){const t=[],i=[...e],s=e.reduce((h,u)=>h+u.width*u.height,0)/e.length,o=i.filter(h=>h.width*h.height>s*1.5),a=i.filter(h=>h.width*h.height<=s*1.5);let l=0;if(o.length>0){const h=this.packWithStrips(o,!0);for(const u of h)if(l+u.height<=this.binHeight){const d=u.panels.map(f=>({...f,y:l})),A={...u,y:l,panels:d};t.push(A),l+=u.height+this.kerf}}if(a.length>0&&l<this.binHeight){const h=this.binHeight-l,d=new gI(this.binWidth,h,this.kerf).packWithStrips(a,!1);for(const A of d){const f=A.panels.map(g=>({...g,y:g.y+l})),p={...A,y:A.y+l,panels:f};t.push(p)}}return t}packWithStrips(e,t){const i=[],s=[...this.sortPanels(e,t)];let o=0;for(;s.length>0;){const a=this.createStrip(s,o,t);if(!a||a.panels.length===0||(i.push(a),a.panels.forEach(l=>{const h=s.findIndex(u=>u.id===l.id&&u.width===l.width&&u.height===l.height);h!==-1&&s.splice(h,1)}),t?o=a.y+a.height+this.kerf:o=a.x+a.width+this.kerf,t&&o>=this.binHeight||!t&&o>=this.binWidth))break}return i}createStrip(e,t,i){if(e.length===0)return null;const r={x:i?0:t,y:i?t:0,width:i?this.binWidth:0,height:i?0:this.binHeight,panels:[],horizontal:i};if(i){let s=0,o=0;const a=this.binHeight-t;if(a<=0)return null;const l=e.map(f=>f.height),h=e.filter(f=>f.canRotate).map(f=>f.width),u=[...l,...h].sort((f,p)=>p-f);for(const f of u)if(f<=a){let p=0,g=0;for(const w of e){const y=Math.abs(w.height-f)/f<=.1,x=w.canRotate&&Math.abs(w.width-f)/f<=.1;(y||x)&&p+w.width<=this.binWidth&&(p+=(y?w.width:w.height)+this.kerf,g++)}const v=p/this.binWidth*g;v>o&&(s=f,o=v)}if(s===0||(r.height=s,r.y+r.height>this.binHeight))return null;let d=0;const A=new Set;for(const f of e){if(A.has(f))continue;if(Math.abs(f.height-r.height)/r.height<=.1&&d+f.width<=this.binWidth){const g={...f,x:d,y:r.y,stripIndex:this.strips.length};r.panels.push(g),d+=f.width+this.kerf,A.add(f)}}for(const f of e){if(A.has(f)||!f.canRotate)continue;if(Math.abs(f.width-r.height)/r.height<=.1&&d+f.height<=this.binWidth){const g={...f,x:d,y:r.y,rotated:!0,stripIndex:this.strips.length};r.panels.push(g),d+=f.height+this.kerf,A.add(f)}}}else{let s=0,o=0;const a=this.binWidth-t;if(a<=0)return null;const l=e.map(f=>f.width),h=e.filter(f=>f.canRotate).map(f=>f.height),u=[...l,...h].sort((f,p)=>p-f);for(const f of u)if(f<=a){let p=0,g=0;for(const w of e){const y=Math.abs(w.width-f)/f<=.1,x=w.canRotate&&Math.abs(w.height-f)/f<=.1;(y||x)&&p+w.height<=this.binHeight&&(p+=(y?w.height:w.width)+this.kerf,g++)}const v=p/this.binHeight*g;v>o&&(s=f,o=v)}if(s===0||(r.width=s,r.x+r.width>this.binWidth))return null;let d=0;const A=new Set;for(const f of e){if(A.has(f))continue;if(Math.abs(f.width-r.width)/r.width<=.1&&d+f.height<=this.binHeight){const g={...f,x:r.x,y:d,stripIndex:this.strips.length};r.panels.push(g),d+=f.height+this.kerf,A.add(f)}}for(const f of e){if(A.has(f)||!f.canRotate)continue;if(Math.abs(f.height-r.width)/r.width<=.1&&d+f.width<=this.binHeight){const g={...f,x:r.x,y:d,rotated:!0,stripIndex:this.strips.length};r.panels.push(g),d+=f.width+this.kerf,A.add(f)}}}return r.panels.length>0?r:null}sortPanels(e,t){return[...e].sort((i,r)=>{if(t){const s=r.height-i.height;return s!==0?s:r.width*r.height-i.width*i.height}else{const s=r.width-i.width;return s!==0?s:r.width*r.height-i.width*i.height}})}calculateEfficiency(e){let t=0;for(const r of e)for(const s of r.panels)t+=s.width*s.height;const i=this.binWidth*this.binHeight;return i>0?t/i*100:0}getResult(){var s;const e=[];let t=0;const i=new Set;for(const o of this.strips)for(const a of o.panels){const l=`${a.id}-${a.x}-${a.y}`;if(i.has(l)){console.warn(`Duplicate panel detected: ${l}`);continue}i.add(l);const h={...a};h.x<0&&(h.x=0),h.y<0&&(h.y=0);const u=h.rotated?h.height:h.width,d=h.rotated?h.width:h.height;if(h.x+u>this.binWidth){console.warn(`Panel extends beyond bin width: ${h.x+u} > ${this.binWidth}`);continue}if(h.y+d>this.binHeight){console.warn(`Panel extends beyond bin height: ${h.y+d} > ${this.binHeight}`);continue}e.push(h),t+=h.width*h.height}const r=((s=this.bestLayout)==null?void 0:s.efficiency)||0;return{width:this.binWidth,height:this.binHeight,panels:e,efficiency:r,usedArea:t}}}function fR(n,e,t,i=5,r=999,s="auto"){const o=[];let a=0;const l=[...n];for(;l.length>0&&a<r;){const u=new gI(e,t,i).packAll(l,s);if(u.panels.length===0){console.warn("Cannot place any more panels in guillotine mode");break}for(const d of u.panels){const A=l.findIndex(f=>f.id===d.id&&f.width===d.width&&f.height===d.height);A!==-1&&l.splice(A,1)}o.push(u),a++}return o}class aVe{constructor(e,t,i=5){Br(this,"binWidth");Br(this,"binHeight");Br(this,"kerf");Br(this,"freeRects",[]);Br(this,"placedPanels",[]);this.binWidth=e,this.binHeight=t,this.kerf=i,this.freeRects=[{x:0,y:0,width:e,height:t}]}pack(e){let t=1/0,i=1/0,r=null,s=!1,o=-1;for(let a=0;a<this.freeRects.length;a++){const l=this.freeRects[a];if(e.width+this.kerf<=l.width&&e.height+this.kerf<=l.height){const h=l.width-e.width-this.kerf,u=l.height-e.height-this.kerf,d=l.width*l.height-e.width*e.height,A=Math.min(h,u);(d<t||d===t&&A<i)&&(t=d,i=A,r=l,s=!1,o=a)}if(e.canRotate!==!1&&e.height+this.kerf<=l.width&&e.width+this.kerf<=l.height){const h=l.width-e.height-this.kerf,u=l.height-e.width-this.kerf,d=l.width*l.height-e.width*e.height,A=Math.min(h,u);(d<t||d===t&&A<i)&&(t=d,i=A,r=l,s=!0,o=a)}}if(r&&o>=0){const a=s?e.height:e.width,l=s?e.width:e.height,h={...e,x:r.x,y:r.y,width:e.width,height:e.height,rotated:s};return this.placedPanels.push(h),this.splitFreeRect(r,o,a+this.kerf,l+this.kerf),this.pruneFreeRects(),h}return null}splitFreeRect(e,t,i,r){this.freeRects.splice(t,1),e.width>i&&this.freeRects.push({x:e.x+i,y:e.y,width:e.width-i,height:r}),e.height>r&&this.freeRects.push({x:e.x,y:e.y+r,width:e.width,height:e.height-r}),e.width>i&&e.height>r&&this.freeRects.push({x:e.x+i,y:e.y+r,width:e.width-i,height:e.height-r})}pruneFreeRects(){const e=[];for(let t=0;t<this.freeRects.length;t++){const i=this.freeRects[t];let r=!1;for(let s=0;s<this.freeRects.length;s++){if(t===s)continue;const o=this.freeRects[s];if(i.x>=o.x&&i.y>=o.y&&i.x+i.width<=o.x+o.width&&i.y+i.height<=o.y+o.height){r=!0;break}}r||e.push(i)}this.freeRects=e}getResult(){let e=0;for(const r of this.placedPanels)e+=r.width*r.height;const t=this.binWidth*this.binHeight,i=t>0?e/t*100:0;return i>95&&this.placedPanels.length<=3&&(console.warn("Suspicious high efficiency detected:"),console.warn("Sheet size:",this.binWidth,"x",this.binHeight,"=",t),console.warn("Used area:",e),console.warn("Efficiency:",i.toFixed(2)+"%"),console.warn("Panels:",this.placedPanels.map(r=>({id:r.id,size:`${r.width}x${r.height}`,pos:`(${r.x},${r.y})`,rotated:r.rotated})))),{width:this.binWidth,height:this.binHeight,panels:this.placedPanels,efficiency:i,usedArea:e}}}function lVe(n,e,t,i=5,r=999){const s=[...n].sort((h,u)=>{const d=h.width*h.height,A=u.width*u.height;if(Math.abs(d-A)>1e4)return A-d;const f=Math.max(h.width,h.height);return Math.max(u.width,u.height)-f}),o=[];let a=0;const l=[...s];for(;l.length>0&&a<r;){const h=new aVe(e,t,i),u=[];for(let A=0;A<l.length;A++){const f=l[A];h.pack(f)&&u.push(A)}if(u.length===0){console.warn("Cannot place any more panels");break}u.reverse().forEach(A=>{l.splice(A,1)});const d=h.getResult();o.push(d),a++}return o}class Dy{static toInt(e){return Math.round(e*this.PRECISION)}static toMm(e){return e/this.PRECISION}static add(e,t){const i=this.toInt(e),r=this.toInt(t);return this.toMm(i+r)}static subtract(e,t){const i=this.toInt(e),r=this.toInt(t);return this.toMm(i-r)}static multiply(e,t){const i=this.toInt(e),r=this.toInt(t);return this.toMm(i*r/this.PRECISION)}static divide(e,t){const i=this.toInt(e),r=this.toInt(t);return this.toMm(i*this.PRECISION/r)}static equals(e,t){return this.toInt(e)===this.toInt(t)}static lte(e,t){return this.toInt(e)<=this.toInt(t)}static gte(e,t){return this.toInt(e)>=this.toInt(t)}}Br(Dy,"PRECISION",10);class cVe{static checkOverlap(e,t,i){const r=Dy,s=r.add(e.x,e.width),o=r.add(e.y,e.height),a=r.add(t.x,t.width),l=r.add(t.y,t.height),h=r.add(s,i),u=r.add(o,i);r.subtract(t.x,i),r.subtract(t.y,i);const d=r.lte(h,t.x)||r.gte(e.x,a),A=r.lte(u,t.y)||r.gte(e.y,l);return!(d||A)}static checkInBounds(e,t,i){const r=Dy,s=r.add(e.x,e.width),o=r.add(e.y,e.height);return r.gte(e.x,0)&&r.gte(e.y,0)&&r.lte(s,t)&&r.lte(o,i)}static validatePlacement(e,t,i,r){const s=[];for(const o of e)this.checkInBounds(o,t,i)||s.push(`Panel ${o.id} exceeds sheet bounds: ${o.x},${o.y} ${o.width}x${o.height} in ${t}x${i}`);for(let o=0;o<e.length;o++)for(let a=o+1;a<e.length;a++)this.checkOverlap(e[o],e[a],r)&&s.push(`Panels ${e[o].id} and ${e[a].id} overlap`);for(const o of e){const a=Dy,l=a.equals(o.x,a.toMm(a.toInt(o.x))),h=a.equals(o.y,a.toMm(a.toInt(o.y))),u=a.equals(o.width,a.toMm(a.toInt(o.width))),d=a.equals(o.height,a.toMm(a.toInt(o.height)));(!l||!h||!u||!d)&&s.push(`Panel ${o.id} has precision errors in dimensions`)}return{valid:s.length===0,errors:s}}static calculateExactArea(e){const t=Dy;let i=0;for(const r of e){const s=t.multiply(r.width,r.height);i=t.add(i,s)}return i}}const hVe=async(n,e,t=999,i=!0,r=5,s="OPTIMAL_CNC")=>{const o=[],a=new Map;n.forEach(u=>{for(let d=0;d<u.quantity;d++){const A=`${u.id}-${d}`,f=u.grain&&u.grain!=="NONE"?!1:u.canRotate!==!1;o.push({id:A,width:u.width,height:u.height,grain:u.grain||"NONE",material:u.material,color:u.color,name:u.name,canRotate:f}),a.set(A,u)}});let l;s==="OPTIMAL_L"||s==="BY_LENGTH"?l=fR(o,e.width,e.height,r,t,"vertical"):s==="OPTIMAL_W"||s==="BY_WIDTH"?l=fR(o,e.width,e.height,r,t,"horizontal"):l=lVe(o,e.width,e.height,r,t);const h=[];return l.slice(0,t).forEach((u,d)=>{const A=u.panels.map(w=>{const m=a.get(w.id),y=w.rotated||!1;return{...m,id:w.id,x:w.x||0,y:w.y||0,width:m.width,height:m.height,rotated:y,quantity:1,grain:m.grain||"NONE",material:m.material,color:m.color,name:m.name}});cVe.validatePlacement(A,e.width,e.height,r).valid;const p=A.reduce((w,m)=>w+m.width*m.height,0),g=u.width*u.height,v=p/g*100;v>95&&A.length<=3&&(console.warn("Suspicious efficiency in optimizer:"),console.warn("Bin efficiency:",u.efficiency.toFixed(2)+"%"),console.warn("Recalculated efficiency:",v.toFixed(2)+"%"),console.warn("Panels:",A.length),console.warn("Used area:",p,"vs bin.usedArea:",u.usedArea),console.warn("Total area:",g)),h.push({stockPanel:{...e,id:`${e.id}-${d}`},panels:A,efficiency:v,wasteArea:g-p,usedArea:p})}),h};function pR(n,e){return`${Math.round(n)}×${Math.round(e)}`}function gR(n){let e=0;const t=new Map;for(const i of n){const r=`${i.sheetId}|${i.axis}|${i.pos.toFixed(3)}`;t.has(r)||t.set(r,[]),t.get(r).push({start:Math.min(i.spanStart,i.spanEnd),end:Math.max(i.spanStart,i.spanEnd),kerf:i.kerf||0})}for(const[,i]of t){i.sort((o,a)=>o.start-a.start);const r=[];let s=i[0];for(let o=1;o<i.length;o++){const a=i[o];a.start<=s.end?s={start:s.start,end:Math.max(s.end,a.end),kerf:Math.max(s.kerf,a.kerf)}:(r.push(s),s=a)}r.push(s);for(const o of r){const a=o.end-o.start;e+=a}}return e}function uVe(n,e="m"){const t={},i={},r=new Map;for(const l of n)r.has(l.sheetId)||r.set(l.sheetId,[]),r.get(l.sheetId).push(l);let s=0,o=0;for(const[l,h]of r){const u=h.filter(g=>g.axis==="y"),d=h.filter(g=>g.axis==="x"),A=gR(u),f=gR(d),p=A+f;t[l]=e==="m"?p/1e3:p,i[l]={horizontal:e==="m"?A/1e3:A,vertical:e==="m"?f/1e3:f,cuts:h.length},s+=p,o+=h.length}const a=n.length>0?n.reduce((l,h)=>l+(h.kerf||0),0)/n.length:0;return{bySheet:t,total:e==="m"?s/1e3:s,unit:e,totalCuts:o,avgKerf:e==="m"?a/1e3:a,details:i}}function dVe(){ph();const{basicInfo:n}=Pl(),{panels:e}=MWe(),{t}=ia(),{theme:i}=Ua(),{panels:r,setPanels:s,stock:o,setStock:a,settings:l,setSettings:h,selectedPanelId:u,setSelectedPanelId:d,currentSheetIndex:A,setCurrentSheetIndex:f,userHasModifiedPanels:p,setUserHasModifiedPanels:g,setPlacements:v,selectPanel:w,simulating:m,setSimulating:y,simSpeed:x,setSimSpeed:S,selectedCutIndex:I,selectCutIndex:j,selectedCutId:C,selectCutId:b,setSelectedSheetId:D,sawStats:T,setSawStats:k}=E0(),[B,E]=H.useState([]),[z,te]=H.useState(!1);H.useRef(null),H.useRef(null);const L=H.useRef([]),[O,J]=H.useState(1),[$,U]=H.useState(-90),[Y,K]=H.useState({x:0,y:0}),[V,Q]=H.useState(!0),[X,W]=H.useState(new Set),[se,q]=H.useState(!0),[de,Ce]=H.useState(!0),[Se,fe]=H.useState(!1),[M,Z]=H.useState(!1),[Ae,ie]=H.useState(0),[ee,ae]=H.useState(5e3),[me,_e]=H.useState(!1);H.useEffect(()=>{const Me=He=>{He.key==="Escape"&&d(null),B.length>0&&(He.key==="ArrowLeft"?(He.preventDefault(),f(ze=>Math.max(0,ze-1))):He.key==="ArrowRight"&&(He.preventDefault(),f(ze=>Math.min(B.length-1,ze+1))))},et=He=>{He.target.closest(".panel-clickable")||d(null)};return document.addEventListener("keydown",Me),document.addEventListener("click",et),()=>{document.removeEventListener("keydown",Me),document.removeEventListener("click",et)}},[d,B.length,f]);const ue=H.useRef(!1),Be=H.useRef(!1);H.useEffect(()=>{if(console.log("=== CNCOptimizerPro Initialization ==="),console.log("livePanels from hook:",e),console.log("livePanels.length:",e.length),console.log("current panels in store:",r),console.log("current stock in store:",o),e.length>0&&(g(!1),localStorage.removeItem("cnc_user_modified")),p&&e.length===0){console.log("User has modified panels and no live panels, keeping user panels");return}if(e.length===0&&(p&&r.some(et=>et.width>0&&et.length>0&&et.label!=="")||(console.log("No furniture placed, clearing all panels"),s([]),localStorage.removeItem("cnc_panels"),localStorage.removeItem("cnc_user_modified"),g(!1))),e.length>0){if(!Be.current||r.length===0){const Me=e.map(et=>{let He=et.width,ze=et.height;He>ze&&(He=et.height,ze=et.width);const Oe="V";let ke=et.material||"PB";const je=(et.name||"").toLowerCase();return(je.includes("도어")||je.includes("door")||je.includes("엔드")||je.includes("end"))&&(ke="PET"),{id:et.id,label:et.name||`Panel_${et.id}`,width:He,length:ze,thickness:et.thickness||18,quantity:et.quantity||1,material:ke,grain:Oe,canRotate:!0}});console.log("Setting panels from livePanels:",Me),s(Me),Be.current=!0}}else e.length===0&&!p&&!r.some(et=>et.width===0||et.length===0||et.label==="")&&r.length>0&&(console.log("No furniture placed and no user panels - clearing panels"),s([]));o.length===0&&a([{label:"PB_18T_2440x1220",width:1220,length:2440,thickness:18,quantity:999,material:"PB"},{label:"PET_18T_2440x1220",width:1220,length:2440,thickness:18,quantity:999,material:"PET"},{label:"MDF_18T_2440x1220",width:1220,length:2440,thickness:18,quantity:999,material:"MDF"},{label:"PB_15T_2440x1220",width:1220,length:2440,thickness:15,quantity:999,material:"PB"},{label:"MDF_9T_2440x1220",width:1220,length:2440,thickness:9,quantity:999,material:"MDF"},{label:"MDF_5T_2440x1220",width:1220,length:2440,thickness:5,quantity:999,material:"MDF"}]),dk()},[]),H.useEffect(()=>{if(p){console.log("User has modified panels, skipping livePanels sync");return}if(e.length>0&&!Be.current){console.log("Initializing from livePanels");const Me=e.map(et=>{let He=et.width,ze=et.height;He>ze&&(He=et.height,ze=et.width);const Oe="V";let ke=et.material||"PB";const je=(et.name||"").toLowerCase();return(je.includes("도어")||je.includes("door")||je.includes("엔드")||je.includes("end"))&&(ke="PET"),{id:et.id,label:et.name||`Panel_${et.id}`,width:He,length:ze,thickness:et.thickness||18,quantity:et.quantity||1,material:ke,grain:Oe,canRotate:!0}});s(Me),Be.current=!0}},[e,p,s]);const it=H.useCallback(async()=>{if(r.length===0){Fu(t("cnc.noPanelsError"),"error",t("common.confirm"));return}if(o.length===0){Fu(t("cnc.noStockError"),"error",t("common.confirm"));return}te(!0),fe(!1),E([]),L.current=[],Z(!0),ie(0);const Me=Date.now();window.cncSettings=l;const et=r.reduce((ke,je)=>ke+(je.quantity||1),0),He=Math.ceil(et/10);let ze=3e3;He>=30?ze=8e3:He>=20?ze=6e3:He>=10?ze=4e3:He>=5&&(ze=3500),ae(ze);const Oe=setInterval(()=>{const ke=Date.now()-Me,je=Math.min(ke/ze*100,95);ie(je),ke>=ze&&clearInterval(Oe)},50);await new Promise(ke=>setTimeout(ke,1e3));try{const ke=new Map;r.forEach(nt=>{const st={...nt};l.optimizationType==="OPTIMAL_CNC"?st.canRotate=!0:l.considerGrain&&nt.grain&&(nt.grain==="V"||nt.grain==="H")?st.canRotate=!1:(l.considerGrain,st.canRotate=!0);const At=l.considerMaterial?`${st.material||"PB"}_${st.thickness||18}`:`THICKNESS_${st.thickness||18}`;ke.has(At)||ke.set(At,[]),ke.get(At).push(st)});const je=[];for(const[nt,st]of ke){let At,ft;if(nt.startsWith("THICKNESS_"))ft=parseInt(nt.split("_")[1])||18;else{const Yt=nt.split("_");At=Yt[0],ft=parseInt(Yt[1])||18}let Xt;if(At&&(Xt=o.find(Yt=>Yt.material===At&&Yt.thickness===ft)),Xt||(Xt=o.find(Yt=>Yt.thickness===ft)),!Xt&&o.length>0&&(Xt=o[0]),Xt){const Yt={id:Xt.label||"stock",width:Xt.width,height:Xt.length,material:Xt.material||"PB",color:"MW",price:5e4,stock:Xt.quantity},Zt=st.map(Ye=>({id:Ye.id,name:Ye.label,width:Ye.width,height:Ye.length,thickness:Ye.thickness,quantity:Ye.quantity,material:Ye.material||"PB",color:"MW",grain:Ye.grain==="H"?"HORIZONTAL":(Ye.grain==="V","VERTICAL"),canRotate:Ye.canRotate})),sn={...Yt,width:Yt.width-(l.trimLeft||10)-(l.trimRight||10),height:Yt.height-(l.trimTop||10)-(l.trimBottom||10)};await new Promise(Ye=>setTimeout(Ye,300));const vt=await hVe(Zt,sn,l.singleSheetOnly?1:999,l.alignVerticalCuts!==!1,l.kerf||5,l.optimizationType||"OPTIMAL_CNC");vt.forEach(Ye=>{Ye.panels.forEach(Gt=>{Gt.x+=l.trimLeft||10,Gt.y+=l.trimBottom||10}),Ye.stockPanel=Yt}),je.push(...vt)}}const rt=[...je];L.current=rt;const _t=[];rt.forEach((nt,st)=>{nt.panels.forEach(At=>{_t.push({sheetId:String(st+1),panelId:At.id,x:At.x,y:At.y,width:At.width,height:At.height,rotated:At.rotated})})}),v(_t);const Ee=je.length;let Le=3e3;Ee>=30?Le=8e3:Ee>=20?Le=6e3:Ee>=10?Le=4e3:Ee>=5&&(Le=3500);const ye=Date.now()-Me,Ze=Math.max(0,Le-ye);setTimeout(()=>{clearInterval(Oe),ie(100),setTimeout(async()=>{if(Z(!1),ie(0),je.length>0){const nt=je.reduce((At,ft)=>At+ft.panels.length,0),st=je.reduce((At,ft)=>At+ft.efficiency,0)/je.length;await Fu(t("cnc.optimizationComplete",{panels:nt,sheets:je.length,efficiency:st.toFixed(1)}),"success",t("common.confirm")),E(L.current),A>=L.current.length&&L.current.length>0?f(L.current.length-1):A<0&&L.current.length>0&&f(0),L.current=[]}else await Fu(t("cnc.optimizationFailed"),"error",t("common.confirm"))},300)},Ze)}catch{clearInterval(Oe),Z(!1),ie(0),Fu(t("cnc.optimizationError"),"error",t("common.confirm"))}finally{te(!1)}},[r,o,l,v,f,k]);H.useEffect(()=>{!ue.current&&e.length>0&&r.length>0&&o.length>0&&(ue.current=!0,setTimeout(()=>{it()},100))},[e,r,o,it]);const De=(n==null?void 0:n.title)||"New Project",qe=()=>{const[Me,et]=H.useState(!1),He=H.useRef(null),ze={OPTIMAL_L:t("cnc.optimalL"),OPTIMAL_W:t("cnc.optimalW"),OPTIMAL_CNC:t("cnc.optimalCNC")};H.useEffect(()=>{const ke=je=>{He.current&&!He.current.contains(je.target)&&et(!1)};return Me&&document.addEventListener("mousedown",ke),()=>{document.removeEventListener("mousedown",ke)}},[Me]);const Oe=ke=>{h({optimizationType:ke}),et(!1),fe(!0)};return c.jsxs("div",{className:Fn.dropdownContainer,ref:He,children:[c.jsxs("button",{className:Fn.dropdownButton,onClick:()=>et(!Me),children:[c.jsx("span",{children:ze[l.optimizationType||"OPTIMAL_CNC"]}),c.jsx(lf,{size:14,className:Me?Fn.rotated:""})]}),Me&&c.jsx("div",{className:Fn.dropdownMenu,children:Object.entries(ze).map(([ke,je])=>c.jsx("button",{className:`${Fn.dropdownItem} ${l.optimizationType===ke?Fn.active:""}`,onClick:()=>Oe(ke),children:je},ke))})]})},Je=H.useMemo(()=>{if(B.length===0)return[];const Me=[];let et=0;return B.forEach((He,ze)=>{const Oe=String(ze+1);He.panels.forEach(ke=>{const je={x:ke.x,y:ke.y,width:ke.width,height:ke.height};MK({mode:l.optimizationType==="OPTIMAL_CNC"?"free":"guillotine",sheetW:He.stockPanel.width,sheetH:He.stockPanel.height,kerf:l.kerf||5,placement:je,sheetId:Oe,panelId:ke.id}).forEach((_t,Ee)=>{Me.push({..._t,id:`s${ze}_p${ke.id}_c${Ee}`,globalOrder:++et,sheetNumber:ze+1,panelInfo:ke})})})}),Me},[B,V,l.optimizationType,l.kerf]);return H.useEffect(()=>{if(Je.length>0){const Me=uVe(Je,"m");k(Me)}},[Je,k]),c.jsxs("div",{className:Fn.container,children:[c.jsxs("div",{className:Fn.header,children:[c.jsxs("div",{className:Fn.headerLeft,children:[c.jsx(eS,{size:"small"}),c.jsx("h1",{children:t("cnc.title")}),c.jsx("span",{className:Fn.projectName,children:De})]}),c.jsxs("div",{className:Fn.headerRight,children:[c.jsx(qe,{}),c.jsx("div",{className:Fn.divider}),c.jsxs("button",{className:`${Fn.calculateButton} ${Se?Fn.highlighted:""}`,onClick:it,disabled:z||r.length===0,children:[c.jsx(h6,{size:18}),c.jsx("span",{children:t("cnc.calculate")})]}),c.jsx("div",{className:Fn.exportGroup,children:c.jsx(Nze,{optimizationResults:B})}),c.jsx("div",{className:Fn.divider}),c.jsxs("button",{className:Fn.exitButton,onClick:Me=>{Me.preventDefault(),Me.stopPropagation(),_e(!0)},type:"button",children:[c.jsx(r8,{size:16}),t("cnc.exit")]})]})]}),c.jsxs("div",{className:Fn.main,children:[c.jsxs("div",{className:Fn.leftSidebar,children:[c.jsx(pze,{}),c.jsx(mze,{}),c.jsx(yze,{onSettingsChange:it})]}),c.jsx("div",{className:Fn.centerPanel,children:B.length>0?c.jsxs("div",{className:Fn.viewerContainer,children:[B.length>1&&c.jsx("div",{className:Fn.keyboardHint,children:c.jsxs("span",{children:["← → ",t("cnc.keyboardNavigationHint")]})}),c.jsx("div",{className:Fn.mainViewer,children:c.jsx(aQe,{result:B[A],highlightedPanelId:u,showLabels:l.labelsOnPanels,onPanelClick:Me=>d(Me),allowRotation:!l.considerGrain,scale:O,rotation:$,offset:Y,onScaleChange:J,onRotationChange:U,onOffsetChange:K,sheetInfo:{currentIndex:A,totalSheets:B.length,onOptimize:it,isOptimizing:z,stock:o},onCurrentSheetIndexChange:f,showCuttingListTab:V,allCutSteps:Je})}),c.jsx("div",{className:Fn.thumbnailBar,children:c.jsx("div",{className:Fn.thumbnailScroll,children:B.map((Me,et)=>c.jsx(S$e,{result:Me,index:et,isActive:et===A,onClick:()=>f(et),viewerScale:et===A?O:1,viewerRotation:et===A?$:0,viewerOffset:et===A?Y:{x:0,y:0},highlightedPanelId:et===A?u:null},et))})})]}):c.jsxs("div",{className:Fn.emptyPreview,children:[c.jsx(VV,{size:48}),c.jsx("h3",{children:t("cnc.noResults")}),c.jsx("p",{children:t("cnc.setupHint")}),c.jsx("button",{className:`${Fn.optimizeButtonLarge} ${Fn.primary}`,onClick:it,disabled:z,children:t(z?"cnc.optimizing":"cnc.generatePanels")})]})}),c.jsx("div",{className:Fn.rightSidebar,children:c.jsxs("div",{className:Fn.rightSidebarContent,children:[c.jsxs("div",{className:Fn.statsCard,children:[c.jsxs("div",{className:Fn.statsCardTitle,children:[c.jsx("h3",{children:t("cnc.totalStats")}),c.jsx("button",{className:Fn.foldButton,onClick:()=>q(!se),children:se?c.jsx(c6,{size:14}):c.jsx(lf,{size:14})})]}),se&&c.jsxs("div",{className:Fn.statsDetail,children:[c.jsxs("div",{className:Fn.statRow,children:[c.jsx("span",{children:t("cnc.sheets")}),c.jsx("div",{className:Fn.statValue,children:c.jsx("strong",{children:B.length})})]}),c.jsxs("div",{className:Fn.statRow,children:[c.jsx("span",{children:t("cnc.usedArea")}),c.jsxs("div",{className:Fn.statValue,children:[c.jsx("strong",{children:(B.reduce((Me,et)=>Me+et.usedArea,0)/1e6).toFixed(1)}),c.jsxs("span",{className:Fn.statPercent,children:[B.length>0?Math.round(B.reduce((Me,et)=>Me+et.efficiency,0)/B.length):0,"%"]})]})]}),c.jsxs("div",{className:Fn.statRow,children:[c.jsx("span",{children:t("cnc.wasteArea")}),c.jsxs("div",{className:Fn.statValue,children:[c.jsx("strong",{children:(B.reduce((Me,et)=>Me+et.wasteArea,0)/1e6).toFixed(1)}),c.jsxs("span",{className:Fn.statPercent,children:[B.length>0?Math.round(100-B.reduce((Me,et)=>Me+et.efficiency,0)/B.length):0,"%"]})]})]}),c.jsxs("div",{className:Fn.statRow,children:[c.jsx("span",{children:t("cnc.totalPanels")}),c.jsx("div",{className:Fn.statValue,children:c.jsx("strong",{children:B.reduce((Me,et)=>Me+et.panels.length,0)})})]}),c.jsxs("div",{className:Fn.statRow,children:[c.jsx("span",{children:t("cnc.cutCount")}),c.jsx("div",{className:Fn.statValue,children:c.jsx("strong",{children:Je.length})})]}),c.jsxs("div",{className:Fn.statRow,children:[c.jsx("span",{children:t("cnc.cutLength")}),c.jsx("div",{className:Fn.statValue,children:c.jsxs("strong",{children:[T.total.toFixed(2),"m"]})})]}),c.jsxs("div",{className:Fn.statRow,children:[c.jsx("span",{children:t("cnc.bladeThickness")}),c.jsx("div",{className:Fn.statValue,children:c.jsxs("strong",{children:[l.kerf||5,"mm"]})})]}),c.jsxs("div",{className:Fn.statRow,children:[c.jsx("span",{children:t("cnc.stock")}),c.jsx("div",{className:Fn.statValue,children:o.length>0?`${o[0].width}×${o[0].length}`:"-"})]}),c.jsxs("div",{className:Fn.statRow,children:[c.jsx("span",{children:t("cnc.optimization")}),c.jsx("div",{className:Fn.statValue,children:l.optimizationType==="OPTIMAL_CNC"?t("cnc.minWaste"):l.optimizationType==="BY_LENGTH"?t("cnc.verticalCut"):t("cnc.horizontalCut")})]})]})]}),B[A]&&c.jsxs("div",{className:Fn.statsCard,children:[c.jsxs("div",{className:Fn.statsCardTitle,children:[c.jsx("h3",{children:t("cnc.sheetStats")}),c.jsx("button",{className:Fn.foldButton,onClick:()=>Ce(!de),children:de?c.jsx(c6,{size:14}):c.jsx(lf,{size:14})})]}),de&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:Fn.statsCardHeader,children:[c.jsx("button",{className:Fn.statsNavButton,onClick:()=>f(Math.max(0,A-1)),disabled:A===0,children:c.jsx(Qwe,{size:14})}),c.jsxs("h3",{children:[t("cnc.sheet")," ",A+1," / ",B.length]}),c.jsx("button",{className:Fn.statsNavButton,onClick:()=>f(Math.min(B.length-1,A+1)),disabled:A===B.length-1,children:c.jsx(e8,{size:14})}),c.jsx("button",{className:`${Fn.playButton} ${m?Fn.playing:""}`,onClick:()=>{m?y(!1):(d(null),D(String(A+1)),y(!0))},title:m?"시뮬레이션 정지":"컷팅 시뮬레이션",children:m?c.jsx(ZV,{size:14}):c.jsx(h6,{size:14})})]}),c.jsxs("div",{className:Fn.statsDetail,children:[c.jsxs("div",{className:Fn.statRow,children:[c.jsx("span",{children:t("cnc.panelCount")}),c.jsx("div",{className:Fn.statValue,children:c.jsx("strong",{children:B[A].panels.length})})]}),c.jsxs("div",{className:Fn.statRow,children:[c.jsx("span",{children:t("cnc.efficiency")}),c.jsx("div",{className:Fn.statValue,children:c.jsxs("strong",{children:[B[A].efficiency.toFixed(1),"%"]})})]}),c.jsxs("div",{className:Fn.statRow,children:[c.jsx("span",{children:t("cnc.usedArea")}),c.jsx("div",{className:Fn.statValue,children:c.jsxs("strong",{children:[(B[A].usedArea/1e6).toFixed(2),"㎡"]})})]}),c.jsxs("div",{className:Fn.statRow,children:[c.jsx("span",{children:t("cnc.wasteArea")}),c.jsx("div",{className:Fn.statValue,children:c.jsxs("strong",{children:[(B[A].wasteArea/1e6).toFixed(2),"㎡"]})})]}),c.jsxs("div",{className:Fn.statRow,children:[c.jsx("span",{children:t("cnc.cutCount")}),c.jsx("div",{className:Fn.statValue,children:c.jsx("strong",{children:Je.filter(Me=>Me.sheetNumber===A+1).length})})]}),c.jsxs("div",{className:Fn.statRow,children:[c.jsx("span",{children:t("cnc.cutLength")}),c.jsx("div",{className:Fn.statValue,children:c.jsx("strong",{children:T.bySheet[String(A+1)]?T.bySheet[String(A+1)].toFixed(2)+"m":"0.00m"})})]})]})]})]}),B.length>0&&c.jsxs("div",{className:`${Fn.statsCard} ${Fn.sheetListCard}`,children:[c.jsx("div",{className:Fn.sheetListHeader,children:c.jsxs("div",{className:Fn.tabButtons,children:[c.jsx("button",{className:`${Fn.tabButton} ${V?"":Fn.active}`,onClick:()=>Q(!1),children:t("cnc.sheetList")}),c.jsx("button",{className:`${Fn.tabButton} ${V?Fn.active:""}`,onClick:()=>Q(!0),children:t("cnc.cuttingList")})]})}),V?c.jsxs("div",{className:Fn.cutsList,children:[c.jsxs("div",{className:Fn.cutsTableHeader,children:[c.jsx("span",{className:Fn.cutsCol1,children:"#"}),c.jsx("span",{className:Fn.cutsCol2,children:"Panel"}),c.jsx("span",{className:Fn.cutsCol3,children:"Cut"}),c.jsx("span",{className:Fn.cutsCol4,children:"Result"})]}),c.jsx("div",{className:Fn.cutsTableBody,children:(()=>{const Me=new Map;Je.forEach(ze=>{Me.has(ze.sheetNumber)||Me.set(ze.sheetNumber,[]),Me.get(ze.sheetNumber).push(ze)});let et=0;const He=[];for(const[ze,Oe]of Me)Oe.forEach((ke,je)=>{var _t,Ee;const rt=et++;He.push(c.jsxs("div",{className:`${Fn.cutsRow} ${C===ke.id?Fn.selected:""}`,onClick:()=>{D(ke.sheetId),b(ke.id),ke.yieldsPanelId&&(w(ke.yieldsPanelId,ke.sheetId),f(ke.sheetNumber-1)),j(rt)},onDoubleClick:()=>{ke.yieldsPanelId&&(w(ke.yieldsPanelId,ke.sheetId),f(ke.sheetNumber-1),y(!0))},children:[c.jsx("span",{className:Fn.cutsCol1,children:je+1}),c.jsx("span",{className:Fn.cutsCol2,children:pR(ke.before.width,ke.before.length)}),c.jsx("span",{className:Fn.cutsCol3,children:`${ke.axis}=${Math.round(ke.pos)}`}),c.jsx("span",{className:Fn.cutsCol4,children:ke.yieldsPanelId?`${pR(((_t=ke.after)==null?void 0:_t.width)||0,((Ee=ke.after)==null?void 0:Ee.length)||0)} \\ -`:"- \\ surplus"})]},`cut-${ze}-${je}`))});return He})()})]}):c.jsx("div",{className:Fn.sheetList,children:B.map((Me,et)=>{const He=Me.stockPanel.id||`${Me.stockPanel.material}_${Me.stockPanel.width}x${Me.stockPanel.height}`,ze=X.has(et);return c.jsxs("div",{className:Fn.sheetItemContainer,children:[c.jsxs("div",{className:`${Fn.sheetItem} ${et===A?Fn.active:""}`,onClick:()=>{f(et),W(Oe=>{const ke=new Set(Oe);return ke.has(et)||ke.add(et),ke})},children:[c.jsx("button",{className:Fn.expandButton,onClick:Oe=>{Oe.stopPropagation(),W(ke=>{const je=new Set(ke);return je.has(et)?je.delete(et):je.add(et),je})},children:ze?c.jsx(lf,{size:14}):c.jsx(__,{size:14})}),c.jsx("span",{className:Fn.sheetNumber,children:et+1}),c.jsx("span",{className:Fn.sheetInfo,children:He}),c.jsxs("span",{className:Fn.sheetPanels,children:[Me.panels.length,"개"]}),c.jsxs("span",{className:Fn.sheetEfficiency,children:[Me.efficiency.toFixed(0),"%"]})]}),ze&&c.jsx("div",{className:Fn.panelListContainer,children:Me.panels.map((Oe,ke)=>c.jsxs("div",{className:`${Fn.panelItem} ${u===Oe.id?Fn.selectedPanel:""} panel-clickable`,onClick:je=>{je.stopPropagation();const rt=Oe.id;d(rt),f(et)},children:[c.jsx("span",{className:Fn.panelName,children:Oe.name||`Panel ${Oe.id}`}),c.jsxs("span",{className:Fn.panelSize,children:[Math.round(Oe.width)," × ",Math.round(Oe.height)]})]},`panel-${et}-${ke}`))})]},et)})})]})]})})]}),c.jsx(G$e,{isOpen:M,progress:Ae,message:t("cnc.aiOptimizing"),duration:ee}),c.jsx(oVe,{isOpen:me,onConfirm:()=>{console.log("Exit confirmed! Navigating to configurator..."),window.location.href="/configurator"},onCancel:()=>_e(!1)})]})}function AVe(){return c.jsx(kWe,{children:c.jsx(dVe,{})})}const Cp=w1(n=>({mode:"BY_LENGTH",kerfMm:3,sheets:[],panels:[],placements:[],cuts:[],selectedCutId:void 0,selectedSheetId:void 0,sawStats:{bySheet:{},total:0,unit:"m"},cncStats:{cycleTimeSec:0,cutLenMm:0,airLenMm:0,toolChanges:0},setMode:e=>n(()=>({mode:e,selectedCutId:void 0})),setSelectedSheetId:e=>n(()=>({selectedSheetId:e})),selectCutId:e=>n(()=>({selectedCutId:e})),setKerf:e=>n(()=>({kerfMm:e})),setSheets:e=>n(()=>({sheets:e})),setPanels:e=>n(()=>({panels:e})),setPlacements:e=>n(()=>({placements:e})),setCuts:e=>n(()=>({cuts:e})),setSawStats:e=>n(()=>({sawStats:e})),setCNCStats:e=>n(()=>({cncStats:e}))}));function fVe(n,e,t){const i=n.trim.left,r=n.trim.top,s=n.width-i-n.trim.right,o=n.length-r-n.trim.bottom,a=[];t.forEach(m=>{for(let y=0;y<m.qty;y++){let x=m.width,S=m.length;const I=m.grain==="length",j=m.grain==="width";if(m.canRotate&&!I&&!j&&x>S){const b=x;x=S,S=b}if(I&&x>S){const b=x;x=S,S=b}if(j&&S>x){const b=x;x=S,S=b}a.push({id:m.id,w:x,l:S,canRotate:m.canRotate,grain:m.grain})}}),a.sort((m,y)=>y.w-m.w||y.l-m.l);const l=[],h=e,u=m=>{for(const S of l)if(m.w<=S.w){const I=r+S.usedL+(S.rows.length?e:0);if(I-r+m.l<=o+1e-6)return S.rows.push({id:m.id,y:I,l:m.l,w:m.w}),S.usedL=I-r+m.l,!0}const y=i+l.reduce((S,I)=>S+I.w+h,0);if(y-i+m.w>s+1e-6)return!1;const x={x:y,w:m.w,usedL:0,rows:[]};return x.rows.push({id:m.id,y:r,l:m.l,w:m.w}),x.usedL=m.l,l.push(x),!0};a.forEach(u);const d=[];for(const m of l)for(const y of m.rows)d.push({sheetId:n.id,panelId:y.id,x:m.x,y:y.y,width:m.w,length:y.l});const A=[];let f=1;for(const m of l){const y=r,x=r+o;A.push({id:`c${f}`,sheetId:n.id,order:f++,axis:"x",pos:m.x,spanStart:y,spanEnd:x,source:"derived"}),A.push({id:`c${f}`,sheetId:n.id,order:f++,axis:"x",pos:m.x+m.w,spanStart:y,spanEnd:x,source:"derived"})}const p=new Set;for(const m of l)for(const y of m.rows)p.add(y.y),p.add(y.y+y.l);const g=[...p].sort((m,y)=>m-y),v=i,w=i+s;for(const m of g)A.push({id:`c${f}`,sheetId:n.id,order:f++,axis:"y",pos:m,spanStart:v,spanEnd:w,source:"derived"});return{placements:d,cuts:A}}function pVe(n,e,t){const i=n.trim.left,r=n.trim.top,s=n.width-i-n.trim.right,o=n.length-r-n.trim.bottom,a=[];t.forEach(m=>{for(let y=0;y<m.qty;y++){let x=m.width,S=m.length;const I=m.grain==="length",j=m.grain==="width";if(m.canRotate&&!I&&!j&&S>x){const b=x;x=S,S=b}if(I&&x>S){const b=x;x=S,S=b}if(j&&S>x){const b=x;x=S,S=b}a.push({id:m.id,w:x,l:S,canRotate:m.canRotate,grain:m.grain})}}),a.sort((m,y)=>y.l-m.l||y.w-m.w);const l=[],h=e,u=m=>{for(const S of l)if(m.h<=S.h){const I=i+S.usedW+(S.cells.length?e:0);if(I-i+m.w<=s+1e-6)return S.cells.push({id:m.id,x:I,w:m.w,h:m.h}),S.usedW=I-i+m.w,!0}const y=r+l.reduce((S,I)=>S+I.h+h,0);if(y-r+m.h>o+1e-6)return!1;const x={y,h:m.h,usedW:0,cells:[]};return x.cells.push({id:m.id,x:i,w:m.w,h:m.h}),x.usedW=m.w,l.push(x),!0};a.forEach(({id:m,w:y,l:x})=>u({id:m,w:y,h:x}));const d=[];for(const m of l)for(const y of m.cells)d.push({sheetId:n.id,panelId:y.id,x:y.x,y:m.y,width:y.w,length:m.h});const A=[];let f=1;for(const m of l){const y=i,x=i+s;A.push({id:`c${f}`,sheetId:n.id,order:f++,axis:"y",pos:m.y,spanStart:y,spanEnd:x,source:"derived"}),A.push({id:`c${f}`,sheetId:n.id,order:f++,axis:"y",pos:m.y+m.h,spanStart:y,spanEnd:x,source:"derived"})}const p=new Set;for(const m of l)for(const y of m.cells)p.add(y.x),p.add(y.x+y.w);const g=[...p].sort((m,y)=>m-y),v=r,w=r+o;for(const m of g)A.push({id:`c${f}`,sheetId:n.id,order:f++,axis:"x",pos:m,spanStart:v,spanEnd:w,source:"derived"});return{placements:d,cuts:A}}function gVe(n,e,t){const i=n.trim.left,r=n.trim.top,s=n.width-i-n.trim.right,o=n.length-r-n.trim.bottom,a=[];t.forEach(D=>{for(let T=0;T<D.qty;T++)if(D.canRotate&&D.grain==="none"){const k={id:D.id,w:D.width,l:D.length,rotated:!1,area:D.width*D.length},B={id:D.id,w:D.length,l:D.width,rotated:!0,area:D.width*D.length},E=s/o,z=k.w/k.l,te=B.w/B.l,L=Math.abs(E-z),O=Math.abs(E-te);a.push(L<=O?k:B)}else a.push({id:D.id,w:D.width,l:D.length,rotated:!1,area:D.width*D.length})}),a.sort((D,T)=>Math.abs(T.area-D.area)>1?T.area-D.area:Math.max(T.w,T.l)-Math.max(D.w,D.l));const l=[],h=e;let u=[{x:i,y:r,w:s,h:o}];for(const D of a){let T=null,k=1/0,B=-1;for(let te=0;te<u.length;te++){const L=u[te];if(D.w+h<=L.w&&D.l+h<=L.h){const O=L.w-D.w-h,J=L.h-D.l-h,$=Math.min(O,J);$<k&&(k=$,T=L,B=te)}}if(!T)continue;l.push({sheetId:n.id,panelId:D.id,x:T.x,y:T.y,width:D.w,length:D.l,rotated:D.rotated}),u.splice(B,1);const E=T.x+D.w+h,z=T.y+D.l+h;E<T.x+T.w&&u.push({x:E,y:T.y,w:T.x+T.w-E,h:D.l+h}),z<T.y+T.h&&u.push({x:T.x,y:z,w:T.w,h:T.y+T.h-z}),u=d(u)}function d(D){return D.filter(T=>T.w>h&&T.h>h)}const A=[];let f=1;const p=new Set,g=new Set;for(const D of l)p.add(D.x),p.add(D.x+D.width),g.add(D.y),g.add(D.y+D.length);const v=i,w=i+s,m=r,y=r+o;[...p].sort((D,T)=>D-T).forEach(D=>A.push({id:`c${f}`,sheetId:n.id,order:f++,axis:"x",pos:D,spanStart:m,spanEnd:y,source:"derived"})),[...g].sort((D,T)=>D-T).forEach(D=>A.push({id:`c${f}`,sheetId:n.id,order:f++,axis:"y",pos:D,spanStart:v,spanEnd:w,source:"derived"}));const x=A.reduce((D,T)=>D+Math.abs(T.spanEnd-T.spanStart),0),S=A.length*50,I=1,b=x/12e3+S/24e3;return{placements:l,cuts:A,cnc:{cycleTimeSec:b,cutLenMm:x,airLenMm:S,toolChanges:I}}}function mVe(n){const e=new Map;for(const i of n){const r=`${i.sheetId}|${i.axis}|${i.pos.toFixed(3)}`,s=Math.min(i.spanStart,i.spanEnd),o=Math.max(i.spanStart,i.spanEnd);e.has(r)||e.set(r,[]),e.get(r).push([s,o])}let t=0;for(const[,i]of e){i.sort((o,a)=>o[0]-a[0]);let[r,s]=i[0];for(let o=1;o<i.length;o++){const[a,l]=i[o];a<=s?s=Math.max(s,l):(t+=s-r,r=a,s=l)}t+=s-r}return t}function RK(n,e="m"){const t={},i=new Map;for(const s of n)i.has(s.sheetId)||i.set(s.sheetId,[]),i.get(s.sheetId).push(s);let r=0;for(const[s,o]of i){const a=mVe(o);t[s]=e==="m"?a/1e3:a,r+=a}return{bySheet:t,total:e==="m"?r/1e3:r,unit:e}}function UK(n,e){const t=n.reduce((r,s)=>r+s.width*s.length,0),i=e.reduce((r,s)=>r+(s.width-s.trim.left-s.trim.right)*(s.length-s.trim.top-s.trim.bottom),0);return i>0?Math.max(0,1-t/i):0}function yVe(){const n=Cp.getState();if(console.log("Recalc called with mode:",n.mode),console.log("Panels:",n.panels),console.log("Sheets:",n.sheets),n.sheets.length===0)return;const e=[],t=[];let i=[...n.panels];const r={cycleTimeSec:0,cutLenMm:0,airLenMm:0,toolChanges:0};for(const o of n.sheets){if(i.length===0)break;let a=[],l=[],h;if(n.mode==="BY_LENGTH"){console.log("Using BY_LENGTH for sheet",o.id);const d=fVe(o,n.kerfMm,i);a=d.placements,l=d.cuts,console.log("BY_LENGTH placements:",a)}else if(n.mode==="BY_WIDTH"){const d=pVe(o,n.kerfMm,i);a=d.placements,l=d.cuts}else{const d=gVe(o,n.kerfMm,i);a=d.placements,l=d.cuts,h=d.cnc,h&&(r.cycleTimeSec+=h.cycleTimeSec,r.cutLenMm+=h.cutLenMm,r.airLenMm+=h.airLenMm,r.toolChanges+=h.toolChanges)}e.push(...a),t.push(...l);const u=new Map;a.forEach(d=>{u.set(d.panelId,(u.get(d.panelId)||0)+1)}),i=i.reduce((d,A)=>{const f=u.get(A.id)||0,p=A.qty-f;return p>0&&d.push({...A,qty:p}),d},[])}Cp.setState({placements:e,cuts:t}),Cp.getState().setSawStats(RK(t,"m")),n.mode==="OPTIMAL_CNC"&&Cp.getState().setCNCStats(r);const s=UK(e,n.sheets);console.log("Final placements:",e),console.log("Final cuts:",t),console.log("waste",s)}const wVe="_container_1cnfa_1",vVe="_tab_1cnfa_9",xVe="_active_1cnfa_29",KT={container:wVe,tab:vVe,active:xVe};function bVe(){const{settings:n,setSettings:e}=E0(),t=n.optimizationType||"OPTIMAL_CNC",i=r=>{console.log("Switching to mode:",r),e({optimizationType:r})};return c.jsx("div",{className:KT.container,children:["BY_LENGTH","BY_WIDTH","OPTIMAL_CNC"].map(r=>c.jsx("button",{onClick:()=>i(r),className:`${KT.tab} ${t===r?KT.active:""}`,children:r==="BY_LENGTH"?c.jsxs(c.Fragment,{children:[c.jsx(Vwe,{size:14}),"L방향 우선"]}):r==="BY_WIDTH"?c.jsxs(c.Fragment,{children:[c.jsx(Wwe,{size:14}),"W방향 우선"]}):c.jsxs(c.Fragment,{children:[c.jsx(VV,{size:14}),"CNC 최적화"]})},r))})}const CVe="_container_1sqpg_1",_Ve="_header_1sqpg_11",SVe="_tabs_1sqpg_27",TVe="_tab_1sqpg_27",BVe="_activeTab_1sqpg_49",EVe="_sheetInfo_1sqpg_60",FVe="_preview_1sqpg_65",kVe="_sheet_1sqpg_60",IVe="_panel_1sqpg_82",DVe="_cut_1sqpg_90",jVe="_cutX_1sqpg_98",PVe="_cutY_1sqpg_102",NVe="_selected_1sqpg_106",LVe="_selectedCut_1sqpg_110",dc={container:CVe,header:_Ve,tabs:SVe,tab:TVe,activeTab:BVe,sheetInfo:EVe,preview:FVe,sheet:kVe,panel:IVe,cut:DVe,cutX:jVe,cutY:PVe,selected:NVe,selectedCut:LVe};function MVe(){const{sheets:n,cuts:e,selectedSheetId:t,selectedCutId:i,kerfMm:r,placements:s,setSelectedSheetId:o}=Cp(),[a,l]=H.useState(0),h=H.useMemo(()=>n[a]||n[0],[n,a]),u=H.useMemo(()=>(t?e.filter(x=>x.sheetId===t):e).sort((x,S)=>x.order-S.order),[e,t]),d=H.useMemo(()=>u.find(x=>x.id===i),[u,i]),A=H.useRef(null),[f,p]=H.useState(1);H.useEffect(()=>{if(!A.current||!h)return;const x=20,S=A.current.clientWidth-x*2,I=A.current.clientHeight-x*2;p(Math.min(S/(h.width||1),I/(h.length||1)))},[h]);const g=20,v=x=>Math.round(x*f)+g,w=x=>Math.round(x*f)+g,m=H.useMemo(()=>h?s.filter(x=>x.sheetId===h.id):[],[s,h]),y=H.useMemo(()=>{const x=new Set(s.map(S=>S.sheetId));return n.filter(S=>x.has(S.id))},[n,s]);return c.jsxs("div",{className:dc.container,children:[c.jsxs("div",{className:dc.header,children:[c.jsx("h3",{children:"Sheet Preview"}),c.jsx("div",{className:dc.tabs,children:y.map((x,S)=>{var I;return c.jsxs("button",{className:`${dc.tab} ${((I=n[a])==null?void 0:I.id)===x.id?dc.activeTab:""}`,onClick:()=>{const j=n.findIndex(C=>C.id===x.id);l(j)},children:["Sheet ",S+1]},x.id)})}),h&&c.jsxs("span",{className:dc.sheetInfo,children:[h.width," × ",h.length,"mm"]})]}),c.jsxs("div",{ref:A,className:dc.preview,children:[h&&c.jsx("div",{className:dc.sheet,style:{left:g,top:g,width:v(h.width)-g,height:w(h.length)-g}}),m.map((x,S)=>c.jsx("div",{className:dc.panel,style:{left:v(x.x),top:w(x.y),width:v(x.x+x.width)-v(x.x),height:w(x.y+x.length)-w(x.y)},title:`${x.panelId}: ${x.width}×${x.length}mm`},`${x.panelId}-${S}`)),u.map(x=>{const S=Math.max(1,r*f),I=Math.min(x.spanStart,x.spanEnd),j=Math.max(x.spanStart,x.spanEnd);if(x.axis==="x"){const C=v(x.pos),b=w(I),D=w(j);return c.jsx("div",{className:`${dc.cut} ${dc.cutX} ${x.id===i?dc.selected:""}`,style:{left:C-Math.floor(S/2),top:b,width:S,height:D-b},title:`x=${x.pos}`},x.id)}else{const C=w(x.pos),b=v(I),D=v(j);return c.jsx("div",{className:`${dc.cut} ${dc.cutY} ${x.id===i?dc.selected:""}`,style:{top:C-Math.floor(S/2),left:b,height:S,width:D-b},title:`y=${x.pos}`},x.id)}}),d&&h&&(()=>{const x=Math.max(2,r*f),S=Math.min(d.spanStart,d.spanEnd),I=Math.max(d.spanStart,d.spanEnd);if(d.axis==="x"){const j=v(d.pos),C=w(S),b=w(I);return c.jsx("div",{className:dc.selectedCut,style:{left:j-Math.floor(x/2),top:C,width:x,height:b-C},title:`x=${d.pos}`})}else{const j=w(d.pos),C=v(S),b=v(I);return c.jsx("div",{className:dc.selectedCut,style:{top:j-Math.floor(x/2),left:C,height:x,width:b-C},title:`y=${d.pos}`})}})()]})]})}const mR=n=>n?`${Math.round(n.w)}×${Math.round(n.l)}`:"-",RVe=n=>`${n.axis}=${Math.round(n.pos)}`,UVe=n=>`${mR(n.made)} \\ ${n.surplus?`surplus ${mR(n.surplus)}`:"-"}`,OVe="_container_17e3s_1",HVe="_header_17e3s_11",WVe="_tableWrapper_17e3s_24",zVe="_table_17e3s_24",QVe="_selected_17e3s_64",$Ve="_result_17e3s_74",nm={container:OVe,header:HVe,tableWrapper:WVe,table:zVe,selected:QVe,result:$Ve};function VVe(){const{cuts:n,selectedSheetId:e,selectedCutId:t,selectCutId:i,setSelectedSheetId:r}=Cp(),s=H.useMemo(()=>(e?n.filter(o=>o.sheetId===e):n).sort((o,a)=>o.order-a.order),[n,e]);return c.jsxs("div",{className:nm.container,children:[c.jsx("div",{className:nm.header,children:c.jsx("h3",{children:"절단 목록"})}),c.jsx("div",{className:nm.tableWrapper,children:c.jsxs("table",{className:nm.table,children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"#"}),c.jsx("th",{children:"패널"}),c.jsx("th",{children:"절단"}),c.jsx("th",{children:"결과"})]})}),c.jsx("tbody",{children:s.map((o,a)=>c.jsxs("tr",{onClick:()=>{r(o.sheetId),i(o.id)},className:o.id===t?nm.selected:"",children:[c.jsx("td",{children:a+1}),c.jsx("td",{children:o.before?`${Math.round(o.before.w)}×${Math.round(o.before.l)}`:"-"}),c.jsx("td",{children:RVe(o)}),c.jsx("td",{className:nm.result,children:UVe(o)})]},o.id))})]})})]})}const GVe="_container_vow97_1",XVe="_header_vow97_8",YVe="_stats_vow97_21",KVe="_statItem_vow97_28",qVe="_label_vow97_40",ZVe="_value_vow97_46",Ja={container:GVe,header:XVe,stats:YVe,statItem:KVe,label:qVe,value:ZVe};function JVe(){const{cuts:n,placements:e,sheets:t,mode:i,cncStats:r}=Cp(),s=H.useMemo(()=>RK(n,"m"),[n]),o=H.useMemo(()=>UK(e,t)*100,[e,t]);return c.jsxs("div",{className:Ja.container,children:[c.jsx("div",{className:Ja.header,children:c.jsx("h3",{children:"통계"})}),c.jsxs("div",{className:Ja.stats,children:[c.jsxs("div",{className:Ja.statItem,children:[c.jsx("span",{className:Ja.label,children:"폐기율"}),c.jsxs("span",{className:Ja.value,children:[o.toFixed(1),"%"]})]}),c.jsxs("div",{className:Ja.statItem,children:[c.jsx("span",{className:Ja.label,children:"Used Sheets"}),c.jsx("span",{className:Ja.value,children:new Set(e.map(a=>a.sheetId)).size})]}),c.jsxs("div",{className:Ja.statItem,children:[c.jsx("span",{className:Ja.label,children:"절단 수"}),c.jsx("span",{className:Ja.value,children:n.length})]}),c.jsxs("div",{className:Ja.statItem,children:[c.jsx("span",{className:Ja.label,children:"총 절단 길이"}),c.jsxs("span",{className:Ja.value,children:[s.total.toFixed(2)," ",s.unit]})]}),i==="OPTIMAL_CNC"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:Ja.statItem,children:[c.jsx("span",{className:Ja.label,children:"예상 가공 시간"}),c.jsxs("span",{className:Ja.value,children:[r.cycleTimeSec.toFixed(1)," 초"]})]}),c.jsxs("div",{className:Ja.statItem,children:[c.jsx("span",{className:Ja.label,children:"공구 교체"}),c.jsx("span",{className:Ja.value,children:r.toolChanges})]})]})]})]})}const eGe="_container_1by2p_1",tGe="_main_1by2p_9",nGe="_leftSidebar_1by2p_18",iGe="_center_1by2p_24",rGe="_rightSidebar_1by2p_30",x2={container:eGe,main:tGe,leftSidebar:nGe,center:iGe,rightSidebar:rGe};function sGe(){const{setSheets:n,setPanels:e}=Cp();return H.useEffect(()=>{n([{id:"sheet1",width:2440,length:1220,trim:{left:10,right:10,top:10,bottom:10}},{id:"sheet2",width:2440,length:1220,trim:{left:10,right:10,top:10,bottom:10}},{id:"sheet3",width:2440,length:1220,trim:{left:10,right:10,top:10,bottom:10}}]),e([{id:"panel1",width:600,length:800,qty:4,canRotate:!0,grain:"none"},{id:"panel2",width:400,length:500,qty:5,canRotate:!0,grain:"none"},{id:"panel3",width:800,length:300,qty:3,canRotate:!0,grain:"none"},{id:"panel4",width:350,length:450,qty:4,canRotate:!0,grain:"none"}]),setTimeout(yVe,100)},[n,e]),c.jsxs("div",{className:x2.container,children:[c.jsx(bVe,{}),c.jsxs("div",{className:x2.main,children:[c.jsx("div",{className:x2.leftSidebar,children:c.jsx(JVe,{})}),c.jsx("div",{className:x2.center,children:c.jsx(MVe,{})}),c.jsx("div",{className:x2.rightSidebar,children:c.jsx(VVe,{})})]})]})}var bC={exports:{}},b2={},qT={},ZT={},yR;function gs(){return yR||(yR=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n._registerNode=n.Konva=n.glob=void 0;const e=Math.PI/180;function t(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}n.glob=typeof mm<"u"?mm:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},n.Konva={_global:n.glob,version:"9.3.22",isBrowser:t(),isUnminified:/param/.test((function(r){}).toString()),dblClickWindow:400,getAngle(r){return n.Konva.angleDeg?r*e:r},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return n.Konva.DD.isDragging},isTransforming(){var r;return(r=n.Konva.Transformer)===null||r===void 0?void 0:r.isTransforming()},isDragReady(){return!!n.Konva.DD.node},releaseCanvasOnDestroy:!0,document:n.glob.document,_injectGlobal(r){n.glob.Konva=r}};const i=r=>{n.Konva[r.prototype.getClassName()]=r};n._registerNode=i,n.Konva._injectGlobal(n.Konva)})(ZT)),ZT}var JT={},wR;function Oa(){return wR||(wR=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Util=n.Transform=void 0;const e=gs();class t{constructor(x=[1,0,0,1,0,0]){this.dirty=!1,this.m=x&&x.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new t(this.m)}copyInto(x){x.m[0]=this.m[0],x.m[1]=this.m[1],x.m[2]=this.m[2],x.m[3]=this.m[3],x.m[4]=this.m[4],x.m[5]=this.m[5]}point(x){const S=this.m;return{x:S[0]*x.x+S[2]*x.y+S[4],y:S[1]*x.x+S[3]*x.y+S[5]}}translate(x,S){return this.m[4]+=this.m[0]*x+this.m[2]*S,this.m[5]+=this.m[1]*x+this.m[3]*S,this}scale(x,S){return this.m[0]*=x,this.m[1]*=x,this.m[2]*=S,this.m[3]*=S,this}rotate(x){const S=Math.cos(x),I=Math.sin(x),j=this.m[0]*S+this.m[2]*I,C=this.m[1]*S+this.m[3]*I,b=this.m[0]*-I+this.m[2]*S,D=this.m[1]*-I+this.m[3]*S;return this.m[0]=j,this.m[1]=C,this.m[2]=b,this.m[3]=D,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(x,S){const I=this.m[0]+this.m[2]*S,j=this.m[1]+this.m[3]*S,C=this.m[2]+this.m[0]*x,b=this.m[3]+this.m[1]*x;return this.m[0]=I,this.m[1]=j,this.m[2]=C,this.m[3]=b,this}multiply(x){const S=this.m[0]*x.m[0]+this.m[2]*x.m[1],I=this.m[1]*x.m[0]+this.m[3]*x.m[1],j=this.m[0]*x.m[2]+this.m[2]*x.m[3],C=this.m[1]*x.m[2]+this.m[3]*x.m[3],b=this.m[0]*x.m[4]+this.m[2]*x.m[5]+this.m[4],D=this.m[1]*x.m[4]+this.m[3]*x.m[5]+this.m[5];return this.m[0]=S,this.m[1]=I,this.m[2]=j,this.m[3]=C,this.m[4]=b,this.m[5]=D,this}invert(){const x=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),S=this.m[3]*x,I=-this.m[1]*x,j=-this.m[2]*x,C=this.m[0]*x,b=x*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),D=x*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=S,this.m[1]=I,this.m[2]=j,this.m[3]=C,this.m[4]=b,this.m[5]=D,this}getMatrix(){return this.m}decompose(){const x=this.m[0],S=this.m[1],I=this.m[2],j=this.m[3],C=this.m[4],b=this.m[5],D=x*j-S*I,T={x:C,y:b,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(x!=0||S!=0){const k=Math.sqrt(x*x+S*S);T.rotation=S>0?Math.acos(x/k):-Math.acos(x/k),T.scaleX=k,T.scaleY=D/k,T.skewX=(x*I+S*j)/D,T.skewY=0}else if(I!=0||j!=0){const k=Math.sqrt(I*I+j*j);T.rotation=Math.PI/2-(j>0?Math.acos(-I/k):-Math.acos(I/k)),T.scaleX=D/k,T.scaleY=k,T.skewX=0,T.skewY=(x*I+S*j)/D}return T.rotation=n.Util._getRotation(T.rotation),T}}n.Transform=t;const i="[object Array]",r="[object Number]",s="[object String]",o="[object Boolean]",a=Math.PI/180,l=180/Math.PI,h="#",u="",d="0",A="Konva warning: ",f="Konva error: ",p="rgb(",g={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},v=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let w=[];const m=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(y){setTimeout(y,60)};n.Util={_isElement(y){return!!(y&&y.nodeType==1)},_isFunction(y){return!!(y&&y.constructor&&y.call&&y.apply)},_isPlainObject(y){return!!y&&y.constructor===Object},_isArray(y){return Object.prototype.toString.call(y)===i},_isNumber(y){return Object.prototype.toString.call(y)===r&&!isNaN(y)&&isFinite(y)},_isString(y){return Object.prototype.toString.call(y)===s},_isBoolean(y){return Object.prototype.toString.call(y)===o},isObject(y){return y instanceof Object},isValidSelector(y){if(typeof y!="string")return!1;const x=y[0];return x==="#"||x==="."||x===x.toUpperCase()},_sign(y){return y===0||y>0?1:-1},requestAnimFrame(y){w.push(y),w.length===1&&m(function(){const x=w;w=[],x.forEach(function(S){S()})})},createCanvasElement(){const y=document.createElement("canvas");try{y.style=y.style||{}}catch{}return y},createImageElement(){return document.createElement("img")},_isInDocument(y){for(;y=y.parentNode;)if(y==document)return!0;return!1},_urlToImage(y,x){const S=n.Util.createImageElement();S.onload=function(){x(S)},S.src=y},_rgbToHex(y,x,S){return((1<<24)+(y<<16)+(x<<8)+S).toString(16).slice(1)},_hexToRgb(y){y=y.replace(h,u);const x=parseInt(y,16);return{r:x>>16&255,g:x>>8&255,b:x&255}},getRandomColor(){let y=(Math.random()*16777215<<0).toString(16);for(;y.length<6;)y=d+y;return h+y},getRGB(y){let x;return y in g?(x=g[y],{r:x[0],g:x[1],b:x[2]}):y[0]===h?this._hexToRgb(y.substring(1)):y.substr(0,4)===p?(x=v.exec(y.replace(/ /g,"")),{r:parseInt(x[1],10),g:parseInt(x[2],10),b:parseInt(x[3],10)}):{r:0,g:0,b:0}},colorToRGBA(y){return y=y||"black",n.Util._namedColorToRBA(y)||n.Util._hex3ColorToRGBA(y)||n.Util._hex4ColorToRGBA(y)||n.Util._hex6ColorToRGBA(y)||n.Util._hex8ColorToRGBA(y)||n.Util._rgbColorToRGBA(y)||n.Util._rgbaColorToRGBA(y)||n.Util._hslColorToRGBA(y)},_namedColorToRBA(y){const x=g[y.toLowerCase()];return x?{r:x[0],g:x[1],b:x[2],a:1}:null},_rgbColorToRGBA(y){if(y.indexOf("rgb(")===0){y=y.match(/rgb\(([^)]+)\)/)[1];const x=y.split(/ *, */).map(Number);return{r:x[0],g:x[1],b:x[2],a:1}}},_rgbaColorToRGBA(y){if(y.indexOf("rgba(")===0){y=y.match(/rgba\(([^)]+)\)/)[1];const x=y.split(/ *, */).map((S,I)=>S.slice(-1)==="%"?I===3?parseInt(S)/100:parseInt(S)/100*255:Number(S));return{r:x[0],g:x[1],b:x[2],a:x[3]}}},_hex8ColorToRGBA(y){if(y[0]==="#"&&y.length===9)return{r:parseInt(y.slice(1,3),16),g:parseInt(y.slice(3,5),16),b:parseInt(y.slice(5,7),16),a:parseInt(y.slice(7,9),16)/255}},_hex6ColorToRGBA(y){if(y[0]==="#"&&y.length===7)return{r:parseInt(y.slice(1,3),16),g:parseInt(y.slice(3,5),16),b:parseInt(y.slice(5,7),16),a:1}},_hex4ColorToRGBA(y){if(y[0]==="#"&&y.length===5)return{r:parseInt(y[1]+y[1],16),g:parseInt(y[2]+y[2],16),b:parseInt(y[3]+y[3],16),a:parseInt(y[4]+y[4],16)/255}},_hex3ColorToRGBA(y){if(y[0]==="#"&&y.length===4)return{r:parseInt(y[1]+y[1],16),g:parseInt(y[2]+y[2],16),b:parseInt(y[3]+y[3],16),a:1}},_hslColorToRGBA(y){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(y)){const[x,...S]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(y),I=Number(S[0])/360,j=Number(S[1])/100,C=Number(S[2])/100;let b,D,T;if(j===0)return T=C*255,{r:Math.round(T),g:Math.round(T),b:Math.round(T),a:1};C<.5?b=C*(1+j):b=C+j-C*j;const k=2*C-b,B=[0,0,0];for(let E=0;E<3;E++)D=I+1/3*-(E-1),D<0&&D++,D>1&&D--,6*D<1?T=k+(b-k)*6*D:2*D<1?T=b:3*D<2?T=k+(b-k)*(2/3-D)*6:T=k,B[E]=T*255;return{r:Math.round(B[0]),g:Math.round(B[1]),b:Math.round(B[2]),a:1}}},haveIntersection(y,x){return!(x.x>y.x+y.width||x.x+x.width<y.x||x.y>y.y+y.height||x.y+x.height<y.y)},cloneObject(y){const x={};for(const S in y)this._isPlainObject(y[S])?x[S]=this.cloneObject(y[S]):this._isArray(y[S])?x[S]=this.cloneArray(y[S]):x[S]=y[S];return x},cloneArray(y){return y.slice(0)},degToRad(y){return y*a},radToDeg(y){return y*l},_degToRad(y){return n.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),n.Util.degToRad(y)},_radToDeg(y){return n.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),n.Util.radToDeg(y)},_getRotation(y){return e.Konva.angleDeg?n.Util.radToDeg(y):y},_capitalize(y){return y.charAt(0).toUpperCase()+y.slice(1)},throw(y){throw new Error(f+y)},error(y){console.error(f+y)},warn(y){e.Konva.showWarnings&&console.warn(A+y)},each(y,x){for(const S in y)x(S,y[S])},_inRange(y,x,S){return x<=y&&y<S},_getProjectionToSegment(y,x,S,I,j,C){let b,D,T;const k=(y-S)*(y-S)+(x-I)*(x-I);if(k==0)b=y,D=x,T=(j-S)*(j-S)+(C-I)*(C-I);else{const B=((j-y)*(S-y)+(C-x)*(I-x))/k;B<0?(b=y,D=x,T=(y-j)*(y-j)+(x-C)*(x-C)):B>1?(b=S,D=I,T=(S-j)*(S-j)+(I-C)*(I-C)):(b=y+B*(S-y),D=x+B*(I-x),T=(b-j)*(b-j)+(D-C)*(D-C))}return[b,D,T]},_getProjectionToLine(y,x,S){const I=n.Util.cloneObject(y);let j=Number.MAX_VALUE;return x.forEach(function(C,b){if(!S&&b===x.length-1)return;const D=x[(b+1)%x.length],T=n.Util._getProjectionToSegment(C.x,C.y,D.x,D.y,y.x,y.y),k=T[0],B=T[1],E=T[2];E<j&&(I.x=k,I.y=B,j=E)}),I},_prepareArrayForTween(y,x,S){const I=[],j=[];if(y.length>x.length){const b=x;x=y,y=b}for(let b=0;b<y.length;b+=2)I.push({x:y[b],y:y[b+1]});for(let b=0;b<x.length;b+=2)j.push({x:x[b],y:x[b+1]});const C=[];return j.forEach(function(b){const D=n.Util._getProjectionToLine(b,I,S);C.push(D.x),C.push(D.y)}),C},_prepareToStringify(y){let x;y.visitedByCircularReferenceRemoval=!0;for(const S in y)if(y.hasOwnProperty(S)&&y[S]&&typeof y[S]=="object"){if(x=Object.getOwnPropertyDescriptor(y,S),y[S].visitedByCircularReferenceRemoval||n.Util._isElement(y[S]))if(x.configurable)delete y[S];else return null;else if(n.Util._prepareToStringify(y[S])===null)if(x.configurable)delete y[S];else return null}return delete y.visitedByCircularReferenceRemoval,y},_assign(y,x){for(const S in x)y[S]=x[S];return y},_getFirstPointerId(y){return y.touches?y.changedTouches[0].identifier:y.pointerId||999},releaseCanvas(...y){e.Konva.releaseCanvasOnDestroy&&y.forEach(x=>{x.width=0,x.height=0})},drawRoundedRectPath(y,x,S,I){let j=0,C=0,b=0,D=0;typeof I=="number"?j=C=b=D=Math.min(I,x/2,S/2):(j=Math.min(I[0]||0,x/2,S/2),C=Math.min(I[1]||0,x/2,S/2),D=Math.min(I[2]||0,x/2,S/2),b=Math.min(I[3]||0,x/2,S/2)),y.moveTo(j,0),y.lineTo(x-C,0),y.arc(x-C,C,C,Math.PI*3/2,0,!1),y.lineTo(x,S-D),y.arc(x-D,S-D,D,0,Math.PI/2,!1),y.lineTo(b,S),y.arc(b,S-b,b,Math.PI/2,Math.PI,!1),y.lineTo(0,j),y.arc(j,j,j,Math.PI,Math.PI*3/2,!1)}}})(JT)),JT}var C2={},$A={},VA={},vR;function OK(){if(vR)return VA;vR=1,Object.defineProperty(VA,"__esModule",{value:!0}),VA.HitContext=VA.SceneContext=VA.Context=void 0;const n=Oa(),e=gs();function t(w){const m=[],y=w.length,x=n.Util;for(let S=0;S<y;S++){let I=w[S];x._isNumber(I)?I=Math.round(I*1e3)/1e3:x._isString(I)||(I=I+""),m.push(I)}return m}const i=",",r="(",s=")",o="([",a="])",l=";",h="()",u="=",d=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],A=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],f=100;let p=class{constructor(m){this.canvas=m,e.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(m){m.fillEnabled()&&this._fill(m)}_fill(m){}strokeShape(m){m.hasStroke()&&this._stroke(m)}_stroke(m){}fillStrokeShape(m){m.attrs.fillAfterStrokeEnabled?(this.strokeShape(m),this.fillShape(m)):(this.fillShape(m),this.strokeShape(m))}getTrace(m,y){let x=this.traceArr,S=x.length,I="",j,C,b,D;for(j=0;j<S;j++)C=x[j],b=C.method,b?(D=C.args,I+=b,m?I+=h:n.Util._isArray(D[0])?I+=o+D.join(i)+a:(y&&(D=D.map(T=>typeof T=="number"?Math.floor(T):T)),I+=r+D.join(i)+s)):(I+=C.property,m||(I+=u+C.val)),I+=l;return I}clearTrace(){this.traceArr=[]}_trace(m){let y=this.traceArr,x;y.push(m),x=y.length,x>=f&&y.shift()}reset(){const m=this.getCanvas().getPixelRatio();this.setTransform(1*m,0,0,1*m,0,0)}getCanvas(){return this.canvas}clear(m){const y=this.getCanvas();m?this.clearRect(m.x||0,m.y||0,m.width||0,m.height||0):this.clearRect(0,0,y.getWidth()/y.pixelRatio,y.getHeight()/y.pixelRatio)}_applyLineCap(m){const y=m.attrs.lineCap;y&&this.setAttr("lineCap",y)}_applyOpacity(m){const y=m.getAbsoluteOpacity();y!==1&&this.setAttr("globalAlpha",y)}_applyLineJoin(m){const y=m.attrs.lineJoin;y&&this.setAttr("lineJoin",y)}setAttr(m,y){this._context[m]=y}arc(m,y,x,S,I,j){this._context.arc(m,y,x,S,I,j)}arcTo(m,y,x,S,I){this._context.arcTo(m,y,x,S,I)}beginPath(){this._context.beginPath()}bezierCurveTo(m,y,x,S,I,j){this._context.bezierCurveTo(m,y,x,S,I,j)}clearRect(m,y,x,S){this._context.clearRect(m,y,x,S)}clip(...m){this._context.clip.apply(this._context,m)}closePath(){this._context.closePath()}createImageData(m,y){const x=arguments;if(x.length===2)return this._context.createImageData(m,y);if(x.length===1)return this._context.createImageData(m)}createLinearGradient(m,y,x,S){return this._context.createLinearGradient(m,y,x,S)}createPattern(m,y){return this._context.createPattern(m,y)}createRadialGradient(m,y,x,S,I,j){return this._context.createRadialGradient(m,y,x,S,I,j)}drawImage(m,y,x,S,I,j,C,b,D){const T=arguments,k=this._context;T.length===3?k.drawImage(m,y,x):T.length===5?k.drawImage(m,y,x,S,I):T.length===9&&k.drawImage(m,y,x,S,I,j,C,b,D)}ellipse(m,y,x,S,I,j,C,b){this._context.ellipse(m,y,x,S,I,j,C,b)}isPointInPath(m,y,x,S){return x?this._context.isPointInPath(x,m,y,S):this._context.isPointInPath(m,y,S)}fill(...m){this._context.fill.apply(this._context,m)}fillRect(m,y,x,S){this._context.fillRect(m,y,x,S)}strokeRect(m,y,x,S){this._context.strokeRect(m,y,x,S)}fillText(m,y,x,S){S?this._context.fillText(m,y,x,S):this._context.fillText(m,y,x)}measureText(m){return this._context.measureText(m)}getImageData(m,y,x,S){return this._context.getImageData(m,y,x,S)}lineTo(m,y){this._context.lineTo(m,y)}moveTo(m,y){this._context.moveTo(m,y)}rect(m,y,x,S){this._context.rect(m,y,x,S)}roundRect(m,y,x,S,I){this._context.roundRect(m,y,x,S,I)}putImageData(m,y,x){this._context.putImageData(m,y,x)}quadraticCurveTo(m,y,x,S){this._context.quadraticCurveTo(m,y,x,S)}restore(){this._context.restore()}rotate(m){this._context.rotate(m)}save(){this._context.save()}scale(m,y){this._context.scale(m,y)}setLineDash(m){this._context.setLineDash?this._context.setLineDash(m):"mozDash"in this._context?this._context.mozDash=m:"webkitLineDash"in this._context&&(this._context.webkitLineDash=m)}getLineDash(){return this._context.getLineDash()}setTransform(m,y,x,S,I,j){this._context.setTransform(m,y,x,S,I,j)}stroke(m){m?this._context.stroke(m):this._context.stroke()}strokeText(m,y,x,S){this._context.strokeText(m,y,x,S)}transform(m,y,x,S,I,j){this._context.transform(m,y,x,S,I,j)}translate(m,y){this._context.translate(m,y)}_enableTrace(){let m=this,y=d.length,x=this.setAttr,S,I;const j=function(C){let b=m[C],D;m[C]=function(){return I=t(Array.prototype.slice.call(arguments,0)),D=b.apply(m,arguments),m._trace({method:C,args:I}),D}};for(S=0;S<y;S++)j(d[S]);m.setAttr=function(){x.apply(m,arguments);const C=arguments[0];let b=arguments[1];(C==="shadowOffsetX"||C==="shadowOffsetY"||C==="shadowBlur")&&(b=b/this.canvas.getPixelRatio()),m._trace({property:C,val:b})}}_applyGlobalCompositeOperation(m){const y=m.attrs.globalCompositeOperation;!y||y==="source-over"||this.setAttr("globalCompositeOperation",y)}};VA.Context=p,A.forEach(function(w){Object.defineProperty(p.prototype,w,{get(){return this._context[w]},set(m){this._context[w]=m}})});class g extends p{constructor(m,{willReadFrequently:y=!1}={}){super(m),this._context=m._canvas.getContext("2d",{willReadFrequently:y})}_fillColor(m){const y=m.fill();this.setAttr("fillStyle",y),m._fillFunc(this)}_fillPattern(m){this.setAttr("fillStyle",m._getFillPattern()),m._fillFunc(this)}_fillLinearGradient(m){const y=m._getLinearGradient();y&&(this.setAttr("fillStyle",y),m._fillFunc(this))}_fillRadialGradient(m){const y=m._getRadialGradient();y&&(this.setAttr("fillStyle",y),m._fillFunc(this))}_fill(m){const y=m.fill(),x=m.getFillPriority();if(y&&x==="color"){this._fillColor(m);return}const S=m.getFillPatternImage();if(S&&x==="pattern"){this._fillPattern(m);return}const I=m.getFillLinearGradientColorStops();if(I&&x==="linear-gradient"){this._fillLinearGradient(m);return}const j=m.getFillRadialGradientColorStops();if(j&&x==="radial-gradient"){this._fillRadialGradient(m);return}y?this._fillColor(m):S?this._fillPattern(m):I?this._fillLinearGradient(m):j&&this._fillRadialGradient(m)}_strokeLinearGradient(m){const y=m.getStrokeLinearGradientStartPoint(),x=m.getStrokeLinearGradientEndPoint(),S=m.getStrokeLinearGradientColorStops(),I=this.createLinearGradient(y.x,y.y,x.x,x.y);if(S){for(let j=0;j<S.length;j+=2)I.addColorStop(S[j],S[j+1]);this.setAttr("strokeStyle",I)}}_stroke(m){const y=m.dash(),x=m.getStrokeScaleEnabled();if(m.hasStroke()){if(!x){this.save();const I=this.getCanvas().getPixelRatio();this.setTransform(I,0,0,I,0,0)}this._applyLineCap(m),y&&m.dashEnabled()&&(this.setLineDash(y),this.setAttr("lineDashOffset",m.dashOffset())),this.setAttr("lineWidth",m.strokeWidth()),m.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),m.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(m):this.setAttr("strokeStyle",m.stroke()),m._strokeFunc(this),x||this.restore()}}_applyShadow(m){var y,x,S;const I=(y=m.getShadowRGBA())!==null&&y!==void 0?y:"black",j=(x=m.getShadowBlur())!==null&&x!==void 0?x:5,C=(S=m.getShadowOffset())!==null&&S!==void 0?S:{x:0,y:0},b=m.getAbsoluteScale(),D=this.canvas.getPixelRatio(),T=b.x*D,k=b.y*D;this.setAttr("shadowColor",I),this.setAttr("shadowBlur",j*Math.min(Math.abs(T),Math.abs(k))),this.setAttr("shadowOffsetX",C.x*T),this.setAttr("shadowOffsetY",C.y*k)}}VA.SceneContext=g;class v extends p{constructor(m){super(m),this._context=m._canvas.getContext("2d",{willReadFrequently:!0})}_fill(m){this.save(),this.setAttr("fillStyle",m.colorKey),m._fillFuncHit(this),this.restore()}strokeShape(m){m.hasHitStroke()&&this._stroke(m)}_stroke(m){if(m.hasHitStroke()){const y=m.getStrokeScaleEnabled();if(!y){this.save();const I=this.getCanvas().getPixelRatio();this.setTransform(I,0,0,I,0,0)}this._applyLineCap(m);const x=m.hitStrokeWidth(),S=x==="auto"?m.strokeWidth():x;this.setAttr("lineWidth",S),this.setAttr("strokeStyle",m.colorKey),m._strokeFuncHit(this),y||this.restore()}}}return VA.HitContext=v,VA}var xR;function CS(){if(xR)return $A;xR=1,Object.defineProperty($A,"__esModule",{value:!0}),$A.HitCanvas=$A.SceneCanvas=$A.Canvas=void 0;const n=Oa(),e=OK(),t=gs();let i;function r(){if(i)return i;const l=n.Util.createCanvasElement(),h=l.getContext("2d");return i=(function(){const u=t.Konva._global.devicePixelRatio||1,d=h.webkitBackingStorePixelRatio||h.mozBackingStorePixelRatio||h.msBackingStorePixelRatio||h.oBackingStorePixelRatio||h.backingStorePixelRatio||1;return u/d})(),n.Util.releaseCanvas(l),i}let s=class{constructor(h){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const d=(h||{}).pixelRatio||t.Konva.pixelRatio||r();this.pixelRatio=d,this._canvas=n.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(h){const u=this.pixelRatio;this.pixelRatio=h,this.setSize(this.getWidth()/u,this.getHeight()/u)}setWidth(h){this.width=this._canvas.width=h*this.pixelRatio,this._canvas.style.width=h+"px";const u=this.pixelRatio;this.getContext()._context.scale(u,u)}setHeight(h){this.height=this._canvas.height=h*this.pixelRatio,this._canvas.style.height=h+"px";const u=this.pixelRatio;this.getContext()._context.scale(u,u)}getWidth(){return this.width}getHeight(){return this.height}setSize(h,u){this.setWidth(h||0),this.setHeight(u||0)}toDataURL(h,u){try{return this._canvas.toDataURL(h,u)}catch{try{return this._canvas.toDataURL()}catch(A){return n.Util.error("Unable to get data URL. "+A.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};$A.Canvas=s;class o extends s{constructor(h={width:0,height:0,willReadFrequently:!1}){super(h),this.context=new e.SceneContext(this,{willReadFrequently:h.willReadFrequently}),this.setSize(h.width,h.height)}}$A.SceneCanvas=o;class a extends s{constructor(h={width:0,height:0}){super(h),this.hitCanvas=!0,this.context=new e.HitContext(this),this.setSize(h.width,h.height)}}return $A.HitCanvas=a,$A}var eB={},bR;function mI(){return bR||(bR=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.DD=void 0;const e=gs(),t=Oa();n.DD={get isDragging(){let i=!1;return n.DD._dragElements.forEach(r=>{r.dragStatus==="dragging"&&(i=!0)}),i},justDragged:!1,get node(){let i;return n.DD._dragElements.forEach(r=>{i=r.node}),i},_dragElements:new Map,_drag(i){const r=[];n.DD._dragElements.forEach((s,o)=>{const{node:a}=s,l=a.getStage();l.setPointersPositions(i),s.pointerId===void 0&&(s.pointerId=t.Util._getFirstPointerId(i));const h=l._changedPointerPositions.find(u=>u.id===s.pointerId);if(h){if(s.dragStatus!=="dragging"){const u=a.dragDistance();if(Math.max(Math.abs(h.x-s.startPointerPos.x),Math.abs(h.y-s.startPointerPos.y))<u||(a.startDrag({evt:i}),!a.isDragging()))return}a._setDragPosition(i,s),r.push(a)}}),r.forEach(s=>{s.fire("dragmove",{type:"dragmove",target:s,evt:i},!0)})},_endDragBefore(i){const r=[];n.DD._dragElements.forEach(s=>{const{node:o}=s,a=o.getStage();if(i&&a.setPointersPositions(i),!a._changedPointerPositions.find(u=>u.id===s.pointerId))return;(s.dragStatus==="dragging"||s.dragStatus==="stopped")&&(n.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,s.dragStatus="stopped");const h=s.node.getLayer()||s.node instanceof e.Konva.Stage&&s.node;h&&r.indexOf(h)===-1&&r.push(h)}),r.forEach(s=>{s.draw()})},_endDragAfter(i){n.DD._dragElements.forEach((r,s)=>{r.dragStatus==="stopped"&&r.node.fire("dragend",{type:"dragend",target:r.node,evt:i},!0),r.dragStatus!=="dragging"&&n.DD._dragElements.delete(s)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",n.DD._endDragBefore,!0),window.addEventListener("touchend",n.DD._endDragBefore,!0),window.addEventListener("touchcancel",n.DD._endDragBefore,!0),window.addEventListener("mousemove",n.DD._drag),window.addEventListener("touchmove",n.DD._drag),window.addEventListener("mouseup",n.DD._endDragAfter,!1),window.addEventListener("touchend",n.DD._endDragAfter,!1),window.addEventListener("touchcancel",n.DD._endDragAfter,!1))})(eB)),eB}var tB={},Ch={},CR;function js(){if(CR)return Ch;CR=1,Object.defineProperty(Ch,"__esModule",{value:!0}),Ch.RGBComponent=i,Ch.alphaComponent=r,Ch.getNumberValidator=s,Ch.getNumberOrArrayOfNumbersValidator=o,Ch.getNumberOrAutoValidator=a,Ch.getStringValidator=l,Ch.getStringOrGradientValidator=h,Ch.getFunctionValidator=u,Ch.getNumberArrayValidator=d,Ch.getBooleanValidator=A,Ch.getComponentValidator=f;const n=gs(),e=Oa();function t(p){return e.Util._isString(p)?'"'+p+'"':Object.prototype.toString.call(p)==="[object Number]"||e.Util._isBoolean(p)?p:Object.prototype.toString.call(p)}function i(p){return p>255?255:p<0?0:Math.round(p)}function r(p){return p>1?1:p<1e-4?1e-4:p}function s(){if(n.Konva.isUnminified)return function(p,g){return e.Util._isNumber(p)||e.Util.warn(t(p)+' is a not valid value for "'+g+'" attribute. The value should be a number.'),p}}function o(p){if(n.Konva.isUnminified)return function(g,v){let w=e.Util._isNumber(g),m=e.Util._isArray(g)&&g.length==p;return!w&&!m&&e.Util.warn(t(g)+' is a not valid value for "'+v+'" attribute. The value should be a number or Array<number>('+p+")"),g}}function a(){if(n.Konva.isUnminified)return function(p,g){return e.Util._isNumber(p)||p==="auto"||e.Util.warn(t(p)+' is a not valid value for "'+g+'" attribute. The value should be a number or "auto".'),p}}function l(){if(n.Konva.isUnminified)return function(p,g){return e.Util._isString(p)||e.Util.warn(t(p)+' is a not valid value for "'+g+'" attribute. The value should be a string.'),p}}function h(){if(n.Konva.isUnminified)return function(p,g){const v=e.Util._isString(p),w=Object.prototype.toString.call(p)==="[object CanvasGradient]"||p&&p.addColorStop;return v||w||e.Util.warn(t(p)+' is a not valid value for "'+g+'" attribute. The value should be a string or a native gradient.'),p}}function u(){if(n.Konva.isUnminified)return function(p,g){return e.Util._isFunction(p)||e.Util.warn(t(p)+' is a not valid value for "'+g+'" attribute. The value should be a function.'),p}}function d(){if(n.Konva.isUnminified)return function(p,g){const v=Int8Array?Object.getPrototypeOf(Int8Array):null;return v&&p instanceof v||(e.Util._isArray(p)?p.forEach(function(w){e.Util._isNumber(w)||e.Util.warn('"'+g+'" attribute has non numeric element '+w+". Make sure that all elements are numbers.")}):e.Util.warn(t(p)+' is a not valid value for "'+g+'" attribute. The value should be a array of numbers.')),p}}function A(){if(n.Konva.isUnminified)return function(p,g){return p===!0||p===!1||e.Util.warn(t(p)+' is a not valid value for "'+g+'" attribute. The value should be a boolean.'),p}}function f(p){if(n.Konva.isUnminified)return function(g,v){return g==null||e.Util.isObject(g)||e.Util.warn(t(g)+' is a not valid value for "'+v+'" attribute. The value should be an object with properties '+p),g}}return Ch}var _R;function Ss(){return _R||(_R=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Factory=void 0;const e=Oa(),t=js(),i="get",r="set";n.Factory={addGetterSetter(s,o,a,l,h){n.Factory.addGetter(s,o,a),n.Factory.addSetter(s,o,l,h),n.Factory.addOverloadedGetterSetter(s,o)},addGetter(s,o,a){const l=i+e.Util._capitalize(o);s.prototype[l]=s.prototype[l]||function(){const h=this.attrs[o];return h===void 0?a:h}},addSetter(s,o,a,l){const h=r+e.Util._capitalize(o);s.prototype[h]||n.Factory.overWriteSetter(s,o,a,l)},overWriteSetter(s,o,a,l){const h=r+e.Util._capitalize(o);s.prototype[h]=function(u){return a&&u!==void 0&&u!==null&&(u=a.call(this,u,o)),this._setAttr(o,u),l&&l.call(this),this}},addComponentsGetterSetter(s,o,a,l,h){const u=a.length,d=e.Util._capitalize,A=i+d(o),f=r+d(o);s.prototype[A]=function(){const g={};for(let v=0;v<u;v++){const w=a[v];g[w]=this.getAttr(o+d(w))}return g};const p=(0,t.getComponentValidator)(a);s.prototype[f]=function(g){const v=this.attrs[o];l&&(g=l.call(this,g,o)),p&&p.call(this,g,o);for(const w in g)g.hasOwnProperty(w)&&this._setAttr(o+d(w),g[w]);return g||a.forEach(w=>{this._setAttr(o+d(w),void 0)}),this._fireChangeEvent(o,v,g),h&&h.call(this),this},n.Factory.addOverloadedGetterSetter(s,o)},addOverloadedGetterSetter(s,o){const a=e.Util._capitalize(o),l=r+a,h=i+a;s.prototype[o]=function(){return arguments.length?(this[l](arguments[0]),this):this[h]()}},addDeprecatedGetterSetter(s,o,a,l){e.Util.error("Adding deprecated "+o);const h=i+e.Util._capitalize(o),u=o+" property is deprecated and will be removed soon. Look at Konva change log for more information.";s.prototype[h]=function(){e.Util.error(u);const d=this.attrs[o];return d===void 0?a:d},n.Factory.addSetter(s,o,l,function(){e.Util.error(u)}),n.Factory.addOverloadedGetterSetter(s,o)},backCompat(s,o){e.Util.each(o,function(a,l){const h=s.prototype[l],u=i+e.Util._capitalize(a),d=r+e.Util._capitalize(a);function A(){h.apply(this,arguments),e.Util.error('"'+a+'" method is deprecated and will be removed soon. Use ""'+l+'" instead.')}s.prototype[a]=A,s.prototype[u]=A,s.prototype[d]=A})},afterSetFilter(){this._filterUpToDate=!1}}})(tB)),tB}var SR;function ul(){if(SR)return C2;SR=1,Object.defineProperty(C2,"__esModule",{value:!0}),C2.Node=void 0;const n=CS(),e=mI(),t=Ss(),i=gs(),r=Oa(),s=js(),o="absoluteOpacity",a="allEventListeners",l="absoluteTransform",h="absoluteScale",u="canvas",d="Change",A="children",f="konva",p="listening",g="mouseenter",v="mouseleave",w="pointerenter",m="pointerleave",y="touchenter",x="touchleave",S="set",I="Shape",j=" ",C="stage",b="transform",D="Stage",T="visible",k=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(j);let B=1;class E{constructor(L){this._id=B++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(L),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(L){(L===b||L===l)&&this._cache.get(L)?this._cache.get(L).dirty=!0:L?this._cache.delete(L):this._cache.clear()}_getCache(L,O){let J=this._cache.get(L);return(J===void 0||(L===b||L===l)&&J.dirty===!0)&&(J=O.call(this),this._cache.set(L,J)),J}_calculate(L,O,J){if(!this._attachedDepsListeners.get(L)){const $=O.map(U=>U+"Change.konva").join(j);this.on($,()=>{this._clearCache(L)}),this._attachedDepsListeners.set(L,!0)}return this._getCache(L,J)}_getCanvasCache(){return this._cache.get(u)}_clearSelfAndDescendantCache(L){this._clearCache(L),L===l&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(u)){const{scene:L,filter:O,hit:J,buffer:$}=this._cache.get(u);r.Util.releaseCanvas(L,O,J,$),this._cache.delete(u)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(L){const O=L||{};let J={};(O.x===void 0||O.y===void 0||O.width===void 0||O.height===void 0)&&(J=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let $=Math.ceil(O.width||J.width),U=Math.ceil(O.height||J.height),Y=O.pixelRatio,K=O.x===void 0?Math.floor(J.x):O.x,V=O.y===void 0?Math.floor(J.y):O.y,Q=O.offset||0,X=O.drawBorder||!1,W=O.hitCanvasPixelRatio||1;if(!$||!U){r.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const se=Math.abs(Math.round(J.x)-K)>.5?1:0,q=Math.abs(Math.round(J.y)-V)>.5?1:0;$+=Q*2+se,U+=Q*2+q,K-=Q,V-=Q;const de=new n.SceneCanvas({pixelRatio:Y,width:$,height:U}),Ce=new n.SceneCanvas({pixelRatio:Y,width:0,height:0,willReadFrequently:!0}),Se=new n.HitCanvas({pixelRatio:W,width:$,height:U}),fe=de.getContext(),M=Se.getContext(),Z=new n.SceneCanvas({width:de.width/de.pixelRatio+Math.abs(K),height:de.height/de.pixelRatio+Math.abs(V),pixelRatio:de.pixelRatio}),Ae=Z.getContext();return Se.isCache=!0,de.isCache=!0,this._cache.delete(u),this._filterUpToDate=!1,O.imageSmoothingEnabled===!1&&(de.getContext()._context.imageSmoothingEnabled=!1,Ce.getContext()._context.imageSmoothingEnabled=!1),fe.save(),M.save(),Ae.save(),fe.translate(-K,-V),M.translate(-K,-V),Ae.translate(-K,-V),Z.x=K,Z.y=V,this._isUnderCache=!0,this._clearSelfAndDescendantCache(o),this._clearSelfAndDescendantCache(h),this.drawScene(de,this,Z),this.drawHit(Se,this),this._isUnderCache=!1,fe.restore(),M.restore(),X&&(fe.save(),fe.beginPath(),fe.rect(0,0,$,U),fe.closePath(),fe.setAttr("strokeStyle","red"),fe.setAttr("lineWidth",5),fe.stroke(),fe.restore()),this._cache.set(u,{scene:de,filter:Ce,hit:Se,buffer:Z,x:K,y:V}),this._requestDraw(),this}isCached(){return this._cache.has(u)}getClientRect(L){throw new Error('abstract "getClientRect" method call')}_transformedRect(L,O){const J=[{x:L.x,y:L.y},{x:L.x+L.width,y:L.y},{x:L.x+L.width,y:L.y+L.height},{x:L.x,y:L.y+L.height}];let $=1/0,U=1/0,Y=-1/0,K=-1/0;const V=this.getAbsoluteTransform(O);return J.forEach(function(Q){const X=V.point(Q);$===void 0&&($=Y=X.x,U=K=X.y),$=Math.min($,X.x),U=Math.min(U,X.y),Y=Math.max(Y,X.x),K=Math.max(K,X.y)}),{x:$,y:U,width:Y-$,height:K-U}}_drawCachedSceneCanvas(L){L.save(),L._applyOpacity(this),L._applyGlobalCompositeOperation(this);const O=this._getCanvasCache();L.translate(O.x,O.y);const J=this._getCachedSceneCanvas(),$=J.pixelRatio;L.drawImage(J._canvas,0,0,J.width/$,J.height/$),L.restore()}_drawCachedHitCanvas(L){const O=this._getCanvasCache(),J=O.hit;L.save(),L.translate(O.x,O.y),L.drawImage(J._canvas,0,0,J.width/J.pixelRatio,J.height/J.pixelRatio),L.restore()}_getCachedSceneCanvas(){let L=this.filters(),O=this._getCanvasCache(),J=O.scene,$=O.filter,U=$.getContext(),Y,K,V,Q;if(L){if(!this._filterUpToDate){const X=J.pixelRatio;$.setSize(J.width/J.pixelRatio,J.height/J.pixelRatio);try{for(Y=L.length,U.clear(),U.drawImage(J._canvas,0,0,J.getWidth()/X,J.getHeight()/X),K=U.getImageData(0,0,$.getWidth(),$.getHeight()),V=0;V<Y;V++){if(Q=L[V],typeof Q!="function"){r.Util.error("Filter should be type of function, but got "+typeof Q+" instead. Please check correct filters");continue}Q.call(this,K),U.putImageData(K,0,0)}}catch(W){r.Util.error("Unable to apply filter. "+W.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return $}return J}on(L,O){if(this._cache&&this._cache.delete(a),arguments.length===3)return this._delegate.apply(this,arguments);const J=L.split(j);for(let $=0;$<J.length;$++){const Y=J[$].split("."),K=Y[0],V=Y[1]||"";this.eventListeners[K]||(this.eventListeners[K]=[]),this.eventListeners[K].push({name:V,handler:O})}return this}off(L,O){let J=(L||"").split(j),$=J.length,U,Y,K,V,Q,X;if(this._cache&&this._cache.delete(a),!L)for(Y in this.eventListeners)this._off(Y);for(U=0;U<$;U++)if(K=J[U],V=K.split("."),Q=V[0],X=V[1],Q)this.eventListeners[Q]&&this._off(Q,X,O);else for(Y in this.eventListeners)this._off(Y,X,O);return this}dispatchEvent(L){const O={target:this,type:L.type,evt:L};return this.fire(L.type,O),this}addEventListener(L,O){return this.on(L,function(J){O.call(this,J.evt)}),this}removeEventListener(L){return this.off(L),this}_delegate(L,O,J){const $=this;this.on(L,function(U){const Y=U.target.findAncestors(O,!0,$);for(let K=0;K<Y.length;K++)U=r.Util.cloneObject(U),U.currentTarget=Y[K],J.call(Y[K],U)})}remove(){return this.isDragging()&&this.stopDrag(),e.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(l),this._clearSelfAndDescendantCache(o),this._clearSelfAndDescendantCache(h),this._clearSelfAndDescendantCache(C),this._clearSelfAndDescendantCache(T),this._clearSelfAndDescendantCache(p)}_remove(){this._clearCaches();const L=this.getParent();L&&L.children&&(L.children.splice(this.index,1),L._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(L){const O="get"+r.Util._capitalize(L);return r.Util._isFunction(this[O])?this[O]():this.attrs[L]}getAncestors(){let L=this.getParent(),O=[];for(;L;)O.push(L),L=L.getParent();return O}getAttrs(){return this.attrs||{}}setAttrs(L){return this._batchTransformChanges(()=>{let O,J;if(!L)return this;for(O in L)O!==A&&(J=S+r.Util._capitalize(O),r.Util._isFunction(this[J])?this[J](L[O]):this._setAttr(O,L[O]))}),this}isListening(){return this._getCache(p,this._isListening)}_isListening(L){if(!this.listening())return!1;const J=this.getParent();return J&&J!==L&&this!==L?J._isListening(L):!0}isVisible(){return this._getCache(T,this._isVisible)}_isVisible(L){if(!this.visible())return!1;const J=this.getParent();return J&&J!==L&&this!==L?J._isVisible(L):!0}shouldDrawHit(L,O=!1){if(L)return this._isVisible(L)&&this._isListening(L);const J=this.getLayer();let $=!1;e.DD._dragElements.forEach(Y=>{Y.dragStatus==="dragging"&&(Y.node.nodeType==="Stage"||Y.node.getLayer()===J)&&($=!0)});const U=!O&&!i.Konva.hitOnDragEnabled&&($||i.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!U}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let L=this.getDepth(),O=this,J=0,$,U,Y,K;function V(X){for($=[],U=X.length,Y=0;Y<U;Y++)K=X[Y],J++,K.nodeType!==I&&($=$.concat(K.getChildren().slice())),K._id===O._id&&(Y=U);$.length>0&&$[0].getDepth()<=L&&V($)}const Q=this.getStage();return O.nodeType!==D&&Q&&V(Q.getChildren()),J}getDepth(){let L=0,O=this.parent;for(;O;)L++,O=O.parent;return L}_batchTransformChanges(L){this._batchingTransformChange=!0,L(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(b),this._clearSelfAndDescendantCache(l)),this._needClearTransformCache=!1}setPosition(L){return this._batchTransformChanges(()=>{this.x(L.x),this.y(L.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const L=this.getStage();if(!L)return null;const O=L.getPointerPosition();if(!O)return null;const J=this.getAbsoluteTransform().copy();return J.invert(),J.point(O)}getAbsolutePosition(L){let O=!1,J=this.parent;for(;J;){if(J.isCached()){O=!0;break}J=J.parent}O&&!L&&(L=!0);const $=this.getAbsoluteTransform(L).getMatrix(),U=new r.Transform,Y=this.offset();return U.m=$.slice(),U.translate(Y.x,Y.y),U.getTranslation()}setAbsolutePosition(L){const{x:O,y:J,...$}=this._clearTransform();this.attrs.x=O,this.attrs.y=J,this._clearCache(b);const U=this._getAbsoluteTransform().copy();return U.invert(),U.translate(L.x,L.y),L={x:this.attrs.x+U.getTranslation().x,y:this.attrs.y+U.getTranslation().y},this._setTransform($),this.setPosition({x:L.x,y:L.y}),this._clearCache(b),this._clearSelfAndDescendantCache(l),this}_setTransform(L){let O;for(O in L)this.attrs[O]=L[O]}_clearTransform(){const L={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,L}move(L){let O=L.x,J=L.y,$=this.x(),U=this.y();return O!==void 0&&($+=O),J!==void 0&&(U+=J),this.setPosition({x:$,y:U}),this}_eachAncestorReverse(L,O){let J=[],$=this.getParent(),U,Y;if(!(O&&O._id===this._id)){for(J.unshift(this);$&&(!O||$._id!==O._id);)J.unshift($),$=$.parent;for(U=J.length,Y=0;Y<U;Y++)L(J[Y])}}rotate(L){return this.rotation(this.rotation()+L),this}moveToTop(){if(!this.parent)return r.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const L=this.index,O=this.parent.getChildren().length;return L<O-1?(this.parent.children.splice(L,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return r.Util.warn("Node has no parent. moveUp function is ignored."),!1;const L=this.index,O=this.parent.getChildren().length;return L<O-1?(this.parent.children.splice(L,1),this.parent.children.splice(L+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return r.Util.warn("Node has no parent. moveDown function is ignored."),!1;const L=this.index;return L>0?(this.parent.children.splice(L,1),this.parent.children.splice(L-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return r.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const L=this.index;return L>0?(this.parent.children.splice(L,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(L){if(!this.parent)return r.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(L<0||L>=this.parent.children.length)&&r.Util.warn("Unexpected value "+L+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const O=this.index;return this.parent.children.splice(O,1),this.parent.children.splice(L,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(o,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let L=this.opacity();const O=this.getParent();return O&&!O._isUnderCache&&(L*=O.getAbsoluteOpacity()),L}moveTo(L){return this.getParent()!==L&&(this._remove(),L.add(this)),this}toObject(){let L=this.getAttrs(),O,J,$,U,Y;const K={attrs:{},className:this.getClassName()};for(O in L)J=L[O],Y=r.Util.isObject(J)&&!r.Util._isPlainObject(J)&&!r.Util._isArray(J),!Y&&($=typeof this[O]=="function"&&this[O],delete L[O],U=$?$.call(this):null,L[O]=J,U!==J&&(K.attrs[O]=J));return r.Util._prepareToStringify(K)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(L,O,J){const $=[];O&&this._isMatch(L)&&$.push(this);let U=this.parent;for(;U;){if(U===J)return $;U._isMatch(L)&&$.push(U),U=U.parent}return $}isAncestorOf(L){return!1}findAncestor(L,O,J){return this.findAncestors(L,O,J)[0]}_isMatch(L){if(!L)return!1;if(typeof L=="function")return L(this);let O=L.replace(/ /g,"").split(","),J=O.length,$,U;for($=0;$<J;$++)if(U=O[$],r.Util.isValidSelector(U)||(r.Util.warn('Selector "'+U+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),r.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),r.Util.warn("Konva is awesome, right?")),U.charAt(0)==="#"){if(this.id()===U.slice(1))return!0}else if(U.charAt(0)==="."){if(this.hasName(U.slice(1)))return!0}else if(this.className===U||this.nodeType===U)return!0;return!1}getLayer(){const L=this.getParent();return L?L.getLayer():null}getStage(){return this._getCache(C,this._getStage)}_getStage(){const L=this.getParent();return L?L.getStage():null}fire(L,O={},J){return O.target=O.target||this,J?this._fireAndBubble(L,O):this._fire(L,O),this}getAbsoluteTransform(L){return L?this._getAbsoluteTransform(L):this._getCache(l,this._getAbsoluteTransform)}_getAbsoluteTransform(L){let O;if(L)return O=new r.Transform,this._eachAncestorReverse(function(J){const $=J.transformsEnabled();$==="all"?O.multiply(J.getTransform()):$==="position"&&O.translate(J.x()-J.offsetX(),J.y()-J.offsetY())},L),O;{O=this._cache.get(l)||new r.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(O):O.reset();const J=this.transformsEnabled();if(J==="all")O.multiply(this.getTransform());else if(J==="position"){const $=this.attrs.x||0,U=this.attrs.y||0,Y=this.attrs.offsetX||0,K=this.attrs.offsetY||0;O.translate($-Y,U-K)}return O.dirty=!1,O}}getAbsoluteScale(L){let O=this;for(;O;)O._isUnderCache&&(L=O),O=O.getParent();const $=this.getAbsoluteTransform(L).decompose();return{x:$.scaleX,y:$.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(b,this._getTransform)}_getTransform(){var L,O;const J=this._cache.get(b)||new r.Transform;J.reset();const $=this.x(),U=this.y(),Y=i.Konva.getAngle(this.rotation()),K=(L=this.attrs.scaleX)!==null&&L!==void 0?L:1,V=(O=this.attrs.scaleY)!==null&&O!==void 0?O:1,Q=this.attrs.skewX||0,X=this.attrs.skewY||0,W=this.attrs.offsetX||0,se=this.attrs.offsetY||0;return($!==0||U!==0)&&J.translate($,U),Y!==0&&J.rotate(Y),(Q!==0||X!==0)&&J.skew(Q,X),(K!==1||V!==1)&&J.scale(K,V),(W!==0||se!==0)&&J.translate(-1*W,-1*se),J.dirty=!1,J}clone(L){let O=r.Util.cloneObject(this.attrs),J,$,U,Y,K;for(J in L)O[J]=L[J];const V=new this.constructor(O);for(J in this.eventListeners)for($=this.eventListeners[J],U=$.length,Y=0;Y<U;Y++)K=$[Y],K.name.indexOf(f)<0&&(V.eventListeners[J]||(V.eventListeners[J]=[]),V.eventListeners[J].push(K));return V}_toKonvaCanvas(L){L=L||{};const O=this.getClientRect(),J=this.getStage(),$=L.x!==void 0?L.x:Math.floor(O.x),U=L.y!==void 0?L.y:Math.floor(O.y),Y=L.pixelRatio||1,K=new n.SceneCanvas({width:L.width||Math.ceil(O.width)||(J?J.width():0),height:L.height||Math.ceil(O.height)||(J?J.height():0),pixelRatio:Y}),V=K.getContext(),Q=new n.SceneCanvas({width:K.width/K.pixelRatio+Math.abs($),height:K.height/K.pixelRatio+Math.abs(U),pixelRatio:K.pixelRatio});return L.imageSmoothingEnabled===!1&&(V._context.imageSmoothingEnabled=!1),V.save(),($||U)&&V.translate(-1*$,-1*U),this.drawScene(K,void 0,Q),V.restore(),K}toCanvas(L){return this._toKonvaCanvas(L)._canvas}toDataURL(L){L=L||{};const O=L.mimeType||null,J=L.quality||null,$=this._toKonvaCanvas(L).toDataURL(O,J);return L.callback&&L.callback($),$}toImage(L){return new Promise((O,J)=>{try{const $=L==null?void 0:L.callback;$&&delete L.callback,r.Util._urlToImage(this.toDataURL(L),function(U){O(U),$==null||$(U)})}catch($){J($)}})}toBlob(L){return new Promise((O,J)=>{try{const $=L==null?void 0:L.callback;$&&delete L.callback,this.toCanvas(L).toBlob(U=>{O(U),$==null||$(U)},L==null?void 0:L.mimeType,L==null?void 0:L.quality)}catch($){J($)}})}setSize(L){return this.width(L.width),this.height(L.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():i.Konva.dragDistance}_off(L,O,J){let $=this.eventListeners[L],U,Y,K;for(U=0;U<$.length;U++)if(Y=$[U].name,K=$[U].handler,(Y!=="konva"||O==="konva")&&(!O||Y===O)&&(!J||J===K)){if($.splice(U,1),$.length===0){delete this.eventListeners[L];break}U--}}_fireChangeEvent(L,O,J){this._fire(L+d,{oldVal:O,newVal:J})}addName(L){if(!this.hasName(L)){const O=this.name(),J=O?O+" "+L:L;this.name(J)}return this}hasName(L){if(!L)return!1;const O=this.name();return O?(O||"").split(/\s/g).indexOf(L)!==-1:!1}removeName(L){const O=(this.name()||"").split(/\s/g),J=O.indexOf(L);return J!==-1&&(O.splice(J,1),this.name(O.join(" "))),this}setAttr(L,O){const J=this[S+r.Util._capitalize(L)];return r.Util._isFunction(J)?J.call(this,O):this._setAttr(L,O),this}_requestDraw(){if(i.Konva.autoDrawEnabled){const L=this.getLayer()||this.getStage();L==null||L.batchDraw()}}_setAttr(L,O){const J=this.attrs[L];J===O&&!r.Util.isObject(O)||(O==null?delete this.attrs[L]:this.attrs[L]=O,this._shouldFireChangeEvents&&this._fireChangeEvent(L,J,O),this._requestDraw())}_setComponentAttr(L,O,J){let $;J!==void 0&&($=this.attrs[L],$||(this.attrs[L]=this.getAttr(L)),this.attrs[L][O]=J,this._fireChangeEvent(L,$,J))}_fireAndBubble(L,O,J){O&&this.nodeType===I&&(O.target=this);const $=[g,v,w,m,y,x];if(!($.indexOf(L)!==-1&&(J&&(this===J||this.isAncestorOf&&this.isAncestorOf(J))||this.nodeType==="Stage"&&!J))){this._fire(L,O);const Y=$.indexOf(L)!==-1&&J&&J.isAncestorOf&&J.isAncestorOf(this)&&!J.isAncestorOf(this.parent);(O&&!O.cancelBubble||!O)&&this.parent&&this.parent.isListening()&&!Y&&(J&&J.parent?this._fireAndBubble.call(this.parent,L,O,J):this._fireAndBubble.call(this.parent,L,O))}}_getProtoListeners(L){var O,J,$;const U=(O=this._cache.get(a))!==null&&O!==void 0?O:{};let Y=U==null?void 0:U[L];if(Y===void 0){Y=[];let K=Object.getPrototypeOf(this);for(;K;){const V=($=(J=K.eventListeners)===null||J===void 0?void 0:J[L])!==null&&$!==void 0?$:[];Y.push(...V),K=Object.getPrototypeOf(K)}U[L]=Y,this._cache.set(a,U)}return Y}_fire(L,O){O=O||{},O.currentTarget=this,O.type=L;const J=this._getProtoListeners(L);if(J)for(let U=0;U<J.length;U++)J[U].handler.call(this,O);const $=this.eventListeners[L];if($)for(let U=0;U<$.length;U++)$[U].handler.call(this,O)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(L){const O=L?L.pointerId:void 0,J=this.getStage(),$=this.getAbsolutePosition();if(!J)return;const U=J._getPointerById(O)||J._changedPointerPositions[0]||$;e.DD._dragElements.set(this._id,{node:this,startPointerPos:U,offset:{x:U.x-$.x,y:U.y-$.y},dragStatus:"ready",pointerId:O})}startDrag(L,O=!0){e.DD._dragElements.has(this._id)||this._createDragElement(L);const J=e.DD._dragElements.get(this._id);J.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:L&&L.evt},O)}_setDragPosition(L,O){const J=this.getStage()._getPointerById(O.pointerId);if(!J)return;let $={x:J.x-O.offset.x,y:J.y-O.offset.y};const U=this.dragBoundFunc();if(U!==void 0){const Y=U.call(this,$,L);Y?$=Y:r.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==$.x||this._lastPos.y!==$.y)&&(this.setAbsolutePosition($),this._requestDraw()),this._lastPos=$}stopDrag(L){const O=e.DD._dragElements.get(this._id);O&&(O.dragStatus="stopped"),e.DD._endDragBefore(L),e.DD._endDragAfter(L)}setDraggable(L){this._setAttr("draggable",L),this._dragChange()}isDragging(){const L=e.DD._dragElements.get(this._id);return L?L.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(L){if(!(!(L.evt.button!==void 0)||i.Konva.dragButtons.indexOf(L.evt.button)>=0)||this.isDragging())return;let $=!1;e.DD._dragElements.forEach(U=>{this.isAncestorOf(U.node)&&($=!0)}),$||this._createDragElement(L)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const O=e.DD._dragElements.get(this._id),J=O&&O.dragStatus==="dragging",$=O&&O.dragStatus==="ready";J?this.stopDrag():$&&e.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(L={x:0,y:0}){const O=this.getStage();if(!O)return!1;const J={x:-L.x,y:-L.y,width:O.width()+2*L.x,height:O.height()+2*L.y};return r.Util.haveIntersection(J,this.getClientRect())}static create(L,O){return r.Util._isString(L)&&(L=JSON.parse(L)),this._createNode(L,O)}static _createNode(L,O){let J=E.prototype.getClassName.call(L),$=L.children,U,Y,K;O&&(L.attrs.container=O),i.Konva[J]||(r.Util.warn('Can not find a node with class name "'+J+'". Fallback to "Shape".'),J="Shape");const V=i.Konva[J];if(U=new V(L.attrs),$)for(Y=$.length,K=0;K<Y;K++)U.add(E._createNode($[K]));return U}}C2.Node=E,E.prototype.nodeType="Node",E.prototype._attrsAffectingSize=[],E.prototype.eventListeners={},E.prototype.on.call(E.prototype,k,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(b),this._clearSelfAndDescendantCache(l)}),E.prototype.on.call(E.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(T)}),E.prototype.on.call(E.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(p)}),E.prototype.on.call(E.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(o)});const z=t.Factory.addGetterSetter;return z(E,"zIndex"),z(E,"absolutePosition"),z(E,"position"),z(E,"x",0,(0,s.getNumberValidator)()),z(E,"y",0,(0,s.getNumberValidator)()),z(E,"globalCompositeOperation","source-over",(0,s.getStringValidator)()),z(E,"opacity",1,(0,s.getNumberValidator)()),z(E,"name","",(0,s.getStringValidator)()),z(E,"id","",(0,s.getStringValidator)()),z(E,"rotation",0,(0,s.getNumberValidator)()),t.Factory.addComponentsGetterSetter(E,"scale",["x","y"]),z(E,"scaleX",1,(0,s.getNumberValidator)()),z(E,"scaleY",1,(0,s.getNumberValidator)()),t.Factory.addComponentsGetterSetter(E,"skew",["x","y"]),z(E,"skewX",0,(0,s.getNumberValidator)()),z(E,"skewY",0,(0,s.getNumberValidator)()),t.Factory.addComponentsGetterSetter(E,"offset",["x","y"]),z(E,"offsetX",0,(0,s.getNumberValidator)()),z(E,"offsetY",0,(0,s.getNumberValidator)()),z(E,"dragDistance",void 0,(0,s.getNumberValidator)()),z(E,"width",0,(0,s.getNumberValidator)()),z(E,"height",0,(0,s.getNumberValidator)()),z(E,"listening",!0,(0,s.getBooleanValidator)()),z(E,"preventDefault",!0,(0,s.getBooleanValidator)()),z(E,"filters",void 0,function(te){return this._filterUpToDate=!1,te}),z(E,"visible",!0,(0,s.getBooleanValidator)()),z(E,"transformsEnabled","all",(0,s.getStringValidator)()),z(E,"size"),z(E,"dragBoundFunc"),z(E,"draggable",!1,(0,s.getBooleanValidator)()),t.Factory.backCompat(E,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),C2}var _2={},TR;function _S(){if(TR)return _2;TR=1,Object.defineProperty(_2,"__esModule",{value:!0}),_2.Container=void 0;const n=Ss(),e=ul(),t=js();let i=class extends e.Node{constructor(){super(...arguments),this.children=[]}getChildren(s){const o=this.children||[];return s?o.filter(s):o}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(s=>{s.parent=null,s.index=0,s.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(s=>{s.parent=null,s.index=0,s.destroy()}),this.children=[],this._requestDraw(),this}add(...s){if(s.length===0)return this;if(s.length>1){for(let a=0;a<s.length;a++)this.add(s[a]);return this}const o=s[0];return o.getParent()?(o.moveTo(this),this):(this._validateAdd(o),o.index=this.getChildren().length,o.parent=this,o._clearCaches(),this.getChildren().push(o),this._fire("add",{child:o}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(s){return this._generalFind(s,!1)}findOne(s){const o=this._generalFind(s,!0);return o.length>0?o[0]:void 0}_generalFind(s,o){const a=[];return this._descendants(l=>{const h=l._isMatch(s);return h&&a.push(l),!!(h&&o)}),a}_descendants(s){let o=!1;const a=this.getChildren();for(const l of a){if(o=s(l),o)return!0;if(l.hasChildren()&&(o=l._descendants(s),o))return!0}return!1}toObject(){const s=e.Node.prototype.toObject.call(this);return s.children=[],this.getChildren().forEach(o=>{s.children.push(o.toObject())}),s}isAncestorOf(s){let o=s.getParent();for(;o;){if(o._id===this._id)return!0;o=o.getParent()}return!1}clone(s){const o=e.Node.prototype.clone.call(this,s);return this.getChildren().forEach(function(a){o.add(a.clone())}),o}getAllIntersections(s){const o=[];return this.find("Shape").forEach(a=>{a.isVisible()&&a.intersects(s)&&o.push(a)}),o}_clearSelfAndDescendantCache(s){var o;super._clearSelfAndDescendantCache(s),!this.isCached()&&((o=this.children)===null||o===void 0||o.forEach(function(a){a._clearSelfAndDescendantCache(s)}))}_setChildrenIndices(){var s;(s=this.children)===null||s===void 0||s.forEach(function(o,a){o.index=a}),this._requestDraw()}drawScene(s,o,a){const l=this.getLayer(),h=s||l&&l.getCanvas(),u=h&&h.getContext(),d=this._getCanvasCache(),A=d&&d.scene,f=h&&h.isCache;if(!this.isVisible()&&!f)return this;if(A){u.save();const p=this.getAbsoluteTransform(o).getMatrix();u.transform(p[0],p[1],p[2],p[3],p[4],p[5]),this._drawCachedSceneCanvas(u),u.restore()}else this._drawChildren("drawScene",h,o,a);return this}drawHit(s,o){if(!this.shouldDrawHit(o))return this;const a=this.getLayer(),l=s||a&&a.hitCanvas,h=l&&l.getContext(),u=this._getCanvasCache();if(u&&u.hit){h.save();const A=this.getAbsoluteTransform(o).getMatrix();h.transform(A[0],A[1],A[2],A[3],A[4],A[5]),this._drawCachedHitCanvas(h),h.restore()}else this._drawChildren("drawHit",l,o);return this}_drawChildren(s,o,a,l){var h;const u=o&&o.getContext(),d=this.clipWidth(),A=this.clipHeight(),f=this.clipFunc(),p=typeof d=="number"&&typeof A=="number"||f,g=a===this;if(p){u.save();const w=this.getAbsoluteTransform(a);let m=w.getMatrix();u.transform(m[0],m[1],m[2],m[3],m[4],m[5]),u.beginPath();let y;if(f)y=f.call(this,u,this);else{const x=this.clipX(),S=this.clipY();u.rect(x||0,S||0,d,A)}u.clip.apply(u,y),m=w.copy().invert().getMatrix(),u.transform(m[0],m[1],m[2],m[3],m[4],m[5])}const v=!g&&this.globalCompositeOperation()!=="source-over"&&s==="drawScene";v&&(u.save(),u._applyGlobalCompositeOperation(this)),(h=this.children)===null||h===void 0||h.forEach(function(w){w[s](o,a,l)}),v&&u.restore(),p&&u.restore()}getClientRect(s={}){var o;const a=s.skipTransform,l=s.relativeTo;let h,u,d,A,f={x:1/0,y:1/0,width:0,height:0};const p=this;(o=this.children)===null||o===void 0||o.forEach(function(w){if(!w.visible())return;const m=w.getClientRect({relativeTo:p,skipShadow:s.skipShadow,skipStroke:s.skipStroke});m.width===0&&m.height===0||(h===void 0?(h=m.x,u=m.y,d=m.x+m.width,A=m.y+m.height):(h=Math.min(h,m.x),u=Math.min(u,m.y),d=Math.max(d,m.x+m.width),A=Math.max(A,m.y+m.height)))});const g=this.find("Shape");let v=!1;for(let w=0;w<g.length;w++)if(g[w]._isVisible(this)){v=!0;break}return v&&h!==void 0?f={x:h,y:u,width:d-h,height:A-u}:f={x:0,y:0,width:0,height:0},a?f:this._transformedRect(f,l)}};return _2.Container=i,n.Factory.addComponentsGetterSetter(i,"clip",["x","y","width","height"]),n.Factory.addGetterSetter(i,"clipX",void 0,(0,t.getNumberValidator)()),n.Factory.addGetterSetter(i,"clipY",void 0,(0,t.getNumberValidator)()),n.Factory.addGetterSetter(i,"clipWidth",void 0,(0,t.getNumberValidator)()),n.Factory.addGetterSetter(i,"clipHeight",void 0,(0,t.getNumberValidator)()),n.Factory.addGetterSetter(i,"clipFunc"),_2}var nB={},np={},BR;function HK(){if(BR)return np;BR=1,Object.defineProperty(np,"__esModule",{value:!0}),np.getCapturedShape=i,np.createEvent=r,np.hasPointerCapture=s,np.setPointerCapture=o,np.releaseCapture=a;const n=gs(),e=new Map,t=n.Konva._global.PointerEvent!==void 0;function i(l){return e.get(l)}function r(l){return{evt:l,pointerId:l.pointerId}}function s(l,h){return e.get(l)===h}function o(l,h){a(l),h.getStage()&&(e.set(l,h),t&&h._fire("gotpointercapture",r(new PointerEvent("gotpointercapture"))))}function a(l,h){const u=e.get(l);if(!u)return;const d=u.getStage();d&&d.content,e.delete(l),t&&u._fire("lostpointercapture",r(new PointerEvent("lostpointercapture")))}return np}var ER;function oGe(){return ER||(ER=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Stage=n.stages=void 0;const e=Oa(),t=Ss(),i=_S(),r=gs(),s=CS(),o=mI(),a=gs(),l=HK(),h="Stage",u="string",d="px",A="mouseout",f="mouseleave",p="mouseover",g="mouseenter",v="mousemove",w="mousedown",m="mouseup",y="pointermove",x="pointerdown",S="pointerup",I="pointercancel",j="lostpointercapture",C="pointerout",b="pointerleave",D="pointerover",T="pointerenter",k="contextmenu",B="touchstart",E="touchend",z="touchmove",te="touchcancel",L="wheel",O=5,J=[[g,"_pointerenter"],[w,"_pointerdown"],[v,"_pointermove"],[m,"_pointerup"],[f,"_pointerleave"],[B,"_pointerdown"],[z,"_pointermove"],[E,"_pointerup"],[te,"_pointercancel"],[p,"_pointerover"],[L,"_wheel"],[k,"_contextmenu"],[x,"_pointerdown"],[y,"_pointermove"],[S,"_pointerup"],[I,"_pointercancel"],[b,"_pointerleave"],[j,"_lostpointercapture"]],$={mouse:{[C]:A,[b]:f,[D]:p,[T]:g,[y]:v,[x]:w,[S]:m,[I]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[C]:"touchout",[b]:"touchleave",[D]:"touchover",[T]:"touchenter",[y]:z,[x]:B,[S]:E,[I]:te,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[C]:C,[b]:b,[D]:D,[T]:T,[y]:y,[x]:x,[S]:S,[I]:I,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},U=X=>X.indexOf("pointer")>=0?"pointer":X.indexOf("touch")>=0?"touch":"mouse",Y=X=>{const W=U(X);if(W==="pointer")return r.Konva.pointerEventsEnabled&&$.pointer;if(W==="touch")return $.touch;if(W==="mouse")return $.mouse};function K(X={}){return(X.clipFunc||X.clipWidth||X.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),X}const V="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";n.stages=[];class Q extends i.Container{constructor(W){super(K(W)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),n.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{K(this.attrs)}),this._checkVisibility()}_validateAdd(W){const se=W.getType()==="Layer",q=W.getType()==="FastLayer";se||q||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const W=this.visible()?"":"none";this.content.style.display=W}setContainer(W){if(typeof W===u){let se;if(W.charAt(0)==="."){const q=W.slice(1);W=document.getElementsByClassName(q)[0]}else W.charAt(0)!=="#"?se=W:se=W.slice(1),W=document.getElementById(se);if(!W)throw"Can not find container in document with id "+se}return this._setAttr("container",W),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),W.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const W=this.children,se=W.length;for(let q=0;q<se;q++)W[q].clear();return this}clone(W){return W||(W={}),W.container=typeof document<"u"&&document.createElement("div"),i.Container.prototype.clone.call(this,W)}destroy(){super.destroy();const W=this.content;W&&e.Util._isInDocument(W)&&this.container().removeChild(W);const se=n.stages.indexOf(this);return se>-1&&n.stages.splice(se,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const W=this._pointerPositions[0]||this._changedPointerPositions[0];return W?{x:W.x,y:W.y}:(e.Util.warn(V),null)}_getPointerById(W){return this._pointerPositions.find(se=>se.id===W)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(W){W=W||{},W.x=W.x||0,W.y=W.y||0,W.width=W.width||this.width(),W.height=W.height||this.height();const se=new s.SceneCanvas({width:W.width,height:W.height,pixelRatio:W.pixelRatio||1}),q=se.getContext()._context,de=this.children;return(W.x||W.y)&&q.translate(-1*W.x,-1*W.y),de.forEach(function(Ce){if(!Ce.isVisible())return;const Se=Ce._toKonvaCanvas(W);q.drawImage(Se._canvas,W.x,W.y,Se.getWidth()/Se.getPixelRatio(),Se.getHeight()/Se.getPixelRatio())}),se}getIntersection(W){if(!W)return null;const se=this.children,q=se.length,de=q-1;for(let Ce=de;Ce>=0;Ce--){const Se=se[Ce].getIntersection(W);if(Se)return Se}return null}_resizeDOM(){const W=this.width(),se=this.height();this.content&&(this.content.style.width=W+d,this.content.style.height=se+d),this.bufferCanvas.setSize(W,se),this.bufferHitCanvas.setSize(W,se),this.children.forEach(q=>{q.setSize({width:W,height:se}),q.draw()})}add(W,...se){if(arguments.length>1){for(let de=0;de<arguments.length;de++)this.add(arguments[de]);return this}super.add(W);const q=this.children.length;return q>O&&e.Util.warn("The stage has "+q+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),W.setSize({width:this.width(),height:this.height()}),W.draw(),r.Konva.isBrowser&&this.content.appendChild(W.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(W){return l.hasPointerCapture(W,this)}setPointerCapture(W){l.setPointerCapture(W,this)}releaseCapture(W){l.releaseCapture(W,this)}getLayers(){return this.children}_bindContentEvents(){r.Konva.isBrowser&&J.forEach(([W,se])=>{this.content.addEventListener(W,q=>{this[se](q)},{passive:!1})})}_pointerenter(W){this.setPointersPositions(W);const se=Y(W.type);se&&this._fire(se.pointerenter,{evt:W,target:this,currentTarget:this})}_pointerover(W){this.setPointersPositions(W);const se=Y(W.type);se&&this._fire(se.pointerover,{evt:W,target:this,currentTarget:this})}_getTargetShape(W){let se=this[W+"targetShape"];return se&&!se.getStage()&&(se=null),se}_pointerleave(W){const se=Y(W.type),q=U(W.type);if(!se)return;this.setPointersPositions(W);const de=this._getTargetShape(q),Ce=!(r.Konva.isDragging()||r.Konva.isTransforming())||r.Konva.hitOnDragEnabled;de&&Ce?(de._fireAndBubble(se.pointerout,{evt:W}),de._fireAndBubble(se.pointerleave,{evt:W}),this._fire(se.pointerleave,{evt:W,target:this,currentTarget:this}),this[q+"targetShape"]=null):Ce&&(this._fire(se.pointerleave,{evt:W,target:this,currentTarget:this}),this._fire(se.pointerout,{evt:W,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(W){const se=Y(W.type),q=U(W.type);if(!se)return;this.setPointersPositions(W);let de=!1;this._changedPointerPositions.forEach(Ce=>{const Se=this.getIntersection(Ce);if(o.DD.justDragged=!1,r.Konva["_"+q+"ListenClick"]=!0,!Se||!Se.isListening()){this[q+"ClickStartShape"]=void 0;return}r.Konva.capturePointerEventsEnabled&&Se.setPointerCapture(Ce.id),this[q+"ClickStartShape"]=Se,Se._fireAndBubble(se.pointerdown,{evt:W,pointerId:Ce.id}),de=!0;const fe=W.type.indexOf("touch")>=0;Se.preventDefault()&&W.cancelable&&fe&&W.preventDefault()}),de||this._fire(se.pointerdown,{evt:W,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(W){const se=Y(W.type),q=U(W.type);if(!se||(r.Konva.isDragging()&&o.DD.node.preventDefault()&&W.cancelable&&W.preventDefault(),this.setPointersPositions(W),!(!(r.Konva.isDragging()||r.Konva.isTransforming())||r.Konva.hitOnDragEnabled)))return;const Ce={};let Se=!1;const fe=this._getTargetShape(q);this._changedPointerPositions.forEach(M=>{const Z=l.getCapturedShape(M.id)||this.getIntersection(M),Ae=M.id,ie={evt:W,pointerId:Ae},ee=fe!==Z;if(ee&&fe&&(fe._fireAndBubble(se.pointerout,{...ie},Z),fe._fireAndBubble(se.pointerleave,{...ie},Z)),Z){if(Ce[Z._id])return;Ce[Z._id]=!0}Z&&Z.isListening()?(Se=!0,ee&&(Z._fireAndBubble(se.pointerover,{...ie},fe),Z._fireAndBubble(se.pointerenter,{...ie},fe),this[q+"targetShape"]=Z),Z._fireAndBubble(se.pointermove,{...ie})):fe&&(this._fire(se.pointerover,{evt:W,target:this,currentTarget:this,pointerId:Ae}),this[q+"targetShape"]=null)}),Se||this._fire(se.pointermove,{evt:W,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(W){const se=Y(W.type),q=U(W.type);if(!se)return;this.setPointersPositions(W);const de=this[q+"ClickStartShape"],Ce=this[q+"ClickEndShape"],Se={};let fe=!1;this._changedPointerPositions.forEach(M=>{const Z=l.getCapturedShape(M.id)||this.getIntersection(M);if(Z){if(Z.releaseCapture(M.id),Se[Z._id])return;Se[Z._id]=!0}const Ae=M.id,ie={evt:W,pointerId:Ae};let ee=!1;r.Konva["_"+q+"InDblClickWindow"]?(ee=!0,clearTimeout(this[q+"DblTimeout"])):o.DD.justDragged||(r.Konva["_"+q+"InDblClickWindow"]=!0,clearTimeout(this[q+"DblTimeout"])),this[q+"DblTimeout"]=setTimeout(function(){r.Konva["_"+q+"InDblClickWindow"]=!1},r.Konva.dblClickWindow),Z&&Z.isListening()?(fe=!0,this[q+"ClickEndShape"]=Z,Z._fireAndBubble(se.pointerup,{...ie}),r.Konva["_"+q+"ListenClick"]&&de&&de===Z&&(Z._fireAndBubble(se.pointerclick,{...ie}),ee&&Ce&&Ce===Z&&Z._fireAndBubble(se.pointerdblclick,{...ie}))):(this[q+"ClickEndShape"]=null,r.Konva["_"+q+"ListenClick"]&&this._fire(se.pointerclick,{evt:W,target:this,currentTarget:this,pointerId:Ae}),ee&&this._fire(se.pointerdblclick,{evt:W,target:this,currentTarget:this,pointerId:Ae}))}),fe||this._fire(se.pointerup,{evt:W,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),r.Konva["_"+q+"ListenClick"]=!1,W.cancelable&&q!=="touch"&&q!=="pointer"&&W.preventDefault()}_contextmenu(W){this.setPointersPositions(W);const se=this.getIntersection(this.getPointerPosition());se&&se.isListening()?se._fireAndBubble(k,{evt:W}):this._fire(k,{evt:W,target:this,currentTarget:this})}_wheel(W){this.setPointersPositions(W);const se=this.getIntersection(this.getPointerPosition());se&&se.isListening()?se._fireAndBubble(L,{evt:W}):this._fire(L,{evt:W,target:this,currentTarget:this})}_pointercancel(W){this.setPointersPositions(W);const se=l.getCapturedShape(W.pointerId)||this.getIntersection(this.getPointerPosition());se&&se._fireAndBubble(S,l.createEvent(W)),l.releaseCapture(W.pointerId)}_lostpointercapture(W){l.releaseCapture(W.pointerId)}setPointersPositions(W){const se=this._getContentPosition();let q=null,de=null;W=W||window.event,W.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(W.touches,Ce=>{this._pointerPositions.push({id:Ce.identifier,x:(Ce.clientX-se.left)/se.scaleX,y:(Ce.clientY-se.top)/se.scaleY})}),Array.prototype.forEach.call(W.changedTouches||W.touches,Ce=>{this._changedPointerPositions.push({id:Ce.identifier,x:(Ce.clientX-se.left)/se.scaleX,y:(Ce.clientY-se.top)/se.scaleY})})):(q=(W.clientX-se.left)/se.scaleX,de=(W.clientY-se.top)/se.scaleY,this.pointerPos={x:q,y:de},this._pointerPositions=[{x:q,y:de,id:e.Util._getFirstPointerId(W)}],this._changedPointerPositions=[{x:q,y:de,id:e.Util._getFirstPointerId(W)}])}_setPointerPosition(W){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(W)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const W=this.content.getBoundingClientRect();return{top:W.top,left:W.left,scaleX:W.width/this.content.clientWidth||1,scaleY:W.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new s.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new s.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!r.Konva.isBrowser)return;const W=this.container();if(!W)throw"Stage has no container. A container is required.";W.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),W.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(W){W.batchDraw()}),this}}n.Stage=Q,Q.prototype.nodeType=h,(0,a._registerNode)(Q),t.Factory.addGetterSetter(Q,"container"),r.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{n.stages.forEach(X=>{X.batchDraw()})})})(nB)),nB}var S2={},iB={},FR;function ec(){return FR||(FR=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Shape=n.shapes=void 0;const e=gs(),t=Oa(),i=Ss(),r=ul(),s=js(),o=gs(),a=HK(),l="hasShadow",h="shadowRGBA",u="patternImage",d="linearGradient",A="radialGradient";let f;function p(){return f||(f=t.Util.createCanvasElement().getContext("2d"),f)}n.shapes={};function g(b){const D=this.attrs.fillRule;D?b.fill(D):b.fill()}function v(b){b.stroke()}function w(b){const D=this.attrs.fillRule;D?b.fill(D):b.fill()}function m(b){b.stroke()}function y(){this._clearCache(l)}function x(){this._clearCache(h)}function S(){this._clearCache(u)}function I(){this._clearCache(d)}function j(){this._clearCache(A)}class C extends r.Node{constructor(D){super(D);let T;for(;T=t.Util.getRandomColor(),!(T&&!(T in n.shapes)););this.colorKey=T,n.shapes[T]=this}getContext(){return t.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return t.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(l,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(u,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const T=p().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(T&&T.setTransform){const k=new t.Transform;k.translate(this.fillPatternX(),this.fillPatternY()),k.rotate(e.Konva.getAngle(this.fillPatternRotation())),k.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),k.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const B=k.getMatrix(),E=typeof DOMMatrix>"u"?{a:B[0],b:B[1],c:B[2],d:B[3],e:B[4],f:B[5]}:new DOMMatrix(B);T.setTransform(E)}return T}}_getLinearGradient(){return this._getCache(d,this.__getLinearGradient)}__getLinearGradient(){const D=this.fillLinearGradientColorStops();if(D){const T=p(),k=this.fillLinearGradientStartPoint(),B=this.fillLinearGradientEndPoint(),E=T.createLinearGradient(k.x,k.y,B.x,B.y);for(let z=0;z<D.length;z+=2)E.addColorStop(D[z],D[z+1]);return E}}_getRadialGradient(){return this._getCache(A,this.__getRadialGradient)}__getRadialGradient(){const D=this.fillRadialGradientColorStops();if(D){const T=p(),k=this.fillRadialGradientStartPoint(),B=this.fillRadialGradientEndPoint(),E=T.createRadialGradient(k.x,k.y,this.fillRadialGradientStartRadius(),B.x,B.y,this.fillRadialGradientEndRadius());for(let z=0;z<D.length;z+=2)E.addColorStop(D[z],D[z+1]);return E}}getShadowRGBA(){return this._getCache(h,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const D=t.Util.colorToRGBA(this.shadowColor());if(D)return"rgba("+D.r+","+D.g+","+D.b+","+D.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const D=this.hitStrokeWidth();return D==="auto"?this.hasStroke():this.strokeEnabled()&&!!D}intersects(D){const T=this.getStage();if(!T)return!1;const k=T.bufferHitCanvas;return k.getContext().clear(),this.drawHit(k,void 0,!0),k.context.getImageData(Math.round(D.x),Math.round(D.y),1,1).data[3]>0}destroy(){return r.Node.prototype.destroy.call(this),delete n.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(D){var T;if(!((T=this.attrs.perfectDrawEnabled)!==null&&T!==void 0?T:!0))return!1;const B=D||this.hasFill(),E=this.hasStroke(),z=this.getAbsoluteOpacity()!==1;if(B&&E&&z)return!0;const te=this.hasShadow(),L=this.shadowForStrokeEnabled();return!!(B&&E&&te&&L)}setStrokeHitEnabled(D){t.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),D?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const D=this.size();return{x:this._centroid?-D.width/2:0,y:this._centroid?-D.height/2:0,width:D.width,height:D.height}}getClientRect(D={}){let T=!1,k=this.getParent();for(;k;){if(k.isCached()){T=!0;break}k=k.getParent()}const B=D.skipTransform,E=D.relativeTo||T&&this.getStage()||void 0,z=this.getSelfRect(),L=!D.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,O=z.width+L,J=z.height+L,$=!D.skipShadow&&this.hasShadow(),U=$?this.shadowOffsetX():0,Y=$?this.shadowOffsetY():0,K=O+Math.abs(U),V=J+Math.abs(Y),Q=$&&this.shadowBlur()||0,X=K+Q*2,W=V+Q*2,se={width:X,height:W,x:-(L/2+Q)+Math.min(U,0)+z.x,y:-(L/2+Q)+Math.min(Y,0)+z.y};return B?se:this._transformedRect(se,E)}drawScene(D,T,k){const B=this.getLayer(),E=D||B.getCanvas(),z=E.getContext(),te=this._getCanvasCache(),L=this.getSceneFunc(),O=this.hasShadow();let J;const $=T===this;if(!this.isVisible()&&!$)return this;if(te){z.save();const U=this.getAbsoluteTransform(T).getMatrix();return z.transform(U[0],U[1],U[2],U[3],U[4],U[5]),this._drawCachedSceneCanvas(z),z.restore(),this}if(!L)return this;if(z.save(),this._useBufferCanvas()){J=this.getStage();const U=k||J.bufferCanvas,Y=U.getContext();Y.clear(),Y.save(),Y._applyLineJoin(this);const K=this.getAbsoluteTransform(T).getMatrix();Y.transform(K[0],K[1],K[2],K[3],K[4],K[5]),L.call(this,Y,this),Y.restore();const V=U.pixelRatio;O&&z._applyShadow(this),z._applyOpacity(this),z._applyGlobalCompositeOperation(this),z.drawImage(U._canvas,U.x||0,U.y||0,U.width/V,U.height/V)}else{if(z._applyLineJoin(this),!$){const U=this.getAbsoluteTransform(T).getMatrix();z.transform(U[0],U[1],U[2],U[3],U[4],U[5]),z._applyOpacity(this),z._applyGlobalCompositeOperation(this)}O&&z._applyShadow(this),L.call(this,z,this)}return z.restore(),this}drawHit(D,T,k=!1){if(!this.shouldDrawHit(T,k))return this;const B=this.getLayer(),E=D||B.hitCanvas,z=E&&E.getContext(),te=this.hitFunc()||this.sceneFunc(),L=this._getCanvasCache(),O=L&&L.hit;if(this.colorKey||t.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),O){z.save();const $=this.getAbsoluteTransform(T).getMatrix();return z.transform($[0],$[1],$[2],$[3],$[4],$[5]),this._drawCachedHitCanvas(z),z.restore(),this}if(!te)return this;if(z.save(),z._applyLineJoin(this),!(this===T)){const $=this.getAbsoluteTransform(T).getMatrix();z.transform($[0],$[1],$[2],$[3],$[4],$[5])}return te.call(this,z,this),z.restore(),this}drawHitFromCache(D=0){const T=this._getCanvasCache(),k=this._getCachedSceneCanvas(),B=T.hit,E=B.getContext(),z=B.getWidth(),te=B.getHeight();E.clear(),E.drawImage(k._canvas,0,0,z,te);try{const L=E.getImageData(0,0,z,te),O=L.data,J=O.length,$=t.Util._hexToRgb(this.colorKey);for(let U=0;U<J;U+=4)O[U+3]>D?(O[U]=$.r,O[U+1]=$.g,O[U+2]=$.b,O[U+3]=255):O[U+3]=0;E.putImageData(L,0,0)}catch(L){t.Util.error("Unable to draw hit graph from cached scene canvas. "+L.message)}return this}hasPointerCapture(D){return a.hasPointerCapture(D,this)}setPointerCapture(D){a.setPointerCapture(D,this)}releaseCapture(D){a.releaseCapture(D,this)}}n.Shape=C,C.prototype._fillFunc=g,C.prototype._strokeFunc=v,C.prototype._fillFuncHit=w,C.prototype._strokeFuncHit=m,C.prototype._centroid=!1,C.prototype.nodeType="Shape",(0,o._registerNode)(C),C.prototype.eventListeners={},C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",y),C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",x),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",S),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",I),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",j),i.Factory.addGetterSetter(C,"stroke",void 0,(0,s.getStringOrGradientValidator)()),i.Factory.addGetterSetter(C,"strokeWidth",2,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillAfterStrokeEnabled",!1),i.Factory.addGetterSetter(C,"hitStrokeWidth","auto",(0,s.getNumberOrAutoValidator)()),i.Factory.addGetterSetter(C,"strokeHitEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(C,"perfectDrawEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(C,"shadowForStrokeEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(C,"lineJoin"),i.Factory.addGetterSetter(C,"lineCap"),i.Factory.addGetterSetter(C,"sceneFunc"),i.Factory.addGetterSetter(C,"hitFunc"),i.Factory.addGetterSetter(C,"dash"),i.Factory.addGetterSetter(C,"dashOffset",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"shadowColor",void 0,(0,s.getStringValidator)()),i.Factory.addGetterSetter(C,"shadowBlur",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"shadowOpacity",1,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(C,"shadowOffset",["x","y"]),i.Factory.addGetterSetter(C,"shadowOffsetX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"shadowOffsetY",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillPatternImage"),i.Factory.addGetterSetter(C,"fill",void 0,(0,s.getStringOrGradientValidator)()),i.Factory.addGetterSetter(C,"fillPatternX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillPatternY",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillLinearGradientColorStops"),i.Factory.addGetterSetter(C,"strokeLinearGradientColorStops"),i.Factory.addGetterSetter(C,"fillRadialGradientStartRadius",0),i.Factory.addGetterSetter(C,"fillRadialGradientEndRadius",0),i.Factory.addGetterSetter(C,"fillRadialGradientColorStops"),i.Factory.addGetterSetter(C,"fillPatternRepeat","repeat"),i.Factory.addGetterSetter(C,"fillEnabled",!0),i.Factory.addGetterSetter(C,"strokeEnabled",!0),i.Factory.addGetterSetter(C,"shadowEnabled",!0),i.Factory.addGetterSetter(C,"dashEnabled",!0),i.Factory.addGetterSetter(C,"strokeScaleEnabled",!0),i.Factory.addGetterSetter(C,"fillPriority","color"),i.Factory.addComponentsGetterSetter(C,"fillPatternOffset",["x","y"]),i.Factory.addGetterSetter(C,"fillPatternOffsetX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillPatternOffsetY",0,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(C,"fillPatternScale",["x","y"]),i.Factory.addGetterSetter(C,"fillPatternScaleX",1,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillPatternScaleY",1,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(C,"fillLinearGradientStartPoint",["x","y"]),i.Factory.addComponentsGetterSetter(C,"strokeLinearGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(C,"fillLinearGradientStartPointX",0),i.Factory.addGetterSetter(C,"strokeLinearGradientStartPointX",0),i.Factory.addGetterSetter(C,"fillLinearGradientStartPointY",0),i.Factory.addGetterSetter(C,"strokeLinearGradientStartPointY",0),i.Factory.addComponentsGetterSetter(C,"fillLinearGradientEndPoint",["x","y"]),i.Factory.addComponentsGetterSetter(C,"strokeLinearGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(C,"fillLinearGradientEndPointX",0),i.Factory.addGetterSetter(C,"strokeLinearGradientEndPointX",0),i.Factory.addGetterSetter(C,"fillLinearGradientEndPointY",0),i.Factory.addGetterSetter(C,"strokeLinearGradientEndPointY",0),i.Factory.addComponentsGetterSetter(C,"fillRadialGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(C,"fillRadialGradientStartPointX",0),i.Factory.addGetterSetter(C,"fillRadialGradientStartPointY",0),i.Factory.addComponentsGetterSetter(C,"fillRadialGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(C,"fillRadialGradientEndPointX",0),i.Factory.addGetterSetter(C,"fillRadialGradientEndPointY",0),i.Factory.addGetterSetter(C,"fillPatternRotation",0),i.Factory.addGetterSetter(C,"fillRule",void 0,(0,s.getStringValidator)()),i.Factory.backCompat(C,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(iB)),iB}var kR;function WK(){if(kR)return S2;kR=1,Object.defineProperty(S2,"__esModule",{value:!0}),S2.Layer=void 0;const n=Oa(),e=_S(),t=ul(),i=Ss(),r=CS(),s=js(),o=ec(),a=gs(),l="#",h="beforeDraw",u="draw",d=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],A=d.length;class f extends e.Container{constructor(g){super(g),this.canvas=new r.SceneCanvas,this.hitCanvas=new r.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(g){return this.getContext().clear(g),this.getHitCanvas().getContext().clear(g),this}setZIndex(g){super.setZIndex(g);const v=this.getStage();return v&&v.content&&(v.content.removeChild(this.getNativeCanvasElement()),g<v.children.length-1?v.content.insertBefore(this.getNativeCanvasElement(),v.children[g+1].getCanvas()._canvas):v.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){t.Node.prototype.moveToTop.call(this);const g=this.getStage();return g&&g.content&&(g.content.removeChild(this.getNativeCanvasElement()),g.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!t.Node.prototype.moveUp.call(this))return!1;const v=this.getStage();return!v||!v.content?!1:(v.content.removeChild(this.getNativeCanvasElement()),this.index<v.children.length-1?v.content.insertBefore(this.getNativeCanvasElement(),v.children[this.index+1].getCanvas()._canvas):v.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(t.Node.prototype.moveDown.call(this)){const g=this.getStage();if(g){const v=g.children;g.content&&(g.content.removeChild(this.getNativeCanvasElement()),g.content.insertBefore(this.getNativeCanvasElement(),v[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(t.Node.prototype.moveToBottom.call(this)){const g=this.getStage();if(g){const v=g.children;g.content&&(g.content.removeChild(this.getNativeCanvasElement()),g.content.insertBefore(this.getNativeCanvasElement(),v[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const g=this.getNativeCanvasElement();return t.Node.prototype.remove.call(this),g&&g.parentNode&&n.Util._isInDocument(g)&&g.parentNode.removeChild(g),this}getStage(){return this.parent}setSize({width:g,height:v}){return this.canvas.setSize(g,v),this.hitCanvas.setSize(g,v),this._setSmoothEnabled(),this}_validateAdd(g){const v=g.getType();v!=="Group"&&v!=="Shape"&&n.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(g){return g=g||{},g.width=g.width||this.getWidth(),g.height=g.height||this.getHeight(),g.x=g.x!==void 0?g.x:this.x(),g.y=g.y!==void 0?g.y:this.y(),t.Node.prototype._toKonvaCanvas.call(this,g)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){n.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){n.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,n.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(g){if(!this.isListening()||!this.isVisible())return null;let v=1,w=!1;for(;;){for(let m=0;m<A;m++){const y=d[m],x=this._getIntersection({x:g.x+y.x*v,y:g.y+y.y*v}),S=x.shape;if(S)return S;if(w=!!x.antialiased,!x.antialiased)break}if(w)v+=1;else return null}}_getIntersection(g){const v=this.hitCanvas.pixelRatio,w=this.hitCanvas.context.getImageData(Math.round(g.x*v),Math.round(g.y*v),1,1).data,m=w[3];if(m===255){const y=n.Util._rgbToHex(w[0],w[1],w[2]),x=o.shapes[l+y];return x?{shape:x}:{antialiased:!0}}else if(m>0)return{antialiased:!0};return{}}drawScene(g,v,w){const m=this.getLayer(),y=g||m&&m.getCanvas();return this._fire(h,{node:this}),this.clearBeforeDraw()&&y.getContext().clear(),e.Container.prototype.drawScene.call(this,y,v,w),this._fire(u,{node:this}),this}drawHit(g,v){const w=this.getLayer(),m=g||w&&w.hitCanvas;return w&&w.clearBeforeDraw()&&w.getHitCanvas().getContext().clear(),e.Container.prototype.drawHit.call(this,m,v),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(g){n.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(g)}getHitGraphEnabled(g){return n.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const g=this.parent;!!this.hitCanvas._canvas.parentNode?g.content.removeChild(this.hitCanvas._canvas):g.content.appendChild(this.hitCanvas._canvas)}destroy(){return n.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}return S2.Layer=f,f.prototype.nodeType="Layer",(0,a._registerNode)(f),i.Factory.addGetterSetter(f,"imageSmoothingEnabled",!0),i.Factory.addGetterSetter(f,"clearBeforeDraw",!0),i.Factory.addGetterSetter(f,"hitGraphEnabled",!0,(0,s.getBooleanValidator)()),S2}var T2={},IR;function aGe(){if(IR)return T2;IR=1,Object.defineProperty(T2,"__esModule",{value:!0}),T2.FastLayer=void 0;const n=Oa(),e=WK(),t=gs();let i=class extends e.Layer{constructor(s){super(s),this.listening(!1),n.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};return T2.FastLayer=i,i.prototype.nodeType="FastLayer",(0,t._registerNode)(i),T2}var B2={},DR;function yI(){if(DR)return B2;DR=1,Object.defineProperty(B2,"__esModule",{value:!0}),B2.Group=void 0;const n=Oa(),e=_S(),t=gs();class i extends e.Container{_validateAdd(s){const o=s.getType();o!=="Group"&&o!=="Shape"&&n.Util.throw("You may only add groups and shapes to groups.")}}return B2.Group=i,i.prototype.nodeType="Group",(0,t._registerNode)(i),B2}var E2={},jR;function wI(){if(jR)return E2;jR=1,Object.defineProperty(E2,"__esModule",{value:!0}),E2.Animation=void 0;const n=gs(),e=Oa(),t=(function(){return n.glob.performance&&n.glob.performance.now?function(){return n.glob.performance.now()}:function(){return new Date().getTime()}})();let i=class gm{constructor(s,o){this.id=gm.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:t(),frameRate:0},this.func=s,this.setLayers(o)}setLayers(s){let o=[];return s&&(o=Array.isArray(s)?s:[s]),this.layers=o,this}getLayers(){return this.layers}addLayer(s){const o=this.layers,a=o.length;for(let l=0;l<a;l++)if(o[l]._id===s._id)return!1;return this.layers.push(s),!0}isRunning(){const o=gm.animations,a=o.length;for(let l=0;l<a;l++)if(o[l].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=t(),gm._addAnimation(this),this}stop(){return gm._removeAnimation(this),this}_updateFrameObject(s){this.frame.timeDiff=s-this.frame.lastTime,this.frame.lastTime=s,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(s){this.animations.push(s),this._handleAnimation()}static _removeAnimation(s){const o=s.id,a=this.animations,l=a.length;for(let h=0;h<l;h++)if(a[h].id===o){this.animations.splice(h,1);break}}static _runFrames(){const s={},o=this.animations;for(let a=0;a<o.length;a++){const l=o[a],h=l.layers,u=l.func;l._updateFrameObject(t());const d=h.length;let A;if(u?A=u.call(l,l.frame)!==!1:A=!0,!!A)for(let f=0;f<d;f++){const p=h[f];p._id!==void 0&&(s[p._id]=p)}}for(const a in s)s.hasOwnProperty(a)&&s[a].batchDraw()}static _animationLoop(){const s=gm;s.animations.length?(s._runFrames(),e.Util.requestAnimFrame(s._animationLoop)):s.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,e.Util.requestAnimFrame(this._animationLoop))}};return E2.Animation=i,i.animations=[],i.animIdCounter=0,i.animRunning=!1,E2}var rB={},PR;function lGe(){return PR||(PR=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Easings=n.Tween=void 0;const e=Oa(),t=wI(),i=ul(),r=gs(),s={node:1,duration:1,easing:1,onFinish:1,yoyo:1},o=1,a=2,l=3,h=["fill","stroke","shadowColor"];let u=0;class d{constructor(p,g,v,w,m,y,x){this.prop=p,this.propFunc=g,this.begin=w,this._pos=w,this.duration=y,this._change=0,this.prevPos=0,this.yoyo=x,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=v,this._change=m-this.begin,this.pause()}fire(p){const g=this[p];g&&g()}setTime(p){p>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():p<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=p,this.update())}getTime(){return this._time}setPosition(p){this.prevPos=this._pos,this.propFunc(p),this._pos=p}getPosition(p){return p===void 0&&(p=this._time),this.func(p,this.begin,this._change,this.duration)}play(){this.state=a,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=l,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(p){this.pause(),this._time=p,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const p=this.getTimer()-this._startTime;this.state===a?this.setTime(p):this.state===l&&this.setTime(this.duration-p)}pause(){this.state=o,this.fire("onPause")}getTimer(){return new Date().getTime()}}class A{constructor(p){const g=this,v=p.node,w=v._id,m=p.easing||n.Easings.Linear,y=!!p.yoyo;let x,S;typeof p.duration>"u"?x=.3:p.duration===0?x=.001:x=p.duration,this.node=v,this._id=u++;const I=v.getLayer()||(v instanceof r.Konva.Stage?v.getLayers():null);I||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new t.Animation(function(){g.tween.onEnterFrame()},I),this.tween=new d(S,function(j){g._tweenFunc(j)},m,0,1,x*1e3,y),this._addListeners(),A.attrs[w]||(A.attrs[w]={}),A.attrs[w][this._id]||(A.attrs[w][this._id]={}),A.tweens[w]||(A.tweens[w]={});for(S in p)s[S]===void 0&&this._addAttr(S,p[S]);this.reset(),this.onFinish=p.onFinish,this.onReset=p.onReset,this.onUpdate=p.onUpdate}_addAttr(p,g){const v=this.node,w=v._id;let m,y,x,S,I;const j=A.tweens[w][p];j&&delete A.attrs[w][j][p];let C=v.getAttr(p);if(e.Util._isArray(g))if(m=[],y=Math.max(g.length,C.length),p==="points"&&g.length!==C.length&&(g.length>C.length?(S=C,C=e.Util._prepareArrayForTween(C,g,v.closed())):(x=g,g=e.Util._prepareArrayForTween(g,C,v.closed()))),p.indexOf("fill")===0)for(let b=0;b<y;b++)if(b%2===0)m.push(g[b]-C[b]);else{const D=e.Util.colorToRGBA(C[b]);I=e.Util.colorToRGBA(g[b]),C[b]=D,m.push({r:I.r-D.r,g:I.g-D.g,b:I.b-D.b,a:I.a-D.a})}else for(let b=0;b<y;b++)m.push(g[b]-C[b]);else h.indexOf(p)!==-1?(C=e.Util.colorToRGBA(C),I=e.Util.colorToRGBA(g),m={r:I.r-C.r,g:I.g-C.g,b:I.b-C.b,a:I.a-C.a}):m=g-C;A.attrs[w][this._id][p]={start:C,diff:m,end:g,trueEnd:x,trueStart:S},A.tweens[w][p]=this._id}_tweenFunc(p){const g=this.node,v=A.attrs[g._id][this._id];let w,m,y,x,S,I,j,C;for(w in v){if(m=v[w],y=m.start,x=m.diff,C=m.end,e.Util._isArray(y))if(S=[],j=Math.max(y.length,C.length),w.indexOf("fill")===0)for(I=0;I<j;I++)I%2===0?S.push((y[I]||0)+x[I]*p):S.push("rgba("+Math.round(y[I].r+x[I].r*p)+","+Math.round(y[I].g+x[I].g*p)+","+Math.round(y[I].b+x[I].b*p)+","+(y[I].a+x[I].a*p)+")");else for(I=0;I<j;I++)S.push((y[I]||0)+x[I]*p);else h.indexOf(w)!==-1?S="rgba("+Math.round(y.r+x.r*p)+","+Math.round(y.g+x.g*p)+","+Math.round(y.b+x.b*p)+","+(y.a+x.a*p)+")":S=y+x*p;g.setAttr(w,S)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const p=this.node,g=A.attrs[p._id][this._id];g.points&&g.points.trueEnd&&p.setAttr("points",g.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const p=this.node,g=A.attrs[p._id][this._id];g.points&&g.points.trueStart&&p.points(g.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(p){return this.tween.seek(p*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const p=this.node._id,g=this._id,v=A.tweens[p];this.pause(),this.anim&&this.anim.stop();for(const w in v)delete A.tweens[p][w];delete A.attrs[p][g],A.tweens[p]&&(Object.keys(A.tweens[p]).length===0&&delete A.tweens[p],Object.keys(A.attrs[p]).length===0&&delete A.attrs[p])}}n.Tween=A,A.attrs={},A.tweens={},i.Node.prototype.to=function(f){const p=f.onFinish;f.node=this,f.onFinish=function(){this.destroy(),p&&p()},new A(f).play()},n.Easings={BackEaseIn(f,p,g,v){return g*(f/=v)*f*((1.70158+1)*f-1.70158)+p},BackEaseOut(f,p,g,v){return g*((f=f/v-1)*f*((1.70158+1)*f+1.70158)+1)+p},BackEaseInOut(f,p,g,v){let w=1.70158;return(f/=v/2)<1?g/2*(f*f*(((w*=1.525)+1)*f-w))+p:g/2*((f-=2)*f*(((w*=1.525)+1)*f+w)+2)+p},ElasticEaseIn(f,p,g,v,w,m){let y=0;return f===0?p:(f/=v)===1?p+g:(m||(m=v*.3),!w||w<Math.abs(g)?(w=g,y=m/4):y=m/(2*Math.PI)*Math.asin(g/w),-(w*Math.pow(2,10*(f-=1))*Math.sin((f*v-y)*(2*Math.PI)/m))+p)},ElasticEaseOut(f,p,g,v,w,m){let y=0;return f===0?p:(f/=v)===1?p+g:(m||(m=v*.3),!w||w<Math.abs(g)?(w=g,y=m/4):y=m/(2*Math.PI)*Math.asin(g/w),w*Math.pow(2,-10*f)*Math.sin((f*v-y)*(2*Math.PI)/m)+g+p)},ElasticEaseInOut(f,p,g,v,w,m){let y=0;return f===0?p:(f/=v/2)===2?p+g:(m||(m=v*(.3*1.5)),!w||w<Math.abs(g)?(w=g,y=m/4):y=m/(2*Math.PI)*Math.asin(g/w),f<1?-.5*(w*Math.pow(2,10*(f-=1))*Math.sin((f*v-y)*(2*Math.PI)/m))+p:w*Math.pow(2,-10*(f-=1))*Math.sin((f*v-y)*(2*Math.PI)/m)*.5+g+p)},BounceEaseOut(f,p,g,v){return(f/=v)<1/2.75?g*(7.5625*f*f)+p:f<2/2.75?g*(7.5625*(f-=1.5/2.75)*f+.75)+p:f<2.5/2.75?g*(7.5625*(f-=2.25/2.75)*f+.9375)+p:g*(7.5625*(f-=2.625/2.75)*f+.984375)+p},BounceEaseIn(f,p,g,v){return g-n.Easings.BounceEaseOut(v-f,0,g,v)+p},BounceEaseInOut(f,p,g,v){return f<v/2?n.Easings.BounceEaseIn(f*2,0,g,v)*.5+p:n.Easings.BounceEaseOut(f*2-v,0,g,v)*.5+g*.5+p},EaseIn(f,p,g,v){return g*(f/=v)*f+p},EaseOut(f,p,g,v){return-g*(f/=v)*(f-2)+p},EaseInOut(f,p,g,v){return(f/=v/2)<1?g/2*f*f+p:-g/2*(--f*(f-2)-1)+p},StrongEaseIn(f,p,g,v){return g*(f/=v)*f*f*f*f+p},StrongEaseOut(f,p,g,v){return g*((f=f/v-1)*f*f*f*f+1)+p},StrongEaseInOut(f,p,g,v){return(f/=v/2)<1?g/2*f*f*f*f*f+p:g/2*((f-=2)*f*f*f*f+2)+p},Linear(f,p,g,v){return g*f/v+p}}})(rB)),rB}var NR;function Y6(){return NR||(NR=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Konva=void 0;const e=gs(),t=Oa(),i=ul(),r=_S(),s=oGe(),o=WK(),a=aGe(),l=yI(),h=mI(),u=ec(),d=wI(),A=lGe(),f=OK(),p=CS();n.Konva=t.Util._assign(e.Konva,{Util:t.Util,Transform:t.Transform,Node:i.Node,Container:r.Container,Stage:s.Stage,stages:s.stages,Layer:o.Layer,FastLayer:a.FastLayer,Group:l.Group,DD:h.DD,Shape:u.Shape,shapes:u.shapes,Animation:d.Animation,Tween:A.Tween,Easings:A.Easings,Context:f.Context,Canvas:p.Canvas}),n.default=n.Konva})(qT)),qT}var F2={},LR;function cGe(){if(LR)return F2;LR=1,Object.defineProperty(F2,"__esModule",{value:!0}),F2.Arc=void 0;const n=Ss(),e=ec(),t=gs(),i=js(),r=gs();let s=class extends e.Shape{_sceneFunc(a){const l=t.Konva.getAngle(this.angle()),h=this.clockwise();a.beginPath(),a.arc(0,0,this.outerRadius(),0,l,h),a.arc(0,0,this.innerRadius(),l,0,!h),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}getSelfRect(){const a=this.innerRadius(),l=this.outerRadius(),h=this.clockwise(),u=t.Konva.getAngle(h?360-this.angle():this.angle()),d=Math.cos(Math.min(u,Math.PI)),A=1,f=Math.sin(Math.min(Math.max(Math.PI,u),3*Math.PI/2)),p=Math.sin(Math.min(u,Math.PI/2)),g=d*(d>0?a:l),v=A*l,w=f*(f>0?a:l),m=p*(p>0?l:a);return{x:g,y:h?-1*m:w,width:v-g,height:m-w}}};return F2.Arc=s,s.prototype._centroid=!0,s.prototype.className="Arc",s.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],(0,r._registerNode)(s),n.Factory.addGetterSetter(s,"innerRadius",0,(0,i.getNumberValidator)()),n.Factory.addGetterSetter(s,"outerRadius",0,(0,i.getNumberValidator)()),n.Factory.addGetterSetter(s,"angle",0,(0,i.getNumberValidator)()),n.Factory.addGetterSetter(s,"clockwise",!1,(0,i.getBooleanValidator)()),F2}var k2={},I2={},MR;function zK(){if(MR)return I2;MR=1,Object.defineProperty(I2,"__esModule",{value:!0}),I2.Line=void 0;const n=Ss(),e=gs(),t=ec(),i=js();function r(a,l,h,u,d,A,f){const p=Math.sqrt(Math.pow(h-a,2)+Math.pow(u-l,2)),g=Math.sqrt(Math.pow(d-h,2)+Math.pow(A-u,2)),v=f*p/(p+g),w=f*g/(p+g),m=h-v*(d-a),y=u-v*(A-l),x=h+w*(d-a),S=u+w*(A-l);return[m,y,x,S]}function s(a,l){const h=a.length,u=[];for(let d=2;d<h-2;d+=2){const A=r(a[d-2],a[d-1],a[d],a[d+1],a[d+2],a[d+3],l);isNaN(A[0])||(u.push(A[0]),u.push(A[1]),u.push(a[d]),u.push(a[d+1]),u.push(A[2]),u.push(A[3]))}return u}class o extends t.Shape{constructor(l){super(l),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(l){const h=this.points(),u=h.length,d=this.tension(),A=this.closed(),f=this.bezier();if(!u)return;let p=0;if(l.beginPath(),l.moveTo(h[0],h[1]),d!==0&&u>4){const g=this.getTensionPoints(),v=g.length;for(p=A?0:4,A||l.quadraticCurveTo(g[0],g[1],g[2],g[3]);p<v-2;)l.bezierCurveTo(g[p++],g[p++],g[p++],g[p++],g[p++],g[p++]);A||l.quadraticCurveTo(g[v-2],g[v-1],h[u-2],h[u-1])}else if(f)for(p=2;p<u;)l.bezierCurveTo(h[p++],h[p++],h[p++],h[p++],h[p++],h[p++]);else for(p=2;p<u;p+=2)l.lineTo(h[p],h[p+1]);A?(l.closePath(),l.fillStrokeShape(this)):l.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():s(this.points(),this.tension())}_getTensionPointsClosed(){const l=this.points(),h=l.length,u=this.tension(),d=r(l[h-2],l[h-1],l[0],l[1],l[2],l[3],u),A=r(l[h-4],l[h-3],l[h-2],l[h-1],l[0],l[1],u),f=s(l,u);return[d[2],d[3]].concat(f).concat([A[0],A[1],l[h-2],l[h-1],A[2],A[3],d[0],d[1],l[0],l[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let l=this.points();if(l.length<4)return{x:l[0]||0,y:l[1]||0,width:0,height:0};this.tension()!==0?l=[l[0],l[1],...this._getTensionPoints(),l[l.length-2],l[l.length-1]]:l=this.points();let h=l[0],u=l[0],d=l[1],A=l[1],f,p;for(let g=0;g<l.length/2;g++)f=l[g*2],p=l[g*2+1],h=Math.min(h,f),u=Math.max(u,f),d=Math.min(d,p),A=Math.max(A,p);return{x:h,y:d,width:u-h,height:A-d}}}return I2.Line=o,o.prototype.className="Line",o.prototype._attrsAffectingSize=["points","bezier","tension"],(0,e._registerNode)(o),n.Factory.addGetterSetter(o,"closed",!1),n.Factory.addGetterSetter(o,"bezier",!1),n.Factory.addGetterSetter(o,"tension",0,(0,i.getNumberValidator)()),n.Factory.addGetterSetter(o,"points",[],(0,i.getNumberArrayValidator)()),I2}var D2={},sB={},RR;function hGe(){return RR||(RR=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.t2length=n.getQuadraticArcLength=n.getCubicArcLength=n.binomialCoefficients=n.cValues=n.tValues=void 0,n.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],n.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],n.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(o,a,l)=>{let h,u;const A=l/2;h=0;for(let f=0;f<20;f++)u=A*n.tValues[20][f]+A,h+=n.cValues[20][f]*i(o,a,u);return A*h};n.getCubicArcLength=e;const t=(o,a,l)=>{l===void 0&&(l=1);const h=o[0]-2*o[1]+o[2],u=a[0]-2*a[1]+a[2],d=2*o[1]-2*o[0],A=2*a[1]-2*a[0],f=4*(h*h+u*u),p=4*(h*d+u*A),g=d*d+A*A;if(f===0)return l*Math.sqrt(Math.pow(o[2]-o[0],2)+Math.pow(a[2]-a[0],2));const v=p/(2*f),w=g/f,m=l+v,y=w-v*v,x=m*m+y>0?Math.sqrt(m*m+y):0,S=v*v+y>0?Math.sqrt(v*v+y):0,I=v+Math.sqrt(v*v+y)!==0?y*Math.log(Math.abs((m+x)/(v+S))):0;return Math.sqrt(f)/2*(m*x-v*S+I)};n.getQuadraticArcLength=t;function i(o,a,l){const h=r(1,l,o),u=r(1,l,a),d=h*h+u*u;return Math.sqrt(d)}const r=(o,a,l)=>{const h=l.length-1;let u,d;if(h===0)return 0;if(o===0){d=0;for(let A=0;A<=h;A++)d+=n.binomialCoefficients[h][A]*Math.pow(1-a,h-A)*Math.pow(a,A)*l[A];return d}else{u=new Array(h);for(let A=0;A<h;A++)u[A]=h*(l[A+1]-l[A]);return r(o-1,a,u)}},s=(o,a,l)=>{let h=1,u=o/a,d=(o-l(u))/a,A=0;for(;h>.001;){const f=l(u+d),p=Math.abs(o-f)/a;if(p<h)h=p,u+=d;else{const g=l(u-d),v=Math.abs(o-g)/a;v<h?(h=v,u-=d):d/=2}if(A++,A>500)break}return u};n.t2length=s})(sB)),sB}var UR;function vI(){if(UR)return D2;UR=1,Object.defineProperty(D2,"__esModule",{value:!0}),D2.Path=void 0;const n=Ss(),e=gs(),t=ec(),i=hGe();let r=class Sh extends t.Shape{constructor(o){super(o),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Sh.parsePathData(this.data()),this.pathLength=Sh.getPathLength(this.dataArray)}_sceneFunc(o){const a=this.dataArray;o.beginPath();let l=!1;for(let h=0;h<a.length;h++){const u=a[h].command,d=a[h].points;switch(u){case"L":o.lineTo(d[0],d[1]);break;case"M":o.moveTo(d[0],d[1]);break;case"C":o.bezierCurveTo(d[0],d[1],d[2],d[3],d[4],d[5]);break;case"Q":o.quadraticCurveTo(d[0],d[1],d[2],d[3]);break;case"A":const A=d[0],f=d[1],p=d[2],g=d[3],v=d[4],w=d[5],m=d[6],y=d[7],x=p>g?p:g,S=p>g?1:p/g,I=p>g?g/p:1;o.translate(A,f),o.rotate(m),o.scale(S,I),o.arc(0,0,x,v,v+w,1-y),o.scale(1/S,1/I),o.rotate(-m),o.translate(-A,-f);break;case"z":l=!0,o.closePath();break}}!l&&!this.hasFill()?o.strokeShape(this):o.fillStrokeShape(this)}getSelfRect(){let o=[];this.dataArray.forEach(function(f){if(f.command==="A"){const p=f.points[4],g=f.points[5],v=f.points[4]+g;let w=Math.PI/180;if(Math.abs(p-v)<w&&(w=Math.abs(p-v)),g<0)for(let m=p-w;m>v;m-=w){const y=Sh.getPointOnEllipticalArc(f.points[0],f.points[1],f.points[2],f.points[3],m,0);o.push(y.x,y.y)}else for(let m=p+w;m<v;m+=w){const y=Sh.getPointOnEllipticalArc(f.points[0],f.points[1],f.points[2],f.points[3],m,0);o.push(y.x,y.y)}}else if(f.command==="C")for(let p=0;p<=1;p+=.01){const g=Sh.getPointOnCubicBezier(p,f.start.x,f.start.y,f.points[0],f.points[1],f.points[2],f.points[3],f.points[4],f.points[5]);o.push(g.x,g.y)}else o=o.concat(f.points)});let a=o[0],l=o[0],h=o[1],u=o[1],d,A;for(let f=0;f<o.length/2;f++)d=o[f*2],A=o[f*2+1],isNaN(d)||(a=Math.min(a,d),l=Math.max(l,d)),isNaN(A)||(h=Math.min(h,A),u=Math.max(u,A));return{x:a,y:h,width:l-a,height:u-h}}getLength(){return this.pathLength}getPointAtLength(o){return Sh.getPointAtLengthOfDataArray(o,this.dataArray)}static getLineLength(o,a,l,h){return Math.sqrt((l-o)*(l-o)+(h-a)*(h-a))}static getPathLength(o){let a=0;for(let l=0;l<o.length;++l)a+=o[l].pathLength;return a}static getPointAtLengthOfDataArray(o,a){let l,h=0,u=a.length;if(!u)return null;for(;h<u&&o>a[h].pathLength;)o-=a[h].pathLength,++h;if(h===u)return l=a[h-1].points.slice(-2),{x:l[0],y:l[1]};if(o<.01)return a[h].command==="M"?(l=a[h].points.slice(0,2),{x:l[0],y:l[1]}):{x:a[h].start.x,y:a[h].start.y};const d=a[h],A=d.points;switch(d.command){case"L":return Sh.getPointOnLine(o,d.start.x,d.start.y,A[0],A[1]);case"C":return Sh.getPointOnCubicBezier((0,i.t2length)(o,Sh.getPathLength(a),x=>(0,i.getCubicArcLength)([d.start.x,A[0],A[2],A[4]],[d.start.y,A[1],A[3],A[5]],x)),d.start.x,d.start.y,A[0],A[1],A[2],A[3],A[4],A[5]);case"Q":return Sh.getPointOnQuadraticBezier((0,i.t2length)(o,Sh.getPathLength(a),x=>(0,i.getQuadraticArcLength)([d.start.x,A[0],A[2]],[d.start.y,A[1],A[3]],x)),d.start.x,d.start.y,A[0],A[1],A[2],A[3]);case"A":const f=A[0],p=A[1],g=A[2],v=A[3],w=A[5],m=A[6];let y=A[4];return y+=w*o/d.pathLength,Sh.getPointOnEllipticalArc(f,p,g,v,y,m)}return null}static getPointOnLine(o,a,l,h,u,d,A){d=d??a,A=A??l;const f=this.getLineLength(a,l,h,u);if(f<1e-10)return{x:a,y:l};if(h===a)return{x:d,y:A+(u>l?o:-o)};const p=(u-l)/(h-a),g=Math.sqrt(o*o/(1+p*p))*(h<a?-1:1),v=p*g;if(Math.abs(A-l-p*(d-a))<1e-10)return{x:d+g,y:A+v};const w=((d-a)*(h-a)+(A-l)*(u-l))/(f*f),m=a+w*(h-a),y=l+w*(u-l),x=this.getLineLength(d,A,m,y),S=Math.sqrt(o*o-x*x),I=Math.sqrt(S*S/(1+p*p))*(h<a?-1:1),j=p*I;return{x:m+I,y:y+j}}static getPointOnCubicBezier(o,a,l,h,u,d,A,f,p){function g(S){return S*S*S}function v(S){return 3*S*S*(1-S)}function w(S){return 3*S*(1-S)*(1-S)}function m(S){return(1-S)*(1-S)*(1-S)}const y=f*g(o)+d*v(o)+h*w(o)+a*m(o),x=p*g(o)+A*v(o)+u*w(o)+l*m(o);return{x:y,y:x}}static getPointOnQuadraticBezier(o,a,l,h,u,d,A){function f(m){return m*m}function p(m){return 2*m*(1-m)}function g(m){return(1-m)*(1-m)}const v=d*f(o)+h*p(o)+a*g(o),w=A*f(o)+u*p(o)+l*g(o);return{x:v,y:w}}static getPointOnEllipticalArc(o,a,l,h,u,d){const A=Math.cos(d),f=Math.sin(d),p={x:l*Math.cos(u),y:h*Math.sin(u)};return{x:o+(p.x*A-p.y*f),y:a+(p.x*f+p.y*A)}}static parsePathData(o){if(!o)return[];let a=o;const l=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];a=a.replace(new RegExp(" ","g"),",");for(let v=0;v<l.length;v++)a=a.replace(new RegExp(l[v],"g"),"|"+l[v]);const h=a.split("|"),u=[],d=[];let A=0,f=0;const p=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let g;for(let v=1;v<h.length;v++){let w=h[v],m=w.charAt(0);for(w=w.slice(1),d.length=0;g=p.exec(w);)d.push(g[0]);const y=[];for(let x=0,S=d.length;x<S;x++){if(d[x]==="00"){y.push(0,0);continue}const I=parseFloat(d[x]);isNaN(I)?y.push(0):y.push(I)}for(;y.length>0&&!isNaN(y[0]);){let x="",S=[];const I=A,j=f;let C,b,D,T,k,B,E,z,te,L;switch(m){case"l":A+=y.shift(),f+=y.shift(),x="L",S.push(A,f);break;case"L":A=y.shift(),f=y.shift(),S.push(A,f);break;case"m":const O=y.shift(),J=y.shift();if(A+=O,f+=J,x="M",u.length>2&&u[u.length-1].command==="z"){for(let $=u.length-2;$>=0;$--)if(u[$].command==="M"){A=u[$].points[0]+O,f=u[$].points[1]+J;break}}S.push(A,f),m="l";break;case"M":A=y.shift(),f=y.shift(),x="M",S.push(A,f),m="L";break;case"h":A+=y.shift(),x="L",S.push(A,f);break;case"H":A=y.shift(),x="L",S.push(A,f);break;case"v":f+=y.shift(),x="L",S.push(A,f);break;case"V":f=y.shift(),x="L",S.push(A,f);break;case"C":S.push(y.shift(),y.shift(),y.shift(),y.shift()),A=y.shift(),f=y.shift(),S.push(A,f);break;case"c":S.push(A+y.shift(),f+y.shift(),A+y.shift(),f+y.shift()),A+=y.shift(),f+=y.shift(),x="C",S.push(A,f);break;case"S":b=A,D=f,C=u[u.length-1],C.command==="C"&&(b=A+(A-C.points[2]),D=f+(f-C.points[3])),S.push(b,D,y.shift(),y.shift()),A=y.shift(),f=y.shift(),x="C",S.push(A,f);break;case"s":b=A,D=f,C=u[u.length-1],C.command==="C"&&(b=A+(A-C.points[2]),D=f+(f-C.points[3])),S.push(b,D,A+y.shift(),f+y.shift()),A+=y.shift(),f+=y.shift(),x="C",S.push(A,f);break;case"Q":S.push(y.shift(),y.shift()),A=y.shift(),f=y.shift(),S.push(A,f);break;case"q":S.push(A+y.shift(),f+y.shift()),A+=y.shift(),f+=y.shift(),x="Q",S.push(A,f);break;case"T":b=A,D=f,C=u[u.length-1],C.command==="Q"&&(b=A+(A-C.points[0]),D=f+(f-C.points[1])),A=y.shift(),f=y.shift(),x="Q",S.push(b,D,A,f);break;case"t":b=A,D=f,C=u[u.length-1],C.command==="Q"&&(b=A+(A-C.points[0]),D=f+(f-C.points[1])),A+=y.shift(),f+=y.shift(),x="Q",S.push(b,D,A,f);break;case"A":T=y.shift(),k=y.shift(),B=y.shift(),E=y.shift(),z=y.shift(),te=A,L=f,A=y.shift(),f=y.shift(),x="A",S=this.convertEndpointToCenterParameterization(te,L,A,f,E,z,T,k,B);break;case"a":T=y.shift(),k=y.shift(),B=y.shift(),E=y.shift(),z=y.shift(),te=A,L=f,A+=y.shift(),f+=y.shift(),x="A",S=this.convertEndpointToCenterParameterization(te,L,A,f,E,z,T,k,B);break}u.push({command:x||m,points:S,start:{x:I,y:j},pathLength:this.calcLength(I,j,x||m,S)})}(m==="z"||m==="Z")&&u.push({command:"z",points:[],start:void 0,pathLength:0})}return u}static calcLength(o,a,l,h){let u,d,A,f;const p=Sh;switch(l){case"L":return p.getLineLength(o,a,h[0],h[1]);case"C":return(0,i.getCubicArcLength)([o,h[0],h[2],h[4]],[a,h[1],h[3],h[5]],1);case"Q":return(0,i.getQuadraticArcLength)([o,h[0],h[2]],[a,h[1],h[3]],1);case"A":u=0;const g=h[4],v=h[5],w=h[4]+v;let m=Math.PI/180;if(Math.abs(g-w)<m&&(m=Math.abs(g-w)),d=p.getPointOnEllipticalArc(h[0],h[1],h[2],h[3],g,0),v<0)for(f=g-m;f>w;f-=m)A=p.getPointOnEllipticalArc(h[0],h[1],h[2],h[3],f,0),u+=p.getLineLength(d.x,d.y,A.x,A.y),d=A;else for(f=g+m;f<w;f+=m)A=p.getPointOnEllipticalArc(h[0],h[1],h[2],h[3],f,0),u+=p.getLineLength(d.x,d.y,A.x,A.y),d=A;return A=p.getPointOnEllipticalArc(h[0],h[1],h[2],h[3],w,0),u+=p.getLineLength(d.x,d.y,A.x,A.y),u}return 0}static convertEndpointToCenterParameterization(o,a,l,h,u,d,A,f,p){const g=p*(Math.PI/180),v=Math.cos(g)*(o-l)/2+Math.sin(g)*(a-h)/2,w=-1*Math.sin(g)*(o-l)/2+Math.cos(g)*(a-h)/2,m=v*v/(A*A)+w*w/(f*f);m>1&&(A*=Math.sqrt(m),f*=Math.sqrt(m));let y=Math.sqrt((A*A*(f*f)-A*A*(w*w)-f*f*(v*v))/(A*A*(w*w)+f*f*(v*v)));u===d&&(y*=-1),isNaN(y)&&(y=0);const x=y*A*w/f,S=y*-f*v/A,I=(o+l)/2+Math.cos(g)*x-Math.sin(g)*S,j=(a+h)/2+Math.sin(g)*x+Math.cos(g)*S,C=function(z){return Math.sqrt(z[0]*z[0]+z[1]*z[1])},b=function(z,te){return(z[0]*te[0]+z[1]*te[1])/(C(z)*C(te))},D=function(z,te){return(z[0]*te[1]<z[1]*te[0]?-1:1)*Math.acos(b(z,te))},T=D([1,0],[(v-x)/A,(w-S)/f]),k=[(v-x)/A,(w-S)/f],B=[(-1*v-x)/A,(-1*w-S)/f];let E=D(k,B);return b(k,B)<=-1&&(E=Math.PI),b(k,B)>=1&&(E=0),d===0&&E>0&&(E=E-2*Math.PI),d===1&&E<0&&(E=E+2*Math.PI),[I,j,A,f,T,E,g,d]}};return D2.Path=r,r.prototype.className="Path",r.prototype._attrsAffectingSize=["data"],(0,e._registerNode)(r),n.Factory.addGetterSetter(r,"data"),D2}var OR;function uGe(){if(OR)return k2;OR=1,Object.defineProperty(k2,"__esModule",{value:!0}),k2.Arrow=void 0;const n=Ss(),e=zK(),t=js(),i=gs(),r=vI();let s=class extends e.Line{_sceneFunc(a){super._sceneFunc(a);const l=Math.PI*2,h=this.points();let u=h;const d=this.tension()!==0&&h.length>4;d&&(u=this.getTensionPoints());const A=this.pointerLength(),f=h.length;let p,g;if(d){const m=[u[u.length-4],u[u.length-3],u[u.length-2],u[u.length-1],h[f-2],h[f-1]],y=r.Path.calcLength(u[u.length-4],u[u.length-3],"C",m),x=r.Path.getPointOnQuadraticBezier(Math.min(1,1-A/y),m[0],m[1],m[2],m[3],m[4],m[5]);p=h[f-2]-x.x,g=h[f-1]-x.y}else p=h[f-2]-h[f-4],g=h[f-1]-h[f-3];const v=(Math.atan2(g,p)+l)%l,w=this.pointerWidth();this.pointerAtEnding()&&(a.save(),a.beginPath(),a.translate(h[f-2],h[f-1]),a.rotate(v),a.moveTo(0,0),a.lineTo(-A,w/2),a.lineTo(-A,-w/2),a.closePath(),a.restore(),this.__fillStroke(a)),this.pointerAtBeginning()&&(a.save(),a.beginPath(),a.translate(h[0],h[1]),d?(p=(u[0]+u[2])/2-h[0],g=(u[1]+u[3])/2-h[1]):(p=h[2]-h[0],g=h[3]-h[1]),a.rotate((Math.atan2(-g,-p)+l)%l),a.moveTo(0,0),a.lineTo(-A,w/2),a.lineTo(-A,-w/2),a.closePath(),a.restore(),this.__fillStroke(a))}__fillStroke(a){const l=this.dashEnabled();l&&(this.attrs.dashEnabled=!1,a.setLineDash([])),a.fillStrokeShape(this),l&&(this.attrs.dashEnabled=!0)}getSelfRect(){const a=super.getSelfRect(),l=this.pointerWidth()/2;return{x:a.x,y:a.y-l,width:a.width,height:a.height+l*2}}};return k2.Arrow=s,s.prototype.className="Arrow",(0,i._registerNode)(s),n.Factory.addGetterSetter(s,"pointerLength",10,(0,t.getNumberValidator)()),n.Factory.addGetterSetter(s,"pointerWidth",10,(0,t.getNumberValidator)()),n.Factory.addGetterSetter(s,"pointerAtBeginning",!1),n.Factory.addGetterSetter(s,"pointerAtEnding",!0),k2}var j2={},HR;function dGe(){if(HR)return j2;HR=1,Object.defineProperty(j2,"__esModule",{value:!0}),j2.Circle=void 0;const n=Ss(),e=ec(),t=js(),i=gs();class r extends e.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius()!==o/2&&this.radius(o/2)}setHeight(o){this.radius()!==o/2&&this.radius(o/2)}}return j2.Circle=r,r.prototype._centroid=!0,r.prototype.className="Circle",r.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(r),n.Factory.addGetterSetter(r,"radius",0,(0,t.getNumberValidator)()),j2}var P2={},WR;function AGe(){if(WR)return P2;WR=1,Object.defineProperty(P2,"__esModule",{value:!0}),P2.Ellipse=void 0;const n=Ss(),e=ec(),t=js(),i=gs();let r=class extends e.Shape{_sceneFunc(o){const a=this.radiusX(),l=this.radiusY();o.beginPath(),o.save(),a!==l&&o.scale(1,l/a),o.arc(0,0,a,0,Math.PI*2,!1),o.restore(),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(o){this.radiusX(o/2)}setHeight(o){this.radiusY(o/2)}};return P2.Ellipse=r,r.prototype.className="Ellipse",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,i._registerNode)(r),n.Factory.addComponentsGetterSetter(r,"radius",["x","y"]),n.Factory.addGetterSetter(r,"radiusX",0,(0,t.getNumberValidator)()),n.Factory.addGetterSetter(r,"radiusY",0,(0,t.getNumberValidator)()),P2}var N2={},zR;function fGe(){if(zR)return N2;zR=1,Object.defineProperty(N2,"__esModule",{value:!0}),N2.Image=void 0;const n=Oa(),e=Ss(),t=ec(),i=gs(),r=js();class s extends t.Shape{constructor(a){super(a),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",l=>{this._removeImageLoad(l.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const a=this.image();a&&a.complete||a&&a.readyState===4||a&&a.addEventListener&&a.addEventListener("load",this._loadListener)}_removeImageLoad(a){a&&a.removeEventListener&&a.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const a=!!this.cornerRadius(),l=this.hasShadow();return a&&l?!0:super._useBufferCanvas(!0)}_sceneFunc(a){const l=this.getWidth(),h=this.getHeight(),u=this.cornerRadius(),d=this.attrs.image;let A;if(d){const f=this.attrs.cropWidth,p=this.attrs.cropHeight;f&&p?A=[d,this.cropX(),this.cropY(),f,p,0,0,l,h]:A=[d,0,0,l,h]}(this.hasFill()||this.hasStroke()||u)&&(a.beginPath(),u?n.Util.drawRoundedRectPath(a,l,h,u):a.rect(0,0,l,h),a.closePath(),a.fillStrokeShape(this)),d&&(u&&a.clip(),a.drawImage.apply(a,A))}_hitFunc(a){const l=this.width(),h=this.height(),u=this.cornerRadius();a.beginPath(),u?n.Util.drawRoundedRectPath(a,l,h,u):a.rect(0,0,l,h),a.closePath(),a.fillStrokeShape(this)}getWidth(){var a,l;return(a=this.attrs.width)!==null&&a!==void 0?a:(l=this.image())===null||l===void 0?void 0:l.width}getHeight(){var a,l;return(a=this.attrs.height)!==null&&a!==void 0?a:(l=this.image())===null||l===void 0?void 0:l.height}static fromURL(a,l,h=null){const u=n.Util.createImageElement();u.onload=function(){const d=new s({image:u});l(d)},u.onerror=h,u.crossOrigin="Anonymous",u.src=a}}return N2.Image=s,s.prototype.className="Image",(0,i._registerNode)(s),e.Factory.addGetterSetter(s,"cornerRadius",0,(0,r.getNumberOrArrayOfNumbersValidator)(4)),e.Factory.addGetterSetter(s,"image"),e.Factory.addComponentsGetterSetter(s,"crop",["x","y","width","height"]),e.Factory.addGetterSetter(s,"cropX",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"cropY",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"cropWidth",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"cropHeight",0,(0,r.getNumberValidator)()),N2}var bg={},QR;function pGe(){if(QR)return bg;QR=1,Object.defineProperty(bg,"__esModule",{value:!0}),bg.Tag=bg.Label=void 0;const n=Ss(),e=ec(),t=yI(),i=js(),r=gs(),s=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],o="Change.konva",a="none",l="up",h="right",u="down",d="left",A=s.length;let f=class extends t.Group{constructor(v){super(v),this.on("add.konva",function(w){this._addListeners(w.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(v){let w=this,m;const y=function(){w._sync()};for(m=0;m<A;m++)v.on(s[m]+o,y)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let v=this.getText(),w=this.getTag(),m,y,x,S,I,j,C;if(v&&w){switch(m=v.width(),y=v.height(),x=w.pointerDirection(),S=w.pointerWidth(),C=w.pointerHeight(),I=0,j=0,x){case l:I=m/2,j=-1*C;break;case h:I=m+S,j=y/2;break;case u:I=m/2,j=y+C;break;case d:I=-1*S,j=y/2;break}w.setAttrs({x:-1*I,y:-1*j,width:m,height:y}),v.setAttrs({x:-1*I,y:-1*j})}}};bg.Label=f,f.prototype.className="Label",(0,r._registerNode)(f);class p extends e.Shape{_sceneFunc(v){const w=this.width(),m=this.height(),y=this.pointerDirection(),x=this.pointerWidth(),S=this.pointerHeight(),I=this.cornerRadius();let j=0,C=0,b=0,D=0;typeof I=="number"?j=C=b=D=Math.min(I,w/2,m/2):(j=Math.min(I[0]||0,w/2,m/2),C=Math.min(I[1]||0,w/2,m/2),D=Math.min(I[2]||0,w/2,m/2),b=Math.min(I[3]||0,w/2,m/2)),v.beginPath(),v.moveTo(j,0),y===l&&(v.lineTo((w-x)/2,0),v.lineTo(w/2,-1*S),v.lineTo((w+x)/2,0)),v.lineTo(w-C,0),v.arc(w-C,C,C,Math.PI*3/2,0,!1),y===h&&(v.lineTo(w,(m-S)/2),v.lineTo(w+x,m/2),v.lineTo(w,(m+S)/2)),v.lineTo(w,m-D),v.arc(w-D,m-D,D,0,Math.PI/2,!1),y===u&&(v.lineTo((w+x)/2,m),v.lineTo(w/2,m+S),v.lineTo((w-x)/2,m)),v.lineTo(b,m),v.arc(b,m-b,b,Math.PI/2,Math.PI,!1),y===d&&(v.lineTo(0,(m+S)/2),v.lineTo(-1*x,m/2),v.lineTo(0,(m-S)/2)),v.lineTo(0,j),v.arc(j,j,j,Math.PI,Math.PI*3/2,!1),v.closePath(),v.fillStrokeShape(this)}getSelfRect(){let v=0,w=0,m=this.pointerWidth(),y=this.pointerHeight(),x=this.pointerDirection(),S=this.width(),I=this.height();return x===l?(w-=y,I+=y):x===u?I+=y:x===d?(v-=m*1.5,S+=m):x===h&&(S+=m*1.5),{x:v,y:w,width:S,height:I}}}return bg.Tag=p,p.prototype.className="Tag",(0,r._registerNode)(p),n.Factory.addGetterSetter(p,"pointerDirection",a),n.Factory.addGetterSetter(p,"pointerWidth",0,(0,i.getNumberValidator)()),n.Factory.addGetterSetter(p,"pointerHeight",0,(0,i.getNumberValidator)()),n.Factory.addGetterSetter(p,"cornerRadius",0,(0,i.getNumberOrArrayOfNumbersValidator)(4)),bg}var L2={},$R;function QK(){if($R)return L2;$R=1,Object.defineProperty(L2,"__esModule",{value:!0}),L2.Rect=void 0;const n=Ss(),e=ec(),t=gs(),i=Oa(),r=js();class s extends e.Shape{_sceneFunc(a){const l=this.cornerRadius(),h=this.width(),u=this.height();a.beginPath(),l?i.Util.drawRoundedRectPath(a,h,u,l):a.rect(0,0,h,u),a.closePath(),a.fillStrokeShape(this)}}return L2.Rect=s,s.prototype.className="Rect",(0,t._registerNode)(s),n.Factory.addGetterSetter(s,"cornerRadius",0,(0,r.getNumberOrArrayOfNumbersValidator)(4)),L2}var M2={},VR;function gGe(){if(VR)return M2;VR=1,Object.defineProperty(M2,"__esModule",{value:!0}),M2.RegularPolygon=void 0;const n=Ss(),e=ec(),t=js(),i=gs();let r=class extends e.Shape{_sceneFunc(o){const a=this._getPoints();o.beginPath(),o.moveTo(a[0].x,a[0].y);for(let l=1;l<a.length;l++)o.lineTo(a[l].x,a[l].y);o.closePath(),o.fillStrokeShape(this)}_getPoints(){const o=this.attrs.sides,a=this.attrs.radius||0,l=[];for(let h=0;h<o;h++)l.push({x:a*Math.sin(h*2*Math.PI/o),y:-1*a*Math.cos(h*2*Math.PI/o)});return l}getSelfRect(){const o=this._getPoints();let a=o[0].x,l=o[0].y,h=o[0].x,u=o[0].y;return o.forEach(d=>{a=Math.min(a,d.x),l=Math.max(l,d.x),h=Math.min(h,d.y),u=Math.max(u,d.y)}),{x:a,y:h,width:l-a,height:u-h}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius(o/2)}setHeight(o){this.radius(o/2)}};return M2.RegularPolygon=r,r.prototype.className="RegularPolygon",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(r),n.Factory.addGetterSetter(r,"radius",0,(0,t.getNumberValidator)()),n.Factory.addGetterSetter(r,"sides",0,(0,t.getNumberValidator)()),M2}var R2={},GR;function mGe(){if(GR)return R2;GR=1,Object.defineProperty(R2,"__esModule",{value:!0}),R2.Ring=void 0;const n=Ss(),e=ec(),t=js(),i=gs(),r=Math.PI*2;let s=class extends e.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.innerRadius(),0,r,!1),a.moveTo(this.outerRadius(),0),a.arc(0,0,this.outerRadius(),r,0,!0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}};return R2.Ring=s,s.prototype.className="Ring",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(s),n.Factory.addGetterSetter(s,"innerRadius",0,(0,t.getNumberValidator)()),n.Factory.addGetterSetter(s,"outerRadius",0,(0,t.getNumberValidator)()),R2}var U2={},XR;function yGe(){if(XR)return U2;XR=1,Object.defineProperty(U2,"__esModule",{value:!0}),U2.Sprite=void 0;const n=Ss(),e=ec(),t=wI(),i=js(),r=gs();let s=class extends e.Shape{constructor(a){super(a),this._updated=!0,this.anim=new t.Animation(()=>{const l=this._updated;return this._updated=!1,l}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(a){const l=this.animation(),h=this.frameIndex(),u=h*4,d=this.animations()[l],A=this.frameOffsets(),f=d[u+0],p=d[u+1],g=d[u+2],v=d[u+3],w=this.image();if((this.hasFill()||this.hasStroke())&&(a.beginPath(),a.rect(0,0,g,v),a.closePath(),a.fillStrokeShape(this)),w)if(A){const m=A[l],y=h*2;a.drawImage(w,f,p,g,v,m[y+0],m[y+1],g,v)}else a.drawImage(w,f,p,g,v,0,0,g,v)}_hitFunc(a){const l=this.animation(),h=this.frameIndex(),u=h*4,d=this.animations()[l],A=this.frameOffsets(),f=d[u+2],p=d[u+3];if(a.beginPath(),A){const g=A[l],v=h*2;a.rect(g[v+0],g[v+1],f,p)}else a.rect(0,0,f,p);a.closePath(),a.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const a=this;this.interval=setInterval(function(){a._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const a=this.getLayer();this.anim.setLayers(a),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const a=this.frameIndex(),l=this.animation(),h=this.animations(),u=h[l],d=u.length/4;a<d-1?this.frameIndex(a+1):this.frameIndex(0)}};return U2.Sprite=s,s.prototype.className="Sprite",(0,r._registerNode)(s),n.Factory.addGetterSetter(s,"animation"),n.Factory.addGetterSetter(s,"animations"),n.Factory.addGetterSetter(s,"frameOffsets"),n.Factory.addGetterSetter(s,"image"),n.Factory.addGetterSetter(s,"frameIndex",0,(0,i.getNumberValidator)()),n.Factory.addGetterSetter(s,"frameRate",17,(0,i.getNumberValidator)()),n.Factory.backCompat(s,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),U2}var O2={},YR;function wGe(){if(YR)return O2;YR=1,Object.defineProperty(O2,"__esModule",{value:!0}),O2.Star=void 0;const n=Ss(),e=ec(),t=js(),i=gs();let r=class extends e.Shape{_sceneFunc(o){const a=this.innerRadius(),l=this.outerRadius(),h=this.numPoints();o.beginPath(),o.moveTo(0,0-l);for(let u=1;u<h*2;u++){const d=u%2===0?l:a,A=d*Math.sin(u*Math.PI/h),f=-1*d*Math.cos(u*Math.PI/h);o.lineTo(A,f)}o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}};return O2.Star=r,r.prototype.className="Star",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(r),n.Factory.addGetterSetter(r,"numPoints",5,(0,t.getNumberValidator)()),n.Factory.addGetterSetter(r,"innerRadius",0,(0,t.getNumberValidator)()),n.Factory.addGetterSetter(r,"outerRadius",0,(0,t.getNumberValidator)()),O2}var im={},KR;function $K(){if(KR)return im;KR=1,Object.defineProperty(im,"__esModule",{value:!0}),im.Text=void 0,im.stringToArray=o;const n=Oa(),e=Ss(),t=ec(),i=gs(),r=js(),s=gs();function o(Y){return[...Y].reduce((K,V,Q,X)=>{if(new RegExp("\\p{Emoji}","u").test(V)){const W=X[Q+1];W&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(W)?(K.push(V+W),X[Q+1]=""):K.push(V)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(V+(X[Q+1]||""))?K.push(V+X[Q+1]):Q>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(V)?K[K.length-1]+=V:V&&K.push(V);return K},[])}const a="auto",l="center",h="inherit",u="justify",d="Change.konva",A="2d",f="-",p="left",g="text",v="Text",w="top",m="bottom",y="middle",x="normal",S="px ",I=" ",j="right",C="rtl",b="word",D="char",T="none",k="…",B=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],E=B.length;function z(Y){return Y.split(",").map(K=>{K=K.trim();const V=K.indexOf(" ")>=0,Q=K.indexOf('"')>=0||K.indexOf("'")>=0;return V&&!Q&&(K=`"${K}"`),K}).join(", ")}let te;function L(){return te||(te=n.Util.createCanvasElement().getContext(A),te)}function O(Y){Y.fillText(this._partialText,this._partialTextX,this._partialTextY)}function J(Y){Y.setAttr("miterLimit",2),Y.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function $(Y){return Y=Y||{},!Y.fillLinearGradientColorStops&&!Y.fillRadialGradientColorStops&&!Y.fillPatternImage&&(Y.fill=Y.fill||"black"),Y}class U extends t.Shape{constructor(K){super($(K)),this._partialTextX=0,this._partialTextY=0;for(let V=0;V<E;V++)this.on(B[V]+d,this._setTextData);this._setTextData()}_sceneFunc(K){const V=this.textArr,Q=V.length;if(!this.text())return;let X=this.padding(),W=this.fontSize(),se=this.lineHeight()*W,q=this.verticalAlign(),de=this.direction(),Ce=0,Se=this.align(),fe=this.getWidth(),M=this.letterSpacing(),Z=this.fill(),Ae=this.textDecoration(),ie=Ae.indexOf("underline")!==-1,ee=Ae.indexOf("line-through")!==-1,ae;de=de===h?K.direction:de;let me=se/2,_e=y;if(i.Konva._fixTextRendering){const ue=this.measureSize("M");_e="alphabetic",me=(ue.fontBoundingBoxAscent-ue.fontBoundingBoxDescent)/2+se/2}for(de===C&&K.setAttr("direction",de),K.setAttr("font",this._getContextFont()),K.setAttr("textBaseline",_e),K.setAttr("textAlign",p),q===y?Ce=(this.getHeight()-Q*se-X*2)/2:q===m&&(Ce=this.getHeight()-Q*se-X*2),K.translate(X,Ce+X),ae=0;ae<Q;ae++){let ue=0,Be=0;const it=V[ae],De=it.text,qe=it.width,Je=it.lastInParagraph;if(K.save(),Se===j?ue+=fe-qe-X*2:Se===l&&(ue+=(fe-qe-X*2)/2),ie){K.save(),K.beginPath();const Me=i.Konva._fixTextRendering?Math.round(W/4):Math.round(W/2),et=ue,He=me+Be+Me;K.moveTo(et,He);const ze=Se===u&&!Je?fe-X*2:qe;K.lineTo(et+Math.round(ze),He),K.lineWidth=W/15;const Oe=this._getLinearGradient();K.strokeStyle=Oe||Z,K.stroke(),K.restore()}if(ee){K.save(),K.beginPath();const Me=i.Konva._fixTextRendering?-Math.round(W/4):0;K.moveTo(ue,me+Be+Me);const et=Se===u&&!Je?fe-X*2:qe;K.lineTo(ue+Math.round(et),me+Be+Me),K.lineWidth=W/15;const He=this._getLinearGradient();K.strokeStyle=He||Z,K.stroke(),K.restore()}if(de!==C&&(M!==0||Se===u)){const Me=De.split(" ").length-1,et=o(De);for(let He=0;He<et.length;He++){const ze=et[He];ze===" "&&!Je&&Se===u&&(ue+=(fe-X*2-qe)/Me),this._partialTextX=ue,this._partialTextY=me+Be,this._partialText=ze,K.fillStrokeShape(this),ue+=this.measureSize(ze).width+M}}else M!==0&&K.setAttr("letterSpacing",`${M}px`),this._partialTextX=ue,this._partialTextY=me+Be,this._partialText=De,K.fillStrokeShape(this);K.restore(),Q>1&&(me+=se)}}_hitFunc(K){const V=this.getWidth(),Q=this.getHeight();K.beginPath(),K.rect(0,0,V,Q),K.closePath(),K.fillStrokeShape(this)}setText(K){const V=n.Util._isString(K)?K:K==null?"":K+"";return this._setAttr(g,V),this}getWidth(){return this.attrs.width===a||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===a||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return n.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(K){var V,Q,X,W,se,q,de,Ce,Se,fe,M;let Z=L(),Ae=this.fontSize(),ie;Z.save(),Z.font=this._getContextFont(),ie=Z.measureText(K),Z.restore();const ee=Ae/100;return{actualBoundingBoxAscent:(V=ie.actualBoundingBoxAscent)!==null&&V!==void 0?V:71.58203125*ee,actualBoundingBoxDescent:(Q=ie.actualBoundingBoxDescent)!==null&&Q!==void 0?Q:0,actualBoundingBoxLeft:(X=ie.actualBoundingBoxLeft)!==null&&X!==void 0?X:-7.421875*ee,actualBoundingBoxRight:(W=ie.actualBoundingBoxRight)!==null&&W!==void 0?W:75.732421875*ee,alphabeticBaseline:(se=ie.alphabeticBaseline)!==null&&se!==void 0?se:0,emHeightAscent:(q=ie.emHeightAscent)!==null&&q!==void 0?q:100*ee,emHeightDescent:(de=ie.emHeightDescent)!==null&&de!==void 0?de:-20*ee,fontBoundingBoxAscent:(Ce=ie.fontBoundingBoxAscent)!==null&&Ce!==void 0?Ce:91*ee,fontBoundingBoxDescent:(Se=ie.fontBoundingBoxDescent)!==null&&Se!==void 0?Se:21*ee,hangingBaseline:(fe=ie.hangingBaseline)!==null&&fe!==void 0?fe:72.80000305175781*ee,ideographicBaseline:(M=ie.ideographicBaseline)!==null&&M!==void 0?M:-21*ee,width:ie.width,height:Ae}}_getContextFont(){return this.fontStyle()+I+this.fontVariant()+I+(this.fontSize()+S)+z(this.fontFamily())}_addTextLine(K){this.align()===u&&(K=K.trim());const Q=this._getTextWidth(K);return this.textArr.push({text:K,width:Q,lastInParagraph:!1})}_getTextWidth(K){const V=this.letterSpacing(),Q=K.length;return L().measureText(K).width+V*Q}_setTextData(){let K=this.text().split(`
`),V=+this.fontSize(),Q=0,X=this.lineHeight()*V,W=this.attrs.width,se=this.attrs.height,q=W!==a&&W!==void 0,de=se!==a&&se!==void 0,Ce=this.padding(),Se=W-Ce*2,fe=se-Ce*2,M=0,Z=this.wrap(),Ae=Z!==T,ie=Z!==D&&Ae,ee=this.ellipsis();this.textArr=[],L().font=this._getContextFont();const ae=ee?this._getTextWidth(k):0;for(let me=0,_e=K.length;me<_e;++me){let ue=K[me],Be=this._getTextWidth(ue);if(q&&Be>Se)for(;ue.length>0;){let it=0,De=o(ue).length,qe="",Je=0;for(;it<De;){const Me=it+De>>>1,et=o(ue),He=et.slice(0,Me+1).join(""),ze=this._getTextWidth(He);(ee&&de&&M+X>fe?ze+ae:ze)<=Se?(it=Me+1,qe=He,Je=ze):De=Me}if(qe){if(ie){const He=o(ue),ze=o(qe),Oe=He[ze.length],ke=Oe===I||Oe===f;let je;if(ke&&Je<=Se)je=ze.length;else{const rt=ze.lastIndexOf(I),_t=ze.lastIndexOf(f);je=Math.max(rt,_t)+1}je>0&&(it=je,qe=He.slice(0,it).join(""),Je=this._getTextWidth(qe))}if(qe=qe.trimRight(),this._addTextLine(qe),Q=Math.max(Q,Je),M+=X,this._shouldHandleEllipsis(M)){this._tryToAddEllipsisToLastLine();break}if(ue=o(ue).slice(it).join("").trimLeft(),ue.length>0&&(Be=this._getTextWidth(ue),Be<=Se)){this._addTextLine(ue),M+=X,Q=Math.max(Q,Be);break}}else break}else this._addTextLine(ue),M+=X,Q=Math.max(Q,Be),this._shouldHandleEllipsis(M)&&me<_e-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),de&&M+X>fe)break}this.textHeight=V,this.textWidth=Q}_shouldHandleEllipsis(K){const V=+this.fontSize(),Q=this.lineHeight()*V,X=this.attrs.height,W=X!==a&&X!==void 0,se=this.padding(),q=X-se*2;return!(this.wrap()!==T)||W&&K+Q>q}_tryToAddEllipsisToLastLine(){const K=this.attrs.width,V=K!==a&&K!==void 0,Q=this.padding(),X=K-Q*2,W=this.ellipsis(),se=this.textArr[this.textArr.length-1];!se||!W||(V&&(this._getTextWidth(se.text+k)<X||(se.text=se.text.slice(0,se.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(se.text+k))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const K=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,V=this.hasShadow();return K&&V?!0:super._useBufferCanvas()}}return im.Text=U,U.prototype._fillFunc=O,U.prototype._strokeFunc=J,U.prototype.className=v,U.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,s._registerNode)(U),e.Factory.overWriteSetter(U,"width",(0,r.getNumberOrAutoValidator)()),e.Factory.overWriteSetter(U,"height",(0,r.getNumberOrAutoValidator)()),e.Factory.addGetterSetter(U,"direction",h),e.Factory.addGetterSetter(U,"fontFamily","Arial"),e.Factory.addGetterSetter(U,"fontSize",12,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(U,"fontStyle",x),e.Factory.addGetterSetter(U,"fontVariant",x),e.Factory.addGetterSetter(U,"padding",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(U,"align",p),e.Factory.addGetterSetter(U,"verticalAlign",w),e.Factory.addGetterSetter(U,"lineHeight",1,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(U,"wrap",b),e.Factory.addGetterSetter(U,"ellipsis",!1,(0,r.getBooleanValidator)()),e.Factory.addGetterSetter(U,"letterSpacing",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(U,"text","",(0,r.getStringValidator)()),e.Factory.addGetterSetter(U,"textDecoration",""),im}var H2={},qR;function vGe(){if(qR)return H2;qR=1,Object.defineProperty(H2,"__esModule",{value:!0}),H2.TextPath=void 0;const n=Oa(),e=Ss(),t=ec(),i=vI(),r=$K(),s=js(),o=gs(),a="",l="normal";function h(A){A.fillText(this.partialText,0,0)}function u(A){A.strokeText(this.partialText,0,0)}let d=class extends t.Shape{constructor(f){super(f),this.dummyCanvas=n.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return i.Path.getPathLength(this.dataArray)}_getPointAtLength(f){if(!this.attrs.data)return null;const p=this.pathLength;return f-1>p?null:i.Path.getPointAtLengthOfDataArray(f,this.dataArray)}_readDataAttribute(){this.dataArray=i.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(f){f.setAttr("font",this._getContextFont()),f.setAttr("textBaseline",this.textBaseline()),f.setAttr("textAlign","left"),f.save();const p=this.textDecoration(),g=this.fill(),v=this.fontSize(),w=this.glyphInfo;p==="underline"&&f.beginPath();for(let m=0;m<w.length;m++){f.save();const y=w[m].p0;f.translate(y.x,y.y),f.rotate(w[m].rotation),this.partialText=w[m].text,f.fillStrokeShape(this),p==="underline"&&(m===0&&f.moveTo(0,v/2+1),f.lineTo(v,v/2+1)),f.restore()}p==="underline"&&(f.strokeStyle=g,f.lineWidth=v/20,f.stroke()),f.restore()}_hitFunc(f){f.beginPath();const p=this.glyphInfo;if(p.length>=1){const g=p[0].p0;f.moveTo(g.x,g.y)}for(let g=0;g<p.length;g++){const v=p[g].p1;f.lineTo(v.x,v.y)}f.setAttr("lineWidth",this.fontSize()),f.setAttr("strokeStyle",this.colorKey),f.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return n.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(f){return r.Text.prototype.setText.call(this,f)}_getContextFont(){return r.Text.prototype._getContextFont.call(this)}_getTextSize(f){const g=this.dummyCanvas.getContext("2d");g.save(),g.font=this._getContextFont();const v=g.measureText(f);return g.restore(),{width:v.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:f,height:p}=this._getTextSize(this.attrs.text);if(this.textWidth=f,this.textHeight=p,this.glyphInfo=[],!this.attrs.data)return null;const g=this.letterSpacing(),v=this.align(),w=this.kerningFunc(),m=Math.max(this.textWidth+((this.attrs.text||"").length-1)*g,0);let y=0;v==="center"&&(y=Math.max(0,this.pathLength/2-m/2)),v==="right"&&(y=Math.max(0,this.pathLength-m));const x=(0,r.stringToArray)(this.text());let S=y;for(let I=0;I<x.length;I++){const j=this._getPointAtLength(S);if(!j)return;let C=this._getTextSize(x[I]).width+g;if(x[I]===" "&&v==="justify"){const E=this.text().split(" ").length-1;C+=(this.pathLength-m)/E}const b=this._getPointAtLength(S+C);if(!b)return;const D=i.Path.getLineLength(j.x,j.y,b.x,b.y);let T=0;if(w)try{T=w(x[I-1],x[I])*this.fontSize()}catch{T=0}j.x+=T,b.x+=T,this.textWidth+=T;const k=i.Path.getPointOnLine(T+D/2,j.x,j.y,b.x,b.y),B=Math.atan2(b.y-j.y,b.x-j.x);this.glyphInfo.push({transposeX:k.x,transposeY:k.y,text:x[I],rotation:B,p0:j,p1:b}),S+=C}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const f=[];this.glyphInfo.forEach(function(S){f.push(S.p0.x),f.push(S.p0.y),f.push(S.p1.x),f.push(S.p1.y)});let p=f[0]||0,g=f[0]||0,v=f[1]||0,w=f[1]||0,m,y;for(let S=0;S<f.length/2;S++)m=f[S*2],y=f[S*2+1],p=Math.min(p,m),g=Math.max(g,m),v=Math.min(v,y),w=Math.max(w,y);const x=this.fontSize();return{x:p-x/2,y:v-x/2,width:g-p+x,height:w-v+x}}destroy(){return n.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};return H2.TextPath=d,d.prototype._fillFunc=h,d.prototype._strokeFunc=u,d.prototype._fillFuncHit=h,d.prototype._strokeFuncHit=u,d.prototype.className="TextPath",d.prototype._attrsAffectingSize=["text","fontSize","data"],(0,o._registerNode)(d),e.Factory.addGetterSetter(d,"data"),e.Factory.addGetterSetter(d,"fontFamily","Arial"),e.Factory.addGetterSetter(d,"fontSize",12,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(d,"fontStyle",l),e.Factory.addGetterSetter(d,"align","left"),e.Factory.addGetterSetter(d,"letterSpacing",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(d,"textBaseline","middle"),e.Factory.addGetterSetter(d,"fontVariant",l),e.Factory.addGetterSetter(d,"text",a),e.Factory.addGetterSetter(d,"textDecoration",""),e.Factory.addGetterSetter(d,"kerningFunc",void 0),H2}var W2={},ZR;function xGe(){if(ZR)return W2;ZR=1,Object.defineProperty(W2,"__esModule",{value:!0}),W2.Transformer=void 0;const n=Oa(),e=Ss(),t=ul(),i=ec(),r=QK(),s=yI(),o=gs(),a=js(),l=gs(),h="tr-konva",u=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(C=>C+`.${h}`).join(" "),d="nodesRect",A=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],f={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},p="ontouchstart"in o.Konva._global;function g(C,b,D){if(C==="rotater")return D;b+=n.Util.degToRad(f[C]||0);const T=(n.Util.radToDeg(b)%360+360)%360;return n.Util._inRange(T,315+22.5,360)||n.Util._inRange(T,0,22.5)?"ns-resize":n.Util._inRange(T,45-22.5,45+22.5)?"nesw-resize":n.Util._inRange(T,90-22.5,90+22.5)?"ew-resize":n.Util._inRange(T,135-22.5,135+22.5)?"nwse-resize":n.Util._inRange(T,180-22.5,180+22.5)?"ns-resize":n.Util._inRange(T,225-22.5,225+22.5)?"nesw-resize":n.Util._inRange(T,270-22.5,270+22.5)?"ew-resize":n.Util._inRange(T,315-22.5,315+22.5)?"nwse-resize":(n.Util.error("Transformer has unknown angle for cursor detection: "+T),"pointer")}const v=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function w(C){return{x:C.x+C.width/2*Math.cos(C.rotation)+C.height/2*Math.sin(-C.rotation),y:C.y+C.height/2*Math.cos(C.rotation)+C.width/2*Math.sin(C.rotation)}}function m(C,b,D){const T=D.x+(C.x-D.x)*Math.cos(b)-(C.y-D.y)*Math.sin(b),k=D.y+(C.x-D.x)*Math.sin(b)+(C.y-D.y)*Math.cos(b);return{...C,rotation:C.rotation+b,x:T,y:k}}function y(C,b){const D=w(C);return m(C,b,D)}function x(C,b,D){let T=b;for(let k=0;k<C.length;k++){const B=o.Konva.getAngle(C[k]),E=Math.abs(B-b)%(Math.PI*2);Math.min(E,Math.PI*2-E)<D&&(T=B)}return T}let S=0,I=class extends s.Group{constructor(b){super(b),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(u,this.update),this.getNode()&&this.update()}attachTo(b){return this.setNode(b),this}setNode(b){return n.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([b])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return h+this._id}setNodes(b=[]){this._nodes&&this._nodes.length&&this.detach();const D=b.filter(k=>k.isAncestorOf(this)?(n.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=b=D,b.length===1&&this.useSingleNodeRotation()?this.rotation(b[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(k=>{const B=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(k._attrsAffectingSize.length){const E=k._attrsAffectingSize.map(z=>z+"Change."+this._getEventNamespace()).join(" ");k.on(E,B)}k.on(A.map(E=>E+`.${this._getEventNamespace()}`).join(" "),B),k.on(`absoluteTransformChange.${this._getEventNamespace()}`,B),this._proxyDrag(k)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(b){let D;b.on(`dragstart.${this._getEventNamespace()}`,T=>{D=b.getAbsolutePosition(),!this.isDragging()&&b!==this.findOne(".back")&&this.startDrag(T,!1)}),b.on(`dragmove.${this._getEventNamespace()}`,T=>{if(!D)return;const k=b.getAbsolutePosition(),B=k.x-D.x,E=k.y-D.y;this.nodes().forEach(z=>{if(z===b||z.isDragging())return;const te=z.getAbsolutePosition();z.setAbsolutePosition({x:te.x+B,y:te.y+E}),z.startDrag(T)}),D=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(b=>{b.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(d),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(d,this.__getNodeRect)}__getNodeShape(b,D=this.rotation(),T){const k=b.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),B=b.getAbsoluteScale(T),E=b.getAbsolutePosition(T),z=k.x*B.x-b.offsetX()*B.x,te=k.y*B.y-b.offsetY()*B.y,L=(o.Konva.getAngle(b.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),O={x:E.x+z*Math.cos(L)+te*Math.sin(-L),y:E.y+te*Math.cos(L)+z*Math.sin(L),width:k.width*B.x,height:k.height*B.y,rotation:L};return m(O,-o.Konva.getAngle(D),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const D=[];this.nodes().map(L=>{const O=L.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),J=[{x:O.x,y:O.y},{x:O.x+O.width,y:O.y},{x:O.x+O.width,y:O.y+O.height},{x:O.x,y:O.y+O.height}],$=L.getAbsoluteTransform();J.forEach(function(U){const Y=$.point(U);D.push(Y)})});const T=new n.Transform;T.rotate(-o.Konva.getAngle(this.rotation()));let k=1/0,B=1/0,E=-1/0,z=-1/0;D.forEach(function(L){const O=T.point(L);k===void 0&&(k=E=O.x,B=z=O.y),k=Math.min(k,O.x),B=Math.min(B,O.y),E=Math.max(E,O.x),z=Math.max(z,O.y)}),T.invert();const te=T.point({x:k,y:B});return{x:te.x,y:te.y,width:E-k,height:z-B,rotation:o.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),v.forEach(b=>{this._createAnchor(b)}),this._createAnchor("rotater")}_createAnchor(b){const D=new r.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:b+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:p?10:"auto"}),T=this;D.on("mousedown touchstart",function(k){T._handleMouseDown(k)}),D.on("dragstart",k=>{D.stopDrag(),k.cancelBubble=!0}),D.on("dragend",k=>{k.cancelBubble=!0}),D.on("mouseenter",()=>{const k=o.Konva.getAngle(this.rotation()),B=this.rotateAnchorCursor(),E=g(b,k,B);D.getStage().content&&(D.getStage().content.style.cursor=E),this._cursorChange=!0}),D.on("mouseout",()=>{D.getStage().content&&(D.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(D)}_createBack(){const b=new i.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(D,T){const k=T.getParent(),B=k.padding();D.beginPath(),D.rect(-B,-B,T.width()+B*2,T.height()+B*2),D.moveTo(T.width()/2,-B),k.rotateEnabled()&&k.rotateLineVisible()&&D.lineTo(T.width()/2,-k.rotateAnchorOffset()*n.Util._sign(T.height())-B),D.fillStrokeShape(T)},hitFunc:(D,T)=>{if(!this.shouldOverdrawWholeArea())return;const k=this.padding();D.beginPath(),D.rect(-k,-k,T.width()+k*2,T.height()+k*2),D.fillStrokeShape(T)}});this.add(b),this._proxyDrag(b),b.on("dragstart",D=>{D.cancelBubble=!0}),b.on("dragmove",D=>{D.cancelBubble=!0}),b.on("dragend",D=>{D.cancelBubble=!0}),this.on("dragmove",D=>{this.update()})}_handleMouseDown(b){if(this._transforming)return;this._movingAnchorName=b.target.name().split(" ")[0];const D=this._getNodeRect(),T=D.width,k=D.height,B=Math.sqrt(Math.pow(T,2)+Math.pow(k,2));this.sin=Math.abs(k/B),this.cos=Math.abs(T/B),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const E=b.target.getAbsolutePosition(),z=b.target.getStage().getPointerPosition();this._anchorDragOffset={x:z.x-E.x,y:z.y-E.y},S++,this._fire("transformstart",{evt:b.evt,target:this.getNode()}),this._nodes.forEach(te=>{te._fire("transformstart",{evt:b.evt,target:te})})}_handleMouseMove(b){let D,T,k;const B=this.findOne("."+this._movingAnchorName),E=B.getStage();E.setPointersPositions(b);const z=E.getPointerPosition();let te={x:z.x-this._anchorDragOffset.x,y:z.y-this._anchorDragOffset.y};const L=B.getAbsolutePosition();this.anchorDragBoundFunc()&&(te=this.anchorDragBoundFunc()(L,te,b)),B.setAbsolutePosition(te);const O=B.getAbsolutePosition();if(L.x===O.x&&L.y===O.y)return;if(this._movingAnchorName==="rotater"){const X=this._getNodeRect();D=B.x()-X.width/2,T=-B.y()+X.height/2;let W=Math.atan2(-T,D)+Math.PI/2;X.height<0&&(W-=Math.PI);const q=o.Konva.getAngle(this.rotation())+W,de=o.Konva.getAngle(this.rotationSnapTolerance()),Se=x(this.rotationSnaps(),q,de)-X.rotation,fe=y(X,Se);this._fitNodesInto(fe,b);return}const J=this.shiftBehavior();let $;J==="inverted"?$=this.keepRatio()&&!b.shiftKey:J==="none"?$=this.keepRatio():$=this.keepRatio()||b.shiftKey;let U=this.centeredScaling()||b.altKey;if(this._movingAnchorName==="top-left"){if($){const X=U?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};k=Math.sqrt(Math.pow(X.x-B.x(),2)+Math.pow(X.y-B.y(),2));const W=this.findOne(".top-left").x()>X.x?-1:1,se=this.findOne(".top-left").y()>X.y?-1:1;D=k*this.cos*W,T=k*this.sin*se,this.findOne(".top-left").x(X.x-D),this.findOne(".top-left").y(X.y-T)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(B.y());else if(this._movingAnchorName==="top-right"){if($){const X=U?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};k=Math.sqrt(Math.pow(B.x()-X.x,2)+Math.pow(X.y-B.y(),2));const W=this.findOne(".top-right").x()<X.x?-1:1,se=this.findOne(".top-right").y()>X.y?-1:1;D=k*this.cos*W,T=k*this.sin*se,this.findOne(".top-right").x(X.x+D),this.findOne(".top-right").y(X.y-T)}var Y=B.position();this.findOne(".top-left").y(Y.y),this.findOne(".bottom-right").x(Y.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(B.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(B.x());else if(this._movingAnchorName==="bottom-left"){if($){const X=U?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};k=Math.sqrt(Math.pow(X.x-B.x(),2)+Math.pow(B.y()-X.y,2));const W=X.x<B.x()?-1:1,se=B.y()<X.y?-1:1;D=k*this.cos*W,T=k*this.sin*se,B.x(X.x-D),B.y(X.y+T)}Y=B.position(),this.findOne(".top-left").x(Y.x),this.findOne(".bottom-right").y(Y.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(B.y());else if(this._movingAnchorName==="bottom-right"){if($){const X=U?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};k=Math.sqrt(Math.pow(B.x()-X.x,2)+Math.pow(B.y()-X.y,2));const W=this.findOne(".bottom-right").x()<X.x?-1:1,se=this.findOne(".bottom-right").y()<X.y?-1:1;D=k*this.cos*W,T=k*this.sin*se,this.findOne(".bottom-right").x(X.x+D),this.findOne(".bottom-right").y(X.y+T)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(U=this.centeredScaling()||b.altKey,U){const X=this.findOne(".top-left"),W=this.findOne(".bottom-right"),se=X.x(),q=X.y(),de=this.getWidth()-W.x(),Ce=this.getHeight()-W.y();W.move({x:-se,y:-q}),X.move({x:de,y:Ce})}const K=this.findOne(".top-left").getAbsolutePosition();D=K.x,T=K.y;const V=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),Q=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:D,y:T,width:V,height:Q,rotation:o.Konva.getAngle(this.rotation())},b)}_handleMouseUp(b){this._removeEvents(b)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(b){var D;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const T=this.getNode();S--,this._fire("transformend",{evt:b,target:T}),(D=this.getLayer())===null||D===void 0||D.batchDraw(),T&&this._nodes.forEach(k=>{var B;k._fire("transformend",{evt:b,target:k}),(B=k.getLayer())===null||B===void 0||B.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(b,D){const T=this._getNodeRect(),k=1;if(n.Util._inRange(b.width,-this.padding()*2-k,k)){this.update();return}if(n.Util._inRange(b.height,-this.padding()*2-k,k)){this.update();return}const B=new n.Transform;if(B.rotate(o.Konva.getAngle(this.rotation())),this._movingAnchorName&&b.width<0&&this._movingAnchorName.indexOf("left")>=0){const $=B.point({x:-this.padding()*2,y:0});b.x+=$.x,b.y+=$.y,b.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=$.x,this._anchorDragOffset.y-=$.y}else if(this._movingAnchorName&&b.width<0&&this._movingAnchorName.indexOf("right")>=0){const $=B.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=$.x,this._anchorDragOffset.y-=$.y,b.width+=this.padding()*2}if(this._movingAnchorName&&b.height<0&&this._movingAnchorName.indexOf("top")>=0){const $=B.point({x:0,y:-this.padding()*2});b.x+=$.x,b.y+=$.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=$.x,this._anchorDragOffset.y-=$.y,b.height+=this.padding()*2}else if(this._movingAnchorName&&b.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const $=B.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=$.x,this._anchorDragOffset.y-=$.y,b.height+=this.padding()*2}if(this.boundBoxFunc()){const $=this.boundBoxFunc()(T,b);$?b=$:n.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const E=1e7,z=new n.Transform;z.translate(T.x,T.y),z.rotate(T.rotation),z.scale(T.width/E,T.height/E);const te=new n.Transform,L=b.width/E,O=b.height/E;this.flipEnabled()===!1?(te.translate(b.x,b.y),te.rotate(b.rotation),te.translate(b.width<0?b.width:0,b.height<0?b.height:0),te.scale(Math.abs(L),Math.abs(O))):(te.translate(b.x,b.y),te.rotate(b.rotation),te.scale(L,O));const J=te.multiply(z.invert());this._nodes.forEach($=>{var U;const Y=$.getParent().getAbsoluteTransform(),K=$.getTransform().copy();K.translate($.offsetX(),$.offsetY());const V=new n.Transform;V.multiply(Y.copy().invert()).multiply(J).multiply(Y).multiply(K);const Q=V.decompose();$.setAttrs(Q),(U=$.getLayer())===null||U===void 0||U.batchDraw()}),this.rotation(n.Util._getRotation(b.rotation)),this._nodes.forEach($=>{this._fire("transform",{evt:D,target:$}),$._fire("transform",{evt:D,target:$})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(b,D){this.findOne(b).setAttrs(D)}update(){var b;const D=this._getNodeRect();this.rotation(n.Util._getRotation(D.rotation));const T=D.width,k=D.height,B=this.enabledAnchors(),E=this.resizeEnabled(),z=this.padding(),te=this.anchorSize(),L=this.find("._anchor");L.forEach(J=>{J.setAttrs({width:te,height:te,offsetX:te/2,offsetY:te/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:te/2+z,offsetY:te/2+z,visible:E&&B.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:T/2,y:0,offsetY:te/2+z,visible:E&&B.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:T,y:0,offsetX:te/2-z,offsetY:te/2+z,visible:E&&B.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:k/2,offsetX:te/2+z,visible:E&&B.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:T,y:k/2,offsetX:te/2-z,visible:E&&B.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:k,offsetX:te/2+z,offsetY:te/2-z,visible:E&&B.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:T/2,y:k,offsetY:te/2-z,visible:E&&B.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:T,y:k,offsetX:te/2-z,offsetY:te/2-z,visible:E&&B.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:T/2,y:-this.rotateAnchorOffset()*n.Util._sign(k)-z,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:T,height:k,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const O=this.anchorStyleFunc();O&&L.forEach(J=>{O(J)}),(b=this.getLayer())===null||b===void 0||b.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const b=this.findOne("."+this._movingAnchorName);b&&b.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),s.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return t.Node.prototype.toObject.call(this)}clone(b){return t.Node.prototype.clone.call(this,b)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};W2.Transformer=I,I.isTransforming=()=>S>0;function j(C){return C instanceof Array||n.Util.warn("enabledAnchors value should be an array"),C instanceof Array&&C.forEach(function(b){v.indexOf(b)===-1&&n.Util.warn("Unknown anchor name: "+b+". Available names are: "+v.join(", "))}),C||[]}return I.prototype.className="Transformer",(0,l._registerNode)(I),e.Factory.addGetterSetter(I,"enabledAnchors",v,j),e.Factory.addGetterSetter(I,"flipEnabled",!0,(0,a.getBooleanValidator)()),e.Factory.addGetterSetter(I,"resizeEnabled",!0),e.Factory.addGetterSetter(I,"anchorSize",10,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(I,"rotateEnabled",!0),e.Factory.addGetterSetter(I,"rotateLineVisible",!0),e.Factory.addGetterSetter(I,"rotationSnaps",[]),e.Factory.addGetterSetter(I,"rotateAnchorOffset",50,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(I,"rotateAnchorCursor","crosshair"),e.Factory.addGetterSetter(I,"rotationSnapTolerance",5,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(I,"borderEnabled",!0),e.Factory.addGetterSetter(I,"anchorStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(I,"anchorStrokeWidth",1,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(I,"anchorFill","white"),e.Factory.addGetterSetter(I,"anchorCornerRadius",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(I,"borderStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(I,"borderStrokeWidth",1,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(I,"borderDash"),e.Factory.addGetterSetter(I,"keepRatio",!0),e.Factory.addGetterSetter(I,"shiftBehavior","default"),e.Factory.addGetterSetter(I,"centeredScaling",!1),e.Factory.addGetterSetter(I,"ignoreStroke",!1),e.Factory.addGetterSetter(I,"padding",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(I,"nodes"),e.Factory.addGetterSetter(I,"node"),e.Factory.addGetterSetter(I,"boundBoxFunc"),e.Factory.addGetterSetter(I,"anchorDragBoundFunc"),e.Factory.addGetterSetter(I,"anchorStyleFunc"),e.Factory.addGetterSetter(I,"shouldOverdrawWholeArea",!1),e.Factory.addGetterSetter(I,"useSingleNodeRotation",!0),e.Factory.backCompat(I,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),W2}var z2={},JR;function bGe(){if(JR)return z2;JR=1,Object.defineProperty(z2,"__esModule",{value:!0}),z2.Wedge=void 0;const n=Ss(),e=ec(),t=gs(),i=js(),r=gs();let s=class extends e.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.radius(),0,t.Konva.getAngle(this.angle()),this.clockwise()),a.lineTo(0,0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(a){this.radius(a/2)}setHeight(a){this.radius(a/2)}};return z2.Wedge=s,s.prototype.className="Wedge",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radius"],(0,r._registerNode)(s),n.Factory.addGetterSetter(s,"radius",0,(0,i.getNumberValidator)()),n.Factory.addGetterSetter(s,"angle",0,(0,i.getNumberValidator)()),n.Factory.addGetterSetter(s,"clockwise",!1),n.Factory.backCompat(s,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),z2}var Q2={},eU;function CGe(){if(eU)return Q2;eU=1,Object.defineProperty(Q2,"__esModule",{value:!0}),Q2.Blur=void 0;const n=Ss(),e=ul(),t=js();function i(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const r=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],s=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function o(l,h){const u=l.data,d=l.width,A=l.height;let f,p,g,v,w,m,y,x,S,I,j,C,b,D,T,k,B,E,z,te;const L=h+h+1,O=d-1,J=A-1,$=h+1,U=$*($+1)/2,Y=new i,K=r[h],V=s[h];let Q=null,X=Y,W=null,se=null;for(let q=1;q<L;q++)X=X.next=new i,q===$&&(Q=X);X.next=Y,g=p=0;for(let q=0;q<A;q++){C=b=D=T=v=w=m=y=0,x=$*(k=u[p]),S=$*(B=u[p+1]),I=$*(E=u[p+2]),j=$*(z=u[p+3]),v+=U*k,w+=U*B,m+=U*E,y+=U*z,X=Y;for(let de=0;de<$;de++)X.r=k,X.g=B,X.b=E,X.a=z,X=X.next;for(let de=1;de<$;de++)f=p+((O<de?O:de)<<2),v+=(X.r=k=u[f])*(te=$-de),w+=(X.g=B=u[f+1])*te,m+=(X.b=E=u[f+2])*te,y+=(X.a=z=u[f+3])*te,C+=k,b+=B,D+=E,T+=z,X=X.next;W=Y,se=Q;for(let de=0;de<d;de++)u[p+3]=z=y*K>>V,z!==0?(z=255/z,u[p]=(v*K>>V)*z,u[p+1]=(w*K>>V)*z,u[p+2]=(m*K>>V)*z):u[p]=u[p+1]=u[p+2]=0,v-=x,w-=S,m-=I,y-=j,x-=W.r,S-=W.g,I-=W.b,j-=W.a,f=g+((f=de+h+1)<O?f:O)<<2,C+=W.r=u[f],b+=W.g=u[f+1],D+=W.b=u[f+2],T+=W.a=u[f+3],v+=C,w+=b,m+=D,y+=T,W=W.next,x+=k=se.r,S+=B=se.g,I+=E=se.b,j+=z=se.a,C-=k,b-=B,D-=E,T-=z,se=se.next,p+=4;g+=d}for(let q=0;q<d;q++){b=D=T=C=w=m=y=v=0,p=q<<2,x=$*(k=u[p]),S=$*(B=u[p+1]),I=$*(E=u[p+2]),j=$*(z=u[p+3]),v+=U*k,w+=U*B,m+=U*E,y+=U*z,X=Y;for(let Ce=0;Ce<$;Ce++)X.r=k,X.g=B,X.b=E,X.a=z,X=X.next;let de=d;for(let Ce=1;Ce<=h;Ce++)p=de+q<<2,v+=(X.r=k=u[p])*(te=$-Ce),w+=(X.g=B=u[p+1])*te,m+=(X.b=E=u[p+2])*te,y+=(X.a=z=u[p+3])*te,C+=k,b+=B,D+=E,T+=z,X=X.next,Ce<J&&(de+=d);p=q,W=Y,se=Q;for(let Ce=0;Ce<A;Ce++)f=p<<2,u[f+3]=z=y*K>>V,z>0?(z=255/z,u[f]=(v*K>>V)*z,u[f+1]=(w*K>>V)*z,u[f+2]=(m*K>>V)*z):u[f]=u[f+1]=u[f+2]=0,v-=x,w-=S,m-=I,y-=j,x-=W.r,S-=W.g,I-=W.b,j-=W.a,f=q+((f=Ce+$)<J?f:J)*d<<2,v+=C+=W.r=u[f],w+=b+=W.g=u[f+1],m+=D+=W.b=u[f+2],y+=T+=W.a=u[f+3],W=W.next,x+=k=se.r,S+=B=se.g,I+=E=se.b,j+=z=se.a,C-=k,b-=B,D-=E,T-=z,se=se.next,p+=d}}const a=function(h){const u=Math.round(this.blurRadius());u>0&&o(h,u)};return Q2.Blur=a,n.Factory.addGetterSetter(e.Node,"blurRadius",0,(0,t.getNumberValidator)(),n.Factory.afterSetFilter),Q2}var $2={},tU;function _Ge(){if(tU)return $2;tU=1,Object.defineProperty($2,"__esModule",{value:!0}),$2.Brighten=void 0;const n=Ss(),e=ul(),t=js(),i=function(r){const s=this.brightness()*255,o=r.data,a=o.length;for(let l=0;l<a;l+=4)o[l]+=s,o[l+1]+=s,o[l+2]+=s};return $2.Brighten=i,n.Factory.addGetterSetter(e.Node,"brightness",0,(0,t.getNumberValidator)(),n.Factory.afterSetFilter),$2}var V2={},nU;function SGe(){if(nU)return V2;nU=1,Object.defineProperty(V2,"__esModule",{value:!0}),V2.Contrast=void 0;const n=Ss(),e=ul(),t=js(),i=function(r){const s=Math.pow((this.contrast()+100)/100,2),o=r.data,a=o.length;let l=150,h=150,u=150;for(let d=0;d<a;d+=4)l=o[d],h=o[d+1],u=o[d+2],l/=255,l-=.5,l*=s,l+=.5,l*=255,h/=255,h-=.5,h*=s,h+=.5,h*=255,u/=255,u-=.5,u*=s,u+=.5,u*=255,l=l<0?0:l>255?255:l,h=h<0?0:h>255?255:h,u=u<0?0:u>255?255:u,o[d]=l,o[d+1]=h,o[d+2]=u};return V2.Contrast=i,n.Factory.addGetterSetter(e.Node,"contrast",0,(0,t.getNumberValidator)(),n.Factory.afterSetFilter),V2}var G2={},iU;function TGe(){if(iU)return G2;iU=1,Object.defineProperty(G2,"__esModule",{value:!0}),G2.Emboss=void 0;const n=Ss(),e=ul(),t=Oa(),i=js(),r=function(s){const o=this.embossStrength()*10,a=this.embossWhiteLevel()*255,l=this.embossDirection(),h=this.embossBlend(),u=s.data,d=s.width,A=s.height,f=d*4;let p=0,g=0,v=A;switch(l){case"top-left":p=-1,g=-1;break;case"top":p=-1,g=0;break;case"top-right":p=-1,g=1;break;case"right":p=0,g=1;break;case"bottom-right":p=1,g=1;break;case"bottom":p=1,g=0;break;case"bottom-left":p=1,g=-1;break;case"left":p=0,g=-1;break;default:t.Util.error("Unknown emboss direction: "+l)}do{const w=(v-1)*f;let m=p;v+m<1&&(m=0),v+m>A&&(m=0);const y=(v-1+m)*d*4;let x=d;do{const S=w+(x-1)*4;let I=g;x+I<1&&(I=0),x+I>d&&(I=0);const j=y+(x-1+I)*4,C=u[S]-u[j],b=u[S+1]-u[j+1],D=u[S+2]-u[j+2];let T=C;const k=T>0?T:-T,B=b>0?b:-b,E=D>0?D:-D;if(B>k&&(T=b),E>k&&(T=D),T*=o,h){const z=u[S]+T,te=u[S+1]+T,L=u[S+2]+T;u[S]=z>255?255:z<0?0:z,u[S+1]=te>255?255:te<0?0:te,u[S+2]=L>255?255:L<0?0:L}else{let z=a-T;z<0?z=0:z>255&&(z=255),u[S]=u[S+1]=u[S+2]=z}}while(--x)}while(--v)};return G2.Emboss=r,n.Factory.addGetterSetter(e.Node,"embossStrength",.5,(0,i.getNumberValidator)(),n.Factory.afterSetFilter),n.Factory.addGetterSetter(e.Node,"embossWhiteLevel",.5,(0,i.getNumberValidator)(),n.Factory.afterSetFilter),n.Factory.addGetterSetter(e.Node,"embossDirection","top-left",void 0,n.Factory.afterSetFilter),n.Factory.addGetterSetter(e.Node,"embossBlend",!1,void 0,n.Factory.afterSetFilter),G2}var X2={},rU;function BGe(){if(rU)return X2;rU=1,Object.defineProperty(X2,"__esModule",{value:!0}),X2.Enhance=void 0;const n=Ss(),e=ul(),t=js();function i(s,o,a,l,h){const u=a-o,d=h-l;if(u===0)return l+d/2;if(d===0)return l;let A=(s-o)/u;return A=d*A+l,A}const r=function(s){const o=s.data,a=o.length;let l=o[0],h=l,u,d=o[1],A=d,f,p=o[2],g=p,v;const w=this.enhance();if(w===0)return;for(let C=0;C<a;C+=4)u=o[C+0],u<l?l=u:u>h&&(h=u),f=o[C+1],f<d?d=f:f>A&&(A=f),v=o[C+2],v<p?p=v:v>g&&(g=v);h===l&&(h=255,l=0),A===d&&(A=255,d=0),g===p&&(g=255,p=0);let m,y,x,S,I,j;if(w>0)m=h+w*(255-h),y=l-w*(l-0),x=A+w*(255-A),S=d-w*(d-0),I=g+w*(255-g),j=p-w*(p-0);else{const C=(h+l)*.5;m=h+w*(h-C),y=l+w*(l-C);const b=(A+d)*.5;x=A+w*(A-b),S=d+w*(d-b);const D=(g+p)*.5;I=g+w*(g-D),j=p+w*(p-D)}for(let C=0;C<a;C+=4)o[C+0]=i(o[C+0],l,h,y,m),o[C+1]=i(o[C+1],d,A,S,x),o[C+2]=i(o[C+2],p,g,j,I)};return X2.Enhance=r,n.Factory.addGetterSetter(e.Node,"enhance",0,(0,t.getNumberValidator)(),n.Factory.afterSetFilter),X2}var Y2={},sU;function EGe(){if(sU)return Y2;sU=1,Object.defineProperty(Y2,"__esModule",{value:!0}),Y2.Grayscale=void 0;const n=function(e){const t=e.data,i=t.length;for(let r=0;r<i;r+=4){const s=.34*t[r]+.5*t[r+1]+.16*t[r+2];t[r]=s,t[r+1]=s,t[r+2]=s}};return Y2.Grayscale=n,Y2}var K2={},oU;function FGe(){if(oU)return K2;oU=1,Object.defineProperty(K2,"__esModule",{value:!0}),K2.HSL=void 0;const n=Ss(),e=ul(),t=js();n.Factory.addGetterSetter(e.Node,"hue",0,(0,t.getNumberValidator)(),n.Factory.afterSetFilter),n.Factory.addGetterSetter(e.Node,"saturation",0,(0,t.getNumberValidator)(),n.Factory.afterSetFilter),n.Factory.addGetterSetter(e.Node,"luminance",0,(0,t.getNumberValidator)(),n.Factory.afterSetFilter);const i=function(r){const s=r.data,o=s.length,a=1,l=Math.pow(2,this.saturation()),h=Math.abs(this.hue()+360)%360,u=this.luminance()*127,d=a*l*Math.cos(h*Math.PI/180),A=a*l*Math.sin(h*Math.PI/180),f=.299*a+.701*d+.167*A,p=.587*a-.587*d+.33*A,g=.114*a-.114*d-.497*A,v=.299*a-.299*d-.328*A,w=.587*a+.413*d+.035*A,m=.114*a-.114*d+.293*A,y=.299*a-.3*d+1.25*A,x=.587*a-.586*d-1.05*A,S=.114*a+.886*d-.2*A;let I,j,C,b;for(let D=0;D<o;D+=4)I=s[D+0],j=s[D+1],C=s[D+2],b=s[D+3],s[D+0]=f*I+p*j+g*C+u,s[D+1]=v*I+w*j+m*C+u,s[D+2]=y*I+x*j+S*C+u,s[D+3]=b};return K2.HSL=i,K2}var q2={},aU;function kGe(){if(aU)return q2;aU=1,Object.defineProperty(q2,"__esModule",{value:!0}),q2.HSV=void 0;const n=Ss(),e=ul(),t=js(),i=function(r){const s=r.data,o=s.length,a=Math.pow(2,this.value()),l=Math.pow(2,this.saturation()),h=Math.abs(this.hue()+360)%360,u=a*l*Math.cos(h*Math.PI/180),d=a*l*Math.sin(h*Math.PI/180),A=.299*a+.701*u+.167*d,f=.587*a-.587*u+.33*d,p=.114*a-.114*u-.497*d,g=.299*a-.299*u-.328*d,v=.587*a+.413*u+.035*d,w=.114*a-.114*u+.293*d,m=.299*a-.3*u+1.25*d,y=.587*a-.586*u-1.05*d,x=.114*a+.886*u-.2*d;for(let S=0;S<o;S+=4){const I=s[S+0],j=s[S+1],C=s[S+2],b=s[S+3];s[S+0]=A*I+f*j+p*C,s[S+1]=g*I+v*j+w*C,s[S+2]=m*I+y*j+x*C,s[S+3]=b}};return q2.HSV=i,n.Factory.addGetterSetter(e.Node,"hue",0,(0,t.getNumberValidator)(),n.Factory.afterSetFilter),n.Factory.addGetterSetter(e.Node,"saturation",0,(0,t.getNumberValidator)(),n.Factory.afterSetFilter),n.Factory.addGetterSetter(e.Node,"value",0,(0,t.getNumberValidator)(),n.Factory.afterSetFilter),q2}var Z2={},lU;function IGe(){if(lU)return Z2;lU=1,Object.defineProperty(Z2,"__esModule",{value:!0}),Z2.Invert=void 0;const n=function(e){const t=e.data,i=t.length;for(let r=0;r<i;r+=4)t[r]=255-t[r],t[r+1]=255-t[r+1],t[r+2]=255-t[r+2]};return Z2.Invert=n,Z2}var J2={},cU;function DGe(){if(cU)return J2;cU=1,Object.defineProperty(J2,"__esModule",{value:!0}),J2.Kaleidoscope=void 0;const n=Ss(),e=ul(),t=Oa(),i=js(),r=function(a,l,h){const u=a.data,d=l.data,A=a.width,f=a.height,p=h.polarCenterX||A/2,g=h.polarCenterY||f/2;let v=Math.sqrt(p*p+g*g),w=A-p,m=f-g;const y=Math.sqrt(w*w+m*m);v=y>v?y:v;const x=f,S=A,I=360/S*Math.PI/180;for(let j=0;j<S;j+=1){const C=Math.sin(j*I),b=Math.cos(j*I);for(let D=0;D<x;D+=1){w=Math.floor(p+v*D/x*b),m=Math.floor(g+v*D/x*C);let T=(m*A+w)*4;const k=u[T+0],B=u[T+1],E=u[T+2],z=u[T+3];T=(j+D*A)*4,d[T+0]=k,d[T+1]=B,d[T+2]=E,d[T+3]=z}}},s=function(a,l,h){const u=a.data,d=l.data,A=a.width,f=a.height,p=h.polarCenterX||A/2,g=h.polarCenterY||f/2;let v=Math.sqrt(p*p+g*g),w=A-p,m=f-g;const y=Math.sqrt(w*w+m*m);v=y>v?y:v;const x=f,S=A,I=0;let j,C;for(w=0;w<A;w+=1)for(m=0;m<f;m+=1){const b=w-p,D=m-g,T=Math.sqrt(b*b+D*D)*x/v;let k=(Math.atan2(D,b)*180/Math.PI+360+I)%360;k=k*S/360,j=Math.floor(k),C=Math.floor(T);let B=(C*A+j)*4;const E=u[B+0],z=u[B+1],te=u[B+2],L=u[B+3];B=(m*A+w)*4,d[B+0]=E,d[B+1]=z,d[B+2]=te,d[B+3]=L}},o=function(a){const l=a.width,h=a.height;let u,d,A,f,p,g,v,w,m,y,x=Math.round(this.kaleidoscopePower());const S=Math.round(this.kaleidoscopeAngle()),I=Math.floor(l*(S%360)/360);if(x<1)return;const j=t.Util.createCanvasElement();j.width=l,j.height=h;const C=j.getContext("2d").getImageData(0,0,l,h);t.Util.releaseCanvas(j),r(a,C,{polarCenterX:l/2,polarCenterY:h/2});let b=l/Math.pow(2,x);for(;b<=8;)b=b*2,x-=1;b=Math.ceil(b);let D=b,T=0,k=D,B=1;for(I+b>l&&(T=D,k=0,B=-1),d=0;d<h;d+=1)for(u=T;u!==k;u+=B)A=Math.round(u+I)%l,m=(l*d+A)*4,p=C.data[m+0],g=C.data[m+1],v=C.data[m+2],w=C.data[m+3],y=(l*d+u)*4,C.data[y+0]=p,C.data[y+1]=g,C.data[y+2]=v,C.data[y+3]=w;for(d=0;d<h;d+=1)for(D=Math.floor(b),f=0;f<x;f+=1){for(u=0;u<D+1;u+=1)m=(l*d+u)*4,p=C.data[m+0],g=C.data[m+1],v=C.data[m+2],w=C.data[m+3],y=(l*d+D*2-u-1)*4,C.data[y+0]=p,C.data[y+1]=g,C.data[y+2]=v,C.data[y+3]=w;D*=2}s(C,a,{})};return J2.Kaleidoscope=o,n.Factory.addGetterSetter(e.Node,"kaleidoscopePower",2,(0,i.getNumberValidator)(),n.Factory.afterSetFilter),n.Factory.addGetterSetter(e.Node,"kaleidoscopeAngle",0,(0,i.getNumberValidator)(),n.Factory.afterSetFilter),J2}var ey={},hU;function jGe(){if(hU)return ey;hU=1,Object.defineProperty(ey,"__esModule",{value:!0}),ey.Mask=void 0;const n=Ss(),e=ul(),t=js();function i(A,f,p){let g=(p*A.width+f)*4;const v=[];return v.push(A.data[g++],A.data[g++],A.data[g++],A.data[g++]),v}function r(A,f){return Math.sqrt(Math.pow(A[0]-f[0],2)+Math.pow(A[1]-f[1],2)+Math.pow(A[2]-f[2],2))}function s(A){const f=[0,0,0];for(let p=0;p<A.length;p++)f[0]+=A[p][0],f[1]+=A[p][1],f[2]+=A[p][2];return f[0]/=A.length,f[1]/=A.length,f[2]/=A.length,f}function o(A,f){const p=i(A,0,0),g=i(A,A.width-1,0),v=i(A,0,A.height-1),w=i(A,A.width-1,A.height-1),m=f||10;if(r(p,g)<m&&r(g,w)<m&&r(w,v)<m&&r(v,p)<m){const y=s([g,p,w,v]),x=[];for(let S=0;S<A.width*A.height;S++){const I=r(y,[A.data[S*4],A.data[S*4+1],A.data[S*4+2]]);x[S]=I<m?0:255}return x}}function a(A,f){for(let p=0;p<A.width*A.height;p++)A.data[4*p+3]=f[p]}function l(A,f,p){const g=[1,1,1,1,0,1,1,1,1],v=Math.round(Math.sqrt(g.length)),w=Math.floor(v/2),m=[];for(let y=0;y<p;y++)for(let x=0;x<f;x++){const S=y*f+x;let I=0;for(let j=0;j<v;j++)for(let C=0;C<v;C++){const b=y+j-w,D=x+C-w;if(b>=0&&b<p&&D>=0&&D<f){const T=b*f+D,k=g[j*v+C];I+=A[T]*k}}m[S]=I===2040?255:0}return m}function h(A,f,p){const g=[1,1,1,1,1,1,1,1,1],v=Math.round(Math.sqrt(g.length)),w=Math.floor(v/2),m=[];for(let y=0;y<p;y++)for(let x=0;x<f;x++){const S=y*f+x;let I=0;for(let j=0;j<v;j++)for(let C=0;C<v;C++){const b=y+j-w,D=x+C-w;if(b>=0&&b<p&&D>=0&&D<f){const T=b*f+D,k=g[j*v+C];I+=A[T]*k}}m[S]=I>=1020?255:0}return m}function u(A,f,p){const g=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],v=Math.round(Math.sqrt(g.length)),w=Math.floor(v/2),m=[];for(let y=0;y<p;y++)for(let x=0;x<f;x++){const S=y*f+x;let I=0;for(let j=0;j<v;j++)for(let C=0;C<v;C++){const b=y+j-w,D=x+C-w;if(b>=0&&b<p&&D>=0&&D<f){const T=b*f+D,k=g[j*v+C];I+=A[T]*k}}m[S]=I}return m}const d=function(A){const f=this.threshold();let p=o(A,f);return p&&(p=l(p,A.width,A.height),p=h(p,A.width,A.height),p=u(p,A.width,A.height),a(A,p)),A};return ey.Mask=d,n.Factory.addGetterSetter(e.Node,"threshold",0,(0,t.getNumberValidator)(),n.Factory.afterSetFilter),ey}var ty={},uU;function PGe(){if(uU)return ty;uU=1,Object.defineProperty(ty,"__esModule",{value:!0}),ty.Noise=void 0;const n=Ss(),e=ul(),t=js(),i=function(r){const s=this.noise()*255,o=r.data,a=o.length,l=s/2;for(let h=0;h<a;h+=4)o[h+0]+=l-2*l*Math.random(),o[h+1]+=l-2*l*Math.random(),o[h+2]+=l-2*l*Math.random()};return ty.Noise=i,n.Factory.addGetterSetter(e.Node,"noise",.2,(0,t.getNumberValidator)(),n.Factory.afterSetFilter),ty}var ny={},dU;function NGe(){if(dU)return ny;dU=1,Object.defineProperty(ny,"__esModule",{value:!0}),ny.Pixelate=void 0;const n=Ss(),e=Oa(),t=ul(),i=js(),r=function(s){let o=Math.ceil(this.pixelSize()),a=s.width,l=s.height,h=Math.ceil(a/o),u=Math.ceil(l/o),d=s.data;if(o<=0){e.Util.error("pixelSize value can not be <= 0");return}for(let A=0;A<h;A+=1)for(let f=0;f<u;f+=1){let p=0,g=0,v=0,w=0;const m=A*o,y=m+o,x=f*o,S=x+o;let I=0;for(let j=m;j<y;j+=1)if(!(j>=a))for(let C=x;C<S;C+=1){if(C>=l)continue;const b=(a*C+j)*4;p+=d[b+0],g+=d[b+1],v+=d[b+2],w+=d[b+3],I+=1}p=p/I,g=g/I,v=v/I,w=w/I;for(let j=m;j<y;j+=1)if(!(j>=a))for(let C=x;C<S;C+=1){if(C>=l)continue;const b=(a*C+j)*4;d[b+0]=p,d[b+1]=g,d[b+2]=v,d[b+3]=w}}};return ny.Pixelate=r,n.Factory.addGetterSetter(t.Node,"pixelSize",8,(0,i.getNumberValidator)(),n.Factory.afterSetFilter),ny}var iy={},AU;function LGe(){if(AU)return iy;AU=1,Object.defineProperty(iy,"__esModule",{value:!0}),iy.Posterize=void 0;const n=Ss(),e=ul(),t=js(),i=function(r){const s=Math.round(this.levels()*254)+1,o=r.data,a=o.length,l=255/s;for(let h=0;h<a;h+=1)o[h]=Math.floor(o[h]/l)*l};return iy.Posterize=i,n.Factory.addGetterSetter(e.Node,"levels",.5,(0,t.getNumberValidator)(),n.Factory.afterSetFilter),iy}var ry={},fU;function MGe(){if(fU)return ry;fU=1,Object.defineProperty(ry,"__esModule",{value:!0}),ry.RGB=void 0;const n=Ss(),e=ul(),t=js(),i=function(r){const s=r.data,o=s.length,a=this.red(),l=this.green(),h=this.blue();for(let u=0;u<o;u+=4){const d=(.34*s[u]+.5*s[u+1]+.16*s[u+2])/255;s[u]=d*a,s[u+1]=d*l,s[u+2]=d*h,s[u+3]=s[u+3]}};return ry.RGB=i,n.Factory.addGetterSetter(e.Node,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),n.Factory.addGetterSetter(e.Node,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),n.Factory.addGetterSetter(e.Node,"blue",0,t.RGBComponent,n.Factory.afterSetFilter),ry}var sy={},pU;function RGe(){if(pU)return sy;pU=1,Object.defineProperty(sy,"__esModule",{value:!0}),sy.RGBA=void 0;const n=Ss(),e=ul(),t=js(),i=function(r){const s=r.data,o=s.length,a=this.red(),l=this.green(),h=this.blue(),u=this.alpha();for(let d=0;d<o;d+=4){const A=1-u;s[d]=a*u+s[d]*A,s[d+1]=l*u+s[d+1]*A,s[d+2]=h*u+s[d+2]*A}};return sy.RGBA=i,n.Factory.addGetterSetter(e.Node,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),n.Factory.addGetterSetter(e.Node,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),n.Factory.addGetterSetter(e.Node,"blue",0,t.RGBComponent,n.Factory.afterSetFilter),n.Factory.addGetterSetter(e.Node,"alpha",1,function(r){return this._filterUpToDate=!1,r>1?1:r<0?0:r}),sy}var oy={},gU;function UGe(){if(gU)return oy;gU=1,Object.defineProperty(oy,"__esModule",{value:!0}),oy.Sepia=void 0;const n=function(e){const t=e.data,i=t.length;for(let r=0;r<i;r+=4){const s=t[r+0],o=t[r+1],a=t[r+2];t[r+0]=Math.min(255,s*.393+o*.769+a*.189),t[r+1]=Math.min(255,s*.349+o*.686+a*.168),t[r+2]=Math.min(255,s*.272+o*.534+a*.131)}};return oy.Sepia=n,oy}var ay={},mU;function OGe(){if(mU)return ay;mU=1,Object.defineProperty(ay,"__esModule",{value:!0}),ay.Solarize=void 0;const n=function(e){const t=e.data,i=e.width,r=e.height,s=i*4;let o=r;do{const a=(o-1)*s;let l=i;do{const h=a+(l-1)*4;let u=t[h],d=t[h+1],A=t[h+2];u>127&&(u=255-u),d>127&&(d=255-d),A>127&&(A=255-A),t[h]=u,t[h+1]=d,t[h+2]=A}while(--l)}while(--o)};return ay.Solarize=n,ay}var ly={},yU;function HGe(){if(yU)return ly;yU=1,Object.defineProperty(ly,"__esModule",{value:!0}),ly.Threshold=void 0;const n=Ss(),e=ul(),t=js(),i=function(r){const s=this.threshold()*255,o=r.data,a=o.length;for(let l=0;l<a;l+=1)o[l]=o[l]<s?0:255};return ly.Threshold=i,n.Factory.addGetterSetter(e.Node,"threshold",.5,(0,t.getNumberValidator)(),n.Factory.afterSetFilter),ly}var wU;function WGe(){if(wU)return b2;wU=1,Object.defineProperty(b2,"__esModule",{value:!0}),b2.Konva=void 0;const n=Y6(),e=cGe(),t=uGe(),i=dGe(),r=AGe(),s=fGe(),o=pGe(),a=zK(),l=vI(),h=QK(),u=gGe(),d=mGe(),A=yGe(),f=wGe(),p=$K(),g=vGe(),v=xGe(),w=bGe(),m=CGe(),y=_Ge(),x=SGe(),S=TGe(),I=BGe(),j=EGe(),C=FGe(),b=kGe(),D=IGe(),T=DGe(),k=jGe(),B=PGe(),E=NGe(),z=LGe(),te=MGe(),L=RGe(),O=UGe(),J=OGe(),$=HGe();return b2.Konva=n.Konva.Util._assign(n.Konva,{Arc:e.Arc,Arrow:t.Arrow,Circle:i.Circle,Ellipse:r.Ellipse,Image:s.Image,Label:o.Label,Tag:o.Tag,Line:a.Line,Path:l.Path,Rect:h.Rect,RegularPolygon:u.RegularPolygon,Ring:d.Ring,Sprite:A.Sprite,Star:f.Star,Text:p.Text,TextPath:g.TextPath,Transformer:v.Transformer,Wedge:w.Wedge,Filters:{Blur:m.Blur,Brighten:y.Brighten,Contrast:x.Contrast,Emboss:S.Emboss,Enhance:I.Enhance,Grayscale:j.Grayscale,HSL:C.HSL,HSV:b.HSV,Invert:D.Invert,Kaleidoscope:T.Kaleidoscope,Mask:k.Mask,Noise:B.Noise,Pixelate:E.Pixelate,Posterize:z.Posterize,RGB:te.RGB,RGBA:L.RGBA,Sepia:O.Sepia,Solarize:J.Solarize,Threshold:$.Threshold}}),b2}var zGe=bC.exports,vU;function QGe(){if(vU)return bC.exports;vU=1,Object.defineProperty(zGe,"__esModule",{value:!0});const n=WGe();return bC.exports=n.Konva,bC.exports}QGe();var Wb={exports:{}},xU;function $Ge(){return xU||(xU=1,(function(n,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;var t=Y6();Object.defineProperty(e,"Konva",{enumerable:!0,get:function(){return t.Konva}});const i=Y6();n.exports=i.Konva})(Wb,Wb.exports)),Wb.exports}var VGe=$Ge();const qw=Vp(VGe);var oB={exports:{}},aB={exports:{}},lB={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bU;function GGe(){return bU||(bU=1,(function(n){function e(O,J){var $=O.length;O.push(J);e:for(;0<$;){var U=$-1>>>1,Y=O[U];if(0<r(Y,J))O[U]=J,O[$]=Y,$=U;else break e}}function t(O){return O.length===0?null:O[0]}function i(O){if(O.length===0)return null;var J=O[0],$=O.pop();if($!==J){O[0]=$;e:for(var U=0,Y=O.length,K=Y>>>1;U<K;){var V=2*(U+1)-1,Q=O[V],X=V+1,W=O[X];if(0>r(Q,$))X<Y&&0>r(W,Q)?(O[U]=W,O[X]=$,U=X):(O[U]=Q,O[V]=$,U=V);else if(X<Y&&0>r(W,$))O[U]=W,O[X]=$,U=X;else break e}}return J}function r(O,J){var $=O.sortIndex-J.sortIndex;return $!==0?$:O.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],h=[],u=1,d=null,A=3,f=!1,p=!1,g=!1,v=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(O){for(var J=t(h);J!==null;){if(J.callback===null)i(h);else if(J.startTime<=O)i(h),J.sortIndex=J.expirationTime,e(l,J);else break;J=t(h)}}function x(O){if(g=!1,y(O),!p)if(t(l)!==null)p=!0,te(S);else{var J=t(h);J!==null&&L(x,J.startTime-O)}}function S(O,J){p=!1,g&&(g=!1,w(C),C=-1),f=!0;var $=A;try{for(y(J),d=t(l);d!==null&&(!(d.expirationTime>J)||O&&!T());){var U=d.callback;if(typeof U=="function"){d.callback=null,A=d.priorityLevel;var Y=U(d.expirationTime<=J);J=n.unstable_now(),typeof Y=="function"?d.callback=Y:d===t(l)&&i(l),y(J)}else i(l);d=t(l)}if(d!==null)var K=!0;else{var V=t(h);V!==null&&L(x,V.startTime-J),K=!1}return K}finally{d=null,A=$,f=!1}}var I=!1,j=null,C=-1,b=5,D=-1;function T(){return!(n.unstable_now()-D<b)}function k(){if(j!==null){var O=n.unstable_now();D=O;var J=!0;try{J=j(!0,O)}finally{J?B():(I=!1,j=null)}}else I=!1}var B;if(typeof m=="function")B=function(){m(k)};else if(typeof MessageChannel<"u"){var E=new MessageChannel,z=E.port2;E.port1.onmessage=k,B=function(){z.postMessage(null)}}else B=function(){v(k,0)};function te(O){j=O,I||(I=!0,B())}function L(O,J){C=v(function(){O(n.unstable_now())},J)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(O){O.callback=null},n.unstable_continueExecution=function(){p||f||(p=!0,te(S))},n.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<O?Math.floor(1e3/O):5},n.unstable_getCurrentPriorityLevel=function(){return A},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(O){switch(A){case 1:case 2:case 3:var J=3;break;default:J=A}var $=A;A=J;try{return O()}finally{A=$}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(O,J){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var $=A;A=O;try{return J()}finally{A=$}},n.unstable_scheduleCallback=function(O,J,$){var U=n.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?U+$:U):$=U,O){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=$+Y,O={id:u++,callback:J,priorityLevel:O,startTime:$,expirationTime:Y,sortIndex:-1},$>U?(O.sortIndex=$,e(h,O),t(l)===null&&O===t(h)&&(g?(w(C),C=-1):g=!0,L(x,$-U))):(O.sortIndex=Y,e(l,O),p||f||(p=!0,te(S))),O},n.unstable_shouldYield=T,n.unstable_wrapCallback=function(O){var J=A;return function(){var $=A;A=J;try{return O.apply(this,arguments)}finally{A=$}}}})(lB)),lB}var CU;function VK(){return CU||(CU=1,aB.exports=GGe()),aB.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cB,_U;function XGe(){return _U||(_U=1,cB=function(e){var t={},i=Oq(),r=VK(),s=Object.assign;function o(_){for(var F="https://reactjs.org/docs/error-decoder.html?invariant="+_,R=1;R<arguments.length;R++)F+="&args[]="+encodeURIComponent(arguments[R]);return"Minified React error #"+_+"; visit "+F+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),h=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),f=Symbol.for("react.provider"),p=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),v=Symbol.for("react.suspense"),w=Symbol.for("react.suspense_list"),m=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),x=Symbol.for("react.offscreen"),S=Symbol.iterator;function I(_){return _===null||typeof _!="object"?null:(_=S&&_[S]||_["@@iterator"],typeof _=="function"?_:null)}function j(_){if(_==null)return null;if(typeof _=="function")return _.displayName||_.name||null;if(typeof _=="string")return _;switch(_){case u:return"Fragment";case h:return"Portal";case A:return"Profiler";case d:return"StrictMode";case v:return"Suspense";case w:return"SuspenseList"}if(typeof _=="object")switch(_.$$typeof){case p:return(_.displayName||"Context")+".Consumer";case f:return(_._context.displayName||"Context")+".Provider";case g:var F=_.render;return _=_.displayName,_||(_=F.displayName||F.name||"",_=_!==""?"ForwardRef("+_+")":"ForwardRef"),_;case m:return F=_.displayName||null,F!==null?F:j(_.type)||"Memo";case y:F=_._payload,_=_._init;try{return j(_(F))}catch{}}return null}function C(_){var F=_.type;switch(_.tag){case 24:return"Cache";case 9:return(F.displayName||"Context")+".Consumer";case 10:return(F._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return _=F.render,_=_.displayName||_.name||"",F.displayName||(_!==""?"ForwardRef("+_+")":"ForwardRef");case 7:return"Fragment";case 5:return F;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return j(F);case 8:return F===d?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof F=="function")return F.displayName||F.name||null;if(typeof F=="string")return F}return null}function b(_){var F=_,R=_;if(_.alternate)for(;F.return;)F=F.return;else{_=F;do F=_,(F.flags&4098)!==0&&(R=F.return),_=F.return;while(_)}return F.tag===3?R:null}function D(_){if(b(_)!==_)throw Error(o(188))}function T(_){var F=_.alternate;if(!F){if(F=b(_),F===null)throw Error(o(188));return F!==_?null:_}for(var R=_,ne=F;;){var oe=R.return;if(oe===null)break;var ge=oe.alternate;if(ge===null){if(ne=oe.return,ne!==null){R=ne;continue}break}if(oe.child===ge.child){for(ge=oe.child;ge;){if(ge===R)return D(oe),_;if(ge===ne)return D(oe),F;ge=ge.sibling}throw Error(o(188))}if(R.return!==ne.return)R=oe,ne=ge;else{for(var $e=!1,Dt=oe.child;Dt;){if(Dt===R){$e=!0,R=oe,ne=ge;break}if(Dt===ne){$e=!0,ne=oe,R=ge;break}Dt=Dt.sibling}if(!$e){for(Dt=ge.child;Dt;){if(Dt===R){$e=!0,R=ge,ne=oe;break}if(Dt===ne){$e=!0,ne=ge,R=oe;break}Dt=Dt.sibling}if(!$e)throw Error(o(189))}}if(R.alternate!==ne)throw Error(o(190))}if(R.tag!==3)throw Error(o(188));return R.stateNode.current===R?_:F}function k(_){return _=T(_),_!==null?B(_):null}function B(_){if(_.tag===5||_.tag===6)return _;for(_=_.child;_!==null;){var F=B(_);if(F!==null)return F;_=_.sibling}return null}function E(_){if(_.tag===5||_.tag===6)return _;for(_=_.child;_!==null;){if(_.tag!==4){var F=E(_);if(F!==null)return F}_=_.sibling}return null}var z=Array.isArray,te=e.getPublicInstance,L=e.getRootHostContext,O=e.getChildHostContext,J=e.prepareForCommit,$=e.resetAfterCommit,U=e.createInstance,Y=e.appendInitialChild,K=e.finalizeInitialChildren,V=e.prepareUpdate,Q=e.shouldSetTextContent,X=e.createTextInstance,W=e.scheduleTimeout,se=e.cancelTimeout,q=e.noTimeout,de=e.isPrimaryRenderer,Ce=e.supportsMutation,Se=e.supportsPersistence,fe=e.supportsHydration,M=e.getInstanceFromNode,Z=e.preparePortalMount,Ae=e.getCurrentEventPriority,ie=e.detachDeletedInstance,ee=e.supportsMicrotasks,ae=e.scheduleMicrotask,me=e.supportsTestSelectors,_e=e.findFiberRoot,ue=e.getBoundingRect,Be=e.getTextContent,it=e.isHiddenSubtree,De=e.matchAccessibilityRole,qe=e.setFocusIfFocusable,Je=e.setupIntersectionObserver,Me=e.appendChild,et=e.appendChildToContainer,He=e.commitTextUpdate,ze=e.commitMount,Oe=e.commitUpdate,ke=e.insertBefore,je=e.insertInContainerBefore,rt=e.removeChild,_t=e.removeChildFromContainer,Ee=e.resetTextContent,Le=e.hideInstance,ye=e.hideTextInstance,Ze=e.unhideInstance,nt=e.unhideTextInstance,st=e.clearContainer,At=e.cloneInstance,ft=e.createContainerChildSet,Xt=e.appendChildToContainerChildSet,Yt=e.finalizeContainerChildren,Zt=e.replaceContainerChildren,sn=e.cloneHiddenInstance,vt=e.cloneHiddenTextInstance,Ye=e.canHydrateInstance,Gt=e.canHydrateTextInstance,Wt=e.canHydrateSuspenseInstance,Vt=e.isSuspenseInstancePending,Jt=e.isSuspenseInstanceFallback,It=e.getSuspenseInstanceFallbackErrorDetails,Ut=e.registerSuspenseInstanceRetry,un=e.getNextHydratableSibling,Sn=e.getFirstHydratableChild,jt=e.getFirstHydratableChildWithinContainer,fn=e.getFirstHydratableChildWithinSuspenseInstance,Zn=e.hydrateInstance,Hn=e.hydrateTextInstance,ti=e.hydrateSuspenseInstance,ri=e.getNextHydratableInstanceAfterSuspenseInstance,bi=e.commitHydratedContainer,Ni=e.commitHydratedSuspenseInstance,ui=e.clearSuspenseBoundary,si=e.clearSuspenseBoundaryFromContainer,Li=e.shouldDeleteUnhydratedTailInstances,Tr=e.didNotMatchHydratedContainerTextInstance,xr=e.didNotMatchHydratedTextInstance,br;function vn(_){if(br===void 0)try{throw Error()}catch(R){var F=R.stack.trim().match(/\n( *(at )?)/);br=F&&F[1]||""}return`
`+br+_}var wi=!1;function Ve(_,F){if(!_||wi)return"";wi=!0;var R=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(F)if(F=function(){throw Error()},Object.defineProperty(F.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(F,[])}catch(oi){var ne=oi}Reflect.construct(_,[],F)}else{try{F.call()}catch(oi){ne=oi}_.call(F.prototype)}else{try{throw Error()}catch(oi){ne=oi}_()}}catch(oi){if(oi&&ne&&typeof oi.stack=="string"){for(var oe=oi.stack.split(`
`),ge=ne.stack.split(`
`),$e=oe.length-1,Dt=ge.length-1;1<=$e&&0<=Dt&&oe[$e]!==ge[Dt];)Dt--;for(;1<=$e&&0<=Dt;$e--,Dt--)if(oe[$e]!==ge[Dt]){if($e!==1||Dt!==1)do if($e--,Dt--,0>Dt||oe[$e]!==ge[Dt]){var hn=`
`+oe[$e].replace(" at new "," at ");return _.displayName&&hn.includes("<anonymous>")&&(hn=hn.replace("<anonymous>",_.displayName)),hn}while(1<=$e&&0<=Dt);break}}}finally{wi=!1,Error.prepareStackTrace=R}return(_=_?_.displayName||_.name:"")?vn(_):""}var ct=Object.prototype.hasOwnProperty,mt=[],An=-1;function nn(_){return{current:_}}function zt(_){0>An||(_.current=mt[An],mt[An]=null,An--)}function gn(_,F){An++,mt[An]=_.current,_.current=F}var Jn={},Qn=nn(Jn),pn=nn(!1),Ln=Jn;function Dn(_,F){var R=_.type.contextTypes;if(!R)return Jn;var ne=_.stateNode;if(ne&&ne.__reactInternalMemoizedUnmaskedChildContext===F)return ne.__reactInternalMemoizedMaskedChildContext;var oe={},ge;for(ge in R)oe[ge]=F[ge];return ne&&(_=_.stateNode,_.__reactInternalMemoizedUnmaskedChildContext=F,_.__reactInternalMemoizedMaskedChildContext=oe),oe}function ei(_){return _=_.childContextTypes,_!=null}function xi(){zt(pn),zt(Qn)}function Yi(_,F,R){if(Qn.current!==Jn)throw Error(o(168));gn(Qn,F),gn(pn,R)}function Bn(_,F,R){var ne=_.stateNode;if(F=F.childContextTypes,typeof ne.getChildContext!="function")return R;ne=ne.getChildContext();for(var oe in ne)if(!(oe in F))throw Error(o(108,C(_)||"Unknown",oe));return s({},R,ne)}function Ri(_){return _=(_=_.stateNode)&&_.__reactInternalMemoizedMergedChildContext||Jn,Ln=Qn.current,gn(Qn,_),gn(pn,pn.current),!0}function xt(_,F,R){var ne=_.stateNode;if(!ne)throw Error(o(169));R?(_=Bn(_,F,Ln),ne.__reactInternalMemoizedMergedChildContext=_,zt(pn),zt(Qn),gn(Qn,_)):zt(pn),gn(pn,R)}var Bt=Math.clz32?Math.clz32:li,on=Math.log,ln=Math.LN2;function li(_){return _>>>=0,_===0?32:31-(on(_)/ln|0)|0}var hi=64,Ii=4194304;function kr(_){switch(_&-_){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return _&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return _}}function zr(_,F){var R=_.pendingLanes;if(R===0)return 0;var ne=0,oe=_.suspendedLanes,ge=_.pingedLanes,$e=R&268435455;if($e!==0){var Dt=$e&~oe;Dt!==0?ne=kr(Dt):(ge&=$e,ge!==0&&(ne=kr(ge)))}else $e=R&~oe,$e!==0?ne=kr($e):ge!==0&&(ne=kr(ge));if(ne===0)return 0;if(F!==0&&F!==ne&&(F&oe)===0&&(oe=ne&-ne,ge=F&-F,oe>=ge||oe===16&&(ge&4194240)!==0))return F;if((ne&4)!==0&&(ne|=R&16),F=_.entangledLanes,F!==0)for(_=_.entanglements,F&=ne;0<F;)R=31-Bt(F),oe=1<<R,ne|=_[R],F&=~oe;return ne}function Us(_,F){switch(_){case 1:case 2:case 4:return F+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return F+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function io(_,F){for(var R=_.suspendedLanes,ne=_.pingedLanes,oe=_.expirationTimes,ge=_.pendingLanes;0<ge;){var $e=31-Bt(ge),Dt=1<<$e,hn=oe[$e];hn===-1?((Dt&R)===0||(Dt&ne)!==0)&&(oe[$e]=Us(Dt,F)):hn<=F&&(_.expiredLanes|=Dt),ge&=~Dt}}function ws(_){return _=_.pendingLanes&-1073741825,_!==0?_:_&1073741824?1073741824:0}function Ts(){var _=hi;return hi<<=1,(hi&4194240)===0&&(hi=64),_}function Mn(_){for(var F=[],R=0;31>R;R++)F.push(_);return F}function ve(_,F,R){_.pendingLanes|=F,F!==536870912&&(_.suspendedLanes=0,_.pingedLanes=0),_=_.eventTimes,F=31-Bt(F),_[F]=R}function Re(_,F){var R=_.pendingLanes&~F;_.pendingLanes=F,_.suspendedLanes=0,_.pingedLanes=0,_.expiredLanes&=F,_.mutableReadLanes&=F,_.entangledLanes&=F,F=_.entanglements;var ne=_.eventTimes;for(_=_.expirationTimes;0<R;){var oe=31-Bt(R),ge=1<<oe;F[oe]=0,ne[oe]=-1,_[oe]=-1,R&=~ge}}function Ke(_,F){var R=_.entangledLanes|=F;for(_=_.entanglements;R;){var ne=31-Bt(R),oe=1<<ne;oe&F|_[ne]&F&&(_[ne]|=F),R&=~oe}}var Ge=0;function pt(_){return _&=-_,1<_?4<_?(_&268435455)!==0?16:536870912:4:1}var Pt=r.unstable_scheduleCallback,pe=r.unstable_cancelCallback,xe=r.unstable_shouldYield,at=r.unstable_requestPaint,dt=r.unstable_now,Qt=r.unstable_ImmediatePriority,wn=r.unstable_UserBlockingPriority,gt=r.unstable_NormalPriority,Vn=r.unstable_IdlePriority,Yn=null,ht=null;function Ot(_){if(ht&&typeof ht.onCommitFiberRoot=="function")try{ht.onCommitFiberRoot(Yn,_,void 0,(_.current.flags&128)===128)}catch{}}function In(_,F){return _===F&&(_!==0||1/_===1/F)||_!==_&&F!==F}var Wn=typeof Object.is=="function"?Object.is:In,xn=null,Gn=!1,fi=!1;function Ki(_){xn===null?xn=[_]:xn.push(_)}function Ji(_){Gn=!0,Ki(_)}function Ci(){if(!fi&&xn!==null){fi=!0;var _=0,F=Ge;try{var R=xn;for(Ge=1;_<R.length;_++){var ne=R[_];do ne=ne(!0);while(ne!==null)}xn=null,Gn=!1}catch(oe){throw xn!==null&&(xn=xn.slice(_+1)),Pt(Qt,Ci),oe}finally{Ge=F,fi=!1}}return null}var Qi=[],zi=0,Ir=null,Hr=0,Si=[],re=0,be=null,Ue=1,ut="";function yt(_,F){Qi[zi++]=Hr,Qi[zi++]=Ir,Ir=_,Hr=F}function en(_,F,R){Si[re++]=Ue,Si[re++]=ut,Si[re++]=be,be=_;var ne=Ue;_=ut;var oe=32-Bt(ne)-1;ne&=~(1<<oe),R+=1;var ge=32-Bt(F)+oe;if(30<ge){var $e=oe-oe%5;ge=(ne&(1<<$e)-1).toString(32),ne>>=$e,oe-=$e,Ue=1<<32-Bt(F)+oe|R<<oe|ne,ut=ge+_}else Ue=1<<ge|R<<oe|ne,ut=_}function cn(_){_.return!==null&&(yt(_,1),en(_,1,0))}function Tn(_){for(;_===Ir;)Ir=Qi[--zi],Qi[zi]=null,Hr=Qi[--zi],Qi[zi]=null;for(;_===be;)be=Si[--re],Si[re]=null,ut=Si[--re],Si[re]=null,Ue=Si[--re],Si[re]=null}var $n=null,ai=null,ni=!1,Rn=!1,sr=null;function dr(_,F){var R=du(5,null,null,0);R.elementType="DELETED",R.stateNode=F,R.return=_,F=_.deletions,F===null?(_.deletions=[R],_.flags|=16):F.push(R)}function qr(_,F){switch(_.tag){case 5:return F=Ye(F,_.type,_.pendingProps),F!==null?(_.stateNode=F,$n=_,ai=Sn(F),!0):!1;case 6:return F=Gt(F,_.pendingProps),F!==null?(_.stateNode=F,$n=_,ai=null,!0):!1;case 13:if(F=Wt(F),F!==null){var R=be!==null?{id:Ue,overflow:ut}:null;return _.memoizedState={dehydrated:F,treeContext:R,retryLane:1073741824},R=du(18,null,null,0),R.stateNode=F,R.return=_,_.child=R,$n=_,ai=null,!0}return!1;default:return!1}}function vs(_){return(_.mode&1)!==0&&(_.flags&128)===0}function Cr(_){if(ni){var F=ai;if(F){var R=F;if(!qr(_,F)){if(vs(_))throw Error(o(418));F=un(R);var ne=$n;F&&qr(_,F)?dr(ne,R):(_.flags=_.flags&-4097|2,ni=!1,$n=_)}}else{if(vs(_))throw Error(o(418));_.flags=_.flags&-4097|2,ni=!1,$n=_}}}function cs(_){for(_=_.return;_!==null&&_.tag!==5&&_.tag!==3&&_.tag!==13;)_=_.return;$n=_}function Qr(_){if(!fe||_!==$n)return!1;if(!ni)return cs(_),ni=!0,!1;if(_.tag!==3&&(_.tag!==5||Li(_.type)&&!Q(_.type,_.memoizedProps))){var F=ai;if(F){if(vs(_))throw or(),Error(o(418));for(;F;)dr(_,F),F=un(F)}}if(cs(_),_.tag===13){if(!fe)throw Error(o(316));if(_=_.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(o(317));ai=ri(_)}else ai=$n?un(_.stateNode):null;return!0}function or(){for(var _=ai;_;)_=un(_)}function hs(){fe&&(ai=$n=null,Rn=ni=!1)}function us(_){sr===null?sr=[_]:sr.push(_)}var Oo=a.ReactCurrentBatchConfig;function va(_,F){if(Wn(_,F))return!0;if(typeof _!="object"||_===null||typeof F!="object"||F===null)return!1;var R=Object.keys(_),ne=Object.keys(F);if(R.length!==ne.length)return!1;for(ne=0;ne<R.length;ne++){var oe=R[ne];if(!ct.call(F,oe)||!Wn(_[oe],F[oe]))return!1}return!0}function Lh(_){switch(_.tag){case 5:return vn(_.type);case 16:return vn("Lazy");case 13:return vn("Suspense");case 19:return vn("SuspenseList");case 0:case 2:case 15:return _=Ve(_.type,!1),_;case 11:return _=Ve(_.type.render,!1),_;case 1:return _=Ve(_.type,!0),_;default:return""}}function xa(_,F,R){if(_=R.ref,_!==null&&typeof _!="function"&&typeof _!="object"){if(R._owner){if(R=R._owner,R){if(R.tag!==1)throw Error(o(309));var ne=R.stateNode}if(!ne)throw Error(o(147,_));var oe=ne,ge=""+_;return F!==null&&F.ref!==null&&typeof F.ref=="function"&&F.ref._stringRef===ge?F.ref:(F=function($e){var Dt=oe.refs;$e===null?delete Dt[ge]:Dt[ge]=$e},F._stringRef=ge,F)}if(typeof _!="string")throw Error(o(284));if(!R._owner)throw Error(o(290,_))}return _}function N(_,F){throw _=Object.prototype.toString.call(F),Error(o(31,_==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":_))}function ce(_){var F=_._init;return F(_._payload)}function we(_){function F(rn,Mt){if(_){var yn=rn.deletions;yn===null?(rn.deletions=[Mt],rn.flags|=16):yn.push(Mt)}}function R(rn,Mt){if(!_)return null;for(;Mt!==null;)F(rn,Mt),Mt=Mt.sibling;return null}function ne(rn,Mt){for(rn=new Map;Mt!==null;)Mt.key!==null?rn.set(Mt.key,Mt):rn.set(Mt.index,Mt),Mt=Mt.sibling;return rn}function oe(rn,Mt){return rn=Hf(rn,Mt),rn.index=0,rn.sibling=null,rn}function ge(rn,Mt,yn){return rn.index=yn,_?(yn=rn.alternate,yn!==null?(yn=yn.index,yn<Mt?(rn.flags|=2,Mt):yn):(rn.flags|=2,Mt)):(rn.flags|=1048576,Mt)}function $e(rn){return _&&rn.alternate===null&&(rn.flags|=2),rn}function Dt(rn,Mt,yn,Fi){return Mt===null||Mt.tag!==6?(Mt=IS(yn,rn.mode,Fi),Mt.return=rn,Mt):(Mt=oe(Mt,yn),Mt.return=rn,Mt)}function hn(rn,Mt,yn,Fi){var yr=yn.type;return yr===u?Vi(rn,Mt,yn.props.children,Fi,yn.key):Mt!==null&&(Mt.elementType===yr||typeof yr=="object"&&yr!==null&&yr.$$typeof===y&&ce(yr)===Mt.type)?(Fi=oe(Mt,yn.props),Fi.ref=xa(rn,Mt,yn),Fi.return=rn,Fi):(Fi=Xv(yn.type,yn.key,yn.props,null,rn.mode,Fi),Fi.ref=xa(rn,Mt,yn),Fi.return=rn,Fi)}function oi(rn,Mt,yn,Fi){return Mt===null||Mt.tag!==4||Mt.stateNode.containerInfo!==yn.containerInfo||Mt.stateNode.implementation!==yn.implementation?(Mt=DS(yn,rn.mode,Fi),Mt.return=rn,Mt):(Mt=oe(Mt,yn.children||[]),Mt.return=rn,Mt)}function Vi(rn,Mt,yn,Fi,yr){return Mt===null||Mt.tag!==7?(Mt=Ag(yn,rn.mode,Fi,yr),Mt.return=rn,Mt):(Mt=oe(Mt,yn),Mt.return=rn,Mt)}function Jr(rn,Mt,yn){if(typeof Mt=="string"&&Mt!==""||typeof Mt=="number")return Mt=IS(""+Mt,rn.mode,yn),Mt.return=rn,Mt;if(typeof Mt=="object"&&Mt!==null){switch(Mt.$$typeof){case l:return yn=Xv(Mt.type,Mt.key,Mt.props,null,rn.mode,yn),yn.ref=xa(rn,null,Mt),yn.return=rn,yn;case h:return Mt=DS(Mt,rn.mode,yn),Mt.return=rn,Mt;case y:var Fi=Mt._init;return Jr(rn,Fi(Mt._payload),yn)}if(z(Mt)||I(Mt))return Mt=Ag(Mt,rn.mode,yn,null),Mt.return=rn,Mt;N(rn,Mt)}return null}function Ei(rn,Mt,yn,Fi){var yr=Mt!==null?Mt.key:null;if(typeof yn=="string"&&yn!==""||typeof yn=="number")return yr!==null?null:Dt(rn,Mt,""+yn,Fi);if(typeof yn=="object"&&yn!==null){switch(yn.$$typeof){case l:return yn.key===yr?hn(rn,Mt,yn,Fi):null;case h:return yn.key===yr?oi(rn,Mt,yn,Fi):null;case y:return yr=yn._init,Ei(rn,Mt,yr(yn._payload),Fi)}if(z(yn)||I(yn))return yr!==null?null:Vi(rn,Mt,yn,Fi,null);N(rn,yn)}return null}function Zo(rn,Mt,yn,Fi,yr){if(typeof Fi=="string"&&Fi!==""||typeof Fi=="number")return rn=rn.get(yn)||null,Dt(Mt,rn,""+Fi,yr);if(typeof Fi=="object"&&Fi!==null){switch(Fi.$$typeof){case l:return rn=rn.get(Fi.key===null?yn:Fi.key)||null,hn(Mt,rn,Fi,yr);case h:return rn=rn.get(Fi.key===null?yn:Fi.key)||null,oi(Mt,rn,Fi,yr);case y:var ds=Fi._init;return Zo(rn,Mt,yn,ds(Fi._payload),yr)}if(z(Fi)||I(Fi))return rn=rn.get(yn)||null,Vi(Mt,rn,Fi,yr,null);N(Mt,Fi)}return null}function Fo(rn,Mt,yn,Fi){for(var yr=null,ds=null,es=Mt,to=Mt=0,Hl=null;es!==null&&to<yn.length;to++){es.index>to?(Hl=es,es=null):Hl=es.sibling;var no=Ei(rn,es,yn[to],Fi);if(no===null){es===null&&(es=Hl);break}_&&es&&no.alternate===null&&F(rn,es),Mt=ge(no,Mt,to),ds===null?yr=no:ds.sibling=no,ds=no,es=Hl}if(to===yn.length)return R(rn,es),ni&&yt(rn,to),yr;if(es===null){for(;to<yn.length;to++)es=Jr(rn,yn[to],Fi),es!==null&&(Mt=ge(es,Mt,to),ds===null?yr=es:ds.sibling=es,ds=es);return ni&&yt(rn,to),yr}for(es=ne(rn,es);to<yn.length;to++)Hl=Zo(es,rn,to,yn[to],Fi),Hl!==null&&(_&&Hl.alternate!==null&&es.delete(Hl.key===null?to:Hl.key),Mt=ge(Hl,Mt,to),ds===null?yr=Hl:ds.sibling=Hl,ds=Hl);return _&&es.forEach(function(Wf){return F(rn,Wf)}),ni&&yt(rn,to),yr}function xh(rn,Mt,yn,Fi){var yr=I(yn);if(typeof yr!="function")throw Error(o(150));if(yn=yr.call(yn),yn==null)throw Error(o(151));for(var ds=yr=null,es=Mt,to=Mt=0,Hl=null,no=yn.next();es!==null&&!no.done;to++,no=yn.next()){es.index>to?(Hl=es,es=null):Hl=es.sibling;var Wf=Ei(rn,es,no.value,Fi);if(Wf===null){es===null&&(es=Hl);break}_&&es&&Wf.alternate===null&&F(rn,es),Mt=ge(Wf,Mt,to),ds===null?yr=Wf:ds.sibling=Wf,ds=Wf,es=Hl}if(no.done)return R(rn,es),ni&&yt(rn,to),yr;if(es===null){for(;!no.done;to++,no=yn.next())no=Jr(rn,no.value,Fi),no!==null&&(Mt=ge(no,Mt,to),ds===null?yr=no:ds.sibling=no,ds=no);return ni&&yt(rn,to),yr}for(es=ne(rn,es);!no.done;to++,no=yn.next())no=Zo(es,rn,to,no.value,Fi),no!==null&&(_&&no.alternate!==null&&es.delete(no.key===null?to:no.key),Mt=ge(no,Mt,to),ds===null?yr=no:ds.sibling=no,ds=no);return _&&es.forEach(function(Bq){return F(rn,Bq)}),ni&&yt(rn,to),yr}function LA(rn,Mt,yn,Fi){if(typeof yn=="object"&&yn!==null&&yn.type===u&&yn.key===null&&(yn=yn.props.children),typeof yn=="object"&&yn!==null){switch(yn.$$typeof){case l:e:{for(var yr=yn.key,ds=Mt;ds!==null;){if(ds.key===yr){if(yr=yn.type,yr===u){if(ds.tag===7){R(rn,ds.sibling),Mt=oe(ds,yn.props.children),Mt.return=rn,rn=Mt;break e}}else if(ds.elementType===yr||typeof yr=="object"&&yr!==null&&yr.$$typeof===y&&ce(yr)===ds.type){R(rn,ds.sibling),Mt=oe(ds,yn.props),Mt.ref=xa(rn,ds,yn),Mt.return=rn,rn=Mt;break e}R(rn,ds);break}else F(rn,ds);ds=ds.sibling}yn.type===u?(Mt=Ag(yn.props.children,rn.mode,Fi,yn.key),Mt.return=rn,rn=Mt):(Fi=Xv(yn.type,yn.key,yn.props,null,rn.mode,Fi),Fi.ref=xa(rn,Mt,yn),Fi.return=rn,rn=Fi)}return $e(rn);case h:e:{for(ds=yn.key;Mt!==null;){if(Mt.key===ds)if(Mt.tag===4&&Mt.stateNode.containerInfo===yn.containerInfo&&Mt.stateNode.implementation===yn.implementation){R(rn,Mt.sibling),Mt=oe(Mt,yn.children||[]),Mt.return=rn,rn=Mt;break e}else{R(rn,Mt);break}else F(rn,Mt);Mt=Mt.sibling}Mt=DS(yn,rn.mode,Fi),Mt.return=rn,rn=Mt}return $e(rn);case y:return ds=yn._init,LA(rn,Mt,ds(yn._payload),Fi)}if(z(yn))return Fo(rn,Mt,yn,Fi);if(I(yn))return xh(rn,Mt,yn,Fi);N(rn,yn)}return typeof yn=="string"&&yn!==""||typeof yn=="number"?(yn=""+yn,Mt!==null&&Mt.tag===6?(R(rn,Mt.sibling),Mt=oe(Mt,yn),Mt.return=rn,rn=Mt):(R(rn,Mt),Mt=IS(yn,rn.mode,Fi),Mt.return=rn,rn=Mt),$e(rn)):R(rn,Mt)}return LA}var Pe=we(!0),Nt=we(!1),tn=nn(null),Un=null,is=null,ro=null;function $r(){ro=is=Un=null}function rs(_,F,R){de?(gn(tn,F._currentValue),F._currentValue=R):(gn(tn,F._currentValue2),F._currentValue2=R)}function Bs(_){var F=tn.current;zt(tn),de?_._currentValue=F:_._currentValue2=F}function _l(_,F,R){for(;_!==null;){var ne=_.alternate;if((_.childLanes&F)!==F?(_.childLanes|=F,ne!==null&&(ne.childLanes|=F)):ne!==null&&(ne.childLanes&F)!==F&&(ne.childLanes|=F),_===R)break;_=_.return}}function Bo(_,F){Un=_,ro=is=null,_=_.dependencies,_!==null&&_.firstContext!==null&&((_.lanes&F)!==0&&(ir=!0),_.firstContext=null)}function Ao(_){var F=de?_._currentValue:_._currentValue2;if(ro!==_)if(_={context:_,memoizedValue:F,next:null},is===null){if(Un===null)throw Error(o(308));is=_,Un.dependencies={lanes:0,firstContext:_}}else is=is.next=_;return F}var Ha=null;function Wa(_){Ha===null?Ha=[_]:Ha.push(_)}function dl(_,F,R,ne){var oe=F.interleaved;return oe===null?(R.next=R,Wa(F)):(R.next=oe.next,oe.next=R),F.interleaved=R,za(_,ne)}function za(_,F){_.lanes|=F;var R=_.alternate;for(R!==null&&(R.lanes|=F),R=_,_=_.return;_!==null;)_.childLanes|=F,R=_.alternate,R!==null&&(R.childLanes|=F),R=_,_=_.return;return R.tag===3?R.stateNode:null}var ba=!1;function Xc(_){_.updateQueue={baseState:_.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ou(_,F){_=_.updateQueue,F.updateQueue===_&&(F.updateQueue={baseState:_.baseState,firstBaseUpdate:_.firstBaseUpdate,lastBaseUpdate:_.lastBaseUpdate,shared:_.shared,effects:_.effects})}function Qa(_,F){return{eventTime:_,lane:F,tag:0,payload:null,callback:null,next:null}}function Vs(_,F,R){var ne=_.updateQueue;if(ne===null)return null;if(ne=ne.shared,(Rr&2)!==0){var oe=ne.pending;return oe===null?F.next=F:(F.next=oe.next,oe.next=F),ne.pending=F,za(_,R)}return oe=ne.interleaved,oe===null?(F.next=F,Wa(ne)):(F.next=oe.next,oe.next=F),ne.interleaved=F,za(_,R)}function Hu(_,F,R){if(F=F.updateQueue,F!==null&&(F=F.shared,(R&4194240)!==0)){var ne=F.lanes;ne&=_.pendingLanes,R|=ne,F.lanes=R,Ke(_,R)}}function Cc(_,F){var R=_.updateQueue,ne=_.alternate;if(ne!==null&&(ne=ne.updateQueue,R===ne)){var oe=null,ge=null;if(R=R.firstBaseUpdate,R!==null){do{var $e={eventTime:R.eventTime,lane:R.lane,tag:R.tag,payload:R.payload,callback:R.callback,next:null};ge===null?oe=ge=$e:ge=ge.next=$e,R=R.next}while(R!==null);ge===null?oe=ge=F:ge=ge.next=F}else oe=ge=F;R={baseState:ne.baseState,firstBaseUpdate:oe,lastBaseUpdate:ge,shared:ne.shared,effects:ne.effects},_.updateQueue=R;return}_=R.lastBaseUpdate,_===null?R.firstBaseUpdate=F:_.next=F,R.lastBaseUpdate=F}function Ll(_,F,R,ne){var oe=_.updateQueue;ba=!1;var ge=oe.firstBaseUpdate,$e=oe.lastBaseUpdate,Dt=oe.shared.pending;if(Dt!==null){oe.shared.pending=null;var hn=Dt,oi=hn.next;hn.next=null,$e===null?ge=oi:$e.next=oi,$e=hn;var Vi=_.alternate;Vi!==null&&(Vi=Vi.updateQueue,Dt=Vi.lastBaseUpdate,Dt!==$e&&(Dt===null?Vi.firstBaseUpdate=oi:Dt.next=oi,Vi.lastBaseUpdate=hn))}if(ge!==null){var Jr=oe.baseState;$e=0,Vi=oi=hn=null,Dt=ge;do{var Ei=Dt.lane,Zo=Dt.eventTime;if((ne&Ei)===Ei){Vi!==null&&(Vi=Vi.next={eventTime:Zo,lane:0,tag:Dt.tag,payload:Dt.payload,callback:Dt.callback,next:null});e:{var Fo=_,xh=Dt;switch(Ei=F,Zo=R,xh.tag){case 1:if(Fo=xh.payload,typeof Fo=="function"){Jr=Fo.call(Zo,Jr,Ei);break e}Jr=Fo;break e;case 3:Fo.flags=Fo.flags&-65537|128;case 0:if(Fo=xh.payload,Ei=typeof Fo=="function"?Fo.call(Zo,Jr,Ei):Fo,Ei==null)break e;Jr=s({},Jr,Ei);break e;case 2:ba=!0}}Dt.callback!==null&&Dt.lane!==0&&(_.flags|=64,Ei=oe.effects,Ei===null?oe.effects=[Dt]:Ei.push(Dt))}else Zo={eventTime:Zo,lane:Ei,tag:Dt.tag,payload:Dt.payload,callback:Dt.callback,next:null},Vi===null?(oi=Vi=Zo,hn=Jr):Vi=Vi.next=Zo,$e|=Ei;if(Dt=Dt.next,Dt===null){if(Dt=oe.shared.pending,Dt===null)break;Ei=Dt,Dt=Ei.next,Ei.next=null,oe.lastBaseUpdate=Ei,oe.shared.pending=null}}while(!0);if(Vi===null&&(hn=Jr),oe.baseState=hn,oe.firstBaseUpdate=oi,oe.lastBaseUpdate=Vi,F=oe.shared.interleaved,F!==null){oe=F;do $e|=oe.lane,oe=oe.next;while(oe!==F)}else ge===null&&(oe.shared.lanes=0);DA|=$e,_.lanes=$e,_.memoizedState=Jr}}function su(_,F,R){if(_=F.effects,F.effects=null,_!==null)for(F=0;F<_.length;F++){var ne=_[F],oe=ne.callback;if(oe!==null){if(ne.callback=null,ne=R,typeof oe!="function")throw Error(o(191,oe));oe.call(ne)}}}var gh={},Ca=nn(gh),Yc=nn(gh),tc=nn(gh);function $a(_){if(_===gh)throw Error(o(174));return _}function _c(_,F){gn(tc,F),gn(Yc,_),gn(Ca,gh),_=L(F),zt(Ca),gn(Ca,_)}function Kc(){zt(Ca),zt(Yc),zt(tc)}function Sl(_){var F=$a(tc.current),R=$a(Ca.current);F=O(R,_.type,F),R!==F&&(gn(Yc,_),gn(Ca,F))}function nc(_){Yc.current===_&&(zt(Ca),zt(Yc))}var Ar=nn(0);function Os(_){for(var F=_;F!==null;){if(F.tag===13){var R=F.memoizedState;if(R!==null&&(R=R.dehydrated,R===null||Vt(R)||Jt(R)))return F}else if(F.tag===19&&F.memoizedProps.revealOrder!==void 0){if((F.flags&128)!==0)return F}else if(F.child!==null){F.child.return=F,F=F.child;continue}if(F===_)break;for(;F.sibling===null;){if(F.return===null||F.return===_)return null;F=F.return}F.sibling.return=F.return,F=F.sibling}return null}var wo=[];function vo(){for(var _=0;_<wo.length;_++){var F=wo[_];de?F._workInProgressVersionPrimary=null:F._workInProgressVersionSecondary=null}wo.length=0}var ic=a.ReactCurrentDispatcher,Mh=a.ReactCurrentBatchConfig,Va=0,Ks=null,Vo=null,ra=null,Ld=!1,Wu=!1,zu=0,rg=0;function _a(){throw Error(o(321))}function TA(_,F){if(F===null)return!1;for(var R=0;R<F.length&&R<_.length;R++)if(!Wn(_[R],F[R]))return!1;return!0}function BA(_,F,R,ne,oe,ge){if(Va=ge,Ks=F,F.memoizedState=null,F.updateQueue=null,F.lanes=0,ic.current=_===null||_.memoizedState===null?$u:Tl,_=R(ne,oe),Wu){ge=0;do{if(Wu=!1,zu=0,25<=ge)throw Error(o(301));ge+=1,ra=Vo=null,F.updateQueue=null,ic.current=F0,_=R(ne,oe)}while(Wu)}if(ic.current=qs,F=Vo!==null&&Vo.next!==null,Va=0,ra=Vo=Ks=null,Ld=!1,F)throw Error(o(300));return _}function EA(){var _=zu!==0;return zu=0,_}function Sc(){var _={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ra===null?Ks.memoizedState=ra=_:ra=ra.next=_,ra}function Tt(){if(Vo===null){var _=Ks.alternate;_=_!==null?_.memoizedState:null}else _=Vo.next;var F=ra===null?Ks.memoizedState:ra.next;if(F!==null)ra=F,Vo=_;else{if(_===null)throw Error(o(310));Vo=_,_={memoizedState:Vo.memoizedState,baseState:Vo.baseState,baseQueue:Vo.baseQueue,queue:Vo.queue,next:null},ra===null?Ks.memoizedState=ra=_:ra=ra.next=_}return ra}function Kn(_,F){return typeof F=="function"?F(_):F}function os(_){var F=Tt(),R=F.queue;if(R===null)throw Error(o(311));R.lastRenderedReducer=_;var ne=Vo,oe=ne.baseQueue,ge=R.pending;if(ge!==null){if(oe!==null){var $e=oe.next;oe.next=ge.next,ge.next=$e}ne.baseQueue=oe=ge,R.pending=null}if(oe!==null){ge=oe.next,ne=ne.baseState;var Dt=$e=null,hn=null,oi=ge;do{var Vi=oi.lane;if((Va&Vi)===Vi)hn!==null&&(hn=hn.next={lane:0,action:oi.action,hasEagerState:oi.hasEagerState,eagerState:oi.eagerState,next:null}),ne=oi.hasEagerState?oi.eagerState:_(ne,oi.action);else{var Jr={lane:Vi,action:oi.action,hasEagerState:oi.hasEagerState,eagerState:oi.eagerState,next:null};hn===null?(Dt=hn=Jr,$e=ne):hn=hn.next=Jr,Ks.lanes|=Vi,DA|=Vi}oi=oi.next}while(oi!==null&&oi!==ge);hn===null?$e=ne:hn.next=Dt,Wn(ne,F.memoizedState)||(ir=!0),F.memoizedState=ne,F.baseState=$e,F.baseQueue=hn,R.lastRenderedState=ne}if(_=R.interleaved,_!==null){oe=_;do ge=oe.lane,Ks.lanes|=ge,DA|=ge,oe=oe.next;while(oe!==_)}else oe===null&&(R.lanes=0);return[F.memoizedState,R.dispatch]}function En(_){var F=Tt(),R=F.queue;if(R===null)throw Error(o(311));R.lastRenderedReducer=_;var ne=R.dispatch,oe=R.pending,ge=F.memoizedState;if(oe!==null){R.pending=null;var $e=oe=oe.next;do ge=_(ge,$e.action),$e=$e.next;while($e!==oe);Wn(ge,F.memoizedState)||(ir=!0),F.memoizedState=ge,F.baseQueue===null&&(F.baseState=ge),R.lastRenderedState=ge}return[ge,ne]}function ur(){}function xs(_,F){var R=Ks,ne=Tt(),oe=F(),ge=!Wn(ne.memoizedState,oe);if(ge&&(ne.memoizedState=oe,ir=!0),ne=ne.queue,Ga(ha.bind(null,R,ne,_),[_]),ne.getSnapshot!==F||ge||ra!==null&&ra.memoizedState.tag&1){if(R.flags|=2048,mr(9,as.bind(null,R,ne,oe,F),void 0,null),bo===null)throw Error(o(349));(Va&30)!==0||an(R,F,oe)}return oe}function an(_,F,R){_.flags|=16384,_={getSnapshot:F,value:R},F=Ks.updateQueue,F===null?(F={lastEffect:null,stores:null},Ks.updateQueue=F,F.stores=[_]):(R=F.stores,R===null?F.stores=[_]:R.push(_))}function as(_,F,R,ne){F.value=R,F.getSnapshot=ne,Tc(F)&&Ml(_)}function ha(_,F,R){return R(function(){Tc(F)&&Ml(_)})}function Tc(_){var F=_.getSnapshot;_=_.value;try{var R=F();return!Wn(_,R)}catch{return!0}}function Ml(_){var F=za(_,1);F!==null&&vh(F,_,1,-1)}function Dr(_){var F=Sc();return typeof _=="function"&&(_=_()),F.memoizedState=F.baseState=_,_={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Kn,lastRenderedState:_},F.queue=_,_=_.dispatch=Rd.bind(null,Ks,_),[F.memoizedState,_]}function mr(_,F,R,ne){return _={tag:_,create:F,destroy:R,deps:ne,next:null},F=Ks.updateQueue,F===null?(F={lastEffect:null,stores:null},Ks.updateQueue=F,F.lastEffect=_.next=_):(R=F.lastEffect,R===null?F.lastEffect=_.next=_:(ne=R.next,R.next=_,_.next=ne,F.lastEffect=_)),_}function Ps(){return Tt().memoizedState}function xo(_,F,R,ne){var oe=Sc();Ks.flags|=_,oe.memoizedState=mr(1|F,R,void 0,ne===void 0?null:ne)}function ou(_,F,R,ne){var oe=Tt();ne=ne===void 0?null:ne;var ge=void 0;if(Vo!==null){var $e=Vo.memoizedState;if(ge=$e.destroy,ne!==null&&TA(ne,$e.deps)){oe.memoizedState=mr(F,R,ge,ne);return}}Ks.flags|=_,oe.memoizedState=mr(1|F,R,ge,ne)}function FA(_,F){return xo(8390656,8,_,F)}function Ga(_,F){return ou(2048,8,_,F)}function jr(_,F){return ou(4,2,_,F)}function Xa(_,F){return ou(4,4,_,F)}function ua(_,F){if(typeof F=="function")return _=_(),F(_),function(){F(null)};if(F!=null)return _=_(),F.current=_,function(){F.current=null}}function kn(_,F,R){return R=R!=null?R.concat([_]):null,ou(4,4,ua.bind(null,F,_),R)}function Qu(){}function mh(_,F){var R=Tt();F=F===void 0?null:F;var ne=R.memoizedState;return ne!==null&&F!==null&&TA(F,ne[1])?ne[0]:(R.memoizedState=[_,F],_)}function Md(_,F){var R=Tt();F=F===void 0?null:F;var ne=R.memoizedState;return ne!==null&&F!==null&&TA(F,ne[1])?ne[0]:(_=_(),R.memoizedState=[_,F],_)}function Eo(_,F,R){return(Va&21)===0?(_.baseState&&(_.baseState=!1,ir=!0),_.memoizedState=R):(Wn(R,F)||(R=Ts(),Ks.lanes|=R,DA|=R,_.baseState=!0),F)}function ls(_,F){var R=Ge;Ge=R!==0&&4>R?R:4,_(!0);var ne=Mh.transition;Mh.transition={};try{_(!1),F()}finally{Ge=R,Mh.transition=ne}}function sg(){return Tt().memoizedState}function V1(_,F,R){var ne=Yu(_);if(R={lane:ne,action:R,hasEagerState:!1,eagerState:null,next:null},kA(_))Rl(F,R);else if(R=dl(_,F,R,ne),R!==null){var oe=kl();vh(R,_,ne,oe),bs(R,F,ne)}}function Rd(_,F,R){var ne=Yu(_),oe={lane:ne,action:R,hasEagerState:!1,eagerState:null,next:null};if(kA(_))Rl(F,oe);else{var ge=_.alternate;if(_.lanes===0&&(ge===null||ge.lanes===0)&&(ge=F.lastRenderedReducer,ge!==null))try{var $e=F.lastRenderedState,Dt=ge($e,R);if(oe.hasEagerState=!0,oe.eagerState=Dt,Wn(Dt,$e)){var hn=F.interleaved;hn===null?(oe.next=oe,Wa(F)):(oe.next=hn.next,hn.next=oe),F.interleaved=oe;return}}catch{}finally{}R=dl(_,F,oe,ne),R!==null&&(oe=kl(),vh(R,_,ne,oe),bs(R,F,ne))}}function kA(_){var F=_.alternate;return _===Ks||F!==null&&F===Ks}function Rl(_,F){Wu=Ld=!0;var R=_.pending;R===null?F.next=F:(F.next=R.next,R.next=F),_.pending=F}function bs(_,F,R){if((R&4194240)!==0){var ne=F.lanes;ne&=_.pendingLanes,R|=ne,F.lanes=R,Ke(_,R)}}var qs={readContext:Ao,useCallback:_a,useContext:_a,useEffect:_a,useImperativeHandle:_a,useInsertionEffect:_a,useLayoutEffect:_a,useMemo:_a,useReducer:_a,useRef:_a,useState:_a,useDebugValue:_a,useDeferredValue:_a,useTransition:_a,useMutableSource:_a,useSyncExternalStore:_a,useId:_a,unstable_isNewReconciler:!1},$u={readContext:Ao,useCallback:function(_,F){return Sc().memoizedState=[_,F===void 0?null:F],_},useContext:Ao,useEffect:FA,useImperativeHandle:function(_,F,R){return R=R!=null?R.concat([_]):null,xo(4194308,4,ua.bind(null,F,_),R)},useLayoutEffect:function(_,F){return xo(4194308,4,_,F)},useInsertionEffect:function(_,F){return xo(4,2,_,F)},useMemo:function(_,F){var R=Sc();return F=F===void 0?null:F,_=_(),R.memoizedState=[_,F],_},useReducer:function(_,F,R){var ne=Sc();return F=R!==void 0?R(F):F,ne.memoizedState=ne.baseState=F,_={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_,lastRenderedState:F},ne.queue=_,_=_.dispatch=V1.bind(null,Ks,_),[ne.memoizedState,_]},useRef:function(_){var F=Sc();return _={current:_},F.memoizedState=_},useState:Dr,useDebugValue:Qu,useDeferredValue:function(_){return Sc().memoizedState=_},useTransition:function(){var _=Dr(!1),F=_[0];return _=ls.bind(null,_[1]),Sc().memoizedState=_,[F,_]},useMutableSource:function(){},useSyncExternalStore:function(_,F,R){var ne=Ks,oe=Sc();if(ni){if(R===void 0)throw Error(o(407));R=R()}else{if(R=F(),bo===null)throw Error(o(349));(Va&30)!==0||an(ne,F,R)}oe.memoizedState=R;var ge={value:R,getSnapshot:F};return oe.queue=ge,FA(ha.bind(null,ne,ge,_),[_]),ne.flags|=2048,mr(9,as.bind(null,ne,ge,R,F),void 0,null),R},useId:function(){var _=Sc(),F=bo.identifierPrefix;if(ni){var R=ut,ne=Ue;R=(ne&~(1<<32-Bt(ne)-1)).toString(32)+R,F=":"+F+"R"+R,R=zu++,0<R&&(F+="H"+R.toString(32)),F+=":"}else R=rg++,F=":"+F+"r"+R.toString(32)+":";return _.memoizedState=F},unstable_isNewReconciler:!1},Tl={readContext:Ao,useCallback:mh,useContext:Ao,useEffect:Ga,useImperativeHandle:kn,useInsertionEffect:jr,useLayoutEffect:Xa,useMemo:Md,useReducer:os,useRef:Ps,useState:function(){return os(Kn)},useDebugValue:Qu,useDeferredValue:function(_){var F=Tt();return Eo(F,Vo.memoizedState,_)},useTransition:function(){var _=os(Kn)[0],F=Tt().memoizedState;return[_,F]},useMutableSource:ur,useSyncExternalStore:xs,useId:sg,unstable_isNewReconciler:!1},F0={readContext:Ao,useCallback:mh,useContext:Ao,useEffect:Ga,useImperativeHandle:kn,useInsertionEffect:jr,useLayoutEffect:Xa,useMemo:Md,useReducer:En,useRef:Ps,useState:function(){return En(Kn)},useDebugValue:Qu,useDeferredValue:function(_){var F=Tt();return Vo===null?F.memoizedState=_:Eo(F,Vo.memoizedState,_)},useTransition:function(){var _=En(Kn)[0],F=Tt().memoizedState;return[_,F]},useMutableSource:ur,useSyncExternalStore:xs,useId:sg,unstable_isNewReconciler:!1};function rc(_,F){if(_&&_.defaultProps){F=s({},F),_=_.defaultProps;for(var R in _)F[R]===void 0&&(F[R]=_[R]);return F}return F}function Rh(_,F,R,ne){F=_.memoizedState,R=R(ne,F),R=R==null?F:s({},F,R),_.memoizedState=R,_.lanes===0&&(_.updateQueue.baseState=R)}var Uh={isMounted:function(_){return(_=_._reactInternals)?b(_)===_:!1},enqueueSetState:function(_,F,R){_=_._reactInternals;var ne=kl(),oe=Yu(_),ge=Qa(ne,oe);ge.payload=F,R!=null&&(ge.callback=R),F=Vs(_,ge,oe),F!==null&&(vh(F,_,oe,ne),Hu(F,_,oe))},enqueueReplaceState:function(_,F,R){_=_._reactInternals;var ne=kl(),oe=Yu(_),ge=Qa(ne,oe);ge.tag=1,ge.payload=F,R!=null&&(ge.callback=R),F=Vs(_,ge,oe),F!==null&&(vh(F,_,oe,ne),Hu(F,_,oe))},enqueueForceUpdate:function(_,F){_=_._reactInternals;var R=kl(),ne=Yu(_),oe=Qa(R,ne);oe.tag=2,F!=null&&(oe.callback=F),F=Vs(_,oe,ne),F!==null&&(vh(F,_,ne,R),Hu(F,_,ne))}};function og(_,F,R,ne,oe,ge,$e){return _=_.stateNode,typeof _.shouldComponentUpdate=="function"?_.shouldComponentUpdate(ne,ge,$e):F.prototype&&F.prototype.isPureReactComponent?!va(R,ne)||!va(oe,ge):!0}function qc(_,F,R){var ne=!1,oe=Jn,ge=F.contextType;return typeof ge=="object"&&ge!==null?ge=Ao(ge):(oe=ei(F)?Ln:Qn.current,ne=F.contextTypes,ge=(ne=ne!=null)?Dn(_,oe):Jn),F=new F(R,ge),_.memoizedState=F.state!==null&&F.state!==void 0?F.state:null,F.updater=Uh,_.stateNode=F,F._reactInternals=_,ne&&(_=_.stateNode,_.__reactInternalMemoizedUnmaskedChildContext=oe,_.__reactInternalMemoizedMaskedChildContext=ge),F}function k0(_,F,R,ne){_=F.state,typeof F.componentWillReceiveProps=="function"&&F.componentWillReceiveProps(R,ne),typeof F.UNSAFE_componentWillReceiveProps=="function"&&F.UNSAFE_componentWillReceiveProps(R,ne),F.state!==_&&Uh.enqueueReplaceState(F,F.state,null)}function yh(_,F,R,ne){var oe=_.stateNode;oe.props=R,oe.state=_.memoizedState,oe.refs={},Xc(_);var ge=F.contextType;typeof ge=="object"&&ge!==null?oe.context=Ao(ge):(ge=ei(F)?Ln:Qn.current,oe.context=Dn(_,ge)),oe.state=_.memoizedState,ge=F.getDerivedStateFromProps,typeof ge=="function"&&(Rh(_,F,ge,R),oe.state=_.memoizedState),typeof F.getDerivedStateFromProps=="function"||typeof oe.getSnapshotBeforeUpdate=="function"||typeof oe.UNSAFE_componentWillMount!="function"&&typeof oe.componentWillMount!="function"||(F=oe.state,typeof oe.componentWillMount=="function"&&oe.componentWillMount(),typeof oe.UNSAFE_componentWillMount=="function"&&oe.UNSAFE_componentWillMount(),F!==oe.state&&Uh.enqueueReplaceState(oe,oe.state,null),Ll(_,R,oe,ne),oe.state=_.memoizedState),typeof oe.componentDidMount=="function"&&(_.flags|=4194308)}function da(_,F){try{var R="",ne=F;do R+=Lh(ne),ne=ne.return;while(ne);var oe=R}catch(ge){oe=`
Error generating stack: `+ge.message+`
`+ge.stack}return{value:_,source:F,stack:oe,digest:null}}function Bc(_,F,R){return{value:_,source:null,stack:R??null,digest:F??null}}function Nf(_,F){try{console.error(F.value)}catch(R){setTimeout(function(){throw R})}}var ag=typeof WeakMap=="function"?WeakMap:Map;function Aa(_,F,R){R=Qa(-1,R),R.tag=3,R.payload={element:null};var ne=F.value;return R.callback=function(){hg||(hg=!0,Rf=ne),Nf(_,F)},R}function Zr(_,F,R){R=Qa(-1,R),R.tag=3;var ne=_.type.getDerivedStateFromError;if(typeof ne=="function"){var oe=F.value;R.payload=function(){return ne(oe)},R.callback=function(){Nf(_,F)}}var ge=_.stateNode;return ge!==null&&typeof ge.componentDidCatch=="function"&&(R.callback=function(){Nf(_,F),typeof ne!="function"&&(lu===null?lu=new Set([this]):lu.add(this));var $e=F.stack;this.componentDidCatch(F.value,{componentStack:$e!==null?$e:""})}),R}function I0(_,F,R){var ne=_.pingCache;if(ne===null){ne=_.pingCache=new ag;var oe=new Set;ne.set(F,oe)}else oe=ne.get(F),oe===void 0&&(oe=new Set,ne.set(F,oe));oe.has(R)||(oe.add(R),_=wq.bind(null,_,F,R),F.then(_,_))}function Kt(_){do{var F;if((F=_.tag===13)&&(F=_.memoizedState,F=F!==null?F.dehydrated!==null:!0),F)return _;_=_.return}while(_!==null);return null}function Cn(_,F,R,ne,oe){return(_.mode&1)===0?(_===F?_.flags|=65536:(_.flags|=128,R.flags|=131072,R.flags&=-52805,R.tag===1&&(R.alternate===null?R.tag=17:(F=Qa(-1,1),F.tag=2,Vs(R,F,1))),R.lanes|=1),_):(_.flags|=65536,_.lanes=oe,_)}var On=a.ReactCurrentOwner,ir=!1;function Ui(_,F,R,ne){F.child=_===null?Nt(F,null,R,ne):Pe(F,_.child,R,ne)}function fo(_,F,R,ne,oe){R=R.render;var ge=F.ref;return Bo(F,oe),ne=BA(_,F,R,ne,ge,oe),R=EA(),_!==null&&!ir?(F.updateQueue=_.updateQueue,F.flags&=-2053,_.lanes&=~oe,le(_,F,oe)):(ni&&R&&cn(F),F.flags|=1,Ui(_,F,ne,oe),F.child)}function Go(_,F,R,ne,oe){if(_===null){var ge=R.type;return typeof ge=="function"&&!kS(ge)&&ge.defaultProps===void 0&&R.compare===null&&R.defaultProps===void 0?(F.tag=15,F.type=ge,Ya(_,F,ge,ne,oe)):(_=Xv(R.type,null,ne,F,F.mode,oe),_.ref=F.ref,_.return=F,F.child=_)}if(ge=_.child,(_.lanes&oe)===0){var $e=ge.memoizedProps;if(R=R.compare,R=R!==null?R:va,R($e,ne)&&_.ref===F.ref)return le(_,F,oe)}return F.flags|=1,_=Hf(ge,ne),_.ref=F.ref,_.return=F,F.child=_}function Ya(_,F,R,ne,oe){if(_!==null){var ge=_.memoizedProps;if(va(ge,ne)&&_.ref===F.ref)if(ir=!1,F.pendingProps=ne=ge,(_.lanes&oe)!==0)(_.flags&131072)!==0&&(ir=!0);else return F.lanes=_.lanes,le(_,F,oe)}return Vu(_,F,R,ne,oe)}function Sa(_,F,R){var ne=F.pendingProps,oe=ne.children,ge=_!==null?_.memoizedState:null;if(ne.mode==="hidden")if((F.mode&1)===0)F.memoizedState={baseLanes:0,cachePool:null,transitions:null},gn(Gu,cc),cc|=R;else{if((R&1073741824)===0)return _=ge!==null?ge.baseLanes|R:R,F.lanes=F.childLanes=1073741824,F.memoizedState={baseLanes:_,cachePool:null,transitions:null},F.updateQueue=null,gn(Gu,cc),cc|=_,null;F.memoizedState={baseLanes:0,cachePool:null,transitions:null},ne=ge!==null?ge.baseLanes:R,gn(Gu,cc),cc|=ne}else ge!==null?(ne=ge.baseLanes|R,F.memoizedState=null):ne=R,gn(Gu,cc),cc|=ne;return Ui(_,F,oe,R),F.child}function sc(_,F){var R=F.ref;(_===null&&R!==null||_!==null&&_.ref!==R)&&(F.flags|=512,F.flags|=2097152)}function Vu(_,F,R,ne,oe){var ge=ei(R)?Ln:Qn.current;return ge=Dn(F,ge),Bo(F,oe),R=BA(_,F,R,ne,ge,oe),ne=EA(),_!==null&&!ir?(F.updateQueue=_.updateQueue,F.flags&=-2053,_.lanes&=~oe,le(_,F,oe)):(ni&&ne&&cn(F),F.flags|=1,Ui(_,F,R,oe),F.child)}function Lf(_,F,R,ne,oe){if(ei(R)){var ge=!0;Ri(F)}else ge=!1;if(Bo(F,oe),F.stateNode===null)G(_,F),qc(F,R,ne),yh(F,R,ne,oe),ne=!0;else if(_===null){var $e=F.stateNode,Dt=F.memoizedProps;$e.props=Dt;var hn=$e.context,oi=R.contextType;typeof oi=="object"&&oi!==null?oi=Ao(oi):(oi=ei(R)?Ln:Qn.current,oi=Dn(F,oi));var Vi=R.getDerivedStateFromProps,Jr=typeof Vi=="function"||typeof $e.getSnapshotBeforeUpdate=="function";Jr||typeof $e.UNSAFE_componentWillReceiveProps!="function"&&typeof $e.componentWillReceiveProps!="function"||(Dt!==ne||hn!==oi)&&k0(F,$e,ne,oi),ba=!1;var Ei=F.memoizedState;$e.state=Ei,Ll(F,ne,$e,oe),hn=F.memoizedState,Dt!==ne||Ei!==hn||pn.current||ba?(typeof Vi=="function"&&(Rh(F,R,Vi,ne),hn=F.memoizedState),(Dt=ba||og(F,R,Dt,ne,Ei,hn,oi))?(Jr||typeof $e.UNSAFE_componentWillMount!="function"&&typeof $e.componentWillMount!="function"||(typeof $e.componentWillMount=="function"&&$e.componentWillMount(),typeof $e.UNSAFE_componentWillMount=="function"&&$e.UNSAFE_componentWillMount()),typeof $e.componentDidMount=="function"&&(F.flags|=4194308)):(typeof $e.componentDidMount=="function"&&(F.flags|=4194308),F.memoizedProps=ne,F.memoizedState=hn),$e.props=ne,$e.state=hn,$e.context=oi,ne=Dt):(typeof $e.componentDidMount=="function"&&(F.flags|=4194308),ne=!1)}else{$e=F.stateNode,Ou(_,F),Dt=F.memoizedProps,oi=F.type===F.elementType?Dt:rc(F.type,Dt),$e.props=oi,Jr=F.pendingProps,Ei=$e.context,hn=R.contextType,typeof hn=="object"&&hn!==null?hn=Ao(hn):(hn=ei(R)?Ln:Qn.current,hn=Dn(F,hn));var Zo=R.getDerivedStateFromProps;(Vi=typeof Zo=="function"||typeof $e.getSnapshotBeforeUpdate=="function")||typeof $e.UNSAFE_componentWillReceiveProps!="function"&&typeof $e.componentWillReceiveProps!="function"||(Dt!==Jr||Ei!==hn)&&k0(F,$e,ne,hn),ba=!1,Ei=F.memoizedState,$e.state=Ei,Ll(F,ne,$e,oe);var Fo=F.memoizedState;Dt!==Jr||Ei!==Fo||pn.current||ba?(typeof Zo=="function"&&(Rh(F,R,Zo,ne),Fo=F.memoizedState),(oi=ba||og(F,R,oi,ne,Ei,Fo,hn)||!1)?(Vi||typeof $e.UNSAFE_componentWillUpdate!="function"&&typeof $e.componentWillUpdate!="function"||(typeof $e.componentWillUpdate=="function"&&$e.componentWillUpdate(ne,Fo,hn),typeof $e.UNSAFE_componentWillUpdate=="function"&&$e.UNSAFE_componentWillUpdate(ne,Fo,hn)),typeof $e.componentDidUpdate=="function"&&(F.flags|=4),typeof $e.getSnapshotBeforeUpdate=="function"&&(F.flags|=1024)):(typeof $e.componentDidUpdate!="function"||Dt===_.memoizedProps&&Ei===_.memoizedState||(F.flags|=4),typeof $e.getSnapshotBeforeUpdate!="function"||Dt===_.memoizedProps&&Ei===_.memoizedState||(F.flags|=1024),F.memoizedProps=ne,F.memoizedState=Fo),$e.props=ne,$e.state=Fo,$e.context=hn,ne=oi):(typeof $e.componentDidUpdate!="function"||Dt===_.memoizedProps&&Ei===_.memoizedState||(F.flags|=4),typeof $e.getSnapshotBeforeUpdate!="function"||Dt===_.memoizedProps&&Ei===_.memoizedState||(F.flags|=1024),ne=!1)}return G1(_,F,R,ne,ge,oe)}function G1(_,F,R,ne,oe,ge){sc(_,F);var $e=(F.flags&128)!==0;if(!ne&&!$e)return oe&&xt(F,R,!1),le(_,F,ge);ne=F.stateNode,On.current=F;var Dt=$e&&typeof R.getDerivedStateFromError!="function"?null:ne.render();return F.flags|=1,_!==null&&$e?(F.child=Pe(F,_.child,null,ge),F.child=Pe(F,null,Dt,ge)):Ui(_,F,Dt,ge),F.memoizedState=ne.state,oe&&xt(F,R,!0),F.child}function Hv(_){var F=_.stateNode;F.pendingContext?Yi(_,F.pendingContext,F.pendingContext!==F.context):F.context&&Yi(_,F.context,!1),_c(_,F.containerInfo)}function Wv(_,F,R,ne,oe){return hs(),us(oe),F.flags|=256,Ui(_,F,R,ne),F.child}var X1={dehydrated:null,treeContext:null,retryLane:0};function Y1(_){return{baseLanes:_,cachePool:null,transitions:null}}function zv(_,F,R){var ne=F.pendingProps,oe=Ar.current,ge=!1,$e=(F.flags&128)!==0,Dt;if((Dt=$e)||(Dt=_!==null&&_.memoizedState===null?!1:(oe&2)!==0),Dt?(ge=!0,F.flags&=-129):(_===null||_.memoizedState!==null)&&(oe|=1),gn(Ar,oe&1),_===null)return Cr(F),_=F.memoizedState,_!==null&&(_=_.dehydrated,_!==null)?((F.mode&1)===0?F.lanes=1:Jt(_)?F.lanes=8:F.lanes=1073741824,null):($e=ne.children,_=ne.fallback,ge?(ne=F.mode,ge=F.child,$e={mode:"hidden",children:$e},(ne&1)===0&&ge!==null?(ge.childLanes=0,ge.pendingProps=$e):ge=Yv($e,ne,0,null),_=Ag(_,ne,R,null),ge.return=F,_.return=F,ge.sibling=_,F.child=ge,F.child.memoizedState=Y1(R),F.memoizedState=X1,_):D0(F,$e));if(oe=_.memoizedState,oe!==null&&(Dt=oe.dehydrated,Dt!==null))return ES(_,F,$e,ne,Dt,oe,R);if(ge){ge=ne.fallback,$e=F.mode,oe=_.child,Dt=oe.sibling;var hn={mode:"hidden",children:ne.children};return($e&1)===0&&F.child!==oe?(ne=F.child,ne.childLanes=0,ne.pendingProps=hn,F.deletions=null):(ne=Hf(oe,hn),ne.subtreeFlags=oe.subtreeFlags&14680064),Dt!==null?ge=Hf(Dt,ge):(ge=Ag(ge,$e,R,null),ge.flags|=2),ge.return=F,ne.return=F,ne.sibling=ge,F.child=ne,ne=ge,ge=F.child,$e=_.child.memoizedState,$e=$e===null?Y1(R):{baseLanes:$e.baseLanes|R,cachePool:null,transitions:$e.transitions},ge.memoizedState=$e,ge.childLanes=_.childLanes&~R,F.memoizedState=X1,ne}return ge=_.child,_=ge.sibling,ne=Hf(ge,{mode:"visible",children:ne.children}),(F.mode&1)===0&&(ne.lanes=R),ne.return=F,ne.sibling=null,_!==null&&(R=F.deletions,R===null?(F.deletions=[_],F.flags|=16):R.push(_)),F.child=ne,F.memoizedState=null,ne}function D0(_,F){return F=Yv({mode:"visible",children:F},_.mode,0,null),F.return=_,_.child=F}function IA(_,F,R,ne){return ne!==null&&us(ne),Pe(F,_.child,null,R),_=D0(F,F.pendingProps.children),_.flags|=2,F.memoizedState=null,_}function ES(_,F,R,ne,oe,ge,$e){if(R)return F.flags&256?(F.flags&=-257,ne=Bc(Error(o(422))),IA(_,F,$e,ne)):F.memoizedState!==null?(F.child=_.child,F.flags|=128,null):(ge=ne.fallback,oe=F.mode,ne=Yv({mode:"visible",children:ne.children},oe,0,null),ge=Ag(ge,oe,$e,null),ge.flags|=2,ne.return=F,ge.return=F,ne.sibling=ge,F.child=ne,(F.mode&1)!==0&&Pe(F,_.child,null,$e),F.child.memoizedState=Y1($e),F.memoizedState=X1,ge);if((F.mode&1)===0)return IA(_,F,$e,null);if(Jt(oe))return ne=It(oe).digest,ge=Error(o(419)),ne=Bc(ge,ne,void 0),IA(_,F,$e,ne);if(R=($e&_.childLanes)!==0,ir||R){if(ne=bo,ne!==null){switch($e&-$e){case 4:oe=2;break;case 16:oe=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:oe=32;break;case 536870912:oe=268435456;break;default:oe=0}oe=(oe&(ne.suspendedLanes|$e))!==0?0:oe,oe!==0&&oe!==ge.retryLane&&(ge.retryLane=oe,za(_,oe),vh(ne,_,oe,-1))}return uu(),ne=Bc(Error(o(421))),IA(_,F,$e,ne)}return Vt(oe)?(F.flags|=128,F.child=_.child,F=vq.bind(null,_),Ut(oe,F),null):(_=ge.treeContext,fe&&(ai=fn(oe),$n=F,ni=!0,sr=null,Rn=!1,_!==null&&(Si[re++]=Ue,Si[re++]=ut,Si[re++]=be,Ue=_.id,ut=_.overflow,be=F)),F=D0(F,ne.children),F.flags|=4096,F)}function Qv(_,F,R){_.lanes|=F;var ne=_.alternate;ne!==null&&(ne.lanes|=F),_l(_.return,F,R)}function j0(_,F,R,ne,oe){var ge=_.memoizedState;ge===null?_.memoizedState={isBackwards:F,rendering:null,renderingStartTime:0,last:ne,tail:R,tailMode:oe}:(ge.isBackwards=F,ge.rendering=null,ge.renderingStartTime=0,ge.last=ne,ge.tail=R,ge.tailMode=oe)}function P(_,F,R){var ne=F.pendingProps,oe=ne.revealOrder,ge=ne.tail;if(Ui(_,F,ne.children,R),ne=Ar.current,(ne&2)!==0)ne=ne&1|2,F.flags|=128;else{if(_!==null&&(_.flags&128)!==0)e:for(_=F.child;_!==null;){if(_.tag===13)_.memoizedState!==null&&Qv(_,R,F);else if(_.tag===19)Qv(_,R,F);else if(_.child!==null){_.child.return=_,_=_.child;continue}if(_===F)break e;for(;_.sibling===null;){if(_.return===null||_.return===F)break e;_=_.return}_.sibling.return=_.return,_=_.sibling}ne&=1}if(gn(Ar,ne),(F.mode&1)===0)F.memoizedState=null;else switch(oe){case"forwards":for(R=F.child,oe=null;R!==null;)_=R.alternate,_!==null&&Os(_)===null&&(oe=R),R=R.sibling;R=oe,R===null?(oe=F.child,F.child=null):(oe=R.sibling,R.sibling=null),j0(F,!1,oe,R,ge);break;case"backwards":for(R=null,oe=F.child,F.child=null;oe!==null;){if(_=oe.alternate,_!==null&&Os(_)===null){F.child=oe;break}_=oe.sibling,oe.sibling=R,R=oe,oe=_}j0(F,!0,R,null,ge);break;case"together":j0(F,!1,null,null,void 0);break;default:F.memoizedState=null}return F.child}function G(_,F){(F.mode&1)===0&&_!==null&&(_.alternate=null,F.alternate=null,F.flags|=2)}function le(_,F,R){if(_!==null&&(F.dependencies=_.dependencies),DA|=F.lanes,(R&F.childLanes)===0)return null;if(_!==null&&F.child!==_.child)throw Error(o(153));if(F.child!==null){for(_=F.child,R=Hf(_,_.pendingProps),F.child=R,R.return=F;_.sibling!==null;)_=_.sibling,R=R.sibling=Hf(_,_.pendingProps),R.return=F;R.sibling=null}return F.child}function he(_,F,R){switch(F.tag){case 3:Hv(F),hs();break;case 5:Sl(F);break;case 1:ei(F.type)&&Ri(F);break;case 4:_c(F,F.stateNode.containerInfo);break;case 10:rs(F,F.type._context,F.memoizedProps.value);break;case 13:var ne=F.memoizedState;if(ne!==null)return ne.dehydrated!==null?(gn(Ar,Ar.current&1),F.flags|=128,null):(R&F.child.childLanes)!==0?zv(_,F,R):(gn(Ar,Ar.current&1),_=le(_,F,R),_!==null?_.sibling:null);gn(Ar,Ar.current&1);break;case 19:if(ne=(R&F.childLanes)!==0,(_.flags&128)!==0){if(ne)return P(_,F,R);F.flags|=128}var oe=F.memoizedState;if(oe!==null&&(oe.rendering=null,oe.tail=null,oe.lastEffect=null),gn(Ar,Ar.current),ne)break;return null;case 22:case 23:return F.lanes=0,Sa(_,F,R)}return le(_,F,R)}function Te(_){_.flags|=4}function Fe(_,F){if(_!==null&&_.child===F.child)return!0;if((F.flags&16)!==0)return!1;for(_=F.child;_!==null;){if((_.flags&12854)!==0||(_.subtreeFlags&12854)!==0)return!1;_=_.sibling}return!0}var Ie,Ne,We,tt;if(Ce)Ie=function(_,F){for(var R=F.child;R!==null;){if(R.tag===5||R.tag===6)Y(_,R.stateNode);else if(R.tag!==4&&R.child!==null){R.child.return=R,R=R.child;continue}if(R===F)break;for(;R.sibling===null;){if(R.return===null||R.return===F)return;R=R.return}R.sibling.return=R.return,R=R.sibling}},Ne=function(){},We=function(_,F,R,ne,oe){if(_=_.memoizedProps,_!==ne){var ge=F.stateNode,$e=$a(Ca.current);R=V(ge,R,_,ne,oe,$e),(F.updateQueue=R)&&Te(F)}},tt=function(_,F,R,ne){R!==ne&&Te(F)};else if(Se){Ie=function(_,F,R,ne){for(var oe=F.child;oe!==null;){if(oe.tag===5){var ge=oe.stateNode;R&&ne&&(ge=sn(ge,oe.type,oe.memoizedProps,oe)),Y(_,ge)}else if(oe.tag===6)ge=oe.stateNode,R&&ne&&(ge=vt(ge,oe.memoizedProps,oe)),Y(_,ge);else if(oe.tag!==4){if(oe.tag===22&&oe.memoizedState!==null)ge=oe.child,ge!==null&&(ge.return=oe),Ie(_,oe,!0,!0);else if(oe.child!==null){oe.child.return=oe,oe=oe.child;continue}}if(oe===F)break;for(;oe.sibling===null;){if(oe.return===null||oe.return===F)return;oe=oe.return}oe.sibling.return=oe.return,oe=oe.sibling}};var wt=function(_,F,R,ne){for(var oe=F.child;oe!==null;){if(oe.tag===5){var ge=oe.stateNode;R&&ne&&(ge=sn(ge,oe.type,oe.memoizedProps,oe)),Xt(_,ge)}else if(oe.tag===6)ge=oe.stateNode,R&&ne&&(ge=vt(ge,oe.memoizedProps,oe)),Xt(_,ge);else if(oe.tag!==4){if(oe.tag===22&&oe.memoizedState!==null)ge=oe.child,ge!==null&&(ge.return=oe),wt(_,oe,!0,!0);else if(oe.child!==null){oe.child.return=oe,oe=oe.child;continue}}if(oe===F)break;for(;oe.sibling===null;){if(oe.return===null||oe.return===F)return;oe=oe.return}oe.sibling.return=oe.return,oe=oe.sibling}};Ne=function(_,F){var R=F.stateNode;if(!Fe(_,F)){_=R.containerInfo;var ne=ft(_);wt(ne,F,!1,!1),R.pendingChildren=ne,Te(F),Yt(_,ne)}},We=function(_,F,R,ne,oe){var ge=_.stateNode,$e=_.memoizedProps;if((_=Fe(_,F))&&$e===ne)F.stateNode=ge;else{var Dt=F.stateNode,hn=$a(Ca.current),oi=null;$e!==ne&&(oi=V(Dt,R,$e,ne,oe,hn)),_&&oi===null?F.stateNode=ge:(ge=At(ge,oi,R,$e,ne,F,_,Dt),K(ge,R,ne,oe,hn)&&Te(F),F.stateNode=ge,_?Te(F):Ie(ge,F,!1,!1))}},tt=function(_,F,R,ne){R!==ne?(_=$a(tc.current),R=$a(Ca.current),F.stateNode=X(ne,_,R,F),Te(F)):F.stateNode=_.stateNode}}else Ne=function(){},We=function(){},tt=function(){};function $t(_,F){if(!ni)switch(_.tailMode){case"hidden":F=_.tail;for(var R=null;F!==null;)F.alternate!==null&&(R=F),F=F.sibling;R===null?_.tail=null:R.sibling=null;break;case"collapsed":R=_.tail;for(var ne=null;R!==null;)R.alternate!==null&&(ne=R),R=R.sibling;ne===null?F||_.tail===null?_.tail=null:_.tail.sibling=null:ne.sibling=null}}function Xe(_){var F=_.alternate!==null&&_.alternate.child===_.child,R=0,ne=0;if(F)for(var oe=_.child;oe!==null;)R|=oe.lanes|oe.childLanes,ne|=oe.subtreeFlags&14680064,ne|=oe.flags&14680064,oe.return=_,oe=oe.sibling;else for(oe=_.child;oe!==null;)R|=oe.lanes|oe.childLanes,ne|=oe.subtreeFlags,ne|=oe.flags,oe.return=_,oe=oe.sibling;return _.subtreeFlags|=ne,_.childLanes=R,F}function Et(_,F,R){var ne=F.pendingProps;switch(Tn(F),F.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xe(F),null;case 1:return ei(F.type)&&xi(),Xe(F),null;case 3:return R=F.stateNode,Kc(),zt(pn),zt(Qn),vo(),R.pendingContext&&(R.context=R.pendingContext,R.pendingContext=null),(_===null||_.child===null)&&(Qr(F)?Te(F):_===null||_.memoizedState.isDehydrated&&(F.flags&256)===0||(F.flags|=1024,sr!==null&&(M0(sr),sr=null))),Ne(_,F),Xe(F),null;case 5:nc(F),R=$a(tc.current);var oe=F.type;if(_!==null&&F.stateNode!=null)We(_,F,oe,ne,R),_.ref!==F.ref&&(F.flags|=512,F.flags|=2097152);else{if(!ne){if(F.stateNode===null)throw Error(o(166));return Xe(F),null}if(_=$a(Ca.current),Qr(F)){if(!fe)throw Error(o(175));_=Zn(F.stateNode,F.type,F.memoizedProps,R,_,F,!Rn),F.updateQueue=_,_!==null&&Te(F)}else{var ge=U(oe,ne,R,_,F);Ie(ge,F,!1,!1),F.stateNode=ge,K(ge,oe,ne,R,_)&&Te(F)}F.ref!==null&&(F.flags|=512,F.flags|=2097152)}return Xe(F),null;case 6:if(_&&F.stateNode!=null)tt(_,F,_.memoizedProps,ne);else{if(typeof ne!="string"&&F.stateNode===null)throw Error(o(166));if(_=$a(tc.current),R=$a(Ca.current),Qr(F)){if(!fe)throw Error(o(176));if(_=F.stateNode,R=F.memoizedProps,(ne=Hn(_,R,F,!Rn))&&(oe=$n,oe!==null))switch(oe.tag){case 3:Tr(oe.stateNode.containerInfo,_,R,(oe.mode&1)!==0);break;case 5:xr(oe.type,oe.memoizedProps,oe.stateNode,_,R,(oe.mode&1)!==0)}ne&&Te(F)}else F.stateNode=X(ne,_,R,F)}return Xe(F),null;case 13:if(zt(Ar),ne=F.memoizedState,_===null||_.memoizedState!==null&&_.memoizedState.dehydrated!==null){if(ni&&ai!==null&&(F.mode&1)!==0&&(F.flags&128)===0)or(),hs(),F.flags|=98560,oe=!1;else if(oe=Qr(F),ne!==null&&ne.dehydrated!==null){if(_===null){if(!oe)throw Error(o(318));if(!fe)throw Error(o(344));if(oe=F.memoizedState,oe=oe!==null?oe.dehydrated:null,!oe)throw Error(o(317));ti(oe,F)}else hs(),(F.flags&128)===0&&(F.memoizedState=null),F.flags|=4;Xe(F),oe=!1}else sr!==null&&(M0(sr),sr=null),oe=!0;if(!oe)return F.flags&65536?F:null}return(F.flags&128)!==0?(F.lanes=R,F):(R=ne!==null,R!==(_!==null&&_.memoizedState!==null)&&R&&(F.child.flags|=8192,(F.mode&1)!==0&&(_===null||(Ar.current&1)!==0?qo===0&&(qo=3):uu())),F.updateQueue!==null&&(F.flags|=4),Xe(F),null);case 4:return Kc(),Ne(_,F),_===null&&Z(F.stateNode.containerInfo),Xe(F),null;case 10:return Bs(F.type._context),Xe(F),null;case 17:return ei(F.type)&&xi(),Xe(F),null;case 19:if(zt(Ar),oe=F.memoizedState,oe===null)return Xe(F),null;if(ne=(F.flags&128)!==0,ge=oe.rendering,ge===null)if(ne)$t(oe,!1);else{if(qo!==0||_!==null&&(_.flags&128)!==0)for(_=F.child;_!==null;){if(ge=Os(_),ge!==null){for(F.flags|=128,$t(oe,!1),_=ge.updateQueue,_!==null&&(F.updateQueue=_,F.flags|=4),F.subtreeFlags=0,_=R,R=F.child;R!==null;)ne=R,oe=_,ne.flags&=14680066,ge=ne.alternate,ge===null?(ne.childLanes=0,ne.lanes=oe,ne.child=null,ne.subtreeFlags=0,ne.memoizedProps=null,ne.memoizedState=null,ne.updateQueue=null,ne.dependencies=null,ne.stateNode=null):(ne.childLanes=ge.childLanes,ne.lanes=ge.lanes,ne.child=ge.child,ne.subtreeFlags=0,ne.deletions=null,ne.memoizedProps=ge.memoizedProps,ne.memoizedState=ge.memoizedState,ne.updateQueue=ge.updateQueue,ne.type=ge.type,oe=ge.dependencies,ne.dependencies=oe===null?null:{lanes:oe.lanes,firstContext:oe.firstContext}),R=R.sibling;return gn(Ar,Ar.current&1|2),F.child}_=_.sibling}oe.tail!==null&&dt()>P0&&(F.flags|=128,ne=!0,$t(oe,!1),F.lanes=4194304)}else{if(!ne)if(_=Os(ge),_!==null){if(F.flags|=128,ne=!0,_=_.updateQueue,_!==null&&(F.updateQueue=_,F.flags|=4),$t(oe,!0),oe.tail===null&&oe.tailMode==="hidden"&&!ge.alternate&&!ni)return Xe(F),null}else 2*dt()-oe.renderingStartTime>P0&&R!==1073741824&&(F.flags|=128,ne=!0,$t(oe,!1),F.lanes=4194304);oe.isBackwards?(ge.sibling=F.child,F.child=ge):(_=oe.last,_!==null?_.sibling=ge:F.child=ge,oe.last=ge)}return oe.tail!==null?(F=oe.tail,oe.rendering=F,oe.tail=F.sibling,oe.renderingStartTime=dt(),F.sibling=null,_=Ar.current,gn(Ar,ne?_&1|2:_&1),F):(Xe(F),null);case 22:case 23:return ug(),R=F.memoizedState!==null,_!==null&&_.memoizedState!==null!==R&&(F.flags|=8192),R&&(F.mode&1)!==0?(cc&1073741824)!==0&&(Xe(F),Ce&&F.subtreeFlags&6&&(F.flags|=8192)):Xe(F),null;case 24:return null;case 25:return null}throw Error(o(156,F.tag))}function Ht(_,F){switch(Tn(F),F.tag){case 1:return ei(F.type)&&xi(),_=F.flags,_&65536?(F.flags=_&-65537|128,F):null;case 3:return Kc(),zt(pn),zt(Qn),vo(),_=F.flags,(_&65536)!==0&&(_&128)===0?(F.flags=_&-65537|128,F):null;case 5:return nc(F),null;case 13:if(zt(Ar),_=F.memoizedState,_!==null&&_.dehydrated!==null){if(F.alternate===null)throw Error(o(340));hs()}return _=F.flags,_&65536?(F.flags=_&-65537|128,F):null;case 19:return zt(Ar),null;case 4:return Kc(),null;case 10:return Bs(F.type._context),null;case 22:case 23:return ug(),null;case 24:return null;default:return null}}var mn=!1,Lt=!1,bn=typeof WeakSet=="function"?WeakSet:Set,Ft=null;function zn(_,F){var R=_.ref;if(R!==null)if(typeof R=="function")try{R(null)}catch(ne){sa(_,F,ne)}else R.current=null}function Nn(_,F,R){try{R()}catch(ne){sa(_,F,ne)}}var tr=!1;function Oi(_,F){for(J(_.containerInfo),Ft=F;Ft!==null;)if(_=Ft,F=_.child,(_.subtreeFlags&1028)!==0&&F!==null)F.return=_,Ft=F;else for(;Ft!==null;){_=Ft;try{var R=_.alternate;if((_.flags&1024)!==0)switch(_.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var ne=R.memoizedProps,oe=R.memoizedState,ge=_.stateNode,$e=ge.getSnapshotBeforeUpdate(_.elementType===_.type?ne:rc(_.type,ne),oe);ge.__reactInternalSnapshotBeforeUpdate=$e}break;case 3:Ce&&st(_.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(Dt){sa(_,_.return,Dt)}if(F=_.sibling,F!==null){F.return=_.return,Ft=F;break}Ft=_.return}return R=tr,tr=!1,R}function Pr(_,F,R){var ne=F.updateQueue;if(ne=ne!==null?ne.lastEffect:null,ne!==null){var oe=ne=ne.next;do{if((oe.tag&_)===_){var ge=oe.destroy;oe.destroy=void 0,ge!==void 0&&Nn(F,R,ge)}oe=oe.next}while(oe!==ne)}}function Hi(_,F){if(F=F.updateQueue,F=F!==null?F.lastEffect:null,F!==null){var R=F=F.next;do{if((R.tag&_)===_){var ne=R.create;R.destroy=ne()}R=R.next}while(R!==F)}}function fs(_){var F=_.ref;if(F!==null){var R=_.stateNode;switch(_.tag){case 5:_=te(R);break;default:_=R}typeof F=="function"?F(_):F.current=_}}function Ta(_){var F=_.alternate;F!==null&&(_.alternate=null,Ta(F)),_.child=null,_.deletions=null,_.sibling=null,_.tag===5&&(F=_.stateNode,F!==null&&ie(F)),_.stateNode=null,_.return=null,_.dependencies=null,_.memoizedProps=null,_.memoizedState=null,_.pendingProps=null,_.stateNode=null,_.updateQueue=null}function Vr(_){return _.tag===5||_.tag===3||_.tag===4}function $i(_){e:for(;;){for(;_.sibling===null;){if(_.return===null||Vr(_.return))return null;_=_.return}for(_.sibling.return=_.return,_=_.sibling;_.tag!==5&&_.tag!==6&&_.tag!==18;){if(_.flags&2||_.child===null||_.tag===4)continue e;_.child.return=_,_=_.child}if(!(_.flags&2))return _.stateNode}}function di(_,F,R){var ne=_.tag;if(ne===5||ne===6)_=_.stateNode,F?je(R,_,F):et(R,_);else if(ne!==4&&(_=_.child,_!==null))for(di(_,F,R),_=_.sibling;_!==null;)di(_,F,R),_=_.sibling}function Xo(_,F,R){var ne=_.tag;if(ne===5||ne===6)_=_.stateNode,F?ke(R,_,F):Me(R,_);else if(ne!==4&&(_=_.child,_!==null))for(Xo(_,F,R),_=_.sibling;_!==null;)Xo(_,F,R),_=_.sibling}var nr=null,Mr=!1;function Es(_,F,R){for(R=R.child;R!==null;)Ka(_,F,R),R=R.sibling}function Ka(_,F,R){if(ht&&typeof ht.onCommitFiberUnmount=="function")try{ht.onCommitFiberUnmount(Yn,R)}catch{}switch(R.tag){case 5:Lt||zn(R,F);case 6:if(Ce){var ne=nr,oe=Mr;nr=null,Es(_,F,R),nr=ne,Mr=oe,nr!==null&&(Mr?_t(nr,R.stateNode):rt(nr,R.stateNode))}else Es(_,F,R);break;case 18:Ce&&nr!==null&&(Mr?si(nr,R.stateNode):ui(nr,R.stateNode));break;case 4:Ce?(ne=nr,oe=Mr,nr=R.stateNode.containerInfo,Mr=!0,Es(_,F,R),nr=ne,Mr=oe):(Se&&(ne=R.stateNode.containerInfo,oe=ft(ne),Zt(ne,oe)),Es(_,F,R));break;case 0:case 11:case 14:case 15:if(!Lt&&(ne=R.updateQueue,ne!==null&&(ne=ne.lastEffect,ne!==null))){oe=ne=ne.next;do{var ge=oe,$e=ge.destroy;ge=ge.tag,$e!==void 0&&((ge&2)!==0||(ge&4)!==0)&&Nn(R,F,$e),oe=oe.next}while(oe!==ne)}Es(_,F,R);break;case 1:if(!Lt&&(zn(R,F),ne=R.stateNode,typeof ne.componentWillUnmount=="function"))try{ne.props=R.memoizedProps,ne.state=R.memoizedState,ne.componentWillUnmount()}catch(Dt){sa(R,F,Dt)}Es(_,F,R);break;case 21:Es(_,F,R);break;case 22:R.mode&1?(Lt=(ne=Lt)||R.memoizedState!==null,Es(_,F,R),Lt=ne):Es(_,F,R);break;default:Es(_,F,R)}}function Ul(_){var F=_.updateQueue;if(F!==null){_.updateQueue=null;var R=_.stateNode;R===null&&(R=_.stateNode=new bn),F.forEach(function(ne){var oe=xq.bind(null,_,ne);R.has(ne)||(R.add(ne),ne.then(oe,oe))})}}function Hs(_,F){var R=F.deletions;if(R!==null)for(var ne=0;ne<R.length;ne++){var oe=R[ne];try{var ge=_,$e=F;if(Ce){var Dt=$e;e:for(;Dt!==null;){switch(Dt.tag){case 5:nr=Dt.stateNode,Mr=!1;break e;case 3:nr=Dt.stateNode.containerInfo,Mr=!0;break e;case 4:nr=Dt.stateNode.containerInfo,Mr=!0;break e}Dt=Dt.return}if(nr===null)throw Error(o(160));Ka(ge,$e,oe),nr=null,Mr=!1}else Ka(ge,$e,oe);var hn=oe.alternate;hn!==null&&(hn.return=null),oe.return=null}catch(oi){sa(oe,F,oi)}}if(F.subtreeFlags&12854)for(F=F.child;F!==null;)Bl(F,_),F=F.sibling}function Bl(_,F){var R=_.alternate,ne=_.flags;switch(_.tag){case 0:case 11:case 14:case 15:if(Hs(F,_),Ho(_),ne&4){try{Pr(3,_,_.return),Hi(3,_)}catch(Ei){sa(_,_.return,Ei)}try{Pr(5,_,_.return)}catch(Ei){sa(_,_.return,Ei)}}break;case 1:Hs(F,_),Ho(_),ne&512&&R!==null&&zn(R,R.return);break;case 5:if(Hs(F,_),Ho(_),ne&512&&R!==null&&zn(R,R.return),Ce){if(_.flags&32){var oe=_.stateNode;try{Ee(oe)}catch(Ei){sa(_,_.return,Ei)}}if(ne&4&&(oe=_.stateNode,oe!=null)){var ge=_.memoizedProps;if(R=R!==null?R.memoizedProps:ge,ne=_.type,F=_.updateQueue,_.updateQueue=null,F!==null)try{Oe(oe,F,ne,R,ge,_)}catch(Ei){sa(_,_.return,Ei)}}}break;case 6:if(Hs(F,_),Ho(_),ne&4&&Ce){if(_.stateNode===null)throw Error(o(162));oe=_.stateNode,ge=_.memoizedProps,R=R!==null?R.memoizedProps:ge;try{He(oe,R,ge)}catch(Ei){sa(_,_.return,Ei)}}break;case 3:if(Hs(F,_),Ho(_),ne&4){if(Ce&&fe&&R!==null&&R.memoizedState.isDehydrated)try{bi(F.containerInfo)}catch(Ei){sa(_,_.return,Ei)}if(Se){oe=F.containerInfo,ge=F.pendingChildren;try{Zt(oe,ge)}catch(Ei){sa(_,_.return,Ei)}}}break;case 4:if(Hs(F,_),Ho(_),ne&4&&Se){ge=_.stateNode,oe=ge.containerInfo,ge=ge.pendingChildren;try{Zt(oe,ge)}catch(Ei){sa(_,_.return,Ei)}}break;case 13:Hs(F,_),Ho(_),oe=_.child,oe.flags&8192&&(ge=oe.memoizedState!==null,oe.stateNode.isHidden=ge,!ge||oe.alternate!==null&&oe.alternate.memoizedState!==null||(K1=dt())),ne&4&&Ul(_);break;case 22:var $e=R!==null&&R.memoizedState!==null;if(_.mode&1?(Lt=(R=Lt)||$e,Hs(F,_),Lt=R):Hs(F,_),Ho(_),ne&8192){if(R=_.memoizedState!==null,(_.stateNode.isHidden=R)&&!$e&&(_.mode&1)!==0)for(Ft=_,ne=_.child;ne!==null;){for(F=Ft=ne;Ft!==null;){$e=Ft;var Dt=$e.child;switch($e.tag){case 0:case 11:case 14:case 15:Pr(4,$e,$e.return);break;case 1:zn($e,$e.return);var hn=$e.stateNode;if(typeof hn.componentWillUnmount=="function"){var oi=$e,Vi=$e.return;try{var Jr=oi;hn.props=Jr.memoizedProps,hn.state=Jr.memoizedState,hn.componentWillUnmount()}catch(Ei){sa(oi,Vi,Ei)}}break;case 5:zn($e,$e.return);break;case 22:if($e.memoizedState!==null){Yo(F);continue}}Dt!==null?(Dt.return=$e,Ft=Dt):Yo(F)}ne=ne.sibling}if(Ce){e:if(ne=null,Ce)for(F=_;;){if(F.tag===5){if(ne===null){ne=F;try{oe=F.stateNode,R?Le(oe):Ze(F.stateNode,F.memoizedProps)}catch(Ei){sa(_,_.return,Ei)}}}else if(F.tag===6){if(ne===null)try{ge=F.stateNode,R?ye(ge):nt(ge,F.memoizedProps)}catch(Ei){sa(_,_.return,Ei)}}else if((F.tag!==22&&F.tag!==23||F.memoizedState===null||F===_)&&F.child!==null){F.child.return=F,F=F.child;continue}if(F===_)break e;for(;F.sibling===null;){if(F.return===null||F.return===_)break e;ne===F&&(ne=null),F=F.return}ne===F&&(ne=null),F.sibling.return=F.return,F=F.sibling}}}break;case 19:Hs(F,_),Ho(_),ne&4&&Ul(_);break;case 21:break;default:Hs(F,_),Ho(_)}}function Ho(_){var F=_.flags;if(F&2){try{if(Ce){e:{for(var R=_.return;R!==null;){if(Vr(R)){var ne=R;break e}R=R.return}throw Error(o(160))}switch(ne.tag){case 5:var oe=ne.stateNode;ne.flags&32&&(Ee(oe),ne.flags&=-33);var ge=$i(_);Xo(_,ge,oe);break;case 3:case 4:var $e=ne.stateNode.containerInfo,Dt=$i(_);di(_,Dt,$e);break;default:throw Error(o(161))}}}catch(hn){sa(_,_.return,hn)}_.flags&=-3}F&4096&&(_.flags&=-4097)}function qa(_,F,R){Ft=_,Fs(_)}function Fs(_,F,R){for(var ne=(_.mode&1)!==0;Ft!==null;){var oe=Ft,ge=oe.child;if(oe.tag===22&&ne){var $e=oe.memoizedState!==null||mn;if(!$e){var Dt=oe.alternate,hn=Dt!==null&&Dt.memoizedState!==null||Lt;Dt=mn;var oi=Lt;if(mn=$e,(Lt=hn)&&!oi)for(Ft=oe;Ft!==null;)$e=Ft,hn=$e.child,$e.tag===22&&$e.memoizedState!==null?Js(oe):hn!==null?(hn.return=$e,Ft=hn):Js(oe);for(;ge!==null;)Ft=ge,Fs(ge),ge=ge.sibling;Ft=oe,mn=Dt,Lt=oi}Zs(_)}else(oe.subtreeFlags&8772)!==0&&ge!==null?(ge.return=oe,Ft=ge):Zs(_)}}function Zs(_){for(;Ft!==null;){var F=Ft;if((F.flags&8772)!==0){var R=F.alternate;try{if((F.flags&8772)!==0)switch(F.tag){case 0:case 11:case 15:Lt||Hi(5,F);break;case 1:var ne=F.stateNode;if(F.flags&4&&!Lt)if(R===null)ne.componentDidMount();else{var oe=F.elementType===F.type?R.memoizedProps:rc(F.type,R.memoizedProps);ne.componentDidUpdate(oe,R.memoizedState,ne.__reactInternalSnapshotBeforeUpdate)}var ge=F.updateQueue;ge!==null&&su(F,ge,ne);break;case 3:var $e=F.updateQueue;if($e!==null){if(R=null,F.child!==null)switch(F.child.tag){case 5:R=te(F.child.stateNode);break;case 1:R=F.child.stateNode}su(F,$e,R)}break;case 5:var Dt=F.stateNode;R===null&&F.flags&4&&ze(Dt,F.type,F.memoizedProps,F);break;case 6:break;case 4:break;case 12:break;case 13:if(fe&&F.memoizedState===null){var hn=F.alternate;if(hn!==null){var oi=hn.memoizedState;if(oi!==null){var Vi=oi.dehydrated;Vi!==null&&Ni(Vi)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(o(163))}Lt||F.flags&512&&fs(F)}catch(Jr){sa(F,F.return,Jr)}}if(F===_){Ft=null;break}if(R=F.sibling,R!==null){R.return=F.return,Ft=R;break}Ft=F.return}}function Yo(_){for(;Ft!==null;){var F=Ft;if(F===_){Ft=null;break}var R=F.sibling;if(R!==null){R.return=F.return,Ft=R;break}Ft=F.return}}function Js(_){for(;Ft!==null;){var F=Ft;try{switch(F.tag){case 0:case 11:case 15:var R=F.return;try{Hi(4,F)}catch(hn){sa(F,R,hn)}break;case 1:var ne=F.stateNode;if(typeof ne.componentDidMount=="function"){var oe=F.return;try{ne.componentDidMount()}catch(hn){sa(F,oe,hn)}}var ge=F.return;try{fs(F)}catch(hn){sa(F,ge,hn)}break;case 5:var $e=F.return;try{fs(F)}catch(hn){sa(F,$e,hn)}}}catch(hn){sa(F,F.return,hn)}if(F===_){Ft=null;break}var Dt=F.sibling;if(Dt!==null){Dt.return=F.return,Ft=Dt;break}Ft=F.return}}var Ba=0,Ec=1,Wo=2,El=3,eo=4;if(typeof Symbol=="function"&&Symbol.for){var Ko=Symbol.for;Ba=Ko("selector.component"),Ec=Ko("selector.has_pseudo_class"),Wo=Ko("selector.role"),El=Ko("selector.test_id"),eo=Ko("selector.text")}function oc(_){var F=M(_);if(F!=null){if(typeof F.memoizedProps["data-testname"]!="string")throw Error(o(364));return F}if(_=_e(_),_===null)throw Error(o(362));return _.stateNode.current}function Fl(_,F){switch(F.$$typeof){case Ba:if(_.type===F.value)return!0;break;case Ec:e:{F=F.value,_=[_,0];for(var R=0;R<_.length;){var ne=_[R++],oe=_[R++],ge=F[oe];if(ne.tag!==5||!it(ne)){for(;ge!=null&&Fl(ne,ge);)oe++,ge=F[oe];if(oe===F.length){F=!0;break e}else for(ne=ne.child;ne!==null;)_.push(ne,oe),ne=ne.sibling}}F=!1}return F;case Wo:if(_.tag===5&&De(_.stateNode,F.value))return!0;break;case eo:if((_.tag===5||_.tag===6)&&(_=Be(_),_!==null&&0<=_.indexOf(F.value)))return!0;break;case El:if(_.tag===5&&(_=_.memoizedProps["data-testname"],typeof _=="string"&&_.toLowerCase()===F.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function ac(_){switch(_.$$typeof){case Ba:return"<"+(j(_.value)||"Unknown")+">";case Ec:return":has("+(ac(_)||"")+")";case Wo:return'[role="'+_.value+'"]';case eo:return'"'+_.value+'"';case El:return'[data-testname="'+_.value+'"]';default:throw Error(o(365))}}function Fc(_,F){var R=[];_=[_,0];for(var ne=0;ne<_.length;){var oe=_[ne++],ge=_[ne++],$e=F[ge];if(oe.tag!==5||!it(oe)){for(;$e!=null&&Fl(oe,$e);)ge++,$e=F[ge];if(ge===F.length)R.push(oe);else for(oe=oe.child;oe!==null;)_.push(oe,ge),oe=oe.sibling}}return R}function Ol(_,F){if(!me)throw Error(o(363));_=oc(_),_=Fc(_,F),F=[],_=Array.from(_);for(var R=0;R<_.length;){var ne=_[R++];if(ne.tag===5)it(ne)||F.push(ne.stateNode);else for(ne=ne.child;ne!==null;)_.push(ne),ne=ne.sibling}return F}var Zc=Math.ceil,so=a.ReactCurrentDispatcher,lc=a.ReactCurrentOwner,Gs=a.ReactCurrentBatchConfig,Rr=0,bo=null,ms=null,Ea=0,cc=0,Gu=nn(0),qo=0,lg=null,DA=0,Mf=0,au=0,cg=null,kc=null,K1=0,P0=1/0,wh=null;function jA(){P0=dt()+500}var hg=!1,Rf=null,lu=null,Ud=!1,Xu=null,N0=0,Od=0,L0=null,Uf=-1,Oh=0;function kl(){return(Rr&6)!==0?dt():Uf!==-1?Uf:Uf=dt()}function Yu(_){return(_.mode&1)===0?1:(Rr&2)!==0&&Ea!==0?Ea&-Ea:Oo.transition!==null?(Oh===0&&(Oh=Ts()),Oh):(_=Ge,_!==0?_:Ae())}function vh(_,F,R,ne){if(50<Od)throw Od=0,L0=null,Error(o(185));ve(_,R,ne),((Rr&2)===0||_!==bo)&&(_===bo&&((Rr&2)===0&&(Mf|=R),qo===4&&Ku(_,Ea)),hc(_,ne),R===1&&Rr===0&&(F.mode&1)===0&&(jA(),Gn&&Ci()))}function hc(_,F){var R=_.callbackNode;io(_,F);var ne=zr(_,_===bo?Ea:0);if(ne===0)R!==null&&pe(R),_.callbackNode=null,_.callbackPriority=0;else if(F=ne&-ne,_.callbackPriority!==F){if(R!=null&&pe(R),F===1)_.tag===0?Ji($v.bind(null,_)):Ki($v.bind(null,_)),ee?ae(function(){(Rr&6)===0&&Ci()}):Pt(Qt,Ci),R=null;else{switch(pt(ne)){case 1:R=Qt;break;case 4:R=wn;break;case 16:R=gt;break;case 536870912:R=Vn;break;default:R=gt}R=EI(R,PA.bind(null,_))}_.callbackPriority=F,_.callbackNode=R}}function PA(_,F){if(Uf=-1,Oh=0,(Rr&6)!==0)throw Error(o(327));var R=_.callbackNode;if(dg()&&_.callbackNode!==R)return null;var ne=zr(_,_===bo?Ea:0);if(ne===0)return null;if((ne&30)!==0||(ne&_.expiredLanes)!==0||F)F=NA(_,ne);else{F=ne;var oe=Rr;Rr|=2;var ge=qu();(bo!==_||Ea!==F)&&(wh=null,jA(),cu(_,F));do try{Vv();break}catch(Dt){hu(_,Dt)}while(!0);$r(),so.current=ge,Rr=oe,ms!==null?F=0:(bo=null,Ea=0,F=qo)}if(F!==0){if(F===2&&(oe=ws(_),oe!==0&&(ne=oe,F=q1(_,oe))),F===1)throw R=lg,cu(_,0),Ku(_,ne),hc(_,dt()),R;if(F===6)Ku(_,ne);else{if(oe=_.current.alternate,(ne&30)===0&&!FS(oe)&&(F=NA(_,ne),F===2&&(ge=ws(_),ge!==0&&(ne=ge,F=q1(_,ge))),F===1))throw R=lg,cu(_,0),Ku(_,ne),hc(_,dt()),R;switch(_.finishedWork=oe,_.finishedLanes=ne,F){case 0:case 1:throw Error(o(345));case 2:Zu(_,kc,wh);break;case 3:if(Ku(_,ne),(ne&130023424)===ne&&(F=K1+500-dt(),10<F)){if(zr(_,0)!==0)break;if(oe=_.suspendedLanes,(oe&ne)!==ne){kl(),_.pingedLanes|=_.suspendedLanes&oe;break}_.timeoutHandle=W(Zu.bind(null,_,kc,wh),F);break}Zu(_,kc,wh);break;case 4:if(Ku(_,ne),(ne&4194240)===ne)break;for(F=_.eventTimes,oe=-1;0<ne;){var $e=31-Bt(ne);ge=1<<$e,$e=F[$e],$e>oe&&(oe=$e),ne&=~ge}if(ne=oe,ne=dt()-ne,ne=(120>ne?120:480>ne?480:1080>ne?1080:1920>ne?1920:3e3>ne?3e3:4320>ne?4320:1960*Zc(ne/1960))-ne,10<ne){_.timeoutHandle=W(Zu.bind(null,_,kc,wh),ne);break}Zu(_,kc,wh);break;case 5:Zu(_,kc,wh);break;default:throw Error(o(329))}}}return hc(_,dt()),_.callbackNode===R?PA.bind(null,_):null}function q1(_,F){var R=cg;return _.current.memoizedState.isDehydrated&&(cu(_,F).flags|=256),_=NA(_,F),_!==2&&(F=kc,kc=R,F!==null&&M0(F)),_}function M0(_){kc===null?kc=_:kc.push.apply(kc,_)}function FS(_){for(var F=_;;){if(F.flags&16384){var R=F.updateQueue;if(R!==null&&(R=R.stores,R!==null))for(var ne=0;ne<R.length;ne++){var oe=R[ne],ge=oe.getSnapshot;oe=oe.value;try{if(!Wn(ge(),oe))return!1}catch{return!1}}}if(R=F.child,F.subtreeFlags&16384&&R!==null)R.return=F,F=R;else{if(F===_)break;for(;F.sibling===null;){if(F.return===null||F.return===_)return!0;F=F.return}F.sibling.return=F.return,F=F.sibling}}return!0}function Ku(_,F){for(F&=~au,F&=~Mf,_.suspendedLanes|=F,_.pingedLanes&=~F,_=_.expirationTimes;0<F;){var R=31-Bt(F),ne=1<<R;_[R]=-1,F&=~ne}}function $v(_){if((Rr&6)!==0)throw Error(o(327));dg();var F=zr(_,0);if((F&1)===0)return hc(_,dt()),null;var R=NA(_,F);if(_.tag!==0&&R===2){var ne=ws(_);ne!==0&&(F=ne,R=q1(_,ne))}if(R===1)throw R=lg,cu(_,0),Ku(_,F),hc(_,dt()),R;if(R===6)throw Error(o(345));return _.finishedWork=_.current.alternate,_.finishedLanes=F,Zu(_,kc,wh),hc(_,dt()),null}function Of(_){Xu!==null&&Xu.tag===0&&(Rr&6)===0&&dg();var F=Rr;Rr|=1;var R=Gs.transition,ne=Ge;try{if(Gs.transition=null,Ge=1,_)return _()}finally{Ge=ne,Gs.transition=R,Rr=F,(Rr&6)===0&&Ci()}}function ug(){cc=Gu.current,zt(Gu)}function cu(_,F){_.finishedWork=null,_.finishedLanes=0;var R=_.timeoutHandle;if(R!==q&&(_.timeoutHandle=q,se(R)),ms!==null)for(R=ms.return;R!==null;){var ne=R;switch(Tn(ne),ne.tag){case 1:ne=ne.type.childContextTypes,ne!=null&&xi();break;case 3:Kc(),zt(pn),zt(Qn),vo();break;case 5:nc(ne);break;case 4:Kc();break;case 13:zt(Ar);break;case 19:zt(Ar);break;case 10:Bs(ne.type._context);break;case 22:case 23:ug()}R=R.return}if(bo=_,ms=_=Hf(_.current,null),Ea=cc=F,qo=0,lg=null,au=Mf=DA=0,kc=cg=null,Ha!==null){for(F=0;F<Ha.length;F++)if(R=Ha[F],ne=R.interleaved,ne!==null){R.interleaved=null;var oe=ne.next,ge=R.pending;if(ge!==null){var $e=ge.next;ge.next=oe,ne.next=$e}R.pending=ne}Ha=null}return _}function hu(_,F){do{var R=ms;try{if($r(),ic.current=qs,Ld){for(var ne=Ks.memoizedState;ne!==null;){var oe=ne.queue;oe!==null&&(oe.pending=null),ne=ne.next}Ld=!1}if(Va=0,ra=Vo=Ks=null,Wu=!1,zu=0,lc.current=null,R===null||R.return===null){qo=1,lg=F,ms=null;break}e:{var ge=_,$e=R.return,Dt=R,hn=F;if(F=Ea,Dt.flags|=32768,hn!==null&&typeof hn=="object"&&typeof hn.then=="function"){var oi=hn,Vi=Dt,Jr=Vi.tag;if((Vi.mode&1)===0&&(Jr===0||Jr===11||Jr===15)){var Ei=Vi.alternate;Ei?(Vi.updateQueue=Ei.updateQueue,Vi.memoizedState=Ei.memoizedState,Vi.lanes=Ei.lanes):(Vi.updateQueue=null,Vi.memoizedState=null)}var Zo=Kt($e);if(Zo!==null){Zo.flags&=-257,Cn(Zo,$e,Dt,ge,F),Zo.mode&1&&I0(ge,oi,F),F=Zo,hn=oi;var Fo=F.updateQueue;if(Fo===null){var xh=new Set;xh.add(hn),F.updateQueue=xh}else Fo.add(hn);break e}else{if((F&1)===0){I0(ge,oi,F),uu();break e}hn=Error(o(426))}}else if(ni&&Dt.mode&1){var LA=Kt($e);if(LA!==null){(LA.flags&65536)===0&&(LA.flags|=256),Cn(LA,$e,Dt,ge,F),us(da(hn,Dt));break e}}ge=hn=da(hn,Dt),qo!==4&&(qo=2),cg===null?cg=[ge]:cg.push(ge),ge=$e;do{switch(ge.tag){case 3:ge.flags|=65536,F&=-F,ge.lanes|=F;var rn=Aa(ge,hn,F);Cc(ge,rn);break e;case 1:Dt=hn;var Mt=ge.type,yn=ge.stateNode;if((ge.flags&128)===0&&(typeof Mt.getDerivedStateFromError=="function"||yn!==null&&typeof yn.componentDidCatch=="function"&&(lu===null||!lu.has(yn)))){ge.flags|=65536,F&=-F,ge.lanes|=F;var Fi=Zr(ge,Dt,F);Cc(ge,Fi);break e}}ge=ge.return}while(ge!==null)}R0(R)}catch(yr){F=yr,ms===R&&R!==null&&(ms=R=R.return);continue}break}while(!0)}function qu(){var _=so.current;return so.current=qs,_===null?qs:_}function uu(){(qo===0||qo===3||qo===2)&&(qo=4),bo===null||(DA&268435455)===0&&(Mf&268435455)===0||Ku(bo,Ea)}function NA(_,F){var R=Rr;Rr|=2;var ne=qu();(bo!==_||Ea!==F)&&(wh=null,cu(_,F));do try{Z1();break}catch(oe){hu(_,oe)}while(!0);if($r(),Rr=R,so.current=ne,ms!==null)throw Error(o(261));return bo=null,Ea=0,qo}function Z1(){for(;ms!==null;)Gv(ms)}function Vv(){for(;ms!==null&&!xe();)Gv(ms)}function Gv(_){var F=BI(_.alternate,_,cc);_.memoizedProps=_.pendingProps,F===null?R0(_):ms=F,lc.current=null}function R0(_){var F=_;do{var R=F.alternate;if(_=F.return,(F.flags&32768)===0){if(R=Et(R,F,cc),R!==null){ms=R;return}}else{if(R=Ht(R,F),R!==null){R.flags&=32767,ms=R;return}if(_!==null)_.flags|=32768,_.subtreeFlags=0,_.deletions=null;else{qo=6,ms=null;return}}if(F=F.sibling,F!==null){ms=F;return}ms=F=_}while(F!==null);qo===0&&(qo=5)}function Zu(_,F,R){var ne=Ge,oe=Gs.transition;try{Gs.transition=null,Ge=1,yq(_,F,R,ne)}finally{Gs.transition=oe,Ge=ne}return null}function yq(_,F,R,ne){do dg();while(Xu!==null);if((Rr&6)!==0)throw Error(o(327));R=_.finishedWork;var oe=_.finishedLanes;if(R===null)return null;if(_.finishedWork=null,_.finishedLanes=0,R===_.current)throw Error(o(177));_.callbackNode=null,_.callbackPriority=0;var ge=R.lanes|R.childLanes;if(Re(_,ge),_===bo&&(ms=bo=null,Ea=0),(R.subtreeFlags&2064)===0&&(R.flags&2064)===0||Ud||(Ud=!0,EI(gt,function(){return dg(),null})),ge=(R.flags&15990)!==0,(R.subtreeFlags&15990)!==0||ge){ge=Gs.transition,Gs.transition=null;var $e=Ge;Ge=1;var Dt=Rr;Rr|=4,lc.current=null,Oi(_,R),Bl(R,_),$(_.containerInfo),_.current=R,qa(R),at(),Rr=Dt,Ge=$e,Gs.transition=ge}else _.current=R;if(Ud&&(Ud=!1,Xu=_,N0=oe),ge=_.pendingLanes,ge===0&&(lu=null),Ot(R.stateNode),hc(_,dt()),F!==null)for(ne=_.onRecoverableError,R=0;R<F.length;R++)oe=F[R],ne(oe.value,{componentStack:oe.stack,digest:oe.digest});if(hg)throw hg=!1,_=Rf,Rf=null,_;return(N0&1)!==0&&_.tag!==0&&dg(),ge=_.pendingLanes,(ge&1)!==0?_===L0?Od++:(Od=0,L0=_):Od=0,Ci(),null}function dg(){if(Xu!==null){var _=pt(N0),F=Gs.transition,R=Ge;try{if(Gs.transition=null,Ge=16>_?16:_,Xu===null)var ne=!1;else{if(_=Xu,Xu=null,N0=0,(Rr&6)!==0)throw Error(o(331));var oe=Rr;for(Rr|=4,Ft=_.current;Ft!==null;){var ge=Ft,$e=ge.child;if((Ft.flags&16)!==0){var Dt=ge.deletions;if(Dt!==null){for(var hn=0;hn<Dt.length;hn++){var oi=Dt[hn];for(Ft=oi;Ft!==null;){var Vi=Ft;switch(Vi.tag){case 0:case 11:case 15:Pr(8,Vi,ge)}var Jr=Vi.child;if(Jr!==null)Jr.return=Vi,Ft=Jr;else for(;Ft!==null;){Vi=Ft;var Ei=Vi.sibling,Zo=Vi.return;if(Ta(Vi),Vi===oi){Ft=null;break}if(Ei!==null){Ei.return=Zo,Ft=Ei;break}Ft=Zo}}}var Fo=ge.alternate;if(Fo!==null){var xh=Fo.child;if(xh!==null){Fo.child=null;do{var LA=xh.sibling;xh.sibling=null,xh=LA}while(xh!==null)}}Ft=ge}}if((ge.subtreeFlags&2064)!==0&&$e!==null)$e.return=ge,Ft=$e;else e:for(;Ft!==null;){if(ge=Ft,(ge.flags&2048)!==0)switch(ge.tag){case 0:case 11:case 15:Pr(9,ge,ge.return)}var rn=ge.sibling;if(rn!==null){rn.return=ge.return,Ft=rn;break e}Ft=ge.return}}var Mt=_.current;for(Ft=Mt;Ft!==null;){$e=Ft;var yn=$e.child;if(($e.subtreeFlags&2064)!==0&&yn!==null)yn.return=$e,Ft=yn;else e:for($e=Mt;Ft!==null;){if(Dt=Ft,(Dt.flags&2048)!==0)try{switch(Dt.tag){case 0:case 11:case 15:Hi(9,Dt)}}catch(yr){sa(Dt,Dt.return,yr)}if(Dt===$e){Ft=null;break e}var Fi=Dt.sibling;if(Fi!==null){Fi.return=Dt.return,Ft=Fi;break e}Ft=Dt.return}}if(Rr=oe,Ci(),ht&&typeof ht.onPostCommitFiberRoot=="function")try{ht.onPostCommitFiberRoot(Yn,_)}catch{}ne=!0}return ne}finally{Ge=R,Gs.transition=F}}return!1}function SI(_,F,R){F=da(R,F),F=Aa(_,F,1),_=Vs(_,F,1),F=kl(),_!==null&&(ve(_,1,F),hc(_,F))}function sa(_,F,R){if(_.tag===3)SI(_,_,R);else for(;F!==null;){if(F.tag===3){SI(F,_,R);break}else if(F.tag===1){var ne=F.stateNode;if(typeof F.type.getDerivedStateFromError=="function"||typeof ne.componentDidCatch=="function"&&(lu===null||!lu.has(ne))){_=da(R,_),_=Zr(F,_,1),F=Vs(F,_,1),_=kl(),F!==null&&(ve(F,1,_),hc(F,_));break}}F=F.return}}function wq(_,F,R){var ne=_.pingCache;ne!==null&&ne.delete(F),F=kl(),_.pingedLanes|=_.suspendedLanes&R,bo===_&&(Ea&R)===R&&(qo===4||qo===3&&(Ea&130023424)===Ea&&500>dt()-K1?cu(_,0):au|=R),hc(_,F)}function TI(_,F){F===0&&((_.mode&1)===0?F=1:(F=Ii,Ii<<=1,(Ii&130023424)===0&&(Ii=4194304)));var R=kl();_=za(_,F),_!==null&&(ve(_,F,R),hc(_,R))}function vq(_){var F=_.memoizedState,R=0;F!==null&&(R=F.retryLane),TI(_,R)}function xq(_,F){var R=0;switch(_.tag){case 13:var ne=_.stateNode,oe=_.memoizedState;oe!==null&&(R=oe.retryLane);break;case 19:ne=_.stateNode;break;default:throw Error(o(314))}ne!==null&&ne.delete(F),TI(_,R)}var BI;BI=function(_,F,R){if(_!==null)if(_.memoizedProps!==F.pendingProps||pn.current)ir=!0;else{if((_.lanes&R)===0&&(F.flags&128)===0)return ir=!1,he(_,F,R);ir=(_.flags&131072)!==0}else ir=!1,ni&&(F.flags&1048576)!==0&&en(F,Hr,F.index);switch(F.lanes=0,F.tag){case 2:var ne=F.type;G(_,F),_=F.pendingProps;var oe=Dn(F,Qn.current);Bo(F,R),oe=BA(null,F,ne,_,oe,R);var ge=EA();return F.flags|=1,typeof oe=="object"&&oe!==null&&typeof oe.render=="function"&&oe.$$typeof===void 0?(F.tag=1,F.memoizedState=null,F.updateQueue=null,ei(ne)?(ge=!0,Ri(F)):ge=!1,F.memoizedState=oe.state!==null&&oe.state!==void 0?oe.state:null,Xc(F),oe.updater=Uh,F.stateNode=oe,oe._reactInternals=F,yh(F,ne,_,R),F=G1(null,F,ne,!0,ge,R)):(F.tag=0,ni&&ge&&cn(F),Ui(null,F,oe,R),F=F.child),F;case 16:ne=F.elementType;e:{switch(G(_,F),_=F.pendingProps,oe=ne._init,ne=oe(ne._payload),F.type=ne,oe=F.tag=Cq(ne),_=rc(ne,_),oe){case 0:F=Vu(null,F,ne,_,R);break e;case 1:F=Lf(null,F,ne,_,R);break e;case 11:F=fo(null,F,ne,_,R);break e;case 14:F=Go(null,F,ne,rc(ne.type,_),R);break e}throw Error(o(306,ne,""))}return F;case 0:return ne=F.type,oe=F.pendingProps,oe=F.elementType===ne?oe:rc(ne,oe),Vu(_,F,ne,oe,R);case 1:return ne=F.type,oe=F.pendingProps,oe=F.elementType===ne?oe:rc(ne,oe),Lf(_,F,ne,oe,R);case 3:e:{if(Hv(F),_===null)throw Error(o(387));ne=F.pendingProps,ge=F.memoizedState,oe=ge.element,Ou(_,F),Ll(F,ne,null,R);var $e=F.memoizedState;if(ne=$e.element,fe&&ge.isDehydrated)if(ge={element:ne,isDehydrated:!1,cache:$e.cache,pendingSuspenseBoundaries:$e.pendingSuspenseBoundaries,transitions:$e.transitions},F.updateQueue.baseState=ge,F.memoizedState=ge,F.flags&256){oe=da(Error(o(423)),F),F=Wv(_,F,ne,R,oe);break e}else if(ne!==oe){oe=da(Error(o(424)),F),F=Wv(_,F,ne,R,oe);break e}else for(fe&&(ai=jt(F.stateNode.containerInfo),$n=F,ni=!0,sr=null,Rn=!1),R=Nt(F,null,ne,R),F.child=R;R;)R.flags=R.flags&-3|4096,R=R.sibling;else{if(hs(),ne===oe){F=le(_,F,R);break e}Ui(_,F,ne,R)}F=F.child}return F;case 5:return Sl(F),_===null&&Cr(F),ne=F.type,oe=F.pendingProps,ge=_!==null?_.memoizedProps:null,$e=oe.children,Q(ne,oe)?$e=null:ge!==null&&Q(ne,ge)&&(F.flags|=32),sc(_,F),Ui(_,F,$e,R),F.child;case 6:return _===null&&Cr(F),null;case 13:return zv(_,F,R);case 4:return _c(F,F.stateNode.containerInfo),ne=F.pendingProps,_===null?F.child=Pe(F,null,ne,R):Ui(_,F,ne,R),F.child;case 11:return ne=F.type,oe=F.pendingProps,oe=F.elementType===ne?oe:rc(ne,oe),fo(_,F,ne,oe,R);case 7:return Ui(_,F,F.pendingProps,R),F.child;case 8:return Ui(_,F,F.pendingProps.children,R),F.child;case 12:return Ui(_,F,F.pendingProps.children,R),F.child;case 10:e:{if(ne=F.type._context,oe=F.pendingProps,ge=F.memoizedProps,$e=oe.value,rs(F,ne,$e),ge!==null)if(Wn(ge.value,$e)){if(ge.children===oe.children&&!pn.current){F=le(_,F,R);break e}}else for(ge=F.child,ge!==null&&(ge.return=F);ge!==null;){var Dt=ge.dependencies;if(Dt!==null){$e=ge.child;for(var hn=Dt.firstContext;hn!==null;){if(hn.context===ne){if(ge.tag===1){hn=Qa(-1,R&-R),hn.tag=2;var oi=ge.updateQueue;if(oi!==null){oi=oi.shared;var Vi=oi.pending;Vi===null?hn.next=hn:(hn.next=Vi.next,Vi.next=hn),oi.pending=hn}}ge.lanes|=R,hn=ge.alternate,hn!==null&&(hn.lanes|=R),_l(ge.return,R,F),Dt.lanes|=R;break}hn=hn.next}}else if(ge.tag===10)$e=ge.type===F.type?null:ge.child;else if(ge.tag===18){if($e=ge.return,$e===null)throw Error(o(341));$e.lanes|=R,Dt=$e.alternate,Dt!==null&&(Dt.lanes|=R),_l($e,R,F),$e=ge.sibling}else $e=ge.child;if($e!==null)$e.return=ge;else for($e=ge;$e!==null;){if($e===F){$e=null;break}if(ge=$e.sibling,ge!==null){ge.return=$e.return,$e=ge;break}$e=$e.return}ge=$e}Ui(_,F,oe.children,R),F=F.child}return F;case 9:return oe=F.type,ne=F.pendingProps.children,Bo(F,R),oe=Ao(oe),ne=ne(oe),F.flags|=1,Ui(_,F,ne,R),F.child;case 14:return ne=F.type,oe=rc(ne,F.pendingProps),oe=rc(ne.type,oe),Go(_,F,ne,oe,R);case 15:return Ya(_,F,F.type,F.pendingProps,R);case 17:return ne=F.type,oe=F.pendingProps,oe=F.elementType===ne?oe:rc(ne,oe),G(_,F),F.tag=1,ei(ne)?(_=!0,Ri(F)):_=!1,Bo(F,R),qc(F,ne,oe),yh(F,ne,oe,R),G1(null,F,ne,!0,_,R);case 19:return P(_,F,R);case 22:return Sa(_,F,R)}throw Error(o(156,F.tag))};function EI(_,F){return Pt(_,F)}function bq(_,F,R,ne){this.tag=_,this.key=R,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=F,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=ne,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function du(_,F,R,ne){return new bq(_,F,R,ne)}function kS(_){return _=_.prototype,!(!_||!_.isReactComponent)}function Cq(_){if(typeof _=="function")return kS(_)?1:0;if(_!=null){if(_=_.$$typeof,_===g)return 11;if(_===m)return 14}return 2}function Hf(_,F){var R=_.alternate;return R===null?(R=du(_.tag,F,_.key,_.mode),R.elementType=_.elementType,R.type=_.type,R.stateNode=_.stateNode,R.alternate=_,_.alternate=R):(R.pendingProps=F,R.type=_.type,R.flags=0,R.subtreeFlags=0,R.deletions=null),R.flags=_.flags&14680064,R.childLanes=_.childLanes,R.lanes=_.lanes,R.child=_.child,R.memoizedProps=_.memoizedProps,R.memoizedState=_.memoizedState,R.updateQueue=_.updateQueue,F=_.dependencies,R.dependencies=F===null?null:{lanes:F.lanes,firstContext:F.firstContext},R.sibling=_.sibling,R.index=_.index,R.ref=_.ref,R}function Xv(_,F,R,ne,oe,ge){var $e=2;if(ne=_,typeof _=="function")kS(_)&&($e=1);else if(typeof _=="string")$e=5;else e:switch(_){case u:return Ag(R.children,oe,ge,F);case d:$e=8,oe|=8;break;case A:return _=du(12,R,F,oe|2),_.elementType=A,_.lanes=ge,_;case v:return _=du(13,R,F,oe),_.elementType=v,_.lanes=ge,_;case w:return _=du(19,R,F,oe),_.elementType=w,_.lanes=ge,_;case x:return Yv(R,oe,ge,F);default:if(typeof _=="object"&&_!==null)switch(_.$$typeof){case f:$e=10;break e;case p:$e=9;break e;case g:$e=11;break e;case m:$e=14;break e;case y:$e=16,ne=null;break e}throw Error(o(130,_==null?_:typeof _,""))}return F=du($e,R,F,oe),F.elementType=_,F.type=ne,F.lanes=ge,F}function Ag(_,F,R,ne){return _=du(7,_,ne,F),_.lanes=R,_}function Yv(_,F,R,ne){return _=du(22,_,ne,F),_.elementType=x,_.lanes=R,_.stateNode={isHidden:!1},_}function IS(_,F,R){return _=du(6,_,null,F),_.lanes=R,_}function DS(_,F,R){return F=du(4,_.children!==null?_.children:[],_.key,F),F.lanes=R,F.stateNode={containerInfo:_.containerInfo,pendingChildren:null,implementation:_.implementation},F}function _q(_,F,R,ne,oe){this.tag=F,this.containerInfo=_,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=q,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Mn(0),this.expirationTimes=Mn(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Mn(0),this.identifierPrefix=ne,this.onRecoverableError=oe,fe&&(this.mutableSourceEagerHydrationData=null)}function FI(_,F,R,ne,oe,ge,$e,Dt,hn){return _=new _q(_,F,R,Dt,hn),F===1?(F=1,ge===!0&&(F|=8)):F=0,ge=du(3,null,null,F),_.current=ge,ge.stateNode=_,ge.memoizedState={element:ne,isDehydrated:R,cache:null,transitions:null,pendingSuspenseBoundaries:null},Xc(ge),_}function kI(_){if(!_)return Jn;_=_._reactInternals;e:{if(b(_)!==_||_.tag!==1)throw Error(o(170));var F=_;do{switch(F.tag){case 3:F=F.stateNode.context;break e;case 1:if(ei(F.type)){F=F.stateNode.__reactInternalMemoizedMergedChildContext;break e}}F=F.return}while(F!==null);throw Error(o(171))}if(_.tag===1){var R=_.type;if(ei(R))return Bn(_,R,F)}return F}function II(_){var F=_._reactInternals;if(F===void 0)throw typeof _.render=="function"?Error(o(188)):(_=Object.keys(_).join(","),Error(o(268,_)));return _=k(F),_===null?null:_.stateNode}function DI(_,F){if(_=_.memoizedState,_!==null&&_.dehydrated!==null){var R=_.retryLane;_.retryLane=R!==0&&R<F?R:F}}function Kv(_,F){DI(_,F),(_=_.alternate)&&DI(_,F)}function Sq(_){return _=k(_),_===null?null:_.stateNode}function Tq(){return null}return t.attemptContinuousHydration=function(_){if(_.tag===13){var F=za(_,134217728);if(F!==null){var R=kl();vh(F,_,134217728,R)}Kv(_,134217728)}},t.attemptDiscreteHydration=function(_){if(_.tag===13){var F=za(_,1);if(F!==null){var R=kl();vh(F,_,1,R)}Kv(_,1)}},t.attemptHydrationAtCurrentPriority=function(_){if(_.tag===13){var F=Yu(_),R=za(_,F);if(R!==null){var ne=kl();vh(R,_,F,ne)}Kv(_,F)}},t.attemptSynchronousHydration=function(_){switch(_.tag){case 3:var F=_.stateNode;if(F.current.memoizedState.isDehydrated){var R=kr(F.pendingLanes);R!==0&&(Ke(F,R|1),hc(F,dt()),(Rr&6)===0&&(jA(),Ci()))}break;case 13:Of(function(){var ne=za(_,1);if(ne!==null){var oe=kl();vh(ne,_,1,oe)}}),Kv(_,1)}},t.batchedUpdates=function(_,F){var R=Rr;Rr|=1;try{return _(F)}finally{Rr=R,Rr===0&&(jA(),Gn&&Ci())}},t.createComponentSelector=function(_){return{$$typeof:Ba,value:_}},t.createContainer=function(_,F,R,ne,oe,ge,$e){return FI(_,F,!1,null,R,ne,oe,ge,$e)},t.createHasPseudoClassSelector=function(_){return{$$typeof:Ec,value:_}},t.createHydrationContainer=function(_,F,R,ne,oe,ge,$e,Dt,hn){return _=FI(R,ne,!0,_,oe,ge,$e,Dt,hn),_.context=kI(null),R=_.current,ne=kl(),oe=Yu(R),ge=Qa(ne,oe),ge.callback=F??null,Vs(R,ge,oe),_.current.lanes=oe,ve(_,oe,ne),hc(_,ne),_},t.createPortal=function(_,F,R){var ne=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:h,key:ne==null?null:""+ne,children:_,containerInfo:F,implementation:R}},t.createRoleSelector=function(_){return{$$typeof:Wo,value:_}},t.createTestNameSelector=function(_){return{$$typeof:El,value:_}},t.createTextSelector=function(_){return{$$typeof:eo,value:_}},t.deferredUpdates=function(_){var F=Ge,R=Gs.transition;try{return Gs.transition=null,Ge=16,_()}finally{Ge=F,Gs.transition=R}},t.discreteUpdates=function(_,F,R,ne,oe){var ge=Ge,$e=Gs.transition;try{return Gs.transition=null,Ge=1,_(F,R,ne,oe)}finally{Ge=ge,Gs.transition=$e,Rr===0&&jA()}},t.findAllNodes=Ol,t.findBoundingRects=function(_,F){if(!me)throw Error(o(363));F=Ol(_,F),_=[];for(var R=0;R<F.length;R++)_.push(ue(F[R]));for(F=_.length-1;0<F;F--){R=_[F];for(var ne=R.x,oe=ne+R.width,ge=R.y,$e=ge+R.height,Dt=F-1;0<=Dt;Dt--)if(F!==Dt){var hn=_[Dt],oi=hn.x,Vi=oi+hn.width,Jr=hn.y,Ei=Jr+hn.height;if(ne>=oi&&ge>=Jr&&oe<=Vi&&$e<=Ei){_.splice(F,1);break}else if(ne!==oi||R.width!==hn.width||Ei<ge||Jr>$e){if(!(ge!==Jr||R.height!==hn.height||Vi<ne||oi>oe)){oi>ne&&(hn.width+=oi-ne,hn.x=ne),Vi<oe&&(hn.width=oe-oi),_.splice(F,1);break}}else{Jr>ge&&(hn.height+=Jr-ge,hn.y=ge),Ei<$e&&(hn.height=$e-Jr),_.splice(F,1);break}}}return _},t.findHostInstance=II,t.findHostInstanceWithNoPortals=function(_){return _=T(_),_=_!==null?E(_):null,_===null?null:_.stateNode},t.findHostInstanceWithWarning=function(_){return II(_)},t.flushControlled=function(_){var F=Rr;Rr|=1;var R=Gs.transition,ne=Ge;try{Gs.transition=null,Ge=1,_()}finally{Ge=ne,Gs.transition=R,Rr=F,Rr===0&&(jA(),Ci())}},t.flushPassiveEffects=dg,t.flushSync=Of,t.focusWithin=function(_,F){if(!me)throw Error(o(363));for(_=oc(_),F=Fc(_,F),F=Array.from(F),_=0;_<F.length;){var R=F[_++];if(!it(R)){if(R.tag===5&&qe(R.stateNode))return!0;for(R=R.child;R!==null;)F.push(R),R=R.sibling}}return!1},t.getCurrentUpdatePriority=function(){return Ge},t.getFindAllNodesFailureDescription=function(_,F){if(!me)throw Error(o(363));var R=0,ne=[];_=[oc(_),0];for(var oe=0;oe<_.length;){var ge=_[oe++],$e=_[oe++],Dt=F[$e];if((ge.tag!==5||!it(ge))&&(Fl(ge,Dt)&&(ne.push(ac(Dt)),$e++,$e>R&&(R=$e)),$e<F.length))for(ge=ge.child;ge!==null;)_.push(ge,$e),ge=ge.sibling}if(R<F.length){for(_=[];R<F.length;R++)_.push(ac(F[R]));return`findAllNodes was able to match part of the selector:
  `+(ne.join(" > ")+`

No matching component was found for:
  `)+_.join(" > ")}return null},t.getPublicRootInstance=function(_){if(_=_.current,!_.child)return null;switch(_.child.tag){case 5:return te(_.child.stateNode);default:return _.child.stateNode}},t.injectIntoDevTools=function(_){if(_={bundleType:_.bundleType,version:_.version,rendererPackageName:_.rendererPackageName,rendererConfig:_.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:Sq,findFiberByHostInstance:_.findFiberByHostInstance||Tq,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")_=!1;else{var F=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(F.isDisabled||!F.supportsFiber)_=!0;else{try{Yn=F.inject(_),ht=F}catch{}_=!!F.checkDCE}}return _},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(_,F,R,ne){if(!me)throw Error(o(363));_=Ol(_,F);var oe=Je(_,R,ne).disconnect;return{disconnect:function(){oe()}}},t.registerMutableSourceForHydration=function(_,F){var R=F._getVersion;R=R(F._source),_.mutableSourceEagerHydrationData==null?_.mutableSourceEagerHydrationData=[F,R]:_.mutableSourceEagerHydrationData.push(F,R)},t.runWithPriority=function(_,F){var R=Ge;try{return Ge=_,F()}finally{Ge=R}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(_,F,R,ne){var oe=F.current,ge=kl(),$e=Yu(oe);return R=kI(R),F.context===null?F.context=R:F.pendingContext=R,F=Qa(ge,$e),F.payload={element:_},ne=ne===void 0?null:ne,ne!==null&&(F.callback=ne),_=Vs(oe,F,$e),_!==null&&(vh(_,oe,$e,ge),Hu(_,oe,$e)),$e},t}),cB}var SU;function YGe(){return SU||(SU=1,oB.exports=XGe()),oB.exports}var KGe=YGe();const qGe=Vp(KGe);var hB={exports:{}},ip={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TU;function ZGe(){return TU||(TU=1,ip.ConcurrentRoot=1,ip.ContinuousEventPriority=4,ip.DefaultEventPriority=16,ip.DiscreteEventPriority=1,ip.IdleEventPriority=536870912,ip.LegacyRoot=0),ip}var BU;function JGe(){return BU||(BU=1,hB.exports=ZGe()),hB.exports}var GK=JGe(),eXe=gs();const EU={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let FU=!1,kU=!1;const xI=".react-konva-event",tXe=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,nXe=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,iXe={};function SS(n,e,t=iXe){if(!FU&&"zIndex"in e&&(console.warn(nXe),FU=!0),!kU&&e.draggable){var i=e.x!==void 0||e.y!==void 0,r=e.onDragEnd||e.onDragMove;i&&!r&&(console.warn(tXe),kU=!0)}for(var s in t)if(!EU[s]){var o=s.slice(0,2)==="on",a=t[s]!==e[s];if(o&&a){var l=s.substr(2).toLowerCase();l.substr(0,7)==="content"&&(l="content"+l.substr(7,1).toUpperCase()+l.substr(8)),n.off(l,t[s])}var h=!e.hasOwnProperty(s);h&&n.setAttr(s,void 0)}var u=e._useStrictMode,d={},A=!1;const f={};for(var s in e)if(!EU[s]){var o=s.slice(0,2)==="on",p=t[s]!==e[s];if(o&&p){var l=s.substr(2).toLowerCase();l.substr(0,7)==="content"&&(l="content"+l.substr(7,1).toUpperCase()+l.substr(8)),e[s]&&(f[l]=e[s])}!o&&(e[s]!==t[s]||u&&e[s]!==n.getAttr(s))&&(A=!0,d[s]=e[s])}A&&(n.setAttrs(d),ig(n));for(var l in f)n.on(l+xI,f[l])}function ig(n){if(!eXe.Konva.autoDrawEnabled){var e=n.getLayer()||n.getStage();e&&e.batchDraw()}}var uB=VK();const XK={},rXe={};qw.Node.prototype._applyProps=SS;function sXe(n,e){if(typeof e=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${e}`);return}n.add(e),ig(n)}function oXe(n,e,t){let i=qw[n];i||(console.error(`Konva has no node with the type ${n}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${n}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),i=qw.Group);const r={},s={};for(var o in e){var a=o.slice(0,2)==="on";a?s[o]=e[o]:r[o]=e[o]}const l=new i(r);return SS(l,s),l}function aXe(n,e,t){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${n}"`)}function lXe(n,e,t){return!1}function cXe(n){return n}function hXe(){return null}function uXe(){return null}function dXe(n,e,t,i){return rXe}function AXe(){}function fXe(n){}function pXe(n,e){return!1}function gXe(){return XK}function mXe(){return XK}const yXe=setTimeout,wXe=clearTimeout,vXe=-1;function xXe(n,e){return!1}const bXe=!1,CXe=!0,_Xe=!0;function SXe(n,e){e.parent===n?e.moveToTop():n.add(e),ig(n)}function TXe(n,e){e.parent===n?e.moveToTop():n.add(e),ig(n)}function YK(n,e,t){e._remove(),n.add(e),e.setZIndex(t.getZIndex()),ig(n)}function BXe(n,e,t){YK(n,e,t)}function EXe(n,e){e.destroy(),e.off(xI),ig(n)}function FXe(n,e){e.destroy(),e.off(xI),ig(n)}function kXe(n,e,t){console.error(`Text components are not yet supported in ReactKonva. You text is: "${t}"`)}function IXe(n,e,t){}function DXe(n,e,t,i,r){SS(n,r,i)}function jXe(n){n.hide(),ig(n)}function PXe(n){}function NXe(n,e){(e.visible==null||e.visible)&&n.show()}function LXe(n,e){}function MXe(n){}function RXe(){}const UXe=()=>GK.DefaultEventPriority,OXe=Object.freeze(Object.defineProperty({__proto__:null,appendChild:SXe,appendChildToContainer:TXe,appendInitialChild:sXe,cancelTimeout:wXe,clearContainer:MXe,commitMount:IXe,commitTextUpdate:kXe,commitUpdate:DXe,createInstance:oXe,createTextInstance:aXe,detachDeletedInstance:RXe,finalizeInitialChildren:lXe,getChildHostContext:mXe,getCurrentEventPriority:UXe,getPublicInstance:cXe,getRootHostContext:gXe,hideInstance:jXe,hideTextInstance:PXe,idlePriority:uB.unstable_IdlePriority,insertBefore:YK,insertInContainerBefore:BXe,isPrimaryRenderer:bXe,noTimeout:vXe,now:uB.unstable_now,prepareForCommit:hXe,preparePortalMount:uXe,prepareUpdate:dXe,removeChild:EXe,removeChildFromContainer:FXe,resetAfterCommit:AXe,resetTextContent:fXe,run:uB.unstable_runWithPriority,scheduleTimeout:yXe,shouldDeprioritizeSubtree:pXe,shouldSetTextContent:xXe,supportsMutation:_Xe,unhideInstance:NXe,unhideTextInstance:LXe,warnsIfNotActing:CXe},Symbol.toStringTag,{value:"Module"}));function HXe(n){const e=ci.useRef({});return ci.useLayoutEffect(()=>{e.current=n}),ci.useLayoutEffect(()=>()=>{e.current={}},[]),e.current}const WXe=n=>{const e=ci.useRef(),t=ci.useRef(),i=ci.useRef(),r=HXe(n),s=Wq(),o=a=>{const{forwardedRef:l}=n;l&&(typeof l=="function"?l(a):l.current=a)};return ci.useLayoutEffect(()=>(t.current=new qw.Stage({width:n.width,height:n.height,container:e.current}),o(t.current),i.current=jy.createContainer(t.current,GK.LegacyRoot,!1,null),jy.updateContainer(ci.createElement(s,{},n.children),i.current),()=>{qw.isBrowser&&(o(null),jy.updateContainer(null,i.current,null),t.current.destroy())}),[]),ci.useLayoutEffect(()=>{o(t.current),SS(t.current,n,r),jy.updateContainer(ci.createElement(s,{},n.children),i.current,null)}),ci.createElement("div",{ref:e,id:n.id,accessKey:n.accessKey,className:n.className,role:n.role,style:n.style,tabIndex:n.tabIndex,title:n.title})},zXe="Layer",Zg="Group",Hg="Rect",dB="Circle",hd="Line",y1="Text",jy=qGe(OXe);jy.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:ci.version,rendererPackageName:"react-konva"});const QXe=ci.forwardRef((n,e)=>ci.createElement(Hq,{},ci.createElement(WXe,{...n,forwardedRef:e}))),$Xe=({item:n,scale:e,isSelected:t,isDragging:i,onSelect:r,onDragStart:s,onDragEnd:o,onRotate:a,onDelete:l,onDoubleClick:h,mmToPixels:u})=>{const d=H.useRef(null),[A,f]=H.useState(!1),[p,g]=H.useState(n.rotation||0),v=Zi(n.moduleId),w=u(n.position.x),m=u(n.position.z),y=u(n.dimensions.width),x=u(n.dimensions.depth),S=D=>{const k=D.target.rotation();g(k),a(n.id,k)},I=()=>{if(i)return"#4CAF50";if(t)return"#1976D2";if(A)return"#42A5F5";switch(v==null?void 0:v.type){case"cabinet":return"#2196F3";case"drawer":return"#FF9800";case"shelf":return"#9C27B0";case"door":return"#00BCD4";default:return"#607D8B"}},j=()=>{h&&h(n.id)},C=()=>{const D=[];if((v==null?void 0:v.type)==="cabinet"&&n.hasDoors){const T=4/e,k=10/e;D.push(c.jsx(dB,{x:k,y:x/2,radius:T,fill:"#666",stroke:"#333",strokeWidth:1/e},"handle-left")),n.dimensions.width>600&&D.push(c.jsx(dB,{x:y-k,y:x/2,radius:T,fill:"#666",stroke:"#333",strokeWidth:1/e},"handle-right"))}if((v==null?void 0:v.type)==="drawer"){const T=Math.floor(n.dimensions.height/200);for(let k=1;k<T;k++){const B=x/T*k;D.push(c.jsx(hd,{points:[5/e,B,y-5/e,B],stroke:"#999",strokeWidth:1/e},`drawer-line-${k}`))}}return c.jsx(c.Fragment,{children:D})},b=()=>{if(!t)return null;const D=6/e,T=2/e;return c.jsxs(c.Fragment,{children:[c.jsx(Hg,{x:-T,y:-T,width:y+T*2,height:x+T*2,stroke:"#1976D2",strokeWidth:T,fill:"transparent",dash:[5/e,5/e]}),c.jsx(dB,{x:y/2,y:-20/e,radius:D,fill:"#1976D2",stroke:"white",strokeWidth:T,draggable:!0,onDragMove:k=>{const B=k.target,E=d.current;if(!E)return;const z=E.x()+y/2,te=E.y()+x/2,L=Math.atan2(B.y()+E.y()-te,B.x()+E.x()-z)*180/Math.PI+90;E.rotation(L)},onDragEnd:S}),[{x:0,y:0},{x:y,y:0},{x:y,y:x},{x:0,y:x}].map((k,B)=>c.jsx(Hg,{x:k.x-D/2,y:k.y-D/2,width:D,height:D,fill:"white",stroke:"#1976D2",strokeWidth:T},`handle-${B}`))]})};return c.jsxs(Zg,{ref:d,x:w,y:m,rotation:p,draggable:!0,onDragStart:()=>s(n.id),onDragEnd:D=>{const T=D.target,k=T.x()/.1,B=T.y()/.1;o(n.id,k,B)},onClick:()=>r(n.id),onDblClick:j,onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),onTransformEnd:S,children:[c.jsx(Hg,{x:2/e,y:2/e,width:y,height:x,fill:"black",opacity:.2,cornerRadius:4/e}),c.jsx(Hg,{width:y,height:x,fill:I(),stroke:t?"#0D47A1":"#1565C0",strokeWidth:(t?2:1)/e,cornerRadius:4/e,opacity:i?.7:.9}),C(),c.jsx(y1,{text:n.name||(v==null?void 0:v.name)||"Furniture",fontSize:Math.max(10,12/e),fill:"white",width:y,height:x,align:"center",verticalAlign:"middle",fontStyle:"bold",shadowColor:"black",shadowBlur:2/e,shadowOpacity:.5}),t&&c.jsx(y1,{y:x+5/e,text:`${Math.round(n.dimensions.width)} x ${Math.round(n.dimensions.depth)}mm`,fontSize:10/e,fill:"#666",width:y,align:"center"}),b()]})},VXe=({width:n,height:e,gridSize:t,scale:i,showLabels:r=!1,labelInterval:s=5,color:o="#e0e0e0",opacity:a=.5})=>{const l=H.useMemo(()=>{const h=[],u=[],A=n*2,f=e*2,p=-n*1/2,g=-e*1/2,v=t*5,w=1/i,m=2/i;for(let y=p;y<=A+p;y+=t){const x=Math.abs(y%v)<.01,S=x?a:a*.5;if(h.push(c.jsx(hd,{points:[y,g,y,f+g],stroke:o,strokeWidth:x?m:w,opacity:S},`v-${y}`)),r&&x&&y>=0&&y<=n){const I=Math.round(y/.1);u.push(c.jsx(y1,{x:y,y:-20/i,text:`${I}`,fontSize:10/i,fill:"#666",align:"center"},`label-x-${y}`))}}for(let y=g;y<=f+g;y+=t){const x=Math.abs(y%v)<.01,S=x?a:a*.5;if(h.push(c.jsx(hd,{points:[p,y,A+p,y],stroke:o,strokeWidth:x?m:w,opacity:S},`h-${y}`)),r&&x&&y>=0&&y<=e){const I=Math.round(y/.1);u.push(c.jsx(y1,{x:-30/i,y,text:`${I}`,fontSize:10/i,fill:"#666",align:"center",verticalAlign:"middle"},`label-y-${y}`))}}return r&&h.push(c.jsx(hd,{points:[-10/i,0,10/i,0],stroke:"#ff0000",strokeWidth:2/i,opacity:.7},"origin-x"),c.jsx(hd,{points:[0,-10/i,0,10/i],stroke:"#00ff00",strokeWidth:2/i,opacity:.7},"origin-y")),{lines:h,labels:u}},[n,e,t,i,r,o,a]);return c.jsxs(Zg,{children:[c.jsx(Zg,{opacity:.5,children:l.lines}),r&&c.jsx(Zg,{children:l.labels})]})},GXe="_container_1qst1_1",XXe="_zoomLevel_1qst1_64",YXe="_toolbar_1qst1_95",KXe="_toolGroup_1qst1_109",qXe="_toolDivider_1qst1_115",ZXe="_toolButton_1qst1_122",JXe="_active_1qst1_139",ao={container:GXe,zoomLevel:XXe,toolbar:YXe,toolGroup:KXe,toolDivider:qXe,toolButton:ZXe,active:JXe},eYe=({showGrid:n,showDimensions:e,showFurniture:t,showColumns:i,showWalls:r,tool:s,scale:o,onToggleGrid:a,onToggleDimensions:l,onToggleFurniture:h,onToggleColumns:u,onToggleWalls:d,onToolChange:A,onZoomIn:f,onZoomOut:p,onZoomReset:g,onExport:v,onImport:w})=>c.jsxs("div",{className:ao.toolbar,children:[c.jsxs("div",{className:ao.toolGroup,children:[c.jsx("button",{className:`${ao.toolButton} ${s==="select"?ao.active:""}`,onClick:()=>A("select"),title:"Select Tool (V)",children:c.jsx(Fve,{size:20})}),c.jsx("button",{className:`${ao.toolButton} ${s==="pan"?ao.active:""}`,onClick:()=>A("pan"),title:"Pan Tool (H)",children:c.jsx(Ive,{size:20})}),c.jsx("button",{className:`${ao.toolButton} ${s==="measure"?ao.active:""}`,onClick:()=>A("measure"),title:"Measure Tool (M)",children:c.jsx(u6,{size:20})})]}),c.jsx("div",{className:ao.toolDivider}),c.jsxs("div",{className:ao.toolGroup,children:[c.jsx("button",{className:`${ao.toolButton} ${n?ao.active:""}`,onClick:a,title:"Toggle Grid (G)",children:c.jsx(pve,{size:20})}),c.jsx("button",{className:`${ao.toolButton} ${e?ao.active:""}`,onClick:l,title:"Toggle Dimensions (D)",children:c.jsx(u6,{size:20})}),c.jsx("button",{className:`${ao.toolButton} ${t?ao.active:""}`,onClick:h,title:"Toggle Furniture (F)",children:t?c.jsx(n8,{size:20}):c.jsx(t8,{size:20})}),c.jsx("button",{className:`${ao.toolButton} ${i?ao.active:""}`,onClick:u,title:"Toggle Columns",children:c.jsx(S_,{size:20})}),c.jsx("button",{className:`${ao.toolButton} ${r?ao.active:""}`,onClick:d,title:"Toggle Walls",children:c.jsx(S_,{size:20})})]}),c.jsx("div",{className:ao.toolDivider}),c.jsxs("div",{className:ao.toolGroup,children:[c.jsx("button",{className:ao.toolButton,onClick:f,title:"Zoom In (+)",children:c.jsx(rG,{size:20})}),c.jsxs("span",{className:ao.zoomLevel,children:[Math.round(o*100),"%"]}),c.jsx("button",{className:ao.toolButton,onClick:p,title:"Zoom Out (-)",children:c.jsx(sG,{size:20})}),c.jsx("button",{className:ao.toolButton,onClick:g,title:"Fit to View (Space)",children:c.jsx(Sve,{size:20})})]}),(v||w)&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:ao.toolDivider}),c.jsxs("div",{className:ao.toolGroup,children:[w&&c.jsx("button",{className:ao.toolButton,onClick:w,title:"Import",children:c.jsx(s8,{size:20})}),v&&c.jsx("button",{className:ao.toolButton,onClick:v,title:"Export",children:c.jsx(GV,{size:20})})]})]})]}),tYe=100,IU=.1,DU=5,zb=1.1,nYe=100,iYe="konva-stage-container-2d",bI=({width:n=800,height:e=600,viewMode:t="2D",showGrid:i=!0,showDimensions:r=!0,showFurniture:s=!0})=>{const o=H.useRef(null),a=H.useRef(null),l=H.useRef(null),h=H.useRef(),u=H.useRef(!1),d=H.useRef(!1),A=hr(),f=pi(),p=Wi(),[g,v]=H.useState({x:0,y:0,scale:1}),[w,m]=H.useState({width:n,height:e}),[y,x]=H.useState(!1),[S,I]=H.useState(null),[j,C]=H.useState(null),[b,D]=H.useState("select"),[T,k]=H.useState(!0),[B,E]=H.useState(!0),[z,te]=H.useState(i),[L,O]=H.useState(r),[J,$]=H.useState(s),U=H.useCallback(ie=>ie*.1,[]),Y=H.useCallback(()=>{h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{if(!d.current||!l.current)return;const ie=l.current.getBoundingClientRect();m(ee=>ee.width!==ie.width||ee.height!==ie.height?(console.log("[Space2DKonvaView] Size updated:",{width:ie.width,height:ie.height}),{width:ie.width,height:ie.height}):ee)},nYe)},[]);H.useEffect(()=>{if(d.current=!0,l.current&&!u.current){const ae=l.current.getBoundingClientRect();m({width:ae.width,height:ae.height}),u.current=!0,console.log("[Space2DKonvaView] Initial mount, size set:",{width:ae.width,height:ae.height})}const ie=()=>{d.current&&Y()},ee=()=>{d.current&&setTimeout(()=>{d.current&&Y()},300)};return window.addEventListener("resize",ie),window.addEventListener("orientationchange",ee),()=>{d.current=!1,window.removeEventListener("resize",ie),window.removeEventListener("orientationchange",ee),h.current&&clearTimeout(h.current),o.current&&(console.log("[Space2DKonvaView] Cleaning up Konva stage"),o.current.destroy())}},[Y]),H.useEffect(()=>{if(d.current&&A.width&&A.depth&&w.width>0&&w.height>0){const ie=U(A.width),ee=U(A.depth),ae=w.width*.8/ie,me=w.height*.8/ee,_e=Math.min(ae,me,1),ue=(w.width-ie*_e)/2,Be=(w.height-ee*_e)/2;v({x:ue,y:Be,scale:_e})}},[A.width,A.depth,w,U]);const K=H.useCallback(ie=>{ie.evt.preventDefault();const ee=o.current;if(!ee)return;const ae=g.scale,me=ee.getPointerPosition();if(!me)return;const _e={x:(me.x-g.x)/ae,y:(me.y-g.y)/ae},ue=ie.evt.deltaY>0?-1:1,Be=Math.max(IU,Math.min(DU,ae*(ue>0?zb:1/zb)));v({scale:Be,x:me.x-_e.x*Be,y:me.y-_e.y*Be})},[g]),V=H.useCallback(ie=>{const ee=ie.target;v(ae=>({...ae,x:ee.x(),y:ee.y()}))},[]),Q=H.useCallback(ie=>{C(ie)},[]),X=H.useCallback(ie=>{x(!0),I(ie)},[]),W=H.useCallback((ie,ee,ae)=>{var me;x(!1),I(null),f.updateModule(ie,{position:{x:ee,y:((me=f.placedModules.find(_e=>_e.id===ie))==null?void 0:me.position.y)||0,z:ae}})},[f]),se=H.useCallback((ie,ee)=>{f.updateModule(ie,{rotation:ee})},[f]),q=H.useCallback(ie=>{f.removeModule(ie),j===ie&&C(null)},[f,j]),de=H.useCallback(()=>{v(ie=>({...ie,scale:Math.min(DU,ie.scale*zb)}))},[]),Ce=H.useCallback(()=>{v(ie=>({...ie,scale:Math.max(IU,ie.scale/zb)}))},[]),Se=H.useCallback(()=>{if(A.width&&A.depth){const ie=U(A.width),ee=U(A.depth),ae=w.width*.8/ie,me=w.height*.8/ee,_e=Math.min(ae,me,1),ue=(w.width-ie*_e)/2,Be=(w.height-ee*_e)/2;v({x:ue,y:Be,scale:_e})}},[A.width,A.depth,w,U]),fe=()=>{const ie=U(A.width),ee=U(A.depth);return c.jsxs(Zg,{children:[c.jsx(Hg,{x:0,y:0,width:ie,height:ee,fill:"#f5f5f5",stroke:"#333",strokeWidth:2/g.scale}),T&&A.columns.map(ae=>{const me=U(ae.position.x),_e=U(ae.position.z),ue=U(ae.size);return c.jsx(Hg,{x:me-ue/2,y:_e-ue/2,width:ue,height:ue,fill:"#666",stroke:"#333",strokeWidth:1/g.scale},ae.id)}),B&&A.walls.map(ae=>{const me=U(ae.position.x),_e=U(ae.position.z),ue=U(ae.dimensions.width),Be=U(ae.dimensions.depth);return c.jsx(Hg,{x:me,y:_e,width:ue,height:Be,fill:"#999",stroke:"#333",strokeWidth:1/g.scale,opacity:.7},ae.id)})]})},M=()=>J?c.jsx(Zg,{children:f.placedModules.map(ie=>c.jsx($Xe,{item:ie,scale:g.scale,isSelected:j===ie.id,isDragging:S===ie.id,onSelect:Q,onDragStart:X,onDragEnd:W,onRotate:se,onDelete:q,onDoubleClick:ee=>{p.setActivePopup({type:"furnitureEdit",id:ee})},mmToPixels:U},ie.id))}):null,Z=()=>{if(!L)return null;const ie=U(A.width),ee=U(A.depth),ae=14/g.scale,me=30/g.scale;return c.jsxs(Zg,{children:[c.jsx(hd,{points:[0,-me,ie,-me],stroke:"#666",strokeWidth:1/g.scale}),c.jsx(hd,{points:[0,-me-5/g.scale,0,-me+5/g.scale],stroke:"#666",strokeWidth:1/g.scale}),c.jsx(hd,{points:[ie,-me-5/g.scale,ie,-me+5/g.scale],stroke:"#666",strokeWidth:1/g.scale}),c.jsx(y1,{x:ie/2,y:-me-ae,text:`${A.width}mm`,fontSize:ae,fill:"#666",align:"center"}),c.jsx(hd,{points:[-me,0,-me,ee],stroke:"#666",strokeWidth:1/g.scale}),c.jsx(hd,{points:[-me-5/g.scale,0,-me+5/g.scale,0],stroke:"#666",strokeWidth:1/g.scale}),c.jsx(hd,{points:[-me-5/g.scale,ee,-me+5/g.scale,ee],stroke:"#666",strokeWidth:1/g.scale}),c.jsx(y1,{x:-me-ae*3,y:ee/2,text:`${A.depth}mm`,fontSize:ae,fill:"#666",rotation:-90,align:"center"})]})},Ae=H.useMemo(()=>`konva-stage-${Date.now()}`,[]);return c.jsxs("div",{ref:l,className:ao.container,id:iYe,children:[c.jsx(eYe,{showGrid:z,showDimensions:L,showFurniture:J,showColumns:T,showWalls:B,tool:b,scale:g.scale,onToggleGrid:()=>te(!z),onToggleDimensions:()=>O(!L),onToggleFurniture:()=>$(!J),onToggleColumns:()=>k(!T),onToggleWalls:()=>E(!B),onToolChange:D,onZoomIn:de,onZoomOut:Ce,onZoomReset:Se}),c.jsx(QXe,{ref:o,width:w.width,height:w.height,onWheel:K,draggable:!y,onDragEnd:V,x:g.x,y:g.y,scaleX:g.scale,scaleY:g.scale,children:c.jsxs(zXe,{ref:a,children:[z&&c.jsx(VXe,{width:U(A.width),height:U(A.depth),gridSize:U(tYe),scale:g.scale,showLabels:g.scale>.5,color:"#e0e0e0",opacity:.5}),fe(),Z(),M()]})},Ae)]})};function gf(n,e,{checkForDefaultPrevented:t=!0}={}){return function(r){if(n==null||n(r),t===!1||!r.defaultPrevented)return e==null?void 0:e(r)}}function CI(n,e=[]){let t=[];function i(s,o){const a=H.createContext(o),l=t.length;t=[...t,o];const h=d=>{var w;const{scope:A,children:f,...p}=d,g=((w=A==null?void 0:A[n])==null?void 0:w[l])||a,v=H.useMemo(()=>p,Object.values(p));return c.jsx(g.Provider,{value:v,children:f})};h.displayName=s+"Provider";function u(d,A){var g;const f=((g=A==null?void 0:A[n])==null?void 0:g[l])||a,p=H.useContext(f);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${s}\``)}return[h,u]}const r=()=>{const s=t.map(o=>H.createContext(o));return function(a){const l=(a==null?void 0:a[n])||s;return H.useMemo(()=>({[`__scope${n}`]:{...a,[n]:l}}),[a,l])}};return r.scopeName=n,[i,rYe(r,...e)]}function rYe(...n){const e=n[0];if(n.length===1)return e;const t=()=>{const i=n.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(s){const o=i.reduce((a,{useScope:l,scopeName:h})=>{const d=l(s)[`__scope${h}`];return{...a,...d}},{});return H.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return t.scopeName=e.scopeName,t}function jU(n,e){if(typeof n=="function")return n(e);n!=null&&(n.current=e)}function KK(...n){return e=>{let t=!1;const i=n.map(r=>{const s=jU(r,e);return!t&&typeof s=="function"&&(t=!0),s});if(t)return()=>{for(let r=0;r<i.length;r++){const s=i[r];typeof s=="function"?s():jU(n[r],null)}}}}function X_(...n){return H.useCallback(KK(...n),n)}function K6(n){const e=sYe(n),t=H.forwardRef((i,r)=>{const{children:s,...o}=i,a=H.Children.toArray(s),l=a.find(aYe);if(l){const h=l.props.children,u=a.map(d=>d===l?H.Children.count(h)>1?H.Children.only(null):H.isValidElement(h)?h.props.children:null:d);return c.jsx(e,{...o,ref:r,children:H.isValidElement(h)?H.cloneElement(h,void 0,u):null})}return c.jsx(e,{...o,ref:r,children:s})});return t.displayName=`${n}.Slot`,t}function sYe(n){const e=H.forwardRef((t,i)=>{const{children:r,...s}=t;if(H.isValidElement(r)){const o=cYe(r),a=lYe(s,r.props);return r.type!==H.Fragment&&(a.ref=i?KK(i,o):o),H.cloneElement(r,a)}return H.Children.count(r)>1?H.Children.only(null):null});return e.displayName=`${n}.SlotClone`,e}var oYe=Symbol("radix.slottable");function aYe(n){return H.isValidElement(n)&&typeof n.type=="function"&&"__radixId"in n.type&&n.type.__radixId===oYe}function lYe(n,e){const t={...e};for(const i in e){const r=n[i],s=e[i];/^on[A-Z]/.test(i)?r&&s?t[i]=(...a)=>{const l=s(...a);return r(...a),l}:r&&(t[i]=r):i==="style"?t[i]={...r,...s}:i==="className"&&(t[i]=[r,s].filter(Boolean).join(" "))}return{...n,...t}}function cYe(n){var i,r;let e=(i=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:i.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(r=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}function hYe(n){const e=n+"CollectionProvider",[t,i]=CI(e),[r,s]=t(e,{collectionRef:{current:null},itemMap:new Map}),o=g=>{const{scope:v,children:w}=g,m=ci.useRef(null),y=ci.useRef(new Map).current;return c.jsx(r,{scope:v,itemMap:y,collectionRef:m,children:w})};o.displayName=e;const a=n+"CollectionSlot",l=K6(a),h=ci.forwardRef((g,v)=>{const{scope:w,children:m}=g,y=s(a,w),x=X_(v,y.collectionRef);return c.jsx(l,{ref:x,children:m})});h.displayName=a;const u=n+"CollectionItemSlot",d="data-radix-collection-item",A=K6(u),f=ci.forwardRef((g,v)=>{const{scope:w,children:m,...y}=g,x=ci.useRef(null),S=X_(v,x),I=s(u,w);return ci.useEffect(()=>(I.itemMap.set(x,{ref:x,...y}),()=>void I.itemMap.delete(x))),c.jsx(A,{[d]:"",ref:S,children:m})});f.displayName=u;function p(g){const v=s(n+"CollectionConsumer",g);return ci.useCallback(()=>{const m=v.collectionRef.current;if(!m)return[];const y=Array.from(m.querySelectorAll(`[${d}]`));return Array.from(v.itemMap.values()).sort((I,j)=>y.indexOf(I.ref.current)-y.indexOf(j.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:o,Slot:h,ItemSlot:f},p,i]}var Y_=globalThis!=null&&globalThis.document?H.useLayoutEffect:()=>{},uYe=YU[" useId ".trim().toString()]||(()=>{}),dYe=0;function qK(n){const[e,t]=H.useState(uYe());return Y_(()=>{t(i=>i??String(dYe++))},[n]),n||(e?`radix-${e}`:"")}var AYe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],$1=AYe.reduce((n,e)=>{const t=K6(`Primitive.${e}`),i=H.forwardRef((r,s)=>{const{asChild:o,...a}=r,l=o?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),c.jsx(l,{...a,ref:s})});return i.displayName=`Primitive.${e}`,{...n,[e]:i}},{});function fYe(n){const e=H.useRef(n);return H.useEffect(()=>{e.current=n}),H.useMemo(()=>(...t)=>{var i;return(i=e.current)==null?void 0:i.call(e,...t)},[])}var pYe=YU[" useInsertionEffect ".trim().toString()]||Y_;function ZK({prop:n,defaultProp:e,onChange:t=()=>{},caller:i}){const[r,s,o]=gYe({defaultProp:e,onChange:t}),a=n!==void 0,l=a?n:r;{const u=H.useRef(n!==void 0);H.useEffect(()=>{const d=u.current;d!==a&&console.warn(`${i} is changing from ${d?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=a},[a,i])}const h=H.useCallback(u=>{var d;if(a){const A=mYe(u)?u(n):u;A!==n&&((d=o.current)==null||d.call(o,A))}else s(u)},[a,n,s,o]);return[l,h]}function gYe({defaultProp:n,onChange:e}){const[t,i]=H.useState(n),r=H.useRef(t),s=H.useRef(e);return pYe(()=>{s.current=e},[e]),H.useEffect(()=>{var o;r.current!==t&&((o=s.current)==null||o.call(s,t),r.current=t)},[t,r]),[t,i,s]}function mYe(n){return typeof n=="function"}var yYe=H.createContext(void 0);function JK(n){const e=H.useContext(yYe);return n||e||"ltr"}var AB="rovingFocusGroup.onEntryFocus",wYe={bubbles:!1,cancelable:!0},Ov="RovingFocusGroup",[q6,eq,vYe]=hYe(Ov),[xYe,tq]=CI(Ov,[vYe]),[bYe,CYe]=xYe(Ov),nq=H.forwardRef((n,e)=>c.jsx(q6.Provider,{scope:n.__scopeRovingFocusGroup,children:c.jsx(q6.Slot,{scope:n.__scopeRovingFocusGroup,children:c.jsx(_Ye,{...n,ref:e})})}));nq.displayName=Ov;var _Ye=H.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,orientation:i,loop:r=!1,dir:s,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:h,preventScrollOnEntryFocus:u=!1,...d}=n,A=H.useRef(null),f=X_(e,A),p=JK(s),[g,v]=ZK({prop:o,defaultProp:a??null,onChange:l,caller:Ov}),[w,m]=H.useState(!1),y=fYe(h),x=eq(t),S=H.useRef(!1),[I,j]=H.useState(0);return H.useEffect(()=>{const C=A.current;if(C)return C.addEventListener(AB,y),()=>C.removeEventListener(AB,y)},[y]),c.jsx(bYe,{scope:t,orientation:i,dir:p,loop:r,currentTabStopId:g,onItemFocus:H.useCallback(C=>v(C),[v]),onItemShiftTab:H.useCallback(()=>m(!0),[]),onFocusableItemAdd:H.useCallback(()=>j(C=>C+1),[]),onFocusableItemRemove:H.useCallback(()=>j(C=>C-1),[]),children:c.jsx($1.div,{tabIndex:w||I===0?-1:0,"data-orientation":i,...d,ref:f,style:{outline:"none",...n.style},onMouseDown:gf(n.onMouseDown,()=>{S.current=!0}),onFocus:gf(n.onFocus,C=>{const b=!S.current;if(C.target===C.currentTarget&&b&&!w){const D=new CustomEvent(AB,wYe);if(C.currentTarget.dispatchEvent(D),!D.defaultPrevented){const T=x().filter(te=>te.focusable),k=T.find(te=>te.active),B=T.find(te=>te.id===g),z=[k,B,...T].filter(Boolean).map(te=>te.ref.current);sq(z,u)}}S.current=!1}),onBlur:gf(n.onBlur,()=>m(!1))})})}),iq="RovingFocusGroupItem",rq=H.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,focusable:i=!0,active:r=!1,tabStopId:s,children:o,...a}=n,l=qK(),h=s||l,u=CYe(iq,t),d=u.currentTabStopId===h,A=eq(t),{onFocusableItemAdd:f,onFocusableItemRemove:p,currentTabStopId:g}=u;return H.useEffect(()=>{if(i)return f(),()=>p()},[i,f,p]),c.jsx(q6.ItemSlot,{scope:t,id:h,focusable:i,active:r,children:c.jsx($1.span,{tabIndex:d?0:-1,"data-orientation":u.orientation,...a,ref:e,onMouseDown:gf(n.onMouseDown,v=>{i?u.onItemFocus(h):v.preventDefault()}),onFocus:gf(n.onFocus,()=>u.onItemFocus(h)),onKeyDown:gf(n.onKeyDown,v=>{if(v.key==="Tab"&&v.shiftKey){u.onItemShiftTab();return}if(v.target!==v.currentTarget)return;const w=BYe(v,u.orientation,u.dir);if(w!==void 0){if(v.metaKey||v.ctrlKey||v.altKey||v.shiftKey)return;v.preventDefault();let y=A().filter(x=>x.focusable).map(x=>x.ref.current);if(w==="last")y.reverse();else if(w==="prev"||w==="next"){w==="prev"&&y.reverse();const x=y.indexOf(v.currentTarget);y=u.loop?EYe(y,x+1):y.slice(x+1)}setTimeout(()=>sq(y))}}),children:typeof o=="function"?o({isCurrentTabStop:d,hasTabStop:g!=null}):o})})});rq.displayName=iq;var SYe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function TYe(n,e){return e!=="rtl"?n:n==="ArrowLeft"?"ArrowRight":n==="ArrowRight"?"ArrowLeft":n}function BYe(n,e,t){const i=TYe(n.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(i))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(i)))return SYe[i]}function sq(n,e=!1){const t=document.activeElement;for(const i of n)if(i===t||(i.focus({preventScroll:e}),document.activeElement!==t))return}function EYe(n,e){return n.map((t,i)=>n[(e+i)%n.length])}var FYe=nq,kYe=rq;function IYe(n,e){return H.useReducer((t,i)=>e[t][i]??t,n)}var oq=n=>{const{present:e,children:t}=n,i=DYe(e),r=typeof t=="function"?t({present:i.isPresent}):H.Children.only(t),s=X_(i.ref,jYe(r));return typeof t=="function"||i.isPresent?H.cloneElement(r,{ref:s}):null};oq.displayName="Presence";function DYe(n){const[e,t]=H.useState(),i=H.useRef(null),r=H.useRef(n),s=H.useRef("none"),o=n?"mounted":"unmounted",[a,l]=IYe(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return H.useEffect(()=>{const h=Qb(i.current);s.current=a==="mounted"?h:"none"},[a]),Y_(()=>{const h=i.current,u=r.current;if(u!==n){const A=s.current,f=Qb(h);n?l("MOUNT"):f==="none"||(h==null?void 0:h.display)==="none"?l("UNMOUNT"):l(u&&A!==f?"ANIMATION_OUT":"UNMOUNT"),r.current=n}},[n,l]),Y_(()=>{if(e){let h;const u=e.ownerDocument.defaultView??window,d=f=>{const g=Qb(i.current).includes(CSS.escape(f.animationName));if(f.target===e&&g&&(l("ANIMATION_END"),!r.current)){const v=e.style.animationFillMode;e.style.animationFillMode="forwards",h=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=v)})}},A=f=>{f.target===e&&(s.current=Qb(i.current))};return e.addEventListener("animationstart",A),e.addEventListener("animationcancel",d),e.addEventListener("animationend",d),()=>{u.clearTimeout(h),e.removeEventListener("animationstart",A),e.removeEventListener("animationcancel",d),e.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:H.useCallback(h=>{i.current=h?getComputedStyle(h):null,t(h)},[])}}function Qb(n){return(n==null?void 0:n.animationName)||"none"}function jYe(n){var i,r;let e=(i=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:i.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(r=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}var TS="Tabs",[PYe,TJe]=CI(TS,[tq]),aq=tq(),[NYe,_I]=PYe(TS),lq=H.forwardRef((n,e)=>{const{__scopeTabs:t,value:i,onValueChange:r,defaultValue:s,orientation:o="horizontal",dir:a,activationMode:l="automatic",...h}=n,u=JK(a),[d,A]=ZK({prop:i,onChange:r,defaultProp:s??"",caller:TS});return c.jsx(NYe,{scope:t,baseId:qK(),value:d,onValueChange:A,orientation:o,dir:u,activationMode:l,children:c.jsx($1.div,{dir:u,"data-orientation":o,...h,ref:e})})});lq.displayName=TS;var cq="TabsList",hq=H.forwardRef((n,e)=>{const{__scopeTabs:t,loop:i=!0,...r}=n,s=_I(cq,t),o=aq(t);return c.jsx(FYe,{asChild:!0,...o,orientation:s.orientation,dir:s.dir,loop:i,children:c.jsx($1.div,{role:"tablist","aria-orientation":s.orientation,...r,ref:e})})});hq.displayName=cq;var uq="TabsTrigger",Z6=H.forwardRef((n,e)=>{const{__scopeTabs:t,value:i,disabled:r=!1,...s}=n,o=_I(uq,t),a=aq(t),l=Aq(o.baseId,i),h=fq(o.baseId,i),u=i===o.value;return c.jsx(kYe,{asChild:!0,...a,focusable:!r,active:u,children:c.jsx($1.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":h,"data-state":u?"active":"inactive","data-disabled":r?"":void 0,disabled:r,id:l,...s,ref:e,onMouseDown:gf(n.onMouseDown,d=>{!r&&d.button===0&&d.ctrlKey===!1?o.onValueChange(i):d.preventDefault()}),onKeyDown:gf(n.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&o.onValueChange(i)}),onFocus:gf(n.onFocus,()=>{const d=o.activationMode!=="manual";!u&&!r&&d&&o.onValueChange(i)})})})});Z6.displayName=uq;var dq="TabsContent",LYe=H.forwardRef((n,e)=>{const{__scopeTabs:t,value:i,forceMount:r,children:s,...o}=n,a=_I(dq,t),l=Aq(a.baseId,i),h=fq(a.baseId,i),u=i===a.value,d=H.useRef(u);return H.useEffect(()=>{const A=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(A)},[]),c.jsx(oq,{present:r||u,children:({present:A})=>c.jsx($1.div,{"data-state":u?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":l,hidden:!A,id:h,tabIndex:0,...o,ref:e,style:{...n.style,animationDuration:d.current?"0s":void 0},children:A&&s})})});LYe.displayName=dq;function Aq(n,e){return`${n}-trigger-${e}`}function fq(n,e){return`${n}-content-${e}`}const MYe="_container_14ufn_1",RYe="_viewModeSelector_14ufn_9",UYe="_tabsList_14ufn_20",OYe="_tabTrigger_14ufn_29",HYe="_implementationToggle_14ufn_51",WYe="_toggleLabel_14ufn_58",zYe="_toggleCheckbox_14ufn_67",QYe="_toggleText_14ufn_73",$Ye="_viewerContainer_14ufn_82",Vd={container:MYe,viewModeSelector:RYe,tabsList:UYe,tabTrigger:OYe,implementationToggle:HYe,toggleLabel:WYe,toggleCheckbox:zYe,toggleText:QYe,viewerContainer:$Ye},VYe=({viewMode:n,showDimensions:e=!0,showFurniture:t=!0,showFrame:i=!0,renderMode:r="solid",spaceInfo:s,svgSize:o,isEmbedded:a=!1,isStep2:l=!1,activeZone:h,showAll:u=!0,width:d,height:A,onViewModeChange:f})=>{const p=Wi(),[g,v]=H.useState(n||p.viewMode||"3D"),[w,m]=H.useState(!1),[y,x]=H.useState(Date.now());H.useEffect(()=>{n?v(n):p.viewMode&&v(p.viewMode)},[n,p.viewMode]);const S=j=>{v(j),p.setViewMode(j),x(Date.now()),f&&f(j)},I=()=>{m(!w),x(Date.now())};return c.jsxs("div",{className:Vd.container,children:[c.jsxs("div",{className:Vd.viewModeSelector,children:[c.jsx(lq,{value:g,onValueChange:j=>S(j),children:c.jsxs(hq,{className:Vd.tabsList,children:[c.jsx(Z6,{value:"2D",className:Vd.tabTrigger,children:"2D View"}),c.jsx(Z6,{value:"3D",className:Vd.tabTrigger,children:"3D View"})]})}),g==="2D"&&c.jsx("div",{className:Vd.implementationToggle,children:c.jsxs("label",{className:Vd.toggleLabel,children:[c.jsx("input",{type:"checkbox",checked:w,onChange:I,className:Vd.toggleCheckbox}),c.jsxs("span",{className:Vd.toggleText,children:["Use Konva Canvas ",w?"(Active)":"(Inactive)"]})]})})]}),c.jsx("div",{className:Vd.viewerContainer,children:g==="2D"&&w?c.jsx(bI,{width:d,height:A,viewMode:g,showDimensions:e,showFurniture:t,showGrid:!0},`konva-${y}`):c.jsx(O5,{spaceInfo:s,svgSize:o,viewMode:g,renderMode:r,showAll:u,showFurniture:t,showFrame:i,showDimensions:e,isEmbedded:a,isStep2:l,activeZone:h,setViewMode:S})})]})},GYe="_container_u7544_1",XYe="_header_u7544_10",YYe="_content_u7544_29",KYe="_viewerSection_u7544_37",qYe="_viewerContainer_u7544_56",ZYe="_features_u7544_62",rp={container:GYe,header:XYe,content:YYe,viewerSection:KYe,viewerContainer:qYe,features:ZYe},JYe=()=>{const n=hr(),e=pi();return H.useEffect(()=>{(!n.width||!n.depth)&&n.setSpaceInfo({width:3e3,depth:2e3,height:2400,columns:[{id:"col1",position:{x:500,y:0,z:500},size:100,height:2400},{id:"col2",position:{x:2500,y:0,z:500},size:100,height:2400}],walls:[{id:"wall1",position:{x:0,y:0,z:0},dimensions:{width:3e3,height:2400,depth:100},type:"back"}]}),e.placedModules.length===0&&(e.addModule({id:"furniture1",moduleId:"module1",name:"Cabinet 1",position:{x:800,y:0,z:800},dimensions:{width:600,height:800,depth:400},rotation:0,hasDoors:!0}),e.addModule({id:"furniture2",moduleId:"module2",name:"Cabinet 2",position:{x:1600,y:0,z:1200},dimensions:{width:800,height:900,depth:500},rotation:45,hasDoors:!1}))},[]),c.jsxs("div",{className:rp.container,children:[c.jsxs("div",{className:rp.header,children:[c.jsx("h1",{children:"2D Canvas Viewer Test - React Konva Implementation"}),c.jsx("p",{children:"Test page for the new Konva-based 2D editor"})]}),c.jsxs("div",{className:rp.content,children:[c.jsxs("div",{className:rp.viewerSection,children:[c.jsx("h2",{children:"Standalone Konva Viewer"}),c.jsx("div",{className:rp.viewerContainer,children:c.jsx(bI,{width:800,height:600,viewMode:"2D",showGrid:!0,showDimensions:!0,showFurniture:!0})})]}),c.jsxs("div",{className:rp.viewerSection,children:[c.jsx("h2",{children:"Unified Viewer with Mode Switch"}),c.jsx("div",{className:rp.viewerContainer,children:c.jsx(VYe,{viewMode:"2D",showDimensions:!0,showFurniture:!0,showFrame:!0,renderMode:"solid"})})]})]}),c.jsxs("div",{className:rp.features,children:[c.jsx("h2",{children:"Implemented Features"}),c.jsxs("ul",{children:[c.jsx("li",{children:"✅ Konva.js canvas rendering"}),c.jsx("li",{children:"✅ Furniture drag and drop"}),c.jsx("li",{children:"✅ Zoom and pan controls"}),c.jsx("li",{children:"✅ Grid display with toggle"}),c.jsx("li",{children:"✅ Dimension labels"}),c.jsx("li",{children:"✅ Furniture selection and rotation"}),c.jsx("li",{children:"✅ Column and wall rendering"}),c.jsx("li",{children:"✅ Toolbar with view controls"}),c.jsx("li",{children:"✅ Integration with Zustand stores"}),c.jsx("li",{children:"✅ 2D/3D view mode switching"})]})]})]})},eKe=()=>{const[n,e]=H.useState(0),[t,i]=H.useState(0),[r,s]=H.useState([]);H.useEffect(()=>{const l=()=>{const d=document.querySelectorAll("canvas"),A=document.querySelectorAll(".konvajs-content");i(d.length);const f=`[${new Date().toLocaleTimeString()}] Canvas count: ${d.length}, Konva containers: ${A.length}`;s(p=>[...p.slice(-9),f]),d.length>1&&console.warn("Multiple canvas elements detected!",d)};l();const h=new MutationObserver(()=>{l()});h.observe(document.body,{childList:!0,subtree:!0});const u=()=>{e(d=>d+1),console.log("Orientation change detected"),setTimeout(l,500)};return window.addEventListener("orientationchange",u),window.addEventListener("resize",l),()=>{h.disconnect(),window.removeEventListener("orientationchange",u),window.removeEventListener("resize",l)}},[]);const o=()=>{const l=new Event("resize");window.dispatchEvent(l),setTimeout(()=>{const h=new Event("orientationchange");window.dispatchEvent(h)},100),e(h=>h+1)},a=()=>{s([])};return c.jsxs("div",{style:{width:"100%",height:"100vh",display:"flex",flexDirection:"column"},children:[c.jsxs("div",{style:{padding:"10px",background:"#f0f0f0",borderBottom:"1px solid #ddd",display:"flex",alignItems:"center",gap:"20px",flexShrink:0},children:[c.jsx("h3",{style:{margin:0},children:"Canvas Duplicate Test"}),c.jsx("button",{onClick:o,style:{padding:"5px 10px",background:"#2196F3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Simulate Orientation Change"}),c.jsx("button",{onClick:a,style:{padding:"5px 10px",background:"#666",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Clear Logs"}),c.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:"20px"},children:[c.jsxs("span",{children:["Orientation Changes: ",c.jsx("strong",{children:n})]}),c.jsxs("span",{style:{color:t>1?"red":"green",fontWeight:"bold"},children:["Canvas Count: ",t," ",t>1?"⚠️ DUPLICATE!":"✅"]})]})]}),c.jsx("div",{style:{padding:"10px",background:"#f9f9f9",borderBottom:"1px solid #ddd",maxHeight:"150px",overflowY:"auto",flexShrink:0},children:c.jsx("div",{style:{fontSize:"12px",fontFamily:"monospace"},children:r.length===0?c.jsx("div",{style:{color:"#999"},children:"No logs yet..."}):r.map((l,h)=>c.jsx("div",{style:{marginBottom:"2px"},children:l},h))})}),c.jsx("div",{style:{flex:1,position:"relative",overflow:"hidden"},children:c.jsx(bI,{showGrid:!0,showDimensions:!0,showFurniture:!0})})]})},tKe=H.lazy(()=>rl(()=>import("./ARViewer-Ca8LErvX.js"),__vite__mapDeps([6,1,2,3,4,7])));function nKe(){const n=e5();return H.useEffect(()=>{},[n.pathname]),null}function iKe(){const n=Pl(r=>r.isDirty),e=hr(r=>r.isDirty),t=pi(r=>r.isDirty),i=n||e||t;return H.useEffect(()=>{const r=s=>{const o=window.location.pathname.includes("/configurator");if(i&&o){const a="저장하지 않은 변경사항이 있습니다. 정말로 페이지를 떠나시겠습니까?";return s.preventDefault(),s.returnValue=a,a}};return window.addEventListener("beforeunload",r),()=>{window.removeEventListener("beforeunload",r)}},[i]),c.jsxs(c.Fragment,{children:[c.jsx(nKe,{}),c.jsxs(Vq,{children:[c.jsx(Fa,{path:"/",element:c.jsx(dR,{})}),c.jsx(Fa,{path:"/dashboard",element:c.jsx(cOe,{})}),c.jsx(Fa,{path:"/auth",element:c.jsx(dR,{})}),c.jsx(Fa,{path:"/auth/gradient",element:c.jsx(fHe,{})}),c.jsx(Fa,{path:"/auth/ultra",element:c.jsx(AHe,{})}),c.jsx(Fa,{path:"/auth/modern",element:c.jsx(uHe,{})}),c.jsx(Fa,{path:"/auth/classic",element:c.jsx(hHe,{})}),c.jsx(Fa,{path:"/debug/firebase",element:c.jsx(zHe,{})}),c.jsx(Fa,{path:"/debug/data",element:c.jsx(dWe,{})}),c.jsx(Fa,{path:"/touch-test",element:c.jsx(FWe,{})}),c.jsx(Fa,{path:"/test-2d",element:c.jsx(JYe,{})}),c.jsx(Fa,{path:"/test-canvas",element:c.jsx(eKe,{})}),c.jsx(Fa,{path:"/step1",element:c.jsx(cE,{})}),c.jsx(Fa,{path:"/configurator",element:c.jsx(KIe,{})}),c.jsx(Fa,{path:"/cnc-optimizer",element:c.jsx(AVe,{})}),c.jsx(Fa,{path:"/cnc-test",element:c.jsx(sGe,{})}),c.jsx(Fa,{path:"/step0",element:c.jsx(qv,{to:"/step1",replace:!0})}),c.jsx(Fa,{path:"/step2",element:c.jsx(qv,{to:"/configurator",replace:!0})}),c.jsx(Fa,{path:"/step3",element:c.jsx(qv,{to:"/configurator",replace:!0})}),c.jsx(Fa,{path:"/ar-viewer",element:c.jsx(H.Suspense,{fallback:c.jsx(k1,{fullscreen:!0,message:"Loading AR Viewer..."}),children:c.jsx(tKe,{})})}),c.jsx(Fa,{path:"/viewer/:projectId",element:c.jsx(EOe,{})}),c.jsx(Fa,{path:"*",element:c.jsx(qv,{to:"/dashboard",replace:!0})})]})]})}function rKe(){return H.useEffect(()=>{dk()},[]),c.jsx(yae,{children:c.jsx(ooe,{children:c.jsx(yoe,{children:c.jsx(noe,{children:c.jsx(uae,{children:c.jsx($q,{children:c.jsx(Joe,{children:c.jsx(iKe,{})})})})})})})})}const Ur=n=>typeof n=="string",cy=()=>{let n,e;const t=new Promise((i,r)=>{n=i,e=r});return t.resolve=n,t.reject=e,t},PU=n=>n==null?"":""+n,sKe=(n,e,t)=>{n.forEach(i=>{e[i]&&(t[i]=e[i])})},oKe=/###/g,NU=n=>n&&n.indexOf("###")>-1?n.replace(oKe,"."):n,LU=n=>!n||Ur(n),yw=(n,e,t)=>{const i=Ur(e)?e.split("."):e;let r=0;for(;r<i.length-1;){if(LU(n))return{};const s=NU(i[r]);!n[s]&&t&&(n[s]=new t),Object.prototype.hasOwnProperty.call(n,s)?n=n[s]:n={},++r}return LU(n)?{}:{obj:n,k:NU(i[r])}},MU=(n,e,t)=>{const{obj:i,k:r}=yw(n,e,Object);if(i!==void 0||e.length===1){i[r]=t;return}let s=e[e.length-1],o=e.slice(0,e.length-1),a=yw(n,o,Object);for(;a.obj===void 0&&o.length;)s=`${o[o.length-1]}.${s}`,o=o.slice(0,o.length-1),a=yw(n,o,Object),a!=null&&a.obj&&typeof a.obj[`${a.k}.${s}`]<"u"&&(a.obj=void 0);a.obj[`${a.k}.${s}`]=t},aKe=(n,e,t,i)=>{const{obj:r,k:s}=yw(n,e,Object);r[s]=r[s]||[],r[s].push(t)},K_=(n,e)=>{const{obj:t,k:i}=yw(n,e);if(t&&Object.prototype.hasOwnProperty.call(t,i))return t[i]},lKe=(n,e,t)=>{const i=K_(n,t);return i!==void 0?i:K_(e,t)},pq=(n,e,t)=>{for(const i in e)i!=="__proto__"&&i!=="constructor"&&(i in n?Ur(n[i])||n[i]instanceof String||Ur(e[i])||e[i]instanceof String?t&&(n[i]=e[i]):pq(n[i],e[i],t):n[i]=e[i]);return n},rm=n=>n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var cKe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const hKe=n=>Ur(n)?n.replace(/[&<>"'\/]/g,e=>cKe[e]):n;class uKe{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(t!==void 0)return t;const i=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,i),this.regExpQueue.push(e),i}}const dKe=[" ",",","?","!",";"],AKe=new uKe(20),fKe=(n,e,t)=>{e=e||"",t=t||"";const i=dKe.filter(o=>e.indexOf(o)<0&&t.indexOf(o)<0);if(i.length===0)return!0;const r=AKe.getRegExp(`(${i.map(o=>o==="?"?"\\?":o).join("|")})`);let s=!r.test(n);if(!s){const o=n.indexOf(t);o>0&&!r.test(n.substring(0,o))&&(s=!0)}return s},J6=(n,e,t=".")=>{if(!n)return;if(n[e])return Object.prototype.hasOwnProperty.call(n,e)?n[e]:void 0;const i=e.split(t);let r=n;for(let s=0;s<i.length;){if(!r||typeof r!="object")return;let o,a="";for(let l=s;l<i.length;++l)if(l!==s&&(a+=t),a+=i[l],o=r[a],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&l<i.length-1)continue;s+=l-s+1;break}r=o}return r},Zw=n=>n==null?void 0:n.replace("_","-"),pKe={type:"logger",log(n){this.output("log",n)},warn(n){this.output("warn",n)},error(n){this.output("error",n)},output(n,e){var t,i;(i=(t=console==null?void 0:console[n])==null?void 0:t.apply)==null||i.call(t,console,e)}};class q_{constructor(e,t={}){this.init(e,t)}init(e,t={}){this.prefix=t.prefix||"i18next:",this.logger=e||pKe,this.options=t,this.debug=t.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,i,r){return r&&!this.debug?null:(Ur(e[0])&&(e[0]=`${i}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new q_(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new q_(this.logger,e)}}var sA=new q_;class BS{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(i=>{this.observers[i]||(this.observers[i]=new Map);const r=this.observers[i].get(t)||0;this.observers[i].set(t,r+1)}),this}off(e,t){if(this.observers[e]){if(!t){delete this.observers[e];return}this.observers[e].delete(t)}}emit(e,...t){this.observers[e]&&Array.from(this.observers[e].entries()).forEach(([r,s])=>{for(let o=0;o<s;o++)r(...t)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([r,s])=>{for(let o=0;o<s;o++)r.apply(r,[e,...t])})}}class RU extends BS{constructor(e,t={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,i,r={}){var h,u;const s=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,o=r.ignoreJSONStructure!==void 0?r.ignoreJSONStructure:this.options.ignoreJSONStructure;let a;e.indexOf(".")>-1?a=e.split("."):(a=[e,t],i&&(Array.isArray(i)?a.push(...i):Ur(i)&&s?a.push(...i.split(s)):a.push(i)));const l=K_(this.data,a);return!l&&!t&&!i&&e.indexOf(".")>-1&&(e=a[0],t=a[1],i=a.slice(2).join(".")),l||!o||!Ur(i)?l:J6((u=(h=this.data)==null?void 0:h[e])==null?void 0:u[t],i,s)}addResource(e,t,i,r,s={silent:!1}){const o=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator;let a=[e,t];i&&(a=a.concat(o?i.split(o):i)),e.indexOf(".")>-1&&(a=e.split("."),r=t,t=a[1]),this.addNamespaces(t),MU(this.data,a,r),s.silent||this.emit("added",e,t,i,r)}addResources(e,t,i,r={silent:!1}){for(const s in i)(Ur(i[s])||Array.isArray(i[s]))&&this.addResource(e,t,s,i[s],{silent:!0});r.silent||this.emit("added",e,t,i)}addResourceBundle(e,t,i,r,s,o={silent:!1,skipCopy:!1}){let a=[e,t];e.indexOf(".")>-1&&(a=e.split("."),r=i,i=t,t=a[1]),this.addNamespaces(t);let l=K_(this.data,a)||{};o.skipCopy||(i=JSON.parse(JSON.stringify(i))),r?pq(l,i,s):l={...l,...i},MU(this.data,a,l),o.silent||this.emit("added",e,t,i)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return this.getResource(e,t)!==void 0}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find(r=>t[r]&&Object.keys(t[r]).length>0)}toJSON(){return this.data}}var gq={processors:{},addPostProcessor(n){this.processors[n.name]=n},handle(n,e,t,i,r){return n.forEach(s=>{var o;e=((o=this.processors[s])==null?void 0:o.process(e,t,i,r))??e}),e}};const mq=Symbol("i18next/PATH_KEY");function gKe(){const n=[],e=Object.create(null);let t;return e.get=(i,r)=>{var s;return(s=t==null?void 0:t.revoke)==null||s.call(t),r===mq?n:(n.push(r),t=Proxy.revocable(i,e),t.proxy)},Proxy.revocable(Object.create(null),e).proxy}function eF(n,e){const{[mq]:t}=n(gKe());return t.join((e==null?void 0:e.keySeparator)??".")}const UU={},OU=n=>!Ur(n)&&typeof n!="boolean"&&typeof n!="number";class Z_ extends BS{constructor(e,t={}){super(),sKe(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=sA.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,t={interpolation:{}}){const i={...t};if(e==null)return!1;const r=this.resolve(e,i);return(r==null?void 0:r.res)!==void 0}extractFromKey(e,t){let i=t.nsSeparator!==void 0?t.nsSeparator:this.options.nsSeparator;i===void 0&&(i=":");const r=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator;let s=t.ns||this.options.defaultNS||[];const o=i&&e.indexOf(i)>-1,a=!this.options.userDefinedKeySeparator&&!t.keySeparator&&!this.options.userDefinedNsSeparator&&!t.nsSeparator&&!fKe(e,i,r);if(o&&!a){const l=e.match(this.interpolator.nestingRegexp);if(l&&l.length>0)return{key:e,namespaces:Ur(s)?[s]:s};const h=e.split(i);(i!==r||i===r&&this.options.ns.indexOf(h[0])>-1)&&(s=h.shift()),e=h.join(r)}return{key:e,namespaces:Ur(s)?[s]:s}}translate(e,t,i){let r=typeof t=="object"?{...t}:t;if(typeof r!="object"&&this.options.overloadTranslationOptionHandler&&(r=this.options.overloadTranslationOptionHandler(arguments)),typeof r=="object"&&(r={...r}),r||(r={}),e==null)return"";typeof e=="function"&&(e=eF(e,{...this.options,...r})),Array.isArray(e)||(e=[String(e)]);const s=r.returnDetails!==void 0?r.returnDetails:this.options.returnDetails,o=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,{key:a,namespaces:l}=this.extractFromKey(e[e.length-1],r),h=l[l.length-1];let u=r.nsSeparator!==void 0?r.nsSeparator:this.options.nsSeparator;u===void 0&&(u=":");const d=r.lng||this.language,A=r.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((d==null?void 0:d.toLowerCase())==="cimode")return A?s?{res:`${h}${u}${a}`,usedKey:a,exactUsedKey:a,usedLng:d,usedNS:h,usedParams:this.getUsedParamsDetails(r)}:`${h}${u}${a}`:s?{res:a,usedKey:a,exactUsedKey:a,usedLng:d,usedNS:h,usedParams:this.getUsedParamsDetails(r)}:a;const f=this.resolve(e,r);let p=f==null?void 0:f.res;const g=(f==null?void 0:f.usedKey)||a,v=(f==null?void 0:f.exactUsedKey)||a,w=["[object Number]","[object Function]","[object RegExp]"],m=r.joinArrays!==void 0?r.joinArrays:this.options.joinArrays,y=!this.i18nFormat||this.i18nFormat.handleAsObject,x=r.count!==void 0&&!Ur(r.count),S=Z_.hasDefaultValue(r),I=x?this.pluralResolver.getSuffix(d,r.count,r):"",j=r.ordinal&&x?this.pluralResolver.getSuffix(d,r.count,{ordinal:!1}):"",C=x&&!r.ordinal&&r.count===0,b=C&&r[`defaultValue${this.options.pluralSeparator}zero`]||r[`defaultValue${I}`]||r[`defaultValue${j}`]||r.defaultValue;let D=p;y&&!p&&S&&(D=b);const T=OU(D),k=Object.prototype.toString.apply(D);if(y&&D&&T&&w.indexOf(k)<0&&!(Ur(m)&&Array.isArray(D))){if(!r.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const B=this.options.returnedObjectHandler?this.options.returnedObjectHandler(g,D,{...r,ns:l}):`key '${a} (${this.language})' returned an object instead of string.`;return s?(f.res=B,f.usedParams=this.getUsedParamsDetails(r),f):B}if(o){const B=Array.isArray(D),E=B?[]:{},z=B?v:g;for(const te in D)if(Object.prototype.hasOwnProperty.call(D,te)){const L=`${z}${o}${te}`;S&&!p?E[te]=this.translate(L,{...r,defaultValue:OU(b)?b[te]:void 0,joinArrays:!1,ns:l}):E[te]=this.translate(L,{...r,joinArrays:!1,ns:l}),E[te]===L&&(E[te]=D[te])}p=E}}else if(y&&Ur(m)&&Array.isArray(p))p=p.join(m),p&&(p=this.extendTranslation(p,e,r,i));else{let B=!1,E=!1;!this.isValidLookup(p)&&S&&(B=!0,p=b),this.isValidLookup(p)||(E=!0,p=a);const te=(r.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&E?void 0:p,L=S&&b!==p&&this.options.updateMissing;if(E||B||L){if(this.logger.log(L?"updateKey":"missingKey",d,h,a,L?b:p),o){const U=this.resolve(a,{...r,keySeparator:!1});U&&U.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let O=[];const J=this.languageUtils.getFallbackCodes(this.options.fallbackLng,r.lng||this.language);if(this.options.saveMissingTo==="fallback"&&J&&J[0])for(let U=0;U<J.length;U++)O.push(J[U]);else this.options.saveMissingTo==="all"?O=this.languageUtils.toResolveHierarchy(r.lng||this.language):O.push(r.lng||this.language);const $=(U,Y,K)=>{var Q;const V=S&&K!==p?K:te;this.options.missingKeyHandler?this.options.missingKeyHandler(U,h,Y,V,L,r):(Q=this.backendConnector)!=null&&Q.saveMissing&&this.backendConnector.saveMissing(U,h,Y,V,L,r),this.emit("missingKey",U,h,Y,p)};this.options.saveMissing&&(this.options.saveMissingPlurals&&x?O.forEach(U=>{const Y=this.pluralResolver.getSuffixes(U,r);C&&r[`defaultValue${this.options.pluralSeparator}zero`]&&Y.indexOf(`${this.options.pluralSeparator}zero`)<0&&Y.push(`${this.options.pluralSeparator}zero`),Y.forEach(K=>{$([U],a+K,r[`defaultValue${K}`]||b)})}):$(O,a,b))}p=this.extendTranslation(p,e,r,f,i),E&&p===a&&this.options.appendNamespaceToMissingKey&&(p=`${h}${u}${a}`),(E||B)&&this.options.parseMissingKeyHandler&&(p=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${h}${u}${a}`:a,B?p:void 0,r))}return s?(f.res=p,f.usedParams=this.getUsedParamsDetails(r),f):p}extendTranslation(e,t,i,r,s){var l,h;if((l=this.i18nFormat)!=null&&l.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...i},i.lng||this.language||r.usedLng,r.usedNS,r.usedKey,{resolved:r});else if(!i.skipInterpolation){i.interpolation&&this.interpolator.init({...i,interpolation:{...this.options.interpolation,...i.interpolation}});const u=Ur(e)&&(((h=i==null?void 0:i.interpolation)==null?void 0:h.skipOnVariables)!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let d;if(u){const f=e.match(this.interpolator.nestingRegexp);d=f&&f.length}let A=i.replace&&!Ur(i.replace)?i.replace:i;if(this.options.interpolation.defaultVariables&&(A={...this.options.interpolation.defaultVariables,...A}),e=this.interpolator.interpolate(e,A,i.lng||this.language||r.usedLng,i),u){const f=e.match(this.interpolator.nestingRegexp),p=f&&f.length;d<p&&(i.nest=!1)}!i.lng&&r&&r.res&&(i.lng=this.language||r.usedLng),i.nest!==!1&&(e=this.interpolator.nest(e,(...f)=>(s==null?void 0:s[0])===f[0]&&!i.context?(this.logger.warn(`It seems you are nesting recursively key: ${f[0]} in key: ${t[0]}`),null):this.translate(...f,t),i)),i.interpolation&&this.interpolator.reset()}const o=i.postProcess||this.options.postProcess,a=Ur(o)?[o]:o;return e!=null&&(a!=null&&a.length)&&i.applyPostProcessor!==!1&&(e=gq.handle(a,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...r,usedParams:this.getUsedParamsDetails(i)},...i}:i,this)),e}resolve(e,t={}){let i,r,s,o,a;return Ur(e)&&(e=[e]),e.forEach(l=>{if(this.isValidLookup(i))return;const h=this.extractFromKey(l,t),u=h.key;r=u;let d=h.namespaces;this.options.fallbackNS&&(d=d.concat(this.options.fallbackNS));const A=t.count!==void 0&&!Ur(t.count),f=A&&!t.ordinal&&t.count===0,p=t.context!==void 0&&(Ur(t.context)||typeof t.context=="number")&&t.context!=="",g=t.lngs?t.lngs:this.languageUtils.toResolveHierarchy(t.lng||this.language,t.fallbackLng);d.forEach(v=>{var w,m;this.isValidLookup(i)||(a=v,!UU[`${g[0]}-${v}`]&&((w=this.utils)!=null&&w.hasLoadedNamespace)&&!((m=this.utils)!=null&&m.hasLoadedNamespace(a))&&(UU[`${g[0]}-${v}`]=!0,this.logger.warn(`key "${r}" for languages "${g.join(", ")}" won't get resolved as namespace "${a}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),g.forEach(y=>{var I;if(this.isValidLookup(i))return;o=y;const x=[u];if((I=this.i18nFormat)!=null&&I.addLookupKeys)this.i18nFormat.addLookupKeys(x,u,y,v,t);else{let j;A&&(j=this.pluralResolver.getSuffix(y,t.count,t));const C=`${this.options.pluralSeparator}zero`,b=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(A&&(t.ordinal&&j.indexOf(b)===0&&x.push(u+j.replace(b,this.options.pluralSeparator)),x.push(u+j),f&&x.push(u+C)),p){const D=`${u}${this.options.contextSeparator||"_"}${t.context}`;x.push(D),A&&(t.ordinal&&j.indexOf(b)===0&&x.push(D+j.replace(b,this.options.pluralSeparator)),x.push(D+j),f&&x.push(D+C))}}let S;for(;S=x.pop();)this.isValidLookup(i)||(s=S,i=this.getResource(y,v,S,t))}))})}),{res:i,usedKey:r,exactUsedKey:s,usedLng:o,usedNS:a}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,t,i,r={}){var s;return(s=this.i18nFormat)!=null&&s.getResource?this.i18nFormat.getResource(e,t,i,r):this.resourceStore.getResource(e,t,i,r)}getUsedParamsDetails(e={}){const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],i=e.replace&&!Ur(e.replace);let r=i?e.replace:e;if(i&&typeof e.count<"u"&&(r.count=e.count),this.options.interpolation.defaultVariables&&(r={...this.options.interpolation.defaultVariables,...r}),!i){r={...r};for(const s of t)delete r[s]}return r}static hasDefaultValue(e){const t="defaultValue";for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&t===i.substring(0,t.length)&&e[i]!==void 0)return!0;return!1}}class HU{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=sA.create("languageUtils")}getScriptPartFromCode(e){if(e=Zw(e),!e||e.indexOf("-")<0)return null;const t=e.split("-");return t.length===2||(t.pop(),t[t.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(t.join("-"))}getLanguagePartFromCode(e){if(e=Zw(e),!e||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(Ur(e)&&e.indexOf("-")>-1){let t;try{t=Intl.getCanonicalLocales(e)[0]}catch{}return t&&this.options.lowerCaseLng&&(t=t.toLowerCase()),t||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach(i=>{if(t)return;const r=this.formatLanguageCode(i);(!this.options.supportedLngs||this.isSupportedCode(r))&&(t=r)}),!t&&this.options.supportedLngs&&e.forEach(i=>{if(t)return;const r=this.getScriptPartFromCode(i);if(this.isSupportedCode(r))return t=r;const s=this.getLanguagePartFromCode(i);if(this.isSupportedCode(s))return t=s;t=this.options.supportedLngs.find(o=>{if(o===s)return o;if(!(o.indexOf("-")<0&&s.indexOf("-")<0)&&(o.indexOf("-")>0&&s.indexOf("-")<0&&o.substring(0,o.indexOf("-"))===s||o.indexOf(s)===0&&s.length>1))return o})}),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if(typeof e=="function"&&(e=e(t)),Ur(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let i=e[t];return i||(i=e[this.getScriptPartFromCode(t)]),i||(i=e[this.formatLanguageCode(t)]),i||(i=e[this.getLanguagePartFromCode(t)]),i||(i=e.default),i||[]}toResolveHierarchy(e,t){const i=this.getFallbackCodes((t===!1?[]:t)||this.options.fallbackLng||[],e),r=[],s=o=>{o&&(this.isSupportedCode(o)?r.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return Ur(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&s(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&s(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&s(this.getLanguagePartFromCode(e))):Ur(e)&&s(this.formatLanguageCode(e)),i.forEach(o=>{r.indexOf(o)<0&&s(this.formatLanguageCode(o))}),r}}const WU={zero:0,one:1,two:2,few:3,many:4,other:5},zU={select:n=>n===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class mKe{constructor(e,t={}){this.languageUtils=e,this.options=t,this.logger=sA.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e,t={}){const i=Zw(e==="dev"?"en":e),r=t.ordinal?"ordinal":"cardinal",s=JSON.stringify({cleanedCode:i,type:r});if(s in this.pluralRulesCache)return this.pluralRulesCache[s];let o;try{o=new Intl.PluralRules(i,{type:r})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),zU;if(!e.match(/-|_/))return zU;const l=this.languageUtils.getLanguagePartFromCode(e);o=this.getRule(l,t)}return this.pluralRulesCache[s]=o,o}needsPlural(e,t={}){let i=this.getRule(e,t);return i||(i=this.getRule("dev",t)),(i==null?void 0:i.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(e,t,i={}){return this.getSuffixes(e,i).map(r=>`${t}${r}`)}getSuffixes(e,t={}){let i=this.getRule(e,t);return i||(i=this.getRule("dev",t)),i?i.resolvedOptions().pluralCategories.sort((r,s)=>WU[r]-WU[s]).map(r=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${r}`):[]}getSuffix(e,t,i={}){const r=this.getRule(e,i);return r?`${this.options.prepend}${i.ordinal?`ordinal${this.options.prepend}`:""}${r.select(t)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",t,i))}}const QU=(n,e,t,i=".",r=!0)=>{let s=lKe(n,e,t);return!s&&r&&Ur(t)&&(s=J6(n,t,i),s===void 0&&(s=J6(e,t,i))),s},fB=n=>n.replace(/\$/g,"$$$$");class yKe{constructor(e={}){var t;this.logger=sA.create("interpolator"),this.options=e,this.format=((t=e==null?void 0:e.interpolation)==null?void 0:t.format)||(i=>i),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:i,useRawValueToEscape:r,prefix:s,prefixEscaped:o,suffix:a,suffixEscaped:l,formatSeparator:h,unescapeSuffix:u,unescapePrefix:d,nestingPrefix:A,nestingPrefixEscaped:f,nestingSuffix:p,nestingSuffixEscaped:g,nestingOptionsSeparator:v,maxReplaces:w,alwaysFormat:m}=e.interpolation;this.escape=t!==void 0?t:hKe,this.escapeValue=i!==void 0?i:!0,this.useRawValueToEscape=r!==void 0?r:!1,this.prefix=s?rm(s):o||"{{",this.suffix=a?rm(a):l||"}}",this.formatSeparator=h||",",this.unescapePrefix=u?"":d||"-",this.unescapeSuffix=this.unescapePrefix?"":u||"",this.nestingPrefix=A?rm(A):f||rm("$t("),this.nestingSuffix=p?rm(p):g||rm(")"),this.nestingOptionsSeparator=v||",",this.maxReplaces=w||1e3,this.alwaysFormat=m!==void 0?m:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(t,i)=>(t==null?void 0:t.source)===i?(t.lastIndex=0,t):new RegExp(i,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(e,t,i,r){var f;let s,o,a;const l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},h=p=>{if(p.indexOf(this.formatSeparator)<0){const m=QU(t,l,p,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(m,void 0,i,{...r,...t,interpolationkey:p}):m}const g=p.split(this.formatSeparator),v=g.shift().trim(),w=g.join(this.formatSeparator).trim();return this.format(QU(t,l,v,this.options.keySeparator,this.options.ignoreJSONStructure),w,i,{...r,...t,interpolationkey:v})};this.resetRegExp();const u=(r==null?void 0:r.missingInterpolationHandler)||this.options.missingInterpolationHandler,d=((f=r==null?void 0:r.interpolation)==null?void 0:f.skipOnVariables)!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:p=>fB(p)},{regex:this.regexp,safeValue:p=>this.escapeValue?fB(this.escape(p)):fB(p)}].forEach(p=>{for(a=0;s=p.regex.exec(e);){const g=s[1].trim();if(o=h(g),o===void 0)if(typeof u=="function"){const w=u(e,s,r);o=Ur(w)?w:""}else if(r&&Object.prototype.hasOwnProperty.call(r,g))o="";else if(d){o=s[0];continue}else this.logger.warn(`missed to pass in variable ${g} for interpolating ${e}`),o="";else!Ur(o)&&!this.useRawValueToEscape&&(o=PU(o));const v=p.safeValue(o);if(e=e.replace(s[0],v),d?(p.regex.lastIndex+=o.length,p.regex.lastIndex-=s[0].length):p.regex.lastIndex=0,a++,a>=this.maxReplaces)break}}),e}nest(e,t,i={}){let r,s,o;const a=(l,h)=>{const u=this.nestingOptionsSeparator;if(l.indexOf(u)<0)return l;const d=l.split(new RegExp(`${u}[ ]*{`));let A=`{${d[1]}`;l=d[0],A=this.interpolate(A,o);const f=A.match(/'/g),p=A.match(/"/g);(((f==null?void 0:f.length)??0)%2===0&&!p||p.length%2!==0)&&(A=A.replace(/'/g,'"'));try{o=JSON.parse(A),h&&(o={...h,...o})}catch(g){return this.logger.warn(`failed parsing options string in nesting for key ${l}`,g),`${l}${u}${A}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,l};for(;r=this.nestingRegexp.exec(e);){let l=[];o={...i},o=o.replace&&!Ur(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;const h=/{.*}/.test(r[1])?r[1].lastIndexOf("}")+1:r[1].indexOf(this.formatSeparator);if(h!==-1&&(l=r[1].slice(h).split(this.formatSeparator).map(u=>u.trim()).filter(Boolean),r[1]=r[1].slice(0,h)),s=t(a.call(this,r[1].trim(),o),o),s&&r[0]===e&&!Ur(s))return s;Ur(s)||(s=PU(s)),s||(this.logger.warn(`missed to resolve ${r[1]} for nesting ${e}`),s=""),l.length&&(s=l.reduce((u,d)=>this.format(u,d,i.lng,{...i,interpolationkey:r[1].trim()}),s.trim())),e=e.replace(r[0],s),this.regexp.lastIndex=0}return e}}const wKe=n=>{let e=n.toLowerCase().trim();const t={};if(n.indexOf("(")>-1){const i=n.split("(");e=i[0].toLowerCase().trim();const r=i[1].substring(0,i[1].length-1);e==="currency"&&r.indexOf(":")<0?t.currency||(t.currency=r.trim()):e==="relativetime"&&r.indexOf(":")<0?t.range||(t.range=r.trim()):r.split(";").forEach(o=>{if(o){const[a,...l]=o.split(":"),h=l.join(":").trim().replace(/^'+|'+$/g,""),u=a.trim();t[u]||(t[u]=h),h==="false"&&(t[u]=!1),h==="true"&&(t[u]=!0),isNaN(h)||(t[u]=parseInt(h,10))}})}return{formatName:e,formatOptions:t}},$U=n=>{const e={};return(t,i,r)=>{let s=r;r&&r.interpolationkey&&r.formatParams&&r.formatParams[r.interpolationkey]&&r[r.interpolationkey]&&(s={...s,[r.interpolationkey]:void 0});const o=i+JSON.stringify(s);let a=e[o];return a||(a=n(Zw(i),r),e[o]=a),a(t)}},vKe=n=>(e,t,i)=>n(Zw(t),i)(e);class xKe{constructor(e={}){this.logger=sA.create("formatter"),this.options=e,this.init(e)}init(e,t={interpolation:{}}){this.formatSeparator=t.interpolation.formatSeparator||",";const i=t.cacheInBuiltFormats?$U:vKe;this.formats={number:i((r,s)=>{const o=new Intl.NumberFormat(r,{...s});return a=>o.format(a)}),currency:i((r,s)=>{const o=new Intl.NumberFormat(r,{...s,style:"currency"});return a=>o.format(a)}),datetime:i((r,s)=>{const o=new Intl.DateTimeFormat(r,{...s});return a=>o.format(a)}),relativetime:i((r,s)=>{const o=new Intl.RelativeTimeFormat(r,{...s});return a=>o.format(a,s.range||"day")}),list:i((r,s)=>{const o=new Intl.ListFormat(r,{...s});return a=>o.format(a)})}}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=$U(t)}format(e,t,i,r={}){const s=t.split(this.formatSeparator);if(s.length>1&&s[0].indexOf("(")>1&&s[0].indexOf(")")<0&&s.find(a=>a.indexOf(")")>-1)){const a=s.findIndex(l=>l.indexOf(")")>-1);s[0]=[s[0],...s.splice(1,a)].join(this.formatSeparator)}return s.reduce((a,l)=>{var d;const{formatName:h,formatOptions:u}=wKe(l);if(this.formats[h]){let A=a;try{const f=((d=r==null?void 0:r.formatParams)==null?void 0:d[r.interpolationkey])||{},p=f.locale||f.lng||r.locale||r.lng||i;A=this.formats[h](a,p,{...u,...r,...f})}catch(f){this.logger.warn(f)}return A}else this.logger.warn(`there was no format function for ${h}`);return a},e)}}const bKe=(n,e)=>{n.pending[e]!==void 0&&(delete n.pending[e],n.pendingCount--)};class CKe extends BS{constructor(e,t,i,r={}){var s,o;super(),this.backend=e,this.store=t,this.services=i,this.languageUtils=i.languageUtils,this.options=r,this.logger=sA.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=r.maxParallelReads||10,this.readingCalls=0,this.maxRetries=r.maxRetries>=0?r.maxRetries:5,this.retryTimeout=r.retryTimeout>=1?r.retryTimeout:350,this.state={},this.queue=[],(o=(s=this.backend)==null?void 0:s.init)==null||o.call(s,i,r.backend,r)}queueLoad(e,t,i,r){const s={},o={},a={},l={};return e.forEach(h=>{let u=!0;t.forEach(d=>{const A=`${h}|${d}`;!i.reload&&this.store.hasResourceBundle(h,d)?this.state[A]=2:this.state[A]<0||(this.state[A]===1?o[A]===void 0&&(o[A]=!0):(this.state[A]=1,u=!1,o[A]===void 0&&(o[A]=!0),s[A]===void 0&&(s[A]=!0),l[d]===void 0&&(l[d]=!0)))}),u||(a[h]=!0)}),(Object.keys(s).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:r}),{toLoad:Object.keys(s),pending:Object.keys(o),toLoadLanguages:Object.keys(a),toLoadNamespaces:Object.keys(l)}}loaded(e,t,i){const r=e.split("|"),s=r[0],o=r[1];t&&this.emit("failedLoading",s,o,t),!t&&i&&this.store.addResourceBundle(s,o,i,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&i&&(this.state[e]=0);const a={};this.queue.forEach(l=>{aKe(l.loaded,[s],o),bKe(l,e),t&&l.errors.push(t),l.pendingCount===0&&!l.done&&(Object.keys(l.loaded).forEach(h=>{a[h]||(a[h]={});const u=l.loaded[h];u.length&&u.forEach(d=>{a[h][d]===void 0&&(a[h][d]=!0)})}),l.done=!0,l.errors.length?l.callback(l.errors):l.callback())}),this.emit("loaded",a),this.queue=this.queue.filter(l=>!l.done)}read(e,t,i,r=0,s=this.retryTimeout,o){if(!e.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:t,fcName:i,tried:r,wait:s,callback:o});return}this.readingCalls++;const a=(h,u)=>{if(this.readingCalls--,this.waitingReads.length>0){const d=this.waitingReads.shift();this.read(d.lng,d.ns,d.fcName,d.tried,d.wait,d.callback)}if(h&&u&&r<this.maxRetries){setTimeout(()=>{this.read.call(this,e,t,i,r+1,s*2,o)},s);return}o(h,u)},l=this.backend[i].bind(this.backend);if(l.length===2){try{const h=l(e,t);h&&typeof h.then=="function"?h.then(u=>a(null,u)).catch(a):a(null,h)}catch(h){a(h)}return}return l(e,t,a)}prepareLoading(e,t,i={},r){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),r&&r();Ur(e)&&(e=this.languageUtils.toResolveHierarchy(e)),Ur(t)&&(t=[t]);const s=this.queueLoad(e,t,i,r);if(!s.toLoad.length)return s.pending.length||r(),null;s.toLoad.forEach(o=>{this.loadOne(o)})}load(e,t,i){this.prepareLoading(e,t,{},i)}reload(e,t,i){this.prepareLoading(e,t,{reload:!0},i)}loadOne(e,t=""){const i=e.split("|"),r=i[0],s=i[1];this.read(r,s,"read",void 0,void 0,(o,a)=>{o&&this.logger.warn(`${t}loading namespace ${s} for language ${r} failed`,o),!o&&a&&this.logger.log(`${t}loaded namespace ${s} for language ${r}`,a),this.loaded(e,o,a)})}saveMissing(e,t,i,r,s,o={},a=()=>{}){var l,h,u,d,A;if((h=(l=this.services)==null?void 0:l.utils)!=null&&h.hasLoadedNamespace&&!((d=(u=this.services)==null?void 0:u.utils)!=null&&d.hasLoadedNamespace(t))){this.logger.warn(`did not save key "${i}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(i==null||i==="")){if((A=this.backend)!=null&&A.create){const f={...o,isUpdate:s},p=this.backend.create.bind(this.backend);if(p.length<6)try{let g;p.length===5?g=p(e,t,i,r,f):g=p(e,t,i,r),g&&typeof g.then=="function"?g.then(v=>a(null,v)).catch(a):a(null,g)}catch(g){a(g)}else p(e,t,i,r,a,f)}!e||!e[0]||this.store.addResource(e[0],t,i,r)}}}const VU=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:n=>{let e={};if(typeof n[1]=="object"&&(e=n[1]),Ur(n[1])&&(e.defaultValue=n[1]),Ur(n[2])&&(e.tDescription=n[2]),typeof n[2]=="object"||typeof n[3]=="object"){const t=n[3]||n[2];Object.keys(t).forEach(i=>{e[i]=t[i]})}return e},interpolation:{escapeValue:!0,format:n=>n,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),GU=n=>{var e,t;return Ur(n.ns)&&(n.ns=[n.ns]),Ur(n.fallbackLng)&&(n.fallbackLng=[n.fallbackLng]),Ur(n.fallbackNS)&&(n.fallbackNS=[n.fallbackNS]),((t=(e=n.supportedLngs)==null?void 0:e.indexOf)==null?void 0:t.call(e,"cimode"))<0&&(n.supportedLngs=n.supportedLngs.concat(["cimode"])),typeof n.initImmediate=="boolean"&&(n.initAsync=n.initImmediate),n},$b=()=>{},_Ke=n=>{Object.getOwnPropertyNames(Object.getPrototypeOf(n)).forEach(t=>{typeof n[t]=="function"&&(n[t]=n[t].bind(n))})};class Jw extends BS{constructor(e={},t){if(super(),this.options=GU(e),this.services={},this.logger=sA,this.modules={external:[]},_Ke(this),t&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,t),this;setTimeout(()=>{this.init(e,t)},0)}}init(e={},t){this.isInitializing=!0,typeof e=="function"&&(t=e,e={}),e.defaultNS==null&&e.ns&&(Ur(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const i=VU();this.options={...i,...this.options,...GU(e)},this.options.interpolation={...i.interpolation,...this.options.interpolation},e.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=e.keySeparator),e.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=e.nsSeparator);const r=h=>h?typeof h=="function"?new h:h:null;if(!this.options.isClone){this.modules.logger?sA.init(r(this.modules.logger),this.options):sA.init(null,this.options);let h;this.modules.formatter?h=this.modules.formatter:h=xKe;const u=new HU(this.options);this.store=new RU(this.options.resources,this.options);const d=this.services;d.logger=sA,d.resourceStore=this.store,d.languageUtils=u,d.pluralResolver=new mKe(u,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==i.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),h&&(!this.options.interpolation.format||this.options.interpolation.format===i.interpolation.format)&&(d.formatter=r(h),d.formatter.init&&d.formatter.init(d,this.options),this.options.interpolation.format=d.formatter.format.bind(d.formatter)),d.interpolator=new yKe(this.options),d.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},d.backendConnector=new CKe(r(this.modules.backend),d.resourceStore,d,this.options),d.backendConnector.on("*",(f,...p)=>{this.emit(f,...p)}),this.modules.languageDetector&&(d.languageDetector=r(this.modules.languageDetector),d.languageDetector.init&&d.languageDetector.init(d,this.options.detection,this.options)),this.modules.i18nFormat&&(d.i18nFormat=r(this.modules.i18nFormat),d.i18nFormat.init&&d.i18nFormat.init(this)),this.translator=new Z_(this.services,this.options),this.translator.on("*",(f,...p)=>{this.emit(f,...p)}),this.modules.external.forEach(f=>{f.init&&f.init(this)})}if(this.format=this.options.interpolation.format,t||(t=$b),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const h=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);h.length>0&&h[0]!=="dev"&&(this.options.lng=h[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(h=>{this[h]=(...u)=>this.store[h](...u)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(h=>{this[h]=(...u)=>(this.store[h](...u),this)});const a=cy(),l=()=>{const h=(u,d)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),a.resolve(d),t(u,d)};if(this.languages&&!this.isInitialized)return h(null,this.t.bind(this));this.changeLanguage(this.options.lng,h)};return this.options.resources||!this.options.initAsync?l():setTimeout(l,0),a}loadResources(e,t=$b){var s,o;let i=t;const r=Ur(e)?e:this.language;if(typeof e=="function"&&(i=e),!this.options.resources||this.options.partialBundledLanguages){if((r==null?void 0:r.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return i();const a=[],l=h=>{if(!h||h==="cimode")return;this.services.languageUtils.toResolveHierarchy(h).forEach(d=>{d!=="cimode"&&a.indexOf(d)<0&&a.push(d)})};r?l(r):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(u=>l(u)),(o=(s=this.options.preload)==null?void 0:s.forEach)==null||o.call(s,h=>l(h)),this.services.backendConnector.load(a,this.options.ns,h=>{!h&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),i(h)})}else i(null)}reloadResources(e,t,i){const r=cy();return typeof e=="function"&&(i=e,e=void 0),typeof t=="function"&&(i=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),i||(i=$b),this.services.backendConnector.reload(e,t,s=>{r.resolve(),i(s)}),r}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&gq.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1)){for(let t=0;t<this.languages.length;t++){const i=this.languages[t];if(!(["cimode","dev"].indexOf(i)>-1)&&this.store.hasLanguageSomeTranslations(i)){this.resolvedLanguage=i;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,t){this.isLanguageChangingTo=e;const i=cy();this.emit("languageChanging",e);const r=a=>{this.language=a,this.languages=this.services.languageUtils.toResolveHierarchy(a),this.resolvedLanguage=void 0,this.setResolvedLanguage(a)},s=(a,l)=>{l?this.isLanguageChangingTo===e&&(r(l),this.translator.changeLanguage(l),this.isLanguageChangingTo=void 0,this.emit("languageChanged",l),this.logger.log("languageChanged",l)):this.isLanguageChangingTo=void 0,i.resolve((...h)=>this.t(...h)),t&&t(a,(...h)=>this.t(...h))},o=a=>{var u,d;!e&&!a&&this.services.languageDetector&&(a=[]);const l=Ur(a)?a:a&&a[0],h=this.store.hasLanguageSomeTranslations(l)?l:this.services.languageUtils.getBestMatchFromCodes(Ur(a)?[a]:a);h&&(this.language||r(h),this.translator.language||this.translator.changeLanguage(h),(d=(u=this.services.languageDetector)==null?void 0:u.cacheUserLanguage)==null||d.call(u,h)),this.loadResources(h,A=>{s(A,h)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?o(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(e),i}getFixedT(e,t,i){const r=(s,o,...a)=>{let l;typeof o!="object"?l=this.options.overloadTranslationOptionHandler([s,o].concat(a)):l={...o},l.lng=l.lng||r.lng,l.lngs=l.lngs||r.lngs,l.ns=l.ns||r.ns,l.keyPrefix!==""&&(l.keyPrefix=l.keyPrefix||i||r.keyPrefix);const h=this.options.keySeparator||".";let u;return l.keyPrefix&&Array.isArray(s)?u=s.map(d=>(typeof d=="function"&&(d=eF(d,{...this.options,...o})),`${l.keyPrefix}${h}${d}`)):(typeof s=="function"&&(s=eF(s,{...this.options,...o})),u=l.keyPrefix?`${l.keyPrefix}${h}${s}`:s),this.t(u,l)};return Ur(e)?r.lng=e:r.lngs=e,r.ns=t,r.keyPrefix=i,r}t(...e){var t;return(t=this.translator)==null?void 0:t.translate(...e)}exists(...e){var t;return(t=this.translator)==null?void 0:t.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,t={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const i=t.lng||this.resolvedLanguage||this.languages[0],r=this.options?this.options.fallbackLng:!1,s=this.languages[this.languages.length-1];if(i.toLowerCase()==="cimode")return!0;const o=(a,l)=>{const h=this.services.backendConnector.state[`${a}|${l}`];return h===-1||h===0||h===2};if(t.precheck){const a=t.precheck(this,o);if(a!==void 0)return a}return!!(this.hasResourceBundle(i,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(i,e)&&(!r||o(s,e)))}loadNamespaces(e,t){const i=cy();return this.options.ns?(Ur(e)&&(e=[e]),e.forEach(r=>{this.options.ns.indexOf(r)<0&&this.options.ns.push(r)}),this.loadResources(r=>{i.resolve(),t&&t(r)}),i):(t&&t(),Promise.resolve())}loadLanguages(e,t){const i=cy();Ur(e)&&(e=[e]);const r=this.options.preload||[],s=e.filter(o=>r.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return s.length?(this.options.preload=r.concat(s),this.loadResources(o=>{i.resolve(),t&&t(o)}),i):(t&&t(),Promise.resolve())}dir(e){var r,s;if(e||(e=this.resolvedLanguage||(((r=this.languages)==null?void 0:r.length)>0?this.languages[0]:this.language)),!e)return"rtl";try{const o=new Intl.Locale(e);if(o&&o.getTextInfo){const a=o.getTextInfo();if(a&&a.direction)return a.direction}}catch{}const t=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],i=((s=this.services)==null?void 0:s.languageUtils)||new HU(VU());return e.toLowerCase().indexOf("-latn")>1?"ltr":t.indexOf(i.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},t){return new Jw(e,t)}cloneInstance(e={},t=$b){const i=e.forkResourceStore;i&&delete e.forkResourceStore;const r={...this.options,...e,isClone:!0},s=new Jw(r);if((e.debug!==void 0||e.prefix!==void 0)&&(s.logger=s.logger.clone(e)),["store","services","language"].forEach(a=>{s[a]=this[a]}),s.services={...this.services},s.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},i){const a=Object.keys(this.store.data).reduce((l,h)=>(l[h]={...this.store.data[h]},l[h]=Object.keys(l[h]).reduce((u,d)=>(u[d]={...l[h][d]},u),l[h]),l),{});s.store=new RU(a,r),s.services.resourceStore=s.store}return s.translator=new Z_(s.services,r),s.translator.on("*",(a,...l)=>{s.emit(a,...l)}),s.init(r,t),s.translator.options=r,s.translator.backendConnector.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},s}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Gc=Jw.createInstance();Gc.createInstance=Jw.createInstance;Gc.createInstance;Gc.dir;Gc.init;Gc.loadResources;Gc.reloadResources;Gc.use;Gc.changeLanguage;Gc.getFixedT;Gc.t;Gc.exists;Gc.setDefaultNamespace;Gc.hasLoadedNamespace;Gc.loadNamespaces;Gc.loadLanguages;const SKe={save:"저장",cancel:"취소",delete:"삭제",edit:"편집",add:"추가",remove:"제거",confirm:"확인",close:"닫기",back:"뒤로",next:"다음",finish:"완료",apply:"적용",reset:"초기화",search:"검색",loading:"로딩 중...",error:"오류",success:"성공",warning:"경고",info:"정보",undo:"실행취소",redo:"다시실행",copy:"복사",paste:"붙여넣기",file:"파일",saving:"저장 중...",help:"도움말",controls:"조작법",converting:"컨버팅",logout:"로그아웃",login:"로그인",none:"없음",enabled:"있음",unit:"단위"},TKe={title:"설정",general:"일반 설정",language:"언어",languageDesc:"인터페이스 언어 설정",theme:"테마",themeDesc:"테마 설정",themeSettings:"테마 설정",displayMode:"표시 모드",themeColor:"테마 색상",lightMode:"라이트 모드",darkMode:"다크 모드",notifications:"알림",notificationsDesc:"새로운 업데이트 및 알림 받기",autoSave:"자동 저장",autoSaveDesc:"변경사항을 자동으로 저장",gridSnap:"그리드 스냅",gridSnapDesc:"오브젝트를 그리드에 자동 정렬",shortcuts:"키보드 단축키",version:"버전",lastUpdate:"최종 업데이트",info:"정보"},BKe={title:"공간 설정",width:"너비",height:"높이",depth:"깊이",installType:"설치 타입",builtin:"양쪽벽",builtinDesc:"양쪽 벽이 막혀있는 기본형식",semistanding:"한쪽벽",semistandingDesc:"한쪽만 벽으로 막혀있고 한쪽은 오픈된 형식",freestanding:"벽없음",freestandingDesc:"양쪽 벽이 없는 독립형 형식",wallPosition:"벽 위치",standing:"스탠딩",semiStanding:"세미스탠딩",wallMount:"벽걸이",surroundType:"서라운드 타입",surround:"서라운드",noSurround:"노서라운드",columnCount:"컬럼 수",doorCount:"도어 개수",droppedCeiling:"단내림",droppedCeilingEnabled:"단내림 사용",droppedCeilingHeight:"단내림 높이",droppedCeilingWidth:"단내림 너비",mainSection:"메인구간",droppedSection:"단내림구간",mainSectionSize:"메인구간 사이즈",droppedSectionSize:"단내림 구간 사이즈",droppedColumnCount:"단내림 컬럼수",floorFinish:"바닥 마감",floorFinishThickness:"두께",totalWidth:"전체 너비"},EKe={title:"프레임 설정",frameWidth:"프레임 폭",leftFrame:"좌측 프레임",rightFrame:"우측 프레임",topFrame:"상부 프레임",baseFrame:"베이스 프레임",endPanel:"엔드패널",subFrame:"서브프레임",frameOptions:"프레임 옵션",withFrame:"프레임 있음",withoutFrame:"프레임 없음",properties:"프레임 속성",baseHeight:"받침대 높이",floatHeight:"띄움 높이"},FKe={title:"가구",upperCabinet:"상부장",lowerCabinet:"하부장",tallCabinet:"키큰장",dualCabinet:"듀얼장",singleCabinet:"싱글장",backPanel:"백패널",gapBackPanel:"상하부장 사이 백패널",door:"도어",drawer:"서랍",shelf:"선반",handle:"핸들",hinge:"경첩",hingePosition:"경첩 위치",left:"좌측",right:"우측",moduleLibrary:"모듈 라이브러리",placedModules:"배치된 모듈",moduleProperties:"모듈 속성",customWidth:"사용자 정의 너비",customHeight:"사용자 정의 높이",customDepth:"사용자 정의 깊이",all:"전체",single:"싱글",dual:"듀얼",moduleNotReady:"모듈은 아직 준비 중입니다",noModulesAvailable:"이 유형에 맞는 가구가 없습니다",editFurniture:"가구 편집",viewDetails:"상세보기",panelDetails:"패널 상세 정보",widthSettings:"너비 설정",depthSettings:"깊이 설정",range:"범위",doorSettings:"도어 유무",hingeDirection:"경첩 방향",openToRight:"오른쪽으로 열림",openToLeft:"왼쪽으로 열림",coverDoorNote:"커버도어는 경첩 위치 변경이 불가합니다",gapBackPanelSettings:"상하부장 사이 백패널",backPanelAlreadySet:"이미 같은 슬롯의 {{position}}에서 백패널이 설정되어 있습니다.",minValue:"최소 {{value}}mm 이상이어야 합니다",maxValue:"최대 {{value}}mm 이하여야 합니다",upperSection:"상부 섹션",lowerSection:"하부 섹션",leftPanel:"좌측판",rightPanel:"우측판",topPanel:"상판",bottomPanel:"하판",frontPanel:"앞판",handlePlate:"손잡이판",drawerDivider:"서랍 칸막이"},kKe={title:"배치 설정",properties:"배치 속성",placementType:"배치 타입",droppedCeilingPosition:"단내림 위치",floor:"바닥 배치",float:"띄워서 배치",floatHeight:"띄움 높이",gap:"간격",leftGap:"좌측",rightGap:"우측",topGap:"상부 간격",bottomGap:"하부 간격",wallOffset:"이격거리 설정",noWall:"벽 없음"},IKe={title:"재질 설정",floorFinish:"바닥 마감재",woodGrain:"목재 무늬",solid:"단색",metallic:"금속",glass:"유리",matte:"무광",glossy:"유광",texture:"텍스처",color:"색상",finish:"마감",white:"화이트",melamine:"멜라민",premium:"프리미엄",interior:"내부",door:"도어",furnitureLibrary:"가구 라이브러리",internalSpace:"내경 공간 (맞춤형 가구 기준)",internalSpaceDimensions:"폭: {{width}}mm × 높이: {{height}}mm × 깊이: {{depth}}mm",internalSpaceNote:"* 모든 가구는 내경 높이({{height}}mm)와 깊이({{depth}}mm)에 맞춰 제작됩니다",columnInfo:"* 컬럼 수: {{count}}개 / 컬럼당 너비: {{width}}mm",tallSingleDesc:"키큰장 - 1개 컬럼을 차지하는 가구 (약 {{width}}mm 폭)",tallDualDesc:"키큰장 - 2개 컬럼을 차지하는 가구 (약 {{width}}mm 폭)",upperSingleDesc:"상부장 - 1개 컬럼 (약 {{width}}mm 폭)",upperDualDesc:"상부장 - 2개 컬럼 (약 {{width}}mm 폭)",lowerSingleDesc:"하부장 - 1개 컬럼 (약 {{width}}mm 폭)",lowerDualDesc:"하부장 - 2개 컬럼 (약 {{width}}mm 폭)",colorPicker:"색상 지정하기",brightnessAdjust:"밝기 조정",savedColors:"저장된 색상",addColorHint:"+ 버튼으로 색상 추가"},DKe={title:"뷰어",view2D:"2D 뷰",view3D:"3D 뷰",all:"전체",front:"정면",left:"좌측",right:"우측",top:"상부",perspective:"투시도",wireframe:"은선",solid:"솔리드",showDimensions:"치수",showGuides:"그리드",showAxis:"축",showAll:"모두 표시",dimensions:"치수",grid:"그리드",axis:"축",column:"컬럼",doorInstallation:"도어설치",doorOpen:"열기",doorClose:"닫기",indirectLight:"간접조명",indirectLightOn:"간접조명 켜기",indirectLightOff:"간접조명 끄기",on:"on",off:"off"},jKe={title:"프로젝트",newProject:"새 디자인",openProject:"프로젝트 열기",saveProject:"프로젝트 저장",saveAs:"다른이름으로 저장",export:"내보내기",import:"가져오기",projectName:"프로젝트명",designer:"디자이너",client:"고객명",date:"날짜",description:"설명",untitled:"제목 없음",enterName:"프로젝트 이름을 입력하세요:"},PKe={module:"모듈",material:"재질",structure:"구조물",etc:"기타",structureTypes:"구조물 종류",columnA:"기둥A",columnB:"기둥B",columnC:"기둥C",panelA:"패널A",panelB:"패널B",partition:"가벽",accessories:"악세서리",preparing:"준비중입니다.",exitToDashboard:"대시보드로 나가기"},NKe={saveSuccess:"저장되었습니다",saveFailed:"저장에 실패했습니다",deleteConfirm:"정말 삭제하시겠습니까?",unsavedChanges:"저장되지 않은 변경사항이 있습니다",loadingProject:"프로젝트를 불러오는 중...",noProjectFound:"프로젝트를 찾을 수 없습니다",invalidInput:"유효하지 않은 입력값입니다",connectionError:"연결 오류가 발생했습니다",sessionExpired:"세션이 만료되었습니다",exitWithoutSaving:"그냥 나가기",exitWithSaving:"저장하고 나가기",captureFailure:"뷰 캡처에 실패했습니다. 다시 시도해주세요.",exitConfirm:"변경사항을 저장하지 않고 나가시겠습니까?",loseChanges:"저장하지 않은 내용은 잃어버리게 됩니다."},LKe={accountInfo:"계정 정보",authMethod:"인증 방법",googleAccount:"Google 계정",emailAuth:"이메일 인증",other:"기타",joinDate:"가입일",lastActivity:"마지막 활동",quickMenu:"빠른 메뉴",accountSettings:"계정 설정"},MKe={editColumn:"기둥 편집",deleteConfirm:"기둥을 삭제하시겠습니까?",basicInfo:"기본 정보",columnId:"기둥 ID",size:"크기",width:"폭",depth:"깊이",height:"높이",position:"위치",leftGap:"좌측갭",rightGap:"우측갭",keyboardHint:"키보드 조작: ↑↓(좌측갭 1mm/Shift+10mm), ←→(우측갭 10mm/Shift+100mm)"},RKe={title:"조작법",shortcuts:{mouseDrag:"마우스 드래그",cameraRotate:"카메라 회전",mouseWheel:"마우스 휠",zoomInOut:"줌 인/아웃",deleteSelected:"선택된 가구 삭제",exitEditMode:"편집 모드 종료",arrowKeys:"화살표 키",fineTuneMove:"가구 미세 이동",doubleClick:"더블클릭",editMode:"가구 편집 모드",dragDrop:"드래그 앤 드롭",placeFurniture:"가구 배치"},tips:{title:"사용 팁",autoPlace:"사이드바에서 가구를 더블클릭하면 빈 슬롯에 자동 배치됩니다",editPopup:"가구를 클릭하면 편집 팝업이 열립니다",editColumn:"기둥을 더블클릭하면 기둥 속성을 편집할 수 있습니다",doorInstall:"도어 설치 버튼으로 도어를 추가/제거할 수 있습니다"}},UKe={title:"CNC 최적화",calculate:"계산하기",export:"내보내기",panels:"패널",stock:"원자재",options:"옵션",panel:"패널",cut:"절단",result:"결과",sheets:"시트",sheet:"시트",efficiency:"효율",wasteArea:"폐기 면적",usedArea:"사용 면적",cutLength:"절단 길이",cutCount:"절단 횟수",simulation:"시뮬레이션",play:"재생",pause:"일시정지",speed:"속도",exit:"나가기",back:"뒤로",next:"다음",noResults:"최적화 결과가 없습니다",setupHint:'패널과 원자재를 설정한 후 "최적화" 버튼을 클릭하세요',optimizing:"최적화 중...",generatePanels:"패널생성",totalStats:"전체 통계",sheetStats:"시트 통계",totalPanels:"총 패널",bladeThickness:"톱날 두께",optimization:"최적화",panelCount:"패널 수",sheetList:"시트 목록",cuttingList:"컷팅 리스트",keyboardNavigationHint:"방향키로 시트 이동",optimalL:"L방향 우선",optimalW:"W방향 우선",optimalCNC:"CNC 최적화",optimizationComplete:"최적화 완료! {{panels}}개 패널, {{sheets}}개 시트 (평균 효율: {{efficiency}}%)",optimizationFailed:"최적화 실패: 패널을 배치할 수 없습니다",noPanelsError:"최적화할 패널이 없습니다",noStockError:"원자재가 정의되지 않았습니다",optimizationError:"최적화 실패",aiOptimizing:"AI 최적화 계산 중",aiPhase1:"패널 데이터 분석 중",aiPhase2:"최적 배치 알고리즘 실행",aiPhase3:"공간 효율성 계산",aiPhase4:"절단 경로 최적화",aiPhase5:"결과 검증 중",minWaste:"최소폐기",verticalCut:"세로절단",horizontalCut:"가로절단",panelList:"패널목록",noPanelsMessage:'패널이 없습니다. "추가" 버튼을 클릭하여 생성하세요.',name:"이름",dimensions:"치수 (L×W)",thickness:"두께",quantity:"수량",material:"재질",grain:"결방향",panelNamePlaceholder:"패널 이름",lengthPlaceholder:"세로",widthPlaceholder:"가로",csvReplaceConfirm:`기존 패널 {{count}}개가 있습니다. 대체하시겠습니까?

'확인': CSV 파일로 대체
'취소': 기존 패널에 추가`,csvImportSuccess:"{{count}}개의 패널을 CSV 파일에서 가져왔습니다.",csvAddSuccess:"{{count}}개의 패널을 추가했습니다.",csvNoValidData:"CSV 파일에서 유효한 패널 데이터를 찾을 수 없습니다.",csvReadError:"CSV 파일을 읽는 중 오류가 발생했습니다.",grainVerticalTooltip:"세로 결방향 (클릭하여 가로로 변경)",grainHorizontalTooltip:"가로 결방향 (클릭하여 세로로 변경)",csvNoData:"CSV 파일에 데이터가 없습니다",stockAddSuccess:"{{count}}개의 원자재를 추가했습니다",noStockMessage:'원자재가 없습니다. "추가" 버튼을 클릭하여 생성하세요.',stockNamePlaceholder:"원자재 이름",maxValue:"최대 {{value}}mm",edgeGapSettings:"엣지 갭 설정",top:"상단",bottom:"하단",left:"좌측",right:"우측",considerGrain:"결 방향 고려",groupByMaterial:"재질별 그룹화",showPanelLabels:"패널 라벨 표시",considerEdgeBanding:"엣지밴드 고려",singleSheetOnly:"단일 시트만 사용",alignVerticalCuts:"세로 컷팅 정렬",exitConfirmMessage:"CNC 옵티마이저를 종료하시겠습니까?",unsavedChangesWarning:"저장되지 않은 변경사항이 있을 수 있습니다."},OKe={common:SKe,settings:TKe,space:BKe,frame:EKe,furniture:FKe,placement:kKe,material:IKe,viewer:DKe,project:jKe,export:{title:"내보내기",pdf:"PDF 다운로드",pdfDesc:"정면도, 평면도, 측면도를 포함한 PDF 생성",dxf:"DXF 도면",dxfDesc:"CAD 프로그램용 도면 파일 (준비 중)",image:"이미지 다운로드",imageDesc:"PNG/JPG 형식으로 저장 (준비 중)",excel:"엑셀로 내보내기",cutList:"재단목록",partsList:"부품목록",estimate:"견적서",converting:"변환중",capturing:"캡처 중...",cuttingOptimizer:"컷팅 옵티마이저",drawingEditor:"도면 편집기"},sidebar:PKe,messages:NKe,profile:LKe,column:MKe,help:RKe,cnc:UKe},HKe={save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",remove:"Remove",confirm:"Confirm",close:"Close",back:"Back",next:"Next",finish:"Finish",apply:"Apply",reset:"Reset",search:"Search",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Info",undo:"Undo",redo:"Redo",copy:"Copy",paste:"Paste",file:"File",saving:"Saving...",help:"Help",controls:"Controls",converting:"Converting",logout:"Logout",login:"Login",brandType:"Brand Type",priceInfo:"Price Info",priceRange:"Price Range",none:"None",enabled:"Enabled",unit:"Unit"},WKe={title:"Settings",general:"General Settings",language:"Language",languageDesc:"Interface language settings",theme:"Theme",themeDesc:"Theme settings",themeSettings:"Theme Settings",displayMode:"Display Mode",themeColor:"Theme Color",lightMode:"Light Mode",darkMode:"Dark Mode",notifications:"Notifications",notificationsDesc:"Receive updates and notifications",autoSave:"Auto Save",autoSaveDesc:"Automatically save changes",gridSnap:"Grid Snap",gridSnapDesc:"Auto-align objects to grid",shortcuts:"Keyboard Shortcuts",version:"Version",lastUpdate:"Last Update",info:"Info"},zKe={title:"Space Settings",width:"Width",height:"Height",depth:"Depth",installType:"Installation Type",builtin:"Built-in",builtinDesc:"Built-in type with both walls",semistanding:"Semi-standing",semistandingDesc:"Semi-standing type with one wall and one open side",freestanding:"Free-standing",freestandingDesc:"Free-standing type without walls",wallPosition:"Wall Position",standing:"Standing",semiStanding:"Semi-Standing",wallMount:"Wall Mount",surroundType:"Surround Type",surround:"Surround",noSurround:"No Surround",columnCount:"Column Count",doorCount:"Door Count",droppedCeiling:"Dropped Ceiling",droppedCeilingEnabled:"Enable Dropped Ceiling",droppedCeilingHeight:"Dropped Ceiling Height",droppedCeilingWidth:"Dropped Ceiling Width",mainSection:"Main Section",droppedSection:"Dropped Section",mainSectionSize:"Main Section Size",droppedSectionSize:"Dropped Section Size",droppedColumnCount:"Dropped Section Columns",totalWidth:"Total Width"},QKe={title:"Frame Settings",frameWidth:"Frame Width",leftFrame:"Left Frame",rightFrame:"Right Frame",topFrame:"Top Frame",baseFrame:"Base Frame",endPanel:"End Panel",subFrame:"Sub Frame",frameOptions:"Frame Options",withFrame:"With Frame",withoutFrame:"Without Frame",properties:"Frame Properties",baseHeight:"Base Height",floatHeight:"Float Height"},$Ke={title:"Furniture",upperCabinet:"Upper",lowerCabinet:"Lower",tallCabinet:"Tall",dualCabinet:"Dual Cabinet",singleCabinet:"Single Cabinet",backPanel:"Back Panel",gapBackPanel:"Gap Back Panel",door:"Door",drawer:"Drawer",shelf:"Shelf",handle:"Handle",hinge:"Hinge",hingePosition:"Hinge Position",left:"Left",right:"Right",moduleLibrary:"Module Library",placedModules:"Placed Modules",moduleProperties:"Module Properties",customWidth:"Custom Width",customHeight:"Custom Height",customDepth:"Custom Depth",all:"All",single:"Single",dual:"Dual",moduleNotReady:"Modules are still being prepared",noModulesAvailable:"No furniture available for this type",editFurniture:"Edit Furniture",viewDetails:"View Details",panelDetails:"Panel Details",widthSettings:"Width Settings",depthSettings:"Depth Settings",range:"Range",doorSettings:"Door Settings",hingeDirection:"Hinge Direction",openToRight:"Opens to Right",openToLeft:"Opens to Left",coverDoorNote:"Cover door hinge position cannot be changed",gapBackPanelSettings:"Gap Back Panel Between Cabinets",backPanelAlreadySet:"Back panel already set in {{position}} of the same slot.",minValue:"Minimum {{value}}mm required",maxValue:"Maximum {{value}}mm allowed",upperSection:"Upper Section",lowerSection:"Lower Section",leftPanel:"Left Panel",rightPanel:"Right Panel",topPanel:"Top Panel",bottomPanel:"Bottom Panel",frontPanel:"Front Panel",handlePlate:"Handle Plate",drawerDivider:"Drawer Divider"},VKe={title:"Placement Settings",properties:"Placement Properties",placementType:"Placement Type",droppedCeilingPosition:"Dropped Ceiling Position",floor:"On Floor",float:"Floating",floatHeight:"Float Height",gap:"Gap",leftGap:"Left",rightGap:"Right",topGap:"Top Gap",bottomGap:"Bottom Gap",wallOffset:"Wall Offset",noWall:"No Wall"},GKe={title:"Material Settings",woodGrain:"Wood Grain",solid:"Solid",metallic:"Metallic",glass:"Glass",matte:"Matte",glossy:"Glossy",texture:"Texture",color:"Color",finish:"Finish",white:"White",melamine:"Melamine",premium:"Premium",selection:"Material Selection",floorFinish:"Floor Finish",floorFinishThickness:"Thickness",interior:"Body",door:"Door",furnitureLibrary:"Furniture Library",internalSpace:"Internal Space (Custom Furniture Reference)",internalSpaceDimensions:"W: {{width}}mm × H: {{height}}mm × D: {{depth}}mm",internalSpaceNote:"* All furniture is manufactured to internal height ({{height}}mm) and depth ({{depth}}mm)",columnInfo:"* Columns: {{count}} / Width per column: {{width}}mm",tallSingleDesc:"Tall Cabinet - Single column furniture (approx. {{width}}mm width)",tallDualDesc:"Tall Cabinet - Dual column furniture (approx. {{width}}mm width)",upperSingleDesc:"Upper Cabinet - Single column (approx. {{width}}mm width)",upperDualDesc:"Upper Cabinet - Dual column (approx. {{width}}mm width)",lowerSingleDesc:"Lower Cabinet - Single column (approx. {{width}}mm width)",lowerDualDesc:"Lower Cabinet - Dual column (approx. {{width}}mm width)",colorPicker:"Specify Color",brightnessAdjust:"Brightness Adjustment",savedColors:"Saved Colors",addColorHint:"Add color with + button"},XKe={title:"Viewer",view2D:"2D View",view3D:"3D View",all:"All",front:"Front",left:"Left",right:"Right",top:"Top",perspective:"Perspective",wireframe:"Wireframe",solid:"Solid",showDimensions:"Dimensions",showGuides:"Grid",showAxis:"Axis",showAll:"Show All",dimensions:"Dimensions",grid:"Grid",axis:"Axis",column:"Column",doorInstallation:"Door",doorOpen:"Open",doorClose:"Close",indirectLight:"Indirect Light",indirectLightOn:"Turn On Indirect Light",indirectLightOff:"Turn Off Indirect Light",on:"on",off:"off"},YKe={title:"Project",newProject:"New Design",openProject:"Open Project",saveProject:"Save Project",saveAs:"Save As",export:"Export",import:"Import",projectName:"Project Name",designer:"Designer",client:"Client",date:"Date",description:"Description",untitled:"Untitled",enterName:"Enter project name:"},KKe={module:"Module",material:"Material",structure:"Structure",etc:"Others",structureTypes:"Structure Types",columnA:"Column A",columnB:"Column B",columnC:"Column C",panelA:"Panel A",panelB:"Panel B",partition:"Partition",accessories:"Accessories",preparing:"Preparing...",exitToDashboard:"Exit to Dashboard"},qKe={saveSuccess:"Saved successfully",saveFailed:"Failed to save",deleteConfirm:"Are you sure you want to delete?",unsavedChanges:"You have unsaved changes",loadingProject:"Loading project...",noProjectFound:"Project not found",invalidInput:"Invalid input",connectionError:"Connection error occurred",sessionExpired:"Session expired",exitWithoutSaving:"Exit without saving",captureFailure:"View capture failed. Please try again.",exitConfirm:"Do you want to exit without saving?",loseChanges:"Unsaved changes will be lost."},ZKe={accountInfo:"Account Information",authMethod:"Authentication Method",googleAccount:"Google Account",emailAuth:"Email Authentication",other:"Other",joinDate:"Join Date",lastActivity:"Last Activity",quickMenu:"Quick Menu",accountSettings:"Account Settings"},JKe={editColumn:"Edit Column",deleteConfirm:"Are you sure you want to delete this column?",basicInfo:"Basic Information",columnId:"Column ID",size:"Size",width:"Width",depth:"Depth",height:"Height",position:"Position",leftGap:"Left Gap",rightGap:"Right Gap",keyboardHint:"Keyboard controls: ↑↓(Left gap 1mm/Shift+10mm), ←→(Right gap 10mm/Shift+100mm)"},eqe={title:"Controls",shortcuts:{mouseDrag:"Mouse Drag",cameraRotate:"Camera Rotate",mouseWheel:"Mouse Wheel",zoomInOut:"Zoom In/Out",deleteSelected:"Delete Selected Furniture",exitEditMode:"Exit Edit Mode",arrowKeys:"Arrow Keys",fineTuneMove:"Fine-tune Furniture Movement",doubleClick:"Double Click",editMode:"Furniture Edit Mode",dragDrop:"Drag & Drop",placeFurniture:"Place Furniture"},tips:{title:"Tips",autoPlace:"Double-click furniture in sidebar to auto-place in empty slot",editPopup:"Click furniture to open edit popup",editColumn:"Double-click column to edit column properties",doorInstall:"Use door installation button to add/remove doors"}},tqe={title:"CNC Optimizer",calculate:"Calculate",export:"Export",panels:"Panels",stock:"Stock",options:"Options",panel:"Panel",cut:"Cut",result:"Result",sheets:"Sheets",sheet:"Sheet",efficiency:"Efficiency",wasteArea:"Waste Area",usedArea:"Used Area",cutLength:"Cut Length",cutCount:"Cut Count",simulation:"Simulation",play:"Play",pause:"Pause",speed:"Speed",exit:"Exit",back:"Back",next:"Next",noResults:"No optimization results",setupHint:'Set up panels and stock, then click "Optimize" button',optimizing:"Optimizing...",generatePanels:"Generate Panels",totalStats:"Total Stats",sheetStats:"Sheet Stats",totalPanels:"Total Panels",bladeThickness:"Blade Thickness",optimization:"Optimization",panelCount:"Panel Count",sheetList:"Sheet List",cuttingList:"Cutting List",keyboardNavigationHint:"Navigate sheets with arrow keys",optimalL:"L-Direction Priority",optimalW:"W-Direction Priority",optimalCNC:"CNC Optimization",optimizationComplete:"Optimization complete! {{panels}} panels, {{sheets}} sheets (avg efficiency: {{efficiency}}%)",optimizationFailed:"Optimization failed: Cannot place panels",noPanelsError:"No panels to optimize",noStockError:"No stock sheets defined",optimizationError:"Optimization failed",aiOptimizing:"AI Optimization Computing",aiPhase1:"Analyzing panel data",aiPhase2:"Running placement algorithm",aiPhase3:"Calculating space efficiency",aiPhase4:"Optimizing cutting paths",aiPhase5:"Validating results",minWaste:"Min Waste",verticalCut:"Vertical Cut",horizontalCut:"Horizontal Cut",panelList:"Panels",noPanelsMessage:'No panels. Click "Add" button to create.',dimensions:"Size (L×W)",material:"Mtrl",grain:"Grain",quantity:"Qty",thickness:"Thk",name:"Name",panelNamePlaceholder:"e.g., Side Panel",stockNamePlaceholder:"e.g., Stock 1",noStockMessage:'No stock. Click "Add" button to create.',maxValue:"Max: {{value}}",csvImport:"Import CSV",csvExport:"Export CSV",csvImportConfirm:"Import panels from CSV?",csvReadError:"Error reading CSV file",csvNoData:"No data in CSV file",panelsAddSuccess:"{{count}} panels added",stockAddSuccess:"{{count}} stock sheets added",edgeGapSettings:"Edge Gap Settings",top:"Top",bottom:"Bottom",left:"Left",right:"Right",considerGrain:"Consider Grain Direction",groupByMaterial:"Group by Material",showPanelLabels:"Show Panel Labels",considerEdgeBanding:"Consider Edge Banding",singleSheetOnly:"Single Sheet Only",alignVerticalCuts:"Align Vertical Cuts",exitConfirmMessage:"Are you sure you want to exit CNC Optimizer?",unsavedChangesWarning:"You may have unsaved changes."},nqe={common:HKe,settings:WKe,space:zKe,frame:QKe,furniture:$Ke,placement:VKe,material:GKe,viewer:XKe,project:YKe,export:{title:"Export",pdf:"PDF Template",pdfDesc:"Generate PDF with technical drawing template",dxf:"DXF Drawing",dxfDesc:"Drawing file for CAD programs (Coming soon)",image:"Download Image",imageDesc:"Save as PNG/JPG format (Coming soon)",excel:"Export to Excel",cutList:"Cut List",partsList:"Parts List",estimate:"Estimate",converting:"Converting",capturing:"Capturing...",cuttingOptimizer:"Cutting Optimizer",drawingEditor:"Drawing Editor"},sidebar:KKe,messages:qKe,profile:ZKe,column:JKe,help:eqe,cnc:tqe},iqe={save:"保存",cancel:"キャンセル",delete:"削除",edit:"編集",add:"追加",remove:"削除",confirm:"確認",close:"閉じる",back:"戻る",next:"次へ",finish:"完了",apply:"適用",reset:"リセット",search:"検索",loading:"読み込み中...",error:"エラー",success:"成功",warning:"警告",info:"情報",undo:"元に戻す",redo:"やり直す",copy:"コピー",paste:"貼り付け",file:"ファイル",saving:"保存中...",help:"ヘルプ",controls:"操作方法",converting:"変換",logout:"ログアウト",login:"ログイン",brandType:"ブランドタイプ",priceInfo:"価格情報",priceRange:"価格帯",none:"なし",enabled:"あり",unit:"単位"},rqe={title:"設定",general:"一般設定",language:"言語",languageDesc:"インターフェース言語設定",theme:"テーマ",themeDesc:"テーマ設定",themeSettings:"テーマ設定",displayMode:"表示モード",themeColor:"テーマカラー",lightMode:"ライトモード",darkMode:"ダークモード",notifications:"通知",notificationsDesc:"更新と通知を受け取る",autoSave:"自動保存",autoSaveDesc:"変更を自動的に保存",gridSnap:"グリッドスナップ",gridSnapDesc:"オブジェクトをグリッドに自動整列",shortcuts:"キーボードショートカット",version:"バージョン",lastUpdate:"最終更新",info:"情報"},sqe={title:"部屋サイズ",width:"幅",height:"高さ",depth:"奥行き",installType:"設置タイプ",builtin:"埋込",builtinDesc:"両側に壁がある埋込み式",semistanding:"半埋込",semistandingDesc:"片側に壁があり片側が開いた半埋込み式",freestanding:"据置",freestandingDesc:"両側に壁がない据置式",wallPosition:"壁の位置",standing:"スタンディング",semiStanding:"セミスタンディング",wallMount:"壁掛け",surroundType:"フレームタイプ",surround:"フレームあり",noSurround:"フレームなし",columnCount:"区画数",doorCount:"扉数",droppedCeiling:"下がり天井",droppedCeilingEnabled:"下がり天井を使用",droppedCeilingHeight:"下がり天井の高さ",droppedCeilingWidth:"下がり天井の幅",mainSection:"メインセクション",droppedSection:"下がり天井セクション",mainSectionSize:"メインセクションサイズ",droppedColumnCount:"下がり天井カラム数",floorFinish:"床仕上げ",floorFinishThickness:"厚さ",totalWidth:"全体幅"},oqe={title:"フレーム設定",frameWidth:"フレーム幅",leftFrame:"左フレーム",rightFrame:"右フレーム",topFrame:"上部フレーム",baseFrame:"ベースフレーム",endPanel:"エンドパネル",subFrame:"サブフレーム",frameOptions:"フレームオプション",withFrame:"フレームあり",withoutFrame:"フレームなし",properties:"フレームプロパティ",baseHeight:"ベースの高さ",floatHeight:"浮かせ高さ"},aqe={title:"家具",upperCabinet:"吊戸棚",lowerCabinet:"下部キャビネット",tallCabinet:"トールキャビネット",dualCabinet:"デュアルキャビネット",singleCabinet:"シングルキャビネット",backPanel:"背面パネル",gapBackPanel:"隙間背面パネル",door:"扉",drawer:"引き出し",shelf:"棚",handle:"取っ手",hinge:"蝶番",hingePosition:"蝶番位置",left:"左側",right:"右側",moduleLibrary:"モジュールライブラリ",placedModules:"配置済みモジュール",moduleProperties:"モジュールプロパティ",customWidth:"カスタム幅",customHeight:"カスタム高さ",customDepth:"カスタム奥行き",all:"すべて",single:"単体",dual:"連結",moduleNotReady:"モジュールはまだ準備中です",noModulesAvailable:"このタイプに適した家具がありません",editFurniture:"家具編集",viewDetails:"詳細を表示",panelDetails:"パネル詳細情報",widthSettings:"幅設定",depthSettings:"奥行き設定",range:"範囲",doorSettings:"扉表示",hingeDirection:"ヒンジ方向",openToRight:"右に開く",openToLeft:"左に開く",coverDoorNote:"カバードアはヒンジ位置を変更できません",gapBackPanelSettings:"キャビネット間のバックパネル",backPanelAlreadySet:"同じスロットの{{position}}でバックパネルが設定されています。",minValue:"最小{{value}}mm以上必要です",maxValue:"最大{{value}}mm以下にしてください",upperSection:"上部セクション",lowerSection:"下部セクション",leftPanel:"左側板",rightPanel:"右側板",topPanel:"天板",bottomPanel:"底板",frontPanel:"前板",handlePlate:"取っ手板",drawerDivider:"引き出し仕切り"},lqe={title:"配置設定",placementType:"配置タイプ",droppedCeilingPosition:"下がり天井の位置",floor:"床置き",float:"浮かせて設置",floatHeight:"浮かせ高さ",gap:"隙間",leftGap:"左隙間",rightGap:"右隙間",topGap:"上部隙間",bottomGap:"下部隙間",properties:"配置プロパティ"},cqe={title:"材質設定",woodGrain:"木目",solid:"単色",metallic:"メタリック",glass:"ガラス",matte:"マット",glossy:"光沢",texture:"テクスチャ",color:"色",finish:"仕上げ",selection:"材質選択",floorFinish:"床仕上げ",interior:"内部",door:"ドア",furnitureLibrary:"家具ライブラリ",internalSpace:"内部空間（カスタム家具基準）",internalSpaceDimensions:"幅: {{width}}mm × 高さ: {{height}}mm × 奥行: {{depth}}mm",internalSpaceNote:"* すべての家具は内部高さ（{{height}}mm）と奥行（{{depth}}mm）に合わせて製作されます",columnInfo:"* カラム数: {{count}}個 / カラム幅: {{width}}mm",tallSingleDesc:"トールキャビネット - シングルカラム家具（約{{width}}mm幅）",tallDualDesc:"トールキャビネット - デュアルカラム家具（約{{width}}mm幅）",upperSingleDesc:"アッパーキャビネット - シングルカラム（約{{width}}mm幅）",upperDualDesc:"アッパーキャビネット - デュアルカラム（約{{width}}mm幅）",lowerSingleDesc:"ロワーキャビネット - シングルカラム（約{{width}}mm幅）",lowerDualDesc:"ロワーキャビネット - デュアルカラム（約{{width}}mm幅）",colorPicker:"色を指定",brightnessAdjust:"明度調整",savedColors:"保存した色",addColorHint:"+ボタンで色を追加"},hqe={title:"ビューアー",view2D:"2Dビュー",view3D:"3Dビュー",all:"すべて",front:"正面",left:"左側",right:"右側",top:"平面",perspective:"透視図",wireframe:"ワイヤーフレーム",solid:"ソリッド",showDimensions:"寸法表示",showGuides:"ガイド表示",showAxis:"軸表示",showAll:"すべて表示",dimensions:"寸法",grid:"グリッド",axis:"軸",column:"カラム",doorInstallation:"ドア",doorOpen:"開ける",doorClose:"閉じる",indirectLight:"間接照明",indirectLightOn:"間接照明をオン",indirectLightOff:"間接照明をオフ",on:"オン",off:"オフ"},uqe={title:"プロジェクト",newProject:"新規プロジェクト",openProject:"プロジェクトを開く",saveProject:"プロジェクトを保存",saveAs:"名前を付けて保存",export:"エクスポート",import:"インポート",projectName:"プロジェクト名",designer:"デザイナー",client:"クライアント",date:"日付",description:"説明"},dqe={module:"モジュール",material:"材質",structure:"構造物",etc:"その他",structureTypes:"構造物の種類",columnA:"カラムA",columnB:"カラムB",columnC:"カラムC",panelA:"パネルA",panelB:"パネルB",partition:"間仕切り",accessories:"アクセサリー",preparing:"準備中です...",exitToDashboard:"ダッシュボードに戻る"},Aqe={saveSuccess:"正常に保存されました",saveFailed:"保存に失敗しました",deleteConfirm:"本当に削除しますか？",unsavedChanges:"未保存の変更があります",loadingProject:"プロジェクトを読み込み中...",noProjectFound:"プロジェクトが見つかりません",invalidInput:"無効な入力です",connectionError:"接続エラーが発生しました",sessionExpired:"セッションの有効期限が切れました",exitWithoutSaving:"保存せずに終了",captureFailure:"ビューのキャプチャに失敗しました。もう一度お試しください。",exitConfirm:"保存せずに終了しますか？",loseChanges:"保存されていない変更は失われます。"},fqe={editColumn:"カラム編集",deleteConfirm:"本当にこのカラムを削除しますか？",basicInfo:"基本情報",columnId:"カラムID",size:"サイズ",width:"幅",depth:"奥行き",height:"高さ",position:"位置",leftGap:"左側隙間",rightGap:"右側隙間",keyboardHint:"キーボード操作: ↑↓(左側隙間 1mm/Shift+10mm)、←→(右側隙間 10mm/Shift+100mm)"},pqe={title:"操作方法",shortcuts:{mouseDrag:"マウスドラッグ",cameraRotate:"カメラ回転",mouseWheel:"マウスホイール",zoomInOut:"ズームイン/アウト",deleteSelected:"選択した家具を削除",exitEditMode:"編集モード終了",arrowKeys:"矢印キー",fineTuneMove:"家具の微調整移動",doubleClick:"ダブルクリック",editMode:"家具編集モード",dragDrop:"ドラッグ＆ドロップ",placeFurniture:"家具配置"},tips:{title:"使用のヒント",autoPlace:"サイドバーで家具をダブルクリックすると空きスロットに自動配置されます",editPopup:"家具をクリックすると編集ポップアップが開きます",editColumn:"カラムをダブルクリックするとカラムのプロパティを編集できます",doorInstall:"ドア設置ボタンでドアを追加/削除できます"}},gqe={title:"CNC最適化",calculate:"計算",export:"エクスポート",panels:"パネル",stock:"在庫",options:"オプション",panel:"パネル",cut:"カット",result:"結果",sheets:"シート",sheet:"シート",efficiency:"効率",wasteArea:"廃棄面積",usedArea:"使用面積",cutLength:"カット長",cutCount:"カット回数",simulation:"シミュレーション",play:"再生",pause:"一時停止",speed:"速度",exit:"終了",back:"戻る",next:"次へ",noResults:"最適化結果がありません",setupHint:'パネルと在庫を設定してから"最適化"ボタンをクリックしてください',optimizing:"最適化中...",generatePanels:"パネル生成",totalStats:"全体統計",sheetStats:"シート統計",totalPanels:"総パネル",bladeThickness:"刃厚",optimization:"最適化",panelCount:"パネル数",sheetList:"シートリスト",cuttingList:"カッティングリスト",keyboardNavigationHint:"矢印キーでシートを移動",optimalL:"L方向優先",optimalW:"W方向優先",optimalCNC:"CNC最適化",optimizationComplete:"最適化完了！{{panels}}個のパネル、{{sheets}}個のシート（平均効率：{{efficiency}}%）",optimizationFailed:"最適化失敗：パネルを配置できません",noPanelsError:"最適化するパネルがありません",noStockError:"在庫シートが定義されていません",optimizationError:"最適化失敗",aiOptimizing:"AI最適化計算中",aiPhase1:"パネルデータ分析中",aiPhase2:"最適配置アルゴリズム実行",aiPhase3:"空間効率性計算",aiPhase4:"切断経路最適化",aiPhase5:"結果検証中",minWaste:"最小廃棄",verticalCut:"縦切断",horizontalCut:"横切断",panelList:"パネル",noPanelsMessage:"パネルがありません。「追加」ボタンをクリックして作成してください。",dimensions:"サイズ (L×W)",material:"材料",grain:"木目",quantity:"数量",thickness:"厚さ",name:"名前",panelNamePlaceholder:"例：サイドパネル",stockNamePlaceholder:"例：在庫1",noStockMessage:"在庫がありません。「追加」ボタンをクリックして作成してください。",maxValue:"最大: {{value}}",csvImport:"CSVインポート",csvExport:"CSVエクスポート",csvImportConfirm:"CSVからパネルをインポートしますか？",csvReadError:"CSVファイルの読み取りエラー",csvNoData:"CSVファイルにデータがありません",panelsAddSuccess:"{{count}}個のパネルを追加しました",stockAddSuccess:"{{count}}個の在庫シートを追加しました",edgeGapSettings:"エッジギャップ設定",top:"上",bottom:"下",left:"左",right:"右",considerGrain:"木目方向を考慮",groupByMaterial:"材料別にグループ化",showPanelLabels:"パネルラベルを表示",considerEdgeBanding:"エッジバンディングを考慮",singleSheetOnly:"単一シートのみ",alignVerticalCuts:"垂直カットを整列",exitConfirmMessage:"CNCオプティマイザーを終了しますか？",unsavedChangesWarning:"保存されていない変更がある可能性があります。"},mqe={common:iqe,settings:rqe,space:sqe,frame:oqe,furniture:aqe,placement:lqe,material:cqe,viewer:hqe,project:uqe,export:{title:"エクスポート",pdf:"PDFとしてエクスポート",dxf:"DXFとしてエクスポート",image:"画像としてエクスポート",excel:"Excelとしてエクスポート",cutList:"カットリスト",partsList:"部品リスト",estimate:"見積書",drawingEditor:"図面エディター",cuttingOptimizer:"カッティングオプティマイザー"},sidebar:dqe,messages:Aqe,column:fqe,help:pqe,cnc:gqe},yqe={save:"保存",cancel:"取消",delete:"删除",edit:"编辑",add:"添加",remove:"移除",confirm:"确认",close:"关闭",back:"返回",next:"下一步",finish:"完成",apply:"应用",reset:"重置",search:"搜索",loading:"加载中...",error:"错误",success:"成功",warning:"警告",info:"信息",undo:"撤销",redo:"重做",copy:"复制",paste:"粘贴",file:"文件",saving:"保存中...",help:"帮助",controls:"操作方法",converting:"转换",logout:"登出",login:"登录",brandType:"品牌类型",priceInfo:"价格信息",priceRange:"价格范围",none:"无",enabled:"启用",unit:"单位"},wqe={title:"设置",general:"常规设置",language:"语言",languageDesc:"界面语言设置",theme:"主题",themeDesc:"主题设置",themeSettings:"主题设置",displayMode:"显示模式",themeColor:"主题颜色",lightMode:"浅色模式",darkMode:"深色模式",notifications:"通知",notificationsDesc:"接收更新和通知",autoSave:"自动保存",autoSaveDesc:"自动保存更改",gridSnap:"网格对齐",gridSnapDesc:"自动将对象对齐到网格",shortcuts:"键盘快捷键",version:"版本",lastUpdate:"最后更新",info:"信息"},vqe={title:"空间设置",width:"宽度",height:"高度",depth:"深度",installType:"安装类型",builtin:"嵌入",builtinDesc:"两侧都有墙的嵌入式",semistanding:"半嵌入",semistandingDesc:"一侧有墙一侧开放的半嵌入式",freestanding:"独立",freestandingDesc:"两侧都没有墙的独立式",wallPosition:"墙体位置",standing:"落地式",semiStanding:"半落地式",wallMount:"壁挂式",surroundType:"围框类型",surround:"有围框",noSurround:"无围框",columnCount:"列数",doorCount:"门数",droppedCeiling:"吊顶",droppedCeilingEnabled:"启用吊顶",droppedCeilingHeight:"吊顶高度",droppedCeilingWidth:"吊顶宽度",mainSection:"主区域",droppedSection:"吊顶区域",mainSectionSize:"主区域尺寸",droppedColumnCount:"吊顶区域列数",floorFinish:"地板装修",floorFinishThickness:"厚度",totalWidth:"总宽度"},xqe={title:"框架设置",frameWidth:"框架宽度",leftFrame:"左框架",rightFrame:"右框架",topFrame:"顶部框架",baseFrame:"底部框架",endPanel:"端板",subFrame:"子框架",frameOptions:"框架选项",withFrame:"有框架",withoutFrame:"无框架",properties:"框架属性",baseHeight:"底座高度",floatHeight:"悬浮高度"},bqe={title:"家具",upperCabinet:"吊柜",lowerCabinet:"地柜",tallCabinet:"高柜",dualCabinet:"双层柜",singleCabinet:"单层柜",backPanel:"背板",gapBackPanel:"间隙背板",door:"门板",drawer:"抽屉",shelf:"隔板",handle:"把手",hinge:"铰链",hingePosition:"铰链位置",left:"左侧",right:"右侧",moduleLibrary:"模块库",placedModules:"已放置模块",moduleProperties:"模块属性",customWidth:"自定义宽度",customHeight:"自定义高度",customDepth:"自定义深度",all:"全部",single:"单个",dual:"双个",moduleNotReady:"模块仍在准备中",noModulesAvailable:"没有适合此类型的家具",editFurniture:"编辑家具",viewDetails:"查看详情",panelDetails:"面板详细信息",widthSettings:"宽度设置",depthSettings:"深度设置",range:"范围",doorSettings:"门板设置",hingeDirection:"铰链方向",openToRight:"向右打开",openToLeft:"向左打开",coverDoorNote:"遮盖门无法更改铰链位置",gapBackPanelSettings:"柜子间隙背板",backPanelAlreadySet:"同一插槽的{{position}}已设置背板。",minValue:"最小值必须大于{{value}}mm",maxValue:"最大值必须小于{{value}}mm"},Cqe={title:"放置设置",placementType:"放置类型",droppedCeilingPosition:"吊顶位置",floor:"地面放置",float:"悬浮放置",floatHeight:"悬浮高度",gap:"间隙",leftGap:"左间隙",rightGap:"右间隙",topGap:"顶部间隙",bottomGap:"底部间隙",properties:"放置属性"},_qe={title:"材质设置",woodGrain:"木纹",solid:"纯色",metallic:"金属",glass:"玻璃",matte:"哑光",glossy:"亮光",texture:"纹理",color:"颜色",finish:"表面处理",selection:"材质选择",floorFinish:"地板饰面",interior:"内部",door:"门板",furnitureLibrary:"家具库",internalSpace:"内部空间（定制家具基准）",internalSpaceDimensions:"宽: {{width}}mm × 高: {{height}}mm × 深: {{depth}}mm",internalSpaceNote:"* 所有家具按内部高度（{{height}}mm）和深度（{{depth}}mm）制作",columnInfo:"* 列数: {{count}}个 / 每列宽度: {{width}}mm",tallSingleDesc:"高柜 - 单列家具（约{{width}}mm宽）",tallDualDesc:"高柜 - 双列家具（约{{width}}mm宽）",upperSingleDesc:"吊柜 - 单列（约{{width}}mm宽）",upperDualDesc:"吊柜 - 双列（约{{width}}mm宽）",lowerSingleDesc:"地柜 - 单列（约{{width}}mm宽）",lowerDualDesc:"地柜 - 双列（约{{width}}mm宽）",colorPicker:"指定颜色",brightnessAdjust:"亮度调整",savedColors:"已保存的颜色",addColorHint:"点击+按钮添加颜色"},Sqe={title:"查看器",view2D:"2D视图",view3D:"3D视图",all:"全部",front:"正面",left:"左视图",right:"右视图",top:"俯视图",perspective:"透视图",wireframe:"线框",solid:"实体",showDimensions:"显示尺寸",showGuides:"显示参考线",showAxis:"显示坐标轴",showAll:"显示全部",dimensions:"标注",grid:"网格",axis:"坐标轴",column:"列",doorInstallation:"门",doorOpen:"打开",doorClose:"关闭",indirectLight:"间接照明",indirectLightOn:"开启间接照明",indirectLightOff:"关闭间接照明",on:"开",off:"关"},Tqe={title:"项目",newProject:"新建项目",openProject:"打开项目",saveProject:"保存项目",saveAs:"另存为",export:"导出",import:"导入",projectName:"项目名称",designer:"设计师",client:"客户",date:"日期",description:"描述"},Bqe={module:"模块",material:"材质",structure:"结构",etc:"其他",structureTypes:"结构类型",columnA:"柱A",columnB:"柱B",columnC:"柱C",panelA:"面板A",panelB:"面板B",partition:"隔断",accessories:"配件",preparing:"正在准备...",exitToDashboard:"退出到仪表板"},Eqe={saveSuccess:"保存成功",saveFailed:"保存失败",deleteConfirm:"确定要删除吗？",unsavedChanges:"有未保存的更改",loadingProject:"正在加载项目...",noProjectFound:"未找到项目",invalidInput:"无效的输入",connectionError:"连接错误",sessionExpired:"会话已过期",exitWithoutSaving:"不保存退出",captureFailure:"视图捕获失败。请重试。",exitConfirm:"确定不保存就退出吗？",loseChanges:"未保存的更改将丢失。"},Fqe={editColumn:"编辑立柱",deleteConfirm:"确定要删除这个立柱吗？",basicInfo:"基本信息",columnId:"立柱ID",size:"尺寸",width:"宽度",depth:"深度",height:"高度",position:"位置",leftGap:"左侧间隙",rightGap:"右侧间隙",keyboardHint:"键盘操作：↑↓（左侧间隙 1mm/Shift+10mm），←→（右侧间隙 10mm/Shift+100mm）"},kqe={title:"操作方法",shortcuts:{mouseDrag:"鼠标拖动",cameraRotate:"相机旋转",mouseWheel:"鼠标滚轮",zoomInOut:"放大/缩小",deleteSelected:"删除选中的家具",exitEditMode:"退出编辑模式",arrowKeys:"方向键",fineTuneMove:"微调家具移动",doubleClick:"双击",editMode:"家具编辑模式",dragDrop:"拖放",placeFurniture:"放置家具"},tips:{title:"使用提示",autoPlace:"在侧边栏双击家具可自动放置在空槽位",editPopup:"点击家具打开编辑弹窗",editColumn:"双击立柱可编辑立柱属性",doorInstall:"使用门安装按钮添加/删除门"}},Iqe={title:"CNC优化",calculate:"计算",export:"导出",panels:"面板",stock:"库存",options:"选项",panel:"面板",cut:"切割",result:"结果",sheets:"板材",sheet:"板材",efficiency:"效率",wasteArea:"浪费面积",usedArea:"使用面积",cutLength:"切割长度",cutCount:"切割次数",simulation:"模拟",play:"播放",pause:"暂停",speed:"速度",exit:"退出",back:"返回",next:"下一步",noResults:"没有优化结果",setupHint:'设置面板和库存后，点击"优化"按钮',optimizing:"优化中...",generatePanels:"生成面板",totalStats:"总统计",sheetStats:"板材统计",totalPanels:"总面板",bladeThickness:"刃厚",optimization:"优化",panelCount:"面板数",sheetList:"板材列表",cuttingList:"切割列表",keyboardNavigationHint:"使用方向键导航板材",optimalL:"L方向优先",optimalW:"W方向优先",optimalCNC:"CNC优化",optimizationComplete:"优化完成！{{panels}}个面板，{{sheets}}个板材（平均效率：{{efficiency}}%）",optimizationFailed:"优化失败：无法放置面板",noPanelsError:"没有要优化的面板",noStockError:"未定义库存板材",optimizationError:"优化失败",aiOptimizing:"AI优化计算中",aiPhase1:"分析面板数据",aiPhase2:"运行优化算法",aiPhase3:"计算空间效率",aiPhase4:"优化切割路径",aiPhase5:"验证结果",minWaste:"最小浪费",verticalCut:"纵向切割",horizontalCut:"横向切割",panelList:"面板",noPanelsMessage:'没有面板。点击"添加"按钮创建。',dimensions:"尺寸 (L×W)",material:"材料",grain:"纹理",quantity:"数量",thickness:"厚度",name:"名称",panelNamePlaceholder:"例如：侧板",stockNamePlaceholder:"例如：库存1",noStockMessage:'没有库存。点击"添加"按钮创建。',maxValue:"最大: {{value}}",csvImport:"导入CSV",csvExport:"导出CSV",csvImportConfirm:"从CSV导入面板？",csvReadError:"读取CSV文件出错",csvNoData:"CSV文件中没有数据",panelsAddSuccess:"已添加{{count}}个面板",stockAddSuccess:"已添加{{count}}个库存板材",edgeGapSettings:"边缘间隙设置",top:"顶部",bottom:"底部",left:"左侧",right:"右侧",considerGrain:"考虑纹理方向",groupByMaterial:"按材料分组",showPanelLabels:"显示面板标签",considerEdgeBanding:"考虑封边",singleSheetOnly:"仅单张板材",alignVerticalCuts:"对齐垂直切割",exitConfirmMessage:"确定要退出CNC优化器吗？",unsavedChangesWarning:"您可能有未保存的更改。"},Dqe={common:yqe,settings:wqe,space:vqe,frame:xqe,furniture:bqe,placement:Cqe,material:_qe,viewer:Sqe,project:Tqe,export:{title:"导出",pdf:"导出为PDF",dxf:"导出为DXF",image:"导出为图片",excel:"导出为Excel",cutList:"裁切清单",partsList:"零件清单",estimate:"报价单",drawingEditor:"图纸编辑器",cuttingOptimizer:"切割优化器"},sidebar:Bqe,messages:Eqe,column:Fqe,help:kqe,cnc:Iqe},jqe={ko:{translation:OKe},en:{translation:nqe},ja:{translation:mqe},zh:{translation:Dqe}};Gc.use(Qae).init({resources:jqe,lng:localStorage.getItem("app-language")||"ko",fallbackLng:"ko",interpolation:{escapeValue:!1},ns:["translation"],defaultNS:"translation",debug:!1,react:{useSuspense:!1}});zq.createRoot(document.getElementById("root")).render(c.jsx(rKe,{}));export{kQ as B,Lz as L,go as _,Zi as a,jl as c,rr as d,kd as g};
