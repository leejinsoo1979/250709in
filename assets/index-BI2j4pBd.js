const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/projects.repo-C0rAGVvR.js","assets/three-fiber-CJ-4sOHx.js","assets/three-core-CnIHn6i7.js","assets/router-D2gCn4D4.js","assets/store-zO2cKXtg.js","assets/index.es-_8I2UGtw.js","assets/ARViewer-DvOKYk7Z.js","assets/ARViewer-DrQocUNP.css"])))=>i.map(i=>d[i]);
var bY=Object.defineProperty;var _Y=(n,e,t)=>e in n?bY(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var rr=(n,e,t)=>_Y(n,typeof e!="symbol"?e+"":e,t);import{_ as ca,r as O,j as l,p as CY,h as jl,C as WO,n as SY,P as TY,O as BY,R as ii,T as zn,L as it,o as EY,q as kY,c as QC,B as IY,E as FY,H as Y0,m as P0,g as Kf,F as DY,v as jY,w as PY,x as NY,y as LY,z as QO,A as MY}from"./three-fiber-CJ-4sOHx.js";import{R as $C,a as xc,b as VC,u as Y6,c as RY,B as OY,d as UY,e as Ho,N as Hw}from"./router-D2gCn4D4.js";import{c as Lm}from"./store-zO2cKXtg.js";import{h as ES,M as Ww,O as HY,e as yf,d as so,t as $O,X as WY,y as Yr,b as QY,a$ as Fc,av as fm,Y as $Y,ao as VY,b0 as VO,aQ as zY,az as oo,D as Go,J as uB,ay as zC,al as xg,at as Gh,q as k8,a as N0,aU as rh,T as GY,$ as zO,_ as GO,b1 as XY,k as O2,ax as KY}from"./three-core-CnIHn6i7.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();const qY=()=>{};var I8={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XO=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},YY=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],a=n[t++],c=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(c>>10)),e[i++]=String.fromCharCode(56320+(c&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},KO={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,a=o?n[r+1]:0,c=r+2<n.length,h=c?n[r+2]:0,u=s>>2,d=(s&3)<<4|a>>4;let f=(a&15)<<2|h>>6,A=h&63;c||(A=64,o||(f=64)),i.push(t[u],t[d],t[f],t[A])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(XO(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):YY(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;const h=r<n.length?t[n.charAt(r)]:64;++r;const d=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||a==null||h==null||d==null)throw new ZY;const f=s<<2|a>>4;if(i.push(f),h!==64){const A=a<<4&240|h>>2;if(i.push(A),d!==64){const g=h<<6&192|d;i.push(g)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class ZY extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const JY=function(n){const e=XO(n);return KO.encodeByteArray(e,!0)},A_=function(n){return JY(n).replace(/\./g,"")},qO=function(n){try{return KO.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eZ(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tZ=()=>eZ().__FIREBASE_DEFAULTS__,nZ=()=>{if(typeof process>"u"||typeof I8>"u")return;const n=I8.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},iZ=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&qO(n[1]);return e&&JSON.parse(e)},GC=()=>{try{return qY()||tZ()||nZ()||iZ()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},YO=n=>{var e,t;return(t=(e=GC())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},ZO=n=>{const e=YO(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},JO=()=>{var n;return(n=GC())===null||n===void 0?void 0:n.config},eU=n=>{var e;return(e=GC())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rZ{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qf(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Z6(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tU(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[A_(JSON.stringify(t)),A_(JSON.stringify(o)),""].join(".")}const hy={};function sZ(){const n={prod:[],emulator:[]};for(const e of Object.keys(hy))hy[e]?n.emulator.push(e):n.prod.push(e);return n}function oZ(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let F8=!1;function J6(n,e){if(typeof window>"u"||typeof document>"u"||!qf(window.location.host)||hy[n]===e||hy[n]||F8)return;hy[n]=e;function t(f){return`__firebase__banner__${f}`}const i="__firebase__banner",s=sZ().prod.length>0;function o(){const f=document.getElementById(i);f&&f.remove()}function a(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function c(f,A){f.setAttribute("width","24"),f.setAttribute("id",A),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function h(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{F8=!0,o()},f}function u(f,A){f.setAttribute("id",A),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function d(){const f=oZ(i),A=t("text"),g=document.getElementById(A)||document.createElement("span"),p=t("learnmore"),y=document.getElementById(p)||document.createElement("a"),v=t("preprendIcon"),m=document.getElementById(v)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const w=f.element;a(w),u(y,p);const x=h();c(m,v),w.append(m,g,y,x),document.body.appendChild(w)}s?(g.innerText="Preview backend disconnected.",m.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(m.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,g.innerText="Preview backend running in this workspace."),g.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jl(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function aZ(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Jl())}function lZ(){var n;const e=(n=GC())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function cZ(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function hZ(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function uZ(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function dZ(){const n=Jl();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function AZ(){return!lZ()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function fZ(){try{return typeof indexedDB=="object"}catch{return!1}}function pZ(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var s;e(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gZ="FirebaseError";class Nu extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=gZ,Object.setPrototypeOf(this,Nu.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Fv.prototype.create)}}class Fv{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?mZ(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Nu(r,a,i)}}function mZ(n,e){return n.replace(yZ,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const yZ=/\{\$([^}]+)}/g;function vZ(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function jf(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(D8(s)&&D8(o)){if(!jf(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function D8(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dv(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function U2(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[r,s]=i.split("=");e[decodeURIComponent(r)]=decodeURIComponent(s)}}),e}function H2(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function wZ(n,e){const t=new xZ(n,e);return t.subscribe.bind(t)}class xZ{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");bZ(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=kS),r.error===void 0&&(r.error=kS),r.complete===void 0&&(r.complete=kS);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function bZ(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function kS(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zs(n){return n&&n._delegate?n._delegate:n}class Pf{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ip="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _Z{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new rZ;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(SZ(e))try{this.getOrInitializeService({instanceIdentifier:Ip})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Ip){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ip){return this.instances.has(e)}getOptions(e=Ip){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(e,t){var i;const r=this.normalizeInstanceIdentifier(t),s=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;s.add(e),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:CZ(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ip){return this.component?this.component.multipleInstances?e:Ip:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function CZ(n){return n===Ip?void 0:n}function SZ(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TZ{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new _Z(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qr;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(qr||(qr={}));const BZ={debug:qr.DEBUG,verbose:qr.VERBOSE,info:qr.INFO,warn:qr.WARN,error:qr.ERROR,silent:qr.SILENT},EZ=qr.INFO,kZ={[qr.DEBUG]:"log",[qr.VERBOSE]:"log",[qr.INFO]:"info",[qr.WARN]:"warn",[qr.ERROR]:"error"},IZ=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=kZ[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let ek=class{constructor(e){this.name=e,this._logLevel=EZ,this._logHandler=IZ,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in qr))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?BZ[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,qr.DEBUG,...e),this._logHandler(this,qr.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,qr.VERBOSE,...e),this._logHandler(this,qr.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,qr.INFO,...e),this._logHandler(this,qr.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,qr.WARN,...e),this._logHandler(this,qr.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,qr.ERROR,...e),this._logHandler(this,qr.ERROR,...e)}};const FZ=(n,e)=>e.some(t=>n instanceof t);let j8,P8;function DZ(){return j8||(j8=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function jZ(){return P8||(P8=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const nU=new WeakMap,dB=new WeakMap,iU=new WeakMap,IS=new WeakMap,tk=new WeakMap;function PZ(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Bf(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&nU.set(t,n)}).catch(()=>{}),tk.set(e,n),e}function NZ(n){if(dB.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});dB.set(n,e)}let AB={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return dB.get(n);if(e==="objectStoreNames")return n.objectStoreNames||iU.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Bf(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function LZ(n){AB=n(AB)}function MZ(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(FS(this),e,...t);return iU.set(i,e.sort?e.sort():[e]),Bf(i)}:jZ().includes(n)?function(...e){return n.apply(FS(this),e),Bf(nU.get(this))}:function(...e){return Bf(n.apply(FS(this),e))}}function RZ(n){return typeof n=="function"?MZ(n):(n instanceof IDBTransaction&&NZ(n),FZ(n,DZ())?new Proxy(n,AB):n)}function Bf(n){if(n instanceof IDBRequest)return PZ(n);if(IS.has(n))return IS.get(n);const e=RZ(n);return e!==n&&(IS.set(n,e),tk.set(e,n)),e}const FS=n=>tk.get(n);function OZ(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),a=Bf(o);return i&&o.addEventListener("upgradeneeded",c=>{i(Bf(o.result),c.oldVersion,c.newVersion,Bf(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),r&&c.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),a}const UZ=["get","getKey","getAll","getAllKeys","count"],HZ=["put","add","delete","clear"],DS=new Map;function N8(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(DS.get(e))return DS.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=HZ.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||UZ.includes(t)))return;const s=async function(o,...a){const c=this.transaction(o,r?"readwrite":"readonly");let h=c.store;return i&&(h=h.index(a.shift())),(await Promise.all([h[t](...a),r&&c.done]))[0]};return DS.set(e,s),s}LZ(n=>({...n,get:(e,t,i)=>N8(e,t)||n.get(e,t,i),has:(e,t)=>!!N8(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WZ{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(QZ(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function QZ(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const fB="@firebase/app",L8="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mA=new ek("@firebase/app"),$Z="@firebase/app-compat",VZ="@firebase/analytics-compat",zZ="@firebase/analytics",GZ="@firebase/app-check-compat",XZ="@firebase/app-check",KZ="@firebase/auth",qZ="@firebase/auth-compat",YZ="@firebase/database",ZZ="@firebase/data-connect",JZ="@firebase/database-compat",eJ="@firebase/functions",tJ="@firebase/functions-compat",nJ="@firebase/installations",iJ="@firebase/installations-compat",rJ="@firebase/messaging",sJ="@firebase/messaging-compat",oJ="@firebase/performance",aJ="@firebase/performance-compat",lJ="@firebase/remote-config",cJ="@firebase/remote-config-compat",hJ="@firebase/storage",uJ="@firebase/storage-compat",dJ="@firebase/firestore",AJ="@firebase/ai",fJ="@firebase/firestore-compat",pJ="firebase",gJ="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pB="[DEFAULT]",mJ={[fB]:"fire-core",[$Z]:"fire-core-compat",[zZ]:"fire-analytics",[VZ]:"fire-analytics-compat",[XZ]:"fire-app-check",[GZ]:"fire-app-check-compat",[KZ]:"fire-auth",[qZ]:"fire-auth-compat",[YZ]:"fire-rtdb",[ZZ]:"fire-data-connect",[JZ]:"fire-rtdb-compat",[eJ]:"fire-fn",[tJ]:"fire-fn-compat",[nJ]:"fire-iid",[iJ]:"fire-iid-compat",[rJ]:"fire-fcm",[sJ]:"fire-fcm-compat",[oJ]:"fire-perf",[aJ]:"fire-perf-compat",[lJ]:"fire-rc",[cJ]:"fire-rc-compat",[hJ]:"fire-gcs",[uJ]:"fire-gcs-compat",[dJ]:"fire-fst",[fJ]:"fire-fst-compat",[AJ]:"fire-vertex","fire-js":"fire-js",[pJ]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f_=new Map,yJ=new Map,gB=new Map;function M8(n,e){try{n.container.addComponent(e)}catch(t){mA.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ag(n){const e=n.name;if(gB.has(e))return mA.debug(`There were multiple attempts to register component ${e}.`),!1;gB.set(e,n);for(const t of f_.values())M8(t,n);for(const t of yJ.values())M8(t,n);return!0}function XC(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function fc(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vJ={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ef=new Fv("app","Firebase",vJ);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wJ{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Pf("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ef.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bg=gJ;function rU(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:pB,automaticDataCollectionEnabled:!0},e),r=i.name;if(typeof r!="string"||!r)throw Ef.create("bad-app-name",{appName:String(r)});if(t||(t=JO()),!t)throw Ef.create("no-options");const s=f_.get(r);if(s){if(jf(t,s.options)&&jf(i,s.config))return s;throw Ef.create("duplicate-app",{appName:r})}const o=new TZ(r);for(const c of gB.values())o.addComponent(c);const a=new wJ(t,i,o);return f_.set(r,a),a}function nk(n=pB){const e=f_.get(n);if(!e&&n===pB&&JO())return rU();if(!e)throw Ef.create("no-app",{appName:n});return e}function ud(n,e,t){var i;let r=(i=mJ[n])!==null&&i!==void 0?i:n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),mA.warn(a.join(" "));return}ag(new Pf(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xJ="firebase-heartbeat-database",bJ=1,Ky="firebase-heartbeat-store";let jS=null;function sU(){return jS||(jS=OZ(xJ,bJ,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Ky)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ef.create("idb-open",{originalErrorMessage:n.message})})),jS}async function _J(n){try{const t=(await sU()).transaction(Ky),i=await t.objectStore(Ky).get(oU(n));return await t.done,i}catch(e){if(e instanceof Nu)mA.warn(e.message);else{const t=Ef.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});mA.warn(t.message)}}}async function R8(n,e){try{const i=(await sU()).transaction(Ky,"readwrite");await i.objectStore(Ky).put(e,oU(n)),await i.done}catch(t){if(t instanceof Nu)mA.warn(t.message);else{const i=Ef.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});mA.warn(i.message)}}}function oU(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CJ=1024,SJ=30;class TJ{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new EJ(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=O8();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats.length>SJ){const o=kJ(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){mA.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=O8(),{heartbeatsToSend:i,unsentEntries:r}=BJ(this._heartbeatsCache.heartbeats),s=A_(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return mA.warn(t),""}}}function O8(){return new Date().toISOString().substring(0,10)}function BJ(n,e=CJ){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),U8(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),U8(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class EJ{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return fZ()?pZ().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await _J(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return R8(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return R8(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function U8(n){return A_(JSON.stringify({version:2,heartbeats:n})).length}function kJ(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IJ(n){ag(new Pf("platform-logger",e=>new WZ(e),"PRIVATE")),ag(new Pf("heartbeat",e=>new TJ(e),"PRIVATE")),ud(fB,L8,n),ud(fB,L8,"esm2017"),ud("fire-js","")}IJ("");function ik(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t}function aU(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const lU=aU,cU=new Fv("auth","Firebase",aU());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p_=new ek("@firebase/auth");function FJ(n,...e){p_.logLevel<=qr.WARN&&p_.warn(`Auth (${bg}): ${n}`,...e)}function Nb(n,...e){p_.logLevel<=qr.ERROR&&p_.error(`Auth (${bg}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xh(n,...e){throw sk(n,...e)}function Cu(n,...e){return sk(n,...e)}function rk(n,e,t){const i=Object.assign(Object.assign({},lU()),{[e]:t});return new Fv("auth","Firebase",i).create(e,{appName:n.name})}function dd(n){return rk(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function hU(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&Xh(n,"argument-error"),rk(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function sk(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return cU.create(n,...e)}function ir(n,e,...t){if(!n)throw sk(e,...t)}function oA(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Nb(e),new Error(e)}function yA(n,e){n||oA(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mB(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function DJ(){return H8()==="http:"||H8()==="https:"}function H8(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jJ(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(DJ()||hZ()||"connection"in navigator)?navigator.onLine:!0}function PJ(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jv{constructor(e,t){this.shortDelay=e,this.longDelay=t,yA(t>e,"Short delay should be less than long delay!"),this.isMobile=aZ()||uZ()}get(){return jJ()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ok(n,e){yA(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uU{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;oA("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;oA("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;oA("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NJ={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LJ=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],MJ=new jv(3e4,6e4);function Yf(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function IA(n,e,t,i,r={}){return dU(n,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const a=Dv(Object.assign({key:n.config.apiKey},o)).slice(1),c=await n._getAdditionalHeaders();c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode);const h=Object.assign({method:e,headers:c},s);return cZ()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&qf(n.emulatorConfig.host)&&(h.credentials="include"),uU.fetch()(await AU(n,n.config.apiHost,t,a),h)})}async function dU(n,e,t){n._canInitEmulator=!1;const i=Object.assign(Object.assign({},NJ),e);try{const r=new OJ(n),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Qw(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[c,h]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Qw(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Qw(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Qw(n,"user-disabled",o);const u=i[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw rk(n,u,h);Xh(n,u)}}catch(r){if(r instanceof Nu)throw r;Xh(n,"network-request-failed",{message:String(r)})}}async function Pv(n,e,t,i,r={}){const s=await IA(n,e,t,i,r);return"mfaPendingCredential"in s&&Xh(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function AU(n,e,t,i){const r=`${e}${t}?${i}`,s=n,o=s.config.emulator?ok(n.config,r):`${n.config.apiScheme}://${r}`;return LJ.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}function RJ(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class OJ{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Cu(this.auth,"network-request-failed")),MJ.get())})}}function Qw(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=Cu(n,e,i);return r.customData._tokenResponse=t,r}function W8(n){return n!==void 0&&n.enterprise!==void 0}class UJ{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return RJ(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function HJ(n,e){return IA(n,"GET","/v2/recaptchaConfig",Yf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WJ(n,e){return IA(n,"POST","/v1/accounts:delete",e)}async function g_(n,e){return IA(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uy(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function fU(n,e=!1){const t=Zs(n),i=await t.getIdToken(e),r=ak(i);ir(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:uy(PS(r.auth_time)),issuedAtTime:uy(PS(r.iat)),expirationTime:uy(PS(r.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function PS(n){return Number(n)*1e3}function ak(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Nb("JWT malformed, contained fewer than 3 sections"),null;try{const r=qO(t);return r?JSON.parse(r):(Nb("Failed to decode base64 JWT payload"),null)}catch(r){return Nb("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function Q8(n){const e=ak(n);return ir(e,"internal-error"),ir(typeof e.exp<"u","internal-error"),ir(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pm(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Nu&&QJ(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function QJ({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $J{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const r=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yB{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=uy(this.lastLoginAt),this.creationTime=uy(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m_(n){var e;const t=n.auth,i=await n.getIdToken(),r=await pm(n,g_(t,{idToken:i}));ir(r==null?void 0:r.users.length,t,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?gU(s.providerUserInfo):[],a=VJ(n.providerData,o),c=n.isAnonymous,h=!(n.email&&s.passwordHash)&&!(a!=null&&a.length),u=c?h:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new yB(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(n,d)}async function pU(n){const e=Zs(n);await m_(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function VJ(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function gU(n){return n.map(e=>{var{providerId:t}=e,i=ik(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zJ(n,e){const t=await dU(n,{},async()=>{const i=Dv({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=await AU(n,r,"/v1/token",`key=${s}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:i};return n.emulatorConfig&&qf(n.emulatorConfig.host)&&(c.credentials="include"),uU.fetch()(o,c)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function GJ(n,e){return IA(n,"POST","/v2/accounts:revokeToken",Yf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z0{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ir(e.idToken,"internal-error"),ir(typeof e.idToken<"u","internal-error"),ir(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Q8(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ir(e.length!==0,"internal-error");const t=Q8(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ir(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:s}=await zJ(e,t);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new Z0;return i&&(ir(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(ir(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(ir(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Z0,this.toJSON())}_performRefresh(){return oA("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XA(n,e){ir(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class vu{constructor(e){var{uid:t,auth:i,stsTokenManager:r}=e,s=ik(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new $J(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new yB(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await pm(this,this.stsTokenManager.getToken(this.auth,e));return ir(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return fU(this,e)}reload(){return pU(this)}_assign(e){this!==e&&(ir(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new vu(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ir(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await m_(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(fc(this.auth.app))return Promise.reject(dd(this.auth));const e=await this.getIdToken();return await pm(this,WJ(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,r,s,o,a,c,h,u;const d=(i=t.displayName)!==null&&i!==void 0?i:void 0,f=(r=t.email)!==null&&r!==void 0?r:void 0,A=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,g=(o=t.photoURL)!==null&&o!==void 0?o:void 0,p=(a=t.tenantId)!==null&&a!==void 0?a:void 0,y=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,v=(h=t.createdAt)!==null&&h!==void 0?h:void 0,m=(u=t.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:w,emailVerified:x,isAnonymous:T,providerData:j,stsTokenManager:D}=t;ir(w&&D,e,"internal-error");const b=Z0.fromJSON(this.name,D);ir(typeof w=="string",e,"internal-error"),XA(d,e.name),XA(f,e.name),ir(typeof x=="boolean",e,"internal-error"),ir(typeof T=="boolean",e,"internal-error"),XA(A,e.name),XA(g,e.name),XA(p,e.name),XA(y,e.name),XA(v,e.name),XA(m,e.name);const _=new vu({uid:w,auth:e,email:f,emailVerified:x,displayName:d,isAnonymous:T,photoURL:g,phoneNumber:A,tenantId:p,stsTokenManager:b,createdAt:v,lastLoginAt:m});return j&&Array.isArray(j)&&(_.providerData=j.map(I=>Object.assign({},I))),y&&(_._redirectEventId=y),_}static async _fromIdTokenResponse(e,t,i=!1){const r=new Z0;r.updateFromServerResponse(t);const s=new vu({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await m_(s),s}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];ir(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?gU(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!(s!=null&&s.length),a=new Z0;a.updateFromIdToken(i);const c=new vu({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new yB(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,h),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $8=new Map;function aA(n){yA(n instanceof Function,"Expected a class definition");let e=$8.get(n);return e?(yA(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,$8.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mU{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}mU.type="NONE";const vB=mU;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lb(n,e,t){return`firebase:${n}:${e}:${t}`}class J0{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=Lb(this.userKey,r.apiKey,s),this.fullPersistenceKey=Lb("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await g_(this.auth,{idToken:e}).catch(()=>{});return t?vu._fromGetAccountInfoResponse(this.auth,t,e):null}return vu._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new J0(aA(vB),e,i);const r=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||aA(vB);const o=Lb(i,e.config.apiKey,e.name);let a=null;for(const h of t)try{const u=await h._get(o);if(u){let d;if(typeof u=="string"){const f=await g_(e,{idToken:u}).catch(()=>{});if(!f)break;d=await vu._fromGetAccountInfoResponse(e,f,u)}else d=vu._fromJSON(e,u);h!==s&&(a=d),s=h;break}}catch{}const c=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new J0(s,e,i):(s=c[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new J0(s,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V8(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(xU(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(yU(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(_U(e))return"Blackberry";if(CU(e))return"Webos";if(vU(e))return"Safari";if((e.includes("chrome/")||wU(e))&&!e.includes("edge/"))return"Chrome";if(bU(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function yU(n=Jl()){return/firefox\//i.test(n)}function vU(n=Jl()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function wU(n=Jl()){return/crios\//i.test(n)}function xU(n=Jl()){return/iemobile/i.test(n)}function bU(n=Jl()){return/android/i.test(n)}function _U(n=Jl()){return/blackberry/i.test(n)}function CU(n=Jl()){return/webos/i.test(n)}function lk(n=Jl()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function XJ(n=Jl()){var e;return lk(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function KJ(){return dZ()&&document.documentMode===10}function SU(n=Jl()){return lk(n)||bU(n)||CU(n)||_U(n)||/windows phone/i.test(n)||xU(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TU(n,e=[]){let t;switch(n){case"Browser":t=V8(Jl());break;case"Worker":t=`${V8(Jl())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${bg}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qJ{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=s=>new Promise((o,a)=>{try{const c=e(s);o(c)}catch(c){a(c)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YJ(n,e={}){return IA(n,"GET","/v2/passwordPolicy",Yf(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZJ=6;class JJ{constructor(e){var t,i,r,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:ZJ,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,r,s,o,a;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(i=c.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(r=c.containsLowercaseLetter)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eee{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new z8(this),this.idTokenSubscription=new z8(this),this.beforeStateQueue=new qJ(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=cU,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=aA(t)),this._initializationPromise=this.queue(async()=>{var i,r,s;if(!this._deleted&&(this.persistenceManager=await J0.create(this,e),(i=this._resolvePersistenceManagerAvailable)===null||i===void 0||i.call(this),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await g_(this,{idToken:e}),i=await vu._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(fc(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let r=i,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=r==null?void 0:r._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&(c!=null&&c.user)&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ir(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await m_(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=PJ()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(fc(this.app))return Promise.reject(dd(this));const t=e?Zs(e):null;return t&&ir(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ir(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return fc(this.app)?Promise.reject(dd(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return fc(this.app)?Promise.reject(dd(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(aA(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await YJ(this),t=new JJ(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Fv("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await GJ(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&aA(e)||this._popupRedirectResolver;ir(t,this,"argument-error"),this.redirectPersistenceManager=await J0.create(this,[aA(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ir(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const c=e.addObserver(t,i,r);return()=>{o=!0,c()}}else{const c=e.addObserver(t);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ir(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=TU(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const i=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());i&&(t["X-Firebase-Client"]=i);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if(fc(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&FJ(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Td(n){return Zs(n)}class z8{constructor(e){this.auth=e,this.observer=null,this.addObserver=wZ(t=>this.observer=t)}get next(){return ir(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let KC={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function tee(n){KC=n}function BU(n){return KC.loadJS(n)}function nee(){return KC.recaptchaEnterpriseScript}function iee(){return KC.gapiScript}function ree(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class see{constructor(){this.enterprise=new oee}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class oee{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const aee="recaptcha-enterprise",EU="NO_RECAPTCHA";class lee{constructor(e){this.type=aee,this.auth=Td(e)}async verify(e="verify",t=!1){async function i(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{HJ(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const h=new UJ(c);return s.tenantId==null?s._agentRecaptchaConfig=h:s._tenantRecaptchaConfigs[s.tenantId]=h,o(h.siteKey)}}).catch(c=>{a(c)})})}function r(s,o,a){const c=window.grecaptcha;W8(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(h=>{o(h)}).catch(()=>{o(EU)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new see().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{i(this.auth).then(a=>{if(!t&&W8(window.grecaptcha))r(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=nee();c.length!==0&&(c+=a),BU(c).then(()=>{r(a,s,o)}).catch(h=>{o(h)})}}).catch(a=>{o(a)})})}}async function G8(n,e,t,i=!1,r=!1){const s=new lee(n);let o;if(r)o=EU;else try{o=await s.verify(t)}catch{o=await s.verify(t,!0)}const a=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const c=a.phoneEnrollmentInfo.phoneNumber,h=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:h,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const c=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return i?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function wB(n,e,t,i,r){var s;if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await G8(n,e,t,t==="getOobCode");return i(n,o)}else return i(n,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await G8(n,e,t,t==="getOobCode");return i(n,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kU(n,e){const t=XC(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(jf(s,e??{}))return r;Xh(r,"already-initialized")}return t.initialize({options:e})}function cee(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(aA);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function IU(n,e,t){const i=Td(n);ir(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,s=FU(e),{host:o,port:a}=hee(e),c=a===null?"":`:${a}`,h={url:`${s}//${o}${c}/`},u=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){ir(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),ir(jf(h,i.config.emulator)&&jf(u,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=u,i.settings.appVerificationDisabledForTesting=!0,qf(o)?(Z6(`${s}//${o}${c}`),J6("Auth",!0)):uee()}function FU(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function hee(n){const e=FU(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:X8(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:X8(o)}}}function X8(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function uee(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qC{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return oA("not implemented")}_getIdTokenResponse(e){return oA("not implemented")}_linkToIdToken(e,t){return oA("not implemented")}_getReauthenticationResolver(e){return oA("not implemented")}}async function dee(n,e){return IA(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Aee(n,e){return Pv(n,"POST","/v1/accounts:signInWithPassword",Yf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fee(n,e){return Pv(n,"POST","/v1/accounts:signInWithEmailLink",Yf(n,e))}async function pee(n,e){return Pv(n,"POST","/v1/accounts:signInWithEmailLink",Yf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gm extends qC{constructor(e,t,i,r=null){super("password",i),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new gm(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new gm(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return wB(e,t,"signInWithPassword",Aee);case"emailLink":return fee(e,{email:this._email,oobCode:this._password});default:Xh(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return wB(e,i,"signUpPassword",dee);case"emailLink":return pee(e,{idToken:t,email:this._email,oobCode:this._password});default:Xh(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function em(n,e){return Pv(n,"POST","/v1/accounts:signInWithIdp",Yf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gee="http://localhost";class Nf extends qC{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Nf(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Xh("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r}=t,s=ik(t,["providerId","signInMethod"]);if(!i||!r)return null;const o=new Nf(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return em(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,em(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,em(e,t)}buildRequest(){const e={requestUri:gee,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Dv(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mee(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function yee(n){const e=U2(H2(n)).link,t=e?U2(H2(e)).deep_link_id:null,i=U2(H2(n)).deep_link_id;return(i?U2(H2(i)).link:null)||i||t||e||n}class YC{constructor(e){var t,i,r,s,o,a;const c=U2(H2(e)),h=(t=c.apiKey)!==null&&t!==void 0?t:null,u=(i=c.oobCode)!==null&&i!==void 0?i:null,d=mee((r=c.mode)!==null&&r!==void 0?r:null);ir(h&&u&&d,"argument-error"),this.apiKey=h,this.operation=d,this.code=u,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.lang)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const t=yee(e);try{return new YC(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _g{constructor(){this.providerId=_g.PROVIDER_ID}static credential(e,t){return gm._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=YC.parseLink(t);return ir(i,"argument-error"),gm._fromEmailAndCode(e,i.code,i.tenantId)}}_g.PROVIDER_ID="password";_g.EMAIL_PASSWORD_SIGN_IN_METHOD="password";_g.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nv extends ZC{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nA extends Nv{constructor(){super("facebook.com")}static credential(e){return Nf._fromParams({providerId:nA.PROVIDER_ID,signInMethod:nA.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return nA.credentialFromTaggedObject(e)}static credentialFromError(e){return nA.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return nA.credential(e.oauthAccessToken)}catch{return null}}}nA.FACEBOOK_SIGN_IN_METHOD="facebook.com";nA.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sd extends Nv{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Nf._fromParams({providerId:sd.PROVIDER_ID,signInMethod:sd.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return sd.credentialFromTaggedObject(e)}static credentialFromError(e){return sd.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return sd.credential(t,i)}catch{return null}}}sd.GOOGLE_SIGN_IN_METHOD="google.com";sd.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iA extends Nv{constructor(){super("github.com")}static credential(e){return Nf._fromParams({providerId:iA.PROVIDER_ID,signInMethod:iA.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return iA.credentialFromTaggedObject(e)}static credentialFromError(e){return iA.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return iA.credential(e.oauthAccessToken)}catch{return null}}}iA.GITHUB_SIGN_IN_METHOD="github.com";iA.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rA extends Nv{constructor(){super("twitter.com")}static credential(e,t){return Nf._fromParams({providerId:rA.PROVIDER_ID,signInMethod:rA.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return rA.credentialFromTaggedObject(e)}static credentialFromError(e){return rA.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return rA.credential(t,i)}catch{return null}}}rA.TWITTER_SIGN_IN_METHOD="twitter.com";rA.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vee(n,e){return Pv(n,"POST","/v1/accounts:signUp",Yf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lg{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const s=await vu._fromIdTokenResponse(e,i,r),o=K8(i);return new lg({user:s,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=K8(i);return new lg({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function K8(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_ extends Nu{constructor(e,t,i,r){var s;super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,y_.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new y_(e,t,i,r)}}function DU(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?y_._fromErrorAndOperation(n,s,e,i):s})}async function wee(n,e,t=!1){const i=await pm(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return lg._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xee(n,e,t=!1){const{auth:i}=n;if(fc(i.app))return Promise.reject(dd(i));const r="reauthenticate";try{const s=await pm(n,DU(i,r,e,n),t);ir(s.idToken,i,"internal-error");const o=ak(s.idToken);ir(o,i,"internal-error");const{sub:a}=o;return ir(n.uid===a,i,"user-mismatch"),lg._forOperation(n,r,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Xh(i,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jU(n,e,t=!1){if(fc(n.app))return Promise.reject(dd(n));const i="signIn",r=await DU(n,i,e),s=await lg._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(s.user),s}async function PU(n,e){return jU(Td(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NU(n){const e=Td(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function LU(n,e,t){if(fc(n.app))return Promise.reject(dd(n));const i=Td(n),o=await wB(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",vee).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&NU(n),c}),a=await lg._fromIdTokenResponse(i,"signIn",o);return await i._updateCurrentUser(a.user),a}function MU(n,e,t){return fc(n.app)?Promise.reject(dd(n)):PU(Zs(n),_g.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&NU(n),i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bee(n,e){return IA(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JC(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const i=Zs(n),s={idToken:await i.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await pm(i,bee(i.auth,s));i.displayName=o.displayName||null,i.photoURL=o.photoUrl||null;const a=i.providerData.find(({providerId:c})=>c==="password");a&&(a.displayName=i.displayName,a.photoURL=i.photoURL),await i._updateTokensIfNecessary(o)}function RU(n,e,t,i){return Zs(n).onIdTokenChanged(e,t,i)}function OU(n,e,t){return Zs(n).beforeAuthStateChanged(e,t)}function ck(n,e,t,i){return Zs(n).onAuthStateChanged(e,t,i)}function UU(n){return Zs(n).signOut()}const v_="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HU{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(v_,"1"),this.storage.removeItem(v_),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _ee=1e3,Cee=10;class WU extends HU{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=SU(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);KJ()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,Cee):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},_ee)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}WU.type="LOCAL";const QU=WU;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $U extends HU{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}$U.type="SESSION";const hk=$U;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function See(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e5{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new e5(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const a=Array.from(o).map(async h=>h(t.origin,s)),c=await See(a);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:c})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}e5.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uk(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tee{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{const h=uk("",20);r.port1.start();const u=setTimeout(()=>{c(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(d){const f=d;if(f.data.eventId===h)switch(f.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(f.data.response);break;default:clearTimeout(u),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ad(){return window}function Bee(n){Ad().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VU(){return typeof Ad().WorkerGlobalScope<"u"&&typeof Ad().importScripts=="function"}async function Eee(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function kee(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Iee(){return VU()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zU="firebaseLocalStorageDb",Fee=1,w_="firebaseLocalStorage",GU="fbase_key";class Lv{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function t5(n,e){return n.transaction([w_],e?"readwrite":"readonly").objectStore(w_)}function Dee(){const n=indexedDB.deleteDatabase(zU);return new Lv(n).toPromise()}function xB(){const n=indexedDB.open(zU,Fee);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(w_,{keyPath:GU})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(w_)?e(i):(i.close(),await Dee(),e(await xB()))})})}async function q8(n,e,t){const i=t5(n,!0).put({[GU]:e,value:t});return new Lv(i).toPromise()}async function jee(n,e){const t=t5(n,!1).get(e),i=await new Lv(t).toPromise();return i===void 0?null:i.value}function Y8(n,e){const t=t5(n,!0).delete(e);return new Lv(t).toPromise()}const Pee=800,Nee=3;class XU{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await xB(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>Nee)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return VU()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=e5._getInstance(Iee()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await Eee(),!this.activeServiceWorker)return;this.sender=new Tee(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((e=i[0])===null||e===void 0)&&e.fulfilled&&!((t=i[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||kee()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await xB();return await q8(e,v_,"1"),await Y8(e,v_),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>q8(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>jee(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Y8(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=t5(r,!1).getAll();return new Lv(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Pee)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}XU.type="LOCAL";const KU=XU;new jv(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dk(n,e){return e?aA(e):(ir(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ak extends qC{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return em(e,this._buildIdpRequest())}_linkToIdToken(e,t){return em(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return em(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Lee(n){return jU(n.auth,new Ak(n),n.bypassAuthState)}function Mee(n){const{auth:e,user:t}=n;return ir(t,e,"internal-error"),xee(t,new Ak(n),n.bypassAuthState)}async function Ree(n){const{auth:e,user:t}=n;return ir(t,e,"internal-error"),wee(t,new Ak(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qU{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Lee;case"linkViaPopup":case"linkViaRedirect":return Ree;case"reauthViaPopup":case"reauthViaRedirect":return Mee;default:Xh(this.auth,"internal-error")}}resolve(e){yA(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){yA(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oee=new jv(2e3,1e4);async function YU(n,e,t){if(fc(n.app))return Promise.reject(Cu(n,"operation-not-supported-in-this-environment"));const i=Td(n);hU(n,e,ZC);const r=dk(i,t);return new Op(i,"signInViaPopup",e,r).executeNotNull()}class Op extends qU{constructor(e,t,i,r,s){super(e,t,r,s),this.provider=i,this.authWindow=null,this.pollId=null,Op.currentPopupAction&&Op.currentPopupAction.cancel(),Op.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ir(e,this.auth,"internal-error"),e}async onExecution(){yA(this.filter.length===1,"Popup operations only handle one event");const e=uk();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Cu(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Cu(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Op.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if(!((i=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Cu(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Oee.get())};e()}}Op.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uee="pendingRedirect",Mb=new Map;class Hee extends qU{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Mb.get(this.auth._key());if(!e){try{const i=await Wee(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Mb.set(this.auth._key(),e)}return this.bypassAuthState||Mb.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Wee(n,e){const t=JU(e),i=ZU(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}async function Qee(n,e){return ZU(n)._set(JU(e),"true")}function $ee(n,e){Mb.set(n._key(),e)}function ZU(n){return aA(n._redirectPersistence)}function JU(n){return Lb(Uee,n.config.apiKey,n.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vee(n,e,t){return zee(n,e,t)}async function zee(n,e,t){if(fc(n.app))return Promise.reject(dd(n));const i=Td(n);hU(n,e,ZC),await i._initializationPromise;const r=dk(i,t);return await Qee(r,i),r._openRedirect(i,e,"signInViaRedirect")}async function eH(n,e){return await Td(n)._initializationPromise,tH(n,e,!1)}async function tH(n,e,t=!1){if(fc(n.app))return Promise.reject(dd(n));const i=Td(n),r=dk(i,e),o=await new Hee(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gee=600*1e3;class Xee{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Kee(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!nH(e)){const r=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(Cu(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Gee&&this.cachedEventUids.clear(),this.cachedEventUids.has(Z8(e))}saveEventToCache(e){this.cachedEventUids.add(Z8(e)),this.lastProcessedEventTime=Date.now()}}function Z8(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function nH({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Kee(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return nH(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qee(n,e={}){return IA(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yee=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Zee=/^https?/;async function Jee(n){if(n.config.emulator)return;const{authorizedDomains:e}=await qee(n);for(const t of e)try{if(ete(t))return}catch{}Xh(n,"unauthorized-domain")}function ete(n){const e=mB(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!Zee.test(t))return!1;if(Yee.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tte=new jv(3e4,6e4);function J8(){const n=Ad().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function nte(n){return new Promise((e,t)=>{var i,r,s;function o(){J8(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{J8(),t(Cu(n,"network-request-failed"))},timeout:tte.get()})}if(!((r=(i=Ad().gapi)===null||i===void 0?void 0:i.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((s=Ad().gapi)===null||s===void 0)&&s.load)o();else{const a=ree("iframefcb");return Ad()[a]=()=>{gapi.load?o():t(Cu(n,"network-request-failed"))},BU(`${iee()}?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw Rb=null,e})}let Rb=null;function ite(n){return Rb=Rb||nte(n),Rb}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rte=new jv(5e3,15e3),ste="__/auth/iframe",ote="emulator/auth/iframe",ate={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},lte=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function cte(n){const e=n.config;ir(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?ok(e,ote):`https://${n.config.authDomain}/${ste}`,i={apiKey:e.apiKey,appName:n.name,v:bg},r=lte.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${Dv(i).slice(1)}`}async function hte(n){const e=await ite(n),t=Ad().gapi;return ir(t,n,"internal-error"),e.open({where:document.body,url:cte(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ate,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=Cu(n,"network-request-failed"),a=Ad().setTimeout(()=>{s(o)},rte.get());function c(){Ad().clearTimeout(a),r(i)}i.ping(c).then(c,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ute={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},dte=500,Ate=600,fte="_blank",pte="http://localhost";class eD{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function gte(n,e,t,i=dte,r=Ate){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const c=Object.assign(Object.assign({},ute),{width:i.toString(),height:r.toString(),top:s,left:o}),h=Jl().toLowerCase();t&&(a=wU(h)?fte:t),yU(h)&&(e=e||pte,c.scrollbars="yes");const u=Object.entries(c).reduce((f,[A,g])=>`${f}${A}=${g},`,"");if(XJ(h)&&a!=="_self")return mte(e||"",a),new eD(null);const d=window.open(e||"",a,u);ir(d,n,"popup-blocked");try{d.focus()}catch{}return new eD(d)}function mte(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yte="__/auth/handler",vte="emulator/auth/handler",wte=encodeURIComponent("fac");async function tD(n,e,t,i,r,s){ir(n.config.authDomain,n,"auth-domain-config-required"),ir(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:bg,eventId:r};if(e instanceof ZC){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",vZ(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,d]of Object.entries({}))o[u]=d}if(e instanceof Nv){const u=e.getScopes().filter(d=>d!=="");u.length>0&&(o.scopes=u.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const c=await n._getAppCheckToken(),h=c?`#${wte}=${encodeURIComponent(c)}`:"";return`${xte(n)}?${Dv(a).slice(1)}${h}`}function xte({config:n}){return n.emulator?ok(n,vte):`https://${n.authDomain}/${yte}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NS="webStorageSupport";class bte{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=hk,this._completeRedirectFn=tH,this._overrideRedirectResult=$ee}async _openPopup(e,t,i,r){var s;yA((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await tD(e,t,i,mB(),r);return gte(e,o,uk())}async _openRedirect(e,t,i,r){await this._originValidation(e);const s=await tD(e,t,i,mB(),r);return Bee(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(yA(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await hte(e),i=new Xee(e);return t.register("authEvent",r=>(ir(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(NS,{type:NS},r=>{var s;const o=(s=r==null?void 0:r[0])===null||s===void 0?void 0:s[NS];o!==void 0&&t(!!o),Xh(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Jee(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return SU()||vU()||lk()}}const iH=bte;var nD="@firebase/auth",iD="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _te{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ir(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cte(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Ste(n){ag(new Pf("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;ir(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:TU(n)},h=new eee(i,r,s,c);return cee(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),ag(new Pf("auth-internal",e=>{const t=Td(e.getProvider("auth").getImmediate());return(i=>new _te(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ud(nD,iD,Cte(n)),ud(nD,iD,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tte=300,Bte=eU("authIdTokenMaxAge")||Tte;let rD=null;const Ete=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>Bte)return;const r=t==null?void 0:t.token;rD!==r&&(rD=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function rH(n=nk()){const e=XC(n,"auth");if(e.isInitialized())return e.getImmediate();const t=kU(n,{popupRedirectResolver:iH,persistence:[KU,QU,hk]}),i=eU("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=Ete(s.toString());OU(t,o,()=>o(t.currentUser)),RU(t,a=>o(a))}}const r=YO("auth");return r&&IU(t,`http://${r}`),t}function kte(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}tee({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const s=Cu("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",kte().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Ste("Browser");const sH=Object.freeze(Object.defineProperty({__proto__:null,ActionCodeURL:YC,AuthCredential:qC,EmailAuthCredential:gm,EmailAuthProvider:_g,FacebookAuthProvider:nA,GithubAuthProvider:iA,GoogleAuthProvider:sd,OAuthCredential:Nf,TwitterAuthProvider:rA,beforeAuthStateChanged:OU,browserLocalPersistence:QU,browserPopupRedirectResolver:iH,browserSessionPersistence:hk,connectAuthEmulator:IU,createUserWithEmailAndPassword:LU,getAuth:rH,getIdTokenResult:fU,getRedirectResult:eH,inMemoryPersistence:vB,indexedDBLocalPersistence:KU,initializeAuth:kU,onAuthStateChanged:ck,onIdTokenChanged:RU,prodErrorMap:lU,reload:pU,signInWithCredential:PU,signInWithEmailAndPassword:MU,signInWithPopup:YU,signInWithRedirect:Vee,signOut:UU,updateProfile:JC},Symbol.toStringTag,{value:"Module"}));var Ite="firebase",Fte="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ud(Ite,Fte,"app");var sD=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var kf,oH;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(D,b){function _(){}_.prototype=b.prototype,D.D=b.prototype,D.prototype=new _,D.prototype.constructor=D,D.C=function(I,S,F){for(var B=Array(arguments.length-2),E=2;E<arguments.length;E++)B[E-2]=arguments[E];return b.prototype[S].apply(I,B)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(D,b,_){_||(_=0);var I=Array(16);if(typeof b=="string")for(var S=0;16>S;++S)I[S]=b.charCodeAt(_++)|b.charCodeAt(_++)<<8|b.charCodeAt(_++)<<16|b.charCodeAt(_++)<<24;else for(S=0;16>S;++S)I[S]=b[_++]|b[_++]<<8|b[_++]<<16|b[_++]<<24;b=D.g[0],_=D.g[1],S=D.g[2];var F=D.g[3],B=b+(F^_&(S^F))+I[0]+3614090360&4294967295;b=_+(B<<7&4294967295|B>>>25),B=F+(S^b&(_^S))+I[1]+3905402710&4294967295,F=b+(B<<12&4294967295|B>>>20),B=S+(_^F&(b^_))+I[2]+606105819&4294967295,S=F+(B<<17&4294967295|B>>>15),B=_+(b^S&(F^b))+I[3]+3250441966&4294967295,_=S+(B<<22&4294967295|B>>>10),B=b+(F^_&(S^F))+I[4]+4118548399&4294967295,b=_+(B<<7&4294967295|B>>>25),B=F+(S^b&(_^S))+I[5]+1200080426&4294967295,F=b+(B<<12&4294967295|B>>>20),B=S+(_^F&(b^_))+I[6]+2821735955&4294967295,S=F+(B<<17&4294967295|B>>>15),B=_+(b^S&(F^b))+I[7]+4249261313&4294967295,_=S+(B<<22&4294967295|B>>>10),B=b+(F^_&(S^F))+I[8]+1770035416&4294967295,b=_+(B<<7&4294967295|B>>>25),B=F+(S^b&(_^S))+I[9]+2336552879&4294967295,F=b+(B<<12&4294967295|B>>>20),B=S+(_^F&(b^_))+I[10]+4294925233&4294967295,S=F+(B<<17&4294967295|B>>>15),B=_+(b^S&(F^b))+I[11]+2304563134&4294967295,_=S+(B<<22&4294967295|B>>>10),B=b+(F^_&(S^F))+I[12]+1804603682&4294967295,b=_+(B<<7&4294967295|B>>>25),B=F+(S^b&(_^S))+I[13]+4254626195&4294967295,F=b+(B<<12&4294967295|B>>>20),B=S+(_^F&(b^_))+I[14]+2792965006&4294967295,S=F+(B<<17&4294967295|B>>>15),B=_+(b^S&(F^b))+I[15]+1236535329&4294967295,_=S+(B<<22&4294967295|B>>>10),B=b+(S^F&(_^S))+I[1]+4129170786&4294967295,b=_+(B<<5&4294967295|B>>>27),B=F+(_^S&(b^_))+I[6]+3225465664&4294967295,F=b+(B<<9&4294967295|B>>>23),B=S+(b^_&(F^b))+I[11]+643717713&4294967295,S=F+(B<<14&4294967295|B>>>18),B=_+(F^b&(S^F))+I[0]+3921069994&4294967295,_=S+(B<<20&4294967295|B>>>12),B=b+(S^F&(_^S))+I[5]+3593408605&4294967295,b=_+(B<<5&4294967295|B>>>27),B=F+(_^S&(b^_))+I[10]+38016083&4294967295,F=b+(B<<9&4294967295|B>>>23),B=S+(b^_&(F^b))+I[15]+3634488961&4294967295,S=F+(B<<14&4294967295|B>>>18),B=_+(F^b&(S^F))+I[4]+3889429448&4294967295,_=S+(B<<20&4294967295|B>>>12),B=b+(S^F&(_^S))+I[9]+568446438&4294967295,b=_+(B<<5&4294967295|B>>>27),B=F+(_^S&(b^_))+I[14]+3275163606&4294967295,F=b+(B<<9&4294967295|B>>>23),B=S+(b^_&(F^b))+I[3]+4107603335&4294967295,S=F+(B<<14&4294967295|B>>>18),B=_+(F^b&(S^F))+I[8]+1163531501&4294967295,_=S+(B<<20&4294967295|B>>>12),B=b+(S^F&(_^S))+I[13]+2850285829&4294967295,b=_+(B<<5&4294967295|B>>>27),B=F+(_^S&(b^_))+I[2]+4243563512&4294967295,F=b+(B<<9&4294967295|B>>>23),B=S+(b^_&(F^b))+I[7]+1735328473&4294967295,S=F+(B<<14&4294967295|B>>>18),B=_+(F^b&(S^F))+I[12]+2368359562&4294967295,_=S+(B<<20&4294967295|B>>>12),B=b+(_^S^F)+I[5]+4294588738&4294967295,b=_+(B<<4&4294967295|B>>>28),B=F+(b^_^S)+I[8]+2272392833&4294967295,F=b+(B<<11&4294967295|B>>>21),B=S+(F^b^_)+I[11]+1839030562&4294967295,S=F+(B<<16&4294967295|B>>>16),B=_+(S^F^b)+I[14]+4259657740&4294967295,_=S+(B<<23&4294967295|B>>>9),B=b+(_^S^F)+I[1]+2763975236&4294967295,b=_+(B<<4&4294967295|B>>>28),B=F+(b^_^S)+I[4]+1272893353&4294967295,F=b+(B<<11&4294967295|B>>>21),B=S+(F^b^_)+I[7]+4139469664&4294967295,S=F+(B<<16&4294967295|B>>>16),B=_+(S^F^b)+I[10]+3200236656&4294967295,_=S+(B<<23&4294967295|B>>>9),B=b+(_^S^F)+I[13]+681279174&4294967295,b=_+(B<<4&4294967295|B>>>28),B=F+(b^_^S)+I[0]+3936430074&4294967295,F=b+(B<<11&4294967295|B>>>21),B=S+(F^b^_)+I[3]+3572445317&4294967295,S=F+(B<<16&4294967295|B>>>16),B=_+(S^F^b)+I[6]+76029189&4294967295,_=S+(B<<23&4294967295|B>>>9),B=b+(_^S^F)+I[9]+3654602809&4294967295,b=_+(B<<4&4294967295|B>>>28),B=F+(b^_^S)+I[12]+3873151461&4294967295,F=b+(B<<11&4294967295|B>>>21),B=S+(F^b^_)+I[15]+530742520&4294967295,S=F+(B<<16&4294967295|B>>>16),B=_+(S^F^b)+I[2]+3299628645&4294967295,_=S+(B<<23&4294967295|B>>>9),B=b+(S^(_|~F))+I[0]+4096336452&4294967295,b=_+(B<<6&4294967295|B>>>26),B=F+(_^(b|~S))+I[7]+1126891415&4294967295,F=b+(B<<10&4294967295|B>>>22),B=S+(b^(F|~_))+I[14]+2878612391&4294967295,S=F+(B<<15&4294967295|B>>>17),B=_+(F^(S|~b))+I[5]+4237533241&4294967295,_=S+(B<<21&4294967295|B>>>11),B=b+(S^(_|~F))+I[12]+1700485571&4294967295,b=_+(B<<6&4294967295|B>>>26),B=F+(_^(b|~S))+I[3]+2399980690&4294967295,F=b+(B<<10&4294967295|B>>>22),B=S+(b^(F|~_))+I[10]+4293915773&4294967295,S=F+(B<<15&4294967295|B>>>17),B=_+(F^(S|~b))+I[1]+2240044497&4294967295,_=S+(B<<21&4294967295|B>>>11),B=b+(S^(_|~F))+I[8]+1873313359&4294967295,b=_+(B<<6&4294967295|B>>>26),B=F+(_^(b|~S))+I[15]+4264355552&4294967295,F=b+(B<<10&4294967295|B>>>22),B=S+(b^(F|~_))+I[6]+2734768916&4294967295,S=F+(B<<15&4294967295|B>>>17),B=_+(F^(S|~b))+I[13]+1309151649&4294967295,_=S+(B<<21&4294967295|B>>>11),B=b+(S^(_|~F))+I[4]+4149444226&4294967295,b=_+(B<<6&4294967295|B>>>26),B=F+(_^(b|~S))+I[11]+3174756917&4294967295,F=b+(B<<10&4294967295|B>>>22),B=S+(b^(F|~_))+I[2]+718787259&4294967295,S=F+(B<<15&4294967295|B>>>17),B=_+(F^(S|~b))+I[9]+3951481745&4294967295,D.g[0]=D.g[0]+b&4294967295,D.g[1]=D.g[1]+(S+(B<<21&4294967295|B>>>11))&4294967295,D.g[2]=D.g[2]+S&4294967295,D.g[3]=D.g[3]+F&4294967295}i.prototype.u=function(D,b){b===void 0&&(b=D.length);for(var _=b-this.blockSize,I=this.B,S=this.h,F=0;F<b;){if(S==0)for(;F<=_;)r(this,D,F),F+=this.blockSize;if(typeof D=="string"){for(;F<b;)if(I[S++]=D.charCodeAt(F++),S==this.blockSize){r(this,I),S=0;break}}else for(;F<b;)if(I[S++]=D[F++],S==this.blockSize){r(this,I),S=0;break}}this.h=S,this.o+=b},i.prototype.v=function(){var D=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);D[0]=128;for(var b=1;b<D.length-8;++b)D[b]=0;var _=8*this.o;for(b=D.length-8;b<D.length;++b)D[b]=_&255,_/=256;for(this.u(D),D=Array(16),b=_=0;4>b;++b)for(var I=0;32>I;I+=8)D[_++]=this.g[b]>>>I&255;return D};function s(D,b){var _=a;return Object.prototype.hasOwnProperty.call(_,D)?_[D]:_[D]=b(D)}function o(D,b){this.h=b;for(var _=[],I=!0,S=D.length-1;0<=S;S--){var F=D[S]|0;I&&F==b||(_[S]=F,I=!1)}this.g=_}var a={};function c(D){return-128<=D&&128>D?s(D,function(b){return new o([b|0],0>b?-1:0)}):new o([D|0],0>D?-1:0)}function h(D){if(isNaN(D)||!isFinite(D))return d;if(0>D)return y(h(-D));for(var b=[],_=1,I=0;D>=_;I++)b[I]=D/_|0,_*=4294967296;return new o(b,0)}function u(D,b){if(D.length==0)throw Error("number format error: empty string");if(b=b||10,2>b||36<b)throw Error("radix out of range: "+b);if(D.charAt(0)=="-")return y(u(D.substring(1),b));if(0<=D.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=h(Math.pow(b,8)),I=d,S=0;S<D.length;S+=8){var F=Math.min(8,D.length-S),B=parseInt(D.substring(S,S+F),b);8>F?(F=h(Math.pow(b,F)),I=I.j(F).add(h(B))):(I=I.j(_),I=I.add(h(B)))}return I}var d=c(0),f=c(1),A=c(16777216);n=o.prototype,n.m=function(){if(p(this))return-y(this).m();for(var D=0,b=1,_=0;_<this.g.length;_++){var I=this.i(_);D+=(0<=I?I:4294967296+I)*b,b*=4294967296}return D},n.toString=function(D){if(D=D||10,2>D||36<D)throw Error("radix out of range: "+D);if(g(this))return"0";if(p(this))return"-"+y(this).toString(D);for(var b=h(Math.pow(D,6)),_=this,I="";;){var S=x(_,b).g;_=v(_,S.j(b));var F=((0<_.g.length?_.g[0]:_.h)>>>0).toString(D);if(_=S,g(_))return F+I;for(;6>F.length;)F="0"+F;I=F+I}},n.i=function(D){return 0>D?0:D<this.g.length?this.g[D]:this.h};function g(D){if(D.h!=0)return!1;for(var b=0;b<D.g.length;b++)if(D.g[b]!=0)return!1;return!0}function p(D){return D.h==-1}n.l=function(D){return D=v(this,D),p(D)?-1:g(D)?0:1};function y(D){for(var b=D.g.length,_=[],I=0;I<b;I++)_[I]=~D.g[I];return new o(_,~D.h).add(f)}n.abs=function(){return p(this)?y(this):this},n.add=function(D){for(var b=Math.max(this.g.length,D.g.length),_=[],I=0,S=0;S<=b;S++){var F=I+(this.i(S)&65535)+(D.i(S)&65535),B=(F>>>16)+(this.i(S)>>>16)+(D.i(S)>>>16);I=B>>>16,F&=65535,B&=65535,_[S]=B<<16|F}return new o(_,_[_.length-1]&-2147483648?-1:0)};function v(D,b){return D.add(y(b))}n.j=function(D){if(g(this)||g(D))return d;if(p(this))return p(D)?y(this).j(y(D)):y(y(this).j(D));if(p(D))return y(this.j(y(D)));if(0>this.l(A)&&0>D.l(A))return h(this.m()*D.m());for(var b=this.g.length+D.g.length,_=[],I=0;I<2*b;I++)_[I]=0;for(I=0;I<this.g.length;I++)for(var S=0;S<D.g.length;S++){var F=this.i(I)>>>16,B=this.i(I)&65535,E=D.i(S)>>>16,V=D.i(S)&65535;_[2*I+2*S]+=B*V,m(_,2*I+2*S),_[2*I+2*S+1]+=F*V,m(_,2*I+2*S+1),_[2*I+2*S+1]+=B*E,m(_,2*I+2*S+1),_[2*I+2*S+2]+=F*E,m(_,2*I+2*S+2)}for(I=0;I<b;I++)_[I]=_[2*I+1]<<16|_[2*I];for(I=b;I<2*b;I++)_[I]=0;return new o(_,0)};function m(D,b){for(;(D[b]&65535)!=D[b];)D[b+1]+=D[b]>>>16,D[b]&=65535,b++}function w(D,b){this.g=D,this.h=b}function x(D,b){if(g(b))throw Error("division by zero");if(g(D))return new w(d,d);if(p(D))return b=x(y(D),b),new w(y(b.g),y(b.h));if(p(b))return b=x(D,y(b)),new w(y(b.g),b.h);if(30<D.g.length){if(p(D)||p(b))throw Error("slowDivide_ only works with positive integers.");for(var _=f,I=b;0>=I.l(D);)_=T(_),I=T(I);var S=j(_,1),F=j(I,1);for(I=j(I,2),_=j(_,2);!g(I);){var B=F.add(I);0>=B.l(D)&&(S=S.add(_),F=B),I=j(I,1),_=j(_,1)}return b=v(D,S.j(b)),new w(S,b)}for(S=d;0<=D.l(b);){for(_=Math.max(1,Math.floor(D.m()/b.m())),I=Math.ceil(Math.log(_)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),F=h(_),B=F.j(b);p(B)||0<B.l(D);)_-=I,F=h(_),B=F.j(b);g(F)&&(F=f),S=S.add(F),D=v(D,B)}return new w(S,D)}n.A=function(D){return x(this,D).h},n.and=function(D){for(var b=Math.max(this.g.length,D.g.length),_=[],I=0;I<b;I++)_[I]=this.i(I)&D.i(I);return new o(_,this.h&D.h)},n.or=function(D){for(var b=Math.max(this.g.length,D.g.length),_=[],I=0;I<b;I++)_[I]=this.i(I)|D.i(I);return new o(_,this.h|D.h)},n.xor=function(D){for(var b=Math.max(this.g.length,D.g.length),_=[],I=0;I<b;I++)_[I]=this.i(I)^D.i(I);return new o(_,this.h^D.h)};function T(D){for(var b=D.g.length+1,_=[],I=0;I<b;I++)_[I]=D.i(I)<<1|D.i(I-1)>>>31;return new o(_,D.h)}function j(D,b){var _=b>>5;b%=32;for(var I=D.g.length-_,S=[],F=0;F<I;F++)S[F]=0<b?D.i(F+_)>>>b|D.i(F+_+1)<<32-b:D.i(F+_);return new o(S,D.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,oH=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=u,kf=o}).apply(typeof sD<"u"?sD:typeof self<"u"?self:typeof window<"u"?window:{});var $w=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var aH,W2,lH,Ob,bB,cH,hH,uH;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(L,ae,ge){return L==Array.prototype||L==Object.prototype||(L[ae]=ge.value),L};function t(L){L=[typeof globalThis=="object"&&globalThis,L,typeof window=="object"&&window,typeof self=="object"&&self,typeof $w=="object"&&$w];for(var ae=0;ae<L.length;++ae){var ge=L[ae];if(ge&&ge.Math==Math)return ge}throw Error("Cannot find global object")}var i=t(this);function r(L,ae){if(ae)e:{var ge=i;L=L.split(".");for(var Ne=0;Ne<L.length-1;Ne++){var Ft=L[Ne];if(!(Ft in ge))break e;ge=ge[Ft]}L=L[L.length-1],Ne=ge[L],ae=ae(Ne),ae!=Ne&&ae!=null&&e(ge,L,{configurable:!0,writable:!0,value:ae})}}function s(L,ae){L instanceof String&&(L+="");var ge=0,Ne=!1,Ft={next:function(){if(!Ne&&ge<L.length){var Kt=ge++;return{value:ae(Kt,L[Kt]),done:!1}}return Ne=!0,{done:!0,value:void 0}}};return Ft[Symbol.iterator]=function(){return Ft},Ft}r("Array.prototype.values",function(L){return L||function(){return s(this,function(ae,ge){return ge})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function c(L){var ae=typeof L;return ae=ae!="object"?ae:L?Array.isArray(L)?"array":ae:"null",ae=="array"||ae=="object"&&typeof L.length=="number"}function h(L){var ae=typeof L;return ae=="object"&&L!=null||ae=="function"}function u(L,ae,ge){return L.call.apply(L.bind,arguments)}function d(L,ae,ge){if(!L)throw Error();if(2<arguments.length){var Ne=Array.prototype.slice.call(arguments,2);return function(){var Ft=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Ft,Ne),L.apply(ae,Ft)}}return function(){return L.apply(ae,arguments)}}function f(L,ae,ge){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:d,f.apply(null,arguments)}function A(L,ae){var ge=Array.prototype.slice.call(arguments,1);return function(){var Ne=ge.slice();return Ne.push.apply(Ne,arguments),L.apply(this,Ne)}}function g(L,ae){function ge(){}ge.prototype=ae.prototype,L.aa=ae.prototype,L.prototype=new ge,L.prototype.constructor=L,L.Qb=function(Ne,Ft,Kt){for(var Pn=Array(arguments.length-2),Lr=2;Lr<arguments.length;Lr++)Pn[Lr-2]=arguments[Lr];return ae.prototype[Ft].apply(Ne,Pn)}}function p(L){const ae=L.length;if(0<ae){const ge=Array(ae);for(let Ne=0;Ne<ae;Ne++)ge[Ne]=L[Ne];return ge}return[]}function y(L,ae){for(let ge=1;ge<arguments.length;ge++){const Ne=arguments[ge];if(c(Ne)){const Ft=L.length||0,Kt=Ne.length||0;L.length=Ft+Kt;for(let Pn=0;Pn<Kt;Pn++)L[Ft+Pn]=Ne[Pn]}else L.push(Ne)}}class v{constructor(ae,ge){this.i=ae,this.j=ge,this.h=0,this.g=null}get(){let ae;return 0<this.h?(this.h--,ae=this.g,this.g=ae.next,ae.next=null):ae=this.i(),ae}}function m(L){return/^[\s\xa0]*$/.test(L)}function w(){var L=a.navigator;return L&&(L=L.userAgent)?L:""}function x(L){return x[" "](L),L}x[" "]=function(){};var T=w().indexOf("Gecko")!=-1&&!(w().toLowerCase().indexOf("webkit")!=-1&&w().indexOf("Edge")==-1)&&!(w().indexOf("Trident")!=-1||w().indexOf("MSIE")!=-1)&&w().indexOf("Edge")==-1;function j(L,ae,ge){for(const Ne in L)ae.call(ge,L[Ne],Ne,L)}function D(L,ae){for(const ge in L)ae.call(void 0,L[ge],ge,L)}function b(L){const ae={};for(const ge in L)ae[ge]=L[ge];return ae}const _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(L,ae){let ge,Ne;for(let Ft=1;Ft<arguments.length;Ft++){Ne=arguments[Ft];for(ge in Ne)L[ge]=Ne[ge];for(let Kt=0;Kt<_.length;Kt++)ge=_[Kt],Object.prototype.hasOwnProperty.call(Ne,ge)&&(L[ge]=Ne[ge])}}function S(L){var ae=1;L=L.split(":");const ge=[];for(;0<ae&&L.length;)ge.push(L.shift()),ae--;return L.length&&ge.push(L.join(":")),ge}function F(L){a.setTimeout(()=>{throw L},0)}function B(){var L=X;let ae=null;return L.g&&(ae=L.g,L.g=L.g.next,L.g||(L.h=null),ae.next=null),ae}class E{constructor(){this.h=this.g=null}add(ae,ge){const Ne=V.get();Ne.set(ae,ge),this.h?this.h.next=Ne:this.g=Ne,this.h=Ne}}var V=new v(()=>new K,L=>L.reset());class K{constructor(){this.next=this.g=this.h=null}set(ae,ge){this.h=ae,this.g=ge,this.next=null}reset(){this.next=this.g=this.h=null}}let P,M=!1,X=new E,Z=()=>{const L=a.Promise.resolve(void 0);P=()=>{L.then(Q)}};var Q=()=>{for(var L;L=B();){try{L.h.call(L.g)}catch(ge){F(ge)}var ae=V;ae.j(L),100>ae.h&&(ae.h++,L.next=ae.g,ae.g=L)}M=!1};function U(){this.s=this.s,this.C=this.C}U.prototype.s=!1,U.prototype.ma=function(){this.s||(this.s=!0,this.N())},U.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function z(L,ae){this.type=L,this.g=this.target=ae,this.defaultPrevented=!1}z.prototype.h=function(){this.defaultPrevented=!0};var q=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var L=!1,ae=Object.defineProperty({},"passive",{get:function(){L=!0}});try{const ge=()=>{};a.addEventListener("test",ge,ae),a.removeEventListener("test",ge,ae)}catch{}return L})();function G(L,ae){if(z.call(this,L?L.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,L){var ge=this.type=L.type,Ne=L.changedTouches&&L.changedTouches.length?L.changedTouches[0]:null;if(this.target=L.target||L.srcElement,this.g=ae,ae=L.relatedTarget){if(T){e:{try{x(ae.nodeName);var Ft=!0;break e}catch{}Ft=!1}Ft||(ae=null)}}else ge=="mouseover"?ae=L.fromElement:ge=="mouseout"&&(ae=L.toElement);this.relatedTarget=ae,Ne?(this.clientX=Ne.clientX!==void 0?Ne.clientX:Ne.pageX,this.clientY=Ne.clientY!==void 0?Ne.clientY:Ne.pageY,this.screenX=Ne.screenX||0,this.screenY=Ne.screenY||0):(this.clientX=L.clientX!==void 0?L.clientX:L.pageX,this.clientY=L.clientY!==void 0?L.clientY:L.pageY,this.screenX=L.screenX||0,this.screenY=L.screenY||0),this.button=L.button,this.key=L.key||"",this.ctrlKey=L.ctrlKey,this.altKey=L.altKey,this.shiftKey=L.shiftKey,this.metaKey=L.metaKey,this.pointerId=L.pointerId||0,this.pointerType=typeof L.pointerType=="string"?L.pointerType:ie[L.pointerType]||"",this.state=L.state,this.i=L,L.defaultPrevented&&G.aa.h.call(this)}}g(G,z);var ie={2:"touch",3:"pen",4:"mouse"};G.prototype.h=function(){G.aa.h.call(this);var L=this.i;L.preventDefault?L.preventDefault():L.returnValue=!1};var H="closure_listenable_"+(1e6*Math.random()|0),se=0;function te(L,ae,ge,Ne,Ft){this.listener=L,this.proxy=null,this.src=ae,this.type=ge,this.capture=!!Ne,this.ha=Ft,this.key=++se,this.da=this.fa=!1}function fe(L){L.da=!0,L.listener=null,L.proxy=null,L.src=null,L.ha=null}function ye(L){this.src=L,this.g={},this.h=0}ye.prototype.add=function(L,ae,ge,Ne,Ft){var Kt=L.toString();L=this.g[Kt],L||(L=this.g[Kt]=[],this.h++);var Pn=_e(L,ae,Ne,Ft);return-1<Pn?(ae=L[Pn],ge||(ae.fa=!1)):(ae=new te(ae,this.src,Kt,!!Ne,Ft),ae.fa=ge,L.push(ae)),ae};function be(L,ae){var ge=ae.type;if(ge in L.g){var Ne=L.g[ge],Ft=Array.prototype.indexOf.call(Ne,ae,void 0),Kt;(Kt=0<=Ft)&&Array.prototype.splice.call(Ne,Ft,1),Kt&&(fe(ae),L.g[ge].length==0&&(delete L.g[ge],L.h--))}}function _e(L,ae,ge,Ne){for(var Ft=0;Ft<L.length;++Ft){var Kt=L[Ft];if(!Kt.da&&Kt.listener==ae&&Kt.capture==!!ge&&Kt.ha==Ne)return Ft}return-1}var W="closure_lm_"+(1e6*Math.random()|0),Y={};function ve(L,ae,ge,Ne,Ft){if(Array.isArray(ae)){for(var Kt=0;Kt<ae.length;Kt++)ve(L,ae[Kt],ge,Ne,Ft);return null}return ge=$e(ge),L&&L[H]?L.K(ae,ge,h(Ne)?!!Ne.capture:!1,Ft):ce(L,ae,ge,!1,Ne,Ft)}function ce(L,ae,ge,Ne,Ft,Kt){if(!ae)throw Error("Invalid event type");var Pn=h(Ft)?!!Ft.capture:!!Ft,Lr=Be(L);if(Lr||(L[W]=Lr=new ye(L)),ge=Lr.add(ae,ge,Ne,Pn,Kt),ge.proxy)return ge;if(Ne=ne(),ge.proxy=Ne,Ne.src=L,Ne.listener=ge,L.addEventListener)q||(Ft=Pn),Ft===void 0&&(Ft=!1),L.addEventListener(ae.toString(),Ne,Ft);else if(L.attachEvent)L.attachEvent(Te(ae.toString()),Ne);else if(L.addListener&&L.removeListener)L.addListener(Ne);else throw Error("addEventListener and attachEvent are unavailable.");return ge}function ne(){function L(ge){return ae.call(L.src,L.listener,ge)}const ae=Ce;return L}function he(L,ae,ge,Ne,Ft){if(Array.isArray(ae))for(var Kt=0;Kt<ae.length;Kt++)he(L,ae[Kt],ge,Ne,Ft);else Ne=h(Ne)?!!Ne.capture:!!Ne,ge=$e(ge),L&&L[H]?(L=L.i,ae=String(ae).toString(),ae in L.g&&(Kt=L.g[ae],ge=_e(Kt,ge,Ne,Ft),-1<ge&&(fe(Kt[ge]),Array.prototype.splice.call(Kt,ge,1),Kt.length==0&&(delete L.g[ae],L.h--)))):L&&(L=Be(L))&&(ae=L.g[ae.toString()],L=-1,ae&&(L=_e(ae,ge,Ne,Ft)),(ge=-1<L?ae[L]:null)&&xe(ge))}function xe(L){if(typeof L!="number"&&L&&!L.da){var ae=L.src;if(ae&&ae[H])be(ae.i,L);else{var ge=L.type,Ne=L.proxy;ae.removeEventListener?ae.removeEventListener(ge,Ne,L.capture):ae.detachEvent?ae.detachEvent(Te(ge),Ne):ae.addListener&&ae.removeListener&&ae.removeListener(Ne),(ge=Be(ae))?(be(ge,L),ge.h==0&&(ge.src=null,ae[W]=null)):fe(L)}}}function Te(L){return L in Y?Y[L]:Y[L]="on"+L}function Ce(L,ae){if(L.da)L=!0;else{ae=new G(ae,this);var ge=L.listener,Ne=L.ha||L.src;L.fa&&xe(L),L=ge.call(Ne,ae)}return L}function Be(L){return L=L[W],L instanceof ye?L:null}var Ye="__closure_events_fn_"+(1e9*Math.random()>>>0);function $e(L){return typeof L=="function"?L:(L[Ye]||(L[Ye]=function(ae){return L.handleEvent(ae)}),L[Ye])}function ot(){U.call(this),this.i=new ye(this),this.M=this,this.F=null}g(ot,U),ot.prototype[H]=!0,ot.prototype.removeEventListener=function(L,ae,ge,Ne){he(this,L,ae,ge,Ne)};function rt(L,ae){var ge,Ne=L.F;if(Ne)for(ge=[];Ne;Ne=Ne.F)ge.push(Ne);if(L=L.M,Ne=ae.type||ae,typeof ae=="string")ae=new z(ae,L);else if(ae instanceof z)ae.target=ae.target||L;else{var Ft=ae;ae=new z(Ne,L),I(ae,Ft)}if(Ft=!0,ge)for(var Kt=ge.length-1;0<=Kt;Kt--){var Pn=ae.g=ge[Kt];Ft=Ve(Pn,Ne,!0,ae)&&Ft}if(Pn=ae.g=L,Ft=Ve(Pn,Ne,!0,ae)&&Ft,Ft=Ve(Pn,Ne,!1,ae)&&Ft,ge)for(Kt=0;Kt<ge.length;Kt++)Pn=ae.g=ge[Kt],Ft=Ve(Pn,Ne,!1,ae)&&Ft}ot.prototype.N=function(){if(ot.aa.N.call(this),this.i){var L=this.i,ae;for(ae in L.g){for(var ge=L.g[ae],Ne=0;Ne<ge.length;Ne++)fe(ge[Ne]);delete L.g[ae],L.h--}}this.F=null},ot.prototype.K=function(L,ae,ge,Ne){return this.i.add(String(L),ae,!1,ge,Ne)},ot.prototype.L=function(L,ae,ge,Ne){return this.i.add(String(L),ae,!0,ge,Ne)};function Ve(L,ae,ge,Ne){if(ae=L.i.g[String(ae)],!ae)return!0;ae=ae.concat();for(var Ft=!0,Kt=0;Kt<ae.length;++Kt){var Pn=ae[Kt];if(Pn&&!Pn.da&&Pn.capture==ge){var Lr=Pn.listener,Ls=Pn.ha||Pn.src;Pn.fa&&be(L.i,Pn),Ft=Lr.call(Ls,Ne)!==!1&&Ft}}return Ft&&!Ne.defaultPrevented}function We(L,ae,ge){if(typeof L=="function")ge&&(L=f(L,ge));else if(L&&typeof L.handleEvent=="function")L=f(L.handleEvent,L);else throw Error("Invalid listener argument");return 2147483647<Number(ae)?-1:a.setTimeout(L,ae||0)}function De(L){L.g=We(()=>{L.g=null,L.i&&(L.i=!1,De(L))},L.l);const ae=L.h;L.h=null,L.m.apply(null,ae)}class Ge extends U{constructor(ae,ge){super(),this.m=ae,this.l=ge,this.h=null,this.i=!1,this.g=null}j(ae){this.h=arguments,this.g?this.i=!0:De(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Re(L){U.call(this),this.h=L,this.g={}}g(Re,U);var Ie=[];function Le(L){j(L.g,function(ae,ge){this.g.hasOwnProperty(ge)&&xe(ae)},L),L.g={}}Re.prototype.N=function(){Re.aa.N.call(this),Le(this)},Re.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var et=a.JSON.stringify,ct=a.JSON.parse,mt=class{stringify(L){return a.JSON.stringify(L,void 0)}parse(L){return a.JSON.parse(L,void 0)}};function je(){}je.prototype.h=null;function le(L){return L.h||(L.h=L.i())}function Je(){}var ht={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ut(){z.call(this,"d")}g(ut,z);function ft(){z.call(this,"c")}g(ft,z);var jt={},Wt=null;function Mt(){return Wt=Wt||new ot}jt.La="serverreachability";function dn(L){z.call(this,jt.La,L)}g(dn,z);function on(L){const ae=Mt();rt(ae,new dn(ae))}jt.STAT_EVENT="statevent";function Et(L,ae){z.call(this,jt.STAT_EVENT,L),this.stat=ae}g(Et,z);function an(L){const ae=Mt();rt(ae,new Et(ae,L))}jt.Ma="timingevent";function Mn(L,ae){z.call(this,jt.Ma,L),this.size=ae}g(Mn,z);function At(L,ae){if(typeof L!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){L()},ae)}function zt(){this.g=!0}zt.prototype.xa=function(){this.g=!1};function Zt(L,ae,ge,Ne,Ft,Kt){L.info(function(){if(L.g)if(Kt)for(var Pn="",Lr=Kt.split("&"),Ls=0;Ls<Lr.length;Ls++){var Fr=Lr[Ls].split("=");if(1<Fr.length){var Mr=Fr[0];Fr=Fr[1];var cs=Mr.split("_");Pn=2<=cs.length&&cs[1]=="type"?Pn+(Mr+"="+Fr+"&"):Pn+(Mr+"=redacted&")}}else Pn=null;else Pn=Kt;return"XMLHTTP REQ ("+Ne+") [attempt "+Ft+"]: "+ae+`
`+ge+`
`+Pn})}function $t(L,ae,ge,Ne,Ft,Kt,Pn){L.info(function(){return"XMLHTTP RESP ("+Ne+") [ attempt "+Ft+"]: "+ae+`
`+ge+`
`+Kt+" "+Pn})}function Ht(L,ae,ge,Ne){L.info(function(){return"XMLHTTP TEXT ("+ae+"): "+dt(L,ge)+(Ne?" "+Ne:"")})}function Lt(L,ae){L.info(function(){return"TIMEOUT: "+ae})}zt.prototype.info=function(){};function dt(L,ae){if(!L.g)return ae;if(!ae)return null;try{var ge=JSON.parse(ae);if(ge){for(L=0;L<ge.length;L++)if(Array.isArray(ge[L])){var Ne=ge[L];if(!(2>Ne.length)){var Ft=Ne[1];if(Array.isArray(Ft)&&!(1>Ft.length)){var Kt=Ft[0];if(Kt!="noop"&&Kt!="stop"&&Kt!="close")for(var Pn=1;Pn<Ft.length;Pn++)Ft[Pn]=""}}}}return et(ge)}catch{return ae}}var at={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ot={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Cn;function Rn(){}g(Rn,je),Rn.prototype.g=function(){return new XMLHttpRequest},Rn.prototype.i=function(){return{}},Cn=new Rn;function xn(L,ae,ge,Ne){this.j=L,this.i=ae,this.l=ge,this.R=Ne||1,this.U=new Re(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new En}function En(){this.i=null,this.g="",this.h=!1}var Hn={},Kn={};function Ti(L,ae,ge){L.L=1,L.v=Yn(Xn(ae)),L.m=ge,L.P=!0,ti(L,null)}function ti(L,ae){L.F=Date.now(),fi(L),L.A=Xn(L.v);var ge=L.A,Ne=L.R;Array.isArray(Ne)||(Ne=[String(Ne)]),Oe(ge.i,"t",Ne),L.C=0,ge=L.j.J,L.h=new En,L.g=bc(L.j,ge?ae:null,!L.m),0<L.O&&(L.M=new Ge(f(L.Y,L,L.g),L.O)),ae=L.U,ge=L.g,Ne=L.ca;var Ft="readystatechange";Array.isArray(Ft)||(Ft&&(Ie[0]=Ft.toString()),Ft=Ie);for(var Kt=0;Kt<Ft.length;Kt++){var Pn=ve(ge,Ft[Kt],Ne||ae.handleEvent,!1,ae.h||ae);if(!Pn)break;ae.g[Pn.key]=Pn}ae=L.H?b(L.H):{},L.m?(L.u||(L.u="POST"),ae["Content-Type"]="application/x-www-form-urlencoded",L.g.ea(L.A,L.u,L.m,ae)):(L.u="GET",L.g.ea(L.A,L.u,null,ae)),on(),Zt(L.i,L.u,L.A,L.l,L.R,L.m)}xn.prototype.ca=function(L){L=L.target;const ae=this.M;ae&&ar(L)==3?ae.j():this.Y(L)},xn.prototype.Y=function(L){try{if(L==this.g)e:{const cs=ar(this.g);var ae=this.g.Ba();const Nl=this.g.Z();if(!(3>cs)&&(cs!=3||this.g&&(this.h.h||this.g.oa()||un(this.g)))){this.J||cs!=4||ae==7||(ae==8||0>=Nl?on(3):on(2)),rn(this);var ge=this.g.Z();this.X=ge;t:if(ai(this)){var Ne=un(this.g);L="";var Ft=Ne.length,Kt=ar(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Fn(this),$n(this);var Pn="";break t}this.h.i=new a.TextDecoder}for(ae=0;ae<Ft;ae++)this.h.h=!0,L+=this.h.i.decode(Ne[ae],{stream:!(Kt&&ae==Ft-1)});Ne.length=0,this.h.g+=L,this.C=0,Pn=this.h.g}else Pn=this.g.oa();if(this.o=ge==200,$t(this.i,this.u,this.A,this.l,this.R,cs,ge),this.o){if(this.T&&!this.K){t:{if(this.g){var Lr,Ls=this.g;if((Lr=Ls.g?Ls.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!m(Lr)){var Fr=Lr;break t}}Fr=null}if(ge=Fr)Ht(this.i,this.l,ge,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,pt(this,ge);else{this.o=!1,this.s=3,an(12),Fn(this),$n(this);break e}}if(this.P){ge=!0;let bo;for(;!this.J&&this.C<Pn.length;)if(bo=Gi(this,Pn),bo==Kn){cs==4&&(this.s=4,an(14),ge=!1),Ht(this.i,this.l,null,"[Incomplete Response]");break}else if(bo==Hn){this.s=4,an(15),Ht(this.i,this.l,Pn,"[Invalid Chunk]"),ge=!1;break}else Ht(this.i,this.l,bo,null),pt(this,bo);if(ai(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),cs!=4||Pn.length!=0||this.h.h||(this.s=1,an(16),ge=!1),this.o=this.o&&ge,!ge)Ht(this.i,this.l,Pn,"[Invalid Chunked Response]"),Fn(this),$n(this);else if(0<Pn.length&&!this.W){this.W=!0;var Mr=this.j;Mr.g==this&&Mr.ba&&!Mr.M&&(Mr.j.info("Great, no buffering proxy detected. Bytes received: "+Pn.length),Ir(Mr),Mr.M=!0,an(11))}}else Ht(this.i,this.l,Pn,null),pt(this,Pn);cs==4&&Fn(this),this.o&&!this.J&&(cs==4?is(this.j,this):(this.o=!1,fi(this)))}else Vn(this.g),ge==400&&0<Pn.indexOf("Unknown SID")?(this.s=3,an(12)):(this.s=0,an(13)),Fn(this),$n(this)}}}catch{}finally{}};function ai(L){return L.g?L.u=="GET"&&L.L!=2&&L.j.Ca:!1}function Gi(L,ae){var ge=L.C,Ne=ae.indexOf(`
`,ge);return Ne==-1?Kn:(ge=Number(ae.substring(ge,Ne)),isNaN(ge)?Hn:(Ne+=1,Ne+ge>ae.length?Kn:(ae=ae.slice(Ne,Ne+ge),L.C=Ne+ge,ae)))}xn.prototype.cancel=function(){this.J=!0,Fn(this)};function fi(L){L.S=Date.now()+L.I,Oi(L,L.I)}function Oi(L,ae){if(L.B!=null)throw Error("WatchDog timer not null");L.B=At(f(L.ba,L),ae)}function rn(L){L.B&&(a.clearTimeout(L.B),L.B=null)}xn.prototype.ba=function(){this.B=null;const L=Date.now();0<=L-this.S?(Lt(this.i,this.A),this.L!=2&&(on(),an(17)),Fn(this),this.s=2,$n(this)):Oi(this,this.S-L)};function $n(L){L.j.G==0||L.J||is(L.j,L)}function Fn(L){rn(L);var ae=L.M;ae&&typeof ae.ma=="function"&&ae.ma(),L.M=null,Le(L.U),L.g&&(ae=L.g,L.g=null,ae.abort(),ae.ma())}function pt(L,ae){try{var ge=L.j;if(ge.G!=0&&(ge.g==L||bn(ge.h,L))){if(!L.K&&bn(ge.h,L)&&ge.G==3){try{var Ne=ge.Da.g.parse(ae)}catch{Ne=null}if(Array.isArray(Ne)&&Ne.length==3){var Ft=Ne;if(Ft[0]==0){e:if(!ge.u){if(ge.g)if(ge.g.F+3e3<L.F)Ns(ge),He(ge);else break e;pi(ge),an(18)}}else ge.za=Ft[1],0<ge.za-ge.T&&37500>Ft[2]&&ge.F&&ge.v==0&&!ge.C&&(ge.C=At(f(ge.Za,ge),6e3));if(1>=sn(ge.h)&&ge.ca){try{ge.ca()}catch{}ge.ca=void 0}}else fs(ge,11)}else if((L.K||ge.g==L)&&Ns(ge),!m(ae))for(Ft=ge.Da.g.parse(ae),ae=0;ae<Ft.length;ae++){let Fr=Ft[ae];if(ge.T=Fr[0],Fr=Fr[1],ge.G==2)if(Fr[0]=="c"){ge.K=Fr[1],ge.ia=Fr[2];const Mr=Fr[3];Mr!=null&&(ge.la=Mr,ge.j.info("VER="+ge.la));const cs=Fr[4];cs!=null&&(ge.Aa=cs,ge.j.info("SVER="+ge.Aa));const Nl=Fr[5];Nl!=null&&typeof Nl=="number"&&0<Nl&&(Ne=1.5*Nl,ge.L=Ne,ge.j.info("backChannelRequestTimeoutMs_="+Ne)),Ne=ge;const bo=L.g;if(bo){const eo=bo.g?bo.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(eo){var Kt=Ne.h;Kt.g||eo.indexOf("spdy")==-1&&eo.indexOf("quic")==-1&&eo.indexOf("h2")==-1||(Kt.j=Kt.l,Kt.g=new Set,Kt.h&&(Li(Kt,Kt.h),Kt.h=null))}if(Ne.D){const Qa=bo.g?bo.g.getResponseHeader("X-HTTP-Session-Id"):null;Qa&&(Ne.ya=Qa,wn(Ne.I,Ne.D,Qa))}}ge.G=3,ge.l&&ge.l.ua(),ge.ba&&(ge.R=Date.now()-L.F,ge.j.info("Handshake RTT: "+ge.R+"ms")),Ne=ge;var Pn=L;if(Ne.qa=Al(Ne,Ne.J?Ne.ia:null,Ne.W),Pn.K){Wn(Ne.h,Pn);var Lr=Pn,Ls=Ne.L;Ls&&(Lr.I=Ls),Lr.B&&(rn(Lr),fi(Lr)),Ne.g=Pn}else Fi(Ne);0<ge.i.length&&_t(ge)}else Fr[0]!="stop"&&Fr[0]!="close"||fs(ge,7);else ge.G==3&&(Fr[0]=="stop"||Fr[0]=="close"?Fr[0]=="stop"?fs(ge,7):we(ge):Fr[0]!="noop"&&ge.l&&ge.l.ta(Fr),ge.v=0)}}on(4)}catch{}}var vt=class{constructor(L,ae){this.g=L,this.map=ae}};function kt(L){this.l=L||10,a.PerformanceNavigationTiming?(L=a.performance.getEntriesByType("navigation"),L=0<L.length&&(L[0].nextHopProtocol=="hq"||L[0].nextHopProtocol=="h2")):L=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=L?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function mn(L){return L.h?!0:L.g?L.g.size>=L.j:!1}function sn(L){return L.h?1:L.g?L.g.size:0}function bn(L,ae){return L.h?L.h==ae:L.g?L.g.has(ae):!1}function Li(L,ae){L.g?L.g.add(ae):L.h=ae}function Wn(L,ae){L.h&&L.h==ae?L.h=null:L.g&&L.g.has(ae)&&L.g.delete(ae)}kt.prototype.cancel=function(){if(this.i=ui(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const L of this.g.values())L.cancel();this.g.clear()}};function ui(L){if(L.h!=null)return L.i.concat(L.h.D);if(L.g!=null&&L.g.size!==0){let ae=L.i;for(const ge of L.g.values())ae=ae.concat(ge.D);return ae}return p(L.i)}function Mi(L){if(L.V&&typeof L.V=="function")return L.V();if(typeof Map<"u"&&L instanceof Map||typeof Set<"u"&&L instanceof Set)return Array.from(L.values());if(typeof L=="string")return L.split("");if(c(L)){for(var ae=[],ge=L.length,Ne=0;Ne<ge;Ne++)ae.push(L[Ne]);return ae}ae=[],ge=0;for(Ne in L)ae[ge++]=L[Ne];return ae}function Gn(L){if(L.na&&typeof L.na=="function")return L.na();if(!L.V||typeof L.V!="function"){if(typeof Map<"u"&&L instanceof Map)return Array.from(L.keys());if(!(typeof Set<"u"&&L instanceof Set)){if(c(L)||typeof L=="string"){var ae=[];L=L.length;for(var ge=0;ge<L;ge++)ae.push(ge);return ae}ae=[],ge=0;for(const Ne in L)ae[ge++]=Ne;return ae}}}function Dn(L,ae){if(L.forEach&&typeof L.forEach=="function")L.forEach(ae,void 0);else if(c(L)||typeof L=="string")Array.prototype.forEach.call(L,ae,void 0);else for(var ge=Gn(L),Ne=Mi(L),Ft=Ne.length,Kt=0;Kt<Ft;Kt++)ae.call(void 0,Ne[Kt],ge&&ge[Kt],L)}var li=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function en(L,ae){if(L){L=L.split("&");for(var ge=0;ge<L.length;ge++){var Ne=L[ge].indexOf("="),Ft=null;if(0<=Ne){var Kt=L[ge].substring(0,Ne);Ft=L[ge].substring(Ne+1)}else Kt=L[ge];ae(Kt,Ft?decodeURIComponent(Ft.replace(/\+/g," ")):"")}}}function Rt(L){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,L instanceof Rt){this.h=L.h,Ui(this,L.j),this.o=L.o,this.g=L.g,tt(this,L.s),this.l=L.l;var ae=L.i,ge=new Qr;ge.i=ae.i,ae.g&&(ge.g=new Map(ae.g),ge.h=ae.h),Jt(this,ge),this.m=L.m}else L&&(ae=String(L).match(li))?(this.h=!1,Ui(this,ae[1]||"",!0),this.o=hi(ae[2]||""),this.g=hi(ae[3]||"",!0),tt(this,ae[4]),this.l=hi(ae[5]||"",!0),Jt(this,ae[6]||"",!0),this.m=hi(ae[7]||"")):(this.h=!1,this.i=new Qr(null,this.h))}Rt.prototype.toString=function(){var L=[],ae=this.j;ae&&L.push(Xt(ae,Pr,!0),":");var ge=this.g;return(ge||ae=="file")&&(L.push("//"),(ae=this.o)&&L.push(Xt(ae,Pr,!0),"@"),L.push(encodeURIComponent(String(ge)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),ge=this.s,ge!=null&&L.push(":",String(ge))),(ge=this.l)&&(this.g&&ge.charAt(0)!="/"&&L.push("/"),L.push(Xt(ge,ge.charAt(0)=="/"?Vi:ws,!0))),(ge=this.i.toString())&&L.push("?",ge),(ge=this.m)&&L.push("#",Xt(ge,_r)),L.join("")};function Xn(L){return new Rt(L)}function Ui(L,ae,ge){L.j=ge?hi(ae,!0):ae,L.j&&(L.j=L.j.replace(/:$/,""))}function tt(L,ae){if(ae){if(ae=Number(ae),isNaN(ae)||0>ae)throw Error("Bad port number "+ae);L.s=ae}else L.s=null}function Jt(L,ae,ge){ae instanceof Qr?(L.i=ae,gt(L.i,L.h)):(ge||(ae=Xt(ae,br)),L.i=new Qr(ae,L.h))}function wn(L,ae,ge){L.i.set(ae,ge)}function Yn(L){return wn(L,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),L}function hi(L,ae){return L?ae?decodeURI(L.replace(/%25/g,"%2525")):decodeURIComponent(L):""}function Xt(L,ae,ge){return typeof L=="string"?(L=encodeURI(L).replace(ae,_i),ge&&(L=L.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),L):null}function _i(L){return L=L.charCodeAt(0),"%"+(L>>4&15).toString(16)+(L&15).toString(16)}var Pr=/[#\/\?@]/g,ws=/[#\?:]/g,Vi=/[#\?]/g,br=/[#\?@]/g,_r=/#/g;function Qr(L,ae){this.h=this.g=null,this.i=L||null,this.j=!!ae}function ue(L){L.g||(L.g=new Map,L.h=0,L.i&&en(L.i,function(ae,ge){L.add(decodeURIComponent(ae.replace(/\+/g," ")),ge)}))}n=Qr.prototype,n.add=function(L,ae){ue(this),this.i=null,L=nt(this,L);var ge=this.g.get(L);return ge||this.g.set(L,ge=[]),ge.push(ae),this.h+=1,this};function ke(L,ae){ue(L),ae=nt(L,ae),L.g.has(ae)&&(L.i=null,L.h-=L.g.get(ae).length,L.g.delete(ae))}function Me(L,ae){return ue(L),ae=nt(L,ae),L.g.has(ae)}n.forEach=function(L,ae){ue(this),this.g.forEach(function(ge,Ne){ge.forEach(function(Ft){L.call(ae,Ft,Ne,this)},this)},this)},n.na=function(){ue(this);const L=Array.from(this.g.values()),ae=Array.from(this.g.keys()),ge=[];for(let Ne=0;Ne<ae.length;Ne++){const Ft=L[Ne];for(let Kt=0;Kt<Ft.length;Kt++)ge.push(ae[Ne])}return ge},n.V=function(L){ue(this);let ae=[];if(typeof L=="string")Me(this,L)&&(ae=ae.concat(this.g.get(nt(this,L))));else{L=Array.from(this.g.values());for(let ge=0;ge<L.length;ge++)ae=ae.concat(L[ge])}return ae},n.set=function(L,ae){return ue(this),this.i=null,L=nt(this,L),Me(this,L)&&(this.h-=this.g.get(L).length),this.g.set(L,[ae]),this.h+=1,this},n.get=function(L,ae){return L?(L=this.V(L),0<L.length?String(L[0]):ae):ae};function Oe(L,ae,ge){ke(L,ae),0<ge.length&&(L.i=null,L.g.set(nt(L,ae),p(ge)),L.h+=ge.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const L=[],ae=Array.from(this.g.keys());for(var ge=0;ge<ae.length;ge++){var Ne=ae[ge];const Kt=encodeURIComponent(String(Ne)),Pn=this.V(Ne);for(Ne=0;Ne<Pn.length;Ne++){var Ft=Kt;Pn[Ne]!==""&&(Ft+="="+encodeURIComponent(String(Pn[Ne]))),L.push(Ft)}}return this.i=L.join("&")};function nt(L,ae){return ae=String(ae),L.j&&(ae=ae.toLowerCase()),ae}function gt(L,ae){ae&&!L.j&&(ue(L),L.i=null,L.g.forEach(function(ge,Ne){var Ft=Ne.toLowerCase();Ne!=Ft&&(ke(this,Ne),Oe(this,Ft,ge))},L)),L.j=ae}function Ae(L,ae){const ge=new zt;if(a.Image){const Ne=new Image;Ne.onload=A(Xe,ge,"TestLoadImage: loaded",!0,ae,Ne),Ne.onerror=A(Xe,ge,"TestLoadImage: error",!1,ae,Ne),Ne.onabort=A(Xe,ge,"TestLoadImage: abort",!1,ae,Ne),Ne.ontimeout=A(Xe,ge,"TestLoadImage: timeout",!1,ae,Ne),a.setTimeout(function(){Ne.ontimeout&&Ne.ontimeout()},1e4),Ne.src=L}else ae(!1)}function me(L,ae){const ge=new zt,Ne=new AbortController,Ft=setTimeout(()=>{Ne.abort(),Xe(ge,"TestPingServer: timeout",!1,ae)},1e4);fetch(L,{signal:Ne.signal}).then(Kt=>{clearTimeout(Ft),Kt.ok?Xe(ge,"TestPingServer: ok",!0,ae):Xe(ge,"TestPingServer: server error",!1,ae)}).catch(()=>{clearTimeout(Ft),Xe(ge,"TestPingServer: error",!1,ae)})}function Xe(L,ae,ge,Ne,Ft){try{Ft&&(Ft.onload=null,Ft.onerror=null,Ft.onabort=null,Ft.ontimeout=null),Ne(ge)}catch{}}function qe(){this.g=new mt}function nn(L,ae,ge){const Ne=ge||"";try{Dn(L,function(Ft,Kt){let Pn=Ft;h(Ft)&&(Pn=et(Ft)),ae.push(Ne+Kt+"="+encodeURIComponent(Pn))})}catch(Ft){throw ae.push(Ne+"type="+encodeURIComponent("_badmap")),Ft}}function An(L){this.l=L.Ub||null,this.j=L.eb||!1}g(An,je),An.prototype.g=function(){return new Ct(this.l,this.j)},An.prototype.i=(function(L){return function(){return L}})({});function Ct(L,ae){ot.call(this),this.D=L,this.o=ae,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(Ct,ot),n=Ct.prototype,n.open=function(L,ae){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=L,this.A=ae,this.readyState=1,Qt(this)},n.send=function(L){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const ae={headers:this.u,method:this.B,credentials:this.m,cache:void 0};L&&(ae.body=L),(this.D||a).fetch(new Request(this.A,ae)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,fn(this)),this.readyState=0},n.Sa=function(L){if(this.g&&(this.l=L,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=L.headers,this.readyState=2,Qt(this)),this.g&&(this.readyState=3,Qt(this),this.g)))if(this.responseType==="arraybuffer")L.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in L){if(this.j=L.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;kn(this)}else L.text().then(this.Ra.bind(this),this.ga.bind(this))};function kn(L){L.j.read().then(L.Pa.bind(L)).catch(L.ga.bind(L))}n.Pa=function(L){if(this.g){if(this.o&&L.value)this.response.push(L.value);else if(!this.o){var ae=L.value?L.value:new Uint8Array(0);(ae=this.v.decode(ae,{stream:!L.done}))&&(this.response=this.responseText+=ae)}L.done?fn(this):Qt(this),this.readyState==3&&kn(this)}},n.Ra=function(L){this.g&&(this.response=this.responseText=L,fn(this))},n.Qa=function(L){this.g&&(this.response=L,fn(this))},n.ga=function(){this.g&&fn(this)};function fn(L){L.readyState=4,L.l=null,L.j=null,L.v=null,Qt(L)}n.setRequestHeader=function(L,ae){this.u.append(L,ae)},n.getResponseHeader=function(L){return this.h&&this.h.get(L.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const L=[],ae=this.h.entries();for(var ge=ae.next();!ge.done;)ge=ge.value,L.push(ge[0]+": "+ge[1]),ge=ae.next();return L.join(`\r
`)};function Qt(L){L.onreadystatechange&&L.onreadystatechange.call(L)}Object.defineProperty(Ct.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(L){this.m=L?"include":"same-origin"}});function Qn(L){let ae="";return j(L,function(ge,Ne){ae+=Ne,ae+=":",ae+=ge,ae+=`\r
`}),ae}function Tn(L,ae,ge){e:{for(Ne in ge){var Ne=!1;break e}Ne=!0}Ne||(ge=Qn(ge),typeof L=="string"?ge!=null&&encodeURIComponent(String(ge)):wn(L,ae,ge))}function Nn(L){ot.call(this),this.headers=new Map,this.o=L||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(Nn,ot);var pn=/^https?$/i,tr=["POST","PUT"];n=Nn.prototype,n.Ha=function(L){this.J=L},n.ea=function(L,ae,ge,Ne){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+L);ae=ae?ae.toUpperCase():"GET",this.D=L,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Cn.g(),this.v=this.o?le(this.o):le(Cn),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(ae,String(L),!0),this.B=!1}catch(Kt){Nr(this,Kt);return}if(L=ge||"",ge=new Map(this.headers),Ne)if(Object.getPrototypeOf(Ne)===Object.prototype)for(var Ft in Ne)ge.set(Ft,Ne[Ft]);else if(typeof Ne.keys=="function"&&typeof Ne.get=="function")for(const Kt of Ne.keys())ge.set(Kt,Ne.get(Kt));else throw Error("Unknown input type for opt_headers: "+String(Ne));Ne=Array.from(ge.keys()).find(Kt=>Kt.toLowerCase()=="content-type"),Ft=a.FormData&&L instanceof a.FormData,!(0<=Array.prototype.indexOf.call(tr,ae,void 0))||Ne||Ft||ge.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Kt,Pn]of ge)this.g.setRequestHeader(Kt,Pn);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{xo(this),this.u=!0,this.g.send(L),this.u=!1}catch(Kt){Nr(this,Kt)}};function Nr(L,ae){L.h=!1,L.g&&(L.j=!0,L.g.abort(),L.j=!1),L.l=ae,L.m=5,ks(L),As(L)}function ks(L){L.A||(L.A=!0,rt(L,"complete"),rt(L,"error"))}n.abort=function(L){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=L||7,rt(this,"complete"),rt(this,"abort"),As(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),As(this,!0)),Nn.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?ko(this):this.bb())},n.bb=function(){ko(this)};function ko(L){if(L.h&&typeof o<"u"&&(!L.v[1]||ar(L)!=4||L.Z()!=2)){if(L.u&&ar(L)==4)We(L.Ea,0,L);else if(rt(L,"readystatechange"),ar(L)==4){L.h=!1;try{const Pn=L.Z();e:switch(Pn){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var ae=!0;break e;default:ae=!1}var ge;if(!(ge=ae)){var Ne;if(Ne=Pn===0){var Ft=String(L.D).match(li)[1]||null;!Ft&&a.self&&a.self.location&&(Ft=a.self.location.protocol.slice(0,-1)),Ne=!pn.test(Ft?Ft.toLowerCase():"")}ge=Ne}if(ge)rt(L,"complete"),rt(L,"success");else{L.m=6;try{var Kt=2<ar(L)?L.g.statusText:""}catch{Kt=""}L.l=Kt+" ["+L.Z()+"]",ks(L)}}finally{As(L)}}}}function As(L,ae){if(L.g){xo(L);const ge=L.g,Ne=L.v[0]?()=>{}:null;L.g=null,L.v=null,ae||rt(L,"ready");try{ge.onreadystatechange=Ne}catch{}}}function xo(L){L.I&&(a.clearTimeout(L.I),L.I=null)}n.isActive=function(){return!!this.g};function ar(L){return L.g?L.g.readyState:0}n.Z=function(){try{return 2<ar(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(L){if(this.g){var ae=this.g.responseText;return L&&ae.indexOf(L)==0&&(ae=ae.substring(L.length)),ct(ae)}};function un(L){try{if(!L.g)return null;if("response"in L.g)return L.g.response;switch(L.H){case"":case"text":return L.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in L.g)return L.g.mozResponseArrayBuffer}return null}catch{return null}}function Vn(L){const ae={};L=(L.g&&2<=ar(L)&&L.g.getAllResponseHeaders()||"").split(`\r
`);for(let Ne=0;Ne<L.length;Ne++){if(m(L[Ne]))continue;var ge=S(L[Ne]);const Ft=ge[0];if(ge=ge[1],typeof ge!="string")continue;ge=ge.trim();const Kt=ae[Ft]||[];ae[Ft]=Kt,Kt.push(ge)}D(ae,function(Ne){return Ne.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ln(L,ae,ge){return ge&&ge.internalChannelParams&&ge.internalChannelParams[L]||ae}function ee(L){this.Aa=0,this.i=[],this.j=new zt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ln("failFast",!1,L),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ln("baseRetryDelayMs",5e3,L),this.cb=Ln("retryDelaySeedMs",1e4,L),this.Wa=Ln("forwardChannelMaxRetries",2,L),this.wa=Ln("forwardChannelRequestTimeoutMs",2e4,L),this.pa=L&&L.xmlHttpFactory||void 0,this.Xa=L&&L.Tb||void 0,this.Ca=L&&L.useFetchStreams||!1,this.L=void 0,this.J=L&&L.supportsCrossDomainXhr||!1,this.K="",this.h=new kt(L&&L.concurrentRequestLimit),this.Da=new qe,this.P=L&&L.fastHandshake||!1,this.O=L&&L.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=L&&L.Rb||!1,L&&L.xa&&this.j.xa(),L&&L.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&L&&L.detectBufferingProxy||!1,this.ja=void 0,L&&L.longPollingTimeout&&0<L.longPollingTimeout&&(this.ja=L.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=ee.prototype,n.la=8,n.G=1,n.connect=function(L,ae,ge,Ne){an(0),this.W=L,this.H=ae||{},ge&&Ne!==void 0&&(this.H.OSID=ge,this.H.OAID=Ne),this.F=this.X,this.I=Al(this,null,this.W),_t(this)};function we(L){if(lt(L),L.G==3){var ae=L.U++,ge=Xn(L.I);if(wn(ge,"SID",L.K),wn(ge,"RID",ae),wn(ge,"TYPE","terminate"),si(L,ge),ae=new xn(L,L.j,ae),ae.L=2,ae.v=Yn(Xn(ge)),ge=!1,a.navigator&&a.navigator.sendBeacon)try{ge=a.navigator.sendBeacon(ae.v.toString(),"")}catch{}!ge&&a.Image&&(new Image().src=ae.v,ge=!0),ge||(ae.g=bc(ae.j,null),ae.g.ea(ae.v)),ae.F=Date.now(),fi(ae)}Io(L)}function He(L){L.g&&(Ir(L),L.g.cancel(),L.g=null)}function lt(L){He(L),L.u&&(a.clearTimeout(L.u),L.u=null),Ns(L),L.h.cancel(),L.s&&(typeof L.s=="number"&&a.clearTimeout(L.s),L.s=null)}function _t(L){if(!mn(L.h)&&!L.s){L.s=!0;var ae=L.Ga;P||Z(),M||(P(),M=!0),X.add(ae,L),L.B=0}}function ln(L,ae){return sn(L.h)>=L.h.j-(L.s?1:0)?!1:L.s?(L.i=ae.D.concat(L.i),!0):L.G==1||L.G==2||L.B>=(L.Va?0:L.Wa)?!1:(L.s=At(f(L.Ga,L,ae),Js(L,L.B)),L.B++,!0)}n.Ga=function(L){if(this.s)if(this.s=null,this.G==1){if(!L){this.U=Math.floor(1e5*Math.random()),L=this.U++;const Ft=new xn(this,this.j,L);let Kt=this.o;if(this.S&&(Kt?(Kt=b(Kt),I(Kt,this.S)):Kt=this.S),this.m!==null||this.O||(Ft.H=Kt,Kt=null),this.P)e:{for(var ae=0,ge=0;ge<this.i.length;ge++){t:{var Ne=this.i[ge];if("__data__"in Ne.map&&(Ne=Ne.map.__data__,typeof Ne=="string")){Ne=Ne.length;break t}Ne=void 0}if(Ne===void 0)break;if(ae+=Ne,4096<ae){ae=ge;break e}if(ae===4096||ge===this.i.length-1){ae=ge+1;break e}}ae=1e3}else ae=1e3;ae=oi(this,Ft,ae),ge=Xn(this.I),wn(ge,"RID",L),wn(ge,"CVER",22),this.D&&wn(ge,"X-HTTP-Session-Id",this.D),si(this,ge),Kt&&(this.O?ae="headers="+encodeURIComponent(String(Qn(Kt)))+"&"+ae:this.m&&Tn(ge,this.m,Kt)),Li(this.h,Ft),this.Ua&&wn(ge,"TYPE","init"),this.P?(wn(ge,"$req",ae),wn(ge,"SID","null"),Ft.T=!0,Ti(Ft,ge,null)):Ti(Ft,ge,ae),this.G=2}}else this.G==3&&(L?vn(this,L):this.i.length==0||mn(this.h)||vn(this))};function vn(L,ae){var ge;ae?ge=ae.l:ge=L.U++;const Ne=Xn(L.I);wn(Ne,"SID",L.K),wn(Ne,"RID",ge),wn(Ne,"AID",L.T),si(L,Ne),L.m&&L.o&&Tn(Ne,L.m,L.o),ge=new xn(L,L.j,ge,L.B+1),L.m===null&&(ge.H=L.o),ae&&(L.i=ae.D.concat(L.i)),ae=oi(L,ge,1e3),ge.I=Math.round(.5*L.wa)+Math.round(.5*L.wa*Math.random()),Li(L.h,ge),Ti(ge,Ne,ae)}function si(L,ae){L.H&&j(L.H,function(ge,Ne){wn(ae,Ne,ge)}),L.l&&Dn({},function(ge,Ne){wn(ae,Ne,ge)})}function oi(L,ae,ge){ge=Math.min(L.i.length,ge);var Ne=L.l?f(L.l.Na,L.l,L):null;e:{var Ft=L.i;let Kt=-1;for(;;){const Pn=["count="+ge];Kt==-1?0<ge?(Kt=Ft[0].g,Pn.push("ofs="+Kt)):Kt=0:Pn.push("ofs="+Kt);let Lr=!0;for(let Ls=0;Ls<ge;Ls++){let Fr=Ft[Ls].g;const Mr=Ft[Ls].map;if(Fr-=Kt,0>Fr)Kt=Math.max(0,Ft[Ls].g-100),Lr=!1;else try{nn(Mr,Pn,"req"+Fr+"_")}catch{Ne&&Ne(Mr)}}if(Lr){Ne=Pn.join("&");break e}}}return L=L.i.splice(0,ge),ae.D=L,Ne}function Fi(L){if(!L.g&&!L.u){L.Y=1;var ae=L.Fa;P||Z(),M||(P(),M=!0),X.add(ae,L),L.v=0}}function pi(L){return L.g||L.u||3<=L.v?!1:(L.Y++,L.u=At(f(L.Fa,L),Js(L,L.v)),L.v++,!0)}n.Fa=function(){if(this.u=null,Hr(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var L=2*this.R;this.j.info("BP detection timer enabled: "+L),this.A=At(f(this.ab,this),L)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,an(10),He(this),Hr(this))};function Ir(L){L.A!=null&&(a.clearTimeout(L.A),L.A=null)}function Hr(L){L.g=new xn(L,L.j,"rpc",L.Y),L.m===null&&(L.g.H=L.o),L.g.O=0;var ae=Xn(L.qa);wn(ae,"RID","rpc"),wn(ae,"SID",L.K),wn(ae,"AID",L.T),wn(ae,"CI",L.F?"0":"1"),!L.F&&L.ja&&wn(ae,"TO",L.ja),wn(ae,"TYPE","xmlhttp"),si(L,ae),L.m&&L.o&&Tn(ae,L.m,L.o),L.L&&(L.g.I=L.L);var ge=L.g;L=L.ia,ge.L=1,ge.v=Yn(Xn(ae)),ge.m=null,ge.P=!0,ti(ge,L)}n.Za=function(){this.C!=null&&(this.C=null,He(this),pi(this),an(19))};function Ns(L){L.C!=null&&(a.clearTimeout(L.C),L.C=null)}function is(L,ae){var ge=null;if(L.g==ae){Ns(L),Ir(L),L.g=null;var Ne=2}else if(bn(L.h,ae))ge=ae.D,Wn(L.h,ae),Ne=1;else return;if(L.G!=0){if(ae.o)if(Ne==1){ge=ae.m?ae.m.length:0,ae=Date.now()-ae.F;var Ft=L.B;Ne=Mt(),rt(Ne,new Mn(Ne,ge)),_t(L)}else Fi(L);else if(Ft=ae.s,Ft==3||Ft==0&&0<ae.X||!(Ne==1&&ln(L,ae)||Ne==2&&pi(L)))switch(ge&&0<ge.length&&(ae=L.h,ae.i=ae.i.concat(ge)),Ft){case 1:fs(L,5);break;case 4:fs(L,10);break;case 3:fs(L,6);break;default:fs(L,2)}}}function Js(L,ae){let ge=L.Ta+Math.floor(Math.random()*L.cb);return L.isActive()||(ge*=2),ge*ae}function fs(L,ae){if(L.j.info("Error code "+ae),ae==2){var ge=f(L.fb,L),Ne=L.Xa;const Ft=!Ne;Ne=new Rt(Ne||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Ui(Ne,"https"),Yn(Ne),Ft?Ae(Ne.toString(),ge):me(Ne.toString(),ge)}else an(2);L.G=0,L.l&&L.l.sa(ae),Io(L),lt(L)}n.fb=function(L){L?(this.j.info("Successfully pinged google.com"),an(2)):(this.j.info("Failed to ping google.com"),an(1))};function Io(L){if(L.G=0,L.ka=[],L.l){const ae=ui(L.h);(ae.length!=0||L.i.length!=0)&&(y(L.ka,ae),y(L.ka,L.i),L.h.i.length=0,p(L.i),L.i.length=0),L.l.ra()}}function Al(L,ae,ge){var Ne=ge instanceof Rt?Xn(ge):new Rt(ge);if(Ne.g!="")ae&&(Ne.g=ae+"."+Ne.g),tt(Ne,Ne.s);else{var Ft=a.location;Ne=Ft.protocol,ae=ae?ae+"."+Ft.hostname:Ft.hostname,Ft=+Ft.port;var Kt=new Rt(null);Ne&&Ui(Kt,Ne),ae&&(Kt.g=ae),Ft&&tt(Kt,Ft),ge&&(Kt.l=ge),Ne=Kt}return ge=L.D,ae=L.ya,ge&&ae&&wn(Ne,ge,ae),wn(Ne,"VER",L.la),si(L,Ne),Ne}function bc(L,ae,ge){if(ae&&!L.J)throw Error("Can't create secondary domain capable XhrIo object.");return ae=L.Ca&&!L.pa?new Nn(new An({eb:ge})):new Nn(L.pa),ae.Ha(L.J),ae}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Qc(){}n=Qc.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function $c(){}$c.prototype.g=function(L,ae){return new Fo(L,ae)};function Fo(L,ae){ot.call(this),this.g=new ee(ae),this.l=L,this.h=ae&&ae.messageUrlParams||null,L=ae&&ae.messageHeaders||null,ae&&ae.clientProtocolHeaderRequired&&(L?L["X-Client-Protocol"]="webchannel":L={"X-Client-Protocol":"webchannel"}),this.g.o=L,L=ae&&ae.initMessageHeaders||null,ae&&ae.messageContentType&&(L?L["X-WebChannel-Content-Type"]=ae.messageContentType:L={"X-WebChannel-Content-Type":ae.messageContentType}),ae&&ae.va&&(L?L["X-WebChannel-Client-Profile"]=ae.va:L={"X-WebChannel-Client-Profile":ae.va}),this.g.S=L,(L=ae&&ae.Sb)&&!m(L)&&(this.g.m=L),this.v=ae&&ae.supportsCrossDomainXhr||!1,this.u=ae&&ae.sendRawJson||!1,(ae=ae&&ae.httpSessionIdParam)&&!m(ae)&&(this.g.D=ae,L=this.h,L!==null&&ae in L&&(L=this.h,ae in L&&delete L[ae])),this.j=new Ea(this)}g(Fo,ot),Fo.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Fo.prototype.close=function(){we(this.g)},Fo.prototype.o=function(L){var ae=this.g;if(typeof L=="string"){var ge={};ge.__data__=L,L=ge}else this.u&&(ge={},ge.__data__=et(L),L=ge);ae.i.push(new vt(ae.Ya++,L)),ae.G==3&&_t(ae)},Fo.prototype.N=function(){this.g.l=null,delete this.j,we(this.g),delete this.g,Fo.aa.N.call(this)};function Ba(L){ut.call(this),L.__headers__&&(this.headers=L.__headers__,this.statusCode=L.__status__,delete L.__headers__,delete L.__status__);var ae=L.__sm__;if(ae){e:{for(const ge in ae){L=ge;break e}L=void 0}(this.i=L)&&(L=this.i,ae=ae!==null&&L in ae?ae[L]:void 0),this.data=ae}else this.data=L}g(Ba,ut);function Wu(){ft.call(this),this.status=1}g(Wu,ft);function Ea(L){this.g=L}g(Ea,Qc),Ea.prototype.ua=function(){rt(this.g,"a")},Ea.prototype.ta=function(L){rt(this.g,new Ba(L))},Ea.prototype.sa=function(L){rt(this.g,new Wu)},Ea.prototype.ra=function(){rt(this.g,"b")},$c.prototype.createWebChannel=$c.prototype.g,Fo.prototype.send=Fo.prototype.o,Fo.prototype.open=Fo.prototype.m,Fo.prototype.close=Fo.prototype.close,uH=function(){return new $c},hH=function(){return Mt()},cH=jt,bB={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},at.NO_ERROR=0,at.TIMEOUT=8,at.HTTP_ERROR=6,Ob=at,Ot.COMPLETE="complete",lH=Ot,Je.EventType=ht,ht.OPEN="a",ht.CLOSE="b",ht.ERROR="c",ht.MESSAGE="d",ot.prototype.listen=ot.prototype.K,W2=Je,Nn.prototype.listenOnce=Nn.prototype.L,Nn.prototype.getLastError=Nn.prototype.Ka,Nn.prototype.getLastErrorCode=Nn.prototype.Ba,Nn.prototype.getStatus=Nn.prototype.Z,Nn.prototype.getResponseJson=Nn.prototype.Oa,Nn.prototype.getResponseText=Nn.prototype.oa,Nn.prototype.send=Nn.prototype.ea,Nn.prototype.setWithCredentials=Nn.prototype.Ha,aH=Nn}).apply(typeof $w<"u"?$w:typeof self<"u"?self:typeof window<"u"?window:{});const oD="@firebase/firestore",aD="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gl=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Gl.UNAUTHENTICATED=new Gl(null),Gl.GOOGLE_CREDENTIALS=new Gl("google-credentials-uid"),Gl.FIRST_PARTY=new Gl("first-party-uid"),Gl.MOCK_USER=new Gl("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mm="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cg=new ek("@firebase/firestore");function _0(){return cg.logLevel}function xi(n,...e){if(cg.logLevel<=qr.DEBUG){const t=e.map(fk);cg.debug(`Firestore (${Mm}): ${n}`,...t)}}function vA(n,...e){if(cg.logLevel<=qr.ERROR){const t=e.map(fk);cg.error(`Firestore (${Mm}): ${n}`,...t)}}function wA(n,...e){if(cg.logLevel<=qr.WARN){const t=e.map(fk);cg.warn(`Firestore (${Mm}): ${n}`,...t)}}function fk(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ki(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,dH(n,i,t)}function dH(n,e,t){let i=`FIRESTORE (${Mm}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw vA(i),new Error(i)}function ls(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||dH(e,r,i)}function gr(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yn={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ri extends Nu{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AH{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class fH{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Gl.UNAUTHENTICATED)))}shutdown(){}}class Dte{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class jte{constructor(e){this.t=e,this.currentUser=Gl.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ls(this.o===void 0,42304);let i=this.i;const r=c=>this.i!==i?(i=this.i,t(c)):Promise.resolve();let s=new fd;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new fd,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const c=s;e.enqueueRetryable((async()=>{await c.promise,await r(this.currentUser)}))},a=c=>{xi("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((c=>a(c))),setTimeout((()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(xi("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new fd)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(xi("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(ls(typeof i.accessToken=="string",31837,{l:i}),new AH(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ls(e===null||typeof e=="string",2055,{h:e}),new Gl(e)}}class Pte{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Gl.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Nte{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new Pte(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Gl.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class lD{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Lte{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,fc(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ls(this.o===void 0,3512);const i=s=>{s.error!=null&&xi("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,xi("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>i(s)))};const r=s=>{xi("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>r(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):xi("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new lD(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(ls(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new lD(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mte(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pH(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n5{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=Mte(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%62))}return i}}function Or(n,e){return n<e?-1:n>e?1:0}function _B(n,e){let t=0;for(;t<n.length&&t<e.length;){const i=n.codePointAt(t),r=e.codePointAt(t);if(i!==r){if(i<128&&r<128)return Or(i,r);{const s=pH(),o=Rte(s.encode(cD(n,t)),s.encode(cD(e,t)));return o!==0?o:Or(i,r)}}t+=i>65535?2:1}return Or(n.length,e.length)}function cD(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function Rte(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return Or(n[t],e[t]);return Or(n.length,e.length)}function mm(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hD="__name__";class ed{constructor(e,t,i){t===void 0?t=0:t>e.length&&Ki(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Ki(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return ed.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ed?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=ed.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return Or(e.length,t.length)}static compareSegments(e,t){const i=ed.isNumericId(e),r=ed.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?ed.extractNumericId(e).compare(ed.extractNumericId(t)):_B(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return kf.fromString(e.substring(4,e.length-2))}}class js extends ed{construct(e,t,i){return new js(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new ri(yn.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new js(t)}static emptyPath(){return new js([])}}const Ote=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ll extends ed{construct(e,t,i){return new ll(e,t,i)}static isValidIdentifier(e){return Ote.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ll.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===hD}static keyField(){return new ll([hD])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(i.length===0)throw new ri(yn.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new ri(yn.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[r+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new ri(yn.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=c,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(i+=a,r++):(s(),r++)}if(s(),o)throw new ri(yn.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ll(t)}static emptyPath(){return new ll([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i{constructor(e){this.path=e}static fromPath(e){return new $i(js.fromString(e))}static fromName(e){return new $i(js.fromString(e).popFirst(5))}static empty(){return new $i(js.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&js.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return js.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new $i(new js(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pk(n,e,t){if(!t)throw new ri(yn.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function gH(n,e,t,i){if(e===!0&&i===!0)throw new ri(yn.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function uD(n){if(!$i.isDocumentKey(n))throw new ri(yn.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function dD(n){if($i.isDocumentKey(n))throw new ri(yn.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function mH(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function i5(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ki(12329,{type:typeof n})}function fa(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ri(yn.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=i5(n);throw new ri(yn.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _a(n,e){const t={typeString:n};return e&&(t.value=e),t}function Mv(n,e){if(!mH(n))throw new ri(yn.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,s="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const o=n[i];if(r&&typeof o!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${i}' field to equal '${s.value}'`;break}}if(t)throw new ri(yn.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AD=-62135596800,fD=1e6;class Ps{static now(){return Ps.fromMillis(Date.now())}static fromDate(e){return Ps.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*fD);return new Ps(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ri(yn.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ri(yn.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<AD)throw new ri(yn.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ri(yn.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/fD}_compareTo(e){return this.seconds===e.seconds?Or(this.nanoseconds,e.nanoseconds):Or(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ps._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Mv(e,Ps._jsonSchema))return new Ps(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-AD;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ps._jsonSchemaVersion="firestore/timestamp/1.0",Ps._jsonSchema={type:_a("string",Ps._jsonSchemaVersion),seconds:_a("number"),nanoseconds:_a("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{static fromTimestamp(e){return new nr(e)}static min(){return new nr(new Ps(0,0))}static max(){return new nr(new Ps(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qy=-1;function Ute(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=nr.fromTimestamp(i===1e9?new Ps(t+1,0):new Ps(t,i));return new Lf(r,$i.empty(),e)}function Hte(n){return new Lf(n.readTime,n.key,qy)}class Lf{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Lf(nr.min(),$i.empty(),qy)}static max(){return new Lf(nr.max(),$i.empty(),qy)}}function Wte(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=$i.comparator(n.documentKey,e.documentKey),t!==0?t:Or(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qte="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class $te{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rm(n){if(n.code!==yn.FAILED_PRECONDITION||n.message!==Qte)throw n;xi("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ki(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Bn(((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Bn?t:Bn.resolve(t)}catch(t){return Bn.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Bn.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Bn.reject(t)}static resolve(e){return new Bn(((t,i)=>{t(e)}))}static reject(e){return new Bn(((t,i)=>{i(e)}))}static waitFor(e){return new Bn(((t,i)=>{let r=0,s=0,o=!1;e.forEach((a=>{++r,a.next((()=>{++s,o&&s===r&&t()}),(c=>i(c)))})),o=!0,s===r&&t()}))}static or(e){let t=Bn.resolve(!1);for(const i of e)t=t.next((r=>r?Bn.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,s)=>{i.push(t.call(this,r,s))})),this.waitFor(i)}static mapArray(e,t){return new Bn(((i,r)=>{const s=e.length,o=new Array(s);let a=0;for(let c=0;c<s;c++){const h=c;t(e[h]).next((u=>{o[h]=u,++a,a===s&&i(o)}),(u=>r(u)))}}))}static doWhile(e,t){return new Bn(((i,r)=>{const s=()=>{e()===!0?t().next((()=>{s()}),r):i()};s()}))}}function Vte(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Om(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r5{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this._e(i),this.ae=i=>t.writeSequenceNumber(i))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}r5.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gk=-1;function Rv(n){return n==null}function x_(n){return n===0&&1/n==-1/0}function zte(n){return typeof n=="number"&&Number.isInteger(n)&&!x_(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yH="";function Gte(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=pD(e)),e=Xte(n.get(t),e);return pD(e)}function Xte(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="";break;case yH:t+="";break;default:t+=s}}return t}function pD(n){return n+yH+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gD(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Zf(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function vH(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(e,t){this.comparator=e,this.root=t||Bl.EMPTY}insert(e,t){return new Lo(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Bl.BLACK,null,null))}remove(e){return new Lo(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Bl.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vw(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vw(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vw(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vw(this.root,e,this.comparator,!0)}}class Vw{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Bl{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??Bl.RED,this.left=r??Bl.EMPTY,this.right=s??Bl.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new Bl(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Bl.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return Bl.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Bl.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Bl.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ki(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ki(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ki(27949);return e+(this.isRed()?0:1)}}Bl.EMPTY=null,Bl.RED=!0,Bl.BLACK=!1;Bl.EMPTY=new class{constructor(){this.size=0}get key(){throw Ki(57766)}get value(){throw Ki(16141)}get color(){throw Ki(16727)}get left(){throw Ki(29726)}get right(){throw Ki(36894)}copy(e,t,i,r,s){return this}insert(e,t,i){return new Bl(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa{constructor(e){this.comparator=e,this.data=new Lo(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new mD(this.data.getIterator())}getIteratorFrom(e){return new mD(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Oa)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Oa(this.comparator);return t.data=e,t}}class mD{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sh{constructor(e){this.fields=e,e.sort(ll.comparator)}static empty(){return new sh([])}unionWith(e){let t=new Oa(ll.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new sh(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return mm(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wH extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new wH("Invalid base64 string: "+s):s}})(e);return new ul(t)}static fromUint8Array(e){const t=(function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s})(e);return new ul(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Or(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ul.EMPTY_BYTE_STRING=new ul("");const Kte=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Mf(n){if(ls(!!n,39018),typeof n=="string"){let e=0;const t=Kte.exec(n);if(ls(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:aa(n.seconds),nanos:aa(n.nanos)}}function aa(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Rf(n){return typeof n=="string"?ul.fromBase64String(n):ul.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xH="server_timestamp",bH="__type__",_H="__previous_value__",CH="__local_write_time__";function mk(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[bH])===null||t===void 0?void 0:t.stringValue)===xH}function s5(n){const e=n.mapValue.fields[_H];return mk(e)?s5(e):e}function Yy(n){const e=Mf(n.mapValue.fields[CH].timestampValue);return new Ps(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qte{constructor(e,t,i,r,s,o,a,c,h,u){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=h,this.isUsingEmulator=u}}const b_="(default)";class ym{constructor(e,t){this.projectId=e,this.database=t||b_}static empty(){return new ym("","")}get isDefaultDatabase(){return this.database===b_}isEqual(e){return e instanceof ym&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SH="__type__",Yte="__max__",zw={mapValue:{}},TH="__vector__",__="value";function Of(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?mk(n)?4:Jte(n)?9007199254740991:Zte(n)?10:11:Ki(28295,{value:n})}function xd(n,e){if(n===e)return!0;const t=Of(n);if(t!==Of(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Yy(n).isEqual(Yy(e));case 3:return(function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=Mf(r.timestampValue),a=Mf(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,s){return Rf(r.bytesValue).isEqual(Rf(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,s){return aa(r.geoPointValue.latitude)===aa(s.geoPointValue.latitude)&&aa(r.geoPointValue.longitude)===aa(s.geoPointValue.longitude)})(n,e);case 2:return(function(r,s){if("integerValue"in r&&"integerValue"in s)return aa(r.integerValue)===aa(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=aa(r.doubleValue),a=aa(s.doubleValue);return o===a?x_(o)===x_(a):isNaN(o)&&isNaN(a)}return!1})(n,e);case 9:return mm(n.arrayValue.values||[],e.arrayValue.values||[],xd);case 10:case 11:return(function(r,s){const o=r.mapValue.fields||{},a=s.mapValue.fields||{};if(gD(o)!==gD(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!xd(o[c],a[c])))return!1;return!0})(n,e);default:return Ki(52216,{left:n})}}function Zy(n,e){return(n.values||[]).find((t=>xd(t,e)))!==void 0}function vm(n,e){if(n===e)return 0;const t=Of(n),i=Of(e);if(t!==i)return Or(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Or(n.booleanValue,e.booleanValue);case 2:return(function(s,o){const a=aa(s.integerValue||s.doubleValue),c=aa(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1})(n,e);case 3:return yD(n.timestampValue,e.timestampValue);case 4:return yD(Yy(n),Yy(e));case 5:return _B(n.stringValue,e.stringValue);case 6:return(function(s,o){const a=Rf(s),c=Rf(o);return a.compareTo(c)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){const a=s.split("/"),c=o.split("/");for(let h=0;h<a.length&&h<c.length;h++){const u=Or(a[h],c[h]);if(u!==0)return u}return Or(a.length,c.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){const a=Or(aa(s.latitude),aa(o.latitude));return a!==0?a:Or(aa(s.longitude),aa(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return vD(n.arrayValue,e.arrayValue);case 10:return(function(s,o){var a,c,h,u;const d=s.fields||{},f=o.fields||{},A=(a=d[__])===null||a===void 0?void 0:a.arrayValue,g=(c=f[__])===null||c===void 0?void 0:c.arrayValue,p=Or(((h=A==null?void 0:A.values)===null||h===void 0?void 0:h.length)||0,((u=g==null?void 0:g.values)===null||u===void 0?void 0:u.length)||0);return p!==0?p:vD(A,g)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===zw.mapValue&&o===zw.mapValue)return 0;if(s===zw.mapValue)return 1;if(o===zw.mapValue)return-1;const a=s.fields||{},c=Object.keys(a),h=o.fields||{},u=Object.keys(h);c.sort(),u.sort();for(let d=0;d<c.length&&d<u.length;++d){const f=_B(c[d],u[d]);if(f!==0)return f;const A=vm(a[c[d]],h[u[d]]);if(A!==0)return A}return Or(c.length,u.length)})(n.mapValue,e.mapValue);default:throw Ki(23264,{le:t})}}function yD(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Or(n,e);const t=Mf(n),i=Mf(e),r=Or(t.seconds,i.seconds);return r!==0?r:Or(t.nanos,i.nanos)}function vD(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const s=vm(t[r],i[r]);if(s)return s}return Or(t.length,i.length)}function wm(n){return CB(n)}function CB(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=Mf(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Rf(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return $i.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const s of t.values||[])r?r=!1:i+=",",i+=CB(s);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${CB(t.fields[o])}`;return r+"}"})(n.mapValue):Ki(61005,{value:n})}function Ub(n){switch(Of(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=s5(n);return e?16+Ub(e):16;case 5:return 2*n.stringValue.length;case 6:return Rf(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((r,s)=>r+Ub(s)),0)})(n.arrayValue);case 10:case 11:return(function(i){let r=0;return Zf(i.fields,((s,o)=>{r+=s.length+Ub(o)})),r})(n.mapValue);default:throw Ki(13486,{value:n})}}function wD(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function SB(n){return!!n&&"integerValue"in n}function yk(n){return!!n&&"arrayValue"in n}function xD(n){return!!n&&"nullValue"in n}function bD(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Hb(n){return!!n&&"mapValue"in n}function Zte(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[SH])===null||t===void 0?void 0:t.stringValue)===TH}function dy(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Zf(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=dy(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=dy(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Jte(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Yte}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{constructor(e){this.value=e}static empty(){return new pc({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Hb(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=dy(t)}setAll(e){let t=ll.emptyPath(),i={},r=[];e.forEach(((o,a)=>{if(!t.isImmediateParentOf(a)){const c=this.getFieldsMap(t);this.applyChanges(c,i,r),i={},r=[],t=a.popLast()}o?i[a.lastSegment()]=dy(o):r.push(a.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());Hb(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return xd(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];Hb(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Zf(t,((r,s)=>e[r]=s));for(const r of i)delete e[r]}clone(){return new pc(dy(this.value))}}function BH(n){const e=[];return Zf(n.fields,((t,i)=>{const r=new ll([t]);if(Hb(i)){const s=BH(i.mapValue).fields;if(s.length===0)e.push(r);else for(const o of s)e.push(r.child(o))}else e.push(r)})),new sh(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(e,t,i,r,s,o,a){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new al(e,0,nr.min(),nr.min(),nr.min(),pc.empty(),0)}static newFoundDocument(e,t,i,r){return new al(e,1,t,nr.min(),i,r,0)}static newNoDocument(e,t){return new al(e,2,t,nr.min(),nr.min(),pc.empty(),0)}static newUnknownDocument(e,t){return new al(e,3,t,nr.min(),nr.min(),pc.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(nr.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=pc.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=pc.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=nr.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof al&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new al(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C_{constructor(e,t){this.position=e,this.inclusive=t}}function _D(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(s.field.isKeyField()?i=$i.comparator($i.fromName(o.referenceValue),t.key):i=vm(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function CD(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!xd(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jy{constructor(e,t="asc"){this.field=e,this.dir=t}}function ene(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EH{}class ba extends EH{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new nne(e,t,i):t==="array-contains"?new sne(e,i):t==="in"?new one(e,i):t==="not-in"?new ane(e,i):t==="array-contains-any"?new lne(e,i):new ba(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new ine(e,i):new rne(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(vm(t,this.value)):t!==null&&Of(this.value)===Of(t)&&this.matchesComparison(vm(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ki(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Eu extends EH{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new Eu(e,t)}matches(e){return kH(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function kH(n){return n.op==="and"}function IH(n){return tne(n)&&kH(n)}function tne(n){for(const e of n.filters)if(e instanceof Eu)return!1;return!0}function TB(n){if(n instanceof ba)return n.field.canonicalString()+n.op.toString()+wm(n.value);if(IH(n))return n.filters.map((e=>TB(e))).join(",");{const e=n.filters.map((t=>TB(t))).join(",");return`${n.op}(${e})`}}function FH(n,e){return n instanceof ba?(function(i,r){return r instanceof ba&&i.op===r.op&&i.field.isEqual(r.field)&&xd(i.value,r.value)})(n,e):n instanceof Eu?(function(i,r){return r instanceof Eu&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((s,o,a)=>s&&FH(o,r.filters[a])),!0):!1})(n,e):void Ki(19439)}function DH(n){return n instanceof ba?(function(t){return`${t.field.canonicalString()} ${t.op} ${wm(t.value)}`})(n):n instanceof Eu?(function(t){return t.op.toString()+" {"+t.getFilters().map(DH).join(" ,")+"}"})(n):"Filter"}class nne extends ba{constructor(e,t,i){super(e,t,i),this.key=$i.fromName(i.referenceValue)}matches(e){const t=$i.comparator(e.key,this.key);return this.matchesComparison(t)}}class ine extends ba{constructor(e,t){super(e,"in",t),this.keys=jH("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class rne extends ba{constructor(e,t){super(e,"not-in",t),this.keys=jH("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function jH(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((i=>$i.fromName(i.referenceValue)))}class sne extends ba{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return yk(t)&&Zy(t.arrayValue,this.value)}}class one extends ba{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Zy(this.value.arrayValue,t)}}class ane extends ba{constructor(e,t){super(e,"not-in",t)}matches(e){if(Zy(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Zy(this.value.arrayValue,t)}}class lne extends ba{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!yk(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Zy(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cne{constructor(e,t=null,i=[],r=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.Pe=null}}function SD(n,e=null,t=[],i=[],r=null,s=null,o=null){return new cne(n,e,t,i,r,s,o)}function vk(n){const e=gr(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>TB(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(s){return s.field.canonicalString()+s.dir})(i))).join(","),Rv(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>wm(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>wm(i))).join(",")),e.Pe=t}return e.Pe}function wk(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!ene(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!FH(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!CD(n.startAt,e.startAt)&&CD(n.endAt,e.endAt)}function BB(n){return $i.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cg{constructor(e,t=null,i=[],r=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function hne(n,e,t,i,r,s,o,a){return new Cg(n,e,t,i,r,s,o,a)}function o5(n){return new Cg(n)}function TD(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function PH(n){return n.collectionGroup!==null}function Ay(n){const e=gr(n);if(e.Te===null){e.Te=[];const t=new Set;for(const s of e.explicitOrderBy)e.Te.push(s),t.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Oa(ll.comparator);return o.filters.forEach((c=>{c.getFlattenedFilters().forEach((h=>{h.isInequality()&&(a=a.add(h.field))}))})),a})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Te.push(new Jy(s,i))})),t.has(ll.keyField().canonicalString())||e.Te.push(new Jy(ll.keyField(),i))}return e.Te}function pd(n){const e=gr(n);return e.Ie||(e.Ie=une(e,Ay(n))),e.Ie}function une(n,e){if(n.limitType==="F")return SD(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const s=r.dir==="desc"?"asc":"desc";return new Jy(r.field,s)}));const t=n.endAt?new C_(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new C_(n.startAt.position,n.startAt.inclusive):null;return SD(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function EB(n,e){const t=n.filters.concat([e]);return new Cg(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function kB(n,e,t){return new Cg(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function a5(n,e){return wk(pd(n),pd(e))&&n.limitType===e.limitType}function NH(n){return`${vk(pd(n))}|lt:${n.limitType}`}function C0(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>DH(r))).join(", ")}]`),Rv(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>wm(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>wm(r))).join(",")),`Target(${i})`})(pd(n))}; limitType=${n.limitType})`}function l5(n,e){return e.isFoundDocument()&&(function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):$i.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)})(n,e)&&(function(i,r){for(const s of Ay(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(o,a,c){const h=_D(o,a,c);return o.inclusive?h<=0:h<0})(i.startAt,Ay(i),r)||i.endAt&&!(function(o,a,c){const h=_D(o,a,c);return o.inclusive?h>=0:h>0})(i.endAt,Ay(i),r))})(n,e)}function dne(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function LH(n){return(e,t)=>{let i=!1;for(const r of Ay(n)){const s=Ane(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function Ane(n,e,t){const i=n.field.isKeyField()?$i.comparator(e.key,t.key):(function(s,o,a){const c=o.data.field(s),h=a.data.field(s);return c!==null&&h!==null?vm(c,h):Ki(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Ki(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sg{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Zf(this.inner,((t,i)=>{for(const[r,s]of i)e(r,s)}))}isEmpty(){return vH(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fne=new Lo($i.comparator);function xA(){return fne}const MH=new Lo($i.comparator);function Q2(...n){let e=MH;for(const t of n)e=e.insert(t.key,t);return e}function RH(n){let e=MH;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Up(){return fy()}function OH(){return fy()}function fy(){return new Sg((n=>n.toString()),((n,e)=>n.isEqual(e)))}const pne=new Lo($i.comparator),gne=new Oa($i.comparator);function Zr(...n){let e=gne;for(const t of n)e=e.add(t);return e}const mne=new Oa(Or);function yne(){return mne}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xk(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:x_(e)?"-0":e}}function UH(n){return{integerValue:""+n}}function vne(n,e){return zte(e)?UH(e):xk(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c5{constructor(){this._=void 0}}function wne(n,e,t){return n instanceof ev?(function(r,s){const o={fields:{[bH]:{stringValue:xH},[CH]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&mk(s)&&(s=s5(s)),s&&(o.fields[_H]=s),{mapValue:o}})(t,e):n instanceof xm?WH(n,e):n instanceof tv?QH(n,e):(function(r,s){const o=HH(r,s),a=BD(o)+BD(r.Ee);return SB(o)&&SB(r.Ee)?UH(a):xk(r.serializer,a)})(n,e)}function xne(n,e,t){return n instanceof xm?WH(n,e):n instanceof tv?QH(n,e):t}function HH(n,e){return n instanceof S_?(function(i){return SB(i)||(function(s){return!!s&&"doubleValue"in s})(i)})(e)?e:{integerValue:0}:null}class ev extends c5{}class xm extends c5{constructor(e){super(),this.elements=e}}function WH(n,e){const t=$H(e);for(const i of n.elements)t.some((r=>xd(r,i)))||t.push(i);return{arrayValue:{values:t}}}class tv extends c5{constructor(e){super(),this.elements=e}}function QH(n,e){let t=$H(e);for(const i of n.elements)t=t.filter((r=>!xd(r,i)));return{arrayValue:{values:t}}}class S_ extends c5{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function BD(n){return aa(n.integerValue||n.doubleValue)}function $H(n){return yk(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VH{constructor(e,t){this.field=e,this.transform=t}}function bne(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof xm&&r instanceof xm||i instanceof tv&&r instanceof tv?mm(i.elements,r.elements,xd):i instanceof S_&&r instanceof S_?xd(i.Ee,r.Ee):i instanceof ev&&r instanceof ev})(n.transform,e.transform)}class _ne{constructor(e,t){this.version=e,this.transformResults=t}}class kl{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new kl}static exists(e){return new kl(void 0,e)}static updateTime(e){return new kl(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Wb(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class h5{}function zH(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new u5(n.key,kl.none()):new Ov(n.key,n.data,kl.none());{const t=n.data,i=pc.empty();let r=new Oa(ll.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Jf(n.key,i,new sh(r.toArray()),kl.none())}}function Cne(n,e,t){n instanceof Ov?(function(r,s,o){const a=r.value.clone(),c=kD(r.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()})(n,e,t):n instanceof Jf?(function(r,s,o){if(!Wb(r.precondition,s))return void s.convertToUnknownDocument(o.version);const a=kD(r.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(GH(r)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):(function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function py(n,e,t,i){return n instanceof Ov?(function(s,o,a,c){if(!Wb(s.precondition,o))return a;const h=s.value.clone(),u=ID(s.fieldTransforms,c,o);return h.setAll(u),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,e,t,i):n instanceof Jf?(function(s,o,a,c){if(!Wb(s.precondition,o))return a;const h=ID(s.fieldTransforms,c,o),u=o.data;return u.setAll(GH(s)),u.setAll(h),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((d=>d.field)))})(n,e,t,i):(function(s,o,a){return Wb(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a})(n,e,t)}function Sne(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),s=HH(i.transform,r||null);s!=null&&(t===null&&(t=pc.empty()),t.set(i.field,s))}return t||null}function ED(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&mm(i,r,((s,o)=>bne(s,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ov extends h5{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Jf extends h5{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function GH(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function kD(n,e,t){const i=new Map;ls(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,xne(o,a,t[r]))}return i}function ID(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,wne(s,o,e))}return i}class u5 extends h5{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class XH extends h5{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tne{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&Cne(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=py(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=py(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=OH();return this.mutations.forEach((r=>{const s=e.get(r.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(r.key)?null:a;const c=zH(o,a);c!==null&&i.set(r.key,c),o.isValidDocument()||o.convertToNoDocument(nr.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Zr())}isEqual(e){return this.batchId===e.batchId&&mm(this.mutations,e.mutations,((t,i)=>ED(t,i)))&&mm(this.baseMutations,e.baseMutations,((t,i)=>ED(t,i)))}}class bk{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){ls(e.mutations.length===i.length,58842,{Ve:e.mutations.length,me:i.length});let r=(function(){return pne})();const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new bk(e,t,i,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bne{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ene{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ya,ss;function KH(n){switch(n){case yn.OK:return Ki(64938);case yn.CANCELLED:case yn.UNKNOWN:case yn.DEADLINE_EXCEEDED:case yn.RESOURCE_EXHAUSTED:case yn.INTERNAL:case yn.UNAVAILABLE:case yn.UNAUTHENTICATED:return!1;case yn.INVALID_ARGUMENT:case yn.NOT_FOUND:case yn.ALREADY_EXISTS:case yn.PERMISSION_DENIED:case yn.FAILED_PRECONDITION:case yn.ABORTED:case yn.OUT_OF_RANGE:case yn.UNIMPLEMENTED:case yn.DATA_LOSS:return!0;default:return Ki(15467,{code:n})}}function qH(n){if(n===void 0)return vA("GRPC error has no .code"),yn.UNKNOWN;switch(n){case ya.OK:return yn.OK;case ya.CANCELLED:return yn.CANCELLED;case ya.UNKNOWN:return yn.UNKNOWN;case ya.DEADLINE_EXCEEDED:return yn.DEADLINE_EXCEEDED;case ya.RESOURCE_EXHAUSTED:return yn.RESOURCE_EXHAUSTED;case ya.INTERNAL:return yn.INTERNAL;case ya.UNAVAILABLE:return yn.UNAVAILABLE;case ya.UNAUTHENTICATED:return yn.UNAUTHENTICATED;case ya.INVALID_ARGUMENT:return yn.INVALID_ARGUMENT;case ya.NOT_FOUND:return yn.NOT_FOUND;case ya.ALREADY_EXISTS:return yn.ALREADY_EXISTS;case ya.PERMISSION_DENIED:return yn.PERMISSION_DENIED;case ya.FAILED_PRECONDITION:return yn.FAILED_PRECONDITION;case ya.ABORTED:return yn.ABORTED;case ya.OUT_OF_RANGE:return yn.OUT_OF_RANGE;case ya.UNIMPLEMENTED:return yn.UNIMPLEMENTED;case ya.DATA_LOSS:return yn.DATA_LOSS;default:return Ki(39323,{code:n})}}(ss=ya||(ya={}))[ss.OK=0]="OK",ss[ss.CANCELLED=1]="CANCELLED",ss[ss.UNKNOWN=2]="UNKNOWN",ss[ss.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ss[ss.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ss[ss.NOT_FOUND=5]="NOT_FOUND",ss[ss.ALREADY_EXISTS=6]="ALREADY_EXISTS",ss[ss.PERMISSION_DENIED=7]="PERMISSION_DENIED",ss[ss.UNAUTHENTICATED=16]="UNAUTHENTICATED",ss[ss.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ss[ss.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ss[ss.ABORTED=10]="ABORTED",ss[ss.OUT_OF_RANGE=11]="OUT_OF_RANGE",ss[ss.UNIMPLEMENTED=12]="UNIMPLEMENTED",ss[ss.INTERNAL=13]="INTERNAL",ss[ss.UNAVAILABLE=14]="UNAVAILABLE",ss[ss.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kne=new kf([4294967295,4294967295],0);function FD(n){const e=pH().encode(n),t=new oH;return t.update(e),new Uint8Array(t.digest())}function DD(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new kf([t,i],0),new kf([r,s],0)]}class _k{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new $2(`Invalid padding: ${t}`);if(i<0)throw new $2(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new $2(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new $2(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=kf.fromNumber(this.fe)}pe(e,t,i){let r=e.add(t.multiply(kf.fromNumber(i)));return r.compare(kne)===1&&(r=new kf([r.getBits(0),r.getBits(1)],0)),r.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=FD(e),[i,r]=DD(t);for(let s=0;s<this.hashCount;s++){const o=this.pe(i,r,s);if(!this.ye(o))return!1}return!0}static create(e,t,i){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new _k(s,r,t);return i.forEach((a=>o.insert(a))),o}insert(e){if(this.fe===0)return;const t=FD(e),[i,r]=DD(t);for(let s=0;s<this.hashCount;s++){const o=this.pe(i,r,s);this.we(o)}}we(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class $2 extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d5{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,Uv.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new d5(nr.min(),r,new Lo(Or),xA(),Zr())}}class Uv{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Uv(i,t,Zr(),Zr(),Zr())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qb{constructor(e,t,i,r){this.Se=e,this.removedTargetIds=t,this.key=i,this.be=r}}class YH{constructor(e,t){this.targetId=e,this.De=t}}class ZH{constructor(e,t,i=ul.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class jD{constructor(){this.ve=0,this.Ce=PD(),this.Fe=ul.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=Zr(),t=Zr(),i=Zr();return this.Ce.forEach(((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:Ki(38017,{changeType:s})}})),new Uv(this.Fe,this.Me,e,t,i)}ke(){this.xe=!1,this.Ce=PD()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,ls(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class Ine{constructor(e){this.We=e,this.Ge=new Map,this.ze=xA(),this.je=Gw(),this.Je=Gw(),this.He=new Lo(Or)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,(t=>{const i=this.tt(t);switch(e.state){case 0:this.nt(t)&&i.Be(e.resumeToken);break;case 1:i.Ue(),i.Oe||i.ke(),i.Be(e.resumeToken);break;case 2:i.Ue(),i.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(i.Ke(),i.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),i.Be(e.resumeToken));break;default:Ki(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach(((i,r)=>{this.nt(r)&&t(r)}))}it(e){const t=e.targetId,i=e.De.count,r=this.st(t);if(r){const s=r.target;if(BB(s))if(i===0){const o=new $i(s.path);this.Xe(t,o,al.newNoDocument(o,nr.min()))}else ls(i===1,20013,{expectedCount:i});else{const o=this.ot(t);if(o!==i){const a=this._t(e),c=a?this.ut(a,e,o):1;if(c!==0){this.rt(t);const h=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,h)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=t;let o,a;try{o=Rf(i).toUint8Array()}catch(c){if(c instanceof wH)return wA("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new _k(o,r,s)}catch(c){return wA(c instanceof $2?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.fe===0?null:a}ut(e,t,i){return t.De.count===i-this.ht(e,t.targetId)?0:2}ht(e,t){const i=this.We.getRemoteKeysForTarget(t);let r=0;return i.forEach((s=>{const o=this.We.lt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Xe(t,s,null),r++)})),r}Pt(e){const t=new Map;this.Ge.forEach(((s,o)=>{const a=this.st(o);if(a){if(s.current&&BB(a.target)){const c=new $i(a.target.path);this.Tt(c).has(o)||this.It(o,c)||this.Xe(o,c,al.newNoDocument(c,e))}s.Ne&&(t.set(o,s.Le()),s.ke())}}));let i=Zr();this.Je.forEach(((s,o)=>{let a=!0;o.forEachWhile((c=>{const h=this.st(c);return!h||h.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)})),a&&(i=i.add(s))})),this.ze.forEach(((s,o)=>o.setReadTime(e)));const r=new d5(e,t,this.He,this.ze,i);return this.ze=xA(),this.je=Gw(),this.Je=Gw(),this.He=new Lo(Or),r}Ze(e,t){if(!this.nt(e))return;const i=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,i),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,i){if(!this.nt(e))return;const r=this.tt(e);this.It(e,t)?r.qe(t,1):r.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),i&&(this.ze=this.ze.insert(t,i))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new jD,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new Oa(Or),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new Oa(Or),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||xi("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new jD),this.We.getRemoteKeysForTarget(e).forEach((t=>{this.Xe(e,t,null)}))}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function Gw(){return new Lo($i.comparator)}function PD(){return new Lo($i.comparator)}const Fne={asc:"ASCENDING",desc:"DESCENDING"},Dne={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},jne={and:"AND",or:"OR"};class Pne{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function IB(n,e){return n.useProto3Json||Rv(e)?e:{value:e}}function T_(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function JH(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Nne(n,e){return T_(n,e.toTimestamp())}function lh(n){return ls(!!n,49232),nr.fromTimestamp((function(t){const i=Mf(t);return new Ps(i.seconds,i.nanos)})(n))}function Ck(n,e){return FB(n,e).canonicalString()}function FB(n,e){const t=(function(r){return new js(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function eW(n){const e=js.fromString(n);return ls(oW(e),10190,{key:e.toString()}),e}function B_(n,e){return Ck(n.databaseId,e.path)}function gy(n,e){const t=eW(e);if(t.get(1)!==n.databaseId.projectId)throw new ri(yn.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ri(yn.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new $i(nW(t))}function tW(n,e){return Ck(n.databaseId,e)}function Lne(n){const e=eW(n);return e.length===4?js.emptyPath():nW(e)}function DB(n){return new js(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function nW(n){return ls(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function ND(n,e,t){return{name:B_(n,e),fields:t.value.mapValue.fields}}function Mne(n,e){return"found"in e?(function(i,r){ls(!!r.found,43571),r.found.name,r.found.updateTime;const s=gy(i,r.found.name),o=lh(r.found.updateTime),a=r.found.createTime?lh(r.found.createTime):nr.min(),c=new pc({mapValue:{fields:r.found.fields}});return al.newFoundDocument(s,o,a,c)})(n,e):"missing"in e?(function(i,r){ls(!!r.missing,3894),ls(!!r.readTime,22933);const s=gy(i,r.missing),o=lh(r.readTime);return al.newNoDocument(s,o)})(n,e):Ki(7234,{result:e})}function Rne(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:Ki(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=(function(h,u){return h.useProto3Json?(ls(u===void 0||typeof u=="string",58123),ul.fromBase64String(u||"")):(ls(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),ul.fromUint8Array(u||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&(function(h){const u=h.code===void 0?yn.UNKNOWN:qH(h.code);return new ri(u,h.message||"")})(o);t=new ZH(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=gy(n,i.document.name),s=lh(i.document.updateTime),o=i.document.createTime?lh(i.document.createTime):nr.min(),a=new pc({mapValue:{fields:i.document.fields}}),c=al.newFoundDocument(r,s,o,a),h=i.targetIds||[],u=i.removedTargetIds||[];t=new Qb(h,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=gy(n,i.document),s=i.readTime?lh(i.readTime):nr.min(),o=al.newNoDocument(r,s),a=i.removedTargetIds||[];t=new Qb([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=gy(n,i.document),s=i.removedTargetIds||[];t=new Qb([],s,r,null)}else{if(!("filter"in e))return Ki(11601,{At:e});{e.filter;const i=e.filter;i.targetId;const{count:r=0,unchangedNames:s}=i,o=new Ene(r,s),a=i.targetId;t=new YH(a,o)}}return t}function iW(n,e){let t;if(e instanceof Ov)t={update:ND(n,e.key,e.value)};else if(e instanceof u5)t={delete:B_(n,e.key)};else if(e instanceof Jf)t={update:ND(n,e.key,e.data),updateMask:Gne(e.fieldMask)};else{if(!(e instanceof XH))return Ki(16599,{Rt:e.type});t={verify:B_(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(s,o){const a=o.transform;if(a instanceof ev)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof xm)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof tv)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof S_)return{fieldPath:o.field.canonicalString(),increment:a.Ee};throw Ki(20930,{transform:o.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,s){return s.updateTime!==void 0?{updateTime:Nne(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ki(27497)})(n,e.precondition)),t}function One(n,e){return n&&n.length>0?(ls(e!==void 0,14353),n.map((t=>(function(r,s){let o=r.updateTime?lh(r.updateTime):lh(s);return o.isEqual(nr.min())&&(o=lh(s)),new _ne(o,r.transformResults||[])})(t,e)))):[]}function Une(n,e){return{documents:[tW(n,e.path)]}}function Hne(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=tW(n,r);const s=(function(h){if(h.length!==0)return sW(Eu.create(h,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const o=(function(h){if(h.length!==0)return h.map((u=>(function(f){return{field:S0(f.field),direction:$ne(f.dir)}})(u)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=IB(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{Vt:t,parent:r}}function Wne(n){let e=Lne(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){ls(i===1,65062);const u=t.from[0];u.allDescendants?r=u.collectionId:e=e.child(u.collectionId)}let s=[];t.where&&(s=(function(d){const f=rW(d);return f instanceof Eu&&IH(f)?f.getFilters():[f]})(t.where));let o=[];t.orderBy&&(o=(function(d){return d.map((f=>(function(g){return new Jy(T0(g.field),(function(y){switch(y){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(g.direction))})(f)))})(t.orderBy));let a=null;t.limit&&(a=(function(d){let f;return f=typeof d=="object"?d.value:d,Rv(f)?null:f})(t.limit));let c=null;t.startAt&&(c=(function(d){const f=!!d.before,A=d.values||[];return new C_(A,f)})(t.startAt));let h=null;return t.endAt&&(h=(function(d){const f=!d.before,A=d.values||[];return new C_(A,f)})(t.endAt)),hne(e,r,o,s,a,"F",c,h)}function Qne(n,e){const t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ki(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function rW(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=T0(t.unaryFilter.field);return ba.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=T0(t.unaryFilter.field);return ba.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=T0(t.unaryFilter.field);return ba.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=T0(t.unaryFilter.field);return ba.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ki(61313);default:return Ki(60726)}})(n):n.fieldFilter!==void 0?(function(t){return ba.create(T0(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ki(58110);default:return Ki(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Eu.create(t.compositeFilter.filters.map((i=>rW(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Ki(1026)}})(t.compositeFilter.op))})(n):Ki(30097,{filter:n})}function $ne(n){return Fne[n]}function Vne(n){return Dne[n]}function zne(n){return jne[n]}function S0(n){return{fieldPath:n.canonicalString()}}function T0(n){return ll.fromServerFormat(n.fieldPath)}function sW(n){return n instanceof ba?(function(t){if(t.op==="=="){if(bD(t.value))return{unaryFilter:{field:S0(t.field),op:"IS_NAN"}};if(xD(t.value))return{unaryFilter:{field:S0(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(bD(t.value))return{unaryFilter:{field:S0(t.field),op:"IS_NOT_NAN"}};if(xD(t.value))return{unaryFilter:{field:S0(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:S0(t.field),op:Vne(t.op),value:t.value}}})(n):n instanceof Eu?(function(t){const i=t.getFilters().map((r=>sW(r)));return i.length===1?i[0]:{compositeFilter:{op:zne(t.op),filters:i}}})(n):Ki(54877,{filter:n})}function Gne(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function oW(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vf{constructor(e,t,i,r,s=nr.min(),o=nr.min(),a=ul.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new vf(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new vf(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new vf(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new vf(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xne{constructor(e){this.gt=e}}function Kne(n){const e=Wne({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?kB(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qne{constructor(){this.Dn=new Yne}addToCollectionParentIndex(e,t){return this.Dn.add(t),Bn.resolve()}getCollectionParents(e,t){return Bn.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return Bn.resolve()}deleteFieldIndex(e,t){return Bn.resolve()}deleteAllFieldIndexes(e){return Bn.resolve()}createTargetIndexes(e,t){return Bn.resolve()}getDocumentsMatchingTarget(e,t){return Bn.resolve(null)}getIndexType(e,t){return Bn.resolve(0)}getFieldIndexes(e,t){return Bn.resolve([])}getNextCollectionGroupToUpdate(e){return Bn.resolve(null)}getMinOffset(e,t){return Bn.resolve(Lf.min())}getMinOffsetFromCollectionGroup(e,t){return Bn.resolve(Lf.min())}updateCollectionGroup(e,t,i){return Bn.resolve()}updateIndexEntries(e,t){return Bn.resolve()}}class Yne{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new Oa(js.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new Oa(js.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LD={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},aW=41943040;class Nc{static withCacheSize(e){return new Nc(e,Nc.DEFAULT_COLLECTION_PERCENTILE,Nc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Nc.DEFAULT_COLLECTION_PERCENTILE=10,Nc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Nc.DEFAULT=new Nc(aW,Nc.DEFAULT_COLLECTION_PERCENTILE,Nc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Nc.DISABLED=new Nc(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bm{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new bm(0)}static ur(){return new bm(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MD="LruGarbageCollector",Zne=1048576;function RD([n,e],[t,i]){const r=Or(n,t);return r===0?Or(e,i):r}class Jne{constructor(e){this.Tr=e,this.buffer=new Oa(RD),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();RD(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class eie{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){xi(MD,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Om(t)?xi(MD,"Ignoring IndexedDB error during garbage collection: ",t):await Rm(t)}await this.Rr(3e5)}))}}class tie{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Bn.resolve(r5.ue);const i=new Jne(t);return this.Vr.forEachTarget(e,(r=>i.Er(r.sequenceNumber))).next((()=>this.Vr.gr(e,(r=>i.Er(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(xi("LruGarbageCollector","Garbage collection skipped; disabled"),Bn.resolve(LD)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(xi("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),LD):this.pr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let i,r,s,o,a,c,h;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((d=>(d>this.params.maximumSequenceNumbersToCollect?(xi("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),r=this.params.maximumSequenceNumbersToCollect):r=d,o=Date.now(),this.nthSequenceNumber(e,r)))).next((d=>(i=d,a=Date.now(),this.removeTargets(e,i,t)))).next((d=>(s=d,c=Date.now(),this.removeOrphanedDocuments(e,i)))).next((d=>(h=Date.now(),_0()<=qr.DEBUG&&xi("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${d} documents in `+(h-c)+`ms
Total Duration: ${h-u}ms`),Bn.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:d}))))}}function nie(n,e){return new tie(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iie{constructor(){this.changes=new Sg((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,al.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Bn.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rie{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sie{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&py(i.mutation,r,sh.empty(),Ps.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Zr()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Zr()){const r=Up();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((s=>{let o=Q2();return s.forEach(((a,c)=>{o=o.insert(a,c.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const i=Up();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Zr())))}populateOverlays(e,t,i){const r=[];return i.forEach((s=>{t.has(s)||r.push(s)})),this.documentOverlayCache.getOverlays(e,r).next((s=>{s.forEach(((o,a)=>{t.set(o,a)}))}))}computeViews(e,t,i,r){let s=xA();const o=fy(),a=(function(){return fy()})();return t.forEach(((c,h)=>{const u=i.get(h.key);r.has(h.key)&&(u===void 0||u.mutation instanceof Jf)?s=s.insert(h.key,h):u!==void 0?(o.set(h.key,u.mutation.getFieldMask()),py(u.mutation,h,u.mutation.getFieldMask(),Ps.now())):o.set(h.key,sh.empty())})),this.recalculateAndSaveOverlays(e,s).next((c=>(c.forEach(((h,u)=>o.set(h,u))),t.forEach(((h,u)=>{var d;return a.set(h,new rie(u,(d=o.get(h))!==null&&d!==void 0?d:null))})),a)))}recalculateAndSaveOverlays(e,t){const i=fy();let r=new Lo(((o,a)=>o-a)),s=Zr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const a of o)a.keys().forEach((c=>{const h=t.get(c);if(h===null)return;let u=i.get(c)||sh.empty();u=a.applyToLocalView(h,u),i.set(c,u);const d=(r.get(a.batchId)||Zr()).add(c);r=r.insert(a.batchId,d)}))})).next((()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),h=c.key,u=c.value,d=OH();u.forEach((f=>{if(!s.has(f)){const A=zH(t.get(f),i.get(f));A!==null&&d.set(f,A),s=s.add(f)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,d))}return Bn.waitFor(o)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return(function(o){return $i.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):PH(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):Bn.resolve(Up());let a=qy,c=s;return o.next((h=>Bn.forEach(h,((u,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(u)?Bn.resolve():this.remoteDocumentCache.getEntry(e,u).next((f=>{c=c.insert(u,f)}))))).next((()=>this.populateOverlays(e,h,s))).next((()=>this.computeViews(e,c,h,Zr()))).next((u=>({batchId:a,changes:RH(u)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new $i(t)).next((i=>{let r=Q2();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const s=t.collectionGroup;let o=Q2();return this.indexManager.getCollectionParents(e,s).next((a=>Bn.forEach(a,(c=>{const h=(function(d,f){return new Cg(f,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)})(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,i,r).next((u=>{u.forEach(((d,f)=>{o=o.insert(d,f)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r)))).next((o=>{s.forEach(((c,h)=>{const u=h.getKey();o.get(u)===null&&(o=o.insert(u,al.newInvalidDocument(u)))}));let a=Q2();return o.forEach(((c,h)=>{const u=s.get(c);u!==void 0&&py(u.mutation,h,sh.empty(),Ps.now()),l5(t,h)&&(a=a.insert(c,h))})),a}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oie{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return Bn.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:lh(r.createTime)}})(t)),Bn.resolve()}getNamedQuery(e,t){return Bn.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(r){return{name:r.name,query:Kne(r.bundledQuery),readTime:lh(r.readTime)}})(t)),Bn.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aie{constructor(){this.overlays=new Lo($i.comparator),this.kr=new Map}getOverlay(e,t){return Bn.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Up();return Bn.forEach(t,(r=>this.getOverlay(e,r).next((s=>{s!==null&&i.set(r,s)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,s)=>{this.wt(e,t,s)})),Bn.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.kr.get(i);return r!==void 0&&(r.forEach((s=>this.overlays=this.overlays.remove(s))),this.kr.delete(i)),Bn.resolve()}getOverlaysForCollection(e,t,i){const r=Up(),s=t.length+1,o=new $i(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,h=c.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&c.largestBatchId>i&&r.set(c.getKey(),c)}return Bn.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new Lo(((h,u)=>h-u));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>i){let u=s.get(h.largestBatchId);u===null&&(u=Up(),s=s.insert(h.largestBatchId,u)),u.set(h.getKey(),h)}}const a=Up(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach(((h,u)=>a.set(h,u))),!(a.size()>=r)););return Bn.resolve(a)}wt(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.kr.get(r.largestBatchId).delete(i.key);this.kr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new Bne(t,i));let s=this.kr.get(t);s===void 0&&(s=Zr(),this.kr.set(t,s)),this.kr.set(t,s.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lie{constructor(){this.sessionToken=ul.EMPTY_BYTE_STRING}getSessionToken(e){return Bn.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Bn.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sk{constructor(){this.qr=new Oa(il.Qr),this.$r=new Oa(il.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const i=new il(e,t);this.qr=this.qr.add(i),this.$r=this.$r.add(i)}Kr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new il(e,t))}Gr(e,t){e.forEach((i=>this.removeReference(i,t)))}zr(e){const t=new $i(new js([])),i=new il(t,e),r=new il(t,e+1),s=[];return this.$r.forEachInRange([i,r],(o=>{this.Wr(o),s.push(o.key)})),s}jr(){this.qr.forEach((e=>this.Wr(e)))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new $i(new js([])),i=new il(t,e),r=new il(t,e+1);let s=Zr();return this.$r.forEachInRange([i,r],(o=>{s=s.add(o.key)})),s}containsKey(e){const t=new il(e,0),i=this.qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class il{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return $i.comparator(e.key,t.key)||Or(e.Hr,t.Hr)}static Ur(e,t){return Or(e.Hr,t.Hr)||$i.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cie{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new Oa(il.Qr)}checkEmpty(e){return Bn.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const s=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Tne(s,t,i,r);this.mutationQueue.push(o);for(const a of r)this.Yr=this.Yr.add(new il(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return Bn.resolve(o)}lookupMutationBatch(e,t){return Bn.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.Xr(i),s=r<0?0:r;return Bn.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Bn.resolve(this.mutationQueue.length===0?gk:this.er-1)}getAllMutationBatches(e){return Bn.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new il(t,0),r=new il(t,Number.POSITIVE_INFINITY),s=[];return this.Yr.forEachInRange([i,r],(o=>{const a=this.Zr(o.Hr);s.push(a)})),Bn.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Oa(Or);return t.forEach((r=>{const s=new il(r,0),o=new il(r,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([s,o],(a=>{i=i.add(a.Hr)}))})),Bn.resolve(this.ei(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;$i.isDocumentKey(s)||(s=s.child(""));const o=new il(new $i(s),0);let a=new Oa(Or);return this.Yr.forEachWhile((c=>{const h=c.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(a=a.add(c.Hr)),!0)}),o),Bn.resolve(this.ei(a))}ei(e){const t=[];return e.forEach((i=>{const r=this.Zr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){ls(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Yr;return Bn.forEach(t.mutations,(r=>{const s=new il(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Yr=i}))}rr(e){}containsKey(e,t){const i=new il(t,0),r=this.Yr.firstAfterOrEqual(i);return Bn.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Bn.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hie{constructor(e){this.ni=e,this.docs=(function(){return new Lo($i.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.ni(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Bn.resolve(i?i.document.mutableCopy():al.newInvalidDocument(t))}getEntries(e,t){let i=xA();return t.forEach((r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():al.newInvalidDocument(r))})),Bn.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=xA();const o=t.path,a=new $i(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:h,value:{document:u}}=c.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||Wte(Hte(u),i)<=0||(r.has(u.key)||l5(t,u))&&(s=s.insert(u.key,u.mutableCopy()))}return Bn.resolve(s)}getAllFromCollectionGroup(e,t,i,r){Ki(9500)}ri(e,t){return Bn.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new uie(this)}getSize(e){return Bn.resolve(this.size)}}class uie extends iie{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Or.addEntry(e,r)):this.Or.removeEntry(i)})),Bn.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class die{constructor(e){this.persistence=e,this.ii=new Sg((t=>vk(t)),wk),this.lastRemoteSnapshotVersion=nr.min(),this.highestTargetId=0,this.si=0,this.oi=new Sk,this.targetCount=0,this._i=bm.ar()}forEachTarget(e,t){return this.ii.forEach(((i,r)=>t(r))),Bn.resolve()}getLastRemoteSnapshotVersion(e){return Bn.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Bn.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),Bn.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.si&&(this.si=t),Bn.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new bm(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,Bn.resolve()}updateTargetData(e,t){return this.hr(t),Bn.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,Bn.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.ii.forEach(((o,a)=>{a.sequenceNumber<=t&&i.get(a.targetId)===null&&(this.ii.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)})),Bn.waitFor(s).next((()=>r))}getTargetCount(e){return Bn.resolve(this.targetCount)}getTargetData(e,t){const i=this.ii.get(t)||null;return Bn.resolve(i)}addMatchingKeys(e,t,i){return this.oi.Kr(t,i),Bn.resolve()}removeMatchingKeys(e,t,i){this.oi.Gr(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach((o=>{s.push(r.markPotentiallyOrphaned(e,o))})),Bn.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),Bn.resolve()}getMatchingKeysForTargetId(e,t){const i=this.oi.Jr(t);return Bn.resolve(i)}containsKey(e,t){return Bn.resolve(this.oi.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lW{constructor(e,t){this.ai={},this.overlays={},this.ui=new r5(0),this.ci=!1,this.ci=!0,this.li=new lie,this.referenceDelegate=e(this),this.hi=new die(this),this.indexManager=new qne,this.remoteDocumentCache=(function(r){return new hie(r)})((i=>this.referenceDelegate.Pi(i))),this.serializer=new Xne(t),this.Ti=new oie(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new aie,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ai[e.toKey()];return i||(i=new cie(t,this.referenceDelegate),this.ai[e.toKey()]=i),i}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,i){xi("MemoryPersistence","Starting transaction:",e);const r=new Aie(this.ui.next());return this.referenceDelegate.Ii(),i(r).next((s=>this.referenceDelegate.di(r).next((()=>s)))).toPromise().then((s=>(r.raiseOnCommittedEvent(),s)))}Ei(e,t){return Bn.or(Object.values(this.ai).map((i=>()=>i.containsKey(e,t))))}}class Aie extends $te{constructor(e){super(),this.currentSequenceNumber=e}}class Tk{constructor(e){this.persistence=e,this.Ai=new Sk,this.Ri=null}static Vi(e){return new Tk(e)}get mi(){if(this.Ri)return this.Ri;throw Ki(60996)}addReference(e,t,i){return this.Ai.addReference(i,t),this.mi.delete(i.toString()),Bn.resolve()}removeReference(e,t,i){return this.Ai.removeReference(i,t),this.mi.add(i.toString()),Bn.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),Bn.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach((r=>this.mi.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((s=>this.mi.add(s.toString())))})).next((()=>i.removeTargetData(e,t)))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Bn.forEach(this.mi,(i=>{const r=$i.fromPath(i);return this.fi(e,r).next((s=>{s||t.removeEntry(r,nr.min())}))})).next((()=>(this.Ri=null,t.apply(e))))}updateLimboDocument(e,t){return this.fi(e,t).next((i=>{i?this.mi.delete(t.toString()):this.mi.add(t.toString())}))}Pi(e){return 0}fi(e,t){return Bn.or([()=>Bn.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class E_{constructor(e,t){this.persistence=e,this.gi=new Sg((i=>Gte(i.path)),((i,r)=>i.isEqual(r))),this.garbageCollector=nie(this,t)}static Vi(e,t){return new E_(e,t)}Ii(){}di(e){return Bn.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}yr(e){let t=0;return this.gr(e,(i=>{t++})).next((()=>t))}gr(e,t){return Bn.forEach(this.gi,((i,r)=>this.Sr(e,i,r).next((s=>s?Bn.resolve():t(r)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.ri(e,(o=>this.Sr(e,o,t).next((a=>{a||(i++,s.removeEntry(o,nr.min()))})))).next((()=>s.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),Bn.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.gi.set(i,e.currentSequenceNumber),Bn.resolve()}removeReference(e,t,i){return this.gi.set(i,e.currentSequenceNumber),Bn.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),Bn.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ub(e.data.value)),t}Sr(e,t,i){return Bn.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.gi.get(t);return Bn.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bk{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Is=i,this.ds=r}static Es(e,t){let i=Zr(),r=Zr();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new Bk(e,t.fromCache,i,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fie{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pie{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return AZ()?8:Vte(Jl())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,i,r){const s={result:null};return this.ps(e,t).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ys(e,t,r,i).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new fie;return this.ws(e,t,o).next((a=>{if(s.result=a,this.Rs)return this.Ss(e,t,o,a.size)}))})).next((()=>s.result))}Ss(e,t,i,r){return i.documentReadCount<this.Vs?(_0()<=qr.DEBUG&&xi("QueryEngine","SDK will not create cache indexes for query:",C0(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Bn.resolve()):(_0()<=qr.DEBUG&&xi("QueryEngine","Query:",C0(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.fs*r?(_0()<=qr.DEBUG&&xi("QueryEngine","The SDK decides to create cache indexes for query:",C0(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,pd(t))):Bn.resolve())}ps(e,t){if(TD(t))return Bn.resolve(null);let i=pd(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=kB(t,null,"F"),i=pd(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((s=>{const o=Zr(...s);return this.gs.getDocuments(e,o).next((a=>this.indexManager.getMinOffset(e,i).next((c=>{const h=this.bs(t,a);return this.Ds(t,h,o,c.readTime)?this.ps(e,kB(t,null,"F")):this.vs(e,h,t,c)}))))})))))}ys(e,t,i,r){return TD(t)||r.isEqual(nr.min())?Bn.resolve(null):this.gs.getDocuments(e,i).next((s=>{const o=this.bs(t,s);return this.Ds(t,o,i,r)?Bn.resolve(null):(_0()<=qr.DEBUG&&xi("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),C0(t)),this.vs(e,o,t,Ute(r,qy)).next((a=>a)))}))}bs(e,t){let i=new Oa(LH(e));return t.forEach(((r,s)=>{l5(e,s)&&(i=i.add(s))})),i}Ds(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}ws(e,t,i){return _0()<=qr.DEBUG&&xi("QueryEngine","Using full collection scan to execute query:",C0(t)),this.gs.getDocumentsMatchingQuery(e,t,Lf.min(),i)}vs(e,t,i,r){return this.gs.getDocumentsMatchingQuery(e,i,r).next((s=>(t.forEach((o=>{s=s.insert(o.key,o)})),s)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ek="LocalStore",gie=3e8;class mie{constructor(e,t,i,r){this.persistence=e,this.Cs=t,this.serializer=r,this.Fs=new Lo(Or),this.Ms=new Sg((s=>vk(s)),wk),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(i)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new sie(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Fs)))}}function yie(n,e,t,i){return new mie(n,e,t,i)}async function cW(n,e){const t=gr(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((s=>(r=s,t.Ns(e),t.mutationQueue.getAllMutationBatches(i)))).next((s=>{const o=[],a=[];let c=Zr();for(const h of r){o.push(h.batchId);for(const u of h.mutations)c=c.add(u.key)}for(const h of s){a.push(h.batchId);for(const u of h.mutations)c=c.add(u.key)}return t.localDocuments.getDocuments(i,c).next((h=>({Bs:h,removedBatchIds:o,addedBatchIds:a})))}))}))}function vie(n,e){const t=gr(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),s=t.Os.newChangeBuffer({trackRemovals:!0});return(function(a,c,h,u){const d=h.batch,f=d.keys();let A=Bn.resolve();return f.forEach((g=>{A=A.next((()=>u.getEntry(c,g))).next((p=>{const y=h.docVersions.get(g);ls(y!==null,48541),p.version.compareTo(y)<0&&(d.applyToRemoteDocument(p,h),p.isValidDocument()&&(p.setReadTime(h.commitVersion),u.addEntry(p)))}))})),A.next((()=>a.mutationQueue.removeMutationBatch(c,d)))})(t,i,e,s).next((()=>s.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(a){let c=Zr();for(let h=0;h<a.mutationResults.length;++h)a.mutationResults[h].transformResults.length>0&&(c=c.add(a.batch.mutations[h].key));return c})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function hW(n){const e=gr(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.hi.getLastRemoteSnapshotVersion(t)))}function wie(n,e){const t=gr(n),i=e.snapshotVersion;let r=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const o=t.Os.newChangeBuffer({trackRemovals:!0});r=t.Fs;const a=[];e.targetChanges.forEach(((u,d)=>{const f=r.get(d);if(!f)return;a.push(t.hi.removeMatchingKeys(s,u.removedDocuments,d).next((()=>t.hi.addMatchingKeys(s,u.addedDocuments,d))));let A=f.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?A=A.withResumeToken(ul.EMPTY_BYTE_STRING,nr.min()).withLastLimboFreeSnapshotVersion(nr.min()):u.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(u.resumeToken,i)),r=r.insert(d,A),(function(p,y,v){return p.resumeToken.approximateByteSize()===0||y.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=gie?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0})(f,A,u)&&a.push(t.hi.updateTargetData(s,A))}));let c=xA(),h=Zr();if(e.documentUpdates.forEach((u=>{e.resolvedLimboDocuments.has(u)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,u))})),a.push(xie(s,o,e.documentUpdates).next((u=>{c=u.Ls,h=u.ks}))),!i.isEqual(nr.min())){const u=t.hi.getLastRemoteSnapshotVersion(s).next((d=>t.hi.setTargetsMetadata(s,s.currentSequenceNumber,i)));a.push(u)}return Bn.waitFor(a).next((()=>o.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,c,h))).next((()=>c))})).then((s=>(t.Fs=r,s)))}function xie(n,e,t){let i=Zr(),r=Zr();return t.forEach((s=>i=i.add(s))),e.getEntries(n,i).next((s=>{let o=xA();return t.forEach(((a,c)=>{const h=s.get(a);c.isFoundDocument()!==h.isFoundDocument()&&(r=r.add(a)),c.isNoDocument()&&c.version.isEqual(nr.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!h.isValidDocument()||c.version.compareTo(h.version)>0||c.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):xi(Ek,"Ignoring outdated watch update for ",a,". Current version:",h.version," Watch version:",c.version)})),{Ls:o,ks:r}}))}function bie(n,e){const t=gr(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=gk),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function _ie(n,e){const t=gr(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let r;return t.hi.getTargetData(i,e).next((s=>s?(r=s,Bn.resolve(r)):t.hi.allocateTargetId(i).next((o=>(r=new vf(e,o,"TargetPurposeListen",i.currentSequenceNumber),t.hi.addTargetData(i,r).next((()=>r)))))))})).then((i=>{const r=t.Fs.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(i.targetId,i),t.Ms.set(e,i.targetId)),i}))}async function jB(n,e,t){const i=gr(n),r=i.Fs.get(e),s=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",s,(o=>i.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(!Om(o))throw o;xi(Ek,`Failed to update sequence numbers for target ${e}: ${o}`)}i.Fs=i.Fs.remove(e),i.Ms.delete(r.target)}function OD(n,e,t){const i=gr(n);let r=nr.min(),s=Zr();return i.persistence.runTransaction("Execute query","readwrite",(o=>(function(c,h,u){const d=gr(c),f=d.Ms.get(u);return f!==void 0?Bn.resolve(d.Fs.get(f)):d.hi.getTargetData(h,u)})(i,o,pd(e)).next((a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.hi.getMatchingKeysForTargetId(o,a.targetId).next((c=>{s=c}))})).next((()=>i.Cs.getDocumentsMatchingQuery(o,e,t?r:nr.min(),t?s:Zr()))).next((a=>(Cie(i,dne(e),a),{documents:a,qs:s})))))}function Cie(n,e,t){let i=n.xs.get(e)||nr.min();t.forEach(((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)})),n.xs.set(e,i)}class UD{constructor(){this.activeTargetIds=yne()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Sie{constructor(){this.Fo=new UD,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,i){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new UD,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tie{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HD="ConnectivityMonitor";class WD{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){xi(HD,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){xi(HD,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xw=null;function PB(){return Xw===null?Xw=(function(){return 268435456+Math.round(2147483648*Math.random())})():Xw++,"0x"+Xw.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LS="RestConnection",Bie={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Eie{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${i}/databases/${r}`,this.Ko=this.databaseId.database===b_?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Wo(e,t,i,r,s){const o=PB(),a=this.Go(e,t.toUriEncodedString());xi(LS,`Sending RPC '${e}' ${o}:`,a,i);const c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(c,r,s);const{host:h}=new URL(a),u=qf(h);return this.jo(e,a,c,i,u).then((d=>(xi(LS,`Received RPC '${e}' ${o}: `,d),d)),(d=>{throw wA(LS,`RPC '${e}' ${o} failed with error: `,d,"url: ",a,"request:",i),d}))}Jo(e,t,i,r,s,o){return this.Wo(e,t,i,r,s)}zo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Mm})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,s)=>e[s]=r)),i&&i.headers.forEach(((r,s)=>e[s]=r))}Go(e,t){const i=Bie[e];return`${this.$o}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kie{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ul="WebChannelConnection";class Iie extends Eie{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,i,r,s){const o=PB();return new Promise(((a,c)=>{const h=new aH;h.setWithCredentials(!0),h.listenOnce(lH.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case Ob.NO_ERROR:const d=h.getResponseJson();xi(Ul,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(d)),a(d);break;case Ob.TIMEOUT:xi(Ul,`RPC '${e}' ${o} timed out`),c(new ri(yn.DEADLINE_EXCEEDED,"Request time out"));break;case Ob.HTTP_ERROR:const f=h.getStatus();if(xi(Ul,`RPC '${e}' ${o} failed with status:`,f,"response text:",h.getResponseText()),f>0){let A=h.getResponseJson();Array.isArray(A)&&(A=A[0]);const g=A==null?void 0:A.error;if(g&&g.status&&g.message){const p=(function(v){const m=v.toLowerCase().replace(/_/g,"-");return Object.values(yn).indexOf(m)>=0?m:yn.UNKNOWN})(g.status);c(new ri(p,g.message))}else c(new ri(yn.UNKNOWN,"Server responded with status "+h.getStatus()))}else c(new ri(yn.UNAVAILABLE,"Connection failed."));break;default:Ki(9055,{c_:e,streamId:o,l_:h.getLastErrorCode(),h_:h.getLastError()})}}finally{xi(Ul,`RPC '${e}' ${o} completed.`)}}));const u=JSON.stringify(r);xi(Ul,`RPC '${e}' ${o} sending request:`,r),h.send(t,"POST",u,i,15)}))}P_(e,t,i){const r=PB(),s=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=uH(),a=hH(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(c.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(c.useFetchStreams=!0),this.zo(c.initMessageHeaders,t,i),c.encodeInitMessageHeaders=!0;const u=s.join("");xi(Ul,`Creating RPC '${e}' stream ${r}: ${u}`,c);const d=o.createWebChannel(u,c);this.T_(d);let f=!1,A=!1;const g=new kie({Ho:y=>{A?xi(Ul,`Not sending because RPC '${e}' stream ${r} is closed:`,y):(f||(xi(Ul,`Opening RPC '${e}' stream ${r} transport.`),d.open(),f=!0),xi(Ul,`RPC '${e}' stream ${r} sending:`,y),d.send(y))},Yo:()=>d.close()}),p=(y,v,m)=>{y.listen(v,(w=>{try{m(w)}catch(x){setTimeout((()=>{throw x}),0)}}))};return p(d,W2.EventType.OPEN,(()=>{A||(xi(Ul,`RPC '${e}' stream ${r} transport opened.`),g.s_())})),p(d,W2.EventType.CLOSE,(()=>{A||(A=!0,xi(Ul,`RPC '${e}' stream ${r} transport closed`),g.__(),this.I_(d))})),p(d,W2.EventType.ERROR,(y=>{A||(A=!0,wA(Ul,`RPC '${e}' stream ${r} transport errored. Name:`,y.name,"Message:",y.message),g.__(new ri(yn.UNAVAILABLE,"The operation could not be completed")))})),p(d,W2.EventType.MESSAGE,(y=>{var v;if(!A){const m=y.data[0];ls(!!m,16349);const w=m,x=(w==null?void 0:w.error)||((v=w[0])===null||v===void 0?void 0:v.error);if(x){xi(Ul,`RPC '${e}' stream ${r} received error:`,x);const T=x.status;let j=(function(_){const I=ya[_];if(I!==void 0)return qH(I)})(T),D=x.message;j===void 0&&(j=yn.INTERNAL,D="Unknown error status: "+T+" with message "+x.message),A=!0,g.__(new ri(j,D)),d.close()}else xi(Ul,`RPC '${e}' stream ${r} received:`,m),g.a_(m)}})),p(a,cH.STAT_EVENT,(y=>{y.stat===bB.PROXY?xi(Ul,`RPC '${e}' stream ${r} detected buffering proxy`):y.stat===bB.NOPROXY&&xi(Ul,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{g.o_()}),0),g}terminate(){this.u_.forEach((e=>e.close())),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter((t=>t===e))}}function MS(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A5(n){return new Pne(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kk{constructor(e,t,i=1e3,r=1.5,s=6e4){this.Fi=e,this.timerId=t,this.d_=i,this.E_=r,this.A_=s,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),i=Math.max(0,Date.now()-this.m_),r=Math.max(0,t-i);r>0&&xi("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,r,(()=>(this.m_=Date.now(),e()))),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QD="PersistentStream";class uW{constructor(e,t,i,r,s,o,a,c){this.Fi=e,this.w_=i,this.S_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new kk(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,(()=>this.L_())))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===yn.RESOURCE_EXHAUSTED?(vA(t.toString()),vA("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===yn.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.b_===t&&this.W_(i,r)}),(i=>{e((()=>{const r=new ri(yn.UNKNOWN,"Fetching auth token failed: "+i.message);return this.G_(r)}))}))}W_(e,t){const i=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.e_((()=>{i((()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,(()=>(this.x_()&&(this.state=3),Promise.resolve()))),this.listener.e_())))})),this.stream.n_((r=>{i((()=>this.G_(r)))})),this.stream.onMessage((r=>{i((()=>++this.C_==1?this.j_(r):this.onNext(r)))}))}O_(){this.state=5,this.F_.g_((async()=>{this.state=0,this.start()}))}G_(e){return xi(QD,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget((()=>this.b_===e?t():(xi(QD,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Fie extends uW{constructor(e,t,i,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=Rne(this.serializer,e),i=(function(s){if(!("targetChange"in s))return nr.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?nr.min():o.readTime?lh(o.readTime):nr.min()})(e);return this.listener.J_(t,i)}H_(e){const t={};t.database=DB(this.serializer),t.addTarget=(function(s,o){let a;const c=o.target;if(a=BB(c)?{documents:Une(s,c)}:{query:Hne(s,c).Vt},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=JH(s,o.resumeToken);const h=IB(s,o.expectedCount);h!==null&&(a.expectedCount=h)}else if(o.snapshotVersion.compareTo(nr.min())>0){a.readTime=T_(s,o.snapshotVersion.toTimestamp());const h=IB(s,o.expectedCount);h!==null&&(a.expectedCount=h)}return a})(this.serializer,e);const i=Qne(this.serializer,e);i&&(t.labels=i),this.k_(t)}Y_(e){const t={};t.database=DB(this.serializer),t.removeTarget=e,this.k_(t)}}class Die extends uW{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return ls(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ls(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){ls(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=One(e.writeResults,e.commitTime),i=lh(e.commitTime);return this.listener.ta(i,t)}na(){const e={};e.database=DB(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>iW(this.serializer,i)))};this.k_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jie{}class Pie extends jie{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ra=!1}ia(){if(this.ra)throw new ri(yn.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,r){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Wo(e,FB(t,i),r,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===yn.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ri(yn.UNKNOWN,s.toString())}))}Jo(e,t,i,r,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,a])=>this.connection.Jo(e,FB(t,i),r,o,a,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===yn.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ri(yn.UNKNOWN,o.toString())}))}terminate(){this.ra=!0,this.connection.terminate()}}class Nie{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve()))))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(vA(t),this._a=!1):xi("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hg="RemoteStore";class Lie{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=s,this.Ea.xo((o=>{i.enqueueAndForget((async()=>{Tg(this)&&(xi(hg,"Restarting streams for network reachability change."),await(async function(c){const h=gr(c);h.Ia.add(4),await Hv(h),h.Aa.set("Unknown"),h.Ia.delete(4),await f5(h)})(this))}))})),this.Aa=new Nie(i,r)}}async function f5(n){if(Tg(n))for(const e of n.da)await e(!0)}async function Hv(n){for(const e of n.da)await e(!1)}function dW(n,e){const t=gr(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),jk(t)?Dk(t):Um(t).x_()&&Fk(t,e))}function Ik(n,e){const t=gr(n),i=Um(t);t.Ta.delete(e),i.x_()&&AW(t,e),t.Ta.size===0&&(i.x_()?i.B_():Tg(t)&&t.Aa.set("Unknown"))}function Fk(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(nr.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Um(n).H_(e)}function AW(n,e){n.Ra.$e(e),Um(n).Y_(e)}function Dk(n){n.Ra=new Ine({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),Um(n).start(),n.Aa.aa()}function jk(n){return Tg(n)&&!Um(n).M_()&&n.Ta.size>0}function Tg(n){return gr(n).Ia.size===0}function fW(n){n.Ra=void 0}async function Mie(n){n.Aa.set("Online")}async function Rie(n){n.Ta.forEach(((e,t)=>{Fk(n,e)}))}async function Oie(n,e){fW(n),jk(n)?(n.Aa.la(e),Dk(n)):n.Aa.set("Unknown")}async function Uie(n,e,t){if(n.Aa.set("Online"),e instanceof ZH&&e.state===2&&e.cause)try{await(async function(r,s){const o=s.cause;for(const a of s.targetIds)r.Ta.has(a)&&(await r.remoteSyncer.rejectListen(a,o),r.Ta.delete(a),r.Ra.removeTarget(a))})(n,e)}catch(i){xi(hg,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await k_(n,i)}else if(e instanceof Qb?n.Ra.Ye(e):e instanceof YH?n.Ra.it(e):n.Ra.et(e),!t.isEqual(nr.min()))try{const i=await hW(n.localStore);t.compareTo(i)>=0&&await(function(s,o){const a=s.Ra.Pt(o);return a.targetChanges.forEach(((c,h)=>{if(c.resumeToken.approximateByteSize()>0){const u=s.Ta.get(h);u&&s.Ta.set(h,u.withResumeToken(c.resumeToken,o))}})),a.targetMismatches.forEach(((c,h)=>{const u=s.Ta.get(c);if(!u)return;s.Ta.set(c,u.withResumeToken(ul.EMPTY_BYTE_STRING,u.snapshotVersion)),AW(s,c);const d=new vf(u.target,c,h,u.sequenceNumber);Fk(s,d)})),s.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(i){xi(hg,"Failed to raise snapshot:",i),await k_(n,i)}}async function k_(n,e,t){if(!Om(e))throw e;n.Ia.add(1),await Hv(n),n.Aa.set("Offline"),t||(t=()=>hW(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{xi(hg,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await f5(n)}))}function pW(n,e){return e().catch((t=>k_(n,t,e)))}async function p5(n){const e=gr(n),t=Uf(e);let i=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:gk;for(;Hie(e);)try{const r=await bie(e.localStore,i);if(r===null){e.Pa.length===0&&t.B_();break}i=r.batchId,Wie(e,r)}catch(r){await k_(e,r)}gW(e)&&mW(e)}function Hie(n){return Tg(n)&&n.Pa.length<10}function Wie(n,e){n.Pa.push(e);const t=Uf(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function gW(n){return Tg(n)&&!Uf(n).M_()&&n.Pa.length>0}function mW(n){Uf(n).start()}async function Qie(n){Uf(n).na()}async function $ie(n){const e=Uf(n);for(const t of n.Pa)e.X_(t.mutations)}async function Vie(n,e,t){const i=n.Pa.shift(),r=bk.from(i,e,t);await pW(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await p5(n)}async function zie(n,e){e&&Uf(n).Z_&&await(async function(i,r){if((function(o){return KH(o)&&o!==yn.ABORTED})(r.code)){const s=i.Pa.shift();Uf(i).N_(),await pW(i,(()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r))),await p5(i)}})(n,e),gW(n)&&mW(n)}async function $D(n,e){const t=gr(n);t.asyncQueue.verifyOperationInProgress(),xi(hg,"RemoteStore received new credentials");const i=Tg(t);t.Ia.add(3),await Hv(t),i&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await f5(t)}async function Gie(n,e){const t=gr(n);e?(t.Ia.delete(2),await f5(t)):e||(t.Ia.add(2),await Hv(t),t.Aa.set("Unknown"))}function Um(n){return n.Va||(n.Va=(function(t,i,r){const s=gr(t);return s.ia(),new Fie(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Zo:Mie.bind(null,n),e_:Rie.bind(null,n),n_:Oie.bind(null,n),J_:Uie.bind(null,n)}),n.da.push((async e=>{e?(n.Va.N_(),jk(n)?Dk(n):n.Aa.set("Unknown")):(await n.Va.stop(),fW(n))}))),n.Va}function Uf(n){return n.ma||(n.ma=(function(t,i,r){const s=gr(t);return s.ia(),new Die(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:Qie.bind(null,n),n_:zie.bind(null,n),ea:$ie.bind(null,n),ta:Vie.bind(null,n)}),n.da.push((async e=>{e?(n.ma.N_(),await p5(n)):(await n.ma.stop(),n.Pa.length>0&&(xi(hg,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pk{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new fd,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,a=new Pk(e,t,o,r,s);return a.start(i),a}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ri(yn.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Nk(n,e){if(vA("AsyncQueue",`${e}: ${n}`),Om(n))return new ri(yn.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tm{static emptySet(e){return new tm(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||$i.comparator(t.key,i.key):(t,i)=>$i.comparator(t.key,i.key),this.keyedMap=Q2(),this.sortedSet=new Lo(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof tm)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new tm;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VD{constructor(){this.fa=new Lo($i.comparator)}track(e){const t=e.doc.key,i=this.fa.get(t);i?e.type!==0&&i.type===3?this.fa=this.fa.insert(t,e):e.type===3&&i.type!==1?this.fa=this.fa.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.fa=this.fa.remove(t):e.type===1&&i.type===2?this.fa=this.fa.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):Ki(63341,{At:e,ga:i}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal(((t,i)=>{e.push(i)})),e}}class _m{constructor(e,t,i,r,s,o,a,c,h){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=h}static fromInitialDocuments(e,t,i,r,s){const o=[];return t.forEach((a=>{o.push({type:0,doc:a})})),new _m(e,t,tm.emptySet(t),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&a5(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xie{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some((e=>e.ba()))}}class Kie{constructor(){this.queries=zD(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,i){const r=gr(t),s=r.queries;r.queries=zD(),s.forEach(((o,a)=>{for(const c of a.wa)c.onError(i)}))})(this,new ri(yn.ABORTED,"Firestore shutting down"))}}function zD(){return new Sg((n=>NH(n)),a5)}async function Lk(n,e){const t=gr(n);let i=3;const r=e.query;let s=t.queries.get(r);s?!s.Sa()&&e.ba()&&(i=2):(s=new Xie,i=e.ba()?0:1);try{switch(i){case 0:s.ya=await t.onListen(r,!0);break;case 1:s.ya=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(o){const a=Nk(o,`Initialization of query '${C0(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,s),s.wa.push(e),e.va(t.onlineState),s.ya&&e.Ca(s.ya)&&Rk(t)}async function Mk(n,e){const t=gr(n),i=e.query;let r=3;const s=t.queries.get(i);if(s){const o=s.wa.indexOf(e);o>=0&&(s.wa.splice(o,1),s.wa.length===0?r=e.ba()?0:1:!s.Sa()&&e.ba()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function qie(n,e){const t=gr(n);let i=!1;for(const r of e){const s=r.query,o=t.queries.get(s);if(o){for(const a of o.wa)a.Ca(r)&&(i=!0);o.ya=r}}i&&Rk(t)}function Yie(n,e,t){const i=gr(n),r=i.queries.get(e);if(r)for(const s of r.wa)s.onError(t);i.queries.delete(e)}function Rk(n){n.Da.forEach((e=>{e.next()}))}var NB,GD;(GD=NB||(NB={})).Fa="default",GD.Cache="cache";class Ok{constructor(e,t,i){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=i||{}}Ca(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)r.type!==3&&i.push(r);e=new _m(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const i=t!=="Offline";return(!this.options.ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=_m.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==NB.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yW{constructor(e){this.key=e}}class vW{constructor(e){this.key=e}}class Zie{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=Zr(),this.mutatedKeys=Zr(),this.Xa=LH(e),this.eu=new tm(this.Xa)}get tu(){return this.Ha}nu(e,t){const i=t?t.ru:new VD,r=t?t.eu:this.eu;let s=t?t.mutatedKeys:this.mutatedKeys,o=r,a=!1;const c=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,h=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((u,d)=>{const f=r.get(u),A=l5(this.query,d)?d:null,g=!!f&&this.mutatedKeys.has(f.key),p=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let y=!1;f&&A?f.data.isEqual(A.data)?g!==p&&(i.track({type:3,doc:A}),y=!0):this.iu(f,A)||(i.track({type:2,doc:A}),y=!0,(c&&this.Xa(A,c)>0||h&&this.Xa(A,h)<0)&&(a=!0)):!f&&A?(i.track({type:0,doc:A}),y=!0):f&&!A&&(i.track({type:1,doc:f}),y=!0,(c||h)&&(a=!0)),y&&(A?(o=o.add(A),s=p?s.add(u):s.delete(u)):(o=o.delete(u),s=s.delete(u)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),i.track({type:1,doc:u})}return{eu:o,ru:i,Ds:a,mutatedKeys:s}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){const s=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const o=e.ru.pa();o.sort(((u,d)=>(function(A,g){const p=y=>{switch(y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ki(20277,{At:y})}};return p(A)-p(g)})(u.type,d.type)||this.Xa(u.doc,d.doc))),this.su(i),r=r!=null&&r;const a=t&&!r?this.ou():[],c=this.Za.size===0&&this.current&&!r?1:0,h=c!==this.Ya;return this.Ya=c,o.length!==0||h?{snapshot:new _m(this.query,e.eu,s,o,e.mutatedKeys,c===0,h,!1,!!i&&i.resumeToken.approximateByteSize()>0),_u:a}:{_u:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new VD,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach((t=>this.Ha=this.Ha.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ha=this.Ha.delete(t))),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=Zr(),this.eu.forEach((i=>{this.au(i.key)&&(this.Za=this.Za.add(i.key))}));const t=[];return e.forEach((i=>{this.Za.has(i)||t.push(new vW(i))})),this.Za.forEach((i=>{e.has(i)||t.push(new yW(i))})),t}uu(e){this.Ha=e.qs,this.Za=Zr();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return _m.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Uk="SyncEngine";class Jie{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class ere{constructor(e){this.key=e,this.lu=!1}}class tre{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.hu={},this.Pu=new Sg((a=>NH(a)),a5),this.Tu=new Map,this.Iu=new Set,this.du=new Lo($i.comparator),this.Eu=new Map,this.Au=new Sk,this.Ru={},this.Vu=new Map,this.mu=bm.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function nre(n,e,t=!0){const i=SW(n);let r;const s=i.Pu.get(e);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.cu()):r=await wW(i,e,t,!0),r}async function ire(n,e){const t=SW(n);await wW(t,e,!0,!1)}async function wW(n,e,t,i){const r=await _ie(n.localStore,pd(e)),s=r.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t);let a;return i&&(a=await rre(n,e,s,o==="current",r.resumeToken)),n.isPrimaryClient&&t&&dW(n.remoteStore,r),a}async function rre(n,e,t,i,r){n.gu=(d,f,A)=>(async function(p,y,v,m){let w=y.view.nu(v);w.Ds&&(w=await OD(p.localStore,y.query,!1).then((({documents:D})=>y.view.nu(D,w))));const x=m&&m.targetChanges.get(y.targetId),T=m&&m.targetMismatches.get(y.targetId)!=null,j=y.view.applyChanges(w,p.isPrimaryClient,x,T);return KD(p,y.targetId,j._u),j.snapshot})(n,d,f,A);const s=await OD(n.localStore,e,!0),o=new Zie(e,s.qs),a=o.nu(s.documents),c=Uv.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),h=o.applyChanges(a,n.isPrimaryClient,c);KD(n,t,h._u);const u=new Jie(e,t,o);return n.Pu.set(e,u),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),h.snapshot}async function sre(n,e,t){const i=gr(n),r=i.Pu.get(e),s=i.Tu.get(r.targetId);if(s.length>1)return i.Tu.set(r.targetId,s.filter((o=>!a5(o,e)))),void i.Pu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await jB(i.localStore,r.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(r.targetId),t&&Ik(i.remoteStore,r.targetId),LB(i,r.targetId)})).catch(Rm)):(LB(i,r.targetId),await jB(i.localStore,r.targetId,!0))}async function ore(n,e){const t=gr(n),i=t.Pu.get(e),r=t.Tu.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Ik(t.remoteStore,i.targetId))}async function are(n,e,t){const i=fre(n);try{const r=await(function(o,a){const c=gr(o),h=Ps.now(),u=a.reduce(((A,g)=>A.add(g.key)),Zr());let d,f;return c.persistence.runTransaction("Locally write mutations","readwrite",(A=>{let g=xA(),p=Zr();return c.Os.getEntries(A,u).next((y=>{g=y,g.forEach(((v,m)=>{m.isValidDocument()||(p=p.add(v))}))})).next((()=>c.localDocuments.getOverlayedDocuments(A,g))).next((y=>{d=y;const v=[];for(const m of a){const w=Sne(m,d.get(m.key).overlayedDocument);w!=null&&v.push(new Jf(m.key,w,BH(w.value.mapValue),kl.exists(!0)))}return c.mutationQueue.addMutationBatch(A,h,v,a)})).next((y=>{f=y;const v=y.applyToLocalDocumentSet(d,p);return c.documentOverlayCache.saveOverlays(A,y.batchId,v)}))})).then((()=>({batchId:f.batchId,changes:RH(d)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),(function(o,a,c){let h=o.Ru[o.currentUser.toKey()];h||(h=new Lo(Or)),h=h.insert(a,c),o.Ru[o.currentUser.toKey()]=h})(i,r.batchId,t),await Wv(i,r.changes),await p5(i.remoteStore)}catch(r){const s=Nk(r,"Failed to persist write");t.reject(s)}}async function xW(n,e){const t=gr(n);try{const i=await wie(t.localStore,e);e.targetChanges.forEach(((r,s)=>{const o=t.Eu.get(s);o&&(ls(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.lu=!0:r.modifiedDocuments.size>0?ls(o.lu,14607):r.removedDocuments.size>0&&(ls(o.lu,42227),o.lu=!1))})),await Wv(t,i,e)}catch(i){await Rm(i)}}function XD(n,e,t){const i=gr(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Pu.forEach(((s,o)=>{const a=o.view.va(e);a.snapshot&&r.push(a.snapshot)})),(function(o,a){const c=gr(o);c.onlineState=a;let h=!1;c.queries.forEach(((u,d)=>{for(const f of d.wa)f.va(a)&&(h=!0)})),h&&Rk(c)})(i.eventManager,e),r.length&&i.hu.J_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function lre(n,e,t){const i=gr(n);i.sharedClientState.updateQueryState(e,"rejected",t);const r=i.Eu.get(e),s=r&&r.key;if(s){let o=new Lo($i.comparator);o=o.insert(s,al.newNoDocument(s,nr.min()));const a=Zr().add(s),c=new d5(nr.min(),new Map,new Lo(Or),o,a);await xW(i,c),i.du=i.du.remove(s),i.Eu.delete(e),Hk(i)}else await jB(i.localStore,e,!1).then((()=>LB(i,e,t))).catch(Rm)}async function cre(n,e){const t=gr(n),i=e.batch.batchId;try{const r=await vie(t.localStore,e);_W(t,i,null),bW(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Wv(t,r)}catch(r){await Rm(r)}}async function hre(n,e,t){const i=gr(n);try{const r=await(function(o,a){const c=gr(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let u;return c.mutationQueue.lookupMutationBatch(h,a).next((d=>(ls(d!==null,37113),u=d.keys(),c.mutationQueue.removeMutationBatch(h,d)))).next((()=>c.mutationQueue.performConsistencyCheck(h))).next((()=>c.documentOverlayCache.removeOverlaysForBatchId(h,u,a))).next((()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,u))).next((()=>c.localDocuments.getDocuments(h,u)))}))})(i.localStore,e);_W(i,e,t),bW(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Wv(i,r)}catch(r){await Rm(r)}}function bW(n,e){(n.Vu.get(e)||[]).forEach((t=>{t.resolve()})),n.Vu.delete(e)}function _W(n,e,t){const i=gr(n);let r=i.Ru[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Ru[i.currentUser.toKey()]=r}}function LB(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Tu.get(e))n.Pu.delete(i),t&&n.hu.pu(i,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach((i=>{n.Au.containsKey(i)||CW(n,i)}))}function CW(n,e){n.Iu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Ik(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),Hk(n))}function KD(n,e,t){for(const i of t)i instanceof yW?(n.Au.addReference(i.key,e),ure(n,i)):i instanceof vW?(xi(Uk,"Document no longer in limbo: "+i.key),n.Au.removeReference(i.key,e),n.Au.containsKey(i.key)||CW(n,i.key)):Ki(19791,{yu:i})}function ure(n,e){const t=e.key,i=t.path.canonicalString();n.du.get(t)||n.Iu.has(i)||(xi(Uk,"New document in limbo: "+t),n.Iu.add(i),Hk(n))}function Hk(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Iu.values().next().value;n.Iu.delete(e);const t=new $i(js.fromString(e)),i=n.mu.next();n.Eu.set(i,new ere(t)),n.du=n.du.insert(t,i),dW(n.remoteStore,new vf(pd(o5(t.path)),i,"TargetPurposeLimboResolution",r5.ue))}}async function Wv(n,e,t){const i=gr(n),r=[],s=[],o=[];i.Pu.isEmpty()||(i.Pu.forEach(((a,c)=>{o.push(i.gu(c,e,t).then((h=>{var u;if((h||t)&&i.isPrimaryClient){const d=h?!h.fromCache:(u=t==null?void 0:t.targetChanges.get(c.targetId))===null||u===void 0?void 0:u.current;i.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(h){r.push(h);const d=Bk.Es(c.targetId,h);s.push(d)}})))})),await Promise.all(o),i.hu.J_(r),await(async function(c,h){const u=gr(c);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",(d=>Bn.forEach(h,(f=>Bn.forEach(f.Is,(A=>u.persistence.referenceDelegate.addReference(d,f.targetId,A))).next((()=>Bn.forEach(f.ds,(A=>u.persistence.referenceDelegate.removeReference(d,f.targetId,A)))))))))}catch(d){if(!Om(d))throw d;xi(Ek,"Failed to update sequence numbers: "+d)}for(const d of h){const f=d.targetId;if(!d.fromCache){const A=u.Fs.get(f),g=A.snapshotVersion,p=A.withLastLimboFreeSnapshotVersion(g);u.Fs=u.Fs.insert(f,p)}}})(i.localStore,s))}async function dre(n,e){const t=gr(n);if(!t.currentUser.isEqual(e)){xi(Uk,"User change. New user:",e.toKey());const i=await cW(t.localStore,e);t.currentUser=e,(function(s,o){s.Vu.forEach((a=>{a.forEach((c=>{c.reject(new ri(yn.CANCELLED,o))}))})),s.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Wv(t,i.Bs)}}function Are(n,e){const t=gr(n),i=t.Eu.get(e);if(i&&i.lu)return Zr().add(i.key);{let r=Zr();const s=t.Tu.get(e);if(!s)return r;for(const o of s){const a=t.Pu.get(o);r=r.unionWith(a.view.tu)}return r}}function SW(n){const e=gr(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=xW.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Are.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=lre.bind(null,e),e.hu.J_=qie.bind(null,e.eventManager),e.hu.pu=Yie.bind(null,e.eventManager),e}function fre(n){const e=gr(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=cre.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=hre.bind(null,e),e}class I_{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=A5(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return yie(this.persistence,new pie,e.initialUser,this.serializer)}Du(e){return new lW(Tk.Vi,this.serializer)}bu(e){return new Sie}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}I_.provider={build:()=>new I_};class pre extends I_{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){ls(this.persistence.referenceDelegate instanceof E_,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new eie(i,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?Nc.withCacheSize(this.cacheSizeBytes):Nc.DEFAULT;return new lW((i=>E_.Vi(i,t)),this.serializer)}}class MB{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>XD(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=dre.bind(null,this.syncEngine),await Gie(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Kie})()}createDatastore(e){const t=A5(e.databaseInfo.databaseId),i=(function(s){return new Iie(s)})(e.databaseInfo);return(function(s,o,a,c){return new Pie(s,o,a,c)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,s,o,a){return new Lie(i,r,s,o,a)})(this.localStore,this.datastore,e.asyncQueue,(t=>XD(this.syncEngine,t,0)),(function(){return WD.C()?new WD:new Tie})())}createSyncEngine(e,t){return(function(r,s,o,a,c,h,u){const d=new tre(r,s,o,a,c,h);return u&&(d.fu=!0),d})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(r){const s=gr(r);xi(hg,"RemoteStore shutting down."),s.Ia.add(5),await Hv(s),s.Ea.shutdown(),s.Aa.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}MB.provider={build:()=>new MB};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wk{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):vA("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gre{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ri(yn.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(r,s){const o=gr(r),a={documents:s.map((d=>B_(o.serializer,d)))},c=await o.Jo("BatchGetDocuments",o.serializer.databaseId,js.emptyPath(),a,s.length),h=new Map;c.forEach((d=>{const f=Mne(o.serializer,d);h.set(f.key.toString(),f)}));const u=[];return s.forEach((d=>{const f=h.get(d.toString());ls(!!f,55234,{key:d}),u.push(f)})),u})(this.datastore,e);return t.forEach((i=>this.recordVersion(i))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new u5(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,i)=>{const r=$i.fromPath(i);this.mutations.push(new XH(r,this.precondition(r)))})),await(async function(i,r){const s=gr(i),o={writes:r.map((a=>iW(s.serializer,a)))};await s.Wo("Commit",s.serializer.databaseId,js.emptyPath(),o)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Ki(50498,{Wu:e.constructor.name});t=nr.min()}const i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new ri(yn.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(nr.min())?kl.exists(!1):kl.updateTime(t):kl.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(nr.min()))throw new ri(yn.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return kl.updateTime(t)}return kl.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mre{constructor(e,t,i,r,s){this.asyncQueue=e,this.datastore=t,this.options=i,this.updateFunction=r,this.deferred=s,this.Gu=i.maxAttempts,this.F_=new kk(this.asyncQueue,"transaction_retry")}zu(){this.Gu-=1,this.ju()}ju(){this.F_.g_((async()=>{const e=new gre(this.datastore),t=this.Ju(e);t&&t.then((i=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(i)})).catch((r=>{this.Hu(r)}))))})).catch((i=>{this.Hu(i)}))}))}Ju(e){try{const t=this.updateFunction(e);return!Rv(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Hu(e){this.Gu>0&&this.Yu(e)?(this.Gu-=1,this.asyncQueue.enqueueAndForget((()=>(this.ju(),Promise.resolve())))):this.deferred.reject(e)}Yu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!KH(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hf="FirestoreClient";class yre{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=Gl.UNAUTHENTICATED,this.clientId=n5.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,(async o=>{xi(Hf,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,(o=>(xi(Hf,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new fd;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Nk(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function RS(n,e){n.asyncQueue.verifyOperationInProgress(),xi(Hf,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async r=>{i.isEqual(r)||(await cW(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener((()=>{wA("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then((()=>{xi("Terminating Firestore due to IndexedDb database deletion completed successfully")})).catch((r=>{wA("Terminating Firestore due to IndexedDb database deletion failed",r)}))})),n._offlineComponents=e}async function qD(n,e){n.asyncQueue.verifyOperationInProgress();const t=await vre(n);xi(Hf,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>$D(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,r)=>$D(e.remoteStore,r))),n._onlineComponents=e}async function vre(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){xi(Hf,"Using user provided OfflineComponentProvider");try{await RS(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===yn.FAILED_PRECONDITION||r.code===yn.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;wA("Error using user provided cache. Falling back to memory cache: "+t),await RS(n,new I_)}}else xi(Hf,"Using default OfflineComponentProvider"),await RS(n,new pre(void 0));return n._offlineComponents}async function Qk(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(xi(Hf,"Using user provided OnlineComponentProvider"),await qD(n,n._uninitializedComponentsProvider._online)):(xi(Hf,"Using default OnlineComponentProvider"),await qD(n,new MB))),n._onlineComponents}function wre(n){return Qk(n).then((e=>e.syncEngine))}function xre(n){return Qk(n).then((e=>e.datastore))}async function F_(n){const e=await Qk(n),t=e.eventManager;return t.onListen=nre.bind(null,e.syncEngine),t.onUnlisten=sre.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=ire.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=ore.bind(null,e.syncEngine),t}function TW(n,e,t={}){const i=new fd;return n.asyncQueue.enqueueAndForget((async()=>(function(s,o,a,c,h){const u=new Wk({next:f=>{u.Ou(),o.enqueueAndForget((()=>Mk(s,d)));const A=f.docs.has(a);!A&&f.fromCache?h.reject(new ri(yn.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&f.fromCache&&c&&c.source==="server"?h.reject(new ri(yn.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(f)},error:f=>h.reject(f)}),d=new Ok(o5(a.path),u,{includeMetadataChanges:!0,ka:!0});return Lk(s,d)})(await F_(n),n.asyncQueue,e,t,i))),i.promise}function BW(n,e,t={}){const i=new fd;return n.asyncQueue.enqueueAndForget((async()=>(function(s,o,a,c,h){const u=new Wk({next:f=>{u.Ou(),o.enqueueAndForget((()=>Mk(s,d))),f.fromCache&&c.source==="server"?h.reject(new ri(yn.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(f)},error:f=>h.reject(f)}),d=new Ok(a,u,{includeMetadataChanges:!0,ka:!0});return Lk(s,d)})(await F_(n),n.asyncQueue,e,t,i))),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EW(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YD=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kW="firestore.googleapis.com",ZD=!0;class JD{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new ri(yn.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=kW,this.ssl=ZD}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:ZD;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=aW;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Zne)throw new ri(yn.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}gH("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=EW((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ri(yn.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ri(yn.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ri(yn.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Qv{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new JD({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ri(yn.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ri(yn.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new JD(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new fH;switch(i.type){case"firstParty":return new Nte(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new ri(yn.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=YD.get(t);i&&(xi("ComponentProvider","Removing Datastore"),YD.delete(t),i.terminate())})(this),Promise.resolve()}}function IW(n,e,t,i={}){var r;n=fa(n,Qv);const s=qf(e),o=n._getSettings(),a=Object.assign(Object.assign({},o),{emulatorOptions:n._getEmulatorOptions()}),c=`${e}:${t}`;s&&(Z6(`https://${c}`),J6("Firestore",!0)),o.host!==kW&&o.host!==c&&wA("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h=Object.assign(Object.assign({},o),{host:c,ssl:s,emulatorOptions:i});if(!jf(h,a)&&(n._setSettings(h),i.mockUserToken)){let u,d;if(typeof i.mockUserToken=="string")u=i.mockUserToken,d=Gl.MOCK_USER;else{u=tU(i.mockUserToken,(r=n._app)===null||r===void 0?void 0:r.options.projectId);const f=i.mockUserToken.sub||i.mockUserToken.user_id;if(!f)throw new ri(yn.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Gl(f)}n._authCredentials=new Dte(new AH(u,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Lu(this.firestore,e,this._query)}}class wo{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new uA(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new wo(this.firestore,e,this._key)}toJSON(){return{type:wo._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Mv(t,wo._jsonSchema))return new wo(e,i||null,new $i(js.fromString(t.referencePath)))}}wo._jsonSchemaVersion="firestore/documentReference/1.0",wo._jsonSchema={type:_a("string",wo._jsonSchemaVersion),referencePath:_a("string")};class uA extends Lu{constructor(e,t,i){super(e,t,o5(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new wo(this.firestore,null,new $i(e))}withConverter(e){return new uA(this.firestore,e,this._path)}}function Ua(n,e,...t){if(n=Zs(n),pk("collection","path",e),n instanceof Qv){const i=js.fromString(e,...t);return dD(i),new uA(n,null,i)}{if(!(n instanceof wo||n instanceof uA))throw new ri(yn.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(js.fromString(e,...t));return dD(i),new uA(n.firestore,null,i)}}function FW(n,e){if(n=fa(n,Qv),pk("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new ri(yn.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Lu(n,null,(function(i){return new Cg(js.emptyPath(),i)})(e))}function Tr(n,e,...t){if(n=Zs(n),arguments.length===1&&(e=n5.newId()),pk("doc","path",e),n instanceof Qv){const i=js.fromString(e,...t);return uD(i),new wo(n,null,new $i(i))}{if(!(n instanceof wo||n instanceof uA))throw new ri(yn.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(js.fromString(e,...t));return uD(i),new wo(n.firestore,n instanceof uA?n.converter:null,new $i(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ej="AsyncQueue";class tj{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new kk(this,"async_queue_retry"),this.oc=()=>{const i=MS();i&&xi(ej,"Visibility state changed to "+i.visibilityState),this.F_.y_()},this._c=e;const t=MS();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=MS();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise((()=>{}));const t=new fd;return this.uc((()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Zu.push(e),this.cc())))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Om(e))throw e;xi(ej,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_((()=>this.cc()))}}uc(e){const t=this._c.then((()=>(this.nc=!0,e().catch((i=>{throw this.tc=i,this.nc=!1,vA("INTERNAL UNHANDLED ERROR: ",nj(i)),i})).then((i=>(this.nc=!1,i))))));return this._c=t,t}enqueueAfterDelay(e,t,i){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const r=Pk.createAndSchedule(this,e,t,i,(s=>this.lc(s)));return this.ec.push(r),r}ac(){this.tc&&Ki(47125,{hc:nj(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then((()=>{this.ec.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()}))}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function nj(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ij(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const r=t;for(const s of i)if(s in r&&typeof r[s]=="function")return!0;return!1})(n,["next","error","complete"])}class uh extends Qv{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new tj,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new tj(e),this._firestoreClient=void 0,await e}}}function DW(n,e){const t=typeof n=="object"?n:nk(),i=typeof n=="string"?n:b_,r=XC(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=ZO("firestore");s&&IW(r,...s)}return r}function ep(n){if(n._terminated)throw new ri(yn.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||bre(n),n._firestoreClient}function bre(n){var e,t,i;const r=n._freezeSettings(),s=(function(a,c,h,u){return new qte(a,c,h,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,EW(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,r);n._componentsProvider||!((t=r.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=r.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),n._firestoreClient=new yre(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&(function(a){const c=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(c),_online:c}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mc{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Mc(ul.fromBase64String(e))}catch(t){throw new ri(yn.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Mc(ul.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Mc._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Mv(e,Mc._jsonSchema))return Mc.fromBase64String(e.bytes)}}Mc._jsonSchemaVersion="firestore/bytes/1.0",Mc._jsonSchema={type:_a("string",Mc._jsonSchemaVersion),bytes:_a("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hm{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ri(yn.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ll(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wm{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ri(yn.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ri(yn.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Or(this._lat,e._lat)||Or(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Su._jsonSchemaVersion}}static fromJSON(e){if(Mv(e,Su._jsonSchema))return new Su(e.latitude,e.longitude)}}Su._jsonSchemaVersion="firestore/geoPoint/1.0",Su._jsonSchema={type:_a("string",Su._jsonSchemaVersion),latitude:_a("number"),longitude:_a("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Tu._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Mv(e,Tu._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Tu(e.vectorValues);throw new ri(yn.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Tu._jsonSchemaVersion="firestore/vectorValue/1.0",Tu._jsonSchema={type:_a("string",Tu._jsonSchemaVersion),vectorValues:_a("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _re=/^__.*__$/;class Cre{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Jf(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ov(e,this.data,t,this.fieldTransforms)}}class jW{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Jf(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function PW(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ki(40011,{Ec:n})}}class g5{constructor(e,t,i,r,s,o){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.Ac(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new g5(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.Rc({path:i,mc:!1});return r.fc(e),r}gc(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.Rc({path:i,mc:!1});return r.Ac(),r}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return D_(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(PW(this.Ec)&&_re.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class Sre{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||A5(e)}Dc(e,t,i,r=!1){return new g5({Ec:e,methodName:t,bc:i,path:ll.emptyPath(),mc:!1,Sc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function $v(n){const e=n._freezeSettings(),t=A5(n._databaseId);return new Sre(n._databaseId,!!e.ignoreUndefinedProperties,t)}function $k(n,e,t,i,r,s={}){const o=n.Dc(s.merge||s.mergeFields?2:0,e,t,r);Gk("Data must be an object, but it was:",o,i);const a=MW(i,o);let c,h;if(s.merge)c=new sh(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){const u=[];for(const d of s.mergeFields){const f=RB(e,d,t);if(!o.contains(f))throw new ri(yn.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);OW(u,f)||u.push(f)}c=new sh(u),h=o.fieldTransforms.filter((d=>c.covers(d.field)))}else c=null,h=o.fieldTransforms;return new Cre(new pc(a),c,h)}class m5 extends Wm{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof m5}}function Tre(n,e,t){return new g5({Ec:3,bc:e.settings.bc,methodName:n._methodName,mc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Vk extends Wm{_toFieldTransform(e){return new VH(e.path,new ev)}isEqual(e){return e instanceof Vk}}class zk extends Wm{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=Tre(this,e,!0),i=this.vc.map((s=>Qm(s,t))),r=new xm(i);return new VH(e.path,r)}isEqual(e){return e instanceof zk&&jf(this.vc,e.vc)}}function NW(n,e,t,i){const r=n.Dc(1,e,t);Gk("Data must be an object, but it was:",r,i);const s=[],o=pc.empty();Zf(i,((c,h)=>{const u=Xk(e,c,t);h=Zs(h);const d=r.gc(u);if(h instanceof m5)s.push(u);else{const f=Qm(h,d);f!=null&&(s.push(u),o.set(u,f))}}));const a=new sh(s);return new jW(o,a,r.fieldTransforms)}function LW(n,e,t,i,r,s){const o=n.Dc(1,e,t),a=[RB(e,i,t)],c=[r];if(s.length%2!=0)throw new ri(yn.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<s.length;f+=2)a.push(RB(e,s[f])),c.push(s[f+1]);const h=[],u=pc.empty();for(let f=a.length-1;f>=0;--f)if(!OW(h,a[f])){const A=a[f];let g=c[f];g=Zs(g);const p=o.gc(A);if(g instanceof m5)h.push(A);else{const y=Qm(g,p);y!=null&&(h.push(A),u.set(A,y))}}const d=new sh(h);return new jW(u,d,o.fieldTransforms)}function Bre(n,e,t,i=!1){return Qm(t,n.Dc(i?4:3,e))}function Qm(n,e){if(RW(n=Zs(n)))return Gk("Unsupported field value:",e,n),MW(n,e);if(n instanceof Wm)return(function(i,r){if(!PW(r.Ec))throw r.wc(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.wc(`${i._methodName}() is not currently supported inside arrays`);const s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(i,r){const s=[];let o=0;for(const a of i){let c=Qm(a,r.yc(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}})(n,e)}return(function(i,r){if((i=Zs(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return vne(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const s=Ps.fromDate(i);return{timestampValue:T_(r.serializer,s)}}if(i instanceof Ps){const s=new Ps(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:T_(r.serializer,s)}}if(i instanceof Su)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Mc)return{bytesValue:JH(r.serializer,i._byteString)};if(i instanceof wo){const s=r.databaseId,o=i.firestore._databaseId;if(!o.isEqual(s))throw r.wc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Ck(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof Tu)return(function(o,a){return{mapValue:{fields:{[SH]:{stringValue:TH},[__]:{arrayValue:{values:o.toArray().map((h=>{if(typeof h!="number")throw a.wc("VectorValues must only contain numeric values.");return xk(a.serializer,h)}))}}}}}})(i,r);throw r.wc(`Unsupported field value: ${i5(i)}`)})(n,e)}function MW(n,e){const t={};return vH(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Zf(n,((i,r)=>{const s=Qm(r,e.Vc(i));s!=null&&(t[i]=s)})),{mapValue:{fields:t}}}function RW(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ps||n instanceof Su||n instanceof Mc||n instanceof wo||n instanceof Wm||n instanceof Tu)}function Gk(n,e,t){if(!RW(t)||!mH(t)){const i=i5(t);throw i==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+i)}}function RB(n,e,t){if((e=Zs(e))instanceof Hm)return e._internalPath;if(typeof e=="string")return Xk(n,e);throw D_("Field path arguments must be of type string or ",n,!1,void 0,t)}const Ere=new RegExp("[~\\*/\\[\\]]");function Xk(n,e,t){if(e.search(Ere)>=0)throw D_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Hm(...e.split("."))._internalPath}catch{throw D_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function D_(n,e,t,i,r){const s=i&&!i.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new ri(yn.INVALID_ARGUMENT,a+n+c)}function OW(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j_{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new wo(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new kre(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(y5("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class kre extends j_{data(){return super.data()}}function y5(n,e){return typeof e=="string"?Xk(n,e):e instanceof Hm?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UW(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ri(yn.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Kk{}class qk extends Kk{}function ph(n,e,...t){let i=[];e instanceof Kk&&i.push(e),i=i.concat(t),(function(s){const o=s.filter((c=>c instanceof v5)).length,a=s.filter((c=>c instanceof Vv)).length;if(o>1||o>0&&a>0)throw new ri(yn.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const r of i)n=r._apply(n);return n}class Vv extends qk{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Vv(e,t,i)}_apply(e){const t=this._parse(e);return HW(e._query,t),new Lu(e.firestore,e.converter,EB(e._query,t))}_parse(e){const t=$v(e.firestore);return(function(s,o,a,c,h,u,d){let f;if(h.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new ri(yn.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){sj(d,u);const g=[];for(const p of d)g.push(rj(c,s,p));f={arrayValue:{values:g}}}else f=rj(c,s,d)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||sj(d,u),f=Bre(a,o,d,u==="in"||u==="not-in");return ba.create(h,u,f)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Ca(n,e,t){const i=e,r=y5("where",n);return Vv._create(r,i,t)}class v5 extends Kk{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new v5(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:Eu.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(r,s){let o=r;const a=s.getFlattenedFilters();for(const c of a)HW(o,c),o=EB(o,c)})(e._query,t),new Lu(e.firestore,e.converter,EB(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class w5 extends qk{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new w5(e,t)}_apply(e){const t=(function(r,s,o){if(r.startAt!==null)throw new ri(yn.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new ri(yn.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Jy(s,o)})(e._query,this._field,this._direction);return new Lu(e.firestore,e.converter,(function(r,s){const o=r.explicitOrderBy.concat([s]);return new Cg(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)})(e._query,t))}}function Bg(n,e="asc"){const t=e,i=y5("orderBy",n);return w5._create(i,t)}function rj(n,e,t){if(typeof(t=Zs(t))=="string"){if(t==="")throw new ri(yn.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!PH(e)&&t.indexOf("/")!==-1)throw new ri(yn.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(js.fromString(t));if(!$i.isDocumentKey(i))throw new ri(yn.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return wD(n,new $i(i))}if(t instanceof wo)return wD(n,t._key);throw new ri(yn.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${i5(t)}.`)}function sj(n,e){if(!Array.isArray(n)||n.length===0)throw new ri(yn.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function HW(n,e){const t=(function(r,s){for(const o of r)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ri(yn.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ri(yn.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Yk{convertValue(e,t="none"){switch(Of(e)){case 0:return null;case 1:return e.booleanValue;case 2:return aa(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Rf(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ki(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Zf(e,((r,s)=>{i[r]=this.convertValue(s,t)})),i}convertVectorValue(e){var t,i,r;const s=(r=(i=(t=e.fields)===null||t===void 0?void 0:t[__].arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.map((o=>aa(o.doubleValue)));return new Tu(s)}convertGeoPoint(e){return new Su(aa(e.latitude),aa(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=s5(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Yy(e));default:return null}}convertTimestamp(e){const t=Mf(e);return new Ps(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=js.fromString(e);ls(oW(i),9688,{name:e});const r=new ym(i.get(1),i.get(3)),s=new $i(i.popFirst(5));return r.isEqual(t)||vA(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zk(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class Ire extends Yk{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mc(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new wo(this.firestore,null,t)}}class Hp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class dA extends j_{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new my(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(y5("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ri(yn.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=dA._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}dA._jsonSchemaVersion="firestore/documentSnapshot/1.0",dA._jsonSchema={type:_a("string",dA._jsonSchemaVersion),bundleSource:_a("string","DocumentSnapshot"),bundleName:_a("string"),bundle:_a("string")};class my extends dA{data(e={}){return super.data(e)}}class AA{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Hp(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new my(this._firestore,this._userDataWriter,i.key,i,new Hp(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ri(yn.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map((a=>{const c=new my(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Hp(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((a=>s||a.type!==3)).map((a=>{const c=new my(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Hp(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,u=-1;return a.type!==0&&(h=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:Fre(a.type),doc:c,oldIndex:h,newIndex:u}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ri(yn.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=AA._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=n5.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Fre(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ki(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kh(n){n=fa(n,wo);const e=fa(n.firestore,uh);return TW(ep(e),n._key).then((t=>eI(e,n,t)))}AA._jsonSchemaVersion="firestore/querySnapshot/1.0",AA._jsonSchema={type:_a("string",AA._jsonSchemaVersion),bundleSource:_a("string","QuerySnapshot"),bundleName:_a("string"),bundle:_a("string")};class zv extends Yk{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mc(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new wo(this.firestore,null,t)}}function Fl(n){n=fa(n,wo);const e=fa(n.firestore,uh);return TW(ep(e),n._key,{source:"server"}).then((t=>eI(e,n,t)))}function Mu(n){n=fa(n,Lu);const e=fa(n.firestore,uh),t=ep(e),i=new zv(e);return UW(n._query),BW(t,n._query).then((r=>new AA(e,i,n,r)))}function WW(n){n=fa(n,Lu);const e=fa(n.firestore,uh),t=ep(e),i=new zv(e);return BW(t,n._query,{source:"server"}).then((r=>new AA(e,i,n,r)))}function ug(n,e,t){n=fa(n,wo);const i=fa(n.firestore,uh),r=Zk(n.converter,e,t);return Xv(i,[$k($v(i),"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,kl.none())])}function cl(n,e,t,...i){n=fa(n,wo);const r=fa(n.firestore,uh),s=$v(r);let o;return o=typeof(e=Zs(e))=="string"||e instanceof Hm?LW(s,"updateDoc",n._key,e,t,i):NW(s,"updateDoc",n._key,e),Xv(r,[o.toMutation(n._key,kl.exists(!0))])}function P_(n){return Xv(fa(n.firestore,uh),[new u5(n._key,kl.none())])}function Gv(n,e){const t=fa(n.firestore,uh),i=Tr(n),r=Zk(n.converter,e);return Xv(t,[$k($v(n.firestore),"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,kl.exists(!1))]).then((()=>i))}function Jk(n,...e){var t,i,r;n=Zs(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||ij(e[o])||(s=e[o++]);const a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(ij(e[o])){const d=e[o];e[o]=(t=d.next)===null||t===void 0?void 0:t.bind(d),e[o+1]=(i=d.error)===null||i===void 0?void 0:i.bind(d),e[o+2]=(r=d.complete)===null||r===void 0?void 0:r.bind(d)}let c,h,u;if(n instanceof wo)h=fa(n.firestore,uh),u=o5(n._key.path),c={next:d=>{e[o]&&e[o](eI(h,n,d))},error:e[o+1],complete:e[o+2]};else{const d=fa(n,Lu);h=fa(d.firestore,uh),u=d._query;const f=new zv(h);c={next:A=>{e[o]&&e[o](new AA(h,f,d,A))},error:e[o+1],complete:e[o+2]},UW(n._query)}return(function(f,A,g,p){const y=new Wk(p),v=new Ok(A,y,g);return f.asyncQueue.enqueueAndForget((async()=>Lk(await F_(f),v))),()=>{y.Ou(),f.asyncQueue.enqueueAndForget((async()=>Mk(await F_(f),v)))}})(ep(h),u,a,c)}function Xv(n,e){return(function(i,r){const s=new fd;return i.asyncQueue.enqueueAndForget((async()=>are(await wre(i),r,s))),s.promise})(ep(n),e)}function eI(n,e,t){const i=t.docs.get(e._key),r=new zv(n);return new dA(n,r,e._key,i,new Hp(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dre={maxAttempts:5};function V2(n,e){if((n=Zs(n)).firestore!==e)throw new ri(yn.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jre{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=$v(e)}get(e){const t=V2(e,this._firestore),i=new Ire(this._firestore);return this._transaction.lookup([t._key]).then((r=>{if(!r||r.length!==1)return Ki(24041);const s=r[0];if(s.isFoundDocument())return new j_(this._firestore,i,s.key,s,t.converter);if(s.isNoDocument())return new j_(this._firestore,i,t._key,null,t.converter);throw Ki(18433,{doc:s})}))}set(e,t,i){const r=V2(e,this._firestore),s=Zk(r.converter,t,i),o=$k(this._dataReader,"Transaction.set",r._key,s,r.converter!==null,i);return this._transaction.set(r._key,o),this}update(e,t,i,...r){const s=V2(e,this._firestore);let o;return o=typeof(t=Zs(t))=="string"||t instanceof Hm?LW(this._dataReader,"Transaction.update",s._key,t,i,r):NW(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,o),this}delete(e){const t=V2(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QW extends jre{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=V2(e,this._firestore),i=new zv(this._firestore);return super.get(e).then((r=>new dA(this._firestore,i,t._key,r._document,new Hp(!1,!1),t.converter)))}}function $W(n,e,t){n=fa(n,uh);const i=Object.assign(Object.assign({},Dre),t);return(function(s){if(s.maxAttempts<1)throw new ri(yn.INVALID_ARGUMENT,"Max attempts must be at least 1")})(i),(function(s,o,a){const c=new fd;return s.asyncQueue.enqueueAndForget((async()=>{const h=await xre(s);new mre(s.asyncQueue,h,a,o,c).zu()})),c.promise})(ep(n),(r=>e(new QW(n,r))),i)}function Ks(){return new Vk("serverTimestamp")}function VW(...n){return new zk("arrayUnion",n)}(function(e,t=!0){(function(r){Mm=r})(bg),ag(new Pf("firestore",((i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),a=new uh(new jte(i.getProvider("auth-internal")),new Lte(o,i.getProvider("app-check-internal")),(function(h,u){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new ri(yn.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ym(h.options.projectId,u)})(o,r),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a}),"PUBLIC").setMultipleInstances(!0)),ud(oD,aD,e),ud(oD,aD,"esm2017")})();const Pre=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:Yk,Bytes:Mc,CollectionReference:uA,DocumentReference:wo,DocumentSnapshot:dA,FieldPath:Hm,FieldValue:Wm,Firestore:uh,FirestoreError:ri,GeoPoint:Su,Query:Lu,QueryCompositeFilterConstraint:v5,QueryConstraint:qk,QueryDocumentSnapshot:my,QueryFieldFilterConstraint:Vv,QueryOrderByConstraint:w5,QuerySnapshot:AA,SnapshotMetadata:Hp,Timestamp:Ps,Transaction:QW,VectorValue:Tu,_AutoId:n5,_ByteString:ul,_DatabaseId:ym,_DocumentKey:$i,_EmptyAuthCredentialsProvider:fH,_FieldPath:ll,_cast:fa,_logWarn:wA,_validateIsNotUsedTogether:gH,addDoc:Gv,arrayUnion:VW,collection:Ua,collectionGroup:FW,connectFirestoreEmulator:IW,deleteDoc:P_,doc:Tr,ensureFirestoreConfigured:ep,executeWrite:Xv,getDoc:Kh,getDocFromServer:Fl,getDocs:Mu,getDocsFromServer:WW,getFirestore:DW,onSnapshot:Jk,orderBy:Bg,query:ph,runTransaction:$W,serverTimestamp:Ks,setDoc:ug,updateDoc:cl,where:Ca},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zW="firebasestorage.googleapis.com",GW="storageBucket",Nre=120*1e3,Lre=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qo extends Nu{constructor(e,t,i=0){super(OS(e),`Firebase Storage: ${t} (${OS(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,qo.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return OS(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ko;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ko||(Ko={}));function OS(n){return"storage/"+n}function tI(){const n="An unknown error occurred, please check the error payload for server response.";return new qo(Ko.UNKNOWN,n)}function Mre(n){return new qo(Ko.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function Rre(n){return new qo(Ko.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Ore(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new qo(Ko.UNAUTHENTICATED,n)}function Ure(){return new qo(Ko.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Hre(n){return new qo(Ko.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function Wre(){return new qo(Ko.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Qre(){return new qo(Ko.CANCELED,"User canceled the upload/download.")}function $re(n){return new qo(Ko.INVALID_URL,"Invalid URL '"+n+"'.")}function Vre(n){return new qo(Ko.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function zre(){return new qo(Ko.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+GW+"' property when initializing the app?")}function Gre(){return new qo(Ko.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Xre(){return new qo(Ko.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function Kre(n){return new qo(Ko.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function OB(n){return new qo(Ko.INVALID_ARGUMENT,n)}function XW(){return new qo(Ko.APP_DELETED,"The Firebase app was deleted.")}function qre(n){return new qo(Ko.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function yy(n,e){return new qo(Ko.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function k1(n){throw new qo(Ko.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oh{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=oh.makeFromUrl(e,t)}catch{return new oh(e,"")}if(i.path==="")return i;throw Vre(e)}static makeFromUrl(e,t){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(x){x.path.charAt(x.path.length-1)==="/"&&(x.path_=x.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),c={bucket:1,path:3};function h(x){x.path_=decodeURIComponent(x.path)}const u="v[A-Za-z0-9_]+",d=t.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",A=new RegExp(`^https?://${d}/${u}/b/${r}/o${f}`,"i"),g={bucket:1,path:3},p=t===zW?"(?:storage.googleapis.com|storage.cloud.google.com)":t,y="([^?#]*)",v=new RegExp(`^https?://${p}/${r}/${y}`,"i"),w=[{regex:a,indices:c,postModify:s},{regex:A,indices:g,postModify:h},{regex:v,indices:{bucket:1,path:2},postModify:h}];for(let x=0;x<w.length;x++){const T=w[x],j=T.regex.exec(e);if(j){const D=j[T.indices.bucket];let b=j[T.indices.path];b||(b=""),i=new oh(D,b),T.postModify(i);break}}if(i==null)throw $re(e);return i}}class Yre{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zre(n,e,t){let i=1,r=null,s=null,o=!1,a=0;function c(){return a===2}let h=!1;function u(...y){h||(h=!0,e.apply(null,y))}function d(y){r=setTimeout(()=>{r=null,n(A,c())},y)}function f(){s&&clearTimeout(s)}function A(y,...v){if(h){f();return}if(y){f(),u.call(null,y,...v);return}if(c()||o){f(),u.call(null,y,...v);return}i<64&&(i*=2);let w;a===1?(a=2,w=0):w=(i+Math.random())*1e3,d(w)}let g=!1;function p(y){g||(g=!0,f(),!h&&(r!==null?(y||(a=2),clearTimeout(r),d(0)):y||(a=1)))}return d(0),s=setTimeout(()=>{o=!0,p(!0)},t),p}function Jre(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ese(n){return n!==void 0}function tse(n){return typeof n=="object"&&!Array.isArray(n)}function nI(n){return typeof n=="string"||n instanceof String}function oj(n){return iI()&&n instanceof Blob}function iI(){return typeof Blob<"u"}function aj(n,e,t,i){if(i<e)throw OB(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw OB(`Invalid value for '${n}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x5(n,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function KW(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const r=e(i)+"="+e(n[i]);t=t+r+"&"}return t=t.slice(0,-1),t}var qp;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(qp||(qp={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nse(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||r||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ise{constructor(e,t,i,r,s,o,a,c,h,u,d,f=!0,A=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=h,this.progressCallback_=u,this.connectionFactory_=d,this.retry=f,this.isUsingEmulator=A,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((g,p)=>{this.resolve_=g,this.reject_=p,this.start_()})}start_(){const e=(i,r)=>{if(r){i(!1,new Kw(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const c=a.loaded,h=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,h)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===qp.NO_ERROR,c=s.getStatus();if(!a||nse(c,this.additionalRetryCodes_)&&this.retry){const u=s.getErrorCode()===qp.ABORT;i(!1,new Kw(!1,null,u));return}const h=this.successCodes_.indexOf(c)!==-1;i(!0,new Kw(h,s))})},t=(i,r)=>{const s=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const c=this.callback_(a,a.getResponse());ese(c)?s(c):s()}catch(c){o(c)}else if(a!==null){const c=tI();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(r.canceled){const c=this.appDelete_?XW():Qre();o(c)}else{const c=Wre();o(c)}};this.canceled_?t(!1,new Kw(!1,null,!0)):this.backoffId_=Zre(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Jre(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Kw{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function rse(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function sse(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function ose(n,e){e&&(n["X-Firebase-GMPID"]=e)}function ase(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function lse(n,e,t,i,r,s,o=!0,a=!1){const c=KW(n.urlParams),h=n.url+c,u=Object.assign({},n.headers);return ose(u,e),rse(u,t),sse(u,s),ase(u,i),new ise(h,n.method,u,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cse(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function hse(...n){const e=cse();if(e!==void 0){const t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}else{if(iI())return new Blob(n);throw new qo(Ko.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function use(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dse(n){if(typeof atob>"u")throw Kre("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ad={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class US{constructor(e,t){this.data=e,this.contentType=t||null}}function Ase(n,e){switch(n){case ad.RAW:return new US(qW(e));case ad.BASE64:case ad.BASE64URL:return new US(YW(n,e));case ad.DATA_URL:return new US(pse(e),gse(e))}throw tI()}function qW(n){const e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const s=i,o=n.charCodeAt(++t);i=65536|(s&1023)<<10|o&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function fse(n){let e;try{e=decodeURIComponent(n)}catch{throw yy(ad.DATA_URL,"Malformed data URL.")}return qW(e)}function YW(n,e){switch(n){case ad.BASE64:{const r=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(r||s)throw yy(n,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case ad.BASE64URL:{const r=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(r||s)throw yy(n,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=dse(e)}catch(r){throw r.message.includes("polyfill")?r:yy(n,"Invalid character found")}const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i}class ZW{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw yy(ad.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=mse(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function pse(n){const e=new ZW(n);return e.base64?YW(ad.BASE64,e.rest):fse(e.rest)}function gse(n){return new ZW(n).contentType}function mse(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(e,t){let i=0,r="";oj(e)?(this.data_=e,i=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(oj(this.data_)){const i=this.data_,r=use(i,e,t);return r===null?null:new pf(r)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new pf(i,!0)}}static getBlob(...e){if(iI()){const t=e.map(i=>i instanceof pf?i.data_:i);return new pf(hse.apply(null,t))}else{const t=e.map(o=>nI(o)?Ase(ad.RAW,o).data:o.data_);let i=0;t.forEach(o=>{i+=o.byteLength});const r=new Uint8Array(i);let s=0;return t.forEach(o=>{for(let a=0;a<o.length;a++)r[s++]=o[a]}),new pf(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JW(n){let e;try{e=JSON.parse(n)}catch{return null}return tse(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yse(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function vse(n,e){const t=e.split("/").filter(i=>i.length>0).join("/");return n.length===0?t:n+"/"+t}function eQ(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wse(n,e){return e}class ac{constructor(e,t,i,r){this.server=e,this.local=t||e,this.writable=!!i,this.xform=r||wse}}let qw=null;function xse(n){return!nI(n)||n.length<2?n:eQ(n)}function tQ(){if(qw)return qw;const n=[];n.push(new ac("bucket")),n.push(new ac("generation")),n.push(new ac("metageneration")),n.push(new ac("name","fullPath",!0));function e(s,o){return xse(o)}const t=new ac("name");t.xform=e,n.push(t);function i(s,o){return o!==void 0?Number(o):o}const r=new ac("size");return r.xform=i,n.push(r),n.push(new ac("timeCreated")),n.push(new ac("updated")),n.push(new ac("md5Hash",null,!0)),n.push(new ac("cacheControl",null,!0)),n.push(new ac("contentDisposition",null,!0)),n.push(new ac("contentEncoding",null,!0)),n.push(new ac("contentLanguage",null,!0)),n.push(new ac("contentType",null,!0)),n.push(new ac("metadata","customMetadata",!0)),qw=n,qw}function bse(n,e){function t(){const i=n.bucket,r=n.fullPath,s=new oh(i,r);return e._makeStorageReference(s)}Object.defineProperty(n,"ref",{get:t})}function _se(n,e,t){const i={};i.type="file";const r=t.length;for(let s=0;s<r;s++){const o=t[s];i[o.local]=o.xform(i,e[o.server])}return bse(i,n),i}function nQ(n,e,t){const i=JW(e);return i===null?null:_se(n,i,t)}function Cse(n,e,t,i){const r=JW(e);if(r===null||!nI(r.downloadTokens))return null;const s=r.downloadTokens;if(s.length===0)return null;const o=encodeURIComponent;return s.split(",").map(h=>{const u=n.bucket,d=n.fullPath,f="/b/"+o(u)+"/o/"+o(d),A=x5(f,t,i),g=KW({alt:"media",token:h});return A+g})[0]}function Sse(n,e){const t={},i=e.length;for(let r=0;r<i;r++){const s=e[r];s.writable&&(t[s.server]=n[s.local])}return JSON.stringify(t)}class rI{constructor(e,t,i,r){this.url=e,this.method=t,this.handler=i,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iQ(n){if(!n)throw tI()}function Tse(n,e){function t(i,r){const s=nQ(n,r,e);return iQ(s!==null),s}return t}function Bse(n,e){function t(i,r){const s=nQ(n,r,e);return iQ(s!==null),Cse(s,r,n.host,n._protocol)}return t}function rQ(n){function e(t,i){let r;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?r=Ure():r=Ore():t.getStatus()===402?r=Rre(n.bucket):t.getStatus()===403?r=Hre(n.path):r=i,r.status=t.getStatus(),r.serverResponse=i.serverResponse,r}return e}function sQ(n){const e=rQ(n);function t(i,r){let s=e(i,r);return i.getStatus()===404&&(s=Mre(n.path)),s.serverResponse=r.serverResponse,s}return t}function Ese(n,e,t){const i=e.fullServerUrl(),r=x5(i,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,a=new rI(r,s,Bse(n,t),o);return a.errorHandler=sQ(e),a}function kse(n,e){const t=e.fullServerUrl(),i=x5(t,n.host,n._protocol),r="DELETE",s=n.maxOperationRetryTime;function o(c,h){}const a=new rI(i,r,o,s);return a.successCodes=[200,204],a.errorHandler=sQ(e),a}function Ise(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function Fse(n,e,t){const i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=Ise(null,e)),i}function Dse(n,e,t,i,r){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let w="";for(let x=0;x<2;x++)w=w+Math.random().toString().slice(2);return w}const c=a();o["Content-Type"]="multipart/related; boundary="+c;const h=Fse(e,i,r),u=Sse(h,t),d="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+c+`\r
Content-Type: `+h.contentType+`\r
\r
`,f=`\r
--`+c+"--",A=pf.getBlob(d,i,f);if(A===null)throw Gre();const g={name:h.fullPath},p=x5(s,n.host,n._protocol),y="POST",v=n.maxUploadRetryTime,m=new rI(p,y,Tse(n,t),v);return m.urlParams=g,m.headers=o,m.body=A.uploadData(),m.errorHandler=rQ(e),m}class jse{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=qp.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=qp.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=qp.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,r,s){if(this.sent_)throw k1("cannot .send() more than once");if(qf(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),s!==void 0)for(const o in s)s.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,s[o].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw k1("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw k1("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw k1("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw k1("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class Pse extends jse{initXhr(){this.xhr_.responseType="text"}}function sI(){return new Pse}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dg{constructor(e,t){this._service=e,t instanceof oh?this._location=t:this._location=oh.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new dg(e,t)}get root(){const e=new oh(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return eQ(this._location.path)}get storage(){return this._service}get parent(){const e=yse(this._location.path);if(e===null)return null;const t=new oh(this._location.bucket,e);return new dg(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw qre(e)}}function Nse(n,e,t){n._throwIfRoot("uploadBytes");const i=Dse(n.storage,n._location,tQ(),new pf(e,!0),t);return n.storage.makeRequestWithTokens(i,sI).then(r=>({metadata:r,ref:n}))}function Lse(n){n._throwIfRoot("getDownloadURL");const e=Ese(n.storage,n._location,tQ());return n.storage.makeRequestWithTokens(e,sI).then(t=>{if(t===null)throw Xre();return t})}function Mse(n){n._throwIfRoot("deleteObject");const e=kse(n.storage,n._location);return n.storage.makeRequestWithTokens(e,sI)}function Rse(n,e){const t=vse(n._location.path,e),i=new oh(n._location.bucket,t);return new dg(n.storage,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ose(n){return/^[A-Za-z]+:\/\//.test(n)}function Use(n,e){return new dg(n,e)}function oQ(n,e){if(n instanceof oI){const t=n;if(t._bucket==null)throw zre();const i=new dg(t,t._bucket);return e!=null?oQ(i,e):i}else return e!==void 0?Rse(n,e):n}function Hse(n,e){if(e&&Ose(e)){if(n instanceof oI)return Use(n,e);throw OB("To use ref(service, url), the first argument must be a Storage instance.")}else return oQ(n,e)}function lj(n,e){const t=e==null?void 0:e[GW];return t==null?null:oh.makeFromBucketSpec(t,n)}function Wse(n,e,t,i={}){n.host=`${e}:${t}`;const r=qf(e);r&&(Z6(`https://${n.host}/b`),J6("Storage",!0)),n._isUsingEmulator=!0,n._protocol=r?"https":"http";const{mockUserToken:s}=i;s&&(n._overrideAuthToken=typeof s=="string"?s:tU(s,n.app.options.projectId))}class oI{constructor(e,t,i,r,s,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=zW,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Nre,this._maxUploadRetryTime=Lre,this._requests=new Set,r!=null?this._bucket=oh.makeFromBucketSpec(r,this._host):this._bucket=lj(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=oh.makeFromBucketSpec(this._url,e):this._bucket=lj(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){aj("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){aj("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(fc(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new dg(this,e)}_makeRequest(e,t,i,r,s=!0){if(this._deleted)return new Yre(XW());{const o=lse(e,this._appId,i,r,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,r).getPromise()}}const cj="@firebase/storage",hj="0.13.14";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aQ="storage";function lQ(n,e,t){return n=Zs(n),Nse(n,e,t)}function cQ(n){return n=Zs(n),Lse(n)}function hQ(n){return n=Zs(n),Mse(n)}function N_(n,e){return n=Zs(n),Hse(n,e)}function Qse(n=nk(),e){n=Zs(n);const i=XC(n,aQ).getImmediate({identifier:e}),r=ZO("storage");return r&&$se(i,...r),i}function $se(n,e,t,i={}){Wse(n,e,t,i)}function Vse(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new oI(t,i,r,e,bg)}function zse(){ag(new Pf(aQ,Vse,"PUBLIC").setMultipleInstances(!0)),ud(cj,hj,""),ud(cj,hj,"esm2017")}zse();const Fp={apiKey:"your_api_key_here".trim(),authDomain:"your_auth_domain_here".trim(),projectId:"your_project_id_here".trim(),storageBucket:"your_storage_bucket_here".trim(),messagingSenderId:"your_messaging_sender_id_here".trim(),appId:"your_app_id_here".trim()};console.log("🔥 Firebase Config Status:",{apiKey:Fp.apiKey?"✅ Set":"❌ Missing",authDomain:Fp.authDomain||"❌ Missing",projectId:Fp.projectId||"❌ Missing",storageBucket:Fp.storageBucket||"❌ Missing",messagingSenderId:Fp.messagingSenderId?"✅ Set":"❌ Missing",appId:Fp.appId?"✅ Set":"❌ Missing",environment:"production",currentDomain:typeof window<"u"?window.location.hostname:"N/A"});const aI=rU(Fp),ku=rH(aI),Ri=DW(aI),nv=Qse(aI),uQ=Object.freeze(Object.defineProperty({__proto__:null,auth:ku,db:Ri,storage:nv},Symbol.toStringTag,{value:"Module"})),Yl={teamScope:!0,dualWrite:!0,newReadsFirst:!0,nestedDesigns:!0},iv=new sd;iv.setCustomParameters({prompt:"select_account",auth_type:"rerequest",access_type:"offline"});iv.addScope("profile");iv.addScope("email");const $m=async(n,e)=>{try{const t=await MU(ku,n,e);return Yl.teamScope&&await b5(t.user),{user:t.user,error:null}}catch(t){return{user:null,error:t.message}}},Vm=async()=>{try{if(console.log("🔐 구글 로그인 시도"),console.log("🔐 현재 도메인:",window.location.hostname),console.log("🔐 Auth Domain:","your_auth_domain_here"),console.log("🔐 환경:","production"),/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)){const{signInWithRedirect:e}=await ca(async()=>{const{signInWithRedirect:t}=await Promise.resolve().then(()=>sH);return{signInWithRedirect:t}},void 0);return await e(ku,iv),{user:null,error:null}}else{const e=await YU(ku,iv);return Yl.teamScope&&await b5(e.user),{user:e.user,error:null}}}catch(n){const e=n;console.error("🔥 구글 로그인 에러 발생"),console.error("🔥 에러 코드:",e.code),console.error("🔥 에러 메시지:",e.message),console.error("🔥 전체 에러:",n);let t=e.message;switch(e.code){case"auth/popup-closed-by-user":t="로그인이 취소되었습니다.";break;case"auth/popup-blocked":t="팝업이 차단되었습니다. 팝업을 허용해주세요.";break;case"auth/cancelled-popup-request":t="로그인 요청이 취소되었습니다.";break;case"auth/account-exists-with-different-credential":t="이미 다른 방법으로 가입된 이메일입니다.";break;case"auth/unauthorized-domain":t=`인증되지 않은 도메인입니다. 현재 도메인: ${window.location.hostname}`,console.error("🔥 Firebase 인증 도메인 오류"),console.error("🔥 현재 도메인:",window.location.hostname),console.error("🔥 현재 URL:",window.location.href),console.error("🔥 Auth Domain 설정:","your_auth_domain_here"),console.error("🔥 Firebase Console > Authentication > Settings > Authorized domains에 추가 필요");break;default:t="구글 로그인 중 오류가 발생했습니다."}return{user:null,error:t}}},zm=async(n,e,t)=>{try{const i=await LU(ku,n,e);return t&&i.user&&await JC(i.user,{displayName:t}),Yl.teamScope&&await b5(i.user),{user:i.user,error:null}}catch(i){return{user:null,error:i.message}}},dQ=async()=>{try{return await UU(ku),{error:null}}catch(n){return{error:n.message}}},AQ=n=>ck(ku,n),mr=()=>new Promise(n=>{const e=ck(ku,t=>{e(),n(t)})}),fQ=async()=>{try{const n=await eH(ku);return n!=null&&n.user?(console.log("🔐 리다이렉트 로그인 성공:",n.user.email),Yl.teamScope&&await b5(n.user),{user:n.user,error:null}):{user:null,error:null}}catch(n){const e=n;return console.error("리다이렉트 처리 오류:",e),{user:null,error:e.message}}};async function b5(n){try{const{doc:e,getDoc:t,setDoc:i,serverTimestamp:r,Timestamp:s}=await ca(async()=>{const{doc:d,getDoc:f,setDoc:A,serverTimestamp:g,Timestamp:p}=await Promise.resolve().then(()=>Pre);return{doc:d,getDoc:f,setDoc:A,serverTimestamp:g,Timestamp:p}},void 0),{db:o}=await ca(async()=>{const{db:d}=await Promise.resolve().then(()=>uQ);return{db:d}},void 0),a=`personal_${n.uid}`,c=e(o,"teams",a);if((await t(c)).exists())return;const u={name:`${(n.email||"User").split("@")[0]}'s Workspace`,description:"Personal workspace",ownerId:n.uid,members:[{userId:n.uid,email:n.email||"",displayName:n.displayName||"",photoURL:n.photoURL||"",role:"owner",joinedAt:s.now(),status:"active"}],settings:{isPublic:!1,allowInvitations:!0,defaultRole:"viewer",maxMembers:50},createdAt:r(),updatedAt:r()};await i(c,u),n.email&&localStorage.setItem("userEmail",n.email),console.log("✅ Personal team created:",a)}catch(e){console.error("Failed to create personal team:",e)}}const Gse=Object.freeze(Object.defineProperty({__proto__:null,getCurrentUserAsync:mr,handleRedirectResult:fQ,onAuthStateChange:AQ,signInWithEmail:$m,signInWithGoogle:Vm,signOutUser:dQ,signUpWithEmail:zm},Symbol.toStringTag,{value:"Module"})),pQ=O.createContext(void 0),Xse=({children:n})=>{const[e,t]=O.useState(null),[i,r]=O.useState(!0);O.useEffect(()=>{try{const o=AQ(c=>{t(c),r(!1),c?(console.log("🔐 사용자 로그인:",c.email),localStorage.setItem("userId",c.uid),localStorage.getItem("activeTeamId")||localStorage.setItem("activeTeamId",`personal_${c.uid}`)):(console.log("🔐 사용자 로그아웃"),localStorage.removeItem("userId"),localStorage.removeItem("activeTeamId"))}),a=setTimeout(()=>{r(c=>c&&(console.warn("⚠️ Firebase 인증 상태 확인 타임아웃 - 로딩 강제 종료"),!1))},5e3);return()=>{o(),clearTimeout(a)}}catch(o){console.error("❌ Firebase 인증 설정 에러:",o),r(!1)}},[]);const s={user:e,loading:i,isAuthenticated:!!e};return l.jsx(pQ.Provider,{value:s,children:n})},ec=()=>{const n=O.useContext(pQ);if(n===void 0)throw new Error("useAuth는 AuthProvider 내에서 사용해야 합니다.");return n};function Kse(n){const e=n.replace("#",""),t=parseInt(e.substring(0,2),16)/255,i=parseInt(e.substring(2,4),16)/255,r=parseInt(e.substring(4,6),16)/255,s=Math.max(t,i,r),o=Math.min(t,i,r);let a=0,c=0;const h=(s+o)/2;if(s!==o){const u=s-o;switch(c=h>.5?u/(2-s-o):u/(s+o),s){case t:a=((i-r)/u+(i<r?6:0))/6;break;case i:a=((r-t)/u+2)/6;break;case r:a=((t-i)/u+4)/6;break}}return{h:Math.round(a*360),s:Math.round(c*100),l:Math.round(h*100)}}function qse(n){let e=n.match(/hsl\((\d+)\s+(\d+)%\s+(\d+)%\)/);return e||(e=n.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/)),e?{h:parseInt(e[1]),s:parseInt(e[2]),l:parseInt(e[3])}:null}function gQ(n){let e,t,i;if(n.startsWith("hsl")){const s=qse(n);if(!s){console.warn("Invalid HSL color:",n);return}({h:e,s:t,l:i}=s)}else({h:e,s:t,l:i}=Kse(n));const r=document.documentElement;r.style.setProperty("--theme",`${e} ${t}% ${i}%`),r.style.setProperty("--theme-50",`${e} ${t}% ${Math.min(98,i+48)}%`),r.style.setProperty("--theme-100",`${e} ${t}% ${Math.min(95,i+40)}%`),r.style.setProperty("--theme-200",`${e} ${t}% ${Math.min(90,i+30)}%`),r.style.setProperty("--theme-300",`${e} ${t}% ${Math.min(80,i+20)}%`),r.style.setProperty("--theme-400",`${e} ${t}% ${Math.min(70,i+10)}%`),r.style.setProperty("--theme-500",`${e} ${t}% ${i}%`),r.style.setProperty("--theme-600",`${e} ${Math.max(10,t-5)}% ${Math.max(20,i-10)}%`),r.style.setProperty("--theme-700",`${e} ${Math.max(10,t-10)}% ${Math.max(15,i-20)}%`),r.style.setProperty("--theme-800",`${e} ${Math.max(10,t-15)}% ${Math.max(10,i-30)}%`),r.style.setProperty("--theme-900",`${e} ${Math.max(10,t-20)}% ${Math.max(5,i-40)}%`),localStorage.setItem("themeColor",n)}function mQ(){return localStorage.getItem("themeColor")||"#7C5CFF"}function lI(){const n=mQ();gQ(n)}function th(){const n=mQ();return n.startsWith("#")?n:"#7C5CFF"}const yQ=O.createContext(void 0),uj="app-theme-config",Yse={mode:"light",color:"blue"},Zse=({children:n})=>{const e=()=>{try{const a=localStorage.getItem(uj);if(a)return JSON.parse(a)}catch(a){console.warn("테마 설정 로드 실패:",a)}return Yse},[t,i]=O.useState(()=>{const a=e();return typeof window<"u"&&document.documentElement&&dj(a),a});O.useEffect(()=>{try{localStorage.setItem(uj,JSON.stringify(t)),dj(t)}catch(a){console.warn("테마 설정 저장 실패:",a)}},[t]);const r=a=>{i(c=>({...c,mode:a}))},s=a=>{i(h=>({...h,color:a}));const c={green:"#10b981",blue:"#3b82f6",purple:"#8b5cf6",vivid:"#a25378",red:"#D2042D",pink:"#ec4899",indigo:"#6366f1",teal:"#14b8a6",yellow:"#eab308",gray:"#6b7280",cyan:"#06b6d4",lime:"#84cc16",black:"#1a1a1a",wine:"#845EC2",gold:"#d97706",navy:"#1e3a8a",emerald:"#059669",violet:"#C128D7",mint:"#0CBA80",neon:"#18CF23",rust:"#FF7438",white:"#D65DB1",plum:"#790963",brown:"#5A2B1D",darkgray:"#2C3844",maroon:"#3F0D0D",turquoise:"#003A7A",slate:"#2E3A47",copper:"#AD4F34",forest:"#1B3924",olive:"#4C462C"};c[a]&&gQ(c[a])},o=()=>{r(t.mode==="light"?"dark":"light")};return l.jsx(yQ.Provider,{value:{theme:t,setThemeMode:r,setThemeColor:s,toggleMode:o},children:n})},Yo=()=>{const n=O.useContext(yQ);if(!n)throw new Error("useTheme must be used within a ThemeProvider");return n},dj=n=>{console.log("🎨 테마 적용 중:",n);const e=document.documentElement;e.setAttribute("data-theme",n.mode),document.body.classList.remove(...Array.from(document.body.classList).filter(o=>o.startsWith("theme-")));const t={green:{primary:"#10b981",primaryHover:"#059669",primaryLight:n.mode==="dark"?"rgba(16, 185, 129, 0.2)":"#d1fae5",primaryDark:"#047857"},blue:{primary:"#3b82f6",primaryHover:"#2563eb",primaryLight:n.mode==="dark"?"rgba(59, 130, 246, 0.2)":"#dbeafe",primaryDark:"#1d4ed8"},purple:{primary:"#8b5cf6",primaryHover:"#7c3aed",primaryLight:n.mode==="dark"?"rgba(139, 92, 246, 0.2)":"#ede9fe",primaryDark:"#6d28d9"},vivid:{primary:"#a25378",primaryHover:"#82425f",primaryLight:n.mode==="dark"?"rgba(162, 83, 120, 0.2)":"#f4e7ee",primaryDark:"#613247"},red:{primary:"#D2042D",primaryHover:"#A80324",primaryLight:n.mode==="dark"?"rgba(210, 4, 45, 0.2)":"#ffe0e6",primaryDark:"#7E021B"},pink:{primary:"#ec4899",primaryHover:"#db2777",primaryLight:n.mode==="dark"?"rgba(236, 72, 153, 0.2)":"#fce7f3",primaryDark:"#be185d"},indigo:{primary:"#6366f1",primaryHover:"#4f46e5",primaryLight:n.mode==="dark"?"rgba(99, 102, 241, 0.2)":"#e0e7ff",primaryDark:"#3730a3"},teal:{primary:"#14b8a6",primaryHover:"#0d9488",primaryLight:n.mode==="dark"?"rgba(20, 184, 166, 0.2)":"#ccfbf1",primaryDark:"#0f766e"},yellow:{primary:"#eab308",primaryHover:"#ca8a04",primaryLight:n.mode==="dark"?"rgba(234, 179, 8, 0.2)":"#fef3c7",primaryDark:"#a16207"},gray:{primary:"#6b7280",primaryHover:"#4b5563",primaryLight:n.mode==="dark"?"rgba(107, 114, 128, 0.2)":"#f3f4f6",primaryDark:"#374151"},cyan:{primary:"#06b6d4",primaryHover:"#0891b2",primaryLight:n.mode==="dark"?"rgba(6, 182, 212, 0.2)":"#cffafe",primaryDark:"#0e7490"},lime:{primary:"#84cc16",primaryHover:"#65a30d",primaryLight:n.mode==="dark"?"rgba(132, 204, 22, 0.2)":"#ecfccb",primaryDark:"#4d7c0f"},black:{primary:"#1a1a1a",primaryHover:"#000000",primaryLight:n.mode==="dark"?"rgba(26, 26, 26, 0.2)":"#f5f5f5",primaryDark:"#000000"},wine:{primary:"#845EC2",primaryHover:"#744EB2",primaryLight:n.mode==="dark"?"rgba(132, 94, 194, 0.2)":"#e6dcf5",primaryDark:"#643EA2"},gold:{primary:"#d97706",primaryHover:"#b45309",primaryLight:n.mode==="dark"?"rgba(217, 119, 6, 0.2)":"#fef3c7",primaryDark:"#92400e"},navy:{primary:"#1e3a8a",primaryHover:"#1e40af",primaryLight:n.mode==="dark"?"rgba(30, 58, 138, 0.2)":"#dbeafe",primaryDark:"#1e1b4b"},emerald:{primary:"#059669",primaryHover:"#047857",primaryLight:n.mode==="dark"?"rgba(5, 150, 105, 0.2)":"#d1fae5",primaryDark:"#064e3b"},violet:{primary:"#C128D7",primaryHover:"#A020B8",primaryLight:n.mode==="dark"?"rgba(193, 40, 215, 0.2)":"#f3e8ff",primaryDark:"#7B1FA2"},mint:{primary:"#0CBA80",primaryHover:"#0AA66B",primaryLight:n.mode==="dark"?"rgba(12, 186, 128, 0.2)":"#ecfdf5",primaryDark:"#065F46"},neon:{primary:"#18CF23",primaryHover:"#15B820",primaryLight:n.mode==="dark"?"rgba(24, 207, 35, 0.2)":"#f0fdf4",primaryDark:"#166534"},rust:{primary:"#FF7438",primaryHover:"#FF5722",primaryLight:n.mode==="dark"?"rgba(255, 116, 56, 0.2)":"#ffe4db",primaryDark:"#E64A19"},white:{primary:"#D65DB1",primaryHover:"#C44DA0",primaryLight:n.mode==="dark"?"rgba(214, 93, 177, 0.2)":"#f5d4ed",primaryDark:"#B84D91"},plum:{primary:"#790963",primaryHover:"#5f074e",primaryLight:n.mode==="dark"?"rgba(121, 9, 99, 0.2)":"#f7e6f3",primaryDark:"#47053b"},brown:{primary:"#5A2B1D",primaryHover:"#4A2318",primaryLight:n.mode==="dark"?"rgba(90, 43, 29, 0.2)":"#f5e6e0",primaryDark:"#3E1810"},darkgray:{primary:"#2C3844",primaryHover:"#232D37",primaryLight:n.mode==="dark"?"rgba(44, 56, 68, 0.2)":"#e8eaed",primaryDark:"#1A2027"},maroon:{primary:"#3F0D0D",primaryHover:"#330A0A",primaryLight:n.mode==="dark"?"rgba(63, 13, 13, 0.2)":"#fce4e4",primaryDark:"#260707"},turquoise:{primary:"#003A7A",primaryHover:"#002F63",primaryLight:n.mode==="dark"?"rgba(0, 58, 122, 0.2)":"#e0e9f4",primaryDark:"#00254C"},slate:{primary:"#2E3A47",primaryHover:"#252F3A",primaryLight:n.mode==="dark"?"rgba(46, 58, 71, 0.2)":"#e9ebee",primaryDark:"#1C242D"},copper:{primary:"#AD4F34",primaryHover:"#954329",primaryLight:n.mode==="dark"?"rgba(173, 79, 52, 0.2)":"#fbe8e3",primaryDark:"#7D3820"},forest:{primary:"#1B3924",primaryHover:"#152D1D",primaryLight:n.mode==="dark"?"rgba(27, 57, 36, 0.2)":"#e3ebe6",primaryDark:"#0F2116"},olive:{primary:"#4C462C",primaryHover:"#3D3A23",primaryLight:n.mode==="dark"?"rgba(76, 70, 44, 0.2)":"#eeece4",primaryDark:"#2E2B1A"}},i={light:{background:"#ffffff",backgroundSecondary:"#f9fafb",surface:"#ffffff",text:"#111827",textSecondary:"#6b7280",textMuted:"#9ca3af",border:"#e5e7eb",borderHover:"#d1d5db",shadow:"rgba(0, 0, 0, 0.1)",overlay:"rgba(0, 0, 0, 0.5)"},dark:{background:"#121212",backgroundSecondary:"#121212",surface:"#121212",text:"#ffffff",textSecondary:"#cccccc",textMuted:"#999999",border:"#333333",borderHover:"#555555",shadow:"rgba(0, 0, 0, 0.5)",overlay:"rgba(0, 0, 0, 0.8)"}},r=t[n.color],s=i[n.mode];e.style.setProperty("--theme-mode",n.mode),e.style.setProperty("--theme-color",n.color),e.style.setProperty("--theme-primary",r.primary),e.style.setProperty("--theme-primary-hover",r.primaryHover),e.style.setProperty("--theme-primary-light",r.primaryLight),e.style.setProperty("--theme-primary-dark",r.primaryDark),e.style.setProperty("--theme-background",s.background),e.style.setProperty("--theme-background-secondary",s.backgroundSecondary),e.style.setProperty("--theme-surface",s.surface),e.style.setProperty("--theme-text",s.text),e.style.setProperty("--theme-text-secondary",s.textSecondary),e.style.setProperty("--theme-text-muted",s.textMuted),e.style.setProperty("--theme-border",s.border),e.style.setProperty("--theme-border-hover",s.borderHover),e.style.setProperty("--theme-shadow",s.shadow),e.style.setProperty("--theme-overlay",s.overlay),e.style.setProperty("--theme-danger","#ef4444"),e.style.setProperty("--theme-danger-hover","#dc2626"),e.style.setProperty("--theme-danger-light",n.mode==="dark"?"rgba(239, 68, 68, 0.2)":"#fee2e2"),e.style.setProperty("--theme-info","#3b82f6"),e.style.setProperty("--theme-info-hover","#2563eb"),e.style.setProperty("--theme-info-light",n.mode==="dark"?"rgba(59, 130, 246, 0.2)":"#eff6ff"),e.style.setProperty("--theme-warning","#f59e0b"),e.style.setProperty("--theme-warning-hover","#d97706"),e.style.setProperty("--theme-warning-light",n.mode==="dark"?"rgba(245, 158, 11, 0.2)":"#fef3c7"),e.style.setProperty("--theme-success",r.primary),e.style.setProperty("--theme-success-hover",r.primaryHover),e.style.setProperty("--theme-success-light",r.primaryLight),n.mode==="dark"?e.style.setProperty("--popup-shadow",`0 20px 50px rgba(0, 0, 0, 0.8), 0 10px 20px ${r.primaryLight}`):e.style.setProperty("--popup-shadow","0 20px 50px rgba(0, 0, 0, 0.3), 0 10px 20px rgba(0, 0, 0, 0.15)"),document.body.className=document.body.className.replace(/theme-\w+-\w+/g,""),document.body.classList.add(`theme-${n.mode}-${n.color}`),document.body.style.backgroundColor=s.background,document.body.style.color=s.text,console.log("🎨 테마 적용 완료:",{mode:n.mode,color:n.color,background:s.background,text:s.text,primary:r.primary}),setTimeout(()=>{const o=getComputedStyle(e).getPropertyValue("--theme-background").trim(),a=getComputedStyle(e).getPropertyValue("--theme-text").trim(),c=getComputedStyle(e).getPropertyValue("--theme-primary").trim();console.log("🔍 CSS 변수 적용 확인:",{expected:{background:s.background,text:s.text,primary:r.primary},applied:{background:o,text:a,primary:c},success:o===s.background&&a===s.text}),o!==s.background&&(console.error("❌ 배경색 적용 실패!",{expected:s.background,actual:o}),e.style.setProperty("--theme-background",s.background),document.body.style.backgroundColor=s.background),a!==s.text&&(console.error("❌ 텍스트 색상 적용 실패!",{expected:s.text,actual:a}),e.style.setProperty("--theme-text",s.text),document.body.style.color=s.text)},100),setTimeout(()=>{const o=document.querySelectorAll('[class*="navItem"]');console.log(`🔧 네비게이션 항목 ${o.length}개 발견, 테마 강제 적용 중...`),o.forEach(a=>{const c=a;c.classList.contains("active")?(c.style.setProperty("color",r.primary,"important"),c.style.setProperty("background-color",r.primaryLight,"important")):(c.style.setProperty("color",s.textSecondary,"important"),c.style.setProperty("background-color","transparent","important"))}),console.log("✅ 네비게이션 테마 적용 완료")},200),Jse(r.primary,n.mode)},Jse=(n,e)=>{const t=document.createElement("canvas");t.width=32,t.height=32;const i=t.getContext("2d");if(!i)return;i.fillStyle=n;const r=2,s=2,o=28,a=28,c=4;i.beginPath(),i.moveTo(r+c,s),i.arcTo(r+o,s,r+o,s+a,c),i.arcTo(r+o,s+a,r,s+a,c),i.arcTo(r,s+a,r,s,c),i.arcTo(r,s,r+o,s,c),i.closePath(),i.fill(),e==="dark"&&(i.strokeStyle="rgba(255, 255, 255, 0.3)",i.lineWidth=1,i.stroke()),i.fillStyle="#ffffff",i.font="bold 18px Arial, sans-serif",i.textAlign="center",i.textBaseline="middle",i.fillText("m",16,17);const h=document.querySelector("link[rel~='icon']"),u=document.querySelector("link[rel='icon'][type='image/svg+xml']");h&&h.type==="image/x-icon"&&h.remove(),u&&u.remove();const d=document.createElement("link");d.type="image/x-icon",d.rel="icon",d.href=t.toDataURL(),document.head.appendChild(d)},eoe="_overlay_1oxoj_1",toe="_modal_1oxoj_24",noe="_header_1oxoj_45",ioe="_title_1oxoj_50",roe="_content_1oxoj_57",soe="_message_1oxoj_61",ooe="_footer_1oxoj_69",aoe="_confirmButton_1oxoj_77",loe="_cancelButton_1oxoj_131",rl={overlay:eoe,modal:toe,header:noe,title:ioe,content:roe,message:soe,footer:ooe,confirmButton:aoe,cancelButton:loe},vQ=({isOpen:n,message:e,onClose:t,title:i="알림",onConfirm:r,onCancel:s,showCancel:o=!1})=>{if(!n)return null;const a=()=>{r&&r(),t()},c=()=>{s&&s(),t()};return l.jsx("div",{className:rl.overlay,onClick:o?c:t,children:l.jsxs("div",{className:rl.modal,onClick:h=>h.stopPropagation(),children:[l.jsx("div",{className:rl.header,children:l.jsx("h3",{className:rl.title,children:i})}),l.jsx("div",{className:rl.content,children:l.jsx("p",{className:rl.message,children:e})}),l.jsxs("div",{className:rl.footer,children:[o&&l.jsx("button",{className:rl.cancelButton,onClick:c,children:"취소"}),l.jsx("button",{className:rl.confirmButton,onClick:a,children:"확인"})]})]})})},wQ=O.createContext(void 0),coe=()=>{const n=O.useContext(wQ);if(!n)throw new Error("useAlert must be used within AlertProvider");return n},hoe=({children:n})=>{const[e,t]=O.useState(!1),[i,r]=O.useState(""),[s,o]=O.useState("알림"),[a,c]=O.useState(),[h,u]=O.useState(),[d,f]=O.useState(!1),A=O.useCallback((p,y)=>{r(p),o((y==null?void 0:y.title)||"알림"),c(()=>y==null?void 0:y.onConfirm),u(()=>y==null?void 0:y.onCancel),f((y==null?void 0:y.showCancel)||!1),t(!0)},[]),g=O.useCallback(()=>{t(!1),c(void 0),u(void 0),f(!1)},[]);return l.jsxs(wQ.Provider,{value:{showAlert:A,hideAlert:g},children:[n,(()=>{const p=document.getElementById("modal-root");return!p||!e?null:$C.createPortal(l.jsx(vQ,{isOpen:e,message:i,title:s,onClose:g,onConfirm:a,onCancel:h,showCancel:d}),p)})()]})},uoe=({isOpen:n,message:e,onConfirm:t,onCancel:i,title:r="확인",confirmText:s="확인",cancelText:o="취소"})=>n?l.jsx("div",{className:rl.overlay,onClick:i,children:l.jsxs("div",{className:rl.modal,onClick:a=>a.stopPropagation(),children:[l.jsx("div",{className:rl.header,children:l.jsx("h3",{className:rl.title,children:r})}),l.jsx("div",{className:rl.content,children:l.jsx("p",{className:rl.message,children:e})}),l.jsxs("div",{className:rl.footer,children:[l.jsx("button",{className:rl.cancelButton,onClick:i,children:o}),l.jsx("button",{className:rl.confirmButton,onClick:t,children:s})]})]})}):null,doe=()=>{const[n,e]=O.useState(!1),[t,i]=O.useState(""),[r,s]=O.useState("확인"),[o,a]=O.useState("확인"),[c,h]=O.useState("취소"),[u,d]=O.useState(null),f=O.useCallback((y,v)=>new Promise(m=>{i(y),s((v==null?void 0:v.title)||"확인"),a((v==null?void 0:v.confirmText)||"확인"),h((v==null?void 0:v.cancelText)||"취소"),e(!0),d(()=>m)}),[]),A=O.useCallback(()=>{e(!1),u&&(u(!0),d(null))},[u]),g=O.useCallback(()=>{e(!1),u&&(u(!1),d(null))},[u]);return{showConfirm:f,ConfirmComponent:()=>{const y=document.getElementById("modal-root");return y?$C.createPortal(l.jsx(uoe,{isOpen:n,message:t,title:r,confirmText:o,cancelText:c,onConfirm:A,onCancel:g}),y):null}}},HS={projectId:null,projectTitle:null,basicInfo:{title:"",location:""},isDirty:!1},Ha=Lm()(n=>({...HS,setProjectId:e=>n({projectId:e}),setProjectTitle:e=>n({projectTitle:e}),setBasicInfo:e=>n(t=>({basicInfo:{...t.basicInfo,...e},isDirty:!0})),resetBasicInfo:()=>n({basicInfo:HS.basicInfo,isDirty:!1}),resetAll:()=>n({...HS,isDirty:!1}),markAsSaved:()=>n({isDirty:!1})})),Aoe=580,Aj=10,fr=18,xQ=n=>{var r;if(!n||typeof n.width!="number"||typeof n.height!="number"||typeof n.depth!="number")return{width:3600,height:2400,depth:1500};const e=n.width||3600,t=n.hasFloorFinish?(n.height||2400)-(((r=n.floorFinish)==null?void 0:r.height)||0):n.height||2400,i=n.depth||1500;return{width:e,height:t,depth:i}},kr=n=>{var d,f,A,g,p,y;if(!n)return{width:0,height:0,depth:0,startX:0,startY:0,startZ:0};const e=oa(n),t=bQ(n),i=_Q(n),r=L0(n);let s;if(n.surroundType==="no-surround")if(n.installType==="builtin"||n.installType==="built-in"){const v=((d=n.gapConfig)==null?void 0:d.left)||2,m=((f=n.gapConfig)==null?void 0:f.right)||2;s=n.width-v-m}else n.installType==="semistanding"||n.installType==="semi-standing"?s=n.width-18:s=n.width-36;else s=n.width-e.left-e.right;let o=n.height;const a=((A=n.baseConfig)==null?void 0:A.type)==="stand"&&((g=n.baseConfig)==null?void 0:g.placementType)==="float";if(n.hasFloorFinish&&!a&&(o-=t),o-=i,o-=r,n.zone==="dropped"&&((p=n.droppedCeiling)!=null&&p.enabled)){const v=n.droppedCeiling.dropHeight||200;o-=v}const c=n.depth||1500;let h;n.surroundType==="no-surround"&&n.gapConfig?h=n.gapConfig.left:h=e.left;let u;return a?u=((y=n.baseConfig)==null?void 0:y.floatHeight)||0:u=r+t,{width:s,height:o,depth:c,startX:h,startY:u,startZ:0}},foe=n=>n?n.depth||1500:Aoe,poe=n=>{if(!n||n.length===0)return 600;let e=600;return n.forEach(t=>{t.customDepth&&t.customDepth>e?e=t.customDepth:t.moduleId&&t.moduleId.includes("styler")&&(e=Math.max(e,660))}),e},bQ=n=>!n.hasFloorFinish||!n.floorFinish?0:n.floorFinish.height,oa=n=>{if(!n)return{left:0,right:0,leftMm:0,rightMm:0};const{installType:e,wallConfig:t,frameSize:i,surroundType:r}=n;if(r==="no-surround"){let u=0,d=0;return console.log("🔍 노서라운드 frameSize 체크:",{frameSize:i,"frameSize?.left":i==null?void 0:i.left,"frameSize?.right":i==null?void 0:i.right,installType:e,wallConfig:t}),e==="builtin"||e==="built-in"?(u=0,d=0):e==="semistanding"||e==="semi-standing"?t!=null&&t.left?(u=0,d=fr):(u=fr,d=0):e==="freestanding"&&(u=fr,d=fr),console.log("🔍 노서라운드 프레임 계산 결과:",{frameSize:i,leftThickness:u,rightThickness:d,installType:e,surroundType:r,wallConfig:t,벽위치:t!=null&&t.left?"좌측":t!=null&&t.right?"우측":"없음",엔드패널위치:t!=null&&t.left?"우측":"좌측"}),{left:u,right:d,leftMm:u,rightMm:d}}let s=0,o=0;const a=50,c=(i==null?void 0:i.left)!==void 0?i.left:a,h=(i==null?void 0:i.right)!==void 0?i.right:a;switch(e){case"builtin":case"built-in":s=c,o=h;break;case"semistanding":case"semi-standing":t!=null&&t.left&&!(t!=null&&t.right)?(s=c,o=fr):!(t!=null&&t.left)&&(t!=null&&t.right)?(s=fr,o=h):(s=c,o=fr);break;case"freestanding":case"free-standing":s=fr,o=fr;break;default:s=c,o=h}return{left:s,right:o,leftMm:s,rightMm:o}},goe=n=>{if(!n)return{width:0,widthMm:0};let e;if(n.surroundType==="no-surround"&&n.gapConfig)e=n.width-(n.gapConfig.left+n.gapConfig.right);else{const t=oa(n);e=n.width-t.leftMm-t.rightMm}return{width:e,widthMm:e}},L0=n=>{var e,t,i;if(console.log("📐 calculateBaseFrameHeight 호출:",{spaceInfo_exists:!!n,baseConfig_type:(e=n==null?void 0:n.baseConfig)==null?void 0:e.type,baseConfig_height:(t=n==null?void 0:n.baseConfig)==null?void 0:t.height,hasFloorFinish:n==null?void 0:n.hasFloorFinish,floorFinish:n==null?void 0:n.floorFinish}),!n)return 0;if(((i=n.baseConfig)==null?void 0:i.type)==="floor"){const r=n.baseConfig.height||65;if(n.hasFloorFinish&&n.floorFinish){const s=n.floorFinish.height||0,o=Math.max(0,r-s);return console.log("📐 calculateBaseFrameHeight - 바닥마감재 적용:",{baseHeight:r,floorFinishHeight:s,adjustedHeight:o,계산식:`${r} - ${s} = ${o}`}),o}return console.log("📐 calculateBaseFrameHeight - 바닥마감재 없음, 원래 높이 반환:",r),r}return 0},_Q=n=>{var e;return n&&((e=n.frameSize)==null?void 0:e.top)||Aj};class ro{static mmToThreeUnits(e){return e*.01}static calculateInternalWidth(e){var r;const t=oa(e),i=e.width;if(e.surroundType==="no-surround"){let s=0,o=0;return e.installType==="builtin"||e.installType==="built-in"?(s=0,o=0):e.installType==="semistanding"||e.installType==="semi-standing"?(r=e.wallConfig)!=null&&r.left?(s=0,o=fr):(s=fr,o=0):(s=fr,o=fr),i-(s+o)}else return i-t.left-t.right}static getColumnCountLimits(e){const o=Math.ceil(e/600),a=Math.floor(e/400),c=e<=600,h=e<=1200;return{minColumns:o,maxColumns:a,canUseSingle:c,canUseDual:h,columnWidthWillBe:u=>Math.floor(e/u)}}static validateColumnCount(e,t){const i=ro.getColumnCountLimits(t),r=Math.floor(t/e);return{isValid:e>=i.minColumns&&e<=i.maxColumns&&r>=400&&r<=600,columnWidth:r,limits:i}}static getDefaultColumnCount(e){return e<=600?1:Math.ceil(e/600)}static threeUnitsToMm(e){return e*100}}class wr{static calculateSpaceIndexing(e){var m,w,x,T,j,D,b,_,I,S,F,B,E,V,K;if(!e)return{columnCount:0,columnPositions:[],threeUnitPositions:[],columnBoundaries:[],threeUnitBoundaries:[],dualColumnPositions:[],threeUnitDualPositions:[],columnWidth:0,internalWidth:0,internalStartX:0,threeUnitColumnWidth:0};if((m=e.droppedCeiling)!=null&&m.enabled){const P=e.width,M=ro.calculateInternalWidth(e),X=oa(e);let Z;if(e.surroundType==="no-surround"){let _e=0;e.installType==="builtin"||e.installType==="built-in"?_e=((w=e.gapConfig)==null?void 0:w.left)||2:(e.installType==="semistanding"||e.installType==="semi-standing")&&(x=e.wallConfig)!=null&&x.left?_e=0:_e=fr,Z=-(P/2)+_e}else Z=-(P/2)+X.left;let Q;e.customColumnCount?Q=e.customColumnCount:Q=ro.getDefaultColumnCount(M);const U=Math.floor(M/Q),z=[],q=[];for(let _e=0;_e<=Q;_e++)z.push(Z+_e*U);for(let _e=0;_e<Q;_e++)q.push(Z+_e*U+U/2);const G=q.map(_e=>ro.mmToThreeUnits(_e)),ie=z.map(_e=>ro.mmToThreeUnits(_e)),H=Math.floor(M/Q),se=M%Q,te=[];for(let _e=0;_e<Q;_e++)te.push(_e<se?H+1:H);const fe=[],ye=[];for(let _e=0;_e<Q-1;_e++){let W;if(te&&te[_e]!==void 0){let Y=0;for(let ve=0;ve<=_e;ve++)Y+=te[ve];W=Y}else W=z[_e];fe.push(W),ye.push(ro.mmToThreeUnits(W))}const be=wr.calculateZoneSlotInfo(e,e.customColumnCount);if(be.normal){be.normal.threeUnitPositions=[],be.normal.threeUnitDualPositions=[];let _e=be.normal.startX;for(let W=0;W<be.normal.columnCount;W++){const Y=((T=be.normal.slotWidths)==null?void 0:T[W])||be.normal.columnWidth,ve=_e+Y/2;be.normal.threeUnitPositions.push(ro.mmToThreeUnits(ve)),console.log(`🎯 Normal Zone Slot ${W}:`,{startX:_e,width:Y,centerX:ve,threeUnits:ro.mmToThreeUnits(ve)}),_e+=Y}for(let W=0;W<be.normal.columnCount-1;W++){const Y=be.normal.threeUnitPositions[W],ve=be.normal.threeUnitPositions[W+1],ce=(Y+ve)/2;be.normal.threeUnitDualPositions.push(ce)}}if(be.dropped){be.dropped.threeUnitPositions=[],be.dropped.threeUnitDualPositions=[];let _e=be.dropped.startX;for(let W=0;W<be.dropped.columnCount;W++){const Y=((j=be.dropped.slotWidths)==null?void 0:j[W])||be.dropped.columnWidth,ve=_e+Y/2;be.dropped.threeUnitPositions.push(ro.mmToThreeUnits(ve)),_e+=Y}for(let W=0;W<be.dropped.columnCount-1;W++){const Y=be.dropped.threeUnitPositions[W],ve=be.dropped.threeUnitPositions[W+1],ce=(Y+ve)/2;be.dropped.threeUnitDualPositions.push(ce)}}return{columnCount:Q,columnPositions:q,threeUnitPositions:G,columnBoundaries:z,threeUnitBoundaries:ie,dualColumnPositions:fe,threeUnitDualPositions:ye,columnWidth:U,slotWidths:te,internalWidth:M,internalStartX:Z,threeUnitColumnWidth:ro.mmToThreeUnits(U),zones:be}}const t=oa(e),i=e.width,r=ro.calculateInternalWidth(e);let s;e.mainDoorCount!==void 0&&e.mainDoorCount>0?s=e.mainDoorCount:e.customColumnCount?s=e.customColumnCount:s=ro.getDefaultColumnCount(r);const o=e.surroundType==="no-surround",a=[];if(o&&e.installType==="freestanding"){const P=Math.floor(i/s),M=i%s;for(let X=0;X<s;X++){let Z=X<M?P+1:P;(X===0||X===s-1)&&(Z=Z-fr),a.push(Z)}console.log("🔧 노서라운드 벽없음 슬롯 계산:",{"전체 공간 너비":i,"컬럼 수":s,"기본 슬롯 너비":P,"슬롯 너비 배열":a,예시:`${a[0]} / ${a[1]||"..."} / ... / ${a[a.length-1]}`})}else if(o&&(e.installType==="semistanding"||e.installType==="semi-standing")){const P=Math.floor(i/s),M=i%s;for(let X=0;X<s;X++){let Z=P;X<M&&(Z+=1),(!((D=e.wallConfig)!=null&&D.left)&&X===0||!((b=e.wallConfig)!=null&&b.right)&&X===s-1)&&(Z-=fr),a.push(Z)}console.log("🔧 노서라운드 한쪽벽 슬롯 계산 (커버도어 방식):",{"전체 공간 너비":i,"컬럼 수":s,"기본 슬롯 너비":P,"슬롯 너비 배열":a,"벽 위치":(_=e.wallConfig)!=null&&_.left?"좌측":"우측","첫 슬롯":a[0],"마지막 슬롯":a[a.length-1],"엔드패널 위치":(I=e.wallConfig)!=null&&I.left?(S=e.wallConfig)!=null&&S.right?"없음":"우측":"좌측"})}else{const P=Math.floor(r/s),M=r%s;for(let X=0;X<s;X++)a.push(X<M?P+1:P)}const c=Math.floor(r/s),h=0;let u;if(e.surroundType==="no-surround"){let P=0;e.installType==="builtin"||e.installType==="built-in"?P=((F=e.gapConfig)==null?void 0:F.left)||2:(e.installType==="semistanding"||e.installType==="semi-standing")&&(B=e.wallConfig)!=null&&B.left?P=0:P=fr,u=-(i/2)+P+h}else u=-(i/2)+t.left+h;const d=[];let f;o&&(e.installType==="freestanding"||e.installType==="semistanding"||e.installType==="semi-standing")?(f=-(i/2),e.installType==="freestanding"?f=-(i/2)+fr:(e.installType==="semistanding"||e.installType==="semi-standing")&&((E=e.wallConfig)!=null&&E.left?f=-(i/2):f=-(i/2)+fr)):f=u,d.push(f);for(let P=0;P<s;P++)f+=a[P],d.push(f);const A=[];for(let P=0;P<s;P++){const M=d[P],X=d[P+1],Z=(M+X)/2;A.push(Z)}const g=A.map(P=>ro.mmToThreeUnits(P)),p=d.map(P=>ro.mmToThreeUnits(P));e.surroundType==="no-surround"&&e.gapConfig&&console.log(`🎯 [가구위치] 노서라운드 모드 - 좌측이격거리${e.gapConfig.left}mm, 우측이격거리${e.gapConfig.right}mm:`,{totalWidth:i,internalWidth:r,internalStartX:u,첫번째슬롯위치:(V=g[0])==null?void 0:V.toFixed(3),마지막슬롯위치:(K=g[g.length-1])==null?void 0:K.toFixed(3)});const y=[],v=[];for(let P=0;P<s-1;P++){const M=d[P],X=d[P+2],Z=(M+X)/2;y.push(Z),v.push(ro.mmToThreeUnits(Z)),o&&(P===0||P===s-2)&&console.log(`🎯 듀얼 가구 위치 계산 [슬롯 ${P}-${P+1}]:`,{leftSlotWidth:a[P],rightSlotWidth:a[P+1],leftSlotStart:M,rightSlotEnd:X,totalWidth:X-M,dualCenterPosition:Z,설명:"두 슬롯 전체 영역의 중심"})}return{columnCount:s,columnPositions:A,threeUnitPositions:g,columnBoundaries:d,threeUnitBoundaries:p,dualColumnPositions:y,threeUnitDualPositions:v,columnWidth:c,slotWidths:a,internalWidth:r,internalStartX:u,threeUnitColumnWidth:ro.mmToThreeUnits(c)}}static findClosestColumnIndex(e,t){const{threeUnitPositions:i,threeUnitBoundaries:r,columnCount:s}=t,o=r[0],a=r[s];if(e.x<o)return 0;if(e.x>a)return s-1;for(let d=0;d<s;d++){const f=r[d],A=r[d+1];if(e.x>=f&&e.x<=A)return d}let c=0,h=Number.MAX_VALUE;return i.map((d,f)=>{const A=Math.abs(e.x-d);return{index:f,columnX:d,distance:A}}).forEach(({index:d,distance:f})=>{f<h&&(h=f,c=d)}),c}static findSlotIndexFromPosition(e,t,i=!1){return i&&t.threeUnitDualPositions?t.threeUnitDualPositions.findIndex(s=>Math.abs(s-e.x)<.1):t.threeUnitPositions.findIndex(s=>Math.abs(s-e.x)<.1)}static calculateZoneSlotInfo(e,t){var V,K,P,M,X,Z,Q,U,z,q,G,ie,H,se,te,fe,ye;console.log("🔍🔍 [calculateZoneSlotInfo] 함수 시작:",{surroundType:e.surroundType,installType:e.installType,droppedCeilingEnabled:(V=e.droppedCeiling)==null?void 0:V.enabled,droppedCeilingPosition:(K=e.droppedCeiling)==null?void 0:K.position,droppedCeilingWidth:(P=e.droppedCeiling)==null?void 0:P.width,customColumnCount:t});const i=oa(e),r=600;if(!(e.droppedCeiling&&e.droppedCeiling.enabled===!0&&e.droppedCeiling.width&&e.droppedCeiling.width>0)){const be=ro.calculateInternalWidth(e);let _e;e.mainDoorCount!==void 0&&e.mainDoorCount>0?_e=e.mainDoorCount:t?_e=t:_e=ro.getDefaultColumnCount(be);const W=Math.ceil(be/r);_e<W&&(_e=W,console.warn(`슬롯 너비 제한: ${W}개 이상의 슬롯이 필요합니다.`));const Y=Math.floor(be/_e);let ve=be;e.surroundType==="no-surround"&&(e.installType==="freestanding"?ve=e.width-fr*2:e.installType==="semistanding"||e.installType==="semi-standing"?(ve=e.width,(M=e.wallConfig)!=null&&M.left||(ve-=fr),(X=e.wallConfig)!=null&&X.right||(ve-=fr)):(e.installType==="builtin"||e.installType==="built-in")&&(ve=e.width));let ce,ne=0;e.surroundType==="no-surround"?(e.installType==="builtin"||e.installType==="built-in"||(e.installType==="semistanding"||e.installType==="semi-standing")&&(Z=e.wallConfig)!=null&&Z.left?ne=0:ne=fr,ce=-(e.width/2)+ne):ce=-(e.width/2)+i.left,console.log("🔍 calculateZoneSlotInfo 시작점 계산:",{surroundType:e.surroundType,installType:e.installType,wallConfig:e.wallConfig,gapConfig:e.gapConfig,leftReduction:ne,internalStartX:ce,actualInternalWidth:ve,전체너비:e.width});const he=[];if(e.surroundType==="no-surround"&&e.installType==="freestanding"){const Te=Math.floor(e.width/_e),Ce=e.width%_e;for(let Be=0;Be<_e;Be++){let Ye=Be<Ce?Te+1:Te;(Be===0||Be===_e-1)&&(Ye=Ye-fr),he.push(Ye)}}else if(e.surroundType==="no-surround"&&(e.installType==="semistanding"||e.installType==="semi-standing")){const Te=Math.floor(e.width/_e),Ce=e.width%_e;for(let Be=0;Be<_e;Be++){let Ye=Te;Be<Ce&&(Ye+=1),(!((Q=e.wallConfig)!=null&&Q.left)&&Be===0||!((U=e.wallConfig)!=null&&U.right)&&Be===_e-1)&&(Ye-=fr),he.push(Ye)}}else{const Te=Math.floor(be/_e),Ce=be%_e;for(let Be=0;Be<_e;Be++)he.push(Be<Ce?Te+1:Te)}console.log("🔍 calculateZoneSlotInfo (단내림 없음):",{surroundType:e.surroundType,installType:e.installType,totalWidth:e.width,internalWidth:be,actualInternalWidth:ve,internalStartX:ce,columnCount:_e,columnWidth:Y,slotWidths:he,"첫 슬롯 너비":he[0],"마지막 슬롯 너비":he[he.length-1],"슬롯 너비 합계":he.reduce((Te,Ce)=>Te+Ce,0)});const xe={normal:{startX:ce,width:ve,columnCount:_e,columnWidth:Y,slotWidths:he},dropped:null};return console.log("🔍🔍 [calculateZoneSlotInfo] 단내림 없음 - 반환값:",{hasNormal:!!xe.normal,hasDropped:!!xe.dropped,result:xe}),xe}const o=e.width,a=e.droppedCeiling.width||yo.WIDTH,c=e.droppedCeiling.position||"right";console.log("🔍🔍 [calculateZoneSlotInfo] 단내림 활성화 처리:",{totalWidth:o,droppedWidth:a,droppedPosition:c,droppedCeilingData:e.droppedCeiling,surroundType:e.surroundType,installType:e.installType}),ro.calculateInternalWidth(e);let h;if(e.surroundType==="no-surround"){let be=0;e.installType==="builtin"||e.installType==="built-in"||(e.installType==="semistanding"||e.installType==="semi-standing")&&(z=e.wallConfig)!=null&&z.left?be=0:be=fr,h=-(o/2)+be}else h=-(o/2)+i.left;const u=o-a,d=a;let f,A,g,p;if(c==="left")if(e.surroundType==="surround")A=d-i.left,p=h,f=u-i.right,g=p+A,console.log("🔍 서라운드 왼쪽 단내림 경계 계산:",{"단내림 끝":p+A,"메인 시작":g,갭:g-(p+A),"프레임 두께":i,"spaceInfo.gapConfig":e.gapConfig,"spaceInfo.wallConfig":e.wallConfig,"spaceInfo.installType":e.installType});else{let be=0,_e=0;e.installType==="builtin"||e.installType==="built-in"?(be=0,_e=0):((q=e.wallConfig)!=null&&q.left?be=0:be=fr,(G=e.wallConfig)!=null&&G.right?_e=0:_e=fr),A=d-be,p=h,f=u-_e,g=p+A,console.log("🔍 노서라운드 왼쪽 단내림 경계 계산:",{"단내림 끝":p+A,"메인 시작":g,갭:g-(p+A),"프레임 두께":i,"SURROUND_FRAME_THICKNESS 제거됨":!0})}else if(e.surroundType==="surround")f=u-i.left,g=h,A=d-i.right,p=g+f,console.log("🔍 서라운드 오른쪽 단내림 경계 계산:",{"메인 끝":g+f,"단내림 시작":p,갭:p-(g+f),"프레임 두께":i,"spaceInfo.gapConfig":e.gapConfig,"spaceInfo.wallConfig":e.wallConfig,"spaceInfo.installType":e.installType});else{let be=0,_e=0;e.installType==="builtin"||e.installType==="built-in"?(be=0,_e=0):((ie=e.wallConfig)!=null&&ie.left?be=0:be=fr,(H=e.wallConfig)!=null&&H.right?_e=0:_e=fr),f=u-be,g=h,A=d-_e,p=g+f,console.log("🔍 노서라운드 오른쪽 단내림 경계 계산:",{"메인 끝":g+f,"단내림 시작":p,갭:p-(g+f),"프레임 두께":i,"SURROUND_FRAME_THICKNESS 제거됨":!0})}let y,v;e.mainDoorCount!==void 0&&e.mainDoorCount>0?y=e.mainDoorCount:t?y=t:y=ro.getDefaultColumnCount(f);const m=Math.ceil(f/r);y<m&&(y=m,console.warn(`메인 영역 슬롯 너비 제한: ${m}개 이상의 슬롯이 필요합니다.`)),e.droppedCeilingDoorCount!==void 0&&e.droppedCeilingDoorCount>0?v=e.droppedCeilingDoorCount:(v=ro.getDefaultColumnCount(A),console.log("🎯 단내림 컬럼 수 (자동계산):",v,"from width:",A));const w=Math.ceil(A/r);v<w&&(v=w,console.warn(`단내림 영역 슬롯 너비 제한: ${w}개 이상의 슬롯이 필요합니다.`));const x=Math.floor(f/y),T=f%y,j=Math.floor(A/v),D=A%v,b=[],_=[];if(e.surroundType==="no-surround"&&(e.installType==="semistanding"||e.installType==="semi-standing")){for(let be=0;be<y;be++){let _e=be<T?x+1:x;(c==="left"&&!((se=e.wallConfig)!=null&&se.right)&&be===y-1||c==="right"&&!((te=e.wallConfig)!=null&&te.left)&&be===0)&&(_e-=fr),b.push(_e)}for(let be=0;be<v;be++){let _e=be<D?j+1:j;(c==="left"&&!((fe=e.wallConfig)!=null&&fe.left)&&be===0||c==="right"&&!((ye=e.wallConfig)!=null&&ye.right)&&be===v-1)&&(_e-=fr),_.push(_e)}}else{for(let be=0;be<y;be++)b.push(be<T?x+1:x);for(let be=0;be<v;be++)_.push(be<D?j+1:j)}const I=x,S=j,F=g+f,B=p+A;console.log("🎯 단내림 경계 상세 분석:",{서라운드타입:e.surroundType,단내림위치:c,메인구간:{시작X:g,끝X:F,내부너비:f,슬롯너비:I,슬롯개수:y},단내림구간:{시작X:p,끝X:B,내부너비:A,슬롯너비:S,슬롯개수:v},경계갭:c==="right"?p-F:g-B,예상갭:0}),I>r&&console.error(`⚠️ 메인 영역 슬롯 너비가 600mm를 초과합니다: ${I}mm`),S>r&&console.error(`⚠️ 단내림 영역 슬롯 너비가 600mm를 초과합니다: ${S}mm`),console.log("🎯 [calculateZoneSlotInfo] 최종 계산 결과:",{메인구간:{외부너비:u,내부너비:f,슬롯개수:y,슬롯너비:I,시작위치:g,끝위치:g+f},단내림구간:{외부너비:d,내부너비:A,슬롯개수:v,슬롯너비:S,시작위치:p,끝위치:p+A},프레임정보:{왼쪽프레임:i.left,오른쪽프레임:i.right,서라운드타입:e.surroundType,단내림위치:c},갭확인:{"메인끝-단내림시작":c==="right"?p-(g+f):g-(p+A),예상값:0},설정값:{mainDoorCount:e.mainDoorCount,droppedCeilingDoorCount:e.droppedCeilingDoorCount,customColumnCount:t}});const E={normal:{startX:g,width:f,columnCount:y,columnWidth:I,slotWidths:b},dropped:{startX:p,width:A,columnCount:v,columnWidth:S,slotWidths:_}};return console.log("🔍🔍 [calculateZoneSlotInfo] 최종 반환값:",{hasNormal:!!E.normal,hasDropped:!!E.dropped,normal:E.normal,dropped:E.dropped}),E}static getColumnLimits(e){const r=Math.max(1,Math.ceil(e/600)),s=Math.max(1,Math.floor(e/400));return r>s?{minColumns:1,maxColumns:1}:(console.log("🔧 getColumnLimits 계산:",{internalWidth:e,minColumns:r,maxColumns:s,"최소 슬롯 크기 (최대 컬럼수일 때)":Math.floor(e/s),"최대 슬롯 크기 (최소 컬럼수일 때)":Math.floor(e/r)}),{minColumns:r,maxColumns:s})}static findZoneAndSlotFromPosition(e,t,i){var a;if(!((a=t.droppedCeiling)!=null&&a.enabled))return{zone:"normal",slotIndex:this.findClosestColumnIndex({x:ro.mmToThreeUnits(e.x)},i)};const r=this.calculateZoneSlotInfo(t,t.customColumnCount);if(!r.dropped)return null;const s=r.dropped.startX+r.dropped.width,o=r.normal.startX+r.normal.width;if(e.x>=r.dropped.startX&&e.x<=s){const c=e.x-r.dropped.startX,h=Math.floor(c/r.dropped.columnWidth);return{zone:"dropped",slotIndex:Math.min(h,r.dropped.columnCount-1)}}if(e.x>=r.normal.startX&&e.x<=o){const c=e.x-r.normal.startX,h=Math.floor(c/r.normal.columnWidth);return{zone:"normal",slotIndex:Math.min(h,r.normal.columnCount-1)}}return null}}const ur=wr.calculateSpaceIndexing;wr.findClosestColumnIndex;const moe=ro.calculateInternalWidth,yoe=wr.findSlotIndexFromPosition,Ai={BASIC_THICKNESS:18,DEFAULT_DEPTH:600,TYPE1_DRAWER_HEIGHT:600,TYPE2_BOTTOM_HEIGHT:1025,TYPE4_DRAWER_HEIGHT:1e3,DRAWER_HEIGHTS_2TIER:[255,255],DRAWER_HEIGHTS_4TIER:[255,255,176,176],DRAWER_GAP:24,STYLER_WIDTH:694,PANTSHANGER_WIDTH:564,SAFETY_SHELF_POSITION:2050,SAFETY_SHELF_THRESHOLD:2300,COLORS:{TYPE1:"#8D6E63",TYPE2:"#303F9F",TYPE4:"#0097A7",STYLER:"#4CAF50",PANTSHANGER:"#9C27B0"}},Wf=(n,e,t=Ai.SAFETY_SHELF_POSITION,i=Ai.SAFETY_SHELF_THRESHOLD)=>{if(e<=i)return n;let r=0;return n.map(s=>{const o=r,a=r+s.height;if(r+=s.height,s.type==="hanging"&&t>=o&&t<a){const c=t-o;return{...s,count:1,shelfPositions:[c]}}return s})},Ta=(n,e,t,i,r,s,o,a,c)=>({id:n,name:e,category:c||"full",dimensions:{width:t,height:i,depth:r},color:s,description:o,isDynamic:!0,hasDoor:!0,widthOptions:[t],type:"box",defaultDepth:a||Ai.DEFAULT_DEPTH,modelConfig:{basicThickness:Ai.BASIC_THICKNESS,hasOpenFront:!0}}),voe=(n,e)=>{const t=Ai.TYPE1_DRAWER_HEIGHT,i=e-t,r=[{type:"drawer",heightType:"absolute",height:t,count:2,drawerHeights:Ai.DRAWER_HEIGHTS_2TIER,gapHeight:Ai.DRAWER_GAP},{type:"hanging",heightType:"absolute",height:i}],s=Wf(r,e),o=Ta(`single-2drawer-hanging-${n}`,`2단서랍+옷장 ${n}mm`,n,e,Ai.DEFAULT_DEPTH,Ai.COLORS.TYPE1,e>Ai.SAFETY_SHELF_THRESHOLD?"하단 2단 서랍장 + 상단 옷장 (안전선반 포함)":"하단 2단 서랍장 + 상단 옷장",Ai.DEFAULT_DEPTH);return{...o,modelConfig:{...o.modelConfig,sections:s}}},woe=(n,e)=>{const t=Ai.TYPE2_BOTTOM_HEIGHT,i=e-t,s=Wf([{type:"hanging",heightType:"absolute",height:t,shelfPositions:[]},{type:"hanging",heightType:"absolute",height:i}],e),o=Ta(`single-2hanging-${n}`,`2단 옷장 ${n}mm`,n,e,Ai.DEFAULT_DEPTH,Ai.COLORS.TYPE2,e>Ai.SAFETY_SHELF_THRESHOLD?"하단 짧은옷장 + 상단 긴옷장 (안전선반 포함)":"하단 짧은옷장 + 상단 긴옷장");return{...o,modelConfig:{...o.modelConfig,sections:s}}},xoe=(n,e)=>{const t=Ai.TYPE4_DRAWER_HEIGHT,i=e-t,r=[{type:"drawer",heightType:"absolute",height:t,count:4,drawerHeights:Ai.DRAWER_HEIGHTS_4TIER,gapHeight:Ai.DRAWER_GAP},{type:"hanging",heightType:"absolute",height:i}],s=Wf(r,e),o=Ta(`single-4drawer-hanging-${n}`,`4단서랍+옷장 ${n}mm`,n,e,Ai.DEFAULT_DEPTH,Ai.COLORS.TYPE4,e>Ai.SAFETY_SHELF_THRESHOLD?"4단 서랍장 + 옷장 복합형 (안전선반 포함)":"4단 서랍장 + 옷장 복합형");return{...o,modelConfig:{...o.modelConfig,sections:s}}},boe=(n,e)=>{const t=Ai.TYPE1_DRAWER_HEIGHT,i=e-t,r=[{type:"drawer",heightType:"absolute",height:t,count:2,drawerHeights:Ai.DRAWER_HEIGHTS_2TIER,gapHeight:Ai.DRAWER_GAP},{type:"hanging",heightType:"absolute",height:i}],s=Wf(r,e),o=Ta(`dual-2drawer-hanging-${n}`,`듀얼 2단서랍+옷장 ${n}mm`,n,e,Ai.DEFAULT_DEPTH,Ai.COLORS.TYPE1,e>Ai.SAFETY_SHELF_THRESHOLD?"듀얼 하단 2단 서랍장 + 상단 옷장 (안전선반 포함)":"듀얼 하단 2단 서랍장 + 상단 옷장");return{...o,modelConfig:{...o.modelConfig,sections:s}}},_oe=(n,e)=>{const t=Ai.TYPE2_BOTTOM_HEIGHT,i=e-t,s=Wf([{type:"hanging",heightType:"absolute",height:t,shelfPositions:[]},{type:"hanging",heightType:"absolute",height:i}],e),o=Ta(`dual-2hanging-${n}`,`듀얼 2단 옷장 ${n}mm`,n,e,Ai.DEFAULT_DEPTH,Ai.COLORS.TYPE2,e>Ai.SAFETY_SHELF_THRESHOLD?"듀얼 하단 짧은옷장 + 상단 긴옷장 (안전선반 포함)":"듀얼 하단 짧은옷장 + 상단 긴옷장");return{...o,modelConfig:{...o.modelConfig,sections:s}}},Coe=(n,e)=>{const t=Ai.TYPE4_DRAWER_HEIGHT,i=e-t,r=[{type:"drawer",heightType:"absolute",height:t,count:4,drawerHeights:Ai.DRAWER_HEIGHTS_4TIER,gapHeight:Ai.DRAWER_GAP},{type:"hanging",heightType:"absolute",height:i}],s=Wf(r,e),o=Ta(`dual-4drawer-hanging-${n}`,`듀얼 4단서랍+옷장 ${n}mm`,n,e,Ai.DEFAULT_DEPTH,Ai.COLORS.TYPE4,e>Ai.SAFETY_SHELF_THRESHOLD?"듀얼 4단 서랍장 + 옷장 복합형 (안전선반 포함)":"듀얼 4단 서랍장 + 옷장 복합형");return{...o,modelConfig:{...o.modelConfig,sections:s}}},Soe=(n,e)=>{const t=Ai.TYPE1_DRAWER_HEIGHT,i=e-t,r=[{type:"drawer",heightType:"absolute",height:t,count:2,drawerHeights:Ai.DRAWER_HEIGHTS_2TIER,gapHeight:Ai.DRAWER_GAP},{type:"hanging",heightType:"absolute",height:i}],o=[{type:"hanging",heightType:"absolute",height:t+i}],a=Wf(r,e),c=Wf(o,e),h=Ta(`dual-2drawer-styler-${n}`,`듀얼 서랍+스타일러 ${n}mm`,n,e,600,Ai.COLORS.STYLER,e>Ai.SAFETY_SHELF_THRESHOLD?"좌측 서랍+옷장 + 우측 스타일러장 (안전선반 포함)":"좌측 서랍+옷장 + 우측 스타일러장",600);return{...h,modelConfig:{...h.modelConfig,rightAbsoluteWidth:Ai.STYLER_WIDTH,rightAbsoluteDepth:660,hasSharedMiddlePanel:!1,leftSections:a,rightSections:c}}},Toe=(n,e)=>{const t=Ai.TYPE4_DRAWER_HEIGHT,i=e-t,r=Ta(`dual-4drawer-pantshanger-${n}`,`듀얼 서랍+바지걸이 ${n}mm`,n,e,Ai.DEFAULT_DEPTH,Ai.COLORS.PANTSHANGER,e>Ai.SAFETY_SHELF_THRESHOLD?"좌측 4단서랍+옷장 + 우측 바지걸이+옷장 (통합 안전선반)":"좌측 4단서랍+옷장 + 우측 바지걸이+옷장");return{...r,modelConfig:{...r.modelConfig,rightAbsoluteWidth:Ai.PANTSHANGER_WIDTH,hasSharedMiddlePanel:!0,middlePanelHeight:t,hasSharedSafetyShelf:e>Ai.SAFETY_SHELF_THRESHOLD,safetyShelfHeight:Ai.SAFETY_SHELF_POSITION,leftSections:[{type:"drawer",heightType:"absolute",height:t,count:4,drawerHeights:Ai.DRAWER_HEIGHTS_4TIER,gapHeight:Ai.DRAWER_GAP},{type:"hanging",heightType:"absolute",height:i}],rightSections:[{type:"hanging",heightType:"absolute",height:t},{type:"hanging",heightType:"absolute",height:i}]}}},Boe=n=>{const e=Ta(`upper-cabinet-shelf-${n}`,`상부장 선반형 ${n}mm`,n,600,Ai.DEFAULT_DEPTH,"#e8f5e9","상부장 선반 2단형",Ai.DEFAULT_DEPTH,"upper");return{...e,modelConfig:{...e.modelConfig,sections:[{type:"shelf",heightType:"percentage",height:100,count:2}]}}},Eoe=n=>{const e=Ta(`upper-cabinet-2tier-${n}`,`상부장 2단형 ${n}mm`,n,600,Ai.DEFAULT_DEPTH,"#e3f2fd","상부장 2단형 (중간 선반 1개)",Ai.DEFAULT_DEPTH,"upper");return{...e,modelConfig:{...e.modelConfig,sections:[{type:"shelf",heightType:"percentage",height:100,count:1}]}}},koe=n=>{const e=Ta(`upper-cabinet-open-${n}`,`상부장 오픈형 ${n}mm`,n,600,Ai.DEFAULT_DEPTH,"#fff3e0","상부장 오픈형",Ai.DEFAULT_DEPTH,"upper");return{...e,modelConfig:{...e.modelConfig,sections:[{type:"open",heightType:"percentage",height:100}]}}},Ioe=n=>{const e=Ta(`upper-cabinet-mixed-${n}`,`상부장 혼합형 ${n}mm`,n,600,Ai.DEFAULT_DEPTH,"#f3e5f5","상부장 혼합형 (오픈+선반)",Ai.DEFAULT_DEPTH,"upper");return{...e,modelConfig:{...e.modelConfig,sections:[{type:"shelf",heightType:"percentage",height:50,count:1},{type:"open",heightType:"percentage",height:50}]}}},Foe=n=>{const e=Ta(`lower-cabinet-basic-${n}`,`하부장 ${n}mm`,n,1e3,600,"#fff3e0",`하부장 기본형 W${n}xH1000xD600`,600,"lower");return{...e,isDynamic:!0,defaultDepth:600,modelConfig:{...e.modelConfig,basicThickness:Ai.BASIC_THICKNESS,hasOpenFront:!1,sections:[{type:"shelf",heightType:"percentage",height:100,count:2}]}}},Doe=n=>{const e=Ta(`lower-cabinet-2tier-${n}`,`하부장 2단형 ${n}mm`,n,1e3,600,"#fce4ec","하부장 2단형 (중간 선반 1개)",600,"lower");return{...e,isDynamic:!0,defaultDepth:600,modelConfig:{...e.modelConfig,basicThickness:Ai.BASIC_THICKNESS,hasOpenFront:!1,sections:[{type:"shelf",heightType:"percentage",height:100,count:1}]}}},joe=n=>{const e=Ta(`dual-upper-cabinet-shelf-${n}`,`듀얼 상부장 선반형 ${n}mm`,n,600,Ai.DEFAULT_DEPTH,"#c8e6c9","듀얼 상부장 선반 2단형",Ai.DEFAULT_DEPTH,"upper");return{...e,modelConfig:{...e.modelConfig,leftSections:[{type:"shelf",heightType:"percentage",height:100,count:2}],rightSections:[{type:"shelf",heightType:"percentage",height:100,count:2}]}}},Poe=n=>{const e=Ta(`dual-upper-cabinet-2tier-${n}`,`듀얼 상부장 2단형 ${n}mm`,n,600,Ai.DEFAULT_DEPTH,"#bbdefb","듀얼 상부장 2단형 (중간 선반 1개)",Ai.DEFAULT_DEPTH,"upper");return{...e,modelConfig:{...e.modelConfig,leftSections:[{type:"shelf",heightType:"percentage",height:100,count:1}],rightSections:[{type:"shelf",heightType:"percentage",height:100,count:1}]}}},Noe=n=>{const e=Ta(`dual-upper-cabinet-open-${n}`,`듀얼 상부장 오픈형 ${n}mm`,n,600,Ai.DEFAULT_DEPTH,"#ffe0b2","듀얼 상부장 오픈형",Ai.DEFAULT_DEPTH,"upper");return{...e,modelConfig:{...e.modelConfig,leftSections:[{type:"open",heightType:"percentage",height:100}],rightSections:[{type:"open",heightType:"percentage",height:100}]}}},Loe=n=>{const e=Ta(`dual-upper-cabinet-mixed-${n}`,`듀얼 상부장 혼합형 ${n}mm`,n,600,Ai.DEFAULT_DEPTH,"#e1bee7","듀얼 상부장 혼합형 (오픈+선반)",Ai.DEFAULT_DEPTH,"upper");return{...e,modelConfig:{...e.modelConfig,leftSections:[{type:"shelf",heightType:"percentage",height:50,count:1},{type:"open",heightType:"percentage",height:50}],rightSections:[{type:"shelf",heightType:"percentage",height:50,count:1},{type:"open",heightType:"percentage",height:50}]}}},Moe=n=>{const e=Ta(`dual-lower-cabinet-basic-${n}`,`듀얼 하부장 ${n}mm`,n,1e3,600,"#ffcc80",`듀얼 하부장 기본형 W${n}xH1000xD600`,600,"lower");return{...e,isDynamic:!0,defaultDepth:600,modelConfig:{...e.modelConfig,basicThickness:Ai.BASIC_THICKNESS,hasOpenFront:!1,leftSections:[{type:"shelf",heightType:"percentage",height:100,count:2}],rightSections:[{type:"shelf",heightType:"percentage",height:100,count:2}]}}},Roe=n=>{const e=Ta(`dual-lower-cabinet-2tier-${n}`,`듀얼 하부장 2단형 ${n}mm`,n,1e3,600,"#f8bbd0","듀얼 하부장 2단형 (중간 선반 1개)",600,"lower");return{...e,isDynamic:!0,defaultDepth:600,modelConfig:{...e.modelConfig,basicThickness:Ai.BASIC_THICKNESS,hasOpenFront:!1,leftSections:[{type:"shelf",heightType:"percentage",height:100,count:1}],rightSections:[{type:"shelf",heightType:"percentage",height:100,count:1}]}}},Ooe=(n,e)=>{var g,p,y,v,m;let{height:t}=n;if(console.log("🔍 generateShelvingModules - 내부 공간 높이:",{internalSpaceHeight:n.height,maxHeight:t,spaceInfo:{height:e==null?void 0:e.height,baseConfig:e==null?void 0:e.baseConfig,hasFloorFinish:e==null?void 0:e.hasFloorFinish,floorFinishHeight:(g=e==null?void 0:e.floorFinish)==null?void 0:g.height}}),((p=e==null?void 0:e.baseConfig)==null?void 0:p.type)==="stand"&&e.baseConfig.placementType==="float"){const w=e.baseConfig.floatHeight||0;t=t-w}let i;e?i=e:(console.warn("⚠️ [generateShelvingModules] No spaceInfo provided, using defaults"),i={width:n.width,height:2400,depth:600,customColumnCount:Math.max(1,Math.floor(n.width/600)),columnMode:"custom",baseConfig:{type:"wall",placementType:"floor",floatHeight:0},materialConfig:{interior:"#FFFFFF",doorColor:"#E0E0E0"}});let r,s,o,a=null;if(i&&"_tempSlotWidths"in i&&i._tempSlotWidths)o=i._tempSlotWidths,r=o[0],s=o.length,console.log("🎯 [generateShelvingModules] _tempSlotWidths 사용:",{slotWidths:o,columnWidth:r,columnCount:s});else if(a=wr.calculateZoneSlotInfo(i,i.customColumnCount),(y=i.droppedCeiling)!=null&&y.enabled&&i.zone){const w=i.zone;console.log("🎯 [generateShelvingModules] Zone 정보 확인:",{zone:w,droppedCeilingEnabled:(v=i.droppedCeiling)==null?void 0:v.enabled,zoneSlotInfo:{dropped:a.dropped?{columnWidth:a.dropped.columnWidth,columnCount:a.dropped.columnCount}:null,normal:a.normal?{columnWidth:a.normal.columnWidth,columnCount:a.normal.columnCount}:null}}),w==="dropped"&&a.dropped?(r=a.dropped.columnWidth,s=a.dropped.columnCount,o=a.dropped.slotWidths,console.log("✅ [generateShelvingModules] 단내림 영역 사용:",{columnWidth:r,columnCount:s,slotWidths:o,zone:"dropped",internalSpaceWidth:n.width,internalSpaceHeight:n.height})):w==="normal"&&a.normal?(r=a.normal.columnWidth,s=a.normal.columnCount,o=a.normal.slotWidths,console.log("✅ [generateShelvingModules] 메인 영역 사용:",{columnWidth:r,columnCount:s,slotWidths:o,zone:"normal",internalSpaceWidth:n.width,internalSpaceHeight:n.height})):(console.warn("⚠️ [generateShelvingModules] Zone 정보는 있지만 해당 zone이 없음, fallback 사용:",{zone:w,availableZones:{dropped:!!a.dropped,normal:!!a.normal}}),r=a.normal.columnWidth,s=a.normal.columnCount,o=a.normal.slotWidths)}else r=a.normal.columnWidth,s=a.normal.columnCount,o=a.normal.slotWidths,console.log("✅ [generateShelvingModules] 일반 계산 사용:",{columnWidth:r,columnCount:s,slotWidths:o,zone:"none",internalSpaceWidth:n.width,internalSpaceHeight:n.height});console.log("🎯 [generateShelvingModules] 계산 결과:",{zone:i.zone,columnWidth:r,columnCount:s,slotWidths:o,zoneSlotInfo:a,droppedCeilingEnabled:(m=i.droppedCeiling)==null?void 0:m.enabled,internalSpaceWidth:n.width}),r>=680&&r<=720&&console.error("🚨🚨🚨 [generateShelvingModules] 700mm column calculated!",{spaceInfo:e,internalSpace:n,columnWidth:r,columnCount:s,zoneSlotInfo:a});const c=[];console.log("🎯 슬롯 너비 정보:",{zone:i.zone,columnWidth:r,columnCount:s,slotWidths:o,uniqueWidths:o?[...new Set(o)]:[]}),c.push(voe(r,t)),c.push(woe(r,t)),c.push(xoe(r,t));let h;o&&o.length>=2?h=o[0]+o[1]:h=r*2,console.log("🎯 듀얼 가구 생성 체크:",{dualWidth:h,internalSpaceWidth:n.width,willCreateDual:h<=n.width,zone:i.zone});const u=i.zone==="dropped";(h<=n.width||u)&&(c.push(boe(h,t)),c.push(_oe(h,t)),c.push(Coe(h,t)),c.push(Soe(h,t)),c.push(Toe(h,t)),c.push(joe(h)),c.push(Poe(h)),c.push(Noe(h)),c.push(Loe(h)),c.push(Moe(h)),c.push(Roe(h)));const d=Boe(r);console.log("🔨 상부장 1 생성:",{id:d.id,name:d.name,category:d.category,dimensions:d.dimensions}),c.push(d),c.push(koe(r)),c.push(Ioe(r)),c.push(Eoe(r));const f=Foe(r);console.log("🔨 하부장 생성:",{id:f.id,name:f.name,category:f.category,dimensions:f.dimensions}),c.push(f);const A=Doe(r);return console.log("🔨 하부장 2단형 생성:",{id:A.id,name:A.name,category:A.category,dimensions:A.dimensions}),c.push(A),console.log("📊 generateShelvingModules 최종 결과:",{totalModulesCount:c.length,categories:[...new Set(c.map(w=>w.category))],upperCount:c.filter(w=>w.category==="upper").length,lowerCount:c.filter(w=>w.category==="lower").length,fullCount:c.filter(w=>w.category==="full").length}),c},cI=(n,e)=>[...Ooe(n,e)],CQ=[],WS=(n,e,t)=>{console.log("🚨 [getModulesByCategory] Called with:",{category:n,internalSpace:e,spaceInfo:t?{width:t.width,customColumnCount:t.customColumnCount,columnMode:t.columnMode}:null});const i=cI(e,t),r=CQ,s=[...i,...r],o=s.filter(a=>a.category===n);return console.log("📦 [getModulesByCategory] 모듈 필터링 결과:",{category:n,allModulesCount:s.length,filteredCount:o.length,upperModules:s.filter(a=>a.category==="upper").map(a=>({id:a.id,name:a.name,category:a.category})),lowerModules:s.filter(a=>a.category==="lower").map(a=>({id:a.id,name:a.name,category:a.category})),allCategories:[...new Set(s.map(a=>a.category))],dynamicModulesCount:i.length,staticModulesCount:r.length}),o},Hi=(n,e,t)=>{var o;const i=n.replace(/-\d+$/,""),r=n.match(/-(\d+)$/),s=r?parseInt(r[1]):null;if(console.log("🔍 [getModuleById] 모듈 검색:",{id:n,baseType:i,requestedWidth:s,hasInternalSpace:!!e}),e){let a=t;if(s&&t)if(i.includes("dual-")){const d=Math.floor(s/2);a={...t,_tempSlotWidths:[d,s-d]}}else a={...t,_tempSlotWidths:[s]};t&&t.zone&&(a={...a,zone:t.zone},console.log("🔧 [getModuleById] Zone 정보 유지:",{zone:t.zone,modifiedSpaceInfo:{zone:a.zone,droppedCeilingEnabled:(o=a.droppedCeiling)==null?void 0:o.enabled}}));const h=cI(e,a).find(u=>u.id===n);if(h)return console.log("✅ [getModuleById] 모듈 찾음:",{id:h.id,width:h.dimensions.width}),h}return CQ.find(a=>a.id===n)},fj=(n,e,t,i)=>{const u=n.depth;let d;u>=500?d="deep":u===300?d="medium":d="shallow",console.log("🔍 analyzeColumnDepthPlacement 상세:",{columnId:n.id,columnDepth:u,DEPTH_THRESHOLD:500,columnType:d,isShallow:u<500,isColumnC:u===300});const f=n.position[0]-n.width*.01/2,A=n.position[0]+n.width*.01/2,g=Math.max(0,(f-t)*100),p=Math.max(0,(i-A)*100),y=730-u,v=u<500&&y>=200&&(g>=150||p>=150),m=u<150&&y>=580&&(g>=150||p>=150),w=g>=150&&p>=150;let x="single";return w&&(x="split-weighted"),console.log("🏛️ 기둥 깊이 기반 배치 분석:",{columnId:n.id,columnDepth:u,columnType:d,adjustedDepth:y,canPlaceSingle:v,canPlaceDual:m,canSplit:w,leftWidth:g.toFixed(1)+"mm",rightWidth:p.toFixed(1)+"mm",recommendedLayout:x}),{columnType:d,depthAdjustment:{canPlaceSingle:v,canPlaceDual:m,adjustedDepth:y,minDepthMet:y>=200},splitPlacement:{canSplit:w,leftWidth:g,rightWidth:p,recommendedLayout:x}}},Rc=n=>{var r,s,o,a,c,h,u;const e=ur(n),t=n.columns||[],i=[];if(n.surroundType==="no-surround"){for(let d=0;d<e.columnCount;d++){const f=e.threeUnitPositions[d],A=e.columnWidth*.01,g=f-A/2,p=f+A/2,y=t.find(v=>{const m=v.position[0]-v.width*.01/2,w=v.position[0]+v.width*.01/2;return m<p&&w>g});if(!y)i.push({slotIndex:d,hasColumn:!1,columnPosition:"edge",availableWidth:((r=e.slotWidths)==null?void 0:r[d])||e.columnWidth,doorWidth:((s=e.slotWidths)==null?void 0:s[d])||e.columnWidth,needsMullion:!1});else{const v=y.position[0]-y.width*.01/2,m=y.position[0]+y.width*.01/2,w=(v-g)*100,x=(p-m)*100,j=(()=>{const D=y.width,b=e.columnWidth;if(D>=b-0)return{availableWidth:0,intrusionDirection:"center",furniturePosition:"center",adjustedWidth:0};if(w<=x){const I=Math.max(0,x);return{availableWidth:I,intrusionDirection:"from-left",furniturePosition:"right-aligned",adjustedWidth:I}}else{const I=Math.max(0,w);return{availableWidth:I,intrusionDirection:"from-right",furniturePosition:"left-aligned",adjustedWidth:I}}})();i.push({slotIndex:d,hasColumn:!0,column:y,columnPosition:"edge",intrusionDirection:j.intrusionDirection,furniturePosition:j.furniturePosition,availableWidth:j.availableWidth,adjustedWidth:j.adjustedWidth,doorWidth:e.columnWidth-3,needsMullion:!1}),console.log("🏗️ 노서라운드 기둥 슬롯 정보:",{slotIndex:d,columnWidth:y.width,columnDepth:y.depth,intrusionDirection:j.intrusionDirection,availableWidth:j.availableWidth,originalSlotWidth:e.columnWidth})}}return i}if((o=n.droppedCeiling)!=null&&o.enabled){const d=wr.calculateZoneSlotInfo(n,n.customColumnCount),f=(((a=d.normal)==null?void 0:a.columnCount)||0)+(((c=d.dropped)==null?void 0:c.columnCount)||0);for(let A=0;A<f;A++){let g,p,y;if(A<(((h=d.normal)==null?void 0:h.columnCount)||0)?(g="normal",p=A,y=d.normal):(g="dropped",p=A-(((u=d.normal)==null?void 0:u.columnCount)||0),y=d.dropped),!y||!y.threeUnitPositions||p>=y.columnCount){i.push({slotIndex:A,hasColumn:!1,columnPosition:"edge",availableWidth:e.columnWidth,doorWidth:y.columnWidth-3,needsMullion:!1});continue}const v=y.threeUnitPositions[p],m=y.columnWidth*.01,w=v-m/2,x=v+m/2,T=t.find(q=>{const G=q.position[0]-q.width*.01/2,ie=q.position[0]+q.width*.01/2;return G<x&&ie>w});if(!T){i.push({slotIndex:A,hasColumn:!1,columnPosition:"edge",availableWidth:y.columnWidth,doorWidth:y.columnWidth-3,needsMullion:!1});continue}const j=T.position[0]-T.width*.01/2,D=T.position[0]+T.width*.01/2,b=(j-w)*100,_=(x-D)*100,S=(()=>{const q=T.width,G=y.columnWidth,ie=0;if(console.log("🏛️ 기둥 침범 방향 분석:",{slotIndex:A,zone:g,columnLeftX:j.toFixed(3),columnRightX:D.toFixed(3),slotStartX:w.toFixed(3),slotEndX:x.toFixed(3),leftGap:b.toFixed(1)+"mm",rightGap:_.toFixed(1)+"mm",columnWidthMm:q,slotWidthMm:G}),q>=G-ie)return console.log("🏛️ 기둥이 슬롯을 완전히 차지함"),{availableWidth:0,intrusionDirection:"center",furniturePosition:"center",adjustedWidth:0};if(b<=_){const H=Math.max(0,_);return console.log("🏛️ 기둥이 왼쪽 영역 침범 → 오른쪽 공간 사용:",{leftGap:b.toFixed(1)+"mm",rightGap:_.toFixed(1)+"mm",rightSpace:H.toFixed(1)+"mm"}),{availableWidth:H,intrusionDirection:"from-left",furniturePosition:"right-aligned",adjustedWidth:H}}else{const H=Math.max(0,b);return console.log("🏛️ 기둥이 오른쪽 영역 침범 → 왼쪽 공간 사용:",{leftGap:b.toFixed(1)+"mm",rightGap:_.toFixed(1)+"mm",leftSpace:H.toFixed(1)+"mm"}),{availableWidth:H,intrusionDirection:"from-right",furniturePosition:"left-aligned",adjustedWidth:H}}})(),F=S.availableWidth,B=b>10&&_>10&&F>0;let E;B&&(E=b>_?"right":"left");let V;V="edge";let K=S.adjustedWidth;try{const q=y.columnWidth*.01,G=y.threeUnitPositions[p],ie={left:G-q/2,right:G+q/2,center:G},H={slotIndex:A,hasColumn:!0,column:T,columnPosition:V,availableWidth:F,intrusionDirection:S.intrusionDirection,furniturePosition:S.furniturePosition,adjustedWidth:S.adjustedWidth};K=wu(H,ie,n).renderWidth,console.log("🔍 실제 배치 크기 미리 계산:",{slotIndex:A,zone:g,originalAdjustedWidth:S.adjustedWidth,actualRenderWidth:K,improvement:K>S.adjustedWidth?"개선됨":"동일/악화"})}catch(q){console.warn("⚠️ 실제 배치 크기 미리 계산 실패:",q)}let P,M,X,Z,Q=!1,U;const z=fj(T,y.columnWidth,w,x);P=z.columnType,P==="medium"?(M="depth-adjustment",X=z.depthAdjustment,Z=z.splitPlacement,Q=!1,console.log("🔵 기둥 C 감지 - 깊이 조정 방식:",{slotIndex:A,zone:g,columnDepth:T.depth,columnType:"C (300mm)",columnProcessingMethod:"depth-adjustment",availableWidth:S.availableWidth,adjustedDepth:z.depthAdjustment.adjustedDepth,canPlaceSingle:z.depthAdjustment.canPlaceSingle,canPlaceDual:z.depthAdjustment.canPlaceDual})):P==="shallow"?(M="depth-adjustment",X=z.depthAdjustment,Z=z.splitPlacement):M="width-adjustment",console.log("🔍 기둥 처리 방식 결정:",{slotIndex:A,zone:g,columnDepth:T.depth,columnType:P,columnProcessingMethod:M,allowMultipleFurniture:Q}),console.log("🏛️ 슬롯 분석 완료:",{slotIndex:A,zone:g,hasColumn:!0,columnPosition:V,availableWidth:S.availableWidth,actualRenderWidth:K,배치가능여부:K>=150?"✅ 배치 가능":"❌ 배치 불가",intrusionDirection:S.intrusionDirection,furniturePosition:S.furniturePosition,adjustedWidth:S.adjustedWidth,doorWidth:y.columnWidth-3,columnType:P,hasDepthAnalysis:P!==void 0}),i.push({slotIndex:A,hasColumn:!0,column:T,columnPosition:V,availableWidth:F,doorWidth:y.columnWidth-3,needsMullion:B,mullionSide:E,intrusionDirection:S.intrusionDirection,furniturePosition:S.furniturePosition,adjustedWidth:K,columnType:P,columnProcessingMethod:M,depthAdjustment:X,splitPlacement:Z,allowMultipleFurniture:Q,subSlots:U})}return i}else for(let d=0;d<e.columnCount;d++){const f=e.threeUnitPositions[d]-e.columnWidth*.01/2,A=e.threeUnitPositions[d]+e.columnWidth*.01/2,g=t.find(P=>{const M=P.position[0]-P.width*.01/2,X=P.position[0]+P.width*.01/2;return M<A&&X>f});if(!g){i.push({slotIndex:d,hasColumn:!1,columnPosition:"edge",availableWidth:e.columnWidth,doorWidth:e.columnWidth-3,needsMullion:!1});continue}const p=g.position[0]-g.width*.01/2,y=g.position[0]+g.width*.01/2,v=(p-f)*100,m=(A-y)*100,x=(()=>{const P=g.width,M=e.columnWidth,X=0;if(console.log("🏛️ 기둥 침범 방향 분석:",{slotIndex:d,columnLeftX:p.toFixed(3),columnRightX:y.toFixed(3),slotStartX:f.toFixed(3),slotEndX:A.toFixed(3),leftGap:v.toFixed(1)+"mm",rightGap:m.toFixed(1)+"mm",columnWidthMm:P,slotWidthMm:M}),P>=M-X)return console.log("🏛️ 기둥이 슬롯을 완전히 차지함"),{availableWidth:0,intrusionDirection:"center",furniturePosition:"center",adjustedWidth:0};if(v<=m){const Z=Math.max(0,m);return console.log("🏛️ 기둥이 왼쪽 영역 침범 → 오른쪽 공간 사용:",{leftGap:v.toFixed(1)+"mm",rightGap:m.toFixed(1)+"mm",rightSpace:Z.toFixed(1)+"mm"}),{availableWidth:Z,intrusionDirection:"from-left",furniturePosition:"right-aligned",adjustedWidth:Z}}else{const Z=Math.max(0,v);return console.log("🏛️ 기둥이 오른쪽 영역 침범 → 왼쪽 공간 사용:",{leftGap:v.toFixed(1)+"mm",rightGap:m.toFixed(1)+"mm",leftSpace:Z.toFixed(1)+"mm"}),{availableWidth:Z,intrusionDirection:"from-right",furniturePosition:"left-aligned",adjustedWidth:Z}}})(),T=x.availableWidth,j=v>10&&m>10&&T>0;let D;j&&(D=v>m?"right":"left");let b;b="edge";let _=x.adjustedWidth;try{const P=e.columnWidth*.01,M=e.threeUnitPositions[d],X={left:M-P/2,right:M+P/2,center:M},Z={slotIndex:d,hasColumn:!0,column:g,columnPosition:b,availableWidth:T,intrusionDirection:x.intrusionDirection,furniturePosition:x.furniturePosition,adjustedWidth:x.adjustedWidth};_=wu(Z,X,n).renderWidth,console.log("🔍 실제 배치 크기 미리 계산:",{slotIndex:d,originalAdjustedWidth:x.adjustedWidth,actualRenderWidth:_,improvement:_>x.adjustedWidth?"개선됨":"동일/악화"})}catch(P){console.warn("⚠️ 실제 배치 크기 미리 계산 실패:",P)}let I,S,F,B,E=!1,V;const K=fj(g,e.columnWidth,f,A);I=K.columnType,I==="medium"?(S="depth-adjustment",F=K.depthAdjustment,B=K.splitPlacement,E=!1,console.log("🔵 기둥 C 감지 - 깊이 조정 방식:",{slotIndex:d,columnDepth:g.depth,columnType:"C (300mm)",columnProcessingMethod:"depth-adjustment",availableWidth:x.availableWidth,adjustedDepth:K.depthAdjustment.adjustedDepth,canPlaceSingle:K.depthAdjustment.canPlaceSingle,canPlaceDual:K.depthAdjustment.canPlaceDual})):I==="shallow"?(S="depth-adjustment",F=K.depthAdjustment,B=K.splitPlacement):S="width-adjustment",console.log("🔍 기둥 처리 방식 결정:",{slotIndex:d,columnDepth:g.depth,columnType:I,columnProcessingMethod:S,allowMultipleFurniture:E}),console.log("🏛️ 슬롯 분석 완료:",{slotIndex:d,hasColumn:!0,columnPosition:b,availableWidth:x.availableWidth,actualRenderWidth:_,배치가능여부:_>=150?"✅ 배치 가능":"❌ 배치 불가",intrusionDirection:x.intrusionDirection,furniturePosition:x.furniturePosition,adjustedWidth:x.adjustedWidth,doorWidth:e.columnWidth-3,columnType:I,hasDepthAnalysis:I!==void 0}),i.push({slotIndex:d,hasColumn:!0,column:g,columnPosition:b,availableWidth:T,doorWidth:e.columnWidth-3,needsMullion:j,mullionSide:D,intrusionDirection:x.intrusionDirection,furniturePosition:x.furniturePosition,adjustedWidth:_,columnType:I,columnProcessingMethod:S,depthAdjustment:F,splitPlacement:B,allowMultipleFurniture:E,subSlots:V})}return i},Uoe=(n,e)=>{const i=ur(e).columnWidth*2;return Math.abs(n-i)<50},Hoe=(n,e,t)=>{if(!e.hasColumn)return{shouldConvert:!1};if(!Uoe(n.dimensions.width,t))return{shouldConvert:!1};const r=300;if(e.availableWidth<r)return console.log("⚠️ 듀얼 → 싱글 변환 불가: 공간 부족",{availableWidth:e.availableWidth,minRequiredWidth:r,slotIndex:e.slotIndex}),{shouldConvert:!1};const s={...n,id:n.id.replace("dual-","single-"),name:n.name.replace("듀얼","싱글"),dimensions:{...n.dimensions,width:e.availableWidth}},o=[e.slotIndex];return console.log("🔄 듀얼 → 싱글 변환:",{originalId:n.id,convertedId:s.id,originalWidth:n.dimensions.width,convertedWidth:s.dimensions.width,availableWidth:e.availableWidth,slotIndex:e.slotIndex,occupiedSlots:o,remainingSlotEmpty:e.slotIndex+1}),{shouldConvert:!0,convertedModuleData:s,occupiedSlots:o}},Woe=(n,e,t=!1)=>{if(!n.hasColumn)return!0;if(t)return console.log("🚫 기둥 침범 슬롯에는 듀얼 캐비넷 배치 불가:",{slotIndex:n.slotIndex,reason:"기둥 침범 시 싱글 캐비넷만 배치 가능"}),!1;const i=150,r=n.adjustedWidth||n.availableWidth,s=r>=i;return console.log("🏛️ 기둥 슬롯 배치 가능 여부 확인 (실제 크기 기준):",{slotIndex:n.slotIndex,hasColumn:n.hasColumn,availableWidth:n.availableWidth,adjustedWidth:n.adjustedWidth,actualRenderWidth:r,minRequiredWidth:i,originalFurnitureWidth:e,isDualFurniture:t,intrusionDirection:n.intrusionDirection,furniturePosition:n.furniturePosition,canPlace:s,reason:s?"✅ 배치 가능 (싱글 캐비넷만, 실제 크기 기준)":t?"🚫 듀얼 캐비넷 배치 금지":`❌ 실제 배치 크기(${r}mm)가 최소 필요 너비(${i}mm)보다 작음`}),s},SQ=n=>{if(!n.hasColumn)return"right";let e="right";switch(n.intrusionDirection){case"from-left":e="right";break;case"from-right":e="left";break;case"center":n.furniturePosition==="left-aligned"?e="left":n.furniturePosition==="right-aligned"&&(e="right");break;default:e="right"}return console.log("🚪 힌지 방향 계산:",{slotIndex:n.slotIndex,hasColumn:n.hasColumn,intrusionDirection:n.intrusionDirection,furniturePosition:n.furniturePosition,calculatedHinge:e,logic:n.intrusionDirection==="from-left"?"기둥이 왼쪽 침범 → 오른쪽 캐비넷 → 힌지 오른쪽 고정":n.intrusionDirection==="from-right"?"기둥이 오른쪽 침범 → 왼쪽 캐비넷 → 힌지 왼쪽 고정":n.intrusionDirection==="center"?`중앙 침범 → ${n.furniturePosition} → ${e} 힌지 (캐비넷 위치에 따라 고정)`:"기본값"}),e},wu=(n,e,t)=>{if(t.zone==="dropped"&&console.log("🔧 [calculateFurnitureBounds] 단내림 영역 - 기둥 처리 로직 적용"),!n.hasColumn||!n.column){const g=e.right-e.left;return{left:e.left,right:e.right,center:e.center,width:g*100,renderWidth:g*100}}const i=n.column,r=i.position[0]-i.width*.01/2,s=i.position[0]+i.width*.01/2,o=0;let a=e.left,c=e.right,h;switch(n.intrusionDirection){case"from-left":a=s,c=e.right,a=Math.max(a,e.left),c=Math.min(c,e.right);const g=c-a;g<.05&&(console.log("🚨 기둥 침범으로 인해 가구 크기가 너무 작아 배치 불가:",{currentWidth:(g*100).toFixed(1)+"mm",columnPosition:s.toFixed(3)}),a=e.left,c=e.left+.05),h=(c-a)*100,console.log("🏗️ 왼쪽 침범 - 기둥 충돌 방지 적용:",{columnPosition:s.toFixed(3),finalLeft:a.toFixed(3),finalRight:c.toFixed(3),gap:((a-s)*100).toFixed(1)+"mm",기둥충돌방지:a>s?"✅ 안전":"❌ 위험",newWidth:h.toFixed(1)+"mm",slotIndex:n.slotIndex});break;case"from-right":a=e.left,c=r,a=Math.max(a,e.left),c=Math.min(c,e.right);const p=c-a;p<.05&&(console.log("🚨 기둥 침범으로 인해 가구 크기가 너무 작아 배치 불가:",{currentWidth:(p*100).toFixed(1)+"mm",columnPosition:r.toFixed(3)}),c=e.right,a=e.right-.05),h=(c-a)*100,console.log("🏗️ 오른쪽 침범 - 기둥 충돌 방지 적용:",{columnPosition:r.toFixed(3),finalLeft:a.toFixed(3),finalRight:c.toFixed(3),gap:((r-c)*100).toFixed(1)+"mm",기둥충돌방지:c<r?"✅ 안전":"❌ 위험",newWidth:h.toFixed(1)+"mm",slotIndex:n.slotIndex});break;case"center":if(n.furniturePosition==="left-aligned"){a=e.left,c=Math.min(r-o,e.right),c=Math.min(c,e.right);const y=c-a;y<.05&&(console.log("🚨 중앙 침범으로 인해 가구 크기가 너무 작아 배치 불가:",{currentWidth:(y*100).toFixed(1)+"mm"}),a=e.left,c=e.left+.05)}else if(n.furniturePosition==="right-aligned"){a=Math.max(s+o,e.left),c=e.right,a=Math.max(a,e.left);const y=c-a;y<.05&&(console.log("🚨 중앙 침범으로 인해 가구 크기가 너무 작아 배치 불가:",{currentWidth:(y*100).toFixed(1)+"mm"}),c=e.right,a=e.right-.05)}else a=e.left,c=e.right;h=(c-a)*100,console.log("🏗️ 중앙 침범 - 슬롯 경계 제한 적용:",{position:n.furniturePosition,finalLeft:a,finalRight:c,slotBoundaryRespected:a>=e.left&&c<=e.right,newWidth:h,slotIndex:n.slotIndex});break;default:h=(e.right-e.left)*100}switch(n.intrusionDirection){case"from-left":c=e.right,a=Math.max(a,e.left);break;case"from-right":a=e.left,c=Math.min(c,e.right);break;default:a=Math.max(a,e.left),c=Math.min(c,e.right)}let u=(a+c)/2;if(n.hasColumn){u=(a+c)/2;const g=(c-a)/2;console.log("🎯 기둥 침범 시 가구 중심 계산:",{intrusionDirection:n.intrusionDirection,columnPos:n.column.position[0].toFixed(3),columnWidth:n.column.width,columnLeftX:(n.column.position[0]-n.column.width*.01/2).toFixed(3),columnRightX:(n.column.position[0]+n.column.width*.01/2).toFixed(3),furnitureLeft:a.toFixed(3),furnitureRight:c.toFixed(3),furnitureWidth:((c-a)*100).toFixed(1)+"mm",calculatedCenter:u.toFixed(3),originalSlotCenter:e.center.toFixed(3),centerOffset:((u-e.center)*100).toFixed(1)+"mm",검증:{가구왼쪽엣지:(u-g).toFixed(3),가구오른쪽엣지:(u+g).toFixed(3),기둥과의거리:n.intrusionDirection==="from-left"?((u-g-(n.column.position[0]+n.column.width*.01/2))*100).toFixed(1)+"mm":((n.column.position[0]-n.column.width*.01/2-(u+g))*100).toFixed(1)+"mm"}})}else{const g=(c-a)/2,p=e.left+g,y=e.right-g;u=Math.max(p,Math.min(y,u)),a=u-g,c=u+g}const d=(c-a)*100;let f=d;n.hasColumn?(f=d,console.log("🔧 기둥 침범 시 가구 크기 조정:",{originalWidth:(e.right-e.left)*100,adjustedWidth:f,intrusionDirection:n.intrusionDirection,columnType:n.columnType})):f=Math.max(d,150);let A=!1;if(n.columnType==="medium"&&n.column&&n.column.depth===300){const g=(e.right-e.left)*100,p=g-d;p>=150&&(A=!0,console.log("🟣 Column C 150mm 이상 침범 감지:",{slotWidth:g.toFixed(1)+"mm",availableWidth:d.toFixed(1)+"mm",intrusionAmount:p.toFixed(1)+"mm",depthAdjustmentNeeded:!0}))}return console.log("🏗️ 최종 가구 경계 (방향성 유지):",{intrusionDirection:n.intrusionDirection,slotBounds:{left:e.left.toFixed(3),right:e.right.toFixed(3),center:e.center.toFixed(3)},furnitureBounds:{left:a.toFixed(3),right:c.toFixed(3),center:u.toFixed(3)},width:f,columnType:n.columnType,depthAdjustmentNeeded:A,logic:n.intrusionDirection==="from-left"?"왼쪽 침범 → 오른쪽 경계 고정, 왼쪽만 조정":n.intrusionDirection==="from-right"?"오른쪽 침범 → 왼쪽 경계 고정, 오른쪽만 조정":"일반 케이스 → 양쪽 조정"}),{left:a,right:c,center:u,width:d,renderWidth:f,depthAdjustmentNeeded:A}},ci=Lm((n,e)=>({placedModules:[],selectedLibraryModuleId:null,selectedPlacedModuleId:null,selectedFurnitureId:null,isFurniturePlacementMode:!1,editMode:!1,editingModuleId:null,currentDragData:null,addModule:t=>{console.log("🟢🟢🟢 [Store] addModule 함수 진입!!!",{id:t.id,moduleId:t.moduleId,slotIndex:t.slotIndex,isDualSlot:t.isDualSlot,position:t.position});const r=e().placedModules,s=t.slotIndex,o=t.zone,a=t.isDualSlot;let c=s;if(c==null){console.warn("⚠️ [Store] slotIndex가 undefined! position으로부터 계산 시도:",{position:t.position,zone:o});const d=qi.getState().spaceInfo,f=ur(d);if(f&&f.threeUnitPositions){let A=1/0,g=0;for(let p=0;p<f.threeUnitPositions.length;p++){const y=Math.abs(t.position.x-f.threeUnitPositions[p]);y<A&&(A=y,g=p)}c=g,console.log("📍 [Store] position으로부터 slotIndex 계산:",{positionX:t.position.x,calculatedSlotIndex:c,minDistance:A})}}if(console.log("🔍 [Store] 충돌 검사 시작:",{새가구:{id:t.id,slotIndex:c,isDualSlot:a,zone:o,점유슬롯:a?[c,c+1]:[c]},기존가구수:r.length}),r.some(d=>{let f=d.slotIndex;if(f==null){const A=qi.getState().spaceInfo,g=ur(A);if(g&&g.threeUnitPositions){let p=1/0,y=0;for(let v=0;v<g.threeUnitPositions.length;v++){const m=Math.abs(d.position.x-g.threeUnitPositions[v]);m<p&&(p=m,y=v)}f=y}}if(o!==void 0&&d.zone!==void 0&&o!==d.zone)return!1;if(a){const A=f===c||f===c+1||d.isDualSlot&&(f+1===c||f+1===c+1);return A&&console.log("❌ [Store] 듀얼 가구 충돌 감지:",{새가구_점유:[c,c+1],기존가구:{id:d.id,slotIndex:f,isDualSlot:d.isDualSlot}}),A}else{const A=f===c||d.isDualSlot&&f+1===c;return A&&console.log("❌ [Store] 싱글 가구 충돌 감지:",{새가구_점유:[c],기존가구:{id:d.id,slotIndex:f,isDualSlot:d.isDualSlot}}),A}})){console.error("🚫🚫🚫 [Store] 슬롯 충돌로 가구 추가 거부!",{moduleId:t.moduleId,slotIndex:c,zone:o});return}const u={...t,slotIndex:c};n(d=>{const f=[...d.placedModules,u];return console.log("✅ [Store] 가구 추가 완료:",f.map(A=>({id:A.id,moduleId:A.moduleId,slotIndex:A.slotIndex,isDualSlot:A.isDualSlot}))),{placedModules:f}})},removeModule:t=>{n(i=>({placedModules:i.placedModules.filter(r=>r.id!==t)}))},moveModule:(t,i)=>{const r=e(),s=r.placedModules.find(u=>u.id===t);if(!s){console.error("이동할 가구를 찾을 수 없습니다:",t);return}const o=qi.getState().spaceInfo,a=ur(o);let c=s.slotIndex;if(a&&a.threeUnitPositions){let u=1/0,d=0;for(let f=0;f<a.threeUnitPositions.length;f++){const A=Math.abs(i.x-a.threeUnitPositions[f]);A<u&&(u=A,d=f)}c=d}if(r.placedModules.some(u=>{if(u.id===t)return!1;let d=u.slotIndex;if(d==null&&a&&a.threeUnitPositions){let f=1/0,A=0;for(let g=0;g<a.threeUnitPositions.length;g++){const p=Math.abs(u.position.x-a.threeUnitPositions[g]);p<f&&(f=p,A=g)}d=A}return s.zone!==void 0&&u.zone!==void 0&&s.zone!==u.zone?!1:s.isDualSlot?d===c||d===c+1||u.isDualSlot&&(d+1===c||d+1===c+1):d===c||u.isDualSlot&&d+1===c})){console.error("🚫 이동 위치에 이미 가구가 있습니다!");return}n(u=>({placedModules:u.placedModules.map(d=>d.id===t?{...d,position:i,slotIndex:c}:d)}))},updatePlacedModule:(t,i)=>{if(console.log("📦 updatePlacedModule 호출:",{id:t,updates:i,hasPosition:!!i.position,position:i.position,hasSlotIndex:i.slotIndex!==void 0}),i.position||i.slotIndex!==void 0){const r=e(),s=r.placedModules.find(a=>a.id===t);if(!s){console.error("업데이트할 가구를 찾을 수 없습니다:",t);return}let o=i.slotIndex;if(o===void 0&&i.position){const a=qi.getState().spaceInfo,c=ur(a);if(c&&c.threeUnitPositions){let h=1/0,u=0;for(let d=0;d<c.threeUnitPositions.length;d++){const f=Math.abs(i.position.x-c.threeUnitPositions[d]);f<h&&(h=f,u=d)}o=u}}if(o!==void 0&&o!==s.slotIndex){const a={...s,...i};if(r.placedModules.some(h=>{if(h.id===t)return!1;let u=h.slotIndex;if(u==null){const f=qi.getState().spaceInfo,A=ur(f);if(A&&A.threeUnitPositions){let g=1/0,p=0;for(let y=0;y<A.threeUnitPositions.length;y++){const v=Math.abs(h.position.x-A.threeUnitPositions[y]);v<g&&(g=v,p=y)}u=p}}const d=a.zone;return d!==void 0&&h.zone!==void 0&&d!==h.zone?!1:a.isDualSlot?u===o||u===o+1||h.isDualSlot&&(u+1===o||u+1===o+1):u===o||h.isDualSlot&&u+1===o})){console.error("🚫 업데이트 위치에 이미 가구가 있습니다!");return}i={...i,slotIndex:o}}}n(r=>({placedModules:r.placedModules.map(s=>s.id===t?{...s,...i}:s)}))},clearAllModules:()=>{const t=e().placedModules;console.log("🔴 [FURNITURE STORE] clearAllModules 호출:",{previousCount:t.length,previousModules:t.map(i=>({id:i.id,name:i.name,slotIndex:i.slotIndex}))}),console.trace("🔴 [TRACE] clearAllModules 호출 스택"),n({placedModules:[]})},setPlacedModules:t=>{const i=e().placedModules,r=typeof t=="function"?t(i):t;console.log("🔴 [FURNITURE STORE] setPlacedModules 호출:",{previousCount:i.length,newCount:r.length,isFunction:typeof t=="function",newModules:r.map(s=>({id:s.id,name:s.name,slotIndex:s.slotIndex})),previousModules:i.map(s=>({id:s.id,name:s.name,slotIndex:s.slotIndex}))}),console.trace("🔴 [TRACE] setPlacedModules 호출 스택"),n({placedModules:r})},setSelectedLibraryModuleId:t=>{n({selectedLibraryModuleId:t})},setSelectedPlacedModuleId:t=>{n({selectedPlacedModuleId:t})},setSelectedFurnitureId:t=>{n({selectedFurnitureId:t})},clearAllSelections:()=>{n({selectedLibraryModuleId:null,selectedPlacedModuleId:null,selectedFurnitureId:null})},setFurniturePlacementMode:t=>{n({isFurniturePlacementMode:t})},setEditMode:t=>{n({editMode:t})},setEditingModuleId:t=>{n({editingModuleId:t})},exitEditMode:()=>{n({editMode:!1,editingModuleId:null})},setCurrentDragData:t=>{n({currentDragData:t})},clearDragData:()=>{n({currentDragData:null})},isDirty:!1,setIsDirty:t=>n({isDirty:t}),resetAll:()=>{const t=e().placedModules;console.log("🔴 [FURNITURE STORE] resetAll 호출:",{previousCount:t.length,previousModules:t.map(i=>({id:i.id,name:i.name,slotIndex:i.slotIndex}))}),console.trace("🔴 [TRACE] resetAll 호출 스택"),n({placedModules:[],selectedLibraryModuleId:null,selectedPlacedModuleId:null,selectedFurnitureId:null,isFurniturePlacementMode:!1,editMode:!1,editingModuleId:null,currentDragData:null,isDirty:!1})},markAsSaved:()=>n({isDirty:!1}),setAllDoors:t=>{console.log("🚪 setAllDoors 호출:",{hasDoor:t,currentModulesCount:e().placedModules.length,currentModules:e().placedModules.map(i=>({id:i.id,hasDoor:i.hasDoor}))}),n(i=>{const r=i.placedModules.map(s=>({...s,hasDoor:t}));return console.log("🚪 setAllDoors 완료:",{updatedModulesCount:r.length,updatedModules:r.map(s=>({id:s.id,hasDoor:s.hasDoor}))}),{placedModules:r}})},updateFurnitureForColumns:t=>{n(i=>{var d,f,A,g;console.log("🔧 updateFurnitureForColumns 호출:",{surroundType:t.surroundType,columnCount:((d=t.columns)==null?void 0:d.length)||0,columns:(f=t.columns)==null?void 0:f.map(p=>({id:p.id,position:p.position,depth:p.depth})),customColumnCount:t.customColumnCount,mainDoorCount:t.mainDoorCount,droppedCeilingDoorCount:t.droppedCeilingDoorCount});let r=0;if((A=t.droppedCeiling)!=null&&A.enabled){const p=t.mainDoorCount||t.customColumnCount||3,y=t.droppedCeilingDoorCount||1;r=p+y}else r=t.customColumnCount||3;console.log("📐 현재 총 컬럼 수:",r);const s=Rc(t);console.log("🔧 analyzeColumnSlots 결과:",s);const a=ur(t).columnWidth,c=[],u=i.placedModules.map(p=>{var j,D,b,_,I,S,F,B,E,V,K;const y=p.baseModuleType||((j=p.moduleId)==null?void 0:j.replace(/-\d+$/,""));if(y&&p.moduleId){let P=a;if(p.zone&&((D=t.droppedCeiling)!=null&&D.enabled)){const Z=wr.calculateZoneSlotInfo(t,t.customColumnCount);p.zone==="dropped"&&Z.dropped?P=Z.dropped.columnWidth:p.zone==="normal"&&Z.normal&&(P=Z.normal.columnWidth)}const M=y.includes("dual-"),X=M?`${y}-${Math.round(P*2)}`:`${y}-${Math.round(P)}`;X!==p.moduleId&&console.log("📦 가구 moduleId 업데이트:",{baseType:y,oldId:p.moduleId,newId:X,zone:p.zone,targetColumnWidth:P,isDualFurniture:M}),p={...p,moduleId:X,moduleWidth:M?P*2:P}}if(p.slotIndex===void 0)return p;let v=r-1;if(p.zone&&((b=t.droppedCeiling)!=null&&b.enabled)&&(p.zone==="dropped"?v=(t.droppedCeilingDoorCount||1)-1:v=(t.mainDoorCount||t.customColumnCount||3)-1),p.slotIndex>v)return console.log(`🚫 가구 ${p.id} 제거 예정 - 컬럼 수 초과 (슬롯 ${p.slotIndex} > 최대 ${v})`),c.includes(p.id)||c.push(p.id),p;const m=p.isDualSlot||((_=p.moduleId)==null?void 0:_.includes("dual-"));if(m&&p.slotIndex+1>v)return console.log(`🚫 듀얼 가구 ${p.id} 제거 예정 - 두 번째 슬롯이 컬럼 수 초과`),c.includes(p.id)||c.push(p.id),p;let w=p.slotIndex;if(p.zone&&((I=t.droppedCeiling)!=null&&I.enabled)){const P=wr.calculateZoneSlotInfo(t,t.customColumnCount);p.zone==="dropped"&&P.dropped&&(w=P.normal.columnCount+p.slotIndex)}const x=s[w];if(!x)return console.log(`🚫 가구 ${p.id} 제거 예정 - 슬롯 정보 없음 (globalSlotIndex: ${w})`),c.includes(p.id)||c.push(p.id),p;let T=null;if(m&&(T=s[w+1],!T))return console.log(`🚫 듀얼 가구 ${p.id} 제거 예정 - 두 번째 슬롯 없음`),c.includes(p.id)||c.push(p.id),p;if(console.log(`🔧 가구 ${p.id} (슬롯 ${p.slotIndex} → ${w}):`,{isDualFurniture:m,hasColumn:x==null?void 0:x.hasColumn,availableWidth:x==null?void 0:x.availableWidth,adjustedWidth:x==null?void 0:x.adjustedWidth,intrusionDirection:x==null?void 0:x.intrusionDirection,secondSlotHasColumn:T==null?void 0:T.hasColumn}),m&&(x!=null&&x.hasColumn||T!=null&&T.hasColumn))return console.log(`🚫 듀얼 가구 ${p.id} 제거 예정 - 기둥 침범`),c.includes(p.id)||c.push(p.id),p;if(!m&&(x!=null&&x.hasColumn)){const P=x.adjustedWidth||x.availableWidth;console.log(`✅ 가구 ${p.id} adjustedWidth 설정: ${P}mm`);const M=ur(t);let X=p.position.x;if(p.zone&&((S=t.droppedCeiling)!=null&&S.enabled)){const q=wr.calculateZoneSlotInfo(t,t.customColumnCount),G=p.zone==="dropped"&&q.dropped?q.dropped:q.normal;if(p.slotIndex!==void 0&&p.slotIndex<G.columnCount){const ie=p.zone==="dropped"&&((F=M.zones)!=null&&F.dropped)?M.zones.dropped:p.zone==="normal"&&((B=M.zones)!=null&&B.normal)?M.zones.normal:M;ie.threeUnitPositions&&ie.threeUnitPositions[p.slotIndex]!==void 0&&(X=ie.threeUnitPositions[p.slotIndex])}}else p.slotIndex!==void 0&&M.threeUnitPositions&&M.threeUnitPositions[p.slotIndex]!==void 0&&(X=M.threeUnitPositions[p.slotIndex]);const Z=M.columnWidth*.01,Q={left:X-Z/2,right:X+Z/2,center:X},z=(x?wu(x,Q,t):Q).center;return{...p,adjustedWidth:P,position:{...p.position,x:z}}}else{if(p.adjustedWidth!==void 0){console.log(`❌ 가구 ${p.id} adjustedWidth 제거 및 위치 복원`);const P=ur(t);let M=p.position.x;if(p.zone&&((E=t.droppedCeiling)!=null&&E.enabled)){const X=wr.calculateZoneSlotInfo(t,t.customColumnCount),Z=p.zone==="dropped"&&X.dropped?X.dropped:X.normal;if(p.slotIndex!==void 0&&p.slotIndex<Z.columnCount){const Q=p.zone==="dropped"&&((V=P.zones)!=null&&V.dropped)?P.zones.dropped:p.zone==="normal"&&((K=P.zones)!=null&&K.normal)?P.zones.normal:P;Q.threeUnitPositions&&Q.threeUnitPositions[p.slotIndex]!==void 0&&(M=Q.threeUnitPositions[p.slotIndex])}}else p.slotIndex!==void 0&&P.threeUnitPositions&&P.threeUnitPositions[p.slotIndex]!==void 0&&(M=P.threeUnitPositions[p.slotIndex]);return{...p,adjustedWidth:void 0,position:{...p.position,x:M}}}return{...p,adjustedWidth:void 0}}}).filter(p=>!c.includes(p.id));return console.log("🔧 기둥 변경에 따른 가구 업데이트 완료:",{columnCount:((g=t.columns)==null?void 0:g.length)||0,removedDualFurniture:c,updatedFurniture:u.filter(p=>p.adjustedWidth!==void 0).map(p=>({id:p.id,slotIndex:p.slotIndex,adjustedWidth:p.adjustedWidth}))}),c.length>0&&console.log(`⚠️ ${c.length}개의 가구가 제거되었습니다:`,{removedModules:c,reasons:"컬럼 수 초과 또는 기둥 침범"}),{placedModules:u}})},updateFurnitureYPositions:t=>{n(i=>{var s,o;console.log("📍 updateFurnitureYPositions 호출:",{placementType:(s=t.baseConfig)==null?void 0:s.placementType,floatHeight:(o=t.baseConfig)==null?void 0:o.floatHeight,furnitureCount:i.placedModules.length});const r=i.placedModules.map(a=>({...a,_lastYUpdate:Date.now()}));return console.log("📍 Y 위치 업데이트 완료 - 가구 리렌더링 트리거"),{placedModules:r}})}})),Au={WIDTH:3600,HEIGHT:2400,DEPTH:1500},n0={LEFT:50,RIGHT:50,TOP:10},L_={HEIGHT:65,FLOOR_FINISH_HEIGHT:9},M0={INTERIOR_COLOR:"#FFFFFF",DOOR_COLOR:"#E0E0E0"},yo={WIDTH:1300,DROP_HEIGHT:200,POSITION:"right"},Xl={WIDTH:{MIN:1200,MAX:8e3},HEIGHT:{MIN:2010,MAX:2410}},xp={DEPTH:{MIN:130,MAX:780,DEFAULT_FALLBACK:580}},Qoe={width:Au.WIDTH,height:Au.HEIGHT,depth:Au.DEPTH,installType:"builtin",wallConfig:{left:!0,right:!0},hasFloorFinish:!1,floorFinish:{height:L_.FLOOR_FINISH_HEIGHT},surroundType:"surround",frameSize:{left:50,right:50,top:10},gapConfig:{left:2,right:2},baseConfig:{type:"floor",height:L_.HEIGHT,placementType:"ground",floatHeight:200},materialConfig:{interiorColor:M0.INTERIOR_COLOR,doorColor:M0.DOOR_COLOR},droppedCeiling:{enabled:!1,position:yo.POSITION,width:yo.WIDTH,dropHeight:yo.DROP_HEIGHT},mainDoorCount:0,droppedCeilingDoorCount:0},QS={isDirty:!1,spaceInfo:Qoe},qi=Lm()(n=>({...QS,setSpaceInfo:e=>{n(t=>{var a,c,h,u,d,f,A,g,p,y,v;const i={...e};i.installType==="built-in"&&(i.installType="builtin"),(a=i.droppedCeiling)!=null&&a.enabled&&(!i.droppedCeiling.width||!i.droppedCeiling.dropHeight)&&(i.droppedCeiling={...i.droppedCeiling,width:i.droppedCeiling.width||yo.WIDTH,dropHeight:i.droppedCeiling.dropHeight||yo.DROP_HEIGHT});const r={spaceInfo:{...t.spaceInfo,...i},isDirty:!0};i.wallConfig&&console.log("🏪 SpaceConfigStore - wallConfig 업데이트:",{이전:t.spaceInfo.wallConfig,새로운:i.wallConfig,최종:r.spaceInfo.wallConfig});const s=i.customColumnCount!==void 0&&i.customColumnCount!==t.spaceInfo.customColumnCount||i.mainDoorCount!==void 0&&i.mainDoorCount!==t.spaceInfo.mainDoorCount||i.droppedCeilingDoorCount!==void 0&&i.droppedCeilingDoorCount!==t.spaceInfo.droppedCeilingDoorCount||i.width!==void 0&&i.width!==t.spaceInfo.width||i.surroundType!==void 0&&i.surroundType!==t.spaceInfo.surroundType||i.frameSize!==void 0;return(((c=i.baseConfig)==null?void 0:c.placementType)!==void 0&&((h=i.baseConfig)==null?void 0:h.placementType)!==((u=t.spaceInfo.baseConfig)==null?void 0:u.placementType)||((d=i.baseConfig)==null?void 0:d.floatHeight)!==void 0&&((f=i.baseConfig)==null?void 0:f.floatHeight)!==((A=t.spaceInfo.baseConfig)==null?void 0:A.floatHeight))&&(console.log("🎯 띄워서 배치 설정 변경 감지:",{이전:{placementType:(g=t.spaceInfo.baseConfig)==null?void 0:g.placementType,floatHeight:(p=t.spaceInfo.baseConfig)==null?void 0:p.floatHeight},새로운:{placementType:(y=i.baseConfig)==null?void 0:y.placementType,floatHeight:(v=i.baseConfig)==null?void 0:v.floatHeight}}),setTimeout(()=>{const{updateFurnitureYPositions:m}=ci.getState();m(r.spaceInfo)},0)),s&&(console.log("📐 컬럼 수 변경 감지:",{이전:{customColumnCount:t.spaceInfo.customColumnCount,mainDoorCount:t.spaceInfo.mainDoorCount,droppedCeilingDoorCount:t.spaceInfo.droppedCeilingDoorCount},새로운:{customColumnCount:i.customColumnCount,mainDoorCount:i.mainDoorCount,droppedCeilingDoorCount:i.droppedCeilingDoorCount}}),setTimeout(()=>{const{updateFurnitureForColumns:m}=ci.getState();m(r.spaceInfo)},0)),r})},resetSpaceInfo:()=>n({spaceInfo:QS.spaceInfo,isDirty:!0}),resetMaterialConfig:()=>n(e=>({spaceInfo:{...e.spaceInfo,materialConfig:{...e.spaceInfo.materialConfig}},isDirty:!0})),setColumns:e=>n(t=>({spaceInfo:{...t.spaceInfo,columns:e},isDirty:!0})),addColumn:e=>n(t=>{const o=t.spaceInfo.columns||[];for(const c of o){if(!c.position||!e.position)continue;if(Math.abs(c.position[0]-e.position[0])<2.999)return t}const a={spaceInfo:{...t.spaceInfo,columns:[...o,e]},isDirty:!0};return setTimeout(()=>{const{updateFurnitureForColumns:c}=ci.getState();c(a.spaceInfo)},0),a}),removeColumn:e=>n(t=>{const i={spaceInfo:{...t.spaceInfo,columns:(t.spaceInfo.columns||[]).filter(r=>r.id!==e)},isDirty:!0};return setTimeout(()=>{const{updateFurnitureForColumns:r}=ci.getState();r(i.spaceInfo)},0),i}),updateColumn:(e,t)=>n(i=>{if(t.position){const c=(i.spaceInfo.columns||[]).filter(h=>h.id!==e);for(const h of c){if(!h.position)continue;if(Math.abs(h.position[0]-t.position[0])<2.999)return i}}const r={spaceInfo:{...i.spaceInfo,columns:(i.spaceInfo.columns||[]).map(s=>s.id===e?{...s,...t}:s)},isDirty:!0};return setTimeout(()=>{const{updateFurnitureForColumns:s}=ci.getState();s(r.spaceInfo)},0),r}),setWalls:e=>n(t=>({spaceInfo:{...t.spaceInfo,walls:e},isDirty:!0})),addWall:e=>n(t=>({spaceInfo:{...t.spaceInfo,walls:[...t.spaceInfo.walls||[],e]},isDirty:!0})),removeWall:e=>n(t=>({spaceInfo:{...t.spaceInfo,walls:(t.spaceInfo.walls||[]).filter(i=>i.id!==e)},isDirty:!0})),updateWall:(e,t)=>n(i=>({spaceInfo:{...i.spaceInfo,walls:(i.spaceInfo.walls||[]).map(r=>r.id===e?{...r,...t}:r)},isDirty:!0})),setPanelBs:e=>n(t=>({spaceInfo:{...t.spaceInfo,panelBs:e},isDirty:!0})),addPanelB:e=>n(t=>({spaceInfo:{...t.spaceInfo,panelBs:[...t.spaceInfo.panelBs||[],e]},isDirty:!0})),removePanelB:e=>n(t=>({spaceInfo:{...t.spaceInfo,panelBs:(t.spaceInfo.panelBs||[]).filter(i=>i.id!==e)},isDirty:!0})),updatePanelB:(e,t)=>n(i=>({spaceInfo:{...i.spaceInfo,panelBs:(i.spaceInfo.panelBs||[]).map(r=>r.id===e?{...r,...t}:r)},isDirty:!0})),resetAll:()=>n({...QS,isDirty:!1}),markAsSaved:()=>n({isDirty:!1})})),$oe=O.createContext(null),Voe=({children:n})=>{const e=xc(),{showConfirm:t,ConfirmComponent:i}=doe(),r=Ha(f=>f.isDirty),s=qi(f=>f.isDirty),o=ci(f=>f.isDirty),a=Ha(f=>f.resetAll),c=qi(f=>f.resetAll),h=ci(f=>f.resetAll),u=r||s||o,d=O.useCallback(async(f,A)=>{if(A!=null&&A.force){e(f);return}u?await t(`저장하지 않은 변경사항이 있습니다.
정말로 페이지를 떠나시겠습니까?`,{title:"변경사항 저장 안 됨",confirmText:"떠나기",cancelText:"머무르기"})&&(a(),c(),h(),e(f)):e(f)},[u,t,e,a,c,h]);return l.jsxs($oe.Provider,{value:{navigate:d},children:[l.jsx(i,{}),n]})};class UB extends Error{constructor(e,t,i,r=500){super(t),this.code=e,this.userMessage=t,this.technicalMessage=i,this.statusCode=r,this.name="AppError"}}const zoe={"auth/user-not-found":"사용자를 찾을 수 없습니다.","auth/wrong-password":"비밀번호가 올바르지 않습니다.","auth/email-already-in-use":"이미 사용 중인 이메일입니다.","auth/weak-password":"비밀번호가 너무 약합니다.","auth/invalid-email":"올바르지 않은 이메일 형식입니다.","auth/user-disabled":"비활성화된 계정입니다.","auth/operation-not-allowed":"허용되지 않은 작업입니다.","auth/requires-recent-login":"최근 로그인이 필요합니다.","auth/network-request-failed":"네트워크 연결을 확인해주세요.","auth/too-many-requests":"너무 많은 요청이 발생했습니다. 잠시 후 다시 시도해주세요.","permission-denied":"접근 권한이 없습니다.","not-found":"요청한 리소스를 찾을 수 없습니다.","already-exists":"이미 존재하는 데이터입니다.","resource-exhausted":"요청 한도를 초과했습니다.","failed-precondition":"사전 조건을 충족하지 못했습니다.",aborted:"작업이 중단되었습니다.","out-of-range":"유효하지 않은 범위입니다.",unimplemented:"구현되지 않은 기능입니다.",internal:"내부 서버 오류가 발생했습니다.",unavailable:"서비스를 일시적으로 사용할 수 없습니다.","data-loss":"데이터 손실이 발생했습니다.",unauthenticated:"로그인이 필요합니다.",cancelled:"작업이 취소되었습니다.","deadline-exceeded":"요청 시간이 초과되었습니다.","invalid-argument":"잘못된 인수가 제공되었습니다.","team/member-limit-exceeded":"팀 멤버 수 제한을 초과했습니다.","team/invitation-expired":"초대가 만료되었습니다.","team/already-member":"이미 팀 멤버입니다.","project/max-limit-exceeded":"프로젝트 생성 한도를 초과했습니다.","project/invalid-share-permission":"올바르지 않은 공유 권한입니다.","storage/upload-failed":"파일 업로드에 실패했습니다.","storage/file-too-large":"파일 크기가 너무 큽니다."},Goe=n=>{console.error("🔥 Firebase Error:",n);let e="unknown",t="Unknown error";if(n instanceof Nu)e=n.code,t=n.message;else if(n.code)e=n.code,t=n.message;else{if(n instanceof UB)return n;n instanceof Error&&(t=n.message,e="app/generic-error")}const i=zoe[e]||"알 수 없는 오류가 발생했습니다. 문제가 지속되면 관리자에게 문의해주세요.";return Xoe(e,i,t,n),new UB(e,i,t)},Xoe=(n,e,t,i)=>{const r={timestamp:new Date().toISOString(),code:n,userMessage:e,technicalMessage:t,stack:i==null?void 0:i.stack,userAgent:navigator.userAgent,url:window.location.href,userId:null};console.error("📊 Error logged:",r)},Yw=(n,e,t)=>new UB(n,e,t,400),Cm="teams",rv="teamInvitations",Koe=async(n,e,t)=>{try{console.log("🔑 Firebase 팀 생성 시작:",{name:n,description:e});const i=await mr();if(!i)throw Yw("auth/unauthenticated","로그인이 필요합니다.");if(!n.trim()||n.length<2)throw Yw("team/invalid-name","팀 이름은 2글자 이상이어야 합니다.");if(n.length>50)throw Yw("team/invalid-name","팀 이름은 50글자를 초과할 수 없습니다.");console.log("✅ 사용자 인증 성공:",{uid:i.uid,email:i.email});const r=await $W(Ri,async s=>{const o=ph(Ua(Ri,Cm),Ca("ownerId","==",i.uid));if((await Mu(o)).size>=10)throw Yw("team/limit-exceeded","최대 10개의 팀만 생성할 수 있습니다.");const c={isPublic:!1,allowInvitations:!0,defaultRole:"viewer",maxMembers:50,...t},h={userId:i.uid,email:i.email||"",displayName:i.displayName,photoURL:i.photoURL,role:"owner",joinedAt:Ps.fromDate(new Date),status:"active"},u=Tr(Ua(Ri,Cm)),d={name:n.trim(),description:e==null?void 0:e.trim(),ownerId:i.uid,members:[h],settings:c,createdAt:Ks(),updatedAt:Ks()};s.set(u,d);const f=Tr(Ua(Ri,"activityLogs"));return s.set(f,{userId:i.uid,resourceType:"team",resourceId:u.id,action:"create",metadata:{teamName:n.trim()},timestamp:Ks()}),u.id});return console.log("✅ 팀 생성 완료:",{teamId:r}),{teamId:r,error:null}}catch(i){return console.error("❌ 팀 생성 에러:",i),{teamId:null,error:Goe(i).userMessage}}},TQ=async()=>{try{console.log("🔍 사용자 팀 목록 조회 시작...");const n=await mr();if(!n)return console.error("❌ 사용자 인증 실패"),{teams:[],error:"로그인이 필요합니다."};console.log("✅ 사용자 인증 성공:",{uid:n.uid,email:n.email});const e=await Mu(Ua(Ri,Cm)),t=[];return console.log(`📄 총 ${e.size}개의 팀 문서 발견`),e.forEach(i=>{var o,a;const r=i.data();console.log("🔍 팀 문서 확인:",{id:i.id,name:r.name,membersCount:(o=r.members)==null?void 0:o.length});const s=(a=r.members)==null?void 0:a.some(c=>c.userId===n.uid);if(console.log(`👤 멤버 확인 (${r.name}):`,{isMember:s,userId:n.uid}),s){console.log("✅ 사용자가 속한 팀 발견:",r.name);const c=r.members.map(h=>h.userId===n.uid?{...h,displayName:n.displayName||h.displayName,photoURL:n.photoURL||h.photoURL,email:n.email||h.email}:h);t.push({id:i.id,...r,members:c})}}),console.log(`📊 사용자가 속한 팀 개수: ${t.length}`),t.sort((i,r)=>{var a,c;const s=((a=i.updatedAt)==null?void 0:a.seconds)||0;return(((c=r.updatedAt)==null?void 0:c.seconds)||0)-s}),{teams:t,error:null}}catch(n){return console.error("팀 목록 가져오기 에러:",n),{teams:[],error:"팀 목록을 가져오는 중 오류가 발생했습니다."}}},M_=async n=>{try{const e=await mr();if(!e)return{team:null,error:"로그인이 필요합니다."};const t=Tr(Ri,Cm,n),i=await Kh(t);if(!i.exists())return{team:null,error:"팀을 찾을 수 없습니다."};const r=i.data(),s=r.members.map(c=>c.userId===e.uid?{...c,displayName:e.displayName||c.displayName,photoURL:e.photoURL||c.photoURL,email:e.email||c.email}:c),o={id:i.id,...r,members:s};return o.members.some(c=>c.userId===e.uid)?{team:o,error:null}:{team:null,error:"팀에 접근할 권한이 없습니다."}}catch(e){return console.error("팀 정보 가져오기 에러:",e),{team:null,error:"팀 정보를 가져오는 중 오류가 발생했습니다."}}},qoe=async(n,e,t)=>{try{const i=await mr();if(!i)return{invitationId:null,error:"로그인이 필요합니다."};const{team:r,error:s}=await M_(n);if(s||!r)return{invitationId:null,error:s||"팀을 찾을 수 없습니다."};const o=r.members.find(g=>g.userId===i.uid);if(!o||o.role!=="owner"&&o.role!=="admin")return{invitationId:null,error:"팀 멤버를 초대할 권한이 없습니다."};if(r.members.some(g=>g.email===e))return{invitationId:null,error:"이미 팀 멤버입니다."};const c=ph(Ua(Ri,rv),Ca("teamId","==",n),Ca("inviteeEmail","==",e),Ca("status","==","pending"));if(!(await Mu(c)).empty)return{invitationId:null,error:"이미 보류 중인 초대가 있습니다."};const u=tae(),d=new Date;d.setDate(d.getDate()+7);const f={teamId:n,teamName:r.name,inviterUserId:i.uid,inviterEmail:i.email||"",inviterDisplayName:i.displayName,inviteeEmail:e,role:t,status:"pending",createdAt:Ks(),expiresAt:Ps.fromDate(d),token:u};return{invitationId:(await Gv(Ua(Ri,rv),f)).id,error:null}}catch(i){return console.error("팀 멤버 초대 에러:",i),{invitationId:null,error:"팀 멤버 초대 중 오류가 발생했습니다."}}},Yoe=async(n,e)=>{try{const t=await mr();if(!t)return{error:"로그인이 필요합니다."};const i=Tr(Ri,rv,n),r=await Kh(i);if(!r.exists())return{error:"초대를 찾을 수 없습니다."};const s=r.data();if(s.token!==e)return{error:"유효하지 않은 초대입니다."};if(s.expiresAt.toDate()<new Date)return{error:"만료된 초대입니다."};if(s.inviteeEmail!==t.email)return{error:"초대받은 이메일과 로그인한 계정이 다릅니다."};if(s.status!=="pending")return{error:"이미 처리된 초대입니다."};const o=Tr(Ri,Cm,s.teamId),a={userId:t.uid,email:t.email||"",displayName:t.displayName,photoURL:t.photoURL,role:s.role,joinedAt:Ps.fromDate(new Date),status:"active",invitedBy:s.inviterUserId};return await cl(o,{members:VW(a),updatedAt:Ks()}),await cl(i,{status:"accepted"}),{error:null}}catch(t){return console.error("팀 초대 수락 에러:",t),{error:"팀 초대 수락 중 오류가 발생했습니다."}}},Zoe=async(n,e)=>{try{const t=await mr();if(!t)return{error:"로그인이 필요합니다."};const{team:i,error:r}=await M_(n);if(r||!i)return{error:r||"팀을 찾을 수 없습니다."};const s=i.members.find(c=>c.userId===t.uid);if(!s||s.role!=="owner"&&s.role!=="admin")return{error:"팀을 수정할 권한이 없습니다."};const o={updatedAt:Ks()};e.name&&(o.name=e.name),e.description!==void 0&&(o.description=e.description),e.settings&&(o.settings={...i.settings,...e.settings});const a=Tr(Ri,Cm,n);return await cl(a,o),{error:null}}catch(t){return console.error("팀 업데이트 에러:",t),{error:"팀 업데이트 중 오류가 발생했습니다."}}},Joe=async()=>{try{const n=await mr();if(!n)return{invitations:[],error:"로그인이 필요합니다."};const e=ph(Ua(Ri,rv),Ca("inviteeEmail","==",n.email),Ca("status","==","pending"),Bg("createdAt","desc")),t=await Mu(e),i=[];return t.forEach(r=>{const s=r.data();s.expiresAt.toDate()>new Date&&i.push({id:r.id,...s})}),{invitations:i,error:null}}catch(n){return console.error("팀 초대 목록 가져오기 에러:",n),{invitations:[],error:"팀 초대 목록을 가져오는 중 오류가 발생했습니다."}}},eae=async(n,e)=>{try{const t=await mr();if(!t)return{error:"로그인이 필요합니다."};const i=Tr(Ri,rv,n),r=await Kh(i);if(!r.exists())return{error:"초대를 찾을 수 없습니다."};const s=r.data();return s.token!==e?{error:"유효하지 않은 초대입니다."}:s.inviteeEmail!==t.email?{error:"초대받은 이메일과 로그인한 계정이 다릅니다."}:s.status!=="pending"?{error:"이미 처리된 초대입니다."}:(await cl(i,{status:"declined"}),{error:null})}catch(t){return console.error("팀 초대 거절 에러:",t),{error:"팀 초대 거절 중 오류가 발생했습니다."}}};function tae(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}const nae=O.createContext(void 0);function iae({children:n}){const[e,t]=O.useState(null),[i,r]=O.useState([]),[s,o]=O.useState(null),[a,c]=O.useState(!0),[h,u]=O.useState(null);O.useEffect(()=>{d()},[h]),O.useEffect(()=>{mr().then(p=>{u(p)})},[]);const d=async()=>{try{c(!0);const p=await mr();if(!p){r([]),t(null),o(null);return}const{teams:y,error:v}=await TQ();if(v){console.error("Failed to load teams:",v);return}if(r(y),y.length>0&&!e){const w=y.find(T=>T.id===`personal_${p.uid}`)||y[0];t(w);const x=w.members.find(T=>T.userId===p.uid);o((x==null?void 0:x.role)||null),localStorage.setItem("activeTeamId",w.id)}}catch(p){console.error("Error loading teams:",p)}finally{c(!1)}},g={activeTeam:e,userTeams:i,userRole:s,isLoading:a,switchTeam:async p=>{const y=i.find(v=>v.id===p);if(y){t(y);const v=await mr();if(v){const m=y.members.find(w=>w.userId===v.uid);o((m==null?void 0:m.role)||null)}localStorage.setItem("activeTeamId",p)}},refreshTeams:async()=>{await d()}};return l.jsx(nae.Provider,{value:g,children:n})}const rae="_errorContainer_y0a2k_1",sae="_errorCard_y0a2k_13",oae="_errorIcon_y0a2k_22",aae="_errorTitle_y0a2k_27",lae="_errorMessage_y0a2k_34",cae="_reloadButton_y0a2k_41",i0={errorContainer:rae,errorCard:sae,errorIcon:oae,errorTitle:aae,errorMessage:lae,reloadButton:cae};let hae=class extends O.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("🚨 ErrorBoundary caught an error:",e,t)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:l.jsx("div",{className:i0.errorContainer,children:l.jsxs("div",{className:i0.errorCard,children:[l.jsx("h1",{className:i0.errorIcon,children:"⚠️"}),l.jsx("h2",{className:i0.errorTitle,children:"문제가 발생했습니다"}),l.jsx("p",{className:i0.errorMessage,children:"예상치 못한 오류가 발생했습니다. 페이지를 새로고침하거나 잠시 후 다시 시도해주세요."}),l.jsx("button",{onClick:()=>window.location.reload(),className:i0.reloadButton,children:"페이지 새로고침"}),!1]})}):this.props.children}};const uae="_container_1sceu_2",dae="_spinner_1sceu_13",Aae="_spinnerRing_1sceu_19",fae="_spin_1sceu_13",pae="_small_1sceu_30",gae="_medium_1sceu_36",mae="_large_1sceu_42",yae="_dots_1sceu_49",vae="_dot_1sceu_49",wae="_bounce_1sceu_1",xae="_message_1sceu_76",bae="_fullscreen_1sceu_106",_ae="_gradientBg_1sceu_120",Cae="_gradientShift_1sceu_1",Th={container:uae,spinner:dae,spinnerRing:Aae,spin:fae,small:pae,medium:gae,large:mae,dots:yae,dot:vae,bounce:wae,message:xae,fullscreen:bae,gradientBg:_ae,gradientShift:Cae},Sae=(n,e,t,i)=>{var s,o,a,c;const r=[t,{code:e,...i||{}}];if((o=(s=n==null?void 0:n.services)==null?void 0:s.logger)!=null&&o.forward)return n.services.logger.forward(r,"warn","react-i18next::",!0);Yp(r[0])&&(r[0]=`react-i18next:: ${r[0]}`),(c=(a=n==null?void 0:n.services)==null?void 0:a.logger)!=null&&c.warn?n.services.logger.warn(...r):console!=null&&console.warn&&console.warn(...r)},pj={},HB=(n,e,t,i)=>{Yp(t)&&pj[t]||(Yp(t)&&(pj[t]=new Date),Sae(n,e,t,i))},BQ=(n,e)=>()=>{if(n.isInitialized)e();else{const t=()=>{setTimeout(()=>{n.off("initialized",t)},0),e()};n.on("initialized",t)}},WB=(n,e,t)=>{n.loadNamespaces(e,BQ(n,t))},gj=(n,e,t,i)=>{if(Yp(t)&&(t=[t]),n.options.preload&&n.options.preload.indexOf(e)>-1)return WB(n,t,i);t.forEach(r=>{n.options.ns.indexOf(r)<0&&n.options.ns.push(r)}),n.loadLanguages(e,BQ(n,i))},Tae=(n,e,t={})=>!e.languages||!e.languages.length?(HB(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(n,{lng:t.lng,precheck:(i,r)=>{if(t.bindI18n&&t.bindI18n.indexOf("languageChanging")>-1&&i.services.backendConnector.backend&&i.isLanguageChangingTo&&!r(i.isLanguageChangingTo,n))return!1}}),Yp=n=>typeof n=="string",Bae=n=>typeof n=="object"&&n!==null,Eae=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,kae={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},Iae=n=>kae[n],Fae=n=>n.replace(Eae,Iae);let QB={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:Fae};const Dae=(n={})=>{QB={...QB,...n}},jae=()=>QB;let EQ;const Pae=n=>{EQ=n},Nae=()=>EQ,Lae={type:"3rdParty",init(n){Dae(n.options.react),Pae(n)}},Mae=O.createContext();class Rae{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(t=>{this.usedNamespaces[t]||(this.usedNamespaces[t]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const Oae=(n,e)=>{const t=O.useRef();return O.useEffect(()=>{t.current=n},[n,e]),t.current},kQ=(n,e,t,i)=>n.getFixedT(e,t,i),Uae=(n,e,t,i)=>O.useCallback(kQ(n,e,t,i),[n,e,t,i]),Kv=(n,e={})=>{var x,T,j,D;const{i18n:t}=e,{i18n:i,defaultNS:r}=O.useContext(Mae)||{},s=t||i||Nae();if(s&&!s.reportNamespaces&&(s.reportNamespaces=new Rae),!s){HB(s,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const b=(I,S)=>Yp(S)?S:Bae(S)&&Yp(S.defaultValue)?S.defaultValue:Array.isArray(I)?I[I.length-1]:I,_=[b,{},!1];return _.t=b,_.i18n={},_.ready=!1,_}(x=s.options.react)!=null&&x.wait&&HB(s,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const o={...jae(),...s.options.react,...e},{useSuspense:a,keyPrefix:c}=o;let h=r||((T=s.options)==null?void 0:T.defaultNS);h=Yp(h)?[h]:h||["translation"],(D=(j=s.reportNamespaces).addUsedNamespaces)==null||D.call(j,h);const u=(s.isInitialized||s.initializedStoreOnce)&&h.every(b=>Tae(b,s,o)),d=Uae(s,e.lng||null,o.nsMode==="fallback"?h:h[0],c),f=()=>d,A=()=>kQ(s,e.lng||null,o.nsMode==="fallback"?h:h[0],c),[g,p]=O.useState(f);let y=h.join();e.lng&&(y=`${e.lng}${y}`);const v=Oae(y),m=O.useRef(!0);O.useEffect(()=>{const{bindI18n:b,bindI18nStore:_}=o;m.current=!0,!u&&!a&&(e.lng?gj(s,e.lng,h,()=>{m.current&&p(A)}):WB(s,h,()=>{m.current&&p(A)})),u&&v&&v!==y&&m.current&&p(A);const I=()=>{m.current&&p(A)};return b&&(s==null||s.on(b,I)),_&&(s==null||s.store.on(_,I)),()=>{m.current=!1,s&&b&&(b==null||b.split(" ").forEach(S=>s.off(S,I))),_&&s&&_.split(" ").forEach(S=>s.store.off(S,I))}},[s,y]),O.useEffect(()=>{m.current&&u&&p(f)},[s,c,u]);const w=[g,s,u];if(w.t=g,w.i18n=s,w.ready=u,u||!u&&!a)return w;throw new Promise(b=>{e.lng?gj(s,e.lng,h,()=>b()):WB(s,h,()=>b())})},Eo=()=>{const{t:n,i18n:e,ready:t}=Kv(),[i,r]=O.useState(e.language);return O.useEffect(()=>{const a=c=>{r(c),window.dispatchEvent(new CustomEvent("languageChange",{detail:c}))};return e.on("languageChanged",a),()=>{e.off("languageChanged",a)}},[e]),{t:n,i18n:e,ready:t,currentLanguage:i,changeLanguage:async a=>{await e.changeLanguage(a),localStorage.setItem("app-language",a)},availableLanguages:[{code:"ko",name:"한국어"},{code:"en",name:"English"},{code:"ja",name:"日本語"},{code:"zh",name:"中文"}]}},Gm=({message:n,size:e="medium",type:t="spinner",fullscreen:i=!1})=>{const{t:r}=Eo(),{theme:s}=Yo(),o=n||r("common.loading"),a=i?`${Th.container} ${Th.fullscreen} ${Th.gradientBg}`:Th.container;return l.jsxs("div",{className:a,"data-theme-color":s.color,children:[t==="spinner"?l.jsx("div",{className:`${Th.spinner} ${Th[e]}`,children:l.jsx("div",{className:Th.spinnerRing})}):l.jsxs("div",{className:Th.dots,children:[l.jsx("div",{className:Th.dot}),l.jsx("div",{className:Th.dot}),l.jsx("div",{className:Th.dot})]}),o&&l.jsx("p",{className:Th.message,children:o})]})},Hae="projects";const $B=n=>{if(n==null)return n;if(Array.isArray(n))return n.map(e=>$B(e));if(typeof n=="object"&&n.constructor===Object){const e={};for(const t in n)if(n.hasOwnProperty(t)){const i=n[t];i!==void 0&&(e[t]=$B(i))}return e}return n},Wae=async(n,e,t)=>{try{if(console.log("🔍 createProject 호출됨, projectData:",n),!n||!n.basicInfo)return console.error("❌ basicInfo가 없습니다:",n),{success:!1,error:"basicInfo가 필요합니다."};const i=await mr();if(!i)return{success:!1,error:"로그인이 필요합니다."};const r=Ks(),s={userId:i.uid,title:n.basicInfo.title,createdAt:r,updatedAt:r,basicInfo:{...n.basicInfo,createdAt:r,updatedAt:r},spaceConfig:n.spaceConfig,customLayout:n.customLayout,metadata:{status:"draft",priority:"medium",tags:[],isFavorite:!1},stats:{designFileCount:0,furnitureCount:0,completionRate:0,lastOpenedAt:r},furniture:{placedModules:[]}},o=$B(s);console.log("🧹 undefined 값 제거 후 데이터:",o);const a=await Gv(Ua(Ri,Hae),o);let c;return e&&!(t!=null&&t.skipThumbnail)||t!=null&&t.skipThumbnail,console.log("✅ 프로젝트 생성 완료:",{id:a.id,title:n.basicInfo.title,thumbnailUrl:c}),{success:!0,data:a.id}}catch(i){return console.error("❌ 프로젝트 생성 실패:",i),{success:!1,error:i instanceof Error?i.message:"프로젝트 생성 중 오류가 발생했습니다."}}};const Qae="_container_ksj7q_1",$ae="_fullWidth_ksj7q_7",Vae="_label_ksj7q_11",zae="_inputWrapper_ksj7q_17",Gae="_input_ksj7q_17",Xae="_small_ksj7q_51",Kae="_medium_ksj7q_57",qae="_large_ksj7q_63",Yae="_error_ksj7q_70",Zae="_errorMessage_ksj7q_80",Jae="_leftIcon_ksj7q_87",ele="_rightIcon_ksj7q_87",tle="_hasLeftIcon_ksj7q_107",nle="_hasRightIcon_ksj7q_111",Bh={container:Qae,fullWidth:$ae,label:Vae,inputWrapper:zae,input:Gae,small:Xae,medium:Kae,large:qae,error:Yae,errorMessage:Zae,leftIcon:Jae,rightIcon:ele,hasLeftIcon:tle,hasRightIcon:nle},vy=({size:n="medium",error:e,label:t,leftIcon:i,rightIcon:r,className:s="",fullWidth:o=!1,...a})=>{const c=[Bh.container,o&&Bh.fullWidth,s].filter(Boolean).join(" "),h=[Bh.input,Bh[n],e&&Bh.error,i&&Bh.hasLeftIcon,r&&Bh.hasRightIcon].filter(Boolean).join(" ");return l.jsxs("div",{className:c,children:[t&&l.jsx("label",{className:Bh.label,children:t}),l.jsxs("div",{className:Bh.inputWrapper,children:[i&&l.jsx("span",{className:Bh.leftIcon,children:i}),l.jsx("input",{className:h,...a}),r&&l.jsx("span",{className:Bh.rightIcon,children:r})]}),e&&l.jsx("span",{className:Bh.errorMessage,children:e})]})},ile="_container_2e54x_2",rle="_loadingOverlay_2e54x_17",sle="_modalContent_2e54x_32",ole="_header_2e54x_55",ale="_closeButton_2e54x_62",lle="_content_2e54x_99",cle="_leftSection_2e54x_105",hle="_iconContainer_2e54x_115",ule="_stepIcon_2e54x_122",dle="_stepIconSvg_2e54x_126",Ale="_iconBackground_2e54x_130",fle="_iconPaper_2e54x_134",ple="_iconAccent_2e54x_138",gle="_stepInfo_2e54x_142",mle="_stepNumber_2e54x_146",yle="_rightSection_2e54x_153",vle="_formSection_2e54x_159",wle="_form_2e54x_159",xle="_inputGroup_2e54x_172",ble="_fieldLabel_2e54x_178",_le="_checkIcon_2e54x_188",Cle="_inputWrapper_2e54x_195",Sle="_dropdownToggle_2e54x_201",Tle="_dropdown_2e54x_201",Ble="_dropdownOption_2e54x_236",Ele="_footer_2e54x_264",kle="_nextButton_2e54x_275",$r={container:ile,loadingOverlay:rle,modalContent:sle,header:ole,closeButton:ale,content:lle,leftSection:cle,iconContainer:hle,stepIcon:ule,stepIconSvg:dle,iconBackground:Ale,iconPaper:fle,iconAccent:ple,stepInfo:gle,stepNumber:mle,rightSection:yle,formSection:vle,form:wle,inputGroup:xle,fieldLabel:ble,checkIcon:_le,inputWrapper:Cle,dropdownToggle:Sle,dropdown:Tle,dropdownOption:Ble,footer:Ele,nextButton:kle},Ile=({onNext:n,onClose:e,projectId:t,projectTitle:i})=>{var B;const r=Ha(),{basicInfo:s,setBasicInfo:o,projectId:a,setProjectId:c,projectTitle:h}=r,u=O.useRef(null),d=O.useRef(null);O.useEffect(()=>{u.current||(u.current=a||t||null),d.current||(d.current=h||i||null)},[]),O.useEffect(()=>{a&&(u.current=a),h&&(d.current=h)},[a,h]);const f=O.useMemo(()=>u.current||a||t||null,[a,t,u.current]),A=O.useMemo(()=>d.current||h||i||null,[h,i,d.current]);O.useEffect(()=>{console.log("🔥 Step1BasicInfo 마운트/업데이트:",{propsProjectId:t,storeProjectId:a,refProjectId:u.current,finalProjectId:f,storeProjectTitle:h,refProjectTitle:d.current,finalProjectTitle:A,basicInfo:s})});const{spaceInfo:g,setSpaceInfo:p}=qi(),[y,v]=O.useState(!1),m=O.useRef(null),[w,x]=O.useState(g.hasFloorFinish||!1),[T,j]=O.useState(((B=g.floorFinish)==null?void 0:B.height)||10),[D,b]=O.useState(!1),_=["안방","거실","아이방","옷방","창고"],I=s.title&&s.title.trim()&&s.location&&s.location.trim(),S=E=>{o({...s,...E})};O.useEffect(()=>{const E=V=>{m.current&&!m.current.contains(V.target)&&v(!1)};return document.addEventListener("mousedown",E),()=>{document.removeEventListener("mousedown",E)}},[]);const F=E=>{S({location:E}),v(!1)};return l.jsxs("div",{className:$r.container,"data-theme":"light",style:{colorScheme:"light"},children:[D&&l.jsx("div",{className:$r.loadingOverlay,children:l.jsx(Gm,{message:"프로젝트 생성 중...",size:"large",type:"spinner"})}),l.jsxs("div",{className:$r.modalContent,children:[l.jsxs("div",{className:$r.header,children:[l.jsx("button",{className:$r.closeButton,"aria-label":"닫기",onClick:e,children:"×"}),l.jsx("div",{children:l.jsxs("h1",{children:["STEP. 1 디자인 정보",f&&A&&l.jsxs("span",{style:{marginLeft:"20px",fontSize:"0.8em",color:"#666"},children:["프로젝트: ",A]})]})})]}),l.jsxs("div",{className:$r.content,children:[l.jsx("div",{className:$r.leftSection,children:l.jsxs("div",{className:$r.iconContainer,children:[l.jsx("div",{className:$r.stepIcon,children:l.jsxs("svg",{width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",className:$r.stepIconSvg,children:[l.jsx("circle",{cx:"60",cy:"60",r:"60",className:$r.iconBackground}),l.jsx("rect",{x:"30",y:"35",width:"60",height:"50",rx:"4",className:$r.iconPaper}),l.jsx("rect",{x:"35",y:"45",width:"30",height:"2",className:$r.iconAccent}),l.jsx("rect",{x:"35",y:"50",width:"40",height:"2",className:$r.iconAccent}),l.jsx("rect",{x:"35",y:"55",width:"25",height:"2",className:$r.iconAccent}),l.jsx("rect",{x:"35",y:"65",width:"35",height:"2",className:$r.iconAccent}),l.jsx("rect",{x:"35",y:"70",width:"20",height:"2",className:$r.iconAccent}),l.jsx("circle",{cx:"75",cy:"65",r:"8",className:$r.iconAccent}),l.jsx("path",{d:"M71 65l2 2 4-4",stroke:"white",strokeWidth:"2",fill:"none"}),l.jsx("rect",{x:"82",y:"40",width:"8",height:"25",rx:"1",className:$r.iconPaper}),l.jsx("rect",{x:"84",y:"35",width:"4",height:"8",rx:"2",className:$r.iconPaper})]})}),l.jsx("div",{className:$r.stepInfo,children:l.jsx("span",{className:$r.stepNumber,children:"1 단계 / 3"})})]})}),l.jsx("div",{className:$r.rightSection,children:l.jsxs("div",{className:$r.formSection,children:[l.jsx("h2",{children:"정보"}),l.jsxs("div",{className:$r.form,children:[l.jsxs("div",{className:$r.inputGroup,children:[l.jsxs("label",{className:$r.fieldLabel,children:[s.title&&s.title.trim()&&l.jsx("span",{className:$r.checkIcon,children:"✓"}),f?"디자인파일 명":"프로젝트 제목"]}),l.jsx(vy,{placeholder:f?"디자인파일 명을 입력해주세요":"프로젝트 제목을 입력해주세요",value:s.title||"",onChange:E=>S({title:E.target.value}),fullWidth:!0,size:"medium"})]}),l.jsxs("div",{className:$r.inputGroup,children:[l.jsxs("label",{className:$r.fieldLabel,children:[s.location&&s.location.trim()&&l.jsx("span",{className:$r.checkIcon,children:"✓"}),"설치 위치"]}),l.jsxs("div",{className:$r.inputWrapper,ref:m,children:[l.jsx(vy,{placeholder:"설치 위치를 선택하거나 입력해주세요",value:s.location||"",onChange:E=>S({location:E.target.value}),onFocus:()=>v(!0),fullWidth:!0,size:"medium"}),l.jsx("button",{type:"button",className:$r.dropdownToggle,onClick:()=>v(!y),children:l.jsx("svg",{width:"12",height:"8",viewBox:"0 0 12 8",fill:"none",children:l.jsx("path",{d:"M1 1.5L6 6.5L11 1.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),y&&l.jsx("div",{className:$r.dropdown,children:_.map(E=>l.jsx("button",{className:$r.dropdownOption,onClick:()=>F(E),children:E},E))})]})]})]})]})})]}),l.jsx("div",{className:$r.footer,children:l.jsx("button",{className:$r.nextButton,onClick:async()=>{if(console.log("🔥 다음 단계 버튼 클릭, projectId:",f),f)console.log("✅ projectId가 있어서 다음 단계로 이동:",f),n();else{console.log("⚠️ projectId가 없어서 새 프로젝트 생성 시도"),b(!0);try{const E=await mr();if(!E){alert("로그인이 필요합니다."),b(!1);return}const V=Ks(),K={userId:E.uid,basicInfo:{title:s.title,location:s.location,description:s.description||"",unitType:s.unitType||"household",category:s.category||"residential",createdAt:V,updatedAt:V,version:"1.0.0"},spaceConfig:g,customLayout:{wall:{type:"wall",completed:!1},rack:{thickness:"2mm",completed:!1,options:{isComposite:!1}},motor:{type:"none",completed:!1},ventilation:{type:"none",completed:!1},exhaust:{type:"none",completed:!1}}},P=await Wae(K);P.success&&P.data?(c(P.data),console.log("프로젝트 생성 완료:",P.data),n()):alert(`프로젝트 생성 실패: ${P.error||"알 수 없는 오류"}`)}catch(E){console.error("프로젝트 생성 오류:",E),alert("프로젝트 생성 중 오류가 발생했습니다.")}finally{b(!1)}}},disabled:!I||D,children:D?"저장 중...":"다음 단계"})})]})]})};function IQ(n){return`teams/${n}/designs`}const Fle=(n,e,t)=>Tr(Ri,`teams/${n}/projects/${e}/designs/${t}`),FQ={projects:"projects",designs:"designs",designFiles:"designFiles",folders:"folders"};async function VB(){try{const{getCurrentUserAsync:t}=await ca(async()=>{const{getCurrentUserAsync:r}=await Promise.resolve().then(()=>Gse);return{getCurrentUserAsync:r}},void 0),i=await t();if(i!=null&&i.uid)return`personal_${i.uid}`}catch{console.log("Firebase Auth 확인 실패, fallback 사용")}const n=localStorage.getItem("activeTeamId");if(n)return n;const e=localStorage.getItem("userId");return e?`personal_${e}`:null}const Dle=Object.freeze(Object.defineProperty({__proto__:null,LEGACY_COLLECTIONS:FQ,getActiveTeamId:VB,getTeamDesignsPath:IQ,projectDesignDoc:Fle},Symbol.toStringTag,{value:"Module"}));async function jle(n,e,t){try{console.log("📂 [listDesignFiles] 시작:",{projectId:n,userId:e,teamId:t,FLAGS:Yl,activeTeamId:t||await VB()});const i=[],r=t||await VB();console.log("📂 Trying legacy path: designFiles collection");const s=ph(Ua(Ri,FQ.designFiles),Ca("projectId","==",n),Bg("updatedAt","desc")),o=await Mu(s);return console.log("📂 Legacy snapshot empty?",o.empty,"size:",o.size),o.forEach(a=>{var h,u,d,f,A,g,p;const c=a.data();console.log("📂 Found design in legacy:",{id:a.id,name:c.name,projectId:c.projectId,furniture:((u=(h=c.furniture)==null?void 0:h.placedModules)==null?void 0:u.length)||0}),i.push({id:a.id,name:c.name,projectId:c.projectId,folderId:c.folderId,updatedAt:c.updatedAt,spaceSize:{width:((d=c.spaceConfig)==null?void 0:d.width)||0,height:((f=c.spaceConfig)==null?void 0:f.height)||0,depth:((A=c.spaceConfig)==null?void 0:A.depth)||0},furnitureCount:((p=(g=c.furniture)==null?void 0:g.placedModules)==null?void 0:p.length)||0,thumbnail:c.thumbnail,spaceConfig:c.spaceConfig,furniture:c.furniture})}),console.log("🎨 Found designs in legacy:",i.length),{designs:i,error:null}}catch(i){return console.error("Error listing design files:",i),{designs:[],error:i instanceof Error?i.message:"Failed to list designs"}}}async function DQ(n,e){try{const t=IQ(n),i=Tr(Ri,t,e),r=await Kh(i);return r.exists()&&r.data().current_version_id||null}catch(t){return console.error("Error getting current version ID:",t),null}}const Iu="projects";async function Zp(){const n=localStorage.getItem("activeTeamId");if(n)return n;const e=await mr();return e?`personal_${e.uid}`:null}const R_=async n=>{try{const e=await mr();if(!e)return{id:null,error:"로그인이 필요합니다."};const t=await Zp(),i={userId:e.uid,teamId:t||`personal_${e.uid}`,title:n.title,createdAt:Ks(),updatedAt:Ks(),version:"1.0.0",stats:{designFileCount:0,lastOpenedAt:Ks(),furnitureCount:0},spaceConfig:n.spaceConfig||{width:3600,height:2400,depth:1500,installType:"builtin",surroundType:"surround",baseConfig:{type:"floor",height:65,placementType:"ground"},hasFloorFinish:!1,floorFinish:null,wallConfig:{left:!0,right:!0,top:!0},materialConfig:{interiorColor:"#FFFFFF",doorColor:"#E0E0E0"},columns:[],frameSize:{upper:50,base:50,left:50,right:50},gapConfig:{left:2,right:2}},furniture:{placedModules:[]}},r=await Gv(Ua(Ri,Iu),i);if(console.log("✅ 프로젝트 생성 - Legacy path:",`${Iu}/${r.id}`),Yl.dualWrite&&Yl.teamScope&&t)try{const s=`teams/${t}/projects`;await ug(Tr(Ri,s,r.id),i,{merge:!0}),console.log("✅ Dual-write to team path:",`${s}/${r.id}`)}catch(s){console.warn("⚠️ Team path dual-write failed (non-critical):",s)}return{id:r.id,error:null}}catch(e){return console.error("프로젝트 생성 에러:",e),{id:null,error:"프로젝트 생성 중 오류가 발생했습니다."}}},hI=async n=>{var e,t,i,r;try{console.log("💾 createDesignFile 함수 호출됨:",{name:n.name,projectId:n.projectId,hasSpaceConfig:!!n.spaceConfig,hasFurniture:!!n.furniture,furnitureCount:((t=(e=n.furniture)==null?void 0:e.placedModules)==null?void 0:t.length)||0});const s=await mr();if(!s)return console.error("🚫 사용자 인증 실패"),{id:null,error:"로그인이 필요합니다."};console.log("👤 현재 사용자:",s.uid);const o=await Zp(),a=Ks(),c={name:n.name,projectId:n.projectId,spaceConfig:n.spaceConfig,furniture:n.furniture,userId:s.uid,teamId:o||"",createdAt:a,updatedAt:a};n.thumbnail!==void 0&&n.thumbnail!==null&&(c.thumbnail=n.thumbnail);const h=n.folderId?{...c,folderId:n.folderId}:c;console.log("📋 최종 Firestore 저장 데이터:",{...h,furnitureModulesCount:((r=(i=h.furniture)==null?void 0:i.placedModules)==null?void 0:r.length)||0,spaceConfigKeys:h.spaceConfig?Object.keys(h.spaceConfig):[]});let u,d;if(u=await Gv(Ua(Ri,"designFiles"),h),d=u.id,console.log("✅ Legacy path 저장 성공:",`designFiles/${d}`),Yl.dualWrite&&o)try{if(Yl.teamScope){const f=`teams/${o}/designs`;await ug(Tr(Ri,f,d),h,{merge:!0}),console.log("✅ Dual-write to team path:",`${f}/${d}`)}if(Yl.nestedDesigns&&n.projectId){const{projectDesignDoc:f}=await ca(async()=>{const{projectDesignDoc:A}=await Promise.resolve().then(()=>Dle);return{projectDesignDoc:A}},void 0);await ug(f(o,n.projectId,d),h,{merge:!0}),console.log("✅ Dual-write to nested project path:",`teams/${o}/projects/${n.projectId}/designs/${d}`)}}catch(f){console.warn("⚠️ Dual-write failed (non-critical):",f)}return await jQ(n.projectId),{id:d,error:null}}catch(s){return console.error("❌ 디자인파일 생성 에러:",s),{id:null,error:s instanceof Error?s.message:"디자인파일 생성 중 오류가 발생했습니다."}}},_5=async n=>{var e,t;try{console.log("🔍 [getDesignFiles] 시작:",{projectId:n});const i=await mr();if(!i)return{designFiles:[],error:"로그인이 필요합니다."};const r=await Zp();console.log("🔍 [getDesignFiles] 팀 ID:",r);const s=await jle(n,i.uid,r||void 0);return console.log("🔍 [getDesignFiles] repo 결과:",{hasError:!!s.error,designCount:((e=s.designs)==null?void 0:e.length)||0,designs:(t=s.designs)==null?void 0:t.map(o=>({id:o.id,name:o.name,projectId:o.projectId}))}),s.error?(console.error("디자인파일 목록 가져오기 에러:",s.error),{designFiles:[],error:s.error}):(s.designs.sort((o,a)=>{var u,d;const c=((u=o.updatedAt)==null?void 0:u.seconds)||0;return(((d=a.updatedAt)==null?void 0:d.seconds)||0)-c}),console.log("🔍 [getDesignFiles] 최종 결과:",{count:s.designs.length,firstDesign:s.designs[0]}),{designFiles:s.designs,error:null})}catch(i){return console.error("디자인파일 목록 가져오기 에러:",i),{designFiles:[],error:"디자인파일 목록을 가져오는 중 오류가 발생했습니다."}}},jQ=async n=>{try{const{designFiles:e}=await _5(n),t=Tr(Ri,Iu,n);await cl(t,{"stats.designFileCount":e.length,"stats.lastOpenedAt":Ks(),updatedAt:Ks()})}catch(e){console.error("프로젝트 통계 업데이트 에러:",e)}},wy=async n=>{try{const e=await mr();if(!e)return{project:null,error:"로그인이 필요합니다."};const t=Tr(Ri,Iu,n),i=await Fl(t);if(!i.exists())return{project:null,error:"프로젝트를 찾을 수 없습니다."};const r=i.data();return r.userId!==e.uid?{project:null,error:"프로젝트에 접근할 권한이 없습니다."}:{project:{id:i.id,...r},error:null}}catch(e){return console.error("프로젝트 불러오기 에러:",e),{project:null,error:"프로젝트 불러오기 중 오류가 발생했습니다."}}},PQ=async n=>{var e,t;try{const i=await mr();if(!i)return{project:null,error:"로그인이 필요합니다."};const r=Tr(Ri,Iu,n),s=await Fl(r);if(!s.exists())return{project:null,error:"프로젝트를 찾을 수 없습니다."};const o=s.data();if(o.userId!==i.uid)return{project:null,error:"프로젝트에 접근할 권한이 없습니다."};const a={id:s.id,...o,spaceConfig:o.spaceConfig||null,furniture:o.furniture||{placedModules:[]},stats:o.stats||{furnitureCount:0}};return console.log("🔍 Firebase 프로젝트 조회:",{id:a.id,hasSpaceConfig:!!a.spaceConfig,furnitureCount:((t=(e=a.furniture)==null?void 0:e.placedModules)==null?void 0:t.length)||0}),{project:a,error:null}}catch(i){return console.error("프로젝트 불러오기 에러:",i),{project:null,error:"프로젝트 불러오기 중 오류가 발생했습니다."}}},NQ=async(n,e,t)=>{var i;try{const r=await mr();if(!r)return{error:"로그인이 필요합니다."};const s=Tr(Ri,Iu,n),o=await Fl(s);if(!o.exists()||o.data().userId!==r.uid)return{error:"프로젝트에 접근할 권한이 없습니다."};const a={updatedAt:Ks(),...e.title&&{title:e.title},...e.projectData&&{projectData:e.projectData},...e.spaceConfig&&{spaceConfig:e.spaceConfig},...e.furniture&&{furniture:e.furniture,"stats.furnitureCount":e.furniture.placedModules.length},...t&&{thumbnail:t}};e.spaceConfig&&(console.log("🔥 Firebase 저장 - spaceConfig 입력:",e.spaceConfig),console.log("🔥 Firebase 저장 - materialConfig 입력:",e.spaceConfig.materialConfig)),console.log("🔥 Firebase 저장 - 최종 updateData:",a),await cl(s,a);const c=await Kh(s);if(c.exists()){const h=c.data();console.log("🔥 Firebase 저장 후 확인 - spaceConfig:",h.spaceConfig),console.log("🔥 Firebase 저장 후 확인 - materialConfig:",(i=h.spaceConfig)==null?void 0:i.materialConfig)}return{error:null}}catch(r){return console.error("프로젝트 업데이트 에러:",r),{error:"프로젝트 업데이트 중 오류가 발생했습니다."}}},zB=async n=>{try{const e=await mr();if(!e)return{error:"로그인이 필요합니다."};const t=[];let i=null;if(Yl.teamScope){const h=await Zp();if(h){const u=Tr(Ri,`teams/${h}/projects`,n),d=await Fl(u);d.exists()&&(t.push(u),i=d.data(),console.log("팀 스코프에서 프로젝트 찾음:",`teams/${h}/projects/${n}`))}}const r=Tr(Ri,Iu,n),s=await Fl(r);if(s.exists()&&(t.push(r),i||(i=s.data()),console.log("Legacy 경로에서 프로젝트 찾음:",`projects/${n}`)),t.length===0||!i)return console.error("프로젝트를 찾을 수 없음:",n),{error:"프로젝트를 찾을 수 없습니다."};if(i.userId!==e.uid)return console.error("프로젝트 삭제 권한 없음:",{projectUserId:i.userId,currentUserId:e.uid,projectId:n}),{error:"프로젝트 삭제 권한이 없습니다."};const o=ph(Ua(Ri,"designFiles"),Ca("projectId","==",n)),a=await WW(o);if(a.size>0){const h=a.docs.map(u=>P_(u.ref));await Promise.all(h),console.log(`디자인파일 ${a.size}개 삭제 완료`)}const c=t.map(h=>P_(h));return await Promise.all(c),console.log(`프로젝트 삭제 완료 (${t.length}개 경로에서 삭제):`,n),console.log(`프로젝트 삭제 완료: ${n}`),{error:null}}catch(e){return console.error("프로젝트 삭제 에러:",e),{error:"프로젝트 삭제 중 오류가 발생했습니다."}}},LQ=async(n,e)=>{var t,i,r,s,o,a;try{if(console.log("🔥 [updateDesignFile] 시작:",{designFileId:n,hasName:!!e.name,hasSpaceConfig:!!e.spaceConfig,hasFurniture:!!e.furniture,hasThumbnail:!!e.thumbnail,furnitureCount:((i=(t=e.furniture)==null?void 0:t.placedModules)==null?void 0:i.length)||0}),!await mr())return console.error("🔥 [updateDesignFile] 사용자 인증 실패"),{error:"로그인이 필요합니다."};let h=null,u=null,d=null,f=null,A=null;const g=Tr(Ri,"designFiles",n),p=await Fl(g);if(p.exists()&&(h=g,u=p,d=p.data(),A=d.projectId,f="legacy",console.log("🔥 Legacy path에서 디자인 찾음:",{designFileId:n,projectId:A})),!h){const m=await Zp();if(Yl.teamScope&&m){const w=Tr(Ri,`teams/${m}/designs`,n),x=await Fl(w);x.exists()&&(h=w,u=x,d=x.data(),A=d.projectId,f="team-scoped",console.log("🔥 Team-scoped path에서 디자인 찾음:",{designFileId:n,teamId:m,projectId:A}))}}if(!h&&Yl.nestedDesigns&&A){const m=await Zp();if(m){const w=Tr(Ri,`teams/${m}/projects/${A}/designs`,n),x=await Fl(w);x.exists()&&(h=w,u=x,d=x.data(),f="nested",console.log("🔥 Nested path에서 디자인 찾음:",{designFileId:n,teamId:m,projectId:A}))}}if(!h||!d)return console.error("🔥 [updateDesignFile] 디자인파일을 찾을 수 없음:",n),{error:"디자인파일을 찾을 수 없습니다."};const y={updatedAt:Ks(),...e.name&&{name:e.name},...e.spaceConfig&&{spaceConfig:e.spaceConfig},...e.furniture&&{furniture:e.furniture},...e.thumbnail&&{thumbnail:e.thumbnail}};if(console.log("🔥 [updateDesignFile] 업데이트 데이터:",{foundPath:f,hasUpdatedAt:!!y.updatedAt,keys:Object.keys(y),furnitureModulesCount:((s=(r=y.furniture)==null?void 0:r.placedModules)==null?void 0:s.length)||0}),await cl(h,y),Yl.dualWrite){const m=await Zp();if(f!=="legacy")try{const w=Tr(Ri,"designFiles",n);await cl(w,y),console.log("🔥 Dual-write to legacy path 완료")}catch(w){console.warn("Legacy path dual-write 실패 (문서가 없을 수 있음):",w)}if(f!=="team-scoped"&&Yl.teamScope&&m)try{const w=Tr(Ri,`teams/${m}/designs`,n);await cl(w,y),console.log("🔥 Dual-write to team-scoped path 완료")}catch(w){console.warn("Team-scoped path dual-write 실패 (문서가 없을 수 있음):",w)}if(f!=="nested"&&Yl.nestedDesigns&&m&&A)try{const w=Tr(Ri,`teams/${m}/projects/${A}/designs`,n);await cl(w,y),console.log("🔥 Dual-write to nested path 완료")}catch(w){console.warn("Nested path dual-write 실패 (문서가 없을 수 있음):",w)}}console.log("🔥 [updateDesignFile] 저장 직후 확인 시작");const v=await Fl(h);if(v.exists()){const m=v.data();console.log("🔥 [updateDesignFile] 저장 직후 확인:",{savedFurnitureCount:((a=(o=m.furniture)==null?void 0:o.placedModules)==null?void 0:a.length)||0,savedUpdatedAt:m.updatedAt,savedSpaceConfigKeys:m.spaceConfig?Object.keys(m.spaceConfig):[]})}if(e.thumbnail&&A)try{const m=Tr(Ri,Iu,A);await cl(m,{thumbnail:e.thumbnail,updatedAt:Ks()}),console.log(`프로젝트 썸네일도 업데이트됨: ${A}`)}catch(m){console.warn("프로젝트 썸네일 업데이트 실패:",m)}return console.log(`디자인파일 업데이트 완료: ${n}`),{error:null}}catch(c){return console.error("디자인파일 업데이트 에러:",c),{error:"디자인파일 업데이트 중 오류가 발생했습니다."}}},uI=async(n,e)=>{try{const t=await mr();if(!t)return{error:"로그인이 필요합니다."};const i=Tr(Ri,"designFiles",n),r=Tr(Ri,Iu,e),s=await Fl(r);return!s.exists()||s.data().userId!==t.uid?{error:"이 디자인파일을 삭제할 권한이 없습니다."}:(await P_(i),await jQ(e),console.log(`디자인파일 삭제 완료: ${n}`),{error:null})}catch(t){return console.error("디자인파일 삭제 에러:",t),{error:"디자인파일 삭제 중 오류가 발생했습니다."}}},dI=async n=>{const{listProjects:e}=await ca(async()=>{const{listProjects:i}=await import("./projects.repo-C0rAGVvR.js");return{listProjects:i}},__vite__mapDeps([0,1,2,3,4]));let t=n;if(!t){const i=await mr();if(!i)return{projects:[],error:"로그인이 필요합니다."};t=i.uid}return e(t)},MQ=async n=>{var e,t,i,r,s,o,a,c,h,u;try{console.log("🔥 [Firebase] getDesignFileById 호출:",n);const d=await mr();if(!d)return console.log("🔥 [Firebase] 사용자 인증 실패"),{designFile:null,error:"로그인이 필요합니다."};const f=Tr(Ri,"designFiles",n);console.log("🔥 [Firebase] Firestore 문서 조회 중... (서버에서 직접)");const A=await Fl(f);if(console.log("🔥 [Firebase] 문서 존재 여부:",A.exists()),!A.exists())return console.log("🔥 [Firebase] 디자인 파일이 존재하지 않음"),{designFile:null,error:"디자인 파일을 찾을 수 없습니다."};const g=A.data();console.log("🔥 [Firebase] 디자인 파일 원본 데이터:",g),console.log("🔥 [Firebase] 디자인 파일 가구 데이터:",{hasData:!!g,projectId:g==null?void 0:g.projectId,hasFurniture:!!(g!=null&&g.furniture),furnitureData:g==null?void 0:g.furniture,placedModules:(e=g==null?void 0:g.furniture)==null?void 0:e.placedModules,furnitureCount:((i=(t=g==null?void 0:g.furniture)==null?void 0:t.placedModules)==null?void 0:i.length)||0});const p=Tr(Ri,Iu,g.projectId),y=await Fl(p);if(y.exists()){if(y.data().userId!==d.uid)return{designFile:null,error:"디자인 파일에 접근할 권한이 없습니다."}}else{console.log("🔥 [Firebase] 프로젝트가 존재하지 않음:",g.projectId);const m=ph(FW(Ri,"projects"),Ca("__name__","==",g.projectId)),w=await Mu(m);if(w.empty)return{designFile:null,error:"프로젝트를 찾을 수 없습니다."};const x=w.docs[0],T=x.data(),j=(r=x.ref.parent.parent)==null?void 0:r.id;if(j){const D=Tr(Ri,"teams",j),b=await Fl(D);if(b.exists()&&!((s=b.data().members)==null?void 0:s.some(S=>S.userId===d.uid||S.email===d.email)))return{designFile:null,error:"디자인 파일에 접근할 권한이 없습니다."}}}console.log("🪑 [Firebase] 가구 데이터 처리 전:",{rawFurniture:g.furniture,hasFurniture:!!g.furniture,hasPlacedModules:!!((o=g.furniture)!=null&&o.placedModules),placedModulesCount:((c=(a=g.furniture)==null?void 0:a.placedModules)==null?void 0:c.length)||0});const v={id:A.id,name:g.name,projectId:g.projectId,folderId:g.folderId,spaceConfig:g.spaceConfig,furniture:g.furniture||{placedModules:[]},thumbnail:g.thumbnail,createdAt:g.createdAt,updatedAt:g.updatedAt};return console.log("🔍 디자인 파일 조회 완료:",{id:v.id,name:v.name,furniture:v.furniture,placedModulesCount:((u=(h=v.furniture)==null?void 0:h.placedModules)==null?void 0:u.length)||0}),{designFile:v,error:null}}catch(d){return console.error("디자인 파일 조회 에러:",d),{designFile:null,error:"디자인 파일을 불러오는 중 오류가 발생했습니다."}}},RQ=async n=>{var e,t,i,r,s;try{console.log("🔥 [Firebase] getDesignFileByIdPublic 호출 (공유 링크):",n);const o=Tr(Ri,"designFiles",n);console.log("🔥 [Firebase] Firestore 문서 조회 중... (서버에서 직접)"),console.log("🔥 [Firebase] 문서 참조 경로:",o.path);const a=await Fl(o);if(console.log("🔥 [Firebase] 문서 스냅샷:",a),console.log("🔥 [Firebase] 문서 존재 여부:",a.exists()),!a.exists())return console.log("🔥 [Firebase] 디자인 파일이 존재하지 않음"),{designFile:null,error:"디자인 파일을 찾을 수 없습니다."};const c=a.data();console.log("🔥 [Firebase] 디자인 파일 원본 데이터 (공유):",c),console.log("🔥 [Firebase] 디자인 파일 가구 데이터 (공유):",{hasData:!!c,projectId:c==null?void 0:c.projectId,hasFurniture:!!(c!=null&&c.furniture),furnitureData:c==null?void 0:c.furniture,placedModules:(e=c==null?void 0:c.furniture)==null?void 0:e.placedModules,furnitureCount:((i=(t=c==null?void 0:c.furniture)==null?void 0:t.placedModules)==null?void 0:i.length)||0});const h={id:a.id,name:c.name,projectId:c.projectId,folderId:c.folderId,spaceConfig:c.spaceConfig,furniture:c.furniture||{placedModules:[]},thumbnail:c.thumbnail,createdAt:c.createdAt,updatedAt:c.updatedAt};return console.log("🔍 디자인 파일 조회 완료 (공유):",{id:h.id,name:h.name,furniture:h.furniture,placedModulesCount:((s=(r=h.furniture)==null?void 0:r.placedModules)==null?void 0:s.length)||0}),{designFile:h,error:null}}catch(o){return console.error("🔥 디자인 파일 조회 에러 (공유):",o),console.error("🔥 에러 코드:",o==null?void 0:o.code),console.error("🔥 에러 메시지:",o==null?void 0:o.message),(o==null?void 0:o.code)==="permission-denied"?{designFile:null,error:"Firebase 보안 규칙에 의해 접근이 거부되었습니다. Firestore 규칙을 확인하세요."}:{designFile:null,error:`디자인 파일을 불러오는 중 오류가 발생했습니다: ${(o==null?void 0:o.message)||o}`}}},OQ=async n=>{var e,t;try{console.log("🔥 [Firebase] getProjectByIdPublic 호출 (공유 링크):",n);const i=Tr(Ri,Iu,n);console.log("🔥 [Firebase] 프로젝트 문서 참조 경로:",i.path);const r=await Fl(i);if(console.log("🔥 [Firebase] 프로젝트 문서 스냅샷:",r),console.log("🔥 [Firebase] 프로젝트 문서 존재 여부:",r.exists()),!r.exists())return console.log("🔥 [Firebase] 프로젝트가 존재하지 않음 (공유)"),{project:null,error:"프로젝트를 찾을 수 없습니다."};const s=r.data(),o={id:r.id,...s,spaceConfig:s.spaceConfig||null,furniture:s.furniture||{placedModules:[]},stats:s.stats||{furnitureCount:0}};return console.log("🔍 Firebase 프로젝트 조회 (공유):",{id:o.id,hasSpaceConfig:!!o.spaceConfig,furnitureCount:((t=(e=o.furniture)==null?void 0:e.placedModules)==null?void 0:t.length)||0}),{project:o,error:null}}catch(i){return console.error("🔥 프로젝트 불러오기 에러 (공유):",i),console.error("🔥 에러 코드:",i==null?void 0:i.code),console.error("🔥 에러 메시지:",i==null?void 0:i.message),(i==null?void 0:i.code)==="permission-denied"?{project:null,error:"Firebase 보안 규칙에 의해 접근이 거부되었습니다. Firestore 규칙을 확인하세요."}:{project:null,error:`프로젝트를 불러오는 중 오류가 발생했습니다: ${(i==null?void 0:i.message)||i}`}}},xy=async(n,e)=>{try{const t=await mr();if(!t)return{error:"로그인이 필요합니다."};const i=Tr(Ri,"projectFolders",`${t.uid}_${n}`);return await ug(i,{userId:t.uid,projectId:n,folders:e,updatedAt:Ks()}),{error:null}}catch(t){return console.error("폴더 데이터 저장 에러:",t),{error:"폴더 데이터 저장 중 오류가 발생했습니다."}}},AI=async n=>{try{const e=await mr();if(!e)return{folders:[],error:"로그인이 필요합니다."};const t=Tr(Ri,"projectFolders",`${e.uid}_${n}`),i=await Fl(t);return i.exists()?{folders:i.data().folders||[],error:null}:{folders:[],error:null}}catch(e){return console.error("폴더 데이터 불러오기 에러:",e),{folders:[],error:"폴더 데이터 불러오기 중 오류가 발생했습니다."}}},Jd=Object.freeze(Object.defineProperty({__proto__:null,createDesignFile:hI,createProject:R_,deleteDesignFile:uI,deleteProject:zB,getDesignFileById:MQ,getDesignFileByIdPublic:RQ,getDesignFiles:_5,getProject:wy,getProjectById:PQ,getProjectByIdPublic:OQ,getUserProjects:dI,loadFolderData:AI,saveFolderData:xy,updateDesignFile:LQ,updateProject:NQ},Symbol.toStringTag,{value:"Module"})),UQ=()=>{const n=document.querySelectorAll("canvas");for(const e of n)if((e.getContext("webgl")||e.getContext("webgl2"))&&e.offsetWidth>100&&e.offsetHeight>100)return e;return null},HQ=(n,e={})=>{try{const{width:t=300,height:i=200,quality:r=.8}=e;if(n.width===0||n.height===0)return console.warn("캔버스 크기가 0입니다."),null;const s=document.createElement("canvas"),o=s.getContext("2d");return o?(s.width=t,s.height=i,o.fillStyle="#f5f5f5",o.fillRect(0,0,t,i),o.drawImage(n,0,0,n.width,n.height,0,0,t,i),s.toDataURL("image/png",r)):(console.error("임시 캔버스 컨텍스트를 생성할 수 없습니다."),null)}catch(t){return console.error("썸네일 캡처 실패:",t),null}},Ple=async()=>{var i,r;const n=UQ();if(!n)return console.warn("3D 캔버스를 찾을 수 없어 썸네일을 생성할 수 없습니다."),null;if(n.offsetWidth===0||n.offsetHeight===0)return console.warn("캔버스가 보이지 않는 상태입니다."),null;console.log("📸 정면 뷰 썸네일 캡처 시작...");const e=(i=document.querySelector("[data-view-mode]"))==null?void 0:i.getAttribute("data-view-mode"),t=(r=document.querySelector("[data-view-direction]"))==null?void 0:r.getAttribute("data-view-direction");try{const s=document.querySelector('[data-view-mode="2D"]'),o=document.querySelector('[data-view-direction="front"]');s&&(s.click(),console.log("🔄 2D 모드로 전환")),o&&(o.click(),console.log("🔄 정면 뷰로 전환")),await new Promise(c=>setTimeout(c,200));const a=HQ(n,{width:300,height:200,quality:.8});if(a&&a.length>1e3)return console.log("📸 정면 뷰 썸네일 캡처 성공"),a}catch(s){console.error("정면 뷰 썸네일 캡처 실패:",s)}finally{if(e&&e!=="2D"){const s=document.querySelector(`[data-view-mode="${e}"]`);s&&(s.click(),console.log("🔄 원래 뷰 모드로 복원"))}if(t&&t!=="front"){const s=document.querySelector(`[data-view-direction="${t}"]`);s&&(s.click(),console.log("🔄 원래 뷰 방향으로 복원"))}}return null},$S=async()=>{const n=window.__uiStore;let e=!0,t=!0;if(n){const i=n.getState();e=i.showDimensions,t=i.showDimensionsText,n.getState().setShowDimensions(!1),n.getState().setShowDimensionsText(!1),console.log("📸 썸네일 캡처를 위해 치수 및 슬롯 가이드 숨김")}try{const i=await Ple();if(i)return i;const r=UQ();if(!r)return console.warn("3D 캔버스를 찾을 수 없어 썸네일을 생성할 수 없습니다."),null;if(r.offsetWidth===0||r.offsetHeight===0)return console.warn("캔버스가 보이지 않는 상태입니다."),null;console.log("📸 3D 캔버스 썸네일 캡처 시작...",{canvasSize:`${r.width}x${r.height}`,displaySize:`${r.offsetWidth}x${r.offsetHeight}`}),await new Promise(s=>setTimeout(s,500));for(let s=1;s<=3;s++)try{const o=HQ(r,{width:300,height:200,quality:.7});if(o&&o.length>1e3)return console.log(`📸 썸네일 캡처 성공 (${s}번째 시도)`),o;s<3&&await new Promise(a=>setTimeout(a,100))}catch(o){console.warn(`썸네일 캡처 시도 ${s} 실패:`,o)}return console.warn("모든 썸네일 캡처 시도 실패"),null}finally{n&&(n.getState().setShowDimensions(e),n.getState().setShowDimensionsText(t),console.log("📸 치수 및 슬롯 가이드 원래 상태로 복원"))}},$b=(n,e)=>{const t=document.createElement("canvas"),i=t.getContext("2d");if(!i)return"";t.width=300,t.height=200;const r=i.createLinearGradient(0,0,300,200);r.addColorStop(0,"#f3e8d6"),r.addColorStop(1,"#d4b896"),i.fillStyle=r,i.fillRect(0,0,300,200),i.fillStyle="#8B4513",i.font="bold 16px Arial",i.textAlign="center";const s=Math.round(n.width),o=Math.round(n.height),a=Math.round(n.depth);return i.fillText(`${s} × ${o} × ${a}mm`,150,80),i.font="14px Arial",i.fillText(`가구 ${e}개`,150,120),i.fillStyle=getComputedStyle(document.documentElement).getPropertyValue("--theme-primary").trim()||"#10b981",i.fillRect(10,10,40,20),i.fillStyle="white",i.font="bold 12px Arial",i.textAlign="left",i.fillText("V5.0",15,24),t.toDataURL("image/png",.8)},Nle=()=>({room:{floor:{color:"#e2e8f0",roughness:.5},walls:{color:"#f8fafc",roughness:.3}},furniture:{color:"#64748b",roughness:.2}}),WQ=O.createContext(null),GB=({spaceInfo:n,svgSize:e,renderMode:t="wireframe",viewMode:i="3D",activeZone:r="normal",children:s})=>{const o=Nle(),a=xQ(n),c={spaceInfo:n,canvasSize:e,styles:o,renderMode:t,viewMode:i,roomDimensions:a,activeZone:r};return l.jsx(WQ.Provider,{value:c,children:s})},mj={viewMode:"3D",view2DDirection:"front",doorsOpen:!1,showDimensions:!0,showDimensionsText:!0,showGuides:!0,showAxis:!0,showAll:!0,showFurniture:!0,renderMode:"solid",activePopup:{type:null,id:null},highlightedFrame:null,isColumnCreationMode:!1,selectedColumnId:null,isWallCreationMode:!1,selectedWallId:null,isPanelBCreationMode:!1,selectedPanelBId:null,isFurnitureDragging:!1,isDraggingColumn:!1,isSlotDragging:!1,activeDroppedCeilingTab:"main",highlightedCompartment:null,selectedModuleForPlacement:null,hoveredSlotForPlacement:null,indirectLightEnabled:!1,indirectLightIntensity:.8,indirectLightColor:"#ffffff"},Lle=()=>{try{const n=localStorage.getItem("app-theme-config");if(n)return JSON.parse(n).mode||"light"}catch(n){console.warn("테마 설정 로드 실패:",n)}return"light"},Bi=Lm()(CY((n,e)=>{const t=Lle();return console.log("🔄 UIStore 초기화 - 앱 테마:",t),{...mj,view2DTheme:t,setViewMode:i=>n({viewMode:i}),setActiveDroppedCeilingTab:i=>n({activeDroppedCeilingTab:i}),setView2DDirection:i=>n({view2DDirection:i}),toggleDoors:()=>n(i=>({doorsOpen:!i.doorsOpen})),toggleDimensions:()=>n(i=>(console.log("🎯 toggleDimensions - 이전 상태:",i.showDimensions,"새 상태:",!i.showDimensions),{showDimensions:!i.showDimensions})),toggleDimensionsText:()=>n(i=>({showDimensionsText:!i.showDimensionsText})),toggleGuides:()=>n(i=>({showGuides:!i.showGuides})),toggleAxis:()=>n(i=>({showAxis:!i.showAxis})),toggleIndirectLight:()=>n(i=>({indirectLightEnabled:!i.indirectLightEnabled})),toggleView2DTheme:()=>n(i=>({view2DTheme:i.view2DTheme==="dark"?"light":"dark"})),toggleAll:()=>n(i=>({showAll:!i.showAll})),setShowDimensions:i=>n({showDimensions:i}),setShowDimensionsText:i=>n({showDimensionsText:i}),setShowGuides:i=>n({showGuides:i}),setShowAxis:i=>n({showAxis:i}),setShowAll:i=>n({showAll:i}),setShowFurniture:i=>n({showFurniture:i}),setRenderMode:i=>n({renderMode:i}),setView2DTheme:i=>n({view2DTheme:i}),openFurniturePopup:i=>n({activePopup:{type:"furniture",id:i}}),openFurnitureEditPopup:i=>{console.log("🔹 openFurnitureEditPopup 호출:",{moduleId:i,현재상태:e().highlightedCompartment}),n({activePopup:{type:"furnitureEdit",id:i},highlightedCompartment:i})},openColumnPopup:i=>n({activePopup:{type:"column",id:i}}),openColumnEditModal:i=>n({activePopup:{type:"columnEdit",id:i},selectedColumnId:i}),openWallPopup:i=>n({activePopup:{type:"wall",id:i}}),openWallEditModal:i=>n({activePopup:{type:"wallEdit",id:i},selectedWallId:i}),openPanelBPopup:i=>n({activePopup:{type:"panelB",id:i}}),openPanelBEditModal:i=>n({activePopup:{type:"panelBEdit",id:i},selectedPanelBId:i}),closeAllPopups:()=>n({activePopup:{type:null,id:null},highlightedCompartment:null}),setHighlightedFrame:i=>n({highlightedFrame:i}),setColumnCreationMode:i=>n({isColumnCreationMode:i}),setSelectedColumnId:i=>n({selectedColumnId:i}),setWallCreationMode:i=>n({isWallCreationMode:i}),setSelectedWallId:i=>n({selectedWallId:i}),setPanelBCreationMode:i=>n({isPanelBCreationMode:i}),setSelectedPanelBId:i=>n({selectedPanelBId:i}),setFurnitureDragging:i=>n({isFurnitureDragging:i}),setIsDraggingColumn:i=>n({isDraggingColumn:i}),setIsSlotDragging:i=>n({isSlotDragging:i}),setHighlightedCompartment:i=>n({highlightedCompartment:i}),setSelectedModuleForPlacement:i=>n({selectedModuleForPlacement:i}),setHoveredSlotForPlacement:i=>n({hoveredSlotForPlacement:i}),setIndirectLightEnabled:i=>n({indirectLightEnabled:i}),setIndirectLightIntensity:i=>n({indirectLightIntensity:i}),setIndirectLightColor:i=>n({indirectLightColor:i}),resetUI:()=>n(mj)}},{name:"ui-store",partialize:n=>({viewMode:n.viewMode,view2DDirection:n.view2DDirection,showDimensions:n.showDimensions})})),QQ=O.createContext(null),yj=({children:n,viewMode:e})=>{const t=Yo(),{view2DTheme:i}=Bi(),r=O.useMemo(()=>e==="2D"?{theme:{mode:i}}:t,[e,i,t]);return l.jsx(QQ.Provider,{value:r,children:n})},Yh=()=>{const n=O.useContext(QQ);return n||Yo()},Mle=O.createContext(null),VS={didCatch:!1,error:null};class Rle extends O.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=VS}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){const{error:e}=this.state;if(e!==null){for(var t,i,r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];(t=(i=this.props).onReset)===null||t===void 0||t.call(i,{args:s,reason:"imperative-api"}),this.setState(VS)}}componentDidCatch(e,t){var i,r;(i=(r=this.props).onError)===null||i===void 0||i.call(r,e,t)}componentDidUpdate(e,t){const{didCatch:i}=this.state,{resetKeys:r}=this.props;if(i&&t.error!==null&&Ole(e.resetKeys,r)){var s,o;(s=(o=this.props).onReset)===null||s===void 0||s.call(o,{next:r,prev:e.resetKeys,reason:"keys"}),this.setState(VS)}}render(){const{children:e,fallbackRender:t,FallbackComponent:i,fallback:r}=this.props,{didCatch:s,error:o}=this.state;let a=e;if(s){const c={error:o,resetErrorBoundary:this.resetErrorBoundary};if(typeof t=="function")a=t(c);else if(i)a=O.createElement(i,c);else if(r!==void 0)a=r;else throw o}return O.createElement(Mle.Provider,{value:{didCatch:s,error:o,resetErrorBoundary:this.resetErrorBoundary}},a)}}function Ole(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return n.length!==e.length||n.some((t,i)=>!Object.is(t,e[i]))}const $Q=.01,Ule={BASE_FOV:50,SMALL_WIDTH_THRESHOLD:1e3,MEDIUM_WIDTH_THRESHOLD:1500,LARGE_WIDTH_THRESHOLD:2e3,SMALL_ADJUSTMENT:5,MEDIUM_ADJUSTMENT:0,LARGE_ADJUSTMENT:-5,XLARGE_ADJUSTMENT:-10},Hle=n=>{const{BASE_FOV:e,SMALL_WIDTH_THRESHOLD:t,MEDIUM_WIDTH_THRESHOLD:i,LARGE_WIDTH_THRESHOLD:r,SMALL_ADJUSTMENT:s,MEDIUM_ADJUSTMENT:o,LARGE_ADJUSTMENT:a,XLARGE_ADJUSTMENT:c}=Ule;return n<=t?e+s:n<=i?e+o:n<=r?e+a:e+c},El=n=>n*$Q,zS=n=>n/$Q,jc=(n,e,t,i=0)=>{const r=Math.sqrt(n*n+e*e+t*t),s=1.2,a=50*Math.PI/180,h=Math.max(n,e,t)/2/Math.tan(a/2),u=r/2/Math.tan(a/2),d=Math.max(h,u),f=El(d*s);return Math.max(8,Math.min(150,f))},VQ=n=>[0,El(n*.5),0],Wle=(n="3D",e=[0,5,10],t,i,r,s)=>{const{spaceInfo:o}=qi(),{placedModules:a}=ci();return O.useMemo(()=>{const h=n==="2D",u=e,d=i||VQ(o.height),f=Hle(o.width),A=jc(o.width,o.height,o.depth||600,a.length),g=s?.5:1,p=1200/A*g,y=window.innerWidth/window.innerHeight;return{position:u,target:d,up:r||[0,1,0],fov:f,is2DMode:h,spaceWidth:o.width,spaceHeight:o.height,viewportLeft:-1,viewportRight:1,viewportTop:1,viewportBottom:-1,canvasAspectRatio:y,zoom:p}},[n,t,o.height,o.width,o.depth,e,i,r,a.length,s])},Pc={NEAR_PLANE:.1,FAR_PLANE:1e3,MIN_DISTANCE:5,MAX_DISTANCE:200,POLAR_ANGLE_MIN:Math.PI/2-Math.PI/18,POLAR_ANGLE_MAX:Math.PI/2+Math.PI/18,AZIMUTH_ANGLE_MIN:-Math.PI/6,AZIMUTH_ANGLE_MAX:Math.PI/6},vj={BACKGROUND_COLOR:"#ffffff"},Qle=(n,e="3D",t,i)=>{const r=O.useMemo(()=>{if(!t||!i)return{minDistance:Pc.MIN_DISTANCE,maxDistance:Pc.MAX_DISTANCE};const o=Math.max(t,i),a=A=>A*.01,c=e==="2D",h=c?Pc.MIN_DISTANCE*.5:Pc.MIN_DISTANCE,d=a(o*(c?3:8)),f=Math.max(c?Pc.MAX_DISTANCE*.6:Pc.MAX_DISTANCE,d);return{minDistance:h,maxDistance:f}},[t,i,e]);return O.useMemo(()=>{const o=e==="2D";return{enabled:!0,target:n,minPolarAngle:o?void 0:Pc.POLAR_ANGLE_MIN,maxPolarAngle:o?void 0:Pc.POLAR_ANGLE_MAX,minAzimuthAngle:o?void 0:Pc.AZIMUTH_ANGLE_MIN,maxAzimuthAngle:o?void 0:Pc.AZIMUTH_ANGLE_MAX,enablePan:!0,enableZoom:!0,enableRotate:!o,minDistance:r.minDistance,maxDistance:r.maxDistance,rotateSpeed:.5,enableDamping:!0,dampingFactor:.05,mouseButtons:{LEFT:o?void 0:Ww.ROTATE,MIDDLE:o?Ww.PAN:Ww.ROTATE,RIGHT:Ww.PAN},touches:{ONE:o?ES.PAN:ES.ROTATE,TWO:ES.DOLLY_PAN}}},[n,e,r])},$le=({minDistance:n,maxDistance:e,viewMode:t,zoomSpeed:i=1})=>{const{camera:r,gl:s,scene:o}=jl(),a=O.useRef(r);return O.useEffect(()=>{a.current=r},[r]),O.useEffect(()=>{if(t!=="2D")return;const c=s.domElement;if(!c)return;const h=u=>{u.preventDefault(),u.stopPropagation();const d=a.current;if(!d||!(d instanceof HY))return;const f=c.getBoundingClientRect(),A=u.clientX-f.left,g=u.clientY-f.top,p=d.zoom,y=u.deltaY;let v;if(y<0?v=p*1.1:v=p*.9,v=Math.max(.95,v),v!==p){const m=new yf;m.x=A/f.width*2-1,m.y=-(g/f.height*2-1);const w=new so,x=(d.right-d.left)/p,T=(d.top-d.bottom)/p;w.x=m.x*x/2,w.y=m.y*T/2,d.zoom=v;const j=new so,D=(d.right-d.left)/v,b=(d.top-d.bottom)/v;j.x=m.x*D/2,j.y=m.y*b/2;const _=w.x-j.x,I=w.y-j.y;d.left+=_,d.right+=_,d.top+=I,d.bottom+=I}else d.zoom=v;d.updateProjectionMatrix(),s.render(o,d)};return c.addEventListener("wheel",h,{passive:!1}),()=>{c.removeEventListener("wheel",h)}},[s,o,n,e,t,i,r]),null},Vle=()=>{const[n,e]=O.useState(()=>({isMobile:window.innerWidth<768,isTablet:window.innerWidth>=768&&window.innerWidth<1024,isDesktop:window.innerWidth>=1024,isPortrait:window.innerHeight>window.innerWidth,isTouchDevice:"ontouchstart"in window||navigator.maxTouchPoints>0,screenWidth:window.innerWidth,screenHeight:window.innerHeight}));return O.useEffect(()=>{const t=()=>{e({isMobile:window.innerWidth<768,isTablet:window.innerWidth>=768&&window.innerWidth<1024,isDesktop:window.innerWidth>=1024,isPortrait:window.innerHeight>window.innerWidth,isTouchDevice:"ontouchstart"in window||navigator.maxTouchPoints>0,screenWidth:window.innerWidth,screenHeight:window.innerHeight})};return window.addEventListener("resize",t),window.addEventListener("orientationchange",t),()=>{window.removeEventListener("resize",t),window.removeEventListener("orientationchange",t)}},[]),n},wj=n=>{const e=["map","normalMap","bumpMap","displacementMap","specularMap","emissiveMap","metalnessMap","roughnessMap","aoMap","envMap"],t=n;e.forEach(i=>{const r=t[i];r instanceof WY&&r.dispose()}),n.dispose()},zle=()=>{const{gl:n,scene:e}=jl();return O.useEffect(()=>{const t=n,i=e;return()=>{i.traverse(r=>{r instanceof $O&&(r.geometry&&r.geometry.dispose(),r.material&&(Array.isArray(r.material)?r.material.forEach(s=>{wj(s)}):wj(r.material)))});try{t.setRenderTarget(null)}catch{}}},[]),null},Gle=({viewMode:n})=>{const{scene:e,gl:t}=jl(),{theme:i}=Yh();return O.useEffect(()=>{const r=n==="2D"&&i.mode==="dark"?"#121212":"#ffffff";e.background=new Yr(r),t.setClearColor(new Yr(r),1),console.log("🎨 배경색 업데이트:",{viewMode:n,themeMode:i.mode,backgroundColor:r})},[e,t,n,i.mode]),null},Xle=(n,e={})=>{const{camera:t,gl:i}=jl(),{enabled:r=!0,enableRotate:s=!0,enableZoom:o=!0,enablePan:a=!0,trackpadMode:c=!0,sensitivity:h=1,zoomSensitivity:u=1,panSensitivity:d=1,enableKeyboard:f=!0,keyboardSpeed:A=.1}=e;O.useRef(0),O.useRef(1),O.useRef(0);const g=O.useRef(!1),p=O.useRef(!1),y=O.useRef(new Set),v=O.useRef(0),m=O.useRef(!1);return O.useEffect(()=>{(()=>{const x=navigator.platform.toUpperCase().indexOf("MAC")>=0,T="ontouchstart"in window;p.current=x&&T&&!("ontouchend"in window)})()},[]),O.useEffect(()=>{if(!f||!n.current)return;const w=T=>{var D;if(!r||g.current)return;const j=T.key.toLowerCase();if(y.current.add(j),j===" "){T.preventDefault(),(D=n.current)==null||D.reset();return}},x=T=>{const j=T.key.toLowerCase();y.current.delete(j)};return window.addEventListener("keydown",w),window.addEventListener("keyup",x),()=>{window.removeEventListener("keydown",w),window.removeEventListener("keyup",x)}},[f,r,n]),O.useEffect(()=>{if(!f||!n.current)return;const w=()=>{if(!r||g.current||!n.current)return;const T=A;y.current.has("w")&&n.current.pan(0,-T,0),y.current.has("s")&&n.current.pan(0,T,0),y.current.has("a")&&n.current.pan(-T,0,0),y.current.has("d")&&n.current.pan(T,0,0),y.current.has("q")&&n.current.rotateLeft(T*.1),y.current.has("e")&&n.current.rotateLeft(-T*.1),y.current.has("r")&&n.current.rotateUp(T*.1),y.current.has("f")&&n.current.rotateUp(-T*.1),y.current.has("z")&&n.current.dollyIn(1.05),y.current.has("x")&&n.current.dollyOut(1.05),n.current.update(),requestAnimationFrame(w)},x=requestAnimationFrame(w);return()=>{cancelAnimationFrame(x)}},[f,r,A,n]),O.useEffect(()=>{if(!r||!n.current)return;const w=i.domElement;let x=[],T=[];const j=_=>{g.current||(_.preventDefault(),x=Array.from(_.touches),T=x.map(I=>({x:I.clientX,y:I.clientY})),v.current=_.touches.length,console.log("🖐️ 터치 시작:",{touchCount:_.touches.length,positions:T}),_.touches.length===2&&(m.current=!0))},D=_=>{if(g.current||!n.current)return;_.preventDefault();const I=Array.from(_.touches);if(_.touches.length===1&&v.current===1){const S=I[0],F=T[0];if(F){const B=S.clientX-F.x,E=S.clientY-F.y,V=h*.01;n.current.rotateLeft(B*V*Math.PI/180),n.current.rotateUp(E*V*Math.PI/180),n.current.update(),console.log("🔄 한 손가락 회전:",{deltaX:B.toFixed(2),deltaY:E.toFixed(2),rotateSpeed:V.toFixed(4)})}T[0]={x:S.clientX,y:S.clientY}}else if(_.touches.length===2&&v.current===2){const S=I[0],F=I[1],B=T[0],E=T[1];if(B&&E){const V=Math.sqrt(Math.pow(S.clientX-F.clientX,2)+Math.pow(S.clientY-F.clientY,2)),K=Math.sqrt(Math.pow(B.x-E.x,2)+Math.pow(B.y-E.y,2)),P=Math.abs(V-K),X=(V+K)/2*.1;if(P>X){const Z=V/K,Q=Math.pow(Z,u);n.current.dollyIn(Q),console.log("🔍 두 손가락 줌:",{currentDistance:V.toFixed(2),lastDistance:K.toFixed(2),zoomScale:Z.toFixed(3),adjustedZoomScale:Q.toFixed(3)})}else{const Z=(S.clientX+F.clientX)/2,Q=(S.clientY+F.clientY)/2,U=(B.x+E.x)/2,z=(B.y+E.y)/2,q=Z-U,G=Q-z,ie=d*.01;n.current.pan(-q*ie,-G*ie,0),console.log("📱 두 손가락 팬:",{deltaX:q.toFixed(2),deltaY:G.toFixed(2),panSpeed:ie.toFixed(4)})}n.current.update()}T[0]={x:S.clientX,y:S.clientY},T[1]={x:F.clientX,y:F.clientY}}},b=_=>{g.current||(_.preventDefault(),console.log("🖐️ 터치 종료:",{remainingTouches:_.touches.length}),v.current=0,m.current=!1,x=[],T=[])};return w.addEventListener("touchstart",j,{passive:!1}),w.addEventListener("touchmove",D,{passive:!1}),w.addEventListener("touchend",b,{passive:!1}),console.log("🎮 터치 컨트롤 활성화됨"),()=>{w.removeEventListener("touchstart",j),w.removeEventListener("touchmove",D),w.removeEventListener("touchend",b),console.log("🎮 터치 컨트롤 비활성화됨")}},[r,h,u,d,n,i.domElement]),O.useEffect(()=>{const w=()=>{g.current=!0},x=()=>{g.current=!1};return window.addEventListener("furniture-drag-start",w),window.addEventListener("furniture-drag-end",x),()=>{window.removeEventListener("furniture-drag-start",w),window.removeEventListener("furniture-drag-end",x)}},[]),n},Kle=({controlsRef:n,enabled:e})=>(Xle(n,{enabled:e,enableRotate:!0,enableZoom:!0,enablePan:!0}),null),B0=({children:n,cameraPosition:e,cameraTarget:t,cameraUp:i,viewMode:r="3D",view2DDirection:s="front",renderMode:o="wireframe",isSplitView:a=!1})=>{var P,M,X,Z;const{theme:c}=Yh(),{view2DTheme:h,isFurnitureDragging:u,isDraggingColumn:d,isSlotDragging:f}=Bi(),{spaceInfo:A}=qi(),{isTouchDevice:g,isMobile:p,isTablet:y}=Vle(),v=O.useCallback(()=>r==="2D"?h==="dark"?"#000000":"#ffffff":vj.BACKGROUND_COLOR,[r,h]),[m,w]=O.useState(!1),[x,T]=O.useState(()=>`canvas-${Date.now()}-${Math.random().toString(36).substr(2,9)}`),[j,D]=O.useState(!1),b=O.useRef(null),_=O.useRef(null),I=O.useRef(null),S=O.useRef(null),F=O.useRef({position0:null,target0:null,zoom0:null,position2D:null,target2D:null,zoom2D:null});O.useEffect(()=>{r==="2D"&&(F.current.position2D=null,F.current.target2D=null,F.current.zoom2D=null),T(`canvas-${Date.now()}-${Math.random().toString(36).substr(2,9)}`)},[c,r,s,h]),O.useEffect(()=>{A!=null&&A.droppedCeiling&&(console.log("🔄 ThreeCanvas - 단내림 설정 변경 감지, 캔버스 강제 업데이트"),T(`canvas-${Date.now()}-${Math.random().toString(36).substr(2,9)}`))},[(P=A==null?void 0:A.droppedCeiling)==null?void 0:P.enabled,(M=A==null?void 0:A.droppedCeiling)==null?void 0:M.position,(X=A==null?void 0:A.droppedCeiling)==null?void 0:X.width,(Z=A==null?void 0:A.droppedCeiling)==null?void 0:Z.dropHeight]);const B=Wle(r,e,s,t,i,a),E=Qle(B.target,r,B.spaceWidth,B.spaceHeight);O.useEffect(()=>{_.current&&r==="3D"?(_.current.shadowMap.enabled=!0,_.current.shadowMap.needsUpdate=!0):_.current&&r==="2D"&&(_.current.shadowMap.enabled=!1)},[r]),O.useEffect(()=>{if(_.current){const Q=v();_.current.setClearColor(new Yr(Q),1);const U=b.current;if(U){const z=U.__r3f;z!=null&&z.scene&&(z.scene.background=new Yr(Q))}}},[c.mode,r,h,v]);const V=O.useCallback(()=>{if(console.log("Cleaning up WebGL resources..."),_.current){try{_.current.dispose()}catch(Q){console.warn("Error disposing renderer:",Q)}_.current=null}b.current=null},[]);O.useEffect(()=>(w(!0),()=>{w(!1),V()}),[V]),O.useEffect(()=>{const Q=()=>{if(console.log("🎯 가구/기둥 드래그 시작 - 카메라 회전 비활성화"),S.current){const q=S.current;q.enabled=!1,q.enablePan=!1,q.enableZoom=!1,q.enableRotate=!1,q.update(),console.log("🎯 카메라 컨트롤 비활성화 완료")}},U=()=>{if(console.log("🎯 가구/기둥 드래그 종료 - OrbitControls 회전 활성화"),S.current){const q=S.current;q.enabled=!0,q.enablePan=!0,q.enableZoom=!0,q.enableRotate=r==="3D",q.update(),console.log("🎯 카메라 컨트롤 재활성화 완료")}},z=()=>{if(console.log("🎯 가구 배치 완료"),S.current){const q=S.current;q.enabled=!0,q.enablePan=!0,q.enableZoom=!0,q.enableRotate=r==="3D",q.update(),console.log("🎯 카메라 컨트롤 재활성화 완료")}};return window.addEventListener("furniture-drag-start",Q),window.addEventListener("furniture-drag-end",U),window.addEventListener("furniture-placement-complete",z),()=>{window.removeEventListener("furniture-drag-start",Q),window.removeEventListener("furniture-drag-end",U),window.removeEventListener("furniture-placement-complete",z)}},[B,e,t,r]);const K=O.useCallback(()=>{if(S.current&&r==="3D"){const Q=S.current;if(F.current.position0&&F.current.target0&&F.current.zoom0!==null)console.log("🎯 3D 카메라 저장된 초기 상태로 리셋:",{position:F.current.position0.toArray(),target:F.current.target0.toArray(),zoom:F.current.zoom0}),Q.target0.copy(F.current.target0),Q.position0.copy(F.current.position0),Q.zoom0=F.current.zoom0,Q.reset();else{const U=(A==null?void 0:A.height)||2400,z=50,q=0,G=U/200;console.log("🎯 3D 카메라 기본 위치로 리셋:",{centerX:q,centerY:G,distance:z,spaceHeight:U}),Q.object.position.set(0,G,z),Q.target.set(0,G,0),Q.object.up.set(0,1,0),Q.object.lookAt(Q.target),Q.update(),Q.saveState()}console.log("🎯 3D 카메라 리셋 완료")}else if(S.current&&r==="2D"){const Q=S.current;if(F.current.position2D&&F.current.target2D&&F.current.zoom2D!==null)console.log("🎯 2D 카메라 저장된 초기 상태로 리셋:",{position:F.current.position2D.toArray(),target:F.current.target2D.toArray(),zoom:F.current.zoom2D}),Q.target0.copy(F.current.target2D),Q.position0.copy(F.current.position2D),Q.zoom0=F.current.zoom2D,Q.reset(),console.log("🎯 2D 카메라 초기 상태 리셋 완료");else{const U=B.position,z=B.target,q=B.up||[0,1,0],G=B.zoom||1;console.log("🎯 2D 카메라 기본값으로 리셋 (저장된 상태 없음)"),Q.object.position.set(...U),Q.target.set(...z),Q.object.up.set(...q),Q.object.zoom=G,Q.object.updateProjectionMatrix(),Q.object.lookAt(Q.target),Q.update(),Q.saveState()}}},[B,e,t,i,r,A]);return O.useEffect(()=>{const Q=U=>{(U.code==="Space"||U.keyCode===32)&&(U.preventDefault(),K())};return window.addEventListener("keydown",Q),()=>{window.removeEventListener("keydown",Q)}},[K]),O.useEffect(()=>{const Q=()=>{console.log("🎯 3D 모드에서 기둥 드래그 시작 - 카메라 리셋"),K()},U=()=>{console.log("🎯 기둥 드래그 종료")};return window.addEventListener("reset-camera-for-column",Q),window.addEventListener("column-drag-end",U),()=>{window.removeEventListener("reset-camera-for-column",Q),window.removeEventListener("column-drag-end",U)}},[K]),O.useEffect(()=>{if(!I.current||r!=="2D")return;const Q=I.current,U=G=>{if(G.button===1){G.preventDefault();const ie=Q.querySelector("canvas");ie&&(ie.style.cursor="grab",console.log("🖱️ 2D 모드: 휠 버튼 누름 - grab 커서"))}},z=G=>{if(G.buttons===4){const ie=Q.querySelector("canvas");ie&&(ie.style.cursor="grabbing")}},q=G=>{if(G.button===1){const ie=Q.querySelector("canvas");ie&&(ie.style.cursor="auto",console.log("🖱️ 2D 모드: 휠 버튼 해제 - 기본 커서"))}};return Q.addEventListener("mousedown",U,!0),Q.addEventListener("mousemove",z,!0),Q.addEventListener("mouseup",q,!0),window.addEventListener("mouseup",q,!0),()=>{Q.removeEventListener("mousedown",U,!0),Q.removeEventListener("mousemove",z,!0),Q.removeEventListener("mouseup",q,!0),window.removeEventListener("mouseup",q,!0)}},[r]),O.useEffect(()=>{if(!I.current||r!=="2D")return;const Q=z=>{if(z.ctrlKey||z.metaKey){z.preventDefault();const q=z.deltaY*.1,G=new WheelEvent("wheel",{deltaY:q,deltaX:z.deltaX,deltaMode:z.deltaMode,ctrlKey:z.ctrlKey,shiftKey:z.shiftKey,altKey:z.altKey,metaKey:z.metaKey,bubbles:!0,cancelable:!0});if(b.current){const ie=b.current.querySelector("canvas");ie&&ie.dispatchEvent(G)}return!1}},U=I.current;return U.addEventListener("wheel",Q,{passive:!1,capture:!0}),()=>{U.removeEventListener("wheel",Q,{capture:!0})}},[r]),O.useEffect(()=>{if(!S.current||r==="3D")return;const Q=S.current,U=200,z=Q.object?Q.object.position.distanceTo(Q.target):10,q=()=>{const G=Q.target;G.x=Math.max(-U,Math.min(U,G.x)),G.y=Math.max(-U,Math.min(U,G.y)),G.z=Math.max(-U,Math.min(U,G.z));const ie=Q.object;if(ie){const H=ie.position.distanceTo(G),se=ie.position.clone().sub(G).normalize(),te=z*2;H>te&&ie.position.copy(G.clone().add(se.multiplyScalar(te)));const fe=z*.1;H<fe&&ie.position.copy(G.clone().add(se.multiplyScalar(fe)))}};return Q.addEventListener("change",q),()=>{Q&&Q.removeEventListener("change",q)}},[r,m]),m?l.jsx(Rle,{fallback:l.jsx("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",background:v()},children:l.jsx("p",{children:"3D viewer error. Please refresh the page."})}),onError:Q=>{console.error("Canvas ErrorBoundary caught:",Q)},children:l.jsx("div",{ref:I,style:{width:"100%",height:"100%",position:"absolute",top:0,left:0,right:0,bottom:0,touchAction:"none"},children:l.jsxs(WO,{shadows:r==="3D",style:{background:r==="2D"&&c.mode==="dark"?"#121212":r==="2D"?"#ffffff":vj.BACKGROUND_COLOR,cursor:"default",touchAction:"none"},dpr:[1,2],frameloop:"always",gl:{powerPreference:"high-performance",antialias:!0,alpha:!1,stencil:!0,depth:!0,preserveDrawingBuffer:!0,failIfMajorPerformanceCaveat:!1,logarithmicDepthBuffer:!0,precision:"highp"},onCreated:({gl:Q,scene:U})=>{try{console.log("🎨 Canvas 생성 시작:",{canvasKey:x,viewMode:r}),_.current&&_.current!==Q&&(console.log("🧹 기존 renderer 정리"),_.current.dispose()),b.current=Q.domElement,_.current=Q,Q.setPixelRatio(Math.min(window.devicePixelRatio,2)),Q.shadowMap.enabled=r==="3D",r==="3D"&&(Q.shadowMap.type=QY,Q.shadowMap.autoUpdate=!0,Q.shadowMap.needsUpdate=!0);const z=v();Q.setClearColor(new Yr(z),1),U&&(U.background=new Yr(z),U.fog=null),D(!0),console.log("✅ Canvas 생성 완료:",{canvasKey:x,viewMode:r})}catch(z){console.error("❌ Canvas 생성 중 오류:",z),D(!1)}},children:[l.jsxs(O.Suspense,{fallback:null,children:[l.jsx(zle,{}),l.jsx(Gle,{viewMode:r})]}),r==="2D"&&l.jsx($le,{minDistance:E.minDistance,maxDistance:E.maxDistance,viewMode:r,zoomSpeed:1}),B.is2DMode?l.jsx(SY,{makeDefault:!0,position:B.position,zoom:B.zoom,near:Pc.NEAR_PLANE,far:Pc.FAR_PLANE,up:B.up||[0,1,0],onUpdate:Q=>{B.up&&Q.up.set(...B.up),Q.lookAt(...B.target)}}):l.jsx(TY,{makeDefault:!0,position:B.position,fov:B.fov,near:Pc.NEAR_PLANE,far:Pc.FAR_PLANE,onUpdate:Q=>Q.lookAt(...B.target)}),l.jsx(BY,{ref:Q=>{S.current=Q,Q&&(r==="2D"&&!F.current.position2D?setTimeout(()=>{Q&&Q.object&&(console.log("📸 2D 모드 초기 상태 저장",{position:Q.object.position.toArray(),target:Q.target.toArray(),zoom:Q.object.zoom}),F.current.position2D=Q.object.position.clone(),F.current.target2D=Q.target.clone(),F.current.zoom2D=Q.object.zoom)},100):r==="3D"&&!F.current.position0&&setTimeout(()=>{Q&&Q.object&&(console.log("📸 3D 모드 초기 상태 저장",{position:Q.object.position.toArray(),target:Q.target.toArray(),zoom:Q.object.zoom}),F.current.position0=Q.object.position.clone(),F.current.target0=Q.target.clone(),F.current.zoom0=Q.object.zoom)},100))},enabled:E.enabled&&!u&&!d&&!f,target:E.target,minPolarAngle:E.minPolarAngle,maxPolarAngle:E.maxPolarAngle,minAzimuthAngle:E.minAzimuthAngle,maxAzimuthAngle:E.maxAzimuthAngle,enablePan:E.enablePan&&!u&&!d&&!f,enableZoom:E.enableZoom&&!u&&!d&&!f,enableRotate:E.enableRotate&&!u&&!d&&!f,minDistance:E.minDistance,maxDistance:E.maxDistance,mouseButtons:E.mouseButtons,touches:E.touches,panSpeed:.8,rotateSpeed:.3,zoomSpeed:r==="2D"?.15:1.2,enableDamping:!0,dampingFactor:r==="2D"?.1:.04,screenSpacePanning:!0,zoomToCursor:!0,makeDefault:!0}),l.jsx(Kle,{controlsRef:S,enabled:!u&&!d&&!f}),n]},x)})}):l.jsx("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",background:v()},children:l.jsx("p",{children:"Loading 3D viewer..."})})},fI=()=>{const{theme:n}=Yo();return{colors:O.useMemo(()=>{const t=i=>getComputedStyle(document.documentElement).getPropertyValue(i).trim()||"";return{primary:t("--theme-primary"),primaryHover:t("--theme-primary-hover"),primaryLight:t("--theme-primary-light"),primaryDark:t("--theme-primary-dark"),background:t("--theme-background"),backgroundSecondary:t("--theme-background-secondary"),surface:t("--theme-surface"),text:t("--theme-text"),textSecondary:t("--theme-text-secondary"),border:t("--theme-border"),error:t("--theme-error"),errorLight:t("--theme-error-light"),warning:t("--theme-warning"),warningLight:t("--theme-warning-light"),success:t("--theme-success"),successLight:t("--theme-success-light"),info:t("--theme-info"),infoLight:t("--theme-info-light")}},[n]),theme:n}},zQ={name:"cabinet texture1",rgb:[.12,.12,.12],toneMapped:!1,envMapIntensity:0,emissive:0,roughness:.8},gd=n=>(n==null?void 0:n.toLowerCase().includes(zQ.name))??!1,Sm=n=>{const e=zQ;n.color.setRGB(...e.rgb),n.toneMapped=e.toneMapped,n.envMapIntensity=e.envMapIntensity,n.emissive.setHex(e.emissive),n.roughness=e.roughness,n.needsUpdate=!0};class Zu{static createCanvas(e=256,t=256){const i=document.createElement("canvas");i.width=e,i.height=t;const r=i.getContext("2d");return{canvas:i,context:r}}static createVerticalGradient(e,t,i){const r=e.createLinearGradient(0,0,0,t);return i.forEach(({position:s,color:o})=>{r.addColorStop(s,o)}),r}static createHorizontalGradient(e,t,i){const r=e.createLinearGradient(0,0,t,0);return i.forEach(({position:s,color:o})=>{r.addColorStop(s,o)}),r}static createWallGradientTexture(){const{canvas:e,context:t}=this.createCanvas(),i=this.createVerticalGradient(t,256,[{position:0,color:"#e0e0e0"},{position:.3,color:"#d8d8d8"},{position:.7,color:"#d0d0d0"},{position:1,color:"#c8c8c8"}]);return t.fillStyle=i,t.fillRect(0,0,256,256),new Fc(e)}static createOuterWallGradientTexture(){const{canvas:e,context:t}=this.createCanvas(),i=this.createVerticalGradient(t,256,[{position:0,color:"#f8f8f8"},{position:.3,color:"#f4f4f4"},{position:.7,color:"#f0f0f0"},{position:1,color:"#ececec"}]);return t.fillStyle=i,t.fillRect(0,0,256,256),new Fc(e)}static createColumnGradientTexture(){const{canvas:e,context:t}=this.createCanvas(),i=this.createVerticalGradient(t,256,[{position:0,color:"#d8d8d8"},{position:.3,color:"#d0d0d0"},{position:.7,color:"#c8c8c8"},{position:1,color:"#c0c0c0"}]);return t.fillStyle=i,t.fillRect(0,0,256,256),new Fc(e)}static createFloorGradientTexture(){const{canvas:e,context:t}=this.createCanvas(),i=this.createHorizontalGradient(t,256,[{position:0,color:"#ffffff"},{position:.2,color:"#ffffff"},{position:.3,color:"#dddddd"},{position:.6,color:"#aaaaaa"},{position:1,color:"#888888"}]);return t.fillStyle=i,t.fillRect(0,0,256,256),new Fc(e)}static createDepthBasedWallGradientTexture(){const{canvas:e,context:t}=this.createCanvas(1024,512),i=this.createHorizontalGradient(t,1024,[{position:0,color:"#555555"},{position:.1,color:"#777777"},{position:.25,color:"#999999"},{position:.4,color:"#bbbbbb"},{position:.6,color:"#dddddd"},{position:.8,color:"#eeeeee"},{position:.95,color:"#f8f8f8"},{position:1,color:"#fafafa"}]);return t.fillStyle=i,t.fillRect(0,0,1024,512),new Fc(e)}static createDepthTransparencyTexture(){const{canvas:e,context:t}=this.createCanvas(512,256),i=this.createHorizontalGradient(t,512,[{position:0,color:"rgba(100, 100, 100, 1.0)"},{position:.3,color:"rgba(120, 120, 120, 0.8)"},{position:.5,color:"rgba(150, 150, 150, 0.6)"},{position:.7,color:"rgba(180, 180, 180, 0.4)"},{position:.85,color:"rgba(220, 220, 220, 0.2)"},{position:1,color:"rgba(250, 250, 250, 0.0)"}]);return t.fillStyle=i,t.fillRect(0,0,512,256),new Fc(e)}static createLeftWallDepthTransparencyTexture(){const{canvas:e,context:t}=this.createCanvas(512,256),i=this.createHorizontalGradient(t,512,[{position:0,color:"#ffffff"},{position:.3,color:"#e0e0e0"},{position:.6,color:"#999999"},{position:.8,color:"#666666"},{position:1,color:"#444444"}]);return t.fillStyle=i,t.fillRect(0,0,512,256),new Fc(e)}static createTopWallDepthTransparencyTexture(){const{canvas:e,context:t}=this.createCanvas(512,256),i=this.createVerticalGradient(t,256,[{position:0,color:"#ffffff"},{position:.3,color:"#e0e0e0"},{position:.6,color:"#999999"},{position:.8,color:"#666666"},{position:1,color:"#444444"}]);return t.fillStyle=i,t.fillRect(0,0,512,256),new Fc(e)}static createRightWallDepthTransparencyTexture(){const{canvas:e,context:t}=this.createCanvas(512,256),i=this.createHorizontalGradient(t,512,[{position:0,color:"#ffffff"},{position:.3,color:"#e0e0e0"},{position:.6,color:"#999999"},{position:.8,color:"#666666"},{position:1,color:"#444444"}]);return t.fillStyle=i,t.fillRect(0,0,512,256),new Fc(e)}static createSideFrameGradientTexture(){const{canvas:e,context:t}=this.createCanvas(),i=this.createVerticalGradient(t,256,[{position:0,color:"#f0f0f0"},{position:.2,color:"#e8e8e8"},{position:.5,color:"#e0e0e0"},{position:.8,color:"#d8d8d8"},{position:1,color:"#d0d0d0"}]);return t.fillStyle=i,t.fillRect(0,0,256,256),new Fc(e)}static createFrontToBackGradientTexture(){const{canvas:e,context:t}=this.createCanvas(),i=this.createHorizontalGradient(t,256,[{position:0,color:"#e8e8e8"},{position:.3,color:"#e0e0e0"},{position:.7,color:"#d8d8d8"},{position:1,color:"#d0d0d0"}]);return t.fillStyle=i,t.fillRect(0,0,256,256),new Fc(e)}static createHorizontalGradientTexture(){const{canvas:e,context:t}=this.createCanvas(),i=this.createHorizontalGradient(t,256,[{position:0,color:"#f0f0f0"},{position:.25,color:"#e8e8e8"},{position:.5,color:"#e0e0e0"},{position:.75,color:"#d8d8d8"},{position:1,color:"#d0d0d0"}]);return t.fillStyle=i,t.fillRect(0,0,256,256),new Fc(e)}static createLeftHorizontalGradientTexture(){const{canvas:e,context:t}=this.createCanvas(),i=this.createHorizontalGradient(t,256,[{position:0,color:"#d0d0d0"},{position:.25,color:"#d8d8d8"},{position:.5,color:"#e0e0e0"},{position:.75,color:"#e8e8e8"},{position:1,color:"#f0f0f0"}]);return t.fillStyle=i,t.fillRect(0,0,256,256),new Fc(e)}}class $o{static getCachedMaterial(e,t){return this.materialCache.has(e)||this.materialCache.set(e,t()),this.materialCache.get(e)}static optimizeTexture(e){e.wrapS=fm,e.wrapT=fm,e.magFilter=$Y,e.minFilter=VY,e.generateMipmaps=!0}static createBasicMaterial(e,t={}){return this.optimizeTexture(e),new VO({map:e,transparent:t.transparent||!1,opacity:t.opacity||1,side:t.side||zY,fog:t.fog!==void 0?t.fog:!1,...t.alphaTest&&{alphaTest:t.alphaTest},...t.emissive&&{emissive:t.emissive}})}static createWallMaterial(e="#e0e0e0"){return this.getCachedMaterial(`wall_${e}`,()=>{const t=Zu.createWallGradientTexture();return new oo({map:t,color:e,roughness:.9,metalness:0,side:Go,envMapIntensity:.3,bumpScale:.02,transparent:!1,opacity:1,polygonOffset:!0,polygonOffsetFactor:2,polygonOffsetUnits:2})})}static createOuterWallMaterial(){return this.getCachedMaterial("outerWall",()=>{const e=Zu.createOuterWallGradientTexture();return new oo({map:e,color:"#f8f8f8",roughness:.85,metalness:0,side:Go,envMapIntensity:.2,transparent:!1,opacity:1,polygonOffset:!0,polygonOffsetFactor:3,polygonOffsetUnits:3})})}static createFloorMaterial(){return this.getCachedMaterial("floor",()=>{const e=Zu.createFloorGradientTexture();return this.createBasicMaterial(e)})}static createDepthBasedWallMaterial(){return this.getCachedMaterial("depthWall",()=>{const e=Zu.createDepthBasedWallGradientTexture();return new oo({map:e,transparent:!0,opacity:.95,side:Go,fog:!1,roughness:.8,metalness:0})})}static createDepthTransparencyMaterial(){return this.getCachedMaterial("depthTransparency",()=>{const e=Zu.createDepthTransparencyTexture();return this.createBasicMaterial(e,{transparent:!0,opacity:1,side:Go,fog:!1,alphaTest:.01,emissive:new Yr(.2,.2,.2)})})}static createDirectionalTransparencyMaterial(e){let t;switch(e){case"left":t=Zu.createLeftWallDepthTransparencyTexture();break;case"top":t=Zu.createTopWallDepthTransparencyTexture();break;case"right":t=Zu.createRightWallDepthTransparencyTexture();break;default:t=Zu.createDepthTransparencyTexture()}return this.optimizeTexture(t),new oo({map:t,transparent:!1,opacity:1,side:Go,fog:!1,roughness:.8,metalness:0})}static createFlatMaterial(e="#ffffff"){return this.getCachedMaterial(`flat-${e}`,()=>new uB({color:new Yr(e),transparent:!1,fog:!1}))}static createEdgeLineMaterial(e="#000000"){return this.getCachedMaterial(`edge-${e}`,()=>new zC({color:new Yr(e),linewidth:1}))}static createSolidFrameMaterial(e="#d0d0d0",t){const i=new Yr(e),r=new oo({color:i,transparent:!1,metalness:0,roughness:.4,envMapIntensity:.6,emissive:i.clone().multiplyScalar(.015),polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1});return t&&new xg().load(t,o=>{o.wrapS=Gh,o.wrapT=Gh,o.repeat.set(1,1),r.map=o,r.needsUpdate=!0}),r}static createSolidWallMaterial(e="#e8e8e8"){return this.getCachedMaterial(`solidWall-${e}`,()=>new oo({color:new Yr(e),roughness:.8,metalness:0,side:Go,transparent:!1,opacity:1}))}static createShaderGradientWallMaterial(e="horizontal"){const t=`
      varying vec2 vUv;
      varying vec3 vPosition;
      
      void main() {
        vUv = uv;
        vPosition = position;
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
      }
    `,i=`
        uniform vec3 colorStart;
        uniform vec3 colorEnd;
        uniform float direction;
        uniform float reverse;
        
        varying vec2 vUv;
        varying vec3 vPosition;
        
        void main() {
          float gradientFactor;
          
          if (direction < 0.5) {
            // 수평 그라데이션 (0.0 = 왼쪽/앞쪽, 1.0 = 오른쪽/뒤쪽)
            gradientFactor = vUv.x;
          } else {
            // 수직 그라데이션 (0.0 = 아래/앞쪽, 1.0 = 위/뒤쪽)
            gradientFactor = vUv.y;
          }
          
          // reverse가 1.0이면 그라데이션 방향 반전
          if (reverse > 0.5) {
            gradientFactor = 1.0 - gradientFactor;
          }
          
          vec3 color = mix(colorStart, colorEnd, gradientFactor);
          gl_FragColor = vec4(color, 1.0);
        }
      `,r=e==="horizontal-reverse"||e==="vertical-reverse",s=e==="vertical"||e==="vertical-reverse"?1:0;return new k8({vertexShader:t,fragmentShader:i,uniforms:{colorStart:{value:new Yr("#ffffff")},colorEnd:{value:new Yr("#c0c0c0")},direction:{value:s},reverse:{value:r?1:0}},side:Go,transparent:!1})}static createCornerShaderMaterial(){const e=`
      varying vec2 vUv;
      varying vec3 vPosition;
      varying vec3 vNormal;
      
      void main() {
        vUv = uv;
        vPosition = position;
        vNormal = normalMatrix * normal;
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
      }
    `,t=`
      uniform vec3 centerColor;
      uniform vec3 edgeColor;
      uniform float intensity;
      
      varying vec2 vUv;
      varying vec3 vPosition;
      varying vec3 vNormal;
      
      void main() {
        // UV 좌표를 이용한 거리 계산 (중앙에서 가장자리로)
        vec2 center = vec2(0.5, 0.5);
        float distanceFromCenter = distance(vUv, center);
        
        // 0.0 (중앙)에서 0.707 (코너)까지의 거리를 0-1로 정규화
        float normalizedDistance = min(distanceFromCenter / 0.707, 1.0);
        
        // 강도 조절
        float gradientFactor = pow(normalizedDistance, intensity);
        
        vec3 color = mix(centerColor, edgeColor, gradientFactor);
        gl_FragColor = vec4(color, 1.0);
      }
    `;return new k8({vertexShader:e,fragmentShader:t,uniforms:{centerColor:{value:new Yr("#ffffff")},edgeColor:{value:new Yr("#dddddd")},intensity:{value:1.5}},side:Go,transparent:!1})}static createEdgeShadowMaterial(){return new uB({color:"#888888",transparent:!0,opacity:.3,side:Go})}static clearCache(){this.materialCache.forEach(e=>{e.dispose()}),this.materialCache.clear()}static getGlobalEdgeLineMaterial(){return this.globalEdgeLineMaterial||(this.globalEdgeLineMaterial=this.createEdgeLineMaterial("#000000")),this.globalEdgeLineMaterial}}rr($o,"materialCache",new Map),rr($o,"globalEdgeLineMaterial",null);const Qi=()=>{const n=O.useContext(WQ);if(!n)throw new Error("useSpace3DView must be used within a Space3DViewProvider");return n},xj={internalWidth:0,columnCount:0,columnWidth:0,internalHeight:0,internalDepth:0,columnPositions:[],threeUnitPositions:[],columnBoundaries:[],dualColumnPositions:[],isCalculated:!1,lastCalculatedSpaceInfo:null},Eg=Lm(n=>({...xj,recalculateFromSpaceInfo:e=>{try{const t={...e,width:Math.max(600,e.width),height:Math.max(1e3,e.height)},i=moe(t),r=ur(t),s=kr(t),o=r.zones?{normal:r.zones.normal?{width:r.zones.normal.width,columnCount:r.zones.normal.columnCount,columnWidth:r.zones.normal.columnWidth}:void 0,dropped:r.zones.dropped?{width:r.zones.dropped.width,columnCount:r.zones.dropped.columnCount,columnWidth:r.zones.dropped.columnWidth}:void 0}:void 0;n({internalWidth:i,columnCount:r.columnCount,columnWidth:r.columnWidth,internalHeight:s.height,internalDepth:s.depth,columnPositions:r.columnPositions,threeUnitPositions:r.threeUnitPositions,columnBoundaries:r.columnBoundaries,dualColumnPositions:r.dualColumnPositions,zones:o,isCalculated:!0,lastCalculatedSpaceInfo:t})}catch(t){console.error("❌ [derivedSpaceStore 계산 오류]",t),console.error("파생 상태 계산 중 오류 발생:",t),n({internalWidth:Math.max(0,e.width-100),columnCount:1,columnWidth:Math.max(400,e.width-100),internalHeight:Math.max(0,e.height-200),internalDepth:580,columnPositions:[0],threeUnitPositions:[0],columnBoundaries:[0,Math.max(400,e.width-100)],dualColumnPositions:[],isCalculated:!0,lastCalculatedSpaceInfo:e})}},reset:()=>{n(xj)}})),GS=(n,e,t,i,r,s,o)=>{var a,c;try{const h=t.getBoundingClientRect(),u=new yf;u.x=(n-h.left)/h.width*2-1,u.y=-((e-h.top)/h.height)*2+1;const d=new N0;d.setFromCamera(u,i);const f=[];let A=0,g=0;r.traverse(y=>{var v,m,w;A++,y.userData&&(g++,(y.userData.isSlotCollider||y.userData.type==="slot-collider")&&console.log("🔍 Found slot collider candidate:",{userData:y.userData,type:y.type,visible:y.visible})),(((v=y.userData)==null?void 0:v.type)==="slot-collider"||(m=y.userData)!=null&&m.isSlotCollider)&&(o&&((w=y.userData)==null||w.zone),f.push(y))}),console.log("🎯 Slot collider search result:",{totalSceneObjects:A,objectsWithUserData:g,slotCollidersFound:f.length,activeZone:o});const p=d.intersectObjects(f);if(p.length>0){const y=p[0].object,v=(a=y.userData)==null?void 0:a.slotIndex;if(typeof v=="number"&&v>=0)return console.log("🎯 Raycast found slot:",{slotIndex:v,zone:(c=y.userData)==null?void 0:c.zone,activeZone:o}),v}return null}catch(h){return console.error("Slot raycast detection error:",h),null}},qle=(n,e,t,i,r,s,o)=>{var a,c;try{const h=t.getBoundingClientRect(),u=new yf((n-h.left)/h.width*2-1,-((e-h.top)/h.height)*2+1),d=new N0;d.setFromCamera(u,i);const f=[];r.traverse(g=>{var p,y,v;(((p=g.userData)==null?void 0:p.type)==="slot-collider"||(y=g.userData)!=null&&y.isSlotCollider)&&(o&&((v=g.userData)==null||v.zone),f.push(g))});const A=d.intersectObjects(f);if(A.length>0){const g=A[0].object,p=(a=g.userData)==null?void 0:a.slotIndex,y=((c=g.userData)==null?void 0:c.zone)||null;if(typeof p=="number"&&p>=0)return{slotIndex:p,zone:y}}return{slotIndex:null,zone:null}}catch(h){return console.error("Slot raycast detection (with zone) error:",h),{slotIndex:null,zone:null}}},Yle=(n,e)=>n.includes("dual-"),Zle=n=>{const e=kr(n),t=ur(n),i=r=>r*.01;return{width:i(t.columnWidth)-1,height:i(e.height),depth:i(e.depth)+1}},Jle=n=>{var r;const e=s=>s*.01,t=n.hasFloorFinish&&n.floorFinish?n.floorFinish.height:0,i=((r=n.baseConfig)==null?void 0:r.height)||0;if(!n.baseConfig||n.baseConfig.type==="floor")return e(t+i);if(n.baseConfig.type==="stand")if(n.baseConfig.placementType==="float"){const s=n.baseConfig.floatHeight||0;return e(s)}else return e(t);else return e(t)},bj=(n,e,t,i)=>{var o;const r=ur(t),s=Yle(e);if((o=t.droppedCeiling)!=null&&o.enabled&&i&&r.zones){const a=i==="normal"?r.zones.normal:r.zones.dropped;if(!a||!a.threeUnitPositions)return null;if(s&&n<a.threeUnitPositions.length-1){if(a.threeUnitDualPositions&&a.threeUnitDualPositions[n]!==void 0)return a.threeUnitDualPositions[n];{const c=a.threeUnitPositions[n],h=a.threeUnitPositions[n+1];return(c+h)/2}}else return a.threeUnitPositions[n]}if(s){if(r.threeUnitDualPositions&&r.threeUnitDualPositions[n]!==void 0)return r.threeUnitDualPositions[n];if(n<r.threeUnitPositions.length-1){const a=r.threeUnitPositions[n],c=r.threeUnitPositions[n+1];return(a+c)/2}else return console.error("Dual position not available for slot:",n),null}else return r.threeUnitPositions[n]},ece=({spaceInfo:n})=>{const e=ci(b=>b.placedModules);ci(b=>b.moveModule);const t=ci(b=>b.updatePlacedModule),i=ci(b=>b.setFurniturePlacementMode),{setFurnitureDragging:r,activeDroppedCeilingTab:s,viewMode:o,setViewMode:a}=Bi(),[c,h]=O.useState(null),[u,d]=O.useState(0),f=O.useRef(!1),{camera:A,scene:g,gl:p,invalidate:y,controls:v}=jl(),m=kr(n),w=O.useCallback(()=>{y()},[y]),x=O.useCallback((b,_,I,S,F)=>{const B=e.find(Q=>Q.id===b);if(!B)return[];const E=Hi(B.moduleId,m,n);if(!E)return[];const V=ur(n),K=V.columnWidth,P=typeof F=="boolean"?F:B.moduleId.includes("dual-")||(B.isDualSlot!==void 0?B.isDualSlot:Math.abs(E.dimensions.width-K*2)<50);let M=[];if(P?(M=[_,_+1],console.log("🔄 듀얼 가구 이동:",{moduleId:B.moduleId,타겟슬롯:M,isDualSlot:B.isDualSlot})):M=[_],I&&I.hasColumn)return console.log("🎯 기둥 슬롯 - 충돌 감지 제외"),[];const X=[];return(S?e.filter(Q=>Q.zone===S):B.zone?e.filter(Q=>Q.zone===B.zone):e).forEach(Q=>{if(Q.id===b)return;const U=Hi(Q.moduleId,m,n);if(!U)return;const z=Hi(B.moduleId,m,n),q=(z==null?void 0:z.category)==="upper"||B.moduleId.includes("upper-cabinet"),G=(z==null?void 0:z.category)==="lower"||B.moduleId.includes("lower-cabinet"),ie=U.category==="upper"||Q.moduleId.includes("upper-cabinet"),H=U.category==="lower"||Q.moduleId.includes("lower-cabinet"),se=B.moduleId.includes("single-"),te=Q.moduleId.includes("single-");if(se&&te)console.log("🔍 싱글캐비닛끼리 충돌 검사 필요");else if(q&&H||G&&ie){console.log("✅ 상부장/하부장 공존 가능:",{moving:{id:b,category:q?"upper":"lower"},existing:{id:Q.id,category:ie?"upper":"lower"}});return}const fe=Q.moduleId.includes("dual-")||(Q.isDualSlot!==void 0?Q.isDualSlot:Math.abs(U.dimensions.width-K*2)<50);let ye=[],be=Q.slotIndex;if(be==null){if(!Q.position||Q.position.x===void 0){console.log("⚠️ 가구 위치 정보 없음, 충돌 검사 스킵:",Q.id);return}const W=fe&&V.threeUnitDualPositions?Object.values(V.threeUnitDualPositions):V.threeUnitPositions;let Y=1/0,ve=-1;if(W.forEach((ce,ne)=>{const he=Math.abs(ce-Q.position.x);he<Y&&(Y=he,ve=ne)}),Y<.1)be=ve,console.log("⚠️ 슬롯 위치 추정:",{moduleId:Q.id,estimatedSlot:be,distance:Y});else{const ce=Math.floor((Q.position.x+m.width*.005)/(V.columnWidth*.01));if(ce>=0&&ce<V.columnCount)be=ce,console.log("⚠️ 대략적 슬롯 추정:",ce);else{console.log("⚠️ 슬롯 추정 실패, 충돌 검사 스킵:",Q.id);return}}}if(be!=null&&be>=0)fe?ye=[be,be+1]:ye=[be];else{console.log("⚠️ 유효한 슬롯 없음, 충돌 검사 스킵:",Q.id);return}M.some(W=>ye.includes(W))&&(console.log("💥 충돌 감지:",{이동하는가구:{id:b,isDual:P,targetSlots:M,category:q?"upper":G?"lower":"normal"},기존가구:{id:Q.id,isDual:fe,occupiedSlots:ye,category:ie?"upper":H?"lower":"normal"}}),X.push(Q.id))}),X},[e,m,n]),T=(b,_)=>{if(console.log("🖱️ 드래그 시작:",_,"button:",b.button),b.button!==0)return;if(b.stopPropagation(),o==="3D"&&v){const S=A.position.distanceTo(v.target),F=n.height/200;A.position.set(0,F,S),v.target.set(0,F,0),v.update(),console.log("📐 정면 뷰로 초기화 - 중앙 정렬, 거리 유지:",S)}h(_),f.current=!0,r(!0),window.dispatchEvent(new CustomEvent("furniture-drag-start")),i(!0),w();const I=b.target;I&&I.setPointerCapture&&I.setPointerCapture(b.pointerId),document.body.style.cursor="grabbing"},j=b=>{var B,E,V,K,P,M,X,Z,Q,U,z,q,G,ie,H,se,te,fe,ye,be,_e,W,Y;if(!f.current||!c)return;console.log("🖱️ 드래그 중:",c);const _=b.nativeEvent.target,I=e.find(ve=>ve.id===c);if(!I)return;const{slotIndex:S,zone:F}=qle(b.nativeEvent.clientX,b.nativeEvent.clientY,_,A,g);if(S!==null){if((B=n.droppedCeiling)!=null&&B.enabled&&F){const le=wr.calculateZoneSlotInfo(n,n.customColumnCount),Je=I.isDualSlot!==void 0?I.isDualSlot:!1;if(F==="normal"){const ht=Je?le.normal.columnCount-1:le.normal.columnCount;if(S>=ht){console.log("❌ 메인구간 가구: 유효하지 않은 슬롯 인덱스",{isDual:Je,slotIndex:S,maxSlotForDual:ht,columnCount:le.normal.columnCount});return}}else if(F==="dropped"&&le.dropped){const ht=Je?le.dropped.columnCount-1:le.dropped.columnCount;if(S>=ht){console.log("❌ 단내림구간 가구: 유효하지 않은 슬롯 인덱스",{isDual:Je,slotIndex:S,maxSlotForDual:ht,columnCount:le.dropped.columnCount});return}}console.log("✅ 영역별 가구 이동 검증 통과:",{zone:F,slotIndex:S,maxSlots:F==="dropped"?(E=le.dropped)==null?void 0:E.columnCount:le.normal.columnCount})}let ve,ce,ne,he=F||void 0;if((V=n.droppedCeiling)!=null&&V.enabled&&F){const le=wr.calculateZoneSlotInfo(n,n.customColumnCount),Je=F==="dropped"&&le.dropped?le.dropped:le.normal,ht=((K=n.droppedCeiling)==null?void 0:K.width)||DEFAULT_DROPPED_CEILING_VALUES.WIDTH;let ut;I.zone==="dropped"?ut=ht:ut=n.width-ht;const ft={...n,width:ut,zone:I.zone},jt=kr(ft);if(ve=Hi(I.moduleId,jt,ft),!ve)return;ce={columnCount:Je.columnCount,columnWidth:Je.columnWidth,threeUnitPositions:[],threeUnitDualPositions:{},threeUnitBoundaries:[]},ne=I.moduleId.includes("dual-")||(I.isDualSlot!==void 0?I.isDualSlot:Math.abs(ve.dimensions.width-Je.columnWidth*2)<50);let Wt;if(I.zone==="dropped"&&F==="normal"&&ne){const Mt=le.normal.columnCount;S<Mt-1?Wt=!0:Wt=!1,typeof Wt=="boolean"&&(ne=Wt)}}else{if(ve=Hi(I.moduleId,m,n),!ve)return;ce=ur(n);const le=ce.columnWidth;ne=I.moduleId.includes("dual-")||(I.isDualSlot!==void 0?I.isDualSlot:Math.abs(ve.dimensions.width-le*2)<50)}let xe;if((P=n.droppedCeiling)!=null&&P.enabled&&I.zone){const le=wr.calculateZoneSlotInfo(n,n.customColumnCount),Je=I.zone==="dropped"&&le.dropped?le.dropped:le.normal,ht=ur(n),ut=S;if(F==="dropped"&&((M=ht.zones)!=null&&M.dropped)){const ft=ht.zones.dropped.threeUnitPositions;if(ne&&ut<ft.length-1)if(ht.zones.dropped.threeUnitDualPositions&&ht.zones.dropped.threeUnitDualPositions[ut]!==void 0)xe=ht.zones.dropped.threeUnitDualPositions[ut];else{const jt=ft[ut],Wt=ft[ut+1];xe=(jt+Wt)/2}else xe=ft[ut];console.log("🎯 단내림 영역 위치 계산:",{zoneSlotIndex:ut,isDual:ne,droppedPositions:ft,finalX:xe})}else if(F==="normal"&&((X=ht.zones)!=null&&X.normal)){const ft=ht.zones.normal.threeUnitPositions;if(ne&&ut<ft.length-1)if(ht.zones.normal.threeUnitDualPositions&&ht.zones.normal.threeUnitDualPositions[ut]!==void 0)xe=ht.zones.normal.threeUnitDualPositions[ut];else{const jt=ft[ut],Wt=ft[ut+1];xe=(jt+Wt)/2}else xe=ft[ut];console.log("🎯 메인 영역 위치 계산:",{zoneSlotIndex:ut,isDual:ne,normalPositions:ft,finalX:xe})}else{const ft=Je.startX+ut*Je.columnWidth+Je.columnWidth/2;if(ne&&ut<Je.columnCount-1){const jt=Je.startX+(ut+1)*Je.columnWidth+Je.columnWidth/2;xe=(ft+jt)/2*.01}else xe=ft*.01}}else if(ne)if(ce.threeUnitDualPositions&&ce.threeUnitDualPositions[S]!==void 0)xe=ce.threeUnitDualPositions[S];else return;else xe=ce.threeUnitPositions[S];let Te=S;if((Z=n.droppedCeiling)!=null&&Z.enabled&&F){const le=wr.calculateZoneSlotInfo(n,n.customColumnCount);F==="dropped"&&le.dropped&&(Te=le.normal.columnCount+S)}let Be=Rc(n)[Te];if(Be&&Be.hasColumn){if(ne){console.log("❌ 듀얼 가구는 기둥 슬롯에 배치 불가");return}const le=Be.adjustedWidth||Be.availableWidth;if(le<150){console.log("❌ 기둥 슬롯에 공간 부족:",le,"mm");return}}const Ye=he?S:Te;ne&&console.log("🎯 듀얼 가구 이동 시도:",{moduleId:I.moduleId,fromSlot:I.slotIndex,toSlot:Ye,occupiedSlots:[Ye,Ye+1],zone:I.zone});let $e=ne,ot=x(c,Ye,Be,he,$e);if(ot.length>0)if((Q=n.droppedCeiling)!=null&&Q.enabled&&I.zone==="dropped"&&F==="normal"&&ne){console.log("🔁 듀얼 충돌 발생, 싱글로 전환하여 재시도"),$e=!1;const le=ur(n);if((U=le.zones)!=null&&U.normal){const ut=le.zones.normal.threeUnitPositions;S<ut.length&&(xe=ut[S])}const ht=Rc(n)[S];if(ot=x(c,S,ht,"normal",!1),ot.length>0){console.log("❌ 싱글 전환 후에도 충돌. 이동 취소",ot);return}ne=!1,he="normal",Be=ht}else{console.log("❌ 충돌 감지: 다른 가구가 이미 배치되어 있음",ot);return}let rt,Ve,We=I.position.y;const De=le=>le*.01,Ge=n.hasFloorFinish&&((z=n.floorFinish)==null?void 0:z.height)||0,Re=((q=n.baseConfig)==null?void 0:q.type)==="floor"?n.baseConfig.height||65:((G=n.baseConfig)==null?void 0:G.type)==="stand"&&n.baseConfig.placementType==="float"&&n.baseConfig.floatHeight||0,Ie=De(Ge+Re),Le=ve.category==="upper"||I.moduleId.includes("upper-cabinet")||((ie=ve.id)==null?void 0:ie.includes("upper-cabinet")),et=ve.category==="lower"||I.moduleId.includes("lower-cabinet")||((H=ve.id)==null?void 0:H.includes("lower-cabinet"));if(Le){const le=ve.dimensions.height,Je=m.height,ht=((se=n.baseConfig)==null?void 0:se.type)==="floor"?((te=n.baseConfig)==null?void 0:te.height)||65:0;We=De(Je+ht-le/2),console.log("🔝 드래그 중 상부장 Y 위치 계산:",{moduleId:ve.id,currentModuleId:I.moduleId,category:ve.category,isUpperCabinet:Le,internalHeightMm:Je,baseFrameHeightMm:ht,furnitureHeightMm:le,calculatedY:We,previousY:I.position.y,설명:"상부장은 내경높이 + 받침대높이 기준"})}else{const le=ve.dimensions.height;We=Ie+De(le/2),et&&console.log("📦 드래그 중 하부장 Y 위치 계산:",{moduleId:ve.id,currentModuleId:I.moduleId,category:ve.category,isLowerCabinet:et,furnitureStartY:Ie,furnitureHeightMm:le,calculatedY:We,previousY:I.position.y})}const ct={x:xe,y:We,z:I.position.z};if(Be&&Be.hasColumn&&Be.column){const le=Be.column.depth;if(Be.intrusionDirection){const Je=ce.columnWidth*.01,ht={left:xe-Je/2,right:xe+Je/2,center:xe},ut=wu(Be,ht,n);Be.intrusionDirection==="from-left"?(ct.x=ut.center,console.log("🔀 왼쪽 침범 - 위치 조정:",{originalX:xe,adjustedX:ct.x,bounds:ut})):Be.intrusionDirection==="from-right"?(ct.x=ut.center,console.log("🔁 오른쪽 침범 - 위치 조정:",{originalX:xe,adjustedX:ct.x,bounds:ut})):Be.intrusionDirection==="center"&&(ct.x=ut.center,console.log("🟡 중앙 침범 - 위치 조정:",{originalX:xe,adjustedX:ct.x,bounds:ut})),Ve=ut.renderWidth,(ut.depthAdjustmentNeeded||le===300&&ut.renderWidth===ce.columnWidth)&&(rt=730-le,console.log("🟣 Column C 깊이 조정:",rt,"mm"))}if(le<=150&&!Ve){const Je=ce.columnWidth*.01,ht={left:xe-Je/2,right:xe+Je/2,center:xe},ut=wu(Be,ht,n);Ve=ut.renderWidth,ct.x=ut.center,rt=void 0,console.log("🟢 Column A 처리: 폭 조정만",{adjustedWidth:Ve,adjustedX:ct.x})}}let mt=I.moduleId;if((fe=n.droppedCeiling)!=null&&fe.enabled&&I.zone==="dropped"&&(F==="normal"||he==="normal")&&!ne){const le=ur(n),Je=((_e=(be=(ye=le.zones)==null?void 0:ye.normal)==null?void 0:be.slotWidths)==null?void 0:_e[S])||((Y=(W=le.zones)==null?void 0:W.normal)==null?void 0:Y.columnWidth)||le.columnWidth;mt=I.moduleId.replace(/^dual-/,"single-").replace(/-(\d+)$/,`-${Je}`)}const je=S;t(c,{moduleId:mt,position:ct,customDepth:rt,adjustedWidth:Ve,slotIndex:je,isDualSlot:ne,zone:F||I.zone,customWidth:(()=>{var Je,ht,ut,ft,jt;if(Be&&Be.hasColumn)return;if(F&&((Je=n.droppedCeiling)!=null&&Je.enabled)){const Wt=ur(n);if(F==="dropped"&&((ut=(ht=Wt.zones)==null?void 0:ht.dropped)!=null&&ut.slotWidths)){const on=Wt.zones.dropped.slotWidths;if(ne&&je<on.length-1)return on[je]+on[je+1];if(on[je]!==void 0)return on[je]}else if(F==="normal"&&((jt=(ft=Wt.zones)==null?void 0:ft.normal)!=null&&jt.slotWidths)){const on=Wt.zones.normal.slotWidths;if(ne&&je<on.length-1)return on[je]+on[je+1];if(on[je]!==void 0)return on[je]}const Mt=wr.calculateZoneSlotInfo(n,n.customColumnCount);return(F==="dropped"&&Mt.dropped?Mt.dropped:Mt.normal).columnWidth}const le=ur(n);if(le.slotWidths){if(ne&&S<le.slotWidths.length-1)return le.slotWidths[S]+le.slotWidths[S+1];if(le.slotWidths[S]!==void 0)return le.slotWidths[S]}return le.columnWidth})()}),y(),p&&p.shadowMap&&(p.shadowMap.needsUpdate=!0)}},D=()=>{f.current&&(f.current=!1,h(null),i(!1),window.dispatchEvent(new CustomEvent("furniture-drag-end")),w(),setTimeout(()=>{r(!1),w()},100),p&&p.shadowMap&&(p.shadowMap.needsUpdate=!0),document.body.style.cursor="default")};return{draggingModuleId:c,isDragging:f.current,handlePointerDown:T,handlePointerMove:j,handlePointerUp:D,forceRender:u}},tce=()=>{const n=ci(u=>u.editMode),e=ci(u=>u.editingModuleId),t=ci(u=>u.setEditMode),i=ci(u=>u.setEditingModuleId),r=ci(u=>u.removeModule),{openFurnitureEditPopup:s}=Bi(),[o,a]=O.useState(!1),c=O.useRef(!1);return{dragMode:o,setDragMode:a,editMode:n,setEditMode:t,editingModuleId:e,setEditingModuleId:i,handleFurnitureClick:(u,d)=>{console.log("🖱️ handleFurnitureClick 호출:",{placedModuleId:d,isDragging:c.current,dragMode:o}),!c.current&&(u.stopPropagation(),o?(r(d),a(!1)):(console.log("🎯 openFurnitureEditPopup 호출 직전:",d),s(d)))},isDragging:c}},sv=(n,e,t,i,r,s,o)=>{console.log("🔍 isSlotAvailable 시작:",{targetSlot:n,isDualFurniture:e,moduleId:r,총가구수:t.length,placedModules:t.map(f=>({id:f.id,moduleId:f.moduleId,slotIndex:f.slotIndex,position:f.position})),excludeModuleId:s,targetZone:o});const a=ur(i),c=kr(i);if(n<0||e&&n>=a.columnCount-1||!e&&n>=a.columnCount)return!1;const h=Rc(i),u=e?[n,n+1]:[n];for(const f of u){const A=h[f];if(!A){console.log(`⚠️ 슬롯 ${f}의 정보를 찾을 수 없음 (columnSlots 길이: ${h.length})`);continue}if(A.hasColumn){if(A.columnType==="medium"&&A.allowMultipleFurniture)return e?!(t.filter(p=>p.slotIndex===f&&p.id!==s).length>=2):!(t.filter(p=>p.slotIndex===f&&p.id!==s).length>=2);if(e)return!1}}if(u.some(f=>{const A=h[f];return(A==null?void 0:A.hasColumn)&&(A==null?void 0:A.columnType)==="medium"&&(A==null?void 0:A.allowMultipleFurniture)})){const f=u[0],A=t.filter(g=>g.slotIndex===f&&g.id!==s);return console.log("🔵 Column C 슬롯 가용성 확인:",{slotIndex:f,기존가구수:A.length,isDualFurniture:e,배치가능:A.length<3}),A.length<3}else{if(u.some(f=>{var A;return(A=h[f])==null?void 0:A.hasColumn}))return!0;console.log("🔍 일반 슬롯 충돌 검사 시작:",{targetSlots:u,isDualFurniture:e,moduleId:r,기존가구수:t.length,기존가구정보:t.map(f=>({id:f.id,moduleId:f.moduleId,slotIndex:f.slotIndex,isDualSlot:f.isDualSlot,position:f.position}))});for(const f of t){if(s&&f.id===s)continue;const A=Hi(f.moduleId,c,i);if(!A)continue;const g=Hi(r,c,i),p=(g==null?void 0:g.category)==="upper"||r.includes("upper-cabinet"),y=(g==null?void 0:g.category)==="lower"||r.includes("lower-cabinet"),v=A.category==="upper"||f.moduleId.includes("upper-cabinet"),m=A.category==="lower"||f.moduleId.includes("lower-cabinet"),w=r.includes("single-"),x=f.moduleId.includes("single-");if(w&&x)console.log("🔍 싱글캐비닛끼리 충돌 검사");else if(p&&m||y&&v){console.log("✅ 상부장/하부장 공존 가능 (슬롯 가용성 검사):",{new:{moduleId:r,category:p?"upper":"lower"},existing:{id:f.id,category:v?"upper":"lower"},targetSlots:u});continue}const T=f.moduleId.includes("dual-")||(f.isDualSlot!==void 0?f.isDualSlot:Math.abs(A.dimensions.width-a.columnWidth*2)<50);let j=f.slotIndex;if(j==null){if(!f.position||f.position.x===void 0){console.log("⚠️ 기존 가구의 위치 정보 없음:",f.id);continue}const D=T&&a.threeUnitDualPositions?Object.values(a.threeUnitDualPositions):a.threeUnitPositions;let b=1/0,_=-1;if(D.forEach((I,S)=>{const F=Math.abs(I-f.position.x);F<b&&(b=F,_=S)}),b<.1)j=_;else{console.log("⚠️ 기존 가구의 슬롯 위치를 찾을 수 없음:",{id:f.id,moduleId:f.moduleId,position:f.position,isDual:T,minDistance:b,closestSlot:_});const I=Math.floor((f.position.x+c.width*.005)/(a.columnWidth*.01));if(I>=0&&I<a.columnCount)j=I,console.log("⚠️ 추정 슬롯 사용:",I);else continue}}if(j!=null&&j>=0){const D=T?[j,j+1]:[j];if(u.some(_=>D.includes(_)))return console.log("🚫 슬롯 충돌 감지!",{충돌위치:u.filter(_=>D.includes(_)),타겟슬롯:u,기존가구:{id:f.id,moduleId:f.moduleId,슬롯:j,듀얼:T,차지슬롯:D,isUpper:f.moduleId.includes("upper-cabinet"),isLower:f.moduleId.includes("lower-cabinet")},새가구:{moduleId:r,듀얼:e,타겟슬롯:u,isUpper:r.includes("upper-cabinet"),isLower:r.includes("lower-cabinet")}}),!1}}}return!0},Wp=(n,e,t,i,r,s,o,a)=>{const c=ur(r),h=e==="left"?-1:1,u=c.columnCount-(t?1:0),d=h;for(let f=n+d;e==="right"?f<=u:f>=0;f+=d)if(sv(f,t,i,r,s,o,a))return f;return null},_j=(n,e)=>{const t=ur(e);kr(e);const i=new Array(t.columnCount).fill("[ ]"),r={};for(let o=0;o<t.columnCount;o++)r[o]={modules:[],isDual:[]};n.forEach((o,a)=>{const c=o.isDualSlot!==void 0?o.isDualSlot:!1,h=o.slotIndex!==void 0?o.slotIndex:-1;if(h>=0){const u=String.fromCharCode(65+a);c?(r[h].modules.push(u),r[h].isDual.push(!0),h+1<t.columnCount&&(r[h+1].modules.push(u),r[h+1].isDual.push(!0)),i[h]=`[${u}`,h+1<t.columnCount&&(i[h+1]=`${u}]`)):(r[h].modules.push(u),r[h].isDual.push(!1),i[h]=`[${u}]`)}});const s=[];Object.entries(r).forEach(([o,a])=>{a.modules.length>1&&s.push(parseInt(o))}),console.log("📊 전체 슬롯 점유 상태:",{총슬롯수:t.columnCount,배치된가구수:n.length,듀얼가구수:n.filter(o=>o.isDualSlot).length,싱글가구수:n.filter(o=>!o.isDualSlot).length,점유맵:i.join(" "),문제슬롯:s,슬롯상세:r}),s.length>0&&console.error("⚠️ 슬롯 충돌 발견!",s.map(o=>({슬롯번호:o,가구들:r[o].modules,듀얼여부:r[o].isDual})))},nce=({spaceInfo:n})=>{const e=ci(A=>A.placedModules),t=ci(A=>A.removeModule),i=ci(A=>A.moveModule),r=ci(A=>A.updatePlacedModule),s=ci(A=>A.editMode),o=ci(A=>A.editingModuleId),a=ci(A=>A.selectedPlacedModuleId),c=ci(A=>A.setEditMode),h=ci(A=>A.setEditingModuleId),{activePopup:u}=Bi(),d=kr(n),f=ur(n);O.useEffect(()=>{const A=g=>{const p=o||(u.type==="furnitureEdit"?u.id:null);if(s&&o||u.type==="furnitureEdit"&&u.id){const y=e.find(T=>T.id===p);if(!y)return;const v=Hi(y.moduleId,d,n);if(!v)return;const m=f.columnWidth,w=Math.abs(v.dimensions.width-m*2)<50;let x=-1;if(w?f.threeUnitDualPositions&&(x=f.threeUnitDualPositions.findIndex(T=>Math.abs(T-y.position.x)<.1)):x=f.threeUnitPositions.findIndex(T=>Math.abs(T-y.position.x)<.1),x===-1)return;switch(g.key){case"Delete":case"Backspace":s&&o&&(t(p),c(!1),h(null)),g.preventDefault();break;case"ArrowLeft":{const T=Wp(x,"left",w,e,n,y.moduleId,p);if(T!==null){let j;w&&f.threeUnitDualPositions?j=f.threeUnitDualPositions[T]:j=f.threeUnitPositions[T];const b=Rc(n)[T];let _;const I={x:j,y:y.position.y,z:y.position.z};let S=y.customDepth;if(b&&b.hasColumn&&b.column){const E=b.column.depth,V=f.columnWidth*.01,K={left:j-V/2,right:j+V/2,center:j},P=wu(b,K,n);_=P.renderWidth,I.x=P.center,(P.depthAdjustmentNeeded||E===300&&P.renderWidth===f.columnWidth)&&(S=730-E,console.log("🟣 Column C 깊이 조정:",S,"mm")),console.log("⌨️ 키보드 이동 - 기둥 슬롯 크기 조정:",{slotIndex:T,columnDepth:E,originalWidth:v.dimensions.width,adjustedWidth:_,adjustedPosition:I})}const F=(()=>{if(w&&f.slotWidths&&f.slotWidths[T]!==void 0&&T<f.slotWidths.length-1)return f.slotWidths[T]+f.slotWidths[T+1]})(),B={position:I,slotIndex:T,customDepth:S,adjustedWidth:_};F!==void 0&&(B.customWidth=F),r(p,B)}g.preventDefault();break}case"ArrowRight":{const T=Wp(x,"right",w,e,n,y.moduleId,p);if(T!==null){let j;w&&f.threeUnitDualPositions?j=f.threeUnitDualPositions[T]:j=f.threeUnitPositions[T];const b=Rc(n)[T];let _;const I={x:j,y:y.position.y,z:y.position.z};let S=y.customDepth;if(b&&b.hasColumn&&b.column){const E=b.column.depth,V=f.columnWidth*.01,K={left:j-V/2,right:j+V/2,center:j},P=wu(b,K,n);_=P.renderWidth,I.x=P.center,(P.depthAdjustmentNeeded||E===300&&P.renderWidth===f.columnWidth)&&(S=730-E,console.log("🟣 Column C 깊이 조정:",S,"mm")),console.log("⌨️ 키보드 이동 - 기둥 슬롯 크기 조정:",{slotIndex:T,columnDepth:E,originalWidth:v.dimensions.width,adjustedWidth:_,adjustedPosition:I})}const F=(()=>{if(w&&f.slotWidths&&f.slotWidths[T]!==void 0&&T<f.slotWidths.length-1)return f.slotWidths[T]+f.slotWidths[T+1]})(),B={position:I,slotIndex:T,customDepth:S,adjustedWidth:_};F!==void 0&&(B.customWidth=F),r(p,B)}g.preventDefault();break}case"Escape":c(!1),h(null),g.preventDefault();break;case"Enter":c(!1),h(null),g.preventDefault();break}}else if(a){const y=e.find(T=>T.id===a);if(!y)return;const v=Hi(y.moduleId,d,n);if(!v)return;const m=f.columnWidth,w=Math.abs(v.dimensions.width-m*2)<50;let x=-1;switch(w?f.threeUnitDualPositions&&(x=f.threeUnitDualPositions.findIndex(T=>Math.abs(T-y.position.x)<.1)):x=f.threeUnitPositions.findIndex(T=>Math.abs(T-y.position.x)<.1),x===-1&&(x=y.slotIndex||0),g.key){case"Delete":case"Backspace":t(a),g.preventDefault();break;case"ArrowLeft":{const T=Wp(x,"left",w,e,n,y.moduleId,a);if(T!==null){let j;w&&f.threeUnitDualPositions?j=f.threeUnitDualPositions[T]:j=f.threeUnitPositions[T];const b=Rc(n)[T];let _;const I={x:j,y:y.position.y,z:y.position.z};let S=y.customDepth;if(b&&b.hasColumn&&b.column){const E=b.column.depth,V=f.columnWidth*.01,K={left:j-V/2,right:j+V/2,center:j},P=wu(b,K,n);_=P.renderWidth,I.x=P.center,(P.depthAdjustmentNeeded||E===300&&P.renderWidth===f.columnWidth)&&(S=730-E,console.log("🟣 Column C 깊이 조정:",S,"mm")),console.log("⌨️ 키보드 이동 - 기둥 슬롯 크기 조정:",{slotIndex:T,columnDepth:E,originalWidth:v.dimensions.width,adjustedWidth:_,adjustedPosition:I})}const F=(()=>{if(w&&f.slotWidths&&f.slotWidths[T]!==void 0&&T<f.slotWidths.length-1)return f.slotWidths[T]+f.slotWidths[T+1]})(),B={position:I,slotIndex:T,customDepth:S,adjustedWidth:_};F!==void 0&&(B.customWidth=F),r(a,B)}g.preventDefault();break}case"ArrowRight":{const T=Wp(x,"right",w,e,n,y.moduleId,a);if(T!==null){let j;w&&f.threeUnitDualPositions?j=f.threeUnitDualPositions[T]:j=f.threeUnitPositions[T];const b=Rc(n)[T];let _;const I={x:j,y:y.position.y,z:y.position.z};let S=y.customDepth;if(b&&b.hasColumn&&b.column){const E=b.column.depth,V=f.columnWidth*.01,K={left:j-V/2,right:j+V/2,center:j},P=wu(b,K,n);_=P.renderWidth,I.x=P.center,(P.depthAdjustmentNeeded||E===300&&P.renderWidth===f.columnWidth)&&(S=730-E,console.log("🟣 Column C 깊이 조정:",S,"mm")),console.log("⌨️ 키보드 이동 - 기둥 슬롯 크기 조정:",{slotIndex:T,columnDepth:E,originalWidth:v.dimensions.width,adjustedWidth:_,adjustedPosition:I})}const F=(()=>{if(w&&f.slotWidths&&f.slotWidths[T]!==void 0&&T<f.slotWidths.length-1)return f.slotWidths[T]+f.slotWidths[T+1]})(),B={position:I,slotIndex:T,customDepth:S,adjustedWidth:_};F!==void 0&&(B.customWidth=F),r(a,B)}g.preventDefault();break}}}};return document.addEventListener("keydown",A),()=>{document.removeEventListener("keydown",A)}},[s,o,a,e,f,t,i,r,d,n,c,h])},ice=9,Ud=n=>n*.01,Ru=(n,e={})=>{var X;const{color:t,internalHeight:i,customDepth:r,isDragging:s=!1,isEditMode:o=!1,adjustedWidth:a,slotWidths:c,isHighlighted:h=!1}=e,{spaceInfo:u}=qi(),d=u.materialConfig||{interiorColor:"#FFFFFF",doorColor:"#E0E0E0"},f=n.modelConfig||{basicThickness:18,hasOpenFront:!0,hasShelf:!1,shelfCount:0},A=Ud(f.basicThickness||18),g=Ud(ice);let p;const y=n.id.includes("dual");a!==void 0&&a>0?(p=a,console.log("🔧 조정된 너비 사용:",{moduleId:n.id,isDualFurniture:y,adjustedWidth:p,description:"엔드패널 또는 기둥 조정된 너비"})):y&&c&&c.length>=2&&a===void 0?(p=c[0]+c[1],console.log("🔧 듀얼 가구 너비 계산 (slotWidths 합산):",{slot1:c[0],slot2:c[1],total:p,note:"adjustedWidth가 없으므로 slotWidths 사용"})):!y&&c&&c.length>0&&a===void 0?(p=c[0],console.log("🔧 싱글 가구 너비 (slotWidth 사용):",p)):p=n.dimensions.width;const v=Ud(p),m=Ud(i||n.dimensions.height),w=r||n.dimensions.depth,x=Ud(w),T=()=>{if(typeof window<"u"){const Q=getComputedStyle(document.documentElement).getPropertyValue("--theme-primary").trim();if(Q)return Q}return"#10b981"};console.log("🔧 useBaseFurniture 폭 결정:",{moduleId:n.id,isDualFurniture:y,originalWidth:n.dimensions.width+"mm",adjustedWidth:a?a+"mm":"undefined",slotWidths:c?c.map(Z=>Z+"mm").join(" + "):"undefined",actualWidthMm:p+"mm",finalWidth:v.toFixed(3)+" (Three.js units)",logic:y&&c?"slotWidths 합산":a!==void 0?"조정된 폭 사용":"원래 폭 사용",isDragging:s,isEditMode:o,호출스택:(X=new Error().stack)==null?void 0:X.split(`
`).slice(1,4).join(" → ")});const j=v-A*2,D=m-A*2,b=x-Ud(8),_=Ud(4),{renderMode:I,viewMode:S}=Qi(),{theme:F}=Yo(),B=s?T():t||(d.interiorColor===d.doorColor?d.doorColor:d.interiorColor);h&&console.log("🌟 useBaseFurniture - 가구 강조 상태:",{moduleId:n.id,isHighlighted:h,isDragging:s,색상:B});const E=O.useMemo(()=>{const Z=new oo({color:new Yr("#FFFFFF"),metalness:0,roughness:.6,envMapIntensity:0,emissive:new Yr(0)});return console.log("🎨 useBaseFurniture 재질 생성 (한 번만)"),Z},[]);O.useEffect(()=>{E&&(s?(E.color.set(T()),E.map=null,E.emissive.set(new Yr(T())),E.emissiveIntensity=.2):h?(E.emissive.set(new Yr(0)),E.emissiveIntensity=0,E.map||E.color.set(B)):(E.emissive.set(new Yr(0)),E.emissiveIntensity=0,E.map||E.color.set(B)),E.transparent=I==="wireframe"||S==="2D"&&I==="solid"||s||h,E.opacity=I==="wireframe"?.3:S==="2D"&&I==="solid"?.5:s?.6:h?.5:1,E.needsUpdate=!0)},[E,B,I,S,s,o,h]),O.useEffect(()=>{if(s||o){E&&(E.map=null,E.needsUpdate=!0);return}const Z=d.interiorTexture;if(console.log("🎨 useBaseFurniture 텍스처 적용 시작:",{textureUrl:Z,hasMaterial:!!E,furnitureColor:B,isDragging:s,materialConfig:d,isCabinetTexture1:Z?gd(Z):!1}),Z&&E){gd(Z)&&(console.log("🎨 Cabinet Texture1 즉시 어둡게 적용 중..."),Sm(E),console.log("✅ Cabinet Texture1 즉시 색상 적용 완료 (공통 설정 사용):",{color:E.color.getHexString(),toneMapped:E.toneMapped,roughness:E.roughness}),E.needsUpdate=!0);const Q=new xg,U=Z.startsWith("http")?Z:`${window.location.origin}${Z}`;console.log("🔄 텍스처 로딩 시작:",{원본URL:Z,전체URL:U,현재위치:window.location.href}),Q.load(Z,z=>{if(s||o){z.dispose();return}console.log("✅ 텍스처 로딩 성공:",{url:Z,image:z.image,size:z.image?`${z.image.width}x${z.image.height}`:"unknown"}),z.wrapS=Gh,z.wrapT=Gh,z.repeat.set(1,1),E.map=z,gd(Z)||(E.color.setHex(16777215),E.toneMapped=!0,E.roughness=.6),E.needsUpdate=!0,requestAnimationFrame(()=>{var q,G;E.needsUpdate=!0,console.log("🔄 서랍/선반 텍스처 강제 업데이트 완료:",{hasMap:!!E.map,mapImage:(G=(q=E.map)==null?void 0:q.image)==null?void 0:G.src,color:E.color.getHexString(),toneMapped:E.toneMapped,roughness:E.roughness})})},void 0,z=>{console.error("❌ 텍스처 로딩 실패:",Z,z)})}else E&&(console.log("🧹 텍스처 제거, 색상만 사용"),E.map&&(E.map.dispose(),E.map=null),E.color.set(B),E.toneMapped=!0,E.roughness=.6,E.needsUpdate=!0)},[d.interiorTexture,E,B,s,o]);const V=t||d.doorColor,K=(Z,Q)=>{switch(Z.heightType||"percentage"){case"absolute":{const z=Ud(Z.height);return Math.min(z,Q)}case"percentage":default:return Q*(Z.height/100)}};return{material:E,doorColor:V,width:v,height:m,depth:x,innerWidth:j,innerHeight:D,actualDepthMm:w,actualWidthMm:p,basicThickness:A,backPanelThickness:g,adjustedDepthForShelves:b,shelfZOffset:_,calculateSectionHeight:K,isMultiSectionFurniture:()=>{const{sections:Z}=f;return!!(Z&&Z.length>=2)},getSectionHeights:()=>{const{sections:Z}=f;if(!Z||Z.length===0)return[];const Q=m-A*2,z=Z.filter(G=>G.heightType==="absolute").reduce((G,ie)=>G+K(ie,Q),0),q=Q-z;return Z.map(G=>G.heightType==="absolute"?K(G,Q):K(G,q))},mmToThreeUnits:Ud,modelConfig:f}},zi=({args:n,position:e,material:t,renderMode:i="solid",isDragging:r=!1,isEditMode:s=!1,hideEdges:o=!1,isBackPanel:a=!1,isEndPanel:c=!1,onClick:h,onPointerOver:u,onPointerOut:d})=>{const{viewMode:f}=Qi(),{view2DDirection:A}=Bi(),{gl:g}=jl(),{theme:p}=Yh(),{view2DTheme:y}=Bi(),v=ii.useMemo(()=>{if(r&&t instanceof oo){const w=t.clone();w.transparent=!0,w.opacity=.6;const x=()=>{if(typeof window<"u"){const j=getComputedStyle(document.documentElement).getPropertyValue("--theme-primary").trim();if(j)return j}return"#10b981"};return w.color=new Yr(x()),w.needsUpdate=!0,w}return t},[t,r,s]),m=ii.useMemo(()=>{if(t instanceof oo){const w=t.color;if(Math.abs(w.r-.12)<.01&&Math.abs(w.g-.12)<.01&&Math.abs(w.b-.12)<.01)return"#"+new Yr(.12,.12,.12).getHexString()}return f==="3D"?"#505050":i==="wireframe"?y==="dark"?"#FFFFFF":"#000000":y==="dark"?"#FFFFFF":"#444444"},[f,i,y,A,t]);return ii.useEffect(()=>{f==="2D"&&i==="solid"&&console.log("🎨 BoxWithEdges 2D 솔리드 모드:",{edgeColor:m,view2DTheme:y,transparent:f==="3D",opacity:f==="3D"?.9:1,position:e})},[f,i,m,y,e]),l.jsxs("group",{position:e,children:[l.jsxs("mesh",{receiveShadow:f==="3D"&&i==="solid",castShadow:f==="3D"&&i==="solid",onClick:h,onPointerOver:u,onPointerOut:d,children:[l.jsx("boxGeometry",{args:n}),i==="wireframe"?l.jsx("meshBasicMaterial",{transparent:!0,opacity:0}):l.jsx("primitive",{object:v,attach:"material"})]}),!o&&l.jsxs("lineSegments",{children:[l.jsx("edgesGeometry",{args:[new rh(...n)]}),l.jsx("lineBasicMaterial",{color:m,transparent:f==="3D"||a&&f==="2D"&&A==="front",opacity:a&&f==="2D"&&A==="front"?.1:f==="3D"?.9:1,depthTest:f==="3D",depthWrite:!1,polygonOffset:f==="3D",polygonOffsetFactor:f==="3D"?-10:0,polygonOffsetUnits:f==="3D"?-10:0,linewidth:f==="2D"?2:1})]})]})},Xm=({width:n,height:e,depth:t,innerWidth:i,innerHeight:r,basicThickness:s,backPanelThickness:o,adjustedDepthForShelves:a,shelfZOffset:c,material:h,isMultiSectionFurniture:u,getSectionHeights:d,mmToThreeUnits:f,isDragging:A=!1,isEditMode:g=!1,isHighlighted:p=!1,hasBackPanel:y=!0,children:v})=>{const{renderMode:m,viewMode:w}=Qi(),{gl:x}=jl(),{theme:T}=Yo(),{view2DDirection:j}=Bi();return console.log("🔍 BaseFurnitureShell 렌더링:",{width:n*100+"mm",innerWidth:i*100+"mm",basicThickness:s*100+"mm",계산식:`${n*100} - ${s*100*2} = ${i*100}`,측면패널_좌:`x: ${(-i/2-s/2)*100}mm`,측면패널_우:`x: ${(i/2+s/2)*100}mm`,전체너비:`${(i/2+s/2-(-i/2-s/2))*100}mm`,isDragging:A,isEditMode:g,renderMode:m,viewMode:w}),l.jsxs("group",{children:[l.jsxs(l.Fragment,{children:[l.jsx(zi,{args:[s,e,t],position:[-i/2-s/2,0,0],material:h,renderMode:m,isDragging:A}),l.jsx(zi,{args:[s,e,t],position:[i/2+s/2,0,0],material:h,renderMode:m,isDragging:A}),u()&&d().length>1&&l.jsx(l.Fragment,{children:d().map((D,b)=>{if(b>=d().length-1)return null;let _=-e/2+s;for(let S=0;S<=b;S++)_+=d()[S];const I=_-s/2;return l.jsx(zi,{args:[i,s,a-s],position:[0,I,s/2+c],material:h,renderMode:m,isDragging:A},`divider-${b}`)})})]}),l.jsx(zi,{args:[i,s,t],position:[0,e/2-s/2,0],material:h,renderMode:m,isDragging:A}),l.jsx(zi,{args:[i,s,t],position:[0,-e/2+s/2,0],material:h,renderMode:m,isDragging:A}),y&&l.jsx(zi,{args:[i+f(10),r+f(10),o],position:[0,0,-t/2+o/2+f(17)],material:h,renderMode:m,isDragging:A,isBackPanel:!0}),v]})},R0=({shelfCount:n,innerWidth:e,innerHeight:t,depth:i,basicThickness:r,material:s,yOffset:o=0,zOffset:a=0,shelfPositions:c,isTopFinishPanel:h,renderMode:u,furnitureId:d,showTopFrameDimension:f=!1})=>{const A=Bi(I=>I.showDimensions),g=Bi(I=>I.view2DDirection),p=Bi(I=>I.view2DTheme),y=Bi(I=>I.highlightedCompartment),v=Bi(I=>I.setHighlightedCompartment),{theme:m}=Yh(),{viewMode:w}=Qi(),x=I=>I/100,T=()=>getComputedStyle(document.documentElement).getPropertyValue("--theme-primary").trim()||"#10b981",j=w==="3D"?T():p==="dark"?"#ffffff":T(),D=j,b=w==="3D"?.45:.32;if(n<=0)return null;if(h&&n===1){const I=t/2-r/2;return l.jsx("group",{position:[0,o,0],children:l.jsx(zi,{args:[e,r,i-r],position:[0,I,r/2+a],material:s,renderMode:u})})}if(c&&c.length===n)return l.jsxs("group",{position:[0,o,0],children:[c.map((I,S)=>{const F=-t/2+x(I);return l.jsx(zi,{args:[e,r,i-r],position:[0,F,r/2+a],material:s,renderMode:u},`shelf-${S}`)}),A&&!h&&!(w==="2D"&&g==="top")&&l.jsx("group",{children:(()=>{const I=[];let S=!0,F=0;if(c.length>0){const X=c[0]-r/.01/2;if(F=X,c.length===1&&c[0]>t/.01*.9&&F<100&&(S=!1),S){const Z=x(X),Q=-t/2+Z/2;console.log("🔴 절대위치모드 - 첫 번째 칸:",{shelfPositions_0:c[0],basicThickness:r,basicThickness_mm:r*100,firstShelfBottomMm:X,height:Z,height_mm:Z*100,표시될값:Math.round(Z*100)}),I.push({height:Z,centerY:Q})}}for(let X=0;X<c.length-1;X++){const Z=c[X]+r/.01/2,U=c[X+1]-r/.01/2-Z,z=x(U),q=-t/2+x(Z+U/2);I.push({height:z,centerY:q})}const B=d&&d.includes("dual-2drawer-styler")&&t>2e3;if(c.length>0&&!(c.length===1&&c[0]>t/.01*.9)&&!B){const Z=c[c.length-1]+r/.01/2,U=t/.01-r/.01*2-Z,z=x(U),q=-t/2+x(Z+U/2);I.push({height:z,centerY:q})}const E=[];c.forEach((X,Z)=>{const Q=-t/2+x(X),U=Q+r/2,z=Q-r/2;E.push(l.jsxs("group",{children:[w==="3D"&&l.jsx(zn,{position:[-e/2*.3-.8+.01,Q-.01,(d&&d.includes("-right-section")?3.01:i/2+.1)-.01],fontSize:b,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:998,children:Math.round((r>0?r:.18)*100)}),l.jsx(zn,{position:[w==="3D"?-e/2*.3-.8:-e/2*.3-.5,Q,w==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r/2+a+.5],fontSize:b,color:j,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,children:Math.round((r>0?r:.18)*100)}),l.jsx(it,{points:[[-e/2*.3,U,w==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r/2+a+.5],[-e/2*.3,z,w==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r/2+a+.5]],color:j,lineWidth:1,dashed:!1}),l.jsxs("mesh",{position:[-e/2*.3,U,w==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r/2+a+.5],children:[l.jsx("sphereGeometry",{args:[.05,8,8]}),l.jsx("meshBasicMaterial",{color:j})]}),l.jsxs("mesh",{position:[-e/2*.3,z,w==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r/2+a+.5],children:[l.jsx("sphereGeometry",{args:[.05,8,8]}),l.jsx("meshBasicMaterial",{color:j})]})]},`shelf-thickness-${Z}`))});const K=d&&d.includes("-right-section")?t/2-r/2+r:t/2-r*1.5,P=K+r/2,M=K-r/2;return f&&E.push(l.jsxs("group",{children:[w==="3D"&&l.jsx(zn,{position:[-e/2*.3-.8+.01,K-.01,i/2+.1-.01],fontSize:b,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:998,children:Math.round((r>0?r:.18)*100)}),l.jsx(zn,{position:[w==="3D"?-e/2*.3-.8:-e/2*.3-.5,K,w==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r/2+a+.5],fontSize:b,color:j,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],children:Math.round((r>0?r:.18)*100)}),l.jsx(it,{points:[[-e/2*.3,P,w==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r/2+a+.5],[-e/2*.3,M,w==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r/2+a+.5]],color:j,lineWidth:1,dashed:!1}),l.jsxs("mesh",{position:[-e/2*.3,P,w==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r/2+a+.5],children:[l.jsx("sphereGeometry",{args:[.05,8,8]}),l.jsx("meshBasicMaterial",{color:j})]}),l.jsxs("mesh",{position:[-e/2*.3,M,w==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r/2+a+.5],children:[l.jsx("sphereGeometry",{args:[.05,8,8]}),l.jsx("meshBasicMaterial",{color:j})]})]},"top-frame-thickness")),S?l.jsxs(l.Fragment,{children:[I.map((X,Z)=>{if(d&&d.includes("-right-section")&&I.length>2&&Z===I.length-1)return null;let U,z;if(Z===0)z=-t/2,U=-t/2+x(c[0])-r/2;else if(Z===I.length-1&&c.length>0){const ie=c[c.length-1];z=-t/2+x(ie)+r/2;const H=t/.01-r/.01*2;U=-t/2+x(H)}else{const ie=c[Z-1],H=c[Z];z=-t/2+x(ie)+r/2,U=-t/2+x(H)-r/2}const q=d?`${d}-${Z}`:null,G=q&&y===q;return l.jsxs("group",{children:[w==="3D"&&l.jsx(zn,{position:[-e/2*.3-.8+.01,X.centerY-.01,(d&&d.includes("-right-section")?3.01:i/2+.1)-.01],fontSize:b,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:998,children:Math.round(X.height*100)}),l.jsx(zn,{position:[w==="3D"?-e/2*.3-.8:-e/2*.3-.5,X.centerY,w==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r+a+.2],fontSize:b,color:G?"#FFD700":D,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,onClick:ie=>{ie.stopPropagation(),q&&v(y===q?null:q)},onPointerOver:ie=>{ie.stopPropagation(),document.body.style.cursor="pointer"},onPointerOut:ie=>{ie.stopPropagation(),document.body.style.cursor="auto"},children:Math.round(X.height*100)}),l.jsx(it,{points:[[-e/2*.3,U,w==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r+a+.15],[-e/2*.3,z,w==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r+a+.15]],color:G?"#FFD700":j,lineWidth:G?2:1,dashed:!1}),l.jsxs("mesh",{position:[-e/2*.3,U,w==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r+a+.15],children:[l.jsx("sphereGeometry",{args:[.05,8,8]}),l.jsx("meshBasicMaterial",{color:G?"#FFD700":j})]}),l.jsxs("mesh",{position:[-e/2*.3,z,w==="3D"?d&&d.includes("-right-section")?3.01:i/2+.1:r+a+.15],children:[l.jsx("sphereGeometry",{args:[.05,8,8]}),l.jsx("meshBasicMaterial",{color:G?"#FFD700":j})]})]},`dimension-${Z}`)}),E]}):null})()})]});const _=t/(n+1);return l.jsxs("group",{position:[0,o,0],children:[Array.from({length:n},(I,S)=>{const F=-t/2+_*(S+1);return l.jsx(zi,{args:[e,r,i-r],position:[0,F,r/2+a],material:s,renderMode:u},`shelf-${S}`)}),A&&!(w==="2D"&&g==="top")&&l.jsx("group",{children:Array.from({length:n+1},(I,S)=>{let F,B,E;if(S===0)B=-t/2,F=-t/2+_-B,E=B+F/2;else if(S===n){const X=-t/2+_*n;B=X,F=t/2-X,E=B+F/2}else{const X=-t/2+_*S,Z=-t/2+_*(S+1);B=X,F=Z-X,E=B+F/2}const V=Math.round(F*100);console.log("🟢 균등분할모드 - 칸 높이:",{i:S,innerHeight:t,innerHeight_mm:t*100,shelfSpacing:_,shelfSpacing_mm:_*100,compartmentHeight:F,compartmentHeight_mm:F*100,compartmentHeightMm:V,표시될값:V});const K=B+F,P=d?`${d}-${S}`:null,M=P&&y===P;return l.jsxs("group",{children:[w==="3D"&&l.jsx(zn,{position:[-e/2*.3-.8+.01,E-.01,i/2+.1-.01],fontSize:b,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:998,children:V}),l.jsx(zn,{position:[w==="3D"?-e/2*.3-.8:0,E,w==="3D"?i/2+.1:r+a+.2],fontSize:b,color:M?"#FFD700":D,anchorX:"center",anchorY:"middle",rotation:[0,0,w==="3D"?Math.PI/2:-Math.PI/2],onClick:X=>{X.stopPropagation(),P&&v(y===P?null:P)},onPointerOver:X=>{X.stopPropagation(),document.body.style.cursor="pointer"},onPointerOut:X=>{X.stopPropagation(),document.body.style.cursor="auto"},children:V}),l.jsx(it,{points:[[-e/2*.8,K,r+a+.1],[e/2*.8,K,r+a+.1]],color:M?"#FFD700":j,lineWidth:M?2:1,dashed:!0,dashSize:.02,gapSize:.01}),l.jsx(it,{points:[[-e/2*.8,B,r+a+.1],[e/2*.8,B,r+a+.1]],color:M?"#FFD700":j,lineWidth:M?2:1,dashed:!0,dashSize:.02,gapSize:.01}),l.jsx(it,{points:[[0,K,r+a+.15],[0,B,r+a+.15]],color:M?"#FFD700":j,lineWidth:M?2:1})]},`dimension-${S}`)})})]})},pI=({drawerCount:n,innerWidth:e,innerHeight:t,depth:i,basicThickness:r,yOffset:s=0,drawerHeights:o,gapHeight:a=0,material:c,renderMode:h})=>{const u=Bi(x=>x.showDimensions),d=Bi(x=>x.view2DDirection),{viewMode:f}=Qi();f==="3D"&&(getComputedStyle(document.documentElement).getPropertyValue("--theme-primary").trim()||"#10b981");const g=f==="3D"?.45:.32;if(n<=0)return null;const p=x=>x*.01,y=p(0),m=p(18),w=(x,T,j,D,b,_=!1)=>{const[I,S,F]=D,B=j-p(47),E=B-m,V=F-m/2;return l.jsxs("group",{children:[l.jsx(zi,{args:[x-p(76)-p(26),p(5),E-p(26)],position:[I,S-T/2+r+p(15)+p(5)/2,V],material:c,renderMode:h}),l.jsx(zi,{args:[x-p(76),T-p(30),r],position:[I,S,V+E/2-r/2],material:c,renderMode:h}),l.jsx(zi,{args:[x-p(76),T-p(30),r],position:[I,S,V-E/2+r/2],material:c,renderMode:h}),l.jsx(zi,{args:[r,T-p(30),E-r*2],position:[I-x/2+r/2+p(38),S,V],material:c,renderMode:h}),l.jsx(zi,{args:[r,T-p(30),E-r*2],position:[I+x/2-r/2-p(38),S,V],material:c,renderMode:h}),l.jsx(zi,{args:[x,T,m],position:[I,S,F+B/2-m/2],material:c,renderMode:h}),u&&!(f==="2D"&&d==="top")&&l.jsxs("group",{children:[_&&f==="2D"&&l.jsx(it,{points:[[I-p(30),S+T/2+p(a||23.6)-p(30),F+B/2+.1],[I,S+T/2+p(a||23.6),F+B/2+.1],[I+p(30),S+T/2+p(a||23.6)-p(30),F+B/2+.1],[I-p(30),S+T/2+p(a||23.6)-p(30),F+B/2+.1]],color:"#FF0000",lineWidth:1,dashed:!1}),l.jsxs("group",{children:[f==="3D"&&l.jsxs(zn,{position:[I+.01,S-.01,f==="3D"?i/2+.1-.01:F+B/2+.1],fontSize:g,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",renderOrder:998,children:["D",Math.round((B-m)*100)]}),l.jsxs(zn,{position:[I,S,f==="3D"?i/2+.1:F+B/2+.1],fontSize:g,color:"#008B8B",anchorX:"center",anchorY:"middle",renderOrder:999,depthTest:!1,children:["D",Math.round((B-m)*100)]})]})]})]},b)};if(o&&o.length===n&&a>0){let x=-t/2;return x+=p(a),l.jsx("group",{position:[0,s,y],children:o.map((T,j)=>{const D=x+p(T)/2,b=w(e-p(24),p(T)-r/2,i-r,[0,D,r/2],`custom-drawer-${j}`,j===o.length-1);return x+=p(T+a),b})})}else{const x=t/n;return l.jsx("group",{position:[0,s,y],children:Array.from({length:n},(T,j)=>{const D=-t/2+(j+.5)*x;return w(e-p(24),x-r/2,i-r,[0,D,r/2],`drawer-${j}`,j===n-1)})})}},ch=({modelConfig:n,height:e,innerWidth:t,depth:i,adjustedDepthForShelves:r,basicThickness:s,shelfZOffset:o,material:a,renderMode:c,calculateSectionHeight:h,furnitureId:u})=>{const d=Bi(w=>w.showDimensions),f=Bi(w=>w.view2DDirection),{viewMode:A}=Qi(),g=Yh(),p=()=>getComputedStyle(document.documentElement).getPropertyValue("--theme-primary").trim()||"#10b981",y=A==="3D"?p():g.theme.mode==="dark"?"#ffffff":p(),v=A==="3D"?.45:.32,m=()=>{const{sections:w}=n;if(!w||w.length===0)return null;const x=e-s*2,j=w.filter(I=>I.heightType==="absolute").reduce((I,S)=>I+h(S,x),0),D=x-j,b=w.map(I=>({...I,calculatedHeight:I.heightType==="absolute"?h(I,x):h(I,D)}));let _=-e/2+s;return b.map((I,S)=>{const F=I.calculatedHeight,B=_+F/2;S===0&&console.log("🔍 첫 번째 섹션 정보:",{index:S,type:I.type,height:F,showDimensions:d,viewMode:A,view2DDirection:f,condition:I.type==="drawer"||I.type==="open"||I.type==="hanging"}),(I.type==="open"||I.type==="drawer")&&console.log(`📏 Section ${S} (${I.type}):`,{calculatedHeight:F,calculatedHeightMm:Math.round(F*100),totalHeight:e,totalHeightMm:Math.round(e*100),availableHeight:e-s*2,availableHeightMm:Math.round((e-s*2)*100)});let E=null;switch(I.type){case"shelf":I.count&&I.count>0&&(E=l.jsx(R0,{shelfCount:I.count,innerWidth:t,innerHeight:F,depth:r,basicThickness:s,material:a,yOffset:B,zOffset:o,shelfPositions:I.shelfPositions,isTopFinishPanel:I.isTopFinishPanel,showTopFrameDimension:S===0,renderMode:c,furnitureId:u}));break;case"hanging":E=l.jsx(R0,{shelfCount:I.shelfPositions?I.shelfPositions.length:0,innerWidth:t,innerHeight:F,depth:r,basicThickness:s,material:a,yOffset:B,zOffset:o,shelfPositions:I.shelfPositions,isTopFinishPanel:I.isTopFinishPanel,showTopFrameDimension:S===0,renderMode:c,furnitureId:u,sectionType:I.type,sectionInternalHeight:I.internalHeight,isLastSection:S===b.length-1});break;case"drawer":I.count&&I.count>0&&(E=l.jsx(pI,{drawerCount:I.count,innerWidth:t,innerHeight:F,depth:i,basicThickness:s,yOffset:B,drawerHeights:I.drawerHeights,gapHeight:I.gapHeight,material:a,renderMode:c}));break}const V=S<b.length-1,K=_+F+s/2-s;return _+=F,l.jsxs("group",{children:[E,d&&!(A==="2D"&&f==="top")&&(I.type==="drawer"||I.type==="hanging"&&(!I.shelfPositions||I.shelfPositions.length===0))&&l.jsx("group",{children:(()=>{let P,M,X;if(I.type==="hanging"||I.type==="drawer"){const Q=B-F/2,U=B+F/2;S===0?P=-e/2+s:(P=Q+s,I.type==="hanging"&&(!I.shelfPositions||I.shelfPositions.length===0)&&(P=Q)),I.type==="hanging"&&console.log("🔍 Hanging 섹션 치수 계산:",{index:S,sectionType:I.type,hasShelfPositions:!!(I.shelfPositions&&I.shelfPositions.length>0),shelfPositions:I.shelfPositions,sectionBottomY:Q,sectionTopY:U,bottomY:P,basicThickness:s,basicThickness_mm:s*100,height:e,calculatedHeight:I.calculatedHeight,sectionHeight:F}),S===b.length-1?M=e/2-s:M=U-s,X=(M-P)/.01}else P=B-F/2,M=B+F/2,X=F/.01;const Z=(M+P)/2;return l.jsxs(l.Fragment,{children:[A==="3D"&&l.jsx(zn,{position:[-t/2*.3-.8+.01,Z-.01,i/2+.1-.01],fontSize:v,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:998,children:Math.round(X)}),l.jsx(zn,{position:[A==="3D"?-t/2*.3-.8:-t/2*.3-.5,Z,A==="3D"?i/2+.1:s+.2],fontSize:v,color:y,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,depthTest:!1,children:Math.round(X)}),l.jsx(it,{points:[[-t/2*.3,M,A==="3D"?i/2+.1:s+.15],[-t/2*.3,P,A==="3D"?i/2+.1:s+.15]],color:y,lineWidth:1,dashed:!1}),l.jsxs("mesh",{position:[-t/2*.3,M,A==="3D"?i/2+.1:s+.15],children:[l.jsx("sphereGeometry",{args:[.05,8,8]}),l.jsx("meshBasicMaterial",{color:y})]}),l.jsxs("mesh",{position:[-t/2*.3,P,A==="3D"?i/2+.1:s+.15],children:[l.jsx("sphereGeometry",{args:[.05,8,8]}),l.jsx("meshBasicMaterial",{color:y})]})]})})()}),d&&!(A==="2D"&&f==="top")&&S===0&&l.jsxs("group",{children:[A==="3D"&&l.jsx(zn,{position:[-t/2*.3-.8+.01,-e/2+s/2-.01,i/2+.1-.01],fontSize:v,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:998,children:Math.round((s>0?s:.18)*100)}),l.jsx(zn,{position:[A==="3D"?-t/2*.3-.8:-t/2*.3-.5,-e/2+s/2,A==="3D"?i/2+.1:s/2+.8],fontSize:v,color:y,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,depthTest:!1,children:Math.round((s>0?s:.18)*100)}),l.jsx(it,{points:[[-t/2*.3,-e/2,A==="3D"?i/2+.1:s/2+.5],[-t/2*.3,-e/2+s,A==="3D"?i/2+.1:s/2+.5]],color:y,lineWidth:1,dashed:!1}),l.jsxs("mesh",{position:[-t/2*.3,-e/2,A==="3D"?i/2+.1:s/2+.5],children:[l.jsx("sphereGeometry",{args:[.05,8,8]}),l.jsx("meshBasicMaterial",{color:y})]}),l.jsxs("mesh",{position:[-t/2*.3,-e/2+s,A==="3D"?i/2+.1:s/2+.5],children:[l.jsx("sphereGeometry",{args:[.05,8,8]}),l.jsx("meshBasicMaterial",{color:y})]})]}),d&&!(A==="2D"&&f==="top")&&V&&l.jsxs("group",{children:[A==="3D"&&l.jsx(zn,{position:[-t/2*.3-.8+.01,K-.01,i/2+.1-.01],fontSize:v,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:998,children:Math.round((s>0?s:.18)*100)}),l.jsx(zn,{position:[A==="3D"?-t/2*.3-.8:-t/2*.3-.5,K,A==="3D"?i/2+.1:s/2+.5],fontSize:v,color:y,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,depthTest:!1,children:Math.round((s>0?s:.18)*100)}),l.jsx(it,{points:[[-t/2*.3,K+s/2,A==="3D"?i/2+.1:s/2+.5],[-t/2*.3,K-s/2,A==="3D"?i/2+.1:s/2+.5]],color:y,lineWidth:1,dashed:!1}),l.jsxs("mesh",{position:[-t/2*.3,K+s/2,A==="3D"?i/2+.1:s/2+.5],children:[l.jsx("sphereGeometry",{args:[.05,8,8]}),l.jsx("meshBasicMaterial",{color:y})]}),l.jsxs("mesh",{position:[-t/2*.3,K-s/2,A==="3D"?i/2+.1:s/2+.5],children:[l.jsx("sphereGeometry",{args:[.05,8,8]}),l.jsx("meshBasicMaterial",{color:y})]})]}),d&&!(A==="2D"&&f==="top")&&S===b.length-1&&l.jsxs("group",{children:[A==="3D"&&l.jsx(zn,{position:[-t/2*.3-.8+.01,e/2-s/2-.01,i/2+.1-.01],fontSize:v,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:998,children:Math.round((s>0?s:.18)*100)}),l.jsx(zn,{position:[A==="3D"?-t/2*.3-.8:-t/2*.3-.5,e/2-s/2,A==="3D"?i/2+.1:s/2+.8],fontSize:v,color:y,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,depthTest:!1,children:Math.round((s>0?s:.18)*100)}),l.jsx(it,{points:[[-t/2*.3,e/2,A==="3D"?i/2+.1:s/2+.5],[-t/2*.3,e/2-s,A==="3D"?i/2+.1:s/2+.5]],color:y,lineWidth:1,dashed:!1}),l.jsxs("mesh",{position:[-t/2*.3,e/2,A==="3D"?i/2+.1:s/2+.5],children:[l.jsx("sphereGeometry",{args:[.05,8,8]}),l.jsx("meshBasicMaterial",{color:y})]}),l.jsxs("mesh",{position:[-t/2*.3,e/2-s,A==="3D"?i/2+.1:s/2+.5],children:[l.jsx("sphereGeometry",{args:[.05,8,8]}),l.jsx("meshBasicMaterial",{color:y})]})]})]},`section-${S}`)})};return l.jsx(l.Fragment,{children:m()})};var gI=Yv(),xr=n=>qv(n,gI),mI=Yv();xr.write=n=>qv(n,mI);var C5=Yv();xr.onStart=n=>qv(n,C5);var yI=Yv();xr.onFrame=n=>qv(n,yI);var vI=Yv();xr.onFinish=n=>qv(n,vI);var nm=[];xr.setTimeout=(n,e)=>{const t=xr.now()+e,i=()=>{const s=nm.findIndex(o=>o.cancel==i);~s&&nm.splice(s,1),xf-=~s?1:0},r={time:t,handler:n,cancel:i};return nm.splice(GQ(t),0,r),xf+=1,XQ(),r};var GQ=n=>~(~nm.findIndex(e=>e.time>n)||~nm.length);xr.cancel=n=>{C5.delete(n),yI.delete(n),vI.delete(n),gI.delete(n),mI.delete(n)};xr.sync=n=>{XB=!0,xr.batchedUpdates(n),XB=!1};xr.throttle=n=>{let e;function t(){try{n(...e)}finally{e=null}}function i(...r){e=r,xr.onStart(t)}return i.handler=n,i.cancel=()=>{C5.delete(t),e=null},i};var wI=typeof window<"u"?window.requestAnimationFrame:(()=>{});xr.use=n=>wI=n;xr.now=typeof performance<"u"?()=>performance.now():Date.now;xr.batchedUpdates=n=>n();xr.catch=console.error;xr.frameLoop="always";xr.advance=()=>{xr.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):qQ()};var wf=-1,xf=0,XB=!1;function qv(n,e){XB?(e.delete(n),n(0)):(e.add(n),XQ())}function XQ(){wf<0&&(wf=0,xr.frameLoop!=="demand"&&wI(KQ))}function rce(){wf=-1}function KQ(){~wf&&(wI(KQ),xr.batchedUpdates(qQ))}function qQ(){const n=wf;wf=xr.now();const e=GQ(wf);if(e&&(YQ(nm.splice(0,e),t=>t.handler()),xf-=e),!xf){rce();return}C5.flush(),gI.flush(n?Math.min(64,wf-n):16.667),yI.flush(),mI.flush(),vI.flush()}function Yv(){let n=new Set,e=n;return{add(t){xf+=e==n&&!n.has(t)?1:0,n.add(t)},delete(t){return xf-=e==n&&n.has(t)?1:0,n.delete(t)},flush(t){e.size&&(n=new Set,xf-=e.size,YQ(e,i=>i(t)&&n.add(i)),xf+=n.size,e=n)}}}function YQ(n,e){n.forEach(t=>{try{e(t)}catch(i){xr.catch(i)}})}var sce=Object.defineProperty,oce=(n,e)=>{for(var t in e)sce(n,t,{get:e[t],enumerable:!0})},Fu={};oce(Fu,{assign:()=>lce,colors:()=>If,createStringInterpolator:()=>bI,skipAnimation:()=>JQ,to:()=>ZQ,willAdvance:()=>_I});function KB(){}var ace=(n,e,t)=>Object.defineProperty(n,e,{value:t,writable:!0,configurable:!0}),ni={arr:Array.isArray,obj:n=>!!n&&n.constructor.name==="Object",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",und:n=>n===void 0};function Zd(n,e){if(ni.arr(n)){if(!ni.arr(e)||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}return n===e}var Bs=(n,e)=>n.forEach(e);function bA(n,e,t){if(ni.arr(n)){for(let i=0;i<n.length;i++)e.call(t,n[i],`${i}`);return}for(const i in n)n.hasOwnProperty(i)&&e.call(t,n[i],i)}var Wh=n=>ni.und(n)?[]:ni.arr(n)?n:[n];function by(n,e){if(n.size){const t=Array.from(n);n.clear(),Bs(t,e)}}var z2=(n,...e)=>by(n,t=>t(...e)),xI=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),bI,ZQ,If=null,JQ=!1,_I=KB,lce=n=>{n.to&&(ZQ=n.to),n.now&&(xr.now=n.now),n.colors!==void 0&&(If=n.colors),n.skipAnimation!=null&&(JQ=n.skipAnimation),n.createStringInterpolator&&(bI=n.createStringInterpolator),n.requestAnimationFrame&&xr.use(n.requestAnimationFrame),n.batchedUpdates&&(xr.batchedUpdates=n.batchedUpdates),n.willAdvance&&(_I=n.willAdvance),n.frameLoop&&(xr.frameLoop=n.frameLoop)},_y=new Set,Rh=[],XS=[],O_=0,S5={get idle(){return!_y.size&&!Rh.length},start(n){O_>n.priority?(_y.add(n),xr.onStart(cce)):(e$(n),xr(qB))},advance:qB,sort(n){if(O_)xr.onFrame(()=>S5.sort(n));else{const e=Rh.indexOf(n);~e&&(Rh.splice(e,1),t$(n))}},clear(){Rh=[],_y.clear()}};function cce(){_y.forEach(e$),_y.clear(),xr(qB)}function e$(n){Rh.includes(n)||t$(n)}function t$(n){Rh.splice(hce(Rh,e=>e.priority>n.priority),0,n)}function qB(n){const e=XS;for(let t=0;t<Rh.length;t++){const i=Rh[t];O_=i.priority,i.idle||(_I(i),i.advance(n),i.idle||e.push(i))}return O_=0,XS=Rh,XS.length=0,Rh=e,Rh.length>0}function hce(n,e){const t=n.findIndex(e);return t<0?n.length:t}var uce={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},xu="[-+]?\\d*\\.?\\d+",U_=xu+"%";function T5(...n){return"\\(\\s*("+n.join(")\\s*,\\s*(")+")\\s*\\)"}var dce=new RegExp("rgb"+T5(xu,xu,xu)),Ace=new RegExp("rgba"+T5(xu,xu,xu,xu)),fce=new RegExp("hsl"+T5(xu,U_,U_)),pce=new RegExp("hsla"+T5(xu,U_,U_,xu)),gce=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,mce=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,yce=/^#([0-9a-fA-F]{6})$/,vce=/^#([0-9a-fA-F]{8})$/;function wce(n){let e;return typeof n=="number"?n>>>0===n&&n>=0&&n<=4294967295?n:null:(e=yce.exec(n))?parseInt(e[1]+"ff",16)>>>0:If&&If[n]!==void 0?If[n]:(e=dce.exec(n))?(r0(e[1])<<24|r0(e[2])<<16|r0(e[3])<<8|255)>>>0:(e=Ace.exec(n))?(r0(e[1])<<24|r0(e[2])<<16|r0(e[3])<<8|Tj(e[4]))>>>0:(e=gce.exec(n))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+"ff",16)>>>0:(e=vce.exec(n))?parseInt(e[1],16)>>>0:(e=mce.exec(n))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+e[4]+e[4],16)>>>0:(e=fce.exec(n))?(Cj(Sj(e[1]),Zw(e[2]),Zw(e[3]))|255)>>>0:(e=pce.exec(n))?(Cj(Sj(e[1]),Zw(e[2]),Zw(e[3]))|Tj(e[4]))>>>0:null}function KS(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function Cj(n,e,t){const i=t<.5?t*(1+e):t+e-t*e,r=2*t-i,s=KS(r,i,n+1/3),o=KS(r,i,n),a=KS(r,i,n-1/3);return Math.round(s*255)<<24|Math.round(o*255)<<16|Math.round(a*255)<<8}function r0(n){const e=parseInt(n,10);return e<0?0:e>255?255:e}function Sj(n){return(parseFloat(n)%360+360)%360/360}function Tj(n){const e=parseFloat(n);return e<0?0:e>1?255:Math.round(e*255)}function Zw(n){const e=parseFloat(n);return e<0?0:e>100?1:e/100}function Bj(n){let e=wce(n);if(e===null)return n;e=e||0;const t=(e&4278190080)>>>24,i=(e&16711680)>>>16,r=(e&65280)>>>8,s=(e&255)/255;return`rgba(${t}, ${i}, ${r}, ${s})`}var ov=(n,e,t)=>{if(ni.fun(n))return n;if(ni.arr(n))return ov({range:n,output:e,extrapolate:t});if(ni.str(n.output[0]))return bI(n);const i=n,r=i.output,s=i.range||[0,1],o=i.extrapolateLeft||i.extrapolate||"extend",a=i.extrapolateRight||i.extrapolate||"extend",c=i.easing||(h=>h);return h=>{const u=bce(h,s);return xce(h,s[u],s[u+1],r[u],r[u+1],c,o,a,i.map)}};function xce(n,e,t,i,r,s,o,a,c){let h=c?c(n):n;if(h<e){if(o==="identity")return h;o==="clamp"&&(h=e)}if(h>t){if(a==="identity")return h;a==="clamp"&&(h=t)}return i===r?i:e===t?n<=e?i:r:(e===-1/0?h=-h:t===1/0?h=h-e:h=(h-e)/(t-e),h=s(h),i===-1/0?h=-h:r===1/0?h=h+i:h=h*(r-i)+i,h)}function bce(n,e){for(var t=1;t<e.length-1&&!(e[t]>=n);++t);return t-1}var _ce={linear:n=>n},av=Symbol.for("FluidValue.get"),Tm=Symbol.for("FluidValue.observers"),nd=n=>!!(n&&n[av]),Nh=n=>n&&n[av]?n[av]():n,Ej=n=>n[Tm]||null;function Cce(n,e){n.eventObserved?n.eventObserved(e):n(e)}function H_(n,e){const t=n[Tm];t&&t.forEach(i=>{Cce(i,e)})}var Sce=class{constructor(n){if(!n&&!(n=this.get))throw Error("Unknown getter");Tce(this,n)}},Tce=(n,e)=>n$(n,av,e);function Zv(n,e){if(n[av]){let t=n[Tm];t||n$(n,Tm,t=new Set),t.has(e)||(t.add(e),n.observerAdded&&n.observerAdded(t.size,e))}return e}function W_(n,e){const t=n[Tm];if(t&&t.has(e)){const i=t.size-1;i?t.delete(e):n[Tm]=null,n.observerRemoved&&n.observerRemoved(i,e)}}var n$=(n,e,t)=>Object.defineProperty(n,e,{value:t,writable:!0,configurable:!0}),Vb=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,Bce=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,kj=new RegExp(`(${Vb.source})(%|[a-z]+)`,"i"),Ece=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,B5=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,i$=n=>{const[e,t]=kce(n);if(!e||xI())return n;const i=window.getComputedStyle(document.documentElement).getPropertyValue(e);if(i)return i.trim();if(t&&t.startsWith("--")){const r=window.getComputedStyle(document.documentElement).getPropertyValue(t);return r||n}else{if(t&&B5.test(t))return i$(t);if(t)return t}return n},kce=n=>{const e=B5.exec(n);if(!e)return[,];const[,t,i]=e;return[t,i]},qS,Ice=(n,e,t,i,r)=>`rgba(${Math.round(e)}, ${Math.round(t)}, ${Math.round(i)}, ${r})`,r$=n=>{qS||(qS=If?new RegExp(`(${Object.keys(If).join("|")})(?!\\w)`,"g"):/^\b$/);const e=n.output.map(s=>Nh(s).replace(B5,i$).replace(Bce,Bj).replace(qS,Bj)),t=e.map(s=>s.match(Vb).map(Number)),r=t[0].map((s,o)=>t.map(a=>{if(!(o in a))throw Error('The arity of each "output" value must be equal');return a[o]})).map(s=>ov({...n,output:s}));return s=>{var c;const o=!kj.test(e[0])&&((c=e.find(h=>kj.test(h)))==null?void 0:c.replace(Vb,""));let a=0;return e[0].replace(Vb,()=>`${r[a++](s)}${o||""}`).replace(Ece,Ice)}},CI="react-spring: ",s$=n=>{const e=n;let t=!1;if(typeof e!="function")throw new TypeError(`${CI}once requires a function parameter`);return(...i)=>{t||(e(...i),t=!0)}},Fce=s$(console.warn);function Dce(){Fce(`${CI}The "interpolate" function is deprecated in v9 (use "to" instead)`)}var jce=s$(console.warn);function Pce(){jce(`${CI}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`)}function E5(n){return ni.str(n)&&(n[0]=="#"||/\d/.test(n)||!xI()&&B5.test(n)||n in(If||{}))}var SI=xI()?O.useEffect:O.useLayoutEffect,Nce=()=>{const n=O.useRef(!1);return SI(()=>(n.current=!0,()=>{n.current=!1}),[]),n};function o$(){const n=O.useState()[1],e=Nce();return()=>{e.current&&n(Math.random())}}var a$=n=>O.useEffect(n,Lce),Lce=[];function Ij(n){const e=O.useRef(void 0);return O.useEffect(()=>{e.current=n}),e.current}var lv=Symbol.for("Animated:node"),Mce=n=>!!n&&n[lv]===n,td=n=>n&&n[lv],TI=(n,e)=>ace(n,lv,e),k5=n=>n&&n[lv]&&n[lv].getPayload(),l$=class{constructor(){TI(this,this)}getPayload(){return this.payload||[]}},I5=class c$ extends l${constructor(e){super(),this._value=e,this.done=!0,this.durationProgress=0,ni.num(this._value)&&(this.lastPosition=this._value)}static create(e){return new c$(e)}getPayload(){return[this]}getValue(){return this._value}setValue(e,t){return ni.num(e)&&(this.lastPosition=e,t&&(e=Math.round(e/t)*t,this.done&&(this.lastPosition=e))),this._value===e?!1:(this._value=e,!0)}reset(){const{done:e}=this;this.done=!1,ni.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,e&&(this.lastVelocity=null),this.v0=null)}},Q_=class h$ extends I5{constructor(e){super(0),this._string=null,this._toString=ov({output:[e,e]})}static create(e){return new h$(e)}getValue(){const e=this._string;return e??(this._string=this._toString(this._value))}setValue(e){if(ni.str(e)){if(e==this._string)return!1;this._string=e,this._value=1}else if(super.setValue(e))this._string=null;else return!1;return!0}reset(e){e&&(this._toString=ov({output:[this.getValue(),e]})),this._value=0,super.reset()}},$_={dependencies:null},BI=class extends l${constructor(n){super(),this.source=n,this.setValue(n)}getValue(n){const e={};return bA(this.source,(t,i)=>{Mce(t)?e[i]=t.getValue(n):nd(t)?e[i]=Nh(t):n||(e[i]=t)}),e}setValue(n){this.source=n,this.payload=this._makePayload(n)}reset(){this.payload&&Bs(this.payload,n=>n.reset())}_makePayload(n){if(n){const e=new Set;return bA(n,this._addToPayload,e),Array.from(e)}}_addToPayload(n){$_.dependencies&&nd(n)&&$_.dependencies.add(n);const e=k5(n);e&&Bs(e,t=>this.add(t))}},Rce=class u$ extends BI{constructor(e){super(e)}static create(e){return new u$(e)}getValue(){return this.source.map(e=>e.getValue())}setValue(e){const t=this.getPayload();return e.length==t.length?t.map((i,r)=>i.setValue(e[r])).some(Boolean):(super.setValue(e.map(Oce)),!0)}};function Oce(n){return(E5(n)?Q_:I5).create(n)}function YB(n){const e=td(n);return e?e.constructor:ni.arr(n)?Rce:E5(n)?Q_:I5}var Fj=(n,e)=>{const t=!ni.fun(n)||n.prototype&&n.prototype.isReactComponent;return O.forwardRef((i,r)=>{const s=O.useRef(null),o=t&&O.useCallback(g=>{s.current=Wce(r,g)},[r]),[a,c]=Hce(i,e),h=o$(),u=()=>{const g=s.current;if(t&&!g)return;(g?e.applyAnimatedValues(g,a.getValue(!0)):!1)===!1&&h()},d=new Uce(u,c),f=O.useRef(void 0);SI(()=>(f.current=d,Bs(c,g=>Zv(g,d)),()=>{f.current&&(Bs(f.current.deps,g=>W_(g,f.current)),xr.cancel(f.current.update))})),O.useEffect(u,[]),a$(()=>()=>{const g=f.current;Bs(g.deps,p=>W_(p,g))});const A=e.getComponentProps(a.getValue());return O.createElement(n,{...A,ref:o})})},Uce=class{constructor(n,e){this.update=n,this.deps=e}eventObserved(n){n.type=="change"&&xr.write(this.update)}};function Hce(n,e){const t=new Set;return $_.dependencies=t,n.style&&(n={...n,style:e.createAnimatedStyle(n.style)}),n=new BI(n),$_.dependencies=null,[n,t]}function Wce(n,e){return n&&(ni.fun(n)?n(e):n.current=e),e}var Dj=Symbol.for("AnimatedComponent"),Qce=(n,{applyAnimatedValues:e=()=>!1,createAnimatedStyle:t=r=>new BI(r),getComponentProps:i=r=>r}={})=>{const r={applyAnimatedValues:e,createAnimatedStyle:t,getComponentProps:i},s=o=>{const a=jj(o)||"Anonymous";return ni.str(o)?o=s[o]||(s[o]=Fj(o,r)):o=o[Dj]||(o[Dj]=Fj(o,r)),o.displayName=`Animated(${a})`,o};return bA(n,(o,a)=>{ni.arr(n)&&(a=jj(o)),s[a]=s(o)}),{animated:s}},jj=n=>ni.str(n)?n:n&&ni.str(n.displayName)?n.displayName:ni.fun(n)&&n.name||null;function Pp(n,...e){return ni.fun(n)?n(...e):n}var Cy=(n,e)=>n===!0||!!(e&&n&&(ni.fun(n)?n(e):Wh(n).includes(e))),d$=(n,e)=>ni.obj(n)?e&&n[e]:n,A$=(n,e)=>n.default===!0?n[e]:n.default?n.default[e]:void 0,$ce=n=>n,EI=(n,e=$ce)=>{let t=Vce;n.default&&n.default!==!0&&(n=n.default,t=Object.keys(n));const i={};for(const r of t){const s=e(n[r],r);ni.und(s)||(i[r]=s)}return i},Vce=["config","onProps","onStart","onChange","onPause","onResume","onRest"],zce={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function Gce(n){const e={};let t=0;if(bA(n,(i,r)=>{zce[r]||(e[r]=i,t++)}),t)return e}function f$(n){const e=Gce(n);if(e){const t={to:e};return bA(n,(i,r)=>r in e||(t[r]=i)),t}return{...n}}function cv(n){return n=Nh(n),ni.arr(n)?n.map(cv):E5(n)?Fu.createStringInterpolator({range:[0,1],output:[n,n]})(1):n}function Xce(n){for(const e in n)return!0;return!1}function ZB(n){return ni.fun(n)||ni.arr(n)&&ni.obj(n[0])}function Kce(n,e){var t;(t=n.ref)==null||t.delete(n),e==null||e.delete(n)}function qce(n,e){var t;e&&n.ref!==e&&((t=n.ref)==null||t.delete(n),e.add(n),n.ref=e)}var Yce={default:{tension:170,friction:26}},JB={...Yce.default,mass:1,damping:1,easing:_ce.linear,clamp:!1},Zce=class{constructor(){this.velocity=0,Object.assign(this,JB)}};function Jce(n,e,t){t&&(t={...t},Pj(t,e),e={...t,...e}),Pj(n,e),Object.assign(n,e);for(const o in JB)n[o]==null&&(n[o]=JB[o]);let{frequency:i,damping:r}=n;const{mass:s}=n;return ni.und(i)||(i<.01&&(i=.01),r<0&&(r=0),n.tension=Math.pow(2*Math.PI/i,2)*s,n.friction=4*Math.PI*r*s/i),n}function Pj(n,e){if(!ni.und(e.decay))n.duration=void 0;else{const t=!ni.und(e.tension)||!ni.und(e.friction);(t||!ni.und(e.frequency)||!ni.und(e.damping)||!ni.und(e.mass))&&(n.duration=void 0,n.decay=void 0),t&&(n.frequency=void 0)}}var Nj=[],ehe=class{constructor(){this.changed=!1,this.values=Nj,this.toValues=null,this.fromValues=Nj,this.config=new Zce,this.immediate=!1}};function p$(n,{key:e,props:t,defaultProps:i,state:r,actions:s}){return new Promise((o,a)=>{let c,h,u=Cy(t.cancel??(i==null?void 0:i.cancel),e);if(u)A();else{ni.und(t.pause)||(r.paused=Cy(t.pause,e));let g=i==null?void 0:i.pause;g!==!0&&(g=r.paused||Cy(g,e)),c=Pp(t.delay||0,e),g?(r.resumeQueue.add(f),s.pause()):(s.resume(),f())}function d(){r.resumeQueue.add(f),r.timeouts.delete(h),h.cancel(),c=h.time-xr.now()}function f(){c>0&&!Fu.skipAnimation?(r.delayed=!0,h=xr.setTimeout(A,c),r.pauseQueue.add(d),r.timeouts.add(h)):A()}function A(){r.delayed&&(r.delayed=!1),r.pauseQueue.delete(d),r.timeouts.delete(h),n<=(r.cancelId||0)&&(u=!0);try{s.start({...t,callId:n,cancel:u},o)}catch(g){a(g)}}})}var kI=(n,e)=>e.length==1?e[0]:e.some(t=>t.cancelled)?im(n.get()):e.every(t=>t.noop)?g$(n.get()):fu(n.get(),e.every(t=>t.finished)),g$=n=>({value:n,noop:!0,finished:!0,cancelled:!1}),fu=(n,e,t=!1)=>({value:n,finished:e,cancelled:t}),im=n=>({value:n,cancelled:!0,finished:!1});function m$(n,e,t,i){const{callId:r,parentId:s,onRest:o}=e,{asyncTo:a,promise:c}=t;return!s&&n===a&&!e.reset?c:t.promise=(async()=>{t.asyncId=r,t.asyncTo=n;const h=EI(e,(y,v)=>v==="onRest"?void 0:y);let u,d;const f=new Promise((y,v)=>(u=y,d=v)),A=y=>{const v=r<=(t.cancelId||0)&&im(i)||r!==t.asyncId&&fu(i,!1);if(v)throw y.result=v,d(y),y},g=(y,v)=>{const m=new Lj,w=new Mj;return(async()=>{if(Fu.skipAnimation)throw hv(t),w.result=fu(i,!1),d(w),w;A(m);const x=ni.obj(y)?{...y}:{...v,to:y};x.parentId=r,bA(h,(j,D)=>{ni.und(x[D])&&(x[D]=j)});const T=await i.start(x);return A(m),t.paused&&await new Promise(j=>{t.resumeQueue.add(j)}),T})()};let p;if(Fu.skipAnimation)return hv(t),fu(i,!1);try{let y;ni.arr(n)?y=(async v=>{for(const m of v)await g(m)})(n):y=Promise.resolve(n(g,i.stop.bind(i))),await Promise.all([y.then(u),f]),p=fu(i.get(),!0,!1)}catch(y){if(y instanceof Lj)p=y.result;else if(y instanceof Mj)p=y.result;else throw y}finally{r==t.asyncId&&(t.asyncId=s,t.asyncTo=s?a:void 0,t.promise=s?c:void 0)}return ni.fun(o)&&xr.batchedUpdates(()=>{o(p,i,i.item)}),p})()}function hv(n,e){by(n.timeouts,t=>t.cancel()),n.pauseQueue.clear(),n.resumeQueue.clear(),n.asyncId=n.asyncTo=n.promise=void 0,e&&(n.cancelId=e)}var Lj=class extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise.")}},Mj=class extends Error{constructor(){super("SkipAnimationSignal")}},eE=n=>n instanceof II,the=1,II=class extends Sce{constructor(){super(...arguments),this.id=the++,this._priority=0}get priority(){return this._priority}set priority(n){this._priority!=n&&(this._priority=n,this._onPriorityChange(n))}get(){const n=td(this);return n&&n.getValue()}to(...n){return Fu.to(this,n)}interpolate(...n){return Dce(),Fu.to(this,n)}toJSON(){return this.get()}observerAdded(n){n==1&&this._attach()}observerRemoved(n){n==0&&this._detach()}_attach(){}_detach(){}_onChange(n,e=!1){H_(this,{type:"change",parent:this,value:n,idle:e})}_onPriorityChange(n){this.idle||S5.sort(this),H_(this,{type:"priority",parent:this,priority:n})}},Ag=Symbol.for("SpringPhase"),y$=1,tE=2,nE=4,YS=n=>(n[Ag]&y$)>0,KA=n=>(n[Ag]&tE)>0,I1=n=>(n[Ag]&nE)>0,Rj=(n,e)=>e?n[Ag]|=tE|y$:n[Ag]&=~tE,Oj=(n,e)=>e?n[Ag]|=nE:n[Ag]&=~nE,nhe=class extends II{constructor(n,e){if(super(),this.animation=new ehe,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!ni.und(n)||!ni.und(e)){const t=ni.obj(n)?{...n}:{...e,from:n};ni.und(t.default)&&(t.default=!0),this.start(t)}}get idle(){return!(KA(this)||this._state.asyncTo)||I1(this)}get goal(){return Nh(this.animation.to)}get velocity(){const n=td(this);return n instanceof I5?n.lastVelocity||0:n.getPayload().map(e=>e.lastVelocity||0)}get hasAnimated(){return YS(this)}get isAnimating(){return KA(this)}get isPaused(){return I1(this)}get isDelayed(){return this._state.delayed}advance(n){let e=!0,t=!1;const i=this.animation;let{toValues:r}=i;const{config:s}=i,o=k5(i.to);!o&&nd(i.to)&&(r=Wh(Nh(i.to))),i.values.forEach((h,u)=>{if(h.done)return;const d=h.constructor==Q_?1:o?o[u].lastPosition:r[u];let f=i.immediate,A=d;if(!f){if(A=h.lastPosition,s.tension<=0){h.done=!0;return}let g=h.elapsedTime+=n;const p=i.fromValues[u],y=h.v0!=null?h.v0:h.v0=ni.arr(s.velocity)?s.velocity[u]:s.velocity;let v;const m=s.precision||(p==d?.005:Math.min(1,Math.abs(d-p)*.001));if(ni.und(s.duration))if(s.decay){const w=s.decay===!0?.998:s.decay,x=Math.exp(-(1-w)*g);A=p+y/(1-w)*(1-x),f=Math.abs(h.lastPosition-A)<=m,v=y*x}else{v=h.lastVelocity==null?y:h.lastVelocity;const w=s.restVelocity||m/10,x=s.clamp?0:s.bounce,T=!ni.und(x),j=p==d?h.v0>0:p<d;let D,b=!1;const _=1,I=Math.ceil(n/_);for(let S=0;S<I&&(D=Math.abs(v)>w,!(!D&&(f=Math.abs(d-A)<=m,f)));++S){T&&(b=A==d||A>d==j,b&&(v=-v*x,A=d));const F=-s.tension*1e-6*(A-d),B=-s.friction*.001*v,E=(F+B)/s.mass;v=v+E*_,A=A+v*_}}else{let w=1;s.duration>0&&(this._memoizedDuration!==s.duration&&(this._memoizedDuration=s.duration,h.durationProgress>0&&(h.elapsedTime=s.duration*h.durationProgress,g=h.elapsedTime+=n)),w=(s.progress||0)+g/this._memoizedDuration,w=w>1?1:w<0?0:w,h.durationProgress=w),A=p+s.easing(w)*(d-p),v=(A-h.lastPosition)/n,f=w==1}h.lastVelocity=v,Number.isNaN(A)&&(console.warn("Got NaN while animating:",this),f=!0)}o&&!o[u].done&&(f=!1),f?h.done=!0:e=!1,h.setValue(A,s.round)&&(t=!0)});const a=td(this),c=a.getValue();if(e){const h=Nh(i.to);(c!==h||t)&&!s.decay?(a.setValue(h),this._onChange(h)):t&&s.decay&&this._onChange(c),this._stop()}else t&&this._onChange(c)}set(n){return xr.batchedUpdates(()=>{this._stop(),this._focus(n),this._set(n)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(KA(this)){const{to:n,config:e}=this.animation;xr.batchedUpdates(()=>{this._onStart(),e.decay||this._set(n,!1),this._stop()})}return this}update(n){return(this.queue||(this.queue=[])).push(n),this}start(n,e){let t;return ni.und(n)?(t=this.queue||[],this.queue=[]):t=[ni.obj(n)?n:{...e,to:n}],Promise.all(t.map(i=>this._update(i))).then(i=>kI(this,i))}stop(n){const{to:e}=this.animation;return this._focus(this.get()),hv(this._state,n&&this._lastCallId),xr.batchedUpdates(()=>this._stop(e,n)),this}reset(){this._update({reset:!0})}eventObserved(n){n.type=="change"?this._start():n.type=="priority"&&(this.priority=n.priority+1)}_prepareNode(n){const e=this.key||"";let{to:t,from:i}=n;t=ni.obj(t)?t[e]:t,(t==null||ZB(t))&&(t=void 0),i=ni.obj(i)?i[e]:i,i==null&&(i=void 0);const r={to:t,from:i};return YS(this)||(n.reverse&&([t,i]=[i,t]),i=Nh(i),ni.und(i)?td(this)||this._set(t):this._set(i)),r}_update({...n},e){const{key:t,defaultProps:i}=this;n.default&&Object.assign(i,EI(n,(o,a)=>/^on/.test(a)?d$(o,t):o)),Hj(this,n,"onProps"),D1(this,"onProps",n,this);const r=this._prepareNode(n);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");const s=this._state;return p$(++this._lastCallId,{key:t,props:n,defaultProps:i,state:s,actions:{pause:()=>{I1(this)||(Oj(this,!0),z2(s.pauseQueue),D1(this,"onPause",fu(this,F1(this,this.animation.to)),this))},resume:()=>{I1(this)&&(Oj(this,!1),KA(this)&&this._resume(),z2(s.resumeQueue),D1(this,"onResume",fu(this,F1(this,this.animation.to)),this))},start:this._merge.bind(this,r)}}).then(o=>{if(n.loop&&o.finished&&!(e&&o.noop)){const a=v$(n);if(a)return this._update(a,!0)}return o})}_merge(n,e,t){if(e.cancel)return this.stop(!0),t(im(this));const i=!ni.und(n.to),r=!ni.und(n.from);if(i||r)if(e.callId>this._lastToId)this._lastToId=e.callId;else return t(im(this));const{key:s,defaultProps:o,animation:a}=this,{to:c,from:h}=a;let{to:u=c,from:d=h}=n;r&&!i&&(!e.default||ni.und(u))&&(u=d),e.reverse&&([u,d]=[d,u]);const f=!Zd(d,h);f&&(a.from=d),d=Nh(d);const A=!Zd(u,c);A&&this._focus(u);const g=ZB(e.to),{config:p}=a,{decay:y,velocity:v}=p;(i||r)&&(p.velocity=0),e.config&&!g&&Jce(p,Pp(e.config,s),e.config!==o.config?Pp(o.config,s):void 0);let m=td(this);if(!m||ni.und(u))return t(fu(this,!0));const w=ni.und(e.reset)?r&&!e.default:!ni.und(d)&&Cy(e.reset,s),x=w?d:this.get(),T=cv(u),j=ni.num(T)||ni.arr(T)||E5(T),D=!g&&(!j||Cy(o.immediate||e.immediate,s));if(A){const S=YB(u);if(S!==m.constructor)if(D)m=this._set(T);else throw Error(`Cannot animate between ${m.constructor.name} and ${S.name}, as the "to" prop suggests`)}const b=m.constructor;let _=nd(u),I=!1;if(!_){const S=w||!YS(this)&&f;(A||S)&&(I=Zd(cv(x),T),_=!I),(!Zd(a.immediate,D)&&!D||!Zd(p.decay,y)||!Zd(p.velocity,v))&&(_=!0)}if(I&&KA(this)&&(a.changed&&!w?_=!0:_||this._stop(c)),!g&&((_||nd(c))&&(a.values=m.getPayload(),a.toValues=nd(u)?null:b==Q_?[1]:Wh(T)),a.immediate!=D&&(a.immediate=D,!D&&!w&&this._set(c)),_)){const{onRest:S}=a;Bs(rhe,B=>Hj(this,e,B));const F=fu(this,F1(this,c));z2(this._pendingCalls,F),this._pendingCalls.add(t),a.changed&&xr.batchedUpdates(()=>{var B;a.changed=!w,S==null||S(F,this),w?Pp(o.onRest,F):(B=a.onStart)==null||B.call(a,F,this)})}w&&this._set(x),g?t(m$(e.to,e,this._state,this)):_?this._start():KA(this)&&!A?this._pendingCalls.add(t):t(g$(x))}_focus(n){const e=this.animation;n!==e.to&&(Ej(this)&&this._detach(),e.to=n,Ej(this)&&this._attach())}_attach(){let n=0;const{to:e}=this.animation;nd(e)&&(Zv(e,this),eE(e)&&(n=e.priority+1)),this.priority=n}_detach(){const{to:n}=this.animation;nd(n)&&W_(n,this)}_set(n,e=!0){const t=Nh(n);if(!ni.und(t)){const i=td(this);if(!i||!Zd(t,i.getValue())){const r=YB(t);!i||i.constructor!=r?TI(this,r.create(t)):i.setValue(t),i&&xr.batchedUpdates(()=>{this._onChange(t,e)})}}return td(this)}_onStart(){const n=this.animation;n.changed||(n.changed=!0,D1(this,"onStart",fu(this,F1(this,n.to)),this))}_onChange(n,e){e||(this._onStart(),Pp(this.animation.onChange,n,this)),Pp(this.defaultProps.onChange,n,this),super._onChange(n,e)}_start(){const n=this.animation;td(this).reset(Nh(n.to)),n.immediate||(n.fromValues=n.values.map(e=>e.lastPosition)),KA(this)||(Rj(this,!0),I1(this)||this._resume())}_resume(){Fu.skipAnimation?this.finish():S5.start(this)}_stop(n,e){if(KA(this)){Rj(this,!1);const t=this.animation;Bs(t.values,r=>{r.done=!0}),t.toValues&&(t.onChange=t.onPause=t.onResume=void 0),H_(this,{type:"idle",parent:this});const i=e?im(this.get()):fu(this.get(),F1(this,n??t.to));z2(this._pendingCalls,i),t.changed&&(t.changed=!1,D1(this,"onRest",i,this))}}};function F1(n,e){const t=cv(e),i=cv(n.get());return Zd(i,t)}function v$(n,e=n.loop,t=n.to){const i=Pp(e);if(i){const r=i!==!0&&f$(i),s=(r||n).reverse,o=!r||r.reset;return uv({...n,loop:e,default:!1,pause:void 0,to:!s||ZB(t)?t:void 0,from:o?n.from:void 0,reset:o,...r})}}function uv(n){const{to:e,from:t}=n=f$(n),i=new Set;return ni.obj(e)&&Uj(e,i),ni.obj(t)&&Uj(t,i),n.keys=i.size?Array.from(i):null,n}function ihe(n){const e=uv(n);return ni.und(e.default)&&(e.default=EI(e)),e}function Uj(n,e){bA(n,(t,i)=>t!=null&&e.add(i))}var rhe=["onStart","onRest","onChange","onPause","onResume"];function Hj(n,e,t){n.animation[t]=e[t]!==A$(e,t)?d$(e[t],n.key):void 0}function D1(n,e,...t){var i,r,s,o;(r=(i=n.animation)[e])==null||r.call(i,...t),(o=(s=n.defaultProps)[e])==null||o.call(s,...t)}var she=["onStart","onChange","onRest"],ohe=1,ahe=class{constructor(n,e){this.id=ohe++,this.springs={},this.queue=[],this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),e&&(this._flush=e),n&&this.start({default:!0,...n})}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(n=>n.idle&&!n.isDelayed&&!n.isPaused)}get item(){return this._item}set item(n){this._item=n}get(){const n={};return this.each((e,t)=>n[t]=e.get()),n}set(n){for(const e in n){const t=n[e];ni.und(t)||this.springs[e].set(t)}}update(n){return n&&this.queue.push(uv(n)),this}start(n){let{queue:e}=this;return n?e=Wh(n).map(uv):this.queue=[],this._flush?this._flush(this,e):(C$(this,e),iE(this,e))}stop(n,e){if(n!==!!n&&(e=n),e){const t=this.springs;Bs(Wh(e),i=>t[i].stop(!!n))}else hv(this._state,this._lastAsyncId),this.each(t=>t.stop(!!n));return this}pause(n){if(ni.und(n))this.start({pause:!0});else{const e=this.springs;Bs(Wh(n),t=>e[t].pause())}return this}resume(n){if(ni.und(n))this.start({pause:!1});else{const e=this.springs;Bs(Wh(n),t=>e[t].resume())}return this}each(n){bA(this.springs,n)}_onFrame(){const{onStart:n,onChange:e,onRest:t}=this._events,i=this._active.size>0,r=this._changed.size>0;(i&&!this._started||r&&!this._started)&&(this._started=!0,by(n,([a,c])=>{c.value=this.get(),a(c,this,this._item)}));const s=!i&&this._started,o=r||s&&t.size?this.get():null;r&&e.size&&by(e,([a,c])=>{c.value=o,a(c,this,this._item)}),s&&(this._started=!1,by(t,([a,c])=>{c.value=o,a(c,this,this._item)}))}eventObserved(n){if(n.type=="change")this._changed.add(n.parent),n.idle||this._active.add(n.parent);else if(n.type=="idle")this._active.delete(n.parent);else return;xr.onFrame(this._onFrame)}};function iE(n,e){return Promise.all(e.map(t=>w$(n,t))).then(t=>kI(n,t))}async function w$(n,e,t){const{keys:i,to:r,from:s,loop:o,onRest:a,onResolve:c}=e,h=ni.obj(e.default)&&e.default;o&&(e.loop=!1),r===!1&&(e.to=null),s===!1&&(e.from=null);const u=ni.arr(r)||ni.fun(r)?r:void 0;u?(e.to=void 0,e.onRest=void 0,h&&(h.onRest=void 0)):Bs(she,p=>{const y=e[p];if(ni.fun(y)){const v=n._events[p];e[p]=({finished:m,cancelled:w})=>{const x=v.get(y);x?(m||(x.finished=!1),w&&(x.cancelled=!0)):v.set(y,{value:null,finished:m||!1,cancelled:w||!1})},h&&(h[p]=e[p])}});const d=n._state;e.pause===!d.paused?(d.paused=e.pause,z2(e.pause?d.pauseQueue:d.resumeQueue)):d.paused&&(e.pause=!0);const f=(i||Object.keys(n.springs)).map(p=>n.springs[p].start(e)),A=e.cancel===!0||A$(e,"cancel")===!0;(u||A&&d.asyncId)&&f.push(p$(++n._lastAsyncId,{props:e,state:d,actions:{pause:KB,resume:KB,start(p,y){A?(hv(d,n._lastAsyncId),y(im(n))):(p.onRest=a,y(m$(u,p,d,n)))}}})),d.paused&&await new Promise(p=>{d.resumeQueue.add(p)});const g=kI(n,await Promise.all(f));if(o&&g.finished&&!(t&&g.noop)){const p=v$(e,o,r);if(p)return C$(n,[p]),w$(n,p,!0)}return c&&xr.batchedUpdates(()=>c(g,n,n.item)),g}function Wj(n,e){const t={...n.springs};return e&&Bs(Wh(e),i=>{ni.und(i.keys)&&(i=uv(i)),ni.obj(i.to)||(i={...i,to:void 0}),_$(t,i,r=>b$(r))}),x$(n,t),t}function x$(n,e){bA(e,(t,i)=>{n.springs[i]||(n.springs[i]=t,Zv(t,n))})}function b$(n,e){const t=new nhe;return t.key=n,e&&Zv(t,e),t}function _$(n,e,t){e.keys&&Bs(e.keys,i=>{(n[i]||(n[i]=t(i)))._prepareNode(e)})}function C$(n,e){Bs(e,t=>{_$(n.springs,t,i=>b$(i,n))})}var lhe=O.createContext({pause:!1,immediate:!1}),che=()=>{const n=[],e=function(i){Pce();const r=[];return Bs(n,(s,o)=>{if(ni.und(i))r.push(s.start());else{const a=t(i,s,o);a&&r.push(s.start(a))}}),r};e.current=n,e.add=function(i){n.includes(i)||n.push(i)},e.delete=function(i){const r=n.indexOf(i);~r&&n.splice(r,1)},e.pause=function(){return Bs(n,i=>i.pause(...arguments)),this},e.resume=function(){return Bs(n,i=>i.resume(...arguments)),this},e.set=function(i){Bs(n,(r,s)=>{const o=ni.fun(i)?i(s,r):i;o&&r.set(o)})},e.start=function(i){const r=[];return Bs(n,(s,o)=>{if(ni.und(i))r.push(s.start());else{const a=this._getProps(i,s,o);a&&r.push(s.start(a))}}),r},e.stop=function(){return Bs(n,i=>i.stop(...arguments)),this},e.update=function(i){return Bs(n,(r,s)=>r.update(this._getProps(i,r,s))),this};const t=function(i,r,s){return ni.fun(i)?i(s,r):i};return e._getProps=t,e};function hhe(n,e,t){const i=ni.fun(e)&&e;i&&!t&&(t=[]);const r=O.useMemo(()=>i||arguments.length==3?che():void 0,[]),s=O.useRef(0),o=o$(),a=O.useMemo(()=>({ctrls:[],queue:[],flush(v,m){const w=Wj(v,m);return s.current>0&&!a.queue.length&&!Object.keys(w).some(T=>!v.springs[T])?iE(v,m):new Promise(T=>{x$(v,w),a.queue.push(()=>{T(iE(v,m))}),o()})}}),[]),c=O.useRef([...a.ctrls]),h=O.useRef([]),u=Ij(n)||0;O.useMemo(()=>{Bs(c.current.slice(n,u),v=>{Kce(v,r),v.stop(!0)}),c.current.length=n,d(u,n)},[n]),O.useMemo(()=>{d(0,Math.min(u,n))},t);function d(v,m){for(let w=v;w<m;w++){const x=c.current[w]||(c.current[w]=new ahe(null,a.flush)),T=i?i(w,x):e[w];T&&(h.current[w]=ihe(T))}}const f=c.current.map((v,m)=>Wj(v,h.current[m])),A=O.useContext(lhe),g=Ij(A),p=A!==g&&Xce(A);SI(()=>{s.current++,a.ctrls=c.current;const{queue:v}=a;v.length&&(a.queue=[],Bs(v,m=>m())),Bs(c.current,(m,w)=>{r==null||r.add(m),p&&m.start({default:A});const x=h.current[w];x&&(qce(m,x.ref),m.ref?m.queue.push(x):m.start(x))})}),a$(()=>()=>{Bs(a.ctrls,v=>v.stop(!0))});const y=f.map(v=>({...v}));return r?[y,r]:y}function Jw(n,e){const t=ni.fun(n),[[i],r]=hhe(1,t?n:[n],t?[]:e);return t||arguments.length==2?[i,r]:i}var uhe=class extends II{constructor(n,e){super(),this.source=n,this.idle=!0,this._active=new Set,this.calc=ov(...e);const t=this._get(),i=YB(t);TI(this,i.create(t))}advance(n){const e=this._get(),t=this.get();Zd(e,t)||(td(this).setValue(e),this._onChange(e,this.idle)),!this.idle&&Qj(this._active)&&ZS(this)}_get(){const n=ni.arr(this.source)?this.source.map(Nh):Wh(Nh(this.source));return this.calc(...n)}_start(){this.idle&&!Qj(this._active)&&(this.idle=!1,Bs(k5(this),n=>{n.done=!1}),Fu.skipAnimation?(xr.batchedUpdates(()=>this.advance()),ZS(this)):S5.start(this))}_attach(){let n=1;Bs(Wh(this.source),e=>{nd(e)&&Zv(e,this),eE(e)&&(e.idle||this._active.add(e),n=Math.max(n,e.priority+1))}),this.priority=n,this._start()}_detach(){Bs(Wh(this.source),n=>{nd(n)&&W_(n,this)}),this._active.clear(),ZS(this)}eventObserved(n){n.type=="change"?n.idle?this.advance():(this._active.add(n.parent),this._start()):n.type=="idle"?this._active.delete(n.parent):n.type=="priority"&&(this.priority=Wh(this.source).reduce((e,t)=>Math.max(e,(eE(t)?t.priority:0)+1),0))}};function dhe(n){return n.idle!==!1}function Qj(n){return!n.size||Array.from(n).every(dhe)}function ZS(n){n.idle||(n.idle=!0,Bs(k5(n),e=>{e.done=!0}),H_(n,{type:"idle",parent:n}))}Fu.assign({createStringInterpolator:r$,to:(n,e)=>new uhe(n,e)});var Ahe=["primitive"].concat(Object.keys(GY).filter(n=>/^[A-Z]/.test(n)).map(n=>n[0].toLowerCase()+n.slice(1)));Fu.assign({createStringInterpolator:r$,colors:uce,frameLoop:"demand"});EY(()=>{xr.advance()});var fhe=Qce(Ahe,{applyAnimatedValues:kY}),JS=fhe.animated;const e3=({args:n,position:e,material:t,renderMode:i,isDragging:r=!1,isEditMode:s=!1,onClick:o,onPointerOver:a,onPointerOut:c})=>{const{theme:h}=Yh(),{view2DTheme:u}=Bi(),d=O.useMemo(()=>new rh(...n),[n]),f=O.useMemo(()=>new zO(d),[d]),{viewMode:A}=Qi(),{gl:g}=jl(),p=t;return O.useEffect(()=>{},[t]),l.jsxs("group",{position:e,children:[l.jsx("mesh",{geometry:d,material:p,receiveShadow:A==="3D"&&i==="solid"&&!s,castShadow:A==="3D"&&i==="solid"&&!s,renderOrder:s?999:0,onClick:o,onPointerOver:a,onPointerOut:c}),l.jsx("lineSegments",{geometry:f,renderOrder:s?1e3:900,children:l.jsx("lineBasicMaterial",{color:A==="2D"?"#00FF00":i==="wireframe"?"#808080":"#505050",linewidth:A==="2D"?3:1})})]})},dh=({moduleWidth:n,moduleDepth:e,hingePosition:t="right",spaceInfo:i,color:r,doorXOffset:s=0,originalSlotWidth:o,slotCenterX:a,moduleData:c,isDragging:h=!1,isEditMode:u=!1,slotWidths:d,slotIndex:f})=>{var ct,mt,je,le,Je,ht,ut,ft,jt,Wt,Mt,dn,on,Et,an,Mn,At,zt,Zt,$t,Ht,Lt,dt,at,Ot,Cn,Rn,xn,En,Hn,Kn,Ti,ti,ai,Gi,fi,Oi,rn,$n,Fn,pt,vt,kt,mn,sn,bn,Li,Wn,ui,Mi,Gn,Dn,li;const{spaceInfo:A}=qi(),{doorsOpen:g,view2DDirection:p}=Bi(),{columnCount:y}=Eg(),{renderMode:v,viewMode:m}=Qi(),{gl:w}=jl(),T=(i||A).materialConfig||{interiorColor:"#FFFFFF",doorColor:"#E0E0E0"};let j=r||T.doorColor;if(typeof j=="string"&&(/^#([0-9a-fA-F]{8})$/.test(j)&&(j="#"+j.slice(1,7)),/^rgba\(/.test(j))){const en=j.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);en&&(j=`#${(+en[1]).toString(16).padStart(2,"0")}${(+en[2]).toString(16).padStart(2,"0")}${(+en[3]).toString(16).padStart(2,"0")}`)}const b=ci(en=>en.selectedPlacedModuleId)===(c==null?void 0:c.id),{theme:_}=Yh(),I=()=>{if(typeof window<"u"){const Rt=getComputedStyle(document.documentElement).getPropertyValue("--theme-primary").trim();if(Rt)return Rt}return"#10b981"},S=O.useCallback(()=>new oo({color:new Yr("#E0E0E0"),metalness:0,roughness:.6,envMapIntensity:0,emissive:new Yr(0)}),[]),F=O.useMemo(()=>S(),[S]),B=O.useMemo(()=>S(),[S]),E=O.useMemo(()=>S(),[S]);O.useEffect(()=>{[F,B,E].forEach(Rt=>{Rt&&(h||u?Rt.color.set(I()):Rt.map||Rt.color.set(b?I():j),u?(Rt.transparent=!0,Rt.opacity=.15,Rt.color.set(I()),Rt.map=null,Rt.depthWrite=!1,Rt.depthTest=!0,Rt.side=Go,Rt.emissive=new Yr(I()),Rt.emissiveIntensity=.1):h?(Rt.transparent=!0,Rt.opacity=.3,Rt.color.set(I()),Rt.map=null,Rt.depthWrite=!1,Rt.side=Go):m==="2D"&&v==="solid"?(Rt.transparent=!1,Rt.opacity=1,Rt.depthWrite=!0):v==="wireframe"?(Rt.map=null,Rt.color.set(j),Rt.transparent=!0,Rt.opacity=m==="3D"?.5:0,Rt.depthWrite=!1,Rt.side=Go,Rt.emissive=new Yr(0),Rt.emissiveIntensity=0):b?(Rt.transparent=!0,Rt.opacity=.5,Rt.depthWrite=!0):(Rt.transparent=!1,Rt.opacity=1,Rt.depthWrite=!0),Rt.needsUpdate=!0)})},[j,b,h,u,m,v,F,B,E]);const V=O.useCallback((en,Rt,Xn)=>{Rt&&en?(gd(Rt)&&Sm(en),new xg().load(Rt,tt=>{var Jt,wn;tt.wrapS=Gh,tt.wrapT=Gh,tt.repeat.set(1,1),en.map=tt,gd(Rt)?Sm(en):(en.color.setHex(16777215),en.toneMapped=!0,en.roughness=.6),en.needsUpdate=!0,console.log(`🚪 ${Xn} 텍스처 로드 완료:`,{hasMap:!!en.map,mapImage:(wn=(Jt=en.map)==null?void 0:Jt.image)==null?void 0:wn.src,color:en.color.getHexString(),toneMapped:en.toneMapped,roughness:en.roughness,isCabinetTexture1:gd(Rt)}),requestAnimationFrame(()=>{en.needsUpdate=!0})},void 0,tt=>{console.error(`❌ ${Xn} 도어 텍스처 로딩 실패:`,Rt,tt)})):en&&(en.map&&(en.map.dispose(),en.map=null),en.color.set(j),en.toneMapped=!0,en.roughness=.6,en.needsUpdate=!0)},[j]);O.useEffect(()=>{const en=T.doorTexture;console.log("🚪 DoorModule 텍스처 적용 시작:",{textureUrl:en,hasDoorMaterial:!!F,hasLeftDoorMaterial:!!B,hasRightDoorMaterial:!!E,doorColor:j,isDragging:h,materialConfig:T}),!h&&!u&&v!=="wireframe"&&(F&&V(F,en,"싱글"),B&&V(B,en,"왼쪽"),E&&V(E,en,"오른쪽"))},[T.doorTexture,T,V,F,B,E,h,u,v]);const K=ur(i);let P=o||n||K.columnWidth;console.log("🚪📏 도어 너비 계산:",{originalSlotWidth:o,moduleWidth:n,indexingColumnWidth:K.columnWidth,actualDoorWidth:P,설명:o?"커버도어 (원래 슬롯 너비)":"일반 도어"}),i.surroundType==="no-surround"&&(o||(P=K.columnWidth,console.log("🚪 노서라운드 도어 너비 계산 (fallback):",{전체너비:i.width,columnCount:K.columnCount,columnWidth:K.columnWidth,actualDoorWidth:P})));const M=c!=null&&c.isDynamic&&((ct=c==null?void 0:c.id)!=null&&ct.includes("dual"))?!0:Math.abs(n-K.columnWidth*2)<50;console.log("🚪 DoorModule 렌더링:",{moduleWidth:n,originalSlotWidth:o,actualDoorWidth:P,isDualFurniture:M,indexingColumnWidth:K.columnWidth,slotCenterX:a,moduleDataId:c==null?void 0:c.id,isDynamic:c==null?void 0:c.isDynamic,spaceInfoZone:i.zone,droppedCeilingEnabled:(mt=i.droppedCeiling)==null?void 0:mt.enabled});const X=en=>en*.01,Q=X(20);let U=i.height,z=0,q,G;const ie=10;((je=i.baseConfig)==null?void 0:je.type)==="stand"&&i.baseConfig.placementType==="float"&&(z=i.baseConfig.floatHeight||0);const H=(c==null?void 0:c.category)==="upper"||((le=c==null?void 0:c.id)==null?void 0:le.includes("upper-cabinet")),se=(c==null?void 0:c.category)==="lower"||((Je=c==null?void 0:c.id)==null?void 0:Je.includes("lower-cabinet"))||((ht=c==null?void 0:c.id)==null?void 0:ht.includes("dual-lower-cabinet")),te=((ut=c==null?void 0:c.id)==null?void 0:ut.includes("tall"))||((ft=c==null?void 0:c.id)==null?void 0:ft.includes("pantry"))||((jt=c==null?void 0:c.id)==null?void 0:jt.includes("wardrobe"))||((Wt=c==null?void 0:c.id)==null?void 0:Wt.includes("2drawer-hanging"))||(c==null?void 0:c.category)==="tall"||(c==null?void 0:c.category)==="full"&&((Mt=c==null?void 0:c.dimensions)==null?void 0:Mt.height)>=2e3,fe=(dn=c==null?void 0:c.id)==null?void 0:dn.includes("2drawer-hanging");if(console.log("🔍 키큰장 체크:",{moduleId:c==null?void 0:c.id,category:c==null?void 0:c.category,height:(on=c==null?void 0:c.dimensions)==null?void 0:on.height,isTallCabinet:te,is2DrawerHanging:fe,includes_tall:(Et=c==null?void 0:c.id)==null?void 0:Et.includes("tall"),includes_pantry:(an=c==null?void 0:c.id)==null?void 0:an.includes("pantry"),includes_wardrobe:(Mn=c==null?void 0:c.id)==null?void 0:Mn.includes("wardrobe"),category_tall:(c==null?void 0:c.category)==="tall",is_full_and_tall:(c==null?void 0:c.category)==="full"&&((At=c==null?void 0:c.dimensions)==null?void 0:At.height)>=2e3}),fe&&console.log("🚨🚨🚨 2단서랍+옷장 감지!!!",{moduleId:c==null?void 0:c.id,category:c==null?void 0:c.category,dimensions:c==null?void 0:c.dimensions,isTallCabinet:te,floatHeight:z,spaceInfo:{height:i.height,baseConfig:i.baseConfig},doorHeightAdjusted:G,actualDoorHeight:q,furnitureHeight:(zt=c==null?void 0:c.dimensions)==null?void 0:zt.height}),H||se)q=((Zt=c==null?void 0:c.dimensions)==null?void 0:Zt.height)||(H?600:1e3),G=q,console.log("🚪📏 상하부장 도어 높이:",{category:c==null?void 0:c.category,furnitureHeight:q,doorHeight:q,type:H?"상부장":"하부장"});else{if(i.zone==="dropped"&&(($t=i.droppedCeiling)!=null&&$t.enabled)){const Rt=i.droppedCeiling.dropHeight||200;U=i.height-Rt,console.log("🚪📏 단내림 도어 높이 조정:",{originalHeight:i.height,dropHeight:Rt,adjustedHeight:U,zone:i.zone})}const en=i.hasFloorFinish&&((Ht=i.floorFinish)==null?void 0:Ht.height)||0;q=U-en,G=q}let ye,be=G;if(te){console.log("✅ 키큰장 블록 진입!",{moduleId:c==null?void 0:c.id,floatHeight:z,actualDoorHeight:q,doorHeightAdjusted:G,moduleHeight:(Lt=c==null?void 0:c.dimensions)==null?void 0:Lt.height,spaceHeight:i.height,hasTopFrame:ie});const en=5,Rt=((dt=c==null?void 0:c.dimensions)==null?void 0:dt.height)||q,Xn=((at=i.baseConfig)==null?void 0:at.type)==="floor"?((Ot=i.baseConfig)==null?void 0:Ot.height)||65:0;if(console.log("🔴 키큰장 가구 높이 확인:",{moduleDataHeight:(Cn=c==null?void 0:c.dimensions)==null?void 0:Cn.height,furnitureHeight:Rt,actualDoorHeight:q,spaceInfoHeight:i.height,계산된_가구높이:q-10-(z||Xn||0),설명:"furnitureHeight가 이미 2390인지, 아니면 다른 값인지 확인"}),z>0){console.log("✅ 키큰장 + 띄움 배치 모드!",{floatHeight:z,furnitureHeight:Rt});const Ui=q-en,tt=z;be=Ui-tt;const Yn=(q+z)/2,hi=(Ui+tt)/2;ye=(hi-Yn-5)*.01,console.log("🔍 띄움 배치 키큰장 도어 계산:",{띄움높이:z,가구높이:Rt,actualDoorHeight:q,도어높이:be,doorYPosition_units:ye,doorYPosition_mm:ye/.01,is2DrawerHanging:fe,설명:"가구는 천장-10mm, 도어는 천장-5mm 위치해야 함"}),fe&&console.log("🚨🚨🚨 2단서랍+옷장 도어 계산 상세:",{doorTopAbsolute:Ui,doorBottomAbsolute:tt,finalDoorHeight:be,furnitureCenterAbsolute:Yn,doorCenterAbsolute:hi,doorYPosition:ye,doorYPosition_mm:ye/.01,계산과정:{"도어중심-가구중심":hi-Yn,"5mm조정":-5,최종:hi-Yn-5}})}else{const Ui=((Rn=i.baseConfig)==null?void 0:Rn.type)==="floor"?((xn=i.baseConfig)==null?void 0:xn.height)||65:0,tt=q-en,Jt=25;be=tt-Jt;const hi=(q+Ui)/2;ye=((tt+Jt)/2-hi-5)*.01,console.log("🔍 받침대 배치 키큰장 도어 계산:",{받침대높이:Ui,가구높이:Rt,actualDoorHeight:q,도어높이:be,doorYPosition_units:ye,설명:"가구는 천장-10mm, 도어는 천장-5mm 위치해야 함"})}console.log("🚪📏 키큰장 도어 최종 계산:",{type:"키큰장",가구높이_mm:Rt,전체공간높이_mm:q,띄움높이_mm:z,최종도어높이_mm:be,doorYPosition_units:ye,doorYPosition_mm:ye/.01,설명:"도어는 가구와 동일한 크기로 설정",note:z>0?"띄움 배치: 가구 기준 상대 위치":"일반 배치: 가구 기준 상대 위치"})}else if(H){const Xn=((En=c==null?void 0:c.dimensions)==null?void 0:En.height)||600;be=Xn+5+18,ye=X(13/2-23),console.log("🚪📍 상부장 도어 위치:",{type:"상부장",가구높이:Xn,위확장:5,아래확장:18,도어높이:be,doorYPosition:ye,doorYPosition_mm:13/2-23,가구상단:X(Xn/2),도어상단:ye+X(be/2),note:"가구 기준 위 5mm, 아래 18mm 확장, Y축 23mm 추가 하향"})}else if(se){console.log("🔴🔴🔴 하부장 조건 진입!!!",{floatHeight:z,isLowerCabinet:se,moduleId:c==null?void 0:c.id,moduleCategory:c==null?void 0:c.category,baseConfig:i.baseConfig,placementType:(Hn=i.baseConfig)==null?void 0:Hn.placementType});const en=((Kn=c==null?void 0:c.dimensions)==null?void 0:Kn.height)||1e3,Rt=18;let Xn=0;console.log("🔴🔴🔴 floatHeight 체크:",z,"> 0 ?",z>0),z>0?(console.log("🔴🔴🔴 IF 블록 진입 - 띄움 배치"),be=en+Rt,ye=X(-1),console.log("🔴🔴🔴 하부장 띄움 배치:",{floatHeight:z,furnitureHeight:en,finalDoorHeight:be,doorYPosition:ye,doorYPosition_mm:ye/.01,위확장:Rt,도어높이계산:`${en} + ${Rt} = ${be}`,가구상단:en/2,가구하단:-en/2,도어상단:ye/.01+be/2,도어하단:ye/.01-be/2,도어하단_vs_가구하단:ye/.01-be/2- -en/2,설명:"띄움 배치시 도어 위 18mm만 확장, 하단은 가구와 일치해야 함"})):(console.log("🔴🔴🔴 ELSE 블록 진입 - 일반 배치"),Xn=40,be=en+Rt+Xn,ye=X((Xn-Rt)/2-32),console.log("🔴🔴🔴 일반 배치 doorYPosition 계산:",{lowerExtension:Xn,upperExtension:Rt,계산:(Xn-Rt)/2-32,doorYPosition:ye,doorYPosition_mm:ye/.01})),console.log("🚪📍 하부장 도어 위치:",{type:"하부장",floatHeight:z,띄움배치여부:z>0,가구높이:en,위확장:Rt,아래확장:Xn,도어높이:be,doorYPosition:ye,doorYPosition_mm:ye/.01,가구하단_mm:-en/2,도어하단_mm:ye/.01-be/2,차이:ye/.01-be/2- -en/2,note:z>0?"띄워서 배치: 위 18mm만 확장":"일반 배치: 위 18mm, 아래 40mm 확장"}),console.log("🚪📍 하부장 도어 최종:",{type:"하부장",doorYPosition:ye,doorYPosition_mm:ye/.01,adjustedHeight:G,받침대:((Ti=i.baseConfig)==null?void 0:Ti.type)==="floor",note:"키큰장 도어와 동일한 Y 위치 사용"})}else if(!se&&!H&&!te)if(((ti=i.baseConfig)==null?void 0:ti.type)==="floor"){const en=((ai=i.frameSize)==null?void 0:ai.top)||50,Rt=i.baseConfig.height||65;ye=((i.hasFloorFinish&&((Gi=i.floorFinish)==null?void 0:Gi.height)||0)>0,X(en)/2-X(Rt)/2)}else(fi=i.frameSize)!=null&&fi.top,ye=0,z>0&&(ye=X(-7.5),console.log("🚪📍 띄워서 배치 도어 위치 조정:",{floatHeight:z,doorYPosition:ye,doorYPosition_mm:-7.5,note:"도어 아래로 15mm 확장을 위해 7.5mm 아래로 이동"}));i.zone==="dropped"&&((Oi=i.droppedCeiling)!=null&&Oi.enabled)&&console.log("🚪📍 단내림 도어 위치:",{doorYPosition:ye,doorHeight:q-30,zone:"dropped",note:"하단이 메인구간과 정렬됨"}),i.surroundType==="no-surround"&&((rn=i.wallConfig)!=null&&rn.left),i.surroundType==="no-surround"&&(($n=i.wallConfig)!=null&&$n.right);const _e=18,W=X(H||se||te?be:be-30);console.log("🚪📐 도어 높이 최종 적용:",{moduleId:c==null?void 0:c.id,category:c==null?void 0:c.category,isUpperCabinet:H,isLowerCabinet:se,isTallCabinet:te,is2DrawerHanging:fe,floatHeight_mm:z,finalDoorHeight_mm:be,doorHeight_mm:se||te?be:be-30,doorHeight_three_units:W,doorHeight_three_to_mm:W/.01,doorYPosition_units:ye,doorYPosition_mm:ye/.01,적용타입:te?"키큰장":H?"상부장":se?"하부장":"일반"}),fe&&console.log("🚨🚨🚨 2단서랍+옷장 최종 도어 값:",{moduleId:c==null?void 0:c.id,doorHeight_mm:W/.01,doorYPosition_mm:ye/.01,floatHeight:z,finalDoorHeight:be,도어상단_절대위치_mm:ye/.01+W/.01/2,도어하단_절대위치_mm:ye/.01-W/.01/2,설명:"이 값들이 다른 키큰장과 동일해야 함"});const Y=X(20)+X(2),ve=X(e)+Y,ne=18/2,he=X(ne);O.useEffect(()=>{u&&console.log("🚪🔓 도어 편집 모드 활성화:",{isEditMode:u,doorsOpen:g,shouldOpen:g||u,moduleId:c==null?void 0:c.id})},[u,g,c==null?void 0:c.id]);const xe=O.useMemo(()=>g||u,[g,u]),[Te,Ce]=O.useState(!1);O.useEffect(()=>{if(g!==void 0){Ce(!0);const en=setTimeout(()=>{Ce(!1)},1200);return()=>clearTimeout(en)}},[g]),QC(()=>{Te&&w&&"invalidate"in w&&w.invalidate()});const Be=en=>{en.stopPropagation(),console.log("🚪 도어 클릭 이벤트 발생:",{moduleId:c==null?void 0:c.id,doorsOpen:g,isEditMode:u,eventType:en.type,target:en.target,currentDoorsOpen:g,willBeOpen:!g});const{toggleDoors:Rt}=Bi.getState();Rt(),w&&"invalidate"in w&&w.invalidate(),setTimeout(()=>{const Xn=Bi.getState().doorsOpen;console.log("🚪 도어 상태 토글 완료, 새로운 상태:",Xn)},100)},Ye=en=>{en.stopPropagation(),document.body.style.cursor="pointer"},$e=en=>{en.stopPropagation(),document.body.style.cursor="auto"},ot=Jw({rotation:xe?-4*Math.PI/9:0,config:{tension:90,friction:16,clamp:!0}}),rt=Jw({rotation:xe?4*Math.PI/9:0,config:{tension:90,friction:16,clamp:!0}}),Ve=Jw({rotation:xe?-4*Math.PI/9:0,config:{tension:90,friction:16,clamp:!0}}),We=Jw({rotation:xe?4*Math.PI/9:0,config:{tension:90,friction:16,clamp:!0}});let De=a!==void 0?a:0,Ge=0;console.log("🚪 도어 초기 위치:",{slotCenterX:a,doorGroupX:De,isDualFurniture:M,slotIndex:f,columnCount:y,surroundType:i.surroundType,moduleId:c==null?void 0:c.id}),a!=null&&a!==0?console.log("🚪 도어 오프셋 적용:",{slotIndex:f,slotCenterX_오프셋:a,doorGroupX:De,설명:"도어를 가구 중심에서 오프셋만큼 이동"}):console.log("🚪 도어 위치 기본값 사용 (가구 중심):",{slotIndex:f,doorGroupX:0});const Ie=(()=>{const en=i.columns||[];if(en.length===0)return console.log("🚪 기둥이 없음"),{isNearColumn:!1,columnSide:null};const Rt=a||0,Xn=Rt-X(P/2),Ui=Rt+X(P/2);console.log("🚪 도어 위치 체크:",{doorCenterX:Rt,doorLeftEdge:Xn,doorRightEdge:Ui,actualDoorWidth:P,slotCenterX:a});for(const tt of en){const Jt=X(tt.position[0]-i.width/2),wn=X(tt.width),Yn=Jt-wn/2,hi=Jt+wn/2,Xt=X(100),_i=Math.abs(Xn-hi),Pr=Math.abs(Ui-Yn);if(console.log("🚪 기둥 거리 체크:",{columnPosition:tt.position,columnX:Jt,columnWidth:tt.width,columnLeftEdge:Yn,columnRightEdge:hi,leftDistance:_i/.01,rightDistance:Pr/.01,threshold:Xt/.01}),_i<Xt)return console.log("🚪 왼쪽에 기둥 감지"),{isNearColumn:!0,columnSide:"left"};if(Pr<Xt)return console.log("🚪 오른쪽에 기둥 감지"),{isNearColumn:!0,columnSide:"right"}}return console.log("🚪 기둥 인접하지 않음"),{isNearColumn:!1,columnSide:null}})();let Le=t;const et=(c==null?void 0:c.type)==="door"||((Fn=c==null?void 0:c.id)==null?void 0:Fn.toLowerCase().includes("door"))||((pt=c==null?void 0:c.moduleId)==null?void 0:pt.toLowerCase().includes("door"));if(Ie.isNearColumn&&et?(Le=Ie.columnSide==="left"?"right":"left",console.log("🚪 기둥 인접 도어 힌지 자동 조정:",{originalHinge:t,adjustedHinge:Le,columnSide:Ie.columnSide,doorCenterX:a,moduleData:c,isDoorModule:et,note:"힌지는 기둥 반대쪽에 위치"})):console.log("🚪 힌지 조정 안함:",{isNearColumn:Ie.isNearColumn,columnSide:Ie.columnSide,isDoorModule:et,moduleData:c}),M){let en=P,Rt,Xn,Ui=!1,tt=!1,Jt=0,wn=0;if(i.surroundType==="no-surround"){Jt=(d==null?void 0:d[0])||K.columnWidth,wn=(d==null?void 0:d[1])||K.columnWidth,d&&d.length>=2&&(i.installType==="freestanding"?f===0?(Jt=d[0]+_e,wn=d[1]):f+2>=K.columnCount?(Jt=d[0],wn=d[1]+_e):(Jt=d[0],wn=d[1]):i.installType==="semistanding"?(vt=i.wallConfig)!=null&&vt.left&&!((kt=i.wallConfig)!=null&&kt.right)?f+2>=K.columnCount?(Jt=d[0],wn=d[1]+_e):(Jt=d[0],wn=d[1]):(mn=i.wallConfig)!=null&&mn.right&&!((sn=i.wallConfig)!=null&&sn.left)&&f===0?(Jt=d[0]+_e,wn=d[1]):(Jt=d[0],wn=d[1]):(Jt=d[0],wn=d[1])),en=Jt+wn,i.installType==="freestanding"?(Ui=f===0&&(d==null?void 0:d[0])<K.columnWidth,tt=d&&d.length>=2&&d[1]<K.columnWidth&&f+2>=K.columnCount,Ui?Ge=-_e/2:tt&&(Ge=_e/2)):i.installType==="semistanding"?(bn=i.wallConfig)!=null&&bn.left&&!((Li=i.wallConfig)!=null&&Li.right)?(Ui=!1,tt=f+2>=K.columnCount&&d&&d.length>=2&&d[1]<K.columnWidth,tt&&(Ge=_e/2)):(Wn=i.wallConfig)!=null&&Wn.right&&!((ui=i.wallConfig)!=null&&ui.left)?(Ui=f===0&&(d==null?void 0:d[0])<K.columnWidth,tt=!1,Ui&&(Ge=-_e/2)):(Ui=!1,tt=!1,Ge=0):(Ui=!1,tt=!1,Ge=0),console.log("🚪 듀얼 엔드패널 상태:",{isFirstSlotWithEndPanel:Ui,isLastSlotWithEndPanel:tt,doorAdjustment:Ge,note:"엔드패널 위치로 보정"});const ue=3,ke=1.5;Rt=(en-ue-2*ke)/2,Xn=(en-ue-2*ke)/2}else{d&&d.length>=2&&(Jt=d[0],wn=d[1],en=Jt+wn);const ue=6;Rt=(en-ue)/2,Xn=(en-ue)/2}console.log("🚪 듀얼 도어:",{totalWidth:en,leftDoorWidth:Rt,rightDoorWidth:Xn,doorAdjustment:Ge,slotIndex:f,columnCount:y,isFirstSlotWithEndPanel:Ui,isLastSlotWithEndPanel:tt,slotWidths:d,slot1Width:Jt,slot2Width:wn,surroundType:i.surroundType});const Yn=X(Rt),hi=X(Xn);let Xt,_i;const Pr=3,ws=1.5;Xt=-en/2+ws+Rt/2,_i=-en/2+ws+Rt+Pr+Xn/2;const Vi=X(Xt),br=X(_i),_r=Vi+(-Yn/2+he),Qr=br+(hi/2-he);return i.surroundType==="no-surround"&&Ge!==0&&(a===0||a===void 0?(De+=X(Ge),console.log("🚪 듀얼 도어 위치 보정 적용:",{slotIndex:f,slotCenterX:a,doorAdjustment:Ge,doorGroupX:De,isFirstSlot:f===0,isLastSlot:f+2>=K.columnCount,note:"DoorModule에서 보정"})):console.log("🚪 듀얼 도어 위치 보정 건너뜀:",{slotIndex:f,slotCenterX:a,doorAdjustment:Ge,isFirstSlot:f===0,isLastSlot:f+2>=K.columnCount,note:"FurnitureItem에서 이미 보정됨"})),console.log("🚪 듀얼 도어 위치:",{totalWidth:en,slotWidths:d,slotIndex:f,columnCount:y,isLastSlot:f+2>=y,leftDoorWidth:Rt,rightDoorWidth:Xn,doorAdjustment:Ge,doorGroupX:De,doorGroupX_mm:De/.01,mode:d?"개별 슬롯 너비":"균등분할 (fallback)",leftXOffset:Vi.toFixed(3),rightXOffset:br.toFixed(3),leftHingeX:_r.toFixed(3),rightHingeX:Qr.toFixed(3)}),l.jsxs("group",{position:[De,0,0],children:[" ",l.jsx("group",{position:[_r,ye,ve/2],children:l.jsx(JS.group,{"rotation-y":Ve.rotation,children:l.jsxs("group",{position:[Yn/2-he,.1,0],children:[l.jsx(e3,{args:[Yn,W,Q],position:[0,0,0],material:B,renderMode:v,isDragging:h,isEditMode:u,onClick:Be,onPointerOver:Ye,onPointerOut:$e}),m==="2D"&&p==="front"&&l.jsx("group",{position:[0,0,Q/2+.001],children:(()=>{const ue=[Yn/2,-W/2,0],ke=[-Yn/2,0,0],Me=[],Oe=ke[0]-ue[0],nt=ke[1]-ue[1],gt=Math.sqrt(Oe*Oe+nt*nt),Ae=2.4,me=.9,Xe=.9;let qe=0,nn=!0;for(;qe<gt;){if(nn){let Tn=Ae;qe+Ae+Xe>=gt&&(Tn=gt-qe);const Nn=qe/gt,pn=(qe+Tn)/gt;if(Me.push(l.jsx(it,{points:[[ue[0]+Oe*Nn,ue[1]+nt*Nn,0],[ue[0]+Oe*pn,ue[1]+nt*pn,0]],color:"#00FF00",lineWidth:.5,transparent:!0,opacity:.6,renderOrder:1002,depthTest:!1},`seg1-long-${qe}`)),qe+Tn>=gt)break;qe+=Tn+Xe}else{let Tn=me;qe+me+Xe>=gt&&(Tn=gt-qe);const Nn=qe/gt,pn=(qe+Tn)/gt;if(Me.push(l.jsx(it,{points:[[ue[0]+Oe*Nn,ue[1]+nt*Nn,0],[ue[0]+Oe*pn,ue[1]+nt*pn,0]],color:"#00FF00",lineWidth:.5,transparent:!0,opacity:.6,renderOrder:1002,depthTest:!1},`seg1-short-${qe}`)),qe+Tn>=gt)break;qe+=Tn+Xe}nn=!nn}const An=[-Yn/2,0,0],Ct=[Yn/2,W/2,0],kn=[],fn=Ct[0]-An[0],Qt=Ct[1]-An[1],Qn=Math.sqrt(fn*fn+Qt*Qt);for(qe=0,nn=!0;qe<Qn;){if(nn){let Tn=Ae;qe+Ae+Xe>=Qn&&(Tn=Qn-qe);const Nn=qe/Qn,pn=(qe+Tn)/Qn;if(kn.push(l.jsx(it,{points:[[An[0]+fn*Nn,An[1]+Qt*Nn,0],[An[0]+fn*pn,An[1]+Qt*pn,0]],color:"#00FF00",lineWidth:.5,transparent:!0,opacity:.6,renderOrder:1002,depthTest:!1},`seg2-long-${qe}`)),qe+Tn>=Qn)break;qe+=Tn+Xe}else{let Tn=me;qe+me+Xe>=Qn&&(Tn=Qn-qe);const Nn=qe/Qn,pn=(qe+Tn)/Qn;if(kn.push(l.jsx(it,{points:[[An[0]+fn*Nn,An[1]+Qt*Nn,0],[An[0]+fn*pn,An[1]+Qt*pn,0]],color:"#00FF00",lineWidth:.5,transparent:!0,opacity:.6,renderOrder:1002,depthTest:!1},`seg2-short-${qe}`)),qe+Tn>=Qn)break;qe+=Tn+Xe}nn=!nn}return[...Me,...kn]})()})]})})}),l.jsx("group",{position:[Qr,ye,ve/2],children:l.jsx(JS.group,{"rotation-y":We.rotation,children:l.jsxs("group",{position:[-hi/2+he,.1,0],children:[l.jsx(e3,{args:[hi,W,Q],position:[0,0,0],material:E,renderMode:v,isDragging:h,isEditMode:u,onClick:Be,onPointerOver:Ye,onPointerOut:$e}),m==="2D"&&p==="front"&&l.jsx("group",{position:[0,0,Q/2+.001],children:(()=>{const ue=[-hi/2,-W/2,0],ke=[hi/2,0,0],Me=[],Oe=ke[0]-ue[0],nt=ke[1]-ue[1],gt=Math.sqrt(Oe*Oe+nt*nt),Ae=2.4,me=.9,Xe=.9;let qe=0,nn=!0;for(;qe<gt;){if(nn){let Tn=Ae;qe+Ae+Xe>=gt&&(Tn=gt-qe);const Nn=qe/gt,pn=(qe+Tn)/gt;if(Me.push(l.jsx(it,{points:[[ue[0]+Oe*Nn,ue[1]+nt*Nn,0],[ue[0]+Oe*pn,ue[1]+nt*pn,0]],color:"#00FF00",lineWidth:.5,transparent:!0,opacity:.6,renderOrder:1002,depthTest:!1},`seg1-long-${qe}`)),qe+Tn>=gt)break;qe+=Tn+Xe}else{let Tn=me;qe+me+Xe>=gt&&(Tn=gt-qe);const Nn=qe/gt,pn=(qe+Tn)/gt;if(Me.push(l.jsx(it,{points:[[ue[0]+Oe*Nn,ue[1]+nt*Nn,0],[ue[0]+Oe*pn,ue[1]+nt*pn,0]],color:"#00FF00",lineWidth:.5,transparent:!0,opacity:.6,renderOrder:1002,depthTest:!1},`seg1-short-${qe}`)),qe+Tn>=gt)break;qe+=Tn+Xe}nn=!nn}const An=[hi/2,0,0],Ct=[-hi/2,W/2,0],kn=[],fn=Ct[0]-An[0],Qt=Ct[1]-An[1],Qn=Math.sqrt(fn*fn+Qt*Qt);for(qe=0,nn=!0;qe<Qn;){if(nn){let Tn=Ae;qe+Ae+Xe>=Qn&&(Tn=Qn-qe);const Nn=qe/Qn,pn=(qe+Tn)/Qn;if(kn.push(l.jsx(it,{points:[[An[0]+fn*Nn,An[1]+Qt*Nn,0],[An[0]+fn*pn,An[1]+Qt*pn,0]],color:"#00FF00",lineWidth:.5,transparent:!0,opacity:.6,renderOrder:1002,depthTest:!1},`seg2-long-${qe}`)),qe+Tn>=Qn)break;qe+=Tn+Xe}else{let Tn=me;qe+me+Xe>=Qn&&(Tn=Qn-qe);const Nn=qe/Qn,pn=(qe+Tn)/Qn;if(kn.push(l.jsx(it,{points:[[An[0]+fn*Nn,An[1]+Qt*Nn,0],[An[0]+fn*pn,An[1]+Qt*pn,0]],color:"#00FF00",lineWidth:.5,transparent:!0,opacity:.6,renderOrder:1002,depthTest:!1},`seg2-short-${qe}`)),qe+Tn>=Qn)break;qe+=Tn+Xe}nn=!nn}return[...Me,...kn]})()})]})})})]})}else{let en=P-3;if(i.surroundType==="no-surround"&&f!==void 0){const tt=P<K.columnWidth;let Jt=!1,wn=!1;i.installType==="freestanding"?(Jt=f===0&&tt,wn=f===K.columnCount-1&&tt):i.installType==="semistanding"&&((Mi=i.wallConfig)!=null&&Mi.left&&!((Gn=i.wallConfig)!=null&&Gn.right)?wn=f===K.columnCount-1&&tt:(Dn=i.wallConfig)!=null&&Dn.right&&!((li=i.wallConfig)!=null&&li.left)&&(Jt=f===0&&tt)),console.log("🔍 싱글 도어 엔드패널 판단:",{slotIndex:f,columnCount:K.columnCount,hasEndPanel:tt,isLeftEndPanel:Jt,isRightEndPanel:wn,installType:i.installType,wallConfig:i.wallConfig,actualDoorWidth:P,columnWidth:K.columnWidth}),Jt||wn?(en=P+_e-3,Jt?(Ge=-_e/2,console.log("왼쪽 엔드패널: 도어 크기 복원 및 위치 조정",{doorWidth:en,doorAdjustment:Ge})):wn&&(Ge=_e/2,console.log("오른쪽 엔드패널: 도어 크기 복원 및 위치 조정",{doorWidth:en,doorAdjustment:Ge}))):(en=P-3,console.log("중간 슬롯 또는 엔드패널 없음"))}else i.surroundType==="no-surround"&&(en=P-3,console.log("슬롯 인덱스 없음"));const Rt=X(en);i.surroundType==="no-surround"&&Ge!==0&&(a===0||a===void 0?(De+=X(Ge),console.log("🚪 싱글 도어 위치 보정 적용:",{slotIndex:f,slotCenterX:a,doorAdjustment:Ge,doorGroupX:De,note:"DoorModule에서 보정"})):console.log("🚪 싱글 도어 위치 보정 건너뜀:",{slotIndex:f,slotCenterX:a,doorAdjustment:Ge,note:"FurnitureItem에서 이미 보정됨"})),console.log("🚪 싱글 도어 크기:",{actualDoorWidth:P,doorWidth:en,originalSlotWidth:o,slotIndex:f,columnCount:y,isFirstSlot:f===0,isLastSlot:f===y-1,doorAdjustment:Ge,doorGroupX:De,surroundType:i.surroundType,fallbackColumnWidth:K.columnWidth,moduleDataId:c==null?void 0:c.id});const Xn=Le==="left"?-Rt/2+he:Rt/2-he,Ui=-Xn;return l.jsx("group",{position:[De+Xn,ye,ve/2],children:l.jsx(JS.group,{"rotation-y":Le==="left"?ot.rotation:rt.rotation,children:l.jsxs("group",{position:[Ui,.1,0],children:[l.jsx(e3,{args:[Rt,W,Q],position:[0,0,0],material:F,renderMode:v,isDragging:h,isEditMode:u,onClick:Be,onPointerOver:Ye,onPointerOut:$e}),m==="2D"&&p==="front"&&l.jsx("group",{position:[0,0,Q/2+.001],children:(()=>{const tt=[Le==="left"?Rt/2:-Rt/2,-W/2,0],Jt=[Le==="left"?-Rt/2:Rt/2,0,0],wn=[],Yn=Jt[0]-tt[0],hi=Jt[1]-tt[1],Xt=Math.sqrt(Yn*Yn+hi*hi),_i=2.4,Pr=.9,ws=.9;let Vi=0,br=!0;for(;Vi<Xt;){if(br){let nt=_i;Vi+_i+ws>=Xt&&(nt=Xt-Vi);const gt=Vi/Xt,Ae=(Vi+nt)/Xt;if(wn.push(l.jsx(it,{points:[[tt[0]+Yn*gt,tt[1]+hi*gt,0],[tt[0]+Yn*Ae,tt[1]+hi*Ae,0]],color:"#00FF00",lineWidth:.5,transparent:!0,opacity:.6,renderOrder:1002,depthTest:!1},`seg1-long-${Vi}`)),Vi+nt>=Xt)break;Vi+=nt+ws}else{let nt=Pr;Vi+Pr+ws>=Xt&&(nt=Xt-Vi);const gt=Vi/Xt,Ae=(Vi+nt)/Xt;if(wn.push(l.jsx(it,{points:[[tt[0]+Yn*gt,tt[1]+hi*gt,0],[tt[0]+Yn*Ae,tt[1]+hi*Ae,0]],color:"#00FF00",lineWidth:.5,transparent:!0,opacity:.6,renderOrder:1002,depthTest:!1},`seg1-short-${Vi}`)),Vi+nt>=Xt)break;Vi+=nt+ws}br=!br}const _r=[Le==="left"?-Rt/2:Rt/2,0,0],Qr=[Le==="left"?Rt/2:-Rt/2,W/2,0],ue=[],ke=Qr[0]-_r[0],Me=Qr[1]-_r[1],Oe=Math.sqrt(ke*ke+Me*Me);for(Vi=0,br=!0;Vi<Oe;){if(br){let nt=_i;Vi+_i+ws>=Oe&&(nt=Oe-Vi);const gt=Vi/Oe,Ae=(Vi+nt)/Oe;if(ue.push(l.jsx(it,{points:[[_r[0]+ke*gt,_r[1]+Me*gt,0],[_r[0]+ke*Ae,_r[1]+Me*Ae,0]],color:"#00FF00",lineWidth:.5,transparent:!0,opacity:.6,renderOrder:1002,depthTest:!1},`seg2-long-${Vi}`)),Vi+nt>=Oe)break;Vi+=nt+ws}else{let nt=Pr;Vi+Pr+ws>=Oe&&(nt=Oe-Vi);const gt=Vi/Oe,Ae=(Vi+nt)/Oe;if(ue.push(l.jsx(it,{points:[[_r[0]+ke*gt,_r[1]+Me*gt,0],[_r[0]+ke*Ae,_r[1]+Me*Ae,0]],color:"#00FF00",lineWidth:.5,transparent:!0,opacity:.6,renderOrder:1002,depthTest:!1},`seg2-short-${Vi}`)),Vi+nt>=Oe)break;Vi+=nt+ws}br=!br}return[...wn,...ue]})()})]})})})}},phe=({moduleData:n,color:e,internalHeight:t,hasDoor:i,customDepth:r,hingePosition:s="right",spaceInfo:o,isDragging:a=!1,isEditMode:c=!1,doorWidth:h,adjustedWidth:u,originalSlotWidth:d,slotIndex:f,slotInfo:A,slotCenterX:g,showFurniture:p=!0,isHighlighted:y=!1,furnitureId:v})=>{var I,S;const{indirectLightEnabled:m,indirectLightIntensity:w}=Bi(),x=Ru(n,{color:e,internalHeight:t,customDepth:r,isDragging:a,isEditMode:c,adjustedWidth:u,isHighlighted:y}),{renderMode:T}=Qi(),j=(I=o==null?void 0:o.baseConfig)==null?void 0:I.placementType,D=j==="float",b=((S=o==null?void 0:o.baseConfig)==null?void 0:S.floatHeight)||0,_=!1;return console.log("🔥 SingleType1 간접조명 체크:",{moduleId:n.id,placementType:j,isFloating:D,floatHeight:b,isDragging:a,indirectLightEnabled:m,showIndirectLight:_}),l.jsxs(l.Fragment,{children:[_,p&&l.jsx(Xm,{...x,isDragging:a,isEditMode:c,isHighlighted:y,children:!a&&l.jsx(ch,{modelConfig:x.modelConfig,height:x.height,innerWidth:x.innerWidth,depth:x.depth,adjustedDepthForShelves:x.adjustedDepthForShelves,basicThickness:x.basicThickness,shelfZOffset:x.shelfZOffset,material:x.material,calculateSectionHeight:x.calculateSectionHeight,renderMode:T,furnitureId:n.id})}),i&&o&&!(A&&A.hasColumn&&(A.columnType==="deep"||u!==void 0))&&l.jsx(dh,{moduleWidth:h||n.dimensions.width,moduleDepth:x.actualDepthMm,hingePosition:s,spaceInfo:o,color:x.doorColor,isDragging:a,isEditMode:c,moduleData:n,originalSlotWidth:d||h,slotIndex:f,slotCenterX:g})]})},qA=({args:n,position:e,material:t,renderMode:i="solid",isDragging:r=!1,isEditMode:s=!1,hideEdges:o=!1,isBackPanel:a=!1})=>{const{viewMode:c}=Qi(),{view2DDirection:h,view2DTheme:u,indirectLightEnabled:d,indirectLightIntensity:f}=Bi(),{gl:A}=jl(),{theme:g}=Yo(),p=ii.useMemo(()=>{if(r&&t instanceof oo){const y=t.clone();y.transparent=!0,y.opacity=.6;const v=()=>{if(typeof window<"u"){const w=getComputedStyle(document.documentElement).getPropertyValue("--theme-primary").trim();if(w)return w}return"#10b981"};return y.color=new Yr(v()),y.needsUpdate=!0,y}return t},[t,r,s]);return l.jsxs("group",{position:e,children:[l.jsxs("mesh",{receiveShadow:c==="3D"&&i==="solid",castShadow:c==="3D"&&i==="solid",children:[l.jsx("boxGeometry",{args:n}),i==="wireframe"?l.jsx("meshBasicMaterial",{transparent:!0,opacity:0}):l.jsx("primitive",{object:p,attach:"material"})]}),!o&&l.jsxs("lineSegments",{children:[l.jsx("edgesGeometry",{args:[new rh(...n)]}),l.jsx("lineBasicMaterial",{color:c==="3D"?"#505050":i==="wireframe"?u==="dark"?"#FFFFFF":"#000000":u==="dark"?"#FFFFFF":"#444444",transparent:c==="3D"||a&&c==="2D"&&h==="front",opacity:a&&c==="2D"&&h==="front"?.1:c==="3D"?.9:1,depthTest:c==="3D",depthWrite:!1,polygonOffset:c==="3D",polygonOffsetFactor:c==="3D"?-10:0,polygonOffsetUnits:c==="3D"?-10:0,linewidth:c==="2D"?2:1})]})]})},ghe=({moduleData:n,color:e,internalHeight:t,hasDoor:i,customDepth:r,hingePosition:s="right",spaceInfo:o,isDragging:a=!1,isEditMode:c=!1,doorWidth:h,originalSlotWidth:u,slotIndex:d,slotCenterX:f,adjustedWidth:A,slotInfo:g,showFurniture:p=!0,furnitureId:y})=>{var U,z;const v=Ru(n,{color:e,internalHeight:t,customDepth:r,isDragging:a,isEditMode:c,adjustedWidth:A}),{width:m,height:w,depth:x,innerWidth:T,innerHeight:j,basicThickness:D,backPanelThickness:b,adjustedDepthForShelves:_,shelfZOffset:I,material:S,mmToThreeUnits:F,isMultiSectionFurniture:B,getSectionHeights:E}=v,{renderMode:V,viewMode:K}=Qi();(U=o==null?void 0:o.baseConfig)==null||U.placementType,(z=o==null?void 0:o.baseConfig)!=null&&z.floatHeight;const P=!1,{view2DDirection:M,indirectLightEnabled:X,indirectLightIntensity:Z}=Bi(),{theme:Q}=Yo();return l.jsxs(l.Fragment,{children:[P,p&&l.jsxs("group",{children:[B()?l.jsx(l.Fragment,{children:E().map((q,G)=>{let ie=-w/2+D;for(let se=0;se<G;se++)ie+=E()[se];const H=ie+q/2-D;return l.jsxs(ii.Fragment,{children:[l.jsx(qA,{args:[D,q,x],position:[-m/2+D/2,H,0],material:S,renderMode:V,isDragging:a,isEditMode:c}),l.jsx(qA,{args:[D,q,x],position:[m/2-D/2,H,0],material:S,renderMode:V,isDragging:a,isEditMode:c}),G<E().length-1&&l.jsx(qA,{args:[T,D,_-D],position:[0,H+q/2+D/2,D/2+I],material:S,renderMode:V,isDragging:a,isEditMode:c})]},`side-panels-${G}`)})}):l.jsxs(l.Fragment,{children:[l.jsx(qA,{args:[D,w,x],position:[-m/2+D/2,0,0],material:S,renderMode:V,isDragging:a,isEditMode:c}),l.jsx(qA,{args:[D,w,x],position:[m/2-D/2,0,0],material:S,renderMode:V,isDragging:a,isEditMode:c})]}),l.jsx(qA,{args:[T,D,x],position:[0,w/2-D/2,0],material:S,renderMode:V,isDragging:a,isEditMode:c}),l.jsx(qA,{args:[T,D,x],position:[0,-w/2+D/2,0],material:S,renderMode:V,isDragging:a,isEditMode:c}),l.jsx(qA,{args:[T+F(10),j+F(10),b],position:[0,0,-x/2+b/2+F(17)],material:S,renderMode:V,isDragging:a,isEditMode:c,hideEdges:!1,isBackPanel:!0}),!a&&l.jsx(ch,{modelConfig:v.modelConfig,height:v.height,innerWidth:v.innerWidth,depth:v.depth,adjustedDepthForShelves:v.adjustedDepthForShelves,basicThickness:v.basicThickness,shelfZOffset:v.shelfZOffset,material:v.material,calculateSectionHeight:v.calculateSectionHeight,renderMode:V})]}),i&&o&&!(g&&g.hasColumn&&(g.columnType==="deep"||A!==void 0))&&l.jsx(dh,{moduleWidth:h||n.dimensions.width,moduleDepth:v.actualDepthMm,hingePosition:s,spaceInfo:o,color:v.doorColor,isDragging:a,isEditMode:c,moduleData:n,originalSlotWidth:u,slotCenterX:f||0,slotIndex:d})]})},mhe=({moduleData:n,color:e,internalHeight:t,hasDoor:i,customDepth:r,hingePosition:s="right",spaceInfo:o,isDragging:a=!1,isEditMode:c=!1,doorWidth:h,originalSlotWidth:u,slotIndex:d,slotCenterX:f,adjustedWidth:A,slotInfo:g,showFurniture:p=!0})=>{var x,T;const{indirectLightEnabled:y,indirectLightIntensity:v}=Bi(),m=Ru(n,{color:e,internalHeight:t,customDepth:r,isDragging:a,isEditMode:c,adjustedWidth:A}),{renderMode:w}=Qi();return(x=o==null?void 0:o.baseConfig)==null||x.placementType,(T=o==null?void 0:o.baseConfig)!=null&&T.floatHeight,l.jsxs(l.Fragment,{children:[p&&l.jsx(Xm,{...m,isDragging:a,isEditMode:c,children:!a&&l.jsx(ch,{modelConfig:m.modelConfig,height:m.height,innerWidth:m.innerWidth,depth:m.depth,adjustedDepthForShelves:m.adjustedDepthForShelves,basicThickness:m.basicThickness,shelfZOffset:m.shelfZOffset,material:m.material,calculateSectionHeight:m.calculateSectionHeight,renderMode:w})}),i&&o&&!(g&&g.hasColumn&&(g.columnType==="deep"||A!==void 0))&&l.jsx(dh,{moduleWidth:h||n.dimensions.width,moduleDepth:m.actualDepthMm,hingePosition:s,spaceInfo:o,color:m.doorColor,isDragging:a,isEditMode:c,moduleData:n,originalSlotWidth:u,slotCenterX:f||0,slotIndex:d})]})},yhe=({moduleData:n,color:e,internalHeight:t,hasDoor:i,customDepth:r,hingePosition:s="right",spaceInfo:o,isDragging:a=!1,isEditMode:c=!1,doorWidth:h,doorXOffset:u=0,originalSlotWidth:d,slotIndex:f,slotCenterX:A,slotWidths:g,showFurniture:p=!0,adjacentCabinets:y})=>{var b,_;const{indirectLightEnabled:v,indirectLightIntensity:m}=Bi(),w=Ru(n,{color:e,internalHeight:t,customDepth:r,isDragging:a,isEditMode:c,slotWidths:g}),{renderMode:x}=Qi(),T=((b=o==null?void 0:o.baseConfig)==null?void 0:b.placementType)==="float",j=((_=o==null?void 0:o.baseConfig)==null?void 0:_.floatHeight)||0,D=!1;return console.log("🔥 DualType1 간접조명 체크:",{moduleId:n.id,isFloating:T,floatHeight:j,isDragging:a,indirectLightEnabled:v,showIndirectLight:D}),l.jsxs(l.Fragment,{children:[D,p&&l.jsx(Xm,{...w,isDragging:a,isEditMode:c,leftEndPanelMaterial:w.leftEndPanelMaterial,rightEndPanelMaterial:w.rightEndPanelMaterial,children:!a&&l.jsx(ch,{modelConfig:w.modelConfig,height:w.height,innerWidth:w.innerWidth,depth:w.depth,adjustedDepthForShelves:w.adjustedDepthForShelves,basicThickness:w.basicThickness,shelfZOffset:w.shelfZOffset,material:w.material,calculateSectionHeight:w.calculateSectionHeight,renderMode:x,furnitureId:n.id})}),i&&o&&l.jsx(dh,{moduleWidth:h||n.dimensions.width,moduleDepth:w.actualDepthMm,hingePosition:s,spaceInfo:o,color:w.doorColor,moduleData:n,originalSlotWidth:d,slotCenterX:A,slotWidths:g,isDragging:a,isEditMode:c,slotIndex:f})]})},vhe=({moduleData:n,color:e,internalHeight:t,hasDoor:i,customDepth:r,hingePosition:s="right",spaceInfo:o,isDragging:a=!1,isEditMode:c=!1,doorWidth:h,originalSlotWidth:u,slotIndex:d,slotCenterX:f,slotWidths:A,showFurniture:g=!0,adjacentCabinets:p})=>{var Q,U;const{indirectLightEnabled:y,indirectLightIntensity:v}=Bi(),m=Ru(n,{color:e,internalHeight:t,customDepth:r,isDragging:a,isEditMode:c,slotWidths:A}),{width:w,height:x,depth:T,innerWidth:j,innerHeight:D,basicThickness:b,backPanelThickness:_,adjustedDepthForShelves:I,shelfZOffset:S,material:F,mmToThreeUnits:B,isMultiSectionFurniture:E,getSectionHeights:V}=m,{renderMode:K,viewMode:P}=Qi(),{view2DDirection:M}=Bi(),{theme:X}=Yo();return(Q=o==null?void 0:o.baseConfig)==null||Q.placementType,(U=o==null?void 0:o.baseConfig)!=null&&U.floatHeight,l.jsxs(l.Fragment,{children:[!1,g&&l.jsxs("group",{children:[E()?l.jsx(l.Fragment,{children:V().map((z,q)=>{let G=-x/2+b;for(let H=0;H<q;H++)G+=V()[H];const ie=G+z/2-b;return l.jsxs(ii.Fragment,{children:[l.jsx(zi,{args:[b,z,T],position:[-w/2+b/2,ie,0],material:F,renderMode:K,isDragging:a,isEditMode:c}),l.jsx(zi,{args:[b,z,T],position:[w/2-b/2,ie,0],material:F,renderMode:K,isDragging:a,isEditMode:c}),q<V().length-1&&l.jsx(zi,{args:[j,b,I-b],position:[0,ie+z/2+b/2,b/2+S],material:F,renderMode:K,isDragging:a})]},`side-panels-${q}`)})}):l.jsxs(l.Fragment,{children:[l.jsx(zi,{args:[b,x,T],position:[-w/2+b/2,0,0],material:F,renderMode:K,isDragging:a}),l.jsx(zi,{args:[b,x,T],position:[w/2-b/2,0,0],material:F,renderMode:K,isDragging:a})]}),l.jsx(zi,{args:[j,b,T],position:[0,x/2-b/2,0],material:F,renderMode:K,isDragging:a}),l.jsx(zi,{args:[j,b,T],position:[0,-x/2+b/2,0],material:F,renderMode:K,isDragging:a}),l.jsx(zi,{args:[j+B(10),D+B(10),_],position:[0,0,-T/2+_/2+B(17)],material:F,renderMode:K,isDragging:a,isBackPanel:!0}),!a&&l.jsx(ch,{modelConfig:m.modelConfig,height:m.height,innerWidth:m.innerWidth,depth:m.depth,adjustedDepthForShelves:m.adjustedDepthForShelves,basicThickness:m.basicThickness,shelfZOffset:m.shelfZOffset,material:m.material,calculateSectionHeight:m.calculateSectionHeight,renderMode:K})]}),i&&o&&l.jsx(dh,{moduleWidth:h||n.dimensions.width,moduleDepth:m.actualDepthMm,hingePosition:s,spaceInfo:o,color:m.doorColor,moduleData:n,originalSlotWidth:u,slotCenterX:f,slotWidths:A,isDragging:a,isEditMode:c,slotIndex:d})]})},whe=({moduleData:n,color:e,internalHeight:t,hasDoor:i,customDepth:r,hingePosition:s="right",spaceInfo:o,isDragging:a=!1,isEditMode:c=!1,doorWidth:h,originalSlotWidth:u,slotIndex:d,slotCenterX:f,slotWidths:A,showFurniture:g=!0,adjacentCabinets:p})=>{var Q,U;const y=Ru(n,{color:e,internalHeight:t,customDepth:r,isDragging:a,isEditMode:c,slotWidths:A}),{width:v,height:m,depth:w,innerWidth:x,innerHeight:T,basicThickness:j,backPanelThickness:D,adjustedDepthForShelves:b,shelfZOffset:_,material:I,mmToThreeUnits:S,isMultiSectionFurniture:F,getSectionHeights:B}=y,{renderMode:E}=Qi(),{viewMode:V,view2DDirection:K,indirectLightEnabled:P,indirectLightIntensity:M}=Bi(),{theme:X}=Yo();return(Q=o==null?void 0:o.baseConfig)==null||Q.placementType,(U=o==null?void 0:o.baseConfig)!=null&&U.floatHeight,l.jsxs(l.Fragment,{children:[!1,g&&l.jsxs("group",{children:[F()?l.jsx(l.Fragment,{children:B().map((z,q)=>{let G=-m/2+j;for(let H=0;H<q;H++)G+=B()[H];const ie=G+z/2-j;return l.jsxs(ii.Fragment,{children:[l.jsx(zi,{args:[j,z,w],position:[-v/2+j/2,ie,0],material:I,renderMode:E,isDragging:a,isEditMode:c}),l.jsx(zi,{args:[j,z,w],position:[v/2-j/2,ie,0],material:I,renderMode:E,isDragging:a,isEditMode:c}),q<B().length-1&&l.jsx(zi,{args:[x,j,b-j],position:[0,ie+z/2+j/2,j/2+_],material:I,renderMode:E,isDragging:a,isEditMode:c})]},`side-panels-${q}`)})}):l.jsxs(l.Fragment,{children:[l.jsx(zi,{args:[j,m,w],position:[-v/2+j/2,0,0],material:I,renderMode:E,isDragging:a,isEditMode:c}),l.jsx(zi,{args:[j,m,w],position:[v/2-j/2,0,0],material:I,renderMode:E,isDragging:a,isEditMode:c})]}),l.jsx(zi,{args:[x,j,w],position:[0,m/2-j/2,0],material:I,renderMode:E,isDragging:a,isEditMode:c}),l.jsx(zi,{args:[x,j,w],position:[0,-m/2+j/2,0],material:I,renderMode:E,isDragging:a,isEditMode:c}),l.jsx(zi,{args:[x+S(10),T+S(10),D],position:[0,0,-w/2+D/2+S(17)],material:I,renderMode:E,isDragging:a,hideEdges:!1,isBackPanel:!0}),!a&&l.jsx(ch,{modelConfig:y.modelConfig,height:y.height,innerWidth:y.innerWidth,depth:y.depth,adjustedDepthForShelves:y.adjustedDepthForShelves,basicThickness:y.basicThickness,shelfZOffset:y.shelfZOffset,material:y.material,calculateSectionHeight:y.calculateSectionHeight,renderMode:E})]}),i&&o&&l.jsx(dh,{moduleWidth:h||n.dimensions.width,moduleDepth:y.actualDepthMm,hingePosition:s,spaceInfo:o,color:y.doorColor,moduleData:n,originalSlotWidth:u,slotCenterX:f,slotWidths:A,isDragging:a,isEditMode:c,slotIndex:d})]})},xhe=({moduleData:n,color:e,internalHeight:t,hasDoor:i,customDepth:r,hingePosition:s="right",spaceInfo:o,isDragging:a=!1,isEditMode:c=!1,doorWidth:h,originalSlotWidth:u,slotIndex:d,slotCenterX:f,slotWidths:A,showFurniture:g=!0,adjacentCabinets:p})=>{var xe,Te;const y=Ru(n,{color:e,internalHeight:t,customDepth:r,isDragging:a,isEditMode:c,slotWidths:A}),{width:v,height:m,innerWidth:w,innerHeight:x,basicThickness:T,backPanelThickness:j,material:D,calculateSectionHeight:b,mmToThreeUnits:_,modelConfig:I}=y,{viewMode:S,view2DDirection:F,showDimensions:B,indirectLightEnabled:E,indirectLightIntensity:V}=Bi(),{theme:K}=Yo(),{renderMode:P}=Qi(),M=(xe=o==null?void 0:o.baseConfig)==null?void 0:xe.placementType,X=M==="float",Z=((Te=o==null?void 0:o.baseConfig)==null?void 0:Te.floatHeight)||0,Q=S==="2D"||S!=="3D",U=!1,q=-y.height/2-.5;console.log("🔥 DualType5 간접조명 계산:",{moduleId:n.id,hasSpaceInfo:!!o,baseConfig:o==null?void 0:o.baseConfig,placementType:M,isFloating:X,floatHeight:Z,isDragging:a,indirectLightEnabled:E,is2DMode:Q,showIndirectLight:U,lightY:q});const ie=S==="3D"?getComputedStyle(document.documentElement).getPropertyValue("--theme-primary").trim()||"#10b981":"#4CAF50",H=S==="3D"?.45:.32,se=I.rightAbsoluteWidth;let te,fe,ye,be;se?(fe=_(se),te=w-fe-T,ye=-(fe+T)/2,be=(te+T)/2):(te=w/2,fe=w/2,ye=-w/4,be=w/4);const _e=I.rightAbsoluteDepth;let W,Y,ve,ce;_e?(ve=r||600,W=_(ve),ce=_e,Y=_(ce)):(ve=ce=r||600,W=Y=_(ve));const ne=()=>{const Ce=I.leftSections||[];if(Ce.length===0)return[m-T*2];const Be=m-T*2,$e=Ce.filter(rt=>rt.heightType==="absolute").reduce((rt,Ve)=>rt+b(Ve,Be),0),ot=Be-$e;return Ce.map(rt=>rt.heightType==="absolute"?b(rt,Be):b(rt,ot))},he=()=>{const Ce=I.leftSections||[],Be=I.rightSections||[];if(Ce.length===0&&Be.length===0)return null;const Ye=W-T,$e=T/2,ot=_(642),rt=_(18)/2+(W-Y)/2,Ve=()=>{if(Ce.length===0)return null;const De=m-T*2,Re=Ce.filter(ct=>ct.heightType==="absolute").reduce((ct,mt)=>ct+b(mt,De),0),Ie=De-Re,Le=Ce.map(ct=>({...ct,calculatedHeight:ct.heightType==="absolute"?b(ct,De):b(ct,Ie)}));let et=-m/2+T;return Le.map((ct,mt)=>{const je=ct.calculatedHeight,le=et+je/2;let Je=null;switch(ct.type){case"shelf":ct.count&&ct.count>0&&(Je=l.jsx(R0,{shelfCount:ct.count,innerWidth:te,innerHeight:je,depth:Ye,basicThickness:T,material:D,yOffset:le,zOffset:$e,shelfPositions:ct.shelfPositions,isTopFinishPanel:ct.isTopFinishPanel,renderMode:Qi().renderMode,furnitureId:n.id}));break;case"hanging":ct.count&&ct.count>0?Je=l.jsx(R0,{shelfCount:ct.count,innerWidth:te,innerHeight:je,depth:Ye,basicThickness:T,material:D,yOffset:le,zOffset:$e,shelfPositions:ct.shelfPositions,isTopFinishPanel:ct.isTopFinishPanel,renderMode:Qi().renderMode,furnitureId:n.id}):Je=null;break;case"drawer":ct.count&&ct.count>0&&(Je=l.jsx(pI,{drawerCount:ct.count,innerWidth:te,innerHeight:je,depth:W,basicThickness:T,yOffset:le,drawerHeights:ct.drawerHeights,gapHeight:ct.gapHeight,material:D,renderMode:Qi().renderMode}));break}let ht=null;return mt<Le.length-1&&(ht=l.jsx(zi,{args:[te,T,Ye-T],position:[0,le+je/2-T/2,T/2+$e],material:D,renderMode:Qi().renderMode,isDragging:a,isEditMode:c})),et+=je,l.jsxs("group",{children:[Je,ht,B&&!(S==="2D"&&F==="top")&&l.jsxs(l.Fragment,{children:[mt<Le.length-1&&l.jsxs("group",{children:[S==="3D"&&l.jsx(zn,{position:[-te/2*.3-.8+.01,le+je/2-T/2-.01,Ye/2+.1-.01],fontSize:H,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:998,children:Math.round(T*100)}),l.jsx(zn,{position:[S==="3D"?-te/2*.3-.8:-te/2*.3-.5,le+je/2-T/2,S==="3D"?Ye/2+.1:T/2+$e+.5],fontSize:H,color:ie,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,children:Math.round(T*100)}),l.jsx(it,{points:[[-te/2*.3,le+je/2-T,S==="3D"?Ye/2+.1:T/2+$e+.5],[-te/2*.3,le+je/2,S==="3D"?Ye/2+.1:T/2+$e+.5]],color:ie,lineWidth:1}),l.jsxs("mesh",{position:[-te/2*.3,le+je/2-T,S==="3D"?Ye/2+.1:T/2+$e+.5],children:[l.jsx("sphereGeometry",{args:[.03,8,8]}),l.jsx("meshBasicMaterial",{color:ie})]}),l.jsxs("mesh",{position:[-te/2*.3,le+je/2,S==="3D"?Ye/2+.1:T/2+$e+.5],children:[l.jsx("sphereGeometry",{args:[.03,8,8]}),l.jsx("meshBasicMaterial",{color:ie})]})]}),(ct.type==="drawer"||ct.type==="hanging"||ct.type==="shelf")&&l.jsxs("group",{children:[S==="3D"&&l.jsx(zn,{position:[-te/2*.3-.8+.01,le-.01,Ye/2+.1-.01],fontSize:.45,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:998,children:Math.round(je*100)}),l.jsx(zn,{position:[S==="3D"?-te/2*.3-.8:-te/2*.3-.5,le,S==="3D"?Ye/2+.1:T/2+$e+.5],fontSize:S==="3D"?.45:.32,color:ie,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,children:Math.round(je*100)}),l.jsx(it,{points:[[-te/2*.3,le-je/2,S==="3D"?Ye/2+.1:T/2+$e+.5],[-te/2*.3,le+je/2-T,S==="3D"?Ye/2+.1:T/2+$e+.5]],color:ie,lineWidth:1}),l.jsxs("mesh",{position:[-te/2*.3,le-je/2,S==="3D"?Ye/2+.1:T/2+$e+.5],children:[l.jsx("sphereGeometry",{args:[.03,8,8]}),l.jsx("meshBasicMaterial",{color:ie})]}),l.jsxs("mesh",{position:[-te/2*.3,le+je/2-T,S==="3D"?Ye/2+.1:T/2+$e+.5],children:[l.jsx("sphereGeometry",{args:[.03,8,8]}),l.jsx("meshBasicMaterial",{color:ie})]})]}),mt===0&&ct.type==="drawer"&&l.jsxs("group",{children:[S==="3D"&&l.jsx(zn,{position:[-te/2*.3-.8+.01,-m/2+T/2-.01,Ye/2+.1-.01],fontSize:H,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:998,children:Math.round(T*100)}),l.jsx(zn,{position:[S==="3D"?-te/2*.3-.8:-te/2*.3-.5,-m/2+T/2,S==="3D"?Ye/2+.1:T/2+$e+.5],fontSize:H,color:ie,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,children:Math.round(T*100)}),l.jsx(it,{points:[[-te/2*.3,-m/2,S==="3D"?Ye/2+.1:T/2+$e+.5],[-te/2*.3,-m/2+T,S==="3D"?Ye/2+.1:T/2+$e+.5]],color:ie,lineWidth:1}),l.jsxs("mesh",{position:[-te/2*.3,-m/2,S==="3D"?Ye/2+.1:T/2+$e+.5],children:[l.jsx("sphereGeometry",{args:[.03,8,8]}),l.jsx("meshBasicMaterial",{color:ie})]}),l.jsxs("mesh",{position:[-te/2*.3,-m/2+T,S==="3D"?Ye/2+.1:T/2+$e+.5],children:[l.jsx("sphereGeometry",{args:[.03,8,8]}),l.jsx("meshBasicMaterial",{color:ie})]})]})]})]},`left-section-${mt}`)})},We=()=>{if(Be.length===0)return null;const De=m-T*2,Re=Be.filter(ct=>ct.heightType==="absolute").reduce((ct,mt)=>ct+b(mt,De),0),Ie=De-Re,Le=Be.map(ct=>({...ct,calculatedHeight:ct.heightType==="absolute"?b(ct,De):b(ct,Ie)}));let et=-m/2+T;return Le.map((ct,mt)=>{const je=ct.calculatedHeight,le=et+je/2;let Je=null;switch(ct.type){case"hanging":if(ct.count&&ct.count>0){const ht=`${n.id}-right-section`;Je=l.jsx(R0,{shelfCount:ct.count,innerWidth:fe,innerHeight:je,depth:ot,basicThickness:T,material:D,yOffset:le,zOffset:rt,shelfPositions:ct.shelfPositions,isTopFinishPanel:ct.isTopFinishPanel,renderMode:Qi().renderMode,furnitureId:ht})}else Je=null;break;case"shelf":ct.count&&ct.count>0&&(Je=l.jsx(R0,{shelfCount:ct.count,innerWidth:fe,innerHeight:je,depth:ot,basicThickness:T,material:D,yOffset:le,zOffset:rt,shelfPositions:ct.shelfPositions,isTopFinishPanel:ct.isTopFinishPanel,renderMode:Qi().renderMode,furnitureId:n.id}));break}return et+=je,l.jsxs("group",{children:[Je,B&&!(S==="2D"&&F==="top")&&l.jsxs("group",{children:[S==="3D"&&l.jsx(zn,{position:[-fe/2*.3-.8+.01,-m/2+T/2-.01,3.01-.01],fontSize:H,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:998,children:Math.round(T*100)}),l.jsx(zn,{position:[S==="3D"?-fe/2*.3-.8:-fe/2*.3-.5,-m/2+T/2,S==="3D"?3.01:T/2+rt+.5],fontSize:H,color:ie,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,children:Math.round(T*100)}),l.jsx(it,{points:[[-fe/2*.3,-m/2,S==="3D"?3.01:T/2+rt+.5],[-fe/2*.3,-m/2+T,S==="3D"?3.01:T/2+rt+.5]],color:ie,lineWidth:1}),l.jsxs("mesh",{position:[-fe/2*.3,-m/2,S==="3D"?3.01:T/2+rt+.5],children:[l.jsx("sphereGeometry",{args:[.03,8,8]}),l.jsx("meshBasicMaterial",{color:ie})]}),l.jsxs("mesh",{position:[-fe/2*.3,-m/2+T,S==="3D"?3.01:T/2+rt+.5],children:[l.jsx("sphereGeometry",{args:[.03,8,8]}),l.jsx("meshBasicMaterial",{color:ie})]}),mt===0&&l.jsxs(l.Fragment,{children:[l.jsx(it,{points:[[-fe/2,le+je/2-T-1,S==="3D"?ot/2-.5:rt-.5],[fe/2,le+je/2-T-1,S==="3D"?ot/2-.5:rt-.5]],color:ie,lineWidth:1}),S==="3D"&&l.jsx(zn,{position:[0+.01,le+je/2-T-1.2-.01,ot/2-.5-.01],fontSize:H,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"top",renderOrder:998,children:Math.round(fe*100)}),l.jsx(zn,{position:[0,le+je/2-T-1.2,S==="3D"?ot/2-.5:rt-.5],fontSize:H,color:ie,anchorX:"center",anchorY:"top",renderOrder:999,children:Math.round(fe*100)}),l.jsxs("mesh",{position:[-fe/2,le+je/2-T-1,S==="3D"?ot/2-.5:rt-.5],children:[l.jsx("sphereGeometry",{args:[.03,8,8]}),l.jsx("meshBasicMaterial",{color:ie})]}),l.jsxs("mesh",{position:[fe/2,le+je/2-T-1,S==="3D"?ot/2-.5:rt-.5],children:[l.jsx("sphereGeometry",{args:[.03,8,8]}),l.jsx("meshBasicMaterial",{color:ie})]})]})]})]},`right-section-${mt}`)})};return l.jsxs(l.Fragment,{children:[U,l.jsx("group",{position:[ye,0,0],children:Ve()}),l.jsx("group",{position:[be,0,0],children:We()}),ne().map((De,Ge)=>{let Re=-m/2+T;for(let ct=0;ct<Ge;ct++)Re+=ne()[ct];const Ie=Re+De/2-T,Le=Math.max(W,Y),et=W>Y?0:(W-Y)/2;return l.jsx(zi,{args:[T,De,Le],position:[(te-fe)/2,Ie,et],material:D,renderMode:Qi().renderMode,isDragging:a,isEditMode:c},`middle-panel-${Ge}`)})]})};return l.jsxs(l.Fragment,{children:[U,g&&l.jsxs(l.Fragment,{children:[ne().map((Ce,Be)=>{let Ye=-m/2+T;for(let ot=0;ot<Be;ot++)Ye+=ne()[ot];const $e=Ye+Ce/2-T;return l.jsx(zi,{args:[T,Ce,W],position:[-v/2+T/2,$e,0],material:D,renderMode:Qi().renderMode,isDragging:a,isEditMode:c},`left-side-panel-${Be}`)}),l.jsx(zi,{args:[T,m,Y],position:[v/2-T/2,0,(W-Y)/2],material:D,renderMode:Qi().renderMode,isDragging:a,isEditMode:c}),l.jsxs(l.Fragment,{children:[l.jsx(zi,{args:[te,T,W],position:[ye,m/2-T/2,0],material:D,renderMode:Qi().renderMode,isDragging:a,isEditMode:c}),l.jsx(zi,{args:[fe,T,Y],position:[be,m/2-T/2,(W-Y)/2],material:D,renderMode:Qi().renderMode,isDragging:a,isEditMode:c})]}),l.jsxs(l.Fragment,{children:[l.jsx(zi,{args:[te,T,W],position:[ye,-m/2+T/2,0],material:D,renderMode:Qi().renderMode,isDragging:a,isEditMode:c}),l.jsx(zi,{args:[fe,T,Y],position:[be,-m/2+T/2,(W-Y)/2],material:D,renderMode:Qi().renderMode,isDragging:a,isEditMode:c})]}),l.jsxs(l.Fragment,{children:[l.jsx(zi,{args:[te+_(10),x+_(10),j],position:[ye,0,-W/2+j/2+_(17)],material:D,renderMode:Qi().renderMode,isDragging:a,isEditMode:c,hideEdges:!1,isBackPanel:!0}),l.jsx(zi,{args:[fe+_(10),x+_(10),j],position:[be,0,-Y/2+j/2+_(17)+(W-Y)/2],material:D,renderMode:Qi().renderMode,isDragging:a,isEditMode:c,hideEdges:!1,isBackPanel:!0})]}),!a&&he()]}),i&&o&&l.jsx(dh,{moduleWidth:h||n.dimensions.width,moduleDepth:y.actualDepthMm,hingePosition:s,spaceInfo:o,color:y.doorColor,moduleData:n,originalSlotWidth:u,slotCenterX:f,slotWidths:A,isDragging:a,isEditMode:c,slotIndex:d})]})},bhe=({moduleData:n,color:e,internalHeight:t,hasDoor:i,customDepth:r,hingePosition:s="right",spaceInfo:o,isDragging:a=!1,isEditMode:c=!1,doorWidth:h,originalSlotWidth:u,slotIndex:d,slotCenterX:f,slotWidths:A,showFurniture:g=!0,adjacentCabinets:p})=>{var y,v;try{const m=Ru(n,{color:e,internalHeight:t,customDepth:r,isDragging:a,isEditMode:c,slotWidths:A,adjacentCabinets:p}),{width:w,height:x,depth:T,innerWidth:j,innerHeight:D,basicThickness:b,backPanelThickness:_,adjustedDepthForShelves:I,shelfZOffset:S,material:F,calculateSectionHeight:B,mmToThreeUnits:E,modelConfig:V}=m,K=Ce=>Ce*100,{viewMode:P,view2DDirection:M,showDimensions:X,indirectLightEnabled:Z,indirectLightIntensity:Q}=Bi(),{theme:U}=Yo(),z=(y=o==null?void 0:o.baseConfig)==null?void 0:y.placementType,q=z==="float",G=((v=o==null?void 0:o.baseConfig)==null?void 0:v.floatHeight)||0,ie=P==="2D"||P!=="3D",H=!1,te=-m.height/2-.5;console.log("🔥 DualType6 간접조명 계산:",{moduleId:n.id,hasSpaceInfo:!!o,baseConfig:o==null?void 0:o.baseConfig,placementType:z,isFloating:q,floatHeight:G,isDragging:a,indirectLightEnabled:Z,is2DMode:ie,showIndirectLight:H,lightY:te});const ye=P==="3D"?getComputedStyle(document.documentElement).getPropertyValue("--theme-primary").trim()||"#10b981":"#4CAF50",be=P==="3D"?.45:.32;let _e,W,Y,ve;if(V.rightAbsoluteWidth){const Ce=n.dimensions.width,Be=V.rightAbsoluteWidth/(Ce-36);W=j*Be,_e=j-W-b,Y=-(W+b)/2,ve=(_e+b)/2}else _e=j/2,W=j/2,Y=-j/4,ve=j/4;console.log("🔍 DualType6 좌우 분할 계산:",{moduleId:n.id,width:w,innerWidth:j,leftWidth:_e,rightWidth:W,leftXOffset:Y,rightXOffset:ve,modelConfig:{rightAbsoluteWidth:V.rightAbsoluteWidth,hasSharedMiddlePanel:V.hasSharedMiddlePanel,leftSections:V.leftSections,rightSections:V.rightSections}});const ce=V.hasSharedMiddlePanel||!1,ne=V.middlePanelHeight||0,he=V.hasSharedSafetyShelf||!1,xe=V.safetyShelfHeight||0,Te=()=>{const Ce=V.leftSections||[],Be=V.rightSections||[];if(Ce.length===0&&Be.length===0)return null;const Ye=()=>{if(Ce.length===0)return null;const ot=x-b*2,Ve=Ce.filter(Re=>Re.heightType==="absolute").reduce((Re,Ie)=>Re+B(Ie,ot),0),We=ot-Ve,De=Ce.map(Re=>({...Re,calculatedHeight:Re.heightType==="absolute"?B(Re,ot):B(Re,We)}));let Ge=-x/2+b;return De.map((Re,Ie)=>{const Le=Re.calculatedHeight,et=Ge+Le/2;let ct=null;switch(Re.type){case"drawer":Re.count&&Re.count>0&&(ct=l.jsx(pI,{drawerCount:Re.count,innerWidth:_e,innerHeight:Le,depth:T,basicThickness:b,yOffset:et,drawerHeights:Re.drawerHeights,gapHeight:Re.gapHeight,material:F,renderMode:Qi().renderMode}));break;case"hanging":ct=null;break}return Ge+=Le,l.jsxs("group",{children:[ct,X&&(Re.type==="drawer"||Re.type==="hanging")&&l.jsxs("group",{children:[Re.type==="drawer"?l.jsxs(l.Fragment,{children:[P==="3D"&&l.jsx(zn,{position:[-_e/2*.3-.8+.01,(et-Le/2+(-x/2+b+E(ne-9)-b/2))/2-.01,I/2+.1-.01],fontSize:be,color:"rgba(0, 0, 0, 0.3)",anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:998,children:Math.round(K(-x/2+b+E(ne-9)-b/2-(et-Le/2)))}),l.jsx(zn,{position:[P==="3D"?-_e/2*.3-.8:-_e/2*.3-.5,(et-Le/2+(-x/2+b+E(ne-9)-b/2))/2,P==="3D"?I/2+.1:b/2+S+.5],fontSize:be,color:ye,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,depthTest:!1,children:Math.round(K(-x/2+b+E(ne-9)-b/2-(et-Le/2)))}),l.jsx(it,{points:[[-_e/2*.3,et-Le/2,P==="3D"?I/2+.1:b/2+S+.5],[-_e/2*.3,-x/2+b+E(ne-9)-b/2,P==="3D"?I/2+.1:b/2+S+.5]],color:ye,lineWidth:1}),l.jsxs("mesh",{position:[-_e/2*.3,et-Le/2,P==="3D"?I/2+.1:b/2+S+.5],children:[l.jsx("sphereGeometry",{args:[.02,8,8]}),l.jsx("meshBasicMaterial",{color:ye})]}),l.jsxs("mesh",{position:[-_e/2*.3,-x/2+b+E(ne-9)-b/2,P==="3D"?I/2+.1:b/2+S+.5],children:[l.jsx("sphereGeometry",{args:[.02,8,8]}),l.jsx("meshBasicMaterial",{color:ye})]})]}):Re.type==="hanging"&&Ie===1?l.jsx(l.Fragment,{children:he?l.jsxs(l.Fragment,{children:[l.jsx(zn,{position:[-_e/2*.3-.5,(-x/2+b+E(ne-9)+b/2+(-x/2+b+E(xe)-b/2))/2,P==="3D"?I/2+.1:b/2+S+.5],fontSize:be,color:ye,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,depthTest:!1,children:Math.round(K(-x/2+b+E(xe)-b/2-(-x/2+b+E(ne-9)+b/2)))}),l.jsx(it,{points:[[-_e/2*.3,-x/2+b+E(ne-9)+b/2,P==="3D"?I/2+.1:b/2+S+.5],[-_e/2*.3,-x/2+b+E(xe)-b/2,P==="3D"?I/2+.1:b/2+S+.5]],color:ye,lineWidth:1}),l.jsxs("mesh",{position:[-_e/2*.3,-x/2+b+E(ne-9)+b/2,P==="3D"?I/2+.1:b/2+S+.5],children:[l.jsx("sphereGeometry",{args:[.02,8,8]}),l.jsx("meshBasicMaterial",{color:ye})]}),l.jsxs("mesh",{position:[-_e/2*.3,-x/2+b+E(xe)-b/2,P==="3D"?I/2+.1:b/2+S+.5],children:[l.jsx("sphereGeometry",{args:[.02,8,8]}),l.jsx("meshBasicMaterial",{color:ye})]}),l.jsx(zn,{position:[-_e/2*.3-.5,(-x/2+b+E(xe)+b/2+(x/2-b))/2,P==="3D"?I/2+.1:b/2+S+.5],fontSize:be,color:ye,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,depthTest:!1,children:Math.round(K(x/2-b-(-x/2+b+E(xe)+b/2)))}),l.jsx(it,{points:[[-_e/2*.3,-x/2+b+E(xe)+b/2,P==="3D"?I/2+.1:b/2+S+.5],[-_e/2*.3,x/2-b,P==="3D"?I/2+.1:b/2+S+.5]],color:ye,lineWidth:1}),l.jsxs("mesh",{position:[-_e/2*.3,-x/2+b+E(xe)+b/2,P==="3D"?I/2+.1:b/2+S+.5],children:[l.jsx("sphereGeometry",{args:[.02,8,8]}),l.jsx("meshBasicMaterial",{color:ye})]}),l.jsxs("mesh",{position:[-_e/2*.3,x/2-b,P==="3D"?I/2+.1:b/2+S+.5],children:[l.jsx("sphereGeometry",{args:[.02,8,8]}),l.jsx("meshBasicMaterial",{color:ye})]})]}):l.jsxs(l.Fragment,{children:[l.jsx(zn,{position:[-_e/2*.3-.5,et,P==="3D"?I/2+.1:b/2+S+.5],fontSize:be,color:ye,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,depthTest:!1,children:Math.round(K(x/2-b-(-x/2+b+E(ne-9)+b/2)))}),l.jsx(it,{points:[[-_e/2*.3,-x/2+b+E(ne-9)+b/2,P==="3D"?I/2+.1:b/2+S+.5],[-_e/2*.3,x/2-b,P==="3D"?I/2+.1:b/2+S+.5]],color:ye,lineWidth:1}),l.jsxs("mesh",{position:[-_e/2*.3,-x/2+b+E(ne-9)+b/2,P==="3D"?I/2+.1:b/2+S+.5],children:[l.jsx("sphereGeometry",{args:[.02,8,8]}),l.jsx("meshBasicMaterial",{color:ye})]}),l.jsxs("mesh",{position:[-_e/2*.3,x/2-b,P==="3D"?I/2+.1:b/2+S+.5],children:[l.jsx("sphereGeometry",{args:[.02,8,8]}),l.jsx("meshBasicMaterial",{color:ye})]})]})}):null,Ie===0&&l.jsxs("group",{children:[l.jsx(zn,{position:[-_e/2*.3-.5,-x/2+b/2,P==="3D"?I/2+.1:b/2+S+.5],fontSize:be,color:ye,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,depthTest:!1,children:Math.round(K(b))}),l.jsx(it,{points:[[-_e/2*.3,-x/2,P==="3D"?I/2+.1:b/2+S+.5],[-_e/2*.3,-x/2+b,P==="3D"?I/2+.1:b/2+S+.5]],color:ye,lineWidth:1}),l.jsxs("mesh",{position:[-_e/2*.3,-x/2,P==="3D"?I/2+.1:b/2+S+.5],children:[l.jsx("sphereGeometry",{args:[.02,8,8]}),l.jsx("meshBasicMaterial",{color:ye})]}),l.jsxs("mesh",{position:[-_e/2*.3,-x/2+b,P==="3D"?I/2+.1:b/2+S+.5],children:[l.jsx("sphereGeometry",{args:[.02,8,8]}),l.jsx("meshBasicMaterial",{color:ye})]})]})]})]},`left-section-${Ie}`)})},$e=()=>{if(Be.length===0)return null;const ot=x-b*2,Ve=Be.filter(Ge=>Ge.heightType==="absolute").reduce((Ge,Re)=>Ge+B(Re,ot),0),We=ot-Ve;return Be.map(Ge=>({...Ge,calculatedHeight:Ge.heightType==="absolute"?B(Ge,ot):B(Ge,We)})).map((Ge,Re)=>{let Ie=null;switch(Ge.type){case"hanging":Ie=null;break}return l.jsx("group",{children:Ie},`right-section-${Re}`)})};return l.jsxs(l.Fragment,{children:[l.jsx("group",{position:[Y,0,0],children:Ye()}),l.jsx("group",{position:[ve,0,0],children:$e()}),ce&&ne>0&&l.jsx(zi,{args:[b,E(ne),I-b],position:[(_e-W)/2,-x/2+b+E(ne)/2-E(18),b/2+S],material:F,renderMode:Qi().renderMode,isDragging:a,isEditMode:c}),ce&&ne>0&&l.jsxs(l.Fragment,{children:[l.jsx(zi,{args:[j,b,I-b],position:[0,-x/2+b+E(ne-9),b/2+S],material:F,renderMode:Qi().renderMode,isDragging:a,isEditMode:c}),X&&l.jsxs("group",{children:[l.jsx(zn,{position:[-_e/2*.3-.5,-x/2+b+E(ne-9),P==="3D"?I/2+.1:b/2+S+.5],fontSize:be,color:ye,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,depthTest:!1,children:Math.round(b/.01)}),l.jsx(it,{points:[[-_e/2*.3,-x/2+b+E(ne-9)-b/2,P==="3D"?I/2+.1:b/2+S+.5],[-_e/2*.3,-x/2+b+E(ne-9)+b/2,P==="3D"?I/2+.1:b/2+S+.5]],color:ye,lineWidth:1}),l.jsxs("mesh",{position:[-_e/2*.3,-x/2+b+E(ne-9)-b/2,P==="3D"?I/2+.1:b/2+S+.5],children:[l.jsx("sphereGeometry",{args:[.02,8,8]}),l.jsx("meshBasicMaterial",{color:ye})]}),l.jsxs("mesh",{position:[-_e/2*.3,-x/2+b+E(ne-9)+b/2,P==="3D"?I/2+.1:b/2+S+.5],children:[l.jsx("sphereGeometry",{args:[.02,8,8]}),l.jsx("meshBasicMaterial",{color:ye})]})]})]}),he&&xe>0&&l.jsxs(l.Fragment,{children:[l.jsx(zi,{args:[j,b,I-b],position:[0,-x/2+b+E(xe),b/2+S],material:F,renderMode:Qi().renderMode,isDragging:a,isEditMode:c}),X&&l.jsxs("group",{children:[l.jsx(zn,{position:[-_e/2*.3-.5,-x/2+b+E(xe),P==="3D"?I/2+.1:b/2+S+.5],fontSize:be,color:ye,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,depthTest:!1,children:Math.round(b/.01)}),l.jsx(it,{points:[[-_e/2*.3,-x/2+b+E(xe)-b/2,P==="3D"?I/2+.1:b/2+S+.5],[-_e/2*.3,-x/2+b+E(xe)+b/2,P==="3D"?I/2+.1:b/2+S+.5]],color:ye,lineWidth:1}),l.jsxs("mesh",{position:[-_e/2*.3,-x/2+b+E(xe)-b/2,P==="3D"?I/2+.1:b/2+S+.5],children:[l.jsx("sphereGeometry",{args:[.02,8,8]}),l.jsx("meshBasicMaterial",{color:ye})]}),l.jsxs("mesh",{position:[-_e/2*.3,-x/2+b+E(xe)+b/2,P==="3D"?I/2+.1:b/2+S+.5],children:[l.jsx("sphereGeometry",{args:[.02,8,8]}),l.jsx("meshBasicMaterial",{color:ye})]})]})]}),X&&l.jsxs("group",{children:[l.jsx(zn,{position:[-_e/2*.3-.5,x/2-b/2,P==="3D"?I/2+.1:b/2+S+.5],fontSize:be,color:ye,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],renderOrder:999,depthTest:!1,children:Math.round(b/.01)}),l.jsx(it,{points:[[-_e/2*.3,x/2,P==="3D"?I/2+.1:b/2+S+.5],[-_e/2*.3,x/2-b,P==="3D"?I/2+.1:b/2+S+.5]],color:ye,lineWidth:1}),l.jsxs("mesh",{position:[-_e/2*.3,x/2,P==="3D"?I/2+.1:b/2+S+.5],children:[l.jsx("sphereGeometry",{args:[.02,8,8]}),l.jsx("meshBasicMaterial",{color:ye})]}),l.jsxs("mesh",{position:[-_e/2*.3,x/2-b,P==="3D"?I/2+.1:b/2+S+.5],children:[l.jsx("sphereGeometry",{args:[.02,8,8]}),l.jsx("meshBasicMaterial",{color:ye})]})]})]})};return console.log("🚨 DualType6 렌더링 시작:",{moduleId:n.id,showFurniture:g,isDragging:a,baseFurniture:{width:m.width,height:m.height,depth:m.depth,material:m.material}}),l.jsxs(l.Fragment,{children:[H&&l.jsx(IndirectLight,{width:m.innerWidth*1.5,depth:m.depth*1.5,intensity:Q||.8,position:[0,te,0]}),g&&l.jsxs("group",{children:[console.log("🔍 DualType6 기본 구조 렌더링:",{width:w,height:x,depth:T,innerWidth:j,innerHeight:D,basicThickness:b,leftPanelPosition:-w/2+b/2,rightPanelPosition:w/2-b/2}),l.jsx(zi,{args:[b,x,T],position:[-w/2+b/2,0,0],material:F,renderMode:Qi().renderMode,isDragging:a,isEditMode:c}),l.jsx(zi,{args:[b,x,T],position:[w/2-b/2,0,0],material:F,renderMode:Qi().renderMode,isDragging:a,isEditMode:c}),l.jsx(zi,{args:[j,b,T],position:[0,x/2-b/2,0],material:F,renderMode:Qi().renderMode,isDragging:a,isEditMode:c}),l.jsxs(l.Fragment,{children:[l.jsx(zi,{args:[_e,b,T],position:[Y,-x/2+b/2,0],material:F,renderMode:Qi().renderMode,isDragging:a}),l.jsx(zi,{args:[W,b,T],position:[ve,-x/2+b/2,0],material:F,renderMode:Qi().renderMode,isDragging:a}),X&&ce&&ne>0&&l.jsxs("group",{children:[l.jsx(it,{points:[[(_e-W)/2+b/2,(-x/2+b+(-x/2+b+E(ne-9)))/2,P==="3D"?S+I/2:S],[w/2-b,(-x/2+b+(-x/2+b+E(ne-9)))/2,P==="3D"?S+I/2:S]],color:ye,lineWidth:1}),l.jsx(zn,{position:[((_e-W)/2+b/2+w/2-b)/2,(-x/2+b+(-x/2+b+E(ne-9)))/2-.2,P==="3D"?S+I/2:S],fontSize:be,color:ye,anchorX:"center",anchorY:"top",renderOrder:999,depthTest:!1,children:Math.round(K(W))}),l.jsxs("mesh",{position:[(_e-W)/2+b/2,(-x/2+b+(-x/2+b+E(ne-9)))/2,P==="3D"?S+I/2:S],children:[l.jsx("sphereGeometry",{args:[.03,8,8]}),l.jsx("meshBasicMaterial",{color:ye})]}),l.jsxs("mesh",{position:[w/2-b,(-x/2+b+(-x/2+b+E(ne-9)))/2,P==="3D"?S+I/2:S],children:[l.jsx("sphereGeometry",{args:[.03,8,8]}),l.jsx("meshBasicMaterial",{color:ye})]})]})]}),l.jsx(zi,{args:[j+E(10),D+E(10),_],position:[0,0,-T/2+_/2+E(17)],material:F,renderMode:Qi().renderMode,isDragging:a,isEditMode:c,isBackPanel:!0}),!a&&Te()]}),i&&o&&l.jsx(dh,{moduleWidth:h||n.dimensions.width,moduleDepth:m.actualDepthMm,hingePosition:s,spaceInfo:o,color:m.doorColor,moduleData:n,originalSlotWidth:u,slotCenterX:f,slotWidths:A,isDragging:a,isEditMode:c,slotIndex:d})]})}catch(m){return console.error("🚨 DualType6 렌더링 에러:",m),console.error("스택 트레이스:",m.stack),console.error("모듈 데이터:",n),console.error("Props:",{color:e,internalHeight:t,hasDoor:i,customDepth:r,isDragging:a,isEditMode:c,showFurniture:g,slotWidths:A}),l.jsx("group",{})}},FI=({width:n,height:e,depth:t,position:i,spaceInfo:r,doorColor:s,renderMode:o="solid"})=>{var u,d;const[a,c]=O.useState(!1),h=O.useMemo(()=>{var g,p;const f=new oo({color:s,metalness:0,roughness:.6,transparent:o==="wireframe",opacity:o==="wireframe"?.3:1,wireframe:o==="wireframe"}),A=((g=r==null?void 0:r.materialConfig)==null?void 0:g.interiorTexture)||((p=r==null?void 0:r.materialConfig)==null?void 0:p.doorTexture);return A&&(gd(A)&&Sm(f),new xg().load(A,v=>{v.wrapS=Gh,v.wrapT=Gh,v.repeat.set(1,1),f.map=v,f.needsUpdate=!0,c(!0)},void 0,v=>{console.error("마감재 텍스처 로드 실패:",v)})),f},[s,o,(u=r==null?void 0:r.materialConfig)==null?void 0:u.interiorTexture,(d=r==null?void 0:r.materialConfig)==null?void 0:d.doorTexture]);return O.useEffect(()=>()=>{h.map&&h.map.dispose(),h.dispose()},[h]),l.jsx(zi,{args:[n,e,t],position:i,material:h,renderMode:o,hideEdges:!1})},_he=({moduleData:n,color:e,isDragging:t=!1,isEditMode:i=!1,internalHeight:r,hasDoor:s=!1,hasBackPanel:o=!0,customDepth:a,hingePosition:c="right",spaceInfo:h,doorWidth:u,doorXOffset:d=0,originalSlotWidth:f,slotIndex:A,slotCenterX:g,adjustedWidth:p,showFurniture:y=!0})=>{const{renderMode:v,viewMode:m}=Qi(),w=Ru(n,{color:e,internalHeight:r,customDepth:a,isDragging:t,isEditMode:i,adjustedWidth:p});return l.jsxs(l.Fragment,{children:[y&&l.jsxs(l.Fragment,{children:[l.jsx(Xm,{...w,isDragging:t,isEditMode:i,hasBackPanel:o,children:!t&&l.jsx(l.Fragment,{children:w.modelConfig.leftSections&&w.modelConfig.rightSections?l.jsxs(l.Fragment,{children:[l.jsx("group",{position:[-(w.innerWidth/2-w.basicThickness/2)/2-w.basicThickness/2,0,0],children:l.jsx(ch,{modelConfig:{sections:w.modelConfig.leftSections},height:w.height,innerWidth:w.innerWidth/2-w.basicThickness/2,depth:w.depth,adjustedDepthForShelves:w.adjustedDepthForShelves,basicThickness:w.basicThickness,shelfZOffset:w.shelfZOffset,material:w.material,calculateSectionHeight:w.calculateSectionHeight,renderMode:v})}),l.jsx(zi,{args:[w.basicThickness,w.height-w.basicThickness*2,w.adjustedDepthForShelves],position:[0,0,w.shelfZOffset],material:w.material,renderMode:v}),l.jsx("group",{position:[(w.innerWidth/2-w.basicThickness/2)/2+w.basicThickness/2,0,0],children:l.jsx(ch,{modelConfig:{sections:w.modelConfig.rightSections},height:w.height,innerWidth:w.innerWidth/2-w.basicThickness/2,depth:w.depth,adjustedDepthForShelves:w.adjustedDepthForShelves,basicThickness:w.basicThickness,shelfZOffset:w.shelfZOffset,material:w.material,calculateSectionHeight:w.calculateSectionHeight,renderMode:v})})]}):l.jsx(ch,{modelConfig:w.modelConfig,height:w.height,innerWidth:w.innerWidth,depth:w.depth,adjustedDepthForShelves:w.adjustedDepthForShelves,basicThickness:w.basicThickness,shelfZOffset:w.shelfZOffset,material:w.material,calculateSectionHeight:w.calculateSectionHeight,renderMode:v})})}),!t&&l.jsx(FI,{width:w.width,height:.18,depth:w.depth-.4,position:[0,-(w.height/2)-.09,.2],spaceInfo:h,doorColor:w.doorColor,renderMode:v})]}),s&&h&&l.jsx(dh,{moduleWidth:u||n.dimensions.width,moduleDepth:w.actualDepthMm,hingePosition:c,spaceInfo:h,color:w.doorColor,originalSlotWidth:f,slotCenterX:g,moduleData:n,isDragging:t,isEditMode:i,slotIndex:A})]})},Che=({moduleData:n,color:e,isDragging:t=!1,isEditMode:i=!1,internalHeight:r,hasDoor:s=!1,hasBackPanel:o=!0,customDepth:a,hingePosition:c="right",spaceInfo:h,doorWidth:u,doorXOffset:d=0,originalSlotWidth:f,slotIndex:A,slotCenterX:g,adjustedWidth:p,showFurniture:y=!0})=>{var D,b;const{renderMode:v,viewMode:m}=Qi(),{indirectLightEnabled:w,indirectLightIntensity:x}=Bi(),T=Ru(n,{color:e,internalHeight:r,customDepth:a,isDragging:t,isEditMode:i,adjustedWidth:p});return(D=h==null?void 0:h.baseConfig)==null||D.placementType,(b=h==null?void 0:h.baseConfig)!=null&&b.floatHeight,l.jsxs(l.Fragment,{children:[!1,y&&l.jsxs(l.Fragment,{children:[l.jsx(Xm,{...T,isDragging:t,isEditMode:i,hasBackPanel:o,children:!t&&l.jsx(l.Fragment,{children:T.modelConfig.leftSections&&T.modelConfig.rightSections?l.jsxs(l.Fragment,{children:[l.jsx("group",{position:[-(T.innerWidth/2-T.basicThickness/2)/2-T.basicThickness/2,0,0],children:l.jsx(ch,{modelConfig:{sections:T.modelConfig.leftSections},height:T.height,innerWidth:T.innerWidth/2-T.basicThickness/2,depth:T.depth,adjustedDepthForShelves:T.adjustedDepthForShelves,basicThickness:T.basicThickness,shelfZOffset:T.shelfZOffset,material:T.material,calculateSectionHeight:T.calculateSectionHeight,renderMode:v})}),l.jsx(zi,{args:[T.basicThickness,T.height-T.basicThickness*2,T.adjustedDepthForShelves],position:[0,0,T.shelfZOffset],material:T.material,renderMode:v}),l.jsx("group",{position:[(T.innerWidth/2-T.basicThickness/2)/2+T.basicThickness/2,0,0],children:l.jsx(ch,{modelConfig:{sections:T.modelConfig.rightSections},height:T.height,innerWidth:T.innerWidth/2-T.basicThickness/2,depth:T.depth,adjustedDepthForShelves:T.adjustedDepthForShelves,basicThickness:T.basicThickness,shelfZOffset:T.shelfZOffset,material:T.material,calculateSectionHeight:T.calculateSectionHeight,renderMode:v})})]}):l.jsx(ch,{modelConfig:T.modelConfig,height:T.height,innerWidth:T.innerWidth,depth:T.depth,adjustedDepthForShelves:T.adjustedDepthForShelves,basicThickness:T.basicThickness,shelfZOffset:T.shelfZOffset,material:T.material,calculateSectionHeight:T.calculateSectionHeight,renderMode:v})})}),!t&&l.jsx(FI,{width:T.width,height:.18,depth:T.depth,position:[0,T.height/2+.09,0],spaceInfo:h,doorColor:T.doorColor,renderMode:v})]}),s&&h&&l.jsx(dh,{moduleWidth:u||n.dimensions.width,moduleDepth:T.actualDepthMm,hingePosition:c,spaceInfo:h,color:T.doorColor,originalSlotWidth:f,slotCenterX:g,moduleData:n,isDragging:t,isEditMode:i,slotIndex:A})]})},S$=({moduleData:n,color:e,isDragging:t=!1,isEditMode:i=!1,internalHeight:r,hasDoor:s=!1,hasBackPanel:o=!0,customDepth:a,hingePosition:c="right",spaceInfo:h,doorWidth:u,doorXOffset:d=0,originalSlotWidth:f,slotCenterX:A,adjustedWidth:g,slotWidths:p,slotIndex:y,viewMode:v,renderMode:m,furnitureId:w,showFurniture:x=!0,isHighlighted:T=!1,adjacentCabinets:j,onPointerDown:D,onPointerMove:b,onPointerUp:_,onPointerOver:I,onPointerOut:S,onDoubleClick:F})=>{var P,M,X,Z;qi();const{indirectLightEnabled:B,indirectLightIntensity:E,indirectLightColor:V}=Bi();ci(Q=>Q.placedModules);const K=Ru(n,{color:e,internalHeight:r,customDepth:a,isDragging:t,isEditMode:i,adjustedWidth:g,isHighlighted:T});return n.id.includes("dual-4drawer-hanging")?l.jsx(l.Fragment,{children:l.jsx(whe,{moduleData:n,color:e,isDragging:t,isEditMode:i,internalHeight:r,hasDoor:s,customDepth:a,hingePosition:c,spaceInfo:h,doorWidth:u,doorXOffset:0,originalSlotWidth:f,slotCenterX:A,adjustedWidth:g,slotWidths:p,slotIndex:y,showFurniture:x,onPointerDown:D,onPointerMove:b,onPointerUp:_,onPointerOver:I,onPointerOut:S,onDoubleClick:F,furnitureId:w})}):n.id.includes("dual-2drawer-hanging")?l.jsx(l.Fragment,{children:l.jsx(yhe,{moduleData:n,color:e,isDragging:t,isEditMode:i,internalHeight:r,hasDoor:s,customDepth:a,hingePosition:c,spaceInfo:h,doorWidth:u,doorXOffset:0,originalSlotWidth:f,slotCenterX:A,adjustedWidth:g,slotWidths:p,slotIndex:y,showFurniture:x,onPointerDown:D,onPointerMove:b,onPointerUp:_,onPointerOver:I,onPointerOut:S,onDoubleClick:F,furnitureId:w})}):n.id.includes("dual-2hanging")?l.jsx(l.Fragment,{children:l.jsx(vhe,{moduleData:n,color:e,isDragging:t,isEditMode:i,internalHeight:r,hasDoor:s,customDepth:a,hingePosition:c,spaceInfo:h,doorWidth:u,doorXOffset:0,originalSlotWidth:f,slotCenterX:A,adjustedWidth:g,slotWidths:p,slotIndex:y,showFurniture:x,onPointerDown:D,onPointerMove:b,onPointerUp:_,onPointerOver:I,onPointerOut:S,onDoubleClick:F,furnitureId:w})}):n.id.includes("single-4drawer-hanging")?l.jsx(l.Fragment,{children:l.jsx(mhe,{moduleData:n,color:e,isDragging:t,isEditMode:i,internalHeight:r,hasDoor:s,customDepth:a,hingePosition:c,spaceInfo:h,doorWidth:u,doorXOffset:0,originalSlotWidth:f,slotCenterX:A,adjustedWidth:g,slotIndex:y,showFurniture:x,furnitureId:w})}):n.id.includes("single-2drawer-hanging")?l.jsx(l.Fragment,{children:l.jsx(phe,{moduleData:n,color:e,isDragging:t,isEditMode:i,internalHeight:r,hasDoor:s,customDepth:a,hingePosition:c,spaceInfo:h,doorWidth:u,doorXOffset:0,originalSlotWidth:f,slotCenterX:A,adjustedWidth:g,slotIndex:y,showFurniture:x,isHighlighted:T,furnitureId:w})}):n.id.includes("single-2hanging")?l.jsx(l.Fragment,{children:l.jsx(ghe,{moduleData:n,color:e,isDragging:t,isEditMode:i,internalHeight:r,hasDoor:s,customDepth:a,hingePosition:c,spaceInfo:h,doorWidth:u,doorXOffset:0,originalSlotWidth:f,slotCenterX:A,adjustedWidth:g,slotIndex:y,showFurniture:x,furnitureId:w})}):n.id.includes("dual-2drawer-styler")?(console.log("🔍 BoxModule: 스타일러장 렌더링 시작",{moduleId:n.id,showFurniture:x,isDragging:t,isEditMode:i,spaceInfo:{hasSpaceInfo:!!h,placementType:(P=h==null?void 0:h.baseConfig)==null?void 0:P.placementType,floatHeight:(M=h==null?void 0:h.baseConfig)==null?void 0:M.floatHeight}}),l.jsx(l.Fragment,{children:l.jsx(xhe,{moduleData:n,color:e,isDragging:t,isEditMode:i,internalHeight:r,hasDoor:s,customDepth:a,hingePosition:c,spaceInfo:h,doorWidth:u,doorXOffset:0,originalSlotWidth:f,slotCenterX:A,adjustedWidth:g,slotWidths:p,slotIndex:y,showFurniture:x,onPointerDown:D,onPointerMove:b,onPointerUp:_,onPointerOver:I,onPointerOut:S,onDoubleClick:F,furnitureId:w})})):n.id.includes("dual-4drawer-pantshanger")?(console.log("🔍 BoxModule: 바지걸이장 렌더링 시작",{moduleId:n.id,showFurniture:x,isDragging:t,isEditMode:i,spaceInfo:{hasSpaceInfo:!!h,placementType:(X=h==null?void 0:h.baseConfig)==null?void 0:X.placementType,floatHeight:(Z=h==null?void 0:h.baseConfig)==null?void 0:Z.floatHeight}}),l.jsx(l.Fragment,{children:l.jsx(bhe,{moduleData:n,color:e,isDragging:t,isEditMode:i,internalHeight:r,hasDoor:s,customDepth:a,hingePosition:c,spaceInfo:h,doorWidth:u,doorXOffset:0,originalSlotWidth:f,slotCenterX:A,adjustedWidth:g,slotWidths:p,slotIndex:y,showFurniture:x,onPointerDown:D,onPointerMove:b,onPointerUp:_,onPointerOver:I,onPointerOut:S,onDoubleClick:F,furnitureId:w})})):n.id.includes("upper-cabinet-")||n.id.includes("dual-upper-cabinet-")?l.jsx(l.Fragment,{children:l.jsx(_he,{moduleData:n,color:e,isDragging:t,isEditMode:i,internalHeight:r,hasDoor:s,hasBackPanel:o,customDepth:a,hingePosition:c,spaceInfo:h,doorWidth:u,doorXOffset:0,originalSlotWidth:f,slotCenterX:A,adjustedWidth:g,slotIndex:y,showFurniture:x})}):n.id.includes("lower-cabinet-")||n.id.includes("dual-lower-cabinet-")?l.jsx(l.Fragment,{children:l.jsx(Che,{moduleData:n,color:e,isDragging:t,isEditMode:i,internalHeight:r,hasDoor:s,hasBackPanel:o,customDepth:a,hingePosition:c,spaceInfo:h,doorWidth:u,doorXOffset:0,originalSlotWidth:f,slotCenterX:A,adjustedWidth:g,slotIndex:y,showFurniture:x})}):l.jsxs(l.Fragment,{children:[x&&l.jsx(Xm,{...K,isDragging:t,isEditMode:i,isHighlighted:T,children:!t&&l.jsx(ch,{modelConfig:K.modelConfig,height:K.height,innerWidth:K.innerWidth,depth:K.depth,adjustedDepthForShelves:K.adjustedDepthForShelves,basicThickness:K.basicThickness,shelfZOffset:K.shelfZOffset,material:K.material,calculateSectionHeight:K.calculateSectionHeight,renderMode:m||Qi().renderMode,furnitureId:w})}),(console.log("🚪 BoxModule 도어 체크:",{moduleId:n.id,hasDoor:s,spaceInfo:!!h,showFurniture:x,viewMode:Qi().viewMode,willRenderDoor:s&&h}),s&&h?l.jsx(dh,{moduleWidth:u||n.dimensions.width,moduleDepth:K.actualDepthMm,hingePosition:c,spaceInfo:h,color:K.doorColor,doorXOffset:d,originalSlotWidth:f,slotCenterX:A,slotWidths:p,slotIndex:y,moduleData:n,isDragging:t,isEditMode:i}):null)]})},E0=({size:n=16,color:e="currentColor",className:t})=>l.jsx("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:l.jsx("path",{d:"M10 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-8l-2-2z",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),nh=({size:n=16,color:e="currentColor",className:t})=>l.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[l.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("circle",{cx:"12",cy:"7",r:"4",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),rE=({size:n=16,color:e="currentColor",className:t})=>l.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[l.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("polyline",{points:"12,6 12,12 16,14",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),She=({size:n=16,color:e="currentColor",className:t})=>l.jsx("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:l.jsx("polygon",{points:"12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),Sy=({size:n=16,color:e="currentColor",className:t})=>l.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[l.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("circle",{cx:"9",cy:"7",r:"4",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),O0=({size:n=16,color:e="currentColor",className:t})=>l.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[l.jsx("polyline",{points:"3,6 5,6 21,6",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2m3 0v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6h14z",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),The=({size:n=16,color:e="currentColor",className:t})=>l.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[l.jsx("circle",{cx:"13.5",cy:"6.5",r:".5",fill:e}),l.jsx("circle",{cx:"17.5",cy:"10.5",r:".5",fill:e}),l.jsx("circle",{cx:"8.5",cy:"7.5",r:".5",fill:e}),l.jsx("circle",{cx:"6.5",cy:"12.5",r:".5",fill:e}),l.jsx("path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),$j=({size:n=16,color:e="currentColor",className:t})=>l.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[l.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("circle",{cx:"12",cy:"12",r:"3",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),Ty=({size:n=16,color:e="currentColor",className:t})=>l.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[l.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),T$=({size:n=16,color:e="currentColor",className:t})=>l.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[l.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),DI=({size:n=16,color:e="currentColor",className:t})=>l.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[l.jsx("circle",{cx:"12",cy:"12",r:"3",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),Np=({size:n=16,color:e="currentColor",className:t})=>l.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[l.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),Bhe=({size:n=16,color:e="currentColor",className:t})=>l.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[l.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("polyline",{points:"16,17 21,12 16,7",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),Ehe=({size:n=16,color:e="currentColor",className:t})=>l.jsx("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:l.jsx("polyline",{points:"6,9 12,15 18,9",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),khe=({size:n=16,color:e="currentColor",className:t})=>l.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[l.jsx("circle",{cx:"11",cy:"11",r:"8",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("path",{d:"M21 21l-4.35-4.35",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),Ihe=({size:n=16,color:e="currentColor",className:t})=>l.jsx("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:l.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),B$=({size:n=16,color:e="currentColor",className:t})=>l.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[l.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),U0=({size:n=16,color:e="currentColor",className:t})=>l.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[l.jsx("circle",{cx:"18",cy:"5",r:"3",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("circle",{cx:"6",cy:"12",r:"3",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("circle",{cx:"18",cy:"19",r:"3",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),Vj=({size:n=16,color:e="currentColor",className:t})=>l.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[l.jsx("circle",{cx:"12",cy:"12",r:"5",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),zj=({size:n=16,color:e="currentColor",className:t})=>l.jsx("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:l.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),t3=({size:n=16,color:e="currentColor",className:t})=>l.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[l.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("polyline",{points:"17,21 17,13 7,13 7,21",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("polyline",{points:"7,3 7,8 15,8",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),Fhe=({size:n=16,color:e="currentColor",className:t})=>l.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[l.jsx("rect",{x:"3",y:"4",width:"18",height:"15",rx:"2",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("rect",{x:"7",y:"8",width:"10",height:"2",rx:"1",fill:e}),l.jsx("rect",{x:"7",y:"12",width:"6",height:"1.5",rx:"0.75",fill:e})]}),Dhe=({size:n=16,color:e="currentColor",className:t})=>l.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[l.jsx("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("polyline",{points:"22,6 12,13 2,6",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),jhe=({size:n=16,color:e="currentColor",className:t})=>l.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[l.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),Phe=({size:n=16,color:e="currentColor",className:t})=>l.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[l.jsx("path",{d:"M23 17a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("circle",{cx:"12",cy:"13",r:"4",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),Nhe=({size:n=16,color:e="currentColor",className:t})=>l.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[l.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),E$=({size:n=16,color:e="currentColor",className:t})=>l.jsx("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:l.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),k$=({size:n=16,color:e="currentColor",className:t})=>l.jsx("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:l.jsx("path",{d:"M4 14h6m0 0v6m0-6l-7 7m17-11h-6m0 0V4m0 6l7-7",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),Lhe=({size:n=16,color:e="currentColor",className:t})=>l.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",className:t,children:[l.jsx("rect",{x:"7",y:"3",width:"4",height:"18",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("rect",{x:"13",y:"3",width:"4",height:"18",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("line",{x1:"3",y1:"21",x2:"21",y2:"21",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]});function Mhe(n){const{isDragging:e=!1,isEditMode:t=!1,isDragMode:i=!1,viewMode:r="3D",view2DTheme:s="light",renderMode:o="solid"}=n;return e?th():t?"#ff5500":i?"#ff0000":r==="2D"&&o==="wireframe"?"#ff5500":r==="2D"&&s==="dark"?"#999999":"#cccccc"}const Rhe=(n,e,t,i)=>{const r=ci(f=>f.updatePlacedModule),[s,o]=O.useState({isResizing:!1,startPoint:null,startWidth:n.customWidth||150,startDepth:n.customDepth||600,direction:null}),a=.01,c=O.useRef(null),h=O.useCallback(f=>{if(!e)return;f.stopPropagation();const A=f.point.clone();o({isResizing:!0,startPoint:A,startWidth:n.customWidth||150,startDepth:n.customDepth||600,direction:null}),c.current=null,window.dispatchEvent(new CustomEvent("furniture-drag-start")),document.body.style.cursor="crosshair"},[e,n.customWidth,n.customDepth]),u=O.useCallback(f=>{if(!s.isResizing||!s.startPoint)return;const A=f.point.clone(),g=A.x-s.startPoint.x,p=A.z-s.startPoint.z;if(!c.current){(Math.abs(g)>a||Math.abs(p)>a)&&(c.current=Math.abs(g)>Math.abs(p)?"horizontal":"vertical",o(y=>({...y,direction:c.current})));return}if(c.current==="horizontal"){const y=g*1e3;let v=s.startWidth+y;v=Math.max(150,Math.min(i,v)),r(n.id,{customWidth:Math.round(v)}),console.log("🔄 가구 너비 조절:",{deltaX:g.toFixed(3),startWidth:s.startWidth,newWidth:Math.round(v)})}else if(c.current==="vertical"){const y=-p*1e3;let v=s.startDepth+y;const m=Math.max(200,600-t);v=Math.max(m,Math.min(600,v));const x=v-(n.customDepth||600),T=n.position.z-x*.001/2;r(n.id,{customDepth:Math.round(v),position:{...n.position,z:T}}),console.log("🔄 가구 깊이 조절:",{deltaZ:p.toFixed(3),startDepth:s.startDepth,newDepth:Math.round(v),newZ:T.toFixed(3)})}},[s,n,t,r]),d=O.useCallback(()=>{s.isResizing&&(o({isResizing:!1,startPoint:null,startWidth:n.customWidth||150,startDepth:n.customDepth||600,direction:null}),c.current=null,document.body.style.cursor="default",window.dispatchEvent(new CustomEvent("furniture-drag-end")),console.log("✅ 크기 조절 완료:",{finalWidth:n.customWidth,finalDepth:n.customDepth}))},[s.isResizing,n]);return{isResizing:s.isResizing,resizeDirection:s.direction,handlePointerDown:h,handlePointerMove:u,handlePointerUp:d}},Gj=({width:n,height:e,depth:t,position:i,spaceInfo:r,renderMode:s="solid"})=>{var h,u,d;const[o,a]=O.useState(!1),c=O.useMemo(()=>{var g,p,y;const f=new oo({color:((g=r.materialConfig)==null?void 0:g.doorColor)||"#E0E0E0",metalness:.1,roughness:.8}),A=((p=r.materialConfig)==null?void 0:p.interiorTexture)||((y=r.materialConfig)==null?void 0:y.doorTexture);return A&&(gd(A)&&Sm(f),new xg().load(A,m=>{m.wrapS=Gh,m.wrapT=Gh,m.repeat.set(1,1),f.map=m,f.needsUpdate=!0,a(!0)},void 0,m=>{console.error("엔드패널 텍스처 로드 실패:",m)})),f},[(h=r.materialConfig)==null?void 0:h.doorColor,(u=r.materialConfig)==null?void 0:u.interiorTexture,(d=r.materialConfig)==null?void 0:d.doorTexture]);return O.useEffect(()=>()=>{c.map&&c.map.dispose(),c.dispose()},[c]),l.jsx(zi,{isEndPanel:!0,args:[n,e,t],position:i,material:c,renderMode:s})},Ma=18,Ohe=(n,e,t)=>{var f,A,g;const i=Hi(n.moduleId,kr(t),t);if(!i)return{hasAdjacentUpperLower:!1,adjacentSide:null};const r=(f=n.moduleId)==null?void 0:f.includes("dual-");if(console.log("🔍 checkAdjacentUpperLowerToFull 시작:",{moduleId:n.moduleId,category:i.category,isDualCabinet:r,slotIndex:n.slotIndex}),i.category!=="full"&&!r)return console.log("❌ 키큰장/듀얼이 아니므로 처리 안함"),{hasAdjacentUpperLower:!1,adjacentSide:null};const s=n.slotIndex;if(s===void 0)return{hasAdjacentUpperLower:!1,adjacentSide:null};const o=r||n.isDualSlot,a=e.find(p=>p.slotIndex===s-1),c=o?e.find(p=>p.slotIndex===s+2):e.find(p=>p.slotIndex===s+1);let h=!1,u=!1;if(a){const p=Hi(a.moduleId,kr(t),t),y=p&&(p.category==="upper"||p.category==="lower");((A=a.moduleId)==null?void 0:A.includes("dual-"))&&y&&a.isDualSlot?a.slotIndex+1===s-1&&(console.log("🔍 키큰장 왼쪽에 듀얼상하부장 감지 (듀얼의 오른쪽 슬롯):",{current:n.moduleId,leftModule:a.moduleId,isDual:o}),h=!0):y&&(console.log("🔍 듀얼/키큰장 왼쪽에 상하부장 감지:",{current:n.moduleId,leftModule:a.moduleId,isDual:o}),h=!0)}if(!h){const p=e.find(y=>y.isDualSlot&&y.slotIndex===s-2);if(p){const y=Hi(p.moduleId,kr(t),t);y&&(y.category==="upper"||y.category==="lower")&&(console.log("🔍 키큰장 왼쪽에 듀얼상하부장 감지:",{current:n.moduleId,leftDualModule:p.moduleId}),h=!0)}}if(c){const p=Hi(c.moduleId,kr(t),t),y=p&&(p.category==="upper"||p.category==="lower"),v=((g=c.moduleId)==null?void 0:g.includes("dual-"))&&y;y&&(console.log("🔍 듀얼/키큰장 오른쪽에 상하부장 감지:",{current:n.moduleId,rightModule:c.moduleId,isDual:o,currentSlotIndex:s,rightCheckSlot:o?s+2:s+1,isRightDualUpperLower:v}),u=!0)}const d=h&&u?{hasAdjacentUpperLower:!0,adjacentSide:"both"}:h?{hasAdjacentUpperLower:!0,adjacentSide:"left"}:u?{hasAdjacentUpperLower:!0,adjacentSide:"right"}:{hasAdjacentUpperLower:!1,adjacentSide:null};return o&&console.log("🎯 듀얼 가구 인접 체크 결과:",{currentModule:n.moduleId,currentSlotIndex:s,hasLeftAdjacent:h,hasRightAdjacent:u,adjacentSide:d.adjacentSide,leftCheckSlot:s-1,rightCheckSlot:s+2,leftAdjacentModule:a==null?void 0:a.moduleId,rightAdjacentModule:c==null?void 0:c.moduleId,allModulesSlots:e.map(p=>({id:p.moduleId,slot:p.slotIndex}))}),d},Uhe=({placedModule:n,placedModules:e,spaceInfo:t,furnitureStartY:i,isDragMode:r,isEditMode:s,isDraggingThis:o,viewMode:a,view2DDirection:c,renderMode:h,onPointerDown:u,onPointerMove:d,onPointerUp:f,onDoubleClick:A,showFurniture:g=!0,isReadOnly:p=!1})=>{var Je,ht,ut,ft,jt,Wt,Mt,dn,on,Et,an,Mn,At,zt,Zt,$t,Ht,Lt;ii.useEffect(()=>{var dt,at;(n.moduleId.includes("dual-4drawer-pantshanger")||n.moduleId.includes("dual-2drawer-styler"))&&console.log("🎯 FurnitureItem - furnitureStartY 변경 감지:",{moduleId:n.moduleId,furnitureStartY:i,baseConfig:t==null?void 0:t.baseConfig,placementType:(dt=t==null?void 0:t.baseConfig)==null?void 0:dt.placementType,floatHeight:(at=t==null?void 0:t.baseConfig)==null?void 0:at.floatHeight})},[i,(Je=t==null?void 0:t.baseConfig)==null?void 0:Je.placementType,(ht=t==null?void 0:t.baseConfig)==null?void 0:ht.floatHeight,n.moduleId]);const{gl:y,invalidate:v,scene:m,camera:w}=jl(),{isFurnitureDragging:x,showDimensions:T,view2DTheme:j,highlightedCompartment:D}=Bi(),{updatePlacedModule:b}=ci(),[_,I]=ii.useState(!1),S=D===n.id;ii.useEffect(()=>{S&&console.log("🔆 가구 강조됨:",{moduleId:n.id,highlightedCompartment:D,isHighlighted:S})},[S,n.id,D]),ii.useEffect(()=>{v(),y&&y.shadowMap&&(y.shadowMap.needsUpdate=!0,setTimeout(()=>{y.shadowMap.needsUpdate=!0,v()},100),setTimeout(()=>{y.shadowMap.needsUpdate=!0,v()},300))},[n.position.x,n.position.y,n.position.z,n.id,v,y]);const[F,B]=ii.useState(!1),E=()=>getComputedStyle(document.documentElement).getPropertyValue("--theme-primary").trim()||"#10b981";let V=kr(t),K=t;if((ut=t.droppedCeiling)!=null&&ut.enabled&&n.zone){const dt=wr.calculateZoneSlotInfo(t,t.customColumnCount),at=n.zone==="dropped"&&dt.dropped?dt.dropped:dt.normal,Ot=((ft=t.droppedCeiling)==null?void 0:ft.width)||DEFAULT_DROPPED_CEILING_VALUES.WIDTH;let Cn;n.zone==="dropped"?Cn=Ot:Cn=t.width-Ot,K={...t,width:Cn,zone:n.zone},V=kr(K),V.startX=at.startX,n.zone==="dropped"&&console.log("🏗️ [FurnitureItem] 단내림 구간 내경 공간:",{zone:n.zone,internalHeight:V.height,dropHeight:((jt=t.droppedCeiling)==null?void 0:jt.dropHeight)||200,customHeight:n.customHeight})}console.log("🔍 [FurnitureItem] getModuleById 호출:",{moduleId:n.moduleId,customWidth:n.customWidth,zone:n.zone,internalSpace:V});let P=n.moduleId;n.adjustedWidth?console.log("🔧 [FurnitureItem] 기둥 A 침범 - 원본 모듈 사용, 폭은 렌더링 시 조정:",{moduleId:n.moduleId,adjustedWidth:n.adjustedWidth,renderWidth:n.adjustedWidth}):n.customWidth&&!n.adjustedWidth&&!n.moduleId.endsWith(`-${n.customWidth}`)&&(P=`${n.moduleId.replace(/-\d+$/,"")}-${n.customWidth}`,console.log("🔧 [FurnitureItem] customWidth로 ModuleID 생성:",{original:n.moduleId,customWidth:n.customWidth,newTargetModuleId:P}));const M=Hi(P,V,K);ii.useEffect(()=>{M?B(!1):(console.error("❌ [FurnitureItem] 모듈을 찾을 수 없음:",{targetModuleId:P,originalModuleId:n.moduleId,adjustedWidth:n.adjustedWidth,customWidth:n.customWidth}),B(!0))},[M,P,n.moduleId,n.adjustedWidth,n.customWidth]),M&&console.log("✅ [FurnitureItem] 찾은 모듈:",{targetModuleId:P,originalModuleId:n.moduleId,moduleId:M.id,moduleWidth:M.dimensions.width,moduleHeight:M.dimensions.height,customWidth:n.customWidth,expectedWidth:n.customWidth||M.dimensions.width,placedModuleId:n.moduleId,idContainsWidth:n.moduleId.match(/-(\d+)$/),zone:n.zone,internalSpaceHeight:V.height});const X=dt=>dt*.01,Z=ii.useMemo(()=>Rc(t),[t,t.columns,n.id,n.slotIndex,e]);let Q=n.slotIndex;if((Wt=t.droppedCeiling)!=null&&Wt.enabled&&n.zone){const dt=wr.calculateZoneSlotInfo(t,t.customColumnCount);t.droppedCeiling.position==="right"&&n.zone==="dropped"?Q=n.slotIndex+dt.normal.columnCount:t.droppedCeiling.position==="left"&&n.zone==="normal"&&(Q=n.slotIndex+dt.dropped.columnCount)}let U;if((Mt=t.droppedCeiling)!=null&&Mt.enabled&&n.zone){const dt=wr.calculateZoneSlotInfo(t,t.customColumnCount),at=n.zone==="dropped"&&dt.dropped?dt.dropped:dt.normal;U={columnCount:at.columnCount,columnWidth:at.columnWidth,threeUnitPositions:[],threeUnitDualPositions:{},threeUnitBoundaries:[]}}else U=ur(K);const z=Q!==void 0?Z[Q]:void 0,q=(z==null?void 0:z.columnType)==="medium"||!1;let G=M;if(!x&&z&&z.hasColumn&&!q&&M){const dt=Hoe(M,z,t);dt.shouldConvert&&dt.convertedModuleData&&(G=dt.convertedModuleData)}!x&&q&&M&&M.id.includes("dual-")&&(G={...M,id:M.id.replace("dual-","single-"),name:M.name.replace("듀얼","싱글"),dimensions:{...M.dimensions,width:z!=null&&z.subSlots?n.subSlotPosition==="left"?z.subSlots.left.availableWidth:z.subSlots.right.availableWidth:U.columnWidth/2}});const ie=n.isDualSlot!==void 0?n.isDualSlot:(G==null?void 0:G.id.includes("dual-"))||!1,H=G?Ohe(n,e,t):{hasAdjacentUpperLower:!1,adjacentSide:null},se=H.hasAdjacentUpperLower,te=H.adjacentSide;ie&&G&&console.log("🔍 듀얼 가구 인접 체크:",{moduleId:n.moduleId,slotIndex:n.slotIndex,isDualFurniture:ie,category:G.category,adjacentCheck:H,needsEndPanelAdjustment:se});let fe=(G==null?void 0:G.dimensions.width)||600;if(n.adjustedWidth!==void 0&&n.adjustedWidth!==null?(fe=n.adjustedWidth,console.log("📐 adjustedWidth 사용 (기둥 침범):",fe)):U.slotWidths&&n.slotIndex!==void 0&&U.slotWidths[n.slotIndex]!==void 0?ie&&n.slotIndex<U.slotWidths.length-1?(fe=U.slotWidths[n.slotIndex]+U.slotWidths[n.slotIndex+1],console.log("📐 듀얼 캐비넷 - 슬롯 너비 사용:",fe,"(두 슬롯 합계)")):(fe=U.slotWidths[n.slotIndex],console.log("📐 싱글 캐비넷 - 슬롯 너비 사용:",fe)):n.customWidth!==void 0&&n.customWidth!==null?(fe=n.customWidth,console.log("📐 customWidth 사용:",fe)):console.log("📐 기본 너비 사용:",fe),se&&(G==null?void 0:G.category)!=="upper"&&(G==null?void 0:G.category)!=="lower"){const dt=fe;if(ie){const at=te==="both"?Ma*2:Ma;fe-=at,console.log("🔧 듀얼장 - 상하부장 인접으로 너비 조정:",{moduleId:n.moduleId,slotIndex:n.slotIndex,category:G==null?void 0:G.category,isDualFurniture:ie,originalWidth:dt,adjustedWidth:fe,endPanelSide:te,reduction:at,needsEndPanelAdjustment:se,adjacentCheck:H,description:te==="both"?"듀얼장 양쪽에 상하부장 - 36mm 축소 (양쪽 18mm씩)":`듀얼장 ${te}쪽에 상하부장 - 18mm 축소`})}else{const at=te==="both"?Ma*2:Ma;fe-=at,console.log("🔧 키큰장 - 상하부장 인접으로 너비 조정:",{moduleId:n.moduleId,category:G==null?void 0:G.category,isDualFurniture:ie,originalWidth:dt,adjustedWidth:fe,endPanelSide:te,reduction:at,description:te==="both"?"키큰장 + 양쪽 엔드패널(36mm) = 슬롯 전체 너비":"키큰장 + 엔드패널(18mm) = 슬롯 전체 너비"})}}if(U.slotWidths&&n.slotIndex!==void 0){const dt=ie&&n.slotIndex<U.slotWidths.length-1?U.slotWidths[n.slotIndex]+U.slotWidths[n.slotIndex+1]:U.slotWidths[n.slotIndex];console.log("📏 FurnitureItem 크기 비교:",{moduleId:n.moduleId,slotIndex:n.slotIndex,"slotGuideWidth(mm)":dt,"furnitureWidth(mm)":fe,"difference(mm)":Math.abs(dt-fe),"difference(Three.js)":Math.abs(dt-fe)*.01,customWidth:n.customWidth,adjustedWidth:n.adjustedWidth,moduleWidth:(G==null?void 0:G.dimensions.width)||600,isDualSlot:ie,widthSource:n.customWidth!==void 0&&n.customWidth!==null?"customWidth":n.adjustedWidth!==void 0&&n.adjustedWidth!==null?"adjustedWidth":"moduleDefault"})}let ye=!1;if(n.zone&&((dn=t.droppedCeiling)!=null&&dn.enabled)){const dt=wr.calculateZoneSlotInfo(t,t.customColumnCount),at=n.zone==="dropped"&&dt.dropped?dt.dropped:dt.normal;ye=ie?n.slotIndex+2>=at.columnCount:n.slotIndex===at.columnCount-1}else ye=ie?n.slotIndex+2>=U.columnCount:n.slotIndex===U.columnCount-1;let be;U.slotWidths&&n.slotIndex!==void 0&&U.slotWidths[n.slotIndex]!==void 0?ie&&n.slotIndex<U.slotWidths.length-1?be=U.slotWidths[n.slotIndex]+U.slotWidths[n.slotIndex+1]:be=U.slotWidths[n.slotIndex]:be=(G==null?void 0:G.dimensions.width)||600;const _e=0;console.log("🔍 노서라운드 조정 전 상태:",{moduleId:n.moduleId,slotIndex:n.slotIndex,furnitureWidthMm:fe,hasCustomWidth:n.customWidth!==void 0&&n.customWidth!==null,customWidth:n.customWidth,surroundType:t.surroundType,installType:t.installType,columnCount:U.columnCount,isLastSlot:ye,placedModulePosition:n.position});const W=(()=>{var Ot,Cn,Rn,xn,En,Hn,Kn;if(t.surroundType!=="no-surround"||n.slotIndex===void 0)return!1;let dt=n.slotIndex===0,at=ye;if((Ot=t.droppedCeiling)!=null&&Ot.enabled&&n.zone){const Ti=wr.calculateZoneSlotInfo(t,t.customColumnCount),ti=(((Cn=Ti.normal)==null?void 0:Cn.columnCount)||0)+(((Rn=Ti.dropped)==null?void 0:Rn.columnCount)||0);let ai=n.slotIndex;t.droppedCeiling.position==="right"?n.zone==="dropped"&&(ai=(((xn=Ti.normal)==null?void 0:xn.columnCount)||0)+n.slotIndex):t.droppedCeiling.position==="left"&&n.zone==="normal"&&(ai=(((En=Ti.dropped)==null?void 0:En.columnCount)||0)+n.slotIndex),dt=ai===0,at=ai===ti-1}return t.installType==="freestanding"?dt||at:t.installType==="semistanding"||t.installType==="semi-standing"?(Hn=t.wallConfig)!=null&&Hn.left?at:(Kn=t.wallConfig)!=null&&Kn.right?dt:!1:!1})();console.log("🎯 가구 너비 결정:",{moduleId:n.id,placedModuleId:n.moduleId,slotIndex:n.slotIndex,zone:n.zone,isDualFurniture:ie,customWidth:n.customWidth,adjustedWidth:n.adjustedWidth,moduleWidth:(G==null?void 0:G.dimensions.width)||600,finalWidth:fe,평균슬롯너비:U.columnWidth,실제슬롯너비배열:U.slotWidths,실제슬롯너비:(on=U.slotWidths)==null?void 0:on[n.slotIndex],계산방법:n.customWidth?`customWidth 사용 (${n.customWidth}mm)`:U.slotWidths&&n.slotIndex!==void 0&&U.slotWidths[n.slotIndex]?`slotWidths 사용 (${U.slotWidths[n.slotIndex]}mm)`:n.adjustedWidth?`adjustedWidth 사용 (${n.adjustedWidth}mm)`:`기본 모듈 너비 사용 (${(G==null?void 0:G.dimensions.width)||600}mm)`});let Y=n.position;ye&&!x&&(Y={...n.position});const ve=(G==null?void 0:G.dimensions.depth)||600,ce=(G==null?void 0:G.dimensions.height)||2200;n.zone==="dropped"&&console.log("📏 단내림 구간 가구 높이 (초기):",{moduleId:n.id,customHeight:n.customHeight,moduleHeight:(G==null?void 0:G.dimensions.height)||2200,internalSpaceHeight:V.height,finalHeight:ce,zone:n.zone});const ne=n.customDepth||(ve!==((G==null?void 0:G.dimensions.depth)||600)?ve:(G==null?void 0:G.dimensions.depth)||600),he=X(ne),xe=X(fe),Te=X(ce);q&&z&&console.log("🟪 FurnitureItem Column C 깊이 확인:",{moduleId:n.id,placedModuleCustomDepth:n.customDepth,adjustedDepthMm:ve,actualModuleDepth:(G==null?void 0:G.dimensions.depth)||600,finalActualDepthMm:ne,slotIndex:n.slotIndex,isSplit:n.isSplit,spaceType:(Et=n.columnSlotInfo)==null?void 0:Et.spaceType});const Be=X(20),Ye=1500,$e=600,ot=X(Ye),rt=X($e),De=-ot/2+(ot-rt)/2+rt/2-Be-he/2;ve!==((G==null?void 0:G.dimensions.depth)||600)&&(z!=null&&z.hasColumn)&&console.log("🎯 기둥 C - 깊이만 조정, 위치 유지:",{columnDepthMm:((an=z.column)==null?void 0:an.depth)||0,originalDepthMm:(G==null?void 0:G.dimensions.depth)||600,adjustedDepthMm:ve,furnitureZ:De,설명:"가구 위치는 그대로, 깊이만 줄어듦"}),z!=null&&z.hasColumn&&z.columnProcessingMethod==="depth-adjustment"&&z.column&&console.log("🔵 기둥 C - 가구 깊이만 조정 (위치는 고정):",{columnDepthMm:z.column.depth,originalDepthMm:(G==null?void 0:G.dimensions.depth)||600,adjustedDepthMm:ve,actualDepthMm:ne,furnitureZ:De,설명:"가구는 항상 같은 위치에서 시작하고 깊이만 줄어듭니다"});const Ge=o?"#66ff66":void 0;let Re=n.hingePosition||"right";if(t.surroundType==="no-surround"&&n.slotIndex!==void 0){const dt=n.slotIndex===0;let at=!1;if((Mn=t.droppedCeiling)!=null&&Mn.enabled&&U.zones){const Ot=n.zone||"normal",Cn=Ot==="dropped"&&U.zones.dropped?U.zones.dropped:U.zones.normal;at=ie?n.slotIndex+2>=Cn.columnCount:n.slotIndex===Cn.columnCount-1,console.log("🎯 단내림 마지막 슬롯 판단:",{zone:Ot,slotIndex:n.slotIndex,zoneColumnCount:Cn.columnCount,isLastSlot:at,isDualFurniture:ie})}else at=ie?n.slotIndex+2>=U.columnCount:n.slotIndex===U.columnCount-1;t.installType==="freestanding"?dt?(Re="right",console.log("🚪 노서라운드 첫번째 슬롯 힌지: right (왼쪽 엔드패널 커버)")):at&&(Re="left",console.log("🚪 노서라운드 마지막 슬롯 힌지: left (오른쪽 엔드패널 커버)")):(t.installType==="semistanding"||t.installType==="semi-standing")&&(dt&&!((At=t.wallConfig)!=null&&At.left)?Re="right":at&&!((zt=t.wallConfig)!=null&&zt.right)&&(Re="left"))}else!x&&z&&z.hasColumn&&(Re=SQ(z),console.log("🚪 기둥 침범에 따른 힌지 방향 조정:",{slotIndex:z.slotIndex,intrusionDirection:z.intrusionDirection,furniturePosition:z.furniturePosition,originalHinge:n.hingePosition||"right",optimalHinge:Re}));const Ie=q&&((Zt=n.columnSlotInfo)==null?void 0:Zt.spaceType)==="front",Le=Rhe(n,Ie,(($t=z==null?void 0:z.column)==null?void 0:$t.depth)||300,U.columnWidth),et=dt=>{Ie&&!r?Le.handlePointerDown(dt):u(dt,n.id)},ct=dt=>{Le.isResizing?Le.handlePointerMove(dt):d(dt)},mt=()=>{Le.isResizing?Le.handlePointerUp():f()};O.useEffect(()=>{((M==null?void 0:M.category)==="upper"||(G==null?void 0:G.category)==="upper")&&console.log("🔴🔴🔴 상부장 위치 정보:",{id:n.id,moduleId:n.moduleId,category:(M==null?void 0:M.category)||(G==null?void 0:G.category),저장된_Y위치:n.position.y,저장된_Y위치_mm:n.position.y/.01,adjustedPosition_Y:Y.y,실제_렌더링될_Y:"furnitureYPosition 값 사용",문제:"저장된 Y 위치가 잘못되었을 가능성"}),console.log("📍 FurnitureItem 위치 변경:",{id:n.id,placedModulePosition:n.position,adjustedPosition:Y,positionDifference:{x:Y.x-n.position.x,y:Y.y-n.position.y,z:Y.z-n.position.z}})},[n.position.x,n.position.y,n.position.z,Y.x,Y.y,Y.z,n.id,M==null?void 0:M.category,G==null?void 0:G.category]);const je=ii.useMemo(()=>{var at,Ot;if((M==null?void 0:M.category)==="upper"||(G==null?void 0:G.category)==="upper"){const Rn=kr(t).height,xn=(G==null?void 0:G.dimensions.height)||2200,En=t.hasFloorFinish&&t.floorFinish?t.floorFinish.height:0,Hn=((at=t.baseConfig)==null?void 0:at.type)==="floor"?((Ot=t.baseConfig)==null?void 0:Ot.height)||65:0,Kn=X(Rn+Hn-xn/2);return console.log("🔝🔝🔝 상부장 Y 위치 계산 (FurnitureItem):",{moduleId:(G==null?void 0:G.id)||"unknown",category:(M==null?void 0:M.category)||(G==null?void 0:G.category)||"unknown",floorFinishHeightMm:En,baseFrameHeightMm:Hn,internalHeightMm:Rn,furnitureHeightMm:xn,계산식:`${Rn} + ${Hn} - ${xn/2} = ${Rn+Hn-xn/2}`,yPos_Three단위:Kn,yPos_mm:Kn/.01,furnitureStartY:i,adjustedPosition_Y:Y.y,adjustedPosition_Y_mm:Y.y/.01,차이:(Kn-Y.y)/.01,isDragging:o,baseConfig:t==null?void 0:t.baseConfig,설명:"내경높이에 받침대 높이를 더해서 천장 위치 계산"}),o&&console.log("🔝 상부장 드래그 중 Y 위치:",{moduleId:(G==null?void 0:G.id)||"unknown",category:(M==null?void 0:M.category)||(G==null?void 0:G.category)||"unknown",internalHeightMm:Rn,furnitureHeightMm:xn,totalY:Kn,isDragging:o,baseConfig:t==null?void 0:t.baseConfig,설명:"상부장은 천장 기준 (바닥재 높이 제외)"}),Kn}const dt=i+Te/2;return(G!=null&&G.id.includes("dual-4drawer-pantshanger")||G!=null&&G.id.includes("dual-2drawer-styler"))&&console.log("🚀 가구 Y 위치 계산:",{moduleId:(G==null?void 0:G.id)||"unknown",furnitureStartY:i,height:Te,totalY:dt,baseConfig:t==null?void 0:t.baseConfig}),dt},[i,Te,G==null?void 0:G.id,G==null?void 0:G.category,M==null?void 0:M.category,t,(Ht=t==null?void 0:t.baseConfig)==null?void 0:Ht.placementType,(Lt=t==null?void 0:t.baseConfig)==null?void 0:Lt.floatHeight,o]),le=(()=>{var Kn,Ti;if(!W)return 0;const at=be,Ot=fe;let Cn;const En=be-fe;n.slotIndex===0&&(t.installType==="freestanding"||t.installType==="semistanding"&&((Kn=t.wallConfig)!=null&&Kn.right))?Cn=-X(En/2):ye&&(t.installType==="freestanding"||t.installType==="semistanding"&&((Ti=t.wallConfig)!=null&&Ti.left))?Cn=X(En/2):Cn=0;const Hn=Cn;return console.log("🚪 노서라운드 엔드패널 도어 위치 계산:",{슬롯인덱스:n.slotIndex,가구위치:Y.x,가구너비:Ot,도어너비:at,도어오프셋:Hn,설명:"도어가 가구 중심에서 상대적으로 이동하여 엔드패널 커버"}),Hn})();return F||!M?null:l.jsxs("group",{children:[l.jsxs("group",{position:[Y.x+_e,je,De],rotation:[0,n.rotation*Math.PI/180,0],onClick:dt=>{dt.stopPropagation()},onDoubleClick:dt=>{console.log("🎯 FurnitureItem onDoubleClick 이벤트 발생:",n.id),A(dt,n.id)},onPointerDown:et,onPointerMove:ct,onPointerUp:mt,onPointerOver:()=>{Ie&&!r?document.body.style.cursor=Le.isResizing?"crosshair":"move":document.body.style.cursor=r?"grab":o?"grabbing":"grab",I(!0)},onPointerOut:()=>{Le.isResizing||(document.body.style.cursor="default"),I(!1)},children:[t.surroundType==="no-surround"&&t.gapConfig&&(console.log(`🪑 [가구위치] 이격거리${t.gapConfig.left}mm: X=${n.position.x.toFixed(3)}, 폭=${M==null?void 0:M.dimensions.width}mm`),null),(M==null?void 0:M.type)==="box"?l.jsxs(l.Fragment,{children:[l.jsx("group",{position:[se&&te&&(G==null?void 0:G.category)!=="upper"&&(G==null?void 0:G.category)!=="lower"?te==="both"?0:te==="left"?X(Ma/2):-X(Ma/2):0,0,0],children:l.jsx(S$,{moduleData:G,isDragging:o,color:Ge,internalHeight:ce,viewMode:a,renderMode:h,showFurniture:g,isHighlighted:S,hasDoor:x||o||se||z&&z.hasColumn&&(z.columnType==="deep"||n.adjustedWidth!==void 0&&n.adjustedWidth!==null)?!1:n.hasDoor??!1,hasBackPanel:n.hasBackPanel,customDepth:ne,hingePosition:Re,spaceInfo:(()=>{var dt,at;return console.log("🚨 FurnitureItem -> BoxModule spaceInfo 전달:",{moduleId:(G==null?void 0:G.id)||"unknown",hasSpaceInfo:!!K,baseConfig:K==null?void 0:K.baseConfig,placementType:(dt=K==null?void 0:K.baseConfig)==null?void 0:dt.placementType,floatHeight:(at=K==null?void 0:K.baseConfig)==null?void 0:at.floatHeight}),K})(),doorWidth:fe,doorXOffset:0,onDoubleClick:dt=>A(dt,n.id),originalSlotWidth:be,slotCenterX:le,adjustedWidth:fe,slotIndex:n.slotIndex,slotInfo:z,adjacentCabinets:{hasAdjacentUpperLower:se,adjacentSide:te},slotWidths:(()=>{var dt;if(ie){let at;if(n.zone&&((dt=t.droppedCeiling)!=null&&dt.enabled)){const Ot=wr.calculateZoneSlotInfo(t,t.customColumnCount),Cn=n.zone==="dropped"&&Ot.dropped?Ot.dropped:Ot.normal;Cn.slotWidths&&n.slotIndex<Cn.slotWidths.length-1&&(at=[Cn.slotWidths[n.slotIndex],Cn.slotWidths[n.slotIndex+1]])}else U.slotWidths&&n.slotIndex<U.slotWidths.length-1&&(at=[U.slotWidths[n.slotIndex],U.slotWidths[n.slotIndex+1]]);return at&&se?te==="both"?[at[0]-Ma,at[1]-Ma]:[at[0]-Ma/2,at[1]-Ma/2]:at}})()})}),(()=>{const dt=(()=>{var Cn,Rn,xn;if(n.zone&&((Cn=t.droppedCeiling)!=null&&Cn.enabled)&&U.zones){const En=n.zone==="dropped"&&U.zones.dropped?U.zones.dropped:U.zones.normal;return((Rn=En.slotWidths)==null?void 0:Rn[n.slotIndex])||En.columnWidth}return((xn=U.slotWidths)==null?void 0:xn[n.slotIndex])||U.columnWidth})(),at=X(dt),Ot=X(fe);return console.log("🎨 BoxModule 너비 비교:",{moduleId:n.id,slotIndex:n.slotIndex,zone:n.zone,슬롯너비_mm:dt,가구너비_mm:fe,차이_mm:dt-fe,슬롯너비_three:at.toFixed(4),가구너비_three:Ot.toFixed(4),차이_three:(at-Ot).toFixed(4),customWidth:n.customWidth,adjustedWidth:n.adjustedWidth,계산방법:U.slotWidths&&n.slotIndex!==void 0&&U.slotWidths[n.slotIndex]?"slotWidths 배열 사용":n.customWidth?"customWidth 사용":n.adjustedWidth?"adjustedWidth 사용":"기본 모듈 너비 사용"}),null})(),se&&te&&(G==null?void 0:G.category)!=="upper"&&(G==null?void 0:G.category)!=="lower"&&(()=>{const dt=X(fe),at=[],Ot=te==="both"?0:te==="left"?X(Ma/2):-X(Ma/2);if(te==="both"||te==="left"){const Cn=Ot-dt/2-X(Ma)/2;at.push(l.jsx(Gj,{width:X(Ma),height:Te,depth:he,position:[Cn,0,0],spaceInfo:t,renderMode:h},"left-panel")),console.log("🔧 왼쪽 엔드패널 렌더링:",{moduleId:n.id,leftPanelX:Cn,furnitureOffset:Ot,reducedFurnitureWidth:fe})}if(te==="both"||te==="right"){const Cn=Ot+dt/2+X(Ma)/2;at.push(l.jsx(Gj,{width:X(Ma),height:Te,depth:he,position:[Cn,0,0],spaceInfo:t,renderMode:h},"right-panel")),console.log("🔧 오른쪽 엔드패널 렌더링:",{moduleId:n.id,rightPanelX:Cn,furnitureOffset:Ot,reducedFurnitureWidth:fe})}return console.log("🔧 엔드패널 렌더링 완료:",{moduleId:n.id,side:te,panelCount:at.length,furnitureOffset:Ot,isDualFurniture:ie,reducedFurnitureWidth:fe,endPanelThickness:Ma}),at})(),se&&(n.hasDoor??!1)&&!x&&!o&&!(z&&z.hasColumn)&&(()=>{console.log("🚪 엔드패널 도어 별도 렌더링:",{moduleId:n.id,needsEndPanelAdjustment:se,hasDoor:n.hasDoor});const dt=te==="both"?fe+Ma*2:fe+Ma;return l.jsx(dh,{moduleWidth:dt,moduleDepth:ne,hingePosition:Re,spaceInfo:K,color:void 0,doorXOffset:0,originalSlotWidth:be,slotCenterX:le,moduleData:G,isDragging:o,isEditMode:s,slotIndex:n.slotIndex})})()]}):l.jsxs(l.Fragment,{children:[l.jsx(IY,{args:[xe,Te,he],children:l.jsx("meshPhysicalMaterial",{color:Ge,clearcoat:.1,clearcoatRoughness:.8,metalness:0,roughness:.7,reflectivity:.2,transparent:o||s,opacity:o||s?.8:1})}),l.jsx(FY,{color:Le.isResizing?"#ff6600":Mhe({isDragging:o,isEditMode:s,isDragMode:r,viewMode:a,view2DTheme:j,renderMode:h}),threshold:1,scale:1.001,linewidth:Le.isResizing?3:1}),s&&l.jsx("primitive",{object:(()=>{const dt=document.createElement("canvas"),at=dt.getContext("2d");dt.width=256,dt.height=128,at.fillStyle="rgba(255, 140, 0, 0.9)",at.fillRect(0,0,256,128),at.fillStyle="#ffffff",at.font="16px Arial",at.textAlign="center",at.fillText("편집 모드",128,25),at.font="12px Arial",at.fillText("더블클릭으로 진입",128,40),at.fillText("드래그: 이동",128,55),at.fillText("←→: 이동",128,70),at.fillText("Del: 삭제",128,85),at.fillText("Esc: 해제",128,100);const Ot=new Fc(dt),Cn=new uB({map:Ot,transparent:!0,depthTest:!1}),Rn=new GO(3,1.5),xn=new $O(Rn,Cn);return xn.position.set(0,Te+2,0),xn.renderOrder=1002,xn})()})]}),Ie&&_&&!r&&!Le.isResizing&&l.jsx(Y0,{position:[0,Te/2+.5,he/2+.1],center:!0,style:{userSelect:"none",pointerEvents:"none",zIndex:1e3},children:l.jsx("div",{style:{background:"rgba(255, 102, 0, 0.9)",color:"white",padding:"6px 12px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",whiteSpace:"nowrap",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},children:"↔️ 드래그하여 크기 조절"})}),Le.isResizing&&Le.resizeDirection&&l.jsx(Y0,{position:[0,0,he/2+.1],center:!0,style:{userSelect:"none",pointerEvents:"none",zIndex:1e3},children:l.jsx("div",{style:{background:"rgba(255, 102, 0, 0.9)",color:"white",padding:"6px 12px",borderRadius:"4px",fontSize:"14px",fontWeight:"bold",whiteSpace:"nowrap",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},children:Le.resizeDirection==="horizontal"?"↔️ 너비 조절":"↕️ 깊이 조절"})})]}),!x&&!o&&(n.hasDoor??!0)&&(z&&z.hasColumn&&z.columnType==="deep"||z&&z.hasColumn&&n.adjustedWidth!==void 0&&n.adjustedWidth!==null)&&t&&(console.log("🚪🚨 커버도어 렌더링 조건 체크 INSIDE:",{hasDoor:n.hasDoor,showFurniture:g,viewMode:a,isFurnitureDragging:x,isDraggingThis:o,isEditMode:s,hasColumn:z==null?void 0:z.hasColumn,columnType:z==null?void 0:z.columnType,isDeepColumn:(z==null?void 0:z.columnType)==="deep",hasAdjustedWidth:n.adjustedWidth!==void 0&&n.adjustedWidth!==null,adjustedWidth:n.adjustedWidth,originalSlotWidthMm:be,furnitureWidthMm:fe,원래슬롯중심:n.position.x,가구조정위치:Y==null?void 0:Y.x,차이:be-fe,BoxModule도어:z&&z.hasColumn?!1:n.hasDoor??!1,is2DHiddenFurniture:!g&&a==="2D",커버도어렌더링:!0}),!0)&&l.jsxs("group",{position:[(()=>{if(U.threeUnitPositions&&n.slotIndex!==void 0)if(ie&&n.slotIndex<U.threeUnitPositions.length-1){const dt=U.threeUnitPositions[n.slotIndex],at=U.threeUnitPositions[n.slotIndex+1];return(dt+at)/2}else return U.threeUnitPositions[n.slotIndex];return n.position.x})(),je,De+.02],rotation:[0,n.rotation*Math.PI/180,0],children:[console.log("🚪🚪 커버도어 렌더링 중:",{원래슬롯중심:n.position.x,가구위치:Y.x,도어X위치:(()=>{var dt,at,Ot;if(W){const Rn=(be-fe)/2,xn=n.slotIndex===0&&(t.installType==="freestanding"||t.installType==="semistanding"&&((dt=t.wallConfig)==null?void 0:dt.right));let En=!1;if((at=t.droppedCeiling)!=null&&at.enabled&&U.zones){const Ti=(n.zone||"normal")==="dropped"&&U.zones.dropped?U.zones.dropped:U.zones.normal;En=ie?n.slotIndex+2>=Ti.columnCount:n.slotIndex===Ti.columnCount-1}else En=ie?n.slotIndex+2>=U.columnCount:n.slotIndex===U.columnCount-1;const Hn=En&&(t.installType==="freestanding"||t.installType==="semistanding"&&((Ot=t.wallConfig)==null?void 0:Ot.left));if(xn)return n.position.x-X(Rn);if(Hn)return n.position.x+X(Rn)}return n.position.x})(),너비:be,가구너비:fe,차이:be-fe,노서라운드엔드슬롯:W,슬롯인덱스:n.slotIndex}),l.jsx(dh,{moduleWidth:be,moduleDepth:ne,hingePosition:Re,spaceInfo:K,color:Ge,doorXOffset:0,originalSlotWidth:be,slotCenterX:0,moduleData:G,slotIndex:n.slotIndex,isDragging:o,isEditMode:s,slotWidths:(()=>{var dt;if(ie){if(n.zone&&((dt=t.droppedCeiling)!=null&&dt.enabled)){const at=wr.calculateZoneSlotInfo(t,t.customColumnCount),Ot=n.zone==="dropped"&&at.dropped?at.dropped:at.normal;if(Ot.slotWidths&&n.slotIndex<Ot.slotWidths.length-1)return[Ot.slotWidths[n.slotIndex],Ot.slotWidths[n.slotIndex+1]]}else if(U.slotWidths&&n.slotIndex<U.slotWidths.length-1)return[U.slotWidths[n.slotIndex],U.slotWidths[n.slotIndex+1]]}})()})]}),!p&&T&&a==="3D"&&l.jsx(Y0,{position:[Y.x+_e,(()=>{if((G==null?void 0:G.category)==="upper"){const dt=(G==null?void 0:G.dimensions.height)||800;return i+X(V.height-dt)-2.5}return i-1.8})(),De+he/2+.5],center:!0,style:{userSelect:"none",pointerEvents:"auto",zIndex:100,background:"transparent"},children:l.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px"},children:l.jsx("div",{style:{cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",width:"32px",height:"32px",border:`2px solid ${E()}`,borderRadius:"50%",backgroundColor:"#ffffff",transition:"all 0.2s ease",opacity:_?1:.8,transform:_?"scale(1.1)":"scale(1)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},onClick:dt=>{if(dt.stopPropagation(),s){const at=Bi.getState().closeAllPopups;at()}else A(dt,n.id)},onPointerDown:dt=>dt.stopPropagation(),onMouseEnter:()=>I(!0),onMouseLeave:()=>I(!1),title:"가구 속성 편집",children:l.jsx(Ty,{color:E(),size:18})})})})]})},j1=n=>n*.01,Hhe=.11,Whe=({placedModules:n,spaceInfo:e})=>{var o;const t=O.useMemo(()=>kr(e),[e]),{renderMode:i}=Qi(),r=O.useMemo(()=>{const a={};n.forEach(h=>{const u=Hi(h.moduleId,t,e);if(!u)return;const d=u.category==="upper"||h.moduleId.includes("upper-cabinet"),f=u.category==="lower"||h.moduleId.includes("lower-cabinet");if(!d&&!f)return;const A=h.slotIndex??-1;A<0||(a[A]||(a[A]={}),d?(a[A].upper=h,h.hasGapBackPanel&&(a[A].hasPanel=!0)):f&&(a[A].lower=h,h.hasGapBackPanel&&(a[A].hasPanel=!0)))});const c=[];return Object.entries(a).forEach(([h,u])=>{var d;if(u.upper&&u.lower&&u.hasPanel){const f=parseInt(h),A=Hi(u.upper.moduleId,t,e),g=Hi(u.lower.moduleId,t,e);if(!A||!g)return;const p=A.dimensions.height,y=g.dimensions.height,v=e.hasFloorFinish&&e.floorFinish?e.floorFinish.height:0,m=((d=e.baseConfig)==null?void 0:d.height)||0;let w;if(!e.baseConfig||e.baseConfig.type==="floor")w=v+m;else if(e.baseConfig.type==="stand")if(e.baseConfig.placementType==="float"){const D=e.baseConfig.floatHeight||0;w=v+D}else w=v;else w=0;const x=w+y+18,j=w+t.height-p-18-x;if(j>0){const D=u.upper.adjustedWidth||u.upper.customWidth||A.dimensions.width,b=u.upper.customDepth||A.dimensions.depth;c.push({slotIndex:f,x:u.upper.position.x,y:j1(x+j/2+9),z:u.upper.position.z,width:j1(D),height:j1(j+18),depth:j1(18),furnitureDepth:j1(b)})}}}),c},[n,e,t]),s=((o=e.materialConfig)==null?void 0:o.doorColor)||"#E0E0E0";return l.jsx(l.Fragment,{children:r.map((a,c)=>l.jsx(FI,{width:a.width,height:a.height,depth:a.depth,position:[a.x,a.y,a.z-a.furnitureDepth-Hhe],spaceInfo:e,doorColor:s,renderMode:i},`back-panel-${a.slotIndex}-${c}`))})},ex=({width:n,depth:e,intensity:t,position:i})=>{const{viewMode:r}=Qi(),[s,o]=O.useState(null),[a,c]=O.useState(!1);return r==="2D"?(console.log("🚫 2D 모드라서 간접조명 렌더링 안함"),null):(O.useEffect(()=>{console.log("🔍 IndirectLight 컴포넌트 마운트됨",{width:n,depth:e,intensity:t,position:i});const h=new Image;return h.onload=()=>{console.log("✅ 이미지 로드 성공 (HTML Image):",h.width,"x",h.height),new xg().load("/images/lighting/light3000k.png",f=>{console.log("✅ Three.js 텍스처 로드 성공"),f.wrapS=fm,f.wrapT=fm,f.repeat.set(1,1),f.needsUpdate=!0,o(f)},f=>{console.log("⏳ 텍스처 로딩 중...",f)},f=>{console.error("❌ Three.js 텍스처 로드 실패:",f),c(!0)})},h.onerror=u=>{console.error("❌ HTML 이미지 로드 실패:",u),c(!0)},h.src="/images/lighting/light3000k.png",()=>{s&&s.dispose()}},[]),console.log("🎨 IndirectLight 렌더링 위치:",{hasTexture:!!s,loadError:a,width:n,depth:e,intensity:t,position:i,y위치:i[1]}),s?l.jsx("group",{position:i,children:l.jsxs("mesh",{rotation:[Math.PI,0,0],renderOrder:-1,frustumCulled:!1,children:[l.jsx("planeGeometry",{args:[n,e]}),l.jsx("meshBasicMaterial",{map:s,color:new Yr(1,.6,.2),transparent:!0,opacity:t*.5,side:Go,depthWrite:!1,depthTest:!0,blending:XY})]})}):null)},YA=n=>n*.01,Xj=({placedModules:n,spaceInfo:e})=>{const t=O.useMemo(()=>kr(e),[e]),{viewMode:i}=Qi(),{indirectLightEnabled:r,indirectLightIntensity:s}=Bi(),o=(u,d,f)=>{if(u.length===0)return[];const A=[...u].sort((y,v)=>{const m=y.slotIndex??-1,w=v.slotIndex??-1;return m-w}),g=[];let p=null;return A.forEach(y=>{const v=Hi(y.moduleId,t,e);if(!v)return;const m=y.adjustedWidth||y.customWidth||v.dimensions.width,w=y.customDepth||v.dimensions.depth;(y.moduleId.includes("tall")||y.moduleId.includes("pantry")||y.moduleId.includes("wardrobe"))&&console.log("🔦 키큰장 폭 계산:",{moduleId:y.moduleId,adjustedWidth:y.adjustedWidth,customWidth:y.customWidth,dimensionsWidth:v.dimensions.width,finalWidth:m});const x=YA(m/2),T=y.position.x-x,j=y.position.x+x,D=YA(w);!p||Math.abs(p.endX-T)>.01?(p={startX:T,endX:j,y:d,z:y.position.z,depth:D,height:f},g.push(p)):p.endX=j}),g},{upperCabinetGroups:a,floatingGroups:c}=O.useMemo(()=>{var v,m,w,x,T;const u=((v=e==null?void 0:e.baseConfig)==null?void 0:v.placementType)==="float"&&(((m=e==null?void 0:e.baseConfig)==null?void 0:m.floatHeight)||0)>0,d=((w=e==null?void 0:e.baseConfig)==null?void 0:w.floatHeight)||0,f=n.filter(j=>{const D=Hi(j.moduleId,t,e);return D&&(D.category==="upper"||j.moduleId.includes("upper-cabinet"))}),A=u?n.filter(j=>{const D=Hi(j.moduleId,t,e);return D&&!(D.category==="upper"||j.moduleId.includes("upper-cabinet"))}):[],g=f.map(j=>{const D=Hi(j.moduleId,t,e),b=j.customHeight||D.dimensions.height,_=820,I=t.height-b,F=_+(u?d:0),B=I-F,E=YA(B)*2,V=YA(F+B*.8);return{cabinet:j,lightY:V,lightHeight:E}}),p=g.length>0?o(g.map(j=>j.cabinet),((x=g[0])==null?void 0:x.lightY)||0,((T=g[0])==null?void 0:T.lightHeight)||0):[];console.log("🔦 띄움 배치 조명 생성:",{isFloatingMode:u,floatHeight:d,floatHeightInThreeUnits:YA(d),lightY:YA(d/2),floatingModulesCount:A.length});const y=u&&A.length>0?o(A,YA(d/2),YA(d)*2):[];return{upperCabinetGroups:p,floatingGroups:y}},[n,e,t]);return i==="2D"||i!=="3D"||!r?null:l.jsxs(l.Fragment,{children:[a.map((u,d)=>{const A=(u.endX-u.startX)*1.2,g=(u.startX+u.endX)/2;return l.jsxs(ii.Fragment,{children:[l.jsx(ex,{width:A,depth:u.height,intensity:s||.8,position:[g,u.y,u.z-u.depth/2-2.5]}),l.jsx(ex,{width:A,depth:u.height,intensity:s||.8,position:[g,u.y,u.z+u.depth/2-3]})]},`upper-cabinet-light-${d}`)}),c.map((u,d)=>{const f=u.endX-u.startX,A=f*1.2,g=(u.startX+u.endX)/2;return console.log("🔦 띄워서 배치 조명 상세:",{baseWidth:f,width:A,height:u.height,heightInMM:u.height/.01,y:u.y,z:u.z,depth:u.depth}),l.jsxs(ii.Fragment,{children:[l.jsx(ex,{width:A,depth:u.height,intensity:s||.8,position:[g,u.y,u.z-u.depth/2-2.5]}),l.jsx(ex,{width:A,depth:u.height,intensity:s||.8,position:[g,u.y,u.z+u.depth/2-3]})]},`floating-light-${d}`)})]})},Kj=({viewMode:n,view2DDirection:e,renderMode:t,placedModules:i,activeZone:r,showFurniture:s=!0,isReadOnly:o=!1})=>{var x,T,j;const{spaceInfo:a}=qi();ii.useEffect(()=>{var D,b;console.log("🎯 PlacedFurnitureContainer - spaceInfo 변경:",{baseConfig:a==null?void 0:a.baseConfig,placementType:(D=a==null?void 0:a.baseConfig)==null?void 0:D.placementType,floatHeight:(b=a==null?void 0:a.baseConfig)==null?void 0:b.floatHeight})},[(x=a==null?void 0:a.baseConfig)==null?void 0:x.placementType,(T=a==null?void 0:a.baseConfig)==null?void 0:T.floatHeight]);const c=ci(D=>D.placedModules),h=i||c,{activePopup:u}=Bi();ii.useEffect(()=>{console.log("🎯 PlacedFurnitureContainer - activeZone 변경:",{activeZone:r,placedModulesCount:h.length,placedModules:h.map(D=>({id:D.id,moduleId:D.moduleId,zone:D.zone,customWidth:D.customWidth,isDualSlot:D.isDualSlot}))})},[r]),ii.useEffect(()=>{console.log("📦📦📦 PlacedFurnitureContainer - placedModules 변경:",{count:h.length,modules:h.map(D=>({id:D.id,moduleId:D.moduleId,position:D.position,slotIndex:D.slotIndex,zone:D.zone}))})},[h]);const d=D=>D*.01,f=a.hasFloorFinish&&a.floorFinish?a.floorFinish.height:0,A=((j=a.baseConfig)==null?void 0:j.height)||0;let g;if(!a.baseConfig||a.baseConfig.type==="floor")g=d(A);else if(a.baseConfig.type==="stand")if(a.baseConfig.placementType==="float"){const D=a.baseConfig.floatHeight||0;g=d(D),console.log("🔥 띄워서 배치 Y 위치 계산:",{placementType:a.baseConfig.placementType,floatHeightMm:D,furnitureStartY:g})}else g=0;else g=0;console.log("📍📍📍 PlacedFurnitureContainer - furnitureStartY 계산:",{baseConfig:a.baseConfig,floorFinishHeightMm:f,baseFrameHeightMm:A,furnitureStartY:g,furnitureStartY_mm:g/.01,설명:"하부장 시작 Y 위치"});const p=!!i;console.log("🎮 PlacedFurnitureContainer 모드:",{isViewerOnly:p,propPlacedModules:!!i,propPlacedModulesLength:i==null?void 0:i.length});const y=tce(),v=ece({spaceInfo:a});nce({spaceInfo:a});const m=p?{dragMode:!1,handleFurnitureClick:()=>{}}:y,w=p?{handlePointerDown:()=>{},handlePointerMove:()=>{},handlePointerUp:()=>{},draggingModuleId:null}:v;return l.jsxs("group",{children:[a&&l.jsx(Xj,{placedModules:h,spaceInfo:a}),a&&l.jsx(Whe,{placedModules:h,spaceInfo:a}),n==="3D"&&a&&l.jsx(Xj,{placedModules:h,spaceInfo:a}),h.map(D=>{var S,F,B;const b=m.dragMode,_=u.type==="furnitureEdit"&&u.id===D.id,I=w.draggingModuleId===D.id;return l.jsx(Uhe,{placedModule:D,placedModules:h,spaceInfo:a,furnitureStartY:g,isDragMode:b,isEditMode:_,isDraggingThis:I,viewMode:n,view2DDirection:e,renderMode:t,onPointerDown:w.handlePointerDown,onPointerMove:w.handlePointerMove,onPointerUp:w.handlePointerUp,onDoubleClick:m.handleFurnitureClick,showFurniture:s,isReadOnly:o},`${D.id}-${((S=a.columns)==null?void 0:S.map(E=>`${E.id}-${E.position[0]}`).join("-"))||"no-columns"}-${((F=a.baseConfig)==null?void 0:F.placementType)||"ground"}-${((B=a.baseConfig)==null?void 0:B.floatHeight)||0}-${D._lastYUpdate||0}`)})]})},Yt=n=>n*.01,Wi=18,bp=n=>20,xl=({args:n,position:e,material:t,renderMode:i,onBeforeRender:r,viewMode:s,view2DTheme:o,isEndPanel:a=!1})=>{const c=O.useMemo(()=>new rh(...n),[n[0],n[1],n[2]]),h=O.useMemo(()=>new zO(c),[c]),{viewMode:u}=Qi(),d=s||u,{theme:f}=Yh(),{view2DTheme:A}=Bi(),g=o||A||"light";return O.useEffect(()=>()=>{c.dispose(),h.dispose()},[c,h]),l.jsxs("group",{position:e,children:[i==="solid"&&l.jsx("mesh",{geometry:c,receiveShadow:d==="3D",castShadow:d==="3D",onBeforeRender:r,children:l.jsx("primitive",{object:t})}),l.jsx("lineSegments",{geometry:h,children:l.jsx("lineBasicMaterial",{color:d==="3D"?"#505050":d==="2D"&&a?"#00FF00":i==="wireframe"?g==="dark"?"#FFFFFF":"#000000":g==="dark"?"#FFFFFF":"#666666",linewidth:d==="2D"&&g==="dark"?1.5:.5,opacity:d==="3D"?.9:1,transparent:d==="3D"})})]})},Qhe=({spaceInfo:n,floorColor:e="#B89B87",viewMode:t="3D",view2DDirection:i,materialConfig:r,showAll:s=!0,showFurniture:o=!0,showFrame:a=!0,placedModules:c,showDimensions:h,isStep2:u,renderMode:d,activeZone:f,isReadOnly:A=!1})=>{var jt,Wt,Mt,dn,on,Et,an,Mn;const g=ii.useRef(`room-${Date.now()}-${Math.random()}`).current;if(!n||typeof n.width!="number"||typeof n.height!="number")return null;const{theme:p}=Yh(),y=ci(At=>At.placedModules),v=c||y;console.log("🔵 Room Component - Placed Modules:",{placedModules:c,placedModulesFromStore:y,actualPlacedModules:v});const{colors:m}=fI(),{renderMode:w}=Qi(),x=d||w,{highlightedFrame:T,activeDroppedCeilingTab:j,view2DTheme:D}=Bi();O.useMemo(()=>new VO({color:e,transparent:!0,opacity:.85,side:Go,depthWrite:!1}),[e]);const b=O.useMemo(()=>{var Cn;console.log("🔍 Room Component - spaceInfo:",{roomId:g,surroundType:n.surroundType,installType:n.installType,frameSize:n.frameSize,showFrame:a,"showFrame prop value":a,timestamp:new Date().toISOString()});const{width:At,height:zt}=xQ(n),Zt=bQ(n),$t=foe(n),Ht=poe(c),Lt=oa(n);console.log("🔥 calculateDimensionsAndFrames 내부 - frameThicknessMm 계산 직후:",{frameThicknessMm:Lt,wallConfig:n.wallConfig,installType:n.installType,surroundType:n.surroundType});const dt=goe(n),at=_Q(n),Ot=L0(n);return console.log("🔍 Room - 프레임 계산 결과:",{surroundType:n.surroundType,installType:n.installType,wallConfig:n.wallConfig,frameThicknessMm:Lt,topBottomFrameHeightMm:at,baseFrameHeightMm:Ot,baseFrameMm:dt,isNoSurround:n.surroundType==="no-surround",isBuiltin:n.installType==="builtin"||n.installType==="built-in",isSemistanding:n.installType==="semistanding"||n.installType==="semi-standing",shouldHideAllFrames:n.surroundType==="no-surround","예상 프레임":n.surroundType==="no-surround"&&(n.installType==="semistanding"||n.installType==="semi-standing")?(Cn=n.wallConfig)!=null&&Cn.left?"좌측: 0mm (벽있음), 우측: 18mm (엔드패널)":"좌측: 18mm (엔드패널), 우측: 0mm (벽있음)":"서라운드 또는 다른 타입"}),console.log("🔥 calculateDimensionsAndFrames - 변환 직전:",{"frameThicknessMm.left":Lt.left,"frameThicknessMm.right":Lt.right,"mmToThreeUnits(frameThicknessMm.left)":Yt(Lt.left),"mmToThreeUnits(frameThicknessMm.right)":Yt(Lt.right)}),{width:Yt(At),height:Yt(zt),panelDepth:Yt($t),furnitureDepth:Yt(Ht),floorFinishHeight:Yt(Zt),frameThickness:{left:Yt(Lt.left),right:Yt(Lt.right)},baseFrame:{width:Yt(dt.width)},topBottomFrameHeight:Yt(at),baseFrameHeight:Yt(Ot),widthMm:At,heightMm:zt,panelDepthMm:$t,furnitureDepthMm:Ht,floorFinishHeightMm:Zt,frameThicknessMm:Lt,baseFrameMm:dt,topBottomFrameHeightMm:at,baseFrameHeightMm:Ot}},[n.width,n.height,n.depth,n.installType,n.surroundType,n.baseConfig,n.floorFinish,n.frameSize,n.wallConfig,c]),{width:_,height:I,panelDepth:S,furnitureDepth:F,floorFinishHeight:B,frameThickness:E,baseFrame:V,topBottomFrameHeight:K,baseFrameHeight:P,widthMm:M,heightMm:X,panelDepthMm:Z,furnitureDepthMm:Q,floorFinishHeightMm:U,frameThicknessMm:z,baseFrameMm:q,topBottomFrameHeightMm:G,baseFrameHeightMm:ie}=b;console.log("🎯 Room - dimensions 디버깅:",{frameThicknessMm:z,frameThickness:E,wallConfig:n.wallConfig,installType:n.installType,surroundType:n.surroundType,계산된_엔드패널:{좌측mm:z.left,우측mm:z.right,좌측Three:E.left,우측Three:E.right}}),O.useMemo(()=>{var Rn,xn;const At=n.columns||[],zt=At.some(En=>En.depth>=730);if(At.length===0||!zt)return null;let Zt,$t;if(n.surroundType==="no-surround"){const En=ur(n),{threeUnitBoundaries:Hn}=En,Kn=Hn[0],Ti=Hn[Hn.length-1],ti=Yt(Wi);let ai=Kn,Gi=Ti;n.installType==="freestanding"?(ai=Kn+ti,Gi=Ti-ti):(n.installType==="semistanding"||n.installType==="semi-standing")&&((Rn=n.wallConfig)!=null&&Rn.left?Gi=Ti-ti:(xn=n.wallConfig)!=null&&xn.right&&(ai=Kn+ti)),Zt=Gi-ai,$t=(ai+Gi)/2}else Zt=V.width,$t=-_/2+E.left+Zt/2;const Ht=[],Lt=$t-Zt/2,dt=$t+Zt/2,at=[...At].sort((En,Hn)=>En.position[0]-Hn.position[0]);let Ot=Lt;at.forEach(En=>{const Hn=En.width*.01,Kn=En.position[0]-Hn/2,Ti=En.position[0]+Hn/2;if(Kn<dt&&Ti>Lt&&En.depth>=730){const ti=Math.max(0,Kn-Ot);ti>0&&Ht.push({width:ti,x:Ot+ti/2}),Ot=Ti}});const Cn=Math.max(0,dt-Ot);return Cn>0&&Ht.push({width:Cn,x:Ot+Cn/2}),Ht.length>0?Ht:null},[n.columns,n.surroundType,n.width,(jt=n.gapConfig)==null?void 0:jt.left,(Wt=n.gapConfig)==null?void 0:Wt.right,V.width,E.left,_]);const H=O.useCallback(At=>{const zt=t==="2D"&&D==="dark"?"#F0F0F0":"#E0E0E0",Zt=(r==null?void 0:r.doorColor)||zt;let $t=!1;t==="2D"&&At==="base"&&($t=!0);const Ht=At&&T===At;console.log(`🎨 Creating frame material for ${At}:`,{frameType:At,frameColor:Zt,doorTexture:r==null?void 0:r.doorTexture,isHighlighted:Ht,viewMode:t,view2DTheme:D});const Lt=x==="wireframe"?"#FFFF00":"#FF0000",dt=x==="wireframe"?4473856:2228224,at=.6,Ot=new oo({color:new Yr(Ht?Lt:Zt),metalness:0,roughness:.6,envMapIntensity:0,emissive:new Yr(Ht?dt:0),emissiveIntensity:Ht?1:0,transparent:x==="wireframe"||t==="2D"&&x==="solid"||Ht||$t,opacity:$t?0:x==="wireframe"?Ht?at:0:t==="2D"&&x==="solid"?.8:Ht?.6:1});return!Ht&&(r!=null&&r.doorTexture)&&(gd(r.doorTexture)&&(console.log("🔧 프레임 Cabinet Texture1 즉시 어둡게 적용 중..."),Sm(Ot),console.log("✅ 프레임 Cabinet Texture1 즉시 색상 적용 완료 (공통 설정 사용)")),new xg().load(r.doorTexture,Rn=>{console.log("🔧 프레임 텍스처 로딩 성공:",r.doorTexture),Rn.wrapS=Gh,Rn.wrapT=Gh,Rn.repeat.set(1,1),Ot.map=Rn,gd(r.doorTexture)||(Ot.color.setHex(16777215),Ot.toneMapped=!0,Ot.roughness=.6),Ot.needsUpdate=!0},void 0,Rn=>{console.error("❌ 프레임 텍스처 로딩 실패:",r.doorTexture,Rn)})),Ot},[r==null?void 0:r.doorColor,r==null?void 0:r.doorTexture,x,t,D,T,n.frameSize,n.baseConfig]),se=JSON.stringify(n.columns??[]),[te,fe]=O.useState(),[ye,be]=O.useState(),[_e,W]=O.useState(),[Y,ve]=O.useState(),[ce,ne]=O.useState(),[he,xe]=O.useState(),[Te,Ce]=O.useState();O.useEffect(()=>{const At=H("base");return fe(At),()=>At.dispose()},[H,se,t,r==null?void 0:r.doorColor,r==null?void 0:r.doorTexture,T]),O.useEffect(()=>{const At=H("left");return be(At),()=>At.dispose()},[H,se,t,r==null?void 0:r.doorColor,r==null?void 0:r.doorTexture,T]),O.useEffect(()=>{const At=H("left");return W(At),()=>At.dispose()},[H,se,t,r==null?void 0:r.doorColor,r==null?void 0:r.doorTexture,T]),O.useEffect(()=>{const At=H("right");return ve(At),()=>At.dispose()},[H,se,t,r==null?void 0:r.doorColor,r==null?void 0:r.doorTexture,T]),O.useEffect(()=>{const At=H("right");return ne(At),()=>At.dispose()},[H,se,t,r==null?void 0:r.doorColor,r==null?void 0:r.doorTexture,T]),O.useEffect(()=>{const At=H("top");return xe(At),()=>At.dispose()},[H,se,t,r==null?void 0:r.doorColor,r==null?void 0:r.doorTexture,T]),O.useEffect(()=>{const At=H("top");return Ce(At),()=>At.dispose()},[H,se,t,r==null?void 0:r.doorColor,r==null?void 0:r.doorTexture,T]),O.useMemo(()=>$o.createWallMaterial(),[]),O.useMemo(()=>$o.createWallMaterial(),[]),O.useMemo(()=>$o.createWallMaterial(),[]);const Be=-_/2,Ye=-S/2,$e=Ye+(S-F)/2,ot=0,rt=Yt(1200),Ve=S+rt,We=Ye,De=V.width,Ge=V.width,Re=n.surroundType==="no-surround"?0:Be+E.left+De/2,Ie=n.hasFloorFinish&&B>0?B:0,Le=((Mt=n.baseConfig)==null?void 0:Mt.type)==="stand"&&((dn=n.baseConfig)==null?void 0:dn.placementType)==="float"?Yt(n.baseConfig.floatHeight||0):0,et=I-Le,ct=Ie+I-K/2,je=Ie+Le+et/2,{wallConfig:le={left:!0,right:!0}}=n;console.log("🏠 Room - 노서라운드 프레임 체크:",{installType:n.installType,surroundType:n.surroundType,isNoSurround:n.surroundType==="no-surround",isBuiltin:n.installType==="builtin",isSemistanding:n.installType==="semistanding",wallConfig:le,frameThicknessMm:z,frameThickness:E,leftPanel:E.left>0?`${z.left}mm`:"none",rightPanel:E.right>0?`${z.right}mm`:"none",shouldHaveEndPanelLeft:n.surroundType==="no-surround"&&n.installType==="semistanding"&&!(le!=null&&le.left),shouldHaveEndPanelRight:n.surroundType==="no-surround"&&n.installType==="semistanding"&&!(le!=null&&le.right)});const Je=kr(n),ht=-Yt(Je.depth/2),ft=$e+F/2-ht;return(n.installType==="freestanding"||n.installType==="semistanding"&&(!(le!=null&&le.left)||!(le!=null&&le.right)))&&console.log("🔍 엔드패널 깊이 비교:",{서라운드_깊이mm:ft/.01,노서라운드_깊이mm:(ft-Yt(Wi))/.01,차이mm:Wi,slotFloorDepth:ft,노서라운드깊이:ft-Yt(20)}),l.jsxs("group",{position:[0,0,ot],children:[console.log("🔍 Room viewMode 체크:",t,typeof t),t!=="2D"&&l.jsxs(l.Fragment,{children:[console.log("🔍 왼쪽 벽 installType 체크:",{installType:n.installType,wallConfig:le,wallConfigLeft:le==null?void 0:le.left,condition:n.installType==="builtin"||n.installType==="built-in"||n.installType==="semistanding"&&(le==null?void 0:le.left)}),(n.installType==="builtin"||n.installType==="built-in"||n.installType==="semistanding"&&(le==null?void 0:le.left))&&(()=>{var Ht,Lt;const At=(Ht=n.droppedCeiling)==null?void 0:Ht.enabled,zt=((Lt=n.droppedCeiling)==null?void 0:Lt.position)==="left",Zt=At&&n.droppedCeiling?n.droppedCeiling.dropHeight||200:0,$t=Yt(Zt);if(console.log("🔍 왼쪽 벽 단내림 조건 체크:",{"spaceInfo.droppedCeiling":n.droppedCeiling,hasDroppedCeiling:At,isLeftDropped:zt,dropHeight:Zt,condition:At&&zt,"spaceInfo.height":n.height,"droppedHeight(mm)":n.height-Zt,"height(Three.js)":I/.01,"droppedHeight(Three.js)":(n.height-Zt)*.01}),At&&zt){const dt=I-$t,at=Ie+dt/2;return console.log("🔴 왼쪽 단내림 벽 렌더링:",{"전체 높이":I/.01,"단내림 높이차":$t/.01,"단내림 벽 높이":dt/.01,panelStartY:Ie,droppedCenterY:at}),l.jsxs("mesh",{position:[-_/2-.001,at,We+Ve/2],rotation:[0,Math.PI/2,0],children:[l.jsx("planeGeometry",{args:[Ve,dt]}),l.jsx("primitive",{object:$o.createShaderGradientWallMaterial("horizontal")})]})}return!At||!zt?l.jsxs("mesh",{position:[-_/2-.001,Ie+I/2,We+Ve/2],rotation:[0,Math.PI/2,0],children:[l.jsx("planeGeometry",{args:[Ve,I]}),l.jsx("primitive",{object:$o.createShaderGradientWallMaterial("horizontal")})]}):null})(),(n.installType==="builtin"||n.installType==="built-in"||n.installType==="semistanding"&&(le==null?void 0:le.right))&&(()=>{var Ht,Lt;const At=(Ht=n.droppedCeiling)==null?void 0:Ht.enabled,zt=((Lt=n.droppedCeiling)==null?void 0:Lt.position)==="right",Zt=At&&n.droppedCeiling?n.droppedCeiling.dropHeight||200:0,$t=Yt(Zt);if(console.log("🔍 오른쪽 벽 단내림 조건 체크:",{"spaceInfo.droppedCeiling":n.droppedCeiling,hasDroppedCeiling:At,isRightDropped:zt,dropHeight:Zt,condition:At&&zt,viewMode:t,"벽 렌더링 조건":t==="3D"||t==="3d"}),At&&zt){const dt=I-$t,at=Ie+dt/2;return console.log("🔵 오른쪽 단내림 벽 렌더링:",{"전체 높이":I/.01,"단내림 높이차":$t/.01,"단내림 벽 높이":dt/.01,panelStartY:Ie,droppedCenterY:at}),l.jsxs("mesh",{position:[_/2+.001,at,We+Ve/2],rotation:[0,-Math.PI/2,0],children:[l.jsx("planeGeometry",{args:[Ve,dt]}),l.jsx("primitive",{object:$o.createShaderGradientWallMaterial("horizontal-reverse")})]})}return!At||!zt?l.jsxs("mesh",{position:[_/2+.001,Ie+I/2,We+Ve/2],rotation:[0,-Math.PI/2,0],children:[l.jsx("planeGeometry",{args:[Ve,I]}),l.jsx("primitive",{object:$o.createShaderGradientWallMaterial("horizontal-reverse")})]}):null})(),t!=="2D"&&(()=>{var xn,En,Hn;const At=(xn=n.droppedCeiling)==null?void 0:xn.enabled,zt=At&&n.droppedCeiling?Yt(n.droppedCeiling.width||DEFAULT_DROPPED_CEILING_VALUES.WIDTH):0,Zt=((En=n.droppedCeiling)==null?void 0:En.position)==="left",$t=At&&n.droppedCeiling?n.droppedCeiling.dropHeight||200:0,Ht=Yt($t);if(!At)return l.jsxs("mesh",{position:[Be+_/2,Ie+I+.001,We+Ve/2],rotation:[Math.PI/2,0,0],children:[l.jsx("planeGeometry",{args:[_,Ve]}),l.jsx("primitive",{object:$o.createShaderGradientWallMaterial("vertical-reverse")})]});let Lt=0,dt=0;if(n.surroundType==="surround"){const Kn=oa(n);Lt=Kn.left,dt=Kn.right}else n.installType==="builtin"?(Lt=2,dt=2):n.installType==="semistanding"?(Hn=n.wallConfig)!=null&&Hn.left?(Lt=2,dt=Wi):(Lt=Wi,dt=2):(Lt=20,dt=20);let at,Ot;Zt?(at=zt,Ot=_-zt):(Ot=_-zt,at=zt);const Cn=Zt?Be+at/2:Be+Ot+at/2,Rn=Zt?Be+at+Ot/2:Be+Ot/2;return console.log("🔥 천장 분할 계산:",{hasDroppedCeiling:At,surroundType:n.surroundType,installType:n.installType,wallConfig:n.wallConfig,leftReduction:Lt,rightReduction:dt,droppedWidth:zt/.01,droppedAreaWidth:at/.01,normalAreaWidth:Ot/.01,droppedAreaX:Cn,normalAreaX:Rn,droppedCeilingHeight:Ht/.01,totalWidth:_/.01,calculatedTotal:(at+Ot+Yt(Lt)+Yt(dt))/.01}),l.jsxs(l.Fragment,{children:[l.jsxs("mesh",{position:[Cn,Ie+I-Ht+.001,We+Ve/2],rotation:[Math.PI/2,0,0],children:[l.jsx("planeGeometry",{args:[at,Ve]}),l.jsx("primitive",{object:$o.createShaderGradientWallMaterial("vertical-reverse")})]}),l.jsxs("mesh",{position:[Rn,Ie+I+.001,We+Ve/2],rotation:[Math.PI/2,0,0],children:[l.jsx("planeGeometry",{args:[Ot,Ve]}),l.jsx("primitive",{object:$o.createShaderGradientWallMaterial("vertical-reverse")})]})]})})(),t!=="2D"&&l.jsxs("mesh",{position:[Be+_/2,Ie-.001,We+Ve/2],rotation:[-Math.PI/2,0,0],children:[l.jsx("planeGeometry",{args:[_,Ve]}),l.jsx("primitive",{object:$o.createShaderGradientWallMaterial("vertical")})]}),[],console.log("🔍 백패널 렌더링 조건:",{viewMode:t,view2DDirection:i,is2DFront:t==="2D"&&i==="front",position:[Be+_/2,Ie+I/2,Ye-.01]}),l.jsxs("mesh",{position:[Be+_/2,Ie+I/2,We+Ve/2],children:[l.jsx("planeGeometry",{args:[_,Ve]}),l.jsx("meshStandardMaterial",{color:"#ffffff",transparent:!0,opacity:0,side:Go})]}),l.jsxs("mesh",{position:[-_/2,Ie+I/2,Ye+S/2],rotation:[0,0,0],children:[l.jsx("planeGeometry",{args:[.02,I]}),l.jsx("primitive",{object:$o.createEdgeShadowMaterial()})]}),l.jsxs("mesh",{position:[_/2,Ie+I/2,Ye+S/2],rotation:[0,0,0],children:[l.jsx("planeGeometry",{args:[.02,I]}),l.jsx("primitive",{object:$o.createEdgeShadowMaterial()})]}),l.jsxs("mesh",{position:[Be+_/2,Ie+I,Ye+S/2],rotation:[0,0,Math.PI/2],children:[l.jsx("planeGeometry",{args:[.02,_]}),l.jsx("primitive",{object:$o.createEdgeShadowMaterial()})]}),l.jsxs("mesh",{position:[Be+_/2,Ie,Ye+S/2],rotation:[0,0,Math.PI/2],children:[l.jsx("planeGeometry",{args:[.02,_]}),l.jsx("primitive",{object:$o.createEdgeShadowMaterial()})]}),l.jsxs("mesh",{position:[-_/2,Ie+I,We+Ve/2],rotation:[Math.PI/2,0,0],children:[l.jsx("planeGeometry",{args:[.02,Ve]}),l.jsx("primitive",{object:$o.createEdgeShadowMaterial()})]}),l.jsxs("mesh",{position:[_/2,Ie+I,We+Ve/2],rotation:[Math.PI/2,0,0],children:[l.jsx("planeGeometry",{args:[.02,Ve]}),l.jsx("primitive",{object:$o.createEdgeShadowMaterial()})]}),l.jsxs("mesh",{position:[-_/2,Ie,We+Ve/2],rotation:[Math.PI/2,0,0],children:[l.jsx("planeGeometry",{args:[.02,Ve]}),l.jsx("primitive",{object:$o.createEdgeShadowMaterial()})]}),l.jsxs("mesh",{position:[_/2,Ie,We+Ve/2],rotation:[Math.PI/2,0,0],children:[l.jsx("planeGeometry",{args:[.02,Ve]}),l.jsx("primitive",{object:$o.createEdgeShadowMaterial()})]}),((on=n.droppedCeiling)==null?void 0:on.enabled)&&(()=>{const At=n.droppedCeiling.position==="left",zt=Yt(n.droppedCeiling.dropHeight||200),Zt=wr.calculateZoneSlotInfo(n,n.customColumnCount);return l.jsxs("mesh",{position:[Yt(At?Zt.normal.startX:Zt.dropped.startX),Ie+I-zt/2,We+Ve/2],rotation:[0,Math.PI/2,0],children:[l.jsx("planeGeometry",{args:[Ve,zt]}),l.jsx("primitive",{object:$o.createShaderGradientWallMaterial("horizontal")})]})})()]}),n.hasFloorFinish&&B>0&&!(t==="2D"&&i==="top")&&l.jsx(xl,{args:[_,B,S],position:[Be+_/2,B/2,0],material:new oo({color:e,transparent:!1,side:Go,roughness:.8,metalness:.1,depthWrite:!0,polygonOffset:!0,polygonOffsetFactor:-1,polygonOffsetUnits:-1}),renderMode:x}),s&&!(t==="2D"&&i==="front")&&(()=>{var Fn,pt;const At=kr(n),zt=vt=>vt*.01,$t=-zt(At.depth/2),Ht=wr.calculateZoneSlotInfo(n,n.customColumnCount),Lt=zt(Ht.normal.startX),dt=zt(Ht.normal.startX+Ht.normal.width),at=dt-Lt,Ot=(Lt+dt)/2,Cn=F,Rn=$e,En=$e+F/2-$t-zt(Wi),Hn=n.columns||[],Kn=zt(At.startY)+(((Fn=n.baseConfig)==null?void 0:Fn.type)==="stand"&&((pt=n.baseConfig)==null?void 0:pt.placementType)==="float"?Le:0);console.log("🎯 Floor mesh Y calculation:",{internalSpace_startY:At.startY,baseFrameHeightMm:ie,floorFinishHeightMm:U,floatHeight:Le,floorY:Kn,baseConfig:n.baseConfig,panelStartY:Ie});const Ti=Hn.some(vt=>vt.depth>=730);if(Hn.length===0||!Ti)return l.jsxs("mesh",{position:[Ot,Kn+.001,Rn],rotation:[0,0,0],renderOrder:100,frustumCulled:!1,children:[l.jsx("boxGeometry",{args:[at,.01,Cn]}),l.jsx("meshBasicMaterial",{color:"#10b981",transparent:!0,opacity:.1,side:Go,depthWrite:!1,depthTest:!0})]});const ti=[],ai=Lt,Gi=dt,fi=Ot,Oi=[...Hn].sort((vt,kt)=>vt.position[0]-kt.position[0]);let rn=ai;Oi.forEach((vt,kt)=>{const mn=vt.width*.01,sn=vt.position[0]-mn/2,bn=vt.position[0]+mn/2;if(sn<Gi&&bn>ai&&vt.depth>=730){const Li=Math.max(0,sn-rn);Li>0&&ti.push({width:Li,x:rn+Li/2}),rn=bn}});const $n=Math.max(0,Gi-rn);return $n>0&&ti.push({width:$n,x:rn+$n/2}),ti.length===0?l.jsxs("mesh",{position:[fi,Kn,$t+En/2],rotation:[-Math.PI/2,0,0],castShadow:!1,receiveShadow:!1,frustumCulled:!1,children:[l.jsx("planeGeometry",{args:[at,En]}),l.jsx("meshStandardMaterial",{color:m.primary,transparent:!0,opacity:.4,side:Go})]}):null})(),n.surroundType==="no-surround"&&(n.installType==="builtin"||n.installType==="built-in")&&console.log("🔍 프레임 렌더링 체크:",{showFrame:a,frameThicknessLeft:E.left,frameThicknessRight:E.right,leftCondition:a&&E.left>0,rightCondition:a&&E.right>0}),console.log("🔍 왼쪽 프레임/엔드패널 렌더링 체크:",{showFrame:a,frameThicknessLeft:E.left,frameThicknessLeftMm:z.left,condition:a&&E.left>0,surroundType:n.surroundType,installType:n.installType,wallConfigLeft:le==null?void 0:le.left,wallConfigRight:le==null?void 0:le.right,예상:le!=null&&le.left?"왼쪽에 프레임 없음":"왼쪽에 엔드패널 있어야 함"}),console.log("🚨 왼쪽 엔드패널 렌더링 직전 체크:",{frameThicknessLeft:E.left,frameThicknessLeftMm:z.left,"frameThickness.left > 0":E.left>0,showFrame:a,"showFrame && frameThickness.left > 0":a&&E.left>0}),a&&E.left>0&&i!=="left"&&i!=="right"&&(()=>{var $t,Ht;const At=($t=n.droppedCeiling)==null?void 0:$t.enabled,zt=((Ht=n.droppedCeiling)==null?void 0:Ht.position)==="left",Zt=At&&n.droppedCeiling?n.droppedCeiling.dropHeight||200:0;if(At&&zt){const Lt=et-Yt(Zt),dt=Ie+Le+Lt/2;return l.jsx(l.Fragment,{children:l.jsx(xl,{isEndPanel:!(le!=null&&le.left),args:[E.left,Lt,n.surroundType==="no-surround"?le!=null&&le.left?Yt(Wi):$e+F/2-Yt(20)-ht:(n.installType==="semistanding"||n.installType==="semi-standing")&&!(le!=null&&le.left)||n.installType==="freestanding"||n.installType==="free-standing"?ft:Yt(Wi)],position:[Be+E.left/2,dt,n.surroundType==="no-surround"?le!=null&&le.left?$e+F/2-Yt(Wi)/2:ht+($e+F/2-Yt(20)-ht)/2:(n.installType==="semistanding"||n.installType==="semi-standing")&&!(le!=null&&le.left)||n.installType==="freestanding"||n.installType==="free-standing"?ht+ft/2:$e+F/2-Yt(Wi)/2],material:ye??new oo({color:"#cccccc"}),renderMode:x,view2DTheme:D})})}return console.log("🔍 왼쪽 엔드패널 렌더링 디버그:",{frameThicknessLeft:E.left,wallConfigLeft:le==null?void 0:le.left,surroundType:n.surroundType,installType:n.installType,깊이:le!=null&&le.left?"프레임(18mm)":"엔드패널(전체깊이-18mm)",위치:le!=null&&le.left?"프레임위치":"엔드패널위치"}),l.jsx(xl,{isEndPanel:!(le!=null&&le.left),args:[E.left,et,n.surroundType==="no-surround"?le!=null&&le.left?Yt(Wi):$e+F/2-Yt(20)-ht:(n.installType==="semistanding"||n.installType==="semi-standing")&&!(le!=null&&le.left)||n.installType==="freestanding"||n.installType==="free-standing"?ft:Yt(Wi)],position:[Be+E.left/2,je,n.surroundType==="no-surround"?le!=null&&le.left?$e+F/2-Yt(Wi)/2:ht+($e+F/2-Yt(20)-ht)/2:(n.installType==="semistanding"||n.installType==="semi-standing")&&!(le!=null&&le.left)||n.installType==="freestanding"||n.installType==="free-standing"?ht+ft/2:$e+F/2-Yt(Wi)/2],material:ye??new oo({color:"#cccccc"}),renderMode:x,view2DTheme:D,onClick:Lt=>{Lt.stopPropagation(),console.log("🎯 좌측 프레임 클릭",{showFrame:a,frameThicknessLeft:E.left,view2DDirection:i,wallConfigLeft:le==null?void 0:le.left})}})})(),a&&E.right>0&&i!=="left"&&i!=="right"&&(()=>{var $t,Ht;const At=($t=n.droppedCeiling)==null?void 0:$t.enabled,zt=At&&((Ht=n.droppedCeiling)==null?void 0:Ht.position)==="right",Zt=At&&n.droppedCeiling?n.droppedCeiling.dropHeight||200:0;if(At&&zt){const Lt=et-Yt(Zt),dt=Ie+Le+Lt/2;return l.jsx(l.Fragment,{children:l.jsx(xl,{isEndPanel:!(le!=null&&le.right),args:[E.right,Lt,n.surroundType==="no-surround"?le!=null&&le.right?Yt(Wi):$e+F/2-Yt(20)-ht:(n.installType==="semistanding"||n.installType==="semi-standing")&&!(le!=null&&le.right)||n.installType==="freestanding"||n.installType==="free-standing"?ft:Yt(Wi)],position:[Be+_-E.right/2,dt,n.surroundType==="no-surround"?le!=null&&le.right?$e+F/2-Yt(Wi)/2:ht+($e+F/2-Yt(20)-ht)/2:(n.installType==="semistanding"||n.installType==="semi-standing")&&!(le!=null&&le.right)||n.installType==="freestanding"||n.installType==="free-standing"?ht+ft/2:$e+F/2-Yt(Wi)/2],material:Y??new oo({color:"#cccccc"}),renderMode:x})})}return l.jsx(xl,{isEndPanel:!(le!=null&&le.right),args:[E.right,et,n.surroundType==="no-surround"?le!=null&&le.right?Yt(Wi):$e+F/2-Yt(20)-ht:(n.installType==="semistanding"||n.installType==="semi-standing")&&!(le!=null&&le.right)||n.installType==="freestanding"||n.installType==="free-standing"?ft:Yt(Wi)],position:[Be+_-E.right/2,je,n.surroundType==="no-surround"?le!=null&&le.right?$e+F/2-Yt(Wi)/2:ht+($e+F/2-Yt(20)-ht)/2:(n.installType==="semistanding"||n.installType==="semi-standing")&&!(le!=null&&le.right)||n.installType==="freestanding"||n.installType==="free-standing"?ht+ft/2:$e+F/2-Yt(Wi)/2],material:Y??new oo({color:"#cccccc"}),renderMode:x,onClick:Lt=>{Lt.stopPropagation(),console.log("🎯 우측 프레임 클릭",{showFrame:a,frameThicknessRight:E.right,view2DDirection:i,wallConfigRight:le==null?void 0:le.right})}})})(),a&&G>0&&l.jsx(l.Fragment,{children:(()=>{var ti,ai,Gi;const At=n.columns||[],zt=(ti=n.droppedCeiling)==null?void 0:ti.enabled;let Zt=0,$t=!1;if(zt&&n.droppedCeiling){Zt=Yt(n.droppedCeiling.width||DEFAULT_DROPPED_CEILING_VALUES.WIDTH);const fi=n.droppedCeiling.dropHeight||200;Yt(n.height-fi),$t=n.droppedCeiling.position==="left"}const Lt=wr.calculateZoneSlotInfo(n,n.customColumnCount).normal,dt=Yt(Lt.startX),at=Yt(Lt.startX+Lt.width),Ot=at-dt,Cn=(dt+at)/2,Rn=At.some(fi=>fi.depth>=730);if((At.length===0||!Rn)&&!zt)return l.jsx(xl,{args:[Ot,K,Yt(Wi)],position:[Cn,ct,$e+F/2-Yt(Wi)/2-Yt(bp())],material:he??H("top"),renderMode:x});if(zt&&!Rn){let fi,Oi,rn=0,$n=0;if(n.surroundType==="surround"){const sn=oa(n);rn=sn.left,$n=sn.right}else n.installType==="builtin"?(rn=2,$n=2):n.installType==="semistanding"?(ai=n.wallConfig)!=null&&ai.left?(rn=0,$n=Wi):((Gi=n.wallConfig)!=null&&Gi.right,rn=Wi,$n=0):(rn=Wi,$n=Wi);if($t){const sn=Yt(n.droppedCeiling.width||DEFAULT_DROPPED_CEILING_VALUES.WIDTH),bn=Yt(n.width-(n.droppedCeiling.width||DEFAULT_DROPPED_CEILING_VALUES.WIDTH));fi=sn-Yt(rn),Oi=bn-Yt($n)}else{const sn=Yt(n.width-(n.droppedCeiling.width||DEFAULT_DROPPED_CEILING_VALUES.WIDTH)),bn=Yt(n.droppedCeiling.width||DEFAULT_DROPPED_CEILING_VALUES.WIDTH);Oi=sn-Yt(rn),fi=bn-Yt($n)}const Fn=-(Yt(n.width)/2)+Yt(rn);let pt,vt;$t?(vt=Fn,pt=Fn+fi):(pt=Fn,vt=Fn+Oi);const kt=vt+fi/2,mn=pt+Oi/2;return console.log("🔥 상부 프레임 너비 상세 계산:",{전체너비mm:_/.01,frameWidth_mm:Ot/.01,droppedWidth_mm:Zt/.01,leftReduction:rn,rightReduction:$n,메인구간프레임너비_mm:Oi/.01,단내림구간프레임너비_mm:fi/.01,단내림위치:$t?"왼쪽":"오른쪽",위치정보:{internalStartX_mm:Fn/.01,normalStartX_mm:pt/.01,droppedStartX_mm:vt/.01,경계점_mm:($t?pt:vt)/.01},계산검증:{"단내림+메인":(fi+Oi)/.01,전체내부너비:(Yt(n.width)-Yt(rn+$n))/.01}}),l.jsxs(l.Fragment,{children:[l.jsx(xl,{args:[fi,K,Yt(Wi)],position:[kt,Ie+(I-Yt(n.droppedCeiling.dropHeight))-K/2,$e+F/2-Yt(Wi)/2-Yt(bp())],material:he??H("top"),renderMode:x}),l.jsx(xl,{args:[Oi,K,Yt(Wi)],position:[mn,ct,$e+F/2-Yt(Wi)/2-Yt(bp())],material:he??H("top"),renderMode:x})]})}const xn=[],En=Cn-Ot/2,Hn=[...At].sort((fi,Oi)=>fi.position[0]-Oi.position[0]);let Kn=En;Hn.forEach((fi,Oi)=>{const rn=fi.width*.01,$n=fi.position[0]-rn/2,Fn=fi.position[0]+rn/2;if($n<at&&Fn>dt&&fi.depth>=730){const pt=Math.max(0,$n-Kn);pt>0&&xn.push({width:pt,x:Kn+pt/2}),Kn=Fn}});const Ti=Math.max(0,at-Kn);return Ti>0&&xn.push({width:Ti,x:Kn+Ti/2}),xn.length===0?l.jsx(xl,{args:[Ot,K,Yt(Wi)],position:[Cn,ct,$e+F/2-Yt(Wi)/2-Yt(bp())],material:he??H("top"),renderMode:x}):xn.map((fi,Oi)=>(he?console.log(`🎨 Top frame segment ${Oi} material:`,{hasTopFrameMaterial:!!he,materialType:he==null?void 0:he.type,materialColor:he&&"color"in he?he.color.getHexString():"unknown",materialTexture:he&&"map"in he?!!he.map:!1,segmentWidth:fi.width}):console.warn(`⚠️ Top frame segment ${Oi} - material not ready, using default`),l.jsx(xl,{args:[fi.width,K,Yt(Wi)],position:[fi.x,ct,$e+F/2-Yt(Wi)/2-Yt(bp())],material:he??H("top"),renderMode:x},`top-frame-segment-${Oi}`)))})()}),!1,a&&n.surroundType!=="no-surround"&&((Et=n.frameSize)==null?void 0:Et.left)>=20&&i!=="left"&&i!=="right"&&(n.installType==="builtin"||n.installType==="built-in"||n.installType==="semistanding"&&(le==null?void 0:le.left))&&(()=>{var xn,En,Hn,Kn,Ti,ti;const At=v==null?void 0:v.filter(ai=>{var Gi,fi,Oi,rn,$n,Fn;return((Gi=ai.moduleId)==null?void 0:Gi.toLowerCase().includes("upper-cabinet"))||((fi=ai.moduleId)==null?void 0:fi.toLowerCase().includes("lower-cabinet"))||((Oi=ai.moduleId)==null?void 0:Oi.toLowerCase().includes("upper_cabinet"))||((rn=ai.moduleId)==null?void 0:rn.toLowerCase().includes("lower_cabinet"))||(($n=ai.moduleId)==null?void 0:$n.toLowerCase().includes("uppercabinet"))||((Fn=ai.moduleId)==null?void 0:Fn.toLowerCase().includes("lowercabinet"))}).sort((ai,Gi)=>{var fi,Oi;return(((fi=ai.position)==null?void 0:fi.x)||0)-(((Oi=Gi.position)==null?void 0:Oi.x)||0)})[0],zt=Be+E.left,Zt=(At==null?void 0:At.isDualSlot)||((xn=At==null?void 0:At.moduleId)==null?void 0:xn.includes("dual-"));let $t=0;if(At)if(At.adjustedWidth)$t=Yt(At.adjustedWidth);else if(At.moduleWidth)$t=Yt(At.moduleWidth);else{const ai=(En=At.moduleId)==null?void 0:En.match(/(\d+)$/),Gi=ai?parseInt(ai[1]):600;$t=Yt(Gi)}const Ht=At?(((Hn=At.position)==null?void 0:Hn.x)||0)-$t/2:0,Lt=!!(At&&Math.abs(Ht-zt)<.2);console.log("🔍🔍🔍 LEFT Subframe Debug:",{actualPlacedModules:v==null?void 0:v.length,leftmostCabinet:At,isLeftDual:Zt,cabinetWidth:$t,leftFrameRightEdge:zt,cabinetLeftEdge:Ht,distance:At?Math.abs(Ht-zt):null,hasLeftCabinet:Lt,moduleId:At==null?void 0:At.moduleId});const dt=Lt?602:40;console.log("🔥🔥🔥 LEFT Subframe Final Depth:",{hasLeftCabinet:Lt,leftFrameDepth:dt,leftFrameDepthMm:Lt?602:40,leftFrameDepthInThreeUnits:Yt(dt),actualDepthBeingUsed:dt});const at=((Kn=n.droppedCeiling)==null?void 0:Kn.enabled)??!1,Ot=((Ti=n.droppedCeiling)==null?void 0:Ti.position)??"right",Cn=((ti=n.droppedCeiling)==null?void 0:ti.dropHeight)??200;if(at&&Ot==="left"){const ai=et-Yt(Cn),Gi=Ie+Le+ai/2,fi=Lt?$e-Yt(Wi)/2-Yt(29)+Yt(19):$e+F/2-Yt(Wi)/2-Yt(29);return l.jsx("group",{position:[Be+E.left-Yt(10)+Yt(1),Gi,fi],rotation:[0,Math.PI/2,0],children:l.jsx(xl,{args:[Yt(dt),ai,Yt(Wi)],position:[0,0,0],material:_e??new oo({color:"#cccccc"}),renderMode:x})})}const Rn=Lt?$e-Yt(Wi)/2-Yt(29)+Yt(19):$e+F/2-Yt(Wi)/2-Yt(29);return l.jsxs("group",{position:[Be+E.left-Yt(10)+Yt(1),je,Rn],rotation:[0,Math.PI/2,0],children:[console.log("🔴🔴 LEFT BoxWithEdges rendering with depth:",{leftFrameDepth:dt,hasLeftCabinet:Lt,depthInThreeUnits:Yt(dt),depthInMm:dt}),l.jsx(xl,{args:[Yt(dt),et,Yt(Wi)],position:[0,0,0],material:_e??new oo({color:"#cccccc"}),renderMode:x})]})})(),a&&n.surroundType!=="no-surround"&&((an=n.frameSize)==null?void 0:an.right)>=20&&i!=="left"&&i!=="right"&&(n.installType==="builtin"||n.installType==="built-in"||n.installType==="semistanding"&&(le==null?void 0:le.right))&&(()=>{var xn,En,Hn,Kn,Ti,ti;const At=v==null?void 0:v.filter(ai=>{var Gi,fi,Oi,rn,$n,Fn;return((Gi=ai.moduleId)==null?void 0:Gi.toLowerCase().includes("upper-cabinet"))||((fi=ai.moduleId)==null?void 0:fi.toLowerCase().includes("lower-cabinet"))||((Oi=ai.moduleId)==null?void 0:Oi.toLowerCase().includes("upper_cabinet"))||((rn=ai.moduleId)==null?void 0:rn.toLowerCase().includes("lower_cabinet"))||(($n=ai.moduleId)==null?void 0:$n.toLowerCase().includes("uppercabinet"))||((Fn=ai.moduleId)==null?void 0:Fn.toLowerCase().includes("lowercabinet"))}).sort((ai,Gi)=>{var fi,Oi;return(((fi=Gi.position)==null?void 0:fi.x)||0)-(((Oi=ai.position)==null?void 0:Oi.x)||0)})[0],zt=Be+_-E.right,Zt=(At==null?void 0:At.isDualSlot)||((xn=At==null?void 0:At.moduleId)==null?void 0:xn.includes("dual-"));let $t=0;if(At)if(At.adjustedWidth)$t=Yt(At.adjustedWidth);else if(At.moduleWidth)$t=Yt(At.moduleWidth);else{const ai=(En=At.moduleId)==null?void 0:En.match(/(\d+)$/),Gi=ai?parseInt(ai[1]):600;$t=Yt(Gi)}const Ht=At?(((Hn=At.position)==null?void 0:Hn.x)||0)+$t/2:0,Lt=!!(At&&Math.abs(Ht-zt)<.2);console.log("🔍🔍🔍 RIGHT Subframe Debug:",{actualPlacedModules:v==null?void 0:v.length,rightmostCabinet:At,isRightDual:Zt,rightCabinetWidth:$t,rightFrameLeftEdge:zt,cabinetRightEdge:Ht,distance:At?Math.abs(Ht-zt):null,hasRightCabinet:Lt,moduleId:At==null?void 0:At.moduleId});const dt=Lt?602:40;console.log("🔥🔥🔥 RIGHT Subframe Final Depth:",{hasRightCabinet:Lt,rightFrameDepth:dt,rightFrameDepthMm:Lt?602:40,rightFrameDepthInThreeUnits:Yt(dt),actualDepthBeingUsed:dt});const at=((Kn=n.droppedCeiling)==null?void 0:Kn.enabled)??!1,Ot=((Ti=n.droppedCeiling)==null?void 0:Ti.position)??"right",Cn=((ti=n.droppedCeiling)==null?void 0:ti.dropHeight)??200;if(at&&Ot==="right"){const ai=et-Yt(Cn),Gi=Ie+Le+ai/2,fi=Lt?$e-Yt(Wi)/2-Yt(29)+Yt(19):$e+F/2-Yt(Wi)/2-Yt(29);return l.jsx("group",{position:[Be+_-E.right+Yt(10)-Yt(1),Gi,fi],rotation:[0,Math.PI/2,0],children:l.jsx(xl,{args:[Yt(dt),ai,Yt(Wi)],position:[0,0,0],material:ce??new oo({color:"#cccccc"}),renderMode:x})})}const Rn=Lt?$e-Yt(Wi)/2-Yt(29)+Yt(19):$e+F/2-Yt(Wi)/2-Yt(29);return l.jsxs("group",{position:[Be+_-E.right+Yt(10)-Yt(1),je,Rn],rotation:[0,Math.PI/2,0],children:[console.log("🔴🔴 RIGHT BoxWithEdges rendering with depth:",{rightFrameDepth:dt,hasRightCabinet:Lt,depthInThreeUnits:Yt(dt),depthInMm:dt}),l.jsx(xl,{args:[Yt(dt),et,Yt(Wi)],position:[0,0,0],material:ce??new oo({color:"#cccccc"}),renderMode:x})]})})(),a&&ie>0&&((Mn=n.baseConfig)==null?void 0:Mn.type)==="floor"&&(console.log("🎯 베이스프레임 높이 확인:",{최종_높이:ie,baseFrameHeight_ThreeUnits:P,spaceInfo_baseConfig:n.baseConfig,END_PANEL_THICKNESS:Wi}),l.jsx(l.Fragment,{children:(()=>{var Rn;const At=n.columns||[];let zt,Zt;if((Rn=n.droppedCeiling)!=null&&Rn.enabled){const xn=wr.calculateZoneSlotInfo(n,n.customColumnCount);let En,Hn;n.droppedCeiling.position==="left"?(En=xn.dropped.startX,Hn=xn.normal.startX+xn.normal.width):(En=xn.normal.startX,Hn=xn.dropped.startX+xn.dropped.width);const Kn=Yt(En),Ti=Yt(Hn);zt=Ti-Kn,Zt=(Kn+Ti)/2}else{const En=wr.calculateZoneSlotInfo(n,n.customColumnCount).normal,Hn=Yt(En.startX),Kn=Yt(En.startX+En.width);zt=Kn-Hn,Zt=(Hn+Kn)/2}const $t=At.some(xn=>xn.depth>=730);if(At.length===0||!$t)return l.jsx(xl,{args:[zt,P,Yt(Wi)],position:[Zt,Ie+P/2,$e+F/2-Yt(Wi)/2-Yt(bp())],material:te??H("base"),renderMode:x});const Ht=[],Lt=Zt-zt/2,dt=Zt+zt/2,at=[...At].sort((xn,En)=>xn.position[0]-En.position[0]);let Ot=Lt;at.forEach((xn,En)=>{const Hn=xn.width*.01,Kn=xn.position[0]-Hn/2,Ti=xn.position[0]+Hn/2;if(Kn<dt&&Ti>Lt&&xn.depth>=730){const ti=Math.max(0,Kn-Ot);ti>0&&Ht.push({width:ti,x:Ot+ti/2}),Ot=Ti}});const Cn=Math.max(0,dt-Ot);return Cn>0&&Ht.push({width:Cn,x:Ot+Cn/2}),Ht.length===0?l.jsx(xl,{args:[Ge,P,Yt(Wi)],position:[Re,Ie+P/2,$e+F/2-Yt(Wi)/2-Yt(bp())],material:te??H("base"),renderMode:x}):Ht.map((xn,En)=>(te?console.log(`🎨 Base frame segment ${En} material:`,{hasBaseFrameMaterial:!!te,materialType:te==null?void 0:te.type,materialColor:te&&"color"in te?te.color.getHexString():"unknown",materialTexture:te&&"map"in te?!!te.map:!1,doorColor:r==null?void 0:r.doorColor,doorTexture:r==null?void 0:r.doorTexture,segmentWidth:xn.width}):console.warn(`⚠️ Base frame segment ${En} - material not ready, using default`),l.jsx(xl,{args:[xn.width,P,Yt(Wi)],position:[xn.x,Ie+P/2,$e+F/2-Yt(Wi)/2-Yt(Wi)],material:te??H("base"),renderMode:x},`base-frame-segment-${En}`)))})()})),o&&(c&&c.length>0?l.jsx(l.Fragment,{children:(()=>{var zt;const At=f&&((zt=n.droppedCeiling)!=null&&zt.enabled)?c.filter(Zt=>Zt.zone===f):c;return console.log("🔥 Room - PlacedFurnitureContainer 렌더링 (뷰어 모드):",{viewMode:t,renderMode:x,activeZone:f,originalCount:(c==null?void 0:c.length)||0,filteredCount:(At==null?void 0:At.length)||0,placedModules:At,showFurniture:o}),l.jsx(Kj,{viewMode:t,view2DDirection:i,renderMode:x,placedModules:At,showFurniture:t==="3D"?!0:o,isReadOnly:A})})()}):l.jsxs(l.Fragment,{children:[console.log("🔥 Room - PlacedFurnitureContainer 렌더링 (에디터 모드):",{viewMode:t,renderMode:x,view2DDirection:i,activeZone:f,showFurniture:o}),l.jsx(Kj,{viewMode:t,view2DDirection:i,renderMode:x,activeZone:f,showFurniture:t==="3D"?!0:o,isReadOnly:A})]}))]})},jI=ii.memo(Qhe,(n,e)=>{if(n.viewMode!==e.viewMode||n.view2DDirection!==e.view2DDirection||n.renderMode!==e.renderMode||n.showAll!==e.showAll||n.showFurniture!==e.showFurniture||n.floorColor!==e.floorColor||n.showFrame!==e.showFrame||n.showDimensions!==e.showDimensions||n.isStep2!==e.isStep2||n.activeZone!==e.activeZone)return!1;const t=n.spaceInfo,i=e.spaceInfo;if(t.width!==i.width||t.height!==i.height||t.depth!==i.depth||t.leftSurround!==i.leftSurround||t.rightSurround!==i.rightSurround||t.hasWallFinish!==i.hasWallFinish||t.wallFinishThickness!==i.wallFinishThickness||t.hasFloorFinish!==i.hasFloorFinish||t.floorFinishThickness!==i.floorFinishThickness||t.surroundType!==i.surroundType||JSON.stringify(t.frameSize)!==JSON.stringify(i.frameSize)||JSON.stringify(t.materialConfig)!==JSON.stringify(i.materialConfig)||JSON.stringify(n.materialConfig)!==JSON.stringify(e.materialConfig)||JSON.stringify(t.baseConfig)!==JSON.stringify(i.baseConfig)||t.installType!==i.installType||JSON.stringify(t.wallConfig)!==JSON.stringify(i.wallConfig)||JSON.stringify(t.gapConfig)!==JSON.stringify(i.gapConfig))return!1;const r=n.placedModules||[],s=e.placedModules||[];if(r.length!==s.length)return!1;const o=t.columns||[],a=i.columns||[];if(o.length!==a.length)return!1;for(let c=0;c<o.length;c++){const h=o[c],u=a.find(d=>d.id===h.id);if(!u||Math.abs(h.position[0]-u.position[0])>.01||Math.abs(h.position[2]-u.position[2])>.01||h.width!==u.width||h.depth!==u.depth||h.height!==u.height)return!1}return!0}),$he=({position:n,id:e,width:t=300,height:i=2400,depth:r=730,color:s="#E0E0E0",renderMode:o="solid",onPositionChange:a,onRemove:c,spaceInfo:h,hasBackPanelFinish:u=!1})=>{var fe;const d=O.useRef(null),[f,A]=O.useState(!1),g=O.useRef(!1),[p,y]=O.useState(!1),[v,m]=O.useState(null),[w,x]=O.useState(0),[T,j]=O.useState(!1),D=O.useRef(null),b=O.useRef(null),_=O.useRef(null),I=O.useRef(n),S=O.useRef(0),{viewMode:F}=Qi(),B=qi(),{selectedColumnId:E,setSelectedColumnId:V,openColumnEditModal:K,openColumnPopup:P,activePopup:M,view2DDirection:X,setIsDraggingColumn:Z,viewMode:Q}=Bi();(fe=B.spaceInfo.columns)==null||fe.find(ye=>ye.id===e);const{invalidate:U}=jl();O.useEffect(()=>{f||(U(),I.current=n)},[n,t,i,r,f,U]);const z=M.type==="columnEdit"&&M.id===e,q=ii.useMemo(()=>{const ye=Zu.createWallGradientTexture();ye.wrapS=fm,ye.wrapT=fm;const be=z?"#4CAF50":new Yr(1,1,1);return new oo({map:ye,color:be,metalness:.1,roughness:.7})},[z]),G=ii.useMemo(()=>{let ye="#333333";return z?ye="#4CAF50":f&&(ye="#ff6b6b"),new zC({color:new Yr(ye),linewidth:1})},[f,z]),ie=ye=>{ye.stopPropagation(),ye.nativeEvent.stopPropagation(),ye.nativeEvent.preventDefault(),!(f||T||Date.now()-w>200)&&(V(e),P(e))},H=ye=>{ye.stopPropagation(),ye.nativeEvent.stopPropagation(),ye.nativeEvent.preventDefault(),!(f||T)&&(V(e),K(e))},se=ye=>{ye.stopPropagation(),ye.nativeEvent.stopPropagation(),ye.nativeEvent.preventDefault(),x(Date.now()),j(!1),m(ye.point);const be=ye.nativeEvent.clientX,_e=5,W=16,Y=((h==null?void 0:h.width)||3e3)*.005,ve=t*.005,ce=-Y+ve,ne=Y-ve;D.current||(D.current=document.querySelector("canvas"));const he=Te=>{const Ce=Te.clientX;if(Math.abs(Ce-be)>_e&&!g.current&&(j(!0),A(!0),g.current=!0,Z(!0),Q==="3D"&&window.dispatchEvent(new CustomEvent("reset-camera-for-column")),window.dispatchEvent(new CustomEvent("furniture-drag-start"))),!g.current)return;const Ye=Date.now();if(Ye-S.current<W||(S.current=Ye,!D.current))return;b.current||(b.current=D.current.getBoundingClientRect());const $e=b.current,Ve=((Te.clientX-$e.left)/$e.width*2-1)*Y;let We=Math.max(ce,Math.min(ne,Ve));const De=B.spaceInfo.columns||[],Ge=t*.01,Re=Ge*.3,Ie=.001;for(const Le of De){if(Le.id===e||!Le.position)continue;const et=Le.position[0],ct=et-Ge/2,mt=et+Ge/2,je=We-Ge/2,le=We+Ge/2;if(je<mt+Ie&&le>ct-Ie)We>et?We=et+Ge:We=et-Ge;else{const Je=Math.abs(We-(et-Ge)),ht=Math.abs(We-(et+Ge));Je<Re?We=et-Ge:ht<Re&&(We=et+Ge)}}We=Math.max(ce,Math.min(ne,We)),I.current=[We,n[1],n[2]],a&&!isNaN(We)&&(_.current&&cancelAnimationFrame(_.current),_.current=requestAnimationFrame(()=>{a(e,I.current),_.current=null}))},xe=()=>{g.current&&(Z(!1),window.dispatchEvent(new CustomEvent("column-drag-end")),window.dispatchEvent(new CustomEvent("furniture-drag-end"))),A(!1),g.current=!1,m(null),j(!1),document.removeEventListener("pointermove",he),document.removeEventListener("pointerup",xe),b.current=null,_.current&&(cancelAnimationFrame(_.current),_.current=null)};document.addEventListener("pointermove",he,{passive:!0}),document.addEventListener("pointerup",xe)},te=ye=>{ye.stopPropagation(),ye.nativeEvent.stopPropagation(),ye.nativeEvent.preventDefault(),window.confirm("기둥을 삭제하시겠습니까?")&&(c==null||c(e))};return l.jsx("group",{position:n,children:F==="2D"?l.jsxs("group",{position:[0,i*.01/2,0],children:[l.jsxs("mesh",{onClick:ie,onDoubleClick:H,onPointerDown:se,onPointerEnter:()=>y(!0),onPointerLeave:()=>y(!1),onContextMenu:te,userData:{isColumn:!0,columnId:e},children:[l.jsx("boxGeometry",{args:[t*.01,i*.01,r*.01]}),l.jsx("meshBasicMaterial",{transparent:!0,opacity:0})]}),l.jsxs("mesh",{children:[l.jsx("boxGeometry",{args:[t*.01,i*.01,r*.01]}),l.jsx("meshBasicMaterial",{color:z?"#e8f5e8":"#f0f0f0",transparent:!0,opacity:.6})]}),l.jsxs("lineSegments",{children:[l.jsx("edgesGeometry",{args:[new rh(t*.01,i*.01,r*.01)]}),l.jsx("lineBasicMaterial",{color:z?"#4CAF50":"#999999"})]}),(()=>{const ye=z?"#4CAF50":"#cccccc",be=.25,_e=t*.01,W=i*.01,Y=r*.01,ve=[];switch(X){case"front":for(let ce=-Math.ceil(_e/be);ce<=Math.ceil(W/be);ce++){const ne=-W/2+ce*be,he=ne+_e,xe=Math.max(-W/2,Math.min(W/2,ne)),Te=Math.max(-W/2,Math.min(W/2,he));if(xe<Te){const Ce=-_e/2+(xe-ne),Be=-_e/2+(Te-ne);ve.push(l.jsx(it,{points:[[Math.max(-_e/2,Math.min(_e/2,Ce)),xe,Y/2+.001],[Math.max(-_e/2,Math.min(_e/2,Be)),Te,Y/2+.001]],color:ye,lineWidth:1},`front-diag-${ce}`))}}break;case"top":for(let ce=-Math.ceil(_e/be);ce<=Math.ceil(Y/be);ce++){const ne=-Y/2+ce*be,he=ne+_e,xe=Math.max(-Y/2,Math.min(Y/2,ne)),Te=Math.max(-Y/2,Math.min(Y/2,he));if(xe<Te){const Ce=-_e/2+(xe-ne),Be=-_e/2+(Te-ne);ve.push(l.jsx(it,{points:[[Math.max(-_e/2,Math.min(_e/2,Ce)),.001,xe],[Math.max(-_e/2,Math.min(_e/2,Be)),.001,Te]],color:ye,lineWidth:1},`top-diag-${ce}`))}}break;case"left":case"right":for(let ce=-Math.ceil(W/be);ce<=Math.ceil(Y/be);ce++){const ne=-Y/2+ce*be,he=ne+W,xe=Math.max(-Y/2,Math.min(Y/2,ne)),Te=Math.max(-Y/2,Math.min(Y/2,he));if(xe<Te){const Ce=-W/2+(xe-ne),Be=-W/2+(Te-ne);ve.push(l.jsx(it,{points:[[.001,Math.max(-W/2,Math.min(W/2,Ce)),xe],[.001,Math.max(-W/2,Math.min(W/2,Be)),Te]],color:ye,lineWidth:1},`side-diag-${ce}`))}}break}return ve})()]}):o==="wireframe"?l.jsxs("group",{position:[0,i*.01/2,0],children:[l.jsxs("mesh",{onClick:ie,onDoubleClick:H,onPointerDown:se,onPointerEnter:()=>y(!0),onPointerLeave:()=>y(!1),onContextMenu:te,userData:{isColumn:!0,columnId:e},children:[l.jsx("boxGeometry",{args:[t*.01,i*.01,r*.01]}),l.jsx("meshBasicMaterial",{transparent:!0,opacity:0})]}),l.jsxs("lineSegments",{children:[l.jsx("edgesGeometry",{args:[new rh(t*.01,i*.01,r*.01)]}),l.jsx("primitive",{object:G})]}),l.jsx(it,{points:[[-(t*.01)/2,-(i*.01)/2,r*.01/2],[t*.01/2,i*.01/2,r*.01/2]],color:z?"#4CAF50":f?"#ff6b6b":"#333333",lineWidth:1}),l.jsx(it,{points:[[t*.01/2,-(i*.01)/2,r*.01/2],[-(t*.01)/2,i*.01/2,r*.01/2]],color:z?"#4CAF50":f?"#ff6b6b":"#333333",lineWidth:1})]}):l.jsxs(l.Fragment,{children:[l.jsxs("group",{position:[0,i*.01/2,0],children:[l.jsx("mesh",{ref:d,material:q,receiveShadow:F==="3D",castShadow:F==="3D",onClick:ie,onDoubleClick:H,onPointerDown:se,onPointerEnter:()=>y(!0),onPointerLeave:()=>y(!1),onContextMenu:te,userData:{isColumn:!0,columnId:e},scale:f?[.95,.95,.95]:[1,1,1],children:l.jsx("boxGeometry",{args:[t*.01,i*.01,r*.01]})}),l.jsxs("lineSegments",{children:[l.jsx("edgesGeometry",{args:[new rh(t*.01,i*.01,r*.01)]}),l.jsx("lineBasicMaterial",{color:z?"#4CAF50":f?"#ff6b6b":"#666666",linewidth:1})]})]}),u&&l.jsxs("group",{position:[0,i*.01/2,-(r*.01)/2-.009],children:[l.jsxs("mesh",{receiveShadow:F==="3D",castShadow:F==="3D",children:[l.jsx("boxGeometry",{args:[t*.01,i*.01,.018]})," ",l.jsx("meshStandardMaterial",{color:"#F5F5DC",roughness:.6,metalness:0})]}),l.jsxs("lineSegments",{children:[l.jsx("edgesGeometry",{args:[new rh(t*.01,i*.01,.018)]}),l.jsx("lineBasicMaterial",{color:"#999999",linewidth:1})]})]})]})})},I$=ii.memo($he,(n,e)=>{var t,i,r,s,o,a;return n.position[0]===e.position[0]&&n.position[1]===e.position[1]&&n.position[2]===e.position[2]&&n.width===e.width&&n.height===e.height&&n.depth===e.depth&&n.color===e.color&&n.id===e.id&&n.renderMode===e.renderMode&&n.hasBackPanelFinish===e.hasBackPanelFinish&&((t=n.spaceInfo)==null?void 0:t.width)===((i=e.spaceInfo)==null?void 0:i.width)&&((r=n.spaceInfo)==null?void 0:r.depth)===((s=e.spaceInfo)==null?void 0:s.depth)&&((o=n.spaceInfo)==null?void 0:o.height)===((a=e.spaceInfo)==null?void 0:a.height)}),Vhe=({position:n,id:e,width:t=120,height:i=2400,depth:r=730,color:s="#E0E0E0",renderMode:o="solid",onPositionChange:a,onRemove:c,spaceInfo:h})=>{var X;console.log("🎯 WallAsset 렌더링:",{id:e,height:i,position:n});const u=O.useRef(null),[d,f]=O.useState(!1),[A,g]=O.useState(!1),[p,y]=O.useState(null),[v,m]=O.useState(0),[w,x]=O.useState(!1),{viewMode:T}=Qi(),j=qi(),{selectedWallId:D,setSelectedWallId:b,openWallEditModal:_,openWallPopup:I,activePopup:S}=Bi();(X=j.spaceInfo.walls)==null||X.find(Z=>Z.id===e);const F=S.type==="wallEdit"&&S.id===e,B=ii.useMemo(()=>{const Z=F?"#4CAF50":s;return new oo({color:new Yr(Z),metalness:.1,roughness:.7,transparent:!0,opacity:d?.7:1})},[s,d,F]),E=ii.useMemo(()=>{let Z="#333333";return F?Z="#4CAF50":d&&(Z="#ff6b6b"),new zC({color:new Yr(Z),linewidth:1})},[d,F]),V=Z=>{if(Z.stopPropagation(),console.log("🎯 가벽 클릭 이벤트 발생:",e),d||w){console.log("🎯 드래그 중이거나 움직임이 있었으므로 클릭 무시");return}const Q=Date.now()-v;if(Q>200){console.log("🎯 클릭 시간이 너무 길어서 무시:",Q);return}console.log("🎯 가벽 클릭 - 가벽 선택 및 팝업 열기:",e),console.log("🎯 현재 selectedWallId:",D),b(e),I(e),console.log("✅ setSelectedWallId 및 openWallPopup 호출됨:",e),console.log("✅ 변경 후 selectedWallId:",e)},K=Z=>{if(Z.stopPropagation(),console.log("🎯 가벽 더블클릭 이벤트 발생:",e),d||w){console.log("🎯 드래그 중이거나 움직임이 있었으므로 더블클릭 무시");return}console.log("🎯 가벽 더블 클릭 - 가벽 선택 및 편집 모달 열기:",e),console.log("🎯 현재 selectedWallId:",D),b(e),_(e),console.log("✅ setSelectedWallId 및 openWallEditModal 호출됨:",e),console.log("✅ 변경 후 selectedWallId:",e)},P=Z=>{Z.stopPropagation(),console.log("🎯 가벽 포인터 다운:",e),m(Date.now()),x(!1),y(Z.point);const Q=Z.nativeEvent.clientX,U=5,z=G=>{const ie=G.clientX,H=Math.abs(ie-Q);H>U&&!w&&(console.log("🎯 가벽 드래그 시작 감지:",H),x(!0),f(!0),window.dispatchEvent(new CustomEvent("furniture-drag-start")));const se=document.querySelector("canvas");if(!se)return;const te=se.getBoundingClientRect(),ye=(G.clientX-te.left)/te.width*2-1,be=((h==null?void 0:h.width)||3e3)*.01,_e=ye*(be/2),W=((h==null?void 0:h.depth)||1500)*.01,Y=r*.01,ve=-(W/2)+Y/2,ce=[Math.max(-be/2+t*.01/2,Math.min(be/2-t*.01/2,_e)),n[1],ve];console.log("🎯 가벽 드래그 위치 업데이트:",{id:e,oldPosition:n,newPosition:ce,spaceWidth:be,worldX:_e,moveDistance:H}),a&&!isNaN(ce[0])&&!isNaN(ce[1])&&!isNaN(ce[2])&&a(e,ce)},q=()=>{console.log("🎯 가벽 포인터 업:",e,"hasMoved:",w),w&&window.dispatchEvent(new CustomEvent("furniture-drag-end")),f(!1),y(null),x(!1),document.removeEventListener("pointermove",z),document.removeEventListener("pointerup",q)};document.addEventListener("pointermove",z),document.addEventListener("pointerup",q)},M=Z=>{Z.stopPropagation(),console.log("🎯 가벽 우클릭 - 삭제 확인"),window.confirm("가벽을 삭제하시겠습니까?")&&(c==null||c(e))};return l.jsx("group",{position:n,children:o==="wireframe"?l.jsxs("group",{position:[0,i*.01/2,0],children:[l.jsxs("mesh",{onClick:V,onDoubleClick:K,onPointerDown:P,onPointerEnter:()=>g(!0),onPointerLeave:()=>g(!1),onContextMenu:M,userData:{isWall:!0,wallId:e},children:[l.jsx("boxGeometry",{args:[t*.01,i*.01,r*.01]}),l.jsx("meshBasicMaterial",{transparent:!0,opacity:0})]}),l.jsxs("lineSegments",{children:[l.jsx("edgesGeometry",{args:[new rh(t*.01,i*.01,r*.01)]}),l.jsx("primitive",{object:E})]}),T==="2D"&&l.jsxs(l.Fragment,{children:[l.jsx(it,{points:[[-(t*.01)/2,-(i*.01)/2,r*.01/2],[t*.01/2,i*.01/2,r*.01/2]],color:F?"#4CAF50":d?"#ff6b6b":"#333333",lineWidth:1}),l.jsx(it,{points:[[t*.01/2,-(i*.01)/2,r*.01/2],[-(t*.01)/2,i*.01/2,r*.01/2]],color:F?"#4CAF50":d?"#ff6b6b":"#333333",lineWidth:1})]})]}):l.jsx("mesh",{ref:u,material:B,receiveShadow:T==="3D",castShadow:T==="3D",onClick:V,onDoubleClick:K,onPointerDown:P,onPointerEnter:()=>g(!0),onPointerLeave:()=>g(!1),onContextMenu:M,position:[0,i*.01/2,0],userData:{isWall:!0,wallId:e},children:l.jsx("boxGeometry",{args:[t*.01,i*.01,r*.01]})})})},zhe=({column:n,spaceInfo:e,onPositionChange:t,onColumnUpdate:i,showLabels:r=!0})=>{const{viewMode:s}=Qi(),{theme:o}=Yo(),[a,c]=O.useState(null),[h,u]=O.useState(""),d=O.useRef(null),f=Bi(E=>E.showDimensions),A=(E,V)=>typeof window<"u"&&getComputedStyle(document.documentElement).getPropertyValue(E).trim()||V,g=s==="3D"?{primary:"#10b981",background:"#ffffff",border:"#10b981",hoverBg:"#d1fae5"}:{primary:A("--theme-primary","#10b981"),background:A("--theme-surface","#ffffff"),text:A("--theme-text","#111827"),border:A("--theme-primary","#10b981"),hoverBg:A("--theme-primary-light","#d1fae5"),textSecondary:A("--theme-text-secondary","#6b7280")},p={width:"100%",padding:"8px 12px",border:`2px solid ${g.border}`,borderRadius:"6px",fontSize:"16px",textAlign:"center",fontFamily:"system-ui, -apple-system, sans-serif",fontWeight:"600",outline:"none",backgroundColor:"#ffffff",color:"#000000",WebkitTextFillColor:"#000000",opacity:1};s==="3D"||o==null||o.mode;const v=qi(E=>{var V;return(V=E.spaceInfo.columns)==null?void 0:V.find(K=>K.id===n.id)})||n;if(O.useEffect(()=>{a&&d.current&&setTimeout(()=>{var E,V;(E=d.current)==null||E.focus(),(V=d.current)==null||V.select()},100)},[a]),(o==null?void 0:o.mode)==="dark"||document.body.classList.contains("theme-dark"),O.useEffect(()=>{const E=document.querySelector('[data-column-distance-styles="true"]');E&&E.remove();const V=document.createElement("style");return V.textContent=`
      /* 기둥 거리 입력 필드 - 특정 클래스로 제한 */
      .column-distance-label-input {
        color: #000000 !important;
        background-color: #ffffff !important;
        -webkit-text-fill-color: #000000 !important;
        opacity: 1 !important;
        caret-color: #000000 !important;
      }
      /* 상태별 스타일 */
      .column-distance-label-input:focus,
      .column-distance-label-input:hover,
      .column-distance-label-input:active,
      .column-distance-label-input:disabled {
        color: #000000 !important;
        background-color: #ffffff !important;
        -webkit-text-fill-color: #000000 !important;
      }
    `,document.head.appendChild(V),V.setAttribute("data-column-distance-styles","true"),()=>{V.parentNode&&document.head.removeChild(V)}},[]),!r||!f)return null;const m=((e==null?void 0:e.width)||3600)*.01,w=((e==null?void 0:e.depth)||1500)*.01,x=v.width*.01,T=v.depth*.01,j=v.height*.01,D=Math.round((m/2+v.position[0]-x/2)*100),b=Math.round((m/2-v.position[0]-x/2)*100);Math.round((w/2+v.position[2]-T/2)*100),Math.round((w/2-v.position[2]-T/2)*100);const _=(E,V)=>{if(!t||V<10||V>((e==null?void 0:e.width)||3600)/2)return;const K=m,P=x;let M=v.position[0];E==="left"?M=-(K/2)+V*.01+P/2:E==="right"&&(M=K/2-V*.01-P/2);const X=[M,0,v.position[2]];t(v.id,X)},I=E=>{i&&(E<800||E>3e3||i(v.id,{width:E}))},S=(E,V)=>{V&&V.stopPropagation(),c(E),E==="left"?u(Math.max(0,D).toString()):E==="right"?u(Math.max(0,b).toString()):E==="width"?u(v.width.toString()):E==="height"&&u(v.height.toString())},F=()=>{const E=parseInt(h)||0;a==="left"?_("left",E):a==="right"?_("right",E):a==="width"&&I(E),c(null),u("")},B=()=>{c(null),u("")};return l.jsxs("group",{children:[l.jsxs("group",{children:[l.jsxs("mesh",{position:[(-m/2+v.position[0]-x/2)/2,j/2,v.position[2]+(s==="2D"?.1:0)],children:[l.jsx("boxGeometry",{args:[Math.abs(v.position[0]-x/2- -m/2),.02,.02]}),l.jsx("meshBasicMaterial",{color:g.primary,transparent:!0,opacity:.8})]}),l.jsxs("mesh",{position:[-m/2,j/2,v.position[2]+(s==="2D"?.1:0)],children:[l.jsx("coneGeometry",{args:[.05,.2,3]}),l.jsx("meshBasicMaterial",{color:g.primary})]}),l.jsxs("mesh",{position:[v.position[0]-x/2,j/2,v.position[2]+(s==="2D"?.1:0)],rotation:[0,0,Math.PI],children:[l.jsx("coneGeometry",{args:[.05,.2,3]}),l.jsx("meshBasicMaterial",{color:g.primary})]}),l.jsx("group",{position:[(-m/2+v.position[0]-x/2)/2,j/2+.3,v.position[2]+(s==="2D"?.1:0)],children:a==="left"?l.jsx(Y0,{transform:!0,distanceFactor:10,position:[0,0,.1],style:{pointerEvents:"auto"},children:l.jsxs("div",{className:"column-distance-input",style:{background:"#ffffff",border:"2px solid #10b981",borderRadius:"8px",padding:"12px 16px",minWidth:"140px",boxShadow:"0 4px 20px rgba(16,185,129,0.3)",fontSize:"14px",fontFamily:"system-ui, -apple-system, sans-serif",color:"#000000"},onClick:E=>E.stopPropagation(),onMouseDown:E=>E.stopPropagation(),children:[l.jsx("div",{style:{color:"#10b981",fontSize:"12px",marginBottom:"8px",fontWeight:"600"},children:"왼쪽 간격 (mm)"}),l.jsx("input",{ref:d,type:"number",className:"column-distance-label-input",value:h,onChange:E=>u(E.target.value),onKeyDown:E=>{E.stopPropagation(),E.key==="Enter"&&F(),E.key==="Escape"&&B()},onClick:E=>E.stopPropagation(),onFocus:E=>E.stopPropagation(),onMouseDown:E=>E.stopPropagation(),style:{width:"100%",padding:"8px 12px",border:"2px solid #10b981",borderRadius:"6px",fontSize:"16px",textAlign:"center",fontFamily:"system-ui, -apple-system, sans-serif",fontWeight:"600",outline:"none",backgroundColor:"#ffffff",color:"#000000",WebkitTextFillColor:"#000000",opacity:1,WebkitAppearance:"none",MozAppearance:"textfield"},onBlur:()=>F(),autoFocus:!0,min:"0",step:"10"})]})}):l.jsxs(l.Fragment,{children:[l.jsxs("mesh",{position:[0,0,-.01],onClick:E=>{E.stopPropagation(),S("left",E)},onPointerOver:E=>{document.body.style.cursor="pointer"},onPointerOut:E=>{document.body.style.cursor="default"},children:[l.jsx("planeGeometry",{args:[2.8,1.2]}),l.jsx("meshBasicMaterial",{color:g.hoverBg,transparent:!0,opacity:.9})]}),l.jsxs("mesh",{position:[0,0,-.005],onClick:E=>{E.stopPropagation(),S("left",E)},children:[l.jsx("planeGeometry",{args:[2.6,1]}),l.jsx("meshBasicMaterial",{color:g.background,transparent:!0,opacity:.95})]}),l.jsx(zn,{position:[0,0,.2],fontSize:.8,color:"#000000",anchorX:"center",anchorY:"middle",outlineWidth:.1,outlineColor:"#ffffff",onClick:E=>{E.stopPropagation(),S("left",E)},onPointerOver:()=>{document.body.style.cursor="pointer"},onPointerOut:()=>{document.body.style.cursor="default"},children:Math.max(0,D)})]})})]}),l.jsxs("group",{children:[l.jsxs("mesh",{position:[(m/2+v.position[0]+x/2)/2,j/2,v.position[2]+(s==="2D"?.1:0)],children:[l.jsx("boxGeometry",{args:[Math.abs(m/2-(v.position[0]+x/2)),.02,.02]}),l.jsx("meshBasicMaterial",{color:g.primary,transparent:!0,opacity:.8})]}),l.jsxs("mesh",{position:[m/2,j/2,v.position[2]+(s==="2D"?.1:0)],rotation:[0,0,Math.PI],children:[l.jsx("coneGeometry",{args:[.05,.2,3]}),l.jsx("meshBasicMaterial",{color:g.primary})]}),l.jsxs("mesh",{position:[v.position[0]+x/2,j/2,v.position[2]+(s==="2D"?.1:0)],children:[l.jsx("coneGeometry",{args:[.05,.2,3]}),l.jsx("meshBasicMaterial",{color:g.primary})]}),l.jsx("group",{position:[(m/2+v.position[0]+x/2)/2,j/2+.3,v.position[2]+(s==="2D"?.1:0)],children:a==="right"?l.jsx(Y0,{transform:!0,distanceFactor:10,position:[0,0,.1],style:{pointerEvents:"auto"},children:l.jsxs("div",{className:"column-distance-input",style:{background:"#ffffff",border:"2px solid #10b981",borderRadius:"8px",padding:"12px 16px",minWidth:"140px",boxShadow:"0 4px 20px rgba(16,185,129,0.3)",fontSize:"14px",fontFamily:"system-ui, -apple-system, sans-serif",color:"#000000"},onClick:E=>E.stopPropagation(),onMouseDown:E=>E.stopPropagation(),children:[l.jsx("div",{style:{color:"#10b981",fontSize:"12px",marginBottom:"8px",fontWeight:"600"},children:"오른쪽 간격 (mm)"}),l.jsx("input",{ref:d,type:"number",className:"column-distance-label-input",value:h,onChange:E=>u(E.target.value),onKeyDown:E=>{E.stopPropagation(),E.key==="Enter"&&F(),E.key==="Escape"&&B()},onClick:E=>E.stopPropagation(),onFocus:E=>E.stopPropagation(),onMouseDown:E=>E.stopPropagation(),style:{width:"100%",padding:"8px 12px",border:"2px solid #10b981",borderRadius:"6px",fontSize:"16px",textAlign:"center",fontFamily:"system-ui, -apple-system, sans-serif",fontWeight:"600",outline:"none",backgroundColor:"#ffffff",color:"#000000",WebkitTextFillColor:"#000000",opacity:1,WebkitAppearance:"none",MozAppearance:"textfield"},onBlur:()=>F(),autoFocus:!0,min:"0",step:"10"})]})}):l.jsxs(l.Fragment,{children:[l.jsxs("mesh",{position:[0,0,-.01],onClick:E=>{E.stopPropagation(),S("right",E)},onPointerOver:E=>{document.body.style.cursor="pointer"},onPointerOut:E=>{document.body.style.cursor="default"},children:[l.jsx("planeGeometry",{args:[2.8,1.2]}),l.jsx("meshBasicMaterial",{color:g.hoverBg,transparent:!0,opacity:.9})]}),l.jsxs("mesh",{position:[0,0,-.005],onClick:E=>{E.stopPropagation(),S("right",E)},children:[l.jsx("planeGeometry",{args:[2.6,1]}),l.jsx("meshBasicMaterial",{color:g.background,transparent:!0,opacity:.95})]}),l.jsx(zn,{position:[0,0,.2],fontSize:.8,color:"#000000",anchorX:"center",anchorY:"middle",outlineWidth:.1,outlineColor:"#ffffff",onClick:E=>{E.stopPropagation(),S("right",E)},onPointerOver:()=>{document.body.style.cursor="pointer"},onPointerOut:()=>{document.body.style.cursor="default"},children:Math.max(0,b)})]})})]}),s==="3D"&&l.jsx("group",{position:[v.position[0],j+.8,v.position[2]],children:a==="width"?l.jsx(Y0,{transform:!0,distanceFactor:10,position:[0,0,.1],style:{pointerEvents:"auto"},children:l.jsxs("div",{className:"column-distance-input",style:{background:"#ffffff",border:"2px solid #10b981",borderRadius:"8px",padding:"12px 16px",minWidth:"140px",boxShadow:"0 4px 20px rgba(16,185,129,0.3)",fontSize:"14px",fontFamily:"system-ui, -apple-system, sans-serif",color:"#000000"},onClick:E=>E.stopPropagation(),onMouseDown:E=>E.stopPropagation(),children:[l.jsx("div",{style:{color:"#10b981",fontSize:"12px",marginBottom:"8px",fontWeight:"600"},children:"기둥 폭 (mm)"}),l.jsx("input",{ref:d,type:"number",className:"column-distance-label-input",value:h,onChange:E=>u(E.target.value),onKeyDown:E=>{E.stopPropagation(),E.key==="Enter"&&F(),E.key==="Escape"&&B()},onClick:E=>E.stopPropagation(),onFocus:E=>E.stopPropagation(),onMouseDown:E=>E.stopPropagation(),style:p,onBlur:()=>F(),autoFocus:!0,min:"800",max:"3000",step:"200"})]})}):l.jsxs(l.Fragment,{children:[l.jsxs("mesh",{position:[0,0,-.01],onClick:E=>{E.stopPropagation(),S("width",E)},onPointerOver:E=>{document.body.style.cursor="pointer"},onPointerOut:E=>{document.body.style.cursor="default"},children:[l.jsx("planeGeometry",{args:[2.8,1.2]}),l.jsx("meshBasicMaterial",{color:g.hoverBg,transparent:!0,opacity:.9})]}),l.jsxs("mesh",{position:[0,0,-.005],onClick:E=>{E.stopPropagation(),S("width",E)},children:[l.jsx("planeGeometry",{args:[2.6,1]}),l.jsx("meshBasicMaterial",{color:g.background,transparent:!0,opacity:.95})]}),l.jsx(zn,{position:[0,0,.2],fontSize:.8,color:"#000000",anchorX:"center",anchorY:"middle",outlineWidth:.1,outlineColor:"#ffffff",onClick:E=>{E.stopPropagation(),S("width",E)},onPointerOver:()=>{document.body.style.cursor="pointer"},onPointerOut:()=>{document.body.style.cursor="default"},children:v.width})]})}),f&&l.jsxs("group",{position:[v.position[0],j/2,v.position[2]+T/2+.1],children:[l.jsxs(zn,{fontSize:.4,color:"#000000",anchorX:"center",anchorY:"middle",rotation:[0,0,0],children:["D ",v.depth]}),l.jsxs("mesh",{position:[0,0,-.01],children:[l.jsx("planeGeometry",{args:[3,1]}),l.jsx("meshBasicMaterial",{color:g.background,transparent:!0,opacity:.95})]}),l.jsxs("mesh",{position:[0,0,-.005],children:[l.jsx("planeGeometry",{args:[3.2,1.2]}),l.jsx("meshBasicMaterial",{color:(o==null?void 0:o.mode)==="dark"?"#555555":"#cccccc",transparent:!0,opacity:.8})]})]}),s==="2D"&&f?l.jsxs("group",{position:[v.position[0],j+.8,v.position[2]],children:[l.jsx(zn,{fontSize:.5,color:"#000000",anchorX:"center",anchorY:"middle",rotation:[0,0,0],children:v.width}),l.jsxs("mesh",{position:[0,0,-.01],children:[l.jsx("planeGeometry",{args:[2.6,.9]}),l.jsx("meshBasicMaterial",{color:g.background,transparent:!0,opacity:.95})]}),l.jsxs("mesh",{position:[0,0,-.005],children:[l.jsx("planeGeometry",{args:[2.8,1.1]}),l.jsx("meshBasicMaterial",{color:g.primary,transparent:!0,opacity:.3})]})]}):null]})},F$=ii.memo(zhe),Ghe=({spaceInfo:n})=>{const[e,t]=O.useState(!1),[i,r]=O.useState(null),[s,o]=O.useState(null),[a,c]=O.useState({x:0,y:0}),[h,u]=O.useState([0,0,0]),{viewMode:d}=Qi(),{indexing:f}=Eg();if(O.useEffect(()=>{const x=b=>{var I;const _=(I=b.dataTransfer)==null?void 0:I.getData("application/json");if(_)try{const S=JSON.parse(_);S.type==="column"&&(t(!0),r(S),console.log("🏗️ 기둥 드래그 시작:",S))}catch(S){console.error("드래그 데이터 파싱 오류:",S)}},T=b=>{if(!e||!i)return;b.preventDefault(),c({x:b.clientX,y:b.clientY});const _=document.querySelector("canvas");if(!_)return;const I=_.getBoundingClientRect();if(b.clientX>=I.left&&b.clientX<=I.right&&b.clientY>=I.top&&b.clientY<=I.bottom){const F=_.getBoundingClientRect(),B=(b.clientX-F.left-F.width/2)/100;u([B,h[1],h[2]]),o(null)}else o(null)},j=()=>{t(!1),r(null),o(null),console.log("🏗️ 기둥 드래그 종료")},D=b=>{j()};return document.addEventListener("dragstart",x),document.addEventListener("dragover",T),document.addEventListener("dragend",j),document.addEventListener("drop",D),()=>{document.removeEventListener("dragstart",x),document.removeEventListener("dragover",T),document.removeEventListener("dragend",j),document.removeEventListener("drop",D)}},[e,i,n]),!e||!i||s===null||!(f!=null&&f.threeUnitPositions))return null;const A=f.threeUnitPositions[s],g=(n.depth||1500)*.01,p=(i.width||300)*.01,y=(i.height||2400)*.01,v=(i.depth||730)*.01,m=[A,0,-(g/2)+v/2],w=()=>{switch(i.material){case"concrete":return"#888888";case"steel":return"#B0B0B0";case"wood":return"#D2691E";default:return i.color||"#888888"}};return l.jsxs("group",{children:[l.jsxs("mesh",{position:m,children:[l.jsx("boxGeometry",{args:[p,y,v]}),l.jsx("meshBasicMaterial",{color:w(),transparent:!0,opacity:.4,wireframe:!1})]}),l.jsxs("lineSegments",{position:m,children:[l.jsx("edgesGeometry",{args:[new rh(p,y,v)]}),l.jsx("lineBasicMaterial",{color:"#4CAF50",linewidth:3})]}),l.jsxs("mesh",{position:[A,.01,0],rotation:[-Math.PI/2,0,0],children:[l.jsx("planeGeometry",{args:[p+.2,g]}),l.jsx("meshBasicMaterial",{color:"#4CAF50",transparent:!0,opacity:.2,side:Go})]}),l.jsxs("lineSegments",{position:[A,.02,0],children:[l.jsx("edgesGeometry",{args:[new GO(p+.2,g)]}),l.jsx("lineBasicMaterial",{color:"#4CAF50",linewidth:2})]}),d==="3D"&&l.jsxs("group",{position:[A,y+1,-(g/2)+.5],children:[l.jsxs("mesh",{children:[l.jsx("planeGeometry",{args:[2,.6]}),l.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:.9})]}),l.jsxs("mesh",{position:[0,0,.01],children:[l.jsx("planeGeometry",{args:[1.8,.4]}),l.jsx("meshBasicMaterial",{color:"#4CAF50"})]})]})]})},Xhe=({position:n,id:e,width:t=600,height:i=18,depth:r=730,color:s="#8B4513",renderMode:o="solid",onPositionChange:a,onRemove:c,spaceInfo:h})=>{var se;const u=O.useRef(null),[d,f]=O.useState(!1),A=O.useRef(!1),[g,p]=O.useState(!1),[y,v]=O.useState(null),[m,w]=O.useState(0),[x,T]=O.useState(!1),j=O.useRef(null),D=O.useRef(null),b=O.useRef(null),_=O.useRef(n),I=O.useRef(0),{viewMode:S}=Qi(),F=qi(),{selectedPanelBId:B,setSelectedPanelBId:E,openPanelBEditModal:V,openPanelBPopup:K,activePopup:P,view2DDirection:M,setFurnitureDragging:X}=Bi();(se=F.spaceInfo.panelBs)==null||se.find(te=>te.id===e);const{invalidate:Z}=jl();O.useEffect(()=>{d||(Z(),_.current=n)},[n,t,i,r,d,Z]);const Q=P.type==="panelBEdit"&&P.id===e,U=ii.useMemo(()=>{const te=Q?"#4CAF50":s;return new oo({color:new Yr(te),metalness:.1,roughness:.7,transparent:!0,opacity:1})},[s,Q]),z=ii.useMemo(()=>{let te="#333333";return Q?te="#4CAF50":d&&(te="#ff6b6b"),new zC({color:new Yr(te),linewidth:1})},[d,Q]),q=te=>{te.stopPropagation(),!(d||x||Date.now()-m>200)&&(E(e),K(e))},G=te=>{te.stopPropagation(),!(d||x)&&(E(e),V(e))},ie=te=>{te.stopPropagation(),w(Date.now()),T(!1),v(te.point);const fe=te.nativeEvent.clientX,ye=5,be=16,_e=((h==null?void 0:h.width)||3e3)*.005,W=t*.005,Y=-_e+W,ve=_e-W;j.current||(j.current=document.querySelector("canvas"));const ce=he=>{const xe=he.clientX;if(Math.abs(xe-fe)>ye&&!A.current&&(T(!0),f(!0),A.current=!0,X(!0),window.dispatchEvent(new CustomEvent("furniture-drag-start"))),!A.current)return;const Ce=Date.now();if(Ce-I.current<be||(I.current=Ce,!j.current))return;D.current||(D.current=j.current.getBoundingClientRect());const Be=D.current,ot=((he.clientX-Be.left)/Be.width*2-1)*_e,rt=Math.max(Y,Math.min(ve,ot));_.current=[rt,n[1],n[2]],a&&!isNaN(rt)&&(b.current&&cancelAnimationFrame(b.current),b.current=requestAnimationFrame(()=>{a(e,_.current),b.current=null}))},ne=()=>{A.current&&(X(!1),window.dispatchEvent(new CustomEvent("furniture-drag-end"))),f(!1),A.current=!1,v(null),T(!1),document.removeEventListener("pointermove",ce),document.removeEventListener("pointerup",ne),D.current=null,b.current&&(cancelAnimationFrame(b.current),b.current=null)};document.addEventListener("pointermove",ce,{passive:!0}),document.addEventListener("pointerup",ne)},H=te=>{te.stopPropagation(),window.confirm("패널B를 삭제하시겠습니까?")&&(c==null||c(e))};return l.jsx("group",{position:n,children:S==="2D"?l.jsxs("group",{position:[0,i*.01/2,0],children:[l.jsxs("mesh",{onClick:q,onDoubleClick:G,onPointerDown:ie,onPointerEnter:()=>p(!0),onPointerLeave:()=>p(!1),onContextMenu:H,userData:{isPanelB:!0,panelBId:e},children:[l.jsx("boxGeometry",{args:[t*.01,i*.01,r*.01]}),l.jsx("meshBasicMaterial",{transparent:!0,opacity:0})]}),l.jsxs("mesh",{children:[l.jsx("boxGeometry",{args:[t*.01,i*.01,r*.01]}),l.jsx("meshBasicMaterial",{color:Q?"#c8e6c9":"#f5deb3",transparent:!0,opacity:.8})]}),l.jsxs("lineSegments",{children:[l.jsx("edgesGeometry",{args:[new rh(t*.01,i*.01,r*.01)]}),l.jsx("lineBasicMaterial",{color:Q?"#4CAF50":"#8B4513"})]}),(()=>{const te=Q?"#4CAF50":"#8B4513",fe=t*.01,ye=i*.01,be=r*.01,_e=[];switch(M){case"front":for(let W=0;W<3;W++){const Y=-fe/2+(W+1)*fe/4;_e.push(l.jsx(it,{points:[[Y,-ye/2,be/2+.001],[Y,ye/2,be/2+.001]],color:te,lineWidth:.5},`front-line-${W}`))}break;case"top":for(let W=0;W<3;W++){const Y=-fe/2+(W+1)*fe/4;_e.push(l.jsx(it,{points:[[Y,ye/2+.001,-be/2],[Y,ye/2+.001,be/2]],color:te,lineWidth:.5},`top-line-${W}`))}break;case"left":case"right":for(let W=0;W<3;W++){const Y=-be/2+(W+1)*be/4;_e.push(l.jsx(it,{points:[[fe/2+.001,-ye/2,Y],[fe/2+.001,ye/2,Y]],color:te,lineWidth:.5},`side-line-${W}`))}break}return _e})()]}):o==="wireframe"?l.jsxs("group",{position:[0,i*.01/2,0],children:[l.jsxs("mesh",{onClick:q,onDoubleClick:G,onPointerDown:ie,onPointerEnter:()=>p(!0),onPointerLeave:()=>p(!1),onContextMenu:H,userData:{isPanelB:!0,panelBId:e},children:[l.jsx("boxGeometry",{args:[t*.01,i*.01,r*.01]}),l.jsx("meshBasicMaterial",{transparent:!0,opacity:0})]}),l.jsxs("lineSegments",{children:[l.jsx("edgesGeometry",{args:[new rh(t*.01,i*.01,r*.01)]}),l.jsx("primitive",{object:z})]})]}):l.jsx("mesh",{ref:u,material:U,receiveShadow:S==="3D",castShadow:S==="3D",onClick:q,onDoubleClick:G,onPointerDown:ie,onPointerEnter:()=>p(!0),onPointerLeave:()=>p(!1),onContextMenu:H,position:[0,i*.01/2,0],userData:{isPanelB:!0,panelBId:e},scale:d?[.95,.95,.95]:[1,1,1],children:l.jsx("boxGeometry",{args:[t*.01,i*.01,r*.01]})})})},Khe=ii.memo(Xhe,(n,e)=>{var t,i,r,s,o,a;return n.position[0]===e.position[0]&&n.position[1]===e.position[1]&&n.position[2]===e.position[2]&&n.width===e.width&&n.height===e.height&&n.depth===e.depth&&n.color===e.color&&n.id===e.id&&n.renderMode===e.renderMode&&((t=n.spaceInfo)==null?void 0:t.width)===((i=e.spaceInfo)==null?void 0:i.width)&&((r=n.spaceInfo)==null?void 0:r.depth)===((s=e.spaceInfo)==null?void 0:s.depth)&&((o=n.spaceInfo)==null?void 0:o.height)===((a=e.spaceInfo)==null?void 0:a.height)}),qhe=({spaceInfo:n})=>{const{isPanelBCreationMode:e}=Bi(),{addPanelB:t}=qi(),{indexing:i}=Eg(),{viewMode:r}=Qi(),{camera:s,raycaster:o,gl:a}=jl(),[c,h]=O.useState(null),[u,d]=O.useState(!1);if(O.useEffect(()=>{if(!e||!a.domElement)return;const y=m=>{const x=a.domElement.getBoundingClientRect(),T=(m.clientX-x.left)/x.width*2-1,j=-((m.clientY-x.top)/x.height)*2+1;o.setFromCamera(new yf(T,j),s);const D=new O2(new so(0,1,0),-0),b=new so;if(o.ray.intersectPlane(D,b),b){const _=((n==null?void 0:n.width)||3e3)*.01,I=((n==null?void 0:n.depth)||1500)*.01,S=730*.01,F=600*.01,B=-(I/2)+S/2,E=Math.max(-_/2+F/2,Math.min(_/2-F/2,b.x));h([E,0,B]),d(!0)}},v=()=>{d(!1),h(null)};return canvas.addEventListener("mousemove",y),canvas.addEventListener("mouseleave",v),()=>{canvas.removeEventListener("mousemove",y),canvas.removeEventListener("mouseleave",v)}},[e,s,o,a,n]),!e)return null;const f=()=>{if(!(n!=null&&n.width))return[];const y=n.width*.001,v=[],m=4;for(let w=1;w<m;w++){const x=-y/2+y/m*w;v.push(x)}return v},A=y=>{const v=y||c;if(!v)return;const m={id:`panelB-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,position:v,width:600,height:18,depth:730,color:"#8B4513",material:"wood",orientation:"horizontal"};console.log("🪵 새 패널B 생성:",m),t(m)},g=y=>{y.stopPropagation(),c&&A()},p=f();return p.length===0?null:l.jsxs("group",{children:[l.jsxs("mesh",{position:[0,0,0],onPointerMove:y=>y.stopPropagation(),onClick:g,children:[l.jsx("boxGeometry",{args:[((n==null?void 0:n.width)||3e3)*.01,.01,((n==null?void 0:n.depth)||1500)*.01]}),l.jsx("meshBasicMaterial",{transparent:!0,opacity:0})]}),c&&u&&l.jsxs("group",{position:c,children:[l.jsxs("mesh",{position:[0,.009,0],children:[l.jsx("boxGeometry",{args:[600*.01,18*.01,730*.01]}),l.jsx("meshStandardMaterial",{color:"#f59e0b",transparent:!0,opacity:.5,emissive:"#f59e0b",emissiveIntensity:.2})]}),l.jsxs("lineSegments",{position:[0,.009,0],children:[l.jsx("edgesGeometry",{args:[new rh(600*.01,18*.01,730*.01)]}),l.jsx("lineBasicMaterial",{color:"#f59e0b",linewidth:2})]}),l.jsxs("mesh",{position:[0,.01,0],rotation:[-Math.PI/2,0,0],children:[l.jsx("circleGeometry",{args:[.5,32]}),l.jsx("meshBasicMaterial",{color:"#f59e0b",transparent:!0,opacity:.8})]})]}),p.map((y,v)=>l.jsxs("group",{position:[y,0,0],children:[l.jsxs("mesh",{position:[0,.5,0],onClick:m=>{m.stopPropagation(),console.log("🎯 + 아이콘 클릭됨 (패널B):",y);const w=-((n==null?void 0:n.depth)||1500)*.01/2+730*.01/2;A([y,0,w])},children:[l.jsx("boxGeometry",{args:[1,1,1]}),l.jsx("meshBasicMaterial",{color:"#f59e0b",transparent:!0,opacity:.2,wireframe:!1})]}),l.jsxs("mesh",{position:[0,.5,.1],onClick:m=>{m.stopPropagation(),console.log("🎯 + 배경 클릭됨 (패널B):",y);const w=-((n==null?void 0:n.depth)||1500)*.01/2+730*.01/2;A([y,0,w])},children:[l.jsx("planeGeometry",{args:[.8,.8]}),l.jsx("meshBasicMaterial",{color:"#f59e0b",transparent:!0,opacity:.8,side:2})]}),l.jsx(zn,{position:[0,.5,.11],fontSize:.5,color:"#ffffff",anchorX:"center",anchorY:"middle",onClick:m=>{m.stopPropagation(),console.log("🎯 + 텍스트 클릭됨 (패널B):",y);const w=-((n==null?void 0:n.depth)||1500)*.01/2+730*.01/2;A([y,0,w])},children:"+"}),l.jsxs("mesh",{position:[0,.05,0],rotation:[-Math.PI/2,0,0],onClick:m=>{m.stopPropagation(),console.log("🎯 바닥 원 클릭됨 (패널B):",y);const w=-((n==null?void 0:n.depth)||1500)*.01/2+730*.01/2;A([y,0,w])},children:[l.jsx("circleGeometry",{args:[.4,32]}),l.jsx("meshBasicMaterial",{color:"#dc2626",transparent:!0,opacity:.7,side:2})]}),l.jsxs("mesh",{position:[0,.25,0],onClick:m=>{m.stopPropagation(),console.log("🎯 가이드 라인 클릭됨 (패널B):",y);const w=-((n==null?void 0:n.depth)||1500)*.01/2+730*.01/2;A([y,0,w])},children:[l.jsx("boxGeometry",{args:[.05,.5,.05]}),l.jsx("meshBasicMaterial",{color:"#f59e0b",transparent:!0,opacity:.8})]})]},`panelB-marker-${v}`))]})},n3=({columnIndex:n,columnWidth:e,position:t,internalSpace:i,customHeight:r})=>{const s=r?r*.01:i.height*.01,o=e*.01,a=i.depth*.01;return l.jsx("mesh",{position:[t.x,t.y+s/2,t.z],userData:{columnIndex:n,isDropTarget:!0},visible:!1,children:l.jsx("boxGeometry",{args:[o,s,a]})})},D$=({viewMode:n,view2DDirection:e})=>{var fe,ye,be,_e,W,Y,ve,ce;const{spaceInfo:t}=qi(),{viewMode:i,showDimensions:r,view2DDirection:s,activeDroppedCeilingTab:o,setActiveDroppedCeilingTab:a,view2DTheme:c}=Bi(),{placedModules:h}=ci(),u=n||i,d=e||s,{theme:f}=Yh();O.useEffect(()=>{console.log("🔍 현재 activeDroppedCeilingTab:",o)},[o]);const A=((fe=t.droppedCeiling)==null?void 0:fe.enabled)||!1,g=kr(t),p=ur(t),{columnCount:y,threeUnitBoundaries:v}=p,m=A&&t.droppedCeiling?t.height-t.droppedCeiling.dropHeight:t.height,x=(()=>{var Te,Ce;if(!A)return g.height;const ne=t.hasFloorFinish&&t.floorFinish?t.floorFinish.height:0,he=((Te=t.baseConfig)==null?void 0:Te.height)||0,xe=((Ce=t.frameSize)==null?void 0:Ce.top)||0;return m-ne-he-xe})(),T=A&&t.droppedCeiling?t.droppedCeiling.width:0,j=((ye=t.droppedCeiling)==null?void 0:ye.position)==="left",D=((be=t.frameSize)==null?void 0:be.top)||0;console.log("🏗️ 단내림 정보:",{hasDroppedCeiling:A,droppedTotalHeight:m,droppedInternalHeight:x,"internalSpace.height":g.height,"internalSpace.startY":g.startY,"spaceInfo.height":t.height,"spaceInfo.droppedCeiling?.dropHeight":(_e=t.droppedCeiling)==null?void 0:_e.dropHeight,topFrameHeight:D,"계산된 droppedInternalHeight":x,"예상 천장 위치 (droppedTotalHeight - topFrameHeight)":m-D,droppedWidth:T,isLeftDropped:j});const b=ii.useMemo(()=>{const ne=wr.calculateZoneSlotInfo(t,t.customColumnCount),he=ur(t);return console.log("🔍 ColumnGuides - 슬롯 정보 비교:",{전체인덱싱:{내경시작X:he.internalStartX,내경너비:he.internalWidth,슬롯너비:he.columnWidth},영역별정보:{메인:{시작X:ne.normal.startX,너비:ne.normal.width,끝X:ne.normal.startX+ne.normal.width,슬롯너비:ne.normal.columnWidth,slotWidths:ne.normal.slotWidths,"🎯 Three.js 단위":{시작X_three:ne.normal.startX*.01,끝X_three:(ne.normal.startX+ne.normal.width)*.01,중심X_three:(ne.normal.startX+ne.normal.width/2)*.01}},단내림:ne.dropped?{시작X:ne.dropped.startX,너비:ne.dropped.width,끝X:ne.dropped.startX+ne.dropped.width,슬롯너비:ne.dropped.columnWidth,slotWidths:ne.dropped.slotWidths}:null},갭체크:ne.dropped?{"메인끝-단내림시작":ne.dropped.startX-(ne.normal.startX+ne.normal.width)}:null,"spaceInfo.surroundType":t.surroundType,"spaceInfo.installType":t.installType}),ne},[t,t.customColumnCount,t.mainDoorCount,t.droppedCeilingDoorCount]);if(ii.useEffect(()=>{var ne;console.log("🎯 ColumnGuides - 슬롯 정보 업데이트:",{customColumnCount:t.customColumnCount,mainDoorCount:t.mainDoorCount,droppedCeilingDoorCount:t.droppedCeilingDoorCount,hasDroppedCeiling:(ne=t.droppedCeiling)==null?void 0:ne.enabled,zoneSlotInfo:{normal:b.normal?{columnCount:b.normal.columnCount,columnWidth:b.normal.columnWidth,width:b.normal.width}:null,dropped:b.dropped?{columnCount:b.dropped.columnCount,columnWidth:b.dropped.columnWidth,width:b.dropped.width}:null}})},[t.customColumnCount,t.mainDoorCount,t.droppedCeilingDoorCount,t.droppedCeiling,b]),y<=1&&!A)return null;const _=ne=>ne*.01;((W=t.baseConfig)==null?void 0:W.type)==="stand"&&((Y=t.baseConfig)==null||Y.placementType);const I=t.hasFloorFinish&&t.floorFinish?t.floorFinish.height:0,S=((ve=t.baseConfig)==null?void 0:ve.height)||0,F=(I+S)*.01,V=((ne,he)=>typeof window<"u"&&getComputedStyle(document.documentElement).getPropertyValue(ne).trim()||he)("--theme-primary","#10b981"),K=u==="2D"?.3:.5,P=_(g.startY),M=_(t.height-D),X=A?_(m-D):M;console.log("📏 높이 계산:",{"전체 높이 (mm)":t.height,"단차 (mm)":(ce=t.droppedCeiling)==null?void 0:ce.dropHeight,"단내림 전체 높이 (mm)":m,"상부프레임 (mm)":D,"단내림 천장 위치 (mm)":m-D,"Three.js 단위":{floorY:P,ceilingY:M,droppedCeilingY:X,furnitureStartY:F}}),A&&(j?v[0]+_(T):v[v.length-1]-_(T));const Z=t.depth||1500,Q=600,q=-_(Z)/2+(_(Z)-_(Q))/2+_(Q)/2,G=-_(g.depth/2),ie=q-_(18);oa(t);const H=(ne,he)=>h.some(xe=>he==="dropped"&&xe.isDroppedZone||he==="normal"&&!xe.isDroppedZone||he==="full"?xe.columnIndex===ne:!1),se=(ne,he,xe,Te,Ce,Be,Ye)=>{var Le;console.log("📐 renderSlotGuides 호출됨:",{zoneType:Be,startX:ne,width:he,endX:ne+he,columnCount:xe,columnWidth:Te,ceilingY:Ce,floorY:P,backZ:G,frontZ:ie,"spaceInfo.mainDoorCount":t.mainDoorCount,"spaceInfo.customColumnCount":t.customColumnCount,hasDroppedCeiling:A,"spaceInfo.surroundType":t.surroundType,"spaceInfo.installType":t.installType,"spaceInfo.wallConfig":t.wallConfig,slotWidths:Ye});const $e=[],ot=u==="2D"&&c==="dark"?"#FFFFFF":V,rt=K,Ve=1,We=[];let De=ne;if(We.push(_(De)),Ye&&Ye.length===xe){console.log("📏 slotWidths 사용하여 경계 계산:",{startX:ne,slotWidths:Ye,totalWidth:Ye.reduce((et,ct)=>et+ct,0)});for(let et=0;et<xe;et++)De+=Ye[et],We.push(_(De))}else{console.log("📏 균등 분할로 경계 계산:",{startX:ne,width:he,columnCount:xe,columnWidth:Te});for(let et=1;et<=xe;et++)et===xe?We.push(_(ne+he)):We.push(_(ne+et*Te))}console.log("📏 최종 경계:",{firstBoundary:We[0],lastBoundary:We[We.length-1],totalBoundaries:We.length,expectedEndX:_(ne+he),actualEndX:We[We.length-1],"엔드패널 체크":{surroundType:t.surroundType,installType:t.installType,wallConfig:t.wallConfig,"우측 엔드패널 있음":t.surroundType==="no-surround"&&(t.installType==="semistanding"||t.installType==="semi-standing")&&!((Le=t.wallConfig)!=null&&Le.right)}});const Ge=[];for(let et=0;et<xe;et++){const ct=We[et],mt=We[et+1],je=(ct+mt)/2;Ge.push(je)}console.log(`📏 ${Be} 영역 경계:`,{startX_mm:ne,endX_mm:ne+he,width_mm:he,boundaries_three:[We[0],We[We.length-1]],expectedEndX_three:_(ne+he),actualEndX_three:We[We.length-1],반올림오차_mm:he-Te*xe,마지막슬롯너비_mm:xe>0?ne+he-(ne+(xe-1)*Te):0});const Re=_(g.startX),Ie=_(g.startX+g.width);if(We.length>=2){const et=_(ne),ct=_(ne+he);console.log(`📐 ${Be} 수평 가이드 범위:`,{시작X_mm:ne,끝X_mm:ne+he,시작X_three:et,끝X_three:ct,내경시작_three:Re,내경끝_three:Ie,프레임정보:t.frameSize});const mt=et,je=ct;if($e.push(l.jsx(it,{points:[new so(mt,P,G),new so(je,P,G)],color:ot,lineWidth:rt,dashed:!0,dashSize:.15,gapSize:.15,opacity:Ve,transparent:!0},`${Be}-floor-horizontal`)),u==="3D"||u==="2D"&&d==="top"){const le=ie-G,Je=(ie+G)/2;for(let ht=0;ht<xe;ht++){if(H(ht,Be))continue;const ut=We[ht],ft=We[ht+1],jt=ft-ut,Wt=(ut+ft)/2;$e.push(l.jsxs("mesh",{position:[Wt,P+.001,Je],renderOrder:-1,frustumCulled:!1,children:[l.jsx("boxGeometry",{args:[jt,.002,le]}),l.jsx("meshBasicMaterial",{color:V,transparent:!0,opacity:u==="2D"?.05:.1,side:Go,depthWrite:!1,depthTest:!0})]},`${Be}-floor-mesh-${ht}`))}}if($e.push(l.jsx(it,{points:[new so(mt,Ce,G),new so(je,Ce,G)],color:ot,lineWidth:rt,dashed:!0,dashSize:.15,gapSize:.15,opacity:Ve,transparent:!0},`${Be}-ceiling-horizontal`)),u==="3D"){const le=ie-G,Je=(ie+G)/2;for(let ht=0;ht<xe;ht++){if(H(ht,Be))continue;const ut=We[ht],ft=We[ht+1],jt=ft-ut,Wt=(ut+ft)/2;$e.push(l.jsxs("mesh",{position:[Wt,Ce-.001,Je],renderOrder:-1,frustumCulled:!1,children:[l.jsx("boxGeometry",{args:[jt,.002,le]}),l.jsx("meshBasicMaterial",{color:V,transparent:!0,opacity:.1,side:Go,depthWrite:!1,depthTest:!0})]},`${Be}-ceiling-mesh-${ht}`))}}if(u==="3D"||u==="2D"&&d==="front"){const le=Ce-P,Je=(P+Ce)/2;for(let ht=0;ht<xe;ht++){if(H(ht,Be))continue;const ut=We[ht],ft=We[ht+1],jt=ft-ut,Wt=(ut+ft)/2;$e.push(l.jsxs("mesh",{position:[Wt,Je,G+.001],renderOrder:-1,frustumCulled:!1,children:[l.jsx("boxGeometry",{args:[jt,le,.002]}),l.jsx("meshBasicMaterial",{color:V,transparent:!0,opacity:u==="2D"?.05:.1,side:Go,depthWrite:!1,depthTest:!0})]},`${Be}-back-wall-mesh-${ht}`))}}}return We.forEach((et,ct)=>{if(u==="2D"&&d==="top"){const mt=Be==="dropped"?(P+Ce)/2:P+_(g.height/2);$e.push(l.jsx(it,{points:[new so(et,mt,G),new so(et,mt,ie)],color:ot,lineWidth:rt,dashed:!0,dashSize:.2,gapSize:.1,opacity:Ve,transparent:!0},`${Be}-horizontal-guide-top-${ct}`))}else $e.push(l.jsx(it,{points:[new so(et,P,G),new so(et,Ce,G)],color:ot,lineWidth:rt,dashed:!0,dashSize:.2,gapSize:.1,opacity:Ve,transparent:!0},`${Be}-vertical-guide-${ct}`)),u==="3D"&&($e.push(l.jsx(it,{points:[new so(et,P,G),new so(et,P,ie)],color:ot,lineWidth:rt,dashed:!0,dashSize:.2,gapSize:.1,opacity:Ve,transparent:!0},`${Be}-z-guide-floor-${ct}`)),$e.push(l.jsx(it,{points:[new so(et,Ce,G),new so(et,Ce,ie)],color:ot,lineWidth:rt,dashed:!0,dashSize:.2,gapSize:.1,opacity:Ve,transparent:!0},`${Be}-z-guide-ceiling-${ct}`)))}),r&&Ge.forEach((et,ct)=>{const mt=Ye&&Ye[ct]?Ye[ct]:Te;let je,le;if(u==="2D"&&d==="top"){const Je=(ie+G)/2;je=[et,P+.1,Je],le=[-Math.PI/2,0,0]}else{const Je=P+_(g.height/2),ht=G+.5;je=[et,Je,ht],le=[0,0,0]}$e.push(l.jsxs(zn,{position:je,fontSize:.5,color:ot,anchorX:"center",anchorY:"middle",rotation:le,children:[Math.round(mt),"mm"]},`${Be}-slot-size-${ct}`))}),console.log(`📐 ${Be} 영역 가이드 개수:`,$e.length),console.log("🔴 guides 배열 내용:",$e.map(et=>et.key)),$e};console.log("🏗️ ColumnGuides 렌더링:",{hasDroppedCeiling:A,activeDroppedCeilingTab:o,"zoneSlotInfo.dropped":b.dropped,"zoneSlotInfo.normal":b.normal,showDimensions:r,viewMode:u,"spaceInfo.mainDoorCount":t.mainDoorCount,"spaceInfo.customColumnCount":t.customColumnCount,columnCount:y});const te=()=>null;return l.jsxs("group",{children:[A&&b.dropped?l.jsxs(l.Fragment,{children:[se(b.normal.startX,b.normal.width,b.normal.columnCount,b.normal.columnWidth,M,"main",b.normal.slotWidths),se(b.dropped.startX,b.dropped.width,b.dropped.columnCount,b.dropped.columnWidth,X,"dropped",b.dropped.slotWidths),(u==="3D"||u==="2D"&&d!=="top")&&l.jsxs(l.Fragment,{children:[te(b.normal.startX,b.normal.width),(u==="3D"||u==="2D"&&d==="top")&&te(b.normal.startX,b.normal.width),te(b.dropped.startX,b.dropped.width),(u==="3D"||u==="2D"&&d==="top")&&te(b.dropped.startX,b.dropped.width)]})]}):l.jsxs(l.Fragment,{children:[se(b.normal.startX,b.normal.width,b.normal.columnCount,b.normal.columnWidth,M,"full",b.normal.slotWidths),(u==="3D"||u==="2D"&&d!=="top")&&l.jsxs(l.Fragment,{children:[te(b.normal.startX,b.normal.width),(u==="3D"||u==="2D"&&d==="top")&&te(b.normal.startX,b.normal.width)]})]}),A&&b.dropped?l.jsxs(l.Fragment,{children:[o==="main"&&Array.from({length:b.normal.columnCount},(ne,he)=>{var Ce;let xe;if(b.normal.slotWidths){let Be=b.normal.startX;for(let ot=0;ot<he;ot++)Be+=b.normal.slotWidths[ot];const Ye=Be,$e=Ye+b.normal.slotWidths[he];xe=(Ye+$e)/2}else xe=b.normal.startX+he*b.normal.columnWidth+b.normal.columnWidth/2;const Te=((Ce=b.normal.slotWidths)==null?void 0:Ce[he])||b.normal.columnWidth;return l.jsx(n3,{columnIndex:he,columnWidth:Te,position:{x:_(xe),y:F,z:0},internalSpace:g},`main-column-${he}`)}),o==="dropped"&&Array.from({length:b.dropped.columnCount},(ne,he)=>{var Ce;let xe;if(b.dropped.slotWidths){let Be=b.dropped.startX;for(let ot=0;ot<he;ot++)Be+=b.dropped.slotWidths[ot];const Ye=Be,$e=Ye+b.dropped.slotWidths[he];xe=(Ye+$e)/2}else xe=b.dropped.startX+he*b.dropped.columnWidth+b.dropped.columnWidth/2;const Te=((Ce=b.dropped.slotWidths)==null?void 0:Ce[he])||b.dropped.columnWidth;return l.jsx(n3,{columnIndex:he,columnWidth:Te,position:{x:_(xe),y:F,z:0},internalSpace:g,customHeight:x},`dropped-column-${he}`)})]}):Array.from({length:b.normal.columnCount},(ne,he)=>{var Ce;let xe;if(b.normal.slotWidths){let Be=b.normal.startX;for(let ot=0;ot<he;ot++)Be+=b.normal.slotWidths[ot];const Ye=Be,$e=Ye+b.normal.slotWidths[he];xe=(Ye+$e)/2}else xe=b.normal.startX+he*b.normal.columnWidth+b.normal.columnWidth/2;const Te=((Ce=b.normal.slotWidths)==null?void 0:Ce[he])||b.normal.columnWidth;return l.jsx(n3,{columnIndex:he,columnWidth:Te,position:{x:_(xe),y:F,z:0},internalSpace:g},`column-${he}`)})]})},zb=n=>{var o;if(!((o=n.droppedCeiling)!=null&&o.enabled))return null;const{position:e}=n.droppedCeiling,t=n.droppedCeiling.width||yo.WIDTH,i=n.droppedCeiling.dropHeight||200,r=-(n.width/2);let s;return e==="left"?s=r:s=r+(n.width-t),{startX:s,endX:s+t,width:t,height:n.height-i}},i3=n=>{var o;const e=-(n.width/2);if(!((o=n.droppedCeiling)!=null&&o.enabled))return{startX:e,endX:e+n.width,width:n.width,height:n.height};const{position:t}=n.droppedCeiling,i=n.droppedCeiling.width||yo.WIDTH,r=n.width-i;let s;return t==="left"?s=e+i:s=e,{startX:s,endX:s+r,width:r,height:n.height}},j$=({viewDirection:n,showDimensions:e,showFurniture:t=!0,isStep2:i})=>{var ne,he,xe,Te,Ce,Be,Ye,$e,ot;const{spaceInfo:r}=qi(),{placedModules:s}=ci(),{view2DDirection:o,showDimensions:a,showDimensionsText:c,view2DTheme:h}=Bi(),u=e!==void 0?e:a;console.log("🎯 CleanCAD2D 전체 렌더링:",{showDimensionsProp:e,showDimensionsFromStore:a,showDimensions:u,viewDirection:n,isStep2:i,surroundType:r.surroundType,installType:r.installType,wallConfig:r.wallConfig,좌우치수표시조건:!i});const{updateColumn:d}=qi(),f=O.useRef(null),{theme:A}=Yh(),{colors:g}=fI(),[p,y]=O.useState(null),[v,m]=O.useState(null),[w,x]=O.useState(""),T=O.useRef(null);O.useEffect(()=>{if(p&&v&&T.current){const rt=setTimeout(()=>{T.current&&(T.current.focus(),T.current.select(),T.current.click())},200);return()=>clearTimeout(rt)}},[p,v]);const j=n||o,D=(rt,Ve)=>typeof window<"u"&&getComputedStyle(document.documentElement).getPropertyValue(rt).trim()||Ve,b=D("--theme-primary","#10b981"),_=j==="3D"?"#666666":h==="dark"?"#ffffff":"#000000",I=j==="3D"?"#666666":h==="dark"?"#ffffff":"#000000",S=j==="3D"?"#cccccc":h==="dark"?"#888888":"#666666";j==="3D"||D("--theme-border","#e5e7eb");const F=b,B=rt=>rt*.01;B(r.width);const E=B(r.height),V=ii.useMemo(()=>s.length===0?null:s.map((rt,Ve)=>{var At,zt,Zt;const We=Hi(rt.moduleId,{width:r.width,height:r.height,depth:r.depth},r);if(!We)return null;const De=((At=r.droppedCeiling)==null?void 0:At.enabled)||!1,Ge=((zt=r.droppedCeiling)==null?void 0:zt.width)||0,Re=((Zt=r.droppedCeiling)==null?void 0:Zt.position)||"right",Ie=Rc(r),Le=rt.slotIndex!==void 0?Ie[rt.slotIndex]:void 0;ur(r);const et=rt.customWidth||rt.adjustedWidth||We.dimensions.width,ct=rt.position.x,mt=rt.customDepth||We.dimensions.depth,je=rt.customDepth&&rt.customDepth!==We.dimensions.depth,le=ct,Je=E/2,ht=le-et/2,ut=le+et/2,ft=Re==="left"?-(r.width*.01)/2:r.width*.01/2-Ge*.01,jt=Re==="left"?-(r.width*.01)/2+Ge*.01:r.width*.01/2,dn=We.name&&We.name.includes("스페이서")&&et===36;let on=0,Et=0;if(Le&&Le.wallPositions)on=Math.abs(ht*100-Le.wallPositions.left),Et=Math.abs(Le.wallPositions.right-ut*100);else{const $t=ht*100,Ht=ut*100;on=Math.abs($t- -r.width/2),Et=Math.abs(r.width/2-Ht)}let an=0,Mn=0;if(De){const $t=Re==="left"?jt:ft;Re==="left"?an=Math.abs((ht-$t)*100):Mn=Math.abs(($t-ut)*100)}return{module:rt,moduleData:We,actualWidth:et,actualDepth:mt,hasCustomDepth:je,moduleX:le,moduleY:Je,moduleLeft:ht,moduleRight:ut,nearestLeftDistance:on,nearestRightDistance:Et,leftBoundaryDistance:an,rightBoundaryDistance:Mn,isSpacerHandled:dn,hasStepDown:De,stepDownPosition:Re}}).filter(Boolean),[s,j,r,E,JSON.stringify(s.map(rt=>({id:rt.id,adjustedWidth:rt.adjustedWidth,customWidth:rt.customWidth,position:rt.position})))]);O.useEffect(()=>{f.current&&(f.current.renderOrder=999999,f.current.traverse(rt=>{"material"in rt&&rt.material&&(rt.renderOrder=999999,rt.material instanceof KY&&(rt.material.depthTest=!1,rt.material.depthWrite=!1,rt.material.needsUpdate=!0))}))},[j,u,s.length,JSON.stringify(s.map(rt=>({id:rt.id,moduleId:rt.moduleId,customDepth:rt.customDepth,position:rt.position}))),JSON.stringify((ne=r.columns)==null?void 0:ne.map(rt=>({id:rt.id,position:rt.position,width:rt.width,height:rt.height,depth:rt.depth})))]);const K=.4,P=.5,M=.35,X=ur(r),{threeUnitBoundaries:Z,columnCount:Q}=X,U=s.length>0,z=j==="3D",q=(he=r.droppedCeiling)==null?void 0:he.enabled,G=E+B(q?U?z?430:360:z?350:280:U?z?350:280:z?270:200),ie=-B(z?250:200),H=-B(r.width/2),se=r.frameSize||{left:50,right:50,top:50};console.log("🔍 CleanCAD2D Debug:",{spaceWidth:r.width,droppedCeilingEnabled:(xe=r.droppedCeiling)==null?void 0:xe.enabled,droppedCeilingWidth:(Te=r.droppedCeiling)==null?void 0:Te.width,droppedCeilingPosition:(Ce=r.droppedCeiling)==null?void 0:Ce.position,frameSize:se,leftOffset:H,normalBoundsWidth:r.width-(((Be=r.droppedCeiling)==null?void 0:Be.width)||0),droppedBoundsWidth:((Ye=r.droppedCeiling)==null?void 0:Ye.width)||0});const te=(rt,Ve,We=.015)=>{const De=new so(Ve[0]-rt[0],Ve[1]-rt[1],Ve[2]-rt[2]).normalize(),Ge=new so(-De.y,De.x,0).multiplyScalar(We);return[[rt[0]+De.x*We+Ge.x,rt[1]+De.y*We+Ge.y,rt[2]],rt,[rt[0]+De.x*We-Ge.x,rt[1]+De.y*We-Ge.y,rt[2]]]},fe=()=>{if(!u||!c)return null;switch(j){case"3D":case"front":return _e();case"left":return W();case"right":return Y();case"top":return ve();default:return _e()}},be=z?0:0,_e=()=>{var rt,Ve,We;return l.jsx("group",{position:[0,0,be],renderOrder:9999,children:l.jsxs(l.Fragment,{children:[l.jsxs("group",{children:[l.jsx(it,{points:[[H,G,.002],[B(r.width)+H,G,.002]],color:_,lineWidth:1}),l.jsx(it,{points:te([H,G,.002],[H+.05,G,.002]),color:_,lineWidth:1}),l.jsx(it,{points:te([B(r.width)+H,G,.002],[B(r.width)+H-.05,G,.002]),color:_,lineWidth:1}),(c||i)&&l.jsx(zn,{position:[B(r.width)/2+H,G+B(40),.01],fontSize:P,color:I,anchorX:"center",anchorY:"middle",children:r.width}),l.jsx(it,{points:[[H,0,.001],[H,G+B(40),.001]],color:_,lineWidth:1}),l.jsx(it,{points:[[B(r.width)+H,0,.001],[B(r.width)+H,G+B(40),.001]],color:_,lineWidth:1})]}),((rt=r.droppedCeiling)==null?void 0:rt.enabled)&&j!=="top"&&l.jsx("group",{children:(()=>{i3(r),zb(r);const De=G-B(120),Ge=oa(r),Re=r.width-r.droppedCeiling.width,Ie=r.droppedCeiling.width,Le=r.droppedCeiling.position==="left"?H+B(Ie):H,et=r.droppedCeiling.position==="left"?H+B(r.width):H+B(Re),ct=r.droppedCeiling.position==="left"?H:H+B(Re),mt=r.droppedCeiling.position==="left"?H+B(Ie):H+B(r.width);return l.jsxs(l.Fragment,{children:[l.jsx(it,{points:[[Le,De,.002],[et,De,.002]],color:_,lineWidth:1}),l.jsx(it,{points:te([Le,De,.002],[Le+.05,De,.002]),color:_,lineWidth:1}),l.jsx(it,{points:te([et,De,.002],[et-.05,De,.002]),color:_,lineWidth:1}),(c||i)&&l.jsx(zn,{position:[(Le+et)/2,De+B(30),.01],fontSize:M,color:I,anchorX:"center",anchorY:"middle",children:(()=>{var Je;let je=Ge.left,le=Ge.right;return r.surroundType==="no-surround"&&(r.installType==="builtin"?(je=2,le=2):r.installType==="semistanding"?(Je=r.wallConfig)!=null&&Je.left?(je=2,le=20):(je=20,le=2):r.installType==="freestanding"&&(je=20,le=20)),r.droppedCeiling.position==="left"?r.width-r.droppedCeiling.width-le:r.width-r.droppedCeiling.width-je})()}),l.jsx(it,{points:[[ct,De,.002],[mt,De,.002]],color:_,lineWidth:1}),l.jsx(it,{points:te([ct,De,.002],[ct+.05,De,.002]),color:_,lineWidth:1}),l.jsx(it,{points:te([mt,De,.002],[mt-.05,De,.002]),color:_,lineWidth:1}),(c||i)&&l.jsx(zn,{position:[(ct+mt)/2,De+B(30),.01],fontSize:M,color:I,anchorX:"center",anchorY:"middle",children:(()=>{var Je;let je=Ge.left,le=Ge.right;return r.surroundType==="no-surround"&&(r.installType==="builtin"?(je=2,le=2):r.installType==="semistanding"?(Je=r.wallConfig)!=null&&Je.left?(je=2,le=20):(je=20,le=2):r.installType==="freestanding"&&(je=20,le=20)),r.droppedCeiling.position==="left"?r.droppedCeiling.width-je:r.droppedCeiling.width-le})()}),l.jsx(it,{points:[[Le,De-B(40),.001],[Le,De+B(10),.001]],color:S,lineWidth:1}),l.jsx(it,{points:[[et,De-B(40),.001],[et,De+B(10),.001]],color:S,lineWidth:1}),l.jsx(it,{points:[[ct,De-B(40),.001],[ct,De+B(10),.001]],color:S,lineWidth:1}),l.jsx(it,{points:[[mt,De-B(40),.001],[mt,De+B(10),.001]],color:S,lineWidth:1})]})})()}),!i&&r.surroundType==="no-surround"&&(()=>{var Ie,Le,et,ct,mt;const De=((Ie=r.wallConfig)==null?void 0:Ie.left)&&((Le=r.wallConfig)==null?void 0:Le.right);let Ge,Re;if(De)Ge=((et=r.gapConfig)==null?void 0:et.left)||2,Re=`${Ge}`;else{const je=oa(r);if((ct=r.wallConfig)!=null&&ct.left&&!((mt=r.wallConfig)!=null&&mt.right))return null;Ge=je.left>0?je.left:fr,Re=`${Ge}`}return l.jsxs("group",{children:[l.jsx(it,{points:[[H,G-B(120),.002],[H+B(Ge),G-B(120),.002]],color:_,lineWidth:2}),l.jsx(it,{points:te([H,G-B(120),.002],[H+.02,G-B(120),.002]),color:_,lineWidth:2}),l.jsx(it,{points:te([H+B(Ge),G-B(120),.002],[H+B(Ge)-.02,G-B(120),.002]),color:_,lineWidth:2}),c&&l.jsx(zn,{position:[H+B(Ge)/2,G-B(120)-B(30),.01],fontSize:K,color:_,anchorX:"center",anchorY:"middle",children:Re}),l.jsx(it,{points:[[H,E,.001],[H,G-B(100),.001]],color:I,lineWidth:.5}),l.jsx(it,{points:[[H+B(Ge),E,.001],[H+B(Ge),G-B(100),.001]],color:I,lineWidth:.5})]})})(),!i&&r.surroundType==="surround"&&l.jsxs("group",{children:[l.jsx(it,{points:[[H,G-B(120),.002],[H+B(se.left),G-B(120),.002]],color:_,lineWidth:.5}),l.jsx(it,{points:te([H,G-B(120),.002],[H+.02,G-B(120),.002]),color:_,lineWidth:.5}),l.jsx(it,{points:te([H+B(se.left),G-B(120),.002],[H+B(se.left)-.02,G-B(120),.002]),color:_,lineWidth:.5}),l.jsx(zn,{position:[H+B(se.left)/2,G-B(90),.01],fontSize:K,color:I,anchorX:"center",anchorY:"middle",children:se.left}),l.jsx(it,{points:[[H,E,.001],[H,G-B(100),.001]],color:_,lineWidth:.5}),l.jsx(it,{points:[[H+B(se.left),E,.001],[H+B(se.left),G-B(100),.001]],color:_,lineWidth:.5})]}),!i&&r.surroundType==="no-surround"&&(()=>{var Ie,Le,et,ct,mt;const De=((Ie=r.wallConfig)==null?void 0:Ie.left)&&((Le=r.wallConfig)==null?void 0:Le.right);let Ge,Re;if(De)Ge=((et=r.gapConfig)==null?void 0:et.right)||2,Re=`${Ge}`;else{const je=oa(r);if((ct=r.wallConfig)!=null&&ct.right&&!((mt=r.wallConfig)!=null&&mt.left))return null;Ge=je.right>0?je.right:fr,Re=`${Ge}`}return l.jsxs("group",{children:[l.jsx(it,{points:[[B(r.width)+H-B(Ge),G-B(120),.002],[B(r.width)+H,G-B(120),.002]],color:I,lineWidth:2}),l.jsx(it,{points:te([B(r.width)+H-B(Ge),G-B(120),.002],[B(r.width)+H-B(Ge)+.02,G-B(120),.002]),color:I,lineWidth:2}),l.jsx(it,{points:te([B(r.width)+H,G-B(120),.002],[B(r.width)+H-.02,G-B(120),.002]),color:I,lineWidth:2}),l.jsx(zn,{position:[B(r.width)+H-B(Ge)/2,G-B(120)-B(30),.01],fontSize:K,color:_,anchorX:"center",anchorY:"middle",children:Re}),l.jsx(it,{points:[[B(r.width)+H-B(Ge),E,.001],[B(r.width)+H-B(Ge),G-B(100),.001]],color:I,lineWidth:.5}),l.jsx(it,{points:[[B(r.width)+H,E,.001],[B(r.width)+H,G-B(100),.001]],color:I,lineWidth:.5})]})})(),!i&&r.surroundType==="surround"&&l.jsxs("group",{children:[l.jsx(it,{points:[[B(r.width)+H-B(se.right),G-B(120),.002],[B(r.width)+H,G-B(120),.002]],color:_,lineWidth:.5}),l.jsx(it,{points:te([B(r.width)+H-B(se.right),G-B(120),.002],[B(r.width)+H-B(se.right)+.02,G-B(120),.002]),color:_,lineWidth:.5}),l.jsx(it,{points:te([B(r.width)+H,G-B(120),.002],[B(r.width)+H-.02,G-B(120),.002]),color:_,lineWidth:.5}),l.jsx(zn,{position:[B(r.width)+H-B(se.right)/2,G-B(90),.01],fontSize:K,color:I,anchorX:"center",anchorY:"middle",children:se.right}),l.jsx(it,{points:[[B(r.width)+H-B(se.right),E,.001],[B(r.width)+H-B(se.right),G-B(100),.001]],color:_,lineWidth:.5}),l.jsx(it,{points:[[B(r.width)+H,E,.001],[B(r.width)+H,G-B(100),.001]],color:_,lineWidth:.5})]}),!1,l.jsxs("group",{children:[(Ve=r.droppedCeiling)!=null&&Ve.enabled?l.jsx(l.Fragment,{children:r.droppedCeiling.position==="left"?l.jsxs(l.Fragment,{children:[l.jsx(it,{points:[[ie+H,B(r.height-r.droppedCeiling.dropHeight),.002],[ie+H,E,.002]],color:_,lineWidth:1}),l.jsx(it,{points:te([ie+H,B(r.height-r.droppedCeiling.dropHeight),.002],[ie+H,B(r.height-r.droppedCeiling.dropHeight)+.05,.002]),color:_,lineWidth:1}),l.jsx(it,{points:te([ie+H,E,.002],[ie+H,E-.05,.002]),color:_,lineWidth:1}),l.jsx(zn,{position:[ie+H-B(60),B(r.height-r.droppedCeiling.dropHeight/2),.01],fontSize:P,color:I,anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:r.droppedCeiling.dropHeight})]}):l.jsxs(l.Fragment,{children:[l.jsx(it,{points:[[ie+H,0,.002],[ie+H,E,.002]],color:_,lineWidth:1}),l.jsx(it,{points:te([ie+H,0,.002],[ie+H,.05,.002]),color:_,lineWidth:1}),l.jsx(it,{points:te([ie+H,E,.002],[ie+H,E-.05,.002]),color:_,lineWidth:1}),l.jsx(zn,{position:[ie+H-B(60),E/2,.01],fontSize:P,color:I,anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:r.height})]})}):l.jsxs(l.Fragment,{children:[l.jsx(it,{points:[[ie+H,0,.002],[ie+H,E,.002]],color:_,lineWidth:1}),l.jsx(it,{points:te([ie+H,0,.002],[ie+H,.05,.002]),color:_,lineWidth:1}),l.jsx(it,{points:te([ie+H,E,.002],[ie+H,E-.05,.002]),color:_,lineWidth:1}),l.jsx(zn,{position:[ie+H-B(60),E/2,.01],fontSize:P,color:I,anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:r.height})]}),l.jsx(it,{points:[[H,0,.001],[ie+H-B(20),0,.001]],color:_,lineWidth:1}),l.jsx(it,{points:[[H,E,.001],[ie+H-B(20),E,.001]],color:_,lineWidth:1})]}),!i&&l.jsx("group",{children:(()=>{var ft,jt,Wt,Mt;const De=B(r.width)+H+B(z?120:200),Ge=((ft=r.baseConfig)==null?void 0:ft.type)==="stand"&&((jt=r.baseConfig)==null?void 0:jt.placementType)==="float",Re=Ge&&((Wt=r.baseConfig)==null?void 0:Wt.floatHeight)||0,Ie=se.top,Le=L0(r),et=r.hasFloorFinish?((Mt=r.floorFinish)==null?void 0:Mt.height)||10:0,ct=r.height-Ie-Le-Re-et,mt=B(Re),je=B(Re+et),le=B(Re+et+Le),Je=B(Re+et+Le+ct);let ht=Je;s.length>0&&s.forEach(dn=>{const on=Hi(dn.moduleId);if(on){const Et=on.dimensions.height,Mn=B(Re+et+Le)+B(Et);Mn>ht&&(ht=Mn)}});const ut=s.length>0?ht:E;return l.jsxs(l.Fragment,{children:[Ge&&Re>0&&l.jsxs("group",{children:[l.jsx(it,{points:[[De+B(100),0,.002],[De+B(100),B(Re),.002]],color:I,lineWidth:2}),l.jsx(it,{points:te([De+B(100),0,.002],[De+B(100),-.03,.002]),color:I,lineWidth:2}),l.jsx(it,{points:te([De+B(100),B(Re),.002],[De+B(100),B(Re)+.03,.002]),color:I,lineWidth:2}),l.jsxs(zn,{position:[De+B(100)+B(30),B(Re/2),.01],fontSize:K*.9,color:I,anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:["띄움 ",Re]}),l.jsx(it,{points:[[-B(1800),0,.002],[B(r.width)-B(1800),0,.002]],color:I,lineWidth:.5,dashed:!0,dashSize:.01,gapSize:.005}),l.jsx(it,{points:[[-B(1800),B(Re),.002],[B(r.width)-B(1800),B(Re),.002]],color:I,lineWidth:.5,dashed:!0,dashSize:.01,gapSize:.005})]}),et>0&&o!=="top"&&!Ge&&l.jsxs("group",{children:[l.jsx(it,{points:[[De,mt,.002],[De,je,.002]],color:_,lineWidth:.5}),l.jsx(it,{points:te([De,mt,.002],[De,mt+.03,.002]),color:_,lineWidth:.5}),l.jsx(it,{points:te([De,je,.002],[De,je-.03,.002]),color:_,lineWidth:.5}),l.jsx(zn,{position:[De+B(z?30:60),B(Re+et/2),.01],fontSize:Le>0?K*.8:K,color:"rgba(255, 0, 0, 0.7)",anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:et})]}),Le>0&&l.jsxs("group",{children:[l.jsx(it,{points:[[De,je,.002],[De,le,.002]],color:_,lineWidth:.5}),l.jsx(it,{points:te([De,je,.002],[De,je+.03,.002]),color:_,lineWidth:.5}),l.jsx(it,{points:te([De,le,.002],[De,le-.03,.002]),color:_,lineWidth:.5}),l.jsx(zn,{position:[De+B(z?30:60),B(Re+et+Le/2),.01],fontSize:et>0?K*.8:K,color:I,anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:Le})]}),l.jsxs("group",{children:[l.jsx(it,{points:[[De,le,.002],[De,Je,.002]],color:_,lineWidth:.5}),l.jsx(it,{points:te([De,le,.002],[De,le+.03,.002]),color:_,lineWidth:.5}),l.jsx(it,{points:te([De,Je,.002],[De,Je-.03,.002]),color:_,lineWidth:.5}),l.jsx(zn,{position:[De+B(z?30:60),B(Re+et+Le+ct/2),.01],fontSize:K,color:I,anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:ct})]}),l.jsxs("group",{children:[l.jsx(it,{points:[[De,Je,.002],[De,ut,.002]],color:r.surroundType==="no-surround"?I:F,lineWidth:r.surroundType==="no-surround"?2:1}),l.jsx(it,{points:te([De,Je,.002],[De,Je+.03,.002]),color:r.surroundType==="no-surround"?I:F,lineWidth:r.surroundType==="no-surround"?2:1}),l.jsx(it,{points:te([De,ut,.002],[De,ut-.03,.002]),color:r.surroundType==="no-surround"?I:F,lineWidth:r.surroundType==="no-surround"?2:1}),l.jsx(zn,{position:[De+B(z?30:60),B(r.height-Ie/2),.01],fontSize:K,color:z?r.surroundType==="no-surround"?g.primary:"black":"white",anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:Ie})]}),l.jsx(it,{points:[[B(r.width)+H,mt,.001],[De+B(z?10:20),mt,.001]],color:_,lineWidth:.5}),et>0&&!Ge&&l.jsx(it,{points:[[B(r.width)+H,je,.001],[De+B(z?10:20),je,.001]],color:_,lineWidth:.5}),Le>0&&l.jsx(it,{points:[[B(r.width)+H,le,.001],[De+B(z?10:20),le,.001]],color:_,lineWidth:.5}),l.jsx(it,{points:[[B(r.width)+H,Je,.001],[De+B(z?10:20),Je,.001]],color:_,lineWidth:.5}),l.jsx(it,{points:[[B(r.width)+H,ut,.001],[De+B(z?10:20),ut,.001]],color:_,lineWidth:.5})]})})()}),t&&V&&V.map((De,Ge)=>{var Lt,dt,at,Ot,Cn,Rn,xn,En,Hn,Kn;if(!De)return null;const Re=((Lt=r.baseConfig)==null?void 0:Lt.type)==="stand"&&((dt=r.baseConfig)==null?void 0:dt.placementType)==="float",Ie=Re?B(((at=r.baseConfig)==null?void 0:at.floatHeight)||0):0;console.log("📐 가구 치수 렌더링 체크:",{index:Ge,moduleId:De.module.moduleId,showFurniture:t,showDimensions:u,isFloating:Re,floatHeight:Ie,actualWidth:De.actualWidth});const{module:Le,moduleData:et,actualWidth:ct,actualDepth:mt,hasCustomDepth:je,moduleX:le,moduleY:Je,moduleLeft:ht,moduleRight:ut,nearestLeftDistance:ft,nearestRightDistance:jt,leftBoundaryDistance:Wt,rightBoundaryDistance:Mt,isSpacerHandled:dn,hasStepDown:on,stepDownPosition:Et}=De,an=le,Mn=((Ot=r.droppedCeiling)==null?void 0:Ot.width)||0,At=B(ct),zt=an-At/2,Zt=an+At/2,$t=G-B(120),Ht=et.id.includes("dual");return Ht?(Cn=et.modelConfig)!=null&&Cn.leftSections||(Rn=et.modelConfig)!=null&&Rn.sections:(xn=et.modelConfig)!=null&&xn.sections,Ht&&((En=et.modelConfig)!=null&&En.rightSections||(Hn=et.modelConfig)!=null&&Hn.sections),Ht&&(Kn=et.modelConfig)!=null&&Kn.rightAbsoluteWidth&&et.modelConfig.rightAbsoluteWidth/et.dimensions.width,B(on&&Et==="right"?r.width-Mn:r.width),B(et.dimensions.height),l.jsxs("group",{renderOrder:999999,children:[l.jsx(it,{points:[[zt,$t,.002],[Zt,$t,.002]],color:_,lineWidth:.5,renderOrder:999999}),l.jsx(it,{points:te([zt,$t,.002],[zt+.02,$t,.002],.01),color:_,lineWidth:.5,renderOrder:999999}),l.jsx(it,{points:te([Zt,$t,.002],[Zt-.02,$t,.002],.01),color:_,lineWidth:.5,renderOrder:999999}),l.jsx(zn,{position:[an,$t-B(30),.01],fontSize:K,color:_,anchorX:"center",anchorY:"middle",renderOrder:999999,children:Math.round(ct)}),l.jsxs(l.Fragment,{children:[l.jsx(it,{points:[[zt,E,.002],[zt,$t+B(10),.002]],color:_,lineWidth:1,renderOrder:999999}),l.jsx(it,{points:[[Zt,E,.002],[Zt,$t+B(10),.002]],color:_,lineWidth:1,renderOrder:999999})]})]},`module-guide-${Ge}`)}),r.columns&&r.columns.length>0&&j!=="top"&&r.columns.map((De,Ge)=>{const Re=De.width*.01,Ie=De.position[0]-Re/2,Le=De.position[0]+Re/2,et=G-B(120);return l.jsxs("group",{children:[l.jsx(it,{points:[[Ie,et,.002],[Le,et,.002]],color:"#FF0000",lineWidth:.5,renderOrder:999999}),l.jsx(it,{points:te([Ie,et,.002],[Ie+.02,et,.002],.01),color:"#FF0000",lineWidth:.5,renderOrder:999999}),l.jsx(it,{points:te([Le,et,.002],[Le-.02,et,.002],.01),color:"#FF0000",lineWidth:.5,renderOrder:999999}),l.jsx(zn,{position:[De.position[0],et-B(30),.01],fontSize:K,color:"#FF0000",anchorX:"center",anchorY:"middle",renderOrder:999999,children:Math.round(De.width)}),l.jsx(it,{points:[[Ie,E,.002],[Ie,et+B(10),.002]],color:"#FF0000",lineWidth:1,renderOrder:999999}),l.jsx(it,{points:[[Le,E,.002],[Le,et+B(10),.002]],color:"#FF0000",lineWidth:1,renderOrder:999999})]},`column-dim-${De.id}`)}),((We=r.droppedCeiling)==null?void 0:We.enabled)&&j==="top"&&l.jsx("group",{children:(()=>{const De=B(r.width),Ge=B(r.depth),Re=-De/2,Ie=-Ge/2,Le=Ie-B(U?300:250),et=oa(r),ct=r.width-r.droppedCeiling.width,mt=r.droppedCeiling.width,je=r.droppedCeiling.position==="left"?Re+B(mt):Re,le=r.droppedCeiling.position==="left"?Re+De:Re+B(ct),Je=r.droppedCeiling.position==="left"?Re:Re+B(ct),ht=r.droppedCeiling.position==="left"?Re+B(mt):Re+De;return l.jsxs(l.Fragment,{children:[l.jsx(it,{points:[[je,E,Le],[le,E,Le]],color:_,lineWidth:.5}),l.jsx(it,{points:te([je,E,Le],[je+.05,E,Le]),color:_,lineWidth:.5}),l.jsx(it,{points:te([le,E,Le],[le-.05,E,Le]),color:_,lineWidth:.5}),(c||i)&&l.jsx(zn,{position:[(je+le)/2,E+.1,Le-B(30)],fontSize:M,color:I,anchorX:"center",anchorY:"middle",rotation:[-Math.PI/2,0,0],children:(()=>{var jt;let ut=et.left,ft=et.right;return r.surroundType==="no-surround"&&(r.installType==="builtin"?(ut=2,ft=2):r.installType==="semistanding"?(jt=r.wallConfig)!=null&&jt.left?(ut=2,ft=20):(ut=20,ft=2):r.installType==="freestanding"&&(ut=20,ft=20)),r.droppedCeiling.position==="left"?r.width-r.droppedCeiling.width-ft:r.width-r.droppedCeiling.width-ut})()}),l.jsx(it,{points:[[Je,E,Le],[ht,E,Le]],color:_,lineWidth:.5}),l.jsx(it,{points:te([Je,E,Le],[Je+.05,E,Le]),color:_,lineWidth:.5}),l.jsx(it,{points:te([ht,E,Le],[ht-.05,E,Le]),color:_,lineWidth:.5}),(c||i)&&l.jsx(zn,{position:[(Je+ht)/2,E+.1,Le-B(30)],fontSize:M,color:I,anchorX:"center",anchorY:"middle",rotation:[-Math.PI/2,0,0],children:(()=>{var jt;let ut=et.left,ft=et.right;return r.surroundType==="no-surround"&&(r.installType==="builtin"?(ut=2,ft=2):r.installType==="semistanding"?(jt=r.wallConfig)!=null&&jt.left?(ut=2,ft=20):(ut=20,ft=2):r.installType==="freestanding"&&(ut=20,ft=20)),r.droppedCeiling.position==="left"?r.droppedCeiling.width-ut:r.droppedCeiling.width-ft})()}),l.jsx(it,{points:[[r.droppedCeiling.position==="left"?ht:le,E,Ie],[r.droppedCeiling.position==="left"?ht:le,E,Le-B(20)]],color:S,lineWidth:.5,dashed:!0}),l.jsx(it,{points:[[r.droppedCeiling.position==="left"?le:je,E,Ie],[r.droppedCeiling.position==="left"?le:je,E,Le-B(20)]],color:_,lineWidth:.5}),l.jsx(it,{points:[[r.droppedCeiling.position==="left"?Je:ht,E,Ie],[r.droppedCeiling.position==="left"?Je:ht,E,Le-B(20)]],color:_,lineWidth:.5})]})})()})]})})},W=()=>{var mt;if(n!=="left")return null;const rt=r.depth||600,Ve=600,We=B(rt),De=B(Ve),Ge=-We/2,Re=Ge+(We-De)/2,Ie=B(r.width),Le=B(r.height),et=r.frameSize||{top:50},ct=-B(150);return l.jsxs("group",{children:[l.jsxs("group",{children:[l.jsx(it,{points:[[ct,0,Ge-B(120)],[ct,Le,Ge-B(120)]],color:_,lineWidth:1}),l.jsx(it,{points:te([ct,0,Ge-B(120)],[ct,.05,Ge-B(120)]),color:_,lineWidth:1}),l.jsx(it,{points:te([ct,Le,Ge-B(120)],[ct,Le-.05,Ge-B(120)]),color:_,lineWidth:1}),c&&l.jsx(zn,{position:[ct-B(40),Le/2,Ge-B(120)],fontSize:P,color:I,anchorX:"center",anchorY:"middle",rotation:[0,0,Math.PI/2],children:r.height}),l.jsx(it,{points:[[0,0,Ge],[0,0,Ge-B(100)]],color:_,lineWidth:1}),l.jsx(it,{points:[[0,Le,Ge],[0,Le,Ge-B(100)]],color:_,lineWidth:1})]}),s.length>0&&l.jsx("group",{children:(()=>{var an,Mn,At;const je=Ge+We+B(80),le=((an=r.baseConfig)==null?void 0:an.type)==="stand"&&((Mn=r.baseConfig)==null?void 0:Mn.placementType)==="float",Je=et.top,ht=L0(r),ut=r.hasFloorFinish?((At=r.floorFinish)==null?void 0:At.height)||10:0,ft=r.height-Je-ht-ut,jt=0,Wt=B(ut),Mt=B(ut+ht),dn=B(ht+ft);let on=dn;s.length>0&&s.forEach(zt=>{const Zt=Hi(zt.moduleId);if(Zt){const $t=Zt.dimensions.height,Lt=B(ht)+B($t);Lt>on&&(on=Lt)}});const Et=s.length>0?on:Le;return l.jsxs(l.Fragment,{children:[ut>0&&!le&&l.jsxs("group",{children:[l.jsx(it,{points:[[0,jt,je],[0,Wt,je]],color:_,lineWidth:.5}),l.jsx(it,{points:te([0,jt,je],[0,.03,je]),color:_,lineWidth:.5}),l.jsx(it,{points:te([0,Wt,je],[0,Wt-.03,je]),color:_,lineWidth:.5}),l.jsx(zn,{position:[0,B(ut/2),je+B(60)],fontSize:K,color:I,anchorX:"center",anchorY:"middle",rotation:[0,-Math.PI/2,-Math.PI/2],children:ut})]}),ht>0&&l.jsxs("group",{children:[l.jsx(it,{points:[[0,Wt,je],[0,Mt,je]],color:_,lineWidth:.5}),l.jsx(it,{points:te([0,jt,je],[0,.03,je]),color:_,lineWidth:.5}),l.jsx(it,{points:te([0,Mt,je],[0,Mt-.03,je]),color:_,lineWidth:.5}),l.jsx(zn,{position:[0,B(ht/2),je+B(60)],fontSize:K,color:I,anchorX:"center",anchorY:"middle",rotation:[0,-Math.PI/2,-Math.PI/2],children:ht})]}),l.jsxs("group",{children:[l.jsx(it,{points:[[0,Mt,je],[0,dn,je]],color:_,lineWidth:.5}),l.jsx(it,{points:te([0,Mt,je],[0,Mt+.03,je]),color:_,lineWidth:.5}),l.jsx(it,{points:te([0,dn,je],[0,dn-.03,je]),color:_,lineWidth:.5}),l.jsx(zn,{position:[0,Mt+B(ft/2),je+B(60)],fontSize:K,color:I,anchorX:"center",anchorY:"middle",rotation:[0,-Math.PI/2,-Math.PI/2],children:ft})]}),l.jsxs("group",{children:[l.jsx(it,{points:[[0,dn,je],[0,Et,je]],color:r.surroundType==="no-surround"?I:F,lineWidth:r.surroundType==="no-surround"?2:1}),l.jsx(it,{points:te([0,dn,je],[0,dn+.03,je]),color:r.surroundType==="no-surround"?I:F,lineWidth:r.surroundType==="no-surround"?2:1}),l.jsx(it,{points:te([0,Et,je],[0,Et-.03,je]),color:r.surroundType==="no-surround"?I:F,lineWidth:r.surroundType==="no-surround"?2:1}),l.jsx(zn,{position:[0,dn+B(Je/2),je+B(60)],fontSize:K,color:I,anchorX:"center",anchorY:"middle",rotation:[0,-Math.PI/2,-Math.PI/2],children:Je})]}),l.jsx(it,{points:[[0,jt,Ge],[0,jt,je-B(20)]],color:_,lineWidth:.5}),ht>0&&l.jsx(it,{points:[[0,Mt,Ge],[0,Mt,je-B(20)]],color:_,lineWidth:.5}),l.jsx(it,{points:[[0,dn,Ge],[0,dn,je-B(20)]],color:_,lineWidth:.5}),l.jsx(it,{points:[[0,Et,Ge],[0,Et,je-B(20)]],color:_,lineWidth:.5})]})})()}),s.length>0&&s.filter(je=>j==="left"||je.position.x<0).map((je,le)=>{const Je=Hi(je.moduleId,{width:r.width,height:r.height,depth:r.depth},r);if(!Je)return null;const ht=je.customDepth||Je.dimensions.depth,ut=B(ht),ft=B(20),jt=Re+De/2-ft-ut/2,Wt=jt-ut/2,Mt=jt+ut/2,dn=E+B(200),on=je.position.x;return l.jsxs("group",{children:[l.jsx(it,{points:[[on,dn,Wt],[on,dn,Mt]],color:_,lineWidth:.5}),l.jsx(it,{points:te([on,dn,Wt],[on,dn,Wt+.02],.01),color:_,lineWidth:.5}),l.jsx(it,{points:te([on,dn,Mt],[on,dn,Mt-.02],.01),color:_,lineWidth:.5}),c&&l.jsx(zn,{position:[on,dn+B(40),(Wt+Mt)/2],fontSize:K,color:I,anchorX:"center",anchorY:"middle",rotation:[0,-Math.PI/2,0],children:ht}),l.jsxs(l.Fragment,{children:[l.jsx(it,{points:[[on,Le,Wt],[on,dn+B(50),Wt]],color:_,lineWidth:.5}),l.jsx(it,{points:[[on,Le,Mt],[on,dn+B(50),Mt]],color:_,lineWidth:.5})]})]},`left-module-dim-${le}`)}),l.jsxs("group",{children:[l.jsx(it,{points:[[-Ie/2,Le+B(100),0],[Ie/2,Le+B(100),0]],color:_,lineWidth:1}),l.jsx(it,{points:te([-Ie/2,Le+B(100),0],[-Ie/2+.05,Le+B(100),0]),color:_,lineWidth:1}),l.jsx(it,{points:te([Ie/2,Le+B(100),0],[Ie/2-.05,Le+B(100),0]),color:_,lineWidth:1}),l.jsx(zn,{position:[0,Le+B(140),0],fontSize:P,color:I,anchorX:"center",anchorY:"middle",children:r.width}),l.jsx(it,{points:[[-Ie/2,0,0],[-Ie/2,Le+B(120),0]],color:_,lineWidth:1}),l.jsx(it,{points:[[Ie/2,0,0],[Ie/2,Le+B(120),0]],color:_,lineWidth:1})]}),((mt=r.droppedCeiling)==null?void 0:mt.enabled)&&l.jsx("group",{children:(()=>{const je=i3(r),le=zb(r),Je=Le+B(50),ht=r.droppedCeiling.position==="left"?-Ie/2+B(le.width):-Ie/2,ut=r.droppedCeiling.position==="left"?Ie/2:-Ie/2+B(je.width),ft=r.droppedCeiling.position==="left"?-Ie/2:-Ie/2+B(je.width),jt=r.droppedCeiling.position==="left"?-Ie/2+B(le.width):Ie/2;return l.jsxs(l.Fragment,{children:[l.jsx(it,{points:[[ht,Je,0],[ut,Je,0]],color:_,lineWidth:1}),l.jsx(it,{points:te([ht,Je,0],[ht+.05,Je,0]),color:_,lineWidth:1}),l.jsx(it,{points:te([ut,Je,0],[ut-.05,Je,0]),color:_,lineWidth:1}),l.jsx(zn,{position:[(ht+ut)/2,Je+B(30),0],fontSize:M,color:I,anchorX:"center",anchorY:"middle",children:(()=>{var on;const Wt=oa(r);console.log("🔍 좌측뷰 메인구간 프레임 계산:",{surroundType:r.surroundType,installType:r.installType,wallConfig:r.wallConfig,frameThickness:Wt,droppedPosition:r.droppedCeiling.position});let Mt=Wt.left,dn=Wt.right;return r.surroundType==="no-surround"&&(r.installType==="builtin"?(Mt=2,dn=2):r.installType==="semistanding"?(on=r.wallConfig)!=null&&on.left?(Mt=2,dn=20):(Mt=20,dn=2):r.installType==="freestanding"&&(Mt=20,dn=20)),r.droppedCeiling.position==="left"?r.width-r.droppedCeiling.width-dn:r.width-r.droppedCeiling.width-Mt})()}),l.jsx(it,{points:[[ft,Je,0],[jt,Je,0]],color:_,lineWidth:1}),l.jsx(it,{points:te([ft,Je,0],[ft+.05,Je,0]),color:_,lineWidth:1}),l.jsx(it,{points:te([jt,Je,0],[jt-.05,Je,0]),color:_,lineWidth:1}),l.jsx(zn,{position:[(ft+jt)/2,Je+B(30),0],fontSize:M,color:I,anchorX:"center",anchorY:"middle",children:(()=>{var on;const Wt=oa(r);let Mt=Wt.left,dn=Wt.right;return r.surroundType==="no-surround"&&(r.installType==="builtin"?(Mt=2,dn=2):r.installType==="semistanding"?(on=r.wallConfig)!=null&&on.left?(Mt=2,dn=20):(Mt=20,dn=2):r.installType==="freestanding"&&(Mt=20,dn=20)),r.droppedCeiling.position==="left"?r.droppedCeiling.width-Mt:r.droppedCeiling.width-dn})()}),l.jsx(it,{points:[[r.droppedCeiling.position==="left"?-Ie/2+B(le.width):-Ie/2+B(je.width),0,0],[r.droppedCeiling.position==="left"?-Ie/2+B(le.width):-Ie/2+B(je.width),Je-B(20),0]],color:S,lineWidth:1,dashed:!0})]})})()})]})},Y=()=>{var je,le;if(n!=="right")return null;const rt=r.depth||600,Ve=B(r.width),We=B(r.depth),De=B(r.height),Ge=B(rt),Re=-Ge/2,Ie=B(r.width),Le=B(r.height),et=r.frameSize||{top:50},ct=Le+B(U?280:200),mt=Ie+B(200);return l.jsxs("group",{children:[l.jsxs("group",{children:[l.jsx(it,{points:[[mt,ct,Re],[mt,ct,Re+Ge]],color:_,lineWidth:1}),l.jsx(it,{points:te([mt,ct,Re],[mt,ct,Re+.05]),color:_,lineWidth:1}),l.jsx(it,{points:te([mt,ct,Re+Ge],[mt,ct,Re+Ge-.05]),color:_,lineWidth:1}),(c||i)&&l.jsx(zn,{position:[mt+B(60),ct,Re+Ge/2],fontSize:P,color:I,anchorX:"center",anchorY:"middle",rotation:[0,-Math.PI/2,0],children:r.depth}),l.jsx(it,{points:[[Ie,0,Re],[mt+B(20),0,Re]],color:_,lineWidth:1}),l.jsx(it,{points:[[Ie,Le,Re],[mt+B(20),Le,Re]],color:_,lineWidth:1}),l.jsx(it,{points:[[Ie,0,Re+Ge],[mt+B(20),0,Re+Ge]],color:_,lineWidth:1}),l.jsx(it,{points:[[Ie,Le,Re+Ge],[mt+B(20),Le,Re+Ge]],color:_,lineWidth:1})]}),l.jsxs("group",{children:[(je=r.droppedCeiling)!=null&&je.enabled?l.jsx(l.Fragment,{children:r.droppedCeiling.position==="right"?l.jsxs(l.Fragment,{children:[l.jsx(it,{points:[[mt,B(r.height-r.droppedCeiling.dropHeight),Re-B(200)],[mt,Le,Re-B(200)]],color:_,lineWidth:1}),l.jsx(it,{points:te([mt,B(r.height-r.droppedCeiling.dropHeight),Re-B(200)],[mt,B(r.height-r.droppedCeiling.dropHeight)+.05,Re-B(200)]),color:_,lineWidth:1}),l.jsx(it,{points:te([mt,Le,Re-B(200)],[mt,Le-.05,Re-B(200)]),color:_,lineWidth:1}),(c||i)&&l.jsx(zn,{position:[mt+B(60),B(r.height-r.droppedCeiling.dropHeight/2),Re-B(200)],fontSize:P,color:I,anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:r.droppedCeiling.dropHeight})]}):l.jsxs(l.Fragment,{children:[l.jsx(it,{points:[[mt,0,Re-B(200)],[mt,Le,Re-B(200)]],color:_,lineWidth:1}),l.jsx(it,{points:te([mt,0,Re-B(200)],[mt,.05,Re-B(200)]),color:_,lineWidth:1}),l.jsx(it,{points:te([mt,Le,Re-B(200)],[mt,Le-.05,Re-B(200)]),color:_,lineWidth:1}),(c||i)&&l.jsx(zn,{position:[mt+B(60),Le/2,Re-B(200)],fontSize:P,color:I,anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:r.height})]})}):l.jsxs(l.Fragment,{children:[l.jsx(it,{points:[[mt,0,Re-B(200)],[mt,Le,Re-B(200)]],color:_,lineWidth:1}),l.jsx(it,{points:te([mt,0,Re-B(200)],[mt,.05,Re-B(200)]),color:_,lineWidth:1}),l.jsx(it,{points:te([mt,Le,Re-B(200)],[mt,Le-.05,Re-B(200)]),color:_,lineWidth:1}),(c||i)&&l.jsx(zn,{position:[mt+B(60),Le/2,Re-B(200)],fontSize:P,color:I,anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:r.height})]}),l.jsx(it,{points:[[Ie,0,Re],[Ie,0,Re-B(180)]],color:_,lineWidth:1}),l.jsx(it,{points:[[Ie,Le,Re],[Ie,Le,Re-B(180)]],color:_,lineWidth:1}),((le=r.droppedCeiling)==null?void 0:le.enabled)&&l.jsx(it,{points:[[Ie,B(r.height-r.droppedCeiling.dropHeight),Re],[Ie,B(r.height-r.droppedCeiling.dropHeight),Re-B(180)]],color:_,lineWidth:1})]}),l.jsx("group",{children:(()=>{const Je=Re+Ge+B(120),ht=et.top,ut=L0(r),ft=r.height-ht-ut,jt=0,Wt=B(ut),Mt=B(ut+ft);let dn=Mt;s.length>0&&s.forEach(Et=>{const an=Hi(Et.moduleId);if(an){const Mn=an.dimensions.height,zt=B(ut)+B(Mn);zt>dn&&(dn=zt)}});const on=s.length>0?dn:De;return l.jsxs(l.Fragment,{children:[ut>0&&l.jsxs("group",{children:[l.jsx(it,{points:[[Ve,jt,Je],[Ve,Wt,Je]],color:_,lineWidth:.5}),l.jsx(it,{points:te([Ve,jt,Je],[Ve,.03,Je]),color:_,lineWidth:.5}),l.jsx(it,{points:te([Ve,Wt,Je],[Ve,Wt-.03,Je]),color:_,lineWidth:.5}),l.jsx(zn,{position:[Ve,B(ut/2),Je+B(60)],fontSize:K,color:I,anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:ut})]}),l.jsxs("group",{children:[l.jsx(it,{points:[[Ve,Wt,Je],[Ve,Mt,Je]],color:_,lineWidth:.5}),l.jsx(it,{points:te([Ve,Wt,Je],[Ve,Wt+.03,Je]),color:_,lineWidth:.5}),l.jsx(it,{points:te([Ve,Mt,Je],[Ve,Mt-.03,Je]),color:_,lineWidth:.5}),l.jsx(zn,{position:[Ve,B(ut+ft/2),Je+B(60)],fontSize:K,color:I,anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:ft})]}),l.jsxs("group",{children:[l.jsx(it,{points:[[Ve,Mt,Je],[Ve,on,Je]],color:r.surroundType==="no-surround"?I:F,lineWidth:r.surroundType==="no-surround"?2:1}),l.jsx(it,{points:te([Ve,Mt,Je],[Ve,Mt+.03,Je]),color:r.surroundType==="no-surround"?I:F,lineWidth:r.surroundType==="no-surround"?2:1}),l.jsx(it,{points:te([Ve,on,Je],[Ve,on-.03,Je]),color:r.surroundType==="no-surround"?I:F,lineWidth:r.surroundType==="no-surround"?2:1}),l.jsx(zn,{position:[Ve,B(r.height-ht/2),Je+B(60)],fontSize:K,color:I,anchorX:"center",anchorY:"middle",rotation:[0,0,-Math.PI/2],children:ht})]}),l.jsx(it,{points:[[Ve,jt,Re],[Ve,jt,Je+B(20)]],color:_,lineWidth:.5}),ut>0&&l.jsx(it,{points:[[Ve,Wt,Re],[Ve,Wt,Je+B(20)]],color:_,lineWidth:.5}),l.jsx(it,{points:[[Ve,Mt,Re],[Ve,Mt,Je+B(20)]],color:_,lineWidth:.5}),l.jsx(it,{points:[[Ve,on,Re+We],[Ve,on,Je+B(20)]],color:_,lineWidth:.5})]})})()}),t&&s.length>0&&s.map((Je,ht)=>{const ut=Hi(Je.moduleId,{width:r.width,height:r.height,depth:r.depth},r);if(!ut)return null;const ft=Je.customDepth||ut.dimensions.depth,jt=B(ft),Wt=ct-B(120);return l.jsxs("group",{children:[l.jsx(it,{points:[[Ve,Wt,Re],[Ve,Wt,Re+jt]],color:_,lineWidth:.5}),l.jsx(it,{points:te([Ve,Wt,Re],[Ve,Wt,Re+.02],.01),color:_,lineWidth:.5}),l.jsx(it,{points:te([Ve,Wt,Re+jt],[Ve,Wt,Re+jt-.02],.01),color:_,lineWidth:.5}),l.jsx(zn,{position:[Ve,Wt-B(30),Re+jt/2],fontSize:K,color:_,anchorX:"center",anchorY:"middle",children:ft}),l.jsxs(l.Fragment,{children:[l.jsx(it,{points:[[Ve,De,Re],[Ve,Wt+B(30),Re]],color:_,lineWidth:.5}),l.jsx(it,{points:[[Ve,De,Re+jt],[Ve,Wt+B(30),Re+jt]],color:_,lineWidth:.5})]})]},`right-module-dim-${ht}`)})]})},ve=()=>{var Re;const rt=B(r.width),Ve=B(r.depth),We=r.frameSize||{left:50,right:50},De=-rt/2,Ge=-Ve/2;return L0(r),rt-(r.surroundType==="no-surround"?0:B(We.left)+B(We.right)),l.jsx("group",{children:n!=="left"&&l.jsxs(l.Fragment,{children:[l.jsx("group",{children:(()=>{const Ie=Ge-B(U?200:150);return l.jsxs(l.Fragment,{children:[l.jsx(it,{points:[[De,E,Ie],[De+rt,E,Ie]],color:_,lineWidth:.5}),l.jsx(it,{points:te([De,E,Ie],[De+.05,E,Ie]),color:_,lineWidth:.5}),l.jsx(it,{points:te([De+rt,E,Ie],[De+rt-.05,E,Ie]),color:_,lineWidth:.5}),l.jsx(zn,{position:[0,E+.1,Ie-B(40)],fontSize:P,color:I,anchorX:"center",anchorY:"middle",rotation:[-Math.PI/2,0,0],children:r.width}),(()=>{const ct=B(1500),mt=B(600),le=Ge+(ct-mt)/2+mt/2;return l.jsxs(l.Fragment,{children:[l.jsx(it,{points:[[De,E,le],[De,E,Ie-B(20)]],color:_,lineWidth:.5}),l.jsx(it,{points:[[De+rt,E,le],[De+rt,E,Ie-B(20)]],color:_,lineWidth:.5})]})})()]})})()}),l.jsx("group",{children:(()=>{var Le,et,ct,mt,je;const Ie=Ge-B(U?120:80);if(r.surroundType==="no-surround"){const le=((Le=r.wallConfig)==null?void 0:Le.left)&&((et=r.wallConfig)==null?void 0:et.right);let Je,ht;if(le)Je=((ct=r.gapConfig)==null?void 0:ct.left)||2,ht=`${Je}`;else{const ut=oa(r);if((mt=r.wallConfig)!=null&&mt.left&&!((je=r.wallConfig)!=null&&je.right))return null;Je=ut.left>0?ut.left:fr,ht=`${Je}`}return l.jsxs(l.Fragment,{children:[l.jsx(it,{points:[[De,E,Ie],[De+B(Je),E,Ie]],color:_,lineWidth:.5}),l.jsx(it,{points:te([De,E,Ie],[De+.02,E,Ie]),color:_,lineWidth:.5}),l.jsx(it,{points:te([De+B(Je),E,Ie],[De+B(Je)-.02,E,Ie]),color:_,lineWidth:.5}),l.jsx(zn,{position:[De+B(Je)/2,E+.1,Ie-B(30)],fontSize:K,color:_,anchorX:"center",anchorY:"middle",rotation:[-Math.PI/2,0,0],children:ht})]})}else{const le=oa(r);if(le.left===0)return null;const Je=le.left;return l.jsxs(l.Fragment,{children:[l.jsx(it,{points:[[De,E,Ie],[De+B(Je),E,Ie]],color:_,lineWidth:.5}),l.jsx(it,{points:te([De,E,Ie],[De+.02,E,Ie]),color:_,lineWidth:.5}),l.jsx(it,{points:te([De+B(Je),E,Ie],[De+B(Je)-.02,E,Ie]),color:_,lineWidth:.5}),l.jsx(zn,{position:[De+B(Je/2),E+.1,Ie-B(30)],fontSize:K,color:I,anchorX:"center",anchorY:"middle",rotation:[-Math.PI/2,0,0],children:Je})]})}})()}),l.jsx("group",{children:(()=>{var Le,et,ct,mt,je;const Ie=Ge-B(U?120:80);if(r.surroundType==="no-surround"){const le=((Le=r.wallConfig)==null?void 0:Le.left)&&((et=r.wallConfig)==null?void 0:et.right);let Je,ht;if(le)Je=((ct=r.gapConfig)==null?void 0:ct.right)||2,ht=`${Je}`;else{const ut=oa(r);if((mt=r.wallConfig)!=null&&mt.right&&!((je=r.wallConfig)!=null&&je.left))return null;Je=ut.right>0?ut.right:fr,ht=`${Je}`}return l.jsxs(l.Fragment,{children:[l.jsx(it,{points:[[De+rt-B(Je),E,Ie],[De+rt,E,Ie]],color:_,lineWidth:.5}),l.jsx(it,{points:te([De+rt-B(Je),E,Ie],[De+rt-B(Je)+.02,E,Ie]),color:_,lineWidth:.5}),l.jsx(it,{points:te([De+rt,E,Ie],[De+rt-.02,E,Ie]),color:_,lineWidth:.5}),l.jsx(zn,{position:[De+rt-B(Je/2),E+.1,Ie-B(30)],fontSize:K,color:_,anchorX:"center",anchorY:"middle",rotation:[-Math.PI/2,0,0],children:ht})]})}else{const le=oa(r);if(le.right===0)return null;const Je=le.right;return l.jsxs(l.Fragment,{children:[l.jsx(it,{points:[[De+rt-B(Je),E,Ie],[De+rt,E,Ie]],color:_,lineWidth:.5}),l.jsx(it,{points:te([De+rt-B(Je),E,Ie],[De+rt-B(Je)+.02,E,Ie]),color:_,lineWidth:.5}),l.jsx(it,{points:te([De+rt,E,Ie],[De+rt-.02,E,Ie]),color:_,lineWidth:.5}),l.jsx(zn,{position:[De+rt-B(Je/2),E+.1,Ie-B(30)],fontSize:K,color:I,anchorX:"center",anchorY:"middle",rotation:[-Math.PI/2,0,0],children:Je})]})}})()}),((Re=r.droppedCeiling)==null?void 0:Re.enabled)&&l.jsx("group",{children:(()=>{const Ie=i3(r),Le=zb(r),et=Ge-B(280),ct=oa(r),mt=r.width-r.droppedCeiling.width,je=r.droppedCeiling.width,le=r.droppedCeiling.position==="left"?De+B(je):De,Je=r.droppedCeiling.position==="left"?De+rt:De+B(mt),ht=r.droppedCeiling.position==="left"?De:De+B(mt),ut=r.droppedCeiling.position==="left"?De+B(je):De+rt;return l.jsxs(l.Fragment,{children:[l.jsx(it,{points:[[le,E,et],[Je,E,et]],color:_,lineWidth:.5}),l.jsx(it,{points:te([le,E,et],[le+.05,E,et]),color:_,lineWidth:.5}),l.jsx(it,{points:te([Je,E,et],[Je-.05,E,et]),color:_,lineWidth:.5}),l.jsx(zn,{position:[(le+Je)/2,E+.1,et-B(40)],fontSize:M,color:I,anchorX:"center",anchorY:"middle",rotation:[-Math.PI/2,0,0],children:(()=>{var Wt;let ft=ct.left,jt=ct.right;return r.surroundType==="no-surround"&&(r.installType==="builtin"?(ft=2,jt=2):r.installType==="semistanding"?(Wt=r.wallConfig)!=null&&Wt.left?(ft=2,jt=20):(ft=20,jt=2):r.installType==="freestanding"&&(ft=20,jt=20)),r.droppedCeiling.position==="left"?r.width-r.droppedCeiling.width-jt:r.width-r.droppedCeiling.width-ft})()}),l.jsx(it,{points:[[ht,E,et],[ut,E,et]],color:_,lineWidth:.5}),l.jsx(it,{points:te([ht,E,et],[ht+.05,E,et]),color:_,lineWidth:.5}),l.jsx(it,{points:te([ut,E,et],[ut-.05,E,et]),color:_,lineWidth:.5}),l.jsx(zn,{position:[(ht+ut)/2,E+.1,et-B(40)],fontSize:M,color:I,anchorX:"center",anchorY:"middle",rotation:[-Math.PI/2,0,0],children:(()=>{var Wt;let ft=ct.left,jt=ct.right;return r.surroundType==="no-surround"&&(r.installType==="builtin"?(ft=2,jt=2):r.installType==="semistanding"?(Wt=r.wallConfig)!=null&&Wt.left?(ft=2,jt=20):(ft=20,jt=2):r.installType==="freestanding"&&(ft=20,jt=20)),r.droppedCeiling.position==="left"?r.droppedCeiling.width-ft:r.droppedCeiling.width-jt})()}),l.jsx(it,{points:[[r.droppedCeiling.position==="left"?De+B(Le.width):De+B(Ie.width),E,Ge],[r.droppedCeiling.position==="left"?De+B(Le.width):De+B(Ie.width),E,et+B(20)]],color:S,lineWidth:.5,dashed:!0}),l.jsx(it,{points:[[le,E,Ge-B(100)],[le,E,et-B(10)]],color:S,lineWidth:.5}),l.jsx(it,{points:[[Je,E,Ge-B(100)],[Je,E,et-B(10)]],color:S,lineWidth:.5}),l.jsx(it,{points:[[ht,E,Ge-B(100)],[ht,E,et-B(10)]],color:S,lineWidth:.5}),l.jsx(it,{points:[[ut,E,Ge-B(100)],[ut,E,et-B(10)]],color:S,lineWidth:.5})]})})()}),l.jsx("group",{children:l.jsx(it,{points:[[De,E,Ge],[De+rt,E,Ge]],color:S,lineWidth:1})}),s.length>0&&(()=>{let Ie=1/0,Le=-1/0,et=De,ct=!1;if(s.forEach(le=>{if(le.position.x>=0)return;const Je=Hi(le.moduleId,{width:r.width,height:r.height,depth:r.depth},r);if(!Je||!Je.dimensions)return;const ht=le.customDepth||Je.dimensions.depth,ut=Je.dimensions.width,ft=Je.id.includes("dual-2drawer-styler"),jt=B(ut),Wt=le.position.x+jt/2,Mt=1500,dn=600,on=20,Et=B(Mt),an=B(dn),Mn=B(on);let At,zt;if(ft){const Zt=ht,$t=660,Ht=B(Zt),Lt=B($t),at=-Et/2+(Et-an)/2,Ot=at+an/2-Mn-Ht/2,Cn=Ot-Ht/2,Rn=Ot+Ht/2,xn=(Ht-Lt)/2,En=at+an/2-Mn-Lt/2+xn,Hn=En-Lt/2,Kn=En+Lt/2;At=Math.min(Cn,Hn),zt=Math.max(Rn,Kn)}else{const Zt=B(ht),Lt=-Et/2+(Et-an)/2+an/2-Mn-Zt/2;At=Lt-Zt/2,zt=Lt+Zt/2}ct=!0,At<Ie&&(Ie=At,et=Wt),zt>Le&&(Le=zt)}),!ct||Ie===1/0||Le===-1/0)return null;const mt=Math.round((Le-Ie)/.01),je=De-B(200);return l.jsxs("group",{children:[l.jsx(it,{points:[[je,E,Ie],[je,E,Le]],color:_,lineWidth:.5}),l.jsx(it,{points:te([je,E,Ie],[je,E,Ie+.02],.01),color:_,lineWidth:.5}),l.jsx(it,{points:te([je,E,Le],[je,E,Le-.02],.01),color:_,lineWidth:.5}),l.jsx(zn,{position:[je-B(40),E+.1,(Ie+Le)/2],fontSize:K,color:_,anchorX:"center",anchorY:"middle",rotation:[-Math.PI/2,0,0],children:mt}),l.jsx(it,{points:[[et,E,Ie],[je,E,Ie]],color:_,lineWidth:.5}),l.jsx(it,{points:[[et,E,Le],[je,E,Le]],color:_,lineWidth:.5})]},"cabinet-depth-dimension")})(),s.length>0&&(()=>{let Ie=1/0,Le=-1/0,et=De,ct=!1;if(s.forEach(le=>{if(le.position.x<0)return;const Je=Hi(le.moduleId,{width:r.width,height:r.height,depth:r.depth},r);if(!Je||!Je.dimensions)return;const ht=le.customDepth||Je.dimensions.depth,ut=Je.dimensions.width,ft=Je.id.includes("dual-2drawer-styler"),jt=B(ut),Wt=le.position.x-jt/2,Mt=1500,dn=600,on=20,Et=B(Mt),an=B(dn),Mn=B(on);let At,zt;if(ft){const $t=B(660),at=-Et/2+(Et-an)/2+(an-$t)/2+$t/2-Mn-$t/2;At=at-$t/2,zt=at+$t/2}else{const Zt=B(ht),Lt=-Et/2+(Et-an)/2+an/2-Mn-Zt/2;At=Lt-Zt/2,zt=Lt+Zt/2}ct=!0,At<Ie&&(Ie=At,et=Wt),zt>Le&&(Le=zt)}),!ct||Ie===1/0||Le===-1/0)return null;const mt=Math.round((Le-Ie)/.01),je=De+rt+B(200);return l.jsxs("group",{children:[l.jsx(it,{points:[[je,E,Ie],[je,E,Le]],color:_,lineWidth:.5}),l.jsx(it,{points:te([je,E,Ie],[je,E,Ie+.02],.01),color:_,lineWidth:.5}),l.jsx(it,{points:te([je,E,Le],[je,E,Le-.02],.01),color:_,lineWidth:.5}),l.jsx(zn,{position:[je+B(40),E+.1,(Ie+Le)/2],fontSize:K,color:_,anchorX:"center",anchorY:"middle",rotation:[-Math.PI/2,0,0],children:mt}),l.jsx(it,{points:[[et,E,Ie],[je,E,Ie]],color:_,lineWidth:.5}),l.jsx(it,{points:[[et,E,Le],[je,E,Le]],color:_,lineWidth:.5})]},"right-cabinet-depth-dimension")})(),!1,t&&s.length>0&&s.map((Ie,Le)=>{var ft,jt,Wt;const et=Hi(Ie.moduleId,{width:r.width,height:r.height,depth:r.depth},r);if(!et)return null;const ct=Ie.customWidth||Ie.adjustedWidth||et.dimensions.width,mt=B(ct),je=((ft=Ie.adjustedPosition)==null?void 0:ft.x)||Ie.position.x;if(et.id.includes("dual")&&r.surroundType==="no-surround"){const Mt=ur(r),dn=Ie.slotIndex===0,on=Ie.slotIndex===Mt.columnCount-2;r.installType==="freestanding"||r.installType==="semistanding"&&((jt=r.wallConfig)!=null&&jt.left&&on||(Wt=r.wallConfig)!=null&&Wt.right)}const Je=je-mt/2,ht=je+mt/2,ut=Ge-B(U?120:80);return l.jsxs("group",{children:[l.jsx(it,{points:[[Je,E,ut],[ht,E,ut]],color:_,lineWidth:.5}),l.jsx(it,{points:te([Je,E,ut],[Je+.02,E,ut],.01),color:_,lineWidth:.5}),l.jsx(it,{points:te([ht,E,ut],[ht-.02,E,ut],.01),color:_,lineWidth:.5}),l.jsx(zn,{position:[je,E+.1,ut-B(30)],fontSize:K,color:_,anchorX:"center",anchorY:"middle",rotation:[-Math.PI/2,0,0],children:Math.round(ct)}),(()=>{var Lt,dt;const Mt=(et==null?void 0:et.id.includes("dual"))||!1,dn=(Lt=et==null?void 0:et.modelConfig)==null?void 0:Lt.rightAbsoluteDepth,on=Mt&&dn,Et=1500,an=600,Mn=20,At=Ie.customDepth||((dt=et==null?void 0:et.dimensions)==null?void 0:dt.depth)||580,zt=B(Et),Zt=B(an),$t=B(Mn),Ht=Ge+(zt-Zt)/2;if(on){const at=At,Ot=dn,Cn=B(at),Rn=B(Ot),xn=Ht+Zt/2-$t-Cn/2+Cn/2,En=Ht+Zt/2-$t-Rn/2+Rn/2+(Cn-Rn)/2;return l.jsxs(l.Fragment,{children:[l.jsx(it,{points:[[Je,E,xn],[Je,E,ut-B(15)]],color:_,lineWidth:.5}),l.jsx(it,{points:[[ht,E,En],[ht,E,ut-B(15)]],color:_,lineWidth:.5})]})}else{const at=B(At),Ot=Ht+Zt/2-$t-at/2+at/2;return l.jsxs(l.Fragment,{children:[l.jsx(it,{points:[[Je,E,Ot],[Je,E,ut-B(15)]],color:_,lineWidth:.5}),l.jsx(it,{points:[[ht,E,Ot],[ht,E,ut-B(15)]],color:_,lineWidth:.5})]})}})()]},`top-module-dim-${Le}`)}),r.columns&&r.columns.length>0&&r.columns.map((Ie,Le)=>{const et=Ie.width*.01,ct=Ie.position[0]-et/2,mt=Ie.position[0]+et/2,je=Ge-B(U?120:80);return l.jsxs("group",{children:[l.jsx(it,{points:[[ct,E,je],[mt,E,je]],color:"#FF0000",lineWidth:.5}),l.jsx(it,{points:te([ct,E,je],[ct+.02,E,je],.01),color:"#FF0000",lineWidth:.5}),l.jsx(it,{points:te([mt,E,je],[mt-.02,E,je],.01),color:"#FF0000",lineWidth:.5}),l.jsx(zn,{position:[Ie.position[0],E+.1,je-B(30)],fontSize:K,color:"#FF0000",anchorX:"center",anchorY:"middle",rotation:[-Math.PI/2,0,0],children:Math.round(Ie.width)}),l.jsx(it,{points:[[ct,E,Ge],[ct,E,je-B(50)]],color:_,lineWidth:.5}),l.jsx(it,{points:[[mt,E,Ge],[mt,E,je-B(50)]],color:_,lineWidth:.5})]},`top-column-dim-${Ie.id}`)}),!1,!1]})})},ce=()=>null;return console.log("🎨 CleanCAD2D 최종 렌더링:",{currentViewDirection:j,showDimensions:u,hasColumns:!!r.columns,columnCount:($e=r.columns)==null?void 0:$e.length,shouldRenderColumns:j==="front"}),l.jsxs("group",{ref:f,renderOrder:999999,children:[fe(),ce(),((ot=r.droppedCeiling)==null?void 0:ot.enabled)&&j==="front"&&!1]})},P$=({viewMode:n,view2DDirection:e="front",enabled:t=!0,showAxis:i=!0})=>{const{camera:r}=jl(),s=O.useRef(null),{theme:o}=Yh(),{view2DTheme:a}=Bi();O.useMemo(()=>{const x=r.position.length();let T,j,D;return T=1,j=.1,x<5?D=x*30:x<15?D=x*25:x<40?D=x*20:D=x*15,{major:T,minor:j,size:Math.max(D,1e3)}},[r.position]);const c=O.useMemo(()=>{if(n==="2D")return{rotation:[0,0,0],position:[0,0,0]};switch(e){case"front":return{rotation:[0,0,0],position:[0,0,0]};case"left":return{rotation:[0,Math.PI/2,0],position:[0,0,0]};case"right":return{rotation:[0,-Math.PI/2,0],position:[0,0,0]};case"top":return{rotation:[-Math.PI/2,0,0],position:[0,0,.01]};default:return{rotation:[0,0,0],position:[0,0,0]}}},[e,n]),h=O.useMemo(()=>({minor:o.mode==="dark"?"#444444":"#dddddd",major:o.mode==="dark"?"#555555":"#bbbbbb",origin:o.mode==="dark"?"#888888":"#666666"}),[o.mode]),{majorLines:u,minorLines:d,axis1Lines:f,axis2Lines:A,axis1Color:g,axis2Color:p}=O.useMemo(()=>{if(n==="3D")return{majorLines:null,minorLines:null,axis1Lines:null,axis2Lines:null,axis1Color:16711680,axis2Color:255};const x=200,T=1,j=.1;console.log("🔲 CADGrid 렌더링:",{theme:o.mode,viewMode:n,view2DDirection:e,enabled:t,major:T,minor:j,size:x,gridColors:{minor:h.minor,major:h.major,origin:h.origin},majorPointsLength:"generating...",minorPointsLength:"generating..."});const D=[],b=[];switch(e){case"front":for(let B=-x;B<=x;B+=T)D.push(B,-x,0,B,x,0),D.push(-x,B,0,x,B,0);for(let B=-x;B<=x;B+=j)Math.abs(B%T)<.001||(b.push(B,-x,0,B,x,0),b.push(-x,B,0,x,B,0));break;case"top":for(let B=-x;B<=x;B+=T)D.push(B,0,-x,B,0,x),D.push(-x,0,B,x,0,B);for(let B=-x;B<=x;B+=j)Math.abs(B%T)<.001||(b.push(B,0,-x,B,0,x),b.push(-x,0,B,x,0,B));break;case"left":case"right":for(let B=-x;B<=x;B+=T)D.push(0,B,-x,0,B,x),D.push(0,-x,B,0,x,B);for(let B=-x;B<=x;B+=j)Math.abs(B%T)<.001||(b.push(0,B,-x,0,B,x),b.push(0,-x,B,0,x,B));break;default:for(let B=-x;B<=x;B+=T)D.push(B,-x,0,B,x,0),D.push(-x,B,0,x,B,0);for(let B=-x;B<=x;B+=j)Math.abs(B%T)<.001||(b.push(B,-x,0,B,x,0),b.push(-x,B,0,x,B,0));break}let _=[],I=[],S=16711680,F=255;switch(e){case"front":_=[-x,0,0,x,0,0],I=[0,-x,0,0,x,0],S=16711680,F=255;break;case"top":_=[-x,0,0,x,0,0],I=[0,0,-x,0,0,x],S=16711680,F=65280;break;case"left":_=[0,0,-x,0,0,x],I=[0,-x,0,0,x,0],S=65280,F=255;break;case"right":_=[0,0,-x,0,0,x],I=[0,-x,0,0,x,0],S=65280,F=255;break;default:_=[-x,0,0,x,0,0],I=[0,-x,0,0,x,0],S=16711680,F=255;break}return console.log("🔲 그리드 라인 생성 완료:",{majorCount:D.length/6,minorCount:b.length/6}),{majorLines:new Float32Array(D),minorLines:new Float32Array(b),axis1Lines:new Float32Array(_),axis2Lines:new Float32Array(I),axis1Color:S,axis2Color:F}},[t,n,e,h]),y=O.useRef(null),v=O.useRef(null),[m,w]=O.useState(!1);return QC(()=>{if(!t||n==="3D"||!s.current)return;s.current.visible=!0,s.current.renderOrder=-1e3;const x=n==="2D"&&"zoom"in r?100/r.zoom:r.position.length(),T=200;let j=100;if(n==="2D"&&"zoom"in r){const _=r,I=(_.top-_.bottom)/_.zoom,S=(_.right-_.left)/_.zoom;j=Math.max(I,S)}const D=T/j;let b=1;D<.8?b=0:x<=10?b=1:x<=30?b=1-(x-10)/20*.6:x<=60?b=.4-(x-30)/30*.3:b=0,b=Math.max(b,0),y.current&&(y.current.opacity=.3*b,y.current.needsUpdate=!0),v.current&&(v.current.opacity=.5*b,v.current.needsUpdate=!0),Math.random()<.001&&console.log("🔲 Grid opacity:",{distance:x,opacity:b,minorOpacity:.3*b,majorOpacity:.5*b,zoom:"zoom"in r?r.zoom:"N/A",gridSize:T,viewportSize:j,gridToViewportRatio:D})}),n==="3D"||!f||!A?null:n==="2D"?l.jsxs(l.Fragment,{children:[t&&u&&d&&l.jsxs("group",{ref:s,position:c.position,rotation:c.rotation,children:[l.jsxs("lineSegments",{renderOrder:-999,children:[l.jsx("bufferGeometry",{children:l.jsx("bufferAttribute",{args:[d,3],attach:"attributes-position",count:d.length/3,array:d,itemSize:3})}),l.jsx("lineBasicMaterial",{ref:y,color:h.minor,opacity:.3,transparent:!0,depthTest:!1,depthWrite:!1})]}),l.jsxs("lineSegments",{renderOrder:-998,children:[l.jsx("bufferGeometry",{children:l.jsx("bufferAttribute",{args:[u,3],attach:"attributes-position",count:u.length/3,array:u,itemSize:3})}),l.jsx("lineBasicMaterial",{ref:v,color:h.major,opacity:.5,transparent:!0,depthTest:!1,depthWrite:!1})]})]}),i&&l.jsxs("group",{position:[0,0,0],rotation:[0,0,0],children:[l.jsxs("lineSegments",{renderOrder:-997,children:[l.jsx("bufferGeometry",{children:l.jsx("bufferAttribute",{args:[f,3],attach:"attributes-position",count:f.length/3,array:f,itemSize:3})}),l.jsx("lineBasicMaterial",{color:g,opacity:.6,transparent:!0,depthTest:!1,depthWrite:!1})]}),l.jsxs("lineSegments",{renderOrder:-996,children:[l.jsx("bufferGeometry",{children:l.jsx("bufferAttribute",{args:[A,3],attach:"attributes-position",count:A.length/3,array:A,itemSize:3})}),l.jsx("lineBasicMaterial",{color:p,opacity:.6,transparent:!0,depthTest:!1,depthWrite:!1})]}),l.jsxs("mesh",{position:[0,0,.01],renderOrder:-995,children:[l.jsx("sphereGeometry",{args:[.05]}),l.jsx("meshBasicMaterial",{color:h.origin,opacity:.8,transparent:!0})]})]})]}):l.jsxs("group",{ref:s,position:c.position,rotation:c.rotation,children:[l.jsxs("lineSegments",{renderOrder:-999,children:[l.jsx("bufferGeometry",{children:l.jsx("bufferAttribute",{args:[d,3],attach:"attributes-position",count:d.length/3,array:d,itemSize:3})}),l.jsx("lineBasicMaterial",{color:n==="2D"&&a==="dark"?"#444444":"#dddddd",opacity:.3,transparent:!0,depthTest:!1,depthWrite:!1})]}),l.jsxs("lineSegments",{renderOrder:-998,children:[l.jsx("bufferGeometry",{children:l.jsx("bufferAttribute",{args:[u,3],attach:"attributes-position",count:u.length/3,array:u,itemSize:3})}),l.jsx("lineBasicMaterial",{color:n==="2D"&&a==="dark"?"#555555":"#bbbbbb",opacity:.4,transparent:!0,depthTest:!1,depthWrite:!1})]}),l.jsxs("lineSegments",{renderOrder:-997,children:[l.jsx("bufferGeometry",{children:l.jsx("bufferAttribute",{args:[f,3],attach:"attributes-position",count:f.length/3,array:f,itemSize:3})}),l.jsx("lineBasicMaterial",{color:g,opacity:.6,transparent:!0,depthTest:!1,depthWrite:!1})]}),l.jsxs("lineSegments",{renderOrder:-996,children:[l.jsx("bufferGeometry",{children:l.jsx("bufferAttribute",{args:[A,3],attach:"attributes-position",count:A.length/3,array:A,itemSize:3})}),l.jsx("lineBasicMaterial",{color:p,opacity:.6,transparent:!0,depthTest:!1,depthWrite:!1})]}),l.jsxs("mesh",{position:[0,0,.01],renderOrder:-995,children:[l.jsx("sphereGeometry",{args:[.05]}),l.jsx("meshBasicMaterial",{color:h.origin})]})]})},Yhe=({spaceInfo:n})=>{var d;if(!((d=n.droppedCeiling)!=null&&d.enabled))return null;const e=zb(n);if(!e)return null;const{position:t}=n.droppedCeiling,i=n.depth||600,r=n.droppedCeiling.dropHeight||200;console.log("🏗️ DroppedCeilingSpace 디버그:",{bounds:e,position:t,dropHeight:r,depth:i,spaceHeight:n.height});const s=El(e.startX),o=El(e.width),a=El(e.height),c=El(r),h=El(i),u=El(n.height);return isNaN(o)||isNaN(a)||isNaN(h)||isNaN(c)||isNaN(s)||isNaN(u)?(console.error("🚨 DroppedCeilingSpace - NaN 값 감지:",{threeStartX:s,threeWidth:o,threeHeight:a,threeDropHeight:c,threeDepth:h,threeSpaceHeight:u,bounds:e,dropHeight:r,depth:i}),null):l.jsx("group",{})},Zhe=ii.memo(Yhe),N$=({spaceInfo:n,showAll:e=!0,showDimensions:t=!0,viewMode:i})=>{var E,V,K,P;const r=ci(M=>M.placedModules),s=ci(M=>M.addModule),o=ci(M=>M.currentDragData),a=ci(M=>M.setCurrentDragData);ci(M=>M.setFurniturePlacementMode);const{showAlert:c}=coe(),{camera:h,scene:u}=jl(),{viewMode:d}=Qi(),{view2DDirection:f}=Bi(),A=i||d;console.log("🔴🔴🔴 SlotDropZonesSimple - 렌더링 상태:",{viewModeProp:i,contextViewMode:d,finalViewMode:A,is3D:A==="3D",showAll:e,showDimensions:t,timestamp:new Date().toISOString()});const{theme:g}=Yo(),[p,y]=O.useState(null),[v,m]=O.useState(null);if(!n)return console.error("❌ No spaceInfo provided to SlotDropZonesSimple"),null;if(console.log("🔍 SlotDropZonesSimple - spaceInfo:",{width:n.width,height:n.height,depth:n.depth,surroundType:n.surroundType,gapConfig:n.gapConfig,customColumnCount:n.customColumnCount,columnMode:n.columnMode}),!n.width||!n.height||!n.depth)return console.error("❌ Invalid spaceInfo dimensions:",{width:n.width,height:n.height,depth:n.depth}),l.jsx("group",{});const w=kr(n),x=ur(n);if(console.log("🔍 SlotDropZonesSimple - calculated values:",{internalSpace:w,indexing:{columnCount:x==null?void 0:x.columnCount,columnWidth:x==null?void 0:x.columnWidth,threeUnitPositionsLength:(E=x==null?void 0:x.threeUnitPositions)==null?void 0:E.length,slotWidths:x==null?void 0:x.slotWidths}}),!x||!x.threeUnitPositions||!Array.isArray(x.threeUnitPositions))return console.error("❌ Invalid indexing data:",{indexing:x,hasIndexing:!!x,hasThreeUnitPositions:!!(x!=null&&x.threeUnitPositions),isArray:Array.isArray(x==null?void 0:x.threeUnitPositions),spaceInfo:n}),l.jsx("group",{});const T=Zle(n),j=Jle(n);n.baseConfig&&console.log("🔧 베이스프레임 및 슬롯 위치 정보:",{baseType:n.baseConfig.type,baseHeight:n.baseConfig.height,placementType:n.baseConfig.placementType,floatHeight:n.baseConfig.floatHeight,slotStartY:j,slotHeight:T.height,슬롯중심Y:j+T.height/2,floorFinishHeight:n.hasFloorFinish?(V=n.floorFinish)==null?void 0:V.height:0});const D=M=>M*.01,b=O.useRef(),_=O.useCallback((M,X)=>{var et,ct,mt,je,le,Je,ht,ut,ft,jt,Wt,Mt,dn,on,Et,an,Mn,At,zt,Zt,$t,Ht,Lt,dt,at,Ot,Cn,Rn,xn,En,Hn,Kn,Ti,ti,ai,Gi,fi,Oi,rn,$n,Fn,pt,vt,kt,mn,sn,bn,Li,Wn,ui,Mi,Gn,Dn,li,en,Rt,Xn,Ui;const Z=ci.getState(),Q=Z.currentDragData,U=Z.placedModules,z=qi.getState().spaceInfo;kr(z),ur(z),console.log("🎯 handleSlotDrop called:",{hasLatestDragData:!!Q,latestDragData:Q,droppedCeilingEnabled:(et=z.droppedCeiling)==null?void 0:et.enabled,droppedCeilingWidth:(ct=z.droppedCeiling)==null?void 0:ct.width,surroundType:z.surroundType,hasIndexingZones:!!(x!=null&&x.zones)});const q=X.getBoundingClientRect(),G=(M.clientX-q.left)/q.width*2-1,ie=-((M.clientY-q.top)/q.height)*2+1;let H;const se=n.droppedCeiling&&n.droppedCeiling.enabled===!0;if(console.log("🔍 [SlotDropZonesSimple] 단내림 체크:",{hasDroppedCeiling:se,droppedCeiling:n.droppedCeiling,enabled:(mt=n.droppedCeiling)==null?void 0:mt.enabled,width:(je=n.droppedCeiling)==null?void 0:je.width,position:(le=n.droppedCeiling)==null?void 0:le.position}),se)try{console.log("🔍 [SlotDropZonesSimple] calculateZoneSlotInfo 호출 전:",{surroundType:n.surroundType,installType:n.installType,droppedCeiling:n.droppedCeiling,customColumnCount:n.customColumnCount});const tt=wr.calculateZoneSlotInfo(n,n.customColumnCount);if(console.log("🔍 [SlotDropZonesSimple] calculateZoneSlotInfo 결과:",{zoneInfo:tt,hasDropped:!!(tt!=null&&tt.dropped),hasNormal:!!(tt!=null&&tt.normal)}),tt&&tt.normal&&tt.dropped){const Jt=D(tt.dropped.startX+tt.dropped.width),wn=D(tt.normal.startX),Yn=new N0;Yn.setFromCamera(new yf(G,ie),h);const hi=D(w.startY),Xt=new O2(new so(0,1,0),-hi),_i=new so;Yn.ray.intersectPlane(Xt,_i)?(n.droppedCeiling.position==="left"?H=_i.x<Jt?"dropped":"normal":H=_i.x>=wn?"dropped":"normal",console.log("🎯 자동 영역 판단:",{mouseX:G,mouseY:ie,worldX:_i.x,droppedEndX:Jt,normalStartX:wn,droppedPosition:n.droppedCeiling.position,detectedZone:H,zoneInfo:{normal:{columnCount:(Je=tt.normal)==null?void 0:Je.columnCount,startX:(ht=tt.normal)==null?void 0:ht.startX,width:(ut=tt.normal)==null?void 0:ut.width},dropped:{columnCount:(ft=tt.dropped)==null?void 0:ft.columnCount,startX:(jt=tt.dropped)==null?void 0:jt.startX,width:(Wt=tt.dropped)==null?void 0:Wt.width}}})):(H="normal",console.log("⚠️ 평면과의 교차점을 찾지 못함, 기본값 사용:",H))}else console.error("⚠️ Zone info is null or incomplete:",{zoneInfo:tt,spaceInfo:{surroundType:n.surroundType,installType:n.installType,droppedCeiling:n.droppedCeiling}}),H="normal"}catch(tt){console.error("❌ 자동 영역 판단 중 오류:",tt),H="normal"}let te=null;try{const tt=(Mt=M.dataTransfer)==null?void 0:Mt.getData("application/json");console.log("📋 Drag data string:",tt),tt&&(te=JSON.parse(tt))}catch(tt){console.error("Error parsing drag data:",tt)}if(te||(console.log("⚠️ No drag data from event, checking store..."),te=Q,console.log("🔄 Using latest drag data from store:",te)),console.log("📦 Effective drag data:",te),!te||te.type!=="furniture")return console.log("❌ Invalid drag data:",{dragData:te,type:te==null?void 0:te.type}),!1;if((dn=te.moduleData)!=null&&dn.needsWarning)return console.log("⚠️ 슬롯 사이즈 부족 - 배치 불가"),!1;if((on=z.droppedCeiling)!=null&&on.enabled&&H){const tt=wr.calculateZoneSlotInfo(z,z.customColumnCount);let Jt,wn;if(H==="dropped"&&tt.dropped){const un=((Et=z.droppedCeiling)==null?void 0:Et.width)||yo.WIDTH,Vn={...z,width:un,customColumnCount:tt.dropped.columnCount};console.log("🚨 [SlotDropZonesSimple] 단내림 영역 spaceInfo:",{surroundType:Vn.surroundType,installType:Vn.installType,width:Vn.width,customColumnCount:Vn.customColumnCount});const Ln=((an=z.droppedCeiling)==null?void 0:an.dropHeight)||200;wn={width:tt.dropped.width,height:z.height-Ln,depth:z.depth,startX:tt.dropped.startX,startY:0,startZ:-(z.depth/2)},console.log("🔧 [SlotDropZonesSimple] 단내림 영역 내경 (zoneInfo 사용):",{width:wn.width,startX:wn.startX,originalHeight:z.height,dropHeight:Ln,adjustedHeight:wn.height,zone:"dropped"}),Jt={columnCount:tt.dropped.columnCount,columnWidth:tt.dropped.columnWidth,threeUnitPositions:[],threeUnitDualPositions:[],threeUnitBoundaries:[],slotWidths:tt.dropped.slotWidths||Array(tt.dropped.columnCount).fill(tt.dropped.columnWidth)}}else wn={width:tt.normal.width,height:z.height,depth:z.depth,startX:tt.normal.startX,startY:0,startZ:-(z.depth/2)},console.log("🔧 [SlotDropZonesSimple] 메인 영역 내경 (zoneInfo 사용):",{width:wn.width,startX:wn.startX,height:wn.height,zone:"normal"}),Jt={columnCount:tt.normal.columnCount,columnWidth:tt.normal.columnWidth,threeUnitPositions:[],threeUnitDualPositions:[],threeUnitBoundaries:[],slotWidths:tt.normal.slotWidths||Array(tt.normal.columnCount).fill(tt.normal.columnWidth)};let Yn=GS(M.clientX,M.clientY,X,h,u),hi;if(Yn!==null&&((Mn=z.droppedCeiling)!=null&&Mn.enabled)){const un=[];u.traverse(Ln=>{var ee,we;(ee=Ln.userData)!=null&&ee.isSlotCollider&&((we=Ln.userData)==null?void 0:we.slotIndex)===Yn&&un.push(Ln)});const Vn=un.filter(Ln=>Ln.userData.slotIndex===Yn);if(console.log("🔍 Colliders with matching slotIndex:",{slotIndex:Yn,matchingColliders:Vn.map(Ln=>({zone:Ln.userData.zone,position:Ln.position.x}))}),Vn.length>0){const Ln=X.getBoundingClientRect(),ee=(M.clientX-Ln.left)/Ln.width*2-1,we=new N0;we.setFromCamera(new yf(ee,0),h);const He=D(w.startY),lt=new O2(new so(0,1,0),-He),_t=new so;if(we.ray.intersectPlane(lt,_t)){let ln=Vn[0],vn=Math.abs(_t.x-ln.position.x);for(const si of Vn){const oi=Math.abs(_t.x-si.position.x);oi<vn&&(vn=oi,ln=si)}hi=ln.userData.zone,console.log("🎯 Detected collider zone:",{colliderZone:hi,mouseX:_t.x,colliderX:ln.position.x,distance:vn})}}}if(console.log("🎰 Slot index from raycast (dropped zone):",{slotIndex:Yn,zoneToUse:H,colliderZone:hi,zoneMismatch:hi&&H!==hi,droppedInfo:n.droppedCeiling,zoneInfo:{normal:{columnCount:(At=tt.normal)==null?void 0:At.columnCount,startX:(zt=tt.normal)==null?void 0:zt.startX,width:(Zt=tt.normal)==null?void 0:Zt.width},dropped:{columnCount:($t=tt.dropped)==null?void 0:$t.columnCount,startX:(Ht=tt.dropped)==null?void 0:Ht.startX,width:(Lt=tt.dropped)==null?void 0:Lt.width}},validationCheck:{isDroppedZone:H==="dropped",droppedExists:!!tt.dropped,slotIndexVsColumnCount:`${Yn} >= ${(dt=tt.dropped)==null?void 0:dt.columnCount}`,willFail:H==="dropped"&&(!tt.dropped||Yn>=tt.dropped.columnCount)}}),hi&&H!==hi&&(console.warn("⚠️ Zone mismatch detected!",{detectedZone:H,colliderZone:hi,slotIndex:Yn}),H=hi,console.log("🔧 Corrected zone to match collider:",H)),Yn===null)if(console.log("❌ No slot index found (dropped zone)"),(at=n.droppedCeiling)!=null&&at.enabled&&H&&tt[H]){const un=tt[H],Vn=X.getBoundingClientRect(),Ln=(M.clientX-Vn.left)/Vn.width*2-1,ee=new N0;ee.setFromCamera(new yf(Ln,0),h);const we=D(w.startY),He=new O2(new so(0,1,0),-we),lt=new so;if(ee.ray.intersectPlane(He,lt)){const _t=D(un.startX),ln=D(un.startX+un.width);if(lt.x>=_t&&lt.x<=ln){const vn=lt.x-_t,si=D(un.columnWidth);Yn=Math.floor(vn/si),Yn=Math.max(0,Math.min(Yn,un.columnCount-1)),console.log("🔧 Fallback slot index calculation:",{zoneToUse:H,mouseWorldX:lt.x,zoneStartX:_t,zoneEndX:ln,relativeX:vn,columnWidth:si,calculatedSlotIndex:Yn})}else return console.error("❌ Mouse position outside target zone"),!1}else return console.error("❌ Failed to calculate world position"),!1}else return!1;const Xt=Yn;if(H==="dropped"&&!tt.dropped)return console.error("❌ Dropped zone info is null"),!1;if(H==="normal"&&!tt.normal)return console.error("❌ Normal zone info is null"),!1;const _i=H==="dropped"?tt.dropped:tt.normal;if(_i&&Yn>=_i.columnCount){console.error("❌ Invalid slot index for zone:",{zone:H,slotIndex:Yn,columnCount:_i.columnCount,validRange:`0-${_i.columnCount-1}`,allZoneInfo:{normal:{columnCount:(Ot=tt.normal)==null?void 0:Ot.columnCount,startX:(Cn=tt.normal)==null?void 0:Cn.startX},dropped:{columnCount:(Rn=tt.dropped)==null?void 0:Rn.columnCount,startX:(xn=tt.dropped)==null?void 0:xn.startX}}});const un=[];u.traverse(Ln=>{var ee;(ee=Ln.userData)!=null&&ee.isSlotCollider&&un.push(Ln)}),console.log("🔍 Re-checking colliders for debugging:",{totalColliders:un.length,droppedZoneColliders:un.filter(Ln=>Ln.userData.zone==="dropped").map(Ln=>({slotIndex:Ln.userData.slotIndex,position:Ln.position.x})),normalZoneColliders:un.filter(Ln=>Ln.userData.zone==="normal").map(Ln=>({slotIndex:Ln.userData.slotIndex,position:Ln.position.x}))});const Vn=Math.min(Yn,_i.columnCount-1);console.log("🔧 Temporarily correcting slot index:",Yn,"->",Vn),Yn=Vn}Yn<0&&(console.error("❌ Invalid negative slot index:",Yn),Yn=0);const Pr=((En=n.droppedCeiling)==null?void 0:En.width)||yo.WIDTH;(Hn=n.droppedCeiling)!=null&&Hn.position;let ws;H==="dropped"?ws=Pr:ws=n.width-Pr;const Vi=H==="dropped"?tt.dropped:tt.normal;if(!Vi)return console.error("❌ Target zone is null:",{zoneToUse:H,zoneInfo:tt}),!1;const br={...n,zone:H,width:ws};console.log("🔧 [SlotDropZonesSimple] zoneSpaceInfo 생성:",{zone:H,droppedCeilingEnabled:(Kn=br.droppedCeiling)==null?void 0:Kn.enabled,zoneSpaceInfo:{width:br.width,zone:br.zone,droppedCeiling:br.droppedCeiling}});const _r=kr(br);if(H==="dropped"){const un=((Ti=n.droppedCeiling)==null?void 0:Ti.dropHeight)||200;_r.height=Math.max(_r.height-un,100)}console.log("🔧 [SlotDropZonesSimple] 영역별 내경 공간 재계산:",{zone:H,originalInternalSpace:wn,recalculatedInternalSpace:_r});const Qr=cI(_r,br);console.log("🎯 단내림 구간 모듈 생성 결과:",{zoneToUse:H,moduleCount:Qr.length,zoneInternalSpace:wn,zoneSpaceInfo:{width:br.width,zone:br.zone,customColumnCount:br.customColumnCount},firstModule:Qr[0]});const ue=te.moduleData.id.replace(/-\d+$/,"");let ke=te.moduleData.id.startsWith("dual-"),Me;if(ke&&Jt.slotWidths&&Xt<Jt.slotWidths.length-1)Me=Jt.slotWidths[Xt]+Jt.slotWidths[Xt+1];else if(Jt.slotWidths&&Jt.slotWidths[Xt]!==void 0)Me=Jt.slotWidths[Xt];else{const un=Jt.columnWidth;Me=ke?un*2:un}const Oe=`${ue}-${Me}`;console.log("🔍 가구 검색:",{원본ID:te.moduleData.id,기본타입:ue,목표너비:Me,찾는ID:Oe,isDual:ke,생성된모듈수:Qr.length,생성된모듈들:Qr.map(un=>({id:un.id,width:un.dimensions.width}))});let nt=Hi(Oe,_r,br);if(nt||(console.warn("⚠️ 영역 기준 모듈 미존재. 전역 기준으로 재시도:",{targetModuleId:Oe,zone:H}),nt=Hi(Oe,w,n)),nt||(console.warn("⚠️ 전역 기준에도 모듈 미존재. 드래그 원본 모듈로 대체 후 customWidth 사용:",{targetModuleId:Oe}),nt=te.moduleData),ke&&Xt+1>=Vi.columnCount){console.log("🚫 듀얼 가구가 영역 경계를 넘어감:",{zone:H,zoneSlotIndex:Xt,targetZoneColumnCount:Vi.columnCount,필요한슬롯:[Xt,Xt+1],영역범위:`0 ~ ${Vi.columnCount-1}`}),console.log("🔁 듀얼 → 싱글 자동 전환 (경계)");const un=((ti=Jt.slotWidths)==null?void 0:ti[Xt])||Jt.columnWidth,Vn=`${ue}-${un}`;nt=Hi(Vn,_r,br)||Hi(Vn,w,n)||te.moduleData,ke=!1}const gt=(ai=n.droppedCeiling)!=null&&ai.enabled?U.filter(un=>un.zone===H):U;console.log("📊 현재 슬롯 점유 상태:",{zone:H,existingModules:gt.map(un=>({id:un.id,slotIndex:un.slotIndex,isDualSlot:un.isDualSlot,occupiedSlots:un.isDualSlot?[un.slotIndex,un.slotIndex+1]:[un.slotIndex]}))});let Ae=gt.some(un=>{if(ke){let Vn=!1;return un.isDualSlot?Vn=un.slotIndex===Xt||un.slotIndex===Xt+1||un.slotIndex===Xt-1||un.slotIndex+1===Xt:Vn=un.slotIndex===Xt||un.slotIndex===Xt+1,Vn&&console.log("🚫 듀얼 가구 슬롯 충돌:",{배치하려는가구:{slotIndex:Xt,isDual:!0,occupiedSlots:[Xt,Xt+1]},기존가구:{id:un.id,slotIndex:un.slotIndex,isDualSlot:un.isDualSlot,occupiedSlots:un.isDualSlot?[un.slotIndex,un.slotIndex+1]:[un.slotIndex]}}),Vn}else{const Vn=un.slotIndex===Xt||un.isDualSlot&&(un.slotIndex===Xt||un.slotIndex+1===Xt);return Vn&&console.log("🚫 싱글 가구 슬롯 충돌:",{배치하려는가구:{slotIndex:Xt,isDual:!1,occupiedSlots:[Xt]},기존가구:{id:un.id,slotIndex:un.slotIndex,isDualSlot:un.isDualSlot,occupiedSlots:un.isDualSlot?[un.slotIndex,un.slotIndex+1]:[un.slotIndex]}}),Vn}});if(Ae)if(ke){console.log("🔁 듀얼 충돌 → 싱글로 재시도");const un=((Gi=Jt.slotWidths)==null?void 0:Gi[Xt])||Jt.columnWidth,Vn=`${ue}-${un}`;if(nt=Hi(Vn,_r,br)||Hi(Vn,w,n)||te.moduleData,ke=!1,Ae=gt.some(Ln=>Ln.slotIndex===Xt||Ln.isDualSlot&&(Ln.slotIndex===Xt||Ln.slotIndex+1===Xt)),Ae)return console.log("❌ 싱글 전환 후에도 충돌. 배치 불가"),!1}else return console.log("❌ 슬롯 충돌로 배치 불가"),!1;let me;const Xe=ur(n);if(console.log("🚨🚨 fullIndexing.zones 확인:",{hasZones:!!Xe.zones,hasNormal:!!((fi=Xe.zones)!=null&&fi.normal),hasDropped:!!((Oi=Xe.zones)!=null&&Oi.dropped),normalInfo:(rn=Xe.zones)!=null&&rn.normal?{startX:Xe.zones.normal.startX,width:Xe.zones.normal.width,columnCount:Xe.zones.normal.columnCount,threeUnitPositions:Xe.zones.normal.threeUnitPositions,threeUnitDualPositions:Xe.zones.normal.threeUnitDualPositions}:null,droppedInfo:($n=Xe.zones)!=null&&$n.dropped?{startX:Xe.zones.dropped.startX,width:Xe.zones.dropped.width,columnCount:Xe.zones.dropped.columnCount,threeUnitPositions:Xe.zones.dropped.threeUnitPositions,threeUnitDualPositions:Xe.zones.dropped.threeUnitDualPositions}:null,zoneToUse:H,zoneSlotIndex:Xt,isDual:ke,spaceInfo:{surroundType:n.surroundType,installType:n.installType,droppedCeiling:n.droppedCeiling}}),H==="dropped"&&((Fn=Xe.zones)!=null&&Fn.dropped)){const un=Xe.zones.dropped.threeUnitPositions;if(!un||un.length===0){console.error("⚠️ zones.dropped.threeUnitPositions가 없습니다. 직접 계산합니다.");const Vn=tt.dropped.startX,Ln=[];let ee=Vn;for(let we=0;we<tt.dropped.columnCount;we++){const He=((pt=tt.dropped.slotWidths)==null?void 0:pt[we])||tt.dropped.columnWidth,lt=ee+He/2;Ln.push(D(lt)),ee+=He}if(console.log("📍 직접 계산한 dropped positions:",{startX:Vn,positions:Ln,columnCount:tt.dropped.columnCount}),ke&&Xt<Ln.length-1){const we=Ln[Xt],He=Ln[Xt+1];me=(we+He)/2}else me=Ln[Xt]||0}else if(ke&&Xt<un.length-1)if(Xe.zones.dropped.threeUnitDualPositions&&Xe.zones.dropped.threeUnitDualPositions[Xt]!==void 0)me=Xe.zones.dropped.threeUnitDualPositions[Xt];else{const Vn=un[Xt],Ln=un[Xt+1];me=(Vn+Ln)/2}else me=un[Xt];console.log("🎯 단내림 영역 위치 계산:",{zoneSlotIndex:Xt,isDual:ke,droppedPositions:un,dualPositions:Xe.zones.dropped.threeUnitDualPositions,selectedDualPosition:ke?(vt=Xe.zones.dropped.threeUnitDualPositions)==null?void 0:vt[Xt]:null,finalX:me,gapConfig:n.gapConfig,zoneInfo:{columnCount:Xe.zones.dropped.columnCount,startX:Xe.zones.dropped.internalStartX}})}else if((kt=Xe.zones)!=null&&kt.normal){const un=Xe.zones.normal.threeUnitPositions;if(!un||un.length===0){console.error("⚠️ zones.normal.threeUnitPositions가 없습니다. 직접 계산합니다.");const Vn=tt.normal.startX,Ln=[];let ee=Vn;for(let we=0;we<tt.normal.columnCount;we++){const He=((mn=tt.normal.slotWidths)==null?void 0:mn[we])||tt.normal.columnWidth,lt=ee+He/2;Ln.push(D(lt)),ee+=He}if(console.log("📍 직접 계산한 normal positions:",{startX:Vn,positions:Ln,columnCount:tt.normal.columnCount}),ke&&Xt<Ln.length-1){const we=Ln[Xt],He=Ln[Xt+1];me=(we+He)/2}else me=Ln[Xt]||0}else if(ke&&Xt<un.length-1)if(Xe.zones.normal.threeUnitDualPositions&&Xe.zones.normal.threeUnitDualPositions[Xt]!==void 0)me=Xe.zones.normal.threeUnitDualPositions[Xt];else{const Vn=un[Xt],Ln=un[Xt+1];me=(Vn+Ln)/2}else me=un[Xt];console.log("🎯 메인 영역 위치 계산:",{zoneSlotIndex:Xt,isDual:ke,normalPositions:un,dualPositions:Xe.zones.normal.threeUnitDualPositions,selectedDualPosition:ke?(sn=Xe.zones.normal.threeUnitDualPositions)==null?void 0:sn[Xt]:null,finalX:me,gapConfig:n.gapConfig,zoneInfo:{columnCount:Xe.zones.normal.columnCount,startX:Xe.zones.normal.internalStartX}})}else{console.warn("⚠️ fullIndexing.zones가 없습니다. zoneInfo에서 직접 계산합니다.");const un=H==="dropped"?tt.dropped:tt.normal,Vn=un.startX,Ln=[];let ee=Vn;for(let we=0;we<un.columnCount;we++){const He=((bn=un.slotWidths)==null?void 0:bn[we])||un.columnWidth,lt=ee+He/2;Ln.push(D(lt)),ee+=He}if(console.log("📍 fallback - 직접 계산한 positions:",{zone:H,startX:Vn,positions:Ln,columnCount:un.columnCount}),ke&&Xt<Ln.length-1)if(x.threeUnitDualPositions&&x.threeUnitDualPositions[Xt]!==void 0)me=x.threeUnitDualPositions[Xt];else{const we=Ln[Xt],He=Ln[Xt+1];me=(we+He)/2}else me=Ln[Xt]}const qe=H==="dropped"?`dropped-${Date.now()}-${Math.random().toString(36).substr(2,9)}`:`placed-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,nn=(nt==null?void 0:nt.defaultDepth)||Math.min(Math.floor(n.depth*.9),580),An=Jt.slotWidths&&Jt.slotWidths[Xt]!==void 0?Jt.slotWidths[Xt]:Jt.columnWidth,Ct=Rc(n);let kn=Xt;(Li=n.droppedCeiling)!=null&&Li.enabled&&((Wn=n.droppedCeiling)!=null&&Wn.position)&&(n.droppedCeiling.position==="right"&&H==="dropped"?kn=Xt+tt.normal.columnCount:n.droppedCeiling.position==="left"&&H==="normal"&&(kn=Xt+tt.dropped.columnCount));const fn=Ct[kn];console.log("🏛️ 기둥 분석 인덱스:",{zoneToUse:H,zoneSlotIndex:Xt,slotIndex:Yn,globalSlotIndex:kn,columnSlotsLength:Ct.length,slotInfo:fn?{hasColumn:fn.hasColumn,availableWidth:fn.availableWidth,adjustedWidth:fn.adjustedWidth}:null});let Qt,Qn,Tn=me,Nn,pn=!1,tr,Nr=0;if(ke){const un=Ct[kn],Vn=Ct[kn+1];if(console.log("🏛️ 듀얼 가구 슬롯 기둥 확인:",{slot1:{index:kn,hasColumn:(un==null?void 0:un.hasColumn)||!1,columnType:un==null?void 0:un.columnType,availableWidth:(un==null?void 0:un.availableWidth)||_i.columnWidth},slot2:{index:kn+1,hasColumn:(Vn==null?void 0:Vn.hasColumn)||!1,columnType:Vn==null?void 0:Vn.columnType,availableWidth:(Vn==null?void 0:Vn.availableWidth)||_i.columnWidth}}),un!=null&&un.hasColumn||Vn!=null&&Vn.hasColumn){pn=!0;const Ln=un!=null&&un.hasColumn?un.availableWidth:_i.columnWidth,ee=Vn!=null&&Vn.hasColumn?Vn.availableWidth:_i.columnWidth;Nr=Ln+ee,un!=null&&un.hasColumn&&un.columnType!=="medium"?tr=un.columnType:Vn!=null&&Vn.hasColumn&&Vn.columnType!=="medium"?tr=Vn.columnType:tr="medium",console.log("🏛️ 듀얼 가구 기둥 처리:",{totalAvailableWidth:Nr,originalWidth:nt.dimensions.width,columnType:tr,willAdjust:tr!=="medium"})}}if(fn&&fn.hasColumn||pn){if(ke){if(Nr<300)return console.log("🚫 듀얼 가구 배치 불가:",{이유:"기둥 침범으로 인한 공간 부족",totalAvailableWidth:Nr,최소필요너비:300}),!1}else if(console.log("🏛️ 싱글 가구 - 기둥 침범 슬롯 감지:",{slotIndex:Yn,hasColumn:!0,availableWidth:fn.availableWidth,adjustedWidth:fn.adjustedWidth,intrusionDirection:fn.intrusionDirection,furniturePosition:fn.furniturePosition,columnType:fn.columnType}),!Woe(fn,nt.dimensions.width,ke))return console.log("🚫 기둥 침범으로 인해 배치 불가:",{이유:"공간 부족"}),!1;if(Nn=ke?tr:fn.columnType,ke)Qt=Nr,Qn=Nr,console.log("🔧 듀얼 가구 - 기둥 A 침범으로 폭 즉시 조정:",{원래폭:nt.dimensions.width,조정된폭:Qt,columnType:Nn});else{const un=_i.columnWidth*.01,Vn={left:me-un/2,right:me+un/2,center:me},Ln=wu(fn,Vn,n);Qt=Ln.renderWidth,Qn=Ln.renderWidth,Tn=Ln.center,console.log("🔧 싱글 가구 - 기둥 A 침범으로 폭 즉시 조정:",{원래폭:An,조정된폭:Qt,위치조정:{원래X:me,조정된X:Tn},columnType:fn.columnType})}}else n.surroundType!=="no-surround"?ke&&Jt.slotWidths&&Jt.slotWidths[Xt]!==void 0?Qt=Jt.slotWidths[Xt]+(Jt.slotWidths[Xt+1]||Jt.slotWidths[Xt]):Jt.slotWidths&&Jt.slotWidths[Xt]!==void 0?Qt=Jt.slotWidths[Xt]:Qt=An:Qt=void 0,Qn=void 0;console.log("🎯 가구 배치 정보:",{zone:H,슬롯인덱스:Xt,슬롯너비:An,모듈너비:nt.dimensions.width,customWidth:Qt,adjustedWidth:Qn,차이:Math.abs(nt.dimensions.width-Qt),위치X:Tn,위치X_mm:Tn*100,기둥침범:(fn==null?void 0:fn.hasColumn)||!1,마지막슬롯여부:Xt===_i.columnCount-1,영역시작X_mm:_i.startX,영역끝X_mm:_i.startX+_i.width,가구왼쪽끝_mm:Tn*100-Qt/2,가구오른쪽끝_mm:Tn*100+Qt/2,slotWidths:Jt.slotWidths,zoneInfo:{normal:tt.normal,dropped:tt.dropped}});const ks=te.moduleData.id.replace(/-\d+$/,""),ko=`${ks}-${Qt}`;console.log("🎯 단내림 구간 모듈 ID 생성:",{originalDragId:te.moduleData.id,foundModuleId:nt.id,baseType:ks,customWidth:Qt,targetModuleId:ko,isDual:ke,slotIndex:Xt,occupiedSlots:ke?[Xt,Xt+1]:[Xt]});const As=fn&&fn.hasColumn?SQ(fn):"right",ar={id:qe,moduleId:ko,position:{x:Tn,y:0,z:0},rotation:0,hasDoor:!1,customDepth:nn,slotIndex:Xt,isDualSlot:ke,isValidInCurrentSpace:!0,adjustedWidth:fn!=null&&fn.hasColumn||pn?Qn:void 0,hingePosition:As,zone:H,customWidth:Qt,customHeight:H==="dropped"&&wn?wn.height:void 0};if(fn&&fn.hasColumn&&(ar.columnSlotInfo={hasColumn:!0,columnId:(ui=fn.column)==null?void 0:ui.id,columnPosition:fn.columnPosition,availableWidth:fn.availableWidth,adjustedWidth:fn.adjustedWidth,intrusionDirection:fn.intrusionDirection,furniturePosition:fn.furniturePosition},console.log("🔧 기둥 침범 가구 최종 설정:",{moduleId:ar.moduleId,adjustedWidth:ar.adjustedWidth,customWidth:ar.customWidth,columnSlotInfo:ar.columnSlotInfo})),n.surroundType==="no-surround"&&ke){console.log("🔍 노서라운드 듀얼 가구 배치 체크:",{isDualFurniture:ke,moduleId:ko,globalSlotIndex:kn,zoneSlotIndex:Xt,columnCount:x.columnCount});const un=kn===0,Vn=kn>=x.columnCount-2,Ln=un&&(n.installType==="freestanding"||n.installType==="semistanding"&&((Mi=n.wallConfig)==null?void 0:Mi.right)),ee=Vn&&(n.installType==="freestanding"||n.installType==="semistanding"&&((Gn=n.wallConfig)==null?void 0:Gn.left));console.log("🔍 엔드패널 체크:",{hasLeftEndPanel:Ln,hasRightEndPanel:ee,isFirstSlot:un,isLastSlot:Vn,installType:n.installType,wallConfig:n.wallConfig}),(Ln||ee)&&console.log("✅ 엔드패널 구간 듀얼 가구 배치 허용")}return console.log("✅ 가구 배치 완료:",{zone:H,moduleId:ko,slotIndex:Xt,isDualSlot:ke,isDualFromModuleId:ko.startsWith("dual-"),occupiedSlots:ke?[Xt,Xt+1]:[Xt],position:{x:Tn},position_mm:{x:Tn*100},finalX:me,finalX_mm:me*100,customWidth:Qt,zoneInfo:H==="dropped"?tt.dropped:tt.normal,newModule:{id:ar.id,moduleId:ar.moduleId,isDualSlot:ar.isDualSlot,slotIndex:ar.slotIndex,position:ar.position,zone:ar.zone}}),console.log("🚨🚨 최종 newModule 상세:",{...ar,position_mm:{x:ar.position.x*100,y:ar.position.y*100,z:ar.position.z*100}}),s(ar),o&&a(null),setTimeout(()=>{_j(U,z)},100),window.dispatchEvent(new CustomEvent("furniture-placement-complete")),!0}else if((Dn=n.droppedCeiling)!=null&&Dn.enabled){const Jt=(li=u.children.filter(hi=>{var Xt;return((Xt=hi.userData)==null?void 0:Xt.isSlotCollider)&&hi.visible}).sort((hi,Xt)=>{var _i,Pr;return(((_i=hi.userData)==null?void 0:_i.slotIndex)||0)-(((Pr=Xt.userData)==null?void 0:Pr.slotIndex)||0)}).find(hi=>{var Xt,_i;return((Xt=hi.userData)==null?void 0:Xt.slotIndex)===fe&&((_i=hi.userData)==null?void 0:_i.isSlotCollider)}))==null?void 0:li.userData,wn=(Jt==null?void 0:Jt.zone)||"normal",Yn={id:he,moduleId:ce.id,position:{x:ne,y:0,z:0},rotation:0,slotIndex:fe,depth:xe,isDualSlot:ye,isValidInCurrentSpace:!0,adjustedWidth:ce.dimensions.width,hingePosition:"right",customWidth:Be,zone:wn};return s(Yn),o&&a(null),window.dispatchEvent(new CustomEvent("furniture-placement-complete")),!0}const fe=GS(M.clientX,M.clientY,X,h,u);if(console.log("🎰 Slot index from raycast (non-dropped):",fe),fe===null)return console.log("❌ No slot index found (non-dropped)"),!1;const ye=te.moduleData.id.startsWith("dual-");if(console.log("📊 메인 구간 슬롯 점유 상태 (drop):",{zone:"main",targetSlot:fe,isDualDragging:ye,targetSlots:ye?[fe,fe+1]:[fe],existingModules:U.filter(tt=>!tt.zone||tt.zone==="normal").map(tt=>({id:tt.id,moduleId:tt.moduleId,slotIndex:tt.slotIndex,isDualSlot:tt.isDualSlot,occupiedSlots:tt.isDualSlot?[tt.slotIndex,tt.slotIndex+1]:[tt.slotIndex]}))}),n.surroundType==="no-surround"&&ye){const tt=ur(n);console.log("🔍 노서라운드 듀얼 가구 배치 체크 (non-dropped):",{isDualFurniture:ye,moduleId:te.moduleData.id,slotIndex:fe,columnCount:tt.columnCount});const Jt=fe===0,wn=fe>=tt.columnCount-2,Yn=Jt&&(n.installType==="freestanding"||n.installType==="semistanding"&&((en=n.wallConfig)==null?void 0:en.right)),hi=wn&&(n.installType==="freestanding"||n.installType==="semistanding"&&((Rt=n.wallConfig)==null?void 0:Rt.left));console.log("🔍 엔드패널 체크 (non-dropped):",{hasLeftEndPanel:Yn,hasRightEndPanel:hi,isFirstSlot:Jt,isLastSlot:wn,installType:n.installType,wallConfig:n.wallConfig}),(Yn||hi)&&console.log("✅ 엔드패널 구간 듀얼 가구 배치 허용 (non-dropped)")}if(console.log("🔍 SlotDropZonesSimple - 슬롯 가용성 검사 전:",{slotIndex:fe,isDual:ye,moduleId:te.moduleData.id,latestPlacedModulesCount:U.length,latestPlacedModules:U.map(tt=>({id:tt.id,moduleId:tt.moduleId,slotIndex:tt.slotIndex,position:tt.position}))}),!sv(fe,ye,U,z,te.moduleData.id))return console.log("❌ 메인 구간 슬롯 충돌로 배치 불가"),!1;let be=n;if(n.mainDoorCount&&n.mainDoorCount>0){const tt=Math.max(1,Math.floor(w.width/600));be={...n,mainDoorCount:n.mainDoorCount,customColumnCount:n.mainDoorCount,columnMode:"custom"},console.log("🎯 [SlotDropZones] 분할창 모듈 생성:",{mainDoorCount:n.mainDoorCount,defaultColumnCount:tt,internalWidth:w.width,adjustedSpaceInfo:be})}const _e=ur(be),W=_e.slotWidths&&_e.slotWidths[fe]!==void 0?_e.slotWidths[fe]:_e.columnWidth,Y=te.moduleData.id.replace(/-\d+$/,""),ve=`${Y}-${W}`;console.log("🎯 [SlotDropZones] Non-dropped module lookup:",{originalId:te.moduleData.id,baseType:Y,targetWidth:W,targetModuleId:ve,slotIndex:fe,slotWidths:_e.slotWidths});let ce=Hi(ve,w,be);if(!ce)return console.error("❌ [SlotDropZones] Module not found:",ve),!1;let ne=bj(fe,ve,n,H);if(ne===null)return!1;ye&&console.log("🎯 Dual furniture position debug:",{slotIndex:fe,columnCount:x.columnCount,threeUnitDualPositions:x.threeUnitDualPositions,finalX:ne,expectedPosition:(Xn=x.threeUnitDualPositions)==null?void 0:Xn[fe]});const he=`placed-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,xe=(ce==null?void 0:ce.defaultDepth)||Math.min(Math.floor(n.depth*.9),580),Te=x,Ce=Te.slotWidths&&Te.slotWidths[fe]!==void 0?Te.slotWidths[fe]:Te.columnWidth;let Be,Ye=ve;if(ye&&Te.slotWidths&&Te.slotWidths[fe]!==void 0){const tt=Te.slotWidths[fe],Jt=Te.slotWidths[fe+1]||tt;Be=tt+Jt,Ye=`${Y}-${Be}`,console.log("🎯 [SlotDropZones] Dual furniture width calculation:",{slotIndex:fe,slot1Width:tt,slot2Width:Jt,totalWidth:Be,dualTargetModuleId:Ye,originalTargetModuleId:ve})}else Te.slotWidths&&Te.slotWidths[fe]!==void 0?Be=Te.slotWidths[fe]:Be=Ce;if(ye&&Ye!==ve){const tt=Hi(Ye,w,be);if(tt){if(ce=tt,console.log("✅ [SlotDropZones] Found dual module with exact width:",Ye),ne=bj(fe,Ye,n,H),ne===null)return console.error("❌ [SlotDropZones] Failed to calculate dual furniture position"),!1}else console.warn("⚠️ [SlotDropZones] Dual module not found with exact width, using single slot module:",Ye)}console.log("🎯 가구 배치 시 customWidth 설정:",{slotIndex:fe,isDual:ye,targetIndexing:{columnWidth:Te.columnWidth,slotWidths:Te.slotWidths},actualSlotWidth:Ce,customWidth:Be,moduleWidth:ce.dimensions.width,평균너비:Te.columnWidth,내경너비:w.width,슬롯수:Te.columnCount,finalModuleId:ye?Ye:ve});const $e=Rc(n);let ot=Be,rt=ne,Ve=ce.dimensions.width,We=null;if(ye){const tt=$e[fe],Jt=$e[fe+1];if(console.log("🏛️ 듀얼 가구 기둥 침범 확인:",{slot1:{index:fe,hasColumn:(tt==null?void 0:tt.hasColumn)||!1,columnType:tt==null?void 0:tt.columnType,availableWidth:tt==null?void 0:tt.availableWidth},slot2:{index:fe+1,hasColumn:(Jt==null?void 0:Jt.hasColumn)||!1,columnType:Jt==null?void 0:Jt.columnType,availableWidth:Jt==null?void 0:Jt.availableWidth}}),(tt==null?void 0:tt.hasColumn)||!1||(Jt==null?void 0:Jt.hasColumn)||!1)if((tt==null?void 0:tt.columnType)==="deep"||(Jt==null?void 0:Jt.columnType)==="deep"){const hi=(tt==null?void 0:tt.availableWidth)||Te.columnWidth,Xt=(Jt==null?void 0:Jt.availableWidth)||Te.columnWidth,_i=hi+Xt;ot=_i,Ve=_i,console.log("🔧 듀얼 가구 기둥 A 침범 - 폭 조정:",{원래폭:Be,조정된폭:ot,slot1Available:hi,slot2Available:Xt,totalAvailable:_i})}else console.log("🔧 듀얼 가구 기둥 C 선배치 - 원본 크기 유지")}else if(We=$e[fe],We&&We.hasColumn){console.log("🏛️ 싱글 가구 - 기둥 침범 슬롯 감지:",{slotIndex:fe,hasColumn:!0,availableWidth:We.availableWidth,adjustedWidth:We.adjustedWidth,columnType:We.columnType,column:We.column,intrusionDirection:We.intrusionDirection,furniturePosition:We.furniturePosition});{const tt=Te.columnWidth*.01,Jt={left:ne-tt/2,right:ne+tt/2,center:ne},wn=wu(We,Jt,n);ot=wn.renderWidth,Ve=wn.renderWidth,rt=wn.center,console.log("🔧 기둥 A 침범 - 가구 폭 즉시 조정:",{원래폭:Be,조정된폭:ot,원래위치:ne,조정된위치:rt,furnitureBounds:wn})}}const De={id:he,moduleId:ye?Ye:ve,position:{x:rt,y:0,z:0},rotation:0,hasDoor:!1,customDepth:xe,slotIndex:fe,isDualSlot:ye,isValidInCurrentSpace:!0,adjustedWidth:We!=null&&We.hasColumn?Ve:void 0,hingePosition:"right",customWidth:n.surroundType==="no-surround"?void 0:ot,zone:H};We&&We.hasColumn&&(De.columnSlotInfo={hasColumn:!0,columnId:(Ui=We.column)==null?void 0:Ui.id,columnPosition:We.columnPosition,availableWidth:We.availableWidth,adjustedWidth:We.adjustedWidth,intrusionDirection:We.intrusionDirection,furniturePosition:We.furniturePosition}),console.log("🎯 가구 배치 완료:",{id:he,moduleId:De.moduleId,isDual:ye,isDualSlot:De.isDualSlot,slotIndex:fe,occupiedSlots:ye?[fe,fe+1]:[fe],zone:H,position:rt,width:ce.dimensions.width,customWidth:Be}),console.log("🎯 최종 가구 데이터:",{moduleId:De.moduleId,customWidth:De.customWidth,adjustedWidth:De.adjustedWidth,slotInfo:We?{hasColumn:We.hasColumn,columnType:We.columnType,availableWidth:We.availableWidth}:null,position:De.position,"조정된 너비 사용 여부":De.adjustedWidth!==void 0}),console.log("📋 배치 전 가구 목록:",U.map(tt=>({id:tt.id.slice(-2),slotIndex:tt.slotIndex,isDualSlot:tt.isDualSlot,zone:tt.zone,moduleId:tt.moduleId}))),s(De),setTimeout(()=>{const tt=ci.getState().placedModules;console.log("🟢 가구 추가 후 Store 상태:",{beforeCount:U.length,afterCount:tt.length,newModule:{id:De.id,moduleId:De.moduleId,slotIndex:De.slotIndex},afterModules:tt.map(Jt=>({id:Jt.id,moduleId:Jt.moduleId,slotIndex:Jt.slotIndex}))})},100);const Ge=[...U,De],Re="normal",Ie=new Array(Te.columnCount).fill("[ ]"),Le=Ge.filter(tt=>{var Jt;return(Jt=n.droppedCeiling)!=null&&Jt.enabled?(tt.zone||"normal")===Re:!0});return console.log(`🔍 ${Re} 영역 가구 목록:`,Le.map(tt=>({id:tt.id.slice(-2),moduleId:tt.moduleId,slotIndex:tt.slotIndex,isDualSlot:tt.isDualSlot,zone:tt.zone}))),Le.forEach(tt=>{tt.isDualSlot&&tt.slotIndex!==void 0?(Ie[tt.slotIndex]=`[${tt.id.slice(-2)}`,tt.slotIndex+1<Ie.length&&(Ie[tt.slotIndex+1]=`${tt.id.slice(-2)}]`)):tt.slotIndex!==void 0&&(Ie[tt.slotIndex]=`[${tt.id.slice(-2)}]`)}),console.log(`📊 ${Re} 영역 슬롯 점유 상태 (총 ${Te.columnCount}개):`,Ie.join("")),o&&a(null),setTimeout(()=>{_j(U,z)},100),window.dispatchEvent(new CustomEvent("furniture-placement-complete")),!0},[h,u,s,a,c]);O.useEffect(()=>{b.current=_},[_]),O.useEffect(()=>(console.log("🎯 SlotDropZonesSimple - registering window.handleSlotDrop",{componentMounted:!0,timestamp:new Date().toISOString()}),window.handleSlotDrop&&(console.log("⚠️ Removing existing window.handleSlotDrop"),delete window.handleSlotDrop),window.handleSlotDrop=(M,X,Z)=>{var Q;return console.log("🎯 window.handleSlotDrop called - using ref.current",{hasRef:!!b.current,dragEventType:M.type,dataTransfer:(Q=M.dataTransfer)==null?void 0:Q.getData("application/json")}),b.current?b.current(M,X):(console.error("❌ handleSlotDropRef.current is null"),!1)},console.log("✅ window.handleSlotDrop registered:",typeof window.handleSlotDrop),()=>{console.log("🎯 SlotDropZonesSimple - unregistering window.handleSlotDrop"),delete window.handleSlotDrop}),[]),O.useEffect(()=>{if(!o)return;const M=U=>{var H;U.preventDefault();const z=document.querySelector("canvas");if(!z)return;const q=GS(U.clientX,U.clientY,z,h,u);if(q===null){y(null),m(null);return}let G=null;if((H=n.droppedCeiling)!=null&&H.enabled){const se=z.getBoundingClientRect(),te=(U.clientX-se.left)/se.width*2-1,fe=-((U.clientY-se.top)/se.height)*2+1,ye=new N0;ye.setFromCamera(new yf(te,fe),h);const be=u.children.flatMap(W=>W.children||[W]).filter(W=>{var Y;return(Y=W.userData)==null?void 0:Y.isSlotCollider}),_e=ye.intersectObjects(be,!0);if(_e.length>0){const W=_e[0].object,Y=W==null?void 0:W.userData;G=(Y==null?void 0:Y.zone)||"normal",console.log("🔍 Zone 감지 (레이캐스트):",{slotIndex:q,detectedZone:G,colliderData:Y,distance:_e[0].distance})}else{const W=wr.calculateZoneSlotInfo(n,n.customColumnCount);if(W.dropped&&W.normal){const Y=D(W.dropped.startX+W.dropped.width),ve=D(W.normal.startX),ce=new O2(new so(0,1,0),0),ne=new so;ye.ray.intersectPlane(ce,ne)?n.droppedCeiling.position==="left"?G=ne.x<Y?"dropped":"normal":G=ne.x>=ve?"dropped":"normal":G="normal"}else G="normal"}}else G="normal",console.log("🔍 단내림 없음 - normal zone 설정:",{slotIndex:q,detectedZone:G,hoveredSlotIndex:p,hoveredZone:v});const ie=o;if(ie){const se=ie.moduleData.id.startsWith("dual-");(()=>{var fe;if((fe=n.droppedCeiling)!=null&&fe.enabled&&G){const ye=wr.calculateZoneSlotInfo(n,n.customColumnCount),be=G==="dropped"&&ye.dropped?ye.dropped:ye.normal;if(se&&q+1>=be.columnCount)return console.log("🚫 Hover: 듀얼 가구가 영역 경계를 넘어감:",{zone:G,slotIndex:q,targetZoneColumnCount:be.columnCount,필요한슬롯:[q,q+1],영역범위:`0 ~ ${be.columnCount-1}`}),!1;const _e=r.filter(Y=>Y.zone===G);return console.log("🏗️ 단내림 구간 슬롯 점유 상태 (hover):",{zone:G,currentSlot:q,isDualDragging:se,targetSlots:se?[q,q+1]:[q],existingModules:_e.map(Y=>({id:Y.id,slotIndex:Y.slotIndex,isDualSlot:Y.isDualSlot,occupiedSlots:Y.isDualSlot?[Y.slotIndex,Y.slotIndex+1]:[Y.slotIndex],zone:Y.zone}))}),!_e.some(Y=>{if(se)if(Y.isDualSlot){const ve=Y.slotIndex===q||Y.slotIndex===q+1||Y.slotIndex===q-1||Y.slotIndex+1===q;return ve&&console.log("🚫 Hover: 듀얼-듀얼 충돌:",{드래그중:{slotIndex:q,isDual:!0,slots:[q,q+1]},기존가구:{id:Y.id,slotIndex:Y.slotIndex,isDualSlot:Y.isDualSlot,moduleId:Y.moduleId,slots:[Y.slotIndex,Y.slotIndex+1]}}),ve}else{const ve=Y.slotIndex===q||Y.slotIndex===q+1;return ve&&console.log("🚫 Hover: 듀얼-싱글 충돌:",{드래그중:{slotIndex:q,isDual:!0,slots:[q,q+1]},기존가구:{id:Y.id,slotIndex:Y.slotIndex,isDualSlot:Y.isDualSlot,moduleId:Y.moduleId,slots:[Y.slotIndex]}}),ve}else{const ve=Y.slotIndex===q||Y.isDualSlot&&(Y.slotIndex===q||Y.slotIndex+1===q);return ve&&console.log("🚫 Hover: 싱글 충돌:",{드래그중:{slotIndex:q,isDual:!1,slots:[q]},기존가구:{id:Y.id,slotIndex:Y.slotIndex,isDualSlot:Y.isDualSlot,moduleId:Y.moduleId,slots:Y.isDualSlot?[Y.slotIndex,Y.slotIndex+1]:[Y.slotIndex]}}),ve}})}else return sv(q,se,r,n,ie.moduleData.id)})()?(y(q),m(G)):(y(null),m(null))}else y(q),m(G)},X=()=>{y(null)},Z=document.querySelector("canvas"),Q=Z==null?void 0:Z.parentElement;return Q&&o&&(Q.addEventListener("dragover",M),Q.addEventListener("dragleave",X)),()=>{Q&&(Q.removeEventListener("dragover",M),Q.removeEventListener("dragleave",X))}},[o,h,u,n,r]);const I=((K=n.droppedCeiling)==null?void 0:K.enabled)||!1,S=I?wr.calculateZoneSlotInfo(n,n.customColumnCount):null,B=(()=>{var Z,Q,U,z,q,G;if(!I||!(S!=null&&S.dropped))return console.log("🎯 getZoneSlotPositions - returning default positions (no dropped ceiling):",{hasDroppedCeiling:I,hasDroppedInfo:!!(S!=null&&S.dropped),defaultPositions:x.threeUnitPositions,indexingExists:!!x,threeUnitPositionsExists:!!(x!=null&&x.threeUnitPositions),isArray:Array.isArray(x==null?void 0:x.threeUnitPositions),positionCount:(Z=x.threeUnitPositions)==null?void 0:Z.length}),x.threeUnitPositions?x.threeUnitPositions.map((ie,H)=>({position:ie,zone:"normal",index:H})):[];console.log("🎯 getZoneSlotPositions - creating colliders for both zones");const M=ur(n),X=[];if((U=(Q=M.zones)==null?void 0:Q.normal)!=null&&U.threeUnitPositions){console.log("🔍 Normal zone positions:",M.zones.normal.threeUnitPositions);const ie=Math.min(...M.zones.normal.threeUnitPositions),H=Math.max(...M.zones.normal.threeUnitPositions);console.log("📏 Normal zone range:",{min:ie,max:H}),X.push(...M.zones.normal.threeUnitPositions.map((se,te)=>({position:se,zone:"normal",index:te})))}if((q=(z=M.zones)==null?void 0:z.dropped)!=null&&q.threeUnitPositions){console.log("🔍 Dropped zone positions:",M.zones.dropped.threeUnitPositions);const ie=Math.min(...M.zones.dropped.threeUnitPositions),H=Math.max(...M.zones.dropped.threeUnitPositions);if(console.log("📏 Dropped zone range:",{min:ie,max:H}),X.push(...M.zones.dropped.threeUnitPositions.map((se,te)=>({position:se,zone:"dropped",index:te}))),(G=M.zones.normal)!=null&&G.threeUnitPositions){const se=Math.min(...M.zones.normal.threeUnitPositions),te=Math.max(...M.zones.normal.threeUnitPositions);(ie>=se&&ie<=te||H>=se&&H<=te)&&console.error("❌ Zone overlap detected!",{normal:{min:se,max:te},dropped:{min:ie,max:H}})}}return console.log("🎯 All positions for colliders:",X),X})();return Array.isArray(B)?(console.log("🎯 SlotDropZonesSimple - rendering colliders:",{zoneSlotPositionsLength:B.length,hasDroppedCeiling:I,viewMode:A,droppedCeilingEnabled:(P=n.droppedCeiling)==null?void 0:P.enabled,zoneSlotPositions:B,indexing:x,hasIndexingPositions:!!(x!=null&&x.threeUnitPositions)}),l.jsxs("group",{children:[console.log("🎯 렌더링 슬롯 콜라이더 수:",B.length),console.log("🎯 슬롯 콜라이더 상세 정보:",B),B.map((M,X)=>{var W,Y,ve,ce,ne;const Z=typeof M=="object"&&M!==null,Q=Z?M.position:M,U=Z?M.zone:"normal",z=Z?M.index:X,q=T.depth-D(20),G=-D(10);let ie=T.width;if(I&&S){const he=U,xe=he==="dropped"&&S.dropped?S.dropped.slotWidths:S.normal.slotWidths;if(xe&&z<xe.length)ie=D(xe[z]);else{const Te=he==="dropped"&&S.dropped?S.dropped.columnWidth:S.normal.columnWidth;ie=D(Te)}}else x.slotWidths&&z<x.slotWidths.length&&(ie=D(x.slotWidths[z]));const se=((W=n.baseConfig)==null?void 0:W.type)==="stand"&&((Y=n.baseConfig)==null?void 0:Y.placementType)==="float"?D(((ve=n.baseConfig)==null?void 0:ve.floatHeight)||0):0,te=D(w.startY)+se;let ye=D(w.startY)+D(w.height)-te;if(I&&U==="dropped"){const he=n.height-(((ce=n.droppedCeiling)==null?void 0:ce.dropHeight)||0),xe=((ne=n.frameSize)==null?void 0:ne.top)||0;ye=D(he-xe)-te}const _e=te+ye/2;return l.jsxs("mesh",{name:`SlotCollider-${U}-${z}`,position:[Q,_e,G],userData:{slotIndex:z,isSlotCollider:!0,type:"slot-collider",zone:U||"normal",globalSlotIndex:U==="dropped"&&(S!=null&&S.dropped)?z+S.normal.columnCount:z},visible:!0,children:[l.jsx("boxGeometry",{args:[ie,ye,q]}),l.jsx("meshBasicMaterial",{transparent:!0,opacity:0})]},`slot-collider-${U}-${z}`)}),p!==null&&o&&B.map((M,X)=>{var $e,ot,rt,Ve,We,De,Ge,Re,Ie,Le,et,ct,mt,je,le,Je,ht,ut,ft,jt;const Z=typeof M=="object"&&M!==null,Q=Z?M.position:M,U=Z?M.zone:"normal",z=Z?M.index:X,q=o;let G=!1;q&&(G=q.moduleData.id.startsWith("dual-"));let ie=!1;if(p!==null&&q){const Wt=Z?z:X,Mt=!v||v===U,dn=I&&!v;ie=Wt===p&&(dn||Mt),console.log("🎯 고스트 렌더링 체크:",{hoveredSlotIndex:p,hoveredZone:v,slotIndex:X,slotLocalIndex:z,slotZone:U,compareIndex:Wt,isZoneData:Z,zoneMatches:Mt,shouldIgnoreZone:dn,shouldRenderGhost:ie,hasDroppedCeiling:I,activeModuleData:{id:q.moduleData.id,isDual:G}})}if(!ie||!q)return null;let H,se=q.moduleData.id,te=w;const fe=U;if(console.log("🔥 고스트 생성 디버그:",{slotIndex:X,slotLocalIndex:z,hoveredSlotIndex:p,hoveredZone:v,slotZone:U,effectiveZone:fe,shouldRenderGhost:ie,hasDroppedCeiling:I,hasZoneSlotInfo:!!S}),I&&fe&&S){const Wt=(($e=n.droppedCeiling)==null?void 0:$e.width)||yo.WIDTH;let Mt;if(fe==="dropped"){const Mn=n.height-(((ot=n.droppedCeiling)==null?void 0:ot.dropHeight)||0);Mt={...n,width:Wt,height:Mn,zone:"dropped"},console.log("🔧 [Ghost Preview] 단내림 영역 zoneSpaceInfo 생성:",{zone:"dropped",width:Wt,height:Mn,droppedCeilingEnabled:(rt=Mt.droppedCeiling)==null?void 0:rt.enabled})}else Mt={...n,width:n.width-Wt,zone:"normal"},console.log("🔧 [Ghost Preview] 메인 영역 zoneSpaceInfo 생성:",{zone:"normal",width:n.width-Wt,droppedCeilingEnabled:(Ve=Mt.droppedCeiling)==null?void 0:Ve.enabled});te=kr(Mt),console.log("🎯 [Ghost Preview] Zone 내부 공간 계산:",{effectiveZone:fe,zoneSpaceInfo:{width:Mt.width,height:Mt.height,zone:Mt.zone},zoneInternalSpace:te,originalHeight:n.height,droppedCeilingDropHeight:(We=n.droppedCeiling)==null?void 0:We.dropHeight});const dn=q.moduleData.id.replace(/-\d+$/,""),on=fe==="dropped"&&S.dropped?S.dropped:S.normal;let Et;const an=z;if(G&&an<on.columnCount-1){const Mn=((De=on.slotWidths)==null?void 0:De[an])||on.columnWidth,At=((Ge=on.slotWidths)==null?void 0:Ge[an+1])||on.columnWidth;Et=Mn+At}else Et=((Re=on.slotWidths)==null?void 0:Re[an])||on.columnWidth;se=`${dn}-${Et}`,console.log("🎯 [Ghost Preview] 모듈 ID 생성:",{baseType:dn,targetWidth:Et,targetModuleId:se,originalId:q.moduleData.id,effectiveZone:fe,localIndex:an}),H=Hi(se,te,Mt),console.log("🔍 [Ghost Preview] 단내림 구간 미리보기 모듈 조회:",{effectiveZone:fe,baseType:dn,targetWidth:Et,targetModuleId:se,moduleFound:!!H,moduleHeight:H==null?void 0:H.dimensions.height,hoveredSlotIndex:p,localIndex:an,slotLocalIndex:z,targetZone:{columnCount:on.columnCount,columnWidth:on.columnWidth,slotWidths:on.slotWidths},zoneSpaceInfo:{width:Mt.width,height:Mt.height,zone:Mt.zone},zoneInternalSpace:{width:te.width,height:te.height,depth:te.depth},originalSpaceHeight:n.height,droppedCeilingDropHeight:(Ie=n.droppedCeiling)==null?void 0:Ie.dropHeight})}else H=Hi(q.moduleData.id,w,n);H||(console.error("❌ [Ghost Preview] 미리보기 모듈을 찾을 수 없음:",{targetModuleId:se,effectiveZone:fe,zoneInternalSpace:te,baseType,targetWidth,originalModuleId:q.moduleData.id}),H=q.moduleData);let ye=Q;if(I&&fe&&S){const Wt=fe==="dropped"&&S.dropped?S.dropped:S.normal,Mt=D(Wt.startX),dn=D(Wt.columnWidth),on=z;if(G&&on<Wt.columnCount-1){let Et,an;if(on===Wt.columnCount-2){Et=Mt+on*dn+dn/2;const Mn=Mt+(on+1)*dn,At=Mt+D(Wt.width);an=(Mn+At)/2}else Et=Mt+on*dn+dn/2,an=Mt+(on+1)*dn+dn/2;ye=(Et+an)/2}else if(on===Wt.columnCount-1){const Et=Mt+on*dn,an=Mt+D(Wt.width);ye=(Et+an)/2}else ye=Mt+on*dn+dn/2}else G&&X===p?x.threeUnitDualPositions&&x.threeUnitDualPositions[X]!==void 0&&(ye=x.threeUnitDualPositions[X]):ye=Q,console.log("🎯 [Normal Ghost] 일반 구간 고스트 위치:",{isDual:G,slotIndex:X,hoveredSlotIndex:p,previewX:ye,slotX:Q,threeUnitDualPositions:x.threeUnitDualPositions,dualPosition:(Le=x.threeUnitDualPositions)==null?void 0:Le[X]});const be=(H==null?void 0:H.defaultDepth)||Math.min(Math.floor(n.depth*.9),580),_e=((et=H==null?void 0:H.dimensions)==null?void 0:et.height)||600,W=_e*.01,Y=(H==null?void 0:H.category)==="upper"||((ct=H==null?void 0:H.id)==null?void 0:ct.includes("upper-cabinet"));(H==null?void 0:H.category)==="lower"||((mt=H==null?void 0:H.id)==null||mt.includes("lower-cabinet"));let ve;if(Y){const Wt=(te==null?void 0:te.height)||w.height,Mt=((je=H==null?void 0:H.dimensions)==null?void 0:je.height)||600,dn=((le=n.baseConfig)==null?void 0:le.type)==="floor"?((Je=n.baseConfig)==null?void 0:Je.height)||65:0;ve=D(Wt+dn-Mt/2),console.log("👻 [Ghost Preview] 상부장 Y 위치:",{slotStartY:j,internalHeightMm:Wt,furnitureHeightMm:Mt,furnitureY:ve,category:H.category})}else ve=j+W/2;console.log("👻 [Ghost Preview] 가구 높이 계산:",{effectiveZone:fe,moduleDataHeight:(ht=H==null?void 0:H.dimensions)==null?void 0:ht.height,moduleDataId:H.id,zoneInternalSpaceHeight:te==null?void 0:te.height,furnitureHeightMm:_e,furnitureHeight:W,furnitureY:ve,slotStartY:j,expectedY:j+W/2,originalSpaceHeight:n.height,droppedCeilingDropHeight:(ut=n.droppedCeiling)==null?void 0:ut.dropHeight,isDroppedZone:fe==="dropped"});const ce=D(20),ne=D(1500),he=D(600),Te=-ne/2+(ne-he)/2,Ce=D(be),Be=Te+he/2-ce-Ce/2,Ye=I&&fe==="dropped"&&S?{...n,width:((ft=n.droppedCeiling)==null?void 0:ft.width)||yo.WIDTH,height:n.height-(((jt=n.droppedCeiling)==null?void 0:jt.dropHeight)||0),zone:"dropped"}:n;return l.jsx("group",{position:[ye,ve,Be],children:l.jsx(S$,{moduleData:H,color:g.color,isDragging:!0,hasDoor:!1,customDepth:be,spaceInfo:Ye})},`furniture-preview-${X}`)})]})):(console.error("❌ getZoneSlotPositions returned non-array:",B),l.jsx("group",{}))},Jhe=({spaceInfo:n})=>{var m,w;ci(x=>x.isFurniturePlacementMode);const e=ci(x=>x.placedModules),{theme:t}=Yo(),i=kr(n),r=x=>x*.01,o=-(n.width/2)+i.startX+i.width/2,a=r(o),c=n.hasFloorFinish&&n.floorFinish?n.floorFinish.height:0,h=((m=n.baseConfig)==null?void 0:m.height)||0;let u;if(!n.baseConfig||n.baseConfig.type==="floor")u=r(c+h);else if(n.baseConfig.type==="stand")if(n.baseConfig.placementType==="float"){const x=n.baseConfig.floatHeight||0;u=r(c+x)}else u=r(c);else u=r(c);const d=r(i.width),f=r(i.depth-200-20),A=r(-10),g=e.some(x=>x.hasDoor),p=O.useMemo(()=>{if(typeof window<"u"){const T=getComputedStyle(document.documentElement).getPropertyValue("--theme-primary").trim();if(T)return T}return"#10b981"},[t.color]),y=ur(n);if(((w=n.droppedCeiling)==null?void 0:w.enabled)&&y.zones&&y.zones){const x=[];if(y.zones.normal){const T=y.zones.normal.startX+y.zones.normal.width/2,j=r(y.zones.normal.width);x.push(l.jsx("group",{position:[r(T),u-.1,A],children:!g&&l.jsxs("mesh",{rotation:[-Math.PI/2,0,0],children:[l.jsx("planeGeometry",{args:[j,f]}),l.jsx("meshBasicMaterial",{color:p,transparent:!0,opacity:.05,side:2})]})},"normal-zone"))}if(y.zones.dropped){const T=y.zones.dropped.startX+y.zones.dropped.width/2,j=r(y.zones.dropped.width);x.push(l.jsx("group",{position:[r(T),u-.1,A],children:!g&&l.jsxs("mesh",{rotation:[-Math.PI/2,0,0],children:[l.jsx("planeGeometry",{args:[j,f]}),l.jsx("meshBasicMaterial",{color:p,transparent:!0,opacity:.05,side:2})]})},"dropped-zone"))}return l.jsx(l.Fragment,{children:x})}return l.jsx("group",{position:[a,u-.1,A],children:!g&&l.jsxs("mesh",{rotation:[-Math.PI/2,0,0],children:[l.jsx("planeGeometry",{args:[d,f]}),l.jsx("meshBasicMaterial",{color:p,transparent:!0,opacity:.05,side:2})]},`slot-mesh-${t.color}-${t.mode}`)})},eue=()=>null;function tue(n,e){const t=O.useRef(0),i=O.useRef(null),r=O.useRef(null);return O.useCallback((...s)=>{const a=Date.now()-t.current,c=()=>{t.current=Date.now(),n(...s)};a>=e?(r.current&&cancelAnimationFrame(r.current),r.current=requestAnimationFrame(c)):(i.current&&clearTimeout(i.current),i.current=setTimeout(()=>{r.current&&cancelAnimationFrame(r.current),r.current=requestAnimationFrame(c)},e-a))},[n,e])}const nue="_toolbar_11bqk_1",iue="_toolbarButton_11bqk_11",rue="_active_11bqk_45",r3={toolbar:nue,toolbarButton:iue,active:rue},sue=({viewMode:n})=>{var a,c;const{indirectLightEnabled:e,toggleIndirectLight:t}=Bi(),i=ci(h=>h.placedModules),r=qi(h=>h.spaceInfo),s=((a=r==null?void 0:r.baseConfig)==null?void 0:a.placementType)==="float"&&(((c=r==null?void 0:r.baseConfig)==null?void 0:c.floatHeight)||0)>0,o=i.some(h=>h.moduleId.includes("upper-cabinet")||h.moduleId.includes("upper"));return n!=="3D"||!o&&!s?null:l.jsx("div",{className:r3.toolbar,children:l.jsx("div",{className:`${r3.toolbarButton} ${e?r3.active:""}`,onClick:t,title:e?"간접조명 끄기":"간접조명 켜기",role:"button",tabIndex:0,children:l.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:e?l.jsxs(l.Fragment,{children:[l.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"0",strokeWidth:"1.5"}),l.jsx("line",{x1:"19",y1:"5",x2:"20.5",y2:"3.5",strokeWidth:"1.5"}),l.jsx("line",{x1:"22",y1:"12",x2:"24",y2:"12",strokeWidth:"1.5"}),l.jsx("line",{x1:"19",y1:"19",x2:"20.5",y2:"20.5",strokeWidth:"1.5"}),l.jsx("line",{x1:"12",y1:"22",x2:"12",y2:"24",strokeWidth:"1.5"}),l.jsx("line",{x1:"5",y1:"19",x2:"3.5",y2:"20.5",strokeWidth:"1.5"}),l.jsx("line",{x1:"2",y1:"12",x2:"0",y2:"12",strokeWidth:"1.5"}),l.jsx("line",{x1:"5",y1:"5",x2:"3.5",y2:"3.5",strokeWidth:"1.5"}),l.jsx("rect",{x:"10",y:"4",width:"4",height:"3",fill:"currentColor",fillOpacity:"0.3"}),l.jsx("line",{x1:"10",y1:"5",x2:"14",y2:"5",strokeWidth:"0.5"}),l.jsx("line",{x1:"10",y1:"6",x2:"14",y2:"6",strokeWidth:"0.5"}),l.jsx("circle",{cx:"12",cy:"12",r:"6",fill:"currentColor",fillOpacity:"0.3"}),l.jsx("circle",{cx:"12",cy:"12",r:"6"}),l.jsx("path",{d:"M10 12 L12 14 L14 12 L12 10 Z",stroke:"currentColor",strokeWidth:"0.5",fill:"none"})]}):l.jsxs(l.Fragment,{children:[l.jsx("rect",{x:"10",y:"4",width:"4",height:"3",fill:"currentColor",fillOpacity:"0.3"}),l.jsx("line",{x1:"10",y1:"5",x2:"14",y2:"5",strokeWidth:"0.5"}),l.jsx("line",{x1:"10",y1:"6",x2:"14",y2:"6",strokeWidth:"0.5"}),l.jsx("circle",{cx:"12",cy:"12",r:"6",fill:"currentColor",fillOpacity:"0.3"}),l.jsx("circle",{cx:"12",cy:"12",r:"6"})]})})})})},oue=n=>{var _e;const{spaceInfo:e,svgSize:t,viewMode:i="3D",setViewMode:r,renderMode:s="wireframe",showAll:o=!0,showFurniture:a=!0,showFrame:c=!0,showDimensions:h,isEmbedded:u,isStep2:d,activeZone:f}=n;console.log("🌐 Space3DView - viewMode:",i),console.log("🌐 Space3DView - props:",n),VC();const{spaceInfo:A,updateColumn:g,removeColumn:p,updateWall:y,removeWall:v,addWall:m,removePanelB:w,updatePanelB:x}=qi(),{placedModules:T,updateFurnitureForColumns:j}=ci(),{view2DDirection:D,showDimensions:b,showGuides:_,showAxis:I,activePopup:S,setView2DDirection:F,setViewMode:B,isColumnCreationMode:E,isWallCreationMode:V,isPanelBCreationMode:K,view2DTheme:P}=Bi(),{colors:M}=fI(),{theme:X}=Yo(),Z=tue((W,Y)=>{g(W,Y)},8),Q=A.materialConfig||{interiorColor:"#FFFFFF",doorColor:"#FFFFFF"};O.useEffect(()=>{var W,Y;e&&(console.log("🔄 Space3DView - 기둥 상태 변경 감지:",{columnsCount:((W=e.columns)==null?void 0:W.length)||0,columnsData:(Y=e.columns)==null?void 0:Y.map(ve=>({id:ve.id,position:ve.position,depth:ve.depth}))}),j(e))},[e==null?void 0:e.columns]);const U=O.useMemo(()=>{if(!e)return[0,10,20];const{width:W,height:Y,depth:ve=600}=e,ce=jc(W,Y,ve,T.length),ne=0,he=El(Y*.5),xe=0,Te=[ne,he,ce];if(i==="3D")return Te;switch(D){case"front":return[ne,he,ce];case"left":return[-jc(ve,Y,W,T.length),he,xe];case"right":return[jc(ve,Y,W,T.length),he,xe];case"top":const Ye=jc(W,ve,Y,T.length);return[ne,he+Ye,xe];case"all":return Te;default:return Te}},[e==null?void 0:e.width,e==null?void 0:e.height,e==null?void 0:e.depth,i,D,T.length]),z=W=>{var ce;console.log("🎯 [Space3DView] handleDrop 호출됨!",{windowHandleSlotDrop:typeof window.handleSlotDrop,currentTarget:W.currentTarget.tagName,dataTransfer:W.dataTransfer.getData("application/json")}),W.preventDefault(),W.stopPropagation();const Y=W.currentTarget.querySelector("canvas");if(!Y){console.log("❌ [Space3DView] Canvas 요소를 찾을 수 없음");return}const ve=W.dataTransfer.getData("application/json");if(console.log("🎯 [Space3DView] Drag data:",ve),!ve){console.log("❌ [Space3DView] Drag data가 없음");return}try{const ne=JSON.parse(ve);if(console.log("🎯 [Space3DView] Parsed drag data:",ne),ne.type==="column"){q(W,ne);return}if(ne.type==="wall"){G(W,ne);return}if(ne.type==="panelB"){ie(W,ne);return}const he=window.handleSlotDrop;if(console.log("🎯 Space3DView - window.handleSlotDrop 확인:",{hasHandleSlotDrop:!!he,typeofHandleSlotDrop:typeof he,activeZone:f,windowKeys:Object.keys(window).filter(xe=>xe.includes("handle")),furnitureStoreState:ci.getState().currentDragData}),typeof he=="function"){console.log("🎯 Space3DView handleDrop - activeZone:",f);try{const xe=he(W.nativeEvent,Y,f);console.log("🎯 Space3DView handleDrop - result:",xe)}catch(xe){console.error("❌ handleSlotDrop 실행 중 에러:",xe),console.error("에러 스택:",xe.stack)}}else{console.error("❌ window.handleSlotDrop이 없습니다! 기본 가구 배치 처리를 시도합니다.");const xe=Y.getBoundingClientRect(),Te=(W.clientX-xe.left)/xe.width*2-1,Ce=-((W.clientY-xe.top)/xe.height)*2+1;console.log("🎯 간단한 가구 배치 시도:",{mouseX:Te,mouseY:Ce,moduleData:ne.moduleData});const Be=ci.getState().placedModules,Ye=ci.getState().addModule,$e=qi.getState().spaceInfo,ot=ur($e);let rt=-1;for(let Ve=0;Ve<ot.columnCount;Ve++)if(!Be.some(De=>De.slotIndex===Ve)){rt=Ve;break}if(rt>=0){const Ve=((ce=ot.slotWidths)==null?void 0:ce[rt])||ot.columnWidth,We={id:`placed-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,moduleId:ne.moduleData.id,position:{x:ot.threeUnitPositions[rt],y:0,z:0},rotation:0,hasDoor:!1,customDepth:Math.min(580,$e.depth*.9),slotIndex:rt,isDualSlot:ne.moduleData.id.startsWith("dual-"),isValidInCurrentSpace:!0,adjustedWidth:ne.moduleData.dimensions.width,hingePosition:"right",customWidth:Ve};Ye(We),console.log("✅ 폴백 가구 배치 성공:",We)}}}catch(ne){console.error("드롭 데이터 파싱 오류:",ne),console.error("에러 스택:",ne.stack)}},q=(W,Y)=>{const ve=W.currentTarget.getBoundingClientRect(),ce=(W.clientX-ve.left-ve.width/2)/100,ne=((e==null?void 0:e.depth)||1500)*.01,he=(Y.depth||730)*.01,xe=-(ne/2)+he/2,Te={id:`column-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,position:[ce,0,xe],width:Y.width||300,height:Y.height||(e==null?void 0:e.height)||2400,depth:Y.depth||730,color:Y.color||"#888888",material:Y.material||"concrete"};console.log("🏗️ 기둥 드롭 배치:",{centerX:ce,zPosition:xe,spaceDepthM:ne,columnDepthM:he,column:Te});const{addColumn:Ce}=qi.getState();Ce(Te)},G=(W,Y)=>{const ve=W.currentTarget.getBoundingClientRect(),ce=(W.clientX-ve.left-ve.width/2)/100,ne=((e==null?void 0:e.depth)||1500)*.01,he=(Y.depth||730)*.01,xe=-(ne/2)+he/2,Te={id:`wall-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,position:[ce,0,xe],width:Y.width||120,height:Y.height||(e==null?void 0:e.height)||2400,depth:Y.depth||730,color:Y.color||"#888888",material:Y.material||"concrete"};console.log("🧱 가벽 드롭 배치:",{centerX:ce,zPosition:xe,spaceDepthM:ne,wallDepthM:he,wall:Te}),m(Te)},ie=(W,Y)=>{const ve=W.currentTarget.getBoundingClientRect(),ce=(W.clientX-ve.left-ve.width/2)/100,ne=((e==null?void 0:e.depth)||1500)*.01,he=(Y.depth||730)*.01,xe=-(ne/2)+he/2,Te={id:`panelB-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,position:[ce,0,xe],width:Y.width||600,height:18,depth:Y.depth||730,color:Y.color||"#8B4513",material:Y.material||"wood",orientation:"horizontal"};console.log("🪵 패널B 드롭 배치:",{centerX:ce,zPosition:xe,spaceDepthM:ne,panelDepthM:he,panelB:Te});const{addPanelB:Ce}=qi.getState();Ce(Te)},H=W=>{W.preventDefault()};O.useEffect(()=>()=>{(()=>{document.querySelectorAll("canvas").forEach(ve=>{const ce=ve.getContext("2d");ce&&ce.clearRect(0,0,ve.width,ve.height);const ne=ve.getContext("webgl")||ve.getContext("webgl2");if(ne&&!ne.isContextLost())try{const he=ne.getExtension("WEBGL_lose_context");he&&he.loseContext()}catch(he){console.log("WebGL context cleanup error:",he)}})})()},[]);const se=O.useMemo(()=>{if(!e||T.length===0)return null;let W=1/0,Y=-1/0,ve=1/0,ce=-1/0,ne=1/0,he=-1/0;T.forEach(Be=>{const Ye=Hi(Be.moduleId);if(!Ye)return;const $e=El(Be.customWidth||Ye.width),ot=El(Be.customHeight||Ye.height),rt=El(Be.customDepth||Ye.depth),Ve=Be.position.x,We=Be.position.y,De=Be.position.z;W=Math.min(W,Ve-$e/2),Y=Math.max(Y,Ve+$e/2),ve=Math.min(ve,We),ce=Math.max(ce,We+ot),ne=Math.min(ne,De-rt/2),he=Math.max(he,De+rt/2)});const xe=El(e.width),Te=El(e.height),Ce=El(e.depth||1500);return W=Math.min(W,-xe/2),Y=Math.max(Y,xe/2),ve=0,ce=Math.max(ce,Te),ne=Math.min(ne,-Ce/2),he=Math.max(he,Ce/2),{center:{x:(W+Y)/2,y:(ve+ce)/2,z:(ne+he)/2},size:{width:Y-W,height:ce-ve,depth:he-ne}}},[e,T]),te=W=>{const Y=se,ve=(e==null?void 0:e.width)||3e3,ce=(e==null?void 0:e.height)||2400,ne=(e==null?void 0:e.depth)||1500;if(!Y){const $e={x:0,y:El(ce*.5),z:0};let ot,rt,Ve=[0,1,0];switch(W){case"front":ot=jc(ve,ce,ne,T.length),rt=[$e.x,$e.y,$e.z+ot],Ve=[0,1,0];break;case"top":ot=jc(ve,ne,ce,T.length),rt=[$e.x,$e.y+ot,$e.z],Ve=[0,0,-1];break;case"left":ot=jc(ne,ce,ve,T.length),rt=[$e.x-ot,$e.y,$e.z],Ve=[0,1,0];break;case"right":ot=jc(ne,ce,ve,T.length),rt=[$e.x+ot,$e.y,$e.z],Ve=[0,1,0];break}return{position:rt,target:[$e.x,$e.y,$e.z],up:Ve}}const he=Y.center,xe=Y.size,Te={width:zS(xe.width),height:zS(xe.height),depth:zS(xe.depth)};let Ce,Be,Ye=[0,1,0];switch(W){case"front":Ce=jc(Te.width,Te.height,Te.depth,T.length),Be=[he.x,he.y,he.z+Ce],Ye=[0,1,0];break;case"top":Ce=jc(Te.width,Te.depth,Te.height,T.length),Be=[he.x,he.y+Ce,he.z],Ye=[0,0,-1];break;case"left":Ce=jc(Te.depth,Te.height,Te.width,T.length),Be=[he.x-Ce,he.y,he.z],Ye=[0,1,0];break;case"right":Ce=jc(Te.depth,Te.height,Te.width,T.length),Be=[he.x+Ce,he.y,he.z],Ye=[0,1,0];break}return{position:Be,target:[he.x,he.y,he.z],up:Ye}},[fe,ye]=ii.useState(null),be=W=>{F(W),B("2D")};return i==="2D"&&D==="all"?l.jsx(yj,{viewMode:i,children:l.jsx(GB,{spaceInfo:e,svgSize:t,renderMode:s,viewMode:i,activeZone:f,children:l.jsxs("div",{style:{width:"100%",height:"100%",minHeight:"400px",position:"relative",display:"grid",gridTemplateColumns:"1fr 1fr",gridTemplateRows:"1fr 1fr",gap:"0",backgroundColor:M.primary||"#4CAF50",overflow:"hidden"},children:[l.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"1px",backgroundColor:X.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.15)",zIndex:10,transform:"translateY(-50%)"}}),l.jsx("div",{style:{position:"absolute",top:0,bottom:0,left:"50%",width:"1px",backgroundColor:X.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.15)",zIndex:10,transform:"translateX(-50%)"}}),l.jsxs("div",{onClick:()=>ye(fe==="front"?null:"front"),style:{position:"relative",overflow:"hidden",backgroundColor:"#121212",border:fe==="front"?`3px solid ${th()}`:"1px solid transparent",transition:"border 0.3s ease",boxSizing:"border-box",cursor:"pointer"},children:[l.jsx(B0,{cameraPosition:te("front").position,cameraTarget:te("front").target,cameraUp:te("front").up,viewMode:"2D",view2DDirection:"front",renderMode:s,isSplitView:!0,children:l.jsx(tx,{viewDirection:"front",spaceInfo:e,materialConfig:Q,showAll:o,showFrame:c,showFurniture:a,viewMode:"2D",renderMode:s,activeZone:f,showDimensions:b,showGuides:_,showAxis:I,isStep2:d})}),l.jsx("div",{style:{position:"absolute",top:"8px",left:"8px",backgroundColor:"rgba(18,18,18,0.7)",color:"#fff",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",backdropFilter:"blur(4px)",border:"1px solid rgba(255,255,255,0.1)"},children:"front"}),l.jsx("button",{onClick:()=>be("front"),style:{position:"absolute",top:"8px",right:"8px",backgroundColor:"rgba(18,18,18,0.7)",color:"#fff",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"4px",padding:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(4px)",transition:"all 0.2s ease"},onMouseEnter:W=>{W.currentTarget.style.backgroundColor="rgba(255,255,255,0.1)",W.currentTarget.style.borderColor="rgba(255,255,255,0.4)"},onMouseLeave:W=>{W.currentTarget.style.backgroundColor="rgba(18,18,18,0.7)",W.currentTarget.style.borderColor="rgba(255,255,255,0.2)"},title:"전체화면으로 보기",children:l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})})})]}),l.jsxs("div",{onClick:()=>ye(fe==="top"?null:"top"),style:{position:"relative",overflow:"hidden",backgroundColor:"#121212",border:fe==="top"?`3px solid ${th()}`:"1px solid transparent",transition:"border 0.3s ease",boxSizing:"border-box",cursor:"pointer"},children:[l.jsx(B0,{cameraPosition:te("top").position,cameraTarget:te("top").target,cameraUp:te("top").up,viewMode:"2D",view2DDirection:"top",renderMode:s,isSplitView:!0,children:l.jsx(tx,{viewDirection:"top",spaceInfo:e,materialConfig:Q,showAll:o,showFrame:c,showFurniture:a,viewMode:"2D",renderMode:s,activeZone:f,showDimensions:b,showGuides:_,showAxis:I,isStep2:d})}),l.jsx("div",{style:{position:"absolute",top:"8px",left:"8px",backgroundColor:"rgba(18,18,18,0.7)",color:"#fff",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",backdropFilter:"blur(4px)",border:"1px solid rgba(255,255,255,0.1)"},children:"top"}),l.jsx("button",{onClick:()=>be("top"),style:{position:"absolute",top:"8px",right:"8px",backgroundColor:"rgba(18,18,18,0.7)",color:"#fff",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"4px",padding:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(4px)",transition:"all 0.2s ease"},onMouseEnter:W=>{W.currentTarget.style.backgroundColor="rgba(255,255,255,0.1)",W.currentTarget.style.borderColor="rgba(255,255,255,0.4)"},onMouseLeave:W=>{W.currentTarget.style.backgroundColor="rgba(18,18,18,0.7)",W.currentTarget.style.borderColor="rgba(255,255,255,0.2)"},title:"전체화면으로 보기",children:l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})})})]}),l.jsxs("div",{onClick:()=>ye(fe==="left"?null:"left"),style:{position:"relative",overflow:"hidden",backgroundColor:"#121212",border:fe==="left"?`3px solid ${th()}`:"1px solid transparent",transition:"border 0.3s ease",boxSizing:"border-box",cursor:"pointer"},children:[l.jsx(B0,{cameraPosition:te("left").position,cameraTarget:te("left").target,cameraUp:te("left").up,viewMode:"2D",view2DDirection:"left",renderMode:s,isSplitView:!0,children:l.jsx(tx,{viewDirection:"left",spaceInfo:e,materialConfig:Q,showAll:o,showFrame:c,showFurniture:a,viewMode:"2D",renderMode:s,activeZone:f,showDimensions:b,showGuides:_,showAxis:I,isStep2:d})}),l.jsx("div",{style:{position:"absolute",top:"8px",left:"8px",backgroundColor:"rgba(18,18,18,0.7)",color:"#fff",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",backdropFilter:"blur(4px)",border:"1px solid rgba(255,255,255,0.1)"},children:"left"}),l.jsx("button",{onClick:()=>be("left"),style:{position:"absolute",top:"8px",right:"8px",backgroundColor:"rgba(18,18,18,0.7)",color:"#fff",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"4px",padding:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(4px)",transition:"all 0.2s ease"},onMouseEnter:W=>{W.currentTarget.style.backgroundColor="rgba(255,255,255,0.1)",W.currentTarget.style.borderColor="rgba(255,255,255,0.4)"},onMouseLeave:W=>{W.currentTarget.style.backgroundColor="rgba(18,18,18,0.7)",W.currentTarget.style.borderColor="rgba(255,255,255,0.2)"},title:"전체화면으로 보기",children:l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})})})]}),l.jsxs("div",{onClick:()=>ye(fe==="right"?null:"right"),style:{position:"relative",overflow:"hidden",backgroundColor:"#121212",border:fe==="right"?`3px solid ${th()}`:"1px solid transparent",transition:"border 0.3s ease",boxSizing:"border-box",cursor:"pointer"},children:[l.jsx(B0,{cameraPosition:te("right").position,cameraTarget:te("right").target,cameraUp:te("right").up,viewMode:"2D",view2DDirection:"right",renderMode:s,isSplitView:!0,children:l.jsx(tx,{viewDirection:"right",spaceInfo:e,materialConfig:Q,showAll:o,showFrame:c,showFurniture:a,viewMode:"2D",renderMode:s,activeZone:f,showDimensions:b,showGuides:_,showAxis:I,isStep2:d})}),l.jsx("div",{style:{position:"absolute",top:"8px",left:"8px",backgroundColor:"rgba(18,18,18,0.7)",color:"#fff",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",backdropFilter:"blur(4px)",border:"1px solid rgba(255,255,255,0.1)"},children:"right"}),l.jsx("button",{onClick:()=>be("right"),style:{position:"absolute",top:"8px",right:"8px",backgroundColor:"rgba(18,18,18,0.7)",color:"#fff",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"4px",padding:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(4px)",transition:"all 0.2s ease"},onMouseEnter:W=>{W.currentTarget.style.backgroundColor="rgba(255,255,255,0.1)",W.currentTarget.style.borderColor="rgba(255,255,255,0.4)"},onMouseLeave:W=>{W.currentTarget.style.backgroundColor="rgba(18,18,18,0.7)",W.currentTarget.style.borderColor="rgba(255,255,255,0.2)"},title:"전체화면으로 보기",children:l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})})})]})]})})}):l.jsx(yj,{viewMode:i,children:l.jsx(GB,{spaceInfo:e,svgSize:t,renderMode:s,viewMode:i,activeZone:f,children:l.jsxs("div",{style:{width:"100%",height:"100%",minHeight:"400px",position:"relative"},onDrop:z,onDragOver:H,"data-viewer-container":"true",children:[l.jsx(sue,{viewMode:i}),l.jsx(B0,{cameraPosition:U,cameraTarget:VQ((e==null?void 0:e.height)||2400),viewMode:i,view2DDirection:D,renderMode:s,children:l.jsxs(ii.Suspense,{fallback:null,children:[l.jsx(P$,{viewMode:i,view2DDirection:D,enabled:b&&_,showAxis:b&&I}),l.jsx("directionalLight",{position:[5,15,20],intensity:2.5,color:"#ffffff",castShadow:i==="3D","shadow-mapSize-width":4096,"shadow-mapSize-height":4096,"shadow-camera-far":50,"shadow-camera-left":-25,"shadow-camera-right":25,"shadow-camera-top":25,"shadow-camera-bottom":-25,"shadow-bias":-5e-4,"shadow-radius":12,"shadow-normalBias":.02}),l.jsx("directionalLight",{position:[-8,10,15],intensity:.6,color:"#ffffff"}),l.jsx("directionalLight",{position:[8,10,15],intensity:.6,color:"#ffffff"}),l.jsx("ambientLight",{intensity:i==="2D"?.8:.5,color:"#ffffff"}),l.jsx(jI,{spaceInfo:e,viewMode:i,view2DDirection:D,renderMode:s,materialConfig:Q,showAll:o,showFurniture:a,showFrame:c,showDimensions:b,showGuides:_,isStep2:d,activeZone:f}),l.jsx(Zhe,{spaceInfo:e}),((e==null?void 0:e.columns)||[]).map(W=>{var ve;let Y=W.height||e.height||2400;if((ve=e.droppedCeiling)!=null&&ve.enabled){const ce=e.width,ne=e.droppedCeiling.width||yo.WIDTH,he=e.droppedCeiling.position||"right",xe=e.droppedCeiling.dropHeight||200,Te=W.position[0]*100,Ce=0,Be=Ce-ce/2,Ye=Ce+ce/2;let $e,ot;he==="left"?($e=Be,ot=Be+ne):($e=Ye-ne,ot=Ye),Te>=$e&&Te<=ot&&(Y=W.height-xe)}return l.jsxs(ii.Fragment,{children:[l.jsx(I$,{id:W.id,position:W.position,width:W.width,height:Y,depth:W.depth,color:W.color,hasBackPanelFinish:W.hasBackPanelFinish,spaceInfo:e,renderMode:s,onPositionChange:(ce,ne)=>{Z(ce,{position:ne})},onRemove:ce=>{p(ce)}}),S.type==="columnEdit"&&S.id===W.id&&l.jsx(F$,{column:W,spaceInfo:e,onPositionChange:(ce,ne)=>{Z(ce,{position:ne})},onColumnUpdate:(ce,ne)=>{g(ce,ne)},showLabels:!0})]},W.id)}),((e==null?void 0:e.walls)||[]).map(W=>{var ve;let Y=W.height;if((ve=e.droppedCeiling)!=null&&ve.enabled){const ce=e.width,ne=e.droppedCeiling.width||yo.WIDTH,he=e.droppedCeiling.position||"right",xe=e.droppedCeiling.dropHeight||200,Te=W.position[0]*100,Ce=0,Be=Ce-ce/2,Ye=Ce+ce/2;let $e,ot;he==="left"?($e=Be,ot=Be+ne):($e=Ye-ne,ot=Ye),console.log("🏗️ 가벽 단내림 체크:",{wallId:W.id,wallXMm:Te,droppedStartX:$e,droppedEndX:ot,isInDroppedArea:Te>=$e&&Te<=ot,originalHeight:W.height,dropHeight:xe,wallHeight:Y}),Te>=$e&&Te<=ot&&(Y=W.height-xe,console.log("🏗️ 가벽 높이 조정됨:",{wallId:W.id,originalHeight:W.height,adjustedHeight:Y}))}return l.jsx(Vhe,{id:W.id,position:W.position,width:W.width,height:Y,depth:W.depth,color:W.color,spaceInfo:e,renderMode:s,onPositionChange:(ce,ne)=>{y(ce,{position:ne})},onRemove:ce=>{v(ce)}},W.id)}),(_e=e==null?void 0:e.panelBs)==null?void 0:_e.map(W=>l.jsx(Khe,{id:W.id,position:W.position,width:W.width,height:W.height,depth:W.depth,color:W.color,renderMode:i==="3D"?"solid":"wireframe",onPositionChange:(Y,ve)=>x(Y,{position:ve}),onRemove:w,spaceInfo:e},W.id)),K&&i==="3D"&&l.jsx(qhe,{spaceInfo:e}),l.jsx(Ghe,{spaceInfo:e}),b&&o&&l.jsx(D$,{viewMode:i}),l.jsx(j$,{viewDirection:i==="3D"?"3D":D,showDimensions:b,showFurniture:a,isStep2:d}),l.jsx(N$,{spaceInfo:e,showAll:o,showDimensions:b,viewMode:i}),l.jsx(eue,{})]})}),i==="2D"&&D!=="all"&&l.jsx("button",{onClick:()=>{F("all")},style:{position:"absolute",top:"10px",right:"10px",width:"36px",height:"36px",backgroundColor:P==="dark"?"rgba(18,18,18,0.7)":"rgba(255,255,255,0.9)",border:`1px solid ${P==="dark"?"rgba(255,255,255,0.2)":"rgba(0,0,0,0.2)"}`,borderRadius:"4px",color:P==="dark"?"#ffffff":"#000000",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease",zIndex:20,padding:"0",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},onMouseEnter:W=>{W.currentTarget.style.backgroundColor=P==="dark"?"rgba(18,18,18,0.9)":"rgba(255,255,255,1)",W.currentTarget.style.borderColor=P==="dark"?"rgba(255,255,255,0.4)":"rgba(0,0,0,0.4)",W.currentTarget.style.transform="scale(1.05)"},onMouseLeave:W=>{W.currentTarget.style.backgroundColor=P==="dark"?"rgba(18,18,18,0.7)":"rgba(255,255,255,0.9)",W.currentTarget.style.borderColor=P==="dark"?"rgba(255,255,255,0.2)":"rgba(0,0,0,0.2)",W.currentTarget.style.transform="scale(1)"},title:"4분할 뷰로 보기",children:l.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[l.jsx("rect",{x:"3",y:"3",width:"8",height:"8"}),l.jsx("rect",{x:"13",y:"3",width:"8",height:"8"}),l.jsx("rect",{x:"3",y:"13",width:"8",height:"8"}),l.jsx("rect",{x:"13",y:"13",width:"8",height:"8"})]})})]})})})},tx=({viewDirection:n,spaceInfo:e,materialConfig:t,showAll:i,showFrame:r,showDimensions:s,showGuides:o,showAxis:a,showFurniture:c=!0,isStep2:h,throttledUpdateColumn:u,activeZone:d,viewMode:f="2D",renderMode:A="wireframe"})=>{const{placedModules:g}=ci(),{updateColumn:p,removeColumn:y,updateWall:v,removeWall:m}=qi(),{activePopup:w}=Bi(),x=u||p;return l.jsxs(ii.Suspense,{fallback:null,children:[l.jsx(P$,{viewMode:"2D",view2DDirection:n,enabled:s&&o,showAxis:s&&a}),l.jsx("directionalLight",{position:[5,15,20],intensity:2.5,color:"#ffffff"}),l.jsx("directionalLight",{position:[-8,10,15],intensity:.6,color:"#ffffff"}),l.jsx("directionalLight",{position:[8,10,15],intensity:.6,color:"#ffffff"}),l.jsx("ambientLight",{intensity:.8,color:"#ffffff"}),((e==null?void 0:e.columns)||[]).map(T=>l.jsxs(ii.Fragment,{children:[l.jsx(I$,{id:T.id,position:T.position,width:T.width,height:T.height||e.height||2400,depth:T.depth,color:T.color,hasBackPanelFinish:T.hasBackPanelFinish,spaceInfo:e,renderMode:"solid",onPositionChange:(j,D)=>{x(j,{position:D})},onRemove:j=>{y(j)}}),w.type==="columnEdit"&&w.id===T.id&&l.jsx(F$,{column:T,spaceInfo:e,onPositionChange:(j,D)=>{x(j,{position:D})},onColumnUpdate:(j,D)=>{x(j,D)},showLabels:!0})]},T.id)),s&&i&&l.jsx(D$,{viewMode:f,view2DDirection:n}),l.jsx(j$,{viewDirection:n,showDimensions:s,showFurniture:c,isStep2:h}),n!=="top"&&l.jsx(Jhe,{spaceInfo:e}),l.jsx(N$,{spaceInfo:e,showAll:i,showDimensions:s,viewMode:f}),console.log("🎯 QuadrantContent - Room 렌더링:",{viewDirection:n,spaceInfo:!!e,showFrame:r,placedModulesCount:(g==null?void 0:g.length)||0}),l.jsx(jI,{spaceInfo:e,viewMode:"2D",view2DDirection:n,renderMode:A,showDimensions:s,showAll:i,showFurniture:c,isStep2:h,showFrame:r,materialConfig:t,placedModules:g,activeZone:d})]})},F5=ii.memo(oue),aue="_container_y1ww6_2",lue="_section_y1ww6_9",cue="_label_y1ww6_43",hue="_disabledMessage_y1ww6_50",uue="_inputLabel_y1ww6_60",due="_inputWrapper_y1ww6_119",Aue="_inputWithUnit_y1ww6_125",fue="_input_y1ww6_60",pue="_inputWithUnitField_y1ww6_148",gue="_unit_y1ww6_152",mue="_inputError_y1ww6_161",yue="_errorMessage_y1ww6_166",vue="_toggleButtonGroup_y1ww6_218",wue="_toggleButton_y1ww6_218",xue="_toggleButtonActive_y1ww6_254",bue="_disabledLabel_y1ww6_356",_ue="_disabledText_y1ww6_361",yi={container:aue,section:lue,label:cue,disabledMessage:hue,inputLabel:uue,inputWrapper:due,inputWithUnit:Aue,input:fue,inputWithUnitField:pue,unit:gue,inputError:mue,errorMessage:yue,toggleButtonGroup:vue,toggleButton:wue,toggleButtonActive:xue,disabledLabel:bue,disabledText:_ue},L$=({spaceInfo:n,onUpdate:e,disabled:t=!1})=>{const[i,r]=O.useState(),[s,o]=O.useState(!1),a=(n==null?void 0:n.width)||Au.WIDTH,[c,h]=O.useState(a.toString());O.useEffect(()=>{h(a.toString())},[a]);const u=A=>{(A===""||/^\d+$/.test(A))&&h(A)},d=()=>{const A=c;if(A===""){h(a.toString());return}const g=parseInt(A),p=Xl.WIDTH.MIN,y=Xl.WIDTH.MAX;g<p?r(`최소 ${p}mm 이상이어야 합니다`):g>y?r(`최대 ${y}mm 이하여야 합니다`):(r(""),e({width:g}))},f=A=>{if(A.key==="Enter")d();else if(A.key==="ArrowUp"||A.key==="ArrowDown"){A.preventDefault();const g=parseInt(c)||a,p=Xl.WIDTH.MIN,y=Xl.WIDTH.MAX;let v;A.key==="ArrowUp"?v=Math.min(g+1,y):v=Math.max(g-1,p),v!==g&&(h(v.toString()),r(""),e({width:v}))}};return l.jsxs("div",{className:yi.inputWrapper,style:{position:"relative"},children:[s&&l.jsxs("label",{className:`${yi.inputLabel} ${t?yi.disabledLabel:""}`,style:{position:"absolute",bottom:"-20px",fontSize:"11px",color:"#5b21b6",zIndex:10},children:[Xl.WIDTH.MIN,"~",Xl.WIDTH.MAX,"mm",t&&l.jsx("span",{className:yi.disabledText,children:" (수정불가)"})]}),l.jsxs("div",{className:yi.inputWithUnit,children:[l.jsx("input",{type:"text",value:c,onChange:A=>u(A.target.value),onFocus:()=>o(!0),onBlur:()=>{o(!1),d()},onKeyDown:f,className:`${yi.input} ${yi.inputWithUnitField} ${i?yi.inputError:""}`,placeholder:`${Xl.WIDTH.MIN}-${Xl.WIDTH.MAX}`,disabled:t}),l.jsx("span",{className:yi.unit,children:"mm"})]}),i&&l.jsx("div",{className:yi.errorMessage,children:i})]})},M$=({spaceInfo:n,onUpdate:e})=>{const[t,i]=O.useState(),[r,s]=O.useState(!1),o=(n==null?void 0:n.height)||Au.HEIGHT,[a,c]=O.useState(o.toString());O.useEffect(()=>{c(o.toString())},[o]);const h=f=>{(f===""||/^\d+$/.test(f))&&c(f)},u=()=>{const f=a;if(f===""){c(o.toString());return}const A=parseInt(f),g=Xl.HEIGHT.MIN,p=Xl.HEIGHT.MAX;A<g?i(`최소 ${g}mm 이상이어야 합니다`):A>p?i(`최대 ${p}mm 이하여야 합니다`):(i(""),e({height:A}))},d=f=>{if(f.key==="Enter")u();else if(f.key==="ArrowUp"||f.key==="ArrowDown"){f.preventDefault();const A=parseInt(a)||o,g=Xl.HEIGHT.MIN,p=Xl.HEIGHT.MAX;let y;f.key==="ArrowUp"?y=Math.min(A+1,p):y=Math.max(A-1,g),y!==A&&(c(y.toString()),i(""),e({height:y}))}};return l.jsxs("div",{className:yi.inputWrapper,style:{position:"relative"},children:[r&&l.jsxs("label",{className:yi.inputLabel,style:{position:"absolute",bottom:"-20px",fontSize:"11px",color:"#5b21b6",zIndex:10},children:[Xl.HEIGHT.MIN,"~",Xl.HEIGHT.MAX,"mm"]}),l.jsxs("div",{className:yi.inputWithUnit,children:[l.jsx("input",{type:"text",value:a,onChange:f=>h(f.target.value),onFocus:()=>s(!0),onBlur:()=>{s(!1),u()},onKeyDown:d,className:`${yi.input} ${yi.inputWithUnitField} ${t?yi.inputError:""}`,placeholder:`${Xl.HEIGHT.MIN}-${Xl.HEIGHT.MAX}`}),l.jsx("span",{className:yi.unit,children:"mm"})]}),t&&l.jsx("div",{className:yi.errorMessage,children:t})]})},Cue="_container_jwj2m_2",Sue="_loadingOverlay_jwj2m_17",Tue="_modalContent_jwj2m_32",Bue="_header_jwj2m_55",Eue="_closeButton_jwj2m_62",kue="_content_jwj2m_93",Iue="_leftSection_jwj2m_100",Fue="_toggleButton_jwj2m_122",Due="_active_jwj2m_134",jue="_editorViewer_jwj2m_144",Pue="_rightSection_jwj2m_157",Nue="_formContent_jwj2m_167",Lue="_divider_jwj2m_177",Mue="_compactSection_jwj2m_184",Rue="_compactLabel_jwj2m_190",Oue="_sizeLabel_jwj2m_197",Uue="_toggleButtonsWide_jwj2m_215",Hue="_rangeInput_jwj2m_247",Wue="_rangeValue_jwj2m_274",Que="_sizeInputs_jwj2m_371",$ue="_numberInput_jwj2m_464",Vue="_footer_jwj2m_488",zue="_previousButton_jwj2m_499",Gue="_confirmButton_jwj2m_516",Xue="_disabled_jwj2m_531",Kue="_labelText_jwj2m_607",que="_unitText_jwj2m_613",Yue="_inputField_jwj2m_618",Zue="_wideInputField_jwj2m_631",Sn={container:Cue,loadingOverlay:Sue,modalContent:Tue,header:Bue,closeButton:Eue,content:kue,leftSection:Iue,toggleButton:Fue,active:Due,editorViewer:jue,rightSection:Pue,formContent:Nue,divider:Lue,compactSection:Mue,compactLabel:Rue,sizeLabel:Oue,toggleButtonsWide:Uue,rangeInput:Hue,rangeValue:Wue,sizeInputs:Que,numberInput:$ue,footer:Vue,previousButton:zue,confirmButton:Gue,disabled:Xue,labelText:Kue,unitText:que,inputField:Yue,wideInputField:Zue},Jue=({onPrevious:n,onClose:e,projectId:t,projectTitle:i})=>{var b,_,I,S,F,B,E,V,K,P,M,X,Z,Q,U,z,q,G,ie,H,se,te,fe,ye,be,_e,W,Y,ve,ce;const{t:r}=Kv(),s=xc(),[o,a]=O.useState(!1),c="3D",[h,u]=O.useState(0),{basicInfo:d,projectId:f,projectTitle:A}=Ha(),g=O.useRef(null),p=O.useRef(null);O.useEffect(()=>{g.current||(g.current=f||t||null),p.current||(p.current=A||i||null)},[]),O.useEffect(()=>{f&&(g.current=f),A&&(p.current=A)},[f,A]);const y=O.useMemo(()=>g.current||f||t||null,[f,t,g.current]),v=O.useMemo(()=>p.current||A||i||null,[A,i,p.current]);console.log("🔥 Step2 projectId/Title 확인:",{storeProjectId:f,propsProjectId:t,finalProjectId:y,storeProjectTitle:A,propsProjectTitle:i,finalProjectTitle:v});const{spaceInfo:m,setSpaceInfo:w}=qi(),{placedModules:x}=ci();O.useEffect(()=>{var he,xe;const ne={};m.surroundType||(ne.surroundType="no-surround",ne.frameSize={left:0,right:0,top:0},ne.gapConfig={left:m.installType==="builtin"||m.installType==="semistanding"&&((he=m.wallConfig)!=null&&he.left)?2:20,right:m.installType==="builtin"||m.installType==="semistanding"&&((xe=m.wallConfig)!=null&&xe.right)?2:20},ne.baseConfig={type:"floor",height:65,placementType:"ground"}),!m.customColumnCount&&!m.mainDoorCount&&(ne.customColumnCount=3),Object.keys(ne).length>0&&w({...m,...ne})},[]);const T=m.width>0&&m.height>0,j=ne=>{w({...m,...ne}),u(he=>he+1)};O.useEffect(()=>{u(ne=>ne+1)},[m.width,m.height,m.installType,(b=m.wallConfig)==null?void 0:b.left,(_=m.wallConfig)==null?void 0:_.right,m.surroundType,(I=m.gapConfig)==null?void 0:I.left,(S=m.gapConfig)==null?void 0:S.right]);const D=async()=>{if(!d.title||!d.location||!T){alert("모든 필수 정보를 입력해주세요.");return}a(!0);try{const ne=await mr();if(!ne)throw new Error("사용자 정보를 찾을 수 없습니다.");const he=Ks(),xe={userId:ne.uid,basicInfo:{title:d.title,location:d.location,description:d.description||"",unitType:d.unitType||"household",category:d.category||"residential",createdAt:he,updatedAt:he,version:"1.0.0"},spaceConfig:m,customLayout:{wall:{type:m.surroundType==="surround"?"wall":"nowall",completed:!0},rack:{thickness:"2mm",completed:!1,options:{isComposite:!1}},motor:{type:"none",completed:!1},ventilation:{type:"none",completed:!1},exhaust:{type:"none",completed:!1}}},Te=y;if(!Te)throw new Error("프로젝트를 먼저 선택해주세요.");if(console.log("📋 기존 프로젝트에 디자인 파일 생성, 프로젝트 ID:",Te),Te){const Ce=d.title||"새로운 디자인",Be=$b(m,x.length),Ye=await hI({name:Ce,projectId:Te,spaceConfig:m,furniture:{placedModules:[]},thumbnail:Be});if(Ye.id){try{const $e=new BroadcastChannel("project-updates");$e.postMessage({type:"DESIGN_FILE_UPDATED",action:"design_created",projectId:Te,designFileId:Ye.id}),$e.close()}catch($e){console.warn("BroadcastChannel 전송 실패 (무시 가능):",$e)}e&&e(),setTimeout(()=>{s(`/configurator?projectId=${Te}&designFileId=${Ye.id}`,{replace:!0})},100)}else throw new Error(Ye.error||"디자인 파일 생성 실패")}}catch(ne){console.error("프로젝트 생성 오류:",ne),alert(`프로젝트 생성 중 오류가 발생했습니다: ${ne instanceof Error?ne.message:"알 수 없는 오류"}`)}finally{a(!1)}};return l.jsxs("div",{className:Sn.container,"data-theme":"light",style:{colorScheme:"light"},children:[o&&l.jsx("div",{className:Sn.loadingOverlay,children:l.jsx(Gm,{message:"Loading",size:"large",type:"spinner"})}),l.jsxs("div",{className:Sn.modalContent,children:[l.jsxs("div",{className:Sn.header,children:[l.jsx("button",{className:Sn.closeButton,"aria-label":"닫기",onClick:e,children:"×"}),l.jsx("div",{children:l.jsxs("h1",{children:["STEP. 2 공간 설정",v&&l.jsxs("span",{style:{marginLeft:"20px",fontSize:"0.8em",color:"#666"},children:["프로젝트: ",v," / 디자인: ",d.title||"새 디자인"," / ",d.location||"위치 미정"]})]})})]}),l.jsxs("div",{className:Sn.content,children:[l.jsx("div",{className:Sn.leftSection,children:l.jsx("div",{className:Sn.editorViewer,children:l.jsx(F5,{spaceInfo:m,viewMode:c,renderMode:"solid",showAll:!0,showDimensions:!0,showFrame:!0,isEmbedded:!0,isStep2:!0,setViewMode:()=>{}},`${h}-${(F=m.wallConfig)!=null&&F.left?"L":"R"}-${(B=m.gapConfig)==null?void 0:B.left}-${(E=m.gapConfig)==null?void 0:E.right}`)})}),l.jsx("div",{className:Sn.rightSection,children:l.jsxs("div",{className:Sn.formContent,children:[l.jsxs("div",{className:Sn.compactSection,children:[l.jsx("label",{className:Sn.compactLabel,children:r("space.installType")}),l.jsxs("div",{className:Sn.toggleButtonsWide,children:[l.jsx("button",{className:`${Sn.toggleButton} ${m.installType==="builtin"?Sn.active:""}`,onClick:()=>{const ne={installType:"builtin"};ne.wallConfig={left:!0,right:!0},ne.gapConfig={left:2,right:2},j(ne)},title:r("space.builtinDesc"),children:r("space.builtin")}),l.jsx("button",{className:`${Sn.toggleButton} ${m.installType==="semistanding"?Sn.active:""}`,onClick:()=>{const ne={installType:"semistanding"};ne.wallConfig={left:!0,right:!1},ne.gapConfig={left:2,right:20},j(ne)},title:r("space.semistandingDesc"),children:r("space.semistanding")}),l.jsx("button",{className:`${Sn.toggleButton} ${m.installType==="freestanding"?Sn.active:""}`,onClick:()=>{const ne={installType:"freestanding"};ne.wallConfig={left:!1,right:!1},ne.gapConfig={left:20,right:20},j(ne)},title:r("space.freestandingDesc"),children:r("space.freestanding")})]})]}),m.installType==="semistanding"&&l.jsxs("div",{className:Sn.compactSection,children:[l.jsx("label",{className:Sn.compactLabel,children:r("space.wallPosition")}),l.jsxs("div",{className:Sn.toggleButtonsWide,children:[l.jsx("button",{className:`${Sn.toggleButton} ${(V=m.wallConfig)!=null&&V.left?Sn.active:""}`,onClick:()=>j({wallConfig:{left:!0,right:!1},gapConfig:{left:2,right:20}}),children:r("furniture.left")}),l.jsx("button",{className:`${Sn.toggleButton} ${(K=m.wallConfig)!=null&&K.right?Sn.active:""}`,onClick:()=>j({wallConfig:{left:!1,right:!0},gapConfig:{left:20,right:2}}),children:r("furniture.right")})]})]}),l.jsxs("div",{className:Sn.compactSection,children:[l.jsx("label",{className:Sn.compactLabel,children:r("space.title")}),l.jsxs("div",{className:Sn.sizeInputs,children:[l.jsx("span",{className:Sn.sizeLabel,children:"W"}),l.jsx(L$,{spaceInfo:m,onUpdate:j}),l.jsx("span",{className:Sn.sizeLabel,children:"H"}),l.jsx(M$,{spaceInfo:m,onUpdate:j})]})]}),l.jsxs("div",{className:Sn.compactSection,children:[l.jsx("label",{className:Sn.compactLabel,children:r("space.droppedCeiling")}),l.jsxs("div",{className:Sn.toggleButtonsWide,children:[l.jsx("button",{className:`${Sn.toggleButton} ${(P=m.droppedCeiling)!=null&&P.enabled?"":Sn.active}`,onClick:()=>j({droppedCeiling:{...m.droppedCeiling,enabled:!1}}),children:r("common.none")}),l.jsx("button",{className:`${Sn.toggleButton} ${(M=m.droppedCeiling)!=null&&M.enabled?Sn.active:""}`,onClick:()=>{var ne,he,xe;return j({droppedCeiling:{enabled:!0,position:((ne=m.droppedCeiling)==null?void 0:ne.position)||"left",width:((he=m.droppedCeiling)==null?void 0:he.width)||DEFAULT_DROPPED_CEILING_VALUES.WIDTH,dropHeight:((xe=m.droppedCeiling)==null?void 0:xe.dropHeight)||300}})},children:r("common.enabled")})]})]}),((X=m.droppedCeiling)==null?void 0:X.enabled)&&l.jsxs("div",{className:Sn.compactSection,children:[l.jsx("label",{className:Sn.compactLabel,children:r("placement.placementType")}),l.jsxs("div",{className:Sn.toggleButtonsWide,children:[l.jsx("button",{className:`${Sn.toggleButton} ${((Z=m.droppedCeiling)==null?void 0:Z.position)==="left"?Sn.active:""}`,onClick:()=>j({droppedCeiling:{...m.droppedCeiling,position:"left"}}),children:r("furniture.left")}),l.jsx("button",{className:`${Sn.toggleButton} ${((Q=m.droppedCeiling)==null?void 0:Q.position)==="right"?Sn.active:""}`,onClick:()=>j({droppedCeiling:{...m.droppedCeiling,position:"right"}}),children:r("furniture.right")})]})]}),l.jsxs("div",{className:Sn.compactSection,children:[l.jsx("label",{className:Sn.compactLabel,children:((U=m.droppedCeiling)!=null&&U.enabled,r("space.columnCount"))}),(()=>{var Be,Ye,$e;const ne=kr(m);let he=ne.width;if((Be=m.droppedCeiling)!=null&&Be.enabled){const ot=m.droppedCeiling.width||DEFAULT_DROPPED_CEILING_VALUES.WIDTH;he=ne.width-ot}const xe=wr.getColumnLimits(he);xe.maxColumns;const Te=(Ye=m.droppedCeiling)!=null&&Ye.enabled?m.mainDoorCount||m.customColumnCount||xe.minColumns:m.customColumnCount||xe.minColumns,Ce=Math.max(xe.minColumns,Math.min(xe.maxColumns,Te));return Ce!==Te&&(($e=m.droppedCeiling)!=null&&$e.enabled?j({mainDoorCount:Ce}):j({customColumnCount:Ce})),l.jsxs(l.Fragment,{children:[l.jsx("input",{type:"range",min:xe.minColumns,max:xe.maxColumns,value:Ce,onChange:ot=>{var Ve;const rt=parseInt(ot.target.value);(Ve=m.droppedCeiling)!=null&&Ve.enabled?j({mainDoorCount:rt}):j({customColumnCount:rt})},className:Sn.rangeInput}),l.jsx("span",{className:Sn.rangeValue,children:Ce})]})})()]}),((z=m.droppedCeiling)==null?void 0:z.enabled)&&l.jsxs("div",{className:Sn.compactSection,children:[l.jsx("label",{className:Sn.compactLabel,children:r("space.droppedColumnCount")}),(()=>{const ne=m.droppedCeiling.width||DEFAULT_DROPPED_CEILING_VALUES.WIDTH,he=m.surroundType==="surround"?50:0,xe=ne-he,Te=wr.getColumnLimits(xe),Ce=m.droppedCeilingDoorCount||Te.minColumns,Be=Math.max(Te.minColumns,Math.min(Te.maxColumns,Ce));return l.jsxs(l.Fragment,{children:[l.jsx("input",{type:"range",min:Te.minColumns,max:Te.maxColumns,value:Be,onChange:Ye=>j({droppedCeilingDoorCount:parseInt(Ye.target.value)}),className:Sn.rangeInput}),l.jsx("span",{className:Sn.rangeValue,children:Be})]})})()]}),l.jsx("div",{className:Sn.divider}),l.jsxs("div",{className:Sn.compactSection,children:[l.jsx("label",{className:Sn.compactLabel,children:"프레임 설정"}),l.jsxs("div",{className:Sn.toggleButtonsWide,children:[l.jsx("button",{className:`${Sn.toggleButton} ${m.surroundType==="surround"?Sn.active:""}`,onClick:()=>j({surroundType:"surround",frameSize:m.frameSize||{left:50,right:50,top:10}}),children:r("space.surround")}),l.jsx("button",{className:`${Sn.toggleButton} ${m.surroundType==="no-surround"?Sn.active:""}`,onClick:()=>{var ne,he;return j({surroundType:"no-surround",frameSize:{left:0,right:0,top:0},gapConfig:{left:m.installType==="builtin"||m.installType==="semistanding"&&((ne=m.wallConfig)!=null&&ne.left)?2:20,right:m.installType==="builtin"||m.installType==="semistanding"&&((he=m.wallConfig)!=null&&he.right)?2:20}})},children:r("space.noSurround")})]})]}),m.surroundType==="surround"&&l.jsxs("div",{className:Sn.compactSection,children:[l.jsx("label",{className:Sn.compactLabel,children:"프레임 두께"}),l.jsx("div",{className:Sn.sizeInputs,children:l.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:[l.jsx("span",{className:Sn.labelText,children:"좌"}),l.jsx("input",{type:"number",className:Sn.numberInput,value:((q=m.frameSize)==null?void 0:q.left)||50,onChange:ne=>j({frameSize:{...m.frameSize,left:parseInt(ne.target.value)||50}}),min:"40",max:"100"}),l.jsx("span",{className:Sn.labelText,children:"우"}),l.jsx("input",{type:"number",className:Sn.numberInput,value:((G=m.frameSize)==null?void 0:G.right)||50,onChange:ne=>j({frameSize:{...m.frameSize,right:parseInt(ne.target.value)||50}}),min:"40",max:"100"}),l.jsx("span",{className:Sn.labelText,children:"상"}),l.jsx("input",{type:"number",className:Sn.numberInput,value:((ie=m.frameSize)==null?void 0:ie.top)||10,onChange:ne=>j({frameSize:{...m.frameSize,top:parseInt(ne.target.value)||10}}),min:"10",max:"200"}),l.jsx("span",{className:Sn.unitText,children:"mm"})]})})]}),m.surroundType==="no-surround"&&l.jsxs("div",{className:Sn.compactSection,children:[l.jsx("label",{className:Sn.compactLabel,children:"이격거리"}),l.jsx("div",{className:Sn.sizeInputs,children:l.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:[l.jsx("span",{className:Sn.labelText,children:"좌"}),l.jsx("input",{type:"number",className:Sn.inputField,value:((H=m.gapConfig)==null?void 0:H.left)||2,onChange:ne=>j({gapConfig:{...m.gapConfig,left:parseInt(ne.target.value)||2}}),min:"2",max:"50",disabled:m.installType==="builtin"||m.installType==="semistanding"&&((se=m.wallConfig)==null?void 0:se.left)}),l.jsx("span",{className:Sn.labelText,children:"우"}),l.jsx("input",{type:"number",className:Sn.inputField,value:((te=m.gapConfig)==null?void 0:te.right)||2,onChange:ne=>j({gapConfig:{...m.gapConfig,right:parseInt(ne.target.value)||2}}),min:"2",max:"50",disabled:m.installType==="builtin"||m.installType==="semistanding"&&((fe=m.wallConfig)==null?void 0:fe.right)}),l.jsx("span",{className:Sn.unitText,children:"mm"})]})})]}),l.jsxs("div",{className:Sn.compactSection,children:[l.jsx("label",{className:Sn.compactLabel,children:"배치 설정"}),l.jsxs("div",{className:Sn.toggleButtonsWide,children:[l.jsx("button",{className:`${Sn.toggleButton} ${((ye=m.baseConfig)==null?void 0:ye.type)==="floor"||!m.baseConfig?Sn.active:""}`,onClick:()=>{var ne;return j({baseConfig:{...m.baseConfig,type:"floor",height:((ne=m.baseConfig)==null?void 0:ne.height)||65,placementType:"ground"}})},children:"바닥에 배치"}),l.jsx("button",{className:`${Sn.toggleButton} ${((be=m.baseConfig)==null?void 0:be.type)==="stand"?Sn.active:""}`,onClick:()=>{var ne;return j({baseConfig:{...m.baseConfig,type:"stand",placementType:"float",floatHeight:((ne=m.baseConfig)==null?void 0:ne.floatHeight)||200}})},children:"띄워서 배치"})]})]}),(((_e=m.baseConfig)==null?void 0:_e.type)==="floor"||!m.baseConfig)&&l.jsxs("div",{className:Sn.compactSection,children:[l.jsx("label",{className:Sn.compactLabel,children:"높이"}),l.jsxs("div",{className:Sn.sizeInputs,children:[l.jsx("input",{type:"number",className:Sn.wideInputField,value:((W=m.baseConfig)==null?void 0:W.height)||65,onChange:ne=>j({baseConfig:{...m.baseConfig,type:"floor",height:parseInt(ne.target.value)||65}}),min:"50",max:"500"}),l.jsx("span",{className:Sn.unitText,children:"mm"})]})]}),((Y=m.baseConfig)==null?void 0:Y.type)==="stand"&&l.jsxs("div",{className:Sn.compactSection,children:[l.jsx("label",{className:Sn.compactLabel,children:"높이"}),l.jsxs("div",{className:Sn.sizeInputs,children:[l.jsx("input",{type:"number",className:Sn.wideInputField,value:((ve=m.baseConfig)==null?void 0:ve.floatHeight)||200,onChange:ne=>j({baseConfig:{...m.baseConfig,type:"stand",placementType:"float",floatHeight:parseInt(ne.target.value)||200}}),min:"100",max:"500"}),l.jsx("span",{className:Sn.unitText,children:"mm"})]})]}),l.jsxs("div",{className:Sn.compactSection,children:[l.jsx("label",{className:Sn.compactLabel,children:"바닥 마감재"}),l.jsxs("div",{className:Sn.toggleButtonsWide,children:[l.jsx("button",{className:`${Sn.toggleButton} ${m.hasFloorFinish?Sn.active:""}`,onClick:()=>j({hasFloorFinish:!0,floorFinish:m.floorFinish||{height:10}}),children:r("common.enabled")}),l.jsx("button",{className:`${Sn.toggleButton} ${m.hasFloorFinish?"":Sn.active}`,onClick:()=>j({hasFloorFinish:!1}),children:r("common.none")})]})]}),m.hasFloorFinish&&l.jsxs("div",{className:Sn.compactSection,children:[l.jsx("label",{className:Sn.compactLabel,children:"마감재 두께"}),l.jsxs("div",{className:Sn.sizeInputs,children:[l.jsx("input",{type:"number",className:Sn.wideInputField,value:((ce=m.floorFinish)==null?void 0:ce.height)||10,onChange:ne=>j({floorFinish:{height:parseInt(ne.target.value)||10}}),min:"5",max:"50"}),l.jsx("span",{className:Sn.unitText,children:"mm"})]})]})]})})]}),l.jsxs("div",{className:Sn.footer,children:[l.jsx("button",{className:Sn.previousButton,onClick:n,children:"이전"}),l.jsx("button",{className:`${Sn.confirmButton} ${T?"":Sn.disabled}`,onClick:D,disabled:!T||o,children:"시작하기"})]})]})]})},ede="_stepContainer_39rqh_2",tde={stepContainer:ede},nde=({onClose:n,projectId:e,projectTitle:t})=>{const[i,r]=O.useState(1),[s,o]=Y6(),{projectId:a}=Ha();O.useEffect(()=>{a&&i===2&&(s.set("projectId",a),o(s))},[a,i]);const c=()=>{i<2&&r(f=>f+1)},h=()=>{i>1&&r(f=>f-1)},u=()=>{n&&n()},d=()=>{switch(i){case 1:return l.jsx(Ile,{onNext:c,onClose:u,projectId:e,projectTitle:t});case 2:return l.jsx(Jue,{onPrevious:h,onClose:u,projectId:a||e,projectTitle:t});default:return null}};return l.jsx("div",{className:tde.stepContainer,children:d()})},ide="_loadingScreen_153kc_229",rde="_loadingSubtext_153kc_243",qj={loadingScreen:ide,loadingSubtext:rde},sE=({onClose:n,projectId:e,projectTitle:t})=>{const i=xc(),[r]=Y6(),[s,o]=O.useState(!1),{setBasicInfo:a,resetAll:c}=Ha(),{setSpaceInfo:h,resetAll:u}=qi(),{clearAllModules:d,setPlacedModules:f}=ci(),A=async p=>{o(!0);try{const{project:y,error:v}=await wy(p);if(v){console.error("프로젝트 로드 에러:",v),alert("프로젝트를 불러오는데 실패했습니다: "+v),i("/dashboard");return}y&&(a(y.projectData),h(y.spaceConfig),f(y.furniture.placedModules),console.log("✅ 프로젝트 로드 성공:",y.title))}catch(y){console.error("프로젝트 로드 실패:",y),alert("프로젝트 로드 중 오류가 발생했습니다."),i("/dashboard")}finally{o(!1)}};if(O.useEffect(()=>{const p=r.get("projectId");p?A(p):(c(),u(),d())},[]),s)return l.jsxs("div",{className:qj.loadingScreen,children:[l.jsx(Gm,{message:"프로젝트를 불러오는 중...",size:"large",type:"spinner"}),l.jsx("p",{className:qj.loadingSubtext,children:"잠시만 기다려주세요."})]});const g=()=>{n?n():i("/dashboard")};return l.jsx("div",{"data-theme":"light",style:{colorScheme:"light"},children:l.jsx(nde,{onClose:g,projectId:e,projectTitle:t})})},sde=({setPlacedModules:n})=>{const[e,t]=O.useState(!1),i=O.useCallback((r,s)=>{console.log("🚨 [SPACE ADAPTER] updateFurnitureForNewSpace 호출됨:",{oldWidth:r.width,newWidth:s.width,oldHeight:r.height,newHeight:s.height,oldDepth:r.depth,newDepth:s.depth,oldColumnCount:r.customColumnCount,newColumnCount:s.customColumnCount}),console.trace("🚨 [TRACE] updateFurnitureForNewSpace 호출 스택"),n(o=>{var d,f;if(o.length===0)return o;const a=ur(r),c=ur(s);r.installType==="semistanding"&&s.installType==="semistanding"&&r.width===s.width&&((d=r.wallConfig)==null?void 0:d.left)!==((f=s.wallConfig)==null?void 0:f.left)&&a.columnWidth===c.columnWidth&&console.log("🔄 세미스탠딩 벽 위치만 변경됨 - 가구 너비는 유지하되 위치는 재계산 필요"),(a.columnCount!==c.columnCount||a.columnWidth!==c.columnWidth)&&console.log(`🔄 컬럼 변경: ${a.columnCount}개(${a.columnWidth}mm) → ${c.columnCount}개(${c.columnWidth}mm)`);const u=[];return o.forEach(A=>{var _,I,S,F,B;if(A.zone&&((_=s.droppedCeiling)!=null&&_.enabled)){console.log("🔍 Zone 가구 처리 시작:",{moduleId:A.moduleId,zone:A.zone,customWidth:A.customWidth,isDualSlot:A.isDualSlot});const E=wr.calculateZoneSlotInfo(s,s.customColumnCount);if(!E.dropped&&A.zone==="dropped")return;const V=A.zone==="dropped"&&E.dropped?E.dropped:E.normal,K={...s,width:V.width,customColumnCount:V.columnCount},P={...kr(s),width:V.width,startX:V.startX};if(!Hi(A.moduleId,P,K)){u.push({...A,isValidInCurrentSpace:!1});return}const X=A.slotIndex||0;if(X>=V.columnCount){u.push({...A,isValidInCurrentSpace:!1});return}const Z=A.moduleId.startsWith("dual-"),Q=V.startX+X*V.columnWidth+(Z?V.columnWidth:V.columnWidth/2),U=A.moduleId.replace(/-\d+$/,""),z=`${U}-${V.columnWidth*(Z?2:1)}`;console.log("🔄 Zone 가구 업데이트:",{originalModuleId:A.moduleId,baseType:U,isDual:Z,zone:A.zone,targetZone:V,slotIndex:X,newX:Q*.01,newModuleId:z,oldWidth:A.customWidth||A.adjustedWidth,newWidth:V.columnWidth*(Z?2:1),targetZoneSlotWidths:V.slotWidths}),u.push({...A,moduleId:z,position:{...A.position,x:Q*.01},isValidInCurrentSpace:!0,adjustedWidth:void 0,customWidth:void 0,isDualSlot:Z});return}const g=kr(r),p=Hi(A.moduleId,g,r);let y=A.slotIndex;if(y===void 0&&p){const E=Math.abs(p.dimensions.width-a.columnWidth*2)<50;y=yoe(A.position,a,E)}if(y===void 0||y<0){u.push({...A,isValidInCurrentSpace:!1});return}let v=A.moduleId,m=!1;const w=[/^dual-([^-]+(?:-[^-]+)*)-(\d+)$/];for(const E of w){const V=A.moduleId.match(E);if(V){const K=parseInt(V[2]);if(Math.abs(K-a.columnWidth*2)<50){v=A.moduleId.replace(E,`dual-$1-${c.columnWidth*2}`),m=!0;break}}}if(!m){const E=[/^single-([^-]+(?:-[^-]+)*)-(\d+)$/];let V=!1;for(const K of E)if(A.moduleId.match(K)){v=A.moduleId.replace(K,`single-$1-${c.columnWidth}`),V=!0;break}V||(v=`single-open-${c.columnWidth}`)}if(y>=c.columnCount){const E=c.columnCount-(m?2:1);if(E>=0)y=E;else{u.push({...A,isValidInCurrentSpace:!1});return}}let x=c.columnCount;if(A.zone&&((I=s.droppedCeiling)!=null&&I.enabled)){const E=wr.calculateZoneSlotInfo(s,s.customColumnCount);A.zone==="dropped"&&E.dropped?x=E.dropped.columnCount:A.zone==="normal"&&(x=E.normal.columnCount)}if(m&&y+1>=x&&(v=v.replace(/^dual-/,"single-").replace(/-(\d+)$/,`-${c.columnWidth}`),m=!1),!sv(y,m,u,s,A.moduleId,A.id)){let E=Wp(y,"right",m,u,s,A.moduleId,A.id);if(E===null&&(E=Wp(y,"left",m,u,s,A.moduleId,A.id)),E!==null)y=E;else{u.push({...A,isValidInCurrentSpace:!1});return}}let T,j="normal",D;if((S=s.droppedCeiling)!=null&&S.enabled&&c.zones){const E=c.threeUnitPositions[y]*1e3,V=wr.findZoneAndSlotFromPosition({x:E},s,c);if(V){j=V.zone;const K=j==="dropped"&&c.zones.dropped?c.zones.dropped:c.zones.normal;T=(K.startX+V.slotIndex*K.columnWidth+K.columnWidth/2)*.001,j==="dropped"&&(D=K.columnWidth)}else T=m&&c.threeUnitDualPositions?c.threeUnitDualPositions[y]:c.threeUnitPositions[y]}else if(m&&c.threeUnitDualPositions){if(T=c.threeUnitDualPositions[y],s.surroundType==="no-surround"){const E=y===c.columnCount-2;y===0&&(s.installType==="freestanding"||s.installType==="semistanding"&&((F=s.wallConfig)!=null&&F.right))?console.log("🔄 듀얼 가구 첫번째 슬롯 (공간 변경) - FurnitureItem에서 엔드패널 조정 예정"):E&&(s.installType==="freestanding"||s.installType==="semistanding"&&((B=s.wallConfig)!=null&&B.left))&&console.log("🔄 듀얼 가구 마지막 슬롯 (공간 변경) - FurnitureItem에서 엔드패널 조정 예정")}console.log("🔄 듀얼 가구 위치 (공간 변경):",{slotIndex:y,newX:T,surroundType:s.surroundType,installType:s.installType,wallConfig:s.wallConfig,설명:"기본 경계 위치 사용 (FurnitureItem에서 엔드패널 조정 적용)"})}else T=c.threeUnitPositions[y];let b;c.slotWidths&&c.slotWidths[y]!==void 0?m&&y+1<c.slotWidths.length?b=c.slotWidths[y]+c.slotWidths[y+1]:b=c.slotWidths[y]:j==="dropped"&&D&&(b=D),u.push({...A,moduleId:v,position:{...A.position,x:T},slotIndex:y,isDualSlot:v.includes("dual"),isValidInCurrentSpace:!0,zone:j,customWidth:b,adjustedWidth:void 0})}),u})},[n]);return{spaceChangeMode:e,setSpaceChangeMode:t,updateFurnitureForNewSpace:i}};function ode(n){const e=Math.sqrt(Math.pow(n,2)+Math.pow(n,2))/2;return-(n-Math.sqrt(Math.pow(n,2)-Math.pow(e,2)))/e}function wt(n,e,t){return{x:n??0,y:e??0,z:t??0}}function To(n,e){return{x:n??0,y:e??0}}let bd=class Gb{static next(){return(++Gb.seed).toString(16).toUpperCase()}static peek(){return(Gb.seed+1).toString(16).toUpperCase()}static clear(){Gb.seed=0}};bd.seed=0;let ade=class{constructor(){this.handle=bd.next()}dxfy(e){e.type("ENDBLK"),e.handle(this.handle),e.push(330,this.ownerObjectHandle),e.subclassMarker("AcDbEntity"),e.layerName("0"),e.subclassMarker("AcDbBlockEnd")}};const nx=(n,e)=>({tl:n,br:e});let No=class oE{static centerRadiusBBox(e,t){return nx(wt(e.x-t,e.y+t),wt(e.x+t,e.y-t))}static pointBBox(e){return nx(wt(e.x-100,e.y+100),wt(e.x+100,e.y-100))}static lineBBox(e,t){const i=e.x>t.x?e.x:t.x,r=e.x<t.x?e.x:t.x,s=e.y>t.y?e.y:t.y,o=e.y<t.y?e.y:t.y,a=e.z>t.z?e.z:t.z,c=e.z<t.z?e.z:t.z;return nx(wt(r,s,c),wt(i,o,a))}static verticesBBox(e){let t=-1/0,i=-1/0,r=1/0,s=1/0;for(let o=0;o<e.length;o++){const{x:a,y:c}=e[o];t<a&&(t=a),i<c&&(i=c),r>a&&(r=a),s>c&&(s=c)}return nx(wt(r,i),wt(t,s))}static boundingBox(e){if(e.length===0)return oE.pointBBox(wt());const t=[];for(let i=0;i<e.length;i++){const r=e[i];t.push(r.tl,r.br)}return oE.verticesBBox(t)}static boundingBoxCenter(e){return wt(e.tl.x+(e.br.x-e.tl.x)/2,e.br.y+(e.tl.y-e.br.y)/2,0)}static boundingBoxHeight(e){return e.tl.y-e.br.y}};var V_,aE,lE;(function(n){n[n.None=0]="None",n[n.Frozen=1]="Frozen",n[n.FrozenInNewViewports=2]="FrozenInNewViewports",n[n.Locked=4]="Locked",n[n.XRefDependent=16]="XRefDependent",n[n.XRefResolved=32]="XRefResolved"})(V_||(V_={})),(function(n){n[n.None=0]="None",n[n.DescribeShape=1]="DescribeShape",n[n.VerticalText=4]="VerticalText",n[n.XRefDependent=16]="XRefDependent",n[n.XRefResolved=32]="XRefResolved"})(aE||(aE={})),(function(n){n[n.None=0]="None",n[n.PaperSpace=1]="PaperSpace",n[n.XRefDependent=16]="XRefDependent",n[n.XRefResolved=32]="XRefResolved"})(lE||(lE={}));let tp=class{constructor(e){this.type=e,this.handle=bd.next()}dxfy(e){e.type(this.type),e.handle(this.handle),e.push(330,this.ownerObjectHandle),e.subclassMarker("AcDbSymbolTableRecord")}},rm=class extends tp{constructor(e,t,i,r){super("LAYER"),this.name=e,this.colorNumber=t,this.lineType=i,this.flags=r??V_.None}dxfy(e){super.dxfy(e),e.subclassMarker("AcDbLayerTableRecord"),e.name(this.name),e.push(70,this.flags),e.colorNumber(this.colorNumber),e.push(420,this.trueColor),e.lineType(this.lineType),e.push(370,0),e.push(390,0),e.push(347,this.materialObject)}};rm.layerZeroName="0";const lde=[[["00","00","00"],0,["0","0","0"]],[["FF","00","00"],1,["255","0","0"]],[["FF","FF","00"],2,["255","255","0"]],[["00","FF","00"],3,["0","255","0"]],[["00","FF","FF"],4,["0","255","255"]],[["00","00","FF"],5,["0","0","255"]],[["FF","00","FF"],6,["255","0","255"]],[["FF","FF","FF"],7,["255","255","255"]],[["41","41","41"],8,["65","65","65"]],[["80","80","80"],9,["128","128","128"]],[["FF","00","00"],10,["255","0","0"]],[["FF","AA","AA"],11,["255","170","170"]],[["BD","00","00"],12,["189","0","0"]],[["BD","7E","7E"],13,["189","126","126"]],[["81","00","00"],14,["129","0","0"]],[["81","56","56"],15,["129","86","86"]],[["68","00","00"],16,["104","0","0"]],[["68","45","45"],17,["104","69","69"]],[["4F","00","00"],18,["79","0","0"]],[["4F","35","35"],19,["79","53","53"]],[["FF","3F","00"],20,["255","63","0"]],[["FF","BF","AA"],21,["255","191","170"]],[["BD","2E","00"],22,["189","46","0"]],[["BD","8D","7E"],23,["189","141","126"]],[["81","1F","00"],24,["129","31","0"]],[["81","60","56"],25,["129","96","86"]],[["68","19","00"],26,["104","25","0"]],[["68","4E","45"],27,["104","78","69"]],[["4F","13","00"],28,["79","19","0"]],[["4F","3B","35"],29,["79","59","53"]],[["FF","7F","00"],30,["255","127","0"]],[["FF","D4","AA"],31,["255","212","170"]],[["BD","5E","00"],32,["189","94","0"]],[["BD","9D","7E"],33,["189","157","126"]],[["81","40","00"],34,["129","64","0"]],[["81","6B","56"],35,["129","107","86"]],[["68","34","00"],36,["104","52","0"]],[["68","56","45"],37,["104","86","69"]],[["4F","27","00"],38,["79","39","0"]],[["4F","42","35"],39,["79","66","53"]],[["FF","BF","00"],40,["255","191","0"]],[["FF","EA","AA"],41,["255","234","170"]],[["BD","8D","00"],42,["189","141","0"]],[["BD","AD","7E"],43,["189","173","126"]],[["81","60","00"],44,["129","96","0"]],[["81","76","56"],45,["129","118","86"]],[["68","4E","00"],46,["104","78","0"]],[["68","5F","45"],47,["104","95","69"]],[["4F","3B","00"],48,["79","59","0"]],[["4F","49","35"],49,["79","73","53"]],[["FF","FF","00"],50,["255","255","0"]],[["FF","FF","AA"],51,["255","255","170"]],[["BD","BD","00"],52,["189","189","0"]],[["BD","BD","7E"],53,["189","189","126"]],[["81","81","00"],54,["129","129","0"]],[["81","81","56"],55,["129","129","86"]],[["68","68","00"],56,["104","104","0"]],[["68","68","45"],57,["104","104","69"]],[["4F","4F","00"],58,["79","79","0"]],[["4F","4F","35"],59,["79","79","53"]],[["BF","FF","00"],60,["191","255","0"]],[["EA","FF","AA"],61,["234","255","170"]],[["8D","BD","00"],62,["141","189","0"]],[["AD","BD","7E"],63,["173","189","126"]],[["60","81","00"],64,["96","129","0"]],[["76","81","56"],65,["118","129","86"]],[["4E","68","00"],66,["78","104","0"]],[["5F","68","45"],67,["95","104","69"]],[["3B","4F","00"],68,["59","79","0"]],[["49","4F","35"],69,["73","79","53"]],[["7F","FF","00"],70,["127","255","0"]],[["D4","FF","AA"],71,["212","255","170"]],[["5E","BD","00"],72,["94","189","0"]],[["9D","BD","7E"],73,["157","189","126"]],[["40","81","00"],74,["64","129","0"]],[["6B","81","56"],75,["107","129","86"]],[["34","68","00"],76,["52","104","0"]],[["56","68","45"],77,["86","104","69"]],[["27","4F","00"],78,["39","79","0"]],[["42","4F","35"],79,["66","79","53"]],[["3F","FF","00"],80,["63","255","0"]],[["BF","FF","AA"],81,["191","255","170"]],[["2E","BD","00"],82,["46","189","0"]],[["8D","BD","7E"],83,["141","189","126"]],[["1F","81","00"],84,["31","129","0"]],[["60","81","56"],85,["96","129","86"]],[["19","68","00"],86,["25","104","0"]],[["4E","68","45"],87,["78","104","69"]],[["13","4F","00"],88,["19","79","0"]],[["3B","4F","35"],89,["59","79","53"]],[["00","FF","00"],90,["0","255","0"]],[["AA","FF","AA"],91,["170","255","170"]],[["00","BD","00"],92,["0","189","0"]],[["7E","BD","7E"],93,["126","189","126"]],[["00","81","00"],94,["0","129","0"]],[["56","81","56"],95,["86","129","86"]],[["00","68","00"],96,["0","104","0"]],[["45","68","45"],97,["69","104","69"]],[["00","4F","00"],98,["0","79","0"]],[["35","4F","35"],99,["53","79","53"]],[["00","FF","3F"],100,["0","255","63"]],[["AA","FF","BF"],101,["170","255","191"]],[["00","BD","2E"],102,["0","189","46"]],[["7E","BD","8D"],103,["126","189","141"]],[["00","81","1F"],104,["0","129","31"]],[["56","81","60"],105,["86","129","96"]],[["00","68","19"],106,["0","104","25"]],[["45","68","4E"],107,["69","104","78"]],[["00","4F","13"],108,["0","79","19"]],[["35","4F","3B"],109,["53","79","59"]],[["00","FF","7F"],110,["0","255","127"]],[["AA","FF","D4"],111,["170","255","212"]],[["00","BD","5E"],112,["0","189","94"]],[["7E","BD","9D"],113,["126","189","157"]],[["00","81","40"],114,["0","129","64"]],[["56","81","6B"],115,["86","129","107"]],[["00","68","34"],116,["0","104","52"]],[["45","68","56"],117,["69","104","86"]],[["00","4F","27"],118,["0","79","39"]],[["35","4F","42"],119,["53","79","66"]],[["00","FF","BF"],120,["0","255","191"]],[["AA","FF","EA"],121,["170","255","234"]],[["00","BD","8D"],122,["0","189","141"]],[["7E","BD","AD"],123,["126","189","173"]],[["00","81","60"],124,["0","129","96"]],[["56","81","76"],125,["86","129","118"]],[["00","68","4E"],126,["0","104","78"]],[["45","68","5F"],127,["69","104","95"]],[["00","4F","3B"],128,["0","79","59"]],[["35","4F","49"],129,["53","79","73"]],[["00","FF","FF"],130,["0","255","255"]],[["AA","FF","FF"],131,["170","255","255"]],[["00","BD","BD"],132,["0","189","189"]],[["7E","BD","BD"],133,["126","189","189"]],[["00","81","81"],134,["0","129","129"]],[["56","81","81"],135,["86","129","129"]],[["00","68","68"],136,["0","104","104"]],[["45","68","68"],137,["69","104","104"]],[["00","4F","4F"],138,["0","79","79"]],[["35","4F","4F"],139,["53","79","79"]],[["00","BF","FF"],140,["0","191","255"]],[["AA","EA","FF"],141,["170","234","255"]],[["00","8D","BD"],142,["0","141","189"]],[["7E","AD","BD"],143,["126","173","189"]],[["00","60","81"],144,["0","96","129"]],[["56","76","81"],145,["86","118","129"]],[["00","4E","68"],146,["0","78","104"]],[["45","5F","68"],147,["69","95","104"]],[["00","3B","4F"],148,["0","59","79"]],[["35","49","4F"],149,["53","73","79"]],[["00","7F","FF"],150,["0","127","255"]],[["AA","D4","FF"],151,["170","212","255"]],[["00","5E","BD"],152,["0","94","189"]],[["7E","9D","BD"],153,["126","157","189"]],[["00","40","81"],154,["0","64","129"]],[["56","6B","81"],155,["86","107","129"]],[["00","34","68"],156,["0","52","104"]],[["45","56","68"],157,["69","86","104"]],[["00","27","4F"],158,["0","39","79"]],[["35","42","4F"],159,["53","66","79"]],[["00","3F","FF"],160,["0","63","255"]],[["AA","BF","FF"],161,["170","191","255"]],[["00","2E","BD"],162,["0","46","189"]],[["7E","8D","BD"],163,["126","141","189"]],[["00","1F","81"],164,["0","31","129"]],[["56","60","81"],165,["86","96","129"]],[["00","19","68"],166,["0","25","104"]],[["45","4E","68"],167,["69","78","104"]],[["00","13","4F"],168,["0","19","79"]],[["35","3B","4F"],169,["53","59","79"]],[["00","00","FF"],170,["0","0","255"]],[["AA","AA","FF"],171,["170","170","255"]],[["00","00","BD"],172,["0","0","189"]],[["7E","7E","BD"],173,["126","126","189"]],[["00","00","81"],174,["0","0","129"]],[["56","56","81"],175,["86","86","129"]],[["00","00","68"],176,["0","0","104"]],[["45","45","68"],177,["69","69","104"]],[["00","00","4F"],178,["0","0","79"]],[["35","35","4F"],179,["53","53","79"]],[["3F","00","FF"],180,["63","0","255"]],[["BF","AA","FF"],181,["191","170","255"]],[["2E","00","BD"],182,["46","0","189"]],[["8D","7E","BD"],183,["141","126","189"]],[["1F","00","81"],184,["31","0","129"]],[["60","56","81"],185,["96","86","129"]],[["19","00","68"],186,["25","0","104"]],[["4E","45","68"],187,["78","69","104"]],[["13","00","4F"],188,["19","0","79"]],[["3B","35","4F"],189,["59","53","79"]],[["7F","00","FF"],190,["127","0","255"]],[["D4","AA","FF"],191,["212","170","255"]],[["5E","00","BD"],192,["94","0","189"]],[["9D","7E","BD"],193,["157","126","189"]],[["40","00","81"],194,["64","0","129"]],[["6B","56","81"],195,["107","86","129"]],[["34","00","68"],196,["52","0","104"]],[["56","45","68"],197,["86","69","104"]],[["27","00","4F"],198,["39","0","79"]],[["42","35","4F"],199,["66","53","79"]],[["BF","00","FF"],200,["191","0","255"]],[["EA","AA","FF"],201,["234","170","255"]],[["8D","00","BD"],202,["141","0","189"]],[["AD","7E","BD"],203,["173","126","189"]],[["60","00","81"],204,["96","0","129"]],[["76","56","81"],205,["118","86","129"]],[["4E","00","68"],206,["78","0","104"]],[["5F","45","68"],207,["95","69","104"]],[["3B","00","4F"],208,["59","0","79"]],[["49","35","4F"],209,["73","53","79"]],[["FF","00","FF"],210,["255","0","255"]],[["FF","AA","FF"],211,["255","170","255"]],[["BD","00","BD"],212,["189","0","189"]],[["BD","7E","BD"],213,["189","126","189"]],[["81","00","81"],214,["129","0","129"]],[["81","56","81"],215,["129","86","129"]],[["68","00","68"],216,["104","0","104"]],[["68","45","68"],217,["104","69","104"]],[["4F","00","4F"],218,["79","0","79"]],[["4F","35","4F"],219,["79","53","79"]],[["FF","00","BF"],220,["255","0","191"]],[["FF","AA","EA"],221,["255","170","234"]],[["BD","00","8D"],222,["189","0","141"]],[["BD","7E","AD"],223,["189","126","173"]],[["81","00","60"],224,["129","0","96"]],[["81","56","76"],225,["129","86","118"]],[["68","00","4E"],226,["104","0","78"]],[["68","45","5F"],227,["104","69","95"]],[["4F","00","3B"],228,["79","0","59"]],[["4F","35","49"],229,["79","53","73"]],[["FF","00","7F"],230,["255","0","127"]],[["FF","AA","D4"],231,["255","170","212"]],[["BD","00","5E"],232,["189","0","94"]],[["BD","7E","9D"],233,["189","126","157"]],[["81","00","40"],234,["129","0","64"]],[["81","56","6B"],235,["129","86","107"]],[["68","00","34"],236,["104","0","52"]],[["68","45","56"],237,["104","69","86"]],[["4F","00","27"],238,["79","0","39"]],[["4F","35","42"],239,["79","53","66"]],[["FF","00","3F"],240,["255","0","63"]],[["FF","AA","BF"],241,["255","170","191"]],[["BD","00","2E"],242,["189","0","46"]],[["BD","7E","8D"],243,["189","126","141"]],[["81","00","1F"],244,["129","0","31"]],[["81","56","60"],245,["129","86","96"]],[["68","00","19"],246,["104","0","25"]],[["68","45","4E"],247,["104","69","78"]],[["4F","00","13"],248,["79","0","19"]],[["4F","35","3B"],249,["79","53","59"]],[["33","33","33"],250,["51","51","51"]],[["50","50","50"],251,["80","80","80"]],[["69","69","69"],252,["105","105","105"]],[["82","82","82"],253,["130","130","130"]],[["BE","BE","BE"],254,["190","190","190"]],[["FF","FF","FF"],255,["255","255","255"]]];function Yj(n){let e="";const t=lde.find((i=>{const[,r]=i;return r===n}));if(t){const[i]=t,[r,s,o]=i;e=`${r}${s}${o}`}return e}let cde=class{constructor(e){this.name=e,this.tags=[]}add(e,t){this.tags.push({code:e,value:t})}dxfy(e){e.push(102,`{${this.name}`);for(const t of this.tags)e.push(t.code,t.value);e.push(102,"}")}},hde=class{constructor(){this.lines=[]}push(e,t){t!=null&&this.lines.push(e,t)}stringify(){return this.lines.join(`
`)}start(e){this.push(0,"SECTION"),this.push(2,e)}end(){this.push(0,"ENDSEC")}variableName(e){this.push(9,e)}type(e){this.push(0,e)}primaryText(e){this.push(1,e)}name(e,t=2){this.push(t,e)}handle(e){this.push(5,e)}lineType(e){this.push(6,e)}textStyle(e){this.push(7,e)}layerName(e){this.push(8,e)}point2d(e,t=0){this.push(10+t,e==null?void 0:e.x),this.push(20+t,e==null?void 0:e.y)}point3d(e,t=0){this.point2d(e,t),this.push(30+t,e==null?void 0:e.z)}elevation(e){this.push(38,e)}thickness(e){this.push(39,e)}visibilty(e){e!=null&&this.push(60,e?0:1)}colorNumber(e){this.push(62,e)}subclassMarker(e){this.push(100,e)}};var cE,z_,G_,Rs;function Os(n,e,t,i){if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(n):i?i.value:e.get(n)}function G2(n,e,t,i,r){if(typeof e=="function"?n!==e||!0:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(n,t),t}function Do(n,e){return{code:n,value:e}}function Zj(n,e=255){const t=[],i=[];for(let r=0;r<n.length;r++){const s=n[r];i.length===e||r===n.length-1?(t.push(i.join("")),i.length=0):i.push(s)}return t}(function(n){n[n.Red=1]="Red",n[n.Green=3]="Green",n[n.Cyan=4]="Cyan",n[n.Blue=5]="Blue",n[n.Magenta=6]="Magenta",n[n.White=7]="White",n[n.Black=0]="Black",n[n.Yellow=2]="Yellow"})(cE||(cE={})),(function(n){n[n.Unitless=0]="Unitless",n[n.Inches=1]="Inches",n[n.Feet=2]="Feet",n[n.Miles=3]="Miles",n[n.Millimeters=4]="Millimeters",n[n.Centimeters=5]="Centimeters",n[n.Meters=6]="Meters",n[n.Kilometers=7]="Kilometers",n[n.Microinches=8]="Microinches",n[n.Mils=9]="Mils",n[n.Yards=10]="Yards",n[n.Angstroms=11]="Angstroms",n[n.Nanometers=12]="Nanometers",n[n.Microns=13]="Microns",n[n.Decimeters=14]="Decimeters",n[n.Decameters=15]="Decameters",n[n.Hectometers=16]="Hectometers",n[n.Gigameters=17]="Gigameters",n[n.AstronomicalUnits=18]="AstronomicalUnits",n[n.LightYears=19]="LightYears",n[n.Parsecs=20]="Parsecs",n[n.USSurveyFeet=21]="USSurveyFeet",n[n.USSurveyInch=22]="USSurveyInch",n[n.USSurveyYard=23]="USSurveyYard",n[n.USSurveyMile=24]="USSurveyMile"})(z_||(z_={})),(function(n){n.Continuous="Continuous"})(G_||(G_={})),typeof SuppressedError=="function"&&SuppressedError;let ude=class{constructor(e){Rs.set(this,void 0),this.name=e,G2(this,Rs,[])}clear(){Os(this,Rs,"f").length=0}string(e){Zj(e).forEach((t=>Os(this,Rs,"f").push(Do(1e3,t))))}beginList(){Os(this,Rs,"f").push(Do(1002,"{"))}endList(){Os(this,Rs,"f").push(Do(1002,"}"))}layerName(e){Os(this,Rs,"f").push(Do(1003,e))}binaryData(e){Zj(e).forEach((t=>Os(this,Rs,"f").push(Do(1004,t))))}databaseHandle(e){Os(this,Rs,"f").push(Do(1005,e))}point(e){Os(this,Rs,"f").push(Do(1010,e.x)),Os(this,Rs,"f").push(Do(1020,e.y)),Os(this,Rs,"f").push(Do(1030,e.z))}position(e){Os(this,Rs,"f").push(Do(1011,e.x)),Os(this,Rs,"f").push(Do(1021,e.y)),Os(this,Rs,"f").push(Do(1031,e.z))}displacement(e){Os(this,Rs,"f").push(Do(1012,e.x)),Os(this,Rs,"f").push(Do(1022,e.y)),Os(this,Rs,"f").push(Do(1032,e.z))}direction(e){Os(this,Rs,"f").push(Do(1013,e.x)),Os(this,Rs,"f").push(Do(1023,e.y)),Os(this,Rs,"f").push(Do(1033,e.z))}real(e){Os(this,Rs,"f").push(Do(1040,e))}distance(e){Os(this,Rs,"f").push(Do(1041,e))}scale(e){Os(this,Rs,"f").push(Do(1042,e))}integer(e){Os(this,Rs,"f").push(Do(1070,e))}long(e){Os(this,Rs,"f").push(Do(1071,e))}dxfy(e){e.push(1001,this.name),e.push(1002,"{"),Os(this,Rs,"f").forEach((t=>e.push(t.code,t.value))),e.push(1002,"}")}};Rs=new WeakMap;let ei=class{set angle(e){this.patternsData.forEach((t=>t.lineAngle=e))}constructor(e){this.name=e,this.patternsData=[],this.scale=1}dxfy(e){e.push(78,this.patternsData.length);for(const t of this.patternsData){e.push(53,t.lineAngle),e.push(43,t.x),e.push(44,t.y),e.push(45,t.offsetX*this.scale),e.push(46,t.offsetY*this.scale),e.push(79,t.dashLengthItems.length);for(const i of t.dashLengthItems)e.push(49,i*this.scale)}}add(e){this.patternsData.push(e)}};const Jn=new Map,s3=new ei("ANGLE");s3.add({lineAngle:0,x:0,y:0,offsetX:.275,offsetY:.2,dashLengthItems:[-.075]}),s3.add({lineAngle:90,x:0,y:0,offsetX:.275,offsetY:.2,dashLengthItems:[-.075]}),Jn.set("ANGLE",s3);const Jj=new ei("ANSI31");Jj.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:1.25,dashLengthItems:[]}),Jn.set("ANSI31",Jj);const eP=new ei("ANSI32");eP.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),Jn.set("ANSI32",eP);const o3=new ei("ANSI33");o3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:9.525,dashLengthItems:[]}),o3.add({lineAngle:45,x:4.49013,y:0,offsetX:0,offsetY:9.525,dashLengthItems:[]}),Jn.set("ANSI33",o3);const a3=new ei("ANSI34");a3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[]}),a3.add({lineAngle:45,x:4.49013,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[3.175,-1.5875]}),Jn.set("ANSI34",a3);const P1=new ei("ANSI35");P1.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:19.05,dashLengthItems:[]}),P1.add({lineAngle:45,x:4.49013,y:0,offsetX:0,offsetY:19.05,dashLengthItems:[]}),P1.add({lineAngle:45,x:8.98026,y:0,offsetX:0,offsetY:19.05,dashLengthItems:[]}),P1.add({lineAngle:45,x:13.4704,y:0,offsetX:0,offsetY:19.05,dashLengthItems:[]}),Jn.set("ANSI35",P1);const l3=new ei("ANSI36");l3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[]}),l3.add({lineAngle:45,x:4.49013,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[7.9375,-1.5875,0,-1.5875]}),Jn.set("ANSI36",l3);const tP=new ei("ANSI37");tP.add({lineAngle:45,x:0,y:0,offsetX:5.55625,offsetY:3.175,dashLengthItems:[7.9375,-1.5875,0,-1.5875]}),Jn.set("ANSI37",tP);const c3=new ei("ANSI38");c3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),c3.add({lineAngle:135,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),Jn.set("ANSI38",c3);const h3=new ei("AR_B816");h3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),h3.add({lineAngle:135,x:0,y:0,offsetX:6.35,offsetY:3.175,dashLengthItems:[7.9375,-4.7625]}),Jn.set("AR_B816",h3);const u3=new ei("AR_B816C");u3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:203.2,dashLengthItems:[]}),u3.add({lineAngle:90,x:0,y:0,offsetX:203.2,offsetY:203.2,dashLengthItems:[203.2,-203.2]}),Jn.set("AR_B816C",u3);const N1=new ei("AR_B88");N1.add({lineAngle:0,x:0,y:0,offsetX:203.2,offsetY:203.2,dashLengthItems:[396.875,-9.525]}),N1.add({lineAngle:0,x:-203.2,y:9.525,offsetX:203.2,offsetY:203.2,dashLengthItems:[396.875,-9.525]}),N1.add({lineAngle:90,x:0,y:0,offsetX:203.2,offsetY:203.2,dashLengthItems:[-212.725,193.675]}),N1.add({lineAngle:90,x:-9.525,y:0,offsetX:203.2,offsetY:203.2,dashLengthItems:[-212.725,193.675]}),Jn.set("AR_B88",N1);const d3=new ei("AR_BRELM");d3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:203.2,dashLengthItems:[]}),d3.add({lineAngle:90,x:0,y:0,offsetX:203.2,offsetY:101.6,dashLengthItems:[203.2,-203.2]}),Jn.set("AR_BRELM",d3);const Hd=new ei("AR_BRSTD");Hd.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:135.484,dashLengthItems:[193.675,-9.525]}),Hd.add({lineAngle:0,x:0,y:57.15,offsetX:0,offsetY:135.484,dashLengthItems:[193.675,-9.525]}),Hd.add({lineAngle:0,x:50.8,y:67.7418,offsetX:0,offsetY:135.484,dashLengthItems:[92.075,-9.525]}),Hd.add({lineAngle:0,x:50.8,y:124.892,offsetX:0,offsetY:135.484,dashLengthItems:[92.075,-9.525]}),Hd.add({lineAngle:90,x:0,y:0,offsetX:0,offsetY:203.2,dashLengthItems:[57.15,-78.334]}),Hd.add({lineAngle:90,x:-9.525,y:0,offsetX:0,offsetY:203.2,dashLengthItems:[57.15,-78.334]}),Hd.add({lineAngle:90,x:50.8,y:67.7418,offsetX:0,offsetY:101.6,dashLengthItems:[57.15,-78.334]}),Hd.add({lineAngle:90,x:41.275,y:67.7418,offsetX:0,offsetY:101.6,dashLengthItems:[57.15,-78.334]}),Jn.set("AR_BRSTD",Hd);const A3=new ei("AR_CONC");A3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:67.7418,dashLengthItems:[]}),A3.add({lineAngle:90,x:0,y:0,offsetX:67.7418,offsetY:101.6,dashLengthItems:[67.7418,-67.7418]}),Jn.set("AR_CONC",A3);const kc=new ei("AR_HBONE");kc.add({lineAngle:50,x:0,y:0,offsetX:104.896,offsetY:-149.807,dashLengthItems:[19.05,-209.55]}),kc.add({lineAngle:355,x:0,y:0,offsetX:-51.76101082,offsetY:187.25814969,dashLengthItems:[15.24,-167.64058417]}),kc.add({lineAngle:100.4514447,x:15.182007,y:-1.3282535,offsetX:145.5569059,offsetY:-176.270089,dashLengthItems:[16.1900088,-178.0902446]}),kc.add({lineAngle:46.1842,x:0,y:50.8,offsetX:157.343,offsetY:-224.71,dashLengthItems:[28.575,-314.325]}),kc.add({lineAngle:96.63555761,x:22.5899,y:47.2965,offsetX:218.33577212,offsetY:-264.40480444,dashLengthItems:[24.28502314,-267.13560816]}),kc.add({lineAngle:351.18415117,x:0,y:50.8,offsetX:196.67912063,offsetY:280.88740361,dashLengthItems:[22.85996707,-251.45973192]}),kc.add({lineAngle:21,x:25.4,y:38.1,offsetX:104.89565868,offsetY:-149.80652586,dashLengthItems:[19.05,-209.55]}),kc.add({lineAngle:326,x:25.4,y:38.1,offsetX:-51.7604,offsetY:187.258,dashLengthItems:[15.24,-167.64]}),kc.add({lineAngle:71.451445,x:38.0345326,y:29.5779001,offsetX:145.5567546,offsetY:-176.2700748,dashLengthItems:[16.1900088,-178.0899376]}),kc.add({lineAngle:37.5,x:0,y:0,offsetX:53.9242,offsetY:65.2018,dashLengthItems:[0,-165.608,0,-170.18,0,-168.275]}),kc.add({lineAngle:7.5,x:0,y:0,offsetX:79.3242,offsetY:90.6018,dashLengthItems:[0,-97.028,0,-161.798,0,-64.135]}),kc.add({lineAngle:-32.5,x:-56.642,y:0,offsetX:117.434,offsetY:68.0212,dashLengthItems:[0,-63.5,0,-198.12,0,-262.89]}),kc.add({lineAngle:-42.5,x:-82.042,y:0,offsetX:92.0344,offsetY:118.821,dashLengthItems:[0,-82.55,0,-131.572,0,-186.69]}),Jn.set("AR_HBONE",kc);const f3=new ei("AR_PARQ1");f3.add({lineAngle:45,x:0,y:0,offsetX:101.6,offsetY:101.6,dashLengthItems:[304.8,-101.6]}),f3.add({lineAngle:135,x:71.842,y:71.842,offsetX:101.6,offsetY:-101.6,dashLengthItems:[304.8,-101.6]}),Jn.set("AR_PARQ1",f3);const lc=new ei("AR_RROOF");lc.add({lineAngle:90,x:0,y:0,offsetX:304.8,offsetY:304.8,dashLengthItems:[304.8,-304.8]}),lc.add({lineAngle:90,x:50.8,y:0,offsetX:304.8,offsetY:304.8,dashLengthItems:[304.8,-304.8]}),lc.add({lineAngle:90,x:101.6,y:0,offsetX:304.8,offsetY:304.8,dashLengthItems:[304.8,-304.8]}),lc.add({lineAngle:90,x:152.4,y:0,offsetX:304.8,offsetY:304.8,dashLengthItems:[304.8,-304.8]}),lc.add({lineAngle:90,x:203.2,y:0,offsetX:304.8,offsetY:304.8,dashLengthItems:[304.8,-304.8]}),lc.add({lineAngle:90,x:254,y:0,offsetX:304.8,offsetY:304.8,dashLengthItems:[304.8,-304.8]}),lc.add({lineAngle:90,x:304.8,y:0,offsetX:304.8,offsetY:304.8,dashLengthItems:[304.8,-304.8]}),lc.add({lineAngle:0,x:0,y:304.8,offsetX:304.8,offsetY:-304.8,dashLengthItems:[304.8,-304.8]}),lc.add({lineAngle:0,x:0,y:355.6,offsetX:304.8,offsetY:-304.8,dashLengthItems:[304.8,-304.8]}),lc.add({lineAngle:0,x:0,y:406.4,offsetX:304.8,offsetY:-304.8,dashLengthItems:[304.8,-304.8]}),lc.add({lineAngle:0,x:0,y:457.2,offsetX:304.8,offsetY:-304.8,dashLengthItems:[304.8,-304.8]}),lc.add({lineAngle:0,x:0,y:508,offsetX:304.8,offsetY:-304.8,dashLengthItems:[304.8,-304.8]}),lc.add({lineAngle:0,x:0,y:558.8,offsetX:304.8,offsetY:-304.8,dashLengthItems:[304.8,-304.8]}),lc.add({lineAngle:0,x:0,y:609.6,offsetX:304.8,offsetY:-304.8,dashLengthItems:[304.8,-304.8]}),Jn.set("AR_RROOF",lc);const ix=new ei("AR_RSHKE");ix.add({lineAngle:0,x:0,y:0,offsetX:55.88,offsetY:25.4,dashLengthItems:[381,-50.8,127,-25.4]}),ix.add({lineAngle:0,x:33.782,y:12.7,offsetX:-25.4,offsetY:33.782,dashLengthItems:[76.2,-8.382,152.4,-19.05]}),ix.add({lineAngle:0,x:12.7,y:21.59,offsetX:132.08,offsetY:17.018,dashLengthItems:[203.2,-35.56,101.6,-25.4]}),Jn.set("AR_RSHKE",ix);const zu=new ei("AR_SAND");zu.add({lineAngle:0,x:0,y:0,offsetX:647.7,offsetY:304.8,dashLengthItems:[152.4,-127,177.8,-76.2,228.6,-101.6]}),zu.add({lineAngle:0,x:152.4,y:12.7,offsetX:647.7,offsetY:304.8,dashLengthItems:[127,-482.6,101.6,-152.4]}),zu.add({lineAngle:0,x:457.2,y:-19.05,offsetX:647.7,offsetY:304.8,dashLengthItems:[76.2,-787.4]}),zu.add({lineAngle:90,x:0,y:0,offsetX:304.8,offsetY:215.9,dashLengthItems:[292.1,-927.1]}),zu.add({lineAngle:90,x:152.4,y:0,offsetX:304.8,offsetY:215.9,dashLengthItems:[285.75,-933.45]}),zu.add({lineAngle:90,x:279.4,y:0,offsetX:304.8,offsetY:215.9,dashLengthItems:[266.7,-952.5]}),zu.add({lineAngle:90,x:457.2,y:-19.05,offsetX:304.8,offsetY:215.9,dashLengthItems:[292.1,-927.1]}),zu.add({lineAngle:90,x:533.4,y:-19.05,offsetX:304.8,offsetY:215.9,dashLengthItems:[292.1,-927.1]}),zu.add({lineAngle:90,x:762,y:0,offsetX:304.8,offsetY:215.9,dashLengthItems:[279.4,-939.8]}),Jn.set("AR_SAND",zu);const L1=new ei("BOX");L1.add({lineAngle:37.5,x:0,y:0,offsetX:28.5242,offsetY:39.8018,dashLengthItems:[0,-38.608,0,-43.18,0,-41.275]}),L1.add({lineAngle:7.5,x:0,y:0,offsetX:53.9242,offsetY:65.2018,dashLengthItems:[0,-20.828,0,-34.798,0,-13.335]}),L1.add({lineAngle:-32.5,x:-31.242,y:0,offsetX:66.6344,offsetY:42.6212,dashLengthItems:[0,-12.7,0,-45.72,0,-59.69]}),L1.add({lineAngle:-42.5,x:-31.242,y:0,offsetX:41.2344,offsetY:68.0212,dashLengthItems:[0,-6.35,0,-29.972,0,-34.29]}),Jn.set("BOX",L1);const Wd=new ei("BRASS");Wd.add({lineAngle:90,x:0,y:0,offsetX:0,offsetY:25.4,dashLengthItems:[]}),Wd.add({lineAngle:90,x:6.35,y:0,offsetX:0,offsetY:25.4,dashLengthItems:[]}),Wd.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:25.4,dashLengthItems:[-6.35,6.35]}),Wd.add({lineAngle:0,x:0,y:6.35,offsetX:0,offsetY:25.4,dashLengthItems:[-6.35,6.35]}),Wd.add({lineAngle:0,x:0,y:12.7,offsetX:0,offsetY:25.4,dashLengthItems:[6.35,-6.35]}),Wd.add({lineAngle:0,x:0,y:19.05,offsetX:0,offsetY:25.4,dashLengthItems:[6.35,-6.35]}),Wd.add({lineAngle:90,x:12.7,y:0,offsetX:0,offsetY:25.4,dashLengthItems:[6.35,-6.35]}),Wd.add({lineAngle:90,x:19.05,y:0,offsetX:0,offsetY:25.4,dashLengthItems:[6.35,-6.35]}),Jn.set("BRASS",Wd);const p3=new ei("BRICK");p3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[]}),p3.add({lineAngle:0,x:0,y:3.175,offsetX:0,offsetY:6.35,dashLengthItems:[3.175,-1.5875]}),Jn.set("BRICK",p3);const rx=new ei("BRSTONE");rx.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[]}),rx.add({lineAngle:90,x:0,y:0,offsetX:0,offsetY:12.7,dashLengthItems:[6.35,-6.35]}),rx.add({lineAngle:90,x:6.35,y:0,offsetX:0,offsetY:12.7,dashLengthItems:[-6.35,6.35]}),Jn.set("BRSTONE",rx);const Qd=new ei("CLAY");Qd.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:8.382,dashLengthItems:[]}),Qd.add({lineAngle:90,x:22.86,y:0,offsetX:8.382,offsetY:12.7,dashLengthItems:[8.382,-8.382]}),Qd.add({lineAngle:90,x:20.32,y:0,offsetX:8.382,offsetY:12.7,dashLengthItems:[8.382,-8.382]}),Qd.add({lineAngle:0,x:22.86,y:1.397,offsetX:12.7,offsetY:8.382,dashLengthItems:[-22.86,2.54]}),Qd.add({lineAngle:0,x:22.86,y:2.794,offsetX:12.7,offsetY:8.382,dashLengthItems:[-22.86,2.54]}),Qd.add({lineAngle:0,x:22.86,y:4.191,offsetX:12.7,offsetY:8.382,dashLengthItems:[-22.86,2.54]}),Qd.add({lineAngle:0,x:22.86,y:5.588,offsetX:12.7,offsetY:8.382,dashLengthItems:[-22.86,2.54]}),Qd.add({lineAngle:0,x:22.86,y:6.985,offsetX:12.7,offsetY:8.382,dashLengthItems:[-22.86,2.54]}),Jn.set("CLAY",Qd);const M1=new ei("CORK");M1.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:4.7625,dashLengthItems:[]}),M1.add({lineAngle:0,x:0,y:.79375,offsetX:0,offsetY:4.7625,dashLengthItems:[]}),M1.add({lineAngle:0,x:0,y:1.5875,offsetX:0,offsetY:4.7625,dashLengthItems:[]}),M1.add({lineAngle:0,x:0,y:3.175,offsetX:0,offsetY:4.7625,dashLengthItems:[4.7625,-3.175]}),Jn.set("CORK",M1);const R1=new ei("CROSS");R1.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),R1.add({lineAngle:135,x:1.5875,y:-1.5875,offsetX:0,offsetY:8.98026,dashLengthItems:[4.49013,-4.49013]}),R1.add({lineAngle:135,x:2.38125,y:-1.5875,offsetX:0,offsetY:8.98026,dashLengthItems:[4.49013,-4.49013]}),R1.add({lineAngle:135,x:3.175,y:-1.5875,offsetX:0,offsetY:8.98026,dashLengthItems:[4.49013,-4.49013]}),Jn.set("CROSS",R1);const g3=new ei("DASH");g3.add({lineAngle:0,x:0,y:0,offsetX:6.35,offsetY:6.35,dashLengthItems:[3.175,-9.525]}),g3.add({lineAngle:90,x:1.5875,y:-1.5875,offsetX:6.35,offsetY:6.35,dashLengthItems:[3.175,-9.525]}),Jn.set("DASH",g3);const nP=new ei("DOLMIT");nP.add({lineAngle:0,x:0,y:0,offsetX:3.175,offsetY:3.175,dashLengthItems:[3.175,-3.175]}),Jn.set("DOLMIT",nP);const m3=new ei("DOTS");m3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[]}),m3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:17.9605,dashLengthItems:[8.980256121069154,-17.960512242138307]}),Jn.set("DOTS",m3);const iP=new ei("EARTH");iP.add({lineAngle:0,x:0,y:0,offsetX:.79375,offsetY:1.5875,dashLengthItems:[0,-1.5875]}),Jn.set("EARTH",iP);const _p=new ei("ESCHER");_p.add({lineAngle:0,x:0,y:0,offsetX:6.35,offsetY:6.35,dashLengthItems:[6.35,-6.35]}),_p.add({lineAngle:0,x:0,y:2.38125,offsetX:6.35,offsetY:6.35,dashLengthItems:[6.35,-6.35]}),_p.add({lineAngle:0,x:0,y:4.7625,offsetX:6.35,offsetY:6.35,dashLengthItems:[6.35,-6.35]}),_p.add({lineAngle:90,x:.79375,y:5.55625,offsetX:6.35,offsetY:6.35,dashLengthItems:[6.35,-6.35]}),_p.add({lineAngle:90,x:3.175,y:5.55625,offsetX:6.35,offsetY:6.35,dashLengthItems:[6.35,-6.35]}),_p.add({lineAngle:90,x:5.55625,y:5.55625,offsetX:6.35,offsetY:6.35,dashLengthItems:[6.35,-6.35]}),Jn.set("ESCHER",_p);const Wo=new ei("FLEX");Wo.add({lineAngle:60,x:0,y:0,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[27.94,-2.54]}),Wo.add({lineAngle:180,x:0,y:0,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[27.94,-2.54]}),Wo.add({lineAngle:300,x:0,y:0,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[27.94,-2.54]}),Wo.add({lineAngle:60,x:2.54,y:0,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),Wo.add({lineAngle:300,x:2.54,y:0,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),Wo.add({lineAngle:60,x:-1.27,y:2.199704516,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),Wo.add({lineAngle:180,x:-1.27,y:2.199704516,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),Wo.add({lineAngle:300,x:-1.27,y:-2.199704516,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),Wo.add({lineAngle:180,x:-1.27,y:-2.199704516,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),Wo.add({lineAngle:60,x:-10.16,y:0,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),Wo.add({lineAngle:300,x:-10.16,y:0,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),Wo.add({lineAngle:60,x:5.08,y:-8.7988180894,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),Wo.add({lineAngle:180,x:5.08,y:-8.7988180894,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),Wo.add({lineAngle:300,x:5.08,y:8.7988180894,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),Wo.add({lineAngle:180,x:5.08,y:8.7988180894,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),Wo.add({lineAngle:0,x:5.08,y:4.3994090574,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[17.78,-12.7]}),Wo.add({lineAngle:0,x:5.08,y:-4.3994090574,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[17.78,-12.7]}),Wo.add({lineAngle:120,x:1.27,y:6.5991135734,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[17.78,-12.7]}),Wo.add({lineAngle:120,x:-6.35,y:2.199704516,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[17.78,-12.7]}),Wo.add({lineAngle:240,x:-6.35,y:-2.199704516,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[17.78,-12.7]}),Wo.add({lineAngle:240,x:1.27,y:-6.5991135734,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[17.78,-12.7]}),Jn.set("FLEX",Wo);const y3=new ei("GOST_GLASS");y3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[6.35,-6.35]}),y3.add({lineAngle:45,x:6.35,y:0,offsetX:4.490128053,offsetY:4.490128053,dashLengthItems:[1.5875,-5.8052561314,1.5875,-8.9802561314]}),Jn.set("GOST_GLASS",y3);const sx=new ei("GOST_WOOD");sx.add({lineAngle:45,x:0,y:0,offsetX:6,offsetY:-6,dashLengthItems:[5,-7]}),sx.add({lineAngle:45,x:2.12132,y:0,offsetX:6,offsetY:-6,dashLengthItems:[2,-10]}),sx.add({lineAngle:45,x:0,y:2.12132,offsetX:6,offsetY:-6,dashLengthItems:[2,-10]}),Jn.set("GOST_WOOD",sx);const ox=new ei("GOST_GROUND");ox.add({lineAngle:90,x:0,y:0,offsetX:0,offsetY:-6,dashLengthItems:[10,-2]}),ox.add({lineAngle:90,x:2,y:-2,offsetX:0,offsetY:-6,dashLengthItems:[6,-1.5,3,-1.5]}),ox.add({lineAngle:90,x:4,y:-5,offsetX:0,offsetY:-6,dashLengthItems:[10,-2]}),Jn.set("GOST_GROUND",ox);const ax=new ei("GRASS");ax.add({lineAngle:45,x:0,y:0,offsetX:10,offsetY:-10,dashLengthItems:[20]}),ax.add({lineAngle:45,x:3,y:0,offsetX:10,offsetY:-10,dashLengthItems:[20]}),ax.add({lineAngle:45,x:6,y:0,offsetX:10,offsetY:-10,dashLengthItems:[20]}),Jn.set("GRASS",ax);const lx=new ei("GRATE");lx.add({lineAngle:90,x:0,y:0,offsetX:17.96051224,offsetY:17.96051224,dashLengthItems:[4.7625,-31.15852448]}),lx.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:25.4,dashLengthItems:[4.7625,-20.6375]}),lx.add({lineAngle:135,x:0,y:0,offsetX:0,offsetY:25.4,dashLengthItems:[4.7625,-20.6375]}),Jn.set("GRATE",lx);const v3=new ei("GRAVEL");v3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:.79375,dashLengthItems:[]}),v3.add({lineAngle:90,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),Jn.set("GRAVEL",v3);const Er=new ei("HEX");Er.add({lineAngle:228.0127875,x:18.288,y:25.4,offsetX:305.85067529778,offsetY:1.88796713245,dashLengthItems:[3.4172144,-338.30483639565]}),Er.add({lineAngle:184.969741,x:16.002,y:22.86,offsetX:-305.8545235377,offsetY:1.10019612724,dashLengthItems:[5.8640472,-580.54048893524]}),Er.add({lineAngle:132.5104471,x:10.16,y:22.352,offsetX:-377.59492241548,offsetY:1.56030959675,dashLengthItems:[4.1348152,-409.347227941]}),Er.add({lineAngle:267.273689,x:.254,y:16.002,offsetX:-508.63316875916,offsetY:1.20815479432,dashLengthItems:[5.3400452,-528.66437425738]}),Er.add({lineAngle:292.83365418,x:0,y:10.668,offsetX:-330.19770134945,offsetY:1.23208097566,dashLengthItems:[5.236337,-518.39807745344]}),Er.add({lineAngle:357.273689,x:2.032,y:5.842,offsetX:-508.63316875916,offsetY:1.20815479432,dashLengthItems:[5.3400452,-528.66437425738]}),Er.add({lineAngle:37.69424047,x:7.366,y:5.588,offsetX:-416.58997273292,offsetY:.91357450169,dashLengthItems:[7.0619366,-699.13115314247]}),Er.add({lineAngle:72.25532837,x:12.954,y:9.906,offsetX:586.40373773403,offsetY:.96766293399,dashLengthItems:[6.6671952,-660.05256601905]}),Er.add({lineAngle:121.42956562,x:14.986,y:16.256,offsetX:387.71230339293,offsetY:1.2040754753,dashLengthItems:[5.35813,-530.45545698712]}),Er.add({lineAngle:175.2363583,x:12.192,y:20.828,offsetX:-280.5442400419,offsetY:2.10935518695,dashLengthItems:[6.1171328,-299.7393695]}),Er.add({lineAngle:222.3974378,x:6.096,y:21.336,offsetX:413.48123885686,offsetY:.81554484621,dashLengthItems:[7.9107792,-783.16772512177]}),Er.add({lineAngle:138.81407483,x:25.4,y:15.748,offsetX:234.164238558,offsetY:2.38943100688,dashLengthItems:[2.7000454,-267.30565824344]}),Er.add({lineAngle:171.4692344,x:23.368,y:17.526,offsetX:-334.082478726,offsetY:1.25594916784,dashLengthItems:[5.1368198,-508.5463899704]}),Er.add({lineAngle:225,x:18.288,y:18.288,offsetX:17.96051224214,offsetY:17.96051224214,dashLengthItems:[3.5920934,-32.32893108428]}),Er.add({lineAngle:203.19859051,x:16.51,y:21.336,offsetX:-136.74251918,offsetY:3.33518339548,dashLengthItems:[1.9344132,-191.50622368894]}),Er.add({lineAngle:291.80140949,x:14.732,y:20.574,offsetX:-80.18324702488,offsetY:4.71666158921,dashLengthItems:[2.7356562,-134.0475299]}),Er.add({lineAngle:30.96375653,x:15.748,y:18.034,offsetX:91.47734531502,offsetY:4.35606406258,dashLengthItems:[4.4431966,-143.6629815291]}),Er.add({lineAngle:161.56505118,x:19.558,y:20.32,offsetX:-56.2252967978,offsetY:8.03218525675,dashLengthItems:[3.2128714,-77.10898116828]}),Er.add({lineAngle:16.389540334,x:0,y:20.574,offsetX:265.17991128726,offsetY:1.43340492604,dashLengthItems:[4.50088,-445.58826672539]}),Er.add({lineAngle:70.34617594,x:4.318,y:21.844,offsetX:-297.29446803469,offsetY:1.70858889651,dashLengthItems:[3.7759894,-373.822156782]}),Er.add({lineAngle:293.19859051,x:19.558,y:25.4,offsetX:-136.7425191801,offsetY:3.33518339548,dashLengthItems:[3.868801,-189.57183588894]}),Er.add({lineAngle:343.61045967,x:21.082,y:21.844,offsetX:-265.17991128725,offsetY:1.433404926,dashLengthItems:[4.50088,-445.5882667254]}),Er.add({lineAngle:339.44395478,x:0,y:4.826,offsetX:-136.75087638398,offsetY:2.97284513779,dashLengthItems:[4.340352,-212.67734313106]}),Er.add({lineAngle:294.7751406,x:4.064,y:3.302,offsetX:-306.90424056705,offsetY:1.77401295215,dashLengthItems:[3.6367212,-360.0359338072]}),Er.add({lineAngle:66.80140949,x:19.812,y:0,offsetX:136.74251918012,offsetY:3.33518339452,dashLengthItems:[3.868801,-189.57183588894]}),Er.add({lineAngle:17.35402464,x:21.336,y:3.556,offsetX:-345.47402804977,offsetY:1.51523696536,dashLengthItems:[4.2578274,-421.523759802]}),Er.add({lineAngle:69.44395478,x:7.366,y:0,offsetX:-136.75087638396,offsetY:2.97284513874,dashLengthItems:[2.170176,-214.84751913106]}),Er.add({lineAngle:101.309932474,x:18.288,y:0,offsetX:104.60834648271,offsetY:4.98134983255,dashLengthItems:[1.295146,-128.21994964526]}),Er.add({lineAngle:165.963756532,x:18.034,y:1.27,offsetX:-80.085263387,offsetY:6.16040487582,dashLengthItems:[5.236337,-99.49054589069]}),Er.add({lineAngle:186.00900596,x:12.954,y:2.54,offsetX:-255.26337856879,offsetY:1.32949676118,dashLengthItems:[4.85267,-480.41364863337]}),Er.add({lineAngle:303.69006753,x:15.748,y:15.748,offsetX:-56.35753993648,offsetY:7.0446924921,dashLengthItems:[3.6632388,-87.9177635968]}),Er.add({lineAngle:353.15722659,x:17.78,y:12.7,offsetX:434.77679606606,offsetY:1.0087628707,dashLengthItems:[6.3955676,-633.16009065031]}),Er.add({lineAngle:60.9453959,x:24.13,y:11.938,offsetX:-204.76648550216,offsetY:2.46706609031,dashLengthItems:[2.6150824,-258.8939231811]}),Er.add({lineAngle:90,x:25.4,y:14.224,offsetX:25.4,offsetY:25.4,dashLengthItems:[1.524,-23.876]}),Er.add({lineAngle:120.25643716,x:12.446,y:3.302,offsetX:-204.77318477297,offsetY:1.8283320086,dashLengthItems:[3.5286696,-349.339407732]}),Er.add({lineAngle:48.0127875,x:10.668,y:6.35,offsetX:305.85067529778,offsetY:1.88796713138,dashLengthItems:[6.8344288,-334.88762199565]}),Er.add({lineAngle:0,x:15.24,y:11.43,offsetX:25.4,offsetY:25.4,dashLengthItems:[6.604,-18.796]}),Er.add({lineAngle:325.3048465,x:21.844,y:11.43,offsetX:310.04235091354,offsetY:-1.6064370526,dashLengthItems:[4.0160956,-397.5931672414]}),Er.add({lineAngle:254.0546041,x:25.146,y:9.144,offsetX:104.6687497289,offsetY:3.48895832444,dashLengthItems:[3.6982908,-181.21650038772]}),Er.add({lineAngle:207.64597536,x:24.13,y:5.588,offsetX:545.36007557253,offsetY:1.07143433066,dashLengthItems:[6.021451,-596.12464422938]}),Er.add({lineAngle:175.42607874,x:18.796,y:2.794,offsetX:331.1739336186,offsetY:1.01276432357,dashLengthItems:[6.3702946,-630.6584645624]}),Jn.set("HEX",Er);const cx=new ei("HONEY");cx.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5.4992613154,dashLengthItems:[3.175,-6.35]}),cx.add({lineAngle:120,x:0,y:0,offsetX:0,offsetY:5.4992613154,dashLengthItems:[3.175,-6.35]}),cx.add({lineAngle:60,x:3.175,y:0,offsetX:0,offsetY:5.4992613154,dashLengthItems:[3.175,-6.35]}),Jn.set("HONEY",cx);const hx=new ei("HOUND");hx.add({lineAngle:0,x:0,y:0,offsetX:4.7625,offsetY:2.749630645,dashLengthItems:[3.175,-6.35]}),hx.add({lineAngle:120,x:0,y:0,offsetX:4.7625,offsetY:2.749630645,dashLengthItems:[3.175,-6.35]}),hx.add({lineAngle:60,x:0,y:0,offsetX:4.7625,offsetY:2.749630645,dashLengthItems:[-6.35,3.175]}),Jn.set("HOUND",hx);const w3=new ei("INSUL");w3.add({lineAngle:0,x:0,y:0,offsetX:6.35,offsetY:1.5875,dashLengthItems:[25.4,-12.7]}),w3.add({lineAngle:90,x:0,y:0,offsetX:-6.35,offsetY:1.5875,dashLengthItems:[25.4,-12.7]}),Jn.set("INSUL",w3);const ux=new ei("ACAD_ISO02W100");ux.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:9.525,dashLengthItems:[]}),ux.add({lineAngle:0,x:0,y:3.175,offsetX:0,offsetY:9.525,dashLengthItems:[3.175,-3.175]}),ux.add({lineAngle:0,x:0,y:6.35,offsetX:0,offsetY:9.525,dashLengthItems:[3.175,-3.175]}),Jn.set("ACAD_ISO02W100",ux);const rP=new ei("ACAD_ISO03W100");rP.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[12,-3]}),Jn.set("ACAD_ISO03W100",rP);const sP=new ei("ACAD_ISO04W100");sP.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[12,-18]}),Jn.set("ACAD_ISO04W100",sP);const oP=new ei("ACAD_ISO05W100");oP.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[24,-3,.5,-3]}),Jn.set("ACAD_ISO05W100",oP);const aP=new ei("ACAD_ISO06W100");aP.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[24,-3,.5,-3,.5,-3]}),Jn.set("ACAD_ISO06W100",aP);const x3=new ei("ACAD_ISO07W100");x3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[24,-3,.5,-3,.5,-6.5]}),x3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[-34,.5,-3]}),Jn.set("ACAD_ISO07W100",x3);const lP=new ei("ACAD_ISO08W100");lP.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[.5,-3]}),Jn.set("ACAD_ISO08W100",lP);const cP=new ei("ACAD_ISO09W100");cP.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[24,-3,6,-3]}),Jn.set("ACAD_ISO09W100",cP);const hP=new ei("ACAD_ISO10W100");hP.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[24,-3,6,-3,6,-3]}),Jn.set("ACAD_ISO10W100",hP);const uP=new ei("ACAD_ISO11W100");uP.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[12,-3,.5,-3]}),Jn.set("ACAD_ISO11W100",uP);const dP=new ei("ACAD_ISO12W100");dP.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[12,-3,12,-3,.5,-3]}),Jn.set("ACAD_ISO12W100",dP);const AP=new ei("ACAD_ISO13W100");AP.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[12,-3,.5,-3,.5,-3]}),Jn.set("ACAD_ISO13W100",AP);const b3=new ei("ACAD_ISO14W100");b3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[12,-3,12,-3,.5,-6.5]}),b3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[-33.5,.5,-3]}),Jn.set("ACAD_ISO14W100",b3);const _3=new ei("ACAD_ISO15W100");_3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[12,-3,.5,-3,.5,-6.5]}),_3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[-22,.5,-3]}),Jn.set("ACAD_ISO15W100",_3);const C3=new ei("JIS_LC_20");C3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[12,-3,12,-3,.5,-10]}),C3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[-33.5,.5,-3,.5,-3]}),Jn.set("JIS_LC_20",C3);const S3=new ei("JIS_LC_20A");S3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:20,dashLengthItems:[]}),S3.add({lineAngle:45,x:.4,y:0,offsetX:0,offsetY:20,dashLengthItems:[]}),Jn.set("JIS_LC_20A",S3);const T3=new ei("JIS_LC_8");T3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:20,dashLengthItems:[]}),T3.add({lineAngle:45,x:1,y:0,offsetX:0,offsetY:20,dashLengthItems:[]}),Jn.set("JIS_LC_8",T3);const B3=new ei("JIS_LC_8A");B3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:7.8,dashLengthItems:[]}),B3.add({lineAngle:45,x:.4,y:0,offsetX:0,offsetY:7.8,dashLengthItems:[]}),Jn.set("JIS_LC_8A",B3);const E3=new ei("JIS_RC_10");E3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:7.8,dashLengthItems:[]}),E3.add({lineAngle:45,x:1,y:0,offsetX:0,offsetY:7.8,dashLengthItems:[]}),Jn.set("JIS_RC_10",E3);const dx=new ei("JIS_RC_15");dx.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:10,dashLengthItems:[]}),dx.add({lineAngle:45,x:.725,y:0,offsetX:0,offsetY:10,dashLengthItems:[]}),dx.add({lineAngle:45,x:1.45,y:0,offsetX:0,offsetY:10,dashLengthItems:[]}),Jn.set("JIS_RC_15",dx);const Ax=new ei("JIS_RC_18");Ax.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:15,dashLengthItems:[]}),Ax.add({lineAngle:45,x:.725,y:0,offsetX:0,offsetY:15,dashLengthItems:[]}),Ax.add({lineAngle:45,x:1.45,y:0,offsetX:0,offsetY:15,dashLengthItems:[]}),Jn.set("JIS_RC_18",Ax);const fx=new ei("JIS_RC_30");fx.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:18,dashLengthItems:[]}),fx.add({lineAngle:45,x:1,y:0,offsetX:0,offsetY:18,dashLengthItems:[]}),fx.add({lineAngle:45,x:2,y:0,offsetX:0,offsetY:18,dashLengthItems:[]}),Jn.set("JIS_RC_30",fx);const px=new ei("JIS_STN_1E");px.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:30,dashLengthItems:[]}),px.add({lineAngle:45,x:1,y:0,offsetX:0,offsetY:30,dashLengthItems:[]}),px.add({lineAngle:45,x:2,y:0,offsetX:0,offsetY:30,dashLengthItems:[]}),Jn.set("JIS_STN_1E",px);const k3=new ei("JIS_STN_2_5");k3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:1,dashLengthItems:[]}),k3.add({lineAngle:45,x:.705,y:0,offsetX:0,offsetY:1,dashLengthItems:[1,-.5]}),Jn.set("JIS_STN_2_5",k3);const I3=new ei("JIS_WOOD");I3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:2.5,dashLengthItems:[]}),I3.add({lineAngle:45,x:1.765,y:0,offsetX:0,offsetY:2.5,dashLengthItems:[1.2,-.5]}),Jn.set("JIS_WOOD",I3);const fP=new ei("LINE");fP.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:.70710678,dashLengthItems:[]}),Jn.set("LINE",fP);const pP=new ei("MUDST");pP.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),Jn.set("MUDST",pP);const gP=new ei("NET");gP.add({lineAngle:0,x:0,y:0,offsetX:12.7,offsetY:6.35,dashLengthItems:[6.35,-6.35,0,-6.35,0,-6.35]}),Jn.set("NET",gP);const F3=new ei("NET3");F3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),F3.add({lineAngle:90,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),Jn.set("NET3",F3);const gx=new ei("PLAST");gx.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),gx.add({lineAngle:60,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),gx.add({lineAngle:120,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),Jn.set("PLAST",gx);const mx=new ei("PLASTI");mx.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[]}),mx.add({lineAngle:0,x:0,y:.79375,offsetX:0,offsetY:6.35,dashLengthItems:[]}),mx.add({lineAngle:0,x:0,y:1.5875,offsetX:0,offsetY:6.35,dashLengthItems:[]}),Jn.set("PLASTI",mx);const O1=new ei("SACNCR");O1.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[]}),O1.add({lineAngle:0,x:0,y:.79375,offsetX:0,offsetY:6.35,dashLengthItems:[]}),O1.add({lineAngle:0,x:0,y:1.5875,offsetX:0,offsetY:6.35,dashLengthItems:[]}),O1.add({lineAngle:0,x:0,y:3.96875,offsetX:0,offsetY:6.35,dashLengthItems:[]}),Jn.set("SACNCR",O1);const D3=new ei("SQUARE");D3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:2.38125,dashLengthItems:[]}),D3.add({lineAngle:45,x:1.6838,y:0,offsetX:0,offsetY:2.38125,dashLengthItems:[0,-2.38125]}),Jn.set("SQUARE",D3);const j3=new ei("STARS");j3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[3.175,-3.175]}),j3.add({lineAngle:90,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[3.175,-3.175]}),Jn.set("STARS",j3);const yx=new ei("STEEL");yx.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5.4992613154,dashLengthItems:[3.175,-3.175]}),yx.add({lineAngle:60,x:0,y:0,offsetX:0,offsetY:5.4992613154,dashLengthItems:[3.175,-3.175]}),yx.add({lineAngle:120,x:1.5875,y:2.7496306704,offsetX:0,offsetY:5.4992613154,dashLengthItems:[3.175,-3.175]}),Jn.set("STEEL",yx);const P3=new ei("SWAMP");P3.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),P3.add({lineAngle:45,x:0,y:1.5875,offsetX:0,offsetY:3.175,dashLengthItems:[]}),Jn.set("SWAMP",P3);const Cp=new ei("TRANS");Cp.add({lineAngle:0,x:0,y:0,offsetX:12.7,offsetY:21.9970452362,dashLengthItems:[3.175,-22.225]}),Cp.add({lineAngle:90,x:1.5875,y:0,offsetX:21.9970452362,offsetY:12.7,dashLengthItems:[1.5875,-42.4065904724]}),Cp.add({lineAngle:90,x:1.984375,y:0,offsetX:21.9970452362,offsetY:12.7,dashLengthItems:[1.27,-42.7240904724]}),Cp.add({lineAngle:90,x:1.190625,y:0,offsetX:21.9970452362,offsetY:12.7,dashLengthItems:[1.27,-42.7240904724]}),Cp.add({lineAngle:60,x:2.38125,y:0,offsetX:12.7,offsetY:21.9970452362,dashLengthItems:[1.016,-24.384]}),Cp.add({lineAngle:120,x:.79375,y:0,offsetX:12.7,offsetY:21.9970452362,dashLengthItems:[1.016,-24.384]}),Jn.set("TRANS",Cp);const N3=new ei("TRIANG");N3.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[]}),N3.add({lineAngle:0,x:0,y:3.175,offsetX:0,offsetY:6.35,dashLengthItems:[3.175,-3.175]}),Jn.set("TRIANG",N3);const vx=new ei("ZIGZAG");vx.add({lineAngle:60,x:0,y:0,offsetX:4.7625,offsetY:8.2488919604,dashLengthItems:[4.7625,-4.7625]}),vx.add({lineAngle:120,x:0,y:0,offsetX:4.7625,offsetY:8.2488919604,dashLengthItems:[4.7625,-4.7625]}),vx.add({lineAngle:0,x:-2.38125,y:4.1244459802,offsetX:4.7625,offsetY:8.2488919604,dashLengthItems:[4.7625,-4.7625]}),Jn.set("ZIGZAG",vx);let mP=class R${static fromHex(e){return e.startsWith("#")&&(e=e.replace("#","")),parseInt(e,16)}static fromRGB(e,t,i){const r=[e,t,i].reduce(((s,o)=>{const a=o.toString(16);return`${s}${a.length===1?"0"+a:a}`}),"0x00");return R$.fromHex(r)}},pa=class{constructor(e,t,i){this.type=e,this.subclassMarker=t,this.layerName=i==null?void 0:i.layerName,this.handle=bd.next(),this.trueColor=i==null?void 0:i.trueColor,this.inPaperSpace=!1,this.colorNumber=i==null?void 0:i.colorNumber,this.visible=i==null?void 0:i.visible,this.lineType=i==null?void 0:i.lineType,this.lineTypeScale=i==null?void 0:i.lineTypeScale,this.extrusion=i==null?void 0:i.extrusion,this.xdatas=[]}boundingBox(){return No.pointBBox(wt())}addXData(e){const t=new ude(e);return this.xdatas.push(t),t}dxfy(e){var t,i,r;e.type(this.type),e.handle(this.handle),e.push(330,this.ownerBlockRecord),e.subclassMarker("AcDbEntity"),this.inPaperSpace&&e.push(67,Number(this.inPaperSpace)),e.push(420,this.trueColor),e.layerName(this.layerName||rm.layerZeroName),e.lineType(this.lineType),e.colorNumber(this.colorNumber),e.push(48,this.lineTypeScale),e.visibilty(this.visible),e.subclassMarker(this.subclassMarker),this.type!=="HATCH"&&(e.push(210,(t=this.extrusion)===null||t===void 0?void 0:t.x),e.push(220,(i=this.extrusion)===null||i===void 0?void 0:i.y),e.push(230,(r=this.extrusion)===null||r===void 0?void 0:r.z)),this.dxfyChild(e),this.xdatas.forEach((s=>s.dxfy(e)))}};var _A,hE,yP;(function(n){n[n.Default=0]="Default",n[n.Aligned=1]="Aligned",n[n.Angular=2]="Angular",n[n.Diameter=3]="Diameter",n[n.Radius=4]="Radius",n[n.Angular3Point=5]="Angular3Point",n[n.Ordinate=6]="Ordinate",n[n.ReferencedByThis=32]="ReferencedByThis",n[n.OrdinateType=64]="OrdinateType"})(_A||(_A={})),(function(n){n[n.TopLeft=1]="TopLeft",n[n.TopCenter=2]="TopCenter",n[n.TopRight=3]="TopRight",n[n.MiddleLeft=4]="MiddleLeft",n[n.MiddleCenter=5]="MiddleCenter",n[n.MiddleRight=6]="MiddleRight",n[n.BottomLeft=7]="BottomLeft",n[n.BottomCenter=8]="BottomCenter",n[n.BottomRight=9]="BottomRight"})(hE||(hE={})),(function(n){n[n.AtLeast=1]="AtLeast",n[n.Exact=2]="Exact"})(yP||(yP={}));let Km=class extends pa{constructor(e){super("DIMENSION","AcDbDimension",e),this.blockName=e==null?void 0:e.blockName,this.definitionPoint=e==null?void 0:e.definitionPoint,this.middlePoint=e==null?void 0:e.middlePoint,this.dimensionType=_A.Default,this.attachmentPoint=(e==null?void 0:e.attachmentPoint)||hE.MiddleCenter,this.textLineSpacingStyle=e==null?void 0:e.textLineSpacingStyle,this.textLineSpacingFactor=e==null?void 0:e.textLineSpacingFactor,this.ActualMeasurement=e==null?void 0:e.ActualMeasurement,this.text=e==null?void 0:e.text,this.rotation=e==null?void 0:e.rotation,this.horizontalDirection=e==null?void 0:e.horizontalDirection,this.styleName=e==null?void 0:e.styleName}dxfyChild(e){e.push(2,this.blockName),e.point3d(this.definitionPoint),e.point3d(this.middlePoint,1),e.push(70,this.dimensionType),e.push(71,this.attachmentPoint),e.push(72,this.textLineSpacingStyle),e.push(41,this.textLineSpacingFactor),e.push(42,this.ActualMeasurement),e.push(1,this.text),e.push(53,this.rotation==="auto"?this.rotate():this.rotation),e.push(51,this.horizontalDirection),e.push(3,this.styleName)}};const X_=/[<>/\\":;?*|=`]/g;function X2(n){return n*Math.PI/180}function dde(n,e){const t=(function(i,r){return Math.sqrt(Math.pow(i.x-r.x,2)+Math.pow(i.y-r.y,2))})(n,e);return t===0?t:180*Math.asin(Math.abs(n.y-e.y)/t)/Math.PI}let Ade=class extends Km{constructor(e,t,i){super(i),this.dimensionType=_A.Aligned,this.insertionPoint=i==null?void 0:i.insertionPoint,this.fisrtPoint=e,this.secondPoint=t,this.offset(i==null?void 0:i.offset)}offset(e){if(e==null)return;const[t,i]=(function(s,o){const a=s.x-o.x;let c=0;return a!==0&&(c=(s.y-o.y)/a),[c,s.y-c*s.x]})(this.fisrtPoint,this.secondPoint),r=(function(s,o){const[a,c]=o;return c-s*Math.sqrt(a*a+1)})(e,[t,i]);this.definitionPoint=(function(s,o){const[a,c]=s,h=a??-1/a,u=o.y-h*o.x,d=h-a;let f=c-u;return d!==0&&(f=(c-u)/d),wt(f,a*f+c,o.z)})([t,r],this.fisrtPoint)}rotate(){return dde(this.fisrtPoint,this.secondPoint)}dxfyChild(e){super.dxfyChild(e),e.subclassMarker("AcDbAlignedDimension"),e.point3d(this.insertionPoint,2),e.point3d(this.fisrtPoint,3),e.point3d(this.secondPoint,4)}},fde=class extends Km{constructor(e,t,i,r){super(r),this.first=e,this.second=t,this.location=i,this.dimensionType=_A.Angular}rotate(){return 0}_update(){this.definitionPoint=this.second.end}dxfyChild(e){this._update(),super.dxfyChild(e),e.subclassMarker("AcDb2LineAngularDimension"),e.point3d(this.first.start,3),e.point3d(this.first.end,4),e.point3d(this.second.start,5),e.point3d(this.location,6)}},pde=class extends Km{constructor(e,t,i,r){super(r),this.center=e,this.first=t,this.second=i,this.dimensionType=_A.Angular3Point}rotate(){return 0}dxfyChild(e){super.dxfyChild(e),e.subclassMarker("AcDb3PointAngularDimension"),e.point3d(this.first,3),e.point3d(this.second,4),e.point3d(this.center,5)}},gde=class extends Km{constructor(e,t,i){super(i),this.dimensionType=_A.Diameter,this.first=e,this.definitionPoint=t,this.leaderLength=i==null?void 0:i.leaderLength}rotate(){return 0}dxfyChild(e){super.dxfyChild(e),e.subclassMarker("AcDbDiametricDimension"),e.point3d(this.first,5),e.push(40,this.leaderLength)}},mde=class extends Km{constructor(e,t,i){var r;super(i),this.dimensionType=_A.Default,this.insertionPoint=i==null?void 0:i.insertionPoint,this.fisrtPoint=e,this.secondPoint=t,this.angle=(r=i==null?void 0:i.angle)!==null&&r!==void 0?r:0,this.linearType=i==null?void 0:i.linearType,this.offset(i==null?void 0:i.offset)}offset(e){if(e==null)return;const t=X2(this.angle),i=this.fisrtPoint.x+e*Math.floor(Math.sin(t)),r=this.fisrtPoint.y+e*Math.floor(Math.cos(t));this.definitionPoint=wt(i,r,0)}rotate(){return this.angle}dxfyChild(e){super.dxfyChild(e),e.subclassMarker("AcDbAlignedDimension"),e.point3d(this.insertionPoint,2),e.point3d(this.fisrtPoint,3),e.point3d(this.secondPoint,4),e.push(50,this.angle),e.push(52,this.linearType),e.subclassMarker("AcDbRotatedDimension")}},yde=class extends Km{constructor(e,t,i){super(i),this.dimensionType=_A.Radius,this.first=e,this.definitionPoint=t,this.leaderLength=i==null?void 0:i.leaderLength}rotate(){return 0}dxfyChild(e){super.dxfyChild(e),e.subclassMarker("AcDbRadialDimension"),e.point3d(this.first,5),e.push(40,this.leaderLength)}},vde=class extends pa{get start(){return wt(this.center.x+this.radius*Math.cos(X2(this.startAngle)),this.center.y+this.radius*Math.sin(X2(this.startAngle)))}get end(){return wt(this.center.x+this.radius*Math.cos(X2(this.endAngle)),this.center.y+this.radius*Math.sin(X2(this.endAngle)))}constructor(e,t,i,r,s){super("ARC","AcDbCircle",s),this.center=e,this.radius=t,this.startAngle=i,this.endAngle=r}boundingBox(){return No.centerRadiusBBox(this.center,this.radius)}dxfyChild(e){e.point3d(this.center),e.push(40,this.radius),e.subclassMarker("AcDbArc"),e.push(50,this.startAngle),e.push(51,this.endAngle)}},wde=class extends pa{constructor(e,t,i,r,s){super("ATTDEF","AcDbText",s),this.position=e,this.height=t,this.value=r,this.tag=i,this.textStyle="STANDARD",this.rotation=s==null?void 0:s.rotation,this.obliqueAngle=s==null?void 0:s.obliqueAngle,this.generationFlags=s==null?void 0:s.generationFlags,this.horizontalAlignment=s==null?void 0:s.horizontalAlignment,this.verticalAlignment=s==null?void 0:s.verticalAlignment,this.secondAlignmentPoint=s==null?void 0:s.secondAlignmentPoint,this.relativeXScaleFactor=s==null?void 0:s.relativeXScaleFactor}boundingBox(){return No.pointBBox(this.position)}dxfyChild(e){e.point3d(this.position),e.push(40,this.height),e.primaryText(this.value),e.push(50,this.rotation),e.push(41,this.relativeXScaleFactor),e.push(51,this.obliqueAngle),e.textStyle(this.textStyle),e.push(71,this.generationFlags),e.push(72,this.horizontalAlignment),this.secondAlignmentPoint&&(e.push(11,this.secondAlignmentPoint.x),e.push(21,this.secondAlignmentPoint.y),e.push(31,this.secondAlignmentPoint.z)),e.push(73,this.verticalAlignment),e.subclassMarker("AcDbAttributeDefinition"),e.push(280,0),e.push(3,""),e.push(2,this.tag),e.push(70,0)}},xde=class extends pa{constructor(e,t,i,r,s){super("ATTRIB","AcDbText",s),this.position=e,this.height=t,this.value=r,this.tag=i,this.textStyle="STANDARD",this.rotation=s==null?void 0:s.rotation,this.obliqueAngle=s==null?void 0:s.obliqueAngle,this.generationFlags=s==null?void 0:s.generationFlags,this.horizontalAlignment=s==null?void 0:s.horizontalAlignment,this.verticalAlignment=s==null?void 0:s.verticalAlignment,this.secondAlignmentPoint=s==null?void 0:s.secondAlignmentPoint,this.relativeXScaleFactor=s==null?void 0:s.relativeXScaleFactor}boundingBox(){return No.pointBBox(this.position)}dxfyChild(e){e.point3d(this.position),e.push(40,this.height),e.primaryText(this.value),e.push(50,this.rotation),e.push(41,this.relativeXScaleFactor),e.push(51,this.obliqueAngle),e.textStyle(this.textStyle),e.push(71,this.generationFlags),e.push(72,this.horizontalAlignment),e.point3d(this.secondAlignmentPoint,1),e.push(73,this.verticalAlignment),e.subclassMarker("AcDbAttribute"),e.push(280,0),e.push(2,this.tag),e.push(70,0)}},bde=class extends pa{constructor(e,t,i){super("CIRCLE","AcDbCircle",i),this.center=e,this.radius=t}boundingBox(){return No.centerRadiusBBox(this.center,this.radius)}dxfyChild(e){e.point3d(this.center),e.push(40,this.radius)}},_de=class extends pa{constructor(e,t,i,r,s,o){super("ELLIPSE","AcDbEllipse",o),this.center=e,this.endPointOfMajorAxis=t,this.ratioOfMinorAxisToMajorAxis=i,this.startParameter=r,this.endParameter=s}boundingBox(){const e=this.center.x,t=this.center.y,i=this.endPointOfMajorAxis.x,r=this.endPointOfMajorAxis.y,s=Math.sqrt(Math.pow(e-(e+i),2)+Math.pow(t-(t+r),2));return No.centerRadiusBBox(this.center,s)}dxfyChild(e){e.point3d(this.center),e.point3d(this.endPointOfMajorAxis,1),e.push(40,this.ratioOfMinorAxisToMajorAxis),e.push(41,this.startParameter),e.push(42,this.endParameter)}};var Dh,K_,uE,vP,By,dE,AE,fE,qd,q_,Ey,pE,gE,mE,yE,Y_,wP,xP,bP,Z_,vE,wE,xE,_P,CP,SP,TP,BP,EP,kP,bE,_E,J_,CE;(function(n){n[n.None=0]="None",n[n.First=1]="First",n[n.Second=2]="Second",n[n.Third=4]="Third",n[n.Fourth=8]="Fourth"})(Dh||(Dh={}));let Cde=class extends pa{constructor(e,t,i,r,s){super("3DFACE","AcDbFace",s),this.firstCorner=e,this.secondCorner=t,this.thirdCorner=i,this.fourthCorner=r,this.invisibleEdges=(s==null?void 0:s.invisibleEdges)||Dh.None}setFirstEdgeVisible(e){this.setEdgeVisible(Dh.First,e)}setSecondEdgeVisible(e){this.setEdgeVisible(Dh.Second,e)}setThirdEdgeVisible(e){this.setEdgeVisible(Dh.Third,e)}setFourthEdgeVisible(e){this.setEdgeVisible(Dh.Fourth,e)}setEdgesVisible(e){this.invisibleEdges=e?Dh.None:Dh.First|Dh.Second|Dh.Third|Dh.Fourth}setEdgeVisible(e,t){t?this.invisibleEdges|=e:this.invisibleEdges===(this.invisibleEdges|e)&&(this.invisibleEdges^=e)}boundingBox(){return No.verticesBBox([this.firstCorner,this.secondCorner,this.thirdCorner,this.fourthCorner])}dxfyChild(e){e.point3d(this.firstCorner),e.point3d(this.secondCorner,1),e.point3d(this.thirdCorner,2),e.point3d(this.fourthCorner,3),e.push(70,this.invisibleEdges)}};(function(n){n.SOLID="SOLID",n.ANGLE="ANGLE",n.ANSI31="ANSI31",n.ANSI32="ANSI32",n.ANSI33="ANSI33",n.ANSI34="ANSI34",n.ANSI35="ANSI35",n.ANSI36="ANSI36",n.ANSI37="ANSI37",n.ANSI38="ANSI38",n.AR_B816="AR_B816",n.AR_B816C="AR_B816C",n.AR_B88="AR_B88",n.AR_BRELM="AR_BRELM",n.AR_BRSTD="AR_BRSTD",n.AR_CONC="AR_CONC",n.AR_HBONE="AR_HBONE",n.AR_PARQ1="AR_PARQ1",n.AR_RROOF="AR_RROOF",n.AR_RSHKE="AR_RSHKE",n.AR_SAND="AR_SAND",n.BOX="BOX",n.BRASS="BRASS",n.BRICK="BRICK",n.BRSTONE="BRSTONE",n.CLAY="CLAY",n.CORK="CORK",n.CROSS="CROSS",n.DASH="DASH",n.DOLMIT="DOLMIT",n.DOTS="DOTS",n.EARTH="EARTH",n.ESCHER="ESCHER",n.FLEX="FLEX",n.GOST_GLASS="GOST_GLASS",n.GOST_WOOD="GOST_WOOD",n.GOST_GROUND="GOST_GROUND",n.GRASS="GRASS",n.GRATE="GRATE",n.GRAVEL="GRAVEL",n.HEX="HEX",n.HONEY="HONEY",n.HOUND="HOUND",n.INSUL="INSUL",n.ACAD_ISO02W100="ACAD_ISO02W100",n.ACAD_ISO03W100="ACAD_ISO03W100",n.ACAD_ISO04W100="ACAD_ISO04W100",n.ACAD_ISO05W100="ACAD_ISO05W100",n.ACAD_ISO06W100="ACAD_ISO06W100",n.ACAD_ISO07W100="ACAD_ISO07W100",n.ACAD_ISO08W100="ACAD_ISO08W100",n.ACAD_ISO09W100="ACAD_ISO09W100",n.ACAD_ISO10W100="ACAD_ISO10W100",n.ACAD_ISO11W100="ACAD_ISO11W100",n.ACAD_ISO12W100="ACAD_ISO12W100",n.ACAD_ISO13W100="ACAD_ISO13W100",n.ACAD_ISO14W100="ACAD_ISO14W100",n.ACAD_ISO15W100="ACAD_ISO15W100",n.JIS_LC_20="JIS_LC_20",n.JIS_LC_20A="JIS_LC_20A",n.JIS_LC_8="JIS_LC_8",n.JIS_LC_8A="JIS_LC_8A",n.JIS_RC_10="JIS_RC_10",n.JIS_RC_15="JIS_RC_15",n.JIS_RC_18="JIS_RC_18",n.JIS_RC_30="JIS_RC_30",n.JIS_STN_1E="JIS_STN_1E",n.JIS_STN_2_5="JIS_STN_2_5",n.JIS_WOOD="JIS_WOOD",n.LINE="LINE",n.MUDST="MUDST",n.NET="NET",n.NET3="NET3",n.PLAST="PLAST",n.PLASTI="PLASTI",n.SACNCR="SACNCR",n.SQUARE="SQUARE",n.STARS="STARS",n.STEEL="STEEL",n.SWAMP="SWAMP",n.TRANS="TRANS",n.TRIANG="TRIANG",n.ZIGZAG="ZIGZAG"})(K_||(K_={})),(function(n){n[n.UserDefined=0]="UserDefined",n[n.Predifined=1]="Predifined",n[n.Custom=2]="Custom"})(uE||(uE={}));(function(n){n[n.Default=0]="Default",n[n.External=1]="External",n[n.Polyline=2]="Polyline",n[n.Derived=4]="Derived",n[n.Textbox=8]="Textbox",n[n.Outermost=16]="Outermost"})(vP||(vP={}));(function(n){n[n.SolidFill=1]="SolidFill",n[n.PatternFill=0]="PatternFill"})(By||(By={})),(function(n){n[n.NonAssociative=0]="NonAssociative",n[n.Associative=1]="Associative"})(dE||(dE={})),(function(n){n[n.Normal=0]="Normal",n[n.Outer=1]="Outer",n[n.Ignore=2]="Ignore"})(AE||(AE={})),(function(n){n.LINEAR="LINEAR",n.CYLINDER="CYLINDER",n.INVCYLINDER="INVCYLINDER",n.SPHERICAL="SPHERICAL",n.HEMISPHERICAL="HEMISPHERICAL",n.CURVED="CURVED",n.INVSPHERICAL="SPHERICAL",n.INVHEMISPHERICAL="INVHEMISPHERICAL",n.INVCURVED="INVCURVED"})(fE||(fE={}));let Sde=class extends pa{get patternName(){let e=K_.SOLID;return this.isPattern(this.fill)&&(e=this.fill.name),e}get solidFillFlag(){return this.patternName===K_.SOLID?By.SolidFill:By.PatternFill}constructor(e,t,i){super("HATCH","AcDbHatch",i),this.fill=t,this.elevation=(i==null?void 0:i.elevation)||0,this.extrusion=(i==null?void 0:i.extrusion)||wt(0,0,1),this.boundaryPath=e}pattern(e,t){var i;const r=t.name,s=(i=t.angle)!==null&&i!==void 0?i:0,o=t.scale||1,a=t.double||!1;e.push(52,s),e.push(41,o),e.push(77,Number(a));const c=Jn.get(r);c&&(c.scale=o,s!==0&&(c.angle=s),c.dxfy(e))}gradient(e,t){var i,r,s;const o=t.firstColor,a=(i=t.secondColor)!==null&&i!==void 0?i:7,c=(r=t.angle)!==null&&r!==void 0?r:0,h=t.definition||0,u=(s=t.tint)!==null&&s!==void 0?s:1,d=t.type||fE.LINEAR;e.push(450,1),e.push(451,0),e.push(460,c),e.push(461,h),e.push(452,t.secondColor?0:1),e.push(462,u),e.push(453,2),e.push(463,0),e.push(63,o),e.push(421,mP.fromHex(Yj(o))),e.push(463,1),e.push(63,a),e.push(421,mP.fromHex(Yj(a))),e.push(470,d)}isPattern(e){return"name"in e}boundingBox(){return No.pointBBox(wt(0,0))}dxfyChild(e){var t,i,r;e.point3d(wt(0,0,this.elevation)),e.push(210,(t=this.extrusion)===null||t===void 0?void 0:t.x),e.push(220,(i=this.extrusion)===null||i===void 0?void 0:i.y),e.push(230,(r=this.extrusion)===null||r===void 0?void 0:r.z),e.name(this.patternName),e.push(70,this.solidFillFlag),e.push(71,dE.NonAssociative),e.push(91,this.boundaryPath.length),this.boundaryPath.dxfy(e),e.push(75,AE.Outer),e.push(76,uE.Predifined),this.isPattern(this.fill)?(this.solidFillFlag===By.PatternFill&&this.pattern(e,this.fill),e.push(47,1),e.push(98,0)):(e.push(47,1),e.push(98,0),this.gradient(e,this.fill))}};(function(n){n[n.ShowImage=1]="ShowImage",n[n.ShowImageWhenNotAlignedWithScreen=2]="ShowImageWhenNotAlignedWithScreen",n[n.UseClippingBoundary=4]="UseClippingBoundary",n[n.TransparencyIsOn=8]="TransparencyIsOn"})(q_||(q_={})),(function(n){n[n.Rectangular=1]="Rectangular",n[n.Polygonal=2]="Polygonal"})(Ey||(Ey={})),(function(n){n[n.Off=0]="Off",n[n.On=1]="On"})(pE||(pE={})),(function(n){n[n.Outside=0]="Outside",n[n.Inside=1]="Inside"})(gE||(gE={}));let Tde=class extends pa{constructor(e,t){super("IMAGE","AcDbRasterImage",t),qd.set(this,void 0),this.width=e.width,this.height=e.height,this.scale=e.scale,this.rotation=e.rotation,this.insertionPoint=e.insertionPoint,this.ratio=this.scale/this.width,this.imageDefHandle=e.imageDefHandle,this.imageDisplayFlags=(t==null?void 0:t.imageDisplayFlags)||q_.ShowImage|q_.ShowImageWhenNotAlignedWithScreen,this.clippingStateFlag=(t==null?void 0:t.clippingStateFlag)||pE.On,this.clipModeFlag=(t==null?void 0:t.clipModeFlag)||gE.Inside,this.clippingType=(t==null?void 0:t.clippingType)||Ey.Rectangular,this.brightness=(t==null?void 0:t.brightness)||50,this.contrast=(t==null?void 0:t.brightness)||50,this.fade=(t==null?void 0:t.fade)||0,G2(this,qd,[]),this.classVersion=(t==null?void 0:t.classVersion)||0,this.resetClipping()}setClipBoundaryVerticies(e,t){if(t===Ey.Rectangular){if(e.length!=2)throw new Error("The number of vertices should be 2 in rectangular clipping !");G2(this,qd,e)}else{if(!(e.length>=3))throw new Error("The number of vertices should be >= 3 in polygonal clipping !");G2(this,qd,e)}G2(this,qd,[]),Os(this,qd,"f").push(...e)}resetClipping(){const e=[To(-.5,-.5),To(this.width-.5,this.height-.5)];this.setClipBoundaryVerticies(e,Ey.Rectangular)}_vector(){return To(this.ratio*Math.cos(this.rotation*Math.PI/180),this.ratio*Math.sin(this.rotation*Math.PI/180))}_uVector(){const e=this._vector();return wt(e.x,-e.y,0)}_vVector(){const e=this._vector();return wt(e.y,e.x,0)}boundingBox(){const e=this.scale,t=this.width/this.height*this.scale,i=Math.sqrt(Math.pow(e,2)+Math.pow(t,2));return No.centerRadiusBBox(this.insertionPoint,i)}dxfyChild(e){e.push(90,this.classVersion),e.point3d(this.insertionPoint),e.point3d(this._uVector(),1),e.point3d(this._vVector(),2),e.push(13,this.width),e.push(23,this.height),e.push(340,this.imageDefHandle),e.push(70,this.imageDisplayFlags),e.push(280,this.clippingStateFlag),e.push(281,this.brightness),e.push(282,this.contrast),e.push(283,this.fade),e.push(360,this.imageDefReactorHandle),e.push(71,this.clippingType),e.push(91,Os(this,qd,"f").length),Os(this,qd,"f").forEach((t=>e.point2d(t,4))),e.push(290,this.clipModeFlag)}};qd=new WeakMap;let Bde=class extends pa{constructor(e,t,i){var r,s,o,a,c,h;super("INSERT","AcDbBlockReference",i),this.blockName=e,this.insertionPoint=t,this.scaleFactor=(i==null?void 0:i.scaleFactor)||wt(1,1,1),this.rotationAngle=(r=i==null?void 0:i.rotationAngle)!==null&&r!==void 0?r:0,this.columnCount=(s=i==null?void 0:i.columnCount)!==null&&s!==void 0?s:1,this.rowCount=(o=i==null?void 0:i.rowCount)!==null&&o!==void 0?o:1,this.columnSpacing=(a=i==null?void 0:i.columnSpacing)!==null&&a!==void 0?a:0,this.rowSpacing=(c=i==null?void 0:i.rowSpacing)!==null&&c!==void 0?c:0,this.attributesFollowFlag=(h=i==null?void 0:i.rowSpacing)!==null&&h!==void 0?h:0}boundingBox(){return No.pointBBox(this.insertionPoint)}dxfyChild(e){e.name(this.blockName),e.point3d(this.insertionPoint),e.push(41,this.scaleFactor.x),e.push(42,this.scaleFactor.y),e.push(43,this.scaleFactor.z),e.push(50,this.rotationAngle),e.push(66,this.attributesFollowFlag),e.push(70,this.columnCount),e.push(71,this.rowCount),e.push(44,this.columnSpacing),e.push(45,this.rowSpacing)}};(function(n){n[n.Disabed=0]="Disabed",n[n.Enabled=1]="Enabled"})(mE||(mE={})),(function(n){n[n.StraightLine=0]="StraightLine",n[n.Spline=1]="Spline"})(yE||(yE={}));let Ede=class extends pa{constructor(e,t){var i,r;super("LEADER","AcDbLeader",t),this.vertices=e,this.flag=(i=t==null?void 0:t.flag)!==null&&i!==void 0?i:mE.Enabled,this.leaderPathType=(r=t==null?void 0:t.leaderPathType)!==null&&r!==void 0?r:yE.StraightLine,this.dimensionStyleName=(t==null?void 0:t.dimensionStyleName)||"Standard"}boundingBox(){return No.verticesBBox(this.vertices)}dxfyChild(e){e.push(3,this.dimensionStyleName),e.push(71,this.flag),e.push(72,this.leaderPathType),e.push(76,this.vertices.length),this.vertices.forEach((t=>e.point3d(t)))}},kde=class extends pa{constructor(e,t,i){super("LINE","AcDbLine",i),this.startPoint=e,this.endPoint=t}boundingBox(){return No.lineBBox(this.startPoint,this.endPoint)}dxfyChild(e){e.point3d(this.startPoint),e.point3d(this.endPoint,1)}};(function(n){n[n.None=0]="None",n[n.Closed=1]="Closed",n[n.Plinegen=128]="Plinegen"})(Y_||(Y_={}));let Ide=class extends pa{constructor(e,t){super("LWPOLYLINE","AcDbPolyline",t),this.vertices=e,this.flags=(t==null?void 0:t.flags)||Y_.None,this.constantWidth=(t==null?void 0:t.constantWidth)||0,this.elevation=(t==null?void 0:t.elevation)||0,this.thickness=(t==null?void 0:t.thickness)||0}boundingBox(){return No.verticesBBox(this.vertices.map((e=>wt(e.point.x,e.point.y,0))))}dxfyChild(e){var t,i,r;e.push(90,this.vertices.length),e.push(70,this.flags||0),this.vertices.find((s=>{var o,a;return((o=s.startingWidth)!==null&&o!==void 0?o:0)>0&&((a=s.endWidth)!==null&&a!==void 0?a:0)>0}))||e.push(43,this.constantWidth),e.elevation(this.elevation),e.thickness(this.thickness);for(const s of this.vertices)e.point2d(s.point),e.push(40,s.startingWidth),e.push(41,s.endWidth),e.push(42,s.bulge);e.push(210,(t=this.extrusion)===null||t===void 0?void 0:t.x),e.push(220,(i=this.extrusion)===null||i===void 0?void 0:i.y),e.push(230,(r=this.extrusion)===null||r===void 0?void 0:r.z)}};(function(n){n[n.TopLeft=1]="TopLeft",n[n.TopCenter=2]="TopCenter",n[n.TopRight=3]="TopRight",n[n.MiddleLeft=4]="MiddleLeft",n[n.MiddleCenter=5]="MiddleCenter",n[n.MiddleRight=6]="MiddleRight",n[n.BottomLeft=7]="BottomLeft",n[n.BottomCenter=8]="BottomCenter",n[n.BottomRight=9]="BottomRight"})(wP||(wP={})),(function(n){n[n.LeftToRight=1]="LeftToRight",n[n.TopToBottom=3]="TopToBottom",n[n.ByStyle=5]="ByStyle"})(xP||(xP={})),(function(n){n[n.AtLeast=1]="AtLeast",n[n.Exact=2]="Exact"})(bP||(bP={}));let Fde=class extends pa{constructor(e,t,i,r){super("MTEXT","AcDbMText",r),this.position=e,this.height=t,this.value=i,this.textStyle="STANDARD",this.rotation=r==null?void 0:r.rotation,this.attachmentPoint=r==null?void 0:r.attachmentPoint,this.drawingDirection=r==null?void 0:r.drawingDirection,this.lineSpacingStyle=r==null?void 0:r.lineSpacingStyle,this.width=r==null?void 0:r.width}boundingBox(){return No.pointBBox(this.position)}dxfyChild(e){e.point3d(this.position),e.push(40,this.height),e.push(41,this.width),e.push(71,this.attachmentPoint),e.push(72,this.drawingDirection),e.push(73,this.lineSpacingStyle),e.primaryText(this.value),e.push(50,this.rotation),e.textStyle(this.textStyle)}},Dde=class extends pa{constructor(e,t,i,r){super("POINT","AcDbPoint",r),this.x=e,this.y=t,this.z=i}boundingBox(){return No.pointBBox(wt(this.x,this.y,this.z))}dxfyChild(e){e.point3d(wt(this.x,this.y,this.z))}};(function(n){n[n.None=0]="None",n[n.ExtraVertex=1]="ExtraVertex",n[n.CurveFit=2]="CurveFit",n[n.NotUsed=4]="NotUsed",n[n.SplineVertex=8]="SplineVertex",n[n.SplineFrame=16]="SplineFrame",n[n.Polyline3dVertex=32]="Polyline3dVertex",n[n.Polygon3dMesh=64]="Polygon3dMesh",n[n.PolyfaceMeshVertex=128]="PolyfaceMeshVertex"})(Z_||(Z_={}));let jde=class extends pa{constructor(e,t){var i;super("VERTEX","AcDbVertex",t),this.point=e,this.flags=(i=t==null?void 0:t.flags)!==null&&i!==void 0?i:Z_.None,t&&("startingWidth"in t&&(this.startingWidth=t.startingWidth),"endWidth"in t&&(this.endWidth=t.endWidth),"bulge"in t&&(this.bulge=t.bulge))}boundingBox(){return No.pointBBox(this.point)}dxfyChild(e){e.subclassMarker("AcDb3dPolylineVertex"),e.point3d(this.point),e.push(40,this.startingWidth),e.push(41,this.endWidth),e.push(42,this.bulge),e.push(70,this.flags)}},O$=class extends pa{dxfyChild(e){}constructor(){super("SEQEND")}};(function(n){n[n.None=0]="None",n[n.Closed=1]="Closed",n[n.CurveFit=2]="CurveFit",n[n.SplineFit=4]="SplineFit",n[n.Polyline3D=8]="Polyline3D",n[n.PolygonMesh3D=16]="PolygonMesh3D",n[n.PolygonMeshClosed=32]="PolygonMeshClosed",n[n.PolyfaceMesh=64]="PolyfaceMesh",n[n.LinetypeGenerated=128]="LinetypeGenerated"})(vE||(vE={})),(function(n){n[n.NoSmooth=0]="NoSmooth",n[n.QuadraticBSpline=5]="QuadraticBSpline",n[n.CubicBSpline=6]="CubicBSpline",n[n.Bezier=8]="Bezier"})(wE||(wE={}));let Pde=class extends pa{constructor(e,t){var i,r,s,o,a,c,h,u,d,f;super("POLYLINE","AcDb3dPolyline",t),this._seqend=new O$,this.vertices=[],this.thickness=(i=t==null?void 0:t.thickness)!==null&&i!==void 0?i:0,this.elevation=(r=t==null?void 0:t.elevation)!==null&&r!==void 0?r:0,this.flags=(s=t==null?void 0:t.flags)!==null&&s!==void 0?s:vE.None,this.defaultStartWidth=(o=t==null?void 0:t.defaultStartWidth)!==null&&o!==void 0?o:0,this.defaultEndWidth=(a=t==null?void 0:t.defaultEndWidth)!==null&&a!==void 0?a:0,this.polygonMeshM=(c=t==null?void 0:t.polygonMeshM)!==null&&c!==void 0?c:0,this.polygonMeshN=(h=t==null?void 0:t.polygonMeshN)!==null&&h!==void 0?h:0,this.smoothSurfaceM=(u=t==null?void 0:t.smoothSurfaceM)!==null&&u!==void 0?u:0,this.smoothSurfaceN=(d=t==null?void 0:t.smoothSurfaceN)!==null&&d!==void 0?d:0,this.surfaceType=(f=t==null?void 0:t.surfaceType)!==null&&f!==void 0?f:wE.NoSmooth,e.forEach((A=>this.vertices.push(new jde(A.point,{startingWidth:A.startingWidth,endWidth:A.endWidth,bulge:A.bulge,flags:Z_.Polyline3dVertex}))))}boundingBox(){return No.verticesBBox(this.vertices.map((e=>e.point)))}dxfyChild(e){e.push(66,1),e.point3d(wt(0,0,this.elevation)),e.push(39,this.thickness),e.push(70,this.flags),e.push(40,this.defaultStartWidth),e.push(41,this.defaultEndWidth),e.push(71,this.polygonMeshM),e.push(72,this.polygonMeshN),e.push(73,this.smoothSurfaceM),e.push(74,this.smoothSurfaceN),e.push(75,this.surfaceType),this.vertices.forEach((t=>t.dxfy(e))),this._seqend.dxfy(e)}};(function(n){n[n.Closed=1]="Closed",n[n.Periodic=2]="Periodic",n[n.Rational=4]="Rational",n[n.Planar=8]="Planar",n[n.Linear=16]="Linear"})(xE||(xE={}));let Nde=class extends pa{constructor(e,t){var i,r;super("SPLINE","AcDbSpline",t),this.controlPoints=e.controlPoints,this.degreeCurve=(i=e.degreeCurve)!==null&&i!==void 0?i:3,this.flags=(r=e.flags)!==null&&r!==void 0?r:xE.Planar,this.knots=e.knots||[],this.weights=e.weights||[],this.fitPoints=e.fitPoints||[];const s=this.controlPoints.length,o=this.degreeCurve,a=o+1,c=this.fitPoints.length;if(s<a)throw new Error(`Number of control points should be >= ${a}.`);if(c!==0&&c<2)throw new Error("Number of fit points should be >= 2.");const h=o+s+1;if(this.knots.length===0){let u=0;for(let d=0;d<h;d++)d<=o||d>=s+1?this.knots.push(u):this.knots.push(++u)}if(this.knots.length!==h)throw new Error(`Number of knots should be ${h}.`)}boundingBox(){return No.verticesBBox([...this.controlPoints,...this.fitPoints])}dxfyChild(e){e.push(70,this.flags),e.push(71,this.degreeCurve),e.push(72,this.knots.length),e.push(73,this.controlPoints.length),e.push(74,this.fitPoints.length),e.push(42,"0.0000001"),e.push(43,"0.0000001"),e.push(42,"0.0000000001"),this.knots.forEach((t=>e.push(40,t))),this.weights.forEach((t=>e.push(41,t))),this.controlPoints.forEach((t=>e.point3d(t))),this.fitPoints.forEach((t=>e.point3d(t,1)))}};(function(n){n[n.Text=1]="Text",n[n.Block=2]="Block"})(_P||(_P={})),(function(n){n[n.False=0]="False",n[n.True=1]="True"})(CP||(CP={})),(function(n){n[n.False=0]="False",n[n.True=1]="True"})(SP||(SP={})),(function(n){n[n.TopLeft=1]="TopLeft",n[n.TopCenter=2]="TopCenter",n[n.TopRight=3]="TopRight",n[n.MiddleLeft=4]="MiddleLeft",n[n.MiddleCenter=5]="MiddleCenter",n[n.MiddleRight=6]="MiddleRight",n[n.BottomLeft=7]="BottomLeft",n[n.BottomCenter=8]="BottomCenter",n[n.BottomRight=9]="BottomRight"})(TP||(TP={}));let Lde=class extends pa{constructor(e,t,i,r,s,o,a){super("ACAD_TABLE","AcDbBlockReference",a),this.blockName=e,this.position=t,this.numberOfRows=i,this.numberOfColumn=r,this.rowsHeight=s,this.columnsHeight=o,this.horizontalDirectionVector=(a==null?void 0:a.horizontalDirectionVector)||wt(1),this.cells=a==null?void 0:a.cell}boundingBox(){return No.pointBBox(this.position)}dxfyChild(e){var t,i,r,s;e.name(this.blockName),e.point3d(this.position),e.subclassMarker("AcDbTable"),e.point3d(this.horizontalDirectionVector,1),e.push(91,this.numberOfRows),e.push(92,this.numberOfColumn);for(let o=0;o<this.numberOfRows;o++)e.push(141,(i=(t=this.rowsHeight[o])!==null&&t!==void 0?t:this.rowsHeight[0])!==null&&i!==void 0?i:1);for(let o=0;o<this.numberOfColumn;o++)e.push(142,(s=(r=this.columnsHeight[o])!==null&&r!==void 0?r:this.columnsHeight[0])!==null&&s!==void 0?s:1);this.cells.forEach((o=>o.dxfy(e)))}};(function(n){n[n.None=0]="None",n[n.Backward=2]="Backward",n[n.UpsideDown=4]="UpsideDown"})(BP||(BP={})),(function(n){n[n.Left=0]="Left",n[n.Center=1]="Center",n[n.Right=2]="Right",n[n.Aligned=3]="Aligned",n[n.Middle=4]="Middle",n[n.Fit=5]="Fit"})(EP||(EP={})),(function(n){n[n.BaseLine=0]="BaseLine",n[n.Bottom=1]="Bottom",n[n.Middle=2]="Middle",n[n.Top=3]="Top"})(kP||(kP={}));let Mde=class extends pa{constructor(e,t,i,r){super("TEXT","AcDbText",r),this.position=e,this.height=t,this.value=i,this.textStyle="STANDARD",this.rotation=r==null?void 0:r.rotation,this.obliqueAngle=r==null?void 0:r.obliqueAngle,this.generationFlags=r==null?void 0:r.generationFlags,this.horizontalAlignment=r==null?void 0:r.horizontalAlignment,this.verticalAlignment=r==null?void 0:r.verticalAlignment,this.secondAlignmentPoint=r==null?void 0:r.secondAlignmentPoint,this.relativeXScaleFactor=r==null?void 0:r.relativeXScaleFactor}boundingBox(){return No.pointBBox(this.position)}dxfyChild(e){e.point3d(this.position),e.push(40,this.height),e.primaryText(this.value),e.push(50,this.rotation),e.push(41,this.relativeXScaleFactor),e.push(51,this.obliqueAngle),e.textStyle(this.textStyle),e.push(71,this.generationFlags),e.push(72,this.horizontalAlignment),e.point3d(this.secondAlignmentPoint,1),e.subclassMarker("AcDbText"),e.push(73,this.verticalAlignment)}},Rde=class{constructor(e,t,i){this.entities=[],this.handle=bd.next(),this.objects=e,this.blockRecord=t,this.layerName=i}dxfy(e){for(const t of this.entities)t.dxfy(e)}addHatch(e,t,i){const r=new Sde(e,t,i);return this.addEntity(r)}addEntity(e){return e.ownerBlockRecord=this.blockRecord.handle,this.blockRecord.isPaperSpace&&(e.inPaperSpace=!0),e.layerName==null&&(e.layerName=this.layerName),this.entities.push(e),e}addAttrib(e,t,i,r,s,o){s.attributesFollowFlag=1;const a=this.addEntity(new xde(e,t,i,r,o));return this.addEntity(new O$).ownerBlockRecord=s.handle,a}addAttdef(e,t,i,r,s){return this.addEntity(new wde(e,t,i,r,s))}addAlignedDim(e,t,i){return this.addEntity(new Ade(e,t,i))}addDiameterDim(e,t,i){return this.addEntity(new gde(e,t,i))}addRadialDim(e,t,i){return this.addEntity(new yde(e,t,i))}addLinearDim(e,t,i){return this.addEntity(new mde(e,t,i))}addAngularLinesDim(e,t,i,r){return this.addEntity(new fde(e,t,i,r))}addAngularPointsDim(e,t,i,r){return this.addEntity(new pde(e,t,i,r))}addLine(e,t,i){return this.addEntity(new kde(e,t,i))}addLeader(e,t){return this.addEntity(new Ede(e,t))}addLWPolyline(e,t){return this.addEntity(new Ide(e,t))}addRectangle(e,t,i){const r=[],s=e.x,o=e.y,a=t.x,c=t.y;if((i==null?void 0:i.fillet)!==void 0&&(i==null?void 0:i.chamfer)!==void 0)throw new Error("You cannot define both fillet and chamfer!");if((i==null?void 0:i.fillet)!==void 0){const h=i==null?void 0:i.fillet,u=ode(h);r.push({point:To(s,o-h),bulge:u}),r.push({point:To(s+h,o)}),r.push({point:To(a-h,o),bulge:u}),r.push({point:To(a,o-h)}),r.push({point:To(a,c+h),bulge:u}),r.push({point:To(a-h,c)}),r.push({point:To(s+h,c),bulge:u}),r.push({point:To(s,c+h)})}else if((i==null?void 0:i.chamfer)!==void 0){const h=i==null?void 0:i.chamfer.first,u=(i==null?void 0:i.chamfer.second)||h;r.push({point:To(s,o-h)}),r.push({point:To(s+u,o)}),r.push({point:To(a-h,o)}),r.push({point:To(a,o-u)}),r.push({point:To(a,c+h)}),r.push({point:To(a-u,c)}),r.push({point:To(s+h,c)}),r.push({point:To(s,c+u)})}else r.push({point:To(s,o)}),r.push({point:To(a,o)}),r.push({point:To(a,c)}),r.push({point:To(s,c)});return this.addLWPolyline(r,Object.assign(Object.assign({},i),{flags:Y_.Closed}))}addImage(e,t,i,r,s,o,a,c){const h=this.objects.addImageDef(e);h.width=r,h.height=s;const u=new Tde({height:s,width:r,scale:o,rotation:a,insertionPoint:i,imageDefHandle:h.handle},c),d=this.objects.addImageDefReactor(u.handle);u.imageDefReactorHandle=d.handle,this.addEntity(u);const f=this.objects.addDictionary();return f.addEntryObject(t,h.handle),h.ownerObjecthandle=f.handle,this.objects.root.addEntryObject("ACAD_IMAGE_DICT",f.handle),h.acadImageDictHandle=f.handle,h.addImageDefReactorHandle(d.handle),u}addPolyline3D(e,t){return this.addEntity(new Pde(e,t))}addPoint(e,t,i,r){return this.addEntity(new Dde(e,t,i,r))}addCircle(e,t,i){return this.addEntity(new bde(e,t,i))}addArc(e,t,i,r,s){return this.addEntity(new vde(e,t,i,r,s))}addSpline(e,t){return this.addEntity(new Nde(e,t))}addEllipse(e,t,i,r,s,o){const a=new _de(e,t,i,r,s,o);return this.addEntity(a),a}add3dFace(e,t,i,r,s){return this.addEntity(new Cde(e,t,i,r,s))}addText(e,t,i,r){return this.addEntity(new Mde(e,t,i,r))}addMText(e,t,i,r){return this.addEntity(new Fde(e,t,i,r))}addInsert(e,t,i){return this.addEntity(new Bde(e,t,i||{}))}addTable(e,t,i,r,s,o,a){return this.addEntity(new Lde(e,t,i,r,s,o,a))}boundingBox(){const e=[];for(let t=0;t<this.entities.length;t++)e.push(this.entities[t].boundingBox());return No.boundingBox(e)}centerView(){return No.boundingBoxCenter(this.boundingBox())}viewHeight(){return No.boundingBoxHeight(this.boundingBox())}};(function(n){n[n.None=0]="None",n[n.AnonymousBlock=1]="AnonymousBlock",n[n.HasNonConstantAttribute=2]="HasNonConstantAttribute",n[n.XRef=4]="XRef",n[n.XRefOverlay=8]="XRefOverlay",n[n.ExternallyDependent=16]="ExternallyDependent",n[n.ResolvedXRef=32]="ResolvedXRef",n[n.ReferencedXRef=64]="ReferencedXRef"})(bE||(bE={}));let Ode=class extends Rde{get isPaperSpace(){return this.name.startsWith("*Paper_Space")}get isModelSpace(){return this.name.startsWith("*Model_Space")}get isModelOrPaperSpace(){return this.isModelSpace||this.isPaperSpace}constructor(e,t,i){super(i,t,"0"),this.name=e,this.flags=bE.None,this.endBlk=new ade,this.ownerObjectHandle=t.handle,this.basePoint=wt(0,0,0),this.xrefPathName=""}setLayerName(e){this.layerName=e}dxfy(e){e.type("BLOCK"),e.handle(this.handle),e.push(330,this.ownerObjectHandle),e.subclassMarker("AcDbEntity"),e.layerName(this.layerName),e.subclassMarker("AcDbBlockBegin"),e.name(this.name),e.push(70,this.flags),e.point3d(this.basePoint),e.name(this.name,3),e.push(1,this.xrefPathName),this.isModelSpace||this.name==="*Paper_Space"||super.dxfy(e),this.endBlk.dxfy(e)}},Ude=class{constructor(e,t){this.blocks=[],this.paperSpaceSeed=0,this.tables=e,this.objects=t,this.modelSpace=this.addBlock("*Model_Space",t,!1),this.paperSpace=this.addBlock("*Paper_Space",t,!1)}addBlock(e,t,i=!0){i&&(e=e.replace(X_,""));const r=this.tables.addBlockRecord(e),s=new Ode(e,r,t);return this.blocks.push(s),s}addPaperSpace(){const e="*Paper_Space"+this.paperSpaceSeed++;return this.addBlock(e,this.objects,!1)}dxfy(e){e.start("BLOCKS"),this.blocks.forEach((t=>t.dxfy(e))),e.end()}},Hde=class{dxfy(e){e.start("CLASSES"),e.end()}},Wde=class{constructor(e){this.blocks=e,this.modelSpace=e.modelSpace,this.paperSpace=e.paperSpace}setLayerName(e){this.modelSpace.setLayerName(e)}dxfy(e){e.start("ENTITIES"),this.paperSpace.entities.forEach((t=>t.dxfy(e))),this.modelSpace.entities.forEach((t=>t.dxfy(e))),e.end()}},Qde=class{constructor(e,t){this.values=t,this.name=e}dxfy(e){e.variableName(this.name),Object.entries(this.values).forEach((t=>{const[i,r]=t;e.push(parseInt(i),r)}))}},$de=class{constructor(){this.variables=[]}setVariable(e,t){const i=this.variables.find((r=>r.name===e));i?i.values=t:this.variables.push(new Qde(e,t))}dxfy(e){e.start("HEADER"),this.variables.forEach((t=>t.dxfy(e))),e.end()}},PI=class{constructor(e){this.type=e,this.ownerObjecthandle="0",this.handle=bd.next()}dxfy(e){e.type(this.type),e.handle(this.handle),e.push(330,this.ownerObjecthandle)}},IP=class extends PI{constructor(){super("DICTIONARY"),this.entries=[],this.duplicateRecordCloningFlag=0}addEntryObject(e,t){this.entries.push({name:e,entryObjectHandle:t})}dxfy(e){super.dxfy(e),e.subclassMarker("AcDbDictionary"),e.push(280,this.hardOwnerFlag),e.push(281,this.duplicateRecordCloningFlag);for(const t of this.entries)e.push(3,t.name),e.push(350,t.entryObjectHandle)}};(function(n){n[n.NoUnits=0]="NoUnits",n[n.Centimeters=2]="Centimeters",n[n.Inch=5]="Inch"})(_E||(_E={}));let Vde=class extends PI{constructor(e){super("IMAGEDEF"),this.path=e,this.acadImageDictHandle="",this.imageReactorHandles=[],this.width=1,this.height=1,this.widthPixelSize=1,this.heightPixelSize=1,this.loaded=!0,this.resolutionUnits=_E.NoUnits}addImageDefReactorHandle(e){this.imageReactorHandles.push(e)}dxfy(e){super.dxfy(e);const t=new cde("ACAD_REACTORS");t.add(330,this.acadImageDictHandle);for(const i of this.imageReactorHandles)t.add(330,i);t.dxfy(e),e.subclassMarker("AcDbRasterImageDef"),e.push(1,this.path),e.point2d(To(this.width,this.height)),e.push(11,this.widthPixelSize),e.push(21,this.heightPixelSize),e.push(280,Number(this.loaded)),e.push(281,this.resolutionUnits)}},zde=class extends PI{constructor(e){super("IMAGEDEF_REACTOR"),this.imageHandle=e,this.classVersion=2}dxfy(e){super.dxfy(e),e.subclassMarker("AcDbRasterImageDefReactor"),e.push(90,this.classVersion),e.push(330,this.imageHandle)}},Gde=class{constructor(){this.root=new IP,this.objects=[],this.root.duplicateRecordCloningFlag=1;const e=this.addDictionary();this.root.addEntryObject("ACAD_GROUP",e.handle)}addObject(e){return this.objects.push(e),e}addImageDef(e){return this.addObject(new Vde(e))}addImageDefReactor(e){return this.addObject(new zde(e))}addDictionary(){const e=new IP;return e.ownerObjecthandle=this.root.handle,this.addObject(e),e}addEntryToRoot(e,t){this.root.addEntryObject(e,t)}dxfy(e){e.start("OBJECTS"),this.root.dxfy(e);for(const t of this.objects)t.dxfy(e);e.end(),e.type("EOF")}},FA=class{constructor(e){this.name=e,this.maxNumberEntries=0,this.ownerObjectHandle="0",this.handle=bd.next(),this.records=[]}dxfy(e){e.type("TABLE"),e.name(this.name),e.handle(this.handle),e.push(330,this.ownerObjectHandle),e.subclassMarker("AcDbSymbolTable"),e.push(70,this.records.length);for(const t of this.records)t.dxfy(e);e.type("ENDTAB")}};(function(n){n[n.None=0]="None",n[n.XRefDependent=16]="XRefDependent",n[n.XRefResolved=32]="XRefResolved"})(J_||(J_={}));let Xde=class extends tp{constructor(e,t){super("APPID"),this.name=e,this.flags=t??J_.None}dxfy(e){super.dxfy(e),e.subclassMarker("AcDbRegAppTableRecord"),e.name(this.name),e.push(70,this.flags)}},Kde=class extends tp{get isPaperSpace(){return this.name.startsWith("*Paper_Space")}constructor(e){super("BLOCK_RECORD"),this.name=e,this.insertionUnits=0,this.explodability=1,this.scalability=0}dxfy(e){super.dxfy(e),e.subclassMarker("AcDbBlockTableRecord"),e.name(this.name),e.push(340,this.layoutObject),e.push(70,this.insertionUnits),e.push(280,this.explodability),e.push(281,this.scalability)}};(function(n){n[n.None=0]="None",n[n.XRefDependent=16]="XRefDependent",n[n.XRefRefesolved=32]="XRefRefesolved"})(CE||(CE={}));let qde=class{constructor(e,t){this.name=e,this.flags=t??CE.None,this.handle=bd.next(),this.type="DIMSTYLE"}dxfy(e){e.type(this.type),e.push(105,this.handle),e.push(330,this.ownerObjectHandle),e.subclassMarker("AcDbSymbolTableRecord"),e.subclassMarker("AcDbDimStyleTableRecord"),e.name(this.name),e.push(70,this.flags),e.push(3,this.DIMPOST),e.push(4,this.DIMAPOST),e.push(5,this.DIMBLK),e.push(6,this.DIMBLK1),e.push(7,this.DIMBLK2),e.push(40,this.DIMSCALE),e.push(41,this.DIMASZ),e.push(42,this.DIMEXO),e.push(43,this.DIMDLI),e.push(44,this.DIMEXE),e.push(45,this.DIMRND),e.push(46,this.DIMDLE),e.push(47,this.DIMTP),e.push(48,this.DIMTM),e.push(140,this.DIMTXT),e.push(141,this.DIMCEN),e.push(142,this.DIMTSZ),e.push(143,this.DIMALTF),e.push(144,this.DIMLFAC),e.push(145,this.DIMTVP),e.push(146,this.DIMTFAC),e.push(147,this.DIMGAP),e.push(148,this.DIMALTRND),e.push(71,this.DIMTOL),e.push(72,this.DIMLIM),e.push(73,this.DIMTIH),e.push(74,this.DIMTOH),e.push(75,this.DIMSE1),e.push(76,this.DIMSE2),e.push(77,this.DIMTAD),e.push(78,this.DIMZIN),e.push(79,this.DIMAZIN),e.push(170,this.DIMALT),e.push(171,this.DIMALTD),e.push(172,this.DIMTOFL),e.push(173,this.DIMSAH),e.push(174,this.DIMTIX),e.push(175,this.DIMSOXD),e.push(176,this.DIMCLRD),e.push(177,this.DIMCLRE),e.push(178,this.DIMCLRT),e.push(179,this.DIMADEC),e.push(271,this.DIMDEC),e.push(272,this.DIMTDEC),e.push(273,this.DIMALTU),e.push(274,this.DIMALTTD),e.push(275,this.DIMAUNIT),e.push(276,this.DIMFRAC),e.push(277,this.DIMLUNIT),e.push(278,this.DIMDSEP),e.push(279,this.DIMTMOVE),e.push(280,this.DIMJUST),e.push(281,this.DIMSD1),e.push(282,this.DIMSD2),e.push(283,this.DIMTOLJ),e.push(284,this.DIMTZIN),e.push(285,this.DIMALTZ),e.push(286,this.DIMALTTZ),e.push(287,this.DIMFIT),e.push(288,this.DIMUPT),e.push(289,this.DIMATFIT),e.push(340,this.DIMTXSTY),e.push(341,this.DIMLDRBLK),e.push(342,this.DIMBLK),e.push(343,this.DIMBLK1),e.push(344,this.DIMBLK2),e.push(371,this.DIMLWD),e.push(372,this.DIMLWE)}},Yde=class extends tp{constructor(e,t,i,r){super("LTYPE"),this.name=e,this.descriptive=t,this.elements=i,this.flags=r??0}dxfy(e){super.dxfy(e),e.subclassMarker("AcDbLinetypeTableRecord"),e.name(this.name),e.push(70,this.flags),e.push(3,this.descriptive),e.push(72,65),e.push(73,this.elements.length);let t=0;for(const i of this.elements)t+=Math.abs(i);e.push(40,t);for(const i of this.elements)e.push(49,i),e.push(74,0)}},Zde=class extends tp{constructor(e,t){super("STYLE"),this.fixedTextHeight=0,this.widthFactor=1,this.obliqueAngle=0,this.textGenerationFlag=0,this.lastHeightUsed=1,this.fontFileName="txt",this.bigFontFileName="",this.name=e,this.flags=t??aE.None}dxfy(e){super.dxfy(e),e.subclassMarker("AcDbTextStyleTableRecord"),e.name(this.name),e.push(70,this.flags),e.push(40,this.fixedTextHeight),e.push(41,this.widthFactor),e.push(50,this.obliqueAngle),e.push(71,this.textGenerationFlag),e.push(42,this.lastHeightUsed),e.push(3,this.fontFileName),e.push(4,this.bigFontFileName)}},Jde=class extends tp{constructor(e){super("UCS"),this.name=e}dxfy(e){super.dxfy(e)}},eAe=class extends tp{constructor(e){super("VPORT"),this.name=e,this.viewHeight=200,this.viewCenter=[0,0]}dxfy(e){super.dxfy(e);const[t,i]=this.viewCenter;e.subclassMarker("AcDbViewportTableRecord"),e.name(this.name),e.push(70,0),e.point2d({x:0,y:0}),e.push(11,1),e.push(21,1),e.push(12,t),e.push(22,i),e.push(13,0),e.push(23,0),e.push(14,10),e.push(24,10),e.push(15,10),e.push(25,10),e.push(16,0),e.push(26,0),e.push(36,1),e.push(17,0),e.push(27,0),e.push(37,0),e.push(40,this.viewHeight||200),e.push(41,2),e.push(42,50),e.push(43,0),e.push(44,0),e.push(50,0),e.push(51,0),e.push(71,0),e.push(72,100),e.push(73,1),e.push(74,3),e.push(75,0),e.push(76,1),e.push(77,0),e.push(78,0),e.push(281,0),e.push(65,1),e.push(110,0),e.push(120,0),e.push(130,0),e.push(111,1),e.push(121,0),e.push(131,0),e.push(112,0),e.push(122,1),e.push(132,0),e.push(79,0),e.push(146,0),e.push(348,10020),e.push(60,7),e.push(61,5),e.push(292,1),e.push(282,1),e.push(141,0),e.push(142,0),e.push(63,250),e.push(421,3358443)}},tAe=class extends tp{constructor(e){var t;super("VIEW"),this.name=e.name,this.flags=(t=e.flags)!==null&&t!==void 0?t:lE.None,this.viewHeight=e.viewHeight,this.viewCenter=e.viewCenter,this.viewWidth=e.viewWidth,this.viewDirection=e.viewDirection,this.targetPoint=e.targetPoint,this.lensLength=e.lensLength,this.frontClipping=e.frontClipping,this.backClipping=e.backClipping,this.twistAngle=e.twistAngle,this.viewMode=e.viewMode,this.renderMode=e.renderMode,this.isUCSAssociated=e.isUCSAssociated,this.isCameraPlottable=e.isCameraPlottable||!1,e.backgroundObjectHandle&&(this.backgroundObjectHandle=e.backgroundObjectHandle),e.liveSectionObjectHandle&&(this.liveSectionObjectHandle=e.liveSectionObjectHandle),e.visualStyleObjectHandle&&(this.visualStyleObjectHandle=e.visualStyleObjectHandle)}dxfy(e){super.dxfy(e),e.subclassMarker("AcDbViewTableRecord"),e.name(this.name),e.push(70,this.flags),e.push(40,this.viewHeight),e.point2d(this.viewCenter),e.push(41,this.viewWidth),e.push(11,this.viewDirection.x),e.push(21,this.viewDirection.y),e.push(31,this.viewDirection.z),e.push(12,this.targetPoint.x),e.push(22,this.targetPoint.y),e.push(32,this.targetPoint.z),e.push(42,this.lensLength),e.push(43,this.frontClipping),e.push(44,this.backClipping),e.push(50,this.twistAngle),e.push(71,this.viewMode),e.push(281,this.renderMode),e.push(72,this.isUCSAssociated?1:0),e.push(73,this.isCameraPlottable?1:void 0),e.push(332,this.backgroundObjectHandle),e.push(334,this.liveSectionObjectHandle),e.push(348,this.visualStyleObjectHandle)}},nAe=class extends FA{constructor(){super("APPID")}addAppId(e,t){const i=new Xde(e,t);return i.ownerObjectHandle=this.handle,this.records.push(i),i}},iAe=class extends FA{constructor(){super("BLOCK_RECORD")}addBlockRecord(e){const t=new Kde(e);return t.ownerObjectHandle=this.handle,this.records.push(t),t}},rAe=class extends FA{constructor(){super("DIMSTYLE"),this.ownerObjectHandle="0"}addDimStyle(e,t){const i=new qde(e,t);return i.ownerObjectHandle=this.handle,this.records.push(i),i}dxfy(e){e.type("TABLE"),e.name(this.name),e.handle(this.handle),e.push(330,this.ownerObjectHandle),e.subclassMarker("AcDbSymbolTable"),e.push(70,this.records.length),e.subclassMarker("AcDbDimStyleTable");for(const t of this.records)t.dxfy(e);e.type("ENDTAB")}},sAe=class extends FA{constructor(){super("LTYPE")}exist(e){return this.records.find((t=>t.name===e))!==void 0}ltype(e){return this.records.find((t=>t.name===e))}addLType(e,t,i,r){const s=this.ltype(e);if(s)return s;const o=new Yde(e,t,i,r);return o.ownerObjectHandle=this.handle,this.records.push(o),o}},oAe=class extends FA{constructor(e){super("LAYER"),this.lTypeTable=e}addLayer(e,t,i,r){e=e.replace(X_,"");const s=this.layer(e);if(s)return s;this.lTypeTable.exist(i)||(i=G_.Continuous);const o=new rm(e,t,i,r);return o.ownerObjectHandle=this.handle,this.records.push(o),o}layer(e){return e=e.replace(X_,""),this.records.find((t=>t.name===e))}exist(e){return this.records.find((t=>t.name===e))!==void 0}},aAe=class extends FA{constructor(){super("STYLE")}addStyle(e,t){const i=new Zde(e,t);return i.ownerObjectHandle=this.handle,this.records.push(i),i}},lAe=class extends FA{constructor(){super("UCS")}addUcs(e){const t=new Jde(e);return t.ownerObjectHandle=this.handle,this.records.push(t),t}},cAe=class extends FA{constructor(){super("VPORT")}addViewPort(e){const t=new eAe(e);return t.ownerObjectHandle=this.handle,this.records.push(t),t}},hAe=class extends FA{constructor(){super("VIEW")}addView(e){const t=new tAe(e);return t.ownerObjectHandle=this.handle,this.records.push(t),t}},uAe=class{constructor(){this.vPortTable=new cAe,this.ltypeTable=new sAe,this.layerTable=new oAe(this.ltypeTable),this.styleTable=new aAe,this.viewTable=new hAe,this.ucsTable=new lAe,this.appIdTable=new nAe,this.dimStyleTable=new rAe,this.blockRecordTable=new iAe}layer(e){return this.layerTable.layer(e)}addLType(e,t,i,r){return this.ltypeTable.addLType(e,t,i,r)}addBlockRecord(e){return this.blockRecordTable.addBlockRecord(e)}addLayer(e,t,i,r){return this.layerTable.addLayer(e,t,i,r)}addStyle(e){return this.styleTable.addStyle(e)}addView(e){return this.viewTable.addView(e)}addUcs(e){return this.ucsTable.addUcs(e)}addAppId(e,t){return this.appIdTable.addAppId(e,t)}addDimStyle(e,t){return this.dimStyleTable.addDimStyle(e,t)}addVPort(e){return this.vPortTable.addViewPort(e)}dxfy(e){e.start("TABLES"),this.vPortTable.dxfy(e),this.ltypeTable.dxfy(e),this.layerTable.dxfy(e),this.styleTable.dxfy(e),this.viewTable.dxfy(e),this.ucsTable.dxfy(e),this.appIdTable.dxfy(e),this.dimStyleTable.dxfy(e),this.blockRecordTable.dxfy(e),e.end()}},dAe=class{constructor(){bd.clear(),this.header=new $de,this.classes=new Hde,this.tables=new uAe,this.objects=new Gde,this.blocks=new Ude(this.tables,this.objects),this.entities=new Wde(this.blocks),this.currentLayerName=rm.layerZeroName,this.currentUnits=z_.Unitless,this.header.setVariable("$ACADVER",{1:"AC1021"}),this.header.setVariable("$LASTSAVEDBY",{1:"@tarikjabiri/dxf"}),this._handseed(),this.setUnits(z_.Unitless),this.tables.addLType("ByBlock","",[]),this.tables.addLType("ByLayer","",[]);const e=this.tables.addLType("Continuous","Solid line",[]);this.tables.addLayer(rm.layerZeroName,cE.White,e.name),this.styleStandard=this.tables.addStyle("Standard"),this.tables.addAppId("ACAD",J_.None),this.dimStyleStandard=this.tables.addDimStyle("Standard"),this.dimStyleStandard.DIMTXSTY=this.styleStandard.handle,this.activeVPort=this.tables.addVPort("*Active"),this.modelSpace=this.blocks.modelSpace,this.paperSpace=this.blocks.paperSpace,this.setZeroLayerAsCurrent()}dxfy(e){this.header.dxfy(e),this.classes.dxfy(e),this.tables.dxfy(e),this.blocks.dxfy(e),this.entities.dxfy(e),this.objects.dxfy(e)}addBlock(e){return this.blocks.addBlock(e,this.objects)}setZeroLayerAsCurrent(){this.setCurrentLayerName(rm.layerZeroName)}setCurrentLayerName(e){this.currentLayerName=e.replace(X_,""),this.entities.setLayerName(this.currentLayerName),this.setCLayerVariable()}_handseed(){this.header.setVariable("$HANDSEED",{5:bd.peek()})}setUnits(e){this.currentUnits=e,this.header.setVariable("$INSUNITS",{70:this.currentUnits})}setCLayerVariable(){this.header.setVariable("$CLAYER",{8:this.currentLayerName})}setViewCenter(e){this.header.setVariable("$VIEWCTR",{10:e.x,20:e.y}),this.activeVPort.viewCenter=[e.x,e.y]}stringify(){const e=new hde;return this._handseed(),this.setViewCenter(this.modelSpace.centerView()),this.activeVPort.viewHeight=this.modelSpace.viewHeight(),this.dxfy(e),e.stringify()}},AAe=class{get header(){return this.document.header}get tables(){return this.document.tables}get blocks(){return this.document.blocks}get entities(){return this.document.entities}get currentLayer(){return this.document.currentLayerName}get units(){return this.document.currentUnits}get modelSpace(){return this.document.modelSpace}constructor(){this.document=new dAe}layer(e){return this.tables.layer(e)}setZeroLayerAsCurrent(){this.document.setZeroLayerAsCurrent()}addBlock(e){return this.blocks.addBlock(e,this.document.objects)}addPaperSpace(){return this.blocks.addPaperSpace()}setVariable(e,t){this.header.setVariable(e,t)}addLType(e,t,i){return this.tables.addLType(e,t,i)}addDimStyle(e){return this.tables.addDimStyle(e)}addAlignedDim(e,t,i){return this.modelSpace.addAlignedDim(e,t,i)}addDiameterDim(e,t,i){return this.modelSpace.addDiameterDim(e,t,i)}addRadialDim(e,t,i){return this.modelSpace.addRadialDim(e,t,i)}addLinearDim(e,t,i){return this.modelSpace.addLinearDim(e,t,i)}addAngularLinesDim(e,t,i,r){return this.modelSpace.addAngularLinesDim(e,t,i,r)}addHatch(e,t,i){return this.modelSpace.addHatch(e,t,i)}addLayer(e,t,i,r=V_.None){return i||(i=G_.Continuous),this.tables.addLayer(e,t,i,r)}setCurrentLayerName(e){this.document.setCurrentLayerName(e)}setUnits(e){this.document.setUnits(e)}addLine(e,t,i){return this.modelSpace.addLine(e,t,i)}addLeader(e,t){return this.modelSpace.addLeader(e,t)}addLWPolyline(e,t){return this.modelSpace.addLWPolyline(e,t)}addRectangle(e,t,i){return this.modelSpace.addRectangle(e,t,i)}addPolyline3D(e,t){return this.modelSpace.addPolyline3D(e,t)}addPoint(e,t,i,r){return this.modelSpace.addPoint(e,t,i,r)}addCircle(e,t,i){return this.modelSpace.addCircle(e,t,i)}addArc(e,t,i,r,s){return this.modelSpace.addArc(e,t,i,r,s)}addSpline(e,t){return this.modelSpace.addSpline(e,t)}addEllipse(e,t,i,r,s,o){return this.modelSpace.addEllipse(e,t,i,r,s,o)}addImage(e,t,i,r,s,o,a,c){return this.modelSpace.addImage(e,t,i,r,s,o,a,c)}add3dFace(e,t,i,r,s){return this.modelSpace.add3dFace(e,t,i,r,s)}addText(e,t,i,r){return this.modelSpace.addText(e,t,i,r)}addAttdef(e,t,i,r,s){return this.modelSpace.addAttdef(e,t,i,r,s)}addAttrib(e,t,i,r,s,o){return this.modelSpace.addAttrib(e,t,i,r,s,o)}addMText(e,t,i,r){return this.modelSpace.addMText(e,t,i,r)}addInsert(e,t,i){return this.modelSpace.addInsert(e,t,i)}addTable(e,t,i,r,s,o,a){return this.modelSpace.addTable(e,t,i,r,s,o,a)}stringify(){return this.document.stringify()}};const fAe=n=>/[ㄱ-ㅎㅏ-ㅣ가-힣]/g.test(n),pAe=n=>n.replace(/[ㄱ-ㅎㅏ-ㅣ가-힣]/g,e=>`\\U+${e.charCodeAt(0).toString(16).toUpperCase().padStart(4,"0")}`),gAe=n=>{const e={가구:"Gagu",정면도:"Jeongmyeondo",평면도:"Pyeongmyeondo",측면도:"Cheukmyeondo",작성일:"Jakseongil",도면:"Domyeon",축척:"Chukchuk",단위:"Danwi",폭:"Pok",높이:"Nopi",깊이:"Gipi",공간:"Gonggan",오픈박스:"Open Box",듀얼:"Dual",단:"Dan",선반:"Seonban",슬롯:"Slot",치수:"Chisu",배치:"Baechi",모듈:"Module"};let t=n;for(const[i,r]of Object.entries(e))t=t.replace(new RegExp(i,"g"),r);return t=t.replace(/[ㄱ-ㅎㅏ-ㅣ가-힣]/g,""),t.trim()||n},Bm=(n,e=!0)=>fAe(n)?e?gAe(n):pAe(n):n,NI=n=>{const e={오픈박스:"Open Box","2단":"2-Shelf","7단":"7-Shelf",듀얼2단:"Dual 2-Shelf",듀얼7단:"Dual 7-Shelf",가구:"Furniture",모듈:"Module"};for(const[t,i]of Object.entries(e))if(n.includes(t))return n.replace(t,i);return Bm(n)},LI=(n,e,t)=>`${n}W x ${e}H x ${t}D`,mAe=n=>{const e={front:{ko:"정면도",en:"Front Elevation",safe:"Front Elevation"},plan:{ko:"평면도",en:"Plan View",safe:"Plan View"},side:{ko:"측면도",en:"Side Section",safe:"Side Section"}};return e[n]||e.front},yAe=(n=new Date)=>{const e=n.getFullYear(),t=String(n.getMonth()+1).padStart(2,"0"),i=String(n.getDate()).padStart(2,"0");return`${e}-${t}-${i}`},MI=n=>{console.log(`[DXF Layer Validation - ${n}]`),console.log("Layer entity distribution check complete"),console.log("FURNITURE layer: entities added ✓"),console.log("DIMENSIONS layer: entities added ✓"),console.log("TEXT layer: entities added ✓"),console.log('Layer "0": minimal usage (setup only) ✓')},FP=n=>{const{spaceInfo:e,placedModules:t,drawingType:i="front"}=n,r=Eg.getState();(!r.isCalculated||!r.lastCalculatedSpaceInfo||JSON.stringify(r.lastCalculatedSpaceInfo)!==JSON.stringify(e))&&r.recalculateFromSpaceInfo(e);const s=new AAe;switch(s.addLayer("0",7,"CONTINUOUS"),s.addLayer("FURNITURE",3,"CONTINUOUS"),s.addLayer("DIMENSIONS",1,"CONTINUOUS"),s.addLayer("TEXT",5,"CONTINUOUS"),s.setCurrentLayerName("0"),i){case"front":DP(s,e,t);break;case"plan":vAe(s,e,t);break;case"side":wAe(s,e,t);break;default:DP(s,e,t);break}return i!=="front"&&TAe(s,e,i),s.stringify()},DP=(n,e,t)=>{U$(n,e,"front"),_Ae(n,t,e),n.setCurrentLayerName("TEXT"),n.addText(wt(0,-200),60,Bm("Front Elevation - Furniture Layout")),MI("Front Elevation")},vAe=(n,e,t)=>{xAe(n,e),CAe(n,t,e),MI("Plan View")},wAe=(n,e,t)=>{bAe(n,e),U$(n,e,"side"),SAe(n,t,e),MI("Side Section")},xAe=(n,e)=>{n.setCurrentLayerName("FURNITURE"),n.addLine(wt(0,0),wt(e.width,0)),n.addLine(wt(e.width,0),wt(e.width,e.depth)),n.addLine(wt(e.width,e.depth),wt(0,e.depth)),n.addLine(wt(0,e.depth),wt(0,0)),n.setCurrentLayerName("DIMENSIONS");const t=-100;n.addLine(wt(t,0),wt(t,e.depth)),n.addLine(wt(t-20,0),wt(t+20,0)),n.addLine(wt(t-20,e.depth),wt(t+20,e.depth)),n.addLine(wt(0,0),wt(t-20,0)),n.addLine(wt(0,e.depth),wt(t-20,e.depth)),n.setCurrentLayerName("TEXT"),n.addText(wt(t-50,e.depth/2),30,`${e.depth}mm`),n.setCurrentLayerName("DIMENSIONS");const i=-100;n.addLine(wt(0,i),wt(e.width,i)),n.addLine(wt(0,i-20),wt(0,i+20)),n.addLine(wt(e.width,i-20),wt(e.width,i+20)),n.addLine(wt(0,0),wt(0,i-20)),n.addLine(wt(e.width,0),wt(e.width,i-20)),n.setCurrentLayerName("TEXT"),n.addText(wt(e.width/2,i-50),30,`${e.width}mm`),n.addText(wt(e.width/2,e.depth+200),100,Bm(`Plan View: ${e.width}mm(W) × ${e.depth}mm(D)`)),n.addText(wt(e.width/2,e.depth+300),60,Bm(`Space Height: ${e.height}mm`))},bAe=(n,e)=>{n.setCurrentLayerName("FURNITURE"),n.addLine(wt(0,0),wt(e.depth,0)),n.addLine(wt(e.depth,0),wt(e.depth,e.height)),n.addLine(wt(e.depth,e.height),wt(0,e.height)),n.addLine(wt(0,e.height),wt(0,0)),n.setCurrentLayerName("DIMENSIONS");const t=-100;n.addLine(wt(t,0),wt(t,e.height)),n.addLine(wt(t-20,0),wt(t+20,0)),n.addLine(wt(t-20,e.height),wt(t+20,e.height)),n.addLine(wt(0,0),wt(t-20,0)),n.addLine(wt(0,e.height),wt(t-20,e.height)),n.setCurrentLayerName("TEXT"),n.addText(wt(t-50,e.height/2),30,`${e.height}mm`);const i=-100;n.addLine(wt(0,i),wt(e.depth,i)),n.addLine(wt(0,i-20),wt(0,i+20)),n.addLine(wt(e.depth,i-20),wt(e.depth,i+20)),n.addLine(wt(0,0),wt(0,i-20)),n.addLine(wt(e.depth,0),wt(e.depth,i-20)),n.addText(wt(e.depth/2,i-50),30,`${e.depth}mm`),n.addText(wt(e.depth/2,e.height+200),100,Bm(`Side Section: ${e.depth}mm(D) × ${e.height}mm(H)`)),n.addText(wt(e.depth/2,e.height+300),60,Bm(`Space Width: ${e.width}mm`))},U$=(n,e,t)=>{var r,s;if(((r=e.baseConfig)==null?void 0:r.type)!=="base_frame")return;const i=((s=e.baseConfig)==null?void 0:s.height)||100;if(n.setCurrentLayerName("FURNITURE"),t==="front"){const c=e.width,h=i;n.addLine(wt(0,0),wt(c,0)),n.addLine(wt(c,0),wt(c,h)),n.addLine(wt(c,h),wt(0,h)),n.addLine(wt(0,h),wt(0,0)),console.log("🎯 [DXF-SPECIALIST] Base Frame drawn in Front View:",{width:e.width,height:i,position:"bottom of space"})}else if(t!=="plan"){if(t==="side"){const c=e.depth,h=i;n.addLine(wt(0,0),wt(c,0)),n.addLine(wt(c,0),wt(c,h)),n.addLine(wt(c,h),wt(0,h)),n.addLine(wt(0,h),wt(0,0)),console.log("🎯 [DXF-SPECIALIST] Base Frame drawn in Side View:",{depth:e.depth,height:i,position:"bottom of space"})}}},_Ae=(n,e,t)=>{const i=Eg.getState(),r=kr(t),s={columnCount:i.columnCount,columnWidth:i.columnWidth,columnPositions:i.columnPositions,threeUnitPositions:i.threeUnitPositions,dualColumnPositions:i.dualColumnPositions,internalStartX:(t.width-i.internalWidth)/2,internalWidth:i.internalWidth,threeUnitDualPositions:i.dualColumnPositions.map(o=>o/10)};e.forEach((o,a)=>{var E,V,K;const{position:c,moduleData:h,moduleId:u}=o,d=Hi(u,r,t),f=h.dimensions,A=Math.abs(f.width-s.columnWidth*2)<50;let g=-1,p=0;A&&s.threeUnitDualPositions?(g=s.threeUnitDualPositions.findIndex(P=>Math.abs(P-c.x)<.1),g>=0&&(p=s.dualColumnPositions[g])):(g=s.threeUnitPositions.findIndex(P=>Math.abs(P-c.x)<.1),g>=0&&(p=s.columnPositions[g])),g<0&&(p=c.x*10);const y=p;console.log(`🎯 [DXF-SPECIALIST] Front View Coordinate Transform - ${h.name}:`,{"1_ThreeJS_Original":{x:c.x,y:c.y,slotIndex:g,isDualFurniture:A},"2_Internal_Space":{internalStartX:s.internalStartX,internalWidth:s.internalWidth,totalSpaceWidth:t.width},"3_Slot_Position":{slotPositionMm_Absolute:p,columnWidth:s.columnWidth,columnIndex:g},"4_DXF_Transform":{dxfXPosition:y,furnitureLeft:y-f.width/2,furnitureRight:y+f.width/2,leftEdgeToSpaceLeft:y-f.width/2,rightEdgeToSpaceRight:t.width-(y+f.width/2)}});const v=y-f.width/2,m=((E=t.baseConfig)==null?void 0:E.type)==="base_frame"?((V=t.baseConfig)==null?void 0:V.height)||100:0,w=m,x=v+f.width,T=w+f.height;console.log("📏 [DXF-SPECIALIST] Front View Y-Coordinate with BaseFrame:",{baseFrameType:(K=t.baseConfig)==null?void 0:K.type,baseFrameHeight:m,furnitureBottom:w,furnitureTop:T,totalHeight:f.height,floorToFurnitureBottom:w}),n.setCurrentLayerName("FURNITURE"),n.addLine(wt(v,w),wt(x,w)),n.addLine(wt(x,w),wt(x,T)),n.addLine(wt(x,T),wt(v,T)),n.addLine(wt(v,T),wt(v,w));const j=f.height,D=f.width,b=d==null?void 0:d.modelConfig,_=(b==null?void 0:b.shelfCount)||0,I=(b==null?void 0:b.drawerCount)||0;if(w>0&&(n.addLine(wt(v,0),wt(v,w)),n.addLine(wt(x,0),wt(x,w)),console.log(`📏 [DXF-SPECIALIST STEP 6] Floor/Base lines added for ${h.name}:`,{leftSupport:{x:v,from:0,to:w},rightSupport:{x,from:0,to:w},baseFrameHeight:w})),j>200&&D>200){if(A){const P=v+D/2;if(n.addLine(wt(P,w),wt(P,T)),console.log(`🎯 [DXF-SPECIALIST STEP 4] Dual central divider always shown for ${h.name}:`,{centerX:P,from:w,to:T,isDualFurniture:!0}),I>0){const M=Math.floor(I/2);if(M>1){for(let X=1;X<M;X++){const Z=w+j/M*X;n.addLine(wt(v,Z),wt(P,Z))}for(let X=1;X<M;X++){const Z=w+j/M*X;n.addLine(wt(P,Z),wt(x,Z))}console.log(`📐 [DXF-SPECIALIST STEP 5] Dual drawer dividers (N-1) for ${h.name}:`,{drawersPerSide:M,dividersPerSide:M-1,totalDividers:(M-1)*2})}}else if(_>0){const M=Math.floor(_/2);if(M>0){for(let X=1;X<=M;X++){const Z=w+j/(M+1)*X;n.addLine(wt(v,Z),wt(P,Z))}for(let X=1;X<=M;X++){const Z=w+j/(M+1)*X;n.addLine(wt(P,Z),wt(x,Z))}}}}else if(I>0&&I>1){for(let P=1;P<I;P++){const M=w+j/I*P;n.addLine(wt(v,M),wt(x,M))}console.log(`📐 [DXF-SPECIALIST STEP 5] Single drawer dividers (N-1) for ${h.name}:`,{drawerCount:I,dividerCount:I-1,dividerPositions:Array.from({length:I-1},(P,M)=>w+j/I*(M+1))})}else if(_>0)for(let P=1;P<=_;P++){const M=w+j/(_+1)*P;n.addLine(wt(v,M),wt(x,M))}}else if(A){const P=v+D/2;n.addLine(wt(P,w),wt(P,T)),console.log(`🎯 [DXF-SPECIALIST STEP 4] Small dual central divider shown for ${h.name}:`,{centerX:P,from:w,to:T,furnitureWidth:D,furnitureHeight:j,note:"Central divider shown even for small dual furniture"})}const S=v+f.width/2,F=w+f.height/2,B=NI(h.name||`F${a+1}`);if(n.setCurrentLayerName("TEXT"),n.addText(wt(S,F),Math.min(f.height/6,40),B),n.addText(wt(S,w-60),20,LI(f.width,f.height,f.depth)),f.height>100){const P=x+50;n.setCurrentLayerName("DIMENSIONS"),n.addLine(wt(P,w),wt(P,T)),n.addLine(wt(P-20,w),wt(P+20,w)),n.addLine(wt(P-20,T),wt(P+20,T)),n.addLine(wt(x,w),wt(P-20,w)),n.addLine(wt(x,T),wt(P-20,T)),n.setCurrentLayerName("TEXT"),n.addText(wt(P+30,F),20,`${f.height}mm`),console.log(`📐 [DXF-SPECIALIST STEP 7] dimV (height) added for ${h.name}:`,{dimensionX:P,from:w,to:T,height:f.height,layer:"DIMENSIONS"})}if(f.width>100){const P=w-100;n.setCurrentLayerName("DIMENSIONS"),n.addLine(wt(v,P),wt(x,P)),n.addLine(wt(v,P-20),wt(v,P+20)),n.addLine(wt(x,P-20),wt(x,P+20)),n.addLine(wt(v,w),wt(v,P+20)),n.addLine(wt(x,w),wt(x,P+20)),n.setCurrentLayerName("TEXT"),n.addText(wt(S,P-30),20,`${f.width}mm`),console.log(`📐 [DXF-SPECIALIST STEP 7] dimH (width) added for ${h.name}:`,{dimensionY:P,from:v,to:x,width:f.width,layer:"DIMENSIONS"})}})},CAe=(n,e,t)=>{const i=Eg.getState(),r=kr(t),s={columnCount:i.columnCount,columnWidth:i.columnWidth,columnPositions:i.columnPositions,threeUnitPositions:i.threeUnitPositions,dualColumnPositions:i.dualColumnPositions,internalStartX:(t.width-i.internalWidth)/2,internalWidth:i.internalWidth,threeUnitDualPositions:i.dualColumnPositions.map(o=>o/10)};console.log("🔍 DXF 평면도 생성 - 슬롯 인덱싱 정보:",{columnCount:s.columnCount,columnPositions:s.columnPositions,threeUnitPositions:s.threeUnitPositions,dualPositions:s.dualColumnPositions,threeUnitDualPositions:s.threeUnitDualPositions,internalStartX:s.internalStartX,internalWidth:s.internalWidth}),e.forEach((o,a)=>{const{position:c,moduleData:h,moduleId:u}=o,d=Hi(u,r,t),f=h.dimensions,A=Math.abs(f.width-s.columnWidth*2)<50;let g=-1,p=0;A&&s.threeUnitDualPositions?(g=s.threeUnitDualPositions.findIndex(V=>Math.abs(V-c.x)<.1),g>=0&&(p=s.dualColumnPositions[g])):(g=s.threeUnitPositions.findIndex(V=>Math.abs(V-c.x)<.1),g>=0&&(p=s.columnPositions[g])),g<0&&(p=c.x*10);const y=p,v=20,m=v;console.log(`🎯 [DXF-SPECIALIST] Plan View Coordinate Transform - ${h.name}:`,{"1_ThreeJS_Original":{x:c.x,z:c.z,slotIndex:g,isDualFurniture:A},"2_Internal_Space":{internalStartX:s.internalStartX,internalWidth:s.internalWidth,totalSpaceWidth:t.width},"3_DXF_Transform":{slotPositionMm_Absolute:p,dxfXPosition:y,furnitureLeft:y-f.width/2,furnitureRight:y+f.width/2,leftEdgeToSpaceLeft:y-f.width/2,rightEdgeToSpaceRight:t.width-(y+f.width/2)},"4_Depth_Position":{frontPositionMm:v,dxfYPosition:m,spaceDepth:t.depth}});const w=y-f.width/2,x=m,T=w+f.width,j=x+f.depth;console.log("📐 평면도 DXF 좌표 최종 계산:",{slotIndex:g,slotPositionMm:p,dxfXPosition:y,dxfYPosition:m,x1:w,y1:x,x2:T,y2:j,width:f.width,depth:f.depth}),n.setCurrentLayerName("FURNITURE"),n.addLine(wt(w,x),wt(T,x)),n.addLine(wt(T,x),wt(T,j)),n.addLine(wt(T,j),wt(w,j)),n.addLine(wt(w,j),wt(w,x));const D=f.width,b=f.depth,_=d==null?void 0:d.modelConfig,I=(_==null?void 0:_.shelfCount)||0;if(console.log(`🏗️ 평면도 가구 ${a+1} 내부 구조:`,{moduleId:u,shelfCount:I,modelConfig:_,furnitureWidth:D,furnitureDepth:b}),D>200&&b>200&&A){const V=w+D/2;n.addLine(wt(V,x),wt(V,j))}n.setCurrentLayerName("TEXT");const S=w+f.width/2,F=x+f.depth/2,B=NI(h.name||`Furniture${a+1}`);n.addText(wt(S,F),Math.min(f.width/4,f.depth/4,50),B);const E=I===0?"Open Box":I===1?"2-Shelf":I===6?"7-Shelf":I===2?"Dual 2-Shelf":I===12?"Dual 7-Shelf":`${I}-Shelf`;n.addText(wt(S,x-80),15,`Slot${g+1} | ${E}`),console.log(`🔍 평면도 가구 ${a+1} (${h.name}) 치수:`,{moduleId:u,moduleDataDepth:h.dimensions.depth,actualModuleDataDepth:d==null?void 0:d.dimensions.depth,finalDepth:f.depth,width:f.width,height:f.height}),n.addText(wt(S,x-50),20,LI(f.width,f.height,f.depth))})},SAe=(n,e,t)=>{n.setCurrentLayerName("FURNITURE");const i=kr(t);console.log("🔍 DXF 측면도 생성 - 가구 배치 정보:",{totalModules:e.length,spaceDepth:t.depth,spaceHeight:t.height}),e.forEach((r,s)=>{var F,B,E;const{moduleData:o,moduleId:a}=r,c=Hi(a,i,t),h=o.dimensions,u=h.depth;console.log(`🔍 측면도 가구 ${s+1} (${o.name}) 치수:`,{moduleId:a,moduleDataDepth:o.dimensions.depth,actualModuleDataDepth:c==null?void 0:c.dimensions.depth,finalDepth:u,height:h.height});const d=20,f=d+u,A=d+u/2,g=((F=t.baseConfig)==null?void 0:F.type)==="base_frame"?((B=t.baseConfig)==null?void 0:B.height)||100:0,p=g,y=p+h.height,v=p+h.height/2;console.log("🎯 [DXF-SPECIALIST] Side View Coordinate Transform with BaseFrame:",{"1_BaseFrame":{type:(E=t.baseConfig)==null?void 0:E.type,height:g,furnitureBottomWithBase:p},"2_Depth_Position":{frontPositionMm:d,backPositionMm:f,actualDepthMm:u},"3_Height_Position":{furnitureBottomY:p,furnitureTopY:y,furnitureCenterY:v,totalHeight:h.height,floorToFurnitureBottom:p}});const m=d,w=p,x=f,T=y;n.addLine(wt(m,w),wt(x,w)),n.addLine(wt(x,w),wt(x,T)),n.addLine(wt(x,T),wt(m,T)),n.addLine(wt(m,T),wt(m,w));const j=c==null?void 0:c.modelConfig,D=(j==null?void 0:j.shelfCount)||0;if(console.log(`🏗️ 측면도 가구 ${s+1} 내부 구조:`,{moduleId:a,shelfCount:D,modelConfig:j,actualDepthMm:u,height:h.height}),h.height>200&&u>200&&D>0)for(let V=1;V<=D;V++){const K=w+h.height/(D+1)*V;n.addLine(wt(m,K),wt(x,K))}n.setCurrentLayerName("TEXT");const b=A,_=v,I=NI(o.name||`Furniture${s+1}`);n.addText(wt(b,_),Math.min(u/4,h.height/4,50),I);const S=D===0?"Open Box":D===1?"2-Shelf":D===6?"7-Shelf":D===2?"Dual 2-Shelf":D===12?"Dual 7-Shelf":`${D}-Shelf`;if(n.addText(wt(b,w-80),15,`${S} | #${s+1}`),n.addText(wt(b,w-50),20,LI(h.width,h.height,u)),u>100){const V=w-120;n.setCurrentLayerName("DIMENSIONS"),n.addLine(wt(m,V),wt(x,V)),n.addLine(wt(m,V-10),wt(m,V+10)),n.addLine(wt(x,V-10),wt(x,V+10)),n.setCurrentLayerName("TEXT"),n.addText(wt(b,V-30),15,`${u}mm`)}})},TAe=(n,e,t="front")=>{n.setCurrentLayerName("TEXT");const i=e.width+500,r=t==="plan"?e.depth:e.height,s=mAe(t);n.addText(wt(i,r-100),80,`Furniture Layout ${s.safe}`);const o=yAe();n.addText(wt(i,r-200),40,`Date: ${o}`),n.addText(wt(i,r-280),40,`Drawing: ${s.safe}`),n.addText(wt(i,r-360),40,"Scale: 1:100"),n.addText(wt(i,r-440),40,"Unit: mm"),t==="plan"?(n.addText(wt(e.width/2,-200),60,`Width: ${e.width}mm × Depth: ${e.depth}mm`),n.addText(wt(e.width/2,-280),50,`Space Height: ${e.height}mm`)):(n.addText(wt(e.width/2,-200),60,`Width: ${e.width}mm × Height: ${e.height}mm`),n.addText(wt(e.width/2,-280),50,`Space Depth: ${e.depth}mm`))},jP=(n,e)=>{try{const t=new Blob([n],{type:"application/dxf"}),i=URL.createObjectURL(t),r=document.createElement("a");r.href=i,r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(i),console.log(`✅ DXF 파일 다운로드 완료: ${e}`)}catch(t){throw console.error("❌ DXF 파일 다운로드 실패:",t),new Error("DXF 파일 다운로드에 실패했습니다.")}},PP=(n,e="front")=>{const t=new Date().toISOString().slice(0,19).replace(/[:-]/g,""),i=`${n.width}W-${n.height}H-${n.depth}D`;return`furniture-${{front:"elevation",plan:"plan",side:"section"}[e]||"elevation"}-${i}-${t}.dxf`};function wx(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var L3={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var NP;function BAe(){return NP||(NP=1,(function(n,e){(function(t){n.exports=t()})(function(){return(function t(i,r,s){function o(h,u){if(!r[h]){if(!i[h]){var d=typeof wx=="function"&&wx;if(!u&&d)return d(h,!0);if(a)return a(h,!0);var f=new Error("Cannot find module '"+h+"'");throw f.code="MODULE_NOT_FOUND",f}var A=r[h]={exports:{}};i[h][0].call(A.exports,function(g){var p=i[h][1][g];return o(p||g)},A,A.exports,t,i,r,s)}return r[h].exports}for(var a=typeof wx=="function"&&wx,c=0;c<s.length;c++)o(s[c]);return o})({1:[function(t,i,r){var s=t("./utils"),o=t("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(c){for(var h,u,d,f,A,g,p,y=[],v=0,m=c.length,w=m,x=s.getTypeOf(c)!=="string";v<c.length;)w=m-v,d=x?(h=c[v++],u=v<m?c[v++]:0,v<m?c[v++]:0):(h=c.charCodeAt(v++),u=v<m?c.charCodeAt(v++):0,v<m?c.charCodeAt(v++):0),f=h>>2,A=(3&h)<<4|u>>4,g=1<w?(15&u)<<2|d>>6:64,p=2<w?63&d:64,y.push(a.charAt(f)+a.charAt(A)+a.charAt(g)+a.charAt(p));return y.join("")},r.decode=function(c){var h,u,d,f,A,g,p=0,y=0,v="data:";if(c.substr(0,v.length)===v)throw new Error("Invalid base64 input, it looks like a data url.");var m,w=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===a.charAt(64)&&w--,c.charAt(c.length-2)===a.charAt(64)&&w--,w%1!=0)throw new Error("Invalid base64 input, bad content length.");for(m=o.uint8array?new Uint8Array(0|w):new Array(0|w);p<c.length;)h=a.indexOf(c.charAt(p++))<<2|(f=a.indexOf(c.charAt(p++)))>>4,u=(15&f)<<4|(A=a.indexOf(c.charAt(p++)))>>2,d=(3&A)<<6|(g=a.indexOf(c.charAt(p++))),m[y++]=h,A!==64&&(m[y++]=u),g!==64&&(m[y++]=d);return m}},{"./support":30,"./utils":32}],2:[function(t,i,r){var s=t("./external"),o=t("./stream/DataWorker"),a=t("./stream/Crc32Probe"),c=t("./stream/DataLengthProbe");function h(u,d,f,A,g){this.compressedSize=u,this.uncompressedSize=d,this.crc32=f,this.compression=A,this.compressedContent=g}h.prototype={getContentWorker:function(){var u=new o(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),d=this;return u.on("end",function(){if(this.streamInfo.data_length!==d.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new o(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},h.createWorkerFrom=function(u,d,f){return u.pipe(new a).pipe(new c("uncompressedSize")).pipe(d.compressWorker(f)).pipe(new c("compressedSize")).withStreamInfo("compression",d)},i.exports=h},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,i,r){var s=t("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},r.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,i,r){var s=t("./utils"),o=(function(){for(var a,c=[],h=0;h<256;h++){a=h;for(var u=0;u<8;u++)a=1&a?3988292384^a>>>1:a>>>1;c[h]=a}return c})();i.exports=function(a,c){return a!==void 0&&a.length?s.getTypeOf(a)!=="string"?(function(h,u,d,f){var A=o,g=f+d;h^=-1;for(var p=f;p<g;p++)h=h>>>8^A[255&(h^u[p])];return-1^h})(0|c,a,a.length,0):(function(h,u,d,f){var A=o,g=f+d;h^=-1;for(var p=f;p<g;p++)h=h>>>8^A[255&(h^u.charCodeAt(p))];return-1^h})(0|c,a,a.length,0):0}},{"./utils":32}],5:[function(t,i,r){r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(t,i,r){var s=null;s=typeof Promise<"u"?Promise:t("lie"),i.exports={Promise:s}},{lie:37}],7:[function(t,i,r){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=t("pako"),a=t("./utils"),c=t("./stream/GenericWorker"),h=s?"uint8array":"array";function u(d,f){c.call(this,"FlateWorker/"+d),this._pako=null,this._pakoAction=d,this._pakoOptions=f,this.meta={}}r.magic="\b\0",a.inherits(u,c),u.prototype.processChunk=function(d){this.meta=d.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(h,d.data),!1)},u.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var d=this;this._pako.onData=function(f){d.push({data:f,meta:d.meta})}},r.compressWorker=function(d){return new u("Deflate",d)},r.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,i,r){function s(A,g){var p,y="";for(p=0;p<g;p++)y+=String.fromCharCode(255&A),A>>>=8;return y}function o(A,g,p,y,v,m){var w,x,T=A.file,j=A.compression,D=m!==h.utf8encode,b=a.transformTo("string",m(T.name)),_=a.transformTo("string",h.utf8encode(T.name)),I=T.comment,S=a.transformTo("string",m(I)),F=a.transformTo("string",h.utf8encode(I)),B=_.length!==T.name.length,E=F.length!==I.length,V="",K="",P="",M=T.dir,X=T.date,Z={crc32:0,compressedSize:0,uncompressedSize:0};g&&!p||(Z.crc32=A.crc32,Z.compressedSize=A.compressedSize,Z.uncompressedSize=A.uncompressedSize);var Q=0;g&&(Q|=8),D||!B&&!E||(Q|=2048);var U=0,z=0;M&&(U|=16),v==="UNIX"?(z=798,U|=(function(G,ie){var H=G;return G||(H=ie?16893:33204),(65535&H)<<16})(T.unixPermissions,M)):(z=20,U|=(function(G){return 63&(G||0)})(T.dosPermissions)),w=X.getUTCHours(),w<<=6,w|=X.getUTCMinutes(),w<<=5,w|=X.getUTCSeconds()/2,x=X.getUTCFullYear()-1980,x<<=4,x|=X.getUTCMonth()+1,x<<=5,x|=X.getUTCDate(),B&&(K=s(1,1)+s(u(b),4)+_,V+="up"+s(K.length,2)+K),E&&(P=s(1,1)+s(u(S),4)+F,V+="uc"+s(P.length,2)+P);var q="";return q+=`
\0`,q+=s(Q,2),q+=j.magic,q+=s(w,2),q+=s(x,2),q+=s(Z.crc32,4),q+=s(Z.compressedSize,4),q+=s(Z.uncompressedSize,4),q+=s(b.length,2),q+=s(V.length,2),{fileRecord:d.LOCAL_FILE_HEADER+q+b+V,dirRecord:d.CENTRAL_FILE_HEADER+s(z,2)+q+s(S.length,2)+"\0\0\0\0"+s(U,4)+s(y,4)+b+V+S}}var a=t("../utils"),c=t("../stream/GenericWorker"),h=t("../utf8"),u=t("../crc32"),d=t("../signature");function f(A,g,p,y){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=g,this.zipPlatform=p,this.encodeFileName=y,this.streamFiles=A,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(f,c),f.prototype.push=function(A){var g=A.meta.percent||0,p=this.entriesCount,y=this._sources.length;this.accumulate?this.contentBuffer.push(A):(this.bytesWritten+=A.data.length,c.prototype.push.call(this,{data:A.data,meta:{currentFile:this.currentFile,percent:p?(g+100*(p-y-1))/p:100}}))},f.prototype.openedSource=function(A){this.currentSourceOffset=this.bytesWritten,this.currentFile=A.file.name;var g=this.streamFiles&&!A.file.dir;if(g){var p=o(A,g,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:p.fileRecord,meta:{percent:0}})}else this.accumulate=!0},f.prototype.closedSource=function(A){this.accumulate=!1;var g=this.streamFiles&&!A.file.dir,p=o(A,g,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(p.dirRecord),g)this.push({data:(function(y){return d.DATA_DESCRIPTOR+s(y.crc32,4)+s(y.compressedSize,4)+s(y.uncompressedSize,4)})(A),meta:{percent:100}});else for(this.push({data:p.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},f.prototype.flush=function(){for(var A=this.bytesWritten,g=0;g<this.dirRecords.length;g++)this.push({data:this.dirRecords[g],meta:{percent:100}});var p=this.bytesWritten-A,y=(function(v,m,w,x,T){var j=a.transformTo("string",T(x));return d.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(v,2)+s(v,2)+s(m,4)+s(w,4)+s(j.length,2)+j})(this.dirRecords.length,p,A,this.zipComment,this.encodeFileName);this.push({data:y,meta:{percent:100}})},f.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},f.prototype.registerPrevious=function(A){this._sources.push(A);var g=this;return A.on("data",function(p){g.processChunk(p)}),A.on("end",function(){g.closedSource(g.previous.streamInfo),g._sources.length?g.prepareNextSource():g.end()}),A.on("error",function(p){g.error(p)}),this},f.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},f.prototype.error=function(A){var g=this._sources;if(!c.prototype.error.call(this,A))return!1;for(var p=0;p<g.length;p++)try{g[p].error(A)}catch{}return!0},f.prototype.lock=function(){c.prototype.lock.call(this);for(var A=this._sources,g=0;g<A.length;g++)A[g].lock()},i.exports=f},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,i,r){var s=t("../compressions"),o=t("./ZipFileWorker");r.generateWorker=function(a,c,h){var u=new o(c.streamFiles,h,c.platform,c.encodeFileName),d=0;try{a.forEach(function(f,A){d++;var g=(function(m,w){var x=m||w,T=s[x];if(!T)throw new Error(x+" is not a valid compression method !");return T})(A.options.compression,c.compression),p=A.options.compressionOptions||c.compressionOptions||{},y=A.dir,v=A.date;A._compressWorker(g,p).withStreamInfo("file",{name:f,dir:y,date:v,comment:A.comment||"",unixPermissions:A.unixPermissions,dosPermissions:A.dosPermissions}).pipe(u)}),u.entriesCount=d}catch(f){u.error(f)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,i,r){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new s;for(var a in this)typeof this[a]!="function"&&(o[a]=this[a]);return o}}(s.prototype=t("./object")).loadAsync=t("./load"),s.support=t("./support"),s.defaults=t("./defaults"),s.version="3.10.1",s.loadAsync=function(o,a){return new s().loadAsync(o,a)},s.external=t("./external"),i.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,i,r){var s=t("./utils"),o=t("./external"),a=t("./utf8"),c=t("./zipEntries"),h=t("./stream/Crc32Probe"),u=t("./nodejsUtils");function d(f){return new o.Promise(function(A,g){var p=f.decompressed.getContentWorker().pipe(new h);p.on("error",function(y){g(y)}).on("end",function(){p.streamInfo.crc32!==f.decompressed.crc32?g(new Error("Corrupted zip : CRC32 mismatch")):A()}).resume()})}i.exports=function(f,A){var g=this;return A=s.extend(A||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),u.isNode&&u.isStream(f)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",f,!0,A.optimizedBinaryString,A.base64).then(function(p){var y=new c(A);return y.load(p),y}).then(function(p){var y=[o.Promise.resolve(p)],v=p.files;if(A.checkCRC32)for(var m=0;m<v.length;m++)y.push(d(v[m]));return o.Promise.all(y)}).then(function(p){for(var y=p.shift(),v=y.files,m=0;m<v.length;m++){var w=v[m],x=w.fileNameStr,T=s.resolve(w.fileNameStr);g.file(T,w.decompressed,{binary:!0,optimizedBinaryString:!0,date:w.date,dir:w.dir,comment:w.fileCommentStr.length?w.fileCommentStr:null,unixPermissions:w.unixPermissions,dosPermissions:w.dosPermissions,createFolders:A.createFolders}),w.dir||(g.file(T).unsafeOriginalName=x)}return y.zipComment.length&&(g.comment=y.zipComment),g})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,i,r){var s=t("../utils"),o=t("../stream/GenericWorker");function a(c,h){o.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(h)}s.inherits(a,o),a.prototype._bindStream=function(c){var h=this;(this._stream=c).pause(),c.on("data",function(u){h.push({data:u,meta:{percent:0}})}).on("error",function(u){h.isPaused?this.generatedError=u:h.error(u)}).on("end",function(){h.isPaused?h._upstreamEnded=!0:h.end()})},a.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},i.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,i,r){var s=t("readable-stream").Readable;function o(a,c,h){s.call(this,c),this._helper=a;var u=this;a.on("data",function(d,f){u.push(d)||u._helper.pause(),h&&h(f)}).on("error",function(d){u.emit("error",d)}).on("end",function(){u.push(null)})}t("../utils").inherits(o,s),o.prototype._read=function(){this._helper.resume()},i.exports=o},{"../utils":32,"readable-stream":16}],14:[function(t,i,r){i.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,o);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,o)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var o=new Buffer(s);return o.fill(0),o},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(t,i,r){function s(T,j,D){var b,_=a.getTypeOf(j),I=a.extend(D||{},u);I.date=I.date||new Date,I.compression!==null&&(I.compression=I.compression.toUpperCase()),typeof I.unixPermissions=="string"&&(I.unixPermissions=parseInt(I.unixPermissions,8)),I.unixPermissions&&16384&I.unixPermissions&&(I.dir=!0),I.dosPermissions&&16&I.dosPermissions&&(I.dir=!0),I.dir&&(T=v(T)),I.createFolders&&(b=y(T))&&m.call(this,b,!0);var S=_==="string"&&I.binary===!1&&I.base64===!1;D&&D.binary!==void 0||(I.binary=!S),(j instanceof d&&j.uncompressedSize===0||I.dir||!j||j.length===0)&&(I.base64=!1,I.binary=!0,j="",I.compression="STORE",_="string");var F=null;F=j instanceof d||j instanceof c?j:g.isNode&&g.isStream(j)?new p(T,j):a.prepareContent(T,j,I.binary,I.optimizedBinaryString,I.base64);var B=new f(T,F,I);this.files[T]=B}var o=t("./utf8"),a=t("./utils"),c=t("./stream/GenericWorker"),h=t("./stream/StreamHelper"),u=t("./defaults"),d=t("./compressedObject"),f=t("./zipObject"),A=t("./generate"),g=t("./nodejsUtils"),p=t("./nodejs/NodejsStreamInputAdapter"),y=function(T){T.slice(-1)==="/"&&(T=T.substring(0,T.length-1));var j=T.lastIndexOf("/");return 0<j?T.substring(0,j):""},v=function(T){return T.slice(-1)!=="/"&&(T+="/"),T},m=function(T,j){return j=j!==void 0?j:u.createFolders,T=v(T),this.files[T]||s.call(this,T,null,{dir:!0,createFolders:j}),this.files[T]};function w(T){return Object.prototype.toString.call(T)==="[object RegExp]"}var x={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(T){var j,D,b;for(j in this.files)b=this.files[j],(D=j.slice(this.root.length,j.length))&&j.slice(0,this.root.length)===this.root&&T(D,b)},filter:function(T){var j=[];return this.forEach(function(D,b){T(D,b)&&j.push(b)}),j},file:function(T,j,D){if(arguments.length!==1)return T=this.root+T,s.call(this,T,j,D),this;if(w(T)){var b=T;return this.filter(function(I,S){return!S.dir&&b.test(I)})}var _=this.files[this.root+T];return _&&!_.dir?_:null},folder:function(T){if(!T)return this;if(w(T))return this.filter(function(_,I){return I.dir&&T.test(_)});var j=this.root+T,D=m.call(this,j),b=this.clone();return b.root=D.name,b},remove:function(T){T=this.root+T;var j=this.files[T];if(j||(T.slice(-1)!=="/"&&(T+="/"),j=this.files[T]),j&&!j.dir)delete this.files[T];else for(var D=this.filter(function(_,I){return I.name.slice(0,T.length)===T}),b=0;b<D.length;b++)delete this.files[D[b].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(T){var j,D={};try{if((D=a.extend(T||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=D.type.toLowerCase(),D.compression=D.compression.toUpperCase(),D.type==="binarystring"&&(D.type="string"),!D.type)throw new Error("No output type specified.");a.checkSupport(D.type),D.platform!=="darwin"&&D.platform!=="freebsd"&&D.platform!=="linux"&&D.platform!=="sunos"||(D.platform="UNIX"),D.platform==="win32"&&(D.platform="DOS");var b=D.comment||this.comment||"";j=A.generateWorker(this,D,b)}catch(_){(j=new c("error")).error(_)}return new h(j,D.type||"string",D.mimeType)},generateAsync:function(T,j){return this.generateInternalStream(T).accumulate(j)},generateNodeStream:function(T,j){return(T=T||{}).type||(T.type="nodebuffer"),this.generateInternalStream(T).toNodejsStream(j)}};i.exports=x},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,i,r){i.exports=t("stream")},{stream:void 0}],17:[function(t,i,r){var s=t("./DataReader");function o(a){s.call(this,a);for(var c=0;c<this.data.length;c++)a[c]=255&a[c]}t("../utils").inherits(o,s),o.prototype.byteAt=function(a){return this.data[this.zero+a]},o.prototype.lastIndexOfSignature=function(a){for(var c=a.charCodeAt(0),h=a.charCodeAt(1),u=a.charCodeAt(2),d=a.charCodeAt(3),f=this.length-4;0<=f;--f)if(this.data[f]===c&&this.data[f+1]===h&&this.data[f+2]===u&&this.data[f+3]===d)return f-this.zero;return-1},o.prototype.readAndCheckSignature=function(a){var c=a.charCodeAt(0),h=a.charCodeAt(1),u=a.charCodeAt(2),d=a.charCodeAt(3),f=this.readData(4);return c===f[0]&&h===f[1]&&u===f[2]&&d===f[3]},o.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},i.exports=o},{"../utils":32,"./DataReader":18}],18:[function(t,i,r){var s=t("../utils");function o(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var c,h=0;for(this.checkOffset(a),c=this.index+a-1;c>=this.index;c--)h=(h<<8)+this.byteAt(c);return this.index+=a,h},readString:function(a){return s.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},i.exports=o},{"../utils":32}],19:[function(t,i,r){var s=t("./Uint8ArrayReader");function o(a){s.call(this,a)}t("../utils").inherits(o,s),o.prototype.readData=function(a){this.checkOffset(a);var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},i.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,i,r){var s=t("./DataReader");function o(a){s.call(this,a)}t("../utils").inherits(o,s),o.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},o.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},o.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},o.prototype.readData=function(a){this.checkOffset(a);var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},i.exports=o},{"../utils":32,"./DataReader":18}],21:[function(t,i,r){var s=t("./ArrayReader");function o(a){s.call(this,a)}t("../utils").inherits(o,s),o.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},i.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(t,i,r){var s=t("../utils"),o=t("../support"),a=t("./ArrayReader"),c=t("./StringReader"),h=t("./NodeBufferReader"),u=t("./Uint8ArrayReader");i.exports=function(d){var f=s.getTypeOf(d);return s.checkSupport(f),f!=="string"||o.uint8array?f==="nodebuffer"?new h(d):o.uint8array?new u(s.transformTo("uint8array",d)):new a(s.transformTo("array",d)):new c(d)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,i,r){r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,i,r){var s=t("./GenericWorker"),o=t("../utils");function a(c){s.call(this,"ConvertWorker to "+c),this.destType=c}o.inherits(a,s),a.prototype.processChunk=function(c){this.push({data:o.transformTo(this.destType,c.data),meta:c.meta})},i.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(t,i,r){var s=t("./GenericWorker"),o=t("../crc32");function a(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(a,s),a.prototype.processChunk=function(c){this.streamInfo.crc32=o(c.data,this.streamInfo.crc32||0),this.push(c)},i.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,i,r){var s=t("../utils"),o=t("./GenericWorker");function a(c){o.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}s.inherits(a,o),a.prototype.processChunk=function(c){if(c){var h=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=h+c.data.length}o.prototype.processChunk.call(this,c)},i.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(t,i,r){var s=t("../utils"),o=t("./GenericWorker");function a(c){o.call(this,"DataWorker");var h=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(u){h.dataIsReady=!0,h.data=u,h.max=u&&u.length||0,h.type=s.getTypeOf(u),h.isPaused||h._tickAndRepeat()},function(u){h.error(u)})}s.inherits(a,o),a.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,h=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,h);break;case"uint8array":c=this.data.subarray(this.index,h);break;case"array":case"nodebuffer":c=this.data.slice(this.index,h)}return this.index=h,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(t,i,r){function s(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,a){return this._listeners[o].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,a){if(this._listeners[o])for(var c=0;c<this._listeners[o].length;c++)this._listeners[o][c].call(this,a)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var a=this;return o.on("data",function(c){a.processChunk(c)}),o.on("end",function(){a.end()}),o.on("error",function(c){a.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,a){return this.extraStreamInfo[o]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},i.exports=s},{}],29:[function(t,i,r){var s=t("../utils"),o=t("./ConvertWorker"),a=t("./GenericWorker"),c=t("../base64"),h=t("../support"),u=t("../external"),d=null;if(h.nodestream)try{d=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function f(g,p){return new u.Promise(function(y,v){var m=[],w=g._internalType,x=g._outputType,T=g._mimeType;g.on("data",function(j,D){m.push(j),p&&p(D)}).on("error",function(j){m=[],v(j)}).on("end",function(){try{var j=(function(D,b,_){switch(D){case"blob":return s.newBlob(s.transformTo("arraybuffer",b),_);case"base64":return c.encode(b);default:return s.transformTo(D,b)}})(x,(function(D,b){var _,I=0,S=null,F=0;for(_=0;_<b.length;_++)F+=b[_].length;switch(D){case"string":return b.join("");case"array":return Array.prototype.concat.apply([],b);case"uint8array":for(S=new Uint8Array(F),_=0;_<b.length;_++)S.set(b[_],I),I+=b[_].length;return S;case"nodebuffer":return Buffer.concat(b);default:throw new Error("concat : unsupported type '"+D+"'")}})(w,m),T);y(j)}catch(D){v(D)}m=[]}).resume()})}function A(g,p,y){var v=p;switch(p){case"blob":case"arraybuffer":v="uint8array";break;case"base64":v="string"}try{this._internalType=v,this._outputType=p,this._mimeType=y,s.checkSupport(v),this._worker=g.pipe(new o(v)),g.lock()}catch(m){this._worker=new a("error"),this._worker.error(m)}}A.prototype={accumulate:function(g){return f(this,g)},on:function(g,p){var y=this;return g==="data"?this._worker.on(g,function(v){p.call(y,v.data,v.meta)}):this._worker.on(g,function(){s.delay(p,arguments,y)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(g){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new d(this,{objectMode:this._outputType!=="nodebuffer"},g)}},i.exports=A},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,i,r){if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",r.nodebuffer=typeof Buffer<"u",r.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")r.blob=!1;else{var s=new ArrayBuffer(0);try{r.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(s),r.blob=o.getBlob("application/zip").size===0}catch{r.blob=!1}}}try{r.nodestream=!!t("readable-stream").Readable}catch{r.nodestream=!1}},{"readable-stream":16}],31:[function(t,i,r){for(var s=t("./utils"),o=t("./support"),a=t("./nodejsUtils"),c=t("./stream/GenericWorker"),h=new Array(256),u=0;u<256;u++)h[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;h[254]=h[254]=1;function d(){c.call(this,"utf-8 decode"),this.leftOver=null}function f(){c.call(this,"utf-8 encode")}r.utf8encode=function(A){return o.nodebuffer?a.newBufferFrom(A,"utf-8"):(function(g){var p,y,v,m,w,x=g.length,T=0;for(m=0;m<x;m++)(64512&(y=g.charCodeAt(m)))==55296&&m+1<x&&(64512&(v=g.charCodeAt(m+1)))==56320&&(y=65536+(y-55296<<10)+(v-56320),m++),T+=y<128?1:y<2048?2:y<65536?3:4;for(p=o.uint8array?new Uint8Array(T):new Array(T),m=w=0;w<T;m++)(64512&(y=g.charCodeAt(m)))==55296&&m+1<x&&(64512&(v=g.charCodeAt(m+1)))==56320&&(y=65536+(y-55296<<10)+(v-56320),m++),y<128?p[w++]=y:(y<2048?p[w++]=192|y>>>6:(y<65536?p[w++]=224|y>>>12:(p[w++]=240|y>>>18,p[w++]=128|y>>>12&63),p[w++]=128|y>>>6&63),p[w++]=128|63&y);return p})(A)},r.utf8decode=function(A){return o.nodebuffer?s.transformTo("nodebuffer",A).toString("utf-8"):(function(g){var p,y,v,m,w=g.length,x=new Array(2*w);for(p=y=0;p<w;)if((v=g[p++])<128)x[y++]=v;else if(4<(m=h[v]))x[y++]=65533,p+=m-1;else{for(v&=m===2?31:m===3?15:7;1<m&&p<w;)v=v<<6|63&g[p++],m--;1<m?x[y++]=65533:v<65536?x[y++]=v:(v-=65536,x[y++]=55296|v>>10&1023,x[y++]=56320|1023&v)}return x.length!==y&&(x.subarray?x=x.subarray(0,y):x.length=y),s.applyFromCharCode(x)})(A=s.transformTo(o.uint8array?"uint8array":"array",A))},s.inherits(d,c),d.prototype.processChunk=function(A){var g=s.transformTo(o.uint8array?"uint8array":"array",A.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var p=g;(g=new Uint8Array(p.length+this.leftOver.length)).set(this.leftOver,0),g.set(p,this.leftOver.length)}else g=this.leftOver.concat(g);this.leftOver=null}var y=(function(m,w){var x;for((w=w||m.length)>m.length&&(w=m.length),x=w-1;0<=x&&(192&m[x])==128;)x--;return x<0||x===0?w:x+h[m[x]]>w?x:w})(g),v=g;y!==g.length&&(o.uint8array?(v=g.subarray(0,y),this.leftOver=g.subarray(y,g.length)):(v=g.slice(0,y),this.leftOver=g.slice(y,g.length))),this.push({data:r.utf8decode(v),meta:A.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=d,s.inherits(f,c),f.prototype.processChunk=function(A){this.push({data:r.utf8encode(A.data),meta:A.meta})},r.Utf8EncodeWorker=f},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,i,r){var s=t("./support"),o=t("./base64"),a=t("./nodejsUtils"),c=t("./external");function h(p){return p}function u(p,y){for(var v=0;v<p.length;++v)y[v]=255&p.charCodeAt(v);return y}t("setimmediate"),r.newBlob=function(p,y){r.checkSupport("blob");try{return new Blob([p],{type:y})}catch{try{var v=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return v.append(p),v.getBlob(y)}catch{throw new Error("Bug : can't construct the Blob.")}}};var d={stringifyByChunk:function(p,y,v){var m=[],w=0,x=p.length;if(x<=v)return String.fromCharCode.apply(null,p);for(;w<x;)y==="array"||y==="nodebuffer"?m.push(String.fromCharCode.apply(null,p.slice(w,Math.min(w+v,x)))):m.push(String.fromCharCode.apply(null,p.subarray(w,Math.min(w+v,x)))),w+=v;return m.join("")},stringifyByChar:function(p){for(var y="",v=0;v<p.length;v++)y+=String.fromCharCode(p[v]);return y},applyCanBeUsed:{uint8array:(function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}})()}};function f(p){var y=65536,v=r.getTypeOf(p),m=!0;if(v==="uint8array"?m=d.applyCanBeUsed.uint8array:v==="nodebuffer"&&(m=d.applyCanBeUsed.nodebuffer),m)for(;1<y;)try{return d.stringifyByChunk(p,v,y)}catch{y=Math.floor(y/2)}return d.stringifyByChar(p)}function A(p,y){for(var v=0;v<p.length;v++)y[v]=p[v];return y}r.applyFromCharCode=f;var g={};g.string={string:h,array:function(p){return u(p,new Array(p.length))},arraybuffer:function(p){return g.string.uint8array(p).buffer},uint8array:function(p){return u(p,new Uint8Array(p.length))},nodebuffer:function(p){return u(p,a.allocBuffer(p.length))}},g.array={string:f,array:h,arraybuffer:function(p){return new Uint8Array(p).buffer},uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return a.newBufferFrom(p)}},g.arraybuffer={string:function(p){return f(new Uint8Array(p))},array:function(p){return A(new Uint8Array(p),new Array(p.byteLength))},arraybuffer:h,uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return a.newBufferFrom(new Uint8Array(p))}},g.uint8array={string:f,array:function(p){return A(p,new Array(p.length))},arraybuffer:function(p){return p.buffer},uint8array:h,nodebuffer:function(p){return a.newBufferFrom(p)}},g.nodebuffer={string:f,array:function(p){return A(p,new Array(p.length))},arraybuffer:function(p){return g.nodebuffer.uint8array(p).buffer},uint8array:function(p){return A(p,new Uint8Array(p.length))},nodebuffer:h},r.transformTo=function(p,y){if(y=y||"",!p)return y;r.checkSupport(p);var v=r.getTypeOf(y);return g[v][p](y)},r.resolve=function(p){for(var y=p.split("/"),v=[],m=0;m<y.length;m++){var w=y[m];w==="."||w===""&&m!==0&&m!==y.length-1||(w===".."?v.pop():v.push(w))}return v.join("/")},r.getTypeOf=function(p){return typeof p=="string"?"string":Object.prototype.toString.call(p)==="[object Array]"?"array":s.nodebuffer&&a.isBuffer(p)?"nodebuffer":s.uint8array&&p instanceof Uint8Array?"uint8array":s.arraybuffer&&p instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(p){if(!s[p.toLowerCase()])throw new Error(p+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(p){var y,v,m="";for(v=0;v<(p||"").length;v++)m+="\\x"+((y=p.charCodeAt(v))<16?"0":"")+y.toString(16).toUpperCase();return m},r.delay=function(p,y,v){setImmediate(function(){p.apply(v||null,y||[])})},r.inherits=function(p,y){function v(){}v.prototype=y.prototype,p.prototype=new v},r.extend=function(){var p,y,v={};for(p=0;p<arguments.length;p++)for(y in arguments[p])Object.prototype.hasOwnProperty.call(arguments[p],y)&&v[y]===void 0&&(v[y]=arguments[p][y]);return v},r.prepareContent=function(p,y,v,m,w){return c.Promise.resolve(y).then(function(x){return s.blob&&(x instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(x))!==-1)&&typeof FileReader<"u"?new c.Promise(function(T,j){var D=new FileReader;D.onload=function(b){T(b.target.result)},D.onerror=function(b){j(b.target.error)},D.readAsArrayBuffer(x)}):x}).then(function(x){var T=r.getTypeOf(x);return T?(T==="arraybuffer"?x=r.transformTo("uint8array",x):T==="string"&&(w?x=o.decode(x):v&&m!==!0&&(x=(function(j){return u(j,s.uint8array?new Uint8Array(j.length):new Array(j.length))})(x))),x):c.Promise.reject(new Error("Can't read the data of '"+p+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,i,r){var s=t("./reader/readerFor"),o=t("./utils"),a=t("./signature"),c=t("./zipEntry"),h=t("./support");function u(d){this.files=[],this.loadOptions=d}u.prototype={checkSignature:function(d){if(!this.reader.readAndCheckSignature(d)){this.reader.index-=4;var f=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(f)+", expected "+o.pretty(d)+")")}},isSignature:function(d,f){var A=this.reader.index;this.reader.setIndex(d);var g=this.reader.readString(4)===f;return this.reader.setIndex(A),g},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var d=this.reader.readData(this.zipCommentLength),f=h.uint8array?"uint8array":"array",A=o.transformTo(f,d);this.zipComment=this.loadOptions.decodeFileName(A)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var d,f,A,g=this.zip64EndOfCentralSize-44;0<g;)d=this.reader.readInt(2),f=this.reader.readInt(4),A=this.reader.readData(f),this.zip64ExtensibleData[d]={id:d,length:f,value:A}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var d,f;for(d=0;d<this.files.length;d++)f=this.files[d],this.reader.setIndex(f.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),f.readLocalPart(this.reader),f.handleUTF8(),f.processAttributes()},readCentralDir:function(){var d;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(d=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(d);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var d=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(d<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(d);var f=d;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(d=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(d),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var A=this.centralDirOffset+this.centralDirSize;this.zip64&&(A+=20,A+=12+this.zip64EndOfCentralSize);var g=f-A;if(0<g)this.isSignature(f,a.CENTRAL_FILE_HEADER)||(this.reader.zero=g);else if(g<0)throw new Error("Corrupted zip: missing "+Math.abs(g)+" bytes.")},prepareReader:function(d){this.reader=s(d)},load:function(d){this.prepareReader(d),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,i,r){var s=t("./reader/readerFor"),o=t("./utils"),a=t("./compressedObject"),c=t("./crc32"),h=t("./utf8"),u=t("./compressions"),d=t("./support");function f(A,g){this.options=A,this.loadOptions=g}f.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(A){var g,p;if(A.skip(22),this.fileNameLength=A.readInt(2),p=A.readInt(2),this.fileName=A.readData(this.fileNameLength),A.skip(p),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((g=(function(y){for(var v in u)if(Object.prototype.hasOwnProperty.call(u,v)&&u[v].magic===y)return u[v];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,g,A.readData(this.compressedSize))},readCentralPart:function(A){this.versionMadeBy=A.readInt(2),A.skip(2),this.bitFlag=A.readInt(2),this.compressionMethod=A.readString(2),this.date=A.readDate(),this.crc32=A.readInt(4),this.compressedSize=A.readInt(4),this.uncompressedSize=A.readInt(4);var g=A.readInt(2);if(this.extraFieldsLength=A.readInt(2),this.fileCommentLength=A.readInt(2),this.diskNumberStart=A.readInt(2),this.internalFileAttributes=A.readInt(2),this.externalFileAttributes=A.readInt(4),this.localHeaderOffset=A.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");A.skip(g),this.readExtraFields(A),this.parseZIP64ExtraField(A),this.fileComment=A.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var A=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),A==0&&(this.dosPermissions=63&this.externalFileAttributes),A==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var A=s(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=A.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=A.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=A.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=A.readInt(4))}},readExtraFields:function(A){var g,p,y,v=A.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});A.index+4<v;)g=A.readInt(2),p=A.readInt(2),y=A.readData(p),this.extraFields[g]={id:g,length:p,value:y};A.setIndex(v)},handleUTF8:function(){var A=d.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=h.utf8decode(this.fileName),this.fileCommentStr=h.utf8decode(this.fileComment);else{var g=this.findExtraFieldUnicodePath();if(g!==null)this.fileNameStr=g;else{var p=o.transformTo(A,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(p)}var y=this.findExtraFieldUnicodeComment();if(y!==null)this.fileCommentStr=y;else{var v=o.transformTo(A,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(v)}}},findExtraFieldUnicodePath:function(){var A=this.extraFields[28789];if(A){var g=s(A.value);return g.readInt(1)!==1||c(this.fileName)!==g.readInt(4)?null:h.utf8decode(g.readData(A.length-5))}return null},findExtraFieldUnicodeComment:function(){var A=this.extraFields[25461];if(A){var g=s(A.value);return g.readInt(1)!==1||c(this.fileComment)!==g.readInt(4)?null:h.utf8decode(g.readData(A.length-5))}return null}},i.exports=f},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,i,r){function s(g,p,y){this.name=g,this.dir=y.dir,this.date=y.date,this.comment=y.comment,this.unixPermissions=y.unixPermissions,this.dosPermissions=y.dosPermissions,this._data=p,this._dataBinary=y.binary,this.options={compression:y.compression,compressionOptions:y.compressionOptions}}var o=t("./stream/StreamHelper"),a=t("./stream/DataWorker"),c=t("./utf8"),h=t("./compressedObject"),u=t("./stream/GenericWorker");s.prototype={internalStream:function(g){var p=null,y="string";try{if(!g)throw new Error("No output type specified.");var v=(y=g.toLowerCase())==="string"||y==="text";y!=="binarystring"&&y!=="text"||(y="string"),p=this._decompressWorker();var m=!this._dataBinary;m&&!v&&(p=p.pipe(new c.Utf8EncodeWorker)),!m&&v&&(p=p.pipe(new c.Utf8DecodeWorker))}catch(w){(p=new u("error")).error(w)}return new o(p,y,"")},async:function(g,p){return this.internalStream(g).accumulate(p)},nodeStream:function(g,p){return this.internalStream(g||"nodebuffer").toNodejsStream(p)},_compressWorker:function(g,p){if(this._data instanceof h&&this._data.compression.magic===g.magic)return this._data.getCompressedWorker();var y=this._decompressWorker();return this._dataBinary||(y=y.pipe(new c.Utf8EncodeWorker)),h.createWorkerFrom(y,g,p)},_decompressWorker:function(){return this._data instanceof h?this._data.getContentWorker():this._data instanceof u?this._data:new a(this._data)}};for(var d=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],f=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},A=0;A<d.length;A++)s.prototype[d[A]]=f;i.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,i,r){(function(s){var o,a,c=s.MutationObserver||s.WebKitMutationObserver;if(c){var h=0,u=new c(g),d=s.document.createTextNode("");u.observe(d,{characterData:!0}),o=function(){d.data=h=++h%2}}else if(s.setImmediate||s.MessageChannel===void 0)o="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var p=s.document.createElement("script");p.onreadystatechange=function(){g(),p.onreadystatechange=null,p.parentNode.removeChild(p),p=null},s.document.documentElement.appendChild(p)}:function(){setTimeout(g,0)};else{var f=new s.MessageChannel;f.port1.onmessage=g,o=function(){f.port2.postMessage(0)}}var A=[];function g(){var p,y;a=!0;for(var v=A.length;v;){for(y=A,A=[],p=-1;++p<v;)y[p]();v=A.length}a=!1}i.exports=function(p){A.push(p)!==1||a||o()}}).call(this,typeof P0<"u"?P0:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,i,r){var s=t("immediate");function o(){}var a={},c=["REJECTED"],h=["FULFILLED"],u=["PENDING"];function d(v){if(typeof v!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,v!==o&&p(this,v)}function f(v,m,w){this.promise=v,typeof m=="function"&&(this.onFulfilled=m,this.callFulfilled=this.otherCallFulfilled),typeof w=="function"&&(this.onRejected=w,this.callRejected=this.otherCallRejected)}function A(v,m,w){s(function(){var x;try{x=m(w)}catch(T){return a.reject(v,T)}x===v?a.reject(v,new TypeError("Cannot resolve promise with itself")):a.resolve(v,x)})}function g(v){var m=v&&v.then;if(v&&(typeof v=="object"||typeof v=="function")&&typeof m=="function")return function(){m.apply(v,arguments)}}function p(v,m){var w=!1;function x(D){w||(w=!0,a.reject(v,D))}function T(D){w||(w=!0,a.resolve(v,D))}var j=y(function(){m(T,x)});j.status==="error"&&x(j.value)}function y(v,m){var w={};try{w.value=v(m),w.status="success"}catch(x){w.status="error",w.value=x}return w}(i.exports=d).prototype.finally=function(v){if(typeof v!="function")return this;var m=this.constructor;return this.then(function(w){return m.resolve(v()).then(function(){return w})},function(w){return m.resolve(v()).then(function(){throw w})})},d.prototype.catch=function(v){return this.then(null,v)},d.prototype.then=function(v,m){if(typeof v!="function"&&this.state===h||typeof m!="function"&&this.state===c)return this;var w=new this.constructor(o);return this.state!==u?A(w,this.state===h?v:m,this.outcome):this.queue.push(new f(w,v,m)),w},f.prototype.callFulfilled=function(v){a.resolve(this.promise,v)},f.prototype.otherCallFulfilled=function(v){A(this.promise,this.onFulfilled,v)},f.prototype.callRejected=function(v){a.reject(this.promise,v)},f.prototype.otherCallRejected=function(v){A(this.promise,this.onRejected,v)},a.resolve=function(v,m){var w=y(g,m);if(w.status==="error")return a.reject(v,w.value);var x=w.value;if(x)p(v,x);else{v.state=h,v.outcome=m;for(var T=-1,j=v.queue.length;++T<j;)v.queue[T].callFulfilled(m)}return v},a.reject=function(v,m){v.state=c,v.outcome=m;for(var w=-1,x=v.queue.length;++w<x;)v.queue[w].callRejected(m);return v},d.resolve=function(v){return v instanceof this?v:a.resolve(new this(o),v)},d.reject=function(v){var m=new this(o);return a.reject(m,v)},d.all=function(v){var m=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var w=v.length,x=!1;if(!w)return this.resolve([]);for(var T=new Array(w),j=0,D=-1,b=new this(o);++D<w;)_(v[D],D);return b;function _(I,S){m.resolve(I).then(function(F){T[S]=F,++j!==w||x||(x=!0,a.resolve(b,T))},function(F){x||(x=!0,a.reject(b,F))})}},d.race=function(v){var m=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var w=v.length,x=!1;if(!w)return this.resolve([]);for(var T=-1,j=new this(o);++T<w;)D=v[T],m.resolve(D).then(function(b){x||(x=!0,a.resolve(j,b))},function(b){x||(x=!0,a.reject(j,b))});var D;return j}},{immediate:36}],38:[function(t,i,r){var s={};(0,t("./lib/utils/common").assign)(s,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),i.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,i,r){var s=t("./zlib/deflate"),o=t("./utils/common"),a=t("./utils/strings"),c=t("./zlib/messages"),h=t("./zlib/zstream"),u=Object.prototype.toString,d=0,f=-1,A=0,g=8;function p(v){if(!(this instanceof p))return new p(v);this.options=o.assign({level:f,method:g,chunkSize:16384,windowBits:15,memLevel:8,strategy:A,to:""},v||{});var m=this.options;m.raw&&0<m.windowBits?m.windowBits=-m.windowBits:m.gzip&&0<m.windowBits&&m.windowBits<16&&(m.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var w=s.deflateInit2(this.strm,m.level,m.method,m.windowBits,m.memLevel,m.strategy);if(w!==d)throw new Error(c[w]);if(m.header&&s.deflateSetHeader(this.strm,m.header),m.dictionary){var x;if(x=typeof m.dictionary=="string"?a.string2buf(m.dictionary):u.call(m.dictionary)==="[object ArrayBuffer]"?new Uint8Array(m.dictionary):m.dictionary,(w=s.deflateSetDictionary(this.strm,x))!==d)throw new Error(c[w]);this._dict_set=!0}}function y(v,m){var w=new p(m);if(w.push(v,!0),w.err)throw w.msg||c[w.err];return w.result}p.prototype.push=function(v,m){var w,x,T=this.strm,j=this.options.chunkSize;if(this.ended)return!1;x=m===~~m?m:m===!0?4:0,typeof v=="string"?T.input=a.string2buf(v):u.call(v)==="[object ArrayBuffer]"?T.input=new Uint8Array(v):T.input=v,T.next_in=0,T.avail_in=T.input.length;do{if(T.avail_out===0&&(T.output=new o.Buf8(j),T.next_out=0,T.avail_out=j),(w=s.deflate(T,x))!==1&&w!==d)return this.onEnd(w),!(this.ended=!0);T.avail_out!==0&&(T.avail_in!==0||x!==4&&x!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(o.shrinkBuf(T.output,T.next_out))):this.onData(o.shrinkBuf(T.output,T.next_out)))}while((0<T.avail_in||T.avail_out===0)&&w!==1);return x===4?(w=s.deflateEnd(this.strm),this.onEnd(w),this.ended=!0,w===d):x!==2||(this.onEnd(d),!(T.avail_out=0))},p.prototype.onData=function(v){this.chunks.push(v)},p.prototype.onEnd=function(v){v===d&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},r.Deflate=p,r.deflate=y,r.deflateRaw=function(v,m){return(m=m||{}).raw=!0,y(v,m)},r.gzip=function(v,m){return(m=m||{}).gzip=!0,y(v,m)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,i,r){var s=t("./zlib/inflate"),o=t("./utils/common"),a=t("./utils/strings"),c=t("./zlib/constants"),h=t("./zlib/messages"),u=t("./zlib/zstream"),d=t("./zlib/gzheader"),f=Object.prototype.toString;function A(p){if(!(this instanceof A))return new A(p);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},p||{});var y=this.options;y.raw&&0<=y.windowBits&&y.windowBits<16&&(y.windowBits=-y.windowBits,y.windowBits===0&&(y.windowBits=-15)),!(0<=y.windowBits&&y.windowBits<16)||p&&p.windowBits||(y.windowBits+=32),15<y.windowBits&&y.windowBits<48&&(15&y.windowBits)==0&&(y.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var v=s.inflateInit2(this.strm,y.windowBits);if(v!==c.Z_OK)throw new Error(h[v]);this.header=new d,s.inflateGetHeader(this.strm,this.header)}function g(p,y){var v=new A(y);if(v.push(p,!0),v.err)throw v.msg||h[v.err];return v.result}A.prototype.push=function(p,y){var v,m,w,x,T,j,D=this.strm,b=this.options.chunkSize,_=this.options.dictionary,I=!1;if(this.ended)return!1;m=y===~~y?y:y===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof p=="string"?D.input=a.binstring2buf(p):f.call(p)==="[object ArrayBuffer]"?D.input=new Uint8Array(p):D.input=p,D.next_in=0,D.avail_in=D.input.length;do{if(D.avail_out===0&&(D.output=new o.Buf8(b),D.next_out=0,D.avail_out=b),(v=s.inflate(D,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&_&&(j=typeof _=="string"?a.string2buf(_):f.call(_)==="[object ArrayBuffer]"?new Uint8Array(_):_,v=s.inflateSetDictionary(this.strm,j)),v===c.Z_BUF_ERROR&&I===!0&&(v=c.Z_OK,I=!1),v!==c.Z_STREAM_END&&v!==c.Z_OK)return this.onEnd(v),!(this.ended=!0);D.next_out&&(D.avail_out!==0&&v!==c.Z_STREAM_END&&(D.avail_in!==0||m!==c.Z_FINISH&&m!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(w=a.utf8border(D.output,D.next_out),x=D.next_out-w,T=a.buf2string(D.output,w),D.next_out=x,D.avail_out=b-x,x&&o.arraySet(D.output,D.output,w,x,0),this.onData(T)):this.onData(o.shrinkBuf(D.output,D.next_out)))),D.avail_in===0&&D.avail_out===0&&(I=!0)}while((0<D.avail_in||D.avail_out===0)&&v!==c.Z_STREAM_END);return v===c.Z_STREAM_END&&(m=c.Z_FINISH),m===c.Z_FINISH?(v=s.inflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===c.Z_OK):m!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(D.avail_out=0))},A.prototype.onData=function(p){this.chunks.push(p)},A.prototype.onEnd=function(p){p===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg},r.Inflate=A,r.inflate=g,r.inflateRaw=function(p,y){return(y=y||{}).raw=!0,g(p,y)},r.ungzip=g},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,i,r){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";r.assign=function(c){for(var h=Array.prototype.slice.call(arguments,1);h.length;){var u=h.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var d in u)u.hasOwnProperty(d)&&(c[d]=u[d])}}return c},r.shrinkBuf=function(c,h){return c.length===h?c:c.subarray?c.subarray(0,h):(c.length=h,c)};var o={arraySet:function(c,h,u,d,f){if(h.subarray&&c.subarray)c.set(h.subarray(u,u+d),f);else for(var A=0;A<d;A++)c[f+A]=h[u+A]},flattenChunks:function(c){var h,u,d,f,A,g;for(h=d=0,u=c.length;h<u;h++)d+=c[h].length;for(g=new Uint8Array(d),h=f=0,u=c.length;h<u;h++)A=c[h],g.set(A,f),f+=A.length;return g}},a={arraySet:function(c,h,u,d,f){for(var A=0;A<d;A++)c[f+A]=h[u+A]},flattenChunks:function(c){return[].concat.apply([],c)}};r.setTyped=function(c){c?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,o)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,a))},r.setTyped(s)},{}],42:[function(t,i,r){var s=t("./common"),o=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var c=new s.Buf8(256),h=0;h<256;h++)c[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;function u(d,f){if(f<65537&&(d.subarray&&a||!d.subarray&&o))return String.fromCharCode.apply(null,s.shrinkBuf(d,f));for(var A="",g=0;g<f;g++)A+=String.fromCharCode(d[g]);return A}c[254]=c[254]=1,r.string2buf=function(d){var f,A,g,p,y,v=d.length,m=0;for(p=0;p<v;p++)(64512&(A=d.charCodeAt(p)))==55296&&p+1<v&&(64512&(g=d.charCodeAt(p+1)))==56320&&(A=65536+(A-55296<<10)+(g-56320),p++),m+=A<128?1:A<2048?2:A<65536?3:4;for(f=new s.Buf8(m),p=y=0;y<m;p++)(64512&(A=d.charCodeAt(p)))==55296&&p+1<v&&(64512&(g=d.charCodeAt(p+1)))==56320&&(A=65536+(A-55296<<10)+(g-56320),p++),A<128?f[y++]=A:(A<2048?f[y++]=192|A>>>6:(A<65536?f[y++]=224|A>>>12:(f[y++]=240|A>>>18,f[y++]=128|A>>>12&63),f[y++]=128|A>>>6&63),f[y++]=128|63&A);return f},r.buf2binstring=function(d){return u(d,d.length)},r.binstring2buf=function(d){for(var f=new s.Buf8(d.length),A=0,g=f.length;A<g;A++)f[A]=d.charCodeAt(A);return f},r.buf2string=function(d,f){var A,g,p,y,v=f||d.length,m=new Array(2*v);for(A=g=0;A<v;)if((p=d[A++])<128)m[g++]=p;else if(4<(y=c[p]))m[g++]=65533,A+=y-1;else{for(p&=y===2?31:y===3?15:7;1<y&&A<v;)p=p<<6|63&d[A++],y--;1<y?m[g++]=65533:p<65536?m[g++]=p:(p-=65536,m[g++]=55296|p>>10&1023,m[g++]=56320|1023&p)}return u(m,g)},r.utf8border=function(d,f){var A;for((f=f||d.length)>d.length&&(f=d.length),A=f-1;0<=A&&(192&d[A])==128;)A--;return A<0||A===0?f:A+c[d[A]]>f?A:f}},{"./common":41}],43:[function(t,i,r){i.exports=function(s,o,a,c){for(var h=65535&s|0,u=s>>>16&65535|0,d=0;a!==0;){for(a-=d=2e3<a?2e3:a;u=u+(h=h+o[c++]|0)|0,--d;);h%=65521,u%=65521}return h|u<<16|0}},{}],44:[function(t,i,r){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,i,r){var s=(function(){for(var o,a=[],c=0;c<256;c++){o=c;for(var h=0;h<8;h++)o=1&o?3988292384^o>>>1:o>>>1;a[c]=o}return a})();i.exports=function(o,a,c,h){var u=s,d=h+c;o^=-1;for(var f=h;f<d;f++)o=o>>>8^u[255&(o^a[f])];return-1^o}},{}],46:[function(t,i,r){var s,o=t("../utils/common"),a=t("./trees"),c=t("./adler32"),h=t("./crc32"),u=t("./messages"),d=0,f=4,A=0,g=-2,p=-1,y=4,v=2,m=8,w=9,x=286,T=30,j=19,D=2*x+1,b=15,_=3,I=258,S=I+_+1,F=42,B=113,E=1,V=2,K=3,P=4;function M(W,Y){return W.msg=u[Y],Y}function X(W){return(W<<1)-(4<W?9:0)}function Z(W){for(var Y=W.length;0<=--Y;)W[Y]=0}function Q(W){var Y=W.state,ve=Y.pending;ve>W.avail_out&&(ve=W.avail_out),ve!==0&&(o.arraySet(W.output,Y.pending_buf,Y.pending_out,ve,W.next_out),W.next_out+=ve,Y.pending_out+=ve,W.total_out+=ve,W.avail_out-=ve,Y.pending-=ve,Y.pending===0&&(Y.pending_out=0))}function U(W,Y){a._tr_flush_block(W,0<=W.block_start?W.block_start:-1,W.strstart-W.block_start,Y),W.block_start=W.strstart,Q(W.strm)}function z(W,Y){W.pending_buf[W.pending++]=Y}function q(W,Y){W.pending_buf[W.pending++]=Y>>>8&255,W.pending_buf[W.pending++]=255&Y}function G(W,Y){var ve,ce,ne=W.max_chain_length,he=W.strstart,xe=W.prev_length,Te=W.nice_match,Ce=W.strstart>W.w_size-S?W.strstart-(W.w_size-S):0,Be=W.window,Ye=W.w_mask,$e=W.prev,ot=W.strstart+I,rt=Be[he+xe-1],Ve=Be[he+xe];W.prev_length>=W.good_match&&(ne>>=2),Te>W.lookahead&&(Te=W.lookahead);do if(Be[(ve=Y)+xe]===Ve&&Be[ve+xe-1]===rt&&Be[ve]===Be[he]&&Be[++ve]===Be[he+1]){he+=2,ve++;do;while(Be[++he]===Be[++ve]&&Be[++he]===Be[++ve]&&Be[++he]===Be[++ve]&&Be[++he]===Be[++ve]&&Be[++he]===Be[++ve]&&Be[++he]===Be[++ve]&&Be[++he]===Be[++ve]&&Be[++he]===Be[++ve]&&he<ot);if(ce=I-(ot-he),he=ot-I,xe<ce){if(W.match_start=Y,Te<=(xe=ce))break;rt=Be[he+xe-1],Ve=Be[he+xe]}}while((Y=$e[Y&Ye])>Ce&&--ne!=0);return xe<=W.lookahead?xe:W.lookahead}function ie(W){var Y,ve,ce,ne,he,xe,Te,Ce,Be,Ye,$e=W.w_size;do{if(ne=W.window_size-W.lookahead-W.strstart,W.strstart>=$e+($e-S)){for(o.arraySet(W.window,W.window,$e,$e,0),W.match_start-=$e,W.strstart-=$e,W.block_start-=$e,Y=ve=W.hash_size;ce=W.head[--Y],W.head[Y]=$e<=ce?ce-$e:0,--ve;);for(Y=ve=$e;ce=W.prev[--Y],W.prev[Y]=$e<=ce?ce-$e:0,--ve;);ne+=$e}if(W.strm.avail_in===0)break;if(xe=W.strm,Te=W.window,Ce=W.strstart+W.lookahead,Be=ne,Ye=void 0,Ye=xe.avail_in,Be<Ye&&(Ye=Be),ve=Ye===0?0:(xe.avail_in-=Ye,o.arraySet(Te,xe.input,xe.next_in,Ye,Ce),xe.state.wrap===1?xe.adler=c(xe.adler,Te,Ye,Ce):xe.state.wrap===2&&(xe.adler=h(xe.adler,Te,Ye,Ce)),xe.next_in+=Ye,xe.total_in+=Ye,Ye),W.lookahead+=ve,W.lookahead+W.insert>=_)for(he=W.strstart-W.insert,W.ins_h=W.window[he],W.ins_h=(W.ins_h<<W.hash_shift^W.window[he+1])&W.hash_mask;W.insert&&(W.ins_h=(W.ins_h<<W.hash_shift^W.window[he+_-1])&W.hash_mask,W.prev[he&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=he,he++,W.insert--,!(W.lookahead+W.insert<_)););}while(W.lookahead<S&&W.strm.avail_in!==0)}function H(W,Y){for(var ve,ce;;){if(W.lookahead<S){if(ie(W),W.lookahead<S&&Y===d)return E;if(W.lookahead===0)break}if(ve=0,W.lookahead>=_&&(W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+_-1])&W.hash_mask,ve=W.prev[W.strstart&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=W.strstart),ve!==0&&W.strstart-ve<=W.w_size-S&&(W.match_length=G(W,ve)),W.match_length>=_)if(ce=a._tr_tally(W,W.strstart-W.match_start,W.match_length-_),W.lookahead-=W.match_length,W.match_length<=W.max_lazy_match&&W.lookahead>=_){for(W.match_length--;W.strstart++,W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+_-1])&W.hash_mask,ve=W.prev[W.strstart&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=W.strstart,--W.match_length!=0;);W.strstart++}else W.strstart+=W.match_length,W.match_length=0,W.ins_h=W.window[W.strstart],W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+1])&W.hash_mask;else ce=a._tr_tally(W,0,W.window[W.strstart]),W.lookahead--,W.strstart++;if(ce&&(U(W,!1),W.strm.avail_out===0))return E}return W.insert=W.strstart<_-1?W.strstart:_-1,Y===f?(U(W,!0),W.strm.avail_out===0?K:P):W.last_lit&&(U(W,!1),W.strm.avail_out===0)?E:V}function se(W,Y){for(var ve,ce,ne;;){if(W.lookahead<S){if(ie(W),W.lookahead<S&&Y===d)return E;if(W.lookahead===0)break}if(ve=0,W.lookahead>=_&&(W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+_-1])&W.hash_mask,ve=W.prev[W.strstart&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=W.strstart),W.prev_length=W.match_length,W.prev_match=W.match_start,W.match_length=_-1,ve!==0&&W.prev_length<W.max_lazy_match&&W.strstart-ve<=W.w_size-S&&(W.match_length=G(W,ve),W.match_length<=5&&(W.strategy===1||W.match_length===_&&4096<W.strstart-W.match_start)&&(W.match_length=_-1)),W.prev_length>=_&&W.match_length<=W.prev_length){for(ne=W.strstart+W.lookahead-_,ce=a._tr_tally(W,W.strstart-1-W.prev_match,W.prev_length-_),W.lookahead-=W.prev_length-1,W.prev_length-=2;++W.strstart<=ne&&(W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+_-1])&W.hash_mask,ve=W.prev[W.strstart&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=W.strstart),--W.prev_length!=0;);if(W.match_available=0,W.match_length=_-1,W.strstart++,ce&&(U(W,!1),W.strm.avail_out===0))return E}else if(W.match_available){if((ce=a._tr_tally(W,0,W.window[W.strstart-1]))&&U(W,!1),W.strstart++,W.lookahead--,W.strm.avail_out===0)return E}else W.match_available=1,W.strstart++,W.lookahead--}return W.match_available&&(ce=a._tr_tally(W,0,W.window[W.strstart-1]),W.match_available=0),W.insert=W.strstart<_-1?W.strstart:_-1,Y===f?(U(W,!0),W.strm.avail_out===0?K:P):W.last_lit&&(U(W,!1),W.strm.avail_out===0)?E:V}function te(W,Y,ve,ce,ne){this.good_length=W,this.max_lazy=Y,this.nice_length=ve,this.max_chain=ce,this.func=ne}function fe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=m,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*D),this.dyn_dtree=new o.Buf16(2*(2*T+1)),this.bl_tree=new o.Buf16(2*(2*j+1)),Z(this.dyn_ltree),Z(this.dyn_dtree),Z(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(b+1),this.heap=new o.Buf16(2*x+1),Z(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*x+1),Z(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ye(W){var Y;return W&&W.state?(W.total_in=W.total_out=0,W.data_type=v,(Y=W.state).pending=0,Y.pending_out=0,Y.wrap<0&&(Y.wrap=-Y.wrap),Y.status=Y.wrap?F:B,W.adler=Y.wrap===2?0:1,Y.last_flush=d,a._tr_init(Y),A):M(W,g)}function be(W){var Y=ye(W);return Y===A&&(function(ve){ve.window_size=2*ve.w_size,Z(ve.head),ve.max_lazy_match=s[ve.level].max_lazy,ve.good_match=s[ve.level].good_length,ve.nice_match=s[ve.level].nice_length,ve.max_chain_length=s[ve.level].max_chain,ve.strstart=0,ve.block_start=0,ve.lookahead=0,ve.insert=0,ve.match_length=ve.prev_length=_-1,ve.match_available=0,ve.ins_h=0})(W.state),Y}function _e(W,Y,ve,ce,ne,he){if(!W)return g;var xe=1;if(Y===p&&(Y=6),ce<0?(xe=0,ce=-ce):15<ce&&(xe=2,ce-=16),ne<1||w<ne||ve!==m||ce<8||15<ce||Y<0||9<Y||he<0||y<he)return M(W,g);ce===8&&(ce=9);var Te=new fe;return(W.state=Te).strm=W,Te.wrap=xe,Te.gzhead=null,Te.w_bits=ce,Te.w_size=1<<Te.w_bits,Te.w_mask=Te.w_size-1,Te.hash_bits=ne+7,Te.hash_size=1<<Te.hash_bits,Te.hash_mask=Te.hash_size-1,Te.hash_shift=~~((Te.hash_bits+_-1)/_),Te.window=new o.Buf8(2*Te.w_size),Te.head=new o.Buf16(Te.hash_size),Te.prev=new o.Buf16(Te.w_size),Te.lit_bufsize=1<<ne+6,Te.pending_buf_size=4*Te.lit_bufsize,Te.pending_buf=new o.Buf8(Te.pending_buf_size),Te.d_buf=1*Te.lit_bufsize,Te.l_buf=3*Te.lit_bufsize,Te.level=Y,Te.strategy=he,Te.method=ve,be(W)}s=[new te(0,0,0,0,function(W,Y){var ve=65535;for(ve>W.pending_buf_size-5&&(ve=W.pending_buf_size-5);;){if(W.lookahead<=1){if(ie(W),W.lookahead===0&&Y===d)return E;if(W.lookahead===0)break}W.strstart+=W.lookahead,W.lookahead=0;var ce=W.block_start+ve;if((W.strstart===0||W.strstart>=ce)&&(W.lookahead=W.strstart-ce,W.strstart=ce,U(W,!1),W.strm.avail_out===0)||W.strstart-W.block_start>=W.w_size-S&&(U(W,!1),W.strm.avail_out===0))return E}return W.insert=0,Y===f?(U(W,!0),W.strm.avail_out===0?K:P):(W.strstart>W.block_start&&(U(W,!1),W.strm.avail_out),E)}),new te(4,4,8,4,H),new te(4,5,16,8,H),new te(4,6,32,32,H),new te(4,4,16,16,se),new te(8,16,32,32,se),new te(8,16,128,128,se),new te(8,32,128,256,se),new te(32,128,258,1024,se),new te(32,258,258,4096,se)],r.deflateInit=function(W,Y){return _e(W,Y,m,15,8,0)},r.deflateInit2=_e,r.deflateReset=be,r.deflateResetKeep=ye,r.deflateSetHeader=function(W,Y){return W&&W.state?W.state.wrap!==2?g:(W.state.gzhead=Y,A):g},r.deflate=function(W,Y){var ve,ce,ne,he;if(!W||!W.state||5<Y||Y<0)return W?M(W,g):g;if(ce=W.state,!W.output||!W.input&&W.avail_in!==0||ce.status===666&&Y!==f)return M(W,W.avail_out===0?-5:g);if(ce.strm=W,ve=ce.last_flush,ce.last_flush=Y,ce.status===F)if(ce.wrap===2)W.adler=0,z(ce,31),z(ce,139),z(ce,8),ce.gzhead?(z(ce,(ce.gzhead.text?1:0)+(ce.gzhead.hcrc?2:0)+(ce.gzhead.extra?4:0)+(ce.gzhead.name?8:0)+(ce.gzhead.comment?16:0)),z(ce,255&ce.gzhead.time),z(ce,ce.gzhead.time>>8&255),z(ce,ce.gzhead.time>>16&255),z(ce,ce.gzhead.time>>24&255),z(ce,ce.level===9?2:2<=ce.strategy||ce.level<2?4:0),z(ce,255&ce.gzhead.os),ce.gzhead.extra&&ce.gzhead.extra.length&&(z(ce,255&ce.gzhead.extra.length),z(ce,ce.gzhead.extra.length>>8&255)),ce.gzhead.hcrc&&(W.adler=h(W.adler,ce.pending_buf,ce.pending,0)),ce.gzindex=0,ce.status=69):(z(ce,0),z(ce,0),z(ce,0),z(ce,0),z(ce,0),z(ce,ce.level===9?2:2<=ce.strategy||ce.level<2?4:0),z(ce,3),ce.status=B);else{var xe=m+(ce.w_bits-8<<4)<<8;xe|=(2<=ce.strategy||ce.level<2?0:ce.level<6?1:ce.level===6?2:3)<<6,ce.strstart!==0&&(xe|=32),xe+=31-xe%31,ce.status=B,q(ce,xe),ce.strstart!==0&&(q(ce,W.adler>>>16),q(ce,65535&W.adler)),W.adler=1}if(ce.status===69)if(ce.gzhead.extra){for(ne=ce.pending;ce.gzindex<(65535&ce.gzhead.extra.length)&&(ce.pending!==ce.pending_buf_size||(ce.gzhead.hcrc&&ce.pending>ne&&(W.adler=h(W.adler,ce.pending_buf,ce.pending-ne,ne)),Q(W),ne=ce.pending,ce.pending!==ce.pending_buf_size));)z(ce,255&ce.gzhead.extra[ce.gzindex]),ce.gzindex++;ce.gzhead.hcrc&&ce.pending>ne&&(W.adler=h(W.adler,ce.pending_buf,ce.pending-ne,ne)),ce.gzindex===ce.gzhead.extra.length&&(ce.gzindex=0,ce.status=73)}else ce.status=73;if(ce.status===73)if(ce.gzhead.name){ne=ce.pending;do{if(ce.pending===ce.pending_buf_size&&(ce.gzhead.hcrc&&ce.pending>ne&&(W.adler=h(W.adler,ce.pending_buf,ce.pending-ne,ne)),Q(W),ne=ce.pending,ce.pending===ce.pending_buf_size)){he=1;break}he=ce.gzindex<ce.gzhead.name.length?255&ce.gzhead.name.charCodeAt(ce.gzindex++):0,z(ce,he)}while(he!==0);ce.gzhead.hcrc&&ce.pending>ne&&(W.adler=h(W.adler,ce.pending_buf,ce.pending-ne,ne)),he===0&&(ce.gzindex=0,ce.status=91)}else ce.status=91;if(ce.status===91)if(ce.gzhead.comment){ne=ce.pending;do{if(ce.pending===ce.pending_buf_size&&(ce.gzhead.hcrc&&ce.pending>ne&&(W.adler=h(W.adler,ce.pending_buf,ce.pending-ne,ne)),Q(W),ne=ce.pending,ce.pending===ce.pending_buf_size)){he=1;break}he=ce.gzindex<ce.gzhead.comment.length?255&ce.gzhead.comment.charCodeAt(ce.gzindex++):0,z(ce,he)}while(he!==0);ce.gzhead.hcrc&&ce.pending>ne&&(W.adler=h(W.adler,ce.pending_buf,ce.pending-ne,ne)),he===0&&(ce.status=103)}else ce.status=103;if(ce.status===103&&(ce.gzhead.hcrc?(ce.pending+2>ce.pending_buf_size&&Q(W),ce.pending+2<=ce.pending_buf_size&&(z(ce,255&W.adler),z(ce,W.adler>>8&255),W.adler=0,ce.status=B)):ce.status=B),ce.pending!==0){if(Q(W),W.avail_out===0)return ce.last_flush=-1,A}else if(W.avail_in===0&&X(Y)<=X(ve)&&Y!==f)return M(W,-5);if(ce.status===666&&W.avail_in!==0)return M(W,-5);if(W.avail_in!==0||ce.lookahead!==0||Y!==d&&ce.status!==666){var Te=ce.strategy===2?(function(Ce,Be){for(var Ye;;){if(Ce.lookahead===0&&(ie(Ce),Ce.lookahead===0)){if(Be===d)return E;break}if(Ce.match_length=0,Ye=a._tr_tally(Ce,0,Ce.window[Ce.strstart]),Ce.lookahead--,Ce.strstart++,Ye&&(U(Ce,!1),Ce.strm.avail_out===0))return E}return Ce.insert=0,Be===f?(U(Ce,!0),Ce.strm.avail_out===0?K:P):Ce.last_lit&&(U(Ce,!1),Ce.strm.avail_out===0)?E:V})(ce,Y):ce.strategy===3?(function(Ce,Be){for(var Ye,$e,ot,rt,Ve=Ce.window;;){if(Ce.lookahead<=I){if(ie(Ce),Ce.lookahead<=I&&Be===d)return E;if(Ce.lookahead===0)break}if(Ce.match_length=0,Ce.lookahead>=_&&0<Ce.strstart&&($e=Ve[ot=Ce.strstart-1])===Ve[++ot]&&$e===Ve[++ot]&&$e===Ve[++ot]){rt=Ce.strstart+I;do;while($e===Ve[++ot]&&$e===Ve[++ot]&&$e===Ve[++ot]&&$e===Ve[++ot]&&$e===Ve[++ot]&&$e===Ve[++ot]&&$e===Ve[++ot]&&$e===Ve[++ot]&&ot<rt);Ce.match_length=I-(rt-ot),Ce.match_length>Ce.lookahead&&(Ce.match_length=Ce.lookahead)}if(Ce.match_length>=_?(Ye=a._tr_tally(Ce,1,Ce.match_length-_),Ce.lookahead-=Ce.match_length,Ce.strstart+=Ce.match_length,Ce.match_length=0):(Ye=a._tr_tally(Ce,0,Ce.window[Ce.strstart]),Ce.lookahead--,Ce.strstart++),Ye&&(U(Ce,!1),Ce.strm.avail_out===0))return E}return Ce.insert=0,Be===f?(U(Ce,!0),Ce.strm.avail_out===0?K:P):Ce.last_lit&&(U(Ce,!1),Ce.strm.avail_out===0)?E:V})(ce,Y):s[ce.level].func(ce,Y);if(Te!==K&&Te!==P||(ce.status=666),Te===E||Te===K)return W.avail_out===0&&(ce.last_flush=-1),A;if(Te===V&&(Y===1?a._tr_align(ce):Y!==5&&(a._tr_stored_block(ce,0,0,!1),Y===3&&(Z(ce.head),ce.lookahead===0&&(ce.strstart=0,ce.block_start=0,ce.insert=0))),Q(W),W.avail_out===0))return ce.last_flush=-1,A}return Y!==f?A:ce.wrap<=0?1:(ce.wrap===2?(z(ce,255&W.adler),z(ce,W.adler>>8&255),z(ce,W.adler>>16&255),z(ce,W.adler>>24&255),z(ce,255&W.total_in),z(ce,W.total_in>>8&255),z(ce,W.total_in>>16&255),z(ce,W.total_in>>24&255)):(q(ce,W.adler>>>16),q(ce,65535&W.adler)),Q(W),0<ce.wrap&&(ce.wrap=-ce.wrap),ce.pending!==0?A:1)},r.deflateEnd=function(W){var Y;return W&&W.state?(Y=W.state.status)!==F&&Y!==69&&Y!==73&&Y!==91&&Y!==103&&Y!==B&&Y!==666?M(W,g):(W.state=null,Y===B?M(W,-3):A):g},r.deflateSetDictionary=function(W,Y){var ve,ce,ne,he,xe,Te,Ce,Be,Ye=Y.length;if(!W||!W.state||(he=(ve=W.state).wrap)===2||he===1&&ve.status!==F||ve.lookahead)return g;for(he===1&&(W.adler=c(W.adler,Y,Ye,0)),ve.wrap=0,Ye>=ve.w_size&&(he===0&&(Z(ve.head),ve.strstart=0,ve.block_start=0,ve.insert=0),Be=new o.Buf8(ve.w_size),o.arraySet(Be,Y,Ye-ve.w_size,ve.w_size,0),Y=Be,Ye=ve.w_size),xe=W.avail_in,Te=W.next_in,Ce=W.input,W.avail_in=Ye,W.next_in=0,W.input=Y,ie(ve);ve.lookahead>=_;){for(ce=ve.strstart,ne=ve.lookahead-(_-1);ve.ins_h=(ve.ins_h<<ve.hash_shift^ve.window[ce+_-1])&ve.hash_mask,ve.prev[ce&ve.w_mask]=ve.head[ve.ins_h],ve.head[ve.ins_h]=ce,ce++,--ne;);ve.strstart=ce,ve.lookahead=_-1,ie(ve)}return ve.strstart+=ve.lookahead,ve.block_start=ve.strstart,ve.insert=ve.lookahead,ve.lookahead=0,ve.match_length=ve.prev_length=_-1,ve.match_available=0,W.next_in=Te,W.input=Ce,W.avail_in=xe,ve.wrap=he,A},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,i,r){i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,i,r){i.exports=function(s,o){var a,c,h,u,d,f,A,g,p,y,v,m,w,x,T,j,D,b,_,I,S,F,B,E,V;a=s.state,c=s.next_in,E=s.input,h=c+(s.avail_in-5),u=s.next_out,V=s.output,d=u-(o-s.avail_out),f=u+(s.avail_out-257),A=a.dmax,g=a.wsize,p=a.whave,y=a.wnext,v=a.window,m=a.hold,w=a.bits,x=a.lencode,T=a.distcode,j=(1<<a.lenbits)-1,D=(1<<a.distbits)-1;e:do{w<15&&(m+=E[c++]<<w,w+=8,m+=E[c++]<<w,w+=8),b=x[m&j];t:for(;;){if(m>>>=_=b>>>24,w-=_,(_=b>>>16&255)===0)V[u++]=65535&b;else{if(!(16&_)){if((64&_)==0){b=x[(65535&b)+(m&(1<<_)-1)];continue t}if(32&_){a.mode=12;break e}s.msg="invalid literal/length code",a.mode=30;break e}I=65535&b,(_&=15)&&(w<_&&(m+=E[c++]<<w,w+=8),I+=m&(1<<_)-1,m>>>=_,w-=_),w<15&&(m+=E[c++]<<w,w+=8,m+=E[c++]<<w,w+=8),b=T[m&D];n:for(;;){if(m>>>=_=b>>>24,w-=_,!(16&(_=b>>>16&255))){if((64&_)==0){b=T[(65535&b)+(m&(1<<_)-1)];continue n}s.msg="invalid distance code",a.mode=30;break e}if(S=65535&b,w<(_&=15)&&(m+=E[c++]<<w,(w+=8)<_&&(m+=E[c++]<<w,w+=8)),A<(S+=m&(1<<_)-1)){s.msg="invalid distance too far back",a.mode=30;break e}if(m>>>=_,w-=_,(_=u-d)<S){if(p<(_=S-_)&&a.sane){s.msg="invalid distance too far back",a.mode=30;break e}if(B=v,(F=0)===y){if(F+=g-_,_<I){for(I-=_;V[u++]=v[F++],--_;);F=u-S,B=V}}else if(y<_){if(F+=g+y-_,(_-=y)<I){for(I-=_;V[u++]=v[F++],--_;);if(F=0,y<I){for(I-=_=y;V[u++]=v[F++],--_;);F=u-S,B=V}}}else if(F+=y-_,_<I){for(I-=_;V[u++]=v[F++],--_;);F=u-S,B=V}for(;2<I;)V[u++]=B[F++],V[u++]=B[F++],V[u++]=B[F++],I-=3;I&&(V[u++]=B[F++],1<I&&(V[u++]=B[F++]))}else{for(F=u-S;V[u++]=V[F++],V[u++]=V[F++],V[u++]=V[F++],2<(I-=3););I&&(V[u++]=V[F++],1<I&&(V[u++]=V[F++]))}break}}break}}while(c<h&&u<f);c-=I=w>>3,m&=(1<<(w-=I<<3))-1,s.next_in=c,s.next_out=u,s.avail_in=c<h?h-c+5:5-(c-h),s.avail_out=u<f?f-u+257:257-(u-f),a.hold=m,a.bits=w}},{}],49:[function(t,i,r){var s=t("../utils/common"),o=t("./adler32"),a=t("./crc32"),c=t("./inffast"),h=t("./inftrees"),u=1,d=2,f=0,A=-2,g=1,p=852,y=592;function v(F){return(F>>>24&255)+(F>>>8&65280)+((65280&F)<<8)+((255&F)<<24)}function m(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function w(F){var B;return F&&F.state?(B=F.state,F.total_in=F.total_out=B.total=0,F.msg="",B.wrap&&(F.adler=1&B.wrap),B.mode=g,B.last=0,B.havedict=0,B.dmax=32768,B.head=null,B.hold=0,B.bits=0,B.lencode=B.lendyn=new s.Buf32(p),B.distcode=B.distdyn=new s.Buf32(y),B.sane=1,B.back=-1,f):A}function x(F){var B;return F&&F.state?((B=F.state).wsize=0,B.whave=0,B.wnext=0,w(F)):A}function T(F,B){var E,V;return F&&F.state?(V=F.state,B<0?(E=0,B=-B):(E=1+(B>>4),B<48&&(B&=15)),B&&(B<8||15<B)?A:(V.window!==null&&V.wbits!==B&&(V.window=null),V.wrap=E,V.wbits=B,x(F))):A}function j(F,B){var E,V;return F?(V=new m,(F.state=V).window=null,(E=T(F,B))!==f&&(F.state=null),E):A}var D,b,_=!0;function I(F){if(_){var B;for(D=new s.Buf32(512),b=new s.Buf32(32),B=0;B<144;)F.lens[B++]=8;for(;B<256;)F.lens[B++]=9;for(;B<280;)F.lens[B++]=7;for(;B<288;)F.lens[B++]=8;for(h(u,F.lens,0,288,D,0,F.work,{bits:9}),B=0;B<32;)F.lens[B++]=5;h(d,F.lens,0,32,b,0,F.work,{bits:5}),_=!1}F.lencode=D,F.lenbits=9,F.distcode=b,F.distbits=5}function S(F,B,E,V){var K,P=F.state;return P.window===null&&(P.wsize=1<<P.wbits,P.wnext=0,P.whave=0,P.window=new s.Buf8(P.wsize)),V>=P.wsize?(s.arraySet(P.window,B,E-P.wsize,P.wsize,0),P.wnext=0,P.whave=P.wsize):(V<(K=P.wsize-P.wnext)&&(K=V),s.arraySet(P.window,B,E-V,K,P.wnext),(V-=K)?(s.arraySet(P.window,B,E-V,V,0),P.wnext=V,P.whave=P.wsize):(P.wnext+=K,P.wnext===P.wsize&&(P.wnext=0),P.whave<P.wsize&&(P.whave+=K))),0}r.inflateReset=x,r.inflateReset2=T,r.inflateResetKeep=w,r.inflateInit=function(F){return j(F,15)},r.inflateInit2=j,r.inflate=function(F,B){var E,V,K,P,M,X,Z,Q,U,z,q,G,ie,H,se,te,fe,ye,be,_e,W,Y,ve,ce,ne=0,he=new s.Buf8(4),xe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!F||!F.state||!F.output||!F.input&&F.avail_in!==0)return A;(E=F.state).mode===12&&(E.mode=13),M=F.next_out,K=F.output,Z=F.avail_out,P=F.next_in,V=F.input,X=F.avail_in,Q=E.hold,U=E.bits,z=X,q=Z,Y=f;e:for(;;)switch(E.mode){case g:if(E.wrap===0){E.mode=13;break}for(;U<16;){if(X===0)break e;X--,Q+=V[P++]<<U,U+=8}if(2&E.wrap&&Q===35615){he[E.check=0]=255&Q,he[1]=Q>>>8&255,E.check=a(E.check,he,2,0),U=Q=0,E.mode=2;break}if(E.flags=0,E.head&&(E.head.done=!1),!(1&E.wrap)||(((255&Q)<<8)+(Q>>8))%31){F.msg="incorrect header check",E.mode=30;break}if((15&Q)!=8){F.msg="unknown compression method",E.mode=30;break}if(U-=4,W=8+(15&(Q>>>=4)),E.wbits===0)E.wbits=W;else if(W>E.wbits){F.msg="invalid window size",E.mode=30;break}E.dmax=1<<W,F.adler=E.check=1,E.mode=512&Q?10:12,U=Q=0;break;case 2:for(;U<16;){if(X===0)break e;X--,Q+=V[P++]<<U,U+=8}if(E.flags=Q,(255&E.flags)!=8){F.msg="unknown compression method",E.mode=30;break}if(57344&E.flags){F.msg="unknown header flags set",E.mode=30;break}E.head&&(E.head.text=Q>>8&1),512&E.flags&&(he[0]=255&Q,he[1]=Q>>>8&255,E.check=a(E.check,he,2,0)),U=Q=0,E.mode=3;case 3:for(;U<32;){if(X===0)break e;X--,Q+=V[P++]<<U,U+=8}E.head&&(E.head.time=Q),512&E.flags&&(he[0]=255&Q,he[1]=Q>>>8&255,he[2]=Q>>>16&255,he[3]=Q>>>24&255,E.check=a(E.check,he,4,0)),U=Q=0,E.mode=4;case 4:for(;U<16;){if(X===0)break e;X--,Q+=V[P++]<<U,U+=8}E.head&&(E.head.xflags=255&Q,E.head.os=Q>>8),512&E.flags&&(he[0]=255&Q,he[1]=Q>>>8&255,E.check=a(E.check,he,2,0)),U=Q=0,E.mode=5;case 5:if(1024&E.flags){for(;U<16;){if(X===0)break e;X--,Q+=V[P++]<<U,U+=8}E.length=Q,E.head&&(E.head.extra_len=Q),512&E.flags&&(he[0]=255&Q,he[1]=Q>>>8&255,E.check=a(E.check,he,2,0)),U=Q=0}else E.head&&(E.head.extra=null);E.mode=6;case 6:if(1024&E.flags&&(X<(G=E.length)&&(G=X),G&&(E.head&&(W=E.head.extra_len-E.length,E.head.extra||(E.head.extra=new Array(E.head.extra_len)),s.arraySet(E.head.extra,V,P,G,W)),512&E.flags&&(E.check=a(E.check,V,G,P)),X-=G,P+=G,E.length-=G),E.length))break e;E.length=0,E.mode=7;case 7:if(2048&E.flags){if(X===0)break e;for(G=0;W=V[P+G++],E.head&&W&&E.length<65536&&(E.head.name+=String.fromCharCode(W)),W&&G<X;);if(512&E.flags&&(E.check=a(E.check,V,G,P)),X-=G,P+=G,W)break e}else E.head&&(E.head.name=null);E.length=0,E.mode=8;case 8:if(4096&E.flags){if(X===0)break e;for(G=0;W=V[P+G++],E.head&&W&&E.length<65536&&(E.head.comment+=String.fromCharCode(W)),W&&G<X;);if(512&E.flags&&(E.check=a(E.check,V,G,P)),X-=G,P+=G,W)break e}else E.head&&(E.head.comment=null);E.mode=9;case 9:if(512&E.flags){for(;U<16;){if(X===0)break e;X--,Q+=V[P++]<<U,U+=8}if(Q!==(65535&E.check)){F.msg="header crc mismatch",E.mode=30;break}U=Q=0}E.head&&(E.head.hcrc=E.flags>>9&1,E.head.done=!0),F.adler=E.check=0,E.mode=12;break;case 10:for(;U<32;){if(X===0)break e;X--,Q+=V[P++]<<U,U+=8}F.adler=E.check=v(Q),U=Q=0,E.mode=11;case 11:if(E.havedict===0)return F.next_out=M,F.avail_out=Z,F.next_in=P,F.avail_in=X,E.hold=Q,E.bits=U,2;F.adler=E.check=1,E.mode=12;case 12:if(B===5||B===6)break e;case 13:if(E.last){Q>>>=7&U,U-=7&U,E.mode=27;break}for(;U<3;){if(X===0)break e;X--,Q+=V[P++]<<U,U+=8}switch(E.last=1&Q,U-=1,3&(Q>>>=1)){case 0:E.mode=14;break;case 1:if(I(E),E.mode=20,B!==6)break;Q>>>=2,U-=2;break e;case 2:E.mode=17;break;case 3:F.msg="invalid block type",E.mode=30}Q>>>=2,U-=2;break;case 14:for(Q>>>=7&U,U-=7&U;U<32;){if(X===0)break e;X--,Q+=V[P++]<<U,U+=8}if((65535&Q)!=(Q>>>16^65535)){F.msg="invalid stored block lengths",E.mode=30;break}if(E.length=65535&Q,U=Q=0,E.mode=15,B===6)break e;case 15:E.mode=16;case 16:if(G=E.length){if(X<G&&(G=X),Z<G&&(G=Z),G===0)break e;s.arraySet(K,V,P,G,M),X-=G,P+=G,Z-=G,M+=G,E.length-=G;break}E.mode=12;break;case 17:for(;U<14;){if(X===0)break e;X--,Q+=V[P++]<<U,U+=8}if(E.nlen=257+(31&Q),Q>>>=5,U-=5,E.ndist=1+(31&Q),Q>>>=5,U-=5,E.ncode=4+(15&Q),Q>>>=4,U-=4,286<E.nlen||30<E.ndist){F.msg="too many length or distance symbols",E.mode=30;break}E.have=0,E.mode=18;case 18:for(;E.have<E.ncode;){for(;U<3;){if(X===0)break e;X--,Q+=V[P++]<<U,U+=8}E.lens[xe[E.have++]]=7&Q,Q>>>=3,U-=3}for(;E.have<19;)E.lens[xe[E.have++]]=0;if(E.lencode=E.lendyn,E.lenbits=7,ve={bits:E.lenbits},Y=h(0,E.lens,0,19,E.lencode,0,E.work,ve),E.lenbits=ve.bits,Y){F.msg="invalid code lengths set",E.mode=30;break}E.have=0,E.mode=19;case 19:for(;E.have<E.nlen+E.ndist;){for(;te=(ne=E.lencode[Q&(1<<E.lenbits)-1])>>>16&255,fe=65535&ne,!((se=ne>>>24)<=U);){if(X===0)break e;X--,Q+=V[P++]<<U,U+=8}if(fe<16)Q>>>=se,U-=se,E.lens[E.have++]=fe;else{if(fe===16){for(ce=se+2;U<ce;){if(X===0)break e;X--,Q+=V[P++]<<U,U+=8}if(Q>>>=se,U-=se,E.have===0){F.msg="invalid bit length repeat",E.mode=30;break}W=E.lens[E.have-1],G=3+(3&Q),Q>>>=2,U-=2}else if(fe===17){for(ce=se+3;U<ce;){if(X===0)break e;X--,Q+=V[P++]<<U,U+=8}U-=se,W=0,G=3+(7&(Q>>>=se)),Q>>>=3,U-=3}else{for(ce=se+7;U<ce;){if(X===0)break e;X--,Q+=V[P++]<<U,U+=8}U-=se,W=0,G=11+(127&(Q>>>=se)),Q>>>=7,U-=7}if(E.have+G>E.nlen+E.ndist){F.msg="invalid bit length repeat",E.mode=30;break}for(;G--;)E.lens[E.have++]=W}}if(E.mode===30)break;if(E.lens[256]===0){F.msg="invalid code -- missing end-of-block",E.mode=30;break}if(E.lenbits=9,ve={bits:E.lenbits},Y=h(u,E.lens,0,E.nlen,E.lencode,0,E.work,ve),E.lenbits=ve.bits,Y){F.msg="invalid literal/lengths set",E.mode=30;break}if(E.distbits=6,E.distcode=E.distdyn,ve={bits:E.distbits},Y=h(d,E.lens,E.nlen,E.ndist,E.distcode,0,E.work,ve),E.distbits=ve.bits,Y){F.msg="invalid distances set",E.mode=30;break}if(E.mode=20,B===6)break e;case 20:E.mode=21;case 21:if(6<=X&&258<=Z){F.next_out=M,F.avail_out=Z,F.next_in=P,F.avail_in=X,E.hold=Q,E.bits=U,c(F,q),M=F.next_out,K=F.output,Z=F.avail_out,P=F.next_in,V=F.input,X=F.avail_in,Q=E.hold,U=E.bits,E.mode===12&&(E.back=-1);break}for(E.back=0;te=(ne=E.lencode[Q&(1<<E.lenbits)-1])>>>16&255,fe=65535&ne,!((se=ne>>>24)<=U);){if(X===0)break e;X--,Q+=V[P++]<<U,U+=8}if(te&&(240&te)==0){for(ye=se,be=te,_e=fe;te=(ne=E.lencode[_e+((Q&(1<<ye+be)-1)>>ye)])>>>16&255,fe=65535&ne,!(ye+(se=ne>>>24)<=U);){if(X===0)break e;X--,Q+=V[P++]<<U,U+=8}Q>>>=ye,U-=ye,E.back+=ye}if(Q>>>=se,U-=se,E.back+=se,E.length=fe,te===0){E.mode=26;break}if(32&te){E.back=-1,E.mode=12;break}if(64&te){F.msg="invalid literal/length code",E.mode=30;break}E.extra=15&te,E.mode=22;case 22:if(E.extra){for(ce=E.extra;U<ce;){if(X===0)break e;X--,Q+=V[P++]<<U,U+=8}E.length+=Q&(1<<E.extra)-1,Q>>>=E.extra,U-=E.extra,E.back+=E.extra}E.was=E.length,E.mode=23;case 23:for(;te=(ne=E.distcode[Q&(1<<E.distbits)-1])>>>16&255,fe=65535&ne,!((se=ne>>>24)<=U);){if(X===0)break e;X--,Q+=V[P++]<<U,U+=8}if((240&te)==0){for(ye=se,be=te,_e=fe;te=(ne=E.distcode[_e+((Q&(1<<ye+be)-1)>>ye)])>>>16&255,fe=65535&ne,!(ye+(se=ne>>>24)<=U);){if(X===0)break e;X--,Q+=V[P++]<<U,U+=8}Q>>>=ye,U-=ye,E.back+=ye}if(Q>>>=se,U-=se,E.back+=se,64&te){F.msg="invalid distance code",E.mode=30;break}E.offset=fe,E.extra=15&te,E.mode=24;case 24:if(E.extra){for(ce=E.extra;U<ce;){if(X===0)break e;X--,Q+=V[P++]<<U,U+=8}E.offset+=Q&(1<<E.extra)-1,Q>>>=E.extra,U-=E.extra,E.back+=E.extra}if(E.offset>E.dmax){F.msg="invalid distance too far back",E.mode=30;break}E.mode=25;case 25:if(Z===0)break e;if(G=q-Z,E.offset>G){if((G=E.offset-G)>E.whave&&E.sane){F.msg="invalid distance too far back",E.mode=30;break}ie=G>E.wnext?(G-=E.wnext,E.wsize-G):E.wnext-G,G>E.length&&(G=E.length),H=E.window}else H=K,ie=M-E.offset,G=E.length;for(Z<G&&(G=Z),Z-=G,E.length-=G;K[M++]=H[ie++],--G;);E.length===0&&(E.mode=21);break;case 26:if(Z===0)break e;K[M++]=E.length,Z--,E.mode=21;break;case 27:if(E.wrap){for(;U<32;){if(X===0)break e;X--,Q|=V[P++]<<U,U+=8}if(q-=Z,F.total_out+=q,E.total+=q,q&&(F.adler=E.check=E.flags?a(E.check,K,q,M-q):o(E.check,K,q,M-q)),q=Z,(E.flags?Q:v(Q))!==E.check){F.msg="incorrect data check",E.mode=30;break}U=Q=0}E.mode=28;case 28:if(E.wrap&&E.flags){for(;U<32;){if(X===0)break e;X--,Q+=V[P++]<<U,U+=8}if(Q!==(4294967295&E.total)){F.msg="incorrect length check",E.mode=30;break}U=Q=0}E.mode=29;case 29:Y=1;break e;case 30:Y=-3;break e;case 31:return-4;case 32:default:return A}return F.next_out=M,F.avail_out=Z,F.next_in=P,F.avail_in=X,E.hold=Q,E.bits=U,(E.wsize||q!==F.avail_out&&E.mode<30&&(E.mode<27||B!==4))&&S(F,F.output,F.next_out,q-F.avail_out)?(E.mode=31,-4):(z-=F.avail_in,q-=F.avail_out,F.total_in+=z,F.total_out+=q,E.total+=q,E.wrap&&q&&(F.adler=E.check=E.flags?a(E.check,K,q,F.next_out-q):o(E.check,K,q,F.next_out-q)),F.data_type=E.bits+(E.last?64:0)+(E.mode===12?128:0)+(E.mode===20||E.mode===15?256:0),(z==0&&q===0||B===4)&&Y===f&&(Y=-5),Y)},r.inflateEnd=function(F){if(!F||!F.state)return A;var B=F.state;return B.window&&(B.window=null),F.state=null,f},r.inflateGetHeader=function(F,B){var E;return F&&F.state?(2&(E=F.state).wrap)==0?A:((E.head=B).done=!1,f):A},r.inflateSetDictionary=function(F,B){var E,V=B.length;return F&&F.state?(E=F.state).wrap!==0&&E.mode!==11?A:E.mode===11&&o(1,B,V,0)!==E.check?-3:S(F,B,V,V)?(E.mode=31,-4):(E.havedict=1,f):A},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,i,r){var s=t("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],h=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(u,d,f,A,g,p,y,v){var m,w,x,T,j,D,b,_,I,S=v.bits,F=0,B=0,E=0,V=0,K=0,P=0,M=0,X=0,Z=0,Q=0,U=null,z=0,q=new s.Buf16(16),G=new s.Buf16(16),ie=null,H=0;for(F=0;F<=15;F++)q[F]=0;for(B=0;B<A;B++)q[d[f+B]]++;for(K=S,V=15;1<=V&&q[V]===0;V--);if(V<K&&(K=V),V===0)return g[p++]=20971520,g[p++]=20971520,v.bits=1,0;for(E=1;E<V&&q[E]===0;E++);for(K<E&&(K=E),F=X=1;F<=15;F++)if(X<<=1,(X-=q[F])<0)return-1;if(0<X&&(u===0||V!==1))return-1;for(G[1]=0,F=1;F<15;F++)G[F+1]=G[F]+q[F];for(B=0;B<A;B++)d[f+B]!==0&&(y[G[d[f+B]]++]=B);if(D=u===0?(U=ie=y,19):u===1?(U=o,z-=257,ie=a,H-=257,256):(U=c,ie=h,-1),F=E,j=p,M=B=Q=0,x=-1,T=(Z=1<<(P=K))-1,u===1&&852<Z||u===2&&592<Z)return 1;for(;;){for(b=F-M,I=y[B]<D?(_=0,y[B]):y[B]>D?(_=ie[H+y[B]],U[z+y[B]]):(_=96,0),m=1<<F-M,E=w=1<<P;g[j+(Q>>M)+(w-=m)]=b<<24|_<<16|I|0,w!==0;);for(m=1<<F-1;Q&m;)m>>=1;if(m!==0?(Q&=m-1,Q+=m):Q=0,B++,--q[F]==0){if(F===V)break;F=d[f+y[B]]}if(K<F&&(Q&T)!==x){for(M===0&&(M=K),j+=E,X=1<<(P=F-M);P+M<V&&!((X-=q[P+M])<=0);)P++,X<<=1;if(Z+=1<<P,u===1&&852<Z||u===2&&592<Z)return 1;g[x=Q&T]=K<<24|P<<16|j-p|0}}return Q!==0&&(g[j+Q]=F-M<<24|64<<16|0),v.bits=K,0}},{"../utils/common":41}],51:[function(t,i,r){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,i,r){var s=t("../utils/common"),o=0,a=1;function c(ne){for(var he=ne.length;0<=--he;)ne[he]=0}var h=0,u=29,d=256,f=d+1+u,A=30,g=19,p=2*f+1,y=15,v=16,m=7,w=256,x=16,T=17,j=18,D=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],b=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],_=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S=new Array(2*(f+2));c(S);var F=new Array(2*A);c(F);var B=new Array(512);c(B);var E=new Array(256);c(E);var V=new Array(u);c(V);var K,P,M,X=new Array(A);function Z(ne,he,xe,Te,Ce){this.static_tree=ne,this.extra_bits=he,this.extra_base=xe,this.elems=Te,this.max_length=Ce,this.has_stree=ne&&ne.length}function Q(ne,he){this.dyn_tree=ne,this.max_code=0,this.stat_desc=he}function U(ne){return ne<256?B[ne]:B[256+(ne>>>7)]}function z(ne,he){ne.pending_buf[ne.pending++]=255&he,ne.pending_buf[ne.pending++]=he>>>8&255}function q(ne,he,xe){ne.bi_valid>v-xe?(ne.bi_buf|=he<<ne.bi_valid&65535,z(ne,ne.bi_buf),ne.bi_buf=he>>v-ne.bi_valid,ne.bi_valid+=xe-v):(ne.bi_buf|=he<<ne.bi_valid&65535,ne.bi_valid+=xe)}function G(ne,he,xe){q(ne,xe[2*he],xe[2*he+1])}function ie(ne,he){for(var xe=0;xe|=1&ne,ne>>>=1,xe<<=1,0<--he;);return xe>>>1}function H(ne,he,xe){var Te,Ce,Be=new Array(y+1),Ye=0;for(Te=1;Te<=y;Te++)Be[Te]=Ye=Ye+xe[Te-1]<<1;for(Ce=0;Ce<=he;Ce++){var $e=ne[2*Ce+1];$e!==0&&(ne[2*Ce]=ie(Be[$e]++,$e))}}function se(ne){var he;for(he=0;he<f;he++)ne.dyn_ltree[2*he]=0;for(he=0;he<A;he++)ne.dyn_dtree[2*he]=0;for(he=0;he<g;he++)ne.bl_tree[2*he]=0;ne.dyn_ltree[2*w]=1,ne.opt_len=ne.static_len=0,ne.last_lit=ne.matches=0}function te(ne){8<ne.bi_valid?z(ne,ne.bi_buf):0<ne.bi_valid&&(ne.pending_buf[ne.pending++]=ne.bi_buf),ne.bi_buf=0,ne.bi_valid=0}function fe(ne,he,xe,Te){var Ce=2*he,Be=2*xe;return ne[Ce]<ne[Be]||ne[Ce]===ne[Be]&&Te[he]<=Te[xe]}function ye(ne,he,xe){for(var Te=ne.heap[xe],Ce=xe<<1;Ce<=ne.heap_len&&(Ce<ne.heap_len&&fe(he,ne.heap[Ce+1],ne.heap[Ce],ne.depth)&&Ce++,!fe(he,Te,ne.heap[Ce],ne.depth));)ne.heap[xe]=ne.heap[Ce],xe=Ce,Ce<<=1;ne.heap[xe]=Te}function be(ne,he,xe){var Te,Ce,Be,Ye,$e=0;if(ne.last_lit!==0)for(;Te=ne.pending_buf[ne.d_buf+2*$e]<<8|ne.pending_buf[ne.d_buf+2*$e+1],Ce=ne.pending_buf[ne.l_buf+$e],$e++,Te===0?G(ne,Ce,he):(G(ne,(Be=E[Ce])+d+1,he),(Ye=D[Be])!==0&&q(ne,Ce-=V[Be],Ye),G(ne,Be=U(--Te),xe),(Ye=b[Be])!==0&&q(ne,Te-=X[Be],Ye)),$e<ne.last_lit;);G(ne,w,he)}function _e(ne,he){var xe,Te,Ce,Be=he.dyn_tree,Ye=he.stat_desc.static_tree,$e=he.stat_desc.has_stree,ot=he.stat_desc.elems,rt=-1;for(ne.heap_len=0,ne.heap_max=p,xe=0;xe<ot;xe++)Be[2*xe]!==0?(ne.heap[++ne.heap_len]=rt=xe,ne.depth[xe]=0):Be[2*xe+1]=0;for(;ne.heap_len<2;)Be[2*(Ce=ne.heap[++ne.heap_len]=rt<2?++rt:0)]=1,ne.depth[Ce]=0,ne.opt_len--,$e&&(ne.static_len-=Ye[2*Ce+1]);for(he.max_code=rt,xe=ne.heap_len>>1;1<=xe;xe--)ye(ne,Be,xe);for(Ce=ot;xe=ne.heap[1],ne.heap[1]=ne.heap[ne.heap_len--],ye(ne,Be,1),Te=ne.heap[1],ne.heap[--ne.heap_max]=xe,ne.heap[--ne.heap_max]=Te,Be[2*Ce]=Be[2*xe]+Be[2*Te],ne.depth[Ce]=(ne.depth[xe]>=ne.depth[Te]?ne.depth[xe]:ne.depth[Te])+1,Be[2*xe+1]=Be[2*Te+1]=Ce,ne.heap[1]=Ce++,ye(ne,Be,1),2<=ne.heap_len;);ne.heap[--ne.heap_max]=ne.heap[1],(function(Ve,We){var De,Ge,Re,Ie,Le,et,ct=We.dyn_tree,mt=We.max_code,je=We.stat_desc.static_tree,le=We.stat_desc.has_stree,Je=We.stat_desc.extra_bits,ht=We.stat_desc.extra_base,ut=We.stat_desc.max_length,ft=0;for(Ie=0;Ie<=y;Ie++)Ve.bl_count[Ie]=0;for(ct[2*Ve.heap[Ve.heap_max]+1]=0,De=Ve.heap_max+1;De<p;De++)ut<(Ie=ct[2*ct[2*(Ge=Ve.heap[De])+1]+1]+1)&&(Ie=ut,ft++),ct[2*Ge+1]=Ie,mt<Ge||(Ve.bl_count[Ie]++,Le=0,ht<=Ge&&(Le=Je[Ge-ht]),et=ct[2*Ge],Ve.opt_len+=et*(Ie+Le),le&&(Ve.static_len+=et*(je[2*Ge+1]+Le)));if(ft!==0){do{for(Ie=ut-1;Ve.bl_count[Ie]===0;)Ie--;Ve.bl_count[Ie]--,Ve.bl_count[Ie+1]+=2,Ve.bl_count[ut]--,ft-=2}while(0<ft);for(Ie=ut;Ie!==0;Ie--)for(Ge=Ve.bl_count[Ie];Ge!==0;)mt<(Re=Ve.heap[--De])||(ct[2*Re+1]!==Ie&&(Ve.opt_len+=(Ie-ct[2*Re+1])*ct[2*Re],ct[2*Re+1]=Ie),Ge--)}})(ne,he),H(Be,rt,ne.bl_count)}function W(ne,he,xe){var Te,Ce,Be=-1,Ye=he[1],$e=0,ot=7,rt=4;for(Ye===0&&(ot=138,rt=3),he[2*(xe+1)+1]=65535,Te=0;Te<=xe;Te++)Ce=Ye,Ye=he[2*(Te+1)+1],++$e<ot&&Ce===Ye||($e<rt?ne.bl_tree[2*Ce]+=$e:Ce!==0?(Ce!==Be&&ne.bl_tree[2*Ce]++,ne.bl_tree[2*x]++):$e<=10?ne.bl_tree[2*T]++:ne.bl_tree[2*j]++,Be=Ce,rt=($e=0)===Ye?(ot=138,3):Ce===Ye?(ot=6,3):(ot=7,4))}function Y(ne,he,xe){var Te,Ce,Be=-1,Ye=he[1],$e=0,ot=7,rt=4;for(Ye===0&&(ot=138,rt=3),Te=0;Te<=xe;Te++)if(Ce=Ye,Ye=he[2*(Te+1)+1],!(++$e<ot&&Ce===Ye)){if($e<rt)for(;G(ne,Ce,ne.bl_tree),--$e!=0;);else Ce!==0?(Ce!==Be&&(G(ne,Ce,ne.bl_tree),$e--),G(ne,x,ne.bl_tree),q(ne,$e-3,2)):$e<=10?(G(ne,T,ne.bl_tree),q(ne,$e-3,3)):(G(ne,j,ne.bl_tree),q(ne,$e-11,7));Be=Ce,rt=($e=0)===Ye?(ot=138,3):Ce===Ye?(ot=6,3):(ot=7,4)}}c(X);var ve=!1;function ce(ne,he,xe,Te){q(ne,(h<<1)+(Te?1:0),3),(function(Ce,Be,Ye,$e){te(Ce),z(Ce,Ye),z(Ce,~Ye),s.arraySet(Ce.pending_buf,Ce.window,Be,Ye,Ce.pending),Ce.pending+=Ye})(ne,he,xe)}r._tr_init=function(ne){ve||((function(){var he,xe,Te,Ce,Be,Ye=new Array(y+1);for(Ce=Te=0;Ce<u-1;Ce++)for(V[Ce]=Te,he=0;he<1<<D[Ce];he++)E[Te++]=Ce;for(E[Te-1]=Ce,Ce=Be=0;Ce<16;Ce++)for(X[Ce]=Be,he=0;he<1<<b[Ce];he++)B[Be++]=Ce;for(Be>>=7;Ce<A;Ce++)for(X[Ce]=Be<<7,he=0;he<1<<b[Ce]-7;he++)B[256+Be++]=Ce;for(xe=0;xe<=y;xe++)Ye[xe]=0;for(he=0;he<=143;)S[2*he+1]=8,he++,Ye[8]++;for(;he<=255;)S[2*he+1]=9,he++,Ye[9]++;for(;he<=279;)S[2*he+1]=7,he++,Ye[7]++;for(;he<=287;)S[2*he+1]=8,he++,Ye[8]++;for(H(S,f+1,Ye),he=0;he<A;he++)F[2*he+1]=5,F[2*he]=ie(he,5);K=new Z(S,D,d+1,f,y),P=new Z(F,b,0,A,y),M=new Z(new Array(0),_,0,g,m)})(),ve=!0),ne.l_desc=new Q(ne.dyn_ltree,K),ne.d_desc=new Q(ne.dyn_dtree,P),ne.bl_desc=new Q(ne.bl_tree,M),ne.bi_buf=0,ne.bi_valid=0,se(ne)},r._tr_stored_block=ce,r._tr_flush_block=function(ne,he,xe,Te){var Ce,Be,Ye=0;0<ne.level?(ne.strm.data_type===2&&(ne.strm.data_type=(function($e){var ot,rt=4093624447;for(ot=0;ot<=31;ot++,rt>>>=1)if(1&rt&&$e.dyn_ltree[2*ot]!==0)return o;if($e.dyn_ltree[18]!==0||$e.dyn_ltree[20]!==0||$e.dyn_ltree[26]!==0)return a;for(ot=32;ot<d;ot++)if($e.dyn_ltree[2*ot]!==0)return a;return o})(ne)),_e(ne,ne.l_desc),_e(ne,ne.d_desc),Ye=(function($e){var ot;for(W($e,$e.dyn_ltree,$e.l_desc.max_code),W($e,$e.dyn_dtree,$e.d_desc.max_code),_e($e,$e.bl_desc),ot=g-1;3<=ot&&$e.bl_tree[2*I[ot]+1]===0;ot--);return $e.opt_len+=3*(ot+1)+5+5+4,ot})(ne),Ce=ne.opt_len+3+7>>>3,(Be=ne.static_len+3+7>>>3)<=Ce&&(Ce=Be)):Ce=Be=xe+5,xe+4<=Ce&&he!==-1?ce(ne,he,xe,Te):ne.strategy===4||Be===Ce?(q(ne,2+(Te?1:0),3),be(ne,S,F)):(q(ne,4+(Te?1:0),3),(function($e,ot,rt,Ve){var We;for(q($e,ot-257,5),q($e,rt-1,5),q($e,Ve-4,4),We=0;We<Ve;We++)q($e,$e.bl_tree[2*I[We]+1],3);Y($e,$e.dyn_ltree,ot-1),Y($e,$e.dyn_dtree,rt-1)})(ne,ne.l_desc.max_code+1,ne.d_desc.max_code+1,Ye+1),be(ne,ne.dyn_ltree,ne.dyn_dtree)),se(ne),Te&&te(ne)},r._tr_tally=function(ne,he,xe){return ne.pending_buf[ne.d_buf+2*ne.last_lit]=he>>>8&255,ne.pending_buf[ne.d_buf+2*ne.last_lit+1]=255&he,ne.pending_buf[ne.l_buf+ne.last_lit]=255&xe,ne.last_lit++,he===0?ne.dyn_ltree[2*xe]++:(ne.matches++,he--,ne.dyn_ltree[2*(E[xe]+d+1)]++,ne.dyn_dtree[2*U(he)]++),ne.last_lit===ne.lit_bufsize-1},r._tr_align=function(ne){q(ne,2,3),G(ne,w,S),(function(he){he.bi_valid===16?(z(he,he.bi_buf),he.bi_buf=0,he.bi_valid=0):8<=he.bi_valid&&(he.pending_buf[he.pending++]=255&he.bi_buf,he.bi_buf>>=8,he.bi_valid-=8)})(ne)}},{"../utils/common":41}],53:[function(t,i,r){i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,i,r){(function(s){(function(o,a){if(!o.setImmediate){var c,h,u,d,f=1,A={},g=!1,p=o.document,y=Object.getPrototypeOf&&Object.getPrototypeOf(o);y=y&&y.setTimeout?y:o,c={}.toString.call(o.process)==="[object process]"?function(x){process.nextTick(function(){m(x)})}:(function(){if(o.postMessage&&!o.importScripts){var x=!0,T=o.onmessage;return o.onmessage=function(){x=!1},o.postMessage("","*"),o.onmessage=T,x}})()?(d="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",w,!1):o.attachEvent("onmessage",w),function(x){o.postMessage(d+x,"*")}):o.MessageChannel?((u=new MessageChannel).port1.onmessage=function(x){m(x.data)},function(x){u.port2.postMessage(x)}):p&&"onreadystatechange"in p.createElement("script")?(h=p.documentElement,function(x){var T=p.createElement("script");T.onreadystatechange=function(){m(x),T.onreadystatechange=null,h.removeChild(T),T=null},h.appendChild(T)}):function(x){setTimeout(m,0,x)},y.setImmediate=function(x){typeof x!="function"&&(x=new Function(""+x));for(var T=new Array(arguments.length-1),j=0;j<T.length;j++)T[j]=arguments[j+1];var D={callback:x,args:T};return A[f]=D,c(f),f++},y.clearImmediate=v}function v(x){delete A[x]}function m(x){if(g)setTimeout(m,0,x);else{var T=A[x];if(T){g=!0;try{(function(j){var D=j.callback,b=j.args;switch(b.length){case 0:D();break;case 1:D(b[0]);break;case 2:D(b[0],b[1]);break;case 3:D(b[0],b[1],b[2]);break;default:D.apply(a,b)}})(T)}finally{v(x),g=!1}}}}function w(x){x.source===o&&typeof x.data=="string"&&x.data.indexOf(d)===0&&m(+x.data.slice(d.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof P0<"u"?P0:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(L3)),L3.exports}var EAe=BAe();const H$=Kf(EAe);async function kAe({teamId:n,designId:e,versionId:t,buffer:i,ext:r,userId:s}){const o=crypto.randomUUID(),a=`teams/${n}/designs/${e}/versions/${t}/${o}.${r}`,c=N_(nv,a);await lQ(c,new Uint8Array(i));const h=await cQ(c);return await ug(Tr(Ri,`teams/${n}/assets/${o}`),{owner_type:"version",owner_id:t,type:r,path:a,url:h,teamId:n,designId:e,created_by:s,created_at:Ks()}),{assetId:o,url:h,path:a}}async function W$(n,e,t,i,r){try{const s=ku.currentUser;if(!s)return console.error("No authenticated user for export"),null;const o=await n.arrayBuffer(),a=await kAe({teamId:t,designId:i,versionId:r,buffer:o,ext:e,userId:s.uid});return console.log(`✅ Export saved to Storage: ${a.path}`),console.log(`✅ Asset registered: ${a.assetId}`),a}catch(s){return console.error("Failed to process export:",s),null}}function M3(n,e){let t,i=!1;n instanceof Blob?(t=URL.createObjectURL(n),i=!0):t=n;const r=document.createElement("a");r.href=t,r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r),i&&URL.revokeObjectURL(t)}async function IAe(n,e,t,i,r,s){try{const o=await W$(n,t,i,r,s);o&&o.url?(console.log(`📥 Downloading from Storage: ${o.url}`),M3(o.url,e)):(console.log("⚠️ Storage save failed, using direct download"),M3(n,e))}catch(o){console.error("Export failed:",o),M3(n,e)}}async function FAe(n,e){try{console.log("🧪 테스트 시작: Export Asset Upload");const t=await DQ(n,e)||"test_version_001";console.log("📌 Version ID:",t);const i=`Test PDF Export
Team: ${n}
Design: ${e}
Version: ${t}
Timestamp: ${new Date().toISOString()}`,r=new Blob([i],{type:"application/pdf"}),s=await W$(r,"pdf",n,e,t);s?(console.log("✅ Storage 업로드 성공!"),console.log("📁 Storage 경로:",s.path),console.log("🔗 다운로드 URL:",s.url),console.log("📄 Asset ID:",s.assetId),console.log(""),console.log("Firestore 확인:"),console.log(`teams/${n}/assets/${s.assetId}`)):console.error("❌ Storage 업로드 실패")}catch(t){console.error("❌ 테스트 실패:",t)}}typeof window<"u"&&(window.testExportAsset=FAe);const Q$=()=>{const n=O.useCallback(async(r,s,o="front")=>{try{console.log(`🔧 DXF ${o} 도면 내보내기 시작...`),console.log("📊 입력 데이터:",{spaceInfo:{width:r.width,height:r.height,depth:r.depth,surroundType:r.surroundType,customColumnCount:r.customColumnCount},placedModulesCount:s.length,drawingType:o,placedModules:s.map(f=>({id:f.id,moduleId:f.moduleId,position:f.position,slotIndex:f.slotIndex,isDualSlot:f.isDualSlot,customDepth:f.customDepth}))});const a=kr(r),c={spaceInfo:r,drawingType:o,placedModules:s.map(f=>{const A=Hi(f.moduleId,a,r);return console.log(`🔍 가구 ${f.id} DXF 내보내기 치수 확인:`,{moduleId:f.moduleId,customDepth:f.customDepth,originalDepth:A==null?void 0:A.dimensions.depth,customWidth:f.customWidth,adjustedWidth:f.adjustedWidth,originalWidth:A==null?void 0:A.dimensions.width,finalWidth:f.customWidth||f.adjustedWidth||(A==null?void 0:A.dimensions.width)}),{id:f.id,moduleId:f.moduleId,position:{x:f.position.x,y:f.position.y,z:f.position.z},moduleData:{name:(A==null?void 0:A.name)||`모듈-${f.moduleId}`,dimensions:{width:f.customWidth||f.adjustedWidth||(A==null?void 0:A.dimensions.width)||400,height:(A==null?void 0:A.dimensions.height)||400,depth:f.customDepth||(A==null?void 0:A.dimensions.depth)||300}},rotation:f.rotation,slotIndex:f.slotIndex,isDualSlot:f.isDualSlot,adjustedWidth:f.adjustedWidth,customWidth:f.customWidth}})};console.log("🔄 변환된 DXF 데이터:",c);const h=FP(c),u=PP(r,o);try{const f=ku.currentUser;if(f){const A=`personal_${f.uid}`,g="current_design",p=await DQ(A,g)||"v_"+Date.now(),y=new Blob([h],{type:"application/dxf"});await IAe(y,u,"dxf",A,g,p),console.log(`✅ DXF ${o} Storage 업로드 성공!`)}else jP(h,u)}catch(f){console.error("Storage 업로드 실패, 로컬 다운로드로 폴백:",f),jP(h,u)}return console.log(`✅ DXF ${o} 도면 내보내기 완료!`),{success:!0,filename:u,message:`DXF ${{front:"정면도",plan:"평면도",side:"측면도"}[o]} 파일이 성공적으로 생성되었습니다.`}}catch(a){return console.error(`❌ DXF ${o} 도면 내보내기 실패:`,a),{success:!1,error:a instanceof Error?a.message:"알 수 없는 오류가 발생했습니다.",message:`DXF ${o} 도면 파일 생성에 실패했습니다.`}}},[]),e=O.useCallback((r,s)=>!(!r||r.width<=0||r.depth<=0),[]),t=O.useCallback((r,s)=>{if(!r)return"공간 정보가 없습니다.";if(r.width<=0||r.depth<=0)return"공간 크기를 설정해주세요.";const o=s.length;return o===0?"공간 도면만 생성됩니다.":`${o}개 가구가 포함된 도면이 생성됩니다.`},[]),i=O.useCallback(async(r,s,o)=>{try{console.log("🔧 DXF ZIP 내보내기 시작..."),console.log("📊 선택된 도면:",o);const a=new H$,c=kr(r);for(const m of o){console.log(`📄 ${m} 도면 생성 중...`);const w={spaceInfo:r,drawingType:m,placedModules:s.map(j=>{const D=Hi(j.moduleId,c,r);return{id:j.id,moduleId:j.moduleId,position:{x:j.position.x,y:j.position.y,z:j.position.z},moduleData:{name:(D==null?void 0:D.name)||`모듈-${j.moduleId}`,dimensions:{width:(D==null?void 0:D.dimensions.width)||400,height:(D==null?void 0:D.dimensions.height)||400,depth:j.customDepth||(D==null?void 0:D.dimensions.depth)||300}},rotation:j.rotation,slotIndex:j.slotIndex,isDualSlot:j.isDualSlot}})},x=FP(w),T=PP(r,m);a.file(T,x),console.log(`✅ ${m} 도면 추가 완료: ${T}`)}const h=`가구 배치 도면 (DXF)
========================

생성일: ${new Date().toLocaleDateString("ko-KR")}
공간 크기: ${r.width}mm × ${r.height}mm × ${r.depth}mm

포함된 도면:
${o.map(m=>({front:"- 정면도 (Front Elevation)",plan:"- 평면도 (Plan View)",side:"- 측면도 (Side Section)"})[m]||`- ${m}`).join(`
`)}

가구 개수: ${s.length}개

도면 정보:
- 축척: 1:100
- 단위: mm (밀리미터)
- CAD 호환: AutoCAD DXF 형식

참고사항:
- 모든 치수는 밀리미터(mm) 단위입니다.
- 가구 배치는 실제 공간 치수를 기준으로 합니다.
- DXF 파일은 대부분의 CAD 프로그램에서 열 수 있습니다.
`;a.file("README.txt",h);const u=await a.generateAsync({type:"blob"}),d=new Date().toISOString().slice(0,19).replace(/[:-]/g,""),A=`furniture-drawings-${`${r.width}W-${r.height}H-${r.depth}D`}-${d}.zip`,g=URL.createObjectURL(u),p=document.createElement("a");p.href=g,p.download=A,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(g),console.log(`✅ DXF ZIP 파일 다운로드 완료: ${A}`);const y={front:"정면도",plan:"평면도",side:"측면도"},v=o.map(m=>y[m]).join(", ");return{success:!0,filename:A,message:`DXF 도면 ${o.length}개 (${v})가 ZIP 파일로 생성되었습니다.`}}catch(a){return console.error("❌ DXF ZIP 내보내기 실패:",a),{success:!1,error:a instanceof Error?a.message:"알 수 없는 오류가 발생했습니다.",message:"DXF ZIP 파일 생성에 실패했습니다."}}},[]);return{exportToDXF:n,exportToZIP:i,canExportDXF:e,getExportStatusMessage:t}};function Ds(n){"@babel/helpers - typeof";return Ds=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ds(n)}var Du=Uint8Array,ah=Uint16Array,RI=Int32Array,OI=new Du([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),UI=new Du([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),LP=new Du([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),$$=function(n,e){for(var t=new ah(31),i=0;i<31;++i)t[i]=e+=1<<n[i-1];for(var r=new RI(t[30]),i=1;i<30;++i)for(var s=t[i];s<t[i+1];++s)r[s]=s-t[i]<<5|i;return{b:t,r}},V$=$$(OI,2),DAe=V$.b,SE=V$.r;DAe[28]=258,SE[258]=28;var jAe=$$(UI,0),MP=jAe.r,TE=new ah(32768);for(var vo=0;vo<32768;++vo){var ZA=(vo&43690)>>1|(vo&21845)<<1;ZA=(ZA&52428)>>2|(ZA&13107)<<2,ZA=(ZA&61680)>>4|(ZA&3855)<<4,TE[vo]=((ZA&65280)>>8|(ZA&255)<<8)>>1}var ky=(function(n,e,t){for(var i=n.length,r=0,s=new ah(e);r<i;++r)n[r]&&++s[n[r]-1];var o=new ah(e);for(r=1;r<e;++r)o[r]=o[r-1]+s[r-1]<<1;var a;if(t){a=new ah(1<<e);var c=15-e;for(r=0;r<i;++r)if(n[r])for(var h=r<<4|n[r],u=e-n[r],d=o[n[r]-1]++<<u,f=d|(1<<u)-1;d<=f;++d)a[TE[d]>>c]=h}else for(a=new ah(i),r=0;r<i;++r)n[r]&&(a[r]=TE[o[n[r]-1]++]>>15-n[r]);return a}),fg=new Du(288);for(var vo=0;vo<144;++vo)fg[vo]=8;for(var vo=144;vo<256;++vo)fg[vo]=9;for(var vo=256;vo<280;++vo)fg[vo]=7;for(var vo=280;vo<288;++vo)fg[vo]=8;var eC=new Du(32);for(var vo=0;vo<32;++vo)eC[vo]=5;var PAe=ky(fg,9,0),NAe=ky(eC,5,0),z$=function(n){return(n+7)/8|0},LAe=function(n,e,t){return(t==null||t>n.length)&&(t=n.length),new Du(n.subarray(e,t))},$d=function(n,e,t){t<<=e&7;var i=e/8|0;n[i]|=t,n[i+1]|=t>>8},U1=function(n,e,t){t<<=e&7;var i=e/8|0;n[i]|=t,n[i+1]|=t>>8,n[i+2]|=t>>16},R3=function(n,e){for(var t=[],i=0;i<n.length;++i)n[i]&&t.push({s:i,f:n[i]});var r=t.length,s=t.slice();if(!r)return{t:X$,l:0};if(r==1){var o=new Du(t[0].s+1);return o[t[0].s]=1,{t:o,l:1}}t.sort(function(T,j){return T.f-j.f}),t.push({s:-1,f:25001});var a=t[0],c=t[1],h=0,u=1,d=2;for(t[0]={s:-1,f:a.f+c.f,l:a,r:c};u!=r-1;)a=t[t[h].f<t[d].f?h++:d++],c=t[h!=u&&t[h].f<t[d].f?h++:d++],t[u++]={s:-1,f:a.f+c.f,l:a,r:c};for(var f=s[0].s,i=1;i<r;++i)s[i].s>f&&(f=s[i].s);var A=new ah(f+1),g=BE(t[u-1],A,0);if(g>e){var i=0,p=0,y=g-e,v=1<<y;for(s.sort(function(j,D){return A[D.s]-A[j.s]||j.f-D.f});i<r;++i){var m=s[i].s;if(A[m]>e)p+=v-(1<<g-A[m]),A[m]=e;else break}for(p>>=y;p>0;){var w=s[i].s;A[w]<e?p-=1<<e-A[w]++-1:++i}for(;i>=0&&p;--i){var x=s[i].s;A[x]==e&&(--A[x],++p)}g=e}return{t:new Du(A),l:g}},BE=function(n,e,t){return n.s==-1?Math.max(BE(n.l,e,t+1),BE(n.r,e,t+1)):e[n.s]=t},RP=function(n){for(var e=n.length;e&&!n[--e];);for(var t=new ah(++e),i=0,r=n[0],s=1,o=function(c){t[i++]=c},a=1;a<=e;++a)if(n[a]==r&&a!=e)++s;else{if(!r&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(r),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(r);s=1,r=n[a]}return{c:t.subarray(0,i),n:e}},H1=function(n,e){for(var t=0,i=0;i<e.length;++i)t+=n[i]*e[i];return t},G$=function(n,e,t){var i=t.length,r=z$(e+2);n[r]=i&255,n[r+1]=i>>8,n[r+2]=n[r]^255,n[r+3]=n[r+1]^255;for(var s=0;s<i;++s)n[r+s+4]=t[s];return(r+4+i)*8},OP=function(n,e,t,i,r,s,o,a,c,h,u){$d(e,u++,t),++r[256];for(var d=R3(r,15),f=d.t,A=d.l,g=R3(s,15),p=g.t,y=g.l,v=RP(f),m=v.c,w=v.n,x=RP(p),T=x.c,j=x.n,D=new ah(19),b=0;b<m.length;++b)++D[m[b]&31];for(var b=0;b<T.length;++b)++D[T[b]&31];for(var _=R3(D,7),I=_.t,S=_.l,F=19;F>4&&!I[LP[F-1]];--F);var B=h+5<<3,E=H1(r,fg)+H1(s,eC)+o,V=H1(r,f)+H1(s,p)+o+14+3*F+H1(D,I)+2*D[16]+3*D[17]+7*D[18];if(c>=0&&B<=E&&B<=V)return G$(e,u,n.subarray(c,c+h));var K,P,M,X;if($d(e,u,1+(V<E)),u+=2,V<E){K=ky(f,A,0),P=f,M=ky(p,y,0),X=p;var Z=ky(I,S,0);$d(e,u,w-257),$d(e,u+5,j-1),$d(e,u+10,F-4),u+=14;for(var b=0;b<F;++b)$d(e,u+3*b,I[LP[b]]);u+=3*F;for(var Q=[m,T],U=0;U<2;++U)for(var z=Q[U],b=0;b<z.length;++b){var q=z[b]&31;$d(e,u,Z[q]),u+=I[q],q>15&&($d(e,u,z[b]>>5&127),u+=z[b]>>12)}}else K=PAe,P=fg,M=NAe,X=eC;for(var b=0;b<a;++b){var G=i[b];if(G>255){var q=G>>18&31;U1(e,u,K[q+257]),u+=P[q+257],q>7&&($d(e,u,G>>23&31),u+=OI[q]);var ie=G&31;U1(e,u,M[ie]),u+=X[ie],ie>3&&(U1(e,u,G>>5&8191),u+=UI[ie])}else U1(e,u,K[G]),u+=P[G]}return U1(e,u,K[256]),u+P[256]},MAe=new RI([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),X$=new Du(0),RAe=function(n,e,t,i,r,s){var o=s.z||n.length,a=new Du(i+o+5*(1+Math.ceil(o/7e3))+r),c=a.subarray(i,a.length-r),h=s.l,u=(s.r||0)&7;if(e){u&&(c[0]=s.r>>3);for(var d=MAe[e-1],f=d>>13,A=d&8191,g=(1<<t)-1,p=s.p||new ah(32768),y=s.h||new ah(g+1),v=Math.ceil(t/3),m=2*v,w=function(W){return(n[W]^n[W+1]<<v^n[W+2]<<m)&g},x=new RI(25e3),T=new ah(288),j=new ah(32),D=0,b=0,_=s.i||0,I=0,S=s.w||0,F=0;_+2<o;++_){var B=w(_),E=_&32767,V=y[B];if(p[E]=V,y[B]=E,S<=_){var K=o-_;if((D>7e3||I>24576)&&(K>423||!h)){u=OP(n,c,0,x,T,j,b,I,F,_-F,u),I=D=b=0,F=_;for(var P=0;P<286;++P)T[P]=0;for(var P=0;P<30;++P)j[P]=0}var M=2,X=0,Z=A,Q=E-V&32767;if(K>2&&B==w(_-Q))for(var U=Math.min(f,K)-1,z=Math.min(32767,_),q=Math.min(258,K);Q<=z&&--Z&&E!=V;){if(n[_+M]==n[_+M-Q]){for(var G=0;G<q&&n[_+G]==n[_+G-Q];++G);if(G>M){if(M=G,X=Q,G>U)break;for(var ie=Math.min(Q,G-2),H=0,P=0;P<ie;++P){var se=_-Q+P&32767,te=p[se],fe=se-te&32767;fe>H&&(H=fe,V=se)}}}E=V,V=p[E],Q+=E-V&32767}if(X){x[I++]=268435456|SE[M]<<18|MP[X];var ye=SE[M]&31,be=MP[X]&31;b+=OI[ye]+UI[be],++T[257+ye],++j[be],S=_+M,++D}else x[I++]=n[_],++T[n[_]]}}for(_=Math.max(_,S);_<o;++_)x[I++]=n[_],++T[n[_]];u=OP(n,c,h,x,T,j,b,I,F,_-F,u),h||(s.r=u&7|c[u/8|0]<<3,u-=7,s.h=y,s.p=p,s.i=_,s.w=S)}else{for(var _=s.w||0;_<o+h;_+=65535){var _e=_+65535;_e>=o&&(c[u/8|0]=h,_e=o),u=G$(c,u+1,n.subarray(_,_e))}s.i=o}return LAe(a,0,i+z$(u)+r)},K$=function(){var n=1,e=0;return{p:function(t){for(var i=n,r=e,s=t.length|0,o=0;o!=s;){for(var a=Math.min(o+2655,s);o<a;++o)r+=i+=t[o];i=(i&65535)+15*(i>>16),r=(r&65535)+15*(r>>16)}n=i,e=r},d:function(){return n%=65521,e%=65521,(n&255)<<24|(n&65280)<<8|(e&255)<<8|e>>8}}},OAe=function(n,e,t,i,r){if(!r&&(r={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),o=new Du(s.length+n.length);o.set(s),o.set(n,s.length),n=o,r.w=s.length}return RAe(n,e.level==null?6:e.level,e.mem==null?r.l?Math.ceil(Math.max(8,Math.min(13,Math.log(n.length)))*1.5):20:12+e.mem,t,i,r)},q$=function(n,e,t){for(;t;++e)n[e]=t,t>>>=8},UAe=function(n,e){var t=e.level,i=t==0?0:t<6?1:t==9?3:2;if(n[0]=120,n[1]=i<<6|(e.dictionary&&32),n[1]|=31-(n[0]<<8|n[1])%31,e.dictionary){var r=K$();r.p(e.dictionary),q$(n,2,r.d())}};function EE(n,e){e||(e={});var t=K$();t.p(n);var i=OAe(n,e,e.dictionary?6:2,4);return UAe(i,e),q$(i,i.length-4,t.d()),i}var HAe=typeof TextDecoder<"u"&&new TextDecoder,WAe=0;try{HAe.decode(X$,{stream:!0}),WAe=1}catch{}function QAe(n){if(Array.isArray(n))return n}function $Ae(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,o,a=[],c=!0,h=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(c=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);c=!0);}catch(u){h=!0,r=u}finally{try{if(!c&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(h)throw r}}return a}}function UP(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function VAe(n,e){if(n){if(typeof n=="string")return UP(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?UP(n,e):void 0}}function zAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HP(n,e){return QAe(n)||$Ae(n,e)||VAe(n,e)||zAe()}function WP(n,e="utf8"){return new TextDecoder(e).decode(n)}const GAe=new TextEncoder;function XAe(n){return GAe.encode(n)}const KAe=1024*8,qAe=(()=>{const n=new Uint8Array(4),e=new Uint32Array(n.buffer);return!((e[0]=1)&n[0])})(),O3={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class HI{constructor(e=KAe,t={}){rr(this,"buffer");rr(this,"byteLength");rr(this,"byteOffset");rr(this,"length");rr(this,"offset");rr(this,"lastWrittenByte");rr(this,"littleEndian");rr(this,"_data");rr(this,"_mark");rr(this,"_marks");let i=!1;typeof e=="number"?e=new ArrayBuffer(e):(i=!0,this.lastWrittenByte=e.byteLength);const r=t.offset?t.offset>>>0:0,s=e.byteLength-r;let o=r;(ArrayBuffer.isView(e)||e instanceof HI)&&(e.byteLength!==e.buffer.byteLength&&(o=e.byteOffset+r),e=e.buffer),i?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=e,this.length=s,this.byteLength=s,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,s),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(e===void 0)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){const i=(this.offset+e)*2,r=new Uint8Array(i);r.set(new Uint8Array(this.buffer)),this.buffer=r.buffer,this.length=i,this.byteLength=i,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,t){const i=O3[t].BYTES_PER_ELEMENT*e,r=this.byteOffset+this.offset,s=this.buffer.slice(r,r+i);if(this.littleEndian===qAe&&t!=="uint8"&&t!=="int8"){const a=new Uint8Array(this.buffer.slice(r,r+i));a.reverse();const c=new O3[t](a.buffer);return this.offset+=i,c.reverse(),c}const o=new O3[t](s);return this.offset+=i,o}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let t="";for(let i=0;i<e;i++)t+=this.readChar();return t}readUtf8(e=1){return WP(this.readBytes(e))}decodeText(e=1,t="utf8"){return WP(this.readBytes(e),t)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(e){return this.writeBytes(XAe(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function qm(n){let e=n.length;for(;--e>=0;)n[e]=0}const YAe=3,ZAe=258,Y$=29,JAe=256,efe=JAe+1+Y$,Z$=30,tfe=512,nfe=new Array((efe+2)*2);qm(nfe);const ife=new Array(Z$*2);qm(ife);const rfe=new Array(tfe);qm(rfe);const sfe=new Array(ZAe-YAe+1);qm(sfe);const ofe=new Array(Y$);qm(ofe);const afe=new Array(Z$);qm(afe);const lfe=(n,e,t,i)=>{let r=n&65535|0,s=n>>>16&65535|0,o=0;for(;t!==0;){o=t>2e3?2e3:t,t-=o;do r=r+e[i++]|0,s=s+r|0;while(--o);r%=65521,s%=65521}return r|s<<16|0};var kE=lfe;const cfe=()=>{let n,e=[];for(var t=0;t<256;t++){n=t;for(var i=0;i<8;i++)n=n&1?3988292384^n>>>1:n>>>1;e[t]=n}return e},hfe=new Uint32Array(cfe()),ufe=(n,e,t,i)=>{const r=hfe,s=i+t;n^=-1;for(let o=i;o<s;o++)n=n>>>8^r[(n^e[o])&255];return n^-1};var Gu=ufe,IE={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},J$={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const dfe=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var Afe=function(n){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const i in t)dfe(t,i)&&(n[i]=t[i])}}return n},ffe=n=>{let e=0;for(let i=0,r=n.length;i<r;i++)e+=n[i].length;const t=new Uint8Array(e);for(let i=0,r=0,s=n.length;i<s;i++){let o=n[i];t.set(o,r),r+=o.length}return t},eV={assign:Afe,flattenChunks:ffe};let tV=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{tV=!1}const dv=new Uint8Array(256);for(let n=0;n<256;n++)dv[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;dv[254]=dv[254]=1;var pfe=n=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(n);let e,t,i,r,s,o=n.length,a=0;for(r=0;r<o;r++)t=n.charCodeAt(r),(t&64512)===55296&&r+1<o&&(i=n.charCodeAt(r+1),(i&64512)===56320&&(t=65536+(t-55296<<10)+(i-56320),r++)),a+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(a),s=0,r=0;s<a;r++)t=n.charCodeAt(r),(t&64512)===55296&&r+1<o&&(i=n.charCodeAt(r+1),(i&64512)===56320&&(t=65536+(t-55296<<10)+(i-56320),r++)),t<128?e[s++]=t:t<2048?(e[s++]=192|t>>>6,e[s++]=128|t&63):t<65536?(e[s++]=224|t>>>12,e[s++]=128|t>>>6&63,e[s++]=128|t&63):(e[s++]=240|t>>>18,e[s++]=128|t>>>12&63,e[s++]=128|t>>>6&63,e[s++]=128|t&63);return e};const gfe=(n,e)=>{if(e<65534&&n.subarray&&tV)return String.fromCharCode.apply(null,n.length===e?n:n.subarray(0,e));let t="";for(let i=0;i<e;i++)t+=String.fromCharCode(n[i]);return t};var mfe=(n,e)=>{const t=e||n.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(n.subarray(0,e));let i,r;const s=new Array(t*2);for(r=0,i=0;i<t;){let o=n[i++];if(o<128){s[r++]=o;continue}let a=dv[o];if(a>4){s[r++]=65533,i+=a-1;continue}for(o&=a===2?31:a===3?15:7;a>1&&i<t;)o=o<<6|n[i++]&63,a--;if(a>1){s[r++]=65533;continue}o<65536?s[r++]=o:(o-=65536,s[r++]=55296|o>>10&1023,s[r++]=56320|o&1023)}return gfe(s,r)},yfe=(n,e)=>{e=e||n.length,e>n.length&&(e=n.length);let t=e-1;for(;t>=0&&(n[t]&192)===128;)t--;return t<0||t===0?e:t+dv[n[t]]>e?t:e},FE={string2buf:pfe,buf2string:mfe,utf8border:yfe};function vfe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var wfe=vfe;const xx=16209,xfe=16191;var bfe=function(e,t){let i,r,s,o,a,c,h,u,d,f,A,g,p,y,v,m,w,x,T,j,D,b,_,I;const S=e.state;i=e.next_in,_=e.input,r=i+(e.avail_in-5),s=e.next_out,I=e.output,o=s-(t-e.avail_out),a=s+(e.avail_out-257),c=S.dmax,h=S.wsize,u=S.whave,d=S.wnext,f=S.window,A=S.hold,g=S.bits,p=S.lencode,y=S.distcode,v=(1<<S.lenbits)-1,m=(1<<S.distbits)-1;e:do{g<15&&(A+=_[i++]<<g,g+=8,A+=_[i++]<<g,g+=8),w=p[A&v];t:for(;;){if(x=w>>>24,A>>>=x,g-=x,x=w>>>16&255,x===0)I[s++]=w&65535;else if(x&16){T=w&65535,x&=15,x&&(g<x&&(A+=_[i++]<<g,g+=8),T+=A&(1<<x)-1,A>>>=x,g-=x),g<15&&(A+=_[i++]<<g,g+=8,A+=_[i++]<<g,g+=8),w=y[A&m];n:for(;;){if(x=w>>>24,A>>>=x,g-=x,x=w>>>16&255,x&16){if(j=w&65535,x&=15,g<x&&(A+=_[i++]<<g,g+=8,g<x&&(A+=_[i++]<<g,g+=8)),j+=A&(1<<x)-1,j>c){e.msg="invalid distance too far back",S.mode=xx;break e}if(A>>>=x,g-=x,x=s-o,j>x){if(x=j-x,x>u&&S.sane){e.msg="invalid distance too far back",S.mode=xx;break e}if(D=0,b=f,d===0){if(D+=h-x,x<T){T-=x;do I[s++]=f[D++];while(--x);D=s-j,b=I}}else if(d<x){if(D+=h+d-x,x-=d,x<T){T-=x;do I[s++]=f[D++];while(--x);if(D=0,d<T){x=d,T-=x;do I[s++]=f[D++];while(--x);D=s-j,b=I}}}else if(D+=d-x,x<T){T-=x;do I[s++]=f[D++];while(--x);D=s-j,b=I}for(;T>2;)I[s++]=b[D++],I[s++]=b[D++],I[s++]=b[D++],T-=3;T&&(I[s++]=b[D++],T>1&&(I[s++]=b[D++]))}else{D=s-j;do I[s++]=I[D++],I[s++]=I[D++],I[s++]=I[D++],T-=3;while(T>2);T&&(I[s++]=I[D++],T>1&&(I[s++]=I[D++]))}}else if((x&64)===0){w=y[(w&65535)+(A&(1<<x)-1)];continue n}else{e.msg="invalid distance code",S.mode=xx;break e}break}}else if((x&64)===0){w=p[(w&65535)+(A&(1<<x)-1)];continue t}else if(x&32){S.mode=xfe;break e}else{e.msg="invalid literal/length code",S.mode=xx;break e}break}}while(i<r&&s<a);T=g>>3,i-=T,g-=T<<3,A&=(1<<g)-1,e.next_in=i,e.next_out=s,e.avail_in=i<r?5+(r-i):5-(i-r),e.avail_out=s<a?257+(a-s):257-(s-a),S.hold=A,S.bits=g};const s0=15,QP=852,$P=592,VP=0,U3=1,zP=2,_fe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Cfe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Sfe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Tfe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Bfe=(n,e,t,i,r,s,o,a)=>{const c=a.bits;let h=0,u=0,d=0,f=0,A=0,g=0,p=0,y=0,v=0,m=0,w,x,T,j,D,b=null,_;const I=new Uint16Array(s0+1),S=new Uint16Array(s0+1);let F=null,B,E,V;for(h=0;h<=s0;h++)I[h]=0;for(u=0;u<i;u++)I[e[t+u]]++;for(A=c,f=s0;f>=1&&I[f]===0;f--);if(A>f&&(A=f),f===0)return r[s++]=1<<24|64<<16|0,r[s++]=1<<24|64<<16|0,a.bits=1,0;for(d=1;d<f&&I[d]===0;d++);for(A<d&&(A=d),y=1,h=1;h<=s0;h++)if(y<<=1,y-=I[h],y<0)return-1;if(y>0&&(n===VP||f!==1))return-1;for(S[1]=0,h=1;h<s0;h++)S[h+1]=S[h]+I[h];for(u=0;u<i;u++)e[t+u]!==0&&(o[S[e[t+u]]++]=u);if(n===VP?(b=F=o,_=20):n===U3?(b=_fe,F=Cfe,_=257):(b=Sfe,F=Tfe,_=0),m=0,u=0,h=d,D=s,g=A,p=0,T=-1,v=1<<A,j=v-1,n===U3&&v>QP||n===zP&&v>$P)return 1;for(;;){B=h-p,o[u]+1<_?(E=0,V=o[u]):o[u]>=_?(E=F[o[u]-_],V=b[o[u]-_]):(E=96,V=0),w=1<<h-p,x=1<<g,d=x;do x-=w,r[D+(m>>p)+x]=B<<24|E<<16|V|0;while(x!==0);for(w=1<<h-1;m&w;)w>>=1;if(w!==0?(m&=w-1,m+=w):m=0,u++,--I[h]===0){if(h===f)break;h=e[t+o[u]]}if(h>A&&(m&j)!==T){for(p===0&&(p=A),D+=d,g=h-p,y=1<<g;g+p<f&&(y-=I[g+p],!(y<=0));)g++,y<<=1;if(v+=1<<g,n===U3&&v>QP||n===zP&&v>$P)return 1;T=m&j,r[T]=A<<24|g<<16|D-s|0}}return m!==0&&(r[D+m]=h-p<<24|64<<16|0),a.bits=A,0};var Iy=Bfe;const Efe=0,nV=1,iV=2,{Z_FINISH:GP,Z_BLOCK:kfe,Z_TREES:bx,Z_OK:pg,Z_STREAM_END:Ife,Z_NEED_DICT:Ffe,Z_STREAM_ERROR:qh,Z_DATA_ERROR:rV,Z_MEM_ERROR:sV,Z_BUF_ERROR:Dfe,Z_DEFLATED:XP}=J$,D5=16180,KP=16181,qP=16182,YP=16183,ZP=16184,JP=16185,eN=16186,tN=16187,nN=16188,iN=16189,tC=16190,Vd=16191,H3=16192,rN=16193,W3=16194,sN=16195,oN=16196,aN=16197,lN=16198,_x=16199,Cx=16200,cN=16201,hN=16202,uN=16203,dN=16204,AN=16205,Q3=16206,fN=16207,pN=16208,Co=16209,oV=16210,aV=16211,jfe=852,Pfe=592,Nfe=15,Lfe=Nfe,gN=n=>(n>>>24&255)+(n>>>8&65280)+((n&65280)<<8)+((n&255)<<24);function Mfe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const kg=n=>{if(!n)return 1;const e=n.state;return!e||e.strm!==n||e.mode<D5||e.mode>aV?1:0},lV=n=>{if(kg(n))return qh;const e=n.state;return n.total_in=n.total_out=e.total=0,n.msg="",e.wrap&&(n.adler=e.wrap&1),e.mode=D5,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(jfe),e.distcode=e.distdyn=new Int32Array(Pfe),e.sane=1,e.back=-1,pg},cV=n=>{if(kg(n))return qh;const e=n.state;return e.wsize=0,e.whave=0,e.wnext=0,lV(n)},hV=(n,e)=>{let t;if(kg(n))return qh;const i=n.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?qh:(i.window!==null&&i.wbits!==e&&(i.window=null),i.wrap=t,i.wbits=e,cV(n))},uV=(n,e)=>{if(!n)return qh;const t=new Mfe;n.state=t,t.strm=n,t.window=null,t.mode=D5;const i=hV(n,e);return i!==pg&&(n.state=null),i},Rfe=n=>uV(n,Lfe);let mN=!0,$3,V3;const Ofe=n=>{if(mN){$3=new Int32Array(512),V3=new Int32Array(32);let e=0;for(;e<144;)n.lens[e++]=8;for(;e<256;)n.lens[e++]=9;for(;e<280;)n.lens[e++]=7;for(;e<288;)n.lens[e++]=8;for(Iy(nV,n.lens,0,288,$3,0,n.work,{bits:9}),e=0;e<32;)n.lens[e++]=5;Iy(iV,n.lens,0,32,V3,0,n.work,{bits:5}),mN=!1}n.lencode=$3,n.lenbits=9,n.distcode=V3,n.distbits=5},dV=(n,e,t,i)=>{let r;const s=n.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(e.subarray(t-s.wsize,t),0),s.wnext=0,s.whave=s.wsize):(r=s.wsize-s.wnext,r>i&&(r=i),s.window.set(e.subarray(t-i,t-i+r),s.wnext),i-=r,i?(s.window.set(e.subarray(t-i,t),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0},Ufe=(n,e)=>{let t,i,r,s,o,a,c,h,u,d,f,A,g,p,y=0,v,m,w,x,T,j,D,b;const _=new Uint8Array(4);let I,S;const F=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(kg(n)||!n.output||!n.input&&n.avail_in!==0)return qh;t=n.state,t.mode===Vd&&(t.mode=H3),o=n.next_out,r=n.output,c=n.avail_out,s=n.next_in,i=n.input,a=n.avail_in,h=t.hold,u=t.bits,d=a,f=c,b=pg;e:for(;;)switch(t.mode){case D5:if(t.wrap===0){t.mode=H3;break}for(;u<16;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}if(t.wrap&2&&h===35615){t.wbits===0&&(t.wbits=15),t.check=0,_[0]=h&255,_[1]=h>>>8&255,t.check=Gu(t.check,_,2,0),h=0,u=0,t.mode=KP;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((h&255)<<8)+(h>>8))%31){n.msg="incorrect header check",t.mode=Co;break}if((h&15)!==XP){n.msg="unknown compression method",t.mode=Co;break}if(h>>>=4,u-=4,D=(h&15)+8,t.wbits===0&&(t.wbits=D),D>15||D>t.wbits){n.msg="invalid window size",t.mode=Co;break}t.dmax=1<<t.wbits,t.flags=0,n.adler=t.check=1,t.mode=h&512?iN:Vd,h=0,u=0;break;case KP:for(;u<16;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}if(t.flags=h,(t.flags&255)!==XP){n.msg="unknown compression method",t.mode=Co;break}if(t.flags&57344){n.msg="unknown header flags set",t.mode=Co;break}t.head&&(t.head.text=h>>8&1),t.flags&512&&t.wrap&4&&(_[0]=h&255,_[1]=h>>>8&255,t.check=Gu(t.check,_,2,0)),h=0,u=0,t.mode=qP;case qP:for(;u<32;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}t.head&&(t.head.time=h),t.flags&512&&t.wrap&4&&(_[0]=h&255,_[1]=h>>>8&255,_[2]=h>>>16&255,_[3]=h>>>24&255,t.check=Gu(t.check,_,4,0)),h=0,u=0,t.mode=YP;case YP:for(;u<16;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}t.head&&(t.head.xflags=h&255,t.head.os=h>>8),t.flags&512&&t.wrap&4&&(_[0]=h&255,_[1]=h>>>8&255,t.check=Gu(t.check,_,2,0)),h=0,u=0,t.mode=ZP;case ZP:if(t.flags&1024){for(;u<16;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}t.length=h,t.head&&(t.head.extra_len=h),t.flags&512&&t.wrap&4&&(_[0]=h&255,_[1]=h>>>8&255,t.check=Gu(t.check,_,2,0)),h=0,u=0}else t.head&&(t.head.extra=null);t.mode=JP;case JP:if(t.flags&1024&&(A=t.length,A>a&&(A=a),A&&(t.head&&(D=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(i.subarray(s,s+A),D)),t.flags&512&&t.wrap&4&&(t.check=Gu(t.check,i,A,s)),a-=A,s+=A,t.length-=A),t.length))break e;t.length=0,t.mode=eN;case eN:if(t.flags&2048){if(a===0)break e;A=0;do D=i[s+A++],t.head&&D&&t.length<65536&&(t.head.name+=String.fromCharCode(D));while(D&&A<a);if(t.flags&512&&t.wrap&4&&(t.check=Gu(t.check,i,A,s)),a-=A,s+=A,D)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=tN;case tN:if(t.flags&4096){if(a===0)break e;A=0;do D=i[s+A++],t.head&&D&&t.length<65536&&(t.head.comment+=String.fromCharCode(D));while(D&&A<a);if(t.flags&512&&t.wrap&4&&(t.check=Gu(t.check,i,A,s)),a-=A,s+=A,D)break e}else t.head&&(t.head.comment=null);t.mode=nN;case nN:if(t.flags&512){for(;u<16;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}if(t.wrap&4&&h!==(t.check&65535)){n.msg="header crc mismatch",t.mode=Co;break}h=0,u=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),n.adler=t.check=0,t.mode=Vd;break;case iN:for(;u<32;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}n.adler=t.check=gN(h),h=0,u=0,t.mode=tC;case tC:if(t.havedict===0)return n.next_out=o,n.avail_out=c,n.next_in=s,n.avail_in=a,t.hold=h,t.bits=u,Ffe;n.adler=t.check=1,t.mode=Vd;case Vd:if(e===kfe||e===bx)break e;case H3:if(t.last){h>>>=u&7,u-=u&7,t.mode=Q3;break}for(;u<3;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}switch(t.last=h&1,h>>>=1,u-=1,h&3){case 0:t.mode=rN;break;case 1:if(Ofe(t),t.mode=_x,e===bx){h>>>=2,u-=2;break e}break;case 2:t.mode=oN;break;case 3:n.msg="invalid block type",t.mode=Co}h>>>=2,u-=2;break;case rN:for(h>>>=u&7,u-=u&7;u<32;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}if((h&65535)!==(h>>>16^65535)){n.msg="invalid stored block lengths",t.mode=Co;break}if(t.length=h&65535,h=0,u=0,t.mode=W3,e===bx)break e;case W3:t.mode=sN;case sN:if(A=t.length,A){if(A>a&&(A=a),A>c&&(A=c),A===0)break e;r.set(i.subarray(s,s+A),o),a-=A,s+=A,c-=A,o+=A,t.length-=A;break}t.mode=Vd;break;case oN:for(;u<14;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}if(t.nlen=(h&31)+257,h>>>=5,u-=5,t.ndist=(h&31)+1,h>>>=5,u-=5,t.ncode=(h&15)+4,h>>>=4,u-=4,t.nlen>286||t.ndist>30){n.msg="too many length or distance symbols",t.mode=Co;break}t.have=0,t.mode=aN;case aN:for(;t.have<t.ncode;){for(;u<3;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}t.lens[F[t.have++]]=h&7,h>>>=3,u-=3}for(;t.have<19;)t.lens[F[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,I={bits:t.lenbits},b=Iy(Efe,t.lens,0,19,t.lencode,0,t.work,I),t.lenbits=I.bits,b){n.msg="invalid code lengths set",t.mode=Co;break}t.have=0,t.mode=lN;case lN:for(;t.have<t.nlen+t.ndist;){for(;y=t.lencode[h&(1<<t.lenbits)-1],v=y>>>24,m=y>>>16&255,w=y&65535,!(v<=u);){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}if(w<16)h>>>=v,u-=v,t.lens[t.have++]=w;else{if(w===16){for(S=v+2;u<S;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}if(h>>>=v,u-=v,t.have===0){n.msg="invalid bit length repeat",t.mode=Co;break}D=t.lens[t.have-1],A=3+(h&3),h>>>=2,u-=2}else if(w===17){for(S=v+3;u<S;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}h>>>=v,u-=v,D=0,A=3+(h&7),h>>>=3,u-=3}else{for(S=v+7;u<S;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}h>>>=v,u-=v,D=0,A=11+(h&127),h>>>=7,u-=7}if(t.have+A>t.nlen+t.ndist){n.msg="invalid bit length repeat",t.mode=Co;break}for(;A--;)t.lens[t.have++]=D}}if(t.mode===Co)break;if(t.lens[256]===0){n.msg="invalid code -- missing end-of-block",t.mode=Co;break}if(t.lenbits=9,I={bits:t.lenbits},b=Iy(nV,t.lens,0,t.nlen,t.lencode,0,t.work,I),t.lenbits=I.bits,b){n.msg="invalid literal/lengths set",t.mode=Co;break}if(t.distbits=6,t.distcode=t.distdyn,I={bits:t.distbits},b=Iy(iV,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,I),t.distbits=I.bits,b){n.msg="invalid distances set",t.mode=Co;break}if(t.mode=_x,e===bx)break e;case _x:t.mode=Cx;case Cx:if(a>=6&&c>=258){n.next_out=o,n.avail_out=c,n.next_in=s,n.avail_in=a,t.hold=h,t.bits=u,bfe(n,f),o=n.next_out,r=n.output,c=n.avail_out,s=n.next_in,i=n.input,a=n.avail_in,h=t.hold,u=t.bits,t.mode===Vd&&(t.back=-1);break}for(t.back=0;y=t.lencode[h&(1<<t.lenbits)-1],v=y>>>24,m=y>>>16&255,w=y&65535,!(v<=u);){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}if(m&&(m&240)===0){for(x=v,T=m,j=w;y=t.lencode[j+((h&(1<<x+T)-1)>>x)],v=y>>>24,m=y>>>16&255,w=y&65535,!(x+v<=u);){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}h>>>=x,u-=x,t.back+=x}if(h>>>=v,u-=v,t.back+=v,t.length=w,m===0){t.mode=AN;break}if(m&32){t.back=-1,t.mode=Vd;break}if(m&64){n.msg="invalid literal/length code",t.mode=Co;break}t.extra=m&15,t.mode=cN;case cN:if(t.extra){for(S=t.extra;u<S;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}t.length+=h&(1<<t.extra)-1,h>>>=t.extra,u-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=hN;case hN:for(;y=t.distcode[h&(1<<t.distbits)-1],v=y>>>24,m=y>>>16&255,w=y&65535,!(v<=u);){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}if((m&240)===0){for(x=v,T=m,j=w;y=t.distcode[j+((h&(1<<x+T)-1)>>x)],v=y>>>24,m=y>>>16&255,w=y&65535,!(x+v<=u);){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}h>>>=x,u-=x,t.back+=x}if(h>>>=v,u-=v,t.back+=v,m&64){n.msg="invalid distance code",t.mode=Co;break}t.offset=w,t.extra=m&15,t.mode=uN;case uN:if(t.extra){for(S=t.extra;u<S;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}t.offset+=h&(1<<t.extra)-1,h>>>=t.extra,u-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){n.msg="invalid distance too far back",t.mode=Co;break}t.mode=dN;case dN:if(c===0)break e;if(A=f-c,t.offset>A){if(A=t.offset-A,A>t.whave&&t.sane){n.msg="invalid distance too far back",t.mode=Co;break}A>t.wnext?(A-=t.wnext,g=t.wsize-A):g=t.wnext-A,A>t.length&&(A=t.length),p=t.window}else p=r,g=o-t.offset,A=t.length;A>c&&(A=c),c-=A,t.length-=A;do r[o++]=p[g++];while(--A);t.length===0&&(t.mode=Cx);break;case AN:if(c===0)break e;r[o++]=t.length,c--,t.mode=Cx;break;case Q3:if(t.wrap){for(;u<32;){if(a===0)break e;a--,h|=i[s++]<<u,u+=8}if(f-=c,n.total_out+=f,t.total+=f,t.wrap&4&&f&&(n.adler=t.check=t.flags?Gu(t.check,r,f,o-f):kE(t.check,r,f,o-f)),f=c,t.wrap&4&&(t.flags?h:gN(h))!==t.check){n.msg="incorrect data check",t.mode=Co;break}h=0,u=0}t.mode=fN;case fN:if(t.wrap&&t.flags){for(;u<32;){if(a===0)break e;a--,h+=i[s++]<<u,u+=8}if(t.wrap&4&&h!==(t.total&4294967295)){n.msg="incorrect length check",t.mode=Co;break}h=0,u=0}t.mode=pN;case pN:b=Ife;break e;case Co:b=rV;break e;case oV:return sV;case aV:default:return qh}return n.next_out=o,n.avail_out=c,n.next_in=s,n.avail_in=a,t.hold=h,t.bits=u,(t.wsize||f!==n.avail_out&&t.mode<Co&&(t.mode<Q3||e!==GP))&&dV(n,n.output,n.next_out,f-n.avail_out),d-=n.avail_in,f-=n.avail_out,n.total_in+=d,n.total_out+=f,t.total+=f,t.wrap&4&&f&&(n.adler=t.check=t.flags?Gu(t.check,r,f,n.next_out-f):kE(t.check,r,f,n.next_out-f)),n.data_type=t.bits+(t.last?64:0)+(t.mode===Vd?128:0)+(t.mode===_x||t.mode===W3?256:0),(d===0&&f===0||e===GP)&&b===pg&&(b=Dfe),b},Hfe=n=>{if(kg(n))return qh;let e=n.state;return e.window&&(e.window=null),n.state=null,pg},Wfe=(n,e)=>{if(kg(n))return qh;const t=n.state;return(t.wrap&2)===0?qh:(t.head=e,e.done=!1,pg)},Qfe=(n,e)=>{const t=e.length;let i,r,s;return kg(n)||(i=n.state,i.wrap!==0&&i.mode!==tC)?qh:i.mode===tC&&(r=1,r=kE(r,e,t,0),r!==i.check)?rV:(s=dV(n,e,t,t),s?(i.mode=oV,sV):(i.havedict=1,pg))};var $fe=cV,Vfe=hV,zfe=lV,Gfe=Rfe,Xfe=uV,Kfe=Ufe,qfe=Hfe,Yfe=Wfe,Zfe=Qfe,Jfe="pako inflate (from Nodeca project)",eA={inflateReset:$fe,inflateReset2:Vfe,inflateResetKeep:zfe,inflateInit:Gfe,inflateInit2:Xfe,inflate:Kfe,inflateEnd:qfe,inflateGetHeader:Yfe,inflateSetDictionary:Zfe,inflateInfo:Jfe};function epe(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var tpe=epe;const AV=Object.prototype.toString,{Z_NO_FLUSH:npe,Z_FINISH:ipe,Z_OK:Av,Z_STREAM_END:z3,Z_NEED_DICT:G3,Z_STREAM_ERROR:rpe,Z_DATA_ERROR:yN,Z_MEM_ERROR:spe}=J$;function Jv(n){this.options=eV.assign({chunkSize:1024*64,windowBits:15,to:""},n||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(n&&n.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new wfe,this.strm.avail_out=0;let t=eA.inflateInit2(this.strm,e.windowBits);if(t!==Av)throw new Error(IE[t]);if(this.header=new tpe,eA.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=FE.string2buf(e.dictionary):AV.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=eA.inflateSetDictionary(this.strm,e.dictionary),t!==Av)))throw new Error(IE[t])}Jv.prototype.push=function(n,e){const t=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let s,o,a;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?ipe:npe,AV.call(n)==="[object ArrayBuffer]"?t.input=new Uint8Array(n):t.input=n,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(i),t.next_out=0,t.avail_out=i),s=eA.inflate(t,o),s===G3&&r&&(s=eA.inflateSetDictionary(t,r),s===Av?s=eA.inflate(t,o):s===yN&&(s=G3));t.avail_in>0&&s===z3&&t.state.wrap>0&&n[t.next_in]!==0;)eA.inflateReset(t),s=eA.inflate(t,o);switch(s){case rpe:case yN:case G3:case spe:return this.onEnd(s),this.ended=!0,!1}if(a=t.avail_out,t.next_out&&(t.avail_out===0||s===z3))if(this.options.to==="string"){let c=FE.utf8border(t.output,t.next_out),h=t.next_out-c,u=FE.buf2string(t.output,c);t.next_out=h,t.avail_out=i-h,h&&t.output.set(t.output.subarray(c,c+h),0),this.onData(u)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(s===Av&&a===0)){if(s===z3)return s=eA.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};Jv.prototype.onData=function(n){this.chunks.push(n)};Jv.prototype.onEnd=function(n){n===Av&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=eV.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function ope(n,e){const t=new Jv(e);if(t.push(n),t.err)throw t.msg||IE[t.err];return t.result}var ape=Jv,lpe=ope,cpe={Inflate:ape,inflate:lpe};const{Inflate:hpe,inflate:upe}=cpe;var vN=hpe,dpe=upe;const fV=[];for(let n=0;n<256;n++){let e=n;for(let t=0;t<8;t++)e&1?e=3988292384^e>>>1:e=e>>>1;fV[n]=e}const wN=4294967295;function Ape(n,e,t){let i=n;for(let r=0;r<t;r++)i=fV[(i^e[r])&255]^i>>>8;return i}function fpe(n,e){return(Ape(wN,n,e)^wN)>>>0}function xN(n,e,t){const i=n.readUint32(),r=fpe(new Uint8Array(n.buffer,n.byteOffset+n.offset-e-4,e),e);if(r!==i)throw new Error(`CRC mismatch for chunk ${t}. Expected ${i}, found ${r}`)}function pV(n,e,t){for(let i=0;i<t;i++)e[i]=n[i]}function gV(n,e,t,i){let r=0;for(;r<i;r++)e[r]=n[r];for(;r<t;r++)e[r]=n[r]+e[r-i]&255}function mV(n,e,t,i){let r=0;if(t.length===0)for(;r<i;r++)e[r]=n[r];else for(;r<i;r++)e[r]=n[r]+t[r]&255}function yV(n,e,t,i,r){let s=0;if(t.length===0){for(;s<r;s++)e[s]=n[s];for(;s<i;s++)e[s]=n[s]+(e[s-r]>>1)&255}else{for(;s<r;s++)e[s]=n[s]+(t[s]>>1)&255;for(;s<i;s++)e[s]=n[s]+(e[s-r]+t[s]>>1)&255}}function vV(n,e,t,i,r){let s=0;if(t.length===0){for(;s<r;s++)e[s]=n[s];for(;s<i;s++)e[s]=n[s]+e[s-r]&255}else{for(;s<r;s++)e[s]=n[s]+t[s]&255;for(;s<i;s++)e[s]=n[s]+ppe(e[s-r],t[s],t[s-r])&255}}function ppe(n,e,t){const i=n+e-t,r=Math.abs(i-n),s=Math.abs(i-e),o=Math.abs(i-t);return r<=s&&r<=o?n:s<=o?e:t}function gpe(n,e,t,i,r,s){switch(n){case 0:pV(e,t,r);break;case 1:gV(e,t,r,s);break;case 2:mV(e,t,i,r);break;case 3:yV(e,t,i,r,s);break;case 4:vV(e,t,i,r,s);break;default:throw new Error(`Unsupported filter: ${n}`)}}const mpe=new Uint16Array([255]),ype=new Uint8Array(mpe.buffer),vpe=ype[0]===255;function wpe(n){const{data:e,width:t,height:i,channels:r,depth:s}=n,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],a=Math.ceil(s/8)*r,c=new Uint8Array(i*t*a);let h=0;for(let u=0;u<7;u++){const d=o[u],f=Math.ceil((t-d.x)/d.xStep),A=Math.ceil((i-d.y)/d.yStep);if(f<=0||A<=0)continue;const g=f*a,p=new Uint8Array(g);for(let y=0;y<A;y++){const v=e[h++],m=e.subarray(h,h+g);h+=g;const w=new Uint8Array(g);gpe(v,m,w,p,g,a),p.set(w);for(let x=0;x<f;x++){const T=d.x+x*d.xStep,j=d.y+y*d.yStep;if(!(T>=t||j>=i))for(let D=0;D<a;D++)c[(j*t+T)*a+D]=w[x*a+D]}}}if(s===16){const u=new Uint16Array(c.buffer);if(vpe)for(let d=0;d<u.length;d++)u[d]=xpe(u[d]);return u}else return c}function xpe(n){return(n&255)<<8|n>>8&255}const bpe=new Uint16Array([255]),_pe=new Uint8Array(bpe.buffer),Cpe=_pe[0]===255,Spe=new Uint8Array(0);function bN(n){const{data:e,width:t,height:i,channels:r,depth:s}=n,o=Math.ceil(s/8)*r,a=Math.ceil(s/8*r*t),c=new Uint8Array(i*a);let h=Spe,u=0,d,f;for(let A=0;A<i;A++){switch(d=e.subarray(u+1,u+1+a),f=c.subarray(A*a,(A+1)*a),e[u]){case 0:pV(d,f,a);break;case 1:gV(d,f,a,o);break;case 2:mV(d,f,h,a);break;case 3:yV(d,f,h,a,o);break;case 4:vV(d,f,h,a,o);break;default:throw new Error(`Unsupported filter: ${e[u]}`)}h=f,u+=a+1}if(s===16){const A=new Uint16Array(c.buffer);if(Cpe)for(let g=0;g<A.length;g++)A[g]=Tpe(A[g]);return A}else return c}function Tpe(n){return(n&255)<<8|n>>8&255}const Xb=Uint8Array.of(137,80,78,71,13,10,26,10);function _N(n){if(!Bpe(n.readBytes(Xb.length)))throw new Error("wrong PNG signature")}function Bpe(n){if(n.length<Xb.length)return!1;for(let e=0;e<Xb.length;e++)if(n[e]!==Xb[e])return!1;return!0}const Epe="tEXt",kpe=0,wV=new TextDecoder("latin1");function Ipe(n){if(Dpe(n),n.length===0||n.length>79)throw new Error("keyword length must be between 1 and 79")}const Fpe=/^[\u0000-\u00FF]*$/;function Dpe(n){if(!Fpe.test(n))throw new Error("invalid latin1 text")}function jpe(n,e,t){const i=xV(e);n[i]=Ppe(e,t-i.length-1)}function xV(n){for(n.mark();n.readByte()!==kpe;);const e=n.offset;n.reset();const t=wV.decode(n.readBytes(e-n.offset-1));return n.skip(1),Ipe(t),t}function Ppe(n,e){return wV.decode(n.readBytes(e))}const Yc={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},X3={UNKNOWN:-1,DEFLATE:0},CN={UNKNOWN:-1,ADAPTIVE:0},K3={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Sx={NONE:0,BACKGROUND:1,PREVIOUS:2},q3={SOURCE:0,OVER:1};class Npe extends HI{constructor(t,i={}){super(t);rr(this,"_checkCrc");rr(this,"_inflator");rr(this,"_png");rr(this,"_apng");rr(this,"_end");rr(this,"_hasPalette");rr(this,"_palette");rr(this,"_hasTransparency");rr(this,"_transparency");rr(this,"_compressionMethod");rr(this,"_filterMethod");rr(this,"_interlaceMethod");rr(this,"_colorType");rr(this,"_isAnimated");rr(this,"_numberOfFrames");rr(this,"_numberOfPlays");rr(this,"_frames");rr(this,"_writingDataChunks");const{checkCrc:r=!1}=i;this._checkCrc=r,this._inflator=new vN,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=X3.UNKNOWN,this._filterMethod=CN.UNKNOWN,this._interlaceMethod=K3.UNKNOWN,this._colorType=Yc.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(_N(this);!this._end;){const t=this.readUint32(),i=this.readChars(4);this.decodeChunk(t,i)}return this.decodeImage(),this._png}decodeApng(){for(_N(this);!this._end;){const t=this.readUint32(),i=this.readChars(4);this.decodeApngChunk(t,i)}return this.decodeApngImage(),this._apng}decodeChunk(t,i){const r=this.offset;switch(i){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(t);break;case"IDAT":this.decodeIDAT(t);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(t);break;case"iCCP":this.decodeiCCP(t);break;case Epe:jpe(this._png.text,this,t);break;case"pHYs":this.decodepHYs();break;default:this.skip(t);break}if(this.offset-r!==t)throw new Error(`Length mismatch while decoding chunk ${i}`);this._checkCrc?xN(this,t+4,i):this.skip(4)}decodeApngChunk(t,i){const r=this.offset;switch(i!=="fdAT"&&i!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),i){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(t);break;default:this.decodeChunk(t,i),this.offset=r+t;break}if(this.offset-r!==t)throw new Error(`Length mismatch while decoding chunk ${i}`);this._checkCrc?xN(this,t+4,i):this.skip(4)}decodeIHDR(){const t=this._png;t.width=this.readUint32(),t.height=this.readUint32(),t.depth=Lpe(this.readUint8());const i=this.readUint8();this._colorType=i;let r;switch(i){case Yc.GREYSCALE:r=1;break;case Yc.TRUECOLOUR:r=3;break;case Yc.INDEXED_COLOUR:r=1;break;case Yc.GREYSCALE_ALPHA:r=2;break;case Yc.TRUECOLOUR_ALPHA:r=4;break;case Yc.UNKNOWN:default:throw new Error(`Unknown color type: ${i}`)}if(this._png.channels=r,this._compressionMethod=this.readUint8(),this._compressionMethod!==X3.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const t={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(t)}decodePLTE(t){if(t%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${t}`);const i=t/3;this._hasPalette=!0;const r=[];this._palette=r;for(let s=0;s<i;s++)r.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(t){this._writingDataChunks=!0;const i=t,r=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,r,i)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodeFDAT(t){this._writingDataChunks=!0;let i=t,r=this.offset+this.byteOffset;if(r+=4,i-=4,this._inflator.push(new Uint8Array(this.buffer,r,i)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodetRNS(t){switch(this._colorType){case Yc.GREYSCALE:case Yc.TRUECOLOUR:{if(t%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${t}`);if(t/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${t/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(t/2);for(let i=0;i<t/2;i++)this._transparency[i]=this.readUint16();break}case Yc.INDEXED_COLOUR:{if(t>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${t} vs ${this._palette.length})`);let i=0;for(;i<t;i++){const r=this.readByte();this._palette[i].push(r)}for(;i<this._palette.length;i++)this._palette[i].push(255);break}case Yc.UNKNOWN:case Yc.GREYSCALE_ALPHA:case Yc.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(t){const i=xV(this),r=this.readUint8();if(r!==X3.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${r}`);const s=this.readBytes(t-i.length-2);this._png.iccEmbeddedProfile={name:i,profile:dpe(s)}}decodepHYs(){const t=this.readUint32(),i=this.readUint32(),r=this.readByte();this._png.resolution={x:t,y:i,unit:r}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let t=0;t<this._numberOfFrames;t++){const i={sequenceNumber:this._frames[t].sequenceNumber,delayNumber:this._frames[t].delayNumber,delayDenominator:this._frames[t].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},r=this._frames.at(t);if(r){if(r.data=bN({data:r.data,width:r.width,height:r.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),t===0||r.xOffset===0&&r.yOffset===0&&r.width===this._png.width&&r.height===this._png.height)i.data=r.data;else{const s=this._apng.frames.at(t-1);this.disposeFrame(r,s,i),this.addFrameDataToCanvas(i,r)}this._apng.frames.push(i)}}return this._apng}disposeFrame(t,i,r){switch(t.disposeOp){case Sx.NONE:break;case Sx.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let o=0;o<this._png.width;o++){const a=(s*t.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)r.data[a+c]=0}break;case Sx.PREVIOUS:r.data.set(i.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(t,i){const r=1<<this._png.depth,s=(o,a)=>{const c=((o+i.yOffset)*this._png.width+i.xOffset+a)*this._png.channels,h=(o*i.width+a)*this._png.channels;return{index:c,frameIndex:h}};switch(i.blendOp){case q3.SOURCE:for(let o=0;o<i.height;o++)for(let a=0;a<i.width;a++){const{index:c,frameIndex:h}=s(o,a);for(let u=0;u<this._png.channels;u++)t.data[c+u]=i.data[h+u]}break;case q3.OVER:for(let o=0;o<i.height;o++)for(let a=0;a<i.width;a++){const{index:c,frameIndex:h}=s(o,a);for(let u=0;u<this._png.channels;u++){const d=i.data[h+this._png.channels-1]/r,f=u%(this._png.channels-1)===0?1:i.data[h+u],A=Math.floor(d*f+(1-d)*t.data[c+u]);t.data[c+u]+=A}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var i;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const t=this._isAnimated?((i=this._frames)==null?void 0:i.at(0)).data:this._inflator.result;if(this._filterMethod!==CN.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===K3.NO_INTERLACE)this._png.data=bN({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===K3.ADAM7)this._png.data=wpe({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const t=this._inflator.result,i=this._frames.at(-1);i?i.data=t:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Sx.NONE,blendOp:q3.SOURCE,data:t}),this._inflator=new vN,this._writingDataChunks=!1}}function Lpe(n){if(n!==1&&n!==2&&n!==4&&n!==8&&n!==16)throw new Error(`invalid bit depth: ${n}`);return n}var SN;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.METRE=1]="METRE"})(SN||(SN={}));function Mpe(n,e){return new Npe(n,e).decode()}var hr=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function Y3(){hr.console&&typeof hr.console.log=="function"&&hr.console.log.apply(hr.console,arguments)}var Gs={log:Y3,warn:function(n){hr.console&&(typeof hr.console.warn=="function"?hr.console.warn.apply(hr.console,arguments):Y3.call(null,arguments))},error:function(n){hr.console&&(typeof hr.console.error=="function"?hr.console.error.apply(hr.console,arguments):Y3(n))}};function Z3(n,e,t){var i=new XMLHttpRequest;i.open("GET",n),i.responseType="blob",i.onload=function(){Dp(i.response,e,t)},i.onerror=function(){Gs.error("could not download file")},i.send()}function TN(n){var e=new XMLHttpRequest;e.open("HEAD",n,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Tx(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(e)}}var Dp=hr.saveAs||((typeof window>"u"?"undefined":Ds(window))!=="object"||window!==hr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(n,e,t){var i=hr.URL||hr.webkitURL,r=document.createElement("a");e=e||n.name||"download",r.download=e,r.rel="noopener",typeof n=="string"?(r.href=n,r.origin!==location.origin?TN(r.href)?Z3(n,e,t):Tx(r,r.target="_blank"):Tx(r)):(r.href=i.createObjectURL(n),setTimeout(function(){i.revokeObjectURL(r.href)},4e4),setTimeout(function(){Tx(r)},0))}:"msSaveOrOpenBlob"in navigator?function(n,e,t){if(e=e||n.name||"download",typeof n=="string")if(TN(n))Z3(n,e,t);else{var i=document.createElement("a");i.href=n,i.target="_blank",setTimeout(function(){Tx(i)})}else navigator.msSaveOrOpenBlob((function(r,s){return s===void 0?s={autoBom:!1}:Ds(s)!=="object"&&(Gs.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob(["\uFEFF",r],{type:r.type}):r})(n,t),e)}:function(n,e,t,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),typeof n=="string")return Z3(n,e,t);var r=n.type==="application/octet-stream",s=/constructor/i.test(hr.HTMLElement)||hr.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||r&&s)&&(typeof FileReader>"u"?"undefined":Ds(FileReader))==="object"){var a=new FileReader;a.onloadend=function(){var u=a.result;u=o?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=u:location=u,i=null},a.readAsDataURL(n)}else{var c=hr.URL||hr.webkitURL,h=c.createObjectURL(n);i?i.location=h:location.href=h,i=null,setTimeout(function(){c.revokeObjectURL(h)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function bV(n){var e;n=n||"",this.ok=!1,n.charAt(0)=="#"&&(n=n.substr(1,6)),n={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[n=(n=n.replace(/ /g,"")).toLowerCase()]||n;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],i=0;i<t.length;i++){var r=t[i].re,s=t[i].process,o=r.exec(n);o&&(e=s(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var a=this.r.toString(16),c=this.g.toString(16),h=this.b.toString(16);return a.length==1&&(a="0"+a),c.length==1&&(c="0"+c),h.length==1&&(h="0"+h),"#"+a+c+h}}var Kb=hr.atob.bind(hr),BN=hr.btoa.bind(hr);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function J3(n,e){var t=n[0],i=n[1],r=n[2],s=n[3];t=Hl(t,i,r,s,e[0],7,-680876936),s=Hl(s,t,i,r,e[1],12,-389564586),r=Hl(r,s,t,i,e[2],17,606105819),i=Hl(i,r,s,t,e[3],22,-1044525330),t=Hl(t,i,r,s,e[4],7,-176418897),s=Hl(s,t,i,r,e[5],12,1200080426),r=Hl(r,s,t,i,e[6],17,-1473231341),i=Hl(i,r,s,t,e[7],22,-45705983),t=Hl(t,i,r,s,e[8],7,1770035416),s=Hl(s,t,i,r,e[9],12,-1958414417),r=Hl(r,s,t,i,e[10],17,-42063),i=Hl(i,r,s,t,e[11],22,-1990404162),t=Hl(t,i,r,s,e[12],7,1804603682),s=Hl(s,t,i,r,e[13],12,-40341101),r=Hl(r,s,t,i,e[14],17,-1502002290),t=Wl(t,i=Hl(i,r,s,t,e[15],22,1236535329),r,s,e[1],5,-165796510),s=Wl(s,t,i,r,e[6],9,-1069501632),r=Wl(r,s,t,i,e[11],14,643717713),i=Wl(i,r,s,t,e[0],20,-373897302),t=Wl(t,i,r,s,e[5],5,-701558691),s=Wl(s,t,i,r,e[10],9,38016083),r=Wl(r,s,t,i,e[15],14,-660478335),i=Wl(i,r,s,t,e[4],20,-405537848),t=Wl(t,i,r,s,e[9],5,568446438),s=Wl(s,t,i,r,e[14],9,-1019803690),r=Wl(r,s,t,i,e[3],14,-187363961),i=Wl(i,r,s,t,e[8],20,1163531501),t=Wl(t,i,r,s,e[13],5,-1444681467),s=Wl(s,t,i,r,e[2],9,-51403784),r=Wl(r,s,t,i,e[7],14,1735328473),t=Ql(t,i=Wl(i,r,s,t,e[12],20,-1926607734),r,s,e[5],4,-378558),s=Ql(s,t,i,r,e[8],11,-2022574463),r=Ql(r,s,t,i,e[11],16,1839030562),i=Ql(i,r,s,t,e[14],23,-35309556),t=Ql(t,i,r,s,e[1],4,-1530992060),s=Ql(s,t,i,r,e[4],11,1272893353),r=Ql(r,s,t,i,e[7],16,-155497632),i=Ql(i,r,s,t,e[10],23,-1094730640),t=Ql(t,i,r,s,e[13],4,681279174),s=Ql(s,t,i,r,e[0],11,-358537222),r=Ql(r,s,t,i,e[3],16,-722521979),i=Ql(i,r,s,t,e[6],23,76029189),t=Ql(t,i,r,s,e[9],4,-640364487),s=Ql(s,t,i,r,e[12],11,-421815835),r=Ql(r,s,t,i,e[15],16,530742520),t=$l(t,i=Ql(i,r,s,t,e[2],23,-995338651),r,s,e[0],6,-198630844),s=$l(s,t,i,r,e[7],10,1126891415),r=$l(r,s,t,i,e[14],15,-1416354905),i=$l(i,r,s,t,e[5],21,-57434055),t=$l(t,i,r,s,e[12],6,1700485571),s=$l(s,t,i,r,e[3],10,-1894986606),r=$l(r,s,t,i,e[10],15,-1051523),i=$l(i,r,s,t,e[1],21,-2054922799),t=$l(t,i,r,s,e[8],6,1873313359),s=$l(s,t,i,r,e[15],10,-30611744),r=$l(r,s,t,i,e[6],15,-1560198380),i=$l(i,r,s,t,e[13],21,1309151649),t=$l(t,i,r,s,e[4],6,-145523070),s=$l(s,t,i,r,e[11],10,-1120210379),r=$l(r,s,t,i,e[2],15,718787259),i=$l(i,r,s,t,e[9],21,-343485551),n[0]=bf(t,n[0]),n[1]=bf(i,n[1]),n[2]=bf(r,n[2]),n[3]=bf(s,n[3])}function j5(n,e,t,i,r,s){return e=bf(bf(e,n),bf(i,s)),bf(e<<r|e>>>32-r,t)}function Hl(n,e,t,i,r,s,o){return j5(e&t|~e&i,n,e,r,s,o)}function Wl(n,e,t,i,r,s,o){return j5(e&i|t&~i,n,e,r,s,o)}function Ql(n,e,t,i,r,s,o){return j5(e^t^i,n,e,r,s,o)}function $l(n,e,t,i,r,s,o){return j5(t^(e|~i),n,e,r,s,o)}function _V(n){var e,t=n.length,i=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=n.length;e+=64)J3(i,Rpe(n.substring(e-64,e)));n=n.substring(e-64);var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<n.length;e++)r[e>>2]|=n.charCodeAt(e)<<(e%4<<3);if(r[e>>2]|=128<<(e%4<<3),e>55)for(J3(i,r),e=0;e<16;e++)r[e]=0;return r[14]=8*t,J3(i,r),i}function Rpe(n){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=n.charCodeAt(e)+(n.charCodeAt(e+1)<<8)+(n.charCodeAt(e+2)<<16)+(n.charCodeAt(e+3)<<24);return t}var EN="0123456789abcdef".split("");function Ope(n){for(var e="",t=0;t<4;t++)e+=EN[n>>8*t+4&15]+EN[n>>8*t&15];return e}function Upe(n){return String.fromCharCode(255&n,(65280&n)>>8,(16711680&n)>>16,(4278190080&n)>>24)}function DE(n){return _V(n).map(Upe).join("")}var Hpe=(function(n){for(var e=0;e<n.length;e++)n[e]=Ope(n[e]);return n.join("")})(_V("hello"))!="5d41402abc4b2a76b9719d911017c592";function bf(n,e){if(Hpe){var t=(65535&n)+(65535&e);return(n>>16)+(e>>16)+(t>>16)<<16|65535&t}return n+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function jE(n,e){var t,i,r,s;if(n!==t){for(var o=(r=n,s=1+(256/n.length|0),new Array(s+1).join(r)),a=[],c=0;c<256;c++)a[c]=c;var h=0;for(c=0;c<256;c++){var u=a[c];h=(h+u+o.charCodeAt(c))%256,a[c]=a[h],a[h]=u}t=n,i=a}else a=i;var d=e.length,f=0,A=0,g="";for(c=0;c<d;c++)A=(A+(u=a[f=(f+1)%256]))%256,a[f]=a[A],a[A]=u,o=a[(a[f]+a[A])%256],g+=String.fromCharCode(e.charCodeAt(c)^o);return g}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var kN={print:4,modify:8,copy:16,"annot-forms":32};function k0(n,e,t,i){this.v=1,this.r=2;var r=192;n.forEach(function(a){if(kN.perm!==void 0)throw new Error("Invalid permission: "+a);r+=kN[a]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var s=(e+this.padding).substr(0,32),o=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^r)),this.encryptionKey=DE(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(i)).substr(0,5),this.U=jE(this.encryptionKey,this.padding)}function I0(n){if(/[^\u0000-\u00ff]/.test(n))throw new Error("Invalid PDF Name Object: "+n+", Only accept ASCII characters.");for(var e="",t=n.length,i=0;i<t;i++){var r=n.charCodeAt(i);e+=r<33||r===35||r===37||r===40||r===41||r===47||r===60||r===62||r===91||r===93||r===123||r===125||r>126?"#"+("0"+r.toString(16)).slice(-2):n[i]}return e}function IN(n){if(Ds(n)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,i,r){if(r=r||!1,typeof t!="string"||typeof i!="function"||typeof r!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var s=Math.random().toString(35);return e[t][s]=[i,!!r],s},this.unsubscribe=function(t){for(var i in e)if(e[i][t])return delete e[i][t],Object.keys(e[i]).length===0&&delete e[i],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var i=Array.prototype.slice.call(arguments,1),r=[];for(var s in e[t]){var o=e[t][s];try{o[0].apply(n,i)}catch(a){hr.console&&Gs.error("jsPDF PubSub Error",a.message,a)}o[1]&&r.push(s)}r.length&&r.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function gg(n){if(!(this instanceof gg))return new gg(n);var e="opacity,stroke-opacity".split(",");for(var t in n)n.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=n[t]);this.id="",this.objectNumber=-1}function CV(n,e){this.gState=n,this.matrix=e,this.id="",this.objectNumber=-1}function gf(n,e,t,i,r){if(!(this instanceof gf))return new gf(n,e,t,i,r);this.type=n==="axial"?2:3,this.coords=e,this.colors=t,CV.call(this,i,r)}function Qp(n,e,t,i,r){if(!(this instanceof Qp))return new Qp(n,e,t,i,r);this.boundingBox=n,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,CV.call(this,i,r)}function Di(n){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",i=arguments[1],r=arguments[2],s=arguments[3],o=[],a=1,c=16,h="S",u=null;Ds(n=n||{})==="object"&&(t=n.orientation,i=n.unit||i,r=n.format||r,s=n.compress||n.compressPdf||s,(u=n.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),a=typeof n.userUnit=="number"?Math.abs(n.userUnit):1,n.precision!==void 0&&(e=n.precision),n.floatPrecision!==void 0&&(c=n.floatPrecision),h=n.defaultPathOperation||"S"),o=n.filters||(s===!0?["FlateEncode"]:o),i=i||"mm",t=(""+(t||"P")).toLowerCase();var d=n.putOnlyUsedFonts||!1,f={},A={internal:{},__private__:{}};A.__private__.PubSub=IN;var g="1.3",p=A.__private__.getPdfVersion=function(){return g};A.__private__.setPdfVersion=function(ee){g=ee};var y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};A.__private__.getPageFormats=function(){return y};var v=A.__private__.getPageFormat=function(ee){return y[ee]};r=r||"a4";var m="compat",w="advanced",x=m;function T(){this.saveGraphicsState(),Y(new Et(De,0,0,-De,0,Vn()*De).toString()+" cm"),this.setFontSize(this.getFontSize()/De),h="n",x=w}function j(){this.restoreGraphicsState(),h="S",x=m}var D=A.__private__.combineFontStyleAndFontWeight=function(ee,we){if(ee=="bold"&&we=="normal"||ee=="bold"&&we==400||ee=="normal"&&we=="italic"||ee=="bold"&&we=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return we&&(ee=we==400||we==="normal"?ee==="italic"?"italic":"normal":we!=700&&we!=="bold"||ee!=="normal"?(we==700?"bold":we)+""+ee:"bold"),ee};A.advancedAPI=function(ee){var we=x===m;return we&&T.call(this),typeof ee!="function"||(ee(this),we&&j.call(this)),this},A.compatAPI=function(ee){var we=x===w;return we&&j.call(this),typeof ee!="function"||(ee(this),we&&T.call(this)),this},A.isAdvancedAPI=function(){return x===w};var b,_=function(ee){if(x!==w)throw new Error(ee+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},I=A.roundToPrecision=A.__private__.roundToPrecision=function(ee,we){var He=e||we;if(isNaN(ee)||isNaN(He))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return ee.toFixed(He).replace(/0+$/,"")};b=A.hpf=A.__private__.hpf=typeof c=="number"?function(ee){if(isNaN(ee))throw new Error("Invalid argument passed to jsPDF.hpf");return I(ee,c)}:c==="smart"?function(ee){if(isNaN(ee))throw new Error("Invalid argument passed to jsPDF.hpf");return I(ee,ee>-1&&ee<1?16:5)}:function(ee){if(isNaN(ee))throw new Error("Invalid argument passed to jsPDF.hpf");return I(ee,16)};var S=A.f2=A.__private__.f2=function(ee){if(isNaN(ee))throw new Error("Invalid argument passed to jsPDF.f2");return I(ee,2)},F=A.__private__.f3=function(ee){if(isNaN(ee))throw new Error("Invalid argument passed to jsPDF.f3");return I(ee,3)},B=A.scale=A.__private__.scale=function(ee){if(isNaN(ee))throw new Error("Invalid argument passed to jsPDF.scale");return x===m?ee*De:x===w?ee:void 0},E=function(ee){return B((function(we){return x===m?Vn()-we:x===w?we:void 0})(ee))};A.__private__.setPrecision=A.setPrecision=function(ee){typeof parseInt(ee,10)=="number"&&(e=parseInt(ee,10))};var V,K="00000000000000000000000000000000",P=A.__private__.getFileId=function(){return K},M=A.__private__.setFileId=function(ee){return K=ee!==void 0&&/^[a-fA-F0-9]{32}$/.test(ee)?ee.toUpperCase():K.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(Rt=new k0(u.userPermissions,u.userPassword,u.ownerPassword,K)),K};A.setFileId=function(ee){return M(ee),this},A.getFileId=function(){return P()};var X=A.__private__.convertDateToPDFDate=function(ee){var we=ee.getTimezoneOffset(),He=we<0?"+":"-",lt=Math.floor(Math.abs(we/60)),_t=Math.abs(we%60),ln=[He,q(lt),"'",q(_t),"'"].join("");return["D:",ee.getFullYear(),q(ee.getMonth()+1),q(ee.getDate()),q(ee.getHours()),q(ee.getMinutes()),q(ee.getSeconds()),ln].join("")},Z=A.__private__.convertPDFDateToDate=function(ee){var we=parseInt(ee.substr(2,4),10),He=parseInt(ee.substr(6,2),10)-1,lt=parseInt(ee.substr(8,2),10),_t=parseInt(ee.substr(10,2),10),ln=parseInt(ee.substr(12,2),10),vn=parseInt(ee.substr(14,2),10);return new Date(we,He,lt,_t,ln,vn,0)},Q=A.__private__.setCreationDate=function(ee){var we;if(ee===void 0&&(ee=new Date),ee instanceof Date)we=X(ee);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(ee))throw new Error("Invalid argument passed to jsPDF.setCreationDate");we=ee}return V=we},U=A.__private__.getCreationDate=function(ee){var we=V;return ee==="jsDate"&&(we=Z(V)),we};A.setCreationDate=function(ee){return Q(ee),this},A.getCreationDate=function(ee){return U(ee)};var z,q=A.__private__.padd2=function(ee){return("0"+parseInt(ee)).slice(-2)},G=A.__private__.padd2Hex=function(ee){return("00"+(ee=ee.toString())).substr(ee.length)},ie=0,H=[],se=[],te=0,fe=[],ye=[],be=!1,_e=se;A.__private__.setCustomOutputDestination=function(ee){be=!0,_e=ee};var W=function(ee){be||(_e=ee)};A.__private__.resetCustomOutputDestination=function(){be=!1,_e=se};var Y=A.__private__.out=function(ee){return ee=ee.toString(),te+=ee.length+1,_e.push(ee),_e},ve=A.__private__.write=function(ee){return Y(arguments.length===1?ee.toString():Array.prototype.join.call(arguments," "))},ce=A.__private__.getArrayBuffer=function(ee){for(var we=ee.length,He=new ArrayBuffer(we),lt=new Uint8Array(He);we--;)lt[we]=ee.charCodeAt(we);return He},ne=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];A.__private__.getStandardFonts=function(){return ne};var he=n.fontSize||16;A.__private__.setFontSize=A.setFontSize=function(ee){return he=x===w?ee/De:ee,this};var xe,Te=A.__private__.getFontSize=A.getFontSize=function(){return x===m?he:he*De},Ce=n.R2L||!1;A.__private__.setR2L=A.setR2L=function(ee){return Ce=ee,this},A.__private__.getR2L=A.getR2L=function(){return Ce};var Be,Ye=A.__private__.setZoomMode=function(ee){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(ee))xe=ee;else if(isNaN(ee)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(ee)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+ee+'" is not recognized.');xe=ee}else xe=parseInt(ee,10)};A.__private__.getZoomMode=function(){return xe};var $e,ot=A.__private__.setPageMode=function(ee){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(ee)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+ee+'" is not recognized.');Be=ee};A.__private__.getPageMode=function(){return Be};var rt=A.__private__.setLayoutMode=function(ee){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(ee)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+ee+'" is not recognized.');$e=ee};A.__private__.getLayoutMode=function(){return $e},A.__private__.setDisplayMode=A.setDisplayMode=function(ee,we,He){return Ye(ee),rt(we),ot(He),this};var Ve={title:"",subject:"",author:"",keywords:"",creator:""};A.__private__.getDocumentProperty=function(ee){if(Object.keys(Ve).indexOf(ee)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Ve[ee]},A.__private__.getDocumentProperties=function(){return Ve},A.__private__.setDocumentProperties=A.setProperties=A.setDocumentProperties=function(ee){for(var we in Ve)Ve.hasOwnProperty(we)&&ee[we]&&(Ve[we]=ee[we]);return this},A.__private__.setDocumentProperty=function(ee,we){if(Object.keys(Ve).indexOf(ee)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Ve[ee]=we};var We,De,Ge,Re,Ie,Le={},et={},ct=[],mt={},je={},le={},Je={},ht=null,ut=0,ft=[],jt=new IN(A),Wt=n.hotfixes||[],Mt={},dn={},on=[],Et=function ee(we,He,lt,_t,ln,vn){if(!(this instanceof ee))return new ee(we,He,lt,_t,ln,vn);isNaN(we)&&(we=1),isNaN(He)&&(He=0),isNaN(lt)&&(lt=0),isNaN(_t)&&(_t=1),isNaN(ln)&&(ln=0),isNaN(vn)&&(vn=0),this._matrix=[we,He,lt,_t,ln,vn]};Object.defineProperty(Et.prototype,"sx",{get:function(){return this._matrix[0]},set:function(ee){this._matrix[0]=ee}}),Object.defineProperty(Et.prototype,"shy",{get:function(){return this._matrix[1]},set:function(ee){this._matrix[1]=ee}}),Object.defineProperty(Et.prototype,"shx",{get:function(){return this._matrix[2]},set:function(ee){this._matrix[2]=ee}}),Object.defineProperty(Et.prototype,"sy",{get:function(){return this._matrix[3]},set:function(ee){this._matrix[3]=ee}}),Object.defineProperty(Et.prototype,"tx",{get:function(){return this._matrix[4]},set:function(ee){this._matrix[4]=ee}}),Object.defineProperty(Et.prototype,"ty",{get:function(){return this._matrix[5]},set:function(ee){this._matrix[5]=ee}}),Object.defineProperty(Et.prototype,"a",{get:function(){return this._matrix[0]},set:function(ee){this._matrix[0]=ee}}),Object.defineProperty(Et.prototype,"b",{get:function(){return this._matrix[1]},set:function(ee){this._matrix[1]=ee}}),Object.defineProperty(Et.prototype,"c",{get:function(){return this._matrix[2]},set:function(ee){this._matrix[2]=ee}}),Object.defineProperty(Et.prototype,"d",{get:function(){return this._matrix[3]},set:function(ee){this._matrix[3]=ee}}),Object.defineProperty(Et.prototype,"e",{get:function(){return this._matrix[4]},set:function(ee){this._matrix[4]=ee}}),Object.defineProperty(Et.prototype,"f",{get:function(){return this._matrix[5]},set:function(ee){this._matrix[5]=ee}}),Object.defineProperty(Et.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Et.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Et.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Et.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Et.prototype.join=function(ee){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(b).join(ee)},Et.prototype.multiply=function(ee){var we=ee.sx*this.sx+ee.shy*this.shx,He=ee.sx*this.shy+ee.shy*this.sy,lt=ee.shx*this.sx+ee.sy*this.shx,_t=ee.shx*this.shy+ee.sy*this.sy,ln=ee.tx*this.sx+ee.ty*this.shx+this.tx,vn=ee.tx*this.shy+ee.ty*this.sy+this.ty;return new Et(we,He,lt,_t,ln,vn)},Et.prototype.decompose=function(){var ee=this.sx,we=this.shy,He=this.shx,lt=this.sy,_t=this.tx,ln=this.ty,vn=Math.sqrt(ee*ee+we*we),si=(ee/=vn)*He+(we/=vn)*lt;He-=ee*si,lt-=we*si;var oi=Math.sqrt(He*He+lt*lt);return si/=oi,ee*(lt/=oi)<we*(He/=oi)&&(ee=-ee,we=-we,si=-si,vn=-vn),{scale:new Et(vn,0,0,oi,0,0),translate:new Et(1,0,0,1,_t,ln),rotate:new Et(ee,we,-we,ee,0,0),skew:new Et(1,0,si,1,0,0)}},Et.prototype.toString=function(ee){return this.join(" ")},Et.prototype.inversed=function(){var ee=this.sx,we=this.shy,He=this.shx,lt=this.sy,_t=this.tx,ln=this.ty,vn=1/(ee*lt-we*He),si=lt*vn,oi=-we*vn,Fi=-He*vn,pi=ee*vn;return new Et(si,oi,Fi,pi,-si*_t-Fi*ln,-oi*_t-pi*ln)},Et.prototype.applyToPoint=function(ee){var we=ee.x*this.sx+ee.y*this.shx+this.tx,He=ee.x*this.shy+ee.y*this.sy+this.ty;return new Nr(we,He)},Et.prototype.applyToRectangle=function(ee){var we=this.applyToPoint(ee),He=this.applyToPoint(new Nr(ee.x+ee.w,ee.y+ee.h));return new ks(we.x,we.y,He.x-we.x,He.y-we.y)},Et.prototype.clone=function(){var ee=this.sx,we=this.shy,He=this.shx,lt=this.sy,_t=this.tx,ln=this.ty;return new Et(ee,we,He,lt,_t,ln)},A.Matrix=Et;var an=A.matrixMult=function(ee,we){return we.multiply(ee)},Mn=new Et(1,0,0,1,0,0);A.unitMatrix=A.identityMatrix=Mn;var At=function(ee,we){if(!je[ee]){var He=(we instanceof gf?"Sh":"P")+(Object.keys(mt).length+1).toString(10);we.id=He,je[ee]=He,mt[He]=we,jt.publish("addPattern",we)}};A.ShadingPattern=gf,A.TilingPattern=Qp,A.addShadingPattern=function(ee,we){return _("addShadingPattern()"),At(ee,we),this},A.beginTilingPattern=function(ee){_("beginTilingPattern()"),As(ee.boundingBox[0],ee.boundingBox[1],ee.boundingBox[2]-ee.boundingBox[0],ee.boundingBox[3]-ee.boundingBox[1],ee.matrix)},A.endTilingPattern=function(ee,we){_("endTilingPattern()"),we.stream=ye[z].join(`
`),At(ee,we),jt.publish("endTilingPattern",we),on.pop().restore()};var zt,Zt=A.__private__.newObject=function(){var ee=$t();return Ht(ee,!0),ee},$t=A.__private__.newObjectDeferred=function(){return ie++,H[ie]=function(){return te},ie},Ht=function(ee,we){return we=typeof we=="boolean"&&we,H[ee]=te,we&&Y(ee+" 0 obj"),ee},Lt=A.__private__.newAdditionalObject=function(){var ee={objId:$t(),content:""};return fe.push(ee),ee},dt=$t(),at=$t(),Ot=A.__private__.decodeColorString=function(ee){var we=ee.split(" ");if(we.length!==2||we[1]!=="g"&&we[1]!=="G")we.length!==5||we[4]!=="k"&&we[4]!=="K"||(we=[(1-we[0])*(1-we[3]),(1-we[1])*(1-we[3]),(1-we[2])*(1-we[3]),"r"]);else{var He=parseFloat(we[0]);we=[He,He,He,"r"]}for(var lt="#",_t=0;_t<3;_t++)lt+=("0"+Math.floor(255*parseFloat(we[_t])).toString(16)).slice(-2);return lt},Cn=A.__private__.encodeColorString=function(ee){var we;typeof ee=="string"&&(ee={ch1:ee});var He=ee.ch1,lt=ee.ch2,_t=ee.ch3,ln=ee.ch4,vn=ee.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof He=="string"&&He.charAt(0)!=="#"){var si=new bV(He);if(si.ok)He=si.toHex();else if(!/^\d*\.?\d*$/.test(He))throw new Error('Invalid color "'+He+'" passed to jsPDF.encodeColorString.')}if(typeof He=="string"&&/^#[0-9A-Fa-f]{3}$/.test(He)&&(He="#"+He[1]+He[1]+He[2]+He[2]+He[3]+He[3]),typeof He=="string"&&/^#[0-9A-Fa-f]{6}$/.test(He)){var oi=parseInt(He.substr(1),16);He=oi>>16&255,lt=oi>>8&255,_t=255&oi}if(lt===void 0||ln===void 0&&He===lt&&lt===_t)we=typeof He=="string"?He+" "+vn[0]:ee.precision===2?S(He/255)+" "+vn[0]:F(He/255)+" "+vn[0];else if(ln===void 0||Ds(ln)==="object"){if(ln&&!isNaN(ln.a)&&ln.a===0)return["1.","1.","1.",vn[1]].join(" ");we=typeof He=="string"?[He,lt,_t,vn[1]].join(" "):ee.precision===2?[S(He/255),S(lt/255),S(_t/255),vn[1]].join(" "):[F(He/255),F(lt/255),F(_t/255),vn[1]].join(" ")}else we=typeof He=="string"?[He,lt,_t,ln,vn[2]].join(" "):ee.precision===2?[S(He),S(lt),S(_t),S(ln),vn[2]].join(" "):[F(He),F(lt),F(_t),F(ln),vn[2]].join(" ");return we},Rn=A.__private__.getFilters=function(){return o},xn=A.__private__.putStream=function(ee){var we=(ee=ee||{}).data||"",He=ee.filters||Rn(),lt=ee.alreadyAppliedFilters||[],_t=ee.addLength1||!1,ln=we.length,vn=ee.objectId,si=function(Js){return Js};if(u!==null&&vn===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(si=Rt.encryptor(vn,0));var oi={};He===!0&&(He=["FlateEncode"]);var Fi=ee.additionalKeyValues||[],pi=(oi=Di.API.processDataByFilters!==void 0?Di.API.processDataByFilters(we,He):{data:we,reverseChain:[]}).reverseChain+(Array.isArray(lt)?lt.join(" "):lt.toString());if(oi.data.length!==0&&(Fi.push({key:"Length",value:oi.data.length}),_t===!0&&Fi.push({key:"Length1",value:ln})),pi.length!=0)if(pi.split("/").length-1==1)Fi.push({key:"Filter",value:pi});else{Fi.push({key:"Filter",value:"["+pi+"]"});for(var Ir=0;Ir<Fi.length;Ir+=1)if(Fi[Ir].key==="DecodeParms"){for(var Hr=[],Ns=0;Ns<oi.reverseChain.split("/").length-1;Ns+=1)Hr.push("null");Hr.push(Fi[Ir].value),Fi[Ir].value="["+Hr.join(" ")+"]"}}Y("<<");for(var is=0;is<Fi.length;is++)Y("/"+Fi[is].key+" "+Fi[is].value);Y(">>"),oi.data.length!==0&&(Y("stream"),Y(si(oi.data)),Y("endstream"))},En=A.__private__.putPage=function(ee){var we=ee.number,He=ee.data,lt=ee.objId,_t=ee.contentsObjId;Ht(lt,!0),Y("<</Type /Page"),Y("/Parent "+ee.rootDictionaryObjId+" 0 R"),Y("/Resources "+ee.resourceDictionaryObjId+" 0 R"),Y("/MediaBox ["+parseFloat(b(ee.mediaBox.bottomLeftX))+" "+parseFloat(b(ee.mediaBox.bottomLeftY))+" "+b(ee.mediaBox.topRightX)+" "+b(ee.mediaBox.topRightY)+"]"),ee.cropBox!==null&&Y("/CropBox ["+b(ee.cropBox.bottomLeftX)+" "+b(ee.cropBox.bottomLeftY)+" "+b(ee.cropBox.topRightX)+" "+b(ee.cropBox.topRightY)+"]"),ee.bleedBox!==null&&Y("/BleedBox ["+b(ee.bleedBox.bottomLeftX)+" "+b(ee.bleedBox.bottomLeftY)+" "+b(ee.bleedBox.topRightX)+" "+b(ee.bleedBox.topRightY)+"]"),ee.trimBox!==null&&Y("/TrimBox ["+b(ee.trimBox.bottomLeftX)+" "+b(ee.trimBox.bottomLeftY)+" "+b(ee.trimBox.topRightX)+" "+b(ee.trimBox.topRightY)+"]"),ee.artBox!==null&&Y("/ArtBox ["+b(ee.artBox.bottomLeftX)+" "+b(ee.artBox.bottomLeftY)+" "+b(ee.artBox.topRightX)+" "+b(ee.artBox.topRightY)+"]"),typeof ee.userUnit=="number"&&ee.userUnit!==1&&Y("/UserUnit "+ee.userUnit),jt.publish("putPage",{objId:lt,pageContext:ft[we],pageNumber:we,page:He}),Y("/Contents "+_t+" 0 R"),Y(">>"),Y("endobj");var ln=He.join(`
`);return x===w&&(ln+=`
Q`),Ht(_t,!0),xn({data:ln,filters:Rn(),objectId:_t}),Y("endobj"),lt},Hn=A.__private__.putPages=function(){var ee,we,He=[];for(ee=1;ee<=ut;ee++)ft[ee].objId=$t(),ft[ee].contentsObjId=$t();for(ee=1;ee<=ut;ee++)He.push(En({number:ee,data:ye[ee],objId:ft[ee].objId,contentsObjId:ft[ee].contentsObjId,mediaBox:ft[ee].mediaBox,cropBox:ft[ee].cropBox,bleedBox:ft[ee].bleedBox,trimBox:ft[ee].trimBox,artBox:ft[ee].artBox,userUnit:ft[ee].userUnit,rootDictionaryObjId:dt,resourceDictionaryObjId:at}));Ht(dt,!0),Y("<</Type /Pages");var lt="/Kids [";for(we=0;we<ut;we++)lt+=He[we]+" 0 R ";Y(lt+"]"),Y("/Count "+ut),Y(">>"),Y("endobj"),jt.publish("postPutPages")},Kn=function(ee){jt.publish("putFont",{font:ee,out:Y,newObject:Zt,putStream:xn}),ee.isAlreadyPutted!==!0&&(ee.objectNumber=Zt(),Y("<<"),Y("/Type /Font"),Y("/BaseFont /"+I0(ee.postScriptName)),Y("/Subtype /Type1"),typeof ee.encoding=="string"&&Y("/Encoding /"+ee.encoding),Y("/FirstChar 32"),Y("/LastChar 255"),Y(">>"),Y("endobj"))},Ti=function(ee){ee.objectNumber=Zt();var we=[];we.push({key:"Type",value:"/XObject"}),we.push({key:"Subtype",value:"/Form"}),we.push({key:"BBox",value:"["+[b(ee.x),b(ee.y),b(ee.x+ee.width),b(ee.y+ee.height)].join(" ")+"]"}),we.push({key:"Matrix",value:"["+ee.matrix.toString()+"]"});var He=ee.pages[1].join(`
`);xn({data:He,additionalKeyValues:we,objectId:ee.objectNumber}),Y("endobj")},ti=function(ee,we){we||(we=21);var He=Zt(),lt=(function(vn,si){var oi,Fi=[],pi=1/(si-1);for(oi=0;oi<1;oi+=pi)Fi.push(oi);if(Fi.push(1),vn[0].offset!=0){var Ir={offset:0,color:vn[0].color};vn.unshift(Ir)}if(vn[vn.length-1].offset!=1){var Hr={offset:1,color:vn[vn.length-1].color};vn.push(Hr)}for(var Ns="",is=0,Js=0;Js<Fi.length;Js++){for(oi=Fi[Js];oi>vn[is+1].offset;)is++;var fs=vn[is].offset,Io=(oi-fs)/(vn[is+1].offset-fs),Al=vn[is].color,bc=vn[is+1].color;Ns+=G(Math.round((1-Io)*Al[0]+Io*bc[0]).toString(16))+G(Math.round((1-Io)*Al[1]+Io*bc[1]).toString(16))+G(Math.round((1-Io)*Al[2]+Io*bc[2]).toString(16))}return Ns.trim()})(ee.colors,we),_t=[];_t.push({key:"FunctionType",value:"0"}),_t.push({key:"Domain",value:"[0.0 1.0]"}),_t.push({key:"Size",value:"["+we+"]"}),_t.push({key:"BitsPerSample",value:"8"}),_t.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),_t.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),xn({data:lt,additionalKeyValues:_t,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:He}),Y("endobj"),ee.objectNumber=Zt(),Y("<< /ShadingType "+ee.type),Y("/ColorSpace /DeviceRGB");var ln="/Coords ["+b(parseFloat(ee.coords[0]))+" "+b(parseFloat(ee.coords[1]))+" ";ee.type===2?ln+=b(parseFloat(ee.coords[2]))+" "+b(parseFloat(ee.coords[3])):ln+=b(parseFloat(ee.coords[2]))+" "+b(parseFloat(ee.coords[3]))+" "+b(parseFloat(ee.coords[4]))+" "+b(parseFloat(ee.coords[5])),Y(ln+="]"),ee.matrix&&Y("/Matrix ["+ee.matrix.toString()+"]"),Y("/Function "+He+" 0 R"),Y("/Extend [true true]"),Y(">>"),Y("endobj")},ai=function(ee,we){var He=$t(),lt=Zt();we.push({resourcesOid:He,objectOid:lt}),ee.objectNumber=lt;var _t=[];_t.push({key:"Type",value:"/Pattern"}),_t.push({key:"PatternType",value:"1"}),_t.push({key:"PaintType",value:"1"}),_t.push({key:"TilingType",value:"1"}),_t.push({key:"BBox",value:"["+ee.boundingBox.map(b).join(" ")+"]"}),_t.push({key:"XStep",value:b(ee.xStep)}),_t.push({key:"YStep",value:b(ee.yStep)}),_t.push({key:"Resources",value:He+" 0 R"}),ee.matrix&&_t.push({key:"Matrix",value:"["+ee.matrix.toString()+"]"}),xn({data:ee.stream,additionalKeyValues:_t,objectId:ee.objectNumber}),Y("endobj")},Gi=function(ee){for(var we in ee.objectNumber=Zt(),Y("<<"),ee)switch(we){case"opacity":Y("/ca "+S(ee[we]));break;case"stroke-opacity":Y("/CA "+S(ee[we]))}Y(">>"),Y("endobj")},fi=function(ee){Ht(ee.resourcesOid,!0),Y("<<"),Y("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var we in Y("/Font <<"),Le)Le.hasOwnProperty(we)&&(d===!1||d===!0&&f.hasOwnProperty(we))&&Y("/"+we+" "+Le[we].objectNumber+" 0 R");Y(">>")})(),(function(){if(Object.keys(mt).length>0){for(var we in Y("/Shading <<"),mt)mt.hasOwnProperty(we)&&mt[we]instanceof gf&&mt[we].objectNumber>=0&&Y("/"+we+" "+mt[we].objectNumber+" 0 R");jt.publish("putShadingPatternDict"),Y(">>")}})(),(function(we){if(Object.keys(mt).length>0){for(var He in Y("/Pattern <<"),mt)mt.hasOwnProperty(He)&&mt[He]instanceof A.TilingPattern&&mt[He].objectNumber>=0&&mt[He].objectNumber<we&&Y("/"+He+" "+mt[He].objectNumber+" 0 R");jt.publish("putTilingPatternDict"),Y(">>")}})(ee.objectOid),(function(){if(Object.keys(le).length>0){var we;for(we in Y("/ExtGState <<"),le)le.hasOwnProperty(we)&&le[we].objectNumber>=0&&Y("/"+we+" "+le[we].objectNumber+" 0 R");jt.publish("putGStateDict"),Y(">>")}})(),(function(){for(var we in Y("/XObject <<"),Mt)Mt.hasOwnProperty(we)&&Mt[we].objectNumber>=0&&Y("/"+we+" "+Mt[we].objectNumber+" 0 R");jt.publish("putXobjectDict"),Y(">>")})(),Y(">>"),Y("endobj")},Oi=function(ee){et[ee.fontName]=et[ee.fontName]||{},et[ee.fontName][ee.fontStyle]=ee.id},rn=function(ee,we,He,lt,_t){var ln={id:"F"+(Object.keys(Le).length+1).toString(10),postScriptName:ee,fontName:we,fontStyle:He,encoding:lt,isStandardFont:_t||!1,metadata:{}};return jt.publish("addFont",{font:ln,instance:this}),Le[ln.id]=ln,Oi(ln),ln.id},$n=A.__private__.pdfEscape=A.pdfEscape=function(ee,we){return(function(He,lt){var _t,ln,vn,si,oi,Fi,pi,Ir,Hr;if(vn=(lt=lt||{}).sourceEncoding||"Unicode",oi=lt.outputEncoding,(lt.autoencode||oi)&&Le[We].metadata&&Le[We].metadata[vn]&&Le[We].metadata[vn].encoding&&(si=Le[We].metadata[vn].encoding,!oi&&Le[We].encoding&&(oi=Le[We].encoding),!oi&&si.codePages&&(oi=si.codePages[0]),typeof oi=="string"&&(oi=si[oi]),oi)){for(pi=!1,Fi=[],_t=0,ln=He.length;_t<ln;_t++)(Ir=oi[He.charCodeAt(_t)])?Fi.push(String.fromCharCode(Ir)):Fi.push(He[_t]),Fi[_t].charCodeAt(0)>>8&&(pi=!0);He=Fi.join("")}for(_t=He.length;pi===void 0&&_t!==0;)He.charCodeAt(_t-1)>>8&&(pi=!0),_t--;if(!pi)return He;for(Fi=lt.noBOM?[]:[254,255],_t=0,ln=He.length;_t<ln;_t++){if((Hr=(Ir=He.charCodeAt(_t))>>8)>>8)throw new Error("Character at position "+_t+" of string '"+He+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Fi.push(Hr),Fi.push(Ir-(Hr<<8))}return String.fromCharCode.apply(void 0,Fi)})(ee,we).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Fn=A.__private__.beginPage=function(ee){ye[++ut]=[],ft[ut]={objId:0,contentsObjId:0,userUnit:Number(a),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(ee[0]),topRightY:Number(ee[1])}},kt(ut),W(ye[z])},pt=function(ee,we){var He,lt,_t;switch(t=we||t,typeof ee=="string"&&(He=v(ee.toLowerCase()),Array.isArray(He)&&(lt=He[0],_t=He[1])),Array.isArray(ee)&&(lt=ee[0]*De,_t=ee[1]*De),isNaN(lt)&&(lt=r[0],_t=r[1]),(lt>14400||_t>14400)&&(Gs.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),lt=Math.min(14400,lt),_t=Math.min(14400,_t)),r=[lt,_t],t.substr(0,1)){case"l":_t>lt&&(r=[_t,lt]);break;case"p":lt>_t&&(r=[_t,lt])}Fn(r),nt(Me),Y(Ct),Nn!==0&&Y(Nn+" J"),pn!==0&&Y(pn+" j"),jt.publish("addPage",{pageNumber:ut})},vt=function(ee){ee>0&&ee<=ut&&(ye.splice(ee,1),ft.splice(ee,1),ut--,z>ut&&(z=ut),this.setPage(z))},kt=function(ee){ee>0&&ee<=ut&&(z=ee)},mn=A.__private__.getNumberOfPages=A.getNumberOfPages=function(){return ye.length-1},sn=function(ee,we,He){var lt,_t=void 0;return He=He||{},ee=ee!==void 0?ee:Le[We].fontName,we=we!==void 0?we:Le[We].fontStyle,lt=ee.toLowerCase(),et[lt]!==void 0&&et[lt][we]!==void 0?_t=et[lt][we]:et[ee]!==void 0&&et[ee][we]!==void 0?_t=et[ee][we]:He.disableWarning===!1&&Gs.warn("Unable to look up font label for font '"+ee+"', '"+we+"'. Refer to getFontList() for available fonts."),_t||He.noFallback||(_t=et.times[we])==null&&(_t=et.times.normal),_t},bn=A.__private__.putInfo=function(){var ee=Zt(),we=function(lt){return lt};for(var He in u!==null&&(we=Rt.encryptor(ee,0)),Y("<<"),Y("/Producer ("+$n(we("jsPDF "+Di.version))+")"),Ve)Ve.hasOwnProperty(He)&&Ve[He]&&Y("/"+He.substr(0,1).toUpperCase()+He.substr(1)+" ("+$n(we(Ve[He]))+")");Y("/CreationDate ("+$n(we(V))+")"),Y(">>"),Y("endobj")},Li=A.__private__.putCatalog=function(ee){var we=(ee=ee||{}).rootDictionaryObjId||dt;switch(Zt(),Y("<<"),Y("/Type /Catalog"),Y("/Pages "+we+" 0 R"),xe||(xe="fullwidth"),xe){case"fullwidth":Y("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Y("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Y("/OpenAction [3 0 R /Fit]");break;case"original":Y("/OpenAction [3 0 R /XYZ null null 1]");break;default:var He=""+xe;He.substr(He.length-1)==="%"&&(xe=parseInt(xe)/100),typeof xe=="number"&&Y("/OpenAction [3 0 R /XYZ null null "+S(xe)+"]")}switch($e||($e="continuous"),$e){case"continuous":Y("/PageLayout /OneColumn");break;case"single":Y("/PageLayout /SinglePage");break;case"two":case"twoleft":Y("/PageLayout /TwoColumnLeft");break;case"tworight":Y("/PageLayout /TwoColumnRight")}Be&&Y("/PageMode /"+Be),jt.publish("putCatalog"),Y(">>"),Y("endobj")},Wn=A.__private__.putTrailer=function(){Y("trailer"),Y("<<"),Y("/Size "+(ie+1)),Y("/Root "+ie+" 0 R"),Y("/Info "+(ie-1)+" 0 R"),u!==null&&Y("/Encrypt "+Rt.oid+" 0 R"),Y("/ID [ <"+K+"> <"+K+"> ]"),Y(">>")},ui=A.__private__.putHeader=function(){Y("%PDF-"+g),Y("%ºß¬à")},Mi=A.__private__.putXRef=function(){var ee="0000000000";Y("xref"),Y("0 "+(ie+1)),Y("0000000000 65535 f ");for(var we=1;we<=ie;we++)typeof H[we]=="function"?Y((ee+H[we]()).slice(-10)+" 00000 n "):H[we]!==void 0?Y((ee+H[we]).slice(-10)+" 00000 n "):Y("0000000000 00000 n ")},Gn=A.__private__.buildDocument=function(){var ee;ie=0,te=0,se=[],H=[],fe=[],dt=$t(),at=$t(),W(se),jt.publish("buildDocument"),ui(),Hn(),(function(){jt.publish("putAdditionalObjects");for(var He=0;He<fe.length;He++){var lt=fe[He];Ht(lt.objId,!0),Y(lt.content),Y("endobj")}jt.publish("postPutAdditionalObjects")})(),ee=[],(function(){for(var He in Le)Le.hasOwnProperty(He)&&(d===!1||d===!0&&f.hasOwnProperty(He))&&Kn(Le[He])})(),(function(){var He;for(He in le)le.hasOwnProperty(He)&&Gi(le[He])})(),(function(){for(var He in Mt)Mt.hasOwnProperty(He)&&Ti(Mt[He])})(),(function(He){var lt;for(lt in mt)mt.hasOwnProperty(lt)&&(mt[lt]instanceof gf?ti(mt[lt]):mt[lt]instanceof Qp&&ai(mt[lt],He))})(ee),jt.publish("putResources"),ee.forEach(fi),fi({resourcesOid:at,objectOid:Number.MAX_SAFE_INTEGER}),jt.publish("postPutResources"),u!==null&&(Rt.oid=Zt(),Y("<<"),Y("/Filter /Standard"),Y("/V "+Rt.v),Y("/R "+Rt.r),Y("/U <"+Rt.toHexString(Rt.U)+">"),Y("/O <"+Rt.toHexString(Rt.O)+">"),Y("/P "+Rt.P),Y(">>"),Y("endobj")),bn(),Li();var we=te;return Mi(),Wn(),Y("startxref"),Y(""+we),Y("%%EOF"),W(ye[z]),se.join(`
`)},Dn=A.__private__.getBlob=function(ee){return new Blob([ce(ee)],{type:"application/pdf"})},li=A.output=A.__private__.output=(zt=function(ee,we){switch(typeof(we=we||{})=="string"?we={filename:we}:we.filename=we.filename||"generated.pdf",ee){case void 0:return Gn();case"save":A.save(we.filename);break;case"arraybuffer":return ce(Gn());case"blob":return Dn(Gn());case"bloburi":case"bloburl":if(hr.URL!==void 0&&typeof hr.URL.createObjectURL=="function")return hr.URL&&hr.URL.createObjectURL(Dn(Gn()))||void 0;Gs.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var He="",lt=Gn();try{He=BN(lt)}catch{He=BN(unescape(encodeURIComponent(lt)))}return"data:application/pdf;filename="+we.filename+";base64,"+He;case"pdfobjectnewwindow":if(Object.prototype.toString.call(hr)==="[object Window]"){var _t="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",ln=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';we.pdfObjectUrl&&(_t=we.pdfObjectUrl,ln="");var vn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+_t+'"'+ln+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(we)+");<\/script></body></html>",si=hr.open();return si!==null&&si.document.write(vn),si}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(hr)==="[object Window]"){var oi='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(we.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+we.filename+'" width="500px" height="400px" /></body></html>',Fi=hr.open();if(Fi!==null){Fi.document.write(oi);var pi=this;Fi.document.documentElement.querySelector("#pdfViewer").onload=function(){Fi.document.title=we.filename,Fi.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(pi.output("bloburl"))}}return Fi}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(hr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Ir='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",we)+'"></iframe></body></html>',Hr=hr.open();if(Hr!==null&&(Hr.document.write(Ir),Hr.document.title=we.filename),Hr||typeof safari>"u")return Hr;break;case"datauri":case"dataurl":return hr.document.location.href=this.output("datauristring",we);default:return null}},zt.foo=function(){try{return zt.apply(this,arguments)}catch(He){var ee=He.stack||"";~ee.indexOf(" at ")&&(ee=ee.split(" at ")[1]);var we="Error in function "+ee.split(`
`)[0].split("<")[0]+": "+He.message;if(!hr.console)throw new Error(we);hr.console.error(we,He),hr.alert&&alert(we)}},zt.foo.bar=zt,zt.foo),en=function(ee){return Array.isArray(Wt)===!0&&Wt.indexOf(ee)>-1};switch(i){case"pt":De=1;break;case"mm":De=72/25.4;break;case"cm":De=72/2.54;break;case"in":De=72;break;case"px":De=en("px_scaling")==1?.75:96/72;break;case"pc":case"em":De=12;break;case"ex":De=6;break;default:if(typeof i!="number")throw new Error("Invalid unit: "+i);De=i}var Rt=null;Q(),M();var Xn=A.__private__.getPageInfo=A.getPageInfo=function(ee){if(isNaN(ee)||ee%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:ft[ee].objId,pageNumber:ee,pageContext:ft[ee]}},Ui=A.__private__.getPageInfoByObjId=function(ee){if(isNaN(ee)||ee%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var we in ft)if(ft[we].objId===ee)break;return Xn(we)},tt=A.__private__.getCurrentPageInfo=A.getCurrentPageInfo=function(){return{objId:ft[z].objId,pageNumber:z,pageContext:ft[z]}};A.addPage=function(){return pt.apply(this,arguments),this},A.setPage=function(){return kt.apply(this,arguments),W.call(this,ye[z]),this},A.insertPage=function(ee){return this.addPage(),this.movePage(z,ee),this},A.movePage=function(ee,we){var He,lt;if(ee>we){He=ye[ee],lt=ft[ee];for(var _t=ee;_t>we;_t--)ye[_t]=ye[_t-1],ft[_t]=ft[_t-1];ye[we]=He,ft[we]=lt,this.setPage(we)}else if(ee<we){He=ye[ee],lt=ft[ee];for(var ln=ee;ln<we;ln++)ye[ln]=ye[ln+1],ft[ln]=ft[ln+1];ye[we]=He,ft[we]=lt,this.setPage(we)}return this},A.deletePage=function(){return vt.apply(this,arguments),this},A.__private__.text=A.text=function(ee,we,He,lt,_t){var ln,vn,si,oi,Fi,pi,Ir,Hr,Ns,is=(lt=lt||{}).scope||this;if(typeof ee=="number"&&typeof we=="number"&&(typeof He=="string"||Array.isArray(He))){var Js=He;He=we,we=ee,ee=Js}if(arguments[3]instanceof Et==0?(si=arguments[4],oi=arguments[5],Ds(Ir=arguments[3])==="object"&&Ir!==null||(typeof si=="string"&&(oi=si,si=null),typeof Ir=="string"&&(oi=Ir,Ir=null),typeof Ir=="number"&&(si=Ir,Ir=null),lt={flags:Ir,angle:si,align:oi})):(_("The transform parameter of text() with a Matrix value"),Ns=_t),isNaN(we)||isNaN(He)||ee==null)throw new Error("Invalid arguments passed to jsPDF.text");if(ee.length===0)return is;var fs,Io="",Al=typeof lt.lineHeightFactor=="number"?lt.lineHeightFactor:ke,bc=is.internal.scaleFactor;function Qc(er){return er=er.split("	").join(Array(lt.TabLen||9).join(" ")),$n(er,Ir)}function $c(er){for(var xs,co=er.concat(),ho=[],Sc=co.length;Sc--;)typeof(xs=co.shift())=="string"?ho.push(xs):Array.isArray(er)&&(xs.length===1||xs[1]===void 0&&xs[2]===void 0)?ho.push(xs[0]):ho.push([xs[0],xs[1],xs[2]]);return ho}function Fo(er,xs){var co;if(typeof er=="string")co=xs(er)[0];else if(Array.isArray(er)){for(var ho,Sc,Qu=er.concat(),Xa=[],Is=Qu.length;Is--;)typeof(ho=Qu.shift())=="string"?Xa.push(xs(ho)[0]):Array.isArray(ho)&&typeof ho[0]=="string"&&(Sc=xs(ho[0],ho[1],ho[2]),Xa.push([Sc[0],Sc[1],Sc[2]]));co=Xa}return co}var Ba=!1,Wu=!0;if(typeof ee=="string")Ba=!0;else if(Array.isArray(ee)){var Ea=ee.concat();vn=[];for(var L,ae=Ea.length;ae--;)(typeof(L=Ea.shift())!="string"||Array.isArray(L)&&typeof L[0]!="string")&&(Wu=!1);Ba=Wu}if(Ba===!1)throw new Error('Type of text must be string or Array. "'+ee+'" is not recognized.');typeof ee=="string"&&(ee=ee.match(/[\r?\n]/)?ee.split(/\r\n|\r|\n/g):[ee]);var ge=he/is.internal.scaleFactor,Ne=ge*(Al-1);switch(lt.baseline){case"bottom":He-=Ne;break;case"top":He+=ge-Ne;break;case"hanging":He+=ge-2*Ne;break;case"middle":He+=ge/2-Ne}if((pi=lt.maxWidth||0)>0&&(typeof ee=="string"?ee=is.splitTextToSize(ee,pi):Object.prototype.toString.call(ee)==="[object Array]"&&(ee=ee.reduce(function(er,xs){return er.concat(is.splitTextToSize(xs,pi))},[]))),ln={text:ee,x:we,y:He,options:lt,mutex:{pdfEscape:$n,activeFontKey:We,fonts:Le,activeFontSize:he}},jt.publish("preProcessText",ln),ee=ln.text,si=(lt=ln.options).angle,Ns instanceof Et==0&&si&&typeof si=="number"){si*=Math.PI/180,lt.rotationDirection===0&&(si=-si),x===w&&(si=-si);var Ft=Math.cos(si),Kt=Math.sin(si);Ns=new Et(Ft,Kt,-Kt,Ft,0,0)}else si&&si instanceof Et&&(Ns=si);x!==w||Ns||(Ns=Mn),(Fi=lt.charSpace||Qn)!==void 0&&(Io+=b(B(Fi))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Hr=lt.horizontalScale)!==void 0&&(Io+=b(100*Hr)+` Tz
`),lt.lang;var Pn=-1,Lr=lt.renderingMode!==void 0?lt.renderingMode:lt.stroke,Ls=is.internal.getCurrentPageInfo().pageContext;switch(Lr){case 0:case!1:case"fill":Pn=0;break;case 1:case!0:case"stroke":Pn=1;break;case 2:case"fillThenStroke":Pn=2;break;case 3:case"invisible":Pn=3;break;case 4:case"fillAndAddForClipping":Pn=4;break;case 5:case"strokeAndAddPathForClipping":Pn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Pn=6;break;case 7:case"addToPathForClipping":Pn=7}var Fr=Ls.usedRenderingMode!==void 0?Ls.usedRenderingMode:-1;Pn!==-1?Io+=Pn+` Tr
`:Fr!==-1&&(Io+=`0 Tr
`),Pn!==-1&&(Ls.usedRenderingMode=Pn),oi=lt.align||"left";var Mr,cs=he*Al,Nl=is.internal.pageSize.getWidth(),bo=Le[We];Fi=lt.charSpace||Qn,pi=lt.maxWidth||0,Ir=Object.assign({autoencode:!0,noBOM:!0},lt.flags);var eo=[],Qa=function(er){return is.getStringUnitWidth(er,{font:bo,charSpace:Fi,fontSize:he,doKerning:!1})*he/bc};if(Object.prototype.toString.call(ee)==="[object Array]"){var $a;vn=$c(ee),oi!=="left"&&(Mr=vn.map(Qa));var fl,Va=0;if(oi==="right"){we-=Mr[0],ee=[],ae=vn.length;for(var ka=0;ka<ae;ka++)ka===0?(fl=Xe(we),$a=qe(He)):(fl=B(Va-Mr[ka]),$a=-cs),ee.push([vn[ka],fl,$a]),Va=Mr[ka]}else if(oi==="center"){we-=Mr[0]/2,ee=[],ae=vn.length;for(var gh=0;gh<ae;gh++)gh===0?(fl=Xe(we),$a=qe(He)):(fl=B((Va-Mr[gh])/2),$a=-cs),ee.push([vn[gh],fl,$a]),Va=Mr[gh]}else if(oi==="left"){ee=[],ae=vn.length;for(var NA=0;NA<ae;NA++)ee.push(vn[NA])}else if(oi==="justify"&&bo.encoding==="Identity-H"){ee=[],ae=vn.length,pi=pi!==0?pi:Nl;for(var za=0,Ss=0;Ss<ae;Ss++)if($a=Ss===0?qe(He):-cs,fl=Ss===0?Xe(we):za,Ss<ae-1){var LA=B((pi-Mr[Ss])/(vn[Ss].split(" ").length-1)),Vc=vn[Ss].split(" ");ee.push([Vc[0]+" ",fl,$a]),za=0;for(var nc=1;nc<Vc.length;nc++){var Fd=(Qa(Vc[nc-1]+" "+Vc[nc])-Qa(Vc[nc]))*bc+LA;nc==Vc.length-1?ee.push([Vc[nc],Fd,0]):ee.push([Vc[nc]+" ",Fd,0]),za-=Fd}}else ee.push([vn[Ss],fl,$a]);ee.push(["",za,0])}else{if(oi!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(ee=[],ae=vn.length,pi=pi!==0?pi:Nl,Ss=0;Ss<ae;Ss++)$a=Ss===0?qe(He):-cs,fl=Ss===0?Xe(we):0,Ss<ae-1?eo.push(b(B((pi-Mr[Ss])/(vn[Ss].split(" ").length-1)))):eo.push(0),ee.push([vn[Ss],fl,$a])}}(typeof lt.R2L=="boolean"?lt.R2L:Ce)===!0&&(ee=Fo(ee,function(er,xs,co){return[er.split("").reverse().join(""),xs,co]})),ln={text:ee,x:we,y:He,options:lt,mutex:{pdfEscape:$n,activeFontKey:We,fonts:Le,activeFontSize:he}},jt.publish("postProcessText",ln),ee=ln.text,fs=ln.mutex.isHex||!1;var Zh=Le[We].encoding;Zh!=="WinAnsiEncoding"&&Zh!=="StandardEncoding"||(ee=Fo(ee,function(er,xs,co){return[Qc(er),xs,co]})),vn=$c(ee),ee=[];for(var Ia,mh,_c,Ga=Array.isArray(vn[0])?1:0,zc="",yh=function(er,xs,co){var ho="";return co instanceof Et?(co=typeof lt.angle=="number"?an(co,new Et(1,0,0,1,er,xs)):an(new Et(1,0,0,1,er,xs),co),x===w&&(co=an(new Et(1,0,0,-1,0,0),co)),ho=co.join(" ")+` Tm
`):ho=b(er)+" "+b(xs)+` Td
`,ho},Ll=0;Ll<vn.length;Ll++){switch(zc="",Ga){case 1:_c=(fs?"<":"(")+vn[Ll][0]+(fs?">":")"),Ia=parseFloat(vn[Ll][1]),mh=parseFloat(vn[Ll][2]);break;case 0:_c=(fs?"<":"(")+vn[Ll]+(fs?">":")"),Ia=Xe(we),mh=qe(He)}eo!==void 0&&eo[Ll]!==void 0&&(zc=eo[Ll]+` Tw
`),Ll===0?ee.push(zc+yh(Ia,mh,Ns)+_c):Ga===0?ee.push(zc+_c):Ga===1&&ee.push(zc+yh(Ia,mh,Ns)+_c)}ee=Ga===0?ee.join(` Tj
T* `):ee.join(` Tj
`),ee+=` Tj
`;var Cc=`BT
/`;return Cc+=We+" "+he+` Tf
`,Cc+=b(he*Al)+` TL
`,Cc+=fn+`
`,Cc+=Io,Cc+=ee,Y(Cc+="ET"),f[We]=!0,is};var Jt=A.__private__.clip=A.clip=function(ee){return Y(ee==="evenodd"?"W*":"W"),this};A.clipEvenOdd=function(){return Jt("evenodd")},A.__private__.discardPath=A.discardPath=function(){return Y("n"),this};var wn=A.__private__.isValidStyle=function(ee){var we=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(ee)!==-1&&(we=!0),we};A.__private__.setDefaultPathOperation=A.setDefaultPathOperation=function(ee){return wn(ee)&&(h=ee),this};var Yn=A.__private__.getStyle=A.getStyle=function(ee){var we=h;switch(ee){case"D":case"S":we="S";break;case"F":we="f";break;case"FD":case"DF":we="B";break;case"f":case"f*":case"B":case"B*":we=ee}return we},hi=A.close=function(){return Y("h"),this};A.stroke=function(){return Y("S"),this},A.fill=function(ee){return Xt("f",ee),this},A.fillEvenOdd=function(ee){return Xt("f*",ee),this},A.fillStroke=function(ee){return Xt("B",ee),this},A.fillStrokeEvenOdd=function(ee){return Xt("B*",ee),this};var Xt=function(ee,we){Ds(we)==="object"?ws(we,ee):Y(ee)},_i=function(ee){ee===null||x===w&&ee===void 0||(ee=Yn(ee),Y(ee))};function Pr(ee,we,He,lt,_t){var ln=new Qp(we||this.boundingBox,He||this.xStep,lt||this.yStep,this.gState,_t||this.matrix);ln.stream=this.stream;var vn=ee+"$$"+this.cloneIndex+++"$$";return At(vn,ln),ln}var ws=function(ee,we){var He=je[ee.key],lt=mt[He];if(lt instanceof gf)Y("q"),Y(Vi(we)),lt.gState&&A.setGState(lt.gState),Y(ee.matrix.toString()+" cm"),Y("/"+He+" sh"),Y("Q");else if(lt instanceof Qp){var _t=new Et(1,0,0,-1,0,Vn());ee.matrix&&(_t=_t.multiply(ee.matrix||Mn),He=Pr.call(lt,ee.key,ee.boundingBox,ee.xStep,ee.yStep,_t).id),Y("q"),Y("/Pattern cs"),Y("/"+He+" scn"),lt.gState&&A.setGState(lt.gState),Y(we),Y("Q")}},Vi=function(ee){switch(ee){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},br=A.moveTo=function(ee,we){return Y(b(B(ee))+" "+b(E(we))+" m"),this},_r=A.lineTo=function(ee,we){return Y(b(B(ee))+" "+b(E(we))+" l"),this},Qr=A.curveTo=function(ee,we,He,lt,_t,ln){return Y([b(B(ee)),b(E(we)),b(B(He)),b(E(lt)),b(B(_t)),b(E(ln)),"c"].join(" ")),this};A.__private__.line=A.line=function(ee,we,He,lt,_t){if(isNaN(ee)||isNaN(we)||isNaN(He)||isNaN(lt)||!wn(_t))throw new Error("Invalid arguments passed to jsPDF.line");return x===m?this.lines([[He-ee,lt-we]],ee,we,[1,1],_t||"S"):this.lines([[He-ee,lt-we]],ee,we,[1,1]).stroke()},A.__private__.lines=A.lines=function(ee,we,He,lt,_t,ln){var vn,si,oi,Fi,pi,Ir,Hr,Ns,is,Js,fs,Io;if(typeof ee=="number"&&(Io=He,He=we,we=ee,ee=Io),lt=lt||[1,1],ln=ln||!1,isNaN(we)||isNaN(He)||!Array.isArray(ee)||!Array.isArray(lt)||!wn(_t)||typeof ln!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(br(we,He),vn=lt[0],si=lt[1],Fi=ee.length,Js=we,fs=He,oi=0;oi<Fi;oi++)(pi=ee[oi]).length===2?(Js=pi[0]*vn+Js,fs=pi[1]*si+fs,_r(Js,fs)):(Ir=pi[0]*vn+Js,Hr=pi[1]*si+fs,Ns=pi[2]*vn+Js,is=pi[3]*si+fs,Js=pi[4]*vn+Js,fs=pi[5]*si+fs,Qr(Ir,Hr,Ns,is,Js,fs));return ln&&hi(),_i(_t),this},A.path=function(ee){for(var we=0;we<ee.length;we++){var He=ee[we],lt=He.c;switch(He.op){case"m":br(lt[0],lt[1]);break;case"l":_r(lt[0],lt[1]);break;case"c":Qr.apply(this,lt);break;case"h":hi()}}return this},A.__private__.rect=A.rect=function(ee,we,He,lt,_t){if(isNaN(ee)||isNaN(we)||isNaN(He)||isNaN(lt)||!wn(_t))throw new Error("Invalid arguments passed to jsPDF.rect");return x===m&&(lt=-lt),Y([b(B(ee)),b(E(we)),b(B(He)),b(B(lt)),"re"].join(" ")),_i(_t),this},A.__private__.triangle=A.triangle=function(ee,we,He,lt,_t,ln,vn){if(isNaN(ee)||isNaN(we)||isNaN(He)||isNaN(lt)||isNaN(_t)||isNaN(ln)||!wn(vn))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[He-ee,lt-we],[_t-He,ln-lt],[ee-_t,we-ln]],ee,we,[1,1],vn,!0),this},A.__private__.roundedRect=A.roundedRect=function(ee,we,He,lt,_t,ln,vn){if(isNaN(ee)||isNaN(we)||isNaN(He)||isNaN(lt)||isNaN(_t)||isNaN(ln)||!wn(vn))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var si=4/3*(Math.SQRT2-1);return _t=Math.min(_t,.5*He),ln=Math.min(ln,.5*lt),this.lines([[He-2*_t,0],[_t*si,0,_t,ln-ln*si,_t,ln],[0,lt-2*ln],[0,ln*si,-_t*si,ln,-_t,ln],[2*_t-He,0],[-_t*si,0,-_t,-ln*si,-_t,-ln],[0,2*ln-lt],[0,-ln*si,_t*si,-ln,_t,-ln]],ee+_t,we,[1,1],vn,!0),this},A.__private__.ellipse=A.ellipse=function(ee,we,He,lt,_t){if(isNaN(ee)||isNaN(we)||isNaN(He)||isNaN(lt)||!wn(_t))throw new Error("Invalid arguments passed to jsPDF.ellipse");var ln=4/3*(Math.SQRT2-1)*He,vn=4/3*(Math.SQRT2-1)*lt;return br(ee+He,we),Qr(ee+He,we-vn,ee+ln,we-lt,ee,we-lt),Qr(ee-ln,we-lt,ee-He,we-vn,ee-He,we),Qr(ee-He,we+vn,ee-ln,we+lt,ee,we+lt),Qr(ee+ln,we+lt,ee+He,we+vn,ee+He,we),_i(_t),this},A.__private__.circle=A.circle=function(ee,we,He,lt){if(isNaN(ee)||isNaN(we)||isNaN(He)||!wn(lt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(ee,we,He,He,lt)},A.setFont=function(ee,we,He){return He&&(we=D(we,He)),We=sn(ee,we,{disableWarning:!1}),this};var ue=A.__private__.getFont=A.getFont=function(){return Le[sn.apply(A,arguments)]};A.__private__.getFontList=A.getFontList=function(){var ee,we,He={};for(ee in et)if(et.hasOwnProperty(ee))for(we in He[ee]=[],et[ee])et[ee].hasOwnProperty(we)&&He[ee].push(we);return He},A.addFont=function(ee,we,He,lt,_t){var ln=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&ln.indexOf(arguments[3])!==-1?_t=arguments[3]:arguments[3]&&ln.indexOf(arguments[3])==-1&&(He=D(He,lt)),rn.call(this,ee,we,He,_t=_t||"Identity-H")};var ke,Me=n.lineWidth||.200025,Oe=A.__private__.getLineWidth=A.getLineWidth=function(){return Me},nt=A.__private__.setLineWidth=A.setLineWidth=function(ee){return Me=ee,Y(b(B(ee))+" w"),this};A.__private__.setLineDash=Di.API.setLineDash=Di.API.setLineDashPattern=function(ee,we){if(ee=ee||[],we=we||0,isNaN(we)||!Array.isArray(ee))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return ee=ee.map(function(He){return b(B(He))}).join(" "),we=b(B(we)),Y("["+ee+"] "+we+" d"),this};var gt=A.__private__.getLineHeight=A.getLineHeight=function(){return he*ke};A.__private__.getLineHeight=A.getLineHeight=function(){return he*ke};var Ae=A.__private__.setLineHeightFactor=A.setLineHeightFactor=function(ee){return typeof(ee=ee||1.15)=="number"&&(ke=ee),this},me=A.__private__.getLineHeightFactor=A.getLineHeightFactor=function(){return ke};Ae(n.lineHeight);var Xe=A.__private__.getHorizontalCoordinate=function(ee){return B(ee)},qe=A.__private__.getVerticalCoordinate=function(ee){return x===w?ee:ft[z].mediaBox.topRightY-ft[z].mediaBox.bottomLeftY-B(ee)},nn=A.__private__.getHorizontalCoordinateString=A.getHorizontalCoordinateString=function(ee){return b(Xe(ee))},An=A.__private__.getVerticalCoordinateString=A.getVerticalCoordinateString=function(ee){return b(qe(ee))},Ct=n.strokeColor||"0 G";A.__private__.getStrokeColor=A.getDrawColor=function(){return Ot(Ct)},A.__private__.setStrokeColor=A.setDrawColor=function(ee,we,He,lt){return Ct=Cn({ch1:ee,ch2:we,ch3:He,ch4:lt,pdfColorType:"draw",precision:2}),Y(Ct),this};var kn=n.fillColor||"0 g";A.__private__.getFillColor=A.getFillColor=function(){return Ot(kn)},A.__private__.setFillColor=A.setFillColor=function(ee,we,He,lt){return kn=Cn({ch1:ee,ch2:we,ch3:He,ch4:lt,pdfColorType:"fill",precision:2}),Y(kn),this};var fn=n.textColor||"0 g",Qt=A.__private__.getTextColor=A.getTextColor=function(){return Ot(fn)};A.__private__.setTextColor=A.setTextColor=function(ee,we,He,lt){return fn=Cn({ch1:ee,ch2:we,ch3:He,ch4:lt,pdfColorType:"text",precision:3}),this};var Qn=n.charSpace,Tn=A.__private__.getCharSpace=A.getCharSpace=function(){return parseFloat(Qn||0)};A.__private__.setCharSpace=A.setCharSpace=function(ee){if(isNaN(ee))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Qn=ee,this};var Nn=0;A.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},A.__private__.setLineCap=A.setLineCap=function(ee){var we=A.CapJoinStyles[ee];if(we===void 0)throw new Error("Line cap style of '"+ee+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Nn=we,Y(we+" J"),this};var pn=0;A.__private__.setLineJoin=A.setLineJoin=function(ee){var we=A.CapJoinStyles[ee];if(we===void 0)throw new Error("Line join style of '"+ee+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return pn=we,Y(we+" j"),this},A.__private__.setLineMiterLimit=A.__private__.setMiterLimit=A.setLineMiterLimit=A.setMiterLimit=function(ee){if(ee=ee||0,isNaN(ee))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Y(b(B(ee))+" M"),this},A.GState=gg,A.setGState=function(ee){(ee=typeof ee=="string"?le[Je[ee]]:tr(null,ee)).equals(ht)||(Y("/"+ee.id+" gs"),ht=ee)};var tr=function(ee,we){if(!ee||!Je[ee]){var He=!1;for(var lt in le)if(le.hasOwnProperty(lt)&&le[lt].equals(we)){He=!0;break}if(He)we=le[lt];else{var _t="GS"+(Object.keys(le).length+1).toString(10);le[_t]=we,we.id=_t}return ee&&(Je[ee]=we.id),jt.publish("addGState",we),we}};A.addGState=function(ee,we){return tr(ee,we),this},A.saveGraphicsState=function(){return Y("q"),ct.push({key:We,size:he,color:fn}),this},A.restoreGraphicsState=function(){Y("Q");var ee=ct.pop();return We=ee.key,he=ee.size,fn=ee.color,ht=null,this},A.setCurrentTransformationMatrix=function(ee){return Y(ee.toString()+" cm"),this},A.comment=function(ee){return Y("#"+ee),this};var Nr=function(ee,we){var He=ee||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return He},set:function(ln){isNaN(ln)||(He=parseFloat(ln))}});var lt=we||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return lt},set:function(ln){isNaN(ln)||(lt=parseFloat(ln))}});var _t="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return _t},set:function(ln){_t=ln.toString()}}),this},ks=function(ee,we,He,lt){Nr.call(this,ee,we),this.type="rect";var _t=He||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return _t},set:function(vn){isNaN(vn)||(_t=parseFloat(vn))}});var ln=lt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return ln},set:function(vn){isNaN(vn)||(ln=parseFloat(vn))}}),this},ko=function(){this.page=ut,this.currentPage=z,this.pages=ye.slice(0),this.pagesContext=ft.slice(0),this.x=Ge,this.y=Re,this.matrix=Ie,this.width=ar(z),this.height=Vn(z),this.outputDestination=_e,this.id="",this.objectNumber=-1};ko.prototype.restore=function(){ut=this.page,z=this.currentPage,ft=this.pagesContext,ye=this.pages,Ge=this.x,Re=this.y,Ie=this.matrix,un(z,this.width),Ln(z,this.height),_e=this.outputDestination};var As=function(ee,we,He,lt,_t){on.push(new ko),ut=z=0,ye=[],Ge=ee,Re=we,Ie=_t,Fn([He,lt])};for(var xo in A.beginFormObject=function(ee,we,He,lt,_t){return As(ee,we,He,lt,_t),this},A.endFormObject=function(ee){return(function(we){if(dn[we])on.pop().restore();else{var He=new ko,lt="Xo"+(Object.keys(Mt).length+1).toString(10);He.id=lt,dn[we]=lt,Mt[lt]=He,jt.publish("addFormObject",He),on.pop().restore()}})(ee),this},A.doFormObject=function(ee,we){var He=Mt[dn[ee]];return Y("q"),Y(we.toString()+" cm"),Y("/"+He.id+" Do"),Y("Q"),this},A.getFormObject=function(ee){var we=Mt[dn[ee]];return{x:we.x,y:we.y,width:we.width,height:we.height,matrix:we.matrix}},A.save=function(ee,we){return ee=ee||"generated.pdf",(we=we||{}).returnPromise=we.returnPromise||!1,we.returnPromise===!1?(Dp(Dn(Gn()),ee),typeof Dp.unload=="function"&&hr.setTimeout&&setTimeout(Dp.unload,911),this):new Promise(function(He,lt){try{var _t=Dp(Dn(Gn()),ee);typeof Dp.unload=="function"&&hr.setTimeout&&setTimeout(Dp.unload,911),He(_t)}catch(ln){lt(ln.message)}})},Di.API)Di.API.hasOwnProperty(xo)&&(xo==="events"&&Di.API.events.length?(function(ee,we){var He,lt,_t;for(_t=we.length-1;_t!==-1;_t--)He=we[_t][0],lt=we[_t][1],ee.subscribe.apply(ee,[He].concat(typeof lt=="function"?[lt]:lt))})(jt,Di.API.events):A[xo]=Di.API[xo]);var ar=A.getPageWidth=function(ee){return(ft[ee=ee||z].mediaBox.topRightX-ft[ee].mediaBox.bottomLeftX)/De},un=A.setPageWidth=function(ee,we){ft[ee].mediaBox.topRightX=we*De+ft[ee].mediaBox.bottomLeftX},Vn=A.getPageHeight=function(ee){return(ft[ee=ee||z].mediaBox.topRightY-ft[ee].mediaBox.bottomLeftY)/De},Ln=A.setPageHeight=function(ee,we){ft[ee].mediaBox.topRightY=we*De+ft[ee].mediaBox.bottomLeftY};return A.internal={pdfEscape:$n,getStyle:Yn,getFont:ue,getFontSize:Te,getCharSpace:Tn,getTextColor:Qt,getLineHeight:gt,getLineHeightFactor:me,getLineWidth:Oe,write:ve,getHorizontalCoordinate:Xe,getVerticalCoordinate:qe,getCoordinateString:nn,getVerticalCoordinateString:An,collections:{},newObject:Zt,newAdditionalObject:Lt,newObjectDeferred:$t,newObjectDeferredBegin:Ht,getFilters:Rn,putStream:xn,events:jt,scaleFactor:De,pageSize:{getWidth:function(){return ar(z)},setWidth:function(ee){un(z,ee)},getHeight:function(){return Vn(z)},setHeight:function(ee){Ln(z,ee)}},encryptionOptions:u,encryption:Rt,getEncryptor:function(ee){return u!==null?Rt.encryptor(ee,0):function(we){return we}},output:li,getNumberOfPages:mn,pages:ye,out:Y,f2:S,f3:F,getPageInfo:Xn,getPageInfoByObjId:Ui,getCurrentPageInfo:tt,getPDFVersion:p,Point:Nr,Rectangle:ks,Matrix:Et,hasHotfix:en},Object.defineProperty(A.internal.pageSize,"width",{get:function(){return ar(z)},set:function(ee){un(z,ee)},enumerable:!0,configurable:!0}),Object.defineProperty(A.internal.pageSize,"height",{get:function(){return Vn(z)},set:function(ee){Ln(z,ee)},enumerable:!0,configurable:!0}),(function(ee){for(var we=0,He=ne.length;we<He;we++){var lt=rn.call(this,ee[we][0],ee[we][1],ee[we][2],ne[we][3],!0);d===!1&&(f[lt]=!0);var _t=ee[we][0].split("-");Oi({id:lt,fontName:_t[0],fontStyle:_t[1]||""})}jt.publish("addFonts",{fonts:Le,dictionary:et})}).call(A,ne),We="F1",pt(r,t),jt.publish("initialized"),A}k0.prototype.lsbFirstWord=function(n){return String.fromCharCode(255&n,n>>8&255,n>>16&255,n>>24&255)},k0.prototype.toHexString=function(n){return n.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},k0.prototype.hexToBytes=function(n){for(var e=[],t=0;t<n.length;t+=2)e.push(String.fromCharCode(parseInt(n.substr(t,2),16)));return e.join("")},k0.prototype.processOwnerPassword=function(n,e){return jE(DE(e).substr(0,5),n)},k0.prototype.encryptor=function(n,e){var t=DE(this.encryptionKey+String.fromCharCode(255&n,n>>8&255,n>>16&255,255&e,e>>8&255)).substr(0,10);return function(i){return jE(t,i)}},gg.prototype.equals=function(n){var e,t="id,objectNumber,equals";if(!n||Ds(n)!==Ds(this))return!1;var i=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!n.hasOwnProperty(e)||this[e]!==n[e])return!1;i++}for(e in n)n.hasOwnProperty(e)&&t.indexOf(e)<0&&i--;return i===0},Di.API={events:[]},Di.version="3.0.2";var Vo=Di.API,WI=1,Ig=function(n){return n.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},o0=function(n){return n.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},vr=function(n){return n.toFixed(2)},JA=function(n){return n.toFixed(5)};Vo.__acroform__={};var Wc=function(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n},FN=function(n){return n*WI},Ju=function(n){var e=new TV,t=Ii.internal.getHeight(n)||0,i=Ii.internal.getWidth(n)||0;return e.BBox=[0,0,Number(vr(i)),Number(vr(t))],e},Wpe=Vo.__acroform__.setBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return n|1<<e},Qpe=Vo.__acroform__.clearBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return n&~(1<<e)},$pe=Vo.__acroform__.getBit=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return n&1<<e?1:0},ha=Vo.__acroform__.getBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return $pe(n,e-1)},ua=Vo.__acroform__.setBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Wpe(n,e-1)},da=Vo.__acroform__.clearBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Qpe(n,e-1)},Vpe=Vo.__acroform__.calculateCoordinates=function(n,e){var t=e.internal.getHorizontalCoordinate,i=e.internal.getVerticalCoordinate,r=n[0],s=n[1],o=n[2],a=n[3],c={};return c.lowerLeft_X=t(r)||0,c.lowerLeft_Y=i(s+a)||0,c.upperRight_X=t(r+o)||0,c.upperRight_Y=i(s)||0,[Number(vr(c.lowerLeft_X)),Number(vr(c.lowerLeft_Y)),Number(vr(c.upperRight_X)),Number(vr(c.upperRight_Y))]},zpe=function(n){if(n.appearanceStreamContent)return n.appearanceStreamContent;if(n.V||n.DV){var e=[],t=n._V||n.DV,i=PE(n,t),r=n.scope.internal.getFont(n.fontName,n.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(n.scope.__private__.encodeColorString(n.color)),e.push("/"+r+" "+vr(i.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(i.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=Ju(n);return s.scope=n.scope,s.stream=e.join(`
`),s}},PE=function(n,e){var t=n.fontSize===0?n.maxFontSize:n.fontSize,i={text:"",fontSize:""},r=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");r=n.multiline?r.map(function(S){return S.split(`
`)}):r.map(function(S){return[S]});var s=t,o=Ii.internal.getHeight(n)||0;o=o<0?-o:o;var a=Ii.internal.getWidth(n)||0;a=a<0?-a:a;var c=function(S,F,B){if(S+1<r.length){var E=F+" "+r[S+1][0];return Bx(E,n,B).width<=a-4}return!1};s++;e:for(;s>0;){e="",s--;var h,u,d=Bx("3",n,s).height,f=n.multiline?o-s:(o-d)/2,A=f+=2,g=0,p=0,y=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+Bx(e,n,s=12).width+", FieldWidth:"+a+`
`;break}for(var v="",m=0,w=0;w<r.length;w++)if(r.hasOwnProperty(w)){var x=!1;if(r[w].length!==1&&y!==r[w].length-1){if((d+2)*(m+2)+2>o)continue e;v+=r[w][y],x=!0,p=w,w--}else{v=(v+=r[w][y]+" ").substr(v.length-1)==" "?v.substr(0,v.length-1):v;var T=parseInt(w),j=c(T,v,s),D=w>=r.length-1;if(j&&!D){v+=" ",y=0;continue}if(j||D){if(D)p=T;else if(n.multiline&&(d+2)*(m+2)+2>o)continue e}else{if(!n.multiline||(d+2)*(m+2)+2>o)continue e;p=T}}for(var b="",_=g;_<=p;_++){var I=r[_];if(n.multiline){if(_===p){b+=I[y]+" ",y=(y+1)%I.length;continue}if(_===g){b+=I[I.length-1]+" ";continue}}b+=I[0]+" "}switch(b=b.substr(b.length-1)==" "?b.substr(0,b.length-1):b,u=Bx(b,n,s).width,n.textAlign){case"right":h=a-u-2;break;case"center":h=(a-u)/2;break;default:h=2}e+=vr(h)+" "+vr(A)+` Td
`,e+="("+Ig(b)+`) Tj
`,e+=-vr(h)+` 0 Td
`,A=-(s+2),u=0,g=x?p:p+1,m++,v=""}break}return i.text=e,i.fontSize=s,i},Bx=function(n,e,t){var i=e.scope.internal.getFont(e.fontName,e.fontStyle),r=e.scope.getStringUnitWidth(n,{font:i,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:i,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:r}},Gpe={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Xpe=function(n,e){var t={type:"reference",object:n};e.internal.getPageInfo(n.page).pageContext.annotations.find(function(i){return i.type===t.type&&i.object===t.object})===void 0&&e.internal.getPageInfo(n.page).pageContext.annotations.push(t)},Kpe=function(n,e){if(e.scope=n,n.internal!==void 0&&(n.internal.acroformPlugin===void 0||n.internal.acroformPlugin.isInitialized===!1)){if(Ou.FieldNum=0,n.internal.acroformPlugin=JSON.parse(JSON.stringify(Gpe)),n.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");WI=n.internal.scaleFactor,n.internal.acroformPlugin.acroFormDictionaryRoot=new BV,n.internal.acroformPlugin.acroFormDictionaryRoot.scope=n,n.internal.acroformPlugin.acroFormDictionaryRoot._eventID=n.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(n)}),n.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var i=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var r in i)if(i.hasOwnProperty(r)){var s=i[r];s.objId=void 0,s.hasAnnotation&&Xpe(s,t)}})(n)}),n.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(n)}),n.internal.events.subscribe("postPutPages",function(t){(function(i,r){var s=!i;for(var o in i||(r.internal.newObjectDeferredBegin(r.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),r.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),i=i||r.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(i.hasOwnProperty(o)){var a=i[o],c=[],h=a.Rect;if(a.Rect&&(a.Rect=Vpe(a.Rect,r)),r.internal.newObjectDeferredBegin(a.objId,!0),a.DA=Ii.createDefaultAppearanceStream(a),Ds(a)==="object"&&typeof a.getKeyValueListForStream=="function"&&(c=a.getKeyValueListForStream()),a.Rect=h,a.hasAppearanceStream&&!a.appearanceStreamContent){var u=zpe(a);c.push({key:"AP",value:"<</N "+u+">>"}),r.internal.acroformPlugin.xForms.push(u)}if(a.appearanceStreamContent){var d="";for(var f in a.appearanceStreamContent)if(a.appearanceStreamContent.hasOwnProperty(f)){var A=a.appearanceStreamContent[f];if(d+="/"+f+" ",d+="<<",Object.keys(A).length>=1||Array.isArray(A)){for(var o in A)if(A.hasOwnProperty(o)){var g=A[o];typeof g=="function"&&(g=g.call(r,a)),d+="/"+o+" "+g+" ",r.internal.acroformPlugin.xForms.indexOf(g)>=0||r.internal.acroformPlugin.xForms.push(g)}}else typeof(g=A)=="function"&&(g=g.call(r,a)),d+="/"+o+" "+g,r.internal.acroformPlugin.xForms.indexOf(g)>=0||r.internal.acroformPlugin.xForms.push(g);d+=">>"}c.push({key:"AP",value:`<<
`+d+">>"})}r.internal.putStream({additionalKeyValues:c,objectId:a.objId}),r.internal.out("endobj")}s&&(function(p,y){for(var v in p)if(p.hasOwnProperty(v)){var m=v,w=p[v];y.internal.newObjectDeferredBegin(w.objId,!0),Ds(w)==="object"&&typeof w.putStream=="function"&&w.putStream(),delete p[m]}})(r.internal.acroformPlugin.xForms,r)})(t,n)}),n.internal.acroformPlugin.isInitialized=!0}},SV=Vo.__acroform__.arrayToPdfArray=function(n,e,t){var i=function(o){return o};if(Array.isArray(n)){for(var r="[",s=0;s<n.length;s++)switch(s!==0&&(r+=" "),Ds(n[s])){case"boolean":case"number":case"object":r+=n[s].toString();break;case"string":n[s].substr(0,1)!=="/"?(e!==void 0&&t&&(i=t.internal.getEncryptor(e)),r+="("+Ig(i(n[s].toString()))+")"):r+=n[s].toString()}return r+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},e4=function(n,e,t){var i=function(r){return r};return e!==void 0&&t&&(i=t.internal.getEncryptor(e)),(n=n||"").toString(),"("+Ig(i(n))+")"},ld=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(n){this._objId=n}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ld.prototype.toString=function(){return this.objId+" 0 R"},ld.prototype.putStream=function(){var n=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:n,objectId:this.objId}),this.scope.internal.out("endobj")},ld.prototype.getKeyValueListForStream=function(){var n=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var i=e[t],r=this[i];r&&(Array.isArray(r)?n.push({key:i,value:SV(r,this.objId,this.scope)}):r instanceof ld?(r.scope=this.scope,n.push({key:i,value:r.objId+" 0 R"})):typeof r!="function"&&n.push({key:i,value:r}))}return n};var TV=function(){ld.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var n,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){n=t.trim()},get:function(){return n||null}})};Wc(TV,ld);var BV=function(){ld.call(this);var n,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(n){var t=function(i){return i};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Ig(t(n))+")"}},set:function(t){n=t}})};Wc(BV,ld);var Ou=function n(){ld.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute F supplied.');e=v}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!ha(e,3)},set:function(v){v?this.F=ua(e,3):this.F=da(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute Ff supplied.');t=v}});var i=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(i.length!==0)return i},set:function(v){i=v!==void 0?v:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[0])?0:i[0]},set:function(v){i[0]=v}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[1])?0:i[1]},set:function(v){i[1]=v}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[2])?0:i[2]},set:function(v){i[2]=v}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[3])?0:i[3]},set:function(v){i[3]=v}});var r="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return r},set:function(v){switch(v){case"/Btn":case"/Tx":case"/Ch":case"/Sig":r=v;break;default:throw new Error('Invalid value "'+v+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof nC)return;s="FieldObject"+n.FieldNum++}var v=function(m){return m};return this.scope&&(v=this.scope.internal.getEncryptor(this.objId)),"("+Ig(v(s))+")"},set:function(v){s=v.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(v){s=v}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(v){o=v}});var a="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return a},set:function(v){a=v}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(v){c=v}});var h=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return h===void 0?50/WI:h},set:function(v){h=v}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(v){u=v}});var d="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!d||this instanceof nC||this instanceof Jp))return e4(d,this.objId,this.scope)},set:function(v){v=v.toString(),d=v}});var f=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof sl==0?e4(f,this.objId,this.scope):f},set:function(v){v=v.toString(),f=this instanceof sl==0?v.substr(0,1)==="("?o0(v.substr(1,v.length-2)):o0(v):v}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof sl==1?o0(f.substr(1,f.length-1)):f},set:function(v){v=v.toString(),f=this instanceof sl==1?"/"+v:v}});var A=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(A)return A},set:function(v){this.V=v}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(A)return this instanceof sl==0?e4(A,this.objId,this.scope):A},set:function(v){v=v.toString(),A=this instanceof sl==0?v.substr(0,1)==="("?o0(v.substr(1,v.length-2)):o0(v):v}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof sl==1?o0(A.substr(1,A.length-1)):A},set:function(v){v=v.toString(),A=this instanceof sl==1?"/"+v:v}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var g,p=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return p},set:function(v){v=!!v,p=v}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(g)return g},set:function(v){g=v}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!ha(this.Ff,1)},set:function(v){v?this.Ff=ua(this.Ff,1):this.Ff=da(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!ha(this.Ff,2)},set:function(v){v?this.Ff=ua(this.Ff,2):this.Ff=da(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!ha(this.Ff,3)},set:function(v){v?this.Ff=ua(this.Ff,3):this.Ff=da(this.Ff,3)}});var y=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(y!==null)return y},set:function(v){if([0,1,2].indexOf(v)===-1)throw new Error('Invalid value "'+v+'" for attribute Q supplied.');y=v}}),Object.defineProperty(this,"textAlign",{get:function(){var v;switch(y){case 0:default:v="left";break;case 1:v="center";break;case 2:v="right"}return v},configurable:!0,enumerable:!0,set:function(v){switch(v){case"right":case 2:y=2;break;case"center":case 1:y=1;break;default:y=0}}})};Wc(Ou,ld);var sm=function(){Ou.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var n=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return n},set:function(t){n=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return SV(e,this.objId,this.scope)},set:function(t){var i,r;r=[],typeof(i=t)=="string"&&(r=(function(s,o,a){a||(a=1);for(var c,h=[];c=o.exec(s);)h.push(c[a]);return h})(i,/\((.*?)\)/g)),e=r}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,i){for(i=i||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),i!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!ha(this.Ff,18)},set:function(t){t?this.Ff=ua(this.Ff,18):this.Ff=da(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!ha(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=ua(this.Ff,19):this.Ff=da(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!ha(this.Ff,20)},set:function(t){t?(this.Ff=ua(this.Ff,20),e.sort()):this.Ff=da(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!ha(this.Ff,22)},set:function(t){t?this.Ff=ua(this.Ff,22):this.Ff=da(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ha(this.Ff,23)},set:function(t){t?this.Ff=ua(this.Ff,23):this.Ff=da(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!ha(this.Ff,27)},set:function(t){t?this.Ff=ua(this.Ff,27):this.Ff=da(this.Ff,27)}}),this.hasAppearanceStream=!1};Wc(sm,Ou);var om=function(){sm.call(this),this.fontName="helvetica",this.combo=!1};Wc(om,sm);var am=function(){om.call(this),this.combo=!0};Wc(am,om);var qb=function(){am.call(this),this.edit=!0};Wc(qb,am);var sl=function(){Ou.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!ha(this.Ff,15)},set:function(t){t?this.Ff=ua(this.Ff,15):this.Ff=da(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!ha(this.Ff,16)},set:function(t){t?this.Ff=ua(this.Ff,16):this.Ff=da(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!ha(this.Ff,17)},set:function(t){t?this.Ff=ua(this.Ff,17):this.Ff=da(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!ha(this.Ff,26)},set:function(t){t?this.Ff=ua(this.Ff,26):this.Ff=da(this.Ff,26)}});var n,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(s){return s};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var i,r=[];for(i in r.push("<<"),e)r.push("/"+i+" ("+Ig(t(e[i]))+")");return r.push(">>"),r.join(`
`)}},set:function(t){Ds(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(t){n="/"+t}})};Wc(sl,Ou);var Yb=function(){sl.call(this),this.pushButton=!0};Wc(Yb,sl);var lm=function(){sl.call(this),this.radio=!0,this.pushButton=!1;var n=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e!==void 0?e:[]}})};Wc(lm,sl);var nC=function(){var n,e;Ou.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return n},set:function(r){n=r}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(r){e=r}});var t,i={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(a){return a};this.scope&&(r=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),i)o.push("/"+s+" ("+Ig(r(i[s]))+")");return o.push(">>"),o.join(`
`)},set:function(r){Ds(r)==="object"&&(i=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return i.CA||""},set:function(r){typeof r=="string"&&(i.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Ii.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Wc(nC,Ou),lm.prototype.setAppearance=function(n){if(!("createAppearanceStream"in n)||!("getCA"in n))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=n.createAppearanceStream(t.optionName),t.caption=n.getCA()}},lm.prototype.createOption=function(n){var e=new nC;return e.Parent=this,e.optionName=n,this.Kids.push(e),qpe.call(this.scope,e),e};var Zb=function(){sl.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Ii.CheckBox.createAppearanceStream()};Wc(Zb,sl);var Jp=function(){Ou.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!ha(this.Ff,13)},set:function(e){e?this.Ff=ua(this.Ff,13):this.Ff=da(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!ha(this.Ff,21)},set:function(e){e?this.Ff=ua(this.Ff,21):this.Ff=da(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ha(this.Ff,23)},set:function(e){e?this.Ff=ua(this.Ff,23):this.Ff=da(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!ha(this.Ff,24)},set:function(e){e?this.Ff=ua(this.Ff,24):this.Ff=da(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!ha(this.Ff,25)},set:function(e){e?this.Ff=ua(this.Ff,25):this.Ff=da(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!ha(this.Ff,26)},set:function(e){e?this.Ff=ua(this.Ff,26):this.Ff=da(this.Ff,26)}});var n=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return n},set:function(e){Number.isInteger(e)&&(n=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Wc(Jp,Ou);var Jb=function(){Jp.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!ha(this.Ff,14)},set:function(n){n?this.Ff=ua(this.Ff,14):this.Ff=da(this.Ff,14)}}),this.password=!0};Wc(Jb,Jp);var Ii={CheckBox:{createAppearanceStream:function(){return{N:{On:Ii.CheckBox.YesNormal},D:{On:Ii.CheckBox.YesPushDown,Off:Ii.CheckBox.OffPushDown}}},YesPushDown:function(n){var e=Ju(n);e.scope=n.scope;var t=[],i=n.scope.internal.getFont(n.fontName,n.fontStyle).id,r=n.scope.__private__.encodeColorString(n.color),s=PE(n,n.caption);return t.push("0.749023 g"),t.push("0 0 "+vr(Ii.internal.getWidth(n))+" "+vr(Ii.internal.getHeight(n))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+i+" "+vr(s.fontSize)+" Tf "+r),t.push("BT"),t.push(s.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(n){var e=Ju(n);e.scope=n.scope;var t=n.scope.internal.getFont(n.fontName,n.fontStyle).id,i=n.scope.__private__.encodeColorString(n.color),r=[],s=Ii.internal.getHeight(n),o=Ii.internal.getWidth(n),a=PE(n,n.caption);return r.push("1 g"),r.push("0 0 "+vr(o)+" "+vr(s)+" re"),r.push("f"),r.push("q"),r.push("0 0 1 rg"),r.push("0 0 "+vr(o-1)+" "+vr(s-1)+" re"),r.push("W"),r.push("n"),r.push("0 g"),r.push("BT"),r.push("/"+t+" "+vr(a.fontSize)+" Tf "+i),r.push(a.text),r.push("ET"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(n){var e=Ju(n);e.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+vr(Ii.internal.getWidth(n))+" "+vr(Ii.internal.getHeight(n))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(n){var e={D:{Off:Ii.RadioButton.Circle.OffPushDown},N:{}};return e.N[n]=Ii.RadioButton.Circle.YesNormal,e.D[n]=Ii.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(n){var e=Ju(n);e.scope=n.scope;var t=[],i=Ii.internal.getWidth(n)<=Ii.internal.getHeight(n)?Ii.internal.getWidth(n)/4:Ii.internal.getHeight(n)/4;i=Number((.9*i).toFixed(5));var r=Ii.internal.Bezier_C,s=Number((i*r).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+JA(Ii.internal.getWidth(n)/2)+" "+JA(Ii.internal.getHeight(n)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),t.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),t.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),t.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(n){var e=Ju(n);e.scope=n.scope;var t=[],i=Ii.internal.getWidth(n)<=Ii.internal.getHeight(n)?Ii.internal.getWidth(n)/4:Ii.internal.getHeight(n)/4;i=Number((.9*i).toFixed(5));var r=Number((2*i).toFixed(5)),s=Number((r*Ii.internal.Bezier_C).toFixed(5)),o=Number((i*Ii.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+JA(Ii.internal.getWidth(n)/2)+" "+JA(Ii.internal.getHeight(n)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),t.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),t.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),t.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+JA(Ii.internal.getWidth(n)/2)+" "+JA(Ii.internal.getHeight(n)/2)+" cm"),t.push(i+" 0 m"),t.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),t.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),t.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),t.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(n){var e=Ju(n);e.scope=n.scope;var t=[],i=Ii.internal.getWidth(n)<=Ii.internal.getHeight(n)?Ii.internal.getWidth(n)/4:Ii.internal.getHeight(n)/4;i=Number((.9*i).toFixed(5));var r=Number((2*i).toFixed(5)),s=Number((r*Ii.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+JA(Ii.internal.getWidth(n)/2)+" "+JA(Ii.internal.getHeight(n)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),t.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),t.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),t.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(n){var e={D:{Off:Ii.RadioButton.Cross.OffPushDown},N:{}};return e.N[n]=Ii.RadioButton.Cross.YesNormal,e.D[n]=Ii.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(n){var e=Ju(n);e.scope=n.scope;var t=[],i=Ii.internal.calculateCross(n);return t.push("q"),t.push("1 1 "+vr(Ii.internal.getWidth(n)-2)+" "+vr(Ii.internal.getHeight(n)-2)+" re"),t.push("W"),t.push("n"),t.push(vr(i.x1.x)+" "+vr(i.x1.y)+" m"),t.push(vr(i.x2.x)+" "+vr(i.x2.y)+" l"),t.push(vr(i.x4.x)+" "+vr(i.x4.y)+" m"),t.push(vr(i.x3.x)+" "+vr(i.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(n){var e=Ju(n);e.scope=n.scope;var t=Ii.internal.calculateCross(n),i=[];return i.push("0.749023 g"),i.push("0 0 "+vr(Ii.internal.getWidth(n))+" "+vr(Ii.internal.getHeight(n))+" re"),i.push("f"),i.push("q"),i.push("1 1 "+vr(Ii.internal.getWidth(n)-2)+" "+vr(Ii.internal.getHeight(n)-2)+" re"),i.push("W"),i.push("n"),i.push(vr(t.x1.x)+" "+vr(t.x1.y)+" m"),i.push(vr(t.x2.x)+" "+vr(t.x2.y)+" l"),i.push(vr(t.x4.x)+" "+vr(t.x4.y)+" m"),i.push(vr(t.x3.x)+" "+vr(t.x3.y)+" l"),i.push("s"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(n){var e=Ju(n);e.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+vr(Ii.internal.getWidth(n))+" "+vr(Ii.internal.getHeight(n))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(n){var e=n.scope.internal.getFont(n.fontName,n.fontStyle).id,t=n.scope.__private__.encodeColorString(n.color);return"/"+e+" "+n.fontSize+" Tf "+t}};Ii.internal={Bezier_C:.551915024494,calculateCross:function(n){var e=Ii.internal.getWidth(n),t=Ii.internal.getHeight(n),i=Math.min(e,t);return{x1:{x:(e-i)/2,y:(t-i)/2+i},x2:{x:(e-i)/2+i,y:(t-i)/2},x3:{x:(e-i)/2,y:(t-i)/2},x4:{x:(e-i)/2+i,y:(t-i)/2+i}}}},Ii.internal.getWidth=function(n){var e=0;return Ds(n)==="object"&&(e=FN(n.Rect[2])),e},Ii.internal.getHeight=function(n){var e=0;return Ds(n)==="object"&&(e=FN(n.Rect[3])),e};var qpe=Vo.addField=function(n){if(Kpe(this,n),!(n instanceof Ou))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=n).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),n.page=n.scope.internal.getCurrentPageInfo().pageNumber,this};Vo.AcroFormChoiceField=sm,Vo.AcroFormListBox=om,Vo.AcroFormComboBox=am,Vo.AcroFormEditBox=qb,Vo.AcroFormButton=sl,Vo.AcroFormPushButton=Yb,Vo.AcroFormRadioButton=lm,Vo.AcroFormCheckBox=Zb,Vo.AcroFormTextField=Jp,Vo.AcroFormPasswordField=Jb,Vo.AcroFormAppearance=Ii,Vo.AcroForm={ChoiceField:sm,ListBox:om,ComboBox:am,EditBox:qb,Button:sl,PushButton:Yb,RadioButton:lm,CheckBox:Zb,TextField:Jp,PasswordField:Jb,Appearance:Ii},Di.AcroForm={ChoiceField:sm,ListBox:om,ComboBox:am,EditBox:qb,Button:sl,PushButton:Yb,RadioButton:lm,CheckBox:Zb,TextField:Jp,PasswordField:Jb,Appearance:Ii};Di.AcroForm;function EV(n){return n.reduce(function(e,t,i){return e[t]=i,e},{})}(function(n){var e="addImage_";n.__addimage__={};var t="UNKNOWN",i={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=n.__addimage__.getImageFileTypeByImageData=function(S,F){var B,E,V,K,P,M=t;if((F=F||t)==="RGBA"||S.data!==void 0&&S.data instanceof Uint8ClampedArray&&"height"in S&&"width"in S)return"RGBA";if(j(S))for(P in i)for(V=i[P],B=0;B<V.length;B+=1){for(K=!0,E=0;E<V[B].length;E+=1)if(V[B][E]!==void 0&&V[B][E]!==S[E]){K=!1;break}if(K===!0){M=P;break}}else for(P in i)for(V=i[P],B=0;B<V.length;B+=1){for(K=!0,E=0;E<V[B].length;E+=1)if(V[B][E]!==void 0&&V[B][E]!==S.charCodeAt(E)){K=!1;break}if(K===!0){M=P;break}}return M===t&&F!==t&&(M=F),M},s=function S(F){for(var B=this.internal.write,E=this.internal.putStream,V=(0,this.internal.getFilters)();V.indexOf("FlateEncode")!==-1;)V.splice(V.indexOf("FlateEncode"),1);F.objectId=this.internal.newObject();var K=[];if(K.push({key:"Type",value:"/XObject"}),K.push({key:"Subtype",value:"/Image"}),K.push({key:"Width",value:F.width}),K.push({key:"Height",value:F.height}),F.colorSpace===v.INDEXED?K.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(F.palette.length/3-1)+" "+("sMask"in F&&F.sMask!==void 0?F.objectId+2:F.objectId+1)+" 0 R]"}):(K.push({key:"ColorSpace",value:"/"+F.colorSpace}),F.colorSpace===v.DEVICE_CMYK&&K.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),K.push({key:"BitsPerComponent",value:F.bitsPerComponent}),"decodeParameters"in F&&F.decodeParameters!==void 0&&K.push({key:"DecodeParms",value:"<<"+F.decodeParameters+">>"}),"transparency"in F&&Array.isArray(F.transparency)){for(var P="",M=0,X=F.transparency.length;M<X;M++)P+=F.transparency[M]+" "+F.transparency[M]+" ";K.push({key:"Mask",value:"["+P+"]"})}F.sMask!==void 0&&K.push({key:"SMask",value:F.objectId+1+" 0 R"});var Z=F.filter!==void 0?["/"+F.filter]:void 0;if(E({data:F.data,additionalKeyValues:K,alreadyAppliedFilters:Z,objectId:F.objectId}),B("endobj"),"sMask"in F&&F.sMask!==void 0){var Q=(F.predictor!=null?"/Predictor "+F.predictor:"")+" /Colors 1 /BitsPerComponent 8 /Columns "+F.width,U={width:F.width,height:F.height,colorSpace:"DeviceGray",bitsPerComponent:F.bitsPerComponent,decodeParameters:Q,data:F.sMask};"filter"in F&&(U.filter=F.filter),S.call(this,U)}if(F.colorSpace===v.INDEXED){var z=this.internal.newObject();E({data:b(new Uint8Array(F.palette)),objectId:z}),B("endobj")}},o=function(){var S=this.internal.collections[e+"images"];for(var F in S)s.call(this,S[F])},a=function(){var S,F=this.internal.collections[e+"images"],B=this.internal.write;for(var E in F)B("/I"+(S=F[E]).index,S.objectId,"0","R")},c=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",a))},h=function(){var S=this.internal.collections[e+"images"];return c.call(this),S},u=function(){return Object.keys(this.internal.collections[e+"images"]).length},d=function(S){return typeof n["process"+S.toUpperCase()]=="function"},f=function(S){return Ds(S)==="object"&&S.nodeType===1},A=function(S,F){if(S.nodeName==="IMG"&&S.hasAttribute("src")){var B=""+S.getAttribute("src");if(B.indexOf("data:image/")===0)return Kb(unescape(B).split("base64,").pop());var E=n.loadFile(B,!0);if(E!==void 0)return E}if(S.nodeName==="CANVAS"){if(S.width===0||S.height===0)throw new Error("Given canvas must have data. Canvas width: "+S.width+", height: "+S.height);var V;switch(F){case"PNG":V="image/png";break;case"WEBP":V="image/webp";break;default:V="image/jpeg"}return Kb(S.toDataURL(V,1).split("base64,").pop())}},g=function(S){var F=this.internal.collections[e+"images"];if(F){for(var B in F)if(S===F[B].alias)return F[B]}},p=function(S,F,B){return S||F||(S=-96,F=-96),S<0&&(S=-1*B.width*72/S/this.internal.scaleFactor),F<0&&(F=-1*B.height*72/F/this.internal.scaleFactor),S===0&&(S=F*B.width/B.height),F===0&&(F=S*B.height/B.width),[S,F]},y=function(S,F,B,E,V,K){var P=p.call(this,B,E,V),M=this.internal.getCoordinateString,X=this.internal.getVerticalCoordinateString,Z=h.call(this);if(B=P[0],E=P[1],Z[V.index]=V,K){K*=Math.PI/180;var Q=Math.cos(K),U=Math.sin(K),z=function(G){return G.toFixed(4)},q=[z(Q),z(U),z(-1*U),z(Q),0,0,"cm"]}this.internal.write("q"),K?(this.internal.write([1,"0","0",1,M(S),X(F+E),"cm"].join(" ")),this.internal.write(q.join(" ")),this.internal.write([M(B),"0","0",M(E),"0","0","cm"].join(" "))):this.internal.write([M(B),"0","0",M(E),M(S),X(F+E),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+V.index+" Do"),this.internal.write("Q")},v=n.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};n.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var m=n.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=n.__addimage__.sHashCode=function(S){var F,B,E=0;if(typeof S=="string")for(B=S.length,F=0;F<B;F++)E=(E<<5)-E+S.charCodeAt(F),E|=0;else if(j(S))for(B=S.byteLength/2,F=0;F<B;F++)E=(E<<5)-E+S[F],E|=0;return E},x=n.__addimage__.validateStringAsBase64=function(S){(S=S||"").toString().trim();var F=!0;return S.length===0&&(F=!1),S.length%4!=0&&(F=!1),/^[A-Za-z0-9+/]+$/.test(S.substr(0,S.length-2))===!1&&(F=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(S.substr(-2))===!1&&(F=!1),F},T=n.__addimage__.extractImageFromDataUrl=function(S){if(S==null||!(S=S.trim()).startsWith("data:"))return null;var F=S.indexOf(",");return F<0?null:S.substring(0,F).trim().endsWith("base64")?S.substring(F+1):null};n.__addimage__.isArrayBuffer=function(S){return S instanceof ArrayBuffer};var j=n.__addimage__.isArrayBufferView=function(S){return S instanceof Int8Array||S instanceof Uint8Array||S instanceof Uint8ClampedArray||S instanceof Int16Array||S instanceof Uint16Array||S instanceof Int32Array||S instanceof Uint32Array||S instanceof Float32Array||S instanceof Float64Array},D=n.__addimage__.binaryStringToUint8Array=function(S){for(var F=S.length,B=new Uint8Array(F),E=0;E<F;E++)B[E]=S.charCodeAt(E);return B},b=n.__addimage__.arrayBufferToBinaryString=function(S){for(var F="",B=j(S)?S:new Uint8Array(S),E=0;E<B.length;E+=8192)F+=String.fromCharCode.apply(null,B.subarray(E,E+8192));return F};n.addImage=function(){var S,F,B,E,V,K,P,M,X;if(typeof arguments[1]=="number"?(F=t,B=arguments[1],E=arguments[2],V=arguments[3],K=arguments[4],P=arguments[5],M=arguments[6],X=arguments[7]):(F=arguments[1],B=arguments[2],E=arguments[3],V=arguments[4],K=arguments[5],P=arguments[6],M=arguments[7],X=arguments[8]),Ds(S=arguments[0])==="object"&&!f(S)&&"imageData"in S){var Z=S;S=Z.imageData,F=Z.format||F||t,B=Z.x||B||0,E=Z.y||E||0,V=Z.w||Z.width||V,K=Z.h||Z.height||K,P=Z.alias||P,M=Z.compression||M,X=Z.rotation||Z.angle||X}var Q=this.internal.getFilters();if(M===void 0&&Q.indexOf("FlateEncode")!==-1&&(M="SLOW"),isNaN(B)||isNaN(E))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var U=_.call(this,S,F,P,M);return y.call(this,B,E,V,K,U,X),this};var _=function(S,F,B,E){var V,K,P;if(typeof S=="string"&&r(S)===t){S=unescape(S);var M=I(S,!1);(M!==""||(M=n.loadFile(S,!0))!==void 0)&&(S=M)}if(f(S)&&(S=A(S,F)),F=r(S,F),!d(F))throw new Error("addImage does not support files of type '"+F+"', please ensure that a plugin for '"+F+"' support is added.");if(((P=B)==null||P.length===0)&&(B=(function(X){return typeof X=="string"||j(X)?w(X):j(X.data)?w(X.data):null})(S)),(V=g.call(this,B))||(S instanceof Uint8Array||F==="RGBA"||(K=S,S=D(S)),V=this["process"+F.toUpperCase()](S,u.call(this),B,(function(X){return X&&typeof X=="string"&&(X=X.toUpperCase()),X in n.image_compression?X:m.NONE})(E),K)),!V)throw new Error("An unknown error occurred whilst processing the image.");return V},I=n.__addimage__.convertBase64ToBinaryString=function(S,F){F=typeof F!="boolean"||F;var B,E="";if(typeof S=="string"){var V;B=(V=T(S))!==null&&V!==void 0?V:S;try{E=Kb(B)}catch(K){if(F)throw x(B)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+K.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return E};n.getImageProperties=function(S){var F,B,E="";if(f(S)&&(S=A(S)),typeof S=="string"&&r(S)===t&&((E=I(S,!1))===""&&(E=n.loadFile(S)||""),S=E),B=r(S),!d(B))throw new Error("addImage does not support files of type '"+B+"', please ensure that a plugin for '"+B+"' support is added.");if(S instanceof Uint8Array||(S=D(S)),!(F=this["process"+B.toUpperCase()](S)))throw new Error("An unknown error occurred whilst processing the image");return F.fileType=B,F}})(Di.API),(function(n){var e=function(t){if(t!==void 0&&t!="")return!0};Di.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),n.events.push(["putPage",function(t){for(var i,r,s,o=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(t.objId),h=t.pageContext.annotations,u=!1,d=0;d<h.length&&!u;d++)switch((i=h[d]).type){case"link":(e(i.options.url)||e(i.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var f=0;f<h.length;f++){i=h[f];var A=this.internal.pdfEscape,g=this.internal.getEncryptor(t.objId);switch(i.type){case"reference":this.internal.write(" "+i.object.objId+" 0 R ");break;case"text":var p=this.internal.newAdditionalObject(),y=this.internal.newAdditionalObject(),v=this.internal.getEncryptor(p.objId),m=i.title||"Note";s="<</Type /Annot /Subtype /Text "+(r="/Rect ["+o(i.bounds.x)+" "+a(i.bounds.y+i.bounds.h)+" "+o(i.bounds.x+i.bounds.w)+" "+a(i.bounds.y)+"] ")+"/Contents ("+A(v(i.contents))+")",s+=" /Popup "+y.objId+" 0 R",s+=" /P "+c.objId+" 0 R",s+=" /T ("+A(v(m))+") >>",p.content=s;var w=p.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(r="/Rect ["+o(i.bounds.x+30)+" "+a(i.bounds.y+i.bounds.h)+" "+o(i.bounds.x+i.bounds.w+30)+" "+a(i.bounds.y)+"] ")+" /Parent "+w,i.open&&(s+=" /Open true"),s+=" >>",y.content=s,this.internal.write(p.objId,"0 R",y.objId,"0 R");break;case"freetext":r="/Rect ["+o(i.bounds.x)+" "+a(i.bounds.y)+" "+o(i.bounds.x+i.bounds.w)+" "+a(i.bounds.y+i.bounds.h)+"] ";var x=i.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+r+"/Contents ("+A(g(i.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+x+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(i.options.name){var T=this.annotations._nameMap[i.options.name];i.options.pageNumber=T.page,i.options.top=T.y}else i.options.top||(i.options.top=0);if(r="/Rect ["+i.finalBounds.x+" "+i.finalBounds.y+" "+i.finalBounds.w+" "+i.finalBounds.h+"] ",s="",i.options.url)s="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /A <</S /URI /URI ("+A(g(i.options.url))+") >>";else if(i.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(i.options.pageNumber).objId+" 0 R",i.options.magFactor=i.options.magFactor||"XYZ",i.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+i.options.top+"]";break;case"FitV":i.options.left=i.options.left||0,s+=" /FitV "+i.options.left+"]";break;default:var j=a(i.options.top);i.options.left=i.options.left||0,i.options.zoom===void 0&&(i.options.zoom=0),s+=" /XYZ "+i.options.left+" "+j+" "+i.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),n.createAnnotation=function(t){var i=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":i.pageContext.annotations.push(t)}},n.link=function(t,i,r,s,o){var a=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,h=this.internal.getVerticalCoordinateString;a.pageContext.annotations.push({finalBounds:{x:c(t),y:h(i),w:c(t+r),h:h(i+s)},options:o,type:"link"})},n.textWithLink=function(t,i,r,s){var o,a,c=this.getTextWidth(t),h=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){a=s.maxWidth;var u=this.splitTextToSize(t,a).length;o=Math.ceil(h*u)}else a=c,o=h;return this.text(t,i,r,s),r+=.2*h,s.align==="center"&&(i-=c/2),s.align==="right"&&(i-=c),this.link(i,r-h,a,o,s),c},n.getTextWidth=function(t){var i=this.internal.getFontSize();return this.getStringUnitWidth(t)*i/this.internal.scaleFactor}})(Di.API),(function(n){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},i={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},r=[1570,1571,1573,1575];n.__arabicParser__={};var s=n.__arabicParser__.isInArabicSubstitutionA=function(p){return e[p.charCodeAt(0)]!==void 0},o=n.__arabicParser__.isArabicLetter=function(p){return typeof p=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(p)},a=n.__arabicParser__.isArabicEndLetter=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length<=2},c=n.__arabicParser__.isArabicAlfLetter=function(p){return o(p)&&r.indexOf(p.charCodeAt(0))>=0};n.__arabicParser__.arabicLetterHasIsolatedForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length>=1};var h=n.__arabicParser__.arabicLetterHasFinalForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length>=2};n.__arabicParser__.arabicLetterHasInitialForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length>=3};var u=n.__arabicParser__.arabicLetterHasMedialForm=function(p){return o(p)&&s(p)&&e[p.charCodeAt(0)].length==4},d=n.__arabicParser__.resolveLigatures=function(p){var y=0,v=t,m="",w=0;for(y=0;y<p.length;y+=1)v[p.charCodeAt(y)]!==void 0?(w++,typeof(v=v[p.charCodeAt(y)])=="number"&&(m+=String.fromCharCode(v),v=t,w=0),y===p.length-1&&(v=t,m+=p.charAt(y-(w-1)),y-=w-1,w=0)):(v=t,m+=p.charAt(y-w),y-=w,w=0);return m};n.__arabicParser__.isArabicDiacritic=function(p){return p!==void 0&&i[p.charCodeAt(0)]!==void 0};var f=n.__arabicParser__.getCorrectForm=function(p,y,v){return o(p)?s(p)===!1?-1:!h(p)||!o(y)&&!o(v)||!o(v)&&a(y)||a(p)&&!o(y)||a(p)&&c(y)||a(p)&&a(y)?0:u(p)&&o(y)&&!a(y)&&o(v)&&h(v)?3:a(p)||!o(v)?1:2:-1},A=function(p){var y=0,v=0,m=0,w="",x="",T="",j=(p=p||"").split("\\s+"),D=[];for(y=0;y<j.length;y+=1){for(D.push(""),v=0;v<j[y].length;v+=1)w=j[y][v],x=j[y][v-1],T=j[y][v+1],o(w)?(m=f(w,x,T),D[y]+=m!==-1?String.fromCharCode(e[w.charCodeAt(0)][m]):w):D[y]+=w;D[y]=d(D[y])}return D.join(" ")},g=n.__arabicParser__.processArabic=n.processArabic=function(){var p,y=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,v=[];if(Array.isArray(y)){var m=0;for(v=[],m=0;m<y.length;m+=1)Array.isArray(y[m])?v.push([A(y[m][0]),y[m][1],y[m][2]]):v.push([A(y[m])]);p=v}else p=A(y);return typeof arguments[0]=="string"?p:(arguments[0].text=p,arguments[0])};n.events.push(["preProcessText",g])})(Di.API),Di.API.autoPrint=function(n){var e;return(n=n||{}).variant=n.variant||"non-conform",n.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},(function(n){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(a){t=a}});var i=150;Object.defineProperty(this,"width",{get:function(){return i},set:function(a){i=isNaN(a)||Number.isInteger(a)===!1||a<0?150:a,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=i+1)}});var r=300;Object.defineProperty(this,"height",{get:function(){return r},set:function(a){r=isNaN(a)||Number.isInteger(a)===!1||a<0?300:a,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=r+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(a){s=a}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(a){o=a}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,i){var r;if((t=t||"2d")!=="2d")return null;for(r in i)this.pdf.context2d.hasOwnProperty(r)&&(this.pdf.context2d[r]=i[r]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},n.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])})(Di.API),(function(n){var e={left:0,top:0,bottom:0,right:0},t=!1,i=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),r.call(this))},r=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(p){c=p}});var h=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return h},set:function(p){h=p}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(p){u=p}});var d=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return d},set:function(p){d=p}});var f=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return f},set:function(p){f=p}});var A=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return A},set:function(p){A=p}});var g=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return g},set:function(p){g=p}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},n.setHeaderFunction=function(c){return i.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},n.getTextDimensions=function(c,h){i.call(this);var u=(h=h||{}).fontSize||this.getFontSize(),d=h.font||this.getFont(),f=h.scaleFactor||this.internal.scaleFactor,A=0,g=0,p=0,y=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var v=h.maxWidth;v>0?typeof c=="string"?c=this.splitTextToSize(c,v):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(w,x){return w.concat(y.splitTextToSize(x,v))},[])):c=Array.isArray(c)?c:[c];for(var m=0;m<c.length;m++)A<(p=this.getStringUnitWidth(c[m],{font:d})*u)&&(A=p);return A!==0&&(g=c.length),{w:A/=f,h:Math.max((g*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/f,0)}},n.cellAddPage=function(){i.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=n.cell=function(){var c;c=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),i.call(this);var h=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,d=this.internal.__cell__.margins||e,f=this.internal.__cell__.tableHeaderRow,A=this.internal.__cell__.printHeaders;return h.lineNumber!==void 0&&(h.lineNumber===c.lineNumber?(c.x=(h.x||0)+(h.width||0),c.y=h.y||0):h.y+h.height+c.height+d.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=d.top,A&&f&&(this.printHeaderRow(c.lineNumber,!0),c.y+=f[0].height)):c.y=h.y+h.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,t===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-u,c.y+u,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+u,{align:"center",baseline:"top",maxWidth:c.width-u-u}):this.text(c.text,c.x+u,c.y+u,{align:"left",baseline:"top",maxWidth:c.width-u-u})),this.internal.__cell__.lastCell=c,this};n.table=function(c,h,u,d,f){if(i.call(this),!u)throw new Error("No data for PDF table.");var A,g,p,y,v=[],m=[],w=[],x={},T={},j=[],D=[],b=(f=f||{}).autoSize||!1,_=f.printHeaders!==!1,I=f.css&&f.css["font-size"]!==void 0?16*f.css["font-size"]:f.fontSize||12,S=f.margins||Object.assign({width:this.getPageWidth()},e),F=typeof f.padding=="number"?f.padding:3,B=f.headerBackgroundColor||"#c8c8c8",E=f.headerTextColor||"#000";if(r.call(this),this.internal.__cell__.printHeaders=_,this.internal.__cell__.margins=S,this.internal.__cell__.table_font_size=I,this.internal.__cell__.padding=F,this.internal.__cell__.headerBackgroundColor=B,this.internal.__cell__.headerTextColor=E,this.setFontSize(I),d==null)m=v=Object.keys(u[0]),w=v.map(function(){return"left"});else if(Array.isArray(d)&&Ds(d[0])==="object")for(v=d.map(function(Z){return Z.name}),m=d.map(function(Z){return Z.prompt||Z.name||""}),w=d.map(function(Z){return Z.align||"left"}),A=0;A<d.length;A+=1)T[d[A].name]=.7499990551181103*d[A].width;else Array.isArray(d)&&typeof d[0]=="string"&&(m=v=d,w=v.map(function(){return"left"}));if(b||Array.isArray(d)&&typeof d[0]=="string")for(A=0;A<v.length;A+=1){for(x[y=v[A]]=u.map(function(Z){return Z[y]}),this.setFont(void 0,"bold"),j.push(this.getTextDimensions(m[A],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),g=x[y],this.setFont(void 0,"normal"),p=0;p<g.length;p+=1)j.push(this.getTextDimensions(g[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);T[y]=Math.max.apply(null,j)+F+F,j=[]}if(_){var V={};for(A=0;A<v.length;A+=1)V[v[A]]={},V[v[A]].text=m[A],V[v[A]].align=w[A];var K=a.call(this,V,T);D=v.map(function(Z){return new s(c,h,T[Z],K,V[Z].text,void 0,V[Z].align)}),this.setTableHeaderRow(D),this.printHeaderRow(1,!1)}var P=d.reduce(function(Z,Q){return Z[Q.name]=Q.align,Z},{});for(A=0;A<u.length;A+=1){"rowStart"in f&&f.rowStart instanceof Function&&f.rowStart({row:A,data:u[A]},this);var M=a.call(this,u[A],T);for(p=0;p<v.length;p+=1){var X=u[A][v[p]];"cellStart"in f&&f.cellStart instanceof Function&&f.cellStart({row:A,col:p,data:X},this),o.call(this,new s(c,h,T[v[p]],M,X,A+2,P[v[p]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=h,this};var a=function(c,h){var u=this.internal.__cell__.padding,d=this.internal.__cell__.table_font_size,f=this.internal.scaleFactor;return Object.keys(c).map(function(A){var g=c[A];return this.splitTextToSize(g.hasOwnProperty("text")?g.text:g,h[A]-u-u)},this).map(function(A){return this.getLineHeightFactor()*A.length*d/f+u+u},this).reduce(function(A,g){return Math.max(A,g)},0)};n.setTableHeaderRow=function(c){i.call(this),this.internal.__cell__.tableHeaderRow=c},n.printHeaderRow=function(c,h){if(i.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var d=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(d[0],d[1],d[2],d[3],void 0,-1)}this.setFont(void 0,"bold");for(var f=[],A=0;A<this.internal.__cell__.tableHeaderRow.length;A+=1){u=this.internal.__cell__.tableHeaderRow[A].clone(),h&&(u.y=this.internal.__cell__.margins.top||0,f.push(u)),u.lineNumber=c;var g=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,u),this.setTextColor(g)}f.length>0&&this.setTableHeaderRow(f),this.setFont(void 0,"normal"),t=!1}})(Di.API);var kV={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},IV=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],NE=EV(IV),FV=[100,200,300,400,500,600,700,800,900],Ype=EV(FV);function t4(n){var e=n.family.replace(/"|'/g,"").toLowerCase(),t=(function(s){return kV[s=s||"normal"]?s:"normal"})(n.style),i=(function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400})(n.weight),r=(function(s){return typeof NE[s=s||"normal"]=="number"?s:"normal"})(n.stretch);return{family:e,style:t,weight:i,stretch:r,src:n.src||[],ref:n.ref||{name:e,style:[r,t,i].join(" ")}}}function DN(n,e,t,i){var r;for(r=t;r>=0&&r<e.length;r+=i)if(n[e[r]])return n[e[r]];for(r=t;r>=0&&r<e.length;r-=i)if(n[e[r]])return n[e[r]]}var Zpe={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},jN={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function PN(n){return[n.stretch,n.style,n.weight,n.family].join(" ")}function NN(n){return n.trimLeft()}function Jpe(n,e){for(var t=0;t<n.length;){if(n.charAt(t)===e)return[n.substring(0,t),n.substring(t+1)];t+=1}return null}function ege(n){var e=n.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],n.substring(e[0].length)]}var Ex,LN,MN,a0,kx,RN,ON,UN,n4=["times"];function HN(n,e,t,i){var r=4,s=QN;switch(i){case Di.API.image_compression.FAST:r=1,s=WN;break;case Di.API.image_compression.MEDIUM:r=6,s=$N;break;case Di.API.image_compression.SLOW:r=9,s=VN}n=(function(a,c,h,u){for(var d,f=a.length/c,A=new Uint8Array(a.length+f),g=[tge,WN,QN,$N,VN],p=0;p<f;p+=1){var y=p*c,v=a.subarray(y,y+c);if(u)A.set(u(v,h,d),y+p);else{for(var m=g.length,w=[],x=0;x<m;x+=1)w[x]=g[x](v,h,d);var T=ige(w.concat());A.set(w[T],y+p)}d=v}return A})(n,e,t,s);var o=EE(n,{level:r});return Di.API.__addimage__.arrayBufferToBinaryString(o)}function tge(n){var e=Array.apply([],n);return e.unshift(0),e}function WN(n,e){var t=n.length,i=[];i[0]=1;for(var r=0;r<t;r+=1){var s=n[r-e]||0;i[r+1]=n[r]-s+256&255}return i}function QN(n,e,t){var i=n.length,r=[];r[0]=2;for(var s=0;s<i;s+=1){var o=t&&t[s]||0;r[s+1]=n[s]-o+256&255}return r}function $N(n,e,t){var i=n.length,r=[];r[0]=3;for(var s=0;s<i;s+=1){var o=n[s-e]||0,a=t&&t[s]||0;r[s+1]=n[s]+256-(o+a>>>1)&255}return r}function VN(n,e,t){var i=n.length,r=[];r[0]=4;for(var s=0;s<i;s+=1){var o=nge(n[s-e]||0,t&&t[s]||0,t&&t[s-e]||0);r[s+1]=n[s]-o+256&255}return r}function nge(n,e,t){if(n===e&&e===t)return n;var i=Math.abs(e-t),r=Math.abs(n-t),s=Math.abs(n+e-t-t);return i<=r&&i<=s?n:r<=s?e:t}function ige(n){var e=n.map(function(t){return t.reduce(function(i,r){return i+Math.abs(r)},0)});return e.indexOf(Math.min.apply(null,e))}function i4(n,e,t){var i=e*t,r=Math.floor(i/8),s=16-(i-8*r+t),o=(1<<t)-1;return DV(n,r)>>s&o}function zN(n,e,t,i){var r=t*i,s=Math.floor(r/8),o=16-(r-8*s+i),a=(1<<i)-1,c=(e&a)<<o;(function(h,u,d){if(u+1<h.byteLength)h.setUint16(u,d,!1);else{var f=d>>8&255;h.setUint8(u,f)}})(n,s,DV(n,s)&~(a<<o)&65535|c)}function DV(n,e){return e+1<n.byteLength?n.getUint16(e,!1):n.getUint8(e)<<8}function rge(n){var e=0;if(n[e++]!==71||n[e++]!==73||n[e++]!==70||n[e++]!==56||(n[e++]+1&253)!=56||n[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=n[e++]|n[e++]<<8,i=n[e++]|n[e++]<<8,r=n[e++],s=r>>7,o=1<<1+(7&r);n[e++],n[e++];var a=null,c=null;s&&(a=e,c=o,e+=3*o);var h=!0,u=[],d=0,f=null,A=0,g=null;for(this.width=t,this.height=i;h&&e<n.length;)switch(n[e++]){case 33:switch(n[e++]){case 255:if(n[e]!==11||n[e+1]==78&&n[e+2]==69&&n[e+3]==84&&n[e+4]==83&&n[e+5]==67&&n[e+6]==65&&n[e+7]==80&&n[e+8]==69&&n[e+9]==50&&n[e+10]==46&&n[e+11]==48&&n[e+12]==3&&n[e+13]==1&&n[e+16]==0)e+=14,g=n[e++]|n[e++]<<8,e++;else for(e+=12;;){if(!((S=n[e++])>=0))throw Error("Invalid block size");if(S===0)break;e+=S}break;case 249:if(n[e++]!==4||n[e+4]!==0)throw new Error("Invalid graphics extension block.");var p=n[e++];d=n[e++]|n[e++]<<8,f=n[e++],1&p||(f=null),A=p>>2&7,e++;break;case 254:for(;;){if(!((S=n[e++])>=0))throw Error("Invalid block size");if(S===0)break;e+=S}break;default:throw new Error("Unknown graphic control label: 0x"+n[e-1].toString(16))}break;case 44:var y=n[e++]|n[e++]<<8,v=n[e++]|n[e++]<<8,m=n[e++]|n[e++]<<8,w=n[e++]|n[e++]<<8,x=n[e++],T=x>>6&1,j=1<<1+(7&x),D=a,b=c,_=!1;x>>7&&(_=!0,D=e,b=j,e+=3*j);var I=e;for(e++;;){var S;if(!((S=n[e++])>=0))throw Error("Invalid block size");if(S===0)break;e+=S}u.push({x:y,y:v,width:m,height:w,has_local_palette:_,palette_offset:D,palette_size:b,data_offset:I,data_length:e-I,transparent_index:f,interlaced:!!T,delay:d,disposal:A});break;case 59:h=!1;break;default:throw new Error("Unknown gif block: 0x"+n[e-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return g},this.frameInfo=function(F){if(F<0||F>=u.length)throw new Error("Frame index out of range.");return u[F]},this.decodeAndBlitFrameBGRA=function(F,B){var E=this.frameInfo(F),V=E.width*E.height,K=new Uint8Array(V);GN(n,E.data_offset,K,V);var P=E.palette_offset,M=E.transparent_index;M===null&&(M=256);var X=E.width,Z=t-X,Q=X,U=4*(E.y*t+E.x),z=4*((E.y+E.height)*t+E.x),q=U,G=4*Z;E.interlaced===!0&&(G+=4*t*7);for(var ie=8,H=0,se=K.length;H<se;++H){var te=K[H];if(Q===0&&(Q=X,(q+=G)>=z&&(G=4*Z+4*t*(ie-1),q=U+(X+Z)*(ie<<1),ie>>=1)),te===M)q+=4;else{var fe=n[P+3*te],ye=n[P+3*te+1],be=n[P+3*te+2];B[q++]=be,B[q++]=ye,B[q++]=fe,B[q++]=255}--Q}},this.decodeAndBlitFrameRGBA=function(F,B){var E=this.frameInfo(F),V=E.width*E.height,K=new Uint8Array(V);GN(n,E.data_offset,K,V);var P=E.palette_offset,M=E.transparent_index;M===null&&(M=256);var X=E.width,Z=t-X,Q=X,U=4*(E.y*t+E.x),z=4*((E.y+E.height)*t+E.x),q=U,G=4*Z;E.interlaced===!0&&(G+=4*t*7);for(var ie=8,H=0,se=K.length;H<se;++H){var te=K[H];if(Q===0&&(Q=X,(q+=G)>=z&&(G=4*Z+4*t*(ie-1),q=U+(X+Z)*(ie<<1),ie>>=1)),te===M)q+=4;else{var fe=n[P+3*te],ye=n[P+3*te+1],be=n[P+3*te+2];B[q++]=fe,B[q++]=ye,B[q++]=be,B[q++]=255}--Q}}}function GN(n,e,t,i){for(var r=n[e++],s=1<<r,o=s+1,a=o+1,c=r+1,h=(1<<c)-1,u=0,d=0,f=0,A=n[e++],g=new Int32Array(4096),p=null;;){for(;u<16&&A!==0;)d|=n[e++]<<u,u+=8,A===1?A=n[e++]:--A;if(u<c)break;var y=d&h;if(d>>=c,u-=c,y!==s){if(y===o)break;for(var v=y<a?y:p,m=0,w=v;w>s;)w=g[w]>>8,++m;var x=w;if(f+m+(v!==y?1:0)>i)return void Gs.log("Warning, gif stream longer than expected.");t[f++]=x;var T=f+=m;for(v!==y&&(t[f++]=x),w=v;m--;)w=g[w],t[--T]=255&w,w>>=8;p!==null&&a<4096&&(g[a++]=p<<8|x,a>=h+1&&c<12&&(++c,h=h<<1|1)),p=y}else a=o+1,h=(1<<(c=r+1))-1,p=null}return f!==i&&Gs.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function r4(n){var e,t,i,r,s,o=Math.floor,a=new Array(64),c=new Array(64),h=new Array(64),u=new Array(64),d=new Array(65535),f=new Array(65535),A=new Array(64),g=new Array(64),p=[],y=0,v=7,m=new Array(64),w=new Array(64),x=new Array(64),T=new Array(256),j=new Array(2048),D=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],b=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],_=[0,1,2,3,4,5,6,7,8,9,10,11],I=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],S=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],F=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],B=[0,1,2,3,4,5,6,7,8,9,10,11],E=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],V=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function K(U,z){for(var q=0,G=0,ie=new Array,H=1;H<=16;H++){for(var se=1;se<=U[H];se++)ie[z[G]]=[],ie[z[G]][0]=q,ie[z[G]][1]=H,G++,q++;q*=2}return ie}function P(U){for(var z=U[0],q=U[1]-1;q>=0;)z&1<<q&&(y|=1<<v),q--,--v<0&&(y==255?(M(255),M(0)):M(y),v=7,y=0)}function M(U){p.push(U)}function X(U){M(U>>8&255),M(255&U)}function Z(U,z,q,G,ie){for(var H,se=ie[0],te=ie[240],fe=(function(he,xe){var Te,Ce,Be,Ye,$e,ot,rt,Ve,We,De,Ge=0;for(We=0;We<8;++We){Te=he[Ge],Ce=he[Ge+1],Be=he[Ge+2],Ye=he[Ge+3],$e=he[Ge+4],ot=he[Ge+5],rt=he[Ge+6];var Re=Te+(Ve=he[Ge+7]),Ie=Te-Ve,Le=Ce+rt,et=Ce-rt,ct=Be+ot,mt=Be-ot,je=Ye+$e,le=Ye-$e,Je=Re+je,ht=Re-je,ut=Le+ct,ft=Le-ct;he[Ge]=Je+ut,he[Ge+4]=Je-ut;var jt=.707106781*(ft+ht);he[Ge+2]=ht+jt,he[Ge+6]=ht-jt;var Wt=.382683433*((Je=le+mt)-(ft=et+Ie)),Mt=.5411961*Je+Wt,dn=1.306562965*ft+Wt,on=.707106781*(ut=mt+et),Et=Ie+on,an=Ie-on;he[Ge+5]=an+Mt,he[Ge+3]=an-Mt,he[Ge+1]=Et+dn,he[Ge+7]=Et-dn,Ge+=8}for(Ge=0,We=0;We<8;++We){Te=he[Ge],Ce=he[Ge+8],Be=he[Ge+16],Ye=he[Ge+24],$e=he[Ge+32],ot=he[Ge+40],rt=he[Ge+48];var Mn=Te+(Ve=he[Ge+56]),At=Te-Ve,zt=Ce+rt,Zt=Ce-rt,$t=Be+ot,Ht=Be-ot,Lt=Ye+$e,dt=Ye-$e,at=Mn+Lt,Ot=Mn-Lt,Cn=zt+$t,Rn=zt-$t;he[Ge]=at+Cn,he[Ge+32]=at-Cn;var xn=.707106781*(Rn+Ot);he[Ge+16]=Ot+xn,he[Ge+48]=Ot-xn;var En=.382683433*((at=dt+Ht)-(Rn=Zt+At)),Hn=.5411961*at+En,Kn=1.306562965*Rn+En,Ti=.707106781*(Cn=Ht+Zt),ti=At+Ti,ai=At-Ti;he[Ge+40]=ai+Hn,he[Ge+24]=ai-Hn,he[Ge+8]=ti+Kn,he[Ge+56]=ti-Kn,Ge++}for(We=0;We<64;++We)De=he[We]*xe[We],A[We]=De>0?De+.5|0:De-.5|0;return A})(U,z),ye=0;ye<64;++ye)g[D[ye]]=fe[ye];var be=g[0]-q;q=g[0],be==0?P(G[0]):(P(G[f[H=32767+be]]),P(d[H]));for(var _e=63;_e>0&&g[_e]==0;)_e--;if(_e==0)return P(se),q;for(var W,Y=1;Y<=_e;){for(var ve=Y;g[Y]==0&&Y<=_e;)++Y;var ce=Y-ve;if(ce>=16){W=ce>>4;for(var ne=1;ne<=W;++ne)P(te);ce&=15}H=32767+g[Y],P(ie[(ce<<4)+f[H]]),P(d[H]),Y++}return _e!=63&&P(se),q}function Q(U){U=Math.min(Math.max(U,1),100),s!=U&&((function(z){for(var q=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],G=0;G<64;G++){var ie=o((q[G]*z+50)/100);ie=Math.min(Math.max(ie,1),255),a[D[G]]=ie}for(var H=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],se=0;se<64;se++){var te=o((H[se]*z+50)/100);te=Math.min(Math.max(te,1),255),c[D[se]]=te}for(var fe=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],ye=0,be=0;be<8;be++)for(var _e=0;_e<8;_e++)h[ye]=1/(a[D[ye]]*fe[be]*fe[_e]*8),u[ye]=1/(c[D[ye]]*fe[be]*fe[_e]*8),ye++})(U<50?Math.floor(5e3/U):Math.floor(200-2*U)),s=U)}this.encode=function(U,z){z&&Q(z),p=new Array,y=0,v=7,X(65496),X(65504),X(16),M(74),M(70),M(73),M(70),M(0),M(1),M(1),M(0),X(1),X(1),M(0),M(0),(function(){X(65499),X(132),M(0);for(var Ce=0;Ce<64;Ce++)M(a[Ce]);M(1);for(var Be=0;Be<64;Be++)M(c[Be])})(),(function(Ce,Be){X(65472),X(17),M(8),X(Be),X(Ce),M(3),M(1),M(17),M(0),M(2),M(17),M(1),M(3),M(17),M(1)})(U.width,U.height),(function(){X(65476),X(418),M(0);for(var Ce=0;Ce<16;Ce++)M(b[Ce+1]);for(var Be=0;Be<=11;Be++)M(_[Be]);M(16);for(var Ye=0;Ye<16;Ye++)M(I[Ye+1]);for(var $e=0;$e<=161;$e++)M(S[$e]);M(1);for(var ot=0;ot<16;ot++)M(F[ot+1]);for(var rt=0;rt<=11;rt++)M(B[rt]);M(17);for(var Ve=0;Ve<16;Ve++)M(E[Ve+1]);for(var We=0;We<=161;We++)M(V[We])})(),X(65498),X(12),M(3),M(1),M(0),M(2),M(17),M(3),M(17),M(0),M(63),M(0);var q=0,G=0,ie=0;y=0,v=7,this.encode.displayName="_encode_";for(var H,se,te,fe,ye,be,_e,W,Y,ve=U.data,ce=U.width,ne=U.height,he=4*ce,xe=0;xe<ne;){for(H=0;H<he;){for(ye=he*xe+H,_e=-1,W=0,Y=0;Y<64;Y++)be=ye+(W=Y>>3)*he+(_e=4*(7&Y)),xe+W>=ne&&(be-=he*(xe+1+W-ne)),H+_e>=he&&(be-=H+_e-he+4),se=ve[be++],te=ve[be++],fe=ve[be++],m[Y]=(j[se]+j[te+256|0]+j[fe+512|0]>>16)-128,w[Y]=(j[se+768|0]+j[te+1024|0]+j[fe+1280|0]>>16)-128,x[Y]=(j[se+1280|0]+j[te+1536|0]+j[fe+1792|0]>>16)-128;q=Z(m,h,q,e,i),G=Z(w,u,G,t,r),ie=Z(x,u,ie,t,r),H+=32}xe+=8}if(v>=0){var Te=[];Te[1]=v+1,Te[0]=(1<<v+1)-1,P(Te)}return X(65497),new Uint8Array(p)},n=n||50,(function(){for(var U=String.fromCharCode,z=0;z<256;z++)T[z]=U(z)})(),e=K(b,_),t=K(F,B),i=K(I,S),r=K(E,V),(function(){for(var U=1,z=2,q=1;q<=15;q++){for(var G=U;G<z;G++)f[32767+G]=q,d[32767+G]=[],d[32767+G][1]=q,d[32767+G][0]=G;for(var ie=-(z-1);ie<=-U;ie++)f[32767+ie]=q,d[32767+ie]=[],d[32767+ie][1]=q,d[32767+ie][0]=z-1+ie;U<<=1,z<<=1}})(),(function(){for(var U=0;U<256;U++)j[U]=19595*U,j[U+256|0]=38470*U,j[U+512|0]=7471*U+32768,j[U+768|0]=-11059*U,j[U+1024|0]=-21709*U,j[U+1280|0]=32768*U+8421375,j[U+1536|0]=-27439*U,j[U+1792|0]=-5329*U})(),Q(n)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function au(n,e){if(this.pos=0,this.buffer=n,this.datav=new DataView(n.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function XN(n){function e(_){if(!_)throw Error("assert :P")}function t(_,I,S){for(var F=0;4>F;F++)if(_[I+F]!=S.charCodeAt(F))return!0;return!1}function i(_,I,S,F,B){for(var E=0;E<B;E++)_[I+E]=S[F+E]}function r(_,I,S,F){for(var B=0;B<F;B++)_[I+B]=S}function s(_){return new Int32Array(_)}function o(_,I){for(var S=[],F=0;F<_;F++)S.push(new I);return S}function a(_,I){var S=[];return(function F(B,E,V){for(var K=V[E],P=0;P<K&&(B.push(V.length>E+1?[]:new I),!(V.length<E+1));P++)F(B[P],E+1,V)})(S,0,_),S}var c=function(){var _=this;function I(N,$){for(var oe=1<<$-1>>>0;N&oe;)oe>>>=1;return oe?(N&oe-1)+oe:N}function S(N,$,oe,de,Se){e(!(de%oe));do N[$+(de-=oe)]=Se;while(0<de)}function F(N,$,oe,de,Se){if(e(2328>=Se),512>=Se)var Ee=s(512);else if((Ee=s(Se))==null)return 0;return(function(Fe,Pe,Ue,Ze,yt,Ut){var Ke,St,Nt=Pe,cn=1<<Ue,It=s(16),gn=s(16);for(e(yt!=0),e(Ze!=null),e(Fe!=null),e(0<Ue),St=0;St<yt;++St){if(15<Ze[St])return 0;++It[Ze[St]]}if(It[0]==yt)return 0;for(gn[1]=0,Ke=1;15>Ke;++Ke){if(It[Ke]>1<<Ke)return 0;gn[Ke+1]=gn[Ke]+It[Ke]}for(St=0;St<yt;++St)Ke=Ze[St],0<Ze[St]&&(Ut[gn[Ke]++]=St);if(gn[15]==1)return(Ze=new B).g=0,Ze.value=Ut[0],S(Fe,Nt,1,cn,Ze),cn;var Tt,jn=-1,In=cn-1,Pi=0,Ci=1,lr=1,Si=1<<Ue;for(St=0,Ke=1,yt=2;Ke<=Ue;++Ke,yt<<=1){if(Ci+=lr<<=1,0>(lr-=It[Ke]))return 0;for(;0<It[Ke];--It[Ke])(Ze=new B).g=Ke,Ze.value=Ut[St++],S(Fe,Nt+Pi,yt,Si,Ze),Pi=I(Pi,Ke)}for(Ke=Ue+1,yt=2;15>=Ke;++Ke,yt<<=1){if(Ci+=lr<<=1,0>(lr-=It[Ke]))return 0;for(;0<It[Ke];--It[Ke]){if(Ze=new B,(Pi&In)!=jn){for(Nt+=Si,Tt=1<<(jn=Ke)-Ue;15>jn&&!(0>=(Tt-=It[jn]));)++jn,Tt<<=1;cn+=Si=1<<(Tt=jn-Ue),Fe[Pe+(jn=Pi&In)].g=Tt+Ue,Fe[Pe+jn].value=Nt-Pe-jn}Ze.g=Ke-Ue,Ze.value=Ut[St++],S(Fe,Nt+(Pi>>Ue),yt,Si,Ze),Pi=I(Pi,Ke)}}return Ci!=2*gn[15]-1?0:cn})(N,$,oe,de,Se,Ee)}function B(){this.value=this.g=0}function E(){this.value=this.g=0}function V(){this.G=o(5,B),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(ka,E)}function K(N,$,oe,de){e(N!=null),e($!=null),e(2147483648>de),N.Ca=254,N.I=0,N.b=-8,N.Ka=0,N.oa=$,N.pa=oe,N.Jd=$,N.Yc=oe+de,N.Zc=4<=de?oe+de-4+1:oe,se(N)}function P(N,$){for(var oe=0;0<$--;)oe|=fe(N,128)<<$;return oe}function M(N,$){var oe=P(N,$);return te(N)?-oe:oe}function X(N,$,oe,de){var Se,Ee=0;for(e(N!=null),e($!=null),e(4294967288>de),N.Sb=de,N.Ra=0,N.u=0,N.h=0,4<de&&(de=4),Se=0;Se<de;++Se)Ee+=$[oe+Se]<<8*Se;N.Ra=Ee,N.bb=de,N.oa=$,N.pa=oe}function Z(N){for(;8<=N.u&&N.bb<N.Sb;)N.Ra>>>=8,N.Ra+=N.oa[N.pa+N.bb]<<za-8>>>0,++N.bb,N.u-=8;G(N)&&(N.h=1,N.u=0)}function Q(N,$){if(e(0<=$),!N.h&&$<=NA){var oe=q(N)&gh[$];return N.u+=$,Z(N),oe}return N.h=1,N.u=0}function U(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function z(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function q(N){return N.Ra>>>(N.u&za-1)>>>0}function G(N){return e(N.bb<=N.Sb),N.h||N.bb==N.Sb&&N.u>za}function ie(N,$){N.u=$,N.h=G(N)}function H(N){N.u>=Ss&&(e(N.u>=Ss),Z(N))}function se(N){e(N!=null&&N.oa!=null),N.pa<N.Zc?(N.I=(N.oa[N.pa++]|N.I<<8)>>>0,N.b+=8):(e(N!=null&&N.oa!=null),N.pa<N.Yc?(N.b+=8,N.I=N.oa[N.pa++]|N.I<<8):N.Ka?N.b=0:(N.I<<=8,N.b+=8,N.Ka=1))}function te(N){return P(N,1)}function fe(N,$){var oe=N.Ca;0>N.b&&se(N);var de=N.b,Se=oe*$>>>8,Ee=(N.I>>>de>Se)+0;for(Ee?(oe-=Se,N.I-=Se+1<<de>>>0):oe=Se+1,de=oe,Se=0;256<=de;)Se+=8,de>>=8;return de=7^Se+LA[de],N.b-=de,N.Ca=(oe<<de)-1,Ee}function ye(N,$,oe){N[$+0]=oe>>24&255,N[$+1]=oe>>16&255,N[$+2]=oe>>8&255,N[$+3]=255&oe}function be(N,$){return N[$+0]|N[$+1]<<8}function _e(N,$){return be(N,$)|N[$+2]<<16}function W(N,$){return be(N,$)|be(N,$+2)<<16}function Y(N,$){var oe=1<<$;return e(N!=null),e(0<$),N.X=s(oe),N.X==null?0:(N.Mb=32-$,N.Xa=$,1)}function ve(N,$){e(N!=null),e($!=null),e(N.Xa==$.Xa),i($.X,0,N.X,0,1<<$.Xa)}function ce(){this.X=[],this.Xa=this.Mb=0}function ne(N,$,oe,de){e(oe!=null),e(de!=null);var Se=oe[0],Ee=de[0];return Se==0&&(Se=(N*Ee+$/2)/$),Ee==0&&(Ee=($*Se+N/2)/N),0>=Se||0>=Ee?0:(oe[0]=Se,de[0]=Ee,1)}function he(N,$){return N+(1<<$)-1>>>$}function xe(N,$){return((4278255360&N)+(4278255360&$)>>>0&4278255360)+((16711935&N)+(16711935&$)>>>0&16711935)>>>0}function Te(N,$){_[$]=function(oe,de,Se,Ee,Fe,Pe,Ue){var Ze;for(Ze=0;Ze<Fe;++Ze){var yt=_[N](Pe[Ue+Ze-1],Se,Ee+Ze);Pe[Ue+Ze]=xe(oe[de+Ze],yt)}}}function Ce(){this.ud=this.hd=this.jd=0}function Be(N,$){return((4278124286&(N^$))>>>1)+(N&$)>>>0}function Ye(N){return 0<=N&&256>N?N:0>N?0:255<N?255:void 0}function $e(N,$){return Ye(N+(N-$+.5>>1))}function ot(N,$,oe){return Math.abs($-oe)-Math.abs(N-oe)}function rt(N,$,oe,de,Se,Ee,Fe){for(de=Ee[Fe-1],oe=0;oe<Se;++oe)Ee[Fe+oe]=de=xe(N[$+oe],de)}function Ve(N,$,oe,de,Se){var Ee;for(Ee=0;Ee<oe;++Ee){var Fe=N[$+Ee],Pe=Fe>>8&255,Ue=16711935&(Ue=(Ue=16711935&Fe)+((Pe<<16)+Pe));de[Se+Ee]=(4278255360&Fe)+Ue>>>0}}function We(N,$){$.jd=255&N,$.hd=N>>8&255,$.ud=N>>16&255}function De(N,$,oe,de,Se,Ee){var Fe;for(Fe=0;Fe<de;++Fe){var Pe=$[oe+Fe],Ue=Pe>>>8,Ze=Pe,yt=255&(yt=(yt=Pe>>>16)+((N.jd<<24>>24)*(Ue<<24>>24)>>>5));Ze=255&(Ze=(Ze+=(N.hd<<24>>24)*(Ue<<24>>24)>>>5)+((N.ud<<24>>24)*(yt<<24>>24)>>>5)),Se[Ee+Fe]=(4278255360&Pe)+(yt<<16)+Ze}}function Ge(N,$,oe,de,Se){_[$]=function(Ee,Fe,Pe,Ue,Ze,yt,Ut,Ke,St){for(Ue=Ut;Ue<Ke;++Ue)for(Ut=0;Ut<St;++Ut)Ze[yt++]=Se(Pe[de(Ee[Fe++])])},_[N]=function(Ee,Fe,Pe,Ue,Ze,yt,Ut){var Ke=8>>Ee.b,St=Ee.Ea,Nt=Ee.K[0],cn=Ee.w;if(8>Ke)for(Ee=(1<<Ee.b)-1,cn=(1<<Ke)-1;Fe<Pe;++Fe){var It,gn=0;for(It=0;It<St;++It)It&Ee||(gn=de(Ue[Ze++])),yt[Ut++]=Se(Nt[gn&cn]),gn>>=Ke}else _["VP8LMapColor"+oe](Ue,Ze,Nt,cn,yt,Ut,Fe,Pe,St)}}function Re(N,$,oe,de,Se){for(oe=$+oe;$<oe;){var Ee=N[$++];de[Se++]=Ee>>16&255,de[Se++]=Ee>>8&255,de[Se++]=255&Ee}}function Ie(N,$,oe,de,Se){for(oe=$+oe;$<oe;){var Ee=N[$++];de[Se++]=Ee>>16&255,de[Se++]=Ee>>8&255,de[Se++]=255&Ee,de[Se++]=Ee>>24&255}}function Le(N,$,oe,de,Se){for(oe=$+oe;$<oe;){var Ee=(Fe=N[$++])>>16&240|Fe>>12&15,Fe=240&Fe|Fe>>28&15;de[Se++]=Ee,de[Se++]=Fe}}function et(N,$,oe,de,Se){for(oe=$+oe;$<oe;){var Ee=(Fe=N[$++])>>16&248|Fe>>13&7,Fe=Fe>>5&224|Fe>>3&31;de[Se++]=Ee,de[Se++]=Fe}}function ct(N,$,oe,de,Se){for(oe=$+oe;$<oe;){var Ee=N[$++];de[Se++]=255&Ee,de[Se++]=Ee>>8&255,de[Se++]=Ee>>16&255}}function mt(N,$,oe,de,Se,Ee){if(Ee==0)for(oe=$+oe;$<oe;)ye(de,((Ee=N[$++])[0]>>24|Ee[1]>>8&65280|Ee[2]<<8&16711680|Ee[3]<<24)>>>0),Se+=32;else i(de,Se,N,$,oe)}function je(N,$){_[$][0]=_[N+"0"],_[$][1]=_[N+"1"],_[$][2]=_[N+"2"],_[$][3]=_[N+"3"],_[$][4]=_[N+"4"],_[$][5]=_[N+"5"],_[$][6]=_[N+"6"],_[$][7]=_[N+"7"],_[$][8]=_[N+"8"],_[$][9]=_[N+"9"],_[$][10]=_[N+"10"],_[$][11]=_[N+"11"],_[$][12]=_[N+"12"],_[$][13]=_[N+"13"],_[$][14]=_[N+"0"],_[$][15]=_[N+"0"]}function le(N){return N==$g||N==hp||N==up||N==Vg}function Je(){this.eb=[],this.size=this.A=this.fb=0}function ht(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ut(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Je,this.f.kb=new ht,this.sd=null}function ft(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function jt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Wt(N){return alert("todo:WebPSamplerProcessPlane"),N.T}function Mt(N,$){var oe=N.T,de=$.ba.f.RGBA,Se=de.eb,Ee=de.fb+N.ka*de.A,Fe=sc[$.ba.S],Pe=N.y,Ue=N.O,Ze=N.f,yt=N.N,Ut=N.ea,Ke=N.W,St=$.cc,Nt=$.dc,cn=$.Mc,It=$.Nc,gn=N.ka,Tt=N.ka+N.T,jn=N.U,In=jn+1>>1;for(gn==0?Fe(Pe,Ue,null,null,Ze,yt,Ut,Ke,Ze,yt,Ut,Ke,Se,Ee,null,null,jn):(Fe($.ec,$.fc,Pe,Ue,St,Nt,cn,It,Ze,yt,Ut,Ke,Se,Ee-de.A,Se,Ee,jn),++oe);gn+2<Tt;gn+=2)St=Ze,Nt=yt,cn=Ut,It=Ke,yt+=N.Rc,Ke+=N.Rc,Ee+=2*de.A,Fe(Pe,(Ue+=2*N.fa)-N.fa,Pe,Ue,St,Nt,cn,It,Ze,yt,Ut,Ke,Se,Ee-de.A,Se,Ee,jn);return Ue+=N.fa,N.j+Tt<N.o?(i($.ec,$.fc,Pe,Ue,jn),i($.cc,$.dc,Ze,yt,In),i($.Mc,$.Nc,Ut,Ke,In),oe--):1&Tt||Fe(Pe,Ue,null,null,Ze,yt,Ut,Ke,Ze,yt,Ut,Ke,Se,Ee+de.A,null,null,jn),oe}function dn(N,$,oe){var de=N.F,Se=[N.J];if(de!=null){var Ee=N.U,Fe=$.ba.S,Pe=Fe==cp||Fe==up;$=$.ba.f.RGBA;var Ue=[0],Ze=N.ka;Ue[0]=N.T,N.Kb&&(Ze==0?--Ue[0]:(--Ze,Se[0]-=N.width),N.j+N.ka+N.T==N.o&&(Ue[0]=N.o-N.j-Ze));var yt=$.eb;Ze=$.fb+Ze*$.A,N=Hg(de,Se[0],N.width,Ee,Ue,yt,Ze+(Pe?0:3),$.A),e(oe==Ue),N&&le(Fe)&&Jh(yt,Ze,Pe,Ee,Ue,$.A)}return 0}function on(N){var $=N.ma,oe=$.ba.S,de=11>oe,Se=oe==jd||oe==OA||oe==cp||oe==Qg||oe==12||le(oe);if($.memory=null,$.Ib=null,$.Jb=null,$.Nd=null,!$a($.Oa,N,Se?11:12))return 0;if(Se&&le(oe)&&Wu(),N.da)alert("todo:use_scaling");else{if(de){if($.Ib=Wt,N.Kb){if(oe=N.U+1>>1,$.memory=s(N.U+2*oe),$.memory==null)return 0;$.ec=$.memory,$.fc=0,$.cc=$.ec,$.dc=$.fc+N.U,$.Mc=$.cc,$.Nc=$.dc+oe,$.Ib=Mt,Wu()}}else alert("todo:EmitYUV");Se&&($.Jb=dn,de&&Fo())}if(de&&!b1){for(N=0;256>N;++N)_1[N]=89858*(N-128)+fp>>Ap,C1[N]=-22014*(N-128)+fp,Dw[N]=-45773*(N-128),Fw[N]=113618*(N-128)+fp>>Ap;for(N=HA;N<Xg;++N)$=76283*(N-16)+fp>>Ap,S1[N-HA]=Mr($,255),jw[N-HA]=Mr($+8>>4,15);b1=1}return 1}function Et(N){var $=N.ma,oe=N.U,de=N.T;return e(!(1&N.ka)),0>=oe||0>=de?0:(oe=$.Ib(N,$),$.Jb!=null&&$.Jb(N,$,oe),$.Dc+=oe,1)}function an(N){N.ma.memory=null}function Mn(N,$,oe,de){return Q(N,8)!=47?0:($[0]=Q(N,14)+1,oe[0]=Q(N,14)+1,de[0]=Q(N,1),Q(N,3)!=0?0:!N.h)}function At(N,$){if(4>N)return N+1;var oe=N-2>>1;return(2+(1&N)<<oe)+Q($,oe)+1}function zt(N,$){return 120<$?$-120:1<=(oe=((oe=ww[$-1])>>4)*N+(8-(15&oe)))?oe:1;var oe}function Zt(N,$,oe){var de=q(oe),Se=N[$+=255&de].g-8;return 0<Se&&(ie(oe,oe.u+8),de=q(oe),$+=N[$].value,$+=de&(1<<Se)-1),ie(oe,oe.u+N[$].g),N[$].value}function $t(N,$,oe){return oe.g+=N.g,oe.value+=N.value<<$>>>0,e(8>=oe.g),N.g}function Ht(N,$,oe){var de=N.xc;return e(($=de==0?0:N.vc[N.md*(oe>>de)+($>>de)])<N.Wb),N.Ya[$]}function Lt(N,$,oe,de){var Se=N.ab,Ee=N.c*$,Fe=N.C;$=Fe+$;var Pe=oe,Ue=de;for(de=N.Ta,oe=N.Ua;0<Se--;){var Ze=N.gc[Se],yt=Fe,Ut=$,Ke=Pe,St=Ue,Nt=(Ue=de,Pe=oe,Ze.Ea);switch(e(yt<Ut),e(Ut<=Ze.nc),Ze.hc){case 2:Fd(Ke,St,(Ut-yt)*Nt,Ue,Pe);break;case 0:var cn=yt,It=Ut,gn=Ue,Tt=Pe,jn=(Si=Ze).Ea;cn==0&&(Vc(Ke,St,null,null,1,gn,Tt),rt(Ke,St+1,0,0,jn-1,gn,Tt+1),St+=jn,Tt+=jn,++cn);for(var In=1<<Si.b,Pi=In-1,Ci=he(jn,Si.b),lr=Si.K,Si=Si.w+(cn>>Si.b)*Ci;cn<It;){var Rr=lr,Ro=Si,yr=1;for(nc(Ke,St,gn,Tt-jn,1,gn,Tt);yr<jn;){var Ei=(yr&~Pi)+In;Ei>jn&&(Ei=jn),(0,Ga[Rr[Ro++]>>8&15])(Ke,St+ +yr,gn,Tt+yr-jn,Ei-yr,gn,Tt+yr),yr=Ei}St+=jn,Tt+=jn,++cn&Pi||(Si+=Ci)}Ut!=Ze.nc&&i(Ue,Pe-Nt,Ue,Pe+(Ut-yt-1)*Nt,Nt);break;case 1:for(Nt=Ke,It=St,jn=(Ke=Ze.Ea)-(Tt=Ke&~(gn=(St=1<<Ze.b)-1)),cn=he(Ke,Ze.b),In=Ze.K,Ze=Ze.w+(yt>>Ze.b)*cn;yt<Ut;){for(Pi=In,Ci=Ze,lr=new Ce,Si=It+Tt,Rr=It+Ke;It<Si;)We(Pi[Ci++],lr),zc(lr,Nt,It,St,Ue,Pe),It+=St,Pe+=St;It<Rr&&(We(Pi[Ci++],lr),zc(lr,Nt,It,jn,Ue,Pe),It+=jn,Pe+=jn),++yt&gn||(Ze+=cn)}break;case 3:if(Ke==Ue&&St==Pe&&0<Ze.b){for(It=Ue,Ke=Nt=Pe+(Ut-yt)*Nt-(Tt=(Ut-yt)*he(Ze.Ea,Ze.b)),St=Ue,gn=Pe,cn=[],Tt=(jn=Tt)-1;0<=Tt;--Tt)cn[Tt]=St[gn+Tt];for(Tt=jn-1;0<=Tt;--Tt)It[Ke+Tt]=cn[Tt];Zh(Ze,yt,Ut,Ue,Nt,Ue,Pe)}else Zh(Ze,yt,Ut,Ke,St,Ue,Pe)}Pe=de,Ue=oe}Ue!=oe&&i(de,oe,Pe,Ue,Ee)}function dt(N,$){var oe=N.V,de=N.Ba+N.c*N.C,Se=$-N.C;if(e($<=N.l.o),e(16>=Se),0<Se){var Ee=N.l,Fe=N.Ta,Pe=N.Ua,Ue=Ee.width;if(Lt(N,Se,oe,de),Se=Pe=[Pe],e((oe=N.C)<(de=$)),e(Ee.v<Ee.va),de>Ee.o&&(de=Ee.o),oe<Ee.j){var Ze=Ee.j-oe;oe=Ee.j,Se[0]+=Ze*Ue}if(oe>=de?oe=0:(Se[0]+=4*Ee.v,Ee.ka=oe-Ee.j,Ee.U=Ee.va-Ee.v,Ee.T=de-oe,oe=1),oe){if(Pe=Pe[0],11>(oe=N.ca).S){var yt=oe.f.RGBA,Ut=(de=oe.S,Se=Ee.U,Ee=Ee.T,Ze=yt.eb,yt.A),Ke=Ee;for(yt=yt.fb+N.Ma*yt.A;0<Ke--;){var St=Fe,Nt=Pe,cn=Se,It=Ze,gn=yt;switch(de){case Dd:yh(St,Nt,cn,It,gn);break;case jd:Ll(St,Nt,cn,It,gn);break;case $g:Ll(St,Nt,cn,It,gn),Jh(It,gn,0,cn,1,0);break;case p1:xs(St,Nt,cn,It,gn);break;case OA:mt(St,Nt,cn,It,gn,1);break;case hp:mt(St,Nt,cn,It,gn,1),Jh(It,gn,0,cn,1,0);break;case cp:mt(St,Nt,cn,It,gn,0);break;case up:mt(St,Nt,cn,It,gn,0),Jh(It,gn,1,cn,1,0);break;case Qg:Cc(St,Nt,cn,It,gn);break;case Vg:Cc(St,Nt,cn,It,gn),Ug(It,gn,cn,1,0);break;case g1:er(St,Nt,cn,It,gn);break;default:e(0)}Pe+=Ue,yt+=Ut}N.Ma+=Ee}else alert("todo:EmitRescaledRowsYUVA");e(N.Ma<=oe.height)}}N.C=$,e(N.C<=N.i)}function at(N){var $;if(0<N.ua)return 0;for($=0;$<N.Wb;++$){var oe=N.Ya[$].G,de=N.Ya[$].H;if(0<oe[1][de[1]+0].g||0<oe[2][de[2]+0].g||0<oe[3][de[3]+0].g)return 0}return 1}function Ot(N,$,oe,de,Se,Ee){if(N.Z!=0){var Fe=N.qd,Pe=N.rd;for(e(eu[N.Z]!=null);$<oe;++$)eu[N.Z](Fe,Pe,de,Se,de,Se,Ee),Fe=de,Pe=Se,Se+=Ee;N.qd=Fe,N.rd=Pe}}function Cn(N,$){var oe=N.l.ma,de=oe.Z==0||oe.Z==1?N.l.j:N.C;if(de=N.C<de?de:N.C,e($<=N.l.o),$>de){var Se=N.l.width,Ee=oe.ca,Fe=oe.tb+Se*de,Pe=N.V,Ue=N.Ba+N.c*de,Ze=N.gc;e(N.ab==1),e(Ze[0].hc==3),mh(Ze[0],de,$,Pe,Ue,Ee,Fe),Ot(oe,de,$,Ee,Fe,Se)}N.C=N.Ma=$}function Rn(N,$,oe,de,Se,Ee,Fe){var Pe=N.$/de,Ue=N.$%de,Ze=N.m,yt=N.s,Ut=oe+N.$,Ke=Ut;Se=oe+de*Se;var St=oe+de*Ee,Nt=280+yt.ua,cn=N.Pb?Pe:16777216,It=0<yt.ua?yt.Wa:null,gn=yt.wc,Tt=Ut<St?Ht(yt,Ue,Pe):null;e(N.C<Ee),e(St<=Se);var jn=!1;e:for(;;){for(;jn||Ut<St;){var In=0;if(Pe>=cn){var Pi=Ut-oe;e((cn=N).Pb),cn.wd=cn.m,cn.xd=Pi,0<cn.s.ua&&ve(cn.s.Wa,cn.s.vb),cn=Pe+bw}if(Ue&gn||(Tt=Ht(yt,Ue,Pe)),e(Tt!=null),Tt.Qb&&($[Ut]=Tt.qb,jn=!0),!jn)if(H(Ze),Tt.jc){In=Ze,Pi=$;var Ci=Ut,lr=Tt.pd[q(In)&ka-1];e(Tt.jc),256>lr.g?(ie(In,In.u+lr.g),Pi[Ci]=lr.value,In=0):(ie(In,In.u+lr.g-256),e(256<=lr.value),In=lr.value),In==0&&(jn=!0)}else In=Zt(Tt.G[0],Tt.H[0],Ze);if(Ze.h)break;if(jn||256>In){if(!jn)if(Tt.nd)$[Ut]=(Tt.qb|In<<8)>>>0;else{if(H(Ze),jn=Zt(Tt.G[1],Tt.H[1],Ze),H(Ze),Pi=Zt(Tt.G[2],Tt.H[2],Ze),Ci=Zt(Tt.G[3],Tt.H[3],Ze),Ze.h)break;$[Ut]=(Ci<<24|jn<<16|In<<8|Pi)>>>0}if(jn=!1,++Ut,++Ue>=de&&(Ue=0,++Pe,Fe!=null&&Pe<=Ee&&!(Pe%16)&&Fe(N,Pe),It!=null))for(;Ke<Ut;)In=$[Ke++],It.X[(506832829*In&4294967295)>>>It.Mb]=In}else if(280>In){if(In=At(In-256,Ze),Pi=Zt(Tt.G[4],Tt.H[4],Ze),H(Ze),Pi=zt(de,Pi=At(Pi,Ze)),Ze.h)break;if(Ut-oe<Pi||Se-Ut<In)break e;for(Ci=0;Ci<In;++Ci)$[Ut+Ci]=$[Ut+Ci-Pi];for(Ut+=In,Ue+=In;Ue>=de;)Ue-=de,++Pe,Fe!=null&&Pe<=Ee&&!(Pe%16)&&Fe(N,Pe);if(e(Ut<=Se),Ue&gn&&(Tt=Ht(yt,Ue,Pe)),It!=null)for(;Ke<Ut;)In=$[Ke++],It.X[(506832829*In&4294967295)>>>It.Mb]=In}else{if(!(In<Nt))break e;for(jn=In-280,e(It!=null);Ke<Ut;)In=$[Ke++],It.X[(506832829*In&4294967295)>>>It.Mb]=In;In=Ut,e(!(jn>>>(Pi=It).Xa)),$[In]=Pi.X[jn],jn=!0}jn||e(Ze.h==G(Ze))}if(N.Pb&&Ze.h&&Ut<Se)e(N.m.h),N.a=5,N.m=N.wd,N.$=N.xd,0<N.s.ua&&ve(N.s.vb,N.s.Wa);else{if(Ze.h)break e;Fe!=null&&Fe(N,Pe>Ee?Ee:Pe),N.a=0,N.$=Ut-oe}return 1}return N.a=3,0}function xn(N){e(N!=null),N.vc=null,N.yc=null,N.Ya=null;var $=N.Wa;$!=null&&($.X=null),N.vb=null,e(N!=null)}function En(){var N=new Hr;return N==null?null:(N.a=0,N.xb=Tw,je("Predictor","VP8LPredictors"),je("Predictor","VP8LPredictors_C"),je("PredictorAdd","VP8LPredictorsAdd"),je("PredictorAdd","VP8LPredictorsAdd_C"),Fd=Ve,zc=De,yh=Re,Ll=Ie,Cc=Le,er=et,xs=ct,_.VP8LMapColor32b=Ia,_.VP8LMapColor8b=_c,N)}function Hn(N,$,oe,de,Se){var Ee=1,Fe=[N],Pe=[$],Ue=de.m,Ze=de.s,yt=null,Ut=0;e:for(;;){if(oe)for(;Ee&&Q(Ue,1);){var Ke=Fe,St=Pe,Nt=de,cn=1,It=Nt.m,gn=Nt.gc[Nt.ab],Tt=Q(It,2);if(Nt.Oc&1<<Tt)Ee=0;else{switch(Nt.Oc|=1<<Tt,gn.hc=Tt,gn.Ea=Ke[0],gn.nc=St[0],gn.K=[null],++Nt.ab,e(4>=Nt.ab),Tt){case 0:case 1:gn.b=Q(It,3)+2,cn=Hn(he(gn.Ea,gn.b),he(gn.nc,gn.b),0,Nt,gn.K),gn.K=gn.K[0];break;case 3:var jn,In=Q(It,8)+1,Pi=16<In?0:4<In?1:2<In?2:3;if(Ke[0]=he(gn.Ea,Pi),gn.b=Pi,jn=cn=Hn(In,1,0,Nt,gn.K)){var Ci,lr=In,Si=gn,Rr=1<<(8>>Si.b),Ro=s(Rr);if(Ro==null)jn=0;else{var yr=Si.K[0],Ei=Si.w;for(Ro[0]=Si.K[0][0],Ci=1;Ci<1*lr;++Ci)Ro[Ci]=xe(yr[Ei+Ci],Ro[Ci-1]);for(;Ci<4*Rr;++Ci)Ro[Ci]=0;Si.K[0]=null,Si.K[0]=Ro,jn=1}}cn=jn;break;case 2:break;default:e(0)}Ee=cn}}if(Fe=Fe[0],Pe=Pe[0],Ee&&Q(Ue,1)&&!(Ee=1<=(Ut=Q(Ue,4))&&11>=Ut)){de.a=3;break e}var Zn;if(Zn=Ee)t:{var uo,Ni,dr,Gr=de,ea=Fe,Ya=Pe,rs=Ut,ja=oe,to=Gr.m,ta=Gr.s,Xr=[null],ps=1,Ao=0,gs=xw[rs];n:for(;;){if(ja&&Q(to,1)){var Oo=Q(to,3)+2,Ml=he(ea,Oo),no=he(Ya,Oo),Pa=Ml*no;if(!Hn(Ml,no,0,Gr,Xr))break n;for(Xr=Xr[0],ta.xc=Oo,uo=0;uo<Pa;++uo){var ms=Xr[uo]>>8&65535;Xr[uo]=ms,ms>=ps&&(ps=ms+1)}}if(to.h)break n;for(Ni=0;5>Ni;++Ni){var fo=m1[Ni];!Ni&&0<rs&&(fo+=1<<rs),Ao<fo&&(Ao=fo)}var gl=o(ps*gs,B),Na=ps,ml=o(Na,V);if(ml==null)var Rl=null;else e(65536>=Na),Rl=ml;var Za=s(Ao);if(Rl==null||Za==null||gl==null){Gr.a=1;break n}var oc=gl;for(uo=dr=0;uo<ps;++uo){var bs=Rl[uo],yl=bs.G,hs=bs.H,Ar=0,Ms=1,Wr=0;for(Ni=0;5>Ni;++Ni){fo=m1[Ni],yl[Ni]=oc,hs[Ni]=dr,!Ni&&0<rs&&(fo+=1<<rs);r:{var Uo,vl=fo,tu=Gr,po=Za,pp=oc,Nd=dr,WA=0,wh=tu.m,gp=Q(wh,1);if(r(po,0,0,vl),gp){var Ol=Q(wh,1)+1,T1=Q(wh,1),Yg=Q(wh,T1==0?1:8);po[Yg]=1,Ol==2&&(po[Yg=Q(wh,8)]=1);var Tc=1}else{var Ld=s(19),mp=Q(wh,4)+4;if(19<mp){tu.a=3;var QA=0;break r}for(Uo=0;Uo<mp;++Uo)Ld[xS[Uo]]=Q(wh,3);var xh=void 0,$u=void 0,nu=tu,Zg=Ld,Vu=vl,Jg=po,$A=0,qc=nu.m,La=8,iu=o(128,B);i:for(;F(iu,0,7,Zg,19);){if(Q(qc,1)){var Bc=2+2*Q(qc,3);if((xh=2+Q(qc,Bc))>Vu)break i}else xh=Vu;for($u=0;$u<Vu&&xh--;){H(qc);var wl=iu[0+(127&q(qc))];ie(qc,qc.u+wl.g);var Md=wl.value;if(16>Md)Jg[$u++]=Md,Md!=0&&(La=Md);else{var B1=Md==16,e0=Md-16,CS=vS[e0],ru=Q(qc,vw[e0])+CS;if($u+ru>Vu)break i;for(var Nw=B1?La:0;0<ru--;)Jg[$u++]=Nw}}$A=1;break i}$A||(nu.a=3),Tc=$A}(Tc=Tc&&!wh.h)&&(WA=F(pp,Nd,8,po,vl)),Tc&&WA!=0?QA=WA:(tu.a=3,QA=0)}if(QA==0)break n;if(Ms&&wS[Ni]==1&&(Ms=oc[dr].g==0),Ar+=oc[dr].g,dr+=QA,3>=Ni){var VA,yp=Za[0];for(VA=1;VA<fo;++VA)Za[VA]>yp&&(yp=Za[VA]);Wr+=yp}}if(bs.nd=Ms,bs.Qb=0,Ms&&(bs.qb=(yl[3][hs[3]+0].value<<24|yl[1][hs[1]+0].value<<16|yl[2][hs[2]+0].value)>>>0,Ar==0&&256>yl[0][hs[0]+0].value&&(bs.Qb=1,bs.qb+=yl[0][hs[0]+0].value<<8)),bs.jc=!bs.Qb&&6>Wr,bs.jc){var bh,_h=bs;for(bh=0;bh<ka;++bh){var su=bh,Ch=_h.pd[su],Rd=_h.G[0][_h.H[0]+su];256<=Rd.value?(Ch.g=Rd.g+256,Ch.value=Rd.value):(Ch.g=0,Ch.value=0,su>>=$t(Rd,8,Ch),su>>=$t(_h.G[1][_h.H[1]+su],16,Ch),su>>=$t(_h.G[2][_h.H[2]+su],0,Ch),$t(_h.G[3][_h.H[3]+su],24,Ch))}}}ta.vc=Xr,ta.Wb=ps,ta.Ya=Rl,ta.yc=gl,Zn=1;break t}Zn=0}if(!(Ee=Zn)){de.a=3;break e}if(0<Ut){if(Ze.ua=1<<Ut,!Y(Ze.Wa,Ut)){de.a=1,Ee=0;break e}}else Ze.ua=0;var E1=de,Lw=Fe,Mw=Pe,t0=E1.s,ou=t0.xc;if(E1.c=Lw,E1.i=Mw,t0.md=he(Lw,ou),t0.wc=ou==0?-1:(1<<ou)-1,oe){de.xb=v1;break e}if((yt=s(Fe*Pe))==null){de.a=1,Ee=0;break e}Ee=(Ee=Rn(de,yt,0,Fe,Pe,Pe,null))&&!Ue.h;break e}return Ee?(Se!=null?Se[0]=yt:(e(yt==null),e(oe)),de.$=0,oe||xn(Ze)):xn(Ze),Ee}function Kn(N,$){var oe=N.c*N.i,de=oe+$+16*$;return e(N.c<=$),N.V=s(de),N.V==null?(N.Ta=null,N.Ua=0,N.a=1,0):(N.Ta=N.V,N.Ua=N.Ba+oe+$,1)}function Ti(N,$){var oe=N.C,de=$-oe,Se=N.V,Ee=N.Ba+N.c*oe;for(e($<=N.l.o);0<de;){var Fe=16<de?16:de,Pe=N.l.ma,Ue=N.l.width,Ze=Ue*Fe,yt=Pe.ca,Ut=Pe.tb+Ue*oe,Ke=N.Ta,St=N.Ua;Lt(N,Fe,Se,Ee),c1(Ke,St,yt,Ut,Ze),Ot(Pe,oe,oe+Fe,yt,Ut,Ue),de-=Fe,Se+=Fe*N.c,oe+=Fe}e(oe==$),N.C=N.Ma=$}function ti(){this.ub=this.yd=this.td=this.Rb=0}function ai(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Gi(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function fi(){this.Yb=(function(){var N=[];return(function $(oe,de,Se){for(var Ee=Se[de],Fe=0;Fe<Ee&&(oe.push(Se.length>de+1?[]:0),!(Se.length<de+1));Fe++)$(oe[Fe],de+1,Se)})(N,0,[3,11]),N})()}function Oi(){this.jb=s(3),this.Wc=a([4,8],fi),this.Xc=a([4,17],fi)}function rn(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function $n(){this.ld=this.La=this.dd=this.tc=0}function Fn(){this.Na=this.la=0}function pt(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function vt(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function kt(){this.uc=this.M=this.Nb=0,this.wa=Array(new $n),this.Y=0,this.ya=Array(new vt),this.aa=0,this.l=new bn}function mn(){this.y=s(16),this.f=s(8),this.ea=s(8)}function sn(){this.cb=this.a=0,this.sc="",this.m=new U,this.Od=new ti,this.Kc=new ai,this.ed=new rn,this.Qa=new Gi,this.Ic=this.$c=this.Aa=0,this.D=new kt,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,U),this.ia=0,this.pb=o(4,pt),this.Pa=new Oi,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new mn),this.Hd=0,this.rb=Array(new Fn),this.sb=0,this.wa=Array(new $n),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new vt),this.L=this.aa=0,this.gd=a([4,2],$n),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function bn(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Li(){var N=new sn;return N!=null&&(N.a=0,N.sc="OK",N.cb=0,N.Xb=0,dp||(dp=Gn)),N}function Wn(N,$,oe){return N.a==0&&(N.a=$,N.sc=oe,N.cb=0),0}function ui(N,$,oe){return 3<=oe&&N[$+0]==157&&N[$+1]==1&&N[$+2]==42}function Mi(N,$){if(N==null)return 0;if(N.a=0,N.sc="OK",$==null)return Wn(N,2,"null VP8Io passed to VP8GetHeaders()");var oe=$.data,de=$.w,Se=$.ha;if(4>Se)return Wn(N,7,"Truncated header.");var Ee=oe[de+0]|oe[de+1]<<8|oe[de+2]<<16,Fe=N.Od;if(Fe.Rb=!(1&Ee),Fe.td=Ee>>1&7,Fe.yd=Ee>>4&1,Fe.ub=Ee>>5,3<Fe.td)return Wn(N,3,"Incorrect keyframe parameters.");if(!Fe.yd)return Wn(N,4,"Frame not displayable.");de+=3,Se-=3;var Pe=N.Kc;if(Fe.Rb){if(7>Se)return Wn(N,7,"cannot parse picture header");if(!ui(oe,de,Se))return Wn(N,3,"Bad code word");Pe.c=16383&(oe[de+4]<<8|oe[de+3]),Pe.Td=oe[de+4]>>6,Pe.i=16383&(oe[de+6]<<8|oe[de+5]),Pe.Ud=oe[de+6]>>6,de+=7,Se-=7,N.za=Pe.c+15>>4,N.Ub=Pe.i+15>>4,$.width=Pe.c,$.height=Pe.i,$.Da=0,$.j=0,$.v=0,$.va=$.width,$.o=$.height,$.da=0,$.ib=$.width,$.hb=$.height,$.U=$.width,$.T=$.height,r((Ee=N.Pa).jb,0,255,Ee.jb.length),e((Ee=N.Qa)!=null),Ee.Cb=0,Ee.Bb=0,Ee.Fb=1,r(Ee.Zb,0,0,Ee.Zb.length),r(Ee.Lb,0,0,Ee.Lb)}if(Fe.ub>Se)return Wn(N,7,"bad partition length");K(Ee=N.m,oe,de,Fe.ub),de+=Fe.ub,Se-=Fe.ub,Fe.Rb&&(Pe.Ld=te(Ee),Pe.Kd=te(Ee)),Pe=N.Qa;var Ue,Ze=N.Pa;if(e(Ee!=null),e(Pe!=null),Pe.Cb=te(Ee),Pe.Cb){if(Pe.Bb=te(Ee),te(Ee)){for(Pe.Fb=te(Ee),Ue=0;4>Ue;++Ue)Pe.Zb[Ue]=te(Ee)?M(Ee,7):0;for(Ue=0;4>Ue;++Ue)Pe.Lb[Ue]=te(Ee)?M(Ee,6):0}if(Pe.Bb)for(Ue=0;3>Ue;++Ue)Ze.jb[Ue]=te(Ee)?P(Ee,8):255}else Pe.Bb=0;if(Ee.Ka)return Wn(N,3,"cannot parse segment header");if((Pe=N.ed).zd=te(Ee),Pe.Tb=P(Ee,6),Pe.wb=P(Ee,3),Pe.Pc=te(Ee),Pe.Pc&&te(Ee)){for(Ze=0;4>Ze;++Ze)te(Ee)&&(Pe.vd[Ze]=M(Ee,6));for(Ze=0;4>Ze;++Ze)te(Ee)&&(Pe.od[Ze]=M(Ee,6))}if(N.L=Pe.Tb==0?0:Pe.zd?1:2,Ee.Ka)return Wn(N,3,"cannot parse filter header");var yt=Se;if(Se=Ue=de,de=Ue+yt,Pe=yt,N.Xb=(1<<P(N.m,2))-1,yt<3*(Ze=N.Xb))oe=7;else{for(Ue+=3*Ze,Pe-=3*Ze,yt=0;yt<Ze;++yt){var Ut=oe[Se+0]|oe[Se+1]<<8|oe[Se+2]<<16;Ut>Pe&&(Ut=Pe),K(N.Jc[+yt],oe,Ue,Ut),Ue+=Ut,Pe-=Ut,Se+=3}K(N.Jc[+Ze],oe,Ue,Pe),oe=Ue<de?0:5}if(oe!=0)return Wn(N,oe,"cannot parse partitions");for(oe=P(Ue=N.m,7),Se=te(Ue)?M(Ue,4):0,de=te(Ue)?M(Ue,4):0,Pe=te(Ue)?M(Ue,4):0,Ze=te(Ue)?M(Ue,4):0,Ue=te(Ue)?M(Ue,4):0,yt=N.Qa,Ut=0;4>Ut;++Ut){if(yt.Cb){var Ke=yt.Zb[Ut];yt.Fb||(Ke+=oe)}else{if(0<Ut){N.pb[Ut]=N.pb[0];continue}Ke=oe}var St=N.pb[Ut];St.Sc[0]=UA[Mr(Ke+Se,127)],St.Sc[1]=y1[Mr(Ke+0,127)],St.Eb[0]=2*UA[Mr(Ke+de,127)],St.Eb[1]=101581*y1[Mr(Ke+Pe,127)]>>16,8>St.Eb[1]&&(St.Eb[1]=8),St.Qc[0]=UA[Mr(Ke+Ze,117)],St.Qc[1]=y1[Mr(Ke+Ue,127)],St.lc=Ke+Ue}if(!Fe.Rb)return Wn(N,4,"Not a key frame.");for(te(Ee),Fe=N.Pa,oe=0;4>oe;++oe){for(Se=0;8>Se;++Se)for(de=0;3>de;++de)for(Pe=0;11>Pe;++Pe)Ze=fe(Ee,Cw[oe][Se][de][Pe])?P(Ee,8):Gg[oe][Se][de][Pe],Fe.Wc[oe][Se].Yb[de][Pe]=Ze;for(Se=0;17>Se;++Se)Fe.Xc[oe][Se]=Fe.Wc[oe][Sw[Se]]}return N.kc=te(Ee),N.kc&&(N.Bd=P(Ee,8)),N.cb=1}function Gn(N,$,oe,de,Se,Ee,Fe){var Pe=$[Se].Yb[oe];for(oe=0;16>Se;++Se){if(!fe(N,Pe[oe+0]))return Se;for(;!fe(N,Pe[oe+1]);)if(Pe=$[++Se].Yb[0],oe=0,Se==16)return 16;var Ue=$[Se+1].Yb;if(fe(N,Pe[oe+2])){var Ze=N,yt=0;if(fe(Ze,(Ke=Pe)[(Ut=oe)+3]))if(fe(Ze,Ke[Ut+6])){for(Pe=0,Ut=2*(yt=fe(Ze,Ke[Ut+8]))+(Ke=fe(Ze,Ke[Ut+9+yt])),yt=0,Ke=bS[Ut];Ke[Pe];++Pe)yt+=yt+fe(Ze,Ke[Pe]);yt+=3+(8<<Ut)}else fe(Ze,Ke[Ut+7])?(yt=7+2*fe(Ze,165),yt+=fe(Ze,145)):yt=5+fe(Ze,159);else yt=fe(Ze,Ke[Ut+4])?3+fe(Ze,Ke[Ut+5]):2;Pe=Ue[2]}else yt=1,Pe=Ue[1];Ue=Fe+Xc[Se],0>(Ze=N).b&&se(Ze);var Ut,Ke=Ze.b,St=(Ut=Ze.Ca>>1)-(Ze.I>>Ke)>>31;--Ze.b,Ze.Ca+=St,Ze.Ca|=1,Ze.I-=(Ut+1&St)<<Ke,Ee[Ue]=((yt^St)-St)*de[(0<Se)+0]}return 16}function Dn(N){var $=N.rb[N.sb-1];$.la=0,$.Na=0,r(N.zc,0,0,N.zc.length),N.ja=0}function li(N,$,oe,de,Se){Se=N[$+oe+32*de]+(Se>>3),N[$+oe+32*de]=-256&Se?0>Se?0:255:Se}function en(N,$,oe,de,Se,Ee){li(N,$,0,oe,de+Se),li(N,$,1,oe,de+Ee),li(N,$,2,oe,de-Ee),li(N,$,3,oe,de-Se)}function Rt(N){return(20091*N>>16)+N}function Xn(N,$,oe,de){var Se,Ee=0,Fe=s(16);for(Se=0;4>Se;++Se){var Pe=N[$+0]+N[$+8],Ue=N[$+0]-N[$+8],Ze=(35468*N[$+4]>>16)-Rt(N[$+12]),yt=Rt(N[$+4])+(35468*N[$+12]>>16);Fe[Ee+0]=Pe+yt,Fe[Ee+1]=Ue+Ze,Fe[Ee+2]=Ue-Ze,Fe[Ee+3]=Pe-yt,Ee+=4,$++}for(Se=Ee=0;4>Se;++Se)Pe=(N=Fe[Ee+0]+4)+Fe[Ee+8],Ue=N-Fe[Ee+8],Ze=(35468*Fe[Ee+4]>>16)-Rt(Fe[Ee+12]),li(oe,de,0,0,Pe+(yt=Rt(Fe[Ee+4])+(35468*Fe[Ee+12]>>16))),li(oe,de,1,0,Ue+Ze),li(oe,de,2,0,Ue-Ze),li(oe,de,3,0,Pe-yt),Ee++,de+=32}function Ui(N,$,oe,de){var Se=N[$+0]+4,Ee=35468*N[$+4]>>16,Fe=Rt(N[$+4]),Pe=35468*N[$+1]>>16;en(oe,de,0,Se+Fe,N=Rt(N[$+1]),Pe),en(oe,de,1,Se+Ee,N,Pe),en(oe,de,2,Se-Ee,N,Pe),en(oe,de,3,Se-Fe,N,Pe)}function tt(N,$,oe,de,Se){Xn(N,$,oe,de),Se&&Xn(N,$+16,oe,de+4)}function Jt(N,$,oe,de){ho(N,$+0,oe,de,1),ho(N,$+32,oe,de+128,1)}function wn(N,$,oe,de){var Se;for(N=N[$+0]+4,Se=0;4>Se;++Se)for($=0;4>$;++$)li(oe,de,$,Se,N)}function Yn(N,$,oe,de){N[$+0]&&Xa(N,$+0,oe,de),N[$+16]&&Xa(N,$+16,oe,de+4),N[$+32]&&Xa(N,$+32,oe,de+128),N[$+48]&&Xa(N,$+48,oe,de+128+4)}function hi(N,$,oe,de){var Se,Ee=s(16);for(Se=0;4>Se;++Se){var Fe=N[$+0+Se]+N[$+12+Se],Pe=N[$+4+Se]+N[$+8+Se],Ue=N[$+4+Se]-N[$+8+Se],Ze=N[$+0+Se]-N[$+12+Se];Ee[0+Se]=Fe+Pe,Ee[8+Se]=Fe-Pe,Ee[4+Se]=Ze+Ue,Ee[12+Se]=Ze-Ue}for(Se=0;4>Se;++Se)Fe=(N=Ee[0+4*Se]+3)+Ee[3+4*Se],Pe=Ee[1+4*Se]+Ee[2+4*Se],Ue=Ee[1+4*Se]-Ee[2+4*Se],Ze=N-Ee[3+4*Se],oe[de+0]=Fe+Pe>>3,oe[de+16]=Ze+Ue>>3,oe[de+32]=Fe-Pe>>3,oe[de+48]=Ze-Ue>>3,de+=64}function Xt(N,$,oe){var de,Se=$-32,Ee=Da,Fe=255-N[Se-1];for(de=0;de<oe;++de){var Pe,Ue=Ee,Ze=Fe+N[$-1];for(Pe=0;Pe<oe;++Pe)N[$+Pe]=Ue[Ze+N[Se+Pe]];$+=32}}function _i(N,$){Xt(N,$,4)}function Pr(N,$){Xt(N,$,8)}function ws(N,$){Xt(N,$,16)}function Vi(N,$){var oe;for(oe=0;16>oe;++oe)i(N,$+32*oe,N,$-32,16)}function br(N,$){var oe;for(oe=16;0<oe;--oe)r(N,$,N[$-1],16),$+=32}function _r(N,$,oe){var de;for(de=0;16>de;++de)r($,oe+32*de,N,16)}function Qr(N,$){var oe,de=16;for(oe=0;16>oe;++oe)de+=N[$-1+32*oe]+N[$+oe-32];_r(de>>5,N,$)}function ue(N,$){var oe,de=8;for(oe=0;16>oe;++oe)de+=N[$-1+32*oe];_r(de>>4,N,$)}function ke(N,$){var oe,de=8;for(oe=0;16>oe;++oe)de+=N[$+oe-32];_r(de>>4,N,$)}function Me(N,$){_r(128,N,$)}function Oe(N,$,oe){return N+2*$+oe+2>>2}function nt(N,$){var oe,de=$-32;for(de=new Uint8Array([Oe(N[de-1],N[de+0],N[de+1]),Oe(N[de+0],N[de+1],N[de+2]),Oe(N[de+1],N[de+2],N[de+3]),Oe(N[de+2],N[de+3],N[de+4])]),oe=0;4>oe;++oe)i(N,$+32*oe,de,0,de.length)}function gt(N,$){var oe=N[$-1],de=N[$-1+32],Se=N[$-1+64],Ee=N[$-1+96];ye(N,$+0,16843009*Oe(N[$-1-32],oe,de)),ye(N,$+32,16843009*Oe(oe,de,Se)),ye(N,$+64,16843009*Oe(de,Se,Ee)),ye(N,$+96,16843009*Oe(Se,Ee,Ee))}function Ae(N,$){var oe,de=4;for(oe=0;4>oe;++oe)de+=N[$+oe-32]+N[$-1+32*oe];for(de>>=3,oe=0;4>oe;++oe)r(N,$+32*oe,de,4)}function me(N,$){var oe=N[$-1+0],de=N[$-1+32],Se=N[$-1+64],Ee=N[$-1-32],Fe=N[$+0-32],Pe=N[$+1-32],Ue=N[$+2-32],Ze=N[$+3-32];N[$+0+96]=Oe(de,Se,N[$-1+96]),N[$+1+96]=N[$+0+64]=Oe(oe,de,Se),N[$+2+96]=N[$+1+64]=N[$+0+32]=Oe(Ee,oe,de),N[$+3+96]=N[$+2+64]=N[$+1+32]=N[$+0+0]=Oe(Fe,Ee,oe),N[$+3+64]=N[$+2+32]=N[$+1+0]=Oe(Pe,Fe,Ee),N[$+3+32]=N[$+2+0]=Oe(Ue,Pe,Fe),N[$+3+0]=Oe(Ze,Ue,Pe)}function Xe(N,$){var oe=N[$+1-32],de=N[$+2-32],Se=N[$+3-32],Ee=N[$+4-32],Fe=N[$+5-32],Pe=N[$+6-32],Ue=N[$+7-32];N[$+0+0]=Oe(N[$+0-32],oe,de),N[$+1+0]=N[$+0+32]=Oe(oe,de,Se),N[$+2+0]=N[$+1+32]=N[$+0+64]=Oe(de,Se,Ee),N[$+3+0]=N[$+2+32]=N[$+1+64]=N[$+0+96]=Oe(Se,Ee,Fe),N[$+3+32]=N[$+2+64]=N[$+1+96]=Oe(Ee,Fe,Pe),N[$+3+64]=N[$+2+96]=Oe(Fe,Pe,Ue),N[$+3+96]=Oe(Pe,Ue,Ue)}function qe(N,$){var oe=N[$-1+0],de=N[$-1+32],Se=N[$-1+64],Ee=N[$-1-32],Fe=N[$+0-32],Pe=N[$+1-32],Ue=N[$+2-32],Ze=N[$+3-32];N[$+0+0]=N[$+1+64]=Ee+Fe+1>>1,N[$+1+0]=N[$+2+64]=Fe+Pe+1>>1,N[$+2+0]=N[$+3+64]=Pe+Ue+1>>1,N[$+3+0]=Ue+Ze+1>>1,N[$+0+96]=Oe(Se,de,oe),N[$+0+64]=Oe(de,oe,Ee),N[$+0+32]=N[$+1+96]=Oe(oe,Ee,Fe),N[$+1+32]=N[$+2+96]=Oe(Ee,Fe,Pe),N[$+2+32]=N[$+3+96]=Oe(Fe,Pe,Ue),N[$+3+32]=Oe(Pe,Ue,Ze)}function nn(N,$){var oe=N[$+0-32],de=N[$+1-32],Se=N[$+2-32],Ee=N[$+3-32],Fe=N[$+4-32],Pe=N[$+5-32],Ue=N[$+6-32],Ze=N[$+7-32];N[$+0+0]=oe+de+1>>1,N[$+1+0]=N[$+0+64]=de+Se+1>>1,N[$+2+0]=N[$+1+64]=Se+Ee+1>>1,N[$+3+0]=N[$+2+64]=Ee+Fe+1>>1,N[$+0+32]=Oe(oe,de,Se),N[$+1+32]=N[$+0+96]=Oe(de,Se,Ee),N[$+2+32]=N[$+1+96]=Oe(Se,Ee,Fe),N[$+3+32]=N[$+2+96]=Oe(Ee,Fe,Pe),N[$+3+64]=Oe(Fe,Pe,Ue),N[$+3+96]=Oe(Pe,Ue,Ze)}function An(N,$){var oe=N[$-1+0],de=N[$-1+32],Se=N[$-1+64],Ee=N[$-1+96];N[$+0+0]=oe+de+1>>1,N[$+2+0]=N[$+0+32]=de+Se+1>>1,N[$+2+32]=N[$+0+64]=Se+Ee+1>>1,N[$+1+0]=Oe(oe,de,Se),N[$+3+0]=N[$+1+32]=Oe(de,Se,Ee),N[$+3+32]=N[$+1+64]=Oe(Se,Ee,Ee),N[$+3+64]=N[$+2+64]=N[$+0+96]=N[$+1+96]=N[$+2+96]=N[$+3+96]=Ee}function Ct(N,$){var oe=N[$-1+0],de=N[$-1+32],Se=N[$-1+64],Ee=N[$-1+96],Fe=N[$-1-32],Pe=N[$+0-32],Ue=N[$+1-32],Ze=N[$+2-32];N[$+0+0]=N[$+2+32]=oe+Fe+1>>1,N[$+0+32]=N[$+2+64]=de+oe+1>>1,N[$+0+64]=N[$+2+96]=Se+de+1>>1,N[$+0+96]=Ee+Se+1>>1,N[$+3+0]=Oe(Pe,Ue,Ze),N[$+2+0]=Oe(Fe,Pe,Ue),N[$+1+0]=N[$+3+32]=Oe(oe,Fe,Pe),N[$+1+32]=N[$+3+64]=Oe(de,oe,Fe),N[$+1+64]=N[$+3+96]=Oe(Se,de,oe),N[$+1+96]=Oe(Ee,Se,de)}function kn(N,$){var oe;for(oe=0;8>oe;++oe)i(N,$+32*oe,N,$-32,8)}function fn(N,$){var oe;for(oe=0;8>oe;++oe)r(N,$,N[$-1],8),$+=32}function Qt(N,$,oe){var de;for(de=0;8>de;++de)r($,oe+32*de,N,8)}function Qn(N,$){var oe,de=8;for(oe=0;8>oe;++oe)de+=N[$+oe-32]+N[$-1+32*oe];Qt(de>>4,N,$)}function Tn(N,$){var oe,de=4;for(oe=0;8>oe;++oe)de+=N[$+oe-32];Qt(de>>3,N,$)}function Nn(N,$){var oe,de=4;for(oe=0;8>oe;++oe)de+=N[$-1+32*oe];Qt(de>>3,N,$)}function pn(N,$){Qt(128,N,$)}function tr(N,$,oe){var de=N[$-oe],Se=N[$+0],Ee=3*(Se-de)+Wg[1020+N[$-2*oe]-N[$+oe]],Fe=lp[112+(Ee+4>>3)];N[$-oe]=Da[255+de+lp[112+(Ee+3>>3)]],N[$+0]=Da[255+Se-Fe]}function Nr(N,$,oe,de){var Se=N[$+0],Ee=N[$+oe];return rc[255+N[$-2*oe]-N[$-oe]]>de||rc[255+Ee-Se]>de}function ks(N,$,oe,de){return 4*rc[255+N[$-oe]-N[$+0]]+rc[255+N[$-2*oe]-N[$+oe]]<=de}function ko(N,$,oe,de,Se){var Ee=N[$-3*oe],Fe=N[$-2*oe],Pe=N[$-oe],Ue=N[$+0],Ze=N[$+oe],yt=N[$+2*oe],Ut=N[$+3*oe];return 4*rc[255+Pe-Ue]+rc[255+Fe-Ze]>de?0:rc[255+N[$-4*oe]-Ee]<=Se&&rc[255+Ee-Fe]<=Se&&rc[255+Fe-Pe]<=Se&&rc[255+Ut-yt]<=Se&&rc[255+yt-Ze]<=Se&&rc[255+Ze-Ue]<=Se}function As(N,$,oe,de){var Se=2*de+1;for(de=0;16>de;++de)ks(N,$+de,oe,Se)&&tr(N,$+de,oe)}function xo(N,$,oe,de){var Se=2*de+1;for(de=0;16>de;++de)ks(N,$+de*oe,1,Se)&&tr(N,$+de*oe,1)}function ar(N,$,oe,de){var Se;for(Se=3;0<Se;--Se)As(N,$+=4*oe,oe,de)}function un(N,$,oe,de){var Se;for(Se=3;0<Se;--Se)xo(N,$+=4,oe,de)}function Vn(N,$,oe,de,Se,Ee,Fe,Pe){for(Ee=2*Ee+1;0<Se--;){if(ko(N,$,oe,Ee,Fe))if(Nr(N,$,oe,Pe))tr(N,$,oe);else{var Ue=N,Ze=$,yt=oe,Ut=Ue[Ze-2*yt],Ke=Ue[Ze-yt],St=Ue[Ze+0],Nt=Ue[Ze+yt],cn=Ue[Ze+2*yt],It=27*(Tt=Wg[1020+3*(St-Ke)+Wg[1020+Ut-Nt]])+63>>7,gn=18*Tt+63>>7,Tt=9*Tt+63>>7;Ue[Ze-3*yt]=Da[255+Ue[Ze-3*yt]+Tt],Ue[Ze-2*yt]=Da[255+Ut+gn],Ue[Ze-yt]=Da[255+Ke+It],Ue[Ze+0]=Da[255+St-It],Ue[Ze+yt]=Da[255+Nt-gn],Ue[Ze+2*yt]=Da[255+cn-Tt]}$+=de}}function Ln(N,$,oe,de,Se,Ee,Fe,Pe){for(Ee=2*Ee+1;0<Se--;){if(ko(N,$,oe,Ee,Fe))if(Nr(N,$,oe,Pe))tr(N,$,oe);else{var Ue=N,Ze=$,yt=oe,Ut=Ue[Ze-yt],Ke=Ue[Ze+0],St=Ue[Ze+yt],Nt=lp[112+(4+(cn=3*(Ke-Ut))>>3)],cn=lp[112+(cn+3>>3)],It=Nt+1>>1;Ue[Ze-2*yt]=Da[255+Ue[Ze-2*yt]+It],Ue[Ze-yt]=Da[255+Ut+cn],Ue[Ze+0]=Da[255+Ke-Nt],Ue[Ze+yt]=Da[255+St-It]}$+=de}}function ee(N,$,oe,de,Se,Ee){Vn(N,$,oe,1,16,de,Se,Ee)}function we(N,$,oe,de,Se,Ee){Vn(N,$,1,oe,16,de,Se,Ee)}function He(N,$,oe,de,Se,Ee){var Fe;for(Fe=3;0<Fe;--Fe)Ln(N,$+=4*oe,oe,1,16,de,Se,Ee)}function lt(N,$,oe,de,Se,Ee){var Fe;for(Fe=3;0<Fe;--Fe)Ln(N,$+=4,1,oe,16,de,Se,Ee)}function _t(N,$,oe,de,Se,Ee,Fe,Pe){Vn(N,$,Se,1,8,Ee,Fe,Pe),Vn(oe,de,Se,1,8,Ee,Fe,Pe)}function ln(N,$,oe,de,Se,Ee,Fe,Pe){Vn(N,$,1,Se,8,Ee,Fe,Pe),Vn(oe,de,1,Se,8,Ee,Fe,Pe)}function vn(N,$,oe,de,Se,Ee,Fe,Pe){Ln(N,$+4*Se,Se,1,8,Ee,Fe,Pe),Ln(oe,de+4*Se,Se,1,8,Ee,Fe,Pe)}function si(N,$,oe,de,Se,Ee,Fe,Pe){Ln(N,$+4,1,Se,8,Ee,Fe,Pe),Ln(oe,de+4,1,Se,8,Ee,Fe,Pe)}function oi(){this.ba=new ut,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new jt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Fi(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function pi(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Ir(){this.ua=0,this.Wa=new ce,this.vb=new ce,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new V,this.yc=new B}function Hr(){this.xb=this.a=0,this.l=new bn,this.ca=new ut,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new z,this.Pb=0,this.wd=new z,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Ir,this.ab=0,this.gc=o(4,pi),this.Oc=0}function Ns(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new bn,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function is(N,$,oe,de,Se,Ee,Fe){for(N=N==null?0:N[$+0],$=0;$<Fe;++$)Se[Ee+$]=N+oe[de+$]&255,N=Se[Ee+$]}function Js(N,$,oe,de,Se,Ee,Fe){var Pe;if(N==null)is(null,null,oe,de,Se,Ee,Fe);else for(Pe=0;Pe<Fe;++Pe)Se[Ee+Pe]=N[$+Pe]+oe[de+Pe]&255}function fs(N,$,oe,de,Se,Ee,Fe){if(N==null)is(null,null,oe,de,Se,Ee,Fe);else{var Pe,Ue=N[$+0],Ze=Ue,yt=Ue;for(Pe=0;Pe<Fe;++Pe)Ze=yt+(Ue=N[$+Pe])-Ze,yt=oe[de+Pe]+(-256&Ze?0>Ze?0:255:Ze)&255,Ze=Ue,Se[Ee+Pe]=yt}}function Io(N,$,oe,de){var Se=$.width,Ee=$.o;if(e(N!=null&&$!=null),0>oe||0>=de||oe+de>Ee)return null;if(!N.Cc){if(N.ga==null){var Fe;if(N.ga=new Ns,(Fe=N.ga==null)||(Fe=$.width*$.o,e(N.Gb.length==0),N.Gb=s(Fe),N.Uc=0,N.Gb==null?Fe=0:(N.mb=N.Gb,N.nb=N.Uc,N.rc=null,Fe=1),Fe=!Fe),!Fe){Fe=N.ga;var Pe=N.Fa,Ue=N.P,Ze=N.qc,yt=N.mb,Ut=N.nb,Ke=Ue+1,St=Ze-1,Nt=Fe.l;if(e(Pe!=null&&yt!=null&&$!=null),eu[0]=null,eu[1]=is,eu[2]=Js,eu[3]=fs,Fe.ca=yt,Fe.tb=Ut,Fe.c=$.width,Fe.i=$.height,e(0<Fe.c&&0<Fe.i),1>=Ze)$=0;else if(Fe.$a=3&Pe[Ue+0],Fe.Z=Pe[Ue+0]>>2&3,Fe.Lc=Pe[Ue+0]>>4&3,Ue=Pe[Ue+0]>>6&3,0>Fe.$a||1<Fe.$a||4<=Fe.Z||1<Fe.Lc||Ue)$=0;else if(Nt.put=Et,Nt.ac=on,Nt.bc=an,Nt.ma=Fe,Nt.width=$.width,Nt.height=$.height,Nt.Da=$.Da,Nt.v=$.v,Nt.va=$.va,Nt.j=$.j,Nt.o=$.o,Fe.$a)e:{e(Fe.$a==1),$=En();t:for(;;){if($==null){$=0;break e}if(e(Fe!=null),Fe.mc=$,$.c=Fe.c,$.i=Fe.i,$.l=Fe.l,$.l.ma=Fe,$.l.width=Fe.c,$.l.height=Fe.i,$.a=0,X($.m,Pe,Ke,St),!Hn(Fe.c,Fe.i,1,$,null)||($.ab==1&&$.gc[0].hc==3&&at($.s)?(Fe.ic=1,Pe=$.c*$.i,$.Ta=null,$.Ua=0,$.V=s(Pe),$.Ba=0,$.V==null?($.a=1,$=0):$=1):(Fe.ic=0,$=Kn($,Fe.c)),!$))break t;$=1;break e}Fe.mc=null,$=0}else $=St>=Fe.c*Fe.i;Fe=!$}if(Fe)return null;N.ga.Lc!=1?N.Ga=0:de=Ee-oe}e(N.ga!=null),e(oe+de<=Ee);e:{if($=(Pe=N.ga).c,Ee=Pe.l.o,Pe.$a==0){if(Ke=N.rc,St=N.Vc,Nt=N.Fa,Ue=N.P+1+oe*$,Ze=N.mb,yt=N.nb+oe*$,e(Ue<=N.P+N.qc),Pe.Z!=0)for(e(eu[Pe.Z]!=null),Fe=0;Fe<de;++Fe)eu[Pe.Z](Ke,St,Nt,Ue,Ze,yt,$),Ke=Ze,St=yt,yt+=$,Ue+=$;else for(Fe=0;Fe<de;++Fe)i(Ze,yt,Nt,Ue,$),Ke=Ze,St=yt,yt+=$,Ue+=$;N.rc=Ke,N.Vc=St}else{if(e(Pe.mc!=null),$=oe+de,e((Fe=Pe.mc)!=null),e($<=Fe.i),Fe.C>=$)$=1;else if(Pe.ic||Fo(),Pe.ic){Pe=Fe.V,Ke=Fe.Ba,St=Fe.c;var cn=Fe.i,It=(Nt=1,Ue=Fe.$/St,Ze=Fe.$%St,yt=Fe.m,Ut=Fe.s,Fe.$),gn=St*cn,Tt=St*$,jn=Ut.wc,In=It<Tt?Ht(Ut,Ze,Ue):null;e(It<=gn),e($<=cn),e(at(Ut));t:for(;;){for(;!yt.h&&It<Tt;){if(Ze&jn||(In=Ht(Ut,Ze,Ue)),e(In!=null),H(yt),256>(cn=Zt(In.G[0],In.H[0],yt)))Pe[Ke+It]=cn,++It,++Ze>=St&&(Ze=0,++Ue<=$&&!(Ue%16)&&Cn(Fe,Ue));else{if(!(280>cn)){Nt=0;break t}cn=At(cn-256,yt);var Pi,Ci=Zt(In.G[4],In.H[4],yt);if(H(yt),!(It>=(Ci=zt(St,Ci=At(Ci,yt)))&&gn-It>=cn)){Nt=0;break t}for(Pi=0;Pi<cn;++Pi)Pe[Ke+It+Pi]=Pe[Ke+It+Pi-Ci];for(It+=cn,Ze+=cn;Ze>=St;)Ze-=St,++Ue<=$&&!(Ue%16)&&Cn(Fe,Ue);It<Tt&&Ze&jn&&(In=Ht(Ut,Ze,Ue))}e(yt.h==G(yt))}Cn(Fe,Ue>$?$:Ue);break t}!Nt||yt.h&&It<gn?(Nt=0,Fe.a=yt.h?5:3):Fe.$=It,$=Nt}else $=Rn(Fe,Fe.V,Fe.Ba,Fe.c,Fe.i,$,Ti);if(!$){de=0;break e}}oe+de>=Ee&&(N.Cc=1),de=1}if(!de)return null;if(N.Cc&&((de=N.ga)!=null&&(de.mc=null),N.ga=null,0<N.Ga))return alert("todo:WebPDequantizeLevels"),null}return N.nb+oe*Se}function Al(N,$,oe,de,Se,Ee){for(;0<Se--;){var Fe,Pe=N,Ue=$+(oe?1:0),Ze=N,yt=$+(oe?0:3);for(Fe=0;Fe<de;++Fe){var Ut=Ze[yt+4*Fe];Ut!=255&&(Ut*=32897,Pe[Ue+4*Fe+0]=Pe[Ue+4*Fe+0]*Ut>>23,Pe[Ue+4*Fe+1]=Pe[Ue+4*Fe+1]*Ut>>23,Pe[Ue+4*Fe+2]=Pe[Ue+4*Fe+2]*Ut>>23)}$+=Ee}}function bc(N,$,oe,de,Se){for(;0<de--;){var Ee;for(Ee=0;Ee<oe;++Ee){var Fe=N[$+2*Ee+0],Pe=15&(Ze=N[$+2*Ee+1]),Ue=4369*Pe,Ze=(240&Ze|Ze>>4)*Ue>>16;N[$+2*Ee+0]=(240&Fe|Fe>>4)*Ue>>16&240|(15&Fe|Fe<<4)*Ue>>16>>4&15,N[$+2*Ee+1]=240&Ze|Pe}$+=Se}}function Qc(N,$,oe,de,Se,Ee,Fe,Pe){var Ue,Ze,yt=255;for(Ze=0;Ze<Se;++Ze){for(Ue=0;Ue<de;++Ue){var Ut=N[$+Ue];Ee[Fe+4*Ue]=Ut,yt&=Ut}$+=oe,Fe+=Pe}return yt!=255}function $c(N,$,oe,de,Se){var Ee;for(Ee=0;Ee<Se;++Ee)oe[de+Ee]=N[$+Ee]>>8}function Fo(){Jh=Al,Ug=bc,Hg=Qc,c1=$c}function Ba(N,$,oe){_[N]=function(de,Se,Ee,Fe,Pe,Ue,Ze,yt,Ut,Ke,St,Nt,cn,It,gn,Tt,jn){var In,Pi=jn-1>>1,Ci=Pe[Ue+0]|Ze[yt+0]<<16,lr=Ut[Ke+0]|St[Nt+0]<<16;e(de!=null);var Si=3*Ci+lr+131074>>2;for($(de[Se+0],255&Si,Si>>16,cn,It),Ee!=null&&(Si=3*lr+Ci+131074>>2,$(Ee[Fe+0],255&Si,Si>>16,gn,Tt)),In=1;In<=Pi;++In){var Rr=Pe[Ue+In]|Ze[yt+In]<<16,Ro=Ut[Ke+In]|St[Nt+In]<<16,yr=Ci+Rr+lr+Ro+524296,Ei=yr+2*(Rr+lr)>>3;Si=Ei+Ci>>1,Ci=(yr=yr+2*(Ci+Ro)>>3)+Rr>>1,$(de[Se+2*In-1],255&Si,Si>>16,cn,It+(2*In-1)*oe),$(de[Se+2*In-0],255&Ci,Ci>>16,cn,It+(2*In-0)*oe),Ee!=null&&(Si=yr+lr>>1,Ci=Ei+Ro>>1,$(Ee[Fe+2*In-1],255&Si,Si>>16,gn,Tt+(2*In-1)*oe),$(Ee[Fe+2*In+0],255&Ci,Ci>>16,gn,Tt+(2*In+0)*oe)),Ci=Rr,lr=Ro}1&jn||(Si=3*Ci+lr+131074>>2,$(de[Se+jn-1],255&Si,Si>>16,cn,It+(jn-1)*oe),Ee!=null&&(Si=3*lr+Ci+131074>>2,$(Ee[Fe+jn-1],255&Si,Si>>16,gn,Tt+(jn-1)*oe)))}}function Wu(){sc[Dd]=Bw,sc[jd]=w1,sc[p1]=Ew,sc[OA]=kw,sc[cp]=pl,sc[Qg]=qa,sc[g1]=Iw,sc[$g]=w1,sc[hp]=kw,sc[up]=pl,sc[Vg]=qa}function Ea(N){return N&-16384?0>N?0:255:N>>x1}function L(N,$){return Ea((19077*N>>8)+(26149*$>>8)-14234)}function ae(N,$,oe){return Ea((19077*N>>8)-(6419*$>>8)-(13320*oe>>8)+8708)}function ge(N,$){return Ea((19077*N>>8)+(33050*$>>8)-17685)}function Ne(N,$,oe,de,Se){de[Se+0]=L(N,oe),de[Se+1]=ae(N,$,oe),de[Se+2]=ge(N,$)}function Ft(N,$,oe,de,Se){de[Se+0]=ge(N,$),de[Se+1]=ae(N,$,oe),de[Se+2]=L(N,oe)}function Kt(N,$,oe,de,Se){var Ee=ae(N,$,oe);$=Ee<<3&224|ge(N,$)>>3,de[Se+0]=248&L(N,oe)|Ee>>5,de[Se+1]=$}function Pn(N,$,oe,de,Se){var Ee=240&ge(N,$)|15;de[Se+0]=240&L(N,oe)|ae(N,$,oe)>>4,de[Se+1]=Ee}function Lr(N,$,oe,de,Se){de[Se+0]=255,Ne(N,$,oe,de,Se+1)}function Ls(N,$,oe,de,Se){Ft(N,$,oe,de,Se),de[Se+3]=255}function Fr(N,$,oe,de,Se){Ne(N,$,oe,de,Se),de[Se+3]=255}function Mr(N,$){return 0>N?0:N>$?$:N}function cs(N,$,oe){_[N]=function(de,Se,Ee,Fe,Pe,Ue,Ze,yt,Ut){for(var Ke=yt+(-2&Ut)*oe;yt!=Ke;)$(de[Se+0],Ee[Fe+0],Pe[Ue+0],Ze,yt),$(de[Se+1],Ee[Fe+0],Pe[Ue+0],Ze,yt+oe),Se+=2,++Fe,++Ue,yt+=2*oe;1&Ut&&$(de[Se+0],Ee[Fe+0],Pe[Ue+0],Ze,yt)}}function Nl(N,$,oe){return oe==0?N==0?$==0?6:5:$==0?4:0:oe}function bo(N,$,oe,de,Se){switch(N>>>30){case 3:ho($,oe,de,Se,0);break;case 2:Sc($,oe,de,Se);break;case 1:Xa($,oe,de,Se)}}function eo(N,$){var oe,de,Se=$.M,Ee=$.Nb,Fe=N.oc,Pe=N.pc+40,Ue=N.oc,Ze=N.pc+584,yt=N.oc,Ut=N.pc+600;for(oe=0;16>oe;++oe)Fe[Pe+32*oe-1]=129;for(oe=0;8>oe;++oe)Ue[Ze+32*oe-1]=129,yt[Ut+32*oe-1]=129;for(0<Se?Fe[Pe-1-32]=Ue[Ze-1-32]=yt[Ut-1-32]=129:(r(Fe,Pe-32-1,127,21),r(Ue,Ze-32-1,127,9),r(yt,Ut-32-1,127,9)),de=0;de<N.za;++de){var Ke=$.ya[$.aa+de];if(0<de){for(oe=-1;16>oe;++oe)i(Fe,Pe+32*oe-4,Fe,Pe+32*oe+12,4);for(oe=-1;8>oe;++oe)i(Ue,Ze+32*oe-4,Ue,Ze+32*oe+4,4),i(yt,Ut+32*oe-4,yt,Ut+32*oe+4,4)}var St=N.Gd,Nt=N.Hd+de,cn=Ke.ad,It=Ke.Hc;if(0<Se&&(i(Fe,Pe-32,St[Nt].y,0,16),i(Ue,Ze-32,St[Nt].f,0,8),i(yt,Ut-32,St[Nt].ea,0,8)),Ke.Za){var gn=Fe,Tt=Pe-32+16;for(0<Se&&(de>=N.za-1?r(gn,Tt,St[Nt].y[15],4):i(gn,Tt,St[Nt+1].y,0,4)),oe=0;4>oe;oe++)gn[Tt+128+oe]=gn[Tt+256+oe]=gn[Tt+384+oe]=gn[Tt+0+oe];for(oe=0;16>oe;++oe,It<<=2)gn=Fe,Tt=Pe+Kg[oe],Ka[Ke.Ob[oe]](gn,Tt),bo(It,cn,16*+oe,gn,Tt)}else if(gn=Nl(de,Se,Ke.Ob[0]),vh[gn](Fe,Pe),It!=0)for(oe=0;16>oe;++oe,It<<=2)bo(It,cn,16*+oe,Fe,Pe+Kg[oe]);for(oe=Ke.Gc,gn=Nl(de,Se,Ke.Dd),Kc[gn](Ue,Ze),Kc[gn](yt,Ut),It=cn,gn=Ue,Tt=Ze,255&(Ke=0|oe)&&(170&Ke?Qu(It,256,gn,Tt):Is(It,256,gn,Tt)),Ke=yt,It=Ut,255&(oe>>=8)&&(170&oe?Qu(cn,320,Ke,It):Is(cn,320,Ke,It)),Se<N.Ub-1&&(i(St[Nt].y,0,Fe,Pe+480,16),i(St[Nt].f,0,Ue,Ze+224,8),i(St[Nt].ea,0,yt,Ut+224,8)),oe=8*Ee*N.B,St=N.sa,Nt=N.ta+16*de+16*Ee*N.R,cn=N.qa,Ke=N.ra+8*de+oe,It=N.Ha,gn=N.Ia+8*de+oe,oe=0;16>oe;++oe)i(St,Nt+oe*N.R,Fe,Pe+32*oe,16);for(oe=0;8>oe;++oe)i(cn,Ke+oe*N.B,Ue,Ze+32*oe,8),i(It,gn+oe*N.B,yt,Ut+32*oe,8)}}function Qa(N,$,oe,de,Se,Ee,Fe,Pe,Ue){var Ze=[0],yt=[0],Ut=0,Ke=Ue!=null?Ue.kd:0,St=Ue??new Fi;if(N==null||12>oe)return 7;St.data=N,St.w=$,St.ha=oe,$=[$],oe=[oe],St.gb=[St.gb];e:{var Nt=$,cn=oe,It=St.gb;if(e(N!=null),e(cn!=null),e(It!=null),It[0]=0,12<=cn[0]&&!t(N,Nt[0],"RIFF")){if(t(N,Nt[0]+8,"WEBP")){It=3;break e}var gn=W(N,Nt[0]+4);if(12>gn||4294967286<gn){It=3;break e}if(Ke&&gn>cn[0]-8){It=7;break e}It[0]=gn,Nt[0]+=12,cn[0]-=12}It=0}if(It!=0)return It;for(gn=0<St.gb[0],oe=oe[0];;){e:{var Tt=N;cn=$,It=oe;var jn=Ze,In=yt,Pi=Nt=[0];if((Si=Ut=[Ut])[0]=0,8>It[0])It=7;else{if(!t(Tt,cn[0],"VP8X")){if(W(Tt,cn[0]+4)!=10){It=3;break e}if(18>It[0]){It=7;break e}var Ci=W(Tt,cn[0]+8),lr=1+_e(Tt,cn[0]+12);if(2147483648<=lr*(Tt=1+_e(Tt,cn[0]+15))){It=3;break e}Pi!=null&&(Pi[0]=Ci),jn!=null&&(jn[0]=lr),In!=null&&(In[0]=Tt),cn[0]+=18,It[0]-=18,Si[0]=1}It=0}}if(Ut=Ut[0],Nt=Nt[0],It!=0)return It;if(cn=!!(2&Nt),!gn&&Ut)return 3;if(Ee!=null&&(Ee[0]=!!(16&Nt)),Fe!=null&&(Fe[0]=cn),Pe!=null&&(Pe[0]=0),Fe=Ze[0],Nt=yt[0],Ut&&cn&&Ue==null){It=0;break}if(4>oe){It=7;break}if(gn&&Ut||!gn&&!Ut&&!t(N,$[0],"ALPH")){oe=[oe],St.na=[St.na],St.P=[St.P],St.Sa=[St.Sa];e:{Ci=N,It=$,gn=oe;var Si=St.gb;jn=St.na,In=St.P,Pi=St.Sa,lr=22,e(Ci!=null),e(gn!=null),Tt=It[0];var Rr=gn[0];for(e(jn!=null),e(Pi!=null),jn[0]=null,In[0]=null,Pi[0]=0;;){if(It[0]=Tt,gn[0]=Rr,8>Rr){It=7;break e}var Ro=W(Ci,Tt+4);if(4294967286<Ro){It=3;break e}var yr=8+Ro+1&-2;if(lr+=yr,0<Si&&lr>Si){It=3;break e}if(!t(Ci,Tt,"VP8 ")||!t(Ci,Tt,"VP8L")){It=0;break e}if(Rr[0]<yr){It=7;break e}t(Ci,Tt,"ALPH")||(jn[0]=Ci,In[0]=Tt+8,Pi[0]=Ro),Tt+=yr,Rr-=yr}}if(oe=oe[0],St.na=St.na[0],St.P=St.P[0],St.Sa=St.Sa[0],It!=0)break}oe=[oe],St.Ja=[St.Ja],St.xa=[St.xa];e:if(Si=N,It=$,gn=oe,jn=St.gb[0],In=St.Ja,Pi=St.xa,Ci=It[0],Tt=!t(Si,Ci,"VP8 "),lr=!t(Si,Ci,"VP8L"),e(Si!=null),e(gn!=null),e(In!=null),e(Pi!=null),8>gn[0])It=7;else{if(Tt||lr){if(Si=W(Si,Ci+4),12<=jn&&Si>jn-12){It=3;break e}if(Ke&&Si>gn[0]-8){It=7;break e}In[0]=Si,It[0]+=8,gn[0]-=8,Pi[0]=lr}else Pi[0]=5<=gn[0]&&Si[Ci+0]==47&&!(Si[Ci+4]>>5),In[0]=gn[0];It=0}if(oe=oe[0],St.Ja=St.Ja[0],St.xa=St.xa[0],$=$[0],It!=0)break;if(4294967286<St.Ja)return 3;if(Pe==null||cn||(Pe[0]=St.xa?2:1),Fe=[Fe],Nt=[Nt],St.xa){if(5>oe){It=7;break}Pe=Fe,Ke=Nt,cn=Ee,N==null||5>oe?N=0:5<=oe&&N[$+0]==47&&!(N[$+4]>>5)?(gn=[0],Si=[0],jn=[0],X(In=new z,N,$,oe),Mn(In,gn,Si,jn)?(Pe!=null&&(Pe[0]=gn[0]),Ke!=null&&(Ke[0]=Si[0]),cn!=null&&(cn[0]=jn[0]),N=1):N=0):N=0}else{if(10>oe){It=7;break}Pe=Nt,N==null||10>oe||!ui(N,$+3,oe-3)?N=0:(Ke=N[$+0]|N[$+1]<<8|N[$+2]<<16,cn=16383&(N[$+7]<<8|N[$+6]),N=16383&(N[$+9]<<8|N[$+8]),1&Ke||3<(Ke>>1&7)||!(Ke>>4&1)||Ke>>5>=St.Ja||!cn||!N?N=0:(Fe&&(Fe[0]=cn),Pe&&(Pe[0]=N),N=1))}if(!N||(Fe=Fe[0],Nt=Nt[0],Ut&&(Ze[0]!=Fe||yt[0]!=Nt)))return 3;Ue!=null&&(Ue[0]=St,Ue.offset=$-Ue.w,e(4294967286>$-Ue.w),e(Ue.offset==Ue.ha-oe));break}return It==0||It==7&&Ut&&Ue==null?(Ee!=null&&(Ee[0]|=St.na!=null&&0<St.na.length),de!=null&&(de[0]=Fe),Se!=null&&(Se[0]=Nt),0):It}function $a(N,$,oe){var de=$.width,Se=$.height,Ee=0,Fe=0,Pe=de,Ue=Se;if($.Da=N!=null&&0<N.Da,$.Da&&(Pe=N.cd,Ue=N.bd,Ee=N.v,Fe=N.j,11>oe||(Ee&=-2,Fe&=-2),0>Ee||0>Fe||0>=Pe||0>=Ue||Ee+Pe>de||Fe+Ue>Se))return 0;if($.v=Ee,$.j=Fe,$.va=Ee+Pe,$.o=Fe+Ue,$.U=Pe,$.T=Ue,$.da=N!=null&&0<N.da,$.da){if(!ne(Pe,Ue,oe=[N.ib],Ee=[N.hb]))return 0;$.ib=oe[0],$.hb=Ee[0]}return $.ob=N!=null&&N.ob,$.Kb=N==null||!N.Sd,$.da&&($.ob=$.ib<3*de/4&&$.hb<3*Se/4,$.Kb=0),1}function fl(N){if(N==null)return 2;if(11>N.S){var $=N.f.RGBA;$.fb+=(N.height-1)*$.A,$.A=-$.A}else $=N.f.kb,N=N.height,$.O+=(N-1)*$.fa,$.fa=-$.fa,$.N+=(N-1>>1)*$.Ab,$.Ab=-$.Ab,$.W+=(N-1>>1)*$.Db,$.Db=-$.Db,$.F!=null&&($.J+=(N-1)*$.lb,$.lb=-$.lb);return 0}function Va(N,$,oe,de){if(de==null||0>=N||0>=$)return 2;if(oe!=null){if(oe.Da){var Se=oe.cd,Ee=oe.bd,Fe=-2&oe.v,Pe=-2&oe.j;if(0>Fe||0>Pe||0>=Se||0>=Ee||Fe+Se>N||Pe+Ee>$)return 2;N=Se,$=Ee}if(oe.da){if(!ne(N,$,Se=[oe.ib],Ee=[oe.hb]))return 2;N=Se[0],$=Ee[0]}}de.width=N,de.height=$;e:{var Ue=de.width,Ze=de.height;if(N=de.S,0>=Ue||0>=Ze||!(N>=Dd&&13>N))N=2;else{if(0>=de.Rd&&de.sd==null){Fe=Ee=Se=$=0;var yt=(Pe=Ue*qg[N])*Ze;if(11>N||(Ee=(Ze+1)/2*($=(Ue+1)/2),N==12&&(Fe=(Se=Ue)*Ze)),(Ze=s(yt+2*Ee+Fe))==null){N=1;break e}de.sd=Ze,11>N?((Ue=de.f.RGBA).eb=Ze,Ue.fb=0,Ue.A=Pe,Ue.size=yt):((Ue=de.f.kb).y=Ze,Ue.O=0,Ue.fa=Pe,Ue.Fd=yt,Ue.f=Ze,Ue.N=0+yt,Ue.Ab=$,Ue.Cd=Ee,Ue.ea=Ze,Ue.W=0+yt+Ee,Ue.Db=$,Ue.Ed=Ee,N==12&&(Ue.F=Ze,Ue.J=0+yt+2*Ee),Ue.Tc=Fe,Ue.lb=Se)}if($=1,Se=de.S,Ee=de.width,Fe=de.height,Se>=Dd&&13>Se)if(11>Se)N=de.f.RGBA,$&=(Pe=Math.abs(N.A))*(Fe-1)+Ee<=N.size,$&=Pe>=Ee*qg[Se],$&=N.eb!=null;else{N=de.f.kb,Pe=(Ee+1)/2,yt=(Fe+1)/2,Ue=Math.abs(N.fa),Ze=Math.abs(N.Ab);var Ut=Math.abs(N.Db),Ke=Math.abs(N.lb),St=Ke*(Fe-1)+Ee;$&=Ue*(Fe-1)+Ee<=N.Fd,$&=Ze*(yt-1)+Pe<=N.Cd,$=($&=Ut*(yt-1)+Pe<=N.Ed)&Ue>=Ee&Ze>=Pe&Ut>=Pe,$&=N.y!=null,$&=N.f!=null,$&=N.ea!=null,Se==12&&($&=Ke>=Ee,$&=St<=N.Tc,$&=N.F!=null)}else $=0;N=$?0:2}}return N!=0||oe!=null&&oe.fd&&(N=fl(de)),N}var ka=64,gh=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],NA=24,za=32,Ss=8,LA=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Te("Predictor0","PredictorAdd0"),_.Predictor0=function(){return 4278190080},_.Predictor1=function(N){return N},_.Predictor2=function(N,$,oe){return $[oe+0]},_.Predictor3=function(N,$,oe){return $[oe+1]},_.Predictor4=function(N,$,oe){return $[oe-1]},_.Predictor5=function(N,$,oe){return Be(Be(N,$[oe+1]),$[oe+0])},_.Predictor6=function(N,$,oe){return Be(N,$[oe-1])},_.Predictor7=function(N,$,oe){return Be(N,$[oe+0])},_.Predictor8=function(N,$,oe){return Be($[oe-1],$[oe+0])},_.Predictor9=function(N,$,oe){return Be($[oe+0],$[oe+1])},_.Predictor10=function(N,$,oe){return Be(Be(N,$[oe-1]),Be($[oe+0],$[oe+1]))},_.Predictor11=function(N,$,oe){var de=$[oe+0];return 0>=ot(de>>24&255,N>>24&255,($=$[oe-1])>>24&255)+ot(de>>16&255,N>>16&255,$>>16&255)+ot(de>>8&255,N>>8&255,$>>8&255)+ot(255&de,255&N,255&$)?de:N},_.Predictor12=function(N,$,oe){var de=$[oe+0];return(Ye((N>>24&255)+(de>>24&255)-(($=$[oe-1])>>24&255))<<24|Ye((N>>16&255)+(de>>16&255)-($>>16&255))<<16|Ye((N>>8&255)+(de>>8&255)-($>>8&255))<<8|Ye((255&N)+(255&de)-(255&$)))>>>0},_.Predictor13=function(N,$,oe){var de=$[oe-1];return($e((N=Be(N,$[oe+0]))>>24&255,de>>24&255)<<24|$e(N>>16&255,de>>16&255)<<16|$e(N>>8&255,de>>8&255)<<8|$e(255&N,255&de))>>>0};var Vc=_.PredictorAdd0;_.PredictorAdd1=rt,Te("Predictor2","PredictorAdd2"),Te("Predictor3","PredictorAdd3"),Te("Predictor4","PredictorAdd4"),Te("Predictor5","PredictorAdd5"),Te("Predictor6","PredictorAdd6"),Te("Predictor7","PredictorAdd7"),Te("Predictor8","PredictorAdd8"),Te("Predictor9","PredictorAdd9"),Te("Predictor10","PredictorAdd10"),Te("Predictor11","PredictorAdd11"),Te("Predictor12","PredictorAdd12"),Te("Predictor13","PredictorAdd13");var nc=_.PredictorAdd2;Ge("ColorIndexInverseTransform","MapARGB","32b",function(N){return N>>8&255},function(N){return N}),Ge("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(N){return N},function(N){return N>>8&255});var Fd,Zh=_.ColorIndexInverseTransform,Ia=_.MapARGB,mh=_.VP8LColorIndexInverseTransformAlpha,_c=_.MapAlpha,Ga=_.VP8LPredictorsAdd=[];Ga.length=16,(_.VP8LPredictors=[]).length=16,(_.VP8LPredictorsAdd_C=[]).length=16,(_.VP8LPredictors_C=[]).length=16;var zc,yh,Ll,Cc,er,xs,co,ho,Sc,Qu,Xa,Is,Mo,Jo,ap,MA,RA,yw,Fa,Mg,Rg,Og,Gc,ic,Jh,Ug,Hg,c1,h1=s(511),u1=s(2041),d1=s(225),A1=s(767),f1=0,Wg=u1,lp=d1,Da=A1,rc=h1,Dd=0,jd=1,p1=2,OA=3,cp=4,Qg=5,g1=6,$g=7,hp=8,up=9,Vg=10,vw=[2,3,7],vS=[3,3,11],m1=[280,256,256,256,40],wS=[0,1,1,1,0],xS=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],ww=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],xw=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],bw=8,UA=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],y1=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],dp=null,bS=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Xc=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],zg=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Gg=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],_w=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Cw=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Sw=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],vh=[],Ka=[],Kc=[],v1=1,Tw=2,eu=[],sc=[];Ba("UpsampleRgbLinePair",Ne,3),Ba("UpsampleBgrLinePair",Ft,3),Ba("UpsampleRgbaLinePair",Fr,4),Ba("UpsampleBgraLinePair",Ls,4),Ba("UpsampleArgbLinePair",Lr,4),Ba("UpsampleRgba4444LinePair",Pn,2),Ba("UpsampleRgb565LinePair",Kt,2);var Bw=_.UpsampleRgbLinePair,Ew=_.UpsampleBgrLinePair,w1=_.UpsampleRgbaLinePair,kw=_.UpsampleBgraLinePair,pl=_.UpsampleArgbLinePair,qa=_.UpsampleRgba4444LinePair,Iw=_.UpsampleRgb565LinePair,Ap=16,fp=1<<Ap-1,HA=-227,Xg=482,x1=6,b1=0,_1=s(256),Fw=s(256),Dw=s(256),C1=s(256),S1=s(Xg-HA),jw=s(Xg-HA);cs("YuvToRgbRow",Ne,3),cs("YuvToBgrRow",Ft,3),cs("YuvToRgbaRow",Fr,4),cs("YuvToBgraRow",Ls,4),cs("YuvToArgbRow",Lr,4),cs("YuvToRgba4444Row",Pn,2),cs("YuvToRgb565Row",Kt,2);var Kg=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Pd=[0,2,8],_S=[8,7,6,4,4,2,2,2,1,1,1,1],Pw=1;this.WebPDecodeRGBA=function(N,$,oe,de,Se){var Ee=jd,Fe=new oi,Pe=new ut;Fe.ba=Pe,Pe.S=Ee,Pe.width=[Pe.width],Pe.height=[Pe.height];var Ue=Pe.width,Ze=Pe.height,yt=new ft;if(yt==null||N==null)var Ut=2;else e(yt!=null),Ut=Qa(N,$,oe,yt.width,yt.height,yt.Pd,yt.Qd,yt.format,null);if(Ut!=0?Ue=0:(Ue!=null&&(Ue[0]=yt.width[0]),Ze!=null&&(Ze[0]=yt.height[0]),Ue=1),Ue){Pe.width=Pe.width[0],Pe.height=Pe.height[0],de!=null&&(de[0]=Pe.width),Se!=null&&(Se[0]=Pe.height);e:{if(de=new bn,(Se=new Fi).data=N,Se.w=$,Se.ha=oe,Se.kd=1,$=[0],e(Se!=null),((N=Qa(Se.data,Se.w,Se.ha,null,null,null,$,null,Se))==0||N==7)&&$[0]&&(N=4),($=N)==0){if(e(Fe!=null),de.data=Se.data,de.w=Se.w+Se.offset,de.ha=Se.ha-Se.offset,de.put=Et,de.ac=on,de.bc=an,de.ma=Fe,Se.xa){if((N=En())==null){Fe=1;break e}if((function(Ke,St){var Nt=[0],cn=[0],It=[0];t:for(;;){if(Ke==null)return 0;if(St==null)return Ke.a=2,0;if(Ke.l=St,Ke.a=0,X(Ke.m,St.data,St.w,St.ha),!Mn(Ke.m,Nt,cn,It)){Ke.a=3;break t}if(Ke.xb=Tw,St.width=Nt[0],St.height=cn[0],!Hn(Nt[0],cn[0],1,Ke,null))break t;return 1}return e(Ke.a!=0),0})(N,de)){if(de=($=Va(de.width,de.height,Fe.Oa,Fe.ba))==0){t:{de=N;n:for(;;){if(de==null){de=0;break t}if(e(de.s.yc!=null),e(de.s.Ya!=null),e(0<de.s.Wb),e((oe=de.l)!=null),e((Se=oe.ma)!=null),de.xb!=0){if(de.ca=Se.ba,de.tb=Se.tb,e(de.ca!=null),!$a(Se.Oa,oe,OA)){de.a=2;break n}if(!Kn(de,oe.width)||oe.da)break n;if((oe.da||le(de.ca.S))&&Fo(),11>de.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),de.ca.f.kb.F!=null&&Fo()),de.Pb&&0<de.s.ua&&de.s.vb.X==null&&!Y(de.s.vb,de.s.Wa.Xa)){de.a=1;break n}de.xb=0}if(!Rn(de,de.V,de.Ba,de.c,de.i,oe.o,dt))break n;Se.Dc=de.Ma,de=1;break t}e(de.a!=0),de=0}de=!de}de&&($=N.a)}else $=N.a}else{if((N=new Li)==null){Fe=1;break e}if(N.Fa=Se.na,N.P=Se.P,N.qc=Se.Sa,Mi(N,de)){if(($=Va(de.width,de.height,Fe.Oa,Fe.ba))==0){if(N.Aa=0,oe=Fe.Oa,e((Se=N)!=null),oe!=null){if(0<(Ue=0>(Ue=oe.Md)?0:100<Ue?255:255*Ue/100)){for(Ze=yt=0;4>Ze;++Ze)12>(Ut=Se.pb[Ze]).lc&&(Ut.ia=Ue*_S[0>Ut.lc?0:Ut.lc]>>3),yt|=Ut.ia;yt&&(alert("todo:VP8InitRandom"),Se.ia=1)}Se.Ga=oe.Id,100<Se.Ga?Se.Ga=100:0>Se.Ga&&(Se.Ga=0)}(function(Ke,St){if(Ke==null)return 0;if(St==null)return Wn(Ke,2,"NULL VP8Io parameter in VP8Decode().");if(!Ke.cb&&!Mi(Ke,St))return 0;if(e(Ke.cb),St.ac==null||St.ac(St)){St.ob&&(Ke.L=0);var Nt=Pd[Ke.L];if(Ke.L==2?(Ke.yb=0,Ke.zb=0):(Ke.yb=St.v-Nt>>4,Ke.zb=St.j-Nt>>4,0>Ke.yb&&(Ke.yb=0),0>Ke.zb&&(Ke.zb=0)),Ke.Va=St.o+15+Nt>>4,Ke.Hb=St.va+15+Nt>>4,Ke.Hb>Ke.za&&(Ke.Hb=Ke.za),Ke.Va>Ke.Ub&&(Ke.Va=Ke.Ub),0<Ke.L){var cn=Ke.ed;for(Nt=0;4>Nt;++Nt){var It;if(Ke.Qa.Cb){var gn=Ke.Qa.Lb[Nt];Ke.Qa.Fb||(gn+=cn.Tb)}else gn=cn.Tb;for(It=0;1>=It;++It){var Tt=Ke.gd[Nt][It],jn=gn;if(cn.Pc&&(jn+=cn.vd[0],It&&(jn+=cn.od[0])),0<(jn=0>jn?0:63<jn?63:jn)){var In=jn;0<cn.wb&&(In=4<cn.wb?In>>2:In>>1)>9-cn.wb&&(In=9-cn.wb),1>In&&(In=1),Tt.dd=In,Tt.tc=2*jn+In,Tt.ld=40<=jn?2:15<=jn?1:0}else Tt.tc=0;Tt.La=It}}}Nt=0}else Wn(Ke,6,"Frame setup failed"),Nt=Ke.a;if(Nt=Nt==0){if(Nt){Ke.$c=0,0<Ke.Aa||(Ke.Ic=Pw);t:{Nt=Ke.Ic,cn=4*(In=Ke.za);var Pi=32*In,Ci=In+1,lr=0<Ke.L?In*(0<Ke.Aa?2:1):0,Si=(Ke.Aa==2?2:1)*In;if((Tt=cn+832+(It=3*(16*Nt+Pd[Ke.L])/2*Pi)+(gn=Ke.Fa!=null&&0<Ke.Fa.length?Ke.Kc.c*Ke.Kc.i:0))!=Tt)Nt=0;else{if(Tt>Ke.Vb){if(Ke.Vb=0,Ke.Ec=s(Tt),Ke.Fc=0,Ke.Ec==null){Nt=Wn(Ke,1,"no memory during frame initialization.");break t}Ke.Vb=Tt}Tt=Ke.Ec,jn=Ke.Fc,Ke.Ac=Tt,Ke.Bc=jn,jn+=cn,Ke.Gd=o(Pi,mn),Ke.Hd=0,Ke.rb=o(Ci+1,Fn),Ke.sb=1,Ke.wa=lr?o(lr,$n):null,Ke.Y=0,Ke.D.Nb=0,Ke.D.wa=Ke.wa,Ke.D.Y=Ke.Y,0<Ke.Aa&&(Ke.D.Y+=In),e(!0),Ke.oc=Tt,Ke.pc=jn,jn+=832,Ke.ya=o(Si,vt),Ke.aa=0,Ke.D.ya=Ke.ya,Ke.D.aa=Ke.aa,Ke.Aa==2&&(Ke.D.aa+=In),Ke.R=16*In,Ke.B=8*In,In=(Pi=Pd[Ke.L])*Ke.R,Pi=Pi/2*Ke.B,Ke.sa=Tt,Ke.ta=jn+In,Ke.qa=Ke.sa,Ke.ra=Ke.ta+16*Nt*Ke.R+Pi,Ke.Ha=Ke.qa,Ke.Ia=Ke.ra+8*Nt*Ke.B+Pi,Ke.$c=0,jn+=It,Ke.mb=gn?Tt:null,Ke.nb=gn?jn:null,e(jn+gn<=Ke.Fc+Ke.Vb),Dn(Ke),r(Ke.Ac,Ke.Bc,0,cn),Nt=1}}if(Nt){if(St.ka=0,St.y=Ke.sa,St.O=Ke.ta,St.f=Ke.qa,St.N=Ke.ra,St.ea=Ke.Ha,St.Vd=Ke.Ia,St.fa=Ke.R,St.Rc=Ke.B,St.F=null,St.J=0,!f1){for(Nt=-255;255>=Nt;++Nt)h1[255+Nt]=0>Nt?-Nt:Nt;for(Nt=-1020;1020>=Nt;++Nt)u1[1020+Nt]=-128>Nt?-128:127<Nt?127:Nt;for(Nt=-112;112>=Nt;++Nt)d1[112+Nt]=-16>Nt?-16:15<Nt?15:Nt;for(Nt=-255;510>=Nt;++Nt)A1[255+Nt]=0>Nt?0:255<Nt?255:Nt;f1=1}co=hi,ho=tt,Qu=Jt,Xa=wn,Is=Yn,Sc=Ui,Mo=ee,Jo=we,ap=_t,MA=ln,RA=He,yw=lt,Fa=vn,Mg=si,Rg=As,Og=xo,Gc=ar,ic=un,Ka[0]=Ae,Ka[1]=_i,Ka[2]=nt,Ka[3]=gt,Ka[4]=me,Ka[5]=qe,Ka[6]=Xe,Ka[7]=nn,Ka[8]=Ct,Ka[9]=An,vh[0]=Qr,vh[1]=ws,vh[2]=Vi,vh[3]=br,vh[4]=ue,vh[5]=ke,vh[6]=Me,Kc[0]=Qn,Kc[1]=Pr,Kc[2]=kn,Kc[3]=fn,Kc[4]=Nn,Kc[5]=Tn,Kc[6]=pn,Nt=1}else Nt=0}Nt&&(Nt=(function(Rr,Ro){for(Rr.M=0;Rr.M<Rr.Va;++Rr.M){var yr,Ei=Rr.Jc[Rr.M&Rr.Xb],Zn=Rr.m,uo=Rr;for(yr=0;yr<uo.za;++yr){var Ni=Zn,dr=uo,Gr=dr.Ac,ea=dr.Bc+4*yr,Ya=dr.zc,rs=dr.ya[dr.aa+yr];if(dr.Qa.Bb?rs.$b=fe(Ni,dr.Pa.jb[0])?2+fe(Ni,dr.Pa.jb[2]):fe(Ni,dr.Pa.jb[1]):rs.$b=0,dr.kc&&(rs.Ad=fe(Ni,dr.Bd)),rs.Za=!fe(Ni,145)+0,rs.Za){var ja=rs.Ob,to=0;for(dr=0;4>dr;++dr){var ta,Xr=Ya[0+dr];for(ta=0;4>ta;++ta){Xr=_w[Gr[ea+ta]][Xr];for(var ps=zg[fe(Ni,Xr[0])];0<ps;)ps=zg[2*ps+fe(Ni,Xr[ps])];Xr=-ps,Gr[ea+ta]=Xr}i(ja,to,Gr,ea,4),to+=4,Ya[0+dr]=Xr}}else Xr=fe(Ni,156)?fe(Ni,128)?1:3:fe(Ni,163)?2:0,rs.Ob[0]=Xr,r(Gr,ea,Xr,4),r(Ya,0,Xr,4);rs.Dd=fe(Ni,142)?fe(Ni,114)?fe(Ni,183)?1:3:2:0}if(uo.m.Ka)return Wn(Rr,7,"Premature end-of-partition0 encountered.");for(;Rr.ja<Rr.za;++Rr.ja){if(uo=Ei,Ni=(Zn=Rr).rb[Zn.sb-1],Gr=Zn.rb[Zn.sb+Zn.ja],yr=Zn.ya[Zn.aa+Zn.ja],ea=Zn.kc?yr.Ad:0)Ni.la=Gr.la=0,yr.Za||(Ni.Na=Gr.Na=0),yr.Hc=0,yr.Gc=0,yr.ia=0;else{var Ao,gs;if(Ni=Gr,Gr=uo,ea=Zn.Pa.Xc,Ya=Zn.ya[Zn.aa+Zn.ja],rs=Zn.pb[Ya.$b],dr=Ya.ad,ja=0,to=Zn.rb[Zn.sb-1],Xr=ta=0,r(dr,ja,0,384),Ya.Za)var Oo=0,Ml=ea[3];else{ps=s(16);var no=Ni.Na+to.Na;if(no=dp(Gr,ea[1],no,rs.Eb,0,ps,0),Ni.Na=to.Na=(0<no)+0,1<no)co(ps,0,dr,ja);else{var Pa=ps[0]+3>>3;for(ps=0;256>ps;ps+=16)dr[ja+ps]=Pa}Oo=1,Ml=ea[0]}var ms=15&Ni.la,fo=15&to.la;for(ps=0;4>ps;++ps){var gl=1&fo;for(Pa=gs=0;4>Pa;++Pa)ms=ms>>1|(gl=(no=dp(Gr,Ml,no=gl+(1&ms),rs.Sc,Oo,dr,ja))>Oo)<<7,gs=gs<<2|(3<no?3:1<no?2:dr[ja+0]!=0),ja+=16;ms>>=4,fo=fo>>1|gl<<7,ta=(ta<<8|gs)>>>0}for(Ml=ms,Oo=fo>>4,Ao=0;4>Ao;Ao+=2){for(gs=0,ms=Ni.la>>4+Ao,fo=to.la>>4+Ao,ps=0;2>ps;++ps){for(gl=1&fo,Pa=0;2>Pa;++Pa)no=gl+(1&ms),ms=ms>>1|(gl=0<(no=dp(Gr,ea[2],no,rs.Qc,0,dr,ja)))<<3,gs=gs<<2|(3<no?3:1<no?2:dr[ja+0]!=0),ja+=16;ms>>=2,fo=fo>>1|gl<<5}Xr|=gs<<4*Ao,Ml|=ms<<4<<Ao,Oo|=(240&fo)<<Ao}Ni.la=Ml,to.la=Oo,Ya.Hc=ta,Ya.Gc=Xr,Ya.ia=43690&Xr?0:rs.ia,ea=!(ta|Xr)}if(0<Zn.L&&(Zn.wa[Zn.Y+Zn.ja]=Zn.gd[yr.$b][yr.Za],Zn.wa[Zn.Y+Zn.ja].La|=!ea),uo.Ka)return Wn(Rr,7,"Premature end-of-file encountered.")}if(Dn(Rr),Zn=Ro,uo=1,yr=(Ei=Rr).D,Ni=0<Ei.L&&Ei.M>=Ei.zb&&Ei.M<=Ei.Va,Ei.Aa==0)t:{if(yr.M=Ei.M,yr.uc=Ni,eo(Ei,yr),uo=1,yr=(gs=Ei.D).Nb,Ni=(Xr=Pd[Ei.L])*Ei.R,Gr=Xr/2*Ei.B,ps=16*yr*Ei.R,Pa=8*yr*Ei.B,ea=Ei.sa,Ya=Ei.ta-Ni+ps,rs=Ei.qa,dr=Ei.ra-Gr+Pa,ja=Ei.Ha,to=Ei.Ia-Gr+Pa,fo=(ms=gs.M)==0,ta=ms>=Ei.Va-1,Ei.Aa==2&&eo(Ei,gs),gs.uc)for(gl=(no=Ei).D.M,e(no.D.uc),gs=no.yb;gs<no.Hb;++gs){Oo=gs,Ml=gl;var Na=(ml=(Wr=no).D).Nb;Ao=Wr.R;var ml=ml.wa[ml.Y+Oo],Rl=Wr.sa,Za=Wr.ta+16*Na*Ao+16*Oo,oc=ml.dd,bs=ml.tc;if(bs!=0)if(e(3<=bs),Wr.L==1)0<Oo&&Og(Rl,Za,Ao,bs+4),ml.La&&ic(Rl,Za,Ao,bs),0<Ml&&Rg(Rl,Za,Ao,bs+4),ml.La&&Gc(Rl,Za,Ao,bs);else{var yl=Wr.B,hs=Wr.qa,Ar=Wr.ra+8*Na*yl+8*Oo,Ms=Wr.Ha,Wr=Wr.Ia+8*Na*yl+8*Oo;Na=ml.ld,0<Oo&&(Jo(Rl,Za,Ao,bs+4,oc,Na),MA(hs,Ar,Ms,Wr,yl,bs+4,oc,Na)),ml.La&&(yw(Rl,Za,Ao,bs,oc,Na),Mg(hs,Ar,Ms,Wr,yl,bs,oc,Na)),0<Ml&&(Mo(Rl,Za,Ao,bs+4,oc,Na),ap(hs,Ar,Ms,Wr,yl,bs+4,oc,Na)),ml.La&&(RA(Rl,Za,Ao,bs,oc,Na),Fa(hs,Ar,Ms,Wr,yl,bs,oc,Na))}}if(Ei.ia&&alert("todo:DitherRow"),Zn.put!=null){if(gs=16*ms,ms=16*(ms+1),fo?(Zn.y=Ei.sa,Zn.O=Ei.ta+ps,Zn.f=Ei.qa,Zn.N=Ei.ra+Pa,Zn.ea=Ei.Ha,Zn.W=Ei.Ia+Pa):(gs-=Xr,Zn.y=ea,Zn.O=Ya,Zn.f=rs,Zn.N=dr,Zn.ea=ja,Zn.W=to),ta||(ms-=Xr),ms>Zn.o&&(ms=Zn.o),Zn.F=null,Zn.J=null,Ei.Fa!=null&&0<Ei.Fa.length&&gs<ms&&(Zn.J=Io(Ei,Zn,gs,ms-gs),Zn.F=Ei.mb,Zn.F==null&&Zn.F.length==0)){uo=Wn(Ei,3,"Could not decode alpha data.");break t}gs<Zn.j&&(Xr=Zn.j-gs,gs=Zn.j,e(!(1&Xr)),Zn.O+=Ei.R*Xr,Zn.N+=Ei.B*(Xr>>1),Zn.W+=Ei.B*(Xr>>1),Zn.F!=null&&(Zn.J+=Zn.width*Xr)),gs<ms&&(Zn.O+=Zn.v,Zn.N+=Zn.v>>1,Zn.W+=Zn.v>>1,Zn.F!=null&&(Zn.J+=Zn.v),Zn.ka=gs-Zn.j,Zn.U=Zn.va-Zn.v,Zn.T=ms-gs,uo=Zn.put(Zn))}yr+1!=Ei.Ic||ta||(i(Ei.sa,Ei.ta-Ni,ea,Ya+16*Ei.R,Ni),i(Ei.qa,Ei.ra-Gr,rs,dr+8*Ei.B,Gr),i(Ei.Ha,Ei.Ia-Gr,ja,to+8*Ei.B,Gr))}if(!uo)return Wn(Rr,6,"Output aborted.")}return 1})(Ke,St)),St.bc!=null&&St.bc(St),Nt&=1}return Nt?(Ke.cb=0,Nt):0})(N,de)||($=N.a)}}else $=N.a}$==0&&Fe.Oa!=null&&Fe.Oa.fd&&($=fl(Fe.ba))}Fe=$}Ee=Fe!=0?null:11>Ee?Pe.f.RGBA.eb:Pe.f.kb.y}else Ee=null;return Ee};var qg=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function h(_,I){for(var S="",F=0;F<4;F++)S+=String.fromCharCode(_[I++]);return S}function u(_,I){return _[I+0]|_[I+1]<<8}function d(_,I){return(_[I+0]|_[I+1]<<8|_[I+2]<<16)>>>0}function f(_,I){return(_[I+0]|_[I+1]<<8|_[I+2]<<16|_[I+3]<<24)>>>0}new c;var A=[0],g=[0],p=[],y=new c,v=n,m=(function(_,I){var S={},F=0,B=!1,E=0,V=0;if(S.frames=[],!(function(U,z){for(var q=0;q<4;q++)if(U[z+q]!="RIFF".charCodeAt(q))return!0;return!1})(_,I)){for(f(_,I+=4),I+=8;I<_.length;){var K=h(_,I),P=f(_,I+=4);I+=4;var M=P+(1&P);switch(K){case"VP8 ":case"VP8L":S.frames[F]===void 0&&(S.frames[F]={}),(Q=S.frames[F]).src_off=B?V:I-8,Q.src_size=E+P+8,F++,B&&(B=!1,E=0,V=0);break;case"VP8X":(Q=S.header={}).feature_flags=_[I];var X=I+4;Q.canvas_width=1+d(_,X),X+=3,Q.canvas_height=1+d(_,X),X+=3;break;case"ALPH":B=!0,E=M+8,V=I-8;break;case"ANIM":(Q=S.header).bgcolor=f(_,I),X=I+4,Q.loop_count=u(_,X),X+=2;break;case"ANMF":var Z,Q;(Q=S.frames[F]={}).offset_x=2*d(_,I),I+=3,Q.offset_y=2*d(_,I),I+=3,Q.width=1+d(_,I),I+=3,Q.height=1+d(_,I),I+=3,Q.duration=d(_,I),I+=3,Z=_[I++],Q.dispose=1&Z,Q.blend=Z>>1&1}K!="ANMF"&&(I+=M)}return S}})(v,0);m.response=v,m.rgbaoutput=!0,m.dataurl=!1;var w=m.header?m.header:null,x=m.frames?m.frames:null;if(w){w.loop_counter=w.loop_count,A=[w.canvas_height],g=[w.canvas_width];for(var T=0;T<x.length&&x[T].blend!=0;T++);}var j=x[0],D=y.WebPDecodeRGBA(v,j.src_off,j.src_size,g,A);j.rgba=D,j.imgwidth=g[0],j.imgheight=A[0];for(var b=0;b<g[0]*A[0]*4;b++)p[b]=D[b];return this.width=g,this.height=A,this.data=p,this}(function(n){var e,t,i,r,s,o,a,c,h,u=function(U){return U=U||{},this.isStrokeTransparent=U.isStrokeTransparent||!1,this.strokeOpacity=U.strokeOpacity||1,this.strokeStyle=U.strokeStyle||"#000000",this.fillStyle=U.fillStyle||"#000000",this.isFillTransparent=U.isFillTransparent||!1,this.fillOpacity=U.fillOpacity||1,this.font=U.font||"10px sans-serif",this.textBaseline=U.textBaseline||"alphabetic",this.textAlign=U.textAlign||"left",this.lineWidth=U.lineWidth||1,this.lineJoin=U.lineJoin||"miter",this.lineCap=U.lineCap||"butt",this.path=U.path||[],this.transform=U.transform!==void 0?U.transform.clone():new c,this.globalCompositeOperation=U.globalCompositeOperation||"normal",this.globalAlpha=U.globalAlpha||1,this.clip_path=U.clip_path||[],this.currentPoint=U.currentPoint||new o,this.miterLimit=U.miterLimit||10,this.lastPoint=U.lastPoint||new o,this.lineDashOffset=U.lineDashOffset||0,this.lineDash=U.lineDash||[],this.margin=U.margin||[0,0,0,0],this.prevPageLastElemOffset=U.prevPageLastElemOffset||0,this.ignoreClearRect=typeof U.ignoreClearRect!="boolean"||U.ignoreClearRect,this};n.events.push(["initialized",function(){this.context2d=new d(this),e=this.internal.f2,t=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString,r=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,a=this.internal.Rectangle,c=this.internal.Matrix,h=new u}]);var d=function(U){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var z=U;Object.defineProperty(this,"pdf",{get:function(){return z}});var q=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return q},set:function(W){q=!!W}});var G=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return G},set:function(W){G=!!W}});var ie=0;Object.defineProperty(this,"posX",{get:function(){return ie},set:function(W){isNaN(W)||(ie=W)}});var H=0;Object.defineProperty(this,"posY",{get:function(){return H},set:function(W){isNaN(W)||(H=W)}}),Object.defineProperty(this,"margin",{get:function(){return h.margin},set:function(W){var Y;typeof W=="number"?Y=[W,W,W,W]:((Y=new Array(4))[0]=W[0],Y[1]=W.length>=2?W[1]:Y[0],Y[2]=W.length>=3?W[2]:Y[0],Y[3]=W.length>=4?W[3]:Y[1]),h.margin=Y}});var se=!1;Object.defineProperty(this,"autoPaging",{get:function(){return se},set:function(W){se=W}});var te=0;Object.defineProperty(this,"lastBreak",{get:function(){return te},set:function(W){te=W}});var fe=[];Object.defineProperty(this,"pageBreaks",{get:function(){return fe},set:function(W){fe=W}}),Object.defineProperty(this,"ctx",{get:function(){return h},set:function(W){W instanceof u&&(h=W)}}),Object.defineProperty(this,"path",{get:function(){return h.path},set:function(W){h.path=W}});var ye=[];Object.defineProperty(this,"ctxStack",{get:function(){return ye},set:function(W){ye=W}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(W){var Y;Y=f(W),this.ctx.fillStyle=Y.style,this.ctx.isFillTransparent=Y.a===0,this.ctx.fillOpacity=Y.a,this.pdf.setFillColor(Y.r,Y.g,Y.b,{a:Y.a}),this.pdf.setTextColor(Y.r,Y.g,Y.b,{a:Y.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(W){var Y=f(W);this.ctx.strokeStyle=Y.style,this.ctx.isStrokeTransparent=Y.a===0,this.ctx.strokeOpacity=Y.a,Y.a===0?this.pdf.setDrawColor(255,255,255):(Y.a,this.pdf.setDrawColor(Y.r,Y.g,Y.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(W){["butt","round","square"].indexOf(W)!==-1&&(this.ctx.lineCap=W,this.pdf.setLineCap(W))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(W){isNaN(W)||(this.ctx.lineWidth=W,this.pdf.setLineWidth(W))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(W){["bevel","round","miter"].indexOf(W)!==-1&&(this.ctx.lineJoin=W,this.pdf.setLineJoin(W))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(W){isNaN(W)||(this.ctx.miterLimit=W,this.pdf.setMiterLimit(W))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(W){this.ctx.textBaseline=W}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(W){["right","end","center","left","start"].indexOf(W)!==-1&&(this.ctx.textAlign=W)}});var be=null,_e=null;Object.defineProperty(this,"fontFaces",{get:function(){return _e},set:function(W){be=null,_e=W}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(W){var Y;if(this.ctx.font=W,(Y=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(W))!==null){var ve=Y[1];Y[2];var ce=Y[3],ne=Y[4];Y[5];var he=Y[6],xe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ne)[2];ne=Math.floor(xe==="px"?parseFloat(ne)*this.pdf.internal.scaleFactor:xe==="em"?parseFloat(ne)*this.pdf.getFontSize():parseFloat(ne)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ne);var Te=(function(De){var Ge,Re,Ie=[],Le=De.trim();if(Le==="")return n4;if(Le in jN)return[jN[Le]];for(;Le!=="";){switch(Re=null,Ge=(Le=NN(Le)).charAt(0)){case'"':case"'":Re=Jpe(Le.substring(1),Ge);break;default:Re=ege(Le)}if(Re===null||(Ie.push(Re[0]),(Le=NN(Re[1]))!==""&&Le.charAt(0)!==","))return n4;Le=Le.replace(/^,/,"")}return Ie})(he);if(this.fontFaces){var Ce=(function(De,Ge){if(be===null){var Re=(function(Ie){var Le=[];return Object.keys(Ie).forEach(function(et){Ie[et].forEach(function(ct){var mt=null;switch(ct){case"bold":mt={family:et,weight:"bold"};break;case"italic":mt={family:et,style:"italic"};break;case"bolditalic":mt={family:et,weight:"bold",style:"italic"};break;case"":case"normal":mt={family:et}}mt!==null&&(mt.ref={name:et,style:ct},Le.push(mt))})}),Le})(De.getFontList());be=(function(Ie){for(var Le={},et=0;et<Ie.length;++et){var ct=t4(Ie[et]),mt=ct.family,je=ct.stretch,le=ct.style,Je=ct.weight;Le[mt]=Le[mt]||{},Le[mt][je]=Le[mt][je]||{},Le[mt][je][le]=Le[mt][je][le]||{},Le[mt][je][le][Je]=ct}return Le})(Re.concat(Ge))}return be})(this.pdf,this.fontFaces),Be=Te.map(function(De){return{family:De,stretch:"normal",weight:ce,style:ve}}),Ye=(function(De,Ge,Re){for(var Ie=(Re=Re||{}).defaultFontFamily||"times",Le=Object.assign({},Zpe,Re.genericFontFamilies||{}),et=null,ct=null,mt=0;mt<Ge.length;++mt)if(Le[(et=t4(Ge[mt])).family]&&(et.family=Le[et.family]),De.hasOwnProperty(et.family)){ct=De[et.family];break}if(!(ct=ct||De[Ie]))throw new Error("Could not find a font-family for the rule '"+PN(et)+"' and default family '"+Ie+"'.");if(ct=(function(je,le){if(le[je])return le[je];var Je=NE[je],ht=Je<=NE.normal?-1:1,ut=DN(le,IV,Je,ht);if(!ut)throw new Error("Could not find a matching font-stretch value for "+je);return ut})(et.stretch,ct),ct=(function(je,le){if(le[je])return le[je];for(var Je=kV[je],ht=0;ht<Je.length;++ht)if(le[Je[ht]])return le[Je[ht]];throw new Error("Could not find a matching font-style for "+je)})(et.style,ct),!(ct=(function(je,le){if(le[je])return le[je];if(je===400&&le[500])return le[500];if(je===500&&le[400])return le[400];var Je=Ype[je],ht=DN(le,FV,Je,je<400?-1:1);if(!ht)throw new Error("Could not find a matching font-weight for value "+je);return ht})(et.weight,ct)))throw new Error("Failed to resolve a font for the rule '"+PN(et)+"'.");return ct})(Ce,Be);this.pdf.setFont(Ye.ref.name,Ye.ref.style)}else{var $e="";(ce==="bold"||parseInt(ce,10)>=700||ve==="bold")&&($e="bold"),ve==="italic"&&($e+="italic"),$e.length===0&&($e="normal");for(var ot="",rt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ve=0;Ve<Te.length;Ve++){if(this.pdf.internal.getFont(Te[Ve],$e,{noFallback:!0,disableWarning:!0})!==void 0){ot=Te[Ve];break}if($e==="bolditalic"&&this.pdf.internal.getFont(Te[Ve],"bold",{noFallback:!0,disableWarning:!0})!==void 0)ot=Te[Ve],$e="bold";else if(this.pdf.internal.getFont(Te[Ve],"normal",{noFallback:!0,disableWarning:!0})!==void 0){ot=Te[Ve],$e="normal";break}}if(ot===""){for(var We=0;We<Te.length;We++)if(rt[Te[We]]){ot=rt[Te[We]];break}}ot=ot===""?"Times":ot,this.pdf.setFont(ot,$e)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(W){this.ctx.globalCompositeOperation=W}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(W){this.ctx.globalAlpha=W}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(W){this.ctx.lineDashOffset=W,Q.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(W){this.ctx.lineDash=W,Q.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(W){this.ctx.ignoreClearRect=!!W}})};d.prototype.setLineDash=function(U){this.lineDash=U},d.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},d.prototype.fill=function(){x.call(this,"fill",!1)},d.prototype.stroke=function(){x.call(this,"stroke",!1)},d.prototype.beginPath=function(){this.path=[{type:"begin"}]},d.prototype.moveTo=function(U,z){if(isNaN(U)||isNaN(z))throw Gs.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var q=this.ctx.transform.applyToPoint(new o(U,z));this.path.push({type:"mt",x:q.x,y:q.y}),this.ctx.lastPoint=new o(U,z)},d.prototype.closePath=function(){var U=new o(0,0),z=0;for(z=this.path.length-1;z!==-1;z--)if(this.path[z].type==="begin"&&Ds(this.path[z+1])==="object"&&typeof this.path[z+1].x=="number"){U=new o(this.path[z+1].x,this.path[z+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(U.x,U.y)},d.prototype.lineTo=function(U,z){if(isNaN(U)||isNaN(z))throw Gs.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var q=this.ctx.transform.applyToPoint(new o(U,z));this.path.push({type:"lt",x:q.x,y:q.y}),this.ctx.lastPoint=new o(q.x,q.y)},d.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),x.call(this,null,!0)},d.prototype.quadraticCurveTo=function(U,z,q,G){if(isNaN(q)||isNaN(G)||isNaN(U)||isNaN(z))throw Gs.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ie=this.ctx.transform.applyToPoint(new o(q,G)),H=this.ctx.transform.applyToPoint(new o(U,z));this.path.push({type:"qct",x1:H.x,y1:H.y,x:ie.x,y:ie.y}),this.ctx.lastPoint=new o(ie.x,ie.y)},d.prototype.bezierCurveTo=function(U,z,q,G,ie,H){if(isNaN(ie)||isNaN(H)||isNaN(U)||isNaN(z)||isNaN(q)||isNaN(G))throw Gs.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var se=this.ctx.transform.applyToPoint(new o(ie,H)),te=this.ctx.transform.applyToPoint(new o(U,z)),fe=this.ctx.transform.applyToPoint(new o(q,G));this.path.push({type:"bct",x1:te.x,y1:te.y,x2:fe.x,y2:fe.y,x:se.x,y:se.y}),this.ctx.lastPoint=new o(se.x,se.y)},d.prototype.arc=function(U,z,q,G,ie,H){if(isNaN(U)||isNaN(z)||isNaN(q)||isNaN(G)||isNaN(ie))throw Gs.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(H=!!H,!this.ctx.transform.isIdentity){var se=this.ctx.transform.applyToPoint(new o(U,z));U=se.x,z=se.y;var te=this.ctx.transform.applyToPoint(new o(0,q)),fe=this.ctx.transform.applyToPoint(new o(0,0));q=Math.sqrt(Math.pow(te.x-fe.x,2)+Math.pow(te.y-fe.y,2))}Math.abs(ie-G)>=2*Math.PI&&(G=0,ie=2*Math.PI),this.path.push({type:"arc",x:U,y:z,radius:q,startAngle:G,endAngle:ie,counterclockwise:H})},d.prototype.arcTo=function(U,z,q,G,ie){throw new Error("arcTo not implemented.")},d.prototype.rect=function(U,z,q,G){if(isNaN(U)||isNaN(z)||isNaN(q)||isNaN(G))throw Gs.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(U,z),this.lineTo(U+q,z),this.lineTo(U+q,z+G),this.lineTo(U,z+G),this.lineTo(U,z),this.lineTo(U+q,z),this.lineTo(U,z)},d.prototype.fillRect=function(U,z,q,G){if(isNaN(U)||isNaN(z)||isNaN(q)||isNaN(G))throw Gs.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!A.call(this)){var ie={};this.lineCap!=="butt"&&(ie.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ie.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(U,z,q,G),this.fill(),ie.hasOwnProperty("lineCap")&&(this.lineCap=ie.lineCap),ie.hasOwnProperty("lineJoin")&&(this.lineJoin=ie.lineJoin)}},d.prototype.strokeRect=function(U,z,q,G){if(isNaN(U)||isNaN(z)||isNaN(q)||isNaN(G))throw Gs.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");g.call(this)||(this.beginPath(),this.rect(U,z,q,G),this.stroke())},d.prototype.clearRect=function(U,z,q,G){if(isNaN(U)||isNaN(z)||isNaN(q)||isNaN(G))throw Gs.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(U,z,q,G))},d.prototype.save=function(U){U=typeof U!="boolean"||U;for(var z=this.pdf.internal.getCurrentPageInfo().pageNumber,q=0;q<this.pdf.internal.getNumberOfPages();q++)this.pdf.setPage(q+1),this.pdf.internal.out("q");if(this.pdf.setPage(z),U){this.ctx.fontSize=this.pdf.internal.getFontSize();var G=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=G}},d.prototype.restore=function(U){U=typeof U!="boolean"||U;for(var z=this.pdf.internal.getCurrentPageInfo().pageNumber,q=0;q<this.pdf.internal.getNumberOfPages();q++)this.pdf.setPage(q+1),this.pdf.internal.out("Q");this.pdf.setPage(z),U&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},d.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var f=function(U){var z,q,G,ie;if(U.isCanvasGradient===!0&&(U=U.getColor()),!U)return{r:0,g:0,b:0,a:0,style:U};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(U))z=0,q=0,G=0,ie=0;else{var H=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(U);if(H!==null)z=parseInt(H[1]),q=parseInt(H[2]),G=parseInt(H[3]),ie=1;else if((H=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(U))!==null)z=parseInt(H[1]),q=parseInt(H[2]),G=parseInt(H[3]),ie=parseFloat(H[4]);else{if(ie=1,typeof U=="string"&&U.charAt(0)!=="#"){var se=new bV(U);U=se.ok?se.toHex():"#000000"}U.length===4?(z=U.substring(1,2),z+=z,q=U.substring(2,3),q+=q,G=U.substring(3,4),G+=G):(z=U.substring(1,3),q=U.substring(3,5),G=U.substring(5,7)),z=parseInt(z,16),q=parseInt(q,16),G=parseInt(G,16)}}return{r:z,g:q,b:G,a:ie,style:U}},A=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},g=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};d.prototype.fillText=function(U,z,q,G){if(isNaN(z)||isNaN(q)||typeof U!="string")throw Gs.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(G=isNaN(G)?void 0:G,!A.call(this)){var ie=M(this.ctx.transform.rotation),H=this.ctx.transform.scaleX;F.call(this,{text:U,x:z,y:q,scale:H,angle:ie,align:this.textAlign,maxWidth:G})}},d.prototype.strokeText=function(U,z,q,G){if(isNaN(z)||isNaN(q)||typeof U!="string")throw Gs.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!g.call(this)){G=isNaN(G)?void 0:G;var ie=M(this.ctx.transform.rotation),H=this.ctx.transform.scaleX;F.call(this,{text:U,x:z,y:q,scale:H,renderingMode:"stroke",angle:ie,align:this.textAlign,maxWidth:G})}},d.prototype.measureText=function(U){if(typeof U!="string")throw Gs.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var z=this.pdf,q=this.pdf.internal.scaleFactor,G=z.internal.getFontSize(),ie=z.getStringUnitWidth(U)*G/z.internal.scaleFactor;return new function(H){var se=(H=H||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return se}}),this}({width:ie*=Math.round(96*q/72*1e4)/1e4})},d.prototype.scale=function(U,z){if(isNaN(U)||isNaN(z))throw Gs.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var q=new c(U,0,0,z,0,0);this.ctx.transform=this.ctx.transform.multiply(q)},d.prototype.rotate=function(U){if(isNaN(U))throw Gs.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var z=new c(Math.cos(U),Math.sin(U),-Math.sin(U),Math.cos(U),0,0);this.ctx.transform=this.ctx.transform.multiply(z)},d.prototype.translate=function(U,z){if(isNaN(U)||isNaN(z))throw Gs.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var q=new c(1,0,0,1,U,z);this.ctx.transform=this.ctx.transform.multiply(q)},d.prototype.transform=function(U,z,q,G,ie,H){if(isNaN(U)||isNaN(z)||isNaN(q)||isNaN(G)||isNaN(ie)||isNaN(H))throw Gs.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var se=new c(U,z,q,G,ie,H);this.ctx.transform=this.ctx.transform.multiply(se)},d.prototype.setTransform=function(U,z,q,G,ie,H){U=isNaN(U)?1:U,z=isNaN(z)?0:z,q=isNaN(q)?0:q,G=isNaN(G)?1:G,ie=isNaN(ie)?0:ie,H=isNaN(H)?0:H,this.ctx.transform=new c(U,z,q,G,ie,H)};var p=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};d.prototype.drawImage=function(U,z,q,G,ie,H,se,te,fe){var ye=this.pdf.getImageProperties(U),be=1,_e=1,W=1,Y=1;G!==void 0&&te!==void 0&&(W=te/G,Y=fe/ie,be=ye.width/G*te/G,_e=ye.height/ie*fe/ie),H===void 0&&(H=z,se=q,z=0,q=0),G!==void 0&&te===void 0&&(te=G,fe=ie),G===void 0&&te===void 0&&(te=ye.width,fe=ye.height);for(var ve,ce=this.ctx.transform.decompose(),ne=M(ce.rotate.shx),he=new c,xe=(he=(he=(he=he.multiply(ce.translate)).multiply(ce.skew)).multiply(ce.scale)).applyToRectangle(new a(H-z*W,se-q*Y,G*be,ie*_e)),Te=y.call(this,xe),Ce=[],Be=0;Be<Te.length;Be+=1)Ce.indexOf(Te[Be])===-1&&Ce.push(Te[Be]);if(w(Ce),this.autoPaging)for(var Ye=Ce[0],$e=Ce[Ce.length-1],ot=Ye;ot<$e+1;ot++){this.pdf.setPage(ot);var rt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ve=ot===1?this.posY+this.margin[0]:this.margin[0],We=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],De=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ge=ot===1?0:We+(ot-2)*De;if(this.ctx.clip_path.length!==0){var Re=this.path;ve=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=m(ve,this.posX+this.margin[3],-Ge+Ve+this.ctx.prevPageLastElemOffset),T.call(this,"fill",!0),this.path=Re}var Ie=JSON.parse(JSON.stringify(xe));Ie=m([Ie],this.posX+this.margin[3],-Ge+Ve+this.ctx.prevPageLastElemOffset)[0];var Le=(ot>Ye||ot<$e)&&p.call(this);Le&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],rt,De,null).clip().discardPath()),this.pdf.addImage(U,"JPEG",Ie.x,Ie.y,Ie.w,Ie.h,null,null,ne),Le&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(U,"JPEG",xe.x,xe.y,xe.w,xe.h,null,null,ne)};var y=function(U,z,q){var G=[];z=z||this.pdf.internal.pageSize.width,q=q||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ie=this.posY+this.ctx.prevPageLastElemOffset;switch(U.type){default:case"mt":case"lt":G.push(Math.floor((U.y+ie)/q)+1);break;case"arc":G.push(Math.floor((U.y+ie-U.radius)/q)+1),G.push(Math.floor((U.y+ie+U.radius)/q)+1);break;case"qct":var H=X(this.ctx.lastPoint.x,this.ctx.lastPoint.y,U.x1,U.y1,U.x,U.y);G.push(Math.floor((H.y+ie)/q)+1),G.push(Math.floor((H.y+H.h+ie)/q)+1);break;case"bct":var se=Z(this.ctx.lastPoint.x,this.ctx.lastPoint.y,U.x1,U.y1,U.x2,U.y2,U.x,U.y);G.push(Math.floor((se.y+ie)/q)+1),G.push(Math.floor((se.y+se.h+ie)/q)+1);break;case"rect":G.push(Math.floor((U.y+ie)/q)+1),G.push(Math.floor((U.y+U.h+ie)/q)+1)}for(var te=0;te<G.length;te+=1)for(;this.pdf.internal.getNumberOfPages()<G[te];)v.call(this);return G},v=function(){var U=this.fillStyle,z=this.strokeStyle,q=this.font,G=this.lineCap,ie=this.lineWidth,H=this.lineJoin;this.pdf.addPage(),this.fillStyle=U,this.strokeStyle=z,this.font=q,this.lineCap=G,this.lineWidth=ie,this.lineJoin=H},m=function(U,z,q){for(var G=0;G<U.length;G++)switch(U[G].type){case"bct":U[G].x2+=z,U[G].y2+=q;case"qct":U[G].x1+=z,U[G].y1+=q;default:U[G].x+=z,U[G].y+=q}return U},w=function(U){return U.sort(function(z,q){return z-q})},x=function(U,z){for(var q,G,ie=this.fillStyle,H=this.strokeStyle,se=this.lineCap,te=this.lineWidth,fe=Math.abs(te*this.ctx.transform.scaleX),ye=this.lineJoin,be=JSON.parse(JSON.stringify(this.path)),_e=JSON.parse(JSON.stringify(this.path)),W=[],Y=0;Y<_e.length;Y++)if(_e[Y].x!==void 0)for(var ve=y.call(this,_e[Y]),ce=0;ce<ve.length;ce+=1)W.indexOf(ve[ce])===-1&&W.push(ve[ce]);for(var ne=0;ne<W.length;ne++)for(;this.pdf.internal.getNumberOfPages()<W[ne];)v.call(this);if(w(W),this.autoPaging)for(var he=W[0],xe=W[W.length-1],Te=he;Te<xe+1;Te++){this.pdf.setPage(Te),this.fillStyle=ie,this.strokeStyle=H,this.lineCap=se,this.lineWidth=fe,this.lineJoin=ye;var Ce=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Be=Te===1?this.posY+this.margin[0]:this.margin[0],Ye=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],$e=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ot=Te===1?0:Ye+(Te-2)*$e;if(this.ctx.clip_path.length!==0){var rt=this.path;q=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=m(q,this.posX+this.margin[3],-ot+Be+this.ctx.prevPageLastElemOffset),T.call(this,U,!0),this.path=rt}if(G=JSON.parse(JSON.stringify(be)),this.path=m(G,this.posX+this.margin[3],-ot+Be+this.ctx.prevPageLastElemOffset),z===!1||Te===0){var Ve=(Te>he||Te<xe)&&p.call(this);Ve&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ce,$e,null).clip().discardPath()),T.call(this,U,z),Ve&&this.pdf.restoreGraphicsState()}this.lineWidth=te}else this.lineWidth=fe,T.call(this,U,z),this.lineWidth=te;this.path=be},T=function(U,z){if((U!=="stroke"||z||!g.call(this))&&(U==="stroke"||z||!A.call(this))){for(var q,G,ie=[],H=this.path,se=0;se<H.length;se++){var te=H[se];switch(te.type){case"begin":ie.push({begin:!0});break;case"close":ie.push({close:!0});break;case"mt":ie.push({start:te,deltas:[],abs:[]});break;case"lt":var fe=ie.length;if(H[se-1]&&!isNaN(H[se-1].x)&&(q=[te.x-H[se-1].x,te.y-H[se-1].y],fe>0)){for(;fe>=0;fe--)if(ie[fe-1].close!==!0&&ie[fe-1].begin!==!0){ie[fe-1].deltas.push(q),ie[fe-1].abs.push(te);break}}break;case"bct":q=[te.x1-H[se-1].x,te.y1-H[se-1].y,te.x2-H[se-1].x,te.y2-H[se-1].y,te.x-H[se-1].x,te.y-H[se-1].y],ie[ie.length-1].deltas.push(q);break;case"qct":var ye=H[se-1].x+2/3*(te.x1-H[se-1].x),be=H[se-1].y+2/3*(te.y1-H[se-1].y),_e=te.x+2/3*(te.x1-te.x),W=te.y+2/3*(te.y1-te.y),Y=te.x,ve=te.y;q=[ye-H[se-1].x,be-H[se-1].y,_e-H[se-1].x,W-H[se-1].y,Y-H[se-1].x,ve-H[se-1].y],ie[ie.length-1].deltas.push(q);break;case"arc":ie.push({deltas:[],abs:[],arc:!0}),Array.isArray(ie[ie.length-1].abs)&&ie[ie.length-1].abs.push(te)}}G=z?null:U==="stroke"?"stroke":"fill";for(var ce=!1,ne=0;ne<ie.length;ne++)if(ie[ne].arc)for(var he=ie[ne].abs,xe=0;xe<he.length;xe++){var Te=he[xe];Te.type==="arc"?b.call(this,Te.x,Te.y,Te.radius,Te.startAngle,Te.endAngle,Te.counterclockwise,void 0,z,!ce):B.call(this,Te.x,Te.y),ce=!0}else if(ie[ne].close===!0)this.pdf.internal.out("h"),ce=!1;else if(ie[ne].begin!==!0){var Ce=ie[ne].start.x,Be=ie[ne].start.y;E.call(this,ie[ne].deltas,Ce,Be),ce=!0}G&&_.call(this,G),z&&I.call(this)}},j=function(U){var z=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,q=z*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return U-q;case"top":return U+z-q;case"hanging":return U+z-2*q;case"middle":return U+z/2-q;default:return U}},D=function(U){return U+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};d.prototype.createLinearGradient=function(){var U=function(){};return U.colorStops=[],U.addColorStop=function(z,q){this.colorStops.push([z,q])},U.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},U.isCanvasGradient=!0,U},d.prototype.createPattern=function(){return this.createLinearGradient()},d.prototype.createRadialGradient=function(){return this.createLinearGradient()};var b=function(U,z,q,G,ie,H,se,te,fe){for(var ye=K.call(this,q,G,ie,H),be=0;be<ye.length;be++){var _e=ye[be];be===0&&(fe?S.call(this,_e.x1+U,_e.y1+z):B.call(this,_e.x1+U,_e.y1+z)),V.call(this,U,z,_e.x2,_e.y2,_e.x3,_e.y3,_e.x4,_e.y4)}te?I.call(this):_.call(this,se)},_=function(U){switch(U){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},I=function(){this.pdf.clip(),this.pdf.discardPath()},S=function(U,z){this.pdf.internal.out(t(U)+" "+i(z)+" m")},F=function(U){var z;switch(U.align){case"right":case"end":z="right";break;case"center":z="center";break;default:z="left"}var q=this.pdf.getTextDimensions(U.text),G=j.call(this,U.y),ie=D.call(this,G)-q.h,H=this.ctx.transform.applyToPoint(new o(U.x,G)),se=this.ctx.transform.decompose(),te=new c;te=(te=(te=te.multiply(se.translate)).multiply(se.skew)).multiply(se.scale);for(var fe,ye,be,_e=this.ctx.transform.applyToRectangle(new a(U.x,G,q.w,q.h)),W=te.applyToRectangle(new a(U.x,ie,q.w,q.h)),Y=y.call(this,W),ve=[],ce=0;ce<Y.length;ce+=1)ve.indexOf(Y[ce])===-1&&ve.push(Y[ce]);if(w(ve),this.autoPaging)for(var ne=ve[0],he=ve[ve.length-1],xe=ne;xe<he+1;xe++){this.pdf.setPage(xe);var Te=xe===1?this.posY+this.margin[0]:this.margin[0],Ce=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Be=this.pdf.internal.pageSize.height-this.margin[2],Ye=Be-this.margin[0],$e=this.pdf.internal.pageSize.width-this.margin[1],ot=$e-this.margin[3],rt=xe===1?0:Ce+(xe-2)*Ye;if(this.ctx.clip_path.length!==0){var Ve=this.path;fe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=m(fe,this.posX+this.margin[3],-1*rt+Te),T.call(this,"fill",!0),this.path=Ve}var We=m([JSON.parse(JSON.stringify(W))],this.posX+this.margin[3],-rt+Te+this.ctx.prevPageLastElemOffset)[0];U.scale>=.01&&(ye=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ye*U.scale),be=this.lineWidth,this.lineWidth=be*U.scale);var De=this.autoPaging!=="text";if(De||We.y+We.h<=Be){if(De||We.y>=Te&&We.x<=$e){var Ge=De?U.text:this.pdf.splitTextToSize(U.text,U.maxWidth||$e-We.x)[0],Re=m([JSON.parse(JSON.stringify(_e))],this.posX+this.margin[3],-rt+Te+this.ctx.prevPageLastElemOffset)[0],Ie=De&&(xe>ne||xe<he)&&p.call(this);Ie&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ot,Ye,null).clip().discardPath()),this.pdf.text(Ge,Re.x,Re.y,{angle:U.angle,align:z,renderingMode:U.renderingMode}),Ie&&this.pdf.restoreGraphicsState()}}else We.y<Be&&(this.ctx.prevPageLastElemOffset+=Be-We.y);U.scale>=.01&&(this.pdf.setFontSize(ye),this.lineWidth=be)}else U.scale>=.01&&(ye=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ye*U.scale),be=this.lineWidth,this.lineWidth=be*U.scale),this.pdf.text(U.text,H.x+this.posX,H.y+this.posY,{angle:U.angle,align:z,renderingMode:U.renderingMode,maxWidth:U.maxWidth}),U.scale>=.01&&(this.pdf.setFontSize(ye),this.lineWidth=be)},B=function(U,z,q,G){q=q||0,G=G||0,this.pdf.internal.out(t(U+q)+" "+i(z+G)+" l")},E=function(U,z,q){return this.pdf.lines(U,z,q,null,null)},V=function(U,z,q,G,ie,H,se,te){this.pdf.internal.out([e(r(q+U)),e(s(G+z)),e(r(ie+U)),e(s(H+z)),e(r(se+U)),e(s(te+z)),"c"].join(" "))},K=function(U,z,q,G){for(var ie=2*Math.PI,H=Math.PI/2;z>q;)z-=ie;var se=Math.abs(q-z);se<ie&&G&&(se=ie-se);for(var te=[],fe=G?-1:1,ye=z;se>1e-5;){var be=ye+fe*Math.min(se,H);te.push(P.call(this,U,ye,be)),se-=Math.abs(be-ye),ye=be}return te},P=function(U,z,q){var G=(q-z)/2,ie=U*Math.cos(G),H=U*Math.sin(G),se=ie,te=-H,fe=se*se+te*te,ye=fe+se*ie+te*H,be=4/3*(Math.sqrt(2*fe*ye)-ye)/(se*H-te*ie),_e=se-be*te,W=te+be*se,Y=_e,ve=-W,ce=G+z,ne=Math.cos(ce),he=Math.sin(ce);return{x1:U*Math.cos(z),y1:U*Math.sin(z),x2:_e*ne-W*he,y2:_e*he+W*ne,x3:Y*ne-ve*he,y3:Y*he+ve*ne,x4:U*Math.cos(q),y4:U*Math.sin(q)}},M=function(U){return 180*U/Math.PI},X=function(U,z,q,G,ie,H){var se=U+.5*(q-U),te=z+.5*(G-z),fe=ie+.5*(q-ie),ye=H+.5*(G-H),be=Math.min(U,ie,se,fe),_e=Math.max(U,ie,se,fe),W=Math.min(z,H,te,ye),Y=Math.max(z,H,te,ye);return new a(be,W,_e-be,Y-W)},Z=function(U,z,q,G,ie,H,se,te){var fe,ye,be,_e,W,Y,ve,ce,ne,he,xe,Te,Ce,Be,Ye=q-U,$e=G-z,ot=ie-q,rt=H-G,Ve=se-ie,We=te-H;for(ye=0;ye<41;ye++)ne=(ve=(be=U+(fe=ye/40)*Ye)+fe*((W=q+fe*ot)-be))+fe*(W+fe*(ie+fe*Ve-W)-ve),he=(ce=(_e=z+fe*$e)+fe*((Y=G+fe*rt)-_e))+fe*(Y+fe*(H+fe*We-Y)-ce),ye==0?(xe=ne,Te=he,Ce=ne,Be=he):(xe=Math.min(xe,ne),Te=Math.min(Te,he),Ce=Math.max(Ce,ne),Be=Math.max(Be,he));return new a(Math.round(xe),Math.round(Te),Math.round(Ce-xe),Math.round(Be-Te))},Q=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var U,z,q=(U=this.ctx.lineDash,z=this.ctx.lineDashOffset,JSON.stringify({lineDash:U,lineDashOffset:z}));this.prevLineDash!==q&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=q)}}})(Di.API),(function(n){var e=function(o){var a,c,h,u,d,f,A,g,p,y;for(c=[],h=0,u=(o+=a="\0\0\0\0".slice(o.length%4||4)).length;u>h;h+=4)(d=(o.charCodeAt(h)<<24)+(o.charCodeAt(h+1)<<16)+(o.charCodeAt(h+2)<<8)+o.charCodeAt(h+3))!==0?(f=(d=((d=((d=((d=(d-(y=d%85))/85)-(p=d%85))/85)-(g=d%85))/85)-(A=d%85))/85)%85,c.push(f+33,A+33,g+33,p+33,y+33)):c.push(122);return(function(v,m){for(var w=m;w>0;w--)v.pop()})(c,a.length),String.fromCharCode.apply(String,c)+"~>"},t=function(o){var a,c,h,u,d,f=String,A="length",g=255,p="charCodeAt",y="slice",v="replace";for(o[y](-2),o=o[y](0,-2)[v](/\s/g,"")[v]("z","!!!!!"),h=[],u=0,d=(o+=a="uuuuu"[y](o[A]%5||5))[A];d>u;u+=5)c=52200625*(o[p](u)-33)+614125*(o[p](u+1)-33)+7225*(o[p](u+2)-33)+85*(o[p](u+3)-33)+(o[p](u+4)-33),h.push(g&c>>24,g&c>>16,g&c>>8,g&c);return(function(m,w){for(var x=w;x>0;x--)m.pop()})(h,a[A]),f.fromCharCode.apply(f,h)},i=function(o){return o.split("").map(function(a){return("0"+a.charCodeAt().toString(16)).slice(-2)}).join("")+">"},r=function(o){var a=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),a.test(o)===!1)return"";for(var c="",h=0;h<o.length;h+=2)c+=String.fromCharCode("0x"+(o[h]+o[h+1]));return c},s=function(o){for(var a=new Uint8Array(o.length),c=o.length;c--;)a[c]=o.charCodeAt(c);return(a=EE(a)).reduce(function(h,u){return h+String.fromCharCode(u)},"")};n.processDataByFilters=function(o,a){var c=0,h=o||"",u=[];for(typeof(a=a||[])=="string"&&(a=[a]),c=0;c<a.length;c+=1)switch(a[c]){case"ASCII85Decode":case"/ASCII85Decode":h=t(h),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":h=e(h),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":h=r(h),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":h=i(h),u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":h=s(h),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+a[c]+'" is not implemented')}return{data:h,reverseChain:u.reverse().join(" ")}}})(Di.API),(function(n){n.loadFile=function(e,t,i){return(function(r,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var a=void 0;try{a=(function(c,h,u){var d=new XMLHttpRequest,f=0,A=function(g){var p=g.length,y=[],v=String.fromCharCode;for(f=0;f<p;f+=1)y.push(v(255&g.charCodeAt(f)));return y.join("")};if(d.open("GET",c,!h),d.overrideMimeType("text/plain; charset=x-user-defined"),h===!1&&(d.onload=function(){d.status===200?u(A(this.responseText)):u(void 0)}),d.send(null),h&&d.status===200)return A(d.responseText)})(r,s,o)}catch{}return a})(e,t,i)},n.loadImageFile=n.loadFile})(Di.API),(function(n){function e(){return(hr.html2canvas?Promise.resolve(hr.html2canvas):ca(()=>Promise.resolve().then(()=>$ye),void 0)).catch(function(a){return Promise.reject(new Error("Could not load html2canvas: "+a))}).then(function(a){return a.default?a.default:a})}function t(){return(hr.DOMPurify?Promise.resolve(hr.DOMPurify):ca(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load dompurify: "+a))}).then(function(a){return a.default?a.default:a})}var i=function(a){var c=Ds(a);return c==="undefined"?"undefined":c==="string"||a instanceof String?"string":c==="number"||a instanceof Number?"number":c==="function"||a instanceof Function?"function":a&&a.constructor===Array?"array":a&&a.nodeType===1?"element":c==="object"?"object":"unknown"},r=function(a,c){var h=document.createElement(a);for(var u in c.className&&(h.className=c.className),c.innerHTML&&c.dompurify&&(h.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)h.style[u]=c.style[u];return h},s=function a(c,h){for(var u=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),d=c.firstChild;d;d=d.nextSibling)h!==!0&&d.nodeType===1&&d.nodeName==="SCRIPT"||u.appendChild(a(d,h));return c.nodeType===1&&(c.nodeName==="CANVAS"?(u.width=c.width,u.height=c.height,u.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(u.value=c.value),u.addEventListener("load",function(){u.scrollTop=c.scrollTop,u.scrollLeft=c.scrollLeft},!0)),u},o=function a(c){var h=Object.assign(a.convert(Promise.resolve()),JSON.parse(JSON.stringify(a.template))),u=a.convert(Promise.resolve(),h);return(u=u.setProgress(1,a,1,[a])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(a,c){return a.__proto__=c||o.prototype,a},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(a,c){return this.then(function(){switch(c=c||(function(h){switch(i(h)){case"string":return"string";case"element":return h.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(a),c){case"string":return this.then(t).then(function(h){return this.set({src:r("div",{innerHTML:a,dompurify:h})})});case"element":return this.set({src:a});case"canvas":return this.set({canvas:a});case"img":return this.set({img:a});default:return this.error("Unknown source type.")}})},o.prototype.to=function(a){switch(a){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var a={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(a.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=r("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=r("div",{className:"html2pdf__container",style:a}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(r("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(e).then(function(c){var h=Object.assign({},this.opt.html2canvas);return delete h.onrendered,c(this.prop.container,h)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(e).then(function(c){var h=this.opt.jsPDF,u=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,f=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete f.onrendered,h.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,h.context2d.posX=this.opt.x,h.context2d.posY=this.opt.y,h.context2d.margin=this.opt.margin,h.context2d.fontFaces=u,u)for(var A=0;A<u.length;++A){var g=u[A],p=g.src.find(function(y){return y.format==="truetype"});p&&h.addFont(p.url,g.ref.name,g.ref.style)}return f.windowHeight=f.windowHeight||0,f.windowHeight=f.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):f.windowHeight,h.context2d.save(!0),c(this.prop.container,f)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var a=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=a})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(a,c,h){return(h=h||"pdf").toLowerCase()==="img"||h.toLowerCase()==="image"?this.outputImg(a,c):this.outputPdf(a,c)},o.prototype.outputPdf=function(a,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(a,c)})},o.prototype.outputImg=function(a){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(a){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+a+'" is not supported.'}})},o.prototype.save=function(a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(a?{filename:a}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(a){if(i(a)!=="object")return this;var c=Object.keys(a||{}).map(function(h){if(h in o.template.prop)return function(){this.prop[h]=a[h]};switch(h){case"margin":return this.setMargin.bind(this,a.margin);case"jsPDF":return function(){return this.opt.jsPDF=a.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,a.pageSize);default:return function(){this.opt[h]=a[h]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(a,c){return this.then(function(){var h=a in o.template.prop?this.prop[a]:this.opt[a];return c?c(h):h})},o.prototype.setMargin=function(a){return this.then(function(){switch(i(a)){case"number":a=[a,a,a,a];case"array":if(a.length===2&&(a=[a[0],a[1],a[0],a[1]]),a.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=a}).then(this.setPageSize)},o.prototype.setPageSize=function(a){function c(h,u){return Math.floor(h*u/72*96)}return this.then(function(){(a=a||Di.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(a.inner={width:a.width-this.opt.margin[1]-this.opt.margin[3],height:a.height-this.opt.margin[0]-this.opt.margin[2]},a.inner.px={width:c(a.inner.width,a.k),height:c(a.inner.height,a.k)},a.inner.ratio=a.inner.height/a.inner.width),this.prop.pageSize=a})},o.prototype.setProgress=function(a,c,h,u){return a!=null&&(this.progress.val=a),c!=null&&(this.progress.state=c),h!=null&&(this.progress.n=h),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(a,c,h,u){return this.setProgress(a?this.progress.val+a:null,c||null,h?this.progress.n+h:null,u?this.progress.stack.concat(u):null)},o.prototype.then=function(a,c){var h=this;return this.thenCore(a,c,function(u,d){return h.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(f){return h.updateProgress(null,u),f}).then(u,d).then(function(f){return h.updateProgress(1),f})})},o.prototype.thenCore=function(a,c,h){h=h||Promise.prototype.then;var u=this;a&&(a=a.bind(u)),c&&(c=c.bind(u));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?u:o.convert(Object.assign({},u),Promise.prototype),f=h.call(d,a,c);return o.convert(f,u.__proto__)},o.prototype.thenExternal=function(a,c){return Promise.prototype.then.call(this,a,c)},o.prototype.thenList=function(a){var c=this;return a.forEach(function(h){c=c.thenCore(h)}),c},o.prototype.catch=function(a){a&&(a=a.bind(this));var c=Promise.prototype.catch.call(this,a);return o.convert(c,this)},o.prototype.catchExternal=function(a){return Promise.prototype.catch.call(this,a)},o.prototype.error=function(a){return this.then(function(){throw new Error(a)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,Di.getPageSize=function(a,c,h){if(Ds(a)==="object"){var u=a;a=u.orientation,c=u.unit||c,h=u.format||h}c=c||"mm",h=h||"a4",a=(""+(a||"P")).toLowerCase();var d,f=(""+h).toLowerCase(),A={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+c}var g,p=0,y=0;if(A.hasOwnProperty(f))p=A[f][1]/d,y=A[f][0]/d;else try{p=h[1],y=h[0]}catch{throw new Error("Invalid format: "+h)}if(a==="p"||a==="portrait")a="p",y>p&&(g=y,y=p,p=g);else{if(a!=="l"&&a!=="landscape")throw"Invalid orientation: "+a;a="l",p>y&&(g=y,y=p,p=g)}return{width:y,height:p,unit:c,k:d,orientation:a}},n.html=function(a,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(t4):null;var h=new o(c);return c.worker?h:h.from(a).doCallback()}})(Di.API),Di.API.addJS=function(n){return MN=n,this.internal.events.subscribe("postPutResources",function(){Ex=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Ex+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),LN=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+MN+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Ex!==void 0&&LN!==void 0&&this.internal.out("/Names <</JavaScript "+Ex+" 0 R>>")}),this},(function(n){var e;n.events.push(["postPutResources",function(){var t=this,i=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=t.outline.render().split(/\r\n/),s=0;s<r.length;s++){var o=r[s],a=i.exec(o);if(a!=null){var c=a[1];t.internal.newObjectDeferredBegin(c,!1)}t.internal.write(o)}if(this.outline.createNamedDestinations){var h=this.internal.pages.length,u=[];for(s=0;s<h;s++){var d=t.internal.newObject();u.push(d);var f=t.internal.getPageInfo(s+1);t.internal.write("<< /D["+f.objId+" 0 R /XYZ null null null]>> endobj")}var A=t.internal.newObject();for(t.internal.write("<< /Names [ "),s=0;s<u.length;s++)t.internal.write("(page_"+(s+1)+")"+u[s]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+A+" 0 R"),t.internal.write(">>","endobj")}}]),n.events.push(["putCatalog",function(){var t=this;t.outline.root.children.length>0&&(t.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&t.internal.write("/Names "+e+" 0 R"))}]),n.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(i,r,s){var o={title:r,options:s,children:[]};return i==null&&(i=this.root),i.children.push(o),o},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(i){i.id=t.internal.newObjectDeferred();for(var r=0;r<i.children.length;r++)this.genIds_r(i.children[r])},t.outline.renderRoot=function(i){this.objStart(i),this.line("/Type /Outlines"),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1]))),this.line("/Count "+this.count_r({count:0},i)),this.objEnd()},t.outline.renderItems=function(i){for(var r=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<i.children.length;s++){var o=i.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(i)),s>0&&this.line("/Prev "+this.makeRef(i.children[s-1])),s<i.children.length-1&&this.line("/Next "+this.makeRef(i.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var a=this.count=this.count_r({count:0},o);if(a>0&&this.line("/Count "+a),o.options&&o.options.pageNumber){var c=t.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+r(0)+" 0]")}this.objEnd()}for(var h=0;h<i.children.length;h++)this.renderItems(i.children[h])},t.outline.line=function(i){this.ctx.val+=i+`\r
`},t.outline.makeRef=function(i){return i.id+" 0 R"},t.outline.makeString=function(i){return"("+t.internal.pdfEscape(i)+")"},t.outline.objStart=function(i){this.ctx.val+=`\r
`+i.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(i,r){for(var s=0;s<r.children.length;s++)i.count++,this.count_r(i,r.children[s]);return i.count}}])})(Di.API),(function(n){var e=[192,193,194,195,196,197,198,199];n.processJPEG=function(t,i,r,s,o,a){var c,h=this.decode.DCT_DECODE,u=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=o||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,c=(function(d){for(var f,A=256*d.charCodeAt(4)+d.charCodeAt(5),g=d.length,p={width:0,height:0,numcomponents:1},y=4;y<g;y+=2){if(y+=A,e.indexOf(d.charCodeAt(y+1))!==-1){f=256*d.charCodeAt(y+5)+d.charCodeAt(y+6),p={width:256*d.charCodeAt(y+7)+d.charCodeAt(y+8),height:f,numcomponents:d.charCodeAt(y+9)};break}A=256*d.charCodeAt(y+2)+d.charCodeAt(y+3)}return p})(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t),c.numcomponents){case 1:a=this.color_spaces.DEVICE_GRAY;break;case 4:a=this.color_spaces.DEVICE_CMYK;break;case 3:a=this.color_spaces.DEVICE_RGB}u={data:t,width:c.width,height:c.height,colorSpace:a,bitsPerComponent:8,filter:h,index:i,alias:r}}return u}})(Di.API),Di.API.processPNG=function(n,e,t,i){if(this.__addimage__.isArrayBuffer(n)&&(n=new Uint8Array(n)),this.__addimage__.isArrayBufferView(n)){var r,s=Mpe(n,{checkCrc:!0}),o=s.width,a=s.height,c=s.channels,h=s.palette,u=s.depth;r=h&&c===1?(function(D){for(var b=D.width,_=D.height,I=D.data,S=D.palette,F=D.depth,B=!1,E=[],V=[],K=void 0,P=!1,M=0,X=0;X<S.length;X++){var Z=HP(S[X],4),Q=Z[0],U=Z[1],z=Z[2],q=Z[3];E.push(Q,U,z),q!=null&&(q===0?(M++,V.length<1&&V.push(X)):q<255&&(P=!0))}if(P||M>1){B=!0,V=void 0;var G=b*_;K=new Uint8Array(G);for(var ie=new DataView(I.buffer),H=0;H<G;H++){var se=i4(ie,H,F),te=HP(S[se],4)[3];K[H]=te}}return{colorSpace:"Indexed",colorsPerPixel:1,colorBytes:I,alphaBytes:K,needSMask:B,palette:E,mask:V}})(s):c===2||c===4?(function(D){for(var b=D.data,_=D.width,I=D.height,S=D.channels,F=D.depth,B=S===2?"DeviceGray":"DeviceRGB",E=S-1,V=_*I,K=E,P=V*K,M=1*V,X=Math.ceil(P*F/8),Z=Math.ceil(M*F/8),Q=new Uint8Array(X),U=new Uint8Array(Z),z=new DataView(b.buffer),q=new DataView(Q.buffer),G=new DataView(U.buffer),ie=!1,H=0;H<V;H++){for(var se=H*S,te=0;te<K;te++)zN(q,i4(z,se+te,F),H*K+te,F);var fe=i4(z,se+K,F);fe<(1<<F)-1&&(ie=!0),zN(G,fe,1*H,F)}return{colorSpace:B,colorsPerPixel:E,colorBytes:Q,alphaBytes:U,needSMask:ie}})(s):(function(D){var b=D.data,_=D.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:_,colorsPerPixel:_==="DeviceGray"?1:3,colorBytes:b instanceof Uint8Array?b:new Uint8Array(b.buffer),needSMask:!1}})(s);var d,f,A,g=r,p=g.colorSpace,y=g.colorsPerPixel,v=g.colorBytes,m=g.alphaBytes,w=g.needSMask,x=g.palette,T=g.mask,j=null;return i!==Di.API.image_compression.NONE&&typeof EE=="function"?(j=(function(D){var b;switch(D){case Di.API.image_compression.FAST:b=11;break;case Di.API.image_compression.MEDIUM:b=13;break;case Di.API.image_compression.SLOW:b=14;break;default:b=12}return b})(i),d=this.decode.FLATE_DECODE,f="/Predictor ".concat(j," "),n=HN(v,o*y,y,i),w&&(A=HN(m,o,1,i))):(d=void 0,f="",n=v,w&&(A=m)),f+="/Colors ".concat(y," /BitsPerComponent ").concat(u," /Columns ").concat(o),(this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n))&&(n=this.__addimage__.arrayBufferToBinaryString(n)),(A&&this.__addimage__.isArrayBuffer(A)||this.__addimage__.isArrayBufferView(A))&&(A=this.__addimage__.arrayBufferToBinaryString(A)),{alias:t,data:n,index:e,filter:d,decodeParameters:f,transparency:T,palette:x,sMask:A,predictor:j,width:o,height:a,bitsPerComponent:u,colorSpace:p}}},(function(n){n.processGIF89A=function(e,t,i,r){var s=new rge(e),o=s.width,a=s.height,c=[];s.decodeAndBlitFrameRGBA(0,c);var h={data:c,width:o,height:a},u=new r4(100).encode(h,100);return n.processJPEG.call(this,u,t,i,r)},n.processGIF87A=n.processGIF89A})(Di.API),au.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var n=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(n);for(var e=0;e<n;e++){var t=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:r,green:i,blue:t,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},au.prototype.parseBGR=function(){this.pos=this.offset;try{var n="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[n]()}catch(t){Gs.log("bit decode error:"+t)}},au.prototype.bit1=function(){var n,e=Math.ceil(this.width/8),t=e%4;for(n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,r=0;r<e;r++)for(var s=this.datav.getUint8(this.pos++,!0),o=i*this.width*4+8*r*4,a=0;a<8&&8*r+a<this.width;a++){var c=this.palette[s>>7-a&1];this.data[o+4*a]=c.blue,this.data[o+4*a+1]=c.green,this.data[o+4*a+2]=c.red,this.data[o+4*a+3]=255}t!==0&&(this.pos+=4-t)}},au.prototype.bit4=function(){for(var n=Math.ceil(this.width/2),e=n%4,t=this.height-1;t>=0;t--){for(var i=this.bottom_up?t:this.height-1-t,r=0;r<n;r++){var s=this.datav.getUint8(this.pos++,!0),o=i*this.width*4+2*r*4,a=s>>4,c=15&s,h=this.palette[a];if(this.data[o]=h.blue,this.data[o+1]=h.green,this.data[o+2]=h.red,this.data[o+3]=255,2*r+1>=this.width)break;h=this.palette[c],this.data[o+4]=h.blue,this.data[o+4+1]=h.green,this.data[o+4+2]=h.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},au.prototype.bit8=function(){for(var n=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,i=0;i<this.width;i++){var r=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*i;if(r<this.palette.length){var o=this.palette[r];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}n!==0&&(this.pos+=4-n)}},au.prototype.bit15=function(){for(var n=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var i=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&e)/e*255|0,a=(s>>5&e)/e*255|0,c=(s>>10&e)/e*255|0,h=s>>15?255:0,u=i*this.width*4+4*r;this.data[u]=c,this.data[u+1]=a,this.data[u+2]=o,this.data[u+3]=h}this.pos+=n}},au.prototype.bit16=function(){for(var n=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),i=this.height-1;i>=0;i--){for(var r=this.bottom_up?i:this.height-1-i,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(o&e)/e*255|0,c=(o>>5&t)/t*255|0,h=(o>>11)/e*255|0,u=r*this.width*4+4*s;this.data[u]=h,this.data[u+1]=c,this.data[u+2]=a,this.data[u+3]=255}this.pos+=n}},au.prototype.bit24=function(){for(var n=this.height-1;n>=0;n--){for(var e=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var i=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*t;this.data[o]=s,this.data[o+1]=r,this.data[o+2]=i,this.data[o+3]=255}this.pos+=this.width%4}},au.prototype.bit32=function(){for(var n=this.height-1;n>=0;n--)for(var e=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var i=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*t;this.data[a]=s,this.data[a+1]=r,this.data[a+2]=i,this.data[a+3]=o}},au.prototype.getData=function(){return this.data},(function(n){n.processBMP=function(e,t,i,r){var s=new au(e,!1),o=s.width,a=s.height,c={data:s.getData(),width:o,height:a},h=new r4(100).encode(c,100);return n.processJPEG.call(this,h,t,i,r)}})(Di.API),XN.prototype.getData=function(){return this.data},(function(n){n.processWEBP=function(e,t,i,r){var s=new XN(e),o=s.width,a=s.height,c={data:s.getData(),width:o,height:a},h=new r4(100).encode(c,100);return n.processJPEG.call(this,h,t,i,r)}})(Di.API),Di.API.processRGBA=function(n,e,t){for(var i=n.data,r=i.length,s=new Uint8Array(r/4*3),o=new Uint8Array(r/4),a=0,c=0,h=0;h<r;h+=4){var u=i[h],d=i[h+1],f=i[h+2],A=i[h+3];s[a++]=u,s[a++]=d,s[a++]=f,o[c++]=A}var g=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:g,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:n.width,height:n.height}},Di.API.setLanguage=function(n){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[n]!==void 0&&(this.internal.languageSettings.languageCode=n,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},a0=Di.API,kx=a0.getCharWidthsArray=function(n,e){var t,i,r=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),a=e.widths?e.widths:r.metadata.Unicode.widths,c=a.fof?a.fof:1,h=e.kerning?e.kerning:r.metadata.Unicode.kerning,u=h.fof?h.fof:1,d=e.doKerning!==!1,f=0,A=n.length,g=0,p=a[0]||c,y=[];for(t=0;t<A;t++)i=n.charCodeAt(t),typeof r.metadata.widthOfString=="function"?y.push((r.metadata.widthOfGlyph(r.metadata.characterToGlyph(i))+o*(1e3/s)||0)/1e3):(f=d&&Ds(h[i])==="object"&&!isNaN(parseInt(h[i][g],10))?h[i][g]/u:0,y.push((a[i]||p)/c+f)),g=i;return y},RN=a0.getStringUnitWidth=function(n,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),i=e.font||this.internal.getFont(),r=e.charSpace||this.internal.getCharSpace();return a0.processArabic&&(n=a0.processArabic(n)),typeof i.metadata.widthOfString=="function"?i.metadata.widthOfString(n,t,r)/t:kx.apply(this,arguments).reduce(function(s,o){return s+o},0)},ON=function(n,e,t,i){for(var r=[],s=0,o=n.length,a=0;s!==o&&a+e[s]<t;)a+=e[s],s++;r.push(n.slice(0,s));var c=s;for(a=0;s!==o;)a+e[s]>i&&(r.push(n.slice(c,s)),a=0,c=s),a+=e[s],s++;return c!==s&&r.push(n.slice(c,s)),r},UN=function(n,e,t){t||(t={});var i,r,s,o,a,c,h,u=[],d=[u],f=t.textIndent||0,A=0,g=0,p=n.split(" "),y=kx.apply(this,[" ",t])[0];if(c=t.lineIndent===-1?p[0].length+2:t.lineIndent||0){var v=Array(c).join(" "),m=[];p.map(function(x){(x=x.split(/\s*\n/)).length>1?m=m.concat(x.map(function(T,j){return(j&&T.length?`
`:"")+T})):m.push(x[0])}),p=m,c=RN.apply(this,[v,t])}for(s=0,o=p.length;s<o;s++){var w=0;if(i=p[s],c&&i[0]==`
`&&(i=i.substr(1),w=1),f+A+(g=(r=kx.apply(this,[i,t])).reduce(function(x,T){return x+T},0))>e||w){if(g>e){for(a=ON.apply(this,[i,r,e-(f+A),e]),u.push(a.shift()),u=[a.pop()];a.length;)d.push([a.shift()]);g=r.slice(i.length-(u[0]?u[0].length:0)).reduce(function(x,T){return x+T},0)}else u=[i];d.push(u),f=g+c,A=y}else u.push(i),f+=A+g,A=y}return h=c?function(x,T){return(T?v:"")+x.join(" ")}:function(x){return x.join(" ")},d.map(h)},a0.splitTextToSize=function(n,e,t){var i,r=(t=t||{}).fontSize||this.internal.getFontSize(),s=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var d=this.internal.getFont(u.fontName,u.fontStyle),f="Unicode";return d.metadata[f]?{widths:d.metadata[f].widths||{0:1},kerning:d.metadata[f].kerning||{}}:{font:d.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);i=Array.isArray(n)?n:String(n).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/r;s.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/r:0,s.lineIndent=t.lineIndent;var a,c,h=[];for(a=0,c=i.length;a<c;a++)h=h.concat(UN.apply(this,[i[a],o,s]));return h},(function(n){n.__fontmetrics__=n.__fontmetrics__||{};for(var e="0123456789abcdef",t="klmnopqrstuvwxyz",i={},r={},s=0;s<16;s++)i[t[s]]=e[s],r[e[s]]=t[s];var o=function(f){return"0x"+parseInt(f,10).toString(16)},a=n.__fontmetrics__.compress=function(f){var A,g,p,y,v=["{"];for(var m in f){if(A=f[m],isNaN(parseInt(m,10))?g="'"+m+"'":(m=parseInt(m,10),g=(g=o(m).slice(2)).slice(0,-1)+r[g.slice(-1)]),typeof A=="number")A<0?(p=o(A).slice(3),y="-"):(p=o(A).slice(2),y=""),p=y+p.slice(0,-1)+r[p.slice(-1)];else{if(Ds(A)!=="object")throw new Error("Don't know what to do with value type "+Ds(A)+".");p=a(A)}v.push(g+p)}return v.push("}"),v.join("")},c=n.__fontmetrics__.uncompress=function(f){if(typeof f!="string")throw new Error("Invalid argument passed to uncompress.");for(var A,g,p,y,v={},m=1,w=v,x=[],T="",j="",D=f.length-1,b=1;b<D;b+=1)(y=f[b])=="'"?A?(p=A.join(""),A=void 0):A=[]:A?A.push(y):y=="{"?(x.push([w,p]),w={},p=void 0):y=="}"?((g=x.pop())[0][g[1]]=w,p=void 0,w=g[0]):y=="-"?m=-1:p===void 0?i.hasOwnProperty(y)?(T+=i[y],p=parseInt(T,16)*m,m=1,T=""):T+=y:i.hasOwnProperty(y)?(j+=i[y],w[p]=parseInt(j,16)*m,m=1,p=void 0,j=""):j+=y;return v},h={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:h,"Courier-Bold":h,"Courier-BoldOblique":h,"Courier-Oblique":h,Helvetica:h,"Helvetica-Bold":h,"Helvetica-BoldOblique":h,"Helvetica-Oblique":h,"Times-Roman":h,"Times-Bold":h,"Times-BoldItalic":h,"Times-Italic":h}},d={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};n.events.push(["addFont",function(f){var A=f.font,g=d.Unicode[A.postScriptName];g&&(A.metadata.Unicode={},A.metadata.Unicode.widths=g.widths,A.metadata.Unicode.kerning=g.kerning);var p=u.Unicode[A.postScriptName];p&&(A.metadata.Unicode.encoding=p,A.encoding=p.codePages[0])}])})(Di.API),(function(n){var e=function(t){for(var i=t.length,r=new Uint8Array(i),s=0;s<i;s++)r[s]=t.charCodeAt(s);return r};n.API.events.push(["addFont",function(t){var i=void 0,r=t.font,s=t.instance;if(!r.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");if(typeof(i=s.existsFileInVFS(r.postScriptName)===!1?s.loadFile(r.postScriptName):s.getFileFromVFS(r.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");(function(o,a){a=/^\x00\x01\x00\x00/.test(a)?e(a):e(Kb(a)),o.metadata=n.API.TTFFont.open(a),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(r,i)}}])})(Di),Di.API.addSvgAsImage=function(n,e,t,i,r,s,o,a){if(isNaN(e)||isNaN(t))throw Gs.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(r))throw Gs.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=i,c.height=r;var h=c.getContext("2d");h.fillStyle="#fff",h.fillRect(0,0,c.width,c.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},d=this;return(hr.canvg?Promise.resolve(hr.canvg):ca(()=>import("./index.es-_8I2UGtw.js"),__vite__mapDeps([5,1,2,3,4]))).catch(function(f){return Promise.reject(new Error("Could not load canvg: "+f))}).then(function(f){return f.default?f.default:f}).then(function(f){return f.fromString(h,n,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(f){return f.render(u)}).then(function(){d.addImage(c.toDataURL("image/jpeg",1),e,t,i,r,o,a)})},Di.API.putTotalPages=function(n){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(n,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(n,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var i=1;i<=this.internal.getNumberOfPages();i++)for(var r=0;r<this.internal.pages[i].length;r++)this.internal.pages[i][r]=this.internal.pages[i][r].replace(e,t);return this},Di.API.viewerPreferences=function(n,e){var t;n=n||{},e=e||!1;var i,r,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},a=Object.keys(o),c=[],h=0,u=0,d=0;function f(g,p){var y,v=!1;for(y=0;y<g.length;y+=1)g[y]===p&&(v=!0);return v}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,n==="reset"||e===!0){var A=a.length;for(d=0;d<A;d+=1)t[a[d]].value=t[a[d]].defaultValue,t[a[d]].explicitSet=!1}if(Ds(n)==="object"){for(r in n)if(s=n[r],f(a,r)&&s!==void 0){if(t[r].type==="boolean"&&typeof s=="boolean")t[r].value=s;else if(t[r].type==="name"&&f(t[r].valueSet,s))t[r].value=s;else if(t[r].type==="integer"&&Number.isInteger(s))t[r].value=s;else if(t[r].type==="array"){for(h=0;h<s.length;h+=1)if(i=!0,s[h].length===1&&typeof s[h][0]=="number")c.push(String(s[h]-1));else if(s[h].length>1){for(u=0;u<s[h].length;u+=1)typeof s[h][u]!="number"&&(i=!1);i===!0&&c.push([s[h][0]-1,s[h][1]-1].join(" "))}t[r].value="["+c.join(" ")+"]"}else t[r].value=t[r].defaultValue;t[r].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var g,p=[];for(g in t)t[g].explicitSet===!0&&(t[g].type==="name"?p.push("/"+g+" /"+t[g].value):p.push("/"+g+" "+t[g].value));p.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+p.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},(function(n){var e=function(){var i='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',r=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(i)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),a=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),h=s.length+o.length+a.length+r.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+h+" >>"),this.internal.write("stream"),this.internal.write(r+s+o+a+c),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};n.addMetadata=function(i,r){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:i,namespaceuri:r||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}})(Di.API),(function(n){var e=n.API,t=e.pdfEscape16=function(s,o){for(var a,c=o.metadata.Unicode.widths,h=["","0","00","000","0000"],u=[""],d=0,f=s.length;d<f;++d){if(a=o.metadata.characterToGlyph(s.charCodeAt(d)),o.metadata.glyIdsUsed.push(a),o.metadata.toUnicode[a]=s.charCodeAt(d),c.indexOf(a)==-1&&(c.push(a),c.push([parseInt(o.metadata.widthOfGlyph(a),10)])),a=="0")return u.join("");a=a.toString(16),u.push(h[4-a.length],a)}return u.join("")},i=function(s){var o,a,c,h,u,d,f;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],d=0,f=(a=Object.keys(s).sort(function(A,g){return A-g})).length;d<f;d++)o=a[d],c.length>=100&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(h=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+h+">"));return c.length&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),u+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(o){var a=o.font,c=o.out,h=o.newObject,u=o.putStream;if(a.metadata instanceof n.API.TTFFont&&a.encoding==="Identity-H"){for(var d=a.metadata.Unicode.widths,f=a.metadata.subset.encode(a.metadata.glyIdsUsed,1),A="",g=0;g<f.length;g++)A+=String.fromCharCode(f[g]);var p=h();u({data:A,addLength1:!0,objectId:p}),c("endobj");var y=h();u({data:i(a.metadata.toUnicode),addLength1:!0,objectId:y}),c("endobj");var v=h();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+I0(a.fontName)),c("/FontFile2 "+p+" 0 R"),c("/FontBBox "+n.API.PDFObject.convert(a.metadata.bbox)),c("/Flags "+a.metadata.flags),c("/StemV "+a.metadata.stemV),c("/ItalicAngle "+a.metadata.italicAngle),c("/Ascent "+a.metadata.ascender),c("/Descent "+a.metadata.decender),c("/CapHeight "+a.metadata.capHeight),c(">>"),c("endobj");var m=h();c("<<"),c("/Type /Font"),c("/BaseFont /"+I0(a.fontName)),c("/FontDescriptor "+v+" 0 R"),c("/W "+n.API.PDFObject.convert(d)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+a.encoding+")"),c(">>"),c(">>"),c("endobj"),a.objectNumber=h(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+y+" 0 R"),c("/BaseFont /"+I0(a.fontName)),c("/Encoding /"+a.encoding),c("/DescendantFonts ["+m+" 0 R]"),c(">>"),c("endobj"),a.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(o){var a=o.font,c=o.out,h=o.newObject,u=o.putStream;if(a.metadata instanceof n.API.TTFFont&&a.encoding==="WinAnsiEncoding"){for(var d=a.metadata.rawData,f="",A=0;A<d.length;A++)f+=String.fromCharCode(d[A]);var g=h();u({data:f,addLength1:!0,objectId:g}),c("endobj");var p=h();u({data:i(a.metadata.toUnicode),addLength1:!0,objectId:p}),c("endobj");var y=h();c("<<"),c("/Descent "+a.metadata.decender),c("/CapHeight "+a.metadata.capHeight),c("/StemV "+a.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+g+" 0 R"),c("/Flags 96"),c("/FontBBox "+n.API.PDFObject.convert(a.metadata.bbox)),c("/FontName /"+I0(a.fontName)),c("/ItalicAngle "+a.metadata.italicAngle),c("/Ascent "+a.metadata.ascender),c(">>"),c("endobj"),a.objectNumber=h();for(var v=0;v<a.metadata.hmtx.widths.length;v++)a.metadata.hmtx.widths[v]=parseInt(a.metadata.hmtx.widths[v]*(1e3/a.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+p+" 0 R/BaseFont/"+I0(a.fontName)+"/FontDescriptor "+y+" 0 R/Encoding/"+a.encoding+" /FirstChar 29 /LastChar 255 /Widths "+n.API.PDFObject.convert(a.metadata.hmtx.widths)+">>"),c("endobj"),a.isAlreadyPutted=!0}})(s)}]);var r=function(s){var o,a=s.text||"",c=s.x,h=s.y,u=s.options||{},d=s.mutex||{},f=d.pdfEscape,A=d.activeFontKey,g=d.fonts,p=A,y="",v=0,m="",w=g[p].encoding;if(g[p].encoding!=="Identity-H")return{text:a,x:c,y:h,options:u,mutex:d};for(m=a,p=A,Array.isArray(a)&&(m=a[0]),v=0;v<m.length;v+=1)g[p].metadata.hasOwnProperty("cmap")&&(o=g[p].metadata.cmap.unicode.codeMap[m[v].charCodeAt(0)]),o||m[v].charCodeAt(0)<256&&g[p].metadata.hasOwnProperty("Unicode")?y+=m[v]:y+="";var x="";return parseInt(p.slice(1))<14||w==="WinAnsiEncoding"?x=f(y,p).split("").map(function(T){return T.charCodeAt(0).toString(16)}).join(""):w==="Identity-H"&&(x=t(y,g[p])),d.isHex=!0,{text:x,x:c,y:h,options:u,mutex:d}};e.events.push(["postProcessText",function(s){var o=s.text||"",a=[],c={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var h=0;for(h=0;h<o.length;h+=1)Array.isArray(o[h])&&o[h].length===3?a.push([r(Object.assign({},c,{text:o[h][0]})).text,o[h][1],o[h][2]]):a.push(r(Object.assign({},c,{text:o[h]})).text);s.text=a}else s.text=r(Object.assign({},c,{text:o})).text}])})(Di),(function(n){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};n.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},n.addFileToVFS=function(t,i){return e.call(this),this.internal.vFS[t]=i,this},n.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}})(Di.API),(function(n){n.__bidiEngine__=n.prototype.__bidiEngine__=function(i){var r,s,o,a,c,h,u,d=e,f=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],A=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],g={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},p={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},y=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],v=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),m=!1,w=0;this.__bidiEngine__={};var x=function(S){var F=S.charCodeAt(),B=F>>8,E=p[B];return E!==void 0?d[256*E+(255&F)]:B===252||B===253?"AL":v.test(B)?"L":B===8?"R":"N"},T=function(S){for(var F,B=0;B<S.length;B++){if((F=x(S.charAt(B)))==="L")return!1;if(F==="R")return!0}return!1},j=function(S,F,B,E){var V,K,P,M,X=F[E];switch(X){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":m=!1;break;case"N":case"AN":break;case"EN":m&&(X="AN");break;case"AL":m=!0,X="R";break;case"WS":case"BN":X="N";break;case"CS":E<1||E+1>=F.length||(V=B[E-1])!=="EN"&&V!=="AN"||(K=F[E+1])!=="EN"&&K!=="AN"?X="N":m&&(K="AN"),X=K===V?K:"N";break;case"ES":X=(V=E>0?B[E-1]:"B")==="EN"&&E+1<F.length&&F[E+1]==="EN"?"EN":"N";break;case"ET":if(E>0&&B[E-1]==="EN"){X="EN";break}if(m){X="N";break}for(P=E+1,M=F.length;P<M&&F[P]==="ET";)P++;X=P<M&&F[P]==="EN"?"EN":"N";break;case"NSM":if(o&&!a){for(M=F.length,P=E+1;P<M&&F[P]==="NSM";)P++;if(P<M){var Z=S[E],Q=Z>=1425&&Z<=2303||Z===64286;if(V=F[P],Q&&(V==="R"||V==="AL")){X="R";break}}}X=E<1||(V=F[E-1])==="B"?"N":B[E-1];break;case"B":m=!1,r=!0,X=w;break;case"S":s=!0,X="N"}return X},D=function(S,F,B){var E=S.split("");return B&&b(E,B,{hiLevel:w}),E.reverse(),F&&F.reverse(),E.join("")},b=function(S,F,B){var E,V,K,P,M,X=-1,Z=S.length,Q=0,U=[],z=w?A:f,q=[];for(m=!1,r=!1,s=!1,V=0;V<Z;V++)q[V]=x(S[V]);for(K=0;K<Z;K++){if(M=Q,U[K]=j(S,q,U,K),E=240&(Q=z[M][g[U[K]]]),Q&=15,F[K]=P=z[Q][5],E>0)if(E===16){for(V=X;V<K;V++)F[V]=1;X=-1}else X=-1;if(z[Q][6])X===-1&&(X=K);else if(X>-1){for(V=X;V<K;V++)F[V]=P;X=-1}q[K]==="B"&&(F[K]=0),B.hiLevel|=P}s&&(function(G,ie,H){for(var se=0;se<H;se++)if(G[se]==="S"){ie[se]=w;for(var te=se-1;te>=0&&G[te]==="WS";te--)ie[te]=w}})(q,F,Z)},_=function(S,F,B,E,V){if(!(V.hiLevel<S)){if(S===1&&w===1&&!r)return F.reverse(),void(B&&B.reverse());for(var K,P,M,X,Z=F.length,Q=0;Q<Z;){if(E[Q]>=S){for(M=Q+1;M<Z&&E[M]>=S;)M++;for(X=Q,P=M-1;X<P;X++,P--)K=F[X],F[X]=F[P],F[P]=K,B&&(K=B[X],B[X]=B[P],B[P]=K);Q=M}Q++}}},I=function(S,F,B){var E=S.split(""),V={hiLevel:w};return B||(B=[]),b(E,B,V),(function(K,P,M){if(M.hiLevel!==0&&u)for(var X,Z=0;Z<K.length;Z++)P[Z]===1&&(X=y.indexOf(K[Z]))>=0&&(K[Z]=y[X+1])})(E,B,V),_(2,E,F,B,V),_(1,E,F,B,V),E.join("")};return this.__bidiEngine__.doBidiReorder=function(S,F,B){if((function(V,K){if(K)for(var P=0;P<V.length;P++)K[P]=P;a===void 0&&(a=T(V)),h===void 0&&(h=T(V))})(S,F),o||!c||h)if(o&&c&&a^h)w=a?1:0,S=D(S,F,B);else if(!o&&c&&h)w=a?1:0,S=I(S,F,B),S=D(S,F);else if(!o||a||c||h){if(o&&!c&&a^h)S=D(S,F),a?(w=0,S=I(S,F,B)):(w=1,S=I(S,F,B),S=D(S,F));else if(o&&a&&!c&&h)w=1,S=I(S,F,B),S=D(S,F);else if(!o&&!c&&a^h){var E=u;a?(w=1,S=I(S,F,B),w=0,u=!1,S=I(S,F,B),u=E):(w=0,S=I(S,F,B),S=D(S,F),w=1,u=!1,S=I(S,F,B),u=E,S=D(S,F))}}else w=0,S=I(S,F,B);else w=a?1:0,S=I(S,F,B);return S},this.__bidiEngine__.setOptions=function(S){S&&(o=S.isInputVisual,c=S.isOutputVisual,a=S.isInputRtl,h=S.isOutputRtl,u=S.isSymmetricSwapping)},this.__bidiEngine__.setOptions(i),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new n.__bidiEngine__({isInputVisual:!0});n.API.events.push(["postProcessText",function(i){var r=i.text;i.x,i.y;var s=i.options||{};i.mutex,s.lang;var o=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,t.setOptions(s),Object.prototype.toString.call(r)==="[object Array]"){var a=0;for(o=[],a=0;a<r.length;a+=1)Object.prototype.toString.call(r[a])==="[object Array]"?o.push([t.doBidiReorder(r[a][0]),r[a][1],r[a][2]]):o.push([t.doBidiReorder(r[a])]);i.text=o}else i.text=t.doBidiReorder(r);t.setOptions({isInputVisual:!0})}])})(Di),Di.API.TTFFont=(function(){function n(e){var t;if(this.rawData=e,t=this.contents=new Qf(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new vge(this),this.registerTTF()}return n.open=function(e){return new n(e)},n.prototype.parse=function(){return this.directory=new sge(this.contents),this.head=new age(this),this.name=new dge(this),this.cmap=new jV(this),this.toUnicode={},this.hhea=new lge(this),this.maxp=new Age(this),this.hmtx=new fge(this),this.post=new hge(this),this.os2=new cge(this),this.loca=new yge(this),this.glyf=new pge(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},n.prototype.registerTTF=function(){var e,t,i,r,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,a,c,h;for(h=[],o=0,a=(c=this.bbox).length;o<a;o++)e=c[o],h.push(Math.round(e*this.scaleFactor));return h}).call(this),this.stemV=0,this.post.exists?(i=255&(r=this.post.italic_angle),32768&(t=r>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+i)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},n.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},n.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},n.prototype.widthOfString=function(e,t,i){var r,s,o,a;for(o=0,s=0,a=(e=""+e).length;0<=a?s<a:s>a;s=0<=a?++s:--s)r=e.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(r))+i*(1e3/t)||0;return o*(t/1e3)},n.prototype.lineHeight=function(e,t){var i;return t==null&&(t=!1),i=t?this.lineGap:0,(this.ascender+i-this.decender)/1e3*e},n})();var Uu,Qf=(function(){function n(e){this.data=e??[],this.pos=0,this.length=this.data.length}return n.prototype.readByte=function(){return this.data[this.pos++]},n.prototype.writeByte=function(e){return this.data[this.pos++]=e},n.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},n.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},n.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},n.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},n.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},n.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},n.prototype.readString=function(e){var t,i;for(i=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)i[t]=String.fromCharCode(this.readByte());return i.join("")},n.prototype.writeString=function(e){var t,i,r;for(r=[],t=0,i=e.length;0<=i?t<i:t>i;t=0<=i?++t:--t)r.push(this.writeByte(e.charCodeAt(t)));return r},n.prototype.readShort=function(){return this.readInt16()},n.prototype.writeShort=function(e){return this.writeInt16(e)},n.prototype.readLongLong=function(){var e,t,i,r,s,o,a,c;return e=this.readByte(),t=this.readByte(),i=this.readByte(),r=this.readByte(),s=this.readByte(),o=this.readByte(),a=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^i)+4294967296*(255^r)+16777216*(255^s)+65536*(255^o)+256*(255^a)+(255^c)+1):72057594037927940*e+281474976710656*t+1099511627776*i+4294967296*r+16777216*s+65536*o+256*a+c},n.prototype.writeLongLong=function(e){var t,i;return t=Math.floor(e/4294967296),i=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(i>>24&255),this.writeByte(i>>16&255),this.writeByte(i>>8&255),this.writeByte(255&i)},n.prototype.readInt=function(){return this.readInt32()},n.prototype.writeInt=function(e){return this.writeInt32(e)},n.prototype.read=function(e){var t,i;for(t=[],i=0;0<=e?i<e:i>e;i=0<=e?++i:--i)t.push(this.readByte());return t},n.prototype.write=function(e){var t,i,r,s;for(s=[],i=0,r=e.length;i<r;i++)t=e[i],s.push(this.writeByte(t));return s},n})(),sge=(function(){var n;function e(t){var i,r,s;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},r=0,s=this.tableCount;0<=s?r<s:r>s;r=0<=s?++r:--r)i={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[i.tag]=i}return e.prototype.encode=function(t){var i,r,s,o,a,c,h,u,d,f,A,g,p;for(p in A=Object.keys(t).length,c=Math.log(2),d=16*Math.floor(Math.log(A)/c),o=Math.floor(d/c),u=16*A-d,(r=new Qf).writeInt(this.scalarType),r.writeShort(A),r.writeShort(d),r.writeShort(o),r.writeShort(u),s=16*A,h=r.pos+s,a=null,g=[],t)for(f=t[p],r.writeString(p),r.writeInt(n(f)),r.writeInt(h),r.writeInt(f.length),g=g.concat(f),p==="head"&&(a=h),h+=f.length;h%4;)g.push(0),h++;return r.write(g),i=2981146554-n(r.data),r.pos=a+8,r.writeUInt32(i),r.data},n=function(t){var i,r,s,o;for(t=PV.call(t);t.length%4;)t.push(0);for(s=new Qf(t),r=0,i=0,o=t.length;i<o;i=i+=4)r+=s.readUInt32();return 4294967295&r},e})(),oge={}.hasOwnProperty,Bd=function(n,e){for(var t in e)oge.call(e,t)&&(n[t]=e[t]);function i(){this.constructor=n}return i.prototype=e.prototype,n.prototype=new i,n.__super__=e.prototype,n};Uu=(function(){function n(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return n.prototype.parse=function(){},n.prototype.encode=function(){},n.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},n})();var age=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Bd(n,Uu),n.prototype.tag="head",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},n.prototype.encode=function(e){var t;return(t=new Qf).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},n})(),KN=(function(){function n(e,t){var i,r,s,o,a,c,h,u,d,f,A,g,p,y,v,m,w;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),d=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(A=e.readUInt16(),f=A/2,e.pos+=6,s=(function(){var x,T;for(T=[],c=x=0;0<=f?x<f:x>f;c=0<=f?++x:--x)T.push(e.readUInt16());return T})(),e.pos+=2,p=(function(){var x,T;for(T=[],c=x=0;0<=f?x<f:x>f;c=0<=f?++x:--x)T.push(e.readUInt16());return T})(),h=(function(){var x,T;for(T=[],c=x=0;0<=f?x<f:x>f;c=0<=f?++x:--x)T.push(e.readUInt16());return T})(),u=(function(){var x,T;for(T=[],c=x=0;0<=f?x<f:x>f;c=0<=f?++x:--x)T.push(e.readUInt16());return T})(),r=(this.length-e.pos+this.offset)/2,a=(function(){var x,T;for(T=[],c=x=0;0<=r?x<r:x>r;c=0<=r?++x:--x)T.push(e.readUInt16());return T})(),c=v=0,w=s.length;v<w;c=++v)for(y=s[c],i=m=g=p[c];g<=y?m<=y:m>=y;i=g<=y?++m:--m)u[c]===0?o=i+h[c]:(o=a[u[c]/2+(i-g)-(f-c)]||0)!==0&&(o+=h[c]),this.codeMap[i]=65535&o}e.pos=d}return n.encode=function(e,t){var i,r,s,o,a,c,h,u,d,f,A,g,p,y,v,m,w,x,T,j,D,b,_,I,S,F,B,E,V,K,P,M,X,Z,Q,U,z,q,G,ie,H,se,te,fe,ye,be;switch(E=new Qf,o=Object.keys(e).sort(function(_e,W){return _e-W}),t){case"macroman":for(p=0,y=(function(){var _e=[];for(g=0;g<256;++g)_e.push(0);return _e})(),m={0:0},s={},V=0,X=o.length;V<X;V++)m[te=e[r=o[V]]]==null&&(m[te]=++p),s[r]={old:e[r],new:m[e[r]]},y[r]=m[e[r]];return E.writeUInt16(1),E.writeUInt16(0),E.writeUInt32(12),E.writeUInt16(0),E.writeUInt16(262),E.writeUInt16(0),E.write(y),{charMap:s,subtable:E.data,maxGlyphID:p+1};case"unicode":for(F=[],d=[],w=0,m={},i={},v=h=null,K=0,Z=o.length;K<Z;K++)m[T=e[r=o[K]]]==null&&(m[T]=++w),i[r]={old:T,new:m[T]},a=m[T]-r,v!=null&&a===h||(v&&d.push(v),F.push(r),h=a),v=r;for(v&&d.push(v),d.push(65535),F.push(65535),I=2*(_=F.length),b=2*Math.pow(Math.log(_)/Math.LN2,2),f=Math.log(b/2)/Math.LN2,D=2*_-b,c=[],j=[],A=[],g=P=0,Q=F.length;P<Q;g=++P){if(S=F[g],u=d[g],S===65535){c.push(0),j.push(0);break}if(S-(B=i[S].new)>=32768)for(c.push(0),j.push(2*(A.length+_-g)),r=M=S;S<=u?M<=u:M>=u;r=S<=u?++M:--M)A.push(i[r].new);else c.push(B-S),j.push(0)}for(E.writeUInt16(3),E.writeUInt16(1),E.writeUInt32(12),E.writeUInt16(4),E.writeUInt16(16+8*_+2*A.length),E.writeUInt16(0),E.writeUInt16(I),E.writeUInt16(b),E.writeUInt16(f),E.writeUInt16(D),H=0,U=d.length;H<U;H++)r=d[H],E.writeUInt16(r);for(E.writeUInt16(0),se=0,z=F.length;se<z;se++)r=F[se],E.writeUInt16(r);for(fe=0,q=c.length;fe<q;fe++)a=c[fe],E.writeUInt16(a);for(ye=0,G=j.length;ye<G;ye++)x=j[ye],E.writeUInt16(x);for(be=0,ie=A.length;be<ie;be++)p=A[be],E.writeUInt16(p);return{charMap:i,subtable:E.data,maxGlyphID:w+1}}},n})(),jV=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Bd(n,Uu),n.prototype.tag="cmap",n.prototype.parse=function(e){var t,i,r;for(e.pos=this.offset,this.version=e.readUInt16(),r=e.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=r?i<r:i>r;i=0<=r?++i:--i)t=new KN(e,this.offset),this.tables.push(t),t.isUnicode&&this.unicode==null&&(this.unicode=t);return!0},n.encode=function(e,t){var i,r;return t==null&&(t="macroman"),i=KN.encode(e,t),(r=new Qf).writeUInt16(0),r.writeUInt16(1),i.table=r.data.concat(i.subtable),i},n})(),lge=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Bd(n,Uu),n.prototype.tag="hhea",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},n})(),cge=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Bd(n,Uu),n.prototype.tag="OS/2",n.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=(function(){var t,i;for(i=[],t=0;t<10;++t)i.push(e.readByte());return i})(),this.charRange=(function(){var t,i;for(i=[],t=0;t<4;++t)i.push(e.readInt());return i})(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=(function(){var t,i;for(i=[],t=0;t<2;t=++t)i.push(e.readInt());return i})(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},n})(),hge=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Bd(n,Uu),n.prototype.tag="post",n.prototype.parse=function(e){var t,i,r;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(i=e.readUInt16(),this.glyphNameIndex=[],s=0;0<=i?s<i:s>i;s=0<=i?++s:--s)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],r=[];e.pos<this.offset+this.length;)t=e.readByte(),r.push(this.names.push(e.readString(t)));return r;case 151552:return i=e.readUInt16(),this.offsets=e.read(i);case 262144:return this.map=(function(){var o,a,c;for(c=[],s=o=0,a=this.file.maxp.numGlyphs;0<=a?o<a:o>a;s=0<=a?++o:--o)c.push(e.readUInt32());return c}).call(this)}},n})(),uge=function(n,e){this.raw=n,this.length=n.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},dge=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Bd(n,Uu),n.prototype.tag="name",n.prototype.parse=function(e){var t,i,r,s,o,a,c,h,u,d,f;for(e.pos=this.offset,e.readShort(),t=e.readShort(),a=e.readShort(),i=[],s=0;0<=t?s<t:s>t;s=0<=t?++s:--s)i.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+a+e.readShort()});for(c={},s=u=0,d=i.length;u<d;s=++u)r=i[s],e.pos=r.offset,h=e.readString(r.length),o=new uge(h,r),c[f=r.nameID]==null&&(c[f]=[]),c[r.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},n})(),Age=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Bd(n,Uu),n.prototype.tag="maxp",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},n})(),fge=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Bd(n,Uu),n.prototype.tag="hmtx",n.prototype.parse=function(e){var t,i,r,s,o,a,c;for(e.pos=this.offset,this.metrics=[],t=0,a=this.file.hhea.numberOfMetrics;0<=a?t<a:t>a;t=0<=a?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(r=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var h,u;for(u=[],t=h=0;0<=r?h<r:h>r;t=0<=r?++h:--h)u.push(e.readInt16());return u})(),this.widths=(function(){var h,u,d,f;for(f=[],h=0,u=(d=this.metrics).length;h<u;h++)s=d[h],f.push(s.advance);return f}).call(this),i=this.widths[this.widths.length-1],c=[],t=o=0;0<=r?o<r:o>r;t=0<=r?++o:--o)c.push(this.widths.push(i));return c},n.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},n})(),PV=[].slice,pge=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Bd(n,Uu),n.prototype.tag="glyf",n.prototype.parse=function(){return this.cache={}},n.prototype.glyphFor=function(e){var t,i,r,s,o,a,c,h,u,d;return e in this.cache?this.cache[e]:(s=this.file.loca,t=this.file.contents,i=s.indexOf(e),(r=s.lengthOf(e))===0?this.cache[e]=null:(t.pos=this.offset+i,o=(a=new Qf(t.read(r))).readShort(),h=a.readShort(),d=a.readShort(),c=a.readShort(),u=a.readShort(),this.cache[e]=o===-1?new mge(a,h,d,c,u):new gge(a,o,h,d,c,u),this.cache[e]))},n.prototype.encode=function(e,t,i){var r,s,o,a,c;for(o=[],s=[],a=0,c=t.length;a<c;a++)r=e[t[a]],s.push(o.length),r&&(o=o.concat(r.encode(i)));return s.push(o.length),{table:o,offsets:s}},n})(),gge=(function(){function n(e,t,i,r,s,o){this.raw=e,this.numberOfContours=t,this.xMin=i,this.yMin=r,this.xMax=s,this.yMax=o,this.compound=!1}return n.prototype.encode=function(){return this.raw.data},n})(),mge=(function(){function n(e,t,i,r,s){var o,a;for(this.raw=e,this.xMin=t,this.yMin=i,this.xMax=r,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;a=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&a;)o.pos+=1&a?4:2,128&a?o.pos+=8:64&a?o.pos+=4:8&a&&(o.pos+=2)}return n.prototype.encode=function(){var e,t,i;for(t=new Qf(PV.call(this.raw.data)),e=0,i=this.glyphIDs.length;e<i;++e)t.pos=this.glyphOffsets[e];return t.data},n})(),yge=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Bd(n,Uu),n.prototype.tag="loca",n.prototype.parse=function(e){var t,i;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=t===0?(function(){var r,s;for(s=[],i=0,r=this.length;i<r;i+=2)s.push(2*e.readUInt16());return s}).call(this):(function(){var r,s;for(s=[],i=0,r=this.length;i<r;i+=4)s.push(e.readUInt32());return s}).call(this)},n.prototype.indexOf=function(e){return this.offsets[e]},n.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},n.prototype.encode=function(e,t){for(var i=new Uint32Array(this.offsets.length),r=0,s=0,o=0;o<i.length;++o)if(i[o]=r,s<t.length&&t[s]==o){++s,i[o]=r;var a=this.offsets[o],c=this.offsets[o+1]-a;c>0&&(r+=c)}for(var h=new Array(4*i.length),u=0;u<i.length;++u)h[4*u+3]=255&i[u],h[4*u+2]=(65280&i[u])>>8,h[4*u+1]=(16711680&i[u])>>16,h[4*u]=(4278190080&i[u])>>24;return h},n})(),vge=(function(){function n(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return n.prototype.generateCmap=function(){var e,t,i,r,s;for(t in r=this.font.cmap.tables[0].codeMap,e={},s=this.subset)i=s[t],e[t]=r[i];return e},n.prototype.glyphsFor=function(e){var t,i,r,s,o,a,c;for(r={},o=0,a=e.length;o<a;o++)r[s=e[o]]=this.font.glyf.glyphFor(s);for(s in t=[],r)(i=r[s])!=null&&i.compound&&t.push.apply(t,i.glyphIDs);if(t.length>0)for(s in c=this.glyphsFor(t))i=c[s],r[s]=i;return r},n.prototype.encode=function(e,t){var i,r,s,o,a,c,h,u,d,f,A,g,p,y,v;for(r in i=jV.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),A={0:0},v=i.charMap)A[(c=v[r]).old]=c.new;for(g in f=i.maxGlyphID,o)g in A||(A[g]=f++);return u=(function(m){var w,x;for(w in x={},m)x[m[w]]=w;return x})(A),d=Object.keys(u).sort(function(m,w){return m-w}),p=(function(){var m,w,x;for(x=[],m=0,w=d.length;m<w;m++)a=d[m],x.push(u[a]);return x})(),s=this.font.glyf.encode(o,p,A),h=this.font.loca.encode(s.offsets,p),y={cmap:this.font.cmap.raw(),glyf:s.table,loca:h,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(y["OS/2"]=this.font.os2.raw()),this.font.directory.encode(y)},n})();Di.API.PDFObject=(function(){var n;function e(){}return n=function(t,i){return(Array(i+1).join("0")+t).slice(-i)},e.convert=function(t){var i,r,s,o;if(Array.isArray(t))return"["+(function(){var a,c,h;for(h=[],a=0,c=t.length;a<c;a++)i=t[a],h.push(e.convert(i));return h})().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t!=null&&t.isString)return"("+t+")";if(t instanceof Date)return"(D:"+n(t.getUTCFullYear(),4)+n(t.getUTCMonth(),2)+n(t.getUTCDate(),2)+n(t.getUTCHours(),2)+n(t.getUTCMinutes(),2)+n(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(r in s=["<<"],t)o=t[r],s.push("/"+r+" "+e.convert(o));return s.push(">>"),s.join(`
`)}return""+t},e})();/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var LE=function(n,e){return LE=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},LE(n,e)};function Hu(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");LE(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var ME=function(){return ME=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++){t=arguments[i];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},ME.apply(this,arguments)};function hc(n,e,t,i){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{h(i.next(u))}catch(d){o(d)}}function c(u){try{h(i.throw(u))}catch(d){o(d)}}function h(u){u.done?s(u.value):r(u.value).then(a,c)}h((i=i.apply(n,[])).next())})}function zl(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,r,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(h){return function(u){return c([h,u])}}function c(h){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,r&&(s=h[0]&2?r.return:h[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,h[1])).done)return s;switch(r=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return t.label++,{value:h[1],done:!1};case 5:t.label++,r=h[1],h=[0];continue;case 7:h=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){t=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){t.label=h[1];break}if(h[0]===6&&t.label<s[1]){t.label=s[1],s=h;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(h);break}s[2]&&t.ops.pop(),t.trys.pop();continue}h=e.call(n,t)}catch(u){h=[6,u],r=0}finally{i=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function Ix(n,e,t){if(arguments.length===2)for(var i=0,r=e.length,s;i<r;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return n.concat(s||e)}var CA=(function(){function n(e,t,i,r){this.left=e,this.top=t,this.width=i,this.height=r}return n.prototype.add=function(e,t,i,r){return new n(this.left+e,this.top+t,this.width+i,this.height+r)},n.fromClientRect=function(e,t){return new n(t.left+e.windowBounds.left,t.top+e.windowBounds.top,t.width,t.height)},n.fromDOMRectList=function(e,t){var i=Array.from(t).find(function(r){return r.width!==0});return i?new n(i.left+e.windowBounds.left,i.top+e.windowBounds.top,i.width,i.height):n.EMPTY},n.EMPTY=new n(0,0,0,0),n})(),P5=function(n,e){return CA.fromClientRect(n,e.getBoundingClientRect())},wge=function(n){var e=n.body,t=n.documentElement;if(!e||!t)throw new Error("Unable to get document size");var i=Math.max(Math.max(e.scrollWidth,t.scrollWidth),Math.max(e.offsetWidth,t.offsetWidth),Math.max(e.clientWidth,t.clientWidth)),r=Math.max(Math.max(e.scrollHeight,t.scrollHeight),Math.max(e.offsetHeight,t.offsetHeight),Math.max(e.clientHeight,t.clientHeight));return new CA(0,0,i,r)},N5=function(n){for(var e=[],t=0,i=n.length;t<i;){var r=n.charCodeAt(t++);if(r>=55296&&r<=56319&&t<i){var s=n.charCodeAt(t++);(s&64512)===56320?e.push(((r&1023)<<10)+(s&1023)+65536):(e.push(r),t--)}else e.push(r)}return e},sa=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,n);var t=n.length;if(!t)return"";for(var i=[],r=-1,s="";++r<t;){var o=n[r];o<=65535?i.push(o):(o-=65536,i.push((o>>10)+55296,o%1024+56320)),(r+1===t||i.length>16384)&&(s+=String.fromCharCode.apply(String,i),i.length=0)}return s},qN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",xge=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Fx=0;Fx<qN.length;Fx++)xge[qN.charCodeAt(Fx)]=Fx;var YN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",K2=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Dx=0;Dx<YN.length;Dx++)K2[YN.charCodeAt(Dx)]=Dx;var bge=function(n){var e=n.length*.75,t=n.length,i,r=0,s,o,a,c;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);var h=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),u=Array.isArray(h)?h:new Uint8Array(h);for(i=0;i<t;i+=4)s=K2[n.charCodeAt(i)],o=K2[n.charCodeAt(i+1)],a=K2[n.charCodeAt(i+2)],c=K2[n.charCodeAt(i+3)],u[r++]=s<<2|o>>4,u[r++]=(o&15)<<4|a>>2,u[r++]=(a&3)<<6|c&63;return h},_ge=function(n){for(var e=n.length,t=[],i=0;i<e;i+=2)t.push(n[i+1]<<8|n[i]);return t},Cge=function(n){for(var e=n.length,t=[],i=0;i<e;i+=4)t.push(n[i+3]<<24|n[i+2]<<16|n[i+1]<<8|n[i]);return t},eg=5,QI=11,s4=2,Sge=QI-eg,NV=65536>>eg,Tge=1<<eg,o4=Tge-1,Bge=1024>>eg,Ege=NV+Bge,kge=Ege,Ige=32,Fge=kge+Ige,Dge=65536>>QI,jge=1<<Sge,Pge=jge-1,ZN=function(n,e,t){return n.slice?n.slice(e,t):new Uint16Array(Array.prototype.slice.call(n,e,t))},Nge=function(n,e,t){return n.slice?n.slice(e,t):new Uint32Array(Array.prototype.slice.call(n,e,t))},Lge=function(n,e){var t=bge(n),i=Array.isArray(t)?Cge(t):new Uint32Array(t),r=Array.isArray(t)?_ge(t):new Uint16Array(t),s=24,o=ZN(r,s/2,i[4]/2),a=i[5]===2?ZN(r,(s+i[4])/2):Nge(i,Math.ceil((s+i[4])/4));return new Mge(i[0],i[1],i[2],i[3],o,a)},Mge=(function(){function n(e,t,i,r,s,o){this.initialValue=e,this.errorValue=t,this.highStart=i,this.highValueIndex=r,this.index=s,this.data=o}return n.prototype.get=function(e){var t;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=this.index[e>>eg],t=(t<<s4)+(e&o4),this.data[t];if(e<=65535)return t=this.index[NV+(e-55296>>eg)],t=(t<<s4)+(e&o4),this.data[t];if(e<this.highStart)return t=Fge-Dge+(e>>QI),t=this.index[t],t+=e>>eg&Pge,t=this.index[t],t=(t<<s4)+(e&o4),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},n})(),JN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Rge=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var jx=0;jx<JN.length;jx++)Rge[JN.charCodeAt(jx)]=jx;var Oge="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",eL=50,Uge=1,LV=2,MV=3,Hge=4,Wge=5,tL=7,RV=8,nL=9,_f=10,RE=11,iL=12,OE=13,Qge=14,q2=15,UE=16,Px=17,W1=18,$ge=19,rL=20,HE=21,Q1=22,a4=23,l0=24,eh=25,Y2=26,Z2=27,c0=28,Vge=29,Lp=30,zge=31,Nx=32,Lx=33,WE=34,QE=35,$E=36,fv=37,VE=38,e_=39,t_=40,l4=41,OV=42,Gge=43,Xge=[9001,65288],UV="!",Kr="×",Mx="÷",zE=Lge(Oge),zd=[Lp,$E],GE=[Uge,LV,MV,Wge],HV=[_f,RV],sL=[Z2,Y2],Kge=GE.concat(HV),oL=[VE,e_,t_,WE,QE],qge=[q2,OE],Yge=function(n,e){e===void 0&&(e="strict");var t=[],i=[],r=[];return n.forEach(function(s,o){var a=zE.get(s);if(a>eL?(r.push(!0),a-=eL):r.push(!1),["normal","auto","loose"].indexOf(e)!==-1&&[8208,8211,12316,12448].indexOf(s)!==-1)return i.push(o),t.push(UE);if(a===Hge||a===RE){if(o===0)return i.push(o),t.push(Lp);var c=t[o-1];return Kge.indexOf(c)===-1?(i.push(i[o-1]),t.push(c)):(i.push(o),t.push(Lp))}if(i.push(o),a===zge)return t.push(e==="strict"?HE:fv);if(a===OV||a===Vge)return t.push(Lp);if(a===Gge)return s>=131072&&s<=196605||s>=196608&&s<=262141?t.push(fv):t.push(Lp);t.push(a)}),[i,t,r]},c4=function(n,e,t,i){var r=i[t];if(Array.isArray(n)?n.indexOf(r)!==-1:n===r)for(var s=t;s<=i.length;){s++;var o=i[s];if(o===e)return!0;if(o!==_f)break}if(r===_f)for(var s=t;s>0;){s--;var a=i[s];if(Array.isArray(n)?n.indexOf(a)!==-1:n===a)for(var c=t;c<=i.length;){c++;var o=i[c];if(o===e)return!0;if(o!==_f)break}if(a!==_f)break}return!1},aL=function(n,e){for(var t=n;t>=0;){var i=e[t];if(i===_f)t--;else return i}return 0},Zge=function(n,e,t,i,r){if(t[i]===0)return Kr;var s=i-1;if(Array.isArray(r)&&r[s]===!0)return Kr;var o=s-1,a=s+1,c=e[s],h=o>=0?e[o]:0,u=e[a];if(c===LV&&u===MV)return Kr;if(GE.indexOf(c)!==-1)return UV;if(GE.indexOf(u)!==-1||HV.indexOf(u)!==-1)return Kr;if(aL(s,e)===RV)return Mx;if(zE.get(n[s])===RE||(c===Nx||c===Lx)&&zE.get(n[a])===RE||c===tL||u===tL||c===nL||[_f,OE,q2].indexOf(c)===-1&&u===nL||[Px,W1,$ge,l0,c0].indexOf(u)!==-1||aL(s,e)===Q1||c4(a4,Q1,s,e)||c4([Px,W1],HE,s,e)||c4(iL,iL,s,e))return Kr;if(c===_f)return Mx;if(c===a4||u===a4)return Kr;if(u===UE||c===UE)return Mx;if([OE,q2,HE].indexOf(u)!==-1||c===Qge||h===$E&&qge.indexOf(c)!==-1||c===c0&&u===$E||u===rL||zd.indexOf(u)!==-1&&c===eh||zd.indexOf(c)!==-1&&u===eh||c===Z2&&[fv,Nx,Lx].indexOf(u)!==-1||[fv,Nx,Lx].indexOf(c)!==-1&&u===Y2||zd.indexOf(c)!==-1&&sL.indexOf(u)!==-1||sL.indexOf(c)!==-1&&zd.indexOf(u)!==-1||[Z2,Y2].indexOf(c)!==-1&&(u===eh||[Q1,q2].indexOf(u)!==-1&&e[a+1]===eh)||[Q1,q2].indexOf(c)!==-1&&u===eh||c===eh&&[eh,c0,l0].indexOf(u)!==-1)return Kr;if([eh,c0,l0,Px,W1].indexOf(u)!==-1)for(var d=s;d>=0;){var f=e[d];if(f===eh)return Kr;if([c0,l0].indexOf(f)!==-1)d--;else break}if([Z2,Y2].indexOf(u)!==-1)for(var d=[Px,W1].indexOf(c)!==-1?o:s;d>=0;){var f=e[d];if(f===eh)return Kr;if([c0,l0].indexOf(f)!==-1)d--;else break}if(VE===c&&[VE,e_,WE,QE].indexOf(u)!==-1||[e_,WE].indexOf(c)!==-1&&[e_,t_].indexOf(u)!==-1||[t_,QE].indexOf(c)!==-1&&u===t_||oL.indexOf(c)!==-1&&[rL,Y2].indexOf(u)!==-1||oL.indexOf(u)!==-1&&c===Z2||zd.indexOf(c)!==-1&&zd.indexOf(u)!==-1||c===l0&&zd.indexOf(u)!==-1||zd.concat(eh).indexOf(c)!==-1&&u===Q1&&Xge.indexOf(n[a])===-1||zd.concat(eh).indexOf(u)!==-1&&c===W1)return Kr;if(c===l4&&u===l4){for(var A=t[s],g=1;A>0&&(A--,e[A]===l4);)g++;if(g%2!==0)return Kr}return c===Nx&&u===Lx?Kr:Mx},Jge=function(n,e){e||(e={lineBreak:"normal",wordBreak:"normal"});var t=Yge(n,e.lineBreak),i=t[0],r=t[1],s=t[2];(e.wordBreak==="break-all"||e.wordBreak==="break-word")&&(r=r.map(function(a){return[eh,Lp,OV].indexOf(a)!==-1?fv:a}));var o=e.wordBreak==="keep-all"?s.map(function(a,c){return a&&n[c]>=19968&&n[c]<=40959}):void 0;return[i,r,o]},e0e=(function(){function n(e,t,i,r){this.codePoints=e,this.required=t===UV,this.start=i,this.end=r}return n.prototype.slice=function(){return sa.apply(void 0,this.codePoints.slice(this.start,this.end))},n})(),t0e=function(n,e){var t=N5(n),i=Jge(t,e),r=i[0],s=i[1],o=i[2],a=t.length,c=0,h=0;return{next:function(){if(h>=a)return{done:!0,value:null};for(var u=Kr;h<a&&(u=Zge(t,s,r,++h,o))===Kr;);if(u!==Kr||h===a){var d=new e0e(t,u,c,h);return c=h,{value:d,done:!1}}return{done:!0,value:null}}}},n0e=1,i0e=2,ew=4,lL=8,iC=10,cL=47,Fy=92,r0e=9,s0e=32,Rx=34,$1=61,o0e=35,a0e=36,l0e=37,Ox=39,Ux=40,V1=41,c0e=95,Lc=45,h0e=33,u0e=60,d0e=62,A0e=64,f0e=91,p0e=93,g0e=61,m0e=123,Hx=63,y0e=125,hL=124,v0e=126,w0e=128,uL=65533,h4=42,$p=43,x0e=44,b0e=58,_0e=59,pv=46,C0e=0,S0e=8,T0e=11,B0e=14,E0e=31,k0e=127,Xu=-1,WV=48,QV=97,$V=101,I0e=102,F0e=117,D0e=122,VV=65,zV=69,GV=70,j0e=85,P0e=90,ql=function(n){return n>=WV&&n<=57},N0e=function(n){return n>=55296&&n<=57343},h0=function(n){return ql(n)||n>=VV&&n<=GV||n>=QV&&n<=I0e},L0e=function(n){return n>=QV&&n<=D0e},M0e=function(n){return n>=VV&&n<=P0e},R0e=function(n){return L0e(n)||M0e(n)},O0e=function(n){return n>=w0e},Wx=function(n){return n===iC||n===r0e||n===s0e},rC=function(n){return R0e(n)||O0e(n)||n===c0e},dL=function(n){return rC(n)||ql(n)||n===Lc},U0e=function(n){return n>=C0e&&n<=S0e||n===T0e||n>=B0e&&n<=E0e||n===k0e},Af=function(n,e){return n!==Fy?!1:e!==iC},Qx=function(n,e,t){return n===Lc?rC(e)||Af(e,t):rC(n)?!0:!!(n===Fy&&Af(n,e))},u4=function(n,e,t){return n===$p||n===Lc?ql(e)?!0:e===pv&&ql(t):ql(n===pv?e:n)},H0e=function(n){var e=0,t=1;(n[e]===$p||n[e]===Lc)&&(n[e]===Lc&&(t=-1),e++);for(var i=[];ql(n[e]);)i.push(n[e++]);var r=i.length?parseInt(sa.apply(void 0,i),10):0;n[e]===pv&&e++;for(var s=[];ql(n[e]);)s.push(n[e++]);var o=s.length,a=o?parseInt(sa.apply(void 0,s),10):0;(n[e]===zV||n[e]===$V)&&e++;var c=1;(n[e]===$p||n[e]===Lc)&&(n[e]===Lc&&(c=-1),e++);for(var h=[];ql(n[e]);)h.push(n[e++]);var u=h.length?parseInt(sa.apply(void 0,h),10):0;return t*(r+a*Math.pow(10,-o))*Math.pow(10,c*u)},W0e={type:2},Q0e={type:3},$0e={type:4},V0e={type:13},z0e={type:8},G0e={type:21},X0e={type:9},K0e={type:10},q0e={type:11},Y0e={type:12},Z0e={type:14},$x={type:23},J0e={type:1},eme={type:25},tme={type:24},nme={type:26},ime={type:27},rme={type:28},sme={type:29},ome={type:31},XE={type:32},XV=(function(){function n(){this._value=[]}return n.prototype.write=function(e){this._value=this._value.concat(N5(e))},n.prototype.read=function(){for(var e=[],t=this.consumeToken();t!==XE;)e.push(t),t=this.consumeToken();return e},n.prototype.consumeToken=function(){var e=this.consumeCodePoint();switch(e){case Rx:return this.consumeStringToken(Rx);case o0e:var t=this.peekCodePoint(0),i=this.peekCodePoint(1),r=this.peekCodePoint(2);if(dL(t)||Af(i,r)){var s=Qx(t,i,r)?i0e:n0e,o=this.consumeName();return{type:5,value:o,flags:s}}break;case a0e:if(this.peekCodePoint(0)===$1)return this.consumeCodePoint(),V0e;break;case Ox:return this.consumeStringToken(Ox);case Ux:return W0e;case V1:return Q0e;case h4:if(this.peekCodePoint(0)===$1)return this.consumeCodePoint(),Z0e;break;case $p:if(u4(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case x0e:return $0e;case Lc:var a=e,c=this.peekCodePoint(0),h=this.peekCodePoint(1);if(u4(a,c,h))return this.reconsumeCodePoint(e),this.consumeNumericToken();if(Qx(a,c,h))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();if(c===Lc&&h===d0e)return this.consumeCodePoint(),this.consumeCodePoint(),tme;break;case pv:if(u4(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case cL:if(this.peekCodePoint(0)===h4)for(this.consumeCodePoint();;){var u=this.consumeCodePoint();if(u===h4&&(u=this.consumeCodePoint(),u===cL))return this.consumeToken();if(u===Xu)return this.consumeToken()}break;case b0e:return nme;case _0e:return ime;case u0e:if(this.peekCodePoint(0)===h0e&&this.peekCodePoint(1)===Lc&&this.peekCodePoint(2)===Lc)return this.consumeCodePoint(),this.consumeCodePoint(),eme;break;case A0e:var d=this.peekCodePoint(0),f=this.peekCodePoint(1),A=this.peekCodePoint(2);if(Qx(d,f,A)){var o=this.consumeName();return{type:7,value:o}}break;case f0e:return rme;case Fy:if(Af(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();break;case p0e:return sme;case g0e:if(this.peekCodePoint(0)===$1)return this.consumeCodePoint(),z0e;break;case m0e:return q0e;case y0e:return Y0e;case F0e:case j0e:var g=this.peekCodePoint(0),p=this.peekCodePoint(1);return g===$p&&(h0(p)||p===Hx)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(e),this.consumeIdentLikeToken();case hL:if(this.peekCodePoint(0)===$1)return this.consumeCodePoint(),X0e;if(this.peekCodePoint(0)===hL)return this.consumeCodePoint(),G0e;break;case v0e:if(this.peekCodePoint(0)===$1)return this.consumeCodePoint(),K0e;break;case Xu:return XE}return Wx(e)?(this.consumeWhiteSpace(),ome):ql(e)?(this.reconsumeCodePoint(e),this.consumeNumericToken()):rC(e)?(this.reconsumeCodePoint(e),this.consumeIdentLikeToken()):{type:6,value:sa(e)}},n.prototype.consumeCodePoint=function(){var e=this._value.shift();return typeof e>"u"?-1:e},n.prototype.reconsumeCodePoint=function(e){this._value.unshift(e)},n.prototype.peekCodePoint=function(e){return e>=this._value.length?-1:this._value[e]},n.prototype.consumeUnicodeRangeToken=function(){for(var e=[],t=this.consumeCodePoint();h0(t)&&e.length<6;)e.push(t),t=this.consumeCodePoint();for(var i=!1;t===Hx&&e.length<6;)e.push(t),t=this.consumeCodePoint(),i=!0;if(i){var r=parseInt(sa.apply(void 0,e.map(function(c){return c===Hx?WV:c})),16),s=parseInt(sa.apply(void 0,e.map(function(c){return c===Hx?GV:c})),16);return{type:30,start:r,end:s}}var o=parseInt(sa.apply(void 0,e),16);if(this.peekCodePoint(0)===Lc&&h0(this.peekCodePoint(1))){this.consumeCodePoint(),t=this.consumeCodePoint();for(var a=[];h0(t)&&a.length<6;)a.push(t),t=this.consumeCodePoint();var s=parseInt(sa.apply(void 0,a),16);return{type:30,start:o,end:s}}else return{type:30,start:o,end:o}},n.prototype.consumeIdentLikeToken=function(){var e=this.consumeName();return e.toLowerCase()==="url"&&this.peekCodePoint(0)===Ux?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===Ux?(this.consumeCodePoint(),{type:19,value:e}):{type:20,value:e}},n.prototype.consumeUrlToken=function(){var e=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===Xu)return{type:22,value:""};var t=this.peekCodePoint(0);if(t===Ox||t===Rx){var i=this.consumeStringToken(this.consumeCodePoint());return i.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===Xu||this.peekCodePoint(0)===V1)?(this.consumeCodePoint(),{type:22,value:i.value}):(this.consumeBadUrlRemnants(),$x)}for(;;){var r=this.consumeCodePoint();if(r===Xu||r===V1)return{type:22,value:sa.apply(void 0,e)};if(Wx(r))return this.consumeWhiteSpace(),this.peekCodePoint(0)===Xu||this.peekCodePoint(0)===V1?(this.consumeCodePoint(),{type:22,value:sa.apply(void 0,e)}):(this.consumeBadUrlRemnants(),$x);if(r===Rx||r===Ox||r===Ux||U0e(r))return this.consumeBadUrlRemnants(),$x;if(r===Fy)if(Af(r,this.peekCodePoint(0)))e.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),$x;else e.push(r)}},n.prototype.consumeWhiteSpace=function(){for(;Wx(this.peekCodePoint(0));)this.consumeCodePoint()},n.prototype.consumeBadUrlRemnants=function(){for(;;){var e=this.consumeCodePoint();if(e===V1||e===Xu)return;Af(e,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},n.prototype.consumeStringSlice=function(e){for(var t=5e4,i="";e>0;){var r=Math.min(t,e);i+=sa.apply(void 0,this._value.splice(0,r)),e-=r}return this._value.shift(),i},n.prototype.consumeStringToken=function(e){var t="",i=0;do{var r=this._value[i];if(r===Xu||r===void 0||r===e)return t+=this.consumeStringSlice(i),{type:0,value:t};if(r===iC)return this._value.splice(0,i),J0e;if(r===Fy){var s=this._value[i+1];s!==Xu&&s!==void 0&&(s===iC?(t+=this.consumeStringSlice(i),i=-1,this._value.shift()):Af(r,s)&&(t+=this.consumeStringSlice(i),t+=sa(this.consumeEscapedCodePoint()),i=-1))}i++}while(!0)},n.prototype.consumeNumber=function(){var e=[],t=ew,i=this.peekCodePoint(0);for((i===$p||i===Lc)&&e.push(this.consumeCodePoint());ql(this.peekCodePoint(0));)e.push(this.consumeCodePoint());i=this.peekCodePoint(0);var r=this.peekCodePoint(1);if(i===pv&&ql(r))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),t=lL;ql(this.peekCodePoint(0));)e.push(this.consumeCodePoint());i=this.peekCodePoint(0),r=this.peekCodePoint(1);var s=this.peekCodePoint(2);if((i===zV||i===$V)&&((r===$p||r===Lc)&&ql(s)||ql(r)))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),t=lL;ql(this.peekCodePoint(0));)e.push(this.consumeCodePoint());return[H0e(e),t]},n.prototype.consumeNumericToken=function(){var e=this.consumeNumber(),t=e[0],i=e[1],r=this.peekCodePoint(0),s=this.peekCodePoint(1),o=this.peekCodePoint(2);if(Qx(r,s,o)){var a=this.consumeName();return{type:15,number:t,flags:i,unit:a}}return r===l0e?(this.consumeCodePoint(),{type:16,number:t,flags:i}):{type:17,number:t,flags:i}},n.prototype.consumeEscapedCodePoint=function(){var e=this.consumeCodePoint();if(h0(e)){for(var t=sa(e);h0(this.peekCodePoint(0))&&t.length<6;)t+=sa(this.consumeCodePoint());Wx(this.peekCodePoint(0))&&this.consumeCodePoint();var i=parseInt(t,16);return i===0||N0e(i)||i>1114111?uL:i}return e===Xu?uL:e},n.prototype.consumeName=function(){for(var e="";;){var t=this.consumeCodePoint();if(dL(t))e+=sa(t);else if(Af(t,this.peekCodePoint(0)))e+=sa(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(t),e}},n})(),KV=(function(){function n(e){this._tokens=e}return n.create=function(e){var t=new XV;return t.write(e),new n(t.read())},n.parseValue=function(e){return n.create(e).parseComponentValue()},n.parseValues=function(e){return n.create(e).parseComponentValues()},n.prototype.parseComponentValue=function(){for(var e=this.consumeToken();e.type===31;)e=this.consumeToken();if(e.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(e);var t=this.consumeComponentValue();do e=this.consumeToken();while(e.type===31);if(e.type===32)return t;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},n.prototype.parseComponentValues=function(){for(var e=[];;){var t=this.consumeComponentValue();if(t.type===32)return e;e.push(t),e.push()}},n.prototype.consumeComponentValue=function(){var e=this.consumeToken();switch(e.type){case 11:case 28:case 2:return this.consumeSimpleBlock(e.type);case 19:return this.consumeFunction(e)}return e},n.prototype.consumeSimpleBlock=function(e){for(var t={type:e,values:[]},i=this.consumeToken();;){if(i.type===32||lme(i,e))return t;this.reconsumeToken(i),t.values.push(this.consumeComponentValue()),i=this.consumeToken()}},n.prototype.consumeFunction=function(e){for(var t={name:e.value,values:[],type:18};;){var i=this.consumeToken();if(i.type===32||i.type===3)return t;this.reconsumeToken(i),t.values.push(this.consumeComponentValue())}},n.prototype.consumeToken=function(){var e=this._tokens.shift();return typeof e>"u"?XE:e},n.prototype.reconsumeToken=function(e){this._tokens.unshift(e)},n})(),tw=function(n){return n.type===15},Ym=function(n){return n.type===17},Us=function(n){return n.type===20},ame=function(n){return n.type===0},KE=function(n,e){return Us(n)&&n.value===e},qV=function(n){return n.type!==31},Em=function(n){return n.type!==31&&n.type!==4},Ed=function(n){var e=[],t=[];return n.forEach(function(i){if(i.type===4){if(t.length===0)throw new Error("Error parsing function args, zero tokens for arg");e.push(t),t=[];return}i.type!==31&&t.push(i)}),t.length&&e.push(t),e},lme=function(n,e){return e===11&&n.type===12||e===28&&n.type===29?!0:e===2&&n.type===3},$f=function(n){return n.type===17||n.type===15},wa=function(n){return n.type===16||$f(n)},YV=function(n){return n.length>1?[n[0],n[1]]:[n[0]]},Dl={type:17,number:0,flags:ew},$I={type:16,number:50,flags:ew},Cf={type:16,number:100,flags:ew},J2=function(n,e,t){var i=n[0],r=n[1];return[ao(i,e),ao(typeof r<"u"?r:i,t)]},ao=function(n,e){if(n.type===16)return n.number/100*e;if(tw(n))switch(n.unit){case"rem":case"em":return 16*n.number;case"px":default:return n.number}return n.number},ZV="deg",JV="grad",ez="rad",tz="turn",L5={name:"angle",parse:function(n,e){if(e.type===15)switch(e.unit){case ZV:return Math.PI*e.number/180;case JV:return Math.PI/200*e.number;case ez:return e.number;case tz:return Math.PI*2*e.number}throw new Error("Unsupported angle type")}},nz=function(n){return n.type===15&&(n.unit===ZV||n.unit===JV||n.unit===ez||n.unit===tz)},iz=function(n){var e=n.filter(Us).map(function(t){return t.value}).join(" ");switch(e){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Dl,Dl];case"to top":case"bottom":return Qh(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Dl,Cf];case"to right":case"left":return Qh(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[Cf,Cf];case"to bottom":case"top":return Qh(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[Cf,Dl];case"to left":case"right":return Qh(270)}return 0},Qh=function(n){return Math.PI*n/180},Ff={name:"color",parse:function(n,e){if(e.type===18){var t=cme[e.name];if(typeof t>"u")throw new Error('Attempting to parse an unsupported color function "'+e.name+'"');return t(n,e.values)}if(e.type===5){if(e.value.length===3){var i=e.value.substring(0,1),r=e.value.substring(1,2),s=e.value.substring(2,3);return Sf(parseInt(i+i,16),parseInt(r+r,16),parseInt(s+s,16),1)}if(e.value.length===4){var i=e.value.substring(0,1),r=e.value.substring(1,2),s=e.value.substring(2,3),o=e.value.substring(3,4);return Sf(parseInt(i+i,16),parseInt(r+r,16),parseInt(s+s,16),parseInt(o+o,16)/255)}if(e.value.length===6){var i=e.value.substring(0,2),r=e.value.substring(2,4),s=e.value.substring(4,6);return Sf(parseInt(i,16),parseInt(r,16),parseInt(s,16),1)}if(e.value.length===8){var i=e.value.substring(0,2),r=e.value.substring(2,4),s=e.value.substring(4,6),o=e.value.substring(6,8);return Sf(parseInt(i,16),parseInt(r,16),parseInt(s,16),parseInt(o,16)/255)}}if(e.type===20){var a=fA[e.value.toUpperCase()];if(typeof a<"u")return a}return fA.TRANSPARENT}},Df=function(n){return(255&n)===0},el=function(n){var e=255&n,t=255&n>>8,i=255&n>>16,r=255&n>>24;return e<255?"rgba("+r+","+i+","+t+","+e/255+")":"rgb("+r+","+i+","+t+")"},Sf=function(n,e,t,i){return(n<<24|e<<16|t<<8|Math.round(i*255)<<0)>>>0},AL=function(n,e){if(n.type===17)return n.number;if(n.type===16){var t=e===3?1:255;return e===3?n.number/100*t:Math.round(n.number/100*t)}return 0},fL=function(n,e){var t=e.filter(Em);if(t.length===3){var i=t.map(AL),r=i[0],s=i[1],o=i[2];return Sf(r,s,o,1)}if(t.length===4){var a=t.map(AL),r=a[0],s=a[1],o=a[2],c=a[3];return Sf(r,s,o,c)}return 0};function d4(n,e,t){return t<0&&(t+=1),t>=1&&(t-=1),t<1/6?(e-n)*t*6+n:t<1/2?e:t<2/3?(e-n)*6*(2/3-t)+n:n}var pL=function(n,e){var t=e.filter(Em),i=t[0],r=t[1],s=t[2],o=t[3],a=(i.type===17?Qh(i.number):L5.parse(n,i))/(Math.PI*2),c=wa(r)?r.number/100:0,h=wa(s)?s.number/100:0,u=typeof o<"u"&&wa(o)?ao(o,1):1;if(c===0)return Sf(h*255,h*255,h*255,1);var d=h<=.5?h*(c+1):h+c-h*c,f=h*2-d,A=d4(f,d,a+1/3),g=d4(f,d,a),p=d4(f,d,a-1/3);return Sf(A*255,g*255,p*255,u)},cme={hsl:pL,hsla:pL,rgb:fL,rgba:fL},Dy=function(n,e){return Ff.parse(n,KV.create(e).parseComponentValue())},fA={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},hme={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(n,e){return e.map(function(t){if(Us(t))switch(t.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},ume={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},M5=function(n,e){var t=Ff.parse(n,e[0]),i=e[1];return i&&wa(i)?{color:t,stop:i}:{color:t,stop:null}},gL=function(n,e){var t=n[0],i=n[n.length-1];t.stop===null&&(t.stop=Dl),i.stop===null&&(i.stop=Cf);for(var r=[],s=0,o=0;o<n.length;o++){var a=n[o].stop;if(a!==null){var c=ao(a,e);c>s?r.push(c):r.push(s),s=c}else r.push(null)}for(var h=null,o=0;o<r.length;o++){var u=r[o];if(u===null)h===null&&(h=o);else if(h!==null){for(var d=o-h,f=r[h-1],A=(u-f)/(d+1),g=1;g<=d;g++)r[h+g-1]=A*g;h=null}}return n.map(function(p,y){var v=p.color;return{color:v,stop:Math.max(Math.min(1,r[y]/e),0)}})},dme=function(n,e,t){var i=e/2,r=t/2,s=ao(n[0],e)-i,o=r-ao(n[1],t);return(Math.atan2(o,s)+Math.PI*2)%(Math.PI*2)},Ame=function(n,e,t){var i=typeof n=="number"?n:dme(n,e,t),r=Math.abs(e*Math.sin(i))+Math.abs(t*Math.cos(i)),s=e/2,o=t/2,a=r/2,c=Math.sin(i-Math.PI/2)*a,h=Math.cos(i-Math.PI/2)*a;return[r,s-h,s+h,o-c,o+c]},hu=function(n,e){return Math.sqrt(n*n+e*e)},mL=function(n,e,t,i,r){var s=[[0,0],[0,e],[n,0],[n,e]];return s.reduce(function(o,a){var c=a[0],h=a[1],u=hu(t-c,i-h);return(r?u<o.optimumDistance:u>o.optimumDistance)?{optimumCorner:a,optimumDistance:u}:o},{optimumDistance:r?1/0:-1/0,optimumCorner:null}).optimumCorner},fme=function(n,e,t,i,r){var s=0,o=0;switch(n.size){case 0:n.shape===0?s=o=Math.min(Math.abs(e),Math.abs(e-i),Math.abs(t),Math.abs(t-r)):n.shape===1&&(s=Math.min(Math.abs(e),Math.abs(e-i)),o=Math.min(Math.abs(t),Math.abs(t-r)));break;case 2:if(n.shape===0)s=o=Math.min(hu(e,t),hu(e,t-r),hu(e-i,t),hu(e-i,t-r));else if(n.shape===1){var a=Math.min(Math.abs(t),Math.abs(t-r))/Math.min(Math.abs(e),Math.abs(e-i)),c=mL(i,r,e,t,!0),h=c[0],u=c[1];s=hu(h-e,(u-t)/a),o=a*s}break;case 1:n.shape===0?s=o=Math.max(Math.abs(e),Math.abs(e-i),Math.abs(t),Math.abs(t-r)):n.shape===1&&(s=Math.max(Math.abs(e),Math.abs(e-i)),o=Math.max(Math.abs(t),Math.abs(t-r)));break;case 3:if(n.shape===0)s=o=Math.max(hu(e,t),hu(e,t-r),hu(e-i,t),hu(e-i,t-r));else if(n.shape===1){var a=Math.max(Math.abs(t),Math.abs(t-r))/Math.max(Math.abs(e),Math.abs(e-i)),d=mL(i,r,e,t,!1),h=d[0],u=d[1];s=hu(h-e,(u-t)/a),o=a*s}break}return Array.isArray(n.size)&&(s=ao(n.size[0],i),o=n.size.length===2?ao(n.size[1],r):s),[s,o]},pme=function(n,e){var t=Qh(180),i=[];return Ed(e).forEach(function(r,s){if(s===0){var o=r[0];if(o.type===20&&o.value==="to"){t=iz(r);return}else if(nz(o)){t=L5.parse(n,o);return}}var a=M5(n,r);i.push(a)}),{angle:t,stops:i,type:1}},Vx=function(n,e){var t=Qh(180),i=[];return Ed(e).forEach(function(r,s){if(s===0){var o=r[0];if(o.type===20&&["top","left","right","bottom"].indexOf(o.value)!==-1){t=iz(r);return}else if(nz(o)){t=(L5.parse(n,o)+Qh(270))%Qh(360);return}}var a=M5(n,r);i.push(a)}),{angle:t,stops:i,type:1}},gme=function(n,e){var t=Qh(180),i=[],r=1,s=0,o=3,a=[];return Ed(e).forEach(function(c,h){var u=c[0];if(h===0){if(Us(u)&&u.value==="linear"){r=1;return}else if(Us(u)&&u.value==="radial"){r=2;return}}if(u.type===18){if(u.name==="from"){var d=Ff.parse(n,u.values[0]);i.push({stop:Dl,color:d})}else if(u.name==="to"){var d=Ff.parse(n,u.values[0]);i.push({stop:Cf,color:d})}else if(u.name==="color-stop"){var f=u.values.filter(Em);if(f.length===2){var d=Ff.parse(n,f[1]),A=f[0];Ym(A)&&i.push({stop:{type:16,number:A.number*100,flags:A.flags},color:d})}}}}),r===1?{angle:(t+Qh(180))%Qh(360),stops:i,type:r}:{size:o,shape:s,stops:i,position:a,type:r}},rz="closest-side",sz="farthest-side",oz="closest-corner",az="farthest-corner",lz="circle",cz="ellipse",hz="cover",uz="contain",mme=function(n,e){var t=0,i=3,r=[],s=[];return Ed(e).forEach(function(o,a){var c=!0;if(a===0){var h=!1;c=o.reduce(function(d,f){if(h)if(Us(f))switch(f.value){case"center":return s.push($I),d;case"top":case"left":return s.push(Dl),d;case"right":case"bottom":return s.push(Cf),d}else(wa(f)||$f(f))&&s.push(f);else if(Us(f))switch(f.value){case lz:return t=0,!1;case cz:return t=1,!1;case"at":return h=!0,!1;case rz:return i=0,!1;case hz:case sz:return i=1,!1;case uz:case oz:return i=2,!1;case az:return i=3,!1}else if($f(f)||wa(f))return Array.isArray(i)||(i=[]),i.push(f),!1;return d},c)}if(c){var u=M5(n,o);r.push(u)}}),{size:i,shape:t,stops:r,position:s,type:2}},zx=function(n,e){var t=0,i=3,r=[],s=[];return Ed(e).forEach(function(o,a){var c=!0;if(a===0?c=o.reduce(function(u,d){if(Us(d))switch(d.value){case"center":return s.push($I),!1;case"top":case"left":return s.push(Dl),!1;case"right":case"bottom":return s.push(Cf),!1}else if(wa(d)||$f(d))return s.push(d),!1;return u},c):a===1&&(c=o.reduce(function(u,d){if(Us(d))switch(d.value){case lz:return t=0,!1;case cz:return t=1,!1;case uz:case rz:return i=0,!1;case sz:return i=1,!1;case oz:return i=2,!1;case hz:case az:return i=3,!1}else if($f(d)||wa(d))return Array.isArray(i)||(i=[]),i.push(d),!1;return u},c)),c){var h=M5(n,o);r.push(h)}}),{size:i,shape:t,stops:r,position:s,type:2}},yme=function(n){return n.type===1},vme=function(n){return n.type===2},VI={name:"image",parse:function(n,e){if(e.type===22){var t={url:e.value,type:0};return n.cache.addImage(e.value),t}if(e.type===18){var i=dz[e.name];if(typeof i>"u")throw new Error('Attempting to parse an unsupported image function "'+e.name+'"');return i(n,e.values)}throw new Error("Unsupported image type "+e.type)}};function wme(n){return!(n.type===20&&n.value==="none")&&(n.type!==18||!!dz[n.name])}var dz={"linear-gradient":pme,"-moz-linear-gradient":Vx,"-ms-linear-gradient":Vx,"-o-linear-gradient":Vx,"-webkit-linear-gradient":Vx,"radial-gradient":mme,"-moz-radial-gradient":zx,"-ms-radial-gradient":zx,"-o-radial-gradient":zx,"-webkit-radial-gradient":zx,"-webkit-gradient":gme},xme={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(n,e){if(e.length===0)return[];var t=e[0];return t.type===20&&t.value==="none"?[]:e.filter(function(i){return Em(i)&&wme(i)}).map(function(i){return VI.parse(n,i)})}},bme={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(n,e){return e.map(function(t){if(Us(t))switch(t.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},_me={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(n,e){return Ed(e).map(function(t){return t.filter(wa)}).map(YV)}},Cme={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(n,e){return Ed(e).map(function(t){return t.filter(Us).map(function(i){return i.value}).join(" ")}).map(Sme)}},Sme=function(n){switch(n){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},cm;(function(n){n.AUTO="auto",n.CONTAIN="contain",n.COVER="cover"})(cm||(cm={}));var Tme={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(n,e){return Ed(e).map(function(t){return t.filter(Bme)})}},Bme=function(n){return Us(n)||wa(n)},R5=function(n){return{name:"border-"+n+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},Eme=R5("top"),kme=R5("right"),Ime=R5("bottom"),Fme=R5("left"),O5=function(n){return{name:"border-radius-"+n,initialValue:"0 0",prefix:!1,type:1,parse:function(e,t){return YV(t.filter(wa))}}},Dme=O5("top-left"),jme=O5("top-right"),Pme=O5("bottom-right"),Nme=O5("bottom-left"),U5=function(n){return{name:"border-"+n+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(e,t){switch(t){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},Lme=U5("top"),Mme=U5("right"),Rme=U5("bottom"),Ome=U5("left"),H5=function(n){return{name:"border-"+n+"-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return tw(t)?t.number:0}}},Ume=H5("top"),Hme=H5("right"),Wme=H5("bottom"),Qme=H5("left"),$me={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Vme={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(n,e){switch(e){case"rtl":return 1;case"ltr":default:return 0}}},zme={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(n,e){return e.filter(Us).reduce(function(t,i){return t|Gme(i.value)},0)}},Gme=function(n){switch(n){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},Xme={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(n,e){switch(e){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},Kme={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(n,e){return e.type===20&&e.value==="normal"?0:e.type===17||e.type===15?e.number:0}},sC;(function(n){n.NORMAL="normal",n.STRICT="strict"})(sC||(sC={}));var qme={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(n,e){switch(e){case"strict":return sC.STRICT;case"normal":default:return sC.NORMAL}}},Yme={name:"line-height",initialValue:"normal",prefix:!1,type:4},yL=function(n,e){return Us(n)&&n.value==="normal"?1.2*e:n.type===17?e*n.number:wa(n)?ao(n,e):e},Zme={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(n,e){return e.type===20&&e.value==="none"?null:VI.parse(n,e)}},Jme={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(n,e){switch(e){case"inside":return 0;case"outside":default:return 1}}},qE={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(n,e){switch(e){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},W5=function(n){return{name:"margin-"+n,initialValue:"0",prefix:!1,type:4}},e1e=W5("top"),t1e=W5("right"),n1e=W5("bottom"),i1e=W5("left"),r1e={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(n,e){return e.filter(Us).map(function(t){switch(t.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},s1e={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(n,e){switch(e){case"break-word":return"break-word";case"normal":default:return"normal"}}},Q5=function(n){return{name:"padding-"+n,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},o1e=Q5("top"),a1e=Q5("right"),l1e=Q5("bottom"),c1e=Q5("left"),h1e={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(n,e){switch(e){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},u1e={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(n,e){switch(e){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},d1e={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(n,e){return e.length===1&&KE(e[0],"none")?[]:Ed(e).map(function(t){for(var i={color:fA.TRANSPARENT,offsetX:Dl,offsetY:Dl,blur:Dl},r=0,s=0;s<t.length;s++){var o=t[s];$f(o)?(r===0?i.offsetX=o:r===1?i.offsetY=o:i.blur=o,r++):i.color=Ff.parse(n,o)}return i})}},A1e={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(n,e){switch(e){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},f1e={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(n,e){if(e.type===20&&e.value==="none")return null;if(e.type===18){var t=m1e[e.name];if(typeof t>"u")throw new Error('Attempting to parse an unsupported transform function "'+e.name+'"');return t(e.values)}return null}},p1e=function(n){var e=n.filter(function(t){return t.type===17}).map(function(t){return t.number});return e.length===6?e:null},g1e=function(n){var e=n.filter(function(c){return c.type===17}).map(function(c){return c.number}),t=e[0],i=e[1];e[2],e[3];var r=e[4],s=e[5];e[6],e[7],e[8],e[9],e[10],e[11];var o=e[12],a=e[13];return e[14],e[15],e.length===16?[t,i,r,s,o,a]:null},m1e={matrix:p1e,matrix3d:g1e},vL={type:16,number:50,flags:ew},y1e=[vL,vL],v1e={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(n,e){var t=e.filter(wa);return t.length!==2?y1e:[t[0],t[1]]}},w1e={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(n,e){switch(e){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},jy;(function(n){n.NORMAL="normal",n.BREAK_ALL="break-all",n.KEEP_ALL="keep-all"})(jy||(jy={}));var x1e={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(n,e){switch(e){case"break-all":return jy.BREAK_ALL;case"keep-all":return jy.KEEP_ALL;case"normal":default:return jy.NORMAL}}},b1e={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(n,e){if(e.type===20)return{auto:!0,order:0};if(Ym(e))return{auto:!1,order:e.number};throw new Error("Invalid z-index number parsed")}},Az={name:"time",parse:function(n,e){if(e.type===15)switch(e.unit.toLowerCase()){case"s":return 1e3*e.number;case"ms":return e.number}throw new Error("Unsupported time type")}},_1e={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(n,e){return Ym(e)?e.number:1}},C1e={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},S1e={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(n,e){return e.filter(Us).map(function(t){switch(t.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(t){return t!==0})}},T1e={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(n,e){var t=[],i=[];return e.forEach(function(r){switch(r.type){case 20:case 0:t.push(r.value);break;case 17:t.push(r.number.toString());break;case 4:i.push(t.join(" ")),t.length=0;break}}),t.length&&i.push(t.join(" ")),i.map(function(r){return r.indexOf(" ")===-1?r:"'"+r+"'"})}},B1e={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},E1e={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(n,e){if(Ym(e))return e.number;if(Us(e))switch(e.value){case"bold":return 700;case"normal":default:return 400}return 400}},k1e={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(n,e){return e.filter(Us).map(function(t){return t.value})}},I1e={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(n,e){switch(e){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},Ra=function(n,e){return(n&e)!==0},F1e={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(n,e){if(e.length===0)return[];var t=e[0];return t.type===20&&t.value==="none"?[]:e}},D1e={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(n,e){if(e.length===0)return null;var t=e[0];if(t.type===20&&t.value==="none")return null;for(var i=[],r=e.filter(qV),s=0;s<r.length;s++){var o=r[s],a=r[s+1];if(o.type===20){var c=a&&Ym(a)?a.number:1;i.push({counter:o.value,increment:c})}}return i}},j1e={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(n,e){if(e.length===0)return[];for(var t=[],i=e.filter(qV),r=0;r<i.length;r++){var s=i[r],o=i[r+1];if(Us(s)&&s.value!=="none"){var a=o&&Ym(o)?o.number:0;t.push({counter:s.value,reset:a})}}return t}},P1e={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(n,e){return e.filter(tw).map(function(t){return Az.parse(n,t)})}},N1e={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(n,e){if(e.length===0)return null;var t=e[0];if(t.type===20&&t.value==="none")return null;var i=[],r=e.filter(ame);if(r.length%2!==0)return null;for(var s=0;s<r.length;s+=2){var o=r[s].value,a=r[s+1].value;i.push({open:o,close:a})}return i}},wL=function(n,e,t){if(!n)return"";var i=n[Math.min(e,n.length-1)];return i?t?i.open:i.close:""},L1e={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(n,e){return e.length===1&&KE(e[0],"none")?[]:Ed(e).map(function(t){for(var i={color:255,offsetX:Dl,offsetY:Dl,blur:Dl,spread:Dl,inset:!1},r=0,s=0;s<t.length;s++){var o=t[s];KE(o,"inset")?i.inset=!0:$f(o)?(r===0?i.offsetX=o:r===1?i.offsetY=o:r===2?i.blur=o:i.spread=o,r++):i.color=Ff.parse(n,o)}return i})}},M1e={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(n,e){var t=[0,1,2],i=[];return e.filter(Us).forEach(function(r){switch(r.value){case"stroke":i.push(1);break;case"fill":i.push(0);break;case"markers":i.push(2);break}}),t.forEach(function(r){i.indexOf(r)===-1&&i.push(r)}),i}},R1e={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},O1e={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(n,e){return tw(e)?e.number:0}},U1e=(function(){function n(e,t){var i,r;this.animationDuration=vi(e,P1e,t.animationDuration),this.backgroundClip=vi(e,hme,t.backgroundClip),this.backgroundColor=vi(e,ume,t.backgroundColor),this.backgroundImage=vi(e,xme,t.backgroundImage),this.backgroundOrigin=vi(e,bme,t.backgroundOrigin),this.backgroundPosition=vi(e,_me,t.backgroundPosition),this.backgroundRepeat=vi(e,Cme,t.backgroundRepeat),this.backgroundSize=vi(e,Tme,t.backgroundSize),this.borderTopColor=vi(e,Eme,t.borderTopColor),this.borderRightColor=vi(e,kme,t.borderRightColor),this.borderBottomColor=vi(e,Ime,t.borderBottomColor),this.borderLeftColor=vi(e,Fme,t.borderLeftColor),this.borderTopLeftRadius=vi(e,Dme,t.borderTopLeftRadius),this.borderTopRightRadius=vi(e,jme,t.borderTopRightRadius),this.borderBottomRightRadius=vi(e,Pme,t.borderBottomRightRadius),this.borderBottomLeftRadius=vi(e,Nme,t.borderBottomLeftRadius),this.borderTopStyle=vi(e,Lme,t.borderTopStyle),this.borderRightStyle=vi(e,Mme,t.borderRightStyle),this.borderBottomStyle=vi(e,Rme,t.borderBottomStyle),this.borderLeftStyle=vi(e,Ome,t.borderLeftStyle),this.borderTopWidth=vi(e,Ume,t.borderTopWidth),this.borderRightWidth=vi(e,Hme,t.borderRightWidth),this.borderBottomWidth=vi(e,Wme,t.borderBottomWidth),this.borderLeftWidth=vi(e,Qme,t.borderLeftWidth),this.boxShadow=vi(e,L1e,t.boxShadow),this.color=vi(e,$me,t.color),this.direction=vi(e,Vme,t.direction),this.display=vi(e,zme,t.display),this.float=vi(e,Xme,t.cssFloat),this.fontFamily=vi(e,T1e,t.fontFamily),this.fontSize=vi(e,B1e,t.fontSize),this.fontStyle=vi(e,I1e,t.fontStyle),this.fontVariant=vi(e,k1e,t.fontVariant),this.fontWeight=vi(e,E1e,t.fontWeight),this.letterSpacing=vi(e,Kme,t.letterSpacing),this.lineBreak=vi(e,qme,t.lineBreak),this.lineHeight=vi(e,Yme,t.lineHeight),this.listStyleImage=vi(e,Zme,t.listStyleImage),this.listStylePosition=vi(e,Jme,t.listStylePosition),this.listStyleType=vi(e,qE,t.listStyleType),this.marginTop=vi(e,e1e,t.marginTop),this.marginRight=vi(e,t1e,t.marginRight),this.marginBottom=vi(e,n1e,t.marginBottom),this.marginLeft=vi(e,i1e,t.marginLeft),this.opacity=vi(e,_1e,t.opacity);var s=vi(e,r1e,t.overflow);this.overflowX=s[0],this.overflowY=s[s.length>1?1:0],this.overflowWrap=vi(e,s1e,t.overflowWrap),this.paddingTop=vi(e,o1e,t.paddingTop),this.paddingRight=vi(e,a1e,t.paddingRight),this.paddingBottom=vi(e,l1e,t.paddingBottom),this.paddingLeft=vi(e,c1e,t.paddingLeft),this.paintOrder=vi(e,M1e,t.paintOrder),this.position=vi(e,u1e,t.position),this.textAlign=vi(e,h1e,t.textAlign),this.textDecorationColor=vi(e,C1e,(i=t.textDecorationColor)!==null&&i!==void 0?i:t.color),this.textDecorationLine=vi(e,S1e,(r=t.textDecorationLine)!==null&&r!==void 0?r:t.textDecoration),this.textShadow=vi(e,d1e,t.textShadow),this.textTransform=vi(e,A1e,t.textTransform),this.transform=vi(e,f1e,t.transform),this.transformOrigin=vi(e,v1e,t.transformOrigin),this.visibility=vi(e,w1e,t.visibility),this.webkitTextStrokeColor=vi(e,R1e,t.webkitTextStrokeColor),this.webkitTextStrokeWidth=vi(e,O1e,t.webkitTextStrokeWidth),this.wordBreak=vi(e,x1e,t.wordBreak),this.zIndex=vi(e,b1e,t.zIndex)}return n.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},n.prototype.isTransparent=function(){return Df(this.backgroundColor)},n.prototype.isTransformed=function(){return this.transform!==null},n.prototype.isPositioned=function(){return this.position!==0},n.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},n.prototype.isFloating=function(){return this.float!==0},n.prototype.isInlineLevel=function(){return Ra(this.display,4)||Ra(this.display,33554432)||Ra(this.display,268435456)||Ra(this.display,536870912)||Ra(this.display,67108864)||Ra(this.display,134217728)},n})(),H1e=(function(){function n(e,t){this.content=vi(e,F1e,t.content),this.quotes=vi(e,N1e,t.quotes)}return n})(),xL=(function(){function n(e,t){this.counterIncrement=vi(e,D1e,t.counterIncrement),this.counterReset=vi(e,j1e,t.counterReset)}return n})(),vi=function(n,e,t){var i=new XV,r=t!==null&&typeof t<"u"?t.toString():e.initialValue;i.write(r);var s=new KV(i.read());switch(e.type){case 2:var o=s.parseComponentValue();return e.parse(n,Us(o)?o.value:e.initialValue);case 0:return e.parse(n,s.parseComponentValue());case 1:return e.parse(n,s.parseComponentValues());case 4:return s.parseComponentValue();case 3:switch(e.format){case"angle":return L5.parse(n,s.parseComponentValue());case"color":return Ff.parse(n,s.parseComponentValue());case"image":return VI.parse(n,s.parseComponentValue());case"length":var a=s.parseComponentValue();return $f(a)?a:Dl;case"length-percentage":var c=s.parseComponentValue();return wa(c)?c:Dl;case"time":return Az.parse(n,s.parseComponentValue())}break}},W1e="data-html2canvas-debug",Q1e=function(n){var e=n.getAttribute(W1e);switch(e){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},YE=function(n,e){var t=Q1e(n);return t===1||e===t},kd=(function(){function n(e,t){if(this.context=e,this.textNodes=[],this.elements=[],this.flags=0,YE(t,3))debugger;this.styles=new U1e(e,window.getComputedStyle(t,null)),e6(t)&&(this.styles.animationDuration.some(function(i){return i>0})&&(t.style.animationDuration="0s"),this.styles.transform!==null&&(t.style.transform="none")),this.bounds=P5(this.context,t),YE(t,4)&&(this.flags|=16)}return n})(),$1e="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",bL="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ey=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Gx=0;Gx<bL.length;Gx++)ey[bL.charCodeAt(Gx)]=Gx;var V1e=function(n){var e=n.length*.75,t=n.length,i,r=0,s,o,a,c;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);var h=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),u=Array.isArray(h)?h:new Uint8Array(h);for(i=0;i<t;i+=4)s=ey[n.charCodeAt(i)],o=ey[n.charCodeAt(i+1)],a=ey[n.charCodeAt(i+2)],c=ey[n.charCodeAt(i+3)],u[r++]=s<<2|o>>4,u[r++]=(o&15)<<4|a>>2,u[r++]=(a&3)<<6|c&63;return h},z1e=function(n){for(var e=n.length,t=[],i=0;i<e;i+=2)t.push(n[i+1]<<8|n[i]);return t},G1e=function(n){for(var e=n.length,t=[],i=0;i<e;i+=4)t.push(n[i+3]<<24|n[i+2]<<16|n[i+1]<<8|n[i]);return t},tg=5,zI=11,A4=2,X1e=zI-tg,fz=65536>>tg,K1e=1<<tg,f4=K1e-1,q1e=1024>>tg,Y1e=fz+q1e,Z1e=Y1e,J1e=32,e2e=Z1e+J1e,t2e=65536>>zI,n2e=1<<X1e,i2e=n2e-1,_L=function(n,e,t){return n.slice?n.slice(e,t):new Uint16Array(Array.prototype.slice.call(n,e,t))},r2e=function(n,e,t){return n.slice?n.slice(e,t):new Uint32Array(Array.prototype.slice.call(n,e,t))},s2e=function(n,e){var t=V1e(n),i=Array.isArray(t)?G1e(t):new Uint32Array(t),r=Array.isArray(t)?z1e(t):new Uint16Array(t),s=24,o=_L(r,s/2,i[4]/2),a=i[5]===2?_L(r,(s+i[4])/2):r2e(i,Math.ceil((s+i[4])/4));return new o2e(i[0],i[1],i[2],i[3],o,a)},o2e=(function(){function n(e,t,i,r,s,o){this.initialValue=e,this.errorValue=t,this.highStart=i,this.highValueIndex=r,this.index=s,this.data=o}return n.prototype.get=function(e){var t;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=this.index[e>>tg],t=(t<<A4)+(e&f4),this.data[t];if(e<=65535)return t=this.index[fz+(e-55296>>tg)],t=(t<<A4)+(e&f4),this.data[t];if(e<this.highStart)return t=e2e-t2e+(e>>zI),t=this.index[t],t+=e>>tg&i2e,t=this.index[t],t=(t<<A4)+(e&f4),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},n})(),CL="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a2e=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Xx=0;Xx<CL.length;Xx++)a2e[CL.charCodeAt(Xx)]=Xx;var l2e=1,p4=2,g4=3,SL=4,TL=5,c2e=7,BL=8,m4=9,y4=10,EL=11,kL=12,IL=13,FL=14,v4=15,h2e=function(n){for(var e=[],t=0,i=n.length;t<i;){var r=n.charCodeAt(t++);if(r>=55296&&r<=56319&&t<i){var s=n.charCodeAt(t++);(s&64512)===56320?e.push(((r&1023)<<10)+(s&1023)+65536):(e.push(r),t--)}else e.push(r)}return e},u2e=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,n);var t=n.length;if(!t)return"";for(var i=[],r=-1,s="";++r<t;){var o=n[r];o<=65535?i.push(o):(o-=65536,i.push((o>>10)+55296,o%1024+56320)),(r+1===t||i.length>16384)&&(s+=String.fromCharCode.apply(String,i),i.length=0)}return s},d2e=s2e($1e),Ph="×",w4="÷",A2e=function(n){return d2e.get(n)},f2e=function(n,e,t){var i=t-2,r=e[i],s=e[t-1],o=e[t];if(s===p4&&o===g4)return Ph;if(s===p4||s===g4||s===SL||o===p4||o===g4||o===SL)return w4;if(s===BL&&[BL,m4,EL,kL].indexOf(o)!==-1||(s===EL||s===m4)&&(o===m4||o===y4)||(s===kL||s===y4)&&o===y4||o===IL||o===TL||o===c2e||s===l2e)return Ph;if(s===IL&&o===FL){for(;r===TL;)r=e[--i];if(r===FL)return Ph}if(s===v4&&o===v4){for(var a=0;r===v4;)a++,r=e[--i];if(a%2===0)return Ph}return w4},p2e=function(n){var e=h2e(n),t=e.length,i=0,r=0,s=e.map(A2e);return{next:function(){if(i>=t)return{done:!0,value:null};for(var o=Ph;i<t&&(o=f2e(e,s,++i))===Ph;);if(o!==Ph||i===t){var a=u2e.apply(null,e.slice(r,i));return r=i,{value:a,done:!1}}return{done:!0,value:null}}}},g2e=function(n){for(var e=p2e(n),t=[],i;!(i=e.next()).done;)i.value&&t.push(i.value.slice());return t},m2e=function(n){var e=123;if(n.createRange){var t=n.createRange();if(t.getBoundingClientRect){var i=n.createElement("boundtest");i.style.height=e+"px",i.style.display="block",n.body.appendChild(i),t.selectNode(i);var r=t.getBoundingClientRect(),s=Math.round(r.height);if(n.body.removeChild(i),s===e)return!0}}return!1},y2e=function(n){var e=n.createElement("boundtest");e.style.width="50px",e.style.display="block",e.style.fontSize="12px",e.style.letterSpacing="0px",e.style.wordSpacing="0px",n.body.appendChild(e);var t=n.createRange();e.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var i=e.firstChild,r=N5(i.data).map(function(c){return sa(c)}),s=0,o={},a=r.every(function(c,h){t.setStart(i,s),t.setEnd(i,s+c.length);var u=t.getBoundingClientRect();s+=c.length;var d=u.x>o.x||u.y>o.y;return o=u,h===0?!0:d});return n.body.removeChild(e),a},v2e=function(){return typeof new Image().crossOrigin<"u"},w2e=function(){return typeof new XMLHttpRequest().responseType=="string"},x2e=function(n){var e=new Image,t=n.createElement("canvas"),i=t.getContext("2d");if(!i)return!1;e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{i.drawImage(e,0,0),t.toDataURL()}catch{return!1}return!0},DL=function(n){return n[0]===0&&n[1]===255&&n[2]===0&&n[3]===255},b2e=function(n){var e=n.createElement("canvas"),t=100;e.width=t,e.height=t;var i=e.getContext("2d");if(!i)return Promise.reject(!1);i.fillStyle="rgb(0, 255, 0)",i.fillRect(0,0,t,t);var r=new Image,s=e.toDataURL();r.src=s;var o=ZE(t,t,0,0,r);return i.fillStyle="red",i.fillRect(0,0,t,t),jL(o).then(function(a){i.drawImage(a,0,0);var c=i.getImageData(0,0,t,t).data;i.fillStyle="red",i.fillRect(0,0,t,t);var h=n.createElement("div");return h.style.backgroundImage="url("+s+")",h.style.height=t+"px",DL(c)?jL(ZE(t,t,0,0,h)):Promise.reject(!1)}).then(function(a){return i.drawImage(a,0,0),DL(i.getImageData(0,0,t,t).data)}).catch(function(){return!1})},ZE=function(n,e,t,i,r){var s="http://www.w3.org/2000/svg",o=document.createElementNS(s,"svg"),a=document.createElementNS(s,"foreignObject");return o.setAttributeNS(null,"width",n.toString()),o.setAttributeNS(null,"height",e.toString()),a.setAttributeNS(null,"width","100%"),a.setAttributeNS(null,"height","100%"),a.setAttributeNS(null,"x",t.toString()),a.setAttributeNS(null,"y",i.toString()),a.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(a),a.appendChild(r),o},jL=function(n){return new Promise(function(e,t){var i=new Image;i.onload=function(){return e(i)},i.onerror=t,i.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(n))})},Sl={get SUPPORT_RANGE_BOUNDS(){var n=m2e(document);return Object.defineProperty(Sl,"SUPPORT_RANGE_BOUNDS",{value:n}),n},get SUPPORT_WORD_BREAKING(){var n=Sl.SUPPORT_RANGE_BOUNDS&&y2e(document);return Object.defineProperty(Sl,"SUPPORT_WORD_BREAKING",{value:n}),n},get SUPPORT_SVG_DRAWING(){var n=x2e(document);return Object.defineProperty(Sl,"SUPPORT_SVG_DRAWING",{value:n}),n},get SUPPORT_FOREIGNOBJECT_DRAWING(){var n=typeof Array.from=="function"&&typeof window.fetch=="function"?b2e(document):Promise.resolve(!1);return Object.defineProperty(Sl,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:n}),n},get SUPPORT_CORS_IMAGES(){var n=v2e();return Object.defineProperty(Sl,"SUPPORT_CORS_IMAGES",{value:n}),n},get SUPPORT_RESPONSE_TYPE(){var n=w2e();return Object.defineProperty(Sl,"SUPPORT_RESPONSE_TYPE",{value:n}),n},get SUPPORT_CORS_XHR(){var n="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Sl,"SUPPORT_CORS_XHR",{value:n}),n},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var n=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Sl,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:n}),n}},Py=(function(){function n(e,t){this.text=e,this.bounds=t}return n})(),_2e=function(n,e,t,i){var r=T2e(e,t),s=[],o=0;return r.forEach(function(a){if(t.textDecorationLine.length||a.trim().length>0)if(Sl.SUPPORT_RANGE_BOUNDS){var c=PL(i,o,a.length).getClientRects();if(c.length>1){var h=GI(a),u=0;h.forEach(function(f){s.push(new Py(f,CA.fromDOMRectList(n,PL(i,u+o,f.length).getClientRects()))),u+=f.length})}else s.push(new Py(a,CA.fromDOMRectList(n,c)))}else{var d=i.splitText(a.length);s.push(new Py(a,C2e(n,i))),i=d}else Sl.SUPPORT_RANGE_BOUNDS||(i=i.splitText(a.length));o+=a.length}),s},C2e=function(n,e){var t=e.ownerDocument;if(t){var i=t.createElement("html2canvaswrapper");i.appendChild(e.cloneNode(!0));var r=e.parentNode;if(r){r.replaceChild(i,e);var s=P5(n,i);return i.firstChild&&r.replaceChild(i.firstChild,i),s}}return CA.EMPTY},PL=function(n,e,t){var i=n.ownerDocument;if(!i)throw new Error("Node has no owner document");var r=i.createRange();return r.setStart(n,e),r.setEnd(n,e+t),r},GI=function(n){if(Sl.SUPPORT_NATIVE_TEXT_SEGMENTATION){var e=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(e.segment(n)).map(function(t){return t.segment})}return g2e(n)},S2e=function(n,e){if(Sl.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(t.segment(n)).map(function(i){return i.segment})}return E2e(n,e)},T2e=function(n,e){return e.letterSpacing!==0?GI(n):S2e(n,e)},B2e=[32,160,4961,65792,65793,4153,4241],E2e=function(n,e){for(var t=t0e(n,{lineBreak:e.lineBreak,wordBreak:e.overflowWrap==="break-word"?"break-word":e.wordBreak}),i=[],r,s=function(){if(r.value){var o=r.value.slice(),a=N5(o),c="";a.forEach(function(h){B2e.indexOf(h)===-1?c+=sa(h):(c.length&&i.push(c),i.push(sa(h)),c="")}),c.length&&i.push(c)}};!(r=t.next()).done;)s();return i},k2e=(function(){function n(e,t,i){this.text=I2e(t.data,i.textTransform),this.textBounds=_2e(e,this.text,i,t)}return n})(),I2e=function(n,e){switch(e){case 1:return n.toLowerCase();case 3:return n.replace(F2e,D2e);case 2:return n.toUpperCase();default:return n}},F2e=/(^|\s|:|-|\(|\))([a-z])/g,D2e=function(n,e,t){return n.length>0?e+t.toUpperCase():n},pz=(function(n){Hu(e,n);function e(t,i){var r=n.call(this,t,i)||this;return r.src=i.currentSrc||i.src,r.intrinsicWidth=i.naturalWidth,r.intrinsicHeight=i.naturalHeight,r.context.cache.addImage(r.src),r}return e})(kd),gz=(function(n){Hu(e,n);function e(t,i){var r=n.call(this,t,i)||this;return r.canvas=i,r.intrinsicWidth=i.width,r.intrinsicHeight=i.height,r}return e})(kd),mz=(function(n){Hu(e,n);function e(t,i){var r=n.call(this,t,i)||this,s=new XMLSerializer,o=P5(t,i);return i.setAttribute("width",o.width+"px"),i.setAttribute("height",o.height+"px"),r.svg="data:image/svg+xml,"+encodeURIComponent(s.serializeToString(i)),r.intrinsicWidth=i.width.baseVal.value,r.intrinsicHeight=i.height.baseVal.value,r.context.cache.addImage(r.svg),r}return e})(kd),yz=(function(n){Hu(e,n);function e(t,i){var r=n.call(this,t,i)||this;return r.value=i.value,r}return e})(kd),JE=(function(n){Hu(e,n);function e(t,i){var r=n.call(this,t,i)||this;return r.start=i.start,r.reversed=typeof i.reversed=="boolean"&&i.reversed===!0,r}return e})(kd),j2e=[{type:15,flags:0,unit:"px",number:3}],P2e=[{type:16,flags:0,number:50}],N2e=function(n){return n.width>n.height?new CA(n.left+(n.width-n.height)/2,n.top,n.height,n.height):n.width<n.height?new CA(n.left,n.top+(n.height-n.width)/2,n.width,n.width):n},L2e=function(n){var e=n.type===M2e?new Array(n.value.length+1).join("•"):n.value;return e.length===0?n.placeholder||"":e},oC="checkbox",aC="radio",M2e="password",NL=707406591,XI=(function(n){Hu(e,n);function e(t,i){var r=n.call(this,t,i)||this;switch(r.type=i.type.toLowerCase(),r.checked=i.checked,r.value=L2e(i),(r.type===oC||r.type===aC)&&(r.styles.backgroundColor=3739148031,r.styles.borderTopColor=r.styles.borderRightColor=r.styles.borderBottomColor=r.styles.borderLeftColor=2779096575,r.styles.borderTopWidth=r.styles.borderRightWidth=r.styles.borderBottomWidth=r.styles.borderLeftWidth=1,r.styles.borderTopStyle=r.styles.borderRightStyle=r.styles.borderBottomStyle=r.styles.borderLeftStyle=1,r.styles.backgroundClip=[0],r.styles.backgroundOrigin=[0],r.bounds=N2e(r.bounds)),r.type){case oC:r.styles.borderTopRightRadius=r.styles.borderTopLeftRadius=r.styles.borderBottomRightRadius=r.styles.borderBottomLeftRadius=j2e;break;case aC:r.styles.borderTopRightRadius=r.styles.borderTopLeftRadius=r.styles.borderBottomRightRadius=r.styles.borderBottomLeftRadius=P2e;break}return r}return e})(kd),vz=(function(n){Hu(e,n);function e(t,i){var r=n.call(this,t,i)||this,s=i.options[i.selectedIndex||0];return r.value=s&&s.text||"",r}return e})(kd),wz=(function(n){Hu(e,n);function e(t,i){var r=n.call(this,t,i)||this;return r.value=i.value,r}return e})(kd),xz=(function(n){Hu(e,n);function e(t,i){var r=n.call(this,t,i)||this;r.src=i.src,r.width=parseInt(i.width,10)||0,r.height=parseInt(i.height,10)||0,r.backgroundColor=r.styles.backgroundColor;try{if(i.contentWindow&&i.contentWindow.document&&i.contentWindow.document.documentElement){r.tree=_z(t,i.contentWindow.document.documentElement);var s=i.contentWindow.document.documentElement?Dy(t,getComputedStyle(i.contentWindow.document.documentElement).backgroundColor):fA.TRANSPARENT,o=i.contentWindow.document.body?Dy(t,getComputedStyle(i.contentWindow.document.body).backgroundColor):fA.TRANSPARENT;r.backgroundColor=Df(s)?Df(o)?r.styles.backgroundColor:o:s}}catch{}return r}return e})(kd),R2e=["OL","UL","MENU"],n_=function(n,e,t,i){for(var r=e.firstChild,s=void 0;r;r=s)if(s=r.nextSibling,Cz(r)&&r.data.trim().length>0)t.textNodes.push(new k2e(n,r,t.styles));else if(H0(r))if(Ez(r)&&r.assignedNodes)r.assignedNodes().forEach(function(a){return n_(n,a,t,i)});else{var o=bz(n,r);o.styles.isVisible()&&(O2e(r,o,i)?o.flags|=4:U2e(o.styles)&&(o.flags|=2),R2e.indexOf(r.tagName)!==-1&&(o.flags|=8),t.elements.push(o),r.slot,r.shadowRoot?n_(n,r.shadowRoot,o,i):!lC(r)&&!Sz(r)&&!cC(r)&&n_(n,r,o,i))}},bz=function(n,e){return t6(e)?new pz(n,e):Tz(e)?new gz(n,e):Sz(e)?new mz(n,e):H2e(e)?new yz(n,e):W2e(e)?new JE(n,e):Q2e(e)?new XI(n,e):cC(e)?new vz(n,e):lC(e)?new wz(n,e):Bz(e)?new xz(n,e):new kd(n,e)},_z=function(n,e){var t=bz(n,e);return t.flags|=4,n_(n,e,t,t),t},O2e=function(n,e,t){return e.styles.isPositionedWithZIndex()||e.styles.opacity<1||e.styles.isTransformed()||KI(n)&&t.styles.isTransparent()},U2e=function(n){return n.isPositioned()||n.isFloating()},Cz=function(n){return n.nodeType===Node.TEXT_NODE},H0=function(n){return n.nodeType===Node.ELEMENT_NODE},e6=function(n){return H0(n)&&typeof n.style<"u"&&!i_(n)},i_=function(n){return typeof n.className=="object"},H2e=function(n){return n.tagName==="LI"},W2e=function(n){return n.tagName==="OL"},Q2e=function(n){return n.tagName==="INPUT"},$2e=function(n){return n.tagName==="HTML"},Sz=function(n){return n.tagName==="svg"},KI=function(n){return n.tagName==="BODY"},Tz=function(n){return n.tagName==="CANVAS"},LL=function(n){return n.tagName==="VIDEO"},t6=function(n){return n.tagName==="IMG"},Bz=function(n){return n.tagName==="IFRAME"},ML=function(n){return n.tagName==="STYLE"},V2e=function(n){return n.tagName==="SCRIPT"},lC=function(n){return n.tagName==="TEXTAREA"},cC=function(n){return n.tagName==="SELECT"},Ez=function(n){return n.tagName==="SLOT"},RL=function(n){return n.tagName.indexOf("-")>0},z2e=(function(){function n(){this.counters={}}return n.prototype.getCounterValue=function(e){var t=this.counters[e];return t&&t.length?t[t.length-1]:1},n.prototype.getCounterValues=function(e){var t=this.counters[e];return t||[]},n.prototype.pop=function(e){var t=this;e.forEach(function(i){return t.counters[i].pop()})},n.prototype.parse=function(e){var t=this,i=e.counterIncrement,r=e.counterReset,s=!0;i!==null&&i.forEach(function(a){var c=t.counters[a.counter];c&&a.increment!==0&&(s=!1,c.length||c.push(1),c[Math.max(0,c.length-1)]+=a.increment)});var o=[];return s&&r.forEach(function(a){var c=t.counters[a.counter];o.push(a.counter),c||(c=t.counters[a.counter]=[]),c.push(a.reset)}),o},n})(),OL={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},UL={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["Ք","Փ","Ւ","Ց","Ր","Տ","Վ","Ս","Ռ","Ջ","Պ","Չ","Ո","Շ","Ն","Յ","Մ","Ճ","Ղ","Ձ","Հ","Կ","Ծ","Խ","Լ","Ի","Ժ","Թ","Ը","Է","Զ","Ե","Դ","Գ","Բ","Ա"]},G2e={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["י׳","ט׳","ח׳","ז׳","ו׳","ה׳","ד׳","ג׳","ב׳","א׳","ת","ש","ר","ק","צ","פ","ע","ס","נ","מ","ל","כ","יט","יח","יז","טז","טו","י","ט","ח","ז","ו","ה","ד","ג","ב","א"]},X2e={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["ჵ","ჰ","ჯ","ჴ","ხ","ჭ","წ","ძ","ც","ჩ","შ","ყ","ღ","ქ","ფ","ჳ","ტ","ს","რ","ჟ","პ","ო","ჲ","ნ","მ","ლ","კ","ი","თ","ჱ","ზ","ვ","ე","დ","გ","ბ","ა"]},u0=function(n,e,t,i,r,s){return n<e||n>t?gv(n,r,s.length>0):i.integers.reduce(function(o,a,c){for(;n>=a;)n-=a,o+=i.values[c];return o},"")+s},kz=function(n,e,t,i){var r="";do t||n--,r=i(n)+r,n/=e;while(n*e>=e);return r},na=function(n,e,t,i,r){var s=t-e+1;return(n<0?"-":"")+(kz(Math.abs(n),s,i,function(o){return sa(Math.floor(o%s)+e)})+r)},Sp=function(n,e,t){t===void 0&&(t=". ");var i=e.length;return kz(Math.abs(n),i,!1,function(r){return e[Math.floor(r%i)]})+t},F0=1,hf=2,uf=4,ty=8,Gd=function(n,e,t,i,r,s){if(n<-9999||n>9999)return gv(n,4,r.length>0);var o=Math.abs(n),a=r;if(o===0)return e[0]+a;for(var c=0;o>0&&c<=4;c++){var h=o%10;h===0&&Ra(s,F0)&&a!==""?a=e[h]+a:h>1||h===1&&c===0||h===1&&c===1&&Ra(s,hf)||h===1&&c===1&&Ra(s,uf)&&n>100||h===1&&c>1&&Ra(s,ty)?a=e[h]+(c>0?t[c-1]:"")+a:h===1&&c>0&&(a=t[c-1]+a),o=Math.floor(o/10)}return(n<0?i:"")+a},HL="十百千萬",WL="拾佰仟萬",QL="マイナス",x4="마이너스",gv=function(n,e,t){var i=t?". ":"",r=t?"、":"",s=t?", ":"",o=t?" ":"";switch(e){case 0:return"•"+o;case 1:return"◦"+o;case 2:return"◾"+o;case 5:var a=na(n,48,57,!0,i);return a.length<4?"0"+a:a;case 4:return Sp(n,"〇一二三四五六七八九",r);case 6:return u0(n,1,3999,OL,3,i).toLowerCase();case 7:return u0(n,1,3999,OL,3,i);case 8:return na(n,945,969,!1,i);case 9:return na(n,97,122,!1,i);case 10:return na(n,65,90,!1,i);case 11:return na(n,1632,1641,!0,i);case 12:case 49:return u0(n,1,9999,UL,3,i);case 35:return u0(n,1,9999,UL,3,i).toLowerCase();case 13:return na(n,2534,2543,!0,i);case 14:case 30:return na(n,6112,6121,!0,i);case 15:return Sp(n,"子丑寅卯辰巳午未申酉戌亥",r);case 16:return Sp(n,"甲乙丙丁戊己庚辛壬癸",r);case 17:case 48:return Gd(n,"零一二三四五六七八九",HL,"負",r,hf|uf|ty);case 47:return Gd(n,"零壹貳參肆伍陸柒捌玖",WL,"負",r,F0|hf|uf|ty);case 42:return Gd(n,"零一二三四五六七八九",HL,"负",r,hf|uf|ty);case 41:return Gd(n,"零壹贰叁肆伍陆柒捌玖",WL,"负",r,F0|hf|uf|ty);case 26:return Gd(n,"〇一二三四五六七八九","十百千万",QL,r,0);case 25:return Gd(n,"零壱弐参四伍六七八九","拾百千万",QL,r,F0|hf|uf);case 31:return Gd(n,"영일이삼사오육칠팔구","십백천만",x4,s,F0|hf|uf);case 33:return Gd(n,"零一二三四五六七八九","十百千萬",x4,s,0);case 32:return Gd(n,"零壹貳參四五六七八九","拾百千",x4,s,F0|hf|uf);case 18:return na(n,2406,2415,!0,i);case 20:return u0(n,1,19999,X2e,3,i);case 21:return na(n,2790,2799,!0,i);case 22:return na(n,2662,2671,!0,i);case 22:return u0(n,1,10999,G2e,3,i);case 23:return Sp(n,"あいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむめもやゆよらりるれろわゐゑをん");case 24:return Sp(n,"いろはにほへとちりぬるをわかよたれそつねならむうゐのおくやまけふこえてあさきゆめみしゑひもせす");case 27:return na(n,3302,3311,!0,i);case 28:return Sp(n,"アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヰヱヲン",r);case 29:return Sp(n,"イロハニホヘトチリヌルヲワカヨタレソツネナラムウヰノオクヤマケフコエテアサキユメミシヱヒモセス",r);case 34:return na(n,3792,3801,!0,i);case 37:return na(n,6160,6169,!0,i);case 38:return na(n,4160,4169,!0,i);case 39:return na(n,2918,2927,!0,i);case 40:return na(n,1776,1785,!0,i);case 43:return na(n,3046,3055,!0,i);case 44:return na(n,3174,3183,!0,i);case 45:return na(n,3664,3673,!0,i);case 46:return na(n,3872,3881,!0,i);case 3:default:return na(n,48,57,!0,i)}},Iz="data-html2canvas-ignore",$L=(function(){function n(e,t,i){if(this.context=e,this.options=i,this.scrolledElements=[],this.referenceElement=t,this.counters=new z2e,this.quoteDepth=0,!t.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(t.ownerDocument.documentElement,!1)}return n.prototype.toIFrame=function(e,t){var i=this,r=K2e(e,t);if(!r.contentWindow)return Promise.reject("Unable to find iframe window");var s=e.defaultView.pageXOffset,o=e.defaultView.pageYOffset,a=r.contentWindow,c=a.document,h=Z2e(r).then(function(){return hc(i,void 0,void 0,function(){var u,d;return zl(this,function(f){switch(f.label){case 0:return this.scrolledElements.forEach(nye),a&&(a.scrollTo(t.left,t.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(a.scrollY!==t.top||a.scrollX!==t.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(a.scrollX-t.left,a.scrollY-t.top,0,0))),u=this.options.onclone,d=this.clonedReferenceElement,typeof d>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:c.fonts&&c.fonts.ready?[4,c.fonts.ready]:[3,2];case 1:f.sent(),f.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,Y2e(c)]:[3,4];case 3:f.sent(),f.label=4;case 4:return typeof u=="function"?[2,Promise.resolve().then(function(){return u(c,d)}).then(function(){return r})]:[2,r]}})})});return c.open(),c.write(eye(document.doctype)+"<html></html>"),tye(this.referenceElement.ownerDocument,s,o),c.replaceChild(c.adoptNode(this.documentElement),c.documentElement),c.close(),h},n.prototype.createElementClone=function(e){if(YE(e,2))debugger;if(Tz(e))return this.createCanvasClone(e);if(LL(e))return this.createVideoClone(e);if(ML(e))return this.createStyleClone(e);var t=e.cloneNode(!1);return t6(t)&&(t6(e)&&e.currentSrc&&e.currentSrc!==e.src&&(t.src=e.currentSrc,t.srcset=""),t.loading==="lazy"&&(t.loading="eager")),RL(t)?this.createCustomElementClone(t):t},n.prototype.createCustomElementClone=function(e){var t=document.createElement("html2canvascustomelement");return b4(e.style,t),t},n.prototype.createStyleClone=function(e){try{var t=e.sheet;if(t&&t.cssRules){var i=[].slice.call(t.cssRules,0).reduce(function(s,o){return o&&typeof o.cssText=="string"?s+o.cssText:s},""),r=e.cloneNode(!1);return r.textContent=i,r}}catch(s){if(this.context.logger.error("Unable to access cssRules property",s),s.name!=="SecurityError")throw s}return e.cloneNode(!1)},n.prototype.createCanvasClone=function(e){var t;if(this.options.inlineImages&&e.ownerDocument){var i=e.ownerDocument.createElement("img");try{return i.src=e.toDataURL(),i}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",e)}}var r=e.cloneNode(!1);try{r.width=e.width,r.height=e.height;var s=e.getContext("2d"),o=r.getContext("2d");if(o)if(!this.options.allowTaint&&s)o.putImageData(s.getImageData(0,0,e.width,e.height),0,0);else{var a=(t=e.getContext("webgl2"))!==null&&t!==void 0?t:e.getContext("webgl");if(a){var c=a.getContextAttributes();(c==null?void 0:c.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",e)}o.drawImage(e,0,0)}return r}catch{this.context.logger.info("Unable to clone canvas as it is tainted",e)}return r},n.prototype.createVideoClone=function(e){var t=e.ownerDocument.createElement("canvas");t.width=e.offsetWidth,t.height=e.offsetHeight;var i=t.getContext("2d");try{return i&&(i.drawImage(e,0,0,t.width,t.height),this.options.allowTaint||i.getImageData(0,0,t.width,t.height)),t}catch{this.context.logger.info("Unable to clone video as it is tainted",e)}var r=e.ownerDocument.createElement("canvas");return r.width=e.offsetWidth,r.height=e.offsetHeight,r},n.prototype.appendChildNode=function(e,t,i){(!H0(t)||!V2e(t)&&!t.hasAttribute(Iz)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(t)))&&(!this.options.copyStyles||!H0(t)||!ML(t))&&e.appendChild(this.cloneNode(t,i))},n.prototype.cloneChildNodes=function(e,t,i){for(var r=this,s=e.shadowRoot?e.shadowRoot.firstChild:e.firstChild;s;s=s.nextSibling)if(H0(s)&&Ez(s)&&typeof s.assignedNodes=="function"){var o=s.assignedNodes();o.length&&o.forEach(function(a){return r.appendChildNode(t,a,i)})}else this.appendChildNode(t,s,i)},n.prototype.cloneNode=function(e,t){if(Cz(e))return document.createTextNode(e.data);if(!e.ownerDocument)return e.cloneNode(!1);var i=e.ownerDocument.defaultView;if(i&&H0(e)&&(e6(e)||i_(e))){var r=this.createElementClone(e);r.style.transitionProperty="none";var s=i.getComputedStyle(e),o=i.getComputedStyle(e,":before"),a=i.getComputedStyle(e,":after");this.referenceElement===e&&e6(r)&&(this.clonedReferenceElement=r),KI(r)&&sye(r);var c=this.counters.parse(new xL(this.context,s)),h=this.resolvePseudoContent(e,r,o,Ny.BEFORE);RL(e)&&(t=!0),LL(e)||this.cloneChildNodes(e,r,t),h&&r.insertBefore(h,r.firstChild);var u=this.resolvePseudoContent(e,r,a,Ny.AFTER);return u&&r.appendChild(u),this.counters.pop(c),(s&&(this.options.copyStyles||i_(e))&&!Bz(e)||t)&&b4(s,r),(e.scrollTop!==0||e.scrollLeft!==0)&&this.scrolledElements.push([r,e.scrollLeft,e.scrollTop]),(lC(e)||cC(e))&&(lC(r)||cC(r))&&(r.value=e.value),r}return e.cloneNode(!1)},n.prototype.resolvePseudoContent=function(e,t,i,r){var s=this;if(i){var o=i.content,a=t.ownerDocument;if(!(!a||!o||o==="none"||o==="-moz-alt-content"||i.display==="none")){this.counters.parse(new xL(this.context,i));var c=new H1e(this.context,i),h=a.createElement("html2canvaspseudoelement");b4(i,h),c.content.forEach(function(d){if(d.type===0)h.appendChild(a.createTextNode(d.value));else if(d.type===22){var f=a.createElement("img");f.src=d.value,f.style.opacity="1",h.appendChild(f)}else if(d.type===18){if(d.name==="attr"){var A=d.values.filter(Us);A.length&&h.appendChild(a.createTextNode(e.getAttribute(A[0].value)||""))}else if(d.name==="counter"){var g=d.values.filter(Em),p=g[0],y=g[1];if(p&&Us(p)){var v=s.counters.getCounterValue(p.value),m=y&&Us(y)?qE.parse(s.context,y.value):3;h.appendChild(a.createTextNode(gv(v,m,!1)))}}else if(d.name==="counters"){var w=d.values.filter(Em),p=w[0],x=w[1],y=w[2];if(p&&Us(p)){var T=s.counters.getCounterValues(p.value),j=y&&Us(y)?qE.parse(s.context,y.value):3,D=x&&x.type===0?x.value:"",b=T.map(function(S){return gv(S,j,!1)}).join(D);h.appendChild(a.createTextNode(b))}}}else if(d.type===20)switch(d.value){case"open-quote":h.appendChild(a.createTextNode(wL(c.quotes,s.quoteDepth++,!0)));break;case"close-quote":h.appendChild(a.createTextNode(wL(c.quotes,--s.quoteDepth,!1)));break;default:h.appendChild(a.createTextNode(d.value))}}),h.className=n6+" "+i6;var u=r===Ny.BEFORE?" "+n6:" "+i6;return i_(t)?t.className.baseValue+=u:t.className+=u,h}}},n.destroy=function(e){return e.parentNode?(e.parentNode.removeChild(e),!0):!1},n})(),Ny;(function(n){n[n.BEFORE=0]="BEFORE",n[n.AFTER=1]="AFTER"})(Ny||(Ny={}));var K2e=function(n,e){var t=n.createElement("iframe");return t.className="html2canvas-container",t.style.visibility="hidden",t.style.position="fixed",t.style.left="-10000px",t.style.top="0px",t.style.border="0",t.width=e.width.toString(),t.height=e.height.toString(),t.scrolling="no",t.setAttribute(Iz,"true"),n.body.appendChild(t),t},q2e=function(n){return new Promise(function(e){if(n.complete){e();return}if(!n.src){e();return}n.onload=e,n.onerror=e})},Y2e=function(n){return Promise.all([].slice.call(n.images,0).map(q2e))},Z2e=function(n){return new Promise(function(e,t){var i=n.contentWindow;if(!i)return t("No window assigned for iframe");var r=i.document;i.onload=n.onload=function(){i.onload=n.onload=null;var s=setInterval(function(){r.body.childNodes.length>0&&r.readyState==="complete"&&(clearInterval(s),e(n))},50)}})},J2e=["all","d","content"],b4=function(n,e){for(var t=n.length-1;t>=0;t--){var i=n.item(t);J2e.indexOf(i)===-1&&e.style.setProperty(i,n.getPropertyValue(i))}return e},eye=function(n){var e="";return n&&(e+="<!DOCTYPE ",n.name&&(e+=n.name),n.internalSubset&&(e+=n.internalSubset),n.publicId&&(e+='"'+n.publicId+'"'),n.systemId&&(e+='"'+n.systemId+'"'),e+=">"),e},tye=function(n,e,t){n&&n.defaultView&&(e!==n.defaultView.pageXOffset||t!==n.defaultView.pageYOffset)&&n.defaultView.scrollTo(e,t)},nye=function(n){var e=n[0],t=n[1],i=n[2];e.scrollLeft=t,e.scrollTop=i},iye=":before",rye=":after",n6="___html2canvas___pseudoelement_before",i6="___html2canvas___pseudoelement_after",VL=`{
    content: "" !important;
    display: none !important;
}`,sye=function(n){oye(n,"."+n6+iye+VL+`
         .`+i6+rye+VL)},oye=function(n,e){var t=n.ownerDocument;if(t){var i=t.createElement("style");i.textContent=e,n.appendChild(i)}},Fz=(function(){function n(){}return n.getOrigin=function(e){var t=n._link;return t?(t.href=e,t.href=t.href,t.protocol+t.hostname+t.port):"about:blank"},n.isSameOrigin=function(e){return n.getOrigin(e)===n._origin},n.setContext=function(e){n._link=e.document.createElement("a"),n._origin=n.getOrigin(e.location.href)},n._origin="about:blank",n})(),aye=(function(){function n(e,t){this.context=e,this._options=t,this._cache={}}return n.prototype.addImage=function(e){var t=Promise.resolve();return this.has(e)||(C4(e)||uye(e))&&(this._cache[e]=this.loadImage(e)).catch(function(){}),t},n.prototype.match=function(e){return this._cache[e]},n.prototype.loadImage=function(e){return hc(this,void 0,void 0,function(){var t,i,r,s,o=this;return zl(this,function(a){switch(a.label){case 0:return t=Fz.isSameOrigin(e),i=!_4(e)&&this._options.useCORS===!0&&Sl.SUPPORT_CORS_IMAGES&&!t,r=!_4(e)&&!t&&!C4(e)&&typeof this._options.proxy=="string"&&Sl.SUPPORT_CORS_XHR&&!i,!t&&this._options.allowTaint===!1&&!_4(e)&&!C4(e)&&!r&&!i?[2]:(s=e,r?[4,this.proxy(s)]:[3,2]);case 1:s=a.sent(),a.label=2;case 2:return this.context.logger.debug("Added image "+e.substring(0,256)),[4,new Promise(function(c,h){var u=new Image;u.onload=function(){return c(u)},u.onerror=h,(dye(s)||i)&&(u.crossOrigin="anonymous"),u.src=s,u.complete===!0&&setTimeout(function(){return c(u)},500),o._options.imageTimeout>0&&setTimeout(function(){return h("Timed out ("+o._options.imageTimeout+"ms) loading image")},o._options.imageTimeout)})];case 3:return[2,a.sent()]}})})},n.prototype.has=function(e){return typeof this._cache[e]<"u"},n.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},n.prototype.proxy=function(e){var t=this,i=this._options.proxy;if(!i)throw new Error("No proxy defined");var r=e.substring(0,256);return new Promise(function(s,o){var a=Sl.SUPPORT_RESPONSE_TYPE?"blob":"text",c=new XMLHttpRequest;c.onload=function(){if(c.status===200)if(a==="text")s(c.response);else{var d=new FileReader;d.addEventListener("load",function(){return s(d.result)},!1),d.addEventListener("error",function(f){return o(f)},!1),d.readAsDataURL(c.response)}else o("Failed to proxy resource "+r+" with status code "+c.status)},c.onerror=o;var h=i.indexOf("?")>-1?"&":"?";if(c.open("GET",""+i+h+"url="+encodeURIComponent(e)+"&responseType="+a),a!=="text"&&c instanceof XMLHttpRequest&&(c.responseType=a),t._options.imageTimeout){var u=t._options.imageTimeout;c.timeout=u,c.ontimeout=function(){return o("Timed out ("+u+"ms) proxying "+r)}}c.send()})},n})(),lye=/^data:image\/svg\+xml/i,cye=/^data:image\/.*;base64,/i,hye=/^data:image\/.*/i,uye=function(n){return Sl.SUPPORT_SVG_DRAWING||!Aye(n)},_4=function(n){return hye.test(n)},dye=function(n){return cye.test(n)},C4=function(n){return n.substr(0,4)==="blob"},Aye=function(n){return n.substr(-3).toLowerCase()==="svg"||lye.test(n)},di=(function(){function n(e,t){this.type=0,this.x=e,this.y=t}return n.prototype.add=function(e,t){return new n(this.x+e,this.y+t)},n})(),d0=function(n,e,t){return new di(n.x+(e.x-n.x)*t,n.y+(e.y-n.y)*t)},Kx=(function(){function n(e,t,i,r){this.type=1,this.start=e,this.startControl=t,this.endControl=i,this.end=r}return n.prototype.subdivide=function(e,t){var i=d0(this.start,this.startControl,e),r=d0(this.startControl,this.endControl,e),s=d0(this.endControl,this.end,e),o=d0(i,r,e),a=d0(r,s,e),c=d0(o,a,e);return t?new n(this.start,i,o,c):new n(c,a,s,this.end)},n.prototype.add=function(e,t){return new n(this.start.add(e,t),this.startControl.add(e,t),this.endControl.add(e,t),this.end.add(e,t))},n.prototype.reverse=function(){return new n(this.end,this.endControl,this.startControl,this.start)},n})(),Mh=function(n){return n.type===1},fye=(function(){function n(e){var t=e.styles,i=e.bounds,r=J2(t.borderTopLeftRadius,i.width,i.height),s=r[0],o=r[1],a=J2(t.borderTopRightRadius,i.width,i.height),c=a[0],h=a[1],u=J2(t.borderBottomRightRadius,i.width,i.height),d=u[0],f=u[1],A=J2(t.borderBottomLeftRadius,i.width,i.height),g=A[0],p=A[1],y=[];y.push((s+c)/i.width),y.push((g+d)/i.width),y.push((o+p)/i.height),y.push((h+f)/i.height);var v=Math.max.apply(Math,y);v>1&&(s/=v,o/=v,c/=v,h/=v,d/=v,f/=v,g/=v,p/=v);var m=i.width-c,w=i.height-f,x=i.width-d,T=i.height-p,j=t.borderTopWidth,D=t.borderRightWidth,b=t.borderBottomWidth,_=t.borderLeftWidth,I=ao(t.paddingTop,e.bounds.width),S=ao(t.paddingRight,e.bounds.width),F=ao(t.paddingBottom,e.bounds.width),B=ao(t.paddingLeft,e.bounds.width);this.topLeftBorderDoubleOuterBox=s>0||o>0?So(i.left+_/3,i.top+j/3,s-_/3,o-j/3,Ts.TOP_LEFT):new di(i.left+_/3,i.top+j/3),this.topRightBorderDoubleOuterBox=s>0||o>0?So(i.left+m,i.top+j/3,c-D/3,h-j/3,Ts.TOP_RIGHT):new di(i.left+i.width-D/3,i.top+j/3),this.bottomRightBorderDoubleOuterBox=d>0||f>0?So(i.left+x,i.top+w,d-D/3,f-b/3,Ts.BOTTOM_RIGHT):new di(i.left+i.width-D/3,i.top+i.height-b/3),this.bottomLeftBorderDoubleOuterBox=g>0||p>0?So(i.left+_/3,i.top+T,g-_/3,p-b/3,Ts.BOTTOM_LEFT):new di(i.left+_/3,i.top+i.height-b/3),this.topLeftBorderDoubleInnerBox=s>0||o>0?So(i.left+_*2/3,i.top+j*2/3,s-_*2/3,o-j*2/3,Ts.TOP_LEFT):new di(i.left+_*2/3,i.top+j*2/3),this.topRightBorderDoubleInnerBox=s>0||o>0?So(i.left+m,i.top+j*2/3,c-D*2/3,h-j*2/3,Ts.TOP_RIGHT):new di(i.left+i.width-D*2/3,i.top+j*2/3),this.bottomRightBorderDoubleInnerBox=d>0||f>0?So(i.left+x,i.top+w,d-D*2/3,f-b*2/3,Ts.BOTTOM_RIGHT):new di(i.left+i.width-D*2/3,i.top+i.height-b*2/3),this.bottomLeftBorderDoubleInnerBox=g>0||p>0?So(i.left+_*2/3,i.top+T,g-_*2/3,p-b*2/3,Ts.BOTTOM_LEFT):new di(i.left+_*2/3,i.top+i.height-b*2/3),this.topLeftBorderStroke=s>0||o>0?So(i.left+_/2,i.top+j/2,s-_/2,o-j/2,Ts.TOP_LEFT):new di(i.left+_/2,i.top+j/2),this.topRightBorderStroke=s>0||o>0?So(i.left+m,i.top+j/2,c-D/2,h-j/2,Ts.TOP_RIGHT):new di(i.left+i.width-D/2,i.top+j/2),this.bottomRightBorderStroke=d>0||f>0?So(i.left+x,i.top+w,d-D/2,f-b/2,Ts.BOTTOM_RIGHT):new di(i.left+i.width-D/2,i.top+i.height-b/2),this.bottomLeftBorderStroke=g>0||p>0?So(i.left+_/2,i.top+T,g-_/2,p-b/2,Ts.BOTTOM_LEFT):new di(i.left+_/2,i.top+i.height-b/2),this.topLeftBorderBox=s>0||o>0?So(i.left,i.top,s,o,Ts.TOP_LEFT):new di(i.left,i.top),this.topRightBorderBox=c>0||h>0?So(i.left+m,i.top,c,h,Ts.TOP_RIGHT):new di(i.left+i.width,i.top),this.bottomRightBorderBox=d>0||f>0?So(i.left+x,i.top+w,d,f,Ts.BOTTOM_RIGHT):new di(i.left+i.width,i.top+i.height),this.bottomLeftBorderBox=g>0||p>0?So(i.left,i.top+T,g,p,Ts.BOTTOM_LEFT):new di(i.left,i.top+i.height),this.topLeftPaddingBox=s>0||o>0?So(i.left+_,i.top+j,Math.max(0,s-_),Math.max(0,o-j),Ts.TOP_LEFT):new di(i.left+_,i.top+j),this.topRightPaddingBox=c>0||h>0?So(i.left+Math.min(m,i.width-D),i.top+j,m>i.width+D?0:Math.max(0,c-D),Math.max(0,h-j),Ts.TOP_RIGHT):new di(i.left+i.width-D,i.top+j),this.bottomRightPaddingBox=d>0||f>0?So(i.left+Math.min(x,i.width-_),i.top+Math.min(w,i.height-b),Math.max(0,d-D),Math.max(0,f-b),Ts.BOTTOM_RIGHT):new di(i.left+i.width-D,i.top+i.height-b),this.bottomLeftPaddingBox=g>0||p>0?So(i.left+_,i.top+Math.min(T,i.height-b),Math.max(0,g-_),Math.max(0,p-b),Ts.BOTTOM_LEFT):new di(i.left+_,i.top+i.height-b),this.topLeftContentBox=s>0||o>0?So(i.left+_+B,i.top+j+I,Math.max(0,s-(_+B)),Math.max(0,o-(j+I)),Ts.TOP_LEFT):new di(i.left+_+B,i.top+j+I),this.topRightContentBox=c>0||h>0?So(i.left+Math.min(m,i.width+_+B),i.top+j+I,m>i.width+_+B?0:c-_+B,h-(j+I),Ts.TOP_RIGHT):new di(i.left+i.width-(D+S),i.top+j+I),this.bottomRightContentBox=d>0||f>0?So(i.left+Math.min(x,i.width-(_+B)),i.top+Math.min(w,i.height+j+I),Math.max(0,d-(D+S)),f-(b+F),Ts.BOTTOM_RIGHT):new di(i.left+i.width-(D+S),i.top+i.height-(b+F)),this.bottomLeftContentBox=g>0||p>0?So(i.left+_+B,i.top+T,Math.max(0,g-(_+B)),p-(b+F),Ts.BOTTOM_LEFT):new di(i.left+_+B,i.top+i.height-(b+F))}return n})(),Ts;(function(n){n[n.TOP_LEFT=0]="TOP_LEFT",n[n.TOP_RIGHT=1]="TOP_RIGHT",n[n.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",n[n.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(Ts||(Ts={}));var So=function(n,e,t,i,r){var s=4*((Math.sqrt(2)-1)/3),o=t*s,a=i*s,c=n+t,h=e+i;switch(r){case Ts.TOP_LEFT:return new Kx(new di(n,h),new di(n,h-a),new di(c-o,e),new di(c,e));case Ts.TOP_RIGHT:return new Kx(new di(n,e),new di(n+o,e),new di(c,h-a),new di(c,h));case Ts.BOTTOM_RIGHT:return new Kx(new di(c,e),new di(c,e+a),new di(n+o,h),new di(n,h));case Ts.BOTTOM_LEFT:default:return new Kx(new di(c,h),new di(c-o,h),new di(n,e+a),new di(n,e))}},hC=function(n){return[n.topLeftBorderBox,n.topRightBorderBox,n.bottomRightBorderBox,n.bottomLeftBorderBox]},pye=function(n){return[n.topLeftContentBox,n.topRightContentBox,n.bottomRightContentBox,n.bottomLeftContentBox]},uC=function(n){return[n.topLeftPaddingBox,n.topRightPaddingBox,n.bottomRightPaddingBox,n.bottomLeftPaddingBox]},gye=(function(){function n(e,t,i){this.offsetX=e,this.offsetY=t,this.matrix=i,this.type=0,this.target=6}return n})(),qx=(function(){function n(e,t){this.path=e,this.target=t,this.type=1}return n})(),mye=(function(){function n(e){this.opacity=e,this.type=2,this.target=6}return n})(),yye=function(n){return n.type===0},Dz=function(n){return n.type===1},vye=function(n){return n.type===2},zL=function(n,e){return n.length===e.length?n.some(function(t,i){return t===e[i]}):!1},wye=function(n,e,t,i,r){return n.map(function(s,o){switch(o){case 0:return s.add(e,t);case 1:return s.add(e+i,t);case 2:return s.add(e+i,t+r);case 3:return s.add(e,t+r)}return s})},jz=(function(){function n(e){this.element=e,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return n})(),Pz=(function(){function n(e,t){if(this.container=e,this.parent=t,this.effects=[],this.curves=new fye(this.container),this.container.styles.opacity<1&&this.effects.push(new mye(this.container.styles.opacity)),this.container.styles.transform!==null){var i=this.container.bounds.left+this.container.styles.transformOrigin[0].number,r=this.container.bounds.top+this.container.styles.transformOrigin[1].number,s=this.container.styles.transform;this.effects.push(new gye(i,r,s))}if(this.container.styles.overflowX!==0){var o=hC(this.curves),a=uC(this.curves);zL(o,a)?this.effects.push(new qx(o,6)):(this.effects.push(new qx(o,2)),this.effects.push(new qx(a,4)))}}return n.prototype.getEffects=function(e){for(var t=[2,3].indexOf(this.container.styles.position)===-1,i=this.parent,r=this.effects.slice(0);i;){var s=i.effects.filter(function(c){return!Dz(c)});if(t||i.container.styles.position!==0||!i.parent){if(r.unshift.apply(r,s),t=[2,3].indexOf(i.container.styles.position)===-1,i.container.styles.overflowX!==0){var o=hC(i.curves),a=uC(i.curves);zL(o,a)||r.unshift(new qx(a,6))}}else r.unshift.apply(r,s);i=i.parent}return r.filter(function(c){return Ra(c.target,e)})},n})(),r6=function(n,e,t,i){n.container.elements.forEach(function(r){var s=Ra(r.flags,4),o=Ra(r.flags,2),a=new Pz(r,n);Ra(r.styles.display,2048)&&i.push(a);var c=Ra(r.flags,8)?[]:i;if(s||o){var h=s||r.styles.isPositioned()?t:e,u=new jz(a);if(r.styles.isPositioned()||r.styles.opacity<1||r.styles.isTransformed()){var d=r.styles.zIndex.order;if(d<0){var f=0;h.negativeZIndex.some(function(g,p){return d>g.element.container.styles.zIndex.order?(f=p,!1):f>0}),h.negativeZIndex.splice(f,0,u)}else if(d>0){var A=0;h.positiveZIndex.some(function(g,p){return d>=g.element.container.styles.zIndex.order?(A=p+1,!1):A>0}),h.positiveZIndex.splice(A,0,u)}else h.zeroOrAutoZIndexOrTransformedOrOpacity.push(u)}else r.styles.isFloating()?h.nonPositionedFloats.push(u):h.nonPositionedInlineLevel.push(u);r6(a,u,s?u:t,c)}else r.styles.isInlineLevel()?e.inlineLevel.push(a):e.nonInlineLevel.push(a),r6(a,e,t,c);Ra(r.flags,8)&&Nz(r,c)})},Nz=function(n,e){for(var t=n instanceof JE?n.start:1,i=n instanceof JE?n.reversed:!1,r=0;r<e.length;r++){var s=e[r];s.container instanceof yz&&typeof s.container.value=="number"&&s.container.value!==0&&(t=s.container.value),s.listValue=gv(t,s.container.styles.listStyleType,!0),t+=i?-1:1}},xye=function(n){var e=new Pz(n,null),t=new jz(e),i=[];return r6(e,t,t,i),Nz(e.container,i),t},GL=function(n,e){switch(e){case 0:return $h(n.topLeftBorderBox,n.topLeftPaddingBox,n.topRightBorderBox,n.topRightPaddingBox);case 1:return $h(n.topRightBorderBox,n.topRightPaddingBox,n.bottomRightBorderBox,n.bottomRightPaddingBox);case 2:return $h(n.bottomRightBorderBox,n.bottomRightPaddingBox,n.bottomLeftBorderBox,n.bottomLeftPaddingBox);case 3:default:return $h(n.bottomLeftBorderBox,n.bottomLeftPaddingBox,n.topLeftBorderBox,n.topLeftPaddingBox)}},bye=function(n,e){switch(e){case 0:return $h(n.topLeftBorderBox,n.topLeftBorderDoubleOuterBox,n.topRightBorderBox,n.topRightBorderDoubleOuterBox);case 1:return $h(n.topRightBorderBox,n.topRightBorderDoubleOuterBox,n.bottomRightBorderBox,n.bottomRightBorderDoubleOuterBox);case 2:return $h(n.bottomRightBorderBox,n.bottomRightBorderDoubleOuterBox,n.bottomLeftBorderBox,n.bottomLeftBorderDoubleOuterBox);case 3:default:return $h(n.bottomLeftBorderBox,n.bottomLeftBorderDoubleOuterBox,n.topLeftBorderBox,n.topLeftBorderDoubleOuterBox)}},_ye=function(n,e){switch(e){case 0:return $h(n.topLeftBorderDoubleInnerBox,n.topLeftPaddingBox,n.topRightBorderDoubleInnerBox,n.topRightPaddingBox);case 1:return $h(n.topRightBorderDoubleInnerBox,n.topRightPaddingBox,n.bottomRightBorderDoubleInnerBox,n.bottomRightPaddingBox);case 2:return $h(n.bottomRightBorderDoubleInnerBox,n.bottomRightPaddingBox,n.bottomLeftBorderDoubleInnerBox,n.bottomLeftPaddingBox);case 3:default:return $h(n.bottomLeftBorderDoubleInnerBox,n.bottomLeftPaddingBox,n.topLeftBorderDoubleInnerBox,n.topLeftPaddingBox)}},Cye=function(n,e){switch(e){case 0:return Yx(n.topLeftBorderStroke,n.topRightBorderStroke);case 1:return Yx(n.topRightBorderStroke,n.bottomRightBorderStroke);case 2:return Yx(n.bottomRightBorderStroke,n.bottomLeftBorderStroke);case 3:default:return Yx(n.bottomLeftBorderStroke,n.topLeftBorderStroke)}},Yx=function(n,e){var t=[];return Mh(n)?t.push(n.subdivide(.5,!1)):t.push(n),Mh(e)?t.push(e.subdivide(.5,!0)):t.push(e),t},$h=function(n,e,t,i){var r=[];return Mh(n)?r.push(n.subdivide(.5,!1)):r.push(n),Mh(t)?r.push(t.subdivide(.5,!0)):r.push(t),Mh(i)?r.push(i.subdivide(.5,!0).reverse()):r.push(i),Mh(e)?r.push(e.subdivide(.5,!1).reverse()):r.push(e),r},Lz=function(n){var e=n.bounds,t=n.styles;return e.add(t.borderLeftWidth,t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth),-(t.borderTopWidth+t.borderBottomWidth))},dC=function(n){var e=n.styles,t=n.bounds,i=ao(e.paddingLeft,t.width),r=ao(e.paddingRight,t.width),s=ao(e.paddingTop,t.width),o=ao(e.paddingBottom,t.width);return t.add(i+e.borderLeftWidth,s+e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth+i+r),-(e.borderTopWidth+e.borderBottomWidth+s+o))},Sye=function(n,e){return n===0?e.bounds:n===2?dC(e):Lz(e)},Tye=function(n,e){return n===0?e.bounds:n===2?dC(e):Lz(e)},S4=function(n,e,t){var i=Sye(D0(n.styles.backgroundOrigin,e),n),r=Tye(D0(n.styles.backgroundClip,e),n),s=Bye(D0(n.styles.backgroundSize,e),t,i),o=s[0],a=s[1],c=J2(D0(n.styles.backgroundPosition,e),i.width-o,i.height-a),h=Eye(D0(n.styles.backgroundRepeat,e),c,s,i,r),u=Math.round(i.left+c[0]),d=Math.round(i.top+c[1]);return[h,u,d,o,a]},A0=function(n){return Us(n)&&n.value===cm.AUTO},Zx=function(n){return typeof n=="number"},Bye=function(n,e,t){var i=e[0],r=e[1],s=e[2],o=n[0],a=n[1];if(!o)return[0,0];if(wa(o)&&a&&wa(a))return[ao(o,t.width),ao(a,t.height)];var c=Zx(s);if(Us(o)&&(o.value===cm.CONTAIN||o.value===cm.COVER)){if(Zx(s)){var h=t.width/t.height;return h<s!=(o.value===cm.COVER)?[t.width,t.width/s]:[t.height*s,t.height]}return[t.width,t.height]}var u=Zx(i),d=Zx(r),f=u||d;if(A0(o)&&(!a||A0(a))){if(u&&d)return[i,r];if(!c&&!f)return[t.width,t.height];if(f&&c){var A=u?i:r*s,g=d?r:i/s;return[A,g]}var p=u?i:t.width,y=d?r:t.height;return[p,y]}if(c){var v=0,m=0;return wa(o)?v=ao(o,t.width):wa(a)&&(m=ao(a,t.height)),A0(o)?v=m*s:(!a||A0(a))&&(m=v/s),[v,m]}var w=null,x=null;if(wa(o)?w=ao(o,t.width):a&&wa(a)&&(x=ao(a,t.height)),w!==null&&(!a||A0(a))&&(x=u&&d?w/i*r:t.height),x!==null&&A0(o)&&(w=u&&d?x/r*i:t.width),w!==null&&x!==null)return[w,x];throw new Error("Unable to calculate background-size for element")},D0=function(n,e){var t=n[e];return typeof t>"u"?n[0]:t},Eye=function(n,e,t,i,r){var s=e[0],o=e[1],a=t[0],c=t[1];switch(n){case 2:return[new di(Math.round(i.left),Math.round(i.top+o)),new di(Math.round(i.left+i.width),Math.round(i.top+o)),new di(Math.round(i.left+i.width),Math.round(c+i.top+o)),new di(Math.round(i.left),Math.round(c+i.top+o))];case 3:return[new di(Math.round(i.left+s),Math.round(i.top)),new di(Math.round(i.left+s+a),Math.round(i.top)),new di(Math.round(i.left+s+a),Math.round(i.height+i.top)),new di(Math.round(i.left+s),Math.round(i.height+i.top))];case 1:return[new di(Math.round(i.left+s),Math.round(i.top+o)),new di(Math.round(i.left+s+a),Math.round(i.top+o)),new di(Math.round(i.left+s+a),Math.round(i.top+o+c)),new di(Math.round(i.left+s),Math.round(i.top+o+c))];default:return[new di(Math.round(r.left),Math.round(r.top)),new di(Math.round(r.left+r.width),Math.round(r.top)),new di(Math.round(r.left+r.width),Math.round(r.height+r.top)),new di(Math.round(r.left),Math.round(r.height+r.top))]}},kye="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",XL="Hidden Text",Iye=(function(){function n(e){this._data={},this._document=e}return n.prototype.parseMetrics=function(e,t){var i=this._document.createElement("div"),r=this._document.createElement("img"),s=this._document.createElement("span"),o=this._document.body;i.style.visibility="hidden",i.style.fontFamily=e,i.style.fontSize=t,i.style.margin="0",i.style.padding="0",i.style.whiteSpace="nowrap",o.appendChild(i),r.src=kye,r.width=1,r.height=1,r.style.margin="0",r.style.padding="0",r.style.verticalAlign="baseline",s.style.fontFamily=e,s.style.fontSize=t,s.style.margin="0",s.style.padding="0",s.appendChild(this._document.createTextNode(XL)),i.appendChild(s),i.appendChild(r);var a=r.offsetTop-s.offsetTop+2;i.removeChild(s),i.appendChild(this._document.createTextNode(XL)),i.style.lineHeight="normal",r.style.verticalAlign="super";var c=r.offsetTop-i.offsetTop+2;return o.removeChild(i),{baseline:a,middle:c}},n.prototype.getMetrics=function(e,t){var i=e+" "+t;return typeof this._data[i]>"u"&&(this._data[i]=this.parseMetrics(e,t)),this._data[i]},n})(),Mz=(function(){function n(e,t){this.context=e,this.options=t}return n})(),Fye=1e4,Dye=(function(n){Hu(e,n);function e(t,i){var r=n.call(this,t,i)||this;return r._activeEffects=[],r.canvas=i.canvas?i.canvas:document.createElement("canvas"),r.ctx=r.canvas.getContext("2d"),i.canvas||(r.canvas.width=Math.floor(i.width*i.scale),r.canvas.height=Math.floor(i.height*i.scale),r.canvas.style.width=i.width+"px",r.canvas.style.height=i.height+"px"),r.fontMetrics=new Iye(document),r.ctx.scale(r.options.scale,r.options.scale),r.ctx.translate(-i.x,-i.y),r.ctx.textBaseline="bottom",r._activeEffects=[],r.context.logger.debug("Canvas renderer initialized ("+i.width+"x"+i.height+") with scale "+i.scale),r}return e.prototype.applyEffects=function(t){for(var i=this;this._activeEffects.length;)this.popEffect();t.forEach(function(r){return i.applyEffect(r)})},e.prototype.applyEffect=function(t){this.ctx.save(),vye(t)&&(this.ctx.globalAlpha=t.opacity),yye(t)&&(this.ctx.translate(t.offsetX,t.offsetY),this.ctx.transform(t.matrix[0],t.matrix[1],t.matrix[2],t.matrix[3],t.matrix[4],t.matrix[5]),this.ctx.translate(-t.offsetX,-t.offsetY)),Dz(t)&&(this.path(t.path),this.ctx.clip()),this._activeEffects.push(t)},e.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},e.prototype.renderStack=function(t){return hc(this,void 0,void 0,function(){var i;return zl(this,function(r){switch(r.label){case 0:return i=t.element.container.styles,i.isVisible()?[4,this.renderStackContent(t)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})},e.prototype.renderNode=function(t){return hc(this,void 0,void 0,function(){return zl(this,function(i){switch(i.label){case 0:if(Ra(t.container.flags,16))debugger;return t.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(t)]:[3,3];case 1:return i.sent(),[4,this.renderNodeContent(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})},e.prototype.renderTextWithLetterSpacing=function(t,i,r){var s=this;if(i===0)this.ctx.fillText(t.text,t.bounds.left,t.bounds.top+r);else{var o=GI(t.text);o.reduce(function(a,c){return s.ctx.fillText(c,a,t.bounds.top+r),a+s.ctx.measureText(c).width},t.bounds.left)}},e.prototype.createFontStyle=function(t){var i=t.fontVariant.filter(function(o){return o==="normal"||o==="small-caps"}).join(""),r=Mye(t.fontFamily).join(", "),s=tw(t.fontSize)?""+t.fontSize.number+t.fontSize.unit:t.fontSize.number+"px";return[[t.fontStyle,i,t.fontWeight,s,r].join(" "),r,s]},e.prototype.renderTextNode=function(t,i){return hc(this,void 0,void 0,function(){var r,s,o,a,c,h,u,d,f=this;return zl(this,function(A){return r=this.createFontStyle(i),s=r[0],o=r[1],a=r[2],this.ctx.font=s,this.ctx.direction=i.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",c=this.fontMetrics.getMetrics(o,a),h=c.baseline,u=c.middle,d=i.paintOrder,t.textBounds.forEach(function(g){d.forEach(function(p){switch(p){case 0:f.ctx.fillStyle=el(i.color),f.renderTextWithLetterSpacing(g,i.letterSpacing,h);var y=i.textShadow;y.length&&g.text.trim().length&&(y.slice(0).reverse().forEach(function(v){f.ctx.shadowColor=el(v.color),f.ctx.shadowOffsetX=v.offsetX.number*f.options.scale,f.ctx.shadowOffsetY=v.offsetY.number*f.options.scale,f.ctx.shadowBlur=v.blur.number,f.renderTextWithLetterSpacing(g,i.letterSpacing,h)}),f.ctx.shadowColor="",f.ctx.shadowOffsetX=0,f.ctx.shadowOffsetY=0,f.ctx.shadowBlur=0),i.textDecorationLine.length&&(f.ctx.fillStyle=el(i.textDecorationColor||i.color),i.textDecorationLine.forEach(function(v){switch(v){case 1:f.ctx.fillRect(g.bounds.left,Math.round(g.bounds.top+h),g.bounds.width,1);break;case 2:f.ctx.fillRect(g.bounds.left,Math.round(g.bounds.top),g.bounds.width,1);break;case 3:f.ctx.fillRect(g.bounds.left,Math.ceil(g.bounds.top+u),g.bounds.width,1);break}}));break;case 1:i.webkitTextStrokeWidth&&g.text.trim().length&&(f.ctx.strokeStyle=el(i.webkitTextStrokeColor),f.ctx.lineWidth=i.webkitTextStrokeWidth,f.ctx.lineJoin=window.chrome?"miter":"round",f.ctx.strokeText(g.text,g.bounds.left,g.bounds.top+h)),f.ctx.strokeStyle="",f.ctx.lineWidth=0,f.ctx.lineJoin="miter";break}})}),[2]})})},e.prototype.renderReplacedElement=function(t,i,r){if(r&&t.intrinsicWidth>0&&t.intrinsicHeight>0){var s=dC(t),o=uC(i);this.path(o),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(r,0,0,t.intrinsicWidth,t.intrinsicHeight,s.left,s.top,s.width,s.height),this.ctx.restore()}},e.prototype.renderNodeContent=function(t){return hc(this,void 0,void 0,function(){var i,r,s,o,a,c,m,m,h,u,d,f,x,A,g,T,p,y,v,m,w,x,T;return zl(this,function(j){switch(j.label){case 0:this.applyEffects(t.getEffects(4)),i=t.container,r=t.curves,s=i.styles,o=0,a=i.textNodes,j.label=1;case 1:return o<a.length?(c=a[o],[4,this.renderTextNode(c,s)]):[3,4];case 2:j.sent(),j.label=3;case 3:return o++,[3,1];case 4:if(!(i instanceof pz))return[3,8];j.label=5;case 5:return j.trys.push([5,7,,8]),[4,this.context.cache.match(i.src)];case 6:return m=j.sent(),this.renderReplacedElement(i,r,m),[3,8];case 7:return j.sent(),this.context.logger.error("Error loading image "+i.src),[3,8];case 8:if(i instanceof gz&&this.renderReplacedElement(i,r,i.canvas),!(i instanceof mz))return[3,12];j.label=9;case 9:return j.trys.push([9,11,,12]),[4,this.context.cache.match(i.svg)];case 10:return m=j.sent(),this.renderReplacedElement(i,r,m),[3,12];case 11:return j.sent(),this.context.logger.error("Error loading svg "+i.svg.substring(0,255)),[3,12];case 12:return i instanceof xz&&i.tree?(h=new e(this.context,{scale:this.options.scale,backgroundColor:i.backgroundColor,x:0,y:0,width:i.width,height:i.height}),[4,h.render(i.tree)]):[3,14];case 13:u=j.sent(),i.width&&i.height&&this.ctx.drawImage(u,0,0,i.width,i.height,i.bounds.left,i.bounds.top,i.bounds.width,i.bounds.height),j.label=14;case 14:if(i instanceof XI&&(d=Math.min(i.bounds.width,i.bounds.height),i.type===oC?i.checked&&(this.ctx.save(),this.path([new di(i.bounds.left+d*.39363,i.bounds.top+d*.79),new di(i.bounds.left+d*.16,i.bounds.top+d*.5549),new di(i.bounds.left+d*.27347,i.bounds.top+d*.44071),new di(i.bounds.left+d*.39694,i.bounds.top+d*.5649),new di(i.bounds.left+d*.72983,i.bounds.top+d*.23),new di(i.bounds.left+d*.84,i.bounds.top+d*.34085),new di(i.bounds.left+d*.39363,i.bounds.top+d*.79)]),this.ctx.fillStyle=el(NL),this.ctx.fill(),this.ctx.restore()):i.type===aC&&i.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(i.bounds.left+d/2,i.bounds.top+d/2,d/4,0,Math.PI*2,!0),this.ctx.fillStyle=el(NL),this.ctx.fill(),this.ctx.restore())),jye(i)&&i.value.length){switch(f=this.createFontStyle(s),x=f[0],A=f[1],g=this.fontMetrics.getMetrics(x,A).baseline,this.ctx.font=x,this.ctx.fillStyle=el(s.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=Nye(i.styles.textAlign),T=dC(i),p=0,i.styles.textAlign){case 1:p+=T.width/2;break;case 2:p+=T.width;break}y=T.add(p,0,0,-T.height/2+1),this.ctx.save(),this.path([new di(T.left,T.top),new di(T.left+T.width,T.top),new di(T.left+T.width,T.top+T.height),new di(T.left,T.top+T.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Py(i.value,y),s.letterSpacing,g),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!Ra(i.styles.display,2048))return[3,20];if(i.styles.listStyleImage===null)return[3,19];if(v=i.styles.listStyleImage,v.type!==0)return[3,18];m=void 0,w=v.url,j.label=15;case 15:return j.trys.push([15,17,,18]),[4,this.context.cache.match(w)];case 16:return m=j.sent(),this.ctx.drawImage(m,i.bounds.left-(m.width+10),i.bounds.top),[3,18];case 17:return j.sent(),this.context.logger.error("Error loading list-style-image "+w),[3,18];case 18:return[3,20];case 19:t.listValue&&i.styles.listStyleType!==-1&&(x=this.createFontStyle(s)[0],this.ctx.font=x,this.ctx.fillStyle=el(s.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",T=new CA(i.bounds.left,i.bounds.top+ao(i.styles.paddingTop,i.bounds.width),i.bounds.width,yL(s.lineHeight,s.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Py(t.listValue,T),s.letterSpacing,yL(s.lineHeight,s.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),j.label=20;case 20:return[2]}})})},e.prototype.renderStackContent=function(t){return hc(this,void 0,void 0,function(){var i,r,v,s,o,v,a,c,v,h,u,v,d,f,v,A,g,v,p,y,v;return zl(this,function(m){switch(m.label){case 0:if(Ra(t.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(t.element)];case 1:m.sent(),i=0,r=t.negativeZIndex,m.label=2;case 2:return i<r.length?(v=r[i],[4,this.renderStack(v)]):[3,5];case 3:m.sent(),m.label=4;case 4:return i++,[3,2];case 5:return[4,this.renderNodeContent(t.element)];case 6:m.sent(),s=0,o=t.nonInlineLevel,m.label=7;case 7:return s<o.length?(v=o[s],[4,this.renderNode(v)]):[3,10];case 8:m.sent(),m.label=9;case 9:return s++,[3,7];case 10:a=0,c=t.nonPositionedFloats,m.label=11;case 11:return a<c.length?(v=c[a],[4,this.renderStack(v)]):[3,14];case 12:m.sent(),m.label=13;case 13:return a++,[3,11];case 14:h=0,u=t.nonPositionedInlineLevel,m.label=15;case 15:return h<u.length?(v=u[h],[4,this.renderStack(v)]):[3,18];case 16:m.sent(),m.label=17;case 17:return h++,[3,15];case 18:d=0,f=t.inlineLevel,m.label=19;case 19:return d<f.length?(v=f[d],[4,this.renderNode(v)]):[3,22];case 20:m.sent(),m.label=21;case 21:return d++,[3,19];case 22:A=0,g=t.zeroOrAutoZIndexOrTransformedOrOpacity,m.label=23;case 23:return A<g.length?(v=g[A],[4,this.renderStack(v)]):[3,26];case 24:m.sent(),m.label=25;case 25:return A++,[3,23];case 26:p=0,y=t.positiveZIndex,m.label=27;case 27:return p<y.length?(v=y[p],[4,this.renderStack(v)]):[3,30];case 28:m.sent(),m.label=29;case 29:return p++,[3,27];case 30:return[2]}})})},e.prototype.mask=function(t){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(t.slice(0).reverse()),this.ctx.closePath()},e.prototype.path=function(t){this.ctx.beginPath(),this.formatPath(t),this.ctx.closePath()},e.prototype.formatPath=function(t){var i=this;t.forEach(function(r,s){var o=Mh(r)?r.start:r;s===0?i.ctx.moveTo(o.x,o.y):i.ctx.lineTo(o.x,o.y),Mh(r)&&i.ctx.bezierCurveTo(r.startControl.x,r.startControl.y,r.endControl.x,r.endControl.y,r.end.x,r.end.y)})},e.prototype.renderRepeat=function(t,i,r,s){this.path(t),this.ctx.fillStyle=i,this.ctx.translate(r,s),this.ctx.fill(),this.ctx.translate(-r,-s)},e.prototype.resizeImage=function(t,i,r){var s;if(t.width===i&&t.height===r)return t;var o=(s=this.canvas.ownerDocument)!==null&&s!==void 0?s:document,a=o.createElement("canvas");a.width=Math.max(1,i),a.height=Math.max(1,r);var c=a.getContext("2d");return c.drawImage(t,0,0,t.width,t.height,0,0,i,r),a},e.prototype.renderBackgroundImage=function(t){return hc(this,void 0,void 0,function(){var i,r,s,o,a,c;return zl(this,function(h){switch(h.label){case 0:i=t.styles.backgroundImage.length-1,r=function(u){var d,f,A,I,K,P,B,E,b,g,I,K,P,B,E,p,y,v,m,w,x,T,j,D,b,_,I,S,F,B,E,V,K,P,M,X,Z,Q,U,z,q,G;return zl(this,function(ie){switch(ie.label){case 0:if(u.type!==0)return[3,5];d=void 0,f=u.url,ie.label=1;case 1:return ie.trys.push([1,3,,4]),[4,s.context.cache.match(f)];case 2:return d=ie.sent(),[3,4];case 3:return ie.sent(),s.context.logger.error("Error loading background-image "+f),[3,4];case 4:return d&&(A=S4(t,i,[d.width,d.height,d.width/d.height]),I=A[0],K=A[1],P=A[2],B=A[3],E=A[4],b=s.ctx.createPattern(s.resizeImage(d,B,E),"repeat"),s.renderRepeat(I,b,K,P)),[3,6];case 5:yme(u)?(g=S4(t,i,[null,null,null]),I=g[0],K=g[1],P=g[2],B=g[3],E=g[4],p=Ame(u.angle,B,E),y=p[0],v=p[1],m=p[2],w=p[3],x=p[4],T=document.createElement("canvas"),T.width=B,T.height=E,j=T.getContext("2d"),D=j.createLinearGradient(v,w,m,x),gL(u.stops,y).forEach(function(H){return D.addColorStop(H.stop,el(H.color))}),j.fillStyle=D,j.fillRect(0,0,B,E),B>0&&E>0&&(b=s.ctx.createPattern(T,"repeat"),s.renderRepeat(I,b,K,P))):vme(u)&&(_=S4(t,i,[null,null,null]),I=_[0],S=_[1],F=_[2],B=_[3],E=_[4],V=u.position.length===0?[$I]:u.position,K=ao(V[0],B),P=ao(V[V.length-1],E),M=fme(u,K,P,B,E),X=M[0],Z=M[1],X>0&&Z>0&&(Q=s.ctx.createRadialGradient(S+K,F+P,0,S+K,F+P,X),gL(u.stops,X*2).forEach(function(H){return Q.addColorStop(H.stop,el(H.color))}),s.path(I),s.ctx.fillStyle=Q,X!==Z?(U=t.bounds.left+.5*t.bounds.width,z=t.bounds.top+.5*t.bounds.height,q=Z/X,G=1/q,s.ctx.save(),s.ctx.translate(U,z),s.ctx.transform(1,0,0,q,0,0),s.ctx.translate(-U,-z),s.ctx.fillRect(S,G*(F-z)+z,B,E*G),s.ctx.restore()):s.ctx.fill())),ie.label=6;case 6:return i--,[2]}})},s=this,o=0,a=t.styles.backgroundImage.slice(0).reverse(),h.label=1;case 1:return o<a.length?(c=a[o],[5,r(c)]):[3,4];case 2:h.sent(),h.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},e.prototype.renderSolidBorder=function(t,i,r){return hc(this,void 0,void 0,function(){return zl(this,function(s){return this.path(GL(r,i)),this.ctx.fillStyle=el(t),this.ctx.fill(),[2]})})},e.prototype.renderDoubleBorder=function(t,i,r,s){return hc(this,void 0,void 0,function(){var o,a;return zl(this,function(c){switch(c.label){case 0:return i<3?[4,this.renderSolidBorder(t,r,s)]:[3,2];case 1:return c.sent(),[2];case 2:return o=bye(s,r),this.path(o),this.ctx.fillStyle=el(t),this.ctx.fill(),a=_ye(s,r),this.path(a),this.ctx.fill(),[2]}})})},e.prototype.renderNodeBackgroundAndBorders=function(t){return hc(this,void 0,void 0,function(){var i,r,s,o,a,c,h,u,d=this;return zl(this,function(f){switch(f.label){case 0:return this.applyEffects(t.getEffects(2)),i=t.container.styles,r=!Df(i.backgroundColor)||i.backgroundImage.length,s=[{style:i.borderTopStyle,color:i.borderTopColor,width:i.borderTopWidth},{style:i.borderRightStyle,color:i.borderRightColor,width:i.borderRightWidth},{style:i.borderBottomStyle,color:i.borderBottomColor,width:i.borderBottomWidth},{style:i.borderLeftStyle,color:i.borderLeftColor,width:i.borderLeftWidth}],o=Pye(D0(i.backgroundClip,0),t.curves),r||i.boxShadow.length?(this.ctx.save(),this.path(o),this.ctx.clip(),Df(i.backgroundColor)||(this.ctx.fillStyle=el(i.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(t.container)]):[3,2];case 1:f.sent(),this.ctx.restore(),i.boxShadow.slice(0).reverse().forEach(function(A){d.ctx.save();var g=hC(t.curves),p=A.inset?0:Fye,y=wye(g,-p+(A.inset?1:-1)*A.spread.number,(A.inset?1:-1)*A.spread.number,A.spread.number*(A.inset?-2:2),A.spread.number*(A.inset?-2:2));A.inset?(d.path(g),d.ctx.clip(),d.mask(y)):(d.mask(g),d.ctx.clip(),d.path(y)),d.ctx.shadowOffsetX=A.offsetX.number+p,d.ctx.shadowOffsetY=A.offsetY.number,d.ctx.shadowColor=el(A.color),d.ctx.shadowBlur=A.blur.number,d.ctx.fillStyle=A.inset?el(A.color):"rgba(0,0,0,1)",d.ctx.fill(),d.ctx.restore()}),f.label=2;case 2:a=0,c=0,h=s,f.label=3;case 3:return c<h.length?(u=h[c],u.style!==0&&!Df(u.color)&&u.width>0?u.style!==2?[3,5]:[4,this.renderDashedDottedBorder(u.color,u.width,a,t.curves,2)]:[3,11]):[3,13];case 4:return f.sent(),[3,11];case 5:return u.style!==3?[3,7]:[4,this.renderDashedDottedBorder(u.color,u.width,a,t.curves,3)];case 6:return f.sent(),[3,11];case 7:return u.style!==4?[3,9]:[4,this.renderDoubleBorder(u.color,u.width,a,t.curves)];case 8:return f.sent(),[3,11];case 9:return[4,this.renderSolidBorder(u.color,a,t.curves)];case 10:f.sent(),f.label=11;case 11:a++,f.label=12;case 12:return c++,[3,3];case 13:return[2]}})})},e.prototype.renderDashedDottedBorder=function(t,i,r,s,o){return hc(this,void 0,void 0,function(){var a,c,h,u,d,f,A,g,p,y,v,m,w,x,T,j,T,j;return zl(this,function(D){return this.ctx.save(),a=Cye(s,r),c=GL(s,r),o===2&&(this.path(c),this.ctx.clip()),Mh(c[0])?(h=c[0].start.x,u=c[0].start.y):(h=c[0].x,u=c[0].y),Mh(c[1])?(d=c[1].end.x,f=c[1].end.y):(d=c[1].x,f=c[1].y),r===0||r===2?A=Math.abs(h-d):A=Math.abs(u-f),this.ctx.beginPath(),o===3?this.formatPath(a):this.formatPath(c.slice(0,2)),g=i<3?i*3:i*2,p=i<3?i*2:i,o===3&&(g=i,p=i),y=!0,A<=g*2?y=!1:A<=g*2+p?(v=A/(2*g+p),g*=v,p*=v):(m=Math.floor((A+p)/(g+p)),w=(A-m*g)/(m-1),x=(A-(m+1)*g)/m,p=x<=0||Math.abs(p-w)<Math.abs(p-x)?w:x),y&&(o===3?this.ctx.setLineDash([0,g+p]):this.ctx.setLineDash([g,p])),o===3?(this.ctx.lineCap="round",this.ctx.lineWidth=i):this.ctx.lineWidth=i*2+1.1,this.ctx.strokeStyle=el(t),this.ctx.stroke(),this.ctx.setLineDash([]),o===2&&(Mh(c[0])&&(T=c[3],j=c[0],this.ctx.beginPath(),this.formatPath([new di(T.end.x,T.end.y),new di(j.start.x,j.start.y)]),this.ctx.stroke()),Mh(c[1])&&(T=c[1],j=c[2],this.ctx.beginPath(),this.formatPath([new di(T.end.x,T.end.y),new di(j.start.x,j.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},e.prototype.render=function(t){return hc(this,void 0,void 0,function(){var i;return zl(this,function(r){switch(r.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=el(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),i=xye(t),[4,this.renderStack(i)];case 1:return r.sent(),this.applyEffects([]),[2,this.canvas]}})})},e})(Mz),jye=function(n){return n instanceof wz||n instanceof vz?!0:n instanceof XI&&n.type!==aC&&n.type!==oC},Pye=function(n,e){switch(n){case 0:return hC(e);case 2:return pye(e);case 1:default:return uC(e)}},Nye=function(n){switch(n){case 1:return"center";case 2:return"right";case 0:default:return"left"}},Lye=["-apple-system","system-ui"],Mye=function(n){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?n.filter(function(e){return Lye.indexOf(e)===-1}):n},Rye=(function(n){Hu(e,n);function e(t,i){var r=n.call(this,t,i)||this;return r.canvas=i.canvas?i.canvas:document.createElement("canvas"),r.ctx=r.canvas.getContext("2d"),r.options=i,r.canvas.width=Math.floor(i.width*i.scale),r.canvas.height=Math.floor(i.height*i.scale),r.canvas.style.width=i.width+"px",r.canvas.style.height=i.height+"px",r.ctx.scale(r.options.scale,r.options.scale),r.ctx.translate(-i.x,-i.y),r.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+i.width+"x"+i.height+" at "+i.x+","+i.y+") with scale "+i.scale),r}return e.prototype.render=function(t){return hc(this,void 0,void 0,function(){var i,r;return zl(this,function(s){switch(s.label){case 0:return i=ZE(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,t),[4,Oye(i)];case 1:return r=s.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=el(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(r,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},e})(Mz),Oye=function(n){return new Promise(function(e,t){var i=new Image;i.onload=function(){e(i)},i.onerror=t,i.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(n))})},Uye=(function(){function n(e){var t=e.id,i=e.enabled;this.id=t,this.enabled=i,this.start=Date.now()}return n.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,Ix([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},n.prototype.getTime=function(){return Date.now()-this.start},n.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,Ix([this.id,this.getTime()+"ms"],e))},n.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,Ix([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},n.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,Ix([this.id,this.getTime()+"ms"],e)):this.info.apply(this,e))},n.instances={},n})(),Hye=(function(){function n(e,t){var i;this.windowBounds=t,this.instanceName="#"+n.instanceCount++,this.logger=new Uye({id:this.instanceName,enabled:e.logging}),this.cache=(i=e.cache)!==null&&i!==void 0?i:new aye(this,e)}return n.instanceCount=1,n})(),AC=function(n,e){return e===void 0&&(e={}),Wye(n,e)};typeof window<"u"&&Fz.setContext(window);var Wye=function(n,e){return hc(void 0,void 0,void 0,function(){var t,i,r,s,o,a,c,h,u,d,f,A,g,p,y,v,m,w,x,T,D,j,D,b,_,I,S,F,B,E,V,K,P,M,X,Z,Q,U,z,q;return zl(this,function(G){switch(G.label){case 0:if(!n||typeof n!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(t=n.ownerDocument,!t)throw new Error("Element is not attached to a Document");if(i=t.defaultView,!i)throw new Error("Document is not attached to a Window");return r={allowTaint:(b=e.allowTaint)!==null&&b!==void 0?b:!1,imageTimeout:(_=e.imageTimeout)!==null&&_!==void 0?_:15e3,proxy:e.proxy,useCORS:(I=e.useCORS)!==null&&I!==void 0?I:!1},s=ME({logging:(S=e.logging)!==null&&S!==void 0?S:!0,cache:e.cache},r),o={windowWidth:(F=e.windowWidth)!==null&&F!==void 0?F:i.innerWidth,windowHeight:(B=e.windowHeight)!==null&&B!==void 0?B:i.innerHeight,scrollX:(E=e.scrollX)!==null&&E!==void 0?E:i.pageXOffset,scrollY:(V=e.scrollY)!==null&&V!==void 0?V:i.pageYOffset},a=new CA(o.scrollX,o.scrollY,o.windowWidth,o.windowHeight),c=new Hye(s,a),h=(K=e.foreignObjectRendering)!==null&&K!==void 0?K:!1,u={allowTaint:(P=e.allowTaint)!==null&&P!==void 0?P:!1,onclone:e.onclone,ignoreElements:e.ignoreElements,inlineImages:h,copyStyles:h},c.logger.debug("Starting document clone with size "+a.width+"x"+a.height+" scrolled to "+-a.left+","+-a.top),d=new $L(c,n,u),f=d.clonedReferenceElement,f?[4,d.toIFrame(t,a)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return A=G.sent(),g=KI(f)||$2e(f)?wge(f.ownerDocument):P5(c,f),p=g.width,y=g.height,v=g.left,m=g.top,w=Qye(c,f,e.backgroundColor),x={canvas:e.canvas,backgroundColor:w,scale:(X=(M=e.scale)!==null&&M!==void 0?M:i.devicePixelRatio)!==null&&X!==void 0?X:1,x:((Z=e.x)!==null&&Z!==void 0?Z:0)+v,y:((Q=e.y)!==null&&Q!==void 0?Q:0)+m,width:(U=e.width)!==null&&U!==void 0?U:Math.ceil(p),height:(z=e.height)!==null&&z!==void 0?z:Math.ceil(y)},h?(c.logger.debug("Document cloned, using foreign object rendering"),D=new Rye(c,x),[4,D.render(f)]):[3,3];case 2:return T=G.sent(),[3,5];case 3:return c.logger.debug("Document cloned, element located at "+v+","+m+" with size "+p+"x"+y+" using computed rendering"),c.logger.debug("Starting DOM parsing"),j=_z(c,f),w===j.styles.backgroundColor&&(j.styles.backgroundColor=fA.TRANSPARENT),c.logger.debug("Starting renderer for element at "+x.x+","+x.y+" with size "+x.width+"x"+x.height),D=new Dye(c,x),[4,D.render(j)];case 4:T=G.sent(),G.label=5;case 5:return(!((q=e.removeContainer)!==null&&q!==void 0)||q)&&($L.destroy(A)||c.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),c.logger.debug("Finished rendering"),[2,T]}})})},Qye=function(n,e,t){var i=e.ownerDocument,r=i.documentElement?Dy(n,getComputedStyle(i.documentElement).backgroundColor):fA.TRANSPARENT,s=i.body?Dy(n,getComputedStyle(i.body).backgroundColor):fA.TRANSPARENT,o=typeof t=="string"?Dy(n,t):t===null?fA.TRANSPARENT:4294967295;return e===i.documentElement?Df(r)?Df(s)?o:s:r:o};const $ye=Object.freeze(Object.defineProperty({__proto__:null,default:AC},Symbol.toStringTag,{value:"Module"})),Vye=()=>{const n=document.createElement("link");n.href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap",n.rel="stylesheet",document.head.appendChild(n)};Vye();const zye=async(n,e=12,t="#000000",i="400")=>{const r=document.createElement("canvas"),s=r.getContext("2d");if(!s)throw new Error("Canvas context not available");const o=3;s.font=`${i} ${e}px "Noto Sans KR", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif`;const a=s.measureText(n);return r.width=Math.ceil((a.width+8)*o),r.height=Math.ceil(e*1.8*o),s.scale(o,o),s.imageSmoothingEnabled=!0,s.imageSmoothingQuality="high",s.clearRect(0,0,r.width,r.height),s.font=`${i} ${e}px "Noto Sans KR", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif`,s.fillStyle=t,s.textBaseline="middle",s.textAlign="left",(i==="700"||i==="500")&&(s.letterSpacing="0.5px"),s.fillText(n,4,e*1.8/2),r.toDataURL("image/png",1)},Rz=async(n,e,t,i,r)=>{const s=(r==null?void 0:r.fontSize)||12,o=(r==null?void 0:r.color)||"#000000",a=(r==null?void 0:r.fontWeight)||"400";try{const c=await zye(e,s,o,a),h=new Image;h.src=c,await new Promise(g=>h.onload=g);const u=3,d=h.width/u*.75,f=h.height/u*.75;let A=t;return(r==null?void 0:r.align)==="center"?A=t-d/2:(r==null?void 0:r.align)==="right"&&(A=t-d),n.addImage(c,"PNG",A,i-f*.75,d,f),{width:d,height:f}}catch(c){return console.error("Failed to add Korean text:",c),n.text(e,t,i,r),{width:0,height:0}}},Gye=n=>/[ㄱ-ㅎㅏ-ㅣ가-힣]/g.test(n),Tp=async(n,e,t,i,r)=>{if(Gye(e))await Rz(n,e,t,i,{...r,fontWeight:(r==null?void 0:r.fontWeight)||((r==null?void 0:r.fontStyle)==="bold"?"700":"400")});else{if(r!=null&&r.fontSize&&n.setFontSize(r.fontSize),r!=null&&r.color){const o=parseInt(r.color.slice(1,3),16),a=parseInt(r.color.slice(3,5),16),c=parseInt(r.color.slice(5,7),16);n.setTextColor(o,a,c)}r!=null&&r.font&&n.setFont(r.font,r.fontStyle||"normal");const s={};r!=null&&r.align&&(s.align=r.align),n.text(e,t,i,s)}},T4=[{id:"3d-front",name:"3D 정면뷰",viewMode:"3D"},{id:"2d-front",name:"2D 정면뷰 (치수)",viewMode:"2D",viewDirection:"front"},{id:"2d-top",name:"2D 상부뷰 (치수)",viewMode:"2D",viewDirection:"top"},{id:"2d-left",name:"2D 좌측뷰 (치수)",viewMode:"2D",viewDirection:"left"},{id:"2d-right",name:"2D 우측뷰 (치수)",viewMode:"2D",viewDirection:"right"}];function Oz(){const[n,e]=O.useState(!1),{title:t}=Ha(),{viewMode:i,view2DDirection:r,showGuides:s,showAxis:o,showDimensions:a,showDimensionsText:c,showFurniture:h,renderMode:u,setViewMode:d,setView2DDirection:f,setShowGuides:A,setShowAxis:g,setShowDimensions:p,setShowDimensionsText:y,setShowFurniture:v,setRenderMode:m}=Bi(),w=O.useCallback(async(D,b)=>{const _=T4.find(Q=>Q.id===D);if(!_)throw new Error("잘못된 뷰 타입입니다.");const I=i,S=r,F=s,B=o,E=a,V=c,K=h,P=u;console.log("📸 PDF 캡처 시작:",{viewType:D,원래설정:{viewMode:I,view2DDirection:S,showGuides:F,showAxis:B,showDimensions:E,showDimensionsText:V,renderMode:P}}),_.viewMode==="3D"?(d("3D"),m(b)):(d("2D"),A(!1),g(!1),p(!0),y(!0),v(!0),m("wireframe"),_.viewDirection&&f(_.viewDirection)),await new Promise(Q=>setTimeout(Q,1500));let M=null,X=document.querySelector('[data-viewer-container="true"]');if(X&&(M=X.querySelector("canvas")),!M){const Q=document.querySelectorAll("canvas");let U=0;Q.forEach(z=>{const q=z.width*z.height;q>U&&z.width>100&&z.height>100&&(U=q,M=z)})}if(!M)throw console.error("렌더링 캔버스를 찾을 수 없습니다."),new Error("뷰어 캔버스를 찾을 수 없습니다.");X=X||M.parentElement;let Z;if(console.log("Canvas 캡처 시도:",{viewerContainer:!!X,canvas:!!M,canvasWidth:M==null?void 0:M.width,canvasHeight:M==null?void 0:M.height}),M&&(_.viewMode==="3D"||_.viewMode==="2D"))try{if(await new Promise(Q=>requestAnimationFrame(Q)),Z=M.toDataURL("image/png",1),!Z||Z==="data:,"||Z.length<100)throw new Error("Canvas 캡처 결과가 비어있습니다.");console.log("Canvas 직접 캡처 성공:",Z.substring(0,50)+"...")}catch(Q){console.warn("Canvas 직접 캡처 실패, html2canvas 사용:",Q),Z=(await AC(X,{backgroundColor:"#ffffff",scale:4,logging:!1,useCORS:!0,allowTaint:!0,onclone:z=>{const q=z.querySelector("canvas");if(q&&M){const G=q.getContext("2d");G&&G.drawImage(M,0,0)}}})).toDataURL("image/png")}else Z=(await AC(X,{backgroundColor:"#ffffff",scale:4,logging:!1,useCORS:!0,allowTaint:!0})).toDataURL("image/png");return d(I),I==="2D"&&f(S),A(F),g(B),p(E),y(V),v(K),m(P),console.log("📸 PDF 캡처 완료 - 설정 복원:",{viewMode:I,view2DDirection:S,showGuides:F,showAxis:B,showDimensions:E,showDimensionsText:V,renderMode:P}),await new Promise(Q=>setTimeout(Q,500)),Z},[i,r,s,o,a,c,h,u,d,f,A,g,p,y,v,m]),x=O.useCallback(async(D,b,_,I="solid")=>{e(!0);try{const S=new Di({orientation:"landscape",unit:"mm",format:"a3"}),F=S.internal.pageSize.getWidth(),B=S.internal.pageSize.getHeight(),E=10,V=5,K=40,P=180,M={black:"#000000",gray:"#666666",lightGray:"#CCCCCC",text:"#000000",white:"#FFFFFF"},X=t||"가구 배치 설계도",Z=new Date().toLocaleDateString("ko-KR"),Q=b.map(z=>{const q=Hi(z.moduleId,D);return{name:(q==null?void 0:q.name)||"알 수 없음",width:z.customWidth||(q==null?void 0:q.width)||0,height:z.customHeight||(q==null?void 0:q.height)||0,depth:z.customDepth||(q==null?void 0:q.depth)||0,position:z.slotPosition||"N/A"}});for(let z=0;z<_.length;z++){const q=_[z],G=T4.find(te=>te.id===q);if(!G)continue;z>0&&S.addPage(),S.setDrawColor(0,0,0),S.setLineWidth(.7),S.rect(E,E,F-2*E,B-2*E,"S"),S.setLineWidth(.3),S.rect(E+V,E+V,F-2*(E+V),B-2*(E+V),"S");const ie=F-E-V-P,H=B-E-V-K;S.setLineWidth(.5),S.rect(ie,H,P,K,"S"),S.line(ie+40,H,ie+40,H+K),S.line(ie,H+20,ie+P,H+20),S.line(ie+90,H+20,ie+90,H+K),S.line(ie+140,H+20,ie+140,H+K),S.setFont("helvetica","bold"),S.setFontSize(16),S.text("MF",ie+20,H+12,{align:"center"}),S.setFontSize(8),S.setFont("helvetica","normal"),S.text("MODULAR",ie+20,H+17,{align:"center"}),S.text("FURNITURE",ie+20,H+21,{align:"center"}),S.setFontSize(8),S.text("PROJECT:",ie+45,H+6),await Tp(S,X.toUpperCase(),ie+45,H+11,{fontSize:10,color:M.text,fontWeight:"700"}),S.text("CLIENT:",ie+45,H+17),await Tp(S,"MODULAR FURNITURE SYSTEM",ie+65,H+17,{fontSize:8,color:M.text}),S.text("SHEET:",ie+5,H+26),S.text(`${z+1} / ${_.length}`,ie+20,H+26),S.text("DATE:",ie+5,H+32),S.text(Z,ie+20,H+32),S.text("SCALE:",ie+5,H+38),S.text("AS SHOWN",ie+20,H+38),S.text("SPACE:",ie+95,H+26),S.setFont("helvetica","bold"),S.text(`${D.width} × ${D.height} × ${D.depth}`,ie+95,H+32),S.setFont("helvetica","normal"),S.text("(W × H × D) mm",ie+95,H+36),S.text("VIEW:",ie+145,H+26),await Tp(S,G.name,ie+145,H+32,{fontSize:9,color:M.text,fontWeight:"500"}),S.text("RENDER:",ie+145,H+38),S.text(I.toUpperCase(),ie+165,H+38);try{const te=await w(q,I),fe=E+V+5,ye=E+V+5,be=F-2*(E+V)-10,_e=B-2*(E+V)-K-15,W=H+10;S.setLineWidth(.3),S.rect(fe,W,100,25,"S"),S.setFont("helvetica","bold"),S.setFontSize(12),S.text("VIEW TITLE",fe+50,W+10,{align:"center"}),S.setFont("helvetica","normal"),S.setFontSize(10),await Tp(S,G.name.toUpperCase(),fe+50,W+16,{fontSize:10,color:M.text,align:"center"}),S.setFontSize(8),S.text("SCALE: AS SHOWN",fe+50,W+22,{align:"center"}),S.addImage(te,"PNG",fe,ye,be,_e,void 0,"NONE")}catch(te){console.error(`뷰 캡처 실패 (${q}):`,te);const fe=E+V+5,ye=E+V+5,be=F-2*(E+V)-10,_e=B-2*(E+V)-K-15;S.setDrawColor(200,200,200),S.setLineWidth(.2),S.line(fe,ye,fe+be,ye+_e),S.line(fe+be,ye,fe,ye+_e),S.setTextColor(150,150,150),S.setFont("helvetica","normal"),S.setFontSize(14),await Rz(S,"뷰 캡처 실패",F/2,B/2-20,{fontSize:14,color:"#969696",align:"center"}),S.setFontSize(10),S.text("VIEW CAPTURE FAILED",F/2,B/2,{align:"center"})}S.setFont("helvetica","normal"),S.setFontSize(6),S.setTextColor(100,100,100),S.text("GENERAL NOTE: DO NOT SCALE FROM DRAWINGS. USE MARKED DIMENSIONS. TO BE READ WITH ALL OTHER CONSULTANTS DRAWINGS. THE ARCHITECT TO BE NOTIFIED IMMEDIATELY SHOULD ANY DISCREPANCY OCCUR.",F/2,E-2,{align:"center"}),S.setFontSize(8),S.setTextColor(0,0,0),S.text(`${z+1}`,E+V+3,E+V+5),S.text(`${z+1}`,F-E-V-3,E+V+5,{align:"right"}),S.text(`${z+1}`,E+V+3,B-E-V-2)}if(Q.length>0){S.addPage(),S.setDrawColor(0,0,0),S.setLineWidth(.7),S.rect(E,E,F-2*E,B-2*E,"S"),S.setLineWidth(.3),S.rect(E+V,E+V,F-2*(E+V),B-2*(E+V),"S");const z=F-E-V-P,q=B-E-V-K;S.setLineWidth(.5),S.rect(z,q,P,K,"S"),S.line(z+40,q,z+40,q+K),S.line(z,q+20,z+P,q+20),S.line(z+90,q+20,z+90,q+K),S.line(z+140,q+20,z+140,q+K),S.setFont("helvetica","bold"),S.setFontSize(16),S.text("MF",z+20,q+12,{align:"center"}),S.setFontSize(8),S.setFont("helvetica","normal"),S.text("MODULAR",z+20,q+17,{align:"center"}),S.text("FURNITURE",z+20,q+21,{align:"center"}),S.setFontSize(8),S.text("PROJECT:",z+45,q+6),await Tp(S,X.toUpperCase(),z+45,q+11,{fontSize:10,color:M.text,fontWeight:"700"}),S.text("CLIENT:",z+45,q+17),await Tp(S,"MODULAR FURNITURE SYSTEM",z+65,q+17,{fontSize:8,color:M.text}),S.text("SHEET:",z+5,q+26),S.text(`${_.length+1} / ${_.length+1}`,z+20,q+26),S.text("DATE:",z+5,q+32),S.text(Z,z+20,q+32),S.text("SCALE:",z+5,q+38),S.text("N/A",z+20,q+38),S.text("DRAWING:",z+95,q+26),S.setFont("helvetica","bold"),S.text("FURNITURE",z+95,q+32),S.text("SCHEDULE",z+95,q+36),S.setFont("helvetica","normal"),S.text("TOTAL:",z+145,q+26),S.setFont("helvetica","bold"),S.text(`${Q.length} ITEMS`,z+145,q+32),S.setFont("helvetica","normal"),S.setFont("helvetica","normal"),S.setFontSize(6),S.setTextColor(100,100,100),S.text("GENERAL NOTE: DO NOT SCALE FROM DRAWINGS. USE MARKED DIMENSIONS. TO BE READ WITH ALL OTHER CONSULTANTS DRAWINGS. THE ARCHITECT TO BE NOTIFIED IMMEDIATELY SHOULD ANY DISCREPANCY OCCUR.",F/2,E-2,{align:"center"}),S.setFontSize(8),S.setTextColor(0,0,0),S.text(`${_.length+1}`,E+V+3,E+V+5),S.text(`${_.length+1}`,F-E-V-3,E+V+5,{align:"right"}),S.text(`${_.length+1}`,E+V+3,B-E-V-2);const ie=E+V+10,H=E+V+20,se=F-2*(E+V)-P-30;let te=H;const fe=[30,120,40,40,40,50],ye=["NO.","FURNITURE NAME","WIDTH","HEIGHT","DEPTH","POSITION"];let be=ie;S.setLineWidth(.5),S.setDrawColor(0,0,0),S.rect(ie,te,se,15,"S"),S.setTextColor(0,0,0),S.setFont("helvetica","bold"),S.setFontSize(9);for(let _e=0;_e<ye.length;_e++)S.text(ye[_e],be+fe[_e]/2,te+10,{align:"center"}),_e<ye.length-1&&(S.setLineWidth(.3),S.line(be+fe[_e],te,be+fe[_e],te+15)),be+=fe[_e];te+=15;for(let _e=0;_e<Q.length;_e++){const W=Q[_e];te>B-30&&(S.addPage(),te=H),be=ie;const Y=12;S.setLineWidth(.3),S.rect(ie,te,se,Y,"S"),S.setFont("helvetica","normal"),S.setFontSize(8),S.text((_e+1).toString().padStart(2,"0"),be+fe[0]/2,te+8,{align:"center"}),be+=fe[0],S.line(be,te,be,te+Y);const ve=W.name.toUpperCase(),ce=ve.length>30?ve.substring(0,28)+"...":ve;await Tp(S,ce,be+5,te+8,{fontSize:8,color:M.text}),be+=fe[1],S.line(be,te,be,te+Y);const ne=[W.width.toString(),W.height.toString(),W.depth.toString()];for(let he=0;he<ne.length;he++)S.text(ne[he],be+fe[2+he]/2,te+8,{align:"center"}),be+=fe[2+he],he<ne.length-1&&S.line(be,te,be,te+Y);S.line(be,te,be,te+Y),S.text(W.position.toString(),be+fe[5]/2,te+8,{align:"center"}),te+=Y}S.setLineWidth(.5),S.line(ie,te,ie+se,te),S.setFont("helvetica","normal"),S.setFontSize(7),S.setTextColor(100,100,100),S.text("ALL DIMENSIONS IN MILLIMETERS",ie,te+10),S.text("VERIFY ALL DIMENSIONS ON SITE",ie,te+15),S.text("FURNITURE POSITIONS REFER TO FLOOR PLAN",ie,te+20)}const U=`${X.replace(/[^a-zA-Z0-9가-힣]/g,"_")}_${Z.replace(/\./g,"")}.pdf`;try{S.save(U),console.log("✅ PDF 다운로드 성공!",U)}catch(z){console.error("PDF 다운로드 실패:",z);const q=S.output("blob"),G=URL.createObjectURL(q),ie=document.createElement("a");ie.href=G,ie.download=U,document.body.appendChild(ie),ie.click(),document.body.removeChild(ie),URL.revokeObjectURL(G)}return{success:!0,message:"PDF가 성공적으로 생성되었습니다.",filename:U}}catch(S){return console.error("PDF 생성 중 오류:",S),{success:!1,message:S instanceof Error?S.message:"PDF 생성 중 오류가 발생했습니다."}}finally{e(!1)}},[t,w]),T=O.useCallback((D,b)=>D!==null&&b.length>0,[]),j=O.useCallback((D,b)=>D?b.length===0?"배치된 가구가 없습니다.":"내보낼 준비가 완료되었습니다.":"공간 정보가 없습니다.",[]);return{exportToPDF:x,canExportPDF:T,getExportStatusMessage:j,isExporting:n,VIEW_TYPES:T4}}const Xye="_header_kpiyu_1",Kye="_container_kpiyu_19",qye="_logoSection_kpiyu_39",Yye="_hamburgerButton_kpiyu_55",Zye="_active_kpiyu_93",Jye="_logo_kpiyu_39",eve="_projectInfo_kpiyu_195",tve="_designFileName_kpiyu_221",nve="_centerActions_kpiyu_277",ive="_actionButton_kpiyu_297",rve="_rightActions_kpiyu_411",sve="_convertButton_kpiyu_427",ove="_logoutButton_kpiyu_471",ave="_loginButton_kpiyu_517",lve="_userProfile_kpiyu_565",cve="_userProfileName_kpiyu_597",hve="_userProfileAvatar_kpiyu_613",uve="_profileImage_kpiyu_653",dve="_saveSuccess_kpiyu_667",Ave="_saveError_kpiyu_699",fve="_fileMenuContainer_kpiyu_755",pve="_fileDropdown_kpiyu_795",gve="_dropdownItem_kpiyu_827",mve="_convertButtonContainer_kpiyu_971",yve="_dropdownMenu_kpiyu_981",es={header:Xye,container:Kye,logoSection:qye,hamburgerButton:Yye,active:Zye,logo:Jye,projectInfo:eve,designFileName:tve,centerActions:nve,actionButton:ive,rightActions:rve,convertButton:sve,logoutButton:ove,loginButton:ave,userProfile:lve,userProfileName:cve,userProfileAvatar:hve,profileImage:uve,saveSuccess:dve,saveError:Ave,fileMenuContainer:fve,fileDropdown:pve,dropdownItem:gve,convertButtonContainer:mve,dropdownMenu:yve};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vve=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),wve=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),KL=n=>{const e=wve(n);return e.charAt(0).toUpperCase()+e.slice(1)},Uz=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),xve=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var bve={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _ve=O.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...a},c)=>O.createElement("svg",{ref:c,...bve,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:Uz("lucide",r),...!s&&!xve(a)&&{"aria-hidden":"true"},...a},[...o.map(([h,u])=>O.createElement(h,u)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ji=(n,e)=>{const t=O.forwardRef(({className:i,...r},s)=>O.createElement(_ve,{ref:s,iconNode:e,className:Uz(`lucide-${vve(KL(n))}`,`lucide-${n}`,i),...r}));return t.displayName=KL(n),t};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cve=[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]],Sve=Ji("arrow-down-to-line",Cve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tve=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Bve=Ji("arrow-left",Tve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eve=[["path",{d:"M17 12H3",key:"8awo09"}],["path",{d:"m11 18 6-6-6-6",key:"8c2y43"}],["path",{d:"M21 5v14",key:"nzette"}]],kve=Ji("arrow-right-to-line",Eve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ive=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],qI=Ji("arrow-right",Ive);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fve=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],Dve=Ji("award",Fve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jve=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],Pve=Ji("brain",jve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nve=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],qL=Ji("calendar",Nve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lve=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],lA=Ji("chevron-down",Lve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mve=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Rve=Ji("chevron-left",Mve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ove=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],fC=Ji("chevron-right",Ove);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uve=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],s6=Ji("chevron-up",Uve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hve=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],Hz=Ji("cpu",Hve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wve=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Wz=Ji("download",Wve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qve=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],YI=Ji("eye-off",Qve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ve=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ZI=Ji("eye",$ve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vve=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],zve=Ji("file-down",Vve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gve=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Xve=Ji("file-text",Gve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kve=[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]],qve=Ji("fingerprint",Kve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yve=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],Zve=Ji("grid-3x3",Yve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jve=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],ewe=Ji("house",Jve);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const twe=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],pC=Ji("layers",twe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nwe=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],JI=Ji("loader-circle",nwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iwe=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],Qz=Ji("log-in",iwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rwe=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],$z=Ji("lock",rwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const swe=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],eF=Ji("log-out",swe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const owe=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Vz=Ji("mail",owe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const awe=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]],lwe=Ji("maximize",awe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cwe=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],hwe=Ji("menu",cwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uwe=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],dwe=Ji("mouse-pointer",uwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Awe=[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]],fwe=Ji("move",Awe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pwe=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],zz=Ji("package",pwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gwe=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],Gz=Ji("pause",gwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mwe=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]],ywe=Ji("pen-line",mwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vwe=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],o6=Ji("play",vwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wwe=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Xz=Ji("plus",wwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xwe=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],bwe=Ji("rocket",xwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _we=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Cwe=Ji("rotate-cw",_we);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Swe=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],a6=Ji("ruler",Swe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Twe=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],$5=Ji("settings",Twe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bwe=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Kz=Ji("shield",Bwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ewe=[["polygon",{points:"19 20 9 12 19 4 19 20",key:"o2sva"}],["line",{x1:"5",x2:"5",y1:"19",y2:"5",key:"1ocqjk"}]],kwe=Ji("skip-back",Ewe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iwe=[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]],Fwe=Ji("skip-forward",Iwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dwe=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],Ly=Ji("sparkles",Dwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jwe=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Pwe=Ji("star",jwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nwe=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],qz=Ji("trash-2",Nwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lwe=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],tF=Ji("upload",Lwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mwe=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Rwe=Ji("user-plus",Mwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Owe=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Yz=Ji("user",Owe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uwe=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Zz=Ji("x",Uwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hwe=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Wwe=Ji("zap",Hwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qwe=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Jz=Ji("zoom-in",Qwe);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $we=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],eG=Ji("zoom-out",$we),Vwe="_overlay_1a2n7_1",zwe="_modal_1a2n7_15",Gwe="_header_1a2n7_28",Xwe="_title_1a2n7_37",Kwe="_closeButton_1a2n7_44",qwe="_content_1a2n7_63",Ywe="_shortcuts_1a2n7_69",Zwe="_shortcutItem_1a2n7_73",Jwe="_key_1a2n7_85",exe="_action_1a2n7_98",txe="_tips_1a2n7_104",lu={overlay:Vwe,modal:zwe,header:Gwe,title:Xwe,closeButton:Kwe,content:qwe,shortcuts:Ywe,shortcutItem:Zwe,key:Jwe,action:exe,tips:txe},nxe=({isOpen:n,onClose:e})=>{const{t}=Eo();if(!n)return null;const i=[{key:"마우스 휠버튼 드래그",action:"3D 카메라 회전"},{key:"두 손가락 드래그",action:"화면 이동 (팬)"},{key:"스크롤/두 손가락 핀치",action:"줌 인/아웃"},{key:"Space",action:"카메라 초기 위치로 리셋"},{key:"가구/기둥 드래그 시",action:"자동 정면뷰 전환"},{key:"Delete / Backspace",action:t("help.shortcuts.deleteSelected")},{key:"Esc",action:t("help.shortcuts.exitEditMode")},{key:t("help.shortcuts.arrowKeys"),action:t("help.shortcuts.fineTuneMove")},{key:t("help.shortcuts.doubleClick"),action:t("help.shortcuts.editMode")},{key:t("help.shortcuts.dragDrop"),action:t("help.shortcuts.placeFurniture")}],r=s=>{s.target===s.currentTarget&&e()};return l.jsx("div",{className:lu.overlay,onClick:r,children:l.jsxs("div",{className:lu.modal,children:[l.jsxs("div",{className:lu.header,children:[l.jsx("h3",{className:lu.title,children:t("help.title")}),l.jsx("button",{className:lu.closeButton,onClick:e,children:"✕"})]}),l.jsxs("div",{className:lu.content,children:[l.jsx("div",{className:lu.shortcuts,children:i.map((s,o)=>l.jsxs("div",{className:lu.shortcutItem,children:[l.jsx("span",{className:lu.key,children:s.key}),l.jsx("span",{className:lu.action,children:s.action})]},o))}),l.jsxs("div",{className:lu.tips,children:[l.jsx("h4",{children:t("help.tips.title")}),l.jsxs("ul",{children:[l.jsx("li",{children:t("help.tips.autoPlace")}),l.jsx("li",{children:t("help.tips.editPopup")}),l.jsx("li",{children:t("help.tips.editColumn")}),l.jsx("li",{children:t("help.tips.doorInstall")})]})]})]})]})})},ixe="_sectionTitle_8zdrd_2",rxe="_checkIcon_8zdrd_11",sxe="_active_8zdrd_17",oxe="_dropdownContainer_8zdrd_23",axe="_trigger_8zdrd_27",lxe="_overlay_8zdrd_46",cxe="_dropdown_8zdrd_23",hxe="_dropdownHeader_8zdrd_69",uxe="_closeButton_8zdrd_85",dxe="_section_8zdrd_2",Axe="_modeList_8zdrd_112",fxe="_modeItem_8zdrd_118",pxe="_modeIcon_8zdrd_139",gxe="_colorList_8zdrd_144",mxe="_colorItem_8zdrd_151",yxe="_colorPreview_8zdrd_182",vxe="_quickToggle_8zdrd_192",wxe="_sidebarContainer_8zdrd_214",xxe="_sidebarLabel_8zdrd_219",bxe="_sidebarSection_8zdrd_226",_xe="_modeToggleTab_8zdrd_235",Cxe="_modeTabButton_8zdrd_242",Sxe="_modeName_8zdrd_274",Txe="_colorGrid_8zdrd_279",Bxe="_colorButton_8zdrd_286",Vr={sectionTitle:ixe,checkIcon:rxe,active:sxe,dropdownContainer:oxe,trigger:axe,overlay:lxe,dropdown:cxe,dropdownHeader:hxe,closeButton:uxe,section:dxe,modeList:Axe,modeItem:fxe,modeIcon:pxe,colorList:gxe,colorItem:mxe,colorPreview:yxe,quickToggle:vxe,sidebarContainer:wxe,sidebarLabel:xxe,sidebarSection:bxe,modeToggleTab:_xe,modeTabButton:Cxe,modeName:Sxe,colorGrid:Txe,colorButton:Bxe},Exe=({variant:n="dropdown",showLabel:e=!0})=>{const{theme:t,setThemeMode:i,setThemeColor:r,toggleMode:s}=Yo(),[o,a]=O.useState(!1),{t:c}=Eo(),h=[{id:"black",name:"차콜블랙",color:"#1a1a1a"},{id:"gray",name:"다크그레이",color:"#6b7280"},{id:"blue",name:"스카이블루",color:"#3b82f6"},{id:"navy",name:"로얄블루",color:"#1e3a8a"},{id:"indigo",name:"페일블루",color:"#6366f1"},{id:"teal",name:"딥틸",color:"#14b8a6"},{id:"cyan",name:"다크틸",color:"#06b6d4"},{id:"white",name:"라이트그레이",color:"#D65DB1"},{id:"plum",name:"플럼",color:"#790963"},{id:"vivid",name:"비비드",color:"#a25378"},{id:"rust",name:"선셋오렌지",color:"#FF7438"},{id:"brown",name:"다크브라운",color:"#5A2B1D"},{id:"emerald",name:"포레스트그린",color:"#059669"},{id:"darkgray",name:"블루그레이",color:"#2C3844"},{id:"wine",name:"바이올렛",color:"#845EC2"},{id:"purple",name:"딥퍼플",color:"#8b5cf6"},{id:"pink",name:"코랄핑크",color:"#ec4899"},{id:"red",name:"레드",color:"#D2042D"},{id:"maroon",name:"다크레드",color:"#3F0D0D"},{id:"turquoise",name:"터콰이즈",color:"#003A7A"},{id:"slate",name:"슬레이트",color:"#2E3A47"},{id:"copper",name:"코퍼",color:"#AD4F34"},{id:"mint",name:"민트",color:"#0CBA80"},{id:"lime",name:"라임그린",color:"#84cc16"},{id:"green",name:"그린",color:"#10b981"},{id:"forest",name:"다크그린",color:"#314d30"},{id:"olive",name:"올리브",color:"#4C462C"},{id:"yellow",name:"올리브그린",color:"#eab308"}],u=[{id:"light",name:c("settings.lightMode"),icon:l.jsx(Vj,{size:16})},{id:"dark",name:c("settings.darkMode"),icon:l.jsx(zj,{size:16})}];return n==="sidebar"?l.jsxs("div",{className:Vr.sidebarContainer,children:[e&&l.jsx("div",{className:Vr.sidebarLabel,children:c("settings.themeSettings")}),l.jsxs("div",{className:Vr.sidebarSection,children:[l.jsx("div",{className:Vr.sectionTitle,children:c("settings.displayMode")}),l.jsx("div",{className:Vr.modeToggleTab,children:u.map(d=>l.jsxs("button",{className:`${Vr.modeTabButton} ${t.mode===d.id?Vr.active:""}`,onClick:()=>i(d.id),title:d.name,children:[l.jsx("span",{className:Vr.modeIcon,children:d.icon}),l.jsx("span",{className:Vr.modeName,children:d.name})]},d.id))})]}),l.jsxs("div",{className:Vr.sidebarSection,children:[l.jsx("div",{className:Vr.sectionTitle,children:c("settings.themeColor")}),l.jsx("div",{className:Vr.colorGrid,children:h.map(d=>l.jsx("button",{className:`${Vr.colorButton} ${t.color===d.id?Vr.active:""}`,onClick:()=>r(d.id),title:d.name,style:{backgroundColor:d.color},children:t.color===d.id&&l.jsx("span",{className:Vr.checkIcon,children:"✓"})},d.id))})]})]}):l.jsxs("div",{className:Vr.dropdownContainer,children:[l.jsxs("button",{className:Vr.trigger,onClick:()=>a(!o),title:c("settings.themeSettings"),children:[l.jsx(DI,{size:20}),e&&l.jsx("span",{children:c("settings.theme")})]}),o&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:Vr.overlay,onClick:()=>a(!1)}),l.jsxs("div",{className:Vr.dropdown,children:[l.jsxs("div",{className:Vr.dropdownHeader,children:[l.jsx("h3",{children:c("settings.themeSettings")}),l.jsx("button",{className:Vr.closeButton,onClick:()=>a(!1),children:"×"})]}),l.jsxs("div",{className:Vr.section,children:[l.jsx("div",{className:Vr.sectionTitle,children:c("settings.displayMode")}),l.jsx("div",{className:Vr.modeList,children:u.map(d=>l.jsxs("button",{className:`${Vr.modeItem} ${t.mode===d.id?Vr.active:""}`,onClick:()=>{i(d.id),a(!1)},children:[l.jsx("span",{className:Vr.modeIcon,children:d.icon}),l.jsx("span",{children:d.name}),t.mode===d.id&&l.jsx("span",{className:Vr.checkIcon,children:"✓"})]},d.id))})]}),l.jsxs("div",{className:Vr.section,children:[l.jsx("div",{className:Vr.sectionTitle,children:c("settings.themeColor")}),l.jsx("div",{className:Vr.colorList,children:h.map(d=>l.jsx("button",{className:`${Vr.colorItem} ${t.color===d.id?Vr.active:""}`,onClick:()=>{r(d.id),a(!1)},title:d.name,children:l.jsx("div",{className:Vr.colorPreview,style:{backgroundColor:d.color},children:t.color===d.id&&l.jsx("span",{className:Vr.checkIcon,children:"✓"})})},d.id))})]}),l.jsx("div",{className:Vr.section,children:l.jsxs("button",{className:Vr.quickToggle,onClick:()=>{s(),a(!1)},children:[t.mode==="light"?l.jsx(zj,{size:16}):l.jsx(Vj,{size:16}),t.mode==="light"?c("settings.darkMode"):c("settings.lightMode")]})})]})]})]})},kxe="_overlay_1lv4s_2",Ixe="_panel_1lv4s_13",Fxe="_header_1lv4s_37",Dxe="_title_1lv4s_46",jxe="_closeButton_1lv4s_53",Pxe="_content_1lv4s_76",Nxe="_section_1lv4s_82",Lxe="_sectionTitle_1lv4s_91",Mxe="_themeContainer_1lv4s_99",Rxe="_settingGroup_1lv4s_104",Oxe="_settingItem_1lv4s_110",Uxe="_settingInfo_1lv4s_116",Hxe="_settingLabel_1lv4s_122",Wxe="_settingDescription_1lv4s_128",Qxe="_slider_1lv4s_147",$xe="_languageSelect_1lv4s_181",Vxe="_shortcutList_1lv4s_210",zxe="_shortcutItem_1lv4s_216",Gxe="_shortcutAction_1lv4s_223",Xxe="_shortcutKey_1lv4s_228",Kxe="_infoList_1lv4s_239",qxe="_infoItem_1lv4s_245",Yxe="_infoLabel_1lv4s_252",Zxe="_infoValue_1lv4s_257",ji={overlay:kxe,panel:Ixe,header:Fxe,title:Dxe,closeButton:jxe,content:Pxe,section:Nxe,sectionTitle:Lxe,themeContainer:Mxe,settingGroup:Rxe,settingItem:Oxe,settingInfo:Uxe,settingLabel:Hxe,settingDescription:Wxe,switch:"_switch_1lv4s_134",slider:Qxe,languageSelect:$xe,shortcutList:Vxe,shortcutItem:zxe,shortcutAction:Gxe,shortcutKey:Xxe,infoList:Kxe,infoItem:qxe,infoLabel:Yxe,infoValue:Zxe},nF=({isOpen:n,onClose:e})=>{const{t,currentLanguage:i,changeLanguage:r,availableLanguages:s}=Eo();O.useEffect(()=>{const a=()=>{};return window.addEventListener("languageChange",a),()=>{window.removeEventListener("languageChange",a)}},[]);const o=a=>{const c=a.target.value;console.log("🔄 Changing language from",i,"to",c),r(c),setTimeout(()=>{window.location.reload()},100)};return n?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:ji.overlay,onClick:e}),l.jsxs("div",{className:ji.panel,children:[l.jsxs("div",{className:ji.header,children:[l.jsx("h2",{className:ji.title,children:t("settings.title")}),l.jsx("button",{className:ji.closeButton,onClick:e,children:"×"})]}),l.jsxs("div",{className:ji.content,children:[l.jsxs("div",{className:ji.section,children:[l.jsx("h3",{className:ji.sectionTitle,children:t("settings.theme")}),l.jsx("div",{className:ji.themeContainer,children:l.jsx(Exe,{variant:"sidebar",showLabel:!1})})]}),l.jsxs("div",{className:ji.section,children:[l.jsx("h3",{className:ji.sectionTitle,children:t("settings.general")}),l.jsxs("div",{className:ji.settingGroup,children:[l.jsxs("div",{className:ji.settingItem,children:[l.jsxs("div",{className:ji.settingInfo,children:[l.jsx("span",{className:ji.settingLabel,children:t("settings.language")}),l.jsx("span",{className:ji.settingDescription,children:t("settings.languageDesc")})]}),l.jsx("select",{value:i,onChange:o,className:ji.languageSelect,children:s.map(a=>l.jsx("option",{value:a.code,children:a.name},a.code))})]}),l.jsxs("div",{className:ji.settingItem,children:[l.jsxs("div",{className:ji.settingInfo,children:[l.jsx("span",{className:ji.settingLabel,children:t("settings.notifications")}),l.jsx("span",{className:ji.settingDescription,children:t("settings.notificationsDesc")})]}),l.jsxs("label",{className:ji.switch,children:[l.jsx("input",{type:"checkbox",defaultChecked:!0}),l.jsx("span",{className:ji.slider})]})]}),l.jsxs("div",{className:ji.settingItem,children:[l.jsxs("div",{className:ji.settingInfo,children:[l.jsx("span",{className:ji.settingLabel,children:t("settings.autoSave")}),l.jsx("span",{className:ji.settingDescription,children:t("settings.autoSaveDesc")})]}),l.jsxs("label",{className:ji.switch,children:[l.jsx("input",{type:"checkbox",defaultChecked:!0}),l.jsx("span",{className:ji.slider})]})]}),l.jsxs("div",{className:ji.settingItem,children:[l.jsxs("div",{className:ji.settingInfo,children:[l.jsx("span",{className:ji.settingLabel,children:t("settings.gridSnap")}),l.jsx("span",{className:ji.settingDescription,children:t("settings.gridSnapDesc")})]}),l.jsxs("label",{className:ji.switch,children:[l.jsx("input",{type:"checkbox",defaultChecked:!0}),l.jsx("span",{className:ji.slider})]})]})]})]}),l.jsxs("div",{className:ji.section,children:[l.jsx("h3",{className:ji.sectionTitle,children:t("settings.shortcuts")}),l.jsxs("div",{className:ji.shortcutList,children:[l.jsxs("div",{className:ji.shortcutItem,children:[l.jsx("span",{className:ji.shortcutAction,children:t("common.save")}),l.jsx("kbd",{className:ji.shortcutKey,children:"Ctrl + S"})]}),l.jsxs("div",{className:ji.shortcutItem,children:[l.jsx("span",{className:ji.shortcutAction,children:t("common.undo")}),l.jsx("kbd",{className:ji.shortcutKey,children:"Ctrl + Z"})]}),l.jsxs("div",{className:ji.shortcutItem,children:[l.jsx("span",{className:ji.shortcutAction,children:t("common.redo")}),l.jsx("kbd",{className:ji.shortcutKey,children:"Ctrl + Y"})]}),l.jsxs("div",{className:ji.shortcutItem,children:[l.jsx("span",{className:ji.shortcutAction,children:t("common.copy")}),l.jsx("kbd",{className:ji.shortcutKey,children:"Ctrl + C"})]}),l.jsxs("div",{className:ji.shortcutItem,children:[l.jsx("span",{className:ji.shortcutAction,children:t("common.paste")}),l.jsx("kbd",{className:ji.shortcutKey,children:"Ctrl + V"})]})]})]}),l.jsxs("div",{className:ji.section,children:[l.jsx("h3",{className:ji.sectionTitle,children:t("settings.info")}),l.jsxs("div",{className:ji.infoList,children:[l.jsxs("div",{className:ji.infoItem,children:[l.jsx("span",{className:ji.infoLabel,children:t("settings.version")}),l.jsx("span",{className:ji.infoValue,children:"1.0.0"})]}),l.jsxs("div",{className:ji.infoItem,children:[l.jsx("span",{className:ji.infoLabel,children:t("settings.lastUpdate")}),l.jsx("span",{className:ji.infoValue,children:"2024.01.15"})]})]})]})]})]})]}):null},V5=({size:n="medium"})=>{const{theme:e}=Yo(),i={small:{mSize:20,logoFontSize:14,gap:6,mBorderRadius:4},medium:{mSize:32,logoFontSize:18,gap:8,mBorderRadius:6},large:{mSize:40,logoFontSize:24,gap:10,mBorderRadius:8}}[n];return l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:i.gap,cursor:"pointer",transition:"all 0.2s ease"},children:[l.jsx("div",{style:{width:i.mSize,height:i.mSize,backgroundColor:"var(--theme-primary)",borderRadius:i.mBorderRadius,display:"flex",alignItems:"center",justifyContent:"center",color:"#ffffff",fontSize:i.mSize*.6,fontWeight:"bold",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',transition:"all 0.2s ease"},children:"m"}),l.jsx("span",{style:{fontSize:i.logoFontSize,fontWeight:"600",color:"var(--theme-text)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',transition:"color 0.2s ease"},children:"logo"})]})},Jxe="_overlay_xweix_1",ebe="_popup_xweix_22",tbe="_header_xweix_50",nbe="_headerContent_xweix_56",ibe="_headerLeft_xweix_62",rbe="_headerAvatar_xweix_69",sbe="_headerAvatarPlaceholder_xweix_78",obe="_headerInfo_xweix_90",abe="_headerName_xweix_95",lbe="_headerEmail_xweix_106",cbe="_closeButton_xweix_115",hbe="_content_xweix_135",ube="_section_xweix_142",dbe="_sectionTitle_xweix_148",Abe="_infoSection_xweix_160",fbe="_infoRow_xweix_166",pbe="_infoLabel_xweix_181",gbe="_infoValue_xweix_194",mbe="_menuSection_xweix_201",ybe="_menuItem_xweix_207",vbe="_menuLeft_xweix_232",wbe="_uidSection_xweix_245",xbe="_uidLabel_xweix_256",bbe="_uid_xweix_245",os={overlay:Jxe,popup:ebe,header:tbe,headerContent:nbe,headerLeft:ibe,headerAvatar:rbe,headerAvatarPlaceholder:sbe,headerInfo:obe,headerName:abe,headerEmail:lbe,closeButton:cbe,content:hbe,section:ube,sectionTitle:dbe,infoSection:Abe,infoRow:fbe,infoLabel:pbe,infoValue:gbe,menuSection:mbe,menuItem:ybe,menuLeft:vbe,uidSection:wbe,uidLabel:xbe,uid:bbe},_be=({isOpen:n,onClose:e,position:t})=>{var c,h,u,d,f,A;const{user:i}=ec(),r=xc(),{t:s}=Eo();if(!n||!i)return null;const o=g=>g?new Date(g).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"}):"정보 없음",a=g=>{if(!g)return"정보 없음";const p=new Date(g),v=new Date().getTime()-p.getTime(),m=Math.floor(v/6e4),w=Math.floor(v/36e5),x=Math.floor(v/864e5);return m<1?"방금 전":m<60?`${m}분 전`:w<24?`${w}시간 전`:x<7?`${x}일 전`:p.toLocaleDateString("ko-KR")};return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:os.overlay,onClick:e}),l.jsxs("div",{className:os.popup,style:{top:t.top,right:t.right},children:[l.jsx("div",{className:os.header,children:l.jsxs("div",{className:os.headerContent,children:[l.jsxs("div",{className:os.headerLeft,children:[i.photoURL?l.jsx("img",{src:i.photoURL,alt:i.displayName||"사용자",className:os.headerAvatar}):l.jsx("div",{className:os.headerAvatarPlaceholder,children:l.jsx(Yz,{size:20})}),l.jsxs("div",{className:os.headerInfo,children:[l.jsx("h3",{className:os.headerName,children:i.displayName||"사용자"}),l.jsx("p",{className:os.headerEmail,children:i.email})]})]}),l.jsx("button",{className:os.closeButton,onClick:e,children:l.jsx(Zz,{size:20})})]})}),l.jsxs("div",{className:os.content,children:[l.jsxs("div",{className:os.section,children:[l.jsx("h4",{className:os.sectionTitle,children:s("profile.accountInfo")}),l.jsxs("div",{className:os.infoSection,children:[l.jsxs("div",{className:os.infoRow,children:[l.jsxs("div",{className:os.infoLabel,children:[l.jsx(Kz,{size:18}),l.jsx("span",{children:s("profile.authMethod")})]}),l.jsx("span",{className:os.infoValue,children:((h=(c=i.providerData)==null?void 0:c[0])==null?void 0:h.providerId)==="google.com"?s("profile.googleAccount"):((d=(u=i.providerData)==null?void 0:u[0])==null?void 0:d.providerId)==="password"?s("profile.emailAuth"):s("profile.other")})]}),l.jsxs("div",{className:os.infoRow,children:[l.jsxs("div",{className:os.infoLabel,children:[l.jsx(qL,{size:18}),l.jsx("span",{children:s("profile.joinDate")})]}),l.jsx("span",{className:os.infoValue,children:o((f=i.metadata)==null?void 0:f.creationTime)})]}),l.jsxs("div",{className:os.infoRow,children:[l.jsxs("div",{className:os.infoLabel,children:[l.jsx(qL,{size:18}),l.jsx("span",{children:s("profile.lastActivity")})]}),l.jsx("span",{className:os.infoValue,children:a((A=i.metadata)==null?void 0:A.lastSignInTime)})]})]})]}),l.jsxs("div",{className:os.section,children:[l.jsx("h4",{className:os.sectionTitle,children:s("profile.quickMenu")}),l.jsxs("div",{className:os.menuSection,children:[l.jsxs("button",{className:os.menuItem,children:[l.jsxs("div",{className:os.menuLeft,children:[l.jsx($5,{size:18}),l.jsx("span",{children:s("profile.accountSettings")})]}),l.jsx(fC,{size:16})]}),l.jsxs("button",{className:os.menuItem,onClick:async()=>{await dQ(),r("/auth")},children:[l.jsxs("div",{className:os.menuLeft,children:[l.jsx(eF,{size:18}),l.jsx("span",{children:s("common.logout")})]}),l.jsx(fC,{size:16})]})]})]}),l.jsxs("div",{className:os.uidSection,children:[l.jsx("span",{className:os.uidLabel,children:"User ID"}),l.jsx("code",{className:os.uid,children:i.uid})]})]})]})]})},Cbe=({title:n,projectName:e,designFileName:t,projectId:i,designFileId:r,onSave:s,onPrevious:o,onNext:a,onHelp:c,onConvert:h,onLogout:u,onProfile:d,saving:f=!1,saveStatus:A="idle",hasDoorsInstalled:g=!1,onDoorInstallationToggle:p,onNewProject:y,onSaveAs:v,onProjectNameChange:m,onDesignFileChange:w,onFileTreeToggle:x,isFileTreeOpen:T,onExportPDF:j})=>{var ve;const{user:D}=ec(),b=xc(),{t:_,currentLanguage:I}=Eo(),[S,F]=O.useState(!1),[B,E]=O.useState(!1),[V,K]=O.useState(!1),[P,M]=O.useState(!1),[X,Z]=O.useState(!1),[Q,U]=O.useState({top:60,right:20}),[z,q]=O.useState(!1),G=O.useRef(null),ie=O.useRef(null),H=O.useRef(null);console.log("🔍 Header 컴포넌트 title:",n),console.log("🔍 Header 컴포넌트 projectName:",e),O.useEffect(()=>()=>{ie.current&&clearTimeout(ie.current)},[]);const se=()=>{F(!0)},te=()=>{F(!1)},fe=()=>{console.log("📁 파일 메뉴 토글:",!B),ie.current&&(clearTimeout(ie.current),ie.current=null),E(!B)},ye=()=>{ie.current&&(clearTimeout(ie.current),ie.current=null)},be=()=>{ie.current=setTimeout(()=>{E(!1)},300)},_e=()=>{console.log("🆕 Header - 새디자인 버튼 클릭됨"),console.log("🆕 Header - onNewProject 타입:",typeof y),E(!1),y==null||y()},W=()=>{E(!1),v==null||v()},Y=()=>{if(G.current){const ce=G.current.getBoundingClientRect();U({top:ce.bottom+8,right:window.innerWidth-ce.right})}Z(!X)};return O.useEffect(()=>{const ce=ne=>{H.current&&!H.current.contains(ne.target)&&q(!1)};return z&&document.addEventListener("mousedown",ce),()=>{document.removeEventListener("mousedown",ce)}},[z]),l.jsxs("header",{className:es.header,children:[l.jsxs("div",{className:es.container,children:[l.jsxs("div",{className:es.logoSection,children:[l.jsx("button",{className:`${es.hamburgerButton} ${T?es.active:""}`,onClick:x,title:"파일 트리 열기/닫기",children:l.jsx(hwe,{size:20})}),l.jsx("div",{className:es.logo,children:l.jsx(V5,{size:"medium"})}),t&&l.jsx("div",{className:es.projectInfo,children:l.jsx("div",{className:es.designFileName,children:t})})]}),l.jsxs("div",{className:es.centerActions,children:[l.jsxs("div",{className:es.fileMenuContainer,onMouseEnter:ye,onMouseLeave:be,children:[l.jsxs("button",{className:es.actionButton,onClick:fe,children:[l.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[l.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z",stroke:"currentColor",strokeWidth:"2"}),l.jsx("polyline",{points:"14,2 14,8 20,8",stroke:"currentColor",strokeWidth:"2"}),l.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13",stroke:"currentColor",strokeWidth:"2"}),l.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17",stroke:"currentColor",strokeWidth:"2"}),l.jsx("polyline",{points:"10,9 9,9 8,9",stroke:"currentColor",strokeWidth:"2"})]}),_("common.file"),l.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",style:{marginLeft:"4px"},children:l.jsx("polyline",{points:"6,9 12,15 18,9",stroke:"currentColor",strokeWidth:"2"})})]}),B&&l.jsxs("div",{className:es.fileDropdown,children:[l.jsxs("button",{className:es.dropdownItem,onClick:ce=>{ce.preventDefault(),ce.stopPropagation(),console.log("🆕 Header - 새디자인 버튼 직접 클릭됨"),_e()},children:[l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[l.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z",stroke:"currentColor",strokeWidth:"2"}),l.jsx("polyline",{points:"14,2 14,8 20,8",stroke:"currentColor",strokeWidth:"2"}),l.jsx("line",{x1:"12",y1:"18",x2:"12",y2:"12",stroke:"currentColor",strokeWidth:"2"}),l.jsx("line",{x1:"9",y1:"15",x2:"15",y2:"15",stroke:"currentColor",strokeWidth:"2"})]}),I==="ko"?"새 디자인":_("project.newProject")]}),l.jsxs("button",{className:es.dropdownItem,onClick:ce=>{ce.preventDefault(),ce.stopPropagation(),console.log("💾 Header - 다른이름으로 저장 버튼 클릭됨"),W()},children:[l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[l.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",stroke:"currentColor",strokeWidth:"2"}),l.jsx("polyline",{points:"17,21 17,13 7,13 7,21",stroke:"currentColor",strokeWidth:"2"}),l.jsx("polyline",{points:"7,3 7,8 15,8",stroke:"currentColor",strokeWidth:"2"}),l.jsx("path",{d:"M7 16h2v2H7z",stroke:"currentColor",strokeWidth:"1"})]}),_("project.saveAs")]})]})]}),l.jsxs("button",{className:es.actionButton,onClick:s,disabled:f,children:[l.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[l.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",stroke:"currentColor",strokeWidth:"2"}),l.jsx("polyline",{points:"17,21 17,13 7,13 7,21",stroke:"currentColor",strokeWidth:"2"}),l.jsx("polyline",{points:"7,3 7,8 15,8",stroke:"currentColor",strokeWidth:"2"})]}),_(f?"common.saving":"common.save")]}),o&&l.jsxs("button",{className:es.actionButton,onClick:o,children:[l.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:l.jsx("polyline",{points:"15,18 9,12 15,6",stroke:"currentColor",strokeWidth:"2"})}),_("common.back")]}),a&&l.jsxs("button",{className:es.actionButton,onClick:a,children:[l.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[l.jsx("path",{d:"M9 11l3 3L22 4",stroke:"currentColor",strokeWidth:"2",fill:"none"}),l.jsx("path",{d:"M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11",stroke:"currentColor",strokeWidth:"2",fill:"none"})]}),_("common.finish")]}),c&&l.jsxs("button",{className:es.actionButton,onClick:c,children:[l.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[l.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),l.jsx("path",{d:"m9,9a3,3 0 1 1 5.83,1c0,2-3,3-3,3",stroke:"currentColor",strokeWidth:"2"}),l.jsx("circle",{cx:"12",cy:"17",r:"1",fill:"currentColor"})]}),_("common.help")]}),l.jsxs("button",{className:es.actionButton,onClick:se,children:[l.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[l.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z",stroke:"currentColor",strokeWidth:"2"}),l.jsx("path",{d:"M2 17l10 5 10-5",stroke:"currentColor",strokeWidth:"2"}),l.jsx("path",{d:"M2 12l10 5 10-5",stroke:"currentColor",strokeWidth:"2"})]}),_("help.title")]})]}),l.jsxs("div",{className:es.rightActions,children:[l.jsx("button",{className:es.actionButton,onClick:()=>M(!0),title:_("settings.title"),children:l.jsx($5,{size:20})}),j&&l.jsxs("button",{className:es.convertButton,onClick:()=>{console.log("내보내기 버튼 클릭됨"),j()},children:[l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",style:{marginRight:"4px"},children:[l.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",stroke:"currentColor",strokeWidth:"2"}),l.jsx("polyline",{points:"7,10 12,15 17,10",stroke:"currentColor",strokeWidth:"2"}),l.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3",stroke:"currentColor",strokeWidth:"2"})]}),_("export.title")]}),l.jsxs("div",{className:es.convertButtonContainer,ref:H,children:[l.jsxs("button",{className:es.convertButton,onClick:()=>q(!z),children:[_("common.converting"),l.jsx(lA,{size:16,style:{marginLeft:"4px"}})]}),z&&l.jsxs("div",{className:es.dropdownMenu,children:[l.jsxs("button",{className:es.dropdownItem,onClick:()=>{console.log("CNC 옵티마이저 버튼 클릭됨");const ce={projectId:i,designFileId:r,basicInfo:Ha.getState().basicInfo,spaceInfo:qi.getState().spaceInfo,placedModules:ci.getState().placedModules,timestamp:Date.now()};sessionStorage.setItem("configurator_state_backup",JSON.stringify(ce)),console.log("💾 Configurator 상태 백업 완료");const ne=new URLSearchParams;i&&ne.set("projectId",i),r&&ne.set("designFileId",r);const he=ne.toString();b(`/cnc-optimizer${he?`?${he}`:""}`,{state:{fromConfigurator:!0}}),q(!1)},children:[l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",style:{marginRight:"8px"},children:[l.jsx("rect",{x:"3",y:"3",width:"18",height:"18",stroke:"currentColor",strokeWidth:"2"}),l.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9",stroke:"currentColor",strokeWidth:"2"}),l.jsx("line",{x1:"9",y1:"3",x2:"9",y2:"21",stroke:"currentColor",strokeWidth:"2"})]}),_("export.cuttingOptimizer")]}),h&&l.jsxs("button",{className:es.dropdownItem,onClick:()=>{h(),q(!1)},children:[l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",style:{marginRight:"8px"},children:[l.jsx("rect",{x:"3",y:"3",width:"7",height:"7",stroke:"currentColor",strokeWidth:"2"}),l.jsx("rect",{x:"14",y:"3",width:"7",height:"7",stroke:"currentColor",strokeWidth:"2"}),l.jsx("rect",{x:"3",y:"14",width:"7",height:"7",stroke:"currentColor",strokeWidth:"2"}),l.jsx("rect",{x:"14",y:"14",width:"7",height:"7",stroke:"currentColor",strokeWidth:"2"})]}),_("export.drawingEditor")]})]})]}),D?l.jsxs(l.Fragment,{children:[u&&l.jsxs("button",{className:es.logoutButton,onClick:u,children:[l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[l.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",stroke:"currentColor",strokeWidth:"2"}),l.jsx("polyline",{points:"16,17 21,12 16,7",stroke:"currentColor",strokeWidth:"2"}),l.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12",stroke:"currentColor",strokeWidth:"2"})]}),I==="ko"?"로그아웃":_("common.logout")]}),l.jsxs("div",{ref:G,className:es.userProfile,onClick:d?Y:void 0,style:{cursor:d?"pointer":"default"},children:[l.jsx("div",{className:es.userProfileAvatar,children:D!=null&&D.photoURL&&!V?l.jsx("img",{src:D.photoURL,alt:D.displayName||D.email||"사용자",className:es.profileImage,onError:()=>K(!0),onLoad:()=>K(!1)}):l.jsx(Yz,{size:16})}),l.jsx("span",{className:es.userProfileName,children:(D==null?void 0:D.displayName)||((ve=D==null?void 0:D.email)==null?void 0:ve.split("@")[0])||"사용자"})]})]}):l.jsxs("button",{className:es.loginButton,onClick:()=>b("/login"),children:[l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[l.jsx("path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",stroke:"currentColor",strokeWidth:"2"}),l.jsx("polyline",{points:"10 17 15 12 10 7",stroke:"currentColor",strokeWidth:"2"}),l.jsx("line",{x1:"15",y1:"12",x2:"3",y2:"12",stroke:"currentColor",strokeWidth:"2"})]}),I==="ko"?"로그인":_("common.login")]})]})]}),A==="success"&&l.jsxs("div",{className:es.saveSuccess,children:["✓ ",_("messages.saveSuccess")]}),A==="error"&&l.jsxs("div",{className:es.saveError,children:["✕ ",_("messages.saveFailed")]}),l.jsx(nxe,{isOpen:S,onClose:te}),l.jsx(nF,{isOpen:P,onClose:()=>M(!1)}),l.jsx(_be,{isOpen:X,onClose:()=>Z(!1),position:Q})]})},Sbe="_sidebar_zeohw_1",Tbe="_open_zeohw_15",Bbe="_tabList_zeohw_19",Ebe="_tabButton_zeohw_27",kbe="_active_zeohw_46",Ibe="_tabIcon_zeohw_78",Fbe="_tabLabel_zeohw_100",Dbe="_userSection_zeohw_122",jbe="_settingsButton_zeohw_161",Pbe="_modalOverlay_zeohw_223",Nbe="_modalContent_zeohw_247",Lbe="_modalIcon_zeohw_269",Mbe="_modalTitle_zeohw_281",Rbe="_modalDescription_zeohw_290",Obe="_modalActions_zeohw_298",Ube="_modalButtonCancel_zeohw_304",Hbe="_modalButtonConfirm_zeohw_322",bl={sidebar:Sbe,open:Tbe,tabList:Bbe,tabButton:Ebe,active:kbe,tabIcon:Ibe,tabLabel:Fbe,userSection:Dbe,settingsButton:jbe,modalOverlay:Pbe,modalContent:Nbe,modalIcon:Lbe,modalTitle:Mbe,modalDescription:Rbe,modalActions:Obe,modalButtonCancel:Ube,modalButtonConfirm:Hbe},Wbe=({activeTab:n,onTabClick:e,isOpen:t,onToggle:i,onResetUnsavedChanges:r})=>{const{user:s}=ec(),{theme:o}=Yo(),a=xc(),{t:c}=Eo();Ha(),qi(),ci();const[h,u]=O.useState(null),[d,f]=O.useState(!1),A=O.useCallback(()=>{const w=Ha.getState(),x=qi.getState(),T=ci.getState(),j={project:{basicInfo:w.basicInfo},spaceConfig:{spaceInfo:x.spaceInfo,materialConfig:x.materialConfig,columns:x.columns},furniture:{placedModules:T.placedModules}};u(JSON.parse(JSON.stringify(j)))},[]);O.useEffect(()=>{const w=setTimeout(()=>{A()},500);return()=>clearTimeout(w)},[A]),O.useEffect(()=>{r&&r.current!==void 0&&(r.current=A)},[r]);const g=()=>{if(!h)return!1;const w=Ha.getState(),x=qi.getState(),T=ci.getState(),j={project:{basicInfo:w.basicInfo},spaceConfig:{spaceInfo:x.spaceInfo,materialConfig:x.materialConfig,columns:x.columns},furniture:{placedModules:T.placedModules}};return JSON.stringify(h)!==JSON.stringify(j)},p=()=>{g()?f(!0):a("/dashboard")},v={green:"#10b981",blue:"#3b82f6",purple:"#8b5cf6",vivid:"#a25378",red:"#D2042D",pink:"#ec4899",indigo:"#6366f1",teal:"#14b8a6",yellow:"#eab308",gray:"#6b7280",cyan:"#06b6d4",lime:"#84cc16",black:"#1a1a1a",wine:"#845EC2",gold:"#d97706",navy:"#1e3a8a",emerald:"#059669",violet:"#C128D7",mint:"#0CBA80",neon:"#18CF23",rust:"#FF7438",white:"#D65DB1",plum:"#790963",brown:"#5A2B1D",darkgray:"#2C3844",maroon:"#3F0D0D",turquoise:"#003A7A",slate:"#2E3A47",copper:"#AD4F34",forest:"#1B3924",olive:"#4C462C"}[o.color]||"#10b981",m=[{id:"module",icon:l.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[l.jsx("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1",stroke:"currentColor",strokeWidth:"2"}),l.jsx("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1",stroke:"currentColor",strokeWidth:"2"}),l.jsx("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1",stroke:"currentColor",strokeWidth:"2"}),l.jsx("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1",stroke:"currentColor",strokeWidth:"2"})]}),label:c("sidebar.module")},{id:"material",icon:l.jsx(The,{size:20}),label:c("sidebar.material")},{id:"structure",icon:l.jsx(Lhe,{size:20}),label:c("sidebar.structure")},{id:"etc",icon:l.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[l.jsx("circle",{cx:"5",cy:"12",r:"1",stroke:"currentColor",strokeWidth:"2"}),l.jsx("circle",{cx:"12",cy:"12",r:"1",stroke:"currentColor",strokeWidth:"2"}),l.jsx("circle",{cx:"19",cy:"12",r:"1",stroke:"currentColor",strokeWidth:"2"})]}),label:c("sidebar.etc")}];return l.jsxs("aside",{className:`${bl.sidebar} ${t?bl.open:""}`,children:[l.jsx("div",{className:bl.tabList,children:m.map(w=>l.jsxs("button",{className:`${bl.tabButton} ${n===w.id?bl.active:""}`,onClick:()=>e(w.id),title:w.label,children:[w.icon&&l.jsx("div",{className:bl.tabIcon,children:w.icon}),l.jsx("span",{className:bl.tabLabel,children:w.label})]},w.id))}),l.jsx("div",{className:bl.userSection,children:l.jsx("button",{className:bl.settingsButton,title:c("sidebar.exitToDashboard"),onClick:p,children:l.jsx(eF,{size:24,style:{transform:"scaleX(-1)"},color:v})})}),d&&l.jsx("div",{className:bl.modalOverlay,onClick:()=>f(!1),children:l.jsxs("div",{className:bl.modalContent,onClick:w=>w.stopPropagation(),children:[l.jsx("div",{className:bl.modalIcon,children:l.jsx("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{d:"M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4M16 17l5-5-5-5M21 12H9",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),l.jsx("h3",{className:bl.modalTitle,children:c("messages.unsavedChanges")}),l.jsxs("p",{className:bl.modalDescription,children:[c("messages.exitConfirm"),l.jsx("br",{}),c("messages.loseChanges")]}),l.jsxs("div",{className:bl.modalActions,children:[l.jsx("button",{className:bl.modalButtonCancel,onClick:async()=>{f(!1),r!=null&&r.current&&await r.current(),a("/dashboard")},children:c("messages.exitWithSaving")}),l.jsx("button",{className:bl.modalButtonConfirm,onClick:()=>{f(!1),a("/dashboard")},children:c("messages.exitWithoutSaving")})]})]})})]})},Qbe="_viewerControls_1mz5y_1",$be="_leftControls_1mz5y_39",Vbe="_toggleGroup_1mz5y_55",zbe="_toggleLabel_1mz5y_75",Gbe="_clickable_1mz5y_97",Xbe="_on_1mz5y_139",Kbe="_off_1mz5y_147",qbe="_switchHandle_1mz5y_155",Ybe="_checkboxGroup_1mz5y_193",Zbe="_checkboxLabel_1mz5y_205",Jbe="_checkbox_1mz5y_193",e_e="_checkmark_1mz5y_239",t_e="_centerControls_1mz5y_297",n_e="_rightControls_1mz5y_313",i_e="_renderModeGroup_1mz5y_343",r_e="_renderModeButton_1mz5y_359",s_e="_active_1mz5y_415",o_e="_viewModeGroup_1mz5y_435",a_e="_viewModeButton_1mz5y_449",l_e="_doorButtonGroup_1mz5y_571",c_e="_doorButton_1mz5y_571",h_e="_viewDirectionGroup_1mz5y_659",u_e="_viewDirectionButton_1mz5y_673",d_e="_themeToggle_1mz5y_741",jr={viewerControls:Qbe,leftControls:$be,toggleGroup:Vbe,toggleLabel:zbe,clickable:Gbe,switch:"_switch_1mz5y_117",on:Xbe,off:Kbe,switchHandle:qbe,checkboxGroup:Ybe,checkboxLabel:Zbe,checkbox:Jbe,checkmark:e_e,centerControls:t_e,rightControls:n_e,renderModeGroup:i_e,renderModeButton:r_e,active:s_e,viewModeGroup:o_e,viewModeButton:a_e,doorButtonGroup:l_e,doorButton:c_e,viewDirectionGroup:h_e,viewDirectionButton:u_e,themeToggle:d_e};var f0={},B4,YL;function A_e(){return YL||(YL=1,B4=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),B4}var E4={},ef={},ZL;function Fg(){if(ZL)return ef;ZL=1;let n;const e=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return ef.getSymbolSize=function(i){if(!i)throw new Error('"version" cannot be null or undefined');if(i<1||i>40)throw new Error('"version" should be in range from 1 to 40');return i*4+17},ef.getSymbolTotalCodewords=function(i){return e[i]},ef.getBCHDigit=function(t){let i=0;for(;t!==0;)i++,t>>>=1;return i},ef.setToSJISFunction=function(i){if(typeof i!="function")throw new Error('"toSJISFunc" is not a valid function.');n=i},ef.isKanjiModeEnabled=function(){return typeof n<"u"},ef.toSJIS=function(i){return n(i)},ef}var k4={},JL;function iF(){return JL||(JL=1,(function(n){n.L={bit:1},n.M={bit:0},n.Q={bit:3},n.H={bit:2};function e(t){if(typeof t!="string")throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return n.L;case"m":case"medium":return n.M;case"q":case"quartile":return n.Q;case"h":case"high":return n.H;default:throw new Error("Unknown EC Level: "+t)}}n.isValid=function(i){return i&&typeof i.bit<"u"&&i.bit>=0&&i.bit<4},n.from=function(i,r){if(n.isValid(i))return i;try{return e(i)}catch{return r}}})(k4)),k4}var I4,eM;function f_e(){if(eM)return I4;eM=1;function n(){this.buffer=[],this.length=0}return n.prototype={get:function(e){const t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)===1},put:function(e,t){for(let i=0;i<t;i++)this.putBit((e>>>t-i-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},I4=n,I4}var F4,tM;function p_e(){if(tM)return F4;tM=1;function n(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}return n.prototype.set=function(e,t,i,r){const s=e*this.size+t;this.data[s]=i,r&&(this.reservedBit[s]=!0)},n.prototype.get=function(e,t){return this.data[e*this.size+t]},n.prototype.xor=function(e,t,i){this.data[e*this.size+t]^=i},n.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]},F4=n,F4}var D4={},nM;function g_e(){return nM||(nM=1,(function(n){const e=Fg().getSymbolSize;n.getRowColCoords=function(i){if(i===1)return[];const r=Math.floor(i/7)+2,s=e(i),o=s===145?26:Math.ceil((s-13)/(2*r-2))*2,a=[s-7];for(let c=1;c<r-1;c++)a[c]=a[c-1]-o;return a.push(6),a.reverse()},n.getPositions=function(i){const r=[],s=n.getRowColCoords(i),o=s.length;for(let a=0;a<o;a++)for(let c=0;c<o;c++)a===0&&c===0||a===0&&c===o-1||a===o-1&&c===0||r.push([s[a],s[c]]);return r}})(D4)),D4}var j4={},iM;function m_e(){if(iM)return j4;iM=1;const n=Fg().getSymbolSize,e=7;return j4.getPositions=function(i){const r=n(i);return[[0,0],[r-e,0],[0,r-e]]},j4}var P4={},rM;function y_e(){return rM||(rM=1,(function(n){n.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};n.isValid=function(r){return r!=null&&r!==""&&!isNaN(r)&&r>=0&&r<=7},n.from=function(r){return n.isValid(r)?parseInt(r,10):void 0},n.getPenaltyN1=function(r){const s=r.size;let o=0,a=0,c=0,h=null,u=null;for(let d=0;d<s;d++){a=c=0,h=u=null;for(let f=0;f<s;f++){let A=r.get(d,f);A===h?a++:(a>=5&&(o+=e.N1+(a-5)),h=A,a=1),A=r.get(f,d),A===u?c++:(c>=5&&(o+=e.N1+(c-5)),u=A,c=1)}a>=5&&(o+=e.N1+(a-5)),c>=5&&(o+=e.N1+(c-5))}return o},n.getPenaltyN2=function(r){const s=r.size;let o=0;for(let a=0;a<s-1;a++)for(let c=0;c<s-1;c++){const h=r.get(a,c)+r.get(a,c+1)+r.get(a+1,c)+r.get(a+1,c+1);(h===4||h===0)&&o++}return o*e.N2},n.getPenaltyN3=function(r){const s=r.size;let o=0,a=0,c=0;for(let h=0;h<s;h++){a=c=0;for(let u=0;u<s;u++)a=a<<1&2047|r.get(h,u),u>=10&&(a===1488||a===93)&&o++,c=c<<1&2047|r.get(u,h),u>=10&&(c===1488||c===93)&&o++}return o*e.N3},n.getPenaltyN4=function(r){let s=0;const o=r.data.length;for(let c=0;c<o;c++)s+=r.data[c];return Math.abs(Math.ceil(s*100/o/5)-10)*e.N4};function t(i,r,s){switch(i){case n.Patterns.PATTERN000:return(r+s)%2===0;case n.Patterns.PATTERN001:return r%2===0;case n.Patterns.PATTERN010:return s%3===0;case n.Patterns.PATTERN011:return(r+s)%3===0;case n.Patterns.PATTERN100:return(Math.floor(r/2)+Math.floor(s/3))%2===0;case n.Patterns.PATTERN101:return r*s%2+r*s%3===0;case n.Patterns.PATTERN110:return(r*s%2+r*s%3)%2===0;case n.Patterns.PATTERN111:return(r*s%3+(r+s)%2)%2===0;default:throw new Error("bad maskPattern:"+i)}}n.applyMask=function(r,s){const o=s.size;for(let a=0;a<o;a++)for(let c=0;c<o;c++)s.isReserved(c,a)||s.xor(c,a,t(r,c,a))},n.getBestMask=function(r,s){const o=Object.keys(n.Patterns).length;let a=0,c=1/0;for(let h=0;h<o;h++){s(h),n.applyMask(h,r);const u=n.getPenaltyN1(r)+n.getPenaltyN2(r)+n.getPenaltyN3(r)+n.getPenaltyN4(r);n.applyMask(h,r),u<c&&(c=u,a=h)}return a}})(P4)),P4}var Jx={},sM;function tG(){if(sM)return Jx;sM=1;const n=iF(),e=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],t=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return Jx.getBlocksCount=function(r,s){switch(s){case n.L:return e[(r-1)*4+0];case n.M:return e[(r-1)*4+1];case n.Q:return e[(r-1)*4+2];case n.H:return e[(r-1)*4+3];default:return}},Jx.getTotalCodewordsCount=function(r,s){switch(s){case n.L:return t[(r-1)*4+0];case n.M:return t[(r-1)*4+1];case n.Q:return t[(r-1)*4+2];case n.H:return t[(r-1)*4+3];default:return}},Jx}var N4={},z1={},oM;function v_e(){if(oM)return z1;oM=1;const n=new Uint8Array(512),e=new Uint8Array(256);return(function(){let i=1;for(let r=0;r<255;r++)n[r]=i,e[i]=r,i<<=1,i&256&&(i^=285);for(let r=255;r<512;r++)n[r]=n[r-255]})(),z1.log=function(i){if(i<1)throw new Error("log("+i+")");return e[i]},z1.exp=function(i){return n[i]},z1.mul=function(i,r){return i===0||r===0?0:n[e[i]+e[r]]},z1}var aM;function w_e(){return aM||(aM=1,(function(n){const e=v_e();n.mul=function(i,r){const s=new Uint8Array(i.length+r.length-1);for(let o=0;o<i.length;o++)for(let a=0;a<r.length;a++)s[o+a]^=e.mul(i[o],r[a]);return s},n.mod=function(i,r){let s=new Uint8Array(i);for(;s.length-r.length>=0;){const o=s[0];for(let c=0;c<r.length;c++)s[c]^=e.mul(r[c],o);let a=0;for(;a<s.length&&s[a]===0;)a++;s=s.slice(a)}return s},n.generateECPolynomial=function(i){let r=new Uint8Array([1]);for(let s=0;s<i;s++)r=n.mul(r,new Uint8Array([1,e.exp(s)]));return r}})(N4)),N4}var L4,lM;function x_e(){if(lM)return L4;lM=1;const n=w_e();function e(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}return e.prototype.initialize=function(i){this.degree=i,this.genPoly=n.generateECPolynomial(this.degree)},e.prototype.encode=function(i){if(!this.genPoly)throw new Error("Encoder not initialized");const r=new Uint8Array(i.length+this.degree);r.set(i);const s=n.mod(r,this.genPoly),o=this.degree-s.length;if(o>0){const a=new Uint8Array(this.degree);return a.set(s,o),a}return s},L4=e,L4}var M4={},R4={},O4={},cM;function nG(){return cM||(cM=1,O4.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40}),O4}var Ku={},hM;function iG(){if(hM)return Ku;hM=1;const n="[0-9]+",e="[A-Z $%*+\\-./:]+";let t="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";t=t.replace(/u/g,"\\u");const i="(?:(?![A-Z0-9 $%*+\\-./:]|"+t+`)(?:.|[\r
]))+`;Ku.KANJI=new RegExp(t,"g"),Ku.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),Ku.BYTE=new RegExp(i,"g"),Ku.NUMERIC=new RegExp(n,"g"),Ku.ALPHANUMERIC=new RegExp(e,"g");const r=new RegExp("^"+t+"$"),s=new RegExp("^"+n+"$"),o=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return Ku.testKanji=function(c){return r.test(c)},Ku.testNumeric=function(c){return s.test(c)},Ku.testAlphanumeric=function(c){return o.test(c)},Ku}var uM;function Dg(){return uM||(uM=1,(function(n){const e=nG(),t=iG();n.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},n.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},n.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},n.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},n.MIXED={bit:-1},n.getCharCountIndicator=function(s,o){if(!s.ccBits)throw new Error("Invalid mode: "+s);if(!e.isValid(o))throw new Error("Invalid version: "+o);return o>=1&&o<10?s.ccBits[0]:o<27?s.ccBits[1]:s.ccBits[2]},n.getBestModeForData=function(s){return t.testNumeric(s)?n.NUMERIC:t.testAlphanumeric(s)?n.ALPHANUMERIC:t.testKanji(s)?n.KANJI:n.BYTE},n.toString=function(s){if(s&&s.id)return s.id;throw new Error("Invalid mode")},n.isValid=function(s){return s&&s.bit&&s.ccBits};function i(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"numeric":return n.NUMERIC;case"alphanumeric":return n.ALPHANUMERIC;case"kanji":return n.KANJI;case"byte":return n.BYTE;default:throw new Error("Unknown mode: "+r)}}n.from=function(s,o){if(n.isValid(s))return s;try{return i(s)}catch{return o}}})(R4)),R4}var dM;function b_e(){return dM||(dM=1,(function(n){const e=Fg(),t=tG(),i=iF(),r=Dg(),s=nG(),o=7973,a=e.getBCHDigit(o);function c(f,A,g){for(let p=1;p<=40;p++)if(A<=n.getCapacity(p,g,f))return p}function h(f,A){return r.getCharCountIndicator(f,A)+4}function u(f,A){let g=0;return f.forEach(function(p){const y=h(p.mode,A);g+=y+p.getBitsLength()}),g}function d(f,A){for(let g=1;g<=40;g++)if(u(f,g)<=n.getCapacity(g,A,r.MIXED))return g}n.from=function(A,g){return s.isValid(A)?parseInt(A,10):g},n.getCapacity=function(A,g,p){if(!s.isValid(A))throw new Error("Invalid QR Code version");typeof p>"u"&&(p=r.BYTE);const y=e.getSymbolTotalCodewords(A),v=t.getTotalCodewordsCount(A,g),m=(y-v)*8;if(p===r.MIXED)return m;const w=m-h(p,A);switch(p){case r.NUMERIC:return Math.floor(w/10*3);case r.ALPHANUMERIC:return Math.floor(w/11*2);case r.KANJI:return Math.floor(w/13);case r.BYTE:default:return Math.floor(w/8)}},n.getBestVersionForData=function(A,g){let p;const y=i.from(g,i.M);if(Array.isArray(A)){if(A.length>1)return d(A,y);if(A.length===0)return 1;p=A[0]}else p=A;return c(p.mode,p.getLength(),y)},n.getEncodedBits=function(A){if(!s.isValid(A)||A<7)throw new Error("Invalid QR Code version");let g=A<<12;for(;e.getBCHDigit(g)-a>=0;)g^=o<<e.getBCHDigit(g)-a;return A<<12|g}})(M4)),M4}var U4={},AM;function __e(){if(AM)return U4;AM=1;const n=Fg(),e=1335,t=21522,i=n.getBCHDigit(e);return U4.getEncodedBits=function(s,o){const a=s.bit<<3|o;let c=a<<10;for(;n.getBCHDigit(c)-i>=0;)c^=e<<n.getBCHDigit(c)-i;return(a<<10|c)^t},U4}var H4={},W4,fM;function C_e(){if(fM)return W4;fM=1;const n=Dg();function e(t){this.mode=n.NUMERIC,this.data=t.toString()}return e.getBitsLength=function(i){return 10*Math.floor(i/3)+(i%3?i%3*3+1:0)},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(i){let r,s,o;for(r=0;r+3<=this.data.length;r+=3)s=this.data.substr(r,3),o=parseInt(s,10),i.put(o,10);const a=this.data.length-r;a>0&&(s=this.data.substr(r),o=parseInt(s,10),i.put(o,a*3+1))},W4=e,W4}var Q4,pM;function S_e(){if(pM)return Q4;pM=1;const n=Dg(),e=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function t(i){this.mode=n.ALPHANUMERIC,this.data=i}return t.getBitsLength=function(r){return 11*Math.floor(r/2)+6*(r%2)},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(r){let s;for(s=0;s+2<=this.data.length;s+=2){let o=e.indexOf(this.data[s])*45;o+=e.indexOf(this.data[s+1]),r.put(o,11)}this.data.length%2&&r.put(e.indexOf(this.data[s]),6)},Q4=t,Q4}var $4,gM;function T_e(){if(gM)return $4;gM=1;const n=Dg();function e(t){this.mode=n.BYTE,typeof t=="string"?this.data=new TextEncoder().encode(t):this.data=new Uint8Array(t)}return e.getBitsLength=function(i){return i*8},e.prototype.getLength=function(){return this.data.length},e.prototype.getBitsLength=function(){return e.getBitsLength(this.data.length)},e.prototype.write=function(t){for(let i=0,r=this.data.length;i<r;i++)t.put(this.data[i],8)},$4=e,$4}var V4,mM;function B_e(){if(mM)return V4;mM=1;const n=Dg(),e=Fg();function t(i){this.mode=n.KANJI,this.data=i}return t.getBitsLength=function(r){return r*13},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(i){let r;for(r=0;r<this.data.length;r++){let s=e.toSJIS(this.data[r]);if(s>=33088&&s<=40956)s-=33088;else if(s>=57408&&s<=60351)s-=49472;else throw new Error("Invalid SJIS character: "+this.data[r]+`
Make sure your charset is UTF-8`);s=(s>>>8&255)*192+(s&255),i.put(s,13)}},V4=t,V4}var z4={exports:{}},yM;function E_e(){return yM||(yM=1,(function(n){var e={single_source_shortest_paths:function(t,i,r){var s={},o={};o[i]=0;var a=e.PriorityQueue.make();a.push(i,0);for(var c,h,u,d,f,A,g,p,y;!a.empty();){c=a.pop(),h=c.value,d=c.cost,f=t[h]||{};for(u in f)f.hasOwnProperty(u)&&(A=f[u],g=d+A,p=o[u],y=typeof o[u]>"u",(y||p>g)&&(o[u]=g,a.push(u,g),s[u]=h))}if(typeof r<"u"&&typeof o[r]>"u"){var v=["Could not find a path from ",i," to ",r,"."].join("");throw new Error(v)}return s},extract_shortest_path_from_predecessor_list:function(t,i){for(var r=[],s=i;s;)r.push(s),t[s],s=t[s];return r.reverse(),r},find_path:function(t,i,r){var s=e.single_source_shortest_paths(t,i,r);return e.extract_shortest_path_from_predecessor_list(s,r)},PriorityQueue:{make:function(t){var i=e.PriorityQueue,r={},s;t=t||{};for(s in i)i.hasOwnProperty(s)&&(r[s]=i[s]);return r.queue=[],r.sorter=t.sorter||i.default_sorter,r},default_sorter:function(t,i){return t.cost-i.cost},push:function(t,i){var r={value:t,cost:i};this.queue.push(r),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};n.exports=e})(z4)),z4.exports}var vM;function k_e(){return vM||(vM=1,(function(n){const e=Dg(),t=C_e(),i=S_e(),r=T_e(),s=B_e(),o=iG(),a=Fg(),c=E_e();function h(v){return unescape(encodeURIComponent(v)).length}function u(v,m,w){const x=[];let T;for(;(T=v.exec(w))!==null;)x.push({data:T[0],index:T.index,mode:m,length:T[0].length});return x}function d(v){const m=u(o.NUMERIC,e.NUMERIC,v),w=u(o.ALPHANUMERIC,e.ALPHANUMERIC,v);let x,T;return a.isKanjiModeEnabled()?(x=u(o.BYTE,e.BYTE,v),T=u(o.KANJI,e.KANJI,v)):(x=u(o.BYTE_KANJI,e.BYTE,v),T=[]),m.concat(w,x,T).sort(function(D,b){return D.index-b.index}).map(function(D){return{data:D.data,mode:D.mode,length:D.length}})}function f(v,m){switch(m){case e.NUMERIC:return t.getBitsLength(v);case e.ALPHANUMERIC:return i.getBitsLength(v);case e.KANJI:return s.getBitsLength(v);case e.BYTE:return r.getBitsLength(v)}}function A(v){return v.reduce(function(m,w){const x=m.length-1>=0?m[m.length-1]:null;return x&&x.mode===w.mode?(m[m.length-1].data+=w.data,m):(m.push(w),m)},[])}function g(v){const m=[];for(let w=0;w<v.length;w++){const x=v[w];switch(x.mode){case e.NUMERIC:m.push([x,{data:x.data,mode:e.ALPHANUMERIC,length:x.length},{data:x.data,mode:e.BYTE,length:x.length}]);break;case e.ALPHANUMERIC:m.push([x,{data:x.data,mode:e.BYTE,length:x.length}]);break;case e.KANJI:m.push([x,{data:x.data,mode:e.BYTE,length:h(x.data)}]);break;case e.BYTE:m.push([{data:x.data,mode:e.BYTE,length:h(x.data)}])}}return m}function p(v,m){const w={},x={start:{}};let T=["start"];for(let j=0;j<v.length;j++){const D=v[j],b=[];for(let _=0;_<D.length;_++){const I=D[_],S=""+j+_;b.push(S),w[S]={node:I,lastCount:0},x[S]={};for(let F=0;F<T.length;F++){const B=T[F];w[B]&&w[B].node.mode===I.mode?(x[B][S]=f(w[B].lastCount+I.length,I.mode)-f(w[B].lastCount,I.mode),w[B].lastCount+=I.length):(w[B]&&(w[B].lastCount=I.length),x[B][S]=f(I.length,I.mode)+4+e.getCharCountIndicator(I.mode,m))}}T=b}for(let j=0;j<T.length;j++)x[T[j]].end=0;return{map:x,table:w}}function y(v,m){let w;const x=e.getBestModeForData(v);if(w=e.from(m,x),w!==e.BYTE&&w.bit<x.bit)throw new Error('"'+v+'" cannot be encoded with mode '+e.toString(w)+`.
 Suggested mode is: `+e.toString(x));switch(w===e.KANJI&&!a.isKanjiModeEnabled()&&(w=e.BYTE),w){case e.NUMERIC:return new t(v);case e.ALPHANUMERIC:return new i(v);case e.KANJI:return new s(v);case e.BYTE:return new r(v)}}n.fromArray=function(m){return m.reduce(function(w,x){return typeof x=="string"?w.push(y(x,null)):x.data&&w.push(y(x.data,x.mode)),w},[])},n.fromString=function(m,w){const x=d(m,a.isKanjiModeEnabled()),T=g(x),j=p(T,w),D=c.find_path(j.map,"start","end"),b=[];for(let _=1;_<D.length-1;_++)b.push(j.table[D[_]].node);return n.fromArray(A(b))},n.rawSplit=function(m){return n.fromArray(d(m,a.isKanjiModeEnabled()))}})(H4)),H4}var wM;function I_e(){if(wM)return E4;wM=1;const n=Fg(),e=iF(),t=f_e(),i=p_e(),r=g_e(),s=m_e(),o=y_e(),a=tG(),c=x_e(),h=b_e(),u=__e(),d=Dg(),f=k_e();function A(j,D){const b=j.size,_=s.getPositions(D);for(let I=0;I<_.length;I++){const S=_[I][0],F=_[I][1];for(let B=-1;B<=7;B++)if(!(S+B<=-1||b<=S+B))for(let E=-1;E<=7;E++)F+E<=-1||b<=F+E||(B>=0&&B<=6&&(E===0||E===6)||E>=0&&E<=6&&(B===0||B===6)||B>=2&&B<=4&&E>=2&&E<=4?j.set(S+B,F+E,!0,!0):j.set(S+B,F+E,!1,!0))}}function g(j){const D=j.size;for(let b=8;b<D-8;b++){const _=b%2===0;j.set(b,6,_,!0),j.set(6,b,_,!0)}}function p(j,D){const b=r.getPositions(D);for(let _=0;_<b.length;_++){const I=b[_][0],S=b[_][1];for(let F=-2;F<=2;F++)for(let B=-2;B<=2;B++)F===-2||F===2||B===-2||B===2||F===0&&B===0?j.set(I+F,S+B,!0,!0):j.set(I+F,S+B,!1,!0)}}function y(j,D){const b=j.size,_=h.getEncodedBits(D);let I,S,F;for(let B=0;B<18;B++)I=Math.floor(B/3),S=B%3+b-8-3,F=(_>>B&1)===1,j.set(I,S,F,!0),j.set(S,I,F,!0)}function v(j,D,b){const _=j.size,I=u.getEncodedBits(D,b);let S,F;for(S=0;S<15;S++)F=(I>>S&1)===1,S<6?j.set(S,8,F,!0):S<8?j.set(S+1,8,F,!0):j.set(_-15+S,8,F,!0),S<8?j.set(8,_-S-1,F,!0):S<9?j.set(8,15-S-1+1,F,!0):j.set(8,15-S-1,F,!0);j.set(_-8,8,1,!0)}function m(j,D){const b=j.size;let _=-1,I=b-1,S=7,F=0;for(let B=b-1;B>0;B-=2)for(B===6&&B--;;){for(let E=0;E<2;E++)if(!j.isReserved(I,B-E)){let V=!1;F<D.length&&(V=(D[F]>>>S&1)===1),j.set(I,B-E,V),S--,S===-1&&(F++,S=7)}if(I+=_,I<0||b<=I){I-=_,_=-_;break}}}function w(j,D,b){const _=new t;b.forEach(function(E){_.put(E.mode.bit,4),_.put(E.getLength(),d.getCharCountIndicator(E.mode,j)),E.write(_)});const I=n.getSymbolTotalCodewords(j),S=a.getTotalCodewordsCount(j,D),F=(I-S)*8;for(_.getLengthInBits()+4<=F&&_.put(0,4);_.getLengthInBits()%8!==0;)_.putBit(0);const B=(F-_.getLengthInBits())/8;for(let E=0;E<B;E++)_.put(E%2?17:236,8);return x(_,j,D)}function x(j,D,b){const _=n.getSymbolTotalCodewords(D),I=a.getTotalCodewordsCount(D,b),S=_-I,F=a.getBlocksCount(D,b),B=_%F,E=F-B,V=Math.floor(_/F),K=Math.floor(S/F),P=K+1,M=V-K,X=new c(M);let Z=0;const Q=new Array(F),U=new Array(F);let z=0;const q=new Uint8Array(j.buffer);for(let te=0;te<F;te++){const fe=te<E?K:P;Q[te]=q.slice(Z,Z+fe),U[te]=X.encode(Q[te]),Z+=fe,z=Math.max(z,fe)}const G=new Uint8Array(_);let ie=0,H,se;for(H=0;H<z;H++)for(se=0;se<F;se++)H<Q[se].length&&(G[ie++]=Q[se][H]);for(H=0;H<M;H++)for(se=0;se<F;se++)G[ie++]=U[se][H];return G}function T(j,D,b,_){let I;if(Array.isArray(j))I=f.fromArray(j);else if(typeof j=="string"){let V=D;if(!V){const K=f.rawSplit(j);V=h.getBestVersionForData(K,b)}I=f.fromString(j,V||40)}else throw new Error("Invalid data");const S=h.getBestVersionForData(I,b);if(!S)throw new Error("The amount of data is too big to be stored in a QR Code");if(!D)D=S;else if(D<S)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+S+`.
`);const F=w(D,b,I),B=n.getSymbolSize(D),E=new i(B);return A(E,D),g(E),p(E,D),v(E,b,0),D>=7&&y(E,D),m(E,F),isNaN(_)&&(_=o.getBestMask(E,v.bind(null,E,b))),o.applyMask(_,E),v(E,b,_),{modules:E,version:D,errorCorrectionLevel:b,maskPattern:_,segments:I}}return E4.create=function(D,b){if(typeof D>"u"||D==="")throw new Error("No input text");let _=e.M,I,S;return typeof b<"u"&&(_=e.from(b.errorCorrectionLevel,e.M),I=h.from(b.version),S=o.from(b.maskPattern),b.toSJISFunc&&n.setToSJISFunction(b.toSJISFunc)),T(D,I,_,S)},E4}var G4={},X4={},xM;function rG(){return xM||(xM=1,(function(n){function e(t){if(typeof t=="number"&&(t=t.toString()),typeof t!="string")throw new Error("Color should be defined as hex string");let i=t.slice().replace("#","").split("");if(i.length<3||i.length===5||i.length>8)throw new Error("Invalid hex color: "+t);(i.length===3||i.length===4)&&(i=Array.prototype.concat.apply([],i.map(function(s){return[s,s]}))),i.length===6&&i.push("F","F");const r=parseInt(i.join(""),16);return{r:r>>24&255,g:r>>16&255,b:r>>8&255,a:r&255,hex:"#"+i.slice(0,6).join("")}}n.getOptions=function(i){i||(i={}),i.color||(i.color={});const r=typeof i.margin>"u"||i.margin===null||i.margin<0?4:i.margin,s=i.width&&i.width>=21?i.width:void 0,o=i.scale||4;return{width:s,scale:s?4:o,margin:r,color:{dark:e(i.color.dark||"#000000ff"),light:e(i.color.light||"#ffffffff")},type:i.type,rendererOpts:i.rendererOpts||{}}},n.getScale=function(i,r){return r.width&&r.width>=i+r.margin*2?r.width/(i+r.margin*2):r.scale},n.getImageWidth=function(i,r){const s=n.getScale(i,r);return Math.floor((i+r.margin*2)*s)},n.qrToImageData=function(i,r,s){const o=r.modules.size,a=r.modules.data,c=n.getScale(o,s),h=Math.floor((o+s.margin*2)*c),u=s.margin*c,d=[s.color.light,s.color.dark];for(let f=0;f<h;f++)for(let A=0;A<h;A++){let g=(f*h+A)*4,p=s.color.light;if(f>=u&&A>=u&&f<h-u&&A<h-u){const y=Math.floor((f-u)/c),v=Math.floor((A-u)/c);p=d[a[y*o+v]?1:0]}i[g++]=p.r,i[g++]=p.g,i[g++]=p.b,i[g]=p.a}}})(X4)),X4}var bM;function F_e(){return bM||(bM=1,(function(n){const e=rG();function t(r,s,o){r.clearRect(0,0,s.width,s.height),s.style||(s.style={}),s.height=o,s.width=o,s.style.height=o+"px",s.style.width=o+"px"}function i(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}n.render=function(s,o,a){let c=a,h=o;typeof c>"u"&&(!o||!o.getContext)&&(c=o,o=void 0),o||(h=i()),c=e.getOptions(c);const u=e.getImageWidth(s.modules.size,c),d=h.getContext("2d"),f=d.createImageData(u,u);return e.qrToImageData(f.data,s,c),t(d,h,u),d.putImageData(f,0,0),h},n.renderToDataURL=function(s,o,a){let c=a;typeof c>"u"&&(!o||!o.getContext)&&(c=o,o=void 0),c||(c={});const h=n.render(s,o,c),u=c.type||"image/png",d=c.rendererOpts||{};return h.toDataURL(u,d.quality)}})(G4)),G4}var K4={},_M;function D_e(){if(_M)return K4;_M=1;const n=rG();function e(r,s){const o=r.a/255,a=s+'="'+r.hex+'"';return o<1?a+" "+s+'-opacity="'+o.toFixed(2).slice(1)+'"':a}function t(r,s,o){let a=r+s;return typeof o<"u"&&(a+=" "+o),a}function i(r,s,o){let a="",c=0,h=!1,u=0;for(let d=0;d<r.length;d++){const f=Math.floor(d%s),A=Math.floor(d/s);!f&&!h&&(h=!0),r[d]?(u++,d>0&&f>0&&r[d-1]||(a+=h?t("M",f+o,.5+A+o):t("m",c,0),c=0,h=!1),f+1<s&&r[d+1]||(a+=t("h",u),u=0)):c++}return a}return K4.render=function(s,o,a){const c=n.getOptions(o),h=s.modules.size,u=s.modules.data,d=h+c.margin*2,f=c.color.light.a?"<path "+e(c.color.light,"fill")+' d="M0 0h'+d+"v"+d+'H0z"/>':"",A="<path "+e(c.color.dark,"stroke")+' d="'+i(u,h,c.margin)+'"/>',g='viewBox="0 0 '+d+" "+d+'"',y='<svg xmlns="http://www.w3.org/2000/svg" '+(c.width?'width="'+c.width+'" height="'+c.width+'" ':"")+g+' shape-rendering="crispEdges">'+f+A+`</svg>
`;return typeof a=="function"&&a(null,y),y},K4}var CM;function j_e(){if(CM)return f0;CM=1;const n=A_e(),e=I_e(),t=F_e(),i=D_e();function r(s,o,a,c,h){const u=[].slice.call(arguments,1),d=u.length,f=typeof u[d-1]=="function";if(!f&&!n())throw new Error("Callback required as last argument");if(f){if(d<2)throw new Error("Too few arguments provided");d===2?(h=a,a=o,o=c=void 0):d===3&&(o.getContext&&typeof h>"u"?(h=c,c=void 0):(h=c,c=a,a=o,o=void 0))}else{if(d<1)throw new Error("Too few arguments provided");return d===1?(a=o,o=c=void 0):d===2&&!o.getContext&&(c=a,a=o,o=void 0),new Promise(function(A,g){try{const p=e.create(a,c);A(s(p,o,c))}catch(p){g(p)}})}try{const A=e.create(a,c);h(null,s(A,o,c))}catch(A){h(A)}}return f0.create=e.create,f0.toCanvas=r.bind(null,t.render),f0.toDataURL=r.bind(null,t.renderToDataURL),f0.toString=r.bind(null,function(s,o,a){return i.render(s,a)}),f0}var P_e=j_e();const SM=Kf(P_e),N_e="_overlay_1nd5f_1",L_e="_modal_1nd5f_14",M_e="_header_1nd5f_25",R_e="_closeButton_1nd5f_39",O_e="_content_1nd5f_59",U_e="_loading_1nd5f_63",H_e="_qrContainer_1nd5f_69",W_e="_instructions_1nd5f_92",Q_e="_urlSection_1nd5f_113",$_e="_urlInput_1nd5f_119",V_e="_copyButton_1nd5f_130",z_e="_requirements_1nd5f_145",G_e="_error_1nd5f_169",X_e="_retryButton_1nd5f_180",K_e="_warning_1nd5f_196",q_e="_iosNotice_1nd5f_222",Vl={overlay:N_e,modal:L_e,header:M_e,closeButton:R_e,content:O_e,loading:U_e,qrContainer:H_e,instructions:W_e,urlSection:Q_e,urlInput:$_e,copyButton:V_e,requirements:z_e,error:G_e,retryButton:X_e,warning:K_e,iosNotice:q_e},Y_e=({onClose:n})=>{const e=O.useRef(null),[t,i]=O.useState(""),[r,s]=O.useState(!0),[o,a]=O.useState(null),[c,h]=O.useState(null),{placedModules:u}=ci(),{spaceInfo:d}=qi(),{projectId:f}=Ha();O.useEffect(()=>{A()},[]);const A=async()=>{try{a(null),s(!0);const p={projectId:f,spaceInfo:{width:d.width,height:d.height,depth:d.depth,materialConfig:d.materialConfig,baseConfig:d.baseConfig,frameSize:d.frameSize,surroundType:d.surroundType},placedModules:u.map(w=>({id:w.id,moduleId:w.moduleId,position:w.position,rotation:w.rotation,slotIndex:w.slotIndex,customDepth:w.customDepth,hasDoor:w.hasDoor,hingePosition:w.hingePosition,adjustedWidth:w.adjustedWidth,adjustedPosition:w.adjustedPosition})),timestamp:Date.now()},y=`ar_${Date.now()}`;localStorage.setItem(`ar_data_${y}`,JSON.stringify(p));const v=window.location.origin,m=`${v}/ar-viewer?id=${y}`;i(m),(v.includes("localhost")||v.includes("127.0.0.1"))&&console.warn("AR requires HTTPS. Use ngrok or deploy to a server with HTTPS.");try{e.current&&(e.current.width=300,e.current.height=300,await SM.toCanvas(e.current,m,{width:300,margin:2,color:{dark:"#000000",light:"#FFFFFF"},errorCorrectionLevel:"M"}),console.log("QR Code generated on canvas for URL:",m));const w=await SM.toDataURL(m,{width:300,margin:2,color:{dark:"#000000",light:"#FFFFFF"},errorCorrectionLevel:"M"});h(w),console.log("QR Code data URL generated")}catch(w){throw console.error("QR code generation error:",w),w}s(!1)}catch(p){console.error("QR 코드 생성 오류:",p),a("QR 코드 생성에 실패했습니다. 다시 시도해주세요."),s(!1)}},g=()=>{navigator.clipboard.writeText(t),alert("URL이 클립보드에 복사되었습니다.")};return $C.createPortal(l.jsx("div",{className:Vl.overlay,children:l.jsxs("div",{className:Vl.modal,children:[l.jsxs("div",{className:Vl.header,children:[l.jsx("h2",{children:"AR 뷰어 QR 코드"}),l.jsx("button",{className:Vl.closeButton,onClick:n,children:"✕"})]}),l.jsx("div",{className:Vl.content,children:r?l.jsx("div",{className:Vl.loading,children:"QR 코드 생성 중..."}):o?l.jsxs("div",{className:Vl.error,children:[l.jsx("p",{children:o}),l.jsx("button",{onClick:A,className:Vl.retryButton,children:"다시 시도"})]}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:Vl.qrContainer,children:c?l.jsx("img",{src:c,alt:"AR QR Code",style:{display:"block",width:"300px",height:"300px"}}):l.jsx("canvas",{ref:e,style:{display:"block",width:"300px",height:"300px"}})}),l.jsxs("div",{className:Vl.instructions,children:[l.jsx("h3",{children:"사용 방법"}),l.jsxs("ol",{children:[l.jsx("li",{children:"모바일 기기의 카메라로 QR 코드를 스캔하세요"}),l.jsx("li",{children:"AR 뷰어가 자동으로 열립니다"}),l.jsx("li",{children:"카메라 권한을 허용하세요"}),l.jsx("li",{children:"평평한 바닥을 찾아 탭하여 가구를 배치하세요"})]}),(t.includes("localhost")||t.includes("127.0.0.1"))&&l.jsxs("div",{className:Vl.warning,children:[l.jsx("strong",{children:"⚠️ 주의:"})," AR 기능은 HTTPS가 필요합니다. 로컬 개발 환경에서는 작동하지 않을 수 있습니다.",l.jsx("br",{}),l.jsx("strong",{children:"해결 방법:"}),l.jsxs("ul",{children:[l.jsx("li",{children:"배포된 서버에서 사용하세요"}),l.jsx("li",{children:"또는 ngrok 등으로 HTTPS 터널을 만드세요"})]})]})]}),l.jsxs("div",{className:Vl.urlSection,children:[l.jsx("input",{type:"text",value:t,readOnly:!0,className:Vl.urlInput}),l.jsx("button",{className:Vl.copyButton,onClick:g,children:"복사"})]}),l.jsxs("div",{className:Vl.requirements,children:[l.jsx("h4",{children:"지원 기기"}),l.jsxs("ul",{children:[l.jsx("li",{children:"iOS: AR Quick Look (USDZ 파일) - 개발 중"}),l.jsx("li",{children:"Android 7+ (Chrome) - WebXR 지원"})]}),l.jsxs("div",{className:Vl.iosNotice,children:[l.jsx("strong",{children:"📱 iOS 사용자 안내:"}),l.jsx("p",{children:"현재 iOS Safari는 WebXR을 지원하지 않습니다."}),l.jsx("p",{children:"대신 3D 뷰어로 가구 배치를 확인하실 수 있습니다."})]})]})]})})]})}),document.body)},Z_e=({viewMode:n,onViewModeChange:e,viewDirection:t,onViewDirectionChange:i,renderMode:r,onRenderModeChange:s,showAll:o,onShowAllToggle:a,showDimensions:c,onShowDimensionsToggle:h,showDimensionsText:u,onShowDimensionsTextToggle:d,showGuides:f,onShowGuidesToggle:A,showAxis:g,onShowAxisToggle:p,showFurniture:y,onShowFurnitureToggle:v,doorsOpen:m,onDoorsToggle:w,hasDoorsInstalled:x=!1,onDoorInstallationToggle:T})=>{const{view2DDirection:j,setView2DDirection:D,view2DTheme:b,toggleView2DTheme:_,setView2DTheme:I}=Bi(),{theme:S}=Yo(),[F,B]=O.useState(!1);O.useEffect(()=>{try{const Q=localStorage.getItem("ui-store");if(Q){const U=JSON.parse(Q);U.state&&U.state.view2DTheme!==void 0&&(delete U.state.view2DTheme,localStorage.setItem("ui-store",JSON.stringify(U)))}}catch(Q){console.warn("localStorage 정리 실패:",Q)}const Z=S.mode==="dark"?"dark":"light";console.log("ViewerControls mount - theme mode:",S.mode,"setting 2D theme to:",Z),I(Z)},[S,I]);const{t:E}=Kv(),V=[{id:"3D",label:"3D"},{id:"2D",label:"2D"}],K=[{id:"front",label:E("viewer.front")},{id:"top",label:E("viewer.top")},{id:"left",label:E("viewer.left")},{id:"right",label:E("viewer.right")}],P=[{id:"all",label:E("viewer.all")},...K],M=[{id:"solid",label:E("viewer.solid")},{id:"wireframe",label:E("viewer.wireframe")}],X=Z=>{D(Z),i(Z)};return l.jsxs("div",{className:jr.viewerControls,children:[l.jsxs("div",{className:jr.leftControls,children:[l.jsxs("div",{className:jr.toggleGroup,children:[l.jsx("span",{className:`${jr.toggleLabel} ${jr.clickable}`,onClick:()=>{h()},style:{cursor:"pointer"},children:c?E("viewer.on").toUpperCase():E("viewer.off").toUpperCase()}),l.jsx("button",{className:`${jr.switch} ${c?jr.on:jr.off}`,onClick:()=>{h()},children:l.jsx("div",{className:jr.switchHandle})})]}),c&&l.jsxs("div",{className:jr.checkboxGroup,children:[n==="2D"&&l.jsxs("label",{className:jr.checkboxLabel,children:[l.jsx("input",{type:"checkbox",checked:y,onChange:v,className:jr.checkbox}),l.jsx("span",{className:jr.checkmark}),E("furniture.title")]}),l.jsxs("label",{className:jr.checkboxLabel,children:[l.jsx("input",{type:"checkbox",checked:o,onChange:a,className:jr.checkbox}),l.jsx("span",{className:jr.checkmark}),E("viewer.column")]}),l.jsxs("label",{className:jr.checkboxLabel,children:[l.jsx("input",{type:"checkbox",checked:u,onChange:d,className:jr.checkbox}),l.jsx("span",{className:jr.checkmark}),E("viewer.dimensions")]}),n==="2D"&&l.jsxs(l.Fragment,{children:[l.jsxs("label",{className:jr.checkboxLabel,children:[l.jsx("input",{type:"checkbox",checked:f,onChange:A,className:jr.checkbox}),l.jsx("span",{className:jr.checkmark}),E("viewer.grid")]}),l.jsxs("label",{className:jr.checkboxLabel,children:[l.jsx("input",{type:"checkbox",checked:g,onChange:p,className:jr.checkbox}),l.jsx("span",{className:jr.checkmark}),E("viewer.axis")]})]})]})]}),l.jsxs("div",{className:jr.centerControls,children:[l.jsx("div",{className:jr.renderModeGroup,children:M.map(Z=>l.jsx("button",{className:`${jr.renderModeButton} ${r===Z.id?jr.active:""}`,onClick:()=>s(Z.id),children:Z.label},Z.id))}),l.jsx("div",{className:jr.viewModeGroup,children:V.map(Z=>l.jsx("button",{"data-view-mode":Z.id,className:`${jr.viewModeButton} ${n===Z.id?jr.active:""}`,onClick:()=>{if(e(Z.id),Z.id==="2D"){r!=="wireframe"&&s("wireframe");const Q=S.mode==="dark"?"dark":"light";I(Q)}},title:Z.id==="3D"?"3D":"2D",children:Z.label},Z.id))}),T&&l.jsx("div",{className:jr.doorButtonGroup,children:l.jsxs("button",{className:`${jr.doorButton} ${x?jr.active:""}`,onClick:T,children:[l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[l.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",stroke:"currentColor",strokeWidth:"2"}),l.jsx("circle",{cx:"9",cy:"12",r:"1",fill:"currentColor"}),x&&l.jsx("path",{d:"M8 12l2 2 4-4",stroke:"currentColor",strokeWidth:"2",fill:"none"})]}),E("viewer.doorInstallation")]})})]}),l.jsx("div",{className:jr.rightControls,children:n==="2D"&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:jr.viewDirectionGroup,children:P.map(Z=>l.jsx("button",{"data-view-direction":Z.id,className:`${jr.viewDirectionButton} ${j===Z.id?jr.active:""}`,onClick:()=>X(Z.id),children:Z.label},Z.id))}),l.jsx("button",{className:jr.themeToggle,onClick:()=>{_()},title:E(b==="dark"?"settings.lightMode":"settings.darkMode"),children:b==="dark"?l.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}):l.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("circle",{cx:"12",cy:"12",r:"5"}),l.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),l.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),l.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),l.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),l.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),l.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),l.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),l.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]})})]})}),F&&l.jsx(Y_e,{onClose:()=>B(!1)})]})},J_e="_active_1fclr_42",eCe="_sliderHandle_1fclr_237",tCe="_doorSlider_1fclr_436",nCe="_sliderTrack_1fclr_441",iCe="_sliderActiveTrack_1fclr_450",rCe="_sliderLabels_1fclr_494",p0={active:J_e,sliderHandle:eCe,doorSlider:tCe,sliderTrack:nCe,sliderActiveTrack:iCe,sliderLabels:rCe},q4=({value:n,onChange:e,width:t})=>{var D,b,_,I;const[i,r]=O.useState(!1),s=ii.useRef(null),{spaceInfo:o}=qi(),a=588,c=()=>{var S;if((S=o.droppedCeiling)!=null&&S.enabled){const F=t-(o.droppedCeiling.width||1300);return console.log("🎯 메인 구간 폭 계산 (DoorSlider):",{totalWidth:t,droppedWidth:o.droppedCeiling.width||1300,mainZoneWidth:F}),F}return t},h=(S,F=!1)=>{var Z;if((Z=o.droppedCeiling)!=null&&Z.enabled){const U=S-50,z=600,q=400,G=Math.ceil(U/z),ie=Math.floor(U/q);return console.log("🎯 슬롯 계산 (단내림 활성화):",{isForDroppedCeiling:F,구간:F?"단내림 구간":"메인 구간",spaceWidth:S,normalAreaInternalWidth:U,minRequiredSlots:G,maxPossibleSlots:ie,maxSlotWidth:z,minSlotWidth:q}),{min:Math.max(1,G),max:Math.max(G,ie),ideal:Math.max(G,Math.round(U/500))}}const E=S-100,V=400,P=Math.max(1,Math.ceil(E/600)),M=Math.min(20,Math.floor(E/V)),X=Math.round(E/a);return{min:P,max:M,ideal:X}},u=((D=o.droppedCeiling)==null?void 0:D.enabled)&&t===(o.droppedCeiling.width||1300);console.log("🔍 슬라이더 타입 확인:",{width:t,droppedWidth:(b=o.droppedCeiling)==null?void 0:b.width,isDroppedCeilingSlider:u,enabled:(_=o.droppedCeiling)==null?void 0:_.enabled});let d;if(u)d=h(t,!0),console.log("🎯 단내림 구간 도어개수 슬라이더:",{width:t,droppedCeilingWidth:(I=o.droppedCeiling)==null?void 0:I.width,doorRange:d,value:n,isDroppedCeilingSlider:u});else{const S=c();d=h(S,!1),console.log("🎯 메인 구간 도어개수 슬라이더:",{mainZoneWidth:S,doorRange:d,value:n,isDroppedCeilingSlider:u})}const f=d.min,A=d.max,g=Math.max(f,Math.min(A,n)),p=S=>A===f?0:(S-f)/(A-f)*100,y=ii.useCallback(S=>{const F=Math.max(0,Math.min(100,S)),B=Math.round(f+F/100*(A-f));return Math.max(f,Math.min(A,B))},[f,A]),v=S=>{if(S.preventDefault(),r(!0),s.current){const F=s.current.getBoundingClientRect(),B=(S.clientX-F.left)/F.width*100,E=y(B);E!==n&&e(E)}},m=ii.useCallback(S=>{if(!i||!s.current)return;const F=s.current.getBoundingClientRect(),B=(S.clientX-F.left)/F.width*100,E=y(B);E!==n&&e(E)},[i,n,e,y]),w=ii.useCallback(()=>{r(!1)},[]);ii.useEffect(()=>{if(i){const S=B=>m(B),F=()=>w();return document.addEventListener("mousemove",S),document.addEventListener("mouseup",F),document.body.style.userSelect="none",()=>{document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",F),document.body.style.userSelect=""}}},[i,m,w]),ii.useEffect(()=>{g!==n&&e(g)},[g,n]),ii.useEffect(()=>{var B;const S=u?t:c(),F=h(S,u);if((B=o.droppedCeiling)!=null&&B.enabled){const V=S-50,P=Math.ceil(V/600);if(n<P){console.log(`🔧 단내림 활성화 시 메인 구간 도어 개수 자동 조정: ${n} → ${P}`),e(P);return}}if(n<F.min||n>F.max){const E=Math.max(F.min,Math.min(F.max,n));e(E)}},[t,n,o.droppedCeiling]);const T=(()=>{const S=A-f+1;if(console.log("🎯 DoorSlider 라벨 생성:",{minDoors:f,maxDoors:A,doorCount:S,clampedValue:g}),S<=8){const F=[];for(let B=f;B<=A;B++)F.push(B);return console.log("🎯 생성된 라벨:",F),F}else{const F=[],B=Math.ceil(S/7);for(let E=f;E<=A;E+=B)E<=A&&F.push(E);return F.length>0&&F[F.length-1]<A&&F.push(A),console.log("🎯 생성된 라벨:",F),F}})(),j=p(g);return console.log("🎯 DoorSlider 렌더링:",{labels:T,sliderPosition:j,clampedValue:g,minDoors:f,maxDoors:A}),l.jsxs("div",{className:p0.doorSlider,children:[l.jsxs("div",{ref:s,className:p0.sliderTrack,onClick:S=>{const F=S.currentTarget.getBoundingClientRect(),B=(S.clientX-F.left)/F.width*100,E=y(B);e(E)},children:[l.jsx("div",{className:p0.sliderActiveTrack,style:{width:`${j}%`,pointerEvents:"none"}}),l.jsx("div",{className:p0.sliderHandle,style:{left:`${j}%`},onMouseDown:S=>{S.stopPropagation(),v(S)}})]}),l.jsx("div",{className:p0.sliderLabels,children:T.map(S=>l.jsx("span",{className:S===g?p0.active:"",onClick:()=>e(S),children:S},S))})]})},sCe="_dropdown_9t4eg_2",oCe="_trigger_9t4eg_9",aCe="_projectName_9t4eg_23",lCe="_arrow_9t4eg_27",cCe="_active_9t4eg_31",hCe="_triggerContent_9t4eg_40",uCe="_rotated_9t4eg_65",dCe="_menu_9t4eg_70",ACe="_menuItem_9t4eg_94",fCe="_itemName_9t4eg_107",pCe="_current_9t4eg_111",gCe="_currentIndicator_9t4eg_131",mCe="_emptyState_9t4eg_146",Zc={dropdown:sCe,trigger:oCe,projectName:aCe,arrow:lCe,active:cCe,triggerContent:hCe,rotated:uCe,menu:dCe,menuItem:ACe,itemName:fCe,current:pCe,currentIndicator:gCe,emptyState:mCe},sG=({projects:n,currentProject:e,onProjectSelect:t})=>{const[i,r]=O.useState(!1),s=O.useRef(null),o=[...n].sort((c,h)=>{var f,A;const u=((f=c.updatedAt)==null?void 0:f.seconds)||0;return(((A=h.updatedAt)==null?void 0:A.seconds)||0)-u});O.useEffect(()=>{const c=h=>{s.current&&!s.current.contains(h.target)&&r(!1)};return i&&document.addEventListener("mousedown",c),()=>{document.removeEventListener("mousedown",c)}},[i]);const a=c=>{t(c),r(!1)};return l.jsxs("div",{className:Zc.dropdown,ref:s,children:[l.jsxs("button",{className:`${Zc.trigger} ${i?Zc.active:""}`,onClick:()=>r(!i),type:"button",children:[l.jsx("div",{className:Zc.triggerContent,children:l.jsx("span",{className:Zc.projectName,children:(e==null?void 0:e.title)||"프로젝트 선택"})}),l.jsx(Ehe,{size:14,className:`${Zc.arrow} ${i?Zc.rotated:""}`})]}),i&&l.jsx("div",{className:Zc.menu,children:o.length>0?o.map(c=>l.jsxs("button",{className:`${Zc.menuItem} ${(e==null?void 0:e.id)===c.id?Zc.current:""}`,onClick:()=>a(c),type:"button",children:[l.jsx("span",{className:Zc.itemName,children:c.title}),(e==null?void 0:e.id)===c.id&&l.jsx("span",{className:Zc.currentIndicator,children:"✓"})]},c.id)):l.jsx("div",{className:Zc.emptyState,children:"프로젝트가 없습니다"})})]})},yCe="_fileTree_1qzs8_1",vCe="_treeHeader_1qzs8_10",wCe="_projectSelectorContainer_1qzs8_16",xCe="_treeContent_1qzs8_20",bCe="_treeItem_1qzs8_63",_Ce="_active_1qzs8_80",CCe="_projectChildren_1qzs8_85",SCe="_childItem_1qzs8_89",TCe="_nestedItem_1qzs8_93",BCe="_folderChildren_1qzs8_97",ECe="_treeItemIcon_1qzs8_101",kCe="_designIcon_1qzs8_119",ICe="_treeItemCount_1qzs8_129",FCe="_treeItemActions_1qzs8_140",DCe="_treeItemActionBtn_1qzs8_149",jCe="_moreMenuBackdrop_1qzs8_171",PCe="_moreMenu_1qzs8_171",NCe="_moreMenuItem_1qzs8_191",LCe="_deleteItem_1qzs8_207",MCe="_modalOverlay_1qzs8_216",RCe="_modal_1qzs8_216",OCe="_modalTitle_1qzs8_238",UCe="_modalInput_1qzs8_245",HCe="_modalActions_1qzs8_262",WCe="_modalCancelBtn_1qzs8_269",QCe="_modalCreateBtn_1qzs8_285",$Ce="_loginPrompt_1qzs8_307",VCe="_loginPromptIcon_1qzs8_316",zCe="_loginPromptText_1qzs8_321",GCe="_loginPromptButton_1qzs8_327",sr={fileTree:yCe,treeHeader:vCe,projectSelectorContainer:wCe,treeContent:xCe,treeItem:bCe,active:_Ce,projectChildren:CCe,childItem:SCe,nestedItem:TCe,folderChildren:BCe,treeItemIcon:ECe,designIcon:kCe,treeItemCount:ICe,treeItemActions:FCe,treeItemActionBtn:DCe,moreMenuBackdrop:jCe,moreMenu:PCe,moreMenuItem:NCe,deleteItem:LCe,modalOverlay:MCe,modal:RCe,modalTitle:OCe,modalInput:UCe,modalActions:HCe,modalCancelBtn:WCe,modalCreateBtn:QCe,loginPrompt:$Ce,loginPromptIcon:VCe,loginPromptText:zCe,loginPromptButton:GCe},XCe=({onFileSelect:n,onProjectSelect:e,onClose:t})=>{const i=xc(),{user:r}=ec(),[s,o]=O.useState([]),[a,c]=O.useState(null),[h,u]=O.useState(null),[d,f]=O.useState({}),[A,g]=O.useState({}),[p,y]=O.useState(new Set),[v,m]=O.useState(new Set),[w,x]=O.useState(null),[T,j]=O.useState(!1),[D,b]=O.useState(""),[_,I]=O.useState(!1);O.useEffect(()=>{(async()=>{if(r){await S();const ie=new URLSearchParams(window.location.search).get("projectId");ie&&(c(ie),y(new Set([ie])))}})()},[r]),O.useEffect(()=>{(async()=>{if(a&&s.length>0){const G=s.find(ie=>ie.id===a);G&&(u(G),await F(a),await B(a))}})()},[a,s,r]);const S=async()=>{if(r)try{const q=await dI(r.uid);if(o(q.projects),q.projects.length>0&&!a){const G=q.projects[0].id;c(G),u(q.projects[0]),y(new Set([G])),console.log("✅ 첫 번째 프로젝트 자동 선택 및 확장:",G)}}catch(q){console.error("프로젝트 로드 에러:",q)}},F=async q=>{if(r)try{const{folders:G,error:ie}=await AI(q);ie?console.error("폴더 데이터 불러오기 에러:",ie):f(H=>({...H,[q]:G||[]}))}catch(G){console.error("폴더 데이터 불러오기 중 오류:",G)}},B=async q=>{var G,ie;if(!r){console.warn("⚠️ 사용자가 로그인되지 않음 - 디자인 파일 로드 건너뛰기");return}try{console.log("🔄 디자인 파일 로드 시작:",{projectId:q,userId:r.uid});const H=await _5(q);if(console.log("🔥 디자인 파일 로드 결과:",{projectId:q,designFilesCount:((G=H.designFiles)==null?void 0:G.length)||0,designFiles:(ie=H.designFiles)==null?void 0:ie.map(se=>({id:se.id,name:se.name})),error:H.error}),H.error){console.error("❌ 디자인 파일 로드 에러:",H.error),g(se=>({...se,[q]:[]}));return}if(H.designFiles&&Array.isArray(H.designFiles)){const se=H.designFiles.filter(te=>te&&te.id&&te.name);g(te=>({...te,[q]:se})),console.log("✅ 디자인 파일 state 업데이트 완료:",{count:se.length,files:se.map(te=>te.name)})}else console.log("⚠️ 디자인 파일이 없거나 비어있음"),g(se=>({...se,[q]:[]}))}catch(H){console.error("❌ 디자인 파일 로드 중 예외 발생:",H),g(se=>({...se,[q]:[]}))}},E=async q=>{const G=new Set(p);G.has(q)?G.delete(q):(G.add(q),K(q),await F(q),await B(q)),y(G)},V=q=>{const G=new Set(v);G.has(q)?G.delete(q):G.add(q),m(G)},K=q=>{c(q);const G=s.find(ie=>ie.id===q);G&&u(G),e&&e(q)},P=(q,G,ie)=>{console.log("🎯 handleDesignFileClick 호출됨:",{projectId:q,designFileId:G,designFileName:ie,hasOnFileSelect:!!n}),n?(console.log("✅ onFileSelect 함수 호출 시작"),n(q,G,ie)):(console.log("🔀 기본 네비게이션 동작"),i(`/configurator?projectId=${q}&designFileId=${G}&designFileName=${encodeURIComponent(ie)}`)),t&&(console.log("🚪 파일트리 닫기"),t())},M=(q,G,ie,H)=>{q.preventDefault(),q.stopPropagation(),x({visible:!0,x:q.clientX,y:q.clientY,itemId:G,itemName:ie,itemType:H})},X=()=>{x(null)},Z=async()=>{if(!(!D.trim()||!a)){I(!0);try{const G={id:`folder_${Date.now()}`,name:D.trim(),type:"folder",children:[],expanded:!1},ie=[...d[a]||[],G];f(H=>({...H,[a]:ie})),await xy(a,ie),j(!1),b("")}catch(q){console.error("폴더 생성 에러:",q),alert("폴더 생성에 실패했습니다.")}finally{I(!1)}}},Q=()=>{j(!1),b("")},U=async()=>{var G;if(!w)return;const q=prompt("새 이름을 입력하세요:",w.itemName);if(!q||q.trim()===w.itemName){X();return}try{if(w.itemType==="folder"&&a){const ie=((G=d[a])==null?void 0:G.map(H=>H.id===w.itemId?{...H,name:q.trim()}:H))||[];f(H=>({...H,[a]:ie})),await xy(a,ie)}else w.itemType==="design"&&(await LQ(w.itemId,{name:q.trim()}),a&&await B(a))}catch(ie){console.error("이름 변경 에러:",ie),alert("이름 변경에 실패했습니다.")}X()},z=async()=>{var G;if(!w)return;const q=w.itemType==="folder"?`정말로 폴더 "${w.itemName}"을(를) 삭제하시겠습니까?

폴더 내의 모든 파일도 함께 삭제됩니다.`:`정말로 파일 "${w.itemName}"을(를) 삭제하시겠습니까?`;if(window.confirm(q))try{if(w.itemType==="folder"&&a){const ie=((G=d[a])==null?void 0:G.filter(H=>H.id!==w.itemId))||[];f(H=>({...H,[a]:ie})),await xy(a,ie)}else w.itemType==="design"&&a&&(await uI(w.itemId,a),await B(a))}catch(ie){console.error("삭제 에러:",ie),alert("삭제에 실패했습니다.")}X()};return l.jsxs("div",{className:sr.fileTree,children:[l.jsx("div",{className:sr.treeHeader,children:l.jsx("div",{className:sr.projectSelectorContainer,children:l.jsx(sG,{projects:s,currentProject:h,onProjectSelect:q=>K(q.id)})})}),l.jsx("div",{className:sr.treeContent,children:r?r&&s.length>0?l.jsx(l.Fragment,{children:s.map(q=>{var G,ie,H;return l.jsxs("div",{children:[l.jsxs("div",{className:`${sr.treeItem} ${a===q.id?sr.active:""}`,onClick:()=>E(q.id),children:[l.jsxs("div",{className:sr.treeItemIcon,children:[l.jsx("span",{style:{display:"inline-block",width:"16px",height:"16px",fontSize:"12px",lineHeight:"16px",textAlign:"center",color:"var(--theme-text-secondary, #666)",fontFamily:"monospace",userSelect:"none"},children:p.has(q.id)?"▼":"▶"}),l.jsx(Fhe,{size:16,color:"#666"})]}),l.jsx("span",{children:q.title}),l.jsx("div",{className:sr.treeItemActions,children:l.jsx("button",{className:sr.treeItemActionBtn,onClick:se=>{se.stopPropagation(),M(se,q.id,q.title,"project")},children:"⋯"})})]}),p.has(q.id)&&l.jsxs("div",{className:sr.projectChildren,children:[console.log("🔥 프로젝트 확장됨:",{projectId:q.id,designFiles:A[q.id],designFilesCount:((G=A[q.id])==null?void 0:G.length)||0,designFilesDetail:(ie=A[q.id])==null?void 0:ie.map(se=>({id:se.id,name:se.name})),folders:((H=d[q.id])==null?void 0:H.length)||0}),(d[q.id]||[]).map(se=>l.jsxs("div",{children:[l.jsxs("div",{className:`${sr.treeItem} ${sr.childItem}`,onClick:()=>V(se.id),children:[l.jsxs("div",{className:sr.treeItemIcon,children:[l.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",fontSize:"11px",lineHeight:"14px",textAlign:"center",color:"var(--theme-text-secondary, #666)",fontFamily:"monospace",userSelect:"none"},children:v.has(se.id)?"▼":"▶"}),l.jsx(E0,{size:16,color:"currentColor"})]}),l.jsx("span",{children:se.name}),l.jsx("span",{className:sr.treeItemCount,children:se.children.length}),l.jsx("div",{className:sr.treeItemActions,children:l.jsx("button",{className:sr.treeItemActionBtn,onClick:te=>{te.stopPropagation(),M(te,se.id,se.name,"folder")},children:"⋯"})})]}),v.has(se.id)&&l.jsx("div",{className:sr.folderChildren,children:se.children.map(te=>l.jsxs("div",{className:`${sr.treeItem} ${sr.childItem} ${sr.nestedItem}`,onClick:()=>P(q.id,te.id,te.name),children:[l.jsx("div",{className:sr.treeItemIcon,children:l.jsx("div",{className:sr.designIcon,children:l.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2.5",children:[l.jsx("path",{d:"M12 19l7-7 3 3-7 7-3-3z"}),l.jsx("path",{d:"M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"}),l.jsx("path",{d:"M2 2l7.586 7.586"}),l.jsx("circle",{cx:"11",cy:"11",r:"2"})]})})}),l.jsx("span",{children:te.name}),l.jsx("div",{className:sr.treeItemActions,children:l.jsx("button",{className:sr.treeItemActionBtn,onClick:fe=>{fe.stopPropagation(),M(fe,te.id,te.name,"design")},children:"⋯"})})]},te.id))})]},se.id)),(A[q.id]||[]).map(se=>l.jsxs("div",{className:`${sr.treeItem} ${sr.childItem}`,onClick:()=>P(q.id,se.id,se.name),children:[l.jsx("div",{className:sr.treeItemIcon,children:l.jsx("div",{className:sr.designIcon,children:l.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2.5",children:[l.jsx("path",{d:"M12 19l7-7 3 3-7 7-3-3z"}),l.jsx("path",{d:"M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"}),l.jsx("path",{d:"M2 2l7.586 7.586"}),l.jsx("circle",{cx:"11",cy:"11",r:"2"})]})})}),l.jsx("span",{children:se.name}),l.jsx("div",{className:sr.treeItemActions,children:l.jsx("button",{className:sr.treeItemActionBtn,onClick:te=>{te.stopPropagation(),M(te,se.id,se.name,"design")},children:"⋯"})})]},se.id))]})]},q.id)})}):r?l.jsx("div",{className:sr.treeItem,children:l.jsx("span",{style:{color:"#999",fontSize:"14px"},children:"프로젝트가 없습니다"})}):l.jsx("div",{className:sr.treeItem,children:l.jsx("span",{style:{color:"#999",fontSize:"14px"},children:"로그인이 필요합니다"})}):l.jsxs("div",{className:sr.loginPrompt,children:[l.jsx("div",{className:sr.loginPromptIcon,children:l.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[l.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),l.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),l.jsx("p",{className:sr.loginPromptText,children:"로그인이 필요합니다"}),l.jsx("button",{className:sr.loginPromptButton,onClick:()=>i("/login"),children:"로그인하기"})]})}),w&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:sr.moreMenuBackdrop,onClick:X}),l.jsxs("div",{className:sr.moreMenu,style:{position:"fixed",top:w.y,left:w.x},children:[l.jsx("div",{className:sr.moreMenuItem,onClick:U,children:"이름 바꾸기"}),l.jsx("div",{className:`${sr.moreMenuItem} ${sr.deleteItem}`,onClick:z,children:"삭제하기"})]})]}),T&&l.jsx("div",{className:sr.modalOverlay,children:l.jsxs("div",{className:sr.modal,children:[l.jsx("h2",{className:sr.modalTitle,children:"새 폴더 생성"}),l.jsx("input",{type:"text",value:D,onChange:q=>b(q.target.value),placeholder:"폴더 이름을 입력하세요",className:sr.modalInput,onKeyPress:q=>{q.key==="Enter"&&D.trim()&&Z()},autoFocus:!0}),l.jsxs("div",{className:sr.modalActions,children:[l.jsx("button",{onClick:Q,disabled:_,className:sr.modalCancelBtn,children:"취소"}),l.jsx("button",{onClick:Z,disabled:!D.trim()||_,className:sr.modalCreateBtn,children:_?"생성 중...":"생성"})]})]})})]})},KCe="_container_jqsyd_1",qCe="_tabMenu_jqsyd_8",YCe="_tab_jqsyd_8",ZCe="_activeTab_jqsyd_62",JCe="_thumbnailGrid_jqsyd_74",e5e="_thumbnailItem_jqsyd_82",t5e="_selected_jqsyd_129",n5e="_disabled_jqsyd_141",i5e="_thumbnailImage_jqsyd_158",r5e="_disabledOverlay_jqsyd_174",s5e="_emptyMessage_jqsyd_193",uc={container:KCe,tabMenu:qCe,tab:YCe,activeTab:ZCe,thumbnailGrid:JCe,thumbnailItem:e5e,selected:t5e,disabled:n5e,thumbnailImage:i5e,disabledOverlay:r5e,emptyMessage:s5e},o5e=()=>{const[n,e]=O.useState(!1),[t,i]=O.useState(""),[r,s]=O.useState("알림"),o=O.useCallback((h,u)=>{i(h),u!=null&&u.title&&s(u.title),e(!0)},[]),a=O.useCallback(()=>{e(!1)},[]);return{showAlert:o,hideAlert:a,AlertComponent:()=>{const h=document.getElementById("modal-root");return h?$C.createPortal(l.jsx(vQ,{isOpen:n,message:t,title:r,onClose:a}),h):null}}},Fh=n=>{const e=`/250709in/images/furniture-thumbnails/${n}`;return console.log(`🖼️ [썸네일 경로] ${n} → ${e}`),e},tf={"single-2drawer-hanging":Fh("single-2drawer-hanging.png"),"single-2hanging":Fh("single-2hanging.png"),"single-4drawer-hanging":Fh("single-4drawer-hanging.png"),"dual-2drawer-hanging":Fh("dual-2drawer-hanging.png"),"dual-2hanging":Fh("dual-2hanging.png"),"dual-4drawer-hanging":Fh("dual-4drawer-hanging.png"),"dual-2drawer-styler":Fh("dual-2drawer-styler.png"),"dual-4drawer-pantshanger":Fh("dual-4drawer-pantshanger.png"),"upper-cabinet-shelf":Fh("upper-cabinet-shelf.png"),"upper-cabinet-open":Fh("upper-cabinet-open.png"),"upper-cabinet-mixed":Fh("upper-cabinet-mixed.png")},a5e=({module:n,iconPath:e,isValid:t})=>{const{spaceInfo:i}=qi(),r=ci(T=>T.placedModules),s=ci(T=>T.addModule),o=ci(T=>T.setFurniturePlacementMode),a=ci(T=>T.setCurrentDragData),c=ci(T=>T.selectedFurnitureId),h=ci(T=>T.setSelectedFurnitureId),{showAlert:u,AlertComponent:d}=o5e(),{activeDroppedCeilingTab:f,setIsSlotDragging:A}=Bi(),g=ii.useRef(null),p=ii.useRef(!1);ii.useEffect(()=>()=>{g.current&&clearTimeout(g.current)},[]);const y=T=>{var S;if(!t){T.preventDefault();return}o(!0),A(!0);const j=ur(i);let D="normal";const b={...n.dimensions};let _=n.id;if((S=i.droppedCeiling)!=null&&S.enabled){D=f==="dropped"?"dropped":"normal";const F=wr.calculateZoneSlotInfo(i,i.customColumnCount);if(D==="dropped"&&F.dropped){const B=F.dropped.slotWidths||[],E=F.dropped.columnWidth;if((n.id.includes("dual-2drawer-styler")||n.id.includes("dual-4drawer-pantshanger"))&&B.length>=2&&B[0]+B[1]<694){u("단내림 구간의 슬롯갯수를 줄여주세요",{title:"배치 불가"}),T.preventDefault();return}if(n.isDynamic){const K=n.dimensions.width>E*1.5;B.length>0?K&&B.length>=2?b.width=B[0]+B[1]:b.width=B[0]:b.width=K?E*2:E,_=`${n.id.replace(/-\d+$/,"")}-${Math.round(b.width)}`}}else if(D==="normal"&&F.normal){const B=F.normal.slotWidths||[],E=F.normal.columnWidth;if((n.id.includes("dual-2drawer-styler")||n.id.includes("dual-4drawer-pantshanger"))&&B.length>=2&&B[0]+B[1]<694){u("메인 구간의 슬롯갯수를 줄여주세요",{title:"배치 불가"}),T.preventDefault();return}if(n.isDynamic){const K=n.dimensions.width>E*1.5;B.length>0?K&&B.length>=2?b.width=B[0]+B[1]:b.width=B[0]:b.width=K?E*2:E,_=`${n.id.replace(/-\d+$/,"")}-${Math.round(b.width)}`}}}else{if(n.id.includes("dual-2drawer-styler")||n.id.includes("dual-4drawer-pantshanger")){if(j.columnCount<2){u("듀얼 가구를 배치하려면 최소 2개의 슬롯이 필요합니다",{title:"배치 불가"}),T.preventDefault();return}if(j.columnWidth*2<694){u("슬롯갯수를 줄여주세요",{title:"배치 불가"}),T.preventDefault();return}}if(n.isDynamic){const E=n.id.startsWith("dual-")?j.columnWidth*2:j.columnWidth;_=`${n.id.replace(/-\d+$/,"")}-${Math.round(E)}`,b.width=E}}const I={type:"furniture",zone:D,moduleData:{id:_,name:n.name,dimensions:b,originalDimensions:n.dimensions,type:n.type||"default",color:n.color,hasDoor:n.hasDoor||!1,isDynamic:n.isDynamic,furnType:n.id.includes("dual-")?"dual":"single"}};T.dataTransfer.setData("application/json",JSON.stringify(I)),T.dataTransfer.setData("text/plain",n.id),T.dataTransfer.effectAllowed="copy",console.log("🎯 [ModuleGallery] Drag started:",{originalModuleId:n.id,dragModuleId:_,dragData:I,zone:D,adjustedWidth:b.width,isDynamic:n.isDynamic}),a(I)},v=()=>{console.log("🎯 [ModuleGallery] Drag ended"),o(!1),A(!1),setTimeout(()=>{a(null)},100)},m=()=>{if(t){if(p.current){p.current=!1;return}if(g.current){clearTimeout(g.current),g.current=null;return}g.current=setTimeout(()=>{var _;if(g.current=null,p.current){p.current=!1;return}if(c===n.id){h(null),o(!1),a(null);return}ur(i);let T="normal";const j={...n.dimensions};let D=n.id;if((_=i.droppedCeiling)!=null&&_.enabled){T=f==="dropped"?"dropped":"normal";const I=wr.calculateZoneSlotInfo(i,i.customColumnCount);if(T==="dropped"&&I.dropped){const S=I.dropped.slotWidths||[],F=I.dropped.columnWidth;if((n.id.includes("dual-2drawer-styler")||n.id.includes("dual-4drawer-pantshanger"))&&S.length>=2&&S[0]+S[1]<694){u("단내림 구간의 슬롯갯수를 줄여주세요",{title:"배치 불가"});return}if(n.isDynamic){const E=n.dimensions.width>F*1.5;if(S.length>0){if(E&&S.length>=2){const V=S[0]+S[1];D=`${n.id.replace(/-\d+$/,"")}-${Math.round(V)}`,j.width=V}else if(!E&&S.length>0){const V=S[0];D=`${n.id.replace(/-\d+$/,"")}-${Math.round(V)}`,j.width=V}}}}}h(n.id),o(!0);const b={type:"furniture",zone:T,moduleData:{id:D,name:n.name,dimensions:j,originalDimensions:n.dimensions,type:n.type||"default",color:n.color,hasDoor:n.hasDoor||!1,isDynamic:n.isDynamic,furnType:n.id.includes("dual-")?"dual":"single"}};a(b),console.log("🎯 [ModuleGallery] Click & Place activated:",{moduleId:n.id,adjustedId:D,zone:T,data:b})},300)}},w=()=>{var T,j;if(console.log("🚨🚨🚨 [ModuleGallery] Double click event triggered!",{moduleId:n.id,isValid:t}),p.current=!0,!t){console.log("❌ Module is not valid, exiting");return}g.current&&(clearTimeout(g.current),g.current=null),h(null),o(!1),a(null),console.log("🚨 [ModuleGallery] Double click processing:",{moduleId:n.id,moduleWidth:n.dimensions.width,activeZone:f,droppedCeilingEnabled:(T=i.droppedCeiling)==null?void 0:T.enabled,spaceInfo:{width:i.width,customColumnCount:i.customColumnCount,columnMode:i.columnMode}});try{let D;const b=i,_=kr(i),I=ur(b),S=_;if(console.log("🚨 [ModuleGallery] Using full space:",{fullSpaceInfo:{width:b.width,customColumnCount:b.customColumnCount},indexing:{columnWidth:I.columnWidth,columnCount:I.columnCount}}),n.id.includes("dual-2drawer-styler")||n.id.includes("dual-4drawer-pantshanger")){if(I.columnCount<2){u("듀얼 가구를 배치하려면 최소 2개의 슬롯이 필요합니다",{title:"배치 불가"});return}if(I.columnWidth*2<694){u("슬롯갯수를 줄여주세요",{title:"배치 불가"});return}}const B=n.isDynamic||n.id.includes("single-")||n.id.includes("dual-");let E=n.dimensions.width;B&&(E=n.id.startsWith("dual-")?I.columnWidth*2:I.columnWidth),console.log("🎯 [ModuleGallery] Dynamic width calculation:",{targetZone:D,originalId:n.id,originalWidth:n.dimensions.width,isDynamicFurniture:B,actualWidth:E,indexingColumnWidth:I.columnWidth}),console.log("🎯 [ModuleGallery] Using original module with dynamic width:",{moduleId:n.id,originalWidth:n.dimensions.width,actualWidth:E,expectedColumnWidth:I.columnWidth});const V=n.id.startsWith("dual-");console.log("🔍 [ModuleGallery] Checking slot availability:",{totalSlots:I.columnCount,isDualFurniture:V,placedModulesCount:r.length,placedModules:r.map(G=>({id:G.id,slotIndex:G.slotIndex,zone:G.zone}))});let K=-1;for(let G=0;G<I.columnCount;G++){const ie=sv(G,V,r,b,n.id);if(console.log(`🔍 Slot ${G}: ${ie?"✅ Available":"❌ Occupied"}`),ie){K=G;break}}if(K===-1&&(console.log("🔍 No slot found in first pass, trying findNextAvailableSlot..."),K=Wp(0,"right",V,r,b,n.id)||-1),console.log("🎯 Final availableSlotIndex:",K),K===-1){console.warn("❌ 사용 가능한 슬롯이 없습니다.");return}let P;V&&I.threeUnitDualPositions?P=I.threeUnitDualPositions[K]:P=I.threeUnitPositions[K],console.log("🎯 [ModuleGallery] Position calculation:",{activeZone:f,positionX:P,availableSlotIndex:K,isDualFurniture:V,indexingInfo:{columnCount:I.columnCount,columnWidth:I.columnWidth,internalStartX:I.internalStartX,threeUnitPositions:I.threeUnitPositions}});const M=G=>{if(G!=null&&G.defaultDepth)return Math.min(G.defaultDepth,i.depth);const ie=Math.floor(i.depth*.9);return Math.min(ie,580)},X=`placed-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;let Z,Q=n.id;V&&I.slotWidths&&I.slotWidths[K]!==void 0?(Z=I.slotWidths[K]+(I.slotWidths[K+1]||I.slotWidths[K]),Q=`${n.id.replace(/-\d+$/,"")}-${Z}`):I.slotWidths&&I.slotWidths[K]!==void 0?(Z=I.slotWidths[K],Q=`${n.id.replace(/-\d+$/,"")}-${Z}`):Z=I.columnWidth,console.log("🎯 [ModuleGallery] Target module ID with exact width:",{originalId:n.id,targetModuleId:Q,customWidth:Z,isDualFurniture:V,slotIndex:K,slotWidths:I.slotWidths});let U=K;if((j=i.droppedCeiling)!=null&&j.enabled){const G=wr.calculateZoneSlotInfo(i,i.customColumnCount);G.dropped&&K>=G.normal.columnCount?(D="dropped",U=K-G.normal.columnCount):(D="normal",U=K)}const z={id:X,moduleId:Q,baseModuleType:n.id.replace(/-\d+$/,""),moduleWidth:n.dimensions.width,position:{x:P,y:0,z:0},rotation:0,hasDoor:!1,customDepth:M(n),slotIndex:U,isDualSlot:V,isValidInCurrentSpace:!0,hingePosition:"right",zone:D||void 0,customWidth:Z};if(console.log("🚨 [ModuleGallery] New module created:",{moduleId:n.id,originalWidth:n.dimensions.width,customWidth:Z,expectedColumnWidth:I.columnWidth,position:z.position,zone:D,slotIndex:U}),console.log("🎯 [ModuleGallery] About to add module:",{...z,addModuleFunction:typeof s,addModuleDefined:s!==void 0,currentPlacedModulesCount:r.length}),!s){console.error("❌❌❌ addModule function is not defined!");return}try{console.log("🎯 Calling addModule with:",JSON.stringify(z)),s(z),console.log("✅ [ModuleGallery] Module added successfully");const G=ci.getState().placedModules;console.log("📦 Updated placedModules count:",G.length),console.log("📦 Updated placedModules:",G.map(ie=>({id:ie.id,moduleId:ie.moduleId,slotIndex:ie.slotIndex,zone:ie.zone})))}catch(G){throw console.error("❌ [ModuleGallery] Failed to add module:",G),G}const q=ci.getState().setSelectedPlacedModuleId;q(X),console.log(`✅ 가구 "${n.name}"을 슬롯 ${U+1}에 자동 배치했습니다.`,{moduleId:n.id,globalSlotIndex:K,localSlotIndex:U,zone:D,position:z.position,isDual:V,selectedId:X})}catch(D){console.error("🚨🚨🚨 [ModuleGallery] 가구 자동 배치 중 오류 발생:",D),console.error("Error details:",{moduleId:n.id,activeZone:f,spaceInfo:i,error:D})}finally{setTimeout(()=>{p.current=!1},100)}},x=n.category==="upper"||n.category==="lower";return l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:`${uc.thumbnailItem} ${t?"":uc.disabled} ${c===n.id?uc.selected:""}`,draggable:t,onDragStart:y,onDragEnd:v,onClick:m,onDoubleClick:w,title:t?`클릭하여 선택 또는 드래그하여 배치: ${n.name}`:"현재 공간에 배치할 수 없습니다",children:[l.jsx("div",{className:uc.thumbnailImage,children:x?l.jsxs("div",{style:{width:"100%",height:"100%",backgroundColor:n.color||"#8B7355",borderRadius:"4px",border:"2px solid rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative"},children:[l.jsx("div",{style:{fontSize:"24px",opacity:.7},children:n.category==="upper"?"⬆️":"⬇️"}),l.jsx("div",{style:{fontSize:"12px",marginTop:"4px",opacity:.8},children:n.category==="upper"?"상부장":"하부장"})]}):l.jsx("img",{src:e,alt:n.name,onError:T=>{const j=T.target;j.dataset.fallbackAttempted||(j.dataset.fallbackAttempted="true",j.src=Fh("single-2drawer-hanging.png"))}})}),!t&&l.jsx("div",{className:uc.disabledOverlay})]}),l.jsx(d,{})]})},l5e=({moduleCategory:n="tall"})=>{var v;const{t:e}=Eo(),[t,i]=O.useState("all"),{spaceInfo:r}=qi(),{activeDroppedCeilingTab:s}=Bi();let o=r,a=kr(r);if((v=r.droppedCeiling)!=null&&v.enabled&&s==="dropped"){const m=wr.calculateZoneSlotInfo(r,r.customColumnCount);m.dropped&&(o={...r,width:m.dropped.width,customColumnCount:m.dropped.columnCount,columnMode:"custom",zone:"dropped"},a=kr(o))}const c=ur(o);c.columnWidth;let h=[];n==="upper"?(h=WS("upper",a,o),console.log("🎯 상부장 모듈 로드:",{count:h.length,modules:h.map(m=>({id:m.id,name:m.name,category:m.category}))})):n==="lower"?(h=WS("lower",a,o),console.log("🎯 하부장 모듈 로드:",{count:h.length,modules:h.map(m=>({id:m.id,name:m.name,category:m.category}))})):h=WS("full",a,o);const u=h;console.log("🔍 [ModuleGallery] Debug info:",{activeDroppedCeilingTab:s,originalSpaceInfo:{width:r.width,customColumnCount:r.customColumnCount,columnMode:r.columnMode,droppedCeiling:r.droppedCeiling},zoneSpaceInfo:{width:o.width,customColumnCount:o.customColumnCount,zone:o.zone},internalSpace:a,indexing:{columnWidth:c.columnWidth,columnCount:c.columnCount,slotWidths:c.slotWidths},fullModules:u.map(m=>({id:m.id,width:m.dimensions.width}))}),s==="dropped"&&console.log("🚨🚨🚨 단내림 구간 갤러리:",{zoneSlotWidths:c.slotWidths,zoneColumnWidth:c.columnWidth,expectedWidths:c.slotWidths?[...new Set(c.slotWidths)]:[],actualModuleWidths:u.map(m=>m.dimensions.width).filter((m,w,x)=>x.indexOf(m)===w)});const{singleModules:d,dualModules:f}=O.useMemo(()=>c.columnCount<=1?{singleModules:u,dualModules:[]}:u.reduce((m,w)=>(w.id.includes("dual-")?m.dualModules.push(w):m.singleModules.push(w),m),{singleModules:[],dualModules:[]}),[u,c.columnCount]),A=O.useMemo(()=>{const m=t==="all"?[...d,...f]:t==="single"?d:f;return console.log("🎯 [ModuleGallery] Current modules:",{selectedType:t,moduleCount:m.length,modules:m.map(w=>({id:w.id,width:w.dimensions.width,baseId:w.id.replace(/-\d+$/,"")}))}),m},[t,d,f,n,a,o]),g=m=>{const w=m.replace(/-\d+$/,"");if(w.includes("upper-cabinet")){if(w.includes("shelf"))return tf["upper-cabinet-shelf"]||tf["single-2hanging"];if(w.includes("open"))return tf["upper-cabinet-open"]||tf["single-2hanging"];if(w.includes("mixed"))return tf["upper-cabinet-mixed"]||tf["single-2drawer-hanging"]}return tf[w]||tf["single-2drawer-hanging"]},p=m=>{const w=m.id.includes("dual-");if(s==="dropped"&&w){const x=wr.calculateZoneSlotInfo(r,r.customColumnCount);if(x.dropped)return x.dropped.columnCount>=2&&m.dimensions.height<=a.height&&m.dimensions.depth<=a.depth}return m.dimensions.width<=a.width&&m.dimensions.height<=a.height&&m.dimensions.depth<=a.depth},y=(...m)=>m.filter(Boolean).join(" ");return l.jsxs("div",{className:uc.container,children:[l.jsxs("div",{className:uc.tabMenu,children:[l.jsxs("button",{className:y(uc.tab,t==="all"&&uc.activeTab),onClick:()=>i("all"),children:[e("furniture.all")," (",n==="upperlower"?0:d.length+f.length,")"]}),l.jsxs("button",{className:y(uc.tab,t==="single"&&uc.activeTab),onClick:()=>i("single"),children:[e("furniture.single")," (",n==="upperlower"?0:d.length,")"]}),l.jsxs("button",{className:y(uc.tab,t==="dual"&&uc.activeTab),onClick:()=>i("dual"),children:[e("furniture.dual")," (",n==="upperlower"?0:f.length,")"]})]}),l.jsx("div",{className:uc.thumbnailGrid,children:A.length>0?A.map(m=>{const w=g(m.id),x=p(m);return l.jsx(a5e,{module:m,iconPath:w,isValid:x},m.id)}):l.jsx("div",{className:uc.emptyMessage,children:n==="upperlower"?`${upperLowerTab==="lower"?e("furniture.lowerCabinet"):e("furniture.upperCabinet")} ${e("furniture.moduleNotReady")}`:e("furniture.noModulesAvailable")})})]})},c5e="_overlay_41smn_1",h5e="_panel_41smn_14",u5e="_header_41smn_26",d5e="_title_41smn_35",A5e="_closeButton_41smn_42",f5e="_content_41smn_62",p5e="_moduleInfo_41smn_68",g5e="_modulePreview_41smn_74",m5e="_moduleBox_41smn_86",y5e="_moduleDetails_41smn_93",v5e="_moduleName_41smn_97",w5e="_property_41smn_104",x5e="_propertyLabel_41smn_114",b5e="_propertyValue_41smn_122",_5e="_placeholder_41smn_129",Qs={overlay:c5e,panel:h5e,header:u5e,title:d5e,closeButton:A5e,content:f5e,moduleInfo:p5e,modulePreview:g5e,moduleBox:m5e,moduleDetails:y5e,moduleName:v5e,property:w5e,propertyLabel:x5e,propertyValue:b5e,placeholder:_5e},C5e=()=>{const{spaceInfo:n}=qi(),{activePopup:e,closeAllPopups:t}=Bi();if(e.type!=="furniture"||!e.id)return null;const i=kr(n),r=Hi(e.id,i,n);if(!r)return null;const s=()=>{t()},o=a=>{a.target===a.currentTarget&&s()};return l.jsx("div",{className:Qs.overlay,onClick:o,children:l.jsxs("div",{className:Qs.panel,children:[l.jsxs("div",{className:Qs.header,children:[l.jsx("h3",{className:Qs.title}),l.jsx("button",{className:Qs.closeButton,onClick:s,children:"✕"})]}),l.jsxs("div",{className:Qs.content,children:[l.jsxs("div",{className:Qs.moduleInfo,children:[l.jsx("div",{className:Qs.modulePreview,children:l.jsx("div",{className:Qs.moduleBox,style:{backgroundColor:r.color,aspectRatio:`${r.dimensions.width} / ${r.dimensions.height}`}})}),l.jsxs("div",{className:Qs.moduleDetails,children:[l.jsx("h4",{className:Qs.moduleName,children:r.name}),l.jsxs("div",{className:Qs.property,children:[l.jsx("span",{className:Qs.propertyLabel,children:"크기:"}),l.jsxs("span",{className:Qs.propertyValue,children:[r.dimensions.width," × ",r.dimensions.height," × ",r.dimensions.depth,"mm"]})]}),l.jsxs("div",{className:Qs.property,children:[l.jsx("span",{className:Qs.propertyLabel,children:"타입:"}),l.jsx("span",{className:Qs.propertyValue,children:r.type||"기본"})]}),l.jsxs("div",{className:Qs.property,children:[l.jsx("span",{className:Qs.propertyLabel,children:"도어:"}),l.jsx("span",{className:Qs.propertyValue,children:r.hasDoor?"있음":"없음"})]}),r.description&&l.jsxs("div",{className:Qs.property,children:[l.jsx("span",{className:Qs.propertyLabel}),l.jsx("span",{className:Qs.propertyValue,children:r.description})]}),r.isDynamic&&l.jsxs("div",{className:Qs.property,children:[l.jsx("span",{className:Qs.propertyLabel,children:"맞춤형:"}),l.jsx("span",{className:Qs.propertyValue,children:"예"})]})]})]}),l.jsx("div",{className:Qs.placeholder,children:l.jsx("p",{children:"추가 속성 설정은 곧 추가될 예정입니다."})})]})]})})},S5e="_overlay_jqqu0_1",T5e="_panel_jqqu0_15",B5e="_header_jqqu0_38",E5e="_title_jqqu0_48",k5e="_headerButtons_jqqu0_55",I5e="_deleteButton_jqqu0_61",F5e="_content_jqqu0_82",D5e="_closeButton_jqqu0_118",j5e="_moduleInfo_jqqu0_143",P5e="_modulePreview_jqqu0_152",N5e="_moduleImage_jqqu0_166",L5e="_detailsButton_jqqu0_174",M5e="_detailsSection_jqqu0_199",R5e="_panelList_jqqu0_207",O5e="_panelSectionHeader_jqqu0_214",U5e="_panelItem_jqqu0_227",H5e="_panelName_jqqu0_240",W5e="_panelSize_jqqu0_246",Q5e="_moduleBox_jqqu0_252",$5e="_moduleDetails_jqqu0_259",V5e="_moduleName_jqqu0_263",z5e="_property_jqqu0_270",G5e="_propertyValue_jqqu0_288",X5e="_propertySection_jqqu0_295",K5e="_sectionTitle_jqqu0_303",q5e="_depthInputWrapper_jqqu0_313",Y5e="_inputWithUnit_jqqu0_319",Z5e="_depthInput_jqqu0_313",J5e="_inputError_jqqu0_356",eSe="_unit_jqqu0_361",tSe="_errorMessage_jqqu0_369",nSe="_depthRange_jqqu0_375",iSe="_doorTabSelector_jqqu0_382",rSe="_doorTab_jqqu0_382",sSe="_activeDoorTab_jqqu0_407",oSe="_hingeTabSelector_jqqu0_426",aSe="_hingeTab_jqqu0_426",lSe="_activeHingeTab_jqqu0_453",cSe="_hingeTabSubtitle_jqqu0_459",hSe="_coverDoorNote_jqqu0_470",uSe="_backPanelDisabledNote_jqqu0_480",dSe="_warningOverlay_jqqu0_492",ASe="_warningModal_jqqu0_506",fSe="_warningIcon_jqqu0_515",pSe="_warningMessage_jqqu0_520",gSe="_warningCloseButton_jqqu0_527",mSe="_hingeSubSection_jqqu0_644",ySe="_subSectionTitle_jqqu0_648",vSe="_confirmButtons_jqqu0_674",wSe="_cancelButton_jqqu0_682",xSe="_confirmButton_jqqu0_674",On={overlay:S5e,panel:T5e,header:B5e,title:E5e,headerButtons:k5e,deleteButton:I5e,content:F5e,closeButton:D5e,moduleInfo:j5e,modulePreview:P5e,moduleImage:N5e,detailsButton:L5e,detailsSection:M5e,panelList:R5e,panelSectionHeader:O5e,panelItem:U5e,panelName:H5e,panelSize:W5e,moduleBox:Q5e,moduleDetails:$5e,moduleName:V5e,property:z5e,propertyValue:G5e,propertySection:X5e,sectionTitle:K5e,depthInputWrapper:q5e,inputWithUnit:Y5e,depthInput:Z5e,inputError:J5e,unit:eSe,errorMessage:tSe,depthRange:nSe,doorTabSelector:iSe,doorTab:rSe,activeDoorTab:sSe,hingeTabSelector:oSe,hingeTab:aSe,activeHingeTab:lSe,hingeTabSubtitle:cSe,coverDoorNote:hSe,backPanelDisabledNote:uSe,warningOverlay:dSe,warningModal:ASe,warningIcon:fSe,warningMessage:pSe,warningCloseButton:gSe,hingeSubSection:mSe,subSectionTitle:ySe,confirmButtons:vSe,cancelButton:wSe,confirmButton:xSe},nf=n=>`/250709in/images/furniture-thumbnails/${n}`,TM={"single-2drawer-hanging":nf("single-2drawer-hanging.png"),"single-2hanging":nf("single-2hanging.png"),"single-4drawer-hanging":nf("single-4drawer-hanging.png"),"dual-2drawer-hanging":nf("dual-2drawer-hanging.png"),"dual-2hanging":nf("dual-2hanging.png"),"dual-4drawer-hanging":nf("dual-4drawer-hanging.png"),"dual-2drawer-styler":nf("dual-2drawer-styler.png"),"dual-4drawer-pantshanger":nf("dual-4drawer-pantshanger.png")},bSe=n=>{const e=n.replace(/-\d+$/,"");return TM[e]||TM["single-2drawer-hanging"]},_Se=(n,e,t,i=!1,r=s=>s)=>{var g,p,y;const s={common:[],upper:[],lower:[],door:[]},o=((g=n.modelConfig)==null?void 0:g.basicThickness)||18,a=9,c=18,h=5,u=n.dimensions.height,d=e-o*2;let f;if(n.id.includes("dual-4drawer-pantshanger")||n.id.includes("dual-2drawer-styler")?f=((p=n.modelConfig)==null?void 0:p.leftSections)||[]:f=((y=n.modelConfig)==null?void 0:y.sections)||[],f&&f.length>0){const v=u-o*2,m=(b,_)=>(b.heightType||"percentage")==="absolute"?Math.min(b.height||0,_):_*((b.height||b.heightRatio||100)/100),x=f.filter(b=>b.heightType==="absolute").reduce((b,_)=>b+m(_,v),0),j=(f.length>1?f.length-1:0)*o,D=v-x-j;f.length>1&&n.id.includes("2hanging")?s.common.push({name:"안전선반 (칸막이)",width:d,depth:t-a-17,thickness:o,material:"PB"}):f.length>1&&s.common.push({name:"중간 칸막이",width:d,depth:t-a-17,thickness:o,material:"PB"}),f.forEach((b,_)=>{let I="",S=null;if(n.id.includes("2hanging"))_===0?(I="하부장",S=s.lower):(I="상부장",S=s.upper);else if(n.id.includes("dual-4drawer-pantshanger")||n.id.includes("dual-2drawer-styler"))b.type==="drawer"?(I="하부장 (좌측)",S=s.lower):b.type==="hanging"&&(I="상부장 (좌측)",S=s.upper);else if(b.type==="drawer")I="하부장",S=s.lower;else if(b.type==="hanging")I="상부장",S=s.upper;else{const B=_===0;I=B?"상부장":"하부장",S=B?s.upper:s.lower}const F=b.heightType==="absolute"?m(b,v):m(b,D);if(S.push({name:`${I} ${r("furniture.leftPanel")}`,width:t,height:Math.round(F),thickness:o,material:"PB"}),S.push({name:`${I} ${r("furniture.rightPanel")}`,width:t,height:Math.round(F),thickness:o,material:"PB"}),_===f.length-1&&S.push({name:`${I} ${r("furniture.topPanel")}`,width:d,depth:t,thickness:o,material:"PB"}),_===0?S.push({name:`${I} ${r("furniture.bottomPanel")}`,width:d,depth:t,thickness:o,material:"PB"}):S.push({name:`${I} ${r("furniture.bottomPanel")}`,width:d,depth:t-a-17,thickness:o,material:"PB"}),S.push({name:`${I} ${r("furniture.backPanel")}`,width:d+10,height:Math.round(F)+10,thickness:a,material:"MDF"}),b.type==="drawer"&&b.count){const B=b.drawerHeights||[];b.gapHeight;for(let E=0;E<b.count;E++){const V=E+1;let K;B&&B[E]?K=B[E]:K=Math.floor((F-o*(b.count-1))/b.count),S.push({name:`${I} ${r("furniture.drawer")}${V} ${r("furniture.handlePlate")}`,width:e,height:K,thickness:c,material:"PET"});const P=e-76,M=K-30,X=t-47-c;S.push({name:`${I} ${r("furniture.drawer")}${V} ${r("furniture.frontPanel")}`,width:P,height:M,thickness:o,material:"PB"}),S.push({name:`${I} ${r("furniture.drawer")}${V} ${r("furniture.backPanel")}`,width:P,height:M,thickness:o,material:"PB"}),S.push({name:`${I} ${r("furniture.drawer")}${V} ${r("furniture.leftPanel")}`,depth:X-o*2,height:M,thickness:o,material:"PB"}),S.push({name:`${I} ${r("furniture.drawer")}${V} ${r("furniture.rightPanel")}`,depth:X-o*2,height:M,thickness:o,material:"PB"}),S.push({name:`${I} ${r("furniture.drawer")}${V} ${r("furniture.bottomPanel")}`,width:P-26,depth:X-26,thickness:h,material:"MDF"})}for(let E=1;E<b.count;E++)S.push({name:`${I} ${r("furniture.drawerDivider")} ${E}`,width:d,depth:t-a-17,thickness:o,material:"PB"})}else if(b.type==="hanging")if(b.shelfPositions&&b.shelfPositions.length>0)b.shelfPositions.forEach((B,E)=>{S.push({name:`${I} 선반 ${E+1}`,width:d,depth:t-8,thickness:o,material:"PB"})});else{const B=Math.round(F);S.push({name:`${I} 옷걸이 공간`,description:"내부 높이",height:B,isInfo:!0})}else if(b.type==="shelf"&&b.count)for(let B=1;B<=b.count;B++)S.push({name:`${I} 선반 ${B}`,width:d,depth:t-8,thickness:o,material:"PB"});else if(b.type==="open"){const B=Math.round(F);S.push({name:`${I} 오픈 공간`,description:"내부 높이",height:B,isInfo:!0})}})}if(i)if(n.id.includes("dual")){const m=Math.floor((e-6)/2);s.door.push({name:"좌측 도어",width:m,height:u-4,thickness:o,material:"PET"}),s.door.push({name:"우측 도어",width:m,height:u-4,thickness:o,material:"PET"})}else s.door.push({name:"도어",width:e-4,height:u-4,thickness:o,material:"PET"});const A=[];return s.upper.length>0&&(A.push({name:`=== ${r("furniture.upperSection")} ===`}),A.push(...s.upper)),s.common.length>0&&A.push(...s.common),s.lower.length>0&&(A.push({name:`=== ${r("furniture.lowerSection")} ===`}),A.push(...s.lower)),s.door.length>0&&i&&(A.push({name:`=== ${r("furniture.door")} ===`}),A.push(...s.door)),A},CSe=()=>{const{t:n}=Eo(),[e,t]=O.useState(!1);O.useEffect(()=>{const Y=document.createElement("style");return Y.textContent=`
      /* 모든 테마에서 input 필드는 항상 흰 배경에 검은 텍스트 */
      .furniture-depth-input,
      input.furniture-depth-input,
      .${On.depthInput},
      .${On.panel} input[type="text"],
      .${On.panel} input[type="number"],
      .${On.depthInputWrapper} input,
      .${On.inputWithUnit} input {
        color: #000000 !important;
        -webkit-text-fill-color: #000000 !important;
        background-color: #ffffff !important;
        opacity: 1 !important;
        caret-color: #000000 !important;
      }
      .furniture-depth-input:focus,
      input.furniture-depth-input:focus,
      .${On.depthInput}:focus,
      .${On.panel} input[type="text"]:focus,
      .${On.panel} input[type="number"]:focus,
      .${On.depthInputWrapper} input:focus,
      .${On.inputWithUnit} input:focus {
        color: #000000 !important;
        -webkit-text-fill-color: #000000 !important;
        background-color: #ffffff !important;
      }
      /* 모든 상태에서 적용 */
      .${On.depthInput}:hover,
      .${On.depthInput}:active,
      .${On.depthInput}:disabled,
      .${On.depthInput}::placeholder {
        color: #000000 !important;
        -webkit-text-fill-color: #000000 !important;
      }
      /* 다크 테마 클래스가 있는 경우 */
      .theme-dark .furniture-depth-input,
      .theme-dark input.furniture-depth-input,
      .theme-dark .${On.depthInput},
      .theme-dark .${On.panel} input,
      body.theme-dark .${On.depthInput},
      html.theme-dark .${On.depthInput} {
        color: #000000 !important;
        -webkit-text-fill-color: #000000 !important;
        background-color: #ffffff !important;
      }
    `,document.head.appendChild(Y),Y.setAttribute("data-furniture-panel-styles","true"),()=>{Y.parentNode&&document.head.removeChild(Y)}},[]);const{spaceInfo:i}=qi(),r=ci(Y=>Y.placedModules),s=ci(Y=>Y.updatePlacedModule),o=ci(Y=>Y.removeModule),{activePopup:a,closeAllPopups:c}=Bi(),[h,u]=O.useState(580),[d,f]=O.useState("580"),[A,g]=O.useState(""),[p,y]=O.useState(583),[v,m]=O.useState("583"),[w,x]=O.useState(""),[T,j]=O.useState("right"),[D,b]=O.useState(!1),[_,I]=O.useState(!1),[S,F]=O.useState(!1);O.useEffect(()=>{const Y=ve=>{if(console.log("🔑 키 입력 감지:",ve.key,"activePopup.type:",a.type,"showWarning:",S),S){(ve.key==="Enter"||ve.key==="Escape")&&(ve.preventDefault(),F(!1),console.log("✅ 경고창 닫기"));return}if(a.type==="furnitureEdit")if(ve.key==="Enter"){const ce=document.activeElement;console.log("🎯 액티브 요소:",ce==null?void 0:ce.tagName,ce),(ce==null?void 0:ce.tagName)!=="INPUT"&&(ve.preventDefault(),console.log("✅ 엔터키로 팝업 닫기"),c())}else ve.key==="Escape"&&(ve.preventDefault(),console.log("✅ ESC키로 팝업 닫기"),c())};return document.addEventListener("keydown",Y),console.log("🎯 키 이벤트 리스너 등록"),()=>{document.removeEventListener("keydown",Y),console.log("🎯 키 이벤트 리스너 제거")}},[a.type,S,c]);const B=O.useCallback(Y=>{if(Y!=null&&Y.defaultDepth)return Math.min(Y.defaultDepth,i.depth);const ve=Math.floor(i.depth*.9);return Math.min(ve,xp.DEPTH.DEFAULT_FALLBACK)},[i.depth]),E=a.type==="furnitureEdit"&&a.id?r.find(Y=>Y.id===a.id):null,V=ii.useMemo(()=>{if(!E||E.slotIndex===void 0)return!1;const Y=kr(i),ve=Hi(E.moduleId,Y,i);if(!ve)return!1;const ce=ve.category==="upper"||E.moduleId.includes("upper-cabinet"),ne=ve.category==="lower"||E.moduleId.includes("lower-cabinet");return!ce&&!ne?!1:r.some(he=>{if(he.id===E.id||he.slotIndex!==E.slotIndex)return!1;const xe=Hi(he.moduleId,Y,i);if(!xe)return!1;const Te=xe.category==="upper"||he.moduleId.includes("upper-cabinet"),Ce=xe.category==="lower"||he.moduleId.includes("lower-cabinet");return!!(ce&&Ce&&he.hasGapBackPanel||ne&&Te&&he.hasGapBackPanel)})},[E,r,i]),K=E?(()=>{let Y=E.moduleId;return E.customWidth&&(Y=`${E.moduleId.replace(/-\d+$/,"")}-${E.customWidth}`),Hi(Y,kr(i),i)})():null,{slotInfo:P,isCoverDoor:M,isColumnC:X}=ii.useMemo(()=>{if(!E||!K)return{slotInfo:null,isCoverDoor:!1,isColumnC:!1};let Y=null;if(E.slotIndex!==void 0)Y=Rc(i)[E.slotIndex];else{const ne=Rc(i),xe=ur(i).threeUnitPositions.findIndex(Te=>Math.abs(Te-E.position.x)<.1);xe>=0&&(Y=ne[xe])}const ve=(Y==null?void 0:Y.hasColumn)||!1,ce=(Y==null?void 0:Y.columnType)==="medium"&&(Y==null?void 0:Y.allowMultipleFurniture)||!1;return{slotInfo:Y,isCoverDoor:ve,isColumnC:ce}},[E,K,i]);if(O.useEffect(()=>{if(E&&K){const Y=E.customDepth!==void 0&&E.customDepth!==null?E.customDepth:B(K),ve=E.customWidth!==void 0&&E.customWidth!==null?E.customWidth:K.dimensions.width;u(Y),f(Y.toString()),y(ve),m(ve.toString()),j(E.hingePosition||"right"),b(E.hasDoor??K.hasDoor??!1),I(E.hasGapBackPanel??!1),console.log("🔧 팝업 초기값 설정:",{moduleId:E.moduleId,hasCustomDepth:E.customDepth!==void 0&&E.customDepth!==null,customDepth:E.customDepth,defaultDepth:B(K),finalDepth:Y,hasCustomWidth:E.customWidth!==void 0&&E.customWidth!==null,customWidth:E.customWidth,defaultWidth:K.dimensions.width,finalWidth:ve})}},[E==null?void 0:E.id,K==null?void 0:K.id]),a.type!=="furnitureEdit"||!a.id)return console.log("📝 PlacedModulePropertiesPanel 렌더링 안 함:",{type:a.type,id:a.id}),null;console.log("📝 PlacedModulePropertiesPanel 렌더링됨:",{type:a.type,id:a.id});const Q=!(K?K.id.startsWith("dual-"):!1);if(!E||!K)return null;const U=()=>{c()},z=()=>{a.id&&(o(a.id),c())},q=Y=>{u(Y),a.id&&s(a.id,{customDepth:Y})},G=Y=>{var ve;if(y(Y),a.id){const ce={customWidth:Y,isSplit:!0};E.customDepth!==void 0&&(ce.customDepth=E.customDepth),s(a.id,ce),console.log("📏 가구 너비 조정:",{originalWidth:K.dimensions.width,newWidth:Y,columnPosition:(ve=P==null?void 0:P.column)==null?void 0:ve.position,customDepth:E.customDepth})}},ie=Y=>{(Y===""||/^\d+$/.test(Y))&&(f(Y),g(""))},H=()=>{const Y=d;if(Y===""){f(h.toString());return}const ve=parseInt(Y),ce=xp.DEPTH.MIN,ne=Math.min(i.depth,xp.DEPTH.MAX);ve<ce?g(n("furniture.minValue",{value:ce})):ve>ne?g(n("furniture.maxValue",{value:ne})):(g(""),q(ve))},se=Y=>{Y.key==="Enter"&&H()},te=Y=>{(Y===""||/^\d+$/.test(Y))&&(m(Y),x(""))},fe=()=>{const Y=v;if(Y===""){m(p.toString());return}const ve=parseInt(Y),ce=150,ne=K.dimensions.width;ve<ce?x(n("furniture.minValue",{value:ce})):ve>ne?x(n("furniture.maxValue",{value:ne})):(x(""),G(ve))},ye=Y=>{Y.key==="Enter"&&fe()},be=Y=>{if(M){F(!0),setTimeout(()=>F(!1),3e3);return}j(Y),a.id&&s(a.id,{hingePosition:Y})},_e=Y=>{b(Y),a.id&&s(a.id,{hasDoor:Y})},W=Y=>{I(Y),a.id&&s(a.id,{hasGapBackPanel:Y})};return l.jsxs("div",{className:On.overlay,children:[l.jsxs("div",{className:On.panel,children:[l.jsxs("div",{className:On.header,children:[l.jsx("h3",{className:On.title,children:n("furniture.editFurniture")}),l.jsx("div",{className:On.headerButtons,children:l.jsx("button",{className:On.closeButton,onClick:U,children:"✕"})})]}),l.jsxs("div",{className:On.content,children:[l.jsxs("div",{className:On.moduleInfo,children:[l.jsx("div",{className:On.modulePreview,children:l.jsx("img",{src:bSe(K.id),alt:K.name,className:On.moduleImage,onError:Y=>{const ve=Y.target;ve.style.display="none";const ce=ve.parentElement;ce&&(ce.innerHTML=`<div 
                      class="${On.moduleBox}"
                      style="
                        background-color: ${K.color};
                        aspect-ratio: ${K.dimensions.width} / ${K.dimensions.height}
                      "
                    ></div>`)}})}),l.jsxs("div",{className:On.moduleDetails,children:[l.jsx("h4",{className:On.moduleName,children:p&&p!==K.dimensions.width?K.name.replace(/\d+mm/,`${p}mm`):K.name}),l.jsx("div",{className:On.property,children:l.jsxs("span",{className:On.propertyValue,children:[p," × ",K.dimensions.height," × ",h,"mm"]})})]}),l.jsx("button",{className:On.detailsButton,onClick:()=>t(!e),children:n("furniture.viewDetails")})]}),e&&l.jsxs("div",{className:On.detailsSection,children:[l.jsx("h5",{className:On.sectionTitle,children:n("furniture.panelDetails")}),l.jsx("div",{className:On.panelList,children:_Se(K,p,h,D,n).map((Y,ve)=>Y.name&&Y.name.startsWith("===")?l.jsx("div",{className:On.panelSectionHeader,children:l.jsx("strong",{children:Y.name.replace(/=/g,"").trim()})},ve):Y.isInfo?l.jsxs("div",{className:On.panelItem,children:[l.jsxs("span",{className:On.panelName,children:[Y.name,":"]}),l.jsx("span",{className:On.panelSize,children:Y.description&&Y.height?`${Y.description} ${Y.height}mm`:Y.description||""})]},ve):l.jsxs("div",{className:On.panelItem,children:[l.jsxs("span",{className:On.panelName,children:[Y.name,":"]}),l.jsxs("span",{className:On.panelSize,children:[Y.diameter?`Φ${Y.diameter}mm × L${Y.width}mm`:Y.width&&Y.height?`${Y.width} × ${Y.height}mm`:Y.width&&Y.depth?`${Y.width} × ${Y.depth}mm`:Y.height&&Y.depth?`${Y.height} × ${Y.depth}mm`:Y.description?Y.description:`${Y.width||Y.height||Y.depth}mm`,Y.thickness&&!Y.diameter&&` (T:${Y.thickness})`,Y.material&&` [${Y.material}]`]})]},ve))})]}),X&&l.jsxs("div",{className:On.propertySection,children:[l.jsx("h5",{className:On.sectionTitle,children:n("furniture.widthSettings")}),l.jsxs("div",{className:On.depthInputWrapper,children:[l.jsxs("div",{className:On.inputWithUnit,children:[l.jsx("input",{type:"number",value:v,onChange:Y=>te(Y.target.value),onBlur:fe,onKeyDown:ye,className:`${On.depthInput} furniture-depth-input ${w?On.inputError:""}`,placeholder:`150-${K.dimensions.width}`,style:{color:"#000000",backgroundColor:"#ffffff",WebkitTextFillColor:"#000000",opacity:1}}),l.jsx("span",{className:On.unit,children:"mm"})]}),w&&l.jsx("div",{className:On.errorMessage,children:w}),l.jsxs("div",{className:On.depthRange,children:[n("furniture.range"),": 150mm ~ ",K.dimensions.width,"mm"]})]})]}),l.jsxs("div",{className:On.propertySection,children:[l.jsx("h5",{className:On.sectionTitle,children:n("furniture.depthSettings")}),l.jsxs("div",{className:On.depthInputWrapper,children:[l.jsxs("div",{className:On.inputWithUnit,children:[l.jsx("input",{type:"number",value:d,onChange:Y=>ie(Y.target.value),onBlur:H,onKeyDown:se,className:`${On.depthInput} furniture-depth-input ${A?On.inputError:""}`,placeholder:`${xp.DEPTH.MIN}-${xp.DEPTH.MAX}`,style:{color:"#000000",backgroundColor:"#ffffff",WebkitTextFillColor:"#000000",opacity:1}}),l.jsx("span",{className:On.unit,children:"mm"})]}),A&&l.jsx("div",{className:On.errorMessage,children:A}),l.jsxs("div",{className:On.depthRange,children:[n("furniture.range"),": ",xp.DEPTH.MIN,"mm ~ ",Math.min(i.depth,xp.DEPTH.MAX),"mm"]})]})]}),K.hasDoor&&l.jsxs("div",{className:On.propertySection,children:[l.jsx("h5",{className:On.sectionTitle,children:n("furniture.doorSettings")}),l.jsxs("div",{className:On.doorTabSelector,children:[l.jsx("button",{className:`${On.doorTab} ${D?"":On.activeDoorTab}`,onClick:()=>_e(!1),children:n("common.none")}),l.jsx("button",{className:`${On.doorTab} ${D?On.activeDoorTab:""}`,onClick:()=>_e(!0),children:n("common.enabled")})]}),D&&Q&&l.jsxs("div",{className:On.hingeSubSection,children:[l.jsx("h6",{className:On.subSectionTitle,children:n("furniture.hingeDirection")}),l.jsxs("div",{className:On.hingeTabSelector,children:[l.jsxs("button",{className:`${On.hingeTab} ${T==="left"?On.activeHingeTab:""}`,onClick:()=>be("left"),children:[n("furniture.left"),l.jsx("span",{className:On.hingeTabSubtitle,children:n("furniture.openToRight")})]}),l.jsxs("button",{className:`${On.hingeTab} ${T==="right"?On.activeHingeTab:""}`,onClick:()=>be("right"),children:[n("furniture.right"),l.jsx("span",{className:On.hingeTabSubtitle,children:n("furniture.openToLeft")})]})]}),M&&l.jsx("div",{className:On.coverDoorNote,children:n("furniture.coverDoorNote")})]})]}),(K.category==="upper"||K.category==="lower")&&l.jsxs("div",{className:On.propertySection,children:[l.jsx("h5",{className:On.sectionTitle,children:n("furniture.gapBackPanelSettings")}),V?l.jsx("div",{className:On.backPanelDisabledNote,children:n("furniture.backPanelAlreadySet",{position:K.category==="upper"?n("furniture.lowerCabinet"):n("furniture.upperCabinet")})}):l.jsxs("div",{className:On.doorTabSelector,children:[l.jsx("button",{className:`${On.doorTab} ${_?"":On.activeDoorTab}`,onClick:()=>W(!1),children:n("common.none")}),l.jsx("button",{className:`${On.doorTab} ${_?On.activeDoorTab:""}`,onClick:()=>W(!0),children:n("common.enabled")})]})]}),l.jsxs("button",{className:On.deleteButton,onClick:z,children:[l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[l.jsx("polyline",{points:"3 6 5 6 21 6"}),l.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),l.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),l.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),n("common.delete")]}),l.jsxs("div",{className:On.confirmButtons,children:[l.jsx("button",{className:On.cancelButton,onClick:U,children:n("common.cancel")}),l.jsx("button",{className:On.confirmButton,onClick:U,children:n("common.confirm")})]})]})]}),S&&l.jsx("div",{className:On.warningOverlay,children:l.jsxs("div",{className:On.warningModal,children:[l.jsx("div",{className:On.warningIcon,children:"⚠️"}),l.jsx("div",{className:On.warningMessage,children:n("furniture.coverDoorNote")}),l.jsx("button",{className:On.warningCloseButton,onClick:()=>F(!1),children:n("common.confirm")})]})})]})},SSe="_container_15agz_1",TSe="_tabNavigation_15agz_22",BSe="_tab_15agz_22",ESe="_activeTab_15agz_59",kSe="_tabLabel_15agz_73",ISe="_content_15agz_79",FSe="_tabContent_15agz_85",DSe="_materialWheelContainer_15agz_90",jSe="_materialWheel_15agz_90",PSe="_materialWheelSvg_15agz_102",NSe="_materialSegment_15agz_107",LSe="_colorSection_15agz_119",MSe="_colorSectionTitle_15agz_125",RSe="_colorWheel_15agz_133",OSe="_colorWheelGradient_15agz_146",USe="_colorWheelCenter_15agz_168",HSe="_hoverPointer_15agz_177",WSe="_colorSelector_15agz_190",QSe="_opacitySection_15agz_201",$Se="_opacityHeader_15agz_205",VSe="_opacityLabel_15agz_211",zSe="_opacityValue_15agz_217",GSe="_opacitySliderContainer_15agz_223",XSe="_opacitySliderBackground_15agz_228",KSe="_opacitySlider_15agz_223",qSe="_opacityHandle_15agz_246",YSe="_hexSection_15agz_265",ZSe="_hexPreview_15agz_272",JSe="_hexInputContainer_15agz_281",e3e="_hexPrefix_15agz_286",t3e="_hexInput_15agz_281",n3e="_savedColorsSection_15agz_321",i3e="_savedColorsHeader_15agz_325",r3e="_savedColorsLabel_15agz_332",s3e="_savedColorsHint_15agz_338",o3e="_savedColorsGrid_15agz_343",a3e="_savedColorButton_15agz_353",l3e="_selectedSavedColor_15agz_373",c3e="_selectedSavedColorIndicator_15agz_380",h3e="_savedColorRemove_15agz_393",u3e="_savedColorRemoveButton_15agz_417",d3e="_addColorButton_15agz_438",A3e="_addColorButtonText_15agz_458",cr={container:SSe,tabNavigation:TSe,tab:BSe,activeTab:ESe,tabLabel:kSe,content:ISe,tabContent:FSe,materialWheelContainer:DSe,materialWheel:jSe,materialWheelSvg:PSe,materialSegment:NSe,colorSection:LSe,colorSectionTitle:MSe,colorWheel:RSe,colorWheelGradient:OSe,colorWheelCenter:USe,hoverPointer:HSe,colorSelector:WSe,opacitySection:QSe,opacityHeader:$Se,opacityLabel:VSe,opacityValue:zSe,opacitySliderContainer:GSe,opacitySliderBackground:XSe,opacitySlider:KSe,opacityHandle:qSe,hexSection:YSe,hexPreview:ZSe,hexInputContainer:JSe,hexPrefix:e3e,hexInput:t3e,savedColorsSection:n3e,savedColorsHeader:i3e,savedColorsLabel:r3e,savedColorsHint:s3e,savedColorsGrid:o3e,savedColorButton:a3e,selectedSavedColor:l3e,selectedSavedColorIndicator:c3e,savedColorRemove:h3e,savedColorRemoveButton:u3e,addColorButton:d3e,addColorButtonText:A3e},Y4=(...n)=>n.filter(Boolean).join(" "),BM=[{id:"o1",name:"Cream",color:"#f5f5f0",position:1,isInner:!1},{id:"o2",name:"Light Beige",color:"#d8d3c0",position:2,isInner:!1},{id:"o3",name:"Beige",color:"#d5c6ad",position:3,isInner:!1},{id:"o4",name:"Tan",color:"#c8b89b",position:4,isInner:!1},{id:"o5",name:"Terracotta",color:"#b15f4c",position:5,isInner:!1},{id:"o6",name:"Slate Blue",color:"#6a869c",position:6,isInner:!1},{id:"o7",name:"Light Sage",color:"#b9bea7",position:7,isInner:!1},{id:"o8",name:"Olive",color:"#697a50",position:8,isInner:!1},{id:"o9",name:"Sage",color:"#a3a78c",position:9,isInner:!1},{id:"o10",name:"Charcoal",color:"#4b4b4b",position:10,isInner:!1},{id:"o11",name:"Black",color:"#212121",position:11,isInner:!1},{id:"o12",name:"Dark Gray",color:"#706e6c",position:12,isInner:!1},{id:"o13",name:"Gray",color:"#a4a4a4",position:13,isInner:!1},{id:"o14",name:"MDF",color:"#e9e5dc",position:14,isInner:!1},{id:"o15",name:"Light Gray",color:"#d3d3d3",position:15,isInner:!1},{id:"i1",name:"Dark Walnut",color:"#43302e",position:1,isInner:!0,texture:"wood"},{id:"i2",name:"Black Oak",color:"#211f1c",position:2,isInner:!0,texture:"wood"},{id:"i3",name:"Walnut",color:"#755541",position:3,isInner:!0,texture:"wood"},{id:"i4",name:"Medium Oak",color:"#b28968",position:4,isInner:!0,texture:"wood"},{id:"i5",name:"Natural Oak",color:"#c7ae7f",position:5,isInner:!0,texture:"wood"},{id:"i6",name:"Light Oak",color:"#d4bd94",position:6,isInner:!0,texture:"wood"},{id:"i7",name:"Cherry",color:"#6e4239",position:7,isInner:!0,texture:"wood"},{id:"i8",name:"Cabinet Texture1",color:"#FFFFFF",position:8,isInner:!0,texture:"image",image:"/materials/solid/cabinet texture1.jpeg"}],f3e=()=>{const{t:n}=Eo(),[e,t]=O.useState("interior"),[i,r]=O.useState("Light Oak"),[s,o]=O.useState("#FFFFFF"),[a,c]=O.useState(50),[h,u]=O.useState([{id:"1",hex:"#FF5252"},{id:"2",hex:"#7C4DFF"},{id:"3",hex:"#40C4FF"},{id:"4",hex:"#69F0AE"},{id:"5",hex:"#FFFF00"}]),[d,f]=O.useState(!1),[A,g]=O.useState(null),p=O.useRef(null),y=O.useRef(null),v=O.useRef(null),{spaceInfo:m,setSpaceInfo:w}=qi(),x=m.materialConfig||{interiorColor:"#FFFFFF",doorColor:"#E0E0E0"},{doorsOpen:T,toggleDoors:j}=Bi(),b=ci(se=>se.placedModules).some(se=>se.hasDoor);e==="interior"?x.interiorColor:x.doorColor;const _=se=>{const fe={...x,[e==="interior"?"interiorColor":"doorColor"]:se};w({materialConfig:fe})},I=se=>{se.stopPropagation()},S=se=>{if(p.current){se.stopPropagation();const te=p.current.getBoundingClientRect(),fe=te.width/2,ye=te.height/2,be=se.clientX-te.left,_e=se.clientY-te.top,W=be-fe,Y=_e-ye,ve=Math.sqrt(W*W+Y*Y),ce=Math.min(te.width,te.height)/2;let ne=be,he=_e;if(ve>ce){const Re=ce/ve;ne=fe+W*Re,he=ye+Y*Re}const xe=ne/te.width*100,Te=he/te.height*100,Ce=ne-fe,Be=he-ye;let Ye=Math.atan2(Be,Ce)*(180/Math.PI);Ye<0&&(Ye+=360);const $e=Math.sqrt(Ce*Ce+Be*Be),ot=Math.min($e/ce,1)*100,rt=10,We=90-rt,De=rt+We*a/100,Ge=q(Ye,ot,De);if(Ge!==s){o(Ge);const Re=document.getElementById("color-selector");Re&&(Re.style.left=`${xe}%`,Re.style.top=`${Te}%`),g(null),v.current&&clearTimeout(v.current),v.current=setTimeout(()=>{_(Ge),v.current=null},300)}}},F=se=>{se.stopPropagation(),f(!0),S(se)},B=se=>{se.stopPropagation(),d&&S(se)},E=se=>{se.stopPropagation(),f(!1)},V=se=>{if(se.stopPropagation(),p.current&&!d){const te=p.current.getBoundingClientRect(),fe=te.width/2,ye=te.height/2,be=se.clientX-te.left,_e=se.clientY-te.top,W=be-fe,Y=_e-ye,ve=Math.sqrt(W*W+Y*Y),ce=Math.min(te.width,te.height)/2;if(ve<=ce){let ne=Math.atan2(Y,W)*(180/Math.PI);ne<0&&(ne+=360);const he=Math.min(ve/ce,1)*100,xe=10,Ce=90-xe,Be=xe+Ce*a/100,Ye=q(ne,he,Be),$e=be/te.width*100,ot=_e/te.height*100;g({color:Ye,x:$e,y:ot})}else g(null)}},K=se=>{se.stopPropagation(),g(null)},P=se=>{const te=parseInt(se.target.value);if(c(te),s){const{h:fe,s:ye}=z(s),be=10,W=90-be,Y=be+W*te/100,ve=q(fe,ye,Y);o(ve),_(ve)}},M=se=>{let te=se.target.value.toUpperCase();if(te.startsWith("#")||(te="#"+te),/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(te)){o(te);const{h:ye,s:be,l:_e}=z(te);if(c(Math.round((_e-10)/80*100)),p.current){const W=Math.min(p.current.offsetWidth,p.current.offsetHeight)/2,Y=be/100*W,ve=ye*Math.PI/180,ce=W,ne=W,he=ce+Y*Math.cos(ve),xe=ne+Y*Math.sin(ve),Te=he/(W*2)*100,Ce=xe/(W*2)*100,Be=document.getElementById("color-selector");Be&&(Be.style.left=`${Te}%`,Be.style.top=`${Ce}%`)}_(te)}},X=(se,te,fe)=>{if(r(se),(fe==null?void 0:fe.texture)==="image"&&(fe!=null&&fe.image))if(se==="Cabinet Texture1"){const ye={...x,interiorColor:te,doorColor:te,interiorTexture:fe.image,doorTexture:fe.image};console.log("🎨 Cabinet Texture1 선택 - 도어와 캐비넷 모두 적용:",{interiorTexture:fe.image,doorTexture:fe.image,color:te}),w({materialConfig:ye})}else{const ye=e==="interior"?"interiorTexture":"doorTexture",be={...x,[e==="interior"?"interiorColor":"doorColor"]:te,[ye]:fe.image};w({materialConfig:be})}else{const ye=e==="interior"?"interiorTexture":"doorTexture",be={...x,[e==="interior"?"interiorColor":"doorColor"]:te,[ye]:void 0};w({materialConfig:be})}},Z=()=>{const se={id:`${h.length+1}`,hex:s};u([...h,se])},Q=se=>{u(h.filter(te=>te.id!==se))},U=se=>{o(se),_(se)},z=se=>{const te=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(se);if(!te)return{h:0,s:0,l:0};const fe=parseInt(te[1],16)/255,ye=parseInt(te[2],16)/255,be=parseInt(te[3],16)/255,_e=Math.max(fe,ye,be),W=Math.min(fe,ye,be);let Y,ve,ce=(_e+W)/2;if(_e===W)Y=ve=0;else{const ne=_e-W;switch(ve=ce>.5?ne/(2-_e-W):ne/(_e+W),_e){case fe:Y=(ye-be)/ne+(ye<be?6:0);break;case ye:Y=(be-fe)/ne+2;break;case be:Y=(fe-ye)/ne+4;break;default:Y=0}Y*=60}return{h:Y,s:ve*100,l:ce*100}},q=(se,te,fe)=>{se=se%360,te=Math.max(0,Math.min(100,te))/100,fe=Math.max(0,Math.min(100,fe))/100;const ye=(1-Math.abs(2*fe-1))*te,be=ye*(1-Math.abs(se/60%2-1)),_e=fe-ye/2;let W,Y,ve;return se>=0&&se<60?[W,Y,ve]=[ye,be,0]:se>=60&&se<120?[W,Y,ve]=[be,ye,0]:se>=120&&se<180?[W,Y,ve]=[0,ye,be]:se>=180&&se<240?[W,Y,ve]=[0,be,ye]:se>=240&&se<300?[W,Y,ve]=[be,0,ye]:[W,Y,ve]=[ye,0,be],W=Math.round((W+_e)*255),Y=Math.round((Y+_e)*255),ve=Math.round((ve+_e)*255),`#${W.toString(16).padStart(2,"0")}${Y.toString(16).padStart(2,"0")}${ve.toString(16).padStart(2,"0")}`.toUpperCase()},G=se=>i===se;O.useEffect(()=>{const se=()=>{f(!1)};return window.addEventListener("mouseup",se),()=>{window.removeEventListener("mouseup",se)}},[]);const ie=BM.filter(se=>!se.isInner),H=BM.filter(se=>se.isInner);return l.jsxs("div",{className:cr.container,children:[l.jsxs("div",{className:cr.tabNavigation,children:[l.jsx("button",{className:Y4(cr.tab,e==="interior"&&cr.activeTab),onClick:()=>{t("interior"),b&&!T&&j()},children:l.jsx("span",{className:cr.tabLabel,children:n("material.interior")})}),l.jsx("button",{className:Y4(cr.tab,e==="door"&&cr.activeTab),onClick:()=>{t("door"),b&&T&&j()},children:l.jsx("span",{className:cr.tabLabel,children:n("material.door")})})]}),l.jsx("div",{className:cr.content,children:l.jsxs("div",{className:cr.tabContent,children:[l.jsx("div",{className:cr.materialWheelContainer,children:l.jsx("div",{ref:y,className:cr.materialWheel,onClick:I,children:l.jsxs("svg",{viewBox:"0 0 100 100",className:cr.materialWheelSvg,onClick:se=>se.stopPropagation(),children:[l.jsxs("defs",{children:[ie.map(se=>l.jsx("pattern",{id:`pattern-${se.id}`,patternUnits:"userSpaceOnUse",width:"10",height:"10",patternTransform:"rotate(45)",children:l.jsx("rect",{width:"10",height:"10",fill:se.color})},`pattern-${se.id}`)),H.map(se=>l.jsxs("pattern",{id:`pattern-${se.id}`,patternUnits:"userSpaceOnUse",width:"10",height:"10",patternTransform:"rotate(45)",children:[se.texture==="image"&&se.image?l.jsx("image",{href:se.image,width:"10",height:"10",preserveAspectRatio:"xMidYMid slice"}):l.jsx("rect",{width:"10",height:"10",fill:se.color}),se.texture==="wood"&&l.jsxs(l.Fragment,{children:[l.jsx("line",{x1:"0",y1:"5",x2:"10",y2:"5",stroke:"rgba(0,0,0,0.1)",strokeWidth:"1"}),l.jsx("line",{x1:"5",y1:"0",x2:"5",y2:"10",stroke:"rgba(0,0,0,0.05)",strokeWidth:"0.5"})]})]},`pattern-${se.id}`))]}),ie.map((se,te)=>{const fe=360/ie.length,ye=te*fe-90,be=ye+fe,_e=ye*Math.PI/180,W=be*Math.PI/180,Y=50+45*Math.cos(_e),ve=50+45*Math.sin(_e),ce=50+45*Math.cos(W),ne=50+45*Math.sin(W),he=50+30*Math.cos(W),xe=50+30*Math.sin(W),Te=50+30*Math.cos(_e),Ce=50+30*Math.sin(_e),Be=fe>180?1:0;return l.jsx("path",{d:`M ${Y},${ve} A 45,45 0 ${Be},1 ${ce},${ne} L ${he},${xe} A 30,30 0 ${Be},0 ${Te},${Ce} Z`,fill:se.color,stroke:G(se.name)?"#1abc9c":"white",strokeWidth:G(se.name)?"2":"0.5",style:{cursor:"pointer"},className:cr.materialSegment,onClick:Ye=>{Ye.stopPropagation(),X(se.name,se.color,se)}},se.id)}),H.map((se,te)=>{const fe=360/H.length,ye=te*fe-90,be=ye+fe,_e=ye*Math.PI/180,W=be*Math.PI/180,Y=50+30*Math.cos(_e),ve=50+30*Math.sin(_e),ce=50+30*Math.cos(W),ne=50+30*Math.sin(W),he=50,xe=50,Te=fe>180?1:0;return l.jsx("path",{d:`M ${Y},${ve} A 30,30 0 ${Te},1 ${ce},${ne} L ${he},${xe} Z`,fill:se.texture==="image"?`url(#pattern-${se.id})`:se.color,stroke:G(se.name)?"#1abc9c":"white",strokeWidth:G(se.name)?"2":"0.5",style:{cursor:"pointer"},className:cr.materialSegment,onClick:Ce=>{Ce.stopPropagation(),X(se.name,se.color,se)}},se.id)}),l.jsx("circle",{cx:"50",cy:"50",r:"15",fill:"white",stroke:"#e5e5e5",strokeWidth:"1"}),l.jsx("text",{x:"50",y:"50",textAnchor:"middle",dominantBaseline:"middle",fill:"#333",fontSize:"5",fontWeight:"500",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},lengthAdjust:"spacingAndGlyphs",textLength:"26",children:i})]})})}),l.jsxs("div",{className:cr.colorSection,children:[l.jsx("div",{className:cr.colorSectionTitle,children:n("material.colorPicker")}),l.jsxs("div",{ref:p,id:"color-wheel",className:cr.colorWheel,onClick:S,onMouseDown:F,onMouseMove:se=>{B(se),V(se)},onMouseOver:V,onMouseLeave:K,onMouseUp:E,children:[l.jsx("div",{className:cr.colorWheelGradient}),l.jsx("div",{className:cr.colorWheelCenter}),A&&!d&&l.jsx("div",{className:cr.hoverPointer,style:{left:`${A.x}%`,top:`${A.y}%`,backgroundColor:A.color}}),l.jsx("div",{id:"color-selector",className:cr.colorSelector,style:{left:"75%",top:"65%",backgroundColor:s}})]}),l.jsxs("div",{className:cr.opacitySection,children:[l.jsxs("div",{className:cr.opacityHeader,children:[l.jsx("span",{className:cr.opacityLabel,children:n("material.brightnessAdjust")}),l.jsxs("span",{className:cr.opacityValue,children:[a,"%"]})]}),l.jsxs("div",{className:cr.opacitySliderContainer,children:[l.jsx("div",{className:cr.opacitySliderBackground,style:{background:`linear-gradient(to right, 
                      ${q(z(s).h,z(s).s,10)}, 
                      ${q(z(s).h,z(s).s,50)}, 
                      ${q(z(s).h,z(s).s,90)})`}}),l.jsx("input",{type:"range",min:"0",max:"100",value:a,onChange:P,className:cr.opacitySlider}),l.jsx("div",{className:cr.opacityHandle,style:{left:`calc(${a}% - 8px)`}})]})]}),l.jsxs("div",{className:cr.hexSection,children:[l.jsx("div",{className:cr.hexPreview,style:{backgroundColor:s}}),l.jsxs("div",{className:cr.hexInputContainer,children:[l.jsx("span",{className:cr.hexPrefix,children:"#"}),l.jsx("input",{type:"text",value:s.replace("#",""),onChange:M,className:cr.hexInput,maxLength:6,placeholder:"RRGGBB"})]})]}),l.jsxs("div",{className:cr.savedColorsSection,children:[l.jsxs("div",{className:cr.savedColorsHeader,children:[l.jsx("span",{className:cr.savedColorsLabel,children:n("material.savedColors")}),l.jsx("span",{className:cr.savedColorsHint,children:n("material.addColorHint")})]}),l.jsxs("div",{className:cr.savedColorsGrid,children:[h.map(se=>l.jsxs("div",{className:Y4(cr.savedColorButton,s===se.hex&&cr.selectedSavedColor),style:{backgroundColor:se.hex},onClick:()=>U(se.hex),children:[s===se.hex&&l.jsx("div",{className:cr.selectedSavedColorIndicator}),l.jsx("div",{className:cr.savedColorRemove,children:l.jsx("button",{className:cr.savedColorRemoveButton,onClick:te=>{te.stopPropagation(),Q(se.id)},children:"×"})})]},se.id)),l.jsx("div",{className:cr.addColorButton,onClick:Z,children:l.jsx("span",{className:cr.addColorButtonText,children:"+"})})]})]})]})]})})]})},p3e="_columnThumbnailWrapper_1lymg_1",g3e="_columnThumbnail_1lymg_1",m3e="_columnImage_1lymg_35",y3e="_columnLabel_1lymg_52",eb={columnThumbnailWrapper:p3e,columnThumbnail:g3e,columnImage:m3e,columnLabel:y3e},g0=({width:n=1200,height:e=2400,depth:t=1200,color:i="#888888",material:r="concrete",onDragStart:s,onDoubleClick:o,title:a="기둥"})=>{const c=d=>{const f={type:"column",width:n,height:e,depth:t,color:i,material:r};d.dataTransfer.setData("application/json",JSON.stringify(f)),d.dataTransfer.effectAllowed="copy",s==null||s(d)},h=()=>{const d={type:"column",width:n,height:e,depth:t,color:i,material:r};o==null||o(d)},u=()=>"/images/column.png";return l.jsxs("div",{className:eb.columnThumbnailWrapper,children:[l.jsx("div",{className:eb.columnThumbnail,draggable:!0,onDragStart:c,onDoubleClick:h,title:`${a} - ${r} (${n}×${t}×${e}mm)`,children:l.jsx("img",{src:u(),alt:`${a} - ${r}`,className:eb.columnImage,onError:d=>{console.error("기둥 이미지 로드 실패:",d);const f=d.target;f.style.display="none";const A=f.parentElement;A&&(A.innerHTML=`<div style="display: flex; align-items: center; justify-content: center; width: 100%; height: 100%; background: #f0f0f0; color: #666; font-size: 12px; text-align: center;">${a}</div>`)}})}),l.jsx("div",{className:eb.columnLabel,children:a})]})},v3e="_columnControl_1b5p1_1",w3e="_thumbnailSection_1b5p1_22",x3e="_thumbnailGrid_1b5p1_32",Z4={columnControl:v3e,thumbnailSection:w3e,thumbnailGrid:x3e},b3e=({columns:n,onColumnsChange:e})=>{const{t}=Eo(),i=qi(),{isColumnCreationMode:r,setColumnCreationMode:s,selectedColumnId:o,setSelectedColumnId:a}=Bi(),c=u=>{console.log("🎯 기둥 썸네일 드래그 시작")},h=u=>{console.log("🎯 기둥 썸네일 더블클릭:",u);const d=i.spaceInfo;if(!d)return;const f=0,A=-(d.depth||1500)*.01/2+u.depth*.01/2,g={id:`column-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,position:[f,0,A],width:u.width,height:u.height||d.height||2400,depth:u.depth,color:u.color||"#888888",material:u.material||"concrete"};console.log("🏗️ 더블클릭으로 새 기둥 생성:",g),e([...n,g])};return n.find(u=>u.id===o),l.jsx("div",{className:Z4.columnControl,children:l.jsxs("div",{className:Z4.thumbnailSection,children:[l.jsx("h4",{children:t("sidebar.structureTypes")}),l.jsxs("div",{className:Z4.thumbnailGrid,children:[l.jsx(g0,{width:300,height:2400,depth:730,material:"concrete",color:"#888888",onDragStart:c,onDoubleClick:h,title:t("sidebar.columnA")}),l.jsx(g0,{width:120,height:2400,depth:730,material:"concrete",color:"#888888",onDragStart:c,onDoubleClick:h,title:t("sidebar.columnB")}),l.jsx(g0,{width:300,height:2400,depth:300,material:"concrete",color:"#888888",onDragStart:c,onDoubleClick:h,title:t("sidebar.columnC")}),l.jsx(g0,{width:20,height:2400,depth:730,material:"concrete",color:"#888888",onDragStart:c,onDoubleClick:h,title:t("sidebar.panelA")}),l.jsx(g0,{width:600,height:18,depth:730,material:"wood",color:"#8B4513",onDragStart:c,onDoubleClick:h,title:t("sidebar.panelB")}),l.jsx(g0,{width:120,height:2400,depth:730,material:"concrete",color:"#E0E0E0",onDragStart:c,onDoubleClick:h,title:t("sidebar.partition")})]})]})})},_3e="_overlay_rytwa_1",C3e="_modal_rytwa_16",S3e="_modalHeader_rytwa_40",T3e="_keyboardHint_rytwa_53",B3e="_closeButton_rytwa_62",E3e="_modalContent_rytwa_81",k3e="_section_rytwa_87",I3e="_infoRow_rytwa_104",F3e="_columnId_rytwa_112",D3e="_inputRow_rytwa_120",j3e="_inputItem_rytwa_125",P3e="_modalFooter_rytwa_154",N3e="_actionButtons_rytwa_162",L3e="_deleteButton_rytwa_167",M3e="_cancelButton_rytwa_186",R3e="_saveButton_rytwa_205",$s={overlay:_3e,modal:C3e,modalHeader:S3e,keyboardHint:T3e,closeButton:B3e,modalContent:E3e,section:k3e,infoRow:I3e,columnId:F3e,inputRow:D3e,inputItem:j3e,modalFooter:P3e,actionButtons:N3e,deleteButton:L3e,cancelButton:M3e,saveButton:R3e},O3e=({columnId:n,isOpen:e,onClose:t})=>{var F;const{t:i}=Eo(),{spaceInfo:r,setSpaceInfo:s}=qi(),{setSelectedColumnId:o,activePopup:a,closeAllPopups:c}=Bi(),h=r.columns||[],u=n?h.find(B=>B.id===n):null,d=O.useRef(null),[f,A]=O.useState({});O.useEffect(()=>{u&&e&&(A({width:u.width,height:u.height,depth:u.depth,position:[...u.position]}),d.current={...u})},[u,e]);const g=r.width||3e3,p=u?(((F=f.position)==null?void 0:F[0])||u.position[0])*100:0,y=u?f.width||u.width:0,v=0,m=Math.max(0,g-y),w=Math.max(v,Math.min(p+g/2-y/2,m)),x=Math.max(v,Math.min(g/2-p-y/2,m)),T=B=>{if(!u)return;const V=Math.max(v,Math.min(B,m))+y/2-g/2,K=[...f.position||u.position];K[0]=V/100,A(P=>{const M={...P,position:K};return D({...u,...M}),M})},j=B=>{if(!u)return;const E=Math.max(v,Math.min(B,m)),V=g/2-E-y/2,K=[...f.position||u.position];K[0]=V/100,A(P=>{const M={...P,position:K};return D({...u,...M}),M})};O.useEffect(()=>{if(!e||!u||a.type!=="columnEdit"||a.id!==n)return;const B=E=>{const V=document.activeElement;if(V&&(V.tagName==="INPUT"||V.tagName==="TEXTAREA"))return;const K=E.shiftKey;switch(E.key){case"ArrowUp":case"ArrowDown":{E.preventDefault();const P=K?10:1,M=E.key==="ArrowUp"?P:-P,X=Math.max(v,Math.min(w+M,m));T(X),console.log("⌨️ 좌측갭 키보드 조정:",{key:E.key,shift:K,step:P,oldValue:Math.round(w),newValue:Math.round(X)});break}case"ArrowLeft":case"ArrowRight":{E.preventDefault();const P=K?100:10,M=E.key==="ArrowLeft"?P:-P,X=Math.max(v,Math.min(x+M,m));j(X),console.log("⌨️ 우측갭 키보드 조정:",{key:E.key,shift:K,step:P,oldValue:Math.round(x),newValue:Math.round(X)});break}}};return document.addEventListener("keydown",B),()=>{document.removeEventListener("keydown",B)}},[e,u,a.type,a.id,n,w,x,v,m,T,j]);const D=B=>{if(!u)return;const E=h.map(V=>V.id===u.id?{...V,...B}:V);s({columns:E})};if(!e||!u||a.type!=="columnEdit"||a.id!==n)return null;const b=(B,E)=>{A(V=>{const K={...V,[B]:E};if(B==="depth"){const P=r.depth||1500,M=E,X=-(P/2)+M/2,Z=V.position||u.position;K.position=[Z[0],Z[1],X/100]}return D({...u,...K}),K})},_=()=>{t()},I=()=>{if(d.current){const B=h.map(E=>E.id===u.id?{...d.current}:E);s({columns:B})}A({}),t()},S=()=>{if(window.confirm(i("column.deleteConfirm"))){const B=h.filter(E=>E.id!==u.id);s({columns:B}),o(null),t()}};return l.jsx("div",{className:$s.overlay,children:l.jsxs("div",{className:$s.modal,children:[l.jsxs("div",{className:$s.modalHeader,children:[l.jsx("h3",{className:$s.title,children:i("column.editColumn")}),l.jsx("button",{className:$s.closeButton,onClick:t,children:"✕"})]}),l.jsxs("div",{className:$s.modalContent,children:[l.jsxs("div",{className:$s.section,children:[l.jsx("h4",{className:$s.sectionTitle,children:i("column.basicInfo")}),l.jsxs("div",{className:$s.infoRow,children:[l.jsxs("span",{children:[i("column.columnId"),":"]}),l.jsx("span",{className:$s.columnId,children:u.id.split("-")[1]})]})]}),l.jsxs("div",{className:$s.section,children:[l.jsx("h4",{className:$s.sectionTitle,children:i("column.size")}),l.jsxs("div",{className:$s.inputRow,children:[l.jsxs("div",{className:$s.inputItem,children:[l.jsxs("label",{children:[i("column.width")," (mm)"]}),l.jsx("input",{type:"number",value:f.width||u.width,onChange:B=>b("width",Number(B.target.value)),min:"100",max:"1000",step:"10"})]}),l.jsxs("div",{className:$s.inputItem,children:[l.jsxs("label",{children:[i("column.depth")," (mm)"]}),l.jsx("input",{type:"number",value:f.depth||u.depth,onChange:B=>b("depth",Number(B.target.value)),min:"100",max:"1500",step:"10"})]}),l.jsxs("div",{className:$s.inputItem,children:[l.jsxs("label",{children:[i("column.height")," (mm)"]}),l.jsx("input",{type:"number",value:f.height||u.height,onChange:B=>b("height",Number(B.target.value)),min:"1000",max:"3000",step:"10"})]})]})]}),l.jsxs("div",{className:$s.section,children:[l.jsx("h4",{className:$s.sectionTitle,children:i("column.position")}),l.jsx("div",{className:$s.keyboardHint,children:l.jsxs("small",{children:["💡 ",i("column.keyboardHint")]})}),l.jsxs("div",{className:$s.inputRow,children:[l.jsxs("div",{className:$s.inputItem,children:[l.jsxs("label",{children:[i("column.leftGap")," (mm)"]}),l.jsx("input",{type:"number",value:Math.round(w),onChange:B=>T(Number(B.target.value)),step:"10"})]}),l.jsxs("div",{className:$s.inputItem,children:[l.jsxs("label",{children:[i("column.rightGap")," (mm)"]}),l.jsx("input",{type:"number",value:Math.round(x),onChange:B=>j(Number(B.target.value)),step:"10"})]})]})]})]}),l.jsxs("div",{className:$s.modalFooter,children:[l.jsx("button",{className:$s.deleteButton,onClick:S,children:i("common.delete")}),l.jsxs("div",{className:$s.actionButtons,children:[l.jsx("button",{className:$s.cancelButton,onClick:I,children:i("common.cancel")}),l.jsx("button",{className:$s.saveButton,onClick:_,children:i("common.confirm")})]})]})]})})},U3e="_overlay_14yio_1",H3e="_modal_14yio_14",W3e="_header_14yio_27",Q3e="_closeButton_14yio_42",$3e="_content_14yio_59",V3e="_section_14yio_66",z3e="_sectionTitle_14yio_70",G3e="_sectionHeader_14yio_76",X3e="_formatTabs_14yio_84",K3e="_formatTab_14yio_84",q3e="_active_14yio_122",Y3e="_renderModes_14yio_134",Z3e="_renderMode_14yio_134",J3e="_renderModeContent_14yio_171",e4e="_viewList_14yio_189",t4e="_viewOption_14yio_195",n4e="_selected_14yio_212",i4e="_viewDescription_14yio_231",r4e="_viewDetail_14yio_237",s4e="_downloadButton_14yio_254",Zi={overlay:U3e,modal:H3e,header:W3e,closeButton:Q3e,content:$3e,section:V3e,sectionTitle:z3e,sectionHeader:G3e,formatTabs:X3e,formatTab:K3e,active:q3e,renderModes:Y3e,renderMode:Z3e,renderModeContent:J3e,viewList:e4e,viewOption:t4e,selected:n4e,viewDescription:i4e,viewDetail:r4e,downloadButton:s4e},o4e="_overlay_1e78m_1",a4e="_lightTheme_1e78m_13",l4e="_darkTheme_1e78m_17",c4e="_fullContainer_1e78m_21",h4e="_selected_1e78m_96",u4e="_bottomContainer_1e78m_167",d4e="_sidebar_1e78m_174",A4e="_tabButtons_1e78m_182",f4e="_tabButton_1e78m_182",p4e="_active_1e78m_213",g4e="_tabLabel_1e78m_229",m4e="_tabContent_1e78m_235",y4e="_menuTitle_1e78m_241",v4e="_uploadContent_1e78m_249",w4e="_uploadArea_1e78m_253",x4e="_uploadButton_1e78m_261",b4e="_uploadedFilesList_1e78m_301",_4e="_uploadedFilesTitle_1e78m_307",C4e="_filesGrid_1e78m_314",S4e="_fileItem_1e78m_322",T4e="_fileThumbnail_1e78m_341",B4e="_fileIcon_1e78m_360",E4e="_fileName_1e78m_373",k4e="_fileActions_1e78m_385",I4e="_fileActionBtn_1e78m_396",F4e="_subTabContainer_1e78m_424",D4e="_subTab_1e78m_424",j4e="_subTabScrollContainer_1e78m_457",P4e="_subTabWrapper_1e78m_465",N4e="_scrollButton_1e78m_506",L4e="_left_1e78m_526",M4e="_right_1e78m_531",R4e="_disabled_1e78m_542",O4e="_canvasContainer_1e78m_549",U4e="_placeholderText_1e78m_620",H4e="_viewGrid_1e78m_625",W4e="_viewMenuItem_1e78m_631",Q4e="_viewItemContent_1e78m_655",$4e="_viewItemPlaceholder_1e78m_673",V4e="_viewItemLabel_1e78m_679",z4e="_mainContainer_1e78m_690",G4e="_contentWrapper_1e78m_699",X4e="_header_1e78m_717",K4e="_controls_1e78m_738",q4e="_zoomControls_1e78m_745",Y4e="_zoomBtn_1e78m_754",Z4e="_zoomValue_1e78m_775",J4e="_zoomPresetDropdown_1e78m_806",eTe="_zoomPresetButton_1e78m_811",tTe="_zoomPresetMenu_1e78m_829",nTe="_zoomPresetDivider_1e78m_861",iTe="_paperSizeContainer_1e78m_903",rTe="_paperSizeLabel_1e78m_910",sTe="_generateButton_1e78m_955",oTe="_actionButton_1e78m_980",aTe="_themeToggle_1e78m_1009",lTe="_closeButton_1e78m_1037",cTe="_previewContainer_1e78m_1055",hTe="_rulerWrapper_1e78m_1068",uTe="_rulerCorner_1e78m_1079",dTe="_rulerHorizontal_1e78m_1093",ATe="_rulerVertical_1e78m_1111",fTe="_previewContent_1e78m_1128",pTe="_textItemContent_1e78m_1139",gTe="_infoContent_1e78m_1151",mTe="_infoTitle_1e78m_1159",yTe="_infoSpecs_1e78m_1181",vTe="_infoSpecItem_1e78m_1188",wTe="_titleContent_1e78m_1209",xTe="_specsContent_1e78m_1232",bTe="_notesContent_1e78m_1253",_Te="_textInput_1e78m_1274",CTe="_textAreaInput_1e78m_1288",STe="_drawingArea_1e78m_1399",TTe="_paperSizeDropdown_1e78m_1540",BTe="_paperSizeButton_1e78m_1544",ETe="_paperSizeMenu_1e78m_1566",kTe="_paperDimensions_1e78m_1606",ITe="_orientationButtons_1e78m_1613",FTe="_orientButton_1e78m_1621",DTe="_resizeHandle_1e78m_1723",jTe="_nw_1e78m_1767",PTe="_ne_1e78m_1772",NTe="_sw_1e78m_1777",LTe="_se_1e78m_96",MTe="_n_1e78m_1253",RTe="_w_1e78m_925",OTe="_e_1e78m_1820",UTe="_s_1e78m_96",HTe="_pagePreviewPanel_1e78m_1870",WTe="_addPageCard_1e78m_1870",QTe="_addPageIcon_1e78m_1896",$Te="_addPageText_1e78m_1909",VTe="_pageList_1e78m_1975",zTe="_portraitList_1e78m_1984",GTe="_pageItemWrapper_1e78m_1988",XTe="_portrait_1e78m_1984",KTe="_pageNumber_1e78m_2004",qTe="_pageItem_1e78m_1988",YTe="_pageThumbnail_1e78m_2106",ZTe="_pagePreview_1e78m_1870",JTe="_miniView_1e78m_2137",eBe="_emptyPage_1e78m_2144",tBe="_deletePageBtn_1e78m_2153",nBe="_alignmentGuideVertical_1e78m_2204",iBe="_alignmentGuideHorizontal_1e78m_2216",rBe="_viewerOverlay_1e78m_2229",sBe="_viewerContainer_1e78m_2252",oBe="_viewerHeader_1e78m_2275",aBe="_viewerSubHeader_1e78m_2311",lBe="_leftControls_1e78m_2321",cBe="_centerControls_1e78m_2322",hBe="_rightControls_1e78m_2323",uBe="_toggleGroup_1e78m_2329",dBe="_toggleLabel_1e78m_2335",ABe="_clickable_1e78m_2342",fBe="_on_1e78m_2363",pBe="_switchHandle_1e78m_2367",gBe="_checkboxGroup_1e78m_2382",mBe="_checkboxLabel_1e78m_2387",yBe="_checkbox_1e78m_2382",vBe="_checkmark_1e78m_2406",wBe="_renderModeGroup_1e78m_2452",xBe="_viewModeGroup_1e78m_2453",bBe="_viewDirectionGroup_1e78m_2454",_Be="_renderModeButton_1e78m_2443",CBe="_viewModeButton_1e78m_2441",SBe="_viewDirectionButton_1e78m_2463",TBe="_viewerContent_1e78m_2542",BBe="_viewerFooter_1e78m_2549",EBe="_captureButton_1e78m_2558",kBe="_cancelButton_1e78m_2576",IBe="_shapeGrid_1e78m_2729",FBe="_shapeItem_1e78m_2756",DBe="_rotateHandle_1e78m_2870",jBe="_pageListContainer_1e78m_2919",PBe="_zoomSlider_1e78m_2996",NBe="_exportButtonWrapper_1e78m_3617",LBe="_exportPopup_1e78m_3621",MBe="_exportPopupHeader_1e78m_3646",RBe="_exportPopupClose_1e78m_3661",OBe="_exportFormatList_1e78m_3681",UBe="_exportFormatItem_1e78m_3685",HBe="_exportPopupFooter_1e78m_3727",WBe="_exportButton_1e78m_3617",Qe={overlay:o4e,lightTheme:a4e,darkTheme:l4e,fullContainer:c4e,selected:h4e,bottomContainer:u4e,sidebar:d4e,tabButtons:A4e,tabButton:f4e,active:p4e,tabLabel:g4e,tabContent:m4e,menuTitle:y4e,uploadContent:v4e,uploadArea:w4e,uploadButton:x4e,uploadedFilesList:b4e,uploadedFilesTitle:_4e,filesGrid:C4e,fileItem:S4e,fileThumbnail:T4e,fileIcon:B4e,fileName:E4e,fileActions:k4e,fileActionBtn:I4e,subTabContainer:F4e,subTab:D4e,subTabScrollContainer:j4e,subTabWrapper:P4e,scrollButton:N4e,left:L4e,right:M4e,disabled:R4e,canvasContainer:O4e,placeholderText:U4e,viewGrid:H4e,viewMenuItem:W4e,viewItemContent:Q4e,viewItemPlaceholder:$4e,viewItemLabel:V4e,mainContainer:z4e,contentWrapper:G4e,header:X4e,controls:K4e,zoomControls:q4e,zoomBtn:Y4e,zoomValue:Z4e,zoomPresetDropdown:J4e,zoomPresetButton:eTe,zoomPresetMenu:tTe,zoomPresetDivider:nTe,paperSizeContainer:iTe,paperSizeLabel:rTe,generateButton:sTe,actionButton:oTe,themeToggle:aTe,closeButton:lTe,previewContainer:cTe,rulerWrapper:hTe,rulerCorner:uTe,rulerHorizontal:dTe,rulerVertical:ATe,previewContent:fTe,textItemContent:pTe,infoContent:gTe,infoTitle:mTe,infoSpecs:yTe,infoSpecItem:vTe,titleContent:wTe,specsContent:xTe,notesContent:bTe,textInput:_Te,textAreaInput:CTe,drawingArea:STe,paperSizeDropdown:TTe,paperSizeButton:BTe,paperSizeMenu:ETe,paperDimensions:kTe,orientationButtons:ITe,orientButton:FTe,resizeHandle:DTe,nw:jTe,ne:PTe,sw:NTe,se:LTe,n:MTe,w:RTe,e:OTe,s:UTe,pagePreviewPanel:HTe,addPageCard:WTe,addPageIcon:QTe,addPageText:$Te,pageList:VTe,portraitList:zTe,pageItemWrapper:GTe,portrait:XTe,pageNumber:KTe,pageItem:qTe,pageThumbnail:YTe,pagePreview:ZTe,miniView:JTe,emptyPage:eBe,deletePageBtn:tBe,alignmentGuideVertical:nBe,alignmentGuideHorizontal:iBe,viewerOverlay:rBe,viewerContainer:sBe,viewerHeader:oBe,viewerSubHeader:aBe,leftControls:lBe,centerControls:cBe,rightControls:hBe,toggleGroup:uBe,toggleLabel:dBe,clickable:ABe,switch:"_switch_1e78m_2351",on:fBe,switchHandle:pBe,checkboxGroup:gBe,checkboxLabel:mBe,checkbox:yBe,checkmark:vBe,renderModeGroup:wBe,viewModeGroup:xBe,viewDirectionGroup:bBe,renderModeButton:_Be,viewModeButton:CBe,viewDirectionButton:SBe,viewerContent:TBe,viewerFooter:BBe,captureButton:EBe,cancelButton:kBe,shapeGrid:IBe,shapeItem:FBe,rotateHandle:DBe,pageListContainer:jBe,zoomSlider:PBe,exportButtonWrapper:NBe,exportPopup:LBe,exportPopupHeader:MBe,exportPopupClose:RBe,exportFormatList:OBe,exportFormatItem:UBe,exportPopupFooter:HBe,exportButton:WBe},QBe=(n,e)=>{const{view2DDirection:t}=n;switch(t){case"front":return EM(n,e);case"top":return $Be(n,e);case"left":return oG(n,e);case"right":return VBe(n,e);default:return EM(n,e)}},EM=(n,e)=>{const{spaceInfo:t,placedModules:i}=n;let r=`<svg width="${e.width}" height="${e.height}" viewBox="0 0 ${e.width} ${e.height}" xmlns="http://www.w3.org/2000/svg">`;r+=`<rect width="${e.width}" height="${e.height}" fill="white"/>`;const s=50,o=e.width-s*2,a=e.height-s*2,c=o/t.width,h=a/t.height,u=Math.min(c,h),d=(e.width-t.width*u)/2,f=(e.height-t.height*u)/2;return r+=`<g transform="translate(${d}, ${f}) scale(${u})">`,r+=`<rect x="0" y="0" width="${t.width}" height="${t.height}" 
          fill="none" stroke="black" stroke-width="${2/u}"/>`,i.forEach((A,g)=>{var F,B,E,V;const p=Hi(A.moduleId,kr(t),t);if(!p)return;const y=t.width/2+A.position.x*10-p.dimensions.width/2,v=((F=t.baseConfig)==null?void 0:F.type)==="base_frame"?((B=t.baseConfig)==null?void 0:B.height)||100:0,m=t.height-p.dimensions.height-v,w="#333333",x="#f8f8f8",T=1.5/u;r+='<g opacity="1">',r+=`<rect x="${y}" y="${m}" 
            width="${p.dimensions.width}" height="${p.dimensions.height}"
            fill="${x}" stroke="${w}" stroke-width="${T}"/>`;const D=p.modelConfig,b=(D==null?void 0:D.shelfCount)||0,_=Math.abs(p.dimensions.width-800)<50||Math.abs(p.dimensions.width-1e3)<50;if(b>0)if(_){const K=y+p.dimensions.width/2;r+=`<line x1="${K}" y1="${m}" x2="${K}" y2="${m+p.dimensions.height}"
                stroke="${w}" stroke-width="${T}"/>`;const P=Math.floor(b/2);for(let M=1;M<=P;M++){const X=m+p.dimensions.height/(P+1)*M;r+=`<line x1="${y}" y1="${X}" x2="${K}" y2="${X}"
                  stroke="${w}" stroke-width="${T*.7}"/>`,r+=`<line x1="${K}" y1="${X}" x2="${y+p.dimensions.width}" y2="${X}"
                  stroke="${w}" stroke-width="${T*.7}"/>`}}else for(let K=1;K<=b;K++){const P=m+p.dimensions.height/(b+1)*K;r+=`<line x1="${y}" y1="${P}" x2="${y+p.dimensions.width}" y2="${P}"
                  stroke="${w}" stroke-width="${T*.7}"/>`}if((E=D==null?void 0:D.furnitureType)!=null&&E.includes("door"))if(_){const P=(p.dimensions.width-3)/2;r+=`<rect x="${y}" y="${m}" 
                width="${P}" height="${p.dimensions.height}"
                fill="none" stroke="${w}" stroke-width="${T}"/>`,r+=`<rect x="${y+P+3}" y="${m}" 
                width="${P}" height="${p.dimensions.height}"
                fill="none" stroke="${w}" stroke-width="${T}"/>`;const M=m+p.dimensions.height*.5;r+=`<circle cx="${y+P-30}" cy="${M}" r="${10/u}"
                fill="none" stroke="${w}" stroke-width="${T*.5}"/>`,r+=`<circle cx="${y+P+3+30}" cy="${M}" r="${10/u}"
                fill="none" stroke="${w}" stroke-width="${T*.5}"/>`}else{r+=`<rect x="${y}" y="${m}" 
                width="${p.dimensions.width}" height="${p.dimensions.height}"
                fill="none" stroke="${w}" stroke-width="${T}"/>`;const P=m+p.dimensions.height*.5;r+=`<circle cx="${y+30}" cy="${P}" r="${10/u}"
                fill="none" stroke="${w}" stroke-width="${T*.5}"/>`}if((V=D==null?void 0:D.furnitureType)!=null&&V.includes("drawer")){const K=D.drawerCount||1,P=p.dimensions.height/K;for(let M=0;M<K;M++){const X=m+P*M;M>0&&(r+=`<line x1="${y}" y1="${X}" x2="${y+p.dimensions.width}" y2="${X}"
                  stroke="${w}" stroke-width="${T*.7}"/>`);const Z=X+P/2,Q=y+p.dimensions.width*.3,U=y+p.dimensions.width*.7;r+=`<line x1="${Q}" y1="${Z}" x2="${U}" y2="${Z}"
                stroke="${w}" stroke-width="${T*1.5}"/>`}}r+="</g>";const I=y+p.dimensions.width/2,S=m+p.dimensions.height/2;r+=`<text x="${I}" y="${S}" 
            text-anchor="middle" dominant-baseline="middle" 
            font-size="${Math.min(20/u,p.dimensions.height/10)}" 
            fill="#666" opacity="0.7">${p.name}</text>`;{const K=m+p.dimensions.height+30/u;r+=`<line x1="${y}" y1="${K}" x2="${y+p.dimensions.width}" y2="${K}"
              stroke="#666" stroke-width="${.5/u}"/>`,r+=`<text x="${I}" y="${K+15/u}" 
              text-anchor="middle" font-size="${12/u}" fill="#666">
              ${p.dimensions.width}mm</text>`}}),r+="</g>",r+=`<line x1="${d-30}" y1="${f}" x2="${d-30}" y2="${f+t.height*u}"
            stroke="#666" stroke-width="1"/>`,r+=`<text x="${d-40}" y="${f+t.height*u/2}" 
            text-anchor="middle" font-size="14" fill="#666" transform="rotate(-90, ${d-40}, ${f+t.height*u/2})">
            ${t.height}mm</text>`,r+=`<line x1="${d}" y1="${f+t.height*u+30}" 
            x2="${d+t.width*u}" y2="${f+t.height*u+30}"
            stroke="#666" stroke-width="1"/>`,r+=`<text x="${d+t.width*u/2}" y="${f+t.height*u+45}" 
            text-anchor="middle" font-size="14" fill="#666">
            ${t.width}mm</text>`,r+="</svg>",r},$Be=(n,e)=>{const{spaceInfo:t,placedModules:i}=n;let r=`<svg width="${e.width}" height="${e.height}" viewBox="0 0 ${e.width} ${e.height}" xmlns="http://www.w3.org/2000/svg">`;r+=`<rect width="${e.width}" height="${e.height}" fill="white"/>`;const s=50,o=e.width-s*2,a=e.height-s*2,c=o/t.width,h=a/t.depth,u=Math.min(c,h),d=(e.width-t.width*u)/2,f=(e.height-t.depth*u)/2;return r+=`<g transform="translate(${d}, ${f}) scale(${u})">`,r+=`<rect x="0" y="0" width="${t.width}" height="${t.depth}" 
          fill="none" stroke="black" stroke-width="${2/u}"/>`,i.forEach((A,g)=>{var I;const p=Hi(A.moduleId,kr(t),t);if(!p)return;const y=t.width/2+A.position.x*10-p.dimensions.width/2,v=20,m="#333333",w="#f8f8f8",x=1.5/u;r+='<g opacity="1">',r+=`<rect x="${y}" y="${v}" 
            width="${p.dimensions.width}" height="${p.dimensions.depth}"
            fill="${w}" stroke="${m}" stroke-width="${x}"/>`;const j=p.modelConfig,D=Math.abs(p.dimensions.width-800)<50||Math.abs(p.dimensions.width-1e3)<50;if(D){const S=y+p.dimensions.width/2;r+=`<line x1="${S}" y1="${v}" x2="${S}" y2="${v+p.dimensions.depth}"
              stroke="${m}" stroke-width="${x}"/>`}if((I=j==null?void 0:j.furnitureType)!=null&&I.includes("door")){const S=Math.min(p.dimensions.depth*.8,200);if(D){const F=p.dimensions.width/2,B=y,E=y+F;r+=`<path d="M ${B} ${v+p.dimensions.depth} 
                A ${S} ${S} 0 0 1 ${B+S} ${v+p.dimensions.depth-S}"
                fill="none" stroke="${m}" stroke-width="${x*.5}" stroke-dasharray="5,5"/>`,r+=`<path d="M ${E+F} ${v+p.dimensions.depth} 
                A ${S} ${S} 0 0 0 ${E+F-S} ${v+p.dimensions.depth-S}"
                fill="none" stroke="${m}" stroke-width="${x*.5}" stroke-dasharray="5,5"/>`}else r+=`<path d="M ${y} ${v+p.dimensions.depth} 
                A ${S} ${S} 0 0 1 ${y+S} ${v+p.dimensions.depth-S}"
                fill="none" stroke="${m}" stroke-width="${x*.5}" stroke-dasharray="5,5"/>`}r+="</g>";const b=y+p.dimensions.width/2,_=v+p.dimensions.depth/2;r+=`<text x="${b}" y="${_}" 
            text-anchor="middle" dominant-baseline="middle" 
            font-size="${Math.min(16/u,p.dimensions.depth/5)}" 
            fill="#666" opacity="0.7">${p.name}</text>`}),r+="</g>",r+=`<line x1="${d-30}" y1="${f}" x2="${d-30}" y2="${f+t.depth*u}"
            stroke="#666" stroke-width="1"/>`,r+=`<text x="${d-40}" y="${f+t.depth*u/2}" 
            text-anchor="middle" font-size="14" fill="#666" transform="rotate(-90, ${d-40}, ${f+t.depth*u/2})">
            ${t.depth}mm</text>`,r+=`<line x1="${d}" y1="${f+t.depth*u+30}" 
            x2="${d+t.width*u}" y2="${f+t.depth*u+30}"
            stroke="#666" stroke-width="1"/>`,r+=`<text x="${d+t.width*u/2}" y="${f+t.depth*u+45}" 
            text-anchor="middle" font-size="14" fill="#666">
            ${t.width}mm</text>`,r+="</svg>",r},oG=(n,e)=>{var w,x;const{spaceInfo:t,placedModules:i,showDimensions:r,renderMode:s}=n;let o=`<svg width="${e.width}" height="${e.height}" viewBox="0 0 ${e.width} ${e.height}" xmlns="http://www.w3.org/2000/svg">`;o+=`<rect width="${e.width}" height="${e.height}" fill="white"/>`;const a=50,c=e.width-a*2,h=e.height-a*2,u=c/t.depth,d=h/t.height,f=Math.min(u,d),A=(e.width-t.depth*f)/2,g=(e.height-t.height*f)/2;o+=`<g transform="translate(${A}, ${g}) scale(${f})">`,o+=`<rect x="0" y="0" width="${t.depth}" height="${t.height}" 
          fill="none" stroke="black" stroke-width="${2/f}"/>`;const p=s==="wireframe"?"#ff5500":"#333333",y=s==="wireframe"?"none":"#f8f8f8",v=s==="wireframe"?2/f:1.5/f,m=s==="wireframe"?.8:1;if(i.length>0){const T=i.reduce((D,b)=>D?b.position.x<D.position.x?b:D:b),j=Hi(T.moduleId,kr(t),t);if(j){const D=((w=t.baseConfig)==null?void 0:w.type)==="base_frame"?((x=t.baseConfig)==null?void 0:x.height)||100:0,b=20,_=t.height-j.dimensions.height-D,I=j.dimensions.depth,S=j.dimensions.height;o+=`<g opacity="${m}">`,o+=`<rect x="${b}" y="${_}" 
              width="${I}" height="${S}"
              fill="${y}" stroke="${p}" stroke-width="${v}"/>`;const F=j.modelConfig,B=(F==null?void 0:F.shelfCount)||0;if(B>0){const K=Math.min(B,7);for(let P=1;P<=K;P++){const M=_+S/(K+1)*P;o+=`<line x1="${b}" y1="${M}" x2="${b+I}" y2="${M}"
                  stroke="${p}" stroke-width="${v*.7}"/>`}}o+="</g>";const E=b+I/2,V=_+S/2;o+=`<text x="${E}" y="${V}" 
              text-anchor="middle" dominant-baseline="middle" 
              font-size="${Math.min(16/f,S/10)}" 
              fill="#666" opacity="0.7">Left Side View</text>`}}return o+="</g>",r&&(o+=`<line x1="${A-30}" y1="${g}" x2="${A-30}" y2="${g+t.height*f}"
            stroke="#666" stroke-width="1"/>`,o+=`<text x="${A-40}" y="${g+t.height*f/2}" 
            text-anchor="middle" font-size="14" fill="#666" transform="rotate(-90, ${A-40}, ${g+t.height*f/2})">
            ${t.height}mm</text>`,o+=`<line x1="${A}" y1="${g+t.height*f+30}" 
            x2="${A+t.depth*f}" y2="${g+t.height*f+30}"
            stroke="#666" stroke-width="1"/>`,o+=`<text x="${A+t.depth*f/2}" y="${g+t.height*f+45}" 
            text-anchor="middle" font-size="14" fill="#666">
            ${t.depth}mm</text>`),o+="</svg>",o},VBe=(n,e)=>oG(n,e);/*! https://mths.be/cssesc v3.0.0 by @mathias */var J4,kM;function zBe(){if(kM)return J4;kM=1;var n={},e=n.hasOwnProperty,t=function(c,h){if(!c)return h;var u={};for(var d in h)u[d]=e.call(c,d)?c[d]:h[d];return u},i=/[ -,\.\/:-@\[-\^`\{-~]/,r=/[ -,\.\/:-@\[\]\^`\{-~]/,s=/(^|\\+)?(\\[A-F0-9]{1,6})\x20(?![a-fA-F0-9\x20])/g,o=function a(c,h){h=t(h,a.options),h.quotes!="single"&&h.quotes!="double"&&(h.quotes="single");for(var u=h.quotes=="double"?'"':"'",d=h.isIdentifier,f=c.charAt(0),A="",g=0,p=c.length;g<p;){var y=c.charAt(g++),v=y.charCodeAt(),m=void 0;if(v<32||v>126){if(v>=55296&&v<=56319&&g<p){var w=c.charCodeAt(g++);(w&64512)==56320?v=((v&1023)<<10)+(w&1023)+65536:g--}m="\\"+v.toString(16).toUpperCase()+" "}else h.escapeEverything?i.test(y)?m="\\"+y:m="\\"+v.toString(16).toUpperCase()+" ":/[\t\n\f\r\x0B]/.test(y)?m="\\"+v.toString(16).toUpperCase()+" ":y=="\\"||!d&&(y=='"'&&u==y||y=="'"&&u==y)||d&&r.test(y)?m="\\"+y:m=y;A+=m}return d&&(/^-[-\d]/.test(A)?A="\\-"+A.slice(1):/\d/.test(f)&&(A="\\3"+f+" "+A.slice(1))),A=A.replace(s,function(x,T,j){return T&&T.length%2?x:(T||"")+j}),!d&&h.wrap?u+A+u:A};return o.options={escapeEverything:!1,isIdentifier:!1,quotes:"single",wrap:!1},o.version="3.0.0",J4=o,J4}var GBe=zBe();const aG=Kf(GBe);var eT,IM;function XBe(){if(IM)return eT;IM=1;var n=0,e=1,t=2,i=3,r=4,s=5,o=6,a=/[a-z0-9_-]/i,c=/[\s\t]/,h=function(f){for(var A=!0,g=n,p="",y=0,v,m,w=[];;){if(m=f[y],g===n){if(!m&&A)break;if(!m&&!A)throw new Error("Parse error");if(m==='"'||m==="'")v=m,g=e,A=!1;else if(!c.test(m))if(a.test(m))g=i,A=!1,y--;else throw new Error("Parse error")}else if(g===e)if(m)m==="\\"?g=t:m===v?(w.push(p),p="",g=r):p+=m;else throw new Error("Parse Error");else if(g===t)if(m===v||m==="\\")p+=m,g=e;else throw new Error("Parse error");else if(g===i)if(m)a.test(m)?p+=m:m===","?(w.push(p),p="",g=n):c.test(m)?g=s:m==="\\"&&(g=o);else{w.push(p);break}else if(g===o){if(/[0-9a-f]/i.test(m))throw new Error("Parse error");p+=m,g=i}else if(g===s)if(m){if(a.test(m))p+=" "+m,g=i;else if(m===",")w.push(p),p="",g=n;else if(!c.test(m))throw new Error("Parse error")}else{w.push(p);break}else if(g===r)if(m){if(m===",")g=n;else if(!c.test(m))throw new Error("Parse error")}else break;y++}return w},u=/[^a-z0-9_-]/i,d=function(f,A){var g=A&&A.quote||'"';if(g!=='"'&&g!=="'")throw new Error("Quote must be `'` or `\"`");for(var p=new RegExp(g,"g"),y=[],v=0;v<f.length;++v){var m=f[v];u.test(m)&&(m=m.replace(/\\/g,"\\\\").replace(p,"\\"+g),m=g+m+g),y.push(m)}return y.join(", ")};return eT={parse:h,stringify:d},eT}var KBe=XBe();const qBe=Kf(KBe);var tT,FM;function YBe(){if(FM)return tT;FM=1;var n={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},e=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function t(A){return A===10||A===13||A===8232||A===8233||A===32||A===9||A===11||A===12||A===160||A>=5760&&e.indexOf(A)>=0}function i(A){switch(A|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:case 114:return!0}return!1}function r(A){return(A|32)===97}function s(A){return A>=48&&A<=57}function o(A){return A>=48&&A<=57||A===43||A===45||A===46}function a(A){this.index=0,this.path=A,this.max=A.length,this.result=[],this.param=0,this.err="",this.segmentStart=0,this.data=[]}function c(A){for(;A.index<A.max&&t(A.path.charCodeAt(A.index));)A.index++}function h(A){var g=A.path.charCodeAt(A.index);if(g===48){A.param=0,A.index++;return}if(g===49){A.param=1,A.index++;return}A.err="SvgPath: arc flag can be 0 or 1 only (at pos "+A.index+")"}function u(A){var g=A.index,p=g,y=A.max,v=!1,m=!1,w=!1,x=!1,T;if(p>=y){A.err="SvgPath: missed param (at pos "+p+")";return}if(T=A.path.charCodeAt(p),(T===43||T===45)&&(p++,T=p<y?A.path.charCodeAt(p):0),!s(T)&&T!==46){A.err="SvgPath: param should start with 0..9 or `.` (at pos "+p+")";return}if(T!==46){if(v=T===48,p++,T=p<y?A.path.charCodeAt(p):0,v&&p<y&&T&&s(T)){A.err="SvgPath: numbers started with `0` such as `09` are illegal (at pos "+g+")";return}for(;p<y&&s(A.path.charCodeAt(p));)p++,m=!0;T=p<y?A.path.charCodeAt(p):0}if(T===46){for(x=!0,p++;s(A.path.charCodeAt(p));)p++,w=!0;T=p<y?A.path.charCodeAt(p):0}if(T===101||T===69){if(x&&!m&&!w){A.err="SvgPath: invalid float exponent (at pos "+p+")";return}if(p++,T=p<y?A.path.charCodeAt(p):0,(T===43||T===45)&&p++,p<y&&s(A.path.charCodeAt(p)))for(;p<y&&s(A.path.charCodeAt(p));)p++;else{A.err="SvgPath: invalid float exponent (at pos "+p+")";return}}A.index=p,A.param=parseFloat(A.path.slice(g,p))+0}function d(A){var g,p;g=A.path[A.segmentStart],p=g.toLowerCase();var y=A.data;if(p==="m"&&y.length>2&&(A.result.push([g,y[0],y[1]]),y=y.slice(2),p="l",g=g==="m"?"l":"L"),p==="r")A.result.push([g].concat(y));else for(;y.length>=n[p]&&(A.result.push([g].concat(y.splice(0,n[p]))),!!n[p]););}function f(A){var g=A.max,p,y,v,m,w;if(A.segmentStart=A.index,p=A.path.charCodeAt(A.index),y=r(p),!i(p)){A.err="SvgPath: bad command "+A.path[A.index]+" (at pos "+A.index+")";return}if(m=n[A.path[A.index].toLowerCase()],A.index++,c(A),A.data=[],!m){d(A);return}for(v=!1;;){for(w=m;w>0;w--){if(y&&(w===3||w===4)?h(A):u(A),A.err.length){d(A);return}A.data.push(A.param),c(A),v=!1,A.index<g&&A.path.charCodeAt(A.index)===44&&(A.index++,c(A),v=!0)}if(!v&&(A.index>=A.max||!o(A.path.charCodeAt(A.index))))break}d(A)}return tT=function(g){var p=new a(g),y=p.max;for(c(p);p.index<y&&!p.err.length;)f(p);return p.result.length&&("mM".indexOf(p.result[0][0])<0?(p.err="SvgPath: string should start with `M` or `m`",p.result=[]):p.result[0][0]="M"),{err:p.err,segments:p.result}},tT}var nT,DM;function lG(){if(DM)return nT;DM=1;function n(t,i){return[t[0]*i[0]+t[2]*i[1],t[1]*i[0]+t[3]*i[1],t[0]*i[2]+t[2]*i[3],t[1]*i[2]+t[3]*i[3],t[0]*i[4]+t[2]*i[5]+t[4],t[1]*i[4]+t[3]*i[5]+t[5]]}function e(){if(!(this instanceof e))return new e;this.queue=[],this.cache=null}return e.prototype.matrix=function(t){return t[0]===1&&t[1]===0&&t[2]===0&&t[3]===1&&t[4]===0&&t[5]===0?this:(this.cache=null,this.queue.push(t),this)},e.prototype.translate=function(t,i){return(t!==0||i!==0)&&(this.cache=null,this.queue.push([1,0,0,1,t,i])),this},e.prototype.scale=function(t,i){return(t!==1||i!==1)&&(this.cache=null,this.queue.push([t,0,0,i,0,0])),this},e.prototype.rotate=function(t,i,r){var s,o,a;return t!==0&&(this.translate(i,r),s=t*Math.PI/180,o=Math.cos(s),a=Math.sin(s),this.queue.push([o,a,-a,o,0,0]),this.cache=null,this.translate(-i,-r)),this},e.prototype.skewX=function(t){return t!==0&&(this.cache=null,this.queue.push([1,0,Math.tan(t*Math.PI/180),1,0,0])),this},e.prototype.skewY=function(t){return t!==0&&(this.cache=null,this.queue.push([1,Math.tan(t*Math.PI/180),0,1,0,0])),this},e.prototype.toArray=function(){if(this.cache)return this.cache;if(!this.queue.length)return this.cache=[1,0,0,1,0,0],this.cache;if(this.cache=this.queue[0],this.queue.length===1)return this.cache;for(var t=1;t<this.queue.length;t++)this.cache=n(this.cache,this.queue[t]);return this.cache},e.prototype.calc=function(t,i,r){var s;return this.queue.length?(this.cache||(this.cache=this.toArray()),s=this.cache,[t*s[0]+i*s[2]+(r?0:s[4]),t*s[1]+i*s[3]+(r?0:s[5])]):[t,i]},nT=e,nT}var iT,jM;function ZBe(){if(jM)return iT;jM=1;var n=lG(),e={matrix:!0,scale:!0,rotate:!0,translate:!0,skewX:!0,skewY:!0},t=/\s*(matrix|translate|scale|rotate|skewX|skewY)\s*\(\s*(.+?)\s*\)[\s,]*/,i=/[\s,]+/;return iT=function(s){var o=new n,a,c;return s.split(t).forEach(function(h){if(h.length){if(typeof e[h]<"u"){a=h;return}switch(c=h.split(i).map(function(u){return+u||0}),a){case"matrix":c.length===6&&o.matrix(c);return;case"scale":c.length===1?o.scale(c[0],c[0]):c.length===2&&o.scale(c[0],c[1]);return;case"rotate":c.length===1?o.rotate(c[0],0,0):c.length===3&&o.rotate(c[0],c[1],c[2]);return;case"translate":c.length===1?o.translate(c[0],0):c.length===2&&o.translate(c[0],c[1]);return;case"skewX":c.length===1&&o.skewX(c[0]);return;case"skewY":c.length===1&&o.skewY(c[0]);return}}}),o},iT}var rT,PM;function JBe(){if(PM)return rT;PM=1;var n=Math.PI*2;function e(r,s,o,a){var c=r*a-s*o<0?-1:1,h=r*o+s*a;return h>1&&(h=1),h<-1&&(h=-1),c*Math.acos(h)}function t(r,s,o,a,c,h,u,d,f,A){var g=A*(r-o)/2+f*(s-a)/2,p=-f*(r-o)/2+A*(s-a)/2,y=u*u,v=d*d,m=g*g,w=p*p,x=y*v-y*w-v*m;x<0&&(x=0),x/=y*w+v*m,x=Math.sqrt(x)*(c===h?-1:1);var T=x*u/d*p,j=x*-d/u*g,D=A*T-f*j+(r+o)/2,b=f*T+A*j+(s+a)/2,_=(g-T)/u,I=(p-j)/d,S=(-g-T)/u,F=(-p-j)/d,B=e(1,0,_,I),E=e(_,I,S,F);return h===0&&E>0&&(E-=n),h===1&&E<0&&(E+=n),[D,b,B,E]}function i(r,s){var o=1.3333333333333333*Math.tan(s/4),a=Math.cos(r),c=Math.sin(r),h=Math.cos(r+s),u=Math.sin(r+s);return[a,c,a-c*o,c+a*o,h+u*o,u-h*o,h,u]}return rT=function(s,o,a,c,h,u,d,f,A){var g=Math.sin(A*n/360),p=Math.cos(A*n/360),y=p*(s-a)/2+g*(o-c)/2,v=-g*(s-a)/2+p*(o-c)/2;if(y===0&&v===0)return[];if(d===0||f===0)return[];d=Math.abs(d),f=Math.abs(f);var m=y*y/(d*d)+v*v/(f*f);m>1&&(d*=Math.sqrt(m),f*=Math.sqrt(m));var w=t(s,o,a,c,h,u,d,f,g,p),x=[],T=w[2],j=w[3],D=Math.max(Math.ceil(Math.abs(j)/(n/4)),1);j/=D;for(var b=0;b<D;b++)x.push(i(T,j)),T+=j;return x.map(function(_){for(var I=0;I<_.length;I+=2){var S=_[I+0],F=_[I+1];S*=d,F*=f;var B=p*S-g*F,E=g*S+p*F;_[I+0]=B+w[0],_[I+1]=E+w[1]}return _})},rT}var sT,NM;function eEe(){if(NM)return sT;NM=1;var n=1e-10,e=Math.PI/180;function t(i,r,s){if(!(this instanceof t))return new t(i,r,s);this.rx=i,this.ry=r,this.ax=s}return t.prototype.transform=function(i){var r=Math.cos(this.ax*e),s=Math.sin(this.ax*e),o=[this.rx*(i[0]*r+i[2]*s),this.rx*(i[1]*r+i[3]*s),this.ry*(-i[0]*s+i[2]*r),this.ry*(-i[1]*s+i[3]*r)],a=o[0]*o[0]+o[2]*o[2],c=o[1]*o[1]+o[3]*o[3],h=((o[0]-o[3])*(o[0]-o[3])+(o[2]+o[1])*(o[2]+o[1]))*((o[0]+o[3])*(o[0]+o[3])+(o[2]-o[1])*(o[2]-o[1])),u=(a+c)/2;if(h<n*u)return this.rx=this.ry=Math.sqrt(u),this.ax=0,this;var d=o[0]*o[1]+o[2]*o[3];h=Math.sqrt(h);var f=u+h/2,A=u-h/2;return this.ax=Math.abs(d)<n&&Math.abs(f-c)<n?90:Math.atan(Math.abs(d)>Math.abs(f-c)?(f-a)/d:d/(f-c))*180/Math.PI,this.ax>=0?(this.rx=Math.sqrt(f),this.ry=Math.sqrt(A)):(this.ax+=90,this.rx=Math.sqrt(A),this.ry=Math.sqrt(f)),this},t.prototype.isDegenerate=function(){return this.rx<n*this.ry||this.ry<n*this.rx},sT=t,sT}var oT,LM;function tEe(){if(LM)return oT;LM=1;var n=YBe(),e=ZBe(),t=lG(),i=JBe(),r=eEe();function s(o){if(!(this instanceof s))return new s(o);var a=n(o);this.segments=a.segments,this.err=a.err,this.__stack=[]}return s.from=function(o){if(typeof o=="string")return new s(o);if(o instanceof s){var a=new s("");return a.err=o.err,a.segments=o.segments.map(function(c){return c.slice()}),a.__stack=o.__stack.map(function(c){return t().matrix(c.toArray())}),a}throw new Error("SvgPath.from: invalid param type "+o)},s.prototype.__matrix=function(o){var a=this,c;o.queue.length&&this.iterate(function(h,u,d,f){var A,g,p,y;switch(h[0]){case"v":A=o.calc(0,h[1],!0),g=A[0]===0?["v",A[1]]:["l",A[0],A[1]];break;case"V":A=o.calc(d,h[1],!1),g=A[0]===o.calc(d,f,!1)[0]?["V",A[1]]:["L",A[0],A[1]];break;case"h":A=o.calc(h[1],0,!0),g=A[1]===0?["h",A[0]]:["l",A[0],A[1]];break;case"H":A=o.calc(h[1],f,!1),g=A[1]===o.calc(d,f,!1)[1]?["H",A[0]]:["L",A[0],A[1]];break;case"a":case"A":var v=o.toArray(),m=r(h[1],h[2],h[3]).transform(v);if(v[0]*v[3]-v[1]*v[2]<0&&(h[5]=h[5]?"0":"1"),A=o.calc(h[6],h[7],h[0]==="a"),h[0]==="A"&&h[6]===d&&h[7]===f||h[0]==="a"&&h[6]===0&&h[7]===0){g=[h[0]==="a"?"l":"L",A[0],A[1]];break}m.isDegenerate()?g=[h[0]==="a"?"l":"L",A[0],A[1]]:g=[h[0],m.rx,m.ry,m.ax,h[4],h[5],A[0],A[1]];break;case"m":y=u>0,A=o.calc(h[1],h[2],y),g=["m",A[0],A[1]];break;default:for(p=h[0],g=[p],y=p.toLowerCase()===p,c=1;c<h.length;c+=2)A=o.calc(h[c],h[c+1],y),g.push(A[0],A[1])}a.segments[u]=g},!0)},s.prototype.__evaluateStack=function(){var o,a;if(this.__stack.length){if(this.__stack.length===1){this.__matrix(this.__stack[0]),this.__stack=[];return}for(o=t(),a=this.__stack.length;--a>=0;)o.matrix(this.__stack[a].toArray());this.__matrix(o),this.__stack=[]}},s.prototype.toString=function(){var o="",a="",c=!1;this.__evaluateStack();for(var h=0,u=this.segments.length;h<u;h++){var d=this.segments[h],f=d[0];f!==a||f==="m"||f==="M"?(f==="m"&&a==="z"&&(o+=" "),o+=f,c=!1):c=!0;for(var A=1;A<d.length;A++){var g=d[A];A===1?c&&g>=0&&(o+=" "):g>=0&&(o+=" "),o+=g}a=f}return o},s.prototype.translate=function(o,a){return this.__stack.push(t().translate(o,a||0)),this},s.prototype.scale=function(o,a){return this.__stack.push(t().scale(o,!a&&a!==0?o:a)),this},s.prototype.rotate=function(o,a,c){return this.__stack.push(t().rotate(o,a||0,c||0)),this},s.prototype.skewX=function(o){return this.__stack.push(t().skewX(o)),this},s.prototype.skewY=function(o){return this.__stack.push(t().skewY(o)),this},s.prototype.matrix=function(o){return this.__stack.push(t().matrix(o)),this},s.prototype.transform=function(o){return o.trim()?(this.__stack.push(e(o)),this):this},s.prototype.round=function(o){var a=0,c=0,h=0,u=0,d;return o=o||0,this.__evaluateStack(),this.segments.forEach(function(f){var A=f[0].toLowerCase()===f[0];switch(f[0]){case"H":case"h":A&&(f[1]+=h),h=f[1]-f[1].toFixed(o),f[1]=+f[1].toFixed(o);return;case"V":case"v":A&&(f[1]+=u),u=f[1]-f[1].toFixed(o),f[1]=+f[1].toFixed(o);return;case"Z":case"z":h=a,u=c;return;case"M":case"m":A&&(f[1]+=h,f[2]+=u),h=f[1]-f[1].toFixed(o),u=f[2]-f[2].toFixed(o),a=h,c=u,f[1]=+f[1].toFixed(o),f[2]=+f[2].toFixed(o);return;case"A":case"a":A&&(f[6]+=h,f[7]+=u),h=f[6]-f[6].toFixed(o),u=f[7]-f[7].toFixed(o),f[1]=+f[1].toFixed(o),f[2]=+f[2].toFixed(o),f[3]=+f[3].toFixed(o+2),f[6]=+f[6].toFixed(o),f[7]=+f[7].toFixed(o);return;default:d=f.length,A&&(f[d-2]+=h,f[d-1]+=u),h=f[d-2]-f[d-2].toFixed(o),u=f[d-1]-f[d-1].toFixed(o),f.forEach(function(g,p){p&&(f[p]=+f[p].toFixed(o))});return}}),this},s.prototype.iterate=function(o,a){var c=this.segments,h={},u=!1,d=0,f=0,A=0,g=0,p,y,v;if(a||this.__evaluateStack(),c.forEach(function(m,w){var x=o(m,w,d,f);Array.isArray(x)&&(h[w]=x,u=!0);var T=m[0]===m[0].toLowerCase();switch(m[0]){case"m":case"M":d=m[1]+(T?d:0),f=m[2]+(T?f:0),A=d,g=f;return;case"h":case"H":d=m[1]+(T?d:0);return;case"v":case"V":f=m[1]+(T?f:0);return;case"z":case"Z":d=A,f=g;return;default:d=m[m.length-2]+(T?d:0),f=m[m.length-1]+(T?f:0)}}),!u)return this;for(v=[],p=0;p<c.length;p++)if(typeof h[p]<"u")for(y=0;y<h[p].length;y++)v.push(h[p][y]);else v.push(c[p]);return this.segments=v,this},s.prototype.abs=function(){return this.iterate(function(o,a,c,h){var u=o[0],d=u.toUpperCase(),f;if(u!==d)switch(o[0]=d,u){case"v":o[1]+=h;return;case"a":o[6]+=c,o[7]+=h;return;default:for(f=1;f<o.length;f++)o[f]+=f%2?c:h}},!0),this},s.prototype.rel=function(){return this.iterate(function(o,a,c,h){var u=o[0],d=u.toLowerCase(),f;if(u!==d&&!(a===0&&u==="M"))switch(o[0]=d,u){case"V":o[1]-=h;return;case"A":o[6]-=c,o[7]-=h;return;default:for(f=1;f<o.length;f++)o[f]-=f%2?c:h}},!0),this},s.prototype.unarc=function(){return this.iterate(function(o,a,c,h){var u,d,f,A=[],g=o[0];return g!=="A"&&g!=="a"?null:(g==="a"?(d=c+o[6],f=h+o[7]):(d=o[6],f=o[7]),u=i(c,h,d,f,o[4],o[5],o[1],o[2],o[3]),u.length===0?[[o[0]==="a"?"l":"L",o[6],o[7]]]:(u.forEach(function(p){A.push(["C",p[2],p[3],p[4],p[5],p[6],p[7]])}),A))}),this},s.prototype.unshort=function(){var o=this.segments,a,c,h,u,d;return this.iterate(function(f,A,g,p){var y=f[0],v=y.toUpperCase(),m;A&&(v==="T"?(m=y==="t",h=o[A-1],h[0]==="Q"?(a=h[1]-g,c=h[2]-p):h[0]==="q"?(a=h[1]-h[3],c=h[2]-h[4]):(a=0,c=0),u=-a,d=-c,m||(u+=g,d+=p),o[A]=[m?"q":"Q",u,d,f[1],f[2]]):v==="S"&&(m=y==="s",h=o[A-1],h[0]==="C"?(a=h[3]-g,c=h[4]-p):h[0]==="c"?(a=h[3]-h[5],c=h[4]-h[6]):(a=0,c=0),u=-a,d=-c,m||(u+=g,d+=p),o[A]=[m?"c":"C",u,d,f[1],f[2],f[3],f[4]]))}),this},oT=s,oT}var aT,MM;function nEe(){return MM||(MM=1,aT=tEe()),aT}var iEe=nEe();const rEe=Kf(iEe);var RM=function(n){var e=n,t,i={a:0,b:0,c:0},r=[],s=/(\[[^\]]+\])/g,o=/(#[^\#\s\+>~\.\[:\)]+)/g,a=/(\.[^\s\+>~\.\[:\)]+)/g,c=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,h=/(:(?!not|global|local)[\w-]+\([^\)]*\))/gi,u=/(:(?!not|global|local)[^\s\+>~\.\[:]+)/g,d=/([^\s\+>~\.\[:]+)/g;return t=function(f,A){var g,p,y,v,m,w;if(f.test(e))for(g=e.match(f),p=0,y=g.length;p<y;p+=1)i[A]+=1,v=g[p],m=e.indexOf(v),w=v.length,r.push({selector:n.substr(m,w),type:A,index:m,length:w}),e=e.replace(v,Array(w+1).join(" "))},(function(){var f=function(y){var v,m,w,x;if(y.test(e))for(v=e.match(y),m=0,w=v.length;m<w;m+=1)x=v[m],e=e.replace(x,Array(x.length+1).join("A"))},A=/\\[0-9A-Fa-f]{6}\s?/g,g=/\\[0-9A-Fa-f]{1,5}\s/g,p=/\\./g;f(A),f(g),f(p)})(),(function(){var f=/{[^]*/gm,A,g,p,y;if(f.test(e))for(A=e.match(f),g=0,p=A.length;g<p;g+=1)y=A[g],e=e.replace(y,Array(y.length+1).join(" "))})(),t(s,"b"),t(o,"a"),t(a,"b"),t(c,"c"),t(h,"b"),t(u,"b"),e=e.replace(/[\*\s\+>~]/g," "),e=e.replace(/[#\.]/g," "),e=e.replace(/:not/g,"    "),e=e.replace(/:local/g,"      "),e=e.replace(/:global/g,"       "),e=e.replace(/[\(\)]/g," "),t(d,"c"),r.sort(function(f,A){return f.index-A.index}),{selector:n,specificity:"0,"+i.a.toString()+","+i.b.toString()+","+i.c.toString(),specificityArray:[0,i.a,i.b,i.c],parts:r}},sEe=function(n,e){var t,i,r;if(typeof n=="string"){if(n.indexOf(",")!==-1)throw"Invalid CSS selector";t=RM(n).specificityArray}else if(Array.isArray(n)){if(n.filter(function(s){return typeof s=="number"}).length!==4)throw"Invalid specificity array";t=n}else throw"Invalid CSS selector or specificity array";if(typeof e=="string"){if(e.indexOf(",")!==-1)throw"Invalid CSS selector";i=RM(e).specificityArray}else if(Array.isArray(e)){if(e.filter(function(s){return typeof s=="number"}).length!==4)throw"Invalid specificity array";i=e}else throw"Invalid CSS selector or specificity array";for(r=0;r<4;r+=1){if(t[r]<i[r])return-1;if(t[r]>i[r])return 1}return 0},l6=function(n,e){return l6=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},l6(n,e)};function Hs(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=n}l6(n,e),n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var gC=function(){return gC=Object.assign||function(n){for(var e,t=1,i=arguments.length;t<i;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},gC.apply(this,arguments)};function qs(n,e,t,i){return new(t||(t=Promise))((function(r,s){function o(h){try{c(i.next(h))}catch(u){s(u)}}function a(h){try{c(i.throw(h))}catch(u){s(u)}}function c(h){var u;h.done?r(h.value):(u=h.value,u instanceof t?u:new t((function(d){d(u)}))).then(o,a)}c((i=i.apply(n,e||[])).next())}))}function Ys(n,e){var t,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(h){return(function(u){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,i&&(r=2&u[0]?i.return:u[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,u[1])).done)return r;switch(i=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return o.label++,{value:u[1],done:!1};case 5:o.label++,i=u[1],u=[0];continue;case 7:u=o.ops.pop(),o.trys.pop();continue;default:if(r=o.trys,!((r=r.length>0&&r[r.length-1])||u[0]!==6&&u[0]!==2)){o=0;continue}if(u[0]===3&&(!r||u[1]>r[0]&&u[1]<r[3])){o.label=u[1];break}if(u[0]===6&&o.label<r[1]){o.label=r[1],r=u;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(u);break}r[2]&&o.ops.pop(),o.trys.pop();continue}u=e.call(n,o)}catch(d){u=[6,d],i=0}finally{t=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}})([c,h])}}}var pu=(function(){function n(e){if(this.a=void 0,this.r=0,this.g=0,this.b=0,this.simpleColors={},this.colorDefs=[],this.ok=!1,e){for(var t in e.charAt(0)=="#"&&(e=e.substr(1,6)),e=(e=e.replace(/ /g,"")).toLowerCase(),this.simpleColors={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgrey:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",grey:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightslategrey:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},this.simpleColors)e==t&&(e=this.simpleColors[t]);this.colorDefs=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(c){return[parseInt(c[1]),parseInt(c[2]),parseInt(c[3])]}},{re:/^rgb\(([0-9.]+)%,\s*([0-9.]+)%,\s*([0-9.]+)%\)$/,example:["rgb(50.5%, 25.75%, 75.5%)","rgb(100%,0%,0%)"],process:function(c){return[Math.round(2.55*parseFloat(c[1])),Math.round(2.55*parseFloat(c[2])),Math.round(2.55*parseFloat(c[3]))]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(c){return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(c){return[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]}}];for(var i=0;i<this.colorDefs.length;i++){var r=this.colorDefs[i].re,s=this.colorDefs[i].process,o=r.exec(e);if(o){var a=s(o);this.r=a[0],this.g=a[1],this.b=a[2],this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b}}return n.prototype.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},n.prototype.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+(this.a||"1")+")"},n.prototype.toHex=function(){var e=this.r.toString(16),t=this.g.toString(16),i=this.b.toString(16);return e.length==1&&(e="0"+e),t.length==1&&(t="0"+t),i.length==1&&(i="0"+i),"#"+e+t+i},n.prototype.getHelpXML=function(){for(var e=[],t=0;t<this.colorDefs.length;t++)for(var i=this.colorDefs[t].example,r=0;r<i.length;r++)e[e.length]=i[r];for(var s in this.simpleColors)e[e.length]=s;var o=document.createElement("ul");for(o.setAttribute("id","rgbcolor-examples"),t=0;t<e.length;t++)try{var a=document.createElement("li"),c=new n(e[t]),h=document.createElement("div");h.style.cssText="margin: 3px; border: 1px solid black; background:"+c.toHex()+"; color:"+c.toHex(),h.appendChild(document.createTextNode("test"));var u=document.createTextNode(" "+e[t]+" -> "+c.toRGB()+" -> "+c.toHex());a.appendChild(h),a.appendChild(u),o.appendChild(a)}catch{}return o},n})(),Il=(function(){function n(e){this.color=e}return n.prototype.getFillData=function(e,t){return qs(this,void 0,void 0,(function(){return Ys(this,(function(i){return[2,void 0]}))}))},n})(),km=(function(){function n(){this.xmlSpace="",this.fill=null,this.fillOpacity=1,this.fontFamily="",this.fontSize=16,this.fontStyle="",this.fontWeight="",this.opacity=1,this.stroke=null,this.strokeDasharray=null,this.strokeDashoffset=0,this.strokeLinecap="",this.strokeLinejoin="",this.strokeMiterlimit=4,this.strokeOpacity=1,this.strokeWidth=1,this.alignmentBaseline="",this.textAnchor="",this.visibility="",this.color=null,this.contextFill=null,this.contextStroke=null,this.fillRule=null}return n.prototype.clone=function(){var e=new n;return e.xmlSpace=this.xmlSpace,e.fill=this.fill,e.fillOpacity=this.fillOpacity,e.fontFamily=this.fontFamily,e.fontSize=this.fontSize,e.fontStyle=this.fontStyle,e.fontWeight=this.fontWeight,e.opacity=this.opacity,e.stroke=this.stroke,e.strokeDasharray=this.strokeDasharray,e.strokeDashoffset=this.strokeDashoffset,e.strokeLinecap=this.strokeLinecap,e.strokeLinejoin=this.strokeLinejoin,e.strokeMiterlimit=this.strokeMiterlimit,e.strokeOpacity=this.strokeOpacity,e.strokeWidth=this.strokeWidth,e.textAnchor=this.textAnchor,e.alignmentBaseline=this.alignmentBaseline,e.visibility=this.visibility,e.color=this.color,e.fillRule=this.fillRule,e.contextFill=this.contextFill,e.contextStroke=this.contextStroke,e},n.default=function(){var e=new n;return e.xmlSpace="default",e.fill=new Il(new pu("rgb(0, 0, 0)")),e.fillOpacity=1,e.fontFamily="times",e.fontSize=16,e.fontStyle="normal",e.fontWeight="normal",e.opacity=1,e.stroke=null,e.strokeDasharray=null,e.strokeDashoffset=0,e.strokeLinecap="butt",e.strokeLinejoin="miter",e.strokeMiterlimit=4,e.strokeOpacity=1,e.strokeWidth=1,e.alignmentBaseline="baseline",e.textAnchor="start",e.visibility="visible",e.color=new pu("rgb(0, 0, 0)"),e.fillRule="nonzero",e.contextFill=null,e.contextStroke=null,e},n.getContextColors=function(e,t){t===void 0&&(t=!1);var i={};return e.attributeState.contextFill&&(i.contextFill=e.attributeState.contextFill),e.attributeState.contextStroke&&(i.contextStroke=e.attributeState.contextStroke),t&&e.attributeState.color&&(i.color=e.attributeState.color),i},n})(),np=(function(){function n(e,t){var i,r,s;this.pdf=e,this.svg2pdfParameters=t.svg2pdfParameters,this.attributeState=t.attributeState?t.attributeState.clone():km.default(),this.viewport=t.viewport,this.refsHandler=t.refsHandler,this.styleSheets=t.styleSheets,this.textMeasure=t.textMeasure,this.transform=(i=t.transform)!==null&&i!==void 0?i:this.pdf.unitMatrix,this.withinClipPath=(r=t.withinClipPath)!==null&&r!==void 0&&r,this.withinUse=(s=t.withinUse)!==null&&s!==void 0&&s}return n.prototype.clone=function(e){var t,i,r,s;return e===void 0&&(e={}),new n(this.pdf,{svg2pdfParameters:this.svg2pdfParameters,attributeState:e.attributeState?e.attributeState.clone():this.attributeState.clone(),viewport:(t=e.viewport)!==null&&t!==void 0?t:this.viewport,refsHandler:this.refsHandler,styleSheets:this.styleSheets,textMeasure:this.textMeasure,transform:(i=e.transform)!==null&&i!==void 0?i:this.transform,withinClipPath:(r=e.withinClipPath)!==null&&r!==void 0?r:this.withinClipPath,withinUse:(s=e.withinUse)!==null&&s!==void 0?s:this.withinUse})},n})(),cG=(function(){function n(e){this.renderedElements={},this.idMap=e,this.idPrefix=String(n.instanceCounter++)}return n.prototype.getRendered=function(e,t,i){return qs(this,void 0,void 0,(function(){var r,s;return Ys(this,(function(o){switch(o.label){case 0:return r=this.generateKey(e,t),this.renderedElements.hasOwnProperty(r)?[2,this.renderedElements[e]]:(s=this.get(e),this.renderedElements[r]=s,[4,i(s)]);case 1:return o.sent(),[2,s]}}))}))},n.prototype.get=function(e){return this.idMap[aG(e,{isIdentifier:!0})]},n.prototype.generateKey=function(e,t){var i="";return t&&(i=["color","contextFill","contextStroke"].map((function(r){var s,o;return(o=(s=t[r])===null||s===void 0?void 0:s.toRGBA())!==null&&o!==void 0?o:""})).join("|")),this.idPrefix+"|"+e+"|"+i},n.instanceCounter=0,n})();function OM(n,e){return Math.atan2(e[1]-n[1],e[0]-n[0])}var UM=2/3;function HM(n,e){return[UM*(e[0]-n[0])+n[0],UM*(e[1]-n[1])+n[1]]}function ny(n){var e=Math.sqrt(n[0]*n[0]+n[1]*n[1]);return[n[0]/e,n[1]/e]}function m0(n,e){return ny([e[0]-n[0],e[1]-n[1]])}function tb(n,e){return[n[0]+e[0],n[1]+e[1]]}function lT(n,e){var t=n[0],i=n[1];return[e.a*t+e.c*i+e.e,e.b*t+e.d*i+e.f]}var Im=(function(){function n(){this.segments=[]}return n.prototype.moveTo=function(e,t){return this.segments.push(new tl(e,t)),this},n.prototype.lineTo=function(e,t){return this.segments.push(new mf(e,t)),this},n.prototype.curveTo=function(e,t,i,r,s,o){return this.segments.push(new id(e,t,i,r,s,o)),this},n.prototype.close=function(){return this.segments.push(new c6),this},n.prototype.transform=function(e){this.segments.forEach((function(t){if(t instanceof tl||t instanceof mf||t instanceof id){var i=lT([t.x,t.y],e);t.x=i[0],t.y=i[1]}if(t instanceof id){var r=lT([t.x1,t.y1],e),s=lT([t.x2,t.y2],e);t.x1=r[0],t.y1=r[1],t.x2=s[0],t.y2=s[1]}}))},n.prototype.draw=function(e){var t=e.pdf;this.segments.forEach((function(i){i instanceof tl?t.moveTo(i.x,i.y):i instanceof mf?t.lineTo(i.x,i.y):i instanceof id?t.curveTo(i.x1,i.y1,i.x2,i.y2,i.x,i.y):t.close()}))},n})(),tl=function(n,e){this.x=n,this.y=e},mf=function(n,e){this.x=n,this.y=e},id=function(n,e,t,i,r,s){this.x1=n,this.y1=e,this.x2=t,this.y2=i,this.x=r,this.y=s},c6=function(){};function Vf(n,e){return e.split(",").indexOf((n.nodeName||n.tagName).toLowerCase())>=0}function Un(n,e,t,i){var r;i===void 0&&(i=t);var s=(r=n.style)===null||r===void 0?void 0:r.getPropertyValue(i);if(s)return s;var o=e.getPropertyValue(n,i);return o||n.hasAttribute(t)&&n.getAttribute(t)||void 0}function DA(n,e,t){if(Un(n.element,t.styleSheets,"display")==="none")return!1;var i=e,r=Un(n.element,t.styleSheets,"visibility");return r&&(i=r!=="hidden"),i}function ip(n,e,t){var i=DA(n,e,t);return n.element.childNodes.length!==0&&(n.children.forEach((function(r){r.isVisible(i,t)&&(i=!0)})),i)}var oEe=(function(){function n(){this.markers=[]}return n.prototype.addMarker=function(e){this.markers.push(e)},n.prototype.draw=function(e){return qs(this,void 0,void 0,(function(){var t,i,r,s,o,a,c,h;return Ys(this,(function(u){switch(u.label){case 0:t=0,u.label=1;case 1:return t<this.markers.length?(i=this.markers[t],r=void 0,s=i.angle,o=i.anchor,a=Math.cos(s),c=Math.sin(s),r=e.pdf.Matrix(a,c,-c,a,o[0],o[1]),r=e.pdf.matrixMult(e.pdf.Matrix(e.attributeState.strokeWidth,0,0,e.attributeState.strokeWidth,0,0),r),r=e.pdf.matrixMult(r,e.transform),e.pdf.saveGraphicsState(),h=km.getContextColors(e),[4,e.refsHandler.getRendered(i.id,h,(function(d){return d.apply(e)}))]):[3,4];case 2:u.sent(),e.pdf.doFormObject(e.refsHandler.generateKey(i.id,h),r),e.pdf.restoreGraphicsState(),u.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},n})(),rf=function(n,e,t,i){i===void 0&&(i=!1),this.id=n,this.anchor=e,this.angle=t,this.isStartMarker=i},rF=/url\(["']?#([^"']+)["']?\)/,aEe={bottom:"bottom","text-bottom":"bottom",top:"top","text-top":"top",hanging:"hanging",middle:"middle",central:"middle",center:"middle",mathematical:"middle",ideographic:"ideographic",alphabetic:"alphabetic",baseline:"alphabetic"},WM="http://www.w3.org/2000/svg";function tA(n,e){var t;return(t=n&&n.toString().match(/^([\-0-9.]+)em$/))?parseFloat(t[1])*e:(t=n&&n.toString().match(/^([\-0-9.]+)(px|)$/))?parseFloat(t[1]):0}function hG(n){return aEe[n]||"alphabetic"}function Vh(n){for(var e,t=[],i=/[+-]?(?:(?:\d+\.?\d*)|(?:\d*\.?\d+))(?:[eE][+-]?\d+)?/g;e=i.exec(n);)t.push(parseFloat(e[0]));return t}function hm(n,e){if(n==="transparent"){var t=new pu("rgb(0,0,0)");return t.a=0,t}if(e&&n.toLowerCase()==="currentcolor")return e.color||new pu("rgb(0,0,0)");if(e&&n.toLowerCase()==="context-stroke")return e.contextStroke||new pu("rgb(0,0,0)");if(e&&n.toLowerCase()==="context-fill")return e.contextFill||new pu("rgb(0,0,0)");var i=/\s*rgba\(((?:[^,\)]*,){3}[^,\)]*)\)\s*/.exec(n);if(i){var r=Vh(i[1]),s=new pu("rgb("+r.slice(0,3).join(",")+")");return s.a=r[3],s}return new pu(n)}var cA={"sans-serif":"helvetica",verdana:"helvetica",arial:"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",serif:"times",cursive:"times",fantasy:"times"},cT,lEe=(cT=Di.version.split("."),parseFloat(cT[0])===2&&parseFloat(cT[1])===3);function uG(n,e){return lEe?e==400?n=="italic"?"italic":"normal":e==700&&n!=="italic"?"bold":n+""+e:e==400||e==="normal"?n==="italic"?"italic":"normal":e!=700&&e!=="bold"||n!=="normal"?(e==700?"bold":e)+""+n:"bold"}function sF(n,e){if(Un(e.element,n.styleSheets,"display")==="none")return[0,0,0,0];var t=[];return e.children.forEach((function(i){var r=i.getBoundingBox(n);if(r[0]!==0||r[1]!==0||r[2]!==0||r[3]!==0){var s=i.computeNodeTransform(n);r[0]=r[0]*s.sx+s.tx,r[1]=r[1]*s.sy+s.ty,r[2]=r[2]*s.sx,r[3]=r[3]*s.sy,t=t.length===0?r:[Math.min(t[0],r[0]),Math.min(t[1],r[1]),Math.max(t[0]+t[2],r[0]+r[2])-Math.min(t[0],r[0]),Math.max(t[1]+t[3],r[1]+r[3])-Math.min(t[1],r[1])]}})),t.length===0?[0,0,0,0]:t}function nw(n,e){var t=parseFloat,i=t(n.getAttribute("x1"))||t(Un(n,e.styleSheets,"x"))||t(Un(n,e.styleSheets,"cx"))-t(Un(n,e.styleSheets,"r"))||0,r=t(n.getAttribute("x2"))||i+t(Un(n,e.styleSheets,"width"))||t(Un(n,e.styleSheets,"cx"))+t(Un(n,e.styleSheets,"r"))||0,s=t(n.getAttribute("y1"))||t(Un(n,e.styleSheets,"y"))||t(Un(n,e.styleSheets,"cy"))-t(Un(n,e.styleSheets,"r"))||0,o=t(n.getAttribute("y2"))||s+t(Un(n,e.styleSheets,"height"))||t(Un(n,e.styleSheets,"cy"))+t(Un(n,e.styleSheets,"r"))||0;return[Math.min(i,r),Math.min(s,o),Math.max(i,r)-Math.min(i,r),Math.max(s,o)-Math.min(s,o)]}function iw(n,e,t,i,r,s,o,a){a===void 0&&(a=!1);var c,h,u=e[0],d=e[1],f=e[2],A=e[3],g=r/f,p=s/A,y=n.getAttribute("preserveAspectRatio");if(y){var v=y.split(" ");v[0]==="defer"&&(v=v.slice(1)),c=v[0],h=v[1]||"meet"}else c="xMidYMid",h="meet";if(c!=="none"&&(h==="meet"?g=p=Math.min(g,p):h==="slice"&&(g=p=Math.max(g,p))),a)return o.pdf.Matrix(g,0,0,p,0,0);var m=t-u*g,w=i-d*p;c.indexOf("xMid")>=0?m+=(r-f*g)/2:c.indexOf("xMax")>=0&&(m+=r-f*g),c.indexOf("YMid")>=0?w+=(s-A*p)/2:c.indexOf("YMax")>=0&&(w+=s-A*p);var x=o.pdf.Matrix(1,0,0,1,m,w),T=o.pdf.Matrix(g,0,0,p,0,0);return o.pdf.matrixMult(T,x)}function z5(n,e){if(!n||n==="none")return e.pdf.unitMatrix;for(var t,i,r=/^[\s,]*matrix\(([^)]+)\)\s*/,s=/^[\s,]*translate\(([^)]+)\)\s*/,o=/^[\s,]*rotate\(([^)]+)\)\s*/,a=/^[\s,]*scale\(([^)]+)\)\s*/,c=/^[\s,]*skewX\(([^)]+)\)\s*/,h=/^[\s,]*skewY\(([^)]+)\)\s*/,u=e.pdf.unitMatrix;n.length>0&&n.length!==i;){i=n.length;var d=r.exec(n);if(d&&(t=Vh(d[1]),u=e.pdf.matrixMult(e.pdf.Matrix(t[0],t[1],t[2],t[3],t[4],t[5]),u),n=n.substr(d[0].length)),d=o.exec(n)){t=Vh(d[1]);var f=Math.PI*t[0]/180;if(u=e.pdf.matrixMult(e.pdf.Matrix(Math.cos(f),Math.sin(f),-Math.sin(f),Math.cos(f),0,0),u),t[1]||t[2]){var A=e.pdf.Matrix(1,0,0,1,t[1],t[2]),g=e.pdf.Matrix(1,0,0,1,-t[1],-t[2]);u=e.pdf.matrixMult(g,e.pdf.matrixMult(u,A))}n=n.substr(d[0].length)}(d=s.exec(n))&&(t=Vh(d[1]),u=e.pdf.matrixMult(e.pdf.Matrix(1,0,0,1,t[0],t[1]||0),u),n=n.substr(d[0].length)),(d=a.exec(n))&&((t=Vh(d[1]))[1]||(t[1]=t[0]),u=e.pdf.matrixMult(e.pdf.Matrix(t[0],0,0,t[1],0,0),u),n=n.substr(d[0].length)),(d=c.exec(n))&&(t=parseFloat(d[1]),t*=Math.PI/180,u=e.pdf.matrixMult(e.pdf.Matrix(1,0,Math.tan(t),1,0,0),u),n=n.substr(d[0].length)),(d=h.exec(n))&&(t=parseFloat(d[1]),t*=Math.PI/180,u=e.pdf.matrixMult(e.pdf.Matrix(1,Math.tan(t),0,1,0,0),u),n=n.substr(d[0].length))}return u}var oF=(function(){function n(e,t){this.element=e,this.children=t,this.parent=null}return n.prototype.setParent=function(e){this.parent=e},n.prototype.getParent=function(){return this.parent},n.prototype.getBoundingBox=function(e){return Un(this.element,e.styleSheets,"display")==="none"?[0,0,0,0]:this.getBoundingBoxCore(e)},n.prototype.computeNodeTransform=function(e){var t=this.computeNodeTransformCore(e),i=Un(this.element,e.styleSheets,"transform");return i?e.pdf.matrixMult(t,z5(i,e)):t},n})(),rw=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return Hs(e,n),e.prototype.render=function(t){return Promise.resolve()},e.prototype.getBoundingBoxCore=function(t){return[]},e.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},e})(oF),dG=(function(n){function e(t,i,r){var s=n.call(this,i,r)||this;return s.pdfGradientType=t,s.contextColor=void 0,s}return Hs(e,n),e.prototype.apply=function(t){return qs(this,void 0,void 0,(function(){var i,r,s,o,a,c;return Ys(this,(function(h){return(i=this.element.getAttribute("id"))?(r=this.getStops(t.styleSheets),s=0,o=!1,r.forEach((function(u){var d=u.opacity;d&&d!==1&&(s+=d,o=!0)})),o&&(a=new gg({opacity:s/r.length})),c=new gf(this.pdfGradientType,this.getCoordinates(),r,a),t.pdf.addShadingPattern(i,c),[2]):[2]}))}))},e.prototype.getStops=function(t){var i=this;if(this.stops)return this.stops;if(this.contextColor===void 0){this.contextColor=null;for(var r=this;r;){var s=Un(r.element,t,"color");if(s){this.contextColor=hm(s,null);break}r=r.getParent()}}var o=[];return this.children.forEach((function(a){if(a.element.tagName.toLowerCase()==="stop"){var c=Un(a.element,t,"color"),h=hm(Un(a.element,t,"stop-color")||"",c?{color:hm(c,null)}:{color:i.contextColor}),u=parseFloat(Un(a.element,t,"stop-opacity")||"1");o.push({offset:e.parseGradientOffset(a.element.getAttribute("offset")||"0"),color:[h.r,h.g,h.b],opacity:u})}})),this.stops=o},e.prototype.getBoundingBoxCore=function(t){return nw(this.element,t)},e.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},e.prototype.isVisible=function(t,i){return ip(this,t,i)},e.parseGradientOffset=function(t){var i=parseFloat(t);return!isNaN(i)&&t.indexOf("%")>=0?i/100:i},e})(rw),AG=(function(n){function e(t,i){return n.call(this,"axial",t,i)||this}return Hs(e,n),e.prototype.getCoordinates=function(){return[parseFloat(this.element.getAttribute("x1")||"0"),parseFloat(this.element.getAttribute("y1")||"0"),parseFloat(this.element.getAttribute("x2")||"1"),parseFloat(this.element.getAttribute("y2")||"0")]},e})(dG),fG=(function(n){function e(t,i){return n.call(this,"radial",t,i)||this}return Hs(e,n),e.prototype.getCoordinates=function(){var t=this.element.getAttribute("cx"),i=this.element.getAttribute("cy"),r=this.element.getAttribute("fx"),s=this.element.getAttribute("fy");return[parseFloat(r||t||"0.5"),parseFloat(s||i||"0.5"),0,parseFloat(t||"0.5"),parseFloat(i||"0.5"),parseFloat(this.element.getAttribute("r")||"0.5")]},e})(dG),cEe=(function(){function n(e,t){this.key=e,this.gradient=t}return n.prototype.getFillData=function(e,t){return qs(this,void 0,void 0,(function(){var i,r,s;return Ys(this,(function(o){switch(o.label){case 0:return[4,t.refsHandler.getRendered(this.key,null,(function(a){return a.apply(new np(t.pdf,{refsHandler:t.refsHandler,textMeasure:t.textMeasure,styleSheets:t.styleSheets,viewport:t.viewport,svg2pdfParameters:t.svg2pdfParameters}))}))];case 1:return o.sent(),this.gradient.element.hasAttribute("gradientUnits")&&this.gradient.element.getAttribute("gradientUnits").toLowerCase()!=="objectboundingbox"?i=t.pdf.unitMatrix:(r=e.getBoundingBox(t),i=t.pdf.Matrix(r[2],0,0,r[3],r[0],r[1])),s=z5(Un(this.gradient.element,t.styleSheets,"gradientTransform","transform"),t),[2,{key:this.key,matrix:t.pdf.matrixMult(s,i)}]}}))}))},n})(),pG=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return Hs(e,n),e.prototype.apply=function(t){return qs(this,void 0,void 0,(function(){var i,r,s,o,a;return Ys(this,(function(c){switch(c.label){case 0:if(!(i=this.element.getAttribute("id")))return[2];r=this.getBoundingBox(t),s=new Qp([r[0],r[1],r[0]+r[2],r[1]+r[3]],r[2],r[3]),t.pdf.beginTilingPattern(s),o=0,a=this.children,c.label=1;case 1:return o<a.length?[4,a[o].render(new np(t.pdf,{attributeState:t.attributeState,refsHandler:t.refsHandler,styleSheets:t.styleSheets,viewport:t.viewport,svg2pdfParameters:t.svg2pdfParameters,textMeasure:t.textMeasure}))]:[3,4];case 2:c.sent(),c.label=3;case 3:return o++,[3,1];case 4:return t.pdf.endTilingPattern(i,s),[2]}}))}))},e.prototype.getBoundingBoxCore=function(t){return nw(this.element,t)},e.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},e.prototype.isVisible=function(t,i){return ip(this,t,i)},e})(rw),hEe=(function(){function n(e,t){this.key=e,this.pattern=t}return n.prototype.getFillData=function(e,t){return qs(this,void 0,void 0,(function(){var i,r,s,o,a,c,h,u,d,f,A,g;return Ys(this,(function(p){switch(p.label){case 0:return[4,t.refsHandler.getRendered(this.key,null,(function(y){return y.apply(new np(t.pdf,{refsHandler:t.refsHandler,textMeasure:t.textMeasure,styleSheets:t.styleSheets,viewport:t.viewport,svg2pdfParameters:t.svg2pdfParameters}))}))];case 1:return p.sent(),i={key:this.key,boundingBox:void 0,xStep:0,yStep:0,matrix:void 0},s=t.pdf.unitMatrix,this.pattern.element.hasAttribute("patternUnits")&&this.pattern.element.getAttribute("patternUnits").toLowerCase()!=="objectboundingbox"||(r=e.getBoundingBox(t),s=t.pdf.Matrix(1,0,0,1,r[0],r[1]),a=this.pattern.getBoundingBox(t),c=a[0]*r[0]||0,h=a[1]*r[1]||0,u=a[2]*r[2]||0,d=a[3]*r[3]||0,i.boundingBox=[c,h,c+u,h+d],i.xStep=u,i.yStep=d),o=t.pdf.unitMatrix,this.pattern.element.hasAttribute("patternContentUnits")&&this.pattern.element.getAttribute("patternContentUnits").toLowerCase()==="objectboundingbox"&&(r||(r=e.getBoundingBox(t)),o=t.pdf.Matrix(r[2],0,0,r[3],0,0),a=i.boundingBox||this.pattern.getBoundingBox(t),c=a[0]/r[0]||0,h=a[1]/r[1]||0,u=a[2]/r[2]||0,d=a[3]/r[3]||0,i.boundingBox=[c,h,c+u,h+d],i.xStep=u,i.yStep=d),f=t.pdf.unitMatrix,(A=Un(this.pattern.element,t.styleSheets,"patternTransform","transform"))&&(f=z5(A,t)),g=o,g=t.pdf.matrixMult(g,s),g=t.pdf.matrixMult(g,f),g=t.pdf.matrixMult(g,t.transform),i.matrix=g,[2,i]}}))}))},n})();function uEe(n,e){var t=rF.exec(n);if(t){var i=t[1],r=e.refsHandler.get(i);return r&&(r instanceof AG||r instanceof fG)?(function(o,a,c){var h=a.getStops(c.styleSheets);if(h.length===0)return null;if(h.length===1){var u=h[0].color,d=new pu;return d.ok=!0,d.r=u[0],d.g=u[1],d.b=u[2],d.a=h[0].opacity,new Il(d)}return new cEe(o,a)})(i,r,e):r&&r instanceof pG?new hEe(i,r):new Il(new pu("rgb(0, 0, 0)"))}var s=hm(n,e.attributeState);return s.ok?new Il(s):null}function aF(n,e,t){var i=t||e.element,r=Un(i,n.styleSheets,"color");if(r){var s=hm(r,n.attributeState);s.ok?n.attributeState.color=s:n.attributeState.color=new pu("rgb(0,0,0)")}var o=Un(i,n.styleSheets,"visibility");o&&(n.attributeState.visibility=o);var a=Un(i,n.styleSheets,"fill");a&&(n.attributeState.fill=uEe(a,n));var c=Un(i,n.styleSheets,"fill-opacity");c&&(n.attributeState.fillOpacity=parseFloat(c));var h=Un(i,n.styleSheets,"stroke-opacity");h&&(n.attributeState.strokeOpacity=parseFloat(h));var u=Un(i,n.styleSheets,"opacity");u&&(n.attributeState.opacity=parseFloat(u));var d=Un(i,n.styleSheets,"stroke-width");d!==void 0&&d!==""&&(n.attributeState.strokeWidth=Math.abs(parseFloat(d)));var f=Un(i,n.styleSheets,"stroke");if(f)if(f==="none")n.attributeState.stroke=null;else{var A=hm(f,n.attributeState);A.ok&&(n.attributeState.stroke=new Il(A))}f&&n.attributeState.stroke instanceof Il&&(n.attributeState.contextStroke=n.attributeState.stroke.color),a&&n.attributeState.fill instanceof Il&&(n.attributeState.contextFill=n.attributeState.fill.color);var g=Un(i,n.styleSheets,"stroke-linecap");g&&(n.attributeState.strokeLinecap=g);var p=Un(i,n.styleSheets,"stroke-linejoin");p&&(n.attributeState.strokeLinejoin=p);var y=Un(i,n.styleSheets,"stroke-dasharray");if(y){var v=parseInt(Un(i,n.styleSheets,"stroke-dashoffset")||"0");n.attributeState.strokeDasharray=Vh(y),n.attributeState.strokeDashoffset=v}var m=Un(i,n.styleSheets,"stroke-miterlimit");m!==void 0&&m!==""&&(n.attributeState.strokeMiterlimit=parseFloat(m));var w=i.getAttribute("xml:space");w&&(n.attributeState.xmlSpace=w);var x=Un(i,n.styleSheets,"font-weight");x&&(n.attributeState.fontWeight=x);var T=Un(i,n.styleSheets,"font-style");T&&(n.attributeState.fontStyle=T);var j=Un(i,n.styleSheets,"font-family");if(j){var D=qBe.parse(j);n.attributeState.fontFamily=(function(E,V,K){var P=uG(E.fontStyle,E.fontWeight),M=K.pdf.getFontList(),X="";return V.some((function(Z){var Q=M[Z];return Q&&Q.indexOf(P)>=0?(X=Z,!0):(Z=Z.toLowerCase(),!!cA.hasOwnProperty(Z)&&(X=Z,!0))}))||(X="times"),X})(n.attributeState,D,n)}var b=Un(i,n.styleSheets,"font-size");if(b){var _=n.pdf.getFontSize();n.attributeState.fontSize=tA(b,_)}var I=Un(i,n.styleSheets,"vertical-align")||Un(i,n.styleSheets,"alignment-baseline");if(I){var S=I.match(/(baseline|text-bottom|alphabetic|ideographic|middle|central|mathematical|text-top|bottom|center|top|hanging)/);S&&(n.attributeState.alignmentBaseline=S[0])}var F=Un(i,n.styleSheets,"text-anchor");F&&(n.attributeState.textAnchor=F);var B=Un(i,n.styleSheets,"fill-rule");B&&(n.attributeState.fillRule=B)}function lF(n,e,t){var i=1,r=1;i*=n.attributeState.fillOpacity,i*=n.attributeState.opacity,n.attributeState.fill instanceof Il&&n.attributeState.fill.color.a!==void 0&&(i*=n.attributeState.fill.color.a),r*=n.attributeState.strokeOpacity,r*=n.attributeState.opacity,n.attributeState.stroke instanceof Il&&n.attributeState.stroke.color.a!==void 0&&(r*=n.attributeState.stroke.color.a);var s,o,a=i<1,c=r<1;if(Vf(t,"use")?(a=!0,c=!0,i*=n.attributeState.fill?1:0,r*=n.attributeState.stroke?1:0):n.withinUse&&(n.attributeState.fill!==e.attributeState.fill?(a=!0,i*=n.attributeState.fill?1:0):a&&!n.attributeState.fill&&(i=0),n.attributeState.stroke!==e.attributeState.stroke?(c=!0,r*=n.attributeState.stroke?1:0):c&&!n.attributeState.stroke&&(r=0)),a||c){var h={};a&&(h.opacity=i),c&&(h["stroke-opacity"]=r),n.pdf.setGState(new gg(h))}if(n.attributeState.fill&&n.attributeState.fill!==e.attributeState.fill&&n.attributeState.fill instanceof Il&&n.attributeState.fill.color.ok&&!Vf(t,"text")&&n.pdf.setFillColor(n.attributeState.fill.color.r,n.attributeState.fill.color.g,n.attributeState.fill.color.b),n.attributeState.strokeWidth!==e.attributeState.strokeWidth&&n.pdf.setLineWidth(n.attributeState.strokeWidth),n.attributeState.stroke!==e.attributeState.stroke&&n.attributeState.stroke instanceof Il&&n.pdf.setDrawColor(n.attributeState.stroke.color.r,n.attributeState.stroke.color.g,n.attributeState.stroke.color.b),n.attributeState.strokeLinecap!==e.attributeState.strokeLinecap&&n.pdf.setLineCap(n.attributeState.strokeLinecap),n.attributeState.strokeLinejoin!==e.attributeState.strokeLinejoin&&n.pdf.setLineJoin(n.attributeState.strokeLinejoin),n.attributeState.strokeDasharray===e.attributeState.strokeDasharray&&n.attributeState.strokeDashoffset===e.attributeState.strokeDashoffset||!n.attributeState.strokeDasharray||n.pdf.setLineDashPattern(n.attributeState.strokeDasharray,n.attributeState.strokeDashoffset),n.attributeState.strokeMiterlimit!==e.attributeState.strokeMiterlimit&&n.pdf.setLineMiterLimit(n.attributeState.strokeMiterlimit),n.attributeState.fontFamily!==e.attributeState.fontFamily&&(s=cA.hasOwnProperty(n.attributeState.fontFamily)?cA[n.attributeState.fontFamily]:n.attributeState.fontFamily),n.attributeState.fill&&n.attributeState.fill!==e.attributeState.fill&&n.attributeState.fill instanceof Il&&n.attributeState.fill.color.ok){var u=n.attributeState.fill.color;n.pdf.setTextColor(u.r,u.g,u.b)}n.attributeState.fontWeight===e.attributeState.fontWeight&&n.attributeState.fontStyle===e.attributeState.fontStyle||(o=uG(n.attributeState.fontStyle,n.attributeState.fontWeight)),s===void 0&&o===void 0||(s===void 0&&(s=cA.hasOwnProperty(n.attributeState.fontFamily)?cA[n.attributeState.fontFamily]:n.attributeState.fontFamily),n.pdf.setFont(s,o)),n.attributeState.fontSize!==e.attributeState.fontSize&&n.pdf.setFontSize(n.attributeState.fontSize*n.pdf.internal.scaleFactor)}function gG(n,e,t){var i=rF.exec(n);if(i){var r=i[1];return t.refsHandler.get(r)||void 0}}function mG(n,e,t){return qs(this,void 0,void 0,(function(){var i,r;return Ys(this,(function(s){switch(s.label){case 0:return i=t.clone(),e.element.hasAttribute("clipPathUnits")&&e.element.getAttribute("clipPathUnits").toLowerCase()==="objectboundingbox"&&(r=n.getBoundingBox(t),i.transform=t.pdf.matrixMult(t.pdf.Matrix(r[2],0,0,r[3],r[0],r[1]),t.transform)),[4,e.apply(i)];case 1:return s.sent(),[2]}}))}))}var yG=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return Hs(e,n),e.prototype.render=function(t){return qs(this,void 0,void 0,(function(){var i,r,s,o;return Ys(this,(function(a){switch(a.label){case 0:return this.isVisible(t.attributeState.visibility!=="hidden",t)?((i=t.clone()).transform=i.pdf.matrixMult(this.computeNodeTransform(i),t.transform),aF(i,this),r=Un(this.element,i.styleSheets,"clip-path"),(s=r&&r!=="none")?(o=gG(r,0,i))?o.isVisible(!0,i)?(i.pdf.saveGraphicsState(),[4,mG(this,o,i)]):[3,2]:[3,4]:[3,5]):[2];case 1:return a.sent(),[3,3];case 2:return[2];case 3:return[3,5];case 4:s=!1,a.label=5;case 5:return i.withinClipPath||i.pdf.saveGraphicsState(),lF(i,t,this.element),[4,this.renderCore(i)];case 6:return a.sent(),i.withinClipPath||i.pdf.restoreGraphicsState(),s&&i.pdf.restoreGraphicsState(),[2]}}))}))},e})(oF),G5=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return Hs(e,n),e})(yG),sw=(function(n){function e(t,i,r){var s=n.call(this,i,r)||this;return s.cachedPath=null,s.hasMarkers=t,s}return Hs(e,n),e.prototype.renderCore=function(t){return qs(this,void 0,void 0,(function(){var i;return Ys(this,(function(r){switch(r.label){case 0:return(i=this.getCachedPath(t))===null||i.segments.length===0?[2]:(t.withinClipPath?i.transform(t.transform):t.pdf.setCurrentTransformationMatrix(t.transform),i.draw(t),[4,this.fillOrStroke(t)]);case 1:return r.sent(),this.hasMarkers?[4,this.drawMarkers(t,i)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},e.prototype.getCachedPath=function(t){return this.cachedPath||(this.cachedPath=this.getPath(t))},e.prototype.drawMarkers=function(t,i){return qs(this,void 0,void 0,(function(){return Ys(this,(function(r){switch(r.label){case 0:return[4,this.getMarkers(i,t).draw(t.clone({transform:t.pdf.unitMatrix}))];case 1:return r.sent(),[2]}}))}))},e.prototype.fillOrStroke=function(t){return qs(this,void 0,void 0,(function(){var i,r,s,o,a;return Ys(this,(function(c){switch(c.label){case 0:return t.withinClipPath?[2]:(i=t.attributeState.fill,r=t.attributeState.stroke&&t.attributeState.strokeWidth!==0,i?[4,i.getFillData(this,t)]:[3,2]);case 1:return o=c.sent(),[3,3];case 2:o=void 0,c.label=3;case 3:return s=o,a=t.attributeState.fillRule==="evenodd",i&&r||t.withinUse?a?t.pdf.fillStrokeEvenOdd(s):t.pdf.fillStroke(s):i?a?t.pdf.fillEvenOdd(s):t.pdf.fill(s):r?t.pdf.stroke():t.pdf.discardPath(),[2]}}))}))},e.prototype.getBoundingBoxCore=function(t){var i=this.getCachedPath(t);if(!i||!i.segments.length)return[0,0,0,0];for(var r=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY,c=0,h=0,u=0;u<i.segments.length;u++){var d=i.segments[u];(d instanceof tl||d instanceof mf||d instanceof id)&&(c=d.x,h=d.y),d instanceof id?(r=Math.min(r,c,d.x1,d.x2,d.x),o=Math.max(o,c,d.x1,d.x2,d.x),s=Math.min(s,h,d.y1,d.y2,d.y),a=Math.max(a,h,d.y1,d.y2,d.y)):(r=Math.min(r,c),o=Math.max(o,c),s=Math.min(s,h),a=Math.max(a,h))}return[r,s,o-r,a-s]},e.prototype.getMarkers=function(t,i){var r=Un(this.element,i.styleSheets,"marker-start"),s=Un(this.element,i.styleSheets,"marker-mid"),o=Un(this.element,i.styleSheets,"marker-end"),a=new oEe;if(r||s||o){o&&(o=hT(o)),r&&(r=hT(r)),s&&(s=hT(s));for(var c=t.segments,h=[1,0],u=void 0,d=!1,f=[1,0],A=!1,g=function(y){var v=c[y],m=r&&(y===1||!(c[y]instanceof tl)&&c[y-1]instanceof tl);m&&c.forEach((function(b,_){if(!A&&b instanceof c6&&_>y){var I=c[_-1];A=(I instanceof tl||I instanceof mf||I instanceof id)&&I}}));var w=o&&(y===c.length-1||!(c[y]instanceof tl)&&c[y+1]instanceof tl),x=s&&y>0&&!(y===1&&c[y-1]instanceof tl),T=c[y-1]||null;if(T instanceof tl||T instanceof mf||T instanceof id)if(v instanceof id)m&&a.addMarker(new rf(r,[T.x,T.y],OM(A?[A.x,A.y]:[T.x,T.y],[v.x1,v.y1]),!0)),w&&a.addMarker(new rf(o,[v.x,v.y],OM([v.x2,v.y2],[v.x,v.y]))),x&&(u=m0([T.x,T.y],[v.x1,v.y1]),u=T instanceof tl?u:ny(tb(h,u)),a.addMarker(new rf(s,[T.x,T.y],Math.atan2(u[1],u[0])))),h=m0([v.x2,v.y2],[v.x,v.y]);else if(v instanceof tl||v instanceof mf){if(u=m0([T.x,T.y],[v.x,v.y]),m){var j=A?m0([A.x,A.y],[v.x,v.y]):u;a.addMarker(new rf(r,[T.x,T.y],Math.atan2(j[1],j[0]),!0))}w&&a.addMarker(new rf(o,[v.x,v.y],Math.atan2(u[1],u[0]))),x&&(j=v instanceof tl?h:T instanceof tl?u:ny(tb(h,u)),a.addMarker(new rf(s,[T.x,T.y],Math.atan2(j[1],j[0])))),h=u}else v instanceof c6&&(u=m0([T.x,T.y],[d.x,d.y]),x&&(j=T instanceof tl?u:ny(tb(h,u)),a.addMarker(new rf(s,[T.x,T.y],Math.atan2(j[1],j[0])))),w&&(j=ny(tb(u,f)),a.addMarker(new rf(o,[d.x,d.y],Math.atan2(j[1],j[0])))),h=u);else{d=v instanceof tl&&v;var D=c[y+1];(D instanceof tl||D instanceof mf||D instanceof id)&&(f=m0([d.x,d.y],[D.x,D.y]))}},p=0;p<c.length;p++)g(p)}return a.markers.forEach((function(y){var v=i.refsHandler.get(y.id);if(v){var m=Un(v.element,i.styleSheets,"orient");m!=null&&(y.isStartMarker&&m==="auto-start-reverse"&&(y.angle+=Math.PI),isNaN(Number(m))||(y.angle=parseFloat(m)/180*Math.PI))}})),a},e})(G5);function hT(n){var e=rF.exec(n);return e&&e[1]||void 0}var dEe=(function(n){function e(t,i){return n.call(this,!0,t,i)||this}return Hs(e,n),e.prototype.getPath=function(t){if(t.withinClipPath||t.attributeState.stroke===null)return null;var i=parseFloat(this.element.getAttribute("x1")||"0"),r=parseFloat(this.element.getAttribute("y1")||"0"),s=parseFloat(this.element.getAttribute("x2")||"0"),o=parseFloat(this.element.getAttribute("y2")||"0");return i||s||r||o?new Im().moveTo(i,r).lineTo(s,o):null},e.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},e.prototype.isVisible=function(t,i){return DA(this,t,i)},e.prototype.fillOrStroke=function(t){return qs(this,void 0,void 0,(function(){return Ys(this,(function(i){switch(i.label){case 0:return t.attributeState.fill=null,[4,n.prototype.fillOrStroke.call(this,t)];case 1:return i.sent(),[2]}}))}))},e})(sw),vG=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return Hs(e,n),e.prototype.apply=function(t){return qs(this,void 0,void 0,(function(){var i,r,s,o,a;return Ys(this,(function(c){switch(c.label){case 0:return this.isVisible(t.attributeState.visibility!=="hidden",t)?((i=t.clone()).transform=i.pdf.unitMatrix,aF(i,this),r=Un(this.element,i.styleSheets,"clip-path"),r&&r!=="none"&&(s=gG(r,0,i))?s.isVisible(!0,i)?[4,mG(this,s,i)]:[3,2]:[3,3]):[2];case 1:return c.sent(),[3,3];case 2:return[2];case 3:lF(i,t,this.element),o=0,a=this.children,c.label=4;case 4:return o<a.length?[4,a[o].render(i)]:[3,7];case 5:c.sent(),c.label=6;case 6:return o++,[3,4];case 7:return[2]}}))}))},e.prototype.getBoundingBoxCore=function(t){return sF(t,this)},e.prototype.isVisible=function(t,i){return ip(this,t,i)},e.prototype.computeNodeTransformCore=function(t){var i=parseFloat(Un(this.element,t.styleSheets,"x")||"0"),r=parseFloat(Un(this.element,t.styleSheets,"y")||"0"),s=this.element.getAttribute("viewBox");if(s){var o=Vh(s),a=parseFloat(Un(this.element,t.styleSheets,"width")||Un(this.element.ownerSVGElement,t.styleSheets,"width")||s[2]),c=parseFloat(Un(this.element,t.styleSheets,"height")||Un(this.element.ownerSVGElement,t.styleSheets,"height")||s[3]);return iw(this.element,o,i,r,a,c,t)}return t.pdf.Matrix(1,0,0,1,i,r)},e})(rw),X5=function(n,e){this.width=n,this.height=e},AEe=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return Hs(e,n),e.prototype.renderCore=function(t){return qs(this,void 0,void 0,(function(){var i,r,s,o,a,c,h,u,d,f,A,g,p;return Ys(this,(function(y){switch(y.label){case 0:return i=parseFloat,(r=this.element.getAttribute("href")||this.element.getAttribute("xlink:href"))?(s=r.substring(1),o=t.refsHandler.get(s),a=Vf(o.element,"symbol,svg")&&o.element.hasAttribute("viewBox"),c=i(Un(this.element,t.styleSheets,"x")||"0"),h=i(Un(this.element,t.styleSheets,"y")||"0"),u=void 0,d=void 0,a?(u=i(Un(this.element,t.styleSheets,"width")||Un(o.element,t.styleSheets,"width")||"0"),d=i(Un(this.element,t.styleSheets,"height")||Un(o.element,t.styleSheets,"height")||"0"),c+=i(Un(o.element,t.styleSheets,"x")||"0"),h+=i(Un(o.element,t.styleSheets,"y")||"0"),A=Vh(o.element.getAttribute("viewBox")),f=iw(o.element,A,c,h,u,d,t)):f=t.pdf.Matrix(1,0,0,1,c,h),g=km.getContextColors(t,!0),p=new np(t.pdf,{refsHandler:t.refsHandler,styleSheets:t.styleSheets,withinUse:!0,viewport:a?new X5(u,d):t.viewport,svg2pdfParameters:t.svg2pdfParameters,textMeasure:t.textMeasure,attributeState:Object.assign(km.default(),g)}),[4,t.refsHandler.getRendered(s,g,(function(v){return e.renderReferencedNode(v,s,p)}))]):[2];case 1:return y.sent(),t.pdf.saveGraphicsState(),t.pdf.setCurrentTransformationMatrix(t.transform),a&&Un(o.element,t.styleSheets,"overflow")!=="visible"&&(t.pdf.rect(c,h,u,d),t.pdf.clip().discardPath()),t.pdf.doFormObject(t.refsHandler.generateKey(s,g),f),t.pdf.restoreGraphicsState(),[2]}}))}))},e.renderReferencedNode=function(t,i,r){return qs(this,void 0,void 0,(function(){var s;return Ys(this,(function(o){switch(o.label){case 0:return s=[(s=t.getBoundingBox(r))[0]-.5*s[2],s[1]-.5*s[3],2*s[2],2*s[3]],r.pdf.beginFormObject(s[0],s[1],s[2],s[3],r.pdf.unitMatrix),t instanceof vG?[4,t.apply(r)]:[3,2];case 1:return o.sent(),[3,4];case 2:return[4,t.render(r)];case 3:o.sent(),o.label=4;case 4:return r.pdf.endFormObject(r.refsHandler.generateKey(i,r.attributeState)),[2]}}))}))},e.prototype.getBoundingBoxCore=function(t){return nw(this.element,t)},e.prototype.isVisible=function(t,i){return DA(this,t,i)},e.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},e})(G5),fEe=(function(n){function e(t,i){return n.call(this,!1,t,i)||this}return Hs(e,n),e.prototype.getPath=function(t){var i=parseFloat(Un(this.element,t.styleSheets,"width")||"0"),r=parseFloat(Un(this.element,t.styleSheets,"height")||"0");if(!isFinite(i)||i<=0||!isFinite(r)||r<=0)return null;var s=Un(this.element,t.styleSheets,"rx"),o=Un(this.element,t.styleSheets,"ry"),a=Math.min(parseFloat(s||o||"0"),.5*i),c=Math.min(parseFloat(o||s||"0"),.5*r),h=parseFloat(Un(this.element,t.styleSheets,"x")||"0"),u=parseFloat(Un(this.element,t.styleSheets,"y")||"0"),d=4/3*(Math.SQRT2-1);return a===0&&c===0?new Im().moveTo(h,u).lineTo(h+i,u).lineTo(h+i,u+r).lineTo(h,u+r).close():new Im().moveTo(h+=a,u).lineTo(h+=i-2*a,u).curveTo(h+a*d,u,h+a,u+(c-c*d),h+=a,u+=c).lineTo(h,u+=r-2*c).curveTo(h,u+c*d,h-a*d,u+c,h-=a,u+=c).lineTo(h+=2*a-i,u).curveTo(h-a*d,u,h-a,u-c*d,h-=a,u-=c).lineTo(h,u+=2*c-r).curveTo(h,u-c*d,h+a*d,u-c,h+=a,u-=c).close()},e.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},e.prototype.isVisible=function(t,i){return DA(this,t,i)},e})(sw),wG=(function(n){function e(t,i){return n.call(this,!1,t,i)||this}return Hs(e,n),e.prototype.getPath=function(t){var i=this.getRx(t),r=this.getRy(t);if(!isFinite(i)||r<=0||!isFinite(r)||r<=0)return null;var s=parseFloat(Un(this.element,t.styleSheets,"cx")||"0"),o=parseFloat(Un(this.element,t.styleSheets,"cy")||"0"),a=4/3*(Math.SQRT2-1)*i,c=4/3*(Math.SQRT2-1)*r;return new Im().moveTo(s+i,o).curveTo(s+i,o-c,s+a,o-r,s,o-r).curveTo(s-a,o-r,s-i,o-c,s-i,o).curveTo(s-i,o+c,s-a,o+r,s,o+r).curveTo(s+a,o+r,s+i,o+c,s+i,o)},e.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},e.prototype.isVisible=function(t,i){return DA(this,t,i)},e})(sw),pEe=(function(n){function e(t,i){return n.call(this,t,i)||this}return Hs(e,n),e.prototype.getRx=function(t){return parseFloat(Un(this.element,t.styleSheets,"rx")||"0")},e.prototype.getRy=function(t){return parseFloat(Un(this.element,t.styleSheets,"ry")||"0")},e})(wG);function xG(n){var e="invisible",t=n.stroke&&n.strokeWidth!==0,i=n.fill;return i&&t?e="fillThenStroke":i?e="fill":t&&(e="stroke"),e}function QM(n){return n.replace(/[\n\r]/g,"")}function $M(n){return n.replace(/[\t]/g," ")}function VM(n){return n.replace(/ +/g," ")}function zM(n,e,t){switch(Un(n,t.styleSheets,"text-transform")){case"uppercase":return e.toUpperCase();case"lowercase":return e.toLowerCase();default:return e}}var uT=(function(){function n(e,t,i,r){this.textNode=e,this.texts=[],this.textNodes=[],this.contexts=[],this.textAnchor=t,this.originX=i,this.originY=r,this.textMeasures=[]}return n.prototype.setX=function(e){this.originX=e},n.prototype.setY=function(e){this.originY=e},n.prototype.add=function(e,t,i){this.texts.push(t),this.textNodes.push(e),this.contexts.push(i)},n.prototype.rightTrimText=function(){for(var e=this.texts.length-1;e>=0;e--)if(this.contexts[e].attributeState.xmlSpace==="default"&&(this.texts[e]=this.texts[e].replace(/\s+$/,"")),this.texts[e].match(/[^\s]/))return!1;return!0},n.prototype.measureText=function(e){for(var t=0;t<this.texts.length;t++)this.textMeasures.push({width:e.textMeasure.measureTextWidth(this.texts[t],this.contexts[t].attributeState),length:this.texts[t].length})},n.prototype.put=function(e,t){var i,r,s,o,a=[],c=[],h=[],u=this.originX,d=this.originY,f=u,A=u;for(i=0;i<this.textNodes.length;i++){r=this.textNodes[i],s=this.contexts[i],o=this.textMeasures[i]||{width:e.textMeasure.measureTextWidth(this.texts[i],this.contexts[i].attributeState),length:this.texts[i].length};var g=u,p=d;if(r.nodeName!=="#text"&&!a.includes(r)){a.push(r);var y=n.resolveRelativePositionAttribute(r,"dx");y!==null&&(g+=tA(y,s.attributeState.fontSize));var v=n.resolveRelativePositionAttribute(r,"dy");v!==null&&(p+=tA(v,s.attributeState.fontSize))}c[i]=g,h[i]=p,u=g+o.width+o.length*t,d=p,f=Math.min(f,g),A=Math.max(A,u)}var m=0;switch(this.textAnchor){case"start":m=0;break;case"middle":m=(A-f)/2;break;case"end":m=A-f}for(i=0;i<this.textNodes.length;i++)if(r=this.textNodes[i],s=this.contexts[i],r.nodeName==="#text"||s.attributeState.visibility!=="hidden"){e.pdf.saveGraphicsState(),lF(s,e,r);var w=s.attributeState.alignmentBaseline,x=xG(s.attributeState);e.pdf.text(this.texts[i],c[i]-m,h[i],{baseline:hG(w),angle:e.transform,renderingMode:x==="fill"?void 0:x,charSpace:t===0?void 0:t}),e.pdf.restoreGraphicsState()}return[u,d]},n.resolveRelativePositionAttribute=function(e,t){for(var i,r=e;r&&Vf(r,"tspan");){if(r.hasAttribute(t))return r.getAttribute(t);if(((i=e.parentElement)===null||i===void 0?void 0:i.firstChild)!==e)break;r=r.parentElement}return null},n})(),gEe=(function(n){function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.boundingBox=[],t}return Hs(e,n),e.prototype.processTSpans=function(t,i,r,s,o,a){for(var c=r.pdf.getFontSize(),h=r.attributeState.xmlSpace,u=!0,d=!1,f=0;f<i.childNodes.length;f++){var A=i.childNodes[f];if(A.textContent){var g=A.textContent;if(A.nodeName==="#text"){var p=QM(g);p=$M(p),h==="default"&&(p=VM(p),u&&p.match(/^\s/)&&(d=!0),p.match(/[^\s]/)&&(u=!1),a.prevText.match(/\s$/)&&(p=p.replace(/^\s+/,"")));var y=zM(i,p,r);o.add(i,y,r),a.prevText=g,a.prevContext=r}else if(!Vf(A,"title")){if(Vf(A,"tspan")){var v=A,m=v.getAttribute("x");if(m!==null){var w=tA(m,c);o=new uT(this,Un(v,r.styleSheets,"text-anchor")||r.attributeState.textAnchor,w,0),s.push({type:"y",chunk:o})}var x=v.getAttribute("y");if(x!==null){var T=tA(x,c);o=new uT(this,Un(v,r.styleSheets,"text-anchor")||r.attributeState.textAnchor,0,T),s.push({type:"x",chunk:o})}var j=r.clone();aF(j,t,v),this.processTSpans(t,v,j,s,o,a)}}}}return d},e.prototype.renderCore=function(t){return qs(this,void 0,void 0,(function(){var i,r,s,o,a,c,h,u,d,f,A,g,p,y,v,m,w,x,T,j,D,b,_;return Ys(this,(function(I){if(t.pdf.saveGraphicsState(),i=0,r=0,s=1,o=t.pdf.getFontSize(),a=tA(this.element.getAttribute("x"),o),c=tA(this.element.getAttribute("y"),o),h=tA(this.element.getAttribute("dx"),o),u=tA(this.element.getAttribute("dy"),o),d=parseFloat(this.element.getAttribute("textLength")||"0"),f=t.attributeState.visibility,this.element.childElementCount===0)A=this.element.textContent||"",g=(function(S,F){return S=$M(S=QM(S)),F.xmlSpace==="default"&&(S=VM(S=S.trim())),S})(A,t.attributeState),p=zM(this.element,g,t),i=t.textMeasure.getTextOffset(p,t.attributeState),d>0&&(y=t.textMeasure.measureTextWidth(p,t.attributeState),t.attributeState.xmlSpace==="default"&&A.match(/^\s/)&&(s=0),r=(d-y)/(p.length-s)||0),f==="visible"&&(v=t.attributeState.alignmentBaseline,m=xG(t.attributeState),t.pdf.text(p,a+h-i,c+u,{baseline:hG(v),angle:t.transform,renderingMode:m==="fill"?void 0:m,charSpace:r===0?void 0:r}),this.boundingBox=[a+h-i,c+u+.1*o,t.textMeasure.measureTextWidth(p,t.attributeState),o]);else{for(w=[],x=new uT(this,t.attributeState.textAnchor,a+h,c+u),w.push({type:"",chunk:x}),T=this.processTSpans(this,this.element,t,w,x,{prevText:" ",prevContext:t}),s=T?0:1,j=!0,D=w.length-1;D>=0;D--)j&&(j=w[D].chunk.rightTrimText());d>0&&(b=0,_=0,w.forEach((function(S){var F=S.chunk;F.measureText(t),F.textMeasures.forEach((function(B){var E=B.width,V=B.length;b+=E,_+=V}))})),r=(d-b)/(_-s)),w.reduce((function(S,F){var B=F.type,E=F.chunk;return B==="x"?E.setX(S[0]):B==="y"&&E.setY(S[1]),E.put(t,r)}),[0,0])}return t.pdf.restoreGraphicsState(),[2]}))}))},e.prototype.isVisible=function(t,i){return ip(this,t,i)},e.prototype.getBoundingBoxCore=function(t){return this.boundingBox.length>0?this.boundingBox:nw(this.element,t)},e.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},e})(G5),mEe=(function(n){function e(t,i){return n.call(this,!0,t,i)||this}return Hs(e,n),e.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},e.prototype.isVisible=function(t,i){return DA(this,t,i)},e.prototype.getPath=function(t){var i,r,s=new rEe(Un(this.element,t.styleSheets,"d")||"").unshort().unarc().abs(),o=new Im;return s.iterate((function(a){switch(a[0]){case"M":o.moveTo(a[1],a[2]);break;case"L":o.lineTo(a[1],a[2]);break;case"H":o.lineTo(a[1],r);break;case"V":o.lineTo(i,a[1]);break;case"C":o.curveTo(a[1],a[2],a[3],a[4],a[5],a[6]);break;case"Q":var c=HM([i,r],[a[1],a[2]]),h=HM([a[3],a[4]],[a[1],a[2]]);o.curveTo(c[0],c[1],h[0],h[1],a[3],a[4]);break;case"Z":o.close()}switch(a[0]){case"M":case"L":i=a[1],r=a[2];break;case"H":i=a[1];break;case"V":r=a[1];break;case"C":i=a[5],r=a[6];break;case"Q":i=a[3],r=a[4]}})),o},e})(sw),yEe=/^\s*data:(([^/,;]+\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,((?:.|\s)*)$/i,vEe=(function(n){function e(t,i){var r=n.call(this,t,i)||this;return r.imageLoadingPromise=null,r.imageUrl=r.element.getAttribute("xlink:href")||r.element.getAttribute("href"),r.imageUrl&&(r.imageLoadingPromise=e.fetchImageData(r.imageUrl)),r}return Hs(e,n),e.prototype.renderCore=function(t){return qs(this,void 0,void 0,(function(){var i,r,s,o,a,c,h,u,d,f,A,g,p,y,v,m,w,x;return Ys(this,(function(T){switch(T.label){case 0:return this.imageLoadingPromise?(t.pdf.setCurrentTransformationMatrix(t.transform),i=parseFloat(Un(this.element,t.styleSheets,"width")||"0"),r=parseFloat(Un(this.element,t.styleSheets,"height")||"0"),s=parseFloat(Un(this.element,t.styleSheets,"x")||"0"),o=parseFloat(Un(this.element,t.styleSheets,"y")||"0"),!isFinite(i)||i<=0||!isFinite(r)||r<=0?[2]:[4,this.imageLoadingPromise]):[2];case 1:return a=T.sent(),c=a.data,(h=a.format).indexOf("svg")!==0?[3,3]:(u=new DOMParser,d=u.parseFromString(c,"image/svg+xml").firstElementChild,(!(f=this.element.getAttribute("preserveAspectRatio"))||f.indexOf("defer")<0||!d.getAttribute("preserveAspectRatio"))&&d.setAttribute("preserveAspectRatio",f||""),d.setAttribute("x",String(s)),d.setAttribute("y",String(o)),d.setAttribute("width",String(i)),d.setAttribute("height",String(r)),[4,cF(d,A={}).render(new np(t.pdf,{refsHandler:new cG(A),styleSheets:t.styleSheets,viewport:new X5(i,r),svg2pdfParameters:t.svg2pdfParameters,textMeasure:t.textMeasure}))]);case 2:return T.sent(),[2];case 3:g="data:image/".concat(h,";base64,").concat(btoa(c)),T.label=4;case 4:return T.trys.push([4,6,,7]),[4,e.getImageDimensions(g)];case 5:return p=T.sent(),y=p[0],v=p[1],m=[0,0,y,v],w=iw(this.element,m,s,o,i,r,t),t.pdf.setCurrentTransformationMatrix(w),t.pdf.addImage(g,"",0,0,y,v),[3,7];case 6:return x=T.sent(),typeof console=="object"&&console.warn&&console.warn("Could not load image ".concat(this.imageUrl,`. 
`).concat(x)),[3,7];case 7:return[2]}}))}))},e.prototype.getBoundingBoxCore=function(t){return nw(this.element,t)},e.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},e.prototype.isVisible=function(t,i){return DA(this,t,i)},e.fetchImageData=function(t){return qs(this,void 0,void 0,(function(){var i,r,s,o,a;return Ys(this,(function(c){switch(c.label){case 0:if(!(s=t.match(yEe)))return[3,1];if(o=s[2],(a=o.split("/"))[0]!=="image")throw new Error("Unsupported image URL: ".concat(t));return r=a[1],i=s[5],s[4]==="base64"?(i=i.replace(/\s/g,""),i=atob(i)):i=decodeURIComponent(i),[3,3];case 1:return[4,e.fetchImage(t)];case 2:i=c.sent(),r=t.substring(t.lastIndexOf(".")+1),c.label=3;case 3:return[2,{data:i,format:r}]}}))}))},e.fetchImage=function(t){return new Promise((function(i,r){var s=new XMLHttpRequest;s.open("GET",t,!0),s.responseType="arraybuffer",s.onload=function(){if(s.status!==200)throw new Error("Error ".concat(s.status,": Failed to load image '").concat(t,"'"));for(var o=new Uint8Array(s.response),a="",c=0;c<o.length;c++)a+=String.fromCharCode(o[c]);i(a)},s.onerror=r,s.onabort=r,s.send(null)}))},e.getMimeType=function(t){switch(t=t.toLowerCase()){case"jpg":case"jpeg":return"image/jpeg";default:return"image/".concat(t)}},e.getImageDimensions=function(t){return new Promise((function(i,r){var s=new Image;s.onload=function(){i([s.width,s.height])},s.onerror=r,s.src=t}))},e})(G5),bG=(function(n){function e(t,i,r){var s=n.call(this,!0,i,r)||this;return s.closed=t,s}return Hs(e,n),e.prototype.getPath=function(t){if(!this.element.hasAttribute("points")||this.element.getAttribute("points")==="")return null;var i=e.parsePointsString(this.element.getAttribute("points")),r=new Im;if(i.length<1)return r;r.moveTo(i[0][0],i[0][1]);for(var s=1;s<i.length;s++)r.lineTo(i[s][0],i[s][1]);return this.closed&&r.close(),r},e.prototype.isVisible=function(t,i){return DA(this,t,i)},e.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},e.parsePointsString=function(t){for(var i=Vh(t),r=[],s=0;s<i.length-1;s+=2){var o=i[s],a=i[s+1];r.push([o,a])}return r},e})(sw),wEe=(function(n){function e(t,i){return n.call(this,!0,t,i)||this}return Hs(e,n),e})(bG),xEe=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return Hs(e,n),e.prototype.render=function(t){return Promise.resolve()},e.prototype.getBoundingBoxCore=function(t){return[0,0,0,0]},e.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},e.prototype.isVisible=function(t,i){return DA(this,t,i)},e})(oF),bEe=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return Hs(e,n),e.prototype.apply=function(t){return qs(this,void 0,void 0,(function(){var i,r,s,o,a,c;return Ys(this,(function(h){switch(h.label){case 0:i=this.computeNodeTransform(t),r=this.getBoundingBox(t),t.pdf.beginFormObject(r[0],r[1],r[2],r[3],i),s=km.getContextColors(t),(function(u){var d=u.attributeState,f=u.pdf,A=1,g=1;A*=d.fillOpacity,A*=d.opacity,d.fill instanceof Il&&d.fill.color.a!==void 0&&(A*=d.fill.color.a),g*=d.strokeOpacity,g*=d.opacity,d.stroke instanceof Il&&d.stroke.color.a!==void 0&&(g*=d.stroke.color.a);var p,y={};if(y.opacity=A,y["stroke-opacity"]=g,f.setGState(new gg(y)),d.fill&&d.fill instanceof Il&&d.fill.color.ok?f.setFillColor(d.fill.color.r,d.fill.color.g,d.fill.color.b):f.setFillColor(0,0,0),f.setLineWidth(d.strokeWidth),d.stroke instanceof Il?f.setDrawColor(d.stroke.color.r,d.stroke.color.g,d.stroke.color.b):f.setDrawColor(0,0,0),f.setLineCap(d.strokeLinecap),f.setLineJoin(d.strokeLinejoin),d.strokeDasharray?f.setLineDashPattern(d.strokeDasharray,d.strokeDashoffset):f.setLineDashPattern([],0),f.setLineMiterLimit(d.strokeMiterlimit),p=cA.hasOwnProperty(d.fontFamily)?cA[d.fontFamily]:d.fontFamily,d.fill&&d.fill instanceof Il&&d.fill.color.ok){var v=d.fill.color;f.setTextColor(v.r,v.g,v.b)}else f.setTextColor(0,0,0);var m="";d.fontWeight==="bold"&&(m="bold"),d.fontStyle==="italic"&&(m+="italic"),m===""&&(m="normal"),p!==void 0||m!==void 0?(p===void 0&&(p=cA.hasOwnProperty(d.fontFamily)?cA[d.fontFamily]:d.fontFamily),f.setFont(p,m)):f.setFont("helvetica",m),f.setFontSize(d.fontSize*f.internal.scaleFactor)})(o=new np(t.pdf,{refsHandler:t.refsHandler,styleSheets:t.styleSheets,viewport:t.viewport,svg2pdfParameters:t.svg2pdfParameters,textMeasure:t.textMeasure,attributeState:Object.assign(km.default(),s)})),a=0,c=this.children,h.label=1;case 1:return a<c.length?[4,c[a].render(o)]:[3,4];case 2:h.sent(),h.label=3;case 3:return a++,[3,1];case 4:return t.pdf.endFormObject(o.refsHandler.generateKey(this.element.getAttribute("id"),s)),[2]}}))}))},e.prototype.getBoundingBoxCore=function(t){var i,r=this.element.getAttribute("viewBox");return r&&(i=Vh(r)),[i&&i[0]||0,i&&i[1]||0,i&&i[2]||parseFloat(this.element.getAttribute("markerWidth")||"3"),i&&i[3]||parseFloat(this.element.getAttribute("markerHeight")||"3")]},e.prototype.computeNodeTransformCore=function(t){var i,r=parseFloat(this.element.getAttribute("refX")||"0"),s=parseFloat(this.element.getAttribute("refY")||"0"),o=this.element.getAttribute("viewBox");if(o){var a=Vh(o);i=iw(this.element,a,0,0,parseFloat(this.element.getAttribute("markerWidth")||"3"),parseFloat(this.element.getAttribute("markerHeight")||"3"),t,!0),i=t.pdf.matrixMult(t.pdf.Matrix(1,0,0,1,-r,-s),i)}else i=t.pdf.Matrix(1,0,0,1,-r,-s);return i},e.prototype.isVisible=function(t,i){return ip(this,t,i)},e})(rw),_Ee=(function(n){function e(t,i){return n.call(this,t,i)||this}return Hs(e,n),e.prototype.getR=function(t){var i;return(i=this.r)!==null&&i!==void 0?i:this.r=parseFloat(Un(this.element,t.styleSheets,"r")||"0")},e.prototype.getRx=function(t){return this.getR(t)},e.prototype.getRy=function(t){return this.getR(t)},e})(wG),CEe=(function(n){function e(t,i){return n.call(this,!1,t,i)||this}return Hs(e,n),e})(bG),_G=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return Hs(e,n),e.prototype.renderCore=function(t){return qs(this,void 0,void 0,(function(){var i,r;return Ys(this,(function(s){switch(s.label){case 0:i=0,r=this.children,s.label=1;case 1:return i<r.length?[4,r[i].render(t)]:[3,4];case 2:s.sent(),s.label=3;case 3:return i++,[3,1];case 4:return[2]}}))}))},e.prototype.getBoundingBoxCore=function(t){return sF(t,this)},e})(yG),SEe=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return Hs(e,n),e.prototype.isVisible=function(t,i){return ip(this,t,i)},e.prototype.render=function(t){return qs(this,void 0,void 0,(function(){var i,r,s,o,a;return Ys(this,(function(c){switch(c.label){case 0:return this.isVisible(t.attributeState.visibility!=="hidden",t)?(i=this.getX(t),r=this.getY(t),s=this.getWidth(t),o=this.getHeight(t),t.pdf.saveGraphicsState(),a=t.transform,this.element.hasAttribute("transform")&&(a=t.pdf.matrixMult(z5(this.element.getAttribute("transform"),t),a)),t.pdf.setCurrentTransformationMatrix(a),t.withinUse||Un(this.element,t.styleSheets,"overflow")==="visible"||t.pdf.rect(i,r,s,o).clip().discardPath(),[4,n.prototype.render.call(this,t.clone({transform:t.pdf.unitMatrix,viewport:t.withinUse?t.viewport:new X5(s,o)}))]):[2];case 1:return c.sent(),t.pdf.restoreGraphicsState(),[2]}}))}))},e.prototype.computeNodeTransform=function(t){return this.computeNodeTransformCore(t)},e.prototype.computeNodeTransformCore=function(t){if(t.withinUse)return t.pdf.unitMatrix;var i,r=this.getX(t),s=this.getY(t),o=this.getViewBox();if(o){var a=this.getWidth(t),c=this.getHeight(t);i=iw(this.element,o,r,s,a,c,t)}else i=t.pdf.Matrix(1,0,0,1,r,s);return i},e.prototype.getWidth=function(t){if(this.width!==void 0)return this.width;var i,r,s=t.svg2pdfParameters;if(this.isOutermostSvg(t))if(s.width!=null)i=s.width;else if(r=Un(this.element,t.styleSheets,"width"))i=parseFloat(r);else{var o=this.getViewBox();if(o&&(s.height!=null||Un(this.element,t.styleSheets,"height"))){var a=o[2]/o[3];i=this.getHeight(t)*a}else i=Math.min(300,t.viewport.width,2*t.viewport.height)}else i=(r=Un(this.element,t.styleSheets,"width"))?parseFloat(r):t.viewport.width;return this.width=i},e.prototype.getHeight=function(t){if(this.height!==void 0)return this.height;var i,r,s=t.svg2pdfParameters;if(this.isOutermostSvg(t))if(s.height!=null)i=s.height;else if(r=Un(this.element,t.styleSheets,"height"))i=parseFloat(r);else{var o=this.getViewBox();if(o){var a=o[2]/o[3];i=this.getWidth(t)/a}else i=Math.min(150,t.viewport.width/2,t.viewport.height)}else i=(r=Un(this.element,t.styleSheets,"height"))?parseFloat(r):t.viewport.height;return this.height=i},e.prototype.getX=function(t){if(this.x!==void 0)return this.x;if(this.isOutermostSvg(t))return this.x=0;var i=Un(this.element,t.styleSheets,"x");return this.x=i?parseFloat(i):0},e.prototype.getY=function(t){if(this.y!==void 0)return this.y;if(this.isOutermostSvg(t))return this.y=0;var i=Un(this.element,t.styleSheets,"y");return this.y=i?parseFloat(i):0},e.prototype.getViewBox=function(){if(this.viewBox!==void 0)return this.viewBox;var t=this.element.getAttribute("viewBox");return this.viewBox=t?Vh(t):void 0},e.prototype.isOutermostSvg=function(t){return t.svg2pdfParameters.element===this.element},e})(_G),CG=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return Hs(e,n),e.prototype.isVisible=function(t,i){return ip(this,t,i)},e.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},e})(_G),TEe=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return Hs(e,n),e.prototype.renderCore=function(t){return qs(this,void 0,void 0,(function(){var i,r,s,o;return Ys(this,(function(a){switch(a.label){case 0:return[4,n.prototype.renderCore.call(this,t)];case 1:return a.sent(),(i=Un(this.element,t.styleSheets,"href"))&&(r=this.getBoundingBox(t),s=t.pdf.internal.scaleFactor,o=t.pdf.internal.pageSize.getHeight(),t.pdf.link(s*(r[0]*t.transform.sx+t.transform.tx),o-s*(r[1]*t.transform.sy+t.transform.ty),s*r[2],s*r[3],{url:i})),[2]}}))}))},e})(CG),BEe=(function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return Hs(e,n),e.prototype.apply=function(t){return qs(this,void 0,void 0,(function(){var i,r,s,o,a;return Ys(this,(function(c){switch(c.label){case 0:if(!this.isVisible(!0,t))return[2];i=t.pdf.matrixMult(this.computeNodeTransform(t),t.transform),t.pdf.setCurrentTransformationMatrix(i),r=0,s=this.children,c.label=1;case 1:return r<s.length?[4,s[r].render(new np(t.pdf,{refsHandler:t.refsHandler,styleSheets:t.styleSheets,viewport:t.viewport,withinClipPath:!0,svg2pdfParameters:t.svg2pdfParameters,textMeasure:t.textMeasure}))]:[3,4];case 2:c.sent(),c.label=3;case 3:return r++,[3,1];case 4:return o=this.children.length>0&&!!Un(this.children[0].element,t.styleSheets,"clip-rule"),a=o?this.getClipRuleAttr(this.children[0].element,t.styleSheets):this.getClipRuleAttr(this.element,t.styleSheets),t.pdf.clip(a).discardPath(),t.pdf.setCurrentTransformationMatrix(i.inversed()),[2]}}))}))},e.prototype.getBoundingBoxCore=function(t){return sF(t,this)},e.prototype.isVisible=function(t,i){return ip(this,t,i)},e.prototype.getClipRuleAttr=function(t,i){return Un(t,i,"clip-rule")==="evenodd"?"evenodd":void 0},e})(rw);function cF(n,e){var t,i=[];switch((function(s,o){for(var a=[],c=0;c<s.childNodes.length;c++){var h=s.childNodes[c];h.nodeName.charAt(0)!=="#"&&a.push(h)}for(c=0;c<a.length;c++)o(c,a[c])})(n,(function(s,o){return i.push(cF(o,e))})),n.tagName.toLowerCase()){case"a":t=new TEe(n,i);break;case"g":t=new CG(n,i);break;case"circle":t=new _Ee(n,i);break;case"clippath":t=new BEe(n,i);break;case"ellipse":t=new pEe(n,i);break;case"lineargradient":t=new AG(n,i);break;case"image":t=new vEe(n,i);break;case"line":t=new dEe(n,i);break;case"marker":t=new bEe(n,i);break;case"path":t=new mEe(n,i);break;case"pattern":t=new pG(n,i);break;case"polygon":t=new wEe(n,i);break;case"polyline":t=new CEe(n,i);break;case"radialgradient":t=new fG(n,i);break;case"rect":t=new fEe(n,i);break;case"svg":t=new SEe(n,i);break;case"symbol":t=new vG(n,i);break;case"text":t=new gEe(n,i);break;case"use":t=new AEe(n,i);break;default:t=new xEe(n,i)}if(e!=null&&t.element.hasAttribute("id")){var r=aG(t.element.id,{isIdentifier:!0});e[r]=e[r]||t}return t.children.forEach((function(s){return s.setParent(t)})),t}var EEe=(function(){function n(e,t){this.rootSvg=e,this.loadExternalSheets=t,this.styleSheets=[]}return n.prototype.load=function(){return qs(this,void 0,void 0,(function(){var e;return Ys(this,(function(t){switch(t.label){case 0:return[4,this.collectStyleSheetTexts()];case 1:return e=t.sent(),this.parseCssSheets(e),[2]}}))}))},n.prototype.collectStyleSheetTexts=function(){return qs(this,void 0,void 0,(function(){var e,t,i,r,s;return Ys(this,(function(o){switch(o.label){case 0:if(e=[],this.loadExternalSheets&&this.rootSvg.ownerDocument)for(r=0;r<this.rootSvg.ownerDocument.childNodes.length;r++)(t=this.rootSvg.ownerDocument.childNodes[r]).nodeName==="xml-stylesheet"&&typeof t.data=="string"&&e.push(n.loadSheet(t.data.match(/href=["'].*?["']/)[0].split("=")[1].slice(1,-1)));for(i=this.rootSvg.querySelectorAll("style,link"),r=0;r<i.length;r++)Vf(s=i[r],"style")?e.push(s.textContent):this.loadExternalSheets&&Vf(s,"link")&&s.getAttribute("rel")==="stylesheet"&&s.hasAttribute("href")&&e.push(n.loadSheet(s.getAttribute("href")));return[4,Promise.all(e)];case 1:return[2,o.sent().filter((function(a){return a!==null}))]}}))}))},n.prototype.parseCssSheets=function(e){for(var t=document.implementation.createHTMLDocument(""),i=0,r=e;i<r.length;i++){var s=r[i],o=t.createElement("style");o.textContent=s,t.body.appendChild(o);var a=o.sheet;if(a instanceof CSSStyleSheet){for(var c=a.cssRules.length-1;c>=0;c--){var h=a.cssRules[c];if(h instanceof CSSStyleRule){var u=h;if(u.selectorText.indexOf(",")>=0){a.deleteRule(c);for(var d=u.cssText.substring(u.selectorText.length),f=n.splitSelectorAtCommas(u.selectorText),A=0;A<f.length;A++)a.insertRule(f[A]+d,c+A)}}else a.deleteRule(c)}this.styleSheets.push(a)}}},n.splitSelectorAtCommas=function(e){for(var t,i=/,|["']/g,r=/[^\\]["]/g,s=/[^\\][']/g,o=[],a="initial",c=-1,h=r,u=0;u<e.length;)switch(a){case"initial":i.lastIndex=u,(t=i.exec(e))?(t[0]===","?(o.push(e.substring(c+1,i.lastIndex-1).trim()),c=i.lastIndex-1):(a="withinQuotes",h=t[0]==='"'?r:s),u=i.lastIndex):(o.push(e.substring(c+1).trim()),u=e.length);break;case"withinQuotes":h.lastIndex=u,(t=h.exec(e))&&(u=h.lastIndex,a="initial")}return o},n.loadSheet=function(e){return new Promise((function(t,i){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="text",r.onload=function(){r.status!==200&&i(new Error("Error ".concat(r.status,": Failed to load '").concat(e,"'"))),t(r.responseText)},r.onerror=i,r.onabort=i,r.send(null)})).catch((function(){return null}))},n.prototype.getPropertyValue=function(e,t){for(var i=[],r=0,s=this.styleSheets;r<s.length;r++)for(var o=s[r],a=0;a<o.cssRules.length;a++){var c=o.cssRules[a];c.style.getPropertyValue(t)&&e.matches(c.selectorText)&&i.push(c)}if(i.length!==0)return i.reduce((function(h,u){return f=u,((A=(d=h).style.getPropertyPriority(t))!==f.style.getPropertyPriority(t)?A==="important"?1:-1:sEe(d.selectorText,f.selectorText))===1?h:u;var d,f,A})).style.getPropertyValue(t)||void 0},n})(),kEe=(function(){function n(){this.measureMethods={}}return n.prototype.getTextOffset=function(e,t){var i=t.textAnchor;if(i==="start")return 0;var r=this.measureTextWidth(e,t),s=0;switch(i){case"end":s=r;break;case"middle":s=r/2}return s},n.prototype.measureTextWidth=function(e,t){if(e.length===0)return 0;var i=t.fontFamily;return this.getMeasureFunction(i).call(this,e,t.fontFamily,t.fontSize+"px",t.fontStyle,t.fontWeight)},n.prototype.getMeasurementTextNode=function(){if(!this.textMeasuringTextElement){this.textMeasuringTextElement=document.createElementNS(WM,"text");var e=document.createElementNS(WM,"svg");e.appendChild(this.textMeasuringTextElement),e.style.setProperty("position","absolute"),e.style.setProperty("visibility","hidden"),document.body.appendChild(e)}return this.textMeasuringTextElement},n.prototype.canvasTextMeasure=function(e,t,i,r,s){var o=document.createElement("canvas").getContext("2d");return o!=null?(o.font=[r,s,i,t].join(" "),o.measureText(e).width):0},n.prototype.svgTextMeasure=function(e,t,i,r,s,o){o===void 0&&(o=this.getMeasurementTextNode());var a=o;return a.setAttribute("font-family",t),a.setAttribute("font-size",i),a.setAttribute("font-style",r),a.setAttribute("font-weight",s),a.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),a.textContent=e,a.getBBox().width},n.prototype.getMeasureFunction=function(e){var t=this.measureMethods[e];if(!t){var i="16px",r="normal",s="normal",o=this.canvasTextMeasure(n.testString,e,i,r,s),a=this.svgTextMeasure(n.testString,e,i,r,s);t=Math.abs(o-a)<n.epsilon?this.canvasTextMeasure:this.svgTextMeasure,this.measureMethods[e]=t}return t},n.prototype.cleanupTextMeasuring=function(){if(this.textMeasuringTextElement){var e=this.textMeasuringTextElement.parentNode;e&&document.body.removeChild(e),this.textMeasuringTextElement=void 0}},n.testString=`abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789!"$%&/()=?'\\+*-_.:,;^}][{#~|<>`,n.epsilon=.1,n})();function IEe(n,e){return qs(this,arguments,void 0,(function(t,i,r){var s,o,a,c,h,u,d,f,A,g,p,y,v,m;return r===void 0&&(r={}),Ys(this,(function(w){switch(w.label){case 0:return s=(y=r.x)!==null&&y!==void 0?y:0,o=(v=r.y)!==null&&v!==void 0?v:0,a=(m=r.loadExternalStyleSheets)!==null&&m!==void 0&&m,h=new cG(c={}),[4,(u=new EEe(t,a)).load()];case 1:return w.sent(),d=new X5(i.internal.pageSize.getWidth(),i.internal.pageSize.getHeight()),f=gC(gC({},r),{element:t}),A=new kEe,g=new np(i,{refsHandler:h,styleSheets:u,viewport:d,svg2pdfParameters:f,textMeasure:A}),i.advancedAPI(),i.saveGraphicsState(),i.setCurrentTransformationMatrix(i.Matrix(1,0,0,1,s,o)),i.setLineWidth(g.attributeState.strokeWidth),p=g.attributeState.fill.color,i.setFillColor(p.r,p.g,p.b),i.setFont(g.attributeState.fontFamily),i.setFontSize(g.attributeState.fontSize*i.internal.scaleFactor),[4,cF(t,c).render(g)];case 2:return w.sent(),i.restoreGraphicsState(),i.compatAPI(),g.textMeasure.cleanupTextMeasuring(),[2,i]}}))}))}Di.API.svg=function(n,e){return e===void 0&&(e={}),IEe(n,this,e)};function bt(n,e,t){return(e=(function(i){var r=(function(s,o){if(typeof s!="object"||!s)return s;var a=s[Symbol.toPrimitive];if(a!==void 0){var c=a.call(s,o);if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(s)})(i,"string");return typeof r=="symbol"?r:r+""})(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function GM(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable}))),t.push.apply(t,i)}return t}function xt(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?GM(Object(t),!0).forEach((function(i){bt(n,i,t[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):GM(Object(t)).forEach((function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))}))}return n}function Bo(n,e){if(n==null)return{};var t,i,r=(function(o,a){if(o==null)return{};var c={};for(var h in o)if({}.hasOwnProperty.call(o,h)){if(a.indexOf(h)>=0)continue;c[h]=o[h]}return c})(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(i=0;i<s.length;i++)t=s[i],e.indexOf(t)>=0||{}.propertyIsEnumerable.call(n,t)&&(r[t]=n[t])}return r}function Id(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}class XM{constructor(){bt(this,"browserShadowBlurConstant",1),bt(this,"DPI",96),bt(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),bt(this,"perfLimitSizeTotal",2097152),bt(this,"maxCacheSideLimit",4096),bt(this,"minCacheSideLimit",256),bt(this,"disableStyleCopyPaste",!1),bt(this,"enableGLFiltering",!0),bt(this,"textureSize",4096),bt(this,"forceGLPutImageData",!1),bt(this,"cachesBoundsOfCurve",!1),bt(this,"fontPaths",{}),bt(this,"NUM_FRACTION_DIGITS",4)}}const ds=new class extends XM{constructor(n){super(),this.configure(n)}configure(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,n)}addFonts(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=xt(xt({},this.fontPaths),n)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach((n=>{delete this.fontPaths[n]}))}clearFonts(){this.fontPaths={}}restoreDefaults(n){const e=new XM,t=(n==null?void 0:n.reduce(((i,r)=>(i[r]=e[r],i)),{}))||e;this.configure(t)}},SA=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];return console[n]("fabric",...t)};class cd extends Error{constructor(e,t){super("fabric: ".concat(e),t)}}class hF extends cd{constructor(e){super("".concat(e," 'options.signal' is in 'aborted' state"))}}class FEe{}class DEe extends FEe{testPrecision(e,t){const i="precision ".concat(t,` float;
void main(){}`),r=e.createShader(e.FRAGMENT_SHADER);return!!r&&(e.shaderSource(r,i),e.compileShader(r),!!e.getShaderParameter(r,e.COMPILE_STATUS))}queryWebGL(e){const t=e.getContext("webgl");t&&(this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find((i=>this.testPrecision(t,i))),t.getExtension("WEBGL_lose_context").loseContext(),SA("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(e){return!!this.maxTextureSize&&this.maxTextureSize>=e}}const jEe={};let KM;const _d=()=>KM||(KM={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new DEe,dispose(){},copyPasteData:jEe}),Zm=()=>_d().document,Jm=()=>_d().window,SG=()=>{var n;return Math.max((n=ds.devicePixelRatio)!==null&&n!==void 0?n:Jm().devicePixelRatio,1)},My=new class{constructor(){bt(this,"charWidthsCache",{}),bt(this,"boundsOfCurveCache",{})}getFontCache(n){let{fontFamily:e,fontStyle:t,fontWeight:i}=n;e=e.toLowerCase(),this.charWidthsCache[e]||(this.charWidthsCache[e]={});const r=this.charWidthsCache[e],s="".concat(t.toLowerCase(),"_").concat((i+"").toLowerCase());return r[s]||(r[s]={}),r[s]}clearFontCache(n){(n=(n||"").toLowerCase())?this.charWidthsCache[n]&&delete this.charWidthsCache[n]:this.charWidthsCache={}}limitDimsByArea(n){const{perfLimitSizeTotal:e}=ds,t=Math.sqrt(e*n);return[Math.floor(t),Math.floor(e/t)]}},h6="6.7.1";function ng(){}const zf=Math.PI/2,TA=2*Math.PI,uF=Math.PI/180,vc=Object.freeze([1,0,0,1,0,0]),dF=16,sf=.4477152502,Br="center",Es="left",Hc="top",u6="bottom",la="right",mc="none",AF=/\r?\n/,TG="moving",K5="scaling",BG="rotating",fF="rotate",EG="skewing",mv="resizing",PEe="modifyPoly",NEe="modifyPath",mC="changed",q5="scale",wc="scaleX",Ah="scaleY",e1="skewX",t1="skewY",Sa="fill",yc="stroke",yC="modified",y0="json",dT="svg",bi=new class{constructor(){this[y0]=new Map,this[dT]=new Map}has(n){return this[y0].has(n)}getClass(n){const e=this[y0].get(n);if(!e)throw new cd("No class registered for ".concat(n));return e}setClass(n,e){e?this[y0].set(e,n):(this[y0].set(n.type,n),this[y0].set(n.type.toLowerCase(),n))}getSVGClass(n){return this[dT].get(n)}setSVGClass(n,e){this[dT].set(e??n.type.toLowerCase(),n)}},vC=new class extends Array{remove(n){const e=this.indexOf(n);e>-1&&this.splice(e,1)}cancelAll(){const n=this.splice(0);return n.forEach((e=>e.abort())),n}cancelByCanvas(n){if(!n)return[];const e=this.filter((t=>{var i;return t.target===n||typeof t.target=="object"&&((i=t.target)===null||i===void 0?void 0:i.canvas)===n}));return e.forEach((t=>t.abort())),e}cancelByTarget(n){if(!n)return[];const e=this.filter((t=>t.target===n));return e.forEach((t=>t.abort())),e}};class LEe{constructor(){bt(this,"__eventListeners",{})}on(e,t){if(this.__eventListeners||(this.__eventListeners={}),typeof e=="object")return Object.entries(e).forEach((i=>{let[r,s]=i;this.on(r,s)})),()=>this.off(e);if(t){const i=e;return this.__eventListeners[i]||(this.__eventListeners[i]=[]),this.__eventListeners[i].push(t),()=>this.off(i,t)}return()=>!1}once(e,t){if(typeof e=="object"){const i=[];return Object.entries(e).forEach((r=>{let[s,o]=r;i.push(this.once(s,o))})),()=>i.forEach((r=>r()))}if(t){const i=this.on(e,(function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];t.call(this,...s),i()}));return i}return()=>!1}_removeEventListener(e,t){if(this.__eventListeners[e])if(t){const i=this.__eventListeners[e],r=i.indexOf(t);r>-1&&i.splice(r,1)}else this.__eventListeners[e]=[]}off(e,t){if(this.__eventListeners)if(e===void 0)for(const i in this.__eventListeners)this._removeEventListener(i);else typeof e=="object"?Object.entries(e).forEach((i=>{let[r,s]=i;this._removeEventListener(r,s)})):this._removeEventListener(e,t)}fire(e,t){var i;if(!this.__eventListeners)return;const r=(i=this.__eventListeners[e])===null||i===void 0?void 0:i.concat();if(r)for(let s=0;s<r.length;s++)r[s].call(this,t||{})}}const Mp=(n,e)=>{const t=n.indexOf(e);return t!==-1&&n.splice(t,1),n},ju=n=>{if(n===0)return 1;switch(Math.abs(n)/zf){case 1:case 3:return 0;case 2:return-1}return Math.cos(n)},Pu=n=>{if(n===0)return 0;const e=n/zf,t=Math.sign(n);switch(e){case 1:return t;case 2:return 0;case 3:return-t}return Math.sin(n)};class Gt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof e=="object"?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t)}add(e){return new Gt(this.x+e.x,this.y+e.y)}addEquals(e){return this.x+=e.x,this.y+=e.y,this}scalarAdd(e){return new Gt(this.x+e,this.y+e)}scalarAddEquals(e){return this.x+=e,this.y+=e,this}subtract(e){return new Gt(this.x-e.x,this.y-e.y)}subtractEquals(e){return this.x-=e.x,this.y-=e.y,this}scalarSubtract(e){return new Gt(this.x-e,this.y-e)}scalarSubtractEquals(e){return this.x-=e,this.y-=e,this}multiply(e){return new Gt(this.x*e.x,this.y*e.y)}scalarMultiply(e){return new Gt(this.x*e,this.y*e)}scalarMultiplyEquals(e){return this.x*=e,this.y*=e,this}divide(e){return new Gt(this.x/e.x,this.y/e.y)}scalarDivide(e){return new Gt(this.x/e,this.y/e)}scalarDivideEquals(e){return this.x/=e,this.y/=e,this}eq(e){return this.x===e.x&&this.y===e.y}lt(e){return this.x<e.x&&this.y<e.y}lte(e){return this.x<=e.x&&this.y<=e.y}gt(e){return this.x>e.x&&this.y>e.y}gte(e){return this.x>=e.x&&this.y>=e.y}lerp(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return t=Math.max(Math.min(1,t),0),new Gt(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)}distanceFrom(e){const t=this.x-e.x,i=this.y-e.y;return Math.sqrt(t*t+i*i)}midPointFrom(e){return this.lerp(e)}min(e){return new Gt(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new Gt(Math.max(this.x,e.x),Math.max(this.y,e.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(e,t){return this.x=e,this.y=t,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setFromPoint(e){return this.x=e.x,this.y=e.y,this}swap(e){const t=this.x,i=this.y;this.x=e.x,this.y=e.y,e.x=t,e.y=i}clone(){return new Gt(this.x,this.y)}rotate(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:pF;const i=Pu(e),r=ju(e),s=this.subtract(t);return new Gt(s.x*r-s.y*i,s.x*i+s.y*r).add(t)}transform(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new Gt(e[0]*this.x+e[2]*this.y+(t?0:e[4]),e[1]*this.x+e[3]*this.y+(t?0:e[5]))}}const pF=new Gt(0,0),r_=n=>!!n&&Array.isArray(n._objects);function kG(n){class e extends n{constructor(){super(...arguments),bt(this,"_objects",[])}_onObjectAdded(i){}_onObjectRemoved(i){}_onStackOrderChanged(i){}add(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];const o=this._objects.push(...r);return r.forEach((a=>this._onObjectAdded(a))),o}insertAt(i){for(var r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];return this._objects.splice(i,0,...s),s.forEach((a=>this._onObjectAdded(a))),this._objects.length}remove(){const i=this._objects,r=[];for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return o.forEach((c=>{const h=i.indexOf(c);h!==-1&&(i.splice(h,1),r.push(c),this._onObjectRemoved(c))})),r}forEachObject(i){this.getObjects().forEach(((r,s,o)=>i(r,s,o)))}getObjects(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return r.length===0?[...this._objects]:this._objects.filter((o=>o.isType(...r)))}item(i){return this._objects[i]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(i,r){return!!this._objects.includes(i)||!!r&&this._objects.some((s=>s instanceof e&&s.contains(i,!0)))}complexity(){return this._objects.reduce(((i,r)=>i+=r.complexity?r.complexity():0),0)}sendObjectToBack(i){return!(!i||i===this._objects[0])&&(Mp(this._objects,i),this._objects.unshift(i),this._onStackOrderChanged(i),!0)}bringObjectToFront(i){return!(!i||i===this._objects[this._objects.length-1])&&(Mp(this._objects,i),this._objects.push(i),this._onStackOrderChanged(i),!0)}sendObjectBackwards(i,r){if(!i)return!1;const s=this._objects.indexOf(i);if(s!==0){const o=this.findNewLowerIndex(i,s,r);return Mp(this._objects,i),this._objects.splice(o,0,i),this._onStackOrderChanged(i),!0}return!1}bringObjectForward(i,r){if(!i)return!1;const s=this._objects.indexOf(i);if(s!==this._objects.length-1){const o=this.findNewUpperIndex(i,s,r);return Mp(this._objects,i),this._objects.splice(o,0,i),this._onStackOrderChanged(i),!0}return!1}moveObjectTo(i,r){return i!==this._objects[r]&&(Mp(this._objects,i),this._objects.splice(r,0,i),this._onStackOrderChanged(i),!0)}findNewLowerIndex(i,r,s){let o;if(s){o=r;for(let a=r-1;a>=0;--a)if(i.isOverlapping(this._objects[a])){o=a;break}}else o=r-1;return o}findNewUpperIndex(i,r,s){let o;if(s){o=r;for(let a=r+1;a<this._objects.length;++a)if(i.isOverlapping(this._objects[a])){o=a;break}}else o=r+1;return o}collectObjects(i){let{left:r,top:s,width:o,height:a}=i,{includeIntersecting:c=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const h=[],u=new Gt(r,s),d=u.add(new Gt(o,a));for(let f=this._objects.length-1;f>=0;f--){const A=this._objects[f];A.selectable&&A.visible&&(c&&A.intersectsWithRect(u,d)||A.isContainedWithinRect(u,d)||c&&A.containsPoint(u)||c&&A.containsPoint(d))&&h.push(A)}return h}}return e}class IG extends LEe{_setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(const t in e)this.set(t,e[t])}_setObject(e){for(const t in e)this._set(t,e[t])}set(e,t){return typeof e=="object"?this._setObject(e):this._set(e,t),this}_set(e,t){this[e]=t}toggle(e){const t=this.get(e);return typeof t=="boolean"&&this.set(e,!t),this}get(e){return this[e]}}function Ry(n){return Jm().requestAnimationFrame(n)}function FG(n){return Jm().cancelAnimationFrame(n)}let MEe=0;const Gf=()=>MEe++,Cd=()=>{const n=Zm().createElement("canvas");if(!n||n.getContext===void 0)throw new cd("Failed to create `canvas` element");return n},DG=()=>Zm().createElement("img"),fh=n=>{const e=Cd();return e.width=n.width,e.height=n.height,e},gF=(n,e,t)=>n.toDataURL("image/".concat(e),t),mF=(n,e,t)=>new Promise(((i,r)=>{n.toBlob(i,"image/".concat(e),t)})),Xo=n=>n*uF,Sd=n=>n/uF,jG=n=>n.every(((e,t)=>e===vc[t])),Kl=(n,e,t)=>new Gt(n).transform(e,t),Oc=n=>{const e=1/(n[0]*n[3]-n[1]*n[2]),t=[e*n[3],-e*n[1],-e*n[2],e*n[0],0,0],{x:i,y:r}=new Gt(n[4],n[5]).transform(t,!0);return t[4]=-i,t[5]=-r,t},Aa=(n,e,t)=>[n[0]*e[0]+n[2]*e[1],n[1]*e[0]+n[3]*e[1],n[0]*e[2]+n[2]*e[3],n[1]*e[2]+n[3]*e[3],t?0:n[0]*e[4]+n[2]*e[5]+n[4],t?0:n[1]*e[4]+n[3]*e[5]+n[5]],Y5=(n,e)=>n.reduceRight(((t,i)=>i&&t?Aa(i,t,e):i||t),void 0)||vc.concat(),PG=n=>{let[e,t]=n;return Math.atan2(t,e)},mg=n=>{const e=PG(n),t=Math.pow(n[0],2)+Math.pow(n[1],2),i=Math.sqrt(t),r=(n[0]*n[3]-n[2]*n[1])/i,s=Math.atan2(n[0]*n[2]+n[1]*n[3],t);return{angle:Sd(e),scaleX:i,scaleY:r,skewX:Sd(s),skewY:0,translateX:n[4]||0,translateY:n[5]||0}},n1=function(n){return[1,0,0,1,n,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function jg(){let{angle:n=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:e=0,y:t=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=Xo(n),r=ju(i),s=Pu(i);return[r,s,-s,r,e?e-(r*e-s*t):0,t?t-(s*e+r*t):0]}const Z5=function(n){return[n,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:n,0,0]},NG=n=>Math.tan(Xo(n)),yF=n=>[1,0,NG(n),1,0,0],vF=n=>[1,NG(n),0,1,0,0],ow=n=>{let{scaleX:e=1,scaleY:t=1,flipX:i=!1,flipY:r=!1,skewX:s=0,skewY:o=0}=n,a=Z5(i?-e:e,r?-t:t);return s&&(a=Aa(a,yF(s),!0)),o&&(a=Aa(a,vF(o),!0)),a},LG=n=>{const{translateX:e=0,translateY:t=0,angle:i=0}=n;let r=n1(e,t);i&&(r=Aa(r,jg({angle:i})));const s=ow(n);return jG(s)||(r=Aa(r,s)),r},Oy=function(n){let{signal:e,crossOrigin:t=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((function(i,r){if(e&&e.aborted)return r(new hF("loadImage"));const s=DG();let o;e&&(o=function(c){s.src="",r(c)},e.addEventListener("abort",o,{once:!0}));const a=function(){s.onload=s.onerror=null,o&&(e==null||e.removeEventListener("abort",o)),i(s)};n?(s.onload=a,s.onerror=function(){o&&(e==null||e.removeEventListener("abort",o)),r(new cd("Error loading ".concat(s.src)))},t&&(s.crossOrigin=t),s.src=n):a()}))},Fm=function(n){let{signal:e,reviver:t=ng}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(((i,r)=>{const s=[];e&&e.addEventListener("abort",r,{once:!0}),Promise.all(n.map((o=>bi.getClass(o.type).fromObject(o,{signal:e}).then((a=>(t(o,a),s.push(a),a)))))).then(i).catch((o=>{s.forEach((a=>{a.dispose&&a.dispose()})),r(o)})).finally((()=>{e&&e.removeEventListener("abort",r)}))}))},aw=function(n){let{signal:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(((t,i)=>{const r=[];e&&e.addEventListener("abort",i,{once:!0});const s=Object.values(n).map((a=>a&&a.type&&bi.has(a.type)?Fm([a],{signal:e}).then((c=>{let[h]=c;return r.push(h),h})):a)),o=Object.keys(n);Promise.all(s).then((a=>a.reduce(((c,h,u)=>(c[o[u]]=h,c)),{}))).then(t).catch((a=>{r.forEach((c=>{c.dispose&&c.dispose()})),i(a)})).finally((()=>{e&&e.removeEventListener("abort",i)}))}))},Pg=function(n){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce(((e,t)=>(t in n&&(e[t]=n[t]),e)),{})},wF=(n,e)=>Object.keys(n).reduce(((t,i)=>(e(n[i],i,n)&&(t[i]=n[i]),t)),{}),Xs=(n,e)=>parseFloat(Number(n).toFixed(e)),Dm=n=>"matrix("+n.map((e=>Xs(e,ds.NUM_FRACTION_DIGITS))).join(" ")+")",Oh=n=>!!n&&n.toLive!==void 0,qM=n=>!!n&&typeof n.toObject=="function",YM=n=>!!n&&n.offsetX!==void 0&&"source"in n,Rp=n=>!!n&&"multiSelectionStacking"in n;function MG(n){const e=n&&yu(n);let t=0,i=0;if(!n||!e)return{left:t,top:i};let r=n;const s=e.documentElement,o=e.body||{scrollLeft:0,scrollTop:0};for(;r&&(r.parentNode||r.host)&&(r=r.parentNode||r.host,r===e?(t=o.scrollLeft||s.scrollLeft||0,i=o.scrollTop||s.scrollTop||0):(t+=r.scrollLeft||0,i+=r.scrollTop||0),r.nodeType!==1||r.style.position!=="fixed"););return{left:t,top:i}}const yu=n=>n.ownerDocument||null,RG=n=>{var e;return((e=n.ownerDocument)===null||e===void 0?void 0:e.defaultView)||null},OG=function(n,e,t){let{width:i,height:r}=t,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;n.width=i,n.height=r,s>1&&(n.setAttribute("width",(i*s).toString()),n.setAttribute("height",(r*s).toString()),e.scale(s,s))},d6=(n,e)=>{let{width:t,height:i}=e;t&&(n.style.width=typeof t=="number"?"".concat(t,"px"):t),i&&(n.style.height=typeof i=="number"?"".concat(i,"px"):i)};function ZM(n){return n.onselectstart!==void 0&&(n.onselectstart=()=>!1),n.style.userSelect=mc,n}class UG{constructor(e){bt(this,"_originalCanvasStyle",void 0),bt(this,"lower",void 0);const t=this.createLowerCanvas(e);this.lower={el:t,ctx:t.getContext("2d")}}createLowerCanvas(e){const t=(i=e)&&i.getContext!==void 0?e:e&&Zm().getElementById(e)||Cd();var i;if(t.hasAttribute("data-fabric"))throw new cd("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=t.style.cssText,t.setAttribute("data-fabric","main"),t.classList.add("lower-canvas"),t}cleanupDOM(e){let{width:t,height:i}=e;const{el:r}=this.lower;r.classList.remove("lower-canvas"),r.removeAttribute("data-fabric"),r.setAttribute("width","".concat(t)),r.setAttribute("height","".concat(i)),r.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(e,t){const{el:i,ctx:r}=this.lower;OG(i,r,e,t)}setCSSDimensions(e){d6(this.lower.el,e)}calcOffset(){return(function(e){var t;const i=e&&yu(e),r={left:0,top:0};if(!i)return r;const s=((t=RG(e))===null||t===void 0?void 0:t.getComputedStyle(e,null))||{};r.left+=parseInt(s.borderLeftWidth,10)||0,r.top+=parseInt(s.borderTopWidth,10)||0,r.left+=parseInt(s.paddingLeft,10)||0,r.top+=parseInt(s.paddingTop,10)||0;let o={left:0,top:0};const a=i.documentElement;e.getBoundingClientRect!==void 0&&(o=e.getBoundingClientRect());const c=MG(e);return{left:o.left+c.left-(a.clientLeft||0)+r.left,top:o.top+c.top-(a.clientTop||0)+r.top}})(this.lower.el)}dispose(){_d().dispose(this.lower.el),delete this.lower}}const REe={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...vc]};class lw extends kG(IG){get lowerCanvasEl(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.el}get contextContainer(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.ctx}static getDefaults(){return lw.ownDefaults}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(t),this.initElements(e),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(e){this.elements=new UG(e)}add(){const e=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}insertAt(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];const s=super.insertAt(e,...i);return i.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),s}remove(){const e=super.remove(...arguments);return e.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}_onObjectAdded(e){e.canvas&&e.canvas!==this&&(SA("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),e.canvas.remove(e)),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e){e._set("canvas",void 0),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?SG():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(e,t){return this.setDimensions({width:e},t)}setHeight(e,t){return this.setDimensions({height:e},t)}_setDimensionsImpl(e){let{cssOnly:t=!1,backstoreOnly:i=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t){const r=xt({width:this.width,height:this.height},e);this.elements.setDimensions(r,this.getRetinaScaling()),this.hasLostContext=!0,this.width=r.width,this.height=r.height}i||this.elements.setCSSDimensions(e),this.calcOffset()}setDimensions(e,t){this._setDimensionsImpl(e,t),t&&t.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(e){this.viewportTransform=e,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(e,t){const i=e,r=[...this.viewportTransform],s=Kl(e,Oc(r));r[0]=t,r[3]=t;const o=Kl(s,r);r[4]+=i.x-o.x,r[5]+=i.y-o.y,this.setViewportTransform(r)}setZoom(e){this.zoomToPoint(new Gt(0,0),e)}absolutePan(e){const t=[...this.viewportTransform];return t[4]=-e.x,t[5]=-e.y,this.setViewportTransform(t)}relativePan(e){return this.absolutePan(new Gt(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(e){e.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=Ry((()=>this.renderAndReset())))}calcViewportBoundaries(){const e=this.width,t=this.height,i=Oc(this.viewportTransform),r=Kl({x:0,y:0},i),s=Kl({x:e,y:t},i),o=r.min(s),a=r.max(s);return this.vptCoords={tl:o,tr:new Gt(a.x,o.y),bl:new Gt(o.x,a.y),br:a}}cancelRequestedRender(){this.nextRenderHandle&&(FG(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(e){}renderCanvas(e,t){if(this.destroyed)return;const i=this.viewportTransform,r=this.clipPath;this.calcViewportBoundaries(),this.clearContext(e),e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.patternQuality="best",this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this._renderObjects(e,t),e.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(e),r&&(r._set("canvas",this),r.shouldCache(),r._transformDone=!0,r.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e,r)),this._renderOverlay(e),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(e),this.fire("after:render",{ctx:e}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(e,t){const i=this.viewportTransform;e.save(),e.transform(...i),e.globalCompositeOperation="destination-in",t.transform(e),e.scale(1/t.zoomX,1/t.zoomY),e.drawImage(t._cacheCanvas,-t.cacheTranslationX,-t.cacheTranslationY),e.restore()}_renderObjects(e,t){for(let i=0,r=t.length;i<r;++i)t[i]&&t[i].render(e)}_renderBackgroundOrOverlay(e,t){const i=this["".concat(t,"Color")],r=this["".concat(t,"Image")],s=this.viewportTransform,o=this["".concat(t,"Vpt")];if(!i&&!r)return;const a=Oh(i);if(i){if(e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=a?i.toLive(e):i,o&&e.transform(...s),a){e.transform(1,0,0,1,i.offsetX||0,i.offsetY||0);const c=i.gradientTransform||i.patternTransform;c&&e.transform(...c)}e.fill(),e.restore()}if(r){e.save();const{skipOffscreen:c}=this;this.skipOffscreen=o,o&&e.transform(...s),r.render(e),this.skipOffscreen=c,e.restore()}}_renderBackground(e){this._renderBackgroundOrOverlay(e,"background")}_renderOverlay(e){this._renderBackgroundOrOverlay(e,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new Gt(this.width/2,this.height/2)}centerObjectH(e){return this._centerObject(e,new Gt(this.getCenterPoint().x,e.getCenterPoint().y))}centerObjectV(e){return this._centerObject(e,new Gt(e.getCenterPoint().x,this.getCenterPoint().y))}centerObject(e){return this._centerObject(e,this.getCenterPoint())}viewportCenterObject(e){return this._centerObject(e,this.getVpCenter())}viewportCenterObjectH(e){return this._centerObject(e,new Gt(this.getVpCenter().x,e.getCenterPoint().y))}viewportCenterObjectV(e){return this._centerObject(e,new Gt(e.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return Kl(this.getCenterPoint(),Oc(this.viewportTransform))}_centerObject(e,t){e.setXY(t,Br,Br),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(e){return this.toDatalessObject(e)}toObject(e){return this._toObjectMethod("toObject",e)}toJSON(){return this.toObject()}toDatalessObject(e){return this._toObjectMethod("toDatalessObject",e)}_toObjectMethod(e,t){const i=this.clipPath,r=i&&!i.excludeFromExport?this._toObject(i,e,t):null;return xt(xt(xt({version:h6},Pg(this,t)),{},{objects:this._objects.filter((s=>!s.excludeFromExport)).map((s=>this._toObject(s,e,t)))},this.__serializeBgOverlay(e,t)),r?{clipPath:r}:null)}_toObject(e,t,i){let r;this.includeDefaultValues||(r=e.includeDefaultValues,e.includeDefaultValues=!1);const s=e[t](i);return this.includeDefaultValues||(e.includeDefaultValues=!!r),s}__serializeBgOverlay(e,t){const i={},r=this.backgroundImage,s=this.overlayImage,o=this.backgroundColor,a=this.overlayColor;return Oh(o)?o.excludeFromExport||(i.background=o.toObject(t)):o&&(i.background=o),Oh(a)?a.excludeFromExport||(i.overlay=a.toObject(t)):a&&(i.overlay=a),r&&!r.excludeFromExport&&(i.backgroundImage=this._toObject(r,e,t)),s&&!s.excludeFromExport&&(i.overlayImage=this._toObject(s,e,t)),i}toSVG(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;e.reviver=t;const i=[];return this._setSVGPreamble(i,e),this._setSVGHeader(i,e),this.clipPath&&i.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(i,"background"),this._setSVGBgOverlayImage(i,"backgroundImage",t),this._setSVGObjects(i,t),this.clipPath&&i.push(`</g>
`),this._setSVGBgOverlayColor(i,"overlay"),this._setSVGBgOverlayImage(i,"overlayImage",t),i.push("</svg>"),i.join("")}_setSVGPreamble(e,t){t.suppressPreamble||e.push('<?xml version="1.0" encoding="',t.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(e,t){const i=t.width||"".concat(this.width),r=t.height||"".concat(this.height),s=ds.NUM_FRACTION_DIGITS,o=t.viewBox;let a;if(o)a='viewBox="'.concat(o.x," ").concat(o.y," ").concat(o.width," ").concat(o.height,'" ');else if(this.svgViewportTransformation){const c=this.viewportTransform;a='viewBox="'.concat(Xs(-c[4]/c[0],s)," ").concat(Xs(-c[5]/c[3],s)," ").concat(Xs(this.width/c[0],s)," ").concat(Xs(this.height/c[3],s),'" ')}else a='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',i,'" ','height="',r,'" ',a,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",h6,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(t),`</defs>
`)}createSVGClipPathMarkup(e){const t=this.clipPath;return t?(t.clipPathId="CLIPPATH_".concat(Gf()),'<clipPath id="'.concat(t.clipPathId,`" >
`).concat(t.toClipPathSVG(e.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map((e=>{const t=this["".concat(e,"Color")];if(Oh(t)){const i=this["".concat(e,"Vpt")],r=this.viewportTransform,s={isType:()=>!1,width:this.width/(i?r[0]:1),height:this.height/(i?r[3]:1)};return t.toSVG(s,{additionalTransform:i?Dm(r):""})}})).join("")}createSVGFontFacesMarkup(){const e=[],t={},i=ds.fontPaths;this._objects.forEach((function s(o){e.push(o),r_(o)&&o._objects.forEach(s)})),e.forEach((s=>{if(!(o=s)||typeof o._renderText!="function")return;var o;const{styles:a,fontFamily:c}=s;!t[c]&&i[c]&&(t[c]=!0,a&&Object.values(a).forEach((h=>{Object.values(h).forEach((u=>{let{fontFamily:d=""}=u;!t[d]&&i[d]&&(t[d]=!0)}))})))}));const r=Object.keys(t).map((s=>`		@font-face {
			font-family: '`.concat(s,`';
			src: url('`).concat(i[s],`');
		}
`))).join("");return r?`	<style type="text/css"><![CDATA[
`.concat(r,`]]></style>
`):""}_setSVGObjects(e,t){this.forEachObject((i=>{i.excludeFromExport||this._setSVGObject(e,i,t)}))}_setSVGObject(e,t,i){e.push(t.toSVG(i))}_setSVGBgOverlayImage(e,t,i){const r=this[t];r&&!r.excludeFromExport&&r.toSVG&&e.push(r.toSVG(i))}_setSVGBgOverlayColor(e,t){const i=this["".concat(t,"Color")];if(i)if(Oh(i)){const r=i.repeat||"",s=this.width,o=this.height,a=this["".concat(t,"Vpt")]?Dm(Oc(this.viewportTransform)):"";e.push('<rect transform="'.concat(a," translate(").concat(s/2,",").concat(o/2,')" x="').concat(i.offsetX-s/2,'" y="').concat(i.offsetY-o/2,'" width="').concat(r!=="repeat-y"&&r!=="no-repeat"||!YM(i)?s:i.source.width,'" height="').concat(r!=="repeat-x"&&r!=="no-repeat"||!YM(i)?o:i.source.height,'" fill="url(#SVGID_').concat(i.id,`)"></rect>
`))}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',i,'"',`></rect>
`)}loadFromJSON(e,t){let{signal:i}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return Promise.reject(new cd("`json` is undefined"));const r=typeof e=="string"?JSON.parse(e):e,{objects:s=[],backgroundImage:o,background:a,overlayImage:c,overlay:h,clipPath:u}=r,d=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([Fm(s,{reviver:t,signal:i}),aw({backgroundImage:o,backgroundColor:a,overlayImage:c,overlayColor:h,clipPath:u},{signal:i})]).then((f=>{let[A,g]=f;return this.clear(),this.add(...A),this.set(r),this.set(g),this.renderOnAddRemove=d,this}))}clone(e){const t=this.toObject(e);return this.cloneWithoutData().loadFromJSON(t)}cloneWithoutData(){const e=fh(this);return new this.constructor(e)}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:t="png",quality:i=1,multiplier:r=1,enableRetinaScaling:s=!1}=e,o=r*(s?this.getRetinaScaling():1);return gF(this.toCanvasElement(o,e),t,i)}toBlob(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:t="png",quality:i=1,multiplier:r=1,enableRetinaScaling:s=!1}=e,o=r*(s?this.getRetinaScaling():1);return mF(this.toCanvasElement(o,e),t,i)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:t,height:i,left:r,top:s,filter:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const a=(t||this.width)*e,c=(i||this.height)*e,h=this.getZoom(),u=this.width,d=this.height,f=this.skipControlsDrawing,A=h*e,g=this.viewportTransform,p=[A,0,0,A,(g[4]-(r||0))*e,(g[5]-(s||0))*e],y=this.enableRetinaScaling,v=fh({width:a,height:c}),m=o?this._objects.filter((w=>o(w))):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=p,this.width=a,this.height=c,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(v.getContext("2d"),m),this.viewportTransform=g,this.width=u,this.height=d,this.calcViewportBoundaries(),this.enableRetinaScaling=y,this.skipControlsDrawing=f,v}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),vC.cancelByCanvas(this),this.disposed=!0,new Promise(((e,t)=>{const i=()=>{this.destroy(),e(!0)};i.kill=t,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?e(!1):this.nextRenderHandle?this.__cleanupTask=i:i()}))}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject((e=>e.dispose())),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}}bt(lw,"ownDefaults",REe);const OEe=["touchstart","touchmove","touchend"],HG=n=>{const e=MG(n.target),t=(function(i){const r=i.changedTouches;return r&&r[0]?r[0]:i})(n);return new Gt(t.clientX+e.left,t.clientY+e.top)},wC=n=>OEe.includes(n.type)||n.pointerType==="touch",JM=n=>{n.preventDefault(),n.stopPropagation()},md=n=>{let e=0,t=0,i=0,r=0;for(let s=0,o=n.length;s<o;s++){const{x:a,y:c}=n[s];(a>i||!s)&&(i=a),(a<e||!s)&&(e=a),(c>r||!s)&&(r=c),(c<t||!s)&&(t=c)}return{left:e,top:t,width:i-e,height:r-t}},UEe=["translateX","translateY","scaleX","scaleY"],WG=(n,e)=>jm(n,Aa(e,n.calcOwnMatrix())),jm=(n,e)=>{const t=mg(e),{translateX:i,translateY:r,scaleX:s,scaleY:o}=t,a=Bo(t,UEe),c=new Gt(i,r);n.flipX=!1,n.flipY=!1,Object.assign(n,a),n.set({scaleX:s,scaleY:o}),n.setPositionByOrigin(c,Br,Br)},QG=n=>{n.scaleX=1,n.scaleY=1,n.skewX=0,n.skewY=0,n.flipX=!1,n.flipY=!1,n.rotate(0)},xF=n=>({scaleX:n.scaleX,scaleY:n.scaleY,skewX:n.skewX,skewY:n.skewY,angle:n.angle,left:n.left,flipX:n.flipX,flipY:n.flipY,top:n.top}),J5=(n,e,t)=>{const i=n/2,r=e/2,s=[new Gt(-i,-r),new Gt(i,-r),new Gt(-i,r),new Gt(i,r)].map((a=>a.transform(t))),o=md(s);return new Gt(o.width,o.height)},cw=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:vc;return Aa(Oc(arguments.length>1&&arguments[1]!==void 0?arguments[1]:vc),n)},ig=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:vc,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:vc;return n.transform(cw(e,t))},$G=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:vc,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:vc;return n.transform(cw(e,t),!0)},A6=(n,e,t)=>{const i=cw(e,t);return jm(n,Aa(i,n.calcOwnMatrix())),i},VG=(n,e)=>{var t;const{transform:{target:i}}=e;(t=i.canvas)===null||t===void 0||t.fire("object:".concat(n),xt(xt({},e),{},{target:i})),i.fire(n,e)},HEe={left:-.5,top:-.5,center:0,bottom:.5,right:.5},xa=n=>typeof n=="string"?HEe[n]:n-.5,xC="not-allowed";function zG(n){return xa(n.originX)===xa(Br)&&xa(n.originY)===xa(Br)}function e7(n){return .5-xa(n)}const Bu=(n,e)=>n[e],GG=(n,e,t,i)=>({e:n,transform:e,pointer:new Gt(t,i)});function XG(n,e){const t=n.getTotalAngle()+Sd(Math.atan2(e.y,e.x))+360;return Math.round(t%360/45)}function bF(n,e,t,i,r){var s;let{target:o,corner:a}=n;const c=o.controls[a],h=((s=o.canvas)===null||s===void 0?void 0:s.getZoom())||1,u=o.padding/h,d=(function(f,A,g,p){const y=f.getRelativeCenterPoint(),v=g!==void 0&&p!==void 0?f.translateToGivenOrigin(y,Br,Br,g,p):new Gt(f.left,f.top);return(f.angle?A.rotate(-Xo(f.angle),y):A).subtract(v)})(o,new Gt(i,r),e,t);return d.x>=u&&(d.x-=u),d.x<=-u&&(d.x+=u),d.y>=u&&(d.y-=u),d.y<=u&&(d.y+=u),d.x-=c.offsetX,d.y-=c.offsetY,d}const WEe=(n,e,t,i)=>{const{target:r,offsetX:s,offsetY:o}=e,a=t-s,c=i-o,h=!Bu(r,"lockMovementX")&&r.left!==a,u=!Bu(r,"lockMovementY")&&r.top!==c;return h&&r.set(Es,a),u&&r.set(Hc,c),(h||u)&&VG(TG,GG(n,e,t,i)),h||u},t7={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},AT=(n,e,t)=>(t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+(e-n)*(2/3-t)*6:n),n7=(n,e,t,i)=>{n/=255,e/=255,t/=255;const r=Math.max(n,e,t),s=Math.min(n,e,t);let o,a;const c=(r+s)/2;if(r===s)o=a=0;else{const h=r-s;switch(a=c>.5?h/(2-r-s):h/(r+s),r){case n:o=(e-t)/h+(e<t?6:0);break;case e:o=(t-n)/h+2;break;case t:o=(n-e)/h+4}o/=6}return[Math.round(360*o),Math.round(100*a),Math.round(100*c),i]},i7=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(n)/(n.endsWith("%")?100:1)},nb=n=>Math.min(Math.round(n),255).toString(16).toUpperCase().padStart(2,"0"),r7=n=>{let[e,t,i,r=1]=n;const s=Math.round(.3*e+.59*t+.11*i);return[s,s,s,r]};class Fs{constructor(e){if(bt(this,"isUnrecognised",!1),e)if(e instanceof Fs)this.setSource([...e._source]);else if(Array.isArray(e)){const[t,i,r,s=1]=e;this.setSource([t,i,r,s])}else this.setSource(this._tryParsingColor(e));else this.setSource([0,0,0,1])}_tryParsingColor(e){return(e=e.toLowerCase())in t7&&(e=t7[e]),e==="transparent"?[255,255,255,0]:Fs.sourceFromHex(e)||Fs.sourceFromRgb(e)||Fs.sourceFromHsl(e)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(e){this._source=e}toRgb(){const[e,t,i]=this.getSource();return"rgb(".concat(e,",").concat(t,",").concat(i,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){const[e,t,i]=n7(...this.getSource());return"hsl(".concat(e,",").concat(t,"%,").concat(i,"%)")}toHsla(){const[e,t,i,r]=n7(...this.getSource());return"hsla(".concat(e,",").concat(t,"%,").concat(i,"%,").concat(r,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[e,t,i,r]=this.getSource();return"".concat(nb(e)).concat(nb(t)).concat(nb(i)).concat(nb(Math.round(255*r)))}getAlpha(){return this.getSource()[3]}setAlpha(e){return this._source[3]=e,this}toGrayscale(){return this.setSource(r7(this.getSource())),this}toBlackWhite(e){const[t,,,i]=r7(this.getSource()),r=t<(e||127)?0:255;return this.setSource([r,r,r,i]),this}overlayWith(e){e instanceof Fs||(e=new Fs(e));const t=this.getSource(),i=e.getSource(),[r,s,o]=t.map(((a,c)=>Math.round(.5*a+.5*i[c])));return this.setSource([r,s,o,t[3]]),this}static fromRgb(e){return Fs.fromRgba(e)}static fromRgba(e){return new Fs(Fs.sourceFromRgb(e))}static sourceFromRgb(e){const t=e.match(/^rgba?\(\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d{0,3}(?:\.\d+)?%?)\s*)?\)$/i);if(t){const[i,r,s]=t.slice(1,4).map((o=>{const a=parseFloat(o);return o.endsWith("%")?Math.round(2.55*a):a}));return[i,r,s,i7(t[4])]}}static fromHsl(e){return Fs.fromHsla(e)}static fromHsla(e){return new Fs(Fs.sourceFromHsl(e))}static sourceFromHsl(e){const t=e.match(/^hsla?\(\s*([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d*(?:\.\d+)?%?)\s*)?\)$/i);if(!t)return;const i=(Fs.parseAngletoDegrees(t[1])%360+360)%360/360,r=parseFloat(t[2])/100,s=parseFloat(t[3])/100;let o,a,c;if(r===0)o=a=c=s;else{const h=s<=.5?s*(r+1):s+r-s*r,u=2*s-h;o=AT(u,h,i+1/3),a=AT(u,h,i),c=AT(u,h,i-1/3)}return[Math.round(255*o),Math.round(255*a),Math.round(255*c),i7(t[4])]}static fromHex(e){return new Fs(Fs.sourceFromHex(e))}static sourceFromHex(e){if(e.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const t=e.slice(e.indexOf("#")+1);let i;i=t.length<=4?t.split("").map((c=>c+c)):t.match(/.{2}/g);const[r,s,o,a=255]=i.map((c=>parseInt(c,16)));return[r,s,o,a/255]}}static parseAngletoDegrees(e){const t=e.toLowerCase(),i=parseFloat(t);return t.includes("rad")?Sd(i):t.includes("turn")?360*i:i}}const dc=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:dF;const t=/\D{0,2}$/.exec(n),i=parseFloat(n),r=ds.DPI;switch(t==null?void 0:t[0]){case"mm":return i*r/25.4;case"cm":return i*r/2.54;case"in":return i*r;case"pt":return i*r/72;case"pc":return i*r/72*12;case"em":return i*e;default:return i}},_F=n=>{const[e,t]=n.trim().split(" "),[i,r]=(s=e)&&s!==mc?[s.slice(1,4),s.slice(5,8)]:s===mc?[s,s]:["Mid","Mid"];var s;return{meetOrSlice:t||"meet",alignX:i,alignY:r}},yv=function(n,e){let t,i,r=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(e)if(e.toLive)t="url(#SVGID_".concat(e.id,")");else{const s=new Fs(e),o=s.getAlpha();t=s.toRgb(),o!==1&&(i=o.toString())}else t="none";return r?"".concat(n,": ").concat(t,"; ").concat(i?"".concat(n,"-opacity: ").concat(i,"; "):""):"".concat(n,'="').concat(t,'" ').concat(i?"".concat(n,'-opacity="').concat(i,'" '):"")};class KG{getSvgStyles(e){const t=this.fillRule?this.fillRule:"nonzero",i=this.strokeWidth?this.strokeWidth:"0",r=this.strokeDashArray?this.strokeDashArray.join(" "):mc,s=this.strokeDashOffset?this.strokeDashOffset:"0",o=this.strokeLineCap?this.strokeLineCap:"butt",a=this.strokeLineJoin?this.strokeLineJoin:"miter",c=this.strokeMiterLimit?this.strokeMiterLimit:"4",h=this.opacity!==void 0?this.opacity:"1",u=this.visible?"":" visibility: hidden;",d=e?"":this.getSvgFilter(),f=yv(Sa,this.fill);return[yv(yc,this.stroke),"stroke-width: ",i,"; ","stroke-dasharray: ",r,"; ","stroke-linecap: ",o,"; ","stroke-dashoffset: ",s,"; ","stroke-linejoin: ",a,"; ","stroke-miterlimit: ",c,"; ",f,"fill-rule: ",t,"; ","opacity: ",h,";",d,u].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const i=e?this.calcTransformMatrix():this.calcOwnMatrix(),r='transform="'.concat(Dm(i));return"".concat(r).concat(t,'" ')}_toSVG(e){return[""]}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})}toClipPathSVG(e){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})}_createBaseClipPathSVGMarkup(e){let{reviver:t,additionalTransform:i=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=[this.getSvgTransform(!0,i),this.getSvgCommons()].join(""),s=e.indexOf("COMMON_PARTS");return e[s]=r,t?t(e.join("")):e.join("")}_createBaseSVGMarkup(e){let{noStyle:t,reviver:i,withShadow:r,additionalTransform:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=t?"":'style="'.concat(this.getSvgStyles(),'" '),a=r?'style="'.concat(this.getSvgFilter(),'" '):"",c=this.clipPath,h=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",u=c&&c.absolutePositioned,d=this.stroke,f=this.fill,A=this.shadow,g=[],p=e.indexOf("COMMON_PARTS");let y;c&&(c.clipPathId="CLIPPATH_".concat(Gf()),y='<clipPath id="'.concat(c.clipPathId,`" >
`).concat(c.toClipPathSVG(i),`</clipPath>
`)),u&&g.push("<g ",a,this.getSvgCommons(),` >
`),g.push("<g ",this.getSvgTransform(!1),u?"":a+this.getSvgCommons(),` >
`);const v=[o,h,t?"":this.addPaintOrder()," ",s?'transform="'.concat(s,'" '):""].join("");return e[p]=v,Oh(f)&&g.push(f.toSVG(this)),Oh(d)&&g.push(d.toSVG(this)),A&&g.push(A.toSVG(this)),c&&g.push(y),g.push(e.join("")),g.push(`</g>
`),u&&g.push(`</g>
`),i?i(g.join("")):g.join("")}addPaintOrder(){return this.paintFirst!==Sa?' paint-order="'.concat(this.paintFirst,'" '):""}}function eS(n){return new RegExp("^("+n.join("|")+")\\b","i")}const yg="textDecorationThickness",qG=["fontSize","fontWeight","fontFamily","fontStyle"],YG=["underline","overline","linethrough"],ZG=[...qG,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],JG=[...ZG,...YG,"textBackgroundColor","direction",yg],QEe=[...qG,...YG,yc,"strokeWidth",Sa,"deltaY","textBackgroundColor",yg],$Ee={_reNewline:AF,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:Es,fontStyle:"normal",lineHeight:1.16,textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:Es,pathAlign:"baseline",charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.28167,overline:-.81333},_fontSizeMult:1.13,[yg]:66.667},od="justify",bC="justify-left",Uy="justify-right",Hy="justify-center";var s7,o7,a7;const bu=String.raw(s7||(s7=Id(["[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?"],["[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?"]))),fT=String.raw(o7||(o7=Id(["(?:s*,?s+|s*,s*)"],["(?:\\s*,?\\s+|\\s*,\\s*)"]))),f6="http://www.w3.org/2000/svg",VEe=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+bu+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+bu+"))?\\s+(.*)"),zEe={cx:Es,x:Es,r:"radius",cy:Hc,y:Hc,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing","text-decoration-thickness":yg},pT="font-size",gT="clip-path",GEe=eS(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),XEe=eS(["symbol","image","marker","pattern","view","svg"]),l7=eS(["symbol","g","a","svg","clipPath","defs"]),c7=new RegExp(String.raw(a7||(a7=Id(["^s*(",")","(",")","(",")","(",")s*$"],["^\\s*(",")","(",")","(",")","(",")\\s*$"])),bu,fT,bu,fT,bu,fT,bu)),KEe=new Gt(1,0),eX=new Gt,CF=(n,e)=>n.rotate(e),_C=(n,e)=>new Gt(e).subtract(n),CC=n=>n.distanceFrom(eX),SC=(n,e)=>Math.atan2(um(n,e),nX(n,e)),tX=n=>SC(KEe,n),tS=n=>n.eq(eX)?n:n.scalarDivide(CC(n)),SF=function(n){let e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return tS(new Gt(-n.y,n.x).scalarMultiply(e?1:-1))},um=(n,e)=>n.x*e.y-n.y*e.x,nX=(n,e)=>n.x*e.x+n.y*e.y,p6=(n,e,t)=>{if(n.eq(e)||n.eq(t))return!0;const i=um(e,t),r=um(e,n),s=um(t,n);return i>=0?r>=0&&s<=0:!(r<=0&&s>=0)},h7="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",u7=new RegExp("(?:\\s|^)"+h7+h7+"("+bu+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");class pA{constructor(e){const t=typeof e=="string"?pA.parseShadow(e):e;Object.assign(this,pA.ownDefaults,t),this.id=Gf()}static parseShadow(e){const t=e.trim(),[,i=0,r=0,s=0]=(u7.exec(t)||[]).map((o=>parseFloat(o)||0));return{color:(t.replace(u7,"")||"rgb(0,0,0)").trim(),offsetX:i,offsetY:r,blur:s}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(e){const t=CF(new Gt(this.offsetX,this.offsetY),Xo(-e.angle)),i=new Fs(this.color);let r=40,s=40;return e.width&&e.height&&(r=100*Xs((Math.abs(t.x)+this.blur)/e.width,ds.NUM_FRACTION_DIGITS)+20,s=100*Xs((Math.abs(t.y)+this.blur)/e.height,ds.NUM_FRACTION_DIGITS)+20),e.flipX&&(t.x*=-1),e.flipY&&(t.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(s,'%" height="').concat(100+2*s,'%" x="-').concat(r,'%" width="').concat(100+2*r,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(Xs(this.blur?this.blur/2:0,ds.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(Xs(t.x,ds.NUM_FRACTION_DIGITS),'" dy="').concat(Xs(t.y,ds.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(i.toRgb(),'" flood-opacity="').concat(i.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){const e={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},t=pA.ownDefaults;return this.includeDefaultValues?e:wF(e,((i,r)=>i!==t[r]))}static async fromObject(e){return new this(e)}}bt(pA,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),bt(pA,"type","shadow"),bi.setClass(pA,"shadow");const vg=(n,e,t)=>Math.max(n,Math.min(e,t)),qEe=[Hc,Es,wc,Ah,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",e1,t1],jA=[Sa,yc,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],YEe={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:Es,originY:Hc,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:Sa,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},mT=(n,e,t,i)=>(n<Math.abs(e)?(n=e,i=t/4):i=e===0&&n===0?t/TA*Math.asin(1):t/TA*Math.asin(e/n),{a:n,c:e,p:t,s:i}),d7=(n,e,t,i,r)=>n*Math.pow(2,10*(i-=1))*Math.sin((i*r-e)*TA/t),iX=(n,e,t,i)=>-t*Math.cos(n/i*zf)+t+e,g6=(n,e,t,i)=>(n/=i)<1/2.75?t*(7.5625*n*n)+e:n<2/2.75?t*(7.5625*(n-=1.5/2.75)*n+.75)+e:n<2.5/2.75?t*(7.5625*(n-=2.25/2.75)*n+.9375)+e:t*(7.5625*(n-=2.625/2.75)*n+.984375)+e,A7=(n,e,t,i)=>t-g6(i-n,0,t,i)+e;var ZEe=Object.freeze({__proto__:null,defaultEasing:iX,easeInBack:function(n,e,t,i){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return t*(n/=i)*n*((r+1)*n-r)+e},easeInBounce:A7,easeInCirc:(n,e,t,i)=>-t*(Math.sqrt(1-(n/=i)*n)-1)+e,easeInCubic:(n,e,t,i)=>t*(n/i)**3+e,easeInElastic:(n,e,t,i)=>{const r=t;let s=0;if(n===0)return e;if((n/=i)===1)return e+t;s||(s=.3*i);const{a:o,s:a,p:c}=mT(r,t,s,1.70158);return-d7(o,a,c,n,i)+e},easeInExpo:(n,e,t,i)=>n===0?e:t*2**(10*(n/i-1))+e,easeInOutBack:function(n,e,t,i){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return(n/=i/2)<1?t/2*(n*n*((1+(r*=1.525))*n-r))+e:t/2*((n-=2)*n*((1+(r*=1.525))*n+r)+2)+e},easeInOutBounce:(n,e,t,i)=>n<i/2?.5*A7(2*n,0,t,i)+e:.5*g6(2*n-i,0,t,i)+.5*t+e,easeInOutCirc:(n,e,t,i)=>(n/=i/2)<1?-t/2*(Math.sqrt(1-n**2)-1)+e:t/2*(Math.sqrt(1-(n-=2)*n)+1)+e,easeInOutCubic:(n,e,t,i)=>(n/=i/2)<1?t/2*n**3+e:t/2*((n-2)**3+2)+e,easeInOutElastic:(n,e,t,i)=>{const r=t;let s=0;if(n===0)return e;if((n/=i/2)===2)return e+t;s||(s=i*(.3*1.5));const{a:o,s:a,p:c,c:h}=mT(r,t,s,1.70158);return n<1?-.5*d7(o,a,c,n,i)+e:o*Math.pow(2,-10*(n-=1))*Math.sin((n*i-a)*TA/c)*.5+h+e},easeInOutExpo:(n,e,t,i)=>n===0?e:n===i?e+t:(n/=i/2)<1?t/2*2**(10*(n-1))+e:t/2*-(2**(-10*--n)+2)+e,easeInOutQuad:(n,e,t,i)=>(n/=i/2)<1?t/2*n**2+e:-t/2*(--n*(n-2)-1)+e,easeInOutQuart:(n,e,t,i)=>(n/=i/2)<1?t/2*n**4+e:-t/2*((n-=2)*n**3-2)+e,easeInOutQuint:(n,e,t,i)=>(n/=i/2)<1?t/2*n**5+e:t/2*((n-2)**5+2)+e,easeInOutSine:(n,e,t,i)=>-t/2*(Math.cos(Math.PI*n/i)-1)+e,easeInQuad:(n,e,t,i)=>t*(n/=i)*n+e,easeInQuart:(n,e,t,i)=>t*(n/=i)*n**3+e,easeInQuint:(n,e,t,i)=>t*(n/i)**5+e,easeInSine:(n,e,t,i)=>-t*Math.cos(n/i*zf)+t+e,easeOutBack:function(n,e,t,i){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return t*((n=n/i-1)*n*((r+1)*n+r)+1)+e},easeOutBounce:g6,easeOutCirc:(n,e,t,i)=>t*Math.sqrt(1-(n=n/i-1)*n)+e,easeOutCubic:(n,e,t,i)=>t*((n/i-1)**3+1)+e,easeOutElastic:(n,e,t,i)=>{const r=t;let s=0;if(n===0)return e;if((n/=i)===1)return e+t;s||(s=.3*i);const{a:o,s:a,p:c,c:h}=mT(r,t,s,1.70158);return o*2**(-10*n)*Math.sin((n*i-a)*TA/c)+h+e},easeOutExpo:(n,e,t,i)=>n===i?e+t:t*-(2**(-10*n/i)+1)+e,easeOutQuad:(n,e,t,i)=>-t*(n/=i)*(n-2)+e,easeOutQuart:(n,e,t,i)=>-t*((n=n/i-1)*n**3-1)+e,easeOutQuint:(n,e,t,i)=>t*((n/i-1)**5+1)+e,easeOutSine:(n,e,t,i)=>t*Math.sin(n/i*zf)+e});const JEe=()=>!1;class TF{constructor(e){let{startValue:t,byValue:i,duration:r=500,delay:s=0,easing:o=iX,onStart:a=ng,onChange:c=ng,onComplete:h=ng,abort:u=JEe,target:d}=e;bt(this,"_state","pending"),bt(this,"durationProgress",0),bt(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=r,this.delay=s,this.easing=o,this._onStart=a,this._onChange=c,this._onComplete=h,this._abort=u,this.target=d,this.startValue=t,this.byValue=i,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){const e=t=>{this._state==="pending"&&(this.startTime=t||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout((()=>Ry(e)),this.delay):Ry(e)}tick(e){const t=(e||+new Date)-this.startTime,i=Math.min(t,this.duration);this.durationProgress=i/this.duration;const{value:r,valueProgress:s}=this.calculate(i);this.value=Object.freeze(r),this.valueProgress=s,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):t>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),Ry(this.tick)))}register(){vC.push(this)}unregister(){vC.remove(this)}abort(){this._state="aborted",this.unregister()}}const e6e=["startValue","endValue"];class t6e extends TF{constructor(e){let{startValue:t=0,endValue:i=100}=e;super(xt(xt({},Bo(e,e6e)),{},{startValue:t,byValue:i-t}))}calculate(e){const t=this.easing(e,this.startValue,this.byValue,this.duration);return{value:t,valueProgress:Math.abs((t-this.startValue)/this.byValue)}}}const n6e=["startValue","endValue"];class i6e extends TF{constructor(e){let{startValue:t=[0],endValue:i=[100]}=e;super(xt(xt({},Bo(e,n6e)),{},{startValue:t,byValue:i.map(((r,s)=>r-t[s]))}))}calculate(e){const t=this.startValue.map(((i,r)=>this.easing(e,i,this.byValue[r],this.duration,r)));return{value:t,valueProgress:Math.abs((t[0]-this.startValue[0])/this.byValue[0])}}}const r6e=["startValue","endValue","easing","onChange","onComplete","abort"],s6e=(n,e,t,i)=>e+t*(1-Math.cos(n/i*zf)),yT=n=>n&&((e,t,i)=>n(new Fs(e).toRgba(),t,i));class o6e extends TF{constructor(e){let{startValue:t,endValue:i,easing:r=s6e,onChange:s,onComplete:o,abort:a}=e,c=Bo(e,r6e);const h=new Fs(t).getSource(),u=new Fs(i).getSource();super(xt(xt({},c),{},{startValue:h,byValue:u.map(((d,f)=>d-h[f])),easing:r,onChange:yT(s),onComplete:yT(o),abort:yT(a)}))}calculate(e){const[t,i,r,s]=this.startValue.map(((a,c)=>this.easing(e,a,this.byValue[c],this.duration,c))),o=[...[t,i,r].map(Math.round),vg(0,s,1)];return{value:o,valueProgress:o.map(((a,c)=>this.byValue[c]!==0?Math.abs((a-this.startValue[c])/this.byValue[c]):0)).find((a=>a!==0))||0}}}function BF(n){const e=(t=>Array.isArray(t.startValue)||Array.isArray(t.endValue))(n)?new i6e(n):new t6e(n);return e.start(),e}function rX(n){const e=new o6e(n);return e.start(),e}class jo{constructor(e){this.status=e,this.points=[]}includes(e){return this.points.some((t=>t.eq(e)))}append(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return this.points=this.points.concat(t.filter((r=>!this.includes(r)))),this}static isPointContained(e,t,i){let r=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(t.eq(i))return e.eq(t);if(t.x===i.x)return e.x===t.x&&(r||e.y>=Math.min(t.y,i.y)&&e.y<=Math.max(t.y,i.y));if(t.y===i.y)return e.y===t.y&&(r||e.x>=Math.min(t.x,i.x)&&e.x<=Math.max(t.x,i.x));{const s=_C(t,i),o=_C(t,e).divide(s);return r?Math.abs(o.x)===Math.abs(o.y):o.x===o.y&&o.x>=0&&o.x<=1}}static isPointInPolygon(e,t){const i=new Gt(e).setX(Math.min(e.x-1,...t.map((s=>s.x))));let r=0;for(let s=0;s<t.length;s++){const o=this.intersectSegmentSegment(t[s],t[(s+1)%t.length],e,i);if(o.includes(e))return!0;r+=+(o.status==="Intersection")}return r%2==1}static intersectLineLine(e,t,i,r){let s=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],o=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];const a=t.x-e.x,c=t.y-e.y,h=r.x-i.x,u=r.y-i.y,d=e.x-i.x,f=e.y-i.y,A=h*f-u*d,g=a*f-c*d,p=u*a-h*c;if(p!==0){const y=A/p,v=g/p;return(s||0<=y&&y<=1)&&(o||0<=v&&v<=1)?new jo("Intersection").append(new Gt(e.x+y*a,e.y+y*c)):new jo}if(A===0||g===0){const y=s||o||jo.isPointContained(e,i,r)||jo.isPointContained(t,i,r)||jo.isPointContained(i,e,t)||jo.isPointContained(r,e,t);return new jo(y?"Coincident":void 0)}return new jo("Parallel")}static intersectSegmentLine(e,t,i,r){return jo.intersectLineLine(e,t,i,r,!1,!0)}static intersectSegmentSegment(e,t,i,r){return jo.intersectLineLine(e,t,i,r,!1,!1)}static intersectLinePolygon(e,t,i){let r=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];const s=new jo,o=i.length;for(let a,c,h,u=0;u<o;u++){if(a=i[u],c=i[(u+1)%o],h=jo.intersectLineLine(e,t,a,c,r,!1),h.status==="Coincident")return h;s.append(...h.points)}return s.points.length>0&&(s.status="Intersection"),s}static intersectSegmentPolygon(e,t,i){return jo.intersectLinePolygon(e,t,i,!1)}static intersectPolygonPolygon(e,t){const i=new jo,r=e.length,s=[];for(let o=0;o<r;o++){const a=e[o],c=e[(o+1)%r],h=jo.intersectSegmentPolygon(a,c,t);h.status==="Coincident"?(s.push(h),i.append(a,c)):i.append(...h.points)}return s.length>0&&s.length===e.length?new jo("Coincident"):(i.points.length>0&&(i.status="Intersection"),i)}static intersectPolygonRectangle(e,t,i){const r=t.min(i),s=t.max(i),o=new Gt(s.x,r.y),a=new Gt(r.x,s.y);return jo.intersectPolygonPolygon(e,[r,o,s,a])}}class a6e extends IG{getX(){return this.getXY().x}setX(e){this.setXY(this.getXY().setX(e))}getY(){return this.getXY().y}setY(e){this.setXY(this.getXY().setY(e))}getRelativeX(){return this.left}setRelativeX(e){this.left=e}getRelativeY(){return this.top}setRelativeY(e){this.top=e}getXY(){const e=this.getRelativeXY();return this.group?Kl(e,this.group.calcTransformMatrix()):e}setXY(e,t,i){this.group&&(e=Kl(e,Oc(this.group.calcTransformMatrix()))),this.setRelativeXY(e,t,i)}getRelativeXY(){return new Gt(this.left,this.top)}setRelativeXY(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(e,t,i)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:e,tr:t,br:i,bl:r}=this.aCoords||(this.aCoords=this.calcACoords()),s=[e,t,i,r];if(this.group){const o=this.group.calcTransformMatrix();return s.map((a=>Kl(a,o)))}return s}intersectsWithRect(e,t){return jo.intersectPolygonRectangle(this.getCoords(),e,t).status==="Intersection"}intersectsWithObject(e){const t=jo.intersectPolygonPolygon(this.getCoords(),e.getCoords());return t.status==="Intersection"||t.status==="Coincident"||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)}isContainedWithinObject(e){return this.getCoords().every((t=>e.containsPoint(t)))}isContainedWithinRect(e,t){const{left:i,top:r,width:s,height:o}=this.getBoundingRect();return i>=e.x&&i+s<=t.x&&r>=e.y&&r+o<=t.y}isOverlapping(e){return this.intersectsWithObject(e)||this.isContainedWithinObject(e)||e.isContainedWithinObject(this)}containsPoint(e){return jo.isPointInPolygon(e,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return!!this.getCoords().some((i=>i.x<=t.x&&i.x>=e.x&&i.y<=t.y&&i.y>=e.y))||!!this.intersectsWithRect(e,t)||this.containsPoint(e.midPointFrom(t))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return this.intersectsWithRect(e,t)?!0:this.getCoords().every((i=>(i.x>=t.x||i.x<=e.x)&&(i.y>=t.y||i.y<=e.y)))&&this.containsPoint(e.midPointFrom(t))}getBoundingRect(){return md(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(e){this._set(wc,e),this._set(Ah,e),this.setCoords()}scaleToWidth(e){const t=this.getBoundingRect().width/this.getScaledWidth();return this.scale(e/this.width/t)}scaleToHeight(e){const t=this.getBoundingRect().height/this.getScaledHeight();return this.scale(e/this.height/t)}getCanvasRetinaScaling(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.getRetinaScaling())||1}getTotalAngle(){return this.group?Sd(PG(this.calcTransformMatrix())):this.angle}getViewportTransform(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.viewportTransform)||vc.concat()}calcACoords(){const e=jg({angle:this.angle}),{x:t,y:i}=this.getRelativeCenterPoint(),r=n1(t,i),s=Aa(r,e),o=this._getTransformedDimensions(),a=o.x/2,c=o.y/2;return{tl:Kl({x:-a,y:-c},s),tr:Kl({x:a,y:-c},s),bl:Kl({x:-a,y:c},s),br:Kl({x:a,y:c},s)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=[];return!e&&this.group&&(t=this.group.transformMatrixKey(e)),t.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,xa(this.originX),xa(this.originY)),t}calcTransformMatrix(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=this.calcOwnMatrix();if(e||!this.group)return t;const i=this.transformMatrixKey(e),r=this.matrixCache;return r&&r.key.every(((s,o)=>s===i[o]))?r.value:(this.group&&(t=Aa(this.group.calcTransformMatrix(!1),t)),this.matrixCache={key:i,value:t},t)}calcOwnMatrix(){const e=this.transformMatrixKey(!0),t=this.ownMatrixCache;if(t&&t.key===e)return t.value;const i=this.getRelativeCenterPoint(),r={angle:this.angle,translateX:i.x,translateY:i.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},s=LG(r);return this.ownMatrixCache={key:e,value:s},s}_getNonTransformedDimensions(){return new Gt(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(e){return this._getTransformedDimensions(e).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=xt({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},e),i=t.strokeWidth;let r=i,s=0;this.strokeUniform&&(r=0,s=i);const o=t.width+r,a=t.height+r;let c;return c=t.skewX===0&&t.skewY===0?new Gt(o*t.scaleX,a*t.scaleY):J5(o,a,ow(t)),c.scalarAdd(s)}translateToGivenOrigin(e,t,i,r,s){let o=e.x,a=e.y;const c=xa(r)-xa(t),h=xa(s)-xa(i);if(c||h){const u=this._getTransformedDimensions();o+=c*u.x,a+=h*u.y}return new Gt(o,a)}translateToCenterPoint(e,t,i){if(t===Br&&i===Br)return e;const r=this.translateToGivenOrigin(e,t,i,Br,Br);return this.angle?r.rotate(Xo(this.angle),e):r}translateToOriginPoint(e,t,i){const r=this.translateToGivenOrigin(e,Br,Br,t,i);return this.angle?r.rotate(Xo(this.angle),e):r}getCenterPoint(){const e=this.getRelativeCenterPoint();return this.group?Kl(e,this.group.calcTransformMatrix()):e}getRelativeCenterPoint(){return this.translateToCenterPoint(new Gt(this.left,this.top),this.originX,this.originY)}getPointByOrigin(e,t){return this.translateToOriginPoint(this.getRelativeCenterPoint(),e,t)}setPositionByOrigin(e,t,i){const r=this.translateToCenterPoint(e,t,i),s=this.translateToOriginPoint(r,this.originX,this.originY);this.set({left:s.x,top:s.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),Es,Hc)}}const l6e=["type"],c6e=["extraParam"];let Yd=class s_ extends a6e{static getDefaults(){return s_.ownDefaults}get type(){const e=this.constructor.type;return e==="FabricObject"?"object":e.toLowerCase()}set type(e){SA("warn","Setting type has no effect",e)}constructor(e){super(),bt(this,"_cacheContext",null),Object.assign(this,s_.ownDefaults),this.setOptions(e)}_createCacheCanvas(){this._cacheCanvas=Cd(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(e){const t=e.width,i=e.height,r=ds.maxCacheSideLimit,s=ds.minCacheSideLimit;if(t<=r&&i<=r&&t*i<=ds.perfLimitSizeTotal)return t<s&&(e.width=s),i<s&&(e.height=s),e;const o=t/i,[a,c]=My.limitDimsByArea(o),h=vg(s,a,r),u=vg(s,c,r);return t>h&&(e.zoomX/=t/h,e.width=h,e.capped=!0),i>u&&(e.zoomY/=i/u,e.height=u,e.capped=!0),e}_getCacheCanvasDimensions(){const e=this.getTotalObjectScaling(),t=this._getTransformedDimensions({skewX:0,skewY:0}),i=t.x*e.x/this.scaleX,r=t.y*e.y/this.scaleY;return{width:Math.ceil(i+2),height:Math.ceil(r+2),zoomX:e.x,zoomY:e.y,x:i,y:r}}_updateCacheCanvas(){const e=this._cacheCanvas,t=this._cacheContext,{width:i,height:r,zoomX:s,zoomY:o,x:a,y:c}=this._limitCacheSize(this._getCacheCanvasDimensions()),h=i!==e.width||r!==e.height,u=this.zoomX!==s||this.zoomY!==o;if(!e||!t)return!1;if(h||u){i!==e.width||r!==e.height?(e.width=i,e.height=r):(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height));const d=a/2,f=c/2;return this.cacheTranslationX=Math.round(e.width/2-d)+d,this.cacheTranslationY=Math.round(e.height/2-f)+f,t.translate(this.cacheTranslationX,this.cacheTranslationY),t.scale(s,o),this.zoomX=s,this.zoomY=o,!0}return!1}setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(e)}transform(e){const t=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,i=this.calcTransformMatrix(!t);e.transform(i[0],i[1],i[2],i[3],i[4],i[5])}getObjectScaling(){if(!this.group)return new Gt(Math.abs(this.scaleX),Math.abs(this.scaleY));const e=mg(this.calcTransformMatrix());return new Gt(Math.abs(e.scaleX),Math.abs(e.scaleY))}getTotalObjectScaling(){const e=this.getObjectScaling();if(this.canvas){const t=this.canvas.getZoom(),i=this.getCanvasRetinaScaling();return e.scalarMultiply(t*i)}return e}getObjectOpacity(){let e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e}_constrainScale(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:e===0?1e-4:e}_set(e,t){e!==wc&&e!==Ah||(t=this._constrainScale(t)),e===wc&&t<0?(this.flipX=!this.flipX,t*=-1):e==="scaleY"&&t<0?(this.flipY=!this.flipY,t*=-1):e!=="shadow"||!t||t instanceof pA||(t=new pA(t));const i=this[e]!==t;return this[e]=t,i&&this.constructor.cacheProperties.includes(e)&&(this.dirty=!0),this.parent&&(this.dirty||i&&this.constructor.stateProperties.includes(e))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.drawObject(e,!1,{}),this.dirty=!1),e.restore())}drawSelectionBackground(e){}renderCache(e){if(e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){const{zoomX:t,zoomY:i,cacheTranslationX:r,cacheTranslationY:s}=this,{width:o,height:a}=this._cacheCanvas;this.drawObject(this._cacheContext,e.forClipping,{zoomX:t,zoomY:i,cacheTranslationX:r,cacheTranslationY:s,width:o,height:a,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===yc&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(e,t,i){e.save(),t.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",e.setTransform(1,0,0,1,0,0),e.drawImage(i,0,0),e.restore()}drawObject(e,t,i){const r=this.fill,s=this.stroke;t?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath,i),this.fill=r,this.stroke=s}createClipPathLayer(e,t){const i=fh(t),r=i.getContext("2d");if(r.translate(t.cacheTranslationX,t.cacheTranslationY),r.scale(t.zoomX,t.zoomY),e._cacheCanvas=i,t.parentClipPaths.forEach((s=>{s.transform(r)})),t.parentClipPaths.push(e),e.absolutePositioned){const s=Oc(this.calcTransformMatrix());r.transform(s[0],s[1],s[2],s[3],s[4],s[5])}return e.transform(r),e.drawObject(r,!0,t),i}_drawClipPath(e,t,i){if(!t)return;t._transformDone=!0;const r=this.createClipPathLayer(t,i);this.drawClipPathOnCache(e,t,r)}drawCacheOnCanvas(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;const t=this._cacheCanvas,i=this._cacheContext;return!(!t||!i||e||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(t&&i&&!e&&(i.save(),i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,t.width,t.height),i.restore()),!0)}_renderBackground(e){if(!this.backgroundColor)return;const t=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-t.x/2,-t.y/2,t.x,t.y),this._removeShadow(e)}_setOpacity(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity}_setStrokeStyles(e,t){const i=t.stroke;i&&(e.lineWidth=t.strokeWidth,e.lineCap=t.strokeLineCap,e.lineDashOffset=t.strokeDashOffset,e.lineJoin=t.strokeLineJoin,e.miterLimit=t.strokeMiterLimit,Oh(i)?i.gradientUnits==="percentage"||i.gradientTransform||i.patternTransform?this._applyPatternForTransformedGradient(e,i):(e.strokeStyle=i.toLive(e),this._applyPatternGradientTransform(e,i)):e.strokeStyle=t.stroke)}_setFillStyles(e,t){let{fill:i}=t;i&&(Oh(i)?(e.fillStyle=i.toLive(e),this._applyPatternGradientTransform(e,i)):e.fillStyle=i)}_setClippingProperties(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"}_setLineDash(e,t){t&&t.length!==0&&e.setLineDash(t)}_setShadow(e){if(!this.shadow)return;const t=this.shadow,i=this.canvas,r=this.getCanvasRetinaScaling(),[s,,,o]=(i==null?void 0:i.viewportTransform)||vc,a=s*r,c=o*r,h=t.nonScaling?new Gt(1,1):this.getObjectScaling();e.shadowColor=t.color,e.shadowBlur=t.blur*ds.browserShadowBlurConstant*(a+c)*(h.x+h.y)/4,e.shadowOffsetX=t.offsetX*a*h.x,e.shadowOffsetY=t.offsetY*c*h.y}_removeShadow(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)}_applyPatternGradientTransform(e,t){if(!Oh(t))return{offsetX:0,offsetY:0};const i=t.gradientTransform||t.patternTransform,r=-this.width/2+t.offsetX||0,s=-this.height/2+t.offsetY||0;return t.gradientUnits==="percentage"?e.transform(this.width,0,0,this.height,r,s):e.transform(1,0,0,1,r,s),i&&e.transform(i[0],i[1],i[2],i[3],i[4],i[5]),{offsetX:r,offsetY:s}}_renderPaintInOrder(e){this.paintFirst===yc?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))}_render(e){}_renderFill(e){this.fill&&(e.save(),this._setFillStyles(e,this),this.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}_renderStroke(e){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform){const t=this.getObjectScaling();e.scale(1/t.x,1/t.y)}this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}}_applyPatternForTransformedGradient(e,t){var i;const r=this._limitCacheSize(this._getCacheCanvasDimensions()),s=this.getCanvasRetinaScaling(),o=r.x/this.scaleX/s,a=r.y/this.scaleY/s,c=fh({width:Math.ceil(o),height:Math.ceil(a)}),h=c.getContext("2d");h&&(h.beginPath(),h.moveTo(0,0),h.lineTo(o,0),h.lineTo(o,a),h.lineTo(0,a),h.closePath(),h.translate(o/2,a/2),h.scale(r.zoomX/this.scaleX/s,r.zoomY/this.scaleY/s),this._applyPatternGradientTransform(h,t),h.fillStyle=t.toLive(e),h.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(s*this.scaleX/r.zoomX,s*this.scaleY/r.zoomY),e.strokeStyle=(i=h.createPattern(c,"no-repeat"))!==null&&i!==void 0?i:"")}_findCenterFromElement(){return new Gt(this.left+this.width/2,this.top+this.height/2)}clone(e){const t=this.toObject(e);return this.constructor.fromObject(t)}cloneAsImage(e){const t=this.toCanvasElement(e);return new(bi.getClass("image"))(t)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=xF(this),i=this.group,r=this.shadow,s=Math.abs,o=e.enableRetinaScaling?SG():1,a=(e.multiplier||1)*o,c=e.canvasProvider||(m=>new lw(m,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,e.withoutTransform&&QG(this),e.withoutShadow&&(this.shadow=null),e.viewportTransform&&A6(this,this.getViewportTransform()),this.setCoords();const h=Cd(),u=this.getBoundingRect(),d=this.shadow,f=new Gt;if(d){const m=d.blur,w=d.nonScaling?new Gt(1,1):this.getObjectScaling();f.x=2*Math.round(s(d.offsetX)+m)*s(w.x),f.y=2*Math.round(s(d.offsetY)+m)*s(w.y)}const A=u.width+f.x,g=u.height+f.y;h.width=Math.ceil(A),h.height=Math.ceil(g);const p=c(h);e.format==="jpeg"&&(p.backgroundColor="#fff"),this.setPositionByOrigin(new Gt(p.width/2,p.height/2),Br,Br);const y=this.canvas;p._objects=[this],this.set("canvas",p),this.setCoords();const v=p.toCanvasElement(a||1,e);return this.set("canvas",y),this.shadow=r,i&&(this.group=i),this.set(t),this.setCoords(),p._objects=[],p.destroy(),v}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return gF(this.toCanvasElement(e),e.format||"png",e.quality||1)}toBlob(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return mF(this.toCanvasElement(e),e.format||"png",e.quality||1)}isType(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.includes(this.constructor.type)||t.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(e){const{centeredRotation:t,originX:i,originY:r}=this;if(t){const{x:s,y:o}=this.getRelativeCenterPoint();this.originX=Br,this.originY=Br,this.left=s,this.top=o}if(this.set("angle",e),t){const{x:s,y:o}=this.translateToOriginPoint(this.getRelativeCenterPoint(),i,r);this.left=s,this.top=o,this.originX=i,this.originY=r}}setOnGroup(){}_setupCompositeOperation(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)}dispose(){vC.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&_d().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(e,t){return Object.entries(e).reduce(((i,r)=>{let[s,o]=r;return i[s]=this._animate(s,o,t),i}),{})}_animate(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=e.split("."),s=this.constructor.colorProperties.includes(r[r.length-1]),{abort:o,startValue:a,onChange:c,onComplete:h}=i,u=xt(xt({},i),{},{target:this,startValue:a??r.reduce(((d,f)=>d[f]),this),endValue:t,abort:o==null?void 0:o.bind(this),onChange:(d,f,A)=>{r.reduce(((g,p,y)=>(y===r.length-1&&(g[p]=d),g[p])),this),c&&c(d,f,A)},onComplete:(d,f,A)=>{this.setCoords(),h&&h(d,f,A)}});return s?rX(u):BF(u)}isDescendantOf(e){const{parent:t,group:i}=this;return t===e||i===e||!!t&&t.isDescendantOf(e)||!!i&&i!==t&&i.isDescendantOf(e)}getAncestors(){const e=[];let t=this;do t=t.parent,t&&e.push(t);while(t);return e}findCommonAncestors(e){if(this===e)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const t=this.getAncestors(),i=e.getAncestors();if(t.length===0&&i.length>0&&this===i[i.length-1])return{fork:[],otherFork:[e,...i.slice(0,i.length-1)],common:[this]};for(let r,s=0;s<t.length;s++){if(r=t[s],r===e)return{fork:[this,...t.slice(0,s)],otherFork:[],common:t.slice(s)};for(let o=0;o<i.length;o++){if(this===i[o])return{fork:[],otherFork:[e,...i.slice(0,o)],common:[this,...t]};if(r===i[o])return{fork:[this,...t.slice(0,s)],otherFork:[e,...i.slice(0,o)],common:t.slice(s)}}}return{fork:[this,...t],otherFork:[e,...i],common:[]}}hasCommonAncestors(e){const t=this.findCommonAncestors(e);return t&&!!t.common.length}isInFrontOf(e){if(this===e)return;const t=this.findCommonAncestors(e);if(t.fork.includes(e))return!0;if(t.otherFork.includes(this))return!1;const i=t.common[0]||this.canvas;if(!i)return;const r=t.fork.pop(),s=t.otherFork.pop(),o=i._objects.indexOf(r),a=i._objects.indexOf(s);return o>-1&&o>a}toObject(){const e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(s_.customProperties,this.constructor.customProperties||[]);let t;const i=ds.NUM_FRACTION_DIGITS,{clipPath:r,fill:s,stroke:o,shadow:a,strokeDashArray:c,left:h,top:u,originX:d,originY:f,width:A,height:g,strokeWidth:p,strokeLineCap:y,strokeDashOffset:v,strokeLineJoin:m,strokeUniform:w,strokeMiterLimit:x,scaleX:T,scaleY:j,angle:D,flipX:b,flipY:_,opacity:I,visible:S,backgroundColor:F,fillRule:B,paintFirst:E,globalCompositeOperation:V,skewX:K,skewY:P}=this;r&&!r.excludeFromExport&&(t=r.toObject(e.concat("inverted","absolutePositioned")));const M=Z=>Xs(Z,i),X=xt(xt({},Pg(this,e)),{},{type:this.constructor.type,version:h6,originX:d,originY:f,left:M(h),top:M(u),width:M(A),height:M(g),fill:qM(s)?s.toObject():s,stroke:qM(o)?o.toObject():o,strokeWidth:M(p),strokeDashArray:c&&c.concat(),strokeLineCap:y,strokeDashOffset:v,strokeLineJoin:m,strokeUniform:w,strokeMiterLimit:M(x),scaleX:M(T),scaleY:M(j),angle:M(D),flipX:b,flipY:_,opacity:M(I),shadow:a&&a.toObject(),visible:S,backgroundColor:F,fillRule:B,paintFirst:E,globalCompositeOperation:V,skewX:M(K),skewY:M(P)},t?{clipPath:t}:null);return this.includeDefaultValues?X:this._removeDefaultValues(X)}toDatalessObject(e){return this.toObject(e)}_removeDefaultValues(e){const t=this.constructor.getDefaults(),i=Object.keys(t).length>0?t:Object.getPrototypeOf(this);return wF(e,((r,s)=>{if(s===Es||s===Hc||s==="type")return!0;const o=i[s];return r!==o&&!(Array.isArray(r)&&Array.isArray(o)&&r.length===0&&o.length===0)}))}toString(){return"#<".concat(this.constructor.type,">")}static _fromObject(e){let t=Bo(e,l6e),i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:r}=i,s=Bo(i,c6e);return aw(t,s).then((o=>r?(delete o[r],new this(t[r],o)):new this(o)))}static fromObject(e,t){return this._fromObject(e,t)}};bt(Yd,"stateProperties",qEe),bt(Yd,"cacheProperties",jA),bt(Yd,"ownDefaults",YEe),bt(Yd,"type","FabricObject"),bt(Yd,"colorProperties",[Sa,yc,"backgroundColor"]),bt(Yd,"customProperties",[]),bi.setClass(Yd),bi.setClass(Yd,"object");const i1=(n,e,t)=>(i,r,s,o)=>{const a=e(i,r,s,o);return a&&VG(n,xt(xt({},GG(i,r,s,o)),t)),a};function r1(n){return(e,t,i,r)=>{const{target:s,originX:o,originY:a}=t,c=s.getRelativeCenterPoint(),h=s.translateToOriginPoint(c,o,a),u=n(e,t,i,r);return s.setPositionByOrigin(h,t.originX,t.originY),u}}const f7=i1(mv,r1(((n,e,t,i)=>{const r=bF(e,e.originX,e.originY,t,i);if(xa(e.originX)===xa(Br)||xa(e.originX)===xa(la)&&r.x<0||xa(e.originX)===xa(Es)&&r.x>0){const{target:s}=e,o=s.strokeWidth/(s.strokeUniform?s.scaleX:1),a=zG(e)?2:1,c=s.width,h=Math.abs(r.x*a/s.scaleX)-o;return s.set("width",Math.max(h,1)),c!==s.width}return!1})));function h6e(n,e,t,i,r){i=i||{};const s=this.sizeX||i.cornerSize||r.cornerSize,o=this.sizeY||i.cornerSize||r.cornerSize,a=i.transparentCorners!==void 0?i.transparentCorners:r.transparentCorners,c=a?yc:Sa,h=!a&&(i.cornerStrokeColor||r.cornerStrokeColor);let u,d=e,f=t;n.save(),n.fillStyle=i.cornerColor||r.cornerColor||"",n.strokeStyle=i.cornerStrokeColor||r.cornerStrokeColor||"",s>o?(u=s,n.scale(1,o/s),f=t*s/o):o>s?(u=o,n.scale(s/o,1),d=e*o/s):u=s,n.beginPath(),n.arc(d,f,u/2,0,TA,!1),n[c](),h&&n.stroke(),n.restore()}function u6e(n,e,t,i,r){i=i||{};const s=this.sizeX||i.cornerSize||r.cornerSize,o=this.sizeY||i.cornerSize||r.cornerSize,a=i.transparentCorners!==void 0?i.transparentCorners:r.transparentCorners,c=a?yc:Sa,h=!a&&(i.cornerStrokeColor||r.cornerStrokeColor),u=s/2,d=o/2;n.save(),n.fillStyle=i.cornerColor||r.cornerColor||"",n.strokeStyle=i.cornerStrokeColor||r.cornerStrokeColor||"",n.translate(e,t);const f=r.getTotalAngle();n.rotate(Xo(f)),n["".concat(c,"Rect")](-u,-d,s,o),h&&n.strokeRect(-u,-d,s,o),n.restore()}class uu{constructor(e){bt(this,"visible",!0),bt(this,"actionName",q5),bt(this,"angle",0),bt(this,"x",0),bt(this,"y",0),bt(this,"offsetX",0),bt(this,"offsetY",0),bt(this,"sizeX",0),bt(this,"sizeY",0),bt(this,"touchSizeX",0),bt(this,"touchSizeY",0),bt(this,"cursorStyle","crosshair"),bt(this,"withConnection",!1),Object.assign(this,e)}shouldActivate(e,t,i,r){var s;let{tl:o,tr:a,br:c,bl:h}=r;return((s=t.canvas)===null||s===void 0?void 0:s.getActiveObject())===t&&t.isControlVisible(e)&&jo.isPointInPolygon(i,[o,a,c,h])}getActionHandler(e,t,i){return this.actionHandler}getMouseDownHandler(e,t,i){return this.mouseDownHandler}getMouseUpHandler(e,t,i){return this.mouseUpHandler}cursorStyleHandler(e,t,i){return t.cursorStyle}getActionName(e,t,i){return t.actionName}getVisibility(e,t){var i,r;return(i=(r=e._controlsVisibility)===null||r===void 0?void 0:r[t])!==null&&i!==void 0?i:this.visible}setVisibility(e,t,i){this.visible=e}positionHandler(e,t,i,r){return new Gt(this.x*e.x+this.offsetX,this.y*e.y+this.offsetY).transform(t)}calcCornerCoords(e,t,i,r,s,o){const a=Y5([n1(i,r),jg({angle:e}),Z5((s?this.touchSizeX:this.sizeX)||t,(s?this.touchSizeY:this.sizeY)||t)]);return{tl:new Gt(-.5,-.5).transform(a),tr:new Gt(.5,-.5).transform(a),br:new Gt(.5,.5).transform(a),bl:new Gt(-.5,.5).transform(a)}}render(e,t,i,r,s){((r=r||{}).cornerStyle||s.cornerStyle)==="circle"?h6e.call(this,e,t,i,r,s):u6e.call(this,e,t,i,r,s)}}const d6e=(n,e,t)=>t.lockRotation?xC:e.cursorStyle,A6e=i1(BG,r1(((n,e,t,i)=>{let{target:r,ex:s,ey:o,theta:a,originX:c,originY:h}=e;const u=r.translateToOriginPoint(r.getRelativeCenterPoint(),c,h);if(Bu(r,"lockRotation"))return!1;const d=Math.atan2(o-u.y,s-u.x),f=Math.atan2(i-u.y,t-u.x);let A=Sd(f-d+a);if(r.snapAngle&&r.snapAngle>0){const p=r.snapAngle,y=r.snapThreshold||p,v=Math.ceil(A/p)*p,m=Math.floor(A/p)*p;Math.abs(A-m)<y?A=m:Math.abs(A-v)<y&&(A=v)}A<0&&(A=360+A),A%=360;const g=r.angle!==A;return r.angle=A,g})));function sX(n,e){const t=e.canvas,i=n[t.uniScaleKey];return t.uniformScaling&&!i||!t.uniformScaling&&i}function oX(n,e,t){const i=Bu(n,"lockScalingX"),r=Bu(n,"lockScalingY");if(i&&r||!e&&(i||r)&&t||i&&e==="x"||r&&e==="y")return!0;const{width:s,height:o,strokeWidth:a}=n;return s===0&&a===0&&e!=="y"||o===0&&a===0&&e!=="x"}const f6e=["e","se","s","sw","w","nw","n","ne","e"],iy=(n,e,t)=>{const i=sX(n,t);if(oX(t,e.x!==0&&e.y===0?"x":e.x===0&&e.y!==0?"y":"",i))return xC;const r=XG(t,e);return"".concat(f6e[r],"-resize")};function EF(n,e,t,i){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const s=e.target,o=r.by,a=sX(n,s);let c,h,u,d,f,A;if(oX(s,o,a))return!1;if(e.gestureScale)h=e.scaleX*e.gestureScale,u=e.scaleY*e.gestureScale;else{if(c=bF(e,e.originX,e.originY,t,i),f=o!=="y"?Math.sign(c.x||e.signX||1):1,A=o!=="x"?Math.sign(c.y||e.signY||1):1,e.signX||(e.signX=f),e.signY||(e.signY=A),Bu(s,"lockScalingFlip")&&(e.signX!==f||e.signY!==A))return!1;if(d=s._getTransformedDimensions(),a&&!o){const y=Math.abs(c.x)+Math.abs(c.y),{original:v}=e,m=y/(Math.abs(d.x*v.scaleX/s.scaleX)+Math.abs(d.y*v.scaleY/s.scaleY));h=v.scaleX*m,u=v.scaleY*m}else h=Math.abs(c.x*s.scaleX/d.x),u=Math.abs(c.y*s.scaleY/d.y);zG(e)&&(h*=2,u*=2),e.signX!==f&&o!=="y"&&(e.originX=e7(e.originX),h*=-1,e.signX=f),e.signY!==A&&o!=="x"&&(e.originY=e7(e.originY),u*=-1,e.signY=A)}const g=s.scaleX,p=s.scaleY;return o?(o==="x"&&s.set(wc,h),o==="y"&&s.set(Ah,u)):(!Bu(s,"lockScalingX")&&s.set(wc,h),!Bu(s,"lockScalingY")&&s.set(Ah,u)),g!==s.scaleX||p!==s.scaleY}const ib=i1(K5,r1(((n,e,t,i)=>EF(n,e,t,i)))),p6e=i1(K5,r1(((n,e,t,i)=>EF(n,e,t,i,{by:"x"})))),g6e=i1(K5,r1(((n,e,t,i)=>EF(n,e,t,i,{by:"y"})))),m6e=["target","ex","ey","skewingSide"],vT={x:{counterAxis:"y",scale:wc,skew:e1,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:Ah,skew:t1,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},y6e=["ns","nesw","ew","nwse"],v6e=(n,e,t)=>{if(e.x!==0&&Bu(t,"lockSkewingY")||e.y!==0&&Bu(t,"lockSkewingX"))return xC;const i=XG(t,e)%4;return"".concat(y6e[i],"-resize")};function aX(n,e,t,i,r){const{target:s}=t,{counterAxis:o,origin:a,lockSkewing:c,skew:h,flip:u}=vT[n];if(Bu(s,c))return!1;const{origin:d,flip:f}=vT[o],A=xa(t[d])*(s[f]?-1:1),g=-Math.sign(A)*(s[u]?-1:1),p=.5*-((s[h]===0&&bF(t,Br,Br,i,r)[n]>0||s[h]>0?1:-1)*g)+.5;return i1(EG,r1(((v,m,w,x)=>(function(T,j,D){let{target:b,ex:_,ey:I,skewingSide:S}=j,F=Bo(j,m6e);const{skew:B}=vT[T],E=D.subtract(new Gt(_,I)).divide(new Gt(b.scaleX,b.scaleY))[T],V=b[B],K=F[B],P=Math.tan(Xo(K)),M=T==="y"?b._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:b._getTransformedDimensions({scaleX:1,scaleY:1}).y,X=2*E*S/Math.max(M,1)+P,Z=Sd(Math.atan(X));b.set(B,Z);const Q=V!==b[B];if(Q&&T==="y"){const{skewX:U,scaleX:z}=b,q=b._getTransformedDimensions({skewY:V}),G=b._getTransformedDimensions(),ie=U!==0?q.x/G.x:1;ie!==1&&b.set(wc,ie*z)}return Q})(n,m,new Gt(w,x)))))(e,xt(xt({},t),{},{[a]:p,skewingSide:g}),i,r)}const w6e=(n,e,t,i)=>aX("x",n,e,t,i),x6e=(n,e,t,i)=>aX("y",n,e,t,i);function nS(n,e){return n[e.canvas.altActionKey]}const rb=(n,e,t)=>{const i=nS(n,t);return e.x===0?i?e1:Ah:e.y===0?i?t1:wc:""},W0=(n,e,t)=>nS(n,t)?v6e(0,e,t):iy(n,e,t),p7=(n,e,t,i)=>nS(n,e.target)?x6e(n,e,t,i):p6e(n,e,t,i),g7=(n,e,t,i)=>nS(n,e.target)?w6e(n,e,t,i):g6e(n,e,t,i),lX=()=>({ml:new uu({x:-.5,y:0,cursorStyleHandler:W0,actionHandler:p7,getActionName:rb}),mr:new uu({x:.5,y:0,cursorStyleHandler:W0,actionHandler:p7,getActionName:rb}),mb:new uu({x:0,y:.5,cursorStyleHandler:W0,actionHandler:g7,getActionName:rb}),mt:new uu({x:0,y:-.5,cursorStyleHandler:W0,actionHandler:g7,getActionName:rb}),tl:new uu({x:-.5,y:-.5,cursorStyleHandler:iy,actionHandler:ib}),tr:new uu({x:.5,y:-.5,cursorStyleHandler:iy,actionHandler:ib}),bl:new uu({x:-.5,y:.5,cursorStyleHandler:iy,actionHandler:ib}),br:new uu({x:.5,y:.5,cursorStyleHandler:iy,actionHandler:ib}),mtr:new uu({x:0,y:-.5,actionHandler:A6e,cursorStyleHandler:d6e,offsetY:-40,withConnection:!0,actionName:fF})}),b6e=()=>({mr:new uu({x:.5,y:0,actionHandler:f7,cursorStyleHandler:W0,actionName:mv}),ml:new uu({x:-.5,y:0,actionHandler:f7,cursorStyleHandler:W0,actionName:mv})}),_6e=()=>xt(xt({},lX()),b6e());class vv extends Yd{static getDefaults(){return xt(xt({},super.getDefaults()),vv.ownDefaults)}constructor(e){super(),Object.assign(this,this.constructor.createControls(),vv.ownDefaults),this.setOptions(e)}static createControls(){return{controls:lX()}}_updateCacheCanvas(){const e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){const t=e._currentTransform,i=t.target,r=t.action;if(this===i&&r&&r.startsWith(q5))return!1}return super._updateCacheCanvas()}getActiveControl(){const e=this.__corner;return e?{key:e,control:this.controls[e],coord:this.oCoords[e]}:void 0}findControl(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const i=Object.entries(this.oCoords);for(let r=i.length-1;r>=0;r--){const[s,o]=i[r],a=this.controls[s];if(a.shouldActivate(s,this,e,t?o.touchCorner:o.corner))return this.__corner=s,{key:s,control:a,coord:this.oCoords[s]}}}calcOCoords(){const e=this.getViewportTransform(),t=this.getCenterPoint(),i=n1(t.x,t.y),r=jg({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),s=Aa(i,r),o=Aa(e,s),a=Aa(o,[1/e[0],0,0,1/e[3],0,0]),c=this.group?mg(this.calcTransformMatrix()):void 0;c&&(c.scaleX=Math.abs(c.scaleX),c.scaleY=Math.abs(c.scaleY));const h=this._calculateCurrentDimensions(c),u={};return this.forEachControl(((d,f)=>{const A=d.positionHandler(h,a,this,d);u[f]=Object.assign(A,this._calcCornerCoords(d,A))})),u}_calcCornerCoords(e,t){const i=this.getTotalAngle();return{corner:e.calcCornerCoords(i,this.cornerSize,t.x,t.y,!1,this),touchCorner:e.calcCornerCoords(i,this.touchCornerSize,t.x,t.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(e){for(const t in this.controls)e(this.controls[t],t,this)}drawSelectionBackground(e){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;e.save();const t=this.getRelativeCenterPoint(),i=this._calculateCurrentDimensions(),r=this.getViewportTransform();e.translate(t.x,t.y),e.scale(1/r[0],1/r[3]),e.rotate(Xo(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-i.x/2,-i.y/2,i.x,i.y),e.restore()}strokeBorders(e,t){e.strokeRect(-t.x/2,-t.y/2,t.x,t.y)}_drawBorders(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=xt({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},i);e.save(),e.strokeStyle=r.borderColor,this._setLineDash(e,r.borderDashArray),this.strokeBorders(e,t),r.hasControls&&this.drawControlsConnectingLines(e,t),e.restore()}_renderControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{hasBorders:i,hasControls:r}=this,s=xt({hasBorders:i,hasControls:r},t),o=this.getViewportTransform(),a=s.hasBorders,c=s.hasControls,h=Aa(o,this.calcTransformMatrix()),u=mg(h);e.save(),e.translate(u.translateX,u.translateY),e.lineWidth=this.borderScaleFactor,this.group===this.parent&&(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(u.angle-=180),e.rotate(Xo(this.group?u.angle:this.angle)),a&&this.drawBorders(e,u,t),c&&this.drawControls(e,t),e.restore()}drawBorders(e,t,i){let r;if(i&&i.forActiveSelection||this.group){const s=J5(this.width,this.height,ow(t)),o=this.isStrokeAccountedForInDimensions()?pF:(this.strokeUniform?new Gt().scalarAdd(this.canvas?this.canvas.getZoom():1):new Gt(t.scaleX,t.scaleY)).scalarMultiply(this.strokeWidth);r=s.add(o).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else r=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(e,r,i)}drawControlsConnectingLines(e,t){let i=!1;e.beginPath(),this.forEachControl(((r,s)=>{r.withConnection&&r.getVisibility(this,s)&&(i=!0,e.moveTo(r.x*t.x,r.y*t.y),e.lineTo(r.x*t.x+r.offsetX,r.y*t.y+r.offsetY))})),i&&e.stroke()}drawControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.save();const i=this.getCanvasRetinaScaling(),{cornerStrokeColor:r,cornerDashArray:s,cornerColor:o}=this,a=xt({cornerStrokeColor:r,cornerDashArray:s,cornerColor:o},t);e.setTransform(i,0,0,i,0,0),e.strokeStyle=e.fillStyle=a.cornerColor,this.transparentCorners||(e.strokeStyle=a.cornerStrokeColor),this._setLineDash(e,a.cornerDashArray),this.forEachControl(((c,h)=>{if(c.getVisibility(this,h)){const u=this.oCoords[h];c.render(e,u.x,u.y,a,this)}})),e.restore()}isControlVisible(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)}setControlVisible(e,t){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=t}setControlsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(e).forEach((t=>{let[i,r]=t;return this.setControlVisible(i,r)}))}clearContextTop(e){if(!this.canvas)return;const t=this.canvas.contextTop;if(!t)return;const i=this.canvas.viewportTransform;t.save(),t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this.transform(t);const r=this.width+4,s=this.height+4;return t.clearRect(-r/2,-s/2,r,s),e||t.restore(),t}onDeselect(e){return!1}onSelect(e){return!1}shouldStartDragging(e){return!1}onDragStart(e){return!1}canDrop(e){return!1}renderDragSourceEffect(e){}renderDropTargetEffect(e){}}function cX(n,e){return e.forEach((t=>{Object.getOwnPropertyNames(t.prototype).forEach((i=>{i!=="constructor"&&Object.defineProperty(n.prototype,i,Object.getOwnPropertyDescriptor(t.prototype,i)||Object.create(null))}))})),n}bt(vv,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class Zl extends vv{}cX(Zl,[KG]),bi.setClass(Zl),bi.setClass(Zl,"object");const hX=(n,e,t,i)=>{const r=2*(i=Math.round(i))+1,{data:s}=n.getImageData(e-i,t-i,r,r);for(let o=3;o<s.length;o+=4)if(s[o]>0)return!1;return!0};class uX{constructor(e){this.options=e,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new Gt(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new Gt(1/this.options.scaleX,1/this.options.scaleY):new Gt(1,1)}createSideVector(e,t){const i=_C(e,t);return this.options.strokeUniform?i.multiply(this.scale):i}projectOrthogonally(e,t,i){return this.applySkew(e.add(this.calcOrthogonalProjection(e,t,i)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(e){const t=new Gt(e);return t.y+=t.x*Math.tan(Xo(this.options.skewY)),t.x+=t.y*Math.tan(Xo(this.options.skewX)),t}scaleUnitVector(e,t){return e.multiply(this.strokeUniformScalar).scalarMultiply(t)}}const C6e=new Gt;class dm extends uX{static getOrthogonalRotationFactor(e,t){const i=t?SC(e,t):tX(e);return Math.abs(i)<zf?-1:1}constructor(e,t,i,r){super(r),bt(this,"AB",void 0),bt(this,"AC",void 0),bt(this,"alpha",void 0),bt(this,"bisector",void 0),this.A=new Gt(e),this.B=new Gt(t),this.C=new Gt(i),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=SC(this.AB,this.AC),this.bisector=tS(CF(this.AB.eq(C6e)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const r=this.createSideVector(e,t),s=SF(r),o=dm.getOrthogonalRotationFactor(s,this.bisector);return this.scaleUnitVector(s,i*o)}projectBevel(){const e=[];return(this.alpha%TA==0?[this.B]:[this.B,this.C]).forEach((t=>{e.push(this.projectOrthogonally(this.A,t)),e.push(this.projectOrthogonally(this.A,t,-this.strokeProjectionMagnitude))})),e}projectMiter(){const e=[],t=Math.abs(this.alpha),i=1/Math.sin(t/2),r=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*i),s=this.options.strokeUniform?CC(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return CC(r)/this.strokeProjectionMagnitude<=s&&e.push(this.applySkew(this.A.add(r))),e.push(...this.projectBevel()),e}projectRoundNoSkew(e,t){const i=[],r=new Gt(dm.getOrthogonalRotationFactor(this.bisector),dm.getOrthogonalRotationFactor(new Gt(this.bisector.y,this.bisector.x)));return[new Gt(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(r),new Gt(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(r)].forEach((s=>{p6(s,e,t)&&i.push(this.A.add(s))})),i}projectRoundWithSkew(e,t){const i=[],{skewX:r,skewY:s,scaleX:o,scaleY:a,strokeUniform:c}=this.options,h=new Gt(Math.tan(Xo(r)),Math.tan(Xo(s))),u=this.strokeProjectionMagnitude,d=c?u/a/Math.sqrt(1/a**2+1/o**2*h.y**2):u/Math.sqrt(1+h.y**2),f=new Gt(Math.sqrt(Math.max(u**2-d**2,0)),d),A=c?u/Math.sqrt(1+h.x**2*(1/a)**2/(1/o+1/o*h.x*h.y)**2):u/Math.sqrt(1+h.x**2/(1+h.x*h.y)**2),g=new Gt(A,Math.sqrt(Math.max(u**2-A**2,0)));return[g,g.scalarMultiply(-1),f,f.scalarMultiply(-1)].map((p=>this.applySkew(c?p.multiply(this.strokeUniformScalar):p))).forEach((p=>{p6(p,e,t)&&i.push(this.applySkew(this.A).add(p))})),i}projectRound(){const e=[];e.push(...this.projectBevel());const t=this.alpha%TA==0,i=this.applySkew(this.A),r=e[t?0:2].subtract(i),s=e[t?1:0].subtract(i),o=t?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),a=um(r,o)>0,c=a?r:s,h=a?s:r;return this.isSkewed()?e.push(...this.projectRoundWithSkew(c,h)):e.push(...this.projectRoundNoSkew(c,h)),e}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map((e=>({originPoint:this.A,projectedPoint:e,angle:this.alpha,bisector:this.bisector})))}}class m7 extends uX{constructor(e,t,i){super(i),this.A=new Gt(e),this.T=new Gt(t)}calcOrthogonalProjection(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const r=this.createSideVector(e,t);return this.scaleUnitVector(SF(r),i)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const e=[];if(!this.isSkewed()&&this.A.eq(this.T)){const t=new Gt(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.applySkew(this.A.add(t)),this.applySkew(this.A.subtract(t)))}else e.push(...new dm(this.A,this.T,this.T,this.options).projectRound());return e}projectSquare(){const e=[];if(this.A.eq(this.T)){const t=new Gt(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.A.add(t),this.A.subtract(t))}else{const t=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),i=this.scaleUnitVector(tS(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),r=this.A.add(i);e.push(r.add(t),r.subtract(t))}return e.map((t=>this.applySkew(t)))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map((e=>({originPoint:this.A,projectedPoint:e})))}}const dX=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const i=[];if(n.length===0)return i;const r=n.reduce(((s,o)=>(s[s.length-1].eq(o)||s.push(new Gt(o)),s)),[new Gt(n[0])]);if(r.length===1)t=!0;else if(!t){const s=r[0],o=((a,c)=>{for(let h=a.length-1;h>=0;h--)if(c(a[h],h,a))return h;return-1})(r,(a=>!a.eq(s)));r.splice(o+1)}return r.forEach(((s,o,a)=>{let c,h;o===0?(h=a[1],c=t?s:a[a.length-1]):o===a.length-1?(c=a[o-1],h=t?s:a[0]):(c=a[o-1],h=a[o+1]),t&&a.length===1?i.push(...new m7(s,s,e).project()):!t||o!==0&&o!==a.length-1?i.push(...new dm(s,c,h,e).project()):i.push(...new m7(s,o===0?h:c,e).project())})),i},kF=n=>{const e={};return Object.keys(n).forEach((t=>{e[t]={},Object.keys(n[t]).forEach((i=>{e[t][i]=xt({},n[t][i])}))})),e},AX=n=>n.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;");let G1;const iS=n=>{if(G1||G1||(G1="Intl"in Jm()&&"Segmenter"in Intl&&new Intl.Segmenter(void 0,{granularity:"grapheme"})),G1){const e=G1.segment(n);return Array.from(e).map((t=>{let{segment:i}=t;return i}))}return S6e(n)},S6e=n=>{const e=[];for(let t,i=0;i<n.length;i++)(t=T6e(n,i))!==!1&&e.push(t);return e},T6e=(n,e)=>{const t=n.charCodeAt(e);if(isNaN(t))return"";if(t<55296||t>57343)return n.charAt(e);if(55296<=t&&t<=56319){if(n.length<=e+1)throw"High surrogate without following low surrogate";const r=n.charCodeAt(e+1);if(56320>r||r>57343)throw"High surrogate without following low surrogate";return n.charAt(e)+n.charAt(e+1)}if(e===0)throw"Low surrogate without preceding high surrogate";const i=n.charCodeAt(e-1);if(55296>i||i>56319)throw"Low surrogate without preceding high surrogate";return!1};var B6e=Object.freeze({__proto__:null,capitalize:function(n){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return"".concat(n.charAt(0).toUpperCase()).concat(e?n.slice(1):n.slice(1).toLowerCase())},escapeXml:AX,graphemeSplit:iS});const rS=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return n.fill!==e.fill||n.stroke!==e.stroke||n.strokeWidth!==e.strokeWidth||n.fontSize!==e.fontSize||n.fontFamily!==e.fontFamily||n.fontWeight!==e.fontWeight||n.fontStyle!==e.fontStyle||n.textDecorationThickness!==e.textDecorationThickness||n.textBackgroundColor!==e.textBackgroundColor||n.deltaY!==e.deltaY||t&&(n.overline!==e.overline||n.underline!==e.underline||n.linethrough!==e.linethrough)},fX=(n,e)=>{const t=e.split(`
`),i=[];let r=-1,s={};n=kF(n);for(let o=0;o<t.length;o++){const a=iS(t[o]);if(n[o])for(let c=0;c<a.length;c++){r++;const h=n[o][c];h&&Object.keys(h).length>0&&(rS(s,h,!0)?i.push({start:r,end:r+1,style:h}):i[i.length-1].end++),s=h||{}}else r+=a.length,s={}}return i},pX=(n,e)=>{if(!Array.isArray(n))return kF(n);const t=e.split(AF),i={};let r=-1,s=0;for(let o=0;o<t.length;o++){const a=iS(t[o]);for(let c=0;c<a.length;c++)r++,n[s]&&n[s].start<=r&&r<n[s].end&&(i[o]=i[o]||{},i[o][c]=xt({},n[s].style),r===n[s].end-1&&s++)}return i},rp=["display","transform",Sa,"fill-opacity","fill-rule","opacity",yc,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function y7(n,e){const t=n.nodeName,i=n.getAttribute("class"),r=n.getAttribute("id"),s="(?![a-zA-Z\\-]+)";let o;if(o=new RegExp("^"+t,"i"),e=e.replace(o,""),r&&e.length&&(o=new RegExp("#"+r+s,"i"),e=e.replace(o,"")),i&&e.length){const a=i.split(" ");for(let c=a.length;c--;)o=new RegExp("\\."+a[c]+s,"i"),e=e.replace(o,"")}return e.length===0}function E6e(n,e){let t=!0;const i=y7(n,e.pop());return i&&e.length&&(t=(function(r,s){let o,a=!0;for(;r.parentElement&&r.parentElement.nodeType===1&&s.length;)a&&(o=s.pop()),a=y7(r=r.parentElement,o);return s.length===0})(n,e)),i&&t&&e.length===0}const k6e=n=>{var e;return(e=zEe[n])!==null&&e!==void 0?e:n},I6e=new RegExp("(".concat(bu,")"),"gi"),F6e=n=>n.replace(I6e," $1 ").replace(/,/gi," ").replace(/\s+/gi," ");var v7,w7,x7,b7,_7,C7,S7;const Ac="(".concat(bu,")"),D6e=String.raw(v7||(v7=Id(["(skewX)(",")"],["(skewX)\\(","\\)"])),Ac),j6e=String.raw(w7||(w7=Id(["(skewY)(",")"],["(skewY)\\(","\\)"])),Ac),P6e=String.raw(x7||(x7=Id(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),Ac,Ac,Ac),N6e=String.raw(b7||(b7=Id(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),Ac,Ac),L6e=String.raw(_7||(_7=Id(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),Ac,Ac),M6e=String.raw(C7||(C7=Id(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),Ac,Ac,Ac,Ac,Ac,Ac),IF="(?:".concat(M6e,"|").concat(L6e,"|").concat(P6e,"|").concat(N6e,"|").concat(D6e,"|").concat(j6e,")"),R6e="(?:".concat(IF,"*)"),O6e=String.raw(S7||(S7=Id(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),R6e),U6e=new RegExp(O6e),H6e=new RegExp(IF),W6e=new RegExp(IF,"g");function TC(n){const e=[];if(!(n=F6e(n).replace(/\s*([()])\s*/gi,"$1"))||n&&!U6e.test(n))return[...vc];for(const t of n.matchAll(W6e)){const i=H6e.exec(t[0]);if(!i)continue;let r=vc;const s=i.filter((g=>!!g)),[,o,...a]=s,[c,h,u,d,f,A]=a.map((g=>parseFloat(g)));switch(o){case"translate":r=n1(c,h);break;case fF:r=jg({angle:c},{x:h,y:u});break;case q5:r=Z5(c,h);break;case e1:r=yF(c);break;case t1:r=vF(c);break;case"matrix":r=[c,h,u,d,f,A]}e.push(r)}return Y5(e)}function Q6e(n,e,t,i){const r=Array.isArray(e);let s,o=e;if(n!==Sa&&n!==yc||e!==mc){if(n==="strokeUniform")return e==="non-scaling-stroke";if(n==="strokeDashArray")o=e===mc?null:e.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(n==="transformMatrix")o=t&&t.transformMatrix?Aa(t.transformMatrix,TC(e)):TC(e);else if(n==="visible")o=e!==mc&&e!=="hidden",t&&t.visible===!1&&(o=!1);else if(n==="opacity")o=parseFloat(e),t&&t.opacity!==void 0&&(o*=t.opacity);else if(n==="textAnchor")o=e==="start"?Es:e==="end"?la:Br;else if(n==="charSpacing"||n===yg)s=dc(e,i)/i*1e3;else if(n==="paintFirst"){const a=e.indexOf(Sa),c=e.indexOf(yc);o=Sa,(a>-1&&c>-1&&c<a||a===-1&&c>-1)&&(o=yc)}else{if(n==="href"||n==="xlink:href"||n==="font"||n==="id")return e;if(n==="imageSmoothing")return e==="optimizeQuality";s=r?e.map(dc):dc(e,i)}}else o="";return!r&&isNaN(s)?o:s}function $6e(n,e){const t=n.match(VEe);if(!t)return;const i=t[1],r=t[3],s=t[4],o=t[5],a=t[6];i&&(e.fontStyle=i),r&&(e.fontWeight=isNaN(parseFloat(r))?r:parseFloat(r)),s&&(e.fontSize=dc(s)),a&&(e.fontFamily=a),o&&(e.lineHeight=o==="normal"?1:o)}function m6(n,e){n.replace(/;\s*$/,"").split(";").forEach((t=>{if(!t)return;const[i,r]=t.split(":");e[i.trim().toLowerCase()]=r.trim()}))}function V6e(n){const e={},t=n.getAttribute("style");return t&&(typeof t=="string"?m6(t,e):(function(i,r){Object.entries(i).forEach((s=>{let[o,a]=s;a!==void 0&&(r[o.toLowerCase()]=a)}))})(t,e)),e}const z6e={stroke:"strokeOpacity",fill:"fillOpacity"};function PA(n,e,t){if(!n)return{};let i,r={},s=dF;n.parentNode&&l7.test(n.parentNode.nodeName)&&(r=PA(n.parentElement,e,t),r.fontSize&&(i=s=dc(r.fontSize)));const o=xt(xt(xt({},e.reduce(((h,u)=>{const d=n.getAttribute(u);return d&&(h[u]=d),h}),{})),(function(h){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d={};for(const f in u)E6e(h,f.split(" "))&&(d=xt(xt({},d),u[f]));return d})(n,t)),V6e(n));o[gT]&&n.setAttribute(gT,o[gT]),o[pT]&&(i=dc(o[pT],s),o[pT]="".concat(i));const a={};for(const h in o){const u=k6e(h),d=Q6e(u,o[h],r,i);a[u]=d}a&&a.font&&$6e(a.font,a);const c=xt(xt({},r),a);return l7.test(n.nodeName)?c:(function(h){const u=Zl.getDefaults();return Object.entries(z6e).forEach((d=>{let[f,A]=d;if(h[A]===void 0||h[f]==="")return;if(h[f]===void 0){if(!u[f])return;h[f]=u[f]}if(h[f].indexOf("url(")===0)return;const g=new Fs(h[f]);h[f]=g.setAlpha(Xs(g.getAlpha()*h[A],2)).toRgba()})),h})(c)}const G6e=["left","top","width","height","visible"],gX=["rx","ry"];class ol extends Zl{static getDefaults(){return xt(xt({},super.getDefaults()),ol.ownDefaults)}constructor(e){super(),Object.assign(this,ol.ownDefaults),this.setOptions(e),this._initRxRy()}_initRxRy(){const{rx:e,ry:t}=this;e&&!t?this.ry=e:t&&!e&&(this.rx=t)}_render(e){const{width:t,height:i}=this,r=-t/2,s=-i/2,o=this.rx?Math.min(this.rx,t/2):0,a=this.ry?Math.min(this.ry,i/2):0,c=o!==0||a!==0;e.beginPath(),e.moveTo(r+o,s),e.lineTo(r+t-o,s),c&&e.bezierCurveTo(r+t-sf*o,s,r+t,s+sf*a,r+t,s+a),e.lineTo(r+t,s+i-a),c&&e.bezierCurveTo(r+t,s+i-sf*a,r+t-sf*o,s+i,r+t-o,s+i),e.lineTo(r+o,s+i),c&&e.bezierCurveTo(r+sf*o,s+i,r,s+i-sf*a,r,s+i-a),e.lineTo(r,s+a),c&&e.bezierCurveTo(r,s+sf*a,r+sf*o,s,r+o,s),e.closePath(),this._renderPaintInOrder(e)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...gX,...e])}_toSVG(){const{width:e,height:t,rx:i,ry:r}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-e/2,'" y="').concat(-t/2,'" rx="').concat(i,'" ry="').concat(r,'" width="').concat(e,'" height="').concat(t,`" />
`)]}static async fromElement(e,t,i){const r=PA(e,this.ATTRIBUTE_NAMES,i),{left:s=0,top:o=0,width:a=0,height:c=0,visible:h=!0}=r,u=Bo(r,G6e);return new this(xt(xt(xt({},t),u),{},{left:s,top:o,width:a,height:c,visible:!!(h&&a&&c)}))}}bt(ol,"type","Rect"),bt(ol,"cacheProperties",[...jA,...gX]),bt(ol,"ownDefaults",{rx:0,ry:0}),bt(ol,"ATTRIBUTE_NAMES",[...rp,"x","y","rx","ry","width","height"]),bi.setClass(ol),bi.setSVGClass(ol);const hA="initialization",BC="added",FF="removed",EC="imperative",mX=(n,e)=>{const{strokeUniform:t,strokeWidth:i,width:r,height:s,group:o}=e,a=o&&o!==n?cw(o.calcTransformMatrix(),n.calcTransformMatrix()):null,c=a?e.getRelativeCenterPoint().transform(a):e.getRelativeCenterPoint(),h=!e.isStrokeAccountedForInDimensions(),u=t&&h?$G(new Gt(i,i),void 0,n.calcTransformMatrix()):pF,d=!t&&h?i:0,f=J5(r+d,s+d,Y5([a,e.calcOwnMatrix()],!0)).add(u).scalarDivide(2);return[c.subtract(f),c.add(f)]};class sS{calcLayoutResult(e,t){if(this.shouldPerformLayout(e))return this.calcBoundingBox(t,e)}shouldPerformLayout(e){let{type:t,prevStrategy:i,strategy:r}=e;return t===hA||t===EC||!!i&&r!==i}shouldLayoutClipPath(e){let{type:t,target:{clipPath:i}}=e;return t!==hA&&i&&!i.absolutePositioned}getInitialSize(e,t){return t.size}calcBoundingBox(e,t){const{type:i,target:r}=t;if(i===EC&&t.overrides)return t.overrides;if(e.length===0)return;const{left:s,top:o,width:a,height:c}=md(e.map((d=>mX(r,d))).reduce(((d,f)=>d.concat(f)),[])),h=new Gt(a,c),u=new Gt(s,o).add(h.scalarDivide(2));if(i===hA){const d=this.getInitialSize(t,{size:h,center:u});return{center:u,relativeCorrection:new Gt(0,0),size:d}}return{center:u.transform(r.calcOwnMatrix()),size:h}}}bt(sS,"type","strategy");class y6 extends sS{shouldPerformLayout(e){return!0}}bt(y6,"type","fit-content"),bi.setClass(y6);const X6e=["strategy"],K6e=["target","strategy","bubbles","prevStrategy"],yX="layoutManager";class wv{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new y6;bt(this,"strategy",void 0),this.strategy=e,this._subscriptions=new Map}performLayout(e){const t=xt(xt({bubbles:!0,strategy:this.strategy},e),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(t);const i=this.getLayoutResult(t);i&&this.commitLayout(t,i),this.onAfterLayout(t,i),this._prevLayoutStrategy=t.strategy}attachHandlers(e,t){const{target:i}=t;return[yC,TG,mv,BG,K5,EG,mC,PEe,NEe].map((r=>e.on(r,(s=>this.performLayout(r===yC?{type:"object_modified",trigger:r,e:s,target:i}:{type:"object_modifying",trigger:r,e:s,target:i})))))}subscribe(e,t){this.unsubscribe(e,t);const i=this.attachHandlers(e,t);this._subscriptions.set(e,i)}unsubscribe(e,t){(this._subscriptions.get(e)||[]).forEach((i=>i())),this._subscriptions.delete(e)}unsubscribeTargets(e){e.targets.forEach((t=>this.unsubscribe(t,e)))}subscribeTargets(e){e.targets.forEach((t=>this.subscribe(t,e)))}onBeforeLayout(e){const{target:t,type:i}=e,{canvas:r}=t;if(i===hA||i===BC?this.subscribeTargets(e):i===FF&&this.unsubscribeTargets(e),t.fire("layout:before",{context:e}),r&&r.fire("object:layout:before",{target:t,context:e}),i===EC&&e.deep){const s=Bo(e,X6e);t.forEachObject((o=>o.layoutManager&&o.layoutManager.performLayout(xt(xt({},s),{},{bubbles:!1,target:o}))))}}getLayoutResult(e){const{target:t,strategy:i,type:r}=e,s=i.calcLayoutResult(e,t.getObjects());if(!s)return;const o=r===hA?new Gt:t.getRelativeCenterPoint(),{center:a,correction:c=new Gt,relativeCorrection:h=new Gt}=s,u=o.subtract(a).add(c).transform(r===hA?vc:Oc(t.calcOwnMatrix()),!0).add(h);return{result:s,prevCenter:o,nextCenter:a,offset:u}}commitLayout(e,t){const{target:i}=e,{result:{size:r},nextCenter:s}=t;var o,a;i.set({width:r.x,height:r.y}),this.layoutObjects(e,t),e.type===hA?i.set({left:(o=e.x)!==null&&o!==void 0?o:s.x+r.x*xa(i.originX),top:(a=e.y)!==null&&a!==void 0?a:s.y+r.y*xa(i.originY)}):(i.setPositionByOrigin(s,Br,Br),i.setCoords(),i.set("dirty",!0))}layoutObjects(e,t){const{target:i}=e;i.forEachObject((r=>{r.group===i&&this.layoutObject(e,t,r)})),e.strategy.shouldLayoutClipPath(e)&&this.layoutObject(e,t,i.clipPath)}layoutObject(e,t,i){let{offset:r}=t;i.set({left:i.left+r.x,top:i.top+r.y})}onAfterLayout(e,t){const{target:i,strategy:r,bubbles:s,prevStrategy:o}=e,a=Bo(e,K6e),{canvas:c}=i;i.fire("layout:after",{context:e,result:t}),c&&c.fire("object:layout:after",{context:e,result:t,target:i});const h=i.parent;s&&h!=null&&h.layoutManager&&((a.path||(a.path=[])).push(i),h.layoutManager.performLayout(xt(xt({},a),{},{target:h}))),i.set("dirty",!0)}dispose(){const{_subscriptions:e}=this;e.forEach((t=>t.forEach((i=>i())))),e.clear()}toObject(){return{type:yX,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}}bi.setClass(wv,yX);const q6e=["type","objects","layoutManager"];class Y6e extends wv{performLayout(){}}class hh extends kG(Zl){static getDefaults(){return xt(xt({},super.getDefaults()),hh.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),bt(this,"_activeObjects",[]),bt(this,"__objectSelectionTracker",void 0),bt(this,"__objectSelectionDisposer",void 0),Object.assign(this,hh.ownDefaults),this.setOptions(t),this.groupInit(e,t)}groupInit(e,t){var i;this._objects=[...e],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject((r=>{this.enterGroup(r,!1)})),this.layoutManager=(i=t.layoutManager)!==null&&i!==void 0?i:new wv,this.layoutManager.performLayout({type:hA,target:this,targets:[...e],x:t.left,y:t.top})}canEnterGroup(e){return e===this||this.isDescendantOf(e)?(SA("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(e)===-1||(SA("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(e){return e.filter(((t,i,r)=>this.canEnterGroup(t)&&r.indexOf(t)===i))}add(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const r=this._filterObjectsBeforeEnteringGroup(t),s=super.add(...r);return this._onAfterObjectsChange(BC,r),s}insertAt(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];const s=this._filterObjectsBeforeEnteringGroup(i),o=super.insertAt(e,...s);return this._onAfterObjectsChange(BC,s),o}remove(){const e=super.remove(...arguments);return this._onAfterObjectsChange(FF,e),e}_onObjectAdded(e){this.enterGroup(e,!0),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e,t){this.exitGroup(e,t),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onAfterObjectsChange(e,t){this.layoutManager.performLayout({type:e,targets:t,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(e,t){const i=this[e];return super._set(e,t),e==="canvas"&&i!==t&&(this._objects||[]).forEach((r=>{r._set(e,t)})),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(e,t){let{target:i}=t;const r=this._activeObjects;if(e)r.push(i),this._set("dirty",!0);else if(r.length>0){const s=r.indexOf(i);s>-1&&(r.splice(s,1),this._set("dirty",!0))}}_watchObject(e,t){e&&this._watchObject(!1,t),e?(t.on("selected",this.__objectSelectionTracker),t.on("deselected",this.__objectSelectionDisposer)):(t.off("selected",this.__objectSelectionTracker),t.off("deselected",this.__objectSelectionDisposer))}enterGroup(e,t){e.group&&e.group.remove(e),e._set("parent",this),this._enterGroup(e,t)}_enterGroup(e,t){t&&jm(e,Aa(Oc(this.calcTransformMatrix()),e.calcTransformMatrix())),this._shouldSetNestedCoords()&&e.setCoords(),e._set("group",this),e._set("canvas",this.canvas),this._watchObject(!0,e);const i=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();i&&(i===e||e.isDescendantOf(i))&&this._activeObjects.push(e)}exitGroup(e,t){this._exitGroup(e,t),e._set("parent",void 0),e._set("canvas",void 0)}_exitGroup(e,t){e._set("group",void 0),t||(jm(e,Aa(this.calcTransformMatrix(),e.calcTransformMatrix())),e.setCoords()),this._watchObject(!1,e);const i=this._activeObjects.length>0?this._activeObjects.indexOf(e):-1;i>-1&&this._activeObjects.splice(i,1)}shouldCache(){const e=Zl.prototype.shouldCache.call(this);if(e){for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return this.ownCaching=!1,!1}return e}willDrawShadow(){if(super.willDrawShadow())return!0;for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(e,t,i){this._renderBackground(e);for(let s=0;s<this._objects.length;s++){var r;const o=this._objects[s];(r=this.canvas)!==null&&r!==void 0&&r.preserveObjectStacking&&o.group!==this?(e.save(),e.transform(...Oc(this.calcTransformMatrix())),o.render(e),e.restore()):o.group===this&&o.render(e)}this._drawClipPath(e,this.clipPath,i)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject((e=>e.setCoords()))}triggerLayout(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(xt({target:this,type:EC},e))}render(e){this._transformDone=!0,super.render(e),this._transformDone=!1}__serializeObjects(e,t){const i=this.includeDefaultValues;return this._objects.filter((function(r){return!r.excludeFromExport})).map((function(r){const s=r.includeDefaultValues;r.includeDefaultValues=i;const o=r[e||"toObject"](t);return r.includeDefaultValues=s,o}))}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.layoutManager.toObject();return xt(xt(xt({},super.toObject(["subTargetCheck","interactive",...e])),t.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:t}:{}),{},{objects:this.__serializeObjects("toObject",e)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject((e=>{this._watchObject(!1,e),e.dispose()})),super.dispose()}_createSVGBgRect(e){if(!this.backgroundColor)return"";const t=ol.prototype._toSVG.call(this),i=t.indexOf("COMMON_PARTS");t[i]='for="group" ';const r=t.join("");return e?e(r):r}_toSVG(e){const t=["<g ","COMMON_PARTS",` >
`],i=this._createSVGBgRect(e);i&&t.push("		",i);for(let r=0;r<this._objects.length;r++)t.push("		",this._objects[r].toSVG(e));return t.push(`</g>
`),t}getSvgStyles(){const e=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",t=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),t].join("")}toClipPathSVG(e){const t=[],i=this._createSVGBgRect(e);i&&t.push("	",i);for(let r=0;r<this._objects.length;r++)t.push("	",this._objects[r].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(t,{reviver:e})}static fromObject(e,t){let{type:i,objects:r=[],layoutManager:s}=e,o=Bo(e,q6e);return Promise.all([Fm(r,t),aw(o,t)]).then((a=>{let[c,h]=a;const u=new this(c,xt(xt(xt({},o),h),{},{layoutManager:new Y6e}));if(s){const d=bi.getClass(s.type),f=bi.getClass(s.strategy);u.layoutManager=new d(new f)}else u.layoutManager=new wv;return u.layoutManager.subscribeTargets({type:hA,target:u,targets:u.getObjects()}),u.setCoords(),u}))}}bt(hh,"type","Group"),bt(hh,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),bi.setClass(hh);const vX=(n,e)=>Math.min(e.width/n.width,e.height/n.height),wX=(n,e)=>Math.max(e.width/n.width,e.height/n.height),v6="\\s*,?\\s*",X1="".concat(v6,"(").concat(bu,")"),Z6e="".concat(X1).concat(X1).concat(X1).concat(v6,"([01])").concat(v6,"([01])").concat(X1).concat(X1),J6e={m:"l",M:"L"},eke=(n,e,t,i,r,s,o,a,c,h,u)=>{const d=ju(n),f=Pu(n),A=ju(e),g=Pu(e),p=t*r*A-i*s*g+o,y=i*r*A+t*s*g+a;return["C",h+c*(-t*r*f-i*s*d),u+c*(-i*r*f+t*s*d),p+c*(t*r*g+i*s*A),y+c*(i*r*g-t*s*A),p,y]},T7=(n,e,t,i)=>{const r=Math.atan2(e,n),s=Math.atan2(i,t);return s>=r?s-r:2*Math.PI-(r-s)};function w6(n,e,t,i,r,s,o,a){let c;if(ds.cachesBoundsOfCurve&&(c=[...arguments].join(),My.boundsOfCurveCache[c]))return My.boundsOfCurveCache[c];const h=Math.sqrt,u=Math.abs,d=[],f=[[0,0],[0,0]];let A=6*n-12*t+6*r,g=-3*n+9*t-9*r+3*o,p=3*t-3*n;for(let x=0;x<2;++x){if(x>0&&(A=6*e-12*i+6*s,g=-3*e+9*i-9*s+3*a,p=3*i-3*e),u(g)<1e-12){if(u(A)<1e-12)continue;const _=-p/A;0<_&&_<1&&d.push(_);continue}const T=A*A-4*p*g;if(T<0)continue;const j=h(T),D=(-A+j)/(2*g);0<D&&D<1&&d.push(D);const b=(-A-j)/(2*g);0<b&&b<1&&d.push(b)}let y=d.length;const v=y,m=bX(n,e,t,i,r,s,o,a);for(;y--;){const{x,y:T}=m(d[y]);f[0][y]=x,f[1][y]=T}f[0][v]=n,f[1][v]=e,f[0][v+1]=o,f[1][v+1]=a;const w=[new Gt(Math.min(...f[0]),Math.min(...f[1])),new Gt(Math.max(...f[0]),Math.max(...f[1]))];return ds.cachesBoundsOfCurve&&(My.boundsOfCurveCache[c]=w),w}const tke=(n,e,t)=>{let[i,r,s,o,a,c,h,u]=t;const d=((f,A,g,p,y,v,m)=>{if(g===0||p===0)return[];let w=0,x=0,T=0;const j=Math.PI,D=m*uF,b=Pu(D),_=ju(D),I=.5*(-_*f-b*A),S=.5*(-_*A+b*f),F=g**2,B=p**2,E=S**2,V=I**2,K=F*B-F*E-B*V;let P=Math.abs(g),M=Math.abs(p);if(K<0){const fe=Math.sqrt(1-K/(F*B));P*=fe,M*=fe}else T=(y===v?-1:1)*Math.sqrt(K/(F*E+B*V));const X=T*P*S/M,Z=-T*M*I/P,Q=_*X-b*Z+.5*f,U=b*X+_*Z+.5*A;let z=T7(1,0,(I-X)/P,(S-Z)/M),q=T7((I-X)/P,(S-Z)/M,(-I-X)/P,(-S-Z)/M);v===0&&q>0?q-=2*j:v===1&&q<0&&(q+=2*j);const G=Math.ceil(Math.abs(q/j*2)),ie=[],H=q/G,se=8/3*Math.sin(H/4)*Math.sin(H/4)/Math.sin(H/2);let te=z+H;for(let fe=0;fe<G;fe++)ie[fe]=eke(z,te,_,b,P,M,Q,U,se,w,x),w=ie[fe][5],x=ie[fe][6],z=te,te+=H;return ie})(h-n,u-e,r,s,a,c,o);for(let f=0,A=d.length;f<A;f++)d[f][1]+=n,d[f][2]+=e,d[f][3]+=n,d[f][4]+=e,d[f][5]+=n,d[f][6]+=e;return d},xX=n=>{let e=0,t=0,i=0,r=0;const s=[];let o,a=0,c=0;for(const h of n){const u=[...h];let d;switch(u[0]){case"l":u[1]+=e,u[2]+=t;case"L":e=u[1],t=u[2],d=["L",e,t];break;case"h":u[1]+=e;case"H":e=u[1],d=["L",e,t];break;case"v":u[1]+=t;case"V":t=u[1],d=["L",e,t];break;case"m":u[1]+=e,u[2]+=t;case"M":e=u[1],t=u[2],i=u[1],r=u[2],d=["M",e,t];break;case"c":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t,u[5]+=e,u[6]+=t;case"C":a=u[3],c=u[4],e=u[5],t=u[6],d=["C",u[1],u[2],a,c,e,t];break;case"s":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t;case"S":o==="C"?(a=2*e-a,c=2*t-c):(a=e,c=t),e=u[3],t=u[4],d=["C",a,c,u[1],u[2],e,t],a=d[3],c=d[4];break;case"q":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t;case"Q":a=u[1],c=u[2],e=u[3],t=u[4],d=["Q",a,c,e,t];break;case"t":u[1]+=e,u[2]+=t;case"T":o==="Q"?(a=2*e-a,c=2*t-c):(a=e,c=t),e=u[1],t=u[2],d=["Q",a,c,e,t];break;case"a":u[6]+=e,u[7]+=t;case"A":tke(e,t,u).forEach((f=>s.push(f))),e=u[6],t=u[7];break;case"z":case"Z":e=i,t=r,d=["Z"]}d?(s.push(d),o=d[0]):o=""}return s},kC=(n,e,t,i)=>Math.sqrt((t-n)**2+(i-e)**2),bX=(n,e,t,i,r,s,o,a)=>c=>{const h=c**3,u=(A=>3*A**2*(1-A))(c),d=(A=>3*A*(1-A)**2)(c),f=(A=>(1-A)**3)(c);return new Gt(o*h+r*u+t*d+n*f,a*h+s*u+i*d+e*f)},_X=n=>n**2,CX=n=>2*n*(1-n),SX=n=>(1-n)**2,nke=(n,e,t,i,r,s,o,a)=>c=>{const h=_X(c),u=CX(c),d=SX(c),f=3*(d*(t-n)+u*(r-t)+h*(o-r)),A=3*(d*(i-e)+u*(s-i)+h*(a-s));return Math.atan2(A,f)},ike=(n,e,t,i,r,s)=>o=>{const a=_X(o),c=CX(o),h=SX(o);return new Gt(r*a+t*c+n*h,s*a+i*c+e*h)},rke=(n,e,t,i,r,s)=>o=>{const a=1-o,c=2*(a*(t-n)+o*(r-t)),h=2*(a*(i-e)+o*(s-i));return Math.atan2(h,c)},B7=(n,e,t)=>{let i=new Gt(e,t),r=0;for(let s=1;s<=100;s+=1){const o=n(s/100);r+=kC(i.x,i.y,o.x,o.y),i=o}return r},ske=(n,e)=>{let t,i=0,r=0,s={x:n.x,y:n.y},o=xt({},s),a=.01,c=0;const h=n.iterator,u=n.angleFinder;for(;r<e&&a>1e-4;)o=h(i),c=i,t=kC(s.x,s.y,o.x,o.y),t+r>e?(i-=a,a/=2):(s=o,i+=a,r+=t);return xt(xt({},o),{},{angle:u(c)})},DF=n=>{let e,t,i=0,r=0,s=0,o=0,a=0;const c=[];for(const h of n){const u={x:r,y:s,command:h[0],length:0};switch(h[0]){case"M":t=u,t.x=o=r=h[1],t.y=a=s=h[2];break;case"L":t=u,t.length=kC(r,s,h[1],h[2]),r=h[1],s=h[2];break;case"C":e=bX(r,s,h[1],h[2],h[3],h[4],h[5],h[6]),t=u,t.iterator=e,t.angleFinder=nke(r,s,h[1],h[2],h[3],h[4],h[5],h[6]),t.length=B7(e,r,s),r=h[5],s=h[6];break;case"Q":e=ike(r,s,h[1],h[2],h[3],h[4]),t=u,t.iterator=e,t.angleFinder=rke(r,s,h[1],h[2],h[3],h[4]),t.length=B7(e,r,s),r=h[3],s=h[4];break;case"Z":t=u,t.destX=o,t.destY=a,t.length=kC(r,s,o,a),r=o,s=a}i+=t.length,c.push(t)}return c.push({length:i,x:r,y:s}),c},TX=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:DF(n),i=0;for(;e-t[i].length>0&&i<t.length-2;)e-=t[i].length,i++;const r=t[i],s=e/r.length,o=n[i];switch(r.command){case"M":return{x:r.x,y:r.y,angle:0};case"Z":return xt(xt({},new Gt(r.x,r.y).lerp(new Gt(r.destX,r.destY),s)),{},{angle:Math.atan2(r.destY-r.y,r.destX-r.x)});case"L":return xt(xt({},new Gt(r.x,r.y).lerp(new Gt(o[1],o[2]),s)),{},{angle:Math.atan2(o[2]-r.y,o[1]-r.x)});case"C":case"Q":return ske(r,e)}},oke=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),E7=new RegExp(Z6e,"g"),ake=new RegExp(bu,"gi"),lke={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},BX=n=>{var e;const t=[],i=(e=n.match(oke))!==null&&e!==void 0?e:[];for(const r of i){const s=r[0];if(s==="z"||s==="Z"){t.push([s]);continue}const o=lke[s.toLowerCase()];let a=[];if(s==="a"||s==="A"){E7.lastIndex=0;for(let c=null;c=E7.exec(r);)a.push(...c.slice(1))}else a=r.match(ake)||[];for(let c=0;c<a.length;c+=o){const h=new Array(o),u=J6e[s];h[0]=c>0&&u?u:s;for(let d=0;d<o;d++)h[d+1]=parseFloat(a[c+d]);t.push(h)}}return t},cke=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=new Gt(n[0]),i=new Gt(n[1]),r=1,s=0;const o=[],a=n.length,c=a>2;let h;for(c&&(r=n[2].x<i.x?-1:n[2].x===i.x?0:1,s=n[2].y<i.y?-1:n[2].y===i.y?0:1),o.push(["M",t.x-r*e,t.y-s*e]),h=1;h<a;h++){if(!t.eq(i)){const u=t.midPointFrom(i);o.push(["Q",t.x,t.y,u.x,u.y])}t=n[h],h+1<n.length&&(i=n[h+1])}return c&&(r=t.x>n[h-2].x?1:t.x===n[h-2].x?0:-1,s=t.y>n[h-2].y?1:t.y===n[h-2].y?0:-1),o.push(["L",t.x+r*e,t.y+s*e]),o},EX=(n,e)=>n.map((t=>t.map(((i,r)=>r===0||e===void 0?i:Xs(i,e))).join(" "))).join(" ");function IC(n,e){const t=n.style;t&&e&&(typeof e=="string"?t.cssText+=";"+e:Object.entries(e).forEach((i=>{let[r,s]=i;return t.setProperty(r,s)})))}const hke=(n,e)=>Math.floor(Math.random()*(e-n+1))+n;function uke(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=e.onComplete||ng,i=new(Jm()).XMLHttpRequest,r=e.signal,s=function(){i.abort()},o=function(){r&&r.removeEventListener("abort",s),i.onerror=i.ontimeout=ng};if(r&&r.aborted)throw new hF("request");return r&&r.addEventListener("abort",s,{once:!0}),i.onreadystatechange=function(){i.readyState===4&&(o(),t(i),i.onreadystatechange=ng)},i.onerror=i.ontimeout=o,i.open("get",n,!0),i.send(),i}const o_=(n,e)=>{let t=n._findCenterFromElement();n.transformMatrix&&((i=>{if(i.transformMatrix){const{scaleX:r,scaleY:s,angle:o,skewX:a}=mg(i.transformMatrix);i.flipX=!1,i.flipY=!1,i.set(wc,r),i.set(Ah,s),i.angle=o,i.skewX=a,i.skewY=0}})(n),t=t.transform(n.transformMatrix)),delete n.transformMatrix,e&&(n.scaleX*=e.scaleX,n.scaleY*=e.scaleY,n.cropX=e.cropX,n.cropY=e.cropY,t.x+=e.offsetLeft,t.y+=e.offsetTop,n.width=e.width,n.height=e.height),n.setPositionByOrigin(t,Br,Br)};var dke=Object.freeze({__proto__:null,addTransformToObject:WG,animate:BF,animateColor:rX,applyTransformToObject:jm,calcAngleBetweenVectors:SC,calcDimensionsMatrix:ow,calcPlaneChangeMatrix:cw,calcVectorRotation:tX,cancelAnimFrame:FG,capValue:vg,composeMatrix:LG,copyCanvasElement:n=>{var e;const t=fh(n);return(e=t.getContext("2d"))===null||e===void 0||e.drawImage(n,0,0),t},cos:ju,createCanvasElement:Cd,createImage:DG,createRotateMatrix:jg,createScaleMatrix:Z5,createSkewXMatrix:yF,createSkewYMatrix:vF,createTranslateMatrix:n1,createVector:_C,crossProduct:um,degreesToRadians:Xo,dotProduct:nX,ease:ZEe,enlivenObjectEnlivables:aw,enlivenObjects:Fm,findScaleToCover:wX,findScaleToFit:vX,getBoundsOfCurve:w6,getOrthonormalVector:SF,getPathSegmentsInfo:DF,getPointOnPath:TX,getPointer:HG,getRandomInt:hke,getRegularPolygonPath:(n,e)=>{const t=2*Math.PI/n;let i=-zf;n%2==0&&(i+=t/2);const r=new Array(n+1);for(let s=0;s<n;s++){const o=s*t+i,{x:a,y:c}=new Gt(ju(o),Pu(o)).scalarMultiply(e);r[s]=[s===0?"M":"L",a,c]}return r[n]=["Z"],r},getSmoothPathFromPoints:cke,getSvgAttributes:n=>{const e=["instantiated_by_use","style","id","class"];switch(n){case"linearGradient":return e.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);case"radialGradient":return e.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);case"stop":return e.concat(["offset","stop-color","stop-opacity"])}return e},getUnitVector:tS,groupSVGElements:(n,e)=>n&&n.length===1?n[0]:new hh(n,e),hasStyleChanged:rS,invertTransform:Oc,isBetweenVectors:p6,isIdentityMatrix:jG,isTouchEvent:wC,isTransparent:hX,joinPath:EX,loadImage:Oy,magnitude:CC,makeBoundingBoxFromPoints:md,makePathSimpler:xX,matrixToSVG:Dm,mergeClipPaths:(n,e)=>{var t;let i=n,r=e;i.inverted&&!r.inverted&&(i=e,r=n),A6(r,(t=r.group)===null||t===void 0?void 0:t.calcTransformMatrix(),i.calcTransformMatrix());const s=i.inverted&&r.inverted;return s&&(i.inverted=r.inverted=!1),new hh([i],{clipPath:r,inverted:s})},multiplyTransformMatrices:Aa,multiplyTransformMatrixArray:Y5,parsePath:BX,parsePreserveAspectRatioAttribute:_F,parseUnit:dc,pick:Pg,projectStrokeOnPoints:dX,qrDecompose:mg,radiansToDegrees:Sd,removeFromArray:Mp,removeTransformFromObject:(n,e)=>{const t=Oc(e),i=Aa(t,n.calcOwnMatrix());jm(n,i)},removeTransformMatrixForSvgParsing:o_,request:uke,requestAnimFrame:Ry,resetObjectTransform:QG,rotatePoint:(n,e,t)=>n.rotate(t,e),rotateVector:CF,saveObjectTransform:xF,sendObjectToPlane:A6,sendPointToPlane:ig,sendVectorToPlane:$G,setStyle:IC,sin:Pu,sizeAfterTransform:J5,string:B6e,stylesFromArray:pX,stylesToArray:fX,toBlob:mF,toDataURL:gF,toFixed:Xs,transformPath:(n,e,t)=>(t&&(e=Aa(e,[1,0,0,1,-t.x,-t.y])),n.map((i=>{const r=[...i];for(let s=1;s<i.length-1;s+=2){const{x:o,y:a}=Kl({x:i[s],y:i[s+1]},e);r[s]=o,r[s+1]=a}return r}))),transformPoint:Kl});class Ake extends UG{constructor(e){let{allowTouchScrolling:t=!1,containerClass:i=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),bt(this,"upper",void 0),bt(this,"container",void 0);const{el:r}=this.lower,s=this.createUpperCanvas();this.upper={el:s,ctx:s.getContext("2d")},this.applyCanvasStyle(r,{allowTouchScrolling:t}),this.applyCanvasStyle(s,{allowTouchScrolling:t,styles:{position:"absolute",left:"0",top:"0"}});const o=this.createContainerElement();o.classList.add(i),r.parentNode&&r.parentNode.replaceChild(o,r),o.append(r,s),this.container=o}createUpperCanvas(){const{el:e}=this.lower,t=Cd();return t.className=e.className,t.classList.remove("lower-canvas"),t.classList.add("upper-canvas"),t.setAttribute("data-fabric","top"),t.style.cssText=e.style.cssText,t.setAttribute("draggable","true"),t}createContainerElement(){const e=Zm().createElement("div");return e.setAttribute("data-fabric","wrapper"),IC(e,{position:"relative"}),ZM(e),e}applyCanvasStyle(e,t){const{styles:i,allowTouchScrolling:r}=t;IC(e,xt(xt({},i),{},{"touch-action":r?"manipulation":mc})),ZM(e)}setDimensions(e,t){super.setDimensions(e,t);const{el:i,ctx:r}=this.upper;OG(i,r,e,t)}setCSSDimensions(e){super.setCSSDimensions(e),d6(this.upper.el,e),d6(this.container,e)}cleanupDOM(e){const t=this.container,{el:i}=this.lower,{el:r}=this.upper;super.cleanupDOM(e),t.removeChild(r),t.removeChild(i),t.parentNode&&t.parentNode.replaceChild(i,t)}dispose(){super.dispose(),_d().dispose(this.upper.el),delete this.upper,delete this.container}}class oS extends lw{constructor(){super(...arguments),bt(this,"targets",[]),bt(this,"_hoveredTargets",[]),bt(this,"_objectsToRender",void 0),bt(this,"_currentTransform",null),bt(this,"_groupSelector",null),bt(this,"contextTopDirty",!1)}static getDefaults(){return xt(xt({},super.getDefaults()),oS.ownDefaults)}get upperCanvasEl(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.el}get contextTop(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.ctx}get wrapperEl(){return this.elements.container}initElements(e){this.elements=new Ake(e,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(e){this._objectsToRender=void 0,super._onObjectAdded(e)}_onObjectRemoved(e){this._objectsToRender=void 0,e===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[e]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[e]}),e.fire("deselected",{target:e})),e===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(e)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const e=this._activeObject;return!this.preserveObjectStacking&&e?this._objects.filter((t=>!t.group&&t!==e)).concat(e):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()}renderTop(){const e=this.contextTop;this.clearContext(e),this.renderTopLayer(e),this.fire("after:render",{ctx:e})}setTargetFindTolerance(e){e=Math.round(e),this.targetFindTolerance=e;const t=this.getRetinaScaling(),i=Math.ceil((2*e+1)*t);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=i,this.pixelFindContext.scale(t,t)}isTargetTransparent(e,t,i){const r=this.targetFindTolerance,s=this.pixelFindContext;this.clearContext(s),s.save(),s.translate(-t+r,-i+r),s.transform(...this.viewportTransform);const o=e.selectionBackgroundColor;e.selectionBackgroundColor="",e.render(s),e.selectionBackgroundColor=o,s.restore();const a=Math.round(r*this.getRetinaScaling());return hX(s,a,a,a)}_isSelectionKeyPressed(e){const t=this.selectionKey;return!!t&&(Array.isArray(t)?!!t.find((i=>!!i&&e[i]===!0)):e[t])}_shouldClearSelection(e,t){const i=this.getActiveObjects(),r=this._activeObject;return!!(!t||t&&r&&i.length>1&&i.indexOf(t)===-1&&r!==t&&!this._isSelectionKeyPressed(e)||t&&!t.evented||t&&!t.selectable&&r&&r!==t)}_shouldCenterTransform(e,t,i){if(!e)return;let r;return t===q5||t===wc||t===Ah||t===mv?r=this.centeredScaling||e.centeredScaling:t===fF&&(r=this.centeredRotation||e.centeredRotation),r?!i:i}_getOriginFromCorner(e,t){const i={x:e.originX,y:e.originY};return t&&(["ml","tl","bl"].includes(t)?i.x=la:["mr","tr","br"].includes(t)&&(i.x=Es),["tl","mt","tr"].includes(t)?i.y=u6:["bl","mb","br"].includes(t)&&(i.y=Hc)),i}_setupCurrentTransform(e,t,i){var r;const s=t.group?ig(this.getScenePoint(e),void 0,t.group.calcTransformMatrix()):this.getScenePoint(e),{key:o="",control:a}=t.getActiveControl()||{},c=i&&a?(r=a.getActionHandler(e,t,a))===null||r===void 0?void 0:r.bind(a):WEe,h=((A,g,p,y)=>{if(!g||!A)return"drag";const v=y.controls[g];return v.getActionName(p,v,y)})(i,o,e,t),u=e[this.centeredKey],d=this._shouldCenterTransform(t,h,u)?{x:Br,y:Br}:this._getOriginFromCorner(t,o),f={target:t,action:h,actionHandler:c,actionPerformed:!1,corner:o,scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,offsetX:s.x-t.left,offsetY:s.y-t.top,originX:d.x,originY:d.y,ex:s.x,ey:s.y,lastX:s.x,lastY:s.y,theta:Xo(t.angle),width:t.width,height:t.height,shiftKey:e.shiftKey,altKey:u,original:xt(xt({},xF(t)),{},{originX:d.x,originY:d.y})};this._currentTransform=f,this.fire("before:transform",{e,transform:f})}setCursor(e){this.upperCanvasEl.style.cursor=e}_drawSelection(e){const{x:t,y:i,deltaX:r,deltaY:s}=this._groupSelector,o=new Gt(t,i).transform(this.viewportTransform),a=new Gt(t+r,i+s).transform(this.viewportTransform),c=this.selectionLineWidth/2;let h=Math.min(o.x,a.x),u=Math.min(o.y,a.y),d=Math.max(o.x,a.x),f=Math.max(o.y,a.y);this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(h,u,d-h,f-u)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,h+=c,u+=c,d-=c,f-=c,Zl.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(h,u,d-h,f-u))}findTarget(e){if(this.skipTargetFind)return;const t=this.getViewportPoint(e),i=this._activeObject,r=this.getActiveObjects();if(this.targets=[],i&&r.length>=1){if(i.findControl(t,wC(e))||r.length>1&&this.searchPossibleTargets([i],t))return i;if(i===this.searchPossibleTargets([i],t)){if(this.preserveObjectStacking){const s=this.targets;this.targets=[];const o=this.searchPossibleTargets(this._objects,t);return e[this.altSelectionKey]&&o&&o!==i?(this.targets=s,i):o}return i}}return this.searchPossibleTargets(this._objects,t)}_pointIsInObjectSelectionArea(e,t){let i=e.getCoords();const r=this.getZoom(),s=e.padding/r;if(s){const[o,a,c,h]=i,u=Math.atan2(a.y-o.y,a.x-o.x),d=ju(u)*s,f=Pu(u)*s,A=d+f,g=d-f;i=[new Gt(o.x-g,o.y-A),new Gt(a.x+A,a.y-g),new Gt(c.x+g,c.y+A),new Gt(h.x-A,h.y+g)]}return jo.isPointInPolygon(t,i)}_checkTarget(e,t){return!!(e&&e.visible&&e.evented&&this._pointIsInObjectSelectionArea(e,ig(t,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing||!this.isTargetTransparent(e,t.x,t.y)))}_searchPossibleTargets(e,t){let i=e.length;for(;i--;){const r=e[i];if(this._checkTarget(r,t)){if(r_(r)&&r.subTargetCheck){const s=this._searchPossibleTargets(r._objects,t);s&&this.targets.push(s)}return r}}}searchPossibleTargets(e,t){const i=this._searchPossibleTargets(e,t);if(i&&r_(i)&&i.interactive&&this.targets[0]){const r=this.targets;for(let s=r.length-1;s>0;s--){const o=r[s];if(!r_(o)||!o.interactive)return o}return r[0]}return i}getViewportPoint(e){return this._pointer?this._pointer:this.getPointer(e,!0)}getScenePoint(e){return this._absolutePointer?this._absolutePointer:this.getPointer(e)}getPointer(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const i=this.upperCanvasEl,r=i.getBoundingClientRect();let s=HG(e),o=r.width||0,a=r.height||0;o&&a||(Hc in r&&u6 in r&&(a=Math.abs(r.top-r.bottom)),la in r&&Es in r&&(o=Math.abs(r.right-r.left))),this.calcOffset(),s.x=s.x-this._offset.left,s.y=s.y-this._offset.top,t||(s=ig(s,void 0,this.viewportTransform));const c=this.getRetinaScaling();c!==1&&(s.x/=c,s.y/=c);const h=o===0||a===0?new Gt(1,1):new Gt(i.width/o,i.height/a);return s.multiply(h)}_setDimensionsImpl(e,t){this._resetTransformEventData(),super._setDimensionsImpl(e,t),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=Cd(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const e=this._activeObject;return Rp(e)?e.getObjects():e?[e]:[]}_fireSelectionEvents(e,t){let i=!1,r=!1;const s=this.getActiveObjects(),o=[],a=[];e.forEach((c=>{s.includes(c)||(i=!0,c.fire("deselected",{e:t,target:c}),a.push(c))})),s.forEach((c=>{e.includes(c)||(i=!0,c.fire("selected",{e:t,target:c}),o.push(c))})),e.length>0&&s.length>0?(r=!0,i&&this.fire("selection:updated",{e:t,selected:o,deselected:a})):s.length>0?(r=!0,this.fire("selection:created",{e:t,selected:o})):e.length>0&&(r=!0,this.fire("selection:cleared",{e:t,deselected:a})),r&&(this._objectsToRender=void 0)}setActiveObject(e,t){const i=this.getActiveObjects(),r=this._setActiveObject(e,t);return this._fireSelectionEvents(i,t),r}_setActiveObject(e,t){const i=this._activeObject;return i!==e&&!(!this._discardActiveObject(t,e)&&this._activeObject)&&!e.onSelect({e:t})&&(this._activeObject=e,Rp(e)&&i!==e&&e.set("canvas",this),e.setCoords(),!0)}_discardActiveObject(e,t){const i=this._activeObject;return!!i&&!i.onDeselect({e,object:t})&&(this._currentTransform&&this._currentTransform.target===i&&this.endCurrentTransform(e),Rp(i)&&i===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(e){const t=this.getActiveObjects(),i=this.getActiveObject();t.length&&this.fire("before:selection:cleared",{e,deselected:[i]});const r=this._discardActiveObject(e);return this._fireSelectionEvents(t,e),r}endCurrentTransform(e){const t=this._currentTransform;this._finalizeCurrentTransform(e),t&&t.target&&(t.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(e){const t=this._currentTransform,i=t.target,r={e,target:i,transform:t,action:t.action};i._scaling&&(i._scaling=!1),i.setCoords(),t.actionPerformed&&(this.fire("object:modified",r),i.fire(yC,r))}setViewportTransform(e){super.setViewportTransform(e);const t=this._activeObject;t&&t.setCoords()}destroy(){const e=this._activeObject;Rp(e)&&(e.removeAll(),e.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(e){const t=this._activeObject;t&&t._renderControls(e)}_toObject(e,t,i){const r=this._realizeGroupTransformOnObject(e),s=super._toObject(e,t,i);return e.set(r),s}_realizeGroupTransformOnObject(e){const{group:t}=e;if(t&&Rp(t)&&this._activeObject===t){const i=Pg(e,["angle","flipX","flipY",Es,wc,Ah,e1,t1,Hc]);return WG(e,t.calcOwnMatrix()),i}return{}}_setSVGObject(e,t,i){const r=this._realizeGroupTransformOnObject(t);super._setSVGObject(e,t,i),t.set(r)}}bt(oS,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});class fke{constructor(e){bt(this,"targets",[]),bt(this,"__disposer",void 0);const t=()=>{const{hiddenTextarea:r}=e.getActiveObject()||{};r&&r.focus()},i=e.upperCanvasEl;i.addEventListener("click",t),this.__disposer=()=>i.removeEventListener("click",t)}exitTextEditing(){this.target=void 0,this.targets.forEach((e=>{e.isEditing&&e.exitEditing()}))}add(e){this.targets.push(e)}remove(e){this.unregister(e),Mp(this.targets,e)}register(e){this.target=e}unregister(e){e===this.target&&(this.target=void 0)}onMouseMove(e){var t;!((t=this.target)===null||t===void 0)&&t.isEditing&&this.target.updateSelectionOnMouseMove(e)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const pke=["target","oldTarget","fireCanvas","e"],Jc={passive:!1},v0=(n,e)=>{const t=n.getViewportPoint(e),i=n.getScenePoint(e);return{viewportPoint:t,scenePoint:i,pointer:t,absolutePointer:i}},of=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];return n.addEventListener(...t)},Eh=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];return n.removeEventListener(...t)},gke={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class x6 extends oS{constructor(e){super(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),bt(this,"_isClick",void 0),bt(this,"textEditingManager",new fke(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach((t=>{this[t]=this[t].bind(this)})),this.addOrRemove(of,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(e,t){const i=this.upperCanvasEl,r=this._getEventPrefix();e(RG(i),"resize",this._onResize),e(i,r+"down",this._onMouseDown),e(i,"".concat(r,"move"),this._onMouseMove,Jc),e(i,"".concat(r,"out"),this._onMouseOut),e(i,"".concat(r,"enter"),this._onMouseEnter),e(i,"wheel",this._onMouseWheel),e(i,"contextmenu",this._onContextMenu),e(i,"click",this._onClick),e(i,"dblclick",this._onClick),e(i,"dragstart",this._onDragStart),e(i,"dragend",this._onDragEnd),e(i,"dragover",this._onDragOver),e(i,"dragenter",this._onDragEnter),e(i,"dragleave",this._onDragLeave),e(i,"drop",this._onDrop),this.enablePointerEvents||e(i,"touchstart",this._onTouchStart,Jc)}removeListeners(){this.addOrRemove(Eh,"remove");const e=this._getEventPrefix(),t=yu(this.upperCanvasEl);Eh(t,"".concat(e,"up"),this._onMouseUp),Eh(t,"touchend",this._onTouchEnd,Jc),Eh(t,"".concat(e,"move"),this._onMouseMove,Jc),Eh(t,"touchmove",this._onMouseMove,Jc),clearTimeout(this._willAddMouseDown)}_onMouseWheel(e){this.__onMouseWheel(e)}_onMouseOut(e){const t=this._hoveredTarget,i=xt({e},v0(this,e));this.fire("mouse:out",xt(xt({},i),{},{target:t})),this._hoveredTarget=void 0,t&&t.fire("mouseout",xt({},i)),this._hoveredTargets.forEach((r=>{this.fire("mouse:out",xt(xt({},i),{},{target:r})),r&&r.fire("mouseout",xt({},i))})),this._hoveredTargets=[]}_onMouseEnter(e){this._currentTransform||this.findTarget(e)||(this.fire("mouse:over",xt({e},v0(this,e))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(e){this._isClick=!1;const t=this.getActiveObject();if(t&&t.onDragStart(e)){this._dragSource=t;const i={e,target:t};return this.fire("dragstart",i),t.fire("dragstart",i),void of(this.upperCanvasEl,"drag",this._onDragProgress)}JM(e)}_renderDragEffects(e,t,i){let r=!1;const s=this._dropTarget;s&&s!==t&&s!==i&&(s.clearContextTop(),r=!0),t==null||t.clearContextTop(),i!==t&&(i==null||i.clearContextTop());const o=this.contextTop;o.save(),o.transform(...this.viewportTransform),t&&(o.save(),t.transform(o),t.renderDragSourceEffect(e),o.restore(),r=!0),i&&(o.save(),i.transform(o),i.renderDropTargetEffect(e),o.restore(),r=!0),o.restore(),r&&(this.contextTopDirty=!0)}_onDragEnd(e){const t=!!e.dataTransfer&&e.dataTransfer.dropEffect!==mc,i=t?this._activeObject:void 0,r={e,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:t,dropTarget:i};Eh(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",r),this._dragSource&&this._dragSource.fire("dragend",r),delete this._dragSource,this._onMouseUp(e)}_onDragProgress(e){const t={e,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",t),this._dragSource&&this._dragSource.fire("drag",t)}findDragTargets(e){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(e)),targets:[...this.targets]}}_onDragOver(e){const t="dragover",{target:i,targets:r}=this.findDragTargets(e),s=this._dragSource,o={e,target:i,subTargets:r,dragSource:s,canDrop:!1,dropTarget:void 0};let a;this.fire(t,o),this._fireEnterLeaveEvents(i,o),i&&(i.canDrop(e)&&(a=i),i.fire(t,o));for(let c=0;c<r.length;c++){const h=r[c];h.canDrop(e)&&(a=h),h.fire(t,o)}this._renderDragEffects(e,s,a),this._dropTarget=a}_onDragEnter(e){const{target:t,targets:i}=this.findDragTargets(e),r={e,target:t,subTargets:i,dragSource:this._dragSource};this.fire("dragenter",r),this._fireEnterLeaveEvents(t,r)}_onDragLeave(e){const t={e,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",t),this._fireEnterLeaveEvents(void 0,t),this._renderDragEffects(e,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(e){const{target:t,targets:i}=this.findDragTargets(e),r=this._basicEventHandler("drop:before",xt({e,target:t,subTargets:i,dragSource:this._dragSource},v0(this,e)));r.didDrop=!1,r.dropTarget=void 0,this._basicEventHandler("drop",r),this.fire("drop:after",r)}_onContextMenu(e){const t=this.findTarget(e),i=this.targets||[],r=this._basicEventHandler("contextmenu:before",{e,target:t,subTargets:i});return this.stopContextMenu&&JM(e),this._basicEventHandler("contextmenu",r),!1}_onClick(e){const t=e.detail;t>3||t<2||(this._cacheTransformEventData(e),t==2&&e.type==="dblclick"&&this._handleEvent(e,"dblclick"),t==3&&this._handleEvent(e,"tripleclick"),this._resetTransformEventData())}getPointerId(e){const t=e.changedTouches;return t?t[0]&&t[0].identifier:this.enablePointerEvents?e.pointerId:-1}_isMainEvent(e){return e.isPrimary===!0||e.isPrimary!==!1&&(e.type==="touchend"&&e.touches.length===0||!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(e){let t=!this.allowTouchScrolling;const i=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),(this.isDrawingMode||i&&this._target===i)&&(t=!0),t&&e.preventDefault(),this._resetTransformEventData();const r=this.upperCanvasEl,s=this._getEventPrefix(),o=yu(r);of(o,"touchend",this._onTouchEnd,Jc),t&&of(o,"touchmove",this._onMouseMove,Jc),Eh(r,"".concat(s,"down"),this._onMouseDown)}_onMouseDown(e){this.__onMouseDown(e),this._resetTransformEventData();const t=this.upperCanvasEl,i=this._getEventPrefix();Eh(t,"".concat(i,"move"),this._onMouseMove,Jc);const r=yu(t);of(r,"".concat(i,"up"),this._onMouseUp),of(r,"".concat(i,"move"),this._onMouseMove,Jc)}_onTouchEnd(e){if(e.touches.length>0)return;this.__onMouseUp(e),this._resetTransformEventData(),delete this.mainTouchId;const t=this._getEventPrefix(),i=yu(this.upperCanvasEl);Eh(i,"touchend",this._onTouchEnd,Jc),Eh(i,"touchmove",this._onMouseMove,Jc),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout((()=>{of(this.upperCanvasEl,"".concat(t,"down"),this._onMouseDown),this._willAddMouseDown=0}),400)}_onMouseUp(e){this.__onMouseUp(e),this._resetTransformEventData();const t=this.upperCanvasEl,i=this._getEventPrefix();if(this._isMainEvent(e)){const r=yu(this.upperCanvasEl);Eh(r,"".concat(i,"up"),this._onMouseUp),Eh(r,"".concat(i,"move"),this._onMouseMove,Jc),of(t,"".concat(i,"move"),this._onMouseMove,Jc)}}_onMouseMove(e){const t=this.getActiveObject();!this.allowTouchScrolling&&(!t||!t.shouldStartDragging(e))&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(e){const t=this.getActiveObject();return!!t!=!!e||t&&e&&t!==e}__onMouseUp(e){var t;this._cacheTransformEventData(e),this._handleEvent(e,"up:before");const i=this._currentTransform,r=this._isClick,s=this._target,{button:o}=e;if(o)return(this.fireMiddleClick&&o===1||this.fireRightClick&&o===2)&&this._handleEvent(e,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(e);if(!this._isMainEvent(e))return;let a,c,h=!1;if(i&&(this._finalizeCurrentTransform(e),h=i.actionPerformed),!r){const u=s===this._activeObject;this.handleSelection(e),h||(h=this._shouldRender(s)||!u&&s===this._activeObject)}if(s){const u=s.findControl(this.getViewportPoint(e),wC(e)),{key:d,control:f}=u||{};if(c=d,s.selectable&&s!==this._activeObject&&s.activeOn==="up")this.setActiveObject(s,e),h=!0;else if(f){const A=f.getMouseUpHandler(e,s,f);A&&(a=this.getScenePoint(e),A.call(f,e,i,a.x,a.y))}s.isMoving=!1}if(i&&(i.target!==s||i.corner!==c)){const u=i.target&&i.target.controls[i.corner],d=u&&u.getMouseUpHandler(e,i.target,u);a=a||this.getScenePoint(e),d&&d.call(u,e,i,a.x,a.y)}this._setCursorFromEvent(e,s),this._handleEvent(e,"up"),this._groupSelector=null,this._currentTransform=null,s&&(s.__corner=void 0),h?this.requestRenderAll():r||(t=this._activeObject)!==null&&t!==void 0&&t.isEditing||this.renderTop()}_basicEventHandler(e,t){const{target:i,subTargets:r=[]}=t;this.fire(e,t),i&&i.fire(e,t);for(let s=0;s<r.length;s++)r[s]!==i&&r[s].fire(e,t);return t}_handleEvent(e,t,i){const r=this._target,s=this.targets||[],o=xt(xt(xt({e,target:r,subTargets:s},v0(this,e)),{},{transform:this._currentTransform},t==="up:before"||t==="up"?{isClick:this._isClick,currentTarget:this.findTarget(e),currentSubTargets:this.targets}:{}),t==="down:before"||t==="down"?i:{});this.fire("mouse:".concat(t),o),r&&r.fire("mouse".concat(t),o);for(let a=0;a<s.length;a++)s[a]!==r&&s[a].fire("mouse".concat(t),o)}_onMouseDownInDrawingMode(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(e),this.requestRenderAll());const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(t,{e,pointer:t}),this._handleEvent(e,"down",{alreadySelected:!1})}_onMouseMoveInDrawingMode(e){if(this._isCurrentlyDrawing){const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(t,{e,pointer:t})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")}_onMouseUpInDrawingMode(e){const t=this.getScenePoint(e);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e,pointer:t}):this._isCurrentlyDrawing=!1,this._handleEvent(e,"up")}__onMouseDown(e){this._isClick=!0,this._cacheTransformEventData(e),this._handleEvent(e,"down:before");let t=this._target,i=!!t&&t===this._activeObject;const{button:r}=e;if(r)return(this.fireMiddleClick&&r===1||this.fireRightClick&&r===2)&&this._handleEvent(e,"down",{alreadySelected:i}),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(e);if(!this._isMainEvent(e)||this._currentTransform)return;let s=this._shouldRender(t),o=!1;if(this.handleMultiSelection(e,t)?(t=this._activeObject,o=!0,s=!0):this._shouldClearSelection(e,t)&&this.discardActiveObject(e),this.selection&&(!t||!t.selectable&&!t.isEditing&&t!==this._activeObject)){const a=this.getScenePoint(e);this._groupSelector={x:a.x,y:a.y,deltaY:0,deltaX:0}}if(i=!!t&&t===this._activeObject,t){t.selectable&&t.activeOn==="down"&&this.setActiveObject(t,e);const a=t.findControl(this.getViewportPoint(e),wC(e));if(t===this._activeObject&&(a||!o)){this._setupCurrentTransform(e,t,i);const c=a?a.control:void 0,h=this.getScenePoint(e),u=c&&c.getMouseDownHandler(e,t,c);u&&u.call(c,e,this._currentTransform,h.x,h.y)}}s&&(this._objectsToRender=void 0),this._handleEvent(e,"down",{alreadySelected:i}),s&&this.requestRenderAll()}_resetTransformEventData(){this._target=this._pointer=this._absolutePointer=void 0}_cacheTransformEventData(e){this._resetTransformEventData(),this._pointer=this.getViewportPoint(e),this._absolutePointer=ig(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)}__onMouseMove(e){if(this._isClick=!1,this._cacheTransformEventData(e),this._handleEvent(e,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(e);if(!this._isMainEvent(e))return;const t=this._groupSelector;if(t){const i=this.getScenePoint(e);t.deltaX=i.x-t.x,t.deltaY=i.y-t.y,this.renderTop()}else if(this._currentTransform)this._transformObject(e);else{const i=this.findTarget(e);this._setCursorFromEvent(e,i),this._fireOverOutEvents(e,i)}this.textEditingManager.onMouseMove(e),this._handleEvent(e,"move"),this._resetTransformEventData()}_fireOverOutEvents(e,t){const i=this._hoveredTarget,r=this._hoveredTargets,s=this.targets,o=Math.max(r.length,s.length);this.fireSyntheticInOutEvents("mouse",{e,target:t,oldTarget:i,fireCanvas:!0});for(let a=0;a<o;a++)this.fireSyntheticInOutEvents("mouse",{e,target:s[a],oldTarget:r[a]});this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(e,t){const i=this._draggedoverTarget,r=this._hoveredTargets,s=this.targets,o=Math.max(r.length,s.length);this.fireSyntheticInOutEvents("drag",xt(xt({},t),{},{target:e,oldTarget:i,fireCanvas:!0}));for(let a=0;a<o;a++)this.fireSyntheticInOutEvents("drag",xt(xt({},t),{},{target:s[a],oldTarget:r[a]}));this._draggedoverTarget=e}fireSyntheticInOutEvents(e,t){let{target:i,oldTarget:r,fireCanvas:s,e:o}=t,a=Bo(t,pke);const{targetIn:c,targetOut:h,canvasIn:u,canvasOut:d}=gke[e],f=r!==i;if(r&&f){const A=xt(xt({},a),{},{e:o,target:r,nextTarget:i},v0(this,o));s&&this.fire(d,A),r.fire(h,A)}if(i&&f){const A=xt(xt({},a),{},{e:o,target:i,previousTarget:r},v0(this,o));s&&this.fire(u,A),i.fire(c,A)}}__onMouseWheel(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()}_transformObject(e){const t=this.getScenePoint(e),i=this._currentTransform,r=i.target,s=r.group?ig(t,void 0,r.group.calcTransformMatrix()):t;i.shiftKey=e.shiftKey,i.altKey=!!this.centeredKey&&e[this.centeredKey],this._performTransformAction(e,i,s),i.actionPerformed&&this.requestRenderAll()}_performTransformAction(e,t,i){const{action:r,actionHandler:s,target:o}=t,a=!!s&&s(e,t,i.x,i.y);a&&o.setCoords(),r==="drag"&&a&&(t.target.isMoving=!0,this.setCursor(t.target.moveCursor||this.moveCursor)),t.actionPerformed=t.actionPerformed||a}_setCursorFromEvent(e,t){if(!t)return void this.setCursor(this.defaultCursor);let i=t.hoverCursor||this.hoverCursor;const r=Rp(this._activeObject)?this._activeObject:null,s=(!r||t.group!==r)&&t.findControl(this.getViewportPoint(e));if(s){const o=s.control;this.setCursor(o.cursorStyleHandler(e,o,t))}else t.subTargetCheck&&this.targets.concat().reverse().map((o=>{i=o.hoverCursor||i})),this.setCursor(i)}handleMultiSelection(e,t){const i=this._activeObject,r=Rp(i);if(i&&this._isSelectionKeyPressed(e)&&this.selection&&t&&t.selectable&&(i!==t||r)&&(r||!t.isDescendantOf(i)&&!i.isDescendantOf(t))&&!t.onSelect({e})&&!i.getActiveControl()){if(r){const s=i.getObjects();if(t===i){const o=this.getViewportPoint(e);if(!(t=this.searchPossibleTargets(s,o)||this.searchPossibleTargets(this._objects,o))||!t.selectable)return!1}t.group===i?(i.remove(t),this._hoveredTarget=t,this._hoveredTargets=[...this.targets],i.size()===1&&this._setActiveObject(i.item(0),e)):(i.multiSelectAdd(t),this._hoveredTarget=i,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(s,e)}else{i.isEditing&&i.exitEditing();const s=new(bi.getClass("ActiveSelection"))([],{canvas:this});s.multiSelectAdd(i,t),this._hoveredTarget=s,this._setActiveObject(s,e),this._fireSelectionEvents([i],e)}return!0}return!1}handleSelection(e){if(!this.selection||!this._groupSelector)return!1;const{x:t,y:i,deltaX:r,deltaY:s}=this._groupSelector,o=new Gt(t,i),a=o.add(new Gt(r,s)),c=o.min(a),h=o.max(a).subtract(c),u=this.collectObjects({left:c.x,top:c.y,width:h.x,height:h.y},{includeIntersecting:!this.selectionFullyContained}),d=o.eq(a)?u[0]?[u[0]]:[]:u.length>1?u.filter((f=>!f.onSelect({e}))).reverse():u;if(d.length===1)this.setActiveObject(d[0],e);else if(d.length>1){const f=bi.getClass("ActiveSelection");this.setActiveObject(new f(d,{canvas:this}),e)}return this._groupSelector=null,!0}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}const kX={x1:0,y1:0,x2:0,y2:0},mke=xt(xt({},kX),{},{r1:0,r2:0}),Q0=(n,e)=>isNaN(n)&&typeof e=="number"?e:n,yke=/^(\d+\.\d+)%|(\d+)%$/;function IX(n){return n&&yke.test(n)}function FX(n,e){const t=typeof n=="number"?n:typeof n=="string"?parseFloat(n)/(IX(n)?100:1):NaN;return vg(0,Q0(t,e),1)}const vke=/\s*;\s*/,wke=/\s*:\s*/;function xke(n,e){let t,i;const r=n.getAttribute("style");if(r){const o=r.split(vke);o[o.length-1]===""&&o.pop();for(let a=o.length;a--;){const[c,h]=o[a].split(wke).map((u=>u.trim()));c==="stop-color"?t=h:c==="stop-opacity"&&(i=h)}}const s=new Fs(t||n.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:FX(n.getAttribute("offset"),0),color:s.toRgb(),opacity:Q0(parseFloat(i||n.getAttribute("stop-opacity")||""),1)*s.getAlpha()*e}}function bke(n,e){const t=[],i=n.getElementsByTagName("stop"),r=FX(e,1);for(let s=i.length;s--;)t.push(xke(i[s],r));return t}function DX(n){return n.nodeName==="linearGradient"||n.nodeName==="LINEARGRADIENT"?"linear":"radial"}function jX(n){return n.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function cu(n,e){return n.getAttribute(e)}function _ke(n,e){return(function(t,i){let r,{width:s,height:o,gradientUnits:a}=i;return Object.keys(t).reduce(((c,h)=>{const u=t[h];return u==="Infinity"?r=1:u==="-Infinity"?r=0:(r=typeof u=="string"?parseFloat(u):u,typeof u=="string"&&IX(u)&&(r*=.01,a==="pixels"&&(h!=="x1"&&h!=="x2"&&h!=="r2"||(r*=s),h!=="y1"&&h!=="y2"||(r*=o)))),c[h]=r,c}),{})})(DX(n)==="linear"?(function(t){return{x1:cu(t,"x1")||0,y1:cu(t,"y1")||0,x2:cu(t,"x2")||"100%",y2:cu(t,"y2")||0}})(n):(function(t){return{x1:cu(t,"fx")||cu(t,"cx")||"50%",y1:cu(t,"fy")||cu(t,"cy")||"50%",r1:0,x2:cu(t,"cx")||"50%",y2:cu(t,"cy")||"50%",r2:cu(t,"r")||"50%"}})(n),xt(xt({},e),{},{gradientUnits:jX(n)}))}class ry{constructor(e){const{type:t="linear",gradientUnits:i="pixels",coords:r={},colorStops:s=[],offsetX:o=0,offsetY:a=0,gradientTransform:c,id:h}=e||{};Object.assign(this,{type:t,gradientUnits:i,coords:xt(xt({},t==="radial"?mke:kX),r),colorStops:s,offsetX:o,offsetY:a,gradientTransform:c,id:h?"".concat(h,"_").concat(Gf()):Gf()})}addColorStop(e){for(const t in e){const i=new Fs(e[t]);this.colorStops.push({offset:parseFloat(t),color:i.toRgb(),opacity:i.getAlpha()})}return this}toObject(e){return xt(xt({},Pg(this,e)),{},{type:this.type,coords:xt({},this.coords),colorStops:this.colorStops.map((t=>xt({},t))),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(e){let{additionalTransform:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=[],r=this.gradientTransform?this.gradientTransform.concat():vc.concat(),s=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",o=this.colorStops.map((d=>xt({},d))).sort(((d,f)=>d.offset-f.offset));let a=-this.offsetX,c=-this.offsetY;var h;s==="objectBoundingBox"?(a/=e.width,c/=e.height):(a+=e.width/2,c+=e.height/2),(h=e)&&typeof h._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(a-=e.pathOffset.x,c-=e.pathOffset.y),r[4]-=a,r[5]-=c;const u=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(s,'"'),'gradientTransform="'.concat(t?t+" ":"").concat(Dm(r),'"'),""].join(" ");if(this.type==="linear"){const{x1:d,y1:f,x2:A,y2:g}=this.coords;i.push("<linearGradient ",u,' x1="',d,'" y1="',f,'" x2="',A,'" y2="',g,`">
`)}else if(this.type==="radial"){const{x1:d,y1:f,x2:A,y2:g,r1:p,r2:y}=this.coords,v=p>y;i.push("<radialGradient ",u,' cx="',v?d:A,'" cy="',v?f:g,'" r="',v?p:y,'" fx="',v?A:d,'" fy="',v?g:f,`">
`),v&&(o.reverse(),o.forEach((w=>{w.offset=1-w.offset})));const m=Math.min(p,y);if(m>0){const w=m/Math.max(p,y);o.forEach((x=>{x.offset+=w*(1-x.offset)}))}}return o.forEach((d=>{let{color:f,offset:A,opacity:g}=d;i.push("<stop ",'offset="',100*A+"%",'" style="stop-color:',f,g!==void 0?";stop-opacity: "+g:";",`"/>
`)})),i.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),i.join("")}toLive(e){const{x1:t,y1:i,x2:r,y2:s,r1:o,r2:a}=this.coords,c=this.type==="linear"?e.createLinearGradient(t,i,r,s):e.createRadialGradient(t,i,o,r,s,a);return this.colorStops.forEach((h=>{let{color:u,opacity:d,offset:f}=h;c.addColorStop(f,d!==void 0?new Fs(u).setAlpha(d).toRgba():u)})),c}static async fromObject(e){const{colorStops:t,gradientTransform:i}=e;return new this(xt(xt({},e),{},{colorStops:t?t.map((r=>xt({},r))):void 0,gradientTransform:i?[...i]:void 0}))}static fromElement(e,t,i){const r=jX(e),s=t._findCenterFromElement();return new this(xt({id:e.getAttribute("id")||void 0,type:DX(e),coords:_ke(e,{width:i.viewBoxWidth||i.width,height:i.viewBoxHeight||i.height}),colorStops:bke(e,i.opacity),gradientUnits:r,gradientTransform:TC(e.getAttribute("gradientTransform")||"")},r==="pixels"?{offsetX:t.width/2-s.x,offsetY:t.height/2-s.y}:{offsetX:0,offsetY:0}))}}bt(ry,"type","Gradient"),bi.setClass(ry,"gradient"),bi.setClass(ry,"linear"),bi.setClass(ry,"radial");const Cke=["type","source","patternTransform"];class wT{get type(){return"pattern"}set type(e){SA("warn","Setting type has no effect",e)}constructor(e){bt(this,"repeat","repeat"),bt(this,"offsetX",0),bt(this,"offsetY",0),bt(this,"crossOrigin",""),this.id=Gf(),Object.assign(this,e)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(e){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?e.createPattern(this.source,this.repeat):null}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const{repeat:t,crossOrigin:i}=this;return xt(xt({},Pg(this,e)),{},{type:"pattern",source:this.sourceToString(),repeat:t,crossOrigin:i,offsetX:Xs(this.offsetX,ds.NUM_FRACTION_DIGITS),offsetY:Xs(this.offsetY,ds.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(e){let{width:t,height:i}=e;const{source:r,repeat:s,id:o}=this,a=Q0(this.offsetX/t,0),c=Q0(this.offsetY/i,0),h=s==="repeat-y"||s==="no-repeat"?1+Math.abs(a||0):Q0(r.width/t,0),u=s==="repeat-x"||s==="no-repeat"?1+Math.abs(c||0):Q0(r.height/i,0);return['<pattern id="SVGID_'.concat(o,'" x="').concat(a,'" y="').concat(c,'" width="').concat(h,'" height="').concat(u,'">'),'<image x="0" y="0" width="'.concat(r.width,'" height="').concat(r.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static async fromObject(e,t){let{type:i,source:r,patternTransform:s}=e,o=Bo(e,Cke);const a=await Oy(r,xt(xt({},t),{},{crossOrigin:o.crossOrigin}));return new this(xt(xt({},o),{},{patternTransform:s&&s.slice(0),source:a}))}}bt(wT,"type","Pattern"),bi.setClass(wT),bi.setClass(wT,"pattern");const Ske=["path","left","top"],Tke=["d"];class sA extends Zl{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:i,left:r,top:s}=t,o=Bo(t,Ske);super(),Object.assign(this,sA.ownDefaults),this.setOptions(o),this._setPath(e||[],!0),typeof r=="number"&&this.set(Es,r),typeof s=="number"&&this.set(Hc,s)}_setPath(e,t){this.path=xX(Array.isArray(e)?e:BX(e)),this.setBoundingBox(t)}_findCenterFromElement(){const e=this._calcBoundsFromPath();return new Gt(e.left+e.width/2,e.top+e.height/2)}_renderPathCommands(e){const t=-this.pathOffset.x,i=-this.pathOffset.y;e.beginPath();for(const r of this.path)switch(r[0]){case"L":e.lineTo(r[1]+t,r[2]+i);break;case"M":e.moveTo(r[1]+t,r[2]+i);break;case"C":e.bezierCurveTo(r[1]+t,r[2]+i,r[3]+t,r[4]+i,r[5]+t,r[6]+i);break;case"Q":e.quadraticCurveTo(r[1]+t,r[2]+i,r[3]+t,r[4]+i);break;case"Z":e.closePath()}}_render(e){this._renderPathCommands(e),this._renderPaintInOrder(e)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return xt(xt({},super.toObject(e)),{},{path:this.path.map((t=>t.slice()))})}toDatalessObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.toObject(e);return this.sourcePath&&(delete t.path,t.sourcePath=this.sourcePath),t}_toSVG(){const e=EX(this.path,ds.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(e,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){const e=ds.NUM_FRACTION_DIGITS;return" translate(".concat(Xs(-this.pathOffset.x,e),", ").concat(Xs(-this.pathOffset.y,e),")")}toClipPathSVG(e){const t=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}toSVG(e){const t=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{width:t,height:i,pathOffset:r}=this._calcDimensions();this.set({width:t,height:i,pathOffset:r}),e&&this.setPositionByOrigin(r,Br,Br)}_calcBoundsFromPath(){const e=[];let t=0,i=0,r=0,s=0;for(const o of this.path)switch(o[0]){case"L":r=o[1],s=o[2],e.push({x:t,y:i},{x:r,y:s});break;case"M":r=o[1],s=o[2],t=r,i=s;break;case"C":e.push(...w6(r,s,o[1],o[2],o[3],o[4],o[5],o[6])),r=o[5],s=o[6];break;case"Q":e.push(...w6(r,s,o[1],o[2],o[1],o[2],o[3],o[4])),r=o[3],s=o[4];break;case"Z":r=t,s=i}return md(e)}_calcDimensions(){const e=this._calcBoundsFromPath();return xt(xt({},e),{},{pathOffset:new Gt(e.left+e.width/2,e.top+e.height/2)})}static fromObject(e){return this._fromObject(e,{extraParam:"path"})}static async fromElement(e,t,i){const r=PA(e,this.ATTRIBUTE_NAMES,i),{d:s}=r;return new this(s,xt(xt(xt({},Bo(r,Tke)),t),{},{left:void 0,top:void 0}))}}bt(sA,"type","Path"),bt(sA,"cacheProperties",[...jA,"path","fillRule"]),bt(sA,"ATTRIBUTE_NAMES",[...rp,"d"]),bi.setClass(sA),bi.setSVGClass(sA);const Bke=["left","top","radius"],PX=["radius","startAngle","endAngle","counterClockwise"];class gu extends Zl{static getDefaults(){return xt(xt({},super.getDefaults()),gu.ownDefaults)}constructor(e){super(),Object.assign(this,gu.ownDefaults),this.setOptions(e)}_set(e,t){return super._set(e,t),e==="radius"&&this.setRadius(t),this}_render(e){e.beginPath(),e.arc(0,0,this.radius,Xo(this.startAngle),Xo(this.endAngle),this.counterClockwise),this._renderPaintInOrder(e)}getRadiusX(){return this.get("radius")*this.get(wc)}getRadiusY(){return this.get("radius")*this.get(Ah)}setRadius(e){this.radius=e,this.set({width:2*e,height:2*e})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...PX,...e])}_toSVG(){const e=(this.endAngle-this.startAngle)%360;if(e===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{const{radius:t}=this,i=Xo(this.startAngle),r=Xo(this.endAngle),s=ju(i)*t,o=Pu(i)*t,a=ju(r)*t,c=Pu(r)*t,h=e>180?1:0,u=this.counterClockwise?0:1;return['<path d="M '.concat(s," ").concat(o," A ").concat(t," ").concat(t," 0 ").concat(h," ").concat(u," ").concat(a," ").concat(c,'" '),"COMMON_PARTS",` />
`]}}static async fromElement(e,t,i){const r=PA(e,this.ATTRIBUTE_NAMES,i),{left:s=0,top:o=0,radius:a=0}=r;return new this(xt(xt({},Bo(r,Bke)),{},{radius:a,left:s-a,top:o-a}))}static fromObject(e){return super._fromObject(e)}}bt(gu,"type","Circle"),bt(gu,"cacheProperties",[...jA,...PX]),bt(gu,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),bt(gu,"ATTRIBUTE_NAMES",["cx","cy","r",...rp]),bi.setClass(gu),bi.setSVGClass(gu);const Eke=["x1","y1","x2","y2"],kke=["x1","y1","x2","y2"],b6=["x1","x2","y1","y2"];class nl extends Zl{constructor(){let[e,t,i,r]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,nl.ownDefaults),this.setOptions(s),this.x1=e,this.x2=i,this.y1=t,this.y2=r,this._setWidthHeight();const{left:o,top:a}=s;typeof o=="number"&&this.set(Es,o),typeof a=="number"&&this.set(Hc,a)}_setWidthHeight(){const{x1:e,y1:t,x2:i,y2:r}=this;this.width=Math.abs(i-e),this.height=Math.abs(r-t);const{left:s,top:o,width:a,height:c}=md([{x:e,y:t},{x:i,y:r}]),h=new Gt(s+a/2,o+c/2);this.setPositionByOrigin(h,Br,Br)}_set(e,t){return super._set(e,t),b6.includes(e)&&this._setWidthHeight(),this}_render(e){e.beginPath();const t=this.calcLinePoints();e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2),e.lineWidth=this.strokeWidth;const i=e.strokeStyle;var r;Oh(this.stroke)?e.strokeStyle=this.stroke.toLive(e):e.strokeStyle=(r=this.stroke)!==null&&r!==void 0?r:e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=i}_findCenterFromElement(){return new Gt((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return xt(xt({},super.toObject(e)),this.calcLinePoints())}_getNonTransformedDimensions(){const e=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e}calcLinePoints(){const{x1:e,x2:t,y1:i,y2:r,width:s,height:o}=this,a=e<=t?-1:1,c=i<=r?-1:1;return{x1:a*s/2,x2:a*-s/2,y1:c*o/2,y2:c*-o/2}}_toSVG(){const{x1:e,x2:t,y1:i,y2:r}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(e,'" y1="').concat(i,'" x2="').concat(t,'" y2="').concat(r,`" />
`)]}static async fromElement(e,t,i){const r=PA(e,this.ATTRIBUTE_NAMES,i),{x1:s=0,y1:o=0,x2:a=0,y2:c=0}=r;return new this([s,o,a,c],Bo(r,Eke))}static fromObject(e){let{x1:t,y1:i,x2:r,y2:s}=e,o=Bo(e,kke);return this._fromObject(xt(xt({},o),{},{points:[t,i,r,s]}),{extraParam:"points"})}}bt(nl,"type","Line"),bt(nl,"cacheProperties",[...jA,...b6]),bt(nl,"ATTRIBUTE_NAMES",rp.concat(b6)),bi.setClass(nl),bi.setSVGClass(nl);class Uh extends Zl{static getDefaults(){return xt(xt({},super.getDefaults()),Uh.ownDefaults)}constructor(e){super(),Object.assign(this,Uh.ownDefaults),this.setOptions(e)}_render(e){const t=this.width/2,i=this.height/2;e.beginPath(),e.moveTo(-t,i),e.lineTo(0,-i),e.lineTo(t,i),e.closePath(),this._renderPaintInOrder(e)}_toSVG(){const e=this.width/2,t=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-e," ").concat(t,",0 ").concat(-t,",").concat(e," ").concat(t),'" />']}}bt(Uh,"type","Triangle"),bt(Uh,"ownDefaults",{width:100,height:100}),bi.setClass(Uh),bi.setSVGClass(Uh);const NX=["rx","ry"];class rd extends Zl{static getDefaults(){return xt(xt({},super.getDefaults()),rd.ownDefaults)}constructor(e){super(),Object.assign(this,rd.ownDefaults),this.setOptions(e)}_set(e,t){switch(super._set(e,t),e){case"rx":this.rx=t,this.set("width",2*t);break;case"ry":this.ry=t,this.set("height",2*t)}return this}getRx(){return this.get("rx")*this.get(wc)}getRy(){return this.get("ry")*this.get(Ah)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...NX,...e])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,TA,!1),e.restore(),this._renderPaintInOrder(e)}static async fromElement(e,t,i){const r=PA(e,this.ATTRIBUTE_NAMES,i);return r.left=(r.left||0)-r.rx,r.top=(r.top||0)-r.ry,new this(r)}}function Ike(n){if(!n)return[];const e=n.replace(/,/g," ").trim().split(/\s+/),t=[];for(let i=0;i<e.length;i+=2)t.push({x:parseFloat(e[i]),y:parseFloat(e[i+1])});return t}bt(rd,"type","Ellipse"),bt(rd,"cacheProperties",[...jA,...NX]),bt(rd,"ownDefaults",{rx:0,ry:0}),bt(rd,"ATTRIBUTE_NAMES",[...rp,"cx","cy","rx","ry"]),bi.setClass(rd),bi.setSVGClass(rd);const Fke=["left","top"],LX={exactBoundingBox:!1};class Lh extends Zl{static getDefaults(){return xt(xt({},super.getDefaults()),Lh.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),bt(this,"strokeDiff",void 0),Object.assign(this,Lh.ownDefaults),this.setOptions(t),this.points=e;const{left:i,top:r}=t;this.initialized=!0,this.setBoundingBox(!0),typeof i=="number"&&this.set(Es,i),typeof r=="number"&&this.set(Hc,r)}isOpen(){return!0}_projectStrokeOnPoints(e){return dX(this.points,e,this.isOpen())}_calcDimensions(e){e=xt({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},e||{});const t=this.exactBoundingBox?this._projectStrokeOnPoints(e).map((h=>h.projectedPoint)):this.points;if(t.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new Gt,strokeOffset:new Gt,strokeDiff:new Gt};const i=md(t),r=ow(xt(xt({},e),{},{scaleX:1,scaleY:1})),s=md(this.points.map((h=>Kl(h,r,!0)))),o=new Gt(this.scaleX,this.scaleY);let a=i.left+i.width/2,c=i.top+i.height/2;return this.exactBoundingBox&&(a-=c*Math.tan(Xo(this.skewX)),c-=a*Math.tan(Xo(this.skewY))),xt(xt({},i),{},{pathOffset:new Gt(a,c),strokeOffset:new Gt(s.left,s.top).subtract(new Gt(i.left,i.top)).multiply(o),strokeDiff:new Gt(i.width,i.height).subtract(new Gt(s.width,s.height)).multiply(o)})}_findCenterFromElement(){const e=md(this.points);return new Gt(e.left+e.width/2,e.top+e.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{left:t,top:i,width:r,height:s,pathOffset:o,strokeOffset:a,strokeDiff:c}=this._calcDimensions();this.set({width:r,height:s,pathOffset:o,strokeOffset:a,strokeDiff:c}),e&&this.setPositionByOrigin(new Gt(t+r/2,i+s/2),Br,Br)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new Gt(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let o;if(Object.keys(e).some((a=>this.strokeUniform||this.constructor.layoutProperties.includes(a)))){var t,i;const{width:a,height:c}=this._calcDimensions(e);o=new Gt((t=e.width)!==null&&t!==void 0?t:a,(i=e.height)!==null&&i!==void 0?i:c)}else{var r,s;o=new Gt((r=e.width)!==null&&r!==void 0?r:this.width,(s=e.height)!==null&&s!==void 0?s:this.height)}return o.multiply(new Gt(e.scaleX||this.scaleX,e.scaleY||this.scaleY))}return super._getTransformedDimensions(e)}_set(e,t){const i=this.initialized&&this[e]!==t,r=super._set(e,t);return this.exactBoundingBox&&i&&((e===wc||e===Ah)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(e))&&this.setDimensions(),r}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return xt(xt({},super.toObject(e)),{},{points:this.points.map((t=>{let{x:i,y:r}=t;return{x:i,y:r}}))})}_toSVG(){const e=[],t=this.pathOffset.x,i=this.pathOffset.y,r=ds.NUM_FRACTION_DIGITS;for(let s=0,o=this.points.length;s<o;s++)e.push(Xs(this.points[s].x-t,r),",",Xs(this.points[s].y-i,r)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(e.join(""),`" />
`)]}_render(e){const t=this.points.length,i=this.pathOffset.x,r=this.pathOffset.y;if(t&&!isNaN(this.points[t-1].y)){e.beginPath(),e.moveTo(this.points[0].x-i,this.points[0].y-r);for(let s=0;s<t;s++){const o=this.points[s];e.lineTo(o.x-i,o.y-r)}!this.isOpen()&&e.closePath(),this._renderPaintInOrder(e)}}complexity(){return this.points.length}static async fromElement(e,t,i){return new this(Ike(e.getAttribute("points")),xt(xt({},Bo(PA(e,this.ATTRIBUTE_NAMES,i),Fke)),t))}static fromObject(e){return this._fromObject(e,{extraParam:"points"})}}bt(Lh,"ownDefaults",LX),bt(Lh,"type","Polyline"),bt(Lh,"layoutProperties",[e1,t1,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),bt(Lh,"cacheProperties",[...jA,"points"]),bt(Lh,"ATTRIBUTE_NAMES",[...rp]),bi.setClass(Lh),bi.setSVGClass(Lh);class $0 extends Lh{isOpen(){return!1}}bt($0,"ownDefaults",LX),bt($0,"type","Polygon"),bi.setClass($0),bi.setSVGClass($0);class MX extends Zl{isEmptyStyles(e){if(!this.styles||e!==void 0&&!this.styles[e])return!0;const t=e===void 0?this.styles:{line:this.styles[e]};for(const i in t)for(const r in t[i])for(const s in t[i][r])return!1;return!0}styleHas(e,t){if(!this.styles||t!==void 0&&!this.styles[t])return!1;const i=t===void 0?this.styles:{0:this.styles[t]};for(const r in i)for(const s in i[r])if(i[r][s][e]!==void 0)return!0;return!1}cleanStyle(e){if(!this.styles)return!1;const t=this.styles;let i,r,s=0,o=!0,a=0;for(const c in t){i=0;for(const h in t[c]){const u=t[c][h]||{};s++,u[e]!==void 0?(r?u[e]!==r&&(o=!1):r=u[e],u[e]===this[e]&&delete u[e]):o=!1,Object.keys(u).length!==0?i++:delete t[c][h]}i===0&&delete t[c]}for(let c=0;c<this._textLines.length;c++)a+=this._textLines[c].length;o&&s===a&&(this[e]=r,this.removeStyle(e))}removeStyle(e){if(!this.styles)return;const t=this.styles;let i,r,s;for(r in t){for(s in i=t[r],i)delete i[s][e],Object.keys(i[s]).length===0&&delete i[s];Object.keys(i).length===0&&delete t[r]}}_extendStyles(e,t){const{lineIndex:i,charIndex:r}=this.get2DCursorLocation(e);this._getLineStyle(i)||this._setLineStyle(i);const s=wF(xt(xt({},this._getStyleDeclaration(i,r)),t),(o=>o!==void 0));this._setStyleDeclaration(i,r,s)}getSelectionStyles(e,t,i){const r=[];for(let s=e;s<(t||e);s++)r.push(this.getStyleAtPosition(s,i));return r}getStyleAtPosition(e,t){const{lineIndex:i,charIndex:r}=this.get2DCursorLocation(e);return t?this.getCompleteStyleDeclaration(i,r):this._getStyleDeclaration(i,r)}setSelectionStyles(e,t,i){for(let r=t;r<(i||t);r++)this._extendStyles(r,e);this._forceClearCache=!0}_getStyleDeclaration(e,t){var i;const r=this.styles&&this.styles[e];return r&&(i=r[t])!==null&&i!==void 0?i:{}}getCompleteStyleDeclaration(e,t){return xt(xt({},Pg(this,this.constructor._styleProperties)),this._getStyleDeclaration(e,t))}_setStyleDeclaration(e,t,i){this.styles[e][t]=i}_deleteStyleDeclaration(e,t){delete this.styles[e][t]}_getLineStyle(e){return!!this.styles[e]}_setLineStyle(e){this.styles[e]={}}_deleteLineStyle(e){delete this.styles[e]}}bt(MX,"_styleProperties",QEe);const Dke=/  +/g,jke=/"/g;function xT(n,e,t,i,r){return"		".concat((function(s,o){let{left:a,top:c,width:h,height:u}=o,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ds.NUM_FRACTION_DIGITS;const f=yv(Sa,s,!1),[A,g,p,y]=[a,c,h,u].map((v=>Xs(v,d)));return"<rect ".concat(f,' x="').concat(A,'" y="').concat(g,'" width="').concat(p,'" height="').concat(y,'"></rect>')})(n,{left:e,top:t,width:i,height:r}),`
`)}const Pke=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"];let bT;class Tl extends MX{static getDefaults(){return xt(xt({},super.getDefaults()),Tl.ownDefaults)}constructor(e,t){super(),bt(this,"__charBounds",[]),Object.assign(this,Tl.ownDefaults),this.setOptions(t),this.styles||(this.styles={}),this.text=e,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const e=this.path;e&&(e.segmentsInfo=DF(e.path))}_splitText(){const e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(od)&&this.enlargeSpaces()}enlargeSpaces(){let e,t,i,r,s,o,a;for(let c=0,h=this._textLines.length;c<h;c++)if((this.textAlign===od||c!==h-1&&!this.isEndOfWrapping(c))&&(r=0,s=this._textLines[c],t=this.getLineWidth(c),t<this.width&&(a=this.textLines[c].match(this._reSpacesAndTabs)))){i=a.length,e=(this.width-t)/i;for(let u=0;u<=s.length;u++)o=this.__charBounds[c][u],this._reSpaceAndTab.test(s[u])?(o.width+=e,o.kernedWidth+=e,o.left+=r,r+=e):o.left+=r}}isEndOfWrapping(e){return e===this._textLines.length-1}missingNewlineOffset(e){return 1}get2DCursorLocation(e,t){const i=t?this._unwrappedTextLines:this._textLines;let r;for(r=0;r<i.length;r++){if(e<=i[r].length)return{lineIndex:r,charIndex:e};e-=i[r].length+this.missingNewlineOffset(r,t)}return{lineIndex:r-1,charIndex:i[r-1].length<e?i[r-1].length:e}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){const e=super._getCacheCanvasDimensions(),t=this.fontSize;return e.width+=t*e.zoomX,e.height+=t*e.zoomY,e}_render(e){const t=this.path;t&&!t.isNotVisible()&&t._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")}_renderText(e){this.paintFirst===yc?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))}_setTextStyles(e,t,i){if(e.textBaseline="alphabetic",this.path)switch(this.pathAlign){case Br:e.textBaseline="middle";break;case"ascender":e.textBaseline=Hc;break;case"descender":e.textBaseline=u6}e.font=this._getFontDeclaration(t,i)}calcTextWidth(){let e=this.getLineWidth(0);for(let t=1,i=this._textLines.length;t<i;t++){const r=this.getLineWidth(t);r>e&&(e=r)}return e}_renderTextLine(e,t,i,r,s,o){this._renderChars(e,t,i,r,s,o)}_renderTextLinesBackground(e){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const t=e.fillStyle,i=this._getLeftOffset();let r=this._getTopOffset();for(let s=0,o=this._textLines.length;s<o;s++){const a=this.getHeightOfLine(s);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",s)){r+=a;continue}const c=this._textLines[s].length,h=this._getLineLeftOffset(s);let u,d,f=0,A=0,g=this.getValueOfPropertyAt(s,0,"textBackgroundColor");for(let p=0;p<c;p++){const y=this.__charBounds[s][p];d=this.getValueOfPropertyAt(s,p,"textBackgroundColor"),this.path?(e.save(),e.translate(y.renderLeft,y.renderTop),e.rotate(y.angle),e.fillStyle=d,d&&e.fillRect(-y.width/2,-a/this.lineHeight*(1-this._fontSizeFraction),y.width,a/this.lineHeight),e.restore()):d!==g?(u=i+h+A,this.direction==="rtl"&&(u=this.width-u-f),e.fillStyle=g,g&&e.fillRect(u,r,f,a/this.lineHeight),A=y.left,f=y.width,g=d):f+=y.kernedWidth}d&&!this.path&&(u=i+h+A,this.direction==="rtl"&&(u=this.width-u-f),e.fillStyle=d,e.fillRect(u,r,f,a/this.lineHeight)),r+=a}e.fillStyle=t,this._removeShadow(e)}_measureChar(e,t,i,r){const s=My.getFontCache(t),o=this._getFontDeclaration(t),a=i+e,c=i&&o===this._getFontDeclaration(r),h=t.fontSize/this.CACHE_FONT_SIZE;let u,d,f,A;if(i&&s[i]!==void 0&&(f=s[i]),s[e]!==void 0&&(A=u=s[e]),c&&s[a]!==void 0&&(d=s[a],A=d-f),u===void 0||f===void 0||d===void 0){const g=(function(){return bT||(bT=fh({width:0,height:0}).getContext("2d")),bT})();this._setTextStyles(g,t,!0),u===void 0&&(A=u=g.measureText(e).width,s[e]=u),f===void 0&&c&&i&&(f=g.measureText(i).width,s[i]=f),c&&d===void 0&&(d=g.measureText(a).width,s[a]=d,A=d-f)}return{width:u*h,kernedWidth:A*h}}getHeightOfChar(e,t){return this.getValueOfPropertyAt(e,t,"fontSize")}measureLine(e){const t=this._measureLine(e);return this.charSpacing!==0&&(t.width-=this._getWidthOfCharSpacing()),t.width<0&&(t.width=0),t}_measureLine(e){let t,i,r=0;const s=this.pathSide===la,o=this.path,a=this._textLines[e],c=a.length,h=new Array(c);this.__charBounds[e]=h;for(let u=0;u<c;u++){const d=a[u];i=this._getGraphemeBox(d,e,u,t),h[u]=i,r+=i.kernedWidth,t=d}if(h[c]={left:i?i.left+i.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},o&&o.segmentsInfo){let u=0;const d=o.segmentsInfo[o.segmentsInfo.length-1].length;switch(this.textAlign){case Es:u=s?d-r:0;break;case Br:u=(d-r)/2;break;case la:u=s?0:d-r}u+=this.pathStartOffset*(s?-1:1);for(let f=s?c-1:0;s?f>=0:f<c;s?f--:f++)i=h[f],u>d?u%=d:u<0&&(u+=d),this._setGraphemeOnPath(u,i),u+=i.kernedWidth}return{width:r,numOfSpaces:0}}_setGraphemeOnPath(e,t){const i=e+t.kernedWidth/2,r=this.path,s=TX(r.path,i,r.segmentsInfo);t.renderLeft=s.x-r.pathOffset.x,t.renderTop=s.y-r.pathOffset.y,t.angle=s.angle+(this.pathSide===la?Math.PI:0)}_getGraphemeBox(e,t,i,r,s){const o=this.getCompleteStyleDeclaration(t,i),a=r?this.getCompleteStyleDeclaration(t,i-1):{},c=this._measureChar(e,o,r,a);let h,u=c.kernedWidth,d=c.width;this.charSpacing!==0&&(h=this._getWidthOfCharSpacing(),d+=h,u+=h);const f={width:d,left:0,height:o.fontSize,kernedWidth:u,deltaY:o.deltaY};if(i>0&&!s){const A=this.__charBounds[t][i-1];f.left=A.left+A.width+c.kernedWidth-c.width}return f}getHeightOfLine(e){if(this.__lineHeights[e])return this.__lineHeights[e];let t=this.getHeightOfChar(e,0);for(let i=1,r=this._textLines[e].length;i<r;i++)t=Math.max(this.getHeightOfChar(e,i),t);return this.__lineHeights[e]=t*this.lineHeight*this._fontSizeMult}calcTextHeight(){let e,t=0;for(let i=0,r=this._textLines.length;i<r;i++)e=this.getHeightOfLine(i),t+=i===r-1?e/this.lineHeight:e;return t}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(e,t){e.save();let i=0;const r=this._getLeftOffset(),s=this._getTopOffset();for(let o=0,a=this._textLines.length;o<a;o++){const c=this.getHeightOfLine(o),h=c/this.lineHeight,u=this._getLineLeftOffset(o);this._renderTextLine(t,e,this._textLines[o],r+u,s+i+h,o),i+=c}e.restore()}_renderTextFill(e){(this.fill||this.styleHas(Sa))&&this._renderTextCommon(e,"fillText")}_renderTextStroke(e){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())}_renderChars(e,t,i,r,s,o){const a=this.getHeightOfLine(o),c=this.textAlign.includes(od),h=this.path,u=!c&&this.charSpacing===0&&this.isEmptyStyles(o)&&!h,d=this.direction==="ltr",f=this.direction==="ltr"?1:-1,A=t.direction;let g,p,y,v,m,w="",x=0;if(t.save(),A!==this.direction&&(t.canvas.setAttribute("dir",d?"ltr":"rtl"),t.direction=d?"ltr":"rtl",t.textAlign=d?Es:la),s-=a*this._fontSizeFraction/this.lineHeight,u)return this._renderChar(e,t,o,0,i.join(""),r,s),void t.restore();for(let T=0,j=i.length-1;T<=j;T++)v=T===j||this.charSpacing||h,w+=i[T],y=this.__charBounds[o][T],x===0?(r+=f*(y.kernedWidth-y.width),x+=y.width):x+=y.kernedWidth,c&&!v&&this._reSpaceAndTab.test(i[T])&&(v=!0),v||(g=g||this.getCompleteStyleDeclaration(o,T),p=this.getCompleteStyleDeclaration(o,T+1),v=rS(g,p,!1)),v&&(h?(t.save(),t.translate(y.renderLeft,y.renderTop),t.rotate(y.angle),this._renderChar(e,t,o,T,w,-x/2,0),t.restore()):(m=r,this._renderChar(e,t,o,T,w,m,s)),w="",g=p,r+=f*x,x=0);t.restore()}_applyPatternGradientTransformText(e){const t=this.width+this.strokeWidth,i=this.height+this.strokeWidth,r=fh({width:t,height:i}),s=r.getContext("2d");return r.width=t,r.height=i,s.beginPath(),s.moveTo(0,0),s.lineTo(t,0),s.lineTo(t,i),s.lineTo(0,i),s.closePath(),s.translate(t/2,i/2),s.fillStyle=e.toLive(s),this._applyPatternGradientTransform(s,e),s.fill(),s.createPattern(r,"no-repeat")}handleFiller(e,t,i){let r,s;return Oh(i)?i.gradientUnits==="percentage"||i.gradientTransform||i.patternTransform?(r=-this.width/2,s=-this.height/2,e.translate(r,s),e[t]=this._applyPatternGradientTransformText(i),{offsetX:r,offsetY:s}):(e[t]=i.toLive(e),this._applyPatternGradientTransform(e,i)):(e[t]=i,{offsetX:0,offsetY:0})}_setStrokeStyles(e,t){let{stroke:i,strokeWidth:r}=t;return e.lineWidth=r,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",i)}_setFillStyles(e,t){let{fill:i}=t;return this.handleFiller(e,"fillStyle",i)}_renderChar(e,t,i,r,s,o,a){const c=this._getStyleDeclaration(i,r),h=this.getCompleteStyleDeclaration(i,r),u=e==="fillText"&&h.fill,d=e==="strokeText"&&h.stroke&&h.strokeWidth;if(d||u){if(t.save(),t.font=this._getFontDeclaration(h),c.textBackgroundColor&&this._removeShadow(t),c.deltaY&&(a+=c.deltaY),u){const f=this._setFillStyles(t,h);t.fillText(s,o-f.offsetX,a-f.offsetY)}if(d){const f=this._setStrokeStyles(t,h);t.strokeText(s,o-f.offsetX,a-f.offsetY)}t.restore()}}setSuperscript(e,t){this._setScript(e,t,this.superscript)}setSubscript(e,t){this._setScript(e,t,this.subscript)}_setScript(e,t,i){const r=this.get2DCursorLocation(e,!0),s=this.getValueOfPropertyAt(r.lineIndex,r.charIndex,"fontSize"),o=this.getValueOfPropertyAt(r.lineIndex,r.charIndex,"deltaY"),a={fontSize:s*i.size,deltaY:o+s*i.baseline};this.setSelectionStyles(a,e,t)}_getLineLeftOffset(e){const t=this.getLineWidth(e),i=this.width-t,r=this.textAlign,s=this.direction,o=this.isEndOfWrapping(e);let a=0;return r===od||r===Hy&&!o||r===Uy&&!o||r===bC&&!o?0:(r===Br&&(a=i/2),r===la&&(a=i),r===Hy&&(a=i/2),r===Uy&&(a=i),s==="rtl"&&(r===la||r===od||r===Uy?a=0:r===Es||r===bC?a=-i:r!==Br&&r!==Hy||(a=-i/2)),a)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(e){if(this.__lineWidths[e]!==void 0)return this.__lineWidths[e];const{width:t}=this.measureLine(e);return this.__lineWidths[e]=t,t}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(e,t,i){var r;return(r=this._getStyleDeclaration(e,t)[i])!==null&&r!==void 0?r:this[i]}_renderTextDecoration(e,t){if(!this[t]&&!this.styleHas(t))return;let i=this._getTopOffset();const r=this._getLeftOffset(),s=this.path,o=this._getWidthOfCharSpacing(),a=t==="linethrough"?.5:t==="overline"?1:0,c=this.offsets[t];for(let h=0,u=this._textLines.length;h<u;h++){const d=this.getHeightOfLine(h);if(!this[t]&&!this.styleHas(t,h)){i+=d;continue}const f=this._textLines[h],A=d/this.lineHeight,g=this._getLineLeftOffset(h);let p=0,y=0,v=this.getValueOfPropertyAt(h,0,t),m=this.getValueOfPropertyAt(h,0,Sa),w=this.getValueOfPropertyAt(h,0,yg),x=v,T=m,j=w;const D=i+A*(1-this._fontSizeFraction);let b=this.getHeightOfChar(h,0),_=this.getValueOfPropertyAt(h,0,"deltaY");for(let F=0,B=f.length;F<B;F++){const E=this.__charBounds[h][F];x=this.getValueOfPropertyAt(h,F,t),T=this.getValueOfPropertyAt(h,F,Sa),j=this.getValueOfPropertyAt(h,F,yg);const V=this.getHeightOfChar(h,F),K=this.getValueOfPropertyAt(h,F,"deltaY");if(s&&x&&T){const P=this.fontSize*j/1e3;e.save(),e.fillStyle=m,e.translate(E.renderLeft,E.renderTop),e.rotate(E.angle),e.fillRect(-E.kernedWidth/2,c*V+K-a*P,E.kernedWidth,P),e.restore()}else if((x!==v||T!==m||V!==b||j!==w||K!==_)&&y>0){const P=this.fontSize*w/1e3;let M=r+g+p;this.direction==="rtl"&&(M=this.width-M-y),v&&m&&w&&(e.fillStyle=m,e.fillRect(M,D+c*b+_-a*P,y,P)),p=E.left,y=E.width,v=x,w=j,m=T,b=V,_=K}else y+=E.kernedWidth}let I=r+g+p;this.direction==="rtl"&&(I=this.width-I-y),e.fillStyle=T;const S=this.fontSize*j/1e3;x&&T&&j&&e.fillRect(I,D+c*b+_-a*S,y-o,S),i+=d}this._removeShadow(e)}_getFontDeclaration(){let{fontFamily:e=this.fontFamily,fontStyle:t=this.fontStyle,fontWeight:i=this.fontWeight,fontSize:r=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;const o=e.includes("'")||e.includes('"')||e.includes(",")||Tl.genericFonts.includes(e.toLowerCase())?e:'"'.concat(e,'"');return[t,i,"".concat(s?this.CACHE_FONT_SIZE:r,"px"),o].join(" ")}render(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(e)))}graphemeSplit(e){return iS(e)}_splitTextIntoLines(e){const t=e.split(this._reNewline),i=new Array(t.length),r=[`
`];let s=[];for(let o=0;o<t.length;o++)i[o]=this.graphemeSplit(t[o]),s=s.concat(i[o],r);return s.pop(),{_unwrappedLines:i,lines:t,graphemeText:s,graphemeLines:i}}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return xt(xt({},super.toObject([...JG,...e])),{},{styles:fX(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(e,t){const{textLayoutProperties:i}=this.constructor;super.set(e,t);let r=!1,s=!1;if(typeof e=="object")for(const o in e)o==="path"&&this.setPathInfo(),r=r||i.includes(o),s=s||o==="path";else r=i.includes(e),s=e==="path";return s&&this.setPathInfo(),r&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(e,t,i){const r=PA(e,Tl.ATTRIBUTE_NAMES,i),s=xt(xt({},t),r),{textAnchor:o=Es,textDecoration:a="",dx:c=0,dy:h=0,top:u=0,left:d=0,fontSize:f=dF,strokeWidth:A=1}=s,g=Bo(s,Pke),p=new this((e.textContent||"").replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),xt({left:d+c,top:u+h,underline:a.includes("underline"),overline:a.includes("overline"),linethrough:a.includes("line-through"),strokeWidth:0,fontSize:f},g)),y=p.getScaledHeight()/p.height,v=((p.height+p.strokeWidth)*p.lineHeight-p.height)*y,m=p.getScaledHeight()+v;let w=0;return o===Br&&(w=p.getScaledWidth()/2),o===la&&(w=p.getScaledWidth()),p.set({left:p.left-w,top:p.top-(m-p.fontSize*(.07+p._fontSizeFraction))/p.lineHeight,strokeWidth:A}),p}static fromObject(e){return this._fromObject(xt(xt({},e),{},{styles:pX(e.styles||{},e.text)}),{extraParam:"text"})}}bt(Tl,"textLayoutProperties",ZG),bt(Tl,"cacheProperties",[...jA,...JG]),bt(Tl,"ownDefaults",$Ee),bt(Tl,"type","Text"),bt(Tl,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),bt(Tl,"ATTRIBUTE_NAMES",rp.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),cX(Tl,[class extends KG{_toSVG(){const n=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(n.textTop,n.textLeft);return this._wrapSVGTextAndBg(e)}toSVG(n){const e=this._createBaseSVGMarkup(this._toSVG(),{reviver:n,noStyle:!0,withShadow:!0}),t=this.path;return t?e+t._createBaseSVGMarkup(t._toSVG(),{reviver:n,withShadow:!0,additionalTransform:Dm(this.calcOwnMatrix())}):e}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(n){let{textBgRects:e,textSpans:t}=n;const i=this.getSvgTextDecoration(this);return[e.join(""),'		<text xml:space="preserve" ','font-family="'.concat(this.fontFamily.replace(jke,"'"),'" '),'font-size="'.concat(this.fontSize,'" '),this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",i?'text-decoration="'.concat(i,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",t.join(""),`</text>
`]}_getSVGTextAndBg(n,e){const t=[],i=[];let r,s=n;this.backgroundColor&&i.push(...xT(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let o=0,a=this._textLines.length;o<a;o++)r=this._getLineLeftOffset(o),this.direction==="rtl"&&(r+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",o))&&this._setSVGTextLineBg(i,o,e+r,s),this._setSVGTextLineText(t,o,e+r,s),s+=this.getHeightOfLine(o);return{textSpans:t,textBgRects:i}}_createTextCharSpan(n,e,t,i,r){const s=ds.NUM_FRACTION_DIGITS,o=this.getSvgSpanStyles(e,n!==n.trim()||!!n.match(Dke)),a=o?'style="'.concat(o,'"'):"",c=e.deltaY,h=c?' dy="'.concat(Xs(c,s),'" '):"",{angle:u,renderLeft:d,renderTop:f,width:A}=r;let g="";if(d!==void 0){const p=A/2;u&&(g=' rotate="'.concat(Xs(Sd(u),s),'"'));const y=jg({angle:Sd(u)});y[4]=d,y[5]=f;const v=new Gt(-p,0).transform(y);t=v.x,i=v.y}return'<tspan x="'.concat(Xs(t,s),'" y="').concat(Xs(i,s),'" ').concat(h).concat(g).concat(a,">").concat(AX(n),"</tspan>")}_setSVGTextLineText(n,e,t,i){const r=this.getHeightOfLine(e),s=this.textAlign.includes(od),o=this._textLines[e];let a,c,h,u,d,f="",A=0;i+=r*(1-this._fontSizeFraction)/this.lineHeight;for(let g=0,p=o.length-1;g<=p;g++)d=g===p||this.charSpacing||this.path,f+=o[g],h=this.__charBounds[e][g],A===0?(t+=h.kernedWidth-h.width,A+=h.width):A+=h.kernedWidth,s&&!d&&this._reSpaceAndTab.test(o[g])&&(d=!0),d||(a=a||this.getCompleteStyleDeclaration(e,g),c=this.getCompleteStyleDeclaration(e,g+1),d=rS(a,c,!0)),d&&(u=this._getStyleDeclaration(e,g),n.push(this._createTextCharSpan(f,u,t,i,h)),f="",a=c,this.direction==="rtl"?t-=A:t+=A,A=0)}_setSVGTextLineBg(n,e,t,i){const r=this._textLines[e],s=this.getHeightOfLine(e)/this.lineHeight;let o,a=0,c=0,h=this.getValueOfPropertyAt(e,0,"textBackgroundColor");for(let u=0;u<r.length;u++){const{left:d,width:f,kernedWidth:A}=this.__charBounds[e][u];o=this.getValueOfPropertyAt(e,u,"textBackgroundColor"),o!==h?(h&&n.push(...xT(h,t+c,i,a,s)),c=d,a=f,h=o):a+=A}o&&n.push(...xT(h,t+c,i,a,s))}_getSVGLineTopOffset(n){let e,t=0;for(e=0;e<n;e++)t+=this.getHeightOfLine(e);const i=this.getHeightOfLine(e);return{lineTop:t,offset:(this._fontSizeMult-this._fontSizeFraction)*i/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(n){return"".concat(super.getSvgStyles(n)," text-decoration-thickness: ").concat(Xs(this.textDecorationThickness*this.getObjectScaling().y/10,ds.NUM_FRACTION_DIGITS),"%; white-space: pre;")}getSvgSpanStyles(n,e){const{fontFamily:t,strokeWidth:i,stroke:r,fill:s,fontSize:o,fontStyle:a,fontWeight:c,deltaY:h,textDecorationThickness:u,linethrough:d,overline:f,underline:A}=n,g=this.getSvgTextDecoration({underline:A??this.underline,overline:f??this.overline,linethrough:d??this.linethrough}),p=u||this.textDecorationThickness;return[r?yv(yc,r):"",i?"stroke-width: ".concat(i,"; "):"",t?"font-family: ".concat(t.includes("'")||t.includes('"')?t:"'".concat(t,"'"),"; "):"",o?"font-size: ".concat(o,"px; "):"",a?"font-style: ".concat(a,"; "):"",c?"font-weight: ".concat(c,"; "):"",g?"text-decoration: ".concat(g,"; text-decoration-thickness: ").concat(Xs(p*this.getObjectScaling().y/10,ds.NUM_FRACTION_DIGITS),"%; "):"",s?yv(Sa,s):"",h?"baseline-shift: ".concat(-h,"; "):"",e?"white-space: pre; ":""].join("")}getSvgTextDecoration(n){return["overline","underline","line-through"].filter((e=>n[e.replace("-","")])).join(" ")}}]),bi.setClass(Tl),bi.setSVGClass(Tl);class Nke{constructor(e){bt(this,"target",void 0),bt(this,"__mouseDownInPlace",!1),bt(this,"__dragStartFired",!1),bt(this,"__isDraggingOver",!1),bt(this,"__dragStartSelection",void 0),bt(this,"__dragImageDisposer",void 0),bt(this,"_dispose",void 0),this.target=e;const t=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{t.forEach((i=>i())),this._dispose=void 0}}isPointerOverSelection(e){const t=this.target,i=t.getSelectionStartFromPointer(e);return t.isEditing&&i>=t.selectionStart&&i<=t.selectionEnd&&t.selectionStart<t.selectionEnd}start(e){return this.__mouseDownInPlace=this.isPointerOverSelection(e)}isActive(){return this.__mouseDownInPlace}end(e){const t=this.isActive();return t&&!this.__dragStartFired&&(this.target.setCursorByClick(e),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,t}getDragStartSelection(){return this.__dragStartSelection}setDragImage(e,t){var i;let{selectionStart:r,selectionEnd:s}=t;const o=this.target,a=o.canvas,c=new Gt(o.flipX?-1:1,o.flipY?-1:1),h=o._getCursorBoundaries(r),u=new Gt(h.left+h.leftOffset,h.top+h.topOffset).multiply(c).transform(o.calcTransformMatrix()),d=a.getScenePoint(e).subtract(u),f=o.getCanvasRetinaScaling(),A=o.getBoundingRect(),g=u.subtract(new Gt(A.left,A.top)),p=a.viewportTransform,y=g.add(d).transform(p,!0),v=o.backgroundColor,m=kF(o.styles);o.backgroundColor="";const w={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};o.setSelectionStyles(w,0,r),o.setSelectionStyles(w,s,o.text.length),o.dirty=!0;const x=o.toCanvasElement({enableRetinaScaling:a.enableRetinaScaling,viewportTransform:!0});o.backgroundColor=v,o.styles=m,o.dirty=!0,IC(x,{position:"fixed",left:"".concat(-x.width,"px"),border:mc,width:"".concat(x.width/f,"px"),height:"".concat(x.height/f,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{x.remove()},yu(e.target||this.target.hiddenTextarea).body.appendChild(x),(i=e.dataTransfer)===null||i===void 0||i.setDragImage(x,y.x,y.y)}onDragStart(e){this.__dragStartFired=!0;const t=this.target,i=this.isActive();if(i&&e.dataTransfer){const r=this.__dragStartSelection={selectionStart:t.selectionStart,selectionEnd:t.selectionEnd},s=t._text.slice(r.selectionStart,r.selectionEnd).join(""),o=xt({text:t.text,value:s},r);e.dataTransfer.setData("text/plain",s),e.dataTransfer.setData("application/fabric",JSON.stringify({value:s,styles:t.getSelectionStyles(r.selectionStart,r.selectionEnd,!0)})),e.dataTransfer.effectAllowed="copyMove",this.setDragImage(e,o)}return t.abortCursorAnimation(),i}canDrop(e){if(this.target.editable&&!this.target.getActiveControl()&&!e.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const t=this.target.getSelectionStartFromPointer(e),i=this.__dragStartSelection;return t<i.selectionStart||t>i.selectionEnd}return!0}return!1}targetCanDrop(e){return this.target.canDrop(e)}dragEnterHandler(e){let{e:t}=e;const i=this.targetCanDrop(t);!this.__isDraggingOver&&i&&(this.__isDraggingOver=!0)}dragOverHandler(e){const{e:t}=e,i=this.targetCanDrop(t);!this.__isDraggingOver&&i?this.__isDraggingOver=!0:this.__isDraggingOver&&!i&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(t.preventDefault(),e.canDrop=!0,e.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(e){var t;const{e:i}=e,r=i.defaultPrevented;this.__isDraggingOver=!1,i.preventDefault();let s=(t=i.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain");if(s&&!r){const o=this.target,a=o.canvas;let c=o.getSelectionStartFromPointer(i);const{styles:h}=i.dataTransfer.types.includes("application/fabric")?JSON.parse(i.dataTransfer.getData("application/fabric")):{},u=s[Math.max(0,s.length-1)],d=0;if(this.__dragStartSelection){const f=this.__dragStartSelection.selectionStart,A=this.__dragStartSelection.selectionEnd;c>f&&c<=A?c=f:c>A&&(c-=A-f),o.removeChars(f,A),delete this.__dragStartSelection}o._reNewline.test(u)&&(o._reNewline.test(o._text[c])||c===o._text.length)&&(s=s.trimEnd()),e.didDrop=!0,e.dropTarget=o,o.insertChars(s,h,c),a.setActiveObject(o),o.enterEditing(i),o.selectionStart=Math.min(c+d,o._text.length),o.selectionEnd=Math.min(o.selectionStart+s.length,o._text.length),o.hiddenTextarea.value=o.text,o._updateTextarea(),o.hiddenTextarea.focus(),o.fire(mC,{index:c+d,action:"drop"}),a.fire("text:changed",{target:o}),a.contextTopDirty=!0,a.requestRenderAll()}}dragEndHandler(e){let{e:t}=e;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var i;const r=this.target,s=this.target.canvas,{selectionStart:o,selectionEnd:a}=this.__dragStartSelection,c=((i=t.dataTransfer)===null||i===void 0?void 0:i.dropEffect)||mc;c===mc?(r.selectionStart=o,r.selectionEnd=a,r._updateTextarea(),r.hiddenTextarea.focus()):(r.clearContextTop(),c==="move"&&(r.removeChars(o,a),r.selectionStart=r.selectionEnd=o,r.hiddenTextarea&&(r.hiddenTextarea.value=r.text),r._updateTextarea(),r.fire(mC,{index:o,action:"dragend"}),s.fire("text:changed",{target:r}),s.requestRenderAll()),r.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const k7=/[ \n\.,;!\?\-]/;class Lke extends Tl{constructor(){super(...arguments),bt(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(e){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(e)}_animateCursor(e){let{toValue:t,duration:i,delay:r,onComplete:s}=e;return BF({startValue:this._currentCursorOpacity,endValue:t,duration:i,delay:r,onComplete:s,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:o=>{this._currentCursorOpacity=o,this.renderCursorOrSelection()}})}_tick(e){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(e||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var e;(e=this._currentTickCompleteState)===null||e===void 0||e.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(e){this.abortCursorAnimation(),this._tick(e?0:this.cursorDelay)}abortCursorAnimation(){let e=!1;[this._currentTickState,this._currentTickCompleteState].forEach((t=>{t&&!t.isDone()&&(e=!0,t.abort())})),this._currentCursorOpacity=1,e&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some((e=>!e||e.isDone()))&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}cmdAll(){this.selectAll(),this.renderCursorOrSelection()}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(e){let t=0,i=e-1;if(this._reSpace.test(this._text[i]))for(;this._reSpace.test(this._text[i]);)t++,i--;for(;/\S/.test(this._text[i])&&i>-1;)t++,i--;return e-t}findWordBoundaryRight(e){let t=0,i=e;if(this._reSpace.test(this._text[i]))for(;this._reSpace.test(this._text[i]);)t++,i++;for(;/\S/.test(this._text[i])&&i<this._text.length;)t++,i++;return e+t}findLineBoundaryLeft(e){let t=0,i=e-1;for(;!/\n/.test(this._text[i])&&i>-1;)t++,i--;return e-t}findLineBoundaryRight(e){let t=0,i=e;for(;!/\n/.test(this._text[i])&&i<this._text.length;)t++,i++;return e+t}searchWordBoundary(e,t){const i=this._text;let r=e>0&&this._reSpace.test(i[e])&&(t===-1||!AF.test(i[e-1]))?e-1:e,s=i[r];for(;r>0&&r<i.length&&!k7.test(s);)r+=t,s=i[r];return t===-1&&k7.test(s)&&r++,r}selectWord(e){var t;e=(t=e)!==null&&t!==void 0?t:this.selectionStart;const i=this.searchWordBoundary(e,-1),r=Math.max(i,this.searchWordBoundary(e,1));this.selectionStart=i,this.selectionEnd=r,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(e){var t;e=(t=e)!==null&&t!==void 0?t:this.selectionStart;const i=this.findLineBoundaryLeft(e),r=this.findLineBoundaryRight(e);this.selectionStart=i,this.selectionEnd=r,this._fireSelectionChanged(),this._updateTextarea()}enterEditing(e){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",e?{e}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(e){if(this.getActiveControl())return;const t=this.hiddenTextarea;yu(t).activeElement!==t&&t.focus();const i=this.getSelectionStartFromPointer(e),r=this.selectionStart,s=this.selectionEnd;(i===this.__selectionStartOnMouseDown&&r!==s||r!==i&&s!==i)&&(i>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=i):(this.selectionStart=i,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===r&&this.selectionEnd===s||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(e,t,i){const r=i.slice(0,e),s=this.graphemeSplit(r).length;if(e===t)return{selectionStart:s,selectionEnd:s};const o=i.slice(e,t);return{selectionStart:s,selectionEnd:s+this.graphemeSplit(o).length}}fromGraphemeToStringSelection(e,t,i){const r=i.slice(0,e).join("").length;return e===t?{selectionStart:r,selectionEnd:r}:{selectionStart:r,selectionEnd:r+i.slice(e,t).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};const e=this.hiddenTextarea;this.text=e.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();const t=this.fromStringToGraphemeSelection(e.selectionStart,e.selectionEnd,e.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const e=this.inCompositionMode?this.compositionStart:this.selectionStart,t=this._getCursorBoundaries(e),i=this.get2DCursorLocation(e),r=i.lineIndex,s=i.charIndex,o=this.getValueOfPropertyAt(r,s,"fontSize")*this.lineHeight,a=t.leftOffset,c=this.getCanvasRetinaScaling(),h=this.canvas.upperCanvasEl,u=h.width/c,d=h.height/c,f=u-o,A=d-o,g=new Gt(t.left+a,t.top+t.topOffset+o).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new Gt(h.clientWidth/u,h.clientHeight/d));return g.x<0&&(g.x=0),g.x>f&&(g.x=f),g.y<0&&(g.y=0),g.y>A&&(g.y=A),g.x+=this.canvas._offset.left,g.y+=this.canvas._offset.top,{left:"".concat(g.x,"px"),top:"".concat(g.y,"px"),fontSize:"".concat(o,"px"),charHeight:o}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){const e=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditingImpl(){this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){const e=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),e&&this.fire(yC),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const e in this.styles)this._textLines[e]||delete this.styles[e]}removeStyleFromTo(e,t){const{lineIndex:i,charIndex:r}=this.get2DCursorLocation(e,!0),{lineIndex:s,charIndex:o}=this.get2DCursorLocation(t,!0);if(i!==s){if(this.styles[i])for(let a=r;a<this._unwrappedTextLines[i].length;a++)delete this.styles[i][a];if(this.styles[s])for(let a=o;a<this._unwrappedTextLines[s].length;a++){const c=this.styles[s][a];c&&(this.styles[i]||(this.styles[i]={}),this.styles[i][r+a-o]=c)}for(let a=i+1;a<=s;a++)delete this.styles[a];this.shiftLineStyles(s,i-s)}else if(this.styles[i]){const a=this.styles[i],c=o-r;for(let h=r;h<o;h++)delete a[h];for(const h in this.styles[i]){const u=parseInt(h,10);u>=o&&(a[u-c]=a[h],delete a[h])}}}shiftLineStyles(e,t){const i=Object.assign({},this.styles);for(const r in this.styles){const s=parseInt(r,10);s>e&&(this.styles[s+t]=i[s],i[s-t]||delete this.styles[s])}}insertNewlineStyleObject(e,t,i,r){const s={},o=this._unwrappedTextLines[e].length,a=o===t;let c=!1;i||(i=1),this.shiftLineStyles(e,i);const h=this.styles[e]?this.styles[e][t===0?t:t-1]:void 0;for(const d in this.styles[e]){const f=parseInt(d,10);f>=t&&(c=!0,s[f-t]=this.styles[e][d],a&&t===0||delete this.styles[e][d])}let u=!1;for(c&&!a&&(this.styles[e+i]=s,u=!0),(u||o>t)&&i--;i>0;)r&&r[i-1]?this.styles[e+i]={0:xt({},r[i-1])}:h?this.styles[e+i]={0:xt({},h)}:delete this.styles[e+i],i--;this._forceClearCache=!0}insertCharStyleObject(e,t,i,r){this.styles||(this.styles={});const s=this.styles[e],o=s?xt({},s):{};i||(i=1);for(const c in o){const h=parseInt(c,10);h>=t&&(s[h+i]=o[h],o[h-i]||delete s[h])}if(this._forceClearCache=!0,r){for(;i--;)Object.keys(r[i]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][t+i]=xt({},r[i]));return}if(!s)return;const a=s[t?t-1:1];for(;a&&i--;)this.styles[e][t+i]=xt({},a)}insertNewStyleBlock(e,t,i){const r=this.get2DCursorLocation(t,!0),s=[0];let o,a=0;for(let c=0;c<e.length;c++)e[c]===`
`?(a++,s[a]=0):s[a]++;for(s[0]>0&&(this.insertCharStyleObject(r.lineIndex,r.charIndex,s[0],i),i=i&&i.slice(s[0]+1)),a&&this.insertNewlineStyleObject(r.lineIndex,r.charIndex+s[0],a),o=1;o<a;o++)s[o]>0?this.insertCharStyleObject(r.lineIndex+o,0,s[o],i):i&&this.styles[r.lineIndex+o]&&i[0]&&(this.styles[r.lineIndex+o][0]=i[0]),i=i&&i.slice(s[o]+1);s[o]>0&&this.insertCharStyleObject(r.lineIndex+o,0,s[o],i)}removeChars(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e+1;this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(e,t,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:i;r>i&&this.removeStyleFromTo(i,r);const s=this.graphemeSplit(e);this.insertNewStyleBlock(s,i,t),this._text=[...this._text.slice(0,i),...s,...this._text.slice(r)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(e,t,i){i<=e?(t===e?this._selectionDirection=Es:this._selectionDirection===la&&(this._selectionDirection=Es,this.selectionEnd=e),this.selectionStart=i):i>e&&i<t?this._selectionDirection===la?this.selectionEnd=i:this.selectionStart=i:(t===e?this._selectionDirection=la:this._selectionDirection===Es&&(this._selectionDirection=la,this.selectionStart=t),this.selectionEnd=i)}}class Mke extends Lke{initHiddenTextarea(){const e=this.canvas&&yu(this.canvas.getElement())||Zm(),t=e.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off"}).map((o=>{let[a,c]=o;return t.setAttribute(a,c)}));const{top:i,left:r,fontSize:s}=this._calcTextareaPosition();t.style.cssText="position: absolute; top: ".concat(i,"; left: ").concat(r,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(s,";"),(this.hiddenTextareaContainer||e.body).appendChild(t),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map((o=>{let[a,c]=o;return t.addEventListener(a,this[c].bind(this))})),this.hiddenTextarea=t}blur(){this.abortCursorAnimation()}onKeyDown(e){if(!this.isEditing)return;const t=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(e){const t=this.fromPaste,{value:i,selectionStart:r,selectionEnd:s}=this.hiddenTextarea;if(this.fromPaste=!1,e&&e.stopPropagation(),!this.isEditing)return;const o=()=>{this.updateFromTextArea(),this.fire(mC),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void o();const a=this._splitTextIntoLines(i).graphemeText,c=this._text.length,h=a.length,u=this.selectionStart,d=this.selectionEnd,f=u!==d;let A,g,p,y,v=h-c;const m=this.fromStringToGraphemeSelection(r,s,i),w=u>m.selectionStart;f?(g=this._text.slice(u,d),v+=d-u):h<c&&(g=w?this._text.slice(d+v,d):this._text.slice(u,u-v));const x=a.slice(m.selectionEnd-v,m.selectionEnd);if(g&&g.length&&(x.length&&(A=this.getSelectionStyles(u,u+1,!1),A=x.map((()=>A[0]))),f?(p=u,y=d):w?(p=d-g.length,y=d):(p=d,y=d+g.length),this.removeStyleFromTo(p,y)),x.length){const{copyPasteData:T}=_d();t&&x.join("")===T.copiedText&&!ds.disableStyleCopyPaste&&(A=T.copiedTextStyle),this.insertNewStyleBlock(x,u,A)}o()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(e){let{target:t}=e;const{selectionStart:i,selectionEnd:r}=t;this.compositionStart=i,this.compositionEnd=r,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:e}=_d();e.copiedText=this.getSelectedText(),ds.disableStyleCopyPaste?e.copiedTextStyle=void 0:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(e,t){let i,r=this._getLineLeftOffset(e);return t>0&&(i=this.__charBounds[e][t-1],r+=i.left+i.width),r}getDownCursorOffset(e,t){const i=this._getSelectionForOffset(e,t),r=this.get2DCursorLocation(i),s=r.lineIndex;if(s===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-i;const o=r.charIndex,a=this._getWidthBeforeCursor(s,o),c=this._getIndexOnLine(s+1,a);return this._textLines[s].slice(o).length+c+1+this.missingNewlineOffset(s)}_getSelectionForOffset(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart}getUpCursorOffset(e,t){const i=this._getSelectionForOffset(e,t),r=this.get2DCursorLocation(i),s=r.lineIndex;if(s===0||e.metaKey||e.keyCode===33)return-i;const o=r.charIndex,a=this._getWidthBeforeCursor(s,o),c=this._getIndexOnLine(s-1,a),h=this._textLines[s].slice(0,o),u=this.missingNewlineOffset(s-1);return-this._textLines[s-1].length+c-h.length+(1-u)}_getIndexOnLine(e,t){const i=this._textLines[e];let r,s,o=this._getLineLeftOffset(e),a=0;for(let c=0,h=i.length;c<h;c++)if(r=this.__charBounds[e][c].width,o+=r,o>t){s=!0;const u=o-r,d=o,f=Math.abs(u-t);a=Math.abs(d-t)<f?c:c-1;break}return s||(a=i.length-1),a}moveCursorDown(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)}moveCursorUp(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)}_moveCursorUpOrDown(e,t){const i=this["get".concat(e,"CursorOffset")](t,this._selectionDirection===la);if(t.shiftKey?this.moveCursorWithShift(i):this.moveCursorWithoutShift(i),i!==0){const r=this.text.length;this.selectionStart=vg(0,this.selectionStart,r),this.selectionEnd=vg(0,this.selectionEnd,r),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(e){const t=this._selectionDirection===Es?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),e!==0}moveCursorWithoutShift(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0}moveCursorLeft(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)}_move(e,t,i){let r;if(e.altKey)r=this["findWordBoundary".concat(i)](this[t]);else{if(!e.metaKey&&e.keyCode!==35&&e.keyCode!==36)return this[t]+=i==="Left"?-1:1,!0;r=this["findLineBoundary".concat(i)](this[t])}return r!==void 0&&this[t]!==r&&(this[t]=r,!0)}_moveLeft(e,t){return this._move(e,t,"Left")}_moveRight(e,t){return this._move(e,t,"Right")}moveCursorLeftWithoutShift(e){let t=!0;return this._selectionDirection=Es,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t}moveCursorLeftWithShift(e){return this._selectionDirection===la&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=Es,this._moveLeft(e,"selectionStart")):void 0}moveCursorRight(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)}_moveCursorLeftOrRight(e,t){const i="moveCursor".concat(e).concat(t.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[i](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(e){return this._selectionDirection===Es&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=la,this._moveRight(e,"selectionEnd")):void 0}moveCursorRightWithoutShift(e){let t=!0;return this._selectionDirection=la,this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t}}const I7=n=>!!n.button;class Rke extends Mke{constructor(){super(...arguments),bt(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("mousetripleclick",this.tripleClickHandler),this.draggableTextDelegate=new Nke(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(e){return this.draggableTextDelegate.onDragStart(e)}canDrop(e){return this.draggableTextDelegate.canDrop(e)}doubleClickHandler(e){this.isEditing&&(this.selectWord(this.getSelectionStartFromPointer(e.e)),this.renderCursorOrSelection())}tripleClickHandler(e){this.isEditing&&(this.selectLine(this.getSelectionStartFromPointer(e.e)),this.renderCursorOrSelection())}_mouseDownHandler(e){let{e:t,alreadySelected:i}=e;this.canvas&&this.editable&&!I7(t)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(t)||(this.canvas.textEditingManager.register(this),i&&(this.inCompositionMode=!1,this.setCursorByClick(t)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()),this.selected||(this.selected=i||this.isEditing)))}mouseUpHandler(e){let{e:t,transform:i}=e;const r=this.draggableTextDelegate.end(t);if(this.canvas){this.canvas.textEditingManager.unregister(this);const s=this.canvas._activeObject;if(s&&s!==this)return}!this.editable||this.group&&!this.group.interactive||i&&i.actionPerformed||I7(t)||r||this.selected&&!this.getActiveControl()&&(this.enterEditing(t),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection())}setCursorByClick(e){const t=this.getSelectionStartFromPointer(e),i=this.selectionStart,r=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(i,r,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(e){const t=this.canvas.getScenePoint(e).transform(Oc(this.calcTransformMatrix())).add(new Gt(-this._getLeftOffset(),-this._getTopOffset()));let i=0,r=0,s=0;for(let h=0;h<this._textLines.length&&i<=t.y;h++)i+=this.getHeightOfLine(h),s=h,h>0&&(r+=this._textLines[h-1].length+this.missingNewlineOffset(h-1));let o=Math.abs(this._getLineLeftOffset(s));const a=this._textLines[s].length,c=this.__charBounds[s];for(let h=0;h<a;h++){const u=o+c[h].kernedWidth;if(t.x<=u){Math.abs(t.x-u)<=Math.abs(t.x-o)&&r++;break}o=u,r++}return Math.min(this.flipX?a-r:r,this._text.length)}}const sb="moveCursorUp",ob="moveCursorDown",ab="moveCursorLeft",lb="moveCursorRight",cb="exitEditing",F7=(n,e)=>{const t=e.getRetinaScaling();n.setTransform(t,0,0,t,0,0);const i=e.viewportTransform;n.transform(i[0],i[1],i[2],i[3],i[4],i[5])},Oke=xt({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:cb,27:cb,33:sb,34:ob,35:lb,36:ab,37:ab,38:sb,39:lb,40:ob},keysMapRtl:{9:cb,27:cb,33:sb,34:ob,35:ab,36:lb,37:lb,38:sb,39:ab,40:ob},ctrlKeysMapDown:{65:"cmdAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1});class _u extends Rke{static getDefaults(){return xt(xt({},super.getDefaults()),_u.ownDefaults)}get type(){const e=super.type;return e==="itext"?"i-text":e}constructor(e,t){super(e,xt(xt({},_u.ownDefaults),t)),this.initBehavior()}_set(e,t){return this.isEditing&&this._savedProps&&e in this._savedProps?(this._savedProps[e]=t,this):(e==="canvas"&&(this.canvas instanceof x6&&this.canvas.textEditingManager.remove(this),t instanceof x6&&t.textEditingManager.add(this)),super._set(e,t))}setSelectionStart(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)}setSelectionEnd(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)}_updateAndFire(e,t){this[e]!==t&&(this._fireSelectionChanged(),this[e]=t),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,i=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(e,t,i)}setSelectionStyles(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(e,t,i)}get2DCursorLocation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(e,t)}render(e){super.render(e),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(e){const t=this.isEditing;this.isEditing=!1;const i=super.toCanvasElement(e);return this.isEditing=t,i}renderCursorOrSelection(){if(!this.isEditing||!this.canvas)return;const e=this.clearContextTop(!0);if(!e)return;const t=this._getCursorBoundaries(),i=this.findAncestorsWithClipPath(),r=i.length>0;let s,o=e;if(r){s=fh(e.canvas),o=s.getContext("2d"),F7(o,this.canvas);const a=this.calcTransformMatrix();o.transform(a[0],a[1],a[2],a[3],a[4],a[5])}if(this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(o,t):this.renderCursor(o,t),r)for(const a of i){const c=a.clipPath,h=fh(e.canvas),u=h.getContext("2d");if(F7(u,this.canvas),!c.absolutePositioned){const d=a.calcTransformMatrix();u.transform(d[0],d[1],d[2],d[3],d[4],d[5])}c.transform(u),c.drawObject(u,!0,{}),this.drawClipPathOnCache(o,c,h)}r&&(e.setTransform(1,0,0,1,0,0),e.drawImage(s,0,0)),this.canvas.contextTopDirty=!0,e.restore()}findAncestorsWithClipPath(){const e=[];let t=this;for(;t;)t.clipPath&&e.push(t),t=t.parent;return e}_getCursorBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;const i=this._getLeftOffset(),r=this._getTopOffset(),s=this._getCursorBoundariesOffsets(e,t);return{left:i,top:r,leftOffset:s.left,topOffset:s.top}}_getCursorBoundariesOffsets(e,t){return t?this.__getCursorBoundariesOffsets(e):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(e)}__getCursorBoundariesOffsets(e){let t=0,i=0;const{charIndex:r,lineIndex:s}=this.get2DCursorLocation(e);for(let h=0;h<s;h++)t+=this.getHeightOfLine(h);const o=this._getLineLeftOffset(s),a=this.__charBounds[s][r];a&&(i=a.left),this.charSpacing!==0&&r===this._textLines[s].length&&(i-=this._getWidthOfCharSpacing());const c={top:t,left:o+(i>0?i:0)};return this.direction==="rtl"&&(this.textAlign===la||this.textAlign===od||this.textAlign===Uy?c.left*=-1:this.textAlign===Es||this.textAlign===bC?c.left=o-(i>0?i:0):this.textAlign!==Br&&this.textAlign!==Hy||(c.left=o-(i>0?i:0))),c}renderCursorAt(e){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(e,!0),e)}renderCursor(e,t){this._renderCursor(e,t,this.selectionStart)}getCursorRenderingData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(e);const i=this.get2DCursorLocation(e),r=i.lineIndex,s=i.charIndex>0?i.charIndex-1:0,o=this.getValueOfPropertyAt(r,s,"fontSize"),a=this.getObjectScaling().x*this.canvas.getZoom(),c=this.cursorWidth/a,h=this.getValueOfPropertyAt(r,s,"deltaY"),u=t.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(r)/this.lineHeight-o*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(r,s,"fill"),opacity:this._currentCursorOpacity,left:t.left+t.leftOffset-c/2,top:u+t.top+h,width:c,height:o}}_renderCursor(e,t,i){const{color:r,opacity:s,left:o,top:a,width:c,height:h}=this.getCursorRenderingData(i,t);e.fillStyle=r,e.globalAlpha=s,e.fillRect(o,a,c,h)}renderSelection(e,t){const i={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(e,i,t)}renderDragSourceEffect(){const e=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,e,this._getCursorBoundaries(e.selectionStart,!0))}renderDropTargetEffect(e){const t=this.getSelectionStartFromPointer(e);this.renderCursorAt(t)}_renderSelection(e,t,i){const r=t.selectionStart,s=t.selectionEnd,o=this.textAlign.includes(od),a=this.get2DCursorLocation(r),c=this.get2DCursorLocation(s),h=a.lineIndex,u=c.lineIndex,d=a.charIndex<0?0:a.charIndex,f=c.charIndex<0?0:c.charIndex;for(let A=h;A<=u;A++){const g=this._getLineLeftOffset(A)||0;let p=this.getHeightOfLine(A),y=0,v=0,m=0;if(A===h&&(v=this.__charBounds[h][d].left),A>=h&&A<u)m=o&&!this.isEndOfWrapping(A)?this.width:this.getLineWidth(A)||5;else if(A===u)if(f===0)m=this.__charBounds[u][f].left;else{const D=this._getWidthOfCharSpacing();m=this.__charBounds[u][f-1].left+this.__charBounds[u][f-1].width-D}y=p,(this.lineHeight<1||A===u&&this.lineHeight>1)&&(p/=this.lineHeight);let w=i.left+g+v,x=p,T=0;const j=m-v;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",x=1,T=p):e.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===la||this.textAlign===od||this.textAlign===Uy?w=this.width-w-j:this.textAlign===Es||this.textAlign===bC?w=i.left+g-m:this.textAlign!==Br&&this.textAlign!==Hy||(w=i.left+g-m)),e.fillRect(w,i.top+i.topOffset+T,j,x),i.topOffset+=y}}getCurrentCharFontSize(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")}getCurrentCharColor(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,Sa)}_getCurrentCharIndex(){const e=this.get2DCursorLocation(this.selectionStart,!0),t=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:t}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}}bt(_u,"ownDefaults",Oke),bt(_u,"type","IText"),bi.setClass(_u),bi.setClass(_u,"i-text");class Vp extends _u{static getDefaults(){return xt(xt({},super.getDefaults()),Vp.ownDefaults)}constructor(e,t){super(e,xt(xt({},Vp.ownDefaults),t))}static createControls(){return{controls:_6e()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(od)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(e){let t=0,i=0,r=0;const s={};for(let o=0;o<e.graphemeLines.length;o++)e.graphemeText[r]===`
`&&o>0?(i=0,r++,t++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[r])&&o>0&&(i++,r++),s[o]={line:t,offset:i},r+=e.graphemeLines[o].length,i+=e.graphemeLines[o].length;return s}styleHas(e,t){if(this._styleMap&&!this.isWrapping){const i=this._styleMap[t];i&&(t=i.line)}return super.styleHas(e,t)}isEmptyStyles(e){if(!this.styles)return!0;let t,i=0,r=e+1,s=!1;const o=this._styleMap[e],a=this._styleMap[e+1];o&&(e=o.line,i=o.offset),a&&(r=a.line,s=r===e,t=a.offset);const c=e===void 0?this.styles:{line:this.styles[e]};for(const h in c)for(const u in c[h]){const d=parseInt(u,10);if(d>=i&&(!s||d<t))for(const f in c[h][u])return!1}return!0}_getStyleDeclaration(e,t){if(this._styleMap&&!this.isWrapping){const i=this._styleMap[e];if(!i)return{};e=i.line,t=i.offset+t}return super._getStyleDeclaration(e,t)}_setStyleDeclaration(e,t,i){const r=this._styleMap[e];super._setStyleDeclaration(r.line,r.offset+t,i)}_deleteStyleDeclaration(e,t){const i=this._styleMap[e];super._deleteStyleDeclaration(i.line,i.offset+t)}_getLineStyle(e){const t=this._styleMap[e];return!!this.styles[t.line]}_setLineStyle(e){const t=this._styleMap[e];super._setLineStyle(t.line)}_wrapText(e,t){this.isWrapping=!0;const i=this.getGraphemeDataForRender(e),r=[];for(let s=0;s<i.wordsData.length;s++)r.push(...this._wrapLine(s,t,i));return this.isWrapping=!1,r}getGraphemeDataForRender(e){const t=this.splitByGrapheme,i=t?"":" ";let r=0;return{wordsData:e.map(((s,o)=>{let a=0;const c=t?this.graphemeSplit(s):this.wordSplit(s);return c.length===0?[{word:[],width:0}]:c.map((h=>{const u=t?[h]:this.graphemeSplit(h),d=this._measureWord(u,o,a);return r=Math.max(d,r),a+=u.length+i.length,{word:u,width:d}}))})),largestWordWidth:r}}_measureWord(e,t){let i,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=0;for(let o=0,a=e.length;o<a;o++)s+=this._getGraphemeBox(e[o],t,o+r,i,!0).kernedWidth,i=e[o];return s}wordSplit(e){return e.split(this._wordJoiners)}_wrapLine(e,t,i){let{largestWordWidth:r,wordsData:s}=i,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const a=this._getWidthOfCharSpacing(),c=this.splitByGrapheme,h=[],u=c?"":" ";let d=0,f=[],A=0,g=0,p=!0;t-=o;const y=Math.max(t,r,this.dynamicMinWidth),v=s[e];let m;for(A=0,m=0;m<v.length;m++){const{word:w,width:x}=v[m];A+=w.length,d+=g+x-a,d>y&&!p?(h.push(f),f=[],d=x,p=!0):d+=a,p||c||f.push(u),f=f.concat(w),g=c?0:this._measureWord([u],e,A),A++,p=!1}return m&&h.push(f),r+o>this.dynamicMinWidth&&(this.dynamicMinWidth=r-a+o),h}isEndOfWrapping(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line}missingNewlineOffset(e,t){return this.splitByGrapheme&&!t?this.isEndOfWrapping(e)?1:0:1}_splitTextIntoLines(e){const t=super._splitTextIntoLines(e),i=this._wrapText(t.lines,this.width),r=new Array(i.length);for(let s=0;s<i.length;s++)r[s]=i[s].join("");return t.lines=r,t.graphemeLines=i,t}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const e=new Map;for(const t in this._styleMap){const i=parseInt(t,10);if(this._textLines[i]){const r=this._styleMap[t].line;e.set("".concat(r),!0)}}for(const t in this.styles)e.has(t)||delete this.styles[t]}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...e])}}bt(Vp,"type","Textbox"),bt(Vp,"textLayoutProperties",[..._u.textLayoutProperties,"width"]),bt(Vp,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),bi.setClass(Vp);class D7 extends sS{shouldPerformLayout(e){return!!e.target.clipPath&&super.shouldPerformLayout(e)}shouldLayoutClipPath(){return!1}calcLayoutResult(e,t){const{target:i}=e,{clipPath:r,group:s}=i;if(!r||!this.shouldPerformLayout(e))return;const{width:o,height:a}=md(mX(i,r)),c=new Gt(o,a);if(r.absolutePositioned)return{center:ig(r.getRelativeCenterPoint(),void 0,s?s.calcTransformMatrix():void 0),size:c};{const h=r.getRelativeCenterPoint().transform(i.calcOwnMatrix(),!0);if(this.shouldPerformLayout(e)){const{center:u=new Gt,correction:d=new Gt}=this.calcBoundingBox(t,e)||{};return{center:u.add(h),correction:d.subtract(h),size:c}}return{center:i.getRelativeCenterPoint().add(h),size:c}}}}bt(D7,"type","clip-path"),bi.setClass(D7);class j7 extends sS{getInitialSize(e,t){let{target:i}=e,{size:r}=t;return new Gt(i.width||r.x,i.height||r.y)}}bt(j7,"type","fixed"),bi.setClass(j7);class Uke extends wv{subscribeTargets(e){const t=e.target;e.targets.reduce(((i,r)=>(r.parent&&i.add(r.parent),i)),new Set).forEach((i=>{i.layoutManager.subscribeTargets({target:i,targets:[t]})}))}unsubscribeTargets(e){const t=e.target,i=t.getObjects();e.targets.reduce(((r,s)=>(s.parent&&r.add(s.parent),r)),new Set).forEach((r=>{!i.some((s=>s.parent===r))&&r.layoutManager.unsubscribeTargets({target:r,targets:[t]})}))}}class zp extends hh{static getDefaults(){return xt(xt({},super.getDefaults()),zp.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,zp.ownDefaults),this.setOptions(t);const{left:i,top:r,layoutManager:s}=t;this.groupInit(e,{left:i,top:r,layoutManager:s??new Uke})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.multiSelectionStacking==="selection-order"?this.add(...t):t.forEach((r=>{const s=this._objects.findIndex((a=>a.isInFrontOf(r))),o=s===-1?this.size():s;this.insertAt(o,r)}))}canEnterGroup(e){return this.getObjects().some((t=>t.isDescendantOf(e)||e.isDescendantOf(t)))?(SA("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(e)}enterGroup(e,t){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,t)}exitGroup(e,t){this._exitGroup(e,t),e.parent&&e.parent._enterGroup(e,!0)}_onAfterObjectsChange(e,t){super._onAfterObjectsChange(e,t);const i=new Set;t.forEach((r=>{const{parent:s}=r;s&&i.add(s)})),e===FF?i.forEach((r=>{r._onAfterObjectsChange(BC,t)})):i.forEach((r=>{r._set("dirty",!0)}))}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(e,t,i){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const r=xt(xt({hasControls:!1},i),{},{forActiveSelection:!0});for(let s=0;s<this._objects.length;s++)this._objects[s]._renderControls(e,r);super._renderControls(e,t),e.restore()}}bt(zp,"type","ActiveSelection"),bt(zp,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),bi.setClass(zp),bi.setClass(zp,"activeSelection");class Hke{constructor(){bt(this,"resources",{})}applyFilters(e,t,i,r,s){const o=s.getContext("2d");if(!o)return;o.drawImage(t,0,0,i,r);const a={sourceWidth:i,sourceHeight:r,imageData:o.getImageData(0,0,i,r),originalEl:t,originalImageData:o.getImageData(0,0,i,r),canvasEl:s,ctx:o,filterBackend:this};e.forEach((h=>{h.applyTo(a)}));const{imageData:c}=a;return c.width===i&&c.height===r||(s.width=c.width,s.height=c.height),o.putImageData(c,0,0),a}}class RX{constructor(){let{tileSize:e=ds.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};bt(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),bt(this,"resources",{}),this.tileSize=e,this.setupGLContext(e,e),this.captureGPUInfo()}setupGLContext(e,t){this.dispose(),this.createWebGLCanvas(e,t)}createWebGLCanvas(e,t){const i=fh({width:e,height:t}),r=i.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});r&&(r.clearColor(0,0,0,0),this.canvas=i,this.gl=r)}applyFilters(e,t,i,r,s,o){const a=this.gl,c=s.getContext("2d");if(!a||!c)return;let h;o&&(h=this.getCachedTexture(o,t));const u={originalWidth:t.width||t.naturalWidth||0,originalHeight:t.height||t.naturalHeight||0,sourceWidth:i,sourceHeight:r,destinationWidth:i,destinationHeight:r,context:a,sourceTexture:this.createTexture(a,i,r,h?void 0:t),targetTexture:this.createTexture(a,i,r),originalTexture:h||this.createTexture(a,i,r,h?void 0:t),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:s},d=a.createFramebuffer();return a.bindFramebuffer(a.FRAMEBUFFER,d),e.forEach((f=>{f&&f.applyTo(u)})),(function(f){const A=f.targetCanvas,g=A.width,p=A.height,y=f.destinationWidth,v=f.destinationHeight;g===y&&p===v||(A.width=y,A.height=v)})(u),this.copyGLTo2D(a,u),a.bindTexture(a.TEXTURE_2D,null),a.deleteTexture(u.sourceTexture),a.deleteTexture(u.targetTexture),a.deleteFramebuffer(d),c.setTransform(1,0,0,1,0,0),u}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(e,t,i,r,s){const{NEAREST:o,TEXTURE_2D:a,RGBA:c,UNSIGNED_BYTE:h,CLAMP_TO_EDGE:u,TEXTURE_MAG_FILTER:d,TEXTURE_MIN_FILTER:f,TEXTURE_WRAP_S:A,TEXTURE_WRAP_T:g}=e,p=e.createTexture();return e.bindTexture(a,p),e.texParameteri(a,d,s||o),e.texParameteri(a,f,s||o),e.texParameteri(a,A,u),e.texParameteri(a,g,u),r?e.texImage2D(a,0,c,c,h,r):e.texImage2D(a,0,c,t,i,0,c,h,null),p}getCachedTexture(e,t,i){const{textureCache:r}=this;if(r[e])return r[e];{const s=this.createTexture(this.gl,t.width,t.height,t,i);return s&&(r[e]=s),s}}evictCachesForKey(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])}copyGLTo2D(e,t){const i=e.canvas,r=t.targetCanvas,s=r.getContext("2d");if(!s)return;s.translate(0,r.height),s.scale(1,-1);const o=i.height-r.height;s.drawImage(i,0,o,r.width,r.height,0,0,r.width,r.height)}copyGLTo2DPutImageData(e,t){const i=t.targetCanvas.getContext("2d"),r=t.destinationWidth,s=t.destinationHeight,o=r*s*4;if(!i)return;const a=new Uint8Array(this.imageBuffer,0,o),c=new Uint8ClampedArray(this.imageBuffer,0,o);e.readPixels(0,0,r,s,e.RGBA,e.UNSIGNED_BYTE,a);const h=new ImageData(c,r,s);i.putImageData(h,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const e=this.gl,t={renderer:"",vendor:""};if(!e)return t;const i=e.getExtension("WEBGL_debug_renderer_info");if(i){const r=e.getParameter(i.UNMASKED_RENDERER_WEBGL),s=e.getParameter(i.UNMASKED_VENDOR_WEBGL);r&&(t.renderer=r.toLowerCase()),s&&(t.vendor=s.toLowerCase())}return this.gpuInfo=t,t}}let _T;function Wke(){const{WebGLProbe:n}=_d();return n.queryWebGL(Cd()),ds.enableGLFiltering&&n.isSupported(ds.textureSize)?new RX({tileSize:ds.textureSize}):new Hke}function CT(){return!_T&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(_T=Wke()),_T}const Qke=["filters","resizeFilter","src","crossOrigin","type"],OX=["cropX","cropY"];class ih extends Zl{static getDefaults(){return xt(xt({},super.getDefaults()),ih.ownDefaults)}constructor(e,t){super(),bt(this,"_lastScaleX",1),bt(this,"_lastScaleY",1),bt(this,"_filterScalingX",1),bt(this,"_filterScalingY",1),this.filters=[],Object.assign(this,ih.ownDefaults),this.setOptions(t),this.cacheKey="texture".concat(Gf()),this.setElement(typeof e=="string"?(this.canvas&&yu(this.canvas.getElement())||Zm()).getElementById(e):e,t)}getElement(){return this._element}setElement(e){var t;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=e,this._originalElement=e,this._setWidthHeight(i),(t=e.classList)===null||t===void 0||t.add(ih.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(e){const t=CT(!1);t instanceof RX&&t.evictCachesForKey(e)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach((e=>{const t=this[e];t&&_d().dispose(t),this[e]=void 0}))}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const e=this.getElement();return e?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:0,height:0}}_stroke(e){if(!this.stroke||this.strokeWidth===0)return;const t=this.width/2,i=this.height/2;e.beginPath(),e.moveTo(-t,-i),e.lineTo(t,-i),e.lineTo(t,i),e.lineTo(-t,i),e.lineTo(-t,-i),e.closePath()}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=[];return this.filters.forEach((i=>{i&&t.push(i.toObject())})),xt(xt({},super.toObject([...OX,...e])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:t},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const e=[],t=this._element,i=-this.width/2,r=-this.height/2;let s=[],o=[],a="",c="";if(!t)return[];if(this.hasCrop()){const h=Gf();s.push('<clipPath id="imageCrop_'+h+`">
`,'	<rect x="'+i+'" y="'+r+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),a=' clip-path="url(#imageCrop_'+h+')" '}if(this.imageSmoothing||(c=' image-rendering="optimizeSpeed"'),e.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(i-this.cropX,'" y="').concat(r-this.cropY,'" width="').concat(t.width||t.naturalWidth,'" height="').concat(t.height||t.naturalHeight,'"').concat(c).concat(a,`></image>
`)),this.stroke||this.strokeDashArray){const h=this.fill;this.fill=null,o=['	<rect x="'.concat(i,'" y="').concat(r,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=h}return s=this.paintFirst!==Sa?s.concat(o,e):s.concat(e,o),s}getSrc(e){const t=e?this._element:this._originalElement;return t?t.toDataURL?t.toDataURL():this.srcFromAttribute?t.getAttribute("src")||"":t.src:this.src||""}getSvgSrc(e){return this.getSrc(e)}setSrc(e){let{crossOrigin:t,signal:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Oy(e,{crossOrigin:t,signal:i}).then((r=>{t!==void 0&&this.set({crossOrigin:t}),this.setElement(r)}))}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){const e=this.resizeFilter,t=this.minimumScaleTrigger,i=this.getTotalObjectScaling(),r=i.x,s=i.y,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||r>t&&s>t)return this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=r,void(this._lastScaleY=s);const a=fh(o),{width:c,height:h}=o;this._element=a,this._lastScaleX=e.scaleX=r,this._lastScaleY=e.scaleY=s,CT().applyFilters([e],o,c,h,this._element),this._filterScalingX=a.width/this._originalElement.width,this._filterScalingY=a.height/this._originalElement.height}applyFilters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(e=e.filter((s=>s&&!s.isNeutralState())),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),e.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const t=this._originalElement,i=t.naturalWidth||t.width,r=t.naturalHeight||t.height;if(this._element===this._originalElement){const s=fh({width:i,height:r});this._element=s,this._filteredEl=s}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,i,r),this._lastScaleX=1,this._lastScaleY=1);CT().applyFilters(e,this._originalElement,i,r,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(e){e.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)}drawCacheOnCanvas(e){e.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(e)}shouldCache(){return this.needsItsOwnCache()}_renderFill(e){const t=this._element;if(!t)return;const i=this._filterScalingX,r=this._filterScalingY,s=this.width,o=this.height,a=Math.max(this.cropX,0),c=Math.max(this.cropY,0),h=t.naturalWidth||t.width,u=t.naturalHeight||t.height,d=a*i,f=c*r,A=Math.min(s*i,h-d),g=Math.min(o*r,u-f),p=-s/2,y=-o/2,v=Math.min(s,h/i-a),m=Math.min(o,u/r-c);t&&e.drawImage(t,d,f,A,g,p,y,v,m)}_needsResize(){const e=this.getTotalObjectScaling();return e.x!==this._lastScaleX||e.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:e,height:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const i=this.getOriginalSize();this.width=e||i.width,this.height=t||i.height}parsePreserveAspectRatioAttribute(){const e=_F(this.preserveAspectRatio||""),t=this.width,i=this.height,r={width:t,height:i};let s,o=this._element.width,a=this._element.height,c=1,h=1,u=0,d=0,f=0,A=0;return!e||e.alignX===mc&&e.alignY===mc?(c=t/o,h=i/a):(e.meetOrSlice==="meet"&&(c=h=vX(this._element,r),s=(t-o*c)/2,e.alignX==="Min"&&(u=-s),e.alignX==="Max"&&(u=s),s=(i-a*h)/2,e.alignY==="Min"&&(d=-s),e.alignY==="Max"&&(d=s)),e.meetOrSlice==="slice"&&(c=h=wX(this._element,r),s=o-t/c,e.alignX==="Mid"&&(f=s/2),e.alignX==="Max"&&(f=s),s=a-i/h,e.alignY==="Mid"&&(A=s/2),e.alignY==="Max"&&(A=s),o=t/c,a=i/h)),{width:o,height:a,scaleX:c,scaleY:h,offsetLeft:u,offsetTop:d,cropX:f,cropY:A}}static fromObject(e,t){let{filters:i,resizeFilter:r,src:s,crossOrigin:o,type:a}=e,c=Bo(e,Qke);return Promise.all([Oy(s,xt(xt({},t),{},{crossOrigin:o})),i&&Fm(i,t),r&&Fm([r],t),aw(c,t)]).then((h=>{let[u,d=[],[f]=[],A={}]=h;return new this(u,xt(xt({},c),{},{src:s,filters:d,resizeFilter:f},A))}))}static fromURL(e){let{crossOrigin:t=null,signal:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return Oy(e,{crossOrigin:t,signal:i}).then((s=>new this(s,r)))}static async fromElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;const r=PA(e,this.ATTRIBUTE_NAMES,i);return this.fromURL(r["xlink:href"]||r.href,t,r).catch((s=>(SA("log","Unable to parse Image",s),null)))}}function ST(n){if(!XEe.test(n.nodeName))return{};const e=n.getAttribute("viewBox");let t,i,r=1,s=1,o=0,a=0;const c=n.getAttribute("width"),h=n.getAttribute("height"),u=n.getAttribute("x")||0,d=n.getAttribute("y")||0,f=!(e&&c7.test(e)),A=!c||!h||c==="100%"||h==="100%";let g="",p=0,y=0;if(f&&(u||d)&&n.parentNode&&n.parentNode.nodeName!=="#document"&&(g=" translate("+dc(u||"0")+" "+dc(d||"0")+") ",t=(n.getAttribute("transform")||"")+g,n.setAttribute("transform",t),n.removeAttribute("x"),n.removeAttribute("y")),f&&A)return{width:0,height:0};const v={width:0,height:0};if(f)return v.width=dc(c),v.height=dc(h),v;const m=e.match(c7);o=-parseFloat(m[1]),a=-parseFloat(m[2]);const w=parseFloat(m[3]),x=parseFloat(m[4]);v.minX=o,v.minY=a,v.viewBoxWidth=w,v.viewBoxHeight=x,A?(v.width=w,v.height=x):(v.width=dc(c),v.height=dc(h),r=v.width/w,s=v.height/x);const T=_F(n.getAttribute("preserveAspectRatio")||"");if(T.alignX!==mc&&(T.meetOrSlice==="meet"&&(s=r=r>s?s:r),T.meetOrSlice==="slice"&&(s=r=r>s?r:s),p=v.width-w*r,y=v.height-x*r,T.alignX==="Mid"&&(p/=2),T.alignY==="Mid"&&(y/=2),T.alignX==="Min"&&(p=0),T.alignY==="Min"&&(y=0)),r===1&&s===1&&o===0&&a===0&&u===0&&d===0)return v;if((u||d)&&n.parentNode.nodeName!=="#document"&&(g=" translate("+dc(u||"0")+" "+dc(d||"0")+") "),t=g+" matrix("+r+" 0 0 "+s+" "+(o*r+p)+" "+(a*s+y)+") ",n.nodeName==="svg"){for(i=n.ownerDocument.createElementNS(f6,"g");n.firstChild;)i.appendChild(n.firstChild);n.appendChild(i)}else i=n,i.removeAttribute("x"),i.removeAttribute("y"),t=i.getAttribute("transform")+t;return i.setAttribute("transform",t),v}bt(ih,"type","Image"),bt(ih,"cacheProperties",[...jA,...OX]),bt(ih,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),bt(ih,"CSS_CANVAS","canvas-img"),bt(ih,"ATTRIBUTE_NAMES",[...rp,"x","y","width","height","preserveAspectRatio","xlink:href","href","crossOrigin","image-rendering"]),bi.setClass(ih),bi.setSVGClass(ih);const FC=n=>n.tagName.replace("svg:",""),$ke=eS(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);function UX(n,e){let t,i,r,s,o=[];for(r=0,s=e.length;r<s;r++)t=e[r],i=n.getElementsByTagNameNS("http://www.w3.org/2000/svg",t),o=o.concat(Array.from(i));return o}const Vke=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],TT="xlink:href";function HX(n,e){var t;const i=((t=e.getAttribute(TT))===null||t===void 0?void 0:t.slice(1))||"",r=n.getElementById(i);if(r&&r.getAttribute(TT)&&HX(n,r),r&&(Vke.forEach((s=>{const o=r.getAttribute(s);!e.hasAttribute(s)&&o&&e.setAttribute(s,o)})),!e.children.length)){const s=r.cloneNode(!0);for(;s.firstChild;)e.appendChild(s.firstChild)}e.removeAttribute(TT)}const zke=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"];function Gke(n){const e=n.getElementsByTagName("style"),t={};for(let i=0;i<e.length;i++){const r=(e[i].textContent||"").replace(/\/\*[\s\S]*?\*\//g,"");r.trim()!==""&&r.split("}").filter(((s,o,a)=>a.length>1&&s.trim())).forEach((s=>{if((s.match(/{/g)||[]).length>1&&s.trim().startsWith("@"))return;const o=s.split("{"),a={},c=o[1].trim().split(";").filter((function(h){return h.trim()}));for(let h=0;h<c.length;h++){const u=c[h].split(":"),d=u[0].trim(),f=u[1].trim();a[d]=f}(s=o[0].trim()).split(",").forEach((h=>{(h=h.replace(/^svg/i,"").trim())!==""&&(t[h]=xt(xt({},t[h]||{}),a))}))}))}return t}const P7=n=>bi.getSVGClass(FC(n).toLowerCase());class Xke{constructor(e,t,i,r,s){this.elements=e,this.options=t,this.reviver=i,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=r,this.clipPaths=s,this.gradientDefs=(function(o){const a=UX(o,zke),c={};let h=a.length;for(;h--;){const u=a[h];u.getAttribute("xlink:href")&&HX(o,u);const d=u.getAttribute("id");d&&(c[d]=u)}return c})(r),this.cssRules=Gke(r)}parse(){return Promise.all(this.elements.map((e=>this.createObject(e))))}async createObject(e){const t=P7(e);if(t){const i=await t.fromElement(e,this.options,this.cssRules);return this.resolveGradient(i,e,Sa),this.resolveGradient(i,e,yc),i instanceof ih&&i._originalElement?o_(i,i.parsePreserveAspectRatioAttribute()):o_(i),await this.resolveClipPath(i,e),this.reviver&&this.reviver(e,i),i}return null}extractPropertyDefinition(e,t,i){const r=e[t],s=this.regexUrl;if(!s.test(r))return;s.lastIndex=0;const o=s.exec(r)[1];return s.lastIndex=0,i[o]}resolveGradient(e,t,i){const r=this.extractPropertyDefinition(e,i,this.gradientDefs);if(r){const s=t.getAttribute(i+"-opacity"),o=ry.fromElement(r,e,xt(xt({},this.options),{},{opacity:s}));e.set(i,o)}}async resolveClipPath(e,t,i){const r=this.extractPropertyDefinition(e,"clipPath",this.clipPaths);if(r){const s=Oc(e.calcTransformMatrix()),o=r[0].parentElement;let a=t;for(;!i&&a.parentElement&&a.getAttribute("clip-path")!==e.clipPath;)a=a.parentElement;a.parentElement.appendChild(o);const c=TC("".concat(a.getAttribute("transform")||""," ").concat(o.getAttribute("originalTransform")||""));o.setAttribute("transform","matrix(".concat(c.join(","),")"));const h=await Promise.all(r.map((m=>P7(m).fromElement(m,this.options,this.cssRules).then((w=>(o_(w),w.fillRule=w.clipRule,delete w.clipRule,w)))))),u=h.length===1?h[0]:new hh(h),d=Aa(s,u.calcTransformMatrix());u.clipPath&&await this.resolveClipPath(u,a,o.getAttribute("clip-path")?a:void 0);const{scaleX:f,scaleY:A,angle:g,skewX:p,translateX:y,translateY:v}=mg(d);u.set({flipX:!1,flipY:!1}),u.set({scaleX:f,scaleY:A,angle:g,skewX:p,skewY:0}),u.setPositionByOrigin(new Gt(y,v),Br,Br),e.clipPath=u}else delete e.clipPath}}const N7=n=>GEe.test(FC(n)),L7=()=>({objects:[],elements:[],options:{},allElements:[]});async function Kke(n,e){let{crossOrigin:t,signal:i}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(i&&i.aborted)return SA("log",new hF("parseSVGDocument")),L7();const r=n.documentElement;(function(u){const d=UX(u,["use","svg:use"]),f=["x","y","xlink:href","href","transform"];for(const A of d){const g=A.attributes,p={};for(const _ of g)_.value&&(p[_.name]=_.value);const y=(p["xlink:href"]||p.href||"").slice(1);if(y==="")return;const v=u.getElementById(y);if(v===null)return;let m=v.cloneNode(!0);const w=m.attributes,x={};for(const _ of w)_.value&&(x[_.name]=_.value);const{x:T=0,y:j=0,transform:D=""}=p,b="".concat(D," ").concat(x.transform||""," translate(").concat(T,", ").concat(j,")");if(ST(m),/^svg$/i.test(m.nodeName)){const _=m.ownerDocument.createElementNS(f6,"g");Object.entries(x).forEach((I=>{let[S,F]=I;return _.setAttributeNS(f6,S,F)})),_.append(...m.childNodes),m=_}for(const _ of g){if(!_)continue;const{name:I,value:S}=_;if(!f.includes(I))if(I==="style"){const F={};m6(S,F),Object.entries(x).forEach((E=>{let[V,K]=E;F[V]=K})),m6(x.style||"",F);const B=Object.entries(F).map((E=>E.join(":"))).join(";");m.setAttribute(I,B)}else!x[I]&&m.setAttribute(I,S)}m.setAttribute("transform",b),m.setAttribute("instantiated_by_use","1"),m.removeAttribute("id"),A.parentNode.replaceChild(m,A)}})(n);const s=Array.from(r.getElementsByTagName("*")),o=xt(xt({},ST(r)),{},{crossOrigin:t,signal:i}),a=s.filter((u=>(ST(u),N7(u)&&!(function(d){let f=d;for(;f&&(f=f.parentElement);)if(f&&f.nodeName&&$ke.test(FC(f))&&!f.getAttribute("instantiated_by_use"))return!0;return!1})(u))));if(!a||a&&!a.length)return xt(xt({},L7()),{},{options:o,allElements:s});const c={};return s.filter((u=>FC(u)==="clipPath")).forEach((u=>{u.setAttribute("originalTransform",u.getAttribute("transform")||"");const d=u.getAttribute("id");c[d]=Array.from(u.getElementsByTagName("*")).filter((f=>N7(f)))})),{objects:await new Xke(a,o,e,n,c).parse(),elements:a,options:o,allElements:s}}function qke(n,e,t){return Kke(new(Jm()).DOMParser().parseFromString(n.trim(),"text/xml"),e,t)}const aS=n=>n.webgl!==void 0,jF="precision highp float",Yke=`
    `.concat(jF,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),Zke=["type"],Jke=["type"],eIe=new RegExp(jF,"g");class Wa{get type(){return this.constructor.type}constructor(){let e=Bo(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Zke);Object.assign(this,this.constructor.defaults,e)}getFragmentSource(){return Yke}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:r="highp"}}=_d();r!=="highp"&&(t=t.replace(eIe,jF.replace("highp",r)));const s=e.createShader(e.VERTEX_SHADER),o=e.createShader(e.FRAGMENT_SHADER),a=e.createProgram();if(!s||!o||!a)throw new cd("Vertex, fragment shader or program creation error");if(e.shaderSource(s,i),e.compileShader(s),!e.getShaderParameter(s,e.COMPILE_STATUS))throw new cd("Vertex shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(s)));if(e.shaderSource(o,t),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS))throw new cd("Fragment shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(o)));if(e.attachShader(a,s),e.attachShader(a,o),e.linkProgram(a),!e.getProgramParameter(a,e.LINK_STATUS))throw new cd('Shader link error for "'.concat(this.type,'" ').concat(e.getProgramInfoLog(a)));const c=this.getUniformLocations(e,a)||{};return c.uStepW=e.getUniformLocation(a,"uStepW"),c.uStepH=e.getUniformLocation(a,"uStepH"),{program:a,attributeLocations:this.getAttributeLocations(e,a),uniformLocations:c}}getAttributeLocations(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}}getUniformLocations(e,t){const i=this.constructor.uniformLocations,r={};for(let s=0;s<i.length;s++)r[i[s]]=e.getUniformLocation(t,i[s]);return r}sendAttributeData(e,t,i){const r=t.aPosition,s=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,s),e.enableVertexAttribArray(r),e.vertexAttribPointer(r,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,i,e.STATIC_DRAW)}_setupFrameBuffer(e){const t=e.context;if(e.passes>1){const i=e.destinationWidth,r=e.destinationHeight;e.sourceWidth===i&&e.sourceHeight===r||(t.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(t,i,r)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.targetTexture,0)}else t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish()}_swapTextures(e){e.passes--,e.pass++;const t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t}isNeutralState(e){return!1}applyTo(e){aS(e)?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){}getCacheKey(){return this.type}retrieveShader(e){const t=this.getCacheKey();return e.programCache[t]||(e.programCache[t]=this.createProgram(e.context)),e.programCache[t]}applyToWebGL(e){const t=e.context,i=this.retrieveShader(e);e.pass===0&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(i.program),this.sendAttributeData(t,i.attributeLocations,e.aPosition),t.uniform1f(i.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(i.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,i.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(e,t,i){e.activeTexture(i),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)}unbindAdditionalTexture(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}sendUniformData(e,t){}createHelpLayer(e){if(!e.helpLayer){const{sourceWidth:t,sourceHeight:i}=e,r=fh({width:t,height:i});e.helpLayer=r}}toObject(){const e=Object.keys(this.constructor.defaults||{});return xt({type:this.type},e.reduce(((t,i)=>(t[i]=this[i],t)),{}))}toJSON(){return this.toObject()}static async fromObject(e,t){return new this(Bo(e,Jke))}}bt(Wa,"type","BaseFilter"),bt(Wa,"uniformLocations",[]);const tIe={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `};class hb extends Wa{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(tIe[this.mode],`
        }
      }
      `)}applyTo2d(e){let{imageData:{data:t}}=e;const i=new Fs(this.color).getSource(),r=this.alpha,s=i[0]*r,o=i[1]*r,a=i[2]*r,c=1-r;for(let h=0;h<t.length;h+=4){const u=t[h],d=t[h+1],f=t[h+2];let A,g,p;switch(this.mode){case"multiply":A=u*s/255,g=d*o/255,p=f*a/255;break;case"screen":A=255-(255-u)*(255-s)/255,g=255-(255-d)*(255-o)/255,p=255-(255-f)*(255-a)/255;break;case"add":A=u+s,g=d+o,p=f+a;break;case"difference":A=Math.abs(u-s),g=Math.abs(d-o),p=Math.abs(f-a);break;case"subtract":A=u-s,g=d-o,p=f-a;break;case"darken":A=Math.min(u,s),g=Math.min(d,o),p=Math.min(f,a);break;case"lighten":A=Math.max(u,s),g=Math.max(d,o),p=Math.max(f,a);break;case"overlay":A=s<128?2*u*s/255:255-2*(255-u)*(255-s)/255,g=o<128?2*d*o/255:255-2*(255-d)*(255-o)/255,p=a<128?2*f*a/255:255-2*(255-f)*(255-a)/255;break;case"exclusion":A=s+u-2*s*u/255,g=o+d-2*o*d/255,p=a+f-2*a*f/255;break;case"tint":A=s+u*c,g=o+d*c,p=a+f*c}t[h]=A,t[h+1]=g,t[h+2]=p}}sendUniformData(e,t){const i=new Fs(this.color).getSource();i[0]=this.alpha*i[0]/255,i[1]=this.alpha*i[1]/255,i[2]=this.alpha*i[2]/255,i[3]=this.alpha,e.uniform4fv(t.uColor,i)}}bt(hb,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),bt(hb,"type","BlendColor"),bt(hb,"uniformLocations",["uColor"]),bi.setClass(hb);const nIe={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},iIe=["type","image"];class ub extends Wa{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return nIe[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(e){const t=e.context,i=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(t,i,t.TEXTURE1),super.applyToWebGL(e),this.unbindAdditionalTexture(t,t.TEXTURE1)}createTexture(e,t){return e.getCachedTexture(t.cacheKey,t.getElement())}calculateMatrix(){const e=this.image,{width:t,height:i}=e.getElement();return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/t,-e.top/i,1]}applyTo2d(e){let{imageData:{data:t,width:i,height:r},filterBackend:{resources:s}}=e;const o=this.image;s.blendImage||(s.blendImage=Cd());const a=s.blendImage,c=a.getContext("2d");a.width!==i||a.height!==r?(a.width=i,a.height=r):c.clearRect(0,0,i,r),c.setTransform(o.scaleX,0,0,o.scaleY,o.left,o.top),c.drawImage(o.getElement(),0,0,i,r);const h=c.getImageData(0,0,i,r).data;for(let u=0;u<t.length;u+=4){const d=t[u],f=t[u+1],A=t[u+2],g=t[u+3],p=h[u],y=h[u+1],v=h[u+2],m=h[u+3];switch(this.mode){case"multiply":t[u]=d*p/255,t[u+1]=f*y/255,t[u+2]=A*v/255,t[u+3]=g*m/255;break;case"mask":t[u+3]=m}}}sendUniformData(e,t){const i=this.calculateMatrix();e.uniform1i(t.uImage,1),e.uniformMatrix3fv(t.uTransformMatrix,!1,i)}toObject(){return xt(xt({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static async fromObject(e,t){let{type:i,image:r}=e,s=Bo(e,iIe);return ih.fromObject(r,t).then((o=>new this(xt(xt({},s),{},{image:o}))))}}bt(ub,"type","BlendImage"),bt(ub,"defaults",{mode:"multiply",alpha:1}),bt(ub,"uniformLocations",["uTransformMatrix","uImage"]),bi.setClass(ub);class db extends Wa{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float totalC = 0.0;
      float totalA = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        vec4 sample = texture2D(uTexture, vTexCoord + uDelta * percent);
        float weight = 1.0 - abs(percent);
        float alpha = weight * sample.a;
        color.rgb += sample.rgb * alpha;
        color.a += alpha;
        totalA += weight;
        totalC += alpha;
      }
      gl_FragColor.rgb = color.rgb / totalC;
      gl_FragColor.a = color.a / totalA;
    }
  `}applyTo(e){aS(e)?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){let{imageData:{data:t,width:i,height:r}}=e;this.aspectRatio=i/r,this.horizontal=!0;let s=this.getBlurValue()*i;const o=new Uint8ClampedArray(t),a=15,c=4*i;for(let h=0;h<t.length;h+=4){let u=0,d=0,f=0,A=0,g=0;const p=h-h%c,y=p+c;for(let v=-14;v<a;v++){const m=v/a,w=4*Math.floor(s*m),x=1-Math.abs(m);let T=h+w;T<p?T=p:T>y&&(T=y);const j=t[T+3]*x;u+=t[T]*j,d+=t[T+1]*j,f+=t[T+2]*j,A+=j,g+=x}o[h]=u/A,o[h+1]=d/A,o[h+2]=f/A,o[h+3]=A/g}this.horizontal=!1,s=this.getBlurValue()*r;for(let h=0;h<o.length;h+=4){let u=0,d=0,f=0,A=0,g=0;const p=h%c,y=o.length-c+p;for(let v=-14;v<a;v++){const m=v/a,w=Math.floor(s*m)*c,x=1-Math.abs(m);let T=h+w;T<p?T=p:T>y&&(T=y);const j=o[T+3]*x;u+=o[T]*j,d+=o[T+1]*j,f+=o[T+2]*j,A+=j,g+=x}t[h]=u/A,t[h+1]=d/A,t[h+2]=f/A,t[h+3]=A/g}}sendUniformData(e,t){const i=this.chooseRightDelta();e.uniform2fv(t.uDelta,i)}isNeutralState(){return this.blur===0}getBlurValue(){let e=1;const{horizontal:t,aspectRatio:i}=this;return t?i>1&&(e=1/i):i<1&&(e=i),e*this.blur*.12}chooseRightDelta(){const e=this.getBlurValue();return this.horizontal?[e,0]:[0,e]}}bt(db,"type","Blur"),bt(db,"defaults",{blur:0}),bt(db,"uniformLocations",["uDelta"]),bi.setClass(db);class Ab extends Wa{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const i=Math.round(255*this.brightness);for(let r=0;r<t.length;r+=4)t[r]+=i,t[r+1]+=i,t[r+2]+=i}isNeutralState(){return this.brightness===0}sendUniformData(e,t){e.uniform1f(t.uBrightness,this.brightness)}}bt(Ab,"type","Brightness"),bt(Ab,"defaults",{brightness:0}),bt(Ab,"uniformLocations",["uBrightness"]),bi.setClass(Ab);const WX={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0};class V0 extends Wa{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(e){const t=e.imageData.data,i=this.matrix,r=this.colorsOnly;for(let s=0;s<t.length;s+=4){const o=t[s],a=t[s+1],c=t[s+2];if(t[s]=o*i[0]+a*i[1]+c*i[2]+255*i[4],t[s+1]=o*i[5]+a*i[6]+c*i[7]+255*i[9],t[s+2]=o*i[10]+a*i[11]+c*i[12]+255*i[14],!r){const h=t[s+3];t[s]+=h*i[3],t[s+1]+=h*i[8],t[s+2]+=h*i[13],t[s+3]=o*i[15]+a*i[16]+c*i[17]+h*i[18]+255*i[19]}}}sendUniformData(e,t){const i=this.matrix,r=[i[0],i[1],i[2],i[3],i[5],i[6],i[7],i[8],i[10],i[11],i[12],i[13],i[15],i[16],i[17],i[18]],s=[i[4],i[9],i[14],i[19]];e.uniformMatrix4fv(t.uColorMatrix,!1,r),e.uniform4fv(t.uConstants,s)}toObject(){return xt(xt({},super.toObject()),{},{matrix:[...this.matrix]})}}function Ng(n,e){var t;const i=(bt(t=class extends V0{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",n),bt(t,"defaults",{colorsOnly:!1,matrix:e}),t);return bi.setClass(i,n),i}bt(V0,"type","ColorMatrix"),bt(V0,"defaults",WX),bt(V0,"uniformLocations",["uColorMatrix","uConstants"]),bi.setClass(V0);Ng("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]);Ng("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]);Ng("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]);Ng("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]);Ng("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]);Ng("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]);Ng("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);class M7 extends Wa{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.subFilters=e.subFilters||[]}applyTo(e){aS(e)&&(e.passes+=this.subFilters.length-1),this.subFilters.forEach((t=>{t.applyTo(e)}))}toObject(){return{type:this.type,subFilters:this.subFilters.map((e=>e.toObject()))}}isNeutralState(){return!this.subFilters.some((e=>!e.isNeutralState()))}static fromObject(e,t){return Promise.all((e.subFilters||[]).map((i=>bi.getClass(i.type).fromObject(i,t)))).then((i=>new this({subFilters:i})))}}bt(M7,"type","Composed"),bi.setClass(M7);class fb extends Wa{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(e){let{imageData:{data:t}}=e;const i=Math.floor(255*this.contrast),r=259*(i+255)/(255*(259-i));for(let s=0;s<t.length;s+=4)t[s]=r*(t[s]-128)+128,t[s+1]=r*(t[s+1]-128)+128,t[s+2]=r*(t[s+2]-128)+128}sendUniformData(e,t){e.uniform1f(t.uContrast,this.contrast)}}bt(fb,"type","Contrast"),bt(fb,"defaults",{contrast:0}),bt(fb,"uniformLocations",["uContrast"]),bi.setClass(fb);const rIe={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `};class pb extends Wa{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return rIe[this.getCacheKey()]}applyTo2d(e){const t=e.imageData,i=t.data,r=this.matrix,s=Math.round(Math.sqrt(r.length)),o=Math.floor(s/2),a=t.width,c=t.height,h=e.ctx.createImageData(a,c),u=h.data,d=this.opaque?1:0;let f,A,g,p,y,v,m,w,x,T,j,D,b;for(j=0;j<c;j++)for(T=0;T<a;T++){for(y=4*(j*a+T),f=0,A=0,g=0,p=0,b=0;b<s;b++)for(D=0;D<s;D++)m=j+b-o,v=T+D-o,m<0||m>=c||v<0||v>=a||(w=4*(m*a+v),x=r[b*s+D],f+=i[w]*x,A+=i[w+1]*x,g+=i[w+2]*x,d||(p+=i[w+3]*x));u[y]=f,u[y+1]=A,u[y+2]=g,u[y+3]=d?i[y+3]:p}e.imageData=h}sendUniformData(e,t){e.uniform1fv(t.uMatrix,this.matrix)}toObject(){return xt(xt({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}}bt(pb,"type","Convolute"),bt(pb,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),bt(pb,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),bi.setClass(pb);const QX="Gamma";class gb extends Wa{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.gamma=e.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(e){let{imageData:{data:t}}=e;const i=this.gamma,r=1/i[0],s=1/i[1],o=1/i[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const a=this.rgbValues;for(let c=0;c<256;c++)a.r[c]=255*Math.pow(c/255,r),a.g[c]=255*Math.pow(c/255,s),a.b[c]=255*Math.pow(c/255,o);for(let c=0;c<t.length;c+=4)t[c]=a.r[t[c]],t[c+1]=a.g[t[c+1]],t[c+2]=a.b[t[c+2]]}sendUniformData(e,t){e.uniform3fv(t.uGamma,this.gamma)}isNeutralState(){const{gamma:e}=this;return e[0]===1&&e[1]===1&&e[2]===1}toObject(){return{type:QX,gamma:this.gamma.concat()}}}bt(gb,"type",QX),bt(gb,"defaults",{gamma:[1,1,1]}),bt(gb,"uniformLocations",["uGamma"]),bi.setClass(gb);const sIe={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `};class mb extends Wa{applyTo2d(e){let{imageData:{data:t}}=e;for(let i,r=0;r<t.length;r+=4){const s=t[r],o=t[r+1],a=t[r+2];switch(this.mode){case"average":i=(s+o+a)/3;break;case"lightness":i=(Math.min(s,o,a)+Math.max(s,o,a))/2;break;case"luminosity":i=.21*s+.72*o+.07*a}t[r+2]=t[r+1]=t[r]=i}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return sIe[this.mode]}sendUniformData(e,t){e.uniform1i(t.uMode,1)}isNeutralState(){return!1}}bt(mb,"type","Grayscale"),bt(mb,"defaults",{mode:"average"}),bt(mb,"uniformLocations",["uMode"]),bi.setClass(mb);const oIe=xt(xt({},WX),{},{rotation:0});class BT extends V0{calculateMatrix(){const e=this.rotation*Math.PI,t=ju(e),i=Pu(e),r=1/3,s=Math.sqrt(r)*i,o=1-t;this.matrix=[t+o/3,r*o-s,r*o+s,0,0,r*o+s,t+r*o,r*o-s,0,0,r*o-s,r*o+s,t+r*o,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(e){this.calculateMatrix(),super.applyTo(e)}toObject(){return{type:this.type,rotation:this.rotation}}}bt(BT,"type","HueRotation"),bt(BT,"defaults",oIe),bi.setClass(BT);class yb extends Wa{applyTo2d(e){let{imageData:{data:t}}=e;for(let i=0;i<t.length;i+=4)t[i]=255-t[i],t[i+1]=255-t[i+1],t[i+2]=255-t[i+2],this.alpha&&(t[i+3]=255-t[i+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(e,t){e.uniform1i(t.uInvert,Number(this.invert)),e.uniform1i(t.uAlpha,Number(this.alpha))}}bt(yb,"type","Invert"),bt(yb,"defaults",{alpha:!1,invert:!0}),bt(yb,"uniformLocations",["uInvert","uAlpha"]),bi.setClass(yb);class vb extends Wa{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const i=this.noise;for(let r=0;r<t.length;r+=4){const s=(.5-Math.random())*i;t[r]+=s,t[r+1]+=s,t[r+2]+=s}}sendUniformData(e,t){e.uniform1f(t.uNoise,this.noise/255),e.uniform1f(t.uSeed,Math.random())}isNeutralState(){return this.noise===0}}bt(vb,"type","Noise"),bt(vb,"defaults",{noise:0}),bt(vb,"uniformLocations",["uNoise","uSeed"]),bi.setClass(vb);let wb=class extends Wa{applyTo2d(e){let{imageData:{data:t,width:i,height:r}}=e;for(let s=0;s<r;s+=this.blocksize)for(let o=0;o<i;o+=this.blocksize){const a=4*s*i+4*o,c=t[a],h=t[a+1],u=t[a+2],d=t[a+3];for(let f=s;f<Math.min(s+this.blocksize,r);f++)for(let A=o;A<Math.min(o+this.blocksize,i);A++){const g=4*f*i+4*A;t[g]=c,t[g+1]=h,t[g+2]=u,t[g+3]=d}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(e,t){e.uniform1f(t.uBlocksize,this.blocksize)}};bt(wb,"type","Pixelate"),bt(wb,"defaults",{blocksize:4}),bt(wb,"uniformLocations",["uBlocksize"]),bi.setClass(wb);class xb extends Wa{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(e){let{imageData:{data:t}}=e;const i=255*this.distance,r=new Fs(this.color).getSource(),s=[r[0]-i,r[1]-i,r[2]-i],o=[r[0]+i,r[1]+i,r[2]+i];for(let a=0;a<t.length;a+=4){const c=t[a],h=t[a+1],u=t[a+2];c>s[0]&&h>s[1]&&u>s[2]&&c<o[0]&&h<o[1]&&u<o[2]&&(t[a+3]=0)}}sendUniformData(e,t){const i=new Fs(this.color).getSource(),r=this.distance,s=[0+i[0]/255-r,0+i[1]/255-r,0+i[2]/255-r,1],o=[i[0]/255+r,i[1]/255+r,i[2]/255+r,1];e.uniform4fv(t.uLow,s),e.uniform4fv(t.uHigh,o)}}bt(xb,"type","RemoveColor"),bt(xb,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),bt(xb,"uniformLocations",["uLow","uHigh"]),bi.setClass(xb);class bb extends Wa{sendUniformData(e,t){e.uniform2fv(t.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(t.uTaps,this.taps)}getFilterWindow(){const e=this.tempScale;return Math.ceil(this.lanczosLobes/e)}getCacheKey(){const e=this.getFilterWindow();return"".concat(this.type,"_").concat(e)}getFragmentSource(){const e=this.getFilterWindow();return this.generateShader(e)}getTaps(){const e=this.lanczosCreate(this.lanczosLobes),t=this.tempScale,i=this.getFilterWindow(),r=new Array(i);for(let s=1;s<=i;s++)r[s-1]=e(s*t);return r}generateShader(e){const t=new Array(e);for(let i=1;i<=e;i++)t[i-1]="".concat(i,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(e,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(t.map(((i,r)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(i,") * uTaps[").concat(r,"] + texture2D(uTexture, vTexCoord - ").concat(i,") * uTaps[").concat(r,`];
              sum += 2.0 * uTaps[`).concat(r,`];
            `))).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(e){e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,super.applyTo(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,super.applyTo(e),e.sourceHeight=e.destinationHeight}applyTo(e){aS(e)?this.applyToForWebgl(e):this.applyTo2d(e)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(e){return t=>{if(t>=e||t<=-e)return 0;if(t<11920929e-14&&t>-11920929e-14)return 1;const i=(t*=Math.PI)/e;return Math.sin(t)/t*Math.sin(i)/i}}applyTo2d(e){const t=e.imageData,i=this.scaleX,r=this.scaleY;this.rcpScaleX=1/i,this.rcpScaleY=1/r;const s=t.width,o=t.height,a=Math.round(s*i),c=Math.round(o*r);let h;h=this.resizeType==="sliceHack"?this.sliceByTwo(e,s,o,a,c):this.resizeType==="hermite"?this.hermiteFastResize(e,s,o,a,c):this.resizeType==="bilinear"?this.bilinearFiltering(e,s,o,a,c):this.resizeType==="lanczos"?this.lanczosResize(e,s,o,a,c):new ImageData(a,c),e.imageData=h}sliceByTwo(e,t,i,r,s){const o=e.imageData,a=.5;let c=!1,h=!1,u=t*a,d=i*a;const f=e.filterBackend.resources;let A=0,g=0;const p=t;let y=0;f.sliceByTwo||(f.sliceByTwo=Cd());const v=f.sliceByTwo;(v.width<1.5*t||v.height<i)&&(v.width=1.5*t,v.height=i);const m=v.getContext("2d");for(m.clearRect(0,0,1.5*t,i),m.putImageData(o,0,0),r=Math.floor(r),s=Math.floor(s);!c||!h;)t=u,i=d,r<Math.floor(u*a)?u=Math.floor(u*a):(u=r,c=!0),s<Math.floor(d*a)?d=Math.floor(d*a):(d=s,h=!0),m.drawImage(v,A,g,t,i,p,y,u,d),A=p,g=y,y+=d;return m.getImageData(A,g,r,s)}lanczosResize(e,t,i,r,s){const o=e.imageData.data,a=e.ctx.createImageData(r,s),c=a.data,h=this.lanczosCreate(this.lanczosLobes),u=this.rcpScaleX,d=this.rcpScaleY,f=2/this.rcpScaleX,A=2/this.rcpScaleY,g=Math.ceil(u*this.lanczosLobes/2),p=Math.ceil(d*this.lanczosLobes/2),y={},v={x:0,y:0},m={x:0,y:0};return(function w(x){let T,j,D,b,_,I,S,F,B,E,V;for(v.x=(x+.5)*u,m.x=Math.floor(v.x),T=0;T<s;T++){for(v.y=(T+.5)*d,m.y=Math.floor(v.y),_=0,I=0,S=0,F=0,B=0,j=m.x-g;j<=m.x+g;j++)if(!(j<0||j>=t)){E=Math.floor(1e3*Math.abs(j-v.x)),y[E]||(y[E]={});for(let K=m.y-p;K<=m.y+p;K++)K<0||K>=i||(V=Math.floor(1e3*Math.abs(K-v.y)),y[E][V]||(y[E][V]=h(Math.sqrt(Math.pow(E*f,2)+Math.pow(V*A,2))/1e3)),D=y[E][V],D>0&&(b=4*(K*t+j),_+=D,I+=D*o[b],S+=D*o[b+1],F+=D*o[b+2],B+=D*o[b+3]))}b=4*(T*r+x),c[b]=I/_,c[b+1]=S/_,c[b+2]=F/_,c[b+3]=B/_}return++x<r?w(x):a})(0)}bilinearFiltering(e,t,i,r,s){let o,a,c,h,u,d,f,A,g,p,y,v,m,w=0;const x=this.rcpScaleX,T=this.rcpScaleY,j=4*(t-1),D=e.imageData.data,b=e.ctx.createImageData(r,s),_=b.data;for(f=0;f<s;f++)for(A=0;A<r;A++)for(u=Math.floor(x*A),d=Math.floor(T*f),g=x*A-u,p=T*f-d,m=4*(d*t+u),y=0;y<4;y++)o=D[m+y],a=D[m+4+y],c=D[m+j+y],h=D[m+j+4+y],v=o*(1-g)*(1-p)+a*g*(1-p)+c*p*(1-g)+h*g*p,_[w++]=v;return b}hermiteFastResize(e,t,i,r,s){const o=this.rcpScaleX,a=this.rcpScaleY,c=Math.ceil(o/2),h=Math.ceil(a/2),u=e.imageData.data,d=e.ctx.createImageData(r,s),f=d.data;for(let A=0;A<s;A++)for(let g=0;g<r;g++){const p=4*(g+A*r);let y=0,v=0,m=0,w=0,x=0,T=0,j=0;const D=(A+.5)*a;for(let b=Math.floor(A*a);b<(A+1)*a;b++){const _=Math.abs(D-(b+.5))/h,I=(g+.5)*o,S=_*_;for(let F=Math.floor(g*o);F<(g+1)*o;F++){let B=Math.abs(I-(F+.5))/c;const E=Math.sqrt(S+B*B);E>1&&E<-1||(y=2*E*E*E-3*E*E+1,y>0&&(B=4*(F+b*t),j+=y*u[B+3],m+=y,u[B+3]<255&&(y=y*u[B+3]/250),w+=y*u[B],x+=y*u[B+1],T+=y*u[B+2],v+=y))}}f[p]=w/v,f[p+1]=x/v,f[p+2]=T/v,f[p+3]=j/m}return d}}bt(bb,"type","Resize"),bt(bb,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),bt(bb,"uniformLocations",["uDelta","uTaps"]),bi.setClass(bb);class _b extends Wa{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const i=-this.saturation;for(let r=0;r<t.length;r+=4){const s=t[r],o=t[r+1],a=t[r+2],c=Math.max(s,o,a);t[r]+=c!==s?(c-s)*i:0,t[r+1]+=c!==o?(c-o)*i:0,t[r+2]+=c!==a?(c-a)*i:0}}sendUniformData(e,t){e.uniform1f(t.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}}bt(_b,"type","Saturation"),bt(_b,"defaults",{saturation:0}),bt(_b,"uniformLocations",["uSaturation"]),bi.setClass(_b);class Cb extends Wa{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const i=-this.vibrance;for(let r=0;r<t.length;r+=4){const s=t[r],o=t[r+1],a=t[r+2],c=Math.max(s,o,a),h=(s+o+a)/3,u=2*Math.abs(c-h)/255*i;t[r]+=c!==s?(c-s)*u:0,t[r+1]+=c!==o?(c-o)*u:0,t[r+2]+=c!==a?(c-a)*u:0}}sendUniformData(e,t){e.uniform1f(t.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}}bt(Cb,"type","Vibrance"),bt(Cb,"defaults",{vibrance:0}),bt(Cb,"uniformLocations",["uVibrance"]),bi.setClass(Cb);class aIe{constructor(e){this._pointer=0,this._eof=!1,this._data=e}next(){if(!this.hasNext())throw this._eof?new Error("Cannot call 'next' after EOF group has been read"):new Error("Unexpected end of input: EOF group not read before end of file. Ended on code "+this._data[this._pointer]);const e={code:parseInt(this._data[this._pointer])};return this._pointer++,e.value=R7(e.code,this._data[this._pointer].trim()),this._pointer++,e.code===0&&e.value==="EOF"&&(this._eof=!0),this.lastReadGroup=e,e}peek(){if(!this.hasNext())throw this._eof?new Error("Cannot call 'next' after EOF group has been read"):new Error("Unexpected end of input: EOF group not read before end of file. Ended on code "+this._data[this._pointer]);const e={code:parseInt(this._data[this._pointer])};return e.value=R7(e.code,this._data[this._pointer+1].trim()),e}rewind(e=1){this._pointer=this._pointer-e*2}hasNext(){return!(this._eof||this._pointer>this._data.length-2)}isEOF(){return this._eof}}function R7(n,e){return n<=9?e:n>=10&&n<=59?parseFloat(e):n>=60&&n<=99?parseInt(e):n>=100&&n<=109?e:n>=110&&n<=149?parseFloat(e):n>=160&&n<=179?parseInt(e):n>=210&&n<=239?parseFloat(e):n>=270&&n<=289?parseInt(e):n>=290&&n<=299?lIe(e):n>=300&&n<=369?e:n>=370&&n<=389?parseInt(e):n>=390&&n<=399?e:n>=400&&n<=409?parseInt(e):n>=410&&n<=419?e:n>=420&&n<=429?parseInt(e):n>=430&&n<=439?e:n>=440&&n<=459?parseInt(e):n>=460&&n<=469?parseFloat(e):n>=470&&n<=481||n===999||n>=1e3&&n<=1009?e:n>=1010&&n<=1059?parseFloat(e):n>=1060&&n<=1071?parseInt(e):(console.log("WARNING: Group code does not have a defined type: %j",{code:n,value:e}),e)}function lIe(n){if(n==="0")return!1;if(n==="1")return!0;throw TypeError("String '"+n+"' cannot be cast to Boolean type")}const $X=[0,16711680,16776960,65280,65535,255,16711935,16777215,8421504,12632256,16711680,16744319,13369344,13395558,10027008,10046540,8323072,8339263,4980736,4990502,16727808,16752511,13382400,13401958,10036736,10051404,8331008,8343359,4985600,4992806,16744192,16760703,13395456,13408614,10046464,10056268,8339200,8347455,4990464,4995366,16760576,16768895,13408512,13415014,10056192,10061132,8347392,8351551,4995328,4997670,16776960,16777087,13421568,13421670,10000384,10000460,8355584,8355647,5000192,5000230,12582656,14679935,10079232,11717734,7510016,8755276,6258432,7307071,3755008,4344870,8388352,12582783,6736896,10079334,5019648,7510092,4161280,6258495,2509824,3755046,4194048,10485631,3394560,8375398,2529280,6264908,2064128,5209919,1264640,3099686,65280,8388479,52224,6736998,38912,5019724,32512,4161343,19456,2509862,65343,8388511,52275,6737023,38950,5019743,32543,4161359,19475,2509871,65407,8388543,52326,6737049,38988,5019762,32575,4161375,19494,2509881,65471,8388575,52377,6737074,39026,5019781,32607,4161391,19513,2509890,65535,8388607,52428,6737100,39064,5019800,32639,4161407,19532,2509900,49151,8380415,39372,6730444,29336,5014936,24447,4157311,14668,2507340,32767,8372223,26316,6724044,19608,5010072,16255,4153215,9804,2505036,16383,8364031,13260,6717388,9880,5005208,8063,4149119,4940,2502476,255,8355839,204,6710988,152,5000344,127,4145023,76,2500172,4129023,10452991,3342540,8349388,2490520,6245528,2031743,5193599,1245260,3089996,8323327,12550143,6684876,10053324,4980888,7490712,4128895,6242175,2490444,3745356,12517631,14647295,10027212,11691724,7471256,8735896,6226047,7290751,3735628,4335180,16711935,16744447,13369548,13395660,9961624,9981080,8323199,8339327,4980812,4990540,16711871,16744415,13369497,13395634,9961586,9981061,8323167,8339311,4980793,4990530,16711807,16744383,13369446,13395609,9961548,9981042,8323135,8339295,4980774,4990521,16711743,16744351,13369395,13395583,9961510,9981023,8323103,8339279,4980755,4990511,3355443,5987163,8684676,11382189,14079702,16777215];function cIe(n){return $X[n]}function ns(n){const e={};n.rewind();let t=n.next(),i=t.code;if(e.x=t.value,i+=10,t=n.next(),t.code!=i)throw new Error("Expected code for point value to be "+i+" but got "+t.code+".");return e.y=t.value,i+=10,t=n.next(),t.code!=i?(n.rewind(),e):(e.z=t.value,e)}function Pl(n,e,t){switch(e.code){case 0:n.type=e.value;break;case 5:n.handle=e.value;break;case 6:n.lineType=e.value;break;case 8:n.layer=e.value;break;case 48:n.lineTypeScale=e.value;break;case 60:n.visible=e.value===0;break;case 62:n.colorIndex=e.value,n.color=cIe(Math.abs(e.value));break;case 67:n.inPaperSpace=e.value!==0;break;case 100:break;case 101:for(;e.code!=0;)e=t.next();t.rewind();break;case 330:n.ownerHandle=e.value;break;case 347:n.materialObjectHandle=e.value;break;case 370:n.lineweight=e.value;break;case 420:n.color=e.value;break;case 1e3:n.extendedData=n.extendedData||{},n.extendedData.customStrings=n.extendedData.customStrings||[],n.extendedData.customStrings.push(e.value);break;case 1001:n.extendedData=n.extendedData||{},n.extendedData.applicationName=e.value;break;default:return!1}return!0}class hIe{constructor(){this.ForEntityName="3DFACE"}parseEntity(e,t){const i={type:t.value,vertices:[]};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 70:i.shape=(t.value&1)===1,i.hasContinuousLinetypePattern=(t.value&128)===128;break;case 10:i.vertices=uIe(e,t),t=e.lastReadGroup;break;default:Pl(i,t,e);break}t=e.next()}return i}}function uIe(n,e){var t=[],i=!1,r=!1,s=4;for(let a=0;a<=s;a++){for(var o={};!n.isEOF()&&!(e.code===0||r);){switch(e.code){case 10:case 11:case 12:case 13:if(i){r=!0;continue}o.x=e.value,i=!0;break;case 20:case 21:case 22:case 23:o.y=e.value;break;case 30:case 31:case 32:case 33:o.z=e.value;break;default:return t}e=n.next()}t.push(o),i=!1,r=!1}return n.rewind(),t}let dIe=class{constructor(){this.ForEntityName="ARC"}parseEntity(e,t){const i={type:t.value};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 10:i.center=ns(e);break;case 40:i.radius=t.value;break;case 50:i.startAngle=Math.PI/180*t.value;break;case 51:i.endAngle=Math.PI/180*t.value,i.angleLength=i.endAngle-i.startAngle;break;case 210:i.extrusionDirectionX=t.value;break;case 220:i.extrusionDirectionY=t.value;break;case 230:i.extrusionDirectionZ=t.value;break;default:Pl(i,t,e);break}t=e.next()}return i}};class AIe{constructor(){this.ForEntityName="ATTDEF"}parseEntity(e,t){var i={type:t.value,scale:1,textStyle:"STANDARD"};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 1:i.text=t.value;break;case 2:i.tag=t.value;break;case 3:i.prompt=t.value;break;case 7:i.textStyle=t.value;break;case 10:i.startPoint=ns(e);break;case 11:i.endPoint=ns(e);break;case 39:i.thickness=t.value;break;case 40:i.textHeight=t.value;break;case 41:i.scale=t.value;break;case 50:i.rotation=t.value;break;case 51:i.obliqueAngle=t.value;break;case 70:i.invisible=!!(t.value&1),i.constant=!!(t.value&2),i.verificationRequired=!!(t.value&4),i.preset=!!(t.value&8);break;case 71:i.backwards=!!(t.value&2),i.mirrored=!!(t.value&4);break;case 72:i.horizontalJustification=t.value;break;case 73:i.fieldLength=t.value;break;case 74:i.verticalJustification=t.value;break;case 100:break;case 210:i.extrusionDirectionX=t.value;break;case 220:i.extrusionDirectionY=t.value;break;case 230:i.extrusionDirectionZ=t.value;break;default:Pl(i,t,e);break}t=e.next()}return i}}let fIe=class{constructor(){this.ForEntityName="CIRCLE"}parseEntity(e,t){const i={type:t.value};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 10:i.center=ns(e);break;case 40:i.radius=t.value;break;case 50:i.startAngle=Math.PI/180*t.value;break;case 51:const r=Math.PI/180*t.value;r<i.startAngle?i.angleLength=r+2*Math.PI-i.startAngle:i.angleLength=r-i.startAngle,i.endAngle=r;break;default:Pl(i,t,e);break}t=e.next()}return i}};class pIe{constructor(){this.ForEntityName="DIMENSION"}parseEntity(e,t){const i={type:t.value};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 2:i.block=t.value;break;case 10:i.anchorPoint=ns(e);break;case 11:i.middleOfText=ns(e);break;case 12:i.insertionPoint=ns(e);break;case 13:i.linearOrAngularPoint1=ns(e);break;case 14:i.linearOrAngularPoint2=ns(e);break;case 15:i.diameterOrRadiusPoint=ns(e);break;case 16:i.arcPoint=ns(e);break;case 70:i.dimensionType=t.value;break;case 71:i.attachmentPoint=t.value;break;case 42:i.actualMeasurement=t.value;break;case 1:i.text=t.value;break;case 50:i.angle=t.value;break;default:Pl(i,t,e);break}t=e.next()}return i}}let gIe=class{constructor(){this.ForEntityName="ELLIPSE"}parseEntity(e,t){const i={type:t.value};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 10:i.center=ns(e);break;case 11:i.majorAxisEndPoint=ns(e);break;case 40:i.axisRatio=t.value;break;case 41:i.startAngle=t.value;break;case 42:i.endAngle=t.value;break;case 2:i.name=t.value;break;default:Pl(i,t,e);break}t=e.next()}return i}};class mIe{constructor(){this.ForEntityName="INSERT"}parseEntity(e,t){const i={type:t.value};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 2:i.name=t.value;break;case 41:i.xScale=t.value;break;case 42:i.yScale=t.value;break;case 43:i.zScale=t.value;break;case 10:i.position=ns(e);break;case 50:i.rotation=t.value;break;case 70:i.columnCount=t.value;break;case 71:i.rowCount=t.value;break;case 44:i.columnSpacing=t.value;break;case 45:i.rowSpacing=t.value;break;case 210:i.extrusionDirection=ns(e);break;default:Pl(i,t,e);break}t=e.next()}return i}}let yIe=class{constructor(){this.ForEntityName="LINE"}parseEntity(e,t){const i={type:t.value,vertices:[]};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 10:i.vertices.unshift(ns(e));break;case 11:i.vertices.push(ns(e));break;case 210:i.extrusionDirection=ns(e);break;case 100:break;default:Pl(i,t,e);break}t=e.next()}return i}};class vIe{constructor(){this.ForEntityName="LWPOLYLINE"}parseEntity(e,t){const i={type:t.value,vertices:[]};let r=0;for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 38:i.elevation=t.value;break;case 39:i.depth=t.value;break;case 70:i.shape=(t.value&1)===1,i.hasContinuousLinetypePattern=(t.value&128)===128;break;case 90:r=t.value;break;case 10:i.vertices=wIe(r,e);break;case 43:t.value!==0&&(i.width=t.value);break;case 210:i.extrusionDirectionX=t.value;break;case 220:i.extrusionDirectionY=t.value;break;case 230:i.extrusionDirectionZ=t.value;break;default:Pl(i,t,e);break}t=e.next()}return i}}function wIe(n,e){if(!n||n<=0)throw Error("n must be greater than 0 verticies");const t=[];let i=!1,r=!1,s=e.lastReadGroup;for(let o=0;o<n;o++){const a={};for(;!e.isEOF()&&!(s.code===0||r);){switch(s.code){case 10:if(i){r=!0;continue}a.x=s.value,i=!0;break;case 20:a.y=s.value;break;case 30:a.z=s.value;break;case 40:a.startWidth=s.value;break;case 41:a.endWidth=s.value;break;case 42:s.value!=0&&(a.bulge=s.value);break;default:return e.rewind(),i&&t.push(a),e.rewind(),t}s=e.next()}t.push(a),i=!1,r=!1}return e.rewind(),t}class xIe{constructor(){this.ForEntityName="MTEXT"}parseEntity(e,t){const i={type:t.value};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 3:i.text?i.text+=t.value:i.text=t.value;break;case 1:i.text?i.text+=t.value:i.text=t.value;break;case 10:i.position=ns(e);break;case 11:i.directionVector=ns(e);break;case 40:i.height=t.value;break;case 41:i.width=t.value;break;case 50:i.rotation=t.value;break;case 71:i.attachmentPoint=t.value;break;case 72:i.drawingDirection=t.value;break;default:Pl(i,t,e);break}t=e.next()}return i}}class bIe{constructor(){this.ForEntityName="POINT"}parseEntity(e,t){const r={type:t.value};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 10:r.position=ns(e);break;case 39:r.thickness=t.value;break;case 210:r.extrusionDirection=ns(e);break;case 100:break;default:Pl(r,t,e);break}t=e.next()}return r}}class _Ie{constructor(){this.ForEntityName="VERTEX"}parseEntity(e,t){var i={type:t.value};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 10:i.x=t.value;break;case 20:i.y=t.value;break;case 30:i.z=t.value;break;case 40:break;case 41:break;case 42:t.value!=0&&(i.bulge=t.value);break;case 70:i.curveFittingVertex=(t.value&1)!==0,i.curveFitTangent=(t.value&2)!==0,i.splineVertex=(t.value&8)!==0,i.splineControlPoint=(t.value&16)!==0,i.threeDPolylineVertex=(t.value&32)!==0,i.threeDPolylineMesh=(t.value&64)!==0,i.polyfaceMeshVertex=(t.value&128)!==0;break;case 50:break;case 71:i.faceA=t.value;break;case 72:i.faceB=t.value;break;case 73:i.faceC=t.value;break;case 74:i.faceD=t.value;break;default:Pl(i,t,e);break}t=e.next()}return i}}class CIe{constructor(){this.ForEntityName="POLYLINE"}parseEntity(e,t){var i={type:t.value,vertices:[]};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 10:break;case 20:break;case 30:break;case 39:i.thickness=t.value;break;case 40:break;case 41:break;case 70:i.shape=(t.value&1)!==0,i.includesCurveFitVertices=(t.value&2)!==0,i.includesSplineFitVertices=(t.value&4)!==0,i.is3dPolyline=(t.value&8)!==0,i.is3dPolygonMesh=(t.value&16)!==0,i.is3dPolygonMeshClosed=(t.value&32)!==0,i.isPolyfaceMesh=(t.value&64)!==0,i.hasContinuousLinetypePattern=(t.value&128)!==0;break;case 71:break;case 72:break;case 73:break;case 74:break;case 75:break;case 210:i.extrusionDirection=ns(e);break;default:Pl(i,t,e);break}t=e.next()}return i.vertices=SIe(e,t),i}}function SIe(n,e){const t=new _Ie,i=[];for(;!n.isEOF();)if(e.code===0){if(e.value==="VERTEX")i.push(t.parseEntity(n,e)),e=n.lastReadGroup;else if(e.value==="SEQEND"){TIe(n,e);break}}return i}function TIe(n,e){const t={type:e.value};for(e=n.next();!n.isEOF()&&e.code!=0;)Pl(t,e,n),e=n.next();return t}class BIe{constructor(){this.ForEntityName="SOLID"}parseEntity(e,t){const i={type:t.value,points:[]};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 10:i.points[0]=ns(e);break;case 11:i.points[1]=ns(e);break;case 12:i.points[2]=ns(e);break;case 13:i.points[3]=ns(e);break;case 210:i.extrusionDirection=ns(e);break;default:Pl(i,t,e);break}t=e.next()}return i}}class EIe{constructor(){this.ForEntityName="SPLINE"}parseEntity(e,t){const i={type:t.value};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 10:i.controlPoints||(i.controlPoints=[]),i.controlPoints.push(ns(e));break;case 11:i.fitPoints||(i.fitPoints=[]),i.fitPoints.push(ns(e));break;case 12:i.startTangent=ns(e);break;case 13:i.endTangent=ns(e);break;case 40:i.knotValues||(i.knotValues=[]),i.knotValues.push(t.value);break;case 70:(t.value&1)!=0&&(i.closed=!0),(t.value&2)!=0&&(i.periodic=!0),(t.value&4)!=0&&(i.rational=!0),(t.value&8)!=0&&(i.planar=!0),(t.value&16)!=0&&(i.planar=!0,i.linear=!0);break;case 71:i.degreeOfSplineCurve=t.value;break;case 72:i.numberOfKnots=t.value;break;case 73:i.numberOfControlPoints=t.value;break;case 74:i.numberOfFitPoints=t.value;break;case 210:i.normalVector=ns(e);break;default:Pl(i,t,e);break}t=e.next()}return i}}let kIe=class{constructor(){this.ForEntityName="TEXT"}parseEntity(e,t){const i={type:t.value};for(t=e.next();!e.isEOF()&&t.code!==0;){switch(t.code){case 10:i.startPoint=ns(e);break;case 11:i.endPoint=ns(e);break;case 40:i.textHeight=t.value;break;case 41:i.xScale=t.value;break;case 50:i.rotation=t.value;break;case 1:i.text=t.value;break;case 72:i.halign=t.value;break;case 73:i.valign=t.value;break;default:Pl(i,t,e);break}t=e.next()}return i}};var a_={exports:{}},IIe=a_.exports,O7;function FIe(){return O7||(O7=1,(function(n){(function(e,t){n.exports?n.exports=t():e.log=t()})(IIe,function(){var e=function(){},t="undefined",i=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"],s={},o=null;function a(p,y){var v=p[y];if(typeof v.bind=="function")return v.bind(p);try{return Function.prototype.bind.call(v,p)}catch{return function(){return Function.prototype.apply.apply(v,[p,arguments])}}}function c(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function h(p){return p==="debug"&&(p="log"),typeof console===t?!1:p==="trace"&&i?c:console[p]!==void 0?a(console,p):console.log!==void 0?a(console,"log"):e}function u(){for(var p=this.getLevel(),y=0;y<r.length;y++){var v=r[y];this[v]=y<p?e:this.methodFactory(v,p,this.name)}if(this.log=this.debug,typeof console===t&&p<this.levels.SILENT)return"No console available for logging"}function d(p){return function(){typeof console!==t&&(u.call(this),this[p].apply(this,arguments))}}function f(p,y,v){return h(p)||d.apply(this,arguments)}function A(p,y){var v=this,m,w,x,T="loglevel";typeof p=="string"?T+=":"+p:typeof p=="symbol"&&(T=void 0);function j(S){var F=(r[S]||"silent").toUpperCase();if(!(typeof window===t||!T)){try{window.localStorage[T]=F;return}catch{}try{window.document.cookie=encodeURIComponent(T)+"="+F+";"}catch{}}}function D(){var S;if(!(typeof window===t||!T)){try{S=window.localStorage[T]}catch{}if(typeof S===t)try{var F=window.document.cookie,B=encodeURIComponent(T),E=F.indexOf(B+"=");E!==-1&&(S=/^([^;]+)/.exec(F.slice(E+B.length+1))[1])}catch{}return v.levels[S]===void 0&&(S=void 0),S}}function b(){if(!(typeof window===t||!T)){try{window.localStorage.removeItem(T)}catch{}try{window.document.cookie=encodeURIComponent(T)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function _(S){var F=S;if(typeof F=="string"&&v.levels[F.toUpperCase()]!==void 0&&(F=v.levels[F.toUpperCase()]),typeof F=="number"&&F>=0&&F<=v.levels.SILENT)return F;throw new TypeError("log.setLevel() called with invalid level: "+S)}v.name=p,v.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},v.methodFactory=y||f,v.getLevel=function(){return x??w??m},v.setLevel=function(S,F){return x=_(S),F!==!1&&j(x),u.call(v)},v.setDefaultLevel=function(S){w=_(S),D()||v.setLevel(S,!1)},v.resetLevel=function(){x=null,b(),u.call(v)},v.enableAll=function(S){v.setLevel(v.levels.TRACE,S)},v.disableAll=function(S){v.setLevel(v.levels.SILENT,S)},v.rebuild=function(){if(o!==v&&(m=_(o.getLevel())),u.call(v),o===v)for(var S in s)s[S].rebuild()},m=_(o?o.getLevel():"WARN");var I=D();I!=null&&(x=_(I)),u.call(v)}o=new A,o.getLogger=function(y){if(typeof y!="symbol"&&typeof y!="string"||y==="")throw new TypeError("You must supply a name when creating a logger.");var v=s[y];return v||(v=s[y]=new A(y,o.methodFactory)),v};var g=typeof window!==t?window.log:void 0;return o.noConflict=function(){return typeof window!==t&&window.log===o&&(window.log=g),o},o.getLoggers=function(){return s},o.default=o,o})})(a_)),a_.exports}var DIe=FIe();const ts=Kf(DIe);ts.setLevel("error");function jIe(n){n.registerEntityHandler(hIe),n.registerEntityHandler(dIe),n.registerEntityHandler(AIe),n.registerEntityHandler(fIe),n.registerEntityHandler(pIe),n.registerEntityHandler(gIe),n.registerEntityHandler(mIe),n.registerEntityHandler(yIe),n.registerEntityHandler(vIe),n.registerEntityHandler(xIe),n.registerEntityHandler(bIe),n.registerEntityHandler(CIe),n.registerEntityHandler(BIe),n.registerEntityHandler(EIe),n.registerEntityHandler(kIe)}class PIe{constructor(){this._entityHandlers={},jIe(this)}parse(e){return typeof e=="string"?this._parse(e):(console.error("Cannot read dxf source of type `"+typeof e),null)}registerEntityHandler(e){const t=new e;this._entityHandlers[t.ForEntityName]=t}parseSync(e){return this.parse(e)}parseStream(e){let t="";const i=this;return new Promise((r,s)=>{e.on("data",o=>{t+=o}),e.on("end",()=>{try{r(i._parse(t))}catch(o){s(o)}}),e.on("error",o=>{s(o)})})}_parse(e){const t={};let i=0;const r=e.split(/\r\n|\r|\n/g),s=new aIe(r);if(!s.hasNext())throw Error("Empty file");const o=this;let a;function c(){for(a=s.next();!s.isEOF();)if(a.code===0&&a.value==="SECTION"){if(a=s.next(),a.code!==2){console.error("Unexpected code %s after 0:SECTION",VX(a)),a=s.next();continue}a.value==="HEADER"?(ts.debug("> HEADER"),t.header=h(),ts.debug("<")):a.value==="BLOCKS"?(ts.debug("> BLOCKS"),t.blocks=u(),ts.debug("<")):a.value==="ENTITIES"?(ts.debug("> ENTITIES"),t.entities=w(!1),ts.debug("<")):a.value==="TABLES"?(ts.debug("> TABLES"),t.tables=f(),ts.debug("<")):a.value==="EOF"?ts.debug("EOF"):ts.warn("Skipping section '%s'",a.value)}else a=s.next()}function h(){let j=null,D=null;const b={};for(a=s.next();;){if(qu(a,0,"ENDSEC")){j&&(b[j]=D);break}else a.code===9?(j&&(b[j]=D),j=a.value):a.code===10?D={x:a.value}:a.code===20?D.y=a.value:a.code===30?D.z=a.value:D=a.value;a=s.next()}return a=s.next(),b}function u(){const j={};for(a=s.next();a.value!=="EOF"&&!qu(a,0,"ENDSEC");)if(qu(a,0,"BLOCK")){ts.debug("block {");const D=d();ts.debug("}"),T(D),D.name?j[D.name]=D:ts.error('block with handle "'+D.handle+'" is missing a name.')}else Bp(a),a=s.next();return j}function d(){const j={};for(a=s.next();a.value!=="EOF";){switch(a.code){case 1:j.xrefPath=a.value,a=s.next();break;case 2:j.name=a.value,a=s.next();break;case 3:j.name2=a.value,a=s.next();break;case 5:j.handle=a.value,a=s.next();break;case 8:j.layer=a.value,a=s.next();break;case 10:j.position=x(a),a=s.next();break;case 67:j.paperSpace=!!(a.value&&a.value==1),a=s.next();break;case 70:a.value!=0&&(j.type=a.value),a=s.next();break;case 100:a=s.next();break;case 330:j.ownerHandle=a.value,a=s.next();break;case 0:if(a.value=="ENDBLK")break;j.entities=w(!0);break;default:Bp(a),a=s.next()}if(qu(a,0,"ENDBLK")){a=s.next();break}}return j}function f(){const j={};for(a=s.next();a.value!=="EOF"&&!qu(a,0,"ENDSEC");)qu(a,0,"TABLE")?(a=s.next(),m[a.value]?(ts.debug(a.value+" Table {"),j[m[a.value].tableName]=g(a),ts.debug("}")):ts.debug("Unhandled Table "+a.value)):a=s.next();return a=s.next(),j}const A="ENDTAB";function g(j){const D=m[j.value],b={};let _=0;for(a=s.next();!qu(a,0,A);)switch(a.code){case 5:b.handle=a.value,a=s.next();break;case 330:b.ownerHandle=a.value,a=s.next();break;case 100:a.value==="AcDbSymbolTable"||Bp(a),a=s.next();break;case 70:_=a.value,a=s.next();break;case 0:a.value===D.dxfSymbolName?b[D.tableRecordsProperty]=D.parseTableRecords():(Bp(a),a=s.next());break;default:Bp(a),a=s.next()}const I=b[D.tableRecordsProperty];if(I){let S=(()=>{if(I.constructor===Array)return I.length;if(typeof I=="object")return Object.keys(I).length})();_!==S&&ts.warn("Parsed "+S+" "+D.dxfSymbolName+"'s but expected "+_)}return a=s.next(),b}function p(){const j=[];let D={};for(ts.debug("ViewPort {"),a=s.next();!qu(a,0,A);)switch(a.code){case 2:D.name=a.value,a=s.next();break;case 10:D.lowerLeftCorner=x(a),a=s.next();break;case 11:D.upperRightCorner=x(a),a=s.next();break;case 12:D.center=x(a),a=s.next();break;case 13:D.snapBasePoint=x(a),a=s.next();break;case 14:D.snapSpacing=x(a),a=s.next();break;case 15:D.gridSpacing=x(a),a=s.next();break;case 16:D.viewDirectionFromTarget=x(a),a=s.next();break;case 17:D.viewTarget=x(a),a=s.next();break;case 42:D.lensLength=a.value,a=s.next();break;case 43:D.frontClippingPlane=a.value,a=s.next();break;case 44:D.backClippingPlane=a.value,a=s.next();break;case 45:D.viewHeight=a.value,a=s.next();break;case 50:D.snapRotationAngle=a.value,a=s.next();break;case 51:D.viewTwistAngle=a.value,a=s.next();break;case 79:D.orthographicType=a.value,a=s.next();break;case 110:D.ucsOrigin=x(a),a=s.next();break;case 111:D.ucsXAxis=x(a),a=s.next();break;case 112:D.ucsYAxis=x(a),a=s.next();break;case 110:D.ucsOrigin=x(a),a=s.next();break;case 281:D.renderMode=a.value,a=s.next();break;case 281:D.defaultLightingType=a.value,a=s.next();break;case 292:D.defaultLightingOn=a.value,a=s.next();break;case 330:D.ownerHandle=a.value,a=s.next();break;case 63:case 421:case 431:D.ambientColor=a.value,a=s.next();break;case 0:a.value==="VPORT"&&(ts.debug("}"),j.push(D),ts.debug("ViewPort {"),D={},a=s.next());break;default:Bp(a),a=s.next();break}return ts.debug("}"),j.push(D),j}function y(){const j={};let D={},b=0,_;for(ts.debug("LType {"),a=s.next();!qu(a,0,"ENDTAB");)switch(a.code){case 2:D.name=a.value,_=a.value,a=s.next();break;case 3:D.description=a.value,a=s.next();break;case 73:b=a.value,b>0&&(D.pattern=[]),a=s.next();break;case 40:D.patternLength=a.value,a=s.next();break;case 49:D.pattern.push(a.value),a=s.next();break;case 0:ts.debug("}"),b>0&&b!==D.pattern.length&&ts.warn("lengths do not match on LTYPE pattern"),j[_]=D,D={},ts.debug("LType {"),a=s.next();break;default:a=s.next()}return ts.debug("}"),j[_]=D,j}function v(){const j={};let D={},b;for(ts.debug("Layer {"),a=s.next();!qu(a,0,"ENDTAB");)switch(a.code){case 2:D.name=a.value,b=a.value,a=s.next();break;case 62:D.visible=a.value>=0,D.colorIndex=Math.abs(a.value),D.color=NIe(D.colorIndex),a=s.next();break;case 70:D.frozen=(a.value&1)!=0||(a.value&2)!=0,a=s.next();break;case 0:a.value==="LAYER"&&(ts.debug("}"),j[b]=D,ts.debug("Layer {"),D={},b=void 0,a=s.next());break;default:Bp(a),a=s.next();break}return ts.debug("}"),j[b]=D,j}const m={VPORT:{tableRecordsProperty:"viewPorts",tableName:"viewPort",dxfSymbolName:"VPORT",parseTableRecords:p},LTYPE:{tableRecordsProperty:"lineTypes",tableName:"lineType",dxfSymbolName:"LTYPE",parseTableRecords:y},LAYER:{tableRecordsProperty:"layers",tableName:"layer",dxfSymbolName:"LAYER",parseTableRecords:v}};function w(j){const D=[],b=j?"ENDBLK":"ENDSEC";for(j||(a=s.next());;)if(a.code===0){if(a.value===b)break;const _=o._entityHandlers[a.value];if(_!=null){ts.debug(a.value+" {");const I=_.parseEntity(s,a);a=s.lastReadGroup,ts.debug("}"),T(I),D.push(I)}else{ts.warn("Unhandled entity "+a.value),a=s.next();continue}}else a=s.next();return b=="ENDSEC"&&(a=s.next()),D}function x(j){const D={};let b=j.code;if(D.x=j.value,b+=10,j=s.next(),j.code!=b)throw new Error("Expected code for point value to be "+b+" but got "+j.code+".");return D.y=j.value,b+=10,j=s.next(),j.code!=b?(s.rewind(),D):(D.z=j.value,D)}function T(j){if(!j)throw new TypeError("entity cannot be undefined or null");j.handle||(j.handle=i++)}return c(),t}}function qu(n,e,t){return n.code===e&&n.value===t}function Bp(n){ts.debug("unhandled group "+VX(n))}function VX(n){return n.code+":"+n.value}function NIe(n){return $X[n]}const sy={A5:{width:148,height:210,displayWidth:296,displayHeight:420},A4:{width:210,height:297,displayWidth:420,displayHeight:297*2},A3:{width:297,height:420,displayWidth:297*2,displayHeight:420*2},A2:{width:420,height:594,displayWidth:420*2,displayHeight:594*2},A1:{width:594,height:841,displayWidth:594*2,displayHeight:841*2},A0:{width:841,height:1189,displayWidth:841*2,displayHeight:1189*2}},LIe=(n,e)=>{const t=sy[n];return e==="landscape"?{width:t.height,height:t.width,displayWidth:t.displayHeight,displayHeight:t.displayWidth}:t},U7=[{id:"top",label:"TOP VIEW"},{id:"front",label:"Front VIEW"},{id:"side",label:"Left VIEW"},{id:"door",label:"Door Front"},{id:"right",label:"Right VIEW"},{id:"base",label:"Base Frame"},{id:"iso",label:"ISO VIEW"},{id:"detail1",label:"Detail 1"},{id:"detail2",label:"Detail 2"},{id:"section",label:"Section A-A"}],ET=[{id:"info",label:"프로젝트 정보"},{id:"title",label:"제목"},{id:"specs",label:"사양"},{id:"notes",label:"메모"}],zX=({isOpen:n,onClose:e,capturedViews:t})=>{var br,_r,Qr;const{t:i}=Kv(),[r,s]=O.useState("A3"),[o,a]=O.useState("landscape"),[c,h]=O.useState(!1),u="#ffffff",[d,f]=O.useState(null),[A,g]=O.useState({x:0,y:0}),[p,y]=O.useState([]),[v,m]=O.useState(!1),[w,x]=O.useState(null),[T,j]=O.useState(null),[D,b]=O.useState(null),[_,I]=O.useState(!1),[S,F]=O.useState(null),[B,E]=O.useState({x:0,y:0,width:0,height:0,viewX:0,viewY:0,direction:""}),[V,K]=O.useState({vertical:[],horizontal:[]}),[P,M]=O.useState(!1),[X,Z]=O.useState(null),[Q,U]=O.useState({x:0,y:0,angle:0,startAngle:0}),[z,q]=O.useState({vertical:[],horizontal:[]}),[G,ie]=O.useState({type:null,index:-1}),[H,se]=O.useState({type:null,position:0}),[te,fe]=O.useState(1),[ye,be]=O.useState(0),[_e,W]=O.useState([[]]),[Y,ve]=O.useState(0),[ce,ne]=O.useState({isOpen:!1,viewId:null,viewType:null}),[he,xe]=O.useState({}),[Te,Ce]=O.useState(null),[Be,Ye]=O.useState("views"),[$e,ot]=O.useState([]),[rt,Ve]=O.useState(!1),[We,De]=O.useState("vector"),[Ge,Re]=O.useState(!1),[Ie,Le]=O.useState(!1),[et,ct]=O.useState(!1),[mt,je]=O.useState("pdf"),[le,Je]=O.useState(!1),[ht,ut]=O.useState("template"),[ft,jt]=O.useState("shapes"),[Wt,Mt]=O.useState({canScrollLeft:!1,canScrollRight:!1}),[dn,on]=O.useState({canScrollLeft:!1,canScrollRight:!1}),Et=O.useRef(null),an=O.useRef(null),Mn=O.useRef(!1),At=O.useRef(""),zt=O.useRef(null),Zt=O.useRef(null),{title:$t}=Ha(),{spaceInfo:Ht,materialConfig:Lt}=qi(),{placedModules:dt}=ci(),at=Bi();O.useEffect(()=>{if(t&&Object.keys(t).length>0&&p.length===0){const ue=[];let ke=50,Me=50;t.top&&(ue.push({id:`top_${Date.now()}`,x:ke,y:Me,width:150,height:150,scale:1}),ke+=200),t.front&&(ue.push({id:`front_${Date.now()+1}`,x:ke,y:Me,width:150,height:150,scale:1}),ke+=200),t.side&&(ue.push({id:`side_${Date.now()+2}`,x:ke,y:Me,width:150,height:150,scale:1}),Me+=200,ke=50),t.door&&ue.push({id:`door_${Date.now()+3}`,x:ke,y:Me,width:150,height:150,scale:1}),y(ue)}},[t]);const{viewMode:Ot,view2DDirection:Cn,setViewMode:Rn,setView2DDirection:xn,renderMode:En,setRenderMode:Hn,view2DTheme:Kn}=at,{theme:Ti}=Yo(),[ti,ai]=O.useState({title:$t||"Untitled Project",size:`W${(Ht==null?void 0:Ht.width)||0} × D${(Ht==null?void 0:Ht.depth)||0} × H${(Ht==null?void 0:Ht.height)||0}`,door:((br=Lt==null?void 0:Lt.door)==null?void 0:br.name)||"18.5T_PET",body:((_r=Lt==null?void 0:Lt.body)==null?void 0:_r.name)||"18.5T_LPM",notes:""}),Gi=O.useRef(null),fi=O.useRef(null),Oi=O.useRef(null),rn=O.useMemo(()=>{const ue=LIe(r,o);return console.log("📏 Paper dimensions:",{size:r,orientation:o,width:ue.width+"mm",height:ue.height+"mm",displayWidth:ue.displayWidth+"px",displayHeight:ue.displayHeight+"px"}),ue},[r,o]),$n=O.useMemo(()=>{const ue=window.innerWidth-344-180-60,ke=window.innerHeight-120;return Math.min(ue/rn.displayWidth,ke/rn.displayHeight)*te*.9},[rn,te]),Fn=(ue,ke)=>{ke.preventDefault(),m(!0),x(ue),g({x:100,y:75}),b({x:ke.clientX-100,y:ke.clientY-75})},pt=(ue,ke)=>{ke.stopPropagation();const Me=p.find(Oe=>Oe.id===ue);Me&&(console.log("🎯 뷰 클릭됨:",ue,Me.type),j(ue),console.log("✅ selectedView 설정됨:",ue),f(ue),g({x:ke.clientX-Me.x*$n,y:ke.clientY-Me.y*$n}))},vt=(ue,ke)=>{ne({isOpen:!0,viewId:ue,viewType:ke})},kt=async()=>{var ue;if(!(!Oi.current||!ce.viewId)){console.log("🎯 handleCaptureFromViewer 호출",{viewType:ce.viewType,viewId:ce.viewId});try{if(ce.viewType){if(console.log("🎨 뷰를 SVG 벡터로 변환 시작:",ce.viewType),!p.find(As=>As.id===ce.viewId)){console.error("뷰를 찾을 수 없습니다");return}const Xe=400,qe=300,nn=document.createElementNS("http://www.w3.org/2000/svg","svg");nn.setAttribute("width",String(Xe)),nn.setAttribute("height",String(qe)),nn.setAttribute("viewBox",`0 0 ${Xe} ${qe}`),nn.setAttribute("xmlns","http://www.w3.org/2000/svg"),nn.setAttribute("preserveAspectRatio","xMidYMid meet");const An=document.createElementNS("http://www.w3.org/2000/svg","rect");An.setAttribute("width","100%"),An.setAttribute("height","100%"),An.setAttribute("fill","#ffffff"),nn.appendChild(An);const Ct=document.createElementNS("http://www.w3.org/2000/svg","defs"),kn=document.createElementNS("http://www.w3.org/2000/svg","pattern");kn.setAttribute("id","grid"),kn.setAttribute("width","10"),kn.setAttribute("height","10"),kn.setAttribute("patternUnits","userSpaceOnUse");const fn=document.createElementNS("http://www.w3.org/2000/svg","path");fn.setAttribute("d","M 10 0 L 0 0 0 10"),fn.setAttribute("fill","none"),fn.setAttribute("stroke","#e0e0e0"),fn.setAttribute("stroke-width","0.5"),kn.appendChild(fn),Ct.appendChild(kn),nn.appendChild(Ct);const Qt=document.createElementNS("http://www.w3.org/2000/svg","rect");Qt.setAttribute("width","100%"),Qt.setAttribute("height","100%"),Qt.setAttribute("fill","url(#grid)"),nn.appendChild(Qt);const Qn=document.createElementNS("http://www.w3.org/2000/svg","g");Qn.setAttribute("transform","translate(50, 50)");const Tn=document.createElementNS("http://www.w3.org/2000/svg","rect");Tn.setAttribute("x","0"),Tn.setAttribute("y","0"),Tn.setAttribute("width","300"),Tn.setAttribute("height","200"),Tn.setAttribute("fill","none"),Tn.setAttribute("stroke","#000000"),Tn.setAttribute("stroke-width","2"),Qn.appendChild(Tn);const Nn=document.createElementNS("http://www.w3.org/2000/svg","line");Nn.setAttribute("x1","100"),Nn.setAttribute("y1","0"),Nn.setAttribute("x2","100"),Nn.setAttribute("y2","200"),Nn.setAttribute("stroke","#000000"),Nn.setAttribute("stroke-width","1.5"),Qn.appendChild(Nn);const pn=document.createElementNS("http://www.w3.org/2000/svg","line");pn.setAttribute("x1","200"),pn.setAttribute("y1","0"),pn.setAttribute("x2","200"),pn.setAttribute("y2","200"),pn.setAttribute("stroke","#000000"),pn.setAttribute("stroke-width","1.5"),Qn.appendChild(pn);const tr=document.createElementNS("http://www.w3.org/2000/svg","text");tr.setAttribute("x","150"),tr.setAttribute("y","-10"),tr.setAttribute("font-size","12"),tr.setAttribute("font-family","Arial"),tr.setAttribute("text-anchor","middle"),tr.setAttribute("fill","#000000"),tr.textContent="3000mm",Qn.appendChild(tr);const Nr=document.createElementNS("http://www.w3.org/2000/svg","text");Nr.setAttribute("x","-20"),Nr.setAttribute("y","100"),Nr.setAttribute("font-size","12"),Nr.setAttribute("font-family","Arial"),Nr.setAttribute("text-anchor","middle"),Nr.setAttribute("transform","rotate(-90 -20 100)"),Nr.setAttribute("fill","#000000"),Nr.textContent="2000mm",Qn.appendChild(Nr),nn.appendChild(Qn);const ks=new XMLSerializer().serializeToString(nn),ko="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(ks)));console.log("📊 SVG 데이터 생성 완료",{svgDataUrl:ko.substring(0,100)+"...",viewId:ce.viewId}),y(As=>{const xo=As.map(ar=>ar.id===ce.viewId?(console.log("✅ 뷰 업데이트 중:",ar.id),{...ar,imageUrl:ko,type:"image",hasDrawingData:!1,visible:!0,fileName:"2D Vector View",width:Xe,height:qe,scale:1}):ar);return console.log("📝 업데이트된 뷰 목록:",xo),xo}),setTimeout(()=>{ve(As=>As+1),Et.current&&Et.current.renderAll()},100),ne({isOpen:!1,viewId:null,viewType:null}),console.log("✅ 2D 뷰가 SVG 벡터로 성공적으로 변환되었습니다"),alert(`${(ue=ce.viewType)==null?void 0:ue.toUpperCase()} 뷰가 벡터로 변환되었습니다. 뷰카드를 확인하세요.`);return}await new Promise(me=>setTimeout(me,500));const ke=Oi.current.querySelector("canvas");if(!ke){console.error("Canvas not found in viewer container");return}const Me={scale:3,backgroundColor:"#ffffff",logging:!1,useCORS:!0,allowTaint:!1,onclone:me=>{const Xe=me.querySelector("canvas");if(Xe&&ke instanceof HTMLCanvasElement){const qe=Xe.getContext("2d");qe&&qe.drawImage(ke,0,0)}}},nt=(await AC(Oi.current,Me)).toDataURL("image/png"),gt=ce.viewType,Ae=ce.viewId;gt&&Ae&&(xe(me=>({...me,[`${Ae}_${gt}`]:nt})),console.log("View captured successfully:",gt)),ne({isOpen:!1,viewId:null,viewType:null})}catch(ke){console.error("Error capturing view:",ke)}}},mn=(ue,ke)=>{y(Me=>Me.map(Oe=>Oe.id===ue?{...Oe,scale:Math.max(.3,Math.min(3,Oe.scale+ke))}:Oe))},sn=ue=>{y(ke=>ke.filter(Me=>Me.id!==ue)),T===ue&&j(null)};O.useEffect(()=>{const ue=ke=>{if((ke.key==="Delete"||ke.key==="Backspace")&&T){const Me=document.activeElement;(Me==null?void 0:Me.tagName)!=="INPUT"&&(Me==null?void 0:Me.tagName)!=="TEXTAREA"&&(ke.preventDefault(),sn(T))}};return n&&document.addEventListener("keydown",ue),()=>{document.removeEventListener("keydown",ue)}},[n,T]);const bn=(ue,ke,Me)=>{Me.stopPropagation(),Me.preventDefault();const Oe=p.find(nt=>nt.id===ue);Oe&&(I(!0),F(ue),E({x:Me.clientX,y:Me.clientY,width:Oe.width*Oe.scale,height:Oe.height*Oe.scale,viewX:Oe.x,viewY:Oe.y,direction:ke}))},Li=(ue,ke)=>{var nt;ke.stopPropagation(),ke.preventDefault();const Me=p.find(gt=>gt.id===ue);if(!Me)return;console.log("🔄 회전 시작:",ue,Me.type),M(!0),Z(ue);const Oe=(nt=ke.currentTarget.parentElement)==null?void 0:nt.getBoundingClientRect();if(Oe){const gt=Oe.left+Oe.width/2,Ae=Oe.top+Oe.height/2,me=Math.atan2(ke.clientY-Ae,ke.clientX-gt)*(180/Math.PI);console.log("📐 회전 초기값:",{centerX:gt,centerY:Ae,startAngle:me,currentRotation:Me.rotation||0}),U({x:gt,y:Ae,angle:Me.rotation||0,startAngle:me})}},Wn=ii.useCallback((ue,ke)=>{const Me={vertical:[],horizontal:[]},Oe=5;return p.forEach(nt=>{if(nt.id===ke)return;const gt=nt.x,Ae=nt.x+nt.width*nt.scale,me=nt.y,Xe=nt.y+nt.height*nt.scale,qe=nt.x+nt.width*nt.scale/2,nn=nt.y+nt.height*nt.scale/2,An=ue.x,Ct=ue.x+ue.width*ue.scale,kn=ue.y,fn=ue.y+ue.height*ue.scale,Qt=ue.x+ue.width*ue.scale/2,Qn=ue.y+ue.height*ue.scale/2;Math.abs(An-gt)<Oe&&Me.vertical.push(gt),Math.abs(An-Ae)<Oe&&Me.vertical.push(Ae),Math.abs(Ct-gt)<Oe&&Me.vertical.push(gt),Math.abs(Ct-Ae)<Oe&&Me.vertical.push(Ae),Math.abs(Qt-qe)<Oe&&Me.vertical.push(qe),Math.abs(kn-me)<Oe&&Me.horizontal.push(me),Math.abs(kn-Xe)<Oe&&Me.horizontal.push(Xe),Math.abs(fn-me)<Oe&&Me.horizontal.push(me),Math.abs(fn-Xe)<Oe&&Me.horizontal.push(Xe),Math.abs(Qn-nn)<Oe&&Me.horizontal.push(nn)}),Me},[p]),ui=()=>{const ue=[..._e];ue[ye]=p,ue.push([]),W(ue);const ke=ue.length-1;be(ke),y([]),setTimeout(()=>{const Me=document.querySelector(`.${Qe.pageListContainer}`);Me&&(Me.scrollLeft=Me.scrollWidth)},100)},Mi=ue=>{const ke=[..._e];ke[ye]=p,W(ke),be(ue),y(ke[ue]||[])},Gn=ue=>{if(_e.length<=1)return;const ke=_e.filter((Me,Oe)=>Oe!==ue);W(ke),ye>=ke.length&&be(ke.length-1),y(ke[ye]||[])},Dn=[.25,.33,.5,.66,.75,1,1.25,1.5,1.75,2],li=ue=>{fe(ke=>{let Me=0,Oe=Math.abs(Dn[0]-ke);for(let nt=1;nt<Dn.length;nt++){const gt=Math.abs(Dn[nt]-ke);gt<Oe&&(Oe=gt,Me=nt)}if(ue>0){for(let nt=Me;nt<Dn.length;nt++)if(Dn[nt]>ke+.01)return Dn[nt];return Dn[Dn.length-1]}else{for(let nt=Me;nt>=0;nt--)if(Dn[nt]<ke-.01)return Dn[nt];return Dn[0]}})},en=ii.useCallback(ue=>{if(P&&X){if(!p.find(gt=>gt.id===X))return;const Me=Math.atan2(ue.clientY-Q.y,ue.clientX-Q.x)*(180/Math.PI),Oe=Me-Q.startAngle;let nt=Q.angle+Oe;for(;nt<0;)nt+=360;for(;nt>=360;)nt-=360;ue.shiftKey&&(nt=Math.round(nt/15)*15),console.log("🔄 회전 중:",{viewId:X,currentAngle:Me,angleDelta:Oe,newRotation:nt,shiftKey:ue.shiftKey}),y(gt=>gt.map(Ae=>Ae.id===X?{...Ae,rotation:nt}:Ae));return}if(_&&S){requestAnimationFrame(()=>{const ke=p.find(Ct=>Ct.id===S);if(!ke)return;const Me=(ue.clientX-B.x)/$n,Oe=(ue.clientY-B.y)/$n,nt=B.width/B.height;let gt=ke.width*ke.scale,Ae=ke.height*ke.scale,me=ke.x,Xe=ke.y;const qe=ue.shiftKey;switch(B.direction){case"nw":if(me=B.viewX+Me,Xe=B.viewY+Oe,gt=B.width-Me,Ae=B.height-Oe,qe){const Ct=(Math.abs(Me)+Math.abs(Oe))/2*(Me<0?1:-1);gt=B.width-Ct,Ae=gt/nt,me=B.viewX+Ct,Xe=B.viewY+Ct/nt}break;case"n":Xe=B.viewY+Oe,Ae=B.height-Oe;break;case"ne":if(Xe=B.viewY+Oe,gt=B.width+Me,Ae=B.height-Oe,qe){const Ct=(Math.abs(Me)+Math.abs(Oe))/2*(Me>0?1:-1);gt=B.width+Ct,Ae=gt/nt,Xe=B.viewY-Ct/nt}break;case"w":me=B.viewX+Me,gt=B.width-Me;break;case"e":gt=B.width+Me;break;case"sw":if(me=B.viewX+Me,gt=B.width-Me,Ae=B.height+Oe,qe){const Ct=(Math.abs(Me)+Math.abs(Oe))/2*(Me<0?1:-1);gt=B.width-Ct,Ae=gt/nt,me=B.viewX+Ct}break;case"s":Ae=B.height+Oe;break;case"se":if(gt=B.width+Me,Ae=B.height+Oe,qe){const Ct=(Math.abs(Me)+Math.abs(Oe))/2*(Me>0?1:-1);gt=B.width+Ct,Ae=gt/nt}break}gt=Math.max(100,gt),Ae=Math.max(75,Ae),me<0&&(gt+=me,me=0),Xe<0&&(Ae+=Xe,Xe=0),me+gt>rn.displayWidth&&(gt=rn.displayWidth-me),Xe+Ae>rn.displayHeight&&(Ae=rn.displayHeight-Xe);const nn={...ke,x:me,y:Xe,width:gt/ke.scale,height:Ae/ke.scale,scale:ke.scale},An=Wn(nn,S);K(An),y(Ct=>Ct.map(kn=>kn.id===S?{...ke,x:me,y:Xe,width:gt/ke.scale,height:Ae/ke.scale}:kn))});return}if(v&&w){b({x:ue.clientX-A.x,y:ue.clientY-A.y});return}d&&requestAnimationFrame(()=>{const ke=p.find(Xe=>Xe.id===d);if(!ke)return;const Me=(ue.clientX-A.x)/$n,Oe=(ue.clientY-A.y)/$n,nt=Math.max(0,Math.min(rn.displayWidth-ke.width*ke.scale,Me)),gt=Math.max(0,Math.min(rn.displayHeight-ke.height*ke.scale,Oe)),Ae={...ke,x:nt,y:gt},me=Wn(Ae,d);K(me),y(Xe=>Xe.map(qe=>qe.id===d?{...qe,x:nt,y:gt}:qe))})},[P,X,Q,_,S,p,B,$n,v,w,A,d,rn,Wn]),Rt=ii.useCallback(ue=>{if(P){M(!1),Z(null);return}if(_){I(!1),F(null),K({vertical:[],horizontal:[]});return}if(v&&w&&fi.current){const ke=fi.current.getBoundingClientRect(),Me=(ue.clientX-ke.left)/$n,Oe=(ue.clientY-ke.top)/$n;if(console.log("🎯 드롭 위치 계산:",{x:Me,y:Oe,scale:$n,paperDimensions:rn}),Me>=0&&Oe>=0&&Me<=rn.displayWidth&&Oe<=rn.displayHeight)if(w.type==="shape"&&Et.current){const nt=Et.current;if(w.shapeType==="rectangle"){const gt=new ol({left:Me-50,top:Oe-50,fill:"#333333",width:100,height:100,selectable:!0,hasControls:!0});nt.add(gt)}else if(w.shapeType==="circle"){const gt=new gu({left:Me-50,top:Oe-50,fill:"#333333",radius:50,selectable:!0,hasControls:!0});nt.add(gt)}else if(w.shapeType==="triangle"){const gt=new Uh({left:Me-50,top:Oe-50,fill:"#333333",width:100,height:100,selectable:!0,hasControls:!0});nt.add(gt)}else if(w.shapeType==="rounded-rectangle"){const gt=new ol({left:Me-50,top:Oe-50,fill:"#333333",width:100,height:100,rx:10,ry:10,selectable:!0,hasControls:!0});nt.add(gt)}else if(w.shapeType==="ellipse"){const gt=new rd({left:Me-50,top:Oe-50,fill:"#333333",rx:60,ry:40,selectable:!0,hasControls:!0});nt.add(gt)}else if(w.shapeType==="pentagon"){const gt=new $0([{x:50,y:0},{x:100,y:35},{x:80,y:90},{x:20,y:90},{x:0,y:35}],{left:Me-50,top:Oe-45,fill:"#333333",selectable:!0,hasControls:!0});nt.add(gt)}else if(w.shapeType==="hexagon"){const gt=new $0([{x:30,y:0},{x:70,y:0},{x:100,y:50},{x:70,y:100},{x:30,y:100},{x:0,y:50}],{left:Me-50,top:Oe-50,fill:"#333333",selectable:!0,hasControls:!0});nt.add(gt)}else if(w.shapeType==="star"){const gt=new sA("M 50,0 L 61,35 L 98,35 L 68,57 L 79,91 L 50,70 L 21,91 L 32,57 L 2,35 L 39,35 z",{left:Me-50,top:Oe-45,fill:"#333333",selectable:!0,hasControls:!0});nt.add(gt)}nt.renderAll(),console.log("✅ 도형 추가됨:",w.shapeType)}else if(w.type==="symbol"&&Et.current){const nt=Et.current,gt=new Tl(w.symbol||"",{left:Me-30,top:Oe-30,fontSize:60,fill:"#333333",selectable:!0,hasControls:!0});nt.add(gt),nt.renderAll(),console.log("✅ 심볼 추가됨:",w.symbol)}else if(w.type==="uploaded-file"&&w.uploadedFile){const nt=w.uploadedFile;if(nt.type==="image"){const gt={id:`image_${Date.now()}`,x:Me-100,y:Oe-75,width:200,height:150,scale:1,rotation:0,type:"image",imageUrl:nt.url,fileName:nt.name};console.log("✅ 이미지 뷰카드 추가:",gt),y(Ae=>[...Ae,gt])}else if(nt.type==="pdf"){const gt={id:`pdf_${Date.now()}`,x:Me-100,y:Oe-75,width:200,height:150,scale:1,rotation:0,type:"pdf",fileName:nt.name};console.log("✅ PDF 뷰카드 추가:",gt),y(Ae=>[...Ae,gt])}else if(nt.type==="dxf"){const gt={id:`dxf_${Date.now()}`,x:Me-100,y:Oe-75,width:200,height:150,scale:1,rotation:0,type:"dxf",fileName:nt.name};console.log("✅ DXF 뷰카드 추가:",gt),y(Ae=>[...Ae,gt])}}else{const nt={id:`${w.id}_${Date.now()}`,x:Me-100,y:Oe-75,width:200,height:150,scale:1};console.log("✅ 뷰카드 추가:",nt),y(gt=>{const Ae=[...gt,nt];return console.log("📊 업데이트된 viewPositions:",Ae),Ae})}else console.log("❌ 드롭 위치가 경계 밖:",{x:Me,y:Oe,paperDimensions:rn});m(!1),x(null)}f(null),b(null),K({vertical:[],horizontal:[]})},[P,_,v,w,$n,rn]);O.useEffect(()=>{if(d||v||_||P)return document.addEventListener("mousemove",en),document.addEventListener("mouseup",Rt),()=>{document.removeEventListener("mousemove",en),document.removeEventListener("mouseup",Rt)}},[d,v,_,P,A,$n,B,Q,en,Rt]);const Xn=O.useCallback(async()=>{if(!an.current)return console.error("캔버스 컨테이너가 없습니다."),!1;if(Mn.current)return console.log("⚠️ Canvas initialization already in progress"),!1;Mn.current=!0,console.log("🔧 Canvas initialization started - orientation:",o);try{if(Et.current){console.log("🗑️ Destroying existing canvas");try{Et.current.clear(),Et.current.dispose()}catch(Qt){console.warn("Canvas dispose error (ignored):",Qt)}Et.current=null}document.querySelectorAll(".canvas-container").forEach(Qt=>{Qt.remove()}),document.querySelectorAll("canvas").forEach(Qt=>{Qt.remove()}),an.current.innerHTML="",console.log("✅ Canvas container completely cleared");const Me=`fabric-canvas-${Date.now()}`;At.current=Me;const Oe=document.getElementById(Me);Oe&&(console.warn("⚠️ Existing canvas found, removing"),Oe.remove());const nt=document.createElement("canvas");nt.id=Me,nt.style.position="absolute",nt.style.top="0",nt.style.left="0",an.current.appendChild(nt),await new Promise(Qt=>setTimeout(Qt,20)),an.current.querySelectorAll(".canvas-container").forEach(Qt=>Qt.remove());const Ae=new x6(Me,{width:rn.displayWidth,height:rn.displayHeight,backgroundColor:u,selection:!0,preserveObjectStacking:!0,renderOnAddRemove:!0});Et.current=Ae,requestAnimationFrame(()=>{const Qt=document.querySelectorAll(".canvas-container");if(console.log(`🔍 Canvas created, found ${Qt.length} containers`),Qt.length>1){console.log("🚑 Emergency cleanup: Removing duplicate containers");for(let Qn=1;Qn<Qt.length;Qn++)Qt[Qn].remove()}if(an.current){const Qn=an.current.querySelectorAll(".canvas-container");if(Qn.length>1){console.log("🚑 Removing inner duplicate containers");for(let Tn=1;Tn<Qn.length;Tn++)Qn[Tn].remove()}}}),setTimeout(()=>{const Qt=document.querySelectorAll(".canvas-container"),Qn=document.querySelectorAll("canvas");if(console.log(`🎯 Final check - containers: ${Qt.length}, canvases: ${Qn.length}`),Qt.length>1){console.log("🔥 Still duplicated! Force removing all but first");for(let Tn=1;Tn<Qt.length;Tn++)Qt[Tn].remove()}},100),console.log("🎯 그리드 생성 시작");const me=20,Xe=me*5;Ae.setBackgroundColor("#fafafa",()=>{Ae.renderAll()});for(let Qt=0;Qt<=rn.displayWidth;Qt+=me){const Qn=new nl([Qt,0,Qt,rn.displayHeight],{stroke:"#cccccc",strokeWidth:1,selectable:!1,evented:!1,excludeFromExport:!1,hasControls:!1,hasBorders:!1});Ae.add(Qn),Ae.sendToBack(Qn)}for(let Qt=0;Qt<=rn.displayHeight;Qt+=me){const Qn=new nl([0,Qt,rn.displayWidth,Qt],{stroke:"#cccccc",strokeWidth:1,selectable:!1,evented:!1,excludeFromExport:!1,hasControls:!1,hasBorders:!1});Ae.add(Qn),Ae.sendToBack(Qn)}for(let Qt=0;Qt<=rn.displayWidth;Qt+=Xe){const Qn=new nl([Qt,0,Qt,rn.displayHeight],{stroke:"#888888",strokeWidth:2,selectable:!1,evented:!1,excludeFromExport:!1,hasControls:!1,hasBorders:!1});Ae.add(Qn)}for(let Qt=0;Qt<=rn.displayHeight;Qt+=Xe){const Qn=new nl([0,Qt,rn.displayWidth,Qt],{stroke:"#888888",strokeWidth:2,selectable:!1,evented:!1,excludeFromExport:!1,hasControls:!1,hasBorders:!1});Ae.add(Qn)}const qe=rn.displayWidth/2,nn=rn.displayHeight/2,An=new nl([qe,0,qe,rn.displayHeight],{stroke:"#0080ff",strokeWidth:2,strokeDashArray:[10,5],selectable:!1,evented:!1,excludeFromExport:!1,hasControls:!1,hasBorders:!1}),Ct=new nl([0,nn,rn.displayWidth,nn],{stroke:"#0080ff",strokeWidth:2,strokeDashArray:[10,5],selectable:!1,evented:!1,excludeFromExport:!1,hasControls:!1,hasBorders:!1});Ae.add(An),Ae.add(Ct),Ae.renderAll(),console.log("✅ 그리드 생성 완료"),Ae.on("object:modified",()=>{ve(Qt=>Qt+1)}),Ae.on("object:added",()=>{ve(Qt=>Qt+1)}),Ae.on("object:removed",()=>{ve(Qt=>Qt+1)});const kn=Qt=>{if((Qt.key==="Delete"||Qt.key==="Backspace")&&Ae){const Qn=Ae.getActiveObject();if(Qn){const Tn=document.activeElement;(Tn==null?void 0:Tn.tagName)!=="INPUT"&&(Tn==null?void 0:Tn.tagName)!=="TEXTAREA"&&(Qt.preventDefault(),Ae.remove(Qn),Ae.discardActiveObject(),Ae.renderAll())}}};document.addEventListener("keydown",kn),window.handleCanvasKeyDown=kn,Ae.renderAll();const fn=Ae.wrapperEl;return fn&&(fn.style.zIndex="10",fn.style.position="absolute",fn.style.top="0",fn.style.left="0"),console.log("Fabric.js 캔버스 초기화 완료",{canvas:Ae,width:Ae.width,height:Ae.height,backgroundColor:Ae.backgroundColor,element:Ae.getElement(),wrapper:Ae.wrapperEl}),console.log("✅ Canvas reinitialized - orientation:",o),!0}catch(ue){return console.error("Fabric.js 캔버스 생성 오류:",ue),!1}finally{Mn.current=!1,console.log("🔓 Canvas initialization flag reset")}},[n,o,rn,u]);O.useEffect(()=>{let ue=null;if(an.current&&n&&(ue=new MutationObserver(Me=>{var nt;const Oe=(nt=an.current)==null?void 0:nt.querySelectorAll(".canvas-container");if(Oe&&Oe.length>1){console.log("🚨 MutationObserver: 중복 캔버스 감지!",Oe.length);for(let gt=1;gt<Oe.length;gt++)Oe[gt].remove()}}),ue.observe(an.current,{childList:!0,subtree:!0})),!n){if(Et.current){console.log("모달 닫힘 - 캔버스 정리");try{Et.current.clear(),Et.current.dispose()}catch(Me){console.error("캔버스 정리 중 오류:",Me)}Et.current=null}if(an.current){const Me=an.current.querySelectorAll(".canvas-container");console.log(`🧹 모달 닫힘 - canvas-container ${Me.length}개 제거`),Me.forEach(nt=>nt.remove());const Oe=an.current.querySelectorAll("canvas");console.log(`🧹 모달 닫힘 - canvas ${Oe.length}개 제거`),Oe.forEach(nt=>nt.remove())}return}if(n&&an.current&&!Et.current){console.log("🚀 캔버스 초기화 시도:",{isOpen:n,hasContainer:!!an.current,hasCanvas:!!Et.current}),Xn();let Me=0;const Oe=setInterval(()=>{if(an.current){const nt=an.current.querySelectorAll(".canvas-container");if(nt.length>1){console.log(`🔥 Interval: 중복 제거 ${nt.length}개 → 1개`);for(let gt=1;gt<nt.length;gt++)nt[gt].remove()}}Me++,Me>=10&&clearInterval(Oe)},100)}const ke=Me=>{if(Et.current&&(Me.key==="Delete"||Me.key==="Backspace")){const Oe=Et.current.getActiveObjects();Oe.length>0&&(Oe.forEach(nt=>Et.current.remove(nt)),Et.current.discardActiveObject(),Et.current.renderAll())}};return n&&document.addEventListener("keydown",ke),()=>{document.removeEventListener("keydown",ke),window.handleCanvasKeyDown&&(document.removeEventListener("keydown",window.handleCanvasKeyDown),delete window.handleCanvasKeyDown),ue&&(ue.disconnect(),ue=null)}},[n]),O.useEffect(()=>{!n||!Et.current||(console.log("🔄 Paper dimensions 변경 감지"),Et.current.setDimensions({width:rn.displayWidth,height:rn.displayHeight}),Et.current.renderAll())},[rn.displayWidth,rn.displayHeight,n]),O.useEffect(()=>{if(_e[ye]!==p){const ue=[..._e];ue[ye]=p,W(ue)}},[p,ye]),O.useEffect(()=>{const ue=Me=>{if(H.type){const Oe=document.querySelector(`.${Qe.rulerWrapper}`);if(Oe){Oe.getBoundingClientRect();const nt=document.querySelector(`.${Qe.previewContent}`),gt=nt==null?void 0:nt.getBoundingClientRect();if(gt)if(H.type==="vertical"){const Ae=(Me.clientX-gt.left)/$n;Ae>=0&&Ae<=rn.displayWidth&&q(me=>({...me,vertical:[...me.vertical,Ae]}))}else{const Ae=(Me.clientY-gt.top)/$n;Ae>=0&&Ae<=rn.displayHeight&&q(me=>({...me,horizontal:[...me.horizontal,Ae]}))}}se({type:null,position:0})}if(G.type){const Oe=document.querySelector(`.${Qe.previewContent}`),nt=Oe==null?void 0:Oe.getBoundingClientRect();if(nt)if(G.type==="vertical"){const gt=(Me.clientX-nt.left)/$n;gt>=0&&gt<=rn.displayWidth&&q(Ae=>({...Ae,vertical:Ae.vertical.map((me,Xe)=>Xe===G.index?gt:me)}))}else{const gt=(Me.clientY-nt.top)/$n;gt>=0&&gt<=rn.displayHeight&&q(Ae=>({...Ae,horizontal:Ae.horizontal.map((me,Xe)=>Xe===G.index?gt:me)}))}}},ke=()=>{se({type:null,position:0}),ie({type:null,index:-1})};if(H.type||G.type)return document.addEventListener("mousemove",ue),document.addEventListener("mouseup",ke),()=>{document.removeEventListener("mousemove",ue),document.removeEventListener("mouseup",ke)}},[H,G,$n,rn]);const Ui=()=>{if(zt.current){const{scrollLeft:ue,scrollWidth:ke,clientWidth:Me}=zt.current;Mt({canScrollLeft:ue>0,canScrollRight:ue<ke-Me-1})}if(Zt.current){const{scrollLeft:ue,scrollWidth:ke,clientWidth:Me}=Zt.current;on({canScrollLeft:ue>0,canScrollRight:ue<ke-Me-1})}};O.useEffect(()=>{Ui();const ue=()=>{Ui()},ke=zt.current,Me=Zt.current;return ke&&ke.addEventListener("scroll",ue),Me&&Me.addEventListener("scroll",ue),window.addEventListener("resize",Ui),()=>{ke&&ke.removeEventListener("scroll",ue),Me&&Me.removeEventListener("scroll",ue),window.removeEventListener("resize",Ui)}},[]);const tt=ue=>{if(Zt.current){const ke=ue==="left"?-100:100;Zt.current.scrollBy({left:ke,behavior:"smooth"})}},Jt=(ue,ke)=>{if(console.log("도형 클릭됨:",ke),!Et.current){console.error("캔버스가 초기화되지 않았습니다.");return}const Me=Et.current;console.log("캔버스 상태:",{width:Me.width,height:Me.height,objects:Me.getObjects().length,isReady:Me.getElement()!==null});const Oe=Me.width/2,nt=Me.height/2;qke(ue,(gt,Ae)=>{var qe;if(console.log("SVG 로드됨:",{objects:gt.length,options:Ae}),gt.length===0){console.error("SVG 객체를 생성할 수 없습니다.");return}const me=dke.groupSVGElements(gt,Ae);me.set({left:Oe-40,top:nt-40,scaleX:3.5,scaleY:3.5,fill:"#333333",stroke:"#333333",strokeWidth:0}),console.log("도형 추가 전 객체 수:",Me.getObjects().length),Me.add(me),console.log("도형 추가 후 객체 수:",Me.getObjects().length),Me.setActiveObject(me),Me.renderAll(),console.log("도형이 캔버스에 추가되었습니다.");const Xe=Me.getElement();console.log("캔버스 엘리먼트 상태:",{width:Xe.width,height:Xe.height,style:Xe.style.cssText,parent:(qe=Xe.parentElement)==null?void 0:qe.className})},gt=>{console.error("SVG 로드 에러:",gt)})},wn=ue=>{if(console.log("선 클릭됨:",ue),!Et.current){console.error("캔버스가 초기화되지 않았습니다.");return}const ke=Et.current,Me=ke.width/2,Oe=ke.height/2;let nt;switch(ue){case"horizontal":nt=new nl([Me-100,Oe,Me+100,Oe],{stroke:"#333333",strokeWidth:2,strokeDashArray:null});break;case"vertical":nt=new nl([Me,Oe-100,Me,Oe+100],{stroke:"#333333",strokeWidth:2,strokeDashArray:null});break;case"diagonal1":nt=new nl([Me-100,Oe-100,Me+100,Oe+100],{stroke:"#333333",strokeWidth:2,strokeDashArray:null});break;case"diagonal2":nt=new nl([Me-100,Oe+100,Me+100,Oe-100],{stroke:"#333333",strokeWidth:2,strokeDashArray:null});break}nt&&(console.log("선 추가 전 객체 수:",ke.getObjects().length),ke.add(nt),console.log("선 추가 후 객체 수:",ke.getObjects().length),ke.setActiveObject(nt),ke.renderAll(),console.log("선이 캔버스에 추가되었습니다."))},Yn=async ue=>{if(Et.current)try{const ke=await ue.text(),Oe=new PIe().parseSync(ke);if(!Oe){console.error("DXF 파싱 실패");return}const nt=Et.current,gt=nt.width,Ae=nt.height;let me=1/0,Xe=1/0,qe=-1/0,nn=-1/0;Oe.entities&&Oe.entities.forEach(pn=>{pn.type==="LINE"?(me=Math.min(me,pn.vertices[0].x,pn.vertices[1].x),Xe=Math.min(Xe,pn.vertices[0].y,pn.vertices[1].y),qe=Math.max(qe,pn.vertices[0].x,pn.vertices[1].x),nn=Math.max(nn,pn.vertices[0].y,pn.vertices[1].y)):pn.type==="LWPOLYLINE"||pn.type==="POLYLINE"?pn.vertices.forEach(tr=>{me=Math.min(me,tr.x),Xe=Math.min(Xe,tr.y),qe=Math.max(qe,tr.x),nn=Math.max(nn,tr.y)}):(pn.type==="CIRCLE"||pn.type==="ARC")&&(me=Math.min(me,pn.center.x-pn.radius),Xe=Math.min(Xe,pn.center.y-pn.radius),qe=Math.max(qe,pn.center.x+pn.radius),nn=Math.max(nn,pn.center.y+pn.radius))});const An=qe-me,Ct=nn-Xe,kn=gt*.8/An,fn=Ae*.8/Ct,Qt=Math.min(kn,fn),Qn=(gt-An*Qt)/2-me*Qt,Tn=(Ae-Ct*Qt)/2+nn*Qt,Nn=[];if(Oe.entities&&Oe.entities.forEach(pn=>{if(pn.type==="LINE"){const tr=new nl([pn.vertices[0].x*Qt+Qn,-pn.vertices[0].y*Qt+Tn,pn.vertices[1].x*Qt+Qn,-pn.vertices[1].y*Qt+Tn],{stroke:th("text",Kn),strokeWidth:1,selectable:!0});Nn.push(tr)}else if(pn.type==="LWPOLYLINE"||pn.type==="POLYLINE"){const tr=pn.vertices.map(ks=>({x:ks.x*Qt+Qn,y:-ks.y*Qt+Tn})),Nr=new Lh(tr,{stroke:th("text",Kn),strokeWidth:1,fill:"transparent",selectable:!0});Nn.push(Nr)}else if(pn.type==="CIRCLE"){const tr=new gu({left:pn.center.x*Qt+Qn-pn.radius*Qt,top:-pn.center.y*Qt+Tn-pn.radius*Qt,radius:pn.radius*Qt,stroke:th("text",Kn),strokeWidth:1,fill:"transparent",selectable:!0});Nn.push(tr)}else if(pn.type==="ARC"){const tr=pn.startAngle||0,Nr=pn.endAngle||360,ks=pn.radius*Qt,ko=pn.center.x*Qt+Qn,As=-pn.center.y*Qt+Tn,xo=tr*Math.PI/180,ar=Nr*Math.PI/180,un=Math.abs(Nr-tr)>180?1:0,Vn=ko+ks*Math.cos(xo),Ln=As-ks*Math.sin(xo),ee=ko+ks*Math.cos(ar),we=As-ks*Math.sin(ar),He=new sA(`M ${Vn} ${Ln} A ${ks} ${ks} 0 ${un} 0 ${ee} ${we}`,{stroke:th("text",Kn),strokeWidth:1,fill:"transparent",selectable:!0});Nn.push(He)}}),Nn.length>0){const pn=new hh(Nn,{selectable:!0,hasControls:!0,hasBorders:!0});nt.add(pn),nt.setActiveObject(pn),nt.renderAll()}}catch(ke){console.error("DXF 파일 처리 오류:",ke)}},hi=()=>{if(!Et.current)return;const ue=Et.current,ke=ue.width/2,Me=ue.height/2,Oe=new _u("텍스트를 입력하세요",{left:ke-100,top:Me,fontFamily:"Arial",fontSize:20,fill:"#333333"});ue.add(Oe),ue.setActiveObject(Oe),Oe.enterEditing(),ue.renderAll()},Xt=ue=>{if(console.log("심볼 클릭됨:",ue),!Et.current){console.error("캔버스가 초기화되지 않았습니다.");return}const ke=Et.current,Me=ke.width/2,Oe=ke.height/2,nt=new Tl(ue,{left:Me-20,top:Oe-20,fontFamily:"Arial",fontSize:40,fill:"#333333"});console.log("심볼 추가 전 객체 수:",ke.getObjects().length),ke.add(nt),console.log("심볼 추가 후 객체 수:",ke.getObjects().length),ke.setActiveObject(nt),ke.renderAll(),console.log("심볼이 캔버스에 추가되었습니다.")},_i=ue=>{if(console.log("말풍선 클릭됨:",ue),!Et.current){console.error("Fabric.js 캔버스가 초기화되지 않았습니다.");return}const ke=Et.current,Me=ke.width/2,Oe=ke.height/2,nt=new hh([],{left:Me-100,top:Oe-50}),gt=new ol({left:0,top:0,width:200,height:100,rx:10,ry:10,fill:"#ffffff",stroke:"#333333",strokeWidth:2});nt.addWithUpdate(gt);let Ae;switch(ue){case"left":Ae=new Uh({left:-10,top:40,width:20,height:20,angle:-90,fill:"#ffffff",stroke:"#333333",strokeWidth:2});break;case"right":Ae=new Uh({left:190,top:40,width:20,height:20,angle:90,fill:"#ffffff",stroke:"#333333",strokeWidth:2});break;case"top":Ae=new Uh({left:90,top:-10,width:20,height:20,angle:0,fill:"#ffffff",stroke:"#333333",strokeWidth:2});break;case"bottom":Ae=new Uh({left:90,top:90,width:20,height:20,angle:180,fill:"#ffffff",stroke:"#333333",strokeWidth:2});break}Ae&&nt.addWithUpdate(Ae);const me=new _u("텍스트를 입력하세요",{left:10,top:35,fontFamily:"Arial",fontSize:16,fill:"#333333"});nt.addWithUpdate(me),ke.add(nt),ke.setActiveObject(nt),ke.renderAll(),console.log("말풍선이 추가되었습니다.")},Pr=ue=>{if(console.log("프레임 클릭됨:",ue),!Et.current){console.error("Fabric.js 캔버스가 초기화되지 않았습니다.");return}const ke=Et.current,Me=ke.width/2,Oe=ke.height/2;let nt;switch(ue){case"simple":nt=new ol({left:Me-100,top:Oe-75,width:200,height:150,fill:"transparent",stroke:"#333333",strokeWidth:2});break;case"double":const gt=new ol({left:0,top:0,width:200,height:150,fill:"transparent",stroke:"#333333",strokeWidth:1}),Ae=new ol({left:10,top:10,width:180,height:130,fill:"transparent",stroke:"#333333",strokeWidth:1});nt=new hh([gt,Ae],{left:Me-100,top:Oe-75});break;case"dashed":nt=new ol({left:Me-100,top:Oe-75,width:200,height:150,fill:"transparent",stroke:"#333333",strokeWidth:2,strokeDashArray:[8,4]});break;case"rounded":nt=new ol({left:Me-100,top:Oe-75,width:200,height:150,rx:10,ry:10,fill:"transparent",stroke:"#333333",strokeWidth:2});break}nt&&(ke.add(nt),ke.setActiveObject(nt),ke.renderAll(),console.log("프레임이 추가되었습니다."))},ws=()=>{Et.current&&(Et.current.discardActiveObject(),Et.current.renderAll())};if(O.useEffect(()=>{const ue=ke=>{const Me=ke.target,Oe=Gi.current;if(Oe&&Oe.contains(Me))if(ke.ctrlKey||ke.metaKey){ke.preventDefault();const nt=ke.deltaY>0?-1:1;li(nt)}else ke.preventDefault()};return document.addEventListener("wheel",ue,{passive:!1,capture:!0}),()=>{document.removeEventListener("wheel",ue,{capture:!0})}},[]),O.useEffect(()=>{const ue=ke=>{ke.target.closest(`.${Qe.zoomPresetDropdown}`)||Le(!1)};if(Ie)return document.addEventListener("click",ue),()=>{document.removeEventListener("click",ue)}},[Ie]),O.useEffect(()=>{const ue=ke=>{ke.target.closest(`.${Qe.exportButtonWrapper}`)||ct(!1)};if(et)return document.addEventListener("click",ue),()=>{document.removeEventListener("click",ue)}},[et]),O.useEffect(()=>{const ue=ke=>{ke.target.closest(`.${Qe.paperSizeDropdown}`)||Je(!1)};if(le)return document.addEventListener("click",ue),()=>{document.removeEventListener("click",ue)}},[le]),!n)return null;const Vi=async()=>{if(Gi.current){h(!0);try{const ue=new Di({orientation:o,unit:"mm",format:[rn.width,rn.height]});ue.setFillColor(u),ue.rect(0,0,rn.width,rn.height,"F");for(const Me of p){const Oe=Me.id.split("_")[0],nt=Me.width*Me.scale*rn.width/rn.displayWidth,gt=Me.height*Me.scale*rn.height/rn.displayHeight,Ae=Me.x*rn.width/rn.displayWidth,me=Me.y*rn.height/rn.displayHeight;try{let Xe="front";if(Oe==="top")Xe="top";else if(Oe==="front")Xe="front";else if(Oe==="side")Xe="left";else if(Oe==="door")throw new Error("Door view는 벡터 렌더링 미지원");const qe={viewMode:"2D",view2DDirection:Xe,renderMode:"solid",showDimensions:!0,showGuides:!1,showAxis:!1,showAll:!1,spaceInfo:Ht,placedModules:dt},nn=2.83465,An={x:0,y:0,width:nt*nn,height:gt*nn},Ct=QBe(qe,An);if(Ct&&ue.svg){const kn=new DOMParser().parseFromString(Ct,"image/svg+xml").documentElement;ue.svg(kn,{x:Ae,y:me,width:nt,height:gt}),console.log(`✅ ${Oe} 뷰가 벡터로 렌더링되었습니다.`)}else throw new Error("SVG 렌더링 실패 또는 svg2pdf 미지원")}catch(Xe){console.warn("벡터 렌더링 실패, 래스터 이미지로 폴백:",Xe);let qe=null;if(Oe==="top"?qe=t==null?void 0:t.top:Oe==="front"?qe=t==null?void 0:t.front:Oe==="side"?qe=t==null?void 0:t.side:Oe==="door"&&(qe=t==null?void 0:t.door),qe||(qe=he[Me.id]),qe)try{ue.addImage(qe,"PNG",Ae,me,nt,gt),console.log(`⚠️ ${Oe} 뷰는 래스터 이미지로 렌더링되었습니다.`)}catch(nn){console.error("이미지 추가 실패:",nn)}else console.warn("이미지를 찾을 수 없음:",Oe,Me.id)}}for(const Me of p){const Oe=Me.id.split("_")[0];if(ET.some(gt=>gt.id===Oe)){const gt=Me.x*rn.width/rn.displayWidth,Ae=Me.y*rn.height/rn.displayHeight,me=Me.width*Me.scale*rn.width/rn.displayWidth,Xe=Me.height*Me.scale*rn.height/rn.displayHeight;if(ue.setFillColor("#2a2a2a"),ue.rect(gt,Ae,me,Xe,"F"),Oe==="info"){const qe=th();ue.setTextColor(qe),ue.setFontSize(18),ue.text("INSHOW",gt+5,Ae+10),ue.setTextColor("#ffffff"),ue.setFontSize(14),ue.text(ti.title,gt+5,Ae+20),ue.setFontSize(10),ue.setTextColor("#888888"),ue.text("Size:",gt+5,Ae+30),ue.setTextColor(qe),ue.text(ti.size,gt+20,Ae+30),ue.setTextColor("#888888"),ue.text("Door:",gt+5,Ae+37),ue.setTextColor(qe),ue.text(ti.door,gt+20,Ae+37),ue.setTextColor("#888888"),ue.text("Body:",gt+5,Ae+44),ue.setTextColor(qe),ue.text(ti.body,gt+20,Ae+44)}else if(Oe==="title")ue.setTextColor("#ffffff"),ue.setFontSize(16),ue.text(ti.title,gt+5,Ae+Xe/2);else if(Oe==="notes"&&ti.notes){ue.setTextColor("#cccccc"),ue.setFontSize(10);const qe=ue.splitTextToSize(ti.notes,me-10);ue.text(qe,gt+5,Ae+10)}}}const ke=`${$t||"furniture-design"}_${new Date().toISOString().split("T")[0]}.pdf`;ue.save(ke)}catch(ue){console.error("PDF 생성 실패:",ue),alert("PDF 생성에 실패했습니다.")}finally{h(!1)}}};return n?l.jsxs("div",{className:`${Qe.overlay} ${Ti.mode==="dark"?Qe.darkTheme:Qe.lightTheme}`,children:[l.jsxs("div",{className:Qe.fullContainer,children:[l.jsxs("div",{className:Qe.header,children:[l.jsx("h2",{children:"도면 에디터"}),l.jsxs("div",{className:Qe.controls,children:[l.jsxs("div",{className:Qe.zoomControls,children:[l.jsx("button",{className:Qe.zoomBtn,onClick:()=>li(-1),title:"축소 (Ctrl+-)",children:"−"}),l.jsx("input",{type:"range",min:"25",max:"200",value:te*100,onChange:ue=>{const ke=parseInt(ue.target.value)/100;fe(ke)},className:Qe.zoomSlider,title:"확대/축소"}),l.jsxs("span",{className:Qe.zoomValue,children:[(te*100).toFixed(0),"%"]}),l.jsx("button",{className:Qe.zoomBtn,onClick:()=>li(1),title:"확대 (Ctrl++)",children:"+"}),l.jsxs("div",{className:Qe.zoomPresetDropdown,children:[l.jsx("button",{className:Qe.zoomPresetButton,onClick:()=>Le(!Ie),title:"화면 크기 프리셋",children:l.jsx(lA,{size:16})}),Ie&&l.jsxs("div",{className:Qe.zoomPresetMenu,children:[l.jsx("button",{onClick:()=>{fe(.25),Le(!1)},children:"25%"}),l.jsx("button",{onClick:()=>{fe(.33),Le(!1)},children:"33%"}),l.jsx("button",{onClick:()=>{fe(.5),Le(!1)},children:"50%"}),l.jsx("button",{onClick:()=>{fe(.66),Le(!1)},children:"66%"}),l.jsx("button",{onClick:()=>{fe(.75),Le(!1)},children:"75%"}),l.jsx("button",{onClick:()=>{fe(1),Le(!1)},children:"100%"}),l.jsx("button",{onClick:()=>{fe(1.25),Le(!1)},children:"125%"}),l.jsx("button",{onClick:()=>{fe(1.5),Le(!1)},children:"150%"}),l.jsx("button",{onClick:()=>{fe(1.75),Le(!1)},children:"175%"}),l.jsx("button",{onClick:()=>{fe(2),Le(!1)},children:"200%"}),l.jsx("div",{className:Qe.zoomPresetDivider}),l.jsx("button",{onClick:()=>{const ue=document.querySelector(`.${Qe.previewContainer}`);if(ue){const ke=ue.clientWidth-80,Me=ue.clientHeight-80,Oe=rn.displayWidth,nt=rn.displayHeight,gt=ke/Oe,Ae=Me/nt;fe(Math.min(gt,Ae,2))}Le(!1)},children:"화면에 맞춤"})]})]})]}),l.jsxs("div",{className:Qe.paperSizeContainer,children:[l.jsx("label",{className:Qe.paperSizeLabel,children:"용지사이즈:"}),l.jsxs("div",{className:Qe.paperSizeDropdown,children:[l.jsxs("button",{className:Qe.paperSizeButton,onClick:()=>Je(!le),title:"용지 크기 선택",children:[r,l.jsx(lA,{size:16})]}),le&&l.jsx("div",{className:Qe.paperSizeMenu,children:["A5","A4","A3","A2","A1","A0"].map(ue=>l.jsxs("button",{className:r===ue?Qe.selected:"",onClick:()=>{s(ue),Je(!1)},children:[ue,l.jsx("span",{className:Qe.paperDimensions,children:o==="portrait"?`${sy[ue].width} × ${sy[ue].height} mm`:`${sy[ue].height} × ${sy[ue].width} mm`})]},ue))})]})]}),l.jsxs("div",{className:Qe.orientationButtons,children:[l.jsx("button",{className:`${Qe.orientButton} ${o==="landscape"?Qe.active:""}`,onClick:()=>a("landscape"),title:"가로 방향",children:l.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[l.jsx("rect",{x:"4",y:"7",width:"16",height:"10",rx:"2",stroke:"currentColor",strokeWidth:"2"}),l.jsx("circle",{cx:"20.5",cy:"12",r:"1",fill:"currentColor",opacity:"0.5"})]})}),l.jsx("button",{className:`${Qe.orientButton} ${o==="portrait"?Qe.active:""}`,onClick:()=>a("portrait"),title:"세로 방향",children:l.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[l.jsx("rect",{x:"7",y:"4",width:"10",height:"16",rx:"2",stroke:"currentColor",strokeWidth:"2"}),l.jsx("circle",{cx:"12",cy:"20.5",r:"1",fill:"currentColor",opacity:"0.5"})]})})]}),l.jsx("button",{className:Qe.actionButton,onClick:()=>setShowCanvasEditor(!0),title:"캔버스 에디터",children:l.jsx(ywe,{size:20})}),l.jsx("button",{className:Qe.actionButton,onClick:()=>Ve(!0),title:"설정",children:l.jsx($5,{size:20})}),l.jsxs("div",{className:Qe.exportButtonWrapper,children:[l.jsx("button",{onClick:()=>ct(!et),className:Qe.generateButton,disabled:c,children:c?"내보내는 중...":l.jsxs(l.Fragment,{children:[l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginRight:"6px"},children:[l.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),l.jsx("polyline",{points:"7 10 12 15 17 10"}),l.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),"내보내기"]})}),et&&l.jsxs("div",{className:Qe.exportPopup,children:[l.jsxs("div",{className:Qe.exportPopupHeader,children:[l.jsx("h4",{children:"파일 형식 선택"}),l.jsx("button",{className:Qe.exportPopupClose,onClick:()=>ct(!1),children:"×"})]}),l.jsxs("div",{className:Qe.exportFormatList,children:[l.jsxs("div",{className:`${Qe.exportFormatItem} ${mt==="pdf"?Qe.selected:""}`,onClick:()=>je("pdf"),children:[l.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[l.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("polyline",{points:"14 2 14 8 20 8",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("path",{d:"M10 12v4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),l.jsx("path",{d:"M10 12h2.5c.8 0 1.5.7 1.5 1.5S13.3 15 12.5 15H10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),l.jsx("span",{children:"PDF 문서"}),l.jsx("small",{children:"벡터 형식, 인쇄 품질"})]}),l.jsxs("div",{className:`${Qe.exportFormatItem} ${mt==="png"?Qe.selected:""}`,onClick:()=>je("png"),children:[l.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[l.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2",stroke:"currentColor",strokeWidth:"2"}),l.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5",fill:"currentColor"}),l.jsx("polyline",{points:"21 15 16 10 5 21",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),l.jsx("span",{children:"PNG 이미지"}),l.jsx("small",{children:"투명 배경 지원"})]}),l.jsxs("div",{className:`${Qe.exportFormatItem} ${mt==="jpg"?Qe.selected:""}`,onClick:()=>je("jpg"),children:[l.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[l.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2",stroke:"currentColor",strokeWidth:"2"}),l.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5",fill:"currentColor"}),l.jsx("polyline",{points:"21 15 16 10 5 21",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),l.jsx("span",{children:"JPG 이미지"}),l.jsx("small",{children:"작은 파일 크기"})]}),l.jsxs("div",{className:`${Qe.exportFormatItem} ${mt==="dxf"?Qe.selected:""}`,onClick:()=>je("dxf"),children:[l.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[l.jsx("path",{d:"M22 10v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-8",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("path",{d:"M2 10h20",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("path",{d:"M12 4v16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("path",{d:"M7 10V4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("path",{d:"M17 10V4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),l.jsx("span",{children:"DXF 파일"}),l.jsx("small",{children:"CAD 프로그램용"})]})]}),l.jsxs("div",{className:Qe.exportPopupFooter,children:[l.jsx("button",{className:Qe.exportButton,onClick:()=>{ct(!1),mt==="pdf"?Vi():alert(`${mt.toUpperCase()} 형식 내보내기는 준비 중입니다.`)},children:"내보내기"}),l.jsx("button",{className:Qe.cancelButton,onClick:()=>ct(!1),children:"취소"})]})]})]}),l.jsx("button",{onClick:e,className:Qe.closeButton,children:"나가기"})]})]}),l.jsxs("div",{className:Qe.bottomContainer,children:[l.jsxs("div",{className:Qe.sidebar,children:[l.jsxs("div",{className:Qe.tabButtons,children:[l.jsxs("button",{className:`${Qe.tabButton} ${Be==="views"?Qe.active:""}`,onClick:()=>Ye("views"),title:"레이아웃",children:[l.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[l.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",stroke:"currentColor",strokeWidth:"1.5"}),l.jsx("rect",{x:"8",y:"8",width:"4",height:"4",rx:"1",fill:"currentColor"}),l.jsx("rect",{x:"8",y:"14",width:"8",height:"2",rx:"1",fill:"currentColor"})]}),l.jsx("span",{className:Qe.tabLabel,children:"레이아웃"})]}),l.jsxs("button",{className:`${Qe.tabButton} ${Be==="elements"?Qe.active:""}`,onClick:()=>Ye("elements"),title:"요소",children:[l.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[l.jsx("circle",{cx:"9",cy:"9",r:"5",stroke:"currentColor",strokeWidth:"1.5"}),l.jsx("rect",{x:"12",y:"12",width:"8",height:"8",stroke:"currentColor",strokeWidth:"1.5"})]}),l.jsx("span",{className:Qe.tabLabel,children:"요소"})]}),l.jsxs("button",{className:`${Qe.tabButton} ${Be==="text"?Qe.active:""}`,onClick:()=>Ye("text"),title:"텍스트",children:[l.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:l.jsx("path",{d:"M4 7V4h16v3M12 4v16m-2 0h4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),l.jsx("span",{className:Qe.tabLabel,children:"텍스트"})]}),l.jsxs("button",{className:`${Qe.tabButton} ${Be==="upload"?Qe.active:""}`,onClick:()=>Ye("upload"),title:"업로드",children:[l.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[l.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("polyline",{points:"17 8 12 3 7 8",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),l.jsx("span",{className:Qe.tabLabel,children:"업로드"})]})]}),l.jsxs("div",{className:Qe.tabContent,children:[Be==="views"&&l.jsxs(l.Fragment,{children:[l.jsx("h3",{className:Qe.menuTitle,children:"레이아웃"}),l.jsxs("div",{className:Qe.subTabContainer,children:[l.jsx("button",{className:`${Qe.subTab} ${ht==="template"?Qe.active:""}`,onClick:()=>ut("template"),children:"템플릿"}),l.jsx("button",{className:`${Qe.subTab} ${ht==="2d"?Qe.active:""}`,onClick:()=>ut("2d"),children:"2D"}),l.jsx("button",{className:`${Qe.subTab} ${ht==="3d"?Qe.active:""}`,onClick:()=>ut("3d"),children:"3D"})]}),ht==="template"&&l.jsx("div",{className:Qe.templateContent,children:l.jsx("p",{className:Qe.placeholderText,children:"템플릿 옵션이 여기에 표시됩니다."})}),ht==="2d"&&l.jsx("div",{className:Qe.viewGrid,children:U7.map(ue=>l.jsxs("div",{className:Qe.viewMenuItem,onMouseDown:ke=>Fn(ue,ke),children:[l.jsx("div",{className:Qe.viewItemContent,children:t[ue.id]?l.jsx("img",{src:t[ue.id],alt:ue.label,draggable:!1}):l.jsx("div",{className:Qe.viewItemPlaceholder,children:ue.label})}),l.jsx("span",{className:Qe.viewItemLabel,children:ue.label})]},ue.id))}),ht==="3d"&&l.jsx("div",{className:Qe.view3dContent,children:l.jsx("p",{className:Qe.placeholderText,children:"3D 뷰 옵션이 여기에 표시됩니다."})})]}),Be==="elements"&&l.jsxs(l.Fragment,{children:[l.jsx("h3",{className:Qe.menuTitle,children:"요소"}),l.jsxs("div",{className:Qe.subTabScrollContainer,children:[l.jsx("button",{className:`${Qe.scrollButton} ${Qe.left} ${dn.canScrollLeft?"":Qe.disabled}`,onClick:()=>tt("left"),children:"‹"}),l.jsxs("div",{className:Qe.subTabWrapper,ref:Zt,children:[l.jsx("button",{className:`${Qe.subTab} ${ft==="shapes"?Qe.active:""}`,onClick:()=>jt("shapes"),children:"도형"}),l.jsx("button",{className:`${Qe.subTab} ${ft==="lines"?Qe.active:""}`,onClick:()=>jt("lines"),children:"선"}),l.jsx("button",{className:`${Qe.subTab} ${ft==="symbols"?Qe.active:""}`,onClick:()=>jt("symbols"),children:"기호"}),l.jsx("button",{className:`${Qe.subTab} ${ft==="balloons"?Qe.active:""}`,onClick:()=>jt("balloons"),children:"말풍선"}),l.jsx("button",{className:`${Qe.subTab} ${ft==="frames"?Qe.active:""}`,onClick:()=>jt("frames"),children:"프레임"})]}),l.jsx("button",{className:`${Qe.scrollButton} ${Qe.right} ${dn.canScrollRight?"":Qe.disabled}`,onClick:()=>tt("right"),children:"›"})]}),ft==="shapes"&&l.jsxs("div",{className:Qe.shapeGrid,children:[l.jsx("div",{className:Qe.shapeItem,onClick:()=>Jt('<rect x="2" y="2" width="20" height="20" fill="currentColor" />',"rectangle"),onMouseDown:ue=>{ue.preventDefault();const ke=ue.currentTarget.getBoundingClientRect();x({type:"shape",label:"Rectangle",shapeData:'<rect x="2" y="2" width="20" height="20" fill="currentColor" />',shapeType:"rectangle"}),m(!0),g({x:ue.clientX-ke.left,y:ue.clientY-ke.top}),b({x:ue.clientX-100,y:ue.clientY-75})},draggable:!1,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("rect",{x:"2",y:"2",width:"20",height:"20",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,onClick:()=>Jt('<rect x="2" y="2" width="20" height="20" rx="4" fill="currentColor" />',"rounded-rectangle"),onMouseDown:ue=>{ue.preventDefault();const ke=ue.currentTarget.getBoundingClientRect();x({type:"shape",label:"Rounded Rectangle",shapeData:'<rect x="2" y="2" width="20" height="20" rx="4" fill="currentColor" />',shapeType:"rounded-rectangle"}),m(!0),g({x:ue.clientX-ke.left,y:ue.clientY-ke.top}),b({x:ue.clientX-100,y:ue.clientY-75})},draggable:!1,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"4",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,onClick:()=>Jt('<circle cx="12" cy="12" r="10" fill="currentColor" />',"circle"),onMouseDown:ue=>{ue.preventDefault();const ke=ue.currentTarget.getBoundingClientRect();x({type:"shape",label:"Circle",shapeData:'<circle cx="12" cy="12" r="10" fill="currentColor" />',shapeType:"circle"}),m(!0),g({x:ue.clientX-ke.left,y:ue.clientY-ke.top}),b({x:ue.clientX-100,y:ue.clientY-75})},draggable:!1,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,onClick:()=>Jt('<ellipse cx="12" cy="12" rx="10" ry="6" fill="currentColor" />',"ellipse"),onMouseDown:ue=>{ue.preventDefault();const ke=ue.currentTarget.getBoundingClientRect();x({type:"shape",label:"Ellipse",shapeData:'<ellipse cx="12" cy="12" rx="10" ry="6" fill="currentColor" />',shapeType:"ellipse"}),m(!0),g({x:ue.clientX-ke.left,y:ue.clientY-ke.top}),b({x:ue.clientX-100,y:ue.clientY-75})},draggable:!1,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("ellipse",{cx:"12",cy:"12",rx:"10",ry:"6",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,onClick:()=>Jt('<polygon points="12,2 22,20 2,20" fill="currentColor" />',"triangle"),onMouseDown:ue=>{ue.preventDefault();const ke=ue.currentTarget.getBoundingClientRect();x({type:"shape",label:"Triangle",shapeData:'<polygon points="12,2 22,20 2,20" fill="currentColor" />',shapeType:"triangle"}),m(!0),g({x:ue.clientX-ke.left,y:ue.clientY-ke.top}),b({x:ue.clientX-100,y:ue.clientY-75})},draggable:!1,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("polygon",{points:"12,2 22,20 2,20",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,onClick:()=>Jt('<polygon points="2,12 8,6 22,6 22,18 8,18" fill="currentColor" />',"pentagon"),onMouseDown:ue=>{ue.preventDefault();const ke=ue.currentTarget.getBoundingClientRect();x({type:"shape",label:"Pentagon",shapeData:'<polygon points="2,12 8,6 22,6 22,18 8,18" fill="currentColor" />',shapeType:"pentagon"}),m(!0),g({x:ue.clientX-ke.left,y:ue.clientY-ke.top}),b({x:ue.clientX-100,y:ue.clientY-75})},draggable:!1,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("polygon",{points:"2,12 8,6 22,6 22,18 8,18",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,onClick:()=>Jt('<polygon points="2,12 8,6 16,6 22,12 16,18 8,18" fill="currentColor" />',"hexagon"),onMouseDown:ue=>{ue.preventDefault();const ke=ue.currentTarget.getBoundingClientRect();x({type:"shape",label:"Hexagon",shapeData:'<polygon points="2,12 8,6 16,6 22,12 16,18 8,18" fill="currentColor" />',shapeType:"hexagon"}),m(!0),g({x:ue.clientX-ke.left,y:ue.clientY-ke.top}),b({x:ue.clientX-100,y:ue.clientY-75})},draggable:!1,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("polygon",{points:"2,12 8,6 16,6 22,12 16,18 8,18",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("path",{d:"M12,3 Q7,3 7,8 Q7,10 9,10 Q9,8 11,8 Q11,10 12,10 Q13,10 15,10 Q17,10 17,8 Q17,3 12,3 Q17,3 17,8 Q17,13 12,13 Q7,13 7,8",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("path",{d:"M12,2 A10,10 0 0,1 12,22 A10,10 0 0,1 12,2",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,onClick:()=>Jt('<polygon points="12,2 15,9 22,9 17,14 19,21 12,17 5,21 7,14 2,9 9,9" fill="currentColor" />',"star"),onMouseDown:ue=>{ue.preventDefault();const ke=ue.currentTarget.getBoundingClientRect();x({type:"shape",label:"Star",shapeData:'<polygon points="12,2 15,9 22,9 17,14 19,21 12,17 5,21 7,14 2,9 9,9" fill="currentColor" />',shapeType:"star"}),m(!0),g({x:ue.clientX-ke.left,y:ue.clientY-ke.top}),b({x:ue.clientX-100,y:ue.clientY-75})},draggable:!1,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("polygon",{points:"12,2 15,9 22,9 17,14 19,21 12,17 5,21 7,14 2,9 9,9",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsxs("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:[l.jsx("ellipse",{cx:"12",cy:"14",rx:"8",ry:"6",fill:"currentColor"}),l.jsx("polygon",{points:"8,18 8,22 10,20",fill:"currentColor"})]})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("path",{d:"M12,4 C7,4 3,8 3,12 C3,16 7,20 12,20 C17,20 21,16 21,12 C21,8 17,4 12,4",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("polygon",{points:"2,12 9,6 22,10 15,16",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("polygon",{points:"12,2 14,10 22,10 16,14 18,22 12,18 6,22 8,14 2,10 10,10",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("polygon",{points:"4,4 20,4 16,20 8,20",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("path",{d:"M6,4 L18,4 Q22,4 22,8 L22,16 Q22,20 18,20 L6,20 Q2,20 2,16 L2,8 Q2,4 6,4",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("polygon",{points:"4,6 20,6 16,18 8,18",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("polygon",{points:"12,2 15,7 20,7 16,11 18,16 12,13 6,16 8,11 4,7 9,7",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("polygon",{points:"12,2 12,22 2,17 22,17",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("polygon",{points:"3,3 21,3 17,12 21,21 3,21 7,12",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("polygon",{points:"2,22 12,2 22,22",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("polygon",{points:"6,2 18,2 22,12 18,22 6,22 2,12",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("rect",{x:"4",y:"4",width:"16",height:"16",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsxs("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:[l.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",fill:"currentColor"}),l.jsx("rect",{x:"8",y:"18",width:"8",height:"4",fill:"currentColor"})]})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("polygon",{points:"12,2 16,8 22,8 18,13 20,20 12,16 4,20 6,13 2,8 8,8",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsxs("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:[l.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"currentColor"}),l.jsx("circle",{cx:"12",cy:"12",r:"6",fill:"white"}),l.jsx("circle",{cx:"12",cy:"12",r:"3",fill:"currentColor"})]})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("polygon",{points:"3,3 9,3 12,6 15,3 21,3 21,9 18,12 21,15 21,21 15,21 12,18 9,21 3,21 3,15 6,12 3,9",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsxs("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:[l.jsx("rect",{x:"10",y:"2",width:"4",height:"20",fill:"currentColor"}),l.jsx("rect",{x:"2",y:"10",width:"20",height:"4",fill:"currentColor"})]})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("polygon",{points:"12,2 17,7 22,12 17,17 12,22 7,17 2,12 7,7",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("polygon",{points:"5,3 19,3 21,12 19,21 5,21 3,12",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("polygon",{points:"2,3 8,3 12,7 16,3 22,3 22,9 18,12 22,15 22,21 16,21 12,17 8,21 2,21 2,15 6,12 2,9",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("polygon",{points:"7,2 17,2 22,12 17,22 7,22 2,12",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsxs("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:[l.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"currentColor"}),l.jsx("path",{d:"M12,2 A10,10 0 0,1 12,22 Z",fill:"white",opacity:"0.3"})]})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("polygon",{points:"12,2 16,6 20,6 20,10 24,12 20,14 20,18 16,18 12,22 8,18 4,18 4,14 0,12 4,10 4,6 8,6",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("polygon",{points:"12,2 22,12 12,22 2,12",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("polygon",{points:"2,12 7,7 12,12 17,7 22,12 17,17 12,12 7,17",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("polygon",{points:"4,2 20,2 22,8 18,22 6,22 2,8",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("polygon",{points:"5,2 12,5 19,2 22,9 19,16 22,22 16,19 12,22 8,19 2,22 5,16 2,9",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsxs("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:[l.jsx("rect",{x:"3",y:"3",width:"18",height:"18",fill:"currentColor"}),l.jsx("rect",{x:"6",y:"6",width:"12",height:"12",fill:"white"}),l.jsx("rect",{x:"9",y:"9",width:"6",height:"6",fill:"currentColor"})]})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("polygon",{points:"12,2 14,9 22,8 17,14 20,21 12,18 4,21 7,14 2,8 10,9",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsxs("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:[l.jsx("polygon",{points:"12,2 16,8 22,12 16,16 12,22 8,16 2,12 8,8",fill:"currentColor"}),l.jsx("polygon",{points:"12,6 14,10 18,12 14,14 12,18 10,14 6,12 10,10",fill:"white"})]})}),l.jsx("div",{className:Qe.shapeItem,children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("polygon",{points:"3,2 21,2 18,12 21,22 3,22 6,12",fill:"currentColor"})})})]}),ft==="lines"&&l.jsxs("div",{className:Qe.viewGrid,children:[l.jsx("div",{className:Qe.shapeItem,onClick:()=>wn("horizontal"),children:"━"}),l.jsx("div",{className:Qe.shapeItem,onClick:()=>wn("vertical"),children:"┃"}),l.jsx("div",{className:Qe.shapeItem,onClick:()=>wn("diagonal1"),children:"╱"}),l.jsx("div",{className:Qe.shapeItem,onClick:()=>wn("diagonal2"),children:"╲"})]}),ft==="symbols"&&l.jsxs("div",{className:Qe.viewGrid,children:[l.jsx("div",{className:Qe.shapeItem,onClick:()=>Xt("★"),onMouseDown:ue=>{ue.preventDefault();const ke=ue.currentTarget.getBoundingClientRect();x({type:"symbol",label:"★",symbol:"★"}),m(!0),g({x:ue.clientX-ke.left,y:ue.clientY-ke.top}),b({x:ue.clientX-100,y:ue.clientY-75})},draggable:!1,children:"★"}),l.jsx("div",{className:Qe.shapeItem,onClick:()=>Xt("♥"),onMouseDown:ue=>{ue.preventDefault();const ke=ue.currentTarget.getBoundingClientRect();x({type:"symbol",label:"♥",symbol:"♥"}),m(!0),g({x:ue.clientX-ke.left,y:ue.clientY-ke.top}),b({x:ue.clientX-100,y:ue.clientY-75})},draggable:!1,children:"♥"}),l.jsx("div",{className:Qe.shapeItem,onClick:()=>Xt("♦"),onMouseDown:ue=>{ue.preventDefault();const ke=ue.currentTarget.getBoundingClientRect();x({type:"symbol",label:"♦",symbol:"♦"}),m(!0),g({x:ue.clientX-ke.left,y:ue.clientY-ke.top}),b({x:ue.clientX-100,y:ue.clientY-75})},draggable:!1,children:"♦"}),l.jsx("div",{className:Qe.shapeItem,onClick:()=>Xt("♣"),onMouseDown:ue=>{ue.preventDefault();const ke=ue.currentTarget.getBoundingClientRect();x({type:"symbol",label:"♣",symbol:"♣"}),m(!0),g({x:ue.clientX-ke.left,y:ue.clientY-ke.top}),b({x:ue.clientX-100,y:ue.clientY-75})},draggable:!1,children:"♣"})]}),ft==="balloons"&&l.jsxs("div",{className:Qe.shapeGrid,children:[l.jsx("div",{className:Qe.shapeItem,onClick:()=>_i("left"),children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("path",{d:"M4,4 L20,4 Q22,4 22,6 L22,14 Q22,16 20,16 L8,16 L4,20 L4,16 Q2,16 2,14 L2,6 Q2,4 4,4",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,onClick:()=>_i("right"),children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("path",{d:"M4,4 L20,4 Q22,4 22,6 L22,14 Q22,16 20,16 L20,20 L16,16 L4,16 Q2,16 2,14 L2,6 Q2,4 4,4",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,onClick:()=>_i("top"),children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("path",{d:"M4,8 L20,8 Q22,8 22,10 L22,18 Q22,20 20,20 L4,20 Q2,20 2,18 L2,10 Q2,8 4,8 M12,8 L8,4 L16,4 Z",fill:"currentColor"})})}),l.jsx("div",{className:Qe.shapeItem,onClick:()=>_i("bottom"),children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("path",{d:"M4,4 L20,4 Q22,4 22,6 L22,14 Q22,16 20,16 L4,16 Q2,16 2,14 L2,6 Q2,4 4,4 M12,16 L8,20 L16,20 Z",fill:"currentColor"})})})]}),ft==="frames"&&l.jsxs("div",{className:Qe.shapeGrid,children:[l.jsx("div",{className:Qe.shapeItem,onClick:()=>Pr("simple"),children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("rect",{x:"2",y:"2",width:"20",height:"20",fill:"none",stroke:"currentColor",strokeWidth:"2"})})}),l.jsx("div",{className:Qe.shapeItem,onClick:()=>Pr("double"),children:l.jsxs("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:[l.jsx("rect",{x:"2",y:"2",width:"20",height:"20",fill:"none",stroke:"currentColor",strokeWidth:"1"}),l.jsx("rect",{x:"4",y:"4",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"1"})]})}),l.jsx("div",{className:Qe.shapeItem,onClick:()=>Pr("dashed"),children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("rect",{x:"2",y:"2",width:"20",height:"20",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"4 2"})})}),l.jsx("div",{className:Qe.shapeItem,onClick:()=>Pr("rounded"),children:l.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:l.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"4",fill:"none",stroke:"currentColor",strokeWidth:"2"})})})]})]}),Be==="text"&&l.jsxs(l.Fragment,{children:[l.jsx("h3",{className:Qe.menuTitle,children:"텍스트"}),l.jsxs("div",{className:Qe.viewGrid,children:[l.jsxs("div",{className:Qe.viewMenuItem,onClick:hi,style:{cursor:"pointer"},children:[l.jsx("div",{className:Qe.viewItemContent,children:l.jsx("div",{className:Qe.viewItemPlaceholder,children:"T"})}),l.jsx("span",{className:Qe.viewItemLabel,children:"텍스트 추가"})]}),ET.map(ue=>l.jsxs("div",{className:Qe.viewMenuItem,onMouseDown:ke=>Fn(ue,ke),children:[l.jsx("div",{className:Qe.viewItemContent,children:l.jsx("div",{className:Qe.viewItemPlaceholder,children:ue.label})}),l.jsx("span",{className:Qe.viewItemLabel,children:ue.label})]},ue.id))]})]}),Be==="upload"&&l.jsxs(l.Fragment,{children:[l.jsx("h3",{className:Qe.menuTitle,children:"업로드"}),l.jsxs("div",{className:Qe.uploadContent,children:[l.jsxs("div",{className:Qe.uploadArea,children:[l.jsx("input",{type:"file",id:"uploadInput",accept:"image/*,.pdf,.dxf",style:{display:"none"},onChange:async ue=>{var Me;const ke=(Me=ue.target.files)==null?void 0:Me[0];if(ke){const Oe=ke.name.toLowerCase(),nt=`file_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,gt=async Ae=>new Promise(me=>{if(Ae.type.startsWith("image/")){const Xe=new FileReader;Xe.onload=qe=>{var An;const nn=new Image;nn.onload=()=>{const Ct=document.createElement("canvas"),kn=Ct.getContext("2d"),fn=100,Qt=Math.min(fn/nn.width,fn/nn.height);Ct.width=nn.width*Qt,Ct.height=nn.height*Qt,kn==null||kn.drawImage(nn,0,0,Ct.width,Ct.height),me(Ct.toDataURL("image/jpeg",.7))},nn.src=(An=qe.target)==null?void 0:An.result},Xe.readAsDataURL(Ae)}else me(void 0)});if(Oe.endsWith(".dxf")){const Ae=new FileReader;Ae.onload=async me=>{var nn;const Xe=(nn=me.target)==null?void 0:nn.result,qe={id:nt,name:ke.name,type:"dxf",url:Xe,uploadDate:new Date};ot(An=>[...An,qe]),await Yn(ke)},Ae.readAsDataURL(ke)}else if(Oe.endsWith(".pdf")){const Ae=new FileReader;Ae.onload=me=>{var nn;const Xe=(nn=me.target)==null?void 0:nn.result,qe={id:nt,name:ke.name,type:"pdf",url:Xe,uploadDate:new Date};ot(An=>[...An,qe]),console.log("PDF 파일 추가됨:",ke.name)},Ae.readAsDataURL(ke)}else{const Ae=new FileReader;Ae.onload=async me=>{var Xe;if(Et.current&&((Xe=me.target)!=null&&Xe.result)){const qe=me.target.result,nn=await gt(ke),An={id:nt,name:ke.name,type:"image",thumbnail:nn,url:qe,uploadDate:new Date};ot(Ct=>[...Ct,An]),console.log("✅ 이미지가 업로드됨. 드래그해서 배치하세요.")}},Ae.readAsDataURL(ke)}}ue.target.value=""}}),l.jsxs("label",{htmlFor:"uploadInput",className:Qe.uploadButton,children:[l.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),l.jsx("polyline",{points:"17 8 12 3 7 8"}),l.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),l.jsx("span",{children:"파일 선택"}),l.jsx("small",{children:"이미지, PDF, DXF 파일 지원"})]})]}),$e.length>0&&l.jsxs("div",{className:Qe.uploadedFilesList,children:[l.jsx("h4",{className:Qe.uploadedFilesTitle,children:"업로드된 파일"}),l.jsx("div",{className:Qe.filesGrid,children:$e.map(ue=>l.jsxs("div",{className:Qe.fileItem,onMouseDown:ke=>{ke.preventDefault(),m(!0);const Me={id:ue.id,type:"uploaded-file",label:ue.name,uploadedFile:ue};x(Me);const Oe=(ue.type==="image",75),nt=75;g({x:Oe,y:nt}),b({x:ke.clientX-Oe,y:ke.clientY-nt})},style:{cursor:"grab"},children:[l.jsx("div",{className:Qe.fileThumbnail,children:ue.thumbnail?l.jsx("img",{src:ue.thumbnail,alt:ue.name,draggable:!1}):l.jsx("div",{className:Qe.fileIcon,children:ue.type==="pdf"?l.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[l.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),l.jsx("polyline",{points:"14 2 14 8 20 8"}),l.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),l.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),l.jsx("polyline",{points:"10 9 9 9 8 9"})]}):ue.type==="dxf"?l.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[l.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),l.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),l.jsx("line",{x1:"9",y1:"21",x2:"9",y2:"9"})]}):l.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[l.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),l.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),l.jsx("polyline",{points:"21 15 16 10 5 21"})]})})}),l.jsx("div",{className:Qe.fileName,title:ue.name,children:ue.name.length>15?`${ue.name.substring(0,12)}...`:ue.name}),l.jsxs("div",{className:Qe.fileActions,children:[l.jsx("div",{style:{fontSize:"11px",color:"#666"},children:"드래그해서 배치"}),l.jsx("button",{className:Qe.fileActionBtn,onClick:()=>{ot(ke=>ke.filter(Me=>Me.id!==ue.id))},title:"삭제",children:l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("polyline",{points:"3 6 5 6 21 6"}),l.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]},ue.id))})]})]})]})]})]}),l.jsx("div",{className:Qe.mainContainer,children:l.jsx("div",{className:Qe.contentWrapper,children:l.jsx("div",{className:Qe.previewContainer,children:l.jsxs("div",{className:Qe.rulerWrapper,style:{transform:`scale(${$n})`,transformOrigin:"center center"},children:[l.jsx("div",{className:Qe.rulerCorner,children:l.jsx("span",{style:{fontSize:"8px",color:"var(--theme-text)",opacity:.6},children:"mm"})}),l.jsx("div",{className:Qe.rulerHorizontal,onMouseDown:ue=>{const ke=ue.currentTarget.getBoundingClientRect(),Me=(ue.clientX-ke.left)/$n;se({type:"vertical",position:Me})},style:{cursor:"ns-resize",width:rn.displayWidth},children:l.jsx("svg",{width:rn.displayWidth,height:"20",style:{display:"block"},children:Array.from({length:Math.ceil(rn.width/5)+1},(ue,ke)=>{const Me=ke*5;if(Me>rn.width)return null;const Oe=Me*2,nt=Me%50===0,gt=Me%10===0;return l.jsxs("g",{children:[l.jsx("line",{x1:Oe,y1:nt?12:gt?16:18,x2:Oe,y2:20,stroke:"var(--theme-text)",strokeWidth:nt?1.5:gt?.8:.3,opacity:nt?1:gt?.6:.3}),nt&&l.jsx("text",{x:Oe,y:10,fontSize:"9",fill:"var(--theme-text)",textAnchor:"middle",style:{userSelect:"none"},children:Me})]},ke)})})}),l.jsx("div",{className:Qe.rulerVertical,onMouseDown:ue=>{const ke=ue.currentTarget.getBoundingClientRect(),Me=(ue.clientY-ke.top)/$n;se({type:"horizontal",position:Me})},style:{cursor:"ew-resize",height:rn.displayHeight},children:l.jsx("svg",{width:"20",height:rn.displayHeight,style:{display:"block"},children:Array.from({length:Math.ceil(rn.height/5)+1},(ue,ke)=>{const Me=ke*5;if(Me>rn.height)return null;const Oe=Me*2,nt=Me%50===0,gt=Me%10===0;return l.jsxs("g",{children:[l.jsx("line",{x1:nt?12:gt?16:18,y1:Oe,x2:20,y2:Oe,stroke:"var(--theme-text)",strokeWidth:nt?1.5:gt?.8:.3,opacity:nt?1:gt?.6:.3}),nt&&Me>0&&l.jsx("text",{x:10,y:Oe,fontSize:"9",fill:"var(--theme-text)",textAnchor:"middle",dominantBaseline:"middle",transform:`rotate(-90 10 ${Oe})`,style:{userSelect:"none"},children:Me})]},ke)})})}),l.jsx("div",{ref:Gi,className:Qe.previewContent,style:{width:`${rn.displayWidth}px`,height:`${rn.displayHeight}px`,backgroundColor:u},children:l.jsx("div",{className:Qe.drawingArea,ref:fi,onClick:ue=>{ue.target===ue.currentTarget&&(j(null),ws())},style:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center"},children:l.jsxs("div",{onClick:ue=>{ue.stopPropagation(),j(null),ws()},style:{position:"relative",width:rn.displayWidth,height:rn.displayHeight,backgroundColor:u,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",overflow:"visible",transformOrigin:"center"},children:[l.jsx("div",{ref:an,className:Qe.canvasContainer,"data-portrait":o==="portrait",style:{position:"absolute",top:0,left:0,width:rn.displayWidth,height:rn.displayHeight,zIndex:1,pointerEvents:"auto"}}),V.vertical.map((ue,ke)=>l.jsx("div",{className:Qe.alignmentGuideVertical,style:{left:`${ue}px`}},`v-${ke}`)),V.horizontal.map((ue,ke)=>l.jsx("div",{className:Qe.alignmentGuideHorizontal,style:{top:`${ue}px`}},`h-${ke}`)),z.vertical.map((ue,ke)=>l.jsx("div",{style:{position:"absolute",left:`${ue}px`,top:0,width:"1px",height:"100%",backgroundColor:"#00BFFF",opacity:.8,cursor:"ew-resize",zIndex:9},onMouseDown:Me=>{Me.preventDefault(),ie({type:"vertical",index:ke})},onDoubleClick:()=>{q(Me=>({...Me,vertical:Me.vertical.filter((Oe,nt)=>nt!==ke)}))}},`guide-v-${ke}`)),z.horizontal.map((ue,ke)=>l.jsx("div",{style:{position:"absolute",left:0,top:`${ue}px`,width:"100%",height:"1px",backgroundColor:"#00BFFF",opacity:.8,cursor:"ns-resize",zIndex:9},onMouseDown:Me=>{Me.preventDefault(),ie({type:"horizontal",index:ke})},onDoubleClick:()=>{q(Me=>({...Me,horizontal:Me.horizontal.filter((Oe,nt)=>nt!==ke)}))}},`guide-h-${ke}`)),p.length>0&&p.map(ue=>{var gt;const ke=ue.id.split("_")[0],Me=U7.find(Ae=>Ae.id===ke),Oe=t[ke],nt=ET.some(Ae=>Ae.id===ke);return console.log("🎨 뷰카드 렌더링:",{view:ue,viewType:ke,capturedImage:Oe,isTextItem:nt,type:ue.type,imageUrl:(gt=ue.imageUrl)==null?void 0:gt.substring(0,100)}),l.jsxs("div",{style:{position:"absolute",left:ue.x,top:ue.y,width:ue.width*ue.scale,height:ue.height*ue.scale,backgroundColor:Oe?"white":"#f5f5f5",border:T===ue.id?"2px solid #7c3aed":"1px solid #ccc",borderRadius:"4px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",zIndex:10,cursor:"move",overflow:"visible",transform:`rotate(${ue.rotation||0}deg)`,transformOrigin:"center"},onMouseDown:Ae=>{Ae.stopPropagation(),pt(ue.id,Ae)},onClick:Ae=>{Ae.stopPropagation()},onDoubleClick:()=>!nt&&vt(ue.id,ke),onWheel:Ae=>{if(T===ue.id){Ae.preventDefault(),Ae.stopPropagation();const me=Ae.deltaY>0?-.1:.1;mn(ue.id,me)}},children:[T===ue.id&&l.jsxs(l.Fragment,{children:[console.log("🔧 리사이즈 핸들 렌더링:",ue.id,ue.type),console.log("🔄 회전 핸들 표시 여부:",T===ue.id),l.jsx("div",{className:Qe.rotateHandle,onMouseDown:Ae=>Li(ue.id,Ae),title:"회전 (Shift: 15도 단위)",style:{position:"absolute",top:"-40px",left:"50%",transform:"translateX(-50%)",width:"28px",height:"28px",background:"#7c3aed",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",cursor:"grab",zIndex:100,boxShadow:"0 2px 6px rgba(0, 0, 0, 0.3)"},children:l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:[l.jsx("path",{d:"M23 4v6h-6"}),l.jsx("path",{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"})]})}),l.jsx("div",{className:`${Qe.resizeHandle} ${Qe.nw}`,onMouseDown:Ae=>bn(ue.id,"nw",Ae)}),l.jsx("div",{className:`${Qe.resizeHandle} ${Qe.n}`,onMouseDown:Ae=>bn(ue.id,"n",Ae)}),l.jsx("div",{className:`${Qe.resizeHandle} ${Qe.ne}`,onMouseDown:Ae=>bn(ue.id,"ne",Ae)}),l.jsx("div",{className:`${Qe.resizeHandle} ${Qe.w}`,onMouseDown:Ae=>bn(ue.id,"w",Ae)}),l.jsx("div",{className:`${Qe.resizeHandle} ${Qe.e}`,onMouseDown:Ae=>bn(ue.id,"e",Ae)}),l.jsx("div",{className:`${Qe.resizeHandle} ${Qe.sw}`,onMouseDown:Ae=>bn(ue.id,"sw",Ae)}),l.jsx("div",{className:`${Qe.resizeHandle} ${Qe.s}`,onMouseDown:Ae=>bn(ue.id,"s",Ae)}),l.jsx("div",{className:`${Qe.resizeHandle} ${Qe.se}`,onMouseDown:Ae=>bn(ue.id,"se",Ae)})]}),nt?l.jsxs("div",{className:Qe.textItemContent,children:[ke==="info"&&l.jsxs("div",{className:Qe.infoContent,children:[l.jsx("h3",{className:Qe.infoTitle,children:"INSHOW"}),Te===`${ue.id}_title`?l.jsx("input",{type:"text",value:ti.title,onChange:Ae=>ai({...ti,title:Ae.target.value}),onBlur:()=>Ce(null),onKeyDown:Ae=>Ae.key==="Enter"&&Ce(null),className:Qe.textInput,autoFocus:!0}):l.jsx("p",{onClick:()=>Ce(`${ue.id}_title`),children:ti.title}),l.jsxs("div",{className:Qe.infoSpecs,children:[l.jsxs("div",{className:Qe.infoSpecItem,children:[l.jsx("span",{children:"Size:"}),Te===`${ue.id}_size`?l.jsx("input",{type:"text",value:ti.size,onChange:Ae=>ai({...ti,size:Ae.target.value}),onBlur:()=>Ce(null),onKeyDown:Ae=>Ae.key==="Enter"&&Ce(null),className:Qe.textInput,autoFocus:!0}):l.jsx("span",{onClick:()=>Ce(`${ue.id}_size`),children:ti.size})]}),l.jsxs("div",{className:Qe.infoSpecItem,children:[l.jsx("span",{children:"Door:"}),Te===`${ue.id}_door`?l.jsx("input",{type:"text",value:ti.door,onChange:Ae=>ai({...ti,door:Ae.target.value}),onBlur:()=>Ce(null),onKeyDown:Ae=>Ae.key==="Enter"&&Ce(null),className:Qe.textInput,autoFocus:!0}):l.jsx("span",{onClick:()=>Ce(`${ue.id}_door`),children:ti.door})]}),l.jsxs("div",{className:Qe.infoSpecItem,children:[l.jsx("span",{children:"Body:"}),Te===`${ue.id}_body`?l.jsx("input",{type:"text",value:ti.body,onChange:Ae=>ai({...ti,body:Ae.target.value}),onBlur:()=>Ce(null),onKeyDown:Ae=>Ae.key==="Enter"&&Ce(null),className:Qe.textInput,autoFocus:!0}):l.jsx("span",{onClick:()=>Ce(`${ue.id}_body`),children:ti.body})]})]})]}),ke==="title"&&l.jsx("div",{className:Qe.titleContent,children:Te===ue.id?l.jsx("input",{type:"text",value:ti.title,onChange:Ae=>ai({...ti,title:Ae.target.value}),onBlur:()=>Ce(null),onKeyDown:Ae=>Ae.key==="Enter"&&Ce(null),className:Qe.textInput,autoFocus:!0}):l.jsx("h2",{onClick:()=>Ce(ue.id),children:ti.title})}),ke==="specs"&&l.jsxs("div",{className:Qe.specsContent,children:[l.jsx("h3",{children:"Specifications"}),l.jsxs("p",{children:["Size: ",ti.size]}),l.jsxs("p",{children:["Door: ",ti.door]}),l.jsxs("p",{children:["Body: ",ti.body]})]}),ke==="notes"&&l.jsx("div",{className:Qe.notesContent,children:Te===ue.id?l.jsx("textarea",{value:ti.notes||"",onChange:Ae=>ai({...ti,notes:Ae.target.value}),onBlur:()=>Ce(null),className:Qe.textAreaInput,placeholder:"메모를 입력하세요...",autoFocus:!0}):l.jsx("p",{onClick:()=>Ce(ue.id),children:ti.notes||"메모를 입력하세요..."})})]}):ue.type==="image"?l.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f9f9f9"},children:ue.imageUrl?l.jsx("img",{src:ue.imageUrl,alt:ue.fileName||"Image",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"},draggable:!1,onError:Ae=>{console.error("이미지 로드 실패:",ue.imageUrl),console.log("뷰 정보:",ue)},onLoad:()=>{console.log("✅ 이미지 로드 성공:",ue.fileName)}}):l.jsx("div",{style:{color:"#999",fontSize:"14px"},children:"이미지 없음"})}):ue.type==="pdf"?l.jsx("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"#ffffff",overflow:"hidden"},children:ue.imageUrl&&ue.hasDrawingData?l.jsx("img",{src:ue.imageUrl,alt:ue.fileName||"Vector View",style:{width:"100%",height:"100%",objectFit:"contain",pointerEvents:"none"}}):l.jsxs(l.Fragment,{children:[l.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#666",strokeWidth:"1.5",children:[l.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),l.jsx("polyline",{points:"14 2 14 8 20 8"}),l.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),l.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),l.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"8px",textAlign:"center",padding:"0 8px"},children:ue.fileName})]})}):ue.type==="dxf"?l.jsxs("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"#e8f4fd"},children:[l.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#0066cc",strokeWidth:"1.5",children:[l.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),l.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),l.jsx("line",{x1:"9",y1:"21",x2:"9",y2:"9"})]}),l.jsx("div",{style:{fontSize:"12px",color:"#0066cc",marginTop:"8px",textAlign:"center",padding:"0 8px"},children:ue.fileName})]}):l.jsxs("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative"},children:[Oe?l.jsx("img",{src:Oe,alt:Me==null?void 0:Me.label,style:{width:"100%",height:"100%",objectFit:"contain",pointerEvents:"none"},draggable:!1}):l.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"8px"},children:[l.jsx("div",{style:{fontSize:"24px",color:"#999"},children:ke==="front"?"👀":ke==="side"?"👁️":ke==="top"?"⬆️":ke==="iso"?"🔷":"📐"}),l.jsx("div",{style:{fontSize:"14px",fontWeight:"bold",color:"#666"},children:(Me==null?void 0:Me.label)||ke||"VIEW"})]}),Oe&&ue.hideTitle!==!0&&l.jsx("div",{style:{position:"absolute",top:"8px",left:"8px",fontSize:"12px",fontWeight:"bold",color:"#333",backgroundColor:"rgba(255,255,255,0.9)",padding:"4px 8px",borderRadius:"4px",boxShadow:"0 1px 2px rgba(0,0,0,0.1)"},children:(Me==null?void 0:Me.label)||ke||"VIEW"})]})]},ue.id)})]})})})]})})})}),l.jsx("div",{className:Qe.pagePreviewPanel,children:l.jsx("div",{className:Qe.pageListContainer,children:l.jsxs("div",{className:`${Qe.pageList} ${o==="portrait"?Qe.portraitList:""}`,children:[l.jsx("div",{className:`${Qe.pageItemWrapper} ${o==="portrait"?Qe.portrait:""}`,children:l.jsxs("div",{className:Qe.addPageCard,onClick:ui,title:"페이지 추가",children:[l.jsx("div",{className:Qe.addPageIcon,children:l.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[l.jsx("line",{x1:"12",y1:"6",x2:"12",y2:"18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),l.jsx("line",{x1:"6",y1:"12",x2:"18",y2:"12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})}),l.jsx("div",{className:Qe.addPageText,children:"페이지 추가"})]})}),_e.map((ue,ke)=>l.jsxs("div",{className:`${Qe.pageItemWrapper} ${o==="portrait"?Qe.portrait:""}`,children:[l.jsxs("div",{className:`${Qe.pageItem} ${ye===ke?Qe.active:""}`,onClick:()=>Mi(ke),children:[l.jsx("div",{className:Qe.pageNumber,children:ke+1}),l.jsx("div",{className:Qe.pageThumbnail,children:ye===ke&&Et.current?l.jsx("div",{style:{width:"100%",height:"100%",position:"relative",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:u},children:l.jsx("canvas",{ref:Me=>{if(Me&&Et.current){const Oe=Me.getContext("2d");if(Oe){const nt=o==="portrait"?90:145,gt=o==="portrait"?110:70,Ae=rn.displayWidth/rn.displayHeight,me=nt/gt;let Xe,qe;Ae>me?(Xe=nt,qe=nt/Ae):(qe=gt,Xe=gt*Ae),Me.width=Xe,Me.height=qe,Oe.fillStyle=u,Oe.fillRect(0,0,Me.width,Me.height),setTimeout(()=>{if(Et.current){const nn=Xe/rn.displayWidth,An=Et.current.toDataURL({format:"png",multiplier:nn}),Ct=new Image;Ct.onload=()=>{Oe.clearRect(0,0,Me.width,Me.height),Oe.fillStyle=u,Oe.fillRect(0,0,Me.width,Me.height),Oe.drawImage(Ct,0,0,Me.width,Me.height)},Ct.src=An}},100)}}},style:{maxWidth:"100%",maxHeight:"100%",width:"auto",height:"auto"}},`thumbnail-${ke}-${Y}-${o}`)}):ue.length>0?l.jsx("div",{className:Qe.pagePreview,children:ue.slice(0,3).map((Me,Oe)=>l.jsx("div",{className:Qe.miniView,style:{left:`${Me.x/rn.displayWidth*100}%`,top:`${Me.y/rn.displayHeight*100}%`,width:`${Me.width/rn.displayWidth*100}%`,height:`${Me.height/rn.displayHeight*100}%`}},Oe))}):l.jsx("div",{className:Qe.emptyPage,children:"빈 페이지"})})]}),_e.length>1&&l.jsx("button",{className:Qe.deletePageBtn,onClick:Me=>{Me.stopPropagation(),Gn(ke)},title:"페이지 삭제",children:"×"})]},ke))]})})})]})]}),v&&w&&D&&l.jsx("div",{style:{position:"fixed",left:`${D.x}px`,top:`${D.y}px`,width:w.type==="uploaded-file"?"150px":"200px",height:(w.type==="uploaded-file","150px"),border:`2px dashed ${th()}`,backgroundColor:`${th()}20`,pointerEvents:"none",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center",color:th(),fontSize:"14px",borderRadius:"8px"},children:w.type==="uploaded-file"&&w.uploadedFile?w.uploadedFile.thumbnail?l.jsx("img",{src:w.uploadedFile.thumbnail,alt:w.uploadedFile.name,style:{width:"80%",height:"80%",objectFit:"contain",opacity:.8}}):l.jsxs("div",{style:{textAlign:"center"},children:[w.uploadedFile.type==="pdf"?l.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[l.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),l.jsx("polyline",{points:"14 2 14 8 20 8"})]}):w.uploadedFile.type==="dxf"?l.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[l.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),l.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),l.jsx("line",{x1:"9",y1:"21",x2:"9",y2:"9"})]}):null,l.jsx("div",{style:{marginTop:"8px",fontSize:"12px"},children:w.uploadedFile.name.length>15?`${w.uploadedFile.name.substring(0,12)}...`:w.uploadedFile.name})]}):w.label}),ce.isOpen&&l.jsx("div",{className:`${Qe.viewerOverlay} ${Ti.mode==="dark"?Qe.darkTheme:Qe.lightTheme}`,children:l.jsxs("div",{className:Qe.viewerContainer,children:[l.jsxs("div",{className:Qe.viewerHeader,children:[l.jsxs("h3",{children:[i("export.drawingEditor")," - ",(Qr=ce.viewType)==null?void 0:Qr.toUpperCase()]}),l.jsx("button",{className:Qe.closeButton,onClick:()=>ne({isOpen:!1,viewId:null,viewType:null}),children:"✕"})]}),l.jsxs("div",{className:Qe.viewerSubHeader,children:[l.jsxs("div",{className:Qe.leftControls,children:[l.jsxs("div",{className:Qe.toggleGroup,children:[l.jsx("span",{className:`${Qe.toggleLabel} ${Qe.clickable}`,onClick:()=>{if(!at.showDimensions){at.setShowDimensions(!0),at.showAll||at.setShowAll(!0),at.showDimensionsText||at.setShowDimensionsText(!0),at.showGuides||at.setShowGuides(!0),at.showAxis||at.setShowAxis(!0);return}at.showAll||at.showDimensionsText||at.showGuides||at.showAxis?(at.showAll&&at.setShowAll(!1),at.showDimensionsText&&at.setShowDimensionsText(!1),at.showGuides&&at.setShowGuides(!1),at.showAxis&&at.setShowAxis(!1)):at.setShowDimensions(!1)},style:{cursor:"pointer"},children:at.showDimensions?"ON":"OFF"}),l.jsx("button",{className:`${Qe.switch} ${at.showDimensions?Qe.on:Qe.off}`,onClick:()=>{at.showDimensions?(at.setShowDimensions(!1),at.showAll&&at.setShowAll(!1),at.showDimensionsText&&at.setShowDimensionsText(!1),at.showGuides&&at.setShowGuides(!1),at.showAxis&&at.setShowAxis(!1)):at.setShowDimensions(!0)},children:l.jsx("div",{className:Qe.switchHandle})})]}),at.showDimensions?l.jsxs("div",{className:Qe.checkboxGroup,children:[l.jsxs("label",{className:Qe.checkboxLabel,children:[l.jsx("input",{type:"checkbox",checked:at.showDimensions&&at.showAll,onChange:ue=>at.setShowAll(ue.target.checked),className:Qe.checkbox}),l.jsx("span",{className:Qe.checkmark}),i("viewer.column")]}),l.jsxs("label",{className:Qe.checkboxLabel,children:[l.jsx("input",{type:"checkbox",checked:at.showDimensions&&at.showDimensionsText,onChange:ue=>at.setShowDimensionsText(ue.target.checked),className:Qe.checkbox}),l.jsx("span",{className:Qe.checkmark}),i("viewer.dimensions")]}),l.jsxs("label",{className:Qe.checkboxLabel,children:[l.jsx("input",{type:"checkbox",checked:at.showDimensions&&at.showGuides,onChange:ue=>at.setShowGuides(ue.target.checked),className:Qe.checkbox}),l.jsx("span",{className:Qe.checkmark}),i("viewer.grid")]}),l.jsxs("label",{className:Qe.checkboxLabel,children:[l.jsx("input",{type:"checkbox",checked:at.showDimensions&&at.showAxis,onChange:ue=>at.setShowAxis(ue.target.checked),className:Qe.checkbox}),l.jsx("span",{className:Qe.checkmark}),i("viewer.axis")]})]}):null]}),l.jsxs("div",{className:Qe.centerControls,children:[l.jsxs("div",{className:Qe.renderModeGroup,children:[l.jsx("button",{className:`${Qe.renderModeButton} ${En==="solid"?Qe.active:""}`,onClick:()=>Hn("solid"),children:"Solid"}),l.jsx("button",{className:`${Qe.renderModeButton} ${En==="wireframe"?Qe.active:""}`,onClick:()=>Hn("wireframe"),children:"Wireframe"})]}),l.jsxs("div",{className:Qe.viewModeGroup,children:[l.jsx("button",{className:`${Qe.viewModeButton} ${Ot==="3D"?Qe.active:""}`,onClick:()=>Rn("3D"),children:"3D"}),l.jsx("button",{className:`${Qe.viewModeButton} ${Ot==="2D"?Qe.active:""}`,onClick:()=>Rn("2D"),children:"2D"})]})]}),l.jsx("div",{className:Qe.rightControls,children:Ot==="2D"&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:Qe.viewDirectionGroup,children:["front","top","left","right"].map(ue=>l.jsx("button",{className:`${Qe.viewDirectionButton} ${Cn===ue?Qe.active:""}`,onClick:()=>xn(ue),children:ue},ue))}),l.jsx("button",{className:Qe.themeToggle,onClick:()=>at.toggleView2DTheme(),title:at.view2DTheme==="dark"?"라이트 모드로 전환":"다크 모드로 전환",children:at.view2DTheme==="dark"?l.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("circle",{cx:"12",cy:"12",r:"5"}),l.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),l.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),l.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),l.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),l.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),l.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),l.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),l.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]}):l.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})})]}),l.jsx("div",{ref:Oi,className:Qe.viewerContent,children:l.jsx(F5,{spaceInfo:Ht,viewMode:Ot,renderMode:En,showDimensions:at.showDimensions,showAll:at.showAll,showFrame:!0,showDimensionsText:at.showDimensionsText,showGuides:at.showGuides,showAxis:at.showAxis})}),l.jsxs("div",{className:Qe.viewerFooter,children:[l.jsx("button",{className:Qe.captureButton,onClick:kt,children:"삽입"}),l.jsx("button",{className:Qe.cancelButton,onClick:()=>ne({isOpen:!1,viewId:null,viewType:null}),children:"취소"})]})]})}),l.jsx(nF,{isOpen:rt,onClose:()=>Ve(!1)})]}):null},MIe=({isOpen:n,onClose:e})=>{Eo();const[t,i]=O.useState(!1),[r,s]=O.useState({}),[o,a]=O.useState(!1),[c,h]=O.useState("pdf"),[u,d]=O.useState("solid"),[f,A]=O.useState({"3d":!0,"2d-top":!0,"2d-front":!1,"2d-left":!1,"2d-right":!1}),[g,p]=O.useState(["front","plan"]),{exportToPDF:y,isExporting:v}=Oz(),{exportToZIP:m,canExportDXF:w,isExporting:x}=Q$(),T=qi(S=>S.spaceInfo),j=ci(S=>S.placedModules);if(!n)return null;const D=S=>{A(F=>({...F,[S]:!F[S]}))},b=S=>{p(F=>F.includes(S)?F.filter(B=>B!==S):[...F,S])},_=async()=>{if(console.log("📐 DXF 다운로드 버튼 클릭됨"),!T){alert("공간 정보가 없습니다. 먼저 공간을 설정해주세요.");return}if(g.length===0){alert("최소 하나 이상의 도면을 선택해주세요.");return}if(!w(T,j)){alert("DXF 내보내기를 할 수 없습니다. 가구를 배치해주세요.");return}try{const S=await m(T,j,g);S.success?(console.log("✅ DXF 다운로드 성공:",S.filename),setTimeout(()=>{e()},1e3)):(console.error("❌ DXF 다운로드 실패:",S.message),alert(`DXF 다운로드 실패: ${S.message}`))}catch(S){console.error("❌ DXF 다운로드 예외:",S),alert("DXF 다운로드 중 오류가 발생했습니다.")}},I=async()=>{if(console.log("📄 PDF 다운로드 버튼 클릭됨"),!T){alert("공간 정보가 없습니다. 먼저 공간을 설정해주세요.");return}const S=Object.entries(f).filter(([F,B])=>B).map(([F,B])=>F==="3d"?"3d-front":F);if(S.length===0){alert("최소 하나 이상의 뷰를 선택해주세요.");return}try{const F=await y(T,j,S,u);F.success?(console.log("✅ PDF 다운로드 성공:",F.filename),setTimeout(()=>{e()},1e3)):(console.error("❌ PDF 다운로드 실패:",F.message),alert(`PDF 다운로드 실패: ${F.message}`))}catch(F){console.error("❌ PDF 다운로드 예외:",F),alert("PDF 다운로드 중 오류가 발생했습니다.")}};return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:Zi.overlay,onClick:e,children:l.jsxs("div",{className:Zi.modal,onClick:S=>S.stopPropagation(),children:[l.jsxs("div",{className:Zi.header,children:[l.jsx("h2",{children:"내보내기"}),l.jsx("button",{className:Zi.closeButton,onClick:e,children:l.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[l.jsx("path",{d:"M18 6L6 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),l.jsx("path",{d:"M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})})]}),l.jsxs("div",{className:Zi.content,children:[l.jsxs("div",{className:Zi.section,children:[l.jsx("p",{className:Zi.sectionTitle,children:"현재 가구 배치를 도면 또는 PDF로 내보냅니다"}),l.jsxs("div",{className:Zi.formatTabs,children:[l.jsx("button",{className:`${Zi.formatTab} ${c==="dxf"?Zi.active:""}`,onClick:()=>h("dxf"),children:"CAD 도면 (DXF)"}),l.jsx("button",{className:`${Zi.formatTab} ${c==="pdf"?Zi.active:""}`,onClick:()=>h("pdf"),children:"PDF 문서"})]})]}),c==="dxf"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:Zi.section,children:[l.jsx("h3",{className:Zi.sectionHeader,children:"포함할 도면 선택"}),l.jsxs("div",{className:Zi.viewList,children:[l.jsxs("label",{className:`${Zi.viewOption} ${g.includes("front")?Zi.selected:""}`,children:[l.jsx("input",{type:"checkbox",checked:g.includes("front"),onChange:()=>b("front")}),l.jsx("span",{children:"정면도"}),l.jsx("span",{className:Zi.viewDescription,children:"정면에서 본 도면"})]}),l.jsxs("label",{className:`${Zi.viewOption} ${g.includes("plan")?Zi.selected:""}`,children:[l.jsx("input",{type:"checkbox",checked:g.includes("plan"),onChange:()=>b("plan")}),l.jsx("span",{children:"평면도"}),l.jsx("span",{className:Zi.viewDescription,children:"위에서 본 도면"})]}),l.jsxs("label",{className:`${Zi.viewOption} ${g.includes("side")?Zi.selected:""}`,children:[l.jsx("input",{type:"checkbox",checked:g.includes("side"),onChange:()=>b("side")}),l.jsx("span",{children:"측면도"}),l.jsx("span",{className:Zi.viewDescription,children:"측면에서 본 도면"})]})]})]}),l.jsx("button",{className:Zi.downloadButton,onClick:_,disabled:x||g.length===0||!w(T,j),children:x?"처리 중...":`DXF ZIP 다운로드 (${g.length}개 도면)`})]}),c==="pdf"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:Zi.section,children:[l.jsx("h3",{className:Zi.sectionHeader,children:"렌더링 모드"}),l.jsxs("div",{className:Zi.renderModes,children:[l.jsxs("label",{className:`${Zi.renderMode} ${u==="solid"?Zi.active:""}`,children:[l.jsx("input",{type:"radio",name:"renderMode",value:"solid",checked:u==="solid",onChange:S=>d(S.target.value)}),l.jsxs("div",{className:Zi.renderModeContent,children:[l.jsx("h4",{children:"솔리드"}),l.jsx("p",{children:"재질과 색상이 표현됩니다"})]})]}),l.jsxs("label",{className:`${Zi.renderMode} ${u==="wireframe"?Zi.active:""}`,children:[l.jsx("input",{type:"radio",name:"renderMode",value:"wireframe",checked:u==="wireframe",onChange:S=>d(S.target.value)}),l.jsxs("div",{className:Zi.renderModeContent,children:[l.jsx("h4",{children:"와이어프레임"}),l.jsx("p",{children:"구조만 표현됩니다"})]})]})]})]}),l.jsxs("div",{className:Zi.section,children:[l.jsx("h3",{className:Zi.sectionHeader,children:"포함할 뷰 선택"}),l.jsxs("div",{className:Zi.viewList,children:[l.jsxs("label",{className:`${Zi.viewOption} ${f["3d"]?Zi.selected:""}`,children:[l.jsx("input",{type:"checkbox",checked:f["3d"],onChange:()=>D("3d")}),l.jsx("span",{children:"3D 정면뷰"})]}),l.jsxs("label",{className:`${Zi.viewOption} ${f["2d-top"]?Zi.selected:""}`,children:[l.jsx("input",{type:"checkbox",checked:f["2d-top"],onChange:()=>D("2d-top")}),l.jsx("span",{children:"2D 평면도 (위에서 본 뷰)"}),l.jsx("button",{className:Zi.viewDetail,children:"치수 포함"})]}),l.jsxs("label",{className:`${Zi.viewOption} ${f["2d-front"]?Zi.selected:""}`,children:[l.jsx("input",{type:"checkbox",checked:f["2d-front"],onChange:()=>D("2d-front")}),l.jsx("span",{children:"2D 정면도 (앞에서 본 뷰)"}),l.jsx("button",{className:Zi.viewDetail,children:"치수 포함"})]}),l.jsxs("label",{className:`${Zi.viewOption} ${f["2d-left"]?Zi.selected:""}`,children:[l.jsx("input",{type:"checkbox",checked:f["2d-left"],onChange:()=>D("2d-left")}),l.jsx("span",{children:"2D 좌측면도 (왼쪽에서 본 뷰)"}),l.jsx("button",{className:Zi.viewDetail,children:"치수 포함"})]}),l.jsxs("label",{className:`${Zi.viewOption} ${f["2d-right"]?Zi.selected:""}`,children:[l.jsx("input",{type:"checkbox",checked:f["2d-right"],onChange:()=>D("2d-right")}),l.jsx("span",{children:"2D 우측면도 (오른쪽에서 본 뷰)"}),l.jsx("button",{className:Zi.viewDetail,children:"치수 포함"})]})]})]}),l.jsx("button",{className:Zi.downloadButton,onClick:I,disabled:v||Object.values(f).every(S=>!S),children:v?"처리 중...":`PDF 다운로드 (${Object.values(f).filter(S=>S).length}개 뷰)`})]})]})]})}),l.jsx(zX,{isOpen:t,onClose:()=>{i(!1),e()},capturedViews:r})]})},RIe=({spaceInfo:n,onUpdate:e})=>{const{t}=Kv();console.log("🏢 InstallTypeControls - 현재 installType:",n.installType),console.log("🏢 InstallTypeControls - 현재 wallConfig:",n.wallConfig);const i=s=>{var c,h,u;let o={...n.wallConfig};switch(s){case"builtin":o={left:!0,right:!0};break;case"semistanding":o={left:!0,right:!1};break;case"freestanding":o={left:!1,right:!1};break}const a={installType:s,wallConfig:o};n.surroundType==="no-surround"&&(s==="semistanding"||s==="freestanding")&&(a.gapConfig={left:0,right:0}),n.surroundType==="surround"?s==="builtin"?a.frameSize={left:50,right:50,top:((c=n.frameSize)==null?void 0:c.top)||10}:s==="semistanding"?a.frameSize={left:o.left?50:20,right:o.right?50:20,top:((h=n.frameSize)==null?void 0:h.top)||10}:s==="freestanding"&&(a.frameSize={left:20,right:20,top:((u=n.frameSize)==null?void 0:u.top)||10}):n.surroundType==="no-surround"&&(a.frameSize={left:0,right:0,top:0},n.gapConfig,a.gapConfig={left:o.left?2:20,right:o.right?2:20}),console.log("🏢 InstallTypeControls - updating with:",a),e(a)},r=s=>{var c,h;const o={left:s==="left",right:s==="right"},a={wallConfig:o};n.surroundType==="no-surround"&&(o.left&&o.right?a.gapConfig={left:((c=n.gapConfig)==null?void 0:c.left)||2,right:((h=n.gapConfig)==null?void 0:h.right)||2}:a.gapConfig={left:0,right:0},a.frameSize={left:0,right:0,top:0}),console.log("🏢 InstallTypeControls - wallConfig 변경:",{newWallConfig:o,gapConfig:a.gapConfig,surroundType:n.surroundType}),e(a)};return l.jsxs("div",{className:yi.container,children:[l.jsx("div",{className:yi.section,children:l.jsxs("div",{className:yi.toggleButtonGroup,children:[l.jsx("button",{className:`${yi.toggleButton} ${n.installType==="builtin"?yi.toggleButtonActive:""}`,onClick:()=>i("builtin"),title:t("space.builtinDesc"),children:t("space.builtin")}),l.jsx("button",{className:`${yi.toggleButton} ${n.installType==="semistanding"?yi.toggleButtonActive:""}`,onClick:()=>i("semistanding"),title:t("space.semistandingDesc"),children:t("space.semistanding")}),l.jsx("button",{className:`${yi.toggleButton} ${n.installType==="freestanding"?yi.toggleButtonActive:""}`,onClick:()=>i("freestanding"),title:t("space.freestandingDesc"),children:t("space.freestanding")})]})}),n.installType==="semistanding"&&l.jsxs("div",{className:yi.section,children:[l.jsx("span",{className:yi.label,children:t("space.wallPosition")}),l.jsxs("div",{className:yi.toggleButtonGroup,children:[l.jsx("button",{className:`${yi.toggleButton} ${n.wallConfig.left?yi.toggleButtonActive:""}`,onClick:()=>r("left"),children:t("furniture.left")}),l.jsx("button",{className:`${yi.toggleButton} ${n.wallConfig.right?yi.toggleButtonActive:""}`,onClick:()=>r("right"),children:t("furniture.right")})]})]})]})},OIe=({spaceInfo:n,onUpdate:e})=>{var u,d,f,A,g,p;const{t}=Eo(),[i,r]=O.useState(((d=(u=n.floorFinish)==null?void 0:u.height)==null?void 0:d.toString())||"9");O.useEffect(()=>{var y,v;r(((v=(y=n.floorFinish)==null?void 0:y.height)==null?void 0:v.toString())||"9")},[(f=n.floorFinish)==null?void 0:f.height]);const s=y=>{if(y)e({hasFloorFinish:!1,floorFinish:void 0});else{const v=parseInt(i)||9;e({hasFloorFinish:!0,floorFinish:{height:v}})}},o=y=>{(y===""||/^\d+$/.test(y))&&r(y)},a=()=>{const y=i;if(y===""){r("9");return}const v=parseInt(y);v>=5&&v<=100?e({hasFloorFinish:!0,floorFinish:{height:v}}):(r("9"),e({hasFloorFinish:!0,floorFinish:{height:9}}))},c=y=>{y.key==="Enter"&&a()};n.hasFloorFinish?n.height-(((A=n.floorFinish)==null?void 0:A.height)||0):n.height;const h=((g=n.baseConfig)==null?void 0:g.placementType)==="float"&&(((p=n.baseConfig)==null?void 0:p.floatHeight)||0)>0;return O.useEffect(()=>{h&&n.hasFloorFinish&&e({hasFloorFinish:!1,floorFinish:void 0})},[h]),h?l.jsx("div",{className:yi.container,children:l.jsx("div",{className:yi.section,children:l.jsx("p",{className:yi.disabledMessage,children:t("space.floorFinishDisabledForFloat")||"띄워서 배치 시 바닥마감재 설정이 비활성화됩니다."})})}):l.jsxs("div",{className:yi.container,children:[l.jsx("div",{className:yi.section,children:l.jsxs("div",{className:yi.toggleButtonGroup,children:[l.jsx("button",{className:`${yi.toggleButton} ${n.hasFloorFinish?yi.toggleButtonActive:""}`,onClick:()=>s(!1),children:t("common.enabled")}),l.jsx("button",{className:`${yi.toggleButton} ${n.hasFloorFinish?"":yi.toggleButtonActive}`,onClick:()=>s(!0),children:t("common.none")})]})}),n.hasFloorFinish&&l.jsxs("div",{className:yi.section,children:[l.jsx("label",{className:yi.label,children:t("space.floorFinishThickness")}),l.jsxs("div",{className:yi.inputWrapper,children:[l.jsx("input",{type:"text",className:yi.input,value:i,onChange:y=>o(y.target.value),onBlur:a,onKeyDown:c,placeholder:"5-100"}),l.jsx("span",{className:yi.unit,children:"mm"})]})]})]})},UIe="_configSection_14zx7_2",HIe="_sectionHeader_14zx7_13",WIe="_sectionDot_14zx7_20",QIe="_sectionTitle_14zx7_38",$Ie="_content_14zx7_47",VIe="_gapGrid_14zx7_61",zIe="_gapItem_14zx7_67",GIe="_gapLabel_14zx7_73",XIe="_gapControl_14zx7_81",KIe="_disabled_14zx7_92",qIe="_controlButton_14zx7_109",YIe="_gapInput_14zx7_110",ma={configSection:UIe,sectionHeader:HIe,sectionDot:WIe,sectionTitle:QIe,content:$Ie,gapGrid:VIe,gapItem:zIe,gapLabel:GIe,gapControl:XIe,disabled:KIe,controlButton:qIe,gapInput:YIe},ZIe=({spaceInfo:n,onUpdate:e})=>{var f,A,g,p,y,v;const{t}=Eo(),[i,r]=O.useState(((f=n==null?void 0:n.gapConfig)==null?void 0:f.left)||2),[s,o]=O.useState(((A=n==null?void 0:n.gapConfig)==null?void 0:A.right)||2);if(O.useEffect(()=>{var m,w;r(((m=n==null?void 0:n.gapConfig)==null?void 0:m.left)||2),o(((w=n==null?void 0:n.gapConfig)==null?void 0:w.right)||2)},[n==null?void 0:n.gapConfig]),!n||n.surroundType!=="no-surround")return null;const a=((g=n.wallConfig)==null?void 0:g.left)??!0,c=((p=n.wallConfig)==null?void 0:p.right)??!0;if(!(a&&c))return(((y=n.gapConfig)==null?void 0:y.left)!==0||((v=n.gapConfig)==null?void 0:v.right)!==0)&&e({gapConfig:{left:0,right:0}}),null;const h=(m,w)=>{const x={...n.gapConfig,[m]:w};e({gapConfig:x})},u=(m,w)=>{const x=parseInt(w)||0;m==="left"?r(x):o(x)},d=m=>{const x=Math.max(0,Math.min(50,m==="left"?i:s));m==="left"?r(x):o(x),h(m,x)};return l.jsxs("div",{className:ma.configSection,children:[l.jsxs("div",{className:ma.sectionHeader,children:[l.jsx("span",{className:ma.sectionDot}),l.jsx("h3",{className:ma.sectionTitle,children:t("placement.wallOffset")})]}),l.jsx("div",{className:ma.content,children:l.jsxs("div",{className:ma.gapGrid,children:[l.jsxs("div",{className:ma.gapItem,children:[l.jsxs("label",{className:ma.gapLabel,children:[t("placement.leftGap"),!a&&` (${t("placement.noWall")})`]}),l.jsxs("div",{className:`${ma.gapControl} ${a?"":ma.disabled}`,children:[l.jsx("button",{className:ma.controlButton,disabled:!a,onClick:()=>{if(a){const m=Math.max(0,i-1);r(m),h("left",m)}},children:"−"}),l.jsx("input",{type:"number",value:a?i:0,onChange:m=>a&&u("left",m.target.value),onBlur:()=>a&&d("left"),className:ma.gapInput,min:"0",max:"50",disabled:!a}),l.jsx("button",{className:ma.controlButton,disabled:!a,onClick:()=>{if(a){const m=Math.min(50,i+1);r(m),h("left",m)}},children:"+"})]})]}),l.jsxs("div",{className:ma.gapItem,children:[l.jsxs("label",{className:ma.gapLabel,children:[t("placement.rightGap"),!c&&` (${t("placement.noWall")})`]}),l.jsxs("div",{className:`${ma.gapControl} ${c?"":ma.disabled}`,children:[l.jsx("button",{className:ma.controlButton,disabled:!c,onClick:()=>{if(c){const m=Math.max(0,s-1);o(m),h("right",m)}},children:"−"}),l.jsx("input",{type:"number",value:c?s:0,onChange:m=>c&&u("right",m.target.value),onBlur:()=>c&&d("right"),className:ma.gapInput,min:"0",max:"50",disabled:!c}),l.jsx("button",{className:ma.controlButton,disabled:!c,onClick:()=>{if(c){const m=Math.min(50,s+1);o(m),h("right",m)}},children:"+"})]})]})]})})]})},JIe=({baseConfig:n,onBaseTypeChange:e,disabled:t=!1})=>{const{t:i}=Eo(),r=(n==null?void 0:n.type)==="floor"||!n,s=(n==null?void 0:n.type)==="stand";return l.jsx("div",{className:yi.section,children:l.jsxs("div",{className:yi.toggleButtonGroup,children:[l.jsx("button",{className:`${yi.toggleButton} ${r?yi.toggleButtonActive:""}`,onClick:()=>e("floor"),disabled:t,children:i("placement.floor")}),l.jsx("button",{className:`${yi.toggleButton} ${s?yi.toggleButtonActive:""}`,onClick:()=>e("stand"),disabled:t,children:i("placement.float")})]})})},eFe=({baseConfig:n,baseHeight:e,floatHeight:t,onPlacementTypeChange:i,onHeightChange:r,onFloatHeightChange:s,onHeightBlur:o,onFloatHeightBlur:a,onKeyDown:c,onFloatKeyDown:h,disabled:u=!1})=>{const{t:d}=Eo(),{setHighlightedFrame:f}=Bi(),A=(n==null?void 0:n.type)==="floor"||!n,g=(n==null?void 0:n.type)==="stand";n==null||n.placementType,n==null||n.placementType;const p=()=>{f("base")},y=()=>{f(null),o()},v=()=>{f(null),a()};return l.jsxs(l.Fragment,{children:[A&&l.jsxs("div",{className:yi.section,children:[l.jsx("span",{className:yi.label,children:d("frame.baseHeight")}),l.jsx("div",{className:yi.inputWrapper,children:l.jsxs("div",{className:yi.inputWithUnit,children:[l.jsx("input",{type:"text",value:e,onChange:m=>{console.log("🔧 PlacementControls - input onChange 호출됨:",m.target.value),r(m.target.value)},onInput:m=>{console.log("🔧 PlacementControls - input onInput 호출됨:",m.currentTarget.value)},onClick:m=>{console.log("🔧 PlacementControls - input onClick 호출됨, disabled:",u)},onFocus:p,onBlur:y,onKeyDown:c,className:`${yi.input} ${yi.inputWithUnitField}`,placeholder:"65",disabled:u}),l.jsx("span",{className:yi.unit,children:"mm"})]})})]}),g&&l.jsxs("div",{className:yi.section,children:[l.jsx("span",{className:yi.label,children:d("frame.floatHeight")}),l.jsx("div",{className:yi.inputWrapper,children:l.jsxs("div",{className:yi.inputWithUnit,children:[l.jsx("input",{type:"text",value:t,onChange:m=>s(m.target.value),onFocus:p,onBlur:v,onKeyDown:h,className:`${yi.input} ${yi.inputWithUnitField}`,placeholder:"60",disabled:u}),l.jsx("span",{className:yi.unit,children:"mm"})]})})]})]})},tFe=({spaceInfo:n,onUpdate:e,disabled:t=!1})=>{var y;console.log("🔧 BaseControls - disabled 상태:",t);const i=()=>{var m;const v=((m=n.baseConfig)==null?void 0:m.height)||65;if(n.hasFloorFinish&&n.floorFinish){const w=n.floorFinish.height||0;return Math.max(0,v-w)}return v},[r,s]=O.useState(String(i())),[o,a]=O.useState(String(((y=n.baseConfig)==null?void 0:y.floatHeight)||60));O.useEffect(()=>{s(String(i())),n.baseConfig&&a(String(n.baseConfig.floatHeight||60))},[n.baseConfig,n.hasFloorFinish,n.floorFinish]);const c=v=>{const m=n.baseConfig||{type:"floor",height:65};v==="stand"?(a("200"),e({baseConfig:{...m,type:v,placementType:"float",floatHeight:200},hasFloorFinish:!1,floorFinish:void 0})):e({baseConfig:{...m,type:v,placementType:"ground",height:m.height||65}})},h=v=>{const m=n.baseConfig||{type:"stand",height:65};e(v==="float"?{baseConfig:{...m,placementType:v,floatHeight:m.floatHeight||60},hasFloorFinish:!1,floorFinish:void 0}:{baseConfig:{...m,placementType:v}})},u=v=>{var m;if(console.log("🔧 BaseControls - handleHeightChange 호출됨:",v),v===""||/^\d+$/.test(v)){if(console.log("🔧 BaseControls - 입력값 검증 통과:",v),s(v),v==="")return;if(!isNaN(Number(v))){let w=parseInt(v);if(n.hasFloorFinish&&n.floorFinish){const T=n.floorFinish.height||0;w=w+T}const x=n.baseConfig||{type:"floor",height:65};console.log("🔧 BaseControls - store 업데이트:",{표시값:v,저장값:w,바닥마감재:((m=n.floorFinish)==null?void 0:m.height)||0}),e({baseConfig:{...x,height:w}})}}else console.log("🔧 BaseControls - 입력값 검증 실패:",v)},d=v=>{if(v===""||/^\d+$/.test(v)){if(a(v),v==="")return;if(!isNaN(Number(v))){const m=parseInt(v),w=n.baseConfig||{type:"stand",height:0,floatHeight:60};e({baseConfig:{...w,floatHeight:m}})}}},f=()=>{const v=n.baseConfig||{type:"floor",height:65};let m=r;typeof m=="string"&&(m=m===""?65:parseInt(m)),m<50&&(m=50),m>500&&(m=500),s(m);let w=m;if(n.hasFloorFinish&&n.floorFinish){const x=n.floorFinish.height||0;w=m+x}w!==v.height&&e({baseConfig:{...v,height:w}})},A=()=>{const v=n.baseConfig||{type:"stand",height:0,floatHeight:60};let m=o;typeof m=="string"&&(m=m===""?60:parseInt(m)),m<0&&(m=0),m>200&&(m=200),a(m),m!==v.floatHeight&&e({baseConfig:{...v,floatHeight:m}})},g=v=>{v.key==="Enter"&&f()},p=v=>{v.key==="Enter"&&A()};return l.jsxs("div",{className:yi.container,children:[l.jsx(JIe,{baseConfig:n.baseConfig,onBaseTypeChange:c,disabled:t}),l.jsx(eFe,{baseConfig:n.baseConfig,baseHeight:r,floatHeight:o,onPlacementTypeChange:h,onHeightChange:u,onFloatHeightChange:d,onHeightBlur:f,onFloatHeightBlur:A,onKeyDown:g,onFloatKeyDown:p,disabled:t})]})},nFe="_configurator_sg3w3_2",iFe="_mainContent_sg3w3_12",rFe="_fileTreeOverlay_sg3w3_20",sFe="_fileTreePanel_sg3w3_32",oFe="_preparingPanel_sg3w3_47",aFe="_leftPanelToggle_sg3w3_71",lFe="_open_sg3w3_93",cFe="_rightPanelContainer_sg3w3_103",hFe="_rightPanelToggle_sg3w3_114",uFe="_sidebarContent_sg3w3_207",dFe="_sidebarPanel_sg3w3_229",AFe="_modulePanelContent_sg3w3_237",fFe="_moduleCategoryTabs_sg3w3_339",pFe="_moduleCategoryTab_sg3w3_339",gFe="_active_sg3w3_374",mFe="_moduleSection_sg3w3_430",yFe="_viewerArea_sg3w3_438",vFe="_viewer_sg3w3_438",wFe="_viewerDoorToggle_sg3w3_463",xFe="_viewerDoorButton_sg3w3_477",bFe="_rightPanel_sg3w3_103",_Fe="_rightPanelHeader_sg3w3_570",CFe="_rightPanelTabs_sg3w3_575",SFe="_tabGroup_sg3w3_584",TFe="_rightPanelTab_sg3w3_575",BFe="_rightPanelContent_sg3w3_649",EFe="_spaceControls_sg3w3_658",kFe="_configSection_sg3w3_665",IFe="_sectionHeader_sg3w3_675",FFe="_sectionDot_sg3w3_682",DFe="_sectionTitle_sg3w3_690",jFe="_inputGroup_sg3w3_698",PFe="_inputLabel_sg3w3_714",NFe="_loadingContainer_sg3w3_977",LFe="_toggleButton_sg3w3_1030",MFe="_input_sg3w3_698",RFe="_foldToggleIcon_sg3w3_1534",OFe="_toggleButtonGroup_sg3w3_1558",UFe="_subSetting_sg3w3_1620",HFe="_subLabel_sg3w3_1626",WFe="_frameGrid_sg3w3_1635",QFe="_frameItem_sg3w3_1642",$Fe="_frameItemLabel_sg3w3_1648",VFe="_frameItemInput_sg3w3_1656",zFe="_frameButton_sg3w3_1667",GFe="_frameNumberInput_sg3w3_1691",XFe="_frameUnit_sg3w3_1719",KFe="_toggleButtonActive_sg3w3_1856",qFe="_inputWithUnit_sg3w3_1916",YFe="_inputWithUnitField_sg3w3_1939",ZFe="_unit_sg3w3_1943",JFe="_furnitureList_sg3w3_1961",e8e="_emptyState_sg3w3_1965",t8e="_slotGroup_sg3w3_1972",n8e="_slotHeader_sg3w3_1979",i8e="_slotName_sg3w3_1988",r8e="_slotCount_sg3w3_1994",s8e="_furnitureItems_sg3w3_1999",o8e="_furnitureItem_sg3w3_1999",a8e="_furnitureInfo_sg3w3_2020",l8e="_furnitureName_sg3w3_2027",c8e="_furnitureSize_sg3w3_2033",h8e="_furnitureActions_sg3w3_2038",u8e="_removeButton_sg3w3_2043",Vt={configurator:nFe,mainContent:iFe,fileTreeOverlay:rFe,fileTreePanel:sFe,preparingPanel:oFe,leftPanelToggle:aFe,open:lFe,rightPanelContainer:cFe,rightPanelToggle:hFe,sidebarContent:uFe,sidebarPanel:dFe,modulePanelContent:AFe,moduleCategoryTabs:fFe,moduleCategoryTab:pFe,active:gFe,moduleSection:mFe,viewerArea:yFe,viewer:vFe,viewerDoorToggle:wFe,viewerDoorButton:xFe,rightPanel:bFe,rightPanelHeader:_Fe,rightPanelTabs:CFe,tabGroup:SFe,rightPanelTab:TFe,rightPanelContent:BFe,spaceControls:EFe,configSection:kFe,sectionHeader:IFe,sectionDot:FFe,sectionTitle:DFe,inputGroup:jFe,inputLabel:PFe,loadingContainer:NFe,toggleButton:LFe,input:MFe,foldToggleIcon:RFe,toggleButtonGroup:OFe,subSetting:UFe,subLabel:HFe,frameGrid:WFe,frameItem:QFe,frameItemLabel:$Fe,frameItemInput:VFe,frameButton:zFe,frameNumberInput:GFe,frameUnit:XFe,toggleButtonActive:KFe,inputWithUnit:qFe,inputWithUnitField:YFe,unit:ZFe,furnitureList:JFe,emptyState:e8e,slotGroup:t8e,slotHeader:n8e,slotName:i8e,slotCount:r8e,furnitureItems:s8e,furnitureItem:o8e,furnitureInfo:a8e,furnitureName:l8e,furnitureSize:c8e,furnitureActions:h8e,removeButton:u8e},d8e=()=>{var fi,Oi,rn,$n,Fn;const{user:n}=ec(),[e]=Y6(),t=xc(),i=VC(),{t:r}=Eo(),s=e.get("design")==="new",[o,a]=O.useState(!s),[c,h]=O.useState(!1),[u,d]=O.useState("idle"),[f,A]=O.useState(null),[g,p]=O.useState(null),[y,v]=O.useState(""),[m,w]=O.useState(!1),{setBasicInfo:x,basicInfo:T,setProjectId:j}=Ha(),{setSpaceInfo:D,spaceInfo:b,updateColumn:_}=qi(),{setPlacedModules:I,placedModules:S,setAllDoors:F,clearAllModules:B}=ci(),E=Eg(),{updateFurnitureForNewSpace:V}=sde({setPlacedModules:I}),{viewMode:K,setViewMode:P,doorsOpen:M,toggleDoors:X,view2DDirection:Z,setView2DDirection:Q,showDimensions:U,toggleDimensions:z,showDimensionsText:q,toggleDimensionsText:G,setHighlightedFrame:ie,selectedColumnId:H,setSelectedColumnId:se,activePopup:te,openColumnEditModal:fe,closeAllPopups:ye,showGuides:be,toggleGuides:_e,showAxis:W,toggleAxis:Y,activeDroppedCeilingTab:ve,setActiveDroppedCeilingTab:ce,showFurniture:ne,setShowFurniture:he,renderMode:xe,setRenderMode:Te}=Bi();Q$(),Oz();const[Ce,Be]=O.useState("module"),[Ye,$e]=O.useState("placement"),[ot,rt]=O.useState(!0),[Ve,We]=O.useState(!1),[De,Ge]=O.useState("tall"),Re=O.useRef(null),[Ie,Le]=O.useState(!0),[et,ct]=O.useState(!1),mt=e.get("editor")==="drawing",[je,le]=O.useState(mt),[Je,ht]=O.useState({}),[ut,ft]=O.useState(()=>{const pt={...b};return pt.installType==="built-in"&&(pt.installType="builtin"),pt});O.useEffect(()=>{lI()},[]),O.useEffect(()=>{const pt=vt=>{var mn;const kt=document.activeElement;if(!(kt&&(kt.tagName==="INPUT"||kt.tagName==="TEXTAREA"))){if(vt.key==="d"||vt.key==="D"){vt.preventDefault(),console.log("🚪 D 키로 도어 토글 시도"),X();return}if((vt.ctrlKey||vt.metaKey)&&vt.key==="e"){vt.preventDefault(),H?(console.log("⌨️ 키보드 단축키로 기둥 편집 모달 열기:",H),fe(H)):console.log("⚠️ 선택된 기둥이 없습니다.");return}if(te.type==="columnEdit"&&te.id){const sn=(mn=b.columns)==null?void 0:mn.find(bn=>bn.id===te.id);if(sn&&(vt.key==="ArrowLeft"||vt.key==="ArrowRight")){vt.preventDefault();const bn=sn.position[0],Li=b.width*.01,Wn=sn.width*.01,ui=vt.shiftKey?.05:.005;let Mi=bn;vt.key==="ArrowLeft"?Mi=Math.max(-(Li/2)+Wn/2,bn-ui):vt.key==="ArrowRight"&&(Mi=Math.min(Li/2-Wn/2,bn+ui)),_(te.id,{position:[Mi,sn.position[1],sn.position[2]]}),console.log("⌨️ 컬럼 키보드 이동:",{columnId:te.id,direction:vt.key,moveStep:ui,stepSize:vt.shiftKey?"50mm (빠름)":"5mm (정밀)",oldX:bn,newX:Mi})}}}};return document.addEventListener("keydown",pt),()=>{document.removeEventListener("keydown",pt)}},[H,fe,te,b.columns,b.width,_]),O.useEffect(()=>{P("3D"),Q("front")},[P,Q]),O.useEffect(()=>{var pt,vt;b.materialConfig&&console.log("🔍 Configurator - MaterialConfig 변경 감지:",{interiorColor:b.materialConfig.interiorColor,doorColor:b.materialConfig.doorColor,interiorTexture:b.materialConfig.interiorTexture,doorTexture:b.materialConfig.doorTexture,isCabinetTexture1:{interior:(pt=b.materialConfig.interiorTexture)==null?void 0:pt.includes("cabinet texture1"),door:(vt=b.materialConfig.doorTexture)==null?void 0:vt.includes("cabinet texture1")}})},[b.materialConfig]);const jt=(pt,vt)=>{var mn,sn;if(pt==="left"&&(b.installType==="semistanding"&&!((mn=b.wallConfig)!=null&&mn.left)||b.installType==="freestanding")||pt==="right"&&(b.installType==="semistanding"&&!((sn=b.wallConfig)!=null&&sn.right)||b.installType==="freestanding"))return;const kt=b.frameSize||{left:50,right:50,top:50};dt({frameSize:{...kt,[pt]:vt}})},Wt=pt=>{const kt=pt-100,mn=400,bn=Math.max(1,Math.ceil(kt/600)),Li=Math.min(20,Math.floor(kt/mn)),Wn=Math.max(bn,1),ui=Math.min(Li,20);return Wn>ui?{min:1,max:1,ideal:1}:{min:Wn,max:ui,ideal:Math.max(Wn,Math.min(ui,Math.round(kt/500)))}},Mt=()=>{var bn,Li;let pt=b.width||4800;(bn=b.droppedCeiling)!=null&&bn.enabled&&(pt=pt-(b.droppedCeiling.width||yo.WIDTH));const vt=Wt(pt);let kt=vt.ideal;(Li=b.droppedCeiling)!=null&&Li.enabled?b.mainDoorCount?kt=b.mainDoorCount:kt=b.customColumnCount||E.columnCount||vt.ideal:b.customColumnCount?kt=b.customColumnCount:E.isCalculated&&E.columnCount&&(kt=E.columnCount),kt=Math.max(vt.min,Math.min(vt.max,kt));const mn=pt-100,sn=mn/kt;return sn<400?kt=Math.floor(mn/400):sn>600&&(kt=Math.ceil(mn/600)),Math.max(vt.min,Math.min(vt.max,kt))},dn=S.some(pt=>pt.moduleId.includes("dual-2drawer-styler")||pt.moduleId.includes("dual-4drawer-pantshanger"));console.log("🔧 Configurator - hasSpecialDualFurniture:",dn),console.log("🔧 Configurator - placedModules:",S);const on=S.some(pt=>pt.hasDoor),Et=async pt=>{a(!0);try{const{project:vt,error:kt}=await wy(pt);if(kt){console.error("프로젝트 로드 에러:",kt),alert("프로젝트를 불러오는데 실패했습니다: "+kt),t("/");return}if(vt){const mn=vt.title||vt.projectData.title||"새 프로젝트";x({title:mn,location:vt.projectData.location||""}),console.log("🔍 loadProject에서 설정한 title:",mn);const sn={...vt.spaceConfig};if(sn.installType==="built-in"&&(sn.installType="builtin"),!sn.wallConfig)switch(sn.installType){case"builtin":sn.wallConfig={left:!0,right:!0};break;case"semistanding":sn.wallConfig={left:!0,right:!1};break;case"freestanding":sn.wallConfig={left:!1,right:!1};break}D(sn),I(vt.furniture.placedModules),A(pt),console.log("✅ 프로젝트 로드 성공:",vt.title),console.log("🎨 로드된 materialConfig:",vt.spaceConfig.materialConfig),console.log("🔄 [프로젝트 로드 후] derivedSpaceStore 강제 재계산"),E.recalculateFromSpaceInfo(vt.spaceConfig)}}catch(vt){console.error("프로젝트 로드 실패:",vt),alert("프로젝트 로드 중 오류가 발생했습니다."),t("/")}finally{a(!1)}},an=()=>!0,Mn=pt=>{if(pt==null)return null;if(Array.isArray(pt))return pt.map(Mn);if(typeof pt=="object"){const vt={};for(const[kt,mn]of Object.entries(pt))mn!==void 0&&(vt[kt]=Mn(mn));return vt}return pt},At=async()=>{if(console.log("💾 [DEBUG] saveProject 함수 시작"),console.log("💾 [DEBUG] 현재 프로젝트 ID:",f),console.log("💾 [DEBUG] 현재 디자인파일 ID:",g),console.log("💾 [DEBUG] Firebase 설정:",an()),console.log("💾 [DEBUG] 사용자 상태:",!!n),console.log("💾 [DEBUG] 사용자 정보:",n?{email:n.email,uid:n.uid}:"null"),!f){console.error("💾 [ERROR] 프로젝트 ID가 없습니다"),alert("저장할 프로젝트가 없습니다. 새 프로젝트를 먼저 생성해주세요.");return}h(!0),d("idle");try{console.log("💾 [DEBUG] 저장할 basicInfo:",T),console.log("💾 [DEBUG] 저장할 spaceInfo 요약:",{width:b.width,height:b.height,materialConfig:b.materialConfig}),console.log("💾 [DEBUG] 저장할 placedModules 개수:",S.length),console.log("💾 [DEBUG] 저장할 placedModules 상세:",S);let pt;try{pt=await $S(),pt||(console.log("💾 [DEBUG] 3D 캔버스 캡처 실패, 기본 썸네일 생성"),pt=$b(b,S.length)),console.log("💾 [DEBUG] 썸네일 생성 완료")}catch(kt){console.error("💾 [DEBUG] 썸네일 생성 실패:",kt),pt=null}if(an()&&n){console.log("💾 [DEBUG] Firebase 저장 모드 진입");try{if(g){console.log("💾 [DEBUG] 기존 디자인 파일 업데이트");const{updateDesignFile:kt}=await ca(async()=>{const{updateDesignFile:bn}=await Promise.resolve().then(()=>Jd);return{updateDesignFile:bn}},void 0),mn={name:y||T.title,spaceConfig:Mn(b),furniture:{placedModules:Mn(S)},thumbnail:pt};console.log("💾 [DEBUG] updateDesignFile 호출 전 데이터:",{name:mn.name,spaceConfigKeys:Object.keys(mn.spaceConfig||{}),furnitureCount:mn.furniture.placedModules.length,hasThumbnail:!!mn.thumbnail});const{error:sn}=await kt(g,mn);if(sn)console.error("💾 [ERROR] 디자인 파일 업데이트 실패:",sn),d("error"),alert("디자인 파일 저장에 실패했습니다: "+sn);else{d("success"),console.log("✅ 디자인 파일 저장 성공"),setTimeout(()=>{Re.current&&(console.log("🔄 Calling reset after successful save"),Re.current())},100);try{const bn=new BroadcastChannel("project-updates");bn.postMessage({type:"DESIGN_FILE_UPDATED",projectId:f,designFileId:g,timestamp:Date.now()}),console.log("📡 디자인 파일 업데이트 알림 전송"),bn.close()}catch(bn){console.warn("BroadcastChannel 전송 실패 (무시 가능):",bn)}}}else{console.log("💾 [DEBUG] 새 디자인 파일 생성");const{createDesignFile:kt}=await ca(async()=>{const{createDesignFile:bn}=await Promise.resolve().then(()=>Jd);return{createDesignFile:bn}},void 0),{id:mn,error:sn}=await kt({name:T.title||"새 디자인",projectId:f,spaceConfig:Mn(b),furniture:{placedModules:Mn(S)},thumbnail:pt});if(sn)console.error("💾 [ERROR] 디자인 파일 생성 실패:",sn),d("error"),alert("디자인 파일 생성에 실패했습니다: "+sn);else if(mn){p(mn),v(T.title),d("success"),console.log("✅ 새 디자인 파일 생성 및 저장 성공"),setTimeout(()=>{Re.current&&(console.log("🔄 Calling reset after successful create"),Re.current())},100);try{const bn=new BroadcastChannel("project-updates");bn.postMessage({type:"DESIGN_FILE_UPDATED",projectId:f,designFileId:mn,timestamp:Date.now()}),console.log("📡 새 디자인 파일 생성 알림 전송"),bn.close()}catch(bn){console.warn("BroadcastChannel 전송 실패 (무시 가능):",bn)}t(`/configurator?projectId=${f}&designFileId=${mn}`,{replace:!0})}}try{const kt=new BroadcastChannel("project-updates");kt.postMessage({type:"PROJECT_SAVED",projectId:f,timestamp:Date.now()}),console.log("💾 [DEBUG] BroadcastChannel 알림 전송 완료"),kt.close()}catch(kt){console.warn("💾 [WARN] BroadcastChannel 전송 실패 (무시 가능):",kt)}}catch(kt){console.error("💾 [ERROR] Firebase 저장 중 예외:",kt),d("error"),alert("디자인 파일 저장 중 오류가 발생했습니다: "+kt.message)}setTimeout(()=>d("idle"),3e3)}else console.log("💾 [DEBUG] Firebase 인증 필요"),d("error"),alert("저장하려면 로그인이 필요합니다."),setTimeout(()=>d("idle"),3e3)}catch(pt){console.error("💾 [ERROR] saveProject 최상위 예외:",pt),d("error"),alert("프로젝트 저장 중 예상치 못한 오류가 발생했습니다: "+pt.message)}finally{console.log("💾 [DEBUG] saveProject 완료, 저장 상태 해제"),h(!1)}},zt=async()=>{if(console.log("🎨 [DEBUG] handleNewDesign 함수 시작"),!f){alert("프로젝트가 선택되지 않았습니다.");return}try{if(g&&(b||S.length>0)){console.log("💾 새 디자인 생성 전 현재 작업 저장 시작"),h(!0),d("idle");try{await At(),console.log("✅ 현재 작업 저장 완료"),d("success"),setTimeout(()=>d("idle"),2e3)}catch(kt){if(console.error("❌ 현재 작업 저장 실패:",kt),!confirm("현재 작업을 저장하는데 실패했습니다. 그래도 새 디자인을 생성하시겠습니까?")){h(!1);return}}finally{h(!1)}}const pt=confirm("새 디자인을 시작하시겠습니까? (현재 작업은 저장되었습니다)");if(console.log("🎨 [DEBUG] 사용자 확인 응답:",pt),!pt){console.log("🎨 [DEBUG] 사용자가 취소함");return}const vt={width:Au.WIDTH,height:Au.HEIGHT,depth:Au.DEPTH,frameThickness:20,frameColor:"#E5E5DC",frameColorName:"Beige",subdivisionMode:"none",columns:[],rows:[],showHorizontalLines:!1,surroundType:"surround",installType:"builtin",wallConfig:{left:!0,right:!0},gapConfig:{left:2,right:2},frameSize:{top:n0.TOP,left:n0.LEFT,right:n0.RIGHT},framePosition:"top",baseConfig:{type:"floor",height:L_.HEIGHT,placementType:"ground"},hasFloorFinish:!1,materialConfig:{interiorColor:M0.INTERIOR_COLOR,doorColor:M0.DOOR_COLOR},droppedCeiling:{enabled:!1,position:"right",width:yo.WIDTH,dropHeight:yo.DROP_HEIGHT}};if(an()&&n){const kt="제목 없음",mn=await hI({name:kt,projectId:f,spaceConfig:vt,furniture:{placedModules:[]}});if(mn.error){console.error("🎨 [ERROR] 새 디자인 생성 실패:",mn.error),alert("새 디자인 생성에 실패했습니다: "+mn.error);return}mn.id&&(console.log("🎨 [DEBUG] 새 디자인 생성 성공:",mn.id),D(vt),I([]),p(mn.id),v(kt),x({...T,title:kt}),E.recalculateFromSpaceInfo(vt),t(`/configurator?projectId=${f}&designFileId=${mn.id}`,{replace:!0}),console.log("✅ 새 디자인파일 생성 완료:",mn.id),alert("새 디자인이 생성되었습니다!"))}else{const kt="제목 없음";D(vt),I([]),v(kt),x({...T,title:kt}),E.recalculateFromSpaceInfo(vt),alert("새 디자인이 생성되었습니다!")}}catch(pt){console.error("🎨 [ERROR] 새 디자인 생성 중 오류:",pt),alert("새 디자인 생성 중 오류가 발생했습니다.")}},Zt=async()=>{console.log("🆕 [DEBUG] handleNewProject 함수 시작");try{const pt=confirm("현재 작업 내용이 사라집니다. 새 디자인을 시작하시겠습니까?");if(console.log("🆕 [DEBUG] 사용자 확인 응답:",pt),!pt){console.log("🆕 [DEBUG] 사용자가 취소함");return}console.log("🆕 [DEBUG] 새 프로젝트 생성 시작"),h(!0);const vt={width:Au.WIDTH,height:Au.HEIGHT,depth:Au.DEPTH,installationType:"builtin",hasFloorFinish:!1,surroundType:"surround",frameSize:{top:n0.TOP,bottom:50,left:n0.LEFT,right:n0.RIGHT},baseConfig:{type:"floor",height:L_.HEIGHT},materialConfig:{interiorColor:M0.INTERIOR_COLOR,doorColor:M0.DOOR_COLOR},columns:[]};console.log("🆕 [DEBUG] 기본 설정 준비됨:",vt);let kt;try{kt=$b(vt,0),console.log("🆕 [DEBUG] 썸네일 생성 성공")}catch(sn){console.error("🆕 [DEBUG] 썸네일 생성 실패:",sn),kt=null}const mn=an();if(console.log("🆕 [DEBUG] Firebase 설정 확인:",mn),console.log("🆕 [DEBUG] 사용자 로그인 상태:",!!n),console.log("🆕 [DEBUG] 사용자 정보:",n?{email:n.email,uid:n.uid}:"null"),mn&&n){console.log("🆕 [DEBUG] Firebase 모드로 진행");try{const sn={title:"Untitled",projectData:{title:"Untitled",location:""},spaceConfig:Mn(vt),furniture:{placedModules:[]},...kt&&{thumbnail:kt}};console.log("🆕 [DEBUG] createProject 호출 시작, 정리된 데이터:",sn);const bn=await R_(sn);if(console.log("🆕 [DEBUG] createProject 결과:",bn),bn.error){console.error("🆕 [ERROR] Firebase 프로젝트 생성 실패:",bn.error),alert("새 프로젝트 생성에 실패했습니다: "+bn.error);return}bn.id?(console.log("🆕 [DEBUG] Firebase 프로젝트 생성 성공:",bn.id),x({title:"Untitled",location:""}),D(vt),I([]),A(bn.id),E.recalculateFromSpaceInfo(vt),t(`/configurator?projectId=${bn.id}`,{replace:!0}),console.log('✅ 새 Firebase 프로젝트 "Untitled" 생성 완료:',bn.id),alert("새 프로젝트가 생성되었습니다!")):(console.error("🆕 [ERROR] projectId가 반환되지 않음"),alert("프로젝트 ID를 받지 못했습니다. 다시 시도해주세요."))}catch(sn){console.error("🆕 [ERROR] Firebase 작업 중 예외:",sn),alert("Firebase 연결 중 오류가 발생했습니다: "+sn.message)}}else console.log("🆕 [ERROR] Firebase 인증 필요"),alert("새 프로젝트를 생성하려면 로그인이 필요합니다.")}catch(pt){console.error("🆕 [ERROR] handleNewProject 최상위 예외:",pt),alert("새 프로젝트 생성 중 예상치 못한 오류가 발생했습니다: "+pt.message)}finally{console.log("🆕 [DEBUG] handleNewProject 완료, 저장 상태 해제"),h(!1)}},$t=async()=>{const pt=prompt("새 디자인 파일 이름을 입력하세요:",(y||T.title)+" 사본");if(pt&&pt.trim()){h(!0),d("idle");try{let vt=await $S();if(vt||(console.log("📸 3D 캔버스 캡처 실패, 기본 썸네일 생성"),vt=$b(b,S.length)),an()&&n){let kt=f;if(!kt){const{id:Li,error:Wn}=await R_({title:T.title||"새 프로젝트"});if(Wn||!Li){console.error("프로젝트 생성 실패:",Wn),d("error"),alert("프로젝트 생성에 실패했습니다: "+Wn);return}kt=Li,A(Li)}const{createDesignFile:mn}=await ca(async()=>{const{createDesignFile:Li}=await Promise.resolve().then(()=>Jd);return{createDesignFile:Li}},void 0),{id:sn,error:bn}=await mn({name:pt.trim(),projectId:kt,spaceConfig:Mn(b),furniture:{placedModules:Mn(S)},thumbnail:vt});if(bn){console.error("디자인 파일 복사 저장 실패:",bn),d("error"),alert("다른이름으로 저장에 실패했습니다: "+bn);return}sn&&(p(sn),v(pt.trim()),x({...T,title:pt.trim()}),d("success"),setTimeout(()=>{Re.current&&(console.log("🔄 Calling reset after successful save as"),Re.current())},100),t(`/configurator?projectId=${kt}&designFileId=${sn}`,{replace:!0}),console.log("✅ 디자인 파일 다른이름으로 저장 성공:",pt),alert(`"${pt}" 디자인 파일로 저장되었습니다!`))}else console.log("💾 [ERROR] Firebase 인증 필요"),d("error"),alert("저장하려면 로그인이 필요합니다.");setTimeout(()=>d("idle"),3e3)}catch(vt){console.error("다른이름으로 저장 실패:",vt),d("error"),alert("다른이름으로 저장 중 오류가 발생했습니다.")}finally{h(!1)}}},Ht=async pt=>{const vt=T.title;if(x({...T,title:pt}),f){h(!0);try{if(an()&&n){const{error:kt}=await NQ(f,{title:pt,projectData:Mn({...T,title:pt}),spaceConfig:Mn(b),furniture:{placedModules:Mn(S)}});if(kt){console.error("프로젝트 이름 변경 저장 실패:",kt),x({...T,title:vt}),alert("프로젝트 이름 변경에 실패했습니다: "+kt);return}console.log("✅ 프로젝트 이름 변경 성공:",pt)}else console.log("💾 [ERROR] Firebase 인증 필요"),x({...T,title:vt}),alert("프로젝트 이름을 변경하려면 로그인이 필요합니다.")}catch(kt){console.error("프로젝트 이름 변경 실패:",kt),x({...T,title:vt}),alert("프로젝트 이름 변경 중 오류가 발생했습니다.")}finally{h(!1)}}};O.useEffect(()=>{const pt=e.get("designFileName")||e.get("fileName");if(console.log("🔍 URL에서 가져온 designFileName:",pt),console.log("🔍 현재 basicInfo.title:",T.title),pt){const vt=decodeURIComponent(pt);v(vt),console.log("📝 URL 파라미터로 디자인파일명 설정:",vt)}else T.title?(v(T.title),console.log("📝 프로젝트명으로 디자인파일명 설정:",T.title)):(v("새로운 디자인"),console.log("📝 기본값으로 디자인파일명 설정: 새로운 디자인"))},[e,T.title]),O.useEffect(()=>{var pt;if(!((pt=b.droppedCeiling)!=null&&pt.enabled)&&b.customColumnCount){const vt=kr(b),kt=ro.getDefaultColumnCount(vt.width);console.log("🔧 [Configurator] Dropped ceiling disabled, checking column count:",{currentColumnCount:b.customColumnCount,defaultColumnCount:kt,internalWidth:vt.width}),b.customColumnCount!==kt&&(console.log("🔧 [Configurator] Resetting column count to default:",kt),D({customColumnCount:kt,mainDoorCount:void 0,droppedCeilingDoorCount:void 0}))}},[(fi=b.droppedCeiling)==null?void 0:fi.enabled]),O.useEffect(()=>{const pt=sessionStorage.getItem("configurator_state_backup");if(pt)try{const Wn=JSON.parse(pt);console.log("🔄 Configurator 상태 복원 시작"),x(Wn.basicInfo),D(Wn.spaceInfo),I(Wn.placedModules),A(Wn.projectId),p(Wn.designFileId),j(Wn.projectId),sessionStorage.removeItem("configurator_state_backup"),w(!0),a(!1),console.log("✅ Configurator 상태 복원 완료");return}catch(Wn){console.error("상태 복원 실패:",Wn),sessionStorage.removeItem("configurator_state_backup")}const vt=e.get("projectId")||e.get("id")||e.get("project"),kt=e.get("designFileId"),mn=e.get("designFileName"),sn=e.get("mode"),bn=e.get("skipLoad")==="true",Li=e.get("design")==="new";if(vt&&kt){if(console.log("📋 Step2에서 넘어옴 - designFileId:",kt),f===vt&&g===kt&&m){console.log("🔄 동일한 프로젝트/디자인 - 재로드 건너뜀"),a(!1);return}A(vt),j(vt),p(kt),(async()=>{var ui,Mi,Gn,Dn,li,en;a(!0);try{const{getDesignFileById:Rt}=await ca(async()=>{const{getDesignFileById:tt}=await Promise.resolve().then(()=>Jd);return{getDesignFileById:tt}},void 0),{designFile:Xn,error:Ui}=await Rt(kt);if(Ui){console.error("디자인 파일 로드 에러:",Ui),alert("디자인 파일을 불러오는데 실패했습니다: "+Ui),t("/dashboard");return}if(Xn){console.log("✅ 디자인 파일 로드 성공:",Xn.name),x({title:Xn.name||"새 디자인",location:""}),v(Xn.name);const tt={...Xn.spaceConfig};tt.installType==="built-in"&&(tt.installType="builtin"),typeof tt.columns=="number"&&(tt.columns=[]),typeof tt.rows=="number"&&(tt.rows=[]),D(tt);const Jt=sessionStorage.getItem("cnc_furniture_backup");if(Jt&&fromCNC)try{const wn=JSON.parse(Jt);console.log("✅ CNC 백업 데이터 사용:",wn.length,"개"),I(wn),sessionStorage.removeItem("cnc_furniture_backup")}catch(wn){console.error("백업 데이터 복원 실패:",wn),(ui=Xn.furniture)!=null&&ui.placedModules?I(Xn.furniture.placedModules):I([])}else console.log("🪑 디자인 파일 가구 데이터 로드:",{hasFurniture:!!Xn.furniture,hasPlacedModules:!!((Mi=Xn.furniture)!=null&&Mi.placedModules),placedModulesCount:((Dn=(Gn=Xn.furniture)==null?void 0:Gn.placedModules)==null?void 0:Dn.length)||0,placedModules:(li=Xn.furniture)==null?void 0:li.placedModules}),(en=Xn.furniture)!=null&&en.placedModules?(console.log("🪑 [LOAD] 가구 데이터 설정 중:",Xn.furniture.placedModules),console.trace("🪑 [TRACE] setPlacedModules 호출 스택"),I(Xn.furniture.placedModules),console.log("🪑 [LOAD] 가구 데이터 설정 완료")):(console.log("⚠️ [EMPTY] 가구 데이터가 없어서 빈 배열로 초기화"),console.trace("⚠️ [TRACE] setPlacedModules([]) 호출 스택"),I([]));w(!0),a(!1)}}catch(Rt){console.error("디자인 파일 로드 중 오류:",Rt),alert("디자인 파일 로드 중 오류가 발생했습니다."),a(!1)}})();return}if(vt&&mn){console.log("📋 디자인명으로 진입 - designFileName:",mn),A(vt),j(vt),v(decodeURIComponent(mn)),(async()=>{var ui,Mi,Gn,Dn,li;a(!0);try{const{getDesignFiles:en}=await ca(async()=>{const{getDesignFiles:Jt}=await Promise.resolve().then(()=>Jd);return{getDesignFiles:Jt}},void 0),{designFiles:Rt,error:Xn}=await en(vt);if(Xn){console.error("디자인 파일 목록 로드 에러:",Xn),Et(vt);return}const Ui=decodeURIComponent(mn),tt=Rt.find(Jt=>Jt.name===Ui);if(tt){console.log("✅ 디자인 파일 찾음:",tt.id,tt.name),p(tt.id),x({title:tt.name||"새 디자인",location:""});const Jt={...tt.spaceConfig};Jt.installType==="built-in"&&(Jt.installType="builtin"),typeof Jt.columns=="number"&&(Jt.columns=[]),typeof Jt.rows=="number"&&(Jt.rows=[]),D(Jt);const wn=sessionStorage.getItem("cnc_furniture_backup");if(wn&&fromCNC)try{const Yn=JSON.parse(wn);console.log("✅ CNC 백업 데이터 사용 (디자인명 로드):",Yn.length,"개"),I(Yn),sessionStorage.removeItem("cnc_furniture_backup")}catch(Yn){console.error("백업 데이터 복원 실패:",Yn),(ui=tt.furniture)!=null&&ui.placedModules?I(tt.furniture.placedModules):I([])}else console.log("🪑 디자인 파일 가구 데이터 로드:",{hasFurniture:!!tt.furniture,hasPlacedModules:!!((Mi=tt.furniture)!=null&&Mi.placedModules),placedModulesCount:((Dn=(Gn=tt.furniture)==null?void 0:Gn.placedModules)==null?void 0:Dn.length)||0}),(li=tt.furniture)!=null&&li.placedModules?I(tt.furniture.placedModules):I([]);a(!1)}else console.log("⚠️ 디자인 파일을 찾을 수 없음, 프로젝트 로드 시도"),Et(vt)}catch(en){console.error("디자인 파일 로드 중 오류:",en),Et(vt)}})();return}vt&&vt!==f?(A(vt),j(vt),bn||Li?(console.log("✅ skipLoad=true 또는 design=new - Step 1-3에서 설정한 데이터 유지"),console.log("🔍 현재 spaceInfo:",b),console.log("🔍 현재 basicInfo:",T),Li?wy(vt).then(({project:Wn,error:ui})=>{Wn&&!ui&&(x({title:Wn.title,location:Wn.location||""}),console.log("📝 새 디자인 - 프로젝트 정보 설정:",Wn.title)),a(!1)}):setTimeout(()=>{a(!1)},500)):sn==="new-design"?(console.log("🎨 기존 프로젝트에 새 디자인 생성:",vt),wy(vt).then(({project:Wn,error:ui})=>{Wn&&!ui&&(console.log("🔍 setBasicInfo 호출 전 basicInfo:",T),console.log("🔍 설정할 프로젝트명:",Wn.title),x({title:Wn.title}),console.log("📝 프로젝트명 설정:",Wn.title)),a(!1)})):Et(vt)):setTimeout(()=>{a(!1)},500)},[e,i.state]),O.useEffect(()=>{const pt=async()=>{if(!(!f||!n))try{const{loadFolderData:kt}=await ca(async()=>{const{loadFolderData:sn}=await Promise.resolve().then(()=>Jd);return{loadFolderData:sn}},void 0),mn=await kt(f);if(mn.folders&&mn.folders.length>0){for(const sn of mn.folders)if(sn.children&&sn.children.length>0){const bn=sn.children[0];if(bn&&bn.name){console.log("📝 폴더에서 찾은 디자인파일명:",bn.name),v(bn.name);return}}}T.title&&y==="새로운 디자인"&&(v(T.title),console.log("📝 폴더에 디자인파일이 없어서 프로젝트명 사용:",T.title))}catch(kt){console.error("폴더 데이터 로드 실패:",kt)}};!(e.get("designFileName")||e.get("fileName"))&&f&&n&&pt()},[f,n,T.title,y,e]),O.useEffect(()=>{if(JSON.stringify(ut)!==JSON.stringify(b)){const pt={...ut},vt={...b};delete pt.materialConfig,delete vt.materialConfig,(pt.width!==vt.width||pt.height!==vt.height||pt.depth!==vt.depth||pt.customColumnCount!==vt.customColumnCount||JSON.stringify(pt.droppedCeiling)!==JSON.stringify(vt.droppedCeiling)||pt.mainDoorCount!==vt.mainDoorCount||pt.droppedCeilingDoorCount!==vt.droppedCeilingDoorCount||JSON.stringify(pt.frameSize)!==JSON.stringify(vt.frameSize)||JSON.stringify(pt.gapConfig)!==JSON.stringify(vt.gapConfig)||JSON.stringify(pt.baseConfig)!==JSON.stringify(vt.baseConfig)||pt.surroundType!==vt.surroundType||pt.installType!==vt.installType||JSON.stringify(pt.wallConfig)!==JSON.stringify(vt.wallConfig)||pt.hasFloorFinish!==vt.hasFloorFinish||JSON.stringify(pt.floorFinish)!==JSON.stringify(vt.floorFinish))&&(console.log("🔄 공간 구조가 변경되었습니다. 가구 재배치 실행 중...",{width:pt.width!==vt.width,height:pt.height!==vt.height,depth:pt.depth!==vt.depth,customColumnCount:pt.customColumnCount!==vt.customColumnCount,droppedCeiling:JSON.stringify(pt.droppedCeiling)!==JSON.stringify(vt.droppedCeiling),mainDoorCount:pt.mainDoorCount!==vt.mainDoorCount,droppedCeilingDoorCount:pt.droppedCeilingDoorCount!==vt.droppedCeilingDoorCount,prevDroppedCeiling:pt.droppedCeiling,currentDroppedCeiling:vt.droppedCeiling}),V(ut,b)),ft(b)}},[b,ut,V]),O.useEffect(()=>{E.isCalculated||(console.log("🔄 derivedSpaceStore 강제 재계산 (컬럼 수 동기화)"),E.recalculateFromSpaceInfo(b))},[b,E]),O.useEffect(()=>(window.handleSpaceInfoUpdate=dt,()=>{delete window.handleSpaceInfoUpdate}),[]);const Lt=pt=>{Be(Ce===pt?null:pt)},dt=pt=>{var sn,bn,Li,Wn,ui,Mi;console.log("🔧 handleSpaceInfoUpdate called with:",pt),console.log("🔧 Current spaceInfo.wallConfig:",b.wallConfig),pt.mainDoorCount!==void 0&&console.log("🚪 mainDoorCount 업데이트:",{이전값:b.mainDoorCount,새값:pt.mainDoorCount,단내림활성화:(sn=b.droppedCeiling)==null?void 0:sn.enabled});const vt=pt.droppedCeiling!==void 0;vt&&console.log("🔄 단내림 설정 변경 감지:",pt.droppedCeiling),pt.surroundType&&console.log("🔧 Configurator - surroundType update:",{previous:b.surroundType,new:pt.surroundType,willUpdateStore:!0});let kt={...pt};if(kt.installType==="built-in"&&(kt.installType="builtin"),pt.surroundType){const Gn=kt.installType||b.installType,Dn=kt.wallConfig||b.wallConfig,li={...b.frameSize,top:((bn=b.frameSize)==null?void 0:bn.top)||10};if(pt.surroundType==="surround")switch(Gn){case"builtin":li.left=50,li.right=50;break;case"semistanding":Dn.left&&!Dn.right?(li.left=50,li.right=18):!Dn.left&&Dn.right&&(li.left=18,li.right=50);break;case"freestanding":li.left=18,li.right=18;break}else if(pt.surroundType==="no-surround"){switch(Gn){case"builtin":li.left=0,li.right=0;break;case"semistanding":Dn.left&&!Dn.right?(li.left=0,li.right=18):!Dn.left&&Dn.right&&(li.left=18,li.right=0);break;case"freestanding":li.left=18,li.right=18;break}kt.gapConfig={left:Dn.left?2:0,right:Dn.right?2:0}}kt.frameSize=li,console.log("🔧 서라운드 타입 변경에 따른 프레임 초기화:",{surroundType:pt.surroundType,installType:Gn,frameSize:li,gapConfig:kt.gapConfig})}if(pt.wallConfig&&b.installType==="semistanding"&&b.surroundType==="surround"){const Gn={...b.frameSize};pt.wallConfig.left&&!pt.wallConfig.right?(Gn.left=50,Gn.right=18):!pt.wallConfig.left&&pt.wallConfig.right&&(Gn.left=18,Gn.right=50),kt.frameSize=Gn,console.log("🔧 세미스탠딩 프레임 자동 업데이트:",Gn)}if(pt.installType){if(pt.wallConfig)console.log("🔧 InstallTypeControls에서 전달된 wallConfig 사용:",pt.wallConfig),kt.wallConfig=pt.wallConfig;else{switch(pt.installType){case"builtin":kt.wallConfig={left:!0,right:!0};break;case"semistanding":kt.wallConfig={left:!0,right:!1};break;case"freestanding":kt.wallConfig={left:!1,right:!1};break}console.log("🔧 자동 설정된 wallConfig:",kt.wallConfig)}const Gn={...b.frameSize},Dn=kt.wallConfig||b.wallConfig;if(b.surroundType==="surround")switch(pt.installType){case"builtin":Gn.left=50,Gn.right=50;break;case"semistanding":Dn.left&&!Dn.right?(Gn.left=50,Gn.right=18):!Dn.left&&Dn.right&&(Gn.left=18,Gn.right=50);break;case"freestanding":Gn.left=18,Gn.right=18;break}else if(b.surroundType==="no-surround"){switch(pt.installType){case"builtin":Gn.left=0,Gn.right=0;break;case"semistanding":Dn.left&&!Dn.right?(Gn.left=0,Gn.right=18):!Dn.left&&Dn.right&&(Gn.left=18,Gn.right=0);break;case"freestanding":Gn.left=18,Gn.right=18;break}kt.gapConfig={left:Dn.left?2:0,right:Dn.right?2:0}}kt.frameSize=Gn,console.log("🔧 설치타입 변경에 따른 wallConfig 및 프레임 자동 업데이트:",{installType:pt.installType,wallConfig:kt.wallConfig,frameSize:kt.frameSize})}if(pt.width&&pt.width!==b.width){const Gn=Wt(pt.width),Dn=b.customColumnCount||Mt(),li=pt.width-100;let en=Dn;const Rt=li/Dn;Rt<400?en=Math.floor(li/400):Rt>600&&(en=Math.ceil(li/600));const Xn=Math.max(Gn.min,Math.min(Gn.max,en));kt={...kt,customColumnCount:Xn}}if(pt.customColumnCount){const Gn=kt.width||b.width||4800,Dn=Wt(Gn),li=Gn-100,en=li/pt.customColumnCount;if(en<400||en>600){const Rt=Math.max(Dn.min,Math.min(Dn.max,en<400?Math.floor(li/400):Math.ceil(li/600)));kt={...kt,customColumnCount:Rt}}}if((Li=pt.droppedCeiling)!=null&&Li.enabled&&!((Wn=b.droppedCeiling)!=null&&Wn.enabled)){const Gn=kt.width||b.width||4800,Dn=pt.droppedCeiling.width||yo.WIDTH,Rt=Gn-Dn-50,Xn=600,Ui=Math.ceil(Rt/Xn),tt=Mt(),Jt=Math.max(Ui,tt);console.log(`🔧 단내림 활성화 시 메인 구간 도어 개수 설정: ${tt} → ${Jt}`),kt={...kt,mainDoorCount:Jt};const Yn=Dn-50,hi=Math.max(1,Math.ceil(Yn/Xn)),Xt=Math.max(hi,Math.floor(Yn/400)),_i=hi;console.log(`🔧 단내림 활성화 시 단내림 구간 도어개수 기본값 설정: ${_i}`,{droppedWidth:Dn,droppedInternalWidth:Yn,droppedMinSlots:hi,droppedMaxSlots:Xt}),kt={...kt,droppedCeilingDoorCount:_i}}if((ui=pt.droppedCeiling)!=null&&ui.width&&((Mi=b.droppedCeiling)!=null&&Mi.enabled)){const Dn=pt.droppedCeiling.width-50,Rt={min:Math.max(1,Math.ceil(Dn/600)),max:Math.max(1,Math.floor(Dn/400))},Xn=b.droppedCeilingDoorCount||2;if(Xn<Rt.min||Xn>Rt.max){const Ui=Math.max(Rt.min,Math.min(Rt.max,Xn));console.log(`🔧 단내림 폭 변경 시 도어개수 자동 조정: ${Xn} → ${Ui}`),kt={...kt,droppedCeilingDoorCount:Ui}}}console.log("🔧 최종 업데이트 적용:",{updates:kt,hasWallConfig:!!kt.wallConfig,wallConfig:kt.wallConfig});const mn=kt.installType!==void 0&&kt.installType!==b.installType;D(kt),vt&&(console.log("🔄 단내림 설정 변경으로 3D 뷰 강제 업데이트"),setTimeout(()=>{P(K)},0)),mn&&S.length>0&&(console.log("🔧 InstallType 변경 - 가구 너비 재계산"),setTimeout(()=>{const Gn={...b,...kt};V(b,Gn)},100))},at=()=>{console.log("🚪 도어 설치/제거 핸들러 호출:",{hasDoorsInstalled:on,placedModulesCount:S.length,doorsOpen:M}),on?(console.log("🚪 도어 제거 시도"),F(!1)):(console.log("🚪 도어 설치 시도"),F(!0),M&&(console.log("🚪 도어가 열려있어서 닫기"),X()))},Ot=()=>{t("/dashboard?step=2")},Cn=()=>{window.open("/help","_blank")},Rn=async()=>{console.log("도면 편집기 열기");try{const vt=await $S();vt&&ht({top:vt,front:vt,side:vt,iso:vt})}catch(vt){console.error("뷰 캡처 실패:",vt)}const pt=new URLSearchParams(e.toString());pt.set("editor","drawing"),window.history.replaceState(null,"",`${window.location.pathname}?${pt.toString()}`),le(!0)},xn=()=>{t("/login")},En=()=>{console.log("프로필")},Hn=()=>{We(!Ve)},Kn=()=>{if(console.log("📐 DXF 내보내기 팝업 열기..."),!b){alert("공간 정보가 없습니다. 먼저 공간을 설정해주세요.");return}ct(!0)},Ti=()=>{if(console.log("📄 PDF 내보내기 팝업 열기..."),!b){alert("공간 정보가 없습니다. 먼저 공간을 설정해주세요.");return}ct(!0)};O.useEffect(()=>{typeof window<"u"&&(window.testExportDXFZIP=Kn,window.testExportPDF=Ti,window.getCurrentSpaceInfo=()=>b,window.getCurrentPlacedModules=()=>S)},[b,S,Kn,Ti]);const ti=()=>{if(!Ce)return null;switch(Ce){case"module":return l.jsx("div",{className:Vt.sidebarPanel,children:l.jsxs("div",{className:Vt.modulePanelContent,children:[l.jsxs("div",{className:Vt.moduleCategoryTabs,children:[l.jsx("button",{className:`${Vt.moduleCategoryTab} ${De==="tall"?Vt.active:""}`,onClick:()=>Ge("tall"),children:r("furniture.tallCabinet")}),l.jsx("button",{className:`${Vt.moduleCategoryTab} ${De==="upper"?Vt.active:""}`,onClick:()=>Ge("upper"),children:r("furniture.upperCabinet")}),l.jsx("button",{className:`${Vt.moduleCategoryTab} ${De==="lower"?Vt.active:""}`,onClick:()=>Ge("lower"),children:r("furniture.lowerCabinet")})]}),l.jsx("div",{className:Vt.moduleSection,children:l.jsx(l5e,{moduleCategory:De})})]})});case"material":return l.jsx("div",{className:Vt.sidebarPanel,children:l.jsx(f3e,{})});case"structure":return l.jsx("div",{className:Vt.sidebarPanel,children:l.jsx(b3e,{columns:b.columns||[],onColumnsChange:pt=>D({columns:pt})})});case"etc":return l.jsx("div",{className:Vt.sidebarPanel,children:l.jsxs("div",{className:Vt.preparingPanel,children:[l.jsx("h3",{children:r("sidebar.accessories")}),l.jsx("p",{children:r("sidebar.preparing")})]})});default:return null}},ai=()=>{if(!S||S.length===0)return l.jsx("div",{className:Vt.emptyState,children:l.jsx("p",{children:"배치된 가구가 없습니다"})});const pt=S.reduce((vt,kt)=>{const mn=`슬롯 ${kt.slotIndex+1}`;return vt[mn]||(vt[mn]=[]),vt[mn].push(kt),vt},{});return l.jsx("div",{className:Vt.furnitureList,children:Object.entries(pt).map(([vt,kt])=>l.jsxs("div",{className:Vt.slotGroup,children:[l.jsxs("div",{className:Vt.slotHeader,children:[l.jsx("span",{className:Vt.slotName,children:vt}),l.jsxs("span",{className:Vt.slotCount,children:["(",kt.length,"개)"]})]}),l.jsx("div",{className:Vt.furnitureItems,children:kt.map(mn=>l.jsxs("div",{className:Vt.furnitureItem,children:[l.jsxs("div",{className:Vt.furnitureInfo,children:[l.jsx("span",{className:Vt.furnitureName,children:mn.moduleData.name||mn.moduleData.id}),l.jsxs("span",{className:Vt.furnitureSize,children:[mn.moduleData.dimensions.width," × ",mn.moduleData.dimensions.height," mm"]})]}),l.jsx("div",{className:Vt.furnitureActions,children:l.jsx("button",{className:Vt.removeButton,onClick:()=>{const{removePlacedModule:sn}=ci.getState();sn(mn.id)},title:"제거",children:"×"})})]},mn.id))})]},vt))})},Gi=()=>{var pt,vt,kt,mn,sn,bn,Li,Wn,ui,Mi,Gn,Dn,li,en,Rt,Xn,Ui,tt,Jt,wn,Yn,hi,Xt,_i,Pr,ws,Vi,br,_r,Qr;return Ye==="module"?l.jsx("div",{className:Vt.moduleContent,children:l.jsxs("div",{className:Vt.configSection,children:[l.jsxs("div",{className:Vt.sectionHeader,children:[l.jsx("span",{className:Vt.sectionDot}),l.jsx("h3",{className:Vt.sectionTitle,children:"배치된 가구 목록"})]}),ai()]})}):l.jsxs("div",{className:Vt.spaceControls,children:[l.jsxs("div",{className:Vt.configSection,children:[l.jsxs("div",{className:Vt.sectionHeader,children:[l.jsx("span",{className:Vt.sectionDot}),l.jsx("h3",{className:Vt.sectionTitle,children:r("space.title")})]}),l.jsxs("div",{style:{display:"flex",gap:"12px"},children:[l.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:"8px"},children:[l.jsx("span",{style:{minWidth:"20px",color:"var(--theme-primary)"},children:"W"}),l.jsx("div",{style:{flex:1},children:l.jsx(L$,{spaceInfo:b,onUpdate:dt,disabled:dn})})]}),l.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:"8px"},children:[l.jsx("span",{style:{minWidth:"20px",color:"var(--theme-primary)"},children:"H"}),l.jsx("div",{style:{flex:1},children:l.jsx(M$,{spaceInfo:b,onUpdate:dt})})]})]})]}),l.jsxs("div",{className:Vt.configSection,children:[l.jsxs("div",{className:Vt.sectionHeader,children:[l.jsx("span",{className:Vt.sectionDot}),l.jsx("h3",{className:Vt.sectionTitle,children:r("space.droppedCeiling")})]}),l.jsxs("div",{className:Vt.toggleButtonGroup,children:[l.jsx("button",{className:`${Vt.toggleButton} ${(pt=b.droppedCeiling)!=null&&pt.enabled?"":Vt.toggleButtonActive}`,onClick:()=>{B(),dt({droppedCeiling:{...b.droppedCeiling,enabled:!1},mainDoorCount:void 0,droppedCeilingDoorCount:void 0}),$e("slotA")},children:r("common.none")}),l.jsx("button",{className:`${Vt.toggleButton} ${(vt=b.droppedCeiling)!=null&&vt.enabled?Vt.toggleButtonActive:""}`,onClick:()=>{var ue;if(!((ue=b.droppedCeiling)!=null&&ue.enabled)){B();const ke=b.width||4800,Me=900,Oe=ke-Me,nt=Wt(Oe),gt=Mt(),Ae=Math.max(nt.min,Math.min(nt.max,gt)),Xe=Me-50,qe=ro.getDefaultColumnCount(Xe);dt({droppedCeiling:{enabled:!0,width:Me,dropHeight:200,position:"right"},droppedCeilingDoorCount:qe,mainDoorCount:Ae}),$e("slotA")}},children:r("common.enabled")})]}),((kt=b.droppedCeiling)==null?void 0:kt.enabled)&&l.jsxs("div",{style:{marginTop:"16px"},children:[l.jsx("div",{className:Vt.inputLabel,style:{marginBottom:"8px"},children:r("placement.droppedCeilingPosition")}),l.jsxs("div",{className:Vt.toggleButtonGroup,children:[l.jsx("button",{className:`${Vt.toggleButton} ${(((mn=b.droppedCeiling)==null?void 0:mn.position)||"right")==="left"?Vt.toggleButtonActive:""}`,onClick:()=>{dt({droppedCeiling:{...b.droppedCeiling,enabled:!0,position:"left"}})},children:r("furniture.left")}),l.jsx("button",{className:`${Vt.toggleButton} ${(((sn=b.droppedCeiling)==null?void 0:sn.position)||"right")==="right"?Vt.toggleButtonActive:""}`,onClick:()=>{dt({droppedCeiling:{...b.droppedCeiling,enabled:!0,position:"right"}})},children:r("furniture.right")})]})]})]}),((bn=b.droppedCeiling)==null?void 0:bn.enabled)&&l.jsxs("div",{className:Vt.configSection,children:[l.jsxs("div",{className:Vt.sectionHeader,children:[l.jsx("span",{className:Vt.sectionDot}),l.jsx("h3",{className:Vt.sectionTitle,children:r("space.mainSectionSize")})]}),l.jsxs("div",{style:{display:"flex",gap:"12px"},children:[l.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:"8px"},children:[l.jsx("span",{style:{minWidth:"20px",color:"var(--theme-primary)"},children:"W"}),l.jsxs("div",{className:Vt.inputWithUnit,style:{flex:1},children:[l.jsx("input",{type:"text",min:"100",max:(b.width||4800)-100,step:"10",defaultValue:(b.width||4800)-(((Li=b.droppedCeiling)==null?void 0:Li.width)||yo.WIDTH),onKeyDown:ue=>{ue.key==="Enter"&&(ue.preventDefault(),ue.target.blur())},onBlur:ue=>{var me;const ke=ue.target.value,Me=b.width||4800,Oe=((me=b.droppedCeiling)==null?void 0:me.width)||yo.WIDTH,nt=Me-Oe;if(ke===""||isNaN(parseInt(ke))){ue.target.value=nt.toString();return}const gt=parseInt(ke),Ae=Me-gt;Ae<100?(ue.target.value=(Me-100).toString(),dt({droppedCeiling:{...b.droppedCeiling,enabled:!0,width:100}})):Ae>Me-100?(ue.target.value="100",dt({droppedCeiling:{...b.droppedCeiling,enabled:!0,width:Me-100}})):dt({droppedCeiling:{...b.droppedCeiling,enabled:!0,width:Ae}})},className:`${Vt.input} ${Vt.inputWithUnitField}`},`main-width-${(b.width||4800)-(((Wn=b.droppedCeiling)==null?void 0:Wn.width)||yo.WIDTH)}`),l.jsx("span",{className:Vt.unit,children:"mm"})]})]}),l.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:"8px"},children:[l.jsx("span",{style:{minWidth:"20px",color:"var(--theme-primary)"},children:"H"}),l.jsxs("div",{className:Vt.inputWithUnit,style:{flex:1},children:[l.jsx("input",{type:"text",defaultValue:b.height||2400,onChange:ue=>{ue.target.value},onBlur:ue=>{const ke=ue.target.value;if(ke===""){ue.target.value=(b.height||2400).toString();return}const Me=parseInt(ke),Oe=1800,nt=3e3;Me<Oe?(ue.target.value=Oe.toString(),dt({height:Oe})):Me>nt?(ue.target.value=nt.toString(),dt({height:nt})):dt({height:Me})},onKeyDown:ue=>{if(ue.key==="Enter")ue.preventDefault(),ue.target.blur();else if(ue.key==="ArrowUp"||ue.key==="ArrowDown"){ue.preventDefault();const ke=parseInt(ue.target.value)||b.height||2400,Me=1800,Oe=3e3;let nt;ue.key==="ArrowUp"?nt=Math.min(ke+1,Oe):nt=Math.max(ke-1,Me),nt!==ke&&(ue.target.value=nt.toString(),dt({height:nt}))}},className:`${Vt.input} ${Vt.inputWithUnitField}`,placeholder:"1800-3000"},`main-height-${b.height||2400}`),l.jsx("span",{className:Vt.unit,children:"mm"})]})]})]})]}),((ui=b.droppedCeiling)==null?void 0:ui.enabled)&&l.jsxs("div",{className:Vt.configSection,children:[l.jsxs("div",{className:Vt.sectionHeader,children:[l.jsx("span",{className:Vt.sectionDot}),l.jsx("h3",{className:Vt.sectionTitle,children:r("space.droppedSectionSize")})]}),l.jsxs("div",{style:{display:"flex",gap:"12px"},children:[l.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:"8px"},children:[l.jsx("span",{style:{minWidth:"20px",color:"var(--theme-primary)"},children:"W"}),l.jsxs("div",{className:Vt.inputWithUnit,style:{flex:1},children:[l.jsx("input",{type:"text",min:"100",max:(b.width||4800)-100,step:"10",defaultValue:((Mi=b.droppedCeiling)==null?void 0:Mi.width)||yo.WIDTH,onKeyDown:ue=>{ue.key==="Enter"&&(ue.preventDefault(),ue.target.blur())},onBlur:ue=>{var gt;const ke=ue.target.value,Me=b.width||4800,Oe=((gt=b.droppedCeiling)==null?void 0:gt.width)||yo.WIDTH;if(ke===""||isNaN(parseInt(ke))){ue.target.value=Oe.toString();return}const nt=parseInt(ke);nt<100?(ue.target.value="100",dt({droppedCeiling:{...b.droppedCeiling,enabled:!0,width:100}})):nt>Me-100?(ue.target.value=(Me-100).toString(),dt({droppedCeiling:{...b.droppedCeiling,enabled:!0,width:Me-100}})):dt({droppedCeiling:{...b.droppedCeiling,enabled:!0,width:nt}})},className:`${Vt.input} ${Vt.inputWithUnitField}`},`dropped-width-${((Gn=b.droppedCeiling)==null?void 0:Gn.width)||yo.WIDTH}`),l.jsx("span",{className:Vt.unit,children:"mm"})]})]}),l.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:"8px"},children:[l.jsx("span",{style:{minWidth:"20px",color:"var(--theme-primary)"},children:"H"}),l.jsxs("div",{className:Vt.inputWithUnit,style:{flex:1},children:[l.jsx("input",{type:"text",min:"1800",max:"2900",step:"10",defaultValue:(b.height||2400)-(((Dn=b.droppedCeiling)==null?void 0:Dn.dropHeight)||200),onKeyDown:ue=>{ue.key==="Enter"&&(ue.preventDefault(),ue.target.blur())},onBlur:ue=>{var Ae;const ke=ue.target.value,Me=b.height||2400,Oe=Me-(((Ae=b.droppedCeiling)==null?void 0:Ae.dropHeight)||200);if(ke===""||isNaN(parseInt(ke))){ue.target.value=Oe.toString();return}const nt=parseInt(ke),gt=Me-nt;if(gt<100){const me=Me-100;ue.target.value=me.toString(),dt({droppedCeiling:{...b.droppedCeiling,enabled:!0,dropHeight:100}})}else if(gt>500){const me=Me-500;ue.target.value=me.toString(),dt({droppedCeiling:{...b.droppedCeiling,enabled:!0,dropHeight:500}})}else dt({droppedCeiling:{...b.droppedCeiling,enabled:!0,dropHeight:gt}})},className:`${Vt.input} ${Vt.inputWithUnitField}`},`dropped-height-${(b.height||2400)-(((li=b.droppedCeiling)==null?void 0:li.dropHeight)||200)}`),l.jsx("span",{className:Vt.unit,children:"mm"})]})]})]})]}),l.jsxs("div",{className:Vt.configSection,children:[l.jsxs("div",{className:Vt.sectionHeader,children:[l.jsx("span",{className:Vt.sectionDot}),l.jsx("h3",{className:Vt.sectionTitle,children:r("space.columnCount")})]}),console.log("🔍 레이아웃 섹션 렌더링:",{activeTab:Ye,단내림활성화:(en=b.droppedCeiling)==null?void 0:en.enabled,mainDoorCount:b.mainDoorCount,customColumnCount:b.customColumnCount}),(Rt=b.droppedCeiling)!=null&&Rt.enabled?l.jsxs("div",{children:[l.jsx("div",{className:Vt.inputGroup,children:l.jsx(q4,{value:b.mainDoorCount||Mt(),onChange:ue=>{dt({mainDoorCount:ue})},width:b.width||4800})}),l.jsx("div",{className:Vt.inputGroup,style:{marginTop:"24px"},children:l.jsx(q4,{value:b.droppedCeilingDoorCount||1,onChange:ue=>{dt({droppedCeilingDoorCount:ue})},width:((Xn=b.droppedCeiling)==null?void 0:Xn.width)||yo.WIDTH})})]}):l.jsx("div",{className:Vt.inputGroup,children:l.jsx(q4,{value:Mt(),onChange:ue=>{dt({customColumnCount:ue})},width:b.width||4800})})]}),l.jsxs("div",{className:Vt.configSection,children:[l.jsxs("div",{className:Vt.sectionHeader,children:[l.jsx("span",{className:Vt.sectionDot}),l.jsx("h3",{className:Vt.sectionTitle,children:r("space.installType")})]}),l.jsx(RIe,{spaceInfo:b,onUpdate:dt})]}),l.jsxs("div",{className:Vt.configSection,children:[l.jsxs("div",{className:Vt.sectionHeader,children:[l.jsx("span",{className:Vt.sectionDot}),l.jsx("h3",{className:Vt.sectionTitle,children:r("frame.title")})]}),l.jsxs("div",{className:Vt.toggleButtonGroup,children:[l.jsx("button",{className:`${Vt.toggleButton} ${(b.surroundType||"surround")==="surround"?Vt.active:""}`,onClick:()=>dt({surroundType:"surround"}),children:r("space.surround")}),l.jsx("button",{className:`${Vt.toggleButton} ${(b.surroundType||"surround")==="no-surround"?Vt.active:""}`,onClick:()=>dt({surroundType:"no-surround"}),children:r("space.noSurround")})]}),(b.surroundType||"surround")==="surround"&&l.jsxs("div",{className:Vt.subSetting,children:[l.jsx("label",{className:Vt.subLabel,children:r("frame.frameWidth")}),l.jsxs("div",{className:Vt.frameGrid,children:[l.jsxs("div",{className:Vt.frameItem,children:[l.jsx("label",{className:Vt.frameItemLabel,children:b.installType==="builtin"||b.installType==="semistanding"&&((Ui=b.wallConfig)!=null&&Ui.left)?r("furniture.left"):b.installType==="semistanding"&&!((tt=b.wallConfig)!=null&&tt.left)?`${r("furniture.left")}(${r("frame.endPanel")})`:b.installType==="freestanding"?`${r("furniture.left")}(${r("frame.endPanel")})`:r("furniture.left")}),l.jsxs("div",{className:Vt.frameItemInput,children:[l.jsx("button",{className:Vt.frameButton,onClick:()=>{var Me;const ue=((Me=b.frameSize)==null?void 0:Me.left)||50,ke=Math.max(10,ue-1);jt("left",ke)},disabled:b.installType==="semistanding"&&!((Jt=b.wallConfig)!=null&&Jt.left)||b.installType==="freestanding",children:"−"}),l.jsx("input",{type:"number",min:"10",max:"100",value:((wn=b.frameSize)==null?void 0:wn.left)||50,onChange:ue=>{const ke=Math.min(100,Math.max(10,parseInt(ue.target.value)||50));jt("left",ke)},onFocus:()=>ie("left"),onBlur:()=>ie(null),className:Vt.frameNumberInput,disabled:b.installType==="semistanding"&&!((Yn=b.wallConfig)!=null&&Yn.left)||b.installType==="freestanding"}),l.jsx("button",{className:Vt.frameButton,onClick:()=>{var Me;const ue=((Me=b.frameSize)==null?void 0:Me.left)||50,ke=Math.min(100,ue+1);jt("left",ke)},disabled:b.installType==="semistanding"&&!((hi=b.wallConfig)!=null&&hi.left)||b.installType==="freestanding",children:"+"})]})]}),l.jsxs("div",{className:Vt.frameItem,children:[l.jsx("label",{className:Vt.frameItemLabel,children:b.installType==="builtin"||b.installType==="semistanding"&&((Xt=b.wallConfig)!=null&&Xt.right)?r("furniture.right"):b.installType==="semistanding"&&!((_i=b.wallConfig)!=null&&_i.right)?`${r("furniture.right")}(${r("frame.endPanel")})`:b.installType==="freestanding"?`${r("furniture.right")}(${r("frame.endPanel")})`:r("furniture.right")}),l.jsxs("div",{className:Vt.frameItemInput,children:[l.jsx("button",{className:Vt.frameButton,onClick:()=>{var Me;const ue=((Me=b.frameSize)==null?void 0:Me.right)||50,ke=Math.max(10,ue-1);jt("right",ke)},disabled:b.installType==="semistanding"&&!((Pr=b.wallConfig)!=null&&Pr.right)||b.installType==="freestanding",children:"−"}),l.jsx("input",{type:"number",min:"10",max:"100",value:((ws=b.frameSize)==null?void 0:ws.right)||50,onChange:ue=>{const ke=Math.min(100,Math.max(10,parseInt(ue.target.value)||50));jt("right",ke)},onFocus:()=>ie("right"),onBlur:()=>ie(null),className:Vt.frameNumberInput,disabled:b.installType==="semistanding"&&!((Vi=b.wallConfig)!=null&&Vi.right)||b.installType==="freestanding"}),l.jsx("button",{className:Vt.frameButton,onClick:()=>{var Me;const ue=((Me=b.frameSize)==null?void 0:Me.right)||50,ke=Math.min(100,ue+1);jt("right",ke)},disabled:b.installType==="semistanding"&&!((br=b.wallConfig)!=null&&br.right)||b.installType==="freestanding",children:"+"})]})]}),l.jsxs("div",{className:Vt.frameItem,children:[l.jsx("label",{className:Vt.frameItemLabel,children:r("viewer.top")}),l.jsxs("div",{className:Vt.frameItemInput,children:[l.jsx("button",{className:Vt.frameButton,onClick:()=>{var Me;const ue=((Me=b.frameSize)==null?void 0:Me.top)||50,ke=Math.max(10,ue-1);jt("top",ke)},children:"−"}),l.jsx("input",{type:"number",min:"10",max:"100",value:((_r=b.frameSize)==null?void 0:_r.top)||50,onChange:ue=>{const ke=Math.min(100,Math.max(10,parseInt(ue.target.value)||50));jt("top",ke)},onFocus:()=>ie("top"),onBlur:()=>ie(null),className:Vt.frameNumberInput}),l.jsx("button",{className:Vt.frameButton,onClick:()=>{var Me;const ue=((Me=b.frameSize)==null?void 0:Me.top)||50,ke=Math.min(100,ue+1);jt("top",ke)},children:"+"})]})]})]}),l.jsxs("div",{className:Vt.frameUnit,children:[r("common.unit"),": mm"]})]})]}),l.jsx(ZIe,{spaceInfo:b,onUpdate:dt}),l.jsxs("div",{className:Vt.configSection,children:[l.jsxs("div",{className:Vt.sectionHeader,children:[l.jsx("span",{className:Vt.sectionDot}),l.jsx("h3",{className:Vt.sectionTitle,children:r("placement.title")})]}),l.jsx(tFe,{spaceInfo:b,onUpdate:dt,disabled:!1})]}),((Qr=b.baseConfig)==null?void 0:Qr.placementType)!=="float"&&l.jsxs("div",{className:Vt.configSection,children:[l.jsxs("div",{className:Vt.sectionHeader,children:[l.jsx("span",{className:Vt.sectionDot}),l.jsx("h3",{className:Vt.sectionTitle,children:r("material.floorFinish")})]}),l.jsx(OIe,{spaceInfo:b,onUpdate:dt})]})]})};return o?l.jsx("div",{className:Vt.loadingContainer,children:l.jsx(Gm,{size:"large",type:"spinner"})}):(console.log("🔍 Configurator basicInfo.title:",T.title),console.log("🔍 currentProjectId:",f),console.log("🔍 currentDesignFileName:",y),console.log("🔍 basicInfo.title:",T.title),l.jsxs("div",{className:Vt.configurator,children:[l.jsx(Cbe,{title:y||T.title||"새로운 디자인",projectName:T.title||"새로운 프로젝트",designFileName:y,projectId:f,designFileId:g,onSave:At,onPrevious:Ot,onHelp:Cn,onConvert:Rn,onLogout:xn,onProfile:En,saving:c,saveStatus:u,hasDoorsInstalled:on,onNewProject:zt,onSaveAs:$t,onProjectNameChange:Ht,onExportPDF:Ti,onFileTreeToggle:Hn,isFileTreeOpen:Ve}),l.jsxs("div",{className:Vt.mainContent,children:[Ve&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:Vt.fileTreeOverlay,onClick:()=>We(!1)}),l.jsx("div",{className:Vt.fileTreePanel,children:l.jsx(XCe,{onFileSelect:async(pt,vt,kt)=>{if(console.log("🗂️ 파일트리에서 선택된 파일:",{projectId:pt,designFileId:vt,designFileName:kt}),g&&(b||S.length>0)){console.log("💾 디자인 전환 전 자동 저장 시작"),h(!0),d("idle");try{await At(),console.log("✅ 자동 저장 완료")}catch(mn){if(console.error("❌ 자동 저장 실패:",mn),!confirm("현재 작업을 저장하는데 실패했습니다. 그래도 다른 디자인으로 전환하시겠습니까?")){h(!1);return}}}vt?t(`/configurator?projectId=${pt}&designFileId=${vt}&designFileName=${encodeURIComponent(kt)}`,{replace:!0}):t(`/configurator?projectId=${pt}&designFileName=${encodeURIComponent(kt)}`,{replace:!0}),We(!1)},onCreateNew:async()=>{if(console.log("🆕 파일트리에서 새 파일 생성 요청"),g&&(b||S.length>0)){console.log("💾 새 디자인 생성 전 자동 저장 시작"),h(!0),d("idle");try{await At(),console.log("✅ 자동 저장 완료")}catch(pt){if(console.error("❌ 자동 저장 실패:",pt),!confirm("현재 작업을 저장하는데 실패했습니다. 그래도 새 디자인을 생성하시겠습니까?")){h(!1);return}}}Zt(),We(!1)},onClose:()=>We(!1)})})]}),l.jsx("button",{className:`${Vt.leftPanelToggle} ${Ce?Vt.open:""}`,onClick:()=>Be(Ce?null:"module"),title:Ce?"사이드바 접기":"사이드바 펼치기",children:l.jsx("span",{className:Vt.foldToggleIcon,children:Ce?"<":">"})}),l.jsx(Wbe,{activeTab:Ce,onTabClick:Lt,isOpen:!!Ce,onToggle:()=>Be(Ce?null:"module"),onResetUnsavedChanges:Re}),l.jsx("div",{className:Vt.sidebarContent,style:{transform:Ce?"translateX(0) scale(1)":"translateX(-100%) scale(0.95)",opacity:Ce?1:0,pointerEvents:Ce?"auto":"none"},children:ti()}),l.jsxs("div",{className:Vt.viewerArea,style:{position:"absolute",left:Ce?"304px":"64px",right:ot?"320px":"0",top:0,bottom:0,transition:"left 0.3s cubic-bezier(0.4, 0, 0.2, 1), right 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:[l.jsx(Z_e,{viewMode:K,onViewModeChange:pt=>{P(pt),pt==="2D"?Te("wireframe"):pt==="3D"&&Te("solid")},viewDirection:Z,onViewDirectionChange:Q,renderMode:xe,onRenderModeChange:Te,showAll:Ie,onShowAllToggle:()=>Le(!Ie),showDimensions:U,onShowDimensionsToggle:z,showDimensionsText:q,onShowDimensionsTextToggle:G,showGuides:be,onShowGuidesToggle:_e,showAxis:W,onShowAxisToggle:Y,showFurniture:ne,onShowFurnitureToggle:()=>he(!ne),doorsOpen:M,onDoorsToggle:X,hasDoorsInstalled:on,onDoorInstallationToggle:at}),l.jsxs("div",{className:Vt.viewer,children:[on&&l.jsxs("div",{className:Vt.viewerDoorToggle,children:[l.jsx("button",{className:`${Vt.viewerDoorButton} ${M?"":Vt.active}`,onClick:()=>!M||X(),children:r("viewer.doorClose")}),l.jsx("button",{className:`${Vt.viewerDoorButton} ${M?Vt.active:""}`,onClick:()=>M||X(),children:r("viewer.doorOpen")})]}),l.jsx(F5,{spaceInfo:b,viewMode:K,setViewMode:P,renderMode:xe,showAll:Ie,showFurniture:ne,showFrame:!0,svgSize:{width:800,height:600},activeZone:void 0},`space3d-${(Oi=b.droppedCeiling)==null?void 0:Oi.enabled}-${(rn=b.droppedCeiling)==null?void 0:rn.position}-${($n=b.droppedCeiling)==null?void 0:$n.width}-${(Fn=b.droppedCeiling)==null?void 0:Fn.dropHeight}`)]})]}),l.jsx("button",{className:`${Vt.rightPanelToggle} ${ot?Vt.open:""}`,onClick:()=>rt(!ot),title:ot?"우측 패널 접기":"우측 패널 펼치기",children:l.jsx("span",{className:Vt.foldToggleIcon,children:ot?">":"<"})}),l.jsx("div",{className:Vt.rightPanelContainer,style:{width:ot?"320px":"0",transition:"width 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:l.jsxs("div",{className:Vt.rightPanel,style:{transform:ot?"translateX(0)":"translateX(100%)",opacity:ot?1:0,pointerEvents:ot?"auto":"none"},children:[l.jsx("div",{className:Vt.rightPanelHeader,children:l.jsx("div",{className:Vt.rightPanelTabs,children:l.jsxs("div",{className:Vt.tabGroup,children:[l.jsx("button",{className:`${Vt.rightPanelTab} ${Ye==="placement"?Vt.active:""}`,onClick:()=>$e("placement"),children:"배치속성"}),l.jsx("button",{className:`${Vt.rightPanelTab} ${Ye==="module"?Vt.active:""}`,onClick:()=>$e("module"),children:"배치모듈"})]})})}),l.jsx("div",{className:Vt.rightPanelContent,children:Gi()})]})})]}),l.jsx(C5e,{}),l.jsx(CSe,{}),l.jsx(O3e,{columnId:te.type==="columnEdit"?te.id:null,isOpen:te.type==="columnEdit",onClose:ye}),l.jsx(MIe,{isOpen:et,onClose:()=>ct(!1)}),l.jsx(zX,{isOpen:je,onClose:()=>{const pt=new URLSearchParams(e.toString());pt.delete("editor");const vt=pt.toString();window.history.replaceState(null,"",`${window.location.pathname}${vt?"?"+vt:""}`),le(!1)},capturedViews:Je})]}))},PF=O.createContext({});function hw(n){const e=O.useRef(null);return e.current===null&&(e.current=n()),e.current}const NF=typeof window<"u",LF=NF?O.useLayoutEffect:O.useEffect,lS=O.createContext(null);function MF(n,e){n.indexOf(e)===-1&&n.push(e)}function RF(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const BA=(n,e,t)=>t>e?e:t<n?n:t;let OF=()=>{};const EA={},GX=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n);function XX(n){return typeof n=="object"&&n!==null}const KX=n=>/^0[^.\s]+$/u.test(n);function UF(n){let e;return()=>(e===void 0&&(e=n()),e)}const zh=n=>n,A8e=(n,e)=>t=>e(n(t)),uw=(...n)=>n.reduce(A8e),xv=(n,e,t)=>{const i=e-n;return i===0?1:(t-n)/i};class HF{constructor(){this.subscriptions=[]}add(e){return MF(this.subscriptions,e),()=>RF(this.subscriptions,e)}notify(e,t,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,t,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,t,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const yd=n=>n*1e3,vd=n=>n/1e3;function qX(n,e){return e?n*(1e3/e):0}const YX=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,f8e=1e-7,p8e=12;function g8e(n,e,t,i,r){let s,o,a=0;do o=e+(t-e)/2,s=YX(o,i,r)-n,s>0?t=o:e=o;while(Math.abs(s)>f8e&&++a<p8e);return o}function dw(n,e,t,i){if(n===e&&t===i)return zh;const r=s=>g8e(s,0,1,n,t);return s=>s===0||s===1?s:YX(r(s),e,i)}const ZX=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,JX=n=>e=>1-n(1-e),eK=dw(.33,1.53,.69,.99),WF=JX(eK),tK=ZX(WF),nK=n=>(n*=2)<1?.5*WF(n):.5*(2-Math.pow(2,-10*(n-1))),QF=n=>1-Math.sin(Math.acos(n)),iK=JX(QF),rK=ZX(QF),m8e=dw(.42,0,1,1),y8e=dw(0,0,.58,1),sK=dw(.42,0,.58,1),v8e=n=>Array.isArray(n)&&typeof n[0]!="number",oK=n=>Array.isArray(n)&&typeof n[0]=="number",w8e={linear:zh,easeIn:m8e,easeInOut:sK,easeOut:y8e,circIn:QF,circInOut:rK,circOut:iK,backIn:WF,backInOut:tK,backOut:eK,anticipate:nK},x8e=n=>typeof n=="string",H7=n=>{if(oK(n)){OF(n.length===4);const[e,t,i,r]=n;return dw(e,t,i,r)}else if(x8e(n))return w8e[n];return n},Sb=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function b8e(n,e){let t=new Set,i=new Set,r=!1,s=!1;const o=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function c(u){o.has(u)&&(h.schedule(u),n()),u(a)}const h={schedule:(u,d=!1,f=!1)=>{const g=f&&r?t:i;return d&&o.add(u),g.has(u)||g.add(u),u},cancel:u=>{i.delete(u),o.delete(u)},process:u=>{if(a=u,r){s=!0;return}r=!0,[t,i]=[i,t],t.forEach(c),t.clear(),r=!1,s&&(s=!1,h.process(u))}};return h}const _8e=40;function aK(n,e){let t=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=()=>t=!0,o=Sb.reduce((w,x)=>(w[x]=b8e(s),w),{}),{setup:a,read:c,resolveKeyframes:h,preUpdate:u,update:d,preRender:f,render:A,postRender:g}=o,p=()=>{const w=EA.useManualTiming?r.timestamp:performance.now();t=!1,EA.useManualTiming||(r.delta=i?1e3/60:Math.max(Math.min(w-r.timestamp,_8e),1)),r.timestamp=w,r.isProcessing=!0,a.process(r),c.process(r),h.process(r),u.process(r),d.process(r),f.process(r),A.process(r),g.process(r),r.isProcessing=!1,t&&e&&(i=!1,n(p))},y=()=>{t=!0,i=!0,r.isProcessing||n(p)};return{schedule:Sb.reduce((w,x)=>{const T=o[x];return w[x]=(j,D=!1,b=!1)=>(t||y(),T.schedule(j,D,b)),w},{}),cancel:w=>{for(let x=0;x<Sb.length;x++)o[Sb[x]].cancel(w)},state:r,steps:o}}const{schedule:lo,cancel:kA,state:Cl,steps:kT}=aK(typeof requestAnimationFrame<"u"?requestAnimationFrame:zh,!0);let l_;function C8e(){l_=void 0}const Uc={now:()=>(l_===void 0&&Uc.set(Cl.isProcessing||EA.useManualTiming?Cl.timestamp:performance.now()),l_),set:n=>{l_=n,queueMicrotask(C8e)}},lK=n=>e=>typeof e=="string"&&e.startsWith(n),$F=lK("--"),S8e=lK("var(--"),VF=n=>S8e(n)?T8e.test(n.split("/*")[0].trim()):!1,T8e=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,s1={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},bv={...s1,transform:n=>BA(0,1,n)},Tb={...s1,default:1},Wy=n=>Math.round(n*1e5)/1e5,zF=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function B8e(n){return n==null}const E8e=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,GF=(n,e)=>t=>!!(typeof t=="string"&&E8e.test(t)&&t.startsWith(n)||e&&!B8e(t)&&Object.prototype.hasOwnProperty.call(t,e)),cK=(n,e,t)=>i=>{if(typeof i!="string")return i;const[r,s,o,a]=i.match(zF);return{[n]:parseFloat(r),[e]:parseFloat(s),[t]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},k8e=n=>BA(0,255,n),IT={...s1,transform:n=>Math.round(k8e(n))},Gp={test:GF("rgb","red"),parse:cK("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:i=1})=>"rgba("+IT.transform(n)+", "+IT.transform(e)+", "+IT.transform(t)+", "+Wy(bv.transform(i))+")"};function I8e(n){let e="",t="",i="",r="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),i=n.substring(5,7),r=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),i=n.substring(3,4),r=n.substring(4,5),e+=e,t+=t,i+=i,r+=r),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const _6={test:GF("#"),parse:I8e,transform:Gp.transform},Aw=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),df=Aw("deg"),wd=Aw("%"),or=Aw("px"),F8e=Aw("vh"),D8e=Aw("vw"),W7={...wd,parse:n=>wd.parse(n)/100,transform:n=>wd.transform(n*100)},z0={test:GF("hsl","hue"),parse:cK("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:i=1})=>"hsla("+Math.round(n)+", "+wd.transform(Wy(e))+", "+wd.transform(Wy(t))+", "+Wy(bv.transform(i))+")"},va={test:n=>Gp.test(n)||_6.test(n)||z0.test(n),parse:n=>Gp.test(n)?Gp.parse(n):z0.test(n)?z0.parse(n):_6.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Gp.transform(n):z0.transform(n),getAnimatableNone:n=>{const e=va.parse(n);return e.alpha=0,va.transform(e)}},j8e=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function P8e(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(zF))==null?void 0:e.length)||0)+(((t=n.match(j8e))==null?void 0:t.length)||0)>0}const hK="number",uK="color",N8e="var",L8e="var(",Q7="${}",M8e=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function _v(n){const e=n.toString(),t=[],i={color:[],number:[],var:[]},r=[];let s=0;const a=e.replace(M8e,c=>(va.test(c)?(i.color.push(s),r.push(uK),t.push(va.parse(c))):c.startsWith(L8e)?(i.var.push(s),r.push(N8e),t.push(c)):(i.number.push(s),r.push(hK),t.push(parseFloat(c))),++s,Q7)).split(Q7);return{values:t,split:a,indexes:i,types:r}}function dK(n){return _v(n).values}function AK(n){const{split:e,types:t}=_v(n),i=e.length;return r=>{let s="";for(let o=0;o<i;o++)if(s+=e[o],r[o]!==void 0){const a=t[o];a===hK?s+=Wy(r[o]):a===uK?s+=va.transform(r[o]):s+=r[o]}return s}}const R8e=n=>typeof n=="number"?0:va.test(n)?va.getAnimatableNone(n):n;function O8e(n){const e=dK(n);return AK(n)(e.map(R8e))}const Xf={test:P8e,parse:dK,createTransformer:AK,getAnimatableNone:O8e};function FT(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function U8e({hue:n,saturation:e,lightness:t,alpha:i}){n/=360,e/=100,t/=100;let r=0,s=0,o=0;if(!e)r=s=o=t;else{const a=t<.5?t*(1+e):t+e-t*e,c=2*t-a;r=FT(c,a,n+1/3),s=FT(c,a,n),o=FT(c,a,n-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}function DC(n,e){return t=>t>0?e:n}const Po=(n,e,t)=>n+(e-n)*t,DT=(n,e,t)=>{const i=n*n,r=t*(e*e-i)+i;return r<0?0:Math.sqrt(r)},H8e=[_6,Gp,z0],W8e=n=>H8e.find(e=>e.test(n));function $7(n){const e=W8e(n);if(!e)return!1;let t=e.parse(n);return e===z0&&(t=U8e(t)),t}const V7=(n,e)=>{const t=$7(n),i=$7(e);if(!t||!i)return DC(n,e);const r={...t};return s=>(r.red=DT(t.red,i.red,s),r.green=DT(t.green,i.green,s),r.blue=DT(t.blue,i.blue,s),r.alpha=Po(t.alpha,i.alpha,s),Gp.transform(r))},C6=new Set(["none","hidden"]);function Q8e(n,e){return C6.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function $8e(n,e){return t=>Po(n,e,t)}function XF(n){return typeof n=="number"?$8e:typeof n=="string"?VF(n)?DC:va.test(n)?V7:G8e:Array.isArray(n)?fK:typeof n=="object"?va.test(n)?V7:V8e:DC}function fK(n,e){const t=[...n],i=t.length,r=n.map((s,o)=>XF(s)(s,e[o]));return s=>{for(let o=0;o<i;o++)t[o]=r[o](s);return t}}function V8e(n,e){const t={...n,...e},i={};for(const r in t)n[r]!==void 0&&e[r]!==void 0&&(i[r]=XF(n[r])(n[r],e[r]));return r=>{for(const s in i)t[s]=i[s](r);return t}}function z8e(n,e){const t=[],i={color:0,var:0,number:0};for(let r=0;r<e.values.length;r++){const s=e.types[r],o=n.indexes[s][i[s]],a=n.values[o]??0;t[r]=a,i[s]++}return t}const G8e=(n,e)=>{const t=Xf.createTransformer(e),i=_v(n),r=_v(e);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?C6.has(n)&&!r.values.length||C6.has(e)&&!i.values.length?Q8e(n,e):uw(fK(z8e(i,r),r.values),t):DC(n,e)};function pK(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?Po(n,e,t):XF(n)(n,e)}const X8e=n=>{const e=({timestamp:t})=>n(t);return{start:(t=!0)=>lo.update(e,t),stop:()=>kA(e),now:()=>Cl.isProcessing?Cl.timestamp:Uc.now()}},gK=(n,e,t=10)=>{let i="";const r=Math.max(Math.round(e/t),2);for(let s=0;s<r;s++)i+=Math.round(n(s/(r-1))*1e4)/1e4+", ";return`linear(${i.substring(0,i.length-2)})`},jC=2e4;function KF(n){let e=0;const t=50;let i=n.next(e);for(;!i.done&&e<jC;)e+=t,i=n.next(e);return e>=jC?1/0:e}function K8e(n,e=100,t){const i=t({...n,keyframes:[0,e]}),r=Math.min(KF(i),jC);return{type:"keyframes",ease:s=>i.next(r*s).value/e,duration:vd(r)}}const q8e=5;function mK(n,e,t){const i=Math.max(e-q8e,0);return qX(t-n(i),e-i)}const zo={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},jT=.001;function Y8e({duration:n=zo.duration,bounce:e=zo.bounce,velocity:t=zo.velocity,mass:i=zo.mass}){let r,s,o=1-e;o=BA(zo.minDamping,zo.maxDamping,o),n=BA(zo.minDuration,zo.maxDuration,vd(n)),o<1?(r=h=>{const u=h*o,d=u*n,f=u-t,A=S6(h,o),g=Math.exp(-d);return jT-f/A*g},s=h=>{const d=h*o*n,f=d*t+t,A=Math.pow(o,2)*Math.pow(h,2)*n,g=Math.exp(-d),p=S6(Math.pow(h,2),o);return(-r(h)+jT>0?-1:1)*((f-A)*g)/p}):(r=h=>{const u=Math.exp(-h*n),d=(h-t)*n+1;return-jT+u*d},s=h=>{const u=Math.exp(-h*n),d=(t-h)*(n*n);return u*d});const a=5/n,c=J8e(r,s,a);if(n=yd(n),isNaN(c))return{stiffness:zo.stiffness,damping:zo.damping,duration:n};{const h=Math.pow(c,2)*i;return{stiffness:h,damping:o*2*Math.sqrt(i*h),duration:n}}}const Z8e=12;function J8e(n,e,t){let i=t;for(let r=1;r<Z8e;r++)i=i-n(i)/e(i);return i}function S6(n,e){return n*Math.sqrt(1-e*e)}const eDe=["duration","bounce"],tDe=["stiffness","damping","mass"];function z7(n,e){return e.some(t=>n[t]!==void 0)}function nDe(n){let e={velocity:zo.velocity,stiffness:zo.stiffness,damping:zo.damping,mass:zo.mass,isResolvedFromDuration:!1,...n};if(!z7(n,tDe)&&z7(n,eDe))if(n.visualDuration){const t=n.visualDuration,i=2*Math.PI/(t*1.2),r=i*i,s=2*BA(.05,1,1-(n.bounce||0))*Math.sqrt(r);e={...e,mass:zo.mass,stiffness:r,damping:s}}else{const t=Y8e(n);e={...e,...t,mass:zo.mass},e.isResolvedFromDuration=!0}return e}function PC(n=zo.visualDuration,e=zo.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:i,restDelta:r}=t;const s=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],a={done:!1,value:s},{stiffness:c,damping:h,mass:u,duration:d,velocity:f,isResolvedFromDuration:A}=nDe({...t,velocity:-vd(t.velocity||0)}),g=f||0,p=h/(2*Math.sqrt(c*u)),y=o-s,v=vd(Math.sqrt(c/u)),m=Math.abs(y)<5;i||(i=m?zo.restSpeed.granular:zo.restSpeed.default),r||(r=m?zo.restDelta.granular:zo.restDelta.default);let w;if(p<1){const T=S6(v,p);w=j=>{const D=Math.exp(-p*v*j);return o-D*((g+p*v*y)/T*Math.sin(T*j)+y*Math.cos(T*j))}}else if(p===1)w=T=>o-Math.exp(-v*T)*(y+(g+v*y)*T);else{const T=v*Math.sqrt(p*p-1);w=j=>{const D=Math.exp(-p*v*j),b=Math.min(T*j,300);return o-D*((g+p*v*y)*Math.sinh(b)+T*y*Math.cosh(b))/T}}const x={calculatedDuration:A&&d||null,next:T=>{const j=w(T);if(A)a.done=T>=d;else{let D=T===0?g:0;p<1&&(D=T===0?yd(g):mK(w,T,j));const b=Math.abs(D)<=i,_=Math.abs(o-j)<=r;a.done=b&&_}return a.value=a.done?o:j,a},toString:()=>{const T=Math.min(KF(x),jC),j=gK(D=>x.next(T*D).value,T,30);return T+"ms "+j},toTransition:()=>{}};return x}PC.applyToOptions=n=>{const e=K8e(n,100,PC);return n.ease=e.ease,n.duration=yd(e.duration),n.type="keyframes",n};function T6({keyframes:n,velocity:e=0,power:t=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:a,max:c,restDelta:h=.5,restSpeed:u}){const d=n[0],f={done:!1,value:d},A=b=>a!==void 0&&b<a||c!==void 0&&b>c,g=b=>a===void 0?c:c===void 0||Math.abs(a-b)<Math.abs(c-b)?a:c;let p=t*e;const y=d+p,v=o===void 0?y:o(y);v!==y&&(p=v-d);const m=b=>-p*Math.exp(-b/i),w=b=>v+m(b),x=b=>{const _=m(b),I=w(b);f.done=Math.abs(_)<=h,f.value=f.done?v:I};let T,j;const D=b=>{A(f.value)&&(T=b,j=PC({keyframes:[f.value,g(f.value)],velocity:mK(w,b,f.value),damping:r,stiffness:s,restDelta:h,restSpeed:u}))};return D(0),{calculatedDuration:null,next:b=>{let _=!1;return!j&&T===void 0&&(_=!0,x(b),D(b)),T!==void 0&&b>=T?j.next(b-T):(!_&&x(b),f)}}}function iDe(n,e,t){const i=[],r=t||EA.mix||pK,s=n.length-1;for(let o=0;o<s;o++){let a=r(n[o],n[o+1]);if(e){const c=Array.isArray(e)?e[o]||zh:e;a=uw(c,a)}i.push(a)}return i}function yK(n,e,{clamp:t=!0,ease:i,mixer:r}={}){const s=n.length;if(OF(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),e=[...e].reverse());const a=iDe(e,i,r),c=a.length,h=u=>{if(o&&u<n[0])return e[0];let d=0;if(c>1)for(;d<n.length-2&&!(u<n[d+1]);d++);const f=xv(n[d],n[d+1],u);return a[d](f)};return t?u=>h(BA(n[0],n[s-1],u)):h}function rDe(n,e){const t=n[n.length-1];for(let i=1;i<=e;i++){const r=xv(0,e,i);n.push(Po(t,1,r))}}function sDe(n){const e=[0];return rDe(e,n.length-1),e}function oDe(n,e){return n.map(t=>t*e)}function aDe(n,e){return n.map(()=>e||sK).splice(0,n.length-1)}function Qy({duration:n=300,keyframes:e,times:t,ease:i="easeInOut"}){const r=v8e(i)?i.map(H7):H7(i),s={done:!1,value:e[0]},o=oDe(t&&t.length===e.length?t:sDe(e),n),a=yK(o,e,{ease:Array.isArray(r)?r:aDe(e,r)});return{calculatedDuration:n,next:c=>(s.value=a(c),s.done=c>=n,s)}}const lDe=n=>n!==null;function qF(n,{repeat:e,repeatType:t="loop"},i,r=1){const s=n.filter(lDe),a=r<0||e&&t!=="loop"&&e%2===1?0:s.length-1;return!a||i===void 0?s[a]:i}const cDe={decay:T6,inertia:T6,tween:Qy,keyframes:Qy,spring:PC};function vK(n){typeof n.type=="string"&&(n.type=cDe[n.type])}class YF{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const hDe=n=>n/100;class cS extends YF{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var i,r;const{motionValue:t}=this.options;t&&t.updatedAt!==Uc.now()&&this.tick(Uc.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(r=(i=this.options).onStop)==null||r.call(i))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;vK(e);const{type:t=Qy,repeat:i=0,repeatDelay:r=0,repeatType:s,velocity:o=0}=e;let{keyframes:a}=e;const c=t||Qy;c!==Qy&&typeof a[0]!="number"&&(this.mixKeyframes=uw(hDe,pK(a[0],a[1])),a=[0,100]);const h=c({...e,keyframes:a});s==="mirror"&&(this.mirroredGenerator=c({...e,keyframes:[...a].reverse(),velocity:-o})),h.calculatedDuration===null&&(h.calculatedDuration=KF(h));const{calculatedDuration:u}=h;this.calculatedDuration=u,this.resolvedDuration=u+r,this.totalDuration=this.resolvedDuration*(i+1)-r,this.generator=h}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){const{generator:i,totalDuration:r,mixKeyframes:s,mirroredGenerator:o,resolvedDuration:a,calculatedDuration:c}=this;if(this.startTime===null)return i.next(0);const{delay:h=0,keyframes:u,repeat:d,repeatType:f,repeatDelay:A,type:g,onUpdate:p,finalKeyframe:y}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-r/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const v=this.currentTime-h*(this.playbackSpeed>=0?1:-1),m=this.playbackSpeed>=0?v<0:v>r;this.currentTime=Math.max(v,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=r);let w=this.currentTime,x=i;if(d){const b=Math.min(this.currentTime,r)/a;let _=Math.floor(b),I=b%1;!I&&b>=1&&(I=1),I===1&&_--,_=Math.min(_,d+1),!!(_%2)&&(f==="reverse"?(I=1-I,A&&(I-=A/a)):f==="mirror"&&(x=o)),w=BA(0,1,I)*a}const T=m?{done:!1,value:u[0]}:x.next(w);s&&(T.value=s(T.value));let{done:j}=T;!m&&c!==null&&(j=this.playbackSpeed>=0?this.currentTime>=r:this.currentTime<=0);const D=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&j);return D&&g!==T6&&(T.value=qF(u,this.options,y,this.speed)),p&&p(T.value),D&&this.finish(),T}then(e,t){return this.finished.then(e,t)}get duration(){return vd(this.calculatedDuration)}get time(){return vd(this.currentTime)}set time(e){var t;e=yd(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(t=this.driver)==null||t.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Uc.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=vd(this.currentTime))}play(){var r,s;if(this.isStopped)return;const{driver:e=X8e,startTime:t}=this.options;this.driver||(this.driver=e(o=>this.tick(o))),(s=(r=this.options).onPlay)==null||s.call(r);const i=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=i):this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime||(this.startTime=t??i),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Uc.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,t;this.notifyFinished(),this.teardown(),this.state="finished",(t=(e=this.options).onComplete)==null||t.call(e)}cancel(){var e,t;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(t=(e=this.options).onCancel)==null||t.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var t;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(t=this.driver)==null||t.stop(),e.observe(this)}}function uDe(n){for(let e=1;e<n.length;e++)n[e]??(n[e]=n[e-1])}const Xp=n=>n*180/Math.PI,B6=n=>{const e=Xp(Math.atan2(n[1],n[0]));return E6(e)},dDe={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:n=>(Math.abs(n[0])+Math.abs(n[3]))/2,rotate:B6,rotateZ:B6,skewX:n=>Xp(Math.atan(n[1])),skewY:n=>Xp(Math.atan(n[2])),skew:n=>(Math.abs(n[1])+Math.abs(n[2]))/2},E6=n=>(n=n%360,n<0&&(n+=360),n),G7=B6,X7=n=>Math.sqrt(n[0]*n[0]+n[1]*n[1]),K7=n=>Math.sqrt(n[4]*n[4]+n[5]*n[5]),ADe={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:X7,scaleY:K7,scale:n=>(X7(n)+K7(n))/2,rotateX:n=>E6(Xp(Math.atan2(n[6],n[5]))),rotateY:n=>E6(Xp(Math.atan2(-n[2],n[0]))),rotateZ:G7,rotate:G7,skewX:n=>Xp(Math.atan(n[4])),skewY:n=>Xp(Math.atan(n[1])),skew:n=>(Math.abs(n[1])+Math.abs(n[4]))/2};function k6(n){return n.includes("scale")?1:0}function I6(n,e){if(!n||n==="none")return k6(e);const t=n.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let i,r;if(t)i=ADe,r=t;else{const a=n.match(/^matrix\(([-\d.e\s,]+)\)$/u);i=dDe,r=a}if(!r)return k6(e);const s=i[e],o=r[1].split(",").map(pDe);return typeof s=="function"?s(o):o[s]}const fDe=(n,e)=>{const{transform:t="none"}=getComputedStyle(n);return I6(t,e)};function pDe(n){return parseFloat(n.trim())}const o1=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],a1=new Set(o1),q7=n=>n===s1||n===or,gDe=new Set(["x","y","z"]),mDe=o1.filter(n=>!gDe.has(n));function yDe(n){const e=[];return mDe.forEach(t=>{const i=n.getValue(t);i!==void 0&&(e.push([t,i.get()]),i.set(t.startsWith("scale")?1:0))}),e}const rg={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:(n,{transform:e})=>I6(e,"x"),y:(n,{transform:e})=>I6(e,"y")};rg.translateX=rg.x;rg.translateY=rg.y;const sg=new Set;let F6=!1,D6=!1,j6=!1;function wK(){if(D6){const n=Array.from(sg).filter(i=>i.needsMeasurement),e=new Set(n.map(i=>i.element)),t=new Map;e.forEach(i=>{const r=yDe(i);r.length&&(t.set(i,r),i.render())}),n.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const r=t.get(i);r&&r.forEach(([s,o])=>{var a;(a=i.getValue(s))==null||a.set(o)})}),n.forEach(i=>i.measureEndState()),n.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}D6=!1,F6=!1,sg.forEach(n=>n.complete(j6)),sg.clear()}function xK(){sg.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(D6=!0)})}function vDe(){j6=!0,xK(),wK(),j6=!1}class ZF{constructor(e,t,i,r,s,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=i,this.motionValue=r,this.element=s,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(sg.add(this),F6||(F6=!0,lo.read(xK),lo.resolveKeyframes(wK))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:i,motionValue:r}=this;if(e[0]===null){const s=r==null?void 0:r.get(),o=e[e.length-1];if(s!==void 0)e[0]=s;else if(i&&t){const a=i.readValue(t,o);a!=null&&(e[0]=a)}e[0]===void 0&&(e[0]=o),r&&s===void 0&&r.set(e[0])}uDe(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),sg.delete(this)}cancel(){this.state==="scheduled"&&(sg.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const wDe=n=>n.startsWith("--");function xDe(n,e,t){wDe(e)?n.style.setProperty(e,t):n.style[e]=t}const bDe=UF(()=>window.ScrollTimeline!==void 0),_De={};function CDe(n,e){const t=UF(n);return()=>_De[e]??t()}const bK=CDe(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),oy=([n,e,t,i])=>`cubic-bezier(${n}, ${e}, ${t}, ${i})`,Y7={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:oy([0,.65,.55,1]),circOut:oy([.55,0,1,.45]),backIn:oy([.31,.01,.66,-.59]),backOut:oy([.33,1.53,.69,.99])};function _K(n,e){if(n)return typeof n=="function"?bK()?gK(n,e):"ease-out":oK(n)?oy(n):Array.isArray(n)?n.map(t=>_K(t,e)||Y7.easeOut):Y7[n]}function SDe(n,e,t,{delay:i=0,duration:r=300,repeat:s=0,repeatType:o="loop",ease:a="easeOut",times:c}={},h=void 0){const u={[e]:t};c&&(u.offset=c);const d=_K(a,r);Array.isArray(d)&&(u.easing=d);const f={delay:i,duration:r,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"};return h&&(f.pseudoElement=h),n.animate(u,f)}function CK(n){return typeof n=="function"&&"applyToOptions"in n}function TDe({type:n,...e}){return CK(n)&&bK()?n.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class BDe extends YF{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:i,keyframes:r,pseudoElement:s,allowFlatten:o=!1,finalKeyframe:a,onComplete:c}=e;this.isPseudoElement=!!s,this.allowFlatten=o,this.options=e,OF(typeof e.type!="string");const h=TDe(e);this.animation=SDe(t,i,r,h,s),h.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!s){const u=qF(r,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(u):xDe(t,i,u),this.animation.cancel()}c==null||c(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,t;(t=(e=this.animation).finish)==null||t.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,t;this.isPseudoElement||(t=(e=this.animation).commitStyles)==null||t.call(e)}get duration(){var t,i;const e=((i=(t=this.animation.effect)==null?void 0:t.getComputedTiming)==null?void 0:i.call(t).duration)||0;return vd(Number(e))}get time(){return vd(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=yd(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){var i;return this.allowFlatten&&((i=this.animation.effect)==null||i.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&bDe()?(this.animation.timeline=e,zh):t(this)}}const SK={anticipate:nK,backInOut:tK,circInOut:rK};function EDe(n){return n in SK}function kDe(n){typeof n.ease=="string"&&EDe(n.ease)&&(n.ease=SK[n.ease])}const Z7=10;class IDe extends BDe{constructor(e){kDe(e),vK(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:t,onUpdate:i,onComplete:r,element:s,...o}=this.options;if(!t)return;if(e!==void 0){t.set(e);return}const a=new cS({...o,autoplay:!1}),c=yd(this.finishedTime??this.time);t.setWithVelocity(a.sample(c-Z7).value,a.sample(c).value,Z7),a.stop()}}const J7=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(Xf.test(n)||n==="0")&&!n.startsWith("url("));function FDe(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function DDe(n,e,t,i){const r=n[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const s=n[n.length-1],o=J7(r,e),a=J7(s,e);return!o||!a?!1:FDe(n)||(t==="spring"||CK(t))&&i}function P6(n){n.duration=0,n.type}const jDe=new Set(["opacity","clipPath","filter","transform"]),PDe=UF(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function NDe(n){var u;const{motionValue:e,name:t,repeatDelay:i,repeatType:r,damping:s,type:o}=n;if(!(((u=e==null?void 0:e.owner)==null?void 0:u.current)instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:h}=e.owner.getProps();return PDe()&&t&&jDe.has(t)&&(t!=="transform"||!h)&&!c&&!i&&r!=="mirror"&&s!==0&&o!=="inertia"}const LDe=40;class MDe extends YF{constructor({autoplay:e=!0,delay:t=0,type:i="keyframes",repeat:r=0,repeatDelay:s=0,repeatType:o="loop",keyframes:a,name:c,motionValue:h,element:u,...d}){var g;super(),this.stop=()=>{var p,y;this._animation&&(this._animation.stop(),(p=this.stopTimeline)==null||p.call(this)),(y=this.keyframeResolver)==null||y.cancel()},this.createdAt=Uc.now();const f={autoplay:e,delay:t,type:i,repeat:r,repeatDelay:s,repeatType:o,name:c,motionValue:h,element:u,...d},A=(u==null?void 0:u.KeyframeResolver)||ZF;this.keyframeResolver=new A(a,(p,y,v)=>this.onKeyframesResolved(p,y,f,!v),c,h,u),(g=this.keyframeResolver)==null||g.scheduleResolve()}onKeyframesResolved(e,t,i,r){this.keyframeResolver=void 0;const{name:s,type:o,velocity:a,delay:c,isHandoff:h,onUpdate:u}=i;this.resolvedAt=Uc.now(),DDe(e,s,o,a)||((EA.instantAnimations||!c)&&(u==null||u(qF(e,i,t))),e[0]=e[e.length-1],P6(i),i.repeat=0);const f={startTime:r?this.resolvedAt?this.resolvedAt-this.createdAt>LDe?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:t,...i,keyframes:e},A=!h&&NDe(f)?new IDe({...f,element:f.motionValue.owner.current}):new cS(f);A.finished.then(()=>this.notifyFinished()).catch(zh),this.pendingTimeline&&(this.stopTimeline=A.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=A}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),vDe()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const RDe=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function ODe(n){const e=RDe.exec(n);if(!e)return[,];const[,t,i,r]=e;return[`--${t??i}`,r]}function TK(n,e,t=1){const[i,r]=ODe(n);if(!i)return;const s=window.getComputedStyle(e).getPropertyValue(i);if(s){const o=s.trim();return GX(o)?parseFloat(o):o}return VF(r)?TK(r,e,t+1):r}function JF(n,e){return(n==null?void 0:n[e])??(n==null?void 0:n.default)??n}const BK=new Set(["width","height","top","left","right","bottom",...o1]),UDe={test:n=>n==="auto",parse:n=>n},EK=n=>e=>e.test(n),kK=[s1,or,wd,df,D8e,F8e,UDe],e9=n=>kK.find(EK(n));function HDe(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||KX(n):!0}const WDe=new Set(["brightness","contrast","saturate","opacity"]);function QDe(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[i]=t.match(zF)||[];if(!i)return n;const r=t.replace(i,"");let s=WDe.has(e)?1:0;return i!==t&&(s*=100),e+"("+s+r+")"}const $De=/\b([a-z-]*)\(.*?\)/gu,N6={...Xf,getAnimatableNone:n=>{const e=n.match($De);return e?e.map(QDe).join(" "):n}},t9={...s1,transform:Math.round},VDe={rotate:df,rotateX:df,rotateY:df,rotateZ:df,scale:Tb,scaleX:Tb,scaleY:Tb,scaleZ:Tb,skew:df,skewX:df,skewY:df,distance:or,translateX:or,translateY:or,translateZ:or,x:or,y:or,z:or,perspective:or,transformPerspective:or,opacity:bv,originX:W7,originY:W7,originZ:or},e8={borderWidth:or,borderTopWidth:or,borderRightWidth:or,borderBottomWidth:or,borderLeftWidth:or,borderRadius:or,radius:or,borderTopLeftRadius:or,borderTopRightRadius:or,borderBottomRightRadius:or,borderBottomLeftRadius:or,width:or,maxWidth:or,height:or,maxHeight:or,top:or,right:or,bottom:or,left:or,padding:or,paddingTop:or,paddingRight:or,paddingBottom:or,paddingLeft:or,margin:or,marginTop:or,marginRight:or,marginBottom:or,marginLeft:or,backgroundPositionX:or,backgroundPositionY:or,...VDe,zIndex:t9,fillOpacity:bv,strokeOpacity:bv,numOctaves:t9},zDe={...e8,color:va,backgroundColor:va,outlineColor:va,fill:va,stroke:va,borderColor:va,borderTopColor:va,borderRightColor:va,borderBottomColor:va,borderLeftColor:va,filter:N6,WebkitFilter:N6},IK=n=>zDe[n];function FK(n,e){let t=IK(n);return t!==N6&&(t=Xf),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const GDe=new Set(["auto","none","0"]);function XDe(n,e,t){let i=0,r;for(;i<n.length&&!r;){const s=n[i];typeof s=="string"&&!GDe.has(s)&&_v(s).values.length&&(r=n[i]),i++}if(r&&t)for(const s of e)n[s]=FK(t,r)}class KDe extends ZF{constructor(e,t,i,r,s){super(e,t,i,r,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:i}=this;if(!t||!t.current)return;super.readKeyframes();for(let c=0;c<e.length;c++){let h=e[c];if(typeof h=="string"&&(h=h.trim(),VF(h))){const u=TK(h,t.current);u!==void 0&&(e[c]=u),c===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!BK.has(i)||e.length!==2)return;const[r,s]=e,o=e9(r),a=e9(s);if(o!==a)if(q7(o)&&q7(a))for(let c=0;c<e.length;c++){const h=e[c];typeof h=="string"&&(e[c]=parseFloat(h))}else rg[i]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,i=[];for(let r=0;r<e.length;r++)(e[r]===null||HDe(e[r]))&&i.push(r);i.length&&XDe(e,i,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=rg[i](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];r!==void 0&&e.getValue(i,r).jump(r,!1)}measureEndState(){var a;const{element:e,name:t,unresolvedKeyframes:i}=this;if(!e||!e.current)return;const r=e.getValue(t);r&&r.jump(this.measuredOrigin,!1);const s=i.length-1,o=i[s];i[s]=rg[t](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),(a=this.removedTransforms)!=null&&a.length&&this.removedTransforms.forEach(([c,h])=>{e.getValue(c).set(h)}),this.resolveNoneKeyframes()}}function qDe(n,e,t){if(n instanceof EventTarget)return[n];if(typeof n=="string"){let i=document;const r=(t==null?void 0:t[n])??i.querySelectorAll(n);return r?Array.from(r):[]}return Array.from(n)}const DK=(n,e)=>e&&typeof n=="number"?e.transform(n):n;function jK(n){return XX(n)&&"offsetHeight"in n}const n9=30,YDe=n=>!isNaN(parseFloat(n)),$y={current:void 0};class ZDe{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=i=>{var s;const r=Uc.now();if(this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&((s=this.events.change)==null||s.notify(this.current),this.dependents))for(const o of this.dependents)o.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=Uc.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=YDe(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new HF);const i=this.events[e].add(t);return e==="change"?()=>{i(),lo.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,i){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return $y.current&&$y.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const e=Uc.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>n9)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,n9);return qX(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,t;(e=this.dependents)==null||e.clear(),(t=this.events.destroy)==null||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function wg(n,e){return new ZDe(n,e)}const{schedule:t8}=aK(queueMicrotask,!1),du={x:!1,y:!1};function PK(){return du.x||du.y}function JDe(n){return n==="x"||n==="y"?du[n]?null:(du[n]=!0,()=>{du[n]=!1}):du.x||du.y?null:(du.x=du.y=!0,()=>{du.x=du.y=!1})}function NK(n,e){const t=qDe(n),i=new AbortController,r={passive:!0,...e,signal:i.signal};return[t,r,()=>i.abort()]}function i9(n){return!(n.pointerType==="touch"||PK())}function eje(n,e,t={}){const[i,r,s]=NK(n,t),o=a=>{if(!i9(a))return;const{target:c}=a,h=e(c,a);if(typeof h!="function"||!c)return;const u=d=>{i9(d)&&(h(d),c.removeEventListener("pointerleave",u))};c.addEventListener("pointerleave",u,r)};return i.forEach(a=>{a.addEventListener("pointerenter",o,r)}),s}const LK=(n,e)=>e?n===e?!0:LK(n,e.parentElement):!1,n8=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,tje=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function nje(n){return tje.has(n.tagName)||n.tabIndex!==-1}const c_=new WeakSet;function r9(n){return e=>{e.key==="Enter"&&n(e)}}function PT(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const ije=(n,e)=>{const t=n.currentTarget;if(!t)return;const i=r9(()=>{if(c_.has(t))return;PT(t,"down");const r=r9(()=>{PT(t,"up")}),s=()=>PT(t,"cancel");t.addEventListener("keyup",r,e),t.addEventListener("blur",s,e)});t.addEventListener("keydown",i,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",i),e)};function s9(n){return n8(n)&&!PK()}function rje(n,e,t={}){const[i,r,s]=NK(n,t),o=a=>{const c=a.currentTarget;if(!s9(a))return;c_.add(c);const h=e(c,a),u=(A,g)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",f),c_.has(c)&&c_.delete(c),s9(A)&&typeof h=="function"&&h(A,{success:g})},d=A=>{u(A,c===window||c===document||t.useGlobalTarget||LK(c,A.target))},f=A=>{u(A,!1)};window.addEventListener("pointerup",d,r),window.addEventListener("pointercancel",f,r)};return i.forEach(a=>{(t.useGlobalTarget?window:a).addEventListener("pointerdown",o,r),jK(a)&&(a.addEventListener("focus",h=>ije(h,r)),!nje(a)&&!a.hasAttribute("tabindex")&&(a.tabIndex=0))}),s}function MK(n){return XX(n)&&"ownerSVGElement"in n}function sje(n){return MK(n)&&n.tagName==="svg"}function oje(...n){const e=!Array.isArray(n[0]),t=e?0:-1,i=n[0+t],r=n[1+t],s=n[2+t],o=n[3+t],a=yK(r,s,o);return e?a(i):a}const hl=n=>!!(n&&n.getVelocity);function aje(n,e,t){const i=n.get();let r=null,s=i,o;const a=typeof i=="string"?i.replace(/[\d.-]/g,""):void 0,c=()=>{r&&(r.stop(),r=null)},h=()=>{c(),r=new cS({keyframes:[a9(n.get()),a9(s)],velocity:n.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...t,onUpdate:o})};if(n.attach((u,d)=>(s=u,o=f=>d(o9(f,a)),lo.postRender(h),n.get()),c),hl(e)){const u=e.on("change",f=>n.set(o9(f,a))),d=n.on("destroy",u);return()=>{u(),d()}}return c}function o9(n,e){return e?n+e:n}function a9(n){return typeof n=="number"?n:parseFloat(n)}const lje=[...kK,va,Xf],cje=n=>lje.find(EK(n)),fw=O.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});class hje extends O.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const i=t.offsetParent,r=jK(i)&&i.offsetWidth||0,s=this.props.sizeRef.current;s.height=t.offsetHeight||0,s.width=t.offsetWidth||0,s.top=t.offsetTop,s.left=t.offsetLeft,s.right=r-s.width-s.left}return null}componentDidUpdate(){}render(){return this.props.children}}function uje({children:n,isPresent:e,anchorX:t,root:i}){const r=O.useId(),s=O.useRef(null),o=O.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:a}=O.useContext(fw);return O.useInsertionEffect(()=>{const{width:c,height:h,top:u,left:d,right:f}=o.current;if(e||!s.current||!c||!h)return;const A=t==="left"?`left: ${d}`:`right: ${f}`;s.current.dataset.motionPopId=r;const g=document.createElement("style");a&&(g.nonce=a);const p=i??document.head;return p.appendChild(g),g.sheet&&g.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${c}px !important;
            height: ${h}px !important;
            ${A}px !important;
            top: ${u}px !important;
          }
        `),()=>{p.contains(g)&&p.removeChild(g)}},[e]),l.jsx(hje,{isPresent:e,childRef:s,sizeRef:o,children:O.cloneElement(n,{ref:s})})}const dje=({children:n,initial:e,isPresent:t,onExitComplete:i,custom:r,presenceAffectsLayout:s,mode:o,anchorX:a,root:c})=>{const h=hw(Aje),u=O.useId();let d=!0,f=O.useMemo(()=>(d=!1,{id:u,initial:e,isPresent:t,custom:r,onExitComplete:A=>{h.set(A,!0);for(const g of h.values())if(!g)return;i&&i()},register:A=>(h.set(A,!1),()=>h.delete(A))}),[t,h,i]);return s&&d&&(f={...f}),O.useMemo(()=>{h.forEach((A,g)=>h.set(g,!1))},[t]),O.useEffect(()=>{!t&&!h.size&&i&&i()},[t]),o==="popLayout"&&(n=l.jsx(uje,{isPresent:t,anchorX:a,root:c,children:n})),l.jsx(lS.Provider,{value:f,children:n})};function Aje(){return new Map}function RK(n=!0){const e=O.useContext(lS);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:i,register:r}=e,s=O.useId();O.useEffect(()=>{if(n)return r(s)},[n]);const o=O.useCallback(()=>n&&i&&i(s),[s,i,n]);return!t&&i?[!1,o]:[!0]}const Bb=n=>n.key||"";function l9(n){const e=[];return O.Children.forEach(n,t=>{O.isValidElement(t)&&e.push(t)}),e}const Cv=({children:n,custom:e,initial:t=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:s="sync",propagate:o=!1,anchorX:a="left",root:c})=>{const[h,u]=RK(o),d=O.useMemo(()=>l9(n),[n]),f=o&&!h?[]:d.map(Bb),A=O.useRef(!0),g=O.useRef(d),p=hw(()=>new Map),[y,v]=O.useState(d),[m,w]=O.useState(d);LF(()=>{A.current=!1,g.current=d;for(let j=0;j<m.length;j++){const D=Bb(m[j]);f.includes(D)?p.delete(D):p.get(D)!==!0&&p.set(D,!1)}},[m,f.length,f.join("-")]);const x=[];if(d!==y){let j=[...d];for(let D=0;D<m.length;D++){const b=m[D],_=Bb(b);f.includes(_)||(j.splice(D,0,b),x.push(b))}return s==="wait"&&x.length&&(j=x),w(l9(j)),v(d),null}const{forceRender:T}=O.useContext(PF);return l.jsx(l.Fragment,{children:m.map(j=>{const D=Bb(j),b=o&&!h?!1:d===m||f.includes(D),_=()=>{if(p.has(D))p.set(D,!0);else return;let I=!0;p.forEach(S=>{S||(I=!1)}),I&&(T==null||T(),w(g.current),o&&(u==null||u()),i&&i())};return l.jsx(dje,{isPresent:b,initial:!A.current||t?void 0:!1,custom:e,presenceAffectsLayout:r,mode:s,root:c,onExitComplete:b?void 0:_,anchorX:a,children:j},D)})})},OK=O.createContext({strict:!1}),c9={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Pm={};for(const n in c9)Pm[n]={isEnabled:e=>c9[n].some(t=>!!e[t])};function fje(n){for(const e in n)Pm[e]={...Pm[e],...n[e]}}const pje=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function NC(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||pje.has(n)}let UK=n=>!NC(n);function gje(n){typeof n=="function"&&(UK=e=>e.startsWith("on")?!NC(e):n(e))}try{gje(require("@emotion/is-prop-valid").default)}catch{}function mje(n,e,t){const i={};for(const r in n)r==="values"&&typeof n.values=="object"||(UK(r)||t===!0&&NC(r)||!e&&!NC(r)||n.draggable&&r.startsWith("onDrag"))&&(i[r]=n[r]);return i}const hS=O.createContext({});function uS(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}function Sv(n){return typeof n=="string"||Array.isArray(n)}const i8=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],r8=["initial",...i8];function dS(n){return uS(n.animate)||r8.some(e=>Sv(n[e]))}function HK(n){return!!(dS(n)||n.variants)}function yje(n,e){if(dS(n)){const{initial:t,animate:i}=n;return{initial:t===!1||Sv(t)?t:void 0,animate:Sv(i)?i:void 0}}return n.inherit!==!1?e:{}}function vje(n){const{initial:e,animate:t}=yje(n,O.useContext(hS));return O.useMemo(()=>({initial:e,animate:t}),[h9(e),h9(t)])}function h9(n){return Array.isArray(n)?n.join(" "):n}const Tv={};function wje(n){for(const e in n)Tv[e]=n[e],$F(e)&&(Tv[e].isCSSVariable=!0)}function WK(n,{layout:e,layoutId:t}){return a1.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!Tv[n]||n==="opacity")}const xje={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},bje=o1.length;function _je(n,e,t){let i="",r=!0;for(let s=0;s<bje;s++){const o=o1[s],a=n[o];if(a===void 0)continue;let c=!0;if(typeof a=="number"?c=a===(o.startsWith("scale")?1:0):c=parseFloat(a)===0,!c||t){const h=DK(a,e8[o]);if(!c){r=!1;const u=xje[o]||o;i+=`${u}(${h}) `}t&&(e[o]=h)}}return i=i.trim(),t?i=t(e,r?"":i):r&&(i="none"),i}function s8(n,e,t){const{style:i,vars:r,transformOrigin:s}=n;let o=!1,a=!1;for(const c in e){const h=e[c];if(a1.has(c)){o=!0;continue}else if($F(c)){r[c]=h;continue}else{const u=DK(h,e8[c]);c.startsWith("origin")?(a=!0,s[c]=u):i[c]=u}}if(e.transform||(o||t?i.transform=_je(e,n.transform,t):i.transform&&(i.transform="none")),a){const{originX:c="50%",originY:h="50%",originZ:u=0}=s;i.transformOrigin=`${c} ${h} ${u}`}}const o8=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function QK(n,e,t){for(const i in e)!hl(e[i])&&!WK(i,t)&&(n[i]=e[i])}function Cje({transformTemplate:n},e){return O.useMemo(()=>{const t=o8();return s8(t,e,n),Object.assign({},t.vars,t.style)},[e])}function Sje(n,e){const t=n.style||{},i={};return QK(i,t,n),Object.assign(i,Cje(n,e)),i}function Tje(n,e){const t={},i=Sje(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=i,t}const Bje={offset:"stroke-dashoffset",array:"stroke-dasharray"},Eje={offset:"strokeDashoffset",array:"strokeDasharray"};function kje(n,e,t=1,i=0,r=!0){n.pathLength=1;const s=r?Bje:Eje;n[s.offset]=or.transform(-i);const o=or.transform(e),a=or.transform(t);n[s.array]=`${o} ${a}`}function $K(n,{attrX:e,attrY:t,attrScale:i,pathLength:r,pathSpacing:s=1,pathOffset:o=0,...a},c,h,u){if(s8(n,a,h),c){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:d,style:f}=n;d.transform&&(f.transform=d.transform,delete d.transform),(f.transform||d.transformOrigin)&&(f.transformOrigin=d.transformOrigin??"50% 50%",delete d.transformOrigin),f.transform&&(f.transformBox=(u==null?void 0:u.transformBox)??"fill-box",delete d.transformBox),e!==void 0&&(d.x=e),t!==void 0&&(d.y=t),i!==void 0&&(d.scale=i),r!==void 0&&kje(d,r,s,o,!1)}const VK=()=>({...o8(),attrs:{}}),zK=n=>typeof n=="string"&&n.toLowerCase()==="svg";function Ije(n,e,t,i){const r=O.useMemo(()=>{const s=VK();return $K(s,e,zK(i),n.transformTemplate,n.style),{...s.attrs,style:{...s.style}}},[e]);if(n.style){const s={};QK(s,n.style,n),r.style={...s,...r.style}}return r}const Fje=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function a8(n){return typeof n!="string"||n.includes("-")?!1:!!(Fje.indexOf(n)>-1||/[A-Z]/u.test(n))}function Dje(n,e,t,{latestValues:i},r,s=!1){const a=(a8(n)?Ije:Tje)(e,i,r,n),c=mje(e,typeof n=="string",s),h=n!==O.Fragment?{...c,...a,ref:t}:{},{children:u}=e,d=O.useMemo(()=>hl(u)?u.get():u,[u]);return O.createElement(n,{...h,children:d})}function u9(n){const e=[{},{}];return n==null||n.values.forEach((t,i)=>{e[0][i]=t.get(),e[1][i]=t.getVelocity()}),e}function l8(n,e,t,i){if(typeof e=="function"){const[r,s]=u9(i);e=e(t!==void 0?t:n.custom,r,s)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[r,s]=u9(i);e=e(t!==void 0?t:n.custom,r,s)}return e}function h_(n){return hl(n)?n.get():n}function jje({scrapeMotionValuesFromProps:n,createRenderState:e},t,i,r){return{latestValues:Pje(t,i,r,n),renderState:e()}}function Pje(n,e,t,i){const r={},s=i(n,{});for(const f in s)r[f]=h_(s[f]);let{initial:o,animate:a}=n;const c=dS(n),h=HK(n);e&&h&&!c&&n.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let u=t?t.initial===!1:!1;u=u||o===!1;const d=u?a:o;if(d&&typeof d!="boolean"&&!uS(d)){const f=Array.isArray(d)?d:[d];for(let A=0;A<f.length;A++){const g=l8(n,f[A]);if(g){const{transitionEnd:p,transition:y,...v}=g;for(const m in v){let w=v[m];if(Array.isArray(w)){const x=u?w.length-1:0;w=w[x]}w!==null&&(r[m]=w)}for(const m in p)r[m]=p[m]}}}return r}const GK=n=>(e,t)=>{const i=O.useContext(hS),r=O.useContext(lS),s=()=>jje(n,e,i,r);return t?s():hw(s)};function c8(n,e,t){var s;const{style:i}=n,r={};for(const o in i)(hl(i[o])||e.style&&hl(e.style[o])||WK(o,n)||((s=t==null?void 0:t.getValue(o))==null?void 0:s.liveStyle)!==void 0)&&(r[o]=i[o]);return r}const Nje=GK({scrapeMotionValuesFromProps:c8,createRenderState:o8});function XK(n,e,t){const i=c8(n,e,t);for(const r in n)if(hl(n[r])||hl(e[r])){const s=o1.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[s]=n[r]}return i}const Lje=GK({scrapeMotionValuesFromProps:XK,createRenderState:VK}),Mje=Symbol.for("motionComponentSymbol");function G0(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function Rje(n,e,t){return O.useCallback(i=>{i&&n.onMount&&n.onMount(i),e&&(i?e.mount(i):e.unmount()),t&&(typeof t=="function"?t(i):G0(t)&&(t.current=i))},[e])}const h8=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Oje="framerAppearId",KK="data-"+h8(Oje),qK=O.createContext({});function Uje(n,e,t,i,r){var p,y;const{visualElement:s}=O.useContext(hS),o=O.useContext(OK),a=O.useContext(lS),c=O.useContext(fw).reducedMotion,h=O.useRef(null);i=i||o.renderer,!h.current&&i&&(h.current=i(n,{visualState:e,parent:s,props:t,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:c}));const u=h.current,d=O.useContext(qK);u&&!u.projection&&r&&(u.type==="html"||u.type==="svg")&&Hje(h.current,t,r,d);const f=O.useRef(!1);O.useInsertionEffect(()=>{u&&f.current&&u.update(t,a)});const A=t[KK],g=O.useRef(!!A&&!((p=window.MotionHandoffIsComplete)!=null&&p.call(window,A))&&((y=window.MotionHasOptimisedAnimation)==null?void 0:y.call(window,A)));return LF(()=>{u&&(f.current=!0,window.MotionIsMounted=!0,u.updateFeatures(),u.scheduleRenderMicrotask(),g.current&&u.animationState&&u.animationState.animateChanges())}),O.useEffect(()=>{u&&(!g.current&&u.animationState&&u.animationState.animateChanges(),g.current&&(queueMicrotask(()=>{var v;(v=window.MotionHandoffMarkAsComplete)==null||v.call(window,A)}),g.current=!1),u.enteringChildren=void 0)}),u}function Hje(n,e,t,i){const{layoutId:r,layout:s,drag:o,dragConstraints:a,layoutScroll:c,layoutRoot:h,layoutCrossfade:u}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:YK(n.parent)),n.projection.setOptions({layoutId:r,layout:s,alwaysMeasureLayout:!!o||a&&G0(a),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:i,crossfade:u,layoutScroll:c,layoutRoot:h})}function YK(n){if(n)return n.options.allowProjection!==!1?n.projection:YK(n.parent)}function NT(n,{forwardMotionProps:e=!1}={},t,i){t&&fje(t);const r=a8(n)?Lje:Nje;function s(a,c){let h;const u={...O.useContext(fw),...a,layoutId:Wje(a)},{isStatic:d}=u,f=vje(a),A=r(a,d);if(!d&&NF){Qje();const g=$je(u);h=g.MeasureLayout,f.visualElement=Uje(n,A,u,i,g.ProjectionNode)}return l.jsxs(hS.Provider,{value:f,children:[h&&f.visualElement?l.jsx(h,{visualElement:f.visualElement,...u}):null,Dje(n,a,Rje(A,f.visualElement,c),A,d,e)]})}s.displayName=`motion.${typeof n=="string"?n:`create(${n.displayName??n.name??""})`}`;const o=O.forwardRef(s);return o[Mje]=n,o}function Wje({layoutId:n}){const e=O.useContext(PF).id;return e&&n!==void 0?e+"-"+n:n}function Qje(n,e){O.useContext(OK).strict}function $je(n){const{drag:e,layout:t}=Pm;if(!e&&!t)return{};const i={...e,...t};return{MeasureLayout:e!=null&&e.isEnabled(n)||t!=null&&t.isEnabled(n)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}function Vje(n,e){if(typeof Proxy>"u")return NT;const t=new Map,i=(s,o)=>NT(s,o,n,e),r=(s,o)=>i(s,o);return new Proxy(r,{get:(s,o)=>o==="create"?i:(t.has(o)||t.set(o,NT(o,void 0,n,e)),t.get(o))})}function ZK({top:n,left:e,right:t,bottom:i}){return{x:{min:e,max:t},y:{min:n,max:i}}}function zje({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function Gje(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),i=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:i.y,right:i.x}}function LT(n){return n===void 0||n===1}function L6({scale:n,scaleX:e,scaleY:t}){return!LT(n)||!LT(e)||!LT(t)}function jp(n){return L6(n)||JK(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function JK(n){return d9(n.x)||d9(n.y)}function d9(n){return n&&n!=="0%"}function LC(n,e,t){const i=n-t,r=e*i;return t+r}function A9(n,e,t,i,r){return r!==void 0&&(n=LC(n,r,i)),LC(n,t,i)+e}function M6(n,e=0,t=1,i,r){n.min=A9(n.min,e,t,i,r),n.max=A9(n.max,e,t,i,r)}function eq(n,{x:e,y:t}){M6(n.x,e.translate,e.scale,e.originPoint),M6(n.y,t.translate,t.scale,t.originPoint)}const f9=.999999999999,p9=1.0000000000001;function Xje(n,e,t,i=!1){const r=t.length;if(!r)return;e.x=e.y=1;let s,o;for(let a=0;a<r;a++){s=t[a],o=s.projectionDelta;const{visualElement:c}=s.options;c&&c.props.style&&c.props.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&K0(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,eq(n,o)),i&&jp(s.latestValues)&&K0(n,s.latestValues))}e.x<p9&&e.x>f9&&(e.x=1),e.y<p9&&e.y>f9&&(e.y=1)}function X0(n,e){n.min=n.min+e,n.max=n.max+e}function g9(n,e,t,i,r=.5){const s=Po(n.min,n.max,r);M6(n,e,t,s,i)}function K0(n,e){g9(n.x,e.x,e.scaleX,e.scale,e.originX),g9(n.y,e.y,e.scaleY,e.scale,e.originY)}function tq(n,e){return ZK(Gje(n.getBoundingClientRect(),e))}function Kje(n,e,t){const i=tq(n,t),{scroll:r}=e;return r&&(X0(i.x,r.offset.x),X0(i.y,r.offset.y)),i}const m9=()=>({translate:0,scale:1,origin:0,originPoint:0}),q0=()=>({x:m9(),y:m9()}),y9=()=>({min:0,max:0}),ra=()=>({x:y9(),y:y9()}),R6={current:null},nq={current:!1};function qje(){if(nq.current=!0,!!NF)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>R6.current=n.matches;n.addEventListener("change",e),e()}else R6.current=!1}const Yje=new WeakMap;function Zje(n,e,t){for(const i in e){const r=e[i],s=t[i];if(hl(r))n.addValue(i,r);else if(hl(s))n.addValue(i,wg(r,{owner:n}));else if(s!==r)if(n.hasValue(i)){const o=n.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=n.getStaticValue(i);n.addValue(i,wg(o!==void 0?o:r,{owner:n}))}}for(const i in t)e[i]===void 0&&n.removeValue(i);return e}const v9=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Jje{scrapeMotionValuesFromProps(e,t,i){return{}}constructor({parent:e,props:t,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:s,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=ZF,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const f=Uc.now();this.renderScheduledAt<f&&(this.renderScheduledAt=f,lo.render(this.render,!1,!0))};const{latestValues:c,renderState:h}=o;this.latestValues=c,this.baseTarget={...c},this.initialValues=t.initial?{...c}:{},this.renderState=h,this.parent=e,this.props=t,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=a,this.blockInitialAnimation=!!s,this.isControllingVariants=dS(t),this.isVariantNode=HK(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(t,{},this);for(const f in d){const A=d[f];c[f]!==void 0&&hl(A)&&A.set(c[f])}}mount(e){var t;this.current=e,Yje.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((i,r)=>this.bindToMotionValue(r,i)),nq.current||qje(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:R6.current,(t=this.parent)==null||t.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),kA(this.notifyUpdate),kA(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(e=this.parent)==null||e.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const i=this.features[t];i&&(i.unmount(),i.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=a1.has(e);i&&this.onBindTransform&&this.onBindTransform();const r=t.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&lo.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let s;window.MotionCheckAppearSync&&(s=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),s&&s(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Pm){const t=Pm[e];if(!t)continue;const{isEnabled:i,Feature:r}=t;if(!this.features[e]&&r&&i(this.props)&&(this.features[e]=new r(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ra()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let i=0;i<v9.length;i++){const r=v9[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s="on"+r,o=e[s];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=Zje(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const i=this.values.get(e);t!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&t!==void 0&&(i=wg(t===null?void 0:t,{owner:this}),this.addValue(e,i)),i}readValue(e,t){let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(GX(i)||KX(i))?i=parseFloat(i):!cje(i)&&Xf.test(t)&&(i=FK(e,t)),this.setBaseTarget(e,hl(i)?i.get():i)),hl(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var s;const{initial:t}=this.props;let i;if(typeof t=="string"||typeof t=="object"){const o=l8(this.props,t,(s=this.presenceContext)==null?void 0:s.custom);o&&(i=o[e])}if(t&&i!==void 0)return i;const r=this.getBaseTargetFromProps(this.props,e);return r!==void 0&&!hl(r)?r:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new HF),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){t8.render(this.render)}}class iq extends Jje{constructor(){super(...arguments),this.KeyframeResolver=KDe}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:i}){delete t[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;hl(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function rq(n,{style:e,vars:t},i,r){const s=n.style;let o;for(o in e)s[o]=e[o];r==null||r.applyProjectionStyles(s,i);for(o in t)s.setProperty(o,t[o])}function ePe(n){return window.getComputedStyle(n)}class tPe extends iq{constructor(){super(...arguments),this.type="html",this.renderInstance=rq}readValueFromInstance(e,t){var i;if(a1.has(t))return(i=this.projection)!=null&&i.isProjecting?k6(t):fDe(e,t);{const r=ePe(e),s=($F(t)?r.getPropertyValue(t):r[t])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:t}){return tq(e,t)}build(e,t,i){s8(e,t,i.transformTemplate)}scrapeMotionValuesFromProps(e,t,i){return c8(e,t,i)}}const sq=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function nPe(n,e,t,i){rq(n,e,void 0,i);for(const r in e.attrs)n.setAttribute(sq.has(r)?r:h8(r),e.attrs[r])}class iPe extends iq{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ra}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(a1.has(t)){const i=IK(t);return i&&i.default||0}return t=sq.has(t)?t:h8(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,i){return XK(e,t,i)}build(e,t,i){$K(e,t,this.isSVGTag,i.transformTemplate,i.style)}renderInstance(e,t,i,r){nPe(e,t,i,r)}mount(e){this.isSVGTag=zK(e.tagName),super.mount(e)}}const rPe=(n,e)=>a8(n)?new iPe(e):new tPe(e,{allowProjection:n!==O.Fragment});function Am(n,e,t){const i=n.getProps();return l8(i,e,t!==void 0?t:i.custom,n)}const O6=n=>Array.isArray(n);function sPe(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,wg(t))}function oPe(n){return O6(n)?n[n.length-1]||0:n}function aPe(n,e){const t=Am(n,e);let{transitionEnd:i={},transition:r={},...s}=t||{};s={...s,...i};for(const o in s){const a=oPe(s[o]);sPe(n,o,a)}}function lPe(n){return!!(hl(n)&&n.add)}function U6(n,e){const t=n.getValue("willChange");if(lPe(t))return t.add(e);if(!t&&EA.WillChange){const i=new EA.WillChange("auto");n.addValue("willChange",i),i.add(e)}}function oq(n){return n.props[KK]}const cPe=n=>n!==null;function hPe(n,{repeat:e,repeatType:t="loop"},i){const r=n.filter(cPe),s=e&&t!=="loop"&&e%2===1?0:r.length-1;return r[s]}const uPe={type:"spring",stiffness:500,damping:25,restSpeed:10},dPe=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),APe={type:"keyframes",duration:.8},fPe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},pPe=(n,{keyframes:e})=>e.length>2?APe:a1.has(n)?n.startsWith("scale")?dPe(e[1]):uPe:fPe;function gPe({when:n,delay:e,delayChildren:t,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:a,from:c,elapsed:h,...u}){return!!Object.keys(u).length}const u8=(n,e,t,i={},r,s)=>o=>{const a=JF(i,n)||{},c=a.delay||i.delay||0;let{elapsed:h=0}=i;h=h-yd(c);const u={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-h,onUpdate:f=>{e.set(f),a.onUpdate&&a.onUpdate(f)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:n,motionValue:e,element:s?void 0:r};gPe(a)||Object.assign(u,pPe(n,u)),u.duration&&(u.duration=yd(u.duration)),u.repeatDelay&&(u.repeatDelay=yd(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let d=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(P6(u),u.delay===0&&(d=!0)),(EA.instantAnimations||EA.skipAnimations)&&(d=!0,P6(u),u.delay=0),u.allowFlatten=!a.type&&!a.ease,d&&!s&&e.get()!==void 0){const f=hPe(u.keyframes,a);if(f!==void 0){lo.update(()=>{u.onUpdate(f),u.onComplete()});return}}return a.isSync?new cS(u):new MDe(u)};function mPe({protectedKeys:n,needsAnimating:e},t){const i=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,i}function aq(n,e,{delay:t=0,transitionOverride:i,type:r}={}){let{transition:s=n.getDefaultTransition(),transitionEnd:o,...a}=e;i&&(s=i);const c=[],h=r&&n.animationState&&n.animationState.getState()[r];for(const u in a){const d=n.getValue(u,n.latestValues[u]??null),f=a[u];if(f===void 0||h&&mPe(h,u))continue;const A={delay:t,...JF(s||{},u)},g=d.get();if(g!==void 0&&!d.isAnimating&&!Array.isArray(f)&&f===g&&!A.velocity)continue;let p=!1;if(window.MotionHandoffAnimation){const v=oq(n);if(v){const m=window.MotionHandoffAnimation(v,u,lo);m!==null&&(A.startTime=m,p=!0)}}U6(n,u),d.start(u8(u,d,f,n.shouldReduceMotion&&BK.has(u)?{type:!1}:A,n,p));const y=d.animation;y&&c.push(y)}return o&&Promise.all(c).then(()=>{lo.update(()=>{o&&aPe(n,o)})}),c}function lq(n,e,t,i=0,r=1){const s=Array.from(n).sort((h,u)=>h.sortNodePosition(u)).indexOf(e),o=n.size,a=(o-1)*i;return typeof t=="function"?t(s,o):r===1?s*i:a-s*i}function H6(n,e,t={}){var c;const i=Am(n,e,t.type==="exit"?(c=n.presenceContext)==null?void 0:c.custom:void 0);let{transition:r=n.getDefaultTransition()||{}}=i||{};t.transitionOverride&&(r=t.transitionOverride);const s=i?()=>Promise.all(aq(n,i,t)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(h=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:f}=r;return yPe(n,e,h,u,d,f,t)}:()=>Promise.resolve(),{when:a}=r;if(a){const[h,u]=a==="beforeChildren"?[s,o]:[o,s];return h().then(()=>u())}else return Promise.all([s(),o(t.delay)])}function yPe(n,e,t=0,i=0,r=0,s=1,o){const a=[];for(const c of n.variantChildren)c.notify("AnimationStart",e),a.push(H6(c,e,{...o,delay:t+(typeof i=="function"?0:i)+lq(n.variantChildren,c,i,r,s)}).then(()=>c.notify("AnimationComplete",e)));return Promise.all(a)}function vPe(n,e,t={}){n.notify("AnimationStart",e);let i;if(Array.isArray(e)){const r=e.map(s=>H6(n,s,t));i=Promise.all(r)}else if(typeof e=="string")i=H6(n,e,t);else{const r=typeof e=="function"?Am(n,e,t.custom):e;i=Promise.all(aq(n,r,t))}return i.then(()=>{n.notify("AnimationComplete",e)})}function cq(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let i=0;i<t;i++)if(e[i]!==n[i])return!1;return!0}const wPe=r8.length;function hq(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?hq(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<wPe;t++){const i=r8[t],r=n.props[i];(Sv(r)||r===!1)&&(e[i]=r)}return e}const xPe=[...i8].reverse(),bPe=i8.length;function _Pe(n){return e=>Promise.all(e.map(({animation:t,options:i})=>vPe(n,t,i)))}function CPe(n){let e=_Pe(n),t=w9(),i=!0;const r=c=>(h,u)=>{var f;const d=Am(n,u,c==="exit"?(f=n.presenceContext)==null?void 0:f.custom:void 0);if(d){const{transition:A,transitionEnd:g,...p}=d;h={...h,...p,...g}}return h};function s(c){e=c(n)}function o(c){const{props:h}=n,u=hq(n.parent)||{},d=[],f=new Set;let A={},g=1/0;for(let y=0;y<bPe;y++){const v=xPe[y],m=t[v],w=h[v]!==void 0?h[v]:u[v],x=Sv(w),T=v===c?m.isActive:null;T===!1&&(g=y);let j=w===u[v]&&w!==h[v]&&x;if(j&&i&&n.manuallyAnimateOnMount&&(j=!1),m.protectedKeys={...A},!m.isActive&&T===null||!w&&!m.prevProp||uS(w)||typeof w=="boolean")continue;const D=SPe(m.prevProp,w);let b=D||v===c&&m.isActive&&!j&&x||y>g&&x,_=!1;const I=Array.isArray(w)?w:[w];let S=I.reduce(r(v),{});T===!1&&(S={});const{prevResolvedValues:F={}}=m,B={...F,...S},E=P=>{b=!0,f.has(P)&&(_=!0,f.delete(P)),m.needsAnimating[P]=!0;const M=n.getValue(P);M&&(M.liveStyle=!1)};for(const P in B){const M=S[P],X=F[P];if(A.hasOwnProperty(P))continue;let Z=!1;O6(M)&&O6(X)?Z=!cq(M,X):Z=M!==X,Z?M!=null?E(P):f.add(P):M!==void 0&&f.has(P)?E(P):m.protectedKeys[P]=!0}m.prevProp=w,m.prevResolvedValues=S,m.isActive&&(A={...A,...S}),i&&n.blockInitialAnimation&&(b=!1);const V=j&&D;b&&(!V||_)&&d.push(...I.map(P=>{const M={type:v};if(typeof P=="string"&&i&&!V&&n.manuallyAnimateOnMount&&n.parent){const{parent:X}=n,Z=Am(X,P);if(X.enteringChildren&&Z){const{delayChildren:Q}=Z.transition||{};M.delay=lq(X.enteringChildren,n,Q)}}return{animation:P,options:M}}))}if(f.size){const y={};if(typeof h.initial!="boolean"){const v=Am(n,Array.isArray(h.initial)?h.initial[0]:h.initial);v&&v.transition&&(y.transition=v.transition)}f.forEach(v=>{const m=n.getBaseTarget(v),w=n.getValue(v);w&&(w.liveStyle=!0),y[v]=m??null}),d.push({animation:y})}let p=!!d.length;return i&&(h.initial===!1||h.initial===h.animate)&&!n.manuallyAnimateOnMount&&(p=!1),i=!1,p?e(d):Promise.resolve()}function a(c,h){var d;if(t[c].isActive===h)return Promise.resolve();(d=n.variantChildren)==null||d.forEach(f=>{var A;return(A=f.animationState)==null?void 0:A.setActive(c,h)}),t[c].isActive=h;const u=o(c);for(const f in t)t[f].protectedKeys={};return u}return{animateChanges:o,setActive:a,setAnimateFunction:s,getState:()=>t,reset:()=>{t=w9(),i=!0}}}function SPe(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!cq(e,n):!1}function Ep(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function w9(){return{animate:Ep(!0),whileInView:Ep(),whileHover:Ep(),whileTap:Ep(),whileDrag:Ep(),whileFocus:Ep(),exit:Ep()}}class sp{constructor(e){this.isMounted=!1,this.node=e}update(){}}class TPe extends sp{constructor(e){super(e),e.animationState||(e.animationState=CPe(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();uS(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let BPe=0;class EPe extends sp{constructor(){super(...arguments),this.id=BPe++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const kPe={animation:{Feature:TPe},exit:{Feature:EPe}};function Bv(n,e,t,i={passive:!0}){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t)}function pw(n){return{point:{x:n.pageX,y:n.pageY}}}const IPe=n=>e=>n8(e)&&n(e,pw(e));function Vy(n,e,t,i){return Bv(n,e,IPe(t),i)}const uq=1e-4,FPe=1-uq,DPe=1+uq,dq=.01,jPe=0-dq,PPe=0+dq;function gc(n){return n.max-n.min}function NPe(n,e,t){return Math.abs(n-e)<=t}function x9(n,e,t,i=.5){n.origin=i,n.originPoint=Po(e.min,e.max,n.origin),n.scale=gc(t)/gc(e),n.translate=Po(t.min,t.max,n.origin)-n.originPoint,(n.scale>=FPe&&n.scale<=DPe||isNaN(n.scale))&&(n.scale=1),(n.translate>=jPe&&n.translate<=PPe||isNaN(n.translate))&&(n.translate=0)}function zy(n,e,t,i){x9(n.x,e.x,t.x,i?i.originX:void 0),x9(n.y,e.y,t.y,i?i.originY:void 0)}function b9(n,e,t){n.min=t.min+e.min,n.max=n.min+gc(e)}function LPe(n,e,t){b9(n.x,e.x,t.x),b9(n.y,e.y,t.y)}function _9(n,e,t){n.min=e.min-t.min,n.max=n.min+gc(e)}function Gy(n,e,t){_9(n.x,e.x,t.x),_9(n.y,e.y,t.y)}function jh(n){return[n("x"),n("y")]}const Aq=({current:n})=>n?n.ownerDocument.defaultView:null,C9=(n,e)=>Math.abs(n-e);function MPe(n,e){const t=C9(n.x,e.x),i=C9(n.y,e.y);return Math.sqrt(t**2+i**2)}class fq{constructor(e,t,{transformPagePoint:i,contextWindow:r=window,dragSnapToOrigin:s=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=RT(this.lastMoveEventInfo,this.history),A=this.startEvent!==null,g=MPe(f.offset,{x:0,y:0})>=this.distanceThreshold;if(!A&&!g)return;const{point:p}=f,{timestamp:y}=Cl;this.history.push({...p,timestamp:y});const{onStart:v,onMove:m}=this.handlers;A||(v&&v(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),m&&m(this.lastMoveEvent,f)},this.handlePointerMove=(f,A)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=MT(A,this.transformPagePoint),lo.update(this.updatePoint,!0)},this.handlePointerUp=(f,A)=>{this.end();const{onEnd:g,onSessionEnd:p,resumeAnimation:y}=this.handlers;if(this.dragSnapToOrigin&&y&&y(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=RT(f.type==="pointercancel"?this.lastMoveEventInfo:MT(A,this.transformPagePoint),this.history);this.startEvent&&g&&g(f,v),p&&p(f,v)},!n8(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=i,this.distanceThreshold=o,this.contextWindow=r||window;const a=pw(e),c=MT(a,this.transformPagePoint),{point:h}=c,{timestamp:u}=Cl;this.history=[{...h,timestamp:u}];const{onSessionStart:d}=t;d&&d(e,RT(c,this.history)),this.removeListeners=uw(Vy(this.contextWindow,"pointermove",this.handlePointerMove),Vy(this.contextWindow,"pointerup",this.handlePointerUp),Vy(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),kA(this.updatePoint)}}function MT(n,e){return e?{point:e(n.point)}:n}function S9(n,e){return{x:n.x-e.x,y:n.y-e.y}}function RT({point:n},e){return{point:n,delta:S9(n,pq(e)),offset:S9(n,RPe(e)),velocity:OPe(e,.1)}}function RPe(n){return n[0]}function pq(n){return n[n.length-1]}function OPe(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,i=null;const r=pq(n);for(;t>=0&&(i=n[t],!(r.timestamp-i.timestamp>yd(e)));)t--;if(!i)return{x:0,y:0};const s=vd(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function UPe(n,{min:e,max:t},i){return e!==void 0&&n<e?n=i?Po(e,n,i.min):Math.max(n,e):t!==void 0&&n>t&&(n=i?Po(t,n,i.max):Math.min(n,t)),n}function T9(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function HPe(n,{top:e,left:t,bottom:i,right:r}){return{x:T9(n.x,t,r),y:T9(n.y,e,i)}}function B9(n,e){let t=e.min-n.min,i=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,i]=[i,t]),{min:t,max:i}}function WPe(n,e){return{x:B9(n.x,e.x),y:B9(n.y,e.y)}}function QPe(n,e){let t=.5;const i=gc(n),r=gc(e);return r>i?t=xv(e.min,e.max-i,n.min):i>r&&(t=xv(n.min,n.max-r,e.min)),BA(0,1,t)}function $Pe(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const W6=.35;function VPe(n=W6){return n===!1?n=0:n===!0&&(n=W6),{x:E9(n,"left","right"),y:E9(n,"top","bottom")}}function E9(n,e,t){return{min:k9(n,e),max:k9(n,t)}}function k9(n,e){return typeof n=="number"?n:n[e]||0}const zPe=new WeakMap;class GPe{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ra(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:i}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=d=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(pw(d).point)},o=(d,f)=>{const{drag:A,dragPropagation:g,onDragStart:p}=this.getProps();if(A&&!g&&(this.openDragLock&&this.openDragLock(),this.openDragLock=JDe(A),!this.openDragLock))return;this.latestPointerEvent=d,this.latestPanInfo=f,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),jh(v=>{let m=this.getAxisMotionValue(v).get()||0;if(wd.test(m)){const{projection:w}=this.visualElement;if(w&&w.layout){const x=w.layout.layoutBox[v];x&&(m=gc(x)*(parseFloat(m)/100))}}this.originPoint[v]=m}),p&&lo.postRender(()=>p(d,f)),U6(this.visualElement,"transform");const{animationState:y}=this.visualElement;y&&y.setActive("whileDrag",!0)},a=(d,f)=>{this.latestPointerEvent=d,this.latestPanInfo=f;const{dragPropagation:A,dragDirectionLock:g,onDirectionLock:p,onDrag:y}=this.getProps();if(!A&&!this.openDragLock)return;const{offset:v}=f;if(g&&this.currentDirection===null){this.currentDirection=XPe(v),this.currentDirection!==null&&p&&p(this.currentDirection);return}this.updateAxis("x",f.point,v),this.updateAxis("y",f.point,v),this.visualElement.render(),y&&y(d,f)},c=(d,f)=>{this.latestPointerEvent=d,this.latestPanInfo=f,this.stop(d,f),this.latestPointerEvent=null,this.latestPanInfo=null},h=()=>jh(d=>{var f;return this.getAnimationState(d)==="paused"&&((f=this.getAxisMotionValue(d).animation)==null?void 0:f.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new fq(e,{onSessionStart:s,onStart:o,onMove:a,onSessionEnd:c,resumeAnimation:h},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,distanceThreshold:i,contextWindow:Aq(this.visualElement)})}stop(e,t){const i=e||this.latestPointerEvent,r=t||this.latestPanInfo,s=this.isDragging;if(this.cancel(),!s||!r||!i)return;const{velocity:o}=r;this.startAnimation(o);const{onDragEnd:a}=this.getProps();a&&lo.postRender(()=>a(i,r))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,i){const{drag:r}=this.getProps();if(!i||!Eb(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(o=UPe(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var s;const{dragConstraints:e,dragElastic:t}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(s=this.visualElement.projection)==null?void 0:s.layout,r=this.constraints;e&&G0(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&i?this.constraints=HPe(i.layoutBox,e):this.constraints=!1,this.elastic=VPe(t),r!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&jh(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=$Pe(i.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!G0(e))return!1;const i=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=Kje(i,r.root,this.visualElement.getTransformPagePoint());let o=WPe(r.layout.layoutBox,s);if(t){const a=t(zje(o));this.hasMutatedConstraints=!!a,a&&(o=ZK(a))}return o}startAnimation(e){const{drag:t,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),c=this.constraints||{},h=jh(u=>{if(!Eb(u,t,this.currentDirection))return;let d=c&&c[u]||{};o&&(d={min:0,max:0});const f=r?200:1e6,A=r?40:1e7,g={type:"inertia",velocity:i?e[u]:0,bounceStiffness:f,bounceDamping:A,timeConstant:750,restDelta:1,restSpeed:10,...s,...d};return this.startAxisValueAnimation(u,g)});return Promise.all(h).then(a)}startAxisValueAnimation(e,t){const i=this.getAxisMotionValue(e);return U6(this.visualElement,e),i.start(u8(e,i,0,t,this.visualElement,!1))}stopAnimation(){jh(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){jh(e=>{var t;return(t=this.getAxisMotionValue(e).animation)==null?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)==null?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),r=i[t];return r||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){jh(t=>{const{drag:i}=this.getProps();if(!Eb(t,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(t);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[t];s.set(e[t]-Po(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:i}=this.visualElement;if(!G0(t)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};jh(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const c=a.get();r[o]=QPe({min:c,max:c},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),jh(o=>{if(!Eb(o,e,null))return;const a=this.getAxisMotionValue(o),{min:c,max:h}=this.constraints[o];a.set(Po(c,h,r[o]))})}addListeners(){if(!this.visualElement.current)return;zPe.set(this.visualElement,this);const e=this.visualElement.current,t=Vy(e,"pointerdown",c=>{const{drag:h,dragListener:u=!0}=this.getProps();h&&u&&this.start(c)}),i=()=>{const{dragConstraints:c}=this.getProps();G0(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),lo.read(i);const o=Bv(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",(({delta:c,hasLayoutChanged:h})=>{this.isDragging&&h&&(jh(u=>{const d=this.getAxisMotionValue(u);d&&(this.originPoint[u]+=c[u].translate,d.set(d.get()+c[u].translate))}),this.visualElement.render())}));return()=>{o(),t(),s(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=W6,dragMomentum:a=!0}=e;return{...e,drag:t,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:a}}}function Eb(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function XPe(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class KPe extends sp{constructor(e){super(e),this.removeGroupControls=zh,this.removeListeners=zh,this.controls=new GPe(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||zh}unmount(){this.removeGroupControls(),this.removeListeners()}}const I9=n=>(e,t)=>{n&&lo.postRender(()=>n(e,t))};class qPe extends sp{constructor(){super(...arguments),this.removePointerDownListener=zh}onPointerDown(e){this.session=new fq(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Aq(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:I9(e),onStart:I9(t),onMove:i,onEnd:(s,o)=>{delete this.session,r&&lo.postRender(()=>r(s,o))}}}mount(){this.removePointerDownListener=Vy(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const u_={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function F9(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const K1={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(or.test(n))n=parseFloat(n);else return n;const t=F9(n,e.target.x),i=F9(n,e.target.y);return`${t}% ${i}%`}},YPe={correct:(n,{treeScale:e,projectionDelta:t})=>{const i=n,r=Xf.parse(n);if(r.length>5)return i;const s=Xf.createTransformer(n),o=typeof r[0]!="number"?1:0,a=t.x.scale*e.x,c=t.y.scale*e.y;r[0+o]/=a,r[1+o]/=c;const h=Po(a,c,.5);return typeof r[2+o]=="number"&&(r[2+o]/=h),typeof r[3+o]=="number"&&(r[3+o]/=h),s(r)}};let OT=!1;class ZPe extends O.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=e;wje(JPe),s&&(t.group&&t.group.add(s),i&&i.register&&r&&i.register(s),OT&&s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),u_.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:i,drag:r,isPresent:s}=this.props,{projection:o}=i;return o&&(o.isPresent=s,OT=!0,r||e.layoutDependency!==t||t===void 0||e.isPresent!==s?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||lo.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),t8.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:i}=this.props,{projection:r}=e;OT=!0,r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function gq(n){const[e,t]=RK(),i=O.useContext(PF);return l.jsx(ZPe,{...n,layoutGroup:i,switchLayoutGroup:O.useContext(qK),isPresent:e,safeToRemove:t})}const JPe={borderRadius:{...K1,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:K1,borderTopRightRadius:K1,borderBottomLeftRadius:K1,borderBottomRightRadius:K1,boxShadow:YPe};function eNe(n,e,t){const i=hl(n)?n:wg(n);return i.start(u8("",i,e,t)),i.animation}const tNe=(n,e)=>n.depth-e.depth;class nNe{constructor(){this.children=[],this.isDirty=!1}add(e){MF(this.children,e),this.isDirty=!0}remove(e){RF(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(tNe),this.isDirty=!1,this.children.forEach(e)}}function iNe(n,e){const t=Uc.now(),i=({timestamp:r})=>{const s=r-t;s>=e&&(kA(i),n(s-e))};return lo.setup(i,!0),()=>kA(i)}const mq=["TopLeft","TopRight","BottomLeft","BottomRight"],rNe=mq.length,D9=n=>typeof n=="string"?parseFloat(n):n,j9=n=>typeof n=="number"||or.test(n);function sNe(n,e,t,i,r,s){r?(n.opacity=Po(0,t.opacity??1,oNe(i)),n.opacityExit=Po(e.opacity??1,0,aNe(i))):s&&(n.opacity=Po(e.opacity??1,t.opacity??1,i));for(let o=0;o<rNe;o++){const a=`border${mq[o]}Radius`;let c=P9(e,a),h=P9(t,a);if(c===void 0&&h===void 0)continue;c||(c=0),h||(h=0),c===0||h===0||j9(c)===j9(h)?(n[a]=Math.max(Po(D9(c),D9(h),i),0),(wd.test(h)||wd.test(c))&&(n[a]+="%")):n[a]=h}(e.rotate||t.rotate)&&(n.rotate=Po(e.rotate||0,t.rotate||0,i))}function P9(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const oNe=yq(0,.5,iK),aNe=yq(.5,.95,zh);function yq(n,e,t){return i=>i<n?0:i>e?1:t(xv(n,e,i))}function N9(n,e){n.min=e.min,n.max=e.max}function kh(n,e){N9(n.x,e.x),N9(n.y,e.y)}function L9(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function M9(n,e,t,i,r){return n-=e,n=LC(n,1/t,i),r!==void 0&&(n=LC(n,1/r,i)),n}function lNe(n,e=0,t=1,i=.5,r,s=n,o=n){if(wd.test(e)&&(e=parseFloat(e),e=Po(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=Po(s.min,s.max,i);n===s&&(a-=e),n.min=M9(n.min,e,t,a,r),n.max=M9(n.max,e,t,a,r)}function R9(n,e,[t,i,r],s,o){lNe(n,e[t],e[i],e[r],e.scale,s,o)}const cNe=["x","scaleX","originX"],hNe=["y","scaleY","originY"];function O9(n,e,t,i){R9(n.x,e,cNe,t?t.x:void 0,i?i.x:void 0),R9(n.y,e,hNe,t?t.y:void 0,i?i.y:void 0)}function U9(n){return n.translate===0&&n.scale===1}function vq(n){return U9(n.x)&&U9(n.y)}function H9(n,e){return n.min===e.min&&n.max===e.max}function uNe(n,e){return H9(n.x,e.x)&&H9(n.y,e.y)}function W9(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function wq(n,e){return W9(n.x,e.x)&&W9(n.y,e.y)}function Q9(n){return gc(n.x)/gc(n.y)}function $9(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class dNe{constructor(){this.members=[]}add(e){MF(this.members,e),e.scheduleRender()}remove(e){if(RF(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(r=>e===r);if(t===0)return!1;let i;for(let r=t;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(e,t){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,t&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:i}=e;t.onExitComplete&&t.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function ANe(n,e,t){let i="";const r=n.x.translate/e.x,s=n.y.translate/e.y,o=(t==null?void 0:t.z)||0;if((r||s||o)&&(i=`translate3d(${r}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:h,rotate:u,rotateX:d,rotateY:f,skewX:A,skewY:g}=t;h&&(i=`perspective(${h}px) ${i}`),u&&(i+=`rotate(${u}deg) `),d&&(i+=`rotateX(${d}deg) `),f&&(i+=`rotateY(${f}deg) `),A&&(i+=`skewX(${A}deg) `),g&&(i+=`skewY(${g}deg) `)}const a=n.x.scale*e.x,c=n.y.scale*e.y;return(a!==1||c!==1)&&(i+=`scale(${a}, ${c})`),i||"none"}const UT=["","X","Y","Z"],fNe=1e3;let pNe=0;function HT(n,e,t,i){const{latestValues:r}=e;r[n]&&(t[n]=r[n],e.setStaticValue(n,0),i&&(i[n]=0))}function xq(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=oq(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:r,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",lo,!(r||s))}const{parent:i}=n;i&&!i.hasCheckedOptimisedAppear&&xq(i)}function bq({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},a=e==null?void 0:e()){this.id=pNe++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(yNe),this.nodes.forEach(bNe),this.nodes.forEach(_Ne),this.nodes.forEach(vNe)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new nNe)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new HF),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const c=this.eventHandlers.get(o);c&&c.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=MK(o)&&!sje(o),this.instance=o;const{layoutId:a,layout:c,visualElement:h}=this.options;if(h&&!h.current&&h.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||a)&&(this.isLayoutDirty=!0),n){let u,d=0;const f=()=>this.root.updateBlockedByResize=!1;lo.read(()=>{d=window.innerWidth}),n(o,()=>{const A=window.innerWidth;A!==d&&(d=A,this.root.updateBlockedByResize=!0,u&&u(),u=iNe(f,250),u_.hasAnimatedSinceResize&&(u_.hasAnimatedSinceResize=!1,this.nodes.forEach(G9)))})}a&&this.root.registerSharedNode(a,this),this.options.animate!==!1&&h&&(a||c)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d,hasRelativeLayoutChanged:f,layout:A})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const g=this.options.transition||h.getDefaultTransition()||ENe,{onLayoutAnimationStart:p,onLayoutAnimationComplete:y}=h.getProps(),v=!this.targetLayout||!wq(this.targetLayout,A),m=!d&&f;if(this.options.layoutRoot||this.resumeFrom||m||d&&(v||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const w={...JF(g,"layout"),onPlay:p,onComplete:y};(h.shouldReduceMotion||this.options.layoutRoot)&&(w.delay=0,w.type=!1),this.startAnimation(w),this.setAnimationOrigin(u,m)}else d||G9(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=A})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),kA(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(CNe),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&xq(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const d=this.path[u];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:a,layout:c}=this.options;if(a===void 0&&!c)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(V9);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(z9);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(xNe),this.nodes.forEach(gNe),this.nodes.forEach(mNe)):this.nodes.forEach(z9),this.clearAllSnapshots();const a=Uc.now();Cl.delta=BA(0,1e3/60,a-Cl.timestamp),Cl.timestamp=a,Cl.isProcessing=!0,kT.update.process(Cl),kT.preRender.process(Cl),kT.render.process(Cl),Cl.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,t8.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(wNe),this.sharedNodes.forEach(SNe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,lo.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){lo.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!gc(this.snapshot.measuredBox.x)&&!gc(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ra(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a&&this.instance){const c=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:c,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!vq(this.projectionDelta),c=this.getTransformTemplate(),h=c?c(this.latestValues,""):void 0,u=h!==this.prevTransformTemplateValue;o&&this.instance&&(a||jp(this.latestValues)||u)&&(r(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let c=this.removeElementScroll(a);return o&&(c=this.removeTransform(c)),kNe(c),{animationId:this.root.animationId,measuredBox:a,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var h;const{visualElement:o}=this.options;if(!o)return ra();const a=o.measureViewportBox();if(!(((h=this.scroll)==null?void 0:h.wasRoot)||this.path.some(INe))){const{scroll:u}=this.root;u&&(X0(a.x,u.offset.x),X0(a.y,u.offset.y))}return a}removeElementScroll(o){var c;const a=ra();if(kh(a,o),(c=this.scroll)!=null&&c.wasRoot)return a;for(let h=0;h<this.path.length;h++){const u=this.path[h],{scroll:d,options:f}=u;u!==this.root&&d&&f.layoutScroll&&(d.wasRoot&&kh(a,o),X0(a.x,d.offset.x),X0(a.y,d.offset.y))}return a}applyTransform(o,a=!1){const c=ra();kh(c,o);for(let h=0;h<this.path.length;h++){const u=this.path[h];!a&&u.options.layoutScroll&&u.scroll&&u!==u.root&&K0(c,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),jp(u.latestValues)&&K0(c,u.latestValues)}return jp(this.latestValues)&&K0(c,this.latestValues),c}removeTransform(o){const a=ra();kh(a,o);for(let c=0;c<this.path.length;c++){const h=this.path[c];if(!h.instance||!jp(h.latestValues))continue;L6(h.latestValues)&&h.updateSnapshot();const u=ra(),d=h.measurePageBox();kh(u,d),O9(a,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,u)}return jp(this.latestValues)&&O9(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Cl.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var f;const a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==a;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||(f=this.parent)!=null&&f.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:d}=this.options;if(!(!this.layout||!(u||d))){if(this.resolvedRelativeTargetAt=Cl.timestamp,!this.targetDelta&&!this.relativeTarget){const A=this.getClosestProjectingParent();A&&A.layout&&this.animationProgress!==1?(this.relativeParent=A,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ra(),this.relativeTargetOrigin=ra(),Gy(this.relativeTargetOrigin,this.layout.layoutBox,A.layout.layoutBox),kh(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=ra(),this.targetWithTransforms=ra()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),LPe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):kh(this.target,this.layout.layoutBox),eq(this.target,this.targetDelta)):kh(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const A=this.getClosestProjectingParent();A&&!!A.resumingFrom==!!this.resumingFrom&&!A.options.layoutScroll&&A.target&&this.animationProgress!==1?(this.relativeParent=A,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ra(),this.relativeTargetOrigin=ra(),Gy(this.relativeTargetOrigin,this.target,A.target),kh(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||L6(this.parent.latestValues)||JK(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var g;const o=this.getLead(),a=!!this.resumingFrom||this!==o;let c=!0;if((this.isProjectionDirty||(g=this.parent)!=null&&g.isProjectionDirty)&&(c=!1),a&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===Cl.timestamp&&(c=!1),c)return;const{layout:h,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||u))return;kh(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,f=this.treeScale.y;Xje(this.layoutCorrected,this.treeScale,this.path,a),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=ra());const{target:A}=o;if(!A){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(L9(this.prevProjectionDelta.x,this.projectionDelta.x),L9(this.prevProjectionDelta.y,this.projectionDelta.y)),zy(this.projectionDelta,this.layoutCorrected,A,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==f||!$9(this.projectionDelta.x,this.prevProjectionDelta.x)||!$9(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",A))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)==null||a.scheduleRender(),o){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=q0(),this.projectionDelta=q0(),this.projectionDeltaWithTransform=q0()}setAnimationOrigin(o,a=!1){const c=this.snapshot,h=c?c.latestValues:{},u={...this.latestValues},d=q0();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const f=ra(),A=c?c.source:void 0,g=this.layout?this.layout.source:void 0,p=A!==g,y=this.getStack(),v=!y||y.members.length<=1,m=!!(p&&!v&&this.options.crossfade===!0&&!this.path.some(BNe));this.animationProgress=0;let w;this.mixTargetDelta=x=>{const T=x/1e3;X9(d.x,o.x,T),X9(d.y,o.y,T),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Gy(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),TNe(this.relativeTarget,this.relativeTargetOrigin,f,T),w&&uNe(this.relativeTarget,w)&&(this.isProjectionDirty=!1),w||(w=ra()),kh(w,this.relativeTarget)),p&&(this.animationValues=u,sNe(u,h,this.latestValues,T,m,v)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=T},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){var a,c,h;this.notifyListeners("animationStart"),(a=this.currentAnimation)==null||a.stop(),(h=(c=this.resumingFrom)==null?void 0:c.currentAnimation)==null||h.stop(),this.pendingAnimation&&(kA(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=lo.update(()=>{u_.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=wg(0)),this.currentAnimation=eNe(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:u=>{this.mixTargetDelta(u),o.onUpdate&&o.onUpdate(u)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(fNe),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:c,layout:h,latestValues:u}=o;if(!(!a||!c||!h)){if(this!==o&&this.layout&&h&&_q(this.options.animationType,this.layout.layoutBox,h.layoutBox)){c=this.target||ra();const d=gc(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+d;const f=gc(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+f}kh(a,c),K0(a,u),zy(this.projectionDeltaWithTransform,this.layoutCorrected,a,u)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new dNe),this.sharedNodes.get(o).add(a);const h=a.options.initialPromotionConfig;a.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())==null?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())==null?void 0:a.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:c}={}){const h=this.getStack();h&&h.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:c}=o;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(a=!0),!a)return;const h={};c.z&&HT("z",o,h,this.animationValues);for(let u=0;u<UT.length;u++)HT(`rotate${UT[u]}`,o,h,this.animationValues),HT(`skew${UT[u]}`,o,h,this.animationValues);o.render();for(const u in h)o.setStaticValue(u,h[u]),this.animationValues&&(this.animationValues[u]=h[u]);o.scheduleRender()}applyProjectionStyles(o,a){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=h_(a==null?void 0:a.pointerEvents)||"",o.transform=c?c(this.latestValues,""):"none";return}const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=h_(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!jp(this.latestValues)&&(o.transform=c?c({},""):"none",this.hasProjected=!1);return}o.visibility="";const u=h.animationValues||h.latestValues;this.applyTransformsToTarget();let d=ANe(this.projectionDeltaWithTransform,this.treeScale,u);c&&(d=c(u,d)),o.transform=d;const{x:f,y:A}=this.projectionDelta;o.transformOrigin=`${f.origin*100}% ${A.origin*100}% 0`,h.animationValues?o.opacity=h===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:o.opacity=h===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const g in Tv){if(u[g]===void 0)continue;const{correct:p,applyTo:y,isCSSVariable:v}=Tv[g],m=d==="none"?u[g]:p(u[g],h);if(y){const w=y.length;for(let x=0;x<w;x++)o[y[x]]=m}else v?this.options.visualElement.renderState.vars[g]=m:o[g]=m}this.options.layoutId&&(o.pointerEvents=h===this?h_(a==null?void 0:a.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)==null?void 0:a.stop()}),this.root.nodes.forEach(V9),this.root.sharedNodes.clear()}}}function gNe(n){n.updateLayout()}function mNe(n){var t;const e=((t=n.resumeFrom)==null?void 0:t.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&e&&n.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=n.layout,{animationType:s}=n.options,o=e.source!==n.layout.source;s==="size"?jh(d=>{const f=o?e.measuredBox[d]:e.layoutBox[d],A=gc(f);f.min=i[d].min,f.max=f.min+A}):_q(s,e.layoutBox,i)&&jh(d=>{const f=o?e.measuredBox[d]:e.layoutBox[d],A=gc(i[d]);f.max=f.min+A,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[d].max=n.relativeTarget[d].min+A)});const a=q0();zy(a,i,e.layoutBox);const c=q0();o?zy(c,n.applyTransform(r,!0),e.measuredBox):zy(c,i,e.layoutBox);const h=!vq(a);let u=!1;if(!n.resumeFrom){const d=n.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:f,layout:A}=d;if(f&&A){const g=ra();Gy(g,e.layoutBox,f.layoutBox);const p=ra();Gy(p,i,A.layoutBox),wq(g,p)||(u=!0),d.options.layoutRoot&&(n.relativeTarget=p,n.relativeTargetOrigin=g,n.relativeParent=d)}}}n.notifyListeners("didUpdate",{layout:i,snapshot:e,delta:c,layoutDelta:a,hasLayoutChanged:h,hasRelativeLayoutChanged:u})}else if(n.isLead()){const{onExitComplete:i}=n.options;i&&i()}n.options.transition=void 0}function yNe(n){n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function vNe(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function wNe(n){n.clearSnapshot()}function V9(n){n.clearMeasurements()}function z9(n){n.isLayoutDirty=!1}function xNe(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function G9(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function bNe(n){n.resolveTargetDelta()}function _Ne(n){n.calcProjection()}function CNe(n){n.resetSkewAndRotation()}function SNe(n){n.removeLeadSnapshot()}function X9(n,e,t){n.translate=Po(e.translate,0,t),n.scale=Po(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function K9(n,e,t,i){n.min=Po(e.min,t.min,i),n.max=Po(e.max,t.max,i)}function TNe(n,e,t,i){K9(n.x,e.x,t.x,i),K9(n.y,e.y,t.y,i)}function BNe(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const ENe={duration:.45,ease:[.4,0,.1,1]},q9=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),Y9=q9("applewebkit/")&&!q9("chrome/")?Math.round:zh;function Z9(n){n.min=Y9(n.min),n.max=Y9(n.max)}function kNe(n){Z9(n.x),Z9(n.y)}function _q(n,e,t){return n==="position"||n==="preserve-aspect"&&!NPe(Q9(e),Q9(t),.2)}function INe(n){var e;return n!==n.root&&((e=n.scroll)==null?void 0:e.wasRoot)}const FNe=bq({attachResizeListener:(n,e)=>Bv(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),WT={current:void 0},Cq=bq({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!WT.current){const n=new FNe({});n.mount(window),n.setOptions({layoutScroll:!0}),WT.current=n}return WT.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),DNe={pan:{Feature:qPe},drag:{Feature:KPe,ProjectionNode:Cq,MeasureLayout:gq}};function J9(n,e,t){const{props:i}=n;n.animationState&&i.whileHover&&n.animationState.setActive("whileHover",t==="Start");const r="onHover"+t,s=i[r];s&&lo.postRender(()=>s(e,pw(e)))}class jNe extends sp{mount(){const{current:e}=this.node;e&&(this.unmount=eje(e,(t,i)=>(J9(this.node,i,"Start"),r=>J9(this.node,r,"End"))))}unmount(){}}class PNe extends sp{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=uw(Bv(this.node.current,"focus",()=>this.onFocus()),Bv(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function eR(n,e,t){const{props:i}=n;if(n.current instanceof HTMLButtonElement&&n.current.disabled)return;n.animationState&&i.whileTap&&n.animationState.setActive("whileTap",t==="Start");const r="onTap"+(t==="End"?"":t),s=i[r];s&&lo.postRender(()=>s(e,pw(e)))}class NNe extends sp{mount(){const{current:e}=this.node;e&&(this.unmount=rje(e,(t,i)=>(eR(this.node,i,"Start"),(r,{success:s})=>eR(this.node,r,s?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Q6=new WeakMap,QT=new WeakMap,LNe=n=>{const e=Q6.get(n.target);e&&e(n)},MNe=n=>{n.forEach(LNe)};function RNe({root:n,...e}){const t=n||document;QT.has(t)||QT.set(t,{});const i=QT.get(t),r=JSON.stringify(e);return i[r]||(i[r]=new IntersectionObserver(MNe,{root:n,...e})),i[r]}function ONe(n,e,t){const i=RNe(e);return Q6.set(n,t),i.observe(n),()=>{Q6.delete(n),i.unobserve(n)}}const UNe={some:0,all:1};class HNe extends sp{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:i,amount:r="some",once:s}=e,o={root:t?t.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:UNe[r]},a=c=>{const{isIntersecting:h}=c;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:u,onViewportLeave:d}=this.node.getProps(),f=h?u:d;f&&f(c)};return ONe(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(WNe(e,t))&&this.startObserver()}unmount(){}}function WNe({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const QNe={inView:{Feature:HNe},tap:{Feature:NNe},focus:{Feature:PNe},hover:{Feature:jNe}},$Ne={layout:{ProjectionNode:Cq,MeasureLayout:gq}},VNe={...kPe,...QNe,...DNe,...$Ne},Xi=Vje(VNe,rPe);function MC(n){const e=hw(()=>wg(n)),{isStatic:t}=O.useContext(fw);if(t){const[,i]=O.useState(n);O.useEffect(()=>e.on("change",i),[])}return e}function Sq(n,e){const t=MC(e()),i=()=>t.set(e());return i(),LF(()=>{const r=()=>lo.preRender(i,!1,!0),s=n.map(o=>o.on("change",r));return()=>{s.forEach(o=>o()),kA(i)}}),t}function zNe(n){$y.current=[],n();const e=Sq($y.current,n);return $y.current=void 0,e}function ay(n,e,t,i){if(typeof n=="function")return zNe(n);const r=typeof e=="function"?e:oje(e,t,i);return Array.isArray(n)?tR(n,r):tR([n],([s])=>r(s))}function tR(n,e){const t=hw(()=>[]);return Sq(n,()=>{t.length=0;const i=n.length;for(let r=0;r<i;r++)t[r]=n[r].get();return e(t)})}function nR(n,e={}){const{isStatic:t}=O.useContext(fw),i=()=>hl(n)?n.get():n;if(t)return ay(i);const r=MC(i());return O.useInsertionEffect(()=>aje(r,n,e),[r,JSON.stringify(e)]),r}const AS="projectShares",GNe=async()=>{try{const n=await mr();if(!n)return{shares:[],error:"로그인이 필요합니다."};const e=ph(Ua(Ri,AS),Ca("ownerId","==",n.uid),Ca("isActive","==",!0),Bg("createdAt","desc")),t=await Mu(e),i=[];return t.forEach(r=>{const s=r.data();i.push({id:r.id,...s})}),{shares:i,error:null}}catch(n){return console.error("공유한 프로젝트 목록 가져오기 에러:",n),{shares:[],error:"공유한 프로젝트 목록을 가져오는 중 오류가 발생했습니다."}}},XNe=async()=>{try{const n=await mr();if(!n)return{shares:[],error:"로그인이 필요합니다."};const e=ph(Ua(Ri,AS),Ca("sharedWith","==",n.email),Ca("isActive","==",!0),Bg("createdAt","desc")),t=await Mu(e),i=[];return t.forEach(r=>{const s=r.data();i.push({id:r.id,...s})}),{shares:i,error:null}}catch(n){return console.error("공유받은 프로젝트 목록 가져오기 에러:",n),{shares:[],error:"공유받은 프로젝트 목록을 가져오는 중 오류가 발생했습니다."}}},KNe=async n=>{try{const e=await mr();if(!e)return{error:"로그인이 필요합니다."};const t=Tr(Ri,AS,n),i=await Kh(t);return i.exists()?i.data().ownerId!==e.uid?{error:"공유를 취소할 권한이 없습니다."}:(await cl(t,{isActive:!1}),{error:null}):{error:"공유를 찾을 수 없습니다."}}catch(e){return console.error("공유 취소 에러:",e),{error:"공유 취소 중 오류가 발생했습니다."}}},qNe=async(n,e)=>{try{const t=await mr();if(!t)return{error:"로그인이 필요합니다."};const i=Tr(Ri,AS,n),r=await Kh(i);return r.exists()?r.data().ownerId!==t.uid?{error:"권한을 변경할 수 없습니다."}:(await cl(i,{permission:e}),{error:null}):{error:"공유를 찾을 수 없습니다."}}catch(t){return console.error("공유 권한 변경 에러:",t),{error:"공유 권한 변경 중 오류가 발생했습니다."}}},YNe="_tabContent_14wpp_2",ZNe="_tabHeader_14wpp_14",JNe="_tabTitle_14wpp_24",eLe="_tabActions_14wpp_35",tLe="_searchBox_14wpp_42",nLe="_searchInput_14wpp_53",iLe="_filterDropdown_14wpp_62",rLe="_filterSelect_14wpp_68",sLe="_subTabs_14wpp_78",oLe="_subTab_14wpp_78",aLe="_active_14wpp_100",lLe="_profileSections_14wpp_108",cLe="_sectionTab_14wpp_113",hLe="_contentArea_14wpp_139",uLe="_loadingState_14wpp_148",dLe="_spinner_14wpp_157",ALe="_spin_14wpp_157",fLe="_errorState_14wpp_173",pLe="_errorMessage_14wpp_182",gLe="_retryButton_14wpp_189",mLe="_emptyState_14wpp_207",yLe="_bookmarkGrid_14wpp_239",vLe="_shareGrid_14wpp_240",wLe="_teamsGrid_14wpp_241",xLe="_bookmarkCard_14wpp_248",bLe="_shareCard_14wpp_249",_Le="_teamCard_14wpp_250",CLe="_bookmarkHeader_14wpp_267",SLe="_shareHeader_14wpp_268",TLe="_teamHeader_14wpp_269",BLe="_bookmarkIcon_14wpp_276",ELe="_shareIcon_14wpp_277",kLe="_teamIcon_14wpp_278",ILe="_bookmarkToggle_14wpp_290",FLe="_actionButton_14wpp_291",DLe="_danger_14wpp_311",jLe="_teamActions_14wpp_316",PLe="_bookmarkContent_14wpp_322",NLe="_shareContent_14wpp_323",LLe="_teamContent_14wpp_324",MLe="_bookmarkTitle_14wpp_328",RLe="_shareTitle_14wpp_329",OLe="_teamName_14wpp_330",ULe="_bookmarkMeta_14wpp_338",HLe="_shareMeta_14wpp_339",WLe="_teamMeta_14wpp_340",QLe="_bookmarkType_14wpp_347",$Le="_permissionBadge_14wpp_348",VLe="_roleBadge_14wpp_349",zLe="_personal_14wpp_356",GLe="_editor_14wpp_357",XLe="_owner_14wpp_358",KLe="_admin_14wpp_359",qLe="_shared_14wpp_364",YLe="_viewer_14wpp_365",ZLe="_bookmarkDate_14wpp_373",JLe="_shareDate_14wpp_374",eMe="_teamDate_14wpp_375",tMe="_shareUser_14wpp_383",nMe="_memberCount_14wpp_384",iMe="_expiryDate_14wpp_392",rMe="_tabFooter_14wpp_398",sMe="_bookmarkStats_14wpp_406",oMe="_shareStats_14wpp_407",aMe="_filterInfo_14wpp_412",lMe="_createButton_14wpp_418",cMe="_shareButton_14wpp_419",hMe="_createTeamButton_14wpp_420",uMe="_invitationsSection_14wpp_441",dMe="_sectionTitle_14wpp_449",AMe="_invitationsList_14wpp_459",fMe="_invitationCard_14wpp_465",pMe="_invitationContent_14wpp_475",gMe="_invitationDate_14wpp_487",mMe="_invitationActions_14wpp_495",yMe="_acceptButton_14wpp_500",vMe="_declineButton_14wpp_501",wMe="_profileSection_14wpp_108",xMe="_profileHeader_14wpp_524",bMe="_profileAvatar_14wpp_533",_Me="_profileBasicInfo_14wpp_550",CMe="_profileEmail_14wpp_563",SMe="_profileForm_14wpp_570",TMe="_notificationsSection_14wpp_571",BMe="_privacySection_14wpp_572",EMe="_formGroup_14wpp_576",kMe="_formRow_14wpp_608",IMe="_formActions_14wpp_614",FMe="_saveButton_14wpp_620",DMe="_settingsGroup_14wpp_645",jMe="_settingItem_14wpp_649",PMe="_settingInfo_14wpp_661",NMe="_sectionDescription_14wpp_673",LMe="_slider_14wpp_693",MMe="_modalOverlay_14wpp_726",RMe="_modal_14wpp_726",OMe="_modalHeader_14wpp_750",UMe="_modalContent_14wpp_778",HMe="_modalActions_14wpp_782",WMe="_membersList_14wpp_861",QMe="_memberItem_14wpp_869",$Me="_memberInfo_14wpp_879",VMe="_memberAvatar_14wpp_886",zMe="_memberDetails_14wpp_904",GMe="_memberName_14wpp_909",XMe="_memberEmail_14wpp_916",KMe="_memberRole_14wpp_924",qMe="_profileAvatarContainer_14wpp_929",YMe="_uploadingOverlay_14wpp_934",ZMe="_avatarActions_14wpp_956",JMe="_avatarActionButton_14wpp_964",Pt={tabContent:YNe,tabHeader:ZNe,tabTitle:JNe,tabActions:eLe,searchBox:tLe,searchInput:nLe,filterDropdown:iLe,filterSelect:rLe,subTabs:sLe,subTab:oLe,active:aLe,profileSections:lLe,sectionTab:cLe,contentArea:hLe,loadingState:uLe,spinner:dLe,spin:ALe,errorState:fLe,errorMessage:pLe,retryButton:gLe,emptyState:mLe,bookmarkGrid:yLe,shareGrid:vLe,teamsGrid:wLe,bookmarkCard:xLe,shareCard:bLe,teamCard:_Le,bookmarkHeader:CLe,shareHeader:SLe,teamHeader:TLe,bookmarkIcon:BLe,shareIcon:ELe,teamIcon:kLe,bookmarkToggle:ILe,actionButton:FLe,danger:DLe,teamActions:jLe,bookmarkContent:PLe,shareContent:NLe,teamContent:LLe,bookmarkTitle:MLe,shareTitle:RLe,teamName:OLe,bookmarkMeta:ULe,shareMeta:HLe,teamMeta:WLe,bookmarkType:QLe,permissionBadge:$Le,roleBadge:VLe,personal:zLe,editor:GLe,owner:XLe,admin:KLe,shared:qLe,viewer:YLe,bookmarkDate:ZLe,shareDate:JLe,teamDate:eMe,shareUser:tMe,memberCount:nMe,expiryDate:iMe,tabFooter:rMe,bookmarkStats:sMe,shareStats:oMe,filterInfo:aMe,createButton:lMe,shareButton:cMe,createTeamButton:hMe,invitationsSection:uMe,sectionTitle:dMe,invitationsList:AMe,invitationCard:fMe,invitationContent:pMe,invitationDate:gMe,invitationActions:mMe,acceptButton:yMe,declineButton:vMe,profileSection:wMe,profileHeader:xMe,profileAvatar:bMe,profileBasicInfo:_Me,profileEmail:CMe,profileForm:SMe,notificationsSection:TMe,privacySection:BMe,formGroup:EMe,formRow:kMe,formActions:IMe,saveButton:FMe,settingsGroup:DMe,settingItem:jMe,settingInfo:PMe,sectionDescription:NMe,switch:"_switch_14wpp_680",slider:LMe,modalOverlay:MMe,modal:RMe,modalHeader:OMe,modalContent:UMe,modalActions:HMe,membersList:WMe,memberItem:QMe,memberInfo:$Me,memberAvatar:VMe,memberDetails:zMe,memberName:GMe,memberEmail:XMe,memberRole:KMe,profileAvatarContainer:qMe,uploadingOverlay:YMe,avatarActions:ZMe,avatarActionButton:JMe},e7e=({onProjectSelect:n})=>{const{user:e}=ec(),[t,i]=O.useState("shared-by-me"),[r,s]=O.useState([]),[o,a]=O.useState([]),[c,h]=O.useState(!1),[u,d]=O.useState(null),[f,A]=O.useState(!1),[g,p]=O.useState(null),y=async()=>{if(e){h(!0),d(null);try{const[x,T]=await Promise.all([GNe(),XNe()]);x.error?console.warn("내가 공유한 프로젝트 로드 실패:",x.error):s(x.shares),T.error?console.warn("공유 프로젝트 로드 실패:",T.error):a(T.shares)}catch{d("공유 데이터를 불러오는 중 오류가 발생했습니다.")}finally{h(!1)}}};O.useEffect(()=>{y()},[e]);const v=async x=>{if(confirm("정말 공유를 취소하시겠습니까?"))try{const{error:T}=await KNe(x);T?alert(T):y()}catch{alert("공유 취소 중 오류가 발생했습니다.")}},m=async(x,T)=>{try{const{error:j}=await qNe(x,T);j?alert(j):y()}catch{alert("권한 변경 중 오류가 발생했습니다.")}},w=t==="shared-by-me"?r:o;return l.jsxs("div",{className:Pt.tabContent,children:[l.jsxs("div",{className:Pt.tabHeader,children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[l.jsxs("h2",{className:Pt.tabTitle,children:[l.jsx(U0,{size:20}),"공유 프로젝트"]}),l.jsx("div",{className:Pt.shareStats,style:{marginLeft:"auto",marginRight:"16px"},children:l.jsx("span",{children:t==="shared-by-me"?`공유한 프로젝트 ${r.length}개`:`공유받은 프로젝트 ${o.length}개`})})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[l.jsxs("div",{className:Pt.subTabs,children:[l.jsx("button",{className:`${Pt.subTab} ${t==="shared-by-me"?Pt.active:""}`,onClick:()=>i("shared-by-me"),children:"내가 공유한 프로젝트"}),l.jsx("button",{className:`${Pt.subTab} ${t==="shared-with-me"?Pt.active:""}`,onClick:()=>i("shared-with-me"),children:"공유받은 프로젝트"})]}),t==="shared-by-me"&&l.jsxs("button",{className:Pt.shareButton,onClick:()=>A(!0),children:[l.jsx(U0,{size:16}),"새 공유 만들기"]})]})]}),l.jsxs("div",{className:Pt.contentArea,children:[c&&l.jsxs("div",{className:Pt.loadingState,children:[l.jsx("div",{className:Pt.spinner}),l.jsx("p",{children:"공유 프로젝트를 불러오는 중..."})]}),!c&&w.length===0&&l.jsxs("div",{className:Pt.emptyState,children:[l.jsx(U0,{size:48}),l.jsx("h3",{children:t==="shared-by-me"?"공유한 프로젝트가 없습니다":"공유받은 프로젝트가 없습니다"}),l.jsx("p",{children:t==="shared-by-me"?"프로젝트를 다른 사람과 공유해보세요.":"다른 사람이 공유한 프로젝트가 여기에 표시됩니다."})]}),!c&&w.length>0&&l.jsx("div",{className:Pt.shareGrid,children:w.map(x=>l.jsxs("div",{className:Pt.shareCard,onClick:()=>n==null?void 0:n(x.projectId),children:[l.jsxs("div",{className:Pt.shareHeader,children:[l.jsx("div",{className:Pt.shareIcon,children:l.jsx(U0,{size:20})}),l.jsx("div",{className:Pt.shareActions,children:t==="shared-by-me"&&l.jsxs(l.Fragment,{children:[l.jsx("button",{className:Pt.actionButton,onClick:T=>{if(T.stopPropagation(),x.shareType==="link"&&x.accessToken){const j=`${window.location.origin}/shared/${x.id}?token=${x.accessToken}`;navigator.clipboard.writeText(j),alert("공유 링크가 복사되었습니다!")}},title:"링크 복사",children:l.jsx(B$,{size:14})}),l.jsx("button",{className:Pt.actionButton,onClick:T=>{T.stopPropagation();const j=x.permission==="viewer"?"editor":"viewer";m(x.id,j)},title:"권한 변경",children:l.jsx(Ty,{size:14})}),l.jsx("button",{className:`${Pt.actionButton} ${Pt.danger}`,onClick:T=>{T.stopPropagation(),v(x.id)},title:"공유 취소",children:l.jsx(O0,{size:14})})]})})]}),l.jsxs("div",{className:Pt.shareContent,children:[l.jsx("h4",{className:Pt.shareTitle,children:x.projectTitle}),l.jsxs("div",{className:Pt.shareMeta,children:[l.jsxs("div",{className:Pt.shareUser,children:[l.jsx(nh,{size:14}),l.jsx("span",{children:t==="shared-by-me"?x.sharedWith==="public"?"링크 공유":x.sharedWith:x.ownerEmail})]}),l.jsx("div",{className:Pt.sharePermission,children:l.jsx("span",{className:`${Pt.permissionBadge} ${Pt[x.permission]}`,children:x.permission==="viewer"?"보기":"편집"})})]}),l.jsxs("div",{className:Pt.shareDate,children:[l.jsx(rE,{size:12}),l.jsx("span",{children:x.createdAt.toDate().toLocaleDateString()}),x.expiresAt&&l.jsxs("span",{className:Pt.expiryDate,children:["만료: ",x.expiresAt.toDate().toLocaleDateString()]})]})]})]},x.id))})]})]})},t7e=({onTeamSelect:n})=>{const{user:e}=ec(),[t,i]=O.useState([]),[r,s]=O.useState([]),[o,a]=O.useState(!1),[c,h]=O.useState(null),[u,d]=O.useState(!1),[f,A]=O.useState(!1),[g,p]=O.useState(!1),[y,v]=O.useState(!1),[m,w]=O.useState(null),[x,T]=O.useState(null),[j,D]=O.useState(""),[b,_]=O.useState(""),[I,S]=O.useState(""),[F,B]=O.useState("viewer"),[E,V]=O.useState(""),[K,P]=O.useState(""),M=async()=>{if(e){a(!0),h(null);try{const[H,se]=await Promise.all([TQ(),Joe()]);H.error?h(H.error):i(H.teams),se.error?console.error("초대 목록 로드 에러:",se.error):s(se.invitations)}catch{h("팀 데이터를 불러오는 중 오류가 발생했습니다.")}finally{a(!1)}}};O.useEffect(()=>{M()},[e]);const X=async()=>{if(!j.trim()){alert("팀 이름을 입력해주세요.");return}a(!0),h(null);try{console.log("🏗️ 팀 생성 시작:",{name:j,description:b});const{teamId:H,error:se}=await Koe(j,b);se?(console.error("❌ 팀 생성 오류:",se),alert(`팀 생성 실패: ${se}`),h(se)):H?(console.log("✅ 팀 생성 성공:",H),alert("팀이 성공적으로 생성되었습니다!"),d(!1),D(""),_(""),setTimeout(()=>{console.log("🔄 팀 목록 새로고침 중..."),M()},1e3)):(console.error("❌ 팀 생성 실패: teamId가 없음"),alert("팀 생성에 실패했습니다. 다시 시도해주세요."))}catch(H){console.error("❌ 팀 생성 예외:",H);const se=H instanceof Error?H.message:"알 수 없는 오류가 발생했습니다.";alert(`팀 생성 중 오류가 발생했습니다: ${se}`),h(se)}finally{a(!1)}},Z=async(H,se)=>{try{const{error:te}=await Yoe(H,se);te?alert(te):M()}catch{alert("초대 수락 중 오류가 발생했습니다.")}},Q=async(H,se)=>{try{const{error:te}=await eae(H,se);te?alert(te):M()}catch{alert("초대 거절 중 오류가 발생했습니다.")}},U=async()=>{if(!(!m||!I.trim()))try{const{invitationId:H,error:se}=await qoe(m,I,F);se?alert(se):(A(!1),S(""),B("viewer"),w(null),alert("팀원 초대를 보냈습니다!"))}catch{alert("팀원 초대 중 오류가 발생했습니다.")}},z=async H=>{try{const{team:se,error:te}=await M_(H);if(te||!se){alert(te||"팀 정보를 불러올 수 없습니다.");return}T(se),V(se.name),P(se.description||""),p(!0)}catch{alert("팀 정보를 불러오는 중 오류가 발생했습니다.")}},q=async()=>{if(!(!x||!E.trim()))try{const{error:H}=await Zoe(x.id,{name:E,description:K});H?alert(H):(p(!1),T(null),M(),alert("팀 정보가 업데이트되었습니다."))}catch{alert("팀 업데이트 중 오류가 발생했습니다.")}},G=async H=>{try{const{team:se,error:te}=await M_(H);if(te||!se){alert(te||"팀 정보를 불러올 수 없습니다.");return}T(se),v(!0)}catch{alert("팀 정보를 불러오는 중 오류가 발생했습니다.")}},ie=H=>{switch(H){case"owner":return"소유자";case"admin":return"관리자";case"editor":return"편집자";case"viewer":return"보기 전용";default:return H}};return l.jsxs("div",{className:Pt.tabContent,children:[l.jsxs("div",{className:Pt.tabHeader,children:[l.jsxs("h2",{className:Pt.tabTitle,children:[l.jsx(Sy,{size:20}),"팀 관리"]}),l.jsxs("button",{className:Pt.createButton,onClick:()=>d(!0),children:[l.jsx(Np,{size:16}),"새 팀 만들기"]})]}),r.length>0&&l.jsxs("div",{className:Pt.invitationsSection,children:[l.jsxs("h3",{className:Pt.sectionTitle,children:[l.jsx(Dhe,{size:16}),"팀 초대 (",r.length,")"]}),l.jsx("div",{className:Pt.invitationsList,children:r.map(H=>l.jsxs("div",{className:Pt.invitationCard,children:[l.jsxs("div",{className:Pt.invitationContent,children:[l.jsx("h4",{children:H.teamName}),l.jsxs("p",{children:[H.inviterDisplayName||H.inviterEmail,"님이",ie(H.role)," 권한으로 초대했습니다."]}),l.jsxs("div",{className:Pt.invitationDate,children:[l.jsx(rE,{size:12}),H.createdAt.toDate().toLocaleDateString()]})]}),l.jsxs("div",{className:Pt.invitationActions,children:[l.jsx("button",{className:Pt.acceptButton,onClick:()=>Z(H.id,H.token),children:"수락"}),l.jsx("button",{className:Pt.declineButton,onClick:()=>Q(H.id,H.token),children:"거절"})]})]},H.id))})]}),l.jsxs("div",{className:Pt.contentArea,children:[o&&l.jsxs("div",{className:Pt.loadingState,children:[l.jsx("div",{className:Pt.spinner}),l.jsx("p",{children:"팀을 불러오는 중..."})]}),c&&l.jsxs("div",{className:Pt.errorState,children:[l.jsx("p",{className:Pt.errorMessage,children:c}),l.jsx("button",{onClick:M,className:Pt.retryButton,children:"다시 시도"})]}),!o&&!c&&t.length===0&&l.jsxs("div",{className:Pt.emptyState,children:[l.jsx(Sy,{size:48}),l.jsx("h3",{children:"참여한 팀이 없습니다"}),l.jsx("p",{children:"새 팀을 만들거나 팀 초대를 받아보세요."}),l.jsx("button",{className:Pt.createTeamButton,onClick:()=>d(!0),children:"첫 번째 팀 만들기"})]}),!o&&!c&&t.length>0&&l.jsx("div",{className:Pt.teamsGrid,children:t.map(H=>{const se=H.members.find(fe=>fe.userId===(e==null?void 0:e.uid)),te=H.ownerId===(e==null?void 0:e.uid);return l.jsxs("div",{className:Pt.teamCard,onClick:()=>G(H.id),children:[l.jsxs("div",{className:Pt.teamHeader,children:[l.jsx("div",{className:Pt.teamIcon,children:l.jsx(Sy,{size:20})}),(te||(se==null?void 0:se.role)==="admin")&&l.jsxs("div",{className:Pt.teamActions,children:[l.jsx("button",{className:Pt.actionButton,onClick:fe=>{fe.stopPropagation(),w(H.id),A(!0)},title:"팀원 초대",children:l.jsx(Np,{size:14})}),l.jsx("button",{className:Pt.actionButton,onClick:fe=>{fe.stopPropagation(),z(H.id)},title:"팀 설정",children:l.jsx(DI,{size:14})})]})]}),l.jsxs("div",{className:Pt.teamContent,children:[l.jsx("h4",{className:Pt.teamName,children:H.name}),H.description&&l.jsx("p",{className:Pt.teamDescription,children:H.description}),l.jsxs("div",{className:Pt.teamMeta,children:[l.jsxs("div",{className:Pt.memberCount,children:[l.jsx(nh,{size:14}),l.jsxs("span",{children:[H.members.length,"명"]})]}),l.jsx("div",{className:Pt.userRole,children:l.jsx("span",{className:`${Pt.roleBadge} ${Pt[(se==null?void 0:se.role)||"viewer"]}`,children:ie((se==null?void 0:se.role)||"viewer")})})]}),l.jsxs("div",{className:Pt.teamDate,children:[l.jsx(rE,{size:12}),l.jsxs("span",{children:["생성일: ",H.createdAt.toDate().toLocaleDateString()]})]})]})]},H.id)})})]}),u&&l.jsx("div",{className:Pt.modalOverlay,onClick:()=>d(!1),children:l.jsxs("div",{className:Pt.modal,onClick:H=>H.stopPropagation(),children:[l.jsxs("div",{className:Pt.modalHeader,children:[l.jsx("h3",{children:"새 팀 만들기"}),l.jsx("button",{onClick:()=>d(!1),children:"×"})]}),l.jsxs("div",{className:Pt.modalContent,children:[l.jsxs("div",{className:Pt.formGroup,children:[l.jsx("label",{children:"팀 이름"}),l.jsx("input",{type:"text",value:j,onChange:H=>D(H.target.value),placeholder:"팀 이름을 입력하세요"})]}),l.jsxs("div",{className:Pt.formGroup,children:[l.jsx("label",{children:"설명 (선택사항)"}),l.jsx("textarea",{value:b,onChange:H=>_(H.target.value),placeholder:"팀 설명을 입력하세요",rows:3})]})]}),c&&l.jsx("div",{className:Pt.errorMessage,children:c}),l.jsxs("div",{className:Pt.modalActions,children:[l.jsx("button",{onClick:()=>d(!1),disabled:o,children:"취소"}),l.jsx("button",{onClick:X,disabled:!j.trim()||o,children:o?"생성 중...":"팀 만들기"})]})]})}),f&&l.jsx("div",{className:Pt.modalOverlay,onClick:()=>A(!1),children:l.jsxs("div",{className:Pt.modal,onClick:H=>H.stopPropagation(),children:[l.jsxs("div",{className:Pt.modalHeader,children:[l.jsx("h3",{children:"팀원 초대"}),l.jsx("button",{onClick:()=>A(!1),children:"×"})]}),l.jsxs("div",{className:Pt.modalContent,children:[l.jsxs("div",{className:Pt.formGroup,children:[l.jsx("label",{children:"이메일 주소"}),l.jsx("input",{type:"email",value:I,onChange:H=>S(H.target.value),placeholder:"초대할 사용자의 이메일을 입력하세요"})]}),l.jsxs("div",{className:Pt.formGroup,children:[l.jsx("label",{children:"권한"}),l.jsxs("select",{value:F,onChange:H=>B(H.target.value),children:[l.jsx("option",{value:"viewer",children:"보기 전용"}),l.jsx("option",{value:"editor",children:"편집자"}),l.jsx("option",{value:"admin",children:"관리자"})]})]})]}),l.jsxs("div",{className:Pt.modalActions,children:[l.jsx("button",{onClick:()=>A(!1),children:"취소"}),l.jsx("button",{onClick:U,disabled:!I.trim(),children:"초대 보내기"})]})]})}),g&&x&&l.jsx("div",{className:Pt.modalOverlay,onClick:()=>p(!1),children:l.jsxs("div",{className:Pt.modal,onClick:H=>H.stopPropagation(),children:[l.jsxs("div",{className:Pt.modalHeader,children:[l.jsx("h3",{children:"팀 설정"}),l.jsx("button",{onClick:()=>p(!1),children:"×"})]}),l.jsxs("div",{className:Pt.modalContent,children:[l.jsxs("div",{className:Pt.formGroup,children:[l.jsx("label",{children:"팀 이름"}),l.jsx("input",{type:"text",value:E,onChange:H=>V(H.target.value),placeholder:"팀 이름을 입력하세요"})]}),l.jsxs("div",{className:Pt.formGroup,children:[l.jsx("label",{children:"설명"}),l.jsx("textarea",{value:K,onChange:H=>P(H.target.value),placeholder:"팀 설명을 입력하세요",rows:3})]})]}),l.jsxs("div",{className:Pt.modalActions,children:[l.jsx("button",{onClick:()=>p(!1),children:"취소"}),l.jsx("button",{onClick:q,disabled:!E.trim(),children:"저장"})]})]})}),y&&x&&l.jsx("div",{className:Pt.modalOverlay,onClick:()=>v(!1),children:l.jsxs("div",{className:Pt.modal,onClick:H=>H.stopPropagation(),children:[l.jsxs("div",{className:Pt.modalHeader,children:[l.jsxs("h3",{children:[x.name," 멤버 목록"]}),l.jsx("button",{onClick:()=>v(!1),children:"×"})]}),l.jsx("div",{className:Pt.modalContent,children:l.jsx("div",{className:Pt.membersList,children:x.members.map(H=>l.jsxs("div",{className:Pt.memberItem,children:[l.jsxs("div",{className:Pt.memberInfo,children:[l.jsx("div",{className:Pt.memberAvatar,children:H.photoURL?l.jsx("img",{src:H.photoURL,alt:"프로필"}):l.jsx(nh,{size:20})}),l.jsxs("div",{className:Pt.memberDetails,children:[l.jsx("div",{className:Pt.memberName,children:H.displayName||H.email}),l.jsx("div",{className:Pt.memberEmail,children:H.email})]})]}),l.jsx("div",{className:Pt.memberRole,children:l.jsx("span",{className:`${Pt.roleBadge} ${Pt[H.role]}`,children:ie(H.role)})})]},H.userId))})}),l.jsx("div",{className:Pt.modalActions,children:l.jsx("button",{onClick:()=>v(!1),children:"닫기"})})]})})]})},gw="userProfiles",Tq=async n=>{try{const e=await mr();if(!e)return{error:"로그인이 필요합니다."};const t=Tr(Ri,gw,e.uid),i=await Kh(t),r={uid:e.uid,email:e.email||"",displayName:e.displayName||void 0,photoURL:e.photoURL||void 0,bio:"",company:"",website:"",location:"",teamNotifications:!0,shareNotifications:!0,emailNotifications:!0,isPublicProfile:!1,allowTeamInvitations:!0,createdAt:Ks(),updatedAt:Ks()};if(i.exists()){const s={...n,updatedAt:Ks()};await cl(t,s)}else{const s={...r,...n};await ug(t,s)}return{error:null}}catch(e){return console.error("사용자 프로필 생성/업데이트 에러:",e),{error:"사용자 프로필 처리 중 오류가 발생했습니다."}}},n7e=async n=>{var e;try{let t=n;if(!t){const o=await mr();if(!o)return{profile:null,error:"로그인이 필요합니다."};t=o.uid}const i=Tr(Ri,gw,t),r=await Kh(i);if(!r.exists()){if(!n){const{error:o}=await Tq({});if(o)return{profile:null,error:o};const a=await Kh(i);if(a.exists())return{profile:a.data(),error:null}}return{profile:null,error:"사용자 프로필을 찾을 수 없습니다."}}const s=r.data();return n&&((e=await mr())==null||e.uid),{profile:s,error:null}}catch(t){return console.error("사용자 프로필 가져오기 에러:",t),{profile:null,error:"사용자 프로필을 가져오는 중 오류가 발생했습니다."}}},i7e=async n=>{try{const e=await mr();if(!e)return{error:"로그인이 필요합니다."};const t=Tr(Ri,gw,e.uid);if(!(await Kh(t)).exists())return await Tq(n);const r={...n,updatedAt:Ks()};return await cl(t,r),{error:null}}catch(e){return console.error("사용자 프로필 업데이트 에러:",e),{error:"사용자 프로필 업데이트 중 오류가 발생했습니다."}}},r7e=async n=>{try{const e=await mr();if(!e)return{error:"로그인이 필요합니다."};const t=Tr(Ri,gw,e.uid),i={...n,updatedAt:Ks()};return await cl(t,i),{error:null}}catch(e){return console.error("알림 설정 업데이트 에러:",e),{error:"알림 설정 업데이트 중 오류가 발생했습니다."}}},s7e=async n=>{try{const e=await mr();if(!e)return{error:"로그인이 필요합니다."};const t=Tr(Ri,gw,e.uid),i={...n,updatedAt:Ks()};return await cl(t,i),{error:null}}catch(e){return console.error("개인정보 설정 업데이트 에러:",e),{error:"개인정보 설정 업데이트 중 오류가 발생했습니다."}}},o7e=async n=>{try{const e=await mr();if(!e)return{photoURL:null,error:"로그인이 필요합니다."};if(!["image/jpeg","image/png","image/gif","image/webp"].includes(n.type))return{photoURL:null,error:"지원되지 않는 파일 형식입니다. (JPEG, PNG, GIF, WebP만 지원)"};const i=5*1024*1024;if(n.size>i)return{photoURL:null,error:"파일 크기가 너무 큽니다. (최대 5MB)"};try{if(e.photoURL){const a=N_(nv,`profile-images/${e.uid}`);await hQ(a)}}catch(a){console.warn("기존 프로필 사진 삭제 실패:",a)}const r=N_(nv,`profile-images/${e.uid}`),s=await lQ(r,n),o=await cQ(s.ref);return await JC(e,{photoURL:o}),{photoURL:o,error:null}}catch(e){return console.error("프로필 사진 업로드 에러:",e),{photoURL:null,error:"프로필 사진 업로드 중 오류가 발생했습니다."}}},a7e=async()=>{try{const n=await mr();if(!n)return{error:"로그인이 필요합니다."};if(n.photoURL){const e=N_(nv,`profile-images/${n.uid}`);await hQ(e)}return await JC(n,{photoURL:null}),{error:null}}catch(n){return console.error("프로필 사진 삭제 에러:",n),{error:"프로필 사진 삭제 중 오류가 발생했습니다."}}},l7e=(n,e=400,t=.8)=>new Promise(i=>{const r=document.createElement("canvas"),s=r.getContext("2d"),o=new Image;o.onload=()=>{const a=Math.min(e/o.width,e/o.height);r.width=o.width*a,r.height=o.height*a,s.drawImage(o,0,0,r.width,r.height),r.toBlob(c=>{if(c){const h=new File([c],n.name,{type:n.type,lastModified:Date.now()});i(h)}else i(n)},n.type,t)},o.src=URL.createObjectURL(n)}),c7e=()=>{const{user:n}=ec(),[e,t]=O.useState(null),[i,r]=O.useState(!1),[s,o]=O.useState(!1),[a,c]=O.useState(null),[h,u]=O.useState("profile"),[d,f]=O.useState(!1),A=O.useRef(null),[g,p]=O.useState(""),[y,v]=O.useState(""),[m,w]=O.useState(""),[x,T]=O.useState(""),[j,D]=O.useState(""),[b,_]=O.useState(!0),[I,S]=O.useState(!0),[F,B]=O.useState(!0),[E,V]=O.useState(!1),[K,P]=O.useState(!0),M=async()=>{if(n){r(!0),c(null);try{const{profile:G,error:ie}=await n7e();ie?c(ie):G&&(t(G),p(G.displayName||""),v(G.bio||""),w(G.company||""),T(G.website||""),D(G.location||""),_(G.teamNotifications),S(G.shareNotifications),B(G.emailNotifications),V(G.isPublicProfile),P(G.allowTeamInvitations))}catch{c("프로필을 불러오는 중 오류가 발생했습니다.")}finally{r(!1)}}};O.useEffect(()=>{M()},[n]);const X=async()=>{o(!0);try{const{error:G}=await i7e({displayName:g.trim()||void 0,bio:y.trim()||void 0,company:m.trim()||void 0,website:x.trim()||void 0,location:j.trim()||void 0});G?alert(G):(alert("프로필이 저장되었습니다."),M())}catch{alert("프로필 저장 중 오류가 발생했습니다.")}finally{o(!1)}},Z=async()=>{o(!0);try{const{error:G}=await r7e({teamNotifications:b,shareNotifications:I,emailNotifications:F});alert(G||"알림 설정이 저장되었습니다.")}catch{alert("알림 설정 저장 중 오류가 발생했습니다.")}finally{o(!1)}},Q=async()=>{o(!0);try{const{error:G}=await s7e({isPublicProfile:E,allowTeamInvitations:K});alert(G||"개인정보 설정이 저장되었습니다.")}catch{alert("개인정보 설정 저장 중 오류가 발생했습니다.")}finally{o(!1)}},U=async G=>{var H;const ie=(H=G.target.files)==null?void 0:H[0];if(ie){f(!0);try{const se=await l7e(ie,400,.8),{photoURL:te,error:fe}=await o7e(se);fe?alert(fe):(alert("프로필 사진이 업데이트되었습니다."),M())}catch{alert("프로필 사진 업로드 중 오류가 발생했습니다.")}finally{f(!1),A.current&&(A.current.value="")}}},z=async()=>{if(n!=null&&n.photoURL&&confirm("프로필 사진을 삭제하시겠습니까?")){f(!0);try{const{error:G}=await a7e();G?alert(G):(alert("프로필 사진이 삭제되었습니다."),M())}catch{alert("프로필 사진 삭제 중 오류가 발생했습니다.")}finally{f(!1)}}},q=()=>{var G;(G=A.current)==null||G.click()};return l.jsxs("div",{className:Pt.tabContent,children:[l.jsxs("div",{className:Pt.tabHeader,children:[l.jsxs("h2",{className:Pt.tabTitle,children:[l.jsx(nh,{size:20}),"내 정보 관리"]}),l.jsxs("div",{className:Pt.profileSections,children:[l.jsxs("button",{className:`${Pt.sectionTab} ${h==="profile"?Pt.active:""}`,onClick:()=>u("profile"),children:[l.jsx(nh,{size:16}),"프로필"]}),l.jsxs("button",{className:`${Pt.sectionTab} ${h==="notifications"?Pt.active:""}`,onClick:()=>u("notifications"),children:[l.jsx(T$,{size:16}),"알림"]}),l.jsxs("button",{className:`${Pt.sectionTab} ${h==="privacy"?Pt.active:""}`,onClick:()=>u("privacy"),children:[l.jsx(jhe,{size:16}),"개인정보"]})]})]}),l.jsxs("div",{className:Pt.contentArea,children:[i&&l.jsxs("div",{className:Pt.loadingState,children:[l.jsx("div",{className:Pt.spinner}),l.jsx("p",{children:"프로필을 불러오는 중..."})]}),a&&l.jsxs("div",{className:Pt.errorState,children:[l.jsx("p",{className:Pt.errorMessage,children:a}),l.jsx("button",{onClick:M,className:Pt.retryButton,children:"다시 시도"})]}),!i&&!a&&l.jsxs(l.Fragment,{children:[h==="profile"&&l.jsxs("div",{className:Pt.profileSection,children:[l.jsxs("div",{className:Pt.profileHeader,children:[l.jsxs("div",{className:Pt.profileAvatarContainer,children:[l.jsxs("div",{className:Pt.profileAvatar,children:[n!=null&&n.photoURL?l.jsx("img",{src:n.photoURL,alt:"프로필"}):l.jsx(nh,{size:48}),d&&l.jsx("div",{className:Pt.uploadingOverlay,children:l.jsx("div",{className:Pt.spinner})})]}),l.jsxs("div",{className:Pt.avatarActions,children:[l.jsx("button",{className:Pt.avatarActionButton,onClick:q,disabled:d,title:"프로필 사진 변경",children:l.jsx(Phe,{size:16})}),(n==null?void 0:n.photoURL)&&l.jsx("button",{className:Pt.avatarActionButton,onClick:z,disabled:d,title:"프로필 사진 삭제",children:l.jsx(O0,{size:16})})]}),l.jsx("input",{ref:A,type:"file",accept:"image/*",onChange:U,style:{display:"none"}})]}),l.jsxs("div",{className:Pt.profileBasicInfo,children:[l.jsx("h3",{children:(n==null?void 0:n.displayName)||(n==null?void 0:n.email)}),l.jsx("p",{className:Pt.profileEmail,children:n==null?void 0:n.email})]})]}),l.jsxs("div",{className:Pt.profileForm,children:[l.jsxs("div",{className:Pt.formGroup,children:[l.jsx("label",{children:"표시 이름"}),l.jsx("input",{type:"text",value:g,onChange:G=>p(G.target.value),placeholder:"표시 이름을 입력하세요"})]}),l.jsxs("div",{className:Pt.formGroup,children:[l.jsx("label",{children:"소개"}),l.jsx("textarea",{value:y,onChange:G=>v(G.target.value),placeholder:"자신을 소개해보세요",rows:3})]}),l.jsxs("div",{className:Pt.formRow,children:[l.jsxs("div",{className:Pt.formGroup,children:[l.jsx("label",{children:"회사/조직"}),l.jsx("input",{type:"text",value:m,onChange:G=>w(G.target.value),placeholder:"회사명을 입력하세요"})]}),l.jsxs("div",{className:Pt.formGroup,children:[l.jsx("label",{children:"위치"}),l.jsx("input",{type:"text",value:j,onChange:G=>D(G.target.value),placeholder:"위치를 입력하세요"})]})]}),l.jsxs("div",{className:Pt.formGroup,children:[l.jsx("label",{children:"웹사이트"}),l.jsx("input",{type:"url",value:x,onChange:G=>T(G.target.value),placeholder:"https://example.com"})]}),l.jsx("div",{className:Pt.formActions,children:l.jsxs("button",{className:Pt.saveButton,onClick:X,disabled:s,children:[l.jsx(t3,{size:16}),s?"저장 중...":"프로필 저장"]})})]})]}),h==="notifications"&&l.jsxs("div",{className:Pt.notificationsSection,children:[l.jsx("h3",{children:"알림 설정"}),l.jsx("p",{className:Pt.sectionDescription,children:"받고 싶은 알림을 선택하세요."}),l.jsxs("div",{className:Pt.settingsGroup,children:[l.jsxs("div",{className:Pt.settingItem,children:[l.jsxs("div",{className:Pt.settingInfo,children:[l.jsx("h4",{children:"팀 관련 알림"}),l.jsx("p",{children:"팀 초대, 멤버 변경 등의 알림을 받습니다."})]}),l.jsxs("label",{className:Pt.switch,children:[l.jsx("input",{type:"checkbox",checked:b,onChange:G=>_(G.target.checked)}),l.jsx("span",{className:Pt.slider})]})]}),l.jsxs("div",{className:Pt.settingItem,children:[l.jsxs("div",{className:Pt.settingInfo,children:[l.jsx("h4",{children:"공유 관련 알림"}),l.jsx("p",{children:"프로젝트 공유, 권한 변경 등의 알림을 받습니다."})]}),l.jsxs("label",{className:Pt.switch,children:[l.jsx("input",{type:"checkbox",checked:I,onChange:G=>S(G.target.checked)}),l.jsx("span",{className:Pt.slider})]})]}),l.jsxs("div",{className:Pt.settingItem,children:[l.jsxs("div",{className:Pt.settingInfo,children:[l.jsx("h4",{children:"이메일 알림"}),l.jsx("p",{children:"중요한 알림을 이메일로도 받습니다."})]}),l.jsxs("label",{className:Pt.switch,children:[l.jsx("input",{type:"checkbox",checked:F,onChange:G=>B(G.target.checked)}),l.jsx("span",{className:Pt.slider})]})]})]}),l.jsx("div",{className:Pt.formActions,children:l.jsxs("button",{className:Pt.saveButton,onClick:Z,disabled:s,children:[l.jsx(t3,{size:16}),s?"저장 중...":"알림 설정 저장"]})})]}),h==="privacy"&&l.jsxs("div",{className:Pt.privacySection,children:[l.jsx("h3",{children:"개인정보 설정"}),l.jsx("p",{className:Pt.sectionDescription,children:"프로필 공개 범위와 권한을 설정하세요."}),l.jsxs("div",{className:Pt.settingsGroup,children:[l.jsxs("div",{className:Pt.settingItem,children:[l.jsxs("div",{className:Pt.settingInfo,children:[l.jsx("h4",{children:"공개 프로필"}),l.jsx("p",{children:"다른 사용자가 내 프로필을 볼 수 있습니다."})]}),l.jsxs("label",{className:Pt.switch,children:[l.jsx("input",{type:"checkbox",checked:E,onChange:G=>V(G.target.checked)}),l.jsx("span",{className:Pt.slider})]})]}),l.jsxs("div",{className:Pt.settingItem,children:[l.jsxs("div",{className:Pt.settingInfo,children:[l.jsx("h4",{children:"팀 초대 허용"}),l.jsx("p",{children:"다른 사용자가 나를 팀에 초대할 수 있습니다."})]}),l.jsxs("label",{className:Pt.switch,children:[l.jsx("input",{type:"checkbox",checked:K,onChange:G=>P(G.target.checked)}),l.jsx("span",{className:Pt.slider})]})]})]}),l.jsx("div",{className:Pt.formActions,children:l.jsxs("button",{className:Pt.saveButton,onClick:Q,disabled:s,children:[l.jsx(t3,{size:16}),s?"저장 중...":"개인정보 설정 저장"]})})]})]})]})]})},h7e=async n=>{try{const e=await mr();if(!e)return null;const t=ph(Ua(Ri,"projectShares"),Ca("sharedWith","==",e.email),Ca("isActive","==",!0),Bg("createdAt","desc"));return Jk(t,r=>{const s=[];r.forEach(o=>{const a=o.data();s.push({id:o.id,...a})}),n(s)},r=>{r.message.includes("index")?(console.info("📌 공유 프로젝트 기능을 위한 Firestore 인덱스가 필요합니다."),console.info("Firebase Console에서 다음 인덱스를 생성해주세요:"),console.info("Collection: projectShares"),console.info("Fields: isActive (Ascending), sharedWith (Ascending), createdAt (Descending)")):console.error("공유 프로젝트 실시간 업데이트 에러:",r),n([])})}catch(e){return console.error("공유 프로젝트 리스너 초기화 에러:",e),null}},u7e=async n=>{try{const e=await mr();if(!e)return null;const t=ph(Ua(Ri,"teamInvitations"),Ca("inviteeEmail","==",e.email),Ca("status","==","pending"),Bg("createdAt","desc"));return Jk(t,r=>{const s=[];r.forEach(o=>{const a=o.data();a.expiresAt.toDate()>new Date&&s.push({id:o.id,...a})}),n(s)},r=>{r.message.includes("index")?(console.info("📌 팀 초대 기능을 위한 Firestore 인덱스가 필요합니다."),console.info("Firebase Console에서 다음 인덱스를 생성해주세요:"),console.info("Collection: teamInvitations"),console.info("Fields: inviteeEmail (Ascending), status (Ascending), createdAt (Descending)")):console.error("팀 초대 실시간 업데이트 에러:",r),n([])})}catch(e){return console.error("팀 초대 리스너 초기화 에러:",e),null}},d7e=n=>new Promise(async e=>{try{if(!await mr()){e([]);return}let i=0,r=0;const s=[],o=await u7e(c=>{i=c.length,n(i+r)});o&&s.push(o);const a=await h7e(c=>{const h=new Date;h.setDate(h.getDate()-1),r=c.filter(u=>u.createdAt.toDate()>h).length,n(i+r)});a&&s.push(a),e(s)}catch(t){console.error("알림 카운터 리스너 초기화 에러:",t),e([])}}),A7e=n=>{n.forEach(e=>{e&&e()})},f7e="_notificationBadge_t6jn3_1",p7e="_badge_t6jn3_6",iR={notificationBadge:f7e,badge:p7e},g7e=({children:n,className:e})=>{const{user:t}=ec(),[i,r]=O.useState(0);return O.useEffect(()=>{if(!t){r(0);return}let s=[];return(async()=>{try{s=await d7e(c=>{r(c)})}catch(a){console.error("알림 리스너 설정 에러:",a)}})(),()=>{A7e(s)}},[t]),l.jsxs("div",{className:`${iR.notificationBadge} ${e||""}`,children:[n,i>0&&l.jsx("span",{className:iR.badge,children:i>99?"99+":i})]})},Bq=({spaceConfig:n,placedModules:e=[],viewMode:t="3D",renderMode:i="solid"})=>{console.log("🔍 Space3DViewerReadOnly 렌더링:",{hasSpaceConfig:!!n,placedModulesCount:e.length,placedModules:e,spaceConfig:n,viewMode:t,renderMode:i});const r=(n==null?void 0:n.materialConfig)||{interiorColor:"#FFFFFF",doorColor:"#E0E0E0"},s=O.useMemo(()=>{if(!n)return[0,10,20];const{width:o,height:a,depth:c=1500}=n,h=jc(o,a,c,e.length),u=0,d=El(a*.5);return[u,d,h]},[n==null?void 0:n.width,n==null?void 0:n.height,n==null?void 0:n.depth,e.length]);return n?l.jsx(GB,{spaceInfo:n,svgSize:{width:800,height:600},renderMode:i,viewMode:t,children:l.jsx("div",{style:{width:"100%",height:"100%",minHeight:"400px",position:"relative"},children:l.jsx(B0,{cameraPosition:s,viewMode:t,view2DDirection:"front",renderMode:i,children:l.jsxs(ii.Suspense,{fallback:null,children:[l.jsx("directionalLight",{position:[5,15,20],intensity:2.5,color:"#ffffff",castShadow:t==="3D","shadow-mapSize-width":4096,"shadow-mapSize-height":4096,"shadow-camera-far":50,"shadow-camera-left":-25,"shadow-camera-right":25,"shadow-camera-top":25,"shadow-camera-bottom":-25,"shadow-bias":-5e-4,"shadow-radius":12,"shadow-normalBias":.02}),l.jsx("directionalLight",{position:[-8,10,15],intensity:.6,color:"#ffffff"}),l.jsx("ambientLight",{intensity:t==="2D"?.8:.5,color:"#ffffff"}),l.jsx(jI,{spaceInfo:n,viewMode:t,materialConfig:r,showAll:!1,showFrame:!0,showDimensions:!1,placedModules:e,isReadOnly:!0})]})})})}):l.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"#666"},children:"공간 정보를 불러올 수 없습니다"})},m7e="_modalOverlay_1mzc3_2",y7e="_fullscreen_1mzc3_16",v7e="_modalContent_1mzc3_21",w7e="_fullscreenContent_1mzc3_34",x7e="_modalHeader_1mzc3_43",b7e="_headerLeft_1mzc3_53",_7e="_modalTitle_1mzc3_59",C7e="_projectInfo_1mzc3_66",S7e="_headerCenter_1mzc3_71",T7e="_viewModeToggle_1mzc3_77",B7e="_viewModeButton_1mzc3_85",E7e="_active_1mzc3_98",k7e="_headerActions_1mzc3_108",I7e="_actionButton_1mzc3_114",F7e="_closeButton_1mzc3_115",D7e="_modalBody_1mzc3_141",j7e="_viewerContainer_1mzc3_148",P7e="_loadingState_1mzc3_157",N7e="_spinner_1mzc3_166",L7e="_errorState_1mzc3_187",M7e="_errorMessage_1mzc3_197",R7e="_retryButton_1mzc3_203",O7e="_modalFooter_1mzc3_220",U7e="_projectMeta_1mzc3_229",H7e="_shareButton_1mzc3_254",Vs={modalOverlay:m7e,fullscreen:y7e,modalContent:v7e,fullscreenContent:w7e,modalHeader:x7e,headerLeft:b7e,modalTitle:_7e,projectInfo:C7e,headerCenter:S7e,viewModeToggle:T7e,viewModeButton:B7e,active:E7e,headerActions:k7e,actionButton:I7e,closeButton:F7e,modalBody:D7e,viewerContainer:j7e,loadingState:P7e,spinner:N7e,errorState:L7e,errorMessage:M7e,retryButton:R7e,modalFooter:O7e,projectMeta:U7e,shareButton:H7e},W7e=({isOpen:n,onClose:e,projectId:t,designFileId:i,initialViewMode:r="3D"})=>{var m;const[s,o]=O.useState(null),[a,c]=O.useState(!1),[h,u]=O.useState(null),[d,f]=O.useState(!1),[A,g]=O.useState(r);O.useEffect(()=>{n&&t&&p()},[n,t,i]);const p=async()=>{var w,x,T,j,D,b,_,I,S,F,B,E,V;console.log("🔥 ProjectViewerModal - loadProject 시작:",{projectId:t,designFileId:i}),c(!0),u(null);try{if(i){console.log("🔥 디자인 파일 로드 시도:",i);const K=await MQ(i);if(console.log("🔥 디자인 파일 로드 결과:",K),K.designFile){const P={id:K.designFile.projectId,title:K.designFile.name,createdAt:K.designFile.createdAt,updatedAt:K.designFile.updatedAt,furnitureCount:((x=(w=K.designFile.furniture)==null?void 0:w.placedModules)==null?void 0:x.length)||0,spaceSize:{width:((T=K.designFile.spaceConfig)==null?void 0:T.width)||3600,height:((j=K.designFile.spaceConfig)==null?void 0:j.height)||2400,depth:((D=K.designFile.spaceConfig)==null?void 0:D.depth)||1500},thumbnail:K.designFile.thumbnail,folderId:"",spaceInfo:K.designFile.spaceConfig,placedModules:((b=K.designFile.furniture)==null?void 0:b.placedModules)||[]};console.log("디자인 파일 로드:",{designFileId:i,name:K.designFile.name,placedModulesCount:((_=P.placedModules)==null?void 0:_.length)||0,placedModules:P.placedModules,spaceConfig:P.spaceInfo}),o(P)}else u(K.error||"디자인 파일을 찾을 수 없습니다.")}else{const K=await PQ(t);if(K.project){const P={id:K.project.id,title:K.project.title,createdAt:K.project.createdAt,updatedAt:K.project.updatedAt,furnitureCount:((I=K.project.stats)==null?void 0:I.furnitureCount)||0,spaceSize:{width:((S=K.project.spaceConfig)==null?void 0:S.width)||3600,height:((F=K.project.spaceConfig)==null?void 0:F.height)||2400,depth:((B=K.project.spaceConfig)==null?void 0:B.depth)||1500},thumbnail:K.project.thumbnail,folderId:K.project.folderId,spaceInfo:K.project.spaceConfig||{width:3600,height:2400,depth:1500,installType:"builtin",surroundType:"surround",baseConfig:{type:"floor",height:65,placementType:"ground"},hasFloorFinish:!1,floorFinish:null,wallConfig:{left:!0,right:!0,top:!0},materialConfig:{interiorColor:"#FFFFFF",doorColor:"#E0E0E0"},columns:[],frameSize:{upper:50,left:50,right:50},gapConfig:{left:2,right:2}},placedModules:((E=K.project.furniture)==null?void 0:E.placedModules)||[]};console.log("프로젝트 뷰어 데이터 로드:",{title:P.title,placedModulesCount:((V=P.placedModules)==null?void 0:V.length)||0,placedModulesData:P.placedModules,spaceInfo:!!P.spaceInfo,fullProjectData:K.project}),o(P)}else u(K.error||"프로젝트를 찾을 수 없습니다.")}}catch(K){console.error("프로젝트 로드 실패:",K),u("프로젝트를 불러오는 중 오류가 발생했습니다.")}finally{c(!1)}},y=()=>{f(!1),e()},v=()=>{f(!d)};return n?l.jsx(Cv,{children:l.jsx(Xi.div,{className:`${Vs.modalOverlay} ${d?Vs.fullscreen:""}`,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:y,children:l.jsxs(Xi.div,{className:`${Vs.modalContent} ${d?Vs.fullscreenContent:""}`,initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},onClick:w=>w.stopPropagation(),children:[l.jsxs("div",{className:Vs.modalHeader,children:[l.jsxs("div",{className:Vs.headerLeft,children:[l.jsx("h2",{className:Vs.modalTitle,children:a?"프로젝트 로딩 중...":s?s.title:"프로젝트를 찾을 수 없음"}),s&&l.jsxs("span",{className:Vs.projectInfo,children:[A," 미리보기"]})]}),l.jsx("div",{className:Vs.headerCenter,children:l.jsxs("div",{className:Vs.viewModeToggle,children:[l.jsx("button",{className:`${Vs.viewModeButton} ${A==="2D"?Vs.active:""}`,onClick:()=>g("2D"),children:"2D"}),l.jsx("button",{className:`${Vs.viewModeButton} ${A==="3D"?Vs.active:""}`,onClick:()=>g("3D"),children:"3D"})]})}),l.jsxs("div",{className:Vs.headerActions,children:[l.jsx("button",{className:Vs.actionButton,onClick:v,title:d?"창 모드":"전체화면",children:d?l.jsx(k$,{size:20}):l.jsx(E$,{size:20})}),l.jsx("button",{className:Vs.closeButton,onClick:y,title:"닫기",children:l.jsx(Nhe,{size:20})})]})]}),l.jsxs("div",{className:Vs.modalBody,children:[a&&l.jsxs("div",{className:Vs.loadingState,children:[l.jsx("div",{className:Vs.spinner}),l.jsx("p",{children:"프로젝트를 불러오는 중..."})]}),h&&l.jsxs("div",{className:Vs.errorState,children:[l.jsx("p",{className:Vs.errorMessage,children:h}),l.jsx("button",{onClick:p,className:Vs.retryButton,children:"다시 시도"})]}),s&&!a&&!h&&l.jsxs("div",{className:Vs.viewerContainer,children:[console.log("🎨 읽기 전용 뷰어 렌더링:",{projectId:t,viewMode:A,hasProject:!!s,hasSpaceInfo:!!s.spaceInfo,spaceInfo:s.spaceInfo,placedModulesCount:((m=s.placedModules)==null?void 0:m.length)||0}),l.jsx(Bq,{spaceConfig:s.spaceInfo,placedModules:s.placedModules||[],viewMode:A,renderMode:"solid"},`${t}-${A}`)]})]}),s&&!a&&!h&&l.jsxs("div",{className:Vs.modalFooter,children:[l.jsx("div",{className:Vs.projectMeta,children:l.jsxs("span",{children:["마지막 수정: ",(()=>{if(s.updatedAt)try{const w=s.updatedAt.seconds?new Date(s.updatedAt.seconds*1e3):new Date(s.updatedAt),T=Math.floor((new Date().getTime()-w.getTime())/(1e3*60*60));return T<1?"방금 전":T<24?`${T}시간 전`:T<168?`${Math.floor(T/24)}일 전`:w.toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})}catch(w){return console.error("날짜 변환 오류:",w),"알 수 없음"}if(s.createdAt)try{return(s.createdAt.seconds?new Date(s.createdAt.seconds*1e3):new Date(s.createdAt)).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})}catch(w){console.error("생성일 변환 오류:",w)}return"알 수 없음"})()]})}),l.jsx("button",{className:Vs.shareButton,onClick:()=>{const w=i||t,x=`${window.location.origin}/viewer/${w}`;navigator.clipboard.writeText(x).then(()=>{alert(`공유 링크가 클립보드에 복사되었습니다!
${x}`)}).catch(()=>{prompt("공유 링크를 복사하세요:",x)})},children:"공유하기"})]})]})})}):null};async function rR(n){var e,t,i,r,s,o,a;try{const c=document.createElement("canvas"),h=c.getContext("2d");if(!h)return console.error("Canvas 컨텍스트를 생성할 수 없습니다"),null;const u=400;if(c.width=u,c.height=u,h.fillStyle="#f9fafb",h.fillRect(0,0,u,u),n.spaceInfo||n.spaceSize){const f=((e=n.spaceInfo)==null?void 0:e.width)||((t=n.spaceSize)==null?void 0:t.width)||4e3,A=((i=n.spaceInfo)==null?void 0:i.depth)||((r=n.spaceSize)==null?void 0:r.depth)||3e3,g=((s=n.spaceInfo)==null?void 0:s.height)||((o=n.spaceSize)==null?void 0:o.height)||2400,y=u-40*2,v=Math.min(y/f,y/A),m=f*v,w=A*v,x=(u-m)/2,T=(u-w)/2;h.fillStyle="#e5e7eb",h.fillRect(x,T,m,w),h.strokeStyle="#d1d5db",h.lineWidth=.5;const j=500*v;for(let D=T;D<=T+w;D+=j)h.beginPath(),h.moveTo(x,D),h.lineTo(x+m,D),h.stroke();for(let D=x;D<=x+m;D+=j)h.beginPath(),h.moveTo(D,T),h.lineTo(D,T+w),h.stroke();if(h.strokeStyle="#6b7280",h.lineWidth=2,h.strokeRect(x,T,m,w),n.placedModules&&n.placedModules.length>0?(console.log(`🪑 ${n.placedModules.length}개의 가구를 썸네일에 렌더링합니다`),n.placedModules.forEach(D=>{var b,_;try{const I=(((b=D.position)==null?void 0:b.x)||0)*v+x,S=(((_=D.position)==null?void 0:_.z)||0)*v+T,F=(D.width||600)*v,B=(D.depth||600)*v;h.fillStyle="rgba(0, 0, 0, 0.1)",h.fillRect(I+2,S+2,F,B);const E=Q7e(D.type||D.moduleType);h.fillStyle=E,h.fillRect(I,S,F,B),h.strokeStyle="rgba(0, 0, 0, 0.3)",h.lineWidth=1,h.strokeRect(I,S,F,B);const V=h.createLinearGradient(I,S,I,S+B);V.addColorStop(0,"rgba(255, 255, 255, 0.3)"),V.addColorStop(1,"rgba(255, 255, 255, 0)"),h.fillStyle=V,h.fillRect(I,S,F,B*.3)}catch(I){console.error("가구 렌더링 오류:",I,D)}})):(h.fillStyle="#9ca3af",h.font="14px sans-serif",h.textAlign="center",h.textBaseline="middle",h.fillText("빈 공간",u/2,u/2)),n.furnitureCount&&n.furnitureCount>0){h.fillStyle="rgba(16, 185, 129, 0.9)";const D=60,b=24,_=u-D-10,I=10;h.beginPath(),h.roundRect(_,I,D,b,12),h.fill(),h.fillStyle="white",h.font="bold 12px sans-serif",h.textAlign="center",h.textBaseline="middle",h.fillText(`${n.furnitureCount}개`,_+D/2,I+b/2)}}else h.fillStyle="#10b981",h.fillRect(0,0,u,u),h.fillStyle="white",h.font="bold 24px sans-serif",h.textAlign="center",h.textBaseline="middle",h.fillText("디자인",u/2,u/2);const d=c.toDataURL("image/png",.8);return console.log("✅ 썸네일 생성 완료:",{width:c.width,height:c.height,furnitureCount:((a=n.placedModules)==null?void 0:a.length)||0}),d}catch(c){return console.error("썸네일 생성 오류:",c),null}}function Q7e(n){const e={wardrobe:"#8b5cf6",shelf:"#3b82f6",drawer:"#f59e0b",desk:"#84cc16",chair:"#ec4899",bed:"#06b6d4",sofa:"#f97316",table:"#6366f1",cabinet:"#10b981",bookshelf:"#0891b2",storage:"#7c3aed",closet:"#dc2626",dresser:"#ca8a04",mirror:"#0284c7",default:"#6b7280"},t=(n==null?void 0:n.toLowerCase())||"default";for(const[i,r]of Object.entries(e))if(t.includes(i))return r;return e.default}typeof CanvasRenderingContext2D<"u"&&!CanvasRenderingContext2D.prototype.roundRect&&(CanvasRenderingContext2D.prototype.roundRect=function(n,e,t,i,r){t<2*r&&(r=t/2),i<2*r&&(r=i/2),this.beginPath(),this.moveTo(n+r,e),this.arcTo(n+t,e,n+t,e+i,r),this.arcTo(n+t,e+i,n,e+i,r),this.arcTo(n,e+i,n,e,r),this.arcTo(n,e,n+t,e,r),this.closePath()});const $7e=()=>{if(typeof document<"u"&&!document.querySelector("#thumbnail-spin-animation")){const n=document.createElement("style");n.id="thumbnail-spin-animation",n.innerHTML=`
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
    `,document.head.appendChild(n)}};typeof window<"u"&&$7e();const sR=({project:n,designFile:e,className:t="",alt:i="프로젝트 썸네일"})=>{var u;const[r,s]=O.useState(""),[o,a]=O.useState(!0),[c,h]=O.useState(!1);return O.useEffect(()=>{let d=!0;return(async()=>{var A,g;try{if(a(!0),h(!1),e&&e.spaceConfig&&e.furniture){if(console.log("🎨 디자인 파일 썸네일 생성 시작:",{hasSpaceConfig:!!e.spaceConfig,hasFurniture:!!e.furniture,furnitureCount:((g=(A=e.furniture)==null?void 0:A.placedModules)==null?void 0:g.length)||0,hasThumbnail:!!e.thumbnail,spaceConfigData:e.spaceConfig,furnitureData:e.furniture}),e.thumbnail){console.log("💾 저장된 디자인 썸네일 사용"),s(e.thumbnail),a(!1);return}const w={...n,spaceInfo:{width:e.spaceConfig.width,height:e.spaceConfig.height,depth:e.spaceConfig.depth,columns:e.spaceConfig.columns||[]},placedModules:e.furniture.placedModules||[]};console.log("🔧 디자인 전용 ProjectSummary 생성:",w);const x=await rR(w);console.log("📸 디자인 썸네일 생성 완료:",{success:!!x,thumbnailLength:(x==null?void 0:x.length)||0,isDataUrl:(x==null?void 0:x.startsWith("data:"))||!1}),d&&(!x||x.length===0?(console.warn("⚠️ 썸네일 생성 실패, fallback 사용"),h(!0)):s(x),a(!1));return}const p=n.updatedAt&&new Date(n.updatedAt.seconds*1e3).getTime()>Date.now()-3e5,y=n.placedModules&&n.placedModules.length>0,v=!n.thumbnail||p&&y;if(n.thumbnail&&!v){s(n.thumbnail),a(!1);return}const m=await rR(n);d&&(s(m),a(!1))}catch(p){console.error("썸네일 로드 실패:",p),d&&(h(!0),a(!1))}})(),()=>{d=!1}},[n.id,n.thumbnail,n.updatedAt,(u=n.placedModules)==null?void 0:u.length,e==null?void 0:e.thumbnail,e==null?void 0:e.updatedAt,e==null?void 0:e.spaceConfig,e==null?void 0:e.furniture]),o?l.jsx("div",{className:`${t} thumbnail-loading`,style:{display:"flex",alignItems:"center",justifyContent:"center",background:"#f3f4f6",color:"#6b7280"},children:l.jsx("div",{style:{width:"20px",height:"20px",border:"2px solid #e5e7eb",borderTop:"2px solid #10b981",borderRadius:"50%",animation:"spin 1s linear infinite"}})}):c||!r?l.jsx("div",{className:`${t} thumbnail-fallback`,style:{display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #10b981, #059669)",color:"white",fontSize:"12px",fontWeight:"600"},children:"디자인"}):l.jsx("img",{src:r,alt:i,className:t,style:{width:"100%",height:"100%",objectFit:"cover"},onError:()=>h(!0)})},V7e="_dashboard_sw8by_1",z7e="_sidebar_sw8by_48",G7e="_logoSection_sw8by_62",X7e="_logo_sw8by_62",K7e="_profileSection_sw8by_121",q7e="_userInfo_sw8by_130",Y7e="_userAvatar_sw8by_137",Z7e="_userDetails_sw8by_150",J7e="_userName_sw8by_154",e9e="_userEmail_sw8by_161",t9e="_createProjectSection_sw8by_167",n9e="_createProjectBtn_sw8by_171",i9e="_navSection_sw8by_193",r9e="_navItem_sw8by_199",s9e="_active_sw8by_241",o9e="_navItemIcon_sw8by_253",a9e="_navItemCount_sw8by_265",l9e="_settingsSection_sw8by_287",c9e="_settingsItem_sw8by_293",h9e="_main_sw8by_311",u9e="_header_sw8by_326",d9e="_headerRight_sw8by_353",A9e="_headerActions_sw8by_362",f9e="_userProfile_sw8by_374",p9e="_actionButton_sw8by_386",g9e="_userProfileAvatar_sw8by_396",m9e="_userProfileName_sw8by_406",y9e="_headerLeft_sw8by_416",v9e="_breadcrumb_sw8by_422",w9e="_breadcrumbItem_sw8by_431",x9e="_breadcrumbSeparator_sw8by_454",b9e="_searchContainer_sw8by_459",_9e="_searchInput_sw8by_465",C9e="_searchIcon_sw8by_482",S9e="_content_sw8by_565",T9e="_projectTree_sw8by_578",B9e="_collapsed_sw8by_595",E9e="_treeHeader_sw8by_601",k9e="_treeToggleButton_sw8by_612",I9e="_toggleIcon_sw8by_637",F9e="_designArea_sw8by_679",D9e="_projectSelectorContainer_sw8by_690",j9e="_treeContent_sw8by_691",P9e="_dropdownArrow_sw8by_720",N9e="_folderDropdown_sw8by_731",L9e="_expanded_sw8by_742",M9e="_treeItem_sw8by_753",R9e="_treeItemIcon_sw8by_776",O9e="_treeToggleArrow_sw8by_785",U9e="_projectChildren_sw8by_804",H9e="_treeItemCount_sw8by_811",W9e="_createFolderBtn_sw8by_822",Q9e="_createFolderIcon_sw8by_844",$9e="_treeItemActions_sw8by_866",V9e="_treeItemActionBtn_sw8by_872",z9e="_designIcon_sw8by_894",G9e="_designGrid_sw8by_914",X9e="_folderView_sw8by_914",K9e="_listView_sw8by_914",q9e="_designCard_sw8by_914",Y9e="_folderCard_sw8by_914",Z9e="_folderIcon_sw8by_935",J9e="_folderIconSvg_sw8by_951",eRe="_folderDropZone_sw8by_976",tRe="_dragOver_sw8by_981",nRe="_folderChildren_sw8by_987",iRe="_childItem_sw8by_994",rRe="_cardCheckbox_sw8by_1017",sRe="_designCardOverlay_sw8by_1086",oRe="_newDesign_sw8by_1108",aRe="_forceHover_sw8by_1109",lRe="_overlayButton_sw8by_1121",cRe="_primary_sw8by_1145",hRe="_moreMenu_sw8by_1155",uRe="_moreMenuBackdrop_sw8by_1168",dRe="_moreMenuItem_sw8by_1178",ARe="_deleteItem_sw8by_1198",fRe="_pageTitle_sw8by_1236",pRe="_listTableHeader_sw8by_1289",gRe="_headerColumn_sw8by_1303",mRe="_cardInfo_sw8by_1372",yRe="_cardThumbnail_sw8by_1379",vRe="_cardTitle_sw8by_1391",wRe="_cardMeta_sw8by_1412",xRe="_listActionButtons_sw8by_1450",bRe="_listActionBtn_sw8by_1458",_Re="_cardDate_sw8by_1487",CRe="_cardFooter_sw8by_1494",SRe="_cardUser_sw8by_1502",TRe="_cardActionButton_sw8by_1510",BRe="_designThumbnail_sw8by_1593",ERe="_designThumbnailImage_sw8by_1599",kRe="_cardThumbnailContent_sw8by_1667",IRe="_cardThumbnailIcon_sw8by_1676",FRe="_cardThumbnailText_sw8by_1689",DRe="_thumbnailGrid_sw8by_1781",jRe="_thumbnailFolder_sw8by_1799",PRe="_thumbnailFile_sw8by_1800",NRe="_fileIconWrapper_sw8by_1804",LRe="_fileIcon_sw8by_1804",MRe="_thumbnailItem_sw8by_1813",RRe="_thumbnailImage_sw8by_1823",ORe="_thumbnailEmpty_sw8by_1869",URe="_emptyThumbnailState_sw8by_1879",HRe="_emptyThumbnailIcon_sw8by_1892",WRe="_emptyThumbnailText_sw8by_1898",QRe="_cardUserAvatar_sw8by_2091",$Re="_cardUserName_sw8by_2103",VRe="_cardBadge_sw8by_2109",zRe="_emptyState_sw8by_2119",GRe="_emptyStateTitle_sw8by_2136",XRe="_emptyStateSubtitle_sw8by_2143",KRe="_emptyStateButton_sw8by_2149",qRe="_modalOverlay_sw8by_2165",YRe="_modal_sw8by_2165",ZRe="_modalTitle_sw8by_2188",JRe="_modalInput_sw8by_2196",eOe="_modalActions_sw8by_2214",tOe="_modalCancelBtn_sw8by_2221",nOe="_modalCreateBtn_sw8by_2222",iOe="_contextMenu_sw8by_2262",rOe="_contextMenuItem_sw8by_2273",sOe="_teamModalContent_sw8by_2401",oOe="_teamList_sw8by_2406",aOe="_teamEmpty_sw8by_2412",lOe="_createTeamBtn_sw8by_2427",cOe="_subHeader_sw8by_2524",hOe="_subHeaderContent_sw8by_2533",uOe="_subHeaderLeft_sw8by_2544",dOe="_subHeaderTitle_sw8by_2550",AOe="_selectionInfo_sw8by_2565",fOe="_clearSelectionBtn_sw8by_2581",pOe="_subHeaderActions_sw8by_2598",gOe="_viewToggleGroup_sw8by_2607",mOe="_viewToggleButton_sw8by_2615",yOe="_sortButton_sw8by_2645",vOe="_sortDropdownMenu_sw8by_2670",wOe="_sortOption_sw8by_2695",xOe="_emptyTrashBtn_sw8by_2728",bOe="_createDesignBtn_sw8by_2751",_Oe="_bulkDeleteButton_sw8by_2773",st={dashboard:V7e,sidebar:z7e,logoSection:G7e,logo:X7e,profileSection:K7e,userInfo:q7e,userAvatar:Y7e,userDetails:Z7e,userName:J7e,userEmail:e9e,createProjectSection:t9e,createProjectBtn:n9e,navSection:i9e,navItem:r9e,active:s9e,navItemIcon:o9e,navItemCount:a9e,settingsSection:l9e,settingsItem:c9e,main:h9e,header:u9e,headerRight:d9e,headerActions:A9e,userProfile:f9e,actionButton:p9e,userProfileAvatar:g9e,userProfileName:m9e,headerLeft:y9e,breadcrumb:v9e,breadcrumbItem:w9e,breadcrumbSeparator:x9e,searchContainer:b9e,searchInput:_9e,searchIcon:C9e,content:S9e,projectTree:T9e,collapsed:B9e,treeHeader:E9e,treeToggleButton:k9e,toggleIcon:I9e,designArea:F9e,projectSelectorContainer:D9e,treeContent:j9e,dropdownArrow:P9e,folderDropdown:N9e,expanded:L9e,treeItem:M9e,treeItemIcon:R9e,treeToggleArrow:O9e,projectChildren:U9e,treeItemCount:H9e,createFolderBtn:W9e,createFolderIcon:Q9e,treeItemActions:$9e,treeItemActionBtn:V9e,designIcon:z9e,designGrid:G9e,folderView:X9e,listView:K9e,designCard:q9e,folderCard:Y9e,folderIcon:Z9e,folderIconSvg:J9e,folderDropZone:eRe,dragOver:tRe,folderChildren:nRe,childItem:iRe,cardCheckbox:rRe,designCardOverlay:sRe,newDesign:oRe,forceHover:aRe,overlayButton:lRe,primary:cRe,moreMenu:hRe,moreMenuBackdrop:uRe,moreMenuItem:dRe,deleteItem:ARe,pageTitle:fRe,listTableHeader:pRe,headerColumn:gRe,cardInfo:mRe,cardThumbnail:yRe,cardTitle:vRe,cardMeta:wRe,listActionButtons:xRe,listActionBtn:bRe,cardDate:_Re,cardFooter:CRe,cardUser:SRe,cardActionButton:TRe,designThumbnail:BRe,designThumbnailImage:ERe,cardThumbnailContent:kRe,cardThumbnailIcon:IRe,cardThumbnailText:FRe,thumbnailGrid:DRe,thumbnailFolder:jRe,thumbnailFile:PRe,fileIconWrapper:NRe,fileIcon:LRe,thumbnailItem:MRe,thumbnailImage:RRe,thumbnailEmpty:ORe,emptyThumbnailState:URe,emptyThumbnailIcon:HRe,emptyThumbnailText:WRe,cardUserAvatar:QRe,cardUserName:$Re,cardBadge:VRe,emptyState:zRe,emptyStateTitle:GRe,emptyStateSubtitle:XRe,emptyStateButton:KRe,modalOverlay:qRe,modal:YRe,modalTitle:ZRe,modalInput:JRe,modalActions:eOe,modalCancelBtn:tOe,modalCreateBtn:nOe,contextMenu:iOe,contextMenuItem:rOe,teamModalContent:sOe,teamList:oOe,teamEmpty:aOe,createTeamBtn:lOe,subHeader:cOe,subHeaderContent:hOe,subHeaderLeft:uOe,subHeaderTitle:dOe,selectionInfo:AOe,clearSelectionBtn:fOe,subHeaderActions:pOe,viewToggleGroup:gOe,viewToggleButton:mOe,sortButton:yOe,sortDropdownMenu:vOe,sortOption:wOe,emptyTrashBtn:xOe,createDesignBtn:bOe,bulkDeleteButton:_Oe},COe=({size:n=16})=>l.jsxs("svg",{width:n,height:n,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[l.jsx("rect",{x:"3",y:"4",width:"14",height:"12",rx:"2",stroke:"#6b7280",strokeWidth:"1.5",fill:"none"}),l.jsx("rect",{x:"6",y:"7",width:"8",height:"2",rx:"1",fill:"#6b7280"}),l.jsx("rect",{x:"6",y:"11",width:"5",height:"1.5",rx:"0.75",fill:"#6b7280"})]}),SOe=()=>{var nt,gt;const n=xc(),e=VC(),{user:t}=ec();if(O.useEffect(()=>{t||(console.log("🔒 사용자가 로그인되지 않음 - 로그인 페이지로 리다이렉트"),n("/auth",{replace:!0}))},[t,n]),!t)return null;const r=new URLSearchParams(e.search).get("projectId"),[s,o]=O.useState("grid");O.useEffect(()=>{const{markAsSaved:Ae}=Ha.getState(),{markAsSaved:me}=qi.getState(),{markAsSaved:Xe}=ci.getState();Ae(),me(),Xe()},[]),O.useEffect(()=>{const Ae=Ge();Ie(Ae)},[e.pathname]);const[a,c]=O.useState("date"),[h,u]=O.useState(!1),[d,f]=O.useState(!1),[A,g]=O.useState(!1),[p,y]=O.useState([]),[v,m]=O.useState(!0),[w,x]=O.useState(null),[T,j]=O.useState({}),[D,b]=O.useState(new Set),[_,I]=O.useState(null),[S,F]=O.useState(new Set),[B,E]=O.useState(["전체 프로젝트"]),[V,K]=O.useState(null),[P,M]=O.useState({}),[X,Z]=O.useState({isDragging:!1,draggedItem:null,dragOverFolder:null}),[Q,U]=O.useState(null),[z,q]=O.useState(!1),[G,ie]=O.useState(""),[H,se]=O.useState(!1),[te,fe]=O.useState(null),[ye,be]=O.useState(!1),[_e,W]=O.useState(""),[Y,ve]=O.useState(!1),[ce,ne]=O.useState(!1),[he,xe]=O.useState(null),[Te,Ce]=O.useState(null),[Be,Ye]=O.useState({isOpen:!1,projectId:"",designFileId:void 0}),[$e,ot]=O.useState(!1),[rt,Ve]=O.useState(!1),[We,De]=O.useState(!1),Ge=()=>{const Ae=e.pathname.replace("/dashboard","");return Ae===""||Ae==="/"?"all":Ae.substring(1)},[Re,Ie]=O.useState(Ge()),[Le,et]=O.useState(new Set),[ct,mt]=O.useState(new Set),[je,le]=O.useState(new Set),[Je,ht]=O.useState([]),[ut,ft]=O.useState([]),[jt,Wt]=O.useState(!1),[Mt,dn]=O.useState(new Set),[on,Et]=O.useState(new Map),[an,Mn]=O.useState(new Map),[At,zt]=O.useState({}),Zt=O.useCallback(()=>{console.log("🧹 로컬 스토리지 데모 프로젝트 정리 시작");const Ae=Object.keys(localStorage);let me=0;Ae.forEach(Xe=>{(Xe.includes("demo")||Xe.includes("Demo")||Xe.includes("demoProject"))&&(console.log("삭제:",Xe),localStorage.removeItem(Xe),me++)}),console.log(`🧹 총 ${me}개의 데모 프로젝트 관련 항목 삭제됨`)},[]),$t=O.useCallback(async(Ae=0)=>{if(!t){console.log("사용자가 로그인되지 않았습니다."),m(!1);return}console.log(`🔄 프로젝트 로드 시도 ${Ae+1}/3 - 사용자: ${t.email}`),Ae===0&&m(!0),x(null);try{const{projects:me,error:Xe}=await dI();if(Xe){if(Ae<2){console.log("⚠️ 프로젝트 로드 실패, 1초 후 재시도..."),setTimeout(()=>{$t(Ae+1)},1e3);return}x(Xe),console.error("Firebase 프로젝트 로드 최종 실패:",Xe),m(!1)}else y(me),console.log("✅ Firebase 프로젝트 로드 성공:",me.length,"개"),m(!1)}catch(me){if(Ae<2){console.log("⚠️ 프로젝트 로드 예외 발생, 1초 후 재시도..."),setTimeout(()=>{$t(Ae+1)},1e3);return}x("프로젝트 목록을 가져오는 중 오류가 발생했습니다."),console.error("Firebase 프로젝트 로드 최종 실패:",me),m(!1)}},[t]),Ht=O.useCallback(async Ae=>{if(t)try{const{folders:me,error:Xe}=await AI(Ae);Xe?console.error("폴더 데이터 불러오기 에러:",Xe):M(qe=>({...qe,[Ae]:me}))}catch(me){console.error("폴더 데이터 불러오기 중 오류:",me)}},[t]),Lt=O.useCallback(async Ae=>{if(t){console.log("🚀 디자인 파일 로딩 시작:",{projectId:Ae,userId:t.uid}),j(me=>({...me,[Ae]:!0}));try{const{designFiles:me,error:Xe}=await _5(Ae);Xe?console.error("❌ 디자인 파일 불러오기 에러:",Xe):(console.log("✅ 불러온 디자인 파일들:",{projectId:Ae,designFiles:me,designFilesCount:(me==null?void 0:me.length)||0,timestamp:new Date().toISOString()}),zt(qe=>({...qe,[Ae]:me})))}catch(me){console.error("❌ 디자인 파일 불러오기 중 오류:",me)}finally{j(me=>({...me,[Ae]:!1}))}}},[t]),dt=O.useCallback(async(Ae,me)=>{if(t)try{const{error:Xe}=await xy(Ae,me);Xe&&console.error("폴더 데이터 저장 에러:",Xe)}catch(Xe){console.error("폴더 데이터 저장 중 오류:",Xe)}},[t]);O.useEffect(()=>{Zt(),t?(console.log("🔥 사용자 로그인 감지, 프로젝트 로딩 시작:",t.email),setTimeout(()=>{$t()},500)):console.log("⚠️ 사용자 없음, 프로젝트 로딩 건너뜀")},[t,$t]),O.useEffect(()=>{p.length>0&&t&&(console.log("🔥 프로젝트 목록 로드 완료, 각 프로젝트의 디자인 파일 로딩 시작"),p.forEach(Ae=>{!At[Ae.id]&&!T[Ae.id]&&(console.log(`📁 프로젝트 ${Ae.title}의 디자인 파일 로딩`),Lt(Ae.id))}))},[p,t,Lt]),O.useEffect(()=>{const Ae=sessionStorage.getItem("pendingProjectSelect");Ae&&p.length>0&&p.some(Xe=>Xe.id===Ae)&&(console.log("대기 중인 프로젝트 선택:",Ae),Li(Ae),sessionStorage.removeItem("pendingProjectSelect"))},[p]),O.useEffect(()=>{if(_&&p.length>0){const Ae=p.find(me=>me.id===_);Ae&&B[1]==="로딩 중..."&&E(["전체 프로젝트",Ae.title])}},[_,p,B,At]),O.useEffect(()=>{const Ae=()=>{t&&(console.log("🔄 윈도우 포커스 - 프로젝트 데이터 새로고침"),$t(),_&&(console.log("🔄 윈도우 포커스 - 디자인 파일 새로고침:",_),Lt(_)))};return window.addEventListener("focus",Ae),()=>{window.removeEventListener("focus",Ae)}},[t,_,Lt]),O.useEffect(()=>{if(r&&p.length>0){if(p.some(me=>me.id===r)&&_!==r){console.log("🔗 URL에서 프로젝트 ID 감지, 자동 선택:",r),I(r);const me=p.find(Xe=>Xe.id===r);me&&(E(["전체 프로젝트",me.title]),Ht(r),Lt(r))}}else!r&&_&&(console.log("🔗 URL에 projectId가 없음, 전체 프로젝트로 돌아가기"),I(null),E(["전체 프로젝트"]))},[r,p,_]),O.useEffect(()=>{const Ae=Ge();Ae!==Re&&Ie(Ae)},[e.pathname]),O.useEffect(()=>{Wt(Re!=="all")},[Re]),O.useEffect(()=>{const Ae=new BroadcastChannel("project-updates"),me=Xe=>{console.log("📡 프로젝트 업데이트 알림 수신:",Xe.data),(Xe.data.type==="PROJECT_SAVED"||Xe.data.type==="PROJECT_CREATED"||Xe.data.type==="DESIGN_FILE_UPDATED")&&(console.log("🔄 프로젝트 목록 새로고침 중..."),$t(),Xe.data.type==="DESIGN_FILE_UPDATED"&&Xe.data.projectId?(console.log("🔄 디자인 파일 새로고침:",Xe.data.projectId),Lt(Xe.data.projectId)):_&&(console.log("🔄 선택된 프로젝트의 디자인 파일 새로고침:",_),Lt(_)))};return Ae.addEventListener("message",me),()=>{Ae.removeEventListener("message",me),Ae.close()}},[_,Lt]),O.useEffect(()=>{if(t){const Ae=localStorage.getItem(`bookmarks_${t.uid}`);Ae&&et(new Set(JSON.parse(Ae)));const me=localStorage.getItem(`design_bookmarks_${t.uid}`);me&&mt(new Set(JSON.parse(me)));const Xe=localStorage.getItem(`folder_bookmarks_${t.uid}`);Xe&&le(new Set(JSON.parse(Xe)));const qe=localStorage.getItem(`trash_${t.uid}`);qe&&ft(JSON.parse(qe))}},[t]);const at=t?p:[],Ot=O.useMemo(()=>{if(!_)return null;const Ae=at.find(me=>me.id===_);return console.log("🔍 selectedProject 업데이트:",{selectedProjectId:_,found:!!Ae,allProjectsCount:at.length}),Ae||null},[_,at]);console.log("🔍 현재 상태 확인:",{user:!!t,userEmail:t==null?void 0:t.email,firebaseProjectsCount:p.length,allProjectsCount:at.length,selectedProjectId:_,selectedProject:Ot==null?void 0:Ot.title,activeMenu:Re,loading:v}),O.useEffect(()=>{Ot&&B[1]==="로딩 중..."&&(console.log("📝 Breadcrumb 업데이트:",Ot.title),E(["전체 프로젝트",Ot.title]))},[Ot,B]);const Cn=Ae=>{const me=new Set(Le);me.has(Ae)?me.delete(Ae):(me.add(Ae),n("/dashboard/bookmarks")),et(me),t&&localStorage.setItem(`bookmarks_${t.uid}`,JSON.stringify(Array.from(me)))},Rn=Ae=>{const me=new Set(ct);me.has(Ae)?me.delete(Ae):(me.add(Ae),Ie("bookmarks")),mt(me),t&&localStorage.setItem(`design_bookmarks_${t.uid}`,JSON.stringify(Array.from(me)))},xn=Ae=>{const me=new Set(je);me.has(Ae)?me.delete(Ae):(me.add(Ae),Ie("bookmarks")),le(me),t&&localStorage.setItem(`folder_bookmarks_${t.uid}`,JSON.stringify(Array.from(me)))},En=async Ae=>{try{const{error:me}=await zB(Ae.id);if(me){alert("프로젝트 삭제 실패: "+me);return}await $t();const Xe={...Ae,deletedAt:new Date().toISOString()};if(ft(qe=>[...qe,Xe]),t){const qe=[...ut,Xe];localStorage.setItem(`trash_${t.uid}`,JSON.stringify(qe))}Le.has(Ae.id)&&Cn(Ae.id);try{const qe=new BroadcastChannel("project-updates");qe.postMessage({type:"PROJECT_DELETED",projectId:Ae.id}),qe.close()}catch(qe){console.warn("BroadcastChannel 전송 실패 (무시 가능):",qe)}console.log("✅ 프로젝트 삭제 완료:",Ae.id)}catch(me){console.error("프로젝트 삭제 중 오류:",me),alert("프로젝트 삭제 중 오류가 발생했습니다.")}},Hn=Ae=>{const me=ut.find(Xe=>Xe.id===Ae);if(me){const Xe=ut.filter(An=>An.id!==Ae);ft(Xe);const{deletedAt:qe,...nn}=me;y(An=>[...An,nn]),t&&localStorage.setItem(`trash_${t.uid}`,JSON.stringify(Xe))}},Kn=()=>{window.confirm("휴지통을 비우시겠습니까? 이 작업은 되돌릴 수 없습니다.")&&(ft([]),t&&localStorage.removeItem(`trash_${t.uid}`))},Ti=async Ae=>{try{const me=`${window.location.origin}/configurator?projectId=${Ae}&shared=true`;navigator.clipboard?(await navigator.clipboard.writeText(me),alert("공유 링크가 클립보드에 복사되었습니다!")):prompt("공유 링크를 복사하세요:",me)}catch(me){console.error("프로젝트 공유 중 오류:",me),alert("프로젝트 공유 중 오류가 발생했습니다.")}},ti=()=>{const Ae=new Set(ut.map(me=>me.id));switch(Re){case"bookmarks":return at.filter(me=>Le.has(me.id)&&!Ae.has(me.id));case"shared":return Je.filter(me=>!Ae.has(me.id));case"trash":return ut;case"all":default:return at.filter(me=>!Ae.has(me.id))}},ai=()=>{const Ae=[];return at.forEach(me=>{(At[me.id]||[]).forEach(qe=>{ct.has(qe.id)&&Ae.push({id:qe.id,type:"design",name:qe.name,project:me,designFile:qe})})}),Ae},Gi=()=>{const Ae=[];return at.forEach(me=>{(P[me.id]||[]).forEach(qe=>{je.has(qe.id)&&Ae.push({id:qe.id,type:"folder",name:qe.name,project:me,children:qe.children})})}),Ae},fi=O.useCallback(Ae=>{const me=at.find(fn=>fn.id===Ae);if(!me)return console.log("❌ getProjectItems: 프로젝트를 찾을 수 없습니다:",Ae,"allProjects:",at.length),[];const Xe=P[Ae]||[],qe=[];Xe.forEach(fn=>{qe.push({id:fn.id,type:"folder",name:fn.name,project:me})}),Xe.forEach(fn=>{fn.children.forEach(Qt=>{qe.push({id:Qt.id,type:"design",name:Qt.name,project:me})})});const nn=Xe.flatMap(fn=>fn.children),An=new Set(nn.map(fn=>fn.id)),Ct=T[Ae]||!1,kn=At[Ae]||[];return console.log("🔥 getProjectItems - 디자인 파일 상태 확인:",{projectId:Ae,projectTitle:me.title,isDesignFilesLoading:Ct,projectDesignFilesKeys:Object.keys(At),hasDesignFilesForProject:!!At[Ae],actualDesignFiles:kn,actualDesignFilesCount:kn.length,projectFurnitureCount:me.furnitureCount,timestamp:new Date().toISOString()}),Ct&&kn.length===0?qe.push({id:"loading",type:"loading",name:"디자인 파일 로딩 중...",project:me}):kn.forEach(fn=>{An.has(fn.id)||(console.log("📁 루트 레벨 디자인 파일 추가:",fn.name),qe.push({id:fn.id,type:"design",name:fn.name,project:me,designFile:fn}))}),qe},[at,P,At,T]),Oi=()=>{if(console.log("🔍 getDisplayedItems 호출:",{selectedProjectId:_,currentFolderId:V,viewMode:s,activeMenu:Re,allProjectsCount:at.length,allProjects:at.map(me=>({id:me.id,title:me.title}))}),_){if(!Ot)return console.log("❌ 선택된 프로젝트를 찾을 수 없습니다:",_),console.log("현재 allProjects:",at.map(Ct=>({id:Ct.id,title:Ct.title}))),console.log("firebaseProjects:",p.map(Ct=>({id:Ct.id,title:Ct.title}))),[];console.log("✅ 선택된 프로젝트 찾음:",Ot.title);const me=P[_]||[];if(V){const Ct=me.find(kn=>kn.id===V);if(Ct){const kn=[{id:"new-design",type:"new-design",name:"디자인 생성",project:Ot,icon:"+"}];return Ct.children.forEach(fn=>{kn.push({id:fn.id,type:"design",name:fn.name,project:Ot,icon:""})}),kn}}console.log("📁 프로젝트 루트 레벨 아이템 생성:",{currentFolderId:V,activeMenu:Re,selectedProjectId:_,"프로젝트 루트 레벨 조건":{"선택된 프로젝트 있음":!!_,"현재 폴더 없음":V===null,"프로젝트 메뉴":Re==="project"}});const Xe=[{id:"new-design",type:"new-design",name:"디자인 생성",project:Ot,icon:"+"}];console.log("✅ 디자인 생성 카드 추가됨:",Xe[0]),me.forEach(Ct=>{Xe.push({id:Ct.id,type:"folder",name:Ct.name,project:Ot,icon:"📁"})});const qe=me.flatMap(Ct=>Ct.children),nn=new Set(qe.map(Ct=>Ct.id)),An=At[_]||[];return console.log("🎨 디자인 파일 추가:",{projectId:_,actualDesignFilesCount:An.length,actualDesignFiles:An.map(Ct=>({id:Ct.id,name:Ct.name}))}),An.forEach(Ct=>{nn.has(Ct.id)||Xe.push({id:Ct.id,type:"design",name:Ct.name,project:Ot,designFile:Ct,icon:""})}),console.log("📊 최종 아이템 개수:",Xe.length),Xe}if(Re==="bookmarks"){const me=[],Xe=ti();Xe.forEach(An=>{me.push({id:An.id,type:"project",name:An.title,project:An,icon:""})});const qe=ai();me.push(...qe);const nn=Gi();return me.push(...nn),console.log("📋 북마크 뷰 - 전체 아이템:",{totalItems:me.length,projectsCount:Xe.length,designsCount:qe.length,foldersCount:nn.length}),me}const Ae=ti();return console.log("📋 전체 프로젝트 뷰 - 필터링된 프로젝트들:",{activeMenu:Re,allProjectsCount:at.length,filteredProjectsCount:Ae.length,filteredProjects:Ae.map(me=>({id:me.id,title:me.title}))}),Ae.map(me=>({id:me.id,type:"project",name:me.title,project:me,icon:""}))},rn=O.useMemo(()=>{var me;const Ae=Oi();return console.log("💡 displayedItems 계산 완료:",{itemsCount:Ae.length,selectedProjectId:_,projectDesignFilesKeys:Object.keys(At),hasDesignFiles:((me=At[_])==null?void 0:me.length)>0}),Ae},[_,at,Re,V,P,At]);console.log("💡 displayedItems 최종 결과:",rn);const $n=[...rn].sort((Ae,me)=>{var Xe,qe;if(a==="date"){const nn=((Xe=Ae.project)==null?void 0:Xe.lastModified)||new Date(0);return(((qe=me.project)==null?void 0:qe.lastModified)||new Date(0)).getTime()-nn.getTime()}else{const nn=Ae.name.toLowerCase(),An=me.name.toLowerCase();return nn.localeCompare(An,"ko")}}),Fn=(Ae,me)=>{console.log("🔥 handleOpenViewer 호출:",{projectId:Ae,designFileId:me}),Ye({isOpen:!0,projectId:Ae,designFileId:me})},pt=()=>{Ye({isOpen:!1,projectId:"",designFileId:void 0})},vt=Ae=>{var Xe;const me=$n.find(qe=>qe.id===Ae);if(me&&me.type==="design"){const qe=((Xe=me.designFile)==null?void 0:Xe.id)||(me.id.endsWith("-design")?void 0:me.id);Fn(me.project.id,qe)}},kt=Ae=>{o(Ae)},mn=Ae=>{c(Ae)},sn=(Ae,me)=>{dn(Xe=>{const qe=new Set(Xe);return me?qe.add(Ae):qe.delete(Ae),qe})},bn=Ae=>{const me=Ae.filter(qe=>qe.type!=="new-design").map(qe=>qe.id),Xe=me.every(qe=>Mt.has(qe));dn(Xe?new Set:new Set(me))};O.useEffect(()=>{const Ae=me=>{const Xe=me.target;!Xe.closest(`.${st.sortButton}`)&&!Xe.closest(`.${st.sortDropdownMenu}`)&&u(!1)};if(h)return document.addEventListener("click",Ae),()=>document.removeEventListener("click",Ae)},[h]);const Li=Ae=>{if(_===Ae)I(null),E(["전체 프로젝트"]),n("/dashboard");else{const me=at.find(Xe=>Xe.id===Ae);me?(I(Ae),E(["전체 프로젝트",me.title]),n(`/dashboard?projectId=${Ae}`),F(Xe=>{const qe=new Set(Xe);return qe.add(Ae),qe}),Ht(Ae),console.log("🔄 프로젝트 선택 시 디자인 파일 로드:",Ae),Lt(Ae)):(console.warn("프로젝트를 찾을 수 없습니다. 일단 선택만 진행합니다:",Ae),I(Ae),E(["전체 프로젝트","로딩 중..."]),n(`/dashboard?projectId=${Ae}`),F(Xe=>{const qe=new Set(Xe);return qe.add(Ae),qe}),Ht(Ae),Lt(Ae))}},Wn=Ae=>{if(Ae===0)I(null),K(null),E(["전체 프로젝트"]),n("/dashboard");else if(Ae===1&&_&&Ot)K(null),E(["전체 프로젝트",Ot.title]),n(`/dashboard?projectId=${_}`);else if(Ae===2&&V)return},ui=()=>{q(!0),ie("")},Mi=async()=>{if(!(!G.trim()||!_)){se(!0);try{const me={id:`folder_${Date.now()}`,name:G.trim(),type:"folder",children:[],expanded:!1},Xe=[...P[_]||[],me];M(qe=>({...qe,[_]:Xe})),await dt(_,Xe),q(!1),ie("")}catch(Ae){console.error("폴더 생성 실패:",Ae),alert("폴더 생성 중 오류가 발생했습니다.")}finally{se(!1)}}},Gn=Ae=>{F(me=>{const Xe=new Set(me);return Xe.has(Ae)?Xe.delete(Ae):(Xe.add(Ae),!At[Ae]&&!designFilesLoadingStates[Ae]&&Lt(Ae)),Xe})},Dn=Ae=>{_&&M(me=>{var Xe;return{...me,[_]:((Xe=me[_])==null?void 0:Xe.map(qe=>qe.id===Ae?{...qe,expanded:!qe.expanded}:qe))||[]}})},li=()=>{q(!1),ie("")},en=(Ae,me,Xe,qe)=>{Ae.preventDefault(),Ae.stopPropagation(),console.log("📌 더보기 메뉴 열기:",{itemId:me,itemName:Xe,itemType:qe,x:Ae.clientX,y:Ae.clientY}),U({visible:!0,x:Ae.clientX,y:Ae.clientY,itemId:me,itemName:Xe,itemType:qe})},Rt=()=>{U(null)},Xn=async()=>{var me,Xe;if(!Q)return;const Ae=prompt("새 이름을 입력하세요:",Q.itemName);if(Ae&&Ae.trim()){if(Q.itemType==="project")try{const{updateProject:qe}=await ca(async()=>{const{updateProject:An}=await Promise.resolve().then(()=>Jd);return{updateProject:An}},void 0),nn=await qe(Q.itemId,{title:Ae.trim()});if(nn.error){console.error("프로젝트 이름 변경 실패:",nn.error),alert("프로젝트 이름 변경에 실패했습니다: "+nn.error);return}y(An=>An.map(Ct=>Ct.id===Q.itemId?{...Ct,title:Ae.trim()}:Ct)),_===Q.itemId&&E(An=>{const Ct=[...An],kn=Ct.findIndex(fn=>fn!=="전체 프로젝트");return kn!==-1&&(Ct[kn]=Ae.trim()),Ct}),console.log("프로젝트 이름 변경 성공:",Q.itemId,"→",Ae.trim());try{const An=new BroadcastChannel("project-updates");An.postMessage({type:"PROJECT_UPDATED",action:"renamed",projectId:Q.itemId,newName:Ae.trim()}),An.close()}catch(An){console.warn("BroadcastChannel 전송 실패 (무시 가능):",An)}}catch(qe){console.error("프로젝트 이름 변경 중 오류:",qe),alert("프로젝트 이름 변경 중 오류가 발생했습니다.")}else if(Q.itemType==="folder"){const qe=((me=P[_])==null?void 0:me.map(nn=>nn.id===Q.itemId?{...nn,name:Ae.trim()}:nn))||[];M(nn=>({...nn,[_]:qe})),await dt(_,qe)}else if(Q.itemType==="design")try{let qe=!1;if(_){const nn=P[_]||[];for(const An of nn)if(An.children.some(Ct=>Ct.id===Q.itemId)){qe=!0;break}}if(qe){M(An=>{var Ct;return{...An,[_]:((Ct=An[_])==null?void 0:Ct.map(kn=>({...kn,children:kn.children.map(fn=>fn.id===Q.itemId?{...fn,name:Ae.trim()}:fn)})))||[]}});const nn=((Xe=P[_])==null?void 0:Xe.map(An=>({...An,children:An.children.map(Ct=>Ct.id===Q.itemId?{...Ct,name:Ae.trim()}:Ct)})))||[];await dt(_,nn)}else{const{updateDesignFile:nn}=await ca(async()=>{const{updateDesignFile:Ct}=await Promise.resolve().then(()=>Jd);return{updateDesignFile:Ct}},void 0),An=await nn(Q.itemId,{name:Ae.trim()});if(An.error){console.error("디자인파일 이름 변경 실패:",An.error),alert("디자인파일 이름 변경에 실패했습니다: "+An.error);return}console.log("루트 레벨 디자인파일 이름 변경 성공:",Q.itemId,"→",Ae.trim()),await $t();try{const Ct=new BroadcastChannel("project-updates");Ct.postMessage({type:"PROJECT_UPDATED",action:"design_renamed",projectId:_,designFileId:Q.itemId,newName:Ae.trim()}),Ct.close()}catch(Ct){console.warn("BroadcastChannel 전송 실패 (무시 가능):",Ct)}}}catch(qe){console.error("디자인파일 이름 변경 중 오류:",qe),alert("디자인파일 이름 변경 중 오류가 발생했습니다.")}console.log("이름 변경:",Q.itemId,"→",Ae)}Rt()},Ui=async()=>{var me;if(!Q)return;let Ae="";if(Q.itemType==="project"?Ae=`정말로 프로젝트 "${Q.itemName}"을(를) 삭제하시겠습니까?

이 작업은 되돌릴 수 없으며, 프로젝트 내의 모든 디자인파일과 폴더도 함께 삭제됩니다.`:Q.itemType==="folder"?Ae=`정말로 폴더 "${Q.itemName}"을(를) 삭제하시겠습니까?

폴더 내의 모든 파일도 함께 삭제됩니다.`:Ae=`정말로 파일 "${Q.itemName}"을(를) 삭제하시겠습니까?`,window.confirm(Ae)){if(Q.itemType==="project")try{if(Re==="trash"){const Xe=ut.find(qe=>qe.id===Q.itemId);if(Xe){const{error:qe}=await zB(Xe.id);if(qe)alert("프로젝트 삭제 실패: "+qe);else{const nn=ut.filter(An=>An.id!==Q.itemId);ft(nn),t&&localStorage.setItem(`trash_${t.uid}`,JSON.stringify(nn)),await $t();try{const An=new BroadcastChannel("project-updates");An.postMessage({type:"PROJECT_UPDATED",action:"deleted",projectId:Q.itemId}),An.close()}catch(An){console.warn("BroadcastChannel 전송 실패 (무시 가능):",An)}}}}}catch(Xe){console.error("프로젝트 삭제 중 오류:",Xe),alert("프로젝트 삭제 중 오류가 발생했습니다.")}else if(Q.itemType==="folder"){const Xe=((me=P[_])==null?void 0:me.filter(qe=>qe.id!==Q.itemId))||[];M(qe=>({...qe,[_]:Xe})),await dt(_,Xe)}else if(Q.itemType==="design")try{if(_){const{error:Xe}=await uI(Q.itemId,_);if(Xe)alert("디자인 파일 삭제 실패: "+Xe);else{zt(qe=>{var nn;return{...qe,[_]:((nn=qe[_])==null?void 0:nn.filter(An=>An.id!==Q.itemId))||[]}});try{const qe=new BroadcastChannel("project-updates");qe.postMessage({type:"DESIGN_FILE_DELETED",projectId:_,designFileId:Q.itemId}),qe.close()}catch(qe){console.warn("BroadcastChannel 전송 실패 (무시 가능):",qe)}console.log("✅ 디자인 파일 삭제 완료:",Q.itemId)}}}catch(Xe){console.error("디자인 파일 삭제 중 오류:",Xe),alert("디자인 파일 삭제 중 오류가 발생했습니다.")}console.log("삭제:",Q.itemId)}Rt()},tt=()=>{Q&&(Q.itemType==="project"?Ti(Q.itemId):alert("폴더/파일 공유 기능은 준비 중입니다."),Rt())},Jt=async()=>{var Ae;if(Q){if(Q.itemType==="project")try{const me=at.find(nn=>nn.id===Q.itemId);if(!me)return;const{createProject:Xe}=await ca(async()=>{const{createProject:nn}=await Promise.resolve().then(()=>Jd);return{createProject:nn}},void 0),qe=await Xe({title:`${me.title} 복사본`});if(qe.error){console.error("프로젝트 복제 실패:",qe.error),alert("프로젝트 복제에 실패했습니다: "+qe.error);return}if(qe.id){console.log("프로젝트 복제 성공:",qe.id),alert("프로젝트가 복제되었습니다."),await $t();try{const nn=new BroadcastChannel("project-updates");nn.postMessage({type:"PROJECT_CREATED",projectId:qe.id,timestamp:Date.now()}),nn.close()}catch(nn){console.warn("BroadcastChannel 전송 실패 (무시 가능):",nn)}}}catch(me){console.error("프로젝트 복제 중 오류:",me),alert("프로젝트 복제 중 오류가 발생했습니다.")}else if(Q.itemType==="folder"){const me=(Ae=P[_])==null?void 0:Ae.find(Xe=>Xe.id===Q.itemId);if(me){const Xe=`folder_${Date.now()}`,qe={...me,id:Xe,name:`${me.name} 복사본`,children:[]},nn=[...P[_]||[],qe];M(An=>({...An,[_]:nn})),await dt(_,nn)}}console.log("복제하기:",Q.itemId),Rt()}},wn=(Ae,me)=>{Z({isDragging:!0,draggedItem:me,dragOverFolder:null}),Ae.dataTransfer.effectAllowed="move",Ae.dataTransfer.setData("text/plain",JSON.stringify(me))},Yn=(Ae,me)=>{Ae.preventDefault(),Ae.dataTransfer.dropEffect="move",Z(Xe=>({...Xe,dragOverFolder:me}))},hi=Ae=>{Ae.preventDefault(),Z(me=>({...me,dragOverFolder:null}))},Xt=async(Ae,me)=>{var nn;if(Ae.preventDefault(),!X.draggedItem)return;const Xe=X.draggedItem,qe=((nn=P[_])==null?void 0:nn.map(An=>An.id===me?{...An,children:[...An.children,Xe]}:An))||[];M(An=>({...An,[_]:qe})),await dt(_,qe),Z({isDragging:!1,draggedItem:null,dragOverFolder:null}),console.log(`파일 "${Xe.name}"을 폴더에 추가했습니다.`)},_i=()=>{Z({isDragging:!1,draggedItem:null,dragOverFolder:null})},Pr=()=>{fe(null)},ws=Ae=>{const me=prompt("새 파일명을 입력하세요:",te==null?void 0:te.fileName);me&&me.trim()&&console.log("파일 이름 변경:",Ae,"→",me),Pr()},Vi=Ae=>{window.confirm("정말로 이 파일을 삭제하시겠습니까?")&&console.log("파일 삭제:",Ae),Pr()},br=()=>{be(!0),W("")},_r=async()=>{if(_e.trim()){ve(!0);try{if(t){console.log("🚀 프로젝트 생성 시작:",{title:_e.trim(),userId:t.uid,userEmail:t.email});const{id:Ae,error:me}=await R_({title:_e.trim()});if(me){console.error("❌ Firebase 프로젝트 생성 실패:",me),alert("프로젝트 생성에 실패했습니다: "+me),ve(!1);return}if(Ae){console.log("✅ Firebase 프로젝트 생성 성공:",{projectId:Ae,title:_e.trim(),timestamp:new Date().toISOString()}),be(!1),W(""),await $t(0),setTimeout(()=>{console.log("🎯 새 프로젝트 선택:",Ae),Li(Ae)},500);try{const Xe=new BroadcastChannel("project-updates");Xe.postMessage({type:"PROJECT_CREATED",projectId:Ae,timestamp:Date.now()}),console.log("📡 프로젝트 생성 알림 전송"),Xe.close()}catch(Xe){console.warn("BroadcastChannel 전송 실패 (무시 가능):",Xe)}}}else{alert("프로젝트를 생성하려면 먼저 로그인해주세요."),n("/auth");return}}catch(Ae){console.error("프로젝트 생성 실패:",Ae),alert("프로젝트 생성 중 오류가 발생했습니다.")}finally{ve(!1)}}},Qr=()=>{be(!1),W("")},ue=(Ae,me)=>{if(console.log("🚀 handleCreateDesign 호출됨:",{projectId:Ae,projectTitle:me,user:!!t}),t){if(!Ae){alert("프로젝트를 먼저 선택해주세요.");return}const Xe=at.find(kn=>kn.id===Ae),qe=me||(Xe==null?void 0:Xe.title)||"새 프로젝트";console.log("✅ projectId 확인됨, Step1 모달 열기 준비");const{setProjectId:nn,setProjectTitle:An,resetBasicInfo:Ct}=Ha.getState();nn(Ae),An(qe),Ct(),xe(Ae),Ce(qe),console.log("📝 Step1 모달 열기 with projectId:",Ae,"title:",qe),ne(!0)}else alert("로그인이 필요합니다.")},ke=async()=>{ne(!1),xe(null),Ce(null),_&&await Lt(_)},Me=async Ae=>{Ae.preventDefault(),Ae.stopPropagation(),ot(!0)},Oe=async()=>{try{console.log("🔐 Firebase 로그아웃 시작...");const{signOut:Ae}=await ca(async()=>{const{signOut:Xe}=await Promise.resolve().then(()=>sH);return{signOut:Xe}},void 0),{auth:me}=await ca(async()=>{const{auth:Xe}=await Promise.resolve().then(()=>uQ);return{auth:Xe}},void 0);await Ae(me),console.log("✅ Firebase 로그아웃 성공"),n("/auth")}catch(Ae){console.error("❌ 로그아웃 실패:",Ae),alert("로그아웃 중 오류가 발생했지만 로그인 페이지로 이동합니다."),n("/auth")}};return v?l.jsx("div",{className:st.dashboard,children:l.jsx("div",{className:st.emptyState,children:l.jsx("div",{children:"프로젝트 목록을 불러오는 중..."})})}):w?l.jsx("div",{className:st.dashboard,children:l.jsxs("div",{className:st.emptyState,children:[l.jsxs("div",{className:st.emptyStateTitle,children:["오류: ",w]}),l.jsx("button",{onClick:$t,className:st.emptyStateButton,children:"다시 시도"})]})}):l.jsxs("div",{className:st.dashboard,"data-menu":Re,children:[l.jsxs("aside",{className:st.sidebar,children:[l.jsx("div",{className:st.logoSection,children:l.jsx("div",{className:st.logo,children:l.jsx(V5,{size:"medium"})})}),l.jsx("div",{className:st.profileSection,children:l.jsxs("div",{className:st.userInfo,children:[l.jsx("div",{className:st.userAvatar,children:t!=null&&t.photoURL&&!d?l.jsx("img",{src:t.photoURL,alt:"프로필",style:{width:"100%",height:"100%",borderRadius:"50%",objectFit:"cover"},onError:()=>f(!0),onLoad:()=>f(!1)}):l.jsx(nh,{size:16})}),l.jsxs("div",{className:st.userDetails,children:[l.jsx("div",{className:st.userName,children:(t==null?void 0:t.displayName)||((nt=t==null?void 0:t.email)==null?void 0:nt.split("@")[0])||"사용자"}),l.jsx("div",{className:st.userEmail,children:(t==null?void 0:t.email)||"로그인이 필요합니다"})]})]})}),l.jsx("div",{className:st.createProjectSection,children:l.jsxs("button",{className:st.createProjectBtn,onClick:br,children:[l.jsx(Np,{size:16}),"Create Project"]})}),l.jsxs("nav",{className:st.navSection,children:[l.jsxs("div",{className:`${st.navItem} ${Re==="all"?st.active:""}`,onClick:()=>{n("/dashboard"),Ie("all"),I(null),E(["전체 프로젝트"])},children:[l.jsx("div",{className:st.navItemIcon,children:l.jsx(E0,{size:20})}),l.jsx("span",{children:"전체 프로젝트"}),l.jsx("span",{className:st.navItemCount,children:at.length})]}),l.jsxs("div",{className:`${st.navItem} ${Re==="shared"?st.active:""}`,onClick:()=>{n("/dashboard/shared"),I(null),E([])},children:[l.jsx("div",{className:st.navItemIcon,children:l.jsx(U0,{size:20})}),l.jsx("span",{children:"공유 프로젝트"}),l.jsx("span",{className:st.navItemCount,children:Je.length})]}),l.jsxs("div",{className:`${st.navItem} ${Re==="profile"?st.active:""}`,onClick:()=>{n("/dashboard/profile"),E([])},children:[l.jsx("div",{className:st.navItemIcon,children:l.jsx(nh,{size:20})}),l.jsx("span",{children:"내 정보 관리"})]}),l.jsxs("div",{className:`${st.navItem} ${Re==="team"?st.active:""}`,onClick:()=>{n("/dashboard/team"),E([])},children:[l.jsx("div",{className:st.navItemIcon,children:l.jsx(Sy,{size:20})}),l.jsx("span",{children:"팀 관리"})]}),l.jsxs("div",{className:`${st.navItem} ${Re==="trash"?st.active:""}`,onClick:()=>{n("/dashboard/trash"),I(null),E([])},children:[l.jsx("div",{className:st.navItemIcon,children:l.jsx(O0,{size:20})}),l.jsx("span",{children:"휴지통"}),l.jsx("span",{className:st.navItemCount,children:ut.length})]})]}),l.jsxs("div",{className:st.settingsSection,children:[l.jsxs("div",{className:st.settingsItem,onClick:()=>Ve(!0),style:{cursor:"pointer"},children:[l.jsx("div",{className:st.navItemIcon,children:l.jsx(DI,{size:20})}),l.jsx("span",{children:"설정"})]}),t&&l.jsxs("div",{className:st.settingsItem,onClick:Me,children:[l.jsx("div",{className:st.navItemIcon,children:l.jsx(Bhe,{size:20})}),l.jsx("span",{children:"로그아웃"})]}),!t&&l.jsxs("div",{className:st.settingsItem,onClick:()=>n("/auth"),children:[l.jsx("div",{className:st.navItemIcon,children:l.jsx(nh,{size:20})}),l.jsx("span",{children:"로그인"})]})]})]}),l.jsxs("main",{className:st.main,children:[l.jsxs("header",{className:st.header,children:[l.jsx("div",{className:st.headerLeft}),l.jsxs("div",{className:st.headerRight,children:[l.jsxs("div",{className:st.headerActions,children:[l.jsx("button",{className:st.actionButton,children:l.jsx(Ihe,{size:20})}),l.jsx(g7e,{children:l.jsx("button",{className:st.actionButton,children:l.jsx(T$,{size:20})})})]}),l.jsxs("div",{className:st.userProfile,children:[l.jsx("div",{className:st.userProfileAvatar,children:t!=null&&t.photoURL&&!A?l.jsx("img",{src:t.photoURL,alt:"프로필",style:{width:"100%",height:"100%",borderRadius:"50%",objectFit:"cover"},onError:()=>g(!0),onLoad:()=>g(!1)}):l.jsx(nh,{size:14})}),l.jsx("span",{className:st.userProfileName,children:t?(t==null?void 0:t.displayName)||((gt=t==null?void 0:t.email)==null?void 0:gt.split("@")[0])||"사용자":"게스트"})]})]})]}),(Re==="all"||Re==="bookmarks"||Re==="trash"||Re==="shared")&&l.jsx("div",{className:st.subHeader,children:l.jsxs("div",{className:st.subHeaderContent,children:[l.jsxs("div",{className:st.subHeaderLeft,children:[Re==="all"&&l.jsx("h1",{className:st.subHeaderTitle,children:"전체 프로젝트"}),Re==="trash"&&l.jsx("h1",{className:st.subHeaderTitle,children:"휴지통"}),Mt.size>0&&l.jsxs("div",{className:st.selectionInfo,children:[l.jsxs("span",{children:[Mt.size,"개의 항목이 선택됨"]}),l.jsx("button",{className:st.clearSelectionBtn,onClick:()=>dn(new Set),children:"선택 해제"})]})]}),l.jsxs("div",{className:st.subHeaderActions,children:[l.jsxs("div",{className:st.searchContainer,children:[l.jsx("div",{className:st.searchIcon,children:l.jsx(khe,{size:16})}),l.jsx("input",{type:"text",placeholder:"프로젝트 검색...",className:st.searchInput})]}),l.jsxs("div",{className:st.viewToggleGroup,children:[l.jsx("button",{className:`${st.viewToggleButton} ${s==="grid"?st.active:""}`,onClick:()=>kt("grid"),title:"그리드 보기",children:l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:[l.jsx("rect",{x:"1",y:"1",width:"6",height:"6",rx:"1"}),l.jsx("rect",{x:"9",y:"1",width:"6",height:"6",rx:"1"}),l.jsx("rect",{x:"1",y:"9",width:"6",height:"6",rx:"1"}),l.jsx("rect",{x:"9",y:"9",width:"6",height:"6",rx:"1"})]})}),l.jsx("button",{className:`${st.viewToggleButton} ${s==="list"?st.active:""}`,onClick:()=>kt("list"),title:"리스트 보기",children:l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:[l.jsx("rect",{x:"1",y:"2",width:"14",height:"2",rx:"1"}),l.jsx("rect",{x:"1",y:"7",width:"14",height:"2",rx:"1"}),l.jsx("rect",{x:"1",y:"12",width:"14",height:"2",rx:"1"})]})})]}),l.jsxs("button",{className:st.sortButton,onClick:()=>u(!h),children:[l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:l.jsx("path",{d:"M3 6h10M5 10h6M7 14h2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",fill:"none"})}),l.jsx("span",{children:a==="date"?"최신순":"이름순"}),l.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor",children:l.jsx("path",{d:"M3 4.5L6 7.5L9 4.5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})})]}),h&&l.jsxs("div",{className:st.sortDropdownMenu,children:[l.jsxs("button",{className:`${st.sortOption} ${a==="date"?st.active:""}`,onClick:()=>{mn("date"),u(!1)},children:[l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:l.jsx("path",{d:"M8 3v10M5 10l3 3 3-3",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})}),"최신순"]}),l.jsxs("button",{className:`${st.sortOption} ${a==="name"?st.active:""}`,onClick:()=>{mn("name"),u(!1)},children:[l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:l.jsx("path",{d:"M4 6h8M4 10h5M4 14h3",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",fill:"none"})}),"이름순"]})]}),Mt.size>0&&Re!=="trash"&&l.jsxs("button",{className:st.bulkDeleteButton,onClick:()=>{window.confirm(`선택한 ${Mt.size}개 항목을 휴지통으로 이동하시겠습니까?`)&&(Mt.forEach(Ae=>{const me=$n.find(Xe=>Xe.id===Ae);me&&(me.type==="project"?En(me.project):(me.type==="design"||me.type==="folder")&&console.log("삭제할 항목:",me))}),dn(new Set))},children:[l.jsx(O0,{size:16}),l.jsxs("span",{children:["휴지통으로 이동 (",Mt.size,")"]})]}),Re==="trash"&&ut.length>0&&l.jsxs("button",{className:st.emptyTrashBtn,onClick:Kn,children:[l.jsx(O0,{size:16}),l.jsx("span",{children:"휴지통 비우기"})]}),s==="list"&&_&&l.jsxs("button",{className:st.createDesignBtn,onClick:()=>{ue(_,Ot==null?void 0:Ot.title)},children:[l.jsx(Np,{size:14}),l.jsx("span",{children:"디자인 생성"})]})]})]})}),l.jsxs("div",{className:st.content,children:[Re==="all"&&at.length>0&&l.jsxs("aside",{className:`${st.projectTree} ${jt?st.collapsed:""}`,children:[l.jsxs("div",{className:st.treeHeader,children:[l.jsx("button",{className:st.treeToggleButton,onClick:()=>Wt(!jt),"aria-label":jt?"파일트리 펼치기":"파일트리 접기",children:l.jsx("span",{className:`${st.toggleIcon} ${jt?st.collapsed:""}`,children:"◀"})}),l.jsx("div",{className:st.projectSelectorContainer,children:l.jsx(sG,{projects:at,currentProject:Ot,onProjectSelect:Ae=>{console.log("🎯 SimpleDashboard - 프로젝트 선택됨:",Ae.id,Ae.title),Li(Ae.id)}})})]}),l.jsx("div",{className:st.treeContent,children:at.length>0?l.jsx("div",{children:at.map(Ae=>{const me=S.has(Ae.id),Xe=_===Ae.id,qe=P[Ae.id]||[],nn=At[Ae.id]||[],An=qe.length>0||nn.length>0||Ae.furnitureCount>0;return l.jsxs("div",{children:[l.jsxs("div",{className:`${st.treeItem} ${Xe?st.active:""}`,onClick:()=>{console.log("🎯 파일트리 프로젝트 클릭:",Ae.id,Ae.title),Li(Ae.id),K(null)},style:{cursor:"pointer"},children:[An&&l.jsx("div",{className:`${st.treeToggleArrow} ${me?st.expanded:""}`,onClick:Ct=>{Ct.stopPropagation(),Gn(Ae.id)},children:"▶"}),l.jsx("div",{className:st.treeItemIcon,children:l.jsx(COe,{size:16})}),l.jsx("span",{children:Ae.title}),(nn.length>0||Ae.furnitureCount>0)&&l.jsx("span",{className:st.treeItemCount,children:nn.length||Ae.furnitureCount||0}),l.jsx("div",{className:st.treeItemActions,children:l.jsx("button",{className:st.treeItemActionBtn,onClick:Ct=>{Ct.stopPropagation(),en(Ct,Ae.id,Ae.title,"project")},children:"⋯"})})]}),me&&l.jsxs("div",{className:st.projectChildren,children:[Xe&&l.jsxs("button",{className:st.createFolderBtn,onClick:ui,children:[l.jsxs("div",{className:st.createFolderIcon,children:[l.jsx(E0,{size:16}),l.jsx(Np,{size:12})]}),l.jsx("span",{children:"새로운 폴더"})]}),qe.map(Ct=>l.jsxs("div",{children:[l.jsxs("div",{className:st.treeItem,onClick:()=>{K(Ct.id),E(["전체 프로젝트",Ot.title,Ct.name])},style:{cursor:"pointer"},children:[l.jsx("div",{className:st.treeItemIcon,onClick:kn=>{kn.stopPropagation(),Dn(Ct.id)},style:{cursor:"pointer"},children:l.jsx(E0,{size:16})}),l.jsx("span",{children:Ct.name}),Ct.children&&Ct.children.length>0&&l.jsx("span",{className:st.treeItemCount,children:Ct.children.length}),l.jsx("div",{className:`${st.dropdownArrow} ${st.folderDropdown} ${Ct.expanded?st.expanded:""}`,onClick:kn=>{kn.stopPropagation(),Dn(Ct.id)},children:"▼"}),l.jsx("div",{className:st.treeItemActions,children:l.jsx("button",{className:st.treeItemActionBtn,onClick:kn=>{kn.stopPropagation(),en(kn,Ct.id,Ct.name,"folder")},children:"⋯"})})]}),Ct.expanded&&Ct.children&&Ct.children.length>0?l.jsx("div",{className:st.folderChildren,children:Ct.children.map(kn=>l.jsxs("div",{className:`${st.treeItem} ${st.childItem}`,onClick:fn=>{fn.stopPropagation(),console.log("디자인 파일 클릭됨:",kn,"폴더 ID:",Ct.id,"프로젝트 ID:",_),_!==kn.projectId&&kn.projectId&&Li(kn.projectId),K(Ct.id),E(["전체 프로젝트",Ot.title,Ct.name]),setTimeout(()=>{const Qt=document.querySelectorAll(`.${st.designCard}`);console.log("모든 디자인 카드:",Qt.length);const Qn=Array.from(Qt).find(Tn=>{var tr;const pn=(tr=Tn.querySelector(`.${st.cardTitle}`))==null?void 0:tr.textContent;return console.log("카드 제목 확인:",pn,"찾는 디자인:",kn.name),pn===kn.name});Qn?(console.log("디자인 카드 찾음:",Qn),Qn.scrollIntoView({behavior:"smooth",block:"center"}),Qn.classList.add(st.forceHover),setTimeout(()=>{Qn.classList.remove(st.forceHover)},3e3)):console.log("디자인 카드를 찾을 수 없음:",kn.name)},300)},style:{cursor:"pointer",userSelect:"none"},onMouseDown:fn=>fn.preventDefault(),children:[l.jsx("div",{className:st.treeItemIcon,children:l.jsx("div",{className:st.designIcon,children:l.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2.5",children:[l.jsx("path",{d:"M12 19l7-7 3 3-7 7-3-3z"}),l.jsx("path",{d:"M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"}),l.jsx("path",{d:"M2 2l7.586 7.586"}),l.jsx("circle",{cx:"11",cy:"11",r:"2"})]})})}),l.jsx("span",{children:kn.name}),l.jsx("div",{className:st.treeItemActions,children:l.jsx("button",{className:st.treeItemActionBtn,onClick:fn=>{fn.stopPropagation(),en(fn,kn.id,kn.name,kn.type==="file"?"design":kn.type)},children:"⋯"})})]},kn.id))}):null]},Ct.id)),nn.map(Ct=>l.jsxs("div",{className:st.treeItem,onClick:kn=>{kn.stopPropagation(),console.log("디자인 파일 클릭됨:",Ct.name),setTimeout(()=>{const fn=document.querySelectorAll(`.${st.designCard}`),Qt=Array.from(fn).find(Qn=>{var pn;return((pn=Qn.querySelector(`.${st.cardTitle}`))==null?void 0:pn.textContent)===Ct.name});Qt&&(Qt.scrollIntoView({behavior:"smooth",block:"center"}),Qt.classList.add(st.forceHover),setTimeout(()=>{Qt.classList.remove(st.forceHover)},3e3))},100)},children:[l.jsx("div",{className:st.treeItemIcon,children:l.jsx("div",{className:st.designIcon,children:l.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2.5",children:[l.jsx("path",{d:"M12 19l7-7 3 3-7 7-3-3z"}),l.jsx("path",{d:"M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"}),l.jsx("path",{d:"M2 2l7.586 7.586"}),l.jsx("circle",{cx:"11",cy:"11",r:"2"})]})})}),l.jsx("span",{children:Ct.name}),l.jsx("div",{className:st.treeItemActions,children:l.jsx("button",{className:st.treeItemActionBtn,onClick:kn=>{kn.stopPropagation(),en(kn,Ct.id,Ct.name,"design")},children:"⋯"})})]},Ct.id))]})]},Ae.id)})}):t?l.jsx("div",{className:st.treeItem,children:l.jsx("span",{style:{color:"#999",fontSize:"14px"},children:"프로젝트가 없습니다"})}):l.jsx("div",{className:st.treeItem,children:l.jsx("span",{style:{color:"#999",fontSize:"14px"},children:"로그인이 필요합니다"})})})]}),l.jsxs("section",{className:st.designArea,children:[l.jsxs("div",{className:st.breadcrumb,children:[Re==="bookmarks"&&l.jsx("h2",{className:st.pageTitle,children:"북마크"}),Re==="all"&&B.map((Ae,me)=>l.jsxs(ii.Fragment,{children:[l.jsx("span",{className:`${st.breadcrumbItem} ${me===B.length-1?st.active:""}`,onClick:()=>Wn(me),children:Ae}),me<B.length-1&&l.jsx("span",{className:st.breadcrumbSeparator,children:"/"})]},me))]}),Re==="shared"&&l.jsx(e7e,{onProjectSelect:Ae=>n(`/configurator?projectId=${Ae}`)}),Re==="team"&&l.jsx(t7e,{onTeamSelect:Ae=>console.log("팀 선택:",Ae)}),Re==="profile"&&l.jsx(c7e,{}),console.log("🔍 activeMenu 체크:",{activeMenu:Re,isAllTrashBookmarks:Re==="all"||Re==="trash"||Re==="bookmarks",shouldShowGrid:Re==="all"||Re==="trash"||Re==="bookmarks"}),Re==="all"||Re==="trash"||Re==="bookmarks"?l.jsxs(l.Fragment,{children:[s==="list"&&$n.some(Ae=>Ae.type!=="new-design")&&l.jsxs("div",{className:st.listTableHeader,children:[l.jsx("div",{className:st.headerColumn,children:l.jsx("input",{type:"checkbox",checked:(()=>{const Ae=$n.filter(me=>me.type!=="new-design");return Ae.length>0&&Ae.every(me=>Mt.has(me.id))})(),onChange:()=>bn($n)})}),l.jsx("div",{className:st.headerColumn,children:"제목"}),l.jsx("div",{className:st.headerColumn,children:"마지막 수정일"}),l.jsx("div",{className:st.headerColumn,children:"등록자"}),l.jsx("div",{className:st.headerColumn})]}),l.jsxs("div",{className:`${st.designGrid} ${s==="list"?st.listView:""} ${V?st.folderView:""}`,children:[console.log("🎨 렌더링 시작:",{sortedItemsLength:$n.length,viewMode:s,items:$n.map(Ae=>({type:Ae.type,name:Ae.name})),filteredItems:$n.filter(Ae=>!(s==="list"&&Ae.type==="new-design")).map(Ae=>({type:Ae.type,name:Ae.name}))}),(()=>{if(v&&$n.length===0)return l.jsx(l.Fragment,{children:[1,2,3,4].map(me=>l.jsxs(Xi.div,{className:st.designCard,style:{opacity:.3,pointerEvents:"none"},children:[l.jsx("div",{className:st.designCardThumbnail,style:{background:"#f0f0f0"},children:l.jsx("div",{style:{width:"100%",height:"100%",background:"linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%)",animation:"shimmer 2s infinite"}})}),l.jsxs("div",{className:st.designCardFooter,children:[l.jsx("div",{style:{width:"60%",height:"16px",background:"#f0f0f0",borderRadius:"4px"}}),l.jsx("div",{style:{width:"30%",height:"12px",background:"#f0f0f0",borderRadius:"4px",marginTop:"4px"}})]})]},`skeleton-${me}`))});const Ae=$n.filter(me=>s==="list"&&me.type==="new-design"?(console.log("📝 리스트 뷰에서 new-design 카드 제외"),!1):!0);return console.log("🔍 필터링 후 상태:",{viewMode:s,sortedItemsLength:$n.length,filteredItemsLength:Ae.length,sortedItems:$n.map(me=>({type:me.type,name:me.name})),filteredItems:Ae.map(me=>({type:me.type,name:me.name}))}),console.log("🚨 렌더링 조건 체크:",{filteredItemsLength:Ae.length,filteredItemsEmpty:Ae.length===0,willRenderCards:Ae.length>0}),Ae.length>0?Ae.map((me,Xe)=>{var qe,nn,An;return l.jsxs(Xi.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:Xe*.05,ease:[.4,0,.2,1]},whileHover:{y:-4,scale:1.02},whileTap:{scale:.98},className:`${st.designCard} ${me.type==="new-design"?st.newDesign:""} ${me.type==="folder"?st.folderCard:""}`,"data-design-id":me.type==="design"?me.id:void 0,"data-item-type":me.type,draggable:me.type==="design",onDragStart:Ct=>{me.type==="design"&&wn(Ct,{id:me.id,name:me.name,type:"design",projectId:me.project.id})},onDragEnd:_i,onClick:Ct=>{var kn,fn;if(console.log("🖱️ 카드 클릭됨:",{itemType:me.type,itemName:me.name,itemId:me.id,projectId:(kn=me.project)==null?void 0:kn.id,clickEvent:Ct.type}),me.type==="project")console.log("📂 프로젝트 선택"),Li(me.project.id);else if(me.type==="new-design")console.log("➕ 새 디자인 생성"),ue(me.project.id,me.project.title);else if(me.type==="loading")console.log("⏳ 로딩 중...");else if(me.type==="folder"){console.log("📁 폴더 이동"),K(me.id);const Qt=(fn=P[_])==null?void 0:fn.find(Qn=>Qn.id===me.id);Qt&&Ot&&E(["전체 프로젝트",Ot.title,Qt.name])}else me.type==="design"&&(console.log("🎨 디자인 카드 클릭 - 액션 팝업 표시",{itemId:me.id,projectId:me.project.id,itemName:me.name,hasDesignFile:!!me.designFile,viewMode:s}),s!=="list"&&(me.designFile&&me.designFile.id?n(`/configurator?projectId=${me.project.id}&designFileId=${me.designFile.id}`):n(`/configurator?projectId=${me.project.id}&designFileName=${encodeURIComponent(me.name)}`)))},children:[me.type!=="new-design"&&me.type!=="loading"&&l.jsx("div",{className:st.cardCheckbox,children:l.jsx("input",{type:"checkbox",checked:Mt.has(me.id),onChange:Ct=>{Ct.stopPropagation(),sn(me.id,Ct.target.checked)},onClick:Ct=>Ct.stopPropagation()})}),me.type!=="new-design"&&me.type!=="loading"&&l.jsx("button",{className:st.cardActionButton,onClick:Ct=>{Ct.stopPropagation(),me.type==="folder"?en(Ct,me.id,me.name,"folder"):me.type==="design"?en(Ct,me.id,me.name,"design"):me.type==="project"&&en(Ct,me.project.id,me.project.title,"project")},children:"⋯"}),l.jsx("div",{className:`${st.cardThumbnail} ${me.type==="new-design"?st.newDesign:""} ${me.type==="folder"?st.folderDropZone:""} ${X.dragOverFolder===me.id?st.dragOver:""}`,onDragOver:Ct=>{me.type==="folder"&&Yn(Ct,me.id)},onDragLeave:hi,onDrop:Ct=>{me.type==="folder"&&Xt(Ct,me.id)},children:me.type==="new-design"?l.jsxs("div",{className:st.cardThumbnailContent,children:[l.jsx("div",{className:st.cardThumbnailIcon,children:l.jsx(Np,{size:32})}),l.jsx("div",{className:st.cardThumbnailText,children:me.name})]}):me.type==="loading"?l.jsxs("div",{className:st.cardThumbnailContent,children:[l.jsx("div",{className:st.cardThumbnailIcon,children:l.jsx("div",{style:{opacity:.5},children:"⏳"})}),l.jsx("div",{className:st.cardThumbnailText,children:me.name})]}):me.type==="folder"?l.jsx("div",{className:st.folderIcon,children:l.jsxs("svg",{className:st.folderIconSvg,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[l.jsx("path",{d:"M4 4h6l2 2h8a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2z",fill:"var(--theme-primary, #10b981)"}),l.jsx("path",{d:"M4 6h16v10H4V6z",fill:"var(--theme-primary, #10b981)",fillOpacity:"0.7"})]})}):(()=>{var fn,Qt,Qn;if(me.type==="design"){const Tn=At[me.project.id]||[],Nn=me.designFile||Tn.find(pn=>pn.name===me.name||pn.id===me.id);return console.log("🔍 디자인 카드 썸네일 생성:",{itemName:me.name,itemId:me.id,projectId:me.project.id,designFilesCount:Tn.length,designFilesData:Tn.map(pn=>({id:pn.id,name:pn.name,matchesName:pn.name===me.name,matchesId:pn.id===me.id})),foundDesignFile:!!Nn,designFileData:Nn?{id:Nn.id,name:Nn.name,hasSpaceConfig:!!Nn.spaceConfig,hasFurniture:!!Nn.furniture,furnitureCount:((Qt=(fn=Nn.furniture)==null?void 0:fn.placedModules)==null?void 0:Qt.length)||0}:null}),l.jsxs("div",{className:st.designThumbnail,children:[l.jsx(sR,{project:me.project,designFile:Nn?{thumbnail:Nn.thumbnail,updatedAt:Nn.updatedAt,spaceConfig:Nn.spaceConfig,furniture:Nn.furniture}:void 0,className:st.designThumbnailImage,alt:me.name}),s==="grid"&&l.jsxs("div",{className:st.designCardOverlay,children:[l.jsxs("button",{className:st.overlayButton,onClick:pn=>{var Nr,ks;pn.stopPropagation(),console.log("🔥 디자인 미리보기 버튼 클릭:",{itemId:me.id,itemType:me.type,projectId:me.project.id,hasDesignFile:!!me.designFile,designFileId:(Nr=me.designFile)==null?void 0:Nr.id,itemData:me});const tr=((ks=me.designFile)==null?void 0:ks.id)||(me.id.endsWith("-design")?void 0:me.id);Fn(me.project.id,tr)},children:[l.jsx($j,{size:16}),"디자인 미리보기"]}),l.jsxs("button",{className:`${st.overlayButton} ${st.primary}`,onClick:pn=>{pn.stopPropagation(),console.log("🎨 오버레이 버튼 클릭 - 에디터로 이동",{itemId:me.id,projectId:me.project.id,itemName:me.name,hasDesignFile:!!me.designFile}),me.designFile&&me.designFile.id?n(`/configurator?projectId=${me.project.id}&designFileId=${me.designFile.id}`):n(`/configurator?projectId=${me.project.id}&designFileName=${encodeURIComponent(me.name)}`)},children:[l.jsx(Ty,{size:16}),"에디터로 이동"]})]})]})}console.log("🚀 getProjectItems 호출 전 상태:",{projectId:me.project.id,projectTitle:me.project.title,projectDesignFilesState:At,hasDesignFiles:!!At[me.project.id],designFilesCount:((Qn=At[me.project.id])==null?void 0:Qn.length)||0});const Ct=fi(me.project.id);if(console.log("🎯 프로젝트 아이템 렌더링 확인:",{projectId:me.project.id,projectTitle:me.project.title,projectItemsCount:Ct.length,projectItems:Ct.map(Tn=>({id:Tn.id,type:Tn.type,name:Tn.name})),timestamp:new Date().toISOString()}),Ct.length===0)return l.jsxs("div",{className:st.emptyThumbnailState,children:[l.jsx("div",{className:st.emptyThumbnailIcon,children:l.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[l.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),l.jsx("polyline",{points:"14,2 14,8 20,8"}),l.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),l.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),l.jsx("polyline",{points:"10,9 9,9 8,9"})]})}),l.jsx("div",{className:st.emptyThumbnailText,children:"생성된 파일이 없습니다"})]});const kn=Ct.slice(0,4);return l.jsxs("div",{className:st.thumbnailGrid,children:[kn.map((Tn,Nn)=>l.jsx("div",{className:st.thumbnailItem,children:Tn.type==="folder"?l.jsx("div",{className:st.thumbnailFolder,children:l.jsx(E0,{size:24})}):Tn.type==="design"&&Tn.designFile?l.jsx(sR,{project:me.project,designFile:{thumbnail:Tn.designFile.thumbnail,updatedAt:Tn.designFile.updatedAt,spaceConfig:Tn.designFile.spaceConfig,furniture:Tn.designFile.furniture},className:st.thumbnailImage,alt:Tn.name}):l.jsx("div",{className:st.thumbnailFile,children:l.jsx("div",{className:st.fileIconWrapper,children:l.jsx("span",{className:st.fileIcon,children:"D"})})})},Tn.id)),Array.from({length:4-kn.length}).map((Tn,Nn)=>l.jsx("div",{className:st.thumbnailEmpty},`empty-${Nn}`))]})})()}),me.type!=="new-design"&&(me.type==="folder"?l.jsxs("div",{className:st.cardInfo,children:[l.jsx("div",{className:st.cardTitle,children:me.name}),l.jsx("div",{className:st.cardMeta,children:l.jsx("div",{className:st.cardDate,children:(()=>{const Ct=me.project.createdAt||me.project.updatedAt;return Ct&&Ct.seconds?new Date(Ct.seconds*1e3).toLocaleString("ko-KR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"날짜 정보 없음"})()})}),l.jsxs("div",{className:st.cardFooter,children:[l.jsxs("div",{className:st.cardUser,children:[l.jsx("div",{className:st.cardUserAvatar,children:t!=null&&t.photoURL?l.jsx("img",{src:t.photoURL,alt:"프로필",style:{width:"100%",height:"100%",borderRadius:"50%",objectFit:"cover"}}):l.jsx(nh,{size:12})}),l.jsx("span",{className:st.cardUserName,children:(t==null?void 0:t.displayName)||((qe=t==null?void 0:t.email)==null?void 0:qe.split("@")[0])||"이진수"})]}),l.jsx("div",{className:st.cardBadge,children:(()=>{const kn=(P[me.project.id]||[]).find(Qt=>Qt.id===me.id);if(!(kn!=null&&kn.children))return 0;const fn=kn.children.filter(Qt=>Qt.type==="design"||Qt.type==="file"||!Qt.type).length;return console.log(`폴더 ${me.name}의 디자인 파일 개수:`,fn,kn.children),fn})()})]})]}):me.type==="design"?l.jsxs("div",{className:st.cardInfo,children:[l.jsxs("div",{className:st.cardTitle,children:[me.name,s==="list"&&l.jsxs("div",{className:st.listActionButtons,children:[l.jsxs("button",{className:st.listActionBtn,onClick:Ct=>{Ct.stopPropagation(),vt(me.id)},title:"미리보기",children:[l.jsx($j,{size:16}),l.jsx("span",{children:"미리보기"})]}),l.jsxs("button",{className:st.listActionBtn,onClick:Ct=>{Ct.stopPropagation(),me.designFile&&me.designFile.id?n(`/configurator?projectId=${me.project.id}&designFileId=${me.designFile.id}`):n(`/configurator?projectId=${me.project.id}&designFileName=${encodeURIComponent(me.name)}`)},title:"에디터로 이동",children:[l.jsx(Ty,{size:16}),l.jsx("span",{children:"에디터로 이동"})]})]})]}),l.jsx("div",{className:st.cardMeta,children:l.jsx("div",{className:st.cardDate,children:(()=>{const Ct=me.project.updatedAt||me.project.createdAt;return Ct&&Ct.seconds?new Date(Ct.seconds*1e3).toLocaleString("ko-KR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"날짜 정보 없음"})()})}),l.jsx("div",{className:st.cardFooter,children:l.jsxs("div",{className:st.cardUser,children:[l.jsx("div",{className:st.cardUserAvatar,children:t!=null&&t.photoURL?l.jsx("img",{src:t.photoURL,alt:"프로필",style:{width:"100%",height:"100%",borderRadius:"50%",objectFit:"cover"}}):l.jsx(nh,{size:12})}),l.jsx("span",{className:st.cardUserName,children:(t==null?void 0:t.displayName)||((nn=t==null?void 0:t.email)==null?void 0:nn.split("@")[0])||"이진수"})]})})]}):l.jsxs("div",{className:st.cardInfo,children:[l.jsx("div",{className:st.cardTitle,children:me.name}),l.jsx("div",{className:st.cardMeta,children:l.jsx("div",{className:st.cardDate,children:(()=>{const Ct=me.project.createdAt||me.project.updatedAt;return Ct&&Ct.seconds?new Date(Ct.seconds*1e3).toLocaleString("ko-KR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"날짜 정보 없음"})()})}),l.jsxs("div",{className:st.cardFooter,children:[l.jsxs("div",{className:st.cardUser,children:[l.jsx("div",{className:st.cardUserAvatar,children:t!=null&&t.photoURL?l.jsx("img",{src:t.photoURL,alt:"프로필",style:{width:"100%",height:"100%",borderRadius:"50%",objectFit:"cover"}}):l.jsx(nh,{size:12})}),l.jsx("span",{className:st.cardUserName,children:(t==null?void 0:t.displayName)||((An=t==null?void 0:t.email)==null?void 0:An.split("@")[0])||"이진수"})]}),l.jsx("div",{className:st.cardBadge,children:"V5.0"})]})]}))]},me.id)}):v?null:l.jsx("div",{className:st.emptyState,children:l.jsx("div",{className:st.emptyStateTitle,children:"표시할 항목이 없습니다"})})})(),t&&$n.length===0&&!v?l.jsxs("div",{className:st.emptyState,children:[l.jsxs("div",{className:st.emptyStateTitle,children:[Re==="bookmarks"&&"북마크한 프로젝트가 없습니다",Re==="shared"&&"공유된 프로젝트가 없습니다",Re==="trash"&&"휴지통이 비어있습니다",Re==="all"&&"아직 생성된 프로젝트가 없습니다"]}),l.jsxs("div",{className:st.emptyStateSubtitle,children:[Re==="bookmarks"&&"프로젝트를 북마크하려면 ⋯ 메뉴를 사용하세요",Re==="shared"&&"다른 사용자가 공유한 프로젝트가 여기에 표시됩니다",Re==="trash"&&"삭제된 프로젝트가 여기에 표시됩니다",Re==="all"&&"새 프로젝트를 생성해보세요"]})]}):null]})]}):null]})]})]}),ye&&l.jsx("div",{className:st.modalOverlay,children:l.jsxs("div",{className:st.modal,children:[l.jsx("h2",{className:st.modalTitle,children:"새 프로젝트 생성"}),l.jsx("input",{type:"text",value:_e,onChange:Ae=>W(Ae.target.value),placeholder:"프로젝트 이름을 입력하세요",className:st.modalInput,onKeyPress:Ae=>{Ae.key==="Enter"&&_e.trim()&&_r()},autoFocus:!0}),l.jsxs("div",{className:st.modalActions,children:[l.jsx("button",{onClick:Qr,disabled:Y,className:st.modalCancelBtn,children:"취소"}),l.jsx("button",{onClick:_r,disabled:!_e.trim()||Y,className:st.modalCreateBtn,children:Y?"생성 중...":"생성"})]})]})}),$e&&l.jsx("div",{className:st.modalOverlay,children:l.jsxs("div",{className:st.modal,children:[l.jsx("h2",{className:st.modalTitle,children:"로그아웃 하시겠습니까?"}),l.jsxs("div",{className:st.modalActions,children:[l.jsx("button",{onClick:()=>ot(!1),className:st.modalCancelBtn,children:"취소"}),l.jsx("button",{onClick:Oe,className:st.modalCreateBtn,children:"로그아웃"})]})]})}),te&&l.jsxs(l.Fragment,{children:[l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:999},onClick:Pr}),l.jsxs("div",{className:st.contextMenu,style:{position:"fixed",top:te.y,left:te.x,zIndex:1e3},children:[l.jsx("div",{className:st.contextMenuItem,onClick:()=>ws(te.fileId),children:"이름 변경"}),l.jsx("div",{className:st.contextMenuItem,onClick:()=>Vi(te.fileId),children:"삭제"})]})]}),console.log("🔍 moreMenu 상태:",Q),Q&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:st.moreMenuBackdrop,onClick:Rt}),l.jsxs("div",{className:st.moreMenu,style:{position:"fixed",top:Q.y,left:Q.x},children:[l.jsxs("div",{className:st.moreMenuItem,onClick:Xn,children:[l.jsx(Ty,{size:14}),"이름 바꾸기"]}),l.jsxs("div",{className:st.moreMenuItem,onClick:Jt,children:[l.jsx(B$,{size:14}),"복제하기"]}),l.jsxs("div",{className:st.moreMenuItem,onClick:tt,children:[l.jsx(U0,{size:14}),"공유하기"]}),(Q.itemType==="project"||Q.itemType==="design"||Q.itemType==="folder")&&l.jsxs("div",{className:st.moreMenuItem,onClick:()=>{Q.itemType==="project"?Cn(Q.itemId):Q.itemType==="design"?Rn(Q.itemId):Q.itemType==="folder"&&xn(Q.itemId),Rt()},children:[l.jsx(She,{size:14}),Q.itemType==="project"?Le.has(Q.itemId)?"북마크 해제":"북마크 추가":Q.itemType==="design"?ct.has(Q.itemId)?"북마크 해제":"북마크 추가":je.has(Q.itemId)?"북마크 해제":"북마크 추가"]}),l.jsxs("div",{className:`${st.moreMenuItem} ${st.deleteItem}`,onClick:()=>{if(Re==="trash")window.confirm("정말로 영구 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다.")&&Ui();else if(Q.itemType==="project"){const Ae=at.find(me=>me.id===Q.itemId);Ae&&(En(Ae),Rt())}else Ui()},children:[l.jsx(O0,{size:14}),Re==="trash"?"영구 삭제":"휴지통으로 이동"]}),Re==="trash"&&Q.itemType==="project"&&l.jsxs("div",{className:st.moreMenuItem,onClick:()=>{Hn(Q.itemId),Rt()},children:[l.jsx(E0,{size:14}),"복원하기"]})]})]}),z&&l.jsx("div",{className:st.modalOverlay,children:l.jsxs("div",{className:st.modal,children:[l.jsx("h2",{className:st.modalTitle,children:"새 폴더 생성"}),l.jsx("input",{type:"text",value:G,onChange:Ae=>ie(Ae.target.value),placeholder:"폴더 이름을 입력하세요",className:st.modalInput,onKeyPress:Ae=>{Ae.key==="Enter"&&G.trim()&&Mi()},autoFocus:!0}),l.jsxs("div",{className:st.modalActions,children:[l.jsx("button",{onClick:li,disabled:H,className:st.modalCancelBtn,children:"취소"}),l.jsx("button",{onClick:Mi,disabled:!G.trim()||H,className:st.modalCreateBtn,children:H?"생성 중...":"생성"})]})]})}),ce&&he&&l.jsx("div",{"data-theme":"light",style:{colorScheme:"light"},children:l.jsx(sE,{onClose:ke,projectId:he,projectTitle:Te||void 0})}),We&&l.jsx("div",{className:st.modalOverlay,children:l.jsxs("div",{className:st.modal,children:[l.jsx("h2",{className:st.modalTitle,children:"팀 관리"}),l.jsx("div",{className:st.teamModalContent,children:l.jsx("div",{className:st.teamList,children:l.jsxs("div",{className:st.teamEmpty,children:[l.jsx(Sy,{size:40}),l.jsx("p",{children:"아직 팀이 없습니다"}),l.jsxs("button",{className:st.createTeamBtn,onClick:()=>alert("팀 생성 기능은 준비 중입니다."),children:[l.jsx(Np,{size:16}),"새 팀 만들기"]})]})})}),l.jsx("div",{className:st.modalActions,children:l.jsx("button",{onClick:()=>De(!1),className:st.modalCancelBtn,children:"닫기"})})]})}),l.jsx(W7e,{isOpen:Be.isOpen,onClose:pt,projectId:Be.projectId,designFileId:Be.designFileId}),l.jsx(nF,{isOpen:rt,onClose:()=>Ve(!1)}),ce&&he&&l.jsx(sE,{onClose:ke,projectId:he,projectTitle:Te||void 0})]})},TOe="_viewerPage_1gu6b_2",BOe="_viewerHeader_1gu6b_12",EOe="_headerLeft_1gu6b_23",kOe="_projectTitle_1gu6b_29",IOe="_projectInfo_1gu6b_36",FOe="_headerCenter_1gu6b_41",DOe="_viewModeToggle_1gu6b_47",jOe="_viewModeButton_1gu6b_55",POe="_active_1gu6b_68",NOe="_headerActions_1gu6b_78",LOe="_actionButton_1gu6b_84",MOe="_shareButton_1gu6b_103",ROe="_viewerContent_1gu6b_124",OOe="_viewerFooter_1gu6b_133",UOe="_projectMeta_1gu6b_142",HOe="_errorState_1gu6b_148",WOe="_errorMessage_1gu6b_158",QOe="_retryButton_1gu6b_164",Qo={viewerPage:TOe,viewerHeader:BOe,headerLeft:EOe,projectTitle:kOe,projectInfo:IOe,headerCenter:FOe,viewModeToggle:DOe,viewModeButton:jOe,active:POe,headerActions:NOe,actionButton:LOe,shareButton:MOe,viewerContent:ROe,viewerFooter:OOe,projectMeta:UOe,errorState:HOe,errorMessage:WOe,retryButton:QOe},$Oe=()=>{var A;const{projectId:n}=RY(),[e,t]=O.useState(null),[i,r]=O.useState(!0),[s,o]=O.useState(null),[a,c]=O.useState("3D"),[h,u]=O.useState(!1);O.useEffect(()=>{n&&d()},[n]);const d=async()=>{var g,p,y,v,m,w,x,T,j,D,b,_,I;console.log("🔥 ViewerPage - loadProject 시작:",{projectId:n}),r(!0),o(null);try{if(n!=null&&n.startsWith("design_")){console.log("🔥 디자인 파일 로드 시도 (공유 링크):",n);const S=await RQ(n);if(console.log("🔥 디자인 파일 로드 결과 (공유 링크):",S),S.designFile){const F={id:S.designFile.projectId,title:S.designFile.name,createdAt:S.designFile.createdAt,updatedAt:S.designFile.updatedAt,furnitureCount:((p=(g=S.designFile.furniture)==null?void 0:g.placedModules)==null?void 0:p.length)||0,spaceSize:{width:((y=S.designFile.spaceConfig)==null?void 0:y.width)||3600,height:((v=S.designFile.spaceConfig)==null?void 0:v.height)||2400,depth:((m=S.designFile.spaceConfig)==null?void 0:m.depth)||1500},thumbnail:S.designFile.thumbnail,folderId:"",spaceInfo:S.designFile.spaceConfig,placedModules:((w=S.designFile.furniture)==null?void 0:w.placedModules)||[]};console.log("🔥 디자인 파일 로드 성공 (가구 포함):",{designFileId:n,name:S.designFile.name,placedModulesCount:((x=F.placedModules)==null?void 0:x.length)||0,placedModules:F.placedModules}),t(F)}else o(S.error||"디자인 파일을 찾을 수 없습니다.")}else{console.log("🔥 프로젝트 로드 시도 (공유 링크):",n);const S=await OQ(n);if(console.log("🔥 프로젝트 로드 결과 (공유 링크):",S),S.project){const F={id:S.project.id,title:S.project.title,createdAt:S.project.createdAt,updatedAt:S.project.updatedAt,furnitureCount:((T=S.project.stats)==null?void 0:T.furnitureCount)||0,spaceSize:{width:((j=S.project.spaceConfig)==null?void 0:j.width)||3600,height:((D=S.project.spaceConfig)==null?void 0:D.height)||2400,depth:((b=S.project.spaceConfig)==null?void 0:b.depth)||1500},thumbnail:S.project.thumbnail,folderId:S.project.folderId,spaceInfo:S.project.spaceConfig||{width:3600,height:2400,depth:1500,installType:"builtin",surroundType:"surround",baseConfig:{type:"floor",height:65,placementType:"ground"},hasFloorFinish:!1,floorFinish:null,wallConfig:{left:!0,right:!0,top:!0},materialConfig:{interiorColor:"#FFFFFF",doorColor:"#E0E0E0"},columns:[],frameSize:{upper:50,left:50,right:50},gapConfig:{left:2,right:2}},placedModules:((_=S.project.furniture)==null?void 0:_.placedModules)||[]};console.log("🔥 프로젝트 로드 성공 (가구 포함):",{title:F.title,placedModulesCount:((I=F.placedModules)==null?void 0:I.length)||0,placedModules:F.placedModules}),t(F)}else o(S.error||"프로젝트를 찾을 수 없습니다.")}}catch(S){console.error("프로젝트 로드 실패:",S),o("프로젝트를 불러오는 중 오류가 발생했습니다.")}finally{r(!1)}},f=()=>{document.fullscreenElement?(document.exitFullscreen(),u(!1)):(document.documentElement.requestFullscreen(),u(!0))};return i?l.jsx(Gm,{fullscreen:!0,message:"프로젝트를 불러오는 중..."}):s?l.jsxs("div",{className:Qo.errorState,children:[l.jsx("p",{className:Qo.errorMessage,children:s}),l.jsx("button",{onClick:d,className:Qo.retryButton,children:"다시 시도"})]}):e?l.jsxs("div",{className:Qo.viewerPage,children:[l.jsxs("div",{className:Qo.viewerHeader,children:[l.jsxs("div",{className:Qo.headerLeft,children:[l.jsx("h1",{className:Qo.projectTitle,children:e.title}),l.jsxs("span",{className:Qo.projectInfo,children:[a," 미리보기"]})]}),l.jsx("div",{className:Qo.headerCenter,children:l.jsxs("div",{className:Qo.viewModeToggle,children:[l.jsx("button",{className:`${Qo.viewModeButton} ${a==="2D"?Qo.active:""}`,onClick:()=>c("2D"),children:"2D"}),l.jsx("button",{className:`${Qo.viewModeButton} ${a==="3D"?Qo.active:""}`,onClick:()=>c("3D"),children:"3D"})]})}),l.jsxs("div",{className:Qo.headerActions,children:[l.jsx("button",{className:Qo.actionButton,onClick:f,title:h?"창 모드":"전체화면",children:h?l.jsx(k$,{size:20}):l.jsx(E$,{size:20})}),l.jsx("button",{className:Qo.shareButton,onClick:()=>{const g=window.location.href;navigator.clipboard.writeText(g).then(()=>{alert(`공유 링크가 클립보드에 복사되었습니다!
${g}`)}).catch(()=>{prompt("공유 링크를 복사하세요:",g)})},children:"공유하기"})]})]}),l.jsxs("div",{className:Qo.viewerContent,children:[console.log("🔥 ViewerPage 렌더링 - Space3DViewerReadOnly props:",{projectId:n,viewMode:a,hasSpaceConfig:!!e.spaceInfo,placedModulesCount:((A=e.placedModules)==null?void 0:A.length)||0,placedModules:e.placedModules}),l.jsx(Bq,{spaceConfig:e.spaceInfo,placedModules:e.placedModules||[],viewMode:a,renderMode:"solid"},`${n}-${a}`)]}),l.jsx("div",{className:Qo.viewerFooter,children:l.jsx("div",{className:Qo.projectMeta,children:l.jsxs("span",{children:["마지막 수정: ",(()=>{if(e.updatedAt)try{const g=e.updatedAt.seconds?new Date(e.updatedAt.seconds*1e3):new Date(e.updatedAt),y=Math.floor((new Date().getTime()-g.getTime())/(1e3*60*60));return y<1?"방금 전":y<24?`${y}시간 전`:y<168?`${Math.floor(y/24)}일 전`:g.toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})}catch(g){return console.error("날짜 변환 오류:",g),"알 수 없음"}if(e.createdAt)try{return(e.createdAt.seconds?new Date(e.createdAt.seconds*1e3):new Date(e.createdAt)).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})}catch(g){console.error("생성일 변환 오류:",g)}return"알 수 없음"})()]})})})]}):l.jsx("div",{className:Qo.errorState,children:l.jsx("p",{className:Qo.errorMessage,children:"프로젝트를 찾을 수 없습니다."})})},VOe="_button_10s4q_1",zOe="_primary_10s4q_22",GOe="_disabled_10s4q_27",XOe="_secondary_10s4q_31",KOe="_danger_10s4q_41",qOe="_small_10s4q_51",YOe="_medium_10s4q_56",ZOe="_large_10s4q_61",kb={button:VOe,primary:zOe,disabled:GOe,secondary:XOe,danger:KOe,small:qOe,medium:YOe,large:ZOe},$6=({variant:n="primary",size:e="medium",children:t,className:i="",disabled:r=!1,...s})=>{const o=[kb.button,kb[n],kb[e],r?kb.disabled:"",i].filter(Boolean).join(" ");return l.jsx("button",{className:o,disabled:r,...s,children:t})},JOe="_loginForm_1vb50_1",eUe="_container_1vb50_36",tUe="_input_1vb50_63",nUe="_logoSection_1vb50_128",iUe="_logo_1vb50_128",rUe="_logoIcon_1vb50_142",sUe="_logoText_1vb50_156",oUe="_title_1vb50_162",aUe="_form_1vb50_170",lUe="_inputGroup_1vb50_177",cUe="_label_1vb50_183",hUe="_passwordWrapper_1vb50_213",uUe="_passwordToggle_1vb50_217",dUe="_optionsRow_1vb50_234",AUe="_checkboxLabel_1vb50_241",fUe="_checkbox_1vb50_241",pUe="_checkboxText_1vb50_260",gUe="_forgotPassword_1vb50_265",mUe="_error_1vb50_282",yUe="_loginButton_1vb50_293",vUe="_divider_1vb50_336",wUe="_snsSection_1vb50_363",xUe="_snsTitle_1vb50_368",bUe="_snsButtons_1vb50_374",_Ue="_snsButton_1vb50_374",CUe="_snsIcon_1vb50_417",SUe="_demoButton_1vb50_424",as={loginForm:JOe,container:eUe,input:tUe,logoSection:nUe,logo:iUe,logoIcon:rUe,logoText:sUe,title:oUe,form:aUe,inputGroup:lUe,label:cUe,passwordWrapper:hUe,passwordToggle:uUe,optionsRow:dUe,checkboxLabel:AUe,checkbox:fUe,checkboxText:pUe,forgotPassword:gUe,error:mUe,loginButton:yUe,divider:vUe,snsSection:wUe,snsTitle:xUe,snsButtons:bUe,snsButton:_Ue,snsIcon:CUe,demoButton:SUe},TUe=({onSuccess:n})=>{const e=xc(),{user:t,loading:i}=ec(),[r,s]=O.useState(""),[o,a]=O.useState(""),[c,h]=O.useState(""),[u,d]=O.useState(!1),[f,A]=O.useState(!1),[g,p]=O.useState(null),[y,v]=O.useState(!1),[m,w]=O.useState(!1);O.useEffect(()=>{const b=document.documentElement,_={background:getComputedStyle(b).getPropertyValue("--theme-background"),text:getComputedStyle(b).getPropertyValue("--theme-text"),surface:getComputedStyle(b).getPropertyValue("--theme-surface"),mode:getComputedStyle(b).getPropertyValue("--theme-mode")};b.style.setProperty("--theme-background","#ffffff","important"),b.style.setProperty("--theme-text","#333333","important"),b.style.setProperty("--theme-surface","#ffffff","important"),b.style.setProperty("--theme-mode","light","important"),Array.from(document.body.classList).filter(V=>V.includes("dark")).forEach(V=>document.body.classList.remove(V));const F=()=>{const V=document.querySelector(`.${as.loginForm}`);V&&(V.style.setProperty("--theme-background","#ffffff","important"),V.style.setProperty("--theme-text","#333333","important"),V.style.setProperty("--theme-surface","#ffffff","important"),V.querySelectorAll("input").forEach(P=>{P.style.backgroundColor="white",P.style.color="#333",P.style.setProperty("background-color","white","important"),P.style.setProperty("color","#333","important"),P.style.setProperty("-webkit-text-fill-color","#333","important")}))};F();const B=new MutationObserver(()=>{F()}),E=document.querySelector(`.${as.loginForm}`);return E&&B.observe(E,{attributes:!0,attributeFilter:["style","class"],childList:!0,subtree:!0}),()=>{B.disconnect(),b.style.setProperty("--theme-background",_.background),b.style.setProperty("--theme-text",_.text),b.style.setProperty("--theme-surface",_.surface),b.style.setProperty("--theme-mode",_.mode)}},[]),O.useEffect(()=>{if(t&&!i){console.log("✅ 로그인된 상태 감지, 홈페이지로 이동합니다.");const b=setTimeout(()=>{e("/")},1e3);return()=>clearTimeout(b)}},[t,i,e]);const x=async b=>{b.preventDefault(),A(!0),p(null);try{let _;u?_=await zm(r,o,c):_=await $m(r,o),_.error?p(_.error):_.user&&(console.log("✅ 인증 성공:",_.user.email),n==null||n())}catch(_){p("예상치 못한 오류가 발생했습니다."),console.error("인증 에러:",_)}finally{A(!1)}},T=async()=>{A(!0),p(null);try{const b=await Vm();b.error?p(b.error):b.user&&(console.log("✅ 구글 로그인 성공:",b.user.email),n==null||n())}catch(b){p("구글 로그인 중 오류가 발생했습니다."),console.error("구글 로그인 에러:",b)}finally{A(!1)}},j=()=>{console.log("🎨 데모 모드로 에디터 접속"),e("/configurator")},D=()=>{console.log("카카오 로그인 (데모)"),j()};return l.jsx("div",{className:as.loginForm,children:l.jsxs("div",{className:as.container,children:[l.jsx("div",{className:as.logoSection,children:l.jsxs("div",{className:as.logo,children:[l.jsx("span",{className:as.logoIcon,children:"✨"}),l.jsx("span",{className:as.logoText,children:"MOHEIM"})]})}),l.jsx("h2",{className:as.title,children:"Welcome Back"}),l.jsx("p",{style:{textAlign:"center",color:"#666",fontSize:"14px",marginTop:"-20px",marginBottom:"30px"},children:"로그인하여 계속 진행하세요"}),l.jsxs("form",{onSubmit:x,className:as.form,children:[l.jsxs("div",{className:as.inputGroup,children:[l.jsx("label",{className:as.label,children:"이메일 주소"}),l.jsx("input",{type:"email",placeholder:"your@email.com",value:r,onChange:b=>s(b.target.value),required:!0,className:as.input,style:{background:"white",color:"#333"}})]}),l.jsxs("div",{className:as.inputGroup,children:[l.jsx("label",{className:as.label,children:"비밀번호"}),l.jsxs("div",{className:as.passwordWrapper,children:[l.jsx("input",{type:m?"text":"password",placeholder:"비밀번호 입력",value:o,onChange:b=>a(b.target.value),required:!0,className:as.input,style:{background:"white",color:"#333"}}),l.jsx("button",{type:"button",className:as.passwordToggle,onClick:()=>w(!m),"aria-label":m?"비밀번호 숨기기":"비밀번호 보기",children:m?l.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),l.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):l.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),l.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})]})]}),l.jsxs("div",{className:as.optionsRow,children:[l.jsxs("label",{className:as.checkboxLabel,children:[l.jsx("input",{type:"checkbox",checked:y,onChange:b=>v(b.target.checked),className:as.checkbox}),l.jsx("span",{className:as.checkboxText,children:"로그인 유지"})]}),l.jsx("button",{type:"button",className:as.forgotPassword,children:"비밀번호 찾기 >"})]}),g&&l.jsx("div",{className:as.error,children:g}),l.jsx($6,{type:"submit",disabled:f,className:as.loginButton,children:f?"처리 중...":"로그인"})]}),l.jsx("div",{className:as.divider,children:l.jsx("span",{children:"또는"})}),l.jsxs("div",{className:as.snsSection,children:[l.jsx("p",{className:as.snsTitle,children:"SNS 계정으로 3초만에 가입하기"}),l.jsxs("div",{className:as.snsButtons,children:[l.jsx("button",{type:"button",className:as.snsButton,onClick:D,style:{backgroundColor:"#fee500"},"aria-label":"카카오로 로그인",children:l.jsx("span",{className:as.snsIcon,style:{color:"#3c1e1e"},children:"K"})}),l.jsx("button",{type:"button",className:as.snsButton,onClick:T,style:{backgroundColor:"#fff",border:"1px solid #dadce0"},"aria-label":"구글로 로그인",children:l.jsxs("svg",{className:as.snsIcon,width:"20",height:"20",viewBox:"0 0 24 24",children:[l.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),l.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),l.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),l.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})})]})]}),l.jsx($6,{onClick:j,className:as.demoButton,children:"데모 체험하기"}),l.jsxs("p",{style:{textAlign:"center",marginTop:"20px",color:"#666",fontSize:"14px"},children:["처음이신가요? "," ",l.jsx("a",{href:"#",style:{color:"#667eea",textDecoration:"none",fontWeight:"500"},onClick:b=>{b.preventDefault(),d(!0)},children:"회원가입"})]})]})})},BUe=()=>{const n=xc(),{user:e}=ec(),[t,i]=O.useState(""),[r,s]=O.useState(""),[o,a]=O.useState(""),[c,h]=O.useState(!1),[u,d]=O.useState(!1),[f,A]=O.useState(null),[g,p]=O.useState(!1),y=async m=>{m.preventDefault(),d(!0),A(null);try{const w=c?await zm(t,r,o):await $m(t,r);w.error?A(w.error):w.user&&n("/")}catch{A("예상치 못한 오류가 발생했습니다.")}finally{d(!1)}},v=async()=>{d(!0),A(null);try{const m=await Vm();m.error?A(m.error):m.user&&n("/")}catch{A("구글 로그인 중 오류가 발생했습니다.")}finally{d(!1)}};return l.jsxs("div",{className:"min-h-screen relative flex items-center justify-center overflow-hidden bg-gradient-to-br from-purple-50 via-pink-50 to-blue-50",children:[l.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[l.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-purple-300 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob"}),l.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-pink-300 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-2000"}),l.jsx("div",{className:"absolute top-40 left-40 w-80 h-80 bg-blue-300 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-4000"})]}),l.jsx(Xi.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"relative z-10 w-full max-w-md p-8 mx-4",children:l.jsxs("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl shadow-2xl p-8 border border-white/20",children:[l.jsx(Xi.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"flex justify-center mb-8",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-600 to-pink-600 rounded-xl flex items-center justify-center shadow-lg",children:l.jsx(Ly,{className:"w-6 h-6 text-white"})}),l.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"MOHEIM"})]})}),l.jsxs(Xi.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"text-center mb-8",children:[l.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:c?"계정 만들기":"다시 만나서 반가워요"}),l.jsx("p",{className:"text-gray-600",children:c?"새로운 여정을 시작해보세요":"계속해서 멋진 공간을 만들어보세요"})]}),l.jsxs("form",{onSubmit:y,className:"space-y-6",children:[l.jsx(Cv,{mode:"wait",children:c&&l.jsx(Xi.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"relative",children:l.jsx("input",{type:"text",placeholder:"이름",value:o,onChange:m=>a(m.target.value),className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",required:!0})})}),l.jsxs("div",{className:"relative",children:[l.jsx(Vz,{className:"absolute left-4 top-3.5 w-5 h-5 text-gray-400"}),l.jsx("input",{type:"email",placeholder:"이메일 주소",value:t,onChange:m=>i(m.target.value),className:"w-full pl-12 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",required:!0})]}),l.jsxs("div",{className:"relative",children:[l.jsx($z,{className:"absolute left-4 top-3.5 w-5 h-5 text-gray-400"}),l.jsx("input",{type:g?"text":"password",placeholder:"비밀번호",value:r,onChange:m=>s(m.target.value),className:"w-full pl-12 pr-12 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",required:!0}),l.jsx("button",{type:"button",onClick:()=>p(!g),className:"absolute right-4 top-3.5 text-gray-400 hover:text-gray-600 transition-colors",children:g?l.jsx(YI,{className:"w-5 h-5"}):l.jsx(ZI,{className:"w-5 h-5"})})]}),l.jsxs("div",{className:"flex items-center justify-between text-sm",children:[l.jsxs("label",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",className:"mr-2 rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),l.jsx("span",{className:"text-gray-600",children:"로그인 상태 유지"})]}),l.jsx("a",{href:"#",className:"text-purple-600 hover:text-purple-700 font-medium",children:"비밀번호 찾기"})]}),l.jsx(Cv,{children:f&&l.jsx(Xi.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"p-3 bg-red-50 border border-red-200 rounded-xl text-red-600 text-sm",children:f})}),l.jsx(Xi.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:u,className:"w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-3 rounded-xl font-medium shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:u?l.jsx(JI,{className:"w-5 h-5 animate-spin"}):l.jsxs(l.Fragment,{children:[c?l.jsx(Rwe,{className:"w-5 h-5"}):l.jsx(Qz,{className:"w-5 h-5"}),l.jsx("span",{children:c?"가입하기":"로그인"})]})})]}),l.jsxs("div",{className:"relative my-8",children:[l.jsx("div",{className:"absolute inset-0 flex items-center",children:l.jsx("div",{className:"w-full border-t border-gray-200"})}),l.jsx("div",{className:"relative flex justify-center text-sm",children:l.jsx("span",{className:"px-4 bg-white text-gray-500",children:"또는"})})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs(Xi.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:v,className:"w-full flex items-center justify-center space-x-3 py-3 border border-gray-200 rounded-xl hover:bg-gray-50 transition-all",children:[l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[l.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),l.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),l.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),l.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),l.jsx("span",{className:"text-gray-700 font-medium",children:"Google로 계속하기"})]}),l.jsxs(Xi.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>n("/configurator"),className:"w-full flex items-center justify-center space-x-3 py-3 border-2 border-purple-200 rounded-xl hover:bg-purple-50 transition-all group",children:[l.jsx(Ly,{className:"w-5 h-5 text-purple-600"}),l.jsx("span",{className:"text-purple-600 font-medium",children:"데모 체험하기"}),l.jsx(qI,{className:"w-4 h-4 text-purple-600 group-hover:translate-x-1 transition-transform"})]})]}),l.jsx("div",{className:"mt-8 text-center",children:l.jsxs("p",{className:"text-gray-600",children:[c?"이미 계정이 있으신가요?":"처음 오셨나요?"," ",l.jsx("button",{onClick:()=>h(!c),className:"text-purple-600 hover:text-purple-700 font-medium",children:c?"로그인":"가입하기"})]})})]})}),l.jsx("style",{jsx:!0,children:`
        @keyframes blob {
          0% { transform: translate(0px, 0px) scale(1); }
          33% { transform: translate(30px, -50px) scale(1.1); }
          66% { transform: translate(-20px, 20px) scale(0.9); }
          100% { transform: translate(0px, 0px) scale(1); }
        }
        .animate-blob {
          animation: blob 7s infinite;
        }
        .animation-delay-2000 {
          animation-delay: 2s;
        }
        .animation-delay-4000 {
          animation-delay: 4s;
        }
      `})]})},EUe=({index:n})=>{const e=Math.random()*100,t=Math.random()*100,i=Math.random()*5,r=15+Math.random()*20;return l.jsx(Xi.div,{className:"absolute w-1 h-1 bg-gradient-to-br from-purple-400 to-pink-400 rounded-full opacity-40",style:{left:`${e}%`,top:`${t}%`},animate:{y:[-20,-window.innerHeight-20],opacity:[0,1,1,0],scale:[0,1.5,1.5,0]},transition:{duration:r,delay:i,repeat:1/0,ease:"linear"}})},$T=({type:n,delay:e})=>{const t={circle:"rounded-full",hexagon:"clip-path-hexagon",triangle:"clip-path-triangle"};return l.jsx(Xi.div,{className:`absolute w-24 h-24 bg-gradient-to-br from-purple-400/10 to-pink-400/10 backdrop-blur-xl ${t[n]}`,initial:{opacity:0,scale:0},animate:{opacity:[.3,.6,.3],scale:[1,1.2,1],rotate:[0,180,360],x:[0,50,0],y:[0,-30,0]},transition:{duration:20,delay:e,repeat:1/0,ease:"easeInOut"},style:{left:`${Math.random()*80}%`,top:`${Math.random()*80}%`}})},kUe=()=>{const n=xc(),{user:e}=ec(),[t,i]=O.useState(""),[r,s]=O.useState(""),[o,a]=O.useState(""),[c,h]=O.useState(!1),[u,d]=O.useState(!1),[f,A]=O.useState(null),[g,p]=O.useState(!1),[y,v]=O.useState(null),[m,w]=O.useState({x:0,y:0}),x=MC(0),T=MC(0),j={damping:25,stiffness:200},D=nR(x,j),b=nR(T,j),_=ay(b,[-.5,.5],["17.5deg","-17.5deg"]),I=ay(D,[-.5,.5],["-17.5deg","17.5deg"]),S=ay(D,[-.5,.5],["0%","100%"]),F=ay(b,[-.5,.5],["0%","100%"]);O.useEffect(()=>{const K=P=>{const{clientX:M,clientY:X}=P,{innerWidth:Z,innerHeight:Q}=window,U=M/Z-.5,z=X/Q-.5;x.set(U),T.set(z),w({x:M,y:X})};return window.addEventListener("mousemove",K),()=>window.removeEventListener("mousemove",K)},[x,T]);const B=async K=>{K.preventDefault(),d(!0),A(null);try{const P=c?await zm(t,r,o):await $m(t,r);P.error?A(P.error):P.user&&n("/")}catch{A("예상치 못한 오류가 발생했습니다.")}finally{d(!1)}},E=async()=>{d(!0),A(null);try{const K=await Vm();K.error?A(K.error):K.user&&n("/")}catch{A("구글 로그인 중 오류가 발생했습니다.")}finally{d(!1)}},V=[{icon:l.jsx(Wwe,{className:"w-5 h-5"}),text:"초고속 3D 렌더링",color:"from-yellow-400 to-orange-400"},{icon:l.jsx(Kz,{className:"w-5 h-5"}),text:"안전한 데이터 보호",color:"from-blue-400 to-cyan-400"},{icon:l.jsx(Dve,{className:"w-5 h-5"}),text:"프리미엄 디자인 템플릿",color:"from-purple-400 to-pink-400"},{icon:l.jsx(Pve,{className:"w-5 h-5"}),text:"AI 기반 추천 시스템",color:"from-green-400 to-emerald-400"}];return l.jsxs("div",{className:"min-h-screen flex relative overflow-hidden bg-black",children:[l.jsx(Xi.div,{className:"absolute inset-0 opacity-50",style:{background:`radial-gradient(circle at ${S}% ${F}%, rgba(168, 85, 247, 0.4) 0%, transparent 50%)`}}),l.jsx("div",{className:"absolute inset-0 overflow-hidden",children:[...Array(50)].map((K,P)=>l.jsx(EUe,{index:P},P))}),l.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[l.jsx($T,{type:"circle",delay:0}),l.jsx($T,{type:"hexagon",delay:2}),l.jsx($T,{type:"triangle",delay:4})]}),l.jsx("div",{className:"flex-1 flex items-center justify-center p-8 relative z-10",children:l.jsxs(Xi.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},style:{rotateX:_,rotateY:I,transformStyle:"preserve-3d"},className:"relative w-full max-w-md",children:[l.jsx(Xi.div,{className:"absolute inset-0 bg-gradient-to-br from-purple-600/20 to-pink-600/20 rounded-3xl blur-xl",animate:{scale:[1,1.1,1],opacity:[.5,.8,.5]},transition:{duration:4,repeat:1/0,ease:"easeInOut"}}),l.jsxs("div",{className:"relative bg-gray-900/40 backdrop-blur-xl rounded-3xl p-8 border border-gray-800/50 shadow-2xl",children:[l.jsxs(Xi.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.1,type:"spring",stiffness:200},className:"text-center mb-8",children:[l.jsxs("div",{className:"inline-flex items-center space-x-3 mb-6",children:[l.jsxs(Xi.div,{className:"relative",whileHover:{scale:1.1,rotate:360},transition:{duration:.5},children:[l.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-500 rounded-2xl flex items-center justify-center shadow-2xl",children:l.jsx(Ly,{className:"w-8 h-8 text-white"})}),l.jsx(Xi.div,{className:"absolute -top-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-gray-900",animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0}})]}),l.jsx("span",{className:"text-4xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent",children:"MOHEIM"})]}),l.jsx(Xi.h1,{className:"text-3xl font-bold text-white mb-2",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:c?"미래를 디자인하세요":"다시 만나서 반가워요"}),l.jsx(Xi.p,{className:"text-gray-400",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:c?"AI와 함께하는 인테리어 혁명":"당신만의 공간이 기다리고 있습니다"})]}),l.jsxs("form",{onSubmit:B,className:"space-y-5",children:[l.jsx(Cv,{mode:"wait",children:c&&l.jsx(Xi.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:l.jsxs("div",{className:"relative group",children:[l.jsx(qve,{className:`absolute left-5 top-1/2 transform -translate-y-1/2 w-5 h-5 transition-all duration-300 ${y==="name"?"text-purple-400":"text-gray-500"}`}),l.jsx("input",{type:"text",placeholder:"이름",value:o,onChange:K=>a(K.target.value),onFocus:()=>v("name"),onBlur:()=>v(null),className:"w-full pl-14 pr-5 py-4 bg-gray-800/50 backdrop-blur-sm border border-gray-700 rounded-2xl focus:outline-none focus:border-purple-500 transition-all duration-300 text-white placeholder-gray-500",required:!0}),l.jsx(Xi.div,{className:"absolute inset-0 rounded-2xl bg-gradient-to-r from-purple-500/20 to-pink-500/20 opacity-0 group-hover:opacity-100 pointer-events-none",transition:{duration:.3}})]})})}),l.jsxs("div",{className:"relative group",children:[l.jsx(Vz,{className:`absolute left-5 top-1/2 transform -translate-y-1/2 w-5 h-5 transition-all duration-300 ${y==="email"||t?"text-purple-400":"text-gray-500"}`}),l.jsx("input",{type:"email",placeholder:" ",value:t,onChange:K=>i(K.target.value),onFocus:()=>v("email"),onBlur:()=>v(null),className:"peer w-full pl-14 pr-5 py-4 bg-gray-800/50 backdrop-blur-sm border border-gray-700 rounded-2xl focus:outline-none focus:border-purple-500 transition-all duration-300 text-white placeholder-transparent",required:!0}),l.jsx("label",{className:"absolute left-14 top-4 text-gray-500 transition-all duration-300 peer-placeholder-shown:top-4 peer-focus:top-1 peer-focus:text-xs peer-focus:text-purple-400 peer-[:not(:placeholder-shown)]:top-1 peer-[:not(:placeholder-shown)]:text-xs pointer-events-none",children:"이메일 주소"}),l.jsx(Xi.div,{className:"absolute inset-0 rounded-2xl bg-gradient-to-r from-purple-500/20 to-pink-500/20 opacity-0 group-hover:opacity-100 pointer-events-none",transition:{duration:.3}})]}),l.jsxs("div",{className:"relative group",children:[l.jsx($z,{className:`absolute left-5 top-1/2 transform -translate-y-1/2 w-5 h-5 transition-all duration-300 ${y==="password"||r?"text-purple-400":"text-gray-500"}`}),l.jsx("input",{type:g?"text":"password",placeholder:" ",value:r,onChange:K=>s(K.target.value),onFocus:()=>v("password"),onBlur:()=>v(null),className:"peer w-full pl-14 pr-14 py-4 bg-gray-800/50 backdrop-blur-sm border border-gray-700 rounded-2xl focus:outline-none focus:border-purple-500 transition-all duration-300 text-white placeholder-transparent",required:!0}),l.jsx("label",{className:"absolute left-14 top-4 text-gray-500 transition-all duration-300 peer-placeholder-shown:top-4 peer-focus:top-1 peer-focus:text-xs peer-focus:text-purple-400 peer-[:not(:placeholder-shown)]:top-1 peer-[:not(:placeholder-shown)]:text-xs pointer-events-none",children:"비밀번호"}),l.jsx(Xi.button,{type:"button",onClick:()=>p(!g),className:"absolute right-5 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-purple-400 transition-colors duration-300",whileHover:{scale:1.1},whileTap:{scale:.9},children:g?l.jsx(YI,{className:"w-5 h-5"}):l.jsx(ZI,{className:"w-5 h-5"})}),l.jsx(Xi.div,{className:"absolute inset-0 rounded-2xl bg-gradient-to-r from-purple-500/20 to-pink-500/20 opacity-0 group-hover:opacity-100 pointer-events-none",transition:{duration:.3}}),r&&l.jsx(Xi.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"absolute -bottom-6 left-0 right-0 flex space-x-1",children:[...Array(4)].map((K,P)=>l.jsx("div",{className:`h-1 flex-1 rounded-full transition-all duration-300 ${P<(r.length>12?4:r.length>8?3:r.length>5?2:1)?"bg-gradient-to-r from-purple-500 to-pink-500":"bg-gray-700"}`},P))})]}),l.jsxs("div",{className:"flex items-center justify-between text-sm pt-2",children:[l.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer group",children:[l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"checkbox",className:"sr-only peer"}),l.jsx("div",{className:"w-5 h-5 bg-gray-800 border border-gray-600 rounded-md peer-checked:bg-gradient-to-br peer-checked:from-purple-500 peer-checked:to-pink-500 peer-checked:border-transparent transition-all duration-300",children:l.jsx("svg",{className:"w-3 h-3 text-white absolute top-1 left-1 opacity-0 peer-checked:opacity-100 transition-opacity",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 111.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),l.jsx("span",{className:"text-gray-400 group-hover:text-gray-300 transition-colors select-none",children:"로그인 상태 유지"})]}),l.jsx(Xi.a,{href:"#",className:"text-purple-400 hover:text-pink-400 font-medium transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},children:"비밀번호 찾기"})]}),l.jsx(Cv,{children:f&&l.jsxs(Xi.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},className:"p-4 bg-red-500/10 backdrop-blur-sm border border-red-500/50 rounded-xl text-red-400 text-sm flex items-center space-x-2",children:[l.jsx("div",{className:"w-5 h-5 bg-red-500/20 rounded-full flex items-center justify-center flex-shrink-0",children:l.jsx("span",{className:"text-red-400 font-bold",children:"!"})}),l.jsx("span",{children:f})]})}),l.jsxs(Xi.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:u,className:"relative w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white py-4 rounded-2xl font-semibold text-lg shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed overflow-hidden group",children:[l.jsx(Xi.div,{className:"absolute inset-0 bg-gradient-to-r from-pink-500 to-purple-500",animate:{x:["0%","100%","0%"]},transition:{duration:3,repeat:1/0,ease:"linear"},style:{width:"200%"}}),l.jsx("div",{className:"relative flex items-center justify-center space-x-2",children:u?l.jsx(Xi.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:l.jsx(JI,{className:"w-5 h-5"})}):l.jsxs(l.Fragment,{children:[c?l.jsx(bwe,{className:"w-5 h-5"}):l.jsx(Qz,{className:"w-5 h-5"}),l.jsx("span",{children:c?"시작하기":"로그인"})]})}),l.jsx(Xi.div,{className:"absolute inset-0 bg-white/20 rounded-2xl",initial:{scale:0,opacity:1},whileHover:{scale:2,opacity:0},transition:{duration:.5}})]})]}),l.jsxs("div",{className:"relative my-8",children:[l.jsx(Xi.div,{className:"absolute inset-0 flex items-center",initial:{scaleX:0},animate:{scaleX:1},transition:{delay:.5,duration:.5},children:l.jsx("div",{className:"w-full border-t border-gray-700"})}),l.jsx("div",{className:"relative flex justify-center text-sm",children:l.jsx("span",{className:"px-4 bg-gray-900/40 backdrop-blur-sm text-gray-500",children:"또는"})})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs(Xi.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:E,className:"w-full flex items-center justify-center space-x-3 py-4 bg-white/10 backdrop-blur-sm border border-gray-700 rounded-2xl hover:bg-white/20 hover:border-gray-600 transition-all duration-300 group",children:[l.jsx(Xi.div,{whileHover:{rotate:360},transition:{duration:.5},children:l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[l.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),l.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),l.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),l.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}),l.jsx("span",{className:"text-gray-300 font-medium group-hover:text-white transition-colors",children:"Google로 계속하기"})]}),l.jsxs(Xi.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>n("/configurator"),className:"w-full flex items-center justify-center space-x-3 py-4 bg-gradient-to-r from-purple-500/20 to-pink-500/20 backdrop-blur-sm border border-purple-500/50 rounded-2xl hover:from-purple-500/30 hover:to-pink-500/30 transition-all duration-300 group",children:[l.jsx(Xi.div,{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl flex items-center justify-center shadow-lg",whileHover:{rotate:[0,-10,10,-10,0]},transition:{duration:.5},children:l.jsx(Ly,{className:"w-5 h-5 text-white"})}),l.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-400 font-semibold",children:"데모 체험하기"}),l.jsx(qI,{className:"w-4 h-4 text-purple-400 group-hover:translate-x-1 transition-transform"})]})]}),l.jsx(Xi.div,{className:"mt-8 text-center",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},children:l.jsxs("p",{className:"text-gray-400",children:[c?"이미 계정이 있으신가요?":"처음 오셨나요?"," ",l.jsx(Xi.button,{onClick:()=>h(!c),className:"text-purple-400 hover:text-pink-400 font-semibold transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},children:c?"로그인":"가입하기"})]})})]})]})}),l.jsxs("div",{className:"hidden lg:flex flex-1 bg-gradient-to-br from-purple-900/50 to-pink-900/50 backdrop-blur-sm items-center justify-center p-12 relative overflow-hidden",children:[l.jsx("div",{className:"absolute inset-0 opacity-20",children:l.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"linear-gradient(rgba(168, 85, 247, 0.3) 1px, transparent 1px), linear-gradient(90deg, rgba(168, 85, 247, 0.3) 1px, transparent 1px)",backgroundSize:"50px 50px",transform:`translate(${m.x*.05}px, ${m.y*.05}px)`}})}),l.jsx(Xi.div,{className:"absolute top-20 right-20",animate:{rotateY:[0,360],rotateZ:[0,10,0,-10,0]},transition:{rotateY:{duration:20,repeat:1/0,ease:"linear"},rotateZ:{duration:5,repeat:1/0,ease:"easeInOut"}},style:{transformStyle:"preserve-3d"},children:l.jsx("div",{className:"w-32 h-32 bg-gradient-to-br from-purple-500/30 to-pink-500/30 backdrop-blur-md rounded-2xl flex items-center justify-center",children:l.jsx(Ly,{className:"w-16 h-16 text-white/50"})})}),l.jsxs(Xi.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.3,duration:.5},className:"relative z-10 max-w-lg",children:[l.jsxs(Xi.h2,{className:"text-5xl font-bold text-white mb-6",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4},children:["AI가 만드는",l.jsx("br",{}),l.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-400",children:"완벽한 공간"})]}),l.jsxs(Xi.p,{className:"text-xl text-gray-300 mb-12",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.5},children:["최첨단 3D 기술과 인공지능이 결합된",l.jsx("br",{}),"차세대 인테리어 디자인 플랫폼"]}),l.jsx("div",{className:"space-y-6",children:V.map((K,P)=>l.jsxs(Xi.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.6+P*.1},whileHover:{x:10,scale:1.05},className:"flex items-center space-x-4 cursor-pointer",children:[l.jsx(Xi.div,{className:`w-14 h-14 bg-gradient-to-br ${K.color} rounded-xl flex items-center justify-center shadow-lg`,whileHover:{rotate:360},transition:{duration:.5},children:l.jsx("div",{className:"text-white",children:K.icon})}),l.jsxs("div",{children:[l.jsx("span",{className:"text-white text-lg font-medium",children:K.text}),l.jsx(Xi.div,{className:"h-0.5 bg-gradient-to-r from-purple-400 to-pink-400 mt-1",initial:{width:0},whileHover:{width:"100%"},transition:{duration:.3}})]})]},P))}),l.jsx(Xi.div,{className:"mt-12 grid grid-cols-3 gap-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1},children:[{value:"10K+",label:"활성 사용자"},{value:"50K+",label:"디자인 완성"},{value:"99%",label:"만족도"}].map((K,P)=>l.jsxs(Xi.div,{className:"text-center",whileHover:{scale:1.1},children:[l.jsx(Xi.div,{className:"text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-400",initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:1.2+P*.1,type:"spring"},children:K.value}),l.jsx("div",{className:"text-sm text-gray-400 mt-1",children:K.label})]},P))})]}),l.jsx(Xi.div,{className:"absolute bottom-20 left-20",animate:{y:[0,-30,0],rotate:[0,180,360]},transition:{duration:10,repeat:1/0,ease:"easeInOut"},children:l.jsx(Pwe,{className:"w-8 h-8 text-purple-400/50"})})]}),l.jsx("style",{jsx:!0,children:`
        .clip-path-hexagon {
          clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
        }
        .clip-path-triangle {
          clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
        }
      `})]})},IUe=()=>{const n=xc(),{user:e}=ec(),[t,i]=O.useState(""),[r,s]=O.useState(""),[o,a]=O.useState(""),[c,h]=O.useState(!1),[u,d]=O.useState(!1),[f,A]=O.useState(null),g=async y=>{y.preventDefault(),d(!0),A(null);try{const v=c?await zm(t,r,o):await $m(t,r);v.error?A(v.error):v.user&&n("/")}catch{A("예상치 못한 오류가 발생했습니다.")}finally{d(!1)}},p=async()=>{d(!0),A(null);try{const y=await Vm();y.error?A(y.error):y.user&&n("/")}catch{A("구글 로그인 중 오류가 발생했습니다.")}finally{d(!1)}};return l.jsxs("div",{className:"min-h-screen flex",children:[l.jsx("div",{className:"hidden lg:flex flex-1 bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-500 items-center justify-center p-12 text-white",children:l.jsxs("div",{className:"max-w-lg",children:[l.jsxs("div",{className:"flex items-center mb-12",children:[l.jsxs("svg",{className:"w-10 h-10 mr-3",viewBox:"0 0 24 24",fill:"none",children:[l.jsx("path",{d:"M12 2L2 7V12C2 16.5 4.23 20.68 7.62 23.15L12 26L16.38 23.15C19.77 20.68 22 16.5 22 12V7L12 2Z",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),l.jsx("path",{d:"M12 7V12L15 15",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),l.jsx("span",{className:"text-2xl font-bold",children:"MOHEIM"})]}),l.jsx("h1",{className:"text-5xl font-bold mb-6",children:"안녕하세요!"}),l.jsx("h2",{className:"text-3xl font-medium mb-8 text-white/90",children:"혁신적인 가구 디자인 시스템에 오신 것을 환영합니다!"}),l.jsx("p",{className:"text-lg text-white/80 leading-relaxed",children:"MOHEIM은 3D 기술과 AI를 활용하여 당신의 공간을 완벽하게 구현할 수 있는 모든 도구와 기능을 제공합니다. 지금 시작하세요!"})]})}),l.jsx("div",{className:"flex-1 flex items-center justify-center p-8 bg-gray-50",children:l.jsx(Xi.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full max-w-md",children:l.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl p-10",children:[l.jsx("h2",{className:"text-3xl font-bold text-center text-gray-900 mb-2",children:"돌아오신 것을 환영합니다"}),l.jsx("p",{className:"text-center text-gray-600 mb-8",children:"30일 무료 체험을 시작해보세요."}),l.jsxs("form",{onSubmit:g,className:"space-y-5",children:[c&&l.jsx("div",{children:l.jsx("input",{type:"text",placeholder:"이름",value:o,onChange:y=>a(y.target.value),className:"w-full px-5 py-4 bg-gray-50 border border-gray-200 rounded-2xl focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",required:!0})}),l.jsx("div",{children:l.jsx("input",{type:"email",placeholder:"이메일",value:t,onChange:y=>i(y.target.value),className:"w-full px-5 py-4 bg-gray-50 border border-gray-200 rounded-2xl focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",required:!0})}),l.jsx("div",{children:l.jsx("input",{type:"password",placeholder:"비밀번호",value:r,onChange:y=>s(y.target.value),className:"w-full px-5 py-4 bg-gray-50 border border-gray-200 rounded-2xl focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",required:!0})}),!c&&l.jsx("div",{className:"text-right",children:l.jsx("a",{href:"#",className:"text-purple-600 text-sm hover:text-purple-700 transition-colors",children:"비밀번호를 잊으셨나요?"})}),f&&l.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-xl text-red-600 text-sm",children:f}),l.jsx("button",{type:"submit",disabled:u,className:"w-full py-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-2xl font-semibold text-lg hover:from-purple-700 hover:to-pink-700 transition-all transform hover:scale-[1.02] disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:u?l.jsx(JI,{className:"w-5 h-5 animate-spin"}):c?"가입하기":"로그인"})]}),l.jsxs("div",{className:"relative my-8",children:[l.jsx("div",{className:"absolute inset-0 flex items-center",children:l.jsx("div",{className:"w-full border-t border-gray-200"})}),l.jsx("div",{className:"relative flex justify-center text-sm",children:l.jsx("span",{className:"px-4 bg-white text-gray-400",children:"또는"})})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("button",{onClick:p,className:"w-full flex items-center justify-center space-x-3 py-4 bg-white border border-gray-200 rounded-2xl hover:bg-gray-50 transition-colors",children:[l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[l.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),l.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),l.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),l.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),l.jsx("span",{className:"text-gray-700 font-medium",children:"Google"})]}),l.jsxs("button",{onClick:()=>n("/configurator"),className:"w-full flex items-center justify-center space-x-3 py-4 bg-white border border-gray-200 rounded-2xl hover:bg-gray-50 transition-colors",children:[l.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55 0-1 .45-1 1v2h3l-.5 3H13v6.95c5.05-.5 9-4.76 9-9.95z"})}),l.jsx("span",{className:"text-gray-700 font-medium",children:"데모 체험하기"})]})]}),l.jsxs("p",{className:"text-center mt-8 text-gray-600",children:["계정이 없으신가요?"," ",l.jsx("button",{onClick:()=>h(!c),className:"text-purple-600 font-semibold hover:text-purple-700 transition-colors",children:c?"로그인":"가입하기"})]})]})})}),l.jsx("div",{className:"lg:hidden fixed inset-0 bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-500 -z-10"})]})};function Ib({position:n,color:e,scale:t=1}){const i=O.useRef(null),{mouse:r}=jl();return QC(s=>{if(!i.current)return;const o=r.x*s.viewport.width/2,a=r.y*s.viewport.height/2;i.current.position.x=n[0]+o*.1,i.current.position.y=n[1]+a*.1,i.current.rotation.x+=.01,i.current.rotation.y+=.01}),l.jsx(DY,{speed:2,rotationIntensity:.5,floatIntensity:.5,floatingRange:[-.1,.1],children:l.jsxs("mesh",{ref:i,position:n,scale:t,children:[l.jsx("icosahedronGeometry",{args:[1,4]}),l.jsx(jY,{color:e,speed:5,distort:.3,radius:1,opacity:.8,transparent:!0})]})})}function FUe(){const n=O.useRef(null),e=100,t=ii.useMemo(()=>{const i=new Float32Array(e*3);for(let r=0;r<e;r++)i[r*3]=(Math.random()-.5)*10,i[r*3+1]=(Math.random()-.5)*10,i[r*3+2]=(Math.random()-.5)*10;return i},[]);return QC(i=>{n.current&&(n.current.rotation.x=i.clock.elapsedTime*.05,n.current.rotation.y=i.clock.elapsedTime*.05)}),l.jsxs("points",{ref:n,children:[l.jsx("bufferGeometry",{children:l.jsx("bufferAttribute",{attach:"attributes-position",count:e,array:t,itemSize:3})}),l.jsx("pointsMaterial",{size:.05,color:"#ffffff",opacity:.6,transparent:!0,sizeAttenuation:!0})]})}function DUe(){return l.jsxs(l.Fragment,{children:[l.jsx("ambientLight",{intensity:.5}),l.jsx("pointLight",{position:[10,10,10],intensity:1}),l.jsx("pointLight",{position:[-10,-10,-10],intensity:.5,color:"#764ba2"}),l.jsx(Ib,{position:[-2,2,0],color:"#764ba2",scale:1.5}),l.jsx(Ib,{position:[3,-1,-2],color:"#667eea",scale:1}),l.jsx(Ib,{position:[-3,-2,1],color:"#8b5cf6",scale:.8}),l.jsx(Ib,{position:[2,1,-1],color:"#a78bfa",scale:1.2}),l.jsx(FUe,{}),l.jsx("fog",{attach:"fog",args:["#6B5EFF",5,15]})]})}const jUe=()=>l.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:0},children:l.jsx(WO,{camera:{position:[0,0,5],fov:75},style:{background:"transparent"},children:l.jsx(DUe,{})})}),PUe="_container_91gbt_1",NUe="_leftPanel_91gbt_11",LUe="_leftContent_91gbt_57",MUe="_logo_91gbt_65",RUe="_welcomeTitle_91gbt_80",OUe="_welcomeSubtitle_91gbt_88",UUe="_rightPanel_91gbt_105",HUe="_formContainer_91gbt_114",WUe="_formTitle_91gbt_124",QUe="_formSubtitle_91gbt_132",$Ue="_form_91gbt_114",VUe="_input_91gbt_152",zUe="_forgotPasswordWrapper_91gbt_174",GUe="_forgotPassword_91gbt_174",XUe="_error_91gbt_192",KUe="_loginButton_91gbt_203",qUe="_divider_91gbt_233",YUe="_socialButtons_91gbt_262",ZUe="_socialButton_91gbt_262",JUe="_socialIcon_91gbt_297",eHe="_googleButton_91gbt_302",tHe="_signupPrompt_91gbt_308",nHe="_signupLink_91gbt_314",iHe="_demoSection_91gbt_326",rHe="_demoButton_91gbt_330",_s={container:PUe,leftPanel:NUe,leftContent:LUe,logo:MUe,welcomeTitle:RUe,welcomeSubtitle:OUe,rightPanel:UUe,formContainer:HUe,formTitle:WUe,formSubtitle:QUe,form:$Ue,input:VUe,forgotPasswordWrapper:zUe,forgotPassword:GUe,error:XUe,loginButton:KUe,divider:qUe,socialButtons:YUe,socialButton:ZUe,socialIcon:JUe,googleButton:eHe,signupPrompt:tHe,signupLink:nHe,demoSection:iHe,demoButton:rHe},oR=({onSuccess:n})=>{const e=xc(),{user:t,loading:i}=ec(),[r,s]=O.useState(""),[o,a]=O.useState(""),[c,h]=O.useState(""),[u,d]=O.useState(!1),[f,A]=O.useState(!1),[g,p]=O.useState(null),[y,v]=O.useState(!1),[m,w]=O.useState(""),[x,T]=O.useState(!1);console.log("🔍 SplitLoginForm 상태:",{user:t==null?void 0:t.email,authLoading:i,path:window.location.pathname}),O.useEffect(()=>{console.log("🔍 로그인 상태:",{user:t==null?void 0:t.email,authLoading:i})},[t,i]),O.useEffect(()=>{(async()=>{const S=await fQ();S.user?(console.log("✅ Google 리다이렉트 로그인 성공"),e("/dashboard")):S.error&&p(S.error)})()},[e]);const j=async I=>{I.preventDefault(),A(!0),p(null);try{let S;u?S=await zm(r,o,c):S=await $m(r,o),S.error?p(S.error):S.user&&(console.log("✅ 인증 성공:",S.user.email),n==null||n(),e("/dashboard"))}catch(S){p("예상치 못한 오류가 발생했습니다."),console.error("인증 에러:",S)}finally{A(!1)}},D=()=>!0,b=async()=>{A(!0),p(null),console.log("🔍 구글 로그인 시도..."),console.log("🔍 Firebase 설정 상태:",D());try{console.log("🔍 signInWithGoogle 호출...");const I=await Vm();I.error?(console.error("❌ 구글 로그인 실패:",I.error),p(I.error)):I.user&&(console.log("✅ 구글 로그인 성공:",I.user.email),e("/dashboard"))}catch(I){console.error("❌ 구글 로그인 예외 발생:",I),p("구글 로그인 중 오류가 발생했습니다. 잠시 후 다시 시도해주세요.")}finally{A(!1)}},_=()=>{console.log("Facebook 로그인 (데모)"),e("/configurator")};return l.jsxs("div",{className:_s.container,children:[l.jsx(jUe,{}),l.jsx("div",{className:_s.leftPanel,children:l.jsxs("div",{className:_s.leftContent,children:[l.jsx("div",{className:_s.logo,children:l.jsx(V5,{size:"large"})}),l.jsx("h1",{className:_s.welcomeTitle,children:"Hey, Hello!"}),l.jsx("p",{className:_s.welcomeSubtitle,children:"Join The Waitlist For The Design System!"})]})}),l.jsx("div",{className:_s.rightPanel,children:l.jsxs("div",{className:_s.formContainer,children:[l.jsx("h2",{className:_s.formTitle,children:"Welcome Back"}),l.jsx("p",{className:_s.formSubtitle,children:"Let's get started with your 30 days free trial."}),l.jsxs("form",{onSubmit:j,className:_s.form,children:[u&&l.jsx(vy,{type:"text",placeholder:"Name",value:c,onChange:I=>h(I.target.value),required:!0,className:_s.input}),l.jsx(vy,{type:"email",placeholder:"Username",value:r,onChange:I=>s(I.target.value),required:!0,className:_s.input}),l.jsx(vy,{type:"password",placeholder:"Password",value:o,onChange:I=>a(I.target.value),required:!0,className:_s.input}),!u&&l.jsx("div",{className:_s.forgotPasswordWrapper,children:l.jsx("a",{href:"#",className:_s.forgotPassword,children:"Forgot Password?"})}),g&&l.jsx("div",{className:_s.error,children:g}),l.jsx($6,{type:"submit",disabled:f,className:_s.loginButton,children:f?"Processing...":"Login"})]}),l.jsx("div",{className:_s.divider,children:l.jsx("span",{children:"OR"})}),l.jsxs("div",{className:_s.socialButtons,children:[l.jsxs("button",{type:"button",className:`${_s.socialButton} ${_s.googleButton}`,onClick:b,disabled:f,children:[l.jsxs("svg",{className:_s.socialIcon,viewBox:"0 0 24 24",children:[l.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),l.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),l.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),l.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),l.jsx("span",{children:"Google"})]}),l.jsxs("button",{type:"button",className:`${_s.socialButton} ${_s.facebookButton}`,onClick:_,disabled:f,children:[l.jsx("svg",{className:_s.socialIcon,viewBox:"0 0 24 24",children:l.jsx("path",{fill:"#1877F2",d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),l.jsx("span",{children:"Facebook"})]})]}),l.jsxs("div",{className:_s.demoSection,children:[l.jsx("div",{className:_s.divider,children:l.jsx("span",{children:"또는"})}),l.jsx("button",{type:"button",className:_s.demoButton,onClick:()=>e("/configurator"),children:"데모체험하기"})]}),l.jsxs("p",{className:_s.signupPrompt,children:[u?"이미 계정이 있으신가요?":"Don't have an account?"," ",l.jsx("a",{href:"#",className:_s.signupLink,onClick:I=>{I.preventDefault(),d(!u),p(null)},children:u?"Login":"Sign Up"})]})]})})]})},sHe=()=>{const[n,e]=O.useState([]),[t,i]=O.useState(!1),[r,s]=O.useState(null),[o,a]=O.useState(null),c=async()=>{i(!0),s(null);try{const d=await mr();if(!d){s("사용자가 로그인되지 않았습니다.");return}const f=ph(Ua(Ri,"projects"),Ca("userId","==",d.uid)),A=await Mu(f),g=[];A.forEach(y=>{const v=y.data();g.push({id:y.id,title:v.title||"Unknown",data:v})}),e(g);const p=g.find(y=>y.title.includes("위시티자이"));p&&a(p)}catch(d){console.error("Firebase 데이터 조회 실패:",d),s("데이터를 불러오는 중 오류가 발생했습니다.")}finally{i(!1)}};O.useEffect(()=>{c()},[]);const h=(d,f,A="")=>{const g=[];return Object.keys(f).forEach(p=>{const y=A?`${A}.${p}`:p,v=d&&d.hasOwnProperty(p),m=v?typeof d[p]:"undefined",w=typeof f[p];g.push({path:y,status:v?"✅ 존재":"❌ 없음",type:m,expected:w}),v&&typeof d[p]=="object"&&d[p]!==null&&typeof f[p]=="object"&&!Array.isArray(f[p])&&g.push(...h(d[p],f[p],y))}),g},u={id:"string",userId:"string",basicInfo:{title:"string",location:"string",createdAt:"object",updatedAt:"object",version:"string",description:"string",customerInfo:{name:"string",phone:"string",email:"string"}},spaceConfig:{dimensions:{width:"number",height:"number",depth:"number"},installType:"string",wallPosition:"string",damper:{agentPosition:"string",size:{width:"number",height:"number"}},floorFinish:{enabled:"boolean",height:"number"}},customLayout:{wall:{type:"string",completed:"boolean"},rack:{thickness:"string",completed:"boolean"},motor:{topHeight:"number",completed:"boolean"},ventilation:{type:"string",completed:"boolean"},exhaust:{height:"number",completed:"boolean",fromFloor:"boolean"}},metadata:{status:"string",priority:"string",tags:"object",isFavorite:"boolean"},stats:{designFileCount:"number",furnitureCount:"number",completionRate:"number"}};return l.jsxs("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"white",zIndex:9999,overflow:"auto",padding:"20px",fontFamily:"monospace"},children:[l.jsx("h1",{children:"🔍 Firebase 데이터 구조 분석"}),l.jsx("button",{onClick:c,disabled:t,children:t?"로딩 중...":"프로젝트 새로고침"}),r&&l.jsxs("div",{style:{color:"red",margin:"10px 0"},children:["❌ ",r]}),l.jsxs("div",{style:{margin:"20px 0"},children:[l.jsxs("h2",{children:["📋 프로젝트 목록 (",n.length,"개)"]}),n.map(d=>l.jsxs("div",{style:{padding:"10px",border:(o==null?void 0:o.id)===d.id?"2px solid blue":"1px solid #ccc",margin:"5px 0",cursor:"pointer"},onClick:()=>a(d),children:[l.jsx("strong",{children:d.title})," (ID: ",d.id,")"]},d.id))]}),o&&l.jsxs("div",{children:[l.jsxs("h2",{children:["🎯 선택된 프로젝트: ",o.title]}),l.jsx("h3",{children:"📄 실제 데이터 구조"}),l.jsx("pre",{style:{background:"#f5f5f5",padding:"10px",overflow:"auto",maxHeight:"300px",fontSize:"12px"},children:JSON.stringify(o.data,null,2)}),l.jsx("h3",{children:"🔍 구조 분석 (새 스키마 vs 실제 데이터)"}),l.jsx("div",{style:{background:"#f9f9f9",padding:"10px"},children:h(o.data,u).map((d,f)=>l.jsxs("div",{style:{padding:"5px 0",borderBottom:"1px solid #eee",fontSize:"14px"},children:[l.jsxs("strong",{children:[d.path,":"]})," ",d.status,l.jsxs("span",{style:{color:"#666",marginLeft:"10px"},children:["실제: ",d.type," | 예상: ",d.expected]})]},f))}),l.jsx("h3",{children:"📊 현재 사용 중인 구조 (기존 스키마)"}),l.jsxs("div",{style:{background:"#fff3cd",padding:"10px"},children:[l.jsx("p",{children:l.jsx("strong",{children:"현재 데이터 필드들:"})}),l.jsx("ul",{children:Object.keys(o.data).map(d=>l.jsxs("li",{children:[l.jsxs("strong",{children:[d,":"]})," ",typeof o.data[d],o.data[d]&&typeof o.data[d]=="object"&&l.jsxs("span",{children:[" (keys: ",Object.keys(o.data[d]).join(", "),")"]})]},d))})]})]}),l.jsxs("div",{style:{marginTop:"20px",padding:"10px",background:"#e7f3ff"},children:[l.jsx("h3",{children:"📝 분석 요약"}),l.jsx("p",{children:"이 디버그 도구는 현재 Firebase에 저장된 실제 데이터 구조와 새로운 TypeScript 인터페이스를 비교합니다."}),l.jsx("p",{children:"빨간색(❌)으로 표시된 필드들은 새 스키마에서 정의되었지만 실제 데이터에는 없는 필드들입니다."})]})]})},oHe="_container_wopq3_3",aHe="_projectSelector_wopq3_18",lHe="_projectList_wopq3_33",cHe="_projectButton_wopq3_39",hHe="_selected_wopq3_55",uHe="_projectInfo_wopq3_60",dHe="_projectStats_wopq3_76",AHe="_missingCount_wopq3_81",fHe="_unexpectedCount_wopq3_90",pHe="_selectedProject_wopq3_99",gHe="_analysisContainer_wopq3_113",mHe="_analysisSection_wopq3_120",yHe="_missingFields_wopq3_131",vHe="_unexpectedFields_wopq3_131",wHe="_noIssues_wopq3_157",xHe="_tabContainer_wopq3_166",bHe="_tabHeader_wopq3_170",_He="_comparisonContainer_wopq3_186",CHe="_comparisonSection_wopq3_193",SHe="_actualData_wopq3_204",THe="_expectedData_wopq3_204",BHe="_recommendations_wopq3_223",zs={container:oHe,projectSelector:aHe,projectList:lHe,projectButton:cHe,selected:hHe,projectInfo:uHe,projectStats:dHe,missingCount:AHe,unexpectedCount:fHe,selectedProject:pHe,analysisContainer:gHe,analysisSection:mHe,missingFields:yHe,unexpectedFields:vHe,noIssues:wHe,tabContainer:xHe,tabHeader:bHe,comparisonContainer:_He,comparisonSection:CHe,actualData:SHe,expectedData:THe,recommendations:BHe},EHe=()=>{const{user:n}=ec(),[e,t]=O.useState([]),[i,r]=O.useState(!0),[s,o]=O.useState(null);O.useEffect(()=>{n&&a()},[n]);const a=async()=>{try{r(!0);const A=ph(Ua(Ri,"projects"),Ca("userId","==",n.uid)),g=await Mu(A),p=[];for(const v of g.docs){const m=v.data();console.log(`🔍 [Debug] 프로젝트 ${v.id} 원본 데이터:`,m);const w=c(m);p.push({projectId:v.id,title:m.title||"제목 없음",actualData:m,expectedStructure:u(),missingFields:w.missing,unexpectedFields:w.unexpected})}t(p);const y=p.find(v=>v.title.includes("위시티자이")||v.title.includes("위시"));y&&o(y)}catch(A){console.error("프로젝트 데이터 로드 실패:",A)}finally{r(!1)}},c=A=>{const g=u(),p=[],y=[];return h(g,A,"",p),h(A,g,"",y),{missing:p,unexpected:y}},h=(A,g,p,y,v)=>{for(const m in A){const w=p?`${p}.${m}`:m;m in g?typeof A[m]=="object"&&A[m]!==null&&!Array.isArray(A[m])&&h(A[m],g[m]||{},w,y):y.push(w)}},u=()=>({id:"string",userId:"string",basicInfo:{title:"string",location:"string",description:"string (optional)",version:"string",createdAt:"Timestamp",updatedAt:"Timestamp",customerInfo:{name:"string (optional)",phone:"string (optional)",email:"string (optional)"}},spaceConfig:{dimensions:{width:"number",height:"number",depth:"number"},installType:"'builtin' | 'standalone' | 'freestanding'",wallPosition:"'left' | 'right' (for standalone)",damper:{agentPosition:"'none' | 'left' | 'right' | 'both'",size:{width:"number",height:"number"}},floorFinish:{enabled:"boolean",height:"number"}},customLayout:{wall:{type:"'nowall' | 'wall'",completed:"boolean"},rack:{thickness:"'2mm' | '3mm'",completed:"boolean",options:{isComposite:"boolean"}},motor:{topHeight:"number",completed:"boolean"},ventilation:{type:"'no' | 'dry'",completed:"boolean"},exhaust:{height:"number",completed:"boolean",fromFloor:"boolean"}},metadata:{status:"'draft' | 'in_progress' | 'completed' | 'archived'",priority:"'low' | 'medium' | 'high' | 'urgent'",tags:"string[]",isFavorite:"boolean"},stats:{designFileCount:"number",furnitureCount:"number",completionRate:"number",lastOpenedAt:"Timestamp"},thumbnailUrl:"string (optional)"}),d=A=>l.jsxs("div",{className:zs.comparisonContainer,children:[l.jsxs("div",{className:zs.comparisonSection,children:[l.jsx("h3",{children:"🔍 실제 저장된 데이터"}),l.jsx("pre",{className:zs.actualData,children:JSON.stringify(A.actualData,null,2)})]}),l.jsxs("div",{className:zs.comparisonSection,children:[l.jsx("h3",{children:"📋 예상 데이터 구조"}),l.jsx("pre",{className:zs.expectedData,children:JSON.stringify(A.expectedStructure,null,2)})]})]}),f=A=>l.jsxs("div",{className:zs.analysisContainer,children:[l.jsxs("div",{className:zs.analysisSection,children:[l.jsx("h4",{children:"❌ 누락된 필드들"}),A.missingFields.length>0?l.jsx("ul",{className:zs.missingFields,children:A.missingFields.map(g=>l.jsx("li",{children:g},g))}):l.jsx("p",{className:zs.noIssues,children:"누락된 필드가 없습니다!"})]}),l.jsxs("div",{className:zs.analysisSection,children:[l.jsx("h4",{children:"⚠️ 예상치 못한 필드들"}),A.unexpectedFields.length>0?l.jsx("ul",{className:zs.unexpectedFields,children:A.unexpectedFields.map(g=>l.jsx("li",{children:g},g))}):l.jsx("p",{className:zs.noIssues,children:"예상치 못한 필드가 없습니다!"})]})]});return n?i?l.jsx("div",{className:zs.container,children:l.jsx("h1",{children:"🔄 데이터 로딩 중..."})}):l.jsxs("div",{className:zs.container,children:[l.jsx("h1",{children:"🔍 Firebase 프로젝트 데이터 구조 분석"}),l.jsxs("div",{className:zs.projectSelector,children:[l.jsxs("h2",{children:["📁 프로젝트 목록 (",e.length,"개)"]}),l.jsx("div",{className:zs.projectList,children:e.map(A=>l.jsxs("button",{className:`${zs.projectButton} ${(s==null?void 0:s.projectId)===A.projectId?zs.selected:""}`,onClick:()=>o(A),children:[l.jsxs("div",{className:zs.projectInfo,children:[l.jsx("strong",{children:A.title}),l.jsx("small",{children:A.projectId})]}),l.jsxs("div",{className:zs.projectStats,children:[l.jsxs("span",{className:zs.missingCount,children:["누락: ",A.missingFields.length]}),l.jsxs("span",{className:zs.unexpectedCount,children:["추가: ",A.unexpectedFields.length]})]})]},A.projectId))})]}),s&&l.jsxs("div",{className:zs.selectedProject,children:[l.jsxs("h2",{children:["📊 선택된 프로젝트: ",s.title]}),f(s),l.jsx("div",{className:zs.tabContainer,children:l.jsxs("details",{open:!0,children:[l.jsx("summary",{className:zs.tabHeader,children:"📋 데이터 구조 비교"}),d(s)]})}),l.jsxs("div",{className:zs.recommendations,children:[l.jsx("h3",{children:"💡 권장사항"}),l.jsxs("ul",{children:[l.jsxs("li",{children:["새로운 스키마로 마이그레이션하려면 ",l.jsx("code",{children:"projectDataService.ts"}),"를 사용하세요"]}),l.jsx("li",{children:"기존 데이터와의 호환성을 위해 마이그레이션 스크립트를 작성하세요"}),l.jsx("li",{children:"Step1-3 컴포넌트에서 생성한 데이터가 올바른 구조로 저장되는지 확인하세요"})]})]})]})]}):l.jsxs("div",{className:zs.container,children:[l.jsx("h1",{children:"🔐 로그인이 필요합니다"}),l.jsx("p",{children:"Firebase 데이터를 확인하려면 로그인해주세요."})]})},kHe=n=>{const{enableInertia:e=!0,enableHapticFeedback:t=!1,sensitivity:i=1,preventDefault:r=!0}=n,s=O.useRef({startX:0,startY:0,startDistance:0,startAngle:0,lastX:0,lastY:0,touchCount:0,startTime:0,velocity:{x:0,y:0}}),o=O.useRef(0),a=O.useRef(),c=O.useRef(),h=O.useCallback(()=>{t&&"vibrate"in navigator&&navigator.vibrate(10)},[t]),u=y=>{if(y.length<2)return 0;const v=y[0].clientX-y[1].clientX,m=y[0].clientY-y[1].clientY;return Math.sqrt(v*v+m*m)},d=y=>{if(y.length<2)return 0;const v=y[1].clientX-y[0].clientX,m=y[1].clientY-y[0].clientY;return Math.atan2(m,v)*(180/Math.PI)},f=(y,v,m)=>Math.sqrt(y*y+v*v)/m,A=O.useCallback(y=>{r&&y.preventDefault();const v=y.touches;if(s.current.touchCount=v.length,s.current.startTime=Date.now(),v.length===1)s.current.startX=v[0].clientX,s.current.startY=v[0].clientY,s.current.lastX=v[0].clientX,s.current.lastY=v[0].clientY,s.current.velocity={x:0,y:0},n.onLongPress&&(a.current=setTimeout(()=>{var m;h(),(m=n.onLongPress)==null||m.call(n)},500));else if(v.length===2){a.current&&clearTimeout(a.current),s.current.startDistance=u(v);const m=d(v);s.current.startAngle=m}},[n,r,h]),g=O.useCallback(y=>{var m,w,x;r&&y.preventDefault();const v=y.touches;if(a.current&&clearTimeout(a.current),v.length===1&&s.current.touchCount===1){const T=(v[0].clientX-s.current.lastX)*i,j=(v[0].clientY-s.current.lastY)*i,b=Date.now()-s.current.startTime;s.current.velocity={x:T/b,y:j/b},(m=n.onPan)==null||m.call(n,T,j),s.current.lastX=v[0].clientX,s.current.lastY=v[0].clientY}else if(v.length===2){const T=u(v),j=T/s.current.startDistance;(w=n.onPinch)==null||w.call(n,j);const b=d(v)-s.current.startAngle;(x=n.onRotate)==null||x.call(n,b),s.current.startDistance=T}},[n,r,i]),p=O.useCallback(y=>{var m,w,x,T,j,D;r&&y.preventDefault(),a.current&&clearTimeout(a.current);const v=y.changedTouches;if(v.length===1&&s.current.touchCount===1){const b=v[0].clientX-s.current.startX,_=v[0].clientY-s.current.startY,I=Math.sqrt(b*b+_*_),S=Date.now()-s.current.startTime,F=f(b,_,S);if(I<10){const B=Date.now();B-o.current<300?(h(),(m=n.onDoubleTap)==null||m.call(n)):(h(),(w=n.onTap)==null||w.call(n)),o.current=B}else if(I>50){const B=Math.abs(b),E=Math.abs(_);if(B>E){const V=b>0?"right":"left";(x=n.onSwipe)==null||x.call(n,V,F),F>.5&&((T=n.onFlick)==null||T.call(n,V,F))}else{const V=_>0?"down":"up";(j=n.onSwipe)==null||j.call(n,V,F),F>.5&&((D=n.onFlick)==null||D.call(n,V,F))}if(e&&F>.1){const V=Math.min(1e3,F*500),K=Date.now(),P=()=>{var Z,Q;const X=(Date.now()-K)/V;if(X<1){const U=1-Math.pow(1-X,3),z=F*(1-U);B>E?(Z=n.onPan)==null||Z.call(n,z*(b>0?1:-1),0):(Q=n.onPan)==null||Q.call(n,0,z*(_>0?1:-1)),c.current=requestAnimationFrame(P)}};P()}}}s.current.touchCount=y.touches.length},[n,r,e,h]);O.useEffect(()=>{const y=n.element||document;return y.addEventListener("touchstart",A,{passive:!r}),y.addEventListener("touchmove",g,{passive:!r}),y.addEventListener("touchend",p,{passive:!r}),()=>{y.removeEventListener("touchstart",A),y.removeEventListener("touchmove",g),y.removeEventListener("touchend",p),a.current&&clearTimeout(a.current),c.current&&cancelAnimationFrame(c.current)}},[A,g,p,n.element,r])},IHe=({children:n,onPinch:e,onRotate:t,onPan:i,onSwipe:r,onTap:s,onDoubleTap:o,onLongPress:a,onFlick:c,enableInertia:h=!0,enableHapticFeedback:u=!1,sensitivity:d=1,className:f,style:A})=>{const g=O.useRef(null),[p,y]=O.useState(!1);kHe({element:g.current,onPinch:e,onRotate:t,onPan:(m,w)=>{y(!0),i==null||i(m,w)},onSwipe:r,onTap:()=>{v(),s==null||s()},onDoubleTap:()=>{v(),o==null||o()},onLongPress:()=>{v(),a==null||a()},onFlick:c,enableInertia:h,enableHapticFeedback:u,sensitivity:d,preventDefault:!0});const v=O.useCallback(()=>{u&&"vibrate"in navigator&&navigator.vibrate(10)},[u]);return O.useEffect(()=>{if(p){const m=setTimeout(()=>{y(!1)},100);return()=>clearTimeout(m)}},[p]),l.jsx("div",{ref:g,className:f,style:{...A,touchAction:"none",userSelect:"none",WebkitUserSelect:"none",cursor:p?"grabbing":"grab"},children:n})},FHe="_container_1elqh_1",DHe="_testArea_1elqh_14",jHe="_gestureArea_1elqh_20",PHe="_testTarget_1elqh_33",NHe="_targetContent_1elqh_48",LHe="_infoPanel_1elqh_72",MHe="_currentState_1elqh_79",RHe="_eventLog_1elqh_80",OHe="_logContainer_1elqh_101",UHe="_logEntry_1elqh_109",HHe="_noEvents_1elqh_120",WHe="_instructions_1elqh_127",QHe="_instructionGrid_1elqh_140",$He="_instruction_1elqh_127",cc={container:FHe,testArea:DHe,gestureArea:jHe,testTarget:PHe,targetContent:NHe,infoPanel:LHe,currentState:MHe,eventLog:RHe,logContainer:OHe,logEntry:UHe,noEvents:HHe,instructions:WHe,instructionGrid:QHe,instruction:$He},VHe=()=>{const[n,e]=O.useState([]),[t,i]=O.useState(1),[r,s]=O.useState(0),[o,a]=O.useState({x:0,y:0}),c=(h,u)=>{const f=`${new Date().toLocaleTimeString()}: ${h}${u?` - ${JSON.stringify(u)}`:""}`;e(A=>[f,...A.slice(0,9)])};return l.jsxs("div",{className:cc.container,children:[l.jsx("h1",{children:"터치/터치패드 테스트 페이지"}),l.jsx("div",{className:cc.testArea,children:l.jsx(IHe,{onPinch:h=>{i(h),c("핀치",{scale:h.toFixed(2)})},onRotate:h=>{s(h),c("회전",{angle:h.toFixed(1)})},onPan:(h,u)=>{a(d=>({x:d.x+h,y:d.y+u})),c("팬",{deltaX:h.toFixed(0),deltaY:u.toFixed(0)})},onTap:()=>c("탭"),onDoubleTap:()=>c("더블탭"),onLongPress:()=>c("롱프레스"),onSwipe:(h,u)=>{c("스와이프",{direction:h,velocity:u.toFixed(2)})},onFlick:(h,u)=>{c("플릭",{direction:h,velocity:u.toFixed(2)})},enableHapticFeedback:!0,className:cc.gestureArea,children:l.jsx("div",{className:cc.testTarget,style:{transform:`translate(${o.x}px, ${o.y}px) scale(${t}) rotate(${r}deg)`},children:l.jsxs("div",{className:cc.targetContent,children:[l.jsx("h3",{children:"터치 테스트 영역"}),l.jsx("p",{children:"터치패드로 다양한 제스처를 시도해보세요"}),l.jsxs("ul",{children:[l.jsx("li",{children:"한 손가락 드래그: 이동"}),l.jsx("li",{children:"두 손가락 핀치: 확대/축소"}),l.jsx("li",{children:"두 손가락 회전: 회전"}),l.jsx("li",{children:"탭/더블탭: 선택"}),l.jsx("li",{children:"롱프레스: 컨텍스트 메뉴"})]})]})})})}),l.jsxs("div",{className:cc.infoPanel,children:[l.jsxs("div",{className:cc.currentState,children:[l.jsx("h3",{children:"현재 상태"}),l.jsxs("p",{children:["스케일: ",t.toFixed(2)]}),l.jsxs("p",{children:["회전: ",r.toFixed(1),"°"]}),l.jsxs("p",{children:["위치: (",o.x.toFixed(0),", ",o.y.toFixed(0),")"]})]}),l.jsxs("div",{className:cc.eventLog,children:[l.jsx("h3",{children:"이벤트 로그"}),l.jsxs("div",{className:cc.logContainer,children:[n.map((h,u)=>l.jsx("div",{className:cc.logEntry,children:h},u)),n.length===0&&l.jsx("div",{className:cc.noEvents,children:"아직 이벤트가 없습니다"})]})]})]}),l.jsxs("div",{className:cc.instructions,children:[l.jsx("h3",{children:"테스트 방법"}),l.jsxs("div",{className:cc.instructionGrid,children:[l.jsxs("div",{className:cc.instruction,children:[l.jsx("h4",{children:"터치패드 제스처"}),l.jsxs("ul",{children:[l.jsx("li",{children:"한 손가락 드래그: 마우스 이동"}),l.jsx("li",{children:"두 손가락 스크롤: 수직/수평 스크롤"}),l.jsx("li",{children:"두 손가락 핀치: 확대/축소"}),l.jsx("li",{children:"두 손가락 회전: 회전"})]})]}),l.jsxs("div",{className:cc.instruction,children:[l.jsx("h4",{children:"개발자 도구 시뮬레이션"}),l.jsxs("ol",{children:[l.jsx("li",{children:"F12 또는 Cmd+Option+I로 개발자 도구 열기"}),l.jsx("li",{children:"Device Toolbar 클릭 (📱 아이콘)"}),l.jsx("li",{children:"Responsive 모드 선택"}),l.jsx("li",{children:"More tools → Sensors → Touch 활성화"})]})]})]})]})]})},Eq=O.createContext(null);function zHe({children:n}){const[e,t]=O.useState(()=>{const q=localStorage.getItem("cnc_panels"),G=localStorage.getItem("cnc_user_modified")==="true";if(q&&G){const ie=JSON.parse(q);if(Array.isArray(ie)&&ie.length>0)return ie}return[]}),[i,r]=O.useState(()=>{const q=localStorage.getItem("cnc_stock");return q?JSON.parse(q):[]}),[s,o]=O.useState(()=>localStorage.getItem("cnc_user_modified")==="true"),a=q=>{o(q),localStorage.setItem("cnc_user_modified",q.toString())},c=(q,G=!1)=>{t(q),localStorage.setItem("cnc_panels",JSON.stringify(q)),G&&a(!0)},h=q=>{r(q),localStorage.setItem("cnc_stock",JSON.stringify(q))},[u,d]=O.useState(null),[f,A]=O.useState(0),[g,p]=O.useState(()=>{const q=localStorage.getItem("cnc_settings");return q?JSON.parse(q):{unit:"mm",kerf:5,trimTop:5,trimBottom:5,trimLeft:5,trimRight:5,labelsOnPanels:!0,singleSheetOnly:!1,considerMaterial:!0,edgeBanding:!1,considerGrain:!0,alignVerticalCuts:!0,optimizationType:"OPTIMAL_CNC"}}),[y,v]=O.useState([]),[m,w]=O.useState([]),[x,T]=O.useState(),[j,D]=O.useState(),[b,_]=O.useState(),[I,S]=O.useState(!1),[F,B]=O.useState(1),[E,V]=O.useState(0),[K,P]=O.useState({bySheet:{},total:0,unit:"m"}),M=q=>{p(G=>{const ie={...G,...q};return localStorage.setItem("cnc_settings",JSON.stringify(ie)),ie})},X=(q,G)=>{if(d(q||null),T(G),G){const ie=parseInt(G)-1;isNaN(ie)||A(ie)}},Z=q=>{D(q)},Q=q=>{_(q)},U=()=>{const q=e.reduce((se,te)=>se+te.width*te.length*te.quantity,0),G=i.length?i[0].width*i[0].length:0,ie=i.reduce((se,te)=>se+te.width*te.length*te.quantity,0);return{partsCount:e.reduce((se,te)=>se+te.quantity,0),partsArea:q,stockArea:ie||G}},z=O.useMemo(()=>({panels:e,stock:i,settings:g,selectedPanelId:u,currentSheetIndex:f,userHasModifiedPanels:s,placements:y,cuts:m,selectedSheetId:x,selectedCutIndex:j,selectedCutId:b,simulating:I,simSpeed:F,simProgress:E,sawStats:K,setPanels:c,setStock:h,setSettings:M,setSelectedPanelId:d,setCurrentSheetIndex:A,setSelectedSheetId:T,setUserHasModifiedPanels:a,setPlacements:v,setCuts:w,selectPanel:X,selectCutIndex:Z,selectCutId:Q,setSimulating:S,setSimSpeed:B,setSimProgress:V,setSawStats:P,metrics:U}),[e,i,g,u,f,s,y,m,x,j,b,I,F,E,K]);return l.jsx(Eq.Provider,{value:z,children:n})}function Lg(){const n=O.useContext(Eq);if(!n)throw new Error("useCNCStore must be used within CNCProvider");return n}const GHe=(n,e,t,i=!1)=>{var p,y,v;const r=[];let s=1;const o=((p=n.modelConfig)==null?void 0:p.basicThickness)||18,a=9,c=18,h=15,u=5,d=n.dimensions.height,f=e-o*2,A=d-o*2;let g;if(n.id.includes("dual-4drawer-pantshanger")||n.id.includes("dual-2drawer-styler")?g=((y=n.modelConfig)==null?void 0:y.leftSections)||[]:g=((v=n.modelConfig)==null?void 0:v.sections)||[],g&&g.length>0){const m=d-o*2,w=(_,I)=>(_.heightType||"percentage")==="absolute"?Math.min(_.height||0,I):I*((_.height||_.heightRatio||100)/100),T=g.filter(_=>_.heightType==="absolute").reduce((_,I)=>_+w(I,m),0),D=(g.length>1?g.length-1:0)*o,b=m-T-D;if(g.length>1){const _=n.id.includes("2hanging")?"안전선반":"중간 칸막이";r.push({id:`panel-${s++}`,name:`${n.name} - ${_}`,width:f,height:t-a-17,thickness:o,material:"PB",color:"MW",quantity:1})}g.forEach((_,I)=>{n.id.includes("2hanging")||(n.id.includes("dual-4drawer-pantshanger")||n.id.includes("dual-2drawer-styler")?_.type:_.type==="drawer"||_.type);const S=_.heightType==="absolute"?w(_,m):w(_,b);r.push({id:`panel-${s++}`,name:`${n.name} - 좌측판`,width:t,height:Math.round(S),thickness:o,material:"PB",color:"MW",quantity:1}),r.push({id:`panel-${s++}`,name:`${n.name} - 우측판`,width:t,height:Math.round(S),thickness:o,material:"PB",color:"MW",quantity:1}),I===g.length-1&&r.push({id:`panel-${s++}`,name:`${n.name} - 상판`,width:f,height:t,thickness:o,material:"PB",color:"MW",quantity:1});const F=I===0?0:a+17;if(r.push({id:`panel-${s++}`,name:`${n.name} - 하판`,width:f,height:t-F,thickness:o,material:"PB",color:"MW",quantity:1}),r.push({id:`panel-${s++}`,name:`${n.name} - 뒷판`,width:f+10,height:Math.round(S)+10,thickness:a,material:"MDF",color:"MW",quantity:1}),_.type==="drawer"&&_.count){const B=_.drawerHeights||[];for(let E=0;E<_.count;E++){const V=E+1;let K;B&&B[E]?K=B[E]:K=Math.floor((S-o*(_.count-1))/_.count);const P=e-76,M=K-30,X=t-47-c;r.push({id:`panel-${s++}`,name:`${n.name} - 서랍${V} 손잡이판`,width:e,height:K,thickness:c,material:"PET",color:"MW",quantity:1,grain:"VERTICAL"}),r.push({id:`panel-${s++}`,name:`${n.name} - 서랍${V} 앞판`,width:P,height:M,thickness:h,material:"PB",color:"MW",quantity:1,grain:"VERTICAL"}),r.push({id:`panel-${s++}`,name:`${n.name} - 서랍${V} 뒷판`,width:P,height:M,thickness:h,material:"PB",color:"MW",quantity:1,grain:"VERTICAL"});const Z=X-o*2;r.push({id:`panel-${s++}`,name:`${n.name} - 서랍${V} 좌측판`,width:Z,height:M,thickness:h,material:"PB",color:"MW",quantity:1,grain:"VERTICAL"}),r.push({id:`panel-${s++}`,name:`${n.name} - 서랍${V} 우측판`,width:Z,height:M,thickness:h,material:"PB",color:"MW",quantity:1,grain:"VERTICAL"}),r.push({id:`panel-${s++}`,name:`${n.name} - 서랍${V} 바닥판`,width:P-26,height:X-26,thickness:u,material:"MDF",color:"MW",quantity:1,grain:"VERTICAL"})}for(let E=1;E<_.count;E++)r.push({id:`panel-${s++}`,name:`${n.name} - 서랍 칸막이 ${E}`,width:f,height:t-a-17,thickness:o,material:"PB",color:"MW",quantity:1,grain:"VERTICAL"})}else if(_.type==="hanging")_.shelfPositions&&_.shelfPositions.length>0&&_.shelfPositions.forEach((B,E)=>{r.push({id:`panel-${s++}`,name:`${n.name} - 선반 ${E+1}`,width:f,height:t-8,thickness:o,material:"PB",color:"MW",quantity:1})});else if(_.type==="shelf"&&_.count)for(let B=1;B<=_.count;B++)r.push({id:`panel-${s++}`,name:`${n.name} - 선반 ${B}`,width:f,height:t-8,thickness:o,material:"PB",color:"MW",quantity:1,grain:"VERTICAL"})})}else r.push({id:`panel-${s++}`,name:`${n.name} - 좌측판`,width:t,height:d,thickness:o,material:"PB",color:"MW",quantity:1,grain:"VERTICAL"}),r.push({id:`panel-${s++}`,name:`${n.name} - 우측판`,width:t,height:d,thickness:o,material:"PB",color:"MW",quantity:1,grain:"VERTICAL"}),r.push({id:`panel-${s++}`,name:`${n.name} - 상판`,width:f,height:t,thickness:o,material:"PB",color:"MW",quantity:1,grain:"VERTICAL"}),r.push({id:`panel-${s++}`,name:`${n.name} - 하판`,width:f,height:t,thickness:o,material:"PB",color:"MW",quantity:1,grain:"VERTICAL"}),r.push({id:`panel-${s++}`,name:`${n.name} - 뒷판`,width:f,height:A,thickness:a,material:"MDF",color:"MW",quantity:1,grain:"VERTICAL"});if(i)if(n.id.includes("dual")){const w=Math.floor((e-6)/2);r.push({id:`panel-${s++}`,name:`${n.name} - 좌측 도어`,width:w,height:d-4,thickness:o,material:"PET",color:"MW",quantity:1}),r.push({id:`panel-${s++}`,name:`${n.name} - 우측 도어`,width:w,height:d-4,thickness:o,material:"PET",color:"MW",quantity:1})}else r.push({id:`panel-${s++}`,name:`${n.name} - 도어`,width:e-4,height:d-4,thickness:o,material:"PET",color:"MW",quantity:1});return r};function VT(n,e){switch(e){case"mm":return n;case"cm":return n/10;case"in":return n/25.4;default:return n}}function XHe(n,e){return n>e?{width:e,length:n}:{width:n,length:e}}function KHe(n,e){return e===!1&&!n?"H":n||"NONE"}function qHe(n){return n?n.replace(/[",\n\r]/g," ").replace(/\s+/g," ").trim():""}function YHe(n,e="mm"){const t=n.width||0,i=n.length||n.height||n.depth||0,{width:r,length:s}=XHe(t,i),o=VT(r,e),a=VT(s,e),c=VT(n.thickness||18,e);return{id:n.id,label:qHe(n.label||n.name||`Panel_${n.id}`),width:Math.round(o*10)/10,length:Math.round(a*10)/10,thickness:Math.round(c*10)/10,quantity:n.quantity||1,material:n.material||"PB",grain:KHe(n.grain,n.canRotate),canRotate:n.canRotate!==!1}}function ZHe(n,e="mm"){return n.map(t=>YHe(t,e))}function JHe(){const n=ci(c=>c.placedModules),e=qi(c=>c.spaceInfo),[t,i]=O.useState([]),[r,s]=O.useState(!0);O.useEffect(()=>{if(console.log("=== useLivePanelData extracting panels ==="),console.log("placedModules:",n),console.log("placedModules.length:",n.length),console.log("spaceInfo:",e),!Array.isArray(n)){console.error("placedModules is not an array:",typeof n,n);return}(()=>{if(s(!0),!n||n.length===0){console.log("No modules placed, returning empty panels"),i([]),s(!1);return}const h=[],u={width:e.width-36,height:e.height,depth:e.depth};console.log("internalSpace:",u),n.forEach((d,f)=>{const A=d.moduleId||d.moduleType;if(console.log(`Module ${f}: moduleId = ${A}`),!A){console.warn(`Module ${f} has no moduleId`);return}const g=Hi(A,u,e);if(!g){console.warn(`Module ${f}: No module data found for ${A}`);return}console.log(`Module ${f}: Found module data`,g);const p=d.width||g.dimensions.width,y=d.depth||g.dimensions.depth,v=d.hasDoor||!1,m=d.material||"PB",w=d.color||"MW",x=GHe(g,p,y,v);console.log(`Module ${f}: Extracted ${x.length} panels`),x.forEach((T,j)=>{(!T.material||T.material==="PB")&&(T.material=m),T.color=w,T.id=`m${f}_p${j}`}),h.push(...x)}),console.log("Total panels extracted:",h.length),console.log("All panels:",h),i(h),s(!1)})()},[n,e]);const o=O.useMemo(()=>ZHe(t,"mm"),[t]),a=O.useMemo(()=>{const c=new Map;return t.forEach(h=>{const u=`${h.material}-${h.color}`,d=c.get(u)||{count:0,area:0},f=h.width*h.height*h.quantity/1e6;c.set(u,{count:d.count+h.quantity,area:d.area+f})}),{totalPanels:t.length,totalQuantity:t.reduce((h,u)=>h+u.quantity,0),totalArea:t.reduce((h,u)=>h+u.width*u.height*u.quantity/1e6,0),materialGroups:Array.from(c.entries()).map(([h,u])=>({key:h,material:h.split("-")[0],color:h.split("-")[1],...u}))}},[t]);return{panels:t,normalizedPanels:o,stats:a,isLoading:r,getPanelsByMaterial:(c,h)=>t.filter(u=>!(c&&u.material!==c||h&&u.color!==h)),getNormalizedPanelsByMaterial:(c,h)=>o.filter(u=>!(c&&u.material!==c||h&&u.color!==h))}}const eWe="_section_1ijfj_1",tWe="_tableContainer_1ijfj_13",nWe="_stockTableContainer_1ijfj_20",iWe="_options_1ijfj_27",rWe="_sectionHeader_1ijfj_35",sWe="_addButton_1ijfj_58",oWe="_table_1ijfj_13",aWe="_stockTable_1ijfj_20",lWe="_selected_1ijfj_245",cWe="_newPanel_1ijfj_260",hWe="_input_1ijfj_289",uWe="_inputSmall_1ijfj_317",dWe="_inputTiny_1ijfj_343",AWe="_select_1ijfj_245",fWe="_dimensions_1ijfj_386",pWe="_deleteButton_1ijfj_395",gWe="_grainToggle_1ijfj_515",mWe="_empty_1ijfj_542",yWe="_optionGroup_1ijfj_578",vWe="_inlineNumberInput_1ijfj_613",wWe="_inputWrapper_1ijfj_626",xWe="_unit_1ijfj_657",bWe="_marginGrid_1ijfj_664",_We="_marginRow_1ijfj_674",CWe="_numberInputCompact_1ijfj_679",SWe="_gapToggleButton_1ijfj_701",TWe="_checkboxGrid_1ijfj_734",BWe="_checkboxRow_1ijfj_741",EWe="_checkboxCompact_1ijfj_746",kWe="_resetLink_1ijfj_845",IWe="_link_1ijfj_853",wi={section:eWe,tableContainer:tWe,stockTableContainer:nWe,options:iWe,sectionHeader:rWe,addButton:sWe,table:oWe,stockTable:aWe,selected:lWe,newPanel:cWe,input:hWe,inputSmall:uWe,inputTiny:dWe,select:AWe,dimensions:fWe,deleteButton:pWe,grainToggle:gWe,empty:mWe,optionGroup:yWe,inlineNumberInput:vWe,inputWrapper:wWe,unit:xWe,marginGrid:bWe,marginRow:_We,numberInputCompact:CWe,gapToggleButton:SWe,checkboxGrid:TWe,checkboxRow:BWe,checkboxCompact:EWe,resetLink:kWe,link:IWe};function FWe(){const{t:n}=Eo(),{panels:e,setPanels:t,selectedPanelId:i,setSelectedPanelId:r,setUserHasModifiedPanels:s,settings:o}=Lg(),a=O.useRef(null),c=O.useRef(null),h=O.useRef(null),[u,d]=O.useState(null);O.useEffect(()=>{if(i&&c.current&&a.current){const m=a.current,w=c.current,x=w.offsetTop,T=x+w.offsetHeight,j=m.scrollTop,D=j+m.clientHeight;(x<j||T>D)&&w.scrollIntoView({behavior:"smooth",block:"center"})}},[i]),O.useEffect(()=>{u&&setTimeout(()=>{const m=document.querySelector(`tr[data-panel-id="${u}"]`);m&&m.scrollIntoView({behavior:"smooth",block:"center"});const w=document.querySelector(`input[data-panel-id="${u}"][data-field="label"]`);w&&(w.focus(),w.select()),d(null)},100)},[u]),O.useEffect(()=>{const m=a.current;if(!m)return;const w=x=>{if(m.scrollHeight>m.clientHeight){const j=m.scrollTop===0&&x.deltaY<0,D=m.scrollTop+m.clientHeight>=m.scrollHeight-1&&x.deltaY>0;!j&&!D&&(x.preventDefault(),x.stopPropagation());const b=.8;m.scrollTop+=x.deltaY*b}};return m.addEventListener("wheel",w,{passive:!1}),()=>{m.removeEventListener("wheel",w)}},[]);const f=(m,w,x)=>{const T=e.map((j,D)=>D===m?{...j,[w]:w==="quantity"||w==="width"||w==="length"||w==="thickness"?Number(x):x}:j);t(T,!0),s(!0)},A=()=>{const m={id:String(Date.now()),label:"",width:0,length:0,thickness:18,quantity:1,material:"PB",grain:"V"};t([...e,m],!0),s(!0),r(m.id),d(m.id)},g=m=>{const w=e.slice();w.splice(m,1),t(w,!0),s(!0)},p=m=>{r(i===m?null:m)},y=m=>{var T;const w=(T=m.target.files)==null?void 0:T[0];if(!w)return;const x=new FileReader;x.onload=j=>{var b;const D=(b=j.target)==null?void 0:b.result;v(D)},x.readAsText(w),m.target.value=""},v=m=>{var w,x,T;try{const j=m.split(`
`).filter(K=>K.trim()),D=j[0].split(",").map(K=>K.trim().toLowerCase()),b=D.findIndex(K=>K.includes("이름")||K.includes("name")||K.includes("label")||K.includes("품명")),_=D.findIndex(K=>K.includes("가로")||K.includes("width")||K==="w"),I=D.findIndex(K=>K.includes("세로")||K.includes("length")||K.includes("높이")||K==="l"),S=D.findIndex(K=>K.includes("두께")||K.includes("thickness")||K==="t"),F=D.findIndex(K=>K.includes("수량")||K.includes("quantity")||K.includes("qty")),B=D.findIndex(K=>K.includes("재질")||K.includes("material")||K.includes("재료")),E=D.findIndex(K=>K.includes("결")||K.includes("grain")||K.includes("방향")),V=[];for(let K=1;K<j.length;K++){const P=j[K].trim();if(!P)continue;const M=((w=P.match(/(".*?"|[^,]+)/g))==null?void 0:w.map(z=>z.replace(/^"(.*)"$/,"$1").trim()))||[];if(M.length<2)continue;let X=parseFloat(M[_]||"600")||600,Z=parseFloat(M[I]||"800")||800;X>Z&&([X,Z]=[Z,X]);const Q={id:`csv_${Date.now()}_${K}`,label:M[b]||`Panel_${K}`,width:X,length:Z,thickness:parseFloat(M[S]||"18")||18,quantity:parseInt(M[F]||"1")||1,material:((x=M[B])==null?void 0:x.toUpperCase())||"PB",grain:((T=M[E])==null?void 0:T.toUpperCase())==="H"?"H":"V"};["PB","MDF","PET","PLY","HPL","LPM"].includes(Q.material)||(Q.material="PB"),V.push(Q)}V.length>0?e.length===0||confirm(n("cnc.csvReplaceConfirm",{count:e.length}))?(t(V,!0),s(!0),alert(n("cnc.csvImportSuccess",{count:V.length}))):(t([...e,...V],!0),s(!0),alert(n("cnc.csvAddSuccess",{count:V.length}))):alert(n("cnc.csvNoValidData"))}catch{alert(n("cnc.csvReadError"))}};return l.jsxs("div",{className:wi.section,children:[l.jsxs("div",{className:wi.sectionHeader,children:[l.jsx(zz,{size:16}),l.jsxs("h3",{children:[n("cnc.panelList")," (",e.length,")"]}),l.jsxs("div",{style:{display:"flex",gap:"4px"},children:[l.jsxs("button",{className:wi.addButton,onClick:()=>{var m;return(m=h.current)==null?void 0:m.click()},title:"CSV 파일 업로드",children:[l.jsx(tF,{size:14}),"CSV"]}),l.jsxs("button",{className:wi.addButton,onClick:A,children:[l.jsx(Xz,{size:14}),n("common.add")]})]}),l.jsx("input",{ref:h,type:"file",accept:".csv",onChange:y,style:{display:"none"}})]}),l.jsx("div",{className:wi.tableContainer,ref:a,children:e.length===0?l.jsx("div",{className:wi.empty,children:n("cnc.noPanelsMessage")}):l.jsxs("table",{className:wi.table,children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{style:{width:"28%",textAlign:"center"},children:n("cnc.name")}),l.jsx("th",{style:{width:"20%",textAlign:"center"},children:n("cnc.dimensions")}),l.jsx("th",{style:{width:"8%",textAlign:"center",paddingLeft:"18px"},children:n("cnc.thickness")}),l.jsx("th",{style:{width:"8%",textAlign:"center",paddingLeft:"20px"},children:n("cnc.quantity")}),l.jsx("th",{style:{width:"21%",textAlign:"center"},children:n("cnc.material")}),l.jsx("th",{style:{width:"8%",textAlign:"center",paddingRight:"3px"},children:n("cnc.grain")}),l.jsx("th",{style:{width:"7%",textAlign:"center"}})]})}),l.jsx("tbody",{children:e.map((m,w)=>{const x=m.label===""&&m.width===0&&m.length===0;return l.jsxs("tr",{ref:i===m.id?c:null,className:`panel-clickable ${i===m.id?wi.selected:""} ${x?wi.newPanel:""}`,onClick:()=>p(m.id),"data-panel-id":m.id,children:[l.jsx("td",{children:l.jsx("input",{value:m.label,onChange:T=>f(w,"label",T.target.value),onClick:T=>T.stopPropagation(),className:wi.input,title:m.label,"data-panel-id":m.id,"data-field":"label",placeholder:n("cnc.panelNamePlaceholder")})}),l.jsx("td",{children:l.jsxs("div",{className:wi.dimensions,children:[l.jsx("input",{type:"number",value:m.length===0?"":m.length,onChange:T=>{const j=Number(T.target.value),D=2440-(o.trimTop||0)-(o.trimBottom||0);j<=D&&f(w,"length",T.target.value)},onClick:T=>T.stopPropagation(),className:wi.inputSmall,placeholder:n("cnc.lengthPlaceholder"),max:2440-(o.trimTop||0)-(o.trimBottom||0),title:`최대 ${2440-(o.trimTop||0)-(o.trimBottom||0)}mm`}),"×",l.jsx("input",{type:"number",value:m.width===0?"":m.width,onChange:T=>{const j=Number(T.target.value),D=1220-(o.trimLeft||0)-(o.trimRight||0);j<=D&&f(w,"width",T.target.value)},onClick:T=>T.stopPropagation(),className:wi.inputSmall,placeholder:n("cnc.widthPlaceholder"),max:1220-(o.trimLeft||0)-(o.trimRight||0),title:`최대 ${1220-(o.trimLeft||0)-(o.trimRight||0)}mm`})]})}),l.jsx("td",{children:l.jsx("input",{type:"number",value:m.thickness,onChange:T=>f(w,"thickness",T.target.value),onClick:T=>T.stopPropagation(),className:wi.inputTiny})}),l.jsx("td",{style:{paddingLeft:"15px"},children:l.jsx("input",{type:"number",value:m.quantity,onChange:T=>f(w,"quantity",T.target.value),onClick:T=>T.stopPropagation(),className:wi.inputTiny})}),l.jsx("td",{style:{paddingLeft:"20px",paddingRight:"2px"},children:l.jsxs("select",{value:m.material,onChange:T=>f(w,"material",T.target.value),onClick:T=>T.stopPropagation(),className:wi.select,children:[l.jsx("option",{value:"PB",children:"PB"}),l.jsx("option",{value:"MDF",children:"MDF"}),l.jsx("option",{value:"PET",children:"PET"}),l.jsx("option",{value:"PLY",children:"PLY"}),l.jsx("option",{value:"HPL",children:"HPL"}),l.jsx("option",{value:"LPM",children:"LPM"})]})}),l.jsx("td",{style:{paddingLeft:"2px"},children:l.jsx("button",{className:wi.grainToggle,onClick:T=>{T.stopPropagation();const j=m.grain==="V"?"H":"V",D=m.width,b=m.length,_=e.map((I,S)=>S===w?{...I,grain:j,width:b,length:D}:I);t(_,!0),s(!0)},title:m.grain==="V"?n("cnc.grainVerticalTooltip"):n("cnc.grainHorizontalTooltip"),children:m.grain==="V"?"↑":"→"})}),l.jsx("td",{style:{padding:"6px 6px 6px 0",textAlign:"center"},children:l.jsx("button",{onClick:T=>{T.stopPropagation(),g(w)},className:wi.deleteButton,children:l.jsx(qz,{size:12})})})]},m.id)})})]})})]})}function DWe(n){if(n==null)return"";const e=String(n);return e.includes(",")||e.includes('"')||e.includes(`
`)||e.includes("\r")?`"${e.replace(/"/g,'""')}"`:e}function aR(n){return n.map(DWe).join(",")}function kq(n,e){const t=[];return t.push(aR(n)),e.forEach(i=>{t.push(aR(i))}),t.join(`
`)}function Iq(n,e){const i=new Blob(["\uFEFF"+n],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(i),s=document.createElement("a");s.href=r,s.download=e,s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s),setTimeout(()=>URL.revokeObjectURL(r),100)}function Hh(n,e="info",t="확인"){return new Promise(i=>{const r=document.querySelector(".popup-overlay");r&&document.body.removeChild(r);const s=document.createElement("div");s.className="popup-overlay",s.style.cssText=`
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.4);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    animation: fadeIn 0.2s ease-out;
  `;const o=document.createElement("div");o.className="popup-notification",o.setAttribute("data-type",e);let a="",c="";switch(e){case"success":a=`<svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="20 6 9 17 4 12"></polyline>
      </svg>`,c="hsl(var(--theme))";break;case"error":a=`<svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>`,c="#ef4444";break;default:a=`<svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="16" x2="12" y2="12"></line>
        <line x1="12" y1="8" x2="12.01" y2="8"></line>
      </svg>`,c="hsl(var(--theme) / 0.8)"}o.style.cssText=`
    background: white;
    padding: 40px;
    border-radius: 20px;
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    font-size: 16px;
    font-weight: 500;
    min-width: 380px;
    max-width: 500px;
    text-align: center;
    animation: scaleIn 0.3s ease-out;
    position: relative;
    border: 1px solid rgba(0, 0, 0, 0.05);
  `,o.innerHTML=`
    <div style="
      width: 64px;
      height: 64px;
      margin: 0 auto 20px;
      background: ${c};
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 14px ${c}40;
    ">
      ${a}
    </div>
    <div style="
      color: #1f2937;
      font-size: 18px;
      font-weight: 600;
      line-height: 1.5;
      margin-bottom: 28px;
    ">${n}</div>
    <button style="
      background: hsl(var(--theme));
      color: white;
      border: none;
      padding: 12px 32px;
      border-radius: 10px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 0 4px 14px hsl(var(--theme) / 0.3);
    " 
    onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px hsl(var(--theme) / 0.4)'" 
    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 14px hsl(var(--theme) / 0.3)'">
      ${t}
    </button>
  `;const h=()=>{s.style.animation="fadeOut 0.2s ease-out",o.style.animation="scaleOut 0.2s ease-out",setTimeout(()=>{document.body.contains(s)&&document.body.removeChild(s),i()},200)};s.onclick=d=>{d.target===s&&h()};const u=o.querySelector("button");if(u&&(u.onclick=h),s.appendChild(o),document.body.appendChild(s),!document.querySelector("#popup-animations")){const d=document.createElement("style");d.id="popup-animations",d.textContent=`
      @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
      }
      @keyframes fadeOut {
        from { opacity: 1; }
        to { opacity: 0; }
      }
      @keyframes scaleIn {
        from { 
          opacity: 0;
          transform: scale(0.8);
        }
        to { 
          opacity: 1;
          transform: scale(1);
        }
      }
      @keyframes scaleOut {
        from { 
          opacity: 1;
          transform: scale(1);
        }
        to { 
          opacity: 0;
          transform: scale(0.8);
        }
      }
    `,document.head.appendChild(d)}e!=="success"&&setTimeout(()=>{document.body.contains(s)&&(s.style.animation="fadeOut 0.2s ease-out",o.style.animation="scaleOut 0.2s ease-out",setTimeout(()=>{document.body.contains(s)&&document.body.removeChild(s),i()},200))},e==="error"?4e3:3e3)})}function jWe(){const{t:n}=Eo(),{stock:e,setStock:t,settings:i}=Lg(),r=O.useRef(null),s=(h,u,d)=>{const f=e.slice();f[h][u]=u==="quantity"||u==="width"||u==="length"||u==="thickness"?Number(d):d,t(f)},o=()=>{const h={label:`Stock_${e.length+1}`,width:1220,length:2440,thickness:18,quantity:10,material:"PB"};t([...e,h])},a=h=>{const u=e.slice();u.splice(h,1),t(u)},c=h=>{var f;const u=(f=h.target.files)==null?void 0:f[0];if(!u)return;const d=new FileReader;d.onload=A=>{var g;try{const y=((g=A.target)==null?void 0:g.result).split(`
`).filter(m=>m.trim());if(y.length<2){Hh(n("cnc.csvNoData"),"error",n("common.confirm"));return}const v=[];for(let m=1;m<y.length;m++){const w=y[m].split(",").map(x=>x.trim());w.length>=5&&v.push({label:w[0]||`Stock_${m}`,length:parseInt(w[1])||2440,width:parseInt(w[2])||1220,thickness:parseInt(w[3])||18,quantity:parseInt(w[4])||10,material:w[5]||"PB"})}v.length>0&&(t([...e,...v]),Hh(n("cnc.stockAddSuccess",{count:v.length}),"success",n("common.confirm")))}catch{Hh(n("cnc.csvReadError"),"error",n("common.confirm"))}},d.readAsText(u),r.current&&(r.current.value="")};return l.jsxs("div",{className:wi.section,children:[l.jsxs("div",{className:wi.sectionHeader,children:[l.jsx(pC,{size:16}),l.jsxs("h3",{children:[n("cnc.stock")," (",e.length,")"]}),l.jsx("input",{ref:r,type:"file",accept:".csv",onChange:c,style:{display:"none"}}),l.jsxs("button",{className:wi.addButton,onClick:()=>{var h;return(h=r.current)==null?void 0:h.click()},children:[l.jsx(tF,{size:14}),"CSV"]}),l.jsxs("button",{className:wi.addButton,onClick:o,children:[l.jsx(Xz,{size:14}),n("common.add")]})]}),l.jsx("div",{className:wi.stockTableContainer,children:e.length===0?l.jsx("div",{className:wi.empty,children:n("cnc.noStockMessage")}):l.jsxs("table",{className:`${wi.table} ${wi.stockTable}`,children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{style:{width:"28%",textAlign:"center"},children:n("cnc.name")}),l.jsx("th",{style:{width:"22%",textAlign:"center"},children:n("cnc.dimensions")}),l.jsx("th",{style:{width:"8%",textAlign:"center",paddingLeft:"18px"},children:n("cnc.thickness")}),l.jsx("th",{style:{width:"8%",textAlign:"center",paddingLeft:"20px"},children:n("cnc.quantity")}),l.jsx("th",{style:{width:"21%",textAlign:"center"},children:n("cnc.material")}),l.jsx("th",{style:{width:"7%",textAlign:"center"}})]})}),l.jsx("tbody",{children:e.map((h,u)=>l.jsxs("tr",{children:[l.jsx("td",{children:l.jsx("input",{value:h.label||"",onChange:d=>s(u,"label",d.target.value),className:wi.input,placeholder:n("cnc.stockNamePlaceholder")})}),l.jsx("td",{children:l.jsxs("div",{className:wi.dimensions,children:[l.jsx("input",{type:"number",value:h.length,onChange:d=>{const f=Number(d.target.value),A=2440-(i.trimTop||0)-(i.trimBottom||0);f<=A&&s(u,"length",d.target.value)},className:wi.inputSmall,max:2440-(i.trimTop||0)-(i.trimBottom||0),title:n("cnc.maxValue",{value:2440-(i.trimTop||0)-(i.trimBottom||0)})}),"×",l.jsx("input",{type:"number",value:h.width,onChange:d=>{const f=Number(d.target.value),A=1220-(i.trimLeft||0)-(i.trimRight||0);f<=A&&s(u,"width",d.target.value)},className:wi.inputSmall,max:1220-(i.trimLeft||0)-(i.trimRight||0),title:n("cnc.maxValue",{value:1220-(i.trimLeft||0)-(i.trimRight||0)})})]})}),l.jsx("td",{children:l.jsx("input",{type:"number",value:h.thickness||18,onChange:d=>s(u,"thickness",d.target.value),className:wi.inputTiny,placeholder:"18"})}),l.jsx("td",{style:{paddingLeft:"15px"},children:l.jsx("input",{type:"number",value:h.quantity,onChange:d=>s(u,"quantity",d.target.value),className:wi.inputTiny})}),l.jsx("td",{style:{paddingLeft:"20px",paddingRight:"4px"},children:l.jsxs("select",{value:h.material||"PB",onChange:d=>s(u,"material",d.target.value),className:wi.select,children:[l.jsx("option",{value:"PB",children:"PB"}),l.jsx("option",{value:"MDF",children:"MDF"}),l.jsx("option",{value:"PET",children:"PET"}),l.jsx("option",{value:"PLY",children:"PLY"}),l.jsx("option",{value:"HPL",children:"HPL"}),l.jsx("option",{value:"LPM",children:"LPM"})]})}),l.jsx("td",{style:{padding:"6px 6px 6px 0",textAlign:"center"},children:l.jsx("button",{onClick:()=>a(u),className:wi.deleteButton,children:l.jsx(qz,{size:12})})})]},u))})]})})]})}function PWe({onSettingsChange:n}={}){const{t:e}=Eo(),{settings:t,setSettings:i}=Lg(),[r,s]=O.useState(!1);return l.jsxs("div",{className:wi.section,children:[l.jsxs("div",{className:wi.sectionHeader,children:[l.jsx($5,{size:16}),l.jsx("h3",{children:e("settings.title")})]}),l.jsxs("div",{className:wi.options,children:[l.jsx("div",{className:wi.optionGroup,children:l.jsxs("label",{className:wi.inlineNumberInput,children:[l.jsx("span",{children:e("cnc.bladeThickness")}),l.jsxs("div",{className:wi.inputWrapper,children:[l.jsx("input",{type:"number",value:t.kerf,onChange:o=>i({kerf:Number(o.target.value)}),onKeyDown:o=>{o.key==="Enter"&&n&&n()},min:"0",max:"10",step:"0.5"}),l.jsx("span",{className:wi.unit,children:"mm"})]})]})}),l.jsxs("button",{className:wi.gapToggleButton,onClick:()=>s(!r),children:[e("cnc.edgeGapSettings"),r?l.jsx(s6,{size:14}):l.jsx(lA,{size:14})]}),r&&l.jsxs("div",{className:wi.marginGrid,children:[l.jsxs("div",{className:wi.marginRow,children:[l.jsxs("label",{className:wi.numberInputCompact,children:[l.jsx("span",{children:e("cnc.top")}),l.jsxs("div",{className:wi.inputWrapper,children:[l.jsx("input",{type:"number",value:t.trimTop??5,onChange:o=>i({trimTop:Number(o.target.value)}),onKeyDown:o=>{o.key==="Enter"&&n&&n()},min:"0",max:"50"}),l.jsx("span",{className:wi.unit,children:"mm"})]})]}),l.jsxs("label",{className:wi.numberInputCompact,children:[l.jsx("span",{children:e("cnc.bottom")}),l.jsxs("div",{className:wi.inputWrapper,children:[l.jsx("input",{type:"number",value:t.trimBottom??5,onChange:o=>i({trimBottom:Number(o.target.value)}),onKeyDown:o=>{o.key==="Enter"&&n&&n()},min:"0",max:"50"}),l.jsx("span",{className:wi.unit,children:"mm"})]})]})]}),l.jsxs("div",{className:wi.marginRow,children:[l.jsxs("label",{className:wi.numberInputCompact,children:[l.jsx("span",{children:e("cnc.left")}),l.jsxs("div",{className:wi.inputWrapper,children:[l.jsx("input",{type:"number",value:t.trimLeft??5,onChange:o=>i({trimLeft:Number(o.target.value)}),onKeyDown:o=>{o.key==="Enter"&&n&&n()},min:"0",max:"50"}),l.jsx("span",{className:wi.unit,children:"mm"})]})]}),l.jsxs("label",{className:wi.numberInputCompact,children:[l.jsx("span",{children:e("cnc.right")}),l.jsxs("div",{className:wi.inputWrapper,children:[l.jsx("input",{type:"number",value:t.trimRight??5,onChange:o=>i({trimRight:Number(o.target.value)}),onKeyDown:o=>{o.key==="Enter"&&n&&n()},min:"0",max:"50"}),l.jsx("span",{className:wi.unit,children:"mm"})]})]})]})]}),l.jsxs("div",{className:wi.checkboxGrid,children:[l.jsxs("div",{className:wi.checkboxRow,children:[l.jsxs("label",{className:wi.checkboxCompact,children:[l.jsx("input",{type:"checkbox",checked:t.considerGrain,onChange:o=>i({considerGrain:o.target.checked})}),l.jsx("span",{children:e("cnc.considerGrain")})]}),l.jsxs("label",{className:wi.checkboxCompact,children:[l.jsx("input",{type:"checkbox",checked:t.considerMaterial,onChange:o=>i({considerMaterial:o.target.checked})}),l.jsx("span",{children:e("cnc.groupByMaterial")})]})]}),l.jsxs("div",{className:wi.checkboxRow,children:[l.jsxs("label",{className:wi.checkboxCompact,children:[l.jsx("input",{type:"checkbox",checked:t.labelsOnPanels,onChange:o=>i({labelsOnPanels:o.target.checked})}),l.jsx("span",{children:e("cnc.showPanelLabels")})]}),l.jsxs("label",{className:wi.checkboxCompact,children:[l.jsx("input",{type:"checkbox",checked:t.edgeBanding,onChange:o=>i({edgeBanding:o.target.checked})}),l.jsx("span",{children:e("cnc.considerEdgeBanding")})]})]}),l.jsxs("div",{className:wi.checkboxRow,children:[l.jsxs("label",{className:wi.checkboxCompact,children:[l.jsx("input",{type:"checkbox",checked:t.singleSheetOnly,onChange:o=>i({singleSheetOnly:o.target.checked})}),l.jsx("span",{children:e("cnc.singleSheetOnly")})]}),l.jsxs("label",{className:wi.checkboxCompact,children:[l.jsx("input",{type:"checkbox",checked:t.alignVerticalCuts!==!1,onChange:o=>i({alignVerticalCuts:o.target.checked})}),l.jsx("span",{children:e("cnc.alignVerticalCuts")})]})]})]}),l.jsx("div",{className:wi.resetLink,children:l.jsx("button",{className:wi.link,onClick:()=>{n&&n()},children:e("common.confirm")})})]})]})}function NWe(n,e="project"){if(!n||n.length===0){Hh("No panels to export","error");return}const t=["Label","Qty","Width","Length","Thickness","Material","Grain"],i=n.map(o=>[o.label,o.quantity,o.width,o.length,o.thickness,o.material||"",o.grain==="NONE"?"":o.grain]),r=kq(t,i),s=new Date().toISOString().split("T")[0];Iq(r,`${e}_panels_${s}.csv`),Hh(`Exported ${n.length} panels`,"success")}function LWe(n,e="project"){if(!n||n.length===0){Hh("No stock sheets to export","error");return}const t=["Label","Qty","Width","Length","Thickness","Material"],i=n.map(o=>[o.label||`${o.material}_Stock`,o.quantity||999,o.width,o.length,o.thickness||18,o.material||""]),r=kq(t,i),s=new Date().toISOString().split("T")[0];Iq(r,`${e}_stock_${s}.csv`),Hh(`Exported ${n.length} stock sheets`,"success")}class ff{constructor(e){rr(this,"pdf");rr(this,"pageWidth");rr(this,"pageHeight");rr(this,"margin",20);rr(this,"panelDetails",new Map);rr(this,"furnitureData");this.pdf=new Di({orientation:"landscape",unit:"mm",format:"a3"}),this.pdf.setFont("helvetica"),this.pageWidth=this.pdf.internal.pageSize.getWidth(),this.pageHeight=this.pdf.internal.pageSize.getHeight(),e&&e.forEach(t=>{this.panelDetails.set(t.id,t)})}drawSheet(e,t,i=!0){i&&t>0&&this.pdf.addPage(),this.pdf.setFontSize(16),this.pdf.text(`Cutting Layout - Sheet ${t+1}`,this.margin,this.margin),this.pdf.setFontSize(10),this.pdf.text(`Stock: ${e.stockPanel.width} x ${e.stockPanel.height} mm | Panels: ${e.panels.length} | Efficiency: ${e.efficiency.toFixed(1)}%`,this.margin,this.margin+10);const r=this.pageWidth-this.margin*2,s=this.pageHeight-this.margin*2-20,o=e.stockPanel.height>e.stockPanel.width,a=o?e.stockPanel.height:e.stockPanel.width,c=o?e.stockPanel.width:e.stockPanel.height,h=r/a,u=s/c,d=Math.min(h,u,.2),f=this.margin,A=this.margin+20;this.pdf.setDrawColor(200,200,200),this.pdf.setLineWidth(.5),this.pdf.rect(f,A,a*d,c*d),this.pdf.setDrawColor(100,100,100),this.pdf.setLineWidth(.1);const g=5,p=a*d,y=c*d,v=Math.max(p,y);for(let V=-v;V<v*2;V+=g){const K=f+V,P=A,M=f+V+y,X=A+y,Z=Math.max(f,Math.min(f+p,K)),Q=K<f?A+(f-K):P,U=Math.max(f,Math.min(f+p,M)),z=M>f+p?A+y-(M-f-p):X;Z<f+p&&U>f&&this.pdf.line(Z,Q,U,z)}const m={PB:[232,245,233],MDF:[255,243,224],PLY:[227,242,253],HPL:[243,229,245],LPM:[252,228,236]};e.panels.forEach((V,K)=>{let P,M,X,Z;o?(P=f+V.y*d,M=A+(e.stockPanel.width-V.x-V.width)*d,X=V.height*d,Z=V.width*d):(P=f+V.x*d,M=A+V.y*d,X=V.width*d,Z=V.height*d);const Q=m[V.material]||[243,244,246];if(this.pdf.setFillColor(Q[0],Q[1],Q[2]),this.pdf.rect(P,M,X,Z,"F"),this.pdf.setDrawColor(100,100,100),this.pdf.setLineWidth(.2),this.pdf.rect(P,M,X,Z,"S"),X>15&&Z>10){if(this.pdf.setFontSize(6),this.pdf.setTextColor(50,50,50),V.name){const ie=/^[\x00-\x7F]*$/.test(V.name)?V.name:`Panel_${V.id}`,H=ie.length>20?ie.substring(0,17)+"...":ie,se=this.pdf.getTextWidth(H);this.pdf.text(H,P+(X-se)/2,M+Z/2-2)}this.pdf.setFontSize(7),this.pdf.setTextColor(100,100,100);const U=`${Math.round(V.width)} × ${Math.round(V.height)}`,z=this.pdf.getTextWidth(U);this.pdf.text(U,P+(X-z)/2,M+Z/2+(V.name?2:0));const q=Math.round(X/d),G=Math.round(Z/d);if(X>10){this.pdf.setFontSize(10),this.pdf.setTextColor(0,0,0);const ie=String(q),H=this.pdf.getTextWidth(ie);this.pdf.text(ie,P+(X-H)/2,M+7)}if(Z>10){this.pdf.setFontSize(10),this.pdf.setTextColor(0,0,0);const ie=String(G),H=P+7,se=M+Z/2;this.pdf.text(ie,H,se,{angle:90})}X>25&&(this.pdf.setFontSize(5),this.pdf.setTextColor(150,150,150),this.pdf.text(V.material,P+2,M+Z-2))}}),this.pdf.setFontSize(9),this.pdf.setTextColor(100,100,100),this.pdf.text(`${a} mm`,f+a*d/2-10,A-5);const w=`${c} mm`;this.pdf.setFontSize(8),this.pdf.text(w,f-35,A+c*d/2),this.pdf.setFontSize(8),this.pdf.setTextColor(0,0,0);let x=A+c*d+10;const T=e.stockPanel.width*e.stockPanel.height,j=e.panels.reduce((V,K)=>V+K.width*K.height,0),D=T-j;this.pdf.text(`Used Area: ${(j/1e6).toFixed(2)} m² | Waste Area: ${(D/1e6).toFixed(2)} m²`,f,x),x+=10,this.pdf.setFontSize(10),this.pdf.setTextColor(0,0,0),this.pdf.text("Panels in this sheet:",f,x),x+=7,this.pdf.setFontSize(8);const b=new Map;e.panels.forEach(V=>{const K=`${V.name||V.id}_${V.width}_${V.height}_${V.material}`;b.has(K)||b.set(K,{count:0,width:V.width,height:V.height,material:V.material}),b.get(K).count++});const _=x,I=[10,50,20,20,18],S=["Qty","Panel Name","Width","Height","Mat."];this.pdf.setFillColor(240,240,240);const F=I.reduce((V,K)=>V+K,0);this.pdf.rect(f,_-5,F,7,"F"),this.pdf.setFontSize(8),this.pdf.setTextColor(0,0,0);let B=f;S.forEach((V,K)=>{this.pdf.text(V,B+2,_-1),B+=I[K]}),x=_+5;let E=1;Array.from(b.entries()).forEach(([V,K])=>{if(x>this.pageHeight-30)return;const P=V.split("_")[0],M=/^[\x00-\x7F]*$/.test(P)?P:`Panel_${E}`;B=f;const X=[K.count.toString(),M.length>20?M.substring(0,17)+"...":M,Math.round(K.width).toString(),Math.round(K.height).toString(),K.material];E%2===0&&(this.pdf.setFillColor(250,250,250),this.pdf.rect(f,x-3,F,5,"F")),this.pdf.setFontSize(7),this.pdf.setTextColor(0,0,0),X.forEach((Z,Q)=>{this.pdf.text(Z,B+2,x),B+=I[Q]}),x+=5,E++})}addFurnitureInfoPage(){if(!this.furnitureData)return;this.pdf.addPage(),this.pdf.setFontSize(18),this.pdf.setTextColor(0,0,0),this.pdf.text("Furniture Information",this.margin,this.margin),this.pdf.setFontSize(12);let e=this.margin+15;if(this.pdf.text(`Project: ${this.furnitureData.projectName}`,this.margin,e),e+=8,this.furnitureData.spaceInfo){const r=this.furnitureData.spaceInfo;this.pdf.setFontSize(10),this.pdf.text(`Space: ${r.width} x ${r.height} x ${r.depth} mm`,this.margin,e)}e+=15,this.pdf.setFontSize(14),this.pdf.text("Placed Furniture Modules",this.margin,e),e+=10,this.pdf.setFontSize(10),this.furnitureData.placedModules&&this.furnitureData.placedModules.length>0&&this.furnitureData.placedModules.forEach((r,s)=>{e>this.pageHeight-30&&(this.pdf.addPage(),e=this.margin),this.pdf.setFillColor(250,250,250),this.pdf.rect(this.margin,e-4,200,20,"F"),this.pdf.setTextColor(0,0,0),this.pdf.text(`${s+1}. Module ID: ${r.moduleId}`,this.margin+5,e),e+=5,this.pdf.text(`   Position: X=${r.position.x}, Y=${r.position.y}`,this.margin+5,e),e+=5,r.adjustedWidth&&this.pdf.text(`   Size: ${r.adjustedWidth} mm (adjusted)`,this.margin+5,e),e+=10}),e+=10,e>this.pageHeight-100&&(this.pdf.addPage(),e=this.margin),this.pdf.setFontSize(14),this.pdf.text("3D Furniture View",this.margin,e),e+=10,this.pdf.setFontSize(10),this.pdf.setTextColor(100,100,100),this.pdf.text("Note: For detailed 3D view, please visit the Configurator page",this.margin,e),e+=5,this.pdf.text("The 3D visualization shows the complete furniture arrangement in the space",this.margin,e),e+=10,this.pdf.setDrawColor(200,200,200),this.pdf.setFillColor(245,245,245),this.pdf.rect(this.margin,e,180,100,"FD"),this.pdf.setTextColor(150,150,150),this.pdf.setFontSize(12);const t="View 3D visualization in Configurator",i=this.pdf.getTextWidth(t);this.pdf.text(t,this.margin+(180-i)/2,e+50),this.pdf.setTextColor(0,0,0)}addPanelDetailsPage(e){this.pdf.addPage(),this.pdf.setFontSize(16),this.pdf.setTextColor(0,0,0),this.pdf.text("Panel Details Summary",this.margin,this.margin);const t=new Map;e.forEach((d,f)=>{d.panels.forEach(A=>{const g=`${A.id}_${A.width}_${A.height}`;t.has(g)||t.set(g,{panel:A,totalQty:0,sheets:[]});const p=t.get(g);p.totalQty+=1,p.sheets.includes(f+1)||p.sheets.push(f+1)})});let i=this.margin+15;this.pdf.setFontSize(10),this.pdf.setTextColor(0,0,0);const r=[60,30,30,25,15,30],s=["Panel Name","Width","Height","Material","Qty","Sheet(s)"],o=r.reduce((d,f)=>d+f,0);this.pdf.setFillColor(240,240,240),this.pdf.rect(this.margin,i-5,o,8,"F"),this.pdf.setFontSize(9),this.pdf.setTextColor(0,0,0);let a=this.margin;s.forEach((d,f)=>{this.pdf.text(d,a+2,i),a+=r[f]}),i+=8,this.pdf.setFontSize(8),Array.from(t.values()).sort((d,f)=>d.panel.name.localeCompare(f.panel.name)).forEach((d,f)=>{i>this.pageHeight-30&&(this.pdf.addPage(),i=this.margin,this.pdf.setFillColor(240,240,240),this.pdf.rect(this.margin,i-5,o,8,"F"),this.pdf.setFontSize(9),this.pdf.setTextColor(0,0,0),a=this.margin,s.forEach((p,y)=>{this.pdf.text(p,a+2,i),a+=r[y]}),i+=8,this.pdf.setFontSize(8)),f%2===0&&(this.pdf.setFillColor(250,250,250),this.pdf.rect(this.margin,i-4,o,6,"F")),a=this.margin;const g=[d.panel.name&&/^[\x00-\x7F]*$/.test(d.panel.name)?d.panel.name:`Panel_${d.panel.id}`,Math.round(d.panel.width).toString(),Math.round(d.panel.height).toString(),d.panel.material,d.totalQty.toString(),d.sheets.join(", ")];this.pdf.setFontSize(8),this.pdf.setTextColor(0,0,0),g.forEach((p,y)=>{let v=p;y===0&&p.length>30&&(v=p.substring(0,27)+"..."),this.pdf.text(v,a+2,i),a+=r[y]}),i+=6}),i+=10,i>this.pageHeight-40&&(this.pdf.addPage(),i=this.margin),this.pdf.setFontSize(10),this.pdf.setTextColor(0,0,0),this.pdf.text("Summary",this.margin,i),i+=7,this.pdf.setFontSize(9);const c=Array.from(t.values()).reduce((d,f)=>d+f.totalQty,0),h=e.length,u=e.reduce((d,f)=>d+f.efficiency,0)/e.length;this.pdf.text(`Total Panels: ${c}`,this.margin,i),i+=6,this.pdf.text(`Total Sheets: ${h}`,this.margin,i),i+=6,this.pdf.text(`Average Efficiency: ${u.toFixed(1)}%`,this.margin,i)}drawAllSheetsOnOnePage(e){this.pdf.setFontSize(16),this.pdf.text(`Cutting Layout - Total ${e.length} Sheets`,this.margin,this.margin);const t=Math.ceil(Math.sqrt(e.length)),i=Math.ceil(e.length/t),r=(this.pageWidth-this.margin*2-(t-1)*5)/t,s=(this.pageHeight-this.margin*2-30)/i;e.forEach((c,h)=>{const u=h%t,d=Math.floor(h/t),f=this.margin+u*(r+5),A=this.margin+30+d*(s+5),g=(r-10)/c.stockPanel.width,p=(s-20)/c.stockPanel.height,y=Math.min(g,p,.15);this.pdf.setFontSize(8),this.pdf.setTextColor(0,0,0),this.pdf.text(`Sheet ${h+1}`,f+2,A-2),this.pdf.setFontSize(6),this.pdf.text(`${c.panels.length} panels (${c.efficiency.toFixed(0)}%)`,f+2,A+3);const v=f+5,m=A+8;this.pdf.setDrawColor(200,200,200),this.pdf.setLineWidth(.3),this.pdf.rect(v,m,c.stockPanel.width*y,c.stockPanel.height*y);const w={PB:[232,245,233],PET:[255,248,220],MDF:[255,243,224],PLY:[227,242,253],HPL:[243,229,245],LPM:[252,228,236]};c.panels.forEach(x=>{const T=v+x.x*y,j=m+x.y*y,D=(x.rotated?x.height:x.width)*y,b=(x.rotated?x.width:x.height)*y,_=w[x.material]||[243,244,246];this.pdf.setFillColor(_[0],_[1],_[2]),this.pdf.rect(T,j,D,b,"F"),this.pdf.setDrawColor(150,150,150),this.pdf.setLineWidth(.1),this.pdf.rect(T,j,D,b,"S")}),this.pdf.setFontSize(5),this.pdf.setTextColor(100,100,100),this.pdf.text(`${c.stockPanel.width}x${c.stockPanel.height}`,v+c.stockPanel.width*y/2-8,m+c.stockPanel.height*y+3)});const o=e.reduce((c,h)=>c+h.panels.length,0),a=e.reduce((c,h)=>c+h.efficiency,0)/e.length;this.pdf.setFontSize(9),this.pdf.setTextColor(0,0,0),this.pdf.text(`Total: ${o} panels across ${e.length} sheets | Average efficiency: ${a.toFixed(1)}%`,this.margin,this.pageHeight-10)}addSheets(e){if(console.log(`=== addSheets called with ${e.length} results ===`),!e||e.length===0){console.error("No results provided to addSheets");return}try{this.drawAllSheetsOnOnePage(e),console.log("All sheets drawn on one page")}catch(t){console.error("Error drawing sheets:",t)}if(e.forEach((t,i)=>{console.log(`Adding detailed sheet ${i+1} of ${e.length}`);try{this.pdf.addPage(),this.drawSheet(t,i,!1),console.log(`Detailed sheet ${i+1} added successfully`)}catch(r){console.error(`Error adding detailed sheet ${i+1}:`,r)}}),e.length>0){console.log("Adding panel details page");try{this.addPanelDetailsPage(e),console.log("Panel details page added")}catch(t){console.error("Error adding panel details page:",t)}}console.log(`Total pages in PDF: ${this.pdf.getNumberOfPages()}`)}save(e="cutting_layout.pdf"){this.pdf.save(e)}static exportToPDF(e,t,i){if(console.log("=== PDF Export ==="),console.log("Total sheets to export:",e.length),!e||e.length===0){console.error("No optimization results to export"),alert("최적화 결과가 없습니다.");return}const r=(t==null?void 0:t.panels)||[],s=new ff(Array.isArray(r)?r:[]);s.furnitureData=t,console.log(`Exporting ${e.length} sheets to PDF`),s.addSheets(e),s.save(i)}static createIndividualSheetPDF(e,t,i){const r=new Di({orientation:"landscape",unit:"mm",format:"a3"});r.setFont("helvetica");const s=new ff(i);return s.pdf=r,s.pageWidth=r.internal.pageSize.getWidth(),s.pageHeight=r.internal.pageSize.getHeight(),s.drawSheet(e,t,!1),r}static async exportToZIP(e,t){if(console.log("=== ZIP Export with PDFs ==="),console.log("Total sheets to export:",e.length),!e||e.length===0){console.error("No optimization results to export"),alert("최적화 결과가 없습니다.");return}const i=new H$,r=new Date().toISOString().slice(0,10);try{console.log("Creating overview PDF with all sheets...");const s=(t==null?void 0:t.panels)||[],o=Array.isArray(s)?s:[],a=new ff(o);a.furnitureData=t,a.addSheets(e);const c=a.pdf.output("blob");i.file(`00_전체_시트_${r}.pdf`,c),console.log("Creating individual sheet PDFs...");for(let A=0;A<e.length;A++)try{const g=e[A],p=A+1;console.log(`Creating PDF for sheet ${p}...`);const v=ff.createIndividualSheetPDF(g,A,o).output("blob"),m=`시트_${String(p).padStart(2,"0")}_${g.stockPanel.material||"PB"}_${g.stockPanel.width}x${g.stockPanel.height}.pdf`;i.file(m,v),console.log(`Added sheet ${p} to ZIP`)}catch(g){console.error(`Error creating sheet ${A+1}:`,g)}if(o&&o.length>0){const A=ff.generatePanelCSV(o);i.file(`패널_목록_${r}.csv`,A)}const h=ff.generateSummary(e,t);i.file(`최적화_요약_${r}.txt`,h),console.log("Generating ZIP file...");const u=await i.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:9}});console.log("ZIP file created, size:",u.size);const d=URL.createObjectURL(u),f=document.createElement("a");f.href=d,f.download=`cutting_layout_${r}.zip`,document.body.appendChild(f),f.click(),document.body.removeChild(f),setTimeout(()=>{URL.revokeObjectURL(d)},100),console.log("ZIP file downloaded successfully")}catch(s){console.error("Error creating ZIP file:",s),s instanceof Error?(console.error("Error message:",s.message),console.error("Error stack:",s.stack),alert(`ZIP 파일 생성 중 오류가 발생했습니다: ${s.message}`)):(console.error("Unknown error:",s),alert("ZIP 파일 생성 중 알 수 없는 오류가 발생했습니다."))}}static generatePanelCSV(e){let t=`ID,이름,가로,세로,두께,재질,수량
`;return e.forEach(i=>{const r=i.label||i.name||`Panel_${i.id}`;t+=`${i.id},"${r}",${i.width},${i.length||i.height},${i.thickness||18},${i.material||"PB"},${i.quantity||1}
`}),t}static generateSummary(e,t){const i=(t==null?void 0:t.projectName)||"Project",r=e.length,s=e.reduce((h,u)=>h+u.panels.length,0),o=e.reduce((h,u)=>h+u.efficiency,0)/e.length,a=e.reduce((h,u)=>h+u.wasteArea,0)/1e6;let c=`========================================
`;return c+=`컷팅 최적화 결과 요약
`,c+=`========================================

`,c+=`프로젝트: ${i}
`,c+=`생성일시: ${new Date().toLocaleString("ko-KR")}

`,c+=`----------------------------------------
`,c+=`전체 통계
`,c+=`----------------------------------------
`,c+=`총 시트 수: ${r}장
`,c+=`총 패널 수: ${s}개
`,c+=`평균 효율: ${o.toFixed(1)}%
`,c+=`총 폐기량: ${a.toFixed(2)} m²

`,c+=`----------------------------------------
`,c+=`시트별 상세
`,c+=`----------------------------------------
`,e.forEach((h,u)=>{c+=`
[시트 ${u+1}]
`,c+=`원자재: ${h.stockPanel.material} ${h.stockPanel.width}x${h.stockPanel.height}mm
`,c+=`패널 수: ${h.panels.length}개
`,c+=`효율: ${h.efficiency.toFixed(1)}%
`,c+=`사용 면적: ${(h.usedArea/1e6).toFixed(2)} m²
`,c+=`폐기 면적: ${(h.wasteArea/1e6).toFixed(2)} m²
`}),c}}class MWe{static exportToDXF(e){const t=[];return t.push("0"),t.push("SECTION"),t.push("2"),t.push("HEADER"),t.push("9"),t.push("$ACADVER"),t.push("1"),t.push("AC1009"),t.push("9"),t.push("$INSBASE"),t.push("10"),t.push("0.0"),t.push("20"),t.push("0.0"),t.push("30"),t.push("0.0"),t.push("9"),t.push("$EXTMIN"),t.push("10"),t.push("0.0"),t.push("20"),t.push("0.0"),t.push("30"),t.push("0.0"),t.push("9"),t.push("$EXTMAX"),t.push("10"),t.push("10000.0"),t.push("20"),t.push("5000.0"),t.push("30"),t.push("0.0"),t.push("0"),t.push("ENDSEC"),t.push("0"),t.push("SECTION"),t.push("2"),t.push("TABLES"),t.push("0"),t.push("TABLE"),t.push("2"),t.push("LTYPE"),t.push("70"),t.push("1"),t.push("0"),t.push("LTYPE"),t.push("2"),t.push("CONTINUOUS"),t.push("70"),t.push("64"),t.push("3"),t.push("Solid line"),t.push("72"),t.push("65"),t.push("73"),t.push("0"),t.push("40"),t.push("0.0"),t.push("0"),t.push("ENDTAB"),t.push("0"),t.push("TABLE"),t.push("2"),t.push("LAYER"),t.push("70"),t.push("1"),t.push("0"),t.push("LAYER"),t.push("2"),t.push("0"),t.push("70"),t.push("0"),t.push("62"),t.push("7"),t.push("6"),t.push("CONTINUOUS"),t.push("0"),t.push("ENDTAB"),t.push("0"),t.push("ENDSEC"),t.push("0"),t.push("SECTION"),t.push("2"),t.push("ENTITIES"),e.forEach((i,r)=>{const s=r*(i.stockPanel.width+200),o=0;t.push("0"),t.push("LINE"),t.push("8"),t.push("0"),t.push("62"),t.push("7"),t.push("10"),t.push(String(s)),t.push("20"),t.push(String(o)),t.push("11"),t.push(String(s+i.stockPanel.width)),t.push("21"),t.push(String(o)),t.push("0"),t.push("LINE"),t.push("8"),t.push("0"),t.push("62"),t.push("7"),t.push("10"),t.push(String(s+i.stockPanel.width)),t.push("20"),t.push(String(o)),t.push("11"),t.push(String(s+i.stockPanel.width)),t.push("21"),t.push(String(o+i.stockPanel.height)),t.push("0"),t.push("LINE"),t.push("8"),t.push("0"),t.push("62"),t.push("7"),t.push("10"),t.push(String(s+i.stockPanel.width)),t.push("20"),t.push(String(o+i.stockPanel.height)),t.push("11"),t.push(String(s)),t.push("21"),t.push(String(o+i.stockPanel.height)),t.push("0"),t.push("LINE"),t.push("8"),t.push("0"),t.push("62"),t.push("7"),t.push("10"),t.push(String(s)),t.push("20"),t.push(String(o+i.stockPanel.height)),t.push("11"),t.push(String(s)),t.push("21"),t.push(String(o));const a=50,c=i.stockPanel.width,h=i.stockPanel.height,u=Math.max(c,h),d=i.panels.map(A=>({x:s+A.x,y:o+A.y,width:A.rotated?A.height:A.width,height:A.rotated?A.width:A.height})),f=(A,g)=>{for(const v of d)if(A>=v.x-5-5&&A<=v.x+v.width+5+5&&g>=v.y-5-5&&g<=v.y+v.height+5+5)return!0;return!1};for(let A=-u;A<u*2;A+=a){let g=s+A,p=o+h,y=s+A+h,v=o;if(g<s){const m=s-g;g=s,p=o+h-m}if(p>o+h){const m=p-(o+h);p=o+h,g=g+m}if(y>s+c){const m=y-(s+c);y=s+c,v=o+m}if(v<o){const m=o-v;v=o,y=y-m}if(g>=s&&g<=s+c&&y>=s&&y<=s+c&&p>=o&&p<=o+h&&v>=o&&v<=o+h){let w=g,x=p,T=g,j=p,D=!f(g,p);for(let b=1;b<=100;b++){const _=b/100,I=g+(y-g)*_,S=p+(v-p)*_,F=f(I,S);D&&F?((w!==T||x!==j)&&(t.push("0"),t.push("LINE"),t.push("8"),t.push("0"),t.push("62"),t.push("7"),t.push("10"),t.push(String(T)),t.push("20"),t.push(String(j)),t.push("11"),t.push(String(w)),t.push("21"),t.push(String(x))),D=!1):!D&&!F&&(T=w,j=x,D=!0),w=I,x=S}D&&(w!==T||x!==j)&&(t.push("0"),t.push("LINE"),t.push("8"),t.push("0"),t.push("62"),t.push("7"),t.push("10"),t.push(String(T)),t.push("20"),t.push(String(j)),t.push("11"),t.push(String(y)),t.push("21"),t.push(String(v)))}}i.panels.forEach(A=>{const g=s+A.x,p=o+A.y,y=A.rotated?A.height:A.width,v=A.rotated?A.width:A.height;t.push("0"),t.push("LINE"),t.push("8"),t.push("0"),t.push("62"),t.push("30"),t.push("10"),t.push(String(g)),t.push("20"),t.push(String(p)),t.push("11"),t.push(String(g+y)),t.push("21"),t.push(String(p)),t.push("0"),t.push("LINE"),t.push("8"),t.push("0"),t.push("62"),t.push("30"),t.push("10"),t.push(String(g+y)),t.push("20"),t.push(String(p)),t.push("11"),t.push(String(g+y)),t.push("21"),t.push(String(p+v)),t.push("0"),t.push("LINE"),t.push("8"),t.push("0"),t.push("62"),t.push("30"),t.push("10"),t.push(String(g+y)),t.push("20"),t.push(String(p+v)),t.push("11"),t.push(String(g)),t.push("21"),t.push(String(p+v)),t.push("0"),t.push("LINE"),t.push("8"),t.push("0"),t.push("62"),t.push("30"),t.push("10"),t.push(String(g)),t.push("20"),t.push(String(p+v)),t.push("11"),t.push(String(g)),t.push("21"),t.push(String(p)),t.push("0"),t.push("TEXT"),t.push("8"),t.push("0"),t.push("62"),t.push("7"),t.push("10"),t.push(String(g+y/2)),t.push("20"),t.push(String(p+35)),t.push("30"),t.push("0"),t.push("40"),t.push("25"),t.push("1"),t.push(String(Math.round(y))),t.push("72"),t.push("1"),t.push("11"),t.push(String(g+y/2)),t.push("21"),t.push(String(p+35)),t.push("31"),t.push("0"),t.push("0"),t.push("TEXT"),t.push("8"),t.push("0"),t.push("62"),t.push("7"),t.push("10"),t.push(String(g+35)),t.push("20"),t.push(String(p+v/2)),t.push("30"),t.push("0"),t.push("40"),t.push("25"),t.push("1"),t.push(String(Math.round(v))),t.push("50"),t.push("90"),t.push("72"),t.push("1"),t.push("11"),t.push(String(g+35)),t.push("21"),t.push(String(p+v/2)),t.push("31"),t.push("0")}),t.push("0"),t.push("TEXT"),t.push("8"),t.push("0"),t.push("10"),t.push(String(s+10)),t.push("20"),t.push(String(o-30)),t.push("40"),t.push("15"),t.push("1"),t.push(`Sheet ${r+1}`)}),t.push("0"),t.push("ENDSEC"),t.push("0"),t.push("EOF"),t.join(`\r
`)}}const RWe="_exportDropdown_16wb0_1",OWe="_exportMainButton_16wb0_6",UWe="_chevron_16wb0_36",HWe="_open_16wb0_41",WWe="_dropdownMenu_16wb0_45",QWe="_menuHeader_16wb0_70",$We="_menuItem_16wb0_81",VWe="_menuItemContent_16wb0_118",zWe="_menuItemTitle_16wb0_126",GWe="_menuItemDesc_16wb0_135",XWe="_menuDivider_16wb0_147",KWe="_recommended_16wb0_153",qWe="_badge_16wb0_167",mo={exportDropdown:RWe,exportMainButton:OWe,chevron:UWe,open:HWe,dropdownMenu:WWe,menuHeader:QWe,menuItem:$We,menuItemContent:VWe,menuItemTitle:zWe,menuItemDesc:GWe,menuDivider:XWe,recommended:KWe,badge:qWe};function YWe({optimizationResults:n}){const{panels:e,stock:t}=Lg(),i=ci(g=>g.placedModules),r=qi(g=>g.spaceInfo),s=Ha(g=>g.basicInfo),[o,a]=O.useState(!1),c=O.useRef(null);O.useEffect(()=>{const g=p=>{c.current&&!c.current.contains(p.target)&&a(!1)};return document.addEventListener("mousedown",g),()=>{document.removeEventListener("mousedown",g)}},[]);const h=()=>{if(e.length===0){alert("내보낼 패널이 없습니다.");return}NWe(e,"project"),a(!1)},u=()=>{if(t.length===0){alert("내보낼 원자재가 없습니다.");return}LWe(t,"project"),a(!1)},d=async()=>{if(n.length===0){alert("최적화 결과가 없습니다. 먼저 최적화를 실행하세요.");return}const g=Array.isArray(e)?e:[],p={projectName:(s==null?void 0:s.title)||"Project",spaceInfo:r,placedModules:i,panels:g,needsConfiguratorView:!0};await ff.exportToZIP(n,p),a(!1)},f=()=>{if(n.length===0){alert("최적화 결과가 없습니다. 먼저 최적화를 실행하세요.");return}const g=MWe.exportToDXF(n),p=new Blob([g],{type:"application/dxf"}),y=URL.createObjectURL(p),v=document.createElement("a");v.href=y;const m=new Date().toISOString().slice(0,10);v.download=`cutting_layout_${m}.dxf`,v.click(),URL.revokeObjectURL(y),a(!1)},A=e.length>0||t.length>0||n.length>0;return l.jsxs("div",{className:mo.exportDropdown,ref:c,children:[l.jsxs("button",{className:mo.exportMainButton,onClick:()=>a(!o),disabled:!A,children:[l.jsx(Wz,{size:16}),l.jsx("span",{children:"Export"}),l.jsx(lA,{size:14,className:`${mo.chevron} ${o?mo.open:""}`})]}),o&&l.jsxs("div",{className:mo.dropdownMenu,children:[l.jsx("div",{className:mo.menuHeader,children:"내보내기 형식 선택"}),l.jsxs("button",{className:mo.menuItem,onClick:h,disabled:e.length===0,children:[l.jsx(zz,{size:16}),l.jsxs("div",{className:mo.menuItemContent,children:[l.jsx("span",{className:mo.menuItemTitle,children:"패널 목록 (CSV)"}),l.jsx("span",{className:mo.menuItemDesc,children:"패널 치수 및 수량 데이터"})]})]}),l.jsxs("button",{className:mo.menuItem,onClick:u,disabled:t.length===0,children:[l.jsx(pC,{size:16}),l.jsxs("div",{className:mo.menuItemContent,children:[l.jsx("span",{className:mo.menuItemTitle,children:"원자재 목록 (CSV)"}),l.jsx("span",{className:mo.menuItemDesc,children:"원자재 규격 및 수량"})]})]}),l.jsx("div",{className:mo.menuDivider}),l.jsxs("button",{className:mo.menuItem,onClick:f,disabled:n.length===0,children:[l.jsx(zve,{size:16}),l.jsxs("div",{className:mo.menuItemContent,children:[l.jsx("span",{className:mo.menuItemTitle,children:"CAD 도면 (DXF)"}),l.jsx("span",{className:mo.menuItemDesc,children:"AutoCAD 호환 컷팅 레이아웃"})]})]}),l.jsxs("button",{className:`${mo.menuItem} ${mo.recommended}`,onClick:d,disabled:n.length===0,children:[l.jsx(Xve,{size:16}),l.jsxs("div",{className:mo.menuItemContent,children:[l.jsx("span",{className:mo.menuItemTitle,children:"종합 리포트 (ZIP)"}),l.jsx("span",{className:mo.menuItemDesc,children:"전체 PDF + 개별 시트 PDF + CSV + 요약"})]}),l.jsx("span",{className:mo.badge,children:"추천"})]})]})]})}function ZWe(n,e,t,i,r){const s=[];let o=0,a={width:n,length:e};if(t.y>0&&(s.push({id:`cut-${o}`,order:o++,sheetId:"",axis:"y",pos:t.y-i/2,spanStart:0,spanEnd:n,before:a,result:{width:n,length:e-t.y},kerf:i,label:`가로 재단 y=${t.y}`,source:"derived"}),a={width:n,length:e-t.y}),t.y+t.height<e){const c=t.height+(t.y>0?0:t.y);s.push({id:`cut-${o}`,order:o++,sheetId:"",axis:"y",pos:t.y+t.height+i/2,spanStart:0,spanEnd:n,before:a,result:{width:n,length:c},kerf:i,label:`가로 재단 y=${t.y+t.height}`,source:"derived"}),a={width:n,length:c}}return t.x>0&&(s.push({id:`cut-${o}`,order:o++,sheetId:"",axis:"x",pos:t.x-i/2,spanStart:Math.max(0,t.y-i),spanEnd:Math.min(e,t.y+t.height+i),before:a,result:{width:a.width-t.x,length:a.length},kerf:i,label:`세로 재단 x=${t.x}`,source:"derived"}),a={width:a.width-t.x,length:a.length}),t.x+t.width<n&&s.push({id:`cut-${o}`,order:o++,sheetId:"",axis:"x",pos:t.x+t.width+i/2,spanStart:Math.max(0,t.y-i),spanEnd:Math.min(e,t.y+t.height+i),before:a,result:{width:t.width,length:t.height},yieldsPanelId:r,kerf:i,label:`세로 재단 x=${t.x+t.width}`,source:"derived"}),s.length>0&&r&&(s[s.length-1].yieldsPanelId=r),s}function JWe(n,e,t,i,r){const s=[];let o=0;const a={width:n,length:e};return s.push({id:`cut-${o}`,order:o++,sheetId:"",axis:"y",pos:t.y+t.height,spanStart:t.x,spanEnd:t.x+t.width,before:a,result:{width:t.width,length:t.height},kerf:i,label:`상단: y=${t.y+t.height}`,source:"derived"}),s.push({id:`cut-${o}`,order:o++,sheetId:"",axis:"x",pos:t.x+t.width,spanStart:t.y,spanEnd:t.y+t.height,before:a,result:{width:t.width,length:t.height},kerf:i,label:`우측: x=${t.x+t.width}`,source:"derived"}),s.push({id:`cut-${o}`,order:o++,sheetId:"",axis:"y",pos:t.y,spanStart:t.x,spanEnd:t.x+t.width,before:a,result:{width:t.width,length:t.height},kerf:i,label:`하단: y=${t.y}`,source:"derived"}),s.push({id:`cut-${o}`,order:o++,sheetId:"",axis:"x",pos:t.x,spanStart:t.y,spanEnd:t.y+t.height,before:a,result:{width:t.width,length:t.height},yieldsPanelId:r,kerf:i,label:`좌측: x=${t.x}`,source:"derived"}),s}function Fq(n){const{mode:e,sheetW:t,sheetH:i,kerf:r,placement:s,sheetId:o="",panelId:a}=n;let c;return e==="guillotine"?c=ZWe(t,i,s,r,a):c=JWe(t,i,s,r,a),c.map(h=>({...h,sheetId:o}))}function eQe(n,e){const{onTick:t,onDone:i,speed:r,cancelRef:s}=e,o=1e3/r;let a=0;const c=()=>{if(s.current||a>=n.length){i();return}t(a),a++,setTimeout(c,o)};c()}const tQe="_container_1q0yl_1",nQe="_canvas_1q0yl_16",iQe="_emptyState_1q0yl_26",rQe="_emptyIcon_1q0yl_35",sQe="_headerToolbar_1q0yl_47",oQe="_headerToolButton_1q0yl_55",aQe="_active_1q0yl_78",lQe="_headerDivider_1q0yl_83",cQe="_textSizeControlSmall_1q0yl_90",hQe="_textSizeBtnSmall_1q0yl_100",uQe="_textSmall_1q0yl_123",dQe="_textLarge_1q0yl_129",AQe="_zoomLevel_1q0yl_134",fQe="_headerBar_1q0yl_248",pQe="_sheetNavSection_1q0yl_265",gQe="_headerNavButton_1q0yl_272",mQe="_sheetTitle_1q0yl_296",yQe="_simulationControls_1q0yl_377",vQe="_playButton_1q0yl_419",wQe="_speedControl_1q0yl_432",xQe="_cutInfo_1q0yl_454",bQe="_animatedCut_1q0yl_471",us={container:tQe,canvas:nQe,emptyState:iQe,emptyIcon:rQe,headerToolbar:sQe,headerToolButton:oQe,active:aQe,headerDivider:lQe,textSizeControlSmall:cQe,textSizeBtnSmall:hQe,textSmall:uQe,textLarge:dQe,zoomLevel:AQe,headerBar:fQe,sheetNavSection:pQe,headerNavButton:gQe,sheetTitle:mQe,simulationControls:yQe,playButton:vQe,speedControl:wQe,cutInfo:xQe,animatedCut:bQe},_Qe=({result:n,highlightedPanelId:e,showLabels:t=!0,onPanelClick:i,allowRotation:r=!0,scale:s,rotation:o,offset:a,onScaleChange:c,onRotationChange:h,onOffsetChange:u,sheetInfo:d,onCurrentSheetIndexChange:f,showCuttingListTab:A=!1,allCutSteps:g=[]})=>{const p=O.useRef(null),y=O.useRef(null);n&&n.stockPanel.height>n.stockPanel.width;const[v,m]=O.useState(1),[w,x]=O.useState(-90),[T,j]=O.useState({x:0,y:0}),D=s??v,b=o??w,_=a??T,I=c||m,S=h||x,F=u||j,[B,E]=O.useState(null),[V,K]=O.useState(!1),[P,M]=O.useState({x:0,y:0}),[X,Z]=O.useState(1),[Q,U]=O.useState(!1),[z,q]=O.useState(!0),{settings:G,setSettings:ie,selectedPanelId:H,selectedSheetId:se,placements:te,cuts:fe,setCuts:ye,simulating:be,setSimulating:_e,simSpeed:W,setSimSpeed:Y,selectedCutIndex:ve,selectCutIndex:ce,selectedCutId:ne,selectCutId:he}=Lg(),[xe,Te]=O.useState([]),[Ce,Be]=O.useState(0),Ye=O.useRef({current:!1});O.useEffect(()=>{if(be&&!H&&n&&g&&g.length>0){const je=((d==null?void 0:d.currentIndex)??0)+1,le=g.filter(Je=>Je.sheetNumber===je);console.log("Setting up simulation:",{currentSheetNumber:je,totalCuts:le.length,panelsInSheet:n.panels.length,cutsWithYields:le.filter(Je=>Je.yieldsPanelId).length,panelIds:n.panels.map(Je=>Je.id),yieldIds:le.filter(Je=>Je.yieldsPanelId).map(Je=>Je.yieldsPanelId)}),console.log("Cut sequence order:"),le.forEach((Je,ht)=>{Je.yieldsPanelId&&console.log(`  Cut ${ht}: yields panel ${Je.yieldsPanelId}`)}),le.length>0?(Te(le),Be(0)):_e(!1)}else if(H&&se&&n){const je=te.find(le=>le.panelId===H&&le.sheetId===String((d==null?void 0:d.currentIndex)+1||1));if(je){const le=Fq({mode:G.optimizationType==="OPTIMAL_CNC"?"free":"guillotine",sheetW:n.stockPanel.width,sheetH:n.stockPanel.height,kerf:G.kerf||5,placement:{x:je.x,y:je.y,width:je.width,height:je.height},sheetId:je.sheetId,panelId:je.panelId});Te(le),Be(0)}}else Te([]),Be(0)},[H,se,n,te,G,d,be,g]),O.useEffect(()=>{if(be&&xe.length>0){Be(0),Ye.current&&(Ye.current.current=!0);const je={current:!1};Ye.current=je,requestAnimationFrame(()=>{console.log("Starting runSimulation with",xe.length,"cuts"),eQe(xe,{onTick:le=>{console.log("Simulation tick:",le,"/",xe.length-1),Be(le),ce(le)},onDone:()=>{console.log("Simulation completed"),_e(!1)},speed:.5,cancelRef:je})})}else!be&&Ye.current&&(Ye.current.current=!0);return()=>{Ye.current.current=!0}},[be,xe,W,ce,_e]),O.useEffect(()=>{const je=le=>{le.key==="Escape"&&(_e(!1),Ye.current.current=!0)};return window.addEventListener("keydown",je),()=>window.removeEventListener("keydown",je)},[_e]);const $e=()=>{if(!n||!p.current||!y.current)return;const je=p.current,le=je.getContext("2d");if(!le)return;const Je=y.current.getBoundingClientRect(),ht=Je.width,ut=Je.height,ft=d?40:0,jt=ut-ft,Wt=window.devicePixelRatio||1,Mt=40,dn=ht-Mt*2,on=jt-Mt*2,Et=b%180===0?n.stockPanel.width:n.stockPanel.height,an=b%180===0?n.stockPanel.height:n.stockPanel.width,Mn=dn/Et,At=on/an,zt=Math.min(Mn,At),Zt=ht,$t=jt;je.width=Zt*Wt,je.height=$t*Wt,je.style.width=`${Zt}px`,je.style.height=`${$t}px`,le.scale(Wt,Wt),le.save(),le.translate(Zt/2+_.x,$t/2+_.y),le.rotate(b*Math.PI/180),le.scale(zt*D,zt*D);const Ht=-n.stockPanel.width/2,Lt=-n.stockPanel.height/2;le.restore();const dt=le.createLinearGradient(0,0,0,$t);dt.addColorStop(0,"#fafbfc"),dt.addColorStop(1,"#f3f4f6"),le.fillStyle=dt,le.fillRect(0,0,Zt,$t),le.save(),le.translate(Zt/2+_.x,$t/2+_.y),le.rotate(b*Math.PI/180),le.scale(zt*D,zt*D),le.save(),le.shadowColor="rgba(0, 0, 0, 0.1)",le.shadowBlur=20,le.shadowOffsetY=10,le.fillStyle="#fff",le.fillRect(Ht,Lt,n.stockPanel.width,n.stockPanel.height),le.restore(),le.strokeStyle="#d1d5db",le.lineWidth=2/(zt*D),le.strokeRect(Ht,Lt,n.stockPanel.width,n.stockPanel.height);const at=window.cncSettings||{},Ot=at.trimTop??10,Cn=at.trimBottom??10,Rn=at.trimLeft??10,xn=at.trimRight??10;if((Ot>0||Cn>0||Rn>0||xn>0)&&(le.save(),le.fillStyle="rgba(255, 0, 0, 0.05)",le.strokeStyle="rgba(255, 0, 0, 0.3)",le.lineWidth=1/(zt*D),le.setLineDash([5/(zt*D),5/(zt*D)]),Ot>0&&(le.fillRect(Ht,Lt,n.stockPanel.width,Ot),le.strokeRect(Ht,Lt,n.stockPanel.width,Ot)),Cn>0&&(le.fillRect(Ht,Lt+n.stockPanel.height-Cn,n.stockPanel.width,Cn),le.strokeRect(Ht,Lt+n.stockPanel.height-Cn,n.stockPanel.width,Cn)),Rn>0&&(le.fillRect(Ht,Lt,Rn,n.stockPanel.height),le.strokeRect(Ht,Lt,Rn,n.stockPanel.height)),xn>0&&(le.fillRect(Ht+n.stockPanel.width-xn,Lt,xn,n.stockPanel.height),le.strokeRect(Ht+n.stockPanel.width-xn,Lt,xn,n.stockPanel.height)),le.restore()),z){le.save(),le.fillStyle="#1f2937";const Fn=Math.max(32*X/D,24*X);le.font=`bold ${Fn}px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif`,le.textAlign="center";const pt=20/(zt*D);b===-90?(le.save(),le.translate(Ht+n.stockPanel.width/2,Lt-pt),le.rotate(Math.PI),le.textBaseline="top",le.fillText(`${n.stockPanel.width}mm`,0,0),le.restore(),le.save(),le.translate(Ht-pt,Lt+n.stockPanel.height/2),le.rotate(Math.PI/2),le.textBaseline="middle",le.fillText(`${n.stockPanel.height}mm`,0,0),le.restore()):(le.textBaseline="bottom",le.fillText(`${n.stockPanel.width}mm`,Ht+n.stockPanel.width/2,Lt-pt),le.save(),le.translate(Ht-pt,Lt+n.stockPanel.height/2),le.rotate(-Math.PI/2),le.textBaseline="middle",le.fillText(`${n.stockPanel.height}mm`,0,0),le.restore()),le.restore()}const En=getComputedStyle(document.documentElement).getPropertyValue("--theme").trim(),Hn={PB:{fill:`hsl(${En} / 0.08)`,stroke:`hsl(${En} / 0.5)`},MDF:{fill:"#e8d4b0",stroke:"#8b6239"},PET:{fill:"#d1d5db",stroke:"#6b7280"},PLY:{fill:"#f5e6d3",stroke:"#a68966"},HPL:{fill:`hsl(${En} / 0.14)`,stroke:`hsl(${En} / 0.8)`},LPM:{fill:`hsl(${En} / 0.16)`,stroke:`hsl(${En} / 0.9)`}};let Kn=0;if(n.panels.forEach((Fn,pt)=>{if(be){if(xe.length===0)return;pt===0&&Ce===0&&console.log("Panel ID matching debug:",{panelId:Fn.id,panelIdType:typeof Fn.id,yieldsPanelIds:xe.filter(Mi=>Mi.yieldsPanelId).map(Mi=>({id:Mi.yieldsPanelId,type:typeof Mi.yieldsPanelId,cutIndex:xe.indexOf(Mi)}))});let ui=-1;for(let Mi=0;Mi<xe.length;Mi++){const Gn=xe[Mi].yieldsPanelId;if(Gn===Fn.id){ui=Mi;break}if(Gn&&Fn.id&&(Gn.toString()===Fn.id.toString()||Gn.toString().includes(Fn.id.toString())||Fn.id.toString().includes(Gn.toString()))){ui=Mi;break}}if(ui===-1){pt===0&&console.warn("Panel not found in cut sequence:",Fn.id);return}if(Ce<ui)return;Ce===ui?(le.globalAlpha=.9,Kn++,le.shadowColor=`hsl(${En})`,le.shadowBlur=30,le.shadowOffsetX=0,le.shadowOffsetY=0):Kn++}else be||Kn++;const vt=Ht+Fn.x,kt=Lt+Fn.y,mn=Fn.rotated?Fn.height:Fn.width,sn=Fn.rotated?Fn.width:Fn.height,bn=e&&Fn.id===e,Li=B===Fn.id,Wn=Hn[Fn.material]||{fill:"#f3f4f6",stroke:"#9ca3af"};if(le.fillStyle=Wn.fill,le.fillRect(vt,kt,mn,sn),bn?(le.strokeStyle=`hsl(${En})`,le.lineWidth=3/(zt*D),le.strokeRect(vt,kt,mn,sn),Fn.material!=="MDF"&&(le.save(),le.fillStyle=`hsl(${En} / 0.08)`,le.fillRect(vt,kt,mn,sn),le.restore())):Li?(le.strokeStyle=Fn.material==="MDF"?"#8b6239":`hsl(${En} / 0.5)`,le.lineWidth=2/(zt*D),le.strokeRect(vt,kt,mn,sn)):(le.strokeStyle=Wn.stroke,le.lineWidth=1/(zt*D),le.strokeRect(vt,kt,mn,sn)),Fn.rotated){le.save(),le.fillStyle=`hsl(${En})`,le.font="bold 12px sans-serif",le.textAlign="center",le.textBaseline="middle";const ui=16,Mi=vt+mn-ui-4,Gn=kt+4;le.translate(Mi+ui/2,Gn+ui/2),le.rotate(Math.PI/4),le.fillRect(-1,-ui/2,2,ui),le.fillRect(-ui/2,-1,ui,2),le.restore()}if(t&&mn>20&&sn>20){if(le.save(),le.imageSmoothingEnabled=!0,le.imageSmoothingQuality="high",Fn.name){le.save(),le.fillStyle=Fn.material==="MDF"?"#4a4a4a":"#9ca3af",le.textAlign="center",le.textBaseline="middle";const ui=mn*.8,Mi=sn*.4;let Dn=Math.min(24,Mi);if(b===-90){le.save(),le.translate(vt+mn/2,kt+sn/2),le.rotate(Math.PI/2),le.font=`bold ${Dn}px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif`;let li=le.measureText(Fn.name).width;const en=sn*.8;for(;li>en&&Dn>8;)Dn-=1,le.font=`bold ${Dn}px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif`,li=le.measureText(Fn.name).width;le.fillText(Fn.name,0,0),le.restore()}else{le.font=`bold ${Dn}px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif`;let li=le.measureText(Fn.name).width;if(li>ui&&sn>mn){le.save(),le.translate(vt+mn/2,kt+sn/2),le.rotate(-Math.PI/2);const en=sn*.8;for(;li>en&&Dn>8;)Dn-=1,le.font=`bold ${Dn}px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif`,li=le.measureText(Fn.name).width;le.fillText(Fn.name,0,0),le.restore()}else{for(;li>ui&&Dn>8;)Dn-=1,le.font=`bold ${Dn}px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif`,li=le.measureText(Fn.name).width;le.fillText(Fn.name,vt+mn/2,kt+sn/2)}}le.restore()}if(z){le.save(),le.fillStyle=Fn.material==="MDF"?"#2c2c2c":"#111827";const Mi=32*X;if(le.font=`bold ${Mi}px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif`,le.textAlign="center",le.textBaseline="middle",mn>50){const Gn=`${Math.round(Fn.width)}`,Dn=kt+35;b===-90?(le.save(),le.translate(vt+mn/2,Dn),le.rotate(Math.PI),le.fillText(Gn,0,0),le.restore()):le.fillText(Gn,vt+mn/2,Dn)}if(sn>50){const Gn=`${Math.round(Fn.height)}`,Dn=vt+35;le.save(),le.translate(Dn,kt+sn/2),b===-90?le.rotate(Math.PI/2):le.rotate(-Math.PI/2),le.fillText(Gn,0,0),le.restore()}le.restore()}le.restore(),le.shadowColor="transparent",le.shadowBlur=0,le.globalAlpha=1}}),be&&Ce%4===0&&console.log(`Cut ${Ce}: ${Kn}/${n.panels.length} panels visible`),be&&xe.length>0&&Ce<xe.length){const Fn=xe[Ce];for(let mn=0;mn<Ce;mn++){const sn=xe[mn];le.save(),le.strokeStyle="rgba(255, 0, 0, 0.3)",le.lineWidth=2/(zt*D),le.setLineDash([5,5]),le.beginPath(),sn.axis==="x"?(le.moveTo(Ht+sn.pos,Lt+sn.spanStart),le.lineTo(Ht+sn.pos,Lt+sn.spanEnd)):(le.moveTo(Ht+sn.spanStart,Lt+sn.pos),le.lineTo(Ht+sn.spanEnd,Lt+sn.pos)),le.stroke(),le.restore()}le.save(),le.strokeStyle="#ff0000",le.lineWidth=3/(zt*D),le.shadowColor="rgba(255, 0, 0, 0.5)",le.shadowBlur=10;const pt=Date.now()/50%20;le.setLineDash([10,10]),le.lineDashOffset=-pt,le.beginPath(),Fn.axis==="x"?(le.moveTo(Ht+Fn.pos,Lt+Fn.spanStart),le.lineTo(Ht+Fn.pos,Lt+Fn.spanEnd)):(le.moveTo(Ht+Fn.spanStart,Lt+Fn.pos),le.lineTo(Ht+Fn.spanEnd,Lt+Fn.pos)),le.stroke(),le.save(),le.fillStyle="#ff0000",le.font=`bold ${14/(zt*D)}px sans-serif`,le.textAlign="center",le.textBaseline="middle";const vt=Fn.axis==="x"?Ht+Fn.pos:Ht+(Fn.spanStart+Fn.spanEnd)/2,kt=Fn.axis==="y"?Lt+Fn.pos:Lt+(Fn.spanStart+Fn.spanEnd)/2;le.fillText(`${Fn.axis==="x"?"↕":"↔"} ${Fn.axis}=${Math.round(Fn.pos)}`,vt,kt),le.restore(),le.restore()}le.restore();const Ti=n.efficiency.toFixed(1),ti=(n.wasteArea/1e6).toFixed(2);le.save();const ai=70,Gi=24,fi=Zt-ai-10,Oi=ft+10;le.shadowColor="rgba(0, 0, 0, 0.15)",le.shadowBlur=8,le.shadowOffsetX=0,le.shadowOffsetY=2;const rn=n.efficiency>80?"#10b981":n.efficiency>60?"#f59e0b":"#ef4444";le.fillStyle=rn,le.roundRect(fi,Oi,ai,Gi,8),le.fill(),le.shadowColor="transparent",le.shadowBlur=0,le.shadowOffsetX=0,le.shadowOffsetY=0,le.fillStyle="white",le.font='bold 12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',le.textAlign="center",le.textBaseline="middle",le.fillText(`${Ti}%`,fi+ai/2,Oi+Gi/2),le.restore(),le.save(),le.textAlign="left",le.textBaseline="bottom";const $n=`${n.stockPanel.material||"PB"} ${n.stockPanel.thickness||18}T`;le.font='bold 13px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',le.fillStyle="#374151",le.fillText($n,20,$t-40),le.font='11px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',le.fillStyle="#6b7280",le.fillText(`Panels: ${n.panels.length}`,20,$t-25),le.fillText(`Waste: ${ti} m²`,20,$t-10),le.restore()};O.useEffect(()=>{const je=()=>{$e()};return window.addEventListener("resize",je),()=>window.removeEventListener("resize",je)},[]),O.useEffect(()=>{n&&!o&&x(-90)},[n==null?void 0:n.stockPanel.id]),O.useEffect(()=>{$e()},[n,e,B,t,D,_,b,X,z,be,Ce]),O.useEffect(()=>{let je;const le=()=>{be&&($e(),je=requestAnimationFrame(le))};return be&&le(),()=>{je&&cancelAnimationFrame(je)}},[be]);const ot=je=>{var on;je.preventDefault(),je.stopPropagation();const le=(on=p.current)==null?void 0:on.getBoundingClientRect();if(!le)return;const Je=le.width,ht=le.height,ut=je.clientX-le.left,ft=je.clientY-le.top,Wt=je.deltaY*.001,Mt=Math.exp(-Wt),dn=Math.min(Math.max(.05,D*Mt),10);if(Math.abs(dn-D)>.001){const Et=(ut-Je/2-_.x)/D,an=(ft-ht/2-_.y)/D,Mn=ut-Je/2-Et*dn,At=ft-ht/2-an*dn;I(dn),F({x:Mn,y:At})}},rt=je=>{K(!0),M({x:je.clientX-_.x,y:je.clientY-_.y})},Ve=je=>{V&&F({x:je.clientX-P.x,y:je.clientY-P.y})},We=()=>{K(!1)},De=()=>{S(je=>je===0?-90:0),F({x:0,y:0}),I(1)},Ge=()=>{I(1),F({x:0,y:0}),S(-90)},Re=[.1,.25,.5,.75,1,1.25,1.5,2,2.5,3,4,5],Ie=()=>{const je=Re.findIndex(Je=>Je>=D),le=Math.min(je+1,Re.length-1);I(Re[le])},Le=()=>{const je=Re.findIndex(Je=>Je>=D),le=Math.max(je-1,0);I(Re[le])},et=()=>{const je=Math.min(X*1.2,3);Z(je)},ct=()=>{const je=Math.max(X*.8,.3);Z(je)},mt=je=>{if(!n||!p.current||!i||V)return;const le=p.current.getBoundingClientRect(),Je=je.clientX-le.left,ht=je.clientY-le.top,ut=le.width,ft=le.height,jt=60,Wt=ut-jt*2,Mt=ft-jt*2,dn=b%180===0?n.stockPanel.width:n.stockPanel.height,on=b%180===0?n.stockPanel.height:n.stockPanel.width,Et=Wt/dn,an=Mt/on,At=Math.min(Et,an,1.2)*D,zt=ut/2+_.x,Zt=ft/2+_.y,$t=b*Math.PI/180,Ht=Math.cos(-$t),Lt=Math.sin(-$t),dt=Je-zt,at=ht-Zt,Ot=dt*Ht-at*Lt,Cn=dt*Lt+at*Ht,Rn=Ot/At+n.stockPanel.width/2,xn=Cn/At+n.stockPanel.height/2;let En=null;for(const Hn of n.panels)if(Rn>=Hn.x&&Rn<=Hn.x+Hn.width&&xn>=Hn.y&&xn<=Hn.y+Hn.height){En=Hn.id;break}i(En)};return l.jsxs("div",{ref:y,className:`${us.container} panel-clickable`,children:[n&&l.jsxs("div",{className:us.headerBar,children:[l.jsxs("div",{className:us.sheetNavSection,children:[l.jsx("button",{className:us.headerNavButton,onClick:()=>d&&d.currentIndex>0&&(f==null?void 0:f(d.currentIndex-1)),disabled:!d||d.currentIndex===0,title:"이전 시트",children:l.jsx(Rve,{size:16})}),l.jsxs("div",{className:us.sheetTitle,children:["Sheet ",d?d.currentIndex+1:1," / ",d?d.totalSheets:1]}),l.jsx("button",{className:us.headerNavButton,onClick:()=>d&&d.currentIndex<d.totalSheets-1&&(f==null?void 0:f(d.currentIndex+1)),disabled:!d||d.currentIndex>=d.totalSheets-1,title:"다음 시트",children:l.jsx(fC,{size:16})})]}),l.jsxs("div",{className:us.headerToolbar,children:[l.jsx("button",{className:us.headerToolButton,onClick:Le,title:"축소",children:l.jsx(eG,{size:16})}),l.jsxs("span",{className:us.zoomLevel,children:[Math.round(D*100),"%"]}),l.jsx("button",{className:us.headerToolButton,onClick:Ie,title:"확대",children:l.jsx(Jz,{size:16})}),l.jsx("div",{className:us.headerDivider}),l.jsx("button",{className:us.headerToolButton,onClick:Ge,title:"초기화",children:l.jsx(ewe,{size:16})}),l.jsx("button",{className:us.headerToolButton,onClick:De,title:"회전",children:l.jsx(Cwe,{size:16})}),l.jsx("button",{className:`${us.headerToolButton} ${z?us.active:""}`,onClick:()=>q(!z),title:"치수 표시",children:l.jsx(a6,{size:16})}),l.jsx("div",{className:us.headerDivider}),l.jsxs("div",{className:us.textSizeControlSmall,children:[l.jsxs("button",{className:us.textSizeBtnSmall,onClick:ct,title:"글자 크기 줄이기",children:[l.jsx("span",{className:us.textLarge,children:"A"}),l.jsx("span",{className:us.textSmall,children:"A"})]}),l.jsxs("button",{className:us.textSizeBtnSmall,onClick:et,title:"글자 크기 키우기",children:[l.jsx("span",{className:us.textSmall,children:"A"}),l.jsx("span",{className:us.textLarge,children:"A"})]})]})]})]}),l.jsx("canvas",{ref:p,className:`${us.canvas} panel-clickable`,style:{cursor:V?"grabbing":"grab",top:d?"40px":"0",height:d?"calc(100% - 40px)":"100%"},onClick:mt,onWheel:ot,onMouseDown:rt,onMouseMove:Ve,onMouseUp:We,onMouseLeave:We}),A&&(H&&xe.length>0||ne)&&l.jsxs("div",{className:us.simulationOverlay,style:{position:"absolute",top:d?"40px":"0",left:0,right:0,bottom:0,pointerEvents:"none",zIndex:10},children:[l.jsxs("svg",{style:{width:"100%",height:"100%",position:"absolute"},children:[!be&&ne&&(()=>{const le=g.filter(Ot=>Ot.sheetNumber===((d==null?void 0:d.currentIndex)||0)+1).find(Ot=>Ot.id===ne);if(!le||!n||!y.current)return null;const Je=y.current.getBoundingClientRect(),ht=Je.width,ut=Je.height-(d?40:0),ft=Math.abs(Math.cos(b*Math.PI/180))*n.stockPanel.width+Math.abs(Math.sin(b*Math.PI/180))*n.stockPanel.height,jt=Math.abs(Math.sin(b*Math.PI/180))*n.stockPanel.width+Math.abs(Math.cos(b*Math.PI/180))*n.stockPanel.height,Wt=ht*.9/ft,Mt=ut*.9/jt,on=Math.min(Wt,Mt,1.2)*D,Et=ht/2+_.x,an=ut/2+_.y,Mn=b*Math.PI/180;let At,zt,Zt,$t;le.axis==="x"?(At=le.pos,zt=le.spanStart!=null?le.spanStart:0,Zt=le.pos,$t=le.spanEnd!=null?le.spanEnd:n.stockPanel.height):(At=le.spanStart!=null?le.spanStart:0,zt=le.pos,Zt=le.spanEnd!=null?le.spanEnd:n.stockPanel.width,$t=le.pos),At=Math.max(0,Math.min(n.stockPanel.width,At)),Zt=Math.max(0,Math.min(n.stockPanel.width,Zt)),zt=Math.max(0,Math.min(n.stockPanel.height,zt)),$t=Math.max(0,Math.min(n.stockPanel.height,$t));const Ht=(Ot,Cn)=>{const Rn=Ot-n.stockPanel.width/2,xn=Cn-n.stockPanel.height/2,En=Rn*Math.cos(Mn)-xn*Math.sin(Mn),Hn=Rn*Math.sin(Mn)+xn*Math.cos(Mn);return{x:Et+En*on,y:an+Hn*on}},Lt=Ht(At,zt),dt=Ht(Zt,$t),at=Math.max(2,(le.kerf||G.kerf||5)*on);return l.jsx("line",{x1:Lt.x,y1:Lt.y,x2:dt.x,y2:dt.y,stroke:"#FF4D4F",strokeWidth:at,opacity:1,strokeDasharray:"5,5",className:us.animatedCut})})(),xe.slice(0,Ce+1).map((je,le)=>{if(!n||!y.current)return null;const Je=y.current.getBoundingClientRect(),ht=Je.width,ut=Je.height-(d?40:0),ft=Math.abs(Math.cos(b*Math.PI/180))*n.stockPanel.width+Math.abs(Math.sin(b*Math.PI/180))*n.stockPanel.height,jt=Math.abs(Math.sin(b*Math.PI/180))*n.stockPanel.width+Math.abs(Math.cos(b*Math.PI/180))*n.stockPanel.height,Wt=ht*.9/ft,Mt=ut*.9/jt,on=Math.min(Wt,Mt,1.2)*D,Et=ht/2+_.x,an=ut/2+_.y,Mn=b*Math.PI/180;let At,zt,Zt,$t;je.axis==="x"?(At=je.pos,zt=je.spanStart,Zt=je.pos,$t=je.spanEnd):(At=je.spanStart,zt=je.pos,Zt=je.spanEnd,$t=je.pos);const Ht=(Cn,Rn)=>{const xn=Cn-n.stockPanel.width/2,En=Rn-n.stockPanel.height/2,Hn=xn*Math.cos(Mn)-En*Math.sin(Mn),Kn=xn*Math.sin(Mn)+En*Math.cos(Mn);return{x:Et+Hn*on,y:an+Kn*on}},Lt=Ht(At,zt),dt=Ht(Zt,$t),at=le===Ce,Ot=Math.max(2,(je.kerf||G.kerf||5)*on);return l.jsx("line",{x1:Lt.x,y1:Lt.y,x2:dt.x,y2:dt.y,stroke:"#FF4D4F",strokeWidth:Ot,opacity:at?1:.35,strokeDasharray:at?"5,5":"none",className:at?us.animatedCut:""},je.id)})]}),(()=>{const je=te.find(Ht=>Ht.panelId===H&&Ht.sheetId===String((d==null?void 0:d.currentIndex)+1||1));if(!je||!n||!y.current)return null;const le=y.current.getBoundingClientRect(),Je=le.width,ht=le.height-(d?40:0),ut=Math.abs(Math.cos(b*Math.PI/180))*n.stockPanel.width+Math.abs(Math.sin(b*Math.PI/180))*n.stockPanel.height,ft=Math.abs(Math.sin(b*Math.PI/180))*n.stockPanel.width+Math.abs(Math.cos(b*Math.PI/180))*n.stockPanel.height,jt=Je*.9/ut,Wt=ht*.9/ft,dn=Math.min(jt,Wt,1.2)*D,on=Je/2+_.x,Et=ht/2+_.y,an=b*Math.PI/180,Mn=(Ht,Lt)=>{const dt=Ht-n.stockPanel.width/2,at=Lt-n.stockPanel.height/2,Ot=dt*Math.cos(an)-at*Math.sin(an),Cn=dt*Math.sin(an)+at*Math.cos(an);return{x:on+Ot*dn,y:Et+Cn*dn}},At=Mn(je.x,je.y),zt=Mn(je.x+je.width,je.y),Zt=Mn(je.x+je.width,je.y+je.height),$t=Mn(je.x,je.y+je.height);return l.jsx("svg",{style:{width:"100%",height:"100%",position:"absolute"},children:l.jsx("polygon",{points:`${At.x},${At.y} ${zt.x},${zt.y} ${Zt.x},${Zt.y} ${$t.x},${$t.y}`,fill:"hsl(var(--theme))",opacity:.15})})})()]}),A&&H&&xe.length>0&&l.jsxs("div",{className:us.simulationControls,children:[l.jsx("button",{onClick:()=>{Be(Math.max(0,Ce-1)),ce(Math.max(0,Ce-1))},disabled:Ce===0,title:"이전 절단",children:l.jsx(kwe,{size:16})}),l.jsx("button",{onClick:()=>_e(!be),className:us.playButton,title:be?"일시정지":"재생",children:be?l.jsx(Gz,{size:18}):l.jsx(o6,{size:18})}),l.jsx("button",{onClick:()=>{Be(Math.min(xe.length-1,Ce+1)),ce(Math.min(xe.length-1,Ce+1))},disabled:Ce>=xe.length-1,title:"다음 절단",children:l.jsx(Fwe,{size:16})}),l.jsxs("div",{className:us.speedControl,children:[l.jsxs("label",{children:["속도: ",W,"x"]}),l.jsx("input",{type:"range",min:"0.25",max:"3",step:"0.25",value:W,onChange:je=>Y(parseFloat(je.target.value))})]}),l.jsxs("div",{className:us.cutInfo,children:[Ce+1," / ",xe.length," 절단"]})]}),!n&&l.jsxs("div",{className:us.emptyState,children:[l.jsx("div",{className:us.emptyIcon,children:"📐"}),l.jsx("p",{children:"No optimization result to display"})]})]})},CQe="_container_13ybf_1",SQe="_header_13ybf_10",TQe="_headerLeft_13ybf_21",BQe="_projectName_13ybf_37",EQe="_headerRight_13ybf_44",kQe="_exportGroup_13ybf_50",IQe="_divider_13ybf_56",FQe="_calculateButton_13ybf_63",DQe="_highlighted_13ybf_90",jQe="_dropdownContainer_13ybf_114",PQe="_dropdownButton_13ybf_118",NQe="_rotated_13ybf_142",LQe="_dropdownMenu_13ybf_220",MQe="_dropdownItem_13ybf_233",RQe="_active_13ybf_257",OQe="_exitButton_13ybf_263",UQe="_primary_13ybf_305",HQe="_main_13ybf_325",WQe="_leftSidebar_13ybf_338",QQe="_centerPanel_13ybf_358",$Qe="_viewerContainer_13ybf_368",VQe="_keyboardHint_13ybf_376",zQe="_mainViewer_13ybf_411",GQe="_thumbnailBar_13ybf_473",XQe="_thumbnailScroll_13ybf_485",KQe="_sheetNumber_13ybf_541",qQe="_sheetPanels_13ybf_555",YQe="_sheetEfficiency_13ybf_560",ZQe="_thumbnailWrapper_13ybf_567",JQe="_thumbnailTitle_13ybf_576",e$e="_thumbnail_13ybf_473",t$e="_activeThumbnail_13ybf_607",n$e="_thumbnailCanvas_13ybf_618",i$e="_optimizeButtonLarge_13ybf_719",r$e="_emptyPreview_13ybf_746",s$e="_rightSidebar_13ybf_776",o$e="_statsCard_13ybf_801",a$e="_statsCardTitle_13ybf_818",l$e="_foldButton_13ybf_830",c$e="_statsCardHeader_13ybf_850",h$e="_statsNavButton_13ybf_870",u$e="_playButton_13ybf_895",d$e="_playing_13ybf_920",A$e="_rightSidebarContent_13ybf_954",f$e="_sheetListCard_13ybf_963",p$e="_sheetList_13ybf_963",g$e="_sheetItemContainer_13ybf_1002",m$e="_sheetItem_13ybf_1002",y$e="_expandButton_13ybf_1025",v$e="_sheetListHeader_13ybf_1057",w$e="_tabButtons_13ybf_1065",x$e="_tabButton_13ybf_1065",b$e="_sheetInfo_13ybf_1139",_$e="_panelListContainer_13ybf_1155",C$e="_panelItem_13ybf_1169",S$e="_selectedPanel_13ybf_1188",T$e="_panelName_13ybf_1194",B$e="_panelSize_13ybf_1203",E$e="_cutsList_13ybf_1211",k$e="_cutsTableHeader_13ybf_1218",I$e="_cutsTableBody_13ybf_1235",F$e="_cutsRow_13ybf_1260",D$e="_selected_13ybf_1188",j$e="_cutsCol1_13ybf_1288",P$e="_cutsCol2_13ybf_1294",N$e="_cutsCol3_13ybf_1299",L$e="_cutsCol4_13ybf_1304",M$e="_statsDetail_13ybf_1311",R$e="_statRow_13ybf_1318",O$e="_statValue_13ybf_1336",U$e="_statPercent_13ybf_1350",_n={container:CQe,header:SQe,headerLeft:TQe,projectName:BQe,headerRight:EQe,exportGroup:kQe,divider:IQe,calculateButton:FQe,highlighted:DQe,dropdownContainer:jQe,dropdownButton:PQe,rotated:NQe,dropdownMenu:LQe,dropdownItem:MQe,active:RQe,exitButton:OQe,primary:UQe,main:HQe,leftSidebar:WQe,centerPanel:QQe,viewerContainer:$Qe,keyboardHint:VQe,mainViewer:zQe,thumbnailBar:GQe,thumbnailScroll:XQe,sheetNumber:KQe,sheetPanels:qQe,sheetEfficiency:YQe,thumbnailWrapper:ZQe,thumbnailTitle:JQe,thumbnail:e$e,activeThumbnail:t$e,thumbnailCanvas:n$e,optimizeButtonLarge:i$e,emptyPreview:r$e,rightSidebar:s$e,statsCard:o$e,statsCardTitle:a$e,foldButton:l$e,statsCardHeader:c$e,statsNavButton:h$e,playButton:u$e,playing:d$e,rightSidebarContent:A$e,sheetListCard:f$e,sheetList:p$e,sheetItemContainer:g$e,sheetItem:m$e,expandButton:y$e,sheetListHeader:v$e,tabButtons:w$e,tabButton:x$e,sheetInfo:b$e,panelListContainer:_$e,panelItem:C$e,selectedPanel:S$e,panelName:T$e,panelSize:B$e,cutsList:E$e,cutsTableHeader:k$e,cutsTableBody:I$e,cutsRow:F$e,selected:D$e,cutsCol1:j$e,cutsCol2:P$e,cutsCol3:N$e,cutsCol4:L$e,statsDetail:M$e,statRow:R$e,statValue:O$e,statPercent:U$e};function H$e({result:n,index:e,isActive:t,onClick:i}){const r=O.useRef(null);O.useEffect(()=>{const a=r.current;if(!a||!n)return;const c=a.getContext("2d");if(!c)return;const h=n.stockPanel.width,u=n.stockPanel.height,d=u>h,f=d?u:h,A=d?h:u,g=120,p=60,y=Math.min(g/f,p/A),v=window.devicePixelRatio||1;a.width=g*v,a.height=p*v,a.style.width=`${g}px`,a.style.height=`${p}px`,c.scale(v,v),c.imageSmoothingEnabled=!0,c.imageSmoothingQuality="high";const m=c.createLinearGradient(0,0,0,p);m.addColorStop(0,"#ffffff"),m.addColorStop(1,"#fafbfc"),c.fillStyle=m,c.fillRect(0,0,g,p);const w=f*y,x=A*y,T=(g-w)/2,j=(p-x)/2;c.save(),c.shadowColor="rgba(0, 0, 0, 0.08)",c.shadowBlur=4,c.shadowOffsetY=2,c.fillStyle="#ffffff",c.fillRect(T,j,w,x),c.restore(),c.strokeStyle="#e5e7eb",c.lineWidth=1,c.strokeRect(T,j,w,x);const D=getComputedStyle(document.documentElement).getPropertyValue("--theme").trim()||"220 90% 56%";if(n.panels.forEach(b=>{let _,I,S,F;d?(_=T+b.y*y,I=j+(h-b.x-b.width)*y,S=(b.rotated?b.width:b.height)*y,F=(b.rotated?b.height:b.width)*y):(_=T+b.x*y,I=j+b.y*y,S=(b.rotated?b.height:b.width)*y,F=(b.rotated?b.width:b.height)*y);const B={PB:{fill:`hsl(${D} / 0.06)`,stroke:`hsl(${D} / 0.3)`},MDF:{fill:"rgba(212, 165, 116, 0.3)",stroke:"rgba(139, 98, 57, 0.5)"},PET:{fill:"rgba(209, 213, 219, 0.6)",stroke:"rgba(107, 114, 128, 0.6)"},PLY:{fill:"rgba(232, 212, 176, 0.3)",stroke:"rgba(166, 137, 102, 0.5)"},HPL:{fill:`hsl(${D} / 0.12)`,stroke:`hsl(${D} / 0.35)`},LPM:{fill:`hsl(${D} / 0.14)`,stroke:`hsl(${D} / 0.35)`}},E=B[b.material]||B.PB;c.fillStyle=E.fill,c.fillRect(_,I,S,F),c.strokeStyle=E.stroke,c.lineWidth=.5,c.strokeRect(_,I,S,F)}),c.save(),c.fillStyle="#374151",c.font="bold 11px -apple-system, sans-serif",c.textAlign="left",c.textBaseline="top",c.fillText(n.stockPanel.material||"PB",6,6),c.restore(),n.efficiency>0){c.save();const b=n.efficiency.toFixed(0),_=24,I=g-_-6,S=6,F=n.efficiency>80?"#10b981":n.efficiency>60?"#f59e0b":"#ef4444";c.fillStyle=F,c.beginPath(),c.roundRect(I,S,_,16,8),c.fill(),c.fillStyle="white",c.font="bold 10px -apple-system, sans-serif",c.textAlign="center",c.textBaseline="middle",c.fillText(`${b}%`,I+_/2,S+8),c.restore()}},[n]);const s=n.panels.length>0?n.panels[0].thickness:18,o=n.stockPanel.material||"PB";return l.jsxs("div",{className:_n.thumbnailWrapper,children:[l.jsxs("div",{className:_n.thumbnailTitle,children:["Sheet ",e+1," - ",o," (",s,"T)"]}),l.jsx("div",{className:`${_n.thumbnail} ${t?_n.activeThumbnail:""}`,onClick:i,children:l.jsx("canvas",{ref:r,className:_n.thumbnailCanvas})})]})}const W$e="_overlay_1put7_1",Q$e="_modal_1put7_25",$$e="_aiIconContainer_1put7_51",V$e="_aiIcon_1put7_51",z$e="_pulseRing_1put7_90",G$e="_pulseRing2_1put7_91",X$e="_title_1put7_119",K$e="_dots_1put7_129",q$e="_phase_1put7_137",Y$e="_progressContainer_1put7_156",Z$e="_progressBar_1put7_161",J$e="_progressFill_1put7_169",eVe="_progressGlow_1put7_192",tVe="_progressText_1put7_215",nVe="_dataStream_1put7_225",iVe="_dataLine_1put7_236",rVe="_dataChar_1put7_259",sVe="_neuralNetwork_1put7_279",oVe="_networkSvg_1put7_289",aVe="_node_1put7_294",lVe="_connection_1put7_318",io={overlay:W$e,modal:Q$e,aiIconContainer:$$e,aiIcon:V$e,pulseRing:z$e,pulseRing2:G$e,title:X$e,dots:K$e,phase:q$e,progressContainer:Y$e,progressBar:Z$e,progressFill:J$e,progressGlow:eVe,progressText:tVe,dataStream:nVe,dataLine:iVe,dataChar:rVe,neuralNetwork:sVe,networkSvg:oVe,node:aVe,connection:lVe},cVe=({isOpen:n,progress:e=0,message:t,duration:i=5e3})=>{const{t:r}=Eo(),[s,o]=O.useState(0),[a,c]=O.useState(0),h=[r("cnc.aiPhase1"),r("cnc.aiPhase2"),r("cnc.aiPhase3"),r("cnc.aiPhase4"),r("cnc.aiPhase5")],u=t||r("cnc.aiOptimizing");return O.useEffect(()=>{if(!n)return;const d=setInterval(()=>{o(g=>(g+1)%4)},500),f=Math.max(500,i/h.length),A=setInterval(()=>{c(g=>(g+1)%h.length)},f);return()=>{clearInterval(d),clearInterval(A)}},[n]),n?l.jsx("div",{className:io.overlay,children:l.jsxs("div",{className:io.modal,children:[l.jsxs("div",{className:io.aiIconContainer,children:[l.jsx("div",{className:io.aiIcon,children:l.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("circle",{cx:"12",cy:"12",r:"10"}),l.jsx("path",{d:"M12 6v6l4 2"})]})}),l.jsx("div",{className:io.pulseRing}),l.jsx("div",{className:io.pulseRing2})]}),l.jsxs("h3",{className:io.title,children:[u,l.jsx("span",{className:io.dots,children:".".repeat(s)})]}),l.jsx("p",{className:io.phase,children:h[a]}),l.jsxs("div",{className:io.progressContainer,children:[l.jsxs("div",{className:io.progressBar,children:[l.jsx("div",{className:io.progressFill,style:{width:`${e}%`}}),l.jsx("div",{className:io.progressGlow})]}),l.jsxs("span",{className:io.progressText,children:[Math.round(e),"%"]})]}),l.jsx("div",{className:io.dataStream,children:Array.from({length:5}).map((d,f)=>l.jsx("div",{className:io.dataLine,style:{animationDelay:`${f*.2}s`},children:Array.from({length:20}).map((A,g)=>l.jsx("span",{className:io.dataChar,children:Math.random()>.5?"1":"0"},g))},f))}),l.jsx("div",{className:io.neuralNetwork,children:l.jsxs("svg",{viewBox:"0 0 200 100",className:io.networkSvg,children:[[20,50,80].map((d,f)=>l.jsx("circle",{cx:"30",cy:d,r:"4",className:io.node},`input-${f}`)),[15,35,50,65,85].map((d,f)=>l.jsx("circle",{cx:"70",cy:d,r:"4",className:io.node},`hidden1-${f}`)),[20,40,60,80].map((d,f)=>l.jsx("circle",{cx:"110",cy:d,r:"4",className:io.node},`hidden2-${f}`)),[35,65].map((d,f)=>l.jsx("circle",{cx:"150",cy:d,r:"4",className:io.node},`output-${f}`)),[20,50,80].map(d=>[15,35,50,65,85].map(f=>l.jsx("line",{x1:"30",y1:d,x2:"70",y2:f,className:io.connection},`line1-${d}-${f}`))),[15,35,50,65,85].map(d=>[20,40,60,80].map(f=>l.jsx("line",{x1:"70",y1:d,x2:"110",y2:f,className:io.connection},`line2-${d}-${f}`))),[20,40,60,80].map(d=>[35,65].map(f=>l.jsx("line",{x1:"110",y1:d,x2:"150",y2:f,className:io.connection},`line3-${d}-${f}`)))]})})]})}):null},hVe="_overlay_1uars_1",uVe="_modal_1uars_25",dVe="_header_1uars_46",AVe="_title_1uars_54",fVe="_closeButton_1uars_61",pVe="_content_1uars_80",gVe="_icon_1uars_85",mVe="_message_1uars_97",yVe="_subMessage_1uars_105",vVe="_footer_1uars_112",wVe="_cancelButton_1uars_120",xVe="_confirmButton_1uars_121",Ih={overlay:hVe,modal:uVe,header:dVe,title:AVe,closeButton:fVe,content:pVe,icon:gVe,message:mVe,subMessage:yVe,footer:vVe,cancelButton:wVe,confirmButton:xVe},bVe=({isOpen:n,onConfirm:e,onCancel:t})=>{const{t:i}=Eo();return n?l.jsx("div",{className:Ih.overlay,onClick:t,children:l.jsxs("div",{className:Ih.modal,onClick:r=>r.stopPropagation(),children:[l.jsxs("div",{className:Ih.header,children:[l.jsx("h3",{className:Ih.title,children:i("common.confirm")}),l.jsx("button",{className:Ih.closeButton,onClick:t,children:l.jsx(Zz,{size:20})})]}),l.jsxs("div",{className:Ih.content,children:[l.jsx("div",{className:Ih.icon,children:l.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("circle",{cx:"12",cy:"12",r:"10"}),l.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),l.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]})}),l.jsx("p",{className:Ih.message,children:i("cnc.exitConfirmMessage")}),l.jsx("p",{className:Ih.subMessage,children:i("cnc.unsavedChangesWarning")})]}),l.jsxs("div",{className:Ih.footer,children:[l.jsx("button",{className:Ih.cancelButton,onClick:t,children:i("common.cancel")}),l.jsx("button",{className:Ih.confirmButton,onClick:e,children:i("cnc.exit")})]})]})}):null};class d8{constructor(e,t,i=5){rr(this,"binWidth");rr(this,"binHeight");rr(this,"kerf");rr(this,"strips",[]);rr(this,"bestLayout",null);this.binWidth=e,this.binHeight=t,this.kerf=i}packAll(e,t="auto"){const i=[...e].sort((o,a)=>{const c=o.width*o.height;return a.width*a.height-c});let r,s;if(t==="horizontal")r=this.packWithStrips(i,!0),s=this.calculateEfficiency(r);else if(t==="vertical")r=this.packWithStrips(i,!1),s=this.calculateEfficiency(r);else{const o=this.packWithStrips(i,!0),a=this.calculateEfficiency(o),c=this.packWithStrips(i,!1),h=this.calculateEfficiency(c),u=this.packWithMixedStrategy(i),d=this.calculateEfficiency(u);r=o,s=a,h>s&&(r=c,s=h),d>s&&(r=u,s=d)}return this.strips=r,this.bestLayout={strips:r,efficiency:s},this.getResult()}packWithMixedStrategy(e){const t=[],i=[...e],s=e.reduce((h,u)=>h+u.width*u.height,0)/e.length,o=i.filter(h=>h.width*h.height>s*1.5),a=i.filter(h=>h.width*h.height<=s*1.5);let c=0;if(o.length>0){const h=this.packWithStrips(o,!0);for(const u of h)if(c+u.height<=this.binHeight){const d=u.panels.map(A=>({...A,y:c})),f={...u,y:c,panels:d};t.push(f),c+=u.height+this.kerf}}if(a.length>0&&c<this.binHeight){const h=this.binHeight-c,d=new d8(this.binWidth,h,this.kerf).packWithStrips(a,!1);for(const f of d){const A=f.panels.map(p=>({...p,y:p.y+c})),g={...f,y:f.y+c,panels:A};t.push(g)}}return t}packWithStrips(e,t){const i=[],s=[...this.sortPanels(e,t)];let o=0;for(;s.length>0;){const a=this.createStrip(s,o,t);if(!a||a.panels.length===0||(i.push(a),a.panels.forEach(c=>{const h=s.findIndex(u=>u.id===c.id&&u.width===c.width&&u.height===c.height);h!==-1&&s.splice(h,1)}),t?o=a.y+a.height+this.kerf:o=a.x+a.width+this.kerf,t&&o>=this.binHeight||!t&&o>=this.binWidth))break}return i}createStrip(e,t,i){if(e.length===0)return null;const r={x:i?0:t,y:i?t:0,width:i?this.binWidth:0,height:i?0:this.binHeight,panels:[],horizontal:i};if(i){let s=0,o=0;const a=this.binHeight-t;if(a<=0)return null;const c=e.map(A=>A.height),h=e.filter(A=>A.canRotate).map(A=>A.width),u=[...c,...h].sort((A,g)=>g-A);for(const A of u)if(A<=a){let g=0,p=0;for(const v of e){const w=Math.abs(v.height-A)/A<=.1,x=v.canRotate&&Math.abs(v.width-A)/A<=.1;(w||x)&&g+v.width<=this.binWidth&&(g+=(w?v.width:v.height)+this.kerf,p++)}const y=g/this.binWidth*p;y>o&&(s=A,o=y)}if(s===0||(r.height=s,r.y+r.height>this.binHeight))return null;let d=0;const f=new Set;for(const A of e){if(f.has(A))continue;if(Math.abs(A.height-r.height)/r.height<=.1&&d+A.width<=this.binWidth){const p={...A,x:d,y:r.y,stripIndex:this.strips.length};r.panels.push(p),d+=A.width+this.kerf,f.add(A)}}for(const A of e){if(f.has(A)||!A.canRotate)continue;if(Math.abs(A.width-r.height)/r.height<=.1&&d+A.height<=this.binWidth){const p={...A,x:d,y:r.y,rotated:!0,stripIndex:this.strips.length};r.panels.push(p),d+=A.height+this.kerf,f.add(A)}}}else{let s=0,o=0;const a=this.binWidth-t;if(a<=0)return null;const c=e.map(A=>A.width),h=e.filter(A=>A.canRotate).map(A=>A.height),u=[...c,...h].sort((A,g)=>g-A);for(const A of u)if(A<=a){let g=0,p=0;for(const v of e){const w=Math.abs(v.width-A)/A<=.1,x=v.canRotate&&Math.abs(v.height-A)/A<=.1;(w||x)&&g+v.height<=this.binHeight&&(g+=(w?v.height:v.width)+this.kerf,p++)}const y=g/this.binHeight*p;y>o&&(s=A,o=y)}if(s===0||(r.width=s,r.x+r.width>this.binWidth))return null;let d=0;const f=new Set;for(const A of e){if(f.has(A))continue;if(Math.abs(A.width-r.width)/r.width<=.1&&d+A.height<=this.binHeight){const p={...A,x:r.x,y:d,stripIndex:this.strips.length};r.panels.push(p),d+=A.height+this.kerf,f.add(A)}}for(const A of e){if(f.has(A)||!A.canRotate)continue;if(Math.abs(A.height-r.width)/r.width<=.1&&d+A.width<=this.binHeight){const p={...A,x:r.x,y:d,rotated:!0,stripIndex:this.strips.length};r.panels.push(p),d+=A.width+this.kerf,f.add(A)}}}return r.panels.length>0?r:null}sortPanels(e,t){return[...e].sort((i,r)=>{if(t){const s=r.height-i.height;return s!==0?s:r.width*r.height-i.width*i.height}else{const s=r.width-i.width;return s!==0?s:r.width*r.height-i.width*i.height}})}calculateEfficiency(e){let t=0;for(const r of e)for(const s of r.panels)t+=s.width*s.height;const i=this.binWidth*this.binHeight;return i>0?t/i*100:0}getResult(){var s;const e=[];let t=0;const i=new Set;for(const o of this.strips)for(const a of o.panels){const c=`${a.id}-${a.x}-${a.y}`;if(i.has(c)){console.warn(`Duplicate panel detected: ${c}`);continue}i.add(c);const h={...a};h.x<0&&(h.x=0),h.y<0&&(h.y=0);const u=h.rotated?h.height:h.width,d=h.rotated?h.width:h.height;if(h.x+u>this.binWidth){console.warn(`Panel extends beyond bin width: ${h.x+u} > ${this.binWidth}`);continue}if(h.y+d>this.binHeight){console.warn(`Panel extends beyond bin height: ${h.y+d} > ${this.binHeight}`);continue}e.push(h),t+=h.width*h.height}const r=((s=this.bestLayout)==null?void 0:s.efficiency)||0;return{width:this.binWidth,height:this.binHeight,panels:e,efficiency:r,usedArea:t}}}function lR(n,e,t,i=5,r=999,s="auto"){const o=[];let a=0;const c=[...n];for(;c.length>0&&a<r;){const u=new d8(e,t,i).packAll(c,s);if(u.panels.length===0){console.warn("Cannot place any more panels in guillotine mode");break}for(const d of u.panels){const f=c.findIndex(A=>A.id===d.id&&A.width===d.width&&A.height===d.height);f!==-1&&c.splice(f,1)}o.push(u),a++}return o}class _Ve{constructor(e,t,i=5){rr(this,"binWidth");rr(this,"binHeight");rr(this,"kerf");rr(this,"freeRects",[]);rr(this,"placedPanels",[]);this.binWidth=e,this.binHeight=t,this.kerf=i,this.freeRects=[{x:0,y:0,width:e,height:t}]}pack(e){let t=1/0,i=1/0,r=null,s=!1,o=-1;for(let a=0;a<this.freeRects.length;a++){const c=this.freeRects[a];if(e.width+this.kerf<=c.width&&e.height+this.kerf<=c.height){const h=c.width-e.width-this.kerf,u=c.height-e.height-this.kerf,d=c.width*c.height-e.width*e.height,f=Math.min(h,u);(d<t||d===t&&f<i)&&(t=d,i=f,r=c,s=!1,o=a)}if(e.canRotate!==!1&&e.height+this.kerf<=c.width&&e.width+this.kerf<=c.height){const h=c.width-e.height-this.kerf,u=c.height-e.width-this.kerf,d=c.width*c.height-e.width*e.height,f=Math.min(h,u);(d<t||d===t&&f<i)&&(t=d,i=f,r=c,s=!0,o=a)}}if(r&&o>=0){const a=s?e.height:e.width,c=s?e.width:e.height,h={...e,x:r.x,y:r.y,width:e.width,height:e.height,rotated:s};return this.placedPanels.push(h),this.splitFreeRect(r,o,a+this.kerf,c+this.kerf),this.pruneFreeRects(),h}return null}splitFreeRect(e,t,i,r){this.freeRects.splice(t,1),e.width>i&&this.freeRects.push({x:e.x+i,y:e.y,width:e.width-i,height:r}),e.height>r&&this.freeRects.push({x:e.x,y:e.y+r,width:e.width,height:e.height-r}),e.width>i&&e.height>r&&this.freeRects.push({x:e.x+i,y:e.y+r,width:e.width-i,height:e.height-r})}pruneFreeRects(){const e=[];for(let t=0;t<this.freeRects.length;t++){const i=this.freeRects[t];let r=!1;for(let s=0;s<this.freeRects.length;s++){if(t===s)continue;const o=this.freeRects[s];if(i.x>=o.x&&i.y>=o.y&&i.x+i.width<=o.x+o.width&&i.y+i.height<=o.y+o.height){r=!0;break}}r||e.push(i)}this.freeRects=e}getResult(){let e=0;for(const r of this.placedPanels)e+=r.width*r.height;const t=this.binWidth*this.binHeight,i=t>0?e/t*100:0;return i>95&&this.placedPanels.length<=3&&(console.warn("Suspicious high efficiency detected:"),console.warn("Sheet size:",this.binWidth,"x",this.binHeight,"=",t),console.warn("Used area:",e),console.warn("Efficiency:",i.toFixed(2)+"%"),console.warn("Panels:",this.placedPanels.map(r=>({id:r.id,size:`${r.width}x${r.height}`,pos:`(${r.x},${r.y})`,rotated:r.rotated})))),{width:this.binWidth,height:this.binHeight,panels:this.placedPanels,efficiency:i,usedArea:e}}}function CVe(n,e,t,i=5,r=999){const s=[...n].sort((h,u)=>{const d=h.width*h.height,f=u.width*u.height;if(Math.abs(d-f)>1e4)return f-d;const A=Math.max(h.width,h.height);return Math.max(u.width,u.height)-A}),o=[];let a=0;const c=[...s];for(;c.length>0&&a<r;){const h=new _Ve(e,t,i),u=[];for(let f=0;f<c.length;f++){const A=c[f];h.pack(A)&&u.push(f)}if(u.length===0){console.warn("Cannot place any more panels");break}u.reverse().forEach(f=>{c.splice(f,1)});const d=h.getResult();o.push(d),a++}return o}class ly{static toInt(e){return Math.round(e*this.PRECISION)}static toMm(e){return e/this.PRECISION}static add(e,t){const i=this.toInt(e),r=this.toInt(t);return this.toMm(i+r)}static subtract(e,t){const i=this.toInt(e),r=this.toInt(t);return this.toMm(i-r)}static multiply(e,t){const i=this.toInt(e),r=this.toInt(t);return this.toMm(i*r/this.PRECISION)}static divide(e,t){const i=this.toInt(e),r=this.toInt(t);return this.toMm(i*this.PRECISION/r)}static equals(e,t){return this.toInt(e)===this.toInt(t)}static lte(e,t){return this.toInt(e)<=this.toInt(t)}static gte(e,t){return this.toInt(e)>=this.toInt(t)}}rr(ly,"PRECISION",10);class SVe{static checkOverlap(e,t,i){const r=ly,s=r.add(e.x,e.width),o=r.add(e.y,e.height),a=r.add(t.x,t.width),c=r.add(t.y,t.height),h=r.add(s,i),u=r.add(o,i);r.subtract(t.x,i),r.subtract(t.y,i);const d=r.lte(h,t.x)||r.gte(e.x,a),f=r.lte(u,t.y)||r.gte(e.y,c);return!(d||f)}static checkInBounds(e,t,i){const r=ly,s=r.add(e.x,e.width),o=r.add(e.y,e.height);return r.gte(e.x,0)&&r.gte(e.y,0)&&r.lte(s,t)&&r.lte(o,i)}static validatePlacement(e,t,i,r){const s=[];for(const o of e)this.checkInBounds(o,t,i)||s.push(`Panel ${o.id} exceeds sheet bounds: ${o.x},${o.y} ${o.width}x${o.height} in ${t}x${i}`);for(let o=0;o<e.length;o++)for(let a=o+1;a<e.length;a++)this.checkOverlap(e[o],e[a],r)&&s.push(`Panels ${e[o].id} and ${e[a].id} overlap`);for(const o of e){const a=ly,c=a.equals(o.x,a.toMm(a.toInt(o.x))),h=a.equals(o.y,a.toMm(a.toInt(o.y))),u=a.equals(o.width,a.toMm(a.toInt(o.width))),d=a.equals(o.height,a.toMm(a.toInt(o.height)));(!c||!h||!u||!d)&&s.push(`Panel ${o.id} has precision errors in dimensions`)}return{valid:s.length===0,errors:s}}static calculateExactArea(e){const t=ly;let i=0;for(const r of e){const s=t.multiply(r.width,r.height);i=t.add(i,s)}return i}}const TVe=async(n,e,t=999,i=!0,r=5,s="OPTIMAL_CNC")=>{const o=[],a=new Map;n.forEach(u=>{for(let d=0;d<u.quantity;d++){const f=`${u.id}-${d}`,A=u.grain&&u.grain!=="NONE"?!1:u.canRotate!==!1;o.push({id:f,width:u.width,height:u.height,grain:u.grain||"NONE",material:u.material,color:u.color,name:u.name,canRotate:A}),a.set(f,u)}});let c;s==="OPTIMAL_L"||s==="BY_LENGTH"?c=lR(o,e.width,e.height,r,t,"vertical"):s==="OPTIMAL_W"||s==="BY_WIDTH"?c=lR(o,e.width,e.height,r,t,"horizontal"):c=CVe(o,e.width,e.height,r,t);const h=[];return c.slice(0,t).forEach((u,d)=>{const f=u.panels.map(v=>{const m=a.get(v.id),w=v.rotated||!1;return{...m,id:v.id,x:v.x||0,y:v.y||0,width:m.width,height:m.height,rotated:w,quantity:1,grain:m.grain||"NONE",material:m.material,color:m.color,name:m.name}});SVe.validatePlacement(f,e.width,e.height,r).valid;const g=f.reduce((v,m)=>v+m.width*m.height,0),p=u.width*u.height,y=g/p*100;y>95&&f.length<=3&&(console.warn("Suspicious efficiency in optimizer:"),console.warn("Bin efficiency:",u.efficiency.toFixed(2)+"%"),console.warn("Recalculated efficiency:",y.toFixed(2)+"%"),console.warn("Panels:",f.length),console.warn("Used area:",g,"vs bin.usedArea:",u.usedArea),console.warn("Total area:",p)),h.push({stockPanel:{...e,id:`${e.id}-${d}`},panels:f,efficiency:y,wasteArea:p-g,usedArea:g})}),h};function cR(n,e){return`${Math.round(n)}×${Math.round(e)}`}function hR(n){let e=0;const t=new Map;for(const i of n){const r=`${i.sheetId}|${i.axis}|${i.pos.toFixed(3)}`;t.has(r)||t.set(r,[]),t.get(r).push({start:Math.min(i.spanStart,i.spanEnd),end:Math.max(i.spanStart,i.spanEnd),kerf:i.kerf||0})}for(const[,i]of t){i.sort((o,a)=>o.start-a.start);const r=[];let s=i[0];for(let o=1;o<i.length;o++){const a=i[o];a.start<=s.end?s={start:s.start,end:Math.max(s.end,a.end),kerf:Math.max(s.kerf,a.kerf)}:(r.push(s),s=a)}r.push(s);for(const o of r){const a=o.end-o.start;e+=a}}return e}function BVe(n,e="m"){const t={},i={},r=new Map;for(const c of n)r.has(c.sheetId)||r.set(c.sheetId,[]),r.get(c.sheetId).push(c);let s=0,o=0;for(const[c,h]of r){const u=h.filter(p=>p.axis==="y"),d=h.filter(p=>p.axis==="x"),f=hR(u),A=hR(d),g=f+A;t[c]=e==="m"?g/1e3:g,i[c]={horizontal:e==="m"?f/1e3:f,vertical:e==="m"?A/1e3:A,cuts:h.length},s+=g,o+=h.length}const a=n.length>0?n.reduce((c,h)=>c+(h.kerf||0),0)/n.length:0;return{bySheet:t,total:e==="m"?s/1e3:s,unit:e,totalCuts:o,avgKerf:e==="m"?a/1e3:a,details:i}}function EVe(){xc();const{basicInfo:n}=Ha(),{panels:e}=JHe(),{t}=Eo(),{theme:i}=Yo(),{panels:r,setPanels:s,stock:o,setStock:a,settings:c,setSettings:h,selectedPanelId:u,setSelectedPanelId:d,currentSheetIndex:f,setCurrentSheetIndex:A,userHasModifiedPanels:g,setUserHasModifiedPanels:p,setPlacements:y,selectPanel:v,simulating:m,setSimulating:w,simSpeed:x,setSimSpeed:T,selectedCutIndex:j,selectCutIndex:D,selectedCutId:b,selectCutId:_,setSelectedSheetId:I,sawStats:S,setSawStats:F}=Lg(),[B,E]=O.useState([]),[V,K]=O.useState(!1);O.useRef(null),O.useRef(null);const P=O.useRef([]),[M,X]=O.useState(1),[Z,Q]=O.useState(-90),[U,z]=O.useState({x:0,y:0}),[q,G]=O.useState(!0),[ie,H]=O.useState(new Set),[se,te]=O.useState(!0),[fe,ye]=O.useState(!0),[be,_e]=O.useState(!1),[W,Y]=O.useState(!1),[ve,ce]=O.useState(0),[ne,he]=O.useState(5e3),[xe,Te]=O.useState(!1);O.useEffect(()=>{const Ve=De=>{De.key==="Escape"&&d(null),B.length>0&&(De.key==="ArrowLeft"?(De.preventDefault(),A(Ge=>Math.max(0,Ge-1))):De.key==="ArrowRight"&&(De.preventDefault(),A(Ge=>Math.min(B.length-1,Ge+1))))},We=De=>{De.target.closest(".panel-clickable")||d(null)};return document.addEventListener("keydown",Ve),document.addEventListener("click",We),()=>{document.removeEventListener("keydown",Ve),document.removeEventListener("click",We)}},[d,B.length,A]);const Ce=O.useRef(!1),Be=O.useRef(!1);O.useEffect(()=>{if(console.log("=== CNCOptimizerPro Initialization ==="),console.log("livePanels from hook:",e),console.log("livePanels.length:",e.length),console.log("current panels in store:",r),console.log("current stock in store:",o),e.length>0&&(p(!1),localStorage.removeItem("cnc_user_modified")),g&&e.length===0){console.log("User has modified panels and no live panels, keeping user panels");return}if(e.length===0&&(g&&r.some(We=>We.width>0&&We.length>0&&We.label!=="")||(console.log("No furniture placed, clearing all panels"),s([]),localStorage.removeItem("cnc_panels"),localStorage.removeItem("cnc_user_modified"),p(!1))),e.length>0){if(!Be.current||r.length===0){const Ve=e.map(We=>{let De=We.width,Ge=We.height;De>Ge&&(De=We.height,Ge=We.width);const Re="V";let Ie=We.material||"PB";const Le=(We.name||"").toLowerCase();return(Le.includes("도어")||Le.includes("door")||Le.includes("엔드")||Le.includes("end"))&&(Ie="PET"),{id:We.id,label:We.name||`Panel_${We.id}`,width:De,length:Ge,thickness:We.thickness||18,quantity:We.quantity||1,material:Ie,grain:Re,canRotate:!0}});console.log("Setting panels from livePanels:",Ve),s(Ve),Be.current=!0}}else e.length===0&&!g&&!r.some(We=>We.width===0||We.length===0||We.label==="")&&r.length>0&&(console.log("No furniture placed and no user panels - clearing panels"),s([]));o.length===0&&a([{label:"PB_18T_2440x1220",width:1220,length:2440,thickness:18,quantity:999,material:"PB"},{label:"PET_18T_2440x1220",width:1220,length:2440,thickness:18,quantity:999,material:"PET"},{label:"MDF_18T_2440x1220",width:1220,length:2440,thickness:18,quantity:999,material:"MDF"},{label:"PB_15T_2440x1220",width:1220,length:2440,thickness:15,quantity:999,material:"PB"},{label:"MDF_9T_2440x1220",width:1220,length:2440,thickness:9,quantity:999,material:"MDF"},{label:"MDF_5T_2440x1220",width:1220,length:2440,thickness:5,quantity:999,material:"MDF"}]),lI()},[]),O.useEffect(()=>{if(g){console.log("User has modified panels, skipping livePanels sync");return}if(e.length>0&&!Be.current){console.log("Initializing from livePanels");const Ve=e.map(We=>{let De=We.width,Ge=We.height;De>Ge&&(De=We.height,Ge=We.width);const Re="V";let Ie=We.material||"PB";const Le=(We.name||"").toLowerCase();return(Le.includes("도어")||Le.includes("door")||Le.includes("엔드")||Le.includes("end"))&&(Ie="PET"),{id:We.id,label:We.name||`Panel_${We.id}`,width:De,length:Ge,thickness:We.thickness||18,quantity:We.quantity||1,material:Ie,grain:Re,canRotate:!0}});s(Ve),Be.current=!0}},[e,g,s]);const Ye=O.useCallback(async()=>{if(r.length===0){Hh(t("cnc.noPanelsError"),"error",t("common.confirm"));return}if(o.length===0){Hh(t("cnc.noStockError"),"error",t("common.confirm"));return}K(!0),_e(!1),E([]),P.current=[],Y(!0),ce(0);const Ve=Date.now();window.cncSettings=c;const We=r.reduce((Ie,Le)=>Ie+(Le.quantity||1),0),De=Math.ceil(We/10);let Ge=3e3;De>=30?Ge=8e3:De>=20?Ge=6e3:De>=10?Ge=4e3:De>=5&&(Ge=3500),he(Ge);const Re=setInterval(()=>{const Ie=Date.now()-Ve,Le=Math.min(Ie/Ge*100,95);ce(Le),Ie>=Ge&&clearInterval(Re)},50);await new Promise(Ie=>setTimeout(Ie,1e3));try{const Ie=new Map;r.forEach(ht=>{const ut={...ht};c.optimizationType==="OPTIMAL_CNC"?ut.canRotate=!0:c.considerGrain&&ht.grain&&(ht.grain==="V"||ht.grain==="H")?ut.canRotate=!1:(c.considerGrain,ut.canRotate=!0);const ft=c.considerMaterial?`${ut.material||"PB"}_${ut.thickness||18}`:`THICKNESS_${ut.thickness||18}`;Ie.has(ft)||Ie.set(ft,[]),Ie.get(ft).push(ut)});const Le=[];for(const[ht,ut]of Ie){let ft,jt;if(ht.startsWith("THICKNESS_"))jt=parseInt(ht.split("_")[1])||18;else{const Mt=ht.split("_");ft=Mt[0],jt=parseInt(Mt[1])||18}let Wt;if(ft&&(Wt=o.find(Mt=>Mt.material===ft&&Mt.thickness===jt)),Wt||(Wt=o.find(Mt=>Mt.thickness===jt)),!Wt&&o.length>0&&(Wt=o[0]),Wt){const Mt={id:Wt.label||"stock",width:Wt.width,height:Wt.length,material:Wt.material||"PB",color:"MW",price:5e4,stock:Wt.quantity},dn=ut.map(an=>({id:an.id,name:an.label,width:an.width,height:an.length,thickness:an.thickness,quantity:an.quantity,material:an.material||"PB",color:"MW",grain:an.grain==="H"?"HORIZONTAL":(an.grain==="V","VERTICAL"),canRotate:an.canRotate})),on={...Mt,width:Mt.width-(c.trimLeft||10)-(c.trimRight||10),height:Mt.height-(c.trimTop||10)-(c.trimBottom||10)};await new Promise(an=>setTimeout(an,300));const Et=await TVe(dn,on,c.singleSheetOnly?1:999,c.alignVerticalCuts!==!1,c.kerf||5,c.optimizationType||"OPTIMAL_CNC");Et.forEach(an=>{an.panels.forEach(Mn=>{Mn.x+=c.trimLeft||10,Mn.y+=c.trimBottom||10}),an.stockPanel=Mt}),Le.push(...Et)}}const et=[...Le];P.current=et;const ct=[];et.forEach((ht,ut)=>{ht.panels.forEach(ft=>{ct.push({sheetId:String(ut+1),panelId:ft.id,x:ft.x,y:ft.y,width:ft.width,height:ft.height,rotated:ft.rotated})})}),y(ct);const mt=Le.length;let je=3e3;mt>=30?je=8e3:mt>=20?je=6e3:mt>=10?je=4e3:mt>=5&&(je=3500);const le=Date.now()-Ve,Je=Math.max(0,je-le);setTimeout(()=>{clearInterval(Re),ce(100),setTimeout(async()=>{if(Y(!1),ce(0),Le.length>0){const ht=Le.reduce((ft,jt)=>ft+jt.panels.length,0),ut=Le.reduce((ft,jt)=>ft+jt.efficiency,0)/Le.length;await Hh(t("cnc.optimizationComplete",{panels:ht,sheets:Le.length,efficiency:ut.toFixed(1)}),"success",t("common.confirm")),E(P.current),f>=P.current.length&&P.current.length>0?A(P.current.length-1):f<0&&P.current.length>0&&A(0),P.current=[]}else await Hh(t("cnc.optimizationFailed"),"error",t("common.confirm"))},300)},Je)}catch{clearInterval(Re),Y(!1),ce(0),Hh(t("cnc.optimizationError"),"error",t("common.confirm"))}finally{K(!1)}},[r,o,c,y,A,F]);O.useEffect(()=>{!Ce.current&&e.length>0&&r.length>0&&o.length>0&&(Ce.current=!0,setTimeout(()=>{Ye()},100))},[e,r,o,Ye]);const $e=(n==null?void 0:n.title)||"New Project",ot=()=>{const[Ve,We]=O.useState(!1),De=O.useRef(null),Ge={OPTIMAL_L:t("cnc.optimalL"),OPTIMAL_W:t("cnc.optimalW"),OPTIMAL_CNC:t("cnc.optimalCNC")};O.useEffect(()=>{const Ie=Le=>{De.current&&!De.current.contains(Le.target)&&We(!1)};return Ve&&document.addEventListener("mousedown",Ie),()=>{document.removeEventListener("mousedown",Ie)}},[Ve]);const Re=Ie=>{h({optimizationType:Ie}),We(!1),_e(!0)};return l.jsxs("div",{className:_n.dropdownContainer,ref:De,children:[l.jsxs("button",{className:_n.dropdownButton,onClick:()=>We(!Ve),children:[l.jsx("span",{children:Ge[c.optimizationType||"OPTIMAL_CNC"]}),l.jsx(lA,{size:14,className:Ve?_n.rotated:""})]}),Ve&&l.jsx("div",{className:_n.dropdownMenu,children:Object.entries(Ge).map(([Ie,Le])=>l.jsx("button",{className:`${_n.dropdownItem} ${c.optimizationType===Ie?_n.active:""}`,onClick:()=>Re(Ie),children:Le},Ie))})]})},rt=O.useMemo(()=>{if(B.length===0)return[];const Ve=[];let We=0;return B.forEach((De,Ge)=>{const Re=String(Ge+1);De.panels.forEach(Ie=>{const Le={x:Ie.x,y:Ie.y,width:Ie.width,height:Ie.height};Fq({mode:c.optimizationType==="OPTIMAL_CNC"?"free":"guillotine",sheetW:De.stockPanel.width,sheetH:De.stockPanel.height,kerf:c.kerf||5,placement:Le,sheetId:Re,panelId:Ie.id}).forEach((ct,mt)=>{Ve.push({...ct,id:`s${Ge}_p${Ie.id}_c${mt}`,globalOrder:++We,sheetNumber:Ge+1,panelInfo:Ie})})})}),Ve},[B,q,c.optimizationType,c.kerf]);return O.useEffect(()=>{if(rt.length>0){const Ve=BVe(rt,"m");F(Ve)}},[rt,F]),l.jsxs("div",{className:_n.container,children:[l.jsxs("div",{className:_n.header,children:[l.jsxs("div",{className:_n.headerLeft,children:[l.jsx(V5,{size:"small"}),l.jsx("h1",{children:t("cnc.title")}),l.jsx("span",{className:_n.projectName,children:$e})]}),l.jsxs("div",{className:_n.headerRight,children:[l.jsx(ot,{}),l.jsx("div",{className:_n.divider}),l.jsxs("button",{className:`${_n.calculateButton} ${be?_n.highlighted:""}`,onClick:Ye,disabled:V||r.length===0,children:[l.jsx(o6,{size:18}),l.jsx("span",{children:t("cnc.calculate")})]}),l.jsx("div",{className:_n.exportGroup,children:l.jsx(YWe,{optimizationResults:B})}),l.jsx("div",{className:_n.divider}),l.jsxs("button",{className:_n.exitButton,onClick:Ve=>{Ve.preventDefault(),Ve.stopPropagation(),Te(!0)},type:"button",children:[l.jsx(eF,{size:16}),t("cnc.exit")]})]})]}),l.jsxs("div",{className:_n.main,children:[l.jsxs("div",{className:_n.leftSidebar,children:[l.jsx(FWe,{}),l.jsx(jWe,{}),l.jsx(PWe,{onSettingsChange:Ye})]}),l.jsx("div",{className:_n.centerPanel,children:B.length>0?l.jsxs("div",{className:_n.viewerContainer,children:[B.length>1&&l.jsx("div",{className:_n.keyboardHint,children:l.jsxs("span",{children:["← → ",t("cnc.keyboardNavigationHint")]})}),l.jsx("div",{className:_n.mainViewer,children:l.jsx(_Qe,{result:B[f],highlightedPanelId:u,showLabels:c.labelsOnPanels,onPanelClick:Ve=>d(Ve),allowRotation:!c.considerGrain,scale:M,rotation:Z,offset:U,onScaleChange:X,onRotationChange:Q,onOffsetChange:z,sheetInfo:{currentIndex:f,totalSheets:B.length,onOptimize:Ye,isOptimizing:V,stock:o},onCurrentSheetIndexChange:A,showCuttingListTab:q,allCutSteps:rt})}),l.jsx("div",{className:_n.thumbnailBar,children:l.jsx("div",{className:_n.thumbnailScroll,children:B.map((Ve,We)=>l.jsx(H$e,{result:Ve,index:We,isActive:We===f,onClick:()=>A(We),viewerScale:We===f?M:1,viewerRotation:We===f?Z:0,viewerOffset:We===f?U:{x:0,y:0},highlightedPanelId:We===f?u:null},We))})})]}):l.jsxs("div",{className:_n.emptyPreview,children:[l.jsx(Hz,{size:48}),l.jsx("h3",{children:t("cnc.noResults")}),l.jsx("p",{children:t("cnc.setupHint")}),l.jsx("button",{className:`${_n.optimizeButtonLarge} ${_n.primary}`,onClick:Ye,disabled:V,children:t(V?"cnc.optimizing":"cnc.generatePanels")})]})}),l.jsx("div",{className:_n.rightSidebar,children:l.jsxs("div",{className:_n.rightSidebarContent,children:[l.jsxs("div",{className:_n.statsCard,children:[l.jsxs("div",{className:_n.statsCardTitle,children:[l.jsx("h3",{children:t("cnc.totalStats")}),l.jsx("button",{className:_n.foldButton,onClick:()=>te(!se),children:se?l.jsx(s6,{size:14}):l.jsx(lA,{size:14})})]}),se&&l.jsxs("div",{className:_n.statsDetail,children:[l.jsxs("div",{className:_n.statRow,children:[l.jsx("span",{children:t("cnc.sheets")}),l.jsx("div",{className:_n.statValue,children:l.jsx("strong",{children:B.length})})]}),l.jsxs("div",{className:_n.statRow,children:[l.jsx("span",{children:t("cnc.usedArea")}),l.jsxs("div",{className:_n.statValue,children:[l.jsx("strong",{children:(B.reduce((Ve,We)=>Ve+We.usedArea,0)/1e6).toFixed(1)}),l.jsxs("span",{className:_n.statPercent,children:[B.length>0?Math.round(B.reduce((Ve,We)=>Ve+We.efficiency,0)/B.length):0,"%"]})]})]}),l.jsxs("div",{className:_n.statRow,children:[l.jsx("span",{children:t("cnc.wasteArea")}),l.jsxs("div",{className:_n.statValue,children:[l.jsx("strong",{children:(B.reduce((Ve,We)=>Ve+We.wasteArea,0)/1e6).toFixed(1)}),l.jsxs("span",{className:_n.statPercent,children:[B.length>0?Math.round(100-B.reduce((Ve,We)=>Ve+We.efficiency,0)/B.length):0,"%"]})]})]}),l.jsxs("div",{className:_n.statRow,children:[l.jsx("span",{children:t("cnc.totalPanels")}),l.jsx("div",{className:_n.statValue,children:l.jsx("strong",{children:B.reduce((Ve,We)=>Ve+We.panels.length,0)})})]}),l.jsxs("div",{className:_n.statRow,children:[l.jsx("span",{children:t("cnc.cutCount")}),l.jsx("div",{className:_n.statValue,children:l.jsx("strong",{children:rt.length})})]}),l.jsxs("div",{className:_n.statRow,children:[l.jsx("span",{children:t("cnc.cutLength")}),l.jsx("div",{className:_n.statValue,children:l.jsxs("strong",{children:[S.total.toFixed(2),"m"]})})]}),l.jsxs("div",{className:_n.statRow,children:[l.jsx("span",{children:t("cnc.bladeThickness")}),l.jsx("div",{className:_n.statValue,children:l.jsxs("strong",{children:[c.kerf||5,"mm"]})})]}),l.jsxs("div",{className:_n.statRow,children:[l.jsx("span",{children:t("cnc.stock")}),l.jsx("div",{className:_n.statValue,children:o.length>0?`${o[0].width}×${o[0].length}`:"-"})]}),l.jsxs("div",{className:_n.statRow,children:[l.jsx("span",{children:t("cnc.optimization")}),l.jsx("div",{className:_n.statValue,children:c.optimizationType==="OPTIMAL_CNC"?t("cnc.minWaste"):c.optimizationType==="BY_LENGTH"?t("cnc.verticalCut"):t("cnc.horizontalCut")})]})]})]}),B[f]&&l.jsxs("div",{className:_n.statsCard,children:[l.jsxs("div",{className:_n.statsCardTitle,children:[l.jsx("h3",{children:t("cnc.sheetStats")}),l.jsx("button",{className:_n.foldButton,onClick:()=>ye(!fe),children:fe?l.jsx(s6,{size:14}):l.jsx(lA,{size:14})})]}),fe&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:_n.statsCardHeader,children:[l.jsx("button",{className:_n.statsNavButton,onClick:()=>A(Math.max(0,f-1)),disabled:f===0,children:l.jsx(Bve,{size:14})}),l.jsxs("h3",{children:[t("cnc.sheet")," ",f+1," / ",B.length]}),l.jsx("button",{className:_n.statsNavButton,onClick:()=>A(Math.min(B.length-1,f+1)),disabled:f===B.length-1,children:l.jsx(qI,{size:14})}),l.jsx("button",{className:`${_n.playButton} ${m?_n.playing:""}`,onClick:()=>{m?w(!1):(d(null),I(String(f+1)),w(!0))},title:m?"시뮬레이션 정지":"컷팅 시뮬레이션",children:m?l.jsx(Gz,{size:14}):l.jsx(o6,{size:14})})]}),l.jsxs("div",{className:_n.statsDetail,children:[l.jsxs("div",{className:_n.statRow,children:[l.jsx("span",{children:t("cnc.panelCount")}),l.jsx("div",{className:_n.statValue,children:l.jsx("strong",{children:B[f].panels.length})})]}),l.jsxs("div",{className:_n.statRow,children:[l.jsx("span",{children:t("cnc.efficiency")}),l.jsx("div",{className:_n.statValue,children:l.jsxs("strong",{children:[B[f].efficiency.toFixed(1),"%"]})})]}),l.jsxs("div",{className:_n.statRow,children:[l.jsx("span",{children:t("cnc.usedArea")}),l.jsx("div",{className:_n.statValue,children:l.jsxs("strong",{children:[(B[f].usedArea/1e6).toFixed(2),"㎡"]})})]}),l.jsxs("div",{className:_n.statRow,children:[l.jsx("span",{children:t("cnc.wasteArea")}),l.jsx("div",{className:_n.statValue,children:l.jsxs("strong",{children:[(B[f].wasteArea/1e6).toFixed(2),"㎡"]})})]}),l.jsxs("div",{className:_n.statRow,children:[l.jsx("span",{children:t("cnc.cutCount")}),l.jsx("div",{className:_n.statValue,children:l.jsx("strong",{children:rt.filter(Ve=>Ve.sheetNumber===f+1).length})})]}),l.jsxs("div",{className:_n.statRow,children:[l.jsx("span",{children:t("cnc.cutLength")}),l.jsx("div",{className:_n.statValue,children:l.jsx("strong",{children:S.bySheet[String(f+1)]?S.bySheet[String(f+1)].toFixed(2)+"m":"0.00m"})})]})]})]})]}),B.length>0&&l.jsxs("div",{className:`${_n.statsCard} ${_n.sheetListCard}`,children:[l.jsx("div",{className:_n.sheetListHeader,children:l.jsxs("div",{className:_n.tabButtons,children:[l.jsx("button",{className:`${_n.tabButton} ${q?"":_n.active}`,onClick:()=>G(!1),children:t("cnc.sheetList")}),l.jsx("button",{className:`${_n.tabButton} ${q?_n.active:""}`,onClick:()=>G(!0),children:t("cnc.cuttingList")})]})}),q?l.jsxs("div",{className:_n.cutsList,children:[l.jsxs("div",{className:_n.cutsTableHeader,children:[l.jsx("span",{className:_n.cutsCol1,children:"#"}),l.jsx("span",{className:_n.cutsCol2,children:"Panel"}),l.jsx("span",{className:_n.cutsCol3,children:"Cut"}),l.jsx("span",{className:_n.cutsCol4,children:"Result"})]}),l.jsx("div",{className:_n.cutsTableBody,children:(()=>{const Ve=new Map;rt.forEach(Ge=>{Ve.has(Ge.sheetNumber)||Ve.set(Ge.sheetNumber,[]),Ve.get(Ge.sheetNumber).push(Ge)});let We=0;const De=[];for(const[Ge,Re]of Ve)Re.forEach((Ie,Le)=>{var ct,mt;const et=We++;De.push(l.jsxs("div",{className:`${_n.cutsRow} ${b===Ie.id?_n.selected:""}`,onClick:()=>{I(Ie.sheetId),_(Ie.id),Ie.yieldsPanelId&&(v(Ie.yieldsPanelId,Ie.sheetId),A(Ie.sheetNumber-1)),D(et)},onDoubleClick:()=>{Ie.yieldsPanelId&&(v(Ie.yieldsPanelId,Ie.sheetId),A(Ie.sheetNumber-1),w(!0))},children:[l.jsx("span",{className:_n.cutsCol1,children:Le+1}),l.jsx("span",{className:_n.cutsCol2,children:cR(Ie.before.width,Ie.before.length)}),l.jsx("span",{className:_n.cutsCol3,children:`${Ie.axis}=${Math.round(Ie.pos)}`}),l.jsx("span",{className:_n.cutsCol4,children:Ie.yieldsPanelId?`${cR(((ct=Ie.after)==null?void 0:ct.width)||0,((mt=Ie.after)==null?void 0:mt.length)||0)} \\ -`:"- \\ surplus"})]},`cut-${Ge}-${Le}`))});return De})()})]}):l.jsx("div",{className:_n.sheetList,children:B.map((Ve,We)=>{const De=Ve.stockPanel.id||`${Ve.stockPanel.material}_${Ve.stockPanel.width}x${Ve.stockPanel.height}`,Ge=ie.has(We);return l.jsxs("div",{className:_n.sheetItemContainer,children:[l.jsxs("div",{className:`${_n.sheetItem} ${We===f?_n.active:""}`,onClick:()=>{A(We),H(Re=>{const Ie=new Set(Re);return Ie.has(We)||Ie.add(We),Ie})},children:[l.jsx("button",{className:_n.expandButton,onClick:Re=>{Re.stopPropagation(),H(Ie=>{const Le=new Set(Ie);return Le.has(We)?Le.delete(We):Le.add(We),Le})},children:Ge?l.jsx(lA,{size:14}):l.jsx(fC,{size:14})}),l.jsx("span",{className:_n.sheetNumber,children:We+1}),l.jsx("span",{className:_n.sheetInfo,children:De}),l.jsxs("span",{className:_n.sheetPanels,children:[Ve.panels.length,"개"]}),l.jsxs("span",{className:_n.sheetEfficiency,children:[Ve.efficiency.toFixed(0),"%"]})]}),Ge&&l.jsx("div",{className:_n.panelListContainer,children:Ve.panels.map((Re,Ie)=>l.jsxs("div",{className:`${_n.panelItem} ${u===Re.id?_n.selectedPanel:""} panel-clickable`,onClick:Le=>{Le.stopPropagation();const et=Re.id;d(et),A(We)},children:[l.jsx("span",{className:_n.panelName,children:Re.name||`Panel ${Re.id}`}),l.jsxs("span",{className:_n.panelSize,children:[Math.round(Re.width)," × ",Math.round(Re.height)]})]},`panel-${We}-${Ie}`))})]},We)})})]})]})})]}),l.jsx(cVe,{isOpen:W,progress:ve,message:t("cnc.aiOptimizing"),duration:ne}),l.jsx(bVe,{isOpen:xe,onConfirm:()=>{console.log("Exit confirmed! Navigating to configurator..."),window.location.href="/configurator"},onCancel:()=>Te(!1)})]})}function kVe(){return l.jsx(zHe,{children:l.jsx(EVe,{})})}const Tf=Lm(n=>({mode:"BY_LENGTH",kerfMm:3,sheets:[],panels:[],placements:[],cuts:[],selectedCutId:void 0,selectedSheetId:void 0,sawStats:{bySheet:{},total:0,unit:"m"},cncStats:{cycleTimeSec:0,cutLenMm:0,airLenMm:0,toolChanges:0},setMode:e=>n(()=>({mode:e,selectedCutId:void 0})),setSelectedSheetId:e=>n(()=>({selectedSheetId:e})),selectCutId:e=>n(()=>({selectedCutId:e})),setKerf:e=>n(()=>({kerfMm:e})),setSheets:e=>n(()=>({sheets:e})),setPanels:e=>n(()=>({panels:e})),setPlacements:e=>n(()=>({placements:e})),setCuts:e=>n(()=>({cuts:e})),setSawStats:e=>n(()=>({sawStats:e})),setCNCStats:e=>n(()=>({cncStats:e}))}));function IVe(n,e,t){const i=n.trim.left,r=n.trim.top,s=n.width-i-n.trim.right,o=n.length-r-n.trim.bottom,a=[];t.forEach(m=>{for(let w=0;w<m.qty;w++){let x=m.width,T=m.length;const j=m.grain==="length",D=m.grain==="width";if(m.canRotate&&!j&&!D&&x>T){const _=x;x=T,T=_}if(j&&x>T){const _=x;x=T,T=_}if(D&&T>x){const _=x;x=T,T=_}a.push({id:m.id,w:x,l:T,canRotate:m.canRotate,grain:m.grain})}}),a.sort((m,w)=>w.w-m.w||w.l-m.l);const c=[],h=e,u=m=>{for(const T of c)if(m.w<=T.w){const j=r+T.usedL+(T.rows.length?e:0);if(j-r+m.l<=o+1e-6)return T.rows.push({id:m.id,y:j,l:m.l,w:m.w}),T.usedL=j-r+m.l,!0}const w=i+c.reduce((T,j)=>T+j.w+h,0);if(w-i+m.w>s+1e-6)return!1;const x={x:w,w:m.w,usedL:0,rows:[]};return x.rows.push({id:m.id,y:r,l:m.l,w:m.w}),x.usedL=m.l,c.push(x),!0};a.forEach(u);const d=[];for(const m of c)for(const w of m.rows)d.push({sheetId:n.id,panelId:w.id,x:m.x,y:w.y,width:m.w,length:w.l});const f=[];let A=1;for(const m of c){const w=r,x=r+o;f.push({id:`c${A}`,sheetId:n.id,order:A++,axis:"x",pos:m.x,spanStart:w,spanEnd:x,source:"derived"}),f.push({id:`c${A}`,sheetId:n.id,order:A++,axis:"x",pos:m.x+m.w,spanStart:w,spanEnd:x,source:"derived"})}const g=new Set;for(const m of c)for(const w of m.rows)g.add(w.y),g.add(w.y+w.l);const p=[...g].sort((m,w)=>m-w),y=i,v=i+s;for(const m of p)f.push({id:`c${A}`,sheetId:n.id,order:A++,axis:"y",pos:m,spanStart:y,spanEnd:v,source:"derived"});return{placements:d,cuts:f}}function FVe(n,e,t){const i=n.trim.left,r=n.trim.top,s=n.width-i-n.trim.right,o=n.length-r-n.trim.bottom,a=[];t.forEach(m=>{for(let w=0;w<m.qty;w++){let x=m.width,T=m.length;const j=m.grain==="length",D=m.grain==="width";if(m.canRotate&&!j&&!D&&T>x){const _=x;x=T,T=_}if(j&&x>T){const _=x;x=T,T=_}if(D&&T>x){const _=x;x=T,T=_}a.push({id:m.id,w:x,l:T,canRotate:m.canRotate,grain:m.grain})}}),a.sort((m,w)=>w.l-m.l||w.w-m.w);const c=[],h=e,u=m=>{for(const T of c)if(m.h<=T.h){const j=i+T.usedW+(T.cells.length?e:0);if(j-i+m.w<=s+1e-6)return T.cells.push({id:m.id,x:j,w:m.w,h:m.h}),T.usedW=j-i+m.w,!0}const w=r+c.reduce((T,j)=>T+j.h+h,0);if(w-r+m.h>o+1e-6)return!1;const x={y:w,h:m.h,usedW:0,cells:[]};return x.cells.push({id:m.id,x:i,w:m.w,h:m.h}),x.usedW=m.w,c.push(x),!0};a.forEach(({id:m,w,l:x})=>u({id:m,w,h:x}));const d=[];for(const m of c)for(const w of m.cells)d.push({sheetId:n.id,panelId:w.id,x:w.x,y:m.y,width:w.w,length:m.h});const f=[];let A=1;for(const m of c){const w=i,x=i+s;f.push({id:`c${A}`,sheetId:n.id,order:A++,axis:"y",pos:m.y,spanStart:w,spanEnd:x,source:"derived"}),f.push({id:`c${A}`,sheetId:n.id,order:A++,axis:"y",pos:m.y+m.h,spanStart:w,spanEnd:x,source:"derived"})}const g=new Set;for(const m of c)for(const w of m.cells)g.add(w.x),g.add(w.x+w.w);const p=[...g].sort((m,w)=>m-w),y=r,v=r+o;for(const m of p)f.push({id:`c${A}`,sheetId:n.id,order:A++,axis:"x",pos:m,spanStart:y,spanEnd:v,source:"derived"});return{placements:d,cuts:f}}function DVe(n,e,t){const i=n.trim.left,r=n.trim.top,s=n.width-i-n.trim.right,o=n.length-r-n.trim.bottom,a=[];t.forEach(I=>{for(let S=0;S<I.qty;S++)if(I.canRotate&&I.grain==="none"){const F={id:I.id,w:I.width,l:I.length,rotated:!1,area:I.width*I.length},B={id:I.id,w:I.length,l:I.width,rotated:!0,area:I.width*I.length},E=s/o,V=F.w/F.l,K=B.w/B.l,P=Math.abs(E-V),M=Math.abs(E-K);a.push(P<=M?F:B)}else a.push({id:I.id,w:I.width,l:I.length,rotated:!1,area:I.width*I.length})}),a.sort((I,S)=>Math.abs(S.area-I.area)>1?S.area-I.area:Math.max(S.w,S.l)-Math.max(I.w,I.l));const c=[],h=e;let u=[{x:i,y:r,w:s,h:o}];for(const I of a){let S=null,F=1/0,B=-1;for(let K=0;K<u.length;K++){const P=u[K];if(I.w+h<=P.w&&I.l+h<=P.h){const M=P.w-I.w-h,X=P.h-I.l-h,Z=Math.min(M,X);Z<F&&(F=Z,S=P,B=K)}}if(!S)continue;c.push({sheetId:n.id,panelId:I.id,x:S.x,y:S.y,width:I.w,length:I.l,rotated:I.rotated}),u.splice(B,1);const E=S.x+I.w+h,V=S.y+I.l+h;E<S.x+S.w&&u.push({x:E,y:S.y,w:S.x+S.w-E,h:I.l+h}),V<S.y+S.h&&u.push({x:S.x,y:V,w:S.w,h:S.y+S.h-V}),u=d(u)}function d(I){return I.filter(S=>S.w>h&&S.h>h)}const f=[];let A=1;const g=new Set,p=new Set;for(const I of c)g.add(I.x),g.add(I.x+I.width),p.add(I.y),p.add(I.y+I.length);const y=i,v=i+s,m=r,w=r+o;[...g].sort((I,S)=>I-S).forEach(I=>f.push({id:`c${A}`,sheetId:n.id,order:A++,axis:"x",pos:I,spanStart:m,spanEnd:w,source:"derived"})),[...p].sort((I,S)=>I-S).forEach(I=>f.push({id:`c${A}`,sheetId:n.id,order:A++,axis:"y",pos:I,spanStart:y,spanEnd:v,source:"derived"}));const x=f.reduce((I,S)=>I+Math.abs(S.spanEnd-S.spanStart),0),T=f.length*50,j=1,_=x/12e3+T/24e3;return{placements:c,cuts:f,cnc:{cycleTimeSec:_,cutLenMm:x,airLenMm:T,toolChanges:j}}}function jVe(n){const e=new Map;for(const i of n){const r=`${i.sheetId}|${i.axis}|${i.pos.toFixed(3)}`,s=Math.min(i.spanStart,i.spanEnd),o=Math.max(i.spanStart,i.spanEnd);e.has(r)||e.set(r,[]),e.get(r).push([s,o])}let t=0;for(const[,i]of e){i.sort((o,a)=>o[0]-a[0]);let[r,s]=i[0];for(let o=1;o<i.length;o++){const[a,c]=i[o];a<=s?s=Math.max(s,c):(t+=s-r,r=a,s=c)}t+=s-r}return t}function Dq(n,e="m"){const t={},i=new Map;for(const s of n)i.has(s.sheetId)||i.set(s.sheetId,[]),i.get(s.sheetId).push(s);let r=0;for(const[s,o]of i){const a=jVe(o);t[s]=e==="m"?a/1e3:a,r+=a}return{bySheet:t,total:e==="m"?r/1e3:r,unit:e}}function jq(n,e){const t=n.reduce((r,s)=>r+s.width*s.length,0),i=e.reduce((r,s)=>r+(s.width-s.trim.left-s.trim.right)*(s.length-s.trim.top-s.trim.bottom),0);return i>0?Math.max(0,1-t/i):0}function PVe(){const n=Tf.getState();if(console.log("Recalc called with mode:",n.mode),console.log("Panels:",n.panels),console.log("Sheets:",n.sheets),n.sheets.length===0)return;const e=[],t=[];let i=[...n.panels];const r={cycleTimeSec:0,cutLenMm:0,airLenMm:0,toolChanges:0};for(const o of n.sheets){if(i.length===0)break;let a=[],c=[],h;if(n.mode==="BY_LENGTH"){console.log("Using BY_LENGTH for sheet",o.id);const d=IVe(o,n.kerfMm,i);a=d.placements,c=d.cuts,console.log("BY_LENGTH placements:",a)}else if(n.mode==="BY_WIDTH"){const d=FVe(o,n.kerfMm,i);a=d.placements,c=d.cuts}else{const d=DVe(o,n.kerfMm,i);a=d.placements,c=d.cuts,h=d.cnc,h&&(r.cycleTimeSec+=h.cycleTimeSec,r.cutLenMm+=h.cutLenMm,r.airLenMm+=h.airLenMm,r.toolChanges+=h.toolChanges)}e.push(...a),t.push(...c);const u=new Map;a.forEach(d=>{u.set(d.panelId,(u.get(d.panelId)||0)+1)}),i=i.reduce((d,f)=>{const A=u.get(f.id)||0,g=f.qty-A;return g>0&&d.push({...f,qty:g}),d},[])}Tf.setState({placements:e,cuts:t}),Tf.getState().setSawStats(Dq(t,"m")),n.mode==="OPTIMAL_CNC"&&Tf.getState().setCNCStats(r);const s=jq(e,n.sheets);console.log("Final placements:",e),console.log("Final cuts:",t),console.log("waste",s)}const NVe="_container_1cnfa_1",LVe="_tab_1cnfa_9",MVe="_active_1cnfa_29",zT={container:NVe,tab:LVe,active:MVe};function RVe(){const{settings:n,setSettings:e}=Lg(),t=n.optimizationType||"OPTIMAL_CNC",i=r=>{console.log("Switching to mode:",r),e({optimizationType:r})};return l.jsx("div",{className:zT.container,children:["BY_LENGTH","BY_WIDTH","OPTIMAL_CNC"].map(r=>l.jsx("button",{onClick:()=>i(r),className:`${zT.tab} ${t===r?zT.active:""}`,children:r==="BY_LENGTH"?l.jsxs(l.Fragment,{children:[l.jsx(kve,{size:14}),"L방향 우선"]}):r==="BY_WIDTH"?l.jsxs(l.Fragment,{children:[l.jsx(Sve,{size:14}),"W방향 우선"]}):l.jsxs(l.Fragment,{children:[l.jsx(Hz,{size:14}),"CNC 최적화"]})},r))})}const OVe="_container_1sqpg_1",UVe="_header_1sqpg_11",HVe="_tabs_1sqpg_27",WVe="_tab_1sqpg_27",QVe="_activeTab_1sqpg_49",$Ve="_sheetInfo_1sqpg_60",VVe="_preview_1sqpg_65",zVe="_sheet_1sqpg_60",GVe="_panel_1sqpg_82",XVe="_cut_1sqpg_90",KVe="_cutX_1sqpg_98",qVe="_cutY_1sqpg_102",YVe="_selected_1sqpg_106",ZVe="_selectedCut_1sqpg_110",_l={container:OVe,header:UVe,tabs:HVe,tab:WVe,activeTab:QVe,sheetInfo:$Ve,preview:VVe,sheet:zVe,panel:GVe,cut:XVe,cutX:KVe,cutY:qVe,selected:YVe,selectedCut:ZVe};function JVe(){const{sheets:n,cuts:e,selectedSheetId:t,selectedCutId:i,kerfMm:r,placements:s,setSelectedSheetId:o}=Tf(),[a,c]=O.useState(0),h=O.useMemo(()=>n[a]||n[0],[n,a]),u=O.useMemo(()=>(t?e.filter(x=>x.sheetId===t):e).sort((x,T)=>x.order-T.order),[e,t]),d=O.useMemo(()=>u.find(x=>x.id===i),[u,i]),f=O.useRef(null),[A,g]=O.useState(1);O.useEffect(()=>{if(!f.current||!h)return;const x=20,T=f.current.clientWidth-x*2,j=f.current.clientHeight-x*2;g(Math.min(T/(h.width||1),j/(h.length||1)))},[h]);const p=20,y=x=>Math.round(x*A)+p,v=x=>Math.round(x*A)+p,m=O.useMemo(()=>h?s.filter(x=>x.sheetId===h.id):[],[s,h]),w=O.useMemo(()=>{const x=new Set(s.map(T=>T.sheetId));return n.filter(T=>x.has(T.id))},[n,s]);return l.jsxs("div",{className:_l.container,children:[l.jsxs("div",{className:_l.header,children:[l.jsx("h3",{children:"Sheet Preview"}),l.jsx("div",{className:_l.tabs,children:w.map((x,T)=>{var j;return l.jsxs("button",{className:`${_l.tab} ${((j=n[a])==null?void 0:j.id)===x.id?_l.activeTab:""}`,onClick:()=>{const D=n.findIndex(b=>b.id===x.id);c(D)},children:["Sheet ",T+1]},x.id)})}),h&&l.jsxs("span",{className:_l.sheetInfo,children:[h.width," × ",h.length,"mm"]})]}),l.jsxs("div",{ref:f,className:_l.preview,children:[h&&l.jsx("div",{className:_l.sheet,style:{left:p,top:p,width:y(h.width)-p,height:v(h.length)-p}}),m.map((x,T)=>l.jsx("div",{className:_l.panel,style:{left:y(x.x),top:v(x.y),width:y(x.x+x.width)-y(x.x),height:v(x.y+x.length)-v(x.y)},title:`${x.panelId}: ${x.width}×${x.length}mm`},`${x.panelId}-${T}`)),u.map(x=>{const T=Math.max(1,r*A),j=Math.min(x.spanStart,x.spanEnd),D=Math.max(x.spanStart,x.spanEnd);if(x.axis==="x"){const b=y(x.pos),_=v(j),I=v(D);return l.jsx("div",{className:`${_l.cut} ${_l.cutX} ${x.id===i?_l.selected:""}`,style:{left:b-Math.floor(T/2),top:_,width:T,height:I-_},title:`x=${x.pos}`},x.id)}else{const b=v(x.pos),_=y(j),I=y(D);return l.jsx("div",{className:`${_l.cut} ${_l.cutY} ${x.id===i?_l.selected:""}`,style:{top:b-Math.floor(T/2),left:_,height:T,width:I-_},title:`y=${x.pos}`},x.id)}}),d&&h&&(()=>{const x=Math.max(2,r*A),T=Math.min(d.spanStart,d.spanEnd),j=Math.max(d.spanStart,d.spanEnd);if(d.axis==="x"){const D=y(d.pos),b=v(T),_=v(j);return l.jsx("div",{className:_l.selectedCut,style:{left:D-Math.floor(x/2),top:b,width:x,height:_-b},title:`x=${d.pos}`})}else{const D=v(d.pos),b=y(T),_=y(j);return l.jsx("div",{className:_l.selectedCut,style:{top:D-Math.floor(x/2),left:b,height:x,width:_-b},title:`y=${d.pos}`})}})()]})]})}const uR=n=>n?`${Math.round(n.w)}×${Math.round(n.l)}`:"-",eze=n=>`${n.axis}=${Math.round(n.pos)}`,tze=n=>`${uR(n.made)} \\ ${n.surplus?`surplus ${uR(n.surplus)}`:"-"}`,nze="_container_17e3s_1",ize="_header_17e3s_11",rze="_tableWrapper_17e3s_24",sze="_table_17e3s_24",oze="_selected_17e3s_64",aze="_result_17e3s_74",w0={container:nze,header:ize,tableWrapper:rze,table:sze,selected:oze,result:aze};function lze(){const{cuts:n,selectedSheetId:e,selectedCutId:t,selectCutId:i,setSelectedSheetId:r}=Tf(),s=O.useMemo(()=>(e?n.filter(o=>o.sheetId===e):n).sort((o,a)=>o.order-a.order),[n,e]);return l.jsxs("div",{className:w0.container,children:[l.jsx("div",{className:w0.header,children:l.jsx("h3",{children:"절단 목록"})}),l.jsx("div",{className:w0.tableWrapper,children:l.jsxs("table",{className:w0.table,children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{children:"#"}),l.jsx("th",{children:"패널"}),l.jsx("th",{children:"절단"}),l.jsx("th",{children:"결과"})]})}),l.jsx("tbody",{children:s.map((o,a)=>l.jsxs("tr",{onClick:()=>{r(o.sheetId),i(o.id)},className:o.id===t?w0.selected:"",children:[l.jsx("td",{children:a+1}),l.jsx("td",{children:o.before?`${Math.round(o.before.w)}×${Math.round(o.before.l)}`:"-"}),l.jsx("td",{children:eze(o)}),l.jsx("td",{className:w0.result,children:tze(o)})]},o.id))})]})})]})}const cze="_container_vow97_1",hze="_header_vow97_8",uze="_stats_vow97_21",dze="_statItem_vow97_28",Aze="_label_vow97_40",fze="_value_vow97_46",ia={container:cze,header:hze,stats:uze,statItem:dze,label:Aze,value:fze};function pze(){const{cuts:n,placements:e,sheets:t,mode:i,cncStats:r}=Tf(),s=O.useMemo(()=>Dq(n,"m"),[n]),o=O.useMemo(()=>jq(e,t)*100,[e,t]);return l.jsxs("div",{className:ia.container,children:[l.jsx("div",{className:ia.header,children:l.jsx("h3",{children:"통계"})}),l.jsxs("div",{className:ia.stats,children:[l.jsxs("div",{className:ia.statItem,children:[l.jsx("span",{className:ia.label,children:"폐기율"}),l.jsxs("span",{className:ia.value,children:[o.toFixed(1),"%"]})]}),l.jsxs("div",{className:ia.statItem,children:[l.jsx("span",{className:ia.label,children:"Used Sheets"}),l.jsx("span",{className:ia.value,children:new Set(e.map(a=>a.sheetId)).size})]}),l.jsxs("div",{className:ia.statItem,children:[l.jsx("span",{className:ia.label,children:"절단 수"}),l.jsx("span",{className:ia.value,children:n.length})]}),l.jsxs("div",{className:ia.statItem,children:[l.jsx("span",{className:ia.label,children:"총 절단 길이"}),l.jsxs("span",{className:ia.value,children:[s.total.toFixed(2)," ",s.unit]})]}),i==="OPTIMAL_CNC"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:ia.statItem,children:[l.jsx("span",{className:ia.label,children:"예상 가공 시간"}),l.jsxs("span",{className:ia.value,children:[r.cycleTimeSec.toFixed(1)," 초"]})]}),l.jsxs("div",{className:ia.statItem,children:[l.jsx("span",{className:ia.label,children:"공구 교체"}),l.jsx("span",{className:ia.value,children:r.toolChanges})]})]})]})]})}const gze="_container_1by2p_1",mze="_main_1by2p_9",yze="_leftSidebar_1by2p_18",vze="_center_1by2p_24",wze="_rightSidebar_1by2p_30",q1={container:gze,main:mze,leftSidebar:yze,center:vze,rightSidebar:wze};function xze(){const{setSheets:n,setPanels:e}=Tf();return O.useEffect(()=>{n([{id:"sheet1",width:2440,length:1220,trim:{left:10,right:10,top:10,bottom:10}},{id:"sheet2",width:2440,length:1220,trim:{left:10,right:10,top:10,bottom:10}},{id:"sheet3",width:2440,length:1220,trim:{left:10,right:10,top:10,bottom:10}}]),e([{id:"panel1",width:600,length:800,qty:4,canRotate:!0,grain:"none"},{id:"panel2",width:400,length:500,qty:5,canRotate:!0,grain:"none"},{id:"panel3",width:800,length:300,qty:3,canRotate:!0,grain:"none"},{id:"panel4",width:350,length:450,qty:4,canRotate:!0,grain:"none"}]),setTimeout(PVe,100)},[n,e]),l.jsxs("div",{className:q1.container,children:[l.jsx(RVe,{}),l.jsxs("div",{className:q1.main,children:[l.jsx("div",{className:q1.leftSidebar,children:l.jsx(pze,{})}),l.jsx("div",{className:q1.center,children:l.jsx(JVe,{})}),l.jsx("div",{className:q1.rightSidebar,children:l.jsx(lze,{})})]})]})}var d_={exports:{}},Y1={},GT={},XT={},dR;function Ur(){return dR||(dR=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n._registerNode=n.Konva=n.glob=void 0;const e=Math.PI/180;function t(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}n.glob=typeof P0<"u"?P0:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},n.Konva={_global:n.glob,version:"9.3.22",isBrowser:t(),isUnminified:/param/.test((function(r){}).toString()),dblClickWindow:400,getAngle(r){return n.Konva.angleDeg?r*e:r},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return n.Konva.DD.isDragging},isTransforming(){var r;return(r=n.Konva.Transformer)===null||r===void 0?void 0:r.isTransforming()},isDragReady(){return!!n.Konva.DD.node},releaseCanvasOnDestroy:!0,document:n.glob.document,_injectGlobal(r){n.glob.Konva=r}};const i=r=>{n.Konva[r.prototype.getClassName()]=r};n._registerNode=i,n.Konva._injectGlobal(n.Konva)})(XT)),XT}var KT={},AR;function Zo(){return AR||(AR=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Util=n.Transform=void 0;const e=Ur();class t{constructor(x=[1,0,0,1,0,0]){this.dirty=!1,this.m=x&&x.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new t(this.m)}copyInto(x){x.m[0]=this.m[0],x.m[1]=this.m[1],x.m[2]=this.m[2],x.m[3]=this.m[3],x.m[4]=this.m[4],x.m[5]=this.m[5]}point(x){const T=this.m;return{x:T[0]*x.x+T[2]*x.y+T[4],y:T[1]*x.x+T[3]*x.y+T[5]}}translate(x,T){return this.m[4]+=this.m[0]*x+this.m[2]*T,this.m[5]+=this.m[1]*x+this.m[3]*T,this}scale(x,T){return this.m[0]*=x,this.m[1]*=x,this.m[2]*=T,this.m[3]*=T,this}rotate(x){const T=Math.cos(x),j=Math.sin(x),D=this.m[0]*T+this.m[2]*j,b=this.m[1]*T+this.m[3]*j,_=this.m[0]*-j+this.m[2]*T,I=this.m[1]*-j+this.m[3]*T;return this.m[0]=D,this.m[1]=b,this.m[2]=_,this.m[3]=I,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(x,T){const j=this.m[0]+this.m[2]*T,D=this.m[1]+this.m[3]*T,b=this.m[2]+this.m[0]*x,_=this.m[3]+this.m[1]*x;return this.m[0]=j,this.m[1]=D,this.m[2]=b,this.m[3]=_,this}multiply(x){const T=this.m[0]*x.m[0]+this.m[2]*x.m[1],j=this.m[1]*x.m[0]+this.m[3]*x.m[1],D=this.m[0]*x.m[2]+this.m[2]*x.m[3],b=this.m[1]*x.m[2]+this.m[3]*x.m[3],_=this.m[0]*x.m[4]+this.m[2]*x.m[5]+this.m[4],I=this.m[1]*x.m[4]+this.m[3]*x.m[5]+this.m[5];return this.m[0]=T,this.m[1]=j,this.m[2]=D,this.m[3]=b,this.m[4]=_,this.m[5]=I,this}invert(){const x=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),T=this.m[3]*x,j=-this.m[1]*x,D=-this.m[2]*x,b=this.m[0]*x,_=x*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),I=x*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=T,this.m[1]=j,this.m[2]=D,this.m[3]=b,this.m[4]=_,this.m[5]=I,this}getMatrix(){return this.m}decompose(){const x=this.m[0],T=this.m[1],j=this.m[2],D=this.m[3],b=this.m[4],_=this.m[5],I=x*D-T*j,S={x:b,y:_,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(x!=0||T!=0){const F=Math.sqrt(x*x+T*T);S.rotation=T>0?Math.acos(x/F):-Math.acos(x/F),S.scaleX=F,S.scaleY=I/F,S.skewX=(x*j+T*D)/I,S.skewY=0}else if(j!=0||D!=0){const F=Math.sqrt(j*j+D*D);S.rotation=Math.PI/2-(D>0?Math.acos(-j/F):-Math.acos(j/F)),S.scaleX=I/F,S.scaleY=F,S.skewX=0,S.skewY=(x*j+T*D)/I}return S.rotation=n.Util._getRotation(S.rotation),S}}n.Transform=t;const i="[object Array]",r="[object Number]",s="[object String]",o="[object Boolean]",a=Math.PI/180,c=180/Math.PI,h="#",u="",d="0",f="Konva warning: ",A="Konva error: ",g="rgb(",p={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},y=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let v=[];const m=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(w){setTimeout(w,60)};n.Util={_isElement(w){return!!(w&&w.nodeType==1)},_isFunction(w){return!!(w&&w.constructor&&w.call&&w.apply)},_isPlainObject(w){return!!w&&w.constructor===Object},_isArray(w){return Object.prototype.toString.call(w)===i},_isNumber(w){return Object.prototype.toString.call(w)===r&&!isNaN(w)&&isFinite(w)},_isString(w){return Object.prototype.toString.call(w)===s},_isBoolean(w){return Object.prototype.toString.call(w)===o},isObject(w){return w instanceof Object},isValidSelector(w){if(typeof w!="string")return!1;const x=w[0];return x==="#"||x==="."||x===x.toUpperCase()},_sign(w){return w===0||w>0?1:-1},requestAnimFrame(w){v.push(w),v.length===1&&m(function(){const x=v;v=[],x.forEach(function(T){T()})})},createCanvasElement(){const w=document.createElement("canvas");try{w.style=w.style||{}}catch{}return w},createImageElement(){return document.createElement("img")},_isInDocument(w){for(;w=w.parentNode;)if(w==document)return!0;return!1},_urlToImage(w,x){const T=n.Util.createImageElement();T.onload=function(){x(T)},T.src=w},_rgbToHex(w,x,T){return((1<<24)+(w<<16)+(x<<8)+T).toString(16).slice(1)},_hexToRgb(w){w=w.replace(h,u);const x=parseInt(w,16);return{r:x>>16&255,g:x>>8&255,b:x&255}},getRandomColor(){let w=(Math.random()*16777215<<0).toString(16);for(;w.length<6;)w=d+w;return h+w},getRGB(w){let x;return w in p?(x=p[w],{r:x[0],g:x[1],b:x[2]}):w[0]===h?this._hexToRgb(w.substring(1)):w.substr(0,4)===g?(x=y.exec(w.replace(/ /g,"")),{r:parseInt(x[1],10),g:parseInt(x[2],10),b:parseInt(x[3],10)}):{r:0,g:0,b:0}},colorToRGBA(w){return w=w||"black",n.Util._namedColorToRBA(w)||n.Util._hex3ColorToRGBA(w)||n.Util._hex4ColorToRGBA(w)||n.Util._hex6ColorToRGBA(w)||n.Util._hex8ColorToRGBA(w)||n.Util._rgbColorToRGBA(w)||n.Util._rgbaColorToRGBA(w)||n.Util._hslColorToRGBA(w)},_namedColorToRBA(w){const x=p[w.toLowerCase()];return x?{r:x[0],g:x[1],b:x[2],a:1}:null},_rgbColorToRGBA(w){if(w.indexOf("rgb(")===0){w=w.match(/rgb\(([^)]+)\)/)[1];const x=w.split(/ *, */).map(Number);return{r:x[0],g:x[1],b:x[2],a:1}}},_rgbaColorToRGBA(w){if(w.indexOf("rgba(")===0){w=w.match(/rgba\(([^)]+)\)/)[1];const x=w.split(/ *, */).map((T,j)=>T.slice(-1)==="%"?j===3?parseInt(T)/100:parseInt(T)/100*255:Number(T));return{r:x[0],g:x[1],b:x[2],a:x[3]}}},_hex8ColorToRGBA(w){if(w[0]==="#"&&w.length===9)return{r:parseInt(w.slice(1,3),16),g:parseInt(w.slice(3,5),16),b:parseInt(w.slice(5,7),16),a:parseInt(w.slice(7,9),16)/255}},_hex6ColorToRGBA(w){if(w[0]==="#"&&w.length===7)return{r:parseInt(w.slice(1,3),16),g:parseInt(w.slice(3,5),16),b:parseInt(w.slice(5,7),16),a:1}},_hex4ColorToRGBA(w){if(w[0]==="#"&&w.length===5)return{r:parseInt(w[1]+w[1],16),g:parseInt(w[2]+w[2],16),b:parseInt(w[3]+w[3],16),a:parseInt(w[4]+w[4],16)/255}},_hex3ColorToRGBA(w){if(w[0]==="#"&&w.length===4)return{r:parseInt(w[1]+w[1],16),g:parseInt(w[2]+w[2],16),b:parseInt(w[3]+w[3],16),a:1}},_hslColorToRGBA(w){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(w)){const[x,...T]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(w),j=Number(T[0])/360,D=Number(T[1])/100,b=Number(T[2])/100;let _,I,S;if(D===0)return S=b*255,{r:Math.round(S),g:Math.round(S),b:Math.round(S),a:1};b<.5?_=b*(1+D):_=b+D-b*D;const F=2*b-_,B=[0,0,0];for(let E=0;E<3;E++)I=j+1/3*-(E-1),I<0&&I++,I>1&&I--,6*I<1?S=F+(_-F)*6*I:2*I<1?S=_:3*I<2?S=F+(_-F)*(2/3-I)*6:S=F,B[E]=S*255;return{r:Math.round(B[0]),g:Math.round(B[1]),b:Math.round(B[2]),a:1}}},haveIntersection(w,x){return!(x.x>w.x+w.width||x.x+x.width<w.x||x.y>w.y+w.height||x.y+x.height<w.y)},cloneObject(w){const x={};for(const T in w)this._isPlainObject(w[T])?x[T]=this.cloneObject(w[T]):this._isArray(w[T])?x[T]=this.cloneArray(w[T]):x[T]=w[T];return x},cloneArray(w){return w.slice(0)},degToRad(w){return w*a},radToDeg(w){return w*c},_degToRad(w){return n.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),n.Util.degToRad(w)},_radToDeg(w){return n.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),n.Util.radToDeg(w)},_getRotation(w){return e.Konva.angleDeg?n.Util.radToDeg(w):w},_capitalize(w){return w.charAt(0).toUpperCase()+w.slice(1)},throw(w){throw new Error(A+w)},error(w){console.error(A+w)},warn(w){e.Konva.showWarnings&&console.warn(f+w)},each(w,x){for(const T in w)x(T,w[T])},_inRange(w,x,T){return x<=w&&w<T},_getProjectionToSegment(w,x,T,j,D,b){let _,I,S;const F=(w-T)*(w-T)+(x-j)*(x-j);if(F==0)_=w,I=x,S=(D-T)*(D-T)+(b-j)*(b-j);else{const B=((D-w)*(T-w)+(b-x)*(j-x))/F;B<0?(_=w,I=x,S=(w-D)*(w-D)+(x-b)*(x-b)):B>1?(_=T,I=j,S=(T-D)*(T-D)+(j-b)*(j-b)):(_=w+B*(T-w),I=x+B*(j-x),S=(_-D)*(_-D)+(I-b)*(I-b))}return[_,I,S]},_getProjectionToLine(w,x,T){const j=n.Util.cloneObject(w);let D=Number.MAX_VALUE;return x.forEach(function(b,_){if(!T&&_===x.length-1)return;const I=x[(_+1)%x.length],S=n.Util._getProjectionToSegment(b.x,b.y,I.x,I.y,w.x,w.y),F=S[0],B=S[1],E=S[2];E<D&&(j.x=F,j.y=B,D=E)}),j},_prepareArrayForTween(w,x,T){const j=[],D=[];if(w.length>x.length){const _=x;x=w,w=_}for(let _=0;_<w.length;_+=2)j.push({x:w[_],y:w[_+1]});for(let _=0;_<x.length;_+=2)D.push({x:x[_],y:x[_+1]});const b=[];return D.forEach(function(_){const I=n.Util._getProjectionToLine(_,j,T);b.push(I.x),b.push(I.y)}),b},_prepareToStringify(w){let x;w.visitedByCircularReferenceRemoval=!0;for(const T in w)if(w.hasOwnProperty(T)&&w[T]&&typeof w[T]=="object"){if(x=Object.getOwnPropertyDescriptor(w,T),w[T].visitedByCircularReferenceRemoval||n.Util._isElement(w[T]))if(x.configurable)delete w[T];else return null;else if(n.Util._prepareToStringify(w[T])===null)if(x.configurable)delete w[T];else return null}return delete w.visitedByCircularReferenceRemoval,w},_assign(w,x){for(const T in x)w[T]=x[T];return w},_getFirstPointerId(w){return w.touches?w.changedTouches[0].identifier:w.pointerId||999},releaseCanvas(...w){e.Konva.releaseCanvasOnDestroy&&w.forEach(x=>{x.width=0,x.height=0})},drawRoundedRectPath(w,x,T,j){let D=0,b=0,_=0,I=0;typeof j=="number"?D=b=_=I=Math.min(j,x/2,T/2):(D=Math.min(j[0]||0,x/2,T/2),b=Math.min(j[1]||0,x/2,T/2),I=Math.min(j[2]||0,x/2,T/2),_=Math.min(j[3]||0,x/2,T/2)),w.moveTo(D,0),w.lineTo(x-b,0),w.arc(x-b,b,b,Math.PI*3/2,0,!1),w.lineTo(x,T-I),w.arc(x-I,T-I,I,0,Math.PI/2,!1),w.lineTo(_,T),w.arc(_,T-_,_,Math.PI/2,Math.PI,!1),w.lineTo(0,D),w.arc(D,D,D,Math.PI,Math.PI*3/2,!1)}}})(KT)),KT}var Z1={},Xd={},Kd={},fR;function Pq(){if(fR)return Kd;fR=1,Object.defineProperty(Kd,"__esModule",{value:!0}),Kd.HitContext=Kd.SceneContext=Kd.Context=void 0;const n=Zo(),e=Ur();function t(v){const m=[],w=v.length,x=n.Util;for(let T=0;T<w;T++){let j=v[T];x._isNumber(j)?j=Math.round(j*1e3)/1e3:x._isString(j)||(j=j+""),m.push(j)}return m}const i=",",r="(",s=")",o="([",a="])",c=";",h="()",u="=",d=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],f=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],A=100;let g=class{constructor(m){this.canvas=m,e.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(m){m.fillEnabled()&&this._fill(m)}_fill(m){}strokeShape(m){m.hasStroke()&&this._stroke(m)}_stroke(m){}fillStrokeShape(m){m.attrs.fillAfterStrokeEnabled?(this.strokeShape(m),this.fillShape(m)):(this.fillShape(m),this.strokeShape(m))}getTrace(m,w){let x=this.traceArr,T=x.length,j="",D,b,_,I;for(D=0;D<T;D++)b=x[D],_=b.method,_?(I=b.args,j+=_,m?j+=h:n.Util._isArray(I[0])?j+=o+I.join(i)+a:(w&&(I=I.map(S=>typeof S=="number"?Math.floor(S):S)),j+=r+I.join(i)+s)):(j+=b.property,m||(j+=u+b.val)),j+=c;return j}clearTrace(){this.traceArr=[]}_trace(m){let w=this.traceArr,x;w.push(m),x=w.length,x>=A&&w.shift()}reset(){const m=this.getCanvas().getPixelRatio();this.setTransform(1*m,0,0,1*m,0,0)}getCanvas(){return this.canvas}clear(m){const w=this.getCanvas();m?this.clearRect(m.x||0,m.y||0,m.width||0,m.height||0):this.clearRect(0,0,w.getWidth()/w.pixelRatio,w.getHeight()/w.pixelRatio)}_applyLineCap(m){const w=m.attrs.lineCap;w&&this.setAttr("lineCap",w)}_applyOpacity(m){const w=m.getAbsoluteOpacity();w!==1&&this.setAttr("globalAlpha",w)}_applyLineJoin(m){const w=m.attrs.lineJoin;w&&this.setAttr("lineJoin",w)}setAttr(m,w){this._context[m]=w}arc(m,w,x,T,j,D){this._context.arc(m,w,x,T,j,D)}arcTo(m,w,x,T,j){this._context.arcTo(m,w,x,T,j)}beginPath(){this._context.beginPath()}bezierCurveTo(m,w,x,T,j,D){this._context.bezierCurveTo(m,w,x,T,j,D)}clearRect(m,w,x,T){this._context.clearRect(m,w,x,T)}clip(...m){this._context.clip.apply(this._context,m)}closePath(){this._context.closePath()}createImageData(m,w){const x=arguments;if(x.length===2)return this._context.createImageData(m,w);if(x.length===1)return this._context.createImageData(m)}createLinearGradient(m,w,x,T){return this._context.createLinearGradient(m,w,x,T)}createPattern(m,w){return this._context.createPattern(m,w)}createRadialGradient(m,w,x,T,j,D){return this._context.createRadialGradient(m,w,x,T,j,D)}drawImage(m,w,x,T,j,D,b,_,I){const S=arguments,F=this._context;S.length===3?F.drawImage(m,w,x):S.length===5?F.drawImage(m,w,x,T,j):S.length===9&&F.drawImage(m,w,x,T,j,D,b,_,I)}ellipse(m,w,x,T,j,D,b,_){this._context.ellipse(m,w,x,T,j,D,b,_)}isPointInPath(m,w,x,T){return x?this._context.isPointInPath(x,m,w,T):this._context.isPointInPath(m,w,T)}fill(...m){this._context.fill.apply(this._context,m)}fillRect(m,w,x,T){this._context.fillRect(m,w,x,T)}strokeRect(m,w,x,T){this._context.strokeRect(m,w,x,T)}fillText(m,w,x,T){T?this._context.fillText(m,w,x,T):this._context.fillText(m,w,x)}measureText(m){return this._context.measureText(m)}getImageData(m,w,x,T){return this._context.getImageData(m,w,x,T)}lineTo(m,w){this._context.lineTo(m,w)}moveTo(m,w){this._context.moveTo(m,w)}rect(m,w,x,T){this._context.rect(m,w,x,T)}roundRect(m,w,x,T,j){this._context.roundRect(m,w,x,T,j)}putImageData(m,w,x){this._context.putImageData(m,w,x)}quadraticCurveTo(m,w,x,T){this._context.quadraticCurveTo(m,w,x,T)}restore(){this._context.restore()}rotate(m){this._context.rotate(m)}save(){this._context.save()}scale(m,w){this._context.scale(m,w)}setLineDash(m){this._context.setLineDash?this._context.setLineDash(m):"mozDash"in this._context?this._context.mozDash=m:"webkitLineDash"in this._context&&(this._context.webkitLineDash=m)}getLineDash(){return this._context.getLineDash()}setTransform(m,w,x,T,j,D){this._context.setTransform(m,w,x,T,j,D)}stroke(m){m?this._context.stroke(m):this._context.stroke()}strokeText(m,w,x,T){this._context.strokeText(m,w,x,T)}transform(m,w,x,T,j,D){this._context.transform(m,w,x,T,j,D)}translate(m,w){this._context.translate(m,w)}_enableTrace(){let m=this,w=d.length,x=this.setAttr,T,j;const D=function(b){let _=m[b],I;m[b]=function(){return j=t(Array.prototype.slice.call(arguments,0)),I=_.apply(m,arguments),m._trace({method:b,args:j}),I}};for(T=0;T<w;T++)D(d[T]);m.setAttr=function(){x.apply(m,arguments);const b=arguments[0];let _=arguments[1];(b==="shadowOffsetX"||b==="shadowOffsetY"||b==="shadowBlur")&&(_=_/this.canvas.getPixelRatio()),m._trace({property:b,val:_})}}_applyGlobalCompositeOperation(m){const w=m.attrs.globalCompositeOperation;!w||w==="source-over"||this.setAttr("globalCompositeOperation",w)}};Kd.Context=g,f.forEach(function(v){Object.defineProperty(g.prototype,v,{get(){return this._context[v]},set(m){this._context[v]=m}})});class p extends g{constructor(m,{willReadFrequently:w=!1}={}){super(m),this._context=m._canvas.getContext("2d",{willReadFrequently:w})}_fillColor(m){const w=m.fill();this.setAttr("fillStyle",w),m._fillFunc(this)}_fillPattern(m){this.setAttr("fillStyle",m._getFillPattern()),m._fillFunc(this)}_fillLinearGradient(m){const w=m._getLinearGradient();w&&(this.setAttr("fillStyle",w),m._fillFunc(this))}_fillRadialGradient(m){const w=m._getRadialGradient();w&&(this.setAttr("fillStyle",w),m._fillFunc(this))}_fill(m){const w=m.fill(),x=m.getFillPriority();if(w&&x==="color"){this._fillColor(m);return}const T=m.getFillPatternImage();if(T&&x==="pattern"){this._fillPattern(m);return}const j=m.getFillLinearGradientColorStops();if(j&&x==="linear-gradient"){this._fillLinearGradient(m);return}const D=m.getFillRadialGradientColorStops();if(D&&x==="radial-gradient"){this._fillRadialGradient(m);return}w?this._fillColor(m):T?this._fillPattern(m):j?this._fillLinearGradient(m):D&&this._fillRadialGradient(m)}_strokeLinearGradient(m){const w=m.getStrokeLinearGradientStartPoint(),x=m.getStrokeLinearGradientEndPoint(),T=m.getStrokeLinearGradientColorStops(),j=this.createLinearGradient(w.x,w.y,x.x,x.y);if(T){for(let D=0;D<T.length;D+=2)j.addColorStop(T[D],T[D+1]);this.setAttr("strokeStyle",j)}}_stroke(m){const w=m.dash(),x=m.getStrokeScaleEnabled();if(m.hasStroke()){if(!x){this.save();const j=this.getCanvas().getPixelRatio();this.setTransform(j,0,0,j,0,0)}this._applyLineCap(m),w&&m.dashEnabled()&&(this.setLineDash(w),this.setAttr("lineDashOffset",m.dashOffset())),this.setAttr("lineWidth",m.strokeWidth()),m.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),m.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(m):this.setAttr("strokeStyle",m.stroke()),m._strokeFunc(this),x||this.restore()}}_applyShadow(m){var w,x,T;const j=(w=m.getShadowRGBA())!==null&&w!==void 0?w:"black",D=(x=m.getShadowBlur())!==null&&x!==void 0?x:5,b=(T=m.getShadowOffset())!==null&&T!==void 0?T:{x:0,y:0},_=m.getAbsoluteScale(),I=this.canvas.getPixelRatio(),S=_.x*I,F=_.y*I;this.setAttr("shadowColor",j),this.setAttr("shadowBlur",D*Math.min(Math.abs(S),Math.abs(F))),this.setAttr("shadowOffsetX",b.x*S),this.setAttr("shadowOffsetY",b.y*F)}}Kd.SceneContext=p;class y extends g{constructor(m){super(m),this._context=m._canvas.getContext("2d",{willReadFrequently:!0})}_fill(m){this.save(),this.setAttr("fillStyle",m.colorKey),m._fillFuncHit(this),this.restore()}strokeShape(m){m.hasHitStroke()&&this._stroke(m)}_stroke(m){if(m.hasHitStroke()){const w=m.getStrokeScaleEnabled();if(!w){this.save();const j=this.getCanvas().getPixelRatio();this.setTransform(j,0,0,j,0,0)}this._applyLineCap(m);const x=m.hitStrokeWidth(),T=x==="auto"?m.strokeWidth():x;this.setAttr("lineWidth",T),this.setAttr("strokeStyle",m.colorKey),m._strokeFuncHit(this),w||this.restore()}}}return Kd.HitContext=y,Kd}var pR;function fS(){if(pR)return Xd;pR=1,Object.defineProperty(Xd,"__esModule",{value:!0}),Xd.HitCanvas=Xd.SceneCanvas=Xd.Canvas=void 0;const n=Zo(),e=Pq(),t=Ur();let i;function r(){if(i)return i;const c=n.Util.createCanvasElement(),h=c.getContext("2d");return i=(function(){const u=t.Konva._global.devicePixelRatio||1,d=h.webkitBackingStorePixelRatio||h.mozBackingStorePixelRatio||h.msBackingStorePixelRatio||h.oBackingStorePixelRatio||h.backingStorePixelRatio||1;return u/d})(),n.Util.releaseCanvas(c),i}let s=class{constructor(h){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const d=(h||{}).pixelRatio||t.Konva.pixelRatio||r();this.pixelRatio=d,this._canvas=n.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(h){const u=this.pixelRatio;this.pixelRatio=h,this.setSize(this.getWidth()/u,this.getHeight()/u)}setWidth(h){this.width=this._canvas.width=h*this.pixelRatio,this._canvas.style.width=h+"px";const u=this.pixelRatio;this.getContext()._context.scale(u,u)}setHeight(h){this.height=this._canvas.height=h*this.pixelRatio,this._canvas.style.height=h+"px";const u=this.pixelRatio;this.getContext()._context.scale(u,u)}getWidth(){return this.width}getHeight(){return this.height}setSize(h,u){this.setWidth(h||0),this.setHeight(u||0)}toDataURL(h,u){try{return this._canvas.toDataURL(h,u)}catch{try{return this._canvas.toDataURL()}catch(f){return n.Util.error("Unable to get data URL. "+f.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};Xd.Canvas=s;class o extends s{constructor(h={width:0,height:0,willReadFrequently:!1}){super(h),this.context=new e.SceneContext(this,{willReadFrequently:h.willReadFrequently}),this.setSize(h.width,h.height)}}Xd.SceneCanvas=o;class a extends s{constructor(h={width:0,height:0}){super(h),this.hitCanvas=!0,this.context=new e.HitContext(this),this.setSize(h.width,h.height)}}return Xd.HitCanvas=a,Xd}var qT={},gR;function A8(){return gR||(gR=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.DD=void 0;const e=Ur(),t=Zo();n.DD={get isDragging(){let i=!1;return n.DD._dragElements.forEach(r=>{r.dragStatus==="dragging"&&(i=!0)}),i},justDragged:!1,get node(){let i;return n.DD._dragElements.forEach(r=>{i=r.node}),i},_dragElements:new Map,_drag(i){const r=[];n.DD._dragElements.forEach((s,o)=>{const{node:a}=s,c=a.getStage();c.setPointersPositions(i),s.pointerId===void 0&&(s.pointerId=t.Util._getFirstPointerId(i));const h=c._changedPointerPositions.find(u=>u.id===s.pointerId);if(h){if(s.dragStatus!=="dragging"){const u=a.dragDistance();if(Math.max(Math.abs(h.x-s.startPointerPos.x),Math.abs(h.y-s.startPointerPos.y))<u||(a.startDrag({evt:i}),!a.isDragging()))return}a._setDragPosition(i,s),r.push(a)}}),r.forEach(s=>{s.fire("dragmove",{type:"dragmove",target:s,evt:i},!0)})},_endDragBefore(i){const r=[];n.DD._dragElements.forEach(s=>{const{node:o}=s,a=o.getStage();if(i&&a.setPointersPositions(i),!a._changedPointerPositions.find(u=>u.id===s.pointerId))return;(s.dragStatus==="dragging"||s.dragStatus==="stopped")&&(n.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,s.dragStatus="stopped");const h=s.node.getLayer()||s.node instanceof e.Konva.Stage&&s.node;h&&r.indexOf(h)===-1&&r.push(h)}),r.forEach(s=>{s.draw()})},_endDragAfter(i){n.DD._dragElements.forEach((r,s)=>{r.dragStatus==="stopped"&&r.node.fire("dragend",{type:"dragend",target:r.node,evt:i},!0),r.dragStatus!=="dragging"&&n.DD._dragElements.delete(s)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",n.DD._endDragBefore,!0),window.addEventListener("touchend",n.DD._endDragBefore,!0),window.addEventListener("touchcancel",n.DD._endDragBefore,!0),window.addEventListener("mousemove",n.DD._drag),window.addEventListener("touchmove",n.DD._drag),window.addEventListener("mouseup",n.DD._endDragAfter,!1),window.addEventListener("touchend",n.DD._endDragAfter,!1),window.addEventListener("touchcancel",n.DD._endDragAfter,!1))})(qT)),qT}var YT={},Ic={},mR;function Jr(){if(mR)return Ic;mR=1,Object.defineProperty(Ic,"__esModule",{value:!0}),Ic.RGBComponent=i,Ic.alphaComponent=r,Ic.getNumberValidator=s,Ic.getNumberOrArrayOfNumbersValidator=o,Ic.getNumberOrAutoValidator=a,Ic.getStringValidator=c,Ic.getStringOrGradientValidator=h,Ic.getFunctionValidator=u,Ic.getNumberArrayValidator=d,Ic.getBooleanValidator=f,Ic.getComponentValidator=A;const n=Ur(),e=Zo();function t(g){return e.Util._isString(g)?'"'+g+'"':Object.prototype.toString.call(g)==="[object Number]"||e.Util._isBoolean(g)?g:Object.prototype.toString.call(g)}function i(g){return g>255?255:g<0?0:Math.round(g)}function r(g){return g>1?1:g<1e-4?1e-4:g}function s(){if(n.Konva.isUnminified)return function(g,p){return e.Util._isNumber(g)||e.Util.warn(t(g)+' is a not valid value for "'+p+'" attribute. The value should be a number.'),g}}function o(g){if(n.Konva.isUnminified)return function(p,y){let v=e.Util._isNumber(p),m=e.Util._isArray(p)&&p.length==g;return!v&&!m&&e.Util.warn(t(p)+' is a not valid value for "'+y+'" attribute. The value should be a number or Array<number>('+g+")"),p}}function a(){if(n.Konva.isUnminified)return function(g,p){return e.Util._isNumber(g)||g==="auto"||e.Util.warn(t(g)+' is a not valid value for "'+p+'" attribute. The value should be a number or "auto".'),g}}function c(){if(n.Konva.isUnminified)return function(g,p){return e.Util._isString(g)||e.Util.warn(t(g)+' is a not valid value for "'+p+'" attribute. The value should be a string.'),g}}function h(){if(n.Konva.isUnminified)return function(g,p){const y=e.Util._isString(g),v=Object.prototype.toString.call(g)==="[object CanvasGradient]"||g&&g.addColorStop;return y||v||e.Util.warn(t(g)+' is a not valid value for "'+p+'" attribute. The value should be a string or a native gradient.'),g}}function u(){if(n.Konva.isUnminified)return function(g,p){return e.Util._isFunction(g)||e.Util.warn(t(g)+' is a not valid value for "'+p+'" attribute. The value should be a function.'),g}}function d(){if(n.Konva.isUnminified)return function(g,p){const y=Int8Array?Object.getPrototypeOf(Int8Array):null;return y&&g instanceof y||(e.Util._isArray(g)?g.forEach(function(v){e.Util._isNumber(v)||e.Util.warn('"'+p+'" attribute has non numeric element '+v+". Make sure that all elements are numbers.")}):e.Util.warn(t(g)+' is a not valid value for "'+p+'" attribute. The value should be a array of numbers.')),g}}function f(){if(n.Konva.isUnminified)return function(g,p){return g===!0||g===!1||e.Util.warn(t(g)+' is a not valid value for "'+p+'" attribute. The value should be a boolean.'),g}}function A(g){if(n.Konva.isUnminified)return function(p,y){return p==null||e.Util.isObject(p)||e.Util.warn(t(p)+' is a not valid value for "'+y+'" attribute. The value should be an object with properties '+g),p}}return Ic}var yR;function zr(){return yR||(yR=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Factory=void 0;const e=Zo(),t=Jr(),i="get",r="set";n.Factory={addGetterSetter(s,o,a,c,h){n.Factory.addGetter(s,o,a),n.Factory.addSetter(s,o,c,h),n.Factory.addOverloadedGetterSetter(s,o)},addGetter(s,o,a){const c=i+e.Util._capitalize(o);s.prototype[c]=s.prototype[c]||function(){const h=this.attrs[o];return h===void 0?a:h}},addSetter(s,o,a,c){const h=r+e.Util._capitalize(o);s.prototype[h]||n.Factory.overWriteSetter(s,o,a,c)},overWriteSetter(s,o,a,c){const h=r+e.Util._capitalize(o);s.prototype[h]=function(u){return a&&u!==void 0&&u!==null&&(u=a.call(this,u,o)),this._setAttr(o,u),c&&c.call(this),this}},addComponentsGetterSetter(s,o,a,c,h){const u=a.length,d=e.Util._capitalize,f=i+d(o),A=r+d(o);s.prototype[f]=function(){const p={};for(let y=0;y<u;y++){const v=a[y];p[v]=this.getAttr(o+d(v))}return p};const g=(0,t.getComponentValidator)(a);s.prototype[A]=function(p){const y=this.attrs[o];c&&(p=c.call(this,p,o)),g&&g.call(this,p,o);for(const v in p)p.hasOwnProperty(v)&&this._setAttr(o+d(v),p[v]);return p||a.forEach(v=>{this._setAttr(o+d(v),void 0)}),this._fireChangeEvent(o,y,p),h&&h.call(this),this},n.Factory.addOverloadedGetterSetter(s,o)},addOverloadedGetterSetter(s,o){const a=e.Util._capitalize(o),c=r+a,h=i+a;s.prototype[o]=function(){return arguments.length?(this[c](arguments[0]),this):this[h]()}},addDeprecatedGetterSetter(s,o,a,c){e.Util.error("Adding deprecated "+o);const h=i+e.Util._capitalize(o),u=o+" property is deprecated and will be removed soon. Look at Konva change log for more information.";s.prototype[h]=function(){e.Util.error(u);const d=this.attrs[o];return d===void 0?a:d},n.Factory.addSetter(s,o,c,function(){e.Util.error(u)}),n.Factory.addOverloadedGetterSetter(s,o)},backCompat(s,o){e.Util.each(o,function(a,c){const h=s.prototype[c],u=i+e.Util._capitalize(a),d=r+e.Util._capitalize(a);function f(){h.apply(this,arguments),e.Util.error('"'+a+'" method is deprecated and will be removed soon. Use ""'+c+'" instead.')}s.prototype[a]=f,s.prototype[u]=f,s.prototype[d]=f})},afterSetFilter(){this._filterUpToDate=!1}}})(YT)),YT}var vR;function ga(){if(vR)return Z1;vR=1,Object.defineProperty(Z1,"__esModule",{value:!0}),Z1.Node=void 0;const n=fS(),e=A8(),t=zr(),i=Ur(),r=Zo(),s=Jr(),o="absoluteOpacity",a="allEventListeners",c="absoluteTransform",h="absoluteScale",u="canvas",d="Change",f="children",A="konva",g="listening",p="mouseenter",y="mouseleave",v="pointerenter",m="pointerleave",w="touchenter",x="touchleave",T="set",j="Shape",D=" ",b="stage",_="transform",I="Stage",S="visible",F=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(D);let B=1;class E{constructor(P){this._id=B++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(P),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(P){(P===_||P===c)&&this._cache.get(P)?this._cache.get(P).dirty=!0:P?this._cache.delete(P):this._cache.clear()}_getCache(P,M){let X=this._cache.get(P);return(X===void 0||(P===_||P===c)&&X.dirty===!0)&&(X=M.call(this),this._cache.set(P,X)),X}_calculate(P,M,X){if(!this._attachedDepsListeners.get(P)){const Z=M.map(Q=>Q+"Change.konva").join(D);this.on(Z,()=>{this._clearCache(P)}),this._attachedDepsListeners.set(P,!0)}return this._getCache(P,X)}_getCanvasCache(){return this._cache.get(u)}_clearSelfAndDescendantCache(P){this._clearCache(P),P===c&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(u)){const{scene:P,filter:M,hit:X,buffer:Z}=this._cache.get(u);r.Util.releaseCanvas(P,M,X,Z),this._cache.delete(u)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(P){const M=P||{};let X={};(M.x===void 0||M.y===void 0||M.width===void 0||M.height===void 0)&&(X=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let Z=Math.ceil(M.width||X.width),Q=Math.ceil(M.height||X.height),U=M.pixelRatio,z=M.x===void 0?Math.floor(X.x):M.x,q=M.y===void 0?Math.floor(X.y):M.y,G=M.offset||0,ie=M.drawBorder||!1,H=M.hitCanvasPixelRatio||1;if(!Z||!Q){r.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const se=Math.abs(Math.round(X.x)-z)>.5?1:0,te=Math.abs(Math.round(X.y)-q)>.5?1:0;Z+=G*2+se,Q+=G*2+te,z-=G,q-=G;const fe=new n.SceneCanvas({pixelRatio:U,width:Z,height:Q}),ye=new n.SceneCanvas({pixelRatio:U,width:0,height:0,willReadFrequently:!0}),be=new n.HitCanvas({pixelRatio:H,width:Z,height:Q}),_e=fe.getContext(),W=be.getContext(),Y=new n.SceneCanvas({width:fe.width/fe.pixelRatio+Math.abs(z),height:fe.height/fe.pixelRatio+Math.abs(q),pixelRatio:fe.pixelRatio}),ve=Y.getContext();return be.isCache=!0,fe.isCache=!0,this._cache.delete(u),this._filterUpToDate=!1,M.imageSmoothingEnabled===!1&&(fe.getContext()._context.imageSmoothingEnabled=!1,ye.getContext()._context.imageSmoothingEnabled=!1),_e.save(),W.save(),ve.save(),_e.translate(-z,-q),W.translate(-z,-q),ve.translate(-z,-q),Y.x=z,Y.y=q,this._isUnderCache=!0,this._clearSelfAndDescendantCache(o),this._clearSelfAndDescendantCache(h),this.drawScene(fe,this,Y),this.drawHit(be,this),this._isUnderCache=!1,_e.restore(),W.restore(),ie&&(_e.save(),_e.beginPath(),_e.rect(0,0,Z,Q),_e.closePath(),_e.setAttr("strokeStyle","red"),_e.setAttr("lineWidth",5),_e.stroke(),_e.restore()),this._cache.set(u,{scene:fe,filter:ye,hit:be,buffer:Y,x:z,y:q}),this._requestDraw(),this}isCached(){return this._cache.has(u)}getClientRect(P){throw new Error('abstract "getClientRect" method call')}_transformedRect(P,M){const X=[{x:P.x,y:P.y},{x:P.x+P.width,y:P.y},{x:P.x+P.width,y:P.y+P.height},{x:P.x,y:P.y+P.height}];let Z=1/0,Q=1/0,U=-1/0,z=-1/0;const q=this.getAbsoluteTransform(M);return X.forEach(function(G){const ie=q.point(G);Z===void 0&&(Z=U=ie.x,Q=z=ie.y),Z=Math.min(Z,ie.x),Q=Math.min(Q,ie.y),U=Math.max(U,ie.x),z=Math.max(z,ie.y)}),{x:Z,y:Q,width:U-Z,height:z-Q}}_drawCachedSceneCanvas(P){P.save(),P._applyOpacity(this),P._applyGlobalCompositeOperation(this);const M=this._getCanvasCache();P.translate(M.x,M.y);const X=this._getCachedSceneCanvas(),Z=X.pixelRatio;P.drawImage(X._canvas,0,0,X.width/Z,X.height/Z),P.restore()}_drawCachedHitCanvas(P){const M=this._getCanvasCache(),X=M.hit;P.save(),P.translate(M.x,M.y),P.drawImage(X._canvas,0,0,X.width/X.pixelRatio,X.height/X.pixelRatio),P.restore()}_getCachedSceneCanvas(){let P=this.filters(),M=this._getCanvasCache(),X=M.scene,Z=M.filter,Q=Z.getContext(),U,z,q,G;if(P){if(!this._filterUpToDate){const ie=X.pixelRatio;Z.setSize(X.width/X.pixelRatio,X.height/X.pixelRatio);try{for(U=P.length,Q.clear(),Q.drawImage(X._canvas,0,0,X.getWidth()/ie,X.getHeight()/ie),z=Q.getImageData(0,0,Z.getWidth(),Z.getHeight()),q=0;q<U;q++){if(G=P[q],typeof G!="function"){r.Util.error("Filter should be type of function, but got "+typeof G+" instead. Please check correct filters");continue}G.call(this,z),Q.putImageData(z,0,0)}}catch(H){r.Util.error("Unable to apply filter. "+H.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return Z}return X}on(P,M){if(this._cache&&this._cache.delete(a),arguments.length===3)return this._delegate.apply(this,arguments);const X=P.split(D);for(let Z=0;Z<X.length;Z++){const U=X[Z].split("."),z=U[0],q=U[1]||"";this.eventListeners[z]||(this.eventListeners[z]=[]),this.eventListeners[z].push({name:q,handler:M})}return this}off(P,M){let X=(P||"").split(D),Z=X.length,Q,U,z,q,G,ie;if(this._cache&&this._cache.delete(a),!P)for(U in this.eventListeners)this._off(U);for(Q=0;Q<Z;Q++)if(z=X[Q],q=z.split("."),G=q[0],ie=q[1],G)this.eventListeners[G]&&this._off(G,ie,M);else for(U in this.eventListeners)this._off(U,ie,M);return this}dispatchEvent(P){const M={target:this,type:P.type,evt:P};return this.fire(P.type,M),this}addEventListener(P,M){return this.on(P,function(X){M.call(this,X.evt)}),this}removeEventListener(P){return this.off(P),this}_delegate(P,M,X){const Z=this;this.on(P,function(Q){const U=Q.target.findAncestors(M,!0,Z);for(let z=0;z<U.length;z++)Q=r.Util.cloneObject(Q),Q.currentTarget=U[z],X.call(U[z],Q)})}remove(){return this.isDragging()&&this.stopDrag(),e.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(c),this._clearSelfAndDescendantCache(o),this._clearSelfAndDescendantCache(h),this._clearSelfAndDescendantCache(b),this._clearSelfAndDescendantCache(S),this._clearSelfAndDescendantCache(g)}_remove(){this._clearCaches();const P=this.getParent();P&&P.children&&(P.children.splice(this.index,1),P._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(P){const M="get"+r.Util._capitalize(P);return r.Util._isFunction(this[M])?this[M]():this.attrs[P]}getAncestors(){let P=this.getParent(),M=[];for(;P;)M.push(P),P=P.getParent();return M}getAttrs(){return this.attrs||{}}setAttrs(P){return this._batchTransformChanges(()=>{let M,X;if(!P)return this;for(M in P)M!==f&&(X=T+r.Util._capitalize(M),r.Util._isFunction(this[X])?this[X](P[M]):this._setAttr(M,P[M]))}),this}isListening(){return this._getCache(g,this._isListening)}_isListening(P){if(!this.listening())return!1;const X=this.getParent();return X&&X!==P&&this!==P?X._isListening(P):!0}isVisible(){return this._getCache(S,this._isVisible)}_isVisible(P){if(!this.visible())return!1;const X=this.getParent();return X&&X!==P&&this!==P?X._isVisible(P):!0}shouldDrawHit(P,M=!1){if(P)return this._isVisible(P)&&this._isListening(P);const X=this.getLayer();let Z=!1;e.DD._dragElements.forEach(U=>{U.dragStatus==="dragging"&&(U.node.nodeType==="Stage"||U.node.getLayer()===X)&&(Z=!0)});const Q=!M&&!i.Konva.hitOnDragEnabled&&(Z||i.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!Q}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let P=this.getDepth(),M=this,X=0,Z,Q,U,z;function q(ie){for(Z=[],Q=ie.length,U=0;U<Q;U++)z=ie[U],X++,z.nodeType!==j&&(Z=Z.concat(z.getChildren().slice())),z._id===M._id&&(U=Q);Z.length>0&&Z[0].getDepth()<=P&&q(Z)}const G=this.getStage();return M.nodeType!==I&&G&&q(G.getChildren()),X}getDepth(){let P=0,M=this.parent;for(;M;)P++,M=M.parent;return P}_batchTransformChanges(P){this._batchingTransformChange=!0,P(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(_),this._clearSelfAndDescendantCache(c)),this._needClearTransformCache=!1}setPosition(P){return this._batchTransformChanges(()=>{this.x(P.x),this.y(P.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const P=this.getStage();if(!P)return null;const M=P.getPointerPosition();if(!M)return null;const X=this.getAbsoluteTransform().copy();return X.invert(),X.point(M)}getAbsolutePosition(P){let M=!1,X=this.parent;for(;X;){if(X.isCached()){M=!0;break}X=X.parent}M&&!P&&(P=!0);const Z=this.getAbsoluteTransform(P).getMatrix(),Q=new r.Transform,U=this.offset();return Q.m=Z.slice(),Q.translate(U.x,U.y),Q.getTranslation()}setAbsolutePosition(P){const{x:M,y:X,...Z}=this._clearTransform();this.attrs.x=M,this.attrs.y=X,this._clearCache(_);const Q=this._getAbsoluteTransform().copy();return Q.invert(),Q.translate(P.x,P.y),P={x:this.attrs.x+Q.getTranslation().x,y:this.attrs.y+Q.getTranslation().y},this._setTransform(Z),this.setPosition({x:P.x,y:P.y}),this._clearCache(_),this._clearSelfAndDescendantCache(c),this}_setTransform(P){let M;for(M in P)this.attrs[M]=P[M]}_clearTransform(){const P={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,P}move(P){let M=P.x,X=P.y,Z=this.x(),Q=this.y();return M!==void 0&&(Z+=M),X!==void 0&&(Q+=X),this.setPosition({x:Z,y:Q}),this}_eachAncestorReverse(P,M){let X=[],Z=this.getParent(),Q,U;if(!(M&&M._id===this._id)){for(X.unshift(this);Z&&(!M||Z._id!==M._id);)X.unshift(Z),Z=Z.parent;for(Q=X.length,U=0;U<Q;U++)P(X[U])}}rotate(P){return this.rotation(this.rotation()+P),this}moveToTop(){if(!this.parent)return r.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const P=this.index,M=this.parent.getChildren().length;return P<M-1?(this.parent.children.splice(P,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return r.Util.warn("Node has no parent. moveUp function is ignored."),!1;const P=this.index,M=this.parent.getChildren().length;return P<M-1?(this.parent.children.splice(P,1),this.parent.children.splice(P+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return r.Util.warn("Node has no parent. moveDown function is ignored."),!1;const P=this.index;return P>0?(this.parent.children.splice(P,1),this.parent.children.splice(P-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return r.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const P=this.index;return P>0?(this.parent.children.splice(P,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(P){if(!this.parent)return r.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(P<0||P>=this.parent.children.length)&&r.Util.warn("Unexpected value "+P+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const M=this.index;return this.parent.children.splice(M,1),this.parent.children.splice(P,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(o,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let P=this.opacity();const M=this.getParent();return M&&!M._isUnderCache&&(P*=M.getAbsoluteOpacity()),P}moveTo(P){return this.getParent()!==P&&(this._remove(),P.add(this)),this}toObject(){let P=this.getAttrs(),M,X,Z,Q,U;const z={attrs:{},className:this.getClassName()};for(M in P)X=P[M],U=r.Util.isObject(X)&&!r.Util._isPlainObject(X)&&!r.Util._isArray(X),!U&&(Z=typeof this[M]=="function"&&this[M],delete P[M],Q=Z?Z.call(this):null,P[M]=X,Q!==X&&(z.attrs[M]=X));return r.Util._prepareToStringify(z)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(P,M,X){const Z=[];M&&this._isMatch(P)&&Z.push(this);let Q=this.parent;for(;Q;){if(Q===X)return Z;Q._isMatch(P)&&Z.push(Q),Q=Q.parent}return Z}isAncestorOf(P){return!1}findAncestor(P,M,X){return this.findAncestors(P,M,X)[0]}_isMatch(P){if(!P)return!1;if(typeof P=="function")return P(this);let M=P.replace(/ /g,"").split(","),X=M.length,Z,Q;for(Z=0;Z<X;Z++)if(Q=M[Z],r.Util.isValidSelector(Q)||(r.Util.warn('Selector "'+Q+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),r.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),r.Util.warn("Konva is awesome, right?")),Q.charAt(0)==="#"){if(this.id()===Q.slice(1))return!0}else if(Q.charAt(0)==="."){if(this.hasName(Q.slice(1)))return!0}else if(this.className===Q||this.nodeType===Q)return!0;return!1}getLayer(){const P=this.getParent();return P?P.getLayer():null}getStage(){return this._getCache(b,this._getStage)}_getStage(){const P=this.getParent();return P?P.getStage():null}fire(P,M={},X){return M.target=M.target||this,X?this._fireAndBubble(P,M):this._fire(P,M),this}getAbsoluteTransform(P){return P?this._getAbsoluteTransform(P):this._getCache(c,this._getAbsoluteTransform)}_getAbsoluteTransform(P){let M;if(P)return M=new r.Transform,this._eachAncestorReverse(function(X){const Z=X.transformsEnabled();Z==="all"?M.multiply(X.getTransform()):Z==="position"&&M.translate(X.x()-X.offsetX(),X.y()-X.offsetY())},P),M;{M=this._cache.get(c)||new r.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(M):M.reset();const X=this.transformsEnabled();if(X==="all")M.multiply(this.getTransform());else if(X==="position"){const Z=this.attrs.x||0,Q=this.attrs.y||0,U=this.attrs.offsetX||0,z=this.attrs.offsetY||0;M.translate(Z-U,Q-z)}return M.dirty=!1,M}}getAbsoluteScale(P){let M=this;for(;M;)M._isUnderCache&&(P=M),M=M.getParent();const Z=this.getAbsoluteTransform(P).decompose();return{x:Z.scaleX,y:Z.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(_,this._getTransform)}_getTransform(){var P,M;const X=this._cache.get(_)||new r.Transform;X.reset();const Z=this.x(),Q=this.y(),U=i.Konva.getAngle(this.rotation()),z=(P=this.attrs.scaleX)!==null&&P!==void 0?P:1,q=(M=this.attrs.scaleY)!==null&&M!==void 0?M:1,G=this.attrs.skewX||0,ie=this.attrs.skewY||0,H=this.attrs.offsetX||0,se=this.attrs.offsetY||0;return(Z!==0||Q!==0)&&X.translate(Z,Q),U!==0&&X.rotate(U),(G!==0||ie!==0)&&X.skew(G,ie),(z!==1||q!==1)&&X.scale(z,q),(H!==0||se!==0)&&X.translate(-1*H,-1*se),X.dirty=!1,X}clone(P){let M=r.Util.cloneObject(this.attrs),X,Z,Q,U,z;for(X in P)M[X]=P[X];const q=new this.constructor(M);for(X in this.eventListeners)for(Z=this.eventListeners[X],Q=Z.length,U=0;U<Q;U++)z=Z[U],z.name.indexOf(A)<0&&(q.eventListeners[X]||(q.eventListeners[X]=[]),q.eventListeners[X].push(z));return q}_toKonvaCanvas(P){P=P||{};const M=this.getClientRect(),X=this.getStage(),Z=P.x!==void 0?P.x:Math.floor(M.x),Q=P.y!==void 0?P.y:Math.floor(M.y),U=P.pixelRatio||1,z=new n.SceneCanvas({width:P.width||Math.ceil(M.width)||(X?X.width():0),height:P.height||Math.ceil(M.height)||(X?X.height():0),pixelRatio:U}),q=z.getContext(),G=new n.SceneCanvas({width:z.width/z.pixelRatio+Math.abs(Z),height:z.height/z.pixelRatio+Math.abs(Q),pixelRatio:z.pixelRatio});return P.imageSmoothingEnabled===!1&&(q._context.imageSmoothingEnabled=!1),q.save(),(Z||Q)&&q.translate(-1*Z,-1*Q),this.drawScene(z,void 0,G),q.restore(),z}toCanvas(P){return this._toKonvaCanvas(P)._canvas}toDataURL(P){P=P||{};const M=P.mimeType||null,X=P.quality||null,Z=this._toKonvaCanvas(P).toDataURL(M,X);return P.callback&&P.callback(Z),Z}toImage(P){return new Promise((M,X)=>{try{const Z=P==null?void 0:P.callback;Z&&delete P.callback,r.Util._urlToImage(this.toDataURL(P),function(Q){M(Q),Z==null||Z(Q)})}catch(Z){X(Z)}})}toBlob(P){return new Promise((M,X)=>{try{const Z=P==null?void 0:P.callback;Z&&delete P.callback,this.toCanvas(P).toBlob(Q=>{M(Q),Z==null||Z(Q)},P==null?void 0:P.mimeType,P==null?void 0:P.quality)}catch(Z){X(Z)}})}setSize(P){return this.width(P.width),this.height(P.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():i.Konva.dragDistance}_off(P,M,X){let Z=this.eventListeners[P],Q,U,z;for(Q=0;Q<Z.length;Q++)if(U=Z[Q].name,z=Z[Q].handler,(U!=="konva"||M==="konva")&&(!M||U===M)&&(!X||X===z)){if(Z.splice(Q,1),Z.length===0){delete this.eventListeners[P];break}Q--}}_fireChangeEvent(P,M,X){this._fire(P+d,{oldVal:M,newVal:X})}addName(P){if(!this.hasName(P)){const M=this.name(),X=M?M+" "+P:P;this.name(X)}return this}hasName(P){if(!P)return!1;const M=this.name();return M?(M||"").split(/\s/g).indexOf(P)!==-1:!1}removeName(P){const M=(this.name()||"").split(/\s/g),X=M.indexOf(P);return X!==-1&&(M.splice(X,1),this.name(M.join(" "))),this}setAttr(P,M){const X=this[T+r.Util._capitalize(P)];return r.Util._isFunction(X)?X.call(this,M):this._setAttr(P,M),this}_requestDraw(){if(i.Konva.autoDrawEnabled){const P=this.getLayer()||this.getStage();P==null||P.batchDraw()}}_setAttr(P,M){const X=this.attrs[P];X===M&&!r.Util.isObject(M)||(M==null?delete this.attrs[P]:this.attrs[P]=M,this._shouldFireChangeEvents&&this._fireChangeEvent(P,X,M),this._requestDraw())}_setComponentAttr(P,M,X){let Z;X!==void 0&&(Z=this.attrs[P],Z||(this.attrs[P]=this.getAttr(P)),this.attrs[P][M]=X,this._fireChangeEvent(P,Z,X))}_fireAndBubble(P,M,X){M&&this.nodeType===j&&(M.target=this);const Z=[p,y,v,m,w,x];if(!(Z.indexOf(P)!==-1&&(X&&(this===X||this.isAncestorOf&&this.isAncestorOf(X))||this.nodeType==="Stage"&&!X))){this._fire(P,M);const U=Z.indexOf(P)!==-1&&X&&X.isAncestorOf&&X.isAncestorOf(this)&&!X.isAncestorOf(this.parent);(M&&!M.cancelBubble||!M)&&this.parent&&this.parent.isListening()&&!U&&(X&&X.parent?this._fireAndBubble.call(this.parent,P,M,X):this._fireAndBubble.call(this.parent,P,M))}}_getProtoListeners(P){var M,X,Z;const Q=(M=this._cache.get(a))!==null&&M!==void 0?M:{};let U=Q==null?void 0:Q[P];if(U===void 0){U=[];let z=Object.getPrototypeOf(this);for(;z;){const q=(Z=(X=z.eventListeners)===null||X===void 0?void 0:X[P])!==null&&Z!==void 0?Z:[];U.push(...q),z=Object.getPrototypeOf(z)}Q[P]=U,this._cache.set(a,Q)}return U}_fire(P,M){M=M||{},M.currentTarget=this,M.type=P;const X=this._getProtoListeners(P);if(X)for(let Q=0;Q<X.length;Q++)X[Q].handler.call(this,M);const Z=this.eventListeners[P];if(Z)for(let Q=0;Q<Z.length;Q++)Z[Q].handler.call(this,M)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(P){const M=P?P.pointerId:void 0,X=this.getStage(),Z=this.getAbsolutePosition();if(!X)return;const Q=X._getPointerById(M)||X._changedPointerPositions[0]||Z;e.DD._dragElements.set(this._id,{node:this,startPointerPos:Q,offset:{x:Q.x-Z.x,y:Q.y-Z.y},dragStatus:"ready",pointerId:M})}startDrag(P,M=!0){e.DD._dragElements.has(this._id)||this._createDragElement(P);const X=e.DD._dragElements.get(this._id);X.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:P&&P.evt},M)}_setDragPosition(P,M){const X=this.getStage()._getPointerById(M.pointerId);if(!X)return;let Z={x:X.x-M.offset.x,y:X.y-M.offset.y};const Q=this.dragBoundFunc();if(Q!==void 0){const U=Q.call(this,Z,P);U?Z=U:r.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==Z.x||this._lastPos.y!==Z.y)&&(this.setAbsolutePosition(Z),this._requestDraw()),this._lastPos=Z}stopDrag(P){const M=e.DD._dragElements.get(this._id);M&&(M.dragStatus="stopped"),e.DD._endDragBefore(P),e.DD._endDragAfter(P)}setDraggable(P){this._setAttr("draggable",P),this._dragChange()}isDragging(){const P=e.DD._dragElements.get(this._id);return P?P.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(P){if(!(!(P.evt.button!==void 0)||i.Konva.dragButtons.indexOf(P.evt.button)>=0)||this.isDragging())return;let Z=!1;e.DD._dragElements.forEach(Q=>{this.isAncestorOf(Q.node)&&(Z=!0)}),Z||this._createDragElement(P)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const M=e.DD._dragElements.get(this._id),X=M&&M.dragStatus==="dragging",Z=M&&M.dragStatus==="ready";X?this.stopDrag():Z&&e.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(P={x:0,y:0}){const M=this.getStage();if(!M)return!1;const X={x:-P.x,y:-P.y,width:M.width()+2*P.x,height:M.height()+2*P.y};return r.Util.haveIntersection(X,this.getClientRect())}static create(P,M){return r.Util._isString(P)&&(P=JSON.parse(P)),this._createNode(P,M)}static _createNode(P,M){let X=E.prototype.getClassName.call(P),Z=P.children,Q,U,z;M&&(P.attrs.container=M),i.Konva[X]||(r.Util.warn('Can not find a node with class name "'+X+'". Fallback to "Shape".'),X="Shape");const q=i.Konva[X];if(Q=new q(P.attrs),Z)for(U=Z.length,z=0;z<U;z++)Q.add(E._createNode(Z[z]));return Q}}Z1.Node=E,E.prototype.nodeType="Node",E.prototype._attrsAffectingSize=[],E.prototype.eventListeners={},E.prototype.on.call(E.prototype,F,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(_),this._clearSelfAndDescendantCache(c)}),E.prototype.on.call(E.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(S)}),E.prototype.on.call(E.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(g)}),E.prototype.on.call(E.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(o)});const V=t.Factory.addGetterSetter;return V(E,"zIndex"),V(E,"absolutePosition"),V(E,"position"),V(E,"x",0,(0,s.getNumberValidator)()),V(E,"y",0,(0,s.getNumberValidator)()),V(E,"globalCompositeOperation","source-over",(0,s.getStringValidator)()),V(E,"opacity",1,(0,s.getNumberValidator)()),V(E,"name","",(0,s.getStringValidator)()),V(E,"id","",(0,s.getStringValidator)()),V(E,"rotation",0,(0,s.getNumberValidator)()),t.Factory.addComponentsGetterSetter(E,"scale",["x","y"]),V(E,"scaleX",1,(0,s.getNumberValidator)()),V(E,"scaleY",1,(0,s.getNumberValidator)()),t.Factory.addComponentsGetterSetter(E,"skew",["x","y"]),V(E,"skewX",0,(0,s.getNumberValidator)()),V(E,"skewY",0,(0,s.getNumberValidator)()),t.Factory.addComponentsGetterSetter(E,"offset",["x","y"]),V(E,"offsetX",0,(0,s.getNumberValidator)()),V(E,"offsetY",0,(0,s.getNumberValidator)()),V(E,"dragDistance",void 0,(0,s.getNumberValidator)()),V(E,"width",0,(0,s.getNumberValidator)()),V(E,"height",0,(0,s.getNumberValidator)()),V(E,"listening",!0,(0,s.getBooleanValidator)()),V(E,"preventDefault",!0,(0,s.getBooleanValidator)()),V(E,"filters",void 0,function(K){return this._filterUpToDate=!1,K}),V(E,"visible",!0,(0,s.getBooleanValidator)()),V(E,"transformsEnabled","all",(0,s.getStringValidator)()),V(E,"size"),V(E,"dragBoundFunc"),V(E,"draggable",!1,(0,s.getBooleanValidator)()),t.Factory.backCompat(E,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),Z1}var J1={},wR;function pS(){if(wR)return J1;wR=1,Object.defineProperty(J1,"__esModule",{value:!0}),J1.Container=void 0;const n=zr(),e=ga(),t=Jr();let i=class extends e.Node{constructor(){super(...arguments),this.children=[]}getChildren(s){const o=this.children||[];return s?o.filter(s):o}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(s=>{s.parent=null,s.index=0,s.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(s=>{s.parent=null,s.index=0,s.destroy()}),this.children=[],this._requestDraw(),this}add(...s){if(s.length===0)return this;if(s.length>1){for(let a=0;a<s.length;a++)this.add(s[a]);return this}const o=s[0];return o.getParent()?(o.moveTo(this),this):(this._validateAdd(o),o.index=this.getChildren().length,o.parent=this,o._clearCaches(),this.getChildren().push(o),this._fire("add",{child:o}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(s){return this._generalFind(s,!1)}findOne(s){const o=this._generalFind(s,!0);return o.length>0?o[0]:void 0}_generalFind(s,o){const a=[];return this._descendants(c=>{const h=c._isMatch(s);return h&&a.push(c),!!(h&&o)}),a}_descendants(s){let o=!1;const a=this.getChildren();for(const c of a){if(o=s(c),o)return!0;if(c.hasChildren()&&(o=c._descendants(s),o))return!0}return!1}toObject(){const s=e.Node.prototype.toObject.call(this);return s.children=[],this.getChildren().forEach(o=>{s.children.push(o.toObject())}),s}isAncestorOf(s){let o=s.getParent();for(;o;){if(o._id===this._id)return!0;o=o.getParent()}return!1}clone(s){const o=e.Node.prototype.clone.call(this,s);return this.getChildren().forEach(function(a){o.add(a.clone())}),o}getAllIntersections(s){const o=[];return this.find("Shape").forEach(a=>{a.isVisible()&&a.intersects(s)&&o.push(a)}),o}_clearSelfAndDescendantCache(s){var o;super._clearSelfAndDescendantCache(s),!this.isCached()&&((o=this.children)===null||o===void 0||o.forEach(function(a){a._clearSelfAndDescendantCache(s)}))}_setChildrenIndices(){var s;(s=this.children)===null||s===void 0||s.forEach(function(o,a){o.index=a}),this._requestDraw()}drawScene(s,o,a){const c=this.getLayer(),h=s||c&&c.getCanvas(),u=h&&h.getContext(),d=this._getCanvasCache(),f=d&&d.scene,A=h&&h.isCache;if(!this.isVisible()&&!A)return this;if(f){u.save();const g=this.getAbsoluteTransform(o).getMatrix();u.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this._drawCachedSceneCanvas(u),u.restore()}else this._drawChildren("drawScene",h,o,a);return this}drawHit(s,o){if(!this.shouldDrawHit(o))return this;const a=this.getLayer(),c=s||a&&a.hitCanvas,h=c&&c.getContext(),u=this._getCanvasCache();if(u&&u.hit){h.save();const f=this.getAbsoluteTransform(o).getMatrix();h.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this._drawCachedHitCanvas(h),h.restore()}else this._drawChildren("drawHit",c,o);return this}_drawChildren(s,o,a,c){var h;const u=o&&o.getContext(),d=this.clipWidth(),f=this.clipHeight(),A=this.clipFunc(),g=typeof d=="number"&&typeof f=="number"||A,p=a===this;if(g){u.save();const v=this.getAbsoluteTransform(a);let m=v.getMatrix();u.transform(m[0],m[1],m[2],m[3],m[4],m[5]),u.beginPath();let w;if(A)w=A.call(this,u,this);else{const x=this.clipX(),T=this.clipY();u.rect(x||0,T||0,d,f)}u.clip.apply(u,w),m=v.copy().invert().getMatrix(),u.transform(m[0],m[1],m[2],m[3],m[4],m[5])}const y=!p&&this.globalCompositeOperation()!=="source-over"&&s==="drawScene";y&&(u.save(),u._applyGlobalCompositeOperation(this)),(h=this.children)===null||h===void 0||h.forEach(function(v){v[s](o,a,c)}),y&&u.restore(),g&&u.restore()}getClientRect(s={}){var o;const a=s.skipTransform,c=s.relativeTo;let h,u,d,f,A={x:1/0,y:1/0,width:0,height:0};const g=this;(o=this.children)===null||o===void 0||o.forEach(function(v){if(!v.visible())return;const m=v.getClientRect({relativeTo:g,skipShadow:s.skipShadow,skipStroke:s.skipStroke});m.width===0&&m.height===0||(h===void 0?(h=m.x,u=m.y,d=m.x+m.width,f=m.y+m.height):(h=Math.min(h,m.x),u=Math.min(u,m.y),d=Math.max(d,m.x+m.width),f=Math.max(f,m.y+m.height)))});const p=this.find("Shape");let y=!1;for(let v=0;v<p.length;v++)if(p[v]._isVisible(this)){y=!0;break}return y&&h!==void 0?A={x:h,y:u,width:d-h,height:f-u}:A={x:0,y:0,width:0,height:0},a?A:this._transformedRect(A,c)}};return J1.Container=i,n.Factory.addComponentsGetterSetter(i,"clip",["x","y","width","height"]),n.Factory.addGetterSetter(i,"clipX",void 0,(0,t.getNumberValidator)()),n.Factory.addGetterSetter(i,"clipY",void 0,(0,t.getNumberValidator)()),n.Factory.addGetterSetter(i,"clipWidth",void 0,(0,t.getNumberValidator)()),n.Factory.addGetterSetter(i,"clipHeight",void 0,(0,t.getNumberValidator)()),n.Factory.addGetterSetter(i,"clipFunc"),J1}var ZT={},af={},xR;function Nq(){if(xR)return af;xR=1,Object.defineProperty(af,"__esModule",{value:!0}),af.getCapturedShape=i,af.createEvent=r,af.hasPointerCapture=s,af.setPointerCapture=o,af.releaseCapture=a;const n=Ur(),e=new Map,t=n.Konva._global.PointerEvent!==void 0;function i(c){return e.get(c)}function r(c){return{evt:c,pointerId:c.pointerId}}function s(c,h){return e.get(c)===h}function o(c,h){a(c),h.getStage()&&(e.set(c,h),t&&h._fire("gotpointercapture",r(new PointerEvent("gotpointercapture"))))}function a(c,h){const u=e.get(c);if(!u)return;const d=u.getStage();d&&d.content,e.delete(c),t&&u._fire("lostpointercapture",r(new PointerEvent("lostpointercapture")))}return af}var bR;function bze(){return bR||(bR=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Stage=n.stages=void 0;const e=Zo(),t=zr(),i=pS(),r=Ur(),s=fS(),o=A8(),a=Ur(),c=Nq(),h="Stage",u="string",d="px",f="mouseout",A="mouseleave",g="mouseover",p="mouseenter",y="mousemove",v="mousedown",m="mouseup",w="pointermove",x="pointerdown",T="pointerup",j="pointercancel",D="lostpointercapture",b="pointerout",_="pointerleave",I="pointerover",S="pointerenter",F="contextmenu",B="touchstart",E="touchend",V="touchmove",K="touchcancel",P="wheel",M=5,X=[[p,"_pointerenter"],[v,"_pointerdown"],[y,"_pointermove"],[m,"_pointerup"],[A,"_pointerleave"],[B,"_pointerdown"],[V,"_pointermove"],[E,"_pointerup"],[K,"_pointercancel"],[g,"_pointerover"],[P,"_wheel"],[F,"_contextmenu"],[x,"_pointerdown"],[w,"_pointermove"],[T,"_pointerup"],[j,"_pointercancel"],[_,"_pointerleave"],[D,"_lostpointercapture"]],Z={mouse:{[b]:f,[_]:A,[I]:g,[S]:p,[w]:y,[x]:v,[T]:m,[j]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[b]:"touchout",[_]:"touchleave",[I]:"touchover",[S]:"touchenter",[w]:V,[x]:B,[T]:E,[j]:K,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[b]:b,[_]:_,[I]:I,[S]:S,[w]:w,[x]:x,[T]:T,[j]:j,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},Q=ie=>ie.indexOf("pointer")>=0?"pointer":ie.indexOf("touch")>=0?"touch":"mouse",U=ie=>{const H=Q(ie);if(H==="pointer")return r.Konva.pointerEventsEnabled&&Z.pointer;if(H==="touch")return Z.touch;if(H==="mouse")return Z.mouse};function z(ie={}){return(ie.clipFunc||ie.clipWidth||ie.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),ie}const q="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";n.stages=[];class G extends i.Container{constructor(H){super(z(H)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),n.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{z(this.attrs)}),this._checkVisibility()}_validateAdd(H){const se=H.getType()==="Layer",te=H.getType()==="FastLayer";se||te||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const H=this.visible()?"":"none";this.content.style.display=H}setContainer(H){if(typeof H===u){let se;if(H.charAt(0)==="."){const te=H.slice(1);H=document.getElementsByClassName(te)[0]}else H.charAt(0)!=="#"?se=H:se=H.slice(1),H=document.getElementById(se);if(!H)throw"Can not find container in document with id "+se}return this._setAttr("container",H),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),H.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const H=this.children,se=H.length;for(let te=0;te<se;te++)H[te].clear();return this}clone(H){return H||(H={}),H.container=typeof document<"u"&&document.createElement("div"),i.Container.prototype.clone.call(this,H)}destroy(){super.destroy();const H=this.content;H&&e.Util._isInDocument(H)&&this.container().removeChild(H);const se=n.stages.indexOf(this);return se>-1&&n.stages.splice(se,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const H=this._pointerPositions[0]||this._changedPointerPositions[0];return H?{x:H.x,y:H.y}:(e.Util.warn(q),null)}_getPointerById(H){return this._pointerPositions.find(se=>se.id===H)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(H){H=H||{},H.x=H.x||0,H.y=H.y||0,H.width=H.width||this.width(),H.height=H.height||this.height();const se=new s.SceneCanvas({width:H.width,height:H.height,pixelRatio:H.pixelRatio||1}),te=se.getContext()._context,fe=this.children;return(H.x||H.y)&&te.translate(-1*H.x,-1*H.y),fe.forEach(function(ye){if(!ye.isVisible())return;const be=ye._toKonvaCanvas(H);te.drawImage(be._canvas,H.x,H.y,be.getWidth()/be.getPixelRatio(),be.getHeight()/be.getPixelRatio())}),se}getIntersection(H){if(!H)return null;const se=this.children,te=se.length,fe=te-1;for(let ye=fe;ye>=0;ye--){const be=se[ye].getIntersection(H);if(be)return be}return null}_resizeDOM(){const H=this.width(),se=this.height();this.content&&(this.content.style.width=H+d,this.content.style.height=se+d),this.bufferCanvas.setSize(H,se),this.bufferHitCanvas.setSize(H,se),this.children.forEach(te=>{te.setSize({width:H,height:se}),te.draw()})}add(H,...se){if(arguments.length>1){for(let fe=0;fe<arguments.length;fe++)this.add(arguments[fe]);return this}super.add(H);const te=this.children.length;return te>M&&e.Util.warn("The stage has "+te+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),H.setSize({width:this.width(),height:this.height()}),H.draw(),r.Konva.isBrowser&&this.content.appendChild(H.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(H){return c.hasPointerCapture(H,this)}setPointerCapture(H){c.setPointerCapture(H,this)}releaseCapture(H){c.releaseCapture(H,this)}getLayers(){return this.children}_bindContentEvents(){r.Konva.isBrowser&&X.forEach(([H,se])=>{this.content.addEventListener(H,te=>{this[se](te)},{passive:!1})})}_pointerenter(H){this.setPointersPositions(H);const se=U(H.type);se&&this._fire(se.pointerenter,{evt:H,target:this,currentTarget:this})}_pointerover(H){this.setPointersPositions(H);const se=U(H.type);se&&this._fire(se.pointerover,{evt:H,target:this,currentTarget:this})}_getTargetShape(H){let se=this[H+"targetShape"];return se&&!se.getStage()&&(se=null),se}_pointerleave(H){const se=U(H.type),te=Q(H.type);if(!se)return;this.setPointersPositions(H);const fe=this._getTargetShape(te),ye=!(r.Konva.isDragging()||r.Konva.isTransforming())||r.Konva.hitOnDragEnabled;fe&&ye?(fe._fireAndBubble(se.pointerout,{evt:H}),fe._fireAndBubble(se.pointerleave,{evt:H}),this._fire(se.pointerleave,{evt:H,target:this,currentTarget:this}),this[te+"targetShape"]=null):ye&&(this._fire(se.pointerleave,{evt:H,target:this,currentTarget:this}),this._fire(se.pointerout,{evt:H,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(H){const se=U(H.type),te=Q(H.type);if(!se)return;this.setPointersPositions(H);let fe=!1;this._changedPointerPositions.forEach(ye=>{const be=this.getIntersection(ye);if(o.DD.justDragged=!1,r.Konva["_"+te+"ListenClick"]=!0,!be||!be.isListening()){this[te+"ClickStartShape"]=void 0;return}r.Konva.capturePointerEventsEnabled&&be.setPointerCapture(ye.id),this[te+"ClickStartShape"]=be,be._fireAndBubble(se.pointerdown,{evt:H,pointerId:ye.id}),fe=!0;const _e=H.type.indexOf("touch")>=0;be.preventDefault()&&H.cancelable&&_e&&H.preventDefault()}),fe||this._fire(se.pointerdown,{evt:H,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(H){const se=U(H.type),te=Q(H.type);if(!se||(r.Konva.isDragging()&&o.DD.node.preventDefault()&&H.cancelable&&H.preventDefault(),this.setPointersPositions(H),!(!(r.Konva.isDragging()||r.Konva.isTransforming())||r.Konva.hitOnDragEnabled)))return;const ye={};let be=!1;const _e=this._getTargetShape(te);this._changedPointerPositions.forEach(W=>{const Y=c.getCapturedShape(W.id)||this.getIntersection(W),ve=W.id,ce={evt:H,pointerId:ve},ne=_e!==Y;if(ne&&_e&&(_e._fireAndBubble(se.pointerout,{...ce},Y),_e._fireAndBubble(se.pointerleave,{...ce},Y)),Y){if(ye[Y._id])return;ye[Y._id]=!0}Y&&Y.isListening()?(be=!0,ne&&(Y._fireAndBubble(se.pointerover,{...ce},_e),Y._fireAndBubble(se.pointerenter,{...ce},_e),this[te+"targetShape"]=Y),Y._fireAndBubble(se.pointermove,{...ce})):_e&&(this._fire(se.pointerover,{evt:H,target:this,currentTarget:this,pointerId:ve}),this[te+"targetShape"]=null)}),be||this._fire(se.pointermove,{evt:H,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(H){const se=U(H.type),te=Q(H.type);if(!se)return;this.setPointersPositions(H);const fe=this[te+"ClickStartShape"],ye=this[te+"ClickEndShape"],be={};let _e=!1;this._changedPointerPositions.forEach(W=>{const Y=c.getCapturedShape(W.id)||this.getIntersection(W);if(Y){if(Y.releaseCapture(W.id),be[Y._id])return;be[Y._id]=!0}const ve=W.id,ce={evt:H,pointerId:ve};let ne=!1;r.Konva["_"+te+"InDblClickWindow"]?(ne=!0,clearTimeout(this[te+"DblTimeout"])):o.DD.justDragged||(r.Konva["_"+te+"InDblClickWindow"]=!0,clearTimeout(this[te+"DblTimeout"])),this[te+"DblTimeout"]=setTimeout(function(){r.Konva["_"+te+"InDblClickWindow"]=!1},r.Konva.dblClickWindow),Y&&Y.isListening()?(_e=!0,this[te+"ClickEndShape"]=Y,Y._fireAndBubble(se.pointerup,{...ce}),r.Konva["_"+te+"ListenClick"]&&fe&&fe===Y&&(Y._fireAndBubble(se.pointerclick,{...ce}),ne&&ye&&ye===Y&&Y._fireAndBubble(se.pointerdblclick,{...ce}))):(this[te+"ClickEndShape"]=null,r.Konva["_"+te+"ListenClick"]&&this._fire(se.pointerclick,{evt:H,target:this,currentTarget:this,pointerId:ve}),ne&&this._fire(se.pointerdblclick,{evt:H,target:this,currentTarget:this,pointerId:ve}))}),_e||this._fire(se.pointerup,{evt:H,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),r.Konva["_"+te+"ListenClick"]=!1,H.cancelable&&te!=="touch"&&te!=="pointer"&&H.preventDefault()}_contextmenu(H){this.setPointersPositions(H);const se=this.getIntersection(this.getPointerPosition());se&&se.isListening()?se._fireAndBubble(F,{evt:H}):this._fire(F,{evt:H,target:this,currentTarget:this})}_wheel(H){this.setPointersPositions(H);const se=this.getIntersection(this.getPointerPosition());se&&se.isListening()?se._fireAndBubble(P,{evt:H}):this._fire(P,{evt:H,target:this,currentTarget:this})}_pointercancel(H){this.setPointersPositions(H);const se=c.getCapturedShape(H.pointerId)||this.getIntersection(this.getPointerPosition());se&&se._fireAndBubble(T,c.createEvent(H)),c.releaseCapture(H.pointerId)}_lostpointercapture(H){c.releaseCapture(H.pointerId)}setPointersPositions(H){const se=this._getContentPosition();let te=null,fe=null;H=H||window.event,H.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(H.touches,ye=>{this._pointerPositions.push({id:ye.identifier,x:(ye.clientX-se.left)/se.scaleX,y:(ye.clientY-se.top)/se.scaleY})}),Array.prototype.forEach.call(H.changedTouches||H.touches,ye=>{this._changedPointerPositions.push({id:ye.identifier,x:(ye.clientX-se.left)/se.scaleX,y:(ye.clientY-se.top)/se.scaleY})})):(te=(H.clientX-se.left)/se.scaleX,fe=(H.clientY-se.top)/se.scaleY,this.pointerPos={x:te,y:fe},this._pointerPositions=[{x:te,y:fe,id:e.Util._getFirstPointerId(H)}],this._changedPointerPositions=[{x:te,y:fe,id:e.Util._getFirstPointerId(H)}])}_setPointerPosition(H){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(H)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const H=this.content.getBoundingClientRect();return{top:H.top,left:H.left,scaleX:H.width/this.content.clientWidth||1,scaleY:H.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new s.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new s.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!r.Konva.isBrowser)return;const H=this.container();if(!H)throw"Stage has no container. A container is required.";H.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),H.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(H){H.batchDraw()}),this}}n.Stage=G,G.prototype.nodeType=h,(0,a._registerNode)(G),t.Factory.addGetterSetter(G,"container"),r.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{n.stages.forEach(ie=>{ie.batchDraw()})})})(ZT)),ZT}var e2={},JT={},_R;function dl(){return _R||(_R=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Shape=n.shapes=void 0;const e=Ur(),t=Zo(),i=zr(),r=ga(),s=Jr(),o=Ur(),a=Nq(),c="hasShadow",h="shadowRGBA",u="patternImage",d="linearGradient",f="radialGradient";let A;function g(){return A||(A=t.Util.createCanvasElement().getContext("2d"),A)}n.shapes={};function p(_){const I=this.attrs.fillRule;I?_.fill(I):_.fill()}function y(_){_.stroke()}function v(_){const I=this.attrs.fillRule;I?_.fill(I):_.fill()}function m(_){_.stroke()}function w(){this._clearCache(c)}function x(){this._clearCache(h)}function T(){this._clearCache(u)}function j(){this._clearCache(d)}function D(){this._clearCache(f)}class b extends r.Node{constructor(I){super(I);let S;for(;S=t.Util.getRandomColor(),!(S&&!(S in n.shapes)););this.colorKey=S,n.shapes[S]=this}getContext(){return t.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return t.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(c,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(u,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const S=g().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(S&&S.setTransform){const F=new t.Transform;F.translate(this.fillPatternX(),this.fillPatternY()),F.rotate(e.Konva.getAngle(this.fillPatternRotation())),F.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),F.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const B=F.getMatrix(),E=typeof DOMMatrix>"u"?{a:B[0],b:B[1],c:B[2],d:B[3],e:B[4],f:B[5]}:new DOMMatrix(B);S.setTransform(E)}return S}}_getLinearGradient(){return this._getCache(d,this.__getLinearGradient)}__getLinearGradient(){const I=this.fillLinearGradientColorStops();if(I){const S=g(),F=this.fillLinearGradientStartPoint(),B=this.fillLinearGradientEndPoint(),E=S.createLinearGradient(F.x,F.y,B.x,B.y);for(let V=0;V<I.length;V+=2)E.addColorStop(I[V],I[V+1]);return E}}_getRadialGradient(){return this._getCache(f,this.__getRadialGradient)}__getRadialGradient(){const I=this.fillRadialGradientColorStops();if(I){const S=g(),F=this.fillRadialGradientStartPoint(),B=this.fillRadialGradientEndPoint(),E=S.createRadialGradient(F.x,F.y,this.fillRadialGradientStartRadius(),B.x,B.y,this.fillRadialGradientEndRadius());for(let V=0;V<I.length;V+=2)E.addColorStop(I[V],I[V+1]);return E}}getShadowRGBA(){return this._getCache(h,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const I=t.Util.colorToRGBA(this.shadowColor());if(I)return"rgba("+I.r+","+I.g+","+I.b+","+I.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const I=this.hitStrokeWidth();return I==="auto"?this.hasStroke():this.strokeEnabled()&&!!I}intersects(I){const S=this.getStage();if(!S)return!1;const F=S.bufferHitCanvas;return F.getContext().clear(),this.drawHit(F,void 0,!0),F.context.getImageData(Math.round(I.x),Math.round(I.y),1,1).data[3]>0}destroy(){return r.Node.prototype.destroy.call(this),delete n.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(I){var S;if(!((S=this.attrs.perfectDrawEnabled)!==null&&S!==void 0?S:!0))return!1;const B=I||this.hasFill(),E=this.hasStroke(),V=this.getAbsoluteOpacity()!==1;if(B&&E&&V)return!0;const K=this.hasShadow(),P=this.shadowForStrokeEnabled();return!!(B&&E&&K&&P)}setStrokeHitEnabled(I){t.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),I?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const I=this.size();return{x:this._centroid?-I.width/2:0,y:this._centroid?-I.height/2:0,width:I.width,height:I.height}}getClientRect(I={}){let S=!1,F=this.getParent();for(;F;){if(F.isCached()){S=!0;break}F=F.getParent()}const B=I.skipTransform,E=I.relativeTo||S&&this.getStage()||void 0,V=this.getSelfRect(),P=!I.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,M=V.width+P,X=V.height+P,Z=!I.skipShadow&&this.hasShadow(),Q=Z?this.shadowOffsetX():0,U=Z?this.shadowOffsetY():0,z=M+Math.abs(Q),q=X+Math.abs(U),G=Z&&this.shadowBlur()||0,ie=z+G*2,H=q+G*2,se={width:ie,height:H,x:-(P/2+G)+Math.min(Q,0)+V.x,y:-(P/2+G)+Math.min(U,0)+V.y};return B?se:this._transformedRect(se,E)}drawScene(I,S,F){const B=this.getLayer(),E=I||B.getCanvas(),V=E.getContext(),K=this._getCanvasCache(),P=this.getSceneFunc(),M=this.hasShadow();let X;const Z=S===this;if(!this.isVisible()&&!Z)return this;if(K){V.save();const Q=this.getAbsoluteTransform(S).getMatrix();return V.transform(Q[0],Q[1],Q[2],Q[3],Q[4],Q[5]),this._drawCachedSceneCanvas(V),V.restore(),this}if(!P)return this;if(V.save(),this._useBufferCanvas()){X=this.getStage();const Q=F||X.bufferCanvas,U=Q.getContext();U.clear(),U.save(),U._applyLineJoin(this);const z=this.getAbsoluteTransform(S).getMatrix();U.transform(z[0],z[1],z[2],z[3],z[4],z[5]),P.call(this,U,this),U.restore();const q=Q.pixelRatio;M&&V._applyShadow(this),V._applyOpacity(this),V._applyGlobalCompositeOperation(this),V.drawImage(Q._canvas,Q.x||0,Q.y||0,Q.width/q,Q.height/q)}else{if(V._applyLineJoin(this),!Z){const Q=this.getAbsoluteTransform(S).getMatrix();V.transform(Q[0],Q[1],Q[2],Q[3],Q[4],Q[5]),V._applyOpacity(this),V._applyGlobalCompositeOperation(this)}M&&V._applyShadow(this),P.call(this,V,this)}return V.restore(),this}drawHit(I,S,F=!1){if(!this.shouldDrawHit(S,F))return this;const B=this.getLayer(),E=I||B.hitCanvas,V=E&&E.getContext(),K=this.hitFunc()||this.sceneFunc(),P=this._getCanvasCache(),M=P&&P.hit;if(this.colorKey||t.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),M){V.save();const Z=this.getAbsoluteTransform(S).getMatrix();return V.transform(Z[0],Z[1],Z[2],Z[3],Z[4],Z[5]),this._drawCachedHitCanvas(V),V.restore(),this}if(!K)return this;if(V.save(),V._applyLineJoin(this),!(this===S)){const Z=this.getAbsoluteTransform(S).getMatrix();V.transform(Z[0],Z[1],Z[2],Z[3],Z[4],Z[5])}return K.call(this,V,this),V.restore(),this}drawHitFromCache(I=0){const S=this._getCanvasCache(),F=this._getCachedSceneCanvas(),B=S.hit,E=B.getContext(),V=B.getWidth(),K=B.getHeight();E.clear(),E.drawImage(F._canvas,0,0,V,K);try{const P=E.getImageData(0,0,V,K),M=P.data,X=M.length,Z=t.Util._hexToRgb(this.colorKey);for(let Q=0;Q<X;Q+=4)M[Q+3]>I?(M[Q]=Z.r,M[Q+1]=Z.g,M[Q+2]=Z.b,M[Q+3]=255):M[Q+3]=0;E.putImageData(P,0,0)}catch(P){t.Util.error("Unable to draw hit graph from cached scene canvas. "+P.message)}return this}hasPointerCapture(I){return a.hasPointerCapture(I,this)}setPointerCapture(I){a.setPointerCapture(I,this)}releaseCapture(I){a.releaseCapture(I,this)}}n.Shape=b,b.prototype._fillFunc=p,b.prototype._strokeFunc=y,b.prototype._fillFuncHit=v,b.prototype._strokeFuncHit=m,b.prototype._centroid=!1,b.prototype.nodeType="Shape",(0,o._registerNode)(b),b.prototype.eventListeners={},b.prototype.on.call(b.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",w),b.prototype.on.call(b.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",x),b.prototype.on.call(b.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",T),b.prototype.on.call(b.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",j),b.prototype.on.call(b.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",D),i.Factory.addGetterSetter(b,"stroke",void 0,(0,s.getStringOrGradientValidator)()),i.Factory.addGetterSetter(b,"strokeWidth",2,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"fillAfterStrokeEnabled",!1),i.Factory.addGetterSetter(b,"hitStrokeWidth","auto",(0,s.getNumberOrAutoValidator)()),i.Factory.addGetterSetter(b,"strokeHitEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(b,"perfectDrawEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(b,"shadowForStrokeEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(b,"lineJoin"),i.Factory.addGetterSetter(b,"lineCap"),i.Factory.addGetterSetter(b,"sceneFunc"),i.Factory.addGetterSetter(b,"hitFunc"),i.Factory.addGetterSetter(b,"dash"),i.Factory.addGetterSetter(b,"dashOffset",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"shadowColor",void 0,(0,s.getStringValidator)()),i.Factory.addGetterSetter(b,"shadowBlur",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"shadowOpacity",1,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(b,"shadowOffset",["x","y"]),i.Factory.addGetterSetter(b,"shadowOffsetX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"shadowOffsetY",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"fillPatternImage"),i.Factory.addGetterSetter(b,"fill",void 0,(0,s.getStringOrGradientValidator)()),i.Factory.addGetterSetter(b,"fillPatternX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"fillPatternY",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"fillLinearGradientColorStops"),i.Factory.addGetterSetter(b,"strokeLinearGradientColorStops"),i.Factory.addGetterSetter(b,"fillRadialGradientStartRadius",0),i.Factory.addGetterSetter(b,"fillRadialGradientEndRadius",0),i.Factory.addGetterSetter(b,"fillRadialGradientColorStops"),i.Factory.addGetterSetter(b,"fillPatternRepeat","repeat"),i.Factory.addGetterSetter(b,"fillEnabled",!0),i.Factory.addGetterSetter(b,"strokeEnabled",!0),i.Factory.addGetterSetter(b,"shadowEnabled",!0),i.Factory.addGetterSetter(b,"dashEnabled",!0),i.Factory.addGetterSetter(b,"strokeScaleEnabled",!0),i.Factory.addGetterSetter(b,"fillPriority","color"),i.Factory.addComponentsGetterSetter(b,"fillPatternOffset",["x","y"]),i.Factory.addGetterSetter(b,"fillPatternOffsetX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"fillPatternOffsetY",0,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(b,"fillPatternScale",["x","y"]),i.Factory.addGetterSetter(b,"fillPatternScaleX",1,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(b,"fillPatternScaleY",1,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(b,"fillLinearGradientStartPoint",["x","y"]),i.Factory.addComponentsGetterSetter(b,"strokeLinearGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(b,"fillLinearGradientStartPointX",0),i.Factory.addGetterSetter(b,"strokeLinearGradientStartPointX",0),i.Factory.addGetterSetter(b,"fillLinearGradientStartPointY",0),i.Factory.addGetterSetter(b,"strokeLinearGradientStartPointY",0),i.Factory.addComponentsGetterSetter(b,"fillLinearGradientEndPoint",["x","y"]),i.Factory.addComponentsGetterSetter(b,"strokeLinearGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(b,"fillLinearGradientEndPointX",0),i.Factory.addGetterSetter(b,"strokeLinearGradientEndPointX",0),i.Factory.addGetterSetter(b,"fillLinearGradientEndPointY",0),i.Factory.addGetterSetter(b,"strokeLinearGradientEndPointY",0),i.Factory.addComponentsGetterSetter(b,"fillRadialGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(b,"fillRadialGradientStartPointX",0),i.Factory.addGetterSetter(b,"fillRadialGradientStartPointY",0),i.Factory.addComponentsGetterSetter(b,"fillRadialGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(b,"fillRadialGradientEndPointX",0),i.Factory.addGetterSetter(b,"fillRadialGradientEndPointY",0),i.Factory.addGetterSetter(b,"fillPatternRotation",0),i.Factory.addGetterSetter(b,"fillRule",void 0,(0,s.getStringValidator)()),i.Factory.backCompat(b,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(JT)),JT}var CR;function Lq(){if(CR)return e2;CR=1,Object.defineProperty(e2,"__esModule",{value:!0}),e2.Layer=void 0;const n=Zo(),e=pS(),t=ga(),i=zr(),r=fS(),s=Jr(),o=dl(),a=Ur(),c="#",h="beforeDraw",u="draw",d=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],f=d.length;class A extends e.Container{constructor(p){super(p),this.canvas=new r.SceneCanvas,this.hitCanvas=new r.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(p){return this.getContext().clear(p),this.getHitCanvas().getContext().clear(p),this}setZIndex(p){super.setZIndex(p);const y=this.getStage();return y&&y.content&&(y.content.removeChild(this.getNativeCanvasElement()),p<y.children.length-1?y.content.insertBefore(this.getNativeCanvasElement(),y.children[p+1].getCanvas()._canvas):y.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){t.Node.prototype.moveToTop.call(this);const p=this.getStage();return p&&p.content&&(p.content.removeChild(this.getNativeCanvasElement()),p.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!t.Node.prototype.moveUp.call(this))return!1;const y=this.getStage();return!y||!y.content?!1:(y.content.removeChild(this.getNativeCanvasElement()),this.index<y.children.length-1?y.content.insertBefore(this.getNativeCanvasElement(),y.children[this.index+1].getCanvas()._canvas):y.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(t.Node.prototype.moveDown.call(this)){const p=this.getStage();if(p){const y=p.children;p.content&&(p.content.removeChild(this.getNativeCanvasElement()),p.content.insertBefore(this.getNativeCanvasElement(),y[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(t.Node.prototype.moveToBottom.call(this)){const p=this.getStage();if(p){const y=p.children;p.content&&(p.content.removeChild(this.getNativeCanvasElement()),p.content.insertBefore(this.getNativeCanvasElement(),y[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const p=this.getNativeCanvasElement();return t.Node.prototype.remove.call(this),p&&p.parentNode&&n.Util._isInDocument(p)&&p.parentNode.removeChild(p),this}getStage(){return this.parent}setSize({width:p,height:y}){return this.canvas.setSize(p,y),this.hitCanvas.setSize(p,y),this._setSmoothEnabled(),this}_validateAdd(p){const y=p.getType();y!=="Group"&&y!=="Shape"&&n.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(p){return p=p||{},p.width=p.width||this.getWidth(),p.height=p.height||this.getHeight(),p.x=p.x!==void 0?p.x:this.x(),p.y=p.y!==void 0?p.y:this.y(),t.Node.prototype._toKonvaCanvas.call(this,p)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){n.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){n.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,n.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(p){if(!this.isListening()||!this.isVisible())return null;let y=1,v=!1;for(;;){for(let m=0;m<f;m++){const w=d[m],x=this._getIntersection({x:p.x+w.x*y,y:p.y+w.y*y}),T=x.shape;if(T)return T;if(v=!!x.antialiased,!x.antialiased)break}if(v)y+=1;else return null}}_getIntersection(p){const y=this.hitCanvas.pixelRatio,v=this.hitCanvas.context.getImageData(Math.round(p.x*y),Math.round(p.y*y),1,1).data,m=v[3];if(m===255){const w=n.Util._rgbToHex(v[0],v[1],v[2]),x=o.shapes[c+w];return x?{shape:x}:{antialiased:!0}}else if(m>0)return{antialiased:!0};return{}}drawScene(p,y,v){const m=this.getLayer(),w=p||m&&m.getCanvas();return this._fire(h,{node:this}),this.clearBeforeDraw()&&w.getContext().clear(),e.Container.prototype.drawScene.call(this,w,y,v),this._fire(u,{node:this}),this}drawHit(p,y){const v=this.getLayer(),m=p||v&&v.hitCanvas;return v&&v.clearBeforeDraw()&&v.getHitCanvas().getContext().clear(),e.Container.prototype.drawHit.call(this,m,y),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(p){n.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(p)}getHitGraphEnabled(p){return n.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const p=this.parent;!!this.hitCanvas._canvas.parentNode?p.content.removeChild(this.hitCanvas._canvas):p.content.appendChild(this.hitCanvas._canvas)}destroy(){return n.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}return e2.Layer=A,A.prototype.nodeType="Layer",(0,a._registerNode)(A),i.Factory.addGetterSetter(A,"imageSmoothingEnabled",!0),i.Factory.addGetterSetter(A,"clearBeforeDraw",!0),i.Factory.addGetterSetter(A,"hitGraphEnabled",!0,(0,s.getBooleanValidator)()),e2}var t2={},SR;function _ze(){if(SR)return t2;SR=1,Object.defineProperty(t2,"__esModule",{value:!0}),t2.FastLayer=void 0;const n=Zo(),e=Lq(),t=Ur();let i=class extends e.Layer{constructor(s){super(s),this.listening(!1),n.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};return t2.FastLayer=i,i.prototype.nodeType="FastLayer",(0,t._registerNode)(i),t2}var n2={},TR;function f8(){if(TR)return n2;TR=1,Object.defineProperty(n2,"__esModule",{value:!0}),n2.Group=void 0;const n=Zo(),e=pS(),t=Ur();class i extends e.Container{_validateAdd(s){const o=s.getType();o!=="Group"&&o!=="Shape"&&n.Util.throw("You may only add groups and shapes to groups.")}}return n2.Group=i,i.prototype.nodeType="Group",(0,t._registerNode)(i),n2}var i2={},BR;function p8(){if(BR)return i2;BR=1,Object.defineProperty(i2,"__esModule",{value:!0}),i2.Animation=void 0;const n=Ur(),e=Zo(),t=(function(){return n.glob.performance&&n.glob.performance.now?function(){return n.glob.performance.now()}:function(){return new Date().getTime()}})();let i=class j0{constructor(s,o){this.id=j0.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:t(),frameRate:0},this.func=s,this.setLayers(o)}setLayers(s){let o=[];return s&&(o=Array.isArray(s)?s:[s]),this.layers=o,this}getLayers(){return this.layers}addLayer(s){const o=this.layers,a=o.length;for(let c=0;c<a;c++)if(o[c]._id===s._id)return!1;return this.layers.push(s),!0}isRunning(){const o=j0.animations,a=o.length;for(let c=0;c<a;c++)if(o[c].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=t(),j0._addAnimation(this),this}stop(){return j0._removeAnimation(this),this}_updateFrameObject(s){this.frame.timeDiff=s-this.frame.lastTime,this.frame.lastTime=s,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(s){this.animations.push(s),this._handleAnimation()}static _removeAnimation(s){const o=s.id,a=this.animations,c=a.length;for(let h=0;h<c;h++)if(a[h].id===o){this.animations.splice(h,1);break}}static _runFrames(){const s={},o=this.animations;for(let a=0;a<o.length;a++){const c=o[a],h=c.layers,u=c.func;c._updateFrameObject(t());const d=h.length;let f;if(u?f=u.call(c,c.frame)!==!1:f=!0,!!f)for(let A=0;A<d;A++){const g=h[A];g._id!==void 0&&(s[g._id]=g)}}for(const a in s)s.hasOwnProperty(a)&&s[a].batchDraw()}static _animationLoop(){const s=j0;s.animations.length?(s._runFrames(),e.Util.requestAnimFrame(s._animationLoop)):s.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,e.Util.requestAnimFrame(this._animationLoop))}};return i2.Animation=i,i.animations=[],i.animIdCounter=0,i.animRunning=!1,i2}var eB={},ER;function Cze(){return ER||(ER=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Easings=n.Tween=void 0;const e=Zo(),t=p8(),i=ga(),r=Ur(),s={node:1,duration:1,easing:1,onFinish:1,yoyo:1},o=1,a=2,c=3,h=["fill","stroke","shadowColor"];let u=0;class d{constructor(g,p,y,v,m,w,x){this.prop=g,this.propFunc=p,this.begin=v,this._pos=v,this.duration=w,this._change=0,this.prevPos=0,this.yoyo=x,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=y,this._change=m-this.begin,this.pause()}fire(g){const p=this[g];p&&p()}setTime(g){g>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():g<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=g,this.update())}getTime(){return this._time}setPosition(g){this.prevPos=this._pos,this.propFunc(g),this._pos=g}getPosition(g){return g===void 0&&(g=this._time),this.func(g,this.begin,this._change,this.duration)}play(){this.state=a,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=c,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(g){this.pause(),this._time=g,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const g=this.getTimer()-this._startTime;this.state===a?this.setTime(g):this.state===c&&this.setTime(this.duration-g)}pause(){this.state=o,this.fire("onPause")}getTimer(){return new Date().getTime()}}class f{constructor(g){const p=this,y=g.node,v=y._id,m=g.easing||n.Easings.Linear,w=!!g.yoyo;let x,T;typeof g.duration>"u"?x=.3:g.duration===0?x=.001:x=g.duration,this.node=y,this._id=u++;const j=y.getLayer()||(y instanceof r.Konva.Stage?y.getLayers():null);j||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new t.Animation(function(){p.tween.onEnterFrame()},j),this.tween=new d(T,function(D){p._tweenFunc(D)},m,0,1,x*1e3,w),this._addListeners(),f.attrs[v]||(f.attrs[v]={}),f.attrs[v][this._id]||(f.attrs[v][this._id]={}),f.tweens[v]||(f.tweens[v]={});for(T in g)s[T]===void 0&&this._addAttr(T,g[T]);this.reset(),this.onFinish=g.onFinish,this.onReset=g.onReset,this.onUpdate=g.onUpdate}_addAttr(g,p){const y=this.node,v=y._id;let m,w,x,T,j;const D=f.tweens[v][g];D&&delete f.attrs[v][D][g];let b=y.getAttr(g);if(e.Util._isArray(p))if(m=[],w=Math.max(p.length,b.length),g==="points"&&p.length!==b.length&&(p.length>b.length?(T=b,b=e.Util._prepareArrayForTween(b,p,y.closed())):(x=p,p=e.Util._prepareArrayForTween(p,b,y.closed()))),g.indexOf("fill")===0)for(let _=0;_<w;_++)if(_%2===0)m.push(p[_]-b[_]);else{const I=e.Util.colorToRGBA(b[_]);j=e.Util.colorToRGBA(p[_]),b[_]=I,m.push({r:j.r-I.r,g:j.g-I.g,b:j.b-I.b,a:j.a-I.a})}else for(let _=0;_<w;_++)m.push(p[_]-b[_]);else h.indexOf(g)!==-1?(b=e.Util.colorToRGBA(b),j=e.Util.colorToRGBA(p),m={r:j.r-b.r,g:j.g-b.g,b:j.b-b.b,a:j.a-b.a}):m=p-b;f.attrs[v][this._id][g]={start:b,diff:m,end:p,trueEnd:x,trueStart:T},f.tweens[v][g]=this._id}_tweenFunc(g){const p=this.node,y=f.attrs[p._id][this._id];let v,m,w,x,T,j,D,b;for(v in y){if(m=y[v],w=m.start,x=m.diff,b=m.end,e.Util._isArray(w))if(T=[],D=Math.max(w.length,b.length),v.indexOf("fill")===0)for(j=0;j<D;j++)j%2===0?T.push((w[j]||0)+x[j]*g):T.push("rgba("+Math.round(w[j].r+x[j].r*g)+","+Math.round(w[j].g+x[j].g*g)+","+Math.round(w[j].b+x[j].b*g)+","+(w[j].a+x[j].a*g)+")");else for(j=0;j<D;j++)T.push((w[j]||0)+x[j]*g);else h.indexOf(v)!==-1?T="rgba("+Math.round(w.r+x.r*g)+","+Math.round(w.g+x.g*g)+","+Math.round(w.b+x.b*g)+","+(w.a+x.a*g)+")":T=w+x*g;p.setAttr(v,T)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const g=this.node,p=f.attrs[g._id][this._id];p.points&&p.points.trueEnd&&g.setAttr("points",p.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const g=this.node,p=f.attrs[g._id][this._id];p.points&&p.points.trueStart&&g.points(p.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(g){return this.tween.seek(g*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const g=this.node._id,p=this._id,y=f.tweens[g];this.pause(),this.anim&&this.anim.stop();for(const v in y)delete f.tweens[g][v];delete f.attrs[g][p],f.tweens[g]&&(Object.keys(f.tweens[g]).length===0&&delete f.tweens[g],Object.keys(f.attrs[g]).length===0&&delete f.attrs[g])}}n.Tween=f,f.attrs={},f.tweens={},i.Node.prototype.to=function(A){const g=A.onFinish;A.node=this,A.onFinish=function(){this.destroy(),g&&g()},new f(A).play()},n.Easings={BackEaseIn(A,g,p,y){return p*(A/=y)*A*((1.70158+1)*A-1.70158)+g},BackEaseOut(A,g,p,y){return p*((A=A/y-1)*A*((1.70158+1)*A+1.70158)+1)+g},BackEaseInOut(A,g,p,y){let v=1.70158;return(A/=y/2)<1?p/2*(A*A*(((v*=1.525)+1)*A-v))+g:p/2*((A-=2)*A*(((v*=1.525)+1)*A+v)+2)+g},ElasticEaseIn(A,g,p,y,v,m){let w=0;return A===0?g:(A/=y)===1?g+p:(m||(m=y*.3),!v||v<Math.abs(p)?(v=p,w=m/4):w=m/(2*Math.PI)*Math.asin(p/v),-(v*Math.pow(2,10*(A-=1))*Math.sin((A*y-w)*(2*Math.PI)/m))+g)},ElasticEaseOut(A,g,p,y,v,m){let w=0;return A===0?g:(A/=y)===1?g+p:(m||(m=y*.3),!v||v<Math.abs(p)?(v=p,w=m/4):w=m/(2*Math.PI)*Math.asin(p/v),v*Math.pow(2,-10*A)*Math.sin((A*y-w)*(2*Math.PI)/m)+p+g)},ElasticEaseInOut(A,g,p,y,v,m){let w=0;return A===0?g:(A/=y/2)===2?g+p:(m||(m=y*(.3*1.5)),!v||v<Math.abs(p)?(v=p,w=m/4):w=m/(2*Math.PI)*Math.asin(p/v),A<1?-.5*(v*Math.pow(2,10*(A-=1))*Math.sin((A*y-w)*(2*Math.PI)/m))+g:v*Math.pow(2,-10*(A-=1))*Math.sin((A*y-w)*(2*Math.PI)/m)*.5+p+g)},BounceEaseOut(A,g,p,y){return(A/=y)<1/2.75?p*(7.5625*A*A)+g:A<2/2.75?p*(7.5625*(A-=1.5/2.75)*A+.75)+g:A<2.5/2.75?p*(7.5625*(A-=2.25/2.75)*A+.9375)+g:p*(7.5625*(A-=2.625/2.75)*A+.984375)+g},BounceEaseIn(A,g,p,y){return p-n.Easings.BounceEaseOut(y-A,0,p,y)+g},BounceEaseInOut(A,g,p,y){return A<y/2?n.Easings.BounceEaseIn(A*2,0,p,y)*.5+g:n.Easings.BounceEaseOut(A*2-y,0,p,y)*.5+p*.5+g},EaseIn(A,g,p,y){return p*(A/=y)*A+g},EaseOut(A,g,p,y){return-p*(A/=y)*(A-2)+g},EaseInOut(A,g,p,y){return(A/=y/2)<1?p/2*A*A+g:-p/2*(--A*(A-2)-1)+g},StrongEaseIn(A,g,p,y){return p*(A/=y)*A*A*A*A+g},StrongEaseOut(A,g,p,y){return p*((A=A/y-1)*A*A*A*A+1)+g},StrongEaseInOut(A,g,p,y){return(A/=y/2)<1?p/2*A*A*A*A*A+g:p/2*((A-=2)*A*A*A*A+2)+g},Linear(A,g,p,y){return p*A/y+g}}})(eB)),eB}var kR;function V6(){return kR||(kR=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Konva=void 0;const e=Ur(),t=Zo(),i=ga(),r=pS(),s=bze(),o=Lq(),a=_ze(),c=f8(),h=A8(),u=dl(),d=p8(),f=Cze(),A=Pq(),g=fS();n.Konva=t.Util._assign(e.Konva,{Util:t.Util,Transform:t.Transform,Node:i.Node,Container:r.Container,Stage:s.Stage,stages:s.stages,Layer:o.Layer,FastLayer:a.FastLayer,Group:c.Group,DD:h.DD,Shape:u.Shape,shapes:u.shapes,Animation:d.Animation,Tween:f.Tween,Easings:f.Easings,Context:A.Context,Canvas:g.Canvas}),n.default=n.Konva})(GT)),GT}var r2={},IR;function Sze(){if(IR)return r2;IR=1,Object.defineProperty(r2,"__esModule",{value:!0}),r2.Arc=void 0;const n=zr(),e=dl(),t=Ur(),i=Jr(),r=Ur();let s=class extends e.Shape{_sceneFunc(a){const c=t.Konva.getAngle(this.angle()),h=this.clockwise();a.beginPath(),a.arc(0,0,this.outerRadius(),0,c,h),a.arc(0,0,this.innerRadius(),c,0,!h),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}getSelfRect(){const a=this.innerRadius(),c=this.outerRadius(),h=this.clockwise(),u=t.Konva.getAngle(h?360-this.angle():this.angle()),d=Math.cos(Math.min(u,Math.PI)),f=1,A=Math.sin(Math.min(Math.max(Math.PI,u),3*Math.PI/2)),g=Math.sin(Math.min(u,Math.PI/2)),p=d*(d>0?a:c),y=f*c,v=A*(A>0?a:c),m=g*(g>0?c:a);return{x:p,y:h?-1*m:v,width:y-p,height:m-v}}};return r2.Arc=s,s.prototype._centroid=!0,s.prototype.className="Arc",s.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],(0,r._registerNode)(s),n.Factory.addGetterSetter(s,"innerRadius",0,(0,i.getNumberValidator)()),n.Factory.addGetterSetter(s,"outerRadius",0,(0,i.getNumberValidator)()),n.Factory.addGetterSetter(s,"angle",0,(0,i.getNumberValidator)()),n.Factory.addGetterSetter(s,"clockwise",!1,(0,i.getBooleanValidator)()),r2}var s2={},o2={},FR;function Mq(){if(FR)return o2;FR=1,Object.defineProperty(o2,"__esModule",{value:!0}),o2.Line=void 0;const n=zr(),e=Ur(),t=dl(),i=Jr();function r(a,c,h,u,d,f,A){const g=Math.sqrt(Math.pow(h-a,2)+Math.pow(u-c,2)),p=Math.sqrt(Math.pow(d-h,2)+Math.pow(f-u,2)),y=A*g/(g+p),v=A*p/(g+p),m=h-y*(d-a),w=u-y*(f-c),x=h+v*(d-a),T=u+v*(f-c);return[m,w,x,T]}function s(a,c){const h=a.length,u=[];for(let d=2;d<h-2;d+=2){const f=r(a[d-2],a[d-1],a[d],a[d+1],a[d+2],a[d+3],c);isNaN(f[0])||(u.push(f[0]),u.push(f[1]),u.push(a[d]),u.push(a[d+1]),u.push(f[2]),u.push(f[3]))}return u}class o extends t.Shape{constructor(c){super(c),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(c){const h=this.points(),u=h.length,d=this.tension(),f=this.closed(),A=this.bezier();if(!u)return;let g=0;if(c.beginPath(),c.moveTo(h[0],h[1]),d!==0&&u>4){const p=this.getTensionPoints(),y=p.length;for(g=f?0:4,f||c.quadraticCurveTo(p[0],p[1],p[2],p[3]);g<y-2;)c.bezierCurveTo(p[g++],p[g++],p[g++],p[g++],p[g++],p[g++]);f||c.quadraticCurveTo(p[y-2],p[y-1],h[u-2],h[u-1])}else if(A)for(g=2;g<u;)c.bezierCurveTo(h[g++],h[g++],h[g++],h[g++],h[g++],h[g++]);else for(g=2;g<u;g+=2)c.lineTo(h[g],h[g+1]);f?(c.closePath(),c.fillStrokeShape(this)):c.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():s(this.points(),this.tension())}_getTensionPointsClosed(){const c=this.points(),h=c.length,u=this.tension(),d=r(c[h-2],c[h-1],c[0],c[1],c[2],c[3],u),f=r(c[h-4],c[h-3],c[h-2],c[h-1],c[0],c[1],u),A=s(c,u);return[d[2],d[3]].concat(A).concat([f[0],f[1],c[h-2],c[h-1],f[2],f[3],d[0],d[1],c[0],c[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let c=this.points();if(c.length<4)return{x:c[0]||0,y:c[1]||0,width:0,height:0};this.tension()!==0?c=[c[0],c[1],...this._getTensionPoints(),c[c.length-2],c[c.length-1]]:c=this.points();let h=c[0],u=c[0],d=c[1],f=c[1],A,g;for(let p=0;p<c.length/2;p++)A=c[p*2],g=c[p*2+1],h=Math.min(h,A),u=Math.max(u,A),d=Math.min(d,g),f=Math.max(f,g);return{x:h,y:d,width:u-h,height:f-d}}}return o2.Line=o,o.prototype.className="Line",o.prototype._attrsAffectingSize=["points","bezier","tension"],(0,e._registerNode)(o),n.Factory.addGetterSetter(o,"closed",!1),n.Factory.addGetterSetter(o,"bezier",!1),n.Factory.addGetterSetter(o,"tension",0,(0,i.getNumberValidator)()),n.Factory.addGetterSetter(o,"points",[],(0,i.getNumberArrayValidator)()),o2}var a2={},tB={},DR;function Tze(){return DR||(DR=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.t2length=n.getQuadraticArcLength=n.getCubicArcLength=n.binomialCoefficients=n.cValues=n.tValues=void 0,n.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],n.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],n.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(o,a,c)=>{let h,u;const f=c/2;h=0;for(let A=0;A<20;A++)u=f*n.tValues[20][A]+f,h+=n.cValues[20][A]*i(o,a,u);return f*h};n.getCubicArcLength=e;const t=(o,a,c)=>{c===void 0&&(c=1);const h=o[0]-2*o[1]+o[2],u=a[0]-2*a[1]+a[2],d=2*o[1]-2*o[0],f=2*a[1]-2*a[0],A=4*(h*h+u*u),g=4*(h*d+u*f),p=d*d+f*f;if(A===0)return c*Math.sqrt(Math.pow(o[2]-o[0],2)+Math.pow(a[2]-a[0],2));const y=g/(2*A),v=p/A,m=c+y,w=v-y*y,x=m*m+w>0?Math.sqrt(m*m+w):0,T=y*y+w>0?Math.sqrt(y*y+w):0,j=y+Math.sqrt(y*y+w)!==0?w*Math.log(Math.abs((m+x)/(y+T))):0;return Math.sqrt(A)/2*(m*x-y*T+j)};n.getQuadraticArcLength=t;function i(o,a,c){const h=r(1,c,o),u=r(1,c,a),d=h*h+u*u;return Math.sqrt(d)}const r=(o,a,c)=>{const h=c.length-1;let u,d;if(h===0)return 0;if(o===0){d=0;for(let f=0;f<=h;f++)d+=n.binomialCoefficients[h][f]*Math.pow(1-a,h-f)*Math.pow(a,f)*c[f];return d}else{u=new Array(h);for(let f=0;f<h;f++)u[f]=h*(c[f+1]-c[f]);return r(o-1,a,u)}},s=(o,a,c)=>{let h=1,u=o/a,d=(o-c(u))/a,f=0;for(;h>.001;){const A=c(u+d),g=Math.abs(o-A)/a;if(g<h)h=g,u+=d;else{const p=c(u-d),y=Math.abs(o-p)/a;y<h?(h=y,u-=d):d/=2}if(f++,f>500)break}return u};n.t2length=s})(tB)),tB}var jR;function g8(){if(jR)return a2;jR=1,Object.defineProperty(a2,"__esModule",{value:!0}),a2.Path=void 0;const n=zr(),e=Ur(),t=dl(),i=Tze();let r=class Dc extends t.Shape{constructor(o){super(o),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Dc.parsePathData(this.data()),this.pathLength=Dc.getPathLength(this.dataArray)}_sceneFunc(o){const a=this.dataArray;o.beginPath();let c=!1;for(let h=0;h<a.length;h++){const u=a[h].command,d=a[h].points;switch(u){case"L":o.lineTo(d[0],d[1]);break;case"M":o.moveTo(d[0],d[1]);break;case"C":o.bezierCurveTo(d[0],d[1],d[2],d[3],d[4],d[5]);break;case"Q":o.quadraticCurveTo(d[0],d[1],d[2],d[3]);break;case"A":const f=d[0],A=d[1],g=d[2],p=d[3],y=d[4],v=d[5],m=d[6],w=d[7],x=g>p?g:p,T=g>p?1:g/p,j=g>p?p/g:1;o.translate(f,A),o.rotate(m),o.scale(T,j),o.arc(0,0,x,y,y+v,1-w),o.scale(1/T,1/j),o.rotate(-m),o.translate(-f,-A);break;case"z":c=!0,o.closePath();break}}!c&&!this.hasFill()?o.strokeShape(this):o.fillStrokeShape(this)}getSelfRect(){let o=[];this.dataArray.forEach(function(A){if(A.command==="A"){const g=A.points[4],p=A.points[5],y=A.points[4]+p;let v=Math.PI/180;if(Math.abs(g-y)<v&&(v=Math.abs(g-y)),p<0)for(let m=g-v;m>y;m-=v){const w=Dc.getPointOnEllipticalArc(A.points[0],A.points[1],A.points[2],A.points[3],m,0);o.push(w.x,w.y)}else for(let m=g+v;m<y;m+=v){const w=Dc.getPointOnEllipticalArc(A.points[0],A.points[1],A.points[2],A.points[3],m,0);o.push(w.x,w.y)}}else if(A.command==="C")for(let g=0;g<=1;g+=.01){const p=Dc.getPointOnCubicBezier(g,A.start.x,A.start.y,A.points[0],A.points[1],A.points[2],A.points[3],A.points[4],A.points[5]);o.push(p.x,p.y)}else o=o.concat(A.points)});let a=o[0],c=o[0],h=o[1],u=o[1],d,f;for(let A=0;A<o.length/2;A++)d=o[A*2],f=o[A*2+1],isNaN(d)||(a=Math.min(a,d),c=Math.max(c,d)),isNaN(f)||(h=Math.min(h,f),u=Math.max(u,f));return{x:a,y:h,width:c-a,height:u-h}}getLength(){return this.pathLength}getPointAtLength(o){return Dc.getPointAtLengthOfDataArray(o,this.dataArray)}static getLineLength(o,a,c,h){return Math.sqrt((c-o)*(c-o)+(h-a)*(h-a))}static getPathLength(o){let a=0;for(let c=0;c<o.length;++c)a+=o[c].pathLength;return a}static getPointAtLengthOfDataArray(o,a){let c,h=0,u=a.length;if(!u)return null;for(;h<u&&o>a[h].pathLength;)o-=a[h].pathLength,++h;if(h===u)return c=a[h-1].points.slice(-2),{x:c[0],y:c[1]};if(o<.01)return a[h].command==="M"?(c=a[h].points.slice(0,2),{x:c[0],y:c[1]}):{x:a[h].start.x,y:a[h].start.y};const d=a[h],f=d.points;switch(d.command){case"L":return Dc.getPointOnLine(o,d.start.x,d.start.y,f[0],f[1]);case"C":return Dc.getPointOnCubicBezier((0,i.t2length)(o,Dc.getPathLength(a),x=>(0,i.getCubicArcLength)([d.start.x,f[0],f[2],f[4]],[d.start.y,f[1],f[3],f[5]],x)),d.start.x,d.start.y,f[0],f[1],f[2],f[3],f[4],f[5]);case"Q":return Dc.getPointOnQuadraticBezier((0,i.t2length)(o,Dc.getPathLength(a),x=>(0,i.getQuadraticArcLength)([d.start.x,f[0],f[2]],[d.start.y,f[1],f[3]],x)),d.start.x,d.start.y,f[0],f[1],f[2],f[3]);case"A":const A=f[0],g=f[1],p=f[2],y=f[3],v=f[5],m=f[6];let w=f[4];return w+=v*o/d.pathLength,Dc.getPointOnEllipticalArc(A,g,p,y,w,m)}return null}static getPointOnLine(o,a,c,h,u,d,f){d=d??a,f=f??c;const A=this.getLineLength(a,c,h,u);if(A<1e-10)return{x:a,y:c};if(h===a)return{x:d,y:f+(u>c?o:-o)};const g=(u-c)/(h-a),p=Math.sqrt(o*o/(1+g*g))*(h<a?-1:1),y=g*p;if(Math.abs(f-c-g*(d-a))<1e-10)return{x:d+p,y:f+y};const v=((d-a)*(h-a)+(f-c)*(u-c))/(A*A),m=a+v*(h-a),w=c+v*(u-c),x=this.getLineLength(d,f,m,w),T=Math.sqrt(o*o-x*x),j=Math.sqrt(T*T/(1+g*g))*(h<a?-1:1),D=g*j;return{x:m+j,y:w+D}}static getPointOnCubicBezier(o,a,c,h,u,d,f,A,g){function p(T){return T*T*T}function y(T){return 3*T*T*(1-T)}function v(T){return 3*T*(1-T)*(1-T)}function m(T){return(1-T)*(1-T)*(1-T)}const w=A*p(o)+d*y(o)+h*v(o)+a*m(o),x=g*p(o)+f*y(o)+u*v(o)+c*m(o);return{x:w,y:x}}static getPointOnQuadraticBezier(o,a,c,h,u,d,f){function A(m){return m*m}function g(m){return 2*m*(1-m)}function p(m){return(1-m)*(1-m)}const y=d*A(o)+h*g(o)+a*p(o),v=f*A(o)+u*g(o)+c*p(o);return{x:y,y:v}}static getPointOnEllipticalArc(o,a,c,h,u,d){const f=Math.cos(d),A=Math.sin(d),g={x:c*Math.cos(u),y:h*Math.sin(u)};return{x:o+(g.x*f-g.y*A),y:a+(g.x*A+g.y*f)}}static parsePathData(o){if(!o)return[];let a=o;const c=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];a=a.replace(new RegExp(" ","g"),",");for(let y=0;y<c.length;y++)a=a.replace(new RegExp(c[y],"g"),"|"+c[y]);const h=a.split("|"),u=[],d=[];let f=0,A=0;const g=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let p;for(let y=1;y<h.length;y++){let v=h[y],m=v.charAt(0);for(v=v.slice(1),d.length=0;p=g.exec(v);)d.push(p[0]);const w=[];for(let x=0,T=d.length;x<T;x++){if(d[x]==="00"){w.push(0,0);continue}const j=parseFloat(d[x]);isNaN(j)?w.push(0):w.push(j)}for(;w.length>0&&!isNaN(w[0]);){let x="",T=[];const j=f,D=A;let b,_,I,S,F,B,E,V,K,P;switch(m){case"l":f+=w.shift(),A+=w.shift(),x="L",T.push(f,A);break;case"L":f=w.shift(),A=w.shift(),T.push(f,A);break;case"m":const M=w.shift(),X=w.shift();if(f+=M,A+=X,x="M",u.length>2&&u[u.length-1].command==="z"){for(let Z=u.length-2;Z>=0;Z--)if(u[Z].command==="M"){f=u[Z].points[0]+M,A=u[Z].points[1]+X;break}}T.push(f,A),m="l";break;case"M":f=w.shift(),A=w.shift(),x="M",T.push(f,A),m="L";break;case"h":f+=w.shift(),x="L",T.push(f,A);break;case"H":f=w.shift(),x="L",T.push(f,A);break;case"v":A+=w.shift(),x="L",T.push(f,A);break;case"V":A=w.shift(),x="L",T.push(f,A);break;case"C":T.push(w.shift(),w.shift(),w.shift(),w.shift()),f=w.shift(),A=w.shift(),T.push(f,A);break;case"c":T.push(f+w.shift(),A+w.shift(),f+w.shift(),A+w.shift()),f+=w.shift(),A+=w.shift(),x="C",T.push(f,A);break;case"S":_=f,I=A,b=u[u.length-1],b.command==="C"&&(_=f+(f-b.points[2]),I=A+(A-b.points[3])),T.push(_,I,w.shift(),w.shift()),f=w.shift(),A=w.shift(),x="C",T.push(f,A);break;case"s":_=f,I=A,b=u[u.length-1],b.command==="C"&&(_=f+(f-b.points[2]),I=A+(A-b.points[3])),T.push(_,I,f+w.shift(),A+w.shift()),f+=w.shift(),A+=w.shift(),x="C",T.push(f,A);break;case"Q":T.push(w.shift(),w.shift()),f=w.shift(),A=w.shift(),T.push(f,A);break;case"q":T.push(f+w.shift(),A+w.shift()),f+=w.shift(),A+=w.shift(),x="Q",T.push(f,A);break;case"T":_=f,I=A,b=u[u.length-1],b.command==="Q"&&(_=f+(f-b.points[0]),I=A+(A-b.points[1])),f=w.shift(),A=w.shift(),x="Q",T.push(_,I,f,A);break;case"t":_=f,I=A,b=u[u.length-1],b.command==="Q"&&(_=f+(f-b.points[0]),I=A+(A-b.points[1])),f+=w.shift(),A+=w.shift(),x="Q",T.push(_,I,f,A);break;case"A":S=w.shift(),F=w.shift(),B=w.shift(),E=w.shift(),V=w.shift(),K=f,P=A,f=w.shift(),A=w.shift(),x="A",T=this.convertEndpointToCenterParameterization(K,P,f,A,E,V,S,F,B);break;case"a":S=w.shift(),F=w.shift(),B=w.shift(),E=w.shift(),V=w.shift(),K=f,P=A,f+=w.shift(),A+=w.shift(),x="A",T=this.convertEndpointToCenterParameterization(K,P,f,A,E,V,S,F,B);break}u.push({command:x||m,points:T,start:{x:j,y:D},pathLength:this.calcLength(j,D,x||m,T)})}(m==="z"||m==="Z")&&u.push({command:"z",points:[],start:void 0,pathLength:0})}return u}static calcLength(o,a,c,h){let u,d,f,A;const g=Dc;switch(c){case"L":return g.getLineLength(o,a,h[0],h[1]);case"C":return(0,i.getCubicArcLength)([o,h[0],h[2],h[4]],[a,h[1],h[3],h[5]],1);case"Q":return(0,i.getQuadraticArcLength)([o,h[0],h[2]],[a,h[1],h[3]],1);case"A":u=0;const p=h[4],y=h[5],v=h[4]+y;let m=Math.PI/180;if(Math.abs(p-v)<m&&(m=Math.abs(p-v)),d=g.getPointOnEllipticalArc(h[0],h[1],h[2],h[3],p,0),y<0)for(A=p-m;A>v;A-=m)f=g.getPointOnEllipticalArc(h[0],h[1],h[2],h[3],A,0),u+=g.getLineLength(d.x,d.y,f.x,f.y),d=f;else for(A=p+m;A<v;A+=m)f=g.getPointOnEllipticalArc(h[0],h[1],h[2],h[3],A,0),u+=g.getLineLength(d.x,d.y,f.x,f.y),d=f;return f=g.getPointOnEllipticalArc(h[0],h[1],h[2],h[3],v,0),u+=g.getLineLength(d.x,d.y,f.x,f.y),u}return 0}static convertEndpointToCenterParameterization(o,a,c,h,u,d,f,A,g){const p=g*(Math.PI/180),y=Math.cos(p)*(o-c)/2+Math.sin(p)*(a-h)/2,v=-1*Math.sin(p)*(o-c)/2+Math.cos(p)*(a-h)/2,m=y*y/(f*f)+v*v/(A*A);m>1&&(f*=Math.sqrt(m),A*=Math.sqrt(m));let w=Math.sqrt((f*f*(A*A)-f*f*(v*v)-A*A*(y*y))/(f*f*(v*v)+A*A*(y*y)));u===d&&(w*=-1),isNaN(w)&&(w=0);const x=w*f*v/A,T=w*-A*y/f,j=(o+c)/2+Math.cos(p)*x-Math.sin(p)*T,D=(a+h)/2+Math.sin(p)*x+Math.cos(p)*T,b=function(V){return Math.sqrt(V[0]*V[0]+V[1]*V[1])},_=function(V,K){return(V[0]*K[0]+V[1]*K[1])/(b(V)*b(K))},I=function(V,K){return(V[0]*K[1]<V[1]*K[0]?-1:1)*Math.acos(_(V,K))},S=I([1,0],[(y-x)/f,(v-T)/A]),F=[(y-x)/f,(v-T)/A],B=[(-1*y-x)/f,(-1*v-T)/A];let E=I(F,B);return _(F,B)<=-1&&(E=Math.PI),_(F,B)>=1&&(E=0),d===0&&E>0&&(E=E-2*Math.PI),d===1&&E<0&&(E=E+2*Math.PI),[j,D,f,A,S,E,p,d]}};return a2.Path=r,r.prototype.className="Path",r.prototype._attrsAffectingSize=["data"],(0,e._registerNode)(r),n.Factory.addGetterSetter(r,"data"),a2}var PR;function Bze(){if(PR)return s2;PR=1,Object.defineProperty(s2,"__esModule",{value:!0}),s2.Arrow=void 0;const n=zr(),e=Mq(),t=Jr(),i=Ur(),r=g8();let s=class extends e.Line{_sceneFunc(a){super._sceneFunc(a);const c=Math.PI*2,h=this.points();let u=h;const d=this.tension()!==0&&h.length>4;d&&(u=this.getTensionPoints());const f=this.pointerLength(),A=h.length;let g,p;if(d){const m=[u[u.length-4],u[u.length-3],u[u.length-2],u[u.length-1],h[A-2],h[A-1]],w=r.Path.calcLength(u[u.length-4],u[u.length-3],"C",m),x=r.Path.getPointOnQuadraticBezier(Math.min(1,1-f/w),m[0],m[1],m[2],m[3],m[4],m[5]);g=h[A-2]-x.x,p=h[A-1]-x.y}else g=h[A-2]-h[A-4],p=h[A-1]-h[A-3];const y=(Math.atan2(p,g)+c)%c,v=this.pointerWidth();this.pointerAtEnding()&&(a.save(),a.beginPath(),a.translate(h[A-2],h[A-1]),a.rotate(y),a.moveTo(0,0),a.lineTo(-f,v/2),a.lineTo(-f,-v/2),a.closePath(),a.restore(),this.__fillStroke(a)),this.pointerAtBeginning()&&(a.save(),a.beginPath(),a.translate(h[0],h[1]),d?(g=(u[0]+u[2])/2-h[0],p=(u[1]+u[3])/2-h[1]):(g=h[2]-h[0],p=h[3]-h[1]),a.rotate((Math.atan2(-p,-g)+c)%c),a.moveTo(0,0),a.lineTo(-f,v/2),a.lineTo(-f,-v/2),a.closePath(),a.restore(),this.__fillStroke(a))}__fillStroke(a){const c=this.dashEnabled();c&&(this.attrs.dashEnabled=!1,a.setLineDash([])),a.fillStrokeShape(this),c&&(this.attrs.dashEnabled=!0)}getSelfRect(){const a=super.getSelfRect(),c=this.pointerWidth()/2;return{x:a.x,y:a.y-c,width:a.width,height:a.height+c*2}}};return s2.Arrow=s,s.prototype.className="Arrow",(0,i._registerNode)(s),n.Factory.addGetterSetter(s,"pointerLength",10,(0,t.getNumberValidator)()),n.Factory.addGetterSetter(s,"pointerWidth",10,(0,t.getNumberValidator)()),n.Factory.addGetterSetter(s,"pointerAtBeginning",!1),n.Factory.addGetterSetter(s,"pointerAtEnding",!0),s2}var l2={},NR;function Eze(){if(NR)return l2;NR=1,Object.defineProperty(l2,"__esModule",{value:!0}),l2.Circle=void 0;const n=zr(),e=dl(),t=Jr(),i=Ur();class r extends e.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius()!==o/2&&this.radius(o/2)}setHeight(o){this.radius()!==o/2&&this.radius(o/2)}}return l2.Circle=r,r.prototype._centroid=!0,r.prototype.className="Circle",r.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(r),n.Factory.addGetterSetter(r,"radius",0,(0,t.getNumberValidator)()),l2}var c2={},LR;function kze(){if(LR)return c2;LR=1,Object.defineProperty(c2,"__esModule",{value:!0}),c2.Ellipse=void 0;const n=zr(),e=dl(),t=Jr(),i=Ur();let r=class extends e.Shape{_sceneFunc(o){const a=this.radiusX(),c=this.radiusY();o.beginPath(),o.save(),a!==c&&o.scale(1,c/a),o.arc(0,0,a,0,Math.PI*2,!1),o.restore(),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(o){this.radiusX(o/2)}setHeight(o){this.radiusY(o/2)}};return c2.Ellipse=r,r.prototype.className="Ellipse",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,i._registerNode)(r),n.Factory.addComponentsGetterSetter(r,"radius",["x","y"]),n.Factory.addGetterSetter(r,"radiusX",0,(0,t.getNumberValidator)()),n.Factory.addGetterSetter(r,"radiusY",0,(0,t.getNumberValidator)()),c2}var h2={},MR;function Ize(){if(MR)return h2;MR=1,Object.defineProperty(h2,"__esModule",{value:!0}),h2.Image=void 0;const n=Zo(),e=zr(),t=dl(),i=Ur(),r=Jr();class s extends t.Shape{constructor(a){super(a),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",c=>{this._removeImageLoad(c.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const a=this.image();a&&a.complete||a&&a.readyState===4||a&&a.addEventListener&&a.addEventListener("load",this._loadListener)}_removeImageLoad(a){a&&a.removeEventListener&&a.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const a=!!this.cornerRadius(),c=this.hasShadow();return a&&c?!0:super._useBufferCanvas(!0)}_sceneFunc(a){const c=this.getWidth(),h=this.getHeight(),u=this.cornerRadius(),d=this.attrs.image;let f;if(d){const A=this.attrs.cropWidth,g=this.attrs.cropHeight;A&&g?f=[d,this.cropX(),this.cropY(),A,g,0,0,c,h]:f=[d,0,0,c,h]}(this.hasFill()||this.hasStroke()||u)&&(a.beginPath(),u?n.Util.drawRoundedRectPath(a,c,h,u):a.rect(0,0,c,h),a.closePath(),a.fillStrokeShape(this)),d&&(u&&a.clip(),a.drawImage.apply(a,f))}_hitFunc(a){const c=this.width(),h=this.height(),u=this.cornerRadius();a.beginPath(),u?n.Util.drawRoundedRectPath(a,c,h,u):a.rect(0,0,c,h),a.closePath(),a.fillStrokeShape(this)}getWidth(){var a,c;return(a=this.attrs.width)!==null&&a!==void 0?a:(c=this.image())===null||c===void 0?void 0:c.width}getHeight(){var a,c;return(a=this.attrs.height)!==null&&a!==void 0?a:(c=this.image())===null||c===void 0?void 0:c.height}static fromURL(a,c,h=null){const u=n.Util.createImageElement();u.onload=function(){const d=new s({image:u});c(d)},u.onerror=h,u.crossOrigin="Anonymous",u.src=a}}return h2.Image=s,s.prototype.className="Image",(0,i._registerNode)(s),e.Factory.addGetterSetter(s,"cornerRadius",0,(0,r.getNumberOrArrayOfNumbersValidator)(4)),e.Factory.addGetterSetter(s,"image"),e.Factory.addComponentsGetterSetter(s,"crop",["x","y","width","height"]),e.Factory.addGetterSetter(s,"cropX",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"cropY",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"cropWidth",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"cropHeight",0,(0,r.getNumberValidator)()),h2}var kp={},RR;function Fze(){if(RR)return kp;RR=1,Object.defineProperty(kp,"__esModule",{value:!0}),kp.Tag=kp.Label=void 0;const n=zr(),e=dl(),t=f8(),i=Jr(),r=Ur(),s=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],o="Change.konva",a="none",c="up",h="right",u="down",d="left",f=s.length;let A=class extends t.Group{constructor(y){super(y),this.on("add.konva",function(v){this._addListeners(v.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(y){let v=this,m;const w=function(){v._sync()};for(m=0;m<f;m++)y.on(s[m]+o,w)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let y=this.getText(),v=this.getTag(),m,w,x,T,j,D,b;if(y&&v){switch(m=y.width(),w=y.height(),x=v.pointerDirection(),T=v.pointerWidth(),b=v.pointerHeight(),j=0,D=0,x){case c:j=m/2,D=-1*b;break;case h:j=m+T,D=w/2;break;case u:j=m/2,D=w+b;break;case d:j=-1*T,D=w/2;break}v.setAttrs({x:-1*j,y:-1*D,width:m,height:w}),y.setAttrs({x:-1*j,y:-1*D})}}};kp.Label=A,A.prototype.className="Label",(0,r._registerNode)(A);class g extends e.Shape{_sceneFunc(y){const v=this.width(),m=this.height(),w=this.pointerDirection(),x=this.pointerWidth(),T=this.pointerHeight(),j=this.cornerRadius();let D=0,b=0,_=0,I=0;typeof j=="number"?D=b=_=I=Math.min(j,v/2,m/2):(D=Math.min(j[0]||0,v/2,m/2),b=Math.min(j[1]||0,v/2,m/2),I=Math.min(j[2]||0,v/2,m/2),_=Math.min(j[3]||0,v/2,m/2)),y.beginPath(),y.moveTo(D,0),w===c&&(y.lineTo((v-x)/2,0),y.lineTo(v/2,-1*T),y.lineTo((v+x)/2,0)),y.lineTo(v-b,0),y.arc(v-b,b,b,Math.PI*3/2,0,!1),w===h&&(y.lineTo(v,(m-T)/2),y.lineTo(v+x,m/2),y.lineTo(v,(m+T)/2)),y.lineTo(v,m-I),y.arc(v-I,m-I,I,0,Math.PI/2,!1),w===u&&(y.lineTo((v+x)/2,m),y.lineTo(v/2,m+T),y.lineTo((v-x)/2,m)),y.lineTo(_,m),y.arc(_,m-_,_,Math.PI/2,Math.PI,!1),w===d&&(y.lineTo(0,(m+T)/2),y.lineTo(-1*x,m/2),y.lineTo(0,(m-T)/2)),y.lineTo(0,D),y.arc(D,D,D,Math.PI,Math.PI*3/2,!1),y.closePath(),y.fillStrokeShape(this)}getSelfRect(){let y=0,v=0,m=this.pointerWidth(),w=this.pointerHeight(),x=this.pointerDirection(),T=this.width(),j=this.height();return x===c?(v-=w,j+=w):x===u?j+=w:x===d?(y-=m*1.5,T+=m):x===h&&(T+=m*1.5),{x:y,y:v,width:T,height:j}}}return kp.Tag=g,g.prototype.className="Tag",(0,r._registerNode)(g),n.Factory.addGetterSetter(g,"pointerDirection",a),n.Factory.addGetterSetter(g,"pointerWidth",0,(0,i.getNumberValidator)()),n.Factory.addGetterSetter(g,"pointerHeight",0,(0,i.getNumberValidator)()),n.Factory.addGetterSetter(g,"cornerRadius",0,(0,i.getNumberOrArrayOfNumbersValidator)(4)),kp}var u2={},OR;function Rq(){if(OR)return u2;OR=1,Object.defineProperty(u2,"__esModule",{value:!0}),u2.Rect=void 0;const n=zr(),e=dl(),t=Ur(),i=Zo(),r=Jr();class s extends e.Shape{_sceneFunc(a){const c=this.cornerRadius(),h=this.width(),u=this.height();a.beginPath(),c?i.Util.drawRoundedRectPath(a,h,u,c):a.rect(0,0,h,u),a.closePath(),a.fillStrokeShape(this)}}return u2.Rect=s,s.prototype.className="Rect",(0,t._registerNode)(s),n.Factory.addGetterSetter(s,"cornerRadius",0,(0,r.getNumberOrArrayOfNumbersValidator)(4)),u2}var d2={},UR;function Dze(){if(UR)return d2;UR=1,Object.defineProperty(d2,"__esModule",{value:!0}),d2.RegularPolygon=void 0;const n=zr(),e=dl(),t=Jr(),i=Ur();let r=class extends e.Shape{_sceneFunc(o){const a=this._getPoints();o.beginPath(),o.moveTo(a[0].x,a[0].y);for(let c=1;c<a.length;c++)o.lineTo(a[c].x,a[c].y);o.closePath(),o.fillStrokeShape(this)}_getPoints(){const o=this.attrs.sides,a=this.attrs.radius||0,c=[];for(let h=0;h<o;h++)c.push({x:a*Math.sin(h*2*Math.PI/o),y:-1*a*Math.cos(h*2*Math.PI/o)});return c}getSelfRect(){const o=this._getPoints();let a=o[0].x,c=o[0].y,h=o[0].x,u=o[0].y;return o.forEach(d=>{a=Math.min(a,d.x),c=Math.max(c,d.x),h=Math.min(h,d.y),u=Math.max(u,d.y)}),{x:a,y:h,width:c-a,height:u-h}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius(o/2)}setHeight(o){this.radius(o/2)}};return d2.RegularPolygon=r,r.prototype.className="RegularPolygon",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(r),n.Factory.addGetterSetter(r,"radius",0,(0,t.getNumberValidator)()),n.Factory.addGetterSetter(r,"sides",0,(0,t.getNumberValidator)()),d2}var A2={},HR;function jze(){if(HR)return A2;HR=1,Object.defineProperty(A2,"__esModule",{value:!0}),A2.Ring=void 0;const n=zr(),e=dl(),t=Jr(),i=Ur(),r=Math.PI*2;let s=class extends e.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.innerRadius(),0,r,!1),a.moveTo(this.outerRadius(),0),a.arc(0,0,this.outerRadius(),r,0,!0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(a){this.outerRadius(a/2)}setHeight(a){this.outerRadius(a/2)}};return A2.Ring=s,s.prototype.className="Ring",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(s),n.Factory.addGetterSetter(s,"innerRadius",0,(0,t.getNumberValidator)()),n.Factory.addGetterSetter(s,"outerRadius",0,(0,t.getNumberValidator)()),A2}var f2={},WR;function Pze(){if(WR)return f2;WR=1,Object.defineProperty(f2,"__esModule",{value:!0}),f2.Sprite=void 0;const n=zr(),e=dl(),t=p8(),i=Jr(),r=Ur();let s=class extends e.Shape{constructor(a){super(a),this._updated=!0,this.anim=new t.Animation(()=>{const c=this._updated;return this._updated=!1,c}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(a){const c=this.animation(),h=this.frameIndex(),u=h*4,d=this.animations()[c],f=this.frameOffsets(),A=d[u+0],g=d[u+1],p=d[u+2],y=d[u+3],v=this.image();if((this.hasFill()||this.hasStroke())&&(a.beginPath(),a.rect(0,0,p,y),a.closePath(),a.fillStrokeShape(this)),v)if(f){const m=f[c],w=h*2;a.drawImage(v,A,g,p,y,m[w+0],m[w+1],p,y)}else a.drawImage(v,A,g,p,y,0,0,p,y)}_hitFunc(a){const c=this.animation(),h=this.frameIndex(),u=h*4,d=this.animations()[c],f=this.frameOffsets(),A=d[u+2],g=d[u+3];if(a.beginPath(),f){const p=f[c],y=h*2;a.rect(p[y+0],p[y+1],A,g)}else a.rect(0,0,A,g);a.closePath(),a.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const a=this;this.interval=setInterval(function(){a._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const a=this.getLayer();this.anim.setLayers(a),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const a=this.frameIndex(),c=this.animation(),h=this.animations(),u=h[c],d=u.length/4;a<d-1?this.frameIndex(a+1):this.frameIndex(0)}};return f2.Sprite=s,s.prototype.className="Sprite",(0,r._registerNode)(s),n.Factory.addGetterSetter(s,"animation"),n.Factory.addGetterSetter(s,"animations"),n.Factory.addGetterSetter(s,"frameOffsets"),n.Factory.addGetterSetter(s,"image"),n.Factory.addGetterSetter(s,"frameIndex",0,(0,i.getNumberValidator)()),n.Factory.addGetterSetter(s,"frameRate",17,(0,i.getNumberValidator)()),n.Factory.backCompat(s,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),f2}var p2={},QR;function Nze(){if(QR)return p2;QR=1,Object.defineProperty(p2,"__esModule",{value:!0}),p2.Star=void 0;const n=zr(),e=dl(),t=Jr(),i=Ur();let r=class extends e.Shape{_sceneFunc(o){const a=this.innerRadius(),c=this.outerRadius(),h=this.numPoints();o.beginPath(),o.moveTo(0,0-c);for(let u=1;u<h*2;u++){const d=u%2===0?c:a,f=d*Math.sin(u*Math.PI/h),A=-1*d*Math.cos(u*Math.PI/h);o.lineTo(f,A)}o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}};return p2.Star=r,r.prototype.className="Star",r.prototype._centroid=!0,r.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(r),n.Factory.addGetterSetter(r,"numPoints",5,(0,t.getNumberValidator)()),n.Factory.addGetterSetter(r,"innerRadius",0,(0,t.getNumberValidator)()),n.Factory.addGetterSetter(r,"outerRadius",0,(0,t.getNumberValidator)()),p2}var x0={},$R;function Oq(){if($R)return x0;$R=1,Object.defineProperty(x0,"__esModule",{value:!0}),x0.Text=void 0,x0.stringToArray=o;const n=Zo(),e=zr(),t=dl(),i=Ur(),r=Jr(),s=Ur();function o(U){return[...U].reduce((z,q,G,ie)=>{if(new RegExp("\\p{Emoji}","u").test(q)){const H=ie[G+1];H&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(H)?(z.push(q+H),ie[G+1]=""):z.push(q)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(q+(ie[G+1]||""))?z.push(q+ie[G+1]):G>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(q)?z[z.length-1]+=q:q&&z.push(q);return z},[])}const a="auto",c="center",h="inherit",u="justify",d="Change.konva",f="2d",A="-",g="left",p="text",y="Text",v="top",m="bottom",w="middle",x="normal",T="px ",j=" ",D="right",b="rtl",_="word",I="char",S="none",F="…",B=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],E=B.length;function V(U){return U.split(",").map(z=>{z=z.trim();const q=z.indexOf(" ")>=0,G=z.indexOf('"')>=0||z.indexOf("'")>=0;return q&&!G&&(z=`"${z}"`),z}).join(", ")}let K;function P(){return K||(K=n.Util.createCanvasElement().getContext(f),K)}function M(U){U.fillText(this._partialText,this._partialTextX,this._partialTextY)}function X(U){U.setAttr("miterLimit",2),U.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function Z(U){return U=U||{},!U.fillLinearGradientColorStops&&!U.fillRadialGradientColorStops&&!U.fillPatternImage&&(U.fill=U.fill||"black"),U}class Q extends t.Shape{constructor(z){super(Z(z)),this._partialTextX=0,this._partialTextY=0;for(let q=0;q<E;q++)this.on(B[q]+d,this._setTextData);this._setTextData()}_sceneFunc(z){const q=this.textArr,G=q.length;if(!this.text())return;let ie=this.padding(),H=this.fontSize(),se=this.lineHeight()*H,te=this.verticalAlign(),fe=this.direction(),ye=0,be=this.align(),_e=this.getWidth(),W=this.letterSpacing(),Y=this.fill(),ve=this.textDecoration(),ce=ve.indexOf("underline")!==-1,ne=ve.indexOf("line-through")!==-1,he;fe=fe===h?z.direction:fe;let xe=se/2,Te=w;if(i.Konva._fixTextRendering){const Ce=this.measureSize("M");Te="alphabetic",xe=(Ce.fontBoundingBoxAscent-Ce.fontBoundingBoxDescent)/2+se/2}for(fe===b&&z.setAttr("direction",fe),z.setAttr("font",this._getContextFont()),z.setAttr("textBaseline",Te),z.setAttr("textAlign",g),te===w?ye=(this.getHeight()-G*se-ie*2)/2:te===m&&(ye=this.getHeight()-G*se-ie*2),z.translate(ie,ye+ie),he=0;he<G;he++){let Ce=0,Be=0;const Ye=q[he],$e=Ye.text,ot=Ye.width,rt=Ye.lastInParagraph;if(z.save(),be===D?Ce+=_e-ot-ie*2:be===c&&(Ce+=(_e-ot-ie*2)/2),ce){z.save(),z.beginPath();const Ve=i.Konva._fixTextRendering?Math.round(H/4):Math.round(H/2),We=Ce,De=xe+Be+Ve;z.moveTo(We,De);const Ge=be===u&&!rt?_e-ie*2:ot;z.lineTo(We+Math.round(Ge),De),z.lineWidth=H/15;const Re=this._getLinearGradient();z.strokeStyle=Re||Y,z.stroke(),z.restore()}if(ne){z.save(),z.beginPath();const Ve=i.Konva._fixTextRendering?-Math.round(H/4):0;z.moveTo(Ce,xe+Be+Ve);const We=be===u&&!rt?_e-ie*2:ot;z.lineTo(Ce+Math.round(We),xe+Be+Ve),z.lineWidth=H/15;const De=this._getLinearGradient();z.strokeStyle=De||Y,z.stroke(),z.restore()}if(fe!==b&&(W!==0||be===u)){const Ve=$e.split(" ").length-1,We=o($e);for(let De=0;De<We.length;De++){const Ge=We[De];Ge===" "&&!rt&&be===u&&(Ce+=(_e-ie*2-ot)/Ve),this._partialTextX=Ce,this._partialTextY=xe+Be,this._partialText=Ge,z.fillStrokeShape(this),Ce+=this.measureSize(Ge).width+W}}else W!==0&&z.setAttr("letterSpacing",`${W}px`),this._partialTextX=Ce,this._partialTextY=xe+Be,this._partialText=$e,z.fillStrokeShape(this);z.restore(),G>1&&(xe+=se)}}_hitFunc(z){const q=this.getWidth(),G=this.getHeight();z.beginPath(),z.rect(0,0,q,G),z.closePath(),z.fillStrokeShape(this)}setText(z){const q=n.Util._isString(z)?z:z==null?"":z+"";return this._setAttr(p,q),this}getWidth(){return this.attrs.width===a||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===a||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return n.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(z){var q,G,ie,H,se,te,fe,ye,be,_e,W;let Y=P(),ve=this.fontSize(),ce;Y.save(),Y.font=this._getContextFont(),ce=Y.measureText(z),Y.restore();const ne=ve/100;return{actualBoundingBoxAscent:(q=ce.actualBoundingBoxAscent)!==null&&q!==void 0?q:71.58203125*ne,actualBoundingBoxDescent:(G=ce.actualBoundingBoxDescent)!==null&&G!==void 0?G:0,actualBoundingBoxLeft:(ie=ce.actualBoundingBoxLeft)!==null&&ie!==void 0?ie:-7.421875*ne,actualBoundingBoxRight:(H=ce.actualBoundingBoxRight)!==null&&H!==void 0?H:75.732421875*ne,alphabeticBaseline:(se=ce.alphabeticBaseline)!==null&&se!==void 0?se:0,emHeightAscent:(te=ce.emHeightAscent)!==null&&te!==void 0?te:100*ne,emHeightDescent:(fe=ce.emHeightDescent)!==null&&fe!==void 0?fe:-20*ne,fontBoundingBoxAscent:(ye=ce.fontBoundingBoxAscent)!==null&&ye!==void 0?ye:91*ne,fontBoundingBoxDescent:(be=ce.fontBoundingBoxDescent)!==null&&be!==void 0?be:21*ne,hangingBaseline:(_e=ce.hangingBaseline)!==null&&_e!==void 0?_e:72.80000305175781*ne,ideographicBaseline:(W=ce.ideographicBaseline)!==null&&W!==void 0?W:-21*ne,width:ce.width,height:ve}}_getContextFont(){return this.fontStyle()+j+this.fontVariant()+j+(this.fontSize()+T)+V(this.fontFamily())}_addTextLine(z){this.align()===u&&(z=z.trim());const G=this._getTextWidth(z);return this.textArr.push({text:z,width:G,lastInParagraph:!1})}_getTextWidth(z){const q=this.letterSpacing(),G=z.length;return P().measureText(z).width+q*G}_setTextData(){let z=this.text().split(`
`),q=+this.fontSize(),G=0,ie=this.lineHeight()*q,H=this.attrs.width,se=this.attrs.height,te=H!==a&&H!==void 0,fe=se!==a&&se!==void 0,ye=this.padding(),be=H-ye*2,_e=se-ye*2,W=0,Y=this.wrap(),ve=Y!==S,ce=Y!==I&&ve,ne=this.ellipsis();this.textArr=[],P().font=this._getContextFont();const he=ne?this._getTextWidth(F):0;for(let xe=0,Te=z.length;xe<Te;++xe){let Ce=z[xe],Be=this._getTextWidth(Ce);if(te&&Be>be)for(;Ce.length>0;){let Ye=0,$e=o(Ce).length,ot="",rt=0;for(;Ye<$e;){const Ve=Ye+$e>>>1,We=o(Ce),De=We.slice(0,Ve+1).join(""),Ge=this._getTextWidth(De);(ne&&fe&&W+ie>_e?Ge+he:Ge)<=be?(Ye=Ve+1,ot=De,rt=Ge):$e=Ve}if(ot){if(ce){const De=o(Ce),Ge=o(ot),Re=De[Ge.length],Ie=Re===j||Re===A;let Le;if(Ie&&rt<=be)Le=Ge.length;else{const et=Ge.lastIndexOf(j),ct=Ge.lastIndexOf(A);Le=Math.max(et,ct)+1}Le>0&&(Ye=Le,ot=De.slice(0,Ye).join(""),rt=this._getTextWidth(ot))}if(ot=ot.trimRight(),this._addTextLine(ot),G=Math.max(G,rt),W+=ie,this._shouldHandleEllipsis(W)){this._tryToAddEllipsisToLastLine();break}if(Ce=o(Ce).slice(Ye).join("").trimLeft(),Ce.length>0&&(Be=this._getTextWidth(Ce),Be<=be)){this._addTextLine(Ce),W+=ie,G=Math.max(G,Be);break}}else break}else this._addTextLine(Ce),W+=ie,G=Math.max(G,Be),this._shouldHandleEllipsis(W)&&xe<Te-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),fe&&W+ie>_e)break}this.textHeight=q,this.textWidth=G}_shouldHandleEllipsis(z){const q=+this.fontSize(),G=this.lineHeight()*q,ie=this.attrs.height,H=ie!==a&&ie!==void 0,se=this.padding(),te=ie-se*2;return!(this.wrap()!==S)||H&&z+G>te}_tryToAddEllipsisToLastLine(){const z=this.attrs.width,q=z!==a&&z!==void 0,G=this.padding(),ie=z-G*2,H=this.ellipsis(),se=this.textArr[this.textArr.length-1];!se||!H||(q&&(this._getTextWidth(se.text+F)<ie||(se.text=se.text.slice(0,se.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(se.text+F))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const z=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,q=this.hasShadow();return z&&q?!0:super._useBufferCanvas()}}return x0.Text=Q,Q.prototype._fillFunc=M,Q.prototype._strokeFunc=X,Q.prototype.className=y,Q.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,s._registerNode)(Q),e.Factory.overWriteSetter(Q,"width",(0,r.getNumberOrAutoValidator)()),e.Factory.overWriteSetter(Q,"height",(0,r.getNumberOrAutoValidator)()),e.Factory.addGetterSetter(Q,"direction",h),e.Factory.addGetterSetter(Q,"fontFamily","Arial"),e.Factory.addGetterSetter(Q,"fontSize",12,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(Q,"fontStyle",x),e.Factory.addGetterSetter(Q,"fontVariant",x),e.Factory.addGetterSetter(Q,"padding",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(Q,"align",g),e.Factory.addGetterSetter(Q,"verticalAlign",v),e.Factory.addGetterSetter(Q,"lineHeight",1,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(Q,"wrap",_),e.Factory.addGetterSetter(Q,"ellipsis",!1,(0,r.getBooleanValidator)()),e.Factory.addGetterSetter(Q,"letterSpacing",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(Q,"text","",(0,r.getStringValidator)()),e.Factory.addGetterSetter(Q,"textDecoration",""),x0}var g2={},VR;function Lze(){if(VR)return g2;VR=1,Object.defineProperty(g2,"__esModule",{value:!0}),g2.TextPath=void 0;const n=Zo(),e=zr(),t=dl(),i=g8(),r=Oq(),s=Jr(),o=Ur(),a="",c="normal";function h(f){f.fillText(this.partialText,0,0)}function u(f){f.strokeText(this.partialText,0,0)}let d=class extends t.Shape{constructor(A){super(A),this.dummyCanvas=n.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return i.Path.getPathLength(this.dataArray)}_getPointAtLength(A){if(!this.attrs.data)return null;const g=this.pathLength;return A-1>g?null:i.Path.getPointAtLengthOfDataArray(A,this.dataArray)}_readDataAttribute(){this.dataArray=i.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(A){A.setAttr("font",this._getContextFont()),A.setAttr("textBaseline",this.textBaseline()),A.setAttr("textAlign","left"),A.save();const g=this.textDecoration(),p=this.fill(),y=this.fontSize(),v=this.glyphInfo;g==="underline"&&A.beginPath();for(let m=0;m<v.length;m++){A.save();const w=v[m].p0;A.translate(w.x,w.y),A.rotate(v[m].rotation),this.partialText=v[m].text,A.fillStrokeShape(this),g==="underline"&&(m===0&&A.moveTo(0,y/2+1),A.lineTo(y,y/2+1)),A.restore()}g==="underline"&&(A.strokeStyle=p,A.lineWidth=y/20,A.stroke()),A.restore()}_hitFunc(A){A.beginPath();const g=this.glyphInfo;if(g.length>=1){const p=g[0].p0;A.moveTo(p.x,p.y)}for(let p=0;p<g.length;p++){const y=g[p].p1;A.lineTo(y.x,y.y)}A.setAttr("lineWidth",this.fontSize()),A.setAttr("strokeStyle",this.colorKey),A.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return n.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(A){return r.Text.prototype.setText.call(this,A)}_getContextFont(){return r.Text.prototype._getContextFont.call(this)}_getTextSize(A){const p=this.dummyCanvas.getContext("2d");p.save(),p.font=this._getContextFont();const y=p.measureText(A);return p.restore(),{width:y.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:A,height:g}=this._getTextSize(this.attrs.text);if(this.textWidth=A,this.textHeight=g,this.glyphInfo=[],!this.attrs.data)return null;const p=this.letterSpacing(),y=this.align(),v=this.kerningFunc(),m=Math.max(this.textWidth+((this.attrs.text||"").length-1)*p,0);let w=0;y==="center"&&(w=Math.max(0,this.pathLength/2-m/2)),y==="right"&&(w=Math.max(0,this.pathLength-m));const x=(0,r.stringToArray)(this.text());let T=w;for(let j=0;j<x.length;j++){const D=this._getPointAtLength(T);if(!D)return;let b=this._getTextSize(x[j]).width+p;if(x[j]===" "&&y==="justify"){const E=this.text().split(" ").length-1;b+=(this.pathLength-m)/E}const _=this._getPointAtLength(T+b);if(!_)return;const I=i.Path.getLineLength(D.x,D.y,_.x,_.y);let S=0;if(v)try{S=v(x[j-1],x[j])*this.fontSize()}catch{S=0}D.x+=S,_.x+=S,this.textWidth+=S;const F=i.Path.getPointOnLine(S+I/2,D.x,D.y,_.x,_.y),B=Math.atan2(_.y-D.y,_.x-D.x);this.glyphInfo.push({transposeX:F.x,transposeY:F.y,text:x[j],rotation:B,p0:D,p1:_}),T+=b}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const A=[];this.glyphInfo.forEach(function(T){A.push(T.p0.x),A.push(T.p0.y),A.push(T.p1.x),A.push(T.p1.y)});let g=A[0]||0,p=A[0]||0,y=A[1]||0,v=A[1]||0,m,w;for(let T=0;T<A.length/2;T++)m=A[T*2],w=A[T*2+1],g=Math.min(g,m),p=Math.max(p,m),y=Math.min(y,w),v=Math.max(v,w);const x=this.fontSize();return{x:g-x/2,y:y-x/2,width:p-g+x,height:v-y+x}}destroy(){return n.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};return g2.TextPath=d,d.prototype._fillFunc=h,d.prototype._strokeFunc=u,d.prototype._fillFuncHit=h,d.prototype._strokeFuncHit=u,d.prototype.className="TextPath",d.prototype._attrsAffectingSize=["text","fontSize","data"],(0,o._registerNode)(d),e.Factory.addGetterSetter(d,"data"),e.Factory.addGetterSetter(d,"fontFamily","Arial"),e.Factory.addGetterSetter(d,"fontSize",12,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(d,"fontStyle",c),e.Factory.addGetterSetter(d,"align","left"),e.Factory.addGetterSetter(d,"letterSpacing",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(d,"textBaseline","middle"),e.Factory.addGetterSetter(d,"fontVariant",c),e.Factory.addGetterSetter(d,"text",a),e.Factory.addGetterSetter(d,"textDecoration",""),e.Factory.addGetterSetter(d,"kerningFunc",void 0),g2}var m2={},zR;function Mze(){if(zR)return m2;zR=1,Object.defineProperty(m2,"__esModule",{value:!0}),m2.Transformer=void 0;const n=Zo(),e=zr(),t=ga(),i=dl(),r=Rq(),s=f8(),o=Ur(),a=Jr(),c=Ur(),h="tr-konva",u=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(b=>b+`.${h}`).join(" "),d="nodesRect",f=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],A={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},g="ontouchstart"in o.Konva._global;function p(b,_,I){if(b==="rotater")return I;_+=n.Util.degToRad(A[b]||0);const S=(n.Util.radToDeg(_)%360+360)%360;return n.Util._inRange(S,315+22.5,360)||n.Util._inRange(S,0,22.5)?"ns-resize":n.Util._inRange(S,45-22.5,45+22.5)?"nesw-resize":n.Util._inRange(S,90-22.5,90+22.5)?"ew-resize":n.Util._inRange(S,135-22.5,135+22.5)?"nwse-resize":n.Util._inRange(S,180-22.5,180+22.5)?"ns-resize":n.Util._inRange(S,225-22.5,225+22.5)?"nesw-resize":n.Util._inRange(S,270-22.5,270+22.5)?"ew-resize":n.Util._inRange(S,315-22.5,315+22.5)?"nwse-resize":(n.Util.error("Transformer has unknown angle for cursor detection: "+S),"pointer")}const y=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function v(b){return{x:b.x+b.width/2*Math.cos(b.rotation)+b.height/2*Math.sin(-b.rotation),y:b.y+b.height/2*Math.cos(b.rotation)+b.width/2*Math.sin(b.rotation)}}function m(b,_,I){const S=I.x+(b.x-I.x)*Math.cos(_)-(b.y-I.y)*Math.sin(_),F=I.y+(b.x-I.x)*Math.sin(_)+(b.y-I.y)*Math.cos(_);return{...b,rotation:b.rotation+_,x:S,y:F}}function w(b,_){const I=v(b);return m(b,_,I)}function x(b,_,I){let S=_;for(let F=0;F<b.length;F++){const B=o.Konva.getAngle(b[F]),E=Math.abs(B-_)%(Math.PI*2);Math.min(E,Math.PI*2-E)<I&&(S=B)}return S}let T=0,j=class extends s.Group{constructor(_){super(_),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(u,this.update),this.getNode()&&this.update()}attachTo(_){return this.setNode(_),this}setNode(_){return n.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([_])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return h+this._id}setNodes(_=[]){this._nodes&&this._nodes.length&&this.detach();const I=_.filter(F=>F.isAncestorOf(this)?(n.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=_=I,_.length===1&&this.useSingleNodeRotation()?this.rotation(_[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(F=>{const B=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(F._attrsAffectingSize.length){const E=F._attrsAffectingSize.map(V=>V+"Change."+this._getEventNamespace()).join(" ");F.on(E,B)}F.on(f.map(E=>E+`.${this._getEventNamespace()}`).join(" "),B),F.on(`absoluteTransformChange.${this._getEventNamespace()}`,B),this._proxyDrag(F)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(_){let I;_.on(`dragstart.${this._getEventNamespace()}`,S=>{I=_.getAbsolutePosition(),!this.isDragging()&&_!==this.findOne(".back")&&this.startDrag(S,!1)}),_.on(`dragmove.${this._getEventNamespace()}`,S=>{if(!I)return;const F=_.getAbsolutePosition(),B=F.x-I.x,E=F.y-I.y;this.nodes().forEach(V=>{if(V===_||V.isDragging())return;const K=V.getAbsolutePosition();V.setAbsolutePosition({x:K.x+B,y:K.y+E}),V.startDrag(S)}),I=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(_=>{_.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(d),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(d,this.__getNodeRect)}__getNodeShape(_,I=this.rotation(),S){const F=_.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),B=_.getAbsoluteScale(S),E=_.getAbsolutePosition(S),V=F.x*B.x-_.offsetX()*B.x,K=F.y*B.y-_.offsetY()*B.y,P=(o.Konva.getAngle(_.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),M={x:E.x+V*Math.cos(P)+K*Math.sin(-P),y:E.y+K*Math.cos(P)+V*Math.sin(P),width:F.width*B.x,height:F.height*B.y,rotation:P};return m(M,-o.Konva.getAngle(I),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const I=[];this.nodes().map(P=>{const M=P.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),X=[{x:M.x,y:M.y},{x:M.x+M.width,y:M.y},{x:M.x+M.width,y:M.y+M.height},{x:M.x,y:M.y+M.height}],Z=P.getAbsoluteTransform();X.forEach(function(Q){const U=Z.point(Q);I.push(U)})});const S=new n.Transform;S.rotate(-o.Konva.getAngle(this.rotation()));let F=1/0,B=1/0,E=-1/0,V=-1/0;I.forEach(function(P){const M=S.point(P);F===void 0&&(F=E=M.x,B=V=M.y),F=Math.min(F,M.x),B=Math.min(B,M.y),E=Math.max(E,M.x),V=Math.max(V,M.y)}),S.invert();const K=S.point({x:F,y:B});return{x:K.x,y:K.y,width:E-F,height:V-B,rotation:o.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),y.forEach(_=>{this._createAnchor(_)}),this._createAnchor("rotater")}_createAnchor(_){const I=new r.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:_+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:g?10:"auto"}),S=this;I.on("mousedown touchstart",function(F){S._handleMouseDown(F)}),I.on("dragstart",F=>{I.stopDrag(),F.cancelBubble=!0}),I.on("dragend",F=>{F.cancelBubble=!0}),I.on("mouseenter",()=>{const F=o.Konva.getAngle(this.rotation()),B=this.rotateAnchorCursor(),E=p(_,F,B);I.getStage().content&&(I.getStage().content.style.cursor=E),this._cursorChange=!0}),I.on("mouseout",()=>{I.getStage().content&&(I.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(I)}_createBack(){const _=new i.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(I,S){const F=S.getParent(),B=F.padding();I.beginPath(),I.rect(-B,-B,S.width()+B*2,S.height()+B*2),I.moveTo(S.width()/2,-B),F.rotateEnabled()&&F.rotateLineVisible()&&I.lineTo(S.width()/2,-F.rotateAnchorOffset()*n.Util._sign(S.height())-B),I.fillStrokeShape(S)},hitFunc:(I,S)=>{if(!this.shouldOverdrawWholeArea())return;const F=this.padding();I.beginPath(),I.rect(-F,-F,S.width()+F*2,S.height()+F*2),I.fillStrokeShape(S)}});this.add(_),this._proxyDrag(_),_.on("dragstart",I=>{I.cancelBubble=!0}),_.on("dragmove",I=>{I.cancelBubble=!0}),_.on("dragend",I=>{I.cancelBubble=!0}),this.on("dragmove",I=>{this.update()})}_handleMouseDown(_){if(this._transforming)return;this._movingAnchorName=_.target.name().split(" ")[0];const I=this._getNodeRect(),S=I.width,F=I.height,B=Math.sqrt(Math.pow(S,2)+Math.pow(F,2));this.sin=Math.abs(F/B),this.cos=Math.abs(S/B),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const E=_.target.getAbsolutePosition(),V=_.target.getStage().getPointerPosition();this._anchorDragOffset={x:V.x-E.x,y:V.y-E.y},T++,this._fire("transformstart",{evt:_.evt,target:this.getNode()}),this._nodes.forEach(K=>{K._fire("transformstart",{evt:_.evt,target:K})})}_handleMouseMove(_){let I,S,F;const B=this.findOne("."+this._movingAnchorName),E=B.getStage();E.setPointersPositions(_);const V=E.getPointerPosition();let K={x:V.x-this._anchorDragOffset.x,y:V.y-this._anchorDragOffset.y};const P=B.getAbsolutePosition();this.anchorDragBoundFunc()&&(K=this.anchorDragBoundFunc()(P,K,_)),B.setAbsolutePosition(K);const M=B.getAbsolutePosition();if(P.x===M.x&&P.y===M.y)return;if(this._movingAnchorName==="rotater"){const ie=this._getNodeRect();I=B.x()-ie.width/2,S=-B.y()+ie.height/2;let H=Math.atan2(-S,I)+Math.PI/2;ie.height<0&&(H-=Math.PI);const te=o.Konva.getAngle(this.rotation())+H,fe=o.Konva.getAngle(this.rotationSnapTolerance()),be=x(this.rotationSnaps(),te,fe)-ie.rotation,_e=w(ie,be);this._fitNodesInto(_e,_);return}const X=this.shiftBehavior();let Z;X==="inverted"?Z=this.keepRatio()&&!_.shiftKey:X==="none"?Z=this.keepRatio():Z=this.keepRatio()||_.shiftKey;let Q=this.centeredScaling()||_.altKey;if(this._movingAnchorName==="top-left"){if(Z){const ie=Q?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};F=Math.sqrt(Math.pow(ie.x-B.x(),2)+Math.pow(ie.y-B.y(),2));const H=this.findOne(".top-left").x()>ie.x?-1:1,se=this.findOne(".top-left").y()>ie.y?-1:1;I=F*this.cos*H,S=F*this.sin*se,this.findOne(".top-left").x(ie.x-I),this.findOne(".top-left").y(ie.y-S)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(B.y());else if(this._movingAnchorName==="top-right"){if(Z){const ie=Q?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};F=Math.sqrt(Math.pow(B.x()-ie.x,2)+Math.pow(ie.y-B.y(),2));const H=this.findOne(".top-right").x()<ie.x?-1:1,se=this.findOne(".top-right").y()>ie.y?-1:1;I=F*this.cos*H,S=F*this.sin*se,this.findOne(".top-right").x(ie.x+I),this.findOne(".top-right").y(ie.y-S)}var U=B.position();this.findOne(".top-left").y(U.y),this.findOne(".bottom-right").x(U.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(B.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(B.x());else if(this._movingAnchorName==="bottom-left"){if(Z){const ie=Q?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};F=Math.sqrt(Math.pow(ie.x-B.x(),2)+Math.pow(B.y()-ie.y,2));const H=ie.x<B.x()?-1:1,se=B.y()<ie.y?-1:1;I=F*this.cos*H,S=F*this.sin*se,B.x(ie.x-I),B.y(ie.y+S)}U=B.position(),this.findOne(".top-left").x(U.x),this.findOne(".bottom-right").y(U.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(B.y());else if(this._movingAnchorName==="bottom-right"){if(Z){const ie=Q?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};F=Math.sqrt(Math.pow(B.x()-ie.x,2)+Math.pow(B.y()-ie.y,2));const H=this.findOne(".bottom-right").x()<ie.x?-1:1,se=this.findOne(".bottom-right").y()<ie.y?-1:1;I=F*this.cos*H,S=F*this.sin*se,this.findOne(".bottom-right").x(ie.x+I),this.findOne(".bottom-right").y(ie.y+S)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(Q=this.centeredScaling()||_.altKey,Q){const ie=this.findOne(".top-left"),H=this.findOne(".bottom-right"),se=ie.x(),te=ie.y(),fe=this.getWidth()-H.x(),ye=this.getHeight()-H.y();H.move({x:-se,y:-te}),ie.move({x:fe,y:ye})}const z=this.findOne(".top-left").getAbsolutePosition();I=z.x,S=z.y;const q=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),G=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:I,y:S,width:q,height:G,rotation:o.Konva.getAngle(this.rotation())},_)}_handleMouseUp(_){this._removeEvents(_)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(_){var I;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const S=this.getNode();T--,this._fire("transformend",{evt:_,target:S}),(I=this.getLayer())===null||I===void 0||I.batchDraw(),S&&this._nodes.forEach(F=>{var B;F._fire("transformend",{evt:_,target:F}),(B=F.getLayer())===null||B===void 0||B.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(_,I){const S=this._getNodeRect(),F=1;if(n.Util._inRange(_.width,-this.padding()*2-F,F)){this.update();return}if(n.Util._inRange(_.height,-this.padding()*2-F,F)){this.update();return}const B=new n.Transform;if(B.rotate(o.Konva.getAngle(this.rotation())),this._movingAnchorName&&_.width<0&&this._movingAnchorName.indexOf("left")>=0){const Z=B.point({x:-this.padding()*2,y:0});_.x+=Z.x,_.y+=Z.y,_.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=Z.x,this._anchorDragOffset.y-=Z.y}else if(this._movingAnchorName&&_.width<0&&this._movingAnchorName.indexOf("right")>=0){const Z=B.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=Z.x,this._anchorDragOffset.y-=Z.y,_.width+=this.padding()*2}if(this._movingAnchorName&&_.height<0&&this._movingAnchorName.indexOf("top")>=0){const Z=B.point({x:0,y:-this.padding()*2});_.x+=Z.x,_.y+=Z.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=Z.x,this._anchorDragOffset.y-=Z.y,_.height+=this.padding()*2}else if(this._movingAnchorName&&_.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const Z=B.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=Z.x,this._anchorDragOffset.y-=Z.y,_.height+=this.padding()*2}if(this.boundBoxFunc()){const Z=this.boundBoxFunc()(S,_);Z?_=Z:n.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const E=1e7,V=new n.Transform;V.translate(S.x,S.y),V.rotate(S.rotation),V.scale(S.width/E,S.height/E);const K=new n.Transform,P=_.width/E,M=_.height/E;this.flipEnabled()===!1?(K.translate(_.x,_.y),K.rotate(_.rotation),K.translate(_.width<0?_.width:0,_.height<0?_.height:0),K.scale(Math.abs(P),Math.abs(M))):(K.translate(_.x,_.y),K.rotate(_.rotation),K.scale(P,M));const X=K.multiply(V.invert());this._nodes.forEach(Z=>{var Q;const U=Z.getParent().getAbsoluteTransform(),z=Z.getTransform().copy();z.translate(Z.offsetX(),Z.offsetY());const q=new n.Transform;q.multiply(U.copy().invert()).multiply(X).multiply(U).multiply(z);const G=q.decompose();Z.setAttrs(G),(Q=Z.getLayer())===null||Q===void 0||Q.batchDraw()}),this.rotation(n.Util._getRotation(_.rotation)),this._nodes.forEach(Z=>{this._fire("transform",{evt:I,target:Z}),Z._fire("transform",{evt:I,target:Z})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(_,I){this.findOne(_).setAttrs(I)}update(){var _;const I=this._getNodeRect();this.rotation(n.Util._getRotation(I.rotation));const S=I.width,F=I.height,B=this.enabledAnchors(),E=this.resizeEnabled(),V=this.padding(),K=this.anchorSize(),P=this.find("._anchor");P.forEach(X=>{X.setAttrs({width:K,height:K,offsetX:K/2,offsetY:K/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:K/2+V,offsetY:K/2+V,visible:E&&B.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:S/2,y:0,offsetY:K/2+V,visible:E&&B.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:S,y:0,offsetX:K/2-V,offsetY:K/2+V,visible:E&&B.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:F/2,offsetX:K/2+V,visible:E&&B.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:S,y:F/2,offsetX:K/2-V,visible:E&&B.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:F,offsetX:K/2+V,offsetY:K/2-V,visible:E&&B.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:S/2,y:F,offsetY:K/2-V,visible:E&&B.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:S,y:F,offsetX:K/2-V,offsetY:K/2-V,visible:E&&B.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:S/2,y:-this.rotateAnchorOffset()*n.Util._sign(F)-V,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:S,height:F,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const M=this.anchorStyleFunc();M&&P.forEach(X=>{M(X)}),(_=this.getLayer())===null||_===void 0||_.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const _=this.findOne("."+this._movingAnchorName);_&&_.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),s.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return t.Node.prototype.toObject.call(this)}clone(_){return t.Node.prototype.clone.call(this,_)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};m2.Transformer=j,j.isTransforming=()=>T>0;function D(b){return b instanceof Array||n.Util.warn("enabledAnchors value should be an array"),b instanceof Array&&b.forEach(function(_){y.indexOf(_)===-1&&n.Util.warn("Unknown anchor name: "+_+". Available names are: "+y.join(", "))}),b||[]}return j.prototype.className="Transformer",(0,c._registerNode)(j),e.Factory.addGetterSetter(j,"enabledAnchors",y,D),e.Factory.addGetterSetter(j,"flipEnabled",!0,(0,a.getBooleanValidator)()),e.Factory.addGetterSetter(j,"resizeEnabled",!0),e.Factory.addGetterSetter(j,"anchorSize",10,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(j,"rotateEnabled",!0),e.Factory.addGetterSetter(j,"rotateLineVisible",!0),e.Factory.addGetterSetter(j,"rotationSnaps",[]),e.Factory.addGetterSetter(j,"rotateAnchorOffset",50,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(j,"rotateAnchorCursor","crosshair"),e.Factory.addGetterSetter(j,"rotationSnapTolerance",5,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(j,"borderEnabled",!0),e.Factory.addGetterSetter(j,"anchorStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(j,"anchorStrokeWidth",1,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(j,"anchorFill","white"),e.Factory.addGetterSetter(j,"anchorCornerRadius",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(j,"borderStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(j,"borderStrokeWidth",1,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(j,"borderDash"),e.Factory.addGetterSetter(j,"keepRatio",!0),e.Factory.addGetterSetter(j,"shiftBehavior","default"),e.Factory.addGetterSetter(j,"centeredScaling",!1),e.Factory.addGetterSetter(j,"ignoreStroke",!1),e.Factory.addGetterSetter(j,"padding",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(j,"nodes"),e.Factory.addGetterSetter(j,"node"),e.Factory.addGetterSetter(j,"boundBoxFunc"),e.Factory.addGetterSetter(j,"anchorDragBoundFunc"),e.Factory.addGetterSetter(j,"anchorStyleFunc"),e.Factory.addGetterSetter(j,"shouldOverdrawWholeArea",!1),e.Factory.addGetterSetter(j,"useSingleNodeRotation",!0),e.Factory.backCompat(j,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),m2}var y2={},GR;function Rze(){if(GR)return y2;GR=1,Object.defineProperty(y2,"__esModule",{value:!0}),y2.Wedge=void 0;const n=zr(),e=dl(),t=Ur(),i=Jr(),r=Ur();let s=class extends e.Shape{_sceneFunc(a){a.beginPath(),a.arc(0,0,this.radius(),0,t.Konva.getAngle(this.angle()),this.clockwise()),a.lineTo(0,0),a.closePath(),a.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(a){this.radius(a/2)}setHeight(a){this.radius(a/2)}};return y2.Wedge=s,s.prototype.className="Wedge",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radius"],(0,r._registerNode)(s),n.Factory.addGetterSetter(s,"radius",0,(0,i.getNumberValidator)()),n.Factory.addGetterSetter(s,"angle",0,(0,i.getNumberValidator)()),n.Factory.addGetterSetter(s,"clockwise",!1),n.Factory.backCompat(s,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),y2}var v2={},XR;function Oze(){if(XR)return v2;XR=1,Object.defineProperty(v2,"__esModule",{value:!0}),v2.Blur=void 0;const n=zr(),e=ga(),t=Jr();function i(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const r=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],s=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function o(c,h){const u=c.data,d=c.width,f=c.height;let A,g,p,y,v,m,w,x,T,j,D,b,_,I,S,F,B,E,V,K;const P=h+h+1,M=d-1,X=f-1,Z=h+1,Q=Z*(Z+1)/2,U=new i,z=r[h],q=s[h];let G=null,ie=U,H=null,se=null;for(let te=1;te<P;te++)ie=ie.next=new i,te===Z&&(G=ie);ie.next=U,p=g=0;for(let te=0;te<f;te++){b=_=I=S=y=v=m=w=0,x=Z*(F=u[g]),T=Z*(B=u[g+1]),j=Z*(E=u[g+2]),D=Z*(V=u[g+3]),y+=Q*F,v+=Q*B,m+=Q*E,w+=Q*V,ie=U;for(let fe=0;fe<Z;fe++)ie.r=F,ie.g=B,ie.b=E,ie.a=V,ie=ie.next;for(let fe=1;fe<Z;fe++)A=g+((M<fe?M:fe)<<2),y+=(ie.r=F=u[A])*(K=Z-fe),v+=(ie.g=B=u[A+1])*K,m+=(ie.b=E=u[A+2])*K,w+=(ie.a=V=u[A+3])*K,b+=F,_+=B,I+=E,S+=V,ie=ie.next;H=U,se=G;for(let fe=0;fe<d;fe++)u[g+3]=V=w*z>>q,V!==0?(V=255/V,u[g]=(y*z>>q)*V,u[g+1]=(v*z>>q)*V,u[g+2]=(m*z>>q)*V):u[g]=u[g+1]=u[g+2]=0,y-=x,v-=T,m-=j,w-=D,x-=H.r,T-=H.g,j-=H.b,D-=H.a,A=p+((A=fe+h+1)<M?A:M)<<2,b+=H.r=u[A],_+=H.g=u[A+1],I+=H.b=u[A+2],S+=H.a=u[A+3],y+=b,v+=_,m+=I,w+=S,H=H.next,x+=F=se.r,T+=B=se.g,j+=E=se.b,D+=V=se.a,b-=F,_-=B,I-=E,S-=V,se=se.next,g+=4;p+=d}for(let te=0;te<d;te++){_=I=S=b=v=m=w=y=0,g=te<<2,x=Z*(F=u[g]),T=Z*(B=u[g+1]),j=Z*(E=u[g+2]),D=Z*(V=u[g+3]),y+=Q*F,v+=Q*B,m+=Q*E,w+=Q*V,ie=U;for(let ye=0;ye<Z;ye++)ie.r=F,ie.g=B,ie.b=E,ie.a=V,ie=ie.next;let fe=d;for(let ye=1;ye<=h;ye++)g=fe+te<<2,y+=(ie.r=F=u[g])*(K=Z-ye),v+=(ie.g=B=u[g+1])*K,m+=(ie.b=E=u[g+2])*K,w+=(ie.a=V=u[g+3])*K,b+=F,_+=B,I+=E,S+=V,ie=ie.next,ye<X&&(fe+=d);g=te,H=U,se=G;for(let ye=0;ye<f;ye++)A=g<<2,u[A+3]=V=w*z>>q,V>0?(V=255/V,u[A]=(y*z>>q)*V,u[A+1]=(v*z>>q)*V,u[A+2]=(m*z>>q)*V):u[A]=u[A+1]=u[A+2]=0,y-=x,v-=T,m-=j,w-=D,x-=H.r,T-=H.g,j-=H.b,D-=H.a,A=te+((A=ye+Z)<X?A:X)*d<<2,y+=b+=H.r=u[A],v+=_+=H.g=u[A+1],m+=I+=H.b=u[A+2],w+=S+=H.a=u[A+3],H=H.next,x+=F=se.r,T+=B=se.g,j+=E=se.b,D+=V=se.a,b-=F,_-=B,I-=E,S-=V,se=se.next,g+=d}}const a=function(h){const u=Math.round(this.blurRadius());u>0&&o(h,u)};return v2.Blur=a,n.Factory.addGetterSetter(e.Node,"blurRadius",0,(0,t.getNumberValidator)(),n.Factory.afterSetFilter),v2}var w2={},KR;function Uze(){if(KR)return w2;KR=1,Object.defineProperty(w2,"__esModule",{value:!0}),w2.Brighten=void 0;const n=zr(),e=ga(),t=Jr(),i=function(r){const s=this.brightness()*255,o=r.data,a=o.length;for(let c=0;c<a;c+=4)o[c]+=s,o[c+1]+=s,o[c+2]+=s};return w2.Brighten=i,n.Factory.addGetterSetter(e.Node,"brightness",0,(0,t.getNumberValidator)(),n.Factory.afterSetFilter),w2}var x2={},qR;function Hze(){if(qR)return x2;qR=1,Object.defineProperty(x2,"__esModule",{value:!0}),x2.Contrast=void 0;const n=zr(),e=ga(),t=Jr(),i=function(r){const s=Math.pow((this.contrast()+100)/100,2),o=r.data,a=o.length;let c=150,h=150,u=150;for(let d=0;d<a;d+=4)c=o[d],h=o[d+1],u=o[d+2],c/=255,c-=.5,c*=s,c+=.5,c*=255,h/=255,h-=.5,h*=s,h+=.5,h*=255,u/=255,u-=.5,u*=s,u+=.5,u*=255,c=c<0?0:c>255?255:c,h=h<0?0:h>255?255:h,u=u<0?0:u>255?255:u,o[d]=c,o[d+1]=h,o[d+2]=u};return x2.Contrast=i,n.Factory.addGetterSetter(e.Node,"contrast",0,(0,t.getNumberValidator)(),n.Factory.afterSetFilter),x2}var b2={},YR;function Wze(){if(YR)return b2;YR=1,Object.defineProperty(b2,"__esModule",{value:!0}),b2.Emboss=void 0;const n=zr(),e=ga(),t=Zo(),i=Jr(),r=function(s){const o=this.embossStrength()*10,a=this.embossWhiteLevel()*255,c=this.embossDirection(),h=this.embossBlend(),u=s.data,d=s.width,f=s.height,A=d*4;let g=0,p=0,y=f;switch(c){case"top-left":g=-1,p=-1;break;case"top":g=-1,p=0;break;case"top-right":g=-1,p=1;break;case"right":g=0,p=1;break;case"bottom-right":g=1,p=1;break;case"bottom":g=1,p=0;break;case"bottom-left":g=1,p=-1;break;case"left":g=0,p=-1;break;default:t.Util.error("Unknown emboss direction: "+c)}do{const v=(y-1)*A;let m=g;y+m<1&&(m=0),y+m>f&&(m=0);const w=(y-1+m)*d*4;let x=d;do{const T=v+(x-1)*4;let j=p;x+j<1&&(j=0),x+j>d&&(j=0);const D=w+(x-1+j)*4,b=u[T]-u[D],_=u[T+1]-u[D+1],I=u[T+2]-u[D+2];let S=b;const F=S>0?S:-S,B=_>0?_:-_,E=I>0?I:-I;if(B>F&&(S=_),E>F&&(S=I),S*=o,h){const V=u[T]+S,K=u[T+1]+S,P=u[T+2]+S;u[T]=V>255?255:V<0?0:V,u[T+1]=K>255?255:K<0?0:K,u[T+2]=P>255?255:P<0?0:P}else{let V=a-S;V<0?V=0:V>255&&(V=255),u[T]=u[T+1]=u[T+2]=V}}while(--x)}while(--y)};return b2.Emboss=r,n.Factory.addGetterSetter(e.Node,"embossStrength",.5,(0,i.getNumberValidator)(),n.Factory.afterSetFilter),n.Factory.addGetterSetter(e.Node,"embossWhiteLevel",.5,(0,i.getNumberValidator)(),n.Factory.afterSetFilter),n.Factory.addGetterSetter(e.Node,"embossDirection","top-left",void 0,n.Factory.afterSetFilter),n.Factory.addGetterSetter(e.Node,"embossBlend",!1,void 0,n.Factory.afterSetFilter),b2}var _2={},ZR;function Qze(){if(ZR)return _2;ZR=1,Object.defineProperty(_2,"__esModule",{value:!0}),_2.Enhance=void 0;const n=zr(),e=ga(),t=Jr();function i(s,o,a,c,h){const u=a-o,d=h-c;if(u===0)return c+d/2;if(d===0)return c;let f=(s-o)/u;return f=d*f+c,f}const r=function(s){const o=s.data,a=o.length;let c=o[0],h=c,u,d=o[1],f=d,A,g=o[2],p=g,y;const v=this.enhance();if(v===0)return;for(let b=0;b<a;b+=4)u=o[b+0],u<c?c=u:u>h&&(h=u),A=o[b+1],A<d?d=A:A>f&&(f=A),y=o[b+2],y<g?g=y:y>p&&(p=y);h===c&&(h=255,c=0),f===d&&(f=255,d=0),p===g&&(p=255,g=0);let m,w,x,T,j,D;if(v>0)m=h+v*(255-h),w=c-v*(c-0),x=f+v*(255-f),T=d-v*(d-0),j=p+v*(255-p),D=g-v*(g-0);else{const b=(h+c)*.5;m=h+v*(h-b),w=c+v*(c-b);const _=(f+d)*.5;x=f+v*(f-_),T=d+v*(d-_);const I=(p+g)*.5;j=p+v*(p-I),D=g+v*(g-I)}for(let b=0;b<a;b+=4)o[b+0]=i(o[b+0],c,h,w,m),o[b+1]=i(o[b+1],d,f,T,x),o[b+2]=i(o[b+2],g,p,D,j)};return _2.Enhance=r,n.Factory.addGetterSetter(e.Node,"enhance",0,(0,t.getNumberValidator)(),n.Factory.afterSetFilter),_2}var C2={},JR;function $ze(){if(JR)return C2;JR=1,Object.defineProperty(C2,"__esModule",{value:!0}),C2.Grayscale=void 0;const n=function(e){const t=e.data,i=t.length;for(let r=0;r<i;r+=4){const s=.34*t[r]+.5*t[r+1]+.16*t[r+2];t[r]=s,t[r+1]=s,t[r+2]=s}};return C2.Grayscale=n,C2}var S2={},eO;function Vze(){if(eO)return S2;eO=1,Object.defineProperty(S2,"__esModule",{value:!0}),S2.HSL=void 0;const n=zr(),e=ga(),t=Jr();n.Factory.addGetterSetter(e.Node,"hue",0,(0,t.getNumberValidator)(),n.Factory.afterSetFilter),n.Factory.addGetterSetter(e.Node,"saturation",0,(0,t.getNumberValidator)(),n.Factory.afterSetFilter),n.Factory.addGetterSetter(e.Node,"luminance",0,(0,t.getNumberValidator)(),n.Factory.afterSetFilter);const i=function(r){const s=r.data,o=s.length,a=1,c=Math.pow(2,this.saturation()),h=Math.abs(this.hue()+360)%360,u=this.luminance()*127,d=a*c*Math.cos(h*Math.PI/180),f=a*c*Math.sin(h*Math.PI/180),A=.299*a+.701*d+.167*f,g=.587*a-.587*d+.33*f,p=.114*a-.114*d-.497*f,y=.299*a-.299*d-.328*f,v=.587*a+.413*d+.035*f,m=.114*a-.114*d+.293*f,w=.299*a-.3*d+1.25*f,x=.587*a-.586*d-1.05*f,T=.114*a+.886*d-.2*f;let j,D,b,_;for(let I=0;I<o;I+=4)j=s[I+0],D=s[I+1],b=s[I+2],_=s[I+3],s[I+0]=A*j+g*D+p*b+u,s[I+1]=y*j+v*D+m*b+u,s[I+2]=w*j+x*D+T*b+u,s[I+3]=_};return S2.HSL=i,S2}var T2={},tO;function zze(){if(tO)return T2;tO=1,Object.defineProperty(T2,"__esModule",{value:!0}),T2.HSV=void 0;const n=zr(),e=ga(),t=Jr(),i=function(r){const s=r.data,o=s.length,a=Math.pow(2,this.value()),c=Math.pow(2,this.saturation()),h=Math.abs(this.hue()+360)%360,u=a*c*Math.cos(h*Math.PI/180),d=a*c*Math.sin(h*Math.PI/180),f=.299*a+.701*u+.167*d,A=.587*a-.587*u+.33*d,g=.114*a-.114*u-.497*d,p=.299*a-.299*u-.328*d,y=.587*a+.413*u+.035*d,v=.114*a-.114*u+.293*d,m=.299*a-.3*u+1.25*d,w=.587*a-.586*u-1.05*d,x=.114*a+.886*u-.2*d;for(let T=0;T<o;T+=4){const j=s[T+0],D=s[T+1],b=s[T+2],_=s[T+3];s[T+0]=f*j+A*D+g*b,s[T+1]=p*j+y*D+v*b,s[T+2]=m*j+w*D+x*b,s[T+3]=_}};return T2.HSV=i,n.Factory.addGetterSetter(e.Node,"hue",0,(0,t.getNumberValidator)(),n.Factory.afterSetFilter),n.Factory.addGetterSetter(e.Node,"saturation",0,(0,t.getNumberValidator)(),n.Factory.afterSetFilter),n.Factory.addGetterSetter(e.Node,"value",0,(0,t.getNumberValidator)(),n.Factory.afterSetFilter),T2}var B2={},nO;function Gze(){if(nO)return B2;nO=1,Object.defineProperty(B2,"__esModule",{value:!0}),B2.Invert=void 0;const n=function(e){const t=e.data,i=t.length;for(let r=0;r<i;r+=4)t[r]=255-t[r],t[r+1]=255-t[r+1],t[r+2]=255-t[r+2]};return B2.Invert=n,B2}var E2={},iO;function Xze(){if(iO)return E2;iO=1,Object.defineProperty(E2,"__esModule",{value:!0}),E2.Kaleidoscope=void 0;const n=zr(),e=ga(),t=Zo(),i=Jr(),r=function(a,c,h){const u=a.data,d=c.data,f=a.width,A=a.height,g=h.polarCenterX||f/2,p=h.polarCenterY||A/2;let y=Math.sqrt(g*g+p*p),v=f-g,m=A-p;const w=Math.sqrt(v*v+m*m);y=w>y?w:y;const x=A,T=f,j=360/T*Math.PI/180;for(let D=0;D<T;D+=1){const b=Math.sin(D*j),_=Math.cos(D*j);for(let I=0;I<x;I+=1){v=Math.floor(g+y*I/x*_),m=Math.floor(p+y*I/x*b);let S=(m*f+v)*4;const F=u[S+0],B=u[S+1],E=u[S+2],V=u[S+3];S=(D+I*f)*4,d[S+0]=F,d[S+1]=B,d[S+2]=E,d[S+3]=V}}},s=function(a,c,h){const u=a.data,d=c.data,f=a.width,A=a.height,g=h.polarCenterX||f/2,p=h.polarCenterY||A/2;let y=Math.sqrt(g*g+p*p),v=f-g,m=A-p;const w=Math.sqrt(v*v+m*m);y=w>y?w:y;const x=A,T=f,j=0;let D,b;for(v=0;v<f;v+=1)for(m=0;m<A;m+=1){const _=v-g,I=m-p,S=Math.sqrt(_*_+I*I)*x/y;let F=(Math.atan2(I,_)*180/Math.PI+360+j)%360;F=F*T/360,D=Math.floor(F),b=Math.floor(S);let B=(b*f+D)*4;const E=u[B+0],V=u[B+1],K=u[B+2],P=u[B+3];B=(m*f+v)*4,d[B+0]=E,d[B+1]=V,d[B+2]=K,d[B+3]=P}},o=function(a){const c=a.width,h=a.height;let u,d,f,A,g,p,y,v,m,w,x=Math.round(this.kaleidoscopePower());const T=Math.round(this.kaleidoscopeAngle()),j=Math.floor(c*(T%360)/360);if(x<1)return;const D=t.Util.createCanvasElement();D.width=c,D.height=h;const b=D.getContext("2d").getImageData(0,0,c,h);t.Util.releaseCanvas(D),r(a,b,{polarCenterX:c/2,polarCenterY:h/2});let _=c/Math.pow(2,x);for(;_<=8;)_=_*2,x-=1;_=Math.ceil(_);let I=_,S=0,F=I,B=1;for(j+_>c&&(S=I,F=0,B=-1),d=0;d<h;d+=1)for(u=S;u!==F;u+=B)f=Math.round(u+j)%c,m=(c*d+f)*4,g=b.data[m+0],p=b.data[m+1],y=b.data[m+2],v=b.data[m+3],w=(c*d+u)*4,b.data[w+0]=g,b.data[w+1]=p,b.data[w+2]=y,b.data[w+3]=v;for(d=0;d<h;d+=1)for(I=Math.floor(_),A=0;A<x;A+=1){for(u=0;u<I+1;u+=1)m=(c*d+u)*4,g=b.data[m+0],p=b.data[m+1],y=b.data[m+2],v=b.data[m+3],w=(c*d+I*2-u-1)*4,b.data[w+0]=g,b.data[w+1]=p,b.data[w+2]=y,b.data[w+3]=v;I*=2}s(b,a,{})};return E2.Kaleidoscope=o,n.Factory.addGetterSetter(e.Node,"kaleidoscopePower",2,(0,i.getNumberValidator)(),n.Factory.afterSetFilter),n.Factory.addGetterSetter(e.Node,"kaleidoscopeAngle",0,(0,i.getNumberValidator)(),n.Factory.afterSetFilter),E2}var k2={},rO;function Kze(){if(rO)return k2;rO=1,Object.defineProperty(k2,"__esModule",{value:!0}),k2.Mask=void 0;const n=zr(),e=ga(),t=Jr();function i(f,A,g){let p=(g*f.width+A)*4;const y=[];return y.push(f.data[p++],f.data[p++],f.data[p++],f.data[p++]),y}function r(f,A){return Math.sqrt(Math.pow(f[0]-A[0],2)+Math.pow(f[1]-A[1],2)+Math.pow(f[2]-A[2],2))}function s(f){const A=[0,0,0];for(let g=0;g<f.length;g++)A[0]+=f[g][0],A[1]+=f[g][1],A[2]+=f[g][2];return A[0]/=f.length,A[1]/=f.length,A[2]/=f.length,A}function o(f,A){const g=i(f,0,0),p=i(f,f.width-1,0),y=i(f,0,f.height-1),v=i(f,f.width-1,f.height-1),m=A||10;if(r(g,p)<m&&r(p,v)<m&&r(v,y)<m&&r(y,g)<m){const w=s([p,g,v,y]),x=[];for(let T=0;T<f.width*f.height;T++){const j=r(w,[f.data[T*4],f.data[T*4+1],f.data[T*4+2]]);x[T]=j<m?0:255}return x}}function a(f,A){for(let g=0;g<f.width*f.height;g++)f.data[4*g+3]=A[g]}function c(f,A,g){const p=[1,1,1,1,0,1,1,1,1],y=Math.round(Math.sqrt(p.length)),v=Math.floor(y/2),m=[];for(let w=0;w<g;w++)for(let x=0;x<A;x++){const T=w*A+x;let j=0;for(let D=0;D<y;D++)for(let b=0;b<y;b++){const _=w+D-v,I=x+b-v;if(_>=0&&_<g&&I>=0&&I<A){const S=_*A+I,F=p[D*y+b];j+=f[S]*F}}m[T]=j===2040?255:0}return m}function h(f,A,g){const p=[1,1,1,1,1,1,1,1,1],y=Math.round(Math.sqrt(p.length)),v=Math.floor(y/2),m=[];for(let w=0;w<g;w++)for(let x=0;x<A;x++){const T=w*A+x;let j=0;for(let D=0;D<y;D++)for(let b=0;b<y;b++){const _=w+D-v,I=x+b-v;if(_>=0&&_<g&&I>=0&&I<A){const S=_*A+I,F=p[D*y+b];j+=f[S]*F}}m[T]=j>=1020?255:0}return m}function u(f,A,g){const p=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],y=Math.round(Math.sqrt(p.length)),v=Math.floor(y/2),m=[];for(let w=0;w<g;w++)for(let x=0;x<A;x++){const T=w*A+x;let j=0;for(let D=0;D<y;D++)for(let b=0;b<y;b++){const _=w+D-v,I=x+b-v;if(_>=0&&_<g&&I>=0&&I<A){const S=_*A+I,F=p[D*y+b];j+=f[S]*F}}m[T]=j}return m}const d=function(f){const A=this.threshold();let g=o(f,A);return g&&(g=c(g,f.width,f.height),g=h(g,f.width,f.height),g=u(g,f.width,f.height),a(f,g)),f};return k2.Mask=d,n.Factory.addGetterSetter(e.Node,"threshold",0,(0,t.getNumberValidator)(),n.Factory.afterSetFilter),k2}var I2={},sO;function qze(){if(sO)return I2;sO=1,Object.defineProperty(I2,"__esModule",{value:!0}),I2.Noise=void 0;const n=zr(),e=ga(),t=Jr(),i=function(r){const s=this.noise()*255,o=r.data,a=o.length,c=s/2;for(let h=0;h<a;h+=4)o[h+0]+=c-2*c*Math.random(),o[h+1]+=c-2*c*Math.random(),o[h+2]+=c-2*c*Math.random()};return I2.Noise=i,n.Factory.addGetterSetter(e.Node,"noise",.2,(0,t.getNumberValidator)(),n.Factory.afterSetFilter),I2}var F2={},oO;function Yze(){if(oO)return F2;oO=1,Object.defineProperty(F2,"__esModule",{value:!0}),F2.Pixelate=void 0;const n=zr(),e=Zo(),t=ga(),i=Jr(),r=function(s){let o=Math.ceil(this.pixelSize()),a=s.width,c=s.height,h=Math.ceil(a/o),u=Math.ceil(c/o),d=s.data;if(o<=0){e.Util.error("pixelSize value can not be <= 0");return}for(let f=0;f<h;f+=1)for(let A=0;A<u;A+=1){let g=0,p=0,y=0,v=0;const m=f*o,w=m+o,x=A*o,T=x+o;let j=0;for(let D=m;D<w;D+=1)if(!(D>=a))for(let b=x;b<T;b+=1){if(b>=c)continue;const _=(a*b+D)*4;g+=d[_+0],p+=d[_+1],y+=d[_+2],v+=d[_+3],j+=1}g=g/j,p=p/j,y=y/j,v=v/j;for(let D=m;D<w;D+=1)if(!(D>=a))for(let b=x;b<T;b+=1){if(b>=c)continue;const _=(a*b+D)*4;d[_+0]=g,d[_+1]=p,d[_+2]=y,d[_+3]=v}}};return F2.Pixelate=r,n.Factory.addGetterSetter(t.Node,"pixelSize",8,(0,i.getNumberValidator)(),n.Factory.afterSetFilter),F2}var D2={},aO;function Zze(){if(aO)return D2;aO=1,Object.defineProperty(D2,"__esModule",{value:!0}),D2.Posterize=void 0;const n=zr(),e=ga(),t=Jr(),i=function(r){const s=Math.round(this.levels()*254)+1,o=r.data,a=o.length,c=255/s;for(let h=0;h<a;h+=1)o[h]=Math.floor(o[h]/c)*c};return D2.Posterize=i,n.Factory.addGetterSetter(e.Node,"levels",.5,(0,t.getNumberValidator)(),n.Factory.afterSetFilter),D2}var j2={},lO;function Jze(){if(lO)return j2;lO=1,Object.defineProperty(j2,"__esModule",{value:!0}),j2.RGB=void 0;const n=zr(),e=ga(),t=Jr(),i=function(r){const s=r.data,o=s.length,a=this.red(),c=this.green(),h=this.blue();for(let u=0;u<o;u+=4){const d=(.34*s[u]+.5*s[u+1]+.16*s[u+2])/255;s[u]=d*a,s[u+1]=d*c,s[u+2]=d*h,s[u+3]=s[u+3]}};return j2.RGB=i,n.Factory.addGetterSetter(e.Node,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),n.Factory.addGetterSetter(e.Node,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),n.Factory.addGetterSetter(e.Node,"blue",0,t.RGBComponent,n.Factory.afterSetFilter),j2}var P2={},cO;function eGe(){if(cO)return P2;cO=1,Object.defineProperty(P2,"__esModule",{value:!0}),P2.RGBA=void 0;const n=zr(),e=ga(),t=Jr(),i=function(r){const s=r.data,o=s.length,a=this.red(),c=this.green(),h=this.blue(),u=this.alpha();for(let d=0;d<o;d+=4){const f=1-u;s[d]=a*u+s[d]*f,s[d+1]=c*u+s[d+1]*f,s[d+2]=h*u+s[d+2]*f}};return P2.RGBA=i,n.Factory.addGetterSetter(e.Node,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),n.Factory.addGetterSetter(e.Node,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)}),n.Factory.addGetterSetter(e.Node,"blue",0,t.RGBComponent,n.Factory.afterSetFilter),n.Factory.addGetterSetter(e.Node,"alpha",1,function(r){return this._filterUpToDate=!1,r>1?1:r<0?0:r}),P2}var N2={},hO;function tGe(){if(hO)return N2;hO=1,Object.defineProperty(N2,"__esModule",{value:!0}),N2.Sepia=void 0;const n=function(e){const t=e.data,i=t.length;for(let r=0;r<i;r+=4){const s=t[r+0],o=t[r+1],a=t[r+2];t[r+0]=Math.min(255,s*.393+o*.769+a*.189),t[r+1]=Math.min(255,s*.349+o*.686+a*.168),t[r+2]=Math.min(255,s*.272+o*.534+a*.131)}};return N2.Sepia=n,N2}var L2={},uO;function nGe(){if(uO)return L2;uO=1,Object.defineProperty(L2,"__esModule",{value:!0}),L2.Solarize=void 0;const n=function(e){const t=e.data,i=e.width,r=e.height,s=i*4;let o=r;do{const a=(o-1)*s;let c=i;do{const h=a+(c-1)*4;let u=t[h],d=t[h+1],f=t[h+2];u>127&&(u=255-u),d>127&&(d=255-d),f>127&&(f=255-f),t[h]=u,t[h+1]=d,t[h+2]=f}while(--c)}while(--o)};return L2.Solarize=n,L2}var M2={},dO;function iGe(){if(dO)return M2;dO=1,Object.defineProperty(M2,"__esModule",{value:!0}),M2.Threshold=void 0;const n=zr(),e=ga(),t=Jr(),i=function(r){const s=this.threshold()*255,o=r.data,a=o.length;for(let c=0;c<a;c+=1)o[c]=o[c]<s?0:255};return M2.Threshold=i,n.Factory.addGetterSetter(e.Node,"threshold",.5,(0,t.getNumberValidator)(),n.Factory.afterSetFilter),M2}var AO;function rGe(){if(AO)return Y1;AO=1,Object.defineProperty(Y1,"__esModule",{value:!0}),Y1.Konva=void 0;const n=V6(),e=Sze(),t=Bze(),i=Eze(),r=kze(),s=Ize(),o=Fze(),a=Mq(),c=g8(),h=Rq(),u=Dze(),d=jze(),f=Pze(),A=Nze(),g=Oq(),p=Lze(),y=Mze(),v=Rze(),m=Oze(),w=Uze(),x=Hze(),T=Wze(),j=Qze(),D=$ze(),b=Vze(),_=zze(),I=Gze(),S=Xze(),F=Kze(),B=qze(),E=Yze(),V=Zze(),K=Jze(),P=eGe(),M=tGe(),X=nGe(),Z=iGe();return Y1.Konva=n.Konva.Util._assign(n.Konva,{Arc:e.Arc,Arrow:t.Arrow,Circle:i.Circle,Ellipse:r.Ellipse,Image:s.Image,Label:o.Label,Tag:o.Tag,Line:a.Line,Path:c.Path,Rect:h.Rect,RegularPolygon:u.RegularPolygon,Ring:d.Ring,Sprite:f.Sprite,Star:A.Star,Text:g.Text,TextPath:p.TextPath,Transformer:y.Transformer,Wedge:v.Wedge,Filters:{Blur:m.Blur,Brighten:w.Brighten,Contrast:x.Contrast,Emboss:T.Emboss,Enhance:j.Enhance,Grayscale:D.Grayscale,HSL:b.HSL,HSV:_.HSV,Invert:I.Invert,Kaleidoscope:S.Kaleidoscope,Mask:F.Mask,Noise:B.Noise,Pixelate:E.Pixelate,Posterize:V.Posterize,RGB:K.RGB,RGBA:P.RGBA,Sepia:M.Sepia,Solarize:X.Solarize,Threshold:Z.Threshold}}),Y1}var sGe=d_.exports,fO;function oGe(){if(fO)return d_.exports;fO=1,Object.defineProperty(sGe,"__esModule",{value:!0});const n=rGe();return d_.exports=n.Konva,d_.exports}oGe();var Fb={exports:{}},pO;function aGe(){return pO||(pO=1,(function(n,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;var t=V6();Object.defineProperty(e,"Konva",{enumerable:!0,get:function(){return t.Konva}});const i=V6();n.exports=i.Konva})(Fb,Fb.exports)),Fb.exports}var lGe=aGe();const Ev=Kf(lGe);var nB={exports:{}},iB={exports:{}},rB={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gO;function cGe(){return gO||(gO=1,(function(n){function e(M,X){var Z=M.length;M.push(X);e:for(;0<Z;){var Q=Z-1>>>1,U=M[Q];if(0<r(U,X))M[Q]=X,M[Z]=U,Z=Q;else break e}}function t(M){return M.length===0?null:M[0]}function i(M){if(M.length===0)return null;var X=M[0],Z=M.pop();if(Z!==X){M[0]=Z;e:for(var Q=0,U=M.length,z=U>>>1;Q<z;){var q=2*(Q+1)-1,G=M[q],ie=q+1,H=M[ie];if(0>r(G,Z))ie<U&&0>r(H,G)?(M[Q]=H,M[ie]=Z,Q=ie):(M[Q]=G,M[q]=Z,Q=q);else if(ie<U&&0>r(H,Z))M[Q]=H,M[ie]=Z,Q=ie;else break e}}return X}function r(M,X){var Z=M.sortIndex-X.sortIndex;return Z!==0?Z:M.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var c=[],h=[],u=1,d=null,f=3,A=!1,g=!1,p=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(M){for(var X=t(h);X!==null;){if(X.callback===null)i(h);else if(X.startTime<=M)i(h),X.sortIndex=X.expirationTime,e(c,X);else break;X=t(h)}}function x(M){if(p=!1,w(M),!g)if(t(c)!==null)g=!0,K(T);else{var X=t(h);X!==null&&P(x,X.startTime-M)}}function T(M,X){g=!1,p&&(p=!1,v(b),b=-1),A=!0;var Z=f;try{for(w(X),d=t(c);d!==null&&(!(d.expirationTime>X)||M&&!S());){var Q=d.callback;if(typeof Q=="function"){d.callback=null,f=d.priorityLevel;var U=Q(d.expirationTime<=X);X=n.unstable_now(),typeof U=="function"?d.callback=U:d===t(c)&&i(c),w(X)}else i(c);d=t(c)}if(d!==null)var z=!0;else{var q=t(h);q!==null&&P(x,q.startTime-X),z=!1}return z}finally{d=null,f=Z,A=!1}}var j=!1,D=null,b=-1,_=5,I=-1;function S(){return!(n.unstable_now()-I<_)}function F(){if(D!==null){var M=n.unstable_now();I=M;var X=!0;try{X=D(!0,M)}finally{X?B():(j=!1,D=null)}}else j=!1}var B;if(typeof m=="function")B=function(){m(F)};else if(typeof MessageChannel<"u"){var E=new MessageChannel,V=E.port2;E.port1.onmessage=F,B=function(){V.postMessage(null)}}else B=function(){y(F,0)};function K(M){D=M,j||(j=!0,B())}function P(M,X){b=y(function(){M(n.unstable_now())},X)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(M){M.callback=null},n.unstable_continueExecution=function(){g||A||(g=!0,K(T))},n.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<M?Math.floor(1e3/M):5},n.unstable_getCurrentPriorityLevel=function(){return f},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(M){switch(f){case 1:case 2:case 3:var X=3;break;default:X=f}var Z=f;f=X;try{return M()}finally{f=Z}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(M,X){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var Z=f;f=M;try{return X()}finally{f=Z}},n.unstable_scheduleCallback=function(M,X,Z){var Q=n.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?Q+Z:Q):Z=Q,M){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=Z+U,M={id:u++,callback:X,priorityLevel:M,startTime:Z,expirationTime:U,sortIndex:-1},Z>Q?(M.sortIndex=Z,e(h,M),t(c)===null&&M===t(h)&&(p?(v(b),b=-1):p=!0,P(x,Z-Q))):(M.sortIndex=U,e(c,M),g||A||(g=!0,K(T))),M},n.unstable_shouldYield=S,n.unstable_wrapCallback=function(M){var X=f;return function(){var Z=f;f=X;try{return M.apply(this,arguments)}finally{f=Z}}}})(rB)),rB}var mO;function Uq(){return mO||(mO=1,iB.exports=cGe()),iB.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sB,yO;function hGe(){return yO||(yO=1,sB=function(e){var t={},i=PY(),r=Uq(),s=Object.assign;function o(C){for(var k="https://reactjs.org/docs/error-decoder.html?invariant="+C,R=1;R<arguments.length;R++)k+="&args[]="+encodeURIComponent(arguments[R]);return"Minified React error #"+C+"; visit "+k+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,c=Symbol.for("react.element"),h=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),g=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),v=Symbol.for("react.suspense_list"),m=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),x=Symbol.for("react.offscreen"),T=Symbol.iterator;function j(C){return C===null||typeof C!="object"?null:(C=T&&C[T]||C["@@iterator"],typeof C=="function"?C:null)}function D(C){if(C==null)return null;if(typeof C=="function")return C.displayName||C.name||null;if(typeof C=="string")return C;switch(C){case u:return"Fragment";case h:return"Portal";case f:return"Profiler";case d:return"StrictMode";case y:return"Suspense";case v:return"SuspenseList"}if(typeof C=="object")switch(C.$$typeof){case g:return(C.displayName||"Context")+".Consumer";case A:return(C._context.displayName||"Context")+".Provider";case p:var k=C.render;return C=C.displayName,C||(C=k.displayName||k.name||"",C=C!==""?"ForwardRef("+C+")":"ForwardRef"),C;case m:return k=C.displayName||null,k!==null?k:D(C.type)||"Memo";case w:k=C._payload,C=C._init;try{return D(C(k))}catch{}}return null}function b(C){var k=C.type;switch(C.tag){case 24:return"Cache";case 9:return(k.displayName||"Context")+".Consumer";case 10:return(k._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return C=k.render,C=C.displayName||C.name||"",k.displayName||(C!==""?"ForwardRef("+C+")":"ForwardRef");case 7:return"Fragment";case 5:return k;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return D(k);case 8:return k===d?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof k=="function")return k.displayName||k.name||null;if(typeof k=="string")return k}return null}function _(C){var k=C,R=C;if(C.alternate)for(;k.return;)k=k.return;else{C=k;do k=C,(k.flags&4098)!==0&&(R=k.return),C=k.return;while(C)}return k.tag===3?R:null}function I(C){if(_(C)!==C)throw Error(o(188))}function S(C){var k=C.alternate;if(!k){if(k=_(C),k===null)throw Error(o(188));return k!==C?null:C}for(var R=C,J=k;;){var re=R.return;if(re===null)break;var pe=re.alternate;if(pe===null){if(J=re.return,J!==null){R=J;continue}break}if(re.child===pe.child){for(pe=re.child;pe;){if(pe===R)return I(re),C;if(pe===J)return I(re),k;pe=pe.sibling}throw Error(o(188))}if(R.return!==J.return)R=re,J=pe;else{for(var ze=!1,Bt=re.child;Bt;){if(Bt===R){ze=!0,R=re,J=pe;break}if(Bt===J){ze=!0,J=re,R=pe;break}Bt=Bt.sibling}if(!ze){for(Bt=pe.child;Bt;){if(Bt===R){ze=!0,R=pe,J=re;break}if(Bt===J){ze=!0,J=pe,R=re;break}Bt=Bt.sibling}if(!ze)throw Error(o(189))}}if(R.alternate!==J)throw Error(o(190))}if(R.tag!==3)throw Error(o(188));return R.stateNode.current===R?C:k}function F(C){return C=S(C),C!==null?B(C):null}function B(C){if(C.tag===5||C.tag===6)return C;for(C=C.child;C!==null;){var k=B(C);if(k!==null)return k;C=C.sibling}return null}function E(C){if(C.tag===5||C.tag===6)return C;for(C=C.child;C!==null;){if(C.tag!==4){var k=E(C);if(k!==null)return k}C=C.sibling}return null}var V=Array.isArray,K=e.getPublicInstance,P=e.getRootHostContext,M=e.getChildHostContext,X=e.prepareForCommit,Z=e.resetAfterCommit,Q=e.createInstance,U=e.appendInitialChild,z=e.finalizeInitialChildren,q=e.prepareUpdate,G=e.shouldSetTextContent,ie=e.createTextInstance,H=e.scheduleTimeout,se=e.cancelTimeout,te=e.noTimeout,fe=e.isPrimaryRenderer,ye=e.supportsMutation,be=e.supportsPersistence,_e=e.supportsHydration,W=e.getInstanceFromNode,Y=e.preparePortalMount,ve=e.getCurrentEventPriority,ce=e.detachDeletedInstance,ne=e.supportsMicrotasks,he=e.scheduleMicrotask,xe=e.supportsTestSelectors,Te=e.findFiberRoot,Ce=e.getBoundingRect,Be=e.getTextContent,Ye=e.isHiddenSubtree,$e=e.matchAccessibilityRole,ot=e.setFocusIfFocusable,rt=e.setupIntersectionObserver,Ve=e.appendChild,We=e.appendChildToContainer,De=e.commitTextUpdate,Ge=e.commitMount,Re=e.commitUpdate,Ie=e.insertBefore,Le=e.insertInContainerBefore,et=e.removeChild,ct=e.removeChildFromContainer,mt=e.resetTextContent,je=e.hideInstance,le=e.hideTextInstance,Je=e.unhideInstance,ht=e.unhideTextInstance,ut=e.clearContainer,ft=e.cloneInstance,jt=e.createContainerChildSet,Wt=e.appendChildToContainerChildSet,Mt=e.finalizeContainerChildren,dn=e.replaceContainerChildren,on=e.cloneHiddenInstance,Et=e.cloneHiddenTextInstance,an=e.canHydrateInstance,Mn=e.canHydrateTextInstance,At=e.canHydrateSuspenseInstance,zt=e.isSuspenseInstancePending,Zt=e.isSuspenseInstanceFallback,$t=e.getSuspenseInstanceFallbackErrorDetails,Ht=e.registerSuspenseInstanceRetry,Lt=e.getNextHydratableSibling,dt=e.getFirstHydratableChild,at=e.getFirstHydratableChildWithinContainer,Ot=e.getFirstHydratableChildWithinSuspenseInstance,Cn=e.hydrateInstance,Rn=e.hydrateTextInstance,xn=e.hydrateSuspenseInstance,En=e.getNextHydratableInstanceAfterSuspenseInstance,Hn=e.commitHydratedContainer,Kn=e.commitHydratedSuspenseInstance,Ti=e.clearSuspenseBoundary,ti=e.clearSuspenseBoundaryFromContainer,ai=e.shouldDeleteUnhydratedTailInstances,Gi=e.didNotMatchHydratedContainerTextInstance,fi=e.didNotMatchHydratedTextInstance,Oi;function rn(C){if(Oi===void 0)try{throw Error()}catch(R){var k=R.stack.trim().match(/\n( *(at )?)/);Oi=k&&k[1]||""}return`
`+Oi+C}var $n=!1;function Fn(C,k){if(!C||$n)return"";$n=!0;var R=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(k)if(k=function(){throw Error()},Object.defineProperty(k.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(k,[])}catch(qn){var J=qn}Reflect.construct(C,[],k)}else{try{k.call()}catch(qn){J=qn}C.call(k.prototype)}else{try{throw Error()}catch(qn){J=qn}C()}}catch(qn){if(qn&&J&&typeof qn.stack=="string"){for(var re=qn.stack.split(`
`),pe=J.stack.split(`
`),ze=re.length-1,Bt=pe.length-1;1<=ze&&0<=Bt&&re[ze]!==pe[Bt];)Bt--;for(;1<=ze&&0<=Bt;ze--,Bt--)if(re[ze]!==pe[Bt]){if(ze!==1||Bt!==1)do if(ze--,Bt--,0>Bt||re[ze]!==pe[Bt]){var tn=`
`+re[ze].replace(" at new "," at ");return C.displayName&&tn.includes("<anonymous>")&&(tn=tn.replace("<anonymous>",C.displayName)),tn}while(1<=ze&&0<=Bt);break}}}finally{$n=!1,Error.prepareStackTrace=R}return(C=C?C.displayName||C.name:"")?rn(C):""}var pt=Object.prototype.hasOwnProperty,vt=[],kt=-1;function mn(C){return{current:C}}function sn(C){0>kt||(C.current=vt[kt],vt[kt]=null,kt--)}function bn(C,k){kt++,vt[kt]=C.current,C.current=k}var Li={},Wn=mn(Li),ui=mn(!1),Mi=Li;function Gn(C,k){var R=C.type.contextTypes;if(!R)return Li;var J=C.stateNode;if(J&&J.__reactInternalMemoizedUnmaskedChildContext===k)return J.__reactInternalMemoizedMaskedChildContext;var re={},pe;for(pe in R)re[pe]=k[pe];return J&&(C=C.stateNode,C.__reactInternalMemoizedUnmaskedChildContext=k,C.__reactInternalMemoizedMaskedChildContext=re),re}function Dn(C){return C=C.childContextTypes,C!=null}function li(){sn(ui),sn(Wn)}function en(C,k,R){if(Wn.current!==Li)throw Error(o(168));bn(Wn,k),bn(ui,R)}function Rt(C,k,R){var J=C.stateNode;if(k=k.childContextTypes,typeof J.getChildContext!="function")return R;J=J.getChildContext();for(var re in J)if(!(re in k))throw Error(o(108,b(C)||"Unknown",re));return s({},R,J)}function Xn(C){return C=(C=C.stateNode)&&C.__reactInternalMemoizedMergedChildContext||Li,Mi=Wn.current,bn(Wn,C),bn(ui,ui.current),!0}function Ui(C,k,R){var J=C.stateNode;if(!J)throw Error(o(169));R?(C=Rt(C,k,Mi),J.__reactInternalMemoizedMergedChildContext=C,sn(ui),sn(Wn),bn(Wn,C)):sn(ui),bn(ui,R)}var tt=Math.clz32?Math.clz32:Yn,Jt=Math.log,wn=Math.LN2;function Yn(C){return C>>>=0,C===0?32:31-(Jt(C)/wn|0)|0}var hi=64,Xt=4194304;function _i(C){switch(C&-C){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return C&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return C&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return C}}function Pr(C,k){var R=C.pendingLanes;if(R===0)return 0;var J=0,re=C.suspendedLanes,pe=C.pingedLanes,ze=R&268435455;if(ze!==0){var Bt=ze&~re;Bt!==0?J=_i(Bt):(pe&=ze,pe!==0&&(J=_i(pe)))}else ze=R&~re,ze!==0?J=_i(ze):pe!==0&&(J=_i(pe));if(J===0)return 0;if(k!==0&&k!==J&&(k&re)===0&&(re=J&-J,pe=k&-k,re>=pe||re===16&&(pe&4194240)!==0))return k;if((J&4)!==0&&(J|=R&16),k=C.entangledLanes,k!==0)for(C=C.entanglements,k&=J;0<k;)R=31-tt(k),re=1<<R,J|=C[R],k&=~re;return J}function ws(C,k){switch(C){case 1:case 2:case 4:return k+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return k+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Vi(C,k){for(var R=C.suspendedLanes,J=C.pingedLanes,re=C.expirationTimes,pe=C.pendingLanes;0<pe;){var ze=31-tt(pe),Bt=1<<ze,tn=re[ze];tn===-1?((Bt&R)===0||(Bt&J)!==0)&&(re[ze]=ws(Bt,k)):tn<=k&&(C.expiredLanes|=Bt),pe&=~Bt}}function br(C){return C=C.pendingLanes&-1073741825,C!==0?C:C&1073741824?1073741824:0}function _r(){var C=hi;return hi<<=1,(hi&4194240)===0&&(hi=64),C}function Qr(C){for(var k=[],R=0;31>R;R++)k.push(C);return k}function ue(C,k,R){C.pendingLanes|=k,k!==536870912&&(C.suspendedLanes=0,C.pingedLanes=0),C=C.eventTimes,k=31-tt(k),C[k]=R}function ke(C,k){var R=C.pendingLanes&~k;C.pendingLanes=k,C.suspendedLanes=0,C.pingedLanes=0,C.expiredLanes&=k,C.mutableReadLanes&=k,C.entangledLanes&=k,k=C.entanglements;var J=C.eventTimes;for(C=C.expirationTimes;0<R;){var re=31-tt(R),pe=1<<re;k[re]=0,J[re]=-1,C[re]=-1,R&=~pe}}function Me(C,k){var R=C.entangledLanes|=k;for(C=C.entanglements;R;){var J=31-tt(R),re=1<<J;re&k|C[J]&k&&(C[J]|=k),R&=~re}}var Oe=0;function nt(C){return C&=-C,1<C?4<C?(C&268435455)!==0?16:536870912:4:1}var gt=r.unstable_scheduleCallback,Ae=r.unstable_cancelCallback,me=r.unstable_shouldYield,Xe=r.unstable_requestPaint,qe=r.unstable_now,nn=r.unstable_ImmediatePriority,An=r.unstable_UserBlockingPriority,Ct=r.unstable_NormalPriority,kn=r.unstable_IdlePriority,fn=null,Qt=null;function Qn(C){if(Qt&&typeof Qt.onCommitFiberRoot=="function")try{Qt.onCommitFiberRoot(fn,C,void 0,(C.current.flags&128)===128)}catch{}}function Tn(C,k){return C===k&&(C!==0||1/C===1/k)||C!==C&&k!==k}var Nn=typeof Object.is=="function"?Object.is:Tn,pn=null,tr=!1,Nr=!1;function ks(C){pn===null?pn=[C]:pn.push(C)}function ko(C){tr=!0,ks(C)}function As(){if(!Nr&&pn!==null){Nr=!0;var C=0,k=Oe;try{var R=pn;for(Oe=1;C<R.length;C++){var J=R[C];do J=J(!0);while(J!==null)}pn=null,tr=!1}catch(re){throw pn!==null&&(pn=pn.slice(C+1)),gt(nn,As),re}finally{Oe=k,Nr=!1}}return null}var xo=[],ar=0,un=null,Vn=0,Ln=[],ee=0,we=null,He=1,lt="";function _t(C,k){xo[ar++]=Vn,xo[ar++]=un,un=C,Vn=k}function ln(C,k,R){Ln[ee++]=He,Ln[ee++]=lt,Ln[ee++]=we,we=C;var J=He;C=lt;var re=32-tt(J)-1;J&=~(1<<re),R+=1;var pe=32-tt(k)+re;if(30<pe){var ze=re-re%5;pe=(J&(1<<ze)-1).toString(32),J>>=ze,re-=ze,He=1<<32-tt(k)+re|R<<re|J,lt=pe+C}else He=1<<pe|R<<re|J,lt=C}function vn(C){C.return!==null&&(_t(C,1),ln(C,1,0))}function si(C){for(;C===un;)un=xo[--ar],xo[ar]=null,Vn=xo[--ar],xo[ar]=null;for(;C===we;)we=Ln[--ee],Ln[ee]=null,lt=Ln[--ee],Ln[ee]=null,He=Ln[--ee],Ln[ee]=null}var oi=null,Fi=null,pi=!1,Ir=!1,Hr=null;function Ns(C,k){var R=Sh(5,null,null,0);R.elementType="DELETED",R.stateNode=k,R.return=C,k=C.deletions,k===null?(C.deletions=[R],C.flags|=16):k.push(R)}function is(C,k){switch(C.tag){case 5:return k=an(k,C.type,C.pendingProps),k!==null?(C.stateNode=k,oi=C,Fi=dt(k),!0):!1;case 6:return k=Mn(k,C.pendingProps),k!==null?(C.stateNode=k,oi=C,Fi=null,!0):!1;case 13:if(k=At(k),k!==null){var R=we!==null?{id:He,overflow:lt}:null;return C.memoizedState={dehydrated:k,treeContext:R,retryLane:1073741824},R=Sh(18,null,null,0),R.stateNode=k,R.return=C,C.child=R,oi=C,Fi=null,!0}return!1;default:return!1}}function Js(C){return(C.mode&1)!==0&&(C.flags&128)===0}function fs(C){if(pi){var k=Fi;if(k){var R=k;if(!is(C,k)){if(Js(C))throw Error(o(418));k=Lt(R);var J=oi;k&&is(C,k)?Ns(J,R):(C.flags=C.flags&-4097|2,pi=!1,oi=C)}}else{if(Js(C))throw Error(o(418));C.flags=C.flags&-4097|2,pi=!1,oi=C}}}function Io(C){for(C=C.return;C!==null&&C.tag!==5&&C.tag!==3&&C.tag!==13;)C=C.return;oi=C}function Al(C){if(!_e||C!==oi)return!1;if(!pi)return Io(C),pi=!0,!1;if(C.tag!==3&&(C.tag!==5||ai(C.type)&&!G(C.type,C.memoizedProps))){var k=Fi;if(k){if(Js(C))throw bc(),Error(o(418));for(;k;)Ns(C,k),k=Lt(k)}}if(Io(C),C.tag===13){if(!_e)throw Error(o(316));if(C=C.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(o(317));Fi=En(C)}else Fi=oi?Lt(C.stateNode):null;return!0}function bc(){for(var C=Fi;C;)C=Lt(C)}function Qc(){_e&&(Fi=oi=null,Ir=pi=!1)}function $c(C){Hr===null?Hr=[C]:Hr.push(C)}var Fo=a.ReactCurrentBatchConfig;function Ba(C,k){if(Nn(C,k))return!0;if(typeof C!="object"||C===null||typeof k!="object"||k===null)return!1;var R=Object.keys(C),J=Object.keys(k);if(R.length!==J.length)return!1;for(J=0;J<R.length;J++){var re=R[J];if(!pt.call(k,re)||!Nn(C[re],k[re]))return!1}return!0}function Wu(C){switch(C.tag){case 5:return rn(C.type);case 16:return rn("Lazy");case 13:return rn("Suspense");case 19:return rn("SuspenseList");case 0:case 2:case 15:return C=Fn(C.type,!1),C;case 11:return C=Fn(C.type.render,!1),C;case 1:return C=Fn(C.type,!0),C;default:return""}}function Ea(C,k,R){if(C=R.ref,C!==null&&typeof C!="function"&&typeof C!="object"){if(R._owner){if(R=R._owner,R){if(R.tag!==1)throw Error(o(309));var J=R.stateNode}if(!J)throw Error(o(147,C));var re=J,pe=""+C;return k!==null&&k.ref!==null&&typeof k.ref=="function"&&k.ref._stringRef===pe?k.ref:(k=function(ze){var Bt=re.refs;ze===null?delete Bt[pe]:Bt[pe]=ze},k._stringRef=pe,k)}if(typeof C!="string")throw Error(o(284));if(!R._owner)throw Error(o(290,C))}return C}function L(C,k){throw C=Object.prototype.toString.call(k),Error(o(31,C==="[object Object]"?"object with keys {"+Object.keys(k).join(", ")+"}":C))}function ae(C){var k=C._init;return k(C._payload)}function ge(C){function k(qt,Dt){if(C){var hn=qt.deletions;hn===null?(qt.deletions=[Dt],qt.flags|=16):hn.push(Dt)}}function R(qt,Dt){if(!C)return null;for(;Dt!==null;)k(qt,Dt),Dt=Dt.sibling;return null}function J(qt,Dt){for(qt=new Map;Dt!==null;)Dt.key!==null?qt.set(Dt.key,Dt):qt.set(Dt.index,Dt),Dt=Dt.sibling;return qt}function re(qt,Dt){return qt=zA(qt,Dt),qt.index=0,qt.sibling=null,qt}function pe(qt,Dt,hn){return qt.index=hn,C?(hn=qt.alternate,hn!==null?(hn=hn.index,hn<Dt?(qt.flags|=2,Dt):hn):(qt.flags|=2,Dt)):(qt.flags|=1048576,Dt)}function ze(qt){return C&&qt.alternate===null&&(qt.flags|=2),qt}function Bt(qt,Dt,hn,mi){return Dt===null||Dt.tag!==6?(Dt=TS(hn,qt.mode,mi),Dt.return=qt,Dt):(Dt=re(Dt,hn),Dt.return=qt,Dt)}function tn(qt,Dt,hn,mi){var Yi=hn.type;return Yi===u?ki(qt,Dt,hn.props.children,mi,hn.key):Dt!==null&&(Dt.elementType===Yi||typeof Yi=="object"&&Yi!==null&&Yi.$$typeof===w&&ae(Yi)===Dt.type)?(mi=re(Dt,hn.props),mi.ref=Ea(qt,Dt,hn),mi.return=qt,mi):(mi=Rw(hn.type,hn.key,hn.props,null,qt.mode,mi),mi.ref=Ea(qt,Dt,hn),mi.return=qt,mi)}function qn(qt,Dt,hn,mi){return Dt===null||Dt.tag!==4||Dt.stateNode.containerInfo!==hn.containerInfo||Dt.stateNode.implementation!==hn.implementation?(Dt=BS(hn,qt.mode,mi),Dt.return=qt,Dt):(Dt=re(Dt,hn.children||[]),Dt.return=qt,Dt)}function ki(qt,Dt,hn,mi,Yi){return Dt===null||Dt.tag!==7?(Dt=wp(hn,qt.mode,mi,Yi),Dt.return=qt,Dt):(Dt=re(Dt,hn),Dt.return=qt,Dt)}function Cr(qt,Dt,hn){if(typeof Dt=="string"&&Dt!==""||typeof Dt=="number")return Dt=TS(""+Dt,qt.mode,hn),Dt.return=qt,Dt;if(typeof Dt=="object"&&Dt!==null){switch(Dt.$$typeof){case c:return hn=Rw(Dt.type,Dt.key,Dt.props,null,qt.mode,hn),hn.ref=Ea(qt,null,Dt),hn.return=qt,hn;case h:return Dt=BS(Dt,qt.mode,hn),Dt.return=qt,Dt;case w:var mi=Dt._init;return Cr(qt,mi(Dt._payload),hn)}if(V(Dt)||j(Dt))return Dt=wp(Dt,qt.mode,hn,null),Dt.return=qt,Dt;L(qt,Dt)}return null}function gi(qt,Dt,hn,mi){var Yi=Dt!==null?Dt.key:null;if(typeof hn=="string"&&hn!==""||typeof hn=="number")return Yi!==null?null:Bt(qt,Dt,""+hn,mi);if(typeof hn=="object"&&hn!==null){switch(hn.$$typeof){case c:return hn.key===Yi?tn(qt,Dt,hn,mi):null;case h:return hn.key===Yi?qn(qt,Dt,hn,mi):null;case w:return Yi=hn._init,gi(qt,Dt,Yi(hn._payload),mi)}if(V(hn)||j(hn))return Yi!==null?null:ki(qt,Dt,hn,mi,null);L(qt,hn)}return null}function go(qt,Dt,hn,mi,Yi){if(typeof mi=="string"&&mi!==""||typeof mi=="number")return qt=qt.get(hn)||null,Bt(Dt,qt,""+mi,Yi);if(typeof mi=="object"&&mi!==null){switch(mi.$$typeof){case c:return qt=qt.get(mi.key===null?hn:mi.key)||null,tn(Dt,qt,mi,Yi);case h:return qt=qt.get(mi.key===null?hn:mi.key)||null,qn(Dt,qt,mi,Yi);case w:var Dr=mi._init;return go(qt,Dt,hn,Dr(mi._payload),Yi)}if(V(mi)||j(mi))return qt=qt.get(hn)||null,ki(Dt,qt,mi,Yi,null);L(Dt,mi)}return null}function Ws(qt,Dt,hn,mi){for(var Yi=null,Dr=null,Sr=Dt,ys=Dt=0,Ja=null;Sr!==null&&ys<hn.length;ys++){Sr.index>ys?(Ja=Sr,Sr=null):Ja=Sr.sibling;var vs=gi(qt,Sr,hn[ys],mi);if(vs===null){Sr===null&&(Sr=Ja);break}C&&Sr&&vs.alternate===null&&k(qt,Sr),Dt=pe(vs,Dt,ys),Dr===null?Yi=vs:Dr.sibling=vs,Dr=vs,Sr=Ja}if(ys===hn.length)return R(qt,Sr),pi&&_t(qt,ys),Yi;if(Sr===null){for(;ys<hn.length;ys++)Sr=Cr(qt,hn[ys],mi),Sr!==null&&(Dt=pe(Sr,Dt,ys),Dr===null?Yi=Sr:Dr.sibling=Sr,Dr=Sr);return pi&&_t(qt,ys),Yi}for(Sr=J(qt,Sr);ys<hn.length;ys++)Ja=go(Sr,qt,ys,hn[ys],mi),Ja!==null&&(C&&Ja.alternate!==null&&Sr.delete(Ja.key===null?ys:Ja.key),Dt=pe(Ja,Dt,ys),Dr===null?Yi=Ja:Dr.sibling=Ja,Dr=Ja);return C&&Sr.forEach(function(GA){return k(qt,GA)}),pi&&_t(qt,ys),Yi}function Ec(qt,Dt,hn,mi){var Yi=j(hn);if(typeof Yi!="function")throw Error(o(150));if(hn=Yi.call(hn),hn==null)throw Error(o(151));for(var Dr=Yi=null,Sr=Dt,ys=Dt=0,Ja=null,vs=hn.next();Sr!==null&&!vs.done;ys++,vs=hn.next()){Sr.index>ys?(Ja=Sr,Sr=null):Ja=Sr.sibling;var GA=gi(qt,Sr,vs.value,mi);if(GA===null){Sr===null&&(Sr=Ja);break}C&&Sr&&GA.alternate===null&&k(qt,Sr),Dt=pe(GA,Dt,ys),Dr===null?Yi=GA:Dr.sibling=GA,Dr=GA,Sr=Ja}if(vs.done)return R(qt,Sr),pi&&_t(qt,ys),Yi;if(Sr===null){for(;!vs.done;ys++,vs=hn.next())vs=Cr(qt,vs.value,mi),vs!==null&&(Dt=pe(vs,Dt,ys),Dr===null?Yi=vs:Dr.sibling=vs,Dr=vs);return pi&&_t(qt,ys),Yi}for(Sr=J(qt,Sr);!vs.done;ys++,vs=hn.next())vs=go(Sr,qt,ys,vs.value,mi),vs!==null&&(C&&vs.alternate!==null&&Sr.delete(vs.key===null?ys:vs.key),Dt=pe(vs,Dt,ys),Dr===null?Yi=vs:Dr.sibling=vs,Dr=vs);return C&&Sr.forEach(function(xY){return k(qt,xY)}),pi&&_t(qt,ys),Yi}function Od(qt,Dt,hn,mi){if(typeof hn=="object"&&hn!==null&&hn.type===u&&hn.key===null&&(hn=hn.props.children),typeof hn=="object"&&hn!==null){switch(hn.$$typeof){case c:e:{for(var Yi=hn.key,Dr=Dt;Dr!==null;){if(Dr.key===Yi){if(Yi=hn.type,Yi===u){if(Dr.tag===7){R(qt,Dr.sibling),Dt=re(Dr,hn.props.children),Dt.return=qt,qt=Dt;break e}}else if(Dr.elementType===Yi||typeof Yi=="object"&&Yi!==null&&Yi.$$typeof===w&&ae(Yi)===Dr.type){R(qt,Dr.sibling),Dt=re(Dr,hn.props),Dt.ref=Ea(qt,Dr,hn),Dt.return=qt,qt=Dt;break e}R(qt,Dr);break}else k(qt,Dr);Dr=Dr.sibling}hn.type===u?(Dt=wp(hn.props.children,qt.mode,mi,hn.key),Dt.return=qt,qt=Dt):(mi=Rw(hn.type,hn.key,hn.props,null,qt.mode,mi),mi.ref=Ea(qt,Dt,hn),mi.return=qt,qt=mi)}return ze(qt);case h:e:{for(Dr=hn.key;Dt!==null;){if(Dt.key===Dr)if(Dt.tag===4&&Dt.stateNode.containerInfo===hn.containerInfo&&Dt.stateNode.implementation===hn.implementation){R(qt,Dt.sibling),Dt=re(Dt,hn.children||[]),Dt.return=qt,qt=Dt;break e}else{R(qt,Dt);break}else k(qt,Dt);Dt=Dt.sibling}Dt=BS(hn,qt.mode,mi),Dt.return=qt,qt=Dt}return ze(qt);case w:return Dr=hn._init,Od(qt,Dt,Dr(hn._payload),mi)}if(V(hn))return Ws(qt,Dt,hn,mi);if(j(hn))return Ec(qt,Dt,hn,mi);L(qt,hn)}return typeof hn=="string"&&hn!==""||typeof hn=="number"?(hn=""+hn,Dt!==null&&Dt.tag===6?(R(qt,Dt.sibling),Dt=re(Dt,hn),Dt.return=qt,qt=Dt):(R(qt,Dt),Dt=TS(hn,qt.mode,mi),Dt.return=qt,qt=Dt),ze(qt)):R(qt,Dt)}return Od}var Ne=ge(!0),Ft=ge(!1),Kt=mn(null),Pn=null,Lr=null,Ls=null;function Fr(){Ls=Lr=Pn=null}function Mr(C,k,R){fe?(bn(Kt,k._currentValue),k._currentValue=R):(bn(Kt,k._currentValue2),k._currentValue2=R)}function cs(C){var k=Kt.current;sn(Kt),fe?C._currentValue=k:C._currentValue2=k}function Nl(C,k,R){for(;C!==null;){var J=C.alternate;if((C.childLanes&k)!==k?(C.childLanes|=k,J!==null&&(J.childLanes|=k)):J!==null&&(J.childLanes&k)!==k&&(J.childLanes|=k),C===R)break;C=C.return}}function bo(C,k){Pn=C,Ls=Lr=null,C=C.dependencies,C!==null&&C.firstContext!==null&&((C.lanes&k)!==0&&(pl=!0),C.firstContext=null)}function eo(C){var k=fe?C._currentValue:C._currentValue2;if(Ls!==C)if(C={context:C,memoizedValue:k,next:null},Lr===null){if(Pn===null)throw Error(o(308));Lr=C,Pn.dependencies={lanes:0,firstContext:C}}else Lr=Lr.next=C;return k}var Qa=null;function $a(C){Qa===null?Qa=[C]:Qa.push(C)}function fl(C,k,R,J){var re=k.interleaved;return re===null?(R.next=R,$a(k)):(R.next=re.next,re.next=R),k.interleaved=R,Va(C,J)}function Va(C,k){C.lanes|=k;var R=C.alternate;for(R!==null&&(R.lanes|=k),R=C,C=C.return;C!==null;)C.childLanes|=k,R=C.alternate,R!==null&&(R.childLanes|=k),R=C,C=C.return;return R.tag===3?R.stateNode:null}var ka=!1;function gh(C){C.updateQueue={baseState:C.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function NA(C,k){C=C.updateQueue,k.updateQueue===C&&(k.updateQueue={baseState:C.baseState,firstBaseUpdate:C.firstBaseUpdate,lastBaseUpdate:C.lastBaseUpdate,shared:C.shared,effects:C.effects})}function za(C,k){return{eventTime:C,lane:k,tag:0,payload:null,callback:null,next:null}}function Ss(C,k,R){var J=C.updateQueue;if(J===null)return null;if(J=J.shared,(Ar&2)!==0){var re=J.pending;return re===null?k.next=k:(k.next=re.next,re.next=k),J.pending=k,Va(C,R)}return re=J.interleaved,re===null?(k.next=k,$a(J)):(k.next=re.next,re.next=k),J.interleaved=k,Va(C,R)}function LA(C,k,R){if(k=k.updateQueue,k!==null&&(k=k.shared,(R&4194240)!==0)){var J=k.lanes;J&=C.pendingLanes,R|=J,k.lanes=R,Me(C,R)}}function Vc(C,k){var R=C.updateQueue,J=C.alternate;if(J!==null&&(J=J.updateQueue,R===J)){var re=null,pe=null;if(R=R.firstBaseUpdate,R!==null){do{var ze={eventTime:R.eventTime,lane:R.lane,tag:R.tag,payload:R.payload,callback:R.callback,next:null};pe===null?re=pe=ze:pe=pe.next=ze,R=R.next}while(R!==null);pe===null?re=pe=k:pe=pe.next=k}else re=pe=k;R={baseState:J.baseState,firstBaseUpdate:re,lastBaseUpdate:pe,shared:J.shared,effects:J.effects},C.updateQueue=R;return}C=R.lastBaseUpdate,C===null?R.firstBaseUpdate=k:C.next=k,R.lastBaseUpdate=k}function nc(C,k,R,J){var re=C.updateQueue;ka=!1;var pe=re.firstBaseUpdate,ze=re.lastBaseUpdate,Bt=re.shared.pending;if(Bt!==null){re.shared.pending=null;var tn=Bt,qn=tn.next;tn.next=null,ze===null?pe=qn:ze.next=qn,ze=tn;var ki=C.alternate;ki!==null&&(ki=ki.updateQueue,Bt=ki.lastBaseUpdate,Bt!==ze&&(Bt===null?ki.firstBaseUpdate=qn:Bt.next=qn,ki.lastBaseUpdate=tn))}if(pe!==null){var Cr=re.baseState;ze=0,ki=qn=tn=null,Bt=pe;do{var gi=Bt.lane,go=Bt.eventTime;if((J&gi)===gi){ki!==null&&(ki=ki.next={eventTime:go,lane:0,tag:Bt.tag,payload:Bt.payload,callback:Bt.callback,next:null});e:{var Ws=C,Ec=Bt;switch(gi=k,go=R,Ec.tag){case 1:if(Ws=Ec.payload,typeof Ws=="function"){Cr=Ws.call(go,Cr,gi);break e}Cr=Ws;break e;case 3:Ws.flags=Ws.flags&-65537|128;case 0:if(Ws=Ec.payload,gi=typeof Ws=="function"?Ws.call(go,Cr,gi):Ws,gi==null)break e;Cr=s({},Cr,gi);break e;case 2:ka=!0}}Bt.callback!==null&&Bt.lane!==0&&(C.flags|=64,gi=re.effects,gi===null?re.effects=[Bt]:gi.push(Bt))}else go={eventTime:go,lane:gi,tag:Bt.tag,payload:Bt.payload,callback:Bt.callback,next:null},ki===null?(qn=ki=go,tn=Cr):ki=ki.next=go,ze|=gi;if(Bt=Bt.next,Bt===null){if(Bt=re.shared.pending,Bt===null)break;gi=Bt,Bt=gi.next,gi.next=null,re.lastBaseUpdate=gi,re.shared.pending=null}}while(!0);if(ki===null&&(tn=Cr),re.baseState=tn,re.firstBaseUpdate=qn,re.lastBaseUpdate=ki,k=re.shared.interleaved,k!==null){re=k;do ze|=re.lane,re=re.next;while(re!==k)}else pe===null&&(re.shared.lanes=0);Nd|=ze,C.lanes=ze,C.memoizedState=Cr}}function Fd(C,k,R){if(C=k.effects,k.effects=null,C!==null)for(k=0;k<C.length;k++){var J=C[k],re=J.callback;if(re!==null){if(J.callback=null,J=R,typeof re!="function")throw Error(o(191,re));re.call(J)}}}var Zh={},Ia=mn(Zh),mh=mn(Zh),_c=mn(Zh);function Ga(C){if(C===Zh)throw Error(o(174));return C}function zc(C,k){bn(_c,k),bn(mh,C),bn(Ia,Zh),C=P(k),sn(Ia),bn(Ia,C)}function yh(){sn(Ia),sn(mh),sn(_c)}function Ll(C){var k=Ga(_c.current),R=Ga(Ia.current);k=M(R,C.type,k),R!==k&&(bn(mh,C),bn(Ia,k))}function Cc(C){mh.current===C&&(sn(Ia),sn(mh))}var er=mn(0);function xs(C){for(var k=C;k!==null;){if(k.tag===13){var R=k.memoizedState;if(R!==null&&(R=R.dehydrated,R===null||zt(R)||Zt(R)))return k}else if(k.tag===19&&k.memoizedProps.revealOrder!==void 0){if((k.flags&128)!==0)return k}else if(k.child!==null){k.child.return=k,k=k.child;continue}if(k===C)break;for(;k.sibling===null;){if(k.return===null||k.return===C)return null;k=k.return}k.sibling.return=k.return,k=k.sibling}return null}var co=[];function ho(){for(var C=0;C<co.length;C++){var k=co[C];fe?k._workInProgressVersionPrimary=null:k._workInProgressVersionSecondary=null}co.length=0}var Sc=a.ReactCurrentDispatcher,Qu=a.ReactCurrentBatchConfig,Xa=0,Is=null,Mo=null,Jo=null,ap=!1,MA=!1,RA=0,yw=0;function Fa(){throw Error(o(321))}function Mg(C,k){if(k===null)return!1;for(var R=0;R<k.length&&R<C.length;R++)if(!Nn(C[R],k[R]))return!1;return!0}function Rg(C,k,R,J,re,pe){if(Xa=pe,Is=k,k.memoizedState=null,k.updateQueue=null,k.lanes=0,Sc.current=C===null||C.memoizedState===null?y1:dp,C=R(J,re),MA){pe=0;do{if(MA=!1,RA=0,25<=pe)throw Error(o(301));pe+=1,Jo=Mo=null,k.updateQueue=null,Sc.current=bS,C=R(J,re)}while(MA)}if(Sc.current=UA,k=Mo!==null&&Mo.next!==null,Xa=0,Jo=Mo=Is=null,ap=!1,k)throw Error(o(300));return C}function Og(){var C=RA!==0;return RA=0,C}function Gc(){var C={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jo===null?Is.memoizedState=Jo=C:Jo=Jo.next=C,Jo}function ic(){if(Mo===null){var C=Is.alternate;C=C!==null?C.memoizedState:null}else C=Mo.next;var k=Jo===null?Is.memoizedState:Jo.next;if(k!==null)Jo=k,Mo=C;else{if(C===null)throw Error(o(310));Mo=C,C={memoizedState:Mo.memoizedState,baseState:Mo.baseState,baseQueue:Mo.baseQueue,queue:Mo.queue,next:null},Jo===null?Is.memoizedState=Jo=C:Jo=Jo.next=C}return Jo}function Jh(C,k){return typeof k=="function"?k(C):k}function Ug(C){var k=ic(),R=k.queue;if(R===null)throw Error(o(311));R.lastRenderedReducer=C;var J=Mo,re=J.baseQueue,pe=R.pending;if(pe!==null){if(re!==null){var ze=re.next;re.next=pe.next,pe.next=ze}J.baseQueue=re=pe,R.pending=null}if(re!==null){pe=re.next,J=J.baseState;var Bt=ze=null,tn=null,qn=pe;do{var ki=qn.lane;if((Xa&ki)===ki)tn!==null&&(tn=tn.next={lane:0,action:qn.action,hasEagerState:qn.hasEagerState,eagerState:qn.eagerState,next:null}),J=qn.hasEagerState?qn.eagerState:C(J,qn.action);else{var Cr={lane:ki,action:qn.action,hasEagerState:qn.hasEagerState,eagerState:qn.eagerState,next:null};tn===null?(Bt=tn=Cr,ze=J):tn=tn.next=Cr,Is.lanes|=ki,Nd|=ki}qn=qn.next}while(qn!==null&&qn!==pe);tn===null?ze=J:tn.next=Bt,Nn(J,k.memoizedState)||(pl=!0),k.memoizedState=J,k.baseState=ze,k.baseQueue=tn,R.lastRenderedState=J}if(C=R.interleaved,C!==null){re=C;do pe=re.lane,Is.lanes|=pe,Nd|=pe,re=re.next;while(re!==C)}else re===null&&(R.lanes=0);return[k.memoizedState,R.dispatch]}function Hg(C){var k=ic(),R=k.queue;if(R===null)throw Error(o(311));R.lastRenderedReducer=C;var J=R.dispatch,re=R.pending,pe=k.memoizedState;if(re!==null){R.pending=null;var ze=re=re.next;do pe=C(pe,ze.action),ze=ze.next;while(ze!==re);Nn(pe,k.memoizedState)||(pl=!0),k.memoizedState=pe,k.baseQueue===null&&(k.baseState=pe),R.lastRenderedState=pe}return[pe,J]}function c1(){}function h1(C,k){var R=Is,J=ic(),re=k(),pe=!Nn(J.memoizedState,re);if(pe&&(J.memoizedState=re,pl=!0),J=J.queue,OA(A1.bind(null,R,J,C),[C]),J.getSnapshot!==k||pe||Jo!==null&&Jo.memoizedState.tag&1){if(R.flags|=2048,Da(9,d1.bind(null,R,J,re,k),void 0,null),Ms===null)throw Error(o(349));(Xa&30)!==0||u1(R,k,re)}return re}function u1(C,k,R){C.flags|=16384,C={getSnapshot:k,value:R},k=Is.updateQueue,k===null?(k={lastEffect:null,stores:null},Is.updateQueue=k,k.stores=[C]):(R=k.stores,R===null?k.stores=[C]:R.push(C))}function d1(C,k,R,J){k.value=R,k.getSnapshot=J,f1(k)&&Wg(C)}function A1(C,k,R){return R(function(){f1(k)&&Wg(C)})}function f1(C){var k=C.getSnapshot;C=C.value;try{var R=k();return!Nn(C,R)}catch{return!0}}function Wg(C){var k=Va(C,1);k!==null&&Bc(k,C,1,-1)}function lp(C){var k=Gc();return typeof C=="function"&&(C=C()),k.memoizedState=k.baseState=C,C={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Jh,lastRenderedState:C},k.queue=C,C=C.dispatch=xS.bind(null,Is,C),[k.memoizedState,C]}function Da(C,k,R,J){return C={tag:C,create:k,destroy:R,deps:J,next:null},k=Is.updateQueue,k===null?(k={lastEffect:null,stores:null},Is.updateQueue=k,k.lastEffect=C.next=C):(R=k.lastEffect,R===null?k.lastEffect=C.next=C:(J=R.next,R.next=C,C.next=J,k.lastEffect=C)),C}function rc(){return ic().memoizedState}function Dd(C,k,R,J){var re=Gc();Is.flags|=C,re.memoizedState=Da(1|k,R,void 0,J===void 0?null:J)}function jd(C,k,R,J){var re=ic();J=J===void 0?null:J;var pe=void 0;if(Mo!==null){var ze=Mo.memoizedState;if(pe=ze.destroy,J!==null&&Mg(J,ze.deps)){re.memoizedState=Da(k,R,pe,J);return}}Is.flags|=C,re.memoizedState=Da(1|k,R,pe,J)}function p1(C,k){return Dd(8390656,8,C,k)}function OA(C,k){return jd(2048,8,C,k)}function cp(C,k){return jd(4,2,C,k)}function Qg(C,k){return jd(4,4,C,k)}function g1(C,k){if(typeof k=="function")return C=C(),k(C),function(){k(null)};if(k!=null)return C=C(),k.current=C,function(){k.current=null}}function $g(C,k,R){return R=R!=null?R.concat([C]):null,jd(4,4,g1.bind(null,k,C),R)}function hp(){}function up(C,k){var R=ic();k=k===void 0?null:k;var J=R.memoizedState;return J!==null&&k!==null&&Mg(k,J[1])?J[0]:(R.memoizedState=[C,k],C)}function Vg(C,k){var R=ic();k=k===void 0?null:k;var J=R.memoizedState;return J!==null&&k!==null&&Mg(k,J[1])?J[0]:(C=C(),R.memoizedState=[C,k],C)}function vw(C,k,R){return(Xa&21)===0?(C.baseState&&(C.baseState=!1,pl=!0),C.memoizedState=R):(Nn(R,k)||(R=_r(),Is.lanes|=R,Nd|=R,C.baseState=!0),k)}function vS(C,k){var R=Oe;Oe=R!==0&&4>R?R:4,C(!0);var J=Qu.transition;Qu.transition={};try{C(!1),k()}finally{Oe=R,Qu.transition=J}}function m1(){return ic().memoizedState}function wS(C,k,R){var J=iu(C);if(R={lane:J,action:R,hasEagerState:!1,eagerState:null,next:null},ww(C))xw(k,R);else if(R=fl(C,k,R,J),R!==null){var re=La();Bc(R,C,J,re),bw(R,k,J)}}function xS(C,k,R){var J=iu(C),re={lane:J,action:R,hasEagerState:!1,eagerState:null,next:null};if(ww(C))xw(k,re);else{var pe=C.alternate;if(C.lanes===0&&(pe===null||pe.lanes===0)&&(pe=k.lastRenderedReducer,pe!==null))try{var ze=k.lastRenderedState,Bt=pe(ze,R);if(re.hasEagerState=!0,re.eagerState=Bt,Nn(Bt,ze)){var tn=k.interleaved;tn===null?(re.next=re,$a(k)):(re.next=tn.next,tn.next=re),k.interleaved=re;return}}catch{}finally{}R=fl(C,k,re,J),R!==null&&(re=La(),Bc(R,C,J,re),bw(R,k,J))}}function ww(C){var k=C.alternate;return C===Is||k!==null&&k===Is}function xw(C,k){MA=ap=!0;var R=C.pending;R===null?k.next=k:(k.next=R.next,R.next=k),C.pending=k}function bw(C,k,R){if((R&4194240)!==0){var J=k.lanes;J&=C.pendingLanes,R|=J,k.lanes=R,Me(C,R)}}var UA={readContext:eo,useCallback:Fa,useContext:Fa,useEffect:Fa,useImperativeHandle:Fa,useInsertionEffect:Fa,useLayoutEffect:Fa,useMemo:Fa,useReducer:Fa,useRef:Fa,useState:Fa,useDebugValue:Fa,useDeferredValue:Fa,useTransition:Fa,useMutableSource:Fa,useSyncExternalStore:Fa,useId:Fa,unstable_isNewReconciler:!1},y1={readContext:eo,useCallback:function(C,k){return Gc().memoizedState=[C,k===void 0?null:k],C},useContext:eo,useEffect:p1,useImperativeHandle:function(C,k,R){return R=R!=null?R.concat([C]):null,Dd(4194308,4,g1.bind(null,k,C),R)},useLayoutEffect:function(C,k){return Dd(4194308,4,C,k)},useInsertionEffect:function(C,k){return Dd(4,2,C,k)},useMemo:function(C,k){var R=Gc();return k=k===void 0?null:k,C=C(),R.memoizedState=[C,k],C},useReducer:function(C,k,R){var J=Gc();return k=R!==void 0?R(k):k,J.memoizedState=J.baseState=k,C={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:C,lastRenderedState:k},J.queue=C,C=C.dispatch=wS.bind(null,Is,C),[J.memoizedState,C]},useRef:function(C){var k=Gc();return C={current:C},k.memoizedState=C},useState:lp,useDebugValue:hp,useDeferredValue:function(C){return Gc().memoizedState=C},useTransition:function(){var C=lp(!1),k=C[0];return C=vS.bind(null,C[1]),Gc().memoizedState=C,[k,C]},useMutableSource:function(){},useSyncExternalStore:function(C,k,R){var J=Is,re=Gc();if(pi){if(R===void 0)throw Error(o(407));R=R()}else{if(R=k(),Ms===null)throw Error(o(349));(Xa&30)!==0||u1(J,k,R)}re.memoizedState=R;var pe={value:R,getSnapshot:k};return re.queue=pe,p1(A1.bind(null,J,pe,C),[C]),J.flags|=2048,Da(9,d1.bind(null,J,pe,R,k),void 0,null),R},useId:function(){var C=Gc(),k=Ms.identifierPrefix;if(pi){var R=lt,J=He;R=(J&~(1<<32-tt(J)-1)).toString(32)+R,k=":"+k+"R"+R,R=RA++,0<R&&(k+="H"+R.toString(32)),k+=":"}else R=yw++,k=":"+k+"r"+R.toString(32)+":";return C.memoizedState=k},unstable_isNewReconciler:!1},dp={readContext:eo,useCallback:up,useContext:eo,useEffect:OA,useImperativeHandle:$g,useInsertionEffect:cp,useLayoutEffect:Qg,useMemo:Vg,useReducer:Ug,useRef:rc,useState:function(){return Ug(Jh)},useDebugValue:hp,useDeferredValue:function(C){var k=ic();return vw(k,Mo.memoizedState,C)},useTransition:function(){var C=Ug(Jh)[0],k=ic().memoizedState;return[C,k]},useMutableSource:c1,useSyncExternalStore:h1,useId:m1,unstable_isNewReconciler:!1},bS={readContext:eo,useCallback:up,useContext:eo,useEffect:OA,useImperativeHandle:$g,useInsertionEffect:cp,useLayoutEffect:Qg,useMemo:Vg,useReducer:Hg,useRef:rc,useState:function(){return Hg(Jh)},useDebugValue:hp,useDeferredValue:function(C){var k=ic();return Mo===null?k.memoizedState=C:vw(k,Mo.memoizedState,C)},useTransition:function(){var C=Hg(Jh)[0],k=ic().memoizedState;return[C,k]},useMutableSource:c1,useSyncExternalStore:h1,useId:m1,unstable_isNewReconciler:!1};function Xc(C,k){if(C&&C.defaultProps){k=s({},k),C=C.defaultProps;for(var R in C)k[R]===void 0&&(k[R]=C[R]);return k}return k}function zg(C,k,R,J){k=C.memoizedState,R=R(J,k),R=R==null?k:s({},k,R),C.memoizedState=R,C.lanes===0&&(C.updateQueue.baseState=R)}var Gg={isMounted:function(C){return(C=C._reactInternals)?_(C)===C:!1},enqueueSetState:function(C,k,R){C=C._reactInternals;var J=La(),re=iu(C),pe=za(J,re);pe.payload=k,R!=null&&(pe.callback=R),k=Ss(C,pe,re),k!==null&&(Bc(k,C,re,J),LA(k,C,re))},enqueueReplaceState:function(C,k,R){C=C._reactInternals;var J=La(),re=iu(C),pe=za(J,re);pe.tag=1,pe.payload=k,R!=null&&(pe.callback=R),k=Ss(C,pe,re),k!==null&&(Bc(k,C,re,J),LA(k,C,re))},enqueueForceUpdate:function(C,k){C=C._reactInternals;var R=La(),J=iu(C),re=za(R,J);re.tag=2,k!=null&&(re.callback=k),k=Ss(C,re,J),k!==null&&(Bc(k,C,J,R),LA(k,C,J))}};function _w(C,k,R,J,re,pe,ze){return C=C.stateNode,typeof C.shouldComponentUpdate=="function"?C.shouldComponentUpdate(J,pe,ze):k.prototype&&k.prototype.isPureReactComponent?!Ba(R,J)||!Ba(re,pe):!0}function Cw(C,k,R){var J=!1,re=Li,pe=k.contextType;return typeof pe=="object"&&pe!==null?pe=eo(pe):(re=Dn(k)?Mi:Wn.current,J=k.contextTypes,pe=(J=J!=null)?Gn(C,re):Li),k=new k(R,pe),C.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,k.updater=Gg,C.stateNode=k,k._reactInternals=C,J&&(C=C.stateNode,C.__reactInternalMemoizedUnmaskedChildContext=re,C.__reactInternalMemoizedMaskedChildContext=pe),k}function Sw(C,k,R,J){C=k.state,typeof k.componentWillReceiveProps=="function"&&k.componentWillReceiveProps(R,J),typeof k.UNSAFE_componentWillReceiveProps=="function"&&k.UNSAFE_componentWillReceiveProps(R,J),k.state!==C&&Gg.enqueueReplaceState(k,k.state,null)}function vh(C,k,R,J){var re=C.stateNode;re.props=R,re.state=C.memoizedState,re.refs={},gh(C);var pe=k.contextType;typeof pe=="object"&&pe!==null?re.context=eo(pe):(pe=Dn(k)?Mi:Wn.current,re.context=Gn(C,pe)),re.state=C.memoizedState,pe=k.getDerivedStateFromProps,typeof pe=="function"&&(zg(C,k,pe,R),re.state=C.memoizedState),typeof k.getDerivedStateFromProps=="function"||typeof re.getSnapshotBeforeUpdate=="function"||typeof re.UNSAFE_componentWillMount!="function"&&typeof re.componentWillMount!="function"||(k=re.state,typeof re.componentWillMount=="function"&&re.componentWillMount(),typeof re.UNSAFE_componentWillMount=="function"&&re.UNSAFE_componentWillMount(),k!==re.state&&Gg.enqueueReplaceState(re,re.state,null),nc(C,R,re,J),re.state=C.memoizedState),typeof re.componentDidMount=="function"&&(C.flags|=4194308)}function Ka(C,k){try{var R="",J=k;do R+=Wu(J),J=J.return;while(J);var re=R}catch(pe){re=`
Error generating stack: `+pe.message+`
`+pe.stack}return{value:C,source:k,stack:re,digest:null}}function Kc(C,k,R){return{value:C,source:null,stack:R??null,digest:k??null}}function v1(C,k){try{console.error(k.value)}catch(R){setTimeout(function(){throw R})}}var Tw=typeof WeakMap=="function"?WeakMap:Map;function eu(C,k,R){R=za(-1,R),R.tag=3,R.payload={element:null};var J=k.value;return R.callback=function(){mp||(mp=!0,QA=J),v1(C,k)},R}function sc(C,k,R){R=za(-1,R),R.tag=3;var J=C.type.getDerivedStateFromError;if(typeof J=="function"){var re=k.value;R.payload=function(){return J(re)},R.callback=function(){v1(C,k)}}var pe=C.stateNode;return pe!==null&&typeof pe.componentDidCatch=="function"&&(R.callback=function(){v1(C,k),typeof J!="function"&&(xh===null?xh=new Set([this]):xh.add(this));var ze=k.stack;this.componentDidCatch(k.value,{componentStack:ze!==null?ze:""})}),R}function Bw(C,k,R){var J=C.pingCache;if(J===null){J=C.pingCache=new Tw;var re=new Set;J.set(k,re)}else re=J.get(k),re===void 0&&(re=new Set,J.set(k,re));re.has(R)||(re.add(R),C=AY.bind(null,C,k,R),k.then(C,C))}function Ew(C){do{var k;if((k=C.tag===13)&&(k=C.memoizedState,k=k!==null?k.dehydrated!==null:!0),k)return C;C=C.return}while(C!==null);return null}function w1(C,k,R,J,re){return(C.mode&1)===0?(C===k?C.flags|=65536:(C.flags|=128,R.flags|=131072,R.flags&=-52805,R.tag===1&&(R.alternate===null?R.tag=17:(k=za(-1,1),k.tag=2,Ss(R,k,1))),R.lanes|=1),C):(C.flags|=65536,C.lanes=re,C)}var kw=a.ReactCurrentOwner,pl=!1;function qa(C,k,R,J){k.child=C===null?Ft(k,null,R,J):Ne(k,C.child,R,J)}function Iw(C,k,R,J,re){R=R.render;var pe=k.ref;return bo(k,re),J=Rg(C,k,R,J,pe,re),R=Og(),C!==null&&!pl?(k.updateQueue=C.updateQueue,k.flags&=-2053,C.lanes&=~re,oe(C,k,re)):(pi&&R&&vn(k),k.flags|=1,qa(C,k,J,re),k.child)}function Ap(C,k,R,J,re){if(C===null){var pe=R.type;return typeof pe=="function"&&!SS(pe)&&pe.defaultProps===void 0&&R.compare===null&&R.defaultProps===void 0?(k.tag=15,k.type=pe,fp(C,k,pe,J,re)):(C=Rw(R.type,null,J,k,k.mode,re),C.ref=k.ref,C.return=k,k.child=C)}if(pe=C.child,(C.lanes&re)===0){var ze=pe.memoizedProps;if(R=R.compare,R=R!==null?R:Ba,R(ze,J)&&C.ref===k.ref)return oe(C,k,re)}return k.flags|=1,C=zA(pe,J),C.ref=k.ref,C.return=k,k.child=C}function fp(C,k,R,J,re){if(C!==null){var pe=C.memoizedProps;if(Ba(pe,J)&&C.ref===k.ref)if(pl=!1,k.pendingProps=J=pe,(C.lanes&re)!==0)(C.flags&131072)!==0&&(pl=!0);else return k.lanes=C.lanes,oe(C,k,re)}return x1(C,k,R,J,re)}function HA(C,k,R){var J=k.pendingProps,re=J.children,pe=C!==null?C.memoizedState:null;if(J.mode==="hidden")if((k.mode&1)===0)k.memoizedState={baseLanes:0,cachePool:null,transitions:null},bn(tu,vl),vl|=R;else{if((R&1073741824)===0)return C=pe!==null?pe.baseLanes|R:R,k.lanes=k.childLanes=1073741824,k.memoizedState={baseLanes:C,cachePool:null,transitions:null},k.updateQueue=null,bn(tu,vl),vl|=C,null;k.memoizedState={baseLanes:0,cachePool:null,transitions:null},J=pe!==null?pe.baseLanes:R,bn(tu,vl),vl|=J}else pe!==null?(J=pe.baseLanes|R,k.memoizedState=null):J=R,bn(tu,vl),vl|=J;return qa(C,k,re,R),k.child}function Xg(C,k){var R=k.ref;(C===null&&R!==null||C!==null&&C.ref!==R)&&(k.flags|=512,k.flags|=2097152)}function x1(C,k,R,J,re){var pe=Dn(R)?Mi:Wn.current;return pe=Gn(k,pe),bo(k,re),R=Rg(C,k,R,J,pe,re),J=Og(),C!==null&&!pl?(k.updateQueue=C.updateQueue,k.flags&=-2053,C.lanes&=~re,oe(C,k,re)):(pi&&J&&vn(k),k.flags|=1,qa(C,k,R,re),k.child)}function b1(C,k,R,J,re){if(Dn(R)){var pe=!0;Xn(k)}else pe=!1;if(bo(k,re),k.stateNode===null)$(C,k),Cw(k,R,J),vh(k,R,J,re),J=!0;else if(C===null){var ze=k.stateNode,Bt=k.memoizedProps;ze.props=Bt;var tn=ze.context,qn=R.contextType;typeof qn=="object"&&qn!==null?qn=eo(qn):(qn=Dn(R)?Mi:Wn.current,qn=Gn(k,qn));var ki=R.getDerivedStateFromProps,Cr=typeof ki=="function"||typeof ze.getSnapshotBeforeUpdate=="function";Cr||typeof ze.UNSAFE_componentWillReceiveProps!="function"&&typeof ze.componentWillReceiveProps!="function"||(Bt!==J||tn!==qn)&&Sw(k,ze,J,qn),ka=!1;var gi=k.memoizedState;ze.state=gi,nc(k,J,ze,re),tn=k.memoizedState,Bt!==J||gi!==tn||ui.current||ka?(typeof ki=="function"&&(zg(k,R,ki,J),tn=k.memoizedState),(Bt=ka||_w(k,R,Bt,J,gi,tn,qn))?(Cr||typeof ze.UNSAFE_componentWillMount!="function"&&typeof ze.componentWillMount!="function"||(typeof ze.componentWillMount=="function"&&ze.componentWillMount(),typeof ze.UNSAFE_componentWillMount=="function"&&ze.UNSAFE_componentWillMount()),typeof ze.componentDidMount=="function"&&(k.flags|=4194308)):(typeof ze.componentDidMount=="function"&&(k.flags|=4194308),k.memoizedProps=J,k.memoizedState=tn),ze.props=J,ze.state=tn,ze.context=qn,J=Bt):(typeof ze.componentDidMount=="function"&&(k.flags|=4194308),J=!1)}else{ze=k.stateNode,NA(C,k),Bt=k.memoizedProps,qn=k.type===k.elementType?Bt:Xc(k.type,Bt),ze.props=qn,Cr=k.pendingProps,gi=ze.context,tn=R.contextType,typeof tn=="object"&&tn!==null?tn=eo(tn):(tn=Dn(R)?Mi:Wn.current,tn=Gn(k,tn));var go=R.getDerivedStateFromProps;(ki=typeof go=="function"||typeof ze.getSnapshotBeforeUpdate=="function")||typeof ze.UNSAFE_componentWillReceiveProps!="function"&&typeof ze.componentWillReceiveProps!="function"||(Bt!==Cr||gi!==tn)&&Sw(k,ze,J,tn),ka=!1,gi=k.memoizedState,ze.state=gi,nc(k,J,ze,re);var Ws=k.memoizedState;Bt!==Cr||gi!==Ws||ui.current||ka?(typeof go=="function"&&(zg(k,R,go,J),Ws=k.memoizedState),(qn=ka||_w(k,R,qn,J,gi,Ws,tn)||!1)?(ki||typeof ze.UNSAFE_componentWillUpdate!="function"&&typeof ze.componentWillUpdate!="function"||(typeof ze.componentWillUpdate=="function"&&ze.componentWillUpdate(J,Ws,tn),typeof ze.UNSAFE_componentWillUpdate=="function"&&ze.UNSAFE_componentWillUpdate(J,Ws,tn)),typeof ze.componentDidUpdate=="function"&&(k.flags|=4),typeof ze.getSnapshotBeforeUpdate=="function"&&(k.flags|=1024)):(typeof ze.componentDidUpdate!="function"||Bt===C.memoizedProps&&gi===C.memoizedState||(k.flags|=4),typeof ze.getSnapshotBeforeUpdate!="function"||Bt===C.memoizedProps&&gi===C.memoizedState||(k.flags|=1024),k.memoizedProps=J,k.memoizedState=Ws),ze.props=J,ze.state=Ws,ze.context=tn,J=qn):(typeof ze.componentDidUpdate!="function"||Bt===C.memoizedProps&&gi===C.memoizedState||(k.flags|=4),typeof ze.getSnapshotBeforeUpdate!="function"||Bt===C.memoizedProps&&gi===C.memoizedState||(k.flags|=1024),J=!1)}return _1(C,k,R,J,pe,re)}function _1(C,k,R,J,re,pe){Xg(C,k);var ze=(k.flags&128)!==0;if(!J&&!ze)return re&&Ui(k,R,!1),oe(C,k,pe);J=k.stateNode,kw.current=k;var Bt=ze&&typeof R.getDerivedStateFromError!="function"?null:J.render();return k.flags|=1,C!==null&&ze?(k.child=Ne(k,C.child,null,pe),k.child=Ne(k,null,Bt,pe)):qa(C,k,Bt,pe),k.memoizedState=J.state,re&&Ui(k,R,!0),k.child}function Fw(C){var k=C.stateNode;k.pendingContext?en(C,k.pendingContext,k.pendingContext!==k.context):k.context&&en(C,k.context,!1),zc(C,k.containerInfo)}function Dw(C,k,R,J,re){return Qc(),$c(re),k.flags|=256,qa(C,k,R,J),k.child}var C1={dehydrated:null,treeContext:null,retryLane:0};function S1(C){return{baseLanes:C,cachePool:null,transitions:null}}function jw(C,k,R){var J=k.pendingProps,re=er.current,pe=!1,ze=(k.flags&128)!==0,Bt;if((Bt=ze)||(Bt=C!==null&&C.memoizedState===null?!1:(re&2)!==0),Bt?(pe=!0,k.flags&=-129):(C===null||C.memoizedState!==null)&&(re|=1),bn(er,re&1),C===null)return fs(k),C=k.memoizedState,C!==null&&(C=C.dehydrated,C!==null)?((k.mode&1)===0?k.lanes=1:Zt(C)?k.lanes=8:k.lanes=1073741824,null):(ze=J.children,C=J.fallback,pe?(J=k.mode,pe=k.child,ze={mode:"hidden",children:ze},(J&1)===0&&pe!==null?(pe.childLanes=0,pe.pendingProps=ze):pe=Ow(ze,J,0,null),C=wp(C,J,R,null),pe.return=k,C.return=k,pe.sibling=C,k.child=pe,k.child.memoizedState=S1(R),k.memoizedState=C1,C):Kg(k,ze));if(re=C.memoizedState,re!==null&&(Bt=re.dehydrated,Bt!==null))return _S(C,k,ze,J,Bt,re,R);if(pe){pe=J.fallback,ze=k.mode,re=C.child,Bt=re.sibling;var tn={mode:"hidden",children:J.children};return(ze&1)===0&&k.child!==re?(J=k.child,J.childLanes=0,J.pendingProps=tn,k.deletions=null):(J=zA(re,tn),J.subtreeFlags=re.subtreeFlags&14680064),Bt!==null?pe=zA(Bt,pe):(pe=wp(pe,ze,R,null),pe.flags|=2),pe.return=k,J.return=k,J.sibling=pe,k.child=J,J=pe,pe=k.child,ze=C.child.memoizedState,ze=ze===null?S1(R):{baseLanes:ze.baseLanes|R,cachePool:null,transitions:ze.transitions},pe.memoizedState=ze,pe.childLanes=C.childLanes&~R,k.memoizedState=C1,J}return pe=C.child,C=pe.sibling,J=zA(pe,{mode:"visible",children:J.children}),(k.mode&1)===0&&(J.lanes=R),J.return=k,J.sibling=null,C!==null&&(R=k.deletions,R===null?(k.deletions=[C],k.flags|=16):R.push(C)),k.child=J,k.memoizedState=null,J}function Kg(C,k){return k=Ow({mode:"visible",children:k},C.mode,0,null),k.return=C,C.child=k}function Pd(C,k,R,J){return J!==null&&$c(J),Ne(k,C.child,null,R),C=Kg(k,k.pendingProps.children),C.flags|=2,k.memoizedState=null,C}function _S(C,k,R,J,re,pe,ze){if(R)return k.flags&256?(k.flags&=-257,J=Kc(Error(o(422))),Pd(C,k,ze,J)):k.memoizedState!==null?(k.child=C.child,k.flags|=128,null):(pe=J.fallback,re=k.mode,J=Ow({mode:"visible",children:J.children},re,0,null),pe=wp(pe,re,ze,null),pe.flags|=2,J.return=k,pe.return=k,J.sibling=pe,k.child=J,(k.mode&1)!==0&&Ne(k,C.child,null,ze),k.child.memoizedState=S1(ze),k.memoizedState=C1,pe);if((k.mode&1)===0)return Pd(C,k,ze,null);if(Zt(re))return J=$t(re).digest,pe=Error(o(419)),J=Kc(pe,J,void 0),Pd(C,k,ze,J);if(R=(ze&C.childLanes)!==0,pl||R){if(J=Ms,J!==null){switch(ze&-ze){case 4:re=2;break;case 16:re=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:re=32;break;case 536870912:re=268435456;break;default:re=0}re=(re&(J.suspendedLanes|ze))!==0?0:re,re!==0&&re!==pe.retryLane&&(pe.retryLane=re,Va(C,re),Bc(J,C,re,-1))}return Ch(),J=Kc(Error(o(421))),Pd(C,k,ze,J)}return zt(re)?(k.flags|=128,k.child=C.child,k=fY.bind(null,C),Ht(re,k),null):(C=pe.treeContext,_e&&(Fi=Ot(re),oi=k,pi=!0,Hr=null,Ir=!1,C!==null&&(Ln[ee++]=He,Ln[ee++]=lt,Ln[ee++]=we,He=C.id,lt=C.overflow,we=k)),k=Kg(k,J.children),k.flags|=4096,k)}function Pw(C,k,R){C.lanes|=k;var J=C.alternate;J!==null&&(J.lanes|=k),Nl(C.return,k,R)}function qg(C,k,R,J,re){var pe=C.memoizedState;pe===null?C.memoizedState={isBackwards:k,rendering:null,renderingStartTime:0,last:J,tail:R,tailMode:re}:(pe.isBackwards=k,pe.rendering=null,pe.renderingStartTime=0,pe.last=J,pe.tail=R,pe.tailMode=re)}function N(C,k,R){var J=k.pendingProps,re=J.revealOrder,pe=J.tail;if(qa(C,k,J.children,R),J=er.current,(J&2)!==0)J=J&1|2,k.flags|=128;else{if(C!==null&&(C.flags&128)!==0)e:for(C=k.child;C!==null;){if(C.tag===13)C.memoizedState!==null&&Pw(C,R,k);else if(C.tag===19)Pw(C,R,k);else if(C.child!==null){C.child.return=C,C=C.child;continue}if(C===k)break e;for(;C.sibling===null;){if(C.return===null||C.return===k)break e;C=C.return}C.sibling.return=C.return,C=C.sibling}J&=1}if(bn(er,J),(k.mode&1)===0)k.memoizedState=null;else switch(re){case"forwards":for(R=k.child,re=null;R!==null;)C=R.alternate,C!==null&&xs(C)===null&&(re=R),R=R.sibling;R=re,R===null?(re=k.child,k.child=null):(re=R.sibling,R.sibling=null),qg(k,!1,re,R,pe);break;case"backwards":for(R=null,re=k.child,k.child=null;re!==null;){if(C=re.alternate,C!==null&&xs(C)===null){k.child=re;break}C=re.sibling,re.sibling=R,R=re,re=C}qg(k,!0,R,null,pe);break;case"together":qg(k,!1,null,null,void 0);break;default:k.memoizedState=null}return k.child}function $(C,k){(k.mode&1)===0&&C!==null&&(C.alternate=null,k.alternate=null,k.flags|=2)}function oe(C,k,R){if(C!==null&&(k.dependencies=C.dependencies),Nd|=k.lanes,(R&k.childLanes)===0)return null;if(C!==null&&k.child!==C.child)throw Error(o(153));if(k.child!==null){for(C=k.child,R=zA(C,C.pendingProps),k.child=R,R.return=k;C.sibling!==null;)C=C.sibling,R=R.sibling=zA(C,C.pendingProps),R.return=k;R.sibling=null}return k.child}function de(C,k,R){switch(k.tag){case 3:Fw(k),Qc();break;case 5:Ll(k);break;case 1:Dn(k.type)&&Xn(k);break;case 4:zc(k,k.stateNode.containerInfo);break;case 10:Mr(k,k.type._context,k.memoizedProps.value);break;case 13:var J=k.memoizedState;if(J!==null)return J.dehydrated!==null?(bn(er,er.current&1),k.flags|=128,null):(R&k.child.childLanes)!==0?jw(C,k,R):(bn(er,er.current&1),C=oe(C,k,R),C!==null?C.sibling:null);bn(er,er.current&1);break;case 19:if(J=(R&k.childLanes)!==0,(C.flags&128)!==0){if(J)return N(C,k,R);k.flags|=128}var re=k.memoizedState;if(re!==null&&(re.rendering=null,re.tail=null,re.lastEffect=null),bn(er,er.current),J)break;return null;case 22:case 23:return k.lanes=0,HA(C,k,R)}return oe(C,k,R)}function Se(C){C.flags|=4}function Ee(C,k){if(C!==null&&C.child===k.child)return!0;if((k.flags&16)!==0)return!1;for(C=k.child;C!==null;){if((C.flags&12854)!==0||(C.subtreeFlags&12854)!==0)return!1;C=C.sibling}return!0}var Fe,Pe,Ue,Ze;if(ye)Fe=function(C,k){for(var R=k.child;R!==null;){if(R.tag===5||R.tag===6)U(C,R.stateNode);else if(R.tag!==4&&R.child!==null){R.child.return=R,R=R.child;continue}if(R===k)break;for(;R.sibling===null;){if(R.return===null||R.return===k)return;R=R.return}R.sibling.return=R.return,R=R.sibling}},Pe=function(){},Ue=function(C,k,R,J,re){if(C=C.memoizedProps,C!==J){var pe=k.stateNode,ze=Ga(Ia.current);R=q(pe,R,C,J,re,ze),(k.updateQueue=R)&&Se(k)}},Ze=function(C,k,R,J){R!==J&&Se(k)};else if(be){Fe=function(C,k,R,J){for(var re=k.child;re!==null;){if(re.tag===5){var pe=re.stateNode;R&&J&&(pe=on(pe,re.type,re.memoizedProps,re)),U(C,pe)}else if(re.tag===6)pe=re.stateNode,R&&J&&(pe=Et(pe,re.memoizedProps,re)),U(C,pe);else if(re.tag!==4){if(re.tag===22&&re.memoizedState!==null)pe=re.child,pe!==null&&(pe.return=re),Fe(C,re,!0,!0);else if(re.child!==null){re.child.return=re,re=re.child;continue}}if(re===k)break;for(;re.sibling===null;){if(re.return===null||re.return===k)return;re=re.return}re.sibling.return=re.return,re=re.sibling}};var yt=function(C,k,R,J){for(var re=k.child;re!==null;){if(re.tag===5){var pe=re.stateNode;R&&J&&(pe=on(pe,re.type,re.memoizedProps,re)),Wt(C,pe)}else if(re.tag===6)pe=re.stateNode,R&&J&&(pe=Et(pe,re.memoizedProps,re)),Wt(C,pe);else if(re.tag!==4){if(re.tag===22&&re.memoizedState!==null)pe=re.child,pe!==null&&(pe.return=re),yt(C,re,!0,!0);else if(re.child!==null){re.child.return=re,re=re.child;continue}}if(re===k)break;for(;re.sibling===null;){if(re.return===null||re.return===k)return;re=re.return}re.sibling.return=re.return,re=re.sibling}};Pe=function(C,k){var R=k.stateNode;if(!Ee(C,k)){C=R.containerInfo;var J=jt(C);yt(J,k,!1,!1),R.pendingChildren=J,Se(k),Mt(C,J)}},Ue=function(C,k,R,J,re){var pe=C.stateNode,ze=C.memoizedProps;if((C=Ee(C,k))&&ze===J)k.stateNode=pe;else{var Bt=k.stateNode,tn=Ga(Ia.current),qn=null;ze!==J&&(qn=q(Bt,R,ze,J,re,tn)),C&&qn===null?k.stateNode=pe:(pe=ft(pe,qn,R,ze,J,k,C,Bt),z(pe,R,J,re,tn)&&Se(k),k.stateNode=pe,C?Se(k):Fe(pe,k,!1,!1))}},Ze=function(C,k,R,J){R!==J?(C=Ga(_c.current),R=Ga(Ia.current),k.stateNode=ie(J,C,R,k),Se(k)):k.stateNode=C.stateNode}}else Pe=function(){},Ue=function(){},Ze=function(){};function Ut(C,k){if(!pi)switch(C.tailMode){case"hidden":k=C.tail;for(var R=null;k!==null;)k.alternate!==null&&(R=k),k=k.sibling;R===null?C.tail=null:R.sibling=null;break;case"collapsed":R=C.tail;for(var J=null;R!==null;)R.alternate!==null&&(J=R),R=R.sibling;J===null?k||C.tail===null?C.tail=null:C.tail.sibling=null:J.sibling=null}}function Ke(C){var k=C.alternate!==null&&C.alternate.child===C.child,R=0,J=0;if(k)for(var re=C.child;re!==null;)R|=re.lanes|re.childLanes,J|=re.subtreeFlags&14680064,J|=re.flags&14680064,re.return=C,re=re.sibling;else for(re=C.child;re!==null;)R|=re.lanes|re.childLanes,J|=re.subtreeFlags,J|=re.flags,re.return=C,re=re.sibling;return C.subtreeFlags|=J,C.childLanes=R,k}function St(C,k,R){var J=k.pendingProps;switch(si(k),k.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ke(k),null;case 1:return Dn(k.type)&&li(),Ke(k),null;case 3:return R=k.stateNode,yh(),sn(ui),sn(Wn),ho(),R.pendingContext&&(R.context=R.pendingContext,R.pendingContext=null),(C===null||C.child===null)&&(Al(k)?Se(k):C===null||C.memoizedState.isDehydrated&&(k.flags&256)===0||(k.flags|=1024,Hr!==null&&(e0(Hr),Hr=null))),Pe(C,k),Ke(k),null;case 5:Cc(k),R=Ga(_c.current);var re=k.type;if(C!==null&&k.stateNode!=null)Ue(C,k,re,J,R),C.ref!==k.ref&&(k.flags|=512,k.flags|=2097152);else{if(!J){if(k.stateNode===null)throw Error(o(166));return Ke(k),null}if(C=Ga(Ia.current),Al(k)){if(!_e)throw Error(o(175));C=Cn(k.stateNode,k.type,k.memoizedProps,R,C,k,!Ir),k.updateQueue=C,C!==null&&Se(k)}else{var pe=Q(re,J,R,C,k);Fe(pe,k,!1,!1),k.stateNode=pe,z(pe,re,J,R,C)&&Se(k)}k.ref!==null&&(k.flags|=512,k.flags|=2097152)}return Ke(k),null;case 6:if(C&&k.stateNode!=null)Ze(C,k,C.memoizedProps,J);else{if(typeof J!="string"&&k.stateNode===null)throw Error(o(166));if(C=Ga(_c.current),R=Ga(Ia.current),Al(k)){if(!_e)throw Error(o(176));if(C=k.stateNode,R=k.memoizedProps,(J=Rn(C,R,k,!Ir))&&(re=oi,re!==null))switch(re.tag){case 3:Gi(re.stateNode.containerInfo,C,R,(re.mode&1)!==0);break;case 5:fi(re.type,re.memoizedProps,re.stateNode,C,R,(re.mode&1)!==0)}J&&Se(k)}else k.stateNode=ie(J,C,R,k)}return Ke(k),null;case 13:if(sn(er),J=k.memoizedState,C===null||C.memoizedState!==null&&C.memoizedState.dehydrated!==null){if(pi&&Fi!==null&&(k.mode&1)!==0&&(k.flags&128)===0)bc(),Qc(),k.flags|=98560,re=!1;else if(re=Al(k),J!==null&&J.dehydrated!==null){if(C===null){if(!re)throw Error(o(318));if(!_e)throw Error(o(344));if(re=k.memoizedState,re=re!==null?re.dehydrated:null,!re)throw Error(o(317));xn(re,k)}else Qc(),(k.flags&128)===0&&(k.memoizedState=null),k.flags|=4;Ke(k),re=!1}else Hr!==null&&(e0(Hr),Hr=null),re=!0;if(!re)return k.flags&65536?k:null}return(k.flags&128)!==0?(k.lanes=R,k):(R=J!==null,R!==(C!==null&&C.memoizedState!==null)&&R&&(k.child.flags|=8192,(k.mode&1)!==0&&(C===null||(er.current&1)!==0?po===0&&(po=3):Ch())),k.updateQueue!==null&&(k.flags|=4),Ke(k),null);case 4:return yh(),Pe(C,k),C===null&&Y(k.stateNode.containerInfo),Ke(k),null;case 10:return cs(k.type._context),Ke(k),null;case 17:return Dn(k.type)&&li(),Ke(k),null;case 19:if(sn(er),re=k.memoizedState,re===null)return Ke(k),null;if(J=(k.flags&128)!==0,pe=re.rendering,pe===null)if(J)Ut(re,!1);else{if(po!==0||C!==null&&(C.flags&128)!==0)for(C=k.child;C!==null;){if(pe=xs(C),pe!==null){for(k.flags|=128,Ut(re,!1),C=pe.updateQueue,C!==null&&(k.updateQueue=C,k.flags|=4),k.subtreeFlags=0,C=R,R=k.child;R!==null;)J=R,re=C,J.flags&=14680066,pe=J.alternate,pe===null?(J.childLanes=0,J.lanes=re,J.child=null,J.subtreeFlags=0,J.memoizedProps=null,J.memoizedState=null,J.updateQueue=null,J.dependencies=null,J.stateNode=null):(J.childLanes=pe.childLanes,J.lanes=pe.lanes,J.child=pe.child,J.subtreeFlags=0,J.deletions=null,J.memoizedProps=pe.memoizedProps,J.memoizedState=pe.memoizedState,J.updateQueue=pe.updateQueue,J.type=pe.type,re=pe.dependencies,J.dependencies=re===null?null:{lanes:re.lanes,firstContext:re.firstContext}),R=R.sibling;return bn(er,er.current&1|2),k.child}C=C.sibling}re.tail!==null&&qe()>Yg&&(k.flags|=128,J=!0,Ut(re,!1),k.lanes=4194304)}else{if(!J)if(C=xs(pe),C!==null){if(k.flags|=128,J=!0,C=C.updateQueue,C!==null&&(k.updateQueue=C,k.flags|=4),Ut(re,!0),re.tail===null&&re.tailMode==="hidden"&&!pe.alternate&&!pi)return Ke(k),null}else 2*qe()-re.renderingStartTime>Yg&&R!==1073741824&&(k.flags|=128,J=!0,Ut(re,!1),k.lanes=4194304);re.isBackwards?(pe.sibling=k.child,k.child=pe):(C=re.last,C!==null?C.sibling=pe:k.child=pe,re.last=pe)}return re.tail!==null?(k=re.tail,re.rendering=k,re.tail=k.sibling,re.renderingStartTime=qe(),k.sibling=null,C=er.current,bn(er,J?C&1|2:C&1),k):(Ke(k),null);case 22:case 23:return yp(),R=k.memoizedState!==null,C!==null&&C.memoizedState!==null!==R&&(k.flags|=8192),R&&(k.mode&1)!==0?(vl&1073741824)!==0&&(Ke(k),ye&&k.subtreeFlags&6&&(k.flags|=8192)):Ke(k),null;case 24:return null;case 25:return null}throw Error(o(156,k.tag))}function Nt(C,k){switch(si(k),k.tag){case 1:return Dn(k.type)&&li(),C=k.flags,C&65536?(k.flags=C&-65537|128,k):null;case 3:return yh(),sn(ui),sn(Wn),ho(),C=k.flags,(C&65536)!==0&&(C&128)===0?(k.flags=C&-65537|128,k):null;case 5:return Cc(k),null;case 13:if(sn(er),C=k.memoizedState,C!==null&&C.dehydrated!==null){if(k.alternate===null)throw Error(o(340));Qc()}return C=k.flags,C&65536?(k.flags=C&-65537|128,k):null;case 19:return sn(er),null;case 4:return yh(),null;case 10:return cs(k.type._context),null;case 22:case 23:return yp(),null;case 24:return null;default:return null}}var cn=!1,It=!1,gn=typeof WeakSet=="function"?WeakSet:Set,Tt=null;function jn(C,k){var R=C.ref;if(R!==null)if(typeof R=="function")try{R(null)}catch(J){_o(C,k,J)}else R.current=null}function In(C,k,R){try{R()}catch(J){_o(C,k,J)}}var Pi=!1;function Ci(C,k){for(X(C.containerInfo),Tt=k;Tt!==null;)if(C=Tt,k=C.child,(C.subtreeFlags&1028)!==0&&k!==null)k.return=C,Tt=k;else for(;Tt!==null;){C=Tt;try{var R=C.alternate;if((C.flags&1024)!==0)switch(C.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var J=R.memoizedProps,re=R.memoizedState,pe=C.stateNode,ze=pe.getSnapshotBeforeUpdate(C.elementType===C.type?J:Xc(C.type,J),re);pe.__reactInternalSnapshotBeforeUpdate=ze}break;case 3:ye&&ut(C.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(Bt){_o(C,C.return,Bt)}if(k=C.sibling,k!==null){k.return=C.return,Tt=k;break}Tt=C.return}return R=Pi,Pi=!1,R}function lr(C,k,R){var J=k.updateQueue;if(J=J!==null?J.lastEffect:null,J!==null){var re=J=J.next;do{if((re.tag&C)===C){var pe=re.destroy;re.destroy=void 0,pe!==void 0&&In(k,R,pe)}re=re.next}while(re!==J)}}function Si(C,k){if(k=k.updateQueue,k=k!==null?k.lastEffect:null,k!==null){var R=k=k.next;do{if((R.tag&C)===C){var J=R.create;R.destroy=J()}R=R.next}while(R!==k)}}function Rr(C){var k=C.ref;if(k!==null){var R=C.stateNode;switch(C.tag){case 5:C=K(R);break;default:C=R}typeof k=="function"?k(C):k.current=C}}function Ro(C){var k=C.alternate;k!==null&&(C.alternate=null,Ro(k)),C.child=null,C.deletions=null,C.sibling=null,C.tag===5&&(k=C.stateNode,k!==null&&ce(k)),C.stateNode=null,C.return=null,C.dependencies=null,C.memoizedProps=null,C.memoizedState=null,C.pendingProps=null,C.stateNode=null,C.updateQueue=null}function yr(C){return C.tag===5||C.tag===3||C.tag===4}function Ei(C){e:for(;;){for(;C.sibling===null;){if(C.return===null||yr(C.return))return null;C=C.return}for(C.sibling.return=C.return,C=C.sibling;C.tag!==5&&C.tag!==6&&C.tag!==18;){if(C.flags&2||C.child===null||C.tag===4)continue e;C.child.return=C,C=C.child}if(!(C.flags&2))return C.stateNode}}function Zn(C,k,R){var J=C.tag;if(J===5||J===6)C=C.stateNode,k?Le(R,C,k):We(R,C);else if(J!==4&&(C=C.child,C!==null))for(Zn(C,k,R),C=C.sibling;C!==null;)Zn(C,k,R),C=C.sibling}function uo(C,k,R){var J=C.tag;if(J===5||J===6)C=C.stateNode,k?Ie(R,C,k):Ve(R,C);else if(J!==4&&(C=C.child,C!==null))for(uo(C,k,R),C=C.sibling;C!==null;)uo(C,k,R),C=C.sibling}var Ni=null,dr=!1;function Gr(C,k,R){for(R=R.child;R!==null;)ea(C,k,R),R=R.sibling}function ea(C,k,R){if(Qt&&typeof Qt.onCommitFiberUnmount=="function")try{Qt.onCommitFiberUnmount(fn,R)}catch{}switch(R.tag){case 5:It||jn(R,k);case 6:if(ye){var J=Ni,re=dr;Ni=null,Gr(C,k,R),Ni=J,dr=re,Ni!==null&&(dr?ct(Ni,R.stateNode):et(Ni,R.stateNode))}else Gr(C,k,R);break;case 18:ye&&Ni!==null&&(dr?ti(Ni,R.stateNode):Ti(Ni,R.stateNode));break;case 4:ye?(J=Ni,re=dr,Ni=R.stateNode.containerInfo,dr=!0,Gr(C,k,R),Ni=J,dr=re):(be&&(J=R.stateNode.containerInfo,re=jt(J),dn(J,re)),Gr(C,k,R));break;case 0:case 11:case 14:case 15:if(!It&&(J=R.updateQueue,J!==null&&(J=J.lastEffect,J!==null))){re=J=J.next;do{var pe=re,ze=pe.destroy;pe=pe.tag,ze!==void 0&&((pe&2)!==0||(pe&4)!==0)&&In(R,k,ze),re=re.next}while(re!==J)}Gr(C,k,R);break;case 1:if(!It&&(jn(R,k),J=R.stateNode,typeof J.componentWillUnmount=="function"))try{J.props=R.memoizedProps,J.state=R.memoizedState,J.componentWillUnmount()}catch(Bt){_o(R,k,Bt)}Gr(C,k,R);break;case 21:Gr(C,k,R);break;case 22:R.mode&1?(It=(J=It)||R.memoizedState!==null,Gr(C,k,R),It=J):Gr(C,k,R);break;default:Gr(C,k,R)}}function Ya(C){var k=C.updateQueue;if(k!==null){C.updateQueue=null;var R=C.stateNode;R===null&&(R=C.stateNode=new gn),k.forEach(function(J){var re=pY.bind(null,C,J);R.has(J)||(R.add(J),J.then(re,re))})}}function rs(C,k){var R=k.deletions;if(R!==null)for(var J=0;J<R.length;J++){var re=R[J];try{var pe=C,ze=k;if(ye){var Bt=ze;e:for(;Bt!==null;){switch(Bt.tag){case 5:Ni=Bt.stateNode,dr=!1;break e;case 3:Ni=Bt.stateNode.containerInfo,dr=!0;break e;case 4:Ni=Bt.stateNode.containerInfo,dr=!0;break e}Bt=Bt.return}if(Ni===null)throw Error(o(160));ea(pe,ze,re),Ni=null,dr=!1}else ea(pe,ze,re);var tn=re.alternate;tn!==null&&(tn.return=null),re.return=null}catch(qn){_o(re,k,qn)}}if(k.subtreeFlags&12854)for(k=k.child;k!==null;)ja(k,C),k=k.sibling}function ja(C,k){var R=C.alternate,J=C.flags;switch(C.tag){case 0:case 11:case 14:case 15:if(rs(k,C),to(C),J&4){try{lr(3,C,C.return),Si(3,C)}catch(gi){_o(C,C.return,gi)}try{lr(5,C,C.return)}catch(gi){_o(C,C.return,gi)}}break;case 1:rs(k,C),to(C),J&512&&R!==null&&jn(R,R.return);break;case 5:if(rs(k,C),to(C),J&512&&R!==null&&jn(R,R.return),ye){if(C.flags&32){var re=C.stateNode;try{mt(re)}catch(gi){_o(C,C.return,gi)}}if(J&4&&(re=C.stateNode,re!=null)){var pe=C.memoizedProps;if(R=R!==null?R.memoizedProps:pe,J=C.type,k=C.updateQueue,C.updateQueue=null,k!==null)try{Re(re,k,J,R,pe,C)}catch(gi){_o(C,C.return,gi)}}}break;case 6:if(rs(k,C),to(C),J&4&&ye){if(C.stateNode===null)throw Error(o(162));re=C.stateNode,pe=C.memoizedProps,R=R!==null?R.memoizedProps:pe;try{De(re,R,pe)}catch(gi){_o(C,C.return,gi)}}break;case 3:if(rs(k,C),to(C),J&4){if(ye&&_e&&R!==null&&R.memoizedState.isDehydrated)try{Hn(k.containerInfo)}catch(gi){_o(C,C.return,gi)}if(be){re=k.containerInfo,pe=k.pendingChildren;try{dn(re,pe)}catch(gi){_o(C,C.return,gi)}}}break;case 4:if(rs(k,C),to(C),J&4&&be){pe=C.stateNode,re=pe.containerInfo,pe=pe.pendingChildren;try{dn(re,pe)}catch(gi){_o(C,C.return,gi)}}break;case 13:rs(k,C),to(C),re=C.child,re.flags&8192&&(pe=re.memoizedState!==null,re.stateNode.isHidden=pe,!pe||re.alternate!==null&&re.alternate.memoizedState!==null||(T1=qe())),J&4&&Ya(C);break;case 22:var ze=R!==null&&R.memoizedState!==null;if(C.mode&1?(It=(R=It)||ze,rs(k,C),It=R):rs(k,C),to(C),J&8192){if(R=C.memoizedState!==null,(C.stateNode.isHidden=R)&&!ze&&(C.mode&1)!==0)for(Tt=C,J=C.child;J!==null;){for(k=Tt=J;Tt!==null;){ze=Tt;var Bt=ze.child;switch(ze.tag){case 0:case 11:case 14:case 15:lr(4,ze,ze.return);break;case 1:jn(ze,ze.return);var tn=ze.stateNode;if(typeof tn.componentWillUnmount=="function"){var qn=ze,ki=ze.return;try{var Cr=qn;tn.props=Cr.memoizedProps,tn.state=Cr.memoizedState,tn.componentWillUnmount()}catch(gi){_o(qn,ki,gi)}}break;case 5:jn(ze,ze.return);break;case 22:if(ze.memoizedState!==null){Ao(k);continue}}Bt!==null?(Bt.return=ze,Tt=Bt):Ao(k)}J=J.sibling}if(ye){e:if(J=null,ye)for(k=C;;){if(k.tag===5){if(J===null){J=k;try{re=k.stateNode,R?je(re):Je(k.stateNode,k.memoizedProps)}catch(gi){_o(C,C.return,gi)}}}else if(k.tag===6){if(J===null)try{pe=k.stateNode,R?le(pe):ht(pe,k.memoizedProps)}catch(gi){_o(C,C.return,gi)}}else if((k.tag!==22&&k.tag!==23||k.memoizedState===null||k===C)&&k.child!==null){k.child.return=k,k=k.child;continue}if(k===C)break e;for(;k.sibling===null;){if(k.return===null||k.return===C)break e;J===k&&(J=null),k=k.return}J===k&&(J=null),k.sibling.return=k.return,k=k.sibling}}}break;case 19:rs(k,C),to(C),J&4&&Ya(C);break;case 21:break;default:rs(k,C),to(C)}}function to(C){var k=C.flags;if(k&2){try{if(ye){e:{for(var R=C.return;R!==null;){if(yr(R)){var J=R;break e}R=R.return}throw Error(o(160))}switch(J.tag){case 5:var re=J.stateNode;J.flags&32&&(mt(re),J.flags&=-33);var pe=Ei(C);uo(C,pe,re);break;case 3:case 4:var ze=J.stateNode.containerInfo,Bt=Ei(C);Zn(C,Bt,ze);break;default:throw Error(o(161))}}}catch(tn){_o(C,C.return,tn)}C.flags&=-3}k&4096&&(C.flags&=-4097)}function ta(C,k,R){Tt=C,Xr(C)}function Xr(C,k,R){for(var J=(C.mode&1)!==0;Tt!==null;){var re=Tt,pe=re.child;if(re.tag===22&&J){var ze=re.memoizedState!==null||cn;if(!ze){var Bt=re.alternate,tn=Bt!==null&&Bt.memoizedState!==null||It;Bt=cn;var qn=It;if(cn=ze,(It=tn)&&!qn)for(Tt=re;Tt!==null;)ze=Tt,tn=ze.child,ze.tag===22&&ze.memoizedState!==null?gs(re):tn!==null?(tn.return=ze,Tt=tn):gs(re);for(;pe!==null;)Tt=pe,Xr(pe),pe=pe.sibling;Tt=re,cn=Bt,It=qn}ps(C)}else(re.subtreeFlags&8772)!==0&&pe!==null?(pe.return=re,Tt=pe):ps(C)}}function ps(C){for(;Tt!==null;){var k=Tt;if((k.flags&8772)!==0){var R=k.alternate;try{if((k.flags&8772)!==0)switch(k.tag){case 0:case 11:case 15:It||Si(5,k);break;case 1:var J=k.stateNode;if(k.flags&4&&!It)if(R===null)J.componentDidMount();else{var re=k.elementType===k.type?R.memoizedProps:Xc(k.type,R.memoizedProps);J.componentDidUpdate(re,R.memoizedState,J.__reactInternalSnapshotBeforeUpdate)}var pe=k.updateQueue;pe!==null&&Fd(k,pe,J);break;case 3:var ze=k.updateQueue;if(ze!==null){if(R=null,k.child!==null)switch(k.child.tag){case 5:R=K(k.child.stateNode);break;case 1:R=k.child.stateNode}Fd(k,ze,R)}break;case 5:var Bt=k.stateNode;R===null&&k.flags&4&&Ge(Bt,k.type,k.memoizedProps,k);break;case 6:break;case 4:break;case 12:break;case 13:if(_e&&k.memoizedState===null){var tn=k.alternate;if(tn!==null){var qn=tn.memoizedState;if(qn!==null){var ki=qn.dehydrated;ki!==null&&Kn(ki)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(o(163))}It||k.flags&512&&Rr(k)}catch(Cr){_o(k,k.return,Cr)}}if(k===C){Tt=null;break}if(R=k.sibling,R!==null){R.return=k.return,Tt=R;break}Tt=k.return}}function Ao(C){for(;Tt!==null;){var k=Tt;if(k===C){Tt=null;break}var R=k.sibling;if(R!==null){R.return=k.return,Tt=R;break}Tt=k.return}}function gs(C){for(;Tt!==null;){var k=Tt;try{switch(k.tag){case 0:case 11:case 15:var R=k.return;try{Si(4,k)}catch(tn){_o(k,R,tn)}break;case 1:var J=k.stateNode;if(typeof J.componentDidMount=="function"){var re=k.return;try{J.componentDidMount()}catch(tn){_o(k,re,tn)}}var pe=k.return;try{Rr(k)}catch(tn){_o(k,pe,tn)}break;case 5:var ze=k.return;try{Rr(k)}catch(tn){_o(k,ze,tn)}}}catch(tn){_o(k,k.return,tn)}if(k===C){Tt=null;break}var Bt=k.sibling;if(Bt!==null){Bt.return=k.return,Tt=Bt;break}Tt=k.return}}var Oo=0,Ml=1,no=2,Pa=3,ms=4;if(typeof Symbol=="function"&&Symbol.for){var fo=Symbol.for;Oo=fo("selector.component"),Ml=fo("selector.has_pseudo_class"),no=fo("selector.role"),Pa=fo("selector.test_id"),ms=fo("selector.text")}function gl(C){var k=W(C);if(k!=null){if(typeof k.memoizedProps["data-testname"]!="string")throw Error(o(364));return k}if(C=Te(C),C===null)throw Error(o(362));return C.stateNode.current}function Na(C,k){switch(k.$$typeof){case Oo:if(C.type===k.value)return!0;break;case Ml:e:{k=k.value,C=[C,0];for(var R=0;R<C.length;){var J=C[R++],re=C[R++],pe=k[re];if(J.tag!==5||!Ye(J)){for(;pe!=null&&Na(J,pe);)re++,pe=k[re];if(re===k.length){k=!0;break e}else for(J=J.child;J!==null;)C.push(J,re),J=J.sibling}}k=!1}return k;case no:if(C.tag===5&&$e(C.stateNode,k.value))return!0;break;case ms:if((C.tag===5||C.tag===6)&&(C=Be(C),C!==null&&0<=C.indexOf(k.value)))return!0;break;case Pa:if(C.tag===5&&(C=C.memoizedProps["data-testname"],typeof C=="string"&&C.toLowerCase()===k.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function ml(C){switch(C.$$typeof){case Oo:return"<"+(D(C.value)||"Unknown")+">";case Ml:return":has("+(ml(C)||"")+")";case no:return'[role="'+C.value+'"]';case ms:return'"'+C.value+'"';case Pa:return'[data-testname="'+C.value+'"]';default:throw Error(o(365))}}function Rl(C,k){var R=[];C=[C,0];for(var J=0;J<C.length;){var re=C[J++],pe=C[J++],ze=k[pe];if(re.tag!==5||!Ye(re)){for(;ze!=null&&Na(re,ze);)pe++,ze=k[pe];if(pe===k.length)R.push(re);else for(re=re.child;re!==null;)C.push(re,pe),re=re.sibling}}return R}function Za(C,k){if(!xe)throw Error(o(363));C=gl(C),C=Rl(C,k),k=[],C=Array.from(C);for(var R=0;R<C.length;){var J=C[R++];if(J.tag===5)Ye(J)||k.push(J.stateNode);else for(J=J.child;J!==null;)C.push(J),J=J.sibling}return k}var oc=Math.ceil,bs=a.ReactCurrentDispatcher,yl=a.ReactCurrentOwner,hs=a.ReactCurrentBatchConfig,Ar=0,Ms=null,Wr=null,Uo=0,vl=0,tu=mn(0),po=0,pp=null,Nd=0,WA=0,wh=0,gp=null,Ol=null,T1=0,Yg=1/0,Tc=null;function Ld(){Yg=qe()+500}var mp=!1,QA=null,xh=null,$u=!1,nu=null,Zg=0,Vu=0,Jg=null,$A=-1,qc=0;function La(){return(Ar&6)!==0?qe():$A!==-1?$A:$A=qe()}function iu(C){return(C.mode&1)===0?1:(Ar&2)!==0&&Uo!==0?Uo&-Uo:Fo.transition!==null?(qc===0&&(qc=_r()),qc):(C=Oe,C!==0?C:ve())}function Bc(C,k,R,J){if(50<Vu)throw Vu=0,Jg=null,Error(o(185));ue(C,R,J),((Ar&2)===0||C!==Ms)&&(C===Ms&&((Ar&2)===0&&(WA|=R),po===4&&ru(C,Uo)),wl(C,J),R===1&&Ar===0&&(k.mode&1)===0&&(Ld(),tr&&As()))}function wl(C,k){var R=C.callbackNode;Vi(C,k);var J=Pr(C,C===Ms?Uo:0);if(J===0)R!==null&&Ae(R),C.callbackNode=null,C.callbackPriority=0;else if(k=J&-J,C.callbackPriority!==k){if(R!=null&&Ae(R),k===1)C.tag===0?ko(Nw.bind(null,C)):ks(Nw.bind(null,C)),ne?he(function(){(Ar&6)===0&&As()}):gt(nn,As),R=null;else{switch(nt(J)){case 1:R=nn;break;case 4:R=An;break;case 16:R=Ct;break;case 536870912:R=kn;break;default:R=Ct}R=C8(R,Md.bind(null,C))}C.callbackPriority=k,C.callbackNode=R}}function Md(C,k){if($A=-1,qc=0,(Ar&6)!==0)throw Error(o(327));var R=C.callbackNode;if(vp()&&C.callbackNode!==R)return null;var J=Pr(C,C===Ms?Uo:0);if(J===0)return null;if((J&30)!==0||(J&C.expiredLanes)!==0||k)k=Rd(C,J);else{k=J;var re=Ar;Ar|=2;var pe=su();(Ms!==C||Uo!==k)&&(Tc=null,Ld(),bh(C,k));do try{Lw();break}catch(Bt){_h(C,Bt)}while(!0);Fr(),bs.current=pe,Ar=re,Wr!==null?k=0:(Ms=null,Uo=0,k=po)}if(k!==0){if(k===2&&(re=br(C),re!==0&&(J=re,k=B1(C,re))),k===1)throw R=pp,bh(C,0),ru(C,J),wl(C,qe()),R;if(k===6)ru(C,J);else{if(re=C.current.alternate,(J&30)===0&&!CS(re)&&(k=Rd(C,J),k===2&&(pe=br(C),pe!==0&&(J=pe,k=B1(C,pe))),k===1))throw R=pp,bh(C,0),ru(C,J),wl(C,qe()),R;switch(C.finishedWork=re,C.finishedLanes=J,k){case 0:case 1:throw Error(o(345));case 2:ou(C,Ol,Tc);break;case 3:if(ru(C,J),(J&130023424)===J&&(k=T1+500-qe(),10<k)){if(Pr(C,0)!==0)break;if(re=C.suspendedLanes,(re&J)!==J){La(),C.pingedLanes|=C.suspendedLanes&re;break}C.timeoutHandle=H(ou.bind(null,C,Ol,Tc),k);break}ou(C,Ol,Tc);break;case 4:if(ru(C,J),(J&4194240)===J)break;for(k=C.eventTimes,re=-1;0<J;){var ze=31-tt(J);pe=1<<ze,ze=k[ze],ze>re&&(re=ze),J&=~pe}if(J=re,J=qe()-J,J=(120>J?120:480>J?480:1080>J?1080:1920>J?1920:3e3>J?3e3:4320>J?4320:1960*oc(J/1960))-J,10<J){C.timeoutHandle=H(ou.bind(null,C,Ol,Tc),J);break}ou(C,Ol,Tc);break;case 5:ou(C,Ol,Tc);break;default:throw Error(o(329))}}}return wl(C,qe()),C.callbackNode===R?Md.bind(null,C):null}function B1(C,k){var R=gp;return C.current.memoizedState.isDehydrated&&(bh(C,k).flags|=256),C=Rd(C,k),C!==2&&(k=Ol,Ol=R,k!==null&&e0(k)),C}function e0(C){Ol===null?Ol=C:Ol.push.apply(Ol,C)}function CS(C){for(var k=C;;){if(k.flags&16384){var R=k.updateQueue;if(R!==null&&(R=R.stores,R!==null))for(var J=0;J<R.length;J++){var re=R[J],pe=re.getSnapshot;re=re.value;try{if(!Nn(pe(),re))return!1}catch{return!1}}}if(R=k.child,k.subtreeFlags&16384&&R!==null)R.return=k,k=R;else{if(k===C)break;for(;k.sibling===null;){if(k.return===null||k.return===C)return!0;k=k.return}k.sibling.return=k.return,k=k.sibling}}return!0}function ru(C,k){for(k&=~wh,k&=~WA,C.suspendedLanes|=k,C.pingedLanes&=~k,C=C.expirationTimes;0<k;){var R=31-tt(k),J=1<<R;C[R]=-1,k&=~J}}function Nw(C){if((Ar&6)!==0)throw Error(o(327));vp();var k=Pr(C,0);if((k&1)===0)return wl(C,qe()),null;var R=Rd(C,k);if(C.tag!==0&&R===2){var J=br(C);J!==0&&(k=J,R=B1(C,J))}if(R===1)throw R=pp,bh(C,0),ru(C,k),wl(C,qe()),R;if(R===6)throw Error(o(345));return C.finishedWork=C.current.alternate,C.finishedLanes=k,ou(C,Ol,Tc),wl(C,qe()),null}function VA(C){nu!==null&&nu.tag===0&&(Ar&6)===0&&vp();var k=Ar;Ar|=1;var R=hs.transition,J=Oe;try{if(hs.transition=null,Oe=1,C)return C()}finally{Oe=J,hs.transition=R,Ar=k,(Ar&6)===0&&As()}}function yp(){vl=tu.current,sn(tu)}function bh(C,k){C.finishedWork=null,C.finishedLanes=0;var R=C.timeoutHandle;if(R!==te&&(C.timeoutHandle=te,se(R)),Wr!==null)for(R=Wr.return;R!==null;){var J=R;switch(si(J),J.tag){case 1:J=J.type.childContextTypes,J!=null&&li();break;case 3:yh(),sn(ui),sn(Wn),ho();break;case 5:Cc(J);break;case 4:yh();break;case 13:sn(er);break;case 19:sn(er);break;case 10:cs(J.type._context);break;case 22:case 23:yp()}R=R.return}if(Ms=C,Wr=C=zA(C.current,null),Uo=vl=k,po=0,pp=null,wh=WA=Nd=0,Ol=gp=null,Qa!==null){for(k=0;k<Qa.length;k++)if(R=Qa[k],J=R.interleaved,J!==null){R.interleaved=null;var re=J.next,pe=R.pending;if(pe!==null){var ze=pe.next;pe.next=re,J.next=ze}R.pending=J}Qa=null}return C}function _h(C,k){do{var R=Wr;try{if(Fr(),Sc.current=UA,ap){for(var J=Is.memoizedState;J!==null;){var re=J.queue;re!==null&&(re.pending=null),J=J.next}ap=!1}if(Xa=0,Jo=Mo=Is=null,MA=!1,RA=0,yl.current=null,R===null||R.return===null){po=1,pp=k,Wr=null;break}e:{var pe=C,ze=R.return,Bt=R,tn=k;if(k=Uo,Bt.flags|=32768,tn!==null&&typeof tn=="object"&&typeof tn.then=="function"){var qn=tn,ki=Bt,Cr=ki.tag;if((ki.mode&1)===0&&(Cr===0||Cr===11||Cr===15)){var gi=ki.alternate;gi?(ki.updateQueue=gi.updateQueue,ki.memoizedState=gi.memoizedState,ki.lanes=gi.lanes):(ki.updateQueue=null,ki.memoizedState=null)}var go=Ew(ze);if(go!==null){go.flags&=-257,w1(go,ze,Bt,pe,k),go.mode&1&&Bw(pe,qn,k),k=go,tn=qn;var Ws=k.updateQueue;if(Ws===null){var Ec=new Set;Ec.add(tn),k.updateQueue=Ec}else Ws.add(tn);break e}else{if((k&1)===0){Bw(pe,qn,k),Ch();break e}tn=Error(o(426))}}else if(pi&&Bt.mode&1){var Od=Ew(ze);if(Od!==null){(Od.flags&65536)===0&&(Od.flags|=256),w1(Od,ze,Bt,pe,k),$c(Ka(tn,Bt));break e}}pe=tn=Ka(tn,Bt),po!==4&&(po=2),gp===null?gp=[pe]:gp.push(pe),pe=ze;do{switch(pe.tag){case 3:pe.flags|=65536,k&=-k,pe.lanes|=k;var qt=eu(pe,tn,k);Vc(pe,qt);break e;case 1:Bt=tn;var Dt=pe.type,hn=pe.stateNode;if((pe.flags&128)===0&&(typeof Dt.getDerivedStateFromError=="function"||hn!==null&&typeof hn.componentDidCatch=="function"&&(xh===null||!xh.has(hn)))){pe.flags|=65536,k&=-k,pe.lanes|=k;var mi=sc(pe,Bt,k);Vc(pe,mi);break e}}pe=pe.return}while(pe!==null)}t0(R)}catch(Yi){k=Yi,Wr===R&&R!==null&&(Wr=R=R.return);continue}break}while(!0)}function su(){var C=bs.current;return bs.current=UA,C===null?UA:C}function Ch(){(po===0||po===3||po===2)&&(po=4),Ms===null||(Nd&268435455)===0&&(WA&268435455)===0||ru(Ms,Uo)}function Rd(C,k){var R=Ar;Ar|=2;var J=su();(Ms!==C||Uo!==k)&&(Tc=null,bh(C,k));do try{E1();break}catch(re){_h(C,re)}while(!0);if(Fr(),Ar=R,bs.current=J,Wr!==null)throw Error(o(261));return Ms=null,Uo=0,po}function E1(){for(;Wr!==null;)Mw(Wr)}function Lw(){for(;Wr!==null&&!me();)Mw(Wr)}function Mw(C){var k=_8(C.alternate,C,vl);C.memoizedProps=C.pendingProps,k===null?t0(C):Wr=k,yl.current=null}function t0(C){var k=C;do{var R=k.alternate;if(C=k.return,(k.flags&32768)===0){if(R=St(R,k,vl),R!==null){Wr=R;return}}else{if(R=Nt(R,k),R!==null){R.flags&=32767,Wr=R;return}if(C!==null)C.flags|=32768,C.subtreeFlags=0,C.deletions=null;else{po=6,Wr=null;return}}if(k=k.sibling,k!==null){Wr=k;return}Wr=k=C}while(k!==null);po===0&&(po=5)}function ou(C,k,R){var J=Oe,re=hs.transition;try{hs.transition=null,Oe=1,dY(C,k,R,J)}finally{hs.transition=re,Oe=J}return null}function dY(C,k,R,J){do vp();while(nu!==null);if((Ar&6)!==0)throw Error(o(327));R=C.finishedWork;var re=C.finishedLanes;if(R===null)return null;if(C.finishedWork=null,C.finishedLanes=0,R===C.current)throw Error(o(177));C.callbackNode=null,C.callbackPriority=0;var pe=R.lanes|R.childLanes;if(ke(C,pe),C===Ms&&(Wr=Ms=null,Uo=0),(R.subtreeFlags&2064)===0&&(R.flags&2064)===0||$u||($u=!0,C8(Ct,function(){return vp(),null})),pe=(R.flags&15990)!==0,(R.subtreeFlags&15990)!==0||pe){pe=hs.transition,hs.transition=null;var ze=Oe;Oe=1;var Bt=Ar;Ar|=4,yl.current=null,Ci(C,R),ja(R,C),Z(C.containerInfo),C.current=R,ta(R),Xe(),Ar=Bt,Oe=ze,hs.transition=pe}else C.current=R;if($u&&($u=!1,nu=C,Zg=re),pe=C.pendingLanes,pe===0&&(xh=null),Qn(R.stateNode),wl(C,qe()),k!==null)for(J=C.onRecoverableError,R=0;R<k.length;R++)re=k[R],J(re.value,{componentStack:re.stack,digest:re.digest});if(mp)throw mp=!1,C=QA,QA=null,C;return(Zg&1)!==0&&C.tag!==0&&vp(),pe=C.pendingLanes,(pe&1)!==0?C===Jg?Vu++:(Vu=0,Jg=C):Vu=0,As(),null}function vp(){if(nu!==null){var C=nt(Zg),k=hs.transition,R=Oe;try{if(hs.transition=null,Oe=16>C?16:C,nu===null)var J=!1;else{if(C=nu,nu=null,Zg=0,(Ar&6)!==0)throw Error(o(331));var re=Ar;for(Ar|=4,Tt=C.current;Tt!==null;){var pe=Tt,ze=pe.child;if((Tt.flags&16)!==0){var Bt=pe.deletions;if(Bt!==null){for(var tn=0;tn<Bt.length;tn++){var qn=Bt[tn];for(Tt=qn;Tt!==null;){var ki=Tt;switch(ki.tag){case 0:case 11:case 15:lr(8,ki,pe)}var Cr=ki.child;if(Cr!==null)Cr.return=ki,Tt=Cr;else for(;Tt!==null;){ki=Tt;var gi=ki.sibling,go=ki.return;if(Ro(ki),ki===qn){Tt=null;break}if(gi!==null){gi.return=go,Tt=gi;break}Tt=go}}}var Ws=pe.alternate;if(Ws!==null){var Ec=Ws.child;if(Ec!==null){Ws.child=null;do{var Od=Ec.sibling;Ec.sibling=null,Ec=Od}while(Ec!==null)}}Tt=pe}}if((pe.subtreeFlags&2064)!==0&&ze!==null)ze.return=pe,Tt=ze;else e:for(;Tt!==null;){if(pe=Tt,(pe.flags&2048)!==0)switch(pe.tag){case 0:case 11:case 15:lr(9,pe,pe.return)}var qt=pe.sibling;if(qt!==null){qt.return=pe.return,Tt=qt;break e}Tt=pe.return}}var Dt=C.current;for(Tt=Dt;Tt!==null;){ze=Tt;var hn=ze.child;if((ze.subtreeFlags&2064)!==0&&hn!==null)hn.return=ze,Tt=hn;else e:for(ze=Dt;Tt!==null;){if(Bt=Tt,(Bt.flags&2048)!==0)try{switch(Bt.tag){case 0:case 11:case 15:Si(9,Bt)}}catch(Yi){_o(Bt,Bt.return,Yi)}if(Bt===ze){Tt=null;break e}var mi=Bt.sibling;if(mi!==null){mi.return=Bt.return,Tt=mi;break e}Tt=Bt.return}}if(Ar=re,As(),Qt&&typeof Qt.onPostCommitFiberRoot=="function")try{Qt.onPostCommitFiberRoot(fn,C)}catch{}J=!0}return J}finally{Oe=R,hs.transition=k}}return!1}function x8(C,k,R){k=Ka(R,k),k=eu(C,k,1),C=Ss(C,k,1),k=La(),C!==null&&(ue(C,1,k),wl(C,k))}function _o(C,k,R){if(C.tag===3)x8(C,C,R);else for(;k!==null;){if(k.tag===3){x8(k,C,R);break}else if(k.tag===1){var J=k.stateNode;if(typeof k.type.getDerivedStateFromError=="function"||typeof J.componentDidCatch=="function"&&(xh===null||!xh.has(J))){C=Ka(R,C),C=sc(k,C,1),k=Ss(k,C,1),C=La(),k!==null&&(ue(k,1,C),wl(k,C));break}}k=k.return}}function AY(C,k,R){var J=C.pingCache;J!==null&&J.delete(k),k=La(),C.pingedLanes|=C.suspendedLanes&R,Ms===C&&(Uo&R)===R&&(po===4||po===3&&(Uo&130023424)===Uo&&500>qe()-T1?bh(C,0):wh|=R),wl(C,k)}function b8(C,k){k===0&&((C.mode&1)===0?k=1:(k=Xt,Xt<<=1,(Xt&130023424)===0&&(Xt=4194304)));var R=La();C=Va(C,k),C!==null&&(ue(C,k,R),wl(C,R))}function fY(C){var k=C.memoizedState,R=0;k!==null&&(R=k.retryLane),b8(C,R)}function pY(C,k){var R=0;switch(C.tag){case 13:var J=C.stateNode,re=C.memoizedState;re!==null&&(R=re.retryLane);break;case 19:J=C.stateNode;break;default:throw Error(o(314))}J!==null&&J.delete(k),b8(C,R)}var _8;_8=function(C,k,R){if(C!==null)if(C.memoizedProps!==k.pendingProps||ui.current)pl=!0;else{if((C.lanes&R)===0&&(k.flags&128)===0)return pl=!1,de(C,k,R);pl=(C.flags&131072)!==0}else pl=!1,pi&&(k.flags&1048576)!==0&&ln(k,Vn,k.index);switch(k.lanes=0,k.tag){case 2:var J=k.type;$(C,k),C=k.pendingProps;var re=Gn(k,Wn.current);bo(k,R),re=Rg(null,k,J,C,re,R);var pe=Og();return k.flags|=1,typeof re=="object"&&re!==null&&typeof re.render=="function"&&re.$$typeof===void 0?(k.tag=1,k.memoizedState=null,k.updateQueue=null,Dn(J)?(pe=!0,Xn(k)):pe=!1,k.memoizedState=re.state!==null&&re.state!==void 0?re.state:null,gh(k),re.updater=Gg,k.stateNode=re,re._reactInternals=k,vh(k,J,C,R),k=_1(null,k,J,!0,pe,R)):(k.tag=0,pi&&pe&&vn(k),qa(null,k,re,R),k=k.child),k;case 16:J=k.elementType;e:{switch($(C,k),C=k.pendingProps,re=J._init,J=re(J._payload),k.type=J,re=k.tag=mY(J),C=Xc(J,C),re){case 0:k=x1(null,k,J,C,R);break e;case 1:k=b1(null,k,J,C,R);break e;case 11:k=Iw(null,k,J,C,R);break e;case 14:k=Ap(null,k,J,Xc(J.type,C),R);break e}throw Error(o(306,J,""))}return k;case 0:return J=k.type,re=k.pendingProps,re=k.elementType===J?re:Xc(J,re),x1(C,k,J,re,R);case 1:return J=k.type,re=k.pendingProps,re=k.elementType===J?re:Xc(J,re),b1(C,k,J,re,R);case 3:e:{if(Fw(k),C===null)throw Error(o(387));J=k.pendingProps,pe=k.memoizedState,re=pe.element,NA(C,k),nc(k,J,null,R);var ze=k.memoizedState;if(J=ze.element,_e&&pe.isDehydrated)if(pe={element:J,isDehydrated:!1,cache:ze.cache,pendingSuspenseBoundaries:ze.pendingSuspenseBoundaries,transitions:ze.transitions},k.updateQueue.baseState=pe,k.memoizedState=pe,k.flags&256){re=Ka(Error(o(423)),k),k=Dw(C,k,J,R,re);break e}else if(J!==re){re=Ka(Error(o(424)),k),k=Dw(C,k,J,R,re);break e}else for(_e&&(Fi=at(k.stateNode.containerInfo),oi=k,pi=!0,Hr=null,Ir=!1),R=Ft(k,null,J,R),k.child=R;R;)R.flags=R.flags&-3|4096,R=R.sibling;else{if(Qc(),J===re){k=oe(C,k,R);break e}qa(C,k,J,R)}k=k.child}return k;case 5:return Ll(k),C===null&&fs(k),J=k.type,re=k.pendingProps,pe=C!==null?C.memoizedProps:null,ze=re.children,G(J,re)?ze=null:pe!==null&&G(J,pe)&&(k.flags|=32),Xg(C,k),qa(C,k,ze,R),k.child;case 6:return C===null&&fs(k),null;case 13:return jw(C,k,R);case 4:return zc(k,k.stateNode.containerInfo),J=k.pendingProps,C===null?k.child=Ne(k,null,J,R):qa(C,k,J,R),k.child;case 11:return J=k.type,re=k.pendingProps,re=k.elementType===J?re:Xc(J,re),Iw(C,k,J,re,R);case 7:return qa(C,k,k.pendingProps,R),k.child;case 8:return qa(C,k,k.pendingProps.children,R),k.child;case 12:return qa(C,k,k.pendingProps.children,R),k.child;case 10:e:{if(J=k.type._context,re=k.pendingProps,pe=k.memoizedProps,ze=re.value,Mr(k,J,ze),pe!==null)if(Nn(pe.value,ze)){if(pe.children===re.children&&!ui.current){k=oe(C,k,R);break e}}else for(pe=k.child,pe!==null&&(pe.return=k);pe!==null;){var Bt=pe.dependencies;if(Bt!==null){ze=pe.child;for(var tn=Bt.firstContext;tn!==null;){if(tn.context===J){if(pe.tag===1){tn=za(-1,R&-R),tn.tag=2;var qn=pe.updateQueue;if(qn!==null){qn=qn.shared;var ki=qn.pending;ki===null?tn.next=tn:(tn.next=ki.next,ki.next=tn),qn.pending=tn}}pe.lanes|=R,tn=pe.alternate,tn!==null&&(tn.lanes|=R),Nl(pe.return,R,k),Bt.lanes|=R;break}tn=tn.next}}else if(pe.tag===10)ze=pe.type===k.type?null:pe.child;else if(pe.tag===18){if(ze=pe.return,ze===null)throw Error(o(341));ze.lanes|=R,Bt=ze.alternate,Bt!==null&&(Bt.lanes|=R),Nl(ze,R,k),ze=pe.sibling}else ze=pe.child;if(ze!==null)ze.return=pe;else for(ze=pe;ze!==null;){if(ze===k){ze=null;break}if(pe=ze.sibling,pe!==null){pe.return=ze.return,ze=pe;break}ze=ze.return}pe=ze}qa(C,k,re.children,R),k=k.child}return k;case 9:return re=k.type,J=k.pendingProps.children,bo(k,R),re=eo(re),J=J(re),k.flags|=1,qa(C,k,J,R),k.child;case 14:return J=k.type,re=Xc(J,k.pendingProps),re=Xc(J.type,re),Ap(C,k,J,re,R);case 15:return fp(C,k,k.type,k.pendingProps,R);case 17:return J=k.type,re=k.pendingProps,re=k.elementType===J?re:Xc(J,re),$(C,k),k.tag=1,Dn(J)?(C=!0,Xn(k)):C=!1,bo(k,R),Cw(k,J,re),vh(k,J,re,R),_1(null,k,J,!0,C,R);case 19:return N(C,k,R);case 22:return HA(C,k,R)}throw Error(o(156,k.tag))};function C8(C,k){return gt(C,k)}function gY(C,k,R,J){this.tag=C,this.key=R,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=k,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=J,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sh(C,k,R,J){return new gY(C,k,R,J)}function SS(C){return C=C.prototype,!(!C||!C.isReactComponent)}function mY(C){if(typeof C=="function")return SS(C)?1:0;if(C!=null){if(C=C.$$typeof,C===p)return 11;if(C===m)return 14}return 2}function zA(C,k){var R=C.alternate;return R===null?(R=Sh(C.tag,k,C.key,C.mode),R.elementType=C.elementType,R.type=C.type,R.stateNode=C.stateNode,R.alternate=C,C.alternate=R):(R.pendingProps=k,R.type=C.type,R.flags=0,R.subtreeFlags=0,R.deletions=null),R.flags=C.flags&14680064,R.childLanes=C.childLanes,R.lanes=C.lanes,R.child=C.child,R.memoizedProps=C.memoizedProps,R.memoizedState=C.memoizedState,R.updateQueue=C.updateQueue,k=C.dependencies,R.dependencies=k===null?null:{lanes:k.lanes,firstContext:k.firstContext},R.sibling=C.sibling,R.index=C.index,R.ref=C.ref,R}function Rw(C,k,R,J,re,pe){var ze=2;if(J=C,typeof C=="function")SS(C)&&(ze=1);else if(typeof C=="string")ze=5;else e:switch(C){case u:return wp(R.children,re,pe,k);case d:ze=8,re|=8;break;case f:return C=Sh(12,R,k,re|2),C.elementType=f,C.lanes=pe,C;case y:return C=Sh(13,R,k,re),C.elementType=y,C.lanes=pe,C;case v:return C=Sh(19,R,k,re),C.elementType=v,C.lanes=pe,C;case x:return Ow(R,re,pe,k);default:if(typeof C=="object"&&C!==null)switch(C.$$typeof){case A:ze=10;break e;case g:ze=9;break e;case p:ze=11;break e;case m:ze=14;break e;case w:ze=16,J=null;break e}throw Error(o(130,C==null?C:typeof C,""))}return k=Sh(ze,R,k,re),k.elementType=C,k.type=J,k.lanes=pe,k}function wp(C,k,R,J){return C=Sh(7,C,J,k),C.lanes=R,C}function Ow(C,k,R,J){return C=Sh(22,C,J,k),C.elementType=x,C.lanes=R,C.stateNode={isHidden:!1},C}function TS(C,k,R){return C=Sh(6,C,null,k),C.lanes=R,C}function BS(C,k,R){return k=Sh(4,C.children!==null?C.children:[],C.key,k),k.lanes=R,k.stateNode={containerInfo:C.containerInfo,pendingChildren:null,implementation:C.implementation},k}function yY(C,k,R,J,re){this.tag=k,this.containerInfo=C,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=te,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Qr(0),this.expirationTimes=Qr(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qr(0),this.identifierPrefix=J,this.onRecoverableError=re,_e&&(this.mutableSourceEagerHydrationData=null)}function S8(C,k,R,J,re,pe,ze,Bt,tn){return C=new yY(C,k,R,Bt,tn),k===1?(k=1,pe===!0&&(k|=8)):k=0,pe=Sh(3,null,null,k),C.current=pe,pe.stateNode=C,pe.memoizedState={element:J,isDehydrated:R,cache:null,transitions:null,pendingSuspenseBoundaries:null},gh(pe),C}function T8(C){if(!C)return Li;C=C._reactInternals;e:{if(_(C)!==C||C.tag!==1)throw Error(o(170));var k=C;do{switch(k.tag){case 3:k=k.stateNode.context;break e;case 1:if(Dn(k.type)){k=k.stateNode.__reactInternalMemoizedMergedChildContext;break e}}k=k.return}while(k!==null);throw Error(o(171))}if(C.tag===1){var R=C.type;if(Dn(R))return Rt(C,R,k)}return k}function B8(C){var k=C._reactInternals;if(k===void 0)throw typeof C.render=="function"?Error(o(188)):(C=Object.keys(C).join(","),Error(o(268,C)));return C=F(k),C===null?null:C.stateNode}function E8(C,k){if(C=C.memoizedState,C!==null&&C.dehydrated!==null){var R=C.retryLane;C.retryLane=R!==0&&R<k?R:k}}function Uw(C,k){E8(C,k),(C=C.alternate)&&E8(C,k)}function vY(C){return C=F(C),C===null?null:C.stateNode}function wY(){return null}return t.attemptContinuousHydration=function(C){if(C.tag===13){var k=Va(C,134217728);if(k!==null){var R=La();Bc(k,C,134217728,R)}Uw(C,134217728)}},t.attemptDiscreteHydration=function(C){if(C.tag===13){var k=Va(C,1);if(k!==null){var R=La();Bc(k,C,1,R)}Uw(C,1)}},t.attemptHydrationAtCurrentPriority=function(C){if(C.tag===13){var k=iu(C),R=Va(C,k);if(R!==null){var J=La();Bc(R,C,k,J)}Uw(C,k)}},t.attemptSynchronousHydration=function(C){switch(C.tag){case 3:var k=C.stateNode;if(k.current.memoizedState.isDehydrated){var R=_i(k.pendingLanes);R!==0&&(Me(k,R|1),wl(k,qe()),(Ar&6)===0&&(Ld(),As()))}break;case 13:VA(function(){var J=Va(C,1);if(J!==null){var re=La();Bc(J,C,1,re)}}),Uw(C,1)}},t.batchedUpdates=function(C,k){var R=Ar;Ar|=1;try{return C(k)}finally{Ar=R,Ar===0&&(Ld(),tr&&As())}},t.createComponentSelector=function(C){return{$$typeof:Oo,value:C}},t.createContainer=function(C,k,R,J,re,pe,ze){return S8(C,k,!1,null,R,J,re,pe,ze)},t.createHasPseudoClassSelector=function(C){return{$$typeof:Ml,value:C}},t.createHydrationContainer=function(C,k,R,J,re,pe,ze,Bt,tn){return C=S8(R,J,!0,C,re,pe,ze,Bt,tn),C.context=T8(null),R=C.current,J=La(),re=iu(R),pe=za(J,re),pe.callback=k??null,Ss(R,pe,re),C.current.lanes=re,ue(C,re,J),wl(C,J),C},t.createPortal=function(C,k,R){var J=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:h,key:J==null?null:""+J,children:C,containerInfo:k,implementation:R}},t.createRoleSelector=function(C){return{$$typeof:no,value:C}},t.createTestNameSelector=function(C){return{$$typeof:Pa,value:C}},t.createTextSelector=function(C){return{$$typeof:ms,value:C}},t.deferredUpdates=function(C){var k=Oe,R=hs.transition;try{return hs.transition=null,Oe=16,C()}finally{Oe=k,hs.transition=R}},t.discreteUpdates=function(C,k,R,J,re){var pe=Oe,ze=hs.transition;try{return hs.transition=null,Oe=1,C(k,R,J,re)}finally{Oe=pe,hs.transition=ze,Ar===0&&Ld()}},t.findAllNodes=Za,t.findBoundingRects=function(C,k){if(!xe)throw Error(o(363));k=Za(C,k),C=[];for(var R=0;R<k.length;R++)C.push(Ce(k[R]));for(k=C.length-1;0<k;k--){R=C[k];for(var J=R.x,re=J+R.width,pe=R.y,ze=pe+R.height,Bt=k-1;0<=Bt;Bt--)if(k!==Bt){var tn=C[Bt],qn=tn.x,ki=qn+tn.width,Cr=tn.y,gi=Cr+tn.height;if(J>=qn&&pe>=Cr&&re<=ki&&ze<=gi){C.splice(k,1);break}else if(J!==qn||R.width!==tn.width||gi<pe||Cr>ze){if(!(pe!==Cr||R.height!==tn.height||ki<J||qn>re)){qn>J&&(tn.width+=qn-J,tn.x=J),ki<re&&(tn.width=re-qn),C.splice(k,1);break}}else{Cr>pe&&(tn.height+=Cr-pe,tn.y=pe),gi<ze&&(tn.height=ze-Cr),C.splice(k,1);break}}}return C},t.findHostInstance=B8,t.findHostInstanceWithNoPortals=function(C){return C=S(C),C=C!==null?E(C):null,C===null?null:C.stateNode},t.findHostInstanceWithWarning=function(C){return B8(C)},t.flushControlled=function(C){var k=Ar;Ar|=1;var R=hs.transition,J=Oe;try{hs.transition=null,Oe=1,C()}finally{Oe=J,hs.transition=R,Ar=k,Ar===0&&(Ld(),As())}},t.flushPassiveEffects=vp,t.flushSync=VA,t.focusWithin=function(C,k){if(!xe)throw Error(o(363));for(C=gl(C),k=Rl(C,k),k=Array.from(k),C=0;C<k.length;){var R=k[C++];if(!Ye(R)){if(R.tag===5&&ot(R.stateNode))return!0;for(R=R.child;R!==null;)k.push(R),R=R.sibling}}return!1},t.getCurrentUpdatePriority=function(){return Oe},t.getFindAllNodesFailureDescription=function(C,k){if(!xe)throw Error(o(363));var R=0,J=[];C=[gl(C),0];for(var re=0;re<C.length;){var pe=C[re++],ze=C[re++],Bt=k[ze];if((pe.tag!==5||!Ye(pe))&&(Na(pe,Bt)&&(J.push(ml(Bt)),ze++,ze>R&&(R=ze)),ze<k.length))for(pe=pe.child;pe!==null;)C.push(pe,ze),pe=pe.sibling}if(R<k.length){for(C=[];R<k.length;R++)C.push(ml(k[R]));return`findAllNodes was able to match part of the selector:
  `+(J.join(" > ")+`

No matching component was found for:
  `)+C.join(" > ")}return null},t.getPublicRootInstance=function(C){if(C=C.current,!C.child)return null;switch(C.child.tag){case 5:return K(C.child.stateNode);default:return C.child.stateNode}},t.injectIntoDevTools=function(C){if(C={bundleType:C.bundleType,version:C.version,rendererPackageName:C.rendererPackageName,rendererConfig:C.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:vY,findFiberByHostInstance:C.findFiberByHostInstance||wY,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")C=!1;else{var k=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(k.isDisabled||!k.supportsFiber)C=!0;else{try{fn=k.inject(C),Qt=k}catch{}C=!!k.checkDCE}}return C},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(C,k,R,J){if(!xe)throw Error(o(363));C=Za(C,k);var re=rt(C,R,J).disconnect;return{disconnect:function(){re()}}},t.registerMutableSourceForHydration=function(C,k){var R=k._getVersion;R=R(k._source),C.mutableSourceEagerHydrationData==null?C.mutableSourceEagerHydrationData=[k,R]:C.mutableSourceEagerHydrationData.push(k,R)},t.runWithPriority=function(C,k){var R=Oe;try{return Oe=C,k()}finally{Oe=R}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(C,k,R,J){var re=k.current,pe=La(),ze=iu(re);return R=T8(R),k.context===null?k.context=R:k.pendingContext=R,k=za(pe,ze),k.payload={element:C},J=J===void 0?null:J,J!==null&&(k.callback=J),C=Ss(re,k,ze),C!==null&&(Bc(C,re,ze,pe),LA(C,re,ze)),ze},t}),sB}var vO;function uGe(){return vO||(vO=1,nB.exports=hGe()),nB.exports}var dGe=uGe();const AGe=Kf(dGe);var oB={exports:{}},lf={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wO;function fGe(){return wO||(wO=1,lf.ConcurrentRoot=1,lf.ContinuousEventPriority=4,lf.DefaultEventPriority=16,lf.DiscreteEventPriority=1,lf.IdleEventPriority=536870912,lf.LegacyRoot=0),lf}var xO;function pGe(){return xO||(xO=1,oB.exports=fGe()),oB.exports}var Hq=pGe(),gGe=Ur();const bO={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let _O=!1,CO=!1;const m8=".react-konva-event",mGe=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,yGe=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,vGe={};function gS(n,e,t=vGe){if(!_O&&"zIndex"in e&&(console.warn(yGe),_O=!0),!CO&&e.draggable){var i=e.x!==void 0||e.y!==void 0,r=e.onDragEnd||e.onDragMove;i&&!r&&(console.warn(mGe),CO=!0)}for(var s in t)if(!bO[s]){var o=s.slice(0,2)==="on",a=t[s]!==e[s];if(o&&a){var c=s.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),n.off(c,t[s])}var h=!e.hasOwnProperty(s);h&&n.setAttr(s,void 0)}var u=e._useStrictMode,d={},f=!1;const A={};for(var s in e)if(!bO[s]){var o=s.slice(0,2)==="on",g=t[s]!==e[s];if(o&&g){var c=s.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),e[s]&&(A[c]=e[s])}!o&&(e[s]!==t[s]||u&&e[s]!==n.getAttr(s))&&(f=!0,d[s]=e[s])}f&&(n.setAttrs(d),op(n));for(var c in A)n.on(c+m8,A[c])}function op(n){if(!gGe.Konva.autoDrawEnabled){var e=n.getLayer()||n.getStage();e&&e.batchDraw()}}var aB=Uq();const Wq={},wGe={};Ev.Node.prototype._applyProps=gS;function xGe(n,e){if(typeof e=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${e}`);return}n.add(e),op(n)}function bGe(n,e,t){let i=Ev[n];i||(console.error(`Konva has no node with the type ${n}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${n}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),i=Ev.Group);const r={},s={};for(var o in e){var a=o.slice(0,2)==="on";a?s[o]=e[o]:r[o]=e[o]}const c=new i(r);return gS(c,s),c}function _Ge(n,e,t){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${n}"`)}function CGe(n,e,t){return!1}function SGe(n){return n}function TGe(){return null}function BGe(){return null}function EGe(n,e,t,i){return wGe}function kGe(){}function IGe(n){}function FGe(n,e){return!1}function DGe(){return Wq}function jGe(){return Wq}const PGe=setTimeout,NGe=clearTimeout,LGe=-1;function MGe(n,e){return!1}const RGe=!1,OGe=!0,UGe=!0;function HGe(n,e){e.parent===n?e.moveToTop():n.add(e),op(n)}function WGe(n,e){e.parent===n?e.moveToTop():n.add(e),op(n)}function Qq(n,e,t){e._remove(),n.add(e),e.setZIndex(t.getZIndex()),op(n)}function QGe(n,e,t){Qq(n,e,t)}function $Ge(n,e){e.destroy(),e.off(m8),op(n)}function VGe(n,e){e.destroy(),e.off(m8),op(n)}function zGe(n,e,t){console.error(`Text components are not yet supported in ReactKonva. You text is: "${t}"`)}function GGe(n,e,t){}function XGe(n,e,t,i,r){gS(n,r,i)}function KGe(n){n.hide(),op(n)}function qGe(n){}function YGe(n,e){(e.visible==null||e.visible)&&n.show()}function ZGe(n,e){}function JGe(n){}function eXe(){}const tXe=()=>Hq.DefaultEventPriority,nXe=Object.freeze(Object.defineProperty({__proto__:null,appendChild:HGe,appendChildToContainer:WGe,appendInitialChild:xGe,cancelTimeout:NGe,clearContainer:JGe,commitMount:GGe,commitTextUpdate:zGe,commitUpdate:XGe,createInstance:bGe,createTextInstance:_Ge,detachDeletedInstance:eXe,finalizeInitialChildren:CGe,getChildHostContext:jGe,getCurrentEventPriority:tXe,getPublicInstance:SGe,getRootHostContext:DGe,hideInstance:KGe,hideTextInstance:qGe,idlePriority:aB.unstable_IdlePriority,insertBefore:Qq,insertInContainerBefore:QGe,isPrimaryRenderer:RGe,noTimeout:LGe,now:aB.unstable_now,prepareForCommit:TGe,preparePortalMount:BGe,prepareUpdate:EGe,removeChild:$Ge,removeChildFromContainer:VGe,resetAfterCommit:kGe,resetTextContent:IGe,run:aB.unstable_runWithPriority,scheduleTimeout:PGe,shouldDeprioritizeSubtree:FGe,shouldSetTextContent:MGe,supportsMutation:UGe,unhideInstance:YGe,unhideTextInstance:ZGe,warnsIfNotActing:OGe},Symbol.toStringTag,{value:"Module"}));function iXe(n){const e=ii.useRef({});return ii.useLayoutEffect(()=>{e.current=n}),ii.useLayoutEffect(()=>()=>{e.current={}},[]),e.current}const rXe=n=>{const e=ii.useRef(),t=ii.useRef(),i=ii.useRef(),r=iXe(n),s=LY(),o=a=>{const{forwardedRef:c}=n;c&&(typeof c=="function"?c(a):c.current=a)};return ii.useLayoutEffect(()=>(t.current=new Ev.Stage({width:n.width,height:n.height,container:e.current}),o(t.current),i.current=cy.createContainer(t.current,Hq.LegacyRoot,!1,null),cy.updateContainer(ii.createElement(s,{},n.children),i.current),()=>{Ev.isBrowser&&(o(null),cy.updateContainer(null,i.current,null),t.current.destroy())}),[]),ii.useLayoutEffect(()=>{o(t.current),gS(t.current,n,r),cy.updateContainer(ii.createElement(s,{},n.children),i.current,null)}),ii.createElement("div",{ref:e,id:n.id,accessKey:n.accessKey,className:n.className,role:n.role,style:n.style,tabIndex:n.tabIndex,title:n.title})},sXe="Layer",og="Group",Kp="Rect",lB="Circle",mu="Line",Nm="Text",cy=AGe(nXe);cy.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:ii.version,rendererPackageName:"react-konva"});const oXe=ii.forwardRef((n,e)=>ii.createElement(NY,{},ii.createElement(rXe,{...n,forwardedRef:e}))),aXe=({item:n,scale:e,isSelected:t,isDragging:i,onSelect:r,onDragStart:s,onDragEnd:o,onRotate:a,onDelete:c,onDoubleClick:h,mmToPixels:u})=>{const d=O.useRef(null),[f,A]=O.useState(!1),[g,p]=O.useState(n.rotation||0),y=Hi(n.moduleId),v=u(n.position.x),m=u(n.position.z),w=u(n.dimensions.width),x=u(n.dimensions.depth),T=I=>{const F=I.target.rotation();p(F),a(n.id,F)},j=()=>{if(i)return"#4CAF50";if(t)return"#1976D2";if(f)return"#42A5F5";switch(y==null?void 0:y.type){case"cabinet":return"#2196F3";case"drawer":return"#FF9800";case"shelf":return"#9C27B0";case"door":return"#00BCD4";default:return"#607D8B"}},D=()=>{h&&h(n.id)},b=()=>{const I=[];if((y==null?void 0:y.type)==="cabinet"&&n.hasDoors){const S=4/e,F=10/e;I.push(l.jsx(lB,{x:F,y:x/2,radius:S,fill:"#666",stroke:"#333",strokeWidth:1/e},"handle-left")),n.dimensions.width>600&&I.push(l.jsx(lB,{x:w-F,y:x/2,radius:S,fill:"#666",stroke:"#333",strokeWidth:1/e},"handle-right"))}if((y==null?void 0:y.type)==="drawer"){const S=Math.floor(n.dimensions.height/200);for(let F=1;F<S;F++){const B=x/S*F;I.push(l.jsx(mu,{points:[5/e,B,w-5/e,B],stroke:"#999",strokeWidth:1/e},`drawer-line-${F}`))}}return l.jsx(l.Fragment,{children:I})},_=()=>{if(!t)return null;const I=6/e,S=2/e;return l.jsxs(l.Fragment,{children:[l.jsx(Kp,{x:-S,y:-S,width:w+S*2,height:x+S*2,stroke:"#1976D2",strokeWidth:S,fill:"transparent",dash:[5/e,5/e]}),l.jsx(lB,{x:w/2,y:-20/e,radius:I,fill:"#1976D2",stroke:"white",strokeWidth:S,draggable:!0,onDragMove:F=>{const B=F.target,E=d.current;if(!E)return;const V=E.x()+w/2,K=E.y()+x/2,P=Math.atan2(B.y()+E.y()-K,B.x()+E.x()-V)*180/Math.PI+90;E.rotation(P)},onDragEnd:T}),[{x:0,y:0},{x:w,y:0},{x:w,y:x},{x:0,y:x}].map((F,B)=>l.jsx(Kp,{x:F.x-I/2,y:F.y-I/2,width:I,height:I,fill:"white",stroke:"#1976D2",strokeWidth:S},`handle-${B}`))]})};return l.jsxs(og,{ref:d,x:v,y:m,rotation:g,draggable:!0,onDragStart:()=>s(n.id),onDragEnd:I=>{const S=I.target,F=S.x()/.1,B=S.y()/.1;o(n.id,F,B)},onClick:()=>r(n.id),onDblClick:D,onMouseEnter:()=>A(!0),onMouseLeave:()=>A(!1),onTransformEnd:T,children:[l.jsx(Kp,{x:2/e,y:2/e,width:w,height:x,fill:"black",opacity:.2,cornerRadius:4/e}),l.jsx(Kp,{width:w,height:x,fill:j(),stroke:t?"#0D47A1":"#1565C0",strokeWidth:(t?2:1)/e,cornerRadius:4/e,opacity:i?.7:.9}),b(),l.jsx(Nm,{text:n.name||(y==null?void 0:y.name)||"Furniture",fontSize:Math.max(10,12/e),fill:"white",width:w,height:x,align:"center",verticalAlign:"middle",fontStyle:"bold",shadowColor:"black",shadowBlur:2/e,shadowOpacity:.5}),t&&l.jsx(Nm,{y:x+5/e,text:`${Math.round(n.dimensions.width)} x ${Math.round(n.dimensions.depth)}mm`,fontSize:10/e,fill:"#666",width:w,align:"center"}),_()]})},lXe=({width:n,height:e,gridSize:t,scale:i,showLabels:r=!1,labelInterval:s=5,color:o="#e0e0e0",opacity:a=.5})=>{const c=O.useMemo(()=>{const h=[],u=[],f=n*2,A=e*2,g=-n*1/2,p=-e*1/2,y=t*5,v=1/i,m=2/i;for(let w=g;w<=f+g;w+=t){const x=Math.abs(w%y)<.01,T=x?a:a*.5;if(h.push(l.jsx(mu,{points:[w,p,w,A+p],stroke:o,strokeWidth:x?m:v,opacity:T},`v-${w}`)),r&&x&&w>=0&&w<=n){const j=Math.round(w/.1);u.push(l.jsx(Nm,{x:w,y:-20/i,text:`${j}`,fontSize:10/i,fill:"#666",align:"center"},`label-x-${w}`))}}for(let w=p;w<=A+p;w+=t){const x=Math.abs(w%y)<.01,T=x?a:a*.5;if(h.push(l.jsx(mu,{points:[g,w,f+g,w],stroke:o,strokeWidth:x?m:v,opacity:T},`h-${w}`)),r&&x&&w>=0&&w<=e){const j=Math.round(w/.1);u.push(l.jsx(Nm,{x:-30/i,y:w,text:`${j}`,fontSize:10/i,fill:"#666",align:"center",verticalAlign:"middle"},`label-y-${w}`))}}return r&&h.push(l.jsx(mu,{points:[-10/i,0,10/i,0],stroke:"#ff0000",strokeWidth:2/i,opacity:.7},"origin-x"),l.jsx(mu,{points:[0,-10/i,0,10/i],stroke:"#00ff00",strokeWidth:2/i,opacity:.7},"origin-y")),{lines:h,labels:u}},[n,e,t,i,r,o,a]);return l.jsxs(og,{children:[l.jsx(og,{opacity:.5,children:c.lines}),r&&l.jsx(og,{children:c.labels})]})},cXe="_container_1qst1_1",hXe="_zoomLevel_1qst1_64",uXe="_toolbar_1qst1_95",dXe="_toolGroup_1qst1_109",AXe="_toolDivider_1qst1_115",fXe="_toolButton_1qst1_122",pXe="_active_1qst1_139",Cs={container:cXe,zoomLevel:hXe,toolbar:uXe,toolGroup:dXe,toolDivider:AXe,toolButton:fXe,active:pXe},gXe=({showGrid:n,showDimensions:e,showFurniture:t,showColumns:i,showWalls:r,tool:s,scale:o,onToggleGrid:a,onToggleDimensions:c,onToggleFurniture:h,onToggleColumns:u,onToggleWalls:d,onToolChange:f,onZoomIn:A,onZoomOut:g,onZoomReset:p,onExport:y,onImport:v})=>l.jsxs("div",{className:Cs.toolbar,children:[l.jsxs("div",{className:Cs.toolGroup,children:[l.jsx("button",{className:`${Cs.toolButton} ${s==="select"?Cs.active:""}`,onClick:()=>f("select"),title:"Select Tool (V)",children:l.jsx(dwe,{size:20})}),l.jsx("button",{className:`${Cs.toolButton} ${s==="pan"?Cs.active:""}`,onClick:()=>f("pan"),title:"Pan Tool (H)",children:l.jsx(fwe,{size:20})}),l.jsx("button",{className:`${Cs.toolButton} ${s==="measure"?Cs.active:""}`,onClick:()=>f("measure"),title:"Measure Tool (M)",children:l.jsx(a6,{size:20})})]}),l.jsx("div",{className:Cs.toolDivider}),l.jsxs("div",{className:Cs.toolGroup,children:[l.jsx("button",{className:`${Cs.toolButton} ${n?Cs.active:""}`,onClick:a,title:"Toggle Grid (G)",children:l.jsx(Zve,{size:20})}),l.jsx("button",{className:`${Cs.toolButton} ${e?Cs.active:""}`,onClick:c,title:"Toggle Dimensions (D)",children:l.jsx(a6,{size:20})}),l.jsx("button",{className:`${Cs.toolButton} ${t?Cs.active:""}`,onClick:h,title:"Toggle Furniture (F)",children:t?l.jsx(ZI,{size:20}):l.jsx(YI,{size:20})}),l.jsx("button",{className:`${Cs.toolButton} ${i?Cs.active:""}`,onClick:u,title:"Toggle Columns",children:l.jsx(pC,{size:20})}),l.jsx("button",{className:`${Cs.toolButton} ${r?Cs.active:""}`,onClick:d,title:"Toggle Walls",children:l.jsx(pC,{size:20})})]}),l.jsx("div",{className:Cs.toolDivider}),l.jsxs("div",{className:Cs.toolGroup,children:[l.jsx("button",{className:Cs.toolButton,onClick:A,title:"Zoom In (+)",children:l.jsx(Jz,{size:20})}),l.jsxs("span",{className:Cs.zoomLevel,children:[Math.round(o*100),"%"]}),l.jsx("button",{className:Cs.toolButton,onClick:g,title:"Zoom Out (-)",children:l.jsx(eG,{size:20})}),l.jsx("button",{className:Cs.toolButton,onClick:p,title:"Fit to View (Space)",children:l.jsx(lwe,{size:20})})]}),(y||v)&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:Cs.toolDivider}),l.jsxs("div",{className:Cs.toolGroup,children:[v&&l.jsx("button",{className:Cs.toolButton,onClick:v,title:"Import",children:l.jsx(tF,{size:20})}),y&&l.jsx("button",{className:Cs.toolButton,onClick:y,title:"Export",children:l.jsx(Wz,{size:20})})]})]})]}),mXe=100,SO=.1,TO=5,Db=1.1,yXe=100,vXe="konva-stage-container-2d",y8=({width:n=800,height:e=600,viewMode:t="2D",showGrid:i=!0,showDimensions:r=!0,showFurniture:s=!0})=>{const o=O.useRef(null),a=O.useRef(null),c=O.useRef(null),h=O.useRef(),u=O.useRef(!1),d=O.useRef(!1),f=qi(),A=ci(),g=Bi(),[p,y]=O.useState({x:0,y:0,scale:1}),[v,m]=O.useState({width:n,height:e}),[w,x]=O.useState(!1),[T,j]=O.useState(null),[D,b]=O.useState(null),[_,I]=O.useState("select"),[S,F]=O.useState(!0),[B,E]=O.useState(!0),[V,K]=O.useState(i),[P,M]=O.useState(r),[X,Z]=O.useState(s),Q=O.useCallback(ce=>ce*.1,[]),U=O.useCallback(()=>{h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{if(!d.current||!c.current)return;const ce=c.current.getBoundingClientRect();m(ne=>ne.width!==ce.width||ne.height!==ce.height?(console.log("[Space2DKonvaView] Size updated:",{width:ce.width,height:ce.height}),{width:ce.width,height:ce.height}):ne)},yXe)},[]);O.useEffect(()=>{if(d.current=!0,c.current&&!u.current){const he=c.current.getBoundingClientRect();m({width:he.width,height:he.height}),u.current=!0,console.log("[Space2DKonvaView] Initial mount, size set:",{width:he.width,height:he.height})}const ce=()=>{d.current&&U()},ne=()=>{d.current&&setTimeout(()=>{d.current&&U()},300)};return window.addEventListener("resize",ce),window.addEventListener("orientationchange",ne),()=>{d.current=!1,window.removeEventListener("resize",ce),window.removeEventListener("orientationchange",ne),h.current&&clearTimeout(h.current),o.current&&(console.log("[Space2DKonvaView] Cleaning up Konva stage"),o.current.destroy())}},[U]),O.useEffect(()=>{if(d.current&&f.width&&f.depth&&v.width>0&&v.height>0){const ce=Q(f.width),ne=Q(f.depth),he=v.width*.8/ce,xe=v.height*.8/ne,Te=Math.min(he,xe,1),Ce=(v.width-ce*Te)/2,Be=(v.height-ne*Te)/2;y({x:Ce,y:Be,scale:Te})}},[f.width,f.depth,v,Q]);const z=O.useCallback(ce=>{ce.evt.preventDefault();const ne=o.current;if(!ne)return;const he=p.scale,xe=ne.getPointerPosition();if(!xe)return;const Te={x:(xe.x-p.x)/he,y:(xe.y-p.y)/he},Ce=ce.evt.deltaY>0?-1:1,Be=Math.max(SO,Math.min(TO,he*(Ce>0?Db:1/Db)));y({scale:Be,x:xe.x-Te.x*Be,y:xe.y-Te.y*Be})},[p]),q=O.useCallback(ce=>{const ne=ce.target;y(he=>({...he,x:ne.x(),y:ne.y()}))},[]),G=O.useCallback(ce=>{b(ce)},[]),ie=O.useCallback(ce=>{x(!0),j(ce)},[]),H=O.useCallback((ce,ne,he)=>{var xe;x(!1),j(null),A.updateModule(ce,{position:{x:ne,y:((xe=A.placedModules.find(Te=>Te.id===ce))==null?void 0:xe.position.y)||0,z:he}})},[A]),se=O.useCallback((ce,ne)=>{A.updateModule(ce,{rotation:ne})},[A]),te=O.useCallback(ce=>{A.removeModule(ce),D===ce&&b(null)},[A,D]),fe=O.useCallback(()=>{y(ce=>({...ce,scale:Math.min(TO,ce.scale*Db)}))},[]),ye=O.useCallback(()=>{y(ce=>({...ce,scale:Math.max(SO,ce.scale/Db)}))},[]),be=O.useCallback(()=>{if(f.width&&f.depth){const ce=Q(f.width),ne=Q(f.depth),he=v.width*.8/ce,xe=v.height*.8/ne,Te=Math.min(he,xe,1),Ce=(v.width-ce*Te)/2,Be=(v.height-ne*Te)/2;y({x:Ce,y:Be,scale:Te})}},[f.width,f.depth,v,Q]),_e=()=>{const ce=Q(f.width),ne=Q(f.depth);return l.jsxs(og,{children:[l.jsx(Kp,{x:0,y:0,width:ce,height:ne,fill:"#f5f5f5",stroke:"#333",strokeWidth:2/p.scale}),S&&f.columns.map(he=>{const xe=Q(he.position.x),Te=Q(he.position.z),Ce=Q(he.size);return l.jsx(Kp,{x:xe-Ce/2,y:Te-Ce/2,width:Ce,height:Ce,fill:"#666",stroke:"#333",strokeWidth:1/p.scale},he.id)}),B&&f.walls.map(he=>{const xe=Q(he.position.x),Te=Q(he.position.z),Ce=Q(he.dimensions.width),Be=Q(he.dimensions.depth);return l.jsx(Kp,{x:xe,y:Te,width:Ce,height:Be,fill:"#999",stroke:"#333",strokeWidth:1/p.scale,opacity:.7},he.id)})]})},W=()=>X?l.jsx(og,{children:A.placedModules.map(ce=>l.jsx(aXe,{item:ce,scale:p.scale,isSelected:D===ce.id,isDragging:T===ce.id,onSelect:G,onDragStart:ie,onDragEnd:H,onRotate:se,onDelete:te,onDoubleClick:ne=>{g.setActivePopup({type:"furnitureEdit",id:ne})},mmToPixels:Q},ce.id))}):null,Y=()=>{if(!P)return null;const ce=Q(f.width),ne=Q(f.depth),he=14/p.scale,xe=30/p.scale;return l.jsxs(og,{children:[l.jsx(mu,{points:[0,-xe,ce,-xe],stroke:"#666",strokeWidth:1/p.scale}),l.jsx(mu,{points:[0,-xe-5/p.scale,0,-xe+5/p.scale],stroke:"#666",strokeWidth:1/p.scale}),l.jsx(mu,{points:[ce,-xe-5/p.scale,ce,-xe+5/p.scale],stroke:"#666",strokeWidth:1/p.scale}),l.jsx(Nm,{x:ce/2,y:-xe-he,text:`${f.width}mm`,fontSize:he,fill:"#666",align:"center"}),l.jsx(mu,{points:[-xe,0,-xe,ne],stroke:"#666",strokeWidth:1/p.scale}),l.jsx(mu,{points:[-xe-5/p.scale,0,-xe+5/p.scale,0],stroke:"#666",strokeWidth:1/p.scale}),l.jsx(mu,{points:[-xe-5/p.scale,ne,-xe+5/p.scale,ne],stroke:"#666",strokeWidth:1/p.scale}),l.jsx(Nm,{x:-xe-he*3,y:ne/2,text:`${f.depth}mm`,fontSize:he,fill:"#666",rotation:-90,align:"center"})]})},ve=O.useMemo(()=>`konva-stage-${Date.now()}`,[]);return l.jsxs("div",{ref:c,className:Cs.container,id:vXe,children:[l.jsx(gXe,{showGrid:V,showDimensions:P,showFurniture:X,showColumns:S,showWalls:B,tool:_,scale:p.scale,onToggleGrid:()=>K(!V),onToggleDimensions:()=>M(!P),onToggleFurniture:()=>Z(!X),onToggleColumns:()=>F(!S),onToggleWalls:()=>E(!B),onToolChange:I,onZoomIn:fe,onZoomOut:ye,onZoomReset:be}),l.jsx(oXe,{ref:o,width:v.width,height:v.height,onWheel:z,draggable:!w,onDragEnd:q,x:p.x,y:p.y,scaleX:p.scale,scaleY:p.scale,children:l.jsxs(sXe,{ref:a,children:[V&&l.jsx(lXe,{width:Q(f.width),height:Q(f.depth),gridSize:Q(mXe),scale:p.scale,showLabels:p.scale>.5,color:"#e0e0e0",opacity:.5}),_e(),Y(),W()]})},ve)]})};function gA(n,e,{checkForDefaultPrevented:t=!0}={}){return function(r){if(n==null||n(r),t===!1||!r.defaultPrevented)return e==null?void 0:e(r)}}function v8(n,e=[]){let t=[];function i(s,o){const a=O.createContext(o),c=t.length;t=[...t,o];const h=d=>{var v;const{scope:f,children:A,...g}=d,p=((v=f==null?void 0:f[n])==null?void 0:v[c])||a,y=O.useMemo(()=>g,Object.values(g));return l.jsx(p.Provider,{value:y,children:A})};h.displayName=s+"Provider";function u(d,f){var p;const A=((p=f==null?void 0:f[n])==null?void 0:p[c])||a,g=O.useContext(A);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${s}\``)}return[h,u]}const r=()=>{const s=t.map(o=>O.createContext(o));return function(a){const c=(a==null?void 0:a[n])||s;return O.useMemo(()=>({[`__scope${n}`]:{...a,[n]:c}}),[a,c])}};return r.scopeName=n,[i,wXe(r,...e)]}function wXe(...n){const e=n[0];if(n.length===1)return e;const t=()=>{const i=n.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(s){const o=i.reduce((a,{useScope:c,scopeName:h})=>{const d=c(s)[`__scope${h}`];return{...a,...d}},{});return O.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return t.scopeName=e.scopeName,t}function BO(n,e){if(typeof n=="function")return n(e);n!=null&&(n.current=e)}function $q(...n){return e=>{let t=!1;const i=n.map(r=>{const s=BO(r,e);return!t&&typeof s=="function"&&(t=!0),s});if(t)return()=>{for(let r=0;r<i.length;r++){const s=i[r];typeof s=="function"?s():BO(n[r],null)}}}}function RC(...n){return O.useCallback($q(...n),n)}function z6(n){const e=xXe(n),t=O.forwardRef((i,r)=>{const{children:s,...o}=i,a=O.Children.toArray(s),c=a.find(_Xe);if(c){const h=c.props.children,u=a.map(d=>d===c?O.Children.count(h)>1?O.Children.only(null):O.isValidElement(h)?h.props.children:null:d);return l.jsx(e,{...o,ref:r,children:O.isValidElement(h)?O.cloneElement(h,void 0,u):null})}return l.jsx(e,{...o,ref:r,children:s})});return t.displayName=`${n}.Slot`,t}function xXe(n){const e=O.forwardRef((t,i)=>{const{children:r,...s}=t;if(O.isValidElement(r)){const o=SXe(r),a=CXe(s,r.props);return r.type!==O.Fragment&&(a.ref=i?$q(i,o):o),O.cloneElement(r,a)}return O.Children.count(r)>1?O.Children.only(null):null});return e.displayName=`${n}.SlotClone`,e}var bXe=Symbol("radix.slottable");function _Xe(n){return O.isValidElement(n)&&typeof n.type=="function"&&"__radixId"in n.type&&n.type.__radixId===bXe}function CXe(n,e){const t={...e};for(const i in e){const r=n[i],s=e[i];/^on[A-Z]/.test(i)?r&&s?t[i]=(...a)=>{const c=s(...a);return r(...a),c}:r&&(t[i]=r):i==="style"?t[i]={...r,...s}:i==="className"&&(t[i]=[r,s].filter(Boolean).join(" "))}return{...n,...t}}function SXe(n){var i,r;let e=(i=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:i.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(r=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}function TXe(n){const e=n+"CollectionProvider",[t,i]=v8(e),[r,s]=t(e,{collectionRef:{current:null},itemMap:new Map}),o=p=>{const{scope:y,children:v}=p,m=ii.useRef(null),w=ii.useRef(new Map).current;return l.jsx(r,{scope:y,itemMap:w,collectionRef:m,children:v})};o.displayName=e;const a=n+"CollectionSlot",c=z6(a),h=ii.forwardRef((p,y)=>{const{scope:v,children:m}=p,w=s(a,v),x=RC(y,w.collectionRef);return l.jsx(c,{ref:x,children:m})});h.displayName=a;const u=n+"CollectionItemSlot",d="data-radix-collection-item",f=z6(u),A=ii.forwardRef((p,y)=>{const{scope:v,children:m,...w}=p,x=ii.useRef(null),T=RC(y,x),j=s(u,v);return ii.useEffect(()=>(j.itemMap.set(x,{ref:x,...w}),()=>void j.itemMap.delete(x))),l.jsx(f,{[d]:"",ref:T,children:m})});A.displayName=u;function g(p){const y=s(n+"CollectionConsumer",p);return ii.useCallback(()=>{const m=y.collectionRef.current;if(!m)return[];const w=Array.from(m.querySelectorAll(`[${d}]`));return Array.from(y.itemMap.values()).sort((j,D)=>w.indexOf(j.ref.current)-w.indexOf(D.ref.current))},[y.collectionRef,y.itemMap])}return[{Provider:o,Slot:h,ItemSlot:A},g,i]}var OC=globalThis!=null&&globalThis.document?O.useLayoutEffect:()=>{},BXe=QO[" useId ".trim().toString()]||(()=>{}),EXe=0;function Vq(n){const[e,t]=O.useState(BXe());return OC(()=>{t(i=>i??String(EXe++))},[n]),n||(e?`radix-${e}`:"")}var kXe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],l1=kXe.reduce((n,e)=>{const t=z6(`Primitive.${e}`),i=O.forwardRef((r,s)=>{const{asChild:o,...a}=r,c=o?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),l.jsx(c,{...a,ref:s})});return i.displayName=`Primitive.${e}`,{...n,[e]:i}},{});function IXe(n){const e=O.useRef(n);return O.useEffect(()=>{e.current=n}),O.useMemo(()=>(...t)=>{var i;return(i=e.current)==null?void 0:i.call(e,...t)},[])}var FXe=QO[" useInsertionEffect ".trim().toString()]||OC;function zq({prop:n,defaultProp:e,onChange:t=()=>{},caller:i}){const[r,s,o]=DXe({defaultProp:e,onChange:t}),a=n!==void 0,c=a?n:r;{const u=O.useRef(n!==void 0);O.useEffect(()=>{const d=u.current;d!==a&&console.warn(`${i} is changing from ${d?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=a},[a,i])}const h=O.useCallback(u=>{var d;if(a){const f=jXe(u)?u(n):u;f!==n&&((d=o.current)==null||d.call(o,f))}else s(u)},[a,n,s,o]);return[c,h]}function DXe({defaultProp:n,onChange:e}){const[t,i]=O.useState(n),r=O.useRef(t),s=O.useRef(e);return FXe(()=>{s.current=e},[e]),O.useEffect(()=>{var o;r.current!==t&&((o=s.current)==null||o.call(s,t),r.current=t)},[t,r]),[t,i,s]}function jXe(n){return typeof n=="function"}var PXe=O.createContext(void 0);function Gq(n){const e=O.useContext(PXe);return n||e||"ltr"}var cB="rovingFocusGroup.onEntryFocus",NXe={bubbles:!1,cancelable:!0},mw="RovingFocusGroup",[G6,Xq,LXe]=TXe(mw),[MXe,Kq]=v8(mw,[LXe]),[RXe,OXe]=MXe(mw),qq=O.forwardRef((n,e)=>l.jsx(G6.Provider,{scope:n.__scopeRovingFocusGroup,children:l.jsx(G6.Slot,{scope:n.__scopeRovingFocusGroup,children:l.jsx(UXe,{...n,ref:e})})}));qq.displayName=mw;var UXe=O.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,orientation:i,loop:r=!1,dir:s,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:c,onEntryFocus:h,preventScrollOnEntryFocus:u=!1,...d}=n,f=O.useRef(null),A=RC(e,f),g=Gq(s),[p,y]=zq({prop:o,defaultProp:a??null,onChange:c,caller:mw}),[v,m]=O.useState(!1),w=IXe(h),x=Xq(t),T=O.useRef(!1),[j,D]=O.useState(0);return O.useEffect(()=>{const b=f.current;if(b)return b.addEventListener(cB,w),()=>b.removeEventListener(cB,w)},[w]),l.jsx(RXe,{scope:t,orientation:i,dir:g,loop:r,currentTabStopId:p,onItemFocus:O.useCallback(b=>y(b),[y]),onItemShiftTab:O.useCallback(()=>m(!0),[]),onFocusableItemAdd:O.useCallback(()=>D(b=>b+1),[]),onFocusableItemRemove:O.useCallback(()=>D(b=>b-1),[]),children:l.jsx(l1.div,{tabIndex:v||j===0?-1:0,"data-orientation":i,...d,ref:A,style:{outline:"none",...n.style},onMouseDown:gA(n.onMouseDown,()=>{T.current=!0}),onFocus:gA(n.onFocus,b=>{const _=!T.current;if(b.target===b.currentTarget&&_&&!v){const I=new CustomEvent(cB,NXe);if(b.currentTarget.dispatchEvent(I),!I.defaultPrevented){const S=x().filter(K=>K.focusable),F=S.find(K=>K.active),B=S.find(K=>K.id===p),V=[F,B,...S].filter(Boolean).map(K=>K.ref.current);Jq(V,u)}}T.current=!1}),onBlur:gA(n.onBlur,()=>m(!1))})})}),Yq="RovingFocusGroupItem",Zq=O.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,focusable:i=!0,active:r=!1,tabStopId:s,children:o,...a}=n,c=Vq(),h=s||c,u=OXe(Yq,t),d=u.currentTabStopId===h,f=Xq(t),{onFocusableItemAdd:A,onFocusableItemRemove:g,currentTabStopId:p}=u;return O.useEffect(()=>{if(i)return A(),()=>g()},[i,A,g]),l.jsx(G6.ItemSlot,{scope:t,id:h,focusable:i,active:r,children:l.jsx(l1.span,{tabIndex:d?0:-1,"data-orientation":u.orientation,...a,ref:e,onMouseDown:gA(n.onMouseDown,y=>{i?u.onItemFocus(h):y.preventDefault()}),onFocus:gA(n.onFocus,()=>u.onItemFocus(h)),onKeyDown:gA(n.onKeyDown,y=>{if(y.key==="Tab"&&y.shiftKey){u.onItemShiftTab();return}if(y.target!==y.currentTarget)return;const v=QXe(y,u.orientation,u.dir);if(v!==void 0){if(y.metaKey||y.ctrlKey||y.altKey||y.shiftKey)return;y.preventDefault();let w=f().filter(x=>x.focusable).map(x=>x.ref.current);if(v==="last")w.reverse();else if(v==="prev"||v==="next"){v==="prev"&&w.reverse();const x=w.indexOf(y.currentTarget);w=u.loop?$Xe(w,x+1):w.slice(x+1)}setTimeout(()=>Jq(w))}}),children:typeof o=="function"?o({isCurrentTabStop:d,hasTabStop:p!=null}):o})})});Zq.displayName=Yq;var HXe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function WXe(n,e){return e!=="rtl"?n:n==="ArrowLeft"?"ArrowRight":n==="ArrowRight"?"ArrowLeft":n}function QXe(n,e,t){const i=WXe(n.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(i))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(i)))return HXe[i]}function Jq(n,e=!1){const t=document.activeElement;for(const i of n)if(i===t||(i.focus({preventScroll:e}),document.activeElement!==t))return}function $Xe(n,e){return n.map((t,i)=>n[(e+i)%n.length])}var VXe=qq,zXe=Zq;function GXe(n,e){return O.useReducer((t,i)=>e[t][i]??t,n)}var eY=n=>{const{present:e,children:t}=n,i=XXe(e),r=typeof t=="function"?t({present:i.isPresent}):O.Children.only(t),s=RC(i.ref,KXe(r));return typeof t=="function"||i.isPresent?O.cloneElement(r,{ref:s}):null};eY.displayName="Presence";function XXe(n){const[e,t]=O.useState(),i=O.useRef(null),r=O.useRef(n),s=O.useRef("none"),o=n?"mounted":"unmounted",[a,c]=GXe(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return O.useEffect(()=>{const h=jb(i.current);s.current=a==="mounted"?h:"none"},[a]),OC(()=>{const h=i.current,u=r.current;if(u!==n){const f=s.current,A=jb(h);n?c("MOUNT"):A==="none"||(h==null?void 0:h.display)==="none"?c("UNMOUNT"):c(u&&f!==A?"ANIMATION_OUT":"UNMOUNT"),r.current=n}},[n,c]),OC(()=>{if(e){let h;const u=e.ownerDocument.defaultView??window,d=A=>{const p=jb(i.current).includes(CSS.escape(A.animationName));if(A.target===e&&p&&(c("ANIMATION_END"),!r.current)){const y=e.style.animationFillMode;e.style.animationFillMode="forwards",h=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=y)})}},f=A=>{A.target===e&&(s.current=jb(i.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",d),e.addEventListener("animationend",d),()=>{u.clearTimeout(h),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",d),e.removeEventListener("animationend",d)}}else c("ANIMATION_END")},[e,c]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:O.useCallback(h=>{i.current=h?getComputedStyle(h):null,t(h)},[])}}function jb(n){return(n==null?void 0:n.animationName)||"none"}function KXe(n){var i,r;let e=(i=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:i.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(r=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}var mS="Tabs",[qXe,WZe]=v8(mS,[Kq]),tY=Kq(),[YXe,w8]=qXe(mS),nY=O.forwardRef((n,e)=>{const{__scopeTabs:t,value:i,onValueChange:r,defaultValue:s,orientation:o="horizontal",dir:a,activationMode:c="automatic",...h}=n,u=Gq(a),[d,f]=zq({prop:i,onChange:r,defaultProp:s??"",caller:mS});return l.jsx(YXe,{scope:t,baseId:Vq(),value:d,onValueChange:f,orientation:o,dir:u,activationMode:c,children:l.jsx(l1.div,{dir:u,"data-orientation":o,...h,ref:e})})});nY.displayName=mS;var iY="TabsList",rY=O.forwardRef((n,e)=>{const{__scopeTabs:t,loop:i=!0,...r}=n,s=w8(iY,t),o=tY(t);return l.jsx(VXe,{asChild:!0,...o,orientation:s.orientation,dir:s.dir,loop:i,children:l.jsx(l1.div,{role:"tablist","aria-orientation":s.orientation,...r,ref:e})})});rY.displayName=iY;var sY="TabsTrigger",X6=O.forwardRef((n,e)=>{const{__scopeTabs:t,value:i,disabled:r=!1,...s}=n,o=w8(sY,t),a=tY(t),c=aY(o.baseId,i),h=lY(o.baseId,i),u=i===o.value;return l.jsx(zXe,{asChild:!0,...a,focusable:!r,active:u,children:l.jsx(l1.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":h,"data-state":u?"active":"inactive","data-disabled":r?"":void 0,disabled:r,id:c,...s,ref:e,onMouseDown:gA(n.onMouseDown,d=>{!r&&d.button===0&&d.ctrlKey===!1?o.onValueChange(i):d.preventDefault()}),onKeyDown:gA(n.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&o.onValueChange(i)}),onFocus:gA(n.onFocus,()=>{const d=o.activationMode!=="manual";!u&&!r&&d&&o.onValueChange(i)})})})});X6.displayName=sY;var oY="TabsContent",ZXe=O.forwardRef((n,e)=>{const{__scopeTabs:t,value:i,forceMount:r,children:s,...o}=n,a=w8(oY,t),c=aY(a.baseId,i),h=lY(a.baseId,i),u=i===a.value,d=O.useRef(u);return O.useEffect(()=>{const f=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(f)},[]),l.jsx(eY,{present:r||u,children:({present:f})=>l.jsx(l1.div,{"data-state":u?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":c,hidden:!f,id:h,tabIndex:0,...o,ref:e,style:{...n.style,animationDuration:d.current?"0s":void 0},children:f&&s})})});ZXe.displayName=oY;function aY(n,e){return`${n}-trigger-${e}`}function lY(n,e){return`${n}-content-${e}`}const JXe="_container_14ufn_1",eKe="_viewModeSelector_14ufn_9",tKe="_tabsList_14ufn_20",nKe="_tabTrigger_14ufn_29",iKe="_implementationToggle_14ufn_51",rKe="_toggleLabel_14ufn_58",sKe="_toggleCheckbox_14ufn_67",oKe="_toggleText_14ufn_73",aKe="_viewerContainer_14ufn_82",Yu={container:JXe,viewModeSelector:eKe,tabsList:tKe,tabTrigger:nKe,implementationToggle:iKe,toggleLabel:rKe,toggleCheckbox:sKe,toggleText:oKe,viewerContainer:aKe},lKe=({viewMode:n,showDimensions:e=!0,showFurniture:t=!0,showFrame:i=!0,renderMode:r="solid",spaceInfo:s,svgSize:o,isEmbedded:a=!1,isStep2:c=!1,activeZone:h,showAll:u=!0,width:d,height:f,onViewModeChange:A})=>{const g=Bi(),[p,y]=O.useState(n||g.viewMode||"3D"),[v,m]=O.useState(!1),[w,x]=O.useState(Date.now());O.useEffect(()=>{n?y(n):g.viewMode&&y(g.viewMode)},[n,g.viewMode]);const T=D=>{y(D),g.setViewMode(D),x(Date.now()),A&&A(D)},j=()=>{m(!v),x(Date.now())};return l.jsxs("div",{className:Yu.container,children:[l.jsxs("div",{className:Yu.viewModeSelector,children:[l.jsx(nY,{value:p,onValueChange:D=>T(D),children:l.jsxs(rY,{className:Yu.tabsList,children:[l.jsx(X6,{value:"2D",className:Yu.tabTrigger,children:"2D View"}),l.jsx(X6,{value:"3D",className:Yu.tabTrigger,children:"3D View"})]})}),p==="2D"&&l.jsx("div",{className:Yu.implementationToggle,children:l.jsxs("label",{className:Yu.toggleLabel,children:[l.jsx("input",{type:"checkbox",checked:v,onChange:j,className:Yu.toggleCheckbox}),l.jsxs("span",{className:Yu.toggleText,children:["Use Konva Canvas ",v?"(Active)":"(Inactive)"]})]})})]}),l.jsx("div",{className:Yu.viewerContainer,children:p==="2D"&&v?l.jsx(y8,{width:d,height:f,viewMode:p,showDimensions:e,showFurniture:t,showGrid:!0},`konva-${w}`):l.jsx(F5,{spaceInfo:s,svgSize:o,viewMode:p,renderMode:r,showAll:u,showFurniture:t,showFrame:i,showDimensions:e,isEmbedded:a,isStep2:c,activeZone:h,setViewMode:T})})]})},cKe="_container_u7544_1",hKe="_header_u7544_10",uKe="_content_u7544_29",dKe="_viewerSection_u7544_37",AKe="_viewerContainer_u7544_56",fKe="_features_u7544_62",cf={container:cKe,header:hKe,content:uKe,viewerSection:dKe,viewerContainer:AKe,features:fKe},pKe=()=>{const n=qi(),e=ci();return O.useEffect(()=>{(!n.width||!n.depth)&&n.setSpaceInfo({width:3e3,depth:2e3,height:2400,columns:[{id:"col1",position:{x:500,y:0,z:500},size:100,height:2400},{id:"col2",position:{x:2500,y:0,z:500},size:100,height:2400}],walls:[{id:"wall1",position:{x:0,y:0,z:0},dimensions:{width:3e3,height:2400,depth:100},type:"back"}]}),e.placedModules.length===0&&(e.addModule({id:"furniture1",moduleId:"module1",name:"Cabinet 1",position:{x:800,y:0,z:800},dimensions:{width:600,height:800,depth:400},rotation:0,hasDoors:!0}),e.addModule({id:"furniture2",moduleId:"module2",name:"Cabinet 2",position:{x:1600,y:0,z:1200},dimensions:{width:800,height:900,depth:500},rotation:45,hasDoors:!1}))},[]),l.jsxs("div",{className:cf.container,children:[l.jsxs("div",{className:cf.header,children:[l.jsx("h1",{children:"2D Canvas Viewer Test - React Konva Implementation"}),l.jsx("p",{children:"Test page for the new Konva-based 2D editor"})]}),l.jsxs("div",{className:cf.content,children:[l.jsxs("div",{className:cf.viewerSection,children:[l.jsx("h2",{children:"Standalone Konva Viewer"}),l.jsx("div",{className:cf.viewerContainer,children:l.jsx(y8,{width:800,height:600,viewMode:"2D",showGrid:!0,showDimensions:!0,showFurniture:!0})})]}),l.jsxs("div",{className:cf.viewerSection,children:[l.jsx("h2",{children:"Unified Viewer with Mode Switch"}),l.jsx("div",{className:cf.viewerContainer,children:l.jsx(lKe,{viewMode:"2D",showDimensions:!0,showFurniture:!0,showFrame:!0,renderMode:"solid"})})]})]}),l.jsxs("div",{className:cf.features,children:[l.jsx("h2",{children:"Implemented Features"}),l.jsxs("ul",{children:[l.jsx("li",{children:"✅ Konva.js canvas rendering"}),l.jsx("li",{children:"✅ Furniture drag and drop"}),l.jsx("li",{children:"✅ Zoom and pan controls"}),l.jsx("li",{children:"✅ Grid display with toggle"}),l.jsx("li",{children:"✅ Dimension labels"}),l.jsx("li",{children:"✅ Furniture selection and rotation"}),l.jsx("li",{children:"✅ Column and wall rendering"}),l.jsx("li",{children:"✅ Toolbar with view controls"}),l.jsx("li",{children:"✅ Integration with Zustand stores"}),l.jsx("li",{children:"✅ 2D/3D view mode switching"})]})]})]})},gKe=()=>{const[n,e]=O.useState(0),[t,i]=O.useState(0),[r,s]=O.useState([]);O.useEffect(()=>{const c=()=>{const d=document.querySelectorAll("canvas"),f=document.querySelectorAll(".konvajs-content");i(d.length);const A=`[${new Date().toLocaleTimeString()}] Canvas count: ${d.length}, Konva containers: ${f.length}`;s(g=>[...g.slice(-9),A]),d.length>1&&console.warn("Multiple canvas elements detected!",d)};c();const h=new MutationObserver(()=>{c()});h.observe(document.body,{childList:!0,subtree:!0});const u=()=>{e(d=>d+1),console.log("Orientation change detected"),setTimeout(c,500)};return window.addEventListener("orientationchange",u),window.addEventListener("resize",c),()=>{h.disconnect(),window.removeEventListener("orientationchange",u),window.removeEventListener("resize",c)}},[]);const o=()=>{const c=new Event("resize");window.dispatchEvent(c),setTimeout(()=>{const h=new Event("orientationchange");window.dispatchEvent(h)},100),e(h=>h+1)},a=()=>{s([])};return l.jsxs("div",{style:{width:"100%",height:"100vh",display:"flex",flexDirection:"column"},children:[l.jsxs("div",{style:{padding:"10px",background:"#f0f0f0",borderBottom:"1px solid #ddd",display:"flex",alignItems:"center",gap:"20px",flexShrink:0},children:[l.jsx("h3",{style:{margin:0},children:"Canvas Duplicate Test"}),l.jsx("button",{onClick:o,style:{padding:"5px 10px",background:"#2196F3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Simulate Orientation Change"}),l.jsx("button",{onClick:a,style:{padding:"5px 10px",background:"#666",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Clear Logs"}),l.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:"20px"},children:[l.jsxs("span",{children:["Orientation Changes: ",l.jsx("strong",{children:n})]}),l.jsxs("span",{style:{color:t>1?"red":"green",fontWeight:"bold"},children:["Canvas Count: ",t," ",t>1?"⚠️ DUPLICATE!":"✅"]})]})]}),l.jsx("div",{style:{padding:"10px",background:"#f9f9f9",borderBottom:"1px solid #ddd",maxHeight:"150px",overflowY:"auto",flexShrink:0},children:l.jsx("div",{style:{fontSize:"12px",fontFamily:"monospace"},children:r.length===0?l.jsx("div",{style:{color:"#999"},children:"No logs yet..."}):r.map((c,h)=>l.jsx("div",{style:{marginBottom:"2px"},children:c},h))})}),l.jsx("div",{style:{flex:1,position:"relative",overflow:"hidden"},children:l.jsx(y8,{showGrid:!0,showDimensions:!0,showFurniture:!0})})]})},mKe=O.lazy(()=>ca(()=>import("./ARViewer-DvOKYk7Z.js"),__vite__mapDeps([6,1,2,3,4,7])));function yKe(){const n=VC();return O.useEffect(()=>{},[n.pathname]),null}function vKe(){const n=Ha(r=>r.isDirty),e=qi(r=>r.isDirty),t=ci(r=>r.isDirty),i=n||e||t;return O.useEffect(()=>{const r=s=>{const o=window.location.pathname.includes("/configurator");if(i&&o){const a="저장하지 않은 변경사항이 있습니다. 정말로 페이지를 떠나시겠습니까?";return s.preventDefault(),s.returnValue=a,a}};return window.addEventListener("beforeunload",r),()=>{window.removeEventListener("beforeunload",r)}},[i]),l.jsxs(l.Fragment,{children:[l.jsx(yKe,{}),l.jsxs(UY,{children:[l.jsx(Ho,{path:"/",element:l.jsx(oR,{})}),l.jsx(Ho,{path:"/dashboard",element:l.jsx(SOe,{})}),l.jsx(Ho,{path:"/auth",element:l.jsx(oR,{})}),l.jsx(Ho,{path:"/auth/gradient",element:l.jsx(IUe,{})}),l.jsx(Ho,{path:"/auth/ultra",element:l.jsx(kUe,{})}),l.jsx(Ho,{path:"/auth/modern",element:l.jsx(BUe,{})}),l.jsx(Ho,{path:"/auth/classic",element:l.jsx(TUe,{})}),l.jsx(Ho,{path:"/debug/firebase",element:l.jsx(sHe,{})}),l.jsx(Ho,{path:"/debug/data",element:l.jsx(EHe,{})}),l.jsx(Ho,{path:"/touch-test",element:l.jsx(VHe,{})}),l.jsx(Ho,{path:"/test-2d",element:l.jsx(pKe,{})}),l.jsx(Ho,{path:"/test-canvas",element:l.jsx(gKe,{})}),l.jsx(Ho,{path:"/step1",element:l.jsx(sE,{})}),l.jsx(Ho,{path:"/configurator",element:l.jsx(d8e,{})}),l.jsx(Ho,{path:"/cnc-optimizer",element:l.jsx(kVe,{})}),l.jsx(Ho,{path:"/cnc-test",element:l.jsx(xze,{})}),l.jsx(Ho,{path:"/step0",element:l.jsx(Hw,{to:"/step1",replace:!0})}),l.jsx(Ho,{path:"/step2",element:l.jsx(Hw,{to:"/configurator",replace:!0})}),l.jsx(Ho,{path:"/step3",element:l.jsx(Hw,{to:"/configurator",replace:!0})}),l.jsx(Ho,{path:"/ar-viewer",element:l.jsx(O.Suspense,{fallback:l.jsx(Gm,{fullscreen:!0,message:"Loading AR Viewer..."}),children:l.jsx(mKe,{})})}),l.jsx(Ho,{path:"/viewer/:projectId",element:l.jsx($Oe,{})}),l.jsx(Ho,{path:"*",element:l.jsx(Hw,{to:"/dashboard",replace:!0})})]})]})}function wKe(){return O.useEffect(()=>{lI()},[]),l.jsx(hae,{children:l.jsx(Zse,{children:l.jsx(hoe,{children:l.jsx(Xse,{children:l.jsx(iae,{children:l.jsx(OY,{children:l.jsx(Voe,{children:l.jsx(vKe,{})})})})})})})})}const pr=n=>typeof n=="string",R2=()=>{let n,e;const t=new Promise((i,r)=>{n=i,e=r});return t.resolve=n,t.reject=e,t},EO=n=>n==null?"":""+n,xKe=(n,e,t)=>{n.forEach(i=>{e[i]&&(t[i]=e[i])})},bKe=/###/g,kO=n=>n&&n.indexOf("###")>-1?n.replace(bKe,"."):n,IO=n=>!n||pr(n),Xy=(n,e,t)=>{const i=pr(e)?e.split("."):e;let r=0;for(;r<i.length-1;){if(IO(n))return{};const s=kO(i[r]);!n[s]&&t&&(n[s]=new t),Object.prototype.hasOwnProperty.call(n,s)?n=n[s]:n={},++r}return IO(n)?{}:{obj:n,k:kO(i[r])}},FO=(n,e,t)=>{const{obj:i,k:r}=Xy(n,e,Object);if(i!==void 0||e.length===1){i[r]=t;return}let s=e[e.length-1],o=e.slice(0,e.length-1),a=Xy(n,o,Object);for(;a.obj===void 0&&o.length;)s=`${o[o.length-1]}.${s}`,o=o.slice(0,o.length-1),a=Xy(n,o,Object),a!=null&&a.obj&&typeof a.obj[`${a.k}.${s}`]<"u"&&(a.obj=void 0);a.obj[`${a.k}.${s}`]=t},_Ke=(n,e,t,i)=>{const{obj:r,k:s}=Xy(n,e,Object);r[s]=r[s]||[],r[s].push(t)},UC=(n,e)=>{const{obj:t,k:i}=Xy(n,e);if(t&&Object.prototype.hasOwnProperty.call(t,i))return t[i]},CKe=(n,e,t)=>{const i=UC(n,t);return i!==void 0?i:UC(e,t)},cY=(n,e,t)=>{for(const i in e)i!=="__proto__"&&i!=="constructor"&&(i in n?pr(n[i])||n[i]instanceof String||pr(e[i])||e[i]instanceof String?t&&(n[i]=e[i]):cY(n[i],e[i],t):n[i]=e[i]);return n},b0=n=>n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var SKe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const TKe=n=>pr(n)?n.replace(/[&<>"'\/]/g,e=>SKe[e]):n;class BKe{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(t!==void 0)return t;const i=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,i),this.regExpQueue.push(e),i}}const EKe=[" ",",","?","!",";"],kKe=new BKe(20),IKe=(n,e,t)=>{e=e||"",t=t||"";const i=EKe.filter(o=>e.indexOf(o)<0&&t.indexOf(o)<0);if(i.length===0)return!0;const r=kKe.getRegExp(`(${i.map(o=>o==="?"?"\\?":o).join("|")})`);let s=!r.test(n);if(!s){const o=n.indexOf(t);o>0&&!r.test(n.substring(0,o))&&(s=!0)}return s},K6=(n,e,t=".")=>{if(!n)return;if(n[e])return Object.prototype.hasOwnProperty.call(n,e)?n[e]:void 0;const i=e.split(t);let r=n;for(let s=0;s<i.length;){if(!r||typeof r!="object")return;let o,a="";for(let c=s;c<i.length;++c)if(c!==s&&(a+=t),a+=i[c],o=r[a],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&c<i.length-1)continue;s+=c-s+1;break}r=o}return r},kv=n=>n==null?void 0:n.replace("_","-"),FKe={type:"logger",log(n){this.output("log",n)},warn(n){this.output("warn",n)},error(n){this.output("error",n)},output(n,e){var t,i;(i=(t=console==null?void 0:console[n])==null?void 0:t.apply)==null||i.call(t,console,e)}};class HC{constructor(e,t={}){this.init(e,t)}init(e,t={}){this.prefix=t.prefix||"i18next:",this.logger=e||FKe,this.options=t,this.debug=t.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,i,r){return r&&!this.debug?null:(pr(e[0])&&(e[0]=`${i}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new HC(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new HC(this.logger,e)}}var hd=new HC;class yS{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(i=>{this.observers[i]||(this.observers[i]=new Map);const r=this.observers[i].get(t)||0;this.observers[i].set(t,r+1)}),this}off(e,t){if(this.observers[e]){if(!t){delete this.observers[e];return}this.observers[e].delete(t)}}emit(e,...t){this.observers[e]&&Array.from(this.observers[e].entries()).forEach(([r,s])=>{for(let o=0;o<s;o++)r(...t)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([r,s])=>{for(let o=0;o<s;o++)r.apply(r,[e,...t])})}}class DO extends yS{constructor(e,t={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,i,r={}){var h,u;const s=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,o=r.ignoreJSONStructure!==void 0?r.ignoreJSONStructure:this.options.ignoreJSONStructure;let a;e.indexOf(".")>-1?a=e.split("."):(a=[e,t],i&&(Array.isArray(i)?a.push(...i):pr(i)&&s?a.push(...i.split(s)):a.push(i)));const c=UC(this.data,a);return!c&&!t&&!i&&e.indexOf(".")>-1&&(e=a[0],t=a[1],i=a.slice(2).join(".")),c||!o||!pr(i)?c:K6((u=(h=this.data)==null?void 0:h[e])==null?void 0:u[t],i,s)}addResource(e,t,i,r,s={silent:!1}){const o=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator;let a=[e,t];i&&(a=a.concat(o?i.split(o):i)),e.indexOf(".")>-1&&(a=e.split("."),r=t,t=a[1]),this.addNamespaces(t),FO(this.data,a,r),s.silent||this.emit("added",e,t,i,r)}addResources(e,t,i,r={silent:!1}){for(const s in i)(pr(i[s])||Array.isArray(i[s]))&&this.addResource(e,t,s,i[s],{silent:!0});r.silent||this.emit("added",e,t,i)}addResourceBundle(e,t,i,r,s,o={silent:!1,skipCopy:!1}){let a=[e,t];e.indexOf(".")>-1&&(a=e.split("."),r=i,i=t,t=a[1]),this.addNamespaces(t);let c=UC(this.data,a)||{};o.skipCopy||(i=JSON.parse(JSON.stringify(i))),r?cY(c,i,s):c={...c,...i},FO(this.data,a,c),o.silent||this.emit("added",e,t,i)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return this.getResource(e,t)!==void 0}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find(r=>t[r]&&Object.keys(t[r]).length>0)}toJSON(){return this.data}}var hY={processors:{},addPostProcessor(n){this.processors[n.name]=n},handle(n,e,t,i,r){return n.forEach(s=>{var o;e=((o=this.processors[s])==null?void 0:o.process(e,t,i,r))??e}),e}};const uY=Symbol("i18next/PATH_KEY");function DKe(){const n=[],e=Object.create(null);let t;return e.get=(i,r)=>{var s;return(s=t==null?void 0:t.revoke)==null||s.call(t),r===uY?n:(n.push(r),t=Proxy.revocable(i,e),t.proxy)},Proxy.revocable(Object.create(null),e).proxy}function q6(n,e){const{[uY]:t}=n(DKe());return t.join((e==null?void 0:e.keySeparator)??".")}const jO={},PO=n=>!pr(n)&&typeof n!="boolean"&&typeof n!="number";class WC extends yS{constructor(e,t={}){super(),xKe(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=hd.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,t={interpolation:{}}){const i={...t};if(e==null)return!1;const r=this.resolve(e,i);return(r==null?void 0:r.res)!==void 0}extractFromKey(e,t){let i=t.nsSeparator!==void 0?t.nsSeparator:this.options.nsSeparator;i===void 0&&(i=":");const r=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator;let s=t.ns||this.options.defaultNS||[];const o=i&&e.indexOf(i)>-1,a=!this.options.userDefinedKeySeparator&&!t.keySeparator&&!this.options.userDefinedNsSeparator&&!t.nsSeparator&&!IKe(e,i,r);if(o&&!a){const c=e.match(this.interpolator.nestingRegexp);if(c&&c.length>0)return{key:e,namespaces:pr(s)?[s]:s};const h=e.split(i);(i!==r||i===r&&this.options.ns.indexOf(h[0])>-1)&&(s=h.shift()),e=h.join(r)}return{key:e,namespaces:pr(s)?[s]:s}}translate(e,t,i){let r=typeof t=="object"?{...t}:t;if(typeof r!="object"&&this.options.overloadTranslationOptionHandler&&(r=this.options.overloadTranslationOptionHandler(arguments)),typeof r=="object"&&(r={...r}),r||(r={}),e==null)return"";typeof e=="function"&&(e=q6(e,{...this.options,...r})),Array.isArray(e)||(e=[String(e)]);const s=r.returnDetails!==void 0?r.returnDetails:this.options.returnDetails,o=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,{key:a,namespaces:c}=this.extractFromKey(e[e.length-1],r),h=c[c.length-1];let u=r.nsSeparator!==void 0?r.nsSeparator:this.options.nsSeparator;u===void 0&&(u=":");const d=r.lng||this.language,f=r.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((d==null?void 0:d.toLowerCase())==="cimode")return f?s?{res:`${h}${u}${a}`,usedKey:a,exactUsedKey:a,usedLng:d,usedNS:h,usedParams:this.getUsedParamsDetails(r)}:`${h}${u}${a}`:s?{res:a,usedKey:a,exactUsedKey:a,usedLng:d,usedNS:h,usedParams:this.getUsedParamsDetails(r)}:a;const A=this.resolve(e,r);let g=A==null?void 0:A.res;const p=(A==null?void 0:A.usedKey)||a,y=(A==null?void 0:A.exactUsedKey)||a,v=["[object Number]","[object Function]","[object RegExp]"],m=r.joinArrays!==void 0?r.joinArrays:this.options.joinArrays,w=!this.i18nFormat||this.i18nFormat.handleAsObject,x=r.count!==void 0&&!pr(r.count),T=WC.hasDefaultValue(r),j=x?this.pluralResolver.getSuffix(d,r.count,r):"",D=r.ordinal&&x?this.pluralResolver.getSuffix(d,r.count,{ordinal:!1}):"",b=x&&!r.ordinal&&r.count===0,_=b&&r[`defaultValue${this.options.pluralSeparator}zero`]||r[`defaultValue${j}`]||r[`defaultValue${D}`]||r.defaultValue;let I=g;w&&!g&&T&&(I=_);const S=PO(I),F=Object.prototype.toString.apply(I);if(w&&I&&S&&v.indexOf(F)<0&&!(pr(m)&&Array.isArray(I))){if(!r.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const B=this.options.returnedObjectHandler?this.options.returnedObjectHandler(p,I,{...r,ns:c}):`key '${a} (${this.language})' returned an object instead of string.`;return s?(A.res=B,A.usedParams=this.getUsedParamsDetails(r),A):B}if(o){const B=Array.isArray(I),E=B?[]:{},V=B?y:p;for(const K in I)if(Object.prototype.hasOwnProperty.call(I,K)){const P=`${V}${o}${K}`;T&&!g?E[K]=this.translate(P,{...r,defaultValue:PO(_)?_[K]:void 0,joinArrays:!1,ns:c}):E[K]=this.translate(P,{...r,joinArrays:!1,ns:c}),E[K]===P&&(E[K]=I[K])}g=E}}else if(w&&pr(m)&&Array.isArray(g))g=g.join(m),g&&(g=this.extendTranslation(g,e,r,i));else{let B=!1,E=!1;!this.isValidLookup(g)&&T&&(B=!0,g=_),this.isValidLookup(g)||(E=!0,g=a);const K=(r.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&E?void 0:g,P=T&&_!==g&&this.options.updateMissing;if(E||B||P){if(this.logger.log(P?"updateKey":"missingKey",d,h,a,P?_:g),o){const Q=this.resolve(a,{...r,keySeparator:!1});Q&&Q.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let M=[];const X=this.languageUtils.getFallbackCodes(this.options.fallbackLng,r.lng||this.language);if(this.options.saveMissingTo==="fallback"&&X&&X[0])for(let Q=0;Q<X.length;Q++)M.push(X[Q]);else this.options.saveMissingTo==="all"?M=this.languageUtils.toResolveHierarchy(r.lng||this.language):M.push(r.lng||this.language);const Z=(Q,U,z)=>{var G;const q=T&&z!==g?z:K;this.options.missingKeyHandler?this.options.missingKeyHandler(Q,h,U,q,P,r):(G=this.backendConnector)!=null&&G.saveMissing&&this.backendConnector.saveMissing(Q,h,U,q,P,r),this.emit("missingKey",Q,h,U,g)};this.options.saveMissing&&(this.options.saveMissingPlurals&&x?M.forEach(Q=>{const U=this.pluralResolver.getSuffixes(Q,r);b&&r[`defaultValue${this.options.pluralSeparator}zero`]&&U.indexOf(`${this.options.pluralSeparator}zero`)<0&&U.push(`${this.options.pluralSeparator}zero`),U.forEach(z=>{Z([Q],a+z,r[`defaultValue${z}`]||_)})}):Z(M,a,_))}g=this.extendTranslation(g,e,r,A,i),E&&g===a&&this.options.appendNamespaceToMissingKey&&(g=`${h}${u}${a}`),(E||B)&&this.options.parseMissingKeyHandler&&(g=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${h}${u}${a}`:a,B?g:void 0,r))}return s?(A.res=g,A.usedParams=this.getUsedParamsDetails(r),A):g}extendTranslation(e,t,i,r,s){var c,h;if((c=this.i18nFormat)!=null&&c.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...i},i.lng||this.language||r.usedLng,r.usedNS,r.usedKey,{resolved:r});else if(!i.skipInterpolation){i.interpolation&&this.interpolator.init({...i,interpolation:{...this.options.interpolation,...i.interpolation}});const u=pr(e)&&(((h=i==null?void 0:i.interpolation)==null?void 0:h.skipOnVariables)!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let d;if(u){const A=e.match(this.interpolator.nestingRegexp);d=A&&A.length}let f=i.replace&&!pr(i.replace)?i.replace:i;if(this.options.interpolation.defaultVariables&&(f={...this.options.interpolation.defaultVariables,...f}),e=this.interpolator.interpolate(e,f,i.lng||this.language||r.usedLng,i),u){const A=e.match(this.interpolator.nestingRegexp),g=A&&A.length;d<g&&(i.nest=!1)}!i.lng&&r&&r.res&&(i.lng=this.language||r.usedLng),i.nest!==!1&&(e=this.interpolator.nest(e,(...A)=>(s==null?void 0:s[0])===A[0]&&!i.context?(this.logger.warn(`It seems you are nesting recursively key: ${A[0]} in key: ${t[0]}`),null):this.translate(...A,t),i)),i.interpolation&&this.interpolator.reset()}const o=i.postProcess||this.options.postProcess,a=pr(o)?[o]:o;return e!=null&&(a!=null&&a.length)&&i.applyPostProcessor!==!1&&(e=hY.handle(a,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...r,usedParams:this.getUsedParamsDetails(i)},...i}:i,this)),e}resolve(e,t={}){let i,r,s,o,a;return pr(e)&&(e=[e]),e.forEach(c=>{if(this.isValidLookup(i))return;const h=this.extractFromKey(c,t),u=h.key;r=u;let d=h.namespaces;this.options.fallbackNS&&(d=d.concat(this.options.fallbackNS));const f=t.count!==void 0&&!pr(t.count),A=f&&!t.ordinal&&t.count===0,g=t.context!==void 0&&(pr(t.context)||typeof t.context=="number")&&t.context!=="",p=t.lngs?t.lngs:this.languageUtils.toResolveHierarchy(t.lng||this.language,t.fallbackLng);d.forEach(y=>{var v,m;this.isValidLookup(i)||(a=y,!jO[`${p[0]}-${y}`]&&((v=this.utils)!=null&&v.hasLoadedNamespace)&&!((m=this.utils)!=null&&m.hasLoadedNamespace(a))&&(jO[`${p[0]}-${y}`]=!0,this.logger.warn(`key "${r}" for languages "${p.join(", ")}" won't get resolved as namespace "${a}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),p.forEach(w=>{var j;if(this.isValidLookup(i))return;o=w;const x=[u];if((j=this.i18nFormat)!=null&&j.addLookupKeys)this.i18nFormat.addLookupKeys(x,u,w,y,t);else{let D;f&&(D=this.pluralResolver.getSuffix(w,t.count,t));const b=`${this.options.pluralSeparator}zero`,_=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(f&&(t.ordinal&&D.indexOf(_)===0&&x.push(u+D.replace(_,this.options.pluralSeparator)),x.push(u+D),A&&x.push(u+b)),g){const I=`${u}${this.options.contextSeparator||"_"}${t.context}`;x.push(I),f&&(t.ordinal&&D.indexOf(_)===0&&x.push(I+D.replace(_,this.options.pluralSeparator)),x.push(I+D),A&&x.push(I+b))}}let T;for(;T=x.pop();)this.isValidLookup(i)||(s=T,i=this.getResource(w,y,T,t))}))})}),{res:i,usedKey:r,exactUsedKey:s,usedLng:o,usedNS:a}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,t,i,r={}){var s;return(s=this.i18nFormat)!=null&&s.getResource?this.i18nFormat.getResource(e,t,i,r):this.resourceStore.getResource(e,t,i,r)}getUsedParamsDetails(e={}){const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],i=e.replace&&!pr(e.replace);let r=i?e.replace:e;if(i&&typeof e.count<"u"&&(r.count=e.count),this.options.interpolation.defaultVariables&&(r={...this.options.interpolation.defaultVariables,...r}),!i){r={...r};for(const s of t)delete r[s]}return r}static hasDefaultValue(e){const t="defaultValue";for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&t===i.substring(0,t.length)&&e[i]!==void 0)return!0;return!1}}class NO{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=hd.create("languageUtils")}getScriptPartFromCode(e){if(e=kv(e),!e||e.indexOf("-")<0)return null;const t=e.split("-");return t.length===2||(t.pop(),t[t.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(t.join("-"))}getLanguagePartFromCode(e){if(e=kv(e),!e||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(pr(e)&&e.indexOf("-")>-1){let t;try{t=Intl.getCanonicalLocales(e)[0]}catch{}return t&&this.options.lowerCaseLng&&(t=t.toLowerCase()),t||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach(i=>{if(t)return;const r=this.formatLanguageCode(i);(!this.options.supportedLngs||this.isSupportedCode(r))&&(t=r)}),!t&&this.options.supportedLngs&&e.forEach(i=>{if(t)return;const r=this.getScriptPartFromCode(i);if(this.isSupportedCode(r))return t=r;const s=this.getLanguagePartFromCode(i);if(this.isSupportedCode(s))return t=s;t=this.options.supportedLngs.find(o=>{if(o===s)return o;if(!(o.indexOf("-")<0&&s.indexOf("-")<0)&&(o.indexOf("-")>0&&s.indexOf("-")<0&&o.substring(0,o.indexOf("-"))===s||o.indexOf(s)===0&&s.length>1))return o})}),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if(typeof e=="function"&&(e=e(t)),pr(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let i=e[t];return i||(i=e[this.getScriptPartFromCode(t)]),i||(i=e[this.formatLanguageCode(t)]),i||(i=e[this.getLanguagePartFromCode(t)]),i||(i=e.default),i||[]}toResolveHierarchy(e,t){const i=this.getFallbackCodes((t===!1?[]:t)||this.options.fallbackLng||[],e),r=[],s=o=>{o&&(this.isSupportedCode(o)?r.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return pr(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&s(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&s(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&s(this.getLanguagePartFromCode(e))):pr(e)&&s(this.formatLanguageCode(e)),i.forEach(o=>{r.indexOf(o)<0&&s(this.formatLanguageCode(o))}),r}}const LO={zero:0,one:1,two:2,few:3,many:4,other:5},MO={select:n=>n===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class jKe{constructor(e,t={}){this.languageUtils=e,this.options=t,this.logger=hd.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e,t={}){const i=kv(e==="dev"?"en":e),r=t.ordinal?"ordinal":"cardinal",s=JSON.stringify({cleanedCode:i,type:r});if(s in this.pluralRulesCache)return this.pluralRulesCache[s];let o;try{o=new Intl.PluralRules(i,{type:r})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),MO;if(!e.match(/-|_/))return MO;const c=this.languageUtils.getLanguagePartFromCode(e);o=this.getRule(c,t)}return this.pluralRulesCache[s]=o,o}needsPlural(e,t={}){let i=this.getRule(e,t);return i||(i=this.getRule("dev",t)),(i==null?void 0:i.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(e,t,i={}){return this.getSuffixes(e,i).map(r=>`${t}${r}`)}getSuffixes(e,t={}){let i=this.getRule(e,t);return i||(i=this.getRule("dev",t)),i?i.resolvedOptions().pluralCategories.sort((r,s)=>LO[r]-LO[s]).map(r=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${r}`):[]}getSuffix(e,t,i={}){const r=this.getRule(e,i);return r?`${this.options.prepend}${i.ordinal?`ordinal${this.options.prepend}`:""}${r.select(t)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",t,i))}}const RO=(n,e,t,i=".",r=!0)=>{let s=CKe(n,e,t);return!s&&r&&pr(t)&&(s=K6(n,t,i),s===void 0&&(s=K6(e,t,i))),s},hB=n=>n.replace(/\$/g,"$$$$");class PKe{constructor(e={}){var t;this.logger=hd.create("interpolator"),this.options=e,this.format=((t=e==null?void 0:e.interpolation)==null?void 0:t.format)||(i=>i),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:i,useRawValueToEscape:r,prefix:s,prefixEscaped:o,suffix:a,suffixEscaped:c,formatSeparator:h,unescapeSuffix:u,unescapePrefix:d,nestingPrefix:f,nestingPrefixEscaped:A,nestingSuffix:g,nestingSuffixEscaped:p,nestingOptionsSeparator:y,maxReplaces:v,alwaysFormat:m}=e.interpolation;this.escape=t!==void 0?t:TKe,this.escapeValue=i!==void 0?i:!0,this.useRawValueToEscape=r!==void 0?r:!1,this.prefix=s?b0(s):o||"{{",this.suffix=a?b0(a):c||"}}",this.formatSeparator=h||",",this.unescapePrefix=u?"":d||"-",this.unescapeSuffix=this.unescapePrefix?"":u||"",this.nestingPrefix=f?b0(f):A||b0("$t("),this.nestingSuffix=g?b0(g):p||b0(")"),this.nestingOptionsSeparator=y||",",this.maxReplaces=v||1e3,this.alwaysFormat=m!==void 0?m:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(t,i)=>(t==null?void 0:t.source)===i?(t.lastIndex=0,t):new RegExp(i,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(e,t,i,r){var A;let s,o,a;const c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},h=g=>{if(g.indexOf(this.formatSeparator)<0){const m=RO(t,c,g,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(m,void 0,i,{...r,...t,interpolationkey:g}):m}const p=g.split(this.formatSeparator),y=p.shift().trim(),v=p.join(this.formatSeparator).trim();return this.format(RO(t,c,y,this.options.keySeparator,this.options.ignoreJSONStructure),v,i,{...r,...t,interpolationkey:y})};this.resetRegExp();const u=(r==null?void 0:r.missingInterpolationHandler)||this.options.missingInterpolationHandler,d=((A=r==null?void 0:r.interpolation)==null?void 0:A.skipOnVariables)!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:g=>hB(g)},{regex:this.regexp,safeValue:g=>this.escapeValue?hB(this.escape(g)):hB(g)}].forEach(g=>{for(a=0;s=g.regex.exec(e);){const p=s[1].trim();if(o=h(p),o===void 0)if(typeof u=="function"){const v=u(e,s,r);o=pr(v)?v:""}else if(r&&Object.prototype.hasOwnProperty.call(r,p))o="";else if(d){o=s[0];continue}else this.logger.warn(`missed to pass in variable ${p} for interpolating ${e}`),o="";else!pr(o)&&!this.useRawValueToEscape&&(o=EO(o));const y=g.safeValue(o);if(e=e.replace(s[0],y),d?(g.regex.lastIndex+=o.length,g.regex.lastIndex-=s[0].length):g.regex.lastIndex=0,a++,a>=this.maxReplaces)break}}),e}nest(e,t,i={}){let r,s,o;const a=(c,h)=>{const u=this.nestingOptionsSeparator;if(c.indexOf(u)<0)return c;const d=c.split(new RegExp(`${u}[ ]*{`));let f=`{${d[1]}`;c=d[0],f=this.interpolate(f,o);const A=f.match(/'/g),g=f.match(/"/g);(((A==null?void 0:A.length)??0)%2===0&&!g||g.length%2!==0)&&(f=f.replace(/'/g,'"'));try{o=JSON.parse(f),h&&(o={...h,...o})}catch(p){return this.logger.warn(`failed parsing options string in nesting for key ${c}`,p),`${c}${u}${f}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,c};for(;r=this.nestingRegexp.exec(e);){let c=[];o={...i},o=o.replace&&!pr(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;const h=/{.*}/.test(r[1])?r[1].lastIndexOf("}")+1:r[1].indexOf(this.formatSeparator);if(h!==-1&&(c=r[1].slice(h).split(this.formatSeparator).map(u=>u.trim()).filter(Boolean),r[1]=r[1].slice(0,h)),s=t(a.call(this,r[1].trim(),o),o),s&&r[0]===e&&!pr(s))return s;pr(s)||(s=EO(s)),s||(this.logger.warn(`missed to resolve ${r[1]} for nesting ${e}`),s=""),c.length&&(s=c.reduce((u,d)=>this.format(u,d,i.lng,{...i,interpolationkey:r[1].trim()}),s.trim())),e=e.replace(r[0],s),this.regexp.lastIndex=0}return e}}const NKe=n=>{let e=n.toLowerCase().trim();const t={};if(n.indexOf("(")>-1){const i=n.split("(");e=i[0].toLowerCase().trim();const r=i[1].substring(0,i[1].length-1);e==="currency"&&r.indexOf(":")<0?t.currency||(t.currency=r.trim()):e==="relativetime"&&r.indexOf(":")<0?t.range||(t.range=r.trim()):r.split(";").forEach(o=>{if(o){const[a,...c]=o.split(":"),h=c.join(":").trim().replace(/^'+|'+$/g,""),u=a.trim();t[u]||(t[u]=h),h==="false"&&(t[u]=!1),h==="true"&&(t[u]=!0),isNaN(h)||(t[u]=parseInt(h,10))}})}return{formatName:e,formatOptions:t}},OO=n=>{const e={};return(t,i,r)=>{let s=r;r&&r.interpolationkey&&r.formatParams&&r.formatParams[r.interpolationkey]&&r[r.interpolationkey]&&(s={...s,[r.interpolationkey]:void 0});const o=i+JSON.stringify(s);let a=e[o];return a||(a=n(kv(i),r),e[o]=a),a(t)}},LKe=n=>(e,t,i)=>n(kv(t),i)(e);class MKe{constructor(e={}){this.logger=hd.create("formatter"),this.options=e,this.init(e)}init(e,t={interpolation:{}}){this.formatSeparator=t.interpolation.formatSeparator||",";const i=t.cacheInBuiltFormats?OO:LKe;this.formats={number:i((r,s)=>{const o=new Intl.NumberFormat(r,{...s});return a=>o.format(a)}),currency:i((r,s)=>{const o=new Intl.NumberFormat(r,{...s,style:"currency"});return a=>o.format(a)}),datetime:i((r,s)=>{const o=new Intl.DateTimeFormat(r,{...s});return a=>o.format(a)}),relativetime:i((r,s)=>{const o=new Intl.RelativeTimeFormat(r,{...s});return a=>o.format(a,s.range||"day")}),list:i((r,s)=>{const o=new Intl.ListFormat(r,{...s});return a=>o.format(a)})}}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=OO(t)}format(e,t,i,r={}){const s=t.split(this.formatSeparator);if(s.length>1&&s[0].indexOf("(")>1&&s[0].indexOf(")")<0&&s.find(a=>a.indexOf(")")>-1)){const a=s.findIndex(c=>c.indexOf(")")>-1);s[0]=[s[0],...s.splice(1,a)].join(this.formatSeparator)}return s.reduce((a,c)=>{var d;const{formatName:h,formatOptions:u}=NKe(c);if(this.formats[h]){let f=a;try{const A=((d=r==null?void 0:r.formatParams)==null?void 0:d[r.interpolationkey])||{},g=A.locale||A.lng||r.locale||r.lng||i;f=this.formats[h](a,g,{...u,...r,...A})}catch(A){this.logger.warn(A)}return f}else this.logger.warn(`there was no format function for ${h}`);return a},e)}}const RKe=(n,e)=>{n.pending[e]!==void 0&&(delete n.pending[e],n.pendingCount--)};class OKe extends yS{constructor(e,t,i,r={}){var s,o;super(),this.backend=e,this.store=t,this.services=i,this.languageUtils=i.languageUtils,this.options=r,this.logger=hd.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=r.maxParallelReads||10,this.readingCalls=0,this.maxRetries=r.maxRetries>=0?r.maxRetries:5,this.retryTimeout=r.retryTimeout>=1?r.retryTimeout:350,this.state={},this.queue=[],(o=(s=this.backend)==null?void 0:s.init)==null||o.call(s,i,r.backend,r)}queueLoad(e,t,i,r){const s={},o={},a={},c={};return e.forEach(h=>{let u=!0;t.forEach(d=>{const f=`${h}|${d}`;!i.reload&&this.store.hasResourceBundle(h,d)?this.state[f]=2:this.state[f]<0||(this.state[f]===1?o[f]===void 0&&(o[f]=!0):(this.state[f]=1,u=!1,o[f]===void 0&&(o[f]=!0),s[f]===void 0&&(s[f]=!0),c[d]===void 0&&(c[d]=!0)))}),u||(a[h]=!0)}),(Object.keys(s).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:r}),{toLoad:Object.keys(s),pending:Object.keys(o),toLoadLanguages:Object.keys(a),toLoadNamespaces:Object.keys(c)}}loaded(e,t,i){const r=e.split("|"),s=r[0],o=r[1];t&&this.emit("failedLoading",s,o,t),!t&&i&&this.store.addResourceBundle(s,o,i,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&i&&(this.state[e]=0);const a={};this.queue.forEach(c=>{_Ke(c.loaded,[s],o),RKe(c,e),t&&c.errors.push(t),c.pendingCount===0&&!c.done&&(Object.keys(c.loaded).forEach(h=>{a[h]||(a[h]={});const u=c.loaded[h];u.length&&u.forEach(d=>{a[h][d]===void 0&&(a[h][d]=!0)})}),c.done=!0,c.errors.length?c.callback(c.errors):c.callback())}),this.emit("loaded",a),this.queue=this.queue.filter(c=>!c.done)}read(e,t,i,r=0,s=this.retryTimeout,o){if(!e.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:t,fcName:i,tried:r,wait:s,callback:o});return}this.readingCalls++;const a=(h,u)=>{if(this.readingCalls--,this.waitingReads.length>0){const d=this.waitingReads.shift();this.read(d.lng,d.ns,d.fcName,d.tried,d.wait,d.callback)}if(h&&u&&r<this.maxRetries){setTimeout(()=>{this.read.call(this,e,t,i,r+1,s*2,o)},s);return}o(h,u)},c=this.backend[i].bind(this.backend);if(c.length===2){try{const h=c(e,t);h&&typeof h.then=="function"?h.then(u=>a(null,u)).catch(a):a(null,h)}catch(h){a(h)}return}return c(e,t,a)}prepareLoading(e,t,i={},r){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),r&&r();pr(e)&&(e=this.languageUtils.toResolveHierarchy(e)),pr(t)&&(t=[t]);const s=this.queueLoad(e,t,i,r);if(!s.toLoad.length)return s.pending.length||r(),null;s.toLoad.forEach(o=>{this.loadOne(o)})}load(e,t,i){this.prepareLoading(e,t,{},i)}reload(e,t,i){this.prepareLoading(e,t,{reload:!0},i)}loadOne(e,t=""){const i=e.split("|"),r=i[0],s=i[1];this.read(r,s,"read",void 0,void 0,(o,a)=>{o&&this.logger.warn(`${t}loading namespace ${s} for language ${r} failed`,o),!o&&a&&this.logger.log(`${t}loaded namespace ${s} for language ${r}`,a),this.loaded(e,o,a)})}saveMissing(e,t,i,r,s,o={},a=()=>{}){var c,h,u,d,f;if((h=(c=this.services)==null?void 0:c.utils)!=null&&h.hasLoadedNamespace&&!((d=(u=this.services)==null?void 0:u.utils)!=null&&d.hasLoadedNamespace(t))){this.logger.warn(`did not save key "${i}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(i==null||i==="")){if((f=this.backend)!=null&&f.create){const A={...o,isUpdate:s},g=this.backend.create.bind(this.backend);if(g.length<6)try{let p;g.length===5?p=g(e,t,i,r,A):p=g(e,t,i,r),p&&typeof p.then=="function"?p.then(y=>a(null,y)).catch(a):a(null,p)}catch(p){a(p)}else g(e,t,i,r,a,A)}!e||!e[0]||this.store.addResource(e[0],t,i,r)}}}const UO=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:n=>{let e={};if(typeof n[1]=="object"&&(e=n[1]),pr(n[1])&&(e.defaultValue=n[1]),pr(n[2])&&(e.tDescription=n[2]),typeof n[2]=="object"||typeof n[3]=="object"){const t=n[3]||n[2];Object.keys(t).forEach(i=>{e[i]=t[i]})}return e},interpolation:{escapeValue:!0,format:n=>n,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),HO=n=>{var e,t;return pr(n.ns)&&(n.ns=[n.ns]),pr(n.fallbackLng)&&(n.fallbackLng=[n.fallbackLng]),pr(n.fallbackNS)&&(n.fallbackNS=[n.fallbackNS]),((t=(e=n.supportedLngs)==null?void 0:e.indexOf)==null?void 0:t.call(e,"cimode"))<0&&(n.supportedLngs=n.supportedLngs.concat(["cimode"])),typeof n.initImmediate=="boolean"&&(n.initAsync=n.initImmediate),n},Pb=()=>{},UKe=n=>{Object.getOwnPropertyNames(Object.getPrototypeOf(n)).forEach(t=>{typeof n[t]=="function"&&(n[t]=n[t].bind(n))})};class Iv extends yS{constructor(e={},t){if(super(),this.options=HO(e),this.services={},this.logger=hd,this.modules={external:[]},UKe(this),t&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,t),this;setTimeout(()=>{this.init(e,t)},0)}}init(e={},t){this.isInitializing=!0,typeof e=="function"&&(t=e,e={}),e.defaultNS==null&&e.ns&&(pr(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const i=UO();this.options={...i,...this.options,...HO(e)},this.options.interpolation={...i.interpolation,...this.options.interpolation},e.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=e.keySeparator),e.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=e.nsSeparator);const r=h=>h?typeof h=="function"?new h:h:null;if(!this.options.isClone){this.modules.logger?hd.init(r(this.modules.logger),this.options):hd.init(null,this.options);let h;this.modules.formatter?h=this.modules.formatter:h=MKe;const u=new NO(this.options);this.store=new DO(this.options.resources,this.options);const d=this.services;d.logger=hd,d.resourceStore=this.store,d.languageUtils=u,d.pluralResolver=new jKe(u,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==i.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),h&&(!this.options.interpolation.format||this.options.interpolation.format===i.interpolation.format)&&(d.formatter=r(h),d.formatter.init&&d.formatter.init(d,this.options),this.options.interpolation.format=d.formatter.format.bind(d.formatter)),d.interpolator=new PKe(this.options),d.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},d.backendConnector=new OKe(r(this.modules.backend),d.resourceStore,d,this.options),d.backendConnector.on("*",(A,...g)=>{this.emit(A,...g)}),this.modules.languageDetector&&(d.languageDetector=r(this.modules.languageDetector),d.languageDetector.init&&d.languageDetector.init(d,this.options.detection,this.options)),this.modules.i18nFormat&&(d.i18nFormat=r(this.modules.i18nFormat),d.i18nFormat.init&&d.i18nFormat.init(this)),this.translator=new WC(this.services,this.options),this.translator.on("*",(A,...g)=>{this.emit(A,...g)}),this.modules.external.forEach(A=>{A.init&&A.init(this)})}if(this.format=this.options.interpolation.format,t||(t=Pb),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const h=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);h.length>0&&h[0]!=="dev"&&(this.options.lng=h[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(h=>{this[h]=(...u)=>this.store[h](...u)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(h=>{this[h]=(...u)=>(this.store[h](...u),this)});const a=R2(),c=()=>{const h=(u,d)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),a.resolve(d),t(u,d)};if(this.languages&&!this.isInitialized)return h(null,this.t.bind(this));this.changeLanguage(this.options.lng,h)};return this.options.resources||!this.options.initAsync?c():setTimeout(c,0),a}loadResources(e,t=Pb){var s,o;let i=t;const r=pr(e)?e:this.language;if(typeof e=="function"&&(i=e),!this.options.resources||this.options.partialBundledLanguages){if((r==null?void 0:r.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return i();const a=[],c=h=>{if(!h||h==="cimode")return;this.services.languageUtils.toResolveHierarchy(h).forEach(d=>{d!=="cimode"&&a.indexOf(d)<0&&a.push(d)})};r?c(r):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(u=>c(u)),(o=(s=this.options.preload)==null?void 0:s.forEach)==null||o.call(s,h=>c(h)),this.services.backendConnector.load(a,this.options.ns,h=>{!h&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),i(h)})}else i(null)}reloadResources(e,t,i){const r=R2();return typeof e=="function"&&(i=e,e=void 0),typeof t=="function"&&(i=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),i||(i=Pb),this.services.backendConnector.reload(e,t,s=>{r.resolve(),i(s)}),r}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&hY.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1)){for(let t=0;t<this.languages.length;t++){const i=this.languages[t];if(!(["cimode","dev"].indexOf(i)>-1)&&this.store.hasLanguageSomeTranslations(i)){this.resolvedLanguage=i;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,t){this.isLanguageChangingTo=e;const i=R2();this.emit("languageChanging",e);const r=a=>{this.language=a,this.languages=this.services.languageUtils.toResolveHierarchy(a),this.resolvedLanguage=void 0,this.setResolvedLanguage(a)},s=(a,c)=>{c?this.isLanguageChangingTo===e&&(r(c),this.translator.changeLanguage(c),this.isLanguageChangingTo=void 0,this.emit("languageChanged",c),this.logger.log("languageChanged",c)):this.isLanguageChangingTo=void 0,i.resolve((...h)=>this.t(...h)),t&&t(a,(...h)=>this.t(...h))},o=a=>{var u,d;!e&&!a&&this.services.languageDetector&&(a=[]);const c=pr(a)?a:a&&a[0],h=this.store.hasLanguageSomeTranslations(c)?c:this.services.languageUtils.getBestMatchFromCodes(pr(a)?[a]:a);h&&(this.language||r(h),this.translator.language||this.translator.changeLanguage(h),(d=(u=this.services.languageDetector)==null?void 0:u.cacheUserLanguage)==null||d.call(u,h)),this.loadResources(h,f=>{s(f,h)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?o(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(e),i}getFixedT(e,t,i){const r=(s,o,...a)=>{let c;typeof o!="object"?c=this.options.overloadTranslationOptionHandler([s,o].concat(a)):c={...o},c.lng=c.lng||r.lng,c.lngs=c.lngs||r.lngs,c.ns=c.ns||r.ns,c.keyPrefix!==""&&(c.keyPrefix=c.keyPrefix||i||r.keyPrefix);const h=this.options.keySeparator||".";let u;return c.keyPrefix&&Array.isArray(s)?u=s.map(d=>(typeof d=="function"&&(d=q6(d,{...this.options,...o})),`${c.keyPrefix}${h}${d}`)):(typeof s=="function"&&(s=q6(s,{...this.options,...o})),u=c.keyPrefix?`${c.keyPrefix}${h}${s}`:s),this.t(u,c)};return pr(e)?r.lng=e:r.lngs=e,r.ns=t,r.keyPrefix=i,r}t(...e){var t;return(t=this.translator)==null?void 0:t.translate(...e)}exists(...e){var t;return(t=this.translator)==null?void 0:t.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,t={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const i=t.lng||this.resolvedLanguage||this.languages[0],r=this.options?this.options.fallbackLng:!1,s=this.languages[this.languages.length-1];if(i.toLowerCase()==="cimode")return!0;const o=(a,c)=>{const h=this.services.backendConnector.state[`${a}|${c}`];return h===-1||h===0||h===2};if(t.precheck){const a=t.precheck(this,o);if(a!==void 0)return a}return!!(this.hasResourceBundle(i,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(i,e)&&(!r||o(s,e)))}loadNamespaces(e,t){const i=R2();return this.options.ns?(pr(e)&&(e=[e]),e.forEach(r=>{this.options.ns.indexOf(r)<0&&this.options.ns.push(r)}),this.loadResources(r=>{i.resolve(),t&&t(r)}),i):(t&&t(),Promise.resolve())}loadLanguages(e,t){const i=R2();pr(e)&&(e=[e]);const r=this.options.preload||[],s=e.filter(o=>r.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return s.length?(this.options.preload=r.concat(s),this.loadResources(o=>{i.resolve(),t&&t(o)}),i):(t&&t(),Promise.resolve())}dir(e){var r,s;if(e||(e=this.resolvedLanguage||(((r=this.languages)==null?void 0:r.length)>0?this.languages[0]:this.language)),!e)return"rtl";try{const o=new Intl.Locale(e);if(o&&o.getTextInfo){const a=o.getTextInfo();if(a&&a.direction)return a.direction}}catch{}const t=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],i=((s=this.services)==null?void 0:s.languageUtils)||new NO(UO());return e.toLowerCase().indexOf("-latn")>1?"ltr":t.indexOf(i.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},t){return new Iv(e,t)}cloneInstance(e={},t=Pb){const i=e.forkResourceStore;i&&delete e.forkResourceStore;const r={...this.options,...e,isClone:!0},s=new Iv(r);if((e.debug!==void 0||e.prefix!==void 0)&&(s.logger=s.logger.clone(e)),["store","services","language"].forEach(a=>{s[a]=this[a]}),s.services={...this.services},s.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},i){const a=Object.keys(this.store.data).reduce((c,h)=>(c[h]={...this.store.data[h]},c[h]=Object.keys(c[h]).reduce((u,d)=>(u[d]={...c[h][d]},u),c[h]),c),{});s.store=new DO(a,r),s.services.resourceStore=s.store}return s.translator=new WC(s.services,r),s.translator.on("*",(a,...c)=>{s.emit(a,...c)}),s.init(r,t),s.translator.options=r,s.translator.backendConnector.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},s}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const tc=Iv.createInstance();tc.createInstance=Iv.createInstance;tc.createInstance;tc.dir;tc.init;tc.loadResources;tc.reloadResources;tc.use;tc.changeLanguage;tc.getFixedT;tc.t;tc.exists;tc.setDefaultNamespace;tc.hasLoadedNamespace;tc.loadNamespaces;tc.loadLanguages;const HKe={save:"저장",cancel:"취소",delete:"삭제",edit:"편집",add:"추가",remove:"제거",confirm:"확인",close:"닫기",back:"뒤로",next:"다음",finish:"완료",apply:"적용",reset:"초기화",search:"검색",loading:"로딩 중...",error:"오류",success:"성공",warning:"경고",info:"정보",undo:"실행취소",redo:"다시실행",copy:"복사",paste:"붙여넣기",file:"파일",saving:"저장 중...",help:"도움말",controls:"조작법",converting:"컨버팅",logout:"로그아웃",login:"로그인",none:"없음",enabled:"있음",unit:"단위"},WKe={title:"설정",general:"일반 설정",language:"언어",languageDesc:"인터페이스 언어 설정",theme:"테마",themeDesc:"테마 설정",themeSettings:"테마 설정",displayMode:"표시 모드",themeColor:"테마 색상",lightMode:"라이트 모드",darkMode:"다크 모드",notifications:"알림",notificationsDesc:"새로운 업데이트 및 알림 받기",autoSave:"자동 저장",autoSaveDesc:"변경사항을 자동으로 저장",gridSnap:"그리드 스냅",gridSnapDesc:"오브젝트를 그리드에 자동 정렬",shortcuts:"키보드 단축키",version:"버전",lastUpdate:"최종 업데이트",info:"정보"},QKe={title:"공간 설정",width:"너비",height:"높이",depth:"깊이",installType:"설치 타입",builtin:"양쪽벽",builtinDesc:"양쪽 벽이 막혀있는 기본형식",semistanding:"한쪽벽",semistandingDesc:"한쪽만 벽으로 막혀있고 한쪽은 오픈된 형식",freestanding:"벽없음",freestandingDesc:"양쪽 벽이 없는 독립형 형식",wallPosition:"벽 위치",standing:"스탠딩",semiStanding:"세미스탠딩",wallMount:"벽걸이",surroundType:"서라운드 타입",surround:"서라운드",noSurround:"노서라운드",columnCount:"컬럼 수",doorCount:"도어 개수",droppedCeiling:"단내림",droppedCeilingEnabled:"단내림 사용",droppedCeilingHeight:"단내림 높이",droppedCeilingWidth:"단내림 너비",mainSection:"메인구간",droppedSection:"단내림구간",mainSectionSize:"메인구간 사이즈",droppedSectionSize:"단내림 구간 사이즈",droppedColumnCount:"단내림 컬럼수",floorFinish:"바닥 마감",floorFinishThickness:"두께",totalWidth:"전체 너비"},$Ke={title:"프레임 설정",frameWidth:"프레임 폭",leftFrame:"좌측 프레임",rightFrame:"우측 프레임",topFrame:"상부 프레임",baseFrame:"베이스 프레임",endPanel:"엔드패널",subFrame:"서브프레임",frameOptions:"프레임 옵션",withFrame:"프레임 있음",withoutFrame:"프레임 없음",properties:"프레임 속성",baseHeight:"받침대 높이",floatHeight:"띄움 높이"},VKe={title:"가구",upperCabinet:"상부장",lowerCabinet:"하부장",tallCabinet:"키큰장",dualCabinet:"듀얼장",singleCabinet:"싱글장",backPanel:"백패널",gapBackPanel:"상하부장 사이 백패널",door:"도어",drawer:"서랍",shelf:"선반",handle:"핸들",hinge:"경첩",hingePosition:"경첩 위치",left:"좌측",right:"우측",moduleLibrary:"모듈 라이브러리",placedModules:"배치된 모듈",moduleProperties:"모듈 속성",customWidth:"사용자 정의 너비",customHeight:"사용자 정의 높이",customDepth:"사용자 정의 깊이",all:"전체",single:"싱글",dual:"듀얼",moduleNotReady:"모듈은 아직 준비 중입니다",noModulesAvailable:"이 유형에 맞는 가구가 없습니다",editFurniture:"가구 편집",viewDetails:"상세보기",panelDetails:"패널 상세 정보",widthSettings:"너비 설정",depthSettings:"깊이 설정",range:"범위",doorSettings:"도어 유무",hingeDirection:"경첩 방향",openToRight:"오른쪽으로 열림",openToLeft:"왼쪽으로 열림",coverDoorNote:"커버도어는 경첩 위치 변경이 불가합니다",gapBackPanelSettings:"상하부장 사이 백패널",backPanelAlreadySet:"이미 같은 슬롯의 {{position}}에서 백패널이 설정되어 있습니다.",minValue:"최소 {{value}}mm 이상이어야 합니다",maxValue:"최대 {{value}}mm 이하여야 합니다",upperSection:"상부 섹션",lowerSection:"하부 섹션",leftPanel:"좌측판",rightPanel:"우측판",topPanel:"상판",bottomPanel:"하판",frontPanel:"앞판",handlePlate:"손잡이판",drawerDivider:"서랍 칸막이"},zKe={title:"배치 설정",properties:"배치 속성",placementType:"배치 타입",droppedCeilingPosition:"단내림 위치",floor:"바닥 배치",float:"띄워서 배치",floatHeight:"띄움 높이",gap:"간격",leftGap:"좌측",rightGap:"우측",topGap:"상부 간격",bottomGap:"하부 간격",wallOffset:"이격거리 설정",noWall:"벽 없음"},GKe={title:"재질 설정",floorFinish:"바닥 마감재",woodGrain:"목재 무늬",solid:"단색",metallic:"금속",glass:"유리",matte:"무광",glossy:"유광",texture:"텍스처",color:"색상",finish:"마감",white:"화이트",melamine:"멜라민",premium:"프리미엄",interior:"내부",door:"도어",furnitureLibrary:"가구 라이브러리",internalSpace:"내경 공간 (맞춤형 가구 기준)",internalSpaceDimensions:"폭: {{width}}mm × 높이: {{height}}mm × 깊이: {{depth}}mm",internalSpaceNote:"* 모든 가구는 내경 높이({{height}}mm)와 깊이({{depth}}mm)에 맞춰 제작됩니다",columnInfo:"* 컬럼 수: {{count}}개 / 컬럼당 너비: {{width}}mm",tallSingleDesc:"키큰장 - 1개 컬럼을 차지하는 가구 (약 {{width}}mm 폭)",tallDualDesc:"키큰장 - 2개 컬럼을 차지하는 가구 (약 {{width}}mm 폭)",upperSingleDesc:"상부장 - 1개 컬럼 (약 {{width}}mm 폭)",upperDualDesc:"상부장 - 2개 컬럼 (약 {{width}}mm 폭)",lowerSingleDesc:"하부장 - 1개 컬럼 (약 {{width}}mm 폭)",lowerDualDesc:"하부장 - 2개 컬럼 (약 {{width}}mm 폭)",colorPicker:"색상 지정하기",brightnessAdjust:"밝기 조정",savedColors:"저장된 색상",addColorHint:"+ 버튼으로 색상 추가"},XKe={title:"뷰어",view2D:"2D 뷰",view3D:"3D 뷰",all:"전체",front:"정면",left:"좌측",right:"우측",top:"상부",perspective:"투시도",wireframe:"은선",solid:"솔리드",showDimensions:"치수",showGuides:"그리드",showAxis:"축",showAll:"모두 표시",dimensions:"치수",grid:"그리드",axis:"축",column:"컬럼",doorInstallation:"도어설치",doorOpen:"열기",doorClose:"닫기",indirectLight:"간접조명",indirectLightOn:"간접조명 켜기",indirectLightOff:"간접조명 끄기",on:"on",off:"off"},KKe={title:"프로젝트",newProject:"새 디자인",openProject:"프로젝트 열기",saveProject:"프로젝트 저장",saveAs:"다른이름으로 저장",export:"내보내기",import:"가져오기",projectName:"프로젝트명",designer:"디자이너",client:"고객명",date:"날짜",description:"설명",untitled:"제목 없음",enterName:"프로젝트 이름을 입력하세요:"},qKe={module:"모듈",material:"재질",structure:"구조물",etc:"기타",structureTypes:"구조물 종류",columnA:"기둥A",columnB:"기둥B",columnC:"기둥C",panelA:"패널A",panelB:"패널B",partition:"가벽",accessories:"악세서리",preparing:"준비중입니다.",exitToDashboard:"대시보드로 나가기"},YKe={saveSuccess:"저장되었습니다",saveFailed:"저장에 실패했습니다",deleteConfirm:"정말 삭제하시겠습니까?",unsavedChanges:"저장되지 않은 변경사항이 있습니다",loadingProject:"프로젝트를 불러오는 중...",noProjectFound:"프로젝트를 찾을 수 없습니다",invalidInput:"유효하지 않은 입력값입니다",connectionError:"연결 오류가 발생했습니다",sessionExpired:"세션이 만료되었습니다",exitWithoutSaving:"그냥 나가기",exitWithSaving:"저장하고 나가기",captureFailure:"뷰 캡처에 실패했습니다. 다시 시도해주세요.",exitConfirm:"변경사항을 저장하지 않고 나가시겠습니까?",loseChanges:"저장하지 않은 내용은 잃어버리게 됩니다."},ZKe={accountInfo:"계정 정보",authMethod:"인증 방법",googleAccount:"Google 계정",emailAuth:"이메일 인증",other:"기타",joinDate:"가입일",lastActivity:"마지막 활동",quickMenu:"빠른 메뉴",accountSettings:"계정 설정"},JKe={editColumn:"기둥 편집",deleteConfirm:"기둥을 삭제하시겠습니까?",basicInfo:"기본 정보",columnId:"기둥 ID",size:"크기",width:"폭",depth:"깊이",height:"높이",position:"위치",leftGap:"좌측갭",rightGap:"우측갭",keyboardHint:"키보드 조작: ↑↓(좌측갭 1mm/Shift+10mm), ←→(우측갭 10mm/Shift+100mm)"},eqe={title:"조작법",shortcuts:{mouseDrag:"마우스 드래그",cameraRotate:"카메라 회전",mouseWheel:"마우스 휠",zoomInOut:"줌 인/아웃",deleteSelected:"선택된 가구 삭제",exitEditMode:"편집 모드 종료",arrowKeys:"화살표 키",fineTuneMove:"가구 미세 이동",doubleClick:"더블클릭",editMode:"가구 편집 모드",dragDrop:"드래그 앤 드롭",placeFurniture:"가구 배치"},tips:{title:"사용 팁",autoPlace:"사이드바에서 가구를 더블클릭하면 빈 슬롯에 자동 배치됩니다",editPopup:"가구를 클릭하면 편집 팝업이 열립니다",editColumn:"기둥을 더블클릭하면 기둥 속성을 편집할 수 있습니다",doorInstall:"도어 설치 버튼으로 도어를 추가/제거할 수 있습니다"}},tqe={title:"CNC 최적화",calculate:"계산하기",export:"내보내기",panels:"패널",stock:"원자재",options:"옵션",panel:"패널",cut:"절단",result:"결과",sheets:"시트",sheet:"시트",efficiency:"효율",wasteArea:"폐기 면적",usedArea:"사용 면적",cutLength:"절단 길이",cutCount:"절단 횟수",simulation:"시뮬레이션",play:"재생",pause:"일시정지",speed:"속도",exit:"나가기",back:"뒤로",next:"다음",noResults:"최적화 결과가 없습니다",setupHint:'패널과 원자재를 설정한 후 "최적화" 버튼을 클릭하세요',optimizing:"최적화 중...",generatePanels:"패널생성",totalStats:"전체 통계",sheetStats:"시트 통계",totalPanels:"총 패널",bladeThickness:"톱날 두께",optimization:"최적화",panelCount:"패널 수",sheetList:"시트 목록",cuttingList:"컷팅 리스트",keyboardNavigationHint:"방향키로 시트 이동",optimalL:"L방향 우선",optimalW:"W방향 우선",optimalCNC:"CNC 최적화",optimizationComplete:"최적화 완료! {{panels}}개 패널, {{sheets}}개 시트 (평균 효율: {{efficiency}}%)",optimizationFailed:"최적화 실패: 패널을 배치할 수 없습니다",noPanelsError:"최적화할 패널이 없습니다",noStockError:"원자재가 정의되지 않았습니다",optimizationError:"최적화 실패",aiOptimizing:"AI 최적화 계산 중",aiPhase1:"패널 데이터 분석 중",aiPhase2:"최적 배치 알고리즘 실행",aiPhase3:"공간 효율성 계산",aiPhase4:"절단 경로 최적화",aiPhase5:"결과 검증 중",minWaste:"최소폐기",verticalCut:"세로절단",horizontalCut:"가로절단",panelList:"패널목록",noPanelsMessage:'패널이 없습니다. "추가" 버튼을 클릭하여 생성하세요.',name:"이름",dimensions:"치수 (L×W)",thickness:"두께",quantity:"수량",material:"재질",grain:"결방향",panelNamePlaceholder:"패널 이름",lengthPlaceholder:"세로",widthPlaceholder:"가로",csvReplaceConfirm:`기존 패널 {{count}}개가 있습니다. 대체하시겠습니까?

'확인': CSV 파일로 대체
'취소': 기존 패널에 추가`,csvImportSuccess:"{{count}}개의 패널을 CSV 파일에서 가져왔습니다.",csvAddSuccess:"{{count}}개의 패널을 추가했습니다.",csvNoValidData:"CSV 파일에서 유효한 패널 데이터를 찾을 수 없습니다.",csvReadError:"CSV 파일을 읽는 중 오류가 발생했습니다.",grainVerticalTooltip:"세로 결방향 (클릭하여 가로로 변경)",grainHorizontalTooltip:"가로 결방향 (클릭하여 세로로 변경)",csvNoData:"CSV 파일에 데이터가 없습니다",stockAddSuccess:"{{count}}개의 원자재를 추가했습니다",noStockMessage:'원자재가 없습니다. "추가" 버튼을 클릭하여 생성하세요.',stockNamePlaceholder:"원자재 이름",maxValue:"최대 {{value}}mm",edgeGapSettings:"엣지 갭 설정",top:"상단",bottom:"하단",left:"좌측",right:"우측",considerGrain:"결 방향 고려",groupByMaterial:"재질별 그룹화",showPanelLabels:"패널 라벨 표시",considerEdgeBanding:"엣지밴드 고려",singleSheetOnly:"단일 시트만 사용",alignVerticalCuts:"세로 컷팅 정렬",exitConfirmMessage:"CNC 옵티마이저를 종료하시겠습니까?",unsavedChangesWarning:"저장되지 않은 변경사항이 있을 수 있습니다."},nqe={common:HKe,settings:WKe,space:QKe,frame:$Ke,furniture:VKe,placement:zKe,material:GKe,viewer:XKe,project:KKe,export:{title:"내보내기",pdf:"PDF 다운로드",pdfDesc:"정면도, 평면도, 측면도를 포함한 PDF 생성",dxf:"DXF 도면",dxfDesc:"CAD 프로그램용 도면 파일 (준비 중)",image:"이미지 다운로드",imageDesc:"PNG/JPG 형식으로 저장 (준비 중)",excel:"엑셀로 내보내기",cutList:"재단목록",partsList:"부품목록",estimate:"견적서",converting:"변환중",capturing:"캡처 중...",cuttingOptimizer:"컷팅 옵티마이저",drawingEditor:"도면 편집기"},sidebar:qKe,messages:YKe,profile:ZKe,column:JKe,help:eqe,cnc:tqe},iqe={save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",remove:"Remove",confirm:"Confirm",close:"Close",back:"Back",next:"Next",finish:"Finish",apply:"Apply",reset:"Reset",search:"Search",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Info",undo:"Undo",redo:"Redo",copy:"Copy",paste:"Paste",file:"File",saving:"Saving...",help:"Help",controls:"Controls",converting:"Converting",logout:"Logout",login:"Login",brandType:"Brand Type",priceInfo:"Price Info",priceRange:"Price Range",none:"None",enabled:"Enabled",unit:"Unit"},rqe={title:"Settings",general:"General Settings",language:"Language",languageDesc:"Interface language settings",theme:"Theme",themeDesc:"Theme settings",themeSettings:"Theme Settings",displayMode:"Display Mode",themeColor:"Theme Color",lightMode:"Light Mode",darkMode:"Dark Mode",notifications:"Notifications",notificationsDesc:"Receive updates and notifications",autoSave:"Auto Save",autoSaveDesc:"Automatically save changes",gridSnap:"Grid Snap",gridSnapDesc:"Auto-align objects to grid",shortcuts:"Keyboard Shortcuts",version:"Version",lastUpdate:"Last Update",info:"Info"},sqe={title:"Space Settings",width:"Width",height:"Height",depth:"Depth",installType:"Installation Type",builtin:"Built-in",builtinDesc:"Built-in type with both walls",semistanding:"Semi-standing",semistandingDesc:"Semi-standing type with one wall and one open side",freestanding:"Free-standing",freestandingDesc:"Free-standing type without walls",wallPosition:"Wall Position",standing:"Standing",semiStanding:"Semi-Standing",wallMount:"Wall Mount",surroundType:"Surround Type",surround:"Surround",noSurround:"No Surround",columnCount:"Column Count",doorCount:"Door Count",droppedCeiling:"Dropped Ceiling",droppedCeilingEnabled:"Enable Dropped Ceiling",droppedCeilingHeight:"Dropped Ceiling Height",droppedCeilingWidth:"Dropped Ceiling Width",mainSection:"Main Section",droppedSection:"Dropped Section",mainSectionSize:"Main Section Size",droppedSectionSize:"Dropped Section Size",droppedColumnCount:"Dropped Section Columns",totalWidth:"Total Width"},oqe={title:"Frame Settings",frameWidth:"Frame Width",leftFrame:"Left Frame",rightFrame:"Right Frame",topFrame:"Top Frame",baseFrame:"Base Frame",endPanel:"End Panel",subFrame:"Sub Frame",frameOptions:"Frame Options",withFrame:"With Frame",withoutFrame:"Without Frame",properties:"Frame Properties",baseHeight:"Base Height",floatHeight:"Float Height"},aqe={title:"Furniture",upperCabinet:"Upper",lowerCabinet:"Lower",tallCabinet:"Tall",dualCabinet:"Dual Cabinet",singleCabinet:"Single Cabinet",backPanel:"Back Panel",gapBackPanel:"Gap Back Panel",door:"Door",drawer:"Drawer",shelf:"Shelf",handle:"Handle",hinge:"Hinge",hingePosition:"Hinge Position",left:"Left",right:"Right",moduleLibrary:"Module Library",placedModules:"Placed Modules",moduleProperties:"Module Properties",customWidth:"Custom Width",customHeight:"Custom Height",customDepth:"Custom Depth",all:"All",single:"Single",dual:"Dual",moduleNotReady:"Modules are still being prepared",noModulesAvailable:"No furniture available for this type",editFurniture:"Edit Furniture",viewDetails:"View Details",panelDetails:"Panel Details",widthSettings:"Width Settings",depthSettings:"Depth Settings",range:"Range",doorSettings:"Door Settings",hingeDirection:"Hinge Direction",openToRight:"Opens to Right",openToLeft:"Opens to Left",coverDoorNote:"Cover door hinge position cannot be changed",gapBackPanelSettings:"Gap Back Panel Between Cabinets",backPanelAlreadySet:"Back panel already set in {{position}} of the same slot.",minValue:"Minimum {{value}}mm required",maxValue:"Maximum {{value}}mm allowed",upperSection:"Upper Section",lowerSection:"Lower Section",leftPanel:"Left Panel",rightPanel:"Right Panel",topPanel:"Top Panel",bottomPanel:"Bottom Panel",frontPanel:"Front Panel",handlePlate:"Handle Plate",drawerDivider:"Drawer Divider"},lqe={title:"Placement Settings",properties:"Placement Properties",placementType:"Placement Type",droppedCeilingPosition:"Dropped Ceiling Position",floor:"On Floor",float:"Floating",floatHeight:"Float Height",gap:"Gap",leftGap:"Left",rightGap:"Right",topGap:"Top Gap",bottomGap:"Bottom Gap",wallOffset:"Wall Offset",noWall:"No Wall"},cqe={title:"Material Settings",woodGrain:"Wood Grain",solid:"Solid",metallic:"Metallic",glass:"Glass",matte:"Matte",glossy:"Glossy",texture:"Texture",color:"Color",finish:"Finish",white:"White",melamine:"Melamine",premium:"Premium",selection:"Material Selection",floorFinish:"Floor Finish",floorFinishThickness:"Thickness",interior:"Body",door:"Door",furnitureLibrary:"Furniture Library",internalSpace:"Internal Space (Custom Furniture Reference)",internalSpaceDimensions:"W: {{width}}mm × H: {{height}}mm × D: {{depth}}mm",internalSpaceNote:"* All furniture is manufactured to internal height ({{height}}mm) and depth ({{depth}}mm)",columnInfo:"* Columns: {{count}} / Width per column: {{width}}mm",tallSingleDesc:"Tall Cabinet - Single column furniture (approx. {{width}}mm width)",tallDualDesc:"Tall Cabinet - Dual column furniture (approx. {{width}}mm width)",upperSingleDesc:"Upper Cabinet - Single column (approx. {{width}}mm width)",upperDualDesc:"Upper Cabinet - Dual column (approx. {{width}}mm width)",lowerSingleDesc:"Lower Cabinet - Single column (approx. {{width}}mm width)",lowerDualDesc:"Lower Cabinet - Dual column (approx. {{width}}mm width)",colorPicker:"Specify Color",brightnessAdjust:"Brightness Adjustment",savedColors:"Saved Colors",addColorHint:"Add color with + button"},hqe={title:"Viewer",view2D:"2D View",view3D:"3D View",all:"All",front:"Front",left:"Left",right:"Right",top:"Top",perspective:"Perspective",wireframe:"Wireframe",solid:"Solid",showDimensions:"Dimensions",showGuides:"Grid",showAxis:"Axis",showAll:"Show All",dimensions:"Dimensions",grid:"Grid",axis:"Axis",column:"Column",doorInstallation:"Door",doorOpen:"Open",doorClose:"Close",indirectLight:"Indirect Light",indirectLightOn:"Turn On Indirect Light",indirectLightOff:"Turn Off Indirect Light",on:"on",off:"off"},uqe={title:"Project",newProject:"New Design",openProject:"Open Project",saveProject:"Save Project",saveAs:"Save As",export:"Export",import:"Import",projectName:"Project Name",designer:"Designer",client:"Client",date:"Date",description:"Description",untitled:"Untitled",enterName:"Enter project name:"},dqe={module:"Module",material:"Material",structure:"Structure",etc:"Others",structureTypes:"Structure Types",columnA:"Column A",columnB:"Column B",columnC:"Column C",panelA:"Panel A",panelB:"Panel B",partition:"Partition",accessories:"Accessories",preparing:"Preparing...",exitToDashboard:"Exit to Dashboard"},Aqe={saveSuccess:"Saved successfully",saveFailed:"Failed to save",deleteConfirm:"Are you sure you want to delete?",unsavedChanges:"You have unsaved changes",loadingProject:"Loading project...",noProjectFound:"Project not found",invalidInput:"Invalid input",connectionError:"Connection error occurred",sessionExpired:"Session expired",exitWithoutSaving:"Exit without saving",captureFailure:"View capture failed. Please try again.",exitConfirm:"Do you want to exit without saving?",loseChanges:"Unsaved changes will be lost."},fqe={accountInfo:"Account Information",authMethod:"Authentication Method",googleAccount:"Google Account",emailAuth:"Email Authentication",other:"Other",joinDate:"Join Date",lastActivity:"Last Activity",quickMenu:"Quick Menu",accountSettings:"Account Settings"},pqe={editColumn:"Edit Column",deleteConfirm:"Are you sure you want to delete this column?",basicInfo:"Basic Information",columnId:"Column ID",size:"Size",width:"Width",depth:"Depth",height:"Height",position:"Position",leftGap:"Left Gap",rightGap:"Right Gap",keyboardHint:"Keyboard controls: ↑↓(Left gap 1mm/Shift+10mm), ←→(Right gap 10mm/Shift+100mm)"},gqe={title:"Controls",shortcuts:{mouseDrag:"Mouse Drag",cameraRotate:"Camera Rotate",mouseWheel:"Mouse Wheel",zoomInOut:"Zoom In/Out",deleteSelected:"Delete Selected Furniture",exitEditMode:"Exit Edit Mode",arrowKeys:"Arrow Keys",fineTuneMove:"Fine-tune Furniture Movement",doubleClick:"Double Click",editMode:"Furniture Edit Mode",dragDrop:"Drag & Drop",placeFurniture:"Place Furniture"},tips:{title:"Tips",autoPlace:"Double-click furniture in sidebar to auto-place in empty slot",editPopup:"Click furniture to open edit popup",editColumn:"Double-click column to edit column properties",doorInstall:"Use door installation button to add/remove doors"}},mqe={title:"CNC Optimizer",calculate:"Calculate",export:"Export",panels:"Panels",stock:"Stock",options:"Options",panel:"Panel",cut:"Cut",result:"Result",sheets:"Sheets",sheet:"Sheet",efficiency:"Efficiency",wasteArea:"Waste Area",usedArea:"Used Area",cutLength:"Cut Length",cutCount:"Cut Count",simulation:"Simulation",play:"Play",pause:"Pause",speed:"Speed",exit:"Exit",back:"Back",next:"Next",noResults:"No optimization results",setupHint:'Set up panels and stock, then click "Optimize" button',optimizing:"Optimizing...",generatePanels:"Generate Panels",totalStats:"Total Stats",sheetStats:"Sheet Stats",totalPanels:"Total Panels",bladeThickness:"Blade Thickness",optimization:"Optimization",panelCount:"Panel Count",sheetList:"Sheet List",cuttingList:"Cutting List",keyboardNavigationHint:"Navigate sheets with arrow keys",optimalL:"L-Direction Priority",optimalW:"W-Direction Priority",optimalCNC:"CNC Optimization",optimizationComplete:"Optimization complete! {{panels}} panels, {{sheets}} sheets (avg efficiency: {{efficiency}}%)",optimizationFailed:"Optimization failed: Cannot place panels",noPanelsError:"No panels to optimize",noStockError:"No stock sheets defined",optimizationError:"Optimization failed",aiOptimizing:"AI Optimization Computing",aiPhase1:"Analyzing panel data",aiPhase2:"Running placement algorithm",aiPhase3:"Calculating space efficiency",aiPhase4:"Optimizing cutting paths",aiPhase5:"Validating results",minWaste:"Min Waste",verticalCut:"Vertical Cut",horizontalCut:"Horizontal Cut",panelList:"Panels",noPanelsMessage:'No panels. Click "Add" button to create.',dimensions:"Size (L×W)",material:"Mtrl",grain:"Grain",quantity:"Qty",thickness:"Thk",name:"Name",panelNamePlaceholder:"e.g., Side Panel",stockNamePlaceholder:"e.g., Stock 1",noStockMessage:'No stock. Click "Add" button to create.',maxValue:"Max: {{value}}",csvImport:"Import CSV",csvExport:"Export CSV",csvImportConfirm:"Import panels from CSV?",csvReadError:"Error reading CSV file",csvNoData:"No data in CSV file",panelsAddSuccess:"{{count}} panels added",stockAddSuccess:"{{count}} stock sheets added",edgeGapSettings:"Edge Gap Settings",top:"Top",bottom:"Bottom",left:"Left",right:"Right",considerGrain:"Consider Grain Direction",groupByMaterial:"Group by Material",showPanelLabels:"Show Panel Labels",considerEdgeBanding:"Consider Edge Banding",singleSheetOnly:"Single Sheet Only",alignVerticalCuts:"Align Vertical Cuts",exitConfirmMessage:"Are you sure you want to exit CNC Optimizer?",unsavedChangesWarning:"You may have unsaved changes."},yqe={common:iqe,settings:rqe,space:sqe,frame:oqe,furniture:aqe,placement:lqe,material:cqe,viewer:hqe,project:uqe,export:{title:"Export",pdf:"PDF Template",pdfDesc:"Generate PDF with technical drawing template",dxf:"DXF Drawing",dxfDesc:"Drawing file for CAD programs (Coming soon)",image:"Download Image",imageDesc:"Save as PNG/JPG format (Coming soon)",excel:"Export to Excel",cutList:"Cut List",partsList:"Parts List",estimate:"Estimate",converting:"Converting",capturing:"Capturing...",cuttingOptimizer:"Cutting Optimizer",drawingEditor:"Drawing Editor"},sidebar:dqe,messages:Aqe,profile:fqe,column:pqe,help:gqe,cnc:mqe},vqe={save:"保存",cancel:"キャンセル",delete:"削除",edit:"編集",add:"追加",remove:"削除",confirm:"確認",close:"閉じる",back:"戻る",next:"次へ",finish:"完了",apply:"適用",reset:"リセット",search:"検索",loading:"読み込み中...",error:"エラー",success:"成功",warning:"警告",info:"情報",undo:"元に戻す",redo:"やり直す",copy:"コピー",paste:"貼り付け",file:"ファイル",saving:"保存中...",help:"ヘルプ",controls:"操作方法",converting:"変換",logout:"ログアウト",login:"ログイン",brandType:"ブランドタイプ",priceInfo:"価格情報",priceRange:"価格帯",none:"なし",enabled:"あり",unit:"単位"},wqe={title:"設定",general:"一般設定",language:"言語",languageDesc:"インターフェース言語設定",theme:"テーマ",themeDesc:"テーマ設定",themeSettings:"テーマ設定",displayMode:"表示モード",themeColor:"テーマカラー",lightMode:"ライトモード",darkMode:"ダークモード",notifications:"通知",notificationsDesc:"更新と通知を受け取る",autoSave:"自動保存",autoSaveDesc:"変更を自動的に保存",gridSnap:"グリッドスナップ",gridSnapDesc:"オブジェクトをグリッドに自動整列",shortcuts:"キーボードショートカット",version:"バージョン",lastUpdate:"最終更新",info:"情報"},xqe={title:"部屋サイズ",width:"幅",height:"高さ",depth:"奥行き",installType:"設置タイプ",builtin:"埋込",builtinDesc:"両側に壁がある埋込み式",semistanding:"半埋込",semistandingDesc:"片側に壁があり片側が開いた半埋込み式",freestanding:"据置",freestandingDesc:"両側に壁がない据置式",wallPosition:"壁の位置",standing:"スタンディング",semiStanding:"セミスタンディング",wallMount:"壁掛け",surroundType:"フレームタイプ",surround:"フレームあり",noSurround:"フレームなし",columnCount:"区画数",doorCount:"扉数",droppedCeiling:"下がり天井",droppedCeilingEnabled:"下がり天井を使用",droppedCeilingHeight:"下がり天井の高さ",droppedCeilingWidth:"下がり天井の幅",mainSection:"メインセクション",droppedSection:"下がり天井セクション",mainSectionSize:"メインセクションサイズ",droppedColumnCount:"下がり天井カラム数",floorFinish:"床仕上げ",floorFinishThickness:"厚さ",totalWidth:"全体幅"},bqe={title:"フレーム設定",frameWidth:"フレーム幅",leftFrame:"左フレーム",rightFrame:"右フレーム",topFrame:"上部フレーム",baseFrame:"ベースフレーム",endPanel:"エンドパネル",subFrame:"サブフレーム",frameOptions:"フレームオプション",withFrame:"フレームあり",withoutFrame:"フレームなし",properties:"フレームプロパティ",baseHeight:"ベースの高さ",floatHeight:"浮かせ高さ"},_qe={title:"家具",upperCabinet:"吊戸棚",lowerCabinet:"下部キャビネット",tallCabinet:"トールキャビネット",dualCabinet:"デュアルキャビネット",singleCabinet:"シングルキャビネット",backPanel:"背面パネル",gapBackPanel:"隙間背面パネル",door:"扉",drawer:"引き出し",shelf:"棚",handle:"取っ手",hinge:"蝶番",hingePosition:"蝶番位置",left:"左側",right:"右側",moduleLibrary:"モジュールライブラリ",placedModules:"配置済みモジュール",moduleProperties:"モジュールプロパティ",customWidth:"カスタム幅",customHeight:"カスタム高さ",customDepth:"カスタム奥行き",all:"すべて",single:"単体",dual:"連結",moduleNotReady:"モジュールはまだ準備中です",noModulesAvailable:"このタイプに適した家具がありません",editFurniture:"家具編集",viewDetails:"詳細を表示",panelDetails:"パネル詳細情報",widthSettings:"幅設定",depthSettings:"奥行き設定",range:"範囲",doorSettings:"扉表示",hingeDirection:"ヒンジ方向",openToRight:"右に開く",openToLeft:"左に開く",coverDoorNote:"カバードアはヒンジ位置を変更できません",gapBackPanelSettings:"キャビネット間のバックパネル",backPanelAlreadySet:"同じスロットの{{position}}でバックパネルが設定されています。",minValue:"最小{{value}}mm以上必要です",maxValue:"最大{{value}}mm以下にしてください",upperSection:"上部セクション",lowerSection:"下部セクション",leftPanel:"左側板",rightPanel:"右側板",topPanel:"天板",bottomPanel:"底板",frontPanel:"前板",handlePlate:"取っ手板",drawerDivider:"引き出し仕切り"},Cqe={title:"配置設定",placementType:"配置タイプ",droppedCeilingPosition:"下がり天井の位置",floor:"床置き",float:"浮かせて設置",floatHeight:"浮かせ高さ",gap:"隙間",leftGap:"左隙間",rightGap:"右隙間",topGap:"上部隙間",bottomGap:"下部隙間",properties:"配置プロパティ"},Sqe={title:"材質設定",woodGrain:"木目",solid:"単色",metallic:"メタリック",glass:"ガラス",matte:"マット",glossy:"光沢",texture:"テクスチャ",color:"色",finish:"仕上げ",selection:"材質選択",floorFinish:"床仕上げ",interior:"内部",door:"ドア",furnitureLibrary:"家具ライブラリ",internalSpace:"内部空間（カスタム家具基準）",internalSpaceDimensions:"幅: {{width}}mm × 高さ: {{height}}mm × 奥行: {{depth}}mm",internalSpaceNote:"* すべての家具は内部高さ（{{height}}mm）と奥行（{{depth}}mm）に合わせて製作されます",columnInfo:"* カラム数: {{count}}個 / カラム幅: {{width}}mm",tallSingleDesc:"トールキャビネット - シングルカラム家具（約{{width}}mm幅）",tallDualDesc:"トールキャビネット - デュアルカラム家具（約{{width}}mm幅）",upperSingleDesc:"アッパーキャビネット - シングルカラム（約{{width}}mm幅）",upperDualDesc:"アッパーキャビネット - デュアルカラム（約{{width}}mm幅）",lowerSingleDesc:"ロワーキャビネット - シングルカラム（約{{width}}mm幅）",lowerDualDesc:"ロワーキャビネット - デュアルカラム（約{{width}}mm幅）",colorPicker:"色を指定",brightnessAdjust:"明度調整",savedColors:"保存した色",addColorHint:"+ボタンで色を追加"},Tqe={title:"ビューアー",view2D:"2Dビュー",view3D:"3Dビュー",all:"すべて",front:"正面",left:"左側",right:"右側",top:"平面",perspective:"透視図",wireframe:"ワイヤーフレーム",solid:"ソリッド",showDimensions:"寸法表示",showGuides:"ガイド表示",showAxis:"軸表示",showAll:"すべて表示",dimensions:"寸法",grid:"グリッド",axis:"軸",column:"カラム",doorInstallation:"ドア",doorOpen:"開ける",doorClose:"閉じる",indirectLight:"間接照明",indirectLightOn:"間接照明をオン",indirectLightOff:"間接照明をオフ",on:"オン",off:"オフ"},Bqe={title:"プロジェクト",newProject:"新規プロジェクト",openProject:"プロジェクトを開く",saveProject:"プロジェクトを保存",saveAs:"名前を付けて保存",export:"エクスポート",import:"インポート",projectName:"プロジェクト名",designer:"デザイナー",client:"クライアント",date:"日付",description:"説明"},Eqe={module:"モジュール",material:"材質",structure:"構造物",etc:"その他",structureTypes:"構造物の種類",columnA:"カラムA",columnB:"カラムB",columnC:"カラムC",panelA:"パネルA",panelB:"パネルB",partition:"間仕切り",accessories:"アクセサリー",preparing:"準備中です...",exitToDashboard:"ダッシュボードに戻る"},kqe={saveSuccess:"正常に保存されました",saveFailed:"保存に失敗しました",deleteConfirm:"本当に削除しますか？",unsavedChanges:"未保存の変更があります",loadingProject:"プロジェクトを読み込み中...",noProjectFound:"プロジェクトが見つかりません",invalidInput:"無効な入力です",connectionError:"接続エラーが発生しました",sessionExpired:"セッションの有効期限が切れました",exitWithoutSaving:"保存せずに終了",captureFailure:"ビューのキャプチャに失敗しました。もう一度お試しください。",exitConfirm:"保存せずに終了しますか？",loseChanges:"保存されていない変更は失われます。"},Iqe={editColumn:"カラム編集",deleteConfirm:"本当にこのカラムを削除しますか？",basicInfo:"基本情報",columnId:"カラムID",size:"サイズ",width:"幅",depth:"奥行き",height:"高さ",position:"位置",leftGap:"左側隙間",rightGap:"右側隙間",keyboardHint:"キーボード操作: ↑↓(左側隙間 1mm/Shift+10mm)、←→(右側隙間 10mm/Shift+100mm)"},Fqe={title:"操作方法",shortcuts:{mouseDrag:"マウスドラッグ",cameraRotate:"カメラ回転",mouseWheel:"マウスホイール",zoomInOut:"ズームイン/アウト",deleteSelected:"選択した家具を削除",exitEditMode:"編集モード終了",arrowKeys:"矢印キー",fineTuneMove:"家具の微調整移動",doubleClick:"ダブルクリック",editMode:"家具編集モード",dragDrop:"ドラッグ＆ドロップ",placeFurniture:"家具配置"},tips:{title:"使用のヒント",autoPlace:"サイドバーで家具をダブルクリックすると空きスロットに自動配置されます",editPopup:"家具をクリックすると編集ポップアップが開きます",editColumn:"カラムをダブルクリックするとカラムのプロパティを編集できます",doorInstall:"ドア設置ボタンでドアを追加/削除できます"}},Dqe={title:"CNC最適化",calculate:"計算",export:"エクスポート",panels:"パネル",stock:"在庫",options:"オプション",panel:"パネル",cut:"カット",result:"結果",sheets:"シート",sheet:"シート",efficiency:"効率",wasteArea:"廃棄面積",usedArea:"使用面積",cutLength:"カット長",cutCount:"カット回数",simulation:"シミュレーション",play:"再生",pause:"一時停止",speed:"速度",exit:"終了",back:"戻る",next:"次へ",noResults:"最適化結果がありません",setupHint:'パネルと在庫を設定してから"最適化"ボタンをクリックしてください',optimizing:"最適化中...",generatePanels:"パネル生成",totalStats:"全体統計",sheetStats:"シート統計",totalPanels:"総パネル",bladeThickness:"刃厚",optimization:"最適化",panelCount:"パネル数",sheetList:"シートリスト",cuttingList:"カッティングリスト",keyboardNavigationHint:"矢印キーでシートを移動",optimalL:"L方向優先",optimalW:"W方向優先",optimalCNC:"CNC最適化",optimizationComplete:"最適化完了！{{panels}}個のパネル、{{sheets}}個のシート（平均効率：{{efficiency}}%）",optimizationFailed:"最適化失敗：パネルを配置できません",noPanelsError:"最適化するパネルがありません",noStockError:"在庫シートが定義されていません",optimizationError:"最適化失敗",aiOptimizing:"AI最適化計算中",aiPhase1:"パネルデータ分析中",aiPhase2:"最適配置アルゴリズム実行",aiPhase3:"空間効率性計算",aiPhase4:"切断経路最適化",aiPhase5:"結果検証中",minWaste:"最小廃棄",verticalCut:"縦切断",horizontalCut:"横切断",panelList:"パネル",noPanelsMessage:"パネルがありません。「追加」ボタンをクリックして作成してください。",dimensions:"サイズ (L×W)",material:"材料",grain:"木目",quantity:"数量",thickness:"厚さ",name:"名前",panelNamePlaceholder:"例：サイドパネル",stockNamePlaceholder:"例：在庫1",noStockMessage:"在庫がありません。「追加」ボタンをクリックして作成してください。",maxValue:"最大: {{value}}",csvImport:"CSVインポート",csvExport:"CSVエクスポート",csvImportConfirm:"CSVからパネルをインポートしますか？",csvReadError:"CSVファイルの読み取りエラー",csvNoData:"CSVファイルにデータがありません",panelsAddSuccess:"{{count}}個のパネルを追加しました",stockAddSuccess:"{{count}}個の在庫シートを追加しました",edgeGapSettings:"エッジギャップ設定",top:"上",bottom:"下",left:"左",right:"右",considerGrain:"木目方向を考慮",groupByMaterial:"材料別にグループ化",showPanelLabels:"パネルラベルを表示",considerEdgeBanding:"エッジバンディングを考慮",singleSheetOnly:"単一シートのみ",alignVerticalCuts:"垂直カットを整列",exitConfirmMessage:"CNCオプティマイザーを終了しますか？",unsavedChangesWarning:"保存されていない変更がある可能性があります。"},jqe={common:vqe,settings:wqe,space:xqe,frame:bqe,furniture:_qe,placement:Cqe,material:Sqe,viewer:Tqe,project:Bqe,export:{title:"エクスポート",pdf:"PDFとしてエクスポート",dxf:"DXFとしてエクスポート",image:"画像としてエクスポート",excel:"Excelとしてエクスポート",cutList:"カットリスト",partsList:"部品リスト",estimate:"見積書",drawingEditor:"図面エディター",cuttingOptimizer:"カッティングオプティマイザー"},sidebar:Eqe,messages:kqe,column:Iqe,help:Fqe,cnc:Dqe},Pqe={save:"保存",cancel:"取消",delete:"删除",edit:"编辑",add:"添加",remove:"移除",confirm:"确认",close:"关闭",back:"返回",next:"下一步",finish:"完成",apply:"应用",reset:"重置",search:"搜索",loading:"加载中...",error:"错误",success:"成功",warning:"警告",info:"信息",undo:"撤销",redo:"重做",copy:"复制",paste:"粘贴",file:"文件",saving:"保存中...",help:"帮助",controls:"操作方法",converting:"转换",logout:"登出",login:"登录",brandType:"品牌类型",priceInfo:"价格信息",priceRange:"价格范围",none:"无",enabled:"启用",unit:"单位"},Nqe={title:"设置",general:"常规设置",language:"语言",languageDesc:"界面语言设置",theme:"主题",themeDesc:"主题设置",themeSettings:"主题设置",displayMode:"显示模式",themeColor:"主题颜色",lightMode:"浅色模式",darkMode:"深色模式",notifications:"通知",notificationsDesc:"接收更新和通知",autoSave:"自动保存",autoSaveDesc:"自动保存更改",gridSnap:"网格对齐",gridSnapDesc:"自动将对象对齐到网格",shortcuts:"键盘快捷键",version:"版本",lastUpdate:"最后更新",info:"信息"},Lqe={title:"空间设置",width:"宽度",height:"高度",depth:"深度",installType:"安装类型",builtin:"嵌入",builtinDesc:"两侧都有墙的嵌入式",semistanding:"半嵌入",semistandingDesc:"一侧有墙一侧开放的半嵌入式",freestanding:"独立",freestandingDesc:"两侧都没有墙的独立式",wallPosition:"墙体位置",standing:"落地式",semiStanding:"半落地式",wallMount:"壁挂式",surroundType:"围框类型",surround:"有围框",noSurround:"无围框",columnCount:"列数",doorCount:"门数",droppedCeiling:"吊顶",droppedCeilingEnabled:"启用吊顶",droppedCeilingHeight:"吊顶高度",droppedCeilingWidth:"吊顶宽度",mainSection:"主区域",droppedSection:"吊顶区域",mainSectionSize:"主区域尺寸",droppedColumnCount:"吊顶区域列数",floorFinish:"地板装修",floorFinishThickness:"厚度",totalWidth:"总宽度"},Mqe={title:"框架设置",frameWidth:"框架宽度",leftFrame:"左框架",rightFrame:"右框架",topFrame:"顶部框架",baseFrame:"底部框架",endPanel:"端板",subFrame:"子框架",frameOptions:"框架选项",withFrame:"有框架",withoutFrame:"无框架",properties:"框架属性",baseHeight:"底座高度",floatHeight:"悬浮高度"},Rqe={title:"家具",upperCabinet:"吊柜",lowerCabinet:"地柜",tallCabinet:"高柜",dualCabinet:"双层柜",singleCabinet:"单层柜",backPanel:"背板",gapBackPanel:"间隙背板",door:"门板",drawer:"抽屉",shelf:"隔板",handle:"把手",hinge:"铰链",hingePosition:"铰链位置",left:"左侧",right:"右侧",moduleLibrary:"模块库",placedModules:"已放置模块",moduleProperties:"模块属性",customWidth:"自定义宽度",customHeight:"自定义高度",customDepth:"自定义深度",all:"全部",single:"单个",dual:"双个",moduleNotReady:"模块仍在准备中",noModulesAvailable:"没有适合此类型的家具",editFurniture:"编辑家具",viewDetails:"查看详情",panelDetails:"面板详细信息",widthSettings:"宽度设置",depthSettings:"深度设置",range:"范围",doorSettings:"门板设置",hingeDirection:"铰链方向",openToRight:"向右打开",openToLeft:"向左打开",coverDoorNote:"遮盖门无法更改铰链位置",gapBackPanelSettings:"柜子间隙背板",backPanelAlreadySet:"同一插槽的{{position}}已设置背板。",minValue:"最小值必须大于{{value}}mm",maxValue:"最大值必须小于{{value}}mm"},Oqe={title:"放置设置",placementType:"放置类型",droppedCeilingPosition:"吊顶位置",floor:"地面放置",float:"悬浮放置",floatHeight:"悬浮高度",gap:"间隙",leftGap:"左间隙",rightGap:"右间隙",topGap:"顶部间隙",bottomGap:"底部间隙",properties:"放置属性"},Uqe={title:"材质设置",woodGrain:"木纹",solid:"纯色",metallic:"金属",glass:"玻璃",matte:"哑光",glossy:"亮光",texture:"纹理",color:"颜色",finish:"表面处理",selection:"材质选择",floorFinish:"地板饰面",interior:"内部",door:"门板",furnitureLibrary:"家具库",internalSpace:"内部空间（定制家具基准）",internalSpaceDimensions:"宽: {{width}}mm × 高: {{height}}mm × 深: {{depth}}mm",internalSpaceNote:"* 所有家具按内部高度（{{height}}mm）和深度（{{depth}}mm）制作",columnInfo:"* 列数: {{count}}个 / 每列宽度: {{width}}mm",tallSingleDesc:"高柜 - 单列家具（约{{width}}mm宽）",tallDualDesc:"高柜 - 双列家具（约{{width}}mm宽）",upperSingleDesc:"吊柜 - 单列（约{{width}}mm宽）",upperDualDesc:"吊柜 - 双列（约{{width}}mm宽）",lowerSingleDesc:"地柜 - 单列（约{{width}}mm宽）",lowerDualDesc:"地柜 - 双列（约{{width}}mm宽）",colorPicker:"指定颜色",brightnessAdjust:"亮度调整",savedColors:"已保存的颜色",addColorHint:"点击+按钮添加颜色"},Hqe={title:"查看器",view2D:"2D视图",view3D:"3D视图",all:"全部",front:"正面",left:"左视图",right:"右视图",top:"俯视图",perspective:"透视图",wireframe:"线框",solid:"实体",showDimensions:"显示尺寸",showGuides:"显示参考线",showAxis:"显示坐标轴",showAll:"显示全部",dimensions:"标注",grid:"网格",axis:"坐标轴",column:"列",doorInstallation:"门",doorOpen:"打开",doorClose:"关闭",indirectLight:"间接照明",indirectLightOn:"开启间接照明",indirectLightOff:"关闭间接照明",on:"开",off:"关"},Wqe={title:"项目",newProject:"新建项目",openProject:"打开项目",saveProject:"保存项目",saveAs:"另存为",export:"导出",import:"导入",projectName:"项目名称",designer:"设计师",client:"客户",date:"日期",description:"描述"},Qqe={module:"模块",material:"材质",structure:"结构",etc:"其他",structureTypes:"结构类型",columnA:"柱A",columnB:"柱B",columnC:"柱C",panelA:"面板A",panelB:"面板B",partition:"隔断",accessories:"配件",preparing:"正在准备...",exitToDashboard:"退出到仪表板"},$qe={saveSuccess:"保存成功",saveFailed:"保存失败",deleteConfirm:"确定要删除吗？",unsavedChanges:"有未保存的更改",loadingProject:"正在加载项目...",noProjectFound:"未找到项目",invalidInput:"无效的输入",connectionError:"连接错误",sessionExpired:"会话已过期",exitWithoutSaving:"不保存退出",captureFailure:"视图捕获失败。请重试。",exitConfirm:"确定不保存就退出吗？",loseChanges:"未保存的更改将丢失。"},Vqe={editColumn:"编辑立柱",deleteConfirm:"确定要删除这个立柱吗？",basicInfo:"基本信息",columnId:"立柱ID",size:"尺寸",width:"宽度",depth:"深度",height:"高度",position:"位置",leftGap:"左侧间隙",rightGap:"右侧间隙",keyboardHint:"键盘操作：↑↓（左侧间隙 1mm/Shift+10mm），←→（右侧间隙 10mm/Shift+100mm）"},zqe={title:"操作方法",shortcuts:{mouseDrag:"鼠标拖动",cameraRotate:"相机旋转",mouseWheel:"鼠标滚轮",zoomInOut:"放大/缩小",deleteSelected:"删除选中的家具",exitEditMode:"退出编辑模式",arrowKeys:"方向键",fineTuneMove:"微调家具移动",doubleClick:"双击",editMode:"家具编辑模式",dragDrop:"拖放",placeFurniture:"放置家具"},tips:{title:"使用提示",autoPlace:"在侧边栏双击家具可自动放置在空槽位",editPopup:"点击家具打开编辑弹窗",editColumn:"双击立柱可编辑立柱属性",doorInstall:"使用门安装按钮添加/删除门"}},Gqe={title:"CNC优化",calculate:"计算",export:"导出",panels:"面板",stock:"库存",options:"选项",panel:"面板",cut:"切割",result:"结果",sheets:"板材",sheet:"板材",efficiency:"效率",wasteArea:"浪费面积",usedArea:"使用面积",cutLength:"切割长度",cutCount:"切割次数",simulation:"模拟",play:"播放",pause:"暂停",speed:"速度",exit:"退出",back:"返回",next:"下一步",noResults:"没有优化结果",setupHint:'设置面板和库存后，点击"优化"按钮',optimizing:"优化中...",generatePanels:"生成面板",totalStats:"总统计",sheetStats:"板材统计",totalPanels:"总面板",bladeThickness:"刃厚",optimization:"优化",panelCount:"面板数",sheetList:"板材列表",cuttingList:"切割列表",keyboardNavigationHint:"使用方向键导航板材",optimalL:"L方向优先",optimalW:"W方向优先",optimalCNC:"CNC优化",optimizationComplete:"优化完成！{{panels}}个面板，{{sheets}}个板材（平均效率：{{efficiency}}%）",optimizationFailed:"优化失败：无法放置面板",noPanelsError:"没有要优化的面板",noStockError:"未定义库存板材",optimizationError:"优化失败",aiOptimizing:"AI优化计算中",aiPhase1:"分析面板数据",aiPhase2:"运行优化算法",aiPhase3:"计算空间效率",aiPhase4:"优化切割路径",aiPhase5:"验证结果",minWaste:"最小浪费",verticalCut:"纵向切割",horizontalCut:"横向切割",panelList:"面板",noPanelsMessage:'没有面板。点击"添加"按钮创建。',dimensions:"尺寸 (L×W)",material:"材料",grain:"纹理",quantity:"数量",thickness:"厚度",name:"名称",panelNamePlaceholder:"例如：侧板",stockNamePlaceholder:"例如：库存1",noStockMessage:'没有库存。点击"添加"按钮创建。',maxValue:"最大: {{value}}",csvImport:"导入CSV",csvExport:"导出CSV",csvImportConfirm:"从CSV导入面板？",csvReadError:"读取CSV文件出错",csvNoData:"CSV文件中没有数据",panelsAddSuccess:"已添加{{count}}个面板",stockAddSuccess:"已添加{{count}}个库存板材",edgeGapSettings:"边缘间隙设置",top:"顶部",bottom:"底部",left:"左侧",right:"右侧",considerGrain:"考虑纹理方向",groupByMaterial:"按材料分组",showPanelLabels:"显示面板标签",considerEdgeBanding:"考虑封边",singleSheetOnly:"仅单张板材",alignVerticalCuts:"对齐垂直切割",exitConfirmMessage:"确定要退出CNC优化器吗？",unsavedChangesWarning:"您可能有未保存的更改。"},Xqe={common:Pqe,settings:Nqe,space:Lqe,frame:Mqe,furniture:Rqe,placement:Oqe,material:Uqe,viewer:Hqe,project:Wqe,export:{title:"导出",pdf:"导出为PDF",dxf:"导出为DXF",image:"导出为图片",excel:"导出为Excel",cutList:"裁切清单",partsList:"零件清单",estimate:"报价单",drawingEditor:"图纸编辑器",cuttingOptimizer:"切割优化器"},sidebar:Qqe,messages:$qe,column:Vqe,help:zqe,cnc:Gqe},Kqe={ko:{translation:nqe},en:{translation:yqe},ja:{translation:jqe},zh:{translation:Xqe}};tc.use(Lae).init({resources:Kqe,lng:localStorage.getItem("app-language")||"ko",fallbackLng:"ko",interpolation:{escapeValue:!1},ns:["translation"],defaultNS:"translation",debug:!1,react:{useSuspense:!1}});MY.createRoot(document.getElementById("root")).render(l.jsx(wKe,{}));export{S$ as B,FQ as L,Ds as _,Hi as a,Ua as c,Ri as d,Mu as g};
